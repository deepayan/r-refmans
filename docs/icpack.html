<!DOCTYPE html><html lang="en"><head><title>Help for package icpack</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {icpack}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bbase'><p>Compute a B-spline basis</p></a></li>
<li><a href='#drugusers'><p>Interval-censored drug users data</p></a></li>
<li><a href='#Estep'><p>Perform the E-step in the EM algorithm</p></a></li>
<li><a href='#fillplot'><p>Fills space between two lines in a graph</p></a></li>
<li><a href='#fitit'><p>Fit proportional hazard model with smooth baseline hazard and (optional) interval censoring</p></a></li>
<li><a href='#get_input_icfit'><p>Get and check input of icfit</p></a></li>
<li><a href='#icfit'><p>Fit a proportional hazards model with baseline hazard modeled by P-splines</p></a></li>
<li><a href='#InfoMatrix'><p>Compute the information matrix</p></a></li>
<li><a href='#init'><p>Generate a discrete IC object</p></a></li>
<li><a href='#Mstep'><p>Function for fitting proportioal hazard model with baseline hazard</p></a></li>
<li><a href='#Ova'><p>Ovarian cancer data</p></a></li>
<li><a href='#plot.icfit'><p>Plot method for an object of class 'icfit'</p></a></li>
<li><a href='#plot.predict.icfit'><p>Plot method for an object of class 'predict.icfit'</p></a></li>
<li><a href='#predict.icfit'><p>Predict method for an object of class 'icfit'</p></a></li>
<li><a href='#print.icfit'><p>Print method for an object of class 'icfit'</p></a></li>
<li><a href='#rasterplot'><p>Plot probabilities as a raster'</p></a></li>
<li><a href='#summary.icfit'><p>Summary method for an object of class 'icfit'</p></a></li>
<li><a href='#summary.predict.icfit'><p>Summary method for an object of class 'predict.icfit'</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-06-21</td>
</tr>
<tr>
<td>Title:</td>
<td>Survival Analysis of Interval-Censored Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0), survival (&ge; 3.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, rlang, gridExtra, checkmate, matrixStats, dplyr,
reshape2, ggplot2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, flexsurv, lemon, knitr, markdown</td>
</tr>
<tr>
<td>Description:</td>
<td>Survival analysis of interval-censored data with proportional hazards, and an explicit smooth estimate of the baseline log-hazard with P-splines. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-01 07:44:24 UTC; hputter</td>
</tr>
<tr>
<td>Author:</td>
<td>Hein Putter [aut, cre],
  Paul Eilers [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hein Putter &lt;h.putter@lumc.nl&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-02 06:30:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='bbase'>Compute a B-spline basis</h2><span id='topic+bbase'></span>

<h3>Description</h3>

<p>Compute a B-spline basis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bbase(x, xl = min(x), xr = max(x), nseg = 10, deg = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bbase_+3A_x">x</code></td>
<td>
<p>The vector of values for which the basis is to be evaluated</p>
</td></tr>
<tr><td><code id="bbase_+3A_xl">xl</code></td>
<td>
<p>The left boundary of the domain</p>
</td></tr>
<tr><td><code id="bbase_+3A_xr">xr</code></td>
<td>
<p>The right boundary of the domain</p>
</td></tr>
<tr><td><code id="bbase_+3A_nseg">nseg</code></td>
<td>
<p>The number of inter-knot segments on the domain</p>
</td></tr>
<tr><td><code id="bbase_+3A_deg">deg</code></td>
<td>
<p>The degree of the B-splines (2 means quadratic, 3 means cubic, and so on)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the basis
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = runif(100)
B = bbase(x, 0, 1, 20, 3)
</code></pre>

<hr>
<h2 id='drugusers'>Interval-censored drug users data</h2><span id='topic+drugusers'></span>

<h3>Description</h3>

<p>Interval-censored drug users data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(drugusers)
</code></pre>


<h3>Format</h3>

<p>Data from a cohort of 940 injecting drug users attending a hospital
detoxification unit in Barcelona, Spain. Time is months between initiation
of intravenous drug use and HIV seroconversion.
A dataframe with five columns:
</p>

<dl>
<dt><code>left</code></dt><dd><p>Last negative HIV test (0 if first HIV test was positive)</p>
</dd>
<dt><code>right</code></dt><dd><p>First positive HIV test (<code>Inf</code> if last HIV test was negative)</p>
</dd>
<dt><code>period</code></dt><dd><p>Period of initiation of drug use,
factor with levels &quot;1972-1980&quot;, &quot;1981-1985&quot;, &quot;1986-1991&quot;, &quot;1992-1997&quot;</p>
</dd>
<dt><code>gender</code></dt><dd><p>Gender, factor with levels &quot;male&quot; and &quot;female&quot;</p>
</dd>
<dt><code>age</code></dt><dd><p>Age at initiation of drug use (years)</p>
</dd>
</dl>



<h3>References</h3>

<p>Gomez G, Calle ML, Egea JM &amp; Muga R (2000). Risk of HIV infection as a function of the duration
of intravenous drug use: a non-parametric Bayesian approach. Stat Med; 19:2641â€“2656.
</p>

<hr>
<h2 id='Estep'>Perform the E-step in the EM algorithm</h2><span id='topic+Estep'></span>

<h3>Description</h3>

<p>Perform the E-step in the EM algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Estep(H, Ic, R1, dead)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Estep_+3A_h">H</code></td>
<td>
<p>Hazards per individual (in columns)</p>
</td></tr>
<tr><td><code id="Estep_+3A_ic">Ic</code></td>
<td>
<p>Censoring interval per individual, coded as 0/1 (in columns)</p>
</td></tr>
<tr><td><code id="Estep_+3A_r1">R1</code></td>
<td>
<p>Left truncation interval per individual, coded as 0/1 (in columns)</p>
</td></tr>
<tr><td><code id="Estep_+3A_dead">dead</code></td>
<td>
<p>Boolean vector (TRUE is event, FALSE is right censored)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two matrices
</p>
<table role = "presentation">
<tr><td><code>Y</code></td>
<td>
<p>Expected probability of event per bin per subject</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Expected probability of at risk per bin per subject</p>
</td></tr>
</table>

<hr>
<h2 id='fillplot'>Fills space between two lines in a graph</h2><span id='topic+fillplot'></span>

<h3>Description</h3>

<p>Taken from mstate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fillplot(x, y1, y2, col)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fillplot_+3A_x">x</code></td>
<td>
<p>Points on the x-axis</p>
</td></tr>
<tr><td><code id="fillplot_+3A_y1">y1</code></td>
<td>
<p>First set of points on y-axis</p>
</td></tr>
<tr><td><code id="fillplot_+3A_y2">y2</code></td>
<td>
<p>Second set of points on y-axis</p>
</td></tr>
<tr><td><code id="fillplot_+3A_col">col</code></td>
<td>
<p>The color to fill space with</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>

<hr>
<h2 id='fitit'>Fit proportional hazard model with smooth baseline hazard and (optional) interval censoring</h2><span id='topic+fitit'></span>

<h3>Description</h3>

<p>Fit proportional hazard model with smooth baseline hazard and (optional) interval censoring
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitit(
  Y,
  R,
  dead,
  X,
  B,
  Ic,
  R1,
  cbx,
  Pdiff,
  Pridge,
  lambda,
  nit = 50,
  tol = 1e-06,
  tollam = 0.01,
  update_lambda = FALSE,
  ic_update = TRUE,
  monitor = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitit_+3A_y">Y</code></td>
<td>
<p>Events (matrix, number of bins by subjects)</p>
</td></tr>
<tr><td><code id="fitit_+3A_r">R</code></td>
<td>
<p>Risk sets (matrix, number of bins by subjects)</p>
</td></tr>
<tr><td><code id="fitit_+3A_dead">dead</code></td>
<td>
<p>(Boolean vector, TRUE if event, FALSE if right censored)</p>
</td></tr>
<tr><td><code id="fitit_+3A_x">X</code></td>
<td>
<p>Covariates (matrix, number of covariates (+1) by subjects)</p>
</td></tr>
<tr><td><code id="fitit_+3A_b">B</code></td>
<td>
<p>B-spline basis matrix</p>
</td></tr>
<tr><td><code id="fitit_+3A_ic">Ic</code></td>
<td>
<p>Censoring interval per individual, coded as 0/1 (in columns)</p>
</td></tr>
<tr><td><code id="fitit_+3A_r1">R1</code></td>
<td>
<p>Left truncation interval per individual, coded as 0/1 (in columns)</p>
</td></tr>
<tr><td><code id="fitit_+3A_cbx">cbx</code></td>
<td>
<p>Vector of starting values</p>
</td></tr>
<tr><td><code id="fitit_+3A_pdiff">Pdiff</code></td>
<td>
<p>B-spline part of penalty matrix</p>
</td></tr>
<tr><td><code id="fitit_+3A_pridge">Pridge</code></td>
<td>
<p>Ridge part of penalty matrix (for intercept)</p>
</td></tr>
<tr><td><code id="fitit_+3A_lambda">lambda</code></td>
<td>
<p>Smoothing parameter (number)</p>
</td></tr>
<tr><td><code id="fitit_+3A_nit">nit</code></td>
<td>
<p>Maximum number of iterations (integer)</p>
</td></tr>
<tr><td><code id="fitit_+3A_tol">tol</code></td>
<td>
<p>Tolerance for final fit</p>
</td></tr>
<tr><td><code id="fitit_+3A_tollam">tollam</code></td>
<td>
<p>Tolerance for switching to lambda update</p>
</td></tr>
<tr><td><code id="fitit_+3A_update_lambda">update_lambda</code></td>
<td>
<p>Automatic update of lambda (Boolean)</p>
</td></tr>
<tr><td><code id="fitit_+3A_ic_update">ic_update</code></td>
<td>
<p>Update risk and event probabilities (Boolean)</p>
</td></tr>
<tr><td><code id="fitit_+3A_monitor">monitor</code></td>
<td>
<p>Monitor convergence (Boolean)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with items
</p>
<table role = "presentation">
<tr><td><code>cbx</code></td>
<td>
<p>Vector of </p>
</td></tr>
<tr><td><code>ll</code></td>
<td>
<p>Poisson GLM log-likelihood</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>Final tuning parameter</p>
</td></tr>
<tr><td><code>pen</code></td>
<td>
<p>Penalty part of penalized log-likelihood</p>
</td></tr>
<tr><td><code>ed</code></td>
<td>
<p>Effetive dimension of the baseline hazard</p>
</td></tr>
<tr><td><code>nit1</code></td>
<td>
<p>Number of iterations used in first phase</p>
</td></tr>
<tr><td><code>nit</code></td>
<td>
<p>Total number of iterations used (first plus second phase)</p>
</td></tr>
<tr><td><code>tollam</code></td>
<td>
<p>Tolerance used for switching to lambda update</p>
</td></tr>
</table>

<hr>
<h2 id='get_input_icfit'>Get and check input of icfit</h2><span id='topic+get_input_icfit'></span>

<h3>Description</h3>

<p>Get and check input of icfit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_input_icfit(formula, data, entry)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_input_icfit_+3A_formula">formula</code></td>
<td>
<p>A formula object with response of the left of a ~ operator
and terms on the right. The response must be a survival object as returned
by the &lsquo;Surv' function, with type either right&rsquo;, 'counting' or 'interval2'</p>
</td></tr>
<tr><td><code id="get_input_icfit_+3A_data">data</code></td>
<td>
<p>A data frame in which to interpret the variable names in the
'formula'</p>
</td></tr>
<tr><td><code id="get_input_icfit_+3A_entry">entry</code></td>
<td>
<p>When appropriate, a vector of entry (left truncation) times,
or a string indicating the column name in 'data' containing entry times;
only used if Surv object is of type 'interval2'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with items
</p>
<table role = "presentation">
<tr><td><code>Ymat</code></td>
<td>
<p>Matrix (number of subjects x 3) containing entry, left and right
hand of intervals</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>Matrix (number of subjects x number of covariates + 1) with design
matrix of covariates</p>
</td></tr>
</table>

<hr>
<h2 id='icfit'>Fit a proportional hazards model with baseline hazard modeled by P-splines</h2><span id='topic+icfit'></span>

<h3>Description</h3>

<p>Fit a proportional hazards model with baseline hazard modeled by P-splines
</p>


<h3>Usage</h3>

<pre><code class='language-R'>icfit(
  formula,
  data,
  entry,
  lambda = 10,
  nt = 100,
  tmax,
  nseg = 20,
  bdeg = 3,
  pord = 2,
  nit = 50,
  tol = 1e-06,
  tollam = 0.01,
  kappa = 1e-06,
  update_lambda = TRUE,
  ic_update = TRUE,
  monitor = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="icfit_+3A_formula">formula</code></td>
<td>
<p>A formula object with response of the left of a ~ operator
and covariate terms on the right. The response must be a survival object
as returned by the &lsquo;Surv' function, with type either right&rsquo;, 'counting' or
'interval2'</p>
</td></tr>
<tr><td><code id="icfit_+3A_data">data</code></td>
<td>
<p>A data frame in which to interpret the variable names in the
'formula'</p>
</td></tr>
<tr><td><code id="icfit_+3A_entry">entry</code></td>
<td>
<p>When appropriate, a vector of entry (left truncation) times,
or a string indicating the column name in 'data' containing entry times;
only used if Surv object is of type 'interval2'</p>
</td></tr>
<tr><td><code id="icfit_+3A_lambda">lambda</code></td>
<td>
<p>Starting value of penalty tuning parameter</p>
</td></tr>
<tr><td><code id="icfit_+3A_nt">nt</code></td>
<td>
<p>The number of time bins</p>
</td></tr>
<tr><td><code id="icfit_+3A_tmax">tmax</code></td>
<td>
<p>The end of time domain (default 1.01 times largest observation)</p>
</td></tr>
<tr><td><code id="icfit_+3A_nseg">nseg</code></td>
<td>
<p>The number of B-spline segments</p>
</td></tr>
<tr><td><code id="icfit_+3A_bdeg">bdeg</code></td>
<td>
<p>The degree of the B-splines</p>
</td></tr>
<tr><td><code id="icfit_+3A_pord">pord</code></td>
<td>
<p>The order of the differences used in the penalty</p>
</td></tr>
<tr><td><code id="icfit_+3A_nit">nit</code></td>
<td>
<p>Maximum number of iterations (integer)</p>
</td></tr>
<tr><td><code id="icfit_+3A_tol">tol</code></td>
<td>
<p>Tolerance for final fit</p>
</td></tr>
<tr><td><code id="icfit_+3A_tollam">tollam</code></td>
<td>
<p>Tolerance for switching to lambda update</p>
</td></tr>
<tr><td><code id="icfit_+3A_kappa">kappa</code></td>
<td>
<p>Ridge parameter (number)</p>
</td></tr>
<tr><td><code id="icfit_+3A_update_lambda">update_lambda</code></td>
<td>
<p>Automatic update of lambda (Boolean)</p>
</td></tr>
<tr><td><code id="icfit_+3A_ic_update">ic_update</code></td>
<td>
<p>Update risk and event probabilities (Boolean)</p>
</td></tr>
<tr><td><code id="icfit_+3A_monitor">monitor</code></td>
<td>
<p>Monitor convergence (Boolean)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'icfit'
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Fit proportional hazards model to interval-censored data
icfit(Surv(left, right, type='interval2') ~ period + gender + age,
      data=drugusers)
# Fit proportional hazards model to right-censored data
icfit(Surv(time, d) ~ Diameter + FIGO + Karnofsky, data = Ova)

</code></pre>

<hr>
<h2 id='InfoMatrix'>Compute the information matrix</h2><span id='topic+InfoMatrix'></span>

<h3>Description</h3>

<p>Compute the information matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>InfoMatrix(object, initres)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="InfoMatrix_+3A_object">object</code></td>
<td>
<p>Fit obtained from <code>fitit</code></p>
</td></tr>
<tr><td><code id="InfoMatrix_+3A_initres">initres</code></td>
<td>
<p>Result from <code>init</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three information matrices are computed. One is <code>Ifull</code> which interprets
the imputed <code>R</code> and <code>Y</code> data from <code>object</code> as actual observations.
<code>Iloss</code> gives the loss of information due to imputation. The sum of both matrices
is the true information matrix.
</p>


<h3>Value</h3>

<p>A list with three items
</p>
<table role = "presentation">
<tr><td><code>Itrue</code></td>
<td>
<p>Total of <code>Ifull</code> and <code>Iloss</code>, true Fisher information
matrix</p>
</td></tr>
<tr><td><code>Ifull</code></td>
<td>
<p>Full Fisher information matrix</p>
</td></tr>
<tr><td><code>Iloss</code></td>
<td>
<p>Loss of information due to intervals (missing event times)</p>
</td></tr>
</table>

<hr>
<h2 id='init'>Generate a discrete IC object</h2><span id='topic+init'></span>

<h3>Description</h3>

<p>Generate a discrete IC object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>init(Times, X, nt, tmax, nseg = 20, bdeg = 3, pord = 2, kappa = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="init_+3A_times">Times</code></td>
<td>
<p>The (possibly interval censored) survival data, in a matrix</p>
</td></tr>
<tr><td><code id="init_+3A_x">X</code></td>
<td>
<p>The design matrix containing covariates</p>
</td></tr>
<tr><td><code id="init_+3A_nt">nt</code></td>
<td>
<p>The number of bins for discretization</p>
</td></tr>
<tr><td><code id="init_+3A_tmax">tmax</code></td>
<td>
<p>The end of time domain (default 1.01 times largest observation)</p>
</td></tr>
<tr><td><code id="init_+3A_nseg">nseg</code></td>
<td>
<p>The number of B-spline segments</p>
</td></tr>
<tr><td><code id="init_+3A_bdeg">bdeg</code></td>
<td>
<p>The degree of the B-splines</p>
</td></tr>
<tr><td><code id="init_+3A_pord">pord</code></td>
<td>
<p>The order of the differences used in the penalty</p>
</td></tr>
<tr><td><code id="init_+3A_kappa">kappa</code></td>
<td>
<p>Ridge parameter (number)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with items
</p>
<table role = "presentation">
<tr><td><code>data</code></td>
<td>
<p>List containing the original data as well as the binned data</p>
</td></tr>
<tr><td><code>bins</code></td>
<td>
<p>List with information on bins used</p>
</td></tr>
<tr><td><code>basis</code></td>
<td>
<p>List containing the B-spline matrix</p>
</td></tr>
<tr><td><code>start</code></td>
<td>
<p>List containing information on starting values</p>
</td></tr>
<tr><td><code>penalty</code></td>
<td>
<p>List containing Pdiff and Pridge</p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p>List with information on control of B-spline basis</p>
</td></tr>
</table>

<hr>
<h2 id='Mstep'>Function for fitting proportioal hazard model with baseline hazard</h2><span id='topic+Mstep'></span>

<h3>Description</h3>

<p>Function for fitting proportioal hazard model with baseline hazard
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Mstep(Y, R, X, B, Pen, lambda, cbx)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Mstep_+3A_y">Y</code></td>
<td>
<p>Expected events (matrix)</p>
</td></tr>
<tr><td><code id="Mstep_+3A_r">R</code></td>
<td>
<p>Expected risk sets (matrix)</p>
</td></tr>
<tr><td><code id="Mstep_+3A_x">X</code></td>
<td>
<p>Covariates (matrix)</p>
</td></tr>
<tr><td><code id="Mstep_+3A_b">B</code></td>
<td>
<p>B-spline basis</p>
</td></tr>
<tr><td><code id="Mstep_+3A_pen">Pen</code></td>
<td>
<p>Penalty matrix</p>
</td></tr>
<tr><td><code id="Mstep_+3A_lambda">lambda</code></td>
<td>
<p>Smoothing parameter (number)</p>
</td></tr>
<tr><td><code id="Mstep_+3A_cbx">cbx</code></td>
<td>
<p>Current coefficient estimates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object with fields:
<code>H</code> = hazards (matrix),
<code>cbx</code> = coefficient estimates (vector),
<code>lambda</code> = proposal for new lambda,
<code>ed</code> = effective dimension,
<code>G</code> = G matrix,
<code>ll</code> = log-likelihood,
<code>pen</code> = penalized part of log-likelihood,
<code>Mpen</code> = penalized M matrix
</p>

<hr>
<h2 id='Ova'>Ovarian cancer data</h2><span id='topic+Ova'></span>

<h3>Description</h3>

<p>Ovarian cancer data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Ova)
</code></pre>


<h3>Format</h3>

<p>A dataframe with five columns:
</p>

<dl>
<dt><code>Diameter</code></dt><dd></dd>
<dt><code>FIGO</code></dt><dd></dd>
<dt><code>Karnofsky</code></dt><dd></dd>
<dt><code>time</code></dt><dd></dd>
<dt><code>d</code></dt><dd><p>death</p>
</dd>
</dl>



<h3>Source</h3>

<p>tba
</p>

<hr>
<h2 id='plot.icfit'>Plot method for an object of class 'icfit'</h2><span id='topic+plot.icfit'></span>

<h3>Description</h3>

<p>Plot method for an object of class 'icfit'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'icfit'
plot(
  x,
  type = c("hazard", "cumhazard", "survival", "probability"),
  conf.int = TRUE,
  ylim = NULL,
  title = NULL,
  xlab = NULL,
  ylab = NULL,
  fill = TRUE,
  fillcol = "lightgrey",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.icfit_+3A_x">x</code></td>
<td>
<p>The object of class 'icfit' to be plotted</p>
</td></tr>
<tr><td><code id="plot.icfit_+3A_type">type</code></td>
<td>
<p>Type of plot. Accepted choices: 'hazard' (default), 'cumhazard', 'survival' or 'cumprob'</p>
</td></tr>
<tr><td><code id="plot.icfit_+3A_conf.int">conf.int</code></td>
<td>
<p>If 'TRUE' a 100*(1 - alpha) percent confidence interval is plotted</p>
</td></tr>
<tr><td><code id="plot.icfit_+3A_ylim">ylim</code></td>
<td>
<p>The y-limits for the plot</p>
</td></tr>
<tr><td><code id="plot.icfit_+3A_title">title</code></td>
<td>
<p>Optional title string</p>
</td></tr>
<tr><td><code id="plot.icfit_+3A_xlab">xlab</code></td>
<td>
<p>Text for x-label</p>
</td></tr>
<tr><td><code id="plot.icfit_+3A_ylab">ylab</code></td>
<td>
<p>Text for y-label</p>
</td></tr>
<tr><td><code id="plot.icfit_+3A_fill">fill</code></td>
<td>
<p>Fill area between lower and upper</p>
</td></tr>
<tr><td><code id="plot.icfit_+3A_fillcol">fillcol</code></td>
<td>
<p>The color for filling (default 'lightgrey')</p>
</td></tr>
<tr><td><code id="plot.icfit_+3A_...">...</code></td>
<td>
<p>Other arguments to plot (except &lsquo;type', which is set to &rsquo;l')</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot grob, containing the plot. Use <code>print()</code> or <code>plot()</code> to show it
Multiple objects can be combined by using functions in the package <code>gridExtra</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
icf &lt;- icfit(Surv(left, right, type='interval2') ~ period + gender + age, 
             data = drugusers)
plot(icf)


</code></pre>

<hr>
<h2 id='plot.predict.icfit'>Plot method for an object of class 'predict.icfit'</h2><span id='topic+plot.predict.icfit'></span>

<h3>Description</h3>

<p>Plot method for an object of class 'predict.icfit'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predict.icfit'
plot(
  x,
  type = c("hazard", "cumhazard", "survival", "probability"),
  conf.int = TRUE,
  fill = TRUE,
  fillcol = "lightgrey",
  ylim = NULL,
  title = NULL,
  xlab = NULL,
  ylab = NULL,
  selection = NULL,
  nrow = NULL,
  ncol = NULL,
  do_plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.predict.icfit_+3A_x">x</code></td>
<td>
<p>The object of class 'predict.icfit' to be plotted</p>
</td></tr>
<tr><td><code id="plot.predict.icfit_+3A_type">type</code></td>
<td>
<p>Type of plot. Accepted choices: 'hazard' (default), 'cumhazard', 'survival' or 'probability'</p>
</td></tr>
<tr><td><code id="plot.predict.icfit_+3A_conf.int">conf.int</code></td>
<td>
<p>If 'TRUE' a 100*(1 - alpha) percent confidence interval is plotted</p>
</td></tr>
<tr><td><code id="plot.predict.icfit_+3A_fill">fill</code></td>
<td>
<p>Fill area between lower and upper</p>
</td></tr>
<tr><td><code id="plot.predict.icfit_+3A_fillcol">fillcol</code></td>
<td>
<p>The color for filling (default 'lightgrey')</p>
</td></tr>
<tr><td><code id="plot.predict.icfit_+3A_ylim">ylim</code></td>
<td>
<p>The y-limits for the plot</p>
</td></tr>
<tr><td><code id="plot.predict.icfit_+3A_title">title</code></td>
<td>
<p>Optional title string, or, if x is a list, obtained from 'predict.icfit' using 'newdata',
a vector of title strings</p>
</td></tr>
<tr><td><code id="plot.predict.icfit_+3A_xlab">xlab</code></td>
<td>
<p>Text for x-label</p>
</td></tr>
<tr><td><code id="plot.predict.icfit_+3A_ylab">ylab</code></td>
<td>
<p>Text for y-label</p>
</td></tr>
<tr><td><code id="plot.predict.icfit_+3A_selection">selection</code></td>
<td>
<p>If x is a list, obtained from 'predict.icfit' using 'newdata', then a
vector containing the subset of list elements to be plotted, default is to plot
all elements of the list</p>
</td></tr>
<tr><td><code id="plot.predict.icfit_+3A_nrow">nrow</code></td>
<td>
<p>If x is a list, obtained from 'predict.icfit' using 'newdata', then a number
specifying the number of rows to plot; default the square root of the number of list
elements to be plotted</p>
</td></tr>
<tr><td><code id="plot.predict.icfit_+3A_ncol">ncol</code></td>
<td>
<p>If x is a list, obtained from 'predict.icfit' using 'newdata', then a number
specifying the number of columns to plot; default the square root of the number of list
elements to be plotted</p>
</td></tr>
<tr><td><code id="plot.predict.icfit_+3A_do_plot">do_plot</code></td>
<td>
<p>Boolean indicating whether or not to actually plot (default is TRUE)</p>
</td></tr>
<tr><td><code id="plot.predict.icfit_+3A_...">...</code></td>
<td>
<p>other graphical parameters to be passed on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot grob, containing the plot. Use <code>print()</code> or <code>plot()</code> to show it
Multiple objects can be combined by using functions in the package <code>gridExtra</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
icf &lt;- icfit(Surv(left, right, type='interval2') ~ period + gender + age, data=drugusers)
pred_icf &lt;- predict(icf)
plot(pred_icf)
library(ggplot2)
plot(icf) + xlim(0, 200) + ylim(0, 0.05)
ndata &lt;- drugusers[1:4, ]
pred_nd_icf &lt;- predict(icf, newdata=ndata)
plot(pred_nd_icf) # plot all four
plot(pred_nd_icf[[2]]) # plot only the second
plot(pred_nd_icf, type = "cumhazard") # plot four cumulative hazard curves
plot(pred_nd_icf[[3]], type = "prob", ylim = c(0, 1)) # plot probability curve for nr 3
plot(pred_nd_icf[[4]], type = "surv", ylim = c(0, 1)) # plot survival curve for nr 4


</code></pre>

<hr>
<h2 id='predict.icfit'>Predict method for an object of class 'icfit'</h2><span id='topic+predict.icfit'></span>

<h3>Description</h3>

<p>Predict method for an object of class 'icfit'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'icfit'
predict(object, newdata, nstep = 500, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.icfit_+3A_object">object</code></td>
<td>
<p>The object of class 'icfit' for which a prediction is to be made</p>
</td></tr>
<tr><td><code id="predict.icfit_+3A_newdata">newdata</code></td>
<td>
<p>A data frame containing covariate information for a new subject</p>
</td></tr>
<tr><td><code id="predict.icfit_+3A_nstep">nstep</code></td>
<td>
<p>Number of time steps used for calculating cumulative hazards (default is 500)</p>
</td></tr>
<tr><td><code id="predict.icfit_+3A_alpha">alpha</code></td>
<td>
<p>The alpha level for the (1-alpha)*100 percent confidence interval</p>
</td></tr>
<tr><td><code id="predict.icfit_+3A_...">...</code></td>
<td>
<p>Any other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'predict.icfit', which is a data frame with time points and hazard,
cumulative hazard and survival at those time points, along with standard errors
and pointwise lower and upper confidence bounds, or a list of such data frames
for each subject represented in 'newdata'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
icf &lt;- icfit(Surv(left, right, type='interval2') ~ period + gender + age, data=drugusers)
pred_icf &lt;- predict(icf)
head(pred_icf)
ndata &lt;- drugusers[1:4, ]
pred_nd_icf &lt;- predict(icf, newdata=ndata)
lapply(pred_nd_icf, head)


</code></pre>

<hr>
<h2 id='print.icfit'>Print method for an object of class 'icfit'</h2><span id='topic+print.icfit'></span>

<h3>Description</h3>

<p>Print method for an object of class 'icfit'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'icfit'
print(x, digits = max(1L, getOption("digits") - 3L), alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.icfit_+3A_x">x</code></td>
<td>
<p>The object of class 'icfit' to be printed</p>
</td></tr>
<tr><td><code id="print.icfit_+3A_digits">digits</code></td>
<td>
<p>Number of digits to be printed</p>
</td></tr>
<tr><td><code id="print.icfit_+3A_alpha">alpha</code></td>
<td>
<p>Alpha level to be used of confidence interval ((1-alpha) * 100 percent)</p>
</td></tr>
<tr><td><code id="print.icfit_+3A_...">...</code></td>
<td>
<p>Further arguments to print</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>

<hr>
<h2 id='rasterplot'>Plot probabilities as a raster'</h2><span id='topic+rasterplot'></span>

<h3>Description</h3>

<p>Plot probabilities as a raster'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rasterplot(
  icf,
  type = c("both", "R", "Y"),
  sel = NULL,
  label = NULL,
  show_label = FALSE,
  pow = 0.2,
  order = TRUE,
  do_plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rasterplot_+3A_icf">icf</code></td>
<td>
<p>an object of class 'icfit'</p>
</td></tr>
<tr><td><code id="rasterplot_+3A_type">type</code></td>
<td>
<p>a string giving the type of the plot. Accepted choices: 'R' (risk probabilities) and 'Y' (event probabilities)</p>
</td></tr>
<tr><td><code id="rasterplot_+3A_sel">sel</code></td>
<td>
<p>a vector of integers for selection of subject (rows of the matrix)</p>
</td></tr>
<tr><td><code id="rasterplot_+3A_label">label</code></td>
<td>
<p>character vector containing labels for the individuals to be plotted in selection</p>
</td></tr>
<tr><td><code id="rasterplot_+3A_show_label">show_label</code></td>
<td>
<p>Boolean, whether or not to show the labels</p>
</td></tr>
<tr><td><code id="rasterplot_+3A_pow">pow</code></td>
<td>
<p>a number, giving he power to which the probabilities will be raised, 
to improve the clarity of the plot</p>
</td></tr>
<tr><td><code id="rasterplot_+3A_order">order</code></td>
<td>
<p>Boolean, default (TRUE) is to order according to first positive in Y,
then first zero in Y, then first zero in R; if FALSE order of occurrence in data is used</p>
</td></tr>
<tr><td><code id="rasterplot_+3A_do_plot">do_plot</code></td>
<td>
<p>Boolean, default (TRUE) shows the plot, if FALSE object is returned but not plotted</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object (Grob)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
icf &lt;- icfit(Surv(left, right, type='interval2') ~ period + gender + age,
  data=drugusers)
rasterplot(icf)
rasterplot(icf, type = 'R')
rasterplot(icf, type = 'Y')
rasterplot(icf, pow = 0.05) # very small power basically shows 0/1
sel &lt;- c(
  11, 18,  # right-censored, event in (L, \infty)
  1:2,     # event in (0, R)
  115, 133 # event in (L, R)
)
rasterplot(icf, sel = sel)
rasterplot(icf, sel = sel, label = c("e", "p", "g", "c", "m", "n"), show_label = TRUE)
rasterplot(icf, sel = sel, label = c("e", "p", "g", "c", "m", "n"), show_label = TRUE,
  type = 'Y')


</code></pre>

<hr>
<h2 id='summary.icfit'>Summary method for an object of class 'icfit'</h2><span id='topic+summary.icfit'></span>

<h3>Description</h3>

<p>Summary method for an object of class 'icfit'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'icfit'
summary(
  object,
  lvl = 1,
  digits = max(1L, getOption("digits") - 3L),
  alpha = 0.05,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.icfit_+3A_object">object</code></td>
<td>
<p>Object of class 'icfit'</p>
</td></tr>
<tr><td><code id="summary.icfit_+3A_lvl">lvl</code></td>
<td>
<p>Describes the level of output</p>
</td></tr>
<tr><td><code id="summary.icfit_+3A_digits">digits</code></td>
<td>
<p>Number of digits to be printed</p>
</td></tr>
<tr><td><code id="summary.icfit_+3A_alpha">alpha</code></td>
<td>
<p>Alpha level to be used of confidence interval ((1-alpha) * 100 percent)</p>
</td></tr>
<tr><td><code id="summary.icfit_+3A_...">...</code></td>
<td>
<p>Other arguments to summary</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None (invisible <code>NULL</code>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
icf &lt;- icfit(Surv(left, right, type='interval2') ~ period + gender + age, data=drugusers)
summary(icf)
summary(icf, lvl=0) # same as print(icf)
summary(icf, lvl=1) # extra information on iterations and computation time


</code></pre>

<hr>
<h2 id='summary.predict.icfit'>Summary method for an object of class 'predict.icfit'</h2><span id='topic+summary.predict.icfit'></span>

<h3>Description</h3>

<p>Summary method for an object of class 'predict.icfit'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predict.icfit'
summary(object, times, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.predict.icfit_+3A_object">object</code></td>
<td>
<p>Object of class 'predict.icfit'</p>
</td></tr>
<tr><td><code id="summary.predict.icfit_+3A_times">times</code></td>
<td>
<p>The time points at which to summarize the predicted hazards, cumulative hazards
and survival probabilities, with associated standard errors and confidence intervals</p>
</td></tr>
<tr><td><code id="summary.predict.icfit_+3A_...">...</code></td>
<td>
<p>Other arguments to plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame (if object was a data frame) or a list of data frames (if object was
a list of data frames) with hazards etc linearly interpolated between the time points used
in the predict function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
icf &lt;- icfit(Surv(left, right, type='interval2') ~ period + gender + age,
      data=drugusers)
pred_icf &lt;- predict(icf)
summary(pred_icf, times=c(0, 30, 183, 365))


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
