<!DOCTYPE html><html lang="en"><head><title>Help for package fabisearch</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fabisearch}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AALatlas'><p>Automated Anatomical Labeling (AAL) atlas coordinates</p></a></li>
<li><a href='#AALfmri'><p>90 ROI data from the NYU test-retest resting state fMRI data set</p></a></li>
<li><a href='#adjmatrix'><p>Adjacency matrix for the NYU test-restest resting-state fMRI data set</p></a></li>
<li><a href='#detect.cps'><p>Multiple change point detection in the network (or clustering) structure of multivariate high-dimensional time series</p></a></li>
<li><a href='#est.net'><p>Sparse network estimation using non-negative matrix factorization (NMF) for data between change points</p></a></li>
<li><a href='#fabisearch'><p>Change Point Detection in High-Dimensional Time Series Networks</p></a></li>
<li><a href='#gordatlas'><p>Gordon atlas coordinates</p></a></li>
<li><a href='#gordfmri'><p>333 ROI data from the NYU test-retest resting state fMRI data set</p></a></li>
<li><a href='#logSP500'><p>Daily adjusted logarithmic returns for the Standard and Poor's 500</p></a></li>
<li><a href='#net.3dplot'><p>3D network plot of an adjacency matrix between pairs of change points</p></a></li>
<li><a href='#opt.rank'><p>Finds the optimal rank for non-negative matrix factorization (NMF)</p></a></li>
<li><a href='#sim2'><p>A simulated data set (see simulation 2 from Ondrus et al., 2021)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Change Point Detection in High-Dimensional Time Series Networks</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.4.5</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of the Factorized Binary Search (FaBiSearch) methodology for the estimation of the number and the location of multiple change points in the network (or clustering) structure of multivariate high-dimensional time series. The method is motivated by the detection of change points in functional connectivity networks for functional magnetic resonance imaging (fMRI) data. FaBiSearch uses non-negative matrix factorization (NMF), an unsupervised dimension reduction technique, and a new binary search algorithm to identify multiple change points.  It requires minimal assumptions. Lastly, we provide interactive, 3-dimensional, brain-specific network visualization capability in a flexible, stand-alone function. This function can be conveniently used with any node coordinate atlas, and nodes can be color coded according to community membership, if applicable. The output is an elegantly displayed network laid over a cortical surface, which can be rotated in the 3-dimensional space. The main routines of the package are detect.cps(), for multiple change point detection, est.net(), for estimating a network between stationary multivariate time series, net.3dplot(), for plotting the estimated functional connectivity networks, and opt.rank(), for finding the optimal rank in NMF for a given data set. The functions have been extensively tested on simulated multivariate high-dimensional time series data and fMRI data. For details on the FaBiSearch methodology, please see Ondrus et al. (2021) &lt;<a href="https://doi.org/10.48550/arXiv.2103.06347">doi:10.48550/arXiv.2103.06347</a>&gt;. For a more detailed explanation and applied examples of the fabisearch package, please see Ondrus and Cribben (2022), preprint.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mondrus96/FaBiSearch">https://github.com/mondrus96/FaBiSearch</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>rgl, reshape2, foreach, doParallel, doRNG, parallel</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.10), NMF</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-07 20:12:11 UTC; Martin</td>
</tr>
<tr>
<td>Author:</td>
<td>Martin Ondrus [aut, cre],
  Ivor Cribben [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Martin Ondrus &lt;mondrus@ualberta.ca&gt;</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-12 09:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AALatlas'>Automated Anatomical Labeling (AAL) atlas coordinates</h2><span id='topic+AALatlas'></span>

<h3>Description</h3>

<p>A dataframe of the Automated Anatomical Labeling (AAL) atlas from the work of Tzourio-Mazoyer et al. (2002) atlas to use with the <code><a href="#topic+net.3dplot">net.3dplot</a>()</code>
function. Each row corresponds to a region of interest (ROI) to be plotted using the Montreal Neurological Institute (MNI) space. The first
column corresponds to the community labels (in this atlas, there are none, therefore this column is filled with NA), and the second, third, and
fourth columns correspond to the X, Y, and Z coordinates of the ROIs in MNI space, respectively. See Tzourio-Mazoyer et al. (2002) &lt;doi:10.1006/nimg.2001.0978&gt;
for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AALatlas
</code></pre>


<h3>Format</h3>

<p>A dataframe with 90 rows and 4 columns/variables.
</p>


<h3>Source</h3>

<p>doi: <a href="https://doi.org/10.1006/nimg.2001.0978">10.1006/nimg.2001.0978</a>
</p>

<hr>
<h2 id='AALfmri'>90 ROI data from the NYU test-retest resting state fMRI data set</h2><span id='topic+AALfmri'></span>

<h3>Description</h3>

<p>A data matrix of the second scan from the first subject from the NYU test-retest resting-state fMRI data set. Variables/nodes are defined
using the Tzourio-Mazoyer et al. (2002) Automatic Anatomical Labeling (AAL) atlas, which can be accessed as the <code>AALatlas</code> dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AALfmri
</code></pre>


<h3>Format</h3>

<p>A data matrix with 197 rows and 90 columns/variables, where each column corresponds to an ROI from the AAL atlas.
</p>


<h3>Source</h3>

<p><a href="https://www.nitrc.org/projects/nyu_trt/">https://www.nitrc.org/projects/nyu_trt/</a>
</p>

<hr>
<h2 id='adjmatrix'>Adjacency matrix for the NYU test-restest resting-state fMRI data set</h2><span id='topic+adjmatrix'></span>

<h3>Description</h3>

<p>The adjacency matrix calculated from the <code>gordfmri</code> data set, using the Gordon atlas.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adjmatrix
</code></pre>


<h3>Format</h3>

<p>A 333 * 333 matrix, where each entry takes a value 1 (0) if two nodes are (not) connected by an edge, using the Gordon atlas.
</p>


<h3>Source</h3>

<p><a href="https://www.nitrc.org/projects/nyu_trt/">https://www.nitrc.org/projects/nyu_trt/</a>
</p>

<hr>
<h2 id='detect.cps'>Multiple change point detection in the network (or clustering) structure of multivariate high-dimensional time series</h2><span id='topic+detect.cps'></span>

<h3>Description</h3>

<p>This function detects multiple change points in the network (or clustering) structure of multivariate high-dimensional time series using
non-negative matrix factorization and a binary search.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect.cps(
  Y,
  mindist = 35,
  nruns = 50,
  nreps = 100,
  alpha = NULL,
  rank = NULL,
  algtype = "brunet",
  testtype = "t-test",
  ncore = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="detect.cps_+3A_y">Y</code></td>
<td>
<p>An input multivariate time series in matrix format, with variables organized in columns and time points in rows. All entries in Y must be positive.</p>
</td></tr>
<tr><td><code id="detect.cps_+3A_mindist">mindist</code></td>
<td>
<p>A positive integer with default value equal to 35. It is used to define the minimum distance acceptable between detected change points.</p>
</td></tr>
<tr><td><code id="detect.cps_+3A_nruns">nruns</code></td>
<td>
<p>A positive integer with default value equal to 50. It is used to define the number of runs in the NMF function.</p>
</td></tr>
<tr><td><code id="detect.cps_+3A_nreps">nreps</code></td>
<td>
<p>A positive integer with default value equal to 100. It is used to define the number of permutations for the statistical inference procedure.</p>
</td></tr>
<tr><td><code id="detect.cps_+3A_alpha">alpha</code></td>
<td>
<p>A positive real number with default value set to NULL. When alpha = NULL, then the p-value calculated for inference on the change
points is returned. If alpha = a positive integer value, say 0.05, then it is used to define the significance level for inference on the change points.</p>
</td></tr>
<tr><td><code id="detect.cps_+3A_rank">rank</code></td>
<td>
<p>A positive integer, which defines the rank used in the optimization procedure to detect the change points. If rank = NULL, which is also the
default value, then the optimal rank is computed. If rank = a positive integer value, say 4, then a predetermined rank is used.</p>
</td></tr>
<tr><td><code id="detect.cps_+3A_algtype">algtype</code></td>
<td>
<p>A character string, which defines the algorithm to be used in the NMF function. By default it is set to &quot;brunet&quot;. See the &quot;Algorithms&quot; section of
<code><a href="NMF.html#topic+nmf">nmf</a></code> for more information on the available algorithms.</p>
</td></tr>
<tr><td><code id="detect.cps_+3A_testtype">testtype</code></td>
<td>
<p>A character string, which defines the type of statistical test to use during the inference procedure. By default it is set to &quot;t-test&quot;. The
other options are &quot;ks&quot; and &quot;wilcox&quot; which correspond to the Kolmogorov-Smirnov and Wilcoxon tests, respectively.</p>
</td></tr>
<tr><td><code id="detect.cps_+3A_ncore">ncore</code></td>
<td>
<p>A positive integer with default value equal to 1. It is used to define the number of cores to use in the procedure</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components :<br />
<code>rank</code>: The rank used in the optimization procedure for change point detection.<br />
<code>change_points</code>: A table of the detected change points where column &quot;T&quot; is the time of the change point and &quot;stat_test&quot; is the result (either a boolean value if alpha = a positive real number, or the p-value if alpha = NULL) of the t-test.<br />
<code>compute_time</code>: The computational time, saved as a &quot;difftime&quot; object.<br />
</p>


<h3>Author(s)</h3>

<p>Martin Ondrus, <a href="mailto:mondrus@ualberta.ca">mondrus@ualberta.ca</a>, Ivor Cribben, <a href="mailto:cribben@ualberta.ca">cribben@ualberta.ca</a>
</p>


<h3>References</h3>

<p>&quot;Factorized Binary Search: a novel technique for change point detection in multivariate high-dimensional time series networks&quot;, Ondrus et al.
(2021), &lt;arXiv:2103.06347&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Change point detection for a multivariate data set, sim2, using settings:
## rank = 3, mindist = 99, nruns = 2, and nreps = 2
set.seed(123)
detect.cps(sim2, rank = 3, mindist = 99, nruns = 2, nreps = 2)


# $rank
# [1] 3
#
# $change_points
#     T stat_test
# 1 101 0.3867274
#
# $compute_time
# Time difference of 0.741534 mins

</code></pre>

<hr>
<h2 id='est.net'>Sparse network estimation using non-negative matrix factorization (NMF) for data between change points</h2><span id='topic+est.net'></span>

<h3>Description</h3>

<p>This function estimates sparse networks using non-negative matrix factorization (NMF) for data between change points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est.net(
  Y,
  lambda,
  nruns = 50,
  rank = "optimal",
  algtype = "brunet",
  changepoints = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="est.net_+3A_y">Y</code></td>
<td>
<p>An input multivariate time series in matrix format, with variables organized in columns and time points in rows. All entries in Y must be positive.</p>
</td></tr>
<tr><td><code id="est.net_+3A_lambda">lambda</code></td>
<td>
<p>A positive real number, which defines the clustering method and/or the cutoff value when estimating an adjacency matrix from the computed
consensus matrix. If lambda = a positive integer value, say 6, complete-linkage, hierarchical clustering is applied to the consensus matrix and the cutoff is at
6 clusters. If lambda is a vector of positive integer values, say c(4, 5, 6), the same clustering method is applied for each value sequentially. If lambda
= a positive real number, say 0.5, entries in the consensus matrix with a value greater than or equal to 0.5 are labeled 1, while entries less than 0.5 are
labeled 0. Similarly, if lambda is a vector of positive real numbers, say c(0.1, 0.3, 0.8), the same thresholding method is applied for each value
sequentially.</p>
</td></tr>
<tr><td><code id="est.net_+3A_nruns">nruns</code></td>
<td>
<p>A positive integer with default value equal to 50. It is used to define the number of runs in the NMF function.</p>
</td></tr>
<tr><td><code id="est.net_+3A_rank">rank</code></td>
<td>
<p>A character string or a positive integer, which defines the rank used in the optimization procedure to detect the change points.
If rank = &quot;optimal&quot;, which is also the default value, then the optimal rank is used. If rank = a positive integer value, say 4, then a predetermined
rank is used.</p>
</td></tr>
<tr><td><code id="est.net_+3A_algtype">algtype</code></td>
<td>
<p>A character string, which defines the algorithm to be used in the NMF function. By default it is set to &quot;brunet&quot;. See the &quot;Algorithms&quot; section of
<code><a href="NMF.html#topic+nmf">nmf</a></code> for more information on the available algorithms.</p>
</td></tr>
<tr><td><code id="est.net_+3A_changepoints">changepoints</code></td>
<td>
<p>A vector of positive integers with default value equal to <code>NULL</code>. It is used to specify whether change points exist in the input <code class="reqn">Y</code>, and
thus whether <code class="reqn">Y</code> should be split into multiple stationary segments and networks estimated separately for each segment. If change points, say c(100, 200) are specified,
<code class="reqn">Y</code> is split at the 100th and 200th row to correspond to 3 stationary segments. Each stationary segment is then estimated sequentially, and
a list is returned where each component corresponds to a stationary segment.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix (or more specifically, an adjacency matrix) denoting the network (or clustering) structure between components of <code class="reqn">Y</code>. If lambda is a
vector, a list of adjacency matrices is returned, where each element of the list corresponds to an element in lambda.
</p>


<h3>Author(s)</h3>

<p>Martin Ondrus, <a href="mailto:mondrus@ualberta.ca">mondrus@ualberta.ca</a>, Ivor Cribben, <a href="mailto:cribben@ualberta.ca">cribben@ualberta.ca</a>
</p>


<h3>References</h3>

<p>&quot;Factorized Binary Search: a novel technique for change point detection in multivariate high-dimensional time series networks&quot;, Ondrus et al.
(2021), &lt;arXiv:2103.06347&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Estimating the network for a multivariate data set, "sim2" with the settings:
## nruns = 10 and lambda = 0.5 where the latter specifies the cutoff based method
est.net(sim2, lambda = 0.5, nruns = 4)


</code></pre>

<hr>
<h2 id='fabisearch'>Change Point Detection in High-Dimensional Time Series Networks</h2><span id='topic+fabisearch'></span>

<h3>Description</h3>

<p>Implementation of the Factorized Binary Search (FaBiSearch) methodology for the estimation of the number and the location of multiple change points in the network (or clustering) structure of multivariate high-dimensional time series. The method is motivated by the detection of change points in functional connectivity networks for functional magnetic resonance imaging (fMRI) data. FaBiSearch uses non-negative matrix factorization (NMF), an unsupervised dimension reduction technique, and a new binary search algorithm to identify multiple change points.  It requires minimal assumptions. Lastly, we provide interactive, 3-dimensional, brain-specific network visualization capability in a flexible, stand-alone function. This function can be conveniently used with any node coordinate atlas, and nodes can be color coded according to community membership, if applicable. The output is an elegantly displayed network laid over a cortical surface, which can berotated in the 3-dimensional space. The main routines of the package are <code><a href="#topic+detect.cps">detect.cps</a>()</code>, for multiple change point detection, <code><a href="#topic+est.net">est.net</a>()</code>, for estimating a network between stationary multivariate time series, <code><a href="#topic+net.3dplot">net.3dplot</a>()</code>, for plotting the estimated functional connectivity networks, and <code><a href="#topic+opt.rank">opt.rank</a>()</code>, for finding the optimal rank in NMF for a given data set. The functions have been extensively tested on simulated multivariate high-dimensional time series data and fMRI data. For details on the FaBiSearch methodology, please see Ondrus et al. (2021) &lt;arXiv:2103.06347&gt;. For a more detailed explanation and applied examples of the <code>fabisearch</code> package, please see Ondrus and Cribben (2021), preprint.</p>


<h3>Value</h3>

<p>No return value, called for side effects</p>


<h3>See Also</h3>

<p><code><a href="#topic+detect.cps">detect.cps</a>, <a href="#topic+est.net">est.net</a>, <a href="#topic+net.3dplot">net.3dplot</a>, <a href="#topic+opt.rank">opt.rank</a></code></p>


<h3>Author(s)</h3>

<p>Martin Ondrus, <a href="mailto:mondrus@ualberta.ca">mondrus@ualberta.ca</a>, Ivor Cribben, <a href="mailto:cribben@ualberta.ca">cribben@ualberta.ca</a></p>


<h3>References</h3>

<p>&quot;Factorized Binary Search: a novel technique for change point detection in multivariate high-dimensional time series networks&quot;, Ondrus et al (2021), &lt;arXiv:2103.06347&gt;.</p>

<hr>
<h2 id='gordatlas'>Gordon atlas coordinates</h2><span id='topic+gordatlas'></span>

<h3>Description</h3>

<p>A dataframe of the Gordon et al. (2016) atlas to use with the <code><a href="#topic+net.3dplot">net.3dplot</a>()</code> function. Each row corresponds to a region of interest
(ROI) to be plotted using the Montreal Neurological Institute (MNI) space. The first column corresponds to the community labels as a string,
and the second, third, and fourth columns correspond to the X, Y, and Z coordinates of the ROIs in MNI space, respectively. See Gordon et al. (2016)
&lt;doi:10.1093/cercor/bhu239&gt; for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gordatlas
</code></pre>


<h3>Format</h3>

<p>A dataframe with 333 rows and 4 columns/variables.
</p>


<h3>Source</h3>

<p>doi: <a href="https://doi.org/10.1093/cercor/bhu239">10.1093/cercor/bhu239</a>
</p>

<hr>
<h2 id='gordfmri'>333 ROI data from the NYU test-retest resting state fMRI data set</h2><span id='topic+gordfmri'></span>

<h3>Description</h3>

<p>A data matrix of the second scan from the first subject from the NYU test-retest resting-state fMRI data set. Variables/nodes are defined
using the Gordon et al. (2016) atlas , which can be accessed as the <code>gordatlas</code> dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gordfmri
</code></pre>


<h3>Format</h3>

<p>A data matrix with 197 rows and 333 columns/variables, where each column corresponds to an ROI from the Gordon atlas.
</p>


<h3>Source</h3>

<p><a href="https://www.nitrc.org/projects/nyu_trt/">https://www.nitrc.org/projects/nyu_trt/</a>
</p>

<hr>
<h2 id='logSP500'>Daily adjusted logarithmic returns for the Standard and Poor's 500</h2><span id='topic+logSP500'></span>

<h3>Description</h3>

<p>A dataframe of the daily adjusted logarithmic returns for the Standard and Poor's 500 (S&amp;P 500) stock market index. Each row corresponds to a
trading day from 2018-01-01 to 2021-03-31. Data was retrieved from Yahoo Finance using the <code>getSymbols()</code> function from the <code>quantmod</code>
package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logSP500
</code></pre>


<h3>Format</h3>

<p>A dataframe with 815 rows and 500 columns/variables.
</p>

<hr>
<h2 id='net.3dplot'>3D network plot of an adjacency matrix between pairs of change points</h2><span id='topic+net.3dplot'></span>

<h3>Description</h3>

<p>This function takes an adjacency matrix of a brain network and returns a 3D plot of it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>net.3dplot(A, ROIs = NULL, colors = NULL, coordROIs = NULL, labels = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="net.3dplot_+3A_a">A</code></td>
<td>
<p>An adjacency matrix to be plotted (in numerical matrix format).</p>
</td></tr>
<tr><td><code id="net.3dplot_+3A_rois">ROIs</code></td>
<td>
<p>Either a vector of character strings specifying the communities to plot, or a vector of integers specifying which ROIs to plot by their ID. By
default it is set to NULL, and all communities and ROIs are plotted. Communities available for the Gordon atlas are: &quot;Default&quot;, &quot;SMhand&quot;, &quot;SMmouth&quot;,
&quot;Visual&quot;, &quot;FrontoParietal&quot;, &quot;Auditory&quot;, &quot;None&quot;, &quot;CinguloParietal&quot;, &quot;RetrosplenialTemporal&quot;, &quot;CinguloOperc&quot;, &quot;VentralAttn&quot;, &quot;Salience&quot;, and &quot;DorsalAttn&quot;.</p>
</td></tr>
<tr><td><code id="net.3dplot_+3A_colors">colors</code></td>
<td>
<p>A vector of character strings specifying the hex codes for node colors to distinguish each community. By default, each community is given
a predefined, unique color.</p>
</td></tr>
<tr><td><code id="net.3dplot_+3A_coordrois">coordROIs</code></td>
<td>
<p>A dataframe of community tags and Montreal Neurological Institute (MNI) coordinates for regions of interest (ROIs) to plot, which is by
default set to <code>NULL</code> and uses the Gordon atlas. See ?gordon.atlas for an example using the Gordon atlas. Format of the dataframe is as follows: first column
is a string of community labels, then the subsequent three columns are the x, y, and z coordinates, respectively. See <code>AALatlas</code> and <code>gordatlas</code>
for examples.</p>
</td></tr>
<tr><td><code id="net.3dplot_+3A_labels">labels</code></td>
<td>
<p>A boolean value denoting whether to add labels to nodes; if set to TRUE, this will add node labels to the plot, and if set to FALSE, will not.
By default this is set to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 3D network plot of an adjacency matrix between pairs of change points, or for data without change points.
</p>


<h3>Author(s)</h3>

<p>Martin Ondrus, <a href="mailto:mondrus@ualberta.ca">mondrus@ualberta.ca</a>, Ivor Cribben, <a href="mailto:cribben@ualberta.ca">cribben@ualberta.ca</a>
</p>


<h3>References</h3>

<p>&quot;Factorized Binary Search: a novel technique for change point detection in multivariate high-dimensional time series networks&quot;, Ondrus et al.
(2021), &lt;arXiv:2103.06347&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Plotting a 333 * 333 adjacency matrix "adjmatrix" with red, blue, and green
## nodes to denote the "Default", "SMhand", and "Visual" communities
comms = c("Default", "SMhand", "Visual")
colrs = c("#FF0000", "#00FF00", "#0000FF")
net.3dplot(adjmatrix, ROIs = comms, colors = colrs)


</code></pre>

<hr>
<h2 id='opt.rank'>Finds the optimal rank for non-negative matrix factorization (NMF)</h2><span id='topic+opt.rank'></span>

<h3>Description</h3>

<p>This function finds the optimal rank for non-negative matrix factorization (NMF).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opt.rank(Y, nruns = 50, algtype = "brunet")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="opt.rank_+3A_y">Y</code></td>
<td>
<p>An input multivariate time series in matrix format, with variables organized in columns and time points in rows. All entries in Y must be positive.</p>
</td></tr>
<tr><td><code id="opt.rank_+3A_nruns">nruns</code></td>
<td>
<p>A positive integer with default value equal to 50. It is used to define the number of runs in the NMF function.</p>
</td></tr>
<tr><td><code id="opt.rank_+3A_algtype">algtype</code></td>
<td>
<p>A character string, which defines the algorithm to be used in the NMF function. By default it is set to &quot;brunet&quot;. See the &quot;Algorithms&quot; section of
<code><a href="NMF.html#topic+nmf">nmf</a></code> for more information on the available algorithms.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A positive integer representing the optimal rank.
</p>


<h3>Author(s)</h3>

<p>Martin Ondrus, <a href="mailto:mondrus@ualberta.ca">mondrus@ualberta.ca</a>, Ivor Cribben, <a href="mailto:cribben@ualberta.ca">cribben@ualberta.ca</a>
</p>


<h3>References</h3>

<p>&quot;Factorized Binary Search: a novel technique for change point detection in multivariate high-dimensional time series networks&quot;, Ondrus et al.
(2021), &lt;arXiv:2103.06347&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Finding the optimal rank for an input data set "sim2" with nruns = 4
set.seed(123)
opt.rank(sim2, nruns = 4)
# [1] "Finding optimal rank"
# [1] "Optimal rank: 2"
# [1] 2


</code></pre>

<hr>
<h2 id='sim2'>A simulated data set (see simulation 2 from Ondrus et al., 2021)</h2><span id='topic+sim2'></span>

<h3>Description</h3>

<p>A simulated data set (see simulation 2 from Ondrus et al., 2021). The data is generated from a multivariate Gaussian distribution with 2
clusters, where the correlation between nodes in the same cluster is 0.75 and between different clusters is 0.2 for the first 100 time
points. The vertex labels are randomly reshuflled for the second 100 time points. Hence, there is one change point at t=100.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim2
</code></pre>


<h3>Format</h3>

<p>A matrix with 200 rows and 80 columns/variables.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
