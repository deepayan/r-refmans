<!DOCTYPE html><html><head><title>Help for package GSED</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GSED}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#boundaries_sim'><p>Lower and upper boundaries for GSED</p></a></li>
<li><a href='#GSED-package'>
<p>Group Sequential Enrichment Design</p></a></li>
<li><a href='#magnusson_turnbull'><p>Application of GSED on data</p></a></li>
<li><a href='#max_FI'><p>Maximum Fisher information</p></a></li>
<li><a href='#sim_magnusson_turnbull'><p>Simulations of trials with GSED</p></a></li>
<li><a href='#stage_1_evaluation'><p>Stage 1-evaluation step of GSED</p></a></li>
<li><a href='#stage_1_selection'><p>Stage 1-selection step of GSED</p></a></li>
<li><a href='#test_BC'><p>For internal use</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Group Sequential Enrichment Design</td>
</tr>
<tr>
<td>Version:</td>
<td>2.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-31</td>
</tr>
<tr>
<td>Author:</td>
<td>Marie-Karelle Riviere</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marie-Karelle Riviere &lt;eldamjh@gmail.com&gt;</td>
</tr>
<tr>
<td>Copyright:</td>
<td>All files are copyright Sanofi Aventis</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides function to apply "Group sequential enrichment design incorporating subgroup selection" (GSED) method proposed by Magnusson and Turnbull (2013) &lt;<a href="https://doi.org/10.1002%2Fsim.5738">doi:10.1002/sim.5738</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.2), memoise (&ge; 1.0.0), rootSolve (&ge; 1.6.6),
survival (&ge; 2.37-7), R.utils (&ge; 2.3.0)</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-31 09:30:43 UTC; Marie-Karelle</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-31 10:10:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='boundaries_sim'>Lower and upper boundaries for GSED</h2><span id='topic+boundaries_sim'></span>

<h3>Description</h3>

<p><code>boundaries_sim</code> is used to estimate lower and upper boundaries for GSED based on simulations of trials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boundaries_sim(K_stages, N_subsets, f, ratio_Delta_star_d1, ordering, 
increasing_theta=FALSE, seed=42, n_trials, alpha_spending, 
one_minus_alpha_spending, updateProgress=NULL)
</code></pre>


<h3>Arguments</h3>

                
<table>
<tr><td><code id="boundaries_sim_+3A_k_stages">K_stages</code></td>
<td>
<p>Integer indicating the number of stages in the design.</p>
</td></tr>
<tr><td><code id="boundaries_sim_+3A_n_subsets">N_subsets</code></td>
<td>
<p>Integer representing the number of possible subgroups.</p>
</td></tr>
<tr><td><code id="boundaries_sim_+3A_f">f</code></td>
<td>
<p>Vector containing the prevalence rates of each subgroup. Must be of length <code>N_subsets</code>.</p>
</td></tr>
<tr><td><code id="boundaries_sim_+3A_ratio_delta_star_d1">ratio_Delta_star_d1</code></td>
<td>
<p>Vector containing the ratio between the (observed Fisher) information increments at each stage &gt;1 with the (observed Fisher) information at stage 1. Must be of length <code>K_stages</code>-1.</p>
</td></tr>
<tr><td><code id="boundaries_sim_+3A_ordering">ordering</code></td>
<td>
<p>Boolean indicating if the subgroups (theta) are ordered.</p>
</td></tr>
<tr><td><code id="boundaries_sim_+3A_increasing_theta">increasing_theta</code></td>
<td>
<p>Boolean indicating if greater values of theta parameters represent better treatment effects. The default value is set at FALSE.</p>
</td></tr>
<tr><td><code id="boundaries_sim_+3A_seed">seed</code></td>
<td>
<p>Interger representing the seed. The default value is set at 42.</p>
</td></tr>
<tr><td><code id="boundaries_sim_+3A_n_trials">n_trials</code></td>
<td>
<p>Integer indicating the number of trials to simulate.</p>
</td></tr>
<tr><td><code id="boundaries_sim_+3A_alpha_spending">alpha_spending</code></td>
<td>
<p>Vector containing the values of the alpha-spending function at each time of the analysis (including 0 at time 0 and alpha at time 1). Must be of length <code>K_stages</code>+1.</p>
</td></tr>
<tr><td><code id="boundaries_sim_+3A_one_minus_alpha_spending">one_minus_alpha_spending</code></td>
<td>
<p>Vector containing the values of the 1-alpha-spending function at each time of the analysis (including 0 at time 0 and 1-alpha at time 1). Must be of length <code>K_stages</code>+1.</p>
</td></tr>
<tr><td><code id="boundaries_sim_+3A_updateprogress">updateProgress</code></td>
<td>
<p>(for Rshiny application)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned, consisting of two vectors containing the lower and upper boundaries:
</p>
<table>
<tr><td><code>l</code></td>
<td>
<p>Vector of lower boundaries at each stage.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>Vector of upper boundaries at each stage.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marie-Karelle Riviere-Jourdan <a href="mailto:eldamjh@gmail.com">eldamjh@gmail.com</a></p>


<h3>References</h3>

<p>Baldur P. Magnusson and Bruce W. Turnbull. Group sequential enrichment design incorporating subgroup selection. Statistics in Medicine, 2013. &lt;doi:10.1002/sim.5738&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#For testing purpose only, larger number of simulations required (see in comments below)
boundaries_sim(K_stages=2, N_subsets=3, f=c(0.6,0.2,0.2), ratio_Delta_star_d1=c(1), 
ordering=FALSE, seed=42, n_trials=3, alpha_spending=c(0,0.0125,0.025), 
one_minus_alpha_spending=c(0,0.4875,0.975))

#boundaries_sim(K_stages=2, N_subsets=3, f=c(0.6,0.2,0.2), ratio_Delta_star_d1=c(1), 
#ordering=FALSE, seed=42, n_trials=10000000, alpha_spending=c(0,0.0125,0.025), 
#one_minus_alpha_spending=c(0,0.4875,0.975))
</code></pre>

<hr>
<h2 id='GSED-package'>
Group Sequential Enrichment Design
</h2><span id='topic+GSED-package'></span><span id='topic+GSED'></span>

<h3>Description</h3>

<p>Provides function to apply &quot;Group sequential enrichment design incorporating subgroup selection&quot; (GSED) method proposed by Magnusson and Turnbull (2013) &lt;doi:10.1002/sim.5738&gt;.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> GSED</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.6</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-08-31</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Marie-Karelle Riviere-Jourdan &lt;eldamjh@gmail.com&gt;
</p>


<h3>References</h3>

<p>Baldur P. Magnusson and Bruce W. Turnbull. Group sequential enrichment design incorporating subgroup selection. Statistics in Medicine, 2013. &lt;doi:10.1002/sim.5738&gt;
</p>

<hr>
<h2 id='magnusson_turnbull'>Application of GSED on data</h2><span id='topic+magnusson_turnbull'></span>

<h3>Description</h3>

<p><code>magnusson_turnbull</code> is used apply GSED design, selection or evaluation at each stage, on data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>magnusson_turnbull(stage_cur, keep=NA, N_subsets, Y, I, l, u, ordering, 
increasing_theta=FALSE)
</code></pre>


<h3>Arguments</h3>

                
<table>
<tr><td><code id="magnusson_turnbull_+3A_stage_cur">stage_cur</code></td>
<td>
<p>Integer representing the current stage. 0 represents selection at stage 1, 1 represents evaluation at stage 1, while k (&gt;1) represents evaluation at stage k.</p>
</td></tr>
<tr><td><code id="magnusson_turnbull_+3A_keep">keep</code></td>
<td>
<p>Vector of indices of selected subgroups if selection at stage 1 is already performed. Values must be between 1 and <code>N_subsets</code>. By default filled with NA if the function is run for selection step.</p>
</td></tr>
<tr><td><code id="magnusson_turnbull_+3A_n_subsets">N_subsets</code></td>
<td>
<p>Integer representing the number of possible subgroups.</p>
</td></tr>
<tr><td><code id="magnusson_turnbull_+3A_y">Y</code></td>
<td>
<p>Efficient score test statistics. For <code>stage_cur</code>&gt;0 (evaluation at stage 1 or k (k&gt;1),), value representing the efficient score test statistic for all (pooled) selected subgroup. For <code>stage_cur</code>=0 (selection at stage 1), vector representing the efficient score test statistic for each subgroup.</p>
</td></tr>
<tr><td><code id="magnusson_turnbull_+3A_i">I</code></td>
<td>
<p>Observed Fisher information. For <code>stage_cur</code>&gt;0 (evaluation at stage 1 or k (k&gt;1),), value representing the observed Fisher information for all (pooled) selected subgroup. For <code>stage_cur</code>=0 (selection at stage 1), vector representing the observed Fisher information for each subgroup.</p>
</td></tr>
<tr><td><code id="magnusson_turnbull_+3A_l">l</code></td>
<td>
<p>Vector containing the lower boundaries for stagewise decisions.</p>
</td></tr>
<tr><td><code id="magnusson_turnbull_+3A_u">u</code></td>
<td>
<p>Vector containing the upper boundaries for stagewise decisions.</p>
</td></tr>
<tr><td><code id="magnusson_turnbull_+3A_ordering">ordering</code></td>
<td>
<p>Boolean indicating if the subgroups (theta) are ordered.</p>
</td></tr>
<tr><td><code id="magnusson_turnbull_+3A_increasing_theta">increasing_theta</code></td>
<td>
<p>Boolean indicating if greater values of theta parameters represent better treatment effects. The default value is set at FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An list is returned, consisting of: 
</p>
<table>
<tr><td><code>Rejection</code></td>
<td>
<p>Interger with value 1 if the decision is to reject the null hypothesis, 0 otherwise.</p>
</td></tr>
<tr><td><code>Acceptation</code></td>
<td>
<p>Interger with value 1 if the decision is to accept the null hypothesis, 0 otherwise.</p>
</td></tr>
<tr><td><code>Keep</code></td>
<td>
<p>Vector of indices of selected subgroups (between 1 and <code>N_subsets</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marie-Karelle Riviere-Jourdan <a href="mailto:eldamjh@gmail.com">eldamjh@gmail.com</a></p>


<h3>References</h3>

<p>Baldur P. Magnusson and Bruce W. Turnbull. Group sequential enrichment design incorporating subgroup selection. Statistics in Medicine, 2013. &lt;doi:10.1002/sim.5738&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>magnusson_turnbull(stage_cur=0, keep=NA, N_subsets=3, Y=c(-10.71,12.84,19.06), 
I=c(480,144,176), l=c(0.7962,2.5204), u=c(2.7625,2.5204), ordering=FALSE)

magnusson_turnbull(stage_cur=2, keep=c(2,3), N_subsets=3, Y=135.57, 
I=1120, l=c(0.7962,2.5204), u=c(2.7625,2.5204), ordering=FALSE)
</code></pre>

<hr>
<h2 id='max_FI'>Maximum Fisher information</h2><span id='topic+max_FI'></span>

<h3>Description</h3>

<p><code>max_FI</code> is used to estimate maximum Fisher information based on two power criteria. 
- The first criterion consider the maxmimum Fisher information such that there is a pre-defined power to declare efficacy in the entire population for a given vector of parameters representing treatment effetcs in each subgroup.
- The second criterion consider the maxmimum Fisher information such that there is a pre-defined power to declare efficacy in at least one subgroup for a given vector of parameters representing treatment effetcs in each subgroup.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>max_FI(K_stages, N_subsets, f, ratio_Delta_star_d1, l, u, type_outcome, param_theta, 
pow, ordering, increasing_theta=FALSE, seed=42, n_trials, rule, updateProgress=NULL)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="max_FI_+3A_k_stages">K_stages</code></td>
<td>
<p>Integer indicating the number of stages in the design.</p>
</td></tr>
<tr><td><code id="max_FI_+3A_n_subsets">N_subsets</code></td>
<td>
<p>Integer representing the number of possible subgroups.</p>
</td></tr>
<tr><td><code id="max_FI_+3A_f">f</code></td>
<td>
<p>Vector containing the prevalence rates of each subgroup. Must be of length <code>N_subsets</code>.</p>
</td></tr>
<tr><td><code id="max_FI_+3A_ratio_delta_star_d1">ratio_Delta_star_d1</code></td>
<td>
<p>Vector containing the ratio between the (observed Fisher) information increments at each stage &gt;1 with the (observed Fisher) information at stage 1. Must be of length <code>K_stages</code>-1.</p>
</td></tr>
<tr><td><code id="max_FI_+3A_l">l</code></td>
<td>
<p>Vector containing the lower boundaries for stagewise decisions. Must be of length <code>K_stages</code>.</p>
</td></tr>
<tr><td><code id="max_FI_+3A_u">u</code></td>
<td>
<p>Vector containing the upper boundaries for stagewise decisions. Must be of length <code>K_stages</code>.</p>
</td></tr>
<tr><td><code id="max_FI_+3A_type_outcome">type_outcome</code></td>
<td>
<p>A string containing the type of outcome, either &quot;survival&quot;, &quot;binary&quot;, or &quot;continuous&quot;.</p>
</td></tr>
<tr><td><code id="max_FI_+3A_param_theta">param_theta</code></td>
<td>
<p>Vector of parameters representing treatment effects in each subgroup. Must satisfy the properties detailed in Magnusson and Turnbull's article (reparametrization can be needed).</p>
</td></tr>
<tr><td><code id="max_FI_+3A_pow">pow</code></td>
<td>
<p>Value representing the desired power.</p>
</td></tr>
<tr><td><code id="max_FI_+3A_ordering">ordering</code></td>
<td>
<p>Boolean indicating if the subgroups (theta) are ordered.</p>
</td></tr>
<tr><td><code id="max_FI_+3A_increasing_theta">increasing_theta</code></td>
<td>
<p>Boolean indicating if greater values of theta parameters represent better treatment effects. The default value is set at FALSE.</p>
</td></tr>
<tr><td><code id="max_FI_+3A_seed">seed</code></td>
<td>
<p>Interger representing the seed. The default value is set at 42.</p>
</td></tr>
<tr><td><code id="max_FI_+3A_n_trials">n_trials</code></td>
<td>
<p>Integer indicating the number of trials to simulate.</p>
</td></tr>
<tr><td><code id="max_FI_+3A_rule">rule</code></td>
<td>
<p>Integer with value either 1 or 2 for power criteria detailed in description section (1 for entire population, 2 for at least one subgroup).</p>
</td></tr>
<tr><td><code id="max_FI_+3A_updateprogress">updateProgress</code></td>
<td>
<p>(for Rshiny application)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value representing the maximum Fisher information is returned.
</p>


<h3>Author(s)</h3>

<p>Marie-Karelle Riviere-Jourdan <a href="mailto:eldamjh@gmail.com">eldamjh@gmail.com</a></p>


<h3>References</h3>

<p>Baldur P. Magnusson and Bruce W. Turnbull. Group sequential enrichment design incorporating subgroup selection. Statistics in Medicine, 2013. &lt;doi:10.1002/sim.5738&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>theta_assumption = list(matrix(c(0.4,0.6,0.4,0.6,0.4,0.6),nrow=2,ncol=3))

#For testing purpose only, larger number of simulations required (see in comments below)
max_FI(K_stages=2, N_subsets=3, f=c(0.6,0.2,0.2), ratio_Delta_star_d1=c(1), l=c(0.7962, 2.5204), 
u=c(2.7625, 2.5204), type_outcome="binary", param_theta=theta_assumption, pow=0.9, 
ordering=FALSE, increasing_theta=FALSE, seed=140691, n_trials=3, rule=1)
       
#max_FI(K_stages=2, N_subsets=3, f=c(0.6,0.2,0.2), ratio_Delta_star_d1=c(1), l=c(0.7962, 2.5204), 
#u=c(2.7625, 2.5204), type_outcome="binary", param_theta=theta_assumption, pow=0.9, 
#ordering=FALSE, increasing_theta=FALSE, seed=140691, n_trials=10000000, rule=1)

#max_FI(K_stages=2, N_subsets=3, f=c(0.6,0.2,0.2), ratio_Delta_star_d1=c(1), l=c(0.7962, 2.5204), 
#u=c(2.7625, 2.5204), type_outcome="binary", param_theta=theta_assumption, pow=0.9,
#ordering=FALSE, increasing_theta=FALSE, seed=140691, n_trials=10000000, rule=2)
</code></pre>

<hr>
<h2 id='sim_magnusson_turnbull'>Simulations of trials with GSED</h2><span id='topic+sim_magnusson_turnbull'></span>

<h3>Description</h3>

<p><code>sim_magnusson_turnbull</code> is used to simulate clincal trials with GSED for different type of outcome (survival, binary, continuous).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_magnusson_turnbull(K_stages, N_subsets, f, l, u, ratio_Delta_star_d1, type_outcome, 
param_outcome=NA, n_max=NA, incl_rate=NA, mean_cur_c=NA, HR=NA, nb_required=NA, 
nmax_wait=+Inf, ordering, increasing_theta=FALSE, nsim=1000, seed=42,
nsim_tot=NA, num_sc=1, updateProgress=NULL)
</code></pre>


<h3>Arguments</h3>

  
<table>
<tr><td><code id="sim_magnusson_turnbull_+3A_k_stages">K_stages</code></td>
<td>
<p>Integer indicating the number of stages in the design.</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_n_subsets">N_subsets</code></td>
<td>
<p>Integer representing the number of possible subgroups.</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_f">f</code></td>
<td>
<p>Vector containing the prevalence rates of each subgroup. Must be of length <code>N_subsets</code>.</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_l">l</code></td>
<td>
<p>Vector containing the lower boundaries for stagewise decisions. Must be of length <code>K_stages</code>.</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_u">u</code></td>
<td>
<p>Vector containing the upper boundaries for stagewise decisions. Must be of length <code>K_stages</code>.</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_ratio_delta_star_d1">ratio_Delta_star_d1</code></td>
<td>
<p>Vector containing the ratio between the (observed Fisher) information increments at each stage &gt;1 with the (observed Fisher) information at stage 1. Must be of length <code>K_stages</code>-1.</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_type_outcome">type_outcome</code></td>
<td>
<p>A string containing the type of outcome, either &quot;survival&quot;, &quot;binary&quot;, or &quot;continuous&quot;.</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_param_outcome">param_outcome</code></td>
<td>
<p>Must be supplied only if <code>type_outcome</code> is equal to &quot;binary&quot; or &quot;continuous&quot;. The parameters supplied for the binary outcome must be a list of one element containing a matrix of size 2x<code>N_subsets</code>. The parameters supplied for the continuous outcome must be a list of two elements containing two matrices of size 2x<code>N_subsets</code>. The matrices should contain probabilities of response, or the means and variances respectively, for in row control or treatment, and in column the subgroup number.</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_n_max">n_max</code></td>
<td>
<p>Integer representing the maximum number of patients to enroll in a trial. Must be supplied only if <code>type_outcome</code> is equal to &quot;binary&quot; or &quot;continuous&quot;, will be ignored otherwise.</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_incl_rate">incl_rate</code></td>
<td>
<p>Number representing the inclusion rate. Must be supplied only if <code>type_outcome</code> is equal to &quot;survival&quot;, will be ignored otherwise.</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_mean_cur_c">mean_cur_c</code></td>
<td>
<p>Number representing the median survival for the control group. Must be supplied only if <code>type_outcome</code> is equal to &quot;survival&quot;, will be ignored otherwise.</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_hr">HR</code></td>
<td>
<p>Vector containing the expected hazard ratios for each subgroup. Must be of length <code>N_subsets</code>. Must be supplied only if <code>type_outcome</code> is equal to &quot;survival&quot;, will be ignored otherwise.</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_nb_required">nb_required</code></td>
<td>
<p>Integer indicating the maximum number of events required. Must be supplied only if <code>type_outcome</code> is equal to &quot;survival&quot;, will be ignored otherwise.</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_nmax_wait">nmax_wait</code></td>
<td>
<p>For <code>type_outcome</code> equal to &quot;survival&quot; only, will be ignored otherwise. If specified, maximum number of patients to include in the trial, the inclusions will be stopped when this
number is achieved and trial will pursue until the number of events required is achieved. Must be 
superior to <code>nb_required</code>. Default value is +Inf.</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_ordering">ordering</code></td>
<td>
<p>Boolean indicating if the subgroups (theta) are ordered.</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_increasing_theta">increasing_theta</code></td>
<td>
<p>Boolean indicating if greater values of theta parameters represent better treatment effects. The default value is set at FALSE.</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_nsim">nsim</code></td>
<td>
<p>Integer indicating the number of trials to simulate. The default value is set at 1000.</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_seed">seed</code></td>
<td>
<p>Interger representing the seed. The default value is set at 42.</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_nsim_tot">nsim_tot</code></td>
<td>
<p>(for Rshiny application)</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_num_sc">num_sc</code></td>
<td>
<p>(for Rshiny application)</p>
</td></tr>
<tr><td><code id="sim_magnusson_turnbull_+3A_updateprogress">updateProgress</code></td>
<td>
<p>(for Rshiny application)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned composed of: 
</p>
<table>
<tr><td><code>prob_rejec</code></td>
<td>
<p>Percentage of simulated trials (estimated probability) to reject any subgroup.</p>
</td></tr>
<tr><td><code>prob_accep</code></td>
<td>
<p>Percentage of simulated trials (estimated probability) to accept the null hypothesis, that is there is no treatment effect in any subgroup.</p>
</td></tr>
<tr><td><code>list_keep</code></td>
<td>
<p>A list of the different subgroups that were selected across all simulated trials.</p>
</td></tr>
<tr><td><code>pct_keep</code></td>
<td>
<p>Percentage of selection of each subgroup of <code>list_keep</code> across all simulated trials.</p>
</td></tr>
<tr><td><code>rejec_stage</code></td>
<td>
<p>Vector of percentage of simulated trials (estimated probability) to reject any subgroup at each stage.</p>
</td></tr>
<tr><td><code>accep_stage</code></td>
<td>
<p>Vector of percentage of simulated trials (estimated probability) to accept the null hypothesis (that is there is no treatment effect in any subgroup) at each stage.</p>
</td></tr>
<tr><td><code>mean_pat</code></td>
<td>
<p>Mean number of patients included across all simulated trials.</p>
</td></tr>
<tr><td><code>mean_duration</code></td>
<td>
<p>If <code>type_outcome</code> is equal to &quot;survival&quot;, the trial mean duration across all simulated trials is also returned.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marie-Karelle Riviere-Jourdan <a href="mailto:eldamjh@gmail.com">eldamjh@gmail.com</a></p>


<h3>References</h3>

<p>Baldur P. Magnusson and Bruce W. Turnbull. Group sequential enrichment design incorporating subgroup selection. Statistics in Medicine, 2013. &lt;doi:10.1002/sim.5738&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#For testing purpose only, larger number of simulations required (see in comments below)
sim_magnusson_turnbull(K_stages=2, N_subsets=3, f=c(0.6,0.2,0.2), l=c(0.7962, 2.5204), 
u=c(2.7625, 2.5204), ratio_Delta_star_d1=c(1), type_outcome="binary", param_outcome=
list(matrix(c(0.4,0.4,0.4,0.6,0.6,0.6),nrow=2,ncol=3,byrow=TRUE)), n_max=1496, 
ordering=FALSE, nsim=2, seed=42)

#sim_magnusson_turnbull(K_stages=2, N_subsets=3, f=c(0.6,0.2,0.2), l=c(0.7962, 2.5204), 
#u=c(2.7625, 2.5204), ratio_Delta_star_d1=c(1), type_outcome="binary", param_outcome=
#list(matrix(c(0.4,0.4,0.4,0.6,0.6,0.6),nrow=2,ncol=3,byrow=TRUE)), n_max=1496, 
#ordering=FALSE, nsim=1000, seed=42)

#sim_magnusson_turnbull(K_stages=2, N_subsets=3, f=c(0.6,0.2,0.2), l=c(0.7962, 2.5204), 
#u=c(2.7625, 2.5204), ratio_Delta_star_d1=c(1), type_outcome="binary", param_outcome=
#list(matrix(c(0.5,0.5,0.5,0.5,0.5,0.5),nrow=2,ncol=3,byrow=TRUE)), n_max=1496, 
#ordering=FALSE, nsim=1000, seed=42)

#sim_magnusson_turnbull(K_stages=2, N_subsets=4, f=c(0.25,0.25,0.25,0.25), l=c(0.98,2.35), 
#u=c(2.59,2.35), ratio_Delta_star_d1=c(1), type_outcome="survival", incl_rate=1/28, 
#mean_cur_c=7/log(2), HR=c(0.8,0.8,0.8,0.8), nb_required=1030, ordering=TRUE, 
#increasing_theta=FALSE, nsim=1000, seed=42)
</code></pre>

<hr>
<h2 id='stage_1_evaluation'>Stage 1-evaluation step of GSED</h2><span id='topic+stage_1_evaluation'></span>

<h3>Description</h3>

<p><code>stage_1_evaluation</code> is used to evaluate the efficacy of the subgroup selected at the end of the first stage of GSED.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stage_1_evaluation(keep, Z_1j, f, u)
</code></pre>


<h3>Arguments</h3>

                
<table>
<tr><td><code id="stage_1_evaluation_+3A_keep">keep</code></td>
<td>
<p>Vector containing the indices of the subgroups selected at stage 1.</p>
</td></tr>
<tr><td><code id="stage_1_evaluation_+3A_z_1j">Z_1j</code></td>
<td>
<p>Vector containing the Z-statistics (standard normal under H0) for each subgroup. Must be of length <code>N_subsets</code>.</p>
</td></tr>
<tr><td><code id="stage_1_evaluation_+3A_f">f</code></td>
<td>
<p>Vector containing the prevalence rates of each subgroup.</p>
</td></tr>
<tr><td><code id="stage_1_evaluation_+3A_u">u</code></td>
<td>
<p>Vector containing the upper boundaries for stagewise decisions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned, consisting of: 
</p>
<table>
<tr><td><code>stage</code></td>
<td>
<p>Integer containing the current step. Value is 1 by default, or -1 if the trial stops earlier for efficacy after this evaluation step.</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>Vector containing the indices of the subgroups selected at stage 1 (=<code>keep</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marie-Karelle Riviere-Jourdan <a href="mailto:eldamjh@gmail.com">eldamjh@gmail.com</a></p>


<h3>References</h3>

<p>Baldur P. Magnusson and Bruce W. Turnbull. Group sequential enrichment design incorporating subgroup selection. Statistics in Medicine, 2013. &lt;doi:10.1002/sim.5738&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>stage_1_evaluation(keep=c(2,3), Z_1j=c(-0.49,1.07,1.44), f=c(0.6,0.2,0.2), u=c(2.7625,2.5204))
</code></pre>

<hr>
<h2 id='stage_1_selection'>Stage 1-selection step of GSED</h2><span id='topic+stage_1_selection'></span>

<h3>Description</h3>

<p><code>stage_1_selection</code> is used to determine the subgroup selected at the end of the first stage of GSED.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stage_1_selection(N_subsets, Z_1j, l, ordering, increasing_theta=FALSE)
</code></pre>


<h3>Arguments</h3>

                
<table>
<tr><td><code id="stage_1_selection_+3A_n_subsets">N_subsets</code></td>
<td>
<p>Integer representing the number of possible subgroups.</p>
</td></tr>
<tr><td><code id="stage_1_selection_+3A_z_1j">Z_1j</code></td>
<td>
<p>Vector containing the Z-statistics (standard normal under H0) for each subgroup. Must be of length <code>N_subsets</code>.</p>
</td></tr>
<tr><td><code id="stage_1_selection_+3A_l">l</code></td>
<td>
<p>Vector containing the lower boundaries for stagewise decisions.</p>
</td></tr>
<tr><td><code id="stage_1_selection_+3A_ordering">ordering</code></td>
<td>
<p>Boolean indicating if the subgroups (theta) are ordered.</p>
</td></tr>
<tr><td><code id="stage_1_selection_+3A_increasing_theta">increasing_theta</code></td>
<td>
<p>Boolean indicating if greater values of theta parameters represent better treatment effects. The default value is set at FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the indices of the subgroups selected is returned.
</p>


<h3>Author(s)</h3>

<p>Marie-Karelle Riviere-Jourdan <a href="mailto:eldamjh@gmail.com">eldamjh@gmail.com</a></p>


<h3>References</h3>

<p>Baldur P. Magnusson and Bruce W. Turnbull. Group sequential enrichment design incorporating subgroup selection. Statistics in Medicine, 2013. &lt;doi:10.1002/sim.5738&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>stage_1_selection(N_subsets=3, Z_1j=c(-0.49,1.07,1.44), l=c(0.7962,2.5204), ordering=FALSE)
</code></pre>

<hr>
<h2 id='test_BC'>For internal use</h2><span id='topic+test_BC'></span>

<h3>Description</h3>

<p>For internal use</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
