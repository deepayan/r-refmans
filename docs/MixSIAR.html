<!DOCTYPE html><html><head><title>Help for package MixSIAR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MixSIAR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calc_area'><p>Calculate the normalized surface area of the source convex hull</p></a></li>
<li><a href='#combine_sources'><p>Combine sources from a finished MixSIAR model (<em>a posteriori</em>)</p></a></li>
<li><a href='#compare_models'><p>Compare the predictive accuracy of 2 or more MixSIAR models</p></a></li>
<li><a href='#load_discr_data'><p>Load trophic discrimination factor (TDF) data</p></a></li>
<li><a href='#load_mix_data'><p>Load mixture data</p></a></li>
<li><a href='#load_source_data'><p>Load source data</p></a></li>
<li><a href='#mixsiar_env'><p>mixsiar</p></a></li>
<li><a href='#output_JAGS'><p>Process mixing model output from JAGS</p></a></li>
<li><a href='#plot_continuous_var'><p>Plot proportions by a continuous covariate</p></a></li>
<li><a href='#plot_data'><p>Plot biotracer data</p></a></li>
<li><a href='#plot_data_one_iso'><p>Plot biotracer data (1-D)</p></a></li>
<li><a href='#plot_data_two_iso'><p>Plot biotracer data (2-D)</p></a></li>
<li><a href='#plot_intervals'><p>Plot posterior uncertainty intervals from a MixSIAR model</p></a></li>
<li><a href='#plot_prior'><p>Plot prior</p></a></li>
<li><a href='#run_model'><p>Run the JAGS model</p></a></li>
<li><a href='#summary_stat'><p>Summary statistics from posterior of MixSIAR model</p></a></li>
<li><a href='#write_JAGS_model'><p>Write the JAGS model file</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Bayesian Mixing Models in R</td>
</tr>
<tr>
<td>Version:</td>
<td>3.1.12</td>
</tr>
<tr>
<td>Description:</td>
<td>Creates and runs Bayesian mixing models to analyze
    biological tracer data (i.e. stable isotopes, fatty acids), which estimate the
    proportions of source (prey) contributions to a mixture (consumer). 'MixSIAR'
    is not one model, but a framework that allows a user to create a mixing model
    based on their data structure and research questions, via options for fixed/
    random effects, source data types, priors, and error terms. 'MixSIAR' incorporates
    several years of advances since 'MixSIR' and 'SIAR'.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2 (&ge; 3.3.0), R2jags (&ge; 0.5-7), MASS (&ge; 7.3),
RColorBrewer (&ge; 1.1), reshape (&ge; 0.8.7), reshape2 (&ge; 1.4.3),
lattice (&ge; 0.20-35), MCMCpack (&ge; 1.4-2), ggmcmc (&ge; 1.1),
coda (&ge; 0.19-1), loo (&ge; 2.0.0), bayesplot (&ge; 1.4.0), splancs
(&ge; 2.01-40)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>JAGS (&gt;= 4.3)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/brianstock/MixSIAR">https://github.com/brianstock/MixSIAR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/brianstock/MixSIAR/issues">https://github.com/brianstock/MixSIAR/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-10-16 19:46:39 UTC; brian</td>
</tr>
<tr>
<td>Author:</td>
<td>Brian Stock [cre, aut],
  Brice Semmens [aut],
  Eric Ward [ctb],
  Andrew Parnell [ctb],
  Andrew Jackson [ctb],
  Donald Phillips [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Brian Stock &lt;bstock09@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-10-20 07:00:44 UTC</td>
</tr>
</table>
<hr>
<h2 id='calc_area'>Calculate the normalized surface area of the source convex hull</h2><span id='topic+calc_area'></span>

<h3>Description</h3>

<p><code>calc_area()</code> calculates the normalized surface area of the SOURCE + TDF
convex hull, only if there are exactly 2 biotracers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_area(source, mix, discr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_area_+3A_source">source</code></td>
<td>
<p>output from <code><a href="#topic+load_source_data">load_source_data</a></code></p>
</td></tr>
<tr><td><code id="calc_area_+3A_mix">mix</code></td>
<td>
<p>output from <code><a href="#topic+load_mix_data">load_mix_data</a></code></p>
</td></tr>
<tr><td><code id="calc_area_+3A_discr">discr</code></td>
<td>
<p>output from <code><a href="#topic+load_discr_data">load_discr_data</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Important detail is that, unlike in Brett (2014), <code>calc_area</code> uses the
combined SOURCE + TDF variance to normalize the surface area:
</p>
<p style="text-align: center;"><code class="reqn">\sqrt{\sigma^2_source + \sigma^2_discr}</code>
</p>

<p>This is the variance used in fitting the mixing model.
</p>
<p><code>calc_area()</code> relies on the <code>splancs::areapl()</code> function from the <code>splancs</code>
package. If <code>splancs</code> is not installed, a WARNING message will appear.
</p>


<h3>Value</h3>

<p>If source$by_factor = FALSE, <code>calc_area</code> returns a scalar, the
normalized surface area of the SOURCE + TDF convex hull
</p>
<p>If source$by_factor = TRUE, <code>calc_area</code> returns a vector, where
the entries are the normalized surface areas of the convex hull of each
source factor level (e.g. source data by 3 Regions, returns a 3-vector of
the areas of the Region 1 convex hull, Region 2 convex hull, etc.)
</p>


<h3>See Also</h3>

<p>Brett (2014): <a href="https://www.researchgate.net/profile/Michael_Brett/publication/269873625_Resource_polygon_geometry_predicts_Bayesian_stable_isotope_mixing_model_bias/links/549884090cf2519f5a1de635.pdf">https://www.researchgate.net/profile/Michael_Brett/publication/269873625_Resource_polygon_geometry_predicts_Bayesian_stable_isotope_mixing_model_bias/links/549884090cf2519f5a1de635.pdf</a>
</p>

<hr>
<h2 id='combine_sources'>Combine sources from a finished MixSIAR model (<em>a posteriori</em>)</h2><span id='topic+combine_sources'></span>

<h3>Description</h3>

<p><code>combine_sources</code> aggregates the proportions from multiple sources.
Proportions are summed across posterior draws, since the source proportions
are correlated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine_sources(jags.1, mix, source, alpha.prior = 1, groups)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combine_sources_+3A_jags.1">jags.1</code></td>
<td>
<p><code>rjags</code> model object, output from <code><a href="#topic+run_model">run_model</a></code></p>
</td></tr>
<tr><td><code id="combine_sources_+3A_mix">mix</code></td>
<td>
<p>list, output from <code><a href="#topic+load_mix_data">load_mix_data</a></code></p>
</td></tr>
<tr><td><code id="combine_sources_+3A_source">source</code></td>
<td>
<p>list, output from <code><a href="#topic+load_source_data">load_source_data</a></code></p>
</td></tr>
<tr><td><code id="combine_sources_+3A_alpha.prior">alpha.prior</code></td>
<td>
<p>vector with length = n.sources, Dirichlet prior on p.global (default = 1, uninformative)</p>
</td></tr>
<tr><td><code id="combine_sources_+3A_groups">groups</code></td>
<td>
<p>list, which sources to combine, and what names to give the new combined sources. See example.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><em>Note: Aggregating sources after running the mixing model (a posteriori)
effectively changes the prior weighting on the sources.</em> Aggregating
uneven numbers of sources will turn an 'uninformative'/generalist
prior into an informative one. Because of this, <code>combine_sources</code>
automatically generates a message describing this effect and a figure
showing the original prior, the effective/aggregated prior, and what the
'uninformative'/generalist prior would be if sources were instead grouped
before running the mixing model (a priori).
</p>


<h3>Value</h3>

<p><code>combined</code>, a list including:
</p>

<ul>
<li> <p><code>combined$post</code>: matrix, posterior draws with new source groupings
</p>
</li>
<li> <p><code>combined$source.new</code>: list, original <code>source</code> list with modified entries for <code>n.sources</code> and <code>source_names</code>
</p>
</li>
<li> <p><code>combined$groups</code>: (input) list, shows original and combined sources
</p>
</li>
<li> <p><code>combined$jags.1</code>: (input) <code>rjags</code> model object
</p>
</li>
<li> <p><code>combined$source.old</code>: (input) list of original source data
</p>
</li>
<li> <p><code>combined$mix</code>: (input) list of original mix data
</p>
</li>
<li> <p><code>combined$prior.old</code>: (input) prior vector on original sources
</p>
</li>
<li> <p><code>combined$prior.new</code>: (output) prior vector on combined sources
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+summary_stat">summary_stat</a></code> and <code><a href="#topic+plot_intervals">plot_intervals</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# first run mantis shrimp example
# combine 6 sources into 2 groups of interest (hard-shelled vs. soft-bodied)
#   'hard' = 'clam' + 'crab' + 'snail'           # group 1 = hard-shelled prey
#   'soft' = 'alphworm' + 'brittlestar' + 'fish' # group 2 = soft-bodied prey
combined &lt;- combine_sources(jags.1, mix, source, alpha.prior=alpha, 
                groups=list(hard=c("clam","crab","snail"), soft=c("alphworm","brittlestar","fish")))

# get posterior medians for new source groupings
apply(combined$post, 2, median)
summary_stat(combined, meanSD=FALSE, quantiles=c(.025,.5,.975), savetxt=FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='compare_models'>Compare the predictive accuracy of 2 or more MixSIAR models</h2><span id='topic+compare_models'></span>

<h3>Description</h3>

<p><code>compare_models</code> uses the <a href="https://CRAN.R-project.org/package=loo">'loo' package</a>
to compute LOO (leave-one-out cross-validation) or WAIC (widely applicable information criterion)
for 2 of more fit MixSIAR models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_models(x, loo = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_models_+3A_x">x</code></td>
<td>
<p>list of two or more <code>rjags</code> model objects (output from <code><a href="#topic+run_model">run_model</a></code> function)</p>
</td></tr>
<tr><td><code id="compare_models_+3A_loo">loo</code></td>
<td>
<p><code>TRUE/FALSE</code>: compute LOO if <code>TRUE</code> (preferred), compute WAIC if <code>FALSE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>LOO and WAIC are &quot;methods for estimating pointwise out-of-sample prediction accuracy
from a fitted Bayesian model using the log-likelihood evaluated at the posterior
simulations of the parameter values&quot;. See <a href="https://link.springer.com/article/10.1007/s11222-016-9696-4">Vehtari, Gelman, &amp; Gabry (2017)</a>.
In brief:
</p>

<ul>
<li><p> LOO and WAIC are preferred over AIC or DIC
</p>
</li>
<li><p> LOO is more robust than WAIC
</p>
</li>
<li> <p><code>'loo'</code> estimates standard errors for the difference in LOO/WAIC between two models
</p>
</li>
<li><p> We can calculate the relative support for each model using LOO/WAIC weights
</p>
</li></ul>



<h3>Value</h3>

<p>Data frame with the following columns:
</p>

<ul>
<li> <p><code>Model</code>: names of <code>x</code> (input list)
</p>
</li>
<li> <p><code>LOOic</code> / <code>WAIC</code>: LOO information criterion or WAIC
</p>
</li>
<li> <p><code>se_LOOic</code> / <code>se_WAIC</code>: standard error of LOOic / WAIC
</p>
</li>
<li> <p><code>dLOOic</code> / <code>dWAIC</code>: difference between each model and the model with lowest LOOic/WAIC. Best model has dLOOic = 0.
</p>
</li>
<li> <p><code>se_dLOOic</code> / <code>se_dWAIC</code>: standard error of the difference between each model and the model with lowest LOOic/WAIC
</p>
</li>
<li> <p><code>weight</code>: relative support for each model, calculated as Akaike weights (p.75 Burnham &amp; Anderson 2002). Interpretation: &quot;an estimate of the probability that the model will make the best predictions on new data, conditional on the set of models considered&quot; (McElreath 2015).
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="https://CRAN.R-project.org/package=loo">'loo' package</a>
</p>
<p><a href="https://link.springer.com/article/10.1007/s11222-016-9696-4">Vehtari, A, A Gelman, and J Gabry. 2017</a>. Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC. Statistics and Computing.
</p>
<p>Pages 75-88 in <a href="https://www.springer.com/us/book/9780387953649">Burnham, KP and DR Anderson. 2002</a>. Model selection and multimodel inference: a practical information-theoretic approach. Springer Science &amp; Business Media.
</p>
<p>Pages 188-201 in <a href="https://www.routledge.com/Statistical-Rethinking-A-Bayesian-Course-with-Examples-in-R-and-STAN/McElreath/p/book/9780367139919">McElreath, R. 2016</a>. Statistical rethinking: a Bayesian course with examples in R and Stan. CRC Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Model 1 = wolf diet by Region + Pack
mix.1 &lt;- load_mix_data(filename=mix.filename, 
                     iso_names=c("d13C","d15N"), 
                     factors=c("Region","Pack"), 
                     fac_random=c(TRUE,TRUE), 
                     fac_nested=c(FALSE,TRUE), 
                     cont_effects=NULL)
source.1 &lt;- load_source_data(filename=source.filename, source_factors="Region",
                             conc_dep=FALSE, data_type="means", mix.1)
discr.1 &lt;- load_discr_data(filename=discr.filename, mix.1)

# Run Model 1
jags.1 &lt;- run_model(run="test", mix.1, source.1, discr.1, model_filename, 
                    alpha.prior = 1, resid_err=T, process_err=T)
                    
# Model 2 = wolf diet by Region (no Pack)
mix.2 &lt;- load_mix_data(filename=mix.filename, 
                     iso_names=c("d13C","d15N"), 
                     factors=c("Region"), 
                     fac_random=c(TRUE), 
                     fac_nested=c(FALSE), 
                     cont_effects=NULL)
source.2 &lt;- load_source_data(filename=source.filename, source_factors="Region",
                             conc_dep=FALSE, data_type="means", mix.2)
discr.2 &lt;- load_discr_data(filename=discr.filename, mix.2)

# Run Model 2
jags.2 &lt;- run_model(run="test", mix.2, source.2, discr.2, model_filename, 
                    alpha.prior = 1, resid_err=T, process_err=T)
                    
# Compare models 1 and 2 using LOO
compare_models(x=list(jags.1, jags.2), loo=TRUE)

# Compare models 1 and 2 using WAIC
compare_models(x=list(jags.1, jags.2), loo=FALSE)

# Get WAIC for model 1
compare_models(x=list(jags.1), loo=FALSE)

# Create named list of rjags objects to get model names in summary
x &lt;- list(jags.1, jags.2)
names(x) &lt;- c("Region + Pack", "Region")
compare_models(x)

## End(Not run)
</code></pre>

<hr>
<h2 id='load_discr_data'>Load trophic discrimination factor (TDF) data</h2><span id='topic+load_discr_data'></span>

<h3>Description</h3>

<p><code>load_discr_data</code> loads the trophic discrimination factor (TDF) data.
TDF is the amount that a consumer's tissue biotracer values are modified
(enriched/depleted) <em>after</em> consuming a source. If tracers are conservative,
then set TDF = 0 (ex. essential fatty acids, fatty acid profile data,
element concentrations).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_discr_data(filename, mix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_discr_data_+3A_filename">filename</code></td>
<td>
<p>csv file with the discrimination data</p>
</td></tr>
<tr><td><code id="load_discr_data_+3A_mix">mix</code></td>
<td>
<p>output from <code><a href="#topic+load_mix_data">load_mix_data</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>discr, a list including:
</p>

<ul>
<li> <p><code>discr$mu</code>, matrix of discrimination means
</p>
</li>
<li> <p><code>discr$sig2</code>, matrix of discrimination variances
</p>
</li></ul>


<hr>
<h2 id='load_mix_data'>Load mixture data</h2><span id='topic+load_mix_data'></span>

<h3>Description</h3>

<p><code>load_mix_data</code> loads the mixture data file and names the biotracers and
any Fixed, Random, or Continuous Effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_mix_data(
  filename,
  iso_names,
  factors,
  fac_random,
  fac_nested,
  cont_effects
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_mix_data_+3A_filename">filename</code></td>
<td>
<p>csv file with the mixture/consumer data</p>
</td></tr>
<tr><td><code id="load_mix_data_+3A_iso_names">iso_names</code></td>
<td>
<p>vector of isotope column headings in 'filename'</p>
</td></tr>
<tr><td><code id="load_mix_data_+3A_factors">factors</code></td>
<td>
<p>vector of random/fixed effect column headings in 'filename'.
NULL if no factors.</p>
</td></tr>
<tr><td><code id="load_mix_data_+3A_fac_random">fac_random</code></td>
<td>
<p>vector of TRUE/FALSE, TRUE if factor is random effect, FALSE
if fixed effect. NULL if no factors.</p>
</td></tr>
<tr><td><code id="load_mix_data_+3A_fac_nested">fac_nested</code></td>
<td>
<p>vector of TRUE/FALSE, TRUE if factor is nested within the
other. Only applies if 2 factors. NULL otherwise.</p>
</td></tr>
<tr><td><code id="load_mix_data_+3A_cont_effects">cont_effects</code></td>
<td>
<p>vector of continuous effect column headings in 'filename'</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mix</code>, a list including:
</p>

<ul>
<li> <p><code>mix$data</code>: dataframe, raw mix/consumer data (all columns in 'filename'),
</p>
</li>
<li> <p><code>mix$data_iso</code>: matrix, mix/consumer biotracer/isotope values (those
specified in 'iso_names'),
</p>
</li>
<li> <p><code>mix$n.iso</code>: integer, number of biotracers/isotopes,
</p>
</li>
<li> <p><code>mix$n.re</code>: integer, number of random effects,
</p>
</li>
<li> <p><code>mix$n.ce</code>: integer, number of continuous effects,
</p>
</li>
<li> <p><code>mix$FAC</code>: list of fixed/random effect values, each of which contains:
</p>

<ul>
<li> <p><code>values</code>: factor, values of the effect for each mix/consumer point
</p>
</li>
<li> <p><code>levels</code>: numeric vector, total number of values
</p>
</li>
<li> <p><code>labels</code>: character vector, names for each factor level
</p>
</li>
<li> <p><code>lookup</code>: numeric vector, if 2 factors and Factor.2 is nested
within Factor.1, stores Factor.1 values for each level of Factor.2 (e.g.
Wolf Ex has 8 Packs in 3 Regions, and <code>mix$FAC[[2]]$lookup =
     c(1,1,1,2,2,2,2,3)</code>, the Regions each Pack belongs to).
</p>
</li>
<li> <p><code>re</code>: T/F, is the factor a Random Effect? (FALSE = Fixed Effect)
</p>
</li>
<li> <p><code>name</code>: character, name of the factor (e.g. &quot;Region&quot;)
</p>
</li></ul>

</li>
<li> <p><code>mix$CE</code>: list of length <code>n.ce</code>, contains the <code>cont_effects</code>
values centered (subtract the mean) and scaled (divide by SD)
</p>
</li>
<li> <p><code>mix$CE_orig</code>: list of length <code>n.ce</code>, contains the original
(unscaled) <code>cont_effects</code> values
</p>
</li>
<li> <p><code>mix$CE_center</code>: vector of length <code>n.ce</code>, means of each <code>cont_effects</code>
</p>
</li>
<li> <p><code>mix$CE_scale</code>: vector of length <code>n.ce</code>, SD of each <code>cont_effects</code>
</p>
</li>
<li> <p><code>mix$cont_effects</code>: vector of length <code>n.ce</code>, names of each <code>cont_effects</code>
</p>
</li>
<li> <p><code>mix$MU_names</code>: vector of biotracer/iso MEAN column headings to look for
in the source and discrimination files (e.g. 'd13C' in <code>iso_names</code>,
'Meand13C' here)
</p>
</li>
<li> <p><code>mix$SIG_names</code>: vector of biotracer/iso SD column headings to look for
in the source and discrimination files (e.g. 'd13C' in <code>iso_names</code>,
'SDd13C' here)
</p>
</li>
<li> <p><code>mix$iso_names</code>: vector of isotope column headings in 'filename' (same
as input)
</p>
</li>
<li> <p><code>mix$N</code>: integer, number of mix/consumer data points
</p>
</li>
<li> <p><code>mix$n.fe</code>: integer, number of Fixed Effects
</p>
</li>
<li> <p><code>mix$n.effects</code>: integer, number of Fixed Effects + Random Effects
</p>
</li>
<li> <p><code>mix$factors</code>: vector of length <code>n.effects</code>, names of the
Fixed and Random Effects
</p>
</li>
<li> <p><code>mix$fac_random</code>: T/F vector of length <code>n.effects</code> indicating
which effects are Random (= TRUE) and Fixed (= FALSE)
</p>
</li>
<li> <p><code>mix$fac_nested</code>: T/F vector of length <code>n.effects</code> indicating
which effects are nested within the other, if any
</p>
</li>
<li> <p><code>mix$fere</code>: TRUE if there are 2 Fixed Effects or 1 Fixed Effect and
1 Random Effect, FALSE otherwise. Used by <code>write_JAGS_model</code>.
</p>
</li></ul>

<p>If no biotracer/isotope columns are specified, a WARNING prompts the user to
select 2, 1, or 0.
</p>
<p>If more than 2 Fixed/Random Effects are selected, a WARNING prompts the user
to select 2, 1, or 0.
</p>
<p>If more than 1 Continuous Effect is selected, a WARNING prompts the user to
select 1 or 0.
</p>

<hr>
<h2 id='load_source_data'>Load source data</h2><span id='topic+load_source_data'></span>

<h3>Description</h3>

<p><code>load_source_data</code> specifies the source data structure (factors,
concentration dependence, data type) and loads the source data file. <em>Sources
are sorted alphabetically.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_source_data(filename, source_factors = NULL, conc_dep, data_type, mix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_source_data_+3A_filename">filename</code></td>
<td>
<p>character, csv file with the source data.</p>
</td></tr>
<tr><td><code id="load_source_data_+3A_source_factors">source_factors</code></td>
<td>
<p>character, column heading in 'filename' that matches
a Fixed or Random Effect from the mixture data (<code>mix$factors</code>).
Only used if you have source data by a factor (e.g. &quot;Region&quot;), otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="load_source_data_+3A_conc_dep">conc_dep</code></td>
<td>
<p>T/F, <code>TRUE</code> indicates you have concentration dependence
data in 'filename'.</p>
</td></tr>
<tr><td><code id="load_source_data_+3A_data_type">data_type</code></td>
<td>
<p><code>"raw"</code> or <code>"means"</code>. &quot;Raw&quot; source data are repeated
source biotracer measurements, &quot;means&quot; data are source biotracer values as
means, SDs, and sample size. See manual for formatting.</p>
</td></tr>
<tr><td><code id="load_source_data_+3A_mix">mix</code></td>
<td>
<p>list, output from <code><a href="#topic+load_mix_data">load_mix_data</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>WARNING messages check for:
</p>

<ul>
<li><p> More than one source factor selected
</p>
</li>
<li><p> Source factor not in mixture data
</p>
</li>
<li><p> Source sample sizes missing or entered incorrectly
</p>
</li>
<li><p> Source SD = 0
</p>
</li></ul>



<h3>Value</h3>

<p><code>source</code>, a list including:
</p>

<ul>
<li> <p><code>source$n.sources</code>: integer, number of sources
</p>
</li>
<li> <p><code>source$source_names</code>: vector, source names/labels
</p>
</li>
<li> <p><code>source$S_MU</code>: matrix, source means used for plotting - NOT
passed to JAGS. If sources are by factor, then the third column of S_MU
will be the factor values (e.g. for 4 sources and 3 Regions:
1 2 3 1 2 3 1 2 3 1 2 3)
</p>
</li>
<li> <p><code>source$S_SIG</code>: matrix, source SDs used for plotting - NOT passed
to JAGS. Same structure as S_MU.
</p>
</li>
<li> <p><code>source$S_factor1</code>: factor or NULL, factor values if sources are
by factor.
</p>
</li>
<li> <p><code>source$S_factor_levels</code>: scalar or NULL, number of <code>S_factor1</code>
levels if sources are by factor.
</p>
</li>
<li> <p><code>source$conc</code>: matrix or NULL, concentration dependence values
for each isotope
</p>
</li>
<li> <p><code>source$MU_array</code>: array of source means, dim(src,iso,f1) or
dim(src,iso) if data_type=&quot;means&quot;, NULL if data_type=&quot;raw&quot;.
</p>
</li>
<li> <p><code>source$SIG2_array</code>: array of source variances, dim(src,iso,f1)
or dim(src,iso) if data_type=&quot;means&quot;, NULL if data_type=&quot;raw&quot;.
</p>
</li>
<li> <p><code>source$n_array</code>: vector/matrix of source sample sizes,
dim(src,f1) or dim(src) if data_type=&quot;means&quot;, NULL if data_type=&quot;raw&quot;.
</p>
</li>
<li> <p><code>source$SOURCE_array</code>: array of source data, dim(src,iso,f1,replicate)
or dim(src,iso,replicate) if data_type=&quot;raw&quot;, NULL if data_type=&quot;means&quot;.
</p>
</li>
<li> <p><code>source$n.rep</code>: vector/matrix of source sample sizes, dim(src,f1)
or dim(src) if data_type=&quot;raw&quot;, NULL if data_type=&quot;means&quot;.
</p>
</li>
<li> <p><code>source$by_factor</code>: NA or factor number, are the source data by a Fixed or Random Effect?
</p>
</li>
<li> <p><code>source$data_type</code>: <code>"raw"</code> or <code>"means"</code>, same as input.
</p>
</li>
<li> <p><code>source$conc_dep</code>: T/F, same as input.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+load_mix_data">load_mix_data</a></code> and <code><a href="#topic+load_discr_data">load_discr_data</a></code>
</p>

<hr>
<h2 id='mixsiar_env'>mixsiar</h2><span id='topic+mixsiar_env'></span>

<h3>Description</h3>

<p>Added only to pass R CMD check with 0 NOTEs
</p>

<hr>
<h2 id='output_JAGS'>Process mixing model output from JAGS</h2><span id='topic+output_JAGS'></span>

<h3>Description</h3>

<p><code>output_JAGS</code> processes the mixing model output, prints and saves (in the
working directory):
</p>

<ul>
<li><p> diagnostics
</p>
</li>
<li><p> summary statistics
</p>
</li>
<li><p> posterior density plots
</p>
</li>
<li><p> pairs plot
</p>
</li>
<li><p> trace/XY plots
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>output_JAGS(
  jags.1,
  mix,
  source,
  output_options = list(summary_save = TRUE, summary_name = "summary_statistics",
    sup_post = FALSE, plot_post_save_pdf = TRUE, plot_post_name = "posterior_density",
    sup_pairs = FALSE, plot_pairs_save_pdf = TRUE, plot_pairs_name = "pairs_plot", sup_xy
    = TRUE, plot_xy_save_pdf = FALSE, plot_xy_name = "xy_plot", gelman = TRUE, heidel =
    FALSE, geweke = TRUE, diag_save = TRUE, diag_name = "diagnostics", indiv_effect =
    FALSE, plot_post_save_png = FALSE, plot_pairs_save_png = FALSE, plot_xy_save_png =
    FALSE, diag_save_ggmcmc = TRUE)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="output_JAGS_+3A_jags.1">jags.1</code></td>
<td>
<p>rjags model object, output from <code><a href="#topic+run_model">run_model</a></code> function</p>
</td></tr>
<tr><td><code id="output_JAGS_+3A_mix">mix</code></td>
<td>
<p>output from <code><a href="#topic+load_mix_data">load_mix_data</a></code></p>
</td></tr>
<tr><td><code id="output_JAGS_+3A_source">source</code></td>
<td>
<p>output from <code><a href="#topic+load_source_data">load_source_data</a></code></p>
</td></tr>
<tr><td><code id="output_JAGS_+3A_output_options">output_options</code></td>
<td>
<p>list containing options for plots and saving:
</p>

<ul>
<li> <p><code>summary_save</code>: Save the summary statistics as a txt file? Default = <code>TRUE</code>
</p>
</li>
<li> <p><code>summary_name</code>: Summary statistics file name (.txt will be appended). Default = <code>"summary_statistics"</code>
</p>
</li>
<li> <p><code>sup_post</code>: Suppress posterior density plot output in R? Default = <code>FALSE</code>
</p>
</li>
<li> <p><code>plot_post_save_pdf</code>: Save posterior density plots as pdfs? Default = <code>TRUE</code>
</p>
</li>
<li> <p><code>plot_post_name</code>: Posterior plot file name(s) (.pdf/.png will be appended) Default = <code>"posterior_density"</code>
</p>
</li>
<li> <p><code>sup_pairs</code>: Suppress pairs plot output in R? Default = <code>FALSE</code>
</p>
</li>
<li> <p><code>plot_pairs_save_pdf</code>: Save pairs plot as pdf? Default = <code>TRUE</code>
</p>
</li>
<li> <p><code>plot_pairs_name</code>: Pairs plot file name (.pdf/.png will be appended) Default = <code>"pairs_plot"</code>
</p>
</li>
<li> <p><code>sup_xy</code>: Suppress xy/trace plot output in R? Default = <code>TRUE</code>
</p>
</li>
<li> <p><code>plot_xy_save_pdf</code>: Save xy/trace plot as pdf? Default = <code>FALSE</code>
</p>
</li>
<li> <p><code>plot_xy_name</code>: XY/trace plot file name (.pdf/.png will be appended) Default = <code>"xy_plot"</code>
</p>
</li>
<li> <p><code>gelman</code>: Calculate Gelman-Rubin diagnostic test? Default = <code>TRUE</code>
</p>
</li>
<li> <p><code>heidel</code>: Calculate Heidelberg-Welch diagnostic test? Default = <code>FALSE</code>
</p>
</li>
<li> <p><code>geweke</code>: Calculate Geweke diagnostic test? Default = <code>TRUE</code>
</p>
</li>
<li> <p><code>diag_save</code>: Save the diagnostics as a .txt file? Default = <code>TRUE</code>
</p>
</li>
<li> <p><code>diag_name</code>: Diagnostics file name (.txt will be appended) Default = <code>"diagnostics"</code>
</p>
</li>
<li> <p><code>indiv_effect</code>: artifact, set to FALSE 
</p>
</li>
<li> <p><code>plot_post_save_png</code>: Save posterior density plots as pngs? Default = <code>FALSE</code>
</p>
</li>
<li> <p><code>plot_pairs_save_png</code>: Save pairs plot as png? Default = <code>FALSE</code>
</p>
</li>
<li> <p><code>plot_xy_save_png</code>: Save xy/trace plot as png? Default = <code>FALSE</code>
</p>
</li>
<li> <p><code>diag_save_ggmcmc</code>: Save ggmcmc diagnostics as pdf? Default = <code>TRUE</code>
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p><code>p.both</code> &ndash; only if 2 fixed effects OR 1 fixed + 1 random, otherwise <code>NULL</code>).
</p>
<p><code>p.both</code> holds the MCMC chains for the estimated proportions at the different factor levels. Dimensions = [n.draws, f1.levels, f2.levels, n.sources].
</p>
<p>Calculated by combining the ilr offsets from global intercept:
ilr.both[,f1,f2,src] = ilr.global[,src] + ilr.fac1[,f1,src] + ilr.fac2[,f2,src]
And then transforming from ilr- to proportion-space.
</p>

<hr>
<h2 id='plot_continuous_var'>Plot proportions by a continuous covariate</h2><span id='topic+plot_continuous_var'></span>

<h3>Description</h3>

<p><code>plot_continuous_var</code> creates a plot of how the mixture proportions
change according to a continuous covariate, as well as plots of the mixture
proportions for the individuals with minimum, median, and maximum covariate
values. Called by <code><a href="#topic+output_JAGS">output_JAGS</a></code> if any continuous effects are in
the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_continuous_var(
  jags.1,
  mix,
  source,
  output_options,
  alphaCI = 0.05,
  exclude_sources_below = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_continuous_var_+3A_jags.1">jags.1</code></td>
<td>
<p>output from <code><a href="#topic+run_model">run_model</a></code></p>
</td></tr>
<tr><td><code id="plot_continuous_var_+3A_mix">mix</code></td>
<td>
<p>output from <code><a href="#topic+load_mix_data">load_mix_data</a></code></p>
</td></tr>
<tr><td><code id="plot_continuous_var_+3A_source">source</code></td>
<td>
<p>output from <code><a href="#topic+load_source_data">load_source_data</a></code></p>
</td></tr>
<tr><td><code id="plot_continuous_var_+3A_output_options">output_options</code></td>
<td>
<p>list containing options for plots and saving, passed from <code><a href="#topic+output_JAGS">output_JAGS</a></code></p>
</td></tr>
<tr><td><code id="plot_continuous_var_+3A_alphaci">alphaCI</code></td>
<td>
<p>alpha level for credible intervals (default = 0.05, 95% CI)</p>
</td></tr>
<tr><td><code id="plot_continuous_var_+3A_exclude_sources_below">exclude_sources_below</code></td>
<td>
<p>don't plot sources with median proportion below this level for entire range of continuous effect variable (default = 0.1)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>MixSIAR fits a continuous covariate as a linear regression in ILR/transform-space.
Two terms are fit for the proportion of each source: an intercept and a slope.
The plotted line uses the posterior median estimates of the intercept and slope, and
the lines are curved because of the ILR-transform back into proportion-space. The 
95% credible intervals are shaded.
</p>
<p>If the model contains both a continuous AND a categorical (factor) covariate, MixSIAR
fits a different intercept term for each factor level and all levels share the
same slope term.
</p>


<h3>See Also</h3>

<p>Francis et al. 2011
</p>

<hr>
<h2 id='plot_data'>Plot biotracer data</h2><span id='topic+plot_data'></span>

<h3>Description</h3>

<p><code>plot_data</code> creates plot(s) of the biotracer data and saves the plot(s)
to file(s) in the working directory. All 3 required data files must have been
loaded by <code><a href="#topic+load_mix_data">load_mix_data</a></code>, <code><a href="#topic+load_source_data">load_source_data</a></code>,
and <code><a href="#topic+load_discr_data">load_discr_data</a></code>. Behavior depends on the number of tracers:
</p>

<ul>
<li><p> 1 tracer: calls <code><a href="#topic+plot_data_one_iso">plot_data_one_iso</a></code> to create a 1-D plot.
</p>
</li>
<li><p> 2 tracers: calls <code><a href="#topic+plot_data_two_iso">plot_data_two_iso</a></code> to create a biplot.
</p>
</li>
<li><p> &gt;2 tracers: calls <code><a href="#topic+plot_data_two_iso">plot_data_two_iso</a></code> in a loop to create
biplots for each pairwise combination of biotracers.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>plot_data(
  filename,
  plot_save_pdf,
  plot_save_png,
  mix,
  source,
  discr,
  return_obj = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_data_+3A_filename">filename</code></td>
<td>
<p>name of the plot file(s) to save (e.g. &quot;isospace_plot&quot;)</p>
</td></tr>
<tr><td><code id="plot_data_+3A_plot_save_pdf">plot_save_pdf</code></td>
<td>
<p>T/F, save the plot(s) as a pdf?</p>
</td></tr>
<tr><td><code id="plot_data_+3A_plot_save_png">plot_save_png</code></td>
<td>
<p>T/F, save the plot(s) as a png?</p>
</td></tr>
<tr><td><code id="plot_data_+3A_mix">mix</code></td>
<td>
<p>output from <code><a href="#topic+load_mix_data">load_mix_data</a></code></p>
</td></tr>
<tr><td><code id="plot_data_+3A_source">source</code></td>
<td>
<p>output from <code><a href="#topic+load_source_data">load_source_data</a></code></p>
</td></tr>
<tr><td><code id="plot_data_+3A_discr">discr</code></td>
<td>
<p>output from <code><a href="#topic+load_discr_data">load_discr_data</a></code></p>
</td></tr>
<tr><td><code id="plot_data_+3A_return_obj">return_obj</code></td>
<td>
<p>T/F, whether or not to return ggplot object for further modification, defaults to F</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An important detail is that <code>plot_data_two_iso</code> and <code>plot_data_one_iso</code>
plot the raw mix data and <em>add the TDF to the source data</em>, since this is
the polygon that the mixing model uses to determine proportions. The plotted
source means are:
</p>
<p style="text-align: center;"><code class="reqn">\mu_source + \mu_discr</code>
</p>

<p>The source error bars are +/- 1 standard deviation, <em>calculated as a
combination of source and TDF variances:</em>
</p>
<p style="text-align: center;"><code class="reqn">\sqrt{\sigma^2_source + \sigma^2_discr}</code>
</p>

<p><code>plot_data</code> looks for 'C', 'N', 'S', and 'O' in the biotracer column
headers and assumes they are stable isotopes, labeling the axes with, e.g.,
expression(paste(delta^13, &quot;C (u2030)&quot;,sep=&quot;&quot;)).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_data_two_iso">plot_data_two_iso</a></code>, <code><a href="#topic+plot_data_one_iso">plot_data_one_iso</a></code>
</p>

<hr>
<h2 id='plot_data_one_iso'>Plot biotracer data (1-D)</h2><span id='topic+plot_data_one_iso'></span>

<h3>Description</h3>

<p><code>plot_data_one_iso</code> creates a 1-D plot of mix and source tracer data and
saves the plot to a file in the working directory
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_data_one_iso(
  mix,
  source,
  discr,
  filename,
  plot_save_pdf,
  plot_save_png,
  return_obj = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_data_one_iso_+3A_mix">mix</code></td>
<td>
<p>output from <code><a href="#topic+load_mix_data">load_mix_data</a></code></p>
</td></tr>
<tr><td><code id="plot_data_one_iso_+3A_source">source</code></td>
<td>
<p>output from <code><a href="#topic+load_source_data">load_source_data</a></code></p>
</td></tr>
<tr><td><code id="plot_data_one_iso_+3A_discr">discr</code></td>
<td>
<p>output from <code><a href="#topic+load_discr_data">load_discr_data</a></code></p>
</td></tr>
<tr><td><code id="plot_data_one_iso_+3A_filename">filename</code></td>
<td>
<p>name of the plot file(s) to save (e.g. &quot;isospace_plot&quot;)</p>
</td></tr>
<tr><td><code id="plot_data_one_iso_+3A_plot_save_pdf">plot_save_pdf</code></td>
<td>
<p>T/F, save the plot(s) as a pdf?</p>
</td></tr>
<tr><td><code id="plot_data_one_iso_+3A_plot_save_png">plot_save_png</code></td>
<td>
<p>T/F, save the plot(s) as a png?</p>
</td></tr>
<tr><td><code id="plot_data_one_iso_+3A_return_obj">return_obj</code></td>
<td>
<p>T/F, whether or not to return ggplot object for further modification, defaults to F</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An important detail is that <code>plot_data_one_iso</code> plots the raw mix data
and <em>adds the TDF to the source data</em>, since this is the polygon that the
mixing model uses to determine proportions. The plotted source means are:
</p>
<p style="text-align: center;"><code class="reqn">\mu_source + \mu_discr</code>
</p>

<p>The source error bars are +/- 1 standard deviation, <em>calculated as a
combination of source and TDF variances:</em>
</p>
<p style="text-align: center;"><code class="reqn">\sqrt{\sigma^2_source + \sigma^2_discr}</code>
</p>

<p><code>plot_data_one_iso</code> looks for 'C', 'N', 'S', and 'O' in the biotracer column
headers and assumes they are stable isotopes, labeling the axes with, e.g.,
expression(paste(delta^13, &quot;C (u2030)&quot;,sep=&quot;&quot;)).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_data">plot_data</a></code>
</p>

<hr>
<h2 id='plot_data_two_iso'>Plot biotracer data (2-D)</h2><span id='topic+plot_data_two_iso'></span>

<h3>Description</h3>

<p><code>plot_data_two_iso</code> creates a 2-D plot of mix and source tracer data and
saves the plot to a file in the working directory
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_data_two_iso(
  isotopes,
  mix,
  source,
  discr,
  filename,
  plot_save_pdf,
  plot_save_png,
  return_obj = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_data_two_iso_+3A_isotopes">isotopes</code></td>
<td>
<p>2-vector of biotracer indices to plot (e.g. c(1,2) or c(2,3))</p>
</td></tr>
<tr><td><code id="plot_data_two_iso_+3A_mix">mix</code></td>
<td>
<p>output from <code><a href="#topic+load_mix_data">load_mix_data</a></code></p>
</td></tr>
<tr><td><code id="plot_data_two_iso_+3A_source">source</code></td>
<td>
<p>output from <code><a href="#topic+load_source_data">load_source_data</a></code></p>
</td></tr>
<tr><td><code id="plot_data_two_iso_+3A_discr">discr</code></td>
<td>
<p>output from <code><a href="#topic+load_discr_data">load_discr_data</a></code></p>
</td></tr>
<tr><td><code id="plot_data_two_iso_+3A_filename">filename</code></td>
<td>
<p>name of the plot file(s) to save (e.g. &quot;isospace_plot&quot;)</p>
</td></tr>
<tr><td><code id="plot_data_two_iso_+3A_plot_save_pdf">plot_save_pdf</code></td>
<td>
<p>T/F, save the plot(s) as a pdf?</p>
</td></tr>
<tr><td><code id="plot_data_two_iso_+3A_plot_save_png">plot_save_png</code></td>
<td>
<p>T/F, save the plot(s) as a png?</p>
</td></tr>
<tr><td><code id="plot_data_two_iso_+3A_return_obj">return_obj</code></td>
<td>
<p>T/F, whether or not to return ggplot object for further modification, defaults to F</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An important detail is that <code>plot_data_two_iso</code> plots the raw mix data
and <em>adds the TDF to the source data</em>, since this is the polygon that the
mixing model uses to determine proportions. The plotted source means are:
</p>
<p style="text-align: center;"><code class="reqn">\mu_source + \mu_discr</code>
</p>

<p>The source error bars are +/- 1 standard deviation, <em>calculated as a
combination of source and TDF variances:</em>
</p>
<p style="text-align: center;"><code class="reqn">\sqrt{\sigma^2_source + \sigma^2_discr}</code>
</p>

<p><code>plot_data_two_iso</code> looks for 'C', 'N', 'S', and 'O' in the biotracer column
headers and assumes they are stable isotopes, labeling the axes with, e.g.,
expression(paste(delta^13, &quot;C (u2030)&quot;,sep=&quot;&quot;)).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_data">plot_data</a></code>
</p>

<hr>
<h2 id='plot_intervals'>Plot posterior uncertainty intervals from a MixSIAR model</h2><span id='topic+plot_intervals'></span>

<h3>Description</h3>

<p><code>plot_intervals</code> plots the posterior interval estimates (quantile-based) from the MCMC draws in a MixSIAR model.
Calls <a href="http://mc-stan.org/bayesplot/reference/MCMC-intervals.html">bayesplot::mcmc_intervals</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_intervals(
  combined,
  toplot = "p",
  levels = NULL,
  groupby = "factor",
  savepdf = FALSE,
  filename = "post_intervals",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_intervals_+3A_combined">combined</code></td>
<td>
<p>list, output from <code><a href="#topic+combine_sources">combine_sources</a></code> function</p>
</td></tr>
<tr><td><code id="plot_intervals_+3A_toplot">toplot</code></td>
<td>
<p>vector, which parameters to plot? Options are similar to <code><a href="#topic+summary_stat">summary_stat</a></code>: 
</p>

<ul>
<li> <p><code>"p"</code>: plots all proportions (default)
</p>
</li>
<li> <p><code>"global"</code>: plots overall proportions
</p>
</li>
<li> <p><code>"fac1"</code>: plots factor 1 proportions
</p>
</li>
<li> <p><code>"fac2"</code>: plots factor 2 proportions
</p>
</li>
<li> <p><code>"epsilon"</code>: plots multiplicative error terms
</p>
</li>
<li> <p><code>"sd"</code>: plots random effect SD terms
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot_intervals_+3A_levels">levels</code></td>
<td>
<p>vector if <code>toplot="fac1"</code> or <code>toplot="fac2"</code>, which level(s) to plot? Plots all levels if <code>level=NULL</code> (default). Specify levels as a vector, e.g. in wolves ex, <code>levels=1</code> to plot Region 1, <code>levels=c(1,2)</code> to plot Regions 1 and 2.</p>
</td></tr>
<tr><td><code id="plot_intervals_+3A_groupby">groupby</code></td>
<td>
<p>character, group by &quot;factor&quot; or &quot;source&quot;? I.e. in wolves example, group proportions by Region 1, Region 2, Region 3
(<code>groupby="factor"</code>) vs. Deer, Marine Mammals, Salmon (<code>groupby="source"</code>). Currently only <code>"factor"</code> is implemented.</p>
</td></tr>
<tr><td><code id="plot_intervals_+3A_savepdf">savepdf</code></td>
<td>
<p><code>TRUE/FALSE</code>, save plot as .pdf file (in working directory)?</p>
</td></tr>
<tr><td><code id="plot_intervals_+3A_filename">filename</code></td>
<td>
<p>character, file name to save results as (<code>.pdf</code> will be appended automatically)</p>
</td></tr>
<tr><td><code id="plot_intervals_+3A_...">...</code></td>
<td>
<p>additional arguments to pass to <a href="http://mc-stan.org/bayesplot/reference/MCMC-intervals.html">bayesplot::mcmc_intervals</a>. For example:
</p>

<ul>
<li> <p><code>prob</code>: sets inner (thick) interval (default = 50%)
</p>
</li>
<li> <p><code>prob_outer</code>: sets outer (thin) interval (default = 90%)
</p>
</li>
<li> <p><code>point_est</code>: what point estimate to use (dot), default = <code>"median"</code>, can also use <code>"mean"</code> or <code>"none"</code>
</p>
</li></ul>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+combine_sources">combine_sources</a></code> and <code><a href="#topic+summary_stat">summary_stat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# 1. run mantis shrimp example
original &lt;- combine_sources(jags.1, mix, source, alpha, 
                groups=list(alphworm="alphworm",brittlestar="brittlestar",clam="clam",
                           crab="crab",fish="fish",snail="snail"))
# 2. combine 6 sources into 2 groups of interest (hard-shelled vs. soft-bodied)
#   'hard' = 'clam' + 'crab' + 'snail'           # group 1 = hard-shelled prey
#   'soft' = 'alphworm' + 'brittlestar' + 'fish' # group 2 = soft-bodied prey
combined &lt;- combine_sources(jags.1, mix, source, alpha.prior=alpha, 
                groups=list(hard=c("clam","crab","snail"), soft=c("alphworm","brittlestar","fish")))

plot_intervals(combined,toplot="fac1")
plot_intervals(original,toplot="fac1")
plot_intervals(combined,toplot="fac1",levels=1)
plot_intervals(combined,toplot="fac1",levels=2)


## End(Not run)
</code></pre>

<hr>
<h2 id='plot_prior'>Plot prior</h2><span id='topic+plot_prior'></span>

<h3>Description</h3>

<p><code>plot_prior</code> plots your prior on the global diet proportions (p.global)
and the uninformative prior side-by-side. Your prior is in red, and the
&quot;uninformative&quot;/generalist prior (alpha = 1) in dark grey.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_prior(
  alpha.prior = 1,
  source,
  plot_save_pdf = TRUE,
  plot_save_png = FALSE,
  filename = "prior_plot"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_prior_+3A_alpha.prior">alpha.prior</code></td>
<td>
<p>vector of alpha (dirichlet hyperparameters, none can be = 0)</p>
</td></tr>
<tr><td><code id="plot_prior_+3A_source">source</code></td>
<td>
<p>output from <code><a href="#topic+load_source_data">load_source_data</a></code></p>
</td></tr>
<tr><td><code id="plot_prior_+3A_plot_save_pdf">plot_save_pdf</code></td>
<td>
<p>T/F, save the plot as a pdf?</p>
</td></tr>
<tr><td><code id="plot_prior_+3A_plot_save_png">plot_save_png</code></td>
<td>
<p>T/F, save the plot as a png?</p>
</td></tr>
<tr><td><code id="plot_prior_+3A_filename">filename</code></td>
<td>
<p>name of the file to save (e.g. &quot;prior_plot&quot;)</p>
</td></tr>
</table>

<hr>
<h2 id='run_model'>Run the JAGS model</h2><span id='topic+run_model'></span>

<h3>Description</h3>

<p><code>run_model</code> calls JAGS to run the mixing model created by
<code><a href="#topic+write_JAGS_model">write_JAGS_model</a></code>. This happens when the &quot;RUN MODEL&quot; button is
clicked in the GUI.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_model(
  run,
  mix,
  source,
  discr,
  model_filename,
  alpha.prior = 1,
  resid_err = NULL,
  process_err = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run_model_+3A_run">run</code></td>
<td>
<p>list of MCMC parameters (chainLength, burn, thin, chains, calcDIC).
Alternatively, a user can use a pre-defined parameter set by specifying a
valid string:
</p>

<ul>
<li> <p><code>"test"</code>: chainLength=1000, burn=500, thin=1, chains=3
</p>
</li>
<li> <p><code>"very short"</code>: chainLength=10000, burn=5000, thin=5, chains=3
</p>
</li>
<li> <p><code>"short"</code>: chainLength=50000, burn=25000, thin=25, chains=3
</p>
</li>
<li> <p><code>"normal"</code>: chainLength=100000, burn=50000, thin=50, chains=3
</p>
</li>
<li> <p><code>"long"</code>: chainLength=300000, burn=200000, thin=100, chains=3
</p>
</li>
<li> <p><code>"very long"</code>: chainLength=1000000, burn=500000, thin=500, chains=3
</p>
</li>
<li> <p><code>"extreme"</code>: chainLength=3000000, burn=1500000, thin=500, chains=3
</p>
</li></ul>
</td></tr>
<tr><td><code id="run_model_+3A_mix">mix</code></td>
<td>
<p>output from <code><a href="#topic+load_mix_data">load_mix_data</a></code></p>
</td></tr>
<tr><td><code id="run_model_+3A_source">source</code></td>
<td>
<p>output from <code><a href="#topic+load_source_data">load_source_data</a></code></p>
</td></tr>
<tr><td><code id="run_model_+3A_discr">discr</code></td>
<td>
<p>output from <code><a href="#topic+load_discr_data">load_discr_data</a></code></p>
</td></tr>
<tr><td><code id="run_model_+3A_model_filename">model_filename</code></td>
<td>
<p>name of JAGS model file (usually should match <code>filename</code>
input to <code><a href="#topic+write_JAGS_model">write_JAGS_model</a></code>).</p>
</td></tr>
<tr><td><code id="run_model_+3A_alpha.prior">alpha.prior</code></td>
<td>
<p>Dirichlet prior on p.global (default = 1, uninformative)</p>
</td></tr>
<tr><td><code id="run_model_+3A_resid_err">resid_err</code></td>
<td>
<p>include residual error in the model? (no longer used, read from 'model_filename')</p>
</td></tr>
<tr><td><code id="run_model_+3A_process_err">process_err</code></td>
<td>
<p>include process error in the model? (no longer used, read from 'model_filename')</p>
</td></tr>
</table>


<h3>Value</h3>

<p>jags.1, a <code>rjags</code> model object
</p>
<p><em>Note: Tracer values are normalized before running the JAGS model.</em> This
allows the same priors to be used regardless of scale of the tracer data, 
without using the data to select the prior (i.e. by setting the prior mean equal
to the sample mean). Normalizing the tracer data does not affect the proportion
estimates (p_k), but does affect users seeking to plot the posterior predictive
distribution for their data. For each tracer, we calculate the pooled mean and
standard deviation of the mix and source data, then subtract the pooled mean 
and divide by the pooled standard deviation from the mix and source data. 
For details, see lines 226-269.
</p>

<hr>
<h2 id='summary_stat'>Summary statistics from posterior of MixSIAR model</h2><span id='topic+summary_stat'></span>

<h3>Description</h3>

<p><code>summary_stat</code> prints and saves summary statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary_stat(
  combined,
  toprint = "all",
  groupby = "factor",
  meanSD = TRUE,
  quantiles = c(0.025, 0.25, 0.5, 0.75, 0.975),
  savetxt = TRUE,
  filename = "summary_statistics"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_stat_+3A_combined">combined</code></td>
<td>
<p>list, output from <code><a href="#topic+combine_sources">combine_sources</a></code> function</p>
</td></tr>
<tr><td><code id="summary_stat_+3A_toprint">toprint</code></td>
<td>
<p>vector, which parameters to print? Options are: <code>"p"</code> to print stats for proportions only (all factors),
<code>"global"</code> to only print overall proportions, <code>"fac1"</code> to only print factor 1 proportions, <code>"fac2"</code> to print
factor 2 proportions. Set = <code>"epsilon"</code> to print multiplicative error term only.
Default = <code>"all"</code>, prints stats for all model parameters.</p>
</td></tr>
<tr><td><code id="summary_stat_+3A_groupby">groupby</code></td>
<td>
<p>character, group stats by &quot;factor&quot; or &quot;source&quot;? I.e. in wolves example, group proportions by Region 1, Region 2, Region 3
(<code>groupby="factor"</code>) vs. Deer, Marine Mammals, Salmon (<code>groupby="source"</code>). Currently only <code>"factor"</code> is implemented.</p>
</td></tr>
<tr><td><code id="summary_stat_+3A_meansd">meanSD</code></td>
<td>
<p><code>TRUE/FALSE</code>, print mean and SD for the parameters?</p>
</td></tr>
<tr><td><code id="summary_stat_+3A_quantiles">quantiles</code></td>
<td>
<p>vector, which quantiles to print. Default = <code>c(0.025, 0.25, 0.5, 0.75, 0.975)</code>.</p>
</td></tr>
<tr><td><code id="summary_stat_+3A_savetxt">savetxt</code></td>
<td>
<p><code>TRUE/FALSE</code>, save results as .txt file (in working directory)?</p>
</td></tr>
<tr><td><code id="summary_stat_+3A_filename">filename</code></td>
<td>
<p>character, file name to save results as (<code>.txt</code> will be appended automatically)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+combine_sources">combine_sources</a></code> and <code><a href="#topic+plot_intervals">plot_intervals</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# first run mantis shrimp example
# combine 6 sources into 2 groups of interest (hard-shelled vs. soft-bodied)
#   'hard' = 'clam' + 'crab' + 'snail'           # group 1 = hard-shelled prey
#   'soft' = 'alphworm' + 'brittlestar' + 'fish' # group 2 = soft-bodied prey
combined &lt;- combine_sources(jags.1, mix, source, alpha.prior=alpha, 
                groups=list(hard=c("clam","crab","snail"), soft=c("alphworm","brittlestar","fish")))

summary_stat(combined)
summary_stat(combined, savetxt=FALSE)
summary_stat(combined, meanSD=FALSE)
summary_stat(combined, quantiles=c(.05,.5,.95))
summary_stat(combined, toprint="fac1")
summary_stat(combined, toprint="p")
summary_stat(combined, toprint="global")

## End(Not run)
</code></pre>

<hr>
<h2 id='write_JAGS_model'>Write the JAGS model file</h2><span id='topic+write_JAGS_model'></span>

<h3>Description</h3>

<p><code>write_JAGS_model</code> creates &quot;MixSIAR_model.txt&quot;, which is passed to JAGS
by <code><a href="#topic+run_model">run_model</a></code> when the &quot;RUN MODEL&quot; button is clicked in the GUI.
Several model options will have already been specified when loading the mix
and source data, but here is where the error term options are selected:
</p>

<ol>
<li><p> Residual * Process (resid_err = TRUE, process_err = TRUE)
</p>
</li>
<li><p> Residual only (resid_err = TRUE, process_err = FALSE)
</p>
</li>
<li><p> Process only (resid_err = FALSE, process_err = TRUE)
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>write_JAGS_model(
  filename = "MixSIAR_model.txt",
  resid_err = TRUE,
  process_err = TRUE,
  mix,
  source
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_JAGS_model_+3A_filename">filename</code></td>
<td>
<p>the JAGS model file is saved in the working directory as 'filename'
(default is &quot;MixSIAR_model.txt&quot;, but user can specify).</p>
</td></tr>
<tr><td><code id="write_JAGS_model_+3A_resid_err">resid_err</code></td>
<td>
<p>T/F: include residual error in the model?</p>
</td></tr>
<tr><td><code id="write_JAGS_model_+3A_process_err">process_err</code></td>
<td>
<p>T/F: include process error in the model?</p>
</td></tr>
<tr><td><code id="write_JAGS_model_+3A_mix">mix</code></td>
<td>
<p>output from <code><a href="#topic+load_mix_data">load_mix_data</a></code></p>
</td></tr>
<tr><td><code id="write_JAGS_model_+3A_source">source</code></td>
<td>
<p>output from <code><a href="#topic+load_source_data">load_source_data</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>WARNING messages are displayed if:
</p>

<ul>
<li><p> resid_err = FALSE and process_err = FALSE are both selected.
</p>
</li>
<li><p> N=1 mix data point and did not choose &quot;Process only&quot; error model (MixSIR)
</p>
</li>
<li><p> Fitting each individual mix data point separately as a Fixed Effect,
but did not choose &quot;Process only&quot; error model (MixSIR).
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
