<!DOCTYPE html><html><head><title>Help for package ushr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ushr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#actg315raw'><p>Data from ACTG315 trial of HIV viral load in adults undergoing ART</p></a></li>
<li><a href='#add_noise'><p>Add noise to viral load observations</p></a></li>
<li><a href='#biphasic_root'><p>Biphasic root function</p></a></li>
<li><a href='#filter_data'><p>Prepare input data</p></a></li>
<li><a href='#filter_dataTTS'><p>Prepare input data for non-parametric TTS calculations.</p></a></li>
<li><a href='#fit_model'><p>Fit model and obtain parameter estimates</p></a></li>
<li><a href='#fit_model_triphasic'><p>Fit model and obtain parameter estimates</p></a></li>
<li><a href='#get_biphasic'><p>Compute the biphasic model curve</p></a></li>
<li><a href='#get_CI'><p>Calculate parameter confidence intervals</p></a></li>
<li><a href='#get_CItable'><p>Make parameter summary table</p></a></li>
<li><a href='#get_curve'><p>Compute the model for a given subject's data and best-fit parameters</p></a></li>
<li><a href='#get_error'><p>Evaluate error metric between data and model prediction</p></a></li>
<li><a href='#get_error_triphasic'><p>Evaluate error metric between data and model prediction</p></a></li>
<li><a href='#get_nonparametricTTS'><p>Non-parametric TTS function</p></a></li>
<li><a href='#get_optim_fit'><p>Fit model to data using optim</p></a></li>
<li><a href='#get_optim_fit_triphasic'><p>Fit triphasic model to data using optim</p></a></li>
<li><a href='#get_parametricTTS'><p>Parametric TTS function</p></a></li>
<li><a href='#get_params'><p>Extract fitted parameters</p></a></li>
<li><a href='#get_plottheme'><p>Get plotting theme</p></a></li>
<li><a href='#get_singlephase'><p>Compute the single phase model curve</p></a></li>
<li><a href='#get_transformed_params'><p>Transform parameters</p></a></li>
<li><a href='#get_triphasic'><p>Compute the triphasic model curve</p></a></li>
<li><a href='#get_TTS'><p>Time to suppression (TTS) function</p></a></li>
<li><a href='#plot_data'><p>Plot data</p></a></li>
<li><a href='#plot_model'><p>Plot model fits</p></a></li>
<li><a href='#plot_pairs'><p>Plot pairwise parameter distributions</p></a></li>
<li><a href='#plot_TTS'><p>Plot time to suppression distribution</p></a></li>
<li><a href='#remove_vl0'><p>Prune viral load data</p></a></li>
<li><a href='#simulate_data'><p>Create data function</p></a></li>
<li><a href='#simulate_time'><p>Simulate timepoints for subjects</p></a></li>
<li><a href='#simulate_time_fixed'><p>Simulate timepoints for subjects according to fixed design.</p></a></li>
<li><a href='#simulate_vl'><p>Simulate vl for subjects</p></a></li>
<li><a href='#single_root'><p>Single phase root function</p></a></li>
<li><a href='#summarize_model'><p>Summarize model output</p></a></li>
<li><a href='#switch_params'><p>Switch names of rate parameters</p></a></li>
<li><a href='#switch_simulated_params'><p>Switch names of simulated rate parameters</p></a></li>
<li><a href='#transformVL'><p>Transform viral load data</p></a></li>
<li><a href='#tri_switch_params'><p>Switch names of rate parameters</p></a></li>
<li><a href='#triphasic_root'><p>Triphasic root function</p></a></li>
<li><a href='#ushr'><p>Master function</p></a></li>
<li><a href='#ushr_triphasic'><p>Master function for the triphasic model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Understanding Suppression of HIV</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-04-21</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sinead E. Morris &lt;sinead.morris@columbia.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Analyzes longitudinal data of HIV decline in patients on antiretroviral therapy using the canonical biphasic exponential decay model (pioneered, for example, by work in Perelson et al. (1997) &lt;<a href="https://doi.org/10.1038%2F387188a0">doi:10.1038/387188a0</a>&gt;; and Wu and Ding (1999) &lt;<a href="https://doi.org/10.1111%2Fj.0006-341X.1999.00410.x">doi:10.1111/j.0006-341X.1999.00410.x</a>&gt;). Model fitting and parameter estimation are performed, with additional options to calculate the time to viral suppression. Plotting and summary tools are also provided for fast assessment of model results.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>dplyr (&ge; 0.8.0.1), tidyr (&ge; 0.8.3), ggplot2 (&ge; 3.1.1),
stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>GGally (&ge; 1.4.0), knitr (&ge; 1.22), rmarkdown (&ge; 1.12),
testthat (&ge; 2.2.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/SineadMorris/ushr">https://github.com/SineadMorris/ushr</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-04-21 17:08:33 UTC; sineadmorris</td>
</tr>
<tr>
<td>Author:</td>
<td>Sinead E. Morris <a href="https://orcid.org/0000-0001-8626-1698"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Luise Dziobek-Garrett [ctb],
  Andrew Yates [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-04-21 18:20:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='actg315raw'>Data from ACTG315 trial of HIV viral load in adults undergoing ART</h2><span id='topic+actg315raw'></span>

<h3>Description</h3>

<p>Data from the ACTG315 clinical trial of HIV-infected adults undergoing ART.
Data are included for 46 individuals, with HIV viral load measurements observed
on specific days up to 28 weeks after treatment initiation,
and converted to log10 RNA copies/ml. The RNA assay detection threshold was 100 copies/ml.
Additional columns include patient identifiers and CD4 T cell counts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(actg315raw)
</code></pre>


<h3>Format</h3>

<p>A data frame with 361 rows and 5 columns:
</p>

<dl>
<dt>Obs.No</dt><dd><p>Row number</p>
</dd>
<dt>Patid</dt><dd><p>Numerical patient identifier</p>
</dd>
<dt>Day</dt><dd><p>Time of each observation, in days since treatment initiation</p>
</dd>
<dt>log10.RNA.</dt><dd><p>HIV viral load measurements, in log10 RNA copies/ml</p>
</dd>
<dt>CD4</dt><dd><p>CD4 T cell counts, in cells/mm^3</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://sph.uth.edu/divisions/biostatistics/wu/datasets/ACTG315LongitudinalDataViralLoad.htm">Hulin Wu, Data Sets</a>
</p>


<h3>References</h3>

<p>Lederman et al (1998) JID 178(1), 70–79; Connick et al (2000) JID 181(1), 358–363;
Wu and Ding (1999) Biometrics 55(2), 410–418.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
data(actg315raw)

actg315 &lt;- actg315raw %&gt;%
    mutate(vl = 10^log10.RNA.) %&gt;%
    select(id = Patid, time = Day, vl)

print(head(actg315))

plot_data(actg315, detection_threshold = 100)
</code></pre>

<hr>
<h2 id='add_noise'>Add noise to viral load observations</h2><span id='topic+add_noise'></span>

<h3>Description</h3>

<p>This function adds noise to vl measurements for each subject.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_noise(vl, sd_noise)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_noise_+3A_vl">vl</code></td>
<td>
<p>numeric vector of viral load measurements.</p>
</td></tr>
<tr><td><code id="add_noise_+3A_sd_noise">sd_noise</code></td>
<td>
<p>numeric value indicating the standard deviation level to be used when adding noise to the simulated data (on the log10 scale).</p>
</td></tr>
</table>

<hr>
<h2 id='biphasic_root'>Biphasic root function</h2><span id='topic+biphasic_root'></span>

<h3>Description</h3>

<p>This function defines the root equation for the biphasic model, i.e. V(t) - suppression_threshold = 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>biphasic_root(timevec, params, suppression_threshold)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="biphasic_root_+3A_timevec">timevec</code></td>
<td>
<p>numeric vector of the times, t, at which V(t) should be calculated</p>
</td></tr>
<tr><td><code id="biphasic_root_+3A_params">params</code></td>
<td>
<p>named vector of all parameters needed to compute the biphasic model, V(t)</p>
</td></tr>
<tr><td><code id="biphasic_root_+3A_suppression_threshold">suppression_threshold</code></td>
<td>
<p>suppression threshold: measurements below this value will be assumed to represent viral suppression. Typically this would be the detection threshold of the assay. Default value is 20.</p>
</td></tr>
</table>

<hr>
<h2 id='filter_data'>Prepare input data</h2><span id='topic+filter_data'></span>

<h3>Description</h3>

<p>This function prepares the raw input data for model fitting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_data(data, detection_threshold = 20, censortime = 365,
  censor_value = 10, decline_buffer = 500, initial_buffer = 3,
  n_min_single = 3, threshold_buffer = 10, nsuppression = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_data_+3A_data">data</code></td>
<td>
<p>raw data set. Must be a data frame with the following columns: 'id' - stating the unique identifier for each subject; 'vl' - numeric vector with the viral load measurements for each subject; 'time' - numeric vector of the times at which each measurement was taken.</p>
</td></tr>
<tr><td><code id="filter_data_+3A_detection_threshold">detection_threshold</code></td>
<td>
<p>numeric value indicating the detection threshold of the assay used to measure viral load. Measurements below this value will be assumed to represent undetectable viral load levels. Default value is 20.</p>
</td></tr>
<tr><td><code id="filter_data_+3A_censortime">censortime</code></td>
<td>
<p>numeric value indicating the maximum time point to include in the analysis. Subjects who do not suppress viral load below the detection threshold within this time will be discarded. Units are assumed to be the same as the 'time' column. Default value is 365.</p>
</td></tr>
<tr><td><code id="filter_data_+3A_censor_value">censor_value</code></td>
<td>
<p>positive numeric value indicating the maximum time point to include in the analysis. Subjects who do not suppress viral load below the detection threshold within this time will be discarded. Units are assumed to be the same as the 'time' column. Default value is 365.</p>
</td></tr>
<tr><td><code id="filter_data_+3A_decline_buffer">decline_buffer</code></td>
<td>
<p>numeric value indicating the value assigned to measurements below the detection threshold. Must be less than or equal to the detection threshold.</p>
</td></tr>
<tr><td><code id="filter_data_+3A_initial_buffer">initial_buffer</code></td>
<td>
<p>numeric (integer) value indicating the maximum number of initial observations from which the beginning of each trajectory will be chosen. Default value is 3.</p>
</td></tr>
<tr><td><code id="filter_data_+3A_n_min_single">n_min_single</code></td>
<td>
<p>numeric value indicating the minimum number of data points required to be included in the analysis. Defaults to 3. It is highly advised not to go below this threshold.</p>
</td></tr>
<tr><td><code id="filter_data_+3A_threshold_buffer">threshold_buffer</code></td>
<td>
<p>numerical value indicating the range above the detection threshold which represents potential skewing of model fits. Subjects with their last two data points within this range will have the last point removed. Default value is 10.</p>
</td></tr>
<tr><td><code id="filter_data_+3A_nsuppression">nsuppression</code></td>
<td>
<p>numerical value (1 or 2) indicating whether suppression is defined as having one observation below the detection threshold, or two sustained observations. Default value is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Steps include:
1. Setting values below the detection threshold to half the detection threshold (following standard practice).
2. Filtering out subjects who do not suppress viral load below the detection threshold by a certain time.
3. Filtering out subjects who do not have a decreasing sequence of viral load (within some buffer range).
4. Filtering out subjects who do not have enough data for model fitting.
5. Removing the last data point of subjects with the last two points very close to the detection threshold. This prevents skewing of the model fit.
Further details can be found in the Vignette.
</p>


<h3>Value</h3>

<p>data frame of individuals whose viral load trajectories meet the criteria for model fitting. Includes columns for 'id', 'vl', and 'time'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1234567)

simulated_data &lt;- simulate_data(nsubjects = 20)

filter_data(simulated_data)

</code></pre>

<hr>
<h2 id='filter_dataTTS'>Prepare input data for non-parametric TTS calculations.</h2><span id='topic+filter_dataTTS'></span>

<h3>Description</h3>

<p>This function prepares the raw input data for TTS interpolation. Individuals whose data do not meet specific inclusion criteria are removed (see Vignette for more details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_dataTTS(data, suppression_threshold = 20, uppertime = 365,
  censor_value = 10, decline_buffer = 500, initial_buffer = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_dataTTS_+3A_data">data</code></td>
<td>
<p>raw data set. Must be a data frame with the following columns: 'id' - stating the unique identifier for each subject; 'vl' - numeric vector stating the viral load measurements for each subject; 'time' - numeric vector stating the time at which each measurement was taken.</p>
</td></tr>
<tr><td><code id="filter_dataTTS_+3A_suppression_threshold">suppression_threshold</code></td>
<td>
<p>numeric value indicating the suppression threshold: measurements below this value will be assumed to represent viral suppression. Typically this would be the detection threshold of the assay. Default value is 20.</p>
</td></tr>
<tr><td><code id="filter_dataTTS_+3A_uppertime">uppertime</code></td>
<td>
<p>the maximum time point to include in the analysis. Subjects who do not suppress viral load below the suppression threshold within this time will be discarded from model fitting. Units are assumed to be the same as the 'time' column. Default value is 365.</p>
</td></tr>
<tr><td><code id="filter_dataTTS_+3A_censor_value">censor_value</code></td>
<td>
<p>positive numeric value indicating the maximum time point to include in the analysis. Subjects who do not suppress viral load below the detection threshold within this time will be discarded. Units are assumed to be the same as the 'time' column. Default value is 365.</p>
</td></tr>
<tr><td><code id="filter_dataTTS_+3A_decline_buffer">decline_buffer</code></td>
<td>
<p>the maximum allowable deviation of values away from a strictly decreasing sequence in viral load. This allows for e.g. measurement noise and small fluctuations in viral load. Default value is 500.</p>
</td></tr>
<tr><td><code id="filter_dataTTS_+3A_initial_buffer">initial_buffer</code></td>
<td>
<p>numeric (integer) value indicating the maximum number of initial observations from which the beginning of each trajectory will be chosen. Default value is 3.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Steps include:
1. Setting values below the suppression threshold to half the suppression threshold (following standard practice).
2. Filtering out subjects who do not suppress viral load below the suppression threshold by a certain time.
3. Filtering out subjects who do not have a decreasing sequence of viral load (within some buffer range).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1234567)

simulated_data &lt;- simulate_data(nsubjects = 20)

filter_dataTTS(data = simulated_data)

</code></pre>

<hr>
<h2 id='fit_model'>Fit model and obtain parameter estimates</h2><span id='topic+fit_model'></span>

<h3>Description</h3>

<p>This function fits either the biphasic or single phase model to the processed data and extracts the best-fit parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_model(data, id_vector, param_names, initial_params, free_param_index,
  n_min_biphasic, model_list, whichcurve = get_biphasic,
  forward_param_transform_fn, inv_param_transform_fn, searchmethod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_model_+3A_data">data</code></td>
<td>
<p>dataframe with columns for each subject's identifier ('id'), viral load measurements ('vl'), and timing of sampling ('time')</p>
</td></tr>
<tr><td><code id="fit_model_+3A_id_vector">id_vector</code></td>
<td>
<p>vector of identifiers corresponding to the subjects to be fitted.</p>
</td></tr>
<tr><td><code id="fit_model_+3A_param_names">param_names</code></td>
<td>
<p>names of parameter vector.</p>
</td></tr>
<tr><td><code id="fit_model_+3A_initial_params">initial_params</code></td>
<td>
<p>named vector of the initial parameter guess.</p>
</td></tr>
<tr><td><code id="fit_model_+3A_free_param_index">free_param_index</code></td>
<td>
<p>logical vector indicating whether the parameters A, delta, B, gamma are to be recovered. This should be c(TRUE, TRUE, TRUE, TRUE) for the biphasic model and c(FALSE, FALSE, TRUE, TRUE) for the single phase model.</p>
</td></tr>
<tr><td><code id="fit_model_+3A_n_min_biphasic">n_min_biphasic</code></td>
<td>
<p>the minimum number of data points required to fit the biphasic model. Defaults to 6. It is highly advised not to go below this threshold.</p>
</td></tr>
<tr><td><code id="fit_model_+3A_model_list">model_list</code></td>
<td>
<p>character indicating which model is to be fit. Can be either 'four' for the biphasic model, or 'two' for the single phase model. Defaults to 'four'.</p>
</td></tr>
<tr><td><code id="fit_model_+3A_whichcurve">whichcurve</code></td>
<td>
<p>indicates which model prediction function to use. Should be get_biphasic for the biphasic model or get_singlephase for the singlephase model. Defaults to get_biphasic.</p>
</td></tr>
<tr><td><code id="fit_model_+3A_forward_param_transform_fn">forward_param_transform_fn</code></td>
<td>
<p>list of transformation functions to be used when fitting the model in optim. Defaults to log transformations for all parameters (to allow unconstrained optimization).</p>
</td></tr>
<tr><td><code id="fit_model_+3A_inv_param_transform_fn">inv_param_transform_fn</code></td>
<td>
<p>list of transformation functions to be used when back-transforming the transformed parameters. Should be the inverse of the forward transformation functions. Defaults to exponential.</p>
</td></tr>
<tr><td><code id="fit_model_+3A_searchmethod">searchmethod</code></td>
<td>
<p>optimization algorithm to be used in optim. Defaults to Nelder-Mead.</p>
</td></tr>
</table>

<hr>
<h2 id='fit_model_triphasic'>Fit model and obtain parameter estimates</h2><span id='topic+fit_model_triphasic'></span>

<h3>Description</h3>

<p>This function fits the triphasic model to the processed data and extracts the best-fit parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_model_triphasic(data, id_vector, param_names, initial_params,
  free_param_index, n_min_triphasic, forward_param_transform_fn,
  inv_param_transform_fn, searchmethod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_model_triphasic_+3A_data">data</code></td>
<td>
<p>dataframe with columns for each subject's identifier ('id'), viral load measurements ('vl'), and timing of sampling ('time')</p>
</td></tr>
<tr><td><code id="fit_model_triphasic_+3A_id_vector">id_vector</code></td>
<td>
<p>vector of identifiers corresponding to the subjects to be fitted.</p>
</td></tr>
<tr><td><code id="fit_model_triphasic_+3A_param_names">param_names</code></td>
<td>
<p>names of parameter vector.</p>
</td></tr>
<tr><td><code id="fit_model_triphasic_+3A_initial_params">initial_params</code></td>
<td>
<p>named vector of the initial parameter guess.</p>
</td></tr>
<tr><td><code id="fit_model_triphasic_+3A_free_param_index">free_param_index</code></td>
<td>
<p>logical vector indicating whether the parameters A, delta, A_b, delta_b, B, gamma are to be recovered. This should be c(TRUE, TRUE, TRUE, TRUE, TRUE, TRUE) for the triphasic model.</p>
</td></tr>
<tr><td><code id="fit_model_triphasic_+3A_n_min_triphasic">n_min_triphasic</code></td>
<td>
<p>the minimum number of data points required to fit the triphasic model.</p>
</td></tr>
<tr><td><code id="fit_model_triphasic_+3A_forward_param_transform_fn">forward_param_transform_fn</code></td>
<td>
<p>list of transformation functions to be used when fitting the model in optim. Defaults to log transformations for all parameters (to allow unconstrained optimization).</p>
</td></tr>
<tr><td><code id="fit_model_triphasic_+3A_inv_param_transform_fn">inv_param_transform_fn</code></td>
<td>
<p>list of transformation functions to be used when back-transforming the transformed parameters. Should be the inverse of the forward transformation functions. Defaults to exponential.</p>
</td></tr>
<tr><td><code id="fit_model_triphasic_+3A_searchmethod">searchmethod</code></td>
<td>
<p>optimization algorithm to be used in optim. Defaults to Nelder-Mead.</p>
</td></tr>
</table>

<hr>
<h2 id='get_biphasic'>Compute the biphasic model curve</h2><span id='topic+get_biphasic'></span>

<h3>Description</h3>

<p>This function calculates the biphasic model, V(t), for a vector of input times, t
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_biphasic(params, timevec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_biphasic_+3A_params">params</code></td>
<td>
<p>named numeric vector of all parameters needed to compute the biphasic model, V(t)</p>
</td></tr>
<tr><td><code id="get_biphasic_+3A_timevec">timevec</code></td>
<td>
<p>numeric vector of the times, t, at which V(t) should be calculated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of viral load predictions, V(t), for each time point in 'timevec'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_biphasic(params = c(A = 10000, delta = 0.68, B = 1000, gamma = 0.03),
             timevec = seq(1, 100, length.out = 100))

</code></pre>

<hr>
<h2 id='get_CI'>Calculate parameter confidence intervals</h2><span id='topic+get_CI'></span>

<h3>Description</h3>

<p>This function calculates parameter 95
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_CI(fit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_CI_+3A_fit">fit</code></td>
<td>
<p>the output of optim i.e. the fitted model for a particular subject</p>
</td></tr>
</table>

<hr>
<h2 id='get_CItable'>Make parameter summary table</h2><span id='topic+get_CItable'></span>

<h3>Description</h3>

<p>This function collate confidence intervals and parameter estimates from all subjects (fitted with the same model) into a nice table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_CItable(CIlist, param_names, free_param_index, fitted)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_CItable_+3A_cilist">CIlist</code></td>
<td>
<p>a list of confidence intervals and parameter estimates obtained from fitting either the single or biphasic model to each eligible subject.</p>
</td></tr>
<tr><td><code id="get_CItable_+3A_param_names">param_names</code></td>
<td>
<p>character vector of the parameter names. This should be c(&quot;A&quot;, &quot;delta&quot;, &quot;B&quot;, &quot;gamma&quot;) for the biphasic model or c(&quot;B&quot;, &quot;gamma&quot;) for the single phase model.</p>
</td></tr>
<tr><td><code id="get_CItable_+3A_free_param_index">free_param_index</code></td>
<td>
<p>logical vector indicating whether the parameters A, delta, B, gamma are to be included. This should be c(TRUE, TRUE, TRUE, TRUE) for the biphasic model and c(FALSE, FALSE, TRUE, TRUE) for the single phase model.</p>
</td></tr>
<tr><td><code id="get_CItable_+3A_fitted">fitted</code></td>
<td>
<p>data frame with an 'id' column of the unique identifiers for each subject represented in CIlist. Identifiers should be ordered according to their appearance in CIlist.</p>
</td></tr>
</table>

<hr>
<h2 id='get_curve'>Compute the model for a given subject's data and best-fit parameters</h2><span id='topic+get_curve'></span>

<h3>Description</h3>

<p>This function calculates the biphasic or single phase model given a subject's data and best-fit parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_curve(data, best_param, param_names, whichcurve = get_biphasic)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_curve_+3A_data">data</code></td>
<td>
<p>data frame with columns for the subject's identifier ('id') and timing of sampling ('time')</p>
</td></tr>
<tr><td><code id="get_curve_+3A_best_param">best_param</code></td>
<td>
<p>named numeric vector of best fit parameters obtained from fitting the biphasic or single phase model to the subjects data</p>
</td></tr>
<tr><td><code id="get_curve_+3A_param_names">param_names</code></td>
<td>
<p>character vector containing the names of the parameters in 'best_param'</p>
</td></tr>
<tr><td><code id="get_curve_+3A_whichcurve">whichcurve</code></td>
<td>
<p>character indicating which model function should be used. Use 'get_biphasic' for the biphasic model, or 'get_singlephase' for the single phase model. Defaults to 'get_biphasic'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns for the sampling times ('time'), fitted viral load predictions ('fit'), and the corresponding subject identifier ('id')
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
nobs &lt;- 7
example_param &lt;- c(A = 10000, delta = 0.03, B = 1000, gamma = 0.68)

vldata &lt;- get_biphasic(params = example_param, timevec = seq(5, 100, length.out = nobs))

subjectdata &lt;- data.frame(id = 123, time = seq(5, 100, length.out = nobs),
                          vl = 10^ (log10(vldata) + rnorm(nobs, 0, 0.2)))

get_curve(data = subjectdata, best_param = example_param, param_names = names(example_param))
</code></pre>

<hr>
<h2 id='get_error'>Evaluate error metric between data and model prediction</h2><span id='topic+get_error'></span>

<h3>Description</h3>

<p>For a given parameter set, this function computes the predicted viral load curve and evaluates the error metric between the prediction and observed data (to be passed to optim).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_error(params, param_names, free_param_index, data, model_list,
  inv_param_transform_fn)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_error_+3A_params">params</code></td>
<td>
<p>named vector of the parameters from which the model prediction should be generated.</p>
</td></tr>
<tr><td><code id="get_error_+3A_param_names">param_names</code></td>
<td>
<p>names of parameter vector.</p>
</td></tr>
<tr><td><code id="get_error_+3A_free_param_index">free_param_index</code></td>
<td>
<p>logical TRUE/FALSE vector indicating whether the parameters A, delta, B, gamma are to be recovered. This should be c(TRUE, TRUE, TRUE, TRUE) for the biphasic model and c(FALSE, FALSE, TRUE, TRUE) for the single phase model.</p>
</td></tr>
<tr><td><code id="get_error_+3A_data">data</code></td>
<td>
<p>dataframe with columns for the subject's viral load measurements ('vl'), and timing of sampling ('time')</p>
</td></tr>
<tr><td><code id="get_error_+3A_model_list">model_list</code></td>
<td>
<p>character indicating which model is begin fit. Can be either 'four' for the biphasic model, or 'two' for the single phase model.</p>
</td></tr>
<tr><td><code id="get_error_+3A_inv_param_transform_fn">inv_param_transform_fn</code></td>
<td>
<p>list of transformation functions to be used when back-transforming the transformed parameters. Should be the inverse of the forward transformation functions. Defaults to exponential.</p>
</td></tr>
</table>

<hr>
<h2 id='get_error_triphasic'>Evaluate error metric between data and model prediction</h2><span id='topic+get_error_triphasic'></span>

<h3>Description</h3>

<p>For a given parameter set, this function computes the predicted viral load curve and evaluates the error metric between the prediction and observed data (to be passed to optim).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_error_triphasic(params, param_names, free_param_index, data,
  inv_param_transform_fn)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_error_triphasic_+3A_params">params</code></td>
<td>
<p>named vector of the parameters from which the model prediction should be generated.</p>
</td></tr>
<tr><td><code id="get_error_triphasic_+3A_param_names">param_names</code></td>
<td>
<p>names of parameter vector.</p>
</td></tr>
<tr><td><code id="get_error_triphasic_+3A_free_param_index">free_param_index</code></td>
<td>
<p>logical TRUE/FALSE vector indicating whether the parameters A, delta, A_b, delta_b, B, gamma are to be recovered. This should be c(TRUE, TRUE, TRUE, TRUE, TRUE, TRUE) for the triphasic model.</p>
</td></tr>
<tr><td><code id="get_error_triphasic_+3A_data">data</code></td>
<td>
<p>dataframe with columns for the subject's viral load measurements ('vl'), and timing of sampling ('time').</p>
</td></tr>
<tr><td><code id="get_error_triphasic_+3A_inv_param_transform_fn">inv_param_transform_fn</code></td>
<td>
<p>list of transformation functions to be used when back-transforming the transformed parameters. Should be the inverse of the forward transformation functions. Defaults to exponential.</p>
</td></tr>
</table>

<hr>
<h2 id='get_nonparametricTTS'>Non-parametric TTS function</h2><span id='topic+get_nonparametricTTS'></span>

<h3>Description</h3>

<p>This function computes the non-parametric form of the time to suppression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_nonparametricTTS(vl, suppression_threshold, time, npoints)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_nonparametricTTS_+3A_vl">vl</code></td>
<td>
<p>numeric vector of viral load measurements.</p>
</td></tr>
<tr><td><code id="get_nonparametricTTS_+3A_suppression_threshold">suppression_threshold</code></td>
<td>
<p>numeric value for the suppression threshold: measurements below this value will be assumed to represent viral suppression. Typically this would be the detection threshold of the assay. Default value is 20.</p>
</td></tr>
<tr><td><code id="get_nonparametricTTS_+3A_time">time</code></td>
<td>
<p>numeric vector indicating the time when vl measurements were taken.</p>
</td></tr>
<tr><td><code id="get_nonparametricTTS_+3A_npoints">npoints</code></td>
<td>
<p>numeric value indicating the number of interpolation points to be considered.</p>
</td></tr>
</table>

<hr>
<h2 id='get_optim_fit'>Fit model to data using optim</h2><span id='topic+get_optim_fit'></span>

<h3>Description</h3>

<p>This function uses optim to fit either the biphasic or single phase model to data from a given subject
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_optim_fit(initial_params, param_names, free_param_index, data,
  model_list = "four",
  forward_param_transform_fn = forward_param_transform_fn,
  inv_param_transform_fn = inv_param_transform_fn, searchmethod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_optim_fit_+3A_initial_params">initial_params</code></td>
<td>
<p>named vector of the initial parameter guess.</p>
</td></tr>
<tr><td><code id="get_optim_fit_+3A_param_names">param_names</code></td>
<td>
<p>names of parameter vector.</p>
</td></tr>
<tr><td><code id="get_optim_fit_+3A_free_param_index">free_param_index</code></td>
<td>
<p>logical vector indicating whether the parameters A, delta, B, gamma are to be recovered. This should be c(TRUE, TRUE, TRUE, TRUE) for the biphasic model and c(FALSE, FALSE, TRUE, TRUE) for the single phase model.</p>
</td></tr>
<tr><td><code id="get_optim_fit_+3A_data">data</code></td>
<td>
<p>dataframe with columns for the subject's viral load measurements ('vl'), and timing of sampling ('time')</p>
</td></tr>
<tr><td><code id="get_optim_fit_+3A_model_list">model_list</code></td>
<td>
<p>character indicating which model is begin fit. Can be either 'four' for the biphasic model, or 'two' for the single phase model. Defaults to 'four'.</p>
</td></tr>
<tr><td><code id="get_optim_fit_+3A_forward_param_transform_fn">forward_param_transform_fn</code></td>
<td>
<p>list of transformation functions to be used when fitting the model in optim. Defaults to log transformations for all parameters (to allow unconstrained optimization).</p>
</td></tr>
<tr><td><code id="get_optim_fit_+3A_inv_param_transform_fn">inv_param_transform_fn</code></td>
<td>
<p>list of transformation functions to be used when back-transforming the transformed parameters. Should be the inverse of the forward transformation functions. Defaults to exponential.</p>
</td></tr>
<tr><td><code id="get_optim_fit_+3A_searchmethod">searchmethod</code></td>
<td>
<p>optimization algorithm to be used in optim. Defaults to Nelder-Mead.</p>
</td></tr>
</table>

<hr>
<h2 id='get_optim_fit_triphasic'>Fit triphasic model to data using optim</h2><span id='topic+get_optim_fit_triphasic'></span>

<h3>Description</h3>

<p>This function uses optim to fit the triphasic model to data from a given subject
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_optim_fit_triphasic(initial_params, param_names, free_param_index,
  data, forward_param_transform_fn = forward_param_transform_fn,
  inv_param_transform_fn = inv_param_transform_fn, searchmethod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_optim_fit_triphasic_+3A_initial_params">initial_params</code></td>
<td>
<p>named vector of the initial parameter guess.</p>
</td></tr>
<tr><td><code id="get_optim_fit_triphasic_+3A_param_names">param_names</code></td>
<td>
<p>names of parameter vector.</p>
</td></tr>
<tr><td><code id="get_optim_fit_triphasic_+3A_free_param_index">free_param_index</code></td>
<td>
<p>logical vector indicating whether the parameters A, delta, A_b, delta_b, B, gamma are to be recovered. This should be c(TRUE, TRUE, TRUE, TRUE, TRUE, TRUE) for the triphasic model.</p>
</td></tr>
<tr><td><code id="get_optim_fit_triphasic_+3A_data">data</code></td>
<td>
<p>dataframe with columns for the subject's viral load measurements ('vl'), and timing of sampling ('time')</p>
</td></tr>
<tr><td><code id="get_optim_fit_triphasic_+3A_forward_param_transform_fn">forward_param_transform_fn</code></td>
<td>
<p>list of transformation functions to be used when fitting the model in optim. Defaults to log transformations for all parameters (to allow unconstrained optimization).</p>
</td></tr>
<tr><td><code id="get_optim_fit_triphasic_+3A_inv_param_transform_fn">inv_param_transform_fn</code></td>
<td>
<p>list of transformation functions to be used when back-transforming the transformed parameters. Should be the inverse of the forward transformation functions. Defaults to exponential.</p>
</td></tr>
<tr><td><code id="get_optim_fit_triphasic_+3A_searchmethod">searchmethod</code></td>
<td>
<p>optimization algorithm to be used in optim. Defaults to Nelder-Mead.</p>
</td></tr>
</table>

<hr>
<h2 id='get_parametricTTS'>Parametric TTS function</h2><span id='topic+get_parametricTTS'></span>

<h3>Description</h3>

<p>This function computes the parametric form of the time to suppression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_parametricTTS(params, rootfunction, suppression_threshold, uppertime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_parametricTTS_+3A_params">params</code></td>
<td>
<p>named vector of all parameters needed to compute the suppression model, V(t)</p>
</td></tr>
<tr><td><code id="get_parametricTTS_+3A_rootfunction">rootfunction</code></td>
<td>
<p>specifies which function should be used to calculate the root: biphasic or single phase.</p>
</td></tr>
<tr><td><code id="get_parametricTTS_+3A_suppression_threshold">suppression_threshold</code></td>
<td>
<p>suppression threshold: measurements below this value will be assumed to represent viral suppression. Typically this would be the detection threshold of the assay. Default value is 20.</p>
</td></tr>
<tr><td><code id="get_parametricTTS_+3A_uppertime">uppertime</code></td>
<td>
<p>numeric value indicating the maximum time that will be considered. Default value is 365.</p>
</td></tr>
</table>

<hr>
<h2 id='get_params'>Extract fitted parameters</h2><span id='topic+get_params'></span>

<h3>Description</h3>

<p>This function extracts all untransformed parameters from the output of optim (i.e. the fitted model).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_params(fit, initial_params, free_param_index, param_names,
  inv_param_transform_fn, index = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_params_+3A_fit">fit</code></td>
<td>
<p>the output of optim i.e. the fitted model for a particular subject</p>
</td></tr>
<tr><td><code id="get_params_+3A_initial_params">initial_params</code></td>
<td>
<p>named vector of the initial parameter guess</p>
</td></tr>
<tr><td><code id="get_params_+3A_free_param_index">free_param_index</code></td>
<td>
<p>logical TRUE/FALSE vector indicating whether the parameters A, delta, B, gamma are to be recovered. This should be c(TRUE, TRUE, TRUE, TRUE) for the biphasic model and c(FALSE, FALSE, TRUE, TRUE) for the single phase model.</p>
</td></tr>
<tr><td><code id="get_params_+3A_param_names">param_names</code></td>
<td>
<p>character vector of the parameter names. This should be c(&quot;A&quot;, &quot;delta&quot;, &quot;B&quot;, &quot;gamma&quot;) for the biphasic model or c(&quot;B&quot;, &quot;gamma&quot;) for the single phase model.</p>
</td></tr>
<tr><td><code id="get_params_+3A_inv_param_transform_fn">inv_param_transform_fn</code></td>
<td>
<p>list of transformation functions to be used when back-transforming the transformed parameters. Should be the inverse of the forward transformation functions.</p>
</td></tr>
<tr><td><code id="get_params_+3A_index">index</code></td>
<td>
<p>indicator value used inside the master function to indicate the subject number.</p>
</td></tr>
</table>

<hr>
<h2 id='get_plottheme'>Get plotting theme</h2><span id='topic+get_plottheme'></span>

<h3>Description</h3>

<p>This function sets the plotting theme for ggplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_plottheme(textsize)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_plottheme_+3A_textsize">textsize</code></td>
<td>
<p>numeric value for base text size. Default is 9.</p>
</td></tr>
</table>

<hr>
<h2 id='get_singlephase'>Compute the single phase model curve</h2><span id='topic+get_singlephase'></span>

<h3>Description</h3>

<p>This function calculates the single phase model, V(t), for vector of input times, t
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_singlephase(params, timevec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_singlephase_+3A_params">params</code></td>
<td>
<p>named numeric vector of all parameters needed to compute the single phase model, V(t)</p>
</td></tr>
<tr><td><code id="get_singlephase_+3A_timevec">timevec</code></td>
<td>
<p>numeric vector of the times, t, at which V(t) should be calculated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of viral load predictions, V(t), for each time point in 'timevec'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_singlephase(params = c(B = 1000, gamma = 0.68), timevec = seq(1, 100, length.out = 100))

</code></pre>

<hr>
<h2 id='get_transformed_params'>Transform parameters</h2><span id='topic+get_transformed_params'></span>

<h3>Description</h3>

<p>This function transforms parameter estimates according to user defined functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_transformed_params(params, param_transform_fn)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_transformed_params_+3A_params">params</code></td>
<td>
<p>vector of parameters</p>
</td></tr>
<tr><td><code id="get_transformed_params_+3A_param_transform_fn">param_transform_fn</code></td>
<td>
<p>vector of functions for parameter transformation</p>
</td></tr>
</table>

<hr>
<h2 id='get_triphasic'>Compute the triphasic model curve</h2><span id='topic+get_triphasic'></span>

<h3>Description</h3>

<p>This function calculates the triphasic model, V(t), for a vector of input times, t
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_triphasic(params, timevec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_triphasic_+3A_params">params</code></td>
<td>
<p>named numeric vector of all parameters needed to compute the triphasic model, V(t)</p>
</td></tr>
<tr><td><code id="get_triphasic_+3A_timevec">timevec</code></td>
<td>
<p>numeric vector of the times, t, at which V(t) should be calculated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of viral load predictions, V(t), for each time point in 'timevec'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_triphasic(params = c(A = 10000, delta = 1, B = 1000, gamma = 0.1, C = 100, omega = 0.03),
             timevec = seq(1, 100, length.out = 100))

</code></pre>

<hr>
<h2 id='get_TTS'>Time to suppression (TTS) function</h2><span id='topic+get_TTS'></span>

<h3>Description</h3>

<p>This function calculates the time to suppress HIV below a specified threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_TTS(model_output = NULL, data = NULL, suppression_threshold = 20,
  uppertime = 365, censor_value = 10, decline_buffer = 500,
  initial_buffer = 3, parametric = TRUE, ARTstart = FALSE,
  npoints = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_TTS_+3A_model_output">model_output</code></td>
<td>
<p>output from fitting model. Only required if parametric = TRUE.</p>
</td></tr>
<tr><td><code id="get_TTS_+3A_data">data</code></td>
<td>
<p>raw data set. Must be a data frame with the following columns: 'id' - stating the unique identifier for each subject; 'vl'- numeric vector stating the viral load measurements for each subject; 'time'  - numeric vector stating the time at which each measurement was taken. Only required if parametric = FALSE.</p>
</td></tr>
<tr><td><code id="get_TTS_+3A_suppression_threshold">suppression_threshold</code></td>
<td>
<p>suppression threshold: measurements below this value will be assumed to represent viral suppression. Typically this would be the detection threshold of the assay. Default value is 20.</p>
</td></tr>
<tr><td><code id="get_TTS_+3A_uppertime">uppertime</code></td>
<td>
<p>the maximum time interval to search for the time to suppression. Default value is 365.</p>
</td></tr>
<tr><td><code id="get_TTS_+3A_censor_value">censor_value</code></td>
<td>
<p>positive numeric value indicating the maximum time point to include in the analysis. Subjects who do not suppress viral load below the detection threshold within this time will be discarded. Units are assumed to be the same as the 'time' column. Default value is 365.</p>
</td></tr>
<tr><td><code id="get_TTS_+3A_decline_buffer">decline_buffer</code></td>
<td>
<p>the maximum allowable deviation of values away from a strictly decreasing sequence in viral load. This allows for e.g. measurement noise and small fluctuations in viral load. Default value is 500.</p>
</td></tr>
<tr><td><code id="get_TTS_+3A_initial_buffer">initial_buffer</code></td>
<td>
<p>numeric (integer) value indicating the maximum number of initial observations from which the beginning of each trajectory will be chosen. Default value is 3.</p>
</td></tr>
<tr><td><code id="get_TTS_+3A_parametric">parametric</code></td>
<td>
<p>logical TRUE/FALSE indicating whether time to suppression should be calculated using the parametric (TRUE) or non-parametric (FALSE) method. If TRUE, a fitted model object is required. If FALSE, the raw data frame is required. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="get_TTS_+3A_artstart">ARTstart</code></td>
<td>
<p>logical TRUE/FALSE indicating whether the time to suppression should be represented as time since ART initiation. Default = FALSE. If TRUE, ART initiation times must be included as a data column named 'ART'.</p>
</td></tr>
<tr><td><code id="get_TTS_+3A_npoints">npoints</code></td>
<td>
<p>numeric value of the number of interpolation points to be considered. Default is 1000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Options include: parametric (i.e. using the fitted model) or non-parametric (i.e. interpolating the processed data).
</p>


<h3>Value</h3>

<p>a data frame containing all individuals who fit the inclusion criteria, along with their TTS estimates, and a column indicating whether the parametric or nonparametric approach was used.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1234567)

simulated_data &lt;- simulate_data(nsubjects = 20)

get_TTS(data = simulated_data, parametric = FALSE)

</code></pre>

<hr>
<h2 id='plot_data'>Plot data</h2><span id='topic+plot_data'></span>

<h3>Description</h3>

<p>This function plots raw, filtered, or simulated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_data(data, textsize = 9, pointsize = 1, linesize = 0.5,
  facet_col = NULL, detection_threshold = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_data_+3A_data">data</code></td>
<td>
<p>data frame of raw, filtered, or simulated data. Must include the following columns: 'id' - stating the unique identifier for each subject; 'vl' - numeric vector stating the viral load measurements for each subject; 'time'- numeric vector stating the time at which each measurement was taken.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_textsize">textsize</code></td>
<td>
<p>numeric value for base text size in ggplot. Default is 9.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_pointsize">pointsize</code></td>
<td>
<p>numeric value for point size in ggplot. Default is 1.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_linesize">linesize</code></td>
<td>
<p>numeric value for line width in ggplot. Default is 0.5.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_facet_col">facet_col</code></td>
<td>
<p>numeric value for number of columns to use when faceting subject panels. Defaults to NULL (i.e. ggplot default).</p>
</td></tr>
<tr><td><code id="plot_data_+3A_detection_threshold">detection_threshold</code></td>
<td>
<p>numeric value indicating the detection threshold of the assay used to measure viral load. Default value is 20.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1234567)

simulated_data &lt;- simulate_data(nsubjects = 20)

plot_data(simulated_data)

</code></pre>

<hr>
<h2 id='plot_model'>Plot model fits</h2><span id='topic+plot_model'></span>

<h3>Description</h3>

<p>This function plots the output from model fitting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_model(model_output, type = "biphasic", detection_threshold = 20,
  textsize = 9, pointsize = 1, linesize = 0.5, facet_col = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_model_+3A_model_output">model_output</code></td>
<td>
<p>output from model fitting using ushr().</p>
</td></tr>
<tr><td><code id="plot_model_+3A_type">type</code></td>
<td>
<p>character string indicating whether the biphasic or single phase fits should be plotted. Must be either &quot;biphasic&quot;, &quot;single&quot;, or &quot;triphasic&quot;. Defaults to &quot;biphasic&quot;.</p>
</td></tr>
<tr><td><code id="plot_model_+3A_detection_threshold">detection_threshold</code></td>
<td>
<p>numeric value indicating the detection threshold of the assay used to measure viral load. Default value is 20.</p>
</td></tr>
<tr><td><code id="plot_model_+3A_textsize">textsize</code></td>
<td>
<p>numeric value for base text size in ggplot. Default is 9.</p>
</td></tr>
<tr><td><code id="plot_model_+3A_pointsize">pointsize</code></td>
<td>
<p>numeric value for point size in ggplot. Default is 1.</p>
</td></tr>
<tr><td><code id="plot_model_+3A_linesize">linesize</code></td>
<td>
<p>numeric value for line width in ggplot. Default is 0.5.</p>
</td></tr>
<tr><td><code id="plot_model_+3A_facet_col">facet_col</code></td>
<td>
<p>numeric value for number of columns to use when faceting subject panels. Defaults to NULL (i.e. ggplot default).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1234567)

simulated_data &lt;- simulate_data(nsubjects = 20)

model_output &lt;- ushr(data = simulated_data)

plot_model(model_output, type = "biphasic")

</code></pre>

<hr>
<h2 id='plot_pairs'>Plot pairwise parameter distributions</h2><span id='topic+plot_pairs'></span>

<h3>Description</h3>

<p>This function creates pairwise scatterplots of the estimates parameters. The default plotting method requires GGally; if this package is not available, base R is used instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_pairs(model_output, type = "biphasic", textsize = 9,
  pointsize = 1, linesize = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_pairs_+3A_model_output">model_output</code></td>
<td>
<p>output from model fitting using ushr().</p>
</td></tr>
<tr><td><code id="plot_pairs_+3A_type">type</code></td>
<td>
<p>character string indicating whether the biphasic or single phase fits should be plotted. Must be either &quot;biphasic&quot;, &quot;single&quot;, or &quot;triphasic&quot;. Defaults to &quot;biphasic&quot;.</p>
</td></tr>
<tr><td><code id="plot_pairs_+3A_textsize">textsize</code></td>
<td>
<p>numeric value for base text size. Default is 9.</p>
</td></tr>
<tr><td><code id="plot_pairs_+3A_pointsize">pointsize</code></td>
<td>
<p>numeric value for point size. Default is 1.</p>
</td></tr>
<tr><td><code id="plot_pairs_+3A_linesize">linesize</code></td>
<td>
<p>numeric value for line width; only used for GGally plots. Default is 0.5.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1234567)

simulated_data &lt;- simulate_data(nsubjects = 20)

model_output &lt;- ushr(data = simulated_data)

plot_pairs(model_output)
</code></pre>

<hr>
<h2 id='plot_TTS'>Plot time to suppression distribution</h2><span id='topic+plot_TTS'></span>

<h3>Description</h3>

<p>This function plots a histogram of the time to suppression estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_TTS(TTS_output, textsize = 9, bins = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_TTS_+3A_tts_output">TTS_output</code></td>
<td>
<p>output from estimating time to suppression (TTS) values using get_TTS()..</p>
</td></tr>
<tr><td><code id="plot_TTS_+3A_textsize">textsize</code></td>
<td>
<p>numeric value for base text size on ggplot. Default is 9.</p>
</td></tr>
<tr><td><code id="plot_TTS_+3A_bins">bins</code></td>
<td>
<p>numeric value indicating the number of bins for the histogram. Default is 20.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1234567)

simulated_data &lt;- simulate_data(nsubjects = 20)

TTSestimates &lt;- get_TTS(data = simulated_data, parametric = FALSE)

plot_TTS(TTSestimates, bins = 5)

</code></pre>

<hr>
<h2 id='remove_vl0'>Prune viral load data</h2><span id='topic+remove_vl0'></span>

<h3>Description</h3>

<p>This function removes the first viral load data point for specific subjects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_vl0(id, which_ids, subset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_vl0_+3A_id">id</code></td>
<td>
<p>vector of subject ids</p>
</td></tr>
<tr><td><code id="remove_vl0_+3A_which_ids">which_ids</code></td>
<td>
<p>vector of ids that should have the first point removed</p>
</td></tr>
<tr><td><code id="remove_vl0_+3A_subset">subset</code></td>
<td>
<p>data frame to which the function should be applied</p>
</td></tr>
</table>

<hr>
<h2 id='simulate_data'>Create data function</h2><span id='topic+simulate_data'></span>

<h3>Description</h3>

<p>This function simulates example data that can be used to explore model fitting and plotting within the package. Subjects are assumed to be observed at regular intervals until either the end of the study or they are lost to follow up.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_data(nsubjects = 10, detection_threshold = 20,
  censortime = 365, max_datapoints = 24, min_datapoints = 6,
  sd_noise = 0.1, param_noise = c(1.5, 0.1, 1.5, 0.1),
  mean_params = c(A = 10000, delta = 0.3, B = 10000, gamma = 0.03))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_data_+3A_nsubjects">nsubjects</code></td>
<td>
<p>numeric value indicating the number of subjects you want to simulate data for. Default is 10.</p>
</td></tr>
<tr><td><code id="simulate_data_+3A_detection_threshold">detection_threshold</code></td>
<td>
<p>numeric value indicating the detection threshold of the assay used to measure viral load. Measurements below this value will be assumed to represent undetectable viral load levels. Default value is 20.</p>
</td></tr>
<tr><td><code id="simulate_data_+3A_censortime">censortime</code></td>
<td>
<p>numeric value indicating the maximum time point to include in the analysis. Default value is 365.</p>
</td></tr>
<tr><td><code id="simulate_data_+3A_max_datapoints">max_datapoints</code></td>
<td>
<p>numeric value indicating the maximum number of data points collected from any subject. Defaults to 24.</p>
</td></tr>
<tr><td><code id="simulate_data_+3A_min_datapoints">min_datapoints</code></td>
<td>
<p>numeric value indicating the minimum number of data points collected from any subject. Defaults to 6.</p>
</td></tr>
<tr><td><code id="simulate_data_+3A_sd_noise">sd_noise</code></td>
<td>
<p>numeric value indicating the standard deviation level to be used when adding noise to the simulated data (on the log10 scale). Default value is 0.1</p>
</td></tr>
<tr><td><code id="simulate_data_+3A_param_noise">param_noise</code></td>
<td>
<p>numeric vector indicating the standard deviation to be used when selecting parameter values (on the log scale). Order of entries should be: A, delta, B, gamma. Default value is c(1.5, 0.1, 1.5, 0.1).</p>
</td></tr>
<tr><td><code id="simulate_data_+3A_mean_params">mean_params</code></td>
<td>
<p>named numeric vector indicating the mean parameter values for the subject decay curves. Default is c(A = 10000, delta = 0.3, B = 10000, gamma = 0.03).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1234567)

simulated_data &lt;- simulate_data(nsubjects = 20)

</code></pre>

<hr>
<h2 id='simulate_time'>Simulate timepoints for subjects</h2><span id='topic+simulate_time'></span>

<h3>Description</h3>

<p>This function chooses the correct function for sampling observation times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_time(npoints, censortime, id, index, max_datapoints)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_time_+3A_npoints">npoints</code></td>
<td>
<p>numeric value indicating the number of observations to be sampled.</p>
</td></tr>
<tr><td><code id="simulate_time_+3A_censortime">censortime</code></td>
<td>
<p>numeric value indicating the maximum time point to include in the analysis.</p>
</td></tr>
<tr><td><code id="simulate_time_+3A_id">id</code></td>
<td>
<p>subject id. Can be numeric or a character.</p>
</td></tr>
<tr><td><code id="simulate_time_+3A_index">index</code></td>
<td>
<p>numeric identifier for each subject/model combination.</p>
</td></tr>
<tr><td><code id="simulate_time_+3A_max_datapoints">max_datapoints</code></td>
<td>
<p>numeric value indicating the maximum number of data points collected from any subject.</p>
</td></tr>
</table>

<hr>
<h2 id='simulate_time_fixed'>Simulate timepoints for subjects according to fixed design.</h2><span id='topic+simulate_time_fixed'></span>

<h3>Description</h3>

<p>This function simulates observed timepoints for each subject according to a fixed sampling design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_time_fixed(npoints, censortime, id, index, max_datapoints)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_time_fixed_+3A_npoints">npoints</code></td>
<td>
<p>numeric value indicating the number of observations to be sampled.</p>
</td></tr>
<tr><td><code id="simulate_time_fixed_+3A_censortime">censortime</code></td>
<td>
<p>numeric value indicating the maximum time point to include in the analysis.</p>
</td></tr>
<tr><td><code id="simulate_time_fixed_+3A_id">id</code></td>
<td>
<p>subject id. Can be numeric or a character.</p>
</td></tr>
<tr><td><code id="simulate_time_fixed_+3A_index">index</code></td>
<td>
<p>numeric identifier for each subject/model combination.</p>
</td></tr>
<tr><td><code id="simulate_time_fixed_+3A_max_datapoints">max_datapoints</code></td>
<td>
<p>numeric value indicating the maximum number of data points collected from any subject.</p>
</td></tr>
</table>

<hr>
<h2 id='simulate_vl'>Simulate vl for subjects</h2><span id='topic+simulate_vl'></span>

<h3>Description</h3>

<p>This function simulates observed vl for each subject.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_vl(params, timevec, id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_vl_+3A_params">params</code></td>
<td>
<p>named numeric vector of parameter values to simulate the biphasic model.</p>
</td></tr>
<tr><td><code id="simulate_vl_+3A_timevec">timevec</code></td>
<td>
<p>numeric vector of observed timepoints.</p>
</td></tr>
<tr><td><code id="simulate_vl_+3A_id">id</code></td>
<td>
<p>subject id. Can be numeric or a character.</p>
</td></tr>
</table>

<hr>
<h2 id='single_root'>Single phase root function</h2><span id='topic+single_root'></span>

<h3>Description</h3>

<p>This function defines the root equation for the single phase model, i.e. V(t) - suppression_threshold = 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>single_root(timevec, params, suppression_threshold)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="single_root_+3A_timevec">timevec</code></td>
<td>
<p>numeric vector of the times, t, at which V(t) should be calculated</p>
</td></tr>
<tr><td><code id="single_root_+3A_params">params</code></td>
<td>
<p>named vector of all parameters needed to compute the single phase model, V(t)</p>
</td></tr>
<tr><td><code id="single_root_+3A_suppression_threshold">suppression_threshold</code></td>
<td>
<p>suppression threshold: measurements below this value will be assumed to represent viral suppression. Typically this would be the detection threshold of the assay. Default value is 20.</p>
</td></tr>
</table>

<hr>
<h2 id='summarize_model'>Summarize model output</h2><span id='topic+summarize_model'></span>

<h3>Description</h3>

<p>This function summarizes the output of model fitting..
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarize_model(model_output, data, stats = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarize_model_+3A_model_output">model_output</code></td>
<td>
<p>output from model fitting using ushr().</p>
</td></tr>
<tr><td><code id="summarize_model_+3A_data">data</code></td>
<td>
<p>dataframe of original data used for model fitting. Must include named 'id' column with subject identifiers.</p>
</td></tr>
<tr><td><code id="summarize_model_+3A_stats">stats</code></td>
<td>
<p>logical TRUE/FALSE: should the median and sd lifespans also be returned? Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing (i) a summary of which subjects were successfully fit using the biphasic or single phase models, with their corresponding infected cell lifespan estimates ('summary'); (ii) if stats = TRUE: summary statistics for the estimated parameters from the biphasic model ('biphasicstats'); and (iii) if stats = TRUE: summary statistics for the estimated parameters from the single phase model ('singlestats').
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1234567)

simulated_data &lt;- simulate_data(nsubjects = 20)

model_output &lt;- ushr(data = simulated_data)

summarize_model(model_output, data = simulated_data)

</code></pre>

<hr>
<h2 id='switch_params'>Switch names of rate parameters</h2><span id='topic+switch_params'></span>

<h3>Description</h3>

<p>This function switches the names of delta and gamma estimates if gamma &gt; delta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>switch_params(biphasicCI)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="switch_params_+3A_biphasicci">biphasicCI</code></td>
<td>
<p>data frame of parameter estimates and confidence intervals for the biphasic model.</p>
</td></tr>
</table>

<hr>
<h2 id='switch_simulated_params'>Switch names of simulated rate parameters</h2><span id='topic+switch_simulated_params'></span>

<h3>Description</h3>

<p>This function switches the names of delta and gamma estimates if gamma &gt; delta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>switch_simulated_params(params)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="switch_simulated_params_+3A_params">params</code></td>
<td>
<p>matrix of parameter estimates</p>
</td></tr>
</table>

<hr>
<h2 id='transformVL'>Transform viral load data</h2><span id='topic+transformVL'></span>

<h3>Description</h3>

<p>This function takes the log10 transform of viral load data &amp; checks for NAs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformVL(VL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transformVL_+3A_vl">VL</code></td>
<td>
<p>vector of viral load data</p>
</td></tr>
</table>

<hr>
<h2 id='tri_switch_params'>Switch names of rate parameters</h2><span id='topic+tri_switch_params'></span>

<h3>Description</h3>

<p>This function switches the names of delta and gamma estimates if gamma &gt; delta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tri_switch_params(triphasicCI)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tri_switch_params_+3A_triphasicci">triphasicCI</code></td>
<td>
<p>data frame of parameter estimates and confidence intervals for the biphasic model.</p>
</td></tr>
</table>

<hr>
<h2 id='triphasic_root'>Triphasic root function</h2><span id='topic+triphasic_root'></span>

<h3>Description</h3>

<p>This function defines the root equation for the triphasic model, i.e. V(t) - suppression_threshold = 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>triphasic_root(timevec, params, suppression_threshold)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="triphasic_root_+3A_timevec">timevec</code></td>
<td>
<p>numeric vector of the times, t, at which V(t) should be calculated</p>
</td></tr>
<tr><td><code id="triphasic_root_+3A_params">params</code></td>
<td>
<p>named vector of all parameters needed to compute the triphasic model, V(t)</p>
</td></tr>
<tr><td><code id="triphasic_root_+3A_suppression_threshold">suppression_threshold</code></td>
<td>
<p>suppression threshold: measurements below this value will be assumed to represent viral suppression. Typically this would be the detection threshold of the assay. Default value is 20.</p>
</td></tr>
</table>

<hr>
<h2 id='ushr'>Master function</h2><span id='topic+ushr'></span>

<h3>Description</h3>

<p>This function performs the entire analysis, from data filtering to fitting the biphasic/single phase models. The biphasic/single phase models should be used when ART comprises of RTI/PIs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ushr(data, filter = TRUE, detection_threshold = 20, censortime = 365,
  censor_value = 10, decline_buffer = 500, initial_buffer = 3,
  threshold_buffer = 10, VL_max_decline = 10000, CI_max_diff = 1000,
  n_min_single = 3, n_min_biphasic = 6, nsuppression = 1,
  forward_param_transform_fn = list(log, log, log, log),
  inv_param_transform_fn = list(exp, exp, exp, exp),
  initial_params = c(A = 10000, delta = 0.68, B = 1000, gamma = 0.03),
  searchmethod = "Nelder-Mead")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ushr_+3A_data">data</code></td>
<td>
<p>raw data set. Must be a data frame with the following columns: 'id' - stating the unique identifier for each subject; 'vl' - numeric vector stating the viral load measurements for each subject; 'time'- numeric vector stating the time at which each measurement was taken.</p>
</td></tr>
<tr><td><code id="ushr_+3A_filter">filter</code></td>
<td>
<p>Logical TRUE/FALSE indicating whether the data should be processed (highly recommended) prior to model fitting. Default is TRUE.</p>
</td></tr>
<tr><td><code id="ushr_+3A_detection_threshold">detection_threshold</code></td>
<td>
<p>numeric value indicating the detection threshold of the assay used to measure viral load. Measurements below this value will be assumed to represent undetectable viral levels. Default value is 20.</p>
</td></tr>
<tr><td><code id="ushr_+3A_censortime">censortime</code></td>
<td>
<p>numeric value indicating the maximum time point to include in the analysis. Subjects who do not suppress viral load below the detection threshold within this time will be discarded from model fitting. Units are assumed to be same as the 'time' measurements. Default value is 365.</p>
</td></tr>
<tr><td><code id="ushr_+3A_censor_value">censor_value</code></td>
<td>
<p>positive numeric value indicating the maximum time point to include in the analysis. Subjects who do not suppress viral load below the detection threshold within this time will be discarded. Units are assumed to be the same as the 'time' column. Default value is 365.</p>
</td></tr>
<tr><td><code id="ushr_+3A_decline_buffer">decline_buffer</code></td>
<td>
<p>numeric value indicating the maximum allowable deviation of values away from a strictly decreasing sequence in viral load. This allows for e.g. measurement noise and small fluctuations in viral load. Default value is 500.</p>
</td></tr>
<tr><td><code id="ushr_+3A_initial_buffer">initial_buffer</code></td>
<td>
<p>integer value indicating the maximum number of initial observations from which the beginning of each trajectory will be chosen. Default value is 3.</p>
</td></tr>
<tr><td><code id="ushr_+3A_threshold_buffer">threshold_buffer</code></td>
<td>
<p>numeric value indicating the range above the detection threshold which represents potential skewing of model fits. Subjects with their last two data points within this range will have the last point removed. Default value is 10.</p>
</td></tr>
<tr><td><code id="ushr_+3A_vl_max_decline">VL_max_decline</code></td>
<td>
<p>numeric value indicating the maximum allowable difference between first and second viral load measurements. Default is 10,000.</p>
</td></tr>
<tr><td><code id="ushr_+3A_ci_max_diff">CI_max_diff</code></td>
<td>
<p>numeric value indicating the maximum allowable relative difference between lower and upper 95% confidence intervals i.e. (upper CI - lower CI)/lower CI. Default is 1000.</p>
</td></tr>
<tr><td><code id="ushr_+3A_n_min_single">n_min_single</code></td>
<td>
<p>numeric value indicating the minimum number of data points required to be included in the analysis. Defaults to 3. It is highly advised not to go below this threshold.</p>
</td></tr>
<tr><td><code id="ushr_+3A_n_min_biphasic">n_min_biphasic</code></td>
<td>
<p>numeric value indicating the minimum number of data points required to fit the biphasic model. Defaults to 6. It is highly advised not to go below this threshold.</p>
</td></tr>
<tr><td><code id="ushr_+3A_nsuppression">nsuppression</code></td>
<td>
<p>numerical value (1 or 2) indicating whether suppression is defined as having one observation below the detection threshold, or two sustained observations. Default value is 1.</p>
</td></tr>
<tr><td><code id="ushr_+3A_forward_param_transform_fn">forward_param_transform_fn</code></td>
<td>
<p>list of transformation functions to be used when fitting the model in optim. Defaults to log transformations for all parameters (to allow unconstrained optimization).</p>
</td></tr>
<tr><td><code id="ushr_+3A_inv_param_transform_fn">inv_param_transform_fn</code></td>
<td>
<p>list of transformation functions to be used when back-transforming the transformed parameters. Should be the inverse of the forward transformation functions. Defaults to exponential.</p>
</td></tr>
<tr><td><code id="ushr_+3A_initial_params">initial_params</code></td>
<td>
<p>named numeric vector of initial parameter guesses. Defaults to c(A = 10000, delta = 0.68, B = 1000, gamma = 0.03).</p>
</td></tr>
<tr><td><code id="ushr_+3A_searchmethod">searchmethod</code></td>
<td>
<p>optimization algorithm to be passed to 'optim()'. Defaults to 'Nelder-Mead'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Steps include:
1. Processing the raw data.
2. Fitting the biphasic model to subjects with eligible data e.g. those with enough data points and reliable confidence interval estimates.
3. Fitting the single phase model to the remaining subjects.
</p>


<h3>Value</h3>

<p>a list containing the filtered data ('data_filtered'); parameter estimates for the biphasic and single phase models ('biphasicCI' and 'singleCI'); and predictions from the biphasic and single phase models ('biphasic_fits' and 'single_fits').
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1234567)

simulated_data &lt;- simulate_data(nsubjects = 20)

model_output &lt;- ushr(data = simulated_data)

</code></pre>

<hr>
<h2 id='ushr_triphasic'>Master function for the triphasic model</h2><span id='topic+ushr_triphasic'></span>

<h3>Description</h3>

<p>This function performs the entire analysis, from data filtering to triphasic model fitting. The triphasic model should be used when ART includes an integrase inhibitor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ushr_triphasic(data, filter = TRUE, detection_threshold = 20,
  censortime = 365, censor_value = 10, decline_buffer = 500,
  initial_buffer = 3, threshold_buffer = 10, VL_max_decline = 10000,
  CI_max_diff = 1000, n_min_triphasic = 9, nsuppression = 1,
  forward_param_transform_fn = list(log, log, log, log, log, log),
  inv_param_transform_fn = list(exp, exp, exp, exp, exp, exp),
  initial_params = c(A = 10000, delta = 1, A_b = 1000, delta_b = 0.15, B
  = 10, gamma = 0.05), searchmethod = "Nelder-Mead")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ushr_triphasic_+3A_data">data</code></td>
<td>
<p>raw data set. Must be a data frame with the following columns: 'id' - stating the unique identifier for each subject; 'vl' - numeric vector stating the viral load measurements for each subject; 'time'- numeric vector stating the time at which each measurement was taken.</p>
</td></tr>
<tr><td><code id="ushr_triphasic_+3A_filter">filter</code></td>
<td>
<p>Logical TRUE/FALSE indicating whether the data should be processed (highly recommended) prior to model fitting. Default is TRUE.</p>
</td></tr>
<tr><td><code id="ushr_triphasic_+3A_detection_threshold">detection_threshold</code></td>
<td>
<p>numeric value indicating the detection threshold of the assay used to measure viral load. Measurements below this value will be assumed to represent undetectable viral levels. Default value is 20.</p>
</td></tr>
<tr><td><code id="ushr_triphasic_+3A_censortime">censortime</code></td>
<td>
<p>numeric value indicating the maximum time point to include in the analysis. Subjects who do not suppress viral load below the detection threshold within this time will be discarded from model fitting. Units are assumed to be same as the 'time' measurements. Default value is 365.</p>
</td></tr>
<tr><td><code id="ushr_triphasic_+3A_censor_value">censor_value</code></td>
<td>
<p>positive numeric value indicating the maximum time point to include in the analysis. Subjects who do not suppress viral load below the detection threshold within this time will be discarded. Units are assumed to be the same as the 'time' column. Default value is 365.</p>
</td></tr>
<tr><td><code id="ushr_triphasic_+3A_decline_buffer">decline_buffer</code></td>
<td>
<p>numeric value indicating the maximum allowable deviation of values away from a strictly decreasing sequence in viral load. This allows for e.g. measurement noise and small fluctuations in viral load. Default value is 500.</p>
</td></tr>
<tr><td><code id="ushr_triphasic_+3A_initial_buffer">initial_buffer</code></td>
<td>
<p>integer value indicating the maximum number of initial observations from which the beginning of each trajectory will be chosen. Default value is 3.</p>
</td></tr>
<tr><td><code id="ushr_triphasic_+3A_threshold_buffer">threshold_buffer</code></td>
<td>
<p>numeric value indicating the range above the detection threshold which represents potential skewing of model fits. Subjects with their last two data points within this range will have the last point removed. Default value is 10.</p>
</td></tr>
<tr><td><code id="ushr_triphasic_+3A_vl_max_decline">VL_max_decline</code></td>
<td>
<p>numeric value indicating the maximum allowable difference between first and second viral load measurements. Default is 10,000.</p>
</td></tr>
<tr><td><code id="ushr_triphasic_+3A_ci_max_diff">CI_max_diff</code></td>
<td>
<p>numeric value indicating the maximum allowable relative difference between lower and upper 95% confidence intervals i.e. (upper CI - lower CI)/lower CI. Default is 1000.</p>
</td></tr>
<tr><td><code id="ushr_triphasic_+3A_n_min_triphasic">n_min_triphasic</code></td>
<td>
<p>numeric value indicating the minimum number of data points required to be included in the analysis. Defaults to 9. It is highly advised not to go below this threshold.</p>
</td></tr>
<tr><td><code id="ushr_triphasic_+3A_nsuppression">nsuppression</code></td>
<td>
<p>numerical value (1 or 2) indicating whether suppression is defined as having one observation below the detection threshold, or two sustained observations. Default value is 1.</p>
</td></tr>
<tr><td><code id="ushr_triphasic_+3A_forward_param_transform_fn">forward_param_transform_fn</code></td>
<td>
<p>list of transformation functions to be used when fitting the model in optim. Defaults to log transformations for all parameters (to allow unconstrained optimization).</p>
</td></tr>
<tr><td><code id="ushr_triphasic_+3A_inv_param_transform_fn">inv_param_transform_fn</code></td>
<td>
<p>list of transformation functions to be used when back-transforming the transformed parameters. Should be the inverse of the forward transformation functions. Defaults to exponential.</p>
</td></tr>
<tr><td><code id="ushr_triphasic_+3A_initial_params">initial_params</code></td>
<td>
<p>named numeric vector of initial parameter guesses. Defaults to c(A = 10000, delta = 1, A_b = 1000, delta_b = 0.15, B = 10, gamma = 0.05).</p>
</td></tr>
<tr><td><code id="ushr_triphasic_+3A_searchmethod">searchmethod</code></td>
<td>
<p>optimization algorithm to be passed to 'optim()'. Defaults to 'Nelder-Mead'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Steps include:
1. Processing the raw data.
2. Fitting the triphasic model to subjects with eligible data e.g. those with enough data points and reliable confidence interval estimates.
</p>


<h3>Value</h3>

<p>a list containing the filtered data ('data_filtered'); parameter estimates for the triphasic model ('triphasicCI'); and predictions from the triphasic model ('triphasic_fits&rdquo;).
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
