<!DOCTYPE html><html><head><title>Help for package denvax</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {denvax}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#build.project'><p>Creates an ROI estimation project.</p></a></li>
<li><a href='#denvax'><p>denvax: Simple Dengue Test and Vaccinate Cost Thresholds</p></a></li>
<li><a href='#lazou2016'><p>The serosurvey data in L'Azou 2016</p></a></li>
<li><a href='#morrison2010'><p>The serosurvey data in Morrison 2010</p></a></li>
<li><a href='#nPxA'><p>Compute the nPx(A), C(A) proportions from a population of life histories</p></a></li>
<li><a href='#ROI'><p>Compute the ROI surfaces given test and vaccine cost fractions.</p></a></li>
<li><a href='#ROIcoeffs'><p>Compute the Return on Investment (ROI) surface coefficients from population probabilities</p></a></li>
<li><a href='#serofit'><p>Model fitting for serological data</p></a></li>
<li><a href='#synthetic.pop'><p>Compute synthetic population trajectories from model parameters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simple Dengue Test and Vaccinate Cost Thresholds</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides the mathematical model described by "Serostatus Testing &amp; Dengue Vaccine Cost-Benefit Thresholds"
    in &lt;<a href="https://doi.org/10.1098%2Frsif.2019.0234">doi:10.1098/rsif.2019.0234</a>&gt;.  Using the functions in the package,
    that analysis can be repeated using sample life histories, either synthesized from local seroprevalence data
    using other functions in this package (as in the manuscript) or from some other source.
    The package provides a vignette which walks through the analysis in the publication, as well as a function
    to generate a project skeleton for such an analysis.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>data.table, testthat, usethis, devtools, roxygen2, jsonlite,
ggplot2, cowplot, directlabels, rmarkdown, knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gitlab.com/cabp_LSHTM/denvax">https://gitlab.com/cabp_LSHTM/denvax</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://gitlab.com/cabp_LSHTM/denvax/issues">https://gitlab.com/cabp_LSHTM/denvax/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-11-30 20:31:28 UTC; carlpearson</td>
</tr>
<tr>
<td>Author:</td>
<td>Carl A. B. Pearson
    <a href="https://orcid.org/0000-0003-0701-7860"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Kaja M. Abbas <a href="https://orcid.org/0000-0003-0563-1576"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Samuel Clifford <a href="https://orcid.org/0000-0002-3774-3882"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Stefan Flasche <a href="https://orcid.org/0000-0002-5808-2606"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Thomas J. Hladish <a href="https://orcid.org/0000-0003-1819-6235"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Carl A. B. Pearson &lt;carl.pearson@lshtm.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-12-01 19:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='build.project'>Creates an ROI estimation project.</h2><span id='topic+build.project'></span>

<h3>Description</h3>

<p>Creates an ROI estimation project.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build.project(targetdir, overwrite = FALSE, copy_pub = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="build.project_+3A_targetdir">targetdir</code></td>
<td>
<p>path to enclosing directory. If this directory does not exist, will attempt to create it (recursively)</p>
</td></tr>
<tr><td><code id="build.project_+3A_overwrite">overwrite</code></td>
<td>
<p>overwrite existing files corresponding to the project skeleton elements?</p>
</td></tr>
<tr><td><code id="build.project_+3A_copy_pub">copy_pub</code></td>
<td>
<p>copy the '/pub' folder (which contains the analyses from the publication)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function sets up the skeleton of an analysis to go from seroprevalence data to the ROI estimation surface.
That skeleton uses a series of separate scripts for each analytical step (fitting, simulation, analysis, and application),
connected via the command line build tool <code>make</code>.  This approach allows clean substitution for various stages (e.g.,
using a different model to generate life histories). The following files are created:
</p>

<dl>
<dt>Makefile</dt><dd><p>the dependencies for various analysis stages</p>
</dd>
<dt>README.md</dt><dd><p>brief notes about project parts</p>
</dd>
<dt>fit.R</dt><dd><p>script for fitting seroprevalence data</p>
</dd>
<dt>synthesize.R</dt><dd><p>script for generating synthetic populations</p>
</dd>
<dt>digest.R</dt><dd><p>script for converting life histories into probability coefficients for ROI calculation</p>
</dd>
<dt>simple.R</dt><dd><p>a quick example start-to-finish analysis</p>
</dd>
</dl>



<h3>Value</h3>

<p>logical, indicating error free creation of the project skeleton; there may still be other warnings
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(denvax)
tardir &lt;- tempdir() # replace with desired target
build.project(tardir)
list.files(tardir, recursive = TRUE)

</code></pre>

<hr>
<h2 id='denvax'>denvax: Simple Dengue Test and Vaccinate Cost Thresholds</h2><span id='topic+denvax'></span><span id='topic+denvax-package'></span>

<h3>Description</h3>

<p>Provides the mathematical model described by &quot;Serostatus Testing &amp; Dengue Vaccine Cost-Benefit Thresholds&quot;
in <a href="https://doi.org/10.1098/rsif.2019.0234">&lt;doi:10.1098/rsif.2019.0234&gt;</a>.  Using the functions in the package,
that analysis can be repeated using sample life histories, either synthesized from local seroprevalence data
using other functions in this package (as in the manuscript) or from some other source.
The package provides a vignette which walks through the analysis in the publication, as well as a function
to generate a project skeleton for such an analysis.
</p>


<h3><code>denvax</code> functions</h3>


<dl>
<dt><code><a href="#topic+serofit">serofit</a></code></dt><dd><p>fits serosurvey data against two-risk model</p>
</dd>
<dt><code><a href="#topic+synthetic.pop">synthetic.pop</a></code></dt><dd><p>using parameter fit data, generate a sample population</p>
</dd>
<dt><code><a href="#topic+nPxA">nPxA</a></code></dt><dd><p>estimate dengue infection outcome probabilities based on a synthetic population</p>
</dd>
<dt><code><a href="#topic+ROIcoeffs">ROIcoeffs</a></code></dt><dd><p>using population outcome probabilities, compute ROI equation coefficients</p>
</dd>
<dt><code><a href="#topic+ROI">ROI</a></code></dt><dd><p>compute ROIs from setting coefficients and cost scenarios</p>
</dd>
<dt><code><a href="#topic+build.project">build.project</a></code></dt><dd><p>create a template project for estimating ROIs</p>
</dd>
</dl>


<hr>
<h2 id='lazou2016'>The serosurvey data in L'Azou 2016</h2><span id='topic+lazou2016'></span>

<h3>Description</h3>

<p>From &quot;Symptomatic Dengue in Children in 10 Asian and Latin American Countries&quot;, Table 4.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lazou2016
</code></pre>


<h3>Format</h3>

<p>a data.frame (data.table, if installed) with 20 rows and 4 columns:
</p>

<dl>
<dt>Country</dt><dd><p>character, common country name (all Peru for this data)</p>
</dd>
<dt>Age</dt><dd><p>character, the bounding ages for the sample; format: lower age '-' upper age</p>
</dd>
<dt>Number</dt><dd><p>integer, the number of samples</p>
</dd>
<dt>Seropositive</dt><dd><p>integer, the number of seropositive samples</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.1056/NEJMoa1503877">https://doi.org/10.1056/NEJMoa1503877</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(denvax); require(ggplot2)
data(lazou2016)
ggplot(lazou2016) + aes(Age, Seropositive/Number*100, color = Country) +
  geom_point() + labs(y="Seropositive %", x="Age Group") + lims(y=c(0,100)) +
  theme_minimal()
</code></pre>

<hr>
<h2 id='morrison2010'>The serosurvey data in Morrison 2010</h2><span id='topic+morrison2010'></span>

<h3>Description</h3>

<p>From &quot;Epidemiology of Dengue Virus in Iquitos, Peru 1999 to 2005: Interepidemic and Epidemic Patterns of Transmission&quot;,
combining information from Fig. 2 and Fig. 3.  The data from Fig. 3 were extracted using <a href="https://automeris.io/WebPlotDigitizer/">https://automeris.io/WebPlotDigitizer/</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morrison2010
</code></pre>


<h3>Format</h3>

<p>a data.frame (data.table, if installed) with 13 rows and 4 columns:
</p>

<dl>
<dt>Country</dt><dd><p>character, common country name (all Peru for this data)</p>
</dd>
<dt>Age</dt><dd><p>integer, the age category</p>
</dd>
<dt>Number</dt><dd><p>integer, the number of samples</p>
</dd>
<dt>Seropositive</dt><dd><p>integer, the number of seropositive samples</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.1371/journal.pntd.0000670">https://doi.org/10.1371/journal.pntd.0000670</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(denvax)
data(morrison2010)
with(morrison2010, plot(Age, Seropositive/Number*100, ylab="% Seropositive", ylim=c(0,100)))
</code></pre>

<hr>
<h2 id='nPxA'>Compute the nPx(A), C(A) proportions from a population of life histories</h2><span id='topic+nPxA'></span>

<h3>Description</h3>

<p>Compute the nPx(A), C(A) proportions from a population of life histories
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nPxA(lifehistory)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nPxA_+3A_lifehistory">lifehistory</code></td>
<td>
<p>a matrix with rows (sample individuals) and columns (outcome in year of life); see <a href="#topic+synthetic.pop">synthetic.pop</a> return value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>computes the relevant nPx(A) and C(A): the probabilities of the various life trajectories, by age.
See <a href="https://doi.org/10.1098/rsif.2019.0234">&lt;doi:10.1098/rsif.2019.0234&gt;</a>, SI section II.A (Cost Benefit Equations: Definitions)
</p>


<h3>Value</h3>

<p>a <code><a href="base.html#topic+data.frame">data.frame</a></code> (<code><a href="data.table.html#topic+data.table">data.table</a></code>, if available) with columns
</p>

<dl>
<dt>A</dt><dd><p>integer; the reference year of life, from 1 to <code>dim(lifehistory)[2]</code></p>
</dd>
<dt>p_0</dt><dd><p>numeric; probability of 0 lifetime infections</p>
</dd>
<dt>p_1p</dt><dd><p>numeric; probability of 1 or more lifetime infections</p>
</dd>
<dt>p_2p</dt><dd><p>numeric; probability of 2 or more lifetime infections</p>
</dd>
<dt>p0_1</dt><dd><p>numeric; probability of 0 infections at age A, and 1 lifetime infection</p>
</dd>
<dt>p0_1p</dt><dd><p>numeric; probability of 0 infections at age A, and 1 or more lifetime infections</p>
</dd>
<dt>p0_2p</dt><dd><p>numeric; probability of 0 infections at age A, and 2 or more lifetime infections</p>
</dd>
<dt>p1_A</dt><dd><p>numeric; probability of 1 infection at age A, and 1 or more lifetime infections</p>
</dd>
<dt>p1_2p</dt><dd><p>numeric; probability of 1 infection at age A, and 2 or more lifetime infections</p>
</dd>
<dt>p1p_A</dt><dd><p>numeric; probability of 1 or more infections at age A, and 1 or more lifetime infections</p>
</dd>
<dt>p2p_A</dt><dd><p>numeric; probability of 2 or more infections at age A, and 2 or more lifetime infections</p>
</dd>
<dt>CA</dt><dd><p>numeric; probability of converting from seronegative to seropositive between age A and A+1</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>require(denvax);
data(morrison2010) # has counts by age
fit &lt;- with(morrison2010, serofit(sero=Seropositive, N=Number, age.min=Age))
m2010pop &lt;- synthetic.pop(fit, runs = 10, popsize = 10) # small sample size for example run time
m2010lh &lt;- nPxA(m2010pop)
m2010lh
with(m2010lh,
  plot(A, p0_2p*100, type="l",
    xlab="Age", ylab="%", ylim = c(0, 100),
    main="Individuals w/ No Infections,\nbut that will have 2"
  )
)

</code></pre>

<hr>
<h2 id='ROI'>Compute the ROI surfaces given test and vaccine cost fractions.</h2><span id='topic+ROI'></span>

<h3>Description</h3>

<p>Compute the ROI surfaces given test and vaccine cost fractions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ROI(rcoeffs, nus = seq(0.3, 0.9, by = 0.05), taus = 10^seq(-2, -0.5, by
  = 0.05))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ROI_+3A_rcoeffs">rcoeffs</code></td>
<td>
<p>a data.frame with the ROI surface coefficients from <a href="#topic+ROIcoeffs">ROIcoeffs</a></p>
</td></tr>
<tr><td><code id="ROI_+3A_nus">nus</code></td>
<td>
<p>the series of normalized vaccine costs to use for ROI calcs</p>
</td></tr>
<tr><td><code id="ROI_+3A_taus">taus</code></td>
<td>
<p>the series of normalized test costs to use for ROI calcs</p>
</td></tr>
</table>


<h3>Details</h3>

<p>tabulates ROI
</p>


<h3>Value</h3>

<p>a 'data.frame' ('data.table', if available) with columns:
</p>

<dl>
<dt>nu</dt><dd><p>numeric, the normalized vaccine cost used</p>
</dd>
<dt>tau</dt><dd><p>numeric, the normalized test cost used</p>
</dd>
<dt>mechanism</dt><dd><p>character, either &quot;ordinal&quot; or &quot;binary&quot; corresponding to the type of test</p>
</dd>
<dt>A</dt><dd><p>integer; the age when routine test-then-vaccinate strategy starts (from <code>As</code>)</p>
</dd>
<dt>L</dt><dd><p>integer; the maximum number of tests for routine test-then-vaccinate strategy (from <code>Ls</code>)</p>
</dd>
<dt>cost</dt><dd><p>numeric; the intervention cost (as a fraction of second infection cost)</p>
</dd>
<dt>benefit</dt><dd>
<p>numeric; the difference in health outcome cost (as a fraction of second infection cost) minus 'cost';
positive values indicate positive net benefit
</p>
</dd>
<dt>roi</dt><dd><p>numeric; return on investment: 'benefit' over 'cost'</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>require(denvax);
data(morrison2010) # has counts by age
fit &lt;- with(morrison2010, serofit(sero=Seropositive, N=Number, age.min=Age))
m2010pop &lt;- synthetic.pop(fit, runs = 10, popsize = 10) # small sample size for example run time
m2010lh &lt;- nPxA(m2010pop)
L &lt;- 5
rc &lt;- ROIcoeffs(m2010lh, As=5:10, Ls=L)
rois &lt;- ROI(rc, nus = 0.5, taus = 0.01)
srois &lt;- subset(rois, mechanism == "binary")
mrois &lt;- matrix(srois$roi, nrow = L)
contour(x=unique(srois$L), y=unique(srois$A), z=mrois,
  xlab = "Max # of Tests", ylab = "Initial Age", main="ROI Contour"
)

</code></pre>

<hr>
<h2 id='ROIcoeffs'>Compute the Return on Investment (ROI) surface coefficients from population probabilities</h2><span id='topic+ROIcoeffs'></span>

<h3>Description</h3>

<p>Compute the Return on Investment (ROI) surface coefficients from population probabilities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ROIcoeffs(probabilities, As = 5:20, Ls = (diff(range(As)) + 1):1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ROIcoeffs_+3A_probabilities">probabilities</code></td>
<td>
<p>a <code><a href="base.html#topic+data.frame">data.frame</a></code> (or <code><a href="data.table.html#topic+data.table">data.table</a></code>) with the probabilities resulting from <a href="#topic+nPxA">nPxA</a>. Rows must correspond to ages, starting with age 1</p>
</td></tr>
<tr><td><code id="ROIcoeffs_+3A_as">As</code></td>
<td>
<p>the starting age(s) to consider</p>
</td></tr>
<tr><td><code id="ROIcoeffs_+3A_ls">Ls</code></td>
<td>
<p>the maximum number of tests for each age; should either be an integer per age or a single integer for all ages.
The default behavior computes the number of tests (for each age) that makes the maximum of 'As' the maximum testing age
Note: results will also be provided for shorter testing intervals, as the intermediate coefficients are calculated as part
of computing the value at the maximum <code>L</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>computes the coefficients for the economic calculations
</p>


<h3>Value</h3>

<p>a <code><a href="base.html#topic+data.frame">data.frame</a></code> (<code><a href="data.table.html#topic+data.table">data.table</a></code>, if available) with columns:
</p>

<dl>
<dt>A</dt><dd><p>integer; the age when routine test-then-vaccinate strategy starts (from <code>As</code>)</p>
</dd>
<dt>L</dt><dd><p>integer; the maximum number of tests for routine test-then-vaccinate strategy (from <code>Ls</code>)</p>
</dd>
<dt>vacfrac</dt><dd><p>numeric; the fraction of individuals participating in this strategy that get vaccinated</p>
</dd>
<dt>pri.offset</dt><dd><p>numeric; the (additive) reduction in <code>vacfrac</code> if using the ordinal test</p>
</dd>
<dt>Sfrac</dt><dd><p>numeric; the proportion experiencing second infection costs</p>
</dd>
<dt>Fresp</dt><dd><p>numeric; the F/S cost fraction term, when comparing vaccination with and without testing</p>
</dd>
<dt>Sgain</dt><dd><p>numeric; the S term, when comparing vaccination with and without testing</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>require(denvax);
data(morrison2010) # has counts by age
fit &lt;- with(morrison2010, serofit(sero=Seropositive, N=Number, age.min=Age))
m2010pop &lt;- synthetic.pop(fit, runs = 10, popsize = 10) # small sample size for example run time
m2010lh &lt;- nPxA(m2010pop)
rc &lt;- ROIcoeffs(m2010lh, As=5:10, Ls=5)
pp &lt;- par()
par(mfrow=c(1, 2))
rcs &lt;- subset(rc, A==10 &amp; L &lt; 11)
with(rcs, plot(
  L, aveTests, type="l",
  xlab="Max # of Tests Allowed",
  ylab="Ave # of Tests Administered",
  main="Starting @ Age 10",
  ylim=c(1, 3)
))
rcs &lt;- subset(rc, A==5 &amp; L &lt; 11)
with(rcs, plot(
  L, aveTests, type="l",
  xlab="Max # of Tests Allowed",
  ylab="",
  main="Starting @ Age 5",
  ylim=c(1, 3)
))
par(pp)

</code></pre>

<hr>
<h2 id='serofit'>Model fitting for serological data</h2><span id='topic+serofit'></span>

<h3>Description</h3>

<p>Model fitting for serological data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>serofit(seropositive, N, age.min = use.default(1L:length(seropositive),
  "age.min"), age.max = use.default(age.min, "age.max"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="serofit_+3A_seropositive">seropositive</code></td>
<td>
<p>the number of seropositive samples for each age group; length(seropositive) must be at least 3</p>
</td></tr>
<tr><td><code id="serofit_+3A_n">N</code></td>
<td>
<p>the total number of samples for each age group; length(N) must equal length(seropositive)</p>
</td></tr>
<tr><td><code id="serofit_+3A_age.min">age.min</code></td>
<td>
<p>the low age in age groups; defaults to '1:length(seropositive)', i.e. assumes
the seropositive data corresponds to yearly cohorts starting at age 1.</p>
</td></tr>
<tr><td><code id="serofit_+3A_age.max">age.max</code></td>
<td>
<p>the upper age in age groups; defaults to 'age.min', i.e. assumes each category corresponds
to a single year</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fits a constant force of infection, two-risk category model using
seroprevalence survey data. i.e.:
</p>
<p>$$
P_+(A) = p_H * (1-(1-f_H)^A) + (1-p_H) * (1-(1-f_L)^A)
$$
</p>
<p>This probability is fit to the seroprevalence by age category data,
using maximum likelihood and <code><a href="stats.html#topic+optim">optim</a></code>.
</p>


<h3>Value</h3>

<p>a list of best-fit parameters, all numeric values:
</p>

<dl>
<dt>f_H</dt><dd><p>force of infection, for the high risk group</p>
</dd>
<dt>f_L</dt><dd><p>force of infection, for the low risk group</p>
</dd>
<dt>p_H</dt><dd><p>the proportion of the population at high risk</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>require(denvax);
data(morrison2010) # has counts by age
fit &lt;- with(morrison2010, serofit(sero=Seropositive, N=Number, age.min=Age))
if (requireNamespace("data.table", quietly = TRUE)) {
data(lazou2016) # has counts by age range, instead of counts for every year
# this example uses `data.table`` functions to simplify processing
# several groups at once
  lazou2016[,{
    agerange &lt;- data.table::tstrsplit(Age, "-")
    serofit(
      sero     = Seropositive,
      N        = Number,
      age.min  = as.integer(agerange[[1]]),
      age.max  = as.integer(agerange[[2]])
    )
  }, by = Country]
}
</code></pre>

<hr>
<h2 id='synthetic.pop'>Compute synthetic population trajectories from model parameters</h2><span id='topic+synthetic.pop'></span>

<h3>Description</h3>

<p>Compute synthetic population trajectories from model parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>synthetic.pop(pars, runs = 100, popsize = 1000, maxAge = 70,
  rngseed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="synthetic.pop_+3A_pars">pars</code></td>
<td>
<p>a list with elements 'f_H', 'f_L', and 'p_H'; see <a href="#topic+serofit">serofit</a> return value</p>
</td></tr>
<tr><td><code id="synthetic.pop_+3A_runs">runs</code></td>
<td>
<p>the number of different serotype timelines to simulate</p>
</td></tr>
<tr><td><code id="synthetic.pop_+3A_popsize">popsize</code></td>
<td>
<p>the number of individuals to sample for each run</p>
</td></tr>
<tr><td><code id="synthetic.pop_+3A_maxage">maxAge</code></td>
<td>
<p>the length of each lifetime</p>
</td></tr>
<tr><td><code id="synthetic.pop_+3A_rngseed">rngseed</code></td>
<td>
<p>an optional seed for the random number generator</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using fitted parameters for a two-risk, constant force of infection model,
simulate a dengue annual exposures model for the requested number of serotype series ('runs')
and individuals ('popsize').  The resulting matrix is a collection of integers, 0-4.
0 indicates no infection, 1-4 infection by the corresponding serotype.
</p>


<h3>Value</h3>

<p>a matrix of integers 0-4, rows 'runs*popsize' x columns 'maxAge'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(denvax);
data(morrison2010) # has counts by age
fit &lt;- with(morrison2010, serofit(sero=Seropositive, N=Number, age.min=Age))
m2010pop &lt;- synthetic.pop(fit, runs = 10, popsize = 10) # small sample size for example run time
head(m2010pop)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
