<!DOCTYPE html><html><head><title>Help for package SOHPIE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SOHPIE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#asso_mat'><p>asso_mat</p></a></li>
<li><a href='#coeff'><p>coeff</p></a></li>
<li><a href='#coeff_specific_var'><p>coeff_specific_var</p></a></li>
<li><a href='#combinedamgut'><p>A Subdata from the American Gut Project study data</p></a></li>
<li><a href='#combineddietswap'><p>A Subdata from the Diet Swap study data</p></a></li>
<li><a href='#DCtaxa_tab'><p>DCtaxa_tab</p></a></li>
<li><a href='#pseudoreg'><p>pseudoreg</p></a></li>
<li><a href='#pseudoreg.summary'><p>pseudoreg.summary()</p></a></li>
<li><a href='#pval'><p>pval</p></a></li>
<li><a href='#pval_specific_var'><p>pval_specific_var</p></a></li>
<li><a href='#qval'><p>qval</p></a></li>
<li><a href='#qval_specific_var'><p>qval_specific_var</p></a></li>
<li><a href='#SOHPIE_DNA'><p>SOHPIE_DNA</p></a></li>
<li><a href='#sparcc'><p>sparcc wrapper</p></a></li>
<li><a href='#stderrs'><p>stderrs</p></a></li>
<li><a href='#stderrs_specific_var'><p>stderrs_specific_var</p></a></li>
<li><a href='#thetahats'><p>thetahats</p></a></li>
<li><a href='#thetatildefun'><p>thetatildefun</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Approach via Pseudo-Value Information and Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.6</td>
</tr>
<tr>
<td>Description:</td>
<td>'SOHPIE' (pronounced as SOFIE) is a novel pseudo-value regression approach for differential co-abundance network analysis of microbiome data, which can include additional clinical covariate in the model. The full methodological details can be found in Ahn S and Datta S (2023) &lt;<a href="https://arxiv.org/abs/2303.13702v1">arXiv:2303.13702v1</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>robustbase, parallel, dplyr, fdrtool, gtools, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-23 17:20:16 UTC; seungjunahn</td>
</tr>
<tr>
<td>Author:</td>
<td>Seungjun Ahn <a href="https://orcid.org/0000-0002-4816-8924"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut, trl],
  Somnath Datta [ctb, ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Seungjun Ahn &lt;seungjun.ahn@mountsinai.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-23 17:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='asso_mat'>asso_mat</h2><span id='topic+asso_mat'></span>

<h3>Description</h3>

<p>A function to estimate an association matrix. 
This function also includes re-estimation for leave-one-out sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>asso_mat(OTUdat, group)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="asso_mat_+3A_otudat">OTUdat</code></td>
<td>
<p>An OTU table with subjects in rows and taxa in columns.</p>
</td></tr>
<tr><td><code id="asso_mat_+3A_group">group</code></td>
<td>
<p>Indices of the subjects in a category of binary group variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of an association matrix and reestimated association matrix
is returned, which are estimated via SparCC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# In this example, the subset of the American Gut Project data will be used.
data(combinedamgut) # A complete data containing columns with taxa and clinical covariates.

# Note: The line below will use a toy example with the first 30 out of 138 taxa.
OTUtab = combinedamgut[ , 8:37]

# Obtain indices of each grouping factor
# In this example, a variable indicating the status of living
# with a dog was chosen (i.e. bin_dog).
# Accordingly, Groups A and B imply living without and with a dog, respectively.
newindex_grpA = which(combinedamgut$bin_dog == 0)
newindex_grpB = which(combinedamgut$bin_dog == 1)

# Now, we estimate (and re-estimate) association matrices 
# for each group separately.
asso_matA = asso_mat(OTUdat=OTUtab, group=newindex_grpA) 
asso_matB = asso_mat(OTUdat=OTUtab, group=newindex_grpB) 


</code></pre>

<hr>
<h2 id='coeff'>coeff</h2><span id='topic+coeff'></span>

<h3>Description</h3>

<p>A function to retrieve a vector of coefficient estimates
of all predictor variables in the pseudo-value regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coeff(SOHPIEres)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coeff_+3A_sohpieres">SOHPIEres</code></td>
<td>
<p>An object called after running SOHPIE_DNA.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table that includes coefficient estimates for all variables included in the fitted model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(combinedamgut) # A complete data containing columns with taxa and clinical covariates.

# Note: The line below will use a toy example with the first 30 out of 138 taxa.
OTUtab = combinedamgut[ , 8:37]
# Clinical/demographic covariates (phenotypic data):
# Note: All of these covariates will be included in the regression, so
# please make sure that phenodat includes the variables that will be analyzed only.
phenodat = combinedamgut[, 1:7] # first column is ID, so not using it.
# Obtain indices of each grouping factor
# In this example, a variable indicating the status of living with a dog was chosen (i.e. bin_dog).
# Accordingly, Groups A and B imply living without and with a dog, respectively.
 newindex_grpA = which(combinedamgut$bin_dog == 0)
 newindex_grpB = which(combinedamgut$bin_dog == 1)

SOHPIEres &lt;- SOHPIE_DNA(OTUdat = OTUtab, clindat = phenodat,
groupA = newindex_grpA, groupB = newindex_grpB, c = 0.5)

# coeff() function will return coefficient estimates only.
coeff(SOHPIEres)

</code></pre>

<hr>
<h2 id='coeff_specific_var'>coeff_specific_var</h2><span id='topic+coeff_specific_var'></span>

<h3>Description</h3>

<p>A function to retrieve a vector of coefficient estimates of each taxa
for one specific variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coeff_specific_var(coefftab, varname)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coeff_specific_var_+3A_coefftab">coefftab</code></td>
<td>
<p>A table that includes coefficient estimates for a specific variable.</p>
</td></tr>
<tr><td><code id="coeff_specific_var_+3A_varname">varname</code></td>
<td>
<p>Specify the name of the variable of interest.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of coefficient estimates for a single variable from the model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(combinedamgut) # A complete data containing columns with taxa and clinical covariates.

# Note: The line below will use a toy example with the first 30 out of 138 taxa.
OTUtab = combinedamgut[ , 8:37]
# Clinical/demographic covariates (phenotypic data):
# Note: All of these covariates will be included in the regression, so
# please make sure that phenodat includes the variables that will be analyzed only.
phenodat = combinedamgut[, 1:7] # first column is ID, so not using it.
# Obtain indices of each grouping factor
# In this example, a variable indicating the status of living with a dog was chosen (i.e. bin_dog).
# Accordingly, Groups A and B imply living without and with a dog, respectively.
 newindex_grpA = which(combinedamgut$bin_dog == 0)
 newindex_grpB = which(combinedamgut$bin_dog == 1)

SOHPIEres &lt;- SOHPIE_DNA(OTUdat = OTUtab, clindat = phenodat,
groupA = newindex_grpA, groupB = newindex_grpB, c = 0.5)

# coeff() function will return coefficient estimates only.
coefftab &lt;- coeff(SOHPIEres)

# coeff_specific_var() will return coefficient estimates of
# a single variable of interest.
coeff_specific_var(coefftab = coefftab, varname = "bin_dog")

</code></pre>

<hr>
<h2 id='combinedamgut'>A Subdata from the American Gut Project study data</h2><span id='topic+combinedamgut'></span>

<h3>Description</h3>

<p>A pre-processed OTU table and clinical data were obtained from the American
Gut Project, available in the SpiecEasi R package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(combinedamgut)
</code></pre>


<h3>Format</h3>

<p>combinedamgut
</p>


<h3>References</h3>

<p>McDonald D, et al. American Gut: an Open Platform for Citizen Science Microbiome Research. mSystems, 2018;3(3):e00031-18.
(<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5954204/">PubMed</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(combinedamgut)
</code></pre>

<hr>
<h2 id='combineddietswap'>A Subdata from the Diet Swap study data</h2><span id='topic+combineddietswap'></span>

<h3>Description</h3>

<p>A pre-processed OTU table and clinical data from the geographical epidemiology study
(aka the Diet Exchange Study) is available in the microbiome R package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(combineddietswap)
</code></pre>


<h3>Format</h3>

<p>'combineddietswap'
</p>


<h3>References</h3>

<p>O'Keefe, SJ, et al. Fat, fibre and cancer risk in african americans and
rural africans. Nat Commun. 2015;6:6342.
(<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4415091/">PubMed</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(combineddietswap)
</code></pre>

<hr>
<h2 id='DCtaxa_tab'>DCtaxa_tab</h2><span id='topic+DCtaxa_tab'></span>

<h3>Description</h3>

<p>A function to obtain a list consisting of taxa that are significantly differentially connected (DC)
between two biological or clinical conditions. These DC taxa are resulted from the pseudo-value regression method with
additional covariates. In addition, a user can extract the names of DC taxa only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DCtaxa_tab(qvaltab, groupvar, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DCtaxa_tab_+3A_qvaltab">qvaltab</code></td>
<td>
<p>A table with adjusted p-values (or q-value in this package).</p>
</td></tr>
<tr><td><code id="DCtaxa_tab_+3A_groupvar">groupvar</code></td>
<td>
<p>Specify the name of binary indicator variable.</p>
</td></tr>
<tr><td><code id="DCtaxa_tab_+3A_alpha">alpha</code></td>
<td>
<p>A level of significance (e.g. 0.05).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>q-values and names of significantly DC taxa (e.g. taxa name) based on SOHPIE_DNA function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(combinedamgut) # A complete data containing columns with taxa and clinical covariates.

# Note: The line below will use a toy example with the first 30 out of 138 taxa.
OTUtab = combinedamgut[ , 8:37]
# Clinical/demographic covariates (phenotypic data):
# Note: All of these covariates will be included in the regression, so
# please make sure that phenodat includes the variables that will be analyzed only.
phenodat = combinedamgut[, 1:7] # first column is ID, so not using it.
# Obtain indices of each grouping factor
# In this example, a variable indicating the status of living with a dog was chosen (i.e. bin_dog).
# Accordingly, Groups A and B imply living without and with a dog, respectively.
 newindex_grpA = which(combinedamgut$bin_dog == 0)
 newindex_grpB = which(combinedamgut$bin_dog == 1)

SOHPIEres &lt;- SOHPIE_DNA(OTUdat = OTUtab, clindat = phenodat,
groupA = newindex_grpA, groupB = newindex_grpB, c = 0.5)

# Create an object to keep the table with q-values using qval() function.
qvaltab &lt;- qval(SOHPIEres)

# Please do NOT forget to provide the name of variable in DCtaxa_tab(groupvar = ).
DCtaxa_tab &lt;- DCtaxa_tab(qvaltab = qvaltab, groupvar = "bin_dog", alpha = 0.3)
DCtaxa_tab

</code></pre>

<hr>
<h2 id='pseudoreg'>pseudoreg</h2><span id='topic+pseudoreg'></span>

<h3>Description</h3>

<p>A function to regress pseudo-values across set of covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseudoreg(pseudoval, clindat, c)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pseudoreg_+3A_pseudoval">pseudoval</code></td>
<td>
<p>Jackknife pseudo-values calculated.</p>
</td></tr>
<tr><td><code id="pseudoreg_+3A_clindat">clindat</code></td>
<td>
<p>A metadata/phenotypic data consisting of the clinical
and demographic variables that the user wants to include
in the regression. (e.g., binary group indicator for
intervention vs. control, continuous age, ...)</p>
</td></tr>
<tr><td><code id="pseudoreg_+3A_c">c</code></td>
<td>
<p>The choice of trimming proportion for the least trimmed estimator of robust regression.
A value has to be between 0.5 and 1 as specified in ltsReg() function in robustbase package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A pseudo-value regression is fitted. Please use pseudoreg.summary()
to output p-values, q-values, and coefficient estimates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# In this example, the subset of the American Gut Project data will be used.
data(combinedamgut) # A complete data containing columns with taxa and clinical covariates.

# Note: The line below will use a toy example with the first 30 out of 138 taxa.
OTUtab = combinedamgut[ , 8:37]

#Clinical/demographic covariates (phenotypic data):
# Note: All of these covariates will be included in the regression, so
# please make sure that phenodat includes the variables that will be analyzed only.
phenodat = combinedamgut[, 1:7] # first column is ID, so not using it.

# Obtain indices of each grouping factor
# In this example, a variable indicating the status of living
# with a dog was chosen (i.e. bin_dog).
# Accordingly, Groups A and B imply living without and with a dog, respectively.
newindex_grpA = which(combinedamgut$bin_dog == 0)
newindex_grpB = which(combinedamgut$bin_dog == 1)

# Now, we estimate (and re-estimate) association matrices
# for each group separately.
asso_matA = asso_mat(OTUdat=OTUtab, group=newindex_grpA)
asso_matB = asso_mat(OTUdat=OTUtab, group=newindex_grpB)

# Calculate the network centrality.
thetahat_grpA = thetahats(asso_matA$assomat)
thetahat_grpB = thetahats(asso_matB$assomat)

# Obtain network centrality for the re-estimated association matrices.
thetahat_drop_grpA = sapply(asso_matA$reest.assomat, thetahats)
thetahat_drop_grpB = sapply(asso_matB$reest.assomat, thetahats)

# Sample sizes for each group.
n_A &lt;- length(newindex_grpA)
n_B &lt;- length(newindex_grpB)

# Now calculate jackknife pseudo-values for each group.
thetatilde_grpA = thetatildefun(thetahat_grpA, thetahat_drop_grpA, n_A)
thetatilde_grpB = thetatildefun(thetahat_grpB, thetahat_drop_grpB, n_B)

thetatilde = rbind(thetatilde_grpA, thetatilde_grpB)

# Map the column names (taxa names)
colnames(thetatilde) = colnames(OTUtab)

# Fit a pseudo-value regression using jackknife pseudovalues
# and phenotypic data. A reminder that the phenotypic data should
# contain a set of predictor variables to be fitted.
fitmod = pseudoreg(pseudoval=thetatilde, clindat=phenodat, c=0.5)

</code></pre>

<hr>
<h2 id='pseudoreg.summary'>pseudoreg.summary()</h2><span id='topic+pseudoreg.summary'></span>

<h3>Description</h3>

<p>A function to output summary results
(p-values, q-values, and coefficient estimates)
from the fitted pseudo-value regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseudoreg.summary(pseudo.reg.res, taxanames)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pseudoreg.summary_+3A_pseudo.reg.res">pseudo.reg.res</code></td>
<td>
<p>A fitted pseudo-value regression using pseudoreg()</p>
</td></tr>
<tr><td><code id="pseudoreg.summary_+3A_taxanames">taxanames</code></td>
<td>
<p>Names of taxa from the OTU table.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A pseudo-value regression is fitted. Please use pseudoreg.summary()
to output p-values, q-values, and coefficient estimates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# In this example, the subset of the American Gut Project data will be used.
data(combinedamgut) # A complete data containing columns with taxa and clinical covariates.

# Note: The line below will use a toy example with the first 30 out of 138 taxa.
OTUtab = combinedamgut[ , 8:37]

#Clinical/demographic covariates (phenotypic data):
# Note: All of these covariates will be included in the regression, so
# please make sure that phenodat includes the variables that will be analyzed only.
phenodat = combinedamgut[, 1:7] # first column is ID, so not using it.

# Obtain indices of each grouping factor
# In this example, a variable indicating the status of living
# with a dog was chosen (i.e. bin_dog).
# Accordingly, Groups A and B imply living without and with a dog, respectively.
newindex_grpA = which(combinedamgut$bin_dog == 0)
newindex_grpB = which(combinedamgut$bin_dog == 1)

# Now, we estimate (and re-estimate) association matrices
# for each group separately.
asso_matA = asso_mat(OTUdat=OTUtab, group=newindex_grpA)
asso_matB = asso_mat(OTUdat=OTUtab, group=newindex_grpB)

# Calculate the network centrality.
thetahat_grpA = thetahats(asso_matA$assomat)
thetahat_grpB = thetahats(asso_matB$assomat)

# Obtain network centrality for the re-estimated association matrices.
thetahat_drop_grpA = sapply(asso_matA$reest.assomat, thetahats)
thetahat_drop_grpB = sapply(asso_matB$reest.assomat, thetahats)

# Sample sizes for each group.
n_A &lt;- length(newindex_grpA)
n_B &lt;- length(newindex_grpB)

# Now calculate jackknife pseudo-values for each group.
thetatilde_grpA = thetatildefun(thetahat_grpA, thetahat_drop_grpA, n_A)
thetatilde_grpB = thetatildefun(thetahat_grpB, thetahat_drop_grpB, n_B)

thetatilde = rbind(thetatilde_grpA, thetatilde_grpB)

# Map the column names (taxa names)
colnames(thetatilde) = colnames(OTUtab)

# Fit a pseudo-value regression using jackknife pseudovalues
# and phenotypic data. A reminder that the phenotypic data should
# contain a set of predictor variables to be fitted.
fitmod = pseudoreg(pseudoval=thetatilde, clindat=phenodat, c=0.5)

# Extract summary results from the fitted model from fitmod object above.
summary.result = pseudoreg.summary(pseudo.reg.res=fitmod, taxanames=colnames(OTUtab))

</code></pre>

<hr>
<h2 id='pval'>pval</h2><span id='topic+pval'></span>

<h3>Description</h3>

<p>A function to retrieve a vector of p-values of each taxa
for all variables that are included in the pseudo-value regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pval(SOHPIEres)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pval_+3A_sohpieres">SOHPIEres</code></td>
<td>
<p>An object called after running SOHPIE_DNA.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table that includes p-values for all predictor variables considered in the regresson.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(combinedamgut) # A complete data containing columns with taxa and clinical covariates.

# Note: The line below will use a toy example with the first 30 out of 138 taxa.
OTUtab = combinedamgut[ , 8:37]
# Clinical/demographic covariates (phenotypic data):
# Note: All of these covariates will be included in the regression, so
# please make sure that phenodat includes the variables that will be analyzed only.
phenodat = combinedamgut[, 1:7] # first column is ID, so not using it.
# Obtain indices of each grouping factor
# In this example, a variable indicating the status of living with a dog was chosen (i.e. bin_dog).
# Accordingly, Groups A and B imply living without and with a dog, respectively.
 newindex_grpA = which(combinedamgut$bin_dog == 0)
 newindex_grpB = which(combinedamgut$bin_dog == 1)

SOHPIEres &lt;- SOHPIE_DNA(OTUdat = OTUtab, clindat = phenodat,
groupA = newindex_grpA, groupB = newindex_grpB, c = 0.5)

# Create an object to keep the table with p-values using qval() function.
pvaltab &lt;- pval(SOHPIEres)

</code></pre>

<hr>
<h2 id='pval_specific_var'>pval_specific_var</h2><span id='topic+pval_specific_var'></span>

<h3>Description</h3>

<p>A function to retrieve a vector of p-values of each taxa
for one specific variable. In other words, this will be useful for
quickly accessing the taxa-specific p-values for main binary group variable
(or other specific variable/covariate).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pval_specific_var(pvaltab, varname)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pval_specific_var_+3A_pvaltab">pvaltab</code></td>
<td>
<p>A table that includes p-values for a specific variable.</p>
</td></tr>
<tr><td><code id="pval_specific_var_+3A_varname">varname</code></td>
<td>
<p>Specify the name of the variable of interest.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of p-values for a single variable from the model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(combinedamgut) # A complete data containing columns with taxa and clinical covariates.

# Note: The line below will use a toy example with the first 30 out of 138 taxa.
OTUtab = combinedamgut[ , 8:37]
# Clinical/demographic covariates (phenotypic data):
# Note: All of these covariates will be included in the regression, so
# please make sure that phenodat includes the variables that will be analyzed only.
phenodat = combinedamgut[, 1:7] # first column is ID, so not using it.
# Obtain indices of each grouping factor
# In this example, a variable indicating the status of living with a dog was chosen (i.e. bin_dog).
# Accordingly, Groups A and B imply living without and with a dog, respectively.
 newindex_grpA = which(combinedamgut$bin_dog == 0)
 newindex_grpB = which(combinedamgut$bin_dog == 1)

SOHPIEres &lt;- SOHPIE_DNA(OTUdat = OTUtab, clindat = phenodat,
groupA = newindex_grpA, groupB = newindex_grpB, c = 0.5)

# Create an object to keep the table with p-values using pval() function.
pvaltab &lt;- pval(SOHPIEres)

# Retrieve a vector of p-values for a single variable of interest.
pval_specific_var(pvaltab = pvaltab, varname = "bin_dog")

</code></pre>

<hr>
<h2 id='qval'>qval</h2><span id='topic+qval'></span>

<h3>Description</h3>

<p>A function to retrieve a vector of q-values of each taxa
for all variables that are included in the pseudo-value regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qval(SOHPIEres)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qval_+3A_sohpieres">SOHPIEres</code></td>
<td>
<p>An object called after running SOHPIE_DNA.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table that includes q-values for all predictor variables considered in the regresson.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(combinedamgut) # A complete data containing columns with taxa and clinical covariates.

# Note: The line below will use a toy example with the first 30 out of 138 taxa.
OTUtab = combinedamgut[ , 8:37]
# Clinical/demographic covariates (phenotypic data):
# Note: All of these covariates will be included in the regression, so
# please make sure that phenodat includes the variables that will be analyzed only.
phenodat = combinedamgut[, 1:7] # first column is ID, so not using it.
# Obtain indices of each grouping factor
# In this example, a variable indicating the status of living with a dog was chosen (i.e. bin_dog).
# Accordingly, Groups A and B imply living without and with a dog, respectively.
 newindex_grpA = which(combinedamgut$bin_dog == 0)
 newindex_grpB = which(combinedamgut$bin_dog == 1)

SOHPIEres &lt;- SOHPIE_DNA(OTUdat = OTUtab, clindat = phenodat,
groupA = newindex_grpA, groupB = newindex_grpB, c = 0.5)

# Create an object to keep the table with q-values using qval() function.
qvaltab &lt;- qval(SOHPIEres)

</code></pre>

<hr>
<h2 id='qval_specific_var'>qval_specific_var</h2><span id='topic+qval_specific_var'></span>

<h3>Description</h3>

<p>A function to retrieve a vector of q-values of each taxa
for one specific variable. In other words, this will be useful for
quickly accessing the taxa-specific q-values for main binary group variable
(or other specific variable/covariate).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qval_specific_var(qvaltab, varname)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qval_specific_var_+3A_qvaltab">qvaltab</code></td>
<td>
<p>A table that includes q-values for a specific variable.</p>
</td></tr>
<tr><td><code id="qval_specific_var_+3A_varname">varname</code></td>
<td>
<p>Specify the name of the variable of interest.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of q-values for a single variable from the model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(combinedamgut) # A complete data containing columns with taxa and clinical covariates.

# Note: The line below will use a toy example with the first 30 out of 138 taxa.
OTUtab = combinedamgut[ , 8:37]
# Clinical/demographic covariates (phenotypic data):
# Note: All of these covariates will be included in the regression, so
# please make sure that phenodat includes the variables that will be analyzed only.
phenodat = combinedamgut[, 1:7] # first column is ID, so not using it.
# Obtain indices of each grouping factor
# In this example, a variable indicating the status of living with a dog was chosen (i.e. bin_dog).
# Accordingly, Groups A and B imply living without and with a dog, respectively.
 newindex_grpA = which(combinedamgut$bin_dog == 0)
 newindex_grpB = which(combinedamgut$bin_dog == 1)

SOHPIEres &lt;- SOHPIE_DNA(OTUdat = OTUtab, clindat = phenodat,
groupA = newindex_grpA, groupB = newindex_grpB, c = 0.5)

# Create an object to keep the table with q-values using qval() function.
qvaltab &lt;- qval(SOHPIEres)

# Retrieve a vector of q-values for a single variable of interest.
qval_specific_var(qvaltab = qvaltab, varname = "bin_dog")

</code></pre>

<hr>
<h2 id='SOHPIE_DNA'>SOHPIE_DNA</h2><span id='topic+SOHPIE_DNA'></span>

<h3>Description</h3>

<p>A pseudo-value regression approach for differential co-abundance
network analysis that adjusts for additional covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SOHPIE_DNA(OTUdat, clindat, groupA, groupB, c)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SOHPIE_DNA_+3A_otudat">OTUdat</code></td>
<td>
<p>An OTU table with subjects in rows and taxa in columns.</p>
</td></tr>
<tr><td><code id="SOHPIE_DNA_+3A_clindat">clindat</code></td>
<td>
<p>A subdata consisting of the clinical and demographic variables that
the user wants to include in the regression.
(e.g., binary group indicator for intervention vs. control, continuous age, ...)</p>
</td></tr>
<tr><td><code id="SOHPIE_DNA_+3A_groupa">groupA</code></td>
<td>
<p>Indices of the subjects in the first category (e.g., not living with a dog; see example below with American Gut Project sample data)
of binary group variable.</p>
</td></tr>
<tr><td><code id="SOHPIE_DNA_+3A_groupb">groupB</code></td>
<td>
<p>Indices of the subjects in the second category (e.g., living with a dog; see example below with American Gut Project sample data)
of binary group variable.</p>
</td></tr>
<tr><td><code id="SOHPIE_DNA_+3A_c">c</code></td>
<td>
<p>The choice of trimming proportion for the least trimmed estimator of robust regression.
A value has to be between 0.5 and 1 as specified in ltsReg() function in robustbase package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing three data frame objects returned from this SOHPIE_DNA main function. A user will see
beta coefficients, p-values, and adjusted p-values (q-values)
for each predictor variables that are included in the regression model.
</p>


<h3>References</h3>

<p>Ahn S, Datta S. Differential Co-Abundance Network Analyses for Microbiome Data Adjusted for Clinical Covariates Using Jackknife Pseudo-Values.
ArXiv [Preprint]. 2023 Mar 23:arXiv:2303.13702v1. PMID: 36994149; PMCID: PMC10055480.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# In this example, the subset of the American Gut Project data will be used.
data(combinedamgut) # A complete data containing columns with taxa and clinical covariates.

# Note: The line below will use a toy example with the first 30 out of 138 taxa.
OTUtab = combinedamgut[ , 8:37]
 #Clinical/demographic covariates (phenotypic data):
# Note: All of these covariates will be included in the regression, so
# please make sure that phenodat includes the variables that will be analyzed only.
phenodat = combinedamgut[, 1:7] # first column is ID, so not using it.
# Obtain indices of each grouping factor
# In this example, a variable indicating the status of living
# with a dog was chosen (i.e. bin_dog).
# Accordingly, Groups A and B imply living without and with a dog, respectively.
newindex_grpA = which(combinedamgut$bin_dog == 0)
newindex_grpB = which(combinedamgut$bin_dog == 1)

SOHPIEres &lt;- SOHPIE_DNA(OTUdat = OTUtab, clindat = phenodat,
groupA = newindex_grpA, groupB = newindex_grpB, c = 0.5)

</code></pre>

<hr>
<h2 id='sparcc'>sparcc wrapper</h2><span id='topic+sparcc'></span>

<h3>Description</h3>

<p>SpiecEasi R package, says in his package that
this is &quot;a reimplementation of SparCC algorithm (Friedman et Alm, PLoS Comp Bio, 2012).&quot;
Installation of SpiecEasi can sometimes generate errors, so I have included Dr. Huaying Fang's sparcc wrapper
as one of the functions in this package for the estimation of co-abundance networks. His code was acquired from
CCLasso (Fang et al, Bioinformatics, 2015), provided in GitHub (https://github.com/huayingfang/CCLasso).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sparcc(x, imax = 20, kmax = 10, alpha = 0.1, Vmin = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sparcc_+3A_x">x</code></td>
<td>
<p>count data matrix (OTU table)</p>
</td></tr>
<tr><td><code id="sparcc_+3A_imax">imax</code></td>
<td>
<p>Number of iterations in the outer loop</p>
</td></tr>
<tr><td><code id="sparcc_+3A_kmax">kmax</code></td>
<td>
<p>max iteration steps for SparCC</p>
</td></tr>
<tr><td><code id="sparcc_+3A_alpha">alpha</code></td>
<td>
<p>threshold for strong correlation</p>
</td></tr>
<tr><td><code id="sparcc_+3A_vmin">Vmin</code></td>
<td>
<p>absolute value of correlations below this threshold are considered zero by the inner SparCC loop.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This will estimate an association matrix (network) for observed OTU table.
</p>

<hr>
<h2 id='stderrs'>stderrs</h2><span id='topic+stderrs'></span>

<h3>Description</h3>

<p>A function to retrieve a vector of standard error (stderr)
of coefficient estimates (betahats) all predictor variables in the pseudo-value regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stderrs(SOHPIEres)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stderrs_+3A_sohpieres">SOHPIEres</code></td>
<td>
<p>An object called after running SOHPIE_DNA.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table that includes standard error of betahats
for all predictors regressed in the fitted model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(combinedamgut) # A complete data containing columns with taxa and clinical covariates.

# Note: The line below will use a toy example with the first 30 out of 138 taxa.
OTUtab = combinedamgut[ , 8:37]
# Clinical/demographic covariates (phenotypic data):
# Note: All of these covariates will be included in the regression, so
# please make sure that phenodat includes the variables that will be analyzed only.
phenodat = combinedamgut[, 1:7] # first column is ID, so not using it.
# Obtain indices of each grouping factor
# In this example, a variable indicating the status of living with a dog was chosen (i.e. bin_dog).
# Accordingly, Groups A and B imply living without and with a dog, respectively.
 newindex_grpA = which(combinedamgut$bin_dog == 0)
 newindex_grpB = which(combinedamgut$bin_dog == 1)

SOHPIEres &lt;- SOHPIE_DNA(OTUdat = OTUtab, clindat = phenodat,
groupA = newindex_grpA, groupB = newindex_grpB, c = 0.5)

# stderrs() function will return standard error of betahats only.
stderrs(SOHPIEres)

</code></pre>

<hr>
<h2 id='stderrs_specific_var'>stderrs_specific_var</h2><span id='topic+stderrs_specific_var'></span>

<h3>Description</h3>

<p>A function to retrieve a vector of standard error of coefficient estimates (betahats)
of each taxa for one specific variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stderrs_specific_var(stderrstab, varname)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stderrs_specific_var_+3A_stderrstab">stderrstab</code></td>
<td>
<p>A table that includes standard error of betahat for a specific variable.</p>
</td></tr>
<tr><td><code id="stderrs_specific_var_+3A_varname">varname</code></td>
<td>
<p>Specify the name of the variable of interest.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of standard error of betahats for a single variable from the model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(combinedamgut) # A complete data containing columns with taxa and clinical covariates.

# Note: The line below will use a toy example with the first 30 out of 138 taxa.
OTUtab = combinedamgut[ , 8:37]
# Clinical/demographic covariates (phenotypic data):
# Note: All of these covariates will be included in the regression, so
# please make sure that phenodat includes the variables that will be analyzed only.
phenodat = combinedamgut[, 1:7] # first column is ID, so not using it.
# Obtain indices of each grouping factor
# In this example, a variable indicating the status of living with a dog was chosen (i.e. bin_dog).
# Accordingly, Groups A and B imply living without and with a dog, respectively.
 newindex_grpA = which(combinedamgut$bin_dog == 0)
 newindex_grpB = which(combinedamgut$bin_dog == 1)

SOHPIEres &lt;- SOHPIE_DNA(OTUdat = OTUtab, clindat = phenodat,
groupA = newindex_grpA, groupB = newindex_grpB, c = 0.5)

# stderrs() function will return standard error of betahats only.
stderrstab &lt;- stderrs(SOHPIEres)

# stderrs_specific_var() will return standard error of coefficient estimates of
# a single variable of interest.
stderrs_specific_var(stderrstab = stderrstab, varname = "bin_dog")

</code></pre>

<hr>
<h2 id='thetahats'>thetahats</h2><span id='topic+thetahats'></span>

<h3>Description</h3>

<p>A function to compute the network centrality (i.e. total connectivity)
of each microbial taxa from the association matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thetahats(asso.matinput)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="thetahats_+3A_asso.matinput">asso.matinput</code></td>
<td>
<p>An input is an association matrix that is estimated from
the user-provided OTU data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing network centrality of each taxa.
</p>

<hr>
<h2 id='thetatildefun'>thetatildefun</h2><span id='topic+thetatildefun'></span>

<h3>Description</h3>

<p>A function to calculate jackknife pseudo-values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thetatildefun(thetahatinput, thetahatdropinput, sizegroup)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="thetatildefun_+3A_thetahatinput">thetahatinput</code></td>
<td>
<p>A network centrality calculated from association matrix
for whole sample.</p>
</td></tr>
<tr><td><code id="thetatildefun_+3A_thetahatdropinput">thetahatdropinput</code></td>
<td>
<p>Network centralities calculated from re-estimated 
association matrices for leave-one-out samples.</p>
</td></tr>
<tr><td><code id="thetatildefun_+3A_sizegroup">sizegroup</code></td>
<td>
<p>Sample size for group.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A jackknife pseudo-value will be returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# In this example, the subset of the American Gut Project data will be used.
data(combinedamgut) # A complete data containing columns with taxa and clinical covariates.

# Note: The line below will use a toy example with the first 30 out of 138 taxa.
OTUtab = combinedamgut[ , 8:37]

# Obtain indices of each grouping factor
# In this example, a variable indicating the status of living
# with a dog was chosen (i.e. bin_dog).
# Accordingly, Groups A and B imply living without and with a dog, respectively.
newindex_grpA = which(combinedamgut$bin_dog == 0)
newindex_grpB = which(combinedamgut$bin_dog == 1)

# Now, we estimate (and re-estimate) association matrices 
# for each group separately.
asso_matA = asso_mat(OTUdat=OTUtab, group=newindex_grpA) 
asso_matB = asso_mat(OTUdat=OTUtab, group=newindex_grpB) 

# Calculate the network centrality.
thetahat_grpA = thetahats(asso_matA$assomat) 
thetahat_grpB = thetahats(asso_matB$assomat)

# Obtain network centrality for the re-estimated association matrices.
thetahat_drop_grpA = sapply(asso_matA$reest.assomat, thetahats)
thetahat_drop_grpB = sapply(asso_matB$reest.assomat, thetahats)

# Sample sizes for each group.
n_A &lt;- length(newindex_grpA) 
n_B &lt;- length(newindex_grpB)

# Now calculate jackknife pseudo-values for each group.
thetatilde_grpA = thetatildefun(thetahat_grpA, thetahat_drop_grpA, n_A)
thetatilde_grpB = thetatildefun(thetahat_grpB, thetahat_drop_grpB, n_B)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
