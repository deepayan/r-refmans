<!DOCTYPE html><html><head><title>Help for package mcprofile</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mcprofile}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aphidlight'><p>Aphid attraction at different light intensities</p></a></li>
<li><a href='#confint.mcprofile'><p>Simultaneous Confidence Intervals for Multiple Contrast Profiles</p></a></li>
<li><a href='#cta'><p>Cell transformation assay dataset</p></a></li>
<li><a href='#exp.mcpCI'><p>exp transformation of Confidence Intervals</p></a></li>
<li><a href='#expit.mcpCI'><p>Inverse logit transformation of Confidence Intervals</p></a></li>
<li><a href='#hoa'><p>Higher order asymptotics using the modified likelihood root</p></a></li>
<li><a href='#mcprofile'><p>Construction of Multiple Contrast Profiles</p></a></li>
<li><a href='#mcprofileControl'><p>mcprofile Control Arguments</p></a></li>
<li><a href='#orglm.fit'><p>Fitting Order-Restricted Generalized Linear Models</p></a></li>
<li><a href='#summary.mcprofile'><p>Multiple Testing of General Hypotheses</p></a></li>
<li><a href='#toxinLD'><p>Identifying the lethal dose of a crop protection product.</p></a></li>
<li><a href='#wald'><p>Calculate Wald-Profiles</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Testing Generalized Linear Hypotheses for Generalized Linear
Model Parameters by Profile Deviance</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-04-19</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Gerhard &lt;00gerhard@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculation of signed root deviance profiles for linear combinations of parameters in a generalized linear model. Multiple tests and simultaneous confidence intervals are provided.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0), ggplot2</td>
</tr>
<tr>
<td>Imports:</td>
<td>quadprog, mvtnorm, splines</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, markdown, multcomp, MASS</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-04-18 22:34:51 UTC; daniel</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel Gerhard [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-04-20 05:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='aphidlight'>Aphid attraction at different light intensities</h2><span id='topic+aphidlight'></span>

<h3>Description</h3>

<p>The light intensity (mumol/m^2s) of green LED light should be found, which attracts Aphis fabae best. At each of 4 replicates 20 aphids were put in a lightproof box with only one green LED at one end. All aphids that fly to the green light are caught and counted after a period of 5h. This procedure was replicated for 9 increasing light intensities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aphidlight
</code></pre>


<h3>Format</h3>

<p>A data frame with 36 observations on the following 3 variables.
</p>

<dl>
<dt><code>light</code></dt><dd><p>a numeric vector denoting the concentration levels</p>
</dd>
<dt><code>black</code></dt><dd><p>a numeric vector with the number of aphids remaining in the box.</p>
</dd>
<dt><code>green</code></dt><dd><p>a numeric vector with the number of attracted aphids</p>
</dd>
</dl>


<h3>References</h3>

<p>Akyazi, G (2009): Zum Einfluss auf Lichtintensitaet und Lichtqualitaet (Hochleistungs-LEDs) auf das Verhalten von Aphis fabae. IPP MSc 19.
</p>

<hr>
<h2 id='confint.mcprofile'>Simultaneous Confidence Intervals for Multiple Contrast Profiles</h2><span id='topic+confint.mcprofile'></span>

<h3>Description</h3>

<p>Calculates simultaneous confidence intervals based on signed root deviance profiles from function <code><a href="#topic+mcprofile">mcprofile</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcprofile'
confint(object, parm, level = 0.95,
  adjust = c("single-step", "none", "bonferroni"),
  alternative = c("two.sided", "less", "greater"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.mcprofile_+3A_object">object</code></td>
<td>
<p>An object of class mcprofile</p>
</td></tr>
<tr><td><code id="confint.mcprofile_+3A_parm">parm</code></td>
<td>
<p>Just ignore this...</p>
</td></tr>
<tr><td><code id="confint.mcprofile_+3A_level">level</code></td>
<td>
<p>Simultaneous confidence level (1-alpha), default at 0.95</p>
</td></tr>
<tr><td><code id="confint.mcprofile_+3A_adjust">adjust</code></td>
<td>
<p>a character string specifying the adjustment for multiplicity. &quot;single-step&quot; controlling the FWER utilising a multivariate normal- or t-distribution; &quot;none&quot; for comparison-wise error rate; &quot;bonferroni&quot; applying a Bonferroni correction.</p>
</td></tr>
<tr><td><code id="confint.mcprofile_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying if two- or one-sided confidence intervals should be computed</p>
</td></tr>
<tr><td><code id="confint.mcprofile_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class mcpCI
</p>


<h3>See Also</h3>

<p><code><a href="MASS.html#topic+confint.glm">confint.glm</a></code>, <code><a href="#topic+mcprofile">mcprofile</a></code>, <code><a href="multcomp.html#topic+confint.glht">confint.glht</a></code>
</p>

<hr>
<h2 id='cta'>Cell transformation assay dataset</h2><span id='topic+cta'></span>

<h3>Description</h3>

<p>Balb//c 3T3 cells are treated with different concentrations of a carcinogen. Cells treated with a carcinogen do not stop proliferation. Number of foci (cell accumulations) are counted for 10 replicates per concentration level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cta
</code></pre>


<h3>Format</h3>

<p>A data frame with 80 observations on the following 2 variables.
</p>

<dl>
<dt><code>conc</code></dt><dd><p>a numeric vector denoting the concentration levels</p>
</dd>
<dt><code>foci</code></dt><dd><p>a numeric vector with the number of foci</p>
</dd>
</dl>


<h3>References</h3>

<p>Thomas C (2008): ECVAM data
</p>

<hr>
<h2 id='exp.mcpCI'>exp transformation of Confidence Intervals</h2><span id='topic+exp.mcpCI'></span>

<h3>Description</h3>

<p>Exponential transformation of confidence interval estimates in mcpCI objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcpCI'
exp(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exp.mcpCI_+3A_x">x</code></td>
<td>
<p>An object of class mcpCI</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class mcpCI with transformed estimates.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+exp">exp</a></code>, <code><a href="#topic+confint.mcprofile">confint.mcprofile</a></code>
</p>
<p>Other confidence interval transformations: <code><a href="#topic+expit.mcpCI">expit.mcpCI</a></code>
</p>

<hr>
<h2 id='expit.mcpCI'>Inverse logit transformation of Confidence Intervals</h2><span id='topic+expit.mcpCI'></span>

<h3>Description</h3>

<p>Inverse logit transformation of confidence interval estimates in mcpCI objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expit.mcpCI(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expit.mcpCI_+3A_x">x</code></td>
<td>
<p>An object of class mcpCI</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class mcpCI with transformed estimates.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+exp">exp</a></code>, <code><a href="#topic+confint.mcprofile">confint.mcprofile</a></code>
</p>
<p>Other confidence interval transformations: <code><a href="#topic+exp.mcpCI">exp.mcpCI</a></code>
</p>

<hr>
<h2 id='hoa'>Higher order asymptotics using the modified likelihood root</h2><span id='topic+hoa'></span>

<h3>Description</h3>

<p>Transforms a signed root deviance profile to a modified likelihood root profile.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hoa(object, maxstat = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hoa_+3A_object">object</code></td>
<td>
<p>An object of class mcprofile</p>
</td></tr>
<tr><td><code id="hoa_+3A_maxstat">maxstat</code></td>
<td>
<p>Limits the statistic to a maximum absolute value (default=10)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class mcprofile with a hoa profile in the srdp slot.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mcprofile">mcprofile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#######################################
## cell transformation assay example ##
#######################################

str(cta)
## change class of cta$conc into factor
cta$concf &lt;- factor(cta$conc, levels=unique(cta$conc))

ggplot(cta, aes(y=foci, x=concf)) + 
  geom_boxplot() +
  geom_dotplot(binaxis = "y", stackdir = "center", binwidth = 0.2) + 
  xlab("concentration")
  
  
# glm fit assuming a Poisson distribution for foci counts
# parameter estimation on the log link
# removing the intercept
fm &lt;- glm(foci ~ concf-1, data=cta, family=poisson(link="log"))

### Comparing each dose to the control by Dunnett-type comparisons
# Constructing contrast matrix
library(multcomp)
CM &lt;- contrMat(table(cta$concf), type="Dunnett")

# calculating signed root deviance profiles
(dmcp &lt;- mcprofile(fm, CM))
# computing profiles for the modified likelihood root
hp &lt;- hoa(dmcp)

plot(hp)

# comparing confidence intervals
confint(hp)
confint(dmcp)
</code></pre>

<hr>
<h2 id='mcprofile'>Construction of Multiple Contrast Profiles</h2><span id='topic+mcprofile'></span><span id='topic+mcprofile.glm'></span><span id='topic+mcprofile.lm'></span>

<h3>Description</h3>

<p>Calculates signed root deviance profiles given a <code><a href="stats.html#topic+glm">glm</a></code> or <code><a href="stats.html#topic+lm">lm</a></code> object. The profiled parameters of interest are defined by providing a contrast matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcprofile(object, CM, control = mcprofileControl(), grid = NULL)

## S3 method for class 'glm'
mcprofile(object, CM, control = mcprofileControl(),
  grid = NULL)

## S3 method for class 'lm'
mcprofile(object, CM, control = mcprofileControl(),
  grid = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcprofile_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="stats.html#topic+glm">glm</a></code> or <code><a href="stats.html#topic+lm">lm</a></code></p>
</td></tr>
<tr><td><code id="mcprofile_+3A_cm">CM</code></td>
<td>
<p>A contrast matrix for the definition of parameter linear combinations (<code>CM %*% coefficients(object)</code>). The number of columns should be equal to the number of estimated parameters. Providing row names is recommendable.</p>
</td></tr>
<tr><td><code id="mcprofile_+3A_control">control</code></td>
<td>
<p>A list with control arguments. See <code><a href="#topic+mcprofileControl">mcprofileControl</a></code>.</p>
</td></tr>
<tr><td><code id="mcprofile_+3A_grid">grid</code></td>
<td>
<p>A matrix or list with profile support coordinates. Each column of the matrix or slot in a list corresponds to a row in the contrast matrix, each row of the grid matrix or element of a numeric vector in each list slot corresponds to a candidate of the contrast parameter. If NULL (default), a grid is found automatically similar to function <code><a href="MASS.html#topic+profile.glm">profile.glm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The profiles are calculates separately for each row of the contrast matrix. The profiles are calculated by constrained IRWLS optimization, implemented in function <code>orglm</code>, using the quadratic programming algorithm of package <code>quadprog</code>.
</p>


<h3>Value</h3>

<p>An object of class mcprofile. The slot <code>srdp</code> contains the profiled signed root deviance statistics. The <code>optpar</code> slot contains a matrix with profiled parameter estimates.
</p>


<h3>See Also</h3>

<p><code><a href="MASS.html#topic+profile.glm">profile.glm</a></code>, <code><a href="multcomp.html#topic+glht">glht</a></code>, <code><a href="multcomp.html#topic+contrMat">contrMat</a></code>, <code><a href="#topic+confint.mcprofile">confint.mcprofile</a></code>, <code><a href="#topic+summary.mcprofile">summary.mcprofile</a></code>, <code><a href="quadprog.html#topic+solve.QP">solve.QP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#######################################
## cell transformation assay example ##
#######################################

str(cta)
## change class of cta$conc into factor
cta$concf &lt;- factor(cta$conc, levels=unique(cta$conc))

ggplot(cta, aes(y=foci, x=concf)) + 
  geom_boxplot() +
  geom_dotplot(binaxis = "y", stackdir = "center", binwidth = 0.2) +  
  xlab("concentration")
    
    
# glm fit assuming a Poisson distribution for foci counts
# parameter estimation on the log link
# removing the intercept
fm &lt;- glm(foci ~ concf-1, data=cta, family=poisson(link="log"))

### Comparing each dose to the control by Dunnett-type comparisons
# Constructing contrast matrix
library(multcomp)
CM &lt;- contrMat(table(cta$concf), type="Dunnett")

# calculating signed root deviance profiles
(dmcp &lt;- mcprofile(fm, CM))
# plot profiles
plot(dmcp)
# confidence intervals
(ci &lt;- confint(dmcp))
plot(ci)
</code></pre>

<hr>
<h2 id='mcprofileControl'>mcprofile Control Arguments</h2><span id='topic+mcprofileControl'></span>

<h3>Description</h3>

<p>Control arguments for the mcprofile function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcprofileControl(maxsteps = 10, alpha = 0.01, del = function(zmax) zmax/5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcprofileControl_+3A_maxsteps">maxsteps</code></td>
<td>
<p>Maximum number of points to be used for profiling each parameter.</p>
</td></tr>
<tr><td><code id="mcprofileControl_+3A_alpha">alpha</code></td>
<td>
<p>Highest significance level allowed for the profile t-statistics (Bonferroni adjusted)</p>
</td></tr>
<tr><td><code id="mcprofileControl_+3A_del">del</code></td>
<td>
<p>Suggested change on the scale of the profile t-statistics. Default value chosen to allow profiling at about 10 parameter values.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+mcprofile">mcprofile</a></code>
</p>

<hr>
<h2 id='orglm.fit'>Fitting Order-Restricted Generalized Linear Models</h2><span id='topic+orglm.fit'></span>

<h3>Description</h3>

<p><code>orglm.fit</code> is used to fit generalized linear models with restrictions on the parameters, specified by giving a description of the linear predictor, a description of the error distribution, and a description of a matrix with linear constraints. The <code>quadprog</code> package is used to apply linear constraints on the parameter vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orglm.fit(x, y, weights = rep(1, nobs), start = NULL, etastart = NULL,
  mustart = NULL, offset = rep(0, nobs), family = gaussian(),
  control = list(), intercept = TRUE, constr, rhs, nec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="orglm.fit_+3A_x">x</code></td>
<td>
<p>is a design matrix of dimension <code>n * p</code></p>
</td></tr>
<tr><td><code id="orglm.fit_+3A_y">y</code></td>
<td>
<p>is a vector of observations of length <code>n</code></p>
</td></tr>
<tr><td><code id="orglm.fit_+3A_weights">weights</code></td>
<td>
<p>an optional vector of &lsquo;prior weights&rsquo; to be used in the fitting process.  Should be <code>NULL</code> or a numeric vector.</p>
</td></tr>
<tr><td><code id="orglm.fit_+3A_start">start</code></td>
<td>
<p>starting values for the parameters in the linear predictor.</p>
</td></tr>
<tr><td><code id="orglm.fit_+3A_etastart">etastart</code></td>
<td>
<p>starting values for the linear predictor.</p>
</td></tr>
<tr><td><code id="orglm.fit_+3A_mustart">mustart</code></td>
<td>
<p>starting values for the vector of means.</p>
</td></tr>
<tr><td><code id="orglm.fit_+3A_offset">offset</code></td>
<td>
<p>this can be used to specify an <em>a priori</em> known component to be included in the linear predictor during fitting. This should be <code>NULL</code> or a numeric vector of length equal to the number of cases.  One or more <code><a href="stats.html#topic+offset">offset</a></code> terms can be included in the formula instead or as well, and if more than one is specified their sum is used.  See <code><a href="stats.html#topic+model.offset">model.offset</a></code>.</p>
</td></tr>
<tr><td><code id="orglm.fit_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link function to be used in the model. This can be a character string naming a family function, a family function or the result of a call to a family function.  (See <code><a href="stats.html#topic+family">family</a></code> for details of family functions.)</p>
</td></tr>
<tr><td><code id="orglm.fit_+3A_control">control</code></td>
<td>
<p>a list of parameters for controlling the fitting process.  For <code>orglm.fit</code> this is passed to <code><a href="stats.html#topic+glm.control">glm.control</a></code>.</p>
</td></tr>
<tr><td><code id="orglm.fit_+3A_intercept">intercept</code></td>
<td>
<p>logical. Should an intercept be included in the <em>null</em> model?</p>
</td></tr>
<tr><td><code id="orglm.fit_+3A_constr">constr</code></td>
<td>
<p>a matrix with linear constraints. The columns of this matrix should correspond to the columns of the design matrix.</p>
</td></tr>
<tr><td><code id="orglm.fit_+3A_rhs">rhs</code></td>
<td>
<p>right hand side of the linear constraint formulation. A numeric vector with a length corresponding to the rows of <code>constr</code>.</p>
</td></tr>
<tr><td><code id="orglm.fit_+3A_nec">nec</code></td>
<td>
<p>Number of equality constrints. The first <code>nec</code> constraints defined in <code>constr</code> are treated as equality constraints; the remaining ones are inequality constraints.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Non-<code>NULL</code> <code>weights</code> can be used to indicate that different observations have different dispersions (with the values in <code>weights</code> being inversely proportional to the dispersions); or equivalently, when the elements of <code>weights</code> are positive integers <code class="reqn">w_i</code>, that each response <code class="reqn">y_i</code> is the mean of <code class="reqn">w_i</code> unit-weight observations.  For a binomial GLM prior weights are used to give the number of trials when the response is the proportion of successes: they would rarely be used for a Poisson GLM.
If more than one of <code>etastart</code>, <code>start</code> and <code>mustart</code> is specified, the first in the list will be used.  It is often advisable to supply starting values for a <code><a href="stats.html#topic+quasi">quasi</a></code> family, and also for families with unusual links such as <code>gaussian("log")</code>.
For the background to warning messages about &lsquo;fitted probabilities numerically 0 or 1 occurred&rsquo; for binomial GLMs, see Venables &amp; Ripley (2002, pp. 197&ndash;8).
</p>


<h3>Value</h3>

<p>An object of class <code>"glm"</code> is a list containing at least the following components:
</p>

<dl>
<dt>coefficients</dt><dd><p>a named vector of coefficients</p>
</dd>
<dt>residuals</dt><dd><p>the <em>working</em> residuals, that is the residuals in the final iteration of the IWLS fit. Since cases with zero weights are omitted, their working residuals are <code>NA</code>.</p>
</dd>
<dt>fitted.values</dt><dd><p>the fitted mean values, obtained by transforming the linear predictors by the inverse of the link function.</p>
</dd>
<dt>rank</dt><dd><p>the numeric rank of the fitted linear model.</p>
</dd>
<dt>family</dt><dd><p>the <code><a href="stats.html#topic+family">family</a></code> object used.</p>
</dd>
<dt>linear.predictors</dt><dd><p>the linear fit on link scale.</p>
</dd>
<dt>deviance</dt><dd><p>up to a constant, minus twice the maximized log-likelihood. Where sensible, the constant is chosen so that a saturated model has deviance zero.</p>
</dd>
<dt>null.deviance</dt><dd><p>The deviance for the null model, comparable with <code>deviance</code>. The null model will include the offset, and an intercept if there is one in the model.  Note that this will be incorrect if the link function depends on the data other than through the fitted mean: specify a zero offset to force a correct calculation.</p>
</dd>
<dt>iter</dt><dd><p>the number of iterations of IWLS used.</p>
</dd>
<dt>weights</dt><dd><p>the <em>working</em> weights, that is the weights in the final iteration of the IWLS fit.</p>
</dd>
<dt>prior.weights</dt><dd><p>the weights initially supplied, a vector of <code>1</code>s if none were.</p>
</dd>
<dt>df.residual</dt><dd><p>the residual degrees of freedom of the unconstrained model.</p>
</dd>
<dt>df.null</dt><dd><p>the residual degrees of freedom for the null model.</p>
</dd>
<dt>y</dt><dd><p>if requested (the default) the <code>y</code> vector used. (It is a vector even for a binomial model.)</p>
</dd>
<dt>converged</dt><dd><p>logical. Was the IWLS algorithm judged to have converged?</p>
</dd>
<dt>boundary</dt><dd><p>logical. Is the fitted value on the boundary of the attainable values?</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Modification of the original glm.fit by Daniel Gerhard.
The original R implementation of <code>glm</code> was written by Simon Davies working for Ross Ihaka at the University of Auckland, but has since been extensively re-written by members of the R Core team.
The design was inspired by the S function of the same name described in Hastie &amp; Pregibon (1992).
</p>


<h3>References</h3>


<ul>
<li><p> Dobson, A. J. (1990) <em>An Introduction to Generalized Linear Models.</em> London: Chapman and Hall.
</p>
</li>
<li><p> Hastie, T. J. and Pregibon, D. (1992) <em>Generalized linear models.</em> Chapter 6 of <em>Statistical Models in S</em> eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
</p>
</li>
<li><p> McCullagh P. and Nelder, J. A. (1989) <em>Generalized Linear Models.</em> London: Chapman and Hall.
</p>
</li>
<li><p> Venables, W. N. and Ripley, B. D. (2002) <em>Modern Applied Statistics with S.</em> New York: Springer.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="quadprog.html#topic+solve.QP">solve.QP</a></code>
</p>

<hr>
<h2 id='summary.mcprofile'>Multiple Testing of General Hypotheses</h2><span id='topic+summary.mcprofile'></span>

<h3>Description</h3>

<p>Multiple contrast testing based on signed root deviance profiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcprofile'
summary(object, margin = 0, adjust = "single-step",
  alternative = c("two.sided", "less", "greater"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mcprofile_+3A_object">object</code></td>
<td>
<p>an object of class mcprofile</p>
</td></tr>
<tr><td><code id="summary.mcprofile_+3A_margin">margin</code></td>
<td>
<p>test margin, specifying the right hand side of the hypotheses.</p>
</td></tr>
<tr><td><code id="summary.mcprofile_+3A_adjust">adjust</code></td>
<td>
<p>a character string specifying the adjustment for multiplicity. &quot;single-step&quot; controlling the FWER utilizing a multivariate normal- or t-distribution; &quot;none&quot; for comparison-wise error rate, or any other method provided by <code><a href="stats.html#topic+p.adjust">p.adjust</a></code>.</p>
</td></tr>
<tr><td><code id="summary.mcprofile_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="summary.mcprofile_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class mcpSummary
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mcprofile">mcprofile</a></code>, <code><a href="multcomp.html#topic+summary.glht">summary.glht</a></code>
</p>

<hr>
<h2 id='toxinLD'>Identifying the lethal dose of a crop protection product.</h2><span id='topic+toxinLD'></span>

<h3>Description</h3>

<p>Increasing dose levels of a toxin, used as a pesticide for crop protection, is applied to non-target species. The lethal dose should be identified in this experiment. The dataset represents simulated data based on a real experiment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toxinLD
</code></pre>


<h3>Format</h3>

<p>A data frame with 6 observations on the following 3 variables.
</p>

<dl>
<dt><code>dose</code></dt><dd><p>a numeric vector denoting the toxin concentration levels</p>
</dd>
<dt><code>dead</code></dt><dd><p>a numeric vector with the number of dead insects.</p>
</dd>
<dt><code>alive</code></dt><dd><p>a numeric vector with the number of surviving insects.</p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>str(toxinLD)

###############################################
# logistic regression on the logarithmic dose #
###############################################

toxinLD$logdose &lt;- log(toxinLD$dose)
fm &lt;- glm(cbind(dead, alive) ~ logdose, data=toxinLD, family=binomial(link="logit"))

#############
# profiling #
#############

# contrast matrix
pdose &lt;- seq(-1,2.3, length=7)
CM &lt;- model.matrix(~ pdose)

# user defined grid to construct profiles
mcpgrid &lt;- matrix(seq(-11,8,length=15), nrow=15, ncol=nrow(CM))
mc &lt;- mcprofile(fm, CM, grid=mcpgrid)

####################################
## confidence interval calculation #
####################################

# srdp profile
ci &lt;- confint(mc)
ppdat &lt;- data.frame(logdose=pdose)
ppdat$estimate &lt;- fm$family$linkinv(ci$estimate$Estimate)
ppdat$lower &lt;- fm$family$linkinv(ci$confint$lower)
ppdat$upper &lt;- fm$family$linkinv(ci$confint$upper)
ppdat$method &lt;- "profile"

# wald profile
wci &lt;- confint(wald(mc))
wpdat &lt;- ppdat
wpdat$estimate &lt;- fm$family$linkinv(wci$estimate$Estimate)
wpdat$lower &lt;- fm$family$linkinv(wci$confint$lower)
wpdat$upper &lt;- fm$family$linkinv(wci$confint$upper)
wpdat$method &lt;- "wald"

# higher order approximation
hci &lt;- confint(hoa(mc))
hpdat &lt;- ppdat
hpdat$estimate &lt;- fm$family$linkinv(hci$estimate$Estimate)
hpdat$lower &lt;- fm$family$linkinv(hci$confint$lower)
hpdat$upper &lt;- fm$family$linkinv(hci$confint$upper)
hpdat$method &lt;- "hoa"

# combine results
pdat &lt;- rbind(ppdat, wpdat, hpdat)


#####################################
# estimating the lethal dose LD(25) #
#####################################

ld &lt;- 0.25
pspf &lt;- splinefun(ppdat$upper, pdose)
pll &lt;- pspf(ld)
wspf &lt;- splinefun(wpdat$upper, pdose)
wll &lt;- wspf(ld)
hspf &lt;- splinefun(hpdat$upper, pdose)
hll &lt;- hspf(ld)

ldest &lt;- data.frame(limit=c(pll, wll, hll), method=c("profile","wald", "hoa"))

################################
# plot of intervals and LD(25) #
################################

ggplot(toxinLD, aes(x=logdose, y=dead/(dead+alive))) + 
  geom_ribbon(data=pdat, aes(y=estimate, ymin=lower, ymax=upper, 
                             fill=method, colour=method, linetype=method), 
              alpha=0.1, size=0.95) +
  geom_line(data=pdat, aes(y=estimate, linetype=method), size=0.95) +
  geom_point(size=3) +
  geom_hline(yintercept=ld, linetype=2) +
  geom_segment(data=ldest, aes(x=limit, xend=limit, y=0.25, yend=-0.05, 
                               linetype=method), size=0.6, colour="grey2") +
  ylab("Mortality rate")
</code></pre>

<hr>
<h2 id='wald'>Calculate Wald-Profiles</h2><span id='topic+wald'></span>

<h3>Description</h3>

<p>Transforms a signed root deviance profile of a mcprofile object into a profile of Wald-type statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wald(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wald_+3A_object">object</code></td>
<td>
<p>An object of class mcprofile</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class mcprofile with a wald profile in the srdp slot.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mcprofile">mcprofile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#######################################
## cell transformation assay example ##
#######################################

str(cta)
## change class of cta$conc into factor
cta$concf &lt;- factor(cta$conc, levels=unique(cta$conc))

ggplot(cta, aes(y=foci, x=concf)) + 
  geom_boxplot() +
  geom_dotplot(binaxis = "y", stackdir = "center", binwidth = 0.2) + 
  xlab("concentration")
  
  
# glm fit assuming a Poisson distribution for foci counts
# parameter estimation on the log link
# removing the intercept
fm &lt;- glm(foci ~ concf-1, data=cta, family=poisson(link="log"))

### Comparing each dose to the control by Dunnett-type comparisons
# Constructing contrast matrix
library(multcomp)
CM &lt;- contrMat(table(cta$concf), type="Dunnett")

# calculating signed root deviance profiles
(dmcp &lt;- mcprofile(fm, CM))
# computing profiles for the modified likelihood root
wp &lt;- wald(dmcp)

plot(wp)

# comparing confidence intervals
confint(wp)
confint(dmcp)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
