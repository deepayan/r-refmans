<!DOCTYPE html><html><head><title>Help for package joineR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {joineR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aids'><p>AIDS drug trial data</p></a></li>
<li><a href='#epileptic'><p>Dose calibration of anti-epileptic drugs data</p></a></li>
<li><a href='#heart.valve'><p>Aortic valve replacement surgery data</p></a></li>
<li><a href='#joineR'><p>joineR</p></a></li>
<li><a href='#joint'><p>Fit joint model for survival and longitudinal data measured with error</p></a></li>
<li><a href='#joint.object'><p>Fitted <code>joint</code> object</p></a></li>
<li><a href='#jointdata'><p>Creates an object of class <code>jointdata</code></p></a></li>
<li><a href='#jointplot'><p>Joint plot of longitudinal and survival data</p></a></li>
<li><a href='#jointSE'><p>Standard errors via bootstrap for a joint model fit</p></a></li>
<li><a href='#lines.jointdata'><p>Add lines to an existing <code>jointdata</code> plot</p></a></li>
<li><a href='#liver'><p>Liver cirrhosis drug trial data</p></a></li>
<li><a href='#mental'><p>Mental health trial data</p></a></li>
<li><a href='#plot.jointdata'><p>Plot longitudinal data</p></a></li>
<li><a href='#plot.vargm'><p>Plots the empirical variogram for longitudinal data</p></a></li>
<li><a href='#points.jointdata'><p>Add points to an existing <code>jointdata</code> plot</p></a></li>
<li><a href='#sample.jointdata'><p>Sample from a <code>jointdata</code> x</p></a></li>
<li><a href='#simjoint'><p>Simulate data from a joint model</p></a></li>
<li><a href='#subset.jointdata'><p>Subsetting object of class <code>jointdata</code></p></a></li>
<li><a href='#summary.joint'><p>Summarise a random effects joint model fit</p></a></li>
<li><a href='#summary.jointdata'><p>Summarise a <code>jointdata</code> object</p></a></li>
<li><a href='#summarybal'><p>Summary of a balanced longitudinal data set</p></a></li>
<li><a href='#to.balanced'><p>Transform data to the longitudinal balanced format</p></a></li>
<li><a href='#to.unbalanced'><p>Transform data to the longitudinal unbalanced format</p></a></li>
<li><a href='#UniqueVariables'><p>Extracts the unique non-time dependent variables per patient, from an</p>
unbalanced data set</a></li>
<li><a href='#variogram'><p>Empirical variogram for longitudinal data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Joint Modelling of Repeated Measurements and Time-to-Event Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.8</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Description:</td>
<td>Analysis of repeated measurements and time-to-event data via random
    effects joint models. Fits the joint models proposed by Henderson and colleagues
    &lt;<a href="https://doi.org/10.1093%2Fbiostatistics%2F1.4.465">doi:10.1093/biostatistics/1.4.465</a>&gt; (single event time) and by Williamson and
    colleagues (2008) &lt;<a href="https://doi.org/10.1002%2Fsim.3451">doi:10.1002/sim.3451</a>&gt; (competing risks events time) to a
    single continuous repeated measure. The time-to-event data is modelled using a 
    (cause-specific) Cox proportional hazards regression model with time-varying 
    covariates. The longitudinal outcome is modelled using a linear mixed effects
    model. The association is captured by a latent Gaussian process. The model is 
    estimated using am Expectation Maximization algorithm. Some plotting functions 
    and the variogram are also included. This project is funded by the Medical 
    Research Council (Grant numbers G0400615 and MR/M013227/1).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/graemeleehickey/joineR/">https://github.com/graemeleehickey/joineR/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/graemeleehickey/joineR/issues">https://github.com/graemeleehickey/joineR/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6), survival</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, lattice, MASS, nlme, statmod, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat, covr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-20 18:09:15 UTC; hickey</td>
</tr>
<tr>
<td>Author:</td>
<td>Pete Philipson <a href="https://orcid.org/0000-0001-7846-0208"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Ines Sousa <a href="https://orcid.org/0000-0002-2712-1713"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Peter J. Diggle <a href="https://orcid.org/0000-0003-3521-5020"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Paula Williamson <a href="https://orcid.org/0000-0001-9802-6636"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Ruwanthi Kolamunnage-Dona
    <a href="https://orcid.org/0000-0003-3886-6208"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Robin Henderson [aut],
  Graeme L. Hickey <a href="https://orcid.org/0000-0002-4989-0054"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Maria Sudell [ctb],
  Medical Research Council [fnd] (Grant numbers: G0400615 and
    MR/M013227/1)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Graeme L. Hickey &lt;graemeleehickey@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-22 21:20:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='aids'>AIDS drug trial data</h2><span id='topic+aids'></span>

<h3>Description</h3>

<p>This dataset describes a randomized clinical trial (Goldman et 
al., 1996) in which both survival and longitudinal data were collected to 
compare the efficacy and safety of two antiretroviral drugs, namely ddI 
(didanosine) and ddC (zalcitabine), in treating HIV-infected patients 
intolerant or failing zidovudine (AZT) therapy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(aids)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> in the unbalanced format with 1405 longitudinal 
observations from 467 subjects. The columns are:
</p>

<dl>
<dt><code>id</code></dt><dd><p>integer: number for patient identification.</p>
</dd>
<dt><code>time</code></dt><dd><p>numeric: time to death (or censoring).</p>
</dd>
<dt><code>death</code></dt><dd><p>integer: event indicator. Coded as <code>0 = 
  </code>right-censoring, and <code>1 = </code>death.</p>
</dd>
<dt><code>obstime</code></dt><dd><p>numeric: measurement times for the repeated CD4 count
measurements.</p>
</dd>
<dt><code>CD4</code></dt><dd><p>numeric: CD4 cell counts measured at <code>obstime</code>.</p>
</dd>
<dt><code>drug</code></dt><dd><p>factor: drug indicator. Coded as <code>ddI = </code>didanosine
and <code>ddC = </code>zalcitabine.</p>
</dd>
<dt><code>gender</code></dt><dd><p>factor: gender indicator. Coded as <code>male</code> and 
<code>female</code>.</p>
</dd>
<dt><code>prevOI</code></dt><dd><p>factor: opportunistic infection indicator. Coded as 
<code>AIDS = </code>AIDS diagnosis at study entry, and <code>noAIDS = </code>no 
previous infection.</p>
</dd>
<dt><code>AZT</code></dt><dd><p>factor: AZT intolerance/failure indicator. Coded as 
<code>intolerance</code> or <code>failure</code>.</p>
</dd> 
</dl>



<h3>Source</h3>

<p>Guo X, Carlin B. Separate and joint modeling of longitudinal and
event time data using standard computer packages. 
<em>The American Statistician</em>. 2004; <strong>58</strong>: 16-24
</p>


<h3>References</h3>

<p>Goldman A, Carlin B, Crane L, Launer C, Korvick J, Deyton L, Abrams D.
Response of CD4 and clinical consequences to treatment using ddI or ddC in
patients with advanced HIV infection. <em>Journal of Acquired Immune
Deficiency Syndromes and Human Retrovirology</em>. 1996; <strong>11</strong>: 161-169
URL: <a href="http://www.biostat.umn.edu/~brad/data.html">http://www.biostat.umn.edu/~brad/data.html</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+heart.valve">heart.valve</a></code>, <code><a href="#topic+epileptic">epileptic</a></code>, 
<code><a href="#topic+mental">mental</a></code>, <code><a href="#topic+liver">liver</a></code>.
</p>

<hr>
<h2 id='epileptic'>Dose calibration of anti-epileptic drugs data</h2><span id='topic+epileptic'></span>

<h3>Description</h3>

<p>The SANAD (Standard and New Anti-epileptic Drugs) study (Marson
et al., 2007) is a randomized control trial of standard and new
anti-epileptic drugs, comparing effects on longer term clinical outcomes.
The data consists of longitudinal measurements of calibrated dose for the
groups randomized to a standard drug (CBZ) and a new drug (LTG). The
objective of the analysis is to investigate the effect of drug titration on
the relative effects of LTG and CBZ on treatment failure (withdrawal of the
randomized drug). There are several baseline covariates available, and also
data on the time to withdrawal from randomized drug.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(epileptic)
</code></pre>


<h3>Format</h3>

<p>This is a data frame in the unbalanced format, that is, with one row 
per observation. The data consists of columns for patient identifier, time 
of measurement, calibrated dose, baseline covariates, and survival data. 
The column names are identified as follows:
</p>

<dl>
<dt><code>id</code></dt><dd><p>integer: patient identifier.</p>
</dd>
<dt><code>dose</code></dt><dd><p>numeric: calibrated dose.</p>
</dd>
<dt><code>time</code></dt><dd><p>integer: timing of clinic visit at which dose recorded
(days).</p>
</dd>
<dt><code>with.time</code></dt><dd><p>integer: time of drug withdrawal/maximum follow up 
time (days).</p>
</dd>
<dt><code>with.status</code></dt><dd><p>censoring indicator (<code>1 = </code>withdrawal of 
randomized drug and <code>0 = </code>not withdrawn from randomized drug/lost to
follow up).</p>
</dd>
<dt><code>with.status2</code></dt><dd><p>censoring indicator (<code>1 = </code>withdrawal of 
randomized drug due to inadequate seizure control, (<code>2 = </code>withdrawal 
of randomized drug due to unacceptable adverse effects, and <code>0 = </code>not
withdrawn from randomized drug/lost to follow up).</p>
</dd>
<dt><code>with.status.uae</code></dt><dd><p><code>1 = </code>withdrawal due to unacceptable 
adverse effects, <code>0 = </code>otherwise.</p>
</dd>
<dt><code>with.status.isc</code></dt><dd><p><code>1 = </code>withdrawal due to inadequate 
seizure control, <code>0 = </code>otherwise.</p>
</dd>
<dt><code>treat</code></dt><dd><p>factor: randomized treatment (CBZ or LTG).</p>
</dd>
<dt><code>age</code></dt><dd><p>numeric: age of patient at randomization (years).</p>
</dd>
<dt><code>gender</code></dt><dd><p>factor: gender of patient. <code>F = </code>female, <code>M
  = </code>male.</p>
</dd>
<dt><code>learn.dis</code></dt><dd><p>factor: learning disability.</p>
</dd>
</dl>



<h3>Source</h3>

<p>SANAD Trial Group, University of Liverpool
</p>


<h3>References</h3>

<p>Marson AG, Appleton R, Baker GA, et al. A randomised controlled trial 
examining longer-term outcomes of standard versus new antiepileptic drugs. 
The SANAD Trial. <em>Health Tech Assess</em>. 2007; <strong>11(37)</strong>.
</p>
<p>Marson AG, Al-Kharusi AM, Alwaidh M, et al. The SANAD study of effectiveness 
of carbamazepine, gabapentin, lamotrigine, oxcarbazepine, or topiramate for 
treatment of partial epilepsy: an unblinded randomised controlled trial. 
<em>Lancet</em>. 2007; <strong>365</strong>: 2007-2013.
</p>
<p>Williamson PR, Kolamunnage-Dona R, Philipson P, Marson AG. Joint modelling of
longitudinal and competing risks data. <em>Stats Med.</em> 2008;
<strong>27(30)</strong>: 6426-6438.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+heart.valve">heart.valve</a></code>, <code><a href="#topic+liver">liver</a></code>, 
<code><a href="#topic+mental">mental</a></code>, <code><a href="#topic+aids">aids</a></code>.
</p>

<hr>
<h2 id='heart.valve'>Aortic valve replacement surgery data</h2><span id='topic+heart.valve'></span>

<h3>Description</h3>

<p>This is longitudinal data on an observational study on detecting
effects of different heart valves, differing on type of tissue, implanted
in the aortic position. The data consists of longitudinal measurements on
three different heart function outcomes, after surgery occurred. There are
several baseline covariates available, and also survival data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(heart.valve)
</code></pre>


<h3>Format</h3>

<p>This is a data frame in the unbalanced format, that is, with one row 
per observation. The data consists in columns for patient identification, 
time of measurements, longitudinal multiple longitudinal measurements, 
baseline covariates, and survival data. The column names are identified as 
follows:
</p>

<dl>
<dt><code>num</code></dt><dd><p>number for patient identification.</p>
</dd>
<dt><code>sex</code></dt><dd><p>gender of patient (<code>0 = </code>Male and <code>1 = 
  </code>Female).</p>
</dd>
<dt><code>age</code></dt><dd><p>age of patient at day of surgery (years).</p>
</dd>
<dt><code>time</code></dt><dd><p>observed time point, with surgery date as the time 
origin (years).</p>
</dd>
<dt><code>fuyrs</code></dt><dd><p>maximum follow up time, with surgery date as the time 
origin (years).</p>
</dd>
<dt><code>status</code></dt><dd><p>censoring indicator (<code>1 = </code>died and <code>0 = 
  </code>lost at follow up).</p>
</dd>
<dt><code>grad</code></dt><dd><p>valve gradient at follow-up visit.</p>
</dd>
<dt><code>log.grad</code></dt><dd><p>natural log transformation of <code>grad</code>.</p>
</dd>
<dt><code>lvmi</code></dt><dd><p>left ventricular mass index (standardised) at follow-up 
visit.</p>
</dd>
<dt><code>log.lvmi</code></dt><dd><p>natural log transformation of <code>lvmi</code>.</p>
</dd>
<dt><code>ef</code></dt><dd><p>ejection fraction at follow-up visit.</p>
</dd>
<dt><code>bsa</code></dt><dd><p>preoperative body surface area.</p>
</dd>
<dt><code>lvh</code></dt><dd><p>preoperative left ventricular hypertrophy.</p>
</dd>
<dt><code>prenyha</code></dt><dd><p>preoperative New York Heart Association (NYHA) 
classification (<code>1 = </code>I/II and <code>3 = </code>III/IV).</p>
</dd>
<dt><code>redo</code></dt><dd><p>previous cardiac surgery.</p>
</dd>
<dt><code>size</code></dt><dd><p>size of the valve (millimeters).</p>
</dd>
<dt><code>con.cabg</code></dt><dd><p>concomitant coronary artery bypass graft.</p>
</dd>
<dt><code>creat</code></dt><dd><p>preoperative serum creatinine (<code class="reqn">\mu</code>mol/mL).</p>
</dd>
<dt><code>dm</code></dt><dd><p>preoperative diabetes.</p>
</dd>
<dt><code>acei</code></dt><dd><p>preoperative use of ace inhibitor.</p>
</dd>
<dt><code>lv</code></dt><dd><p>preoperative left ventricular ejection fraction (LVEF) 
(<code>1 = </code>good, <code>2 = </code>moderate, and <code>3 = </code>poor).</p>
</dd>
<dt><code>emergenc</code></dt><dd><p>operative urgency (<code>0 = </code>elective, <code>1 = 
  </code>urgent, and <code>3 = </code>emergency).</p>
</dd>
<dt><code>hc</code></dt><dd><p>preoperative high cholesterol (<code>0 = </code>absent, <code>1 
  = </code>present treated, and <code>2 = </code>present untreated).</p>
</dd>
<dt><code>sten.reg.mix</code></dt><dd><p>aortic valve haemodynamics (<code>1 = </code>stenosis,
<code>2 = </code>regurgitation, <code>3 = </code>mixed).</p>
</dd>
<dt><code>hs</code></dt><dd><p>implanted aortic prosthesis type (<code>1 = </code>homograft 
and <code>0 = </code>stentless porcine tissue).</p>
</dd>
</dl>



<h3>References</h3>

<p>Lim E, Ali A, Theodorou P, Sousa I, Ashrafian H, Chamageorgakis T, Duncan M, 
Diggle P, Pepper J. A longitudinal study of the profile and predictors of 
left ventricular mass regression after stentless aortic valve replacement. 
<em>Ann Thorac Surg.</em> 2008; <strong>85(6)</strong>: 2026-2029.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mental">mental</a></code>, <code><a href="#topic+liver">liver</a></code>, <code><a href="#topic+epileptic">epileptic</a></code>,
<code><a href="#topic+aids">aids</a></code>.
</p>

<hr>
<h2 id='joineR'>joineR</h2><span id='topic+joineR'></span>

<h3>Description</h3>

<p>The joineR package implements methods for analyzing data from
longitudinal studies in which the response from each subject consists of a
time-sequence of repeated measurements and a possibly censored
time-to-event outcome. The modelling framework for the repeated
measurements is the linear model with random effects and/or correlated
error structure (Laird and Ware, 1982). The model for the time-to-event
outcome is a: Cox proportional hazards model with log-Gaussian frailty
(Cox, 1972). A cause-specific hazards model is used when competing risks
are present. Stochastic dependence is captured by allowing the Gaussian
random effects of the linear model to be correlated with the frailty term
of the Cox proportional hazards model. The methodology used to fit the
model is described in Henderson et al. (2002) in the case of a single event
time, and by Williamson et al. (2008) in the case of competing risks data.
Both models exploit the general methodology proposed by Wulfsohn and
Tsiatis (1997).
</p>
<p>The package offers several types of functions for the analysis of joint data.
</p>


<h3>Data manipulation functions</h3>

<p>There are several functions, including <code>jointdata</code>,
<code>sample.jointdata</code>, <code>subset.jointdata</code>, <code>to.balanced</code>,
<code>to.unbalanced</code>, and <code>UniqueVariables</code>, which offer the ability
to construct a joint model dataset and manipulate it, e.g. take a sample
according to a baseline covariate or outcome.
</p>


<h3>Plot functions</h3>

<p>The plot function can be applied to <code>jointdata</code> and <code>vargm</code>
(variogram) objects. In addition, <code>points</code> and <code>lines</code> can also
be used with <code>jointplot</code> objects.
</p>


<h3>Model fitting functions</h3>

<p>The primary function for fitting a joint model is <code>joint</code>. Standard
errors can be estimated using <code>jointSE</code>.
</p>


<h3>Note</h3>

<p>Further details on the package are given in the vignette. To access
this, run <code>vignette("joineR")</code>.
</p>


<h3>References</h3>

<p>Wulfsohn MS, Tsiatis AA. A joint model for survival and longitudinal data 
measured with error. <em>Biometrics.</em> 1997; <strong>53(1)</strong>: 330-339.
</p>
<p>Henderson R, Diggle PJ, Dobson A. Joint modelling of longitudinal 
measurements and event time data. <em>Biostatistics.</em> 2000; <strong>1(4)</strong>: 
465-480.
</p>
<p>Cox DR. Regression models and life-tables. <em>J R Stat Soc Ser B Stat
Methodol.</em> 1972; <strong>34(2)</strong>: 187-220.
</p>
<p>Laird NM, Ware JH. Random-effects models for longitudinal data.
<em>Biometrics.</em> 1982; <strong>38(4)</strong>: 963-974.
</p>
<p>Williamson PR, Kolamunnage-Dona R, Philipson P, Marson AG. Joint modelling of
longitudinal and competing risks data. <em>Stat Med.</em> 2008; <strong>27</strong>:
6426-6438.
</p>

<hr>
<h2 id='joint'>Fit joint model for survival and longitudinal data measured with error</h2><span id='topic+joint'></span>

<h3>Description</h3>

<p>This generic function fits a joint model with random latent
association, building on the formulation described in Wulfsohn and Tsiatis
(1997) while allowing for the presence of longitudinal and survival
covariates, and three choices for the latent process. The link between the
longitudinal and survival processes can be proportional or separate. When
failure is attributable to 2 separate causes, a competing risks joint model
is fitted as per Williamson et al. (2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>joint(
  data,
  long.formula,
  surv.formula,
  model = c("intslope", "int", "quad"),
  sepassoc = FALSE,
  longsep = FALSE,
  survsep = FALSE,
  gpt,
  lgpt,
  max.it,
  tol,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="joint_+3A_data">data</code></td>
<td>
<p>an object of class <code>jointdata</code> containing the variables
named in the formulae arguments.</p>
</td></tr>
<tr><td><code id="joint_+3A_long.formula">long.formula</code></td>
<td>
<p>a formula object with the response variable, and the
covariates to include in the longitudinal sub-model.</p>
</td></tr>
<tr><td><code id="joint_+3A_surv.formula">surv.formula</code></td>
<td>
<p>a formula object with the survival time, censoring
indicator and the covariates to include in the survival sub-model. The
response must be a survival object as returned by the
<code><a href="survival.html#topic+Surv">Surv</a></code> function.</p>
</td></tr>
<tr><td><code id="joint_+3A_model">model</code></td>
<td>
<p>a character string specifying the type of latent association.
This defaults to the intercept and slope version as seen in Wulfsohn and
Tsiatis (1997). For association via the random intercept only, choose
<code>model = "int"</code>, whereas for a quadratic association, use <code>model
= "quad"</code>. Computing times are commensurate with the type of association
structure chosen.</p>
</td></tr>
<tr><td><code id="joint_+3A_sepassoc">sepassoc</code></td>
<td>
<p>logical value: if <code>TRUE</code> then the joint model is fitted
with separate association, see <code>Details</code>.</p>
</td></tr>
<tr><td><code id="joint_+3A_longsep">longsep</code></td>
<td>
<p>logical value: if <code>TRUE</code>, parameter estimates and
log-likelihood from a separate linear mixed model analysis of the
longitudinal data (see the <code><a href="nlme.html#topic+lme">lme</a></code> function for details)
are returned.</p>
</td></tr>
<tr><td><code id="joint_+3A_survsep">survsep</code></td>
<td>
<p>if <code>TRUE</code>, parameter estimates and log-likelihood from a
separate analysis of the survival data using the Cox proportional hazards
model are returned (see <code><a href="survival.html#topic+coxph">coxph</a></code> function for
details).</p>
</td></tr>
<tr><td><code id="joint_+3A_gpt">gpt</code></td>
<td>
<p>the number of quadrature points across which the integration with
respect to the random effects will be performed. Defaults to <code>gpt = 3</code>
which produces stable estimates in most datasets.</p>
</td></tr>
<tr><td><code id="joint_+3A_lgpt">lgpt</code></td>
<td>
<p>the number of quadrature points which the log-likelihood is
evaluated over following a model fit. This defaults to <code>lgpt = 10</code>,
though <code>lgpt = 3</code> is often sufficient.</p>
</td></tr>
<tr><td><code id="joint_+3A_max.it">max.it</code></td>
<td>
<p>the maximum number of iterations of the EM algorithm that the
function will perform. Defaults to <code>max.it = 200</code>, though more
iterations may be necessary for large, complex data.</p>
</td></tr>
<tr><td><code id="joint_+3A_tol">tol</code></td>
<td>
<p>the tolerance level before convergence of the algorithm is deemed
to have occurred. Default value is <code>tol = 0.001</code>.</p>
</td></tr>
<tr><td><code id="joint_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code>, the parameter estimates at each iteration of
the EM algorithm are printed. Default is <code>verbose = FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>joint</code> function fits a joint model to survival and 
longitudinal data. The formulation is similar to Wulfsohn and Tsiatis 
(1997). A linear mixed effects model is assumed for the longitudinal data,
namely
</p>
<p style="text-align: center;"><code class="reqn">Y_i = X_{i1}(t_i)^T\beta_1 + D_i(t_i)^T U_i + \epsilon_i,</code>
</p>

<p>where <code class="reqn">U_i</code> is a vector of random effects, <code class="reqn">(U_{0i}, \ldots 
  U_{qi})</code> whose length depends on the model chosen, i.e. <code class="reqn">q = 1</code> for the
random intercept model. <code class="reqn">D_i</code> is the random effects covariate matrix, 
which will be time-dependent for all but the random intercept model. 
<code class="reqn">X_{i1}</code> is the longitudinal design matrix for unit <code class="reqn">i</code>, and 
<code class="reqn">t_i</code> is the vector of measurement times for subject <code class="reqn">i</code>. 
Measurement error is represented by <code class="reqn">\epsilon_i</code>.
</p>
<p>The Cox proportional hazards model is adopted for the survival data, namely
</p>
<p style="text-align: center;"><code class="reqn">\lambda(t) = \lambda_0(t) \exp\{{X_{i2}(t)^T \beta_2 + 
  D_i(t)(\gamma^T U_i)}\}.</code>
</p>

<p>The parameter <code class="reqn">\gamma</code> determines the level of association between the 
two processes. For the intercept and slope model with separate association 
we have
</p>
<p style="text-align: center;"><code class="reqn">D_i(t) (\gamma^T U_i) = \gamma_0 U_{0i} + \gamma_1 U_{1i} t,</code>
</p>

<p>whereas under proportional association
</p>
<p style="text-align: center;"><code class="reqn">D_i(t)(\gamma^T U_i) = \gamma (U_{0i} + U_{1i} t).</code>
</p>

<p><code class="reqn">X_{i2}</code> is the vector of survival covariates for unit <code class="reqn">i</code>. The 
baseline hazard function is <code class="reqn">\lambda_0(t)</code>.
</p>
<p>The function uses an EM algorithm to estimate parameters in the joint
model. Starting values are provided by calls to standard R functions
<code><a href="nlme.html#topic+lme">lme</a></code> and <code><a href="survival.html#topic+coxph">coxph</a></code> for the
longitudinal and survival components, respectively.
</p>


<h3>Value</h3>

<p>A list containing the parameter estimates from the joint model and,
if required, from either or both of the separate analyses. The combined
log-likelihood from a separate analysis and the log-likelihood from the
joint model are also produced as part of the fit.
</p>


<h3>Competing risks</h3>

<p>If failure can be attributed to 2 causes, i.e. 
so-called competing risks events data, then a cause-specific hazards model
is adopted, namely
</p>
<p style="text-align: center;"><code class="reqn">\lambda_g(t) = \lambda_{0g}(t) \exp\{{X_{i2}(t)^T \beta_2^{(g)} + 
  D_i(t)(\gamma^T U_i)}\},</code>
</p>

<p>where <code class="reqn">g = 1,2</code> denotes the failure type, <code class="reqn">\beta_2^{(g)}</code> (<code class="reqn">g =
  1,2</code>) are cause-specific hazard parameters corresponding to the same 
covariates, and <code class="reqn">\lambda_{0g}(t)</code> are cause-specific baseline hazard 
functions. For this data, a proportional association structure is assumed 
(i.e. <code>sepassoc = FALSE</code>) and a random-intercepts and random-slopes 
model must be used (i.e. <code>model = "intslope"</code>). Note that the function
only permits 2 failure types. The model is specified in full by Williamson
et al. (2008). The function <code>joint()</code> automatically detects whether
competing risks are present by counting the number of unique components in
the event column on the event time data.
</p>


<h3>Separate models</h3>

<p>Both <code>longsep</code> and <code>survsep</code> ignore any
latent association (i.e. <code class="reqn">\gamma = 0</code>) between the longitudinal and
survival processes but their output can be used to compare with the results
from the joint model. If interest is solely in the individual processes
then the user should instead make use of the functions
<code><a href="nlme.html#topic+lme">lme</a></code> and <code><a href="survival.html#topic+coxph">coxph</a></code> mentioned above.
Furthermore, if interest is in the separate effect of each random effect
(this is for intercept and slope or quadratic models only) upon the
survival data, the user should set <code>sepassoc = TRUE</code>.
</p>


<h3>Note</h3>

<p>Since numerical integration is required, it is advisable to check the
stability of the maximum likelihood estimates with an increasing number of
Gauss-Hermite quadrature points. <code>joint()</code> uses <code>gpt = 3</code> by
default, as this has been adequate for many datasets. However, for certain
datasets and models, this might be too small.
</p>


<h3>Author(s)</h3>

<p>Pete Philipson
</p>


<h3>References</h3>

<p>Wulfsohn MS, Tsiatis AA. A joint model for survival and longitudinal data
measured with error. <em>Biometrics.</em> 1997; <strong>53(1)</strong>: 330-339.
</p>
<p>Henderson R, Diggle PJ, Dobson A. Joint modelling of longitudinal
measurements and event time data. <em>Biostatistics.</em> 2000; <strong>1(4)</strong>:
465-480.
</p>
<p>Williamson PR, Kolamunnage-Dona R, Philipson P, Marson AG. Joint modelling of
longitudinal and competing risks data. <em>Stat Med.</em> 2008; <strong>27</strong>:
6426-6438.
</p>


<h3>See Also</h3>

<p><code><a href="nlme.html#topic+lme">lme</a></code>, <code><a href="survival.html#topic+coxph">coxph</a></code>,
<code><a href="#topic+jointdata">jointdata</a></code>, <code><a href="#topic+jointplot">jointplot</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Standard joint model

data(heart.valve)
heart.surv &lt;- UniqueVariables(heart.valve,
                              var.col = c("fuyrs", "status"),
                              id.col = "num")
heart.long &lt;- heart.valve[, c("num", "time", "log.lvmi")]
heart.cov &lt;- UniqueVariables(heart.valve,
                             c("age", "hs", "sex"),
                             id.col = "num")
heart.valve.jd &lt;- jointdata(longitudinal = heart.long,
                            baseline = heart.cov,
                            survival = heart.surv,
                            id.col = "num",
                            time.col = "time")
fit &lt;- joint(data = heart.valve.jd,
             long.formula = log.lvmi ~ 1 + time + hs,
             surv.formula = Surv(fuyrs, status) ~ hs,
             model = "intslope")
             
## Competing risks joint model (same data as Williamson et al. 2008)

## Not run: 
data(epileptic)
epileptic$interaction &lt;- with(epileptic, time * (treat == "LTG"))
longitudinal &lt;- epileptic[, c(1:3, 13)]
survival &lt;- UniqueVariables(epileptic, c(4, 6), "id")
baseline &lt;- UniqueVariables(epileptic, "treat", "id")
data &lt;- jointdata(longitudinal = longitudinal,
                  survival = survival,
                  baseline = baseline,
                  id.col = "id",
                  time.col = "time")
                  
fit2 &lt;- joint(data = data,
              long.formula = dose ~ time + treat + interaction,
              surv.formula = Surv(with.time, with.status2) ~ treat,
              longsep = FALSE, survsep = FALSE,
              gpt = 3)
summary(fit2)

## End(Not run)
</code></pre>

<hr>
<h2 id='joint.object'>Fitted <code>joint</code> object</h2><span id='topic+joint.object'></span>

<h3>Description</h3>

<p>An object returned by the <code>joint</code> function, inheriting from
class <code>joint</code> and representing a fitted joint model for longitudinal
and time-to-event (or competing risks) data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>joint.object
</code></pre>


<h3>Format</h3>

<p>An object of class <code>NULL</code> of length 0.
</p>


<h3>Value</h3>

<p>A list with the following components. </p>

<dl>
<dt><code>coefficients</code></dt><dd><p>a list with the estimated coefficients. The 
components of this list are: </p>

<dl>
<dt><code>fixed</code></dt><dd><p>longitudinal and survival sub-model fixed effects.</p>
</dd>
<dt><code>random</code></dt><dd><p>the BLUPs of the random effects.</p>
</dd>
<dt><code>latent</code></dt><dd><p>the latent association parameter(s) from the
time-to-event sub-model.</p>
</dd>
</dl>
</dd>
<dt><code>sigama.z</code></dt><dd><p>a numeric double for the residual standard error.</p>
</dd>
<dt><code>sigma.u</code></dt><dd><p>the variance-covariance matrix of the random
effects.</p>
</dd>
<dt><code>hazard</code></dt><dd><p>a vector of the (centered) baseline hazards at each
unique failure time.</p>
</dd>
<dt><code>log.lik</code></dt><dd><p>the log-likelihood from the joint model fit and
sub-model contributions.</p>
</dd>
<dt><code>numIter</code></dt><dd><p>the number of EM algorithm iterations.</p>
</dd>
<dt><code>convergence</code></dt><dd><p>a logical value of whether convergence was
achieved or not.</p>
</dd>
<dt><code>model</code></dt><dd><p>see <code><a href="#topic+joint">joint</a></code> for details.</p>
</dd>
<dt><code>sepassoc</code></dt><dd><p>see <code><a href="#topic+joint">joint</a></code> for details.</p>
</dd>
<dt><code>sepests</code></dt><dd><p>see <code><a href="#topic+joint">joint</a></code> for details.</p>
</dd>
<dt><code>compRisk</code></dt><dd><p>a logical value indicating whether competing risks
were detected or not.</p>
</dd>
<dt><code>sep.loglike</code></dt><dd><p>the log-likelihood from the joint model fit (with
association set to zero) and separately fitted sub-model contributions.</p>
</dd>
<dt><code>formulae</code></dt><dd><p>a list of model formulae. See <code><a href="#topic+joint">joint</a></code>
for details.</p>
</dd>
<dt><code>data</code></dt><dd><p>a <code><a href="#topic+jointdata">jointdata</a></code> object. See
<code><a href="#topic+joint">joint</a></code> for details.</p>
</dd>
<dt><code>call</code></dt><dd><p>the model call. Can be used by
<code><a href="stats.html#topic+update">update</a></code>.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Graeme L. Hickey
</p>


<h3>See Also</h3>

<p><code><a href="#topic+joint">joint</a></code>.
</p>

<hr>
<h2 id='jointdata'>Creates an object of class <code>jointdata</code></h2><span id='topic+jointdata'></span>

<h3>Description</h3>

<p>This function creates an object of class <code>jointdata</code>. This
is an object with information on at least one of, longitudinal data or
survival data. Moreover, it can also have data on baseline covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jointdata(
  longitudinal = NA,
  survival = NA,
  baseline = NA,
  id.col = "ID",
  time.col = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jointdata_+3A_longitudinal">longitudinal</code></td>
<td>
<p>a data frame or matrix in the unbalanced format (one row 
per observation), with subject identification, time of measurements, and 
longitudinal measurements and/or time dependent covariates. This must be 
given if no <code>survival</code> argument is.</p>
</td></tr>
<tr><td><code id="jointdata_+3A_survival">survival</code></td>
<td>
<p>a data frame or matrix with survival data for all the 
subjects. This must be given if no <code>longitudinal</code> argument is.</p>
</td></tr>
<tr><td><code id="jointdata_+3A_baseline">baseline</code></td>
<td>
<p>a data frame or matrix with baseline covariates, or non-time 
dependent covariates, for the same subjects as in <code>survival</code> and/or 
<code>longitudinal</code>. This has to be in the balanced format (one row per 
subject). By default an object of this class does not include baseline 
covariates.</p>
</td></tr>
<tr><td><code id="jointdata_+3A_id.col">id.col</code></td>
<td>
<p>an element of class <code>character</code> with the name 
identification of subject. This is to identify the subject identification
in the data frames.</p>
</td></tr>
<tr><td><code id="jointdata_+3A_time.col">time.col</code></td>
<td>
<p>an element of class <code>character</code> with the time 
measurements identification. This is to identify the time column in the
data frames.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates an object of class <code>jointdata</code>. This is a
list with elements used in joint modelling, mainly longitudinal and/or
survival data. The output has to have at least one of the data sets,
longitudinal or survival. However, for joint modelling is necessary to have
both data sets. Moreover, a third data frame is possible to be given as
input, for the baseline (non-time dependent) covariates. The subject
identification and time measurement column names are necessary.
</p>


<h3>Value</h3>

<p>A list of length six. The first element is the vector of subjects
identification. The second is, if exists a data frame of the longitudinal
data. The third element of the list is, if exists a data frame of the
survival data. The fourth element of the list is, if exists a data frame on
the baseline covariates. The fifth is, if longitudinal data is given, the
column name identification of longitudinal times. And the sixth and last
element of the list is the column name identification of subjects.
</p>


<h3>Author(s)</h3>

<p>Ines Sousa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(heart.valve)
heart.surv &lt;- UniqueVariables(heart.valve,
                              var.col = c("fuyrs", "status"), 
                              id.col = "num")
heart.valve.jd &lt;- jointdata(survival = heart.surv, 
                            id.col = "num",
                            time.col = "time")
</code></pre>

<hr>
<h2 id='jointplot'>Joint plot of longitudinal and survival data</h2><span id='topic+jointplot'></span>

<h3>Description</h3>

<p>This function views the longitudinal profile of each unit with
the last longitudinal measurement prior to event-time (censored or not)
taken as the end-point, referred to as time zero. In doing so, the shape of
the profile prior to event-time can be inspected. This can be done over a
user-specified number of time units.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jointplot(
  object,
  Y.col,
  Cens.col,
  lag,
  split = TRUE,
  col1,
  col2,
  xlab,
  ylab,
  gp1lab,
  gp2lab,
  smooth = 2/3,
  mean.profile = FALSE,
  mcol1,
  mcol2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jointplot_+3A_object">object</code></td>
<td>
<p>an object of class <code>jointdata</code>.</p>
</td></tr>
<tr><td><code id="jointplot_+3A_y.col">Y.col</code></td>
<td>
<p>an element of class <code>character</code> identifying the 
longitudinal response part of the <code>jointdata</code> object.</p>
</td></tr>
<tr><td><code id="jointplot_+3A_cens.col">Cens.col</code></td>
<td>
<p>an element of class <code>character</code> identifying the survival
status or censoring indicator part of the <code>jointdata</code> object.</p>
</td></tr>
<tr><td><code id="jointplot_+3A_lag">lag</code></td>
<td>
<p>argument which specifies how many units in time we look back 
through. Defaults to the maximum observation time across all units.</p>
</td></tr>
<tr><td><code id="jointplot_+3A_split">split</code></td>
<td>
<p>logical argument which allows the profiles of units which 
<em>fail</em> and those which are <em>censored</em> to be viewed in separate 
panels of the same graph. This is the default option. Using <code>split =
FALSE</code> will plot all profiles overlaid on a single plot.</p>
</td></tr>
<tr><td><code id="jointplot_+3A_col1">col1</code></td>
<td>
<p>argument to choose the colour for the profiles of the 
<em>censored</em> units.</p>
</td></tr>
<tr><td><code id="jointplot_+3A_col2">col2</code></td>
<td>
<p>argument to choose the colour for the profiles of the 
<em>failed</em> units.</p>
</td></tr>
<tr><td><code id="jointplot_+3A_xlab">xlab</code></td>
<td>
<p>an element of class <code>character</code> indicating the title for the
x-axis.</p>
</td></tr>
<tr><td><code id="jointplot_+3A_ylab">ylab</code></td>
<td>
<p>an element of class <code>character</code> indicating the title for the
x-axis.</p>
</td></tr>
<tr><td><code id="jointplot_+3A_gp1lab">gp1lab</code></td>
<td>
<p>an element of class <code>character</code> for the group 
corresponding to a censoring indicator of zero. Typically, the censored 
group.</p>
</td></tr>
<tr><td><code id="jointplot_+3A_gp2lab">gp2lab</code></td>
<td>
<p>an element of class <code>character</code> for the group 
corresponding to a censoring indicator of one. Typically, the group 
experiencing the event of interest.</p>
</td></tr>
<tr><td><code id="jointplot_+3A_smooth">smooth</code></td>
<td>
<p>the smoother span. This gives the proportion of points in the 
plot which influence the smooth at each value. Defaults to a value of 2/3. 
Larger values give more smoothness. See <code><a href="stats.html#topic+lowess">lowess</a></code> for 
further details.</p>
</td></tr>
<tr><td><code id="jointplot_+3A_mean.profile">mean.profile</code></td>
<td>
<p>draw mean profiles if TRUE. Only applies to the 
<code>split = TRUE</code> case.</p>
</td></tr>
<tr><td><code id="jointplot_+3A_mcol1">mcol1</code></td>
<td>
<p>argument to choose the colour for the mean profile of the units 
with a censoring indicator of zero.</p>
</td></tr>
<tr><td><code id="jointplot_+3A_mcol2">mcol2</code></td>
<td>
<p>argument to choose the colour for the mean profile of the units 
with a censoring indicator of one.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function tailors the <code><a href="lattice.html#topic+xyplot">xyplot</a></code> function to 
produce a representation of joint data with longitudinal and survival 
components.
</p>


<h3>Value</h3>

<p>A lattice plot.
</p>


<h3>Note</h3>

<p>If more than one cause of failure is present (i.e. competing risks
data), then all failures are pooled together into a single failure type.
</p>


<h3>Author(s)</h3>

<p>Pete Philipson
</p>


<h3>References</h3>

<p>Wulfsohn MS, Tsiatis AA. A joint model for survival and longitudinal data 
measured with error. <em>Biometrics.</em> 1997; <strong>53(1)</strong>: 330-339.
</p>


<h3>See Also</h3>

<p><code><a href="lattice.html#topic+xyplot">xyplot</a></code>, <code><a href="#topic+joint">joint</a></code>, 
<code><a href="#topic+jointdata">jointdata</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(heart.valve)
heart.surv &lt;- UniqueVariables(heart.valve, 
                              var.col = c("fuyrs", "status"),
                              id.col = "num")
heart.long &lt;- heart.valve[, c("num", "time", "log.lvmi")]
heart.cov &lt;- UniqueVariables(heart.valve, 
                             c("age", "sex"), 
                             id.col = "num")
heart.valve.jd &lt;- jointdata(longitudinal = heart.long, 
                            baseline = heart.cov, 
                            survival = heart.surv,
                            id.col = "num",
                            time.col = "time")
jointplot(heart.valve.jd, Y.col = "log.lvmi", 
          Cens.col = "status", lag = 5)
</code></pre>

<hr>
<h2 id='jointSE'>Standard errors via bootstrap for a joint model fit</h2><span id='topic+jointSE'></span>

<h3>Description</h3>

<p>This function takes a model fit from a joint model and
calculates standard errors, with optional confidence intervals, for the
main longitudinal and survival covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jointSE(fitted, n.boot, gpt, lgpt, max.it, tol, print.detail = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jointSE_+3A_fitted">fitted</code></td>
<td>
<p>a list containing as components the parameter estimates 
obtained by fitting a joint model along with the respective formulae for 
the longitudinal and survival sub-models and the model chosen, see 
<code>joint</code> for further details.</p>
</td></tr>
<tr><td><code id="jointSE_+3A_n.boot">n.boot</code></td>
<td>
<p>argument specifying the number of bootstrap samples to use in 
order to obtain the standard error estimates and confidence intervals. Note
that at least <code>n.boot = 100</code> is required in order for the function to 
return non-zero confidence intervals.</p>
</td></tr>
<tr><td><code id="jointSE_+3A_gpt">gpt</code></td>
<td>
<p>the number of quadrature points across which the integration with
respect to the random effects will be performed. Defaults to <code>gpt = 3</code>
which produces stable estimates in most datasets.</p>
</td></tr>
<tr><td><code id="jointSE_+3A_lgpt">lgpt</code></td>
<td>
<p>the number of quadrature points which the log-likelihood is
evaluated over following a model fit. This defaults to <code>lgpt = 10</code>,
though <code>lgpt = 3</code> is often sufficient.</p>
</td></tr>
<tr><td><code id="jointSE_+3A_max.it">max.it</code></td>
<td>
<p>the maximum number of iterations of the EM algorithm that the
function will perform. Defaults to <code>max.it = 200</code>, though more
iterations may be necessary for large, complex data.</p>
</td></tr>
<tr><td><code id="jointSE_+3A_tol">tol</code></td>
<td>
<p>the tolerance level before convergence of the algorithm is deemed
to have occurred. Default value is <code>tol = 0.001</code>.</p>
</td></tr>
<tr><td><code id="jointSE_+3A_print.detail">print.detail</code></td>
<td>
<p>This argument determines the level of printing that is 
done during the bootstrapping. If <code>TRUE</code> then the parameter estimates 
from each bootstrap sample are output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Standard errors and confidence intervals are obtained by repeated 
fitting of the requisite joint model to bootstrap samples of the original 
longitudinal and survival data. It is rare that more than 200 bootstrap 
samples are needed for estimating a standard error. The number of bootstrap
samples needed for accurate confidence intervals can be as large as 1000.
</p>


<h3>Value</h3>

<p>An object of class <code>data.frame</code>.
</p>


<h3>Author(s)</h3>

<p>Ruwanthi Kolamunnage-Dona and Pete Philipson
</p>


<h3>References</h3>

<p>Wulfsohn MS, Tsiatis AA. A joint model for survival and longitudinal data 
measured with error. <em>Biometrics.</em> 1997; <strong>53(1)</strong>: 330-339.
</p>
<p>Efron B, Tibshirani R. <em>An Introduction to the Bootstrap.</em> 2000; Boca 
Raton, FL: Chapman &amp; Hall/CRC.
</p>


<h3>See Also</h3>

<p><code><a href="nlme.html#topic+lme">lme</a></code>, <code><a href="survival.html#topic+coxph">coxph</a></code>, 
<code><a href="#topic+joint">joint</a></code>, <code><a href="#topic+jointdata">jointdata</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(heart.valve)
heart.surv &lt;- UniqueVariables(heart.valve, 
                              var.col = c("fuyrs", "status"), 
                              id.col = "num")
heart.long &lt;- heart.valve[, c("num", "time", "log.lvmi")]
heart.cov &lt;- UniqueVariables(heart.valve, 
                             c("age", "hs", "sex"), 
                             id.col = "num")
heart.valve.jd &lt;- jointdata(longitudinal = heart.long, 
                            baseline = heart.cov, 
                            survival = heart.surv, 
                            id.col = "num", 
                            time.col = "time")
fit &lt;- joint(heart.valve.jd, 
             long.formula = log.lvmi ~ 1 + time + hs, 
             surv.formula = Surv(fuyrs, status) ~ hs, 
             model = "int")
jointSE(fitted = fit, n.boot = 1)
</code></pre>

<hr>
<h2 id='lines.jointdata'>Add lines to an existing <code>jointdata</code> plot</h2><span id='topic+lines.jointdata'></span>

<h3>Description</h3>

<p>Add lines to an existing plot of an object of class
<code>jointdata</code>, for a longitudinal variable. It is possible to plot all
the subjects in the data set, or just a selected <code>subset</code>. See
<code><a href="#topic+subset.jointdata">subset.jointdata</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'jointdata'
lines(x, Y.col, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lines.jointdata_+3A_x">x</code></td>
<td>
<p>object of class <code>jointdata</code>.</p>
</td></tr>
<tr><td><code id="lines.jointdata_+3A_y.col">Y.col</code></td>
<td>
<p>column number, or column name, of longitudinal variable to be 
plotted. Defaults to <code>Y.col = NA</code>, plotting all longitudinal
variables.</p>
</td></tr>
<tr><td><code id="lines.jointdata_+3A_...">...</code></td>
<td>
<p>other graphical arguments; see <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A graphical device with a plot for longitudinal data.
</p>


<h3>Author(s)</h3>

<p>Ines Sousa
</p>


<h3>See Also</h3>

<p>Other functions are useful to be used with this such as
<code><a href="graphics.html#topic+plot">plot</a></code> and <code><a href="graphics.html#topic+points">points</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(heart.valve)
heart.surv &lt;- UniqueVariables(heart.valve, 
                              var.col = c("fuyrs", "status"), 
                              id.col = "num")
heart.long &lt;- heart.valve[, c(1, 4, 5, 7, 8, 9, 10, 11)]
heart.jd &lt;- jointdata(longitudinal = heart.long, 
                      survival = heart.surv,
                      id.col = "num",
                      time.col = "time")
                      
# Randomly select a pair of subjects to plot profiles of
take &lt;- sample(1:max(heart.jd$survival$num), 2)
heart.jd.1 &lt;- subset(heart.jd, take[1])
heart.jd.2 &lt;- subset(heart.jd, take[2])

plot(heart.jd.1, Y.col = 4)
lines(heart.jd.2, Y.col = 4, lty = 2)
</code></pre>

<hr>
<h2 id='liver'>Liver cirrhosis drug trial data</h2><span id='topic+liver'></span>

<h3>Description</h3>

<p>This dataset gives the longitudinal observations of prothrombin 
index, a measure of liver function, for patients from a controlled trial 
into prednisone treatment of liver cirrhosis. Time-to-event information in 
the form of the event time and associated censoring indicator are also 
recorded along with a solitary baseline covariate - the allocated treatment
arm in this instance. The data are taken from Andersen et al. (1993, p. 19)
and were analyzed in Henderson et al. (2002). This is a subset of the full 
data where a number of variables were recorded both at entry and during the
course of the trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(liver)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> in the unbalanced format with longitudinal observations 
from 488 subjects. The columns are:
</p>

<dl>
<dt><code>id</code></dt><dd><p>integer: number for patient identification.</p>
</dd>
<dt><code>prothrombin</code></dt><dd><p>integer: prothrombin index measurement (%).</p>
</dd>
<dt><code>time</code></dt><dd><p>numeric: time of prothrombin index measurement (years).</p>
</dd>
<dt><code>treatment</code></dt><dd><p>integer: patient treatment indicator. Coded as 
<code>0 = </code>placebo; <code>1 = </code>prednisone.</p>
</dd>
<dt><code>survival</code></dt><dd><p>numeric: patient survival time (years).</p>
</dd>
<dt><code>cens</code></dt><dd><p>integer: censoring indicator. Coded as <code>1 = </code>died; 
<code>0 = </code>censored.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Skrondal A, Rabe-Hesketh S. <em>Generalized Latent Variable
Modeling: Multilevel, Longitudinal and Structural Equation Models.</em> Chapman
&amp; Hall/CRC. 2004. URL: <a href="http://www.gllamm.org/books/readme.html#14.6">http://www.gllamm.org/books/readme.html#14.6</a>.
</p>


<h3>References</h3>

<p>Andersen PK, Borgan O, Gill RD, Kieding N. <em>Statistical Models Based on 
Counting Processes</em>. New York: Springer. 2003.
</p>
<p>Henderson R, Diggle PJ, Dobson A. Identification and efficacy of longitudinal
markers for survival. <em>Biostatistics</em> 2002; <strong>3</strong>: 33-50.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+heart.valve">heart.valve</a></code>, <code><a href="#topic+epileptic">epileptic</a></code>, 
<code><a href="#topic+mental">mental</a></code>, <code><a href="#topic+aids">aids</a></code>.
</p>

<hr>
<h2 id='mental'>Mental health trial data</h2><span id='topic+mental'></span>

<h3>Description</h3>

<p>The data is obtained from a trial in which chronically ill
mental health patients were randomized across two treatments: placebo and
an active drug. A questionnaire instrument was used to assess each
patient's mental state at weeks 0, 1, 2, 4, 6 and 8 post-randomisation, a
high recorded score implying a severe condition. Some of the 100 patients
dropped out of the study for reasons that were thought to be related to
their mental state, and therefore potentially informative; others dropped
out for reasons unrelated to their mental state.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mental)
</code></pre>


<h3>Format</h3>

<p>A balanced data set with respect to the times at which observations 
recorded. The data consists of the following variables on each patient:
</p>

<dl>
<dt><code>id</code></dt><dd><p>integer: patient identifier.</p>
</dd>
<dt><code>Y.t0</code></dt><dd><p>integer: mental state assessment in week 0. Coded
<code>NA</code> if missing.</p>
</dd>
<dt><code>Y.t1</code></dt><dd><p>integer: mental state assessment in week 1. Coded
<code>NA</code> if missing.</p>
</dd>
<dt><code>Y.t2</code></dt><dd><p>integer: mental state assessment in week 2. Coded
<code>NA</code> if missing.</p>
</dd>
<dt><code>Y.t4</code></dt><dd><p>integer: mental state assessment in week 4. Coded
<code>NA</code> if missing.</p>
</dd>
<dt><code>Y.t6</code></dt><dd><p>integer: mental state assessment in week 6. Coded
<code>NA</code> if missing.</p>
</dd>
<dt><code>Y.t8</code></dt><dd><p>integer: mental state assessment in week 8. Coded
<code>NA</code> if missing.</p>
</dd>
<dt><code>treat</code></dt><dd><p>integer: treatment allocation. Coded as <code>0 =
  </code>placebo; <code>1 = </code>active drug.</p>
</dd>
<dt><code>n.obs</code></dt><dd><p>integer: number of non-missing mental state 
assessments.</p>
</dd>
<dt><code>surv.time</code></dt><dd><p>numeric: imputed dropout time in weeks. Coded as
<code>surv.time = 8.002</code> for completers.</p>
</dd>
<dt><code>cens.ind</code></dt><dd><p>integer: censoring indicator. Coded as <code>0 =
  </code>completer or non-informative dropout; <code>1 = </code>potentially informative
dropout.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Peter J. Diggle (p.diggle@lancaster.ac.uk)
</p>


<h3>References</h3>

<p>Henderson R, Diggle PJ, Dobson A. Joint modelling of longitudinal 
measurements and event time data. <em>Biostatistics.</em> 2000; <strong>1(4)</strong>: 
465-480.
</p>
<p>Diggle PJ, Farewell D, Henderson R. Longitudinal data with dropout:
objectives, assumptions and a proposal (with Discussion). <em>Applied
Statistics.</em> 2007; <strong>56</strong>: 499-550.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+heart.valve">heart.valve</a></code>, <code><a href="#topic+liver">liver</a></code>, 
<code><a href="#topic+epileptic">epileptic</a></code>.
</p>

<hr>
<h2 id='plot.jointdata'>Plot longitudinal data</h2><span id='topic+plot.jointdata'></span>

<h3>Description</h3>

<p>Plot longitudinal data of an object of class <code>jointdata</code>,
for a longitudinal variable. It is possible to plot all the subjects in the
data set, or just a selected <code>subset</code>. See
<code><a href="#topic+subset.jointdata">subset.jointdata</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'jointdata'
plot(x, Y.col, type, xlab, xlim = NULL, ylim = NULL, main = NA, pty, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.jointdata_+3A_x">x</code></td>
<td>
<p>object of class <code>jointdata</code>.</p>
</td></tr>
<tr><td><code id="plot.jointdata_+3A_y.col">Y.col</code></td>
<td>
<p>column number, or column name, of longitudinal variable to be 
plotted. Defaults to <code>Y.col = NA</code>, plotting all longitudinal
variables.</p>
</td></tr>
<tr><td><code id="plot.jointdata_+3A_type">type</code></td>
<td>
<p>the type of line to be plotted, see <code><a href="graphics.html#topic+plot">plot</a></code>
for further details.</p>
</td></tr>
<tr><td><code id="plot.jointdata_+3A_xlab">xlab</code></td>
<td>
<p>a title for the x-axis, see <code><a href="graphics.html#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="plot.jointdata_+3A_xlim">xlim</code>, <code id="plot.jointdata_+3A_ylim">ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the x and y coordinates 
ranges, see <code><a href="graphics.html#topic+plot.window">plot.window</a></code> for further details.</p>
</td></tr>
<tr><td><code id="plot.jointdata_+3A_main">main</code></td>
<td>
<p>an overall title for the plot; see <code><a href="graphics.html#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="plot.jointdata_+3A_pty">pty</code></td>
<td>
<p>a character specifying the type of plot region to be used, see 
<code><a href="graphics.html#topic+par">par</a></code> for details.</p>
</td></tr>
<tr><td><code id="plot.jointdata_+3A_...">...</code></td>
<td>
<p>other graphical arguments; see <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A graphical device with a plot for longitudinal data.
</p>


<h3>Author(s)</h3>

<p>Ines Sousa
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+lines">lines</a></code> and <code><a href="graphics.html#topic+points">points</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(heart.valve)
heart.surv &lt;- UniqueVariables(heart.valve,
                              var.col = c("fuyrs", "status"),
                              id.col = "num")
heart.long &lt;- heart.valve[, c(1, 4, 5, 7, 8, 9, 10, 11)]
heart.jd &lt;- jointdata(longitudinal = heart.long, 
                      survival = heart.surv,
                      id.col = "num",
                      time.col = "time")
plot(heart.jd, Y.col = "grad", col = "grey")
</code></pre>

<hr>
<h2 id='plot.vargm'>Plots the empirical variogram for longitudinal data</h2><span id='topic+plot.vargm'></span>

<h3>Description</h3>

<p>Plots the empirical variogram for observed measurements, of an
object of class <code>vargm</code>, obtained by using function
<code><a href="#topic+variogram">variogram</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'vargm'
plot(x, smooth = FALSE, bdw = NULL, follow.time = NULL, points = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.vargm_+3A_x">x</code></td>
<td>
<p>object of class <code>vargm</code> obtained by using function. 
<code><a href="#topic+variogram">variogram</a></code></p>
</td></tr>
<tr><td><code id="plot.vargm_+3A_smooth">smooth</code></td>
<td>
<p>logical value to use a non-parametric estimator to calculate 
the variogram of all <code class="reqn">v_ijk</code>. The default is <code>FALSE</code>, as it uses
time averages.</p>
</td></tr>
<tr><td><code id="plot.vargm_+3A_bdw">bdw</code></td>
<td>
<p>bandwidth to use in the time averages. The default is <code>NULL</code>,
because this is calculated automatically.</p>
</td></tr>
<tr><td><code id="plot.vargm_+3A_follow.time">follow.time</code></td>
<td>
<p>the interval of time we want to construct the variogram 
for. When <code>NULL</code> this is the maximum of the data.</p>
</td></tr>
<tr><td><code id="plot.vargm_+3A_points">points</code></td>
<td>
<p>logical value if the points <code class="reqn">v_ijk</code> should be plotted.</p>
</td></tr>
<tr><td><code id="plot.vargm_+3A_...">...</code></td>
<td>
<p>other graphical options as in <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A graphical device with the plot of empirical variogram.
</p>


<h3>Author(s)</h3>

<p>Ines Sousa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mental)
mental.unbalanced &lt;- to.unbalanced(mental, id.col = 1, 
                                   times = c(0, 1, 2, 4, 6, 8),
                                   Y.col = 2:7, 
                                   other.col = c(8, 10, 11))
names(mental.unbalanced)[3] &lt;- "Y"
vgm &lt;- variogram(indv = tail(mental.unbalanced[, 1], 30),
                 time = tail(mental.unbalanced[, 2], 30),
                 Y = tail(mental.unbalanced[, 3], 30))
plot(vgm)
</code></pre>

<hr>
<h2 id='points.jointdata'>Add points to an existing <code>jointdata</code> plot</h2><span id='topic+points.jointdata'></span>

<h3>Description</h3>

<p>Add points to an existing plot of an object of class
<code>jointdata</code>, for a longitudinal variable. It is possible plot all the
subjects in the data set, or just a selected <code>subset</code>. See
<code><a href="#topic+subset.jointdata">subset.jointdata</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'jointdata'
points(x, Y.col, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="points.jointdata_+3A_x">x</code></td>
<td>
<p>object of class <code>jointdata</code>.</p>
</td></tr>
<tr><td><code id="points.jointdata_+3A_y.col">Y.col</code></td>
<td>
<p>column number, or column name, of longitudinal variable to be 
plotted. Defaults to <code>Y.col = NA</code>, plotting all longitudinal
variables.</p>
</td></tr>
<tr><td><code id="points.jointdata_+3A_...">...</code></td>
<td>
<p>other graphical arguments; see <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A graphical device with a plot for longitudinal data. Other functions
are useful to be used with this as <code><a href="graphics.html#topic+plot">plot</a></code> and 
<code><a href="graphics.html#topic+lines">lines</a></code>.
</p>


<h3>Author(s)</h3>

<p>Ines Sousa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(heart.valve)
heart.surv &lt;- UniqueVariables(heart.valve,
                              var.col = c("fuyrs", "status"),
                              id.col = "num")
heart.long &lt;- heart.valve[, c(1, 4, 5, 7, 8, 9, 10, 11)]
heart.jd &lt;- jointdata(longitudinal = heart.long,
                      survival = heart.surv,
                      id.col = "num",
                      time.col = "time")
                      
# Randomly select a pair of subjects to plot profiles of
take &lt;- sample(1 : max(heart.jd$survival$num), 2)
heart.jd.1 &lt;- subset(heart.jd, take[1])
heart.jd.2 &lt;- subset(heart.jd, take[2])

plot(heart.jd.1, Y.col = "grad", type = "p")
points(heart.jd.2, Y.col = "grad", col = "blue", pch = 20)
</code></pre>

<hr>
<h2 id='sample.jointdata'>Sample from a <code>jointdata</code> x</h2><span id='topic+sample.jointdata'></span>

<h3>Description</h3>

<p>Generic function used to sampling a subset of data from an x of
class <code>jointdata</code>, with a specific size of number of subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample.jointdata(x, size, replace = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample.jointdata_+3A_x">x</code></td>
<td>
<p>an object of class <code>jointdata</code>.</p>
</td></tr>
<tr><td><code id="sample.jointdata_+3A_size">size</code></td>
<td>
<p>number of subjects to include in the sampled subset.</p>
</td></tr>
<tr><td><code id="sample.jointdata_+3A_replace">replace</code></td>
<td>
<p>should sampling be with replacement? Default is <code>replace
= TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>jointdata</code>, with data only on the subjects 
sampled.
</p>


<h3>Author(s)</h3>

<p>Ines Sousa
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+sample">sample</a></code>, <code><a href="#topic+jointdata">jointdata</a></code>, 
<code><a href="#topic+UniqueVariables">UniqueVariables</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(heart.valve)
heart.surv &lt;- UniqueVariables(heart.valve, 
                              var.col = c("fuyrs", "status"), 
                              id.col = "num")
heart.valve.jd &lt;- jointdata(survival = heart.surv, 
                            id.col = "num", 
                            time.col = "time")
sample.jointdata(heart.valve.jd, size = 10)
</code></pre>

<hr>
<h2 id='simjoint'>Simulate data from a joint model</h2><span id='topic+simjoint'></span>

<h3>Description</h3>

<p>This function simulates longitudinal and time-to-event data from
a joint model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simjoint(
  n = 500,
  model = c("intslope", "int", "quad"),
  sepassoc = FALSE,
  ntms = 5,
  b1 = c(1, 1, 1, 1),
  b2 = c(1, 1),
  gamma = c(1, 0.1),
  sigu,
  vare = 0.01,
  theta0 = -3,
  theta1 = 1,
  censoring = TRUE,
  censlam = exp(-3),
  truncation = FALSE,
  trunctime = max(ntms),
  gridstep = 0.01
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simjoint_+3A_n">n</code></td>
<td>
<p>the number of subjects to simulate data for.</p>
</td></tr>
<tr><td><code id="simjoint_+3A_model">model</code></td>
<td>
<p>a character string specifying the type of latent association.
This defaults to the intercept and slope version as seen in Wulfsohn and
Tsiatis (1997). For association via the random intercept only, choose
<code>model = "int"</code>, whereas for a quadratic association, use <code>model
= "quad"</code>. Computing times are commensurate with the type of association
structure chosen.</p>
</td></tr>
<tr><td><code id="simjoint_+3A_sepassoc">sepassoc</code></td>
<td>
<p>logical value: if <code>TRUE</code> then the joint model is fitted
with separate association, see <code>Details</code>.</p>
</td></tr>
<tr><td><code id="simjoint_+3A_ntms">ntms</code></td>
<td>
<p>the maximum number of (discrete) time points to simulate repeated
longitudinal measurements at.</p>
</td></tr>
<tr><td><code id="simjoint_+3A_b1">b1</code></td>
<td>
<p>a vector specifying the coefficients of the fixed effects in the
longitudinal sub-model. The order in each row is intercept, a continuous
covariate, covariate, a binary covariate, the measurement time.</p>
</td></tr>
<tr><td><code id="simjoint_+3A_b2">b2</code></td>
<td>
<p>a vector of <code>length = 2</code> specifying the coefficients for the
time-to-event baseline covariates, in the order of a continuous covariate
and a binary covariate.</p>
</td></tr>
<tr><td><code id="simjoint_+3A_gamma">gamma</code></td>
<td>
<p>a vector of specifying the latent association parameter(s) for
the longitudinal outcome. It must be of length 1 if <code>sepassoc =
FALSE</code>.</p>
</td></tr>
<tr><td><code id="simjoint_+3A_sigu">sigu</code></td>
<td>
<p>a positive-definite matrix specifying the variance-covariance
matrix. If <code>model = "int"</code>, the matrix has dimension <code>dim = c(1,
1)</code>; if <code>model = "intslope"</code>, the matrix has dimension <code>dim =
c(2, 2)</code>; else if <code>model = "quad"</code>, the matrix has dimension <code>dim
= c(3, 3)</code>. If <code>D = NULL</code> (default), an identity matrix is assumed.</p>
</td></tr>
<tr><td><code id="simjoint_+3A_vare">vare</code></td>
<td>
<p>a numeric value specifying the residual standard error.</p>
</td></tr>
<tr><td><code id="simjoint_+3A_theta0">theta0</code>, <code id="simjoint_+3A_theta1">theta1</code></td>
<td>
<p>parameters controlling the failure rate. See Details.</p>
</td></tr>
<tr><td><code id="simjoint_+3A_censoring">censoring</code></td>
<td>
<p>logical: if <code>TRUE</code>, includes an independent censoring
time.</p>
</td></tr>
<tr><td><code id="simjoint_+3A_censlam">censlam</code></td>
<td>
<p>a scale (<code class="reqn">&gt;0</code>) parameter for an exponential distribution
used to simulate random censoring times for when <code>censoring = TRUE</code>.</p>
</td></tr>
<tr><td><code id="simjoint_+3A_truncation">truncation</code></td>
<td>
<p>logical: if <code>TRUE</code>, adds a truncation time for a
maximum event time in the case of <code>model = "int"</code> or <code>model =
"intslope"</code>.</p>
</td></tr>
<tr><td><code id="simjoint_+3A_trunctime">trunctime</code></td>
<td>
<p>a truncation time for use when <code>truncation = TRUE</code>. For
<code>model = "quad"</code>, <code>trunctime</code> is required, and defaults to
<code>max(ntms)</code> if not specified.</p>
</td></tr>
<tr><td><code id="simjoint_+3A_gridstep">gridstep</code></td>
<td>
<p>the step-size for the grid used to simulate event times when
<code>model = "quad"</code>. Default is <code>gridstep = 0.01</code>. See Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>simjoint</code> simulates data from a joint model, 
similar to that performed in Henderson et al. (2000). It works by first 
simulating longitudinal data for all possible follow-up times using random 
draws for the multivariate Gaussian random effects and residual error 
terms. Data can be simulated assuming either random-intercepts only 
(<code>model = "int"</code>) in each of the longitudinal sub-models; 
random-intercepts and random-slopes (<code>model = "intslope"</code>); or 
quadratic random effects structures (<code>model = "quad"</code>). The failure 
times are simulated from proportional hazards time-to-event models, using 
the following methodologies:
</p>

<dl>
<dt><code>model = "int"</code></dt><dd><p>The baseline hazard function is specified to be
an exponential distribution with
</p>
<p style="text-align: center;"><code class="reqn">\lambda_0(t) = \exp{\theta_0}.</code>
</p>

<p>Simulation is conditional on known time-independent effects, and the
methodology of Bender et al. (2005) is used to simulate the failure time.</p>
</dd>
<dt><code>model = "intslope"</code></dt><dd><p>The baseline hazard function is specified
to be a Gompertz distribution with
</p>
<p style="text-align: center;"><code class="reqn">\lambda_0(t) = \exp{\theta_0 + \theta_1 t}.</code>
</p>

<p>In the usual representation of the Gompertz distribution, <code class="reqn">\theta_1</code> is
the shape parameter, and the scale parameter is equivalent to
<code class="reqn">\exp(\theta_0)</code>. Simulation is conditional on on a predictable
(linear) time-varying process, and the methodology of Austin (2012) is used
to simulate the failure time.</p>
</dd>
<dt><code>model="quad"</code></dt><dd><p>The baseline hazard function is specified as per
<code>model="intslope"</code>. The integration technique used for the above two
cases is complex in quadratic (and higher order) models, therefore we use a
different approach. We note that hazard function can be written as
</p>
<p style="text-align: center;"><code class="reqn">\lim_{dt \rightarrow 0} \lambda(t) dt = \lim_{dt \rightarrow 0}
  P[t \le T \le t + dt | T \ge t].</code>
</p>

<p>In the simulation routine the parameter <code>gridstep</code> acts as <code class="reqn">dt</code> in
that we choose a nominally small value, which multiplies the hazard and
this scaled hazard is equivalent to the probability of having an event in
the interval <code class="reqn">(t, t + dt)</code>, or equivalently <code class="reqn">(t, t +
  </code><code>gridstep</code><code class="reqn">)</code>. A vector of possible times is set up for each
individual, ranging from 0 to <code>trunctime</code> in increments of <code class="reqn">dt</code> (or
<code>gridstep</code>). The failure probability at each time is compared to an
independent <code class="reqn">U(0, 1)</code> draw, and if the probability does not exceed the
random draw then the survival time is set as <code>trunctime</code>, otherwise it
is the generated time from the vector of candidate times. The minimum of
these candidate times (i.e. when we deem the event to have first happened)
is taken as the survival time.</p>
</dd>
</dl>



<h3>Value</h3>

<p>A list of 2 <code>data.frame</code>s: one recording the requisite
longitudinal outcomes data, and one recording the time-to-event data.
</p>


<h3>Author(s)</h3>

<p>Pete Philipson
</p>


<h3>References</h3>

<p>Austin PC. Generating survival times to simulate Cox proportional hazards
models with time-varying covariates. <em>Stat Med.</em> 2012; <strong>31(29)</strong>:
3946-3958.
</p>
<p>Bender R, Augustin T, Blettner M. Generating survival times to simulate Cox
proportional hazards models. <em>Stat Med.</em> 2005; <strong>24</strong>: 1713-1723.
</p>
<p>Henderson R, Diggle PJ, Dobson A. Joint modelling of longitudinal
measurements and event time data. <em>Biostatistics.</em> 2000; <strong>1(4)</strong>:
465-480.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>simjoint(10, sepassoc = TRUE)
</code></pre>

<hr>
<h2 id='subset.jointdata'>Subsetting object of class <code>jointdata</code></h2><span id='topic+subset.jointdata'></span>

<h3>Description</h3>

<p>Returns an object of class <code>jointdata</code> which is a subset of
an original object of class <code>jointdata</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'jointdata'
subset(x, subj.subset, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subset.jointdata_+3A_x">x</code></td>
<td>
<p>an object of class <code>jointdata</code>.</p>
</td></tr>
<tr><td><code id="subset.jointdata_+3A_subj.subset">subj.subset</code></td>
<td>
<p>vector of subject identifiers, to include in the data 
subset. This must be a unique vector of patient identifiers.</p>
</td></tr>
<tr><td><code id="subset.jointdata_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>jointdata</code>, with data only on a subset of
subjects.
</p>


<h3>Author(s)</h3>

<p>Ines Sousa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(heart.valve)
heart.surv &lt;- UniqueVariables(heart.valve,
                              var.col = c("fuyrs", "status"),
                              id.col = "num")
heart.long &lt;- heart.valve[, c(1, 4, 5, 7, 8, 9, 10, 11)]
heart.jd &lt;- jointdata(longitudinal = heart.long, 
                      survival = heart.surv,
                      id.col = "num",
                      time.col = "time")
take &lt;- heart.jd$survival$num[heart.jd$survival$status == 0]
heart.jd.cens &lt;- subset(heart.jd, take)
</code></pre>

<hr>
<h2 id='summary.joint'>Summarise a random effects joint model fit</h2><span id='topic+summary.joint'></span>

<h3>Description</h3>

<p>Generic function used to produce summary information from a
fitted random effects joint model as represented by <code>object</code> of class
<code>joint</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'joint'
summary(object, variance = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.joint_+3A_object">object</code></td>
<td>
<p>an object of class <code>joint</code>.</p>
</td></tr>
<tr><td><code id="summary.joint_+3A_variance">variance</code></td>
<td>
<p>should the variance components be output as variances or
standard deviations? Defaults to <code>variance = TRUE</code>.</p>
</td></tr>
<tr><td><code id="summary.joint_+3A_...">...</code></td>
<td>
<p>further arguments for the summary.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object inheriting from class <code>summary.joint</code> with all
components included in <code>object</code> (see <code><a href="#topic+joint">joint</a></code> for a full
description of the components) plus the following components:
</p>
<table>
<tr><td><code>nobs</code></td>
<td>
<p>the total number of (typically longitudinal)
observations (i.e. rows in an unbalanced data set).</p>
</td></tr>
<tr><td><code>ngrps</code></td>
<td>
<p>the number of groups in the analyzed dataset, often
individual subjects.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pete Philipson
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(heart.valve)
heart.surv &lt;- UniqueVariables(heart.valve,
                              var.col = c("fuyrs","status"),
                              id.col = "num")
heart.long &lt;- heart.valve[, c("num", "time", "log.lvmi")]
heart.cov &lt;- UniqueVariables(heart.valve,
                             c("age", "hs", "sex"),
                             id.col = "num")
heart.valve.jd &lt;- jointdata(longitudinal = heart.long,
                            baseline = heart.cov,
                            survival = heart.surv,
                            id.col = "num",
                            time.col = "time")
fit &lt;- joint(data = heart.valve.jd,
             long.formula = log.lvmi ~ 1 + time + hs,
             surv.formula = Surv(fuyrs,status) ~ hs,
             model = "intslope")
summary(fit)
</code></pre>

<hr>
<h2 id='summary.jointdata'>Summarise a <code>jointdata</code> object</h2><span id='topic+summary.jointdata'></span>

<h3>Description</h3>

<p>Generic function used to produce summaries of objects of class 
<code>jointdata</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'jointdata'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.jointdata_+3A_object">object</code></td>
<td>
<p>an object of class <code>joint</code>.</p>
</td></tr>
<tr><td><code id="summary.jointdata_+3A_...">...</code></td>
<td>
<p>further arguments for the summary.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with five elements. Each summarises an element of the
<code>jointdata</code> object:
</p>
<table>
<tr><td><code>subjects</code></td>
<td>
<p>Gives the number of subjects in the data set.</p>
</td></tr>
<tr><td><code>longitudinal</code></td>
<td>
<p>If longitudinal data is available, it gives the
names and class, of the longitudinal variables.</p>
</td></tr>
<tr><td><code>survival</code></td>
<td>
<p>If survival data is available, it gives the number
of subjects with failure and censored survival times.</p>
</td></tr>
<tr><td><code>baseline</code></td>
<td>
<p>If baseline covariates is available, it gives the
names and class, of the baseline covariates.</p>
</td></tr>
<tr><td><code>times</code></td>
<td>
<p>If longitudinal data is available, it gives the unique
longitudinal time measurements, if it is a balanced study. In case of
unbalanced study, it will only state it is an unbalanced study.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ines Sousa
</p>


<h3>See Also</h3>

<p><code><a href="#topic+jointdata">jointdata</a></code>, <code><a href="#topic+UniqueVariables">UniqueVariables</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(heart.valve)
heart.surv &lt;- UniqueVariables(heart.valve,
                              var.col = c("fuyrs", "status"), 
                              id.col = "num")
heart.valve.jd &lt;- jointdata(survival = heart.surv, 
                            id.col = "num",
                            time.col = "time")
summary(heart.valve.jd)
</code></pre>

<hr>
<h2 id='summarybal'>Summary of a balanced longitudinal data set</h2><span id='topic+summarybal'></span>

<h3>Description</h3>

<p>For a balanced longitudinal data set a vector of the mean
response and variances at defined time points is returned along with the
correlation matrix of the responses across the time points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarybal(object, Y.col, times, use = "all.obs", na.rm, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarybal_+3A_object">object</code></td>
<td>
<p>a longitudinal data set in the balanced format.</p>
</td></tr>
<tr><td><code id="summarybal_+3A_y.col">Y.col</code></td>
<td>
<p>the column numbers of the longitudinal measurements at each 
design time point in the <code>object</code>. This does not have to be all of the
longitudinal measurements taken and may be a subset instead.</p>
</td></tr>
<tr><td><code id="summarybal_+3A_times">times</code></td>
<td>
<p>a vector of unique time points of the longitudinal measurements.
This does not have to be all of the study time points and may be a subset
instead, but should match the columns defined in <code>Y.col</code>.</p>
</td></tr>
<tr><td><code id="summarybal_+3A_use">use</code></td>
<td>
<p>an optional character string giving a method for computing 
covariances in the presence of missing values. This must be (an
abbreviation of) one of the strings <code>"all.obs"</code>, <code>"complete.obs"</code>
or <code>"pairwise.complete.obs"</code>. Defaults to <code>use = "all.obs"</code>.</p>
</td></tr>
<tr><td><code id="summarybal_+3A_na.rm">na.rm</code></td>
<td>
<p>logical. Should missing values be removed? By default, 
<code>na.rm = FALSE</code>.</p>
</td></tr>
<tr><td><code id="summarybal_+3A_...">...</code></td>
<td>
<p>further arguments for the summary.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> with three elements:
</p>
<table>
<tr><td><code>mean.vect</code></td>
<td>
<p>a matrix with the time points in the first column
and the mean response vector as the second column.</p>
</td></tr>
<tr><td><code>variance</code></td>
<td>
<p>The vector of variances for the response at the time
points.</p>
</td></tr>
<tr><td><code>cor.mtx</code></td>
<td>
<p>Containing the correlation matrix of the responses
between each pair of time points.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ines Sousa
</p>


<h3>See Also</h3>

<p><code><a href="#topic+to.balanced">to.balanced</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mental)
summarybal(mental, Y.col = 2:7, times = c(0, 1, 2, 4, 6, 8), na.rm = TRUE)
</code></pre>

<hr>
<h2 id='to.balanced'>Transform data to the longitudinal balanced format</h2><span id='topic+to.balanced'></span>

<h3>Description</h3>

<p>Transforms a longitudinal data set in the unbalanced format to
the balanced format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to.balanced(data, id.col, time.col, Y.col, other.col = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="to.balanced_+3A_data">data</code></td>
<td>
<p>a data frame with longitudinal data in the unbalanced format. 
That is, in the format of 'one row per observation'.</p>
</td></tr>
<tr><td><code id="to.balanced_+3A_id.col">id.col</code></td>
<td>
<p>a column number, or column name, in the data frame <code>data</code>,
where the patient identifier is located.</p>
</td></tr>
<tr><td><code id="to.balanced_+3A_time.col">time.col</code></td>
<td>
<p>a column number, or column name, in the data frame 
<code>data</code>, where the time measurements are.</p>
</td></tr>
<tr><td><code id="to.balanced_+3A_y.col">Y.col</code></td>
<td>
<p>a vector of column numbers, or column names, of longitudinal 
variables, and/or time dependent covariates in the data frame <code>data</code>.</p>
</td></tr>
<tr><td><code id="to.balanced_+3A_other.col">other.col</code></td>
<td>
<p>a vector of column numbers, or column names, of baseline 
covariates, and/or other subject level data, as for example, survival data.
Default does not include <code>other.col</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with longitudinal data in the balanced format. The
balanced format is considered in this context as the format where each row
has data on each subject. Notice that in this format we will have multiple
columns for the same longitudinal variable, each corresponding to the
variable observed at each time point.
</p>


<h3>Author(s)</h3>

<p>Ines Sousa
</p>


<h3>See Also</h3>

<p><code><a href="#topic+to.unbalanced">to.unbalanced</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>simul &lt;- data.frame(num = 1:10,
                    Y1.1 = rnorm(10), Y1.2 = rnorm(10),
                    Y2.1 = rnorm(10), Y2.2 = rnorm(10),
                    age = rnorm(10))
simul &lt;- to.unbalanced(simul, id.col = 1, times = c(1, 2), 
                       Y.col = 2:5, other.col = 6)
simul &lt;- to.balanced(simul, id.col = "num", time.col = "time",
                     Y.col = c("Y1.1", "Y2.1"), other.col = "age")
</code></pre>

<hr>
<h2 id='to.unbalanced'>Transform data to the longitudinal unbalanced format</h2><span id='topic+to.unbalanced'></span>

<h3>Description</h3>

<p>Transforms a longitudinal data set in the balanced format to the
unbalanced format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to.unbalanced(data, id.col, times, Y.col, other.col = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="to.unbalanced_+3A_data">data</code></td>
<td>
<p>a data frame with longitudinal data in the balanced format. That 
is, in the format of 'one row per subject'. <code>data</code>, where the patient
identifications is.</p>
</td></tr>
<tr><td><code id="to.unbalanced_+3A_id.col">id.col</code></td>
<td>
<p>a column number, or column name, in the data frame <code>data</code>,
where the patient identifier is located.</p>
</td></tr>
<tr><td><code id="to.unbalanced_+3A_times">times</code></td>
<td>
<p>a vector with the unique time points where the patients are 
observed. This is the study design time points in a balanced data set.</p>
</td></tr>
<tr><td><code id="to.unbalanced_+3A_y.col">Y.col</code></td>
<td>
<p>a vector of column numbers, or column names, of longitudinal 
variables, and/or time dependent covariates in the data frame <code>data</code>.</p>
</td></tr>
<tr><td><code id="to.unbalanced_+3A_other.col">other.col</code></td>
<td>
<p>a vector of column numbers, or column names, of baseline 
covariates, and/or other subject level data, as for example, survival data.
Default does not include <code>other.col</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with longitudinal data in the unbalanced format. The
unbalanced format is considered in this context as the format where each
row has data on each subject observation.
</p>


<h3>Author(s)</h3>

<p>Ines Sousa
</p>


<h3>See Also</h3>

<p><code><a href="#topic+to.balanced">to.balanced</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>simul &lt;- data.frame(num = 1:10,
                    Y1.1 = rnorm(10), Y1.2 = rnorm(10),
                    Y2.1 = rnorm(10), Y2.2 = rnorm(10), 
                    age = rnorm(10))
to.unbalanced(simul, id.col = 1, times = c(1, 2), Y.col = 2:5,
              other.col = 6)
</code></pre>

<hr>
<h2 id='UniqueVariables'>Extracts the unique non-time dependent variables per patient, from an 
unbalanced data set</h2><span id='topic+UniqueVariables'></span>

<h3>Description</h3>

<p>This function extracts a set of unique variables within a
patient, returning a data frame with columns, patient identification and
variables selected. Each row corresponds to the data for each individual.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UniqueVariables(data, var.col, id.col = "ID")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UniqueVariables_+3A_data">data</code></td>
<td>
<p>data frame, or matrix, with at least a column of patient 
identification and a covariate column.</p>
</td></tr>
<tr><td><code id="UniqueVariables_+3A_var.col">var.col</code></td>
<td>
<p>vector of column names or column numbers, of the variables 
(non-time dependent). Cannot have mix of numbers and column names.</p>
</td></tr>
<tr><td><code id="UniqueVariables_+3A_id.col">id.col</code></td>
<td>
<p>column name or column number of the patient identification.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be used, when longitudinal data is in the
unbalanced format, and it is necessary, for example, to extract the set of
unique baseline covariates, or any non-time dependent variables, that in
the unbalanced format, are repeated for each observation row. Also, if the 
original data frame has survival data, this can also be used to extract the
survival information from the original data set.
</p>


<h3>Value</h3>

<p>A data frame with patient identification and covariates selected.
Each row corresponds to the data for each individual. Note that, this can
be only used for non-time dependent covariates. If extracting unique time
dependent covariates, the function gives an error, because it can't select
what is the unique covariate.
</p>


<h3>Author(s)</h3>

<p>Ines Sousa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(heart.valve)
heart.cov &lt;- UniqueVariables(heart.valve,
                             c(2, 3, 5, 6, 12:25),
                             id.col = "num")
</code></pre>

<hr>
<h2 id='variogram'>Empirical variogram for longitudinal data</h2><span id='topic+variogram'></span>

<h3>Description</h3>

<p>Calculates the variogram for observed measurements, with two
components, the total variability in the data, and the variogram for all
time lags in all individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>variogram(indv, time, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="variogram_+3A_indv">indv</code></td>
<td>
<p>vector of individual identification, as in the longitudinal data,
repeated for each time point.</p>
</td></tr>
<tr><td><code id="variogram_+3A_time">time</code></td>
<td>
<p>vector of observation time, as in the longitudinal data.</p>
</td></tr>
<tr><td><code id="variogram_+3A_y">Y</code></td>
<td>
<p>vector of observed measurements. This can be a vector of 
longitudinal data, or residuals after fitting a model for the mean
response.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The empirical variogram in this function is calculated from observed
half-squared-differences between pairs of measurements, <code class="reqn">v_ijk = 0.5 *
  (r_ij-r_ik)^2</code> and the corresponding time differences
<code class="reqn">u_ijk=t_ij-t_ik</code>. The variogram is plotted for averages of each time
lag for the <code class="reqn">v_ijk</code> for all <code class="reqn">i</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>vargm</code> and <code>list</code> with two elements.
The first <code>svar</code> is a matrix with columns for all values
<code class="reqn">(u_ijk,v_ijk)</code>, and the second <code>sigma2</code> is the total variability
in the data.
</p>


<h3>Note</h3>

<p>There is a function <code><a href="#topic+plot.vargm">plot.vargm</a></code> which should be used to 
plot the empirical variogram.
</p>


<h3>Author(s)</h3>

<p>Ines Sousa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mental)
mental.unbalanced &lt;- to.unbalanced(mental, id.col = 1, 
                                   times = c(0, 1, 2, 4, 6, 8),
                                   Y.col = 2:7, 
                                   other.col = c(8, 10, 11))
names(mental.unbalanced)[3] &lt;- "Y"

vgm &lt;- variogram(indv = tail(mental.unbalanced[, 1], 30),
                 time = tail(mental.unbalanced[, 2], 30),
                 Y = tail(mental.unbalanced[, 3], 30))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
