<!DOCTYPE html><html><head><title>Help for package multiCA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {multiCA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cnonct'><p>Non-centrality parameter for chi-square distribution</p></a></li>
<li><a href='#internal'><p>Internal functions</p></a></li>
<li><a href='#multiCA-package'>
<p>Multinomial Cochran-Armitage Trend Test</p></a></li>
<li><a href='#multiCA.test'><p>Multinomial Cochran-Armitage trend test</p></a></li>
<li><a href='#power.multiCA.test'><p>Power calculations for the multinomial Cochran-Armitage trend test</p></a></li>
<li><a href='#stroke'>
<p>Stroke types over time</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multinomial Cochran-Armitage Trend Test</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-08-07</td>
</tr>
<tr>
<td>Author:</td>
<td>Aniko Szabo</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>bitops, multcomp</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aniko Szabo &lt;aszabo@mcw.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements a generalization of the Cochran-Armitage trend test to
    multinomial data. In addition to an overall test, multiple testing adjusted
    p-values for trend in individual outcomes and power calculation is
    available.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Repository/R-Forge/Project:</td>
<td>corrbin</td>
</tr>
<tr>
<td>Repository/R-Forge/Revision:</td>
<td>106</td>
</tr>
<tr>
<td>Repository/R-Forge/DateTimeStamp:</td>
<td>2017-08-07 16:05:30</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-08-07 19:36:33 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-08-07 16:25:12 UTC; rforge</td>
</tr>
</table>
<hr>
<h2 id='cnonct'>Non-centrality parameter for chi-square distribution</h2><span id='topic+cnonct'></span>

<h3>Description</h3>

<p>Calculates the non-centrality parameter for a chi-square distribution for a given 
quantile. This is often needed for sample size calculation for chi-square based tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cnonct(x, p, df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cnonct_+3A_x">x</code></td>
<td>
<p>a numeric value at which the distribution was evaluated</p>
</td></tr>
<tr><td><code id="cnonct_+3A_p">p</code></td>
<td>
<p>a numeric value giving the cumulative probability at <code>x</code></p>
</td></tr>
<tr><td><code id="cnonct_+3A_df">df</code></td>
<td>
<p>an integer giving the degrees of freedom of the chi-square variable</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is modeled after the SAS function CNONCT. If <code>p</code> is larger 
than the cumulative probability of the central chi-square distribution at <code>x</code>, then
there is no solution and NA is returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(ncp &lt;- cnonct(qchisq(0.95, df=10), 0.8, df=10))
## check
pchisq(qchisq(0.95, df=10), df=10, ncp=ncp)  ## 0.8
</code></pre>

<hr>
<h2 id='internal'>Internal functions</h2><span id='topic+.bit2boolean'></span><span id='topic+.p.adjust.closed'></span><span id='topic+internal'></span>

<h3>Description</h3>

<p>These internal functions perform the closed set p-value adjustment calculation
for the multivariate Cochran-Armitage trend test. The logical constraint
on the possible number of true null hypotheses is incorporated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.bit2boolean(x, N)

.p.adjust.closed(test, hypotheses, remove = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="internal_+3A_test">test</code></td>
<td>
<p>function that performs the local test. The function should accept a subvector of the hypotheses argument as input, and return a p-value.</p>
</td></tr>
<tr><td><code id="internal_+3A_hypotheses">hypotheses</code></td>
<td>
<p>identifiers of the collection of elementary hypotheses.</p>
</td></tr>
<tr><td><code id="internal_+3A_remove">remove</code></td>
<td>
<p>logical indicator of whether hypotheses of length N-1 should be removed</p>
</td></tr>
<tr><td><code id="internal_+3A_...">...</code></td>
<td>
<p>additional parameters to the 'test' function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of adjusted p-values for each hypothesis
</p>

<hr>
<h2 id='multiCA-package'>
Multinomial Cochran-Armitage Trend Test
</h2><span id='topic+multiCA-package'></span><span id='topic+multiCA'></span>

<h3>Description</h3>

<p>Implements a generalization of the Cochran-Armitage trend test to
multinomial data. In addition to an overall test, multiple testing adjusted
p-values for trend in individual outcomes and power calculation is
available.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> multiCA</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Multinomial Cochran-Armitage Trend Test</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2017-08-07</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Aniko Szabo</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R(&gt;= 2.10)</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> bitops, multcomp</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Aniko Szabo &lt;aszabo@mcw.edu&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Implements a generalization of the Cochran-Armitage trend test to
    multinomial data. In addition to an overall test, multiple testing adjusted
    p-values for trend in individual outcomes and power calculation is
    available.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2)</td>
</tr>
<tr>
 <td style="text-align: left;">
RoxygenNote: </td><td style="text-align: left;"> 5.0.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> testthat</td>
</tr>
<tr>
 <td style="text-align: left;">
Repository: </td><td style="text-align: left;"> R-Forge</td>
</tr>
<tr>
 <td style="text-align: left;">
Repository/R-Forge/Project: </td><td style="text-align: left;"> corrbin</td>
</tr>
<tr>
 <td style="text-align: left;">
Repository/R-Forge/Revision: </td><td style="text-align: left;"> 106</td>
</tr>
<tr>
 <td style="text-align: left;">
Repository/R-Forge/DateTimeStamp: </td><td style="text-align: left;"> 2017-08-07 16:05:30</td>
</tr>
<tr>
 <td style="text-align: left;">
Date/Publication: </td><td style="text-align: left;"> 2017-08-07 16:05:30</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index of help topics:
</p>
<pre>
cnonct                  Non-centrality parameter for chi-square
                        distribution
multiCA-package         Multinomial Cochran-Armitage Trend Test
multiCA.test            Multinomial Cochran-Armitage trend test
power.multiCA.test      Power calculations for the multinomial
                        Cochran-Armitage trend test
stroke                  Stroke types over time
</pre>
<p>The main functionality is implemented in the <code>multiCA.test</code> function. The <code>power.multiCA.test</code> function can be used for power and sample size calculation.
</p>


<h3>Author(s)</h3>

<p>Aniko Szabo
</p>
<p>Maintainer: Aniko Szabo &lt;aszabo@mcw.edu&gt;
</p>


<h3>References</h3>

<p>Szabo, A. (2016) Test for trend with a multinomial outcome.
</p>

<hr>
<h2 id='multiCA.test'>Multinomial Cochran-Armitage trend test</h2><span id='topic+multiCA.test'></span><span id='topic+multiCA.test.default'></span><span id='topic+multiCA.test.formula'></span>

<h3>Description</h3>

<p>The <code>multiCA.test</code> function performs a multinomial generalization of the 
Cochran-Armitage trend test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiCA.test(x, ...)

## Default S3 method:
multiCA.test(x, scores = 1:ncol(x), outcomes = 1:nrow(x),
  p.adjust.method = c("none", "closed.set", "Holm-Shaffer", "single-step",
  "Westfall"), ...)

## S3 method for class 'formula'
multiCA.test(formula, data, subset, na.action, weights, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multiCA.test_+3A_x">x</code></td>
<td>
<p>a two-dimensional matrix of event counts with the outcomes as rows and ordered groups as columns.</p>
</td></tr>
<tr><td><code id="multiCA.test_+3A_scores">scores</code></td>
<td>
<p>non-decreaseing numeric vector of the same length as the number of ordered groups. Defaults to linearly increasing values</p>
</td></tr>
<tr><td><code id="multiCA.test_+3A_outcomes">outcomes</code></td>
<td>
<p>integer or character vector defining the set of outcomes (by row index or row name) over which the trend should be tested. Defaults to all outcomes.</p>
</td></tr>
<tr><td><code id="multiCA.test_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>character string defining the correction method for individual outcome p-values. Defaults to &quot;closed.set&quot; when <code>length(outcomes)&lt;=3</code>, and &quot;Holm-Shaffer&quot; otherwise.</p>
</td></tr>
<tr><td><code id="multiCA.test_+3A_formula">formula</code></td>
<td>
<p>a formula of the form <code>outcome ~ group</code> where <code>outcome</code> is a factor representing the cateogrical outcome and <code>group</code> is the grouping variable over which the trend is tested.</p>
</td></tr>
<tr><td><code id="multiCA.test_+3A_data">data</code></td>
<td>
<p>an optional matrix or data frame containing the variables in the formula <code>formula</code>. By default the variables are taken from <code>environment(formula).</code></p>
</td></tr>
<tr><td><code id="multiCA.test_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used.</p>
</td></tr>
<tr><td><code id="multiCA.test_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contain NAs. Defaults to getOption(&quot;na.action&quot;).</p>
</td></tr>
<tr><td><code id="multiCA.test_+3A_weights">weights</code></td>
<td>
<p>an integer-valued variable representing the number of times each <code>outcome</code> - <code>group</code> combination was observed.</p>
</td></tr>
<tr><td><code id="multiCA.test_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with two components
</p>
<table>
<tr><td><code>overall</code></td>
<td>
<p>an object of class &quot;htest&quot; with the results of the overall test</p>
</td></tr>
<tr><td><code>individual</code></td>
<td>
<p>a vector with adjusted p-values for individual outcomes</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aniko Szabo
</p>


<h3>References</h3>

<p>Szabo, A. (2016) Test for trend with a multinomial outcome.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(stroke)
## using formula interface
multiCA.test(Type ~ Year, weights=Freq, data=stroke)

##using Westfall's multiple testing adjustment
multiCA.test(Type ~ Year, weights=Freq, data=stroke, p.adjust.method="Westfall")

## using matrix interface and testing only the first 3 outcomes
strk.mat &lt;- xtabs(Freq ~ Type + Year, data=stroke)
multiCA.test(strk.mat, outcomes=1:3)

</code></pre>

<hr>
<h2 id='power.multiCA.test'>Power calculations for the multinomial Cochran-Armitage trend test</h2><span id='topic+power.multiCA.test'></span>

<h3>Description</h3>

<p>Given the probabilities of outcomes, compute the power of the overall multinomial 
Cochran-Armitage trend test or determine the sample size to obtain a target power.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.multiCA.test(N = NULL, power = NULL, pmatrix = NULL, p.ave = NULL,
  p.start = NULL, p.end = NULL, slopes = NULL, scores = 1:G,
  n.prop = rep(1, G), G = length(p.ave), sig.level = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power.multiCA.test_+3A_n">N</code></td>
<td>
<p>integer, the total sample size of the study. If <code>NULL</code> then <code>power</code> needs to be specified.</p>
</td></tr>
<tr><td><code id="power.multiCA.test_+3A_power">power</code></td>
<td>
<p>target power. If <code>NULL</code> then <code>N</code> needs to be specified.</p>
</td></tr>
<tr><td><code id="power.multiCA.test_+3A_pmatrix">pmatrix</code></td>
<td>
<p>numeric matrix of hypothesized outcome probabilities in each group,  with #' the outcomes as rows and ordered groups as columns. The columns should add up to 1.</p>
</td></tr>
<tr><td><code id="power.multiCA.test_+3A_p.ave">p.ave</code></td>
<td>
<p>numeric vector of average probability of each outcome over the groups
weighted by <code>n.prop</code>.</p>
</td></tr>
<tr><td><code id="power.multiCA.test_+3A_p.start">p.start</code>, <code id="power.multiCA.test_+3A_p.end">p.end</code></td>
<td>
<p>numeric vectors of the probability of each outcome for the
first / last ordered group</p>
</td></tr>
<tr><td><code id="power.multiCA.test_+3A_slopes">slopes</code></td>
<td>
<p>numeric vector of the hypothesized slope of each outcome when regressed
against the column <code>scores</code> wiht weights <code>n.prop</code></p>
</td></tr>
<tr><td><code id="power.multiCA.test_+3A_scores">scores</code></td>
<td>
<p>non-decreasing numeric vector of the same length as the number of ordered groups
giving the trend test scores. Defaults to linearly increasing values.</p>
</td></tr>
<tr><td><code id="power.multiCA.test_+3A_n.prop">n.prop</code></td>
<td>
<p>numeric vector describing relative sample sizes of the ordered groups.
Will be normalized to sum to 1. Defaults to equal sample sizes.</p>
</td></tr>
<tr><td><code id="power.multiCA.test_+3A_g">G</code></td>
<td>
<p>integer, number of ordered groups</p>
</td></tr>
<tr><td><code id="power.multiCA.test_+3A_sig.level">sig.level</code></td>
<td>
<p>significance level</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The distribution of the outcomes can be specified in two ways: either the full matrix of 
outcome probabilities <code>pmatrix</code> can be specified, or exactly two of the parameters 
<code>p.ave</code>, <code>slopes</code>, <code>p.start</code>, and <code>p.end</code> must be specified, while
</p>


<h3>Value</h3>

<p>object of class &quot;power.htest&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>power.multiCA.test(power=0.8, p.start=c(0.1,0.2,0.3,0.4), p.end=c(0.4, 0.3, 0.2, 0.1), 
                     G=5, n.prop=c(3,2,1,2,3))

## Power of stroke study with 100 subjects per year and observed trends
data(stroke)
strk.mat &lt;- xtabs(Freq ~ Type + Year, data=stroke)
power.multiCA.test(N=900, pmatrix=prop.table(strk.mat, margin=2))
</code></pre>

<hr>
<h2 id='stroke'>
Stroke types over time
</h2><span id='topic+stroke'></span>

<h3>Description</h3>

<p>Nakajima et al. (2014) collected information on stroke patients over a 9-year period. For each patient, the type of stroke was classified into one of 5 categories by etiology.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("stroke")</code></pre>


<h3>Format</h3>

<p>A data frame with 45 observations on the following 3 variables.
</p>

<dl>
<dt><code>Type</code></dt><dd><p>a factor with levels <code>Small vessel occlusion</code>, <code>Large artery atherosclerosis</code>, <code>Cardioembolism</code>, <code>Other determined aetiology</code>, and <code>Undetermined aetiology</code> giving the etiology of the stroke</p>
</dd>
<dt><code>Year</code></dt><dd><p>a numeric vector with the year of the observation</p>
</dd>
<dt><code>Freq</code></dt><dd><p>a numeric vector with the number of patients with a stroke of the given etiology that year</p>
</dd>
</dl>



<h3>Source</h3>

<p>Nakajima, M., Y. Inatomi, T. Yonehara, Y. Hashimoto, T. Hirano, and Y. Ando (2014).
Temporal trends in oral intake ability 3 months after acute ischaemic stroke: analysis of
a single-centre database from 2003 to 2011. J Rehabil Med 46 (3), 200&ndash;205.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(stroke)
xtabs(Freq ~ Type + Year, data=stroke)

strk.props &lt;- prop.table(xtabs(Freq ~ Year+Type, data=stroke), margin=1)
matplot(strk.props, type="l")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
