<!DOCTYPE html><html><head><title>Help for package oesr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {oesr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#df_oes'><p>Sample Data for OES</p></a></li>
<li><a href='#oes_plot'><p>Create OES Plot</p></a></li>
<li><a href='#oes_prep'><p>Prepare Model Output for OES Plots</p></a></li>
<li><a href='#theme_oes'><p>Render OES Theme</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Methods for the Office of Evaluation Sciences</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-02-09</td>
</tr>
<tr>
<td>Description:</td>
<td>Methods for statistical analysis and reporting preferred by the US Office of Evaluation Sciences (OES). This package prepares data from standard model output objects (such as from \code{lm()} and \code{estimatr::lm_robust()}) and creates visualizations of treatment effects from the prepared quantities, according to the standards of the US Office of Evaluation Sciences.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>broom, dplyr, estimatr, extrafont, ggplot2, rlang, sandwich,
stats, tibble</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-09 19:26:10 UTC; rtm</td>
</tr>
<tr>
<td>Author:</td>
<td>Ryan T. Moore <a href="https://orcid.org/0000-0002-3916-8113"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Miles Williams <a href="https://orcid.org/0000-0003-0192-5542"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ryan T. Moore &lt;ryan.moore@gsa.gov&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-11 15:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='df_oes'>Sample Data for OES</h2><span id='topic+df_oes'></span>

<h3>Description</h3>

<p>A simulated dataset containing outcomes, intervention variables, and covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_oes
</code></pre>


<h3>Format</h3>

<p>A data frame with 10000 rows and 7 variables:
</p>

<dl>
<dt>x1</dt><dd><p>A binary 0/1 treatment assignment.</p>
</dd>
<dt>x2</dt><dd><p>A four-level factor treatment assignment with levels <code>"0"</code>, ..., <code>"3"</code>.</p>
</dd>
<dt>y1</dt><dd><p>A binary 0/1 outcome.</p>
</dd>
<dt>y2</dt><dd><p>A binary 0/1 outcome.</p>
</dd>
<dt>z1</dt><dd><p>A continuous normally-distributed covariate.</p>
</dd>
<dt>z2</dt><dd><p>A binary 0/1 covariate.</p>
</dd>
<dt>z3</dt><dd><p>A six-level factor covariate with levels <code>"0"</code>, ..., <code>"5"</code>.</p>
</dd>
</dl>


<hr>
<h2 id='oes_plot'>Create OES Plot</h2><span id='topic+oes_plot'></span>

<h3>Description</h3>

<p>Plot experimental results using OES style
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oes_plot(
  prep,
  font = "sans",
  device = "pdf",
  treatment_fill = "#F2C446",
  control_fill = "#2E9AC4",
  digits = 3,
  report_stars = TRUE,
  xlab,
  ylab,
  title = "Outcomes under Treatment",
  save = FALSE,
  name_save = "figure1.png",
  base_size = 12,
  width = 3.1,
  height = 4,
  dpi_forplot = 300
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oes_plot_+3A_prep">prep</code></td>
<td>
<p>A tidy tibble of estimates to plot, such as the output from
<code>oes_prep()</code>.</p>
</td></tr>
<tr><td><code id="oes_plot_+3A_font">font</code></td>
<td>
<p>Optional string giving font; defaults to <code>"sans"</code>.</p>
</td></tr>
<tr><td><code id="oes_plot_+3A_device">device</code></td>
<td>
<p>Set device for loading fonts. Default is <code>"pdf"</code>.</p>
</td></tr>
<tr><td><code id="oes_plot_+3A_treatment_fill">treatment_fill</code></td>
<td>
<p>Bar color for treatment conditions.</p>
</td></tr>
<tr><td><code id="oes_plot_+3A_control_fill">control_fill</code></td>
<td>
<p>Bar color for control condition.</p>
</td></tr>
<tr><td><code id="oes_plot_+3A_digits">digits</code></td>
<td>
<p>Integer representing number of digits after decimal point to
report. Defaults to 3.</p>
</td></tr>
<tr><td><code id="oes_plot_+3A_report_stars">report_stars</code></td>
<td>
<p>Logical indicating whether to display asterisks for statistical
significance. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="oes_plot_+3A_xlab">xlab</code></td>
<td>
<p>String providing the <code class="reqn">x</code>-axis label.</p>
</td></tr>
<tr><td><code id="oes_plot_+3A_ylab">ylab</code></td>
<td>
<p>String providing the <code class="reqn">y</code>-axis label.</p>
</td></tr>
<tr><td><code id="oes_plot_+3A_title">title</code></td>
<td>
<p>String providing the plot title.</p>
</td></tr>
<tr><td><code id="oes_plot_+3A_save">save</code></td>
<td>
<p>Logical indicating whether to save the plot. Defaults to
<code>FALSE</code>. If <code>TRUE</code>, the plot is not returned, but a file is saved using <code>ggsave</code>.</p>
</td></tr>
<tr><td><code id="oes_plot_+3A_name_save">name_save</code></td>
<td>
<p>File name for saved plot.</p>
</td></tr>
<tr><td><code id="oes_plot_+3A_base_size">base_size</code></td>
<td>
<p>Base font size for plot.</p>
</td></tr>
<tr><td><code id="oes_plot_+3A_width">width</code></td>
<td>
<p>Width of saved plot (in inches). Use 6.8 for multiple columns.</p>
</td></tr>
<tr><td><code id="oes_plot_+3A_height">height</code></td>
<td>
<p>Height of saved plot (in inches).</p>
</td></tr>
<tr><td><code id="oes_plot_+3A_dpi_forplot">dpi_forplot</code></td>
<td>
<p>Resolution of saved plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>oes_plot plots the observed response mean of a control group and the
predicted response means of one or more
treatment groups based on OES guidance on data reporting and visualization
best-practice. Read more about this OES guidance at
https://oes.gsa.gov/assets/files/reporting-statistical-results.pdf.
</p>


<h3>Value</h3>

<p>A plot; if <code>save = TRUE</code>, a file containing a plot.
</p>


<h3>Author(s)</h3>

<p>Miles Williams
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(df_oes)

# Single binary treatment:
fit &lt;- lm(y1 ~ x1, df_oes)

# Multiple treatment conditions:
fit2 &lt;- lm(y2 ~ x2, df_oes)

# Using HC2 SE's from lm_robust():
fit_robust &lt;- estimatr::lm_robust(y1 ~ x1, df_oes)
fit_robust2 &lt;- estimatr::lm_robust(y2 ~ x2, df_oes)

# Using covariates and lm():
fit_covars &lt;- lm(y2 ~ x2 + z1 + z2 + z3, df_oes)

# Using covariates and lm_robust():
fit_covars_robust &lt;- estimatr::lm_robust(y2 ~ x2 + z1 + z2 + z3, df_oes)

# Specify treatment_arms:
oes_prep(fit, treatment_arms = 1) |&gt; oes_plot()

# Specify treatment_vars:
fit |&gt;
  oes_prep(treatment_vars = "x1") |&gt;
  oes_plot()

# Specify treatment_arms:
oes_prep(fit2, treatment_arms = 3) |&gt;
  oes_plot()

# Specify treatment_vars:
fit2 |&gt;
  oes_prep(treatment_vars = c("x21", "x22", "x23")) |&gt;
  oes_plot()

# Specify custom treatment_labels:
prep_w_labels &lt;- oes_prep(fit2, treatment_arms = 3,
  treatment_labels = c(
    "Email",
    "Email +\nReward",
    "Email +\nRisk"),
  control_label = "Status Quo")

oes_plot(prep_w_labels)

# Using objects from estimatr::lm_robust():
oes_prep(fit_robust, treatment_arms = 1) |&gt; oes_plot()

oes_prep(fit_robust2, treatment_arms = 3) |&gt; oes_plot()

# Specify covariates with lm:
oes_prep(fit_covars, treatment_arms = 3) |&gt; oes_plot()

# Specify covariates with lm_robust():
oes_prep(fit_covars_robust, treatment_arms = 3) |&gt; oes_plot()

# For the Lin estimator, a manual version of lm_lin():
m.mat &lt;- cbind(y2 = df_oes$y2, model.matrix(y2 ~ x2 + z1 + z2 + z3, df_oes)[, -1])
m.mat &lt;- dplyr::mutate_at(
  data.frame(m.mat),
  .vars = c('z1', 'z2', 'z31', 'z32', 'z33', 'z34', 'z35'),
  function(x) x - mean(x)
  )

fit_lin &lt;- estimatr::lm_robust(y2 ~ (x21 + x22 + x23) *
  (z1 + z2 + z31 + z32 + z33 + z34 + z35), m.mat)

oes_prep(fit_lin, treatment_arms = 3) |&gt; oes_plot()

</code></pre>

<hr>
<h2 id='oes_prep'>Prepare Model Output for OES Plots</h2><span id='topic+oes_prep'></span>

<h3>Description</h3>

<p>Prepare output of linear modeling object into a tidy data table to feed
into OES plotting function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oes_prep(
  model,
  treatment_vars = NULL,
  treatment_arms = NULL,
  scale = c("response", "percentage"),
  treatment_labels,
  control_label,
  alpha_level = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oes_prep_+3A_model">model</code></td>
<td>
<p>An object of class <code>lm</code> or <code>lm_robust</code></p>
</td></tr>
<tr><td><code id="oes_prep_+3A_treatment_vars">treatment_vars</code></td>
<td>
<p>An optional character vector of treatment arm names. One
of <code>treatment_vars</code> or <code>treatment_arms</code> must be supplied.</p>
</td></tr>
<tr><td><code id="oes_prep_+3A_treatment_arms">treatment_arms</code></td>
<td>
<p>An optional numeric value indicating the number of treatment
arms. (Not required if treatment_vars is given explicitly.) One
of <code>treatment_vars</code> or <code>treatment_arms</code> must be supplied.</p>
</td></tr>
<tr><td><code id="oes_prep_+3A_scale">scale</code></td>
<td>
<p>String indicating the <code class="reqn">y</code>-axis scale. Default is <code>'response'</code>.
For binary outcomes, it may be desirable to set to <code>"percentage"</code>.</p>
</td></tr>
<tr><td><code id="oes_prep_+3A_treatment_labels">treatment_labels</code></td>
<td>
<p>Optional vector of string labels providing treatment condition(s)</p>
</td></tr>
<tr><td><code id="oes_prep_+3A_control_label">control_label</code></td>
<td>
<p>Optional string providing control condition label</p>
</td></tr>
<tr><td><code id="oes_prep_+3A_alpha_level">alpha_level</code></td>
<td>
<p>The level at which to reject the null hypothesis for adding
asterisks to plots. Set to 0.05 by default. This value also determines the size
of the confidence intervals (<code>alpha_level = 0.05</code> corresponds to 95% confidence
intervals).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>oes_prep()</code> takes a linear modeling output object (from <code>lm()</code>
or <code>lm_robust()</code>) and returns a tidy tibble of estimates,
confidence bounds, and related quantities ready for oes_plot to plot.
Functionality for <code>lm_lin()</code> objects is in development.
</p>


<h3>Value</h3>

<p>A tibble of <code class="reqn">T+1</code> rows and 8 columns, where <code class="reqn">T</code> is the number
of treatment conditions specified via <code>treatment_vars</code> or
<code>treatment_arms</code>.
</p>


<h3>Author(s)</h3>

<p>Miles Williams
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(df_oes)

# Single binary treatment:
fit &lt;- lm(y1 ~ x1, df_oes)

# Multiple treatment conditions:
fit2 &lt;- lm(y2 ~ x2, df_oes)

# Using HC2 SE's from lm_robust():
fit_robust &lt;- estimatr::lm_robust(y1 ~ x1, df_oes)
fit_robust2 &lt;- estimatr::lm_robust(y2 ~ x2, df_oes)

# Using covariates and lm():
fit_covars &lt;- lm(y2 ~ x2 + z1 + z2 + z3, df_oes)

# Using covariates and lm_robust():
fit_covars_robust &lt;- estimatr::lm_robust(y2 ~ x2 + z1 + z2 + z3, df_oes)

# Example specifying number of treatment arms:
oes_prep(fit, treatment_arms = 1)

# Example specifying name of treatment variable:
oes_prep(fit, treatment_vars = "x1")

# Example reporting outcomes as percentages:
oes_prep(fit, treatment_vars = "x1", scale = "percentage")

# Example specifying several treatment arms, labels, etc.:
oes_prep(fit2, treatment_arms = 3,
  treatment_labels = c(
    "Email",
    "Email +\nReward",
    "Email +\nRisk"),
  control_label = "Status Quo",
  scale = "percentage")

# Examples with lm_robust():
oes_prep(fit_robust, treatment_arms = 1)
oes_prep(fit_robust2, treatment_arms = 3)

# Examples with covariates:
oes_prep(fit_covars, treatment_arms = 3)
oes_prep(fit_covars_robust, treatment_arms = 3)

</code></pre>

<hr>
<h2 id='theme_oes'>Render OES Theme</h2><span id='topic+theme_oes'></span>

<h3>Description</h3>

<p>Defines the OES plotting theme
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theme_oes(base_size = 12, base_family = "Lato", device = "pdf")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="theme_oes_+3A_base_size">base_size</code></td>
<td>
<p>An integer specifying a font size; defaults to <code>12</code>.</p>
</td></tr>
<tr><td><code id="theme_oes_+3A_base_family">base_family</code></td>
<td>
<p>A character string identifying a font family; defaults to
the OES-preferred <code>"Lato"</code>.</p>
</td></tr>
<tr><td><code id="theme_oes_+3A_device">device</code></td>
<td>
<p>A character string identifying a plotting device; defaults to
<code>"pdf"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A list of length 93 of classes <code>theme</code> and <code>gg</code> that
defines elements of the display other than the data. <code>theme_oes()</code> wraps
<code>ggplot2::theme_bw()</code> and replaces several default values.
</p>


<h3>Value</h3>

<p>A list specifying a ggplot theme. See <code>Details</code> for more.
</p>


<h3>Author(s)</h3>

<p>Miles Williams
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
