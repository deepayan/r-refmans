<!DOCTYPE html><html><head><title>Help for package RFPM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RFPM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#c.northport'><p>Northport Data, <em>Chironomus dilutus</em> Toxicity</p></a></li>
<li><a href='#chemSig'><p>Chemical Variable Selection within the Floating Percentile Model</p></a></li>
<li><a href='#chemSigSelect'><p>Chemical Data Selection within the Floating Percentile Model</p></a></li>
<li><a href='#chemVI'><p>Chemical Variable Importance for Floating Percentile Model Benchmarks</p></a></li>
<li><a href='#colorGradient'><p>Color Gradient Generator</p></a></li>
<li><a href='#cvFPM'><p>Cross-Validation Optimization of the Floating Percentile Model</p></a></li>
<li><a href='#FPM'><p>Floating Percentile Model</p></a></li>
<li><a href='#h.northport'><p>Northport Data, <em>Hyalella azteca</em> Toxicity</p></a></li>
<li><a href='#h.tristate'><p>Tristate Data, <em>Hyalella azteca</em> Toxicity</p></a></li>
<li><a href='#highNoise'><p>Simulated Floating Percentile Model Data, High Random Noise in Toxicity Prediction</p></a></li>
<li><a href='#lowNoise'><p>Simulated Floating Percentile Model Data, Low Random Noise in Toxicity Prediction</p></a></li>
<li><a href='#optimFPM'><p>Optimization of Floating Percentile Model Parameters</p></a></li>
<li><a href='#perfect'><p>Simulated Data for Floating Percentile Model, Perfect Toxicity Prediction</p></a></li>
<li><a href='#plot.chemSigSelect'><p>Plot method for 'chemSigSelect'</p></a></li>
<li><a href='#predict.FPM'><p>Predict Toxicity Using the Floating Percentile Model</p></a></li>
<li><a href='#RFPM'><p>Floating Percentile Model</p></a></li>
<li><a href='#toxCRM'><p>Concentration-Response Model, 4-parameter log-logistic curve</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Floating Percentile Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-24</td>
</tr>
<tr>
<td>Description:</td>
<td>Floating Percentile Model with additional functions for optimizing inputs and evaluating outputs and assumptions.</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, grDevices, tidyr, dplyr, lawstat</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Brian Church &lt;brianc@windwardenv.com&gt;</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-25 17:25:26 UTC; brianc</td>
</tr>
<tr>
<td>Author:</td>
<td>Brian Church <a href="https://orcid.org/0000-0003-2220-0153"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Claire Detering [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-25 17:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='c.northport'>Northport Data, <em>Chironomus dilutus</em> Toxicity</h2><span id='topic+c.northport'></span>

<h3>Description</h3>

<p>Example dataset
</p>


<h3>Format</h3>

<p>A data.frame with 147 rows and 15 variables:
</p>

<dl>
<dt>Sample</dt><dd><p>sediment sample ID</p>
</dd>
<dt>Al</dt><dd><p>aluminum concentration, mg/kg dry weight</p>
</dd>
<dt>As</dt><dd><p>arsenic concentration, mg/kg dry weight</p>
</dd>
<dt>Cu</dt><dd><p>copper concentration, mg/kg dry weight</p>
</dd>
<dt>Cd</dt><dd><p>cadmium concentration, mg/kg dry weight</p>
</dd>
<dt>Cr</dt><dd><p>chromium concentration, mg/kg dry weight</p>
</dd>
<dt>Fe</dt><dd><p>iron concentration, mg/kg dry weight</p>
</dd>
<dt>Pb</dt><dd><p>lead concentration, mg/kg dry weight</p>
</dd>
<dt>Hg</dt><dd><p>mercury concentration, mg/kg dry weight</p>
</dd>
<dt>Ni</dt><dd><p>nickel concentration, mg/kg dry weight</p>
</dd>
<dt>Zn</dt><dd><p>zinc concentration, mg/kg dry weight</p>
</dd>
<dt>Organism</dt><dd><p>organism abbreviation, <code>CD</code> = <em>Chironomus dilutus</em></p>
</dd>
<dt>Meas_Day</dt><dd><p>measurement day for toxicity endpoint (post-initiation)</p>
</dd>
<dt>Endpoint</dt><dd><p>toxicity endpoint</p>
</dd>
<dt>Hit</dt><dd><p>logical; whether the sample was classified as toxic</p>
</dd>
</dl>



<h3>Details</h3>

<p><code>c.northport</code> is a field-collected dataset containing sediment chemical concentrations for metals and toxicity classification data for
the midge <em>Chironomus dilutus</em>. Data are from a freshwater site in Washington State (Dowling and Roland 2019).
</p>


<h3>References</h3>

<p>Dowling B, Roland J. 2019. Establishment of site-specific SMS metals cleanup objectives for contaminated sediments - Northport waterfront and nearshore state cleanup site. Washington State Department of Ecology.
</p>

<hr>
<h2 id='chemSig'>Chemical Variable Selection within the Floating Percentile Model</h2><span id='topic+chemSig'></span>

<h3>Description</h3>

<p>Determine which chemicals in a dataset have significantly higher concentrations
among toxic samples by comparison to non-toxic samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chemSig(
  data,
  paramList,
  testType = NULL,
  alpha.var = 0.05,
  alpha.norm = 0.05,
  alpha.test = 0.05,
  alpha = NULL,
  alternative = "less",
  var.alternative = "two.sided",
  var.equal = NULL,
  warn = TRUE,
  ExcelMode = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chemSig_+3A_data">data</code></td>
<td>
<p>data.frame containing, at a minimum, chemical concentrations as columns and a logical <code>Hit</code> column classifying toxicity</p>
</td></tr>
<tr><td><code id="chemSig_+3A_paramlist">paramList</code></td>
<td>
<p>character vector of column names of chemical concentration variables in <code>data</code></p>
</td></tr>
<tr><td><code id="chemSig_+3A_testtype">testType</code></td>
<td>
<p>character string; whether to run parametric or non-parametric tests (default = <code>NULL</code>). See Details for more information.</p>
</td></tr>
<tr><td><code id="chemSig_+3A_alpha.var">alpha.var</code></td>
<td>
<p>numeric value between 0 and 1; type-I error rate for testing equal variance assumption (default = <code>0.05</code>)</p>
</td></tr>
<tr><td><code id="chemSig_+3A_alpha.norm">alpha.norm</code></td>
<td>
<p>numeric value between 0 and 1; type-I error rate for testing normality assumption (default = <code>0.05</code>)</p>
</td></tr>
<tr><td><code id="chemSig_+3A_alpha.test">alpha.test</code></td>
<td>
<p>numeric value between 0 and 1; type-I error rate for testing differences between Hit and No-hit datasets (default = <code>0.05</code>)</p>
</td></tr>
<tr><td><code id="chemSig_+3A_alpha">alpha</code></td>
<td>
<p>numeric value between 0 and 1; type-I error rate that, if supplied by the user, will be applied to all tests (default = <code>NULL</code>)</p>
</td></tr>
<tr><td><code id="chemSig_+3A_alternative">alternative</code></td>
<td>
<p>alternative hypothesis type for equality of central tendency (default = <code>"less"</code>)</p>
</td></tr>
<tr><td><code id="chemSig_+3A_var.alternative">var.alternative</code></td>
<td>
<p>alternative hypothesis type for equal variance test (default = <code>"two.sided"</code>)</p>
</td></tr>
<tr><td><code id="chemSig_+3A_var.equal">var.equal</code></td>
<td>
<p>logical; whether to assume equal variance (default = <code>NULL</code>)</p>
</td></tr>
<tr><td><code id="chemSig_+3A_warn">warn</code></td>
<td>
<p>logical; whether to generate a warning associated with <code>ExcelMode</code> (default = <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="chemSig_+3A_excelmode">ExcelMode</code></td>
<td>
<p>logical; whether to force <code>chemSig</code> to run like the WA Department of Ecology's Excel-based floating percentile model calculator (default = <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>chemSig</code> is called within <code>FPM</code> via <code>chemSigSelect</code>, which generates a subset of chemicals to
pass into the floating percentile model algorithm. <code>chemSig</code> only returns a logical vector describing which parameters in <code>paramList</code> should be selected for
benchmark development based on having significantly higher concentrations when <code>Hit == TRUE</code> than when <code>Hit == FALSE</code>.
The user has the ability to manipulate several of the parameters of the selection algorithm, or they can allow <code>chemSig</code> to test for
assumptions and use appropriate hypothesis tests based on those results. By default, <code>chemSig</code> will use <code>shapiro.test</code> to
confirm normality, then either <code>var.test</code> if the data are normal or <code>fligner.test</code>
if the data are non-normal to confirm equal variance. Finally, the function will use <code>t.test</code> if the data are normal (using the Welch method if unequal variance),
<code>wilcox.test</code> if non-normal with equal variance, or <code>brunner.munzel.test</code> if non-normal with unequal variance.
</p>
<p>The <code>testType</code> argument can be one of <code>p</code>, <code>P</code>, <code>param</code>, <code>Param</code>, <code>parametric</code>, or <code>Parametric</code> for parametric
test types or <code>non</code>, <code>Non</code>, <code>np</code>, <code>NP</code>, <code>nonparam</code>, <code>Nonparam</code>, <code>non-param</code>, <code>Non-param</code>, <code>nonparametric</code>, <code>Nonparametric</code>,
<code>non-parametric</code>, <code>Non-parametric</code>, or <code>Non-Parametric</code>.
</p>
<p>The user has the option of providing a single <code>alpha</code> level to apply to all tests (e.g., 0.05) or to specify test-specific alpha levels via <code>alpha.var</code>, <code>alpha.norm</code>, and <code>alpha.test</code>.
Note that <code>FPM</code> by default uses <code>alpha = 0.05</code> for all tests.
</p>
<p>While <code>alternative</code> and <code>var.alternative</code> can be adjusted, we strongly recommend that they not be changed from the
default values. For example, changing <code>alternative</code> from <code>"less"</code> (default) to <code>"two.sided"</code> would result in
the assumption that chemical concentrations could be significantly higher (as well as lower) when there is no toxicity than when there is, which is inappropriate.
The &quot;greater&quot; alternative, which is never appropriate, is not an accepted input for <code>alternative</code>. Similarly, the
assumption of equal variance relates to a <code>"two.sided"</code> argument, therefore changing the <code>var.alternative</code> to be
<code>"less"</code> or <code>"greater"</code> would not be appropriate.
</p>
<p><code>ExcelMode</code> assumes <code>testType = "parametric"</code>, <code>var.equal = TRUE</code>, <code>alternative = "less"</code>, and <code>alpha = 0.1</code>. In
actuality, the Excel-based tool uses a one-way ANOVA test to compare two levels of <code>Hit</code>, which is equivalent to a t-test so long as alpha is adjusted to 0.1.
Thus, <code>testType</code>, <code>alternative</code>, <code>var.alternative</code>, and <code>var.equal</code> are overridden when <code>ExcelMode = TRUE</code>.
This argument was included for those interested in using 'RFPM' as an alternative to the Excel-based calculator tool to obtain identical benchmark results. Note that
the Excel FPM tool also includes other features which may complicate comparability such as outlier analysis. Outlier analysis is not conducted by RFPM.
</p>


<h3>Value</h3>

<p>named logical vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>paramList = c("Cd", "Cu", "Fe", "Mn", "Ni", "Pb", "Zn")
chemSig(h.tristate, paramList, "nonparametric")
chemSig(h.tristate, paramList, "parametric")
</code></pre>

<hr>
<h2 id='chemSigSelect'>Chemical Data Selection within the Floating Percentile Model</h2><span id='topic+chemSigSelect'></span>

<h3>Description</h3>

<p>Generate a dataset of concentrationso for chemicals with significantly higher concentrations
among toxic samples by comparison to non-toxic samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chemSigSelect(data, paramList, plot = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chemSigSelect_+3A_data">data</code></td>
<td>
<p>data.frame containing, at a minimum, chemical concentrations as columns and a logical <code>Hit</code> column classifying toxicity</p>
</td></tr>
<tr><td><code id="chemSigSelect_+3A_paramlist">paramList</code></td>
<td>
<p>character vector naming columns of <code>data</code> containing concentrations</p>
</td></tr>
<tr><td><code id="chemSigSelect_+3A_plot">plot</code></td>
<td>
<p>logical value indicating whether or not to generate figures comparing concentrations between subsets where <code>Hit == TRUE</code> and <code>Hit == FALSE</code> (default = <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="chemSigSelect_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>chemSig</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>chemSigSelect</code> is used within <code>FPM</code> to quickly run <code>chemSig</code> and export concentrations from <code>data</code> for the
significant chemicals to include in the floating percentile model algorithm. Results are exported in list with two data.frames, separated into chemicals that were significant (<code>"sig"</code>) and non-significant (<code>"nonsig"</code>)
For information on <code>data</code> and <code>paramList</code>, see details of <code>?FPM</code>.
</p>
<p>If <code>plot = TRUE</code>, then a series of plots will be exported comparing the Hit/No-hit data subsets for all chemicals in <code>paramList</code>. Plots with blue lines are generated from
significant chemicals, and plots with green lines are generated from non-significant chemicals. The user currently has only
limited control over graphical parameters of plots, and attempts to change graphical parameters are likely to cause errors.
</p>


<h3>Value</h3>

<p>list of two data.frames (<code>"sig"</code> and <code>"nonsig"</code>), <code>chemSigSelect</code> class object
</p>


<h3>See Also</h3>

<p>plot.chemSigSelect, FPM, chemSig
</p>


<h3>Examples</h3>

<pre><code class='language-R'>paramList = c("Cd", "Cu", "Fe", "Mn", "Ni", "Pb", "Zn")
chemSigSelect(h.tristate, paramList)$sig[1:6,]
chemSigSelect(h.tristate, paramList, testType = "p")$sig[1:6,]
</code></pre>

<hr>
<h2 id='chemVI'>Chemical Variable Importance for Floating Percentile Model Benchmarks</h2><span id='topic+chemVI'></span>

<h3>Description</h3>

<p>Generate statistics describing the relative importance of chemicals among benchmarks generated by <code>FPM</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chemVI(data, paramList, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chemVI_+3A_data">data</code></td>
<td>
<p>data.frame containing, at a minimum, chemical concentrations as columns and a logical <code>Hit</code> column classifying toxicity</p>
</td></tr>
<tr><td><code id="chemVI_+3A_paramlist">paramList</code></td>
<td>
<p>character vector naming columns of <code>data</code> containing concentrations</p>
</td></tr>
<tr><td><code id="chemVI_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>chemSig</code>, <code>chemSigSelect</code>, and <code>FPM</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The purpose of <code>chemVI</code> is to inform the user about the relative influence of each chemical over the sediment quality benchmarks generated by <code>FPM</code>.
Three statistics are generated: <code>chemDensity</code>, <code>MADP</code>, <code>dOR</code>, <code>dFM</code>, and <code>dMCC</code>. The <code>chemDensity</code> statistic (which is also generated by <code>FPM</code>)
describes how little a particular chemical's value increased within the floating percentile model algorithm.
Low <code>chemDensity</code> (close to 0) means that the value was able to increase substantially within the algorithm without triggering one or more of the criteria for
stopping the algorithm (see <code>?FPM</code>), whereas high <code>chemDensity</code> (close to 1) indicates the final benchmark for that chemical did not float (increase)
much before being locked in. In other words, low <code>chemDensity</code> might be interpreted as relatively low importance. We caution against using this
metric in isolation, as it is the more difficult to interpret of the three.
The <code>MADP</code> statistic (or mean absolute difference percent) is calculated by sequentially dropping each chemical from consideration, recalculating the benchmarks
for the remaining chemicals, and then determining how much each benchmark changed (as a percent of the original value). Thus, the <code>MADP</code>
is a measure of a chemical's influence over other benchmarks. The <code>dOR</code> statistic is the difference between the overall reliability
of benchmarks with all chemicals versus without each chemical. <code>dFM</code> and <code>dMCC</code> are similar to the <code>dOR</code> statistic, but for the Fowlkes-Mallows Index
and Matthew's Correlation Coefficient. In any case, larger positive values indicate a greater impact of a chemical
on the overall predictive performance of floating percentile model benchmarks. Small values (close to 0) indicate low influence. Larger negative values indicate that
the chemical actually adversely impacts toxicity predictions. If there are chemicals with negative values, consider reevaluting the data without the associated chemical
or using <code>optimFPM</code> or <code>cvFPM</code> to optimize the overall reliability prior to running <code>FPM</code> and <code>chemVI</code>.
</p>


<h3>Value</h3>

<p>data.frame with 2 columns
</p>


<h3>See Also</h3>

<p>chemSig, chemSigSelect, optimFPM, cvFPM, FPM
</p>


<h3>Examples</h3>

<pre><code class='language-R'>paramList = c("Cd", "Cu", "Fe", "Mn", "Ni", "Pb", "Zn")
chemVI(h.tristate, paramList, testType = "np")
chemVI(h.tristate, paramList, testType = "p")
</code></pre>

<hr>
<h2 id='colorGradient'>Color Gradient Generator</h2><span id='topic+colorGradient'></span>

<h3>Description</h3>

<p>Generate a gradient of hexadecimal colors from a numeric vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colorGradient(x, colors = heat.colors(10), colsteps = 100, na.rm = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="colorGradient_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="colorGradient_+3A_colors">colors</code></td>
<td>
<p>values recognizable by R as colors - text, hexadecimal, numbers, etc. (default = <code>grDevices::heat.colors(10)</code>).</p>
</td></tr>
<tr><td><code id="colorGradient_+3A_colsteps">colsteps</code></td>
<td>
<p>numeric value, number of unique colors to include in gradient</p>
</td></tr>
<tr><td><code id="colorGradient_+3A_na.rm">na.rm</code></td>
<td>
<p>logical value (default = <code>TRUE</code>) indicating whether to exclude <code>NA</code> values in <code>x</code></p>
</td></tr>
<tr><td><code id="colorGradient_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>grDevices::colorRamp</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>colorGradient</code> generates a color gradient based on a numeric input <code>x</code>.
The original version (named 'color.gradient') was written by David Hoop in a 2016 stack.overflow response to question (online). The function was
modified slightly for adaptability of inputs. Note that the full color gradient is used if possible,
which can exaggerate small differences in <code>x</code>. This function is applied by <code>optimFPM</code> when generating color-based
optimization matrix graphics (i.e., when optimizing both <code>alpha</code> and <code>FN_crit</code>).
</p>


<h3>Value</h3>

<p>character vector
</p>


<h3>See Also</h3>

<p>optimFPM, heat.colors, colorRamp
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(n = 100)
cols &lt;- colorGradient(x, c("red", "white", "blue"))
plot(x, col = cols)
</code></pre>

<hr>
<h2 id='cvFPM'>Cross-Validation Optimization of the Floating Percentile Model</h2><span id='topic+cvFPM'></span>

<h3>Description</h3>

<p>Use leave-one-out (LOO) or k-folds cross-validation methods to calculate parameter inputs that optimize benchmark performance
while attempting to account for out-of-sample uncertainty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvFPM(
  data,
  paramList,
  FN_crit = seq(0.1, 0.9, by = 0.05),
  alpha.test = seq(0.05, 0.5, by = 0.05),
  k = 5,
  seed = 1,
  plot = TRUE,
  which = c(1, 2, 3, 4),
  colors = heat.colors(10),
  colsteps = 100,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cvFPM_+3A_data">data</code></td>
<td>
<p>data.frame containing, at a minimum, chemical concentrations as columns and a logical <code>Hit</code> column classifying toxicity</p>
</td></tr>
<tr><td><code id="cvFPM_+3A_paramlist">paramList</code></td>
<td>
<p>character vector of column names of chemical concentration variables in <code>data</code></p>
</td></tr>
<tr><td><code id="cvFPM_+3A_fn_crit">FN_crit</code></td>
<td>
<p>numeric vector of values between 0 and 1 indicating false negative threshold for floating percentile model benchmark selection (default = <code>seq(0.1, 0.9, 0.05)</code>)</p>
</td></tr>
<tr><td><code id="cvFPM_+3A_alpha.test">alpha.test</code></td>
<td>
<p>numeric vector of values between 0 and 1 indicating type-I error rate for chemical selection (default = <code>seq(0.05, 0.5, by = 0.05)</code>)</p>
</td></tr>
<tr><td><code id="cvFPM_+3A_k">k</code></td>
<td>
<p>integer with length = 1 and value &gt; 1 indicating how many folds to include in k-folds type cross-validation method (default = <code>5</code>)</p>
</td></tr>
<tr><td><code id="cvFPM_+3A_seed">seed</code></td>
<td>
<p>integer with length = 1 indicating the random seed to set for assigning k classes for k-folds cross-validation (default = <code>1</code>)</p>
</td></tr>
<tr><td><code id="cvFPM_+3A_plot">plot</code></td>
<td>
<p>whether to plot the output of <code>cvFPM</code> (default = <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="cvFPM_+3A_which">which</code></td>
<td>
<p>numeric or character indicating which type of plot to generate (see Details; default = <code>c(1, 2, 3, 4)</code>)</p>
</td></tr>
<tr><td><code id="cvFPM_+3A_colors">colors</code></td>
<td>
<p>values recognizible as colors to be passed to <code>colorRampPalette</code> (via <code>colorGradient</code>) to generate a palette for plotting (default = <code>heat.colors(10)</code>)</p>
</td></tr>
<tr><td><code id="cvFPM_+3A_colsteps">colsteps</code></td>
<td>
<p>integer; number of discrete steps to interpolate colors in <code>colorGradient</code> (default = <code>100</code>)</p>
</td></tr>
<tr><td><code id="cvFPM_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>chemSig</code> and <code>FPM</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>cvFPM</code> allows users to &quot;tune&quot; the <code>FN_crit</code> and <code>alpha.test</code> arguments used by <code>FPM</code> (via <code>chemSig</code>). This is achieved by splitting the empirical dataset into &quot;test&quot; and &quot;training&quot; subsets,
calculating benchmarks for the training set, and then evaluating the benchmarks' ability to predict Hits in the out-of-sample test set. The output of <code>cvFPM</code> is similar to <code>optimFPM</code>: optimal <code>FN_crit</code> and <code>alpha.test</code> inputs
based on several classification metrics (see <code>?optimFPM</code> for more details). The key difference between <code>cvFPM</code> and <code>optimFPM</code> is that <code>cvFPM</code> attempts to account for
out-of-sample uncertainty, whereas <code>optimFPM</code> is specific (and potentially overly specific) to the full FPM dataset. Because the primary use of FPM SQBs will be to predict
toxicity in sediment samples where toxicity is not measured, the FPM should be parameterized in a way that best accounts for out-of-sample uncertainty. In other words, while FPM
generates classification metrics like &quot;overall reliability&quot; for SQBs, they are unlikely to achieve the expected reliability when applied to new samples. This is an inherent limitation of SQBs,
which the FPM cannot fully address but that <code>cvFPM</code> considers.
</p>
<p>Two cross-validation methods are available, controlled through the <code>k</code> argument. If the user specifies <code>k = NULL</code> or <code>k = nrow(data)</code>, then leave-one-out (LOO) is used.
LOO is computationally intensive but is better suited to small datasets.
Other values of <code>k</code> (e.g., the default <code>k = 5</code>) will result in applying a k-folds cross-validation method, which uses larger test subsets (and smaller training sets),
evaluates fewer scenarios, and greatly improves runtime for large datasets. The <code>seed</code> argument can be used to establish a consistent result; if <code>is.null(seed)</code>, the result will vary based on randomization.
Allowing for randomization may be desireable to understand between-run variability in <code>cvFPM</code> output caused by re-sampling of training/test sets.
</p>
<p>By setting <code>plot = TRUE</code> (the default), the outcome of cross-validation can be visualized over the range of <code>FN_crit</code> values considered. Visualizing the results
can inform the user about variability in the cross-validation process, ranges of potentially reasonable <code>FN_crit</code> values, etc. Graphical output depends on
whether many <code>FN_crit</code> and/or many <code>alpha.test</code> are evaluated, with line plots or heat plots alternately generated.
</p>
<p>IMPORTANT: <code>cvFPM</code> is not in itself optimized for runtime - running <code>cvFPM</code> can take a long time
</p>
<p>The <code>which</code> argument can be used to specify which of the metric-specific plots should be generated when <code>plot = TRUE</code>. Inputs
to <code>which</code> are, by default, <code>c(1, 2, 3, 4)</code>.
</p>


<h3>Value</h3>

<p>data.frame of metric output, base R graphical output
</p>


<h3>See Also</h3>

<p>chemSig, FPM, optimFPM
</p>


<h3>Examples</h3>

<pre><code class='language-R'>paramList = c("Cd", "Cu", "Fe", "Mn", "Ni", "Pb", "Zn")
par(mfrow = c(2,2))
cvFPM(h.tristate, paramList, seq(0.1, 0.9, 0.1), 0.05)
</code></pre>

<hr>
<h2 id='FPM'>Floating Percentile Model</h2><span id='topic+FPM'></span>

<h3>Description</h3>

<p>Generate sediment quality benchmarks using the floating percentile model algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FPM(
  data,
  paramList,
  FN_crit = 0.2,
  paramFixed = NULL,
  paramOverride = FALSE,
  increment = 10,
  precision = 0.1,
  empirical = TRUE,
  defIter = 5,
  seed = 1,
  densInfo = FALSE,
  lockInfo = FALSE,
  hitInfo = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FPM_+3A_data">data</code></td>
<td>
<p>data.frame containing, at a minimum, chemical concentrations as columns and a logical <code>Hit</code> column classifying toxicity</p>
</td></tr>
<tr><td><code id="FPM_+3A_paramlist">paramList</code></td>
<td>
<p>character vector of column names of chemical concentration variables in <code>data</code></p>
</td></tr>
<tr><td><code id="FPM_+3A_fn_crit">FN_crit</code></td>
<td>
<p>numeric vector of values between 0 and 1 indicating false negative threshold(s) for benchmark selection (default = <code>0.2</code>)</p>
</td></tr>
<tr><td><code id="FPM_+3A_paramfixed">paramFixed</code></td>
<td>
<p>character vector of column names of chemical concentration variables to retain, bypassing testing for specific chemicals (default = <code>NULL</code>). See Details.</p>
</td></tr>
<tr><td><code id="FPM_+3A_paramoverride">paramOverride</code></td>
<td>
<p>logical; whether to retain every chemical variable in <code>paramList</code> (default = <code>FALSE</code>). See Details.</p>
</td></tr>
<tr><td><code id="FPM_+3A_increment">increment</code></td>
<td>
<p>numeric value greater than 1; number of increments to evaluate (default = <code>10</code>). See Details.</p>
</td></tr>
<tr><td><code id="FPM_+3A_precision">precision</code></td>
<td>
<p>numeric value between 0 and 1 (default = <code>0.1</code>)</p>
</td></tr>
<tr><td><code id="FPM_+3A_empirical">empirical</code></td>
<td>
<p>logical; whether to return the highest empirical value meeting acceptable conditions of the FPM algorithm (default = <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="FPM_+3A_defiter">defIter</code></td>
<td>
<p>numeric value greater than 0; default number of iterations to use in the case of negative or zero values in <code>data</code> (default = <code>5</code>)</p>
</td></tr>
<tr><td><code id="FPM_+3A_seed">seed</code></td>
<td>
<p>random seed to set for reproducible results; only for handling edge cases of ranking ties (default = <code>1</code>)</p>
</td></tr>
<tr><td><code id="FPM_+3A_densinfo">densInfo</code></td>
<td>
<p>logical; whether to return the &quot;density&quot; statistic defining how much FPM criteria changed within the algorithm (default = <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="FPM_+3A_lockinfo">lockInfo</code></td>
<td>
<p>logical; whether to return the reason for and order in which benchmarks were &quot;locked&quot; within the model algorithm (default = <code>FALSE</code>). See Details.</p>
</td></tr>
<tr><td><code id="FPM_+3A_hitinfo">hitInfo</code></td>
<td>
<p>logical; whether to return the predicted Hit results as part of the output (default = <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="FPM_+3A_...">...</code></td>
<td>
<p>additional argument passed to <code>chemSigSelect</code> and <code>chemSig</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>FPM</code> is the main function provided in 'RFPM', which was developed firstly as a redevelopment of the Washington Department of Ecology's Excel-based
floating percentile model tool (Avocet 2003; Ecology 2011), and secondly as a means to evaluate uncertainties and sensitivities associated with the model. <code>FPM</code> generates
sediment quality benchmarks for chemicals with significantly higher concentrations among <code>Hit</code> samples (meaning they were determined to be categorically toxic).
</p>
<p><code>FPM</code> is an algorithmic approach to setting sediment quality benchmarks using sediment chemistry data and toxicity test results.
Toxicity is treated as a binary classification - either a <code>Hit == TRUE</code> or <code>Hit == FALSE</code> (meaning toxic or non-toxic) by some user-defined definition.
The most important input to <code>FPM</code> apart from the empirical data is <code>FN_crit</code>, which determines an upper limit for false negative errors associated with floating percentile model benchmarks.
The default <code>FN_crit</code> recommended by the Department of Ecology is <code>0.2</code>; though intended to be protective, the value of <code>0.2</code> is arbitrary. We recommend
that the user run the <code>optimFPM</code> and/or <code>cvFPM</code> functions to find the <code>FN_crit</code> value(s) that optimize benchmark performance within an acceptable error range for the site.
<code>optimFPM</code> can also help users optimize the <code>alpha</code> parameter (see <code>?chemSig</code>), which is also somewhat arbitrarily set at a conventional default of <code>0.05</code>.
</p>
<p>There are two arguments that have defaults in <code>FPM</code> that the user may desire to change in certain circumstances, but that we
generally recommend not changing without good reason. These are <code>paramFixed</code> and <code>paramOverride</code>, which override the chemical
selection process, resulting in potentially non-toxic chemicals being assigned benchmarks.
The <code>paramFixed</code> argument, which only forces named chemicals into the model algorithm, is looser than <code>paramOverride</code>, which forces all chemicals in paramList into the model algorithm.
See <code>?chemSig</code> for more information regarding default parameters used within <code>FPM</code>.
Even if chemical names are supplied to <code>paramFixed</code>, <code>FPM</code> will still use hypothesis testing methods to consider all other chemicals for inclusion.
</p>
<p><code>increment</code> determines (inversely) how large or small values should be that are added to percentile values in the model algorithm.
A larger <code>increment</code> results in smaller incremental additions and vice-versa. The WA Department of Ecology recommends a default of
<code>increment = 10</code>. This is a reasonable value, and we recommend not decreasing <code>increment</code> below <code>10</code>.
Increasing <code>increment</code> will increase computation time, and may or may not result in more accurate benchmarks. So, we recommend not
increasing <code>increment</code> much higher than <code>10</code>.
</p>
<p><code>precision</code> determines how many iterative loops will be attempted within the model algorithm when trying to increase each benchmark. If increasing the
benchmark would increase the false negative rate above <code>FN_crit</code>, the benchmark would then be decreased, the increment size is divided by <code>increment</code>, and
then the smaller incremental addition is used to increase the benchmark. This process repeats for a fixed number of iterations, which is related to <code>precision</code>.
If the benchmark cannot be increased after the fixed number of iterations, the benchmark is locked in place.
The default value for <code>precision</code> is <code>0.1</code>, but the value could be lower, if desired. Lowering the value will increase computation time and may or may not
result in more accurate benchmarks. In general, we recommend reducing <code>precision</code> rather than increasing <code>increment</code> in order to potentially enhance the
precision of benchmark calculations.
</p>
<p><code>empirical</code> by default returns empirical concentrations from <code>data</code> that meets the conditions of the FPM. The user can set this argument <code>FALSE</code> if an exact FPM calculation is desired. The exact calculation will still meet the FPM requirements.
</p>
<p>The <code>hitInfo</code> argument allows the user to export the Hit predictions (<code>FPM_Hit</code>) for <code>data</code> based on the calculated FPM criteria as well as the associated FN/FP/TP/TN <code>class</code>.
</p>
<p>The <code>lockInfo</code> argument allows the user to export information about what caused the model algorithm to lock for each
chemical. Output options are: <code>"FN"</code> for exceeding the false negative limit (i.e., <code>FN_crit</code>), <code>"FP"</code> if the number of false positives was reduced to zero,
<code>"Max"</code> if the empirical maximum concentration was exceeded, or <code>Mix</code> if more than one of the first three options occurred.
</p>
<p>The following classification statistics are reported alongside the generated benchmarks:
<code>TP</code>, <code>FN</code>, <code>TN</code>, and <code>FP</code> - the numbers of true positive, false negative, true negative, and false positive predictions
<code>pFN</code> and <code>pFP</code> - proportions of false predictions (false No-hit and false Hit, respectively)
<code>sens</code> - sensitivity; the probability of detecting a Hit
<code>spec</code> - specificity; the probability of detecting a No-hit
<code>OR</code> - overall reliability; the probability of making a correct prediction (Hit or No-hit)
<code>FM</code> - Fowlkes-Mallows Index; geometric mean of sensitivity and the positive predictive rate
<code>MCC</code> - Matthew's Correlation Coefficient; metric analogous to Pearson's coefficient, but instead defining correspondance between categorical predictions and reality (rather than for continuous data).
</p>
<p>The second output of <code>FPM</code> is a metric called <code>chemDensity</code>. This is a measure of how much
the percentile &quot;floated&quot; in the algorithm from the starting position up to the chemical's value at which it was locked in place.
Values of <code>chemDensity</code> closer to 1 floated less and vice-versa. By floating less, this indicates that
even small changes in the chemical concentration resulted in one of the acceptance criteria failing (as discussed above with regard to <code>lockInfo</code>). When comparing
the <code>chemDensity</code> among chemicals, those with lower values might be viewed as having less of an influence on toxicity predictions
and vice-versa. For those interested in understanding the relative importance of chemicals among benchmarks, we recommend using <code>chemVI</code> and considering the <code>MADP</code> and <code>dOR</code> outputs.
</p>


<h3>Value</h3>

<p>list of 2 or 4 objects (depending on <code>lockInfo</code>):
</p>

<ol>
<li><p> Benchmarks and toxicity classification error statistics;
</p>
</li>
<li><p> order in which benchmarks were locked in place;
</p>
</li>
<li><p> reason for benchmarks being locked in place; and
</p>
</li>
<li> <p><code>chemDensity</code> statistic
</p>
</li></ol>



<h3>References</h3>

<p>Avocet. 2003. Development of freshwater sediment quality values for use in Washington State. Phase II report: Development and recommendation of SQVs for freshwater sediments in Washington State. Publication No. 03-09-088. Prepared for Washington Department of Ecology. Avocet Consulting, Kenmore, WA.
Ecology. 2011. Development of benthic SQVs for freshwater sediments in Washington, Oregon, and Idaho. Publication no. 11-09-054. Toxics Cleanup Program, Washington State Department of Ecology, Olympia, WA.
</p>


<h3>See Also</h3>

<p>optimFPM, cvFPM, chemSig, chemSigSelect, chemVI
</p>


<h3>Examples</h3>

<pre><code class='language-R'>paramList = c("Cd", "Cu", "Fe", "Mn", "Ni", "Pb", "Zn")
FPM(h.tristate, paramList, ExcelMode = TRUE, warn = FALSE)
FPM(h.tristate, paramList, c(0.1, 0.2, 0.3))
</code></pre>

<hr>
<h2 id='h.northport'>Northport Data, <em>Hyalella azteca</em> Toxicity</h2><span id='topic+h.northport'></span>

<h3>Description</h3>

<p>Example dataset
</p>


<h3>Format</h3>

<p>A data.frame with 147 rows and 15 variables:
</p>

<dl>
<dt>Sample</dt><dd><p>sediment sample ID</p>
</dd>
<dt>Al</dt><dd><p>aluminum concentration, mg/kg dry weight</p>
</dd>
<dt>As</dt><dd><p>arsenic concentration, mg/kg dry weight</p>
</dd>
<dt>Cu</dt><dd><p>copper concentration, mg/kg dry weight</p>
</dd>
<dt>Cd</dt><dd><p>cadmium concentration, mg/kg dry weight</p>
</dd>
<dt>Cr</dt><dd><p>chromium concentration, mg/kg dry weight</p>
</dd>
<dt>Fe</dt><dd><p>iron concentration, mg/kg dry weight</p>
</dd>
<dt>Pb</dt><dd><p>lead concentration, mg/kg dry weight</p>
</dd>
<dt>Hg</dt><dd><p>mercury concentration, mg/kg dry weight</p>
</dd>
<dt>Ni</dt><dd><p>nickel concentration, mg/kg dry weight</p>
</dd>
<dt>Zn</dt><dd><p>zinc concentration, mg/kg dry weight</p>
</dd>
<dt>Organism</dt><dd><p>organism abbreviation, <code>HA</code> = <em>Hyalella azteca</em></p>
</dd>
<dt>Meas_Day</dt><dd><p>measurement day for toxicity endpoint (post-initiation)</p>
</dd>
<dt>Endpoint</dt><dd><p>toxicity endpoint</p>
</dd>
<dt>Hit</dt><dd><p>logical; whether the sample was classified as toxic</p>
</dd>
</dl>



<h3>Details</h3>

<p><code>h.northport</code> is a field-collected dataset containing sediment chemical concentrations for metals and toxicity classification data for
the amphipod <em>Hyalella azteca</em>. Data are from a freshwater site in Washington State (Dowling and Roland 2019).
</p>


<h3>References</h3>

<p>Dowling B, Roland J. 2019. Establishment of site-specific SMS metals cleanup objectives for contaminated sediments - Northport waterfront and nearshore state cleanup site. Washington State Department of Ecology.
</p>

<hr>
<h2 id='h.tristate'>Tristate Data, <em>Hyalella azteca</em> Toxicity</h2><span id='topic+h.tristate'></span>

<h3>Description</h3>

<p>Example dataset
</p>


<h3>Format</h3>

<p>A data frame with 43 rows and 13 variables:
</p>

<dl>
<dt>Sample.ID</dt><dd><p>sediment sample ID</p>
</dd>
<dt>Sample.type</dt><dd><p>sediment sample type</p>
</dd>
<dt>Organism</dt><dd><p>organism abbreviation, <code>HA</code> = <em>Hyalella azteca</em></p>
</dd>
<dt>Day</dt><dd><p>measurement day for toxicity endpoint (post-initiation)</p>
</dd>
<dt>Endpoint</dt><dd><p>toxicity endpoint</p>
</dd>
<dt>Hit</dt><dd><p>logical; whether we classified the sample as toxic (based on effect &gt;25%)</p>
</dd>
<dt>Cd</dt><dd><p>cadmium concentration, mg/kg dry weight</p>
</dd>
<dt>Cu</dt><dd><p>copper concentration, mg/kg dry weight</p>
</dd>
<dt>Fe</dt><dd><p>iron concentration, mg/kg dry weight</p>
</dd>
<dt>Mn</dt><dd><p>manganese concentration, mg/kg dry weight</p>
</dd>
<dt>Ni</dt><dd><p>nickel concentration, mg/kg dry weight</p>
</dd>
<dt>Pb</dt><dd><p>lead concentration, mg/kg dry weight</p>
</dd>
<dt>Zn</dt><dd><p>zinc concentration, mg/kg dry weight</p>
</dd>
</dl>



<h3>Details</h3>

<p><code>h.trisate</code> is a field-collected dataset containing sediment chemical concentrations for metals and toxicity classification data for
the amphipod <em>Hyalella azteca</em>. Data are from freshwater sites in Kansas, Missouri, and Oklahoma (Ingersoll et al 2008). The Hit variable was
assigned by the authors of this package.
</p>


<h3>References</h3>

<p>Ingersoll CG, MacDonald DD, Besser JM, Brumbaugh WG, Ivey CD, Kemble NE, Kunz JL, May TW, Wang N, Smorong DE. 2008. Sediment chemistry, toxicity, and bioaccumulation data report for the US Environmental Protection Agency - Department of the Interior sampling of metal-contaminated sediment in the Tri-state Mining District in Missouri, Oklahoma, and Kansas. US Geological Survey and MacDonald Environmental Sciences, Ltd., Columbia, MO.
</p>

<hr>
<h2 id='highNoise'>Simulated Floating Percentile Model Data, High Random Noise in Toxicity Prediction</h2><span id='topic+highNoise'></span>

<h3>Description</h3>

<p>Example dataset
</p>


<h3>Format</h3>

<p>data.frame, containing 147 rows and 11 variables:
</p>

<dl>
<dt>Al</dt><dd><p>aluminum concentration, mg/kg dry weight</p>
</dd>
<dt>As</dt><dd><p>arsenic concentration, mg/kg dry weight</p>
</dd>
<dt>Cu</dt><dd><p>copper concentration, mg/kg dry weight</p>
</dd>
<dt>Cd</dt><dd><p>cadmium concentration, mg/kg dry weight</p>
</dd>
<dt>Cr</dt><dd><p>chromium concentration, mg/kg dry weight</p>
</dd>
<dt>Fe</dt><dd><p>iron concentration, mg/kg dry weight</p>
</dd>
<dt>Pb</dt><dd><p>lead concentration, mg/kg dry weight</p>
</dd>
<dt>Hg</dt><dd><p>mercury concentration, mg/kg dry weight</p>
</dd>
<dt>Ni</dt><dd><p>nickel concentration, mg/kg dry weight</p>
</dd>
<dt>Zn</dt><dd><p>zinc concentration, mg/kg dry weight</p>
</dd>
<dt>Hit</dt><dd><p>logical; whether the sample was classified as toxic</p>
</dd>
</dl>



<h3>Details</h3>

<p><code>highNoise</code> provides a sample of simulated data that were developed to analyze variability and sensitivity of <code>FPM</code>.
Simulated datasets (n=1000) were originally developed for the analyses; <code>highNoise</code> is a single realization of the simulation.
Simulations were generated using the covariance matrix of <code>h.northport</code> sediment chemical concentrations and the
<code>rmvnorm</code> function from the 'splus2R' package (Constantine and Hesterberg 2021). <code>Hit</code> values were generated with <code>toxCRM</code>
using simulated concentrations of <code>Cr</code>, <code>Cu</code>, <code>Fe</code>, and <code>Zn</code>
as inputs. The inputs to <code>toxCRM</code> were based on empirical toxicity ranges (minimum and maximum effect levels) as well as
arbitrarily based on probable effect concentration (PEC) and threshold effect concentration (TEC) values from MacDonald et al (2000). Inflection points were
set equal to PECs, and steepnesses were set as the ratio of the PEC to the TEC.
Fe inputs were arbitrary chosen to reflect its low toxicity relative to Cr, Cu, and Zn (e.g., high inflection point and relatively low steepness).
Random normal noise  was added to the <code>highNoise</code> datasets by inputting <code>eSD</code> values into <code>toxCRM</code> equal to 20% of the range of chemical concentrations (chemical-specific).
The median toxicity output (for the 4 chemicals) was compared to a threshold of 75% with <code>Hit == TRUE</code> assigned to values below that level and
<code>Hit == FALSE</code> assigned to values &gt;=75%.
</p>


<h3>References</h3>

<p>Constantine W, Hesterberg T. 2021. splus2R: Supplemental S-PLUS Functionality in R. Version 1.3-3 (online). Updated January 30. Available from: https://cran.r-project.org/web/packages/splus2R/index.html.
MacDonald DD, Ingersoll CG, Berger TA. 2000. Development and evaluation of consensus-based sediment quality guidelines for freshwater ecosystems. Arch Environ Contam Toxicol 39(5):20-31.
</p>


<h3>See Also</h3>

<p>FPM, toxCRM, h.northport, perfect, lowNoise
</p>

<hr>
<h2 id='lowNoise'>Simulated Floating Percentile Model Data, Low Random Noise in Toxicity Prediction</h2><span id='topic+lowNoise'></span>

<h3>Description</h3>

<p>Example dataset
</p>


<h3>Format</h3>

<p>data.frame, containing 147 rows and 11 variables:
</p>

<dl>
<dt>Al</dt><dd><p>aluminum concentration, mg/kg dry weight</p>
</dd>
<dt>As</dt><dd><p>arsenic concentration, mg/kg dry weight</p>
</dd>
<dt>Cu</dt><dd><p>copper concentration, mg/kg dry weight</p>
</dd>
<dt>Cd</dt><dd><p>cadmium concentration, mg/kg dry weight</p>
</dd>
<dt>Cr</dt><dd><p>chromium concentration, mg/kg dry weight</p>
</dd>
<dt>Fe</dt><dd><p>iron concentration, mg/kg dry weight</p>
</dd>
<dt>Pb</dt><dd><p>lead concentration, mg/kg dry weight</p>
</dd>
<dt>Hg</dt><dd><p>mercury concentration, mg/kg dry weight</p>
</dd>
<dt>Ni</dt><dd><p>nickel concentration, mg/kg dry weight</p>
</dd>
<dt>Zn</dt><dd><p>zinc concentration, mg/kg dry weight</p>
</dd>
<dt>Hit</dt><dd><p>logical; whether the sample was classified as toxic</p>
</dd>
</dl>



<h3>Details</h3>

<p><code>lowNoise</code> provides a sample of simulated data that were developed to analyze variability and sensitivity of <code>FPM</code>.
Simulated datasets (n=1000) were originally developed for the analyses; <code>lowNoise</code> is a single realization of the simulation.
Simulations were generated using the covariance matrix of <code>h.northport</code> sediment chemical concentrations and the
<code>rmvnorm</code> function from the 'splus2R' package (Constantine and Hesterberg 2021). The <code>Hit</code> values were generated with <code>toxCRM</code>
using simulated concentrations of <code>Cr</code>, <code>Cu</code>, <code>Fe</code>, and <code>Zn</code>
as inputs. The inputs to <code>toxCRM</code> were based on empirical toxicity ranges (minimum and maximum effect levels) as well as
arbitrarily based on probable effect concentration (PEC) and threshold effect concentration (TEC) values from MacDonald et al (2000). Inflection points were
set equal to PECs, and steepnesses were set as the ratio of the PEC to the TEC.
Fe inputs were arbitrary chosen to reflect its low toxicity relative to Cr, Cu, and Zn (e.g., high inflection point and relatively low steepness).
Random normal noise  was added to the <code>lowNoise</code> datasets by inputting <code>eSD</code> values into <code>toxCRM</code> equal to 10% of the range of chemical concentrations (chemical-specific).
The median toxicity output (for the 4 chemicals) was compared to a threshold of 75% with <code>Hit == TRUE</code> assigned to values below that level and
<code>Hit == FALSE</code> assigned to values &gt;=75%.
</p>


<h3>References</h3>

<p>Constantine W, Hesterberg T. 2021. splus2R: Supplemental S-PLUS Functionality in R. Version 1.3-3 (online). Updated January 30. Available from: https://cran.r-project.org/web/packages/splus2R/index.html
MacDonald DD, Ingersoll CG, Berger TA. 2000. Development and evaluation of consensus-based sediment quality guidelines for freshwater ecosystems. Arch Environ Contam Toxicol 39(5):20-31.
</p>


<h3>See Also</h3>

<p>FPM, toxCRM, h.northport, perfect, highNoise
</p>

<hr>
<h2 id='optimFPM'>Optimization of Floating Percentile Model Parameters</h2><span id='topic+optimFPM'></span>

<h3>Description</h3>

<p>Calculate parameter inputs that optimize benchmark performance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimFPM(
  data,
  paramList,
  FN_crit = seq(0.1, 0.9, by = 0.05),
  alpha.test = seq(0.05, 0.5, by = 0.05),
  which = c(1, 2, 3, 4),
  simplify = TRUE,
  plot = TRUE,
  colors = heat.colors(10),
  colsteps = 100,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimFPM_+3A_data">data</code></td>
<td>
<p>data.frame containing, at a minimum, chemical concentrations as columns and a logical <code>Hit</code> column classifying toxicity</p>
</td></tr>
<tr><td><code id="optimFPM_+3A_paramlist">paramList</code></td>
<td>
<p>character vector of column names of chemical concentration variables in <code>data</code></p>
</td></tr>
<tr><td><code id="optimFPM_+3A_fn_crit">FN_crit</code></td>
<td>
<p>numeric vector over which to optimize false negative thresholds (default = <code>seq(0.1, 0.9, by = 0.05))</code></p>
</td></tr>
<tr><td><code id="optimFPM_+3A_alpha.test">alpha.test</code></td>
<td>
<p>numeric vector of type-I error rate values over which to optimize (default = <code>seq(0.05, 0.5, by = 0.05))</code></p>
</td></tr>
<tr><td><code id="optimFPM_+3A_which">which</code></td>
<td>
<p>numeric or character indicating which type of plot to generate (see Details; default = <code>c(1, 2)</code>)</p>
</td></tr>
<tr><td><code id="optimFPM_+3A_simplify">simplify</code></td>
<td>
<p>logical; whether to generate simplified output (default = <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="optimFPM_+3A_plot">plot</code></td>
<td>
<p>logical; whether to generate a plot to visualize the opimization results</p>
</td></tr>
<tr><td><code id="optimFPM_+3A_colors">colors</code></td>
<td>
<p>values recognizible as colors to be passed to <code>colorRampPalette</code> (via <code>colorGradient</code>) to generate a palette for plotting (default = <code>heat.colors(10)</code>)</p>
</td></tr>
<tr><td><code id="optimFPM_+3A_colsteps">colsteps</code></td>
<td>
<p>integer; number of discrete steps to interpolate colors in <code>colorGradient</code> (default = <code>100</code>)</p>
</td></tr>
<tr><td><code id="optimFPM_+3A_...">...</code></td>
<td>
<p>additional argument passed to <code>FPM</code>, <code>chemSig</code>, <code>chemSigSelect</code>, and <code>colorGradient</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>optimFPM</code> was designed to help optimize the predictive capacity of the benchmarks generated by <code>FPM</code>. The default input parameters to
<code>FPM</code> (i.e., <code>FN_crit = 0.2</code> and <code>alpha.test = 0.05</code>) are arbitrary, and optimization can help to objectively establish more accurate benchmarks.
Graphical output from <code>optimFPM</code> can also help users to understand the relationship(s) between benchmark accuracy/error, <code>FN_crit</code>, and <code>alpha.test</code>.
</p>
<p>Default inputs for <code>FN_crit</code> and <code>alpha.test</code> were selected to represent a reasonable range of values to test. Testing over both ranges
will result in a two-way optimization, which can be computationally intensive. Alternatively, <code>optimFPM</code> can be run for one parameter at a time
by specifying a single value for <code>FN_crit</code> or <code>alpha.test</code>. Note that inputting single values for both <code>FN_crit</code> and <code>alpha.test</code> will generate unhelpful results.
</p>
<p>Several metrics are used for optimization:
</p>

<ol>
<li><p> Ratio of sensitivity/specificity (&quot;sensSpecRatio&quot;), calculated as the minimum of the two metrics divided by the maximum of the two. Therefore, this value will always be between 0 and 1, representing the balance between correct <code>Hit==TRUE</code> and <code>Hit==FALSE</code> predictions.
</p>
</li>
<li><p> Overall reliability (&quot;OR&quot;) (i.e., probability of correctly predicting <code>Hit</code> values)
</p>
</li>
<li><p> Fowlkes-Mallows Index (&quot;FM&quot;) - an average of metrics focusing on predicting <code>Hit==TRUE</code>
</p>
</li>
<li><p> Matthew's Correlation Coefficient (&quot;MCC&quot;) - a measure of the correspondence between the data and predictions analogous to a Pearson's correlation coefficient (but for binary data)
</p>
</li></ol>

<p>Graphical output will differ depending on whether or not a single value is input for <code>FN_crit</code> or <code>alpha.test</code>. Providing a single value for one
of the two arguments will generate a line graph, whereas providing longer vectors (i.e., length &gt; 1) of inputs for both arguments will generate dot matrix plots using <code>colors</code> to generate
a color palette and <code>colsteps</code> to define the granularity of the color gradient with the palette. The order of <code>colors</code> will be plotted
from more optimal to less optimal; for example, the default of <code>heat.colors(10)</code> will show optimal colors as red and less optimal colors as yellower.
By default, multiple plots will be generated, however the <code>which</code> argument can control which plots are generated. Inputs
to <code>which</code> are, by default, <code>c(1, 2, 3, 4)</code> for the metrics noted above, and flexible character inputs also can be used to a degree.
Black squares indicate the optimal argument inputs; these values are also printed to the console and can be assigned to an object.
</p>


<h3>Value</h3>

<p>data.frame of optimized <code>FN_crit</code> and/or <code>alpha.test</code> values
</p>


<h3>See Also</h3>

<p>FPM, colorGradient, colorRampPalette
</p>


<h3>Examples</h3>

<pre><code class='language-R'>paramList = c("Cd", "Cu", "Fe", "Mn", "Ni", "Pb", "Zn")
FN_seq &lt;- seq(0.1, 0.3, 0.05)
alpha_seq &lt;- seq(0.05, 0.2, 0.05)
optimFPM(h.tristate, paramList, FN_seq, 0.05)
optimFPM(h.tristate, paramList, 0.2, alpha_seq)
optimFPM(h.tristate, paramList, FN_seq, alpha_seq, which=2)
</code></pre>

<hr>
<h2 id='perfect'>Simulated Data for Floating Percentile Model, Perfect Toxicity Prediction</h2><span id='topic+perfect'></span>

<h3>Description</h3>

<p>Example dataset
</p>


<h3>Format</h3>

<p>data.frame containing 147 rows and 11 variables:
</p>

<dl>
<dt>Al</dt><dd><p>aluminum concentration, mg/kg dry weight</p>
</dd>
<dt>As</dt><dd><p>arsenic concentration, mg/kg dry weight</p>
</dd>
<dt>Cu</dt><dd><p>copper concentration, mg/kg dry weight</p>
</dd>
<dt>Cd</dt><dd><p>cadmium concentration, mg/kg dry weight</p>
</dd>
<dt>Cr</dt><dd><p>chromium concentration, mg/kg dry weight</p>
</dd>
<dt>Fe</dt><dd><p>iron concentration, mg/kg dry weight</p>
</dd>
<dt>Pb</dt><dd><p>lead concentration, mg/kg dry weight</p>
</dd>
<dt>Hg</dt><dd><p>mercury concentration, mg/kg dry weight</p>
</dd>
<dt>Ni</dt><dd><p>nickel concentration, mg/kg dry weight</p>
</dd>
<dt>Zn</dt><dd><p>zinc concentration, mg/kg dry weight</p>
</dd>
<dt>Hit</dt><dd><p>logical; whether the sample was classified as toxic</p>
</dd>
</dl>



<h3>Details</h3>

<p><code>perfect</code> provides a sample of simulated data that were developed to analyze variability and sensitivity of <code>FPM</code>.
Simulated datasets (n=1000) were originally developed for the analyses; <code>perfect</code> is a single example realization of the simulation.
Simulations were generated using the covariance matrix of <code>h.northport</code> sediment chemical concentrations and the
<code>rmvnorm</code> function from the <code>splus2R</code> package (Constantine and Hesterberg 2021). The <code>Hit</code> values were generated with <code>toxCRM</code>
using simulated concentrations of <code>Cr</code>, <code>Cu</code>, <code>Fe</code>, and <code>Zn</code>
as inputs. The inputs to <code>toxCRM</code> were based on empirical toxicity ranges (minimum and maximum effect levels) as well as
arbitrarily based on probable effect concentration (PEC) and threshold effect concentration (TEC) values from MacDonald et al (2000). Inflection points were
set equal to PECs, and steepnesses were set as the ratio of the PEC to the TEC.
Fe inputs were arbitrary chosen to reflect its low toxicity relative to Cr, Cu, and Zn (e.g., high inflection point and relatively low steepness).
The median toxicity output (for the 4 chemicals) was compared to a threshold of 75% with <code>Hit == TRUE</code> assigned to values below that level and
<code>Hit == FALSE</code> assigned to values &gt;=75%.
</p>


<h3>References</h3>

<p>Constantine W, Hesterberg T. 2021. splus2R: Supplemental S-PLUS Functionality in R. Version 1.3-3 (online). Updated January 30. Available from: https://cran.r-project.org/web/packages/splus2R/index.html.
MacDonald DD, Ingersoll CG, Berger TA. 2000. Development and evaluation of consensus-based sediment quality guidelines for freshwater ecosystems. Arch Environ Contam Toxicol 39(5):20-31.
</p>


<h3>See Also</h3>

<p>FPM, toxCRM, h.northport, lowNoise, highNoise
</p>

<hr>
<h2 id='plot.chemSigSelect'>Plot method for 'chemSigSelect'</h2><span id='topic+plot.chemSigSelect'></span>

<h3>Description</h3>

<p>The plot method for 'chemSigSelect' objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'chemSigSelect'
plot(
  x,
  paramList = NULL,
  type = c("boxplot", "ecdf", "density"),
  logAxes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.chemSigSelect_+3A_x">x</code></td>
<td>
<p><code>chemSigSelect</code> class object</p>
</td></tr>
<tr><td><code id="plot.chemSigSelect_+3A_paramlist">paramList</code></td>
<td>
<p>character vector of column names of chemical concentration variables in <code>data</code>; values will be inherited from <code>x</code> if not specified</p>
</td></tr>
<tr><td><code id="plot.chemSigSelect_+3A_type">type</code></td>
<td>
<p>character vector indicating the type of plot to generate (see Details; default = <code>c("boxplot", "ecdf", "density")</code>)</p>
</td></tr>
<tr><td><code id="plot.chemSigSelect_+3A_logaxes">logAxes</code></td>
<td>
<p>logical value; whether axes should be projected in log-space (default = <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="plot.chemSigSelect_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>plot</code>. The user currently has limited capacity to change graphical parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>plot.chemSigSelect</code> is a class-specific plotting function that generates boxplots, empirical cumulative density functions, or
kernel density plots comparing the <code>Hit == TRUE</code> and <code>Hit == FALSE</code> subsets for all chemicals in <code>paramList</code>.
By default, all plot types are generated, but <code>type</code> can be changed to generate specific plot types. The available types are
specified by <code>"type = boxplot"</code>, <code>"type = ecdf"</code>, and <code>"type = density"</code>, though character inputs are flexible;
for example, other reasonable versions of these types include <code>"Boxplot"</code> and <code>"ECDF"</code>.
Note that because <code>boxplot</code>, <code>plot.ecdf</code>, and <code>plot.density</code> functions use plotting arguments in different ways, supplying
user-defined plotting arguments may cause unintended changes (or possibly errors or warnings) when plotting multiple types. For that reason, we recommend that the user
select a specific plot type (using the <code>type</code> argument) before adjusting plot arguments (via <code>...</code>) that apply to that type.
Moreover, many of the plotting arguments are specified by <code>plot.chemSigSelect</code> and, therefore, cannot be
adjusted by the user. These include but are not limited to parameters like <code>col</code> and <code>lwd</code>.
</p>


<h3>Value</h3>

<p>base graphics
</p>


<h3>See Also</h3>

<p>chemSigSelect, boxplot, plot.ecdf, plot.density
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- chemSigSelect(data = h.tristate, 
    paramList = c("Cd", "Cu", "Fe", "Mn", "Ni", "Pb", "Zn"))
plot(x, type = "boxplot")
</code></pre>

<hr>
<h2 id='predict.FPM'>Predict Toxicity Using the Floating Percentile Model</h2><span id='topic+predict.FPM'></span>

<h3>Description</h3>

<p>Use new sediment chemistry data to generate FPM predictions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FPM'
predict(object, newdata, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.FPM_+3A_object">object</code></td>
<td>
<p>FPM class object, created using <code>FPM</code> (and extracted from the resulting list using <code>.$FPM</code>, where '.' is the name of the object or FPM call)</p>
</td></tr>
<tr><td><code id="predict.FPM_+3A_newdata">newdata</code></td>
<td>
<p>character vector of column names of chemical concentration variables in <code>data</code></p>
</td></tr>
<tr><td><code id="predict.FPM_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two things to keep in mind when using predict for 'FPM' objects. Firstly, when <code>FPM</code> is run, the output object is a list; one of the objects (called &quot;FPM&quot;) is the FPM class object that can be used to predict Hits.
</p>
<p>Secondly, unlike other default &quot;predict&quot; methods, <code>predict.FPM</code> is used strictly to predict toxicity that is not included in the original dataset used to generate <code>fpm</code>.
To predict Hit results for the original data, set <code>hitInfo == TRUE</code> when running the <code>FPM</code> function. Note that predicting toxicity for the original dataset may be arbitrary/unnecessary, as the Hit results for the original dataset must be known.
</p>
<p>Note that, in order to run <code>predict.FPM</code>, the <code>newdata</code> argument must be supplied a <code>data.frame</code> that includes at least one sample with all of the
chemical columns contained in <code>fpm</code>. Column headers must match exactly.
</p>


<h3>Value</h3>

<p>logical
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create FPM object with chemical headings that overlap
overlap &lt;- intersect(names(h.northport)[1:10], 
            names(h.tristate)[7:13])
fpm_object = FPM(h.northport, overlap)
# run predict on the 'FPM' list item to estimate Hits
predict(object = fpm_object$FPM, newdata = h.tristate)
</code></pre>

<hr>
<h2 id='RFPM'>Floating Percentile Model</h2><span id='topic+RFPM'></span>

<h3>Description</h3>

<p>Floating Percentile Model and supporting functions to inform and improve sediment benchmark development
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RFPM()
</code></pre>


<h3>Details</h3>

<p>'RFPM' is an open-source implementation of the floating percentile model (FPM), which was
originally developed by Avocet (2003) using Visual Basic for Applications and distributed to US Pacific Northwest regulatory agencies as a
Microsoft Excel-based tool. 'RFPM' was developed independently by Claire Detering and Brian Church with
support from John Toll and others at Windward Environmental LLC.
</p>
<p>The purpose of the FPM is to generate aquatic toxicity-based sediment quality benchmarks
for management of contaminated freshwater sediment sites. These benchmarks are intended to act as classification thresholds,
meaning that an exceedance of benchmarks would imply that toxicity (as categorically defined) is likely in the sediment sample.
The FPM has been used at sites in the US Pacific Northwest for many years, particularly after being published by the
Washington State Department of Ecology in 2011.
</p>
<p>The primary function in 'RFPM' is <code>FPM</code>, which runs the FPM algorithm on a data.frame object that includes concentrations of
chemicals in sediment as well as a logical toxicity classification column called &quot;Hit&quot;. Example datasets are provided. The output of <code>FPM</code>
includes a set of sediment quality benchmarks for chemicals with significantly higher concentrations when <code>Hit == TRUE</code>
than when <code>Hit == FALSE</code>. Plots comparing the <code>Hit == TRUE</code> and <code>Hit == FALSE</code> data can also
be generated as a diagnostic tool. Supplemental functions (e.g., <code>optimFPM</code>) can help to optimize <code>FPM</code> inputs (resulting in more accurate benchmarks) or evaluate
the relative importance of each chemical among the FPM benchmarks (i.e., <code>chemVI</code>).
</p>
<p>For 'RFPM', the <code>FPM</code> algorithm has been changed from the original Avocet (2003) model. Key changes are as follows:
</p>

<ol>
<li><p> A decision tree is implemented to select statistically appropriate hypothesis tests for chemical selection. This can be overridden if the
original Excel-based tool method is desired; see <code>?chemSig</code> for details. The chemical selection and FPM algorithm have been integrated into <code>FPM</code>, though chemical selection can still be run separately, if desired.
</p>
</li>
<li><p> The iterative looping of the FPM algorithm over multiple false negative limits was
not included in <code>FPM</code>. We find this functionality of the Excel-based tool to be confusing and unnecessary.
Instead, we believe the results generated for different false negative limits should be independently generated rather than dependent on prior model runs.
Thus, <code>FPM</code> allows for multiple false negative limits to be input in a seqeuential but independent manner, resulting in a data.frame of benchmarks with one
row per false negative limit. In R terminology, <code>FPM</code> has been vectorized.
</p>
</li>
<li><p> An optimization function called <code>optimFPM</code> was developed to optimize the overall reliability of FPM sediment quality benchmarks. Different optimization metrics are provided, and a weight of evidence should be considered when selecting inputs.
</p>
</li>
<li><p> A function was developed to quickly calculate chemical &quot;variable importance&quot; statistics using <code>chemVI</code>. These statistics
can inform the user about the influence of specific chemicals over the set of FPM benchmarks and, for example,
whether certain benchmarks can be ignored without a significant loss of predictive ability.
</p>
</li></ol>



<h3>Value</h3>

<p>bibentry
</p>


<h3>References</h3>

<p>Avocet. 2003. Development of freshwater sediment quality values for use in Washington State. Phase II report: Development and recommendation of SQVs for freshwater sediments in Washington State. Publication No. 03-09-088. Prepared for Washington Department of Ecology. Avocet Consulting, Kenmore, WA.
Ecology. 2011. Development of benthic SQVs for freshwater sediments in Washington, Oregon, and Idaho. Publication no. 11-09-054. Toxics Cleanup Program, Washington State Department of Ecology, Olympia, WA.
</p>

<hr>
<h2 id='toxCRM'>Concentration-Response Model, 4-parameter log-logistic curve</h2><span id='topic+toxCRM'></span>

<h3>Description</h3>

<p>Generate dummy toxicity data with strong concentration-response
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toxCRM(x, max = 1, min = 0, steep, mid, eMean = 0, eSD = 0, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="toxCRM_+3A_x">x</code></td>
<td>
<p>numeric vector of chemical concentrations (univariate)</p>
</td></tr>
<tr><td><code id="toxCRM_+3A_max">max</code></td>
<td>
<p>numeric value, asymptotic maximum of model (default = <code>1</code>)</p>
</td></tr>
<tr><td><code id="toxCRM_+3A_min">min</code></td>
<td>
<p>numeric value, asymptotic minimum of model (default = <code>0</code>)</p>
</td></tr>
<tr><td><code id="toxCRM_+3A_steep">steep</code></td>
<td>
<p>numeric value, steepness factor for model slope</p>
</td></tr>
<tr><td><code id="toxCRM_+3A_mid">mid</code></td>
<td>
<p>numeric value, inflection point concentration for CRM slope</p>
</td></tr>
<tr><td><code id="toxCRM_+3A_emean">eMean</code></td>
<td>
<p>numeric value, mean of random-normal error to add to dummy toxicity data (default = <code>0</code>)</p>
</td></tr>
<tr><td><code id="toxCRM_+3A_esd">eSD</code></td>
<td>
<p>numeric value, standard deviation of random-normal error to add to dummy toxicity data (default = <code>0</code>)</p>
</td></tr>
<tr><td><code id="toxCRM_+3A_seed">seed</code></td>
<td>
<p>numeric value, random seed to set for repeatable random error generating (default = <code>NULL</code>, i.e., no seed)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>toxCRM</code> generates dummy toxicity data representing an
idealized condition. This approach was used by the authors to simulate data and test <code>FPM</code> sensitivity
and baseline variability. The user must specify all coefficients of the model (though
default min/max values are provided) and may add some amount of random error, if desired.
Random error adds noise to the dummy toxicity daata, increasing the uncertainty of toxicity predictions using floating percentile model benchmarks. The
<code>perfect</code>, <code>lowNoise</code>, and <code>highNoise</code> datasets included in <code>RFPM</code> were all generated
using <code>toxCRM</code> with increasing levels of <code>eSD</code>.
</p>


<h3>Value</h3>

<p>numeric vector
</p>


<h3>See Also</h3>

<p>perfect, lowNoise, highNoise
</p>


<h3>Examples</h3>

<pre><code class='language-R'>concentration = h.northport$Cu
toxVals &lt;- toxCRM(concentration, 1, 0, 0.5, 
    median(concentration), 0, 0)
plot(concentration, toxVals, log="x", main="Perfect estimate")

toxVals_withNoise &lt;- toxCRM(x = concentration,
    1, 0, 0.5, median(concentration), 0, 0.1, seed = 1)
plot(concentration, toxVals_withNoise, log="x", main="Noisy estimate")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
