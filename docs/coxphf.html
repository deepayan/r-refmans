<!DOCTYPE html><html><head><title>Help for package coxphf</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {coxphf}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coxphf-package'><p>Cox Regression with Firth's Penalized Likelihood</p></a></li>
<li><a href='#augment.coxphf'><p>Augment a coxphf object</p></a></li>
<li><a href='#breast'><p>Breast Cancer Data Set</p></a></li>
<li><a href='#coxphf'><p>Cox Regression with Firth's Penalized Likelihood</p></a></li>
<li><a href='#coxphfplot'><p>Plot the Penalized Profile Likelhood Function</p></a></li>
<li><a href='#coxphftest'><p>Penalized Likelihood Ratio Test in Cox Regression</p></a></li>
<li><a href='#glance.coxphf'><p>Glance at a coxphf object</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#tidy.coxphf'><p>Tidy a coxphf object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.13.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-09</td>
</tr>
<tr>
<td>Title:</td>
<td>Cox Regression with Firth's Penalized Likelihood</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>survival, generics, tibble</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements Firth's penalized maximum likelihood bias reduction method  for Cox regression
  which has been shown to provide a solution in case of monotone likelihood (nonconvergence of likelihood function), see 
  Heinze and Schemper (2001) and Heinze and Dunkler (2008).
  The program fits profile penalized likelihood confidence intervals which were proved to outperform
  Wald confidence intervals.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://cemsiis.meduniwien.ac.at/kb/wf/software/statistische-software/fccoxphf/">https://cemsiis.meduniwien.ac.at/kb/wf/software/statistische-software/fccoxphf/</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/georgheinze/coxphf/issues/">https://github.com/georgheinze/coxphf/issues/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-11 07:34:51 UTC; Gregor</td>
</tr>
<tr>
<td>Author:</td>
<td>Georg Heinze [aut, cre],
  Meinhard Ploner [aut],
  Lena Jiricka [aut],
  Gregor Steiner [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Georg Heinze &lt;georg.heinze@meduniwien.ac.at&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-11 12:53:52 UTC</td>
</tr>
</table>
<hr>
<h2 id='coxphf-package'>Cox Regression with Firth's Penalized Likelihood</h2><span id='topic+coxphf-package'></span><span id='topic+_PACKAGE'></span>

<h3>Description</h3>

<p>Implements Firth's penalized maximum likelihood bias reduction method  for Cox regression which has been 
shown to provide a solution in case of monotone likelihood (nonconvergence of likelihood function).
The program fits profile penalized likelihood confidence intervals which were proved to outperform
Wald confidence intervals.
</p>


<h3>Details</h3>

<p>The phenomenon of monotone likelihood in a sample causes parameter estimates of a Cox model to diverge, 
with infinite standard errors. Therefore, classical maximum likelihood analysis fails; the usual Wald confidence 
intervals cover the whole range of real numbers. Monotone likelihood appears if there is single covariate 
or a linear combination of covariates such that at each event time, out of all individuals being at risk at that time, 
the individual with the highest (or at each event time the individual with the lowest) value for that covariate 
or linear combination experiences the event. It was shown that analysis by Firth's penalized likelihood method, 
particularly in conjunction with the computation of profile likelihood confidence intervals and penalized 
likelihood ratio tests is superior to maximum likelihood analysis. It completely removes the convergence
problem mentioned in the paragraph on CONVERGENCE of the description of the function <code>coxph</code>. 
The <code>formula</code> may involve time-dependent effects or time-dependent covariates. The response may be given 
in counting process style, but it cannot be used for multivariate failure times, as the program has no option 
to fit a robust covariance matrix. The user is responsible for the independency of observations within each risk set, i.e., 
the same individual should not appear twice within the same risk set.
</p>
<p>The package coxphf provides a comprehensive tool to facilitate the application of Firth's penalized 
likelihood method to Cox regression analysis. The core routines are written in Fortran 90, (and to our knowledge this is the first package written in Fortran 90). Some description of the problem of monotone likelihood
and Firth's penalized likelihood method as a solution can be found the web page 
<a href="https://cemsiis.meduniwien.ac.at/en/kb/science-research/software/statistical-software/fccoxphf/">https://cemsiis.meduniwien.ac.at/en/kb/science-research/software/statistical-software/fccoxphf/</a>.
</p>
<p>Version 1.13  now includes a convergence check and issues a warning in case of non-convergence. Profile likelihood confidence intervals or 
the estimation of the penalized likelihood ratio $p$-values can be vulnerable
non-convergence for numerical issues. In case of non-convergence problems, we suggest to first compare the output values iter.ci with the input parameter maxit. 
Then, set maxstep to a smaller value, e.g., 0.1 and increase the number of allowed iterations to e.g. 500. This setting may slow down convergence for some 
of the confidence limits, but proved robust also in extreme data sets.
</p>


<h3>Author(s)</h3>

<p>Georg Heinze &lt;georg.heinze@meduniwien.ac.at&gt; and Meinhard Ploner
</p>


<h3>References</h3>

<p>Firth D (1993). Bias reduction of maximum likelihood estimates. <em>Biometrika</em> 80:27&ndash;38.
Heinze G and Schemper M (2001). A Solution to the Problem of Monotone Likelihood in Cox Regression. <em>Biometrics</em> 57(1):114&ndash;119. 
Heinze G (1999). Technical Report 10/1999: The application of Firth's procedure to Cox and logistic regression. Section of Clinical Biometrics, Department of Medical Computer Sciences, University of Vienna, Vienna.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://cemsiis.meduniwien.ac.at/kb/wf/software/statistische-software/fccoxphf/">https://cemsiis.meduniwien.ac.at/kb/wf/software/statistische-software/fccoxphf/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/georgheinze/coxphf/issues/">https://github.com/georgheinze/coxphf/issues/</a>
</p>
</li></ul>


<hr>
<h2 id='augment.coxphf'>Augment a coxphf object</h2><span id='topic+augment.coxphf'></span>

<h3>Description</h3>

<p>Augment a coxphf object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>augment.coxphf(x, data = x$y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="augment.coxphf_+3A_x">x</code></td>
<td>
<p>A 'coxphf' object.</p>
</td></tr>
<tr><td><code id="augment.coxphf_+3A_data">data</code></td>
<td>
<p>the dataset used to fit the model.</p>
</td></tr>
<tr><td><code id="augment.coxphf_+3A_...">...</code></td>
<td>
<p>Unused, included for generic consistency only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tidy [tibble::tibble()] summarizing component-level
information about the model
</p>

<hr>
<h2 id='breast'>Breast Cancer Data Set</h2><span id='topic+breast'></span>

<h3>Description</h3>

<p>Provides the breast cancer data set as used by Heinze &amp; Schemper, 2001. 
The data sets contains information on 100 breast cancer patients, including:
survival time, survival status, Tumor stage, Nodal status, Grading, Cathepsin-D tumorexpression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>breast
</code></pre>


<h3>Format</h3>

<p>A data frame with 100 observations on the following 6 variables.
</p>

<dl>
<dt><code>T</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>N</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>G</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>CD</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>TIME</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>CENS</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>References</h3>

<p>Heinze, G., and Schemper, M. 2001. A solution to the problem of monotone likelihood. Biometrics 57(1) pp. 114-119.
</p>

<hr>
<h2 id='coxphf'>Cox Regression with Firth's Penalized Likelihood</h2><span id='topic+coxphf'></span>

<h3>Description</h3>

<p>Implements Firth's penalized maximum likelihood bias reduction method  for Cox regression 
which has been shown to provide a solution in case of monotone likelihood (nonconvergence of likelihood function). 
The program fits profile penalized likelihood confidence intervals which were proved to outperform 
Wald confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coxphf(
  formula,
  data,
  pl = TRUE,
  alpha = 0.05,
  maxit = 50,
  maxhs = 5,
  epsilon = 1e-06,
  gconv = 1e-04,
  maxstep = 0.5,
  firth = TRUE,
  adapt = NULL,
  penalty = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coxphf_+3A_formula">formula</code></td>
<td>
<p>a formula object, with the response on the left and the model terms on the right. 
The response must be a survival object as returned by the 'Surv' function (see its documentation in the survival package)</p>
</td></tr>
<tr><td><code id="coxphf_+3A_data">data</code></td>
<td>
<p>a data.frame in which to interpret the variables named in the 'formula' argument.</p>
</td></tr>
<tr><td><code id="coxphf_+3A_pl">pl</code></td>
<td>
<p>specifies if confidence intervals and tests should be based on the profile penalized log likelihood (<code>pl=TRUE</code>, the default) or on the Wald method (<code>pl=FALSE</code>).</p>
</td></tr>
<tr><td><code id="coxphf_+3A_alpha">alpha</code></td>
<td>
<p>the significance level (1-<code class="reqn">\alpha</code> = the confidence level), 0.05 as default.</p>
</td></tr>
<tr><td><code id="coxphf_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations (default value is 50)</p>
</td></tr>
<tr><td><code id="coxphf_+3A_maxhs">maxhs</code></td>
<td>
<p>maximum number of step-halvings per iterations (default value is 5). 
The increments of the parameter vector in one Newton-Rhaphson iteration step are halved,
unless the new likelihood is greater than the old one, maximally doing <code>maxhs</code> halvings.</p>
</td></tr>
<tr><td><code id="coxphf_+3A_epsilon">epsilon</code></td>
<td>
<p>specifies the maximum allowed change in standardized parameter estimates to declare convergence. Default value is 1e-6.</p>
</td></tr>
<tr><td><code id="coxphf_+3A_gconv">gconv</code></td>
<td>
<p>specifies the maximum allowed absolute value of first derivative of likelihood to declare convergence. Default value is 0.0001.</p>
</td></tr>
<tr><td><code id="coxphf_+3A_maxstep">maxstep</code></td>
<td>
<p>specifies the maximum change of (standardized) parameter values allowed in one iteration. Default value is 0.5.</p>
</td></tr>
<tr><td><code id="coxphf_+3A_firth">firth</code></td>
<td>
<p>use of Firth's penalized maximum likelihood (<code>firth=TRUE</code>, default) or the standard maximum likelihood method (<code>firth=FALSE</code>) for fitting the Cox model.</p>
</td></tr>
<tr><td><code id="coxphf_+3A_adapt">adapt</code></td>
<td>
<p>optional: specifies a vector of 1s and 0s, where 0 means that the corresponding parameter is fixed at 0, while 1 enables parameter estimation for that parameter. The length of adapt must be equal to the number of parameters to be estimated.</p>
</td></tr>
<tr><td><code id="coxphf_+3A_penalty">penalty</code></td>
<td>
<p>strength of Firth-type penalty. Defaults to 0.5.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The phenomenon of monotone likelihood in a sample causes parameter estimates of a Cox model to diverge, with 
infinite standard errors. Therefore, classical maximum likelihood analysis fails; the usual Wald confidence 
intervals cover the whole range of real numbers. Monotone likelihood appears if there is single covariate
or a linear combination of covariates such that at each event time, out of all individuals being at risk at 
that time, the individual with the highest (or at each event time the individual with the lowest) value for that covariate or linear combination experiences the event. It was shown that 
analysis by Firth's penalized likelihood method, particularly in conjunction with the computation
of profile likelihood confidence intervals and penalized likelihood ratio tests is superior to maximum
likelihood analysis. It completely removes the convergence problem mentioned in the paragraph on CONVERGENCE of
the description of the function <code>coxph</code>. The <code>formula</code> may involve time-dependent effects or 
time-dependent covariates. The response may
be given in counting process style, but it cannot be used for multivariate failure times, as the program has no option
to fit a robust covariance matrix. The user is responsible for the independency of observations within each risk set, i.e., 
the same individual should not appear twice within the same risk set.
</p>


<h3>Value</h3>

<p>The object returned is of the class <code>coxphf</code> and has the following attributes:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>the parameter estimates</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the significance level = 1 - confidence level</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>the estimated covariance matrix</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the degrees of freedom</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>the null and maximimized (penalized) log likelihood</p>
</td></tr>
<tr><td><code>method.ties</code></td>
<td>
<p>the ties handling method</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>the number of iterations needed to converge</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>the number of observations</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the response</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>the model formula</p>
</td></tr>
<tr><td><code>means</code></td>
<td>
<p>the means of the covariates</p>
</td></tr>
<tr><td><code>linear.predictors</code></td>
<td>
<p>the linear predictors</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the estimation method (Standard ML or Penalized ML)</p>
</td></tr>
<tr><td><code>method.ci</code></td>
<td>
<p>the confidence interval estimation method (Profile Likelihood or Wald)</p>
</td></tr>
<tr><td><code>ci.lower</code></td>
<td>
<p>the lower confidence limits</p>
</td></tr>
<tr><td><code>ci.upper</code></td>
<td>
<p>the upper confidence limits</p>
</td></tr>
<tr><td><code>prob</code></td>
<td>
<p>the p-values</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the function call</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>the terms object used</p>
</td></tr>
<tr><td><code>iter.ci</code></td>
<td>
<p>the numbers of iterations needed for profile likelihood confidence interval estimation, and for maximizing the restricted likelihood for p-value computation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Georg Heinze and Meinhard Ploner
</p>


<h3>References</h3>

<p>Firth D (1993). Bias reduction of maximum likelihood estimates. <em>Biometrika</em> 80:27&ndash;38.
</p>
<p>Heinze G and Schemper M (2001). A Solution to the Problem of Monotone Likelihood in Cox Regression. <em>Biometrics</em> 57(1):114&ndash;119. 
</p>
<p>Heinze G (1999). Technical Report 10/1999: The application of Firth's procedure to Cox and logistic regression. Section of Clinical Biometrics, Department of Medical Computer Sciences, University of Vienna, Vienna.
</p>


<h3>See Also</h3>

<p>[coxphfplot, coxphftest]
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fixed covariate and monotone likelihood
library(survival)
time&lt;-c(1,2,3)
cens&lt;-c(1,1,1)
x&lt;-c(1,1,0)
sim&lt;-cbind(time,cens,x)
sim&lt;-data.frame(sim)
coxphf(sim, formula=Surv(time,cens)~x) #convergence attained!
#coxph(sim, formula=Surv(time,cens)~x)  #no convergence!
# time-dependent covariate
test2 &lt;- data.frame(list(start=c(1, 2, 5, 2, 1, 7, 3, 4, 8, 8),
                         stop =c(2, 3, 6, 7, 8, 9, 9, 9,14,17),
                         event=c(1, 1, 1, 1, 1, 1, 1, 0, 0, 0),
                         x    =c(1, 0, 0, 1, 0, 1, 1, 1, 0, 0) ))

summary( coxphf( formula=Surv(start, stop, event) ~ x, pl=FALSE, data=test2))


# time-dependent effect
# the coxphf function can handle interactions of a (fixed or time-dependent)
# covariate with time
# such that the hazard ratio can be expressed as a function of time

summary(coxphf(formula=Surv(start, stop, event)~x+x:log(stop), data=test2, pl=FALSE, firth=TRUE))

# note that coxph would treat x:log(stop) as a fixed covariate
# (computed before the iteration process)
# coxphf treats x:log(stop) as a time-dependent covariate which changes (
# for the same individual!) over time


# time-dependent effect with monotone likelihood

test3 &lt;- data.frame(list(start=c(1, 2, 5, 2, 1, 7, 3, 4, 8, 8),
                         stop =c(2, 3, 6, 7, 8, 9, 9, 9,14,17),
                         event=c(1, 0, 0, 1, 0, 1, 1, 0, 0, 0),
                         x    =c(1, 0, 0, 1, 0, 1, 1, 1, 0, 0) ))

summary( coxphf( formula=Surv(start, stop, event) ~ x+x:log(stop), pl=FALSE, maxit=400, data=test3))


# no convergence if option "firth" is turned off: 
# summary( coxphf(formula=Surv(start, stop, event) ~ x+x:log(stop), pl=F,
#                 data=test3, firth=FALSE)


data(breast)
fit.breast&lt;-coxphf(data=breast, Surv(TIME,CENS)~T+N+G+CD)
summary(fit.breast)

</code></pre>

<hr>
<h2 id='coxphfplot'>Plot the Penalized Profile Likelhood Function</h2><span id='topic+coxphfplot'></span>

<h3>Description</h3>

<p>Plots the penalized profile likelihood for a specified parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coxphfplot(
  formula,
  data,
  profile,
  pitch = 0.05,
  limits,
  alpha = 0.05,
  maxit = 50,
  maxhs = 5,
  epsilon = 1e-06,
  maxstep = 0.5,
  firth = TRUE,
  penalty = 0.5,
  adapt = NULL,
  legend = "center",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coxphfplot_+3A_formula">formula</code></td>
<td>
<p>a formula object, with the response on the left of the  operator, and the
model terms on the right. The response must be a survival object as returned by the 'Surv' function.</p>
</td></tr>
<tr><td><code id="coxphfplot_+3A_data">data</code></td>
<td>
<p>a data.frame in which to interpret the variables named in the 'formula' argument.</p>
</td></tr>
<tr><td><code id="coxphfplot_+3A_profile">profile</code></td>
<td>
<p>a righthand formula specifying the plotted parameter, interaction or general term, e.g. <code>~ A</code> or <code>~ A : C</code>.</p>
</td></tr>
<tr><td><code id="coxphfplot_+3A_pitch">pitch</code></td>
<td>
<p>distances between the interpolated points in standard errors of the parameter estimate, the default value is 0.05.</p>
</td></tr>
<tr><td><code id="coxphfplot_+3A_limits">limits</code></td>
<td>
<p>the range of the x-axis in terms of standard errors from the parameter estimate. The default values 
are the extremes of both confidence intervals, Wald and PL, plus or minus half a
standard error, respectively.</p>
</td></tr>
<tr><td><code id="coxphfplot_+3A_alpha">alpha</code></td>
<td>
<p>the significance level (1-<code class="reqn">\alpha</code> the confidence level, 0.05 as default).</p>
</td></tr>
<tr><td><code id="coxphfplot_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations (default value is 50)</p>
</td></tr>
<tr><td><code id="coxphfplot_+3A_maxhs">maxhs</code></td>
<td>
<p>maximum number of step-halvings per iterations (default value is 5). 
The increments of the parameter vector in one Newton-Rhaphson iteration step are halved, 
unless the new likelihood is greater than the old one, maximally doing <code>maxhs</code> halvings.</p>
</td></tr>
<tr><td><code id="coxphfplot_+3A_epsilon">epsilon</code></td>
<td>
<p>specifies the maximum allowed change in penalized log likelihood to declare convergence. Default value is 0.0001.</p>
</td></tr>
<tr><td><code id="coxphfplot_+3A_maxstep">maxstep</code></td>
<td>
<p>specifies the maximum change of (standardized) parameter values allowed in one iteration. Default value is 2.5.</p>
</td></tr>
<tr><td><code id="coxphfplot_+3A_firth">firth</code></td>
<td>
<p>use of Firth's penalized maximum likelihood (<code>firth=TRUE</code>, default) or the standard maximum likelihood method (<code>firth=FALSE</code>) for fitting the Cox model.</p>
</td></tr>
<tr><td><code id="coxphfplot_+3A_penalty">penalty</code></td>
<td>
<p>optional: specifies a vector of 1s and 0s, where 0 means that the corresponding parameter is fixed at 0, while 1 enables 
parameter estimation for that parameter. The length of adapt must be equal to the number of parameters to be estimated.</p>
</td></tr>
<tr><td><code id="coxphfplot_+3A_adapt">adapt</code></td>
<td>
<p>strength of Firth-type penalty. Defaults to 0.5.</p>
</td></tr>
<tr><td><code id="coxphfplot_+3A_legend">legend</code></td>
<td>
<p>if FALSE, legends in the plot would be omitted (default is TRUE).</p>
</td></tr>
<tr><td><code id="coxphfplot_+3A_...">...</code></td>
<td>
<p>other parameters to legend</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots the profile (penalized) log likelihood of the specified parameter. A symmetric shape of 
the profile (penalized) log likelihood (PPL) function allows use of Wald intervals, while an
asymmetric shape demands profile (penalized) likelihood intervals (Heinze &amp; Schemper (2001)).
</p>


<h3>Value</h3>

<p>A matrix of dimension <code class="reqn">m \times 3</code>, with <code class="reqn">m = 1/\code{pitch} + 1</code>. 
With the default settings, <code class="reqn">m=101</code>. The column headers are:
</p>
<table>
<tr><td><code>std</code></td>
<td>
<p>the distance from the parameter estimate in standard errors</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>the parameter value</p>
</td></tr>
<tr><td><code>log-likelihood</code></td>
<td>
<p>the profile likelihood at <code>x</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Georg Heinze and Meinhard Ploner
</p>


<h3>References</h3>

<p>Firth D (1993). Bias reduction of maximum likelihood estimates. <em>Biometrika</em> 80:27&ndash;38.
</p>
<p>Heinze G and Schemper M (2001). A Solution to the Problem of Monotone Likelihood in Cox Regression. <em>Biometrics</em> 57(1):114&ndash;119. 
</p>
<p>Heinze G (1999). Technical Report 10/1999: The application of Firth's procedure to Cox and logistic regression. Section of Clinical Biometrics, Department of Medical Computer Sciences, University of Vienna, Vienna.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(survival)
time&lt;-c(1,2,3)
cens&lt;-c(1,1,1)
x&lt;-c(1,1,0)
sim&lt;-cbind(time,cens,x)
sim&lt;-data.frame(sim)
profplot&lt;-coxphfplot(sim, formula=Surv(time,cens)~x, profile=~x)

</code></pre>

<hr>
<h2 id='coxphftest'>Penalized Likelihood Ratio Test in Cox Regression</h2><span id='topic+coxphftest'></span>

<h3>Description</h3>

<p>Performs a penalized likelihood ratio test for hypotheses within a Cox regression analysis using Firth's penalized likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coxphftest(
  formula,
  data,
  test = ~.,
  values,
  maxit = 50,
  maxhs = 5,
  epsilon = 1e-06,
  maxstep = 0.5,
  firth = TRUE,
  adapt = NULL,
  penalty = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coxphftest_+3A_formula">formula</code></td>
<td>
<p>a formula object, with the response on the left of the  operator, and the model terms on the right. The response must be a survival object as returned by the 'Surv' function.</p>
</td></tr>
<tr><td><code id="coxphftest_+3A_data">data</code></td>
<td>
<p>a data.frame in which to interpret the variables named in the 'formula' argument.</p>
</td></tr>
<tr><td><code id="coxphftest_+3A_test">test</code></td>
<td>
<p>righthand formula of parameters to test (e.g. <code>~ B + D</code>). As default the null hypothesis that all parameters are 0 is tested.</p>
</td></tr>
<tr><td><code id="coxphftest_+3A_values">values</code></td>
<td>
<p>null hypothesis values, default values are 0. For testing the hypothesis H0: B1=1 and B4=2 and B5=0, specify <code>test= ~ B1 + B4 + B5</code> and <code>values=c(1, 2, 0)</code>.</p>
</td></tr>
<tr><td><code id="coxphftest_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations (default value is 50)</p>
</td></tr>
<tr><td><code id="coxphftest_+3A_maxhs">maxhs</code></td>
<td>
<p>maximum number of step-halvings per iterations (default value is 5). The increments of the parameter vector in one Newton-Rhaphson iteration step are halved, unless the new likelihood is greater than the old one, maximally doing <code>maxhs</code> halvings.</p>
</td></tr>
<tr><td><code id="coxphftest_+3A_epsilon">epsilon</code></td>
<td>
<p>specifies the maximum allowed change in penalized log likelihood todeclare convergence. Default value is 0.0001.</p>
</td></tr>
<tr><td><code id="coxphftest_+3A_maxstep">maxstep</code></td>
<td>
<p>specifies the maximum change of (standardized) parameter values allowed in one iteration. Default value is 2.5.</p>
</td></tr>
<tr><td><code id="coxphftest_+3A_firth">firth</code></td>
<td>
<p>use of Firth's penalized maximum likelihood (<code>firth=TRUE</code>, default) or the standard maximum likelihood method (<code>firth=FALSE</code>) for fitting the Cox model.</p>
</td></tr>
<tr><td><code id="coxphftest_+3A_adapt">adapt</code></td>
<td>
<p>optional: specifies a vector of 1s and 0s, where 0 means that the corresponding parameter is fixed at 0, while 1 enables 
parameter estimation for that parameter. The length of adapt must be equal to the number of parameters to be estimated.</p>
</td></tr>
<tr><td><code id="coxphftest_+3A_penalty">penalty</code></td>
<td>
<p>strength of Firth-type penalty. Defaults to 0.5.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs a penalized likelihood ratio test on some (or all) selected parameters.  
It can be used to test contrasts of parameters, or factors that are coded in dummy variables. 
The resulting object is of the class coxphftest and includes the information printed by the proper print method.
</p>


<h3>Value</h3>

<table>
<tr><td><code>testcov</code></td>
<td>
<p>the names of the tested model terms</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>the restricted and unrestricted maximized (penalized) log likelihood</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the number of degrees of freedom related to the test</p>
</td></tr>
<tr><td><code>prob</code></td>
<td>
<p>the p-value</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the function call</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the estimation method (penalized ML or ML)</p>
</td></tr>
</table>


<h3>References</h3>

<p>Firth D (1993). Bias reduction of maximum likelihood estimates. <em>Biometrika</em> 80:27&ndash;38.
</p>
<p>Heinze G and Schemper M (2001). A Solution to the Problem of Monotone Likelihood in Cox Regression. <em>Biometrics</em> 57(1):114&ndash;119. 
</p>
<p>Heinze G (1999). Technical Report 10/1999: The application of Firth's procedure to Cox and logistic regression. Section of Clinical Biometrics, Department of Medical Computer Sciences, University of Vienna, Vienna.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(survival)
testdata &lt;- data.frame(list(start=c(1, 2, 5, 2, 1, 7, 3, 4, 8, 8),
stop =c(2, 3, 6, 7, 8, 9, 9, 9,14,17),
event=c(1, 1, 1, 1, 1, 1, 1, 0, 0, 0),
x1    =c(1, 0, 0, 1, 0, 1, 1, 1, 0, 0),
x2    =c(0, 1, 1, 1, 0, 0, 1, 0, 1, 0),
x3    =c(1, 0, 1, 0, 1, 0, 1, 0, 1, 0)))

summary( coxphf( formula=Surv(start, stop, event) ~ x1+x2+x3, data=testdata))

# testing H0: x1=0, x2=0

coxphftest( formula=Surv(start, stop, event) ~ x1+x2+x3, test=~x1+x2,  data=testdata)



# How to test total effect of a variable with time-dependent effect

# NOT RUN (works)
#fitt&lt;- coxphf( formula=Surv(start, stop, event) ~ x1+x2+x3*stop, data=testdata, pl=FALSE)

#test &lt;- coxphf(formula=Surv(start, stop, event) ~ x1+x2+x3*stop, data=testdata, adapt=c(1,1,0,0))

# PLR p-value for x3 + x3:stop
#pchisq((fitt$loglik[2]-test$loglik[2])*2, 2, lower.tail=FALSE)

#NOT RUN (does not work)
#test &lt;- coxphf(formula=Surv(start, stop, event) ~ x1+x2+x3*stop, data=testdata, test=~x3+stop:x3)


</code></pre>

<hr>
<h2 id='glance.coxphf'>Glance at a coxphf object</h2><span id='topic+glance.coxphf'></span>

<h3>Description</h3>

<p>Glance at a coxphf object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'coxphf'
glance(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glance.coxphf_+3A_x">x</code></td>
<td>
<p>A 'coxphf' object.</p>
</td></tr>
<tr><td><code id="glance.coxphf_+3A_...">...</code></td>
<td>
<p>Unused, included for generic consistency only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tidy [tibble::tibble()] summarizing component-level
information about the model
</p>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+glance'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>generics</dt><dd><p><code><a href="generics.html#topic+glance">glance</a></code></p>
</dd>
</dl>

<hr>
<h2 id='tidy.coxphf'>Tidy a coxphf object</h2><span id='topic+tidy.coxphf'></span>

<h3>Description</h3>

<p>Tidy a coxphf object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tidy.coxphf(x, conf.int = FALSE, conf.level = 0.95, exponentiate = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tidy.coxphf_+3A_x">x</code></td>
<td>
<p>A 'coxphf' object.</p>
</td></tr>
<tr><td><code id="tidy.coxphf_+3A_conf.int">conf.int</code></td>
<td>
<p>Logical indicating whether or not to include 
a confidence interval in the tidied output. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="tidy.coxphf_+3A_conf.level">conf.level</code></td>
<td>
<p>The confidence level to use for the confidence 
interval if conf.int = TRUE. Must be strictly greater than 0 
and less than 1. Defaults to 0.95, which corresponds to a 
95 percent confidence interval.</p>
</td></tr>
<tr><td><code id="tidy.coxphf_+3A_exponentiate">exponentiate</code></td>
<td>
<p>Logical indicating whether or not to display coefficient
estimates on an exponential scale.</p>
</td></tr>
<tr><td><code id="tidy.coxphf_+3A_...">...</code></td>
<td>
<p>Unused, included for generic consistency only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tidy [tibble::tibble()] summarizing component-level
information about the model
</p>
<p>import tibble
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
