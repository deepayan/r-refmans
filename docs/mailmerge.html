<!DOCTYPE html><html><head><title>Help for package mailmerge</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mailmerge}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#in_viewer'><p>Display email message in RStudio viewer pane.</p></a></li>
<li><a href='#mail_merge'><p>Merges data into an email and send.</p></a></li>
<li><a href='#mailmerge-package'><p>mailmerge: Mail Merge Using R Markdown Documents and 'gmailr'</p></a></li>
<li><a href='#mm_preview_mail'><p>Preview message in viewer pane.</p></a></li>
<li><a href='#mm_read_googledoc'><p>Read a markdown file from google drive</p></a></li>
<li><a href='#mm_read_message'><p>Parse a markdown document into yaml and body components.</p></a></li>
<li><a href='#mm_read_message_googledoc'><p>Parse the email template inside a markdown document on google drive.</p></a></li>
<li><a href='#mm_send_draft'><p>Send draft email.</p></a></li>
<li><a href='#mm_send_mail'><p>Send email.</p></a></li>
<li><a href='#preview_mailmerge'><p>Preview mailmerge as shiny gadget in RStudio preview pane.</p></a></li>
<li><a href='#yesno'><p>Wait for interactive response to yes/no challenge question.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Mail Merge Using R Markdown Documents and 'gmailr'</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.5</td>
</tr>
<tr>
<td>Description:</td>
<td>Perform a mail merge (mass email) using the message defined in 
    markdown, the recipients in a 'csv' file, and gmail as the mailing engine. 
    With this package you can parse markdown documents as the body of email, and 
    the 'yaml' header to specify the subject line of the email.  Any '{}' braces 
    in the email will be encoded with 'glue::glue()'. You can preview the email 
    in the RStudio viewer pane, and send (draft) email using 'gmailr'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://andrie.github.io/mailmerge/">https://andrie.github.io/mailmerge/</a>,
<a href="https://github.com/andrie/mailmerge">https://github.com/andrie/mailmerge</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/andrie/mailmerge/issues">https://github.com/andrie/mailmerge/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>commonmark, gmailr, rstudioapi, googledrive, rmarkdown, glue,
magrittr, purrr, utils, fs, lifecycle, shiny, miniUI</td>
</tr>
<tr>
<td>Suggests:</td>
<td>spelling, withr, covr, knitr, testthat (&ge; 2.1.0), here,
mockery, readr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>lifecycle</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-14 20:16:00 UTC; apdev</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrie de Vries [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrie de Vries &lt;apdevries@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-14 20:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='in_viewer'>Display email message in RStudio viewer pane.</h2><span id='topic+in_viewer'></span>

<h3>Description</h3>

<p>Only opens the viewer pane if interactive and RStudio is the IDE, otherwise returns the input invisibly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>in_viewer(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="in_viewer_+3A_x">x</code></td>
<td>
<p>message</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <a href="rstudioapi.html#topic+viewer">rstudioapi::viewer</a> object. Called for the side effect of opening the viewer pane and displays message
</p>

<hr>
<h2 id='mail_merge'>Merges data into an email and send.</h2><span id='topic+mail_merge'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Merges columns from a data frame into a markdown document using the
<code><a href="glue.html#topic+glue">glue::glue_data()</a></code> function. The markdown can contain a yaml header for
subject and cc line.
</p>
<p>Note that only 'gmail' is supported at the moment, via <a href="gmailr.html#topic+gm_send_message">gmailr::gm_send_message</a>.
</p>
<p>Before using <code>mail_merge()</code>, you must be authenticated to the gmail service.
Use <code><a href="gmailr.html#topic+gm_auth">gmailr::gm_auth()</a></code> to authenticate prior to starting the mail merge.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mail_merge(
  data,
  message,
  to_col = "email",
  send = c("preview", "draft", "immediately"),
  confirm = FALSE,
  sleep_preview = 1,
  sleep_send = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mail_merge_+3A_data">data</code></td>
<td>
<p>A data frame or <code>tibble</code> with all the columns that should be
glued into the message. Substitution is performed using
<code><a href="glue.html#topic+glue">glue::glue_data()</a></code>'</p>
</td></tr>
<tr><td><code id="mail_merge_+3A_message">message</code></td>
<td>
<p>A list with components <code>yaml</code> and <code>body</code>.  You can use
<code><a href="#topic+mm_read_message">mm_read_message()</a></code> or <code><a href="#topic+mm_read_message_googledoc">mm_read_message_googledoc()</a></code> to construct a
message in this format.</p>
</td></tr>
<tr><td><code id="mail_merge_+3A_to_col">to_col</code></td>
<td>
<p>The name of the column in <code>data</code> that contains the email
address to send the message to.</p>
</td></tr>
<tr><td><code id="mail_merge_+3A_send">send</code></td>
<td>
<p>A character string, one of:
</p>

<ul>
<li><p> &quot;preview&quot; : displays message in viewer without sending mail
</p>
</li>
<li><p> &quot;draft : writes message into &quot;drafts&quot; folder on gmail
</p>
</li>
<li><p> &quot;immediately&quot; : sends email
</p>
</li></ul>
</td></tr>
<tr><td><code id="mail_merge_+3A_confirm">confirm</code></td>
<td>
<p>If <code>TRUE</code> sends email without additional confirmation.
If <code>FALSE</code> asks for confirmation before sending.</p>
</td></tr>
<tr><td><code id="mail_merge_+3A_sleep_preview">sleep_preview</code></td>
<td>
<p>If <code>send == "preview"</code> the number of seconds to sleep
between each preview. See also <a href="#topic+preview_mailmerge">preview_mailmerge</a></p>
</td></tr>
<tr><td><code id="mail_merge_+3A_sleep_send">sleep_send</code></td>
<td>
<p>If <code>send == "immediately"</code> the number of seconds to sleep between
each email send (to prevent gmail API 500 errors).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list for every message, consisting of:
</p>

<ul>
<li> <p><code>msg</code>: The message in <code>mime</code> format
</p>
</li>
<li> <p><code>id</code>: The <code>gmailr</code> response id
</p>
</li>
<li> <p><code>type</code>: preview, draft or sent
</p>
</li>
<li> <p><code>success</code>: TRUE if the message was sent successfully
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="#topic+preview_mailmerge">preview_mailmerge</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## ---- input-data --------------------------------------------------------

dat &lt;-  data.frame(
  email      = c("friend@example.com", "foe@example.com"),
  first_name = c("friend", "foe"),
  thing      = c("something good", "something bad"),
  stringsAsFactors = FALSE
)

## ---- markdown-message --------------------------------------------------

msg &lt;- '
---
subject: "**Hello, {first_name}**"
---

Hi, **{first_name}**

I am writing to tell you about **{thing}**.

{if (first_name == "friend") "Regards" else ""}


Me
'


## ---- mail-merge --------------------------------------------------------

dat %&gt;% 
  mail_merge(msg)

if (interactive()) {
  dat %&gt;%
    mail_merge(msg) %&gt;%
    print()
}

## ---- display shiny gadget ----------------------------------------------

if (interactive()) {
  dat %&gt;%
    mail_merge(msg) %&gt;%
    preview_mailmerge()
}
</code></pre>

<hr>
<h2 id='mailmerge-package'>mailmerge: Mail Merge Using R Markdown Documents and 'gmailr'</h2><span id='topic+mailmerge-package'></span><span id='topic+_PACKAGE'></span><span id='topic+mailmerge'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Perform a mail merge (mass email) using the message defined in markdown, the recipients in a 'csv' file, and gmail as the mailing engine. With this package you can parse markdown documents as the body of email, and the 'yaml' header to specify the subject line of the email. Any '' braces in the email will be encoded with 'glue::glue()'. You can preview the email in the RStudio viewer pane, and send (draft) email using 'gmailr'.
</p>


<h3>Details</h3>

<p>The main function in this package is <code><a href="#topic+mail_merge">mail_merge()</a></code>
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Andrie de Vries <a href="mailto:apdevries@gmail.com">apdevries@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://andrie.github.io/mailmerge/">https://andrie.github.io/mailmerge/</a>
</p>
</li>
<li> <p><a href="https://github.com/andrie/mailmerge">https://github.com/andrie/mailmerge</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/andrie/mailmerge/issues">https://github.com/andrie/mailmerge/issues</a>
</p>
</li></ul>


<hr>
<h2 id='mm_preview_mail'>Preview message in viewer pane.</h2><span id='topic+mm_preview_mail'></span>

<h3>Description</h3>

<p>Preview message in viewer pane.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_preview_mail(to, subject = "", body, cc = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mm_preview_mail_+3A_to">to</code></td>
<td>
<p>The email <code>to</code> address</p>
</td></tr>
<tr><td><code id="mm_preview_mail_+3A_subject">subject</code></td>
<td>
<p>The email subject</p>
</td></tr>
<tr><td><code id="mm_preview_mail_+3A_body">body</code></td>
<td>
<p>The email message, in markdown format</p>
</td></tr>
<tr><td><code id="mm_preview_mail_+3A_cc">cc</code></td>
<td>
<p>The email <code>cc</code> address</p>
</td></tr>
</table>


<h3>Value</h3>

<p>HTML text
</p>

<hr>
<h2 id='mm_read_googledoc'>Read a markdown file from google drive</h2><span id='topic+mm_read_googledoc'></span>

<h3>Description</h3>

<p>Read a markdown file from google drive
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_read_googledoc(id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mm_read_googledoc_+3A_id">id</code></td>
<td>
<p>Unique Google Drive identifier, passed to <a href="googledrive.html#topic+drive_download">googledrive::drive_download</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>the imported document
</p>
<p>A list of character strings, containing the content of the google doc
</p>

<hr>
<h2 id='mm_read_message'>Parse a markdown document into yaml and body components.</h2><span id='topic+mm_read_message'></span>

<h3>Description</h3>

<p>You can use this to construct the <code>message</code> argument of <code><a href="#topic+mail_merge">mail_merge()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_read_message(txt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mm_read_message_+3A_txt">txt</code></td>
<td>
<p>A file in markdown format</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components <code>yaml</code> and <code>body</code>
</p>


<h3>See Also</h3>

<p>Other parsing functions: 
<code><a href="#topic+mm_read_message_googledoc">mm_read_message_googledoc</a>()</code>
</p>

<hr>
<h2 id='mm_read_message_googledoc'>Parse the email template inside a markdown document on google drive.</h2><span id='topic+mm_read_message_googledoc'></span>

<h3>Description</h3>

<p>You can use this to construct the <code>message</code> argument of <code><a href="#topic+mail_merge">mail_merge()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_read_message_googledoc(id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mm_read_message_googledoc_+3A_id">id</code></td>
<td>
<p>Unique Google Drive identifier, passed to <a href="googledrive.html#topic+drive_download">googledrive::drive_download</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of character strings
</p>


<h3>See Also</h3>

<p>Other parsing functions: 
<code><a href="#topic+mm_read_message">mm_read_message</a>()</code>
</p>

<hr>
<h2 id='mm_send_draft'>Send draft email.</h2><span id='topic+mm_send_draft'></span>

<h3>Description</h3>

<p>Send draft email.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_send_draft(to, body, subject, cc = NULL, draft = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mm_send_draft_+3A_to">to</code></td>
<td>
<p>The email <code>to</code> address</p>
</td></tr>
<tr><td><code id="mm_send_draft_+3A_body">body</code></td>
<td>
<p>The email message, in markdown format</p>
</td></tr>
<tr><td><code id="mm_send_draft_+3A_subject">subject</code></td>
<td>
<p>The email subject</p>
</td></tr>
<tr><td><code id="mm_send_draft_+3A_cc">cc</code></td>
<td>
<p>The email <code>cc</code> address</p>
</td></tr>
<tr><td><code id="mm_send_draft_+3A_draft">draft</code></td>
<td>
<p>if <code>TRUE</code> sends a draft, otherwise sends the real email</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A draft email message
</p>

<hr>
<h2 id='mm_send_mail'>Send email.</h2><span id='topic+mm_send_mail'></span>

<h3>Description</h3>

<p>Send email.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_send_mail(
  to,
  body,
  subject,
  cc = NULL,
  draft = FALSE,
  test = Sys.getenv("mailmerge_test", FALSE)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mm_send_mail_+3A_to">to</code></td>
<td>
<p>The email <code>to</code> address</p>
</td></tr>
<tr><td><code id="mm_send_mail_+3A_body">body</code></td>
<td>
<p>The email message, in markdown format</p>
</td></tr>
<tr><td><code id="mm_send_mail_+3A_subject">subject</code></td>
<td>
<p>The email subject</p>
</td></tr>
<tr><td><code id="mm_send_mail_+3A_cc">cc</code></td>
<td>
<p>The email <code>cc</code> address</p>
</td></tr>
<tr><td><code id="mm_send_mail_+3A_draft">draft</code></td>
<td>
<p>if <code>TRUE</code> sends a draft, otherwise sends the real email</p>
</td></tr>
<tr><td><code id="mm_send_mail_+3A_test">test</code></td>
<td>
<p>If TRUE, doesn't send email but simply returns <code>mime</code> value, used for testing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An email message
</p>

<hr>
<h2 id='preview_mailmerge'>Preview mailmerge as shiny gadget in RStudio preview pane.</h2><span id='topic+preview_mailmerge'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preview_mailmerge(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preview_mailmerge_+3A_x">x</code></td>
<td>
<p>mailmerge_preview object, from <a href="#topic+mail_merge">mail_merge</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'shiny' gadget, see also <a href="shiny.html#topic+runGadget">shiny::runGadget</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+mail_merge">mail_merge</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## ---- input-data --------------------------------------------------------

dat &lt;-  data.frame(
  email      = c("friend@example.com", "foe@example.com"),
  first_name = c("friend", "foe"),
  thing      = c("something good", "something bad"),
  stringsAsFactors = FALSE
)

## ---- markdown-message --------------------------------------------------

msg &lt;- '
---
subject: "**Hello, {first_name}**"
---

Hi, **{first_name}**

I am writing to tell you about **{thing}**.

{if (first_name == "friend") "Regards" else ""}


Me
'



## ---- display shiny gadget ----------------------------------------------

if (interactive()) {
  dat %&gt;%
    mail_merge(msg) %&gt;%
    preview_mailmerge()
}



</code></pre>

<hr>
<h2 id='yesno'>Wait for interactive response to yes/no challenge question.</h2><span id='topic+yesno'></span>

<h3>Description</h3>

<p>Copied from <code>devtools:::yesno</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yesno(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="yesno_+3A_...">...</code></td>
<td>
<p>Arguments to paste together to form challenge question.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>logical value
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
