<!DOCTYPE html><html><head><title>Help for package RobustAFT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RobustAFT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#D243'><p> Sample of 100 hospital stays for medical back problems</p></a></li>
<li><a href='#dfcomn2'><p> Assigns values to the ROBETH parameters included in common blocks</p></a></li>
<li><a href='#fits.compare'><p>Numerical comparison of several fits</p></a></li>
<li><a href='#MCI'><p> Sample of 75 Hospital Stays</p></a></li>
<li><a href='#plot.fits.compare'><p>Plot Method for &quot;fits.compare&quot; objects</p></a></li>
<li><a href='#plot.TML'><p>Plot Method for &quot;TML&quot; objects</p></a></li>
<li><a href='#predict.TML'><p>Predict method for &quot;TML&quot; objects</p></a></li>
<li><a href='#RobustAFT-internal'><p>Internal</p></a></li>
<li><a href='#RobustAFT-package'>
<p>Robust Accelerated Failure Time Model Fitting</p></a></li>
<li><a href='#summary.TML'><p>Summarizing Truncated Maximum Likelihood regression</p></a></li>
<li><a href='#TML.censored'><p>Truncated Maximum Likelihood Regression With Censored Observations</p></a></li>
<li><a href='#TML.censored.control.ref'><p>Control parameters for the refinement IRLS algorithm of the TML.censored initial S-estimates</p></a></li>
<li><a href='#TML.censored.control.S'><p>Control parameters for the computation of the initial S estimates in TML.censored</p></a></li>
<li><a href='#TML.censored.control.tml'><p>Control parameters for the IRLS algorithm of the final TML.censored estimates</p></a></li>
<li><a href='#TML.noncensored'><p>Truncated Maximum Likelihood Regression Without Censored Observations</p></a></li>
<li><a href='#TML.noncensored.control'><p>Control Parameters for Truncated Maximum Likelihood Regression</p>
Without Censored Observations</a></li>
<li><a href='#TML1.noncensored'><p> Truncated Maximum Likelihood Estimates of Location and Scale</p></a></li>
<li><a href='#TML1.noncensored.control'><p>Control Parameters forTruncated Maximum Likelihood Estimation</p>
of Location and Scale</a></li>
<li><a href='#TML1.noncensored.control.S'>
<p>Control parameters for S-estimate of location and scale</p></a></li>
<li><a href='#Z243'><p> Sample of 100 hospital stays for medical back problems</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Truncated Maximum Likelihood Fit and Robust Accelerated Failure
Time Regression for Gaussian and Log-Weibull Case</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4-7</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-21</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0), stats, graphics, survival, robustbase,DEoptimR</td>
</tr>
<tr>
<td>Author:</td>
<td>Alfio Marazzi &lt;Alfio.Marazzi@unisante.ch&gt;, Jean-Luc Muralti</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>A. Randriamiharisoa &lt;exelami@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>R functions for the computation of the truncated maximum
	     likelihood and the robust accelerated failure time regression 
	     for gaussian and log-Weibull case.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-21 14:02:04 UTC; Alex</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-21 16:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='D243'> Sample of 100 hospital stays for medical back problems</h2><span id='topic+D243'></span>

<h3>Description</h3>

<p>Sample of 100 patients hospitalized for medical back problems in Switzerland
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(D243)</code></pre>


<h3>Format</h3>

<p>A data frame with 100 observations on the following 11 variables.
</p>

<dl>
<dt><code>Sexe</code></dt><dd><p>Gender: M=Male, F=Female</p>
</dd>
<dt><code>age</code></dt><dd><p>Age in years</p>
</dd>
<dt><code>dest</code></dt><dd><p>Destination: DOMI=Home else=another hospital</p>
</dd>
<dt><code>Typadm</code></dt><dd><p>Type of admission: Urg=Emergency else=on notification</p>
</dd>
<dt><code>Typass</code></dt><dd><p>Type of insurance: P=Private else=usual</p>
</dd>
<dt><code>LOS</code></dt><dd><p>Length of stay (days)</p>
</dd>
<dt><code>APDRG</code></dt><dd><p>DRG code: Always 243</p>
</dd>
<dt><code>Cost</code></dt><dd><p>Cost (Swiss francs)</p>
</dd>
<dt><code>CSansInv</code></dt><dd><p>Intermediate cost</p>
</dd>
<dt><code>BBDaggr</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>BBD</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(D243)
</code></pre>

<hr>
<h2 id='dfcomn2'> Assigns values to the ROBETH parameters included in common blocks</h2><span id='topic+dfcomn2'></span>

<h3>Description</h3>

<p>See Marazzi A. (1993), p.405</p>


<h3>Usage</h3>

<pre><code class='language-R'>dfcomn2(ipsi = -9, c = -1.345, h1 = -1.7, h2 = -3.4, h3 = -8.5, 
       xk = -1.548, d = -1.345, beta = -0.5, bet0 = -1, iucv = -1, 
       a2 = 0, b2 = -3, chk = -9, ckw = -2, bb = -1, bt = -1, 
       cw = -1, em = -1.345, cr = -2, vk = -1, np = -2, nu = -1, 
       v7 = -1, iwww = -1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dfcomn2_+3A_ipsi">ipsi</code></td>
<td>
<p> Option parameter for the choice of  <code class="reqn">\psi</code>. Set -4 &lt;= ipsi &lt;= 4 </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_c">c</code></td>
<td>
<p> Parameter <code>c</code> of the Huber function </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_h1">h1</code></td>
<td>
<p> Parameter <code class="reqn">h1</code> of the Hampel function </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_h2">h2</code></td>
<td>
<p> Parameter <code class="reqn">h2</code> of the Hampel function </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_h3">h3</code></td>
<td>
<p> Parameter <code class="reqn">h3</code> of the Hampel function </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_xk">xk</code></td>
<td>
<p> Parameter <code class="reqn">k</code> of the rescaled Tukey biweight </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_d">d</code></td>
<td>
<p> See reference</p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_beta">beta</code></td>
<td>
<p> Parameter <code class="reqn">\beta</code> to make<code class="reqn">\sigma</code> estimate 
asymptotically unbiased </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_bet0">bet0</code></td>
<td>
<p> Parameter <code class="reqn">\beta_0</code> to make<code class="reqn">\sigma</code> estimate 
asymptotically unbiased </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_iucv">iucv</code></td>
<td>
<p> Option parameter for the choice of u(s), u'(s), v(s), v'(s), w(s) or w'(s)</p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_a2">a2</code></td>
<td>
<p> Parameter a^2 of Huber's mimimax u-function </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_b2">b2</code></td>
<td>
<p> Parameter b^2 of Huber's mimimax u-function </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_chk">chk</code></td>
<td>
<p> Parameter c of the Hampel-Krasker u-function </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_ckw">ckw</code></td>
<td>
<p> Parameter c of the Krasker-Welsch u-function </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_bb">bb</code></td>
<td>
<p> Parameter b of the Mallows-unstandard u-function </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_bt">bt</code></td>
<td>
<p> Option parameter for w(s) or w'(s) </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_cw">cw</code></td>
<td>
<p> Option parameter for w(s) or w'(s) </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_em">em</code></td>
<td>
<p> Parameter em for unstandard u-function </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_cr">cr</code></td>
<td>
<p> Parameter cr for unstandard u-function </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_vk">vk</code></td>
<td>
<p> Parameter vk for unstandard u-function </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_np">np</code></td>
<td>
<p> Parameter np for unstandard u-function </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_nu">nu</code></td>
<td>
<p> Parameter nu for unstandard u-function </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_v7">v7</code></td>
<td>
<p> Parameter v for unstandard u-function </p>
</td></tr>
<tr><td><code id="dfcomn2_+3A_iwww">iwww</code></td>
<td>
<p> Option parameter for the choice of <code class="reqn">\bar\omega</code>. 
Set 0 &lt;= iwww &lt;= 3 </p>
</td></tr>
</table>


<h3>Value</h3>

<p>See reference
</p>


<h3>References</h3>

<p>Marazzi A. (1993) <em>Algorithm, Routines, and S functions 
for Robust Statistics</em>. Wadsworth &amp; Brooks/cole, Pacific Grove,
California. p.405
</p>

<hr>
<h2 id='fits.compare'>Numerical comparison of several fits </h2><span id='topic+fits.compare'></span><span id='topic+print.fits.compare'></span>

<h3>Description</h3>

<p>Creates a class &quot;fits.compare&quot; object allowing the user to display model summary 
statistics in a form allowing easy comparison of models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fits.compare(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fits.compare_+3A_...">...</code></td>
<td>
<p> one or more class &quot;lm&quot;, class &quot;lm.robust&quot; or class &quot;TML&quot; objects. Names given to objects in the list are used as labeling information in the printed output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>fits.compare</code> function processes its arguments one at a time to create a named list of objects. 
The object returned is a member of class &quot;fits.compare&quot;. 
Because of differences in the computed summary statistics, the list of input objects is currently limited to class &quot;lm&quot;, 
class &quot;lm.robust&quot; and class &quot;TML&quot; objects.
The <code>print.fits.compare</code> function displays a textual comparison of the input models, 
and the <code>plot.fits.compare</code> function provides comparative plots.
</p>


<h3>Value</h3>

<p>An object of class &quot;fits.compare&quot; containing the list of input models to be compared.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+TML.noncensored">TML.noncensored</a></code>, <code><a href="#topic+plot.fits.compare">plot.fits.compare</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
     data(D243)
     Cost &lt;- D243$Cost                             # Cost (Swiss francs)
     LOS  &lt;- D243$LOS                              # Length of stay (days)
     Adm  &lt;- D243$Typadm; Adm &lt;- (Adm==" Urg")*1   # Type of admission 
                                                   # (0=on notification, 1=Emergency)

     lwrob &lt;- TML.noncensored(log(Cost)~log(LOS)+Adm, errors="logWeibull")
     grob  &lt;- TML.noncensored(log(Cost)~log(LOS)+Adm)
     reg   &lt;- lm(log(Cost)~log(LOS)+Adm)

     fits.compare(least.squares=reg, TML.logWeibull=lwrob, TML.Gaussian=grob)

## End(Not run)
</code></pre>

<hr>
<h2 id='MCI'> Sample of 75 Hospital Stays</h2><span id='topic+MCI'></span>

<h3>Description</h3>

<p>Sample of 75 hospital for major cardiovascular interventions</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MCI)</code></pre>


<h3>Format</h3>

<p>A data frame with 75 observations on the following 6 variables.
</p>

<dl>
<dt><code>Sex</code></dt><dd><p>Gender: 1=Female, 2=Male</p>
</dd>
<dt><code>Age</code></dt><dd><p>Age in years</p>
</dd>
<dt><code>LOS</code></dt><dd><p>Length of stay (days)</p>
</dd>
<dt><code>TypAdm</code></dt><dd><p>Type of admission: 1=Emergency 0=on notification</p>
</dd>
<dt><code>Dest</code></dt><dd><p>Destination: 1=Home 0=another hospital</p>
</dd>
<dt><code>Cost</code></dt><dd><p>Cost (Swiss francs)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(MCI)
</code></pre>

<hr>
<h2 id='plot.fits.compare'>Plot Method for &quot;fits.compare&quot; objects</h2><span id='topic+plot.fits.compare'></span>

<h3>Description</h3>

<p>Comparative plots for objects of class &quot;fits.compare&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fits.compare'
plot(x, xplots = FALSE, ask = TRUE, which = 1:4, 
             leg.position = c("topleft", "topleft", "topleft"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.fits.compare_+3A_x">x</code></td>
<td>
<p> An object of class &quot;fits.compare&quot;, usually, a result of a call to <code><a href="#topic+fits.compare">fits.compare</a></code>.</p>
</td></tr>
<tr><td><code id="plot.fits.compare_+3A_xplots">xplots</code></td>
<td>
<p> If xplots=TRUE, plots of the independent variables versus the residuals are produced. </p>
</td></tr>
<tr><td><code id="plot.fits.compare_+3A_ask">ask</code></td>
<td>
<p> If ask=TRUE, plot.fits.compare() operates in interactive mode. </p>
</td></tr>
<tr><td><code id="plot.fits.compare_+3A_which">which</code></td>
<td>
<p> If a subset of the plots is required, specify a subset of the numbers <code>1:4</code>.</p>
</td></tr>
<tr><td><code id="plot.fits.compare_+3A_leg.position">leg.position</code></td>
<td>
<p> A vector of character string specifying the legend position of the second, third and fourth plots.</p>
</td></tr>
<tr><td><code id="plot.fits.compare_+3A_...">...</code></td>
<td>
<p> Optional arguments for <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For clarity reasons, at most three models should be compared.
Four default plots (selectable by which) are produced: histograms of the residuals of each model, 
a residual Q-Q plot, response against fitted values and residuals against fitted values.
Additional plots are produced if <code>xplots=TRUE</code>.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+fits.compare">fits.compare</a></code>, <code><a href="graphics.html#topic+plot.default">plot.default</a></code>, <code><a href="#topic+plot.TML">plot.TML</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
     data(D243)
     Cost &lt;- D243$Cost                             # Cost (Swiss francs)
     LOS  &lt;- D243$LOS                              # Length of stay (days)
     Adm  &lt;- D243$Typadm; Adm &lt;- (Adm==" Urg")*1   # Type of admission 
                                                   # (0=on notification, 1=Emergency)

     lwrob &lt;- TML.noncensored(log(Cost)~log(LOS)+Adm, errors="logWeibull")
     reg   &lt;- lm(log(Cost)~log(LOS)+Adm)

     comp  &lt;- fits.compare(least.squares=reg, TML.logWeibull=lwrob)
     plot(comp, leg.position=c("topleft", "topleft", "bottomleft"), xplots=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.TML'>Plot Method for &quot;TML&quot; objects </h2><span id='topic+plot.TML'></span>

<h3>Description</h3>

<p>Diagnostic plots for elements of class &quot;TML&quot;. Three plots (selectable by which) are currently available:
a residual Q-Q plot, a plot of response against fitted values and a plot of standardized residuals against fitted values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TML'
plot(x, which = 1:3, caption = c("Residual QQ-plot",
  "Response vs. Fitted Values", "Standardized Residuals vs. Fitted Values"),
  panel = points, sub.caption = deparse(x$call$formula), main = "",
  ask = prod(par("mfcol")) &lt; length(which) &amp;&amp; dev.interactive(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.TML_+3A_x">x</code></td>
<td>
<p> An object of class &quot;TML&quot;, usually, a result of a call to <code><a href="#topic+TML.noncensored">TML.noncensored</a></code> or <code><a href="#topic+TML.censored">TML.censored</a></code>.</p>
</td></tr>
<tr><td><code id="plot.TML_+3A_which">which</code></td>
<td>
<p> If a subset of the plots is required, specify a subset of the numbers <code>1:3</code>.</p>
</td></tr>
<tr><td><code id="plot.TML_+3A_caption">caption</code></td>
<td>
<p> Caption for the different plots.</p>
</td></tr>
<tr><td><code id="plot.TML_+3A_panel">panel</code></td>
<td>
<p> Panel.</p>
</td></tr>
<tr><td><code id="plot.TML_+3A_sub.caption">sub.caption</code></td>
<td>
<p> Sub titles.</p>
</td></tr>
<tr><td><code id="plot.TML_+3A_main">main</code></td>
<td>
<p> Main title.</p>
</td></tr>
<tr><td><code id="plot.TML_+3A_ask">ask</code></td>
<td>
<p> If ask=TRUE, plot.TML() operates in interactive mode.</p>
</td></tr>
<tr><td><code id="plot.TML_+3A_...">...</code></td>
<td>
<p> Optional arguments for <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The residual Q-Q plot is build with respect to the <code>errors</code> argument of the object. 
This means that the expected order statistics are calculated either for a Gaussian or a log-Weibull distribution.      
The two horizontal dotted lines on the first and the third plots represent the upper and lower cut-off values for outlier rejection.      
Observations that were not retained for the estimation (outliers) are identified on the third plot.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+TML.noncensored">TML.noncensored</a></code>, <code><a href="#topic+TML.censored">TML.censored</a></code>, <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
     data(D243)
     Cost &lt;- D243$Cost                             # Cost (Swiss francs)
     LOS  &lt;- D243$LOS                              # Length of stay (days)
     Adm  &lt;- D243$Typadm; Adm &lt;- (Adm==" Urg")*1   # Type of admission 
                                                   # (0=on notification, 1=Emergency)

     # Truncated maximum likelihood regression with log-Weibull errors
     w  &lt;- TML.noncensored(log(Cost)~log(LOS)+Adm, errors="logWeibull", 
           otp="adaptive", control=list(fastS=TRUE))
     
     plot(w)
     plot(w, which = 1)
     plot(w, which = 2)
     plot(w, which = 3)

## End(Not run)
</code></pre>

<hr>
<h2 id='predict.TML'>Predict method for &quot;TML&quot; objects </h2><span id='topic+predict.TML'></span>

<h3>Description</h3>

<p>Obtains predictions from a fitted Truncated Maximum Likelihood (TML) object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TML'
predict(object, newdata = NULL, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.TML_+3A_object">object</code></td>
<td>
<p> An object of class &quot;TML&quot;, usually, a result of a call to <code><a href="#topic+TML.noncensored">TML.noncensored</a></code> or <code><a href="#topic+TML.censored">TML.censored</a></code>. </p>
</td></tr>
<tr><td><code id="predict.TML_+3A_newdata">newdata</code></td>
<td>
<p> Optionally, a vector, a matrix or a data frame containing the variables with which to predict. 
If omitted, the fitted values of <code>object</code> are returned.</p>
</td></tr>
<tr><td><code id="predict.TML_+3A_...">...</code></td>
<td>
<p> Additional arguments affecting the predictions produced.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>newdata</code> must have the same number of variables (that is of columns) as the model.
If <code>object</code> is a model with an intercept, <code>newdata</code> must have a first column of 1.
</p>


<h3>Value</h3>

<p>Returns a vector of predictions.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+TML.noncensored">TML.noncensored</a></code>, <code><a href="#topic+TML.censored">TML.censored</a></code>, <code><a href="stats.html#topic+predict">predict</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
     data(D243)
     Cost &lt;- D243$Cost                             # Cost (Swiss francs)
     LOS  &lt;- D243$LOS                              # Length of stay (days)
     Adm  &lt;- D243$Typadm; Adm &lt;- (Adm==" Urg")*1   # Type of admission 
                                                   # (0=on notification, 1=Emergency)

     # Fitting the model
     z    &lt;- TML.noncensored(log(Cost)~log(LOS)+Adm, errors="logWeibull")

     # With a vector of data
     vec  &lt;- c(1, 2.4, 1)
     predict(object = z, newdata = vec)
     # With a matrix of data
     mat  &lt;- matrix(c(1,1,2.4,2.7,1,0), ncol=3)
     predict(z, mat)
     # With a data frame
     dat  &lt;- as.data.frame(cbind("intercept"=c(1,1,1), "log(LOS)"=c(2.4,2.7,2.2), 
             "Adm"=c(1,0,1)))
     predict(z, dat)

## End(Not run)
</code></pre>

<hr>
<h2 id='RobustAFT-internal'>Internal</h2><span id='topic+S.eq.Gauss'></span><span id='topic+s.eq.Gauss'></span><span id='topic+TML.gauss'></span><span id='topic+Nrm2'></span>

<h3>Description</h3>

<p>Internal functions not intended for public use.</p>

<hr>
<h2 id='RobustAFT-package'>
Robust Accelerated Failure Time Model Fitting
</h2><span id='topic+RobustAFT-package'></span><span id='topic+RobustAFT'></span>

<h3>Description</h3>

<p>This package computes the truncated maximum likelihood regression estimates
described in Marazzi and Yohai (2004) and Locatelli et al. (2010). 
The error distribution is assumed to follow approximately a Gaussian or a log-Weibull distribution. 
The cut-off values for outlier rejection are fixed or adaptive.
The main functions of this package are <code><a href="#topic+TML.noncensored">TML.noncensored</a></code> and <code><a href="#topic+TML.censored">TML.censored</a></code>.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> RobustAFT</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
#Version: </td><td style="text-align: left;"> 1.4-6</td>
</tr>
<tr>
 <td style="text-align: left;">
#Date: </td><td style="text-align: left;"> 2023-06-19</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2 or later</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Alfio Marazzi &lt;Alfio.Marazzi@chuv.ch&gt;, Jean-Luc Muralti
</p>
<p>Maintainer: A. Randriamiharisoa &lt;Alex.Randriamiharisoa@chuv.ch&gt;
</p>


<h3>References</h3>

<p>Marazzi A., Yohai V. (2004). Adaptively truncated maximum likelihood regression with asymmetric 
errors. <em>Journal of Statistical Planning and Inference</em>, 122, 271-291.
</p>
<p>Locatelli I., Marazzi A., Yohai V. (2010). Robust accelerated failure time regression.
<em>Computational Statistics and Data Analysis</em>, 55, 874-887.
</p>
<p>Marazzi A. (1993) <em>Algorithm, Routines, and S functions for Robust Statistics</em>.  
Wadsworth &amp; Brooks/cole, Pacific Grove, California.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1. This is the example described in Marazzi and Yohai (2004).
# ---------
# The two following auxiliary functions, not included in the library, 
#must be loaded.
# ------------- Auxiliary functions -------------------------------------

SDmux.lw &lt;- function(x,theta,sigma,COV){
# Standard deviation of the conditional mean estimate: log-Weibull case
np &lt;- length(theta); nc &lt;- ncol(COV); nr &lt;- nrow(COV)
if (np!=length(x)) cat("length(x) must be the same as length(theta)")
if (nc!=nr)        cat("COV is not a square matrix")
if (nc!=(np+1))    cat("ncol(COV) must be the same as length(theta)+1")
log.mu.x &lt;- t(x)%*%theta+lgamma(1+sigma) # log of conditional mean estimate
mu.x     &lt;- exp(log.mu.x)                # conditional mean estimate
dg       &lt;- digamma(1+sigma)
COV.TT   &lt;- COV[1:np,1:np]
Var.S    &lt;- COV[(np+1),(np+1)]
COV.TS   &lt;- COV[1:np,(np+1)]
V.mu.x   &lt;- t(x)%*%COV.TT%*%x + dg^2*Var.S + 2*dg*(t(x)%*%COV.TS)
SD.mu.x  &lt;- as.numeric((sqrt(V.mu.x))*mu.x)
SD.mu.x}

plt &lt;- function(LOS,Cost,Adm,theta.fr,sigma.fr,sd0.fr,sd1.fr,theta.ml,
                sigma.ml,sd0.ml,sd1.ml){
# Plot of the conditional mean and confidence intervals: log-Weibull case
par(mfrow=c(1,2),oma=c(0,0,2,0))
plot(LOS,Cost,type="n")
points(LOS[Adm==0],Cost[Adm==0],pch=1)
points(LOS[Adm==1],Cost[Adm==1],pch=16,col=2)
x0t   &lt;- x0%*%theta.fr; x1t &lt;- x1t &lt;- x1%*%theta.fr
lines(l0,exp(x0t)*gamma(1+sigma.fr))
lines(l0,exp(x1t)*gamma(1+sigma.fr),col=2)
z0min &lt;- exp(x0t)*gamma(1+sigma.fr)-2.576*sd0.fr
z0max &lt;- exp(x0t)*gamma(1+sigma.fr)+2.576*sd0.fr
z1min &lt;- exp(x1t)*gamma(1+sigma.fr)-2.576*sd1.fr
z1max &lt;- exp(x1t)*gamma(1+sigma.fr)+2.576*sd1.fr
lines(l0,z0min,lty=2,col=1)
lines(l0,z0max,lty=2,col=1)
lines(l0,z1min,lty=2,col=1)
lines(l0,z1max,lty=2,col=1)
polygon(c(l0,rev(l0)), c(z0min,rev(z0max)), border=FALSE, density=10, angle=90)
polygon(c(l0,rev(l0)), c(z1min,rev(z1max)), border=FALSE, density=12, angle=90,col=2)
plot(LOS,Cost,type="n")
points(LOS[Adm==0],Cost[Adm==0],pch=1)
points(LOS[Adm==1],Cost[Adm==1],pch=16,col=2)
x0t   &lt;- x0%*%theta.ml; x1t &lt;- x1t &lt;- x1%*%theta.ml
lines(l0,exp(x0t)*gamma(1+sigma.ml))
lines(l0,exp(x1t)*gamma(1+sigma.ml),col=2)
z0min &lt;- exp(x0t)*gamma(1+sigma.ml)-2.576*sd0.ml
z0max &lt;- exp(x0t)*gamma(1+sigma.ml)+2.576*sd0.ml
z1min &lt;- exp(x1t)*gamma(1+sigma.ml)-2.576*sd1.ml
z1max &lt;- exp(x1t)*gamma(1+sigma.ml)+2.576*sd1.ml
lines(l0,z0min,lty=2,col=1)
lines(l0,z0max,lty=2,col=1)
lines(l0,z1min,lty=2,col=1)
lines(l0,z1max,lty=2,col=1)
polygon(c(l0,rev(l0)), c(z0min,rev(z0max)), border=FALSE, density=10, angle=90)
polygon(c(l0,rev(l0)), c(z1min,rev(z1max)), border=FALSE, density=12, angle=90,col=2)}

#------ End of auxiliary functions --------------------------------------------------

library(RobustAFT)

data(D243)
Cost &lt;- D243$Cost                            # Cost (Swiss francs)
LOS &lt;- D243$LOS                              # Length of stay (days)
Adm &lt;- D243$Typadm; Adm &lt;- (Adm==" Urg")*1   # Type of admission 
                                             # (0=on notification, 1=Emergency)
Ass &lt;- D243$Typass; Ass &lt;- (Ass=="P"   )*1   # Type of insurance (0=usual, 1=private)
Age &lt;- D243$age                              # Age (years)
Dst &lt;- D243$dest;   Dst &lt;- (Dst=="DOMI")*1   # Destination (1=Home, 0=another hospital)
Sex &lt;- D243$Sexe;   Sex &lt;- (Sex=="M"   )*1   # Sex (1=Male, 0=Female)

## Not run: 
# Plot data
par(mfrow=c(1,2))
plot(LOS,Cost); plot(log(LOS),log(Cost))

# log-Weibull fits
# ----------------
# Full robust model
zwff     &lt;- TML.noncensored(log(Cost)~log(LOS)+Adm+Ass+Age+Sex+Dst,
            errors="logWeibull")
summary(zwff)

# Reduced model
zwfr     &lt;- update(zwff,log(Cost)~log(LOS)+Adm)
summary(zwfr)

# Residual plots
par(mfrow=c(1,2))
plot(zwfr,which=c(1,3))

# Plot robust predictions on log-log scale
par(mfrow=c(1,1))
l0       &lt;- seq(from=2,to=60,by=0.5)
x0       &lt;- as.matrix(cbind(1,log(l0),0))
x1       &lt;- as.matrix(cbind(1,log(l0),1))
plot(log(LOS),log(Cost),type="n")
points(log(LOS[Adm==1]),log(Cost[Adm==1]),pch=16,col=2)
points(log(LOS[Adm==0]),log(Cost[Adm==0]),pch=1)
lines(log(l0),predict(zwfr,x0))
lines(log(l0),predict(zwfr,x1),col=2)

# Maximum likelihood : full model
zmlf     &lt;- TML.noncensored(log(Cost)~log(LOS)+Adm+Ass+Age+Sex+Dst,
            errors="logWeibull",cu=100)
summary(zmlf)

# Maximum likelihood : reduced model
zmlr     &lt;- update(zmlf,log(Cost)~log(LOS)+Adm)
summary(zmlr)

# Plot conditional means and confidence intervals
l0       &lt;- seq(from=2,to=62,by=0.5)
x0       &lt;- as.matrix(cbind(1,log(l0),0))
x1       &lt;- as.matrix(cbind(1,log(l0),1))
theta.fr &lt;- coef(zwfr)
sigma.fr &lt;- zwfr$v1
COV.fr   &lt;- vcov(zwfr)
sd0.fr   &lt;- apply(x0,1,SDmux.lw,theta.fr,sigma.fr,COV.fr)
sd1.fr   &lt;- apply(x1,1,SDmux.lw,theta.fr,sigma.fr,COV.fr)
theta.ml &lt;- coef(zmlr)
sigma.ml &lt;- zmlr$v1
COV.ml   &lt;- zmlr$COV
sd0.ml   &lt;- apply(x0,1,SDmux.lw,theta.ml,sigma.ml,COV.ml)
sd1.ml   &lt;- apply(x1,1,SDmux.lw,theta.ml,sigma.ml,COV.ml)
plt(LOS,Cost,Adm,theta.fr,sigma.fr,sd0.fr,sd1.fr,theta.ml,sigma.ml,sd0.ml,sd1.ml)

# Gaussian fits (for comparison)
# ------------------------------
# Reduced model
zgfr &lt;- TML.noncensored(log(Cost)~log(LOS)+Adm,errors="Gaussian")
summary(zgfr)

# Residual plots
par(mfrow=c(1,2))
plot(zgfr,which=c(1,3))

# Classical Gaussian fit
lr &lt;- lm(log(Cost)~log(LOS)+Adm)
summary(lr)

# Compare several fits
# --------------------
comp &lt;- fits.compare(TML.logWeibull=zwfr,ML.logWeibull=zmlr,least.squares=lr)
comp
plot(comp,leg.position=c("topleft","topleft","bottomleft")) # click on graphics

## End(Not run)
#
#------------------------------------------------------------------------------
#
# Example 2. This is the example described in Locatelli Marazzi and Yohai (2010).
# ---------
# This is the example described in Locatelli et al. (2010). 
# The estimates are slighty different due to changes in the algorithm for the 
# final estimate.
## Not run: 
# Remove data of Example 1
rm(Cost,LOS,Adm,Ass,Age,Dst,Sex)

data(MCI)
attach(MCI)
     
# Exploratory Analysis

par(mfrow=c(1,1)) 

plot(Age,log(LOS),type= "n",cex=0.7)

# (1) filled square   : regular,   complete   
# (2) empty  square   : regular,   censored
# (3) filled triangle : emergency, complete
# (4) empty  triangle : emergency, censored

points(Age[Dest==1 &amp; TypAdm==0], log(LOS)[Dest==1 &amp; TypAdm==0], pch=15,cex=0.7)  # (1)
points(Age[Dest==0 &amp; TypAdm==0], log(LOS)[Dest==0 &amp; TypAdm==0], pch=0, cex=0.7)  # (2)
points(Age[Dest==1 &amp; TypAdm==1], log(LOS)[Dest==1 &amp; TypAdm==1], pch=17,cex=0.7)  # (3)
points(Age[Dest==0 &amp; TypAdm==1], log(LOS)[Dest==0 &amp; TypAdm==1], pch=2, cex=0.7)  # (4)

# Maximum Likelihood
ML   &lt;- survreg(Surv(log(LOS), Dest) ~ TypAdm*Age, dist="gaussian")
summary(ML)
B.ML &lt;- ML$coef; S.ML &lt;- ML$scale
abline(c(B.ML[1]        ,B.ML[3]        ),lwd=1,col="grey",lty=1)
abline(c(B.ML[1]+B.ML[2],B.ML[3]+B.ML[4]),lwd=1,col="grey",lty=1)
     
# Robust Accelerated Failure Time Regression with Gaussian errors
ctrol.S   &lt;- list(N=150, q=5, sigma0=1, MAXIT=100, TOL=0.001,seed=123)

ctrol.ref &lt;- list(maxit.sigma=2,tol.sigma=0.0001,maxit.Beta=2,tol.Beta=0.0001,
          Maxit.S=50, tol.S.sigma=0.001, tol.S.Beta=0.001,alg.sigma=1,nitmon=FALSE)

ctrol.tml &lt;- list(maxit.sigma=50,tol.sigma=0.0001,maxit.Beta=50,tol.Beta=0.0001,
    Maxit.TML=50, tol.TML.sigma=0.001, tol.TML.Beta=0.001, alg.sigma=1,nitmon=FALSE)

WML       &lt;- TML.censored(log(LOS)~TypAdm*Age,data=MCI,delta=Dest,otp="adaptive",
             control.S=ctrol.S,control.ref=ctrol.ref,control.tml=ctrol.tml)

summary(WML)

B.WML     &lt;-coef(WML)
abline(c(B.WML[1]         ,B.WML[3]         ),lty=1, col="red")
abline(c(B.WML[1]+B.WML[2],B.WML[3]+B.WML[4]),lty=1, col="red")
#
detach(MCI)

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.TML'>Summarizing Truncated Maximum Likelihood regression </h2><span id='topic+summary.TML'></span><span id='topic+print.TML'></span><span id='topic+print.summary.TML'></span><span id='topic+coef.TML'></span><span id='topic+vcov.TML'></span>

<h3>Description</h3>

<p>Summary and print <code><a href="utils.html#topic+methods">methods</a></code> for <code>R</code> object of class &quot;TML&quot; and <code><a href="base.html#topic+print">print</a></code> 
method for the summary object.
Further, methods <code><a href="stats.html#topic+fitted">fitted</a></code>(), <code><a href="stats.html#topic+residuals">residuals</a></code>(), <code><a href="stats.html#topic+weights">weights</a></code>() 
or <code><a href="stats.html#topic+update">update</a></code>() work (via the default methods), and <code><a href="stats.html#topic+coef">coef</a></code>(), <code><a href="stats.html#topic+vcov">vcov</a></code>() 
have explicitly defined TML methods. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TML'
summary(object, ...)
## S3 method for class 'TML'
print(x, digits = max(3, getOption("digits") - 3), ...)
## S3 method for class 'TML'
coef(object, ...)
## S3 method for class 'TML'
vcov(object, ...)

## S3 method for class 'summary.TML'
print(x, digits = max(3, getOption("digits") - 3),
  signif.stars = getOption("show.signif.stars"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.TML_+3A_object">object</code></td>
<td>
<p> An object of class &quot;TML&quot;, usually, a result of a call to <code><a href="#topic+TML.noncensored">TML.noncensored</a></code> or <code><a href="#topic+TML.censored">TML.censored</a></code>. </p>
</td></tr>
<tr><td><code id="summary.TML_+3A_...">...</code></td>
<td>
<p> Potentially more arguments passed to methods.</p>
</td></tr>
<tr><td><code id="summary.TML_+3A_digits">digits</code></td>
<td>
<p> Number of digits for printing, see <code>digits</code> in <code><a href="base.html#topic+options">options</a></code>.</p>
</td></tr>
<tr><td><code id="summary.TML_+3A_x">x</code></td>
<td>
<p> An object of class &quot;TML&quot; or &quot;summary.TML&quot;. </p>
</td></tr>
<tr><td><code id="summary.TML_+3A_signif.stars">signif.stars</code></td>
<td>
<p> Logical indicating if the P-values should be visualized by so called &quot;significance stars&quot;. </p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>summary.TML</code> returns an object of <code><a href="base.html#topic+class">class</a></code> &quot;summary.TML&quot;.
</p>
<p><code>print.TML</code> returns a printed summary of object of class &quot;TML&quot;.
</p>
<p><code>print.summary.TML</code> tries to be smart about formatting the coefficients, standard errors, etc, and gives &quot;significance stars&quot; if signif.stars is TRUE (as per default when <code><a href="base.html#topic+options">options</a></code> where not changed).
</p>
<p><code>coef.TML</code> returns the final coefficient estimates (value <code>th1</code> of a &quot;TML&quot; object), and <code>vcov.TML</code> returns the covariance matrix of the final estimates (value <code>CV1</code> of a &quot;TML&quot; object).
</p>


<h3>Value</h3>

          
<p>An object of class &quot;summary.TML&quot; is a list with the following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The component from <code>object</code>.</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>The component from <code>object</code>.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>The component from <code>object</code>.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>The component from <code>object</code>.</p>
</td></tr>
<tr><td><code>tn</code></td>
<td>
<p>The component from <code>object</code>.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>The matrix of coefficients, standard errors, t-values and p-values. Aliased coefficients are omitted.</p>
</td></tr>
<tr><td><code>aliased</code></td>
<td>
<p>Named logical vector showing if the original coefficients are aliased.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>Degrees of freedom, a 3-vector (p, n-p, p*), the last being the number of non-aliased coefficients.</p>
</td></tr> 
<tr><td><code>sigma</code></td>
<td>
<p>The final scale estimate from <code>object</code>.</p>
</td></tr>
<tr><td><code>cutoff.values</code></td>
<td>
<p>A vector of the final lower and upper cut-off values from <code>object</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

 <p><code><a href="#topic+TML.noncensored">TML.noncensored</a></code>, <code><a href="#topic+TML.censored">TML.censored</a></code>, <code><a href="base.html#topic+summary">summary</a></code>, <code><a href="base.html#topic+print">print</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
     data(D243)
     Cost &lt;- D243$Cost                             # Cost (Swiss francs)
     LOS  &lt;- D243$LOS                              # Length of stay (days)
     Adm  &lt;- D243$Typadm; Adm &lt;- (Adm==" Urg")*1   # Type of admission 
                                                   # (0=on notification, 1=Emergency)
     Ass  &lt;- D243$Typass; Ass &lt;- (Ass=="P"   )*1   # Type of insurance 
                                                   # (0=usual, 1=private)
     Age  &lt;- D243$age                              # Age (years)
     Dst  &lt;- D243$dest;   Dst &lt;- (Dst=="DOMI")*1   # Destination 
                                                   # (1=Home, 0=another hospital)
     Sex  &lt;- D243$Sexe;   Sex &lt;- (Sex=="M"   )*1   # Sex (1=Male, 0=Female)

     # Truncated maximum likelihood regression with Gaussian errors
     z    &lt;- TML.noncensored(log(Cost)~log(LOS)+Adm+Ass+Age+Dst+Sex, otp="adaptive", 
             cov="nonparametric", control=list(fastS=TRUE))

     z                  # -&gt; print.TML(....)
     sumz &lt;- summary(z) # -&gt; summary.TML(....)
     sumz               # -&gt; print.summary.TML(....)
     coef(z)            # -&gt; coef.TML(....)
     vcov(z)            # -&gt; vcov.TML(....)

## End(Not run)
</code></pre>

<hr>
<h2 id='TML.censored'>Truncated Maximum Likelihood Regression With Censored Observations</h2><span id='topic+TML.censored'></span>

<h3>Description</h3>

<p>This function computes the truncated maximum likelihood estimates of accelerated failure time regression 
described in Locatelli et al. (2010). 
The error distribution is assumed to follow approximately a Gaussian or a log-Weibull distribution.
The cut-off values for outlier rejection are fixed or adaptive.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TML.censored(formula, delta, data, errors = "Gaussian",  initial = "S", 
             input = NULL, otp = "fixed", cov=TRUE, cu = NULL, control.S=list(), 
             control.ref=list(), control.tml=list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TML.censored_+3A_formula">formula</code></td>
<td>
<p> A <code><a href="stats.html#topic+formula">formula</a></code>, i.e., a symbolic description of the model
to be adjusted (cf. <code><a href="stats.html#topic+glm">glm</a></code> or <code><a href="stats.html#topic+lm">lm</a></code>). </p>
</td></tr>
<tr><td><code id="TML.censored_+3A_data">data</code></td>
<td>
<p> An optional data frame containing the variables in the model. If not
found in <code>data</code>, the variables are taken from <code>environment(formula)</code>,
typically the environment from which <code>robaft</code> is called. </p>
</td></tr>
<tr><td><code id="TML.censored_+3A_delta">delta</code></td>
<td>
<p> Vector of 0 and 1. 
</p>

<ul>
<li><p> 0: censored observation.
</p>
</li>
<li><p> 1: complete observation.</p>
</li></ul>
</td></tr>
<tr><td><code id="TML.censored_+3A_errors">errors</code></td>
<td>


<ul>
<li><p> &quot;Gaussian&quot;: the error distribution is assumed to be Gaussian.
</p>
</li>
<li><p> &quot;logWeibull&quot; : the error distribution is assumed to be log-Weibull.</p>
</li></ul>
</td></tr>  
<tr><td><code id="TML.censored_+3A_initial">initial</code></td>
<td>


<ul>
<li><p> &quot;S&quot;: initial S-estimate.
</p>
</li>
<li><p> &quot;input&quot;: the initial estimate is given on input.</p>
</li></ul>
</td></tr>
<tr><td><code id="TML.censored_+3A_input">input</code></td>
<td>
<p> A list(theta=c(...),sigma=...): initial input estimates where
theta is a vector of p coefficients and sigma a scalar scale.<br />
Required when initial=&quot;input&quot;.</p>
</td></tr>
<tr><td><code id="TML.censored_+3A_otp">otp</code></td>
<td>


<ul>
<li><p> &quot;adaptive&quot;: adaptive cut-off.
</p>
</li>
<li><p> &quot;fixed&quot;: non adaptive cut-off.</p>
</li></ul>
</td></tr>
<tr><td><code id="TML.censored_+3A_cov">cov</code></td>
<td>
<p> If TRUE the covariance matrix is computed.</p>
</td></tr>
<tr><td><code id="TML.censored_+3A_cu">cu</code></td>
<td>
<p> Preliminary minimal upper cut-off. 
The default is 2.5 in the Gaussian case and 1.855356 in the log-Weibull case. </p>
</td></tr>  
<tr><td><code id="TML.censored_+3A_control.s">control.S</code></td>
<td>
<p> A list of control parameters for the computation of the initial S estimates. 
See the function <code><a href="#topic+TML.censored.control.S">TML.censored.control.S</a></code> for the default values.</p>
</td></tr>                                     
<tr><td><code id="TML.censored_+3A_control.ref">control.ref</code></td>
<td>
<p> A list of control parameters for the refinement algorithm of the initial S estimates. 
See the function <code><a href="#topic+TML.censored.control.ref">TML.censored.control.ref</a></code> for the default values.</p>
</td></tr>
<tr><td><code id="TML.censored_+3A_control.tml">control.tml</code></td>
<td>
<p> AA list of control parameters for the computation of the final estimates.
See the function <code><a href="#topic+TML.censored.control.tml">TML.censored.control.tml</a></code> for the default values. </p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TML.censored</code> returns an object of class &quot;TML&quot;. 
The function <code><a href="base.html#topic+summary">summary</a></code> can be used to obtain or print a summary of the results. 
The generic extractor functions <code><a href="stats.html#topic+fitted">fitted</a></code>, <code><a href="stats.html#topic+residuals">residuals</a></code> and 
<code><a href="stats.html#topic+weights">weights</a></code> can be used to extract various elements of the object returned 
by <code>TML.censored</code>. The function <code><a href="stats.html#topic+update">update</a></code> can be used to update the model.
</p>
<p>An object of class &quot;TML&quot; is a list with at least the following components: 
</p>
<table>
<tr><td><code>th0</code></td>
<td>
<p>Initial coefficient estimates.</p>
</td></tr>
<tr><td><code>v0</code></td>
<td>
<p>Initial scale estimate.</p>
</td></tr>
<tr><td><code>nit.ref</code></td>
<td>
<p>Reached number of iteration in the refinement step for the initial estimates.</p>
</td></tr>
<tr><td><code>th1</code></td>
<td>
<p>Final coefficient estimates.</p>
</td></tr>
<tr><td><code>v1</code></td>
<td>
<p>Final scale estimate.</p>
</td></tr>
<tr><td><code>nit.tml</code></td>
<td>
<p>Number of iterations reached in IRLS algorithm for the final estimates.</p>
</td></tr>
<tr><td><code>tu</code>, <code>tl</code></td>
<td>
<p>Final cut-off values.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Estimated proportion of retained observations.</p>
</td></tr>
<tr><td><code>tn</code></td>
<td>
<p>Number of retained observations.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>Vector of weights (0 for rejected observations, 1 for retained observations).</p>
</td></tr>
<tr><td><code>COV</code></td>
<td>
<p>Covariance matrix of the final estimates (th1[1],...,th1[p],v1) (where p=ncol(X)).</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p> Residuals of noncensored observations are calculated as response minus fitted values. 
For censored observations, the the expected residuals given that 
the response is larger than the recorded censored value are provided.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>The fitted mean values.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>The formula supplied.</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>The <code><a href="stats.html#topic+terms">terms</a></code> object used.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>The <code>data argument</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Locatelli I., Marazzi A., Yohai V. (2010). Robust accelerated failure time regression.
<em> Computational Statistics and Data Analysis</em>, 55, 874-887.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+TML.censored.control.ref">TML.censored.control.ref</a></code>,
<code><a href="#topic+TML.censored.control.tml">TML.censored.control.tml</a></code>,
<code><a href="#topic+TML.censored.control.S">TML.censored.control.S</a></code>,
<code><a href="#topic+TML.noncensored">TML.noncensored</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>     # This is the example described in Locatelli et al. (2010). 
     # The estimates are slighty different than those of the paper due to changes 
     # in the algorithm for the final estimate.
     #
## Not run: 
     data(MCI)
     attach(MCI)
     
     # Exploratory Analysis
     plot(Age,log(LOS),type= "n",cex=0.7)

     # (1) filled square : regular,   complete
     # (2) empty  square : regular,   censored
     # (3) filled triangle : emergency, complete
     # (4) empty  triangle : emergency, censored

     points(Age[Dest==1 &amp; TypAdm==0], log(LOS)[Dest==1 &amp; TypAdm==0], pch=15,cex=0.7) # (1)
     points(Age[Dest==0 &amp; TypAdm==0], log(LOS)[Dest==0 &amp; TypAdm==0], pch=0, cex=0.7) # (2) 
     points(Age[Dest==1 &amp; TypAdm==1], log(LOS)[Dest==1 &amp; TypAdm==1], pch=17,cex=0.7) # (3) 
     points(Age[Dest==0 &amp; TypAdm==1], log(LOS)[Dest==0 &amp; TypAdm==1], pch=2, cex=0.7) # (4) 

     # Maximum Likelihood
     ML   &lt;- survreg(Surv(log(LOS), Dest) ~ TypAdm*Age, dist="gaussian")
     summary(ML)
     B.ML &lt;- ML$coef
     S.ML &lt;- ML$scale
     
     abline(c(B.ML[1]        ,B.ML[3]        ),lwd=1,col="grey",lty=1)
     abline(c(B.ML[1]+B.ML[2],B.ML[3]+B.ML[4]),lwd=1,col="grey",lty=1)
     
     # Robust Accelerated Failure Time Regression with Gaussian errors
     ctrol.S   &lt;- list(N=150, q=5, sigma0=1, MAXIT=100, TOL=0.001,seed=123)

     ctrol.ref &lt;- list(maxit.sigma=2,tol.sigma=0.0001,maxit.Beta=2,tol.Beta=0.0001,
           Maxit.S=50, tol.S.sigma=0.001, tol.S.Beta=0.001,alg.sigma=1,nitmon=FALSE)

     ctrol.tml &lt;- list(maxit.sigma=50,tol.sigma=0.0001,maxit.Beta=50,tol.Beta=0.0001,
      Maxit.TML=50, tol.TML.sigma=0.001, tol.TML.Beta=0.001, alg.sigma=1,nitmon=FALSE)
     
     WML&lt;-TML.censored(log(LOS)~TypAdm*Age,data=MCI,delta=Dest,otp="adaptive",
          control.S=ctrol.S,control.ref=ctrol.ref,control.tml=ctrol.tml)

     summary(WML)
     
     B.WML&lt;-coef(WML)
     abline(c(B.WML[1]         ,B.WML[3]         ),lty=1, col="red")
     abline(c(B.WML[1]+B.WML[2],B.WML[3]+B.WML[4]),lty=1, col="red")

## End(Not run)
</code></pre>

<hr>
<h2 id='TML.censored.control.ref'>Control parameters for the refinement IRLS algorithm of the TML.censored initial S-estimates </h2><span id='topic+TML.censored.control.ref'></span>

<h3>Description</h3>

<p>Auxiliary function for <code><a href="#topic+TML.censored">TML.censored</a></code>. 
Typically only used internally by <code>TML.censored</code>, but may be used to provide a control argument.
This function provides default values.</p>


<h3>Usage</h3>

<pre><code class='language-R'>TML.censored.control.ref(maxit.sigma=2, tol.sigma=0.0001, maxit.Beta=2, 
      tol.Beta=0.0001, Maxit.S=50, tol.S.sigma=0.001, tol.S.Beta=0.001, 
      alg.sigma=1, nitmon = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TML.censored.control.ref_+3A_maxit.sigma">maxit.sigma</code></td>
<td>
<p> Maximum number of iterations in scale step.</p>
</td></tr>
<tr><td><code id="TML.censored.control.ref_+3A_tol.sigma">tol.sigma</code></td>
<td>
<p>Tolerance for sigma in scale step.</p>
</td></tr>
<tr><td><code id="TML.censored.control.ref_+3A_maxit.beta">maxit.Beta</code></td>
<td>
<p> Maximum number of iterations in coefficient step.</p>
</td></tr>
<tr><td><code id="TML.censored.control.ref_+3A_tol.beta">tol.Beta</code></td>
<td>
<p> Tolerance for coefficients in coefficient step.</p>
</td></tr>
<tr><td><code id="TML.censored.control.ref_+3A_maxit.s">Maxit.S</code></td>
<td>
<p> Maximum number of iterations in global cycle.</p>
</td></tr>
<tr><td><code id="TML.censored.control.ref_+3A_tol.s.sigma">tol.S.sigma</code></td>
<td>
<p> Tolerance for sigma in global cycle.</p>
</td></tr>
<tr><td><code id="TML.censored.control.ref_+3A_tol.s.beta">tol.S.Beta</code></td>
<td>
<p> Tolerance for coefficients in global cycle.</p>
</td></tr>
<tr><td><code id="TML.censored.control.ref_+3A_alg.sigma">alg.sigma</code></td>
<td>
<p> Type of algorithm in scale step:
</p>
 
<ul>
<li><p> 1: fixed point algorithm.
</p>
</li>
<li><p> 2: regula falsi.</p>
</li></ul>
</td></tr>
<tr><td><code id="TML.censored.control.ref_+3A_nitmon">nitmon</code></td>
<td>
<p> Set to TRUE if iteration monitoring is desired. Default=FALSE.</p>
</td></tr></table>


<h3>Value</h3>

<p>A list with components named as the arguments.</p>


<h3>See Also</h3>

 <p><code><a href="#topic+TML.censored">TML.censored</a></code>,
<code><a href="#topic+TML.censored.control.S">TML.censored.control.S</a></code>,
<code><a href="#topic+TML.censored.control.tml">TML.censored.control.tml</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>     ### In the example(TML.censored), the control argument for the refinement 
     ### algorithm can be built using this function:
## Not run: 
     data(MCI)
     attach(MCI)
     
     # Robust Accelerated Failure Time Regression with Gaussian errors

     ctrol.ref &lt;- TML.censored.control.ref(maxit.sigma=2,tol.sigma=0.0001,
                  maxit.Beta=2,tol.Beta=0.0001, Maxit.S=50, tol.S.sigma=0.001, 
                  tol.S.Beta=0.001,alg.sigma=1,nitmon=FALSE)

     ctrol.tml &lt;- list(maxit.sigma=50,tol.sigma=0.0001,maxit.Beta=50,
                  tol.Beta=0.0001, Maxit.TML=50, tol.TML.sigma=0.001, 
                  tol.TML.Beta=0.001, alg.sigma=1,nitmon=FALSE)
     
     WML&lt;-TML.censored(log(LOS)~TypAdm*Age,data=MCI,delta=Dest,otp="adaptive",
                  control.ref=ctrol.ref,control.tml=ctrol.tml)

     summary(WML)

## End(Not run)
</code></pre>

<hr>
<h2 id='TML.censored.control.S'>Control parameters for the computation of the initial S estimates in TML.censored</h2><span id='topic+TML.censored.control.S'></span>

<h3>Description</h3>

<p>Auxiliary function for <code><a href="#topic+TML.censored">TML.censored</a></code>. 
Typically only used internally by <code>TML.censored</code>, but may be used to provide a control argument.
This function provides default values.</p>


<h3>Usage</h3>

<pre><code class='language-R'>TML.censored.control.S(N=100, q=6, sigma0=1, MAXIT=100, TOL=0.01, seed=153)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TML.censored.control.S_+3A_n">N</code></td>
<td>
<p> Number of subsamples.</p>
</td></tr>
<tr><td><code id="TML.censored.control.S_+3A_q">q</code></td>
<td>
<p> Subsample size.</p>
</td></tr>
<tr><td><code id="TML.censored.control.S_+3A_sigma0">sigma0</code></td>
<td>
<p> Initial value of scale.</p>
</td></tr>
<tr><td><code id="TML.censored.control.S_+3A_maxit">MAXIT</code></td>
<td>
<p> Maximum number of iterations for solving the equation for scale.</p>
</td></tr>
<tr><td><code id="TML.censored.control.S_+3A_tol">TOL</code></td>
<td>
<p> Relative tolerance for scale.</p>
</td></tr>
<tr><td><code id="TML.censored.control.S_+3A_seed">seed</code></td>
<td>
<p> Seed for the random number generator.</p>
</td></tr>  </table>


<h3>Value</h3>

<p>A list with components named as the arguments.</p>


<h3>See Also</h3>

 <p><code><a href="#topic+TML.censored">TML.censored</a></code>,
<code><a href="#topic+TML.censored.control.ref">TML.censored.control.ref</a></code>,
<code><a href="#topic+TML.censored.control.tml">TML.censored.control.tml</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>     ### In the example(TML.censored), the control argument for the refinement 
     ### algorithm can be built using this function:

	 ## Not run: 
     data(MCI)
     attach(MCI)
     
     # Robust Accelerated Failure Time Regression with Gaussian errors
     ctrol.S   &lt;- list(N=150, q=5, sigma0=1, MAXIT=100, TOL=0.001,seed=123)

     ctrol.ref &lt;- TML.censored.control.ref(maxit.sigma=2,tol.sigma=0.0001,
               maxit.Beta=2,tol.Beta=0.0001, Maxit.S=50, tol.S.sigma=0.001, 
               tol.S.Beta=0.001,alg.sigma=1,nitmon=FALSE)

     ctrol.tml &lt;- list(maxit.sigma=50,tol.sigma=0.0001,maxit.Beta=50,
               tol.Beta=0.0001, Maxit.TML=50, tol.TML.sigma=0.001, 
               tol.TML.Beta=0.001, alg.sigma=1,nitmon=FALSE)
     
     WML       &lt;- TML.censored(log(LOS)~TypAdm*Age,data=MCI,delta=Dest,
               otp="adaptive",control.S=ctrol.S,control.ref=ctrol.ref,
               control.tml=ctrol.tml)

     summary(WML)

## End(Not run)
</code></pre>

<hr>
<h2 id='TML.censored.control.tml'>Control parameters for the IRLS algorithm of the final TML.censored estimates </h2><span id='topic+TML.censored.control.tml'></span>

<h3>Description</h3>

<p>Auxiliary function for <code><a href="#topic+TML.censored">TML.censored</a></code>. 
Typically only used internally by <code>TML.censored</code>, but may be used to provide
a control argument. This function provides default values.</p>


<h3>Usage</h3>

<pre><code class='language-R'>TML.censored.control.tml(maxit.sigma=20, tol.sigma=0.0001, maxit.Beta=20, 
    tol.Beta=0.0001,Maxit.TML=50, tol.TML.sigma=0.001, tol.TML.Beta=0.001, 
    alg.sigma=1, nitmon = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TML.censored.control.tml_+3A_maxit.sigma">maxit.sigma</code></td>
<td>
<p> Maximum number of iterations in scale step.</p>
</td></tr>
<tr><td><code id="TML.censored.control.tml_+3A_tol.sigma">tol.sigma</code></td>
<td>
<p> Tolerance for sigma in scale step.</p>
</td></tr>
<tr><td><code id="TML.censored.control.tml_+3A_maxit.beta">maxit.Beta</code></td>
<td>
<p> Maximum number of iterations in coefficient step.</p>
</td></tr>
<tr><td><code id="TML.censored.control.tml_+3A_tol.beta">tol.Beta</code></td>
<td>
<p> Tolerance for coefficients in coefficient step.</p>
</td></tr>
<tr><td><code id="TML.censored.control.tml_+3A_maxit.tml">Maxit.TML</code></td>
<td>
<p> Maximum number of iterations for global cycle.</p>
</td></tr>
<tr><td><code id="TML.censored.control.tml_+3A_tol.tml.sigma">tol.TML.sigma</code></td>
<td>
<p> Tolerance for sigma in global cycle.</p>
</td></tr>
<tr><td><code id="TML.censored.control.tml_+3A_tol.tml.beta">tol.TML.Beta</code></td>
<td>
<p> Tolerance for coefficients in global cycle.</p>
</td></tr>
<tr><td><code id="TML.censored.control.tml_+3A_alg.sigma">alg.sigma</code></td>
<td>
<p> Type of algorithm in scale step:
</p>
 
<ul>
<li><p> 1: fixed point algorithm.
</p>
</li>
<li><p> 2: regula falsi.</p>
</li></ul>
</td></tr>
<tr><td><code id="TML.censored.control.tml_+3A_nitmon">nitmon</code></td>
<td>
<p> Set to TRUE if iteration monitoring is desired. Default=FALSE.</p>
</td></tr></table>


<h3>Value</h3>

<p>A list with components named as the arguments.</p>


<h3>See Also</h3>

 <p><code><a href="#topic+TML.censored">TML.censored</a></code>,
<code><a href="#topic+TML.censored.control.S">TML.censored.control.S</a></code>, 
<code><a href="#topic+TML.censored.control.ref">TML.censored.control.ref</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>     ### In the example(TML.censored), the control argument for the final estimates 
	 ### can be built using this function:
	 
	 ## Not run: 
     data(MCI)
     attach(MCI)
     
     # Robust Accelerated Failure Time Regression with Gaussian errors
     ctrol.ref &lt;- list(maxit.sigma=2,tol.sigma=0.0001,maxit.Beta=2,tol.Beta=0.0001,
           Maxit.S=50, tol.S.sigma=0.001, tol.S.Beta=0.001,alg.sigma=1,nitmon=FALSE)

     ctrol.tml &lt;- TML.censored.control.tml(maxit.sigma=50,tol.sigma=0.0001,
           maxit.Beta=50,tol.Beta=0.0001, Maxit.TML=50, tol.TML.sigma=0.001, 
           tol.TML.Beta=0.001, alg.sigma=1,nitmon=FALSE)
     
     WML   &lt;- TML.censored(log(LOS)~TypAdm*Age,data=MCI,delta=Dest,otp="adaptive",
           control.ref=ctrol.ref,control.tml=ctrol.tml)

     summary(WML)

## End(Not run)
</code></pre>

<hr>
<h2 id='TML.noncensored'>Truncated Maximum Likelihood Regression Without Censored Observations</h2><span id='topic+TML.noncensored'></span>

<h3>Description</h3>

<p>This function computes the truncated maximum likelihood regression estimate
described in Marazzi and Yohai (2004). 
The error distribution is assumed to follow approximately a Gaussian or a log-Weibull distribution. 
The cut-off values for outlier rejection are fixed or adaptive.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TML.noncensored(formula, data, errors = "Gaussian", cu = NULL, 
                initial = "S",otp = "fixed", cov = "parametric", 
                input = NULL, control = list(), ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TML.noncensored_+3A_formula">formula</code></td>
<td>
<p> A <code><a href="stats.html#topic+formula">formula</a></code>, i.e., a symbolic description of the model
to be fit (cf. <code><a href="stats.html#topic+glm">glm</a></code> or <code><a href="stats.html#topic+lm">lm</a></code>). </p>
</td></tr>
<tr><td><code id="TML.noncensored_+3A_data">data</code></td>
<td>
<p> An optional data frame containing the variables in the model. If not
found in <code>data</code>, the variables are taken from <code>environment(formula)</code>,
typically the environment from which <code>TML.noncensored</code> is called. </p>
</td></tr>
<tr><td><code id="TML.noncensored_+3A_errors">errors</code></td>
<td>


<ul>
<li><p> &quot;Gaussian&quot;: the error distribution is assumed to be Gaussian.
</p>
</li>
<li><p> &quot;logWeibull&quot; : the error distribution is assumed to be log-Weibull. </p>
</li></ul>
</td></tr>
<tr><td><code id="TML.noncensored_+3A_cu">cu</code></td>
<td>
<p> Preliminary minimal upper cut-off. 
The default is 2.5 in the Gaussian case and 1.855356 in the log-Weibull case. </p>
</td></tr>
<tr><td><code id="TML.noncensored_+3A_initial">initial</code></td>
<td>


<ul>
<li><p> &quot;S&quot;     : initial S-estimate.
</p>
</li>
<li><p> &quot;input&quot; : the initial estimate is given on input.</p>
</li></ul>
</td></tr>
<tr><td><code id="TML.noncensored_+3A_otp">otp</code></td>
<td>


<ul>
<li><p> &quot;adaptive&quot;: adaptive cut-off.
</p>
</li>
<li><p> &quot;fixed&quot;   : non adaptive cut-off.</p>
</li></ul>
</td></tr>
<tr><td><code id="TML.noncensored_+3A_cov">cov</code></td>
<td>


<ul>
<li><p> &quot;no&quot;: no estimate of the covariance matrix of the coefficients is provided on output.
</p>
</li>
<li><p> &quot;parametric&quot;: a parametric estimate of the covariance matrix of the
coefficients is provided (to be used when n is small).
</p>
</li>
<li><p> &quot;nonparametric&quot;: a nonparametric estimate of the covariance
matrix of the coefficients is provided.</p>
</li></ul>
</td></tr>
<tr><td><code id="TML.noncensored_+3A_input">input</code></td>
<td>

<p>Initial input estimates of location and scale.<br /> 
Required when initial=&quot;input&quot;. 
</p>

<ul>
<li><p> &quot;Gaussian case&quot;   : list(theta=...,sigma=...) initial input estimates. theta: location; sigma: scale.
</p>
</li>
<li><p> &quot;logWeibull case&quot; : list(tau=...,v=...) initial input estimates of location (tau) and scale (v).</p>
</li></ul>
</td></tr>
<tr><td><code id="TML.noncensored_+3A_control">control</code></td>
<td>
<p> Control parameters. For the default values, see the function <code><a href="#topic+TML.noncensored.control">TML.noncensored.control</a></code>.</p>
</td></tr>
<tr><td><code id="TML.noncensored_+3A_...">...</code></td>
<td>
<p> If fastS=TRUE, parameters for <code>lmrob.S</code>. See the function <code><a href="robustbase.html#topic+lmrob.control">lmrob.control</a></code>
(from the robustbase package) for the default values. </p>
</td></tr>
</table>


<h3>Value</h3>

 
<p><code>TML.noncensored</code> returns an object of class &quot;TML&quot;. 
The function <code><a href="base.html#topic+summary">summary</a></code> can be used to obtain or print a summary of the results. 
The generic extractor functions <code><a href="stats.html#topic+fitted">fitted</a></code>, <code><a href="stats.html#topic+residuals">residuals</a></code> and 
<code><a href="stats.html#topic+weights">weights</a></code> can be used to extract various elements of the value returned 
by <code>TML.noncensored</code>. The function <code><a href="stats.html#topic+update">update</a></code> can be used to update the model.
</p>
<p>An object of class &quot;TML&quot; is a list with the following components: 
</p>
<table>
<tr><td><code>th0</code></td>
<td>
<p>Initial coefficient estimates (S or input).</p>
</td></tr>
<tr><td><code>v0</code></td>
<td>
<p>Initial scale (S or input).</p>
</td></tr>
<tr><td><code>nit0</code></td>
<td>
<p>Reached number of iteration in <code>lmrob.S</code> (available only if fastS is TRUE).</p>
</td></tr>
<tr><td><code>th1</code></td>
<td>
<p>Final coefficient estimates.</p>
</td></tr>
<tr><td><code>v1</code></td>
<td>
<p>Final scale (S or input).</p>
</td></tr>
<tr><td><code>nit1</code></td>
<td>
<p>Number of iterations reached by the IRLS algorithm for the final estimates.</p>
</td></tr>
<tr><td><code>tu</code>, <code>tl</code></td>
<td>
<p>Final cut-off values.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Estimated proportion of retained observations.</p>
</td></tr>
<tr><td><code>tn</code></td>
<td>
<p>Number of retained observations.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Consistency constant for scale.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>Vector of weights (0 for rejected observations, 1 for retained observations).</p>
</td></tr>
<tr><td><code>COV</code></td>
<td>
<p>Covariance matrix of the final estimates (th1[1],...,th1[p],v1) (where p=ncol(X)).</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>The residuals, that is response minus fitted values.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>The fitted mean values.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>The formula supplied.</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>The <code><a href="stats.html#topic+terms">terms</a></code> object used.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>The <code>data argument</code>.</p>
</td></tr></table>


<h3>References</h3>

<p>Marazzi A., Yohai V. (2004). Adaptively truncated maximum likelihood regression with asymmetric errors.
<em>Journal of Statistical Planning and Inference</em>, 122, 271-291.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+TML.noncensored.control">TML.noncensored.control</a></code>,
<code><a href="#topic+TML1.noncensored">TML1.noncensored</a></code>, <code><a href="#topic+TML1.noncensored.control">TML1.noncensored.control</a></code>, 
<code><a href="#topic+TML.censored">TML.censored</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
     data(D243)
     Cost &lt;- D243$Cost                             # Cost (Swiss francs)
     LOS  &lt;- D243$LOS                              # Length of stay (days)
     Adm  &lt;- D243$Typadm; Adm &lt;- (Adm==" Urg")*1   # Type of admission 
                                                   # (0=on notification, 1=Emergency)
     Ass  &lt;- D243$Typass; Ass &lt;- (Ass=="P"   )*1   # Type of insurance 
                                                   # (0=usual, 1=private)
     Age  &lt;- D243$age                              # Age (years)
     Dst  &lt;- D243$dest;   Dst &lt;- (Dst=="DOMI")*1   # Destination 
                                                   # (1=Home, 0=another hospital)
     Sex  &lt;- D243$Sexe;   Sex &lt;- (Sex=="M"   )*1   # Sex (1=Male, 0=Female)

     # Truncated maximum likelihood regression with Gaussian errors

     z    &lt;- TML.noncensored(log(Cost)~log(LOS)+Adm+Ass+Age+Dst+Sex,
              otp="adaptive",control=list(fastS=TRUE))

     summary(z)
     
     # Truncated maximum likelihood regression with log-Weibull errors

     w    &lt;- TML.noncensored(log(Cost)~log(LOS)+Adm+Ass+Age+Dst+Sex,
             errors="logWeibull",otp="adaptive",control=list(fastS=TRUE))

     summary(w)

## End(Not run)
</code></pre>

<hr>
<h2 id='TML.noncensored.control'>Control Parameters for Truncated Maximum Likelihood Regression 
Without Censored Observations</h2><span id='topic+TML.noncensored.control'></span>

<h3>Description</h3>

<p>Control parameters for <code><a href="#topic+TML.noncensored">TML.noncensored</a></code>. 
Typically only used internally by <code>TML.noncensored</code>, but may be used to construct a control argument.
This function provides default values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TML.noncensored.control(iv = 1, nrep = 0, gam = 0.1, nitmon = FALSE, 
                maxit = 200, tol = 1e-04, fastS = FALSE, seed=1313)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TML.noncensored.control_+3A_iv">iv</code></td>
<td>


<ul>
<li><p> 0: use and do not change the initial estimate of scale.
</p>
</li>
<li><p> 1: compute a truncated maximum likelihood estimate of scale.</p>
</li></ul>
</td></tr>
<tr><td><code id="TML.noncensored.control_+3A_nrep">nrep</code></td>
<td>


<ul>
<li><p> Number of subsamples to be used in the computation of the S-estimate.
</p>
</li>
<li><p> 0: exhaustive sampling if the observation number is not too large.</p>
</li></ul>
</td></tr>
<tr><td><code id="TML.noncensored.control_+3A_gam">gam</code></td>
<td>
<p> Relaxation factor for the IRLS algorithm of final estimate. Set 0 &lt; gam &lt;= 1.</p>
</td></tr>
<tr><td><code id="TML.noncensored.control_+3A_nitmon">nitmon</code></td>
<td>
<p> Set to TRUE if iteration monitoring in IRLS algorithm for the final estimate is desired. Default=FALSE. </p>
</td></tr>
<tr><td><code id="TML.noncensored.control_+3A_maxit">maxit</code></td>
<td>
<p> Maximum number of iterations in IRLS algorithm for the final estimate. </p>
</td></tr>
<tr><td><code id="TML.noncensored.control_+3A_tol">tol</code></td>
<td>
<p> Relative tolerance in IRLS algorithm. </p>
</td></tr>
<tr><td><code id="TML.noncensored.control_+3A_fasts">fastS</code></td>
<td>


<ul>
<li><p> &quot;TRUE&quot;  : the initial S-estimate is computed using <code><a href="robustbase.html#topic+lmrob.S">lmrob.S</a></code> from the
<span class="pkg">robustbase</span> package. The control parameters are taken from <code>lmrob.control</code>.
</p>
</li>
<li><p> &quot;FALSE&quot; : the initial S-estimate is computed using <code>hysest</code> from the
<span class="pkg">robeth</span> package.</p>
</li></ul>
</td></tr>
<tr><td><code id="TML.noncensored.control_+3A_seed">seed</code></td>
<td>
<p> Seed for the random number generator in the resampling algorithm for the initial S-estimate. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components named as the arguments.</p>


<h3>See Also</h3>

 <p><code><a href="#topic+TML.noncensored">TML.noncensored</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>     ### In the example(TML.noncensored), the control argument can be built 
     ### using this function:
## Not run: 
     data(D243)
     Cost &lt;- D243$Cost                             # Cost (Swiss francs)
     LOS  &lt;- D243$LOS                              # Length of stay (days)
     Adm  &lt;- D243$Typadm; Adm &lt;- (Adm==" Urg")*1   # Type of admission 
                                                   # (0=on notification, 1=Emergency)
     Ass  &lt;- D243$Typass; Ass &lt;- (Ass=="P"   )*1   # Type of insurance 
                                                   # (0=usual, 1=private)
     Age  &lt;- D243$age                              # Age (years)
     Dst  &lt;- D243$dest;   Dst &lt;- (Dst=="DOMI")*1   # Destination 
                                                   # (1=Home, 0=another hospital)
     Sex  &lt;- D243$Sexe;   Sex &lt;- (Sex=="M"   )*1   # Sex (1=Male, 0=Female)

     # Truncated maximum likelihood regression with Gaussian errors

     ctrol &lt;- TML.noncensored.control(iv=1, nrep=0, gam=0.2, fastS=TRUE, nitmon=FALSE)
     z     &lt;- TML.noncensored(log(Cost)~log(LOS)+Adm+Ass+Age+Dst+Sex, otp="adaptive")
     summary(z)

## End(Not run)
</code></pre>

<hr>
<h2 id='TML1.noncensored'> Truncated Maximum Likelihood Estimates of Location and Scale</h2><span id='topic+TML1.noncensored'></span>

<h3>Description</h3>

<p>This functions computes the truncated maximum likelihood estimates of location and scale
described in Marazzi and Yohai (2004). 
It assumes that the error distribution is approximately Gaussian or log-Weibull. 
The cut-off values for outlier rejection are fixed or adaptive.
This function is a simplified version of <code><a href="#topic+TML.noncensored">TML.noncensored</a></code> for the case without covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TML1.noncensored(y, errors= c("Gaussian", "logWeibull"), cu = NULL, 
     initial = c("S", "input"), otp = c("adaptive", "fixed"), 
     cov = c("no", "parametric", "nonparametric"), input = NULL, 
     control = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TML1.noncensored_+3A_y">y</code></td>
<td>
<p> Observation vector </p>
</td></tr>
<tr><td><code id="TML1.noncensored_+3A_errors">errors</code></td>
<td>


<ul>
<li><p> &quot;Gaussian&quot;: the error distribution is assumed to be approximately Gaussian.
</p>
</li>
<li><p> &quot;logWeibull&quot; : the error distribution is assumed to be approximately log-Weibull. </p>
</li></ul>
</td></tr>
<tr><td><code id="TML1.noncensored_+3A_cu">cu</code></td>
<td>
<p>Preliminary minimal upper cut-off. The default is 2.5 in the Gaussian case and 1.855356 in the log-Weibull case. </p>
</td></tr>
<tr><td><code id="TML1.noncensored_+3A_initial">initial</code></td>
<td>
 

<ul>
<li><p> &quot;S&quot;     : initial S-estimate.
</p>
</li>
<li><p> &quot;input&quot; : the initial estimate is given on input.</p>
</li></ul>
</td></tr>
<tr><td><code id="TML1.noncensored_+3A_otp">otp</code></td>
<td>


<ul>
<li><p> &quot;adaptive&quot;: adaptive cut-off.
</p>
</li>
<li><p> &quot;fixed&quot;   : non adaptive cut-off.</p>
</li></ul>
</td></tr>
<tr><td><code id="TML1.noncensored_+3A_cov">cov</code></td>
<td>


<ul>
<li><p> &quot;no&quot;: no estimate of the covariance matrix of the estimates is provided on output.
</p>
</li>
<li><p> &quot;parametric&quot;: a parametric estimate of the covariance matrix of the 
location-scale estimates is provided (to be used when n is small).
</p>
</li>
<li><p> &quot;nonparametric&quot;: a nonparametric estimate of the covariance 
matrix of the location-scale estimates is provided.</p>
</li></ul>
</td></tr>
<tr><td><code id="TML1.noncensored_+3A_input">input</code></td>
<td>

<p>Initial input estimates of location and scale.<br /> 
Required when initial=&quot;input&quot;. 
</p>

<ul>
<li><p> &quot;Gaussian case&quot;   : list(theta=...,sigma=...) initial input estimates. theta: location; sigma: scale.
</p>
</li>
<li><p> &quot;logWeibull case&quot; : list(tau=...,v=...) initial input estimates of location (tau) and scale (v).</p>
</li></ul>
</td></tr>
<tr><td><code id="TML1.noncensored_+3A_control">control</code></td>
<td>
<p> Control parameters. For the default values, see the function <code><a href="#topic+TML1.noncensored.control">TML1.noncensored.control</a>.</code></p>
</td></tr>
<tr><td><code id="TML1.noncensored_+3A_...">...</code></td>
<td>
<p>  If initial=&quot;S&quot;, parameters for the computation of the initial S estimates. See the function <code><a href="#topic+TML1.noncensored.control.S">TML1.noncensored.control.S</a></code>
for the default values. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>th0</code></td>
<td>
<p>Initial location estimate (S or input).</p>
</td></tr>
<tr><td><code>v0</code></td>
<td>
<p>Initial scale estimate (S or input).</p>
</td></tr>
<tr><td><code>nit0</code></td>
<td>
<p>Reached number of iteration if initial=&quot;S&quot;</p>
</td></tr>
<tr><td><code>th1</code></td>
<td>
<p>Final location estimate.</p>
</td></tr>
<tr><td><code>v1</code></td>
<td>
<p>Final scale estimate.</p>
</td></tr>
<tr><td><code>nit1</code></td>
<td>
<p>Reached iteration number in IRLS algorithm for final estimate (only for the log_Weibull case).</p>
</td></tr>
<tr><td><code>tu</code>, <code>tl</code></td>
<td>
<p>Final cut-off values.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Estimated proportion of retained observations.</p>
</td></tr>
<tr><td><code>tn</code></td>
<td>
<p>Number of retained observations.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Consistency constant for scale.</p>
</td></tr>
<tr><td><code>wi</code></td>
<td>
<p>Vector of weights (0 for rejected observations, 1 for retained observations).</p>
</td></tr>
<tr><td><code>CV0</code></td>
<td>
<p>Covariance matrix of the initial estimates (th0,v0). </p>
</td></tr>
<tr><td><code>CV1</code></td>
<td>
<p>Covariance matrix of the final   estimates (th1,v1). </p>
</td></tr>
</table>


<h3>References</h3>

 
<p>Marazzi A., Yohai V. (2004). Adaptively truncated maximum likelihood regression with asymmetric errors.
<em>Journal of Statistical Planning and Inference</em>, 122, 271-291.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TML.noncensored">TML.noncensored</a></code>, <code><a href="#topic+TML1.noncensored.control">TML1.noncensored.control</a></code>, <code><a href="#topic+TML1.noncensored.control.S">TML1.noncensored.control.S</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
      data(Z243)
      Cost &lt;- Z243$CouTot                         
      y    &lt;- log(Cost)
      ctrl &lt;- TML1.noncensored.control(iv=1,tol=1e-3)
      z    &lt;- TML1.noncensored(y,errors="logWeibull", initial="S",otp="adaptive",
              cov="no",control=ctrl)

## End(Not run)
</code></pre>

<hr>
<h2 id='TML1.noncensored.control'>Control Parameters forTruncated Maximum Likelihood Estimation
of Location and Scale </h2><span id='topic+TML1.noncensored.control'></span>

<h3>Description</h3>

<p>Auxiliary function for <code><a href="#topic+TML1.noncensored">TML1.noncensored</a></code>. Typically only used
internally by <code>TML1.noncensored</code>, but may be used to construct a control argument.
This function provides default values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TML1.noncensored.control(iv = 1, gam = 0.1, maxit = 200, tol = 1e-04)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TML1.noncensored.control_+3A_iv">iv</code></td>
<td>


<ul>
<li><p> 0: use and do not change the initial estimate of scale.
</p>
</li>
<li><p> 1: compute a truncated maximum likelihood estimate of scale.</p>
</li></ul>
</td></tr>
<tr><td><code id="TML1.noncensored.control_+3A_gam">gam</code></td>
<td>
<p> Relaxation factor for the IRLS algorithm for the final estimate. Set 0 &lt; gam &lt;= 1.</p>
</td></tr>
<tr><td><code id="TML1.noncensored.control_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations in the IRLS algorithm for the final estimate. </p>
</td></tr>
<tr><td><code id="TML1.noncensored.control_+3A_tol">tol</code></td>
<td>
<p> Relative tolerance in the IRLS algorithm for the final estimate. </p>
</td></tr>   </table>


<h3>Value</h3>

<p>A list with components named as the arguments.</p>


<h3>See Also</h3>

 <p><code><a href="#topic+TML1.noncensored">TML1.noncensored</a></code></p>

<hr>
<h2 id='TML1.noncensored.control.S'>
Control parameters for S-estimate of location and scale
</h2><span id='topic+TML1.noncensored.control.S'></span>

<h3>Description</h3>

<p>Auxiliary function for <code><a href="#topic+TML1.noncensored">TML1.noncensored</a></code>. Typically only used
internally by <code>TML1.noncensored</code>, but may be used to construct a control argument.
This function provides default values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TML1.noncensored.control.S(tlo = 1e-04, mxf = 50, mxs = 50, ntm = 50,
                           tls = 1e-06, h = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TML1.noncensored.control.S_+3A_tlo">tlo</code></td>
<td>
<p>Relative tolerance in the iterative algorithms.</p>
</td></tr>
<tr><td><code id="TML1.noncensored.control.S_+3A_mxf">mxf</code></td>
<td>
<p>Maximum number of iterations in computing the location estimate.</p>
</td></tr>
<tr><td><code id="TML1.noncensored.control.S_+3A_mxs">mxs</code></td>
<td>
<p>Maximum number of iterations in computing the scale estimate.</p>
</td></tr>
<tr><td><code id="TML1.noncensored.control.S_+3A_ntm">ntm</code></td>
<td>
<p>Parameter used in iteration monitoring. When the number of iterations
is a multiple of ntm, the current parameter values are printed.</p>
</td></tr>
<tr><td><code id="TML1.noncensored.control.S_+3A_tls">tls</code></td>
<td>
<p>Tolerance for denominators. If a scale estimate is less than tls, the scale
estimate is set equal to tls.</p>
</td></tr>
<tr><td><code id="TML1.noncensored.control.S_+3A_h">h</code></td>
<td>
<p>The number of subdivisions of the interval (min(yi), max(yi)) used is the
computation of the estimate <code class="reqn">\lambda^(0)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the desired values for each of the control parameters, plus the value
Beta0 of <code class="reqn">\beta</code>.
</p>

<hr>
<h2 id='Z243'> Sample of 100 hospital stays for medical back problems</h2><span id='topic+Z243'></span>

<h3>Description</h3>

<p>Sample of 100 patients hospitalized for medical back problems in Switzerland
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Z243)</code></pre>


<h3>Format</h3>

<p>A data frame with 100 observations on the following 14 variables.
</p>

<dl>
<dt><code>NoAdm</code></dt><dd><p>Admission number</p>
</dd>
<dt><code>APDRG</code></dt><dd><p>DRG: Always 243</p>
</dd>
<dt><code>Sex</code></dt><dd><p>Gender: 1=Male, 0=Female</p>
</dd>
<dt><code>Age</code></dt><dd><p>Age in years</p>
</dd>
<dt><code>LOS</code></dt><dd><p>Length of stay (days)</p>
</dd>
<dt><code>CouTot</code></dt><dd><p>Total Cost (Swiss francs)</p>
</dd>
<dt><code>CsansInv</code></dt><dd><p>Cost (Swiss francs)</p>
</dd>
<dt><code>Adm</code></dt><dd><p>Type of admission (0=on notification, 1=Emergency)</p>
</dd>
<dt><code>Ass</code></dt><dd><p>Type of insurance  (0=usual, 1=private)</p>
</dd>
<dt><code>Death</code></dt><dd><p>0=No, 1=Yes</p>
</dd>
<dt><code>BBD</code></dt><dd><p>A numeric vector</p>
</dd>
<dt><code>BBDaggr</code></dt><dd><p>A numeric vector</p>
</dd>
<dt><code>Charls</code></dt><dd><p>A numeric vector</p>
</dd>
<dt><code>LOSF</code></dt><dd><p>Adjusted length of stay</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(Z243)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
