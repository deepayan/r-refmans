<!DOCTYPE html><html><head><title>Help for package TSsmoothing</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TSsmoothing}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#corrmvc'><p>Correlation from a 2d covariance matrix.</p></a></li>
<li><a href='#emp_agr'><p>Employment in agriculture</p></a></li>
<li><a href='#graph_trend'><p>Plot of original and smoothed time series.</p></a></li>
<li><a href='#lambda_value'><p>Calculation of the lambda value.</p></a></li>
<li><a href='#ltable'><p>Lambda values table.</p></a></li>
<li><a href='#plot_trend'><p>Plot fo the time series and its smoothed version in ggplo</p></a></li>
<li><a href='#positive_definite'><p>Checks if a squared matrix is positive definite and turn it to positive definied if necessary</p></a></li>
<li><a href='#preliminar'><p>Preliminar smoothing</p></a></li>
<li><a href='#psigma_estimates'><p>Preliminar estimates</p></a></li>
<li><a href='#sigma_zf'><p>Empirical cross-covarinace.</p></a></li>
<li><a href='#smoothing_level'><p>Smoothing value</p></a></li>
<li><a href='#trade'><p>Annual Trade for USA and Mexico</p></a></li>
<li><a href='#trend_estimate'><p>Trend estimation with controlled smoothing.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Trend Estimation of Univariate and Bivariate Time Series with
Controlled Smoothness</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>It performs the smoothing approach provided by penalized least squares for univariate and bivariate time series, as proposed by Guerrero (2007) and Gerrero et al. (2017). 
          This allows to estimate the time series trend by controlling the amount of resulting (joint) smoothness.
          &mdash;
          Guerrero, V.M (2007)  &lt;<a href="https://doi.org/10.1016%2Fj.spl.2007.03.006">doi:10.1016/j.spl.2007.03.006</a>&gt;.
          Guerrero, V.M; Islas-Camargo, A. and Ramirez-Ramirez, L.L. (2017) &lt;<a href="https://doi.org/10.1080%2F03610926.2015.1133826">doi:10.1080/03610926.2015.1133826</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2(&ge; 3.2.0), MASS (&ge; 7.3.0), gridExtra (&ge; 2.3.0),
Matrix (&ge; 1.2.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-07-10 15:32:03 UTC; hp</td>
</tr>
<tr>
<td>Author:</td>
<td>L. Leticia Ramirez-Ramirez [aut, cre],
  Alejandro Islas-Camargo [aut],
  Victor M. Guerrero [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>L. Leticia Ramirez-Ramirez &lt;leticia.ramirez@cimat.mx&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-07-15 10:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='corrmvc'>Correlation from a 2d covariance matrix.</h2><span id='topic+corrmvc'></span>

<h3>Description</h3>

<p>Computes the correlation given a covariance matrix of a bivariate variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corrmvc(mat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corrmvc_+3A_mat">mat</code></td>
<td>
<p>is a 2x2 covariace matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The empirical correlation fo the two series
</p>

<hr>
<h2 id='emp_agr'>Employment in agriculture</h2><span id='topic+emp_agr'></span>

<h3>Description</h3>

<p>Dataset of the 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emp_agr
</code></pre>


<h3>Format</h3>

<p>A ts vector a length of 25 observations from 1991 to 2015.</p>


<h3>Source</h3>

<p><a href="https://databank.worldbank.org/source/jobs#">https://databank.worldbank.org/source/jobs#</a>
</p>

<hr>
<h2 id='graph_trend'>Plot of original and smoothed time series.</h2><span id='topic+graph_trend'></span>

<h3>Description</h3>

<p>It plots the univariate or bivariate. This function is not intended for users but to be called by trend_estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graph_trend(dat, N, tau, dvar, label = NULL, jump = 1:N,
  bands = TRUE, las, bivariate = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="graph_trend_+3A_dat">dat</code></td>
<td>
<p>is a 2x2 covariace matrix</p>
</td></tr>
<tr><td><code id="graph_trend_+3A_n">N</code></td>
<td>
<p>the number of observations</p>
</td></tr>
<tr><td><code id="graph_trend_+3A_tau">tau</code></td>
<td>
<p>the smoothed time series</p>
</td></tr>
<tr><td><code id="graph_trend_+3A_dvar">dvar</code></td>
<td>
<p>the estimated variance for tau</p>
</td></tr>
<tr><td><code id="graph_trend_+3A_label">label</code></td>
<td>
<p>the vectors of caracters associated to the time points to appear in the axis</p>
</td></tr>
<tr><td><code id="graph_trend_+3A_jump">jump</code></td>
<td>
<p>if label is too long, jump thin them on the axis</p>
</td></tr>
<tr><td><code id="graph_trend_+3A_bands">bands</code></td>
<td>
<p>is TRUE to draw the approximately 95%  confidence bands around tau</p>
</td></tr>
<tr><td><code id="graph_trend_+3A_las">las</code></td>
<td>
<p>is 1 and 2 if the asis should appear vertical and horizontal, respectively</p>
</td></tr>
<tr><td><code id="graph_trend_+3A_bivariate">bivariate</code></td>
<td>
<p>is FALSE if dat is a univariate time series</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The empirical correlation fo the two series
</p>

<hr>
<h2 id='lambda_value'>Calculation of the lambda value.</h2><span id='topic+lambda_value'></span>

<h3>Description</h3>

<p>Obtains the lambda value for specific values of the smoothing level, correlation and length.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambda_value(s, rho, N)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambda_value_+3A_s">s</code></td>
<td>
<p>is a scalar that specifies the smoothing level.</p>
</td></tr>
<tr><td><code id="lambda_value_+3A_rho">rho</code></td>
<td>
<p>is the estimated correlation of the two time series. If the time series is univariate rho should be 0.</p>
</td></tr>
<tr><td><code id="lambda_value_+3A_n">N</code></td>
<td>
<p>the length of the bivariate time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of lambda  lambda_value that corresponds to a smoothing level s
</p>
<p>A flag to indicate if the lambda value was read from ltable
</p>

<hr>
<h2 id='ltable'>Lambda values table.</h2><span id='topic+ltable'></span>

<h3>Description</h3>

<p>An array that presents the lambda values according to time series (N), the smoothing value (s),
and the ts correlation (rho).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ltable
</code></pre>


<h3>Format</h3>

<p>A 3d array with dimension 393 x 12 x  11, where dimensions are:
</p>

<dl>
<dt>N</dt><dd><p> with values from 8 to 400</p>
</dd>
<dt>s</dt><dd><p> with smoothing values c(0.5, 0.6, 0.7, 0.75, 0.8, 0.825, 0.85, 0.875, 0.9, 0.925, 0.95, 0.975)</p>
</dd>
<dt>rho</dt><dd><p> with values c(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 0.95)</p>
</dd>
</dl>


<h3>Details</h3>

<p>3d array of float number that correspond to the lambda values that correspond to the
specified values of the length of the
</p>


<h3>Source</h3>

<p><a href="http://www.diamondse.info/">http://www.diamondse.info/</a>
</p>

<hr>
<h2 id='plot_trend'>Plot fo the time series and its smoothed version in ggplo</h2><span id='topic+plot_trend'></span>

<h3>Description</h3>

<p>It plots the univariate or bivariate time series and its smoothed version (trend) using ggplot. It directly uses the output of trend_estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_trend(smoothedTS, title = NULL, xlab = "Time",
  ylab = names(dat)[1:2])
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_trend_+3A_smoothedts">smoothedTS</code></td>
<td>
<p>Is an object generated by the function trend_estimate</p>
</td></tr>
<tr><td><code id="plot_trend_+3A_title">title</code></td>
<td>
<p>Main title of the graph</p>
</td></tr>
<tr><td><code id="plot_trend_+3A_xlab">xlab</code></td>
<td>
<p>Common x label</p>
</td></tr>
<tr><td><code id="plot_trend_+3A_ylab">ylab</code></td>
<td>
<p>A 2-length vector of characters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The ggplot of the original time series, their treind and its approximated 95
</p>

<hr>
<h2 id='positive_definite'>Checks if a squared matrix is positive definite and turn it to positive definied if necessary</h2><span id='topic+positive_definite'></span>

<h3>Description</h3>

<p>Checks if a squared matrix is positive definite and turn it to positive definied if necessary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>positive_definite(m, c = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="positive_definite_+3A_m">m</code></td>
<td>
<p>Is a 2x2 matrix.</p>
</td></tr>
<tr><td><code id="positive_definite_+3A_c">c</code></td>
<td>
<p>Is a small nonegative number.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The same matrix (if positive definite) or its modification that is positive definite.
</p>

<hr>
<h2 id='preliminar'>Preliminar smoothing</h2><span id='topic+preliminar'></span>

<h3>Description</h3>

<p>Obtains the preliminar smoothed series, based on the preliminar lambda value and empirical estimates for Sigma_eta and Sigma_epsilon. This function is called by trend_estimate as part of the smoothing process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preliminar(dat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preliminar_+3A_dat">dat</code></td>
<td>
<p>is a 2-column matrix with the observations of a bivariate time series. Each row correspond to the values at a given time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The preliminary smoothen series ptau.
</p>
<p>The final estimate for sigma.eta
</p>
<p>The time series correlation given by sigma.eta, rho.eta.
</p>
<p>The preliminary estimation for sigma_epsilon, sigma.epsilon,
</p>
<p>A suggested value for lambda given by the empirical estimations.
</p>
<p>The empirical time series correlation (preliminar to rho.eta), emp_rho.
</p>
<p>The time series length N.
</p>

<hr>
<h2 id='psigma_estimates'>Preliminar estimates</h2><span id='topic+psigma_estimates'></span>

<h3>Description</h3>

<p>It computes the preliminary estimates of Sigma_epsilon and Sigma_eta
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psigma_estimates(dat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psigma_estimates_+3A_dat">dat</code></td>
<td>
<p>is a 2 column matrix with for the bivariate time series observations. Each column correspond to the values at a given time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Sigma epsilon
</p>
<p>Sigma eta
</p>

<hr>
<h2 id='sigma_zf'>Empirical cross-covarinace.</h2><span id='topic+sigma_zf'></span>

<h3>Description</h3>

<p>Function that calculates the empirical cross-covariance of order h for a bivariate time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigma_zf(h, vec1, vec2, N)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sigma_zf_+3A_h">h</code></td>
<td>
<p>the lag value.</p>
</td></tr>
<tr><td><code id="sigma_zf_+3A_vec1">vec1</code></td>
<td>
<p>observations for the first variable of the bivariate time series.</p>
</td></tr>
<tr><td><code id="sigma_zf_+3A_vec2">vec2</code></td>
<td>
<p>observations for the second variable of the bivariate time series.</p>
</td></tr>
<tr><td><code id="sigma_zf_+3A_n">N</code></td>
<td>
<p>the common length of vec1 and vec2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of lambda that corresponds to a smoothing level s.
</p>

<hr>
<h2 id='smoothing_level'>Smoothing value</h2><span id='topic+smoothing_level'></span>

<h3>Description</h3>

<p>Function that reports the smoothing level for a given value of lambda, N and rho (=0 if univariate).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smoothing_level(lambda, rho, N)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smoothing_level_+3A_lambda">lambda</code></td>
<td>
<p>a nonegative number.</p>
</td></tr>
<tr><td><code id="smoothing_level_+3A_rho">rho</code></td>
<td>
<p>the correlation of the time series.</p>
</td></tr>
<tr><td><code id="smoothing_level_+3A_n">N</code></td>
<td>
<p>the length of the observations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>S
</p>

<hr>
<h2 id='trade'>Annual Trade for USA and Mexico</h2><span id='topic+trade'></span>

<h3>Description</h3>

<p>A dataset (matrix) containing the annual trade (
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trade
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> with 49 rows and 2 columns.</p>


<h3>Source</h3>

<p><a href="https://databank.worldbank.org/source/world-development-indicators#">https://databank.worldbank.org/source/world-development-indicators#</a>
</p>

<hr>
<h2 id='trend_estimate'>Trend estimation with controlled smoothing.</h2><span id='topic+trend_estimate'></span>

<h3>Description</h3>

<p>This is the main function that estimates the trend for univariate or bivariate time series for a specified
smoothing level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trend_estimate(dat, smoothing_level = NULL, lambda = NULL,
  plot = TRUE, label = time(dat), jump = NULL, las = 2,
  bands = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trend_estimate_+3A_dat">dat</code></td>
<td>
<p>is a 2x2 matrix with the two time series. Each column correspond to the values at a given time.</p>
</td></tr>
<tr><td><code id="trend_estimate_+3A_smoothing_level">smoothing_level</code></td>
<td>
<p>is a scalar between 0 and 1 that specifies the smoothing of the resulting time series tau.</p>
</td></tr>
<tr><td><code id="trend_estimate_+3A_lambda">lambda</code></td>
<td>
<p>Alternative, the function directly accepts the lambda value that corresponds to the desired smoothing level.</p>
</td></tr>
<tr><td><code id="trend_estimate_+3A_plot">plot</code></td>
<td>
<p>is TRUE when we cant to plot of the original agaist the resulting series.</p>
</td></tr>
<tr><td><code id="trend_estimate_+3A_label">label</code></td>
<td>
<p>vector of characters that corresponds to the labels for each time point in the serie.</p>
</td></tr>
<tr><td><code id="trend_estimate_+3A_jump">jump</code></td>
<td>
<p>is a vector of integers that specifies which values of labels should appear in the x labels.</p>
</td></tr>
<tr><td><code id="trend_estimate_+3A_las">las</code></td>
<td>
<p>is 1(2) if the x labels should be vertical (horizontal).</p>
</td></tr>
<tr><td><code id="trend_estimate_+3A_bands">bands</code></td>
<td>
<p>is TRUE tolo include 95% confidence bands in the plots.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The smoothed series tau.
</p>
<p>The orginal data dat.
</p>
<p>The estimation for sigma_eta, sigma.eta
</p>
<p>The length of the time series N.
</p>
<p>The lambda value corresponding to the smoothing level.
</p>
<p>The diagonal values of the estimated variance of tau, diag.var.tau
</p>
<p>A flag that indicates if data is a bivariate time series.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Employment in agriculture (\% of total employment) (modeled ILO estimate) in OCDE members
data(emp_agr) #It is a ts object with one single time series
sts&lt;-trend_estimate(emp_agr,0.70)
plot_trend(sts, title="Employment in agriculture in OCDE members", xlab = "Years")

# Data Trade (\% of GDP) for USA and Mexico downloaded from
data(trade) #It is a numeric matrix with two columns
sts&lt;-trend_estimate(trade,0.7)
plot_trend(sts, title="Trade in% of GDP",xlab="years")

ts_trade&lt;-ts(trade, start=1969,end=2017) #We transform tade to a ts object
sts&lt;-trend_estimate(ts_trade,0.7)
plot_trend(sts, title="Trade in% of GDP",xlab="years")


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
