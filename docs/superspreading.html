<!DOCTYPE html><html lang="en-GB"><head><title>Help for package superspreading</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {superspreading}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#superspreading-package'><p>superspreading: Understand Individual-Level Variation in Infectious Disease Transmission</p></a></li>
<li><a href='#.chain_sim'><p>Simulate transmission chains using a stochastic branching process</p></a></li>
<li><a href='#.fit'><p>Optimise a function using either numerical optimisation or grid search</p></a></li>
<li><a href='#calc_network_R'><p>Calculate the reproduction number (<code class="reqn">R</code>) for a (heterogeneous)</p>
network</a></li>
<li><a href='#constants'><p>Constants used in <span class="pkg">superspreading</span></p></a></li>
<li><a href='#dpoislnorm'><p>Density of the poisson-lognormal compound distribution</p></a></li>
<li><a href='#dpoisweibull'><p>Density of the poisson-Weibull compound distribution</p></a></li>
<li><a href='#gamma'><p>Defines the gamma functions in terms of the mean reproductive number</p>
(R) and the dispersion parameter (k)</a></li>
<li><a href='#ic_tbl'><p>Helper function to create a model comparison table</p></a></li>
<li><a href='#lseq'><p>Generates a log scaled sequence of real numbers</p></a></li>
<li><a href='#ppoislnorm'><p>Cumulative distribution function of the poisson-lognormal compound</p>
distribution</a></li>
<li><a href='#ppoisweibull'><p>Cumulative distribution function of the poisson-Weibull compound</p>
distribution</a></li>
<li><a href='#probability_contain'><p>Probability that an outbreak will be contained</p></a></li>
<li><a href='#probability_epidemic'><p>Calculate the probability a disease will cause an outbreak based on R, k</p>
and initial cases</a></li>
<li><a href='#probability_extinct'><p>Calculate the probability a branching process will go extinct based on</p>
R, k and initial cases</a></li>
<li><a href='#proportion_cluster_size'><p>Estimate what proportion of new cases originated within a transmission</p>
event of a given size</a></li>
<li><a href='#proportion_transmission'><p>Estimate what proportion of cases cause a certain proportion of</p>
transmission</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Understand Individual-Level Variation in Infectious Disease
Transmission</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimate and understand individual-level variation in
    transmission. Implements density and cumulative compound Poisson
    discrete distribution functions ('Kremer et al.' (2021) 
    &lt;<a href="https://doi.org/10.1038%2Fs41598-021-93578-x">doi:10.1038/s41598-021-93578-x</a>&gt;), as well as functions to calculate
    infectious disease outbreak statistics given epidemiological
    parameters on individual-level transmission; including the probability
    of an outbreak becoming an epidemic/extinct ('Kucharski et al.' (2020) 
    &lt;<a href="https://doi.org/10.1016%2FS1473-3099%2820%2930144-4">doi:10.1016/S1473-3099(20)30144-4</a>&gt;), or the cluster size
    statistics, e.g. what proportion of cases cause X\% of transmission
    ('Lloyd-Smith et al.' (2005) &lt;<a href="https://doi.org/10.1038%2Fnature04153">doi:10.1038/nature04153</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/epiverse-trace/superspreading">https://github.com/epiverse-trace/superspreading</a>,
<a href="https://epiverse-trace.github.io/superspreading/">https://epiverse-trace.github.io/superspreading/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/epiverse-trace/superspreading/issues">https://github.com/epiverse-trace/superspreading/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate, rlang, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>dplyr, epiparameter (&ge; 0.4.0), fitdistrplus, ggplot2,
ggtext, knitr, purrr, rmarkdown, scales, spelling, testthat (&ge;
3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>epiverse-trace/epiversetheme</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-23 13:44:41 UTC; lshjl15</td>
</tr>
<tr>
<td>Author:</td>
<td>Joshua W. Lambert <a href="https://orcid.org/0000-0001-5218-3046"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Adam Kucharski <a href="https://orcid.org/0000-0001-8814-9421"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph],
  Dillon C. Adam <a href="https://orcid.org/0000-0002-7485-9905"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Sebastian Funk <a href="https://orcid.org/0000-0002-2842-3406"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, cph] (.chain_sim uses code from bpmodels::chain_sim),
  Pratik Gupte <a href="https://orcid.org/0000-0001-5294-7819"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [rev],
  Hugo Gruson <a href="https://orcid.org/0000-0002-4094-1476"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [rev],
  James M. Azam <a href="https://orcid.org/0000-0001-5782-7330"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [rev, ctb],
  Chris Hartgerink <a href="https://orcid.org/0000-0003-1050-6809"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [rev]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Joshua W. Lambert &lt;joshua.lambert@lshtm.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-27 18:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='superspreading-package'>superspreading: Understand Individual-Level Variation in Infectious Disease Transmission</h2><span id='topic+superspreading'></span><span id='topic+superspreading-package'></span>

<h3>Description</h3>

<p>Estimate and understand individual-level variation in transmission. Implements density and cumulative compound Poisson discrete distribution functions ('Kremer et al.' (2021) <a href="https://doi.org/10.1038/s41598-021-93578-x">doi:10.1038/s41598-021-93578-x</a>), as well as functions to calculate infectious disease outbreak statistics given epidemiological parameters on individual-level transmission; including the probability of an outbreak becoming an epidemic/extinct ('Kucharski et al.' (2020) <a href="https://doi.org/10.1016/S1473-3099%2820%2930144-4">doi:10.1016/S1473-3099(20)30144-4</a>), or the cluster size statistics, e.g. what proportion of cases cause X% of transmission ('Lloyd-Smith et al.' (2005) <a href="https://doi.org/10.1038/nature04153">doi:10.1038/nature04153</a>).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Joshua W. Lambert <a href="mailto:joshua.lambert@lshtm.ac.uk">joshua.lambert@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0001-5218-3046">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Adam Kucharski <a href="mailto:adam.kucharski@lshtm.ac.uk">adam.kucharski@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0001-8814-9421">ORCID</a>) [copyright holder]
</p>
</li>
<li><p> Dillon C. Adam <a href="mailto:dcadam@hku.hk">dcadam@hku.hk</a> (<a href="https://orcid.org/0000-0002-7485-9905">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Sebastian Funk <a href="mailto:sebastian.funk@lshtm.ac.uk">sebastian.funk@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0002-2842-3406">ORCID</a>) (.chain_sim uses code from bpmodels::chain_sim) [contributor, copyright holder]
</p>
</li>
<li><p> Pratik Gupte <a href="mailto:pratik.gupte@lshtm.ac.uk">pratik.gupte@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0001-5294-7819">ORCID</a>) [reviewer]
</p>
</li>
<li><p> Hugo Gruson <a href="mailto:hugo@data.org">hugo@data.org</a> (<a href="https://orcid.org/0000-0002-4094-1476">ORCID</a>) [reviewer]
</p>
</li>
<li><p> James M. Azam <a href="mailto:james.azam@lshtm.ac.uk">james.azam@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0001-5782-7330">ORCID</a>) [reviewer, contributor]
</p>
</li>
<li><p> Chris Hartgerink <a href="mailto:chris@data.org">chris@data.org</a> (<a href="https://orcid.org/0000-0003-1050-6809">ORCID</a>) [reviewer]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/epiverse-trace/superspreading">https://github.com/epiverse-trace/superspreading</a>
</p>
</li>
<li> <p><a href="https://epiverse-trace.github.io/superspreading/">https://epiverse-trace.github.io/superspreading/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/epiverse-trace/superspreading/issues">https://github.com/epiverse-trace/superspreading/issues</a>
</p>
</li></ul>


<hr>
<h2 id='.chain_sim'>Simulate transmission chains using a stochastic branching process</h2><span id='topic+.chain_sim'></span>

<h3>Description</h3>

<p>Code modified from the <code>bpmodels::chain_sim()</code> function.
The function <code>chain_sim()</code> function from <span class="pkg">bpmodels</span> is reused with
permission and licensed under MIT as is <span class="pkg">bpmodels</span>.
<span class="pkg">bpmodels</span> is not on CRAN and is retired.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.chain_sim(
  n,
  offspring,
  stat = c("size", "length"),
  stat_threshold = Inf,
  generation_time,
  tf = Inf,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".chain_sim_+3A_n">n</code></td>
<td>
<p>Number of simulations to run.</p>
</td></tr>
<tr><td><code id=".chain_sim_+3A_offspring">offspring</code></td>
<td>
<p>Offspring distribution: a character string corresponding to
the R distribution function (e.g., &quot;pois&quot; for Poisson, where
<code><a href="stats.html#topic+rpois">rpois()</a></code> is the R function to generate Poisson random numbers).</p>
</td></tr>
<tr><td><code id=".chain_sim_+3A_stat">stat</code></td>
<td>
<p>String; Statistic to calculate. Can be one of:
</p>

<ul>
<li><p> &quot;size&quot;: the total number of offspring.
</p>
</li>
<li><p> &quot;length&quot;: the total number of ancestors.
</p>
</li></ul>
</td></tr>
<tr><td><code id=".chain_sim_+3A_stat_threshold">stat_threshold</code></td>
<td>
<p>A size or length above which the simulation results
should be set to <code>Inf</code>. Defaults to <code>Inf</code>, resulting in no results
ever set to <code>Inf</code></p>
</td></tr>
<tr><td><code id=".chain_sim_+3A_generation_time">generation_time</code></td>
<td>
<p>The generation time generator function; the name of a
user-defined named or anonymous function with only one argument <code>n</code>,
representing the number of generation times to generate.</p>
</td></tr>
<tr><td><code id=".chain_sim_+3A_tf">tf</code></td>
<td>
<p>End time (if <code>generation_time</code> interval is given).</p>
</td></tr>
<tr><td><code id=".chain_sim_+3A_...">...</code></td>
<td>
<p>Parameters of the offspring distribution as required by R.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> with columns <code>n</code> (simulation ID), <code>id</code> (a unique
ID within each simulation for each individual element of the chain),
<code>ancestor</code> (the ID of the ancestor of each element), and <code>generation</code>. A
<code>time</code> column is also appended if the generation_time interval is supplied to
<code>serial</code>.
</p>


<h3>Author(s)</h3>

<p>Sebastian Funk, James M. Azam, Joshua W. Lambert
</p>

<hr>
<h2 id='.fit'>Optimise a function using either numerical optimisation or grid search</h2><span id='topic+.fit'></span>

<h3>Description</h3>

<p>Optimise a function using either numerical optimisation or grid search
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.fit(func, fit_method = c("optim", "grid"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".fit_+3A_func">func</code></td>
<td>
<p>A <code>function</code>.</p>
</td></tr>
<tr><td><code id=".fit_+3A_fit_method">fit_method</code></td>
<td>
<p>A <code>character</code> string, either <code>"optim"</code> or <code>"grid"</code>.</p>
</td></tr>
<tr><td><code id=".fit_+3A_...">...</code></td>
<td>
<p>&lt;<code><a href="rlang.html#topic+dyn-dots">dynamic-dots</a></code>&gt; Named elements to replace
default optimisation settings for either <code><a href="stats.html#topic+optim">optim()</a></code> or grid search. See
details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Arguments passed through <a href="base.html#topic+dots">dots</a> depend on whether <code>fit_method</code> is set to
<code>"optim"</code> or <code>"grid"</code>. For <code>"optim"</code>, arguments are passed to <code><a href="stats.html#topic+optim">optim()</a></code>,
for <code>"grid"</code>, the variable arguments are <code>lower</code>, <code>upper</code> (lower and
upper bounds on the grid search for the parameter being optimised, defaults
are <code>lower = 0.001</code> and <code>upper = 0.999</code>), and <code>"res"</code> (the resolution of
grid, default is <code>res = 0.001</code>).
</p>


<h3>Value</h3>

<p>A single <code>numeric</code>.
</p>

<hr>
<h2 id='calc_network_R'>Calculate the reproduction number (<code class="reqn">R</code>) for a (heterogeneous)
network</h2><span id='topic+calc_network_R'></span>

<h3>Description</h3>

<p>The calculation of the reproduction number adjusting for
heterogeneity in number of contacts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_network_R(
  mean_num_contact,
  sd_num_contact,
  infect_duration,
  prob_transmission,
  age_range
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_network_R_+3A_mean_num_contact">mean_num_contact</code></td>
<td>
<p>A <code>numeric</code>, mean (average) number of new contacts
per unit time.</p>
</td></tr>
<tr><td><code id="calc_network_R_+3A_sd_num_contact">sd_num_contact</code></td>
<td>
<p>A <code>numeric</code>, standard deviation of the number of new
contacts per unit time.</p>
</td></tr>
<tr><td><code id="calc_network_R_+3A_infect_duration">infect_duration</code></td>
<td>
<p>A <code>numeric</code>, the duration of infectiousness.</p>
</td></tr>
<tr><td><code id="calc_network_R_+3A_prob_transmission">prob_transmission</code></td>
<td>
<p>A <code>numeric</code> probability of transmission per contact,
also known as <code class="reqn">\beta</code>.</p>
</td></tr>
<tr><td><code id="calc_network_R_+3A_age_range">age_range</code></td>
<td>
<p>A <code>numeric</code> vector with two elements, the lower and upper
age limits of individuals in the network.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code>numeric</code> vector of length 2, the unadjusted (<code>R</code>)
and network adjusted (<code>R_net</code>) estimates of <code class="reqn">R</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example using NATSAL data
calc_network_R(
  mean_num_contact = 14.1,
  sd_num_contact = 69.6,
  infect_duration = 1,
  prob_transmission = 1,
  age_range = c(16, 74)
)
</code></pre>

<hr>
<h2 id='constants'>Constants used in <span class="pkg">superspreading</span></h2><span id='topic+constants'></span><span id='topic+FINITE_INF'></span><span id='topic+NSIM'></span>

<h3>Description</h3>

<p><code>FINITE_INF</code> is a large finite number used to approximate <code>Inf</code>.
</p>
<p><code>NSIM</code> is the number of simulations run when generating random samples or
branching process simulation replicates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FINITE_INF

NSIM
</code></pre>


<h3>Format</h3>

<p>An object of class <code>numeric</code> of length 1.
</p>
<p>An object of class <code>numeric</code> of length 1.
</p>

<hr>
<h2 id='dpoislnorm'>Density of the poisson-lognormal compound distribution</h2><span id='topic+dpoislnorm'></span>

<h3>Description</h3>

<p>Density of the poisson-lognormal compound distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpoislnorm(x, meanlog, sdlog)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dpoislnorm_+3A_x">x</code></td>
<td>
<p>A <code>number</code> for the quantile of the distribution.</p>
</td></tr>
<tr><td><code id="dpoislnorm_+3A_meanlog">meanlog</code></td>
<td>
<p>A <code>number</code> for the mean of the distribution on the log scale.</p>
</td></tr>
<tr><td><code id="dpoislnorm_+3A_sdlog">sdlog</code></td>
<td>
<p>A <code>number</code> for the standard deviation of the distribution on
the log scale.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is vectorised so a vector of quantiles can be input
and the output will have an equal length.
</p>


<h3>Value</h3>

<p>A <code>numeric</code> vector of the density of the poisson-lognormal
distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dpoislnorm(x = 10, meanlog = 1, sdlog = 2)
dpoislnorm(x = 1:10, meanlog = 1, sdlog = 2)
</code></pre>

<hr>
<h2 id='dpoisweibull'>Density of the poisson-Weibull compound distribution</h2><span id='topic+dpoisweibull'></span>

<h3>Description</h3>

<p>Density of the poisson-Weibull compound distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpoisweibull(x, shape, scale)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dpoisweibull_+3A_x">x</code></td>
<td>
<p>A <code>number</code> for the quantile of the distribution.</p>
</td></tr>
<tr><td><code id="dpoisweibull_+3A_shape">shape</code></td>
<td>
<p>A <code>number</code> for the shape parameter of the distribution.</p>
</td></tr>
<tr><td><code id="dpoisweibull_+3A_scale">scale</code></td>
<td>
<p>A <code>number</code> for the scale parameter of the distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is vectorised so a vector of quantiles can be input
and the output will have an equal length.
</p>


<h3>Value</h3>

<p>A <code>numeric</code> vector of the density of the poisson-Weibull
distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dpoisweibull(x = 10, shape = 1, scale = 2)
dpoisweibull(x = 1:10, shape = 1, scale = 2)
</code></pre>

<hr>
<h2 id='gamma'>Defines the gamma functions in terms of the mean reproductive number
(R) and the dispersion parameter (k)</h2><span id='topic+gamma'></span><span id='topic+dgammaRk'></span><span id='topic+pgammaRk'></span><span id='topic+fvx'></span>

<h3>Description</h3>


<ul>
<li> <p><code><a href="#topic+dgammaRk">dgammaRk()</a></code> for the gamma density function
</p>
</li>
<li> <p><code><a href="#topic+pgammaRk">pgammaRk()</a></code> for the gamma distribution function
</p>
</li>
<li> <p><code><a href="#topic+fvx">fvx()</a></code> fore the gamma probability density function (pdf) describing the
individual reproductive number <code class="reqn">\nu</code> given R0 and k
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>dgammaRk(x, R, k)

pgammaRk(x, R, k)

fvx(x, R, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gamma_+3A_r">R</code></td>
<td>
<p>A <code>number</code> specifying the R parameter (i.e. average secondary cases
per infectious individual).</p>
</td></tr>
<tr><td><code id="gamma_+3A_k">k</code></td>
<td>
<p>A <code>number</code> specifying the  k parameter (i.e. overdispersion in
offspring distribution from fitted negative binomial).</p>
</td></tr>
</table>

<hr>
<h2 id='ic_tbl'>Helper function to create a model comparison table</h2><span id='topic+ic_tbl'></span>

<h3>Description</h3>

<p>This is a helper function for creating a model comparison
<code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> primarily for use in the <span class="pkg">superspreading</span> vignettes. It
is designed specifically for handling <code><a href="fitdistrplus.html#topic+fitdist">fitdistrplus::fitdist()</a></code> output and
not a generalised function. See <code>bbmle::ICtab()</code> for a more general use
function to create information criteria tables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ic_tbl(..., sort_by = c("AIC", "BIC", "none"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ic_tbl_+3A_...">...</code></td>
<td>
<p><a href="base.html#topic+dots">dots</a> One or more model fit results from
<code><a href="fitdistrplus.html#topic+fitdist">fitdistrplus::fitdist()</a></code>.</p>
</td></tr>
<tr><td><code id="ic_tbl_+3A_sort_by">sort_by</code></td>
<td>
<p>A <code>character</code> string specifying which information criterion
to order the table by, either <code>"AIC"</code> (default), <code>"BIC"</code>, or <code>"none"</code>
(i.e. no ordering).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace("fitdistrplus", quietly = TRUE)) {
  cases &lt;- rnbinom(n = 100, mu = 5, size = 0.7)
  pois_fit &lt;- fitdistrplus::fitdist(data = cases, distr = "pois")
  geom_fit &lt;- fitdistrplus::fitdist(data = cases, distr = "geom")
  nbinom_fit &lt;- fitdistrplus::fitdist(data = cases, distr = "nbinom")
  ic_tbl(pois_fit, geom_fit, nbinom_fit)
}
</code></pre>

<hr>
<h2 id='lseq'>Generates a log scaled sequence of real numbers</h2><span id='topic+lseq'></span>

<h3>Description</h3>

<p>Generates a log scaled sequence of real numbers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lseq(from, to, length.out)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lseq_+3A_from">from</code>, <code id="lseq_+3A_to">to</code></td>
<td>
<p>the starting and (maximal) end values of the
sequence.  Of length <code>1</code> unless just <code>from</code> is supplied as
an unnamed argument.</p>
</td></tr>
<tr><td><code id="lseq_+3A_length.out">length.out</code></td>
<td>
<p>desired length of the sequence.  A
non-negative number, which for <code>seq</code> and <code>seq.int</code> will be
rounded up if fractional.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>seq.int</code> and the default method of <code>seq</code> for numeric
arguments return a vector of type <code>"integer"</code> or <code>"double"</code>:
programmers should not rely on which.
</p>
<p><code>seq_along</code> and <code>seq_len</code> return an integer vector, unless
it is a <em><a href="base.html#topic+long+20vector">long vector</a></em> when it will be double.
</p>

<hr>
<h2 id='ppoislnorm'>Cumulative distribution function of the poisson-lognormal compound
distribution</h2><span id='topic+ppoislnorm'></span>

<h3>Description</h3>

<p>Cumulative distribution function of the poisson-lognormal compound
distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppoislnorm(q, meanlog, sdlog)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ppoislnorm_+3A_q">q</code></td>
<td>
<p>A <code>number</code> for the quantile of the distribution.</p>
</td></tr>
<tr><td><code id="ppoislnorm_+3A_meanlog">meanlog</code></td>
<td>
<p>A <code>number</code> for the mean of the distribution on the log scale.</p>
</td></tr>
<tr><td><code id="ppoislnorm_+3A_sdlog">sdlog</code></td>
<td>
<p>A <code>number</code> for the standard deviation of the distribution on
the log scale.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is vectorised so a vector of quantiles can be input
and the output will have an equal length.
</p>


<h3>Value</h3>

<p>A <code>numeric</code> vector of the distribution function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ppoislnorm(q = 10, meanlog = 1, sdlog = 2)
ppoislnorm(q = 1:10, meanlog = 1, sdlog = 2)
</code></pre>

<hr>
<h2 id='ppoisweibull'>Cumulative distribution function of the poisson-Weibull compound
distribution</h2><span id='topic+ppoisweibull'></span>

<h3>Description</h3>

<p>Cumulative distribution function of the poisson-Weibull compound
distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppoisweibull(q, shape, scale)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ppoisweibull_+3A_q">q</code></td>
<td>
<p>A <code>number</code> for the quantile of the distribution.</p>
</td></tr>
<tr><td><code id="ppoisweibull_+3A_shape">shape</code></td>
<td>
<p>A <code>number</code> for the shape parameter of the distribution.</p>
</td></tr>
<tr><td><code id="ppoisweibull_+3A_scale">scale</code></td>
<td>
<p>A <code>number</code> for the scale parameter of the distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is vectorised so a vector of quantiles can be input
and the output will have an equal length.
</p>


<h3>Value</h3>

<p>A <code>numeric</code> vector of the distribution function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ppoisweibull(q = 10, shape = 1, scale = 2)
ppoisweibull(q = 1:10, shape = 1, scale = 2)
</code></pre>

<hr>
<h2 id='probability_contain'>Probability that an outbreak will be contained</h2><span id='topic+probability_contain'></span>

<h3>Description</h3>

<p>Outbreak containment is defined as outbreak extinction when
<code>simulate = FALSE</code>. When <code>simulate = FALSE</code>, <code><a href="#topic+probability_contain">probability_contain()</a></code> is
equivalent to calling <code><a href="#topic+probability_extinct">probability_extinct()</a></code>.
</p>
<p>When <code>simulate = TRUE</code>, outbreak containment is defined by the
<code>case_threshold</code> (default = 100) and <code>outbreak_time</code> arguments.
Firstly, <code>case_threshold</code> sets the size of the transmission chain below
which the outbreak is considered contained. Secondly, <code>outbreak_time</code> sets
the time duration from the start of the outbreak within which the outbreak
is contained if there is no more onwards transmission beyond this time.
When setting an <code>outbreak_time</code>, a <code>generation_time</code> is also required.
<code>case_threshold</code> and <code>outbreak_time</code> can be jointly set.
Overall, when <code>simulate = TRUE</code>, containment is defined as the size and
time duration of a transmission chain not reaching the <code>case_threshold</code>
and <code>outbreak_time</code>, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probability_contain(
  R,
  k,
  num_init_infect,
  ind_control = 0,
  pop_control = 0,
  simulate = FALSE,
  ...,
  case_threshold = 100,
  outbreak_time = Inf,
  generation_time = NULL,
  offspring_dist
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="probability_contain_+3A_r">R</code></td>
<td>
<p>A <code>number</code> specifying the R parameter (i.e. average secondary cases
per infectious individual).</p>
</td></tr>
<tr><td><code id="probability_contain_+3A_k">k</code></td>
<td>
<p>A <code>number</code> specifying the  k parameter (i.e. overdispersion in
offspring distribution from fitted negative binomial).</p>
</td></tr>
<tr><td><code id="probability_contain_+3A_num_init_infect">num_init_infect</code></td>
<td>
<p>An <code>integer</code> (or at least
<a href="https://rlang.r-lib.org/reference/is_integerish.html">&quot;integerish&quot;</a> if
stored as double) specifying the number of initial infections.</p>
</td></tr>
<tr><td><code id="probability_contain_+3A_ind_control">ind_control</code></td>
<td>
<p>A <code>numeric</code> specifying the strength of individual-level
control measures. These control measures assume that infected individuals
do not produce any secondary infections with probability <code>ind_control</code>,
thus increasing the proportion of cases that do not create any subsequent
infections. The control measure is between <code>0</code> (default) and <code>1</code> (maximum).</p>
</td></tr>
<tr><td><code id="probability_contain_+3A_pop_control">pop_control</code></td>
<td>
<p>A <code>numeric</code> specifying the strength of population-level
control measures that reduce the transmissibility of all cases by a
constant factor. Between <code>0</code> (default) and <code>1</code> (maximum).</p>
</td></tr>
<tr><td><code id="probability_contain_+3A_simulate">simulate</code></td>
<td>
<p>A <code>logical</code> boolean determining whether the probability
of containment is calculated analytically or numerically using a stochastic
branching process model. Default is <code>FALSE</code> which calls
<code><a href="#topic+probability_extinct">probability_extinct()</a></code>, setting to <code>TRUE</code> uses a branching process and
enables setting the <code>case_threshold</code>, <code>outbreak_time</code> and <code>generation_time</code>
arguments.</p>
</td></tr>
<tr><td><code id="probability_contain_+3A_...">...</code></td>
<td>
<p>&lt;<code><a href="rlang.html#topic+dyn-dots">dynamic-dots</a></code>&gt; Named elements to replace
default arguments in <code><a href="#topic+.chain_sim">.chain_sim()</a></code>. See details.</p>
</td></tr>
<tr><td><code id="probability_contain_+3A_case_threshold">case_threshold</code></td>
<td>
<p>A number for the threshold of the number of cases below
which the epidemic is considered contained. <code>case_threshold</code> is only used
when <code>simulate = TRUE</code>.</p>
</td></tr>
<tr><td><code id="probability_contain_+3A_outbreak_time">outbreak_time</code></td>
<td>
<p>A number for the time since the start of
the outbreak to determine if outbreaks are contained within a given period
of time. <code>outbreak_time</code> is only used when <code>simulate = TRUE</code>.</p>
</td></tr>
<tr><td><code id="probability_contain_+3A_generation_time">generation_time</code></td>
<td>
<p>A <code>function</code> to generate generation times. The
function must have a single argument and return a <code>numeric</code> vector with
generation times. See details for example. The <code>function</code> can be defined or
anonymous. <code>generation_time</code> is only used when <code>simulate = TRUE</code>.</p>
</td></tr>
<tr><td><code id="probability_contain_+3A_offspring_dist">offspring_dist</code></td>
<td>
<p>An <code style="white-space: pre;">&#8288;&lt;epiparameter&gt;&#8288;</code> object. An S3 class for working
with epidemiological parameters/distributions, see
<code><a href="epiparameter.html#topic+epiparameter">epiparameter::epiparameter()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When using <code>simulate = TRUE</code>, the default arguments to simulate the
transmission chains with <code><a href="#topic+.chain_sim">.chain_sim()</a></code> are 10<sup>5</sup> replicates,
a negative binomial (<code>nbinom</code>) offspring distribution, parameterised with
<code>R</code> (and <code>pop_control</code> if &gt; 0) and <code>k</code>.
</p>
<p>When setting the <code>outbreak_time</code> argument, the <code>generation_time</code> argument is
also required. The <code>generation_time</code> argument requires a random number
generator function. For example, if we assume the generation time is
lognormally distributed with <code>meanlog = 1</code> and <code>sdlog = 1.5</code>, then we can
define the <code>function</code> to pass to <code>generation_time</code> as:
</p>
<div class="sourceCode r"><pre>function(x) rlnorm(x, meanlog = 1, sdlog = 1.5)
</pre></div>


<h3>Value</h3>

<p>A <code>number</code> for the probability of containment.
</p>


<h3>References</h3>

<p>Lloyd-Smith, J. O., Schreiber, S. J., Kopp, P. E., &amp; Getz, W. M. (2005)
Superspreading and the effect of individual variation on disease emergence.
Nature, 438(7066), 355-359. <a href="https://doi.org/10.1038/nature04153">doi:10.1038/nature04153</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+probability_extinct">probability_extinct()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># population-level control measures
probability_contain(R = 1.5, k = 0.5, num_init_infect = 1, pop_control = 0.1)

# individual-level control measures
probability_contain(R = 1.5, k = 0.5, num_init_infect = 1, ind_control = 0.1)

# both levels of control measures
probability_contain(
  R = 1.5,
  k = 0.5,
  num_init_infect = 1,
  ind_control = 0.1,
  pop_control = 0.1
)

# multi initial infections with population-level control measures
probability_contain(R = 1.5, k = 0.5, num_init_infect = 5, pop_control = 0.1)

# probability of containment within a certain amount of time
# this requires parameterising a generation time
gt &lt;- function(n) {
  rlnorm(n, meanlog = 1, sdlog = 1.5)
}
probability_contain(
  R = 1.2,
  k = 0.5,
  num_init_infect = 1,
  simulate = TRUE,
  case_threshold = 50,
  outbreak_time = 20,
  generation_time = gt
)
</code></pre>

<hr>
<h2 id='probability_epidemic'>Calculate the probability a disease will cause an outbreak based on R, k
and initial cases</h2><span id='topic+probability_epidemic'></span>

<h3>Description</h3>

<p>Calculates the probability a branching process will cause an
epidemic (i.e. probability will fail to go extinct) based on R, k and
initial cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probability_epidemic(
  R,
  k,
  num_init_infect,
  ind_control = 0,
  pop_control = 0,
  ...,
  offspring_dist
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="probability_epidemic_+3A_r">R</code></td>
<td>
<p>A <code>number</code> specifying the R parameter (i.e. average secondary cases
per infectious individual).</p>
</td></tr>
<tr><td><code id="probability_epidemic_+3A_k">k</code></td>
<td>
<p>A <code>number</code> specifying the  k parameter (i.e. overdispersion in
offspring distribution from fitted negative binomial).</p>
</td></tr>
<tr><td><code id="probability_epidemic_+3A_num_init_infect">num_init_infect</code></td>
<td>
<p>An <code>integer</code> (or at least
<a href="https://rlang.r-lib.org/reference/is_integerish.html">&quot;integerish&quot;</a> if
stored as double) specifying the number of initial infections.</p>
</td></tr>
<tr><td><code id="probability_epidemic_+3A_ind_control">ind_control</code></td>
<td>
<p>A <code>numeric</code> specifying the strength of individual-level
control measures. These control measures assume that infected individuals
do not produce any secondary infections with probability <code>ind_control</code>,
thus increasing the proportion of cases that do not create any subsequent
infections. The control measure is between <code>0</code> (default) and <code>1</code> (maximum).</p>
</td></tr>
<tr><td><code id="probability_epidemic_+3A_pop_control">pop_control</code></td>
<td>
<p>A <code>numeric</code> specifying the strength of population-level
control measures that reduce the transmissibility of all cases by a
constant factor. Between <code>0</code> (default) and <code>1</code> (maximum).</p>
</td></tr>
<tr><td><code id="probability_epidemic_+3A_...">...</code></td>
<td>
<p>&lt;<code><a href="rlang.html#topic+dyn-dots">dynamic-dots</a></code>&gt; Named elements to replace
default optimisation settings. Currently only <code>"fit_method"</code> is accepted
and can be either <code>"optim"</code> (default) or <code>"grid"</code> for numerical
optimisation routine or grid search, respectively.</p>
</td></tr>
<tr><td><code id="probability_epidemic_+3A_offspring_dist">offspring_dist</code></td>
<td>
<p>An <code style="white-space: pre;">&#8288;&lt;epiparameter&gt;&#8288;</code> object. An S3 class for working
with epidemiological parameters/distributions, see
<code><a href="epiparameter.html#topic+epiparameter">epiparameter::epiparameter()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value with the probability of a large epidemic.
</p>


<h3>References</h3>

<p>Lloyd-Smith, J. O., Schreiber, S. J., Kopp, P. E., &amp; Getz, W. M. (2005)
Superspreading and the effect of individual variation on disease emergence.
Nature, 438(7066), 355-359. <a href="https://doi.org/10.1038/nature04153">doi:10.1038/nature04153</a>
</p>
<p>Kucharski, A. J., Russell, T. W., Diamond, C., Liu, Y., Edmunds, J.,
Funk, S. &amp; Eggo, R. M. (2020). Early dynamics of transmission and control
of COVID-19: a mathematical modelling study. The Lancet Infectious Diseases,
20(5), 553-558. <a href="https://doi.org/10.1016/S1473-3099%2820%2930144-4">doi:10.1016/S1473-3099(20)30144-4</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+probability_extinct">probability_extinct()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>probability_epidemic(R = 1.5, k = 0.1, num_init_infect = 10)
</code></pre>

<hr>
<h2 id='probability_extinct'>Calculate the probability a branching process will go extinct based on
R, k and initial cases</h2><span id='topic+probability_extinct'></span>

<h3>Description</h3>

<p>Calculates the probability a branching process will not causes
an epidemic and will go extinct. This is the complement of the probability
of a disease causing an epidemic (<code><a href="#topic+probability_epidemic">probability_epidemic()</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probability_extinct(
  R,
  k,
  num_init_infect,
  ind_control = 0,
  pop_control = 0,
  ...,
  offspring_dist
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="probability_extinct_+3A_r">R</code></td>
<td>
<p>A <code>number</code> specifying the R parameter (i.e. average secondary cases
per infectious individual).</p>
</td></tr>
<tr><td><code id="probability_extinct_+3A_k">k</code></td>
<td>
<p>A <code>number</code> specifying the  k parameter (i.e. overdispersion in
offspring distribution from fitted negative binomial).</p>
</td></tr>
<tr><td><code id="probability_extinct_+3A_num_init_infect">num_init_infect</code></td>
<td>
<p>An <code>integer</code> (or at least
<a href="https://rlang.r-lib.org/reference/is_integerish.html">&quot;integerish&quot;</a> if
stored as double) specifying the number of initial infections.</p>
</td></tr>
<tr><td><code id="probability_extinct_+3A_ind_control">ind_control</code></td>
<td>
<p>A <code>numeric</code> specifying the strength of individual-level
control measures. These control measures assume that infected individuals
do not produce any secondary infections with probability <code>ind_control</code>,
thus increasing the proportion of cases that do not create any subsequent
infections. The control measure is between <code>0</code> (default) and <code>1</code> (maximum).</p>
</td></tr>
<tr><td><code id="probability_extinct_+3A_pop_control">pop_control</code></td>
<td>
<p>A <code>numeric</code> specifying the strength of population-level
control measures that reduce the transmissibility of all cases by a
constant factor. Between <code>0</code> (default) and <code>1</code> (maximum).</p>
</td></tr>
<tr><td><code id="probability_extinct_+3A_...">...</code></td>
<td>
<p>&lt;<code><a href="rlang.html#topic+dyn-dots">dynamic-dots</a></code>&gt; Named elements to replace
default optimisation settings. Currently only <code>"fit_method"</code> is accepted
and can be either <code>"optim"</code> (default) or <code>"grid"</code> for numerical
optimisation routine or grid search, respectively.</p>
</td></tr>
<tr><td><code id="probability_extinct_+3A_offspring_dist">offspring_dist</code></td>
<td>
<p>An <code style="white-space: pre;">&#8288;&lt;epiparameter&gt;&#8288;</code> object. An S3 class for working
with epidemiological parameters/distributions, see
<code><a href="epiparameter.html#topic+epiparameter">epiparameter::epiparameter()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value with the probability of going extinct.
</p>


<h3>References</h3>

<p>Lloyd-Smith, J. O., Schreiber, S. J., Kopp, P. E., &amp; Getz, W. M. (2005).
Superspreading and the effect of individual variation on disease emergence.
Nature, 438(7066), 355-359. <a href="https://doi.org/10.1038/nature04153">doi:10.1038/nature04153</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+probability_epidemic">probability_epidemic()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>probability_extinct(R = 1.5, k = 0.1, num_init_infect = 10)
</code></pre>

<hr>
<h2 id='proportion_cluster_size'>Estimate what proportion of new cases originated within a transmission
event of a given size</h2><span id='topic+proportion_cluster_size'></span>

<h3>Description</h3>

<p>Calculates the proportion of new cases that originated with a
transmission event of a given size. It can be useful to inform backwards
contact tracing efforts, i.e. how many cases are associated with large
clusters. Here we define a cluster to as a transmission of a primary case
to at least one secondary case.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>proportion_cluster_size(
  R,
  k,
  cluster_size,
  ...,
  offspring_dist,
  format_prop = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="proportion_cluster_size_+3A_r">R</code></td>
<td>
<p>A <code>number</code> specifying the R parameter (i.e. average secondary cases
per infectious individual).</p>
</td></tr>
<tr><td><code id="proportion_cluster_size_+3A_k">k</code></td>
<td>
<p>A <code>number</code> specifying the  k parameter (i.e. overdispersion in
offspring distribution from fitted negative binomial).</p>
</td></tr>
<tr><td><code id="proportion_cluster_size_+3A_cluster_size">cluster_size</code></td>
<td>
<p>A <code>number</code> for the cluster size threshold.</p>
</td></tr>
<tr><td><code id="proportion_cluster_size_+3A_...">...</code></td>
<td>
<p><a href="base.html#topic+dots">dots</a> not used, extra arguments supplied will cause a warning.</p>
</td></tr>
<tr><td><code id="proportion_cluster_size_+3A_offspring_dist">offspring_dist</code></td>
<td>
<p>An <code style="white-space: pre;">&#8288;&lt;epiparameter&gt;&#8288;</code> object. An S3 class for working
with epidemiological parameters/distributions, see
<code><a href="epiparameter.html#topic+epiparameter">epiparameter::epiparameter()</a></code>.</p>
</td></tr>
<tr><td><code id="proportion_cluster_size_+3A_format_prop">format_prop</code></td>
<td>
<p>A <code>logical</code> determining whether the proportion column
of the <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> returned by the function is formatted as a string with
a percentage sign (<code style="white-space: pre;">&#8288;%&#8288;</code>), (<code>TRUE</code>, default), or as a <code>numeric</code> (<code>FALSE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the proportion of secondary cases that
are caused by transmission events of a certain size. It does not calculate
the proportion of transmission events that cause a cluster of secondary
cases of a certain size. In other words it is the number of cases above a
threshold divided by the total number of cases, not the number of
transmission events above a certain threshold divided by the number of
transmission events.
</p>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> with the value for the proportion of new cases
that are part of a transmission event above a threshold for a given value
of R and k.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>R &lt;- 2
k &lt;- 0.1
cluster_size &lt;- 10
proportion_cluster_size(R = R, k = k, cluster_size = cluster_size)

# example with a vector of k
k &lt;- c(0.1, 0.2, 0.3, 0.4, 0.5)
proportion_cluster_size(R = R, k = k, cluster_size = cluster_size)

# example with a vector of cluster sizes
cluster_size &lt;- c(5, 10, 25)
proportion_cluster_size(R = R, k = k, cluster_size = cluster_size)
</code></pre>

<hr>
<h2 id='proportion_transmission'>Estimate what proportion of cases cause a certain proportion of
transmission</h2><span id='topic+proportion_transmission'></span>

<h3>Description</h3>

<p>Calculates the proportion of cases that cause a certain
percentage of transmission.
</p>
<p>It is commonly estimated what proportion of cases cause 80% of transmission
(i.e. secondary cases).
This can be calculated using <code>proportion_transmission()</code> at varying values of
<code class="reqn">R</code> and for different values of percentage transmission.
</p>
<p>There are two methods for calculating the proportion of transmission,
<code class="reqn">p_{80}</code> (default) and <code class="reqn">t_{20}</code>, see <code>method</code> argument or details for
more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>proportion_transmission(
  R,
  k,
  percent_transmission,
  method = c("p_80", "t_20"),
  simulate = FALSE,
  ...,
  offspring_dist,
  format_prop = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="proportion_transmission_+3A_r">R</code></td>
<td>
<p>A <code>number</code> specifying the R parameter (i.e. average secondary cases
per infectious individual).</p>
</td></tr>
<tr><td><code id="proportion_transmission_+3A_k">k</code></td>
<td>
<p>A <code>number</code> specifying the  k parameter (i.e. overdispersion in
offspring distribution from fitted negative binomial).</p>
</td></tr>
<tr><td><code id="proportion_transmission_+3A_percent_transmission">percent_transmission</code></td>
<td>
<p>A <code>number</code> of the percentage transmission
for which a proportion of cases has produced.</p>
</td></tr>
<tr><td><code id="proportion_transmission_+3A_method">method</code></td>
<td>
<p>A <code>character</code> string defining which method is used to calculate
the proportion of transmission. Options are <code>"p_80"</code> (default) or <code>"t_20"</code>.
See details for more information on each of these methods.</p>
</td></tr>
<tr><td><code id="proportion_transmission_+3A_simulate">simulate</code></td>
<td>
<p>A <code>logical</code> whether the calculation should be done
numerically (i.e. simulate secondary contacts) or analytically. Default is
<code>FALSE</code> which uses the analytical calculation.</p>
</td></tr>
<tr><td><code id="proportion_transmission_+3A_...">...</code></td>
<td>
<p><a href="base.html#topic+dots">dots</a> not used, extra arguments supplied will cause a warning.</p>
</td></tr>
<tr><td><code id="proportion_transmission_+3A_offspring_dist">offspring_dist</code></td>
<td>
<p>An <code style="white-space: pre;">&#8288;&lt;epiparameter&gt;&#8288;</code> object. An S3 class for working
with epidemiological parameters/distributions, see
<code><a href="epiparameter.html#topic+epiparameter">epiparameter::epiparameter()</a></code>.</p>
</td></tr>
<tr><td><code id="proportion_transmission_+3A_format_prop">format_prop</code></td>
<td>
<p>A <code>logical</code> determining whether the proportion column
of the <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> returned by the function is formatted as a string with
a percentage sign (<code style="white-space: pre;">&#8288;%&#8288;</code>), (<code>TRUE</code>, default), or as a <code>numeric</code> (<code>FALSE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the expected proportion of transmission from a given
proportion of infectious cases. There are two methods to calculate this with
distinct formulations, <code class="reqn">p_{80}</code> and <code class="reqn">t_{20}</code> these can be specified
by the <code>method</code> argument.
</p>
<p><code>method = p_80</code> calculates relative transmission heterogeneity
from the offspring distribution of secondary cases, <code class="reqn">Z</code>, where the upper
proportion of the distribution comprise <code class="reqn">x\%</code> of total number of cases
given R0 and k, where <code class="reqn">x</code> is typically defined as 0.8 or 80%. e.g. 80%
of all transmissions are generated by the upper 20% of cases, or
<code>p_80 = 0.2</code>, per the 80/20 rule. In this formulation, changes in R can
have a significant effect on the estimate of <code class="reqn">p_80</code> even when k is
constant. Importantly, this formulation <strong>does not</strong> allow for true
homogeneity when <code>k = Inf</code> i.e. <code class="reqn">p_{80} = 0.8</code>.
</p>
<p><code>method = t_20</code> calculates a similar ratio, instead in terms of
the theoretical individual reproductive number and infectiousness given
R0 and k. The individual reproductive number, 'v', is described in
Lloyd-Smith JO et al. (2005), &quot;as a random variable representing the
expected number of secondary cases caused by a particular infected
individual. Values for v are drawn from a continuous gamma probability
distribution with population mean R0 and dispersion parameter k, which
encodes all variation in infectious histories of individuals, including
properties of the host and pathogen and environmental circumstances.&quot; The
value of k corresponds to the shape parameters of the gamma distribution
which encodes the variation in the gamma-poisson mixture aka the negative
binomial
</p>
<p>For <code>method = t_20</code>, we define the upper proportion of infectiousness,
which is typically 0.2 i.e. the upper 20% most infectious
cases, again per the 80/20 rule. e.g. the most infectious 20% of cases,
are expected to produce 80% of all infections, or <code>t_20 = 0.8</code>. Unlike
<code>method = p_80</code>, changes in R have no effect on the estimate
of t_80 when k is constant, but R is still required for the underlying
calculation. This formulation <strong>does</strong> allow for true homogeneity when
k = Inf i.e. t_20 = 0.2, or t_80 = 0.8.
</p>
<p>Multiple values of R and k can be supplied and a <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of
every combination of these will be returned.
</p>
<p>The numerical calculation for <code>method = p_80</code> uses random number generation
to simulate secondary contacts so the answers may minimally vary between
calls. The number of simulation replicates is fixed to 10<sup>5</sup>.
</p>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> with the value for the proportion of cases for a
given value of R and k.
</p>


<h3>References</h3>

<p>The analytical calculation is from:
</p>
<p>Endo, A., Abbott, S., Kucharski, A. J., &amp; Funk, S. (2020)
Estimating the overdispersion in COVID-19 transmission using outbreak
sizes outside China. Wellcome Open Research, 5.
<a href="https://doi.org/10.12688/wellcomeopenres.15842.3">doi:10.12688/wellcomeopenres.15842.3</a>
</p>
<p>The <code class="reqn">t_{20}</code> method follows the formula defined in section 2.2.5 of the
supplementary material for:
</p>
<p>Lloyd-Smith JO, Schreiber SJ, Kopp PE, Getz WM. Superspreading and the
effect of individual variation on disease emergence. Nature. 2005
Nov;438(7066):3559. <a href="https://doi.org/10.1038/nature04153">doi:10.1038/nature04153</a>
</p>
<p>The original code for the <code class="reqn">t_{20}</code> method is from ongoing work
originating from <a href="https://github.com/dcadam/kt">https://github.com/dcadam/kt</a> and:
</p>
<p>Adam D, Gostic K, Tsang T, Wu P, Lim WW, Yeung A, et al.
Time-varying transmission heterogeneity of SARS and COVID-19 in Hong Kong.
2022. <a href="https://doi.org/10.21203/rs.3.rs-1407962/v1">doi:10.21203/rs.3.rs-1407962/v1</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example of single values of R and k
percent_transmission &lt;- 0.8 # 80% of transmission
R &lt;- 2
k &lt;- 0.5
proportion_transmission(
  R = R,
  k = k,
  percent_transmission = percent_transmission
)

# example with multiple values of k
k &lt;- c(0.1, 0.2, 0.3, 0.4, 0.5, 1)
proportion_transmission(
  R = R,
  k = k,
  percent_transmission = percent_transmission
)

# example with vectors of R and k
R &lt;- c(1, 2, 3)
proportion_transmission(
  R = R,
  k = k,
  percent_transmission = percent_transmission
)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
