<!DOCTYPE html><html lang="en"><head><title>Help for package optbin</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {optbin}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#assign.optbin'>
<p>Bin Assignment</p></a></li>
<li><a href='#hist.optbin'>
<p>Histogram with Optimal Bins Marked</p></a></li>
<li><a href='#optbin'>
<p>Optimal Binning of Continuous Variables</p></a></li>
<li><a href='#plot.optbin'>
<p>Plotting Optimal Bins</p></a></li>
<li><a href='#print.optbin'>
<p>Printing Optimal Bins</p></a></li>
<li><a href='#summary.optbin'>
<p>Summarizing Optimal Bins</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-10-04</td>
</tr>
<tr>
<td>Title:</td>
<td>Optimal Binning of Data</td>
</tr>
<tr>
<td>Author:</td>
<td>Greg Kreider [aut, cre]</td>
</tr>
<tr>
<td>Copyright:</td>
<td>Primordial Machine Vision Systems, Inc.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Greg Kreider &lt;support@primachvis.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Defines thresholds for breaking data into a number of
  discrete levels, minimizing the (mean) squared error within all bins.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-3-Clause">BSD_3_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-31 17:33:00 UTC; kreider</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-31 18:10:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='assign.optbin'>
Bin Assignment
</h2><span id='topic+assign.optbin'></span>

<h3>Description</h3>

<p><code>assign.optbin</code> returns an object with the same shape as the input
data and values replaced by bin numbers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assign.optbin(x, binspec, extend.upper=FALSE, by.value=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="assign.optbin_+3A_x">x</code></td>
<td>

<p>numeric data to assign
</p>
</td></tr>
<tr><td><code id="assign.optbin_+3A_binspec">binspec</code></td>
<td>

<p>an optimal binning partition
</p>
</td></tr>
<tr><td><code id="assign.optbin_+3A_extend.upper">extend.upper</code></td>
<td>

<p>if true then any value in x above the last bin is assigned to that bin,
otherwise its bin is set to NA
</p>
</td></tr>
<tr><td><code id="assign.optbin_+3A_by.value">by.value</code></td>
<td>

<p>if true then return average value for bin instead of bin numbers
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Replaces the values in a copy of the input data by the bin number it
belongs to, or by the bin average value with by.value.  The lowest bin
always extends to -Inf.  The extend.upper argument can open the last bin
to +Inf if true.  Use this function to get in-place bin assignments for
the unsorted data that was passed to optbin.
</p>


<h3>Value</h3>

<p>An object of the same shape as the data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+optbin">optbin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- c(rnorm(30, mean=10, sd=2), rnorm(40, mean=20, sd=2),
       rnorm(30, mean=30, sd=3))
binned &lt;- optbin(d, 3)
assign.optbin(d, binned)
</code></pre>

<hr>
<h2 id='hist.optbin'>
Histogram with Optimal Bins Marked
</h2><span id='topic+hist.optbin'></span>

<h3>Description</h3>

<p>Draw a histogram of the data used to build the optimal binning and mark
the extent of the bins.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'optbin'
hist(x, bincol=NULL, main=NULL, xlab=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hist.optbin_+3A_x">x</code></td>
<td>

<p>an object of class <code>optbin</code>.
</p>
</td></tr>
<tr><td><code id="hist.optbin_+3A_bincol">bincol</code></td>
<td>

<p>vector of colors for showing extent of bins (default uses an internal set)
</p>
</td></tr>
<tr><td><code id="hist.optbin_+3A_main">main</code></td>
<td>

<p>plot title, if not specified will modify the normal histogram title
</p>
</td></tr>
<tr><td><code id="hist.optbin_+3A_xlab">xlab</code></td>
<td>

<p>x axis label, if not specified will modify the normal histogram label
</p>
</td></tr>
<tr><td><code id="hist.optbin_+3A_...">...</code></td>
<td>

<p>other parameters passed through to hist
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The points behind the binning are passed unchanged to the histogram function.
Bins are marked with colored bars under the x axis, and lines showing the
average value in each are also drawn on top.
</p>


<h3>Value</h3>

<p>None
</p>


<h3>See Also</h3>

<p><code><a href="#topic+optbin">optbin</a></code>,
<code><a href="graphics.html#topic+hist">hist</a></code>
</p>

<hr>
<h2 id='optbin'>
Optimal Binning of Continuous Variables
</h2><span id='topic+optbin'></span>

<h3>Description</h3>

<p>Determines break points in numeric data that minimize the difference between
each point in a bin and the average over it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optbin(x, numbin, metric=c('se', 'mse'), is.sorted=FALSE, max.cache=2^31, na.rm=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="optbin_+3A_x">x</code></td>
<td>

<p>numeric data
</p>
</td></tr>
<tr><td><code id="optbin_+3A_numbin">numbin</code></td>
<td>

<p>number of bins to partition vector into
</p>
</td></tr>
<tr><td><code id="optbin_+3A_metric">metric</code></td>
<td>

<p>minimize squared error (se) between values and average over bin, or mean
squared error (mse) dividing squared error by bin length
</p>
</td></tr>
<tr><td><code id="optbin_+3A_is.sorted">is.sorted</code></td>
<td>

<p>set true if x is already in increasing order
</p>
</td></tr>
<tr><td><code id="optbin_+3A_max.cache">max.cache</code></td>
<td>

<p>maximum memory in bytes to use to cache bin metrics; if analysis would need
more than use slower calculation without cache
</p>
</td></tr>
<tr><td><code id="optbin_+3A_na.rm">na.rm</code></td>
<td>

<p>drop NA values (which may occur when converting the data to a vector),
otherwise cannot proceed with binning
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data is converted into a numeric vector and sorted if necessary.  Internally
bins are determined by positions within the vector, with the breaks inclusive
at the upper end.  The bin thresholds are the same, so bin b covers the range
thr[b-1] &lt; x &lt;= thr[b], where thr[0] is -Inf.  The routine finds the first
split found with the best metric, if there is more than one.
</p>
<p>The library uses an exhaustive search over all possible breakpoints.  It
begins by finding the best splits with 2 bins for all pairs of start and
endpoints, then adds a third bin, and so on.  This rejects most alternatives
at each level, leaving an O(nbin * nval * nval) algorithm.
</p>


<h3>Value</h3>

<p>An object of class 'optbin' with components:
</p>
<table role = "presentation">
<tr><td><code>x</code></td>
<td>

<p>the original data, sorted
</p>
</td></tr>
<tr><td><code>numbins</code></td>
<td>

<p>the number of bins created
</p>
</td></tr>
<tr><td><code>call</code></td>
<td>

<p>argument values when function called
</p>
</td></tr>
<tr><td><code>metric</code></td>
<td>

<p>cost function used to select best partition
</p>
</td></tr>
<tr><td><code>minse</code></td>
<td>

<p>value of SE/MSE metric for all bins
</p>
</td></tr>
<tr><td><code>thr</code></td>
<td>

<p>upper threshold of bin range, inclusive
</p>
</td></tr>
<tr><td><code>binavg</code></td>
<td>

<p>average of values in each bin
</p>
</td></tr>
<tr><td><code>binse</code></td>
<td>

<p>value of SE/MSE metric for each bin
</p>
</td></tr>
<tr><td><code>breaks</code></td>
<td>

<p>positions of endpoint (inclusive) of each bin in x
</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+assign.optbin">assign.optbin</a></code>, <code><a href="#topic+print.optbin">print.optbin</a></code>,
<code><a href="#topic+summary.optbin">summary.optbin</a></code>, <code><a href="#topic+plot.optbin">plot.optbin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Well separated groups
set.seed(17)
d1 &lt;- c(rnorm(75, mean=1, sd=0.2), rnorm(75, mean=3, sd=0.2),
        rnorm(84, mean=6, sd=0.2), rnorm(75, mean=9, sd=0.2),
        rnorm(75, mean=11, sd=0.2), rnorm(150, mean=15, sd=0.2))
## Divides into groups 1+2+3, 4+5, 6, metric is 1176.3
binned3 &lt;- optbin(d1, 3)
summary(binned3)
plot(binned3)
## Divides into groups 1, 2, 3, 4+5, and 6, metric is 169.9
binned5 &lt;- optbin(d1, 5)
plot(binned5)
## Divides into separate groups, metric is 24.4
binned6 &lt;- optbin(d1, 6)
summary(binned6)
plot(binned6)
## Each rnorm group divides roughly in half.
binned12 &lt;- optbin(d1, 12)
plot(binned12)
## A grouping that overlaps, bins near but not at minima between peaks
d2 &lt;- c(rnorm(300, mean=1, sd=0.25), rnorm(400, mean=2, sd=0.25),
        rnorm(300, mean=3, sd=0.25))
binned3b &lt;- optbin(d2, 3)
hist(binned3b, breaks=50, col='yellow')
</code></pre>

<hr>
<h2 id='plot.optbin'>
Plotting Optimal Bins
</h2><span id='topic+plot.optbin'></span>

<h3>Description</h3>

<p><code>plot</code> method for class <code>optbin</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'optbin'
plot(x, col=NULL, main="Binned Observations", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.optbin_+3A_x">x</code></td>
<td>

<p>an object of class <code>optbin</code>.
</p>
</td></tr>
<tr><td><code id="plot.optbin_+3A_col">col</code></td>
<td>

<p>vector of colors to apply to bins (default uses an internal set)
</p>
</td></tr>
<tr><td><code id="plot.optbin_+3A_main">main</code></td>
<td>

<p>title of graph
</p>
</td></tr>
<tr><td><code id="plot.optbin_+3A_...">...</code></td>
<td>

<p>other parameters passed through to the underlying plotting routines (do not
set xaxt or ann)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot will contain the sorted points of the data that generated the
bins.  Points are color-coded per bin, and the plot contains the average
value over the bin as a line.  x axis labels are the upper thresholds for
each bin.
</p>


<h3>Value</h3>

<p>None
</p>


<h3>See Also</h3>

<p><code><a href="#topic+optbin">optbin</a></code>
</p>

<hr>
<h2 id='print.optbin'>
Printing Optimal Bins
</h2><span id='topic+print.optbin'></span>

<h3>Description</h3>

<p><code>print</code> method for class <code>optbin</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'optbin'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.optbin_+3A_x">x</code></td>
<td>

<p>an object of class <code>optbin</code>.
</p>
</td></tr>
<tr><td><code id="print.optbin_+3A_...">...</code></td>
<td>

<p>generic arguments (ignored)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Shows the upper bounds of each bin, ie. bin b covers
threshold[b-1] &lt; x &lt;= threshold[b] where threshold[0] is -Inf.  Also prints
the total (mean) squared error sum over all bins.
</p>


<h3>Value</h3>

<p>The argument x unchanged, an object of class 'optbin' with components:
</p>
<table role = "presentation">
<tr><td><code>x</code></td>
<td>

<p>the original data, sorted
</p>
</td></tr>
<tr><td><code>numbins</code></td>
<td>

<p>the number of bins created
</p>
</td></tr>
<tr><td><code>call</code></td>
<td>

<p>argument values when function called
</p>
</td></tr>
<tr><td><code>metric</code></td>
<td>

<p>cost function used to select best partition
</p>
</td></tr>
<tr><td><code>minse</code></td>
<td>

<p>value of SE/MSE metric for all bins
</p>
</td></tr>
<tr><td><code>thr</code></td>
<td>

<p>upper threshold of bin range, inclusive
</p>
</td></tr>
<tr><td><code>binavg</code></td>
<td>

<p>average of values in each bin
</p>
</td></tr>
<tr><td><code>binse</code></td>
<td>

<p>value of SE/MSE metric for each bin
</p>
</td></tr>
<tr><td><code>breaks</code></td>
<td>

<p>positions of endpoint (inclusive) of each bin in x
</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+optbin">optbin</a></code>, <code><a href="#topic+summary.optbin">summary.optbin</a></code>
</p>

<hr>
<h2 id='summary.optbin'>
Summarizing Optimal Bins
</h2><span id='topic+summary.optbin'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>optbin</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'optbin'
summary(object, show.range=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.optbin_+3A_object">object</code></td>
<td>

<p>an object of class <code>optbin</code>
</p>
</td></tr>
<tr><td><code id="summary.optbin_+3A_show.range">show.range</code></td>
<td>

<p>if true then print the bin's range of points (endpoint inclusive) in the
sorted data
</p>
</td></tr>
<tr><td><code id="summary.optbin_+3A_...">...</code></td>
<td>

<p>generic arguments (ignored)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Prints a table with the upper threshold (inclusive), the average of the
data within the bin, and the (mean) squared error sum.  show.range also
adds a column with the start and end indices of the sorted data belonging
to the bin, although this applies to the sorted list and is less useful
in general.
</p>


<h3>Value</h3>

<p>Only called for side-effects (printing).  There is no return value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+optbin">optbin</a></code>, <code><a href="#topic+print.optbin">print.optbin</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
