<!DOCTYPE html><html lang="en"><head><title>Help for package COMMA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {COMMA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#COMBO_EM_algorithm'><p>EM-Algorithm Estimation of the Binary Outcome Misclassification Model</p></a></li>
<li><a href='#COMBO_EM_function'><p>EM-Algorithm Function for Estimation of the Misclassification Model</p></a></li>
<li><a href='#COMBO_weight'><p>Compute E-step for Binary Outcome Misclassification Model Estimated With the EM-Algorithm</p></a></li>
<li><a href='#COMMA_boot_sample'><p>Generate Bootstrap Samples for Estimating Standard Errors</p></a></li>
<li><a href='#COMMA_data'><p>Generate Data to use in COMMA Functions</p></a></li>
<li><a href='#COMMA_EM'><p>EM Algorithm Estimation of the Binary Mediator Misclassification Model</p></a></li>
<li><a href='#COMMA_EM_bootstrap_SE'><p>Estimate Bootstrap Standard Errors using EM</p></a></li>
<li><a href='#COMMA_OLS'><p>Ordinary Least Squares Estimation of the Binary Mediator Misclassification Model</p></a></li>
<li><a href='#COMMA_OLS_bootstrap_SE'><p>Estimate Bootstrap Standard Errors using OLS</p></a></li>
<li><a href='#COMMA_PVW'><p>Predictive Value Weighting Estimation of the Binary Mediator Misclassification Model</p></a></li>
<li><a href='#COMMA_PVW_bootstrap_SE'><p>Estimate Bootstrap Standard Errors using PVW</p></a></li>
<li><a href='#EM_function_bernoulliY'><p>EM Algorithm Function for Estimation of the Misclassification Model</p></a></li>
<li><a href='#EM_function_bernoulliY_XM'><p>EM Algorithm Function for Estimation of the Misclassification Model</p></a></li>
<li><a href='#EM_function_normalY'><p>EM Algorithm Function for Estimation of the Misclassification Model</p></a></li>
<li><a href='#EM_function_normalY_XM'><p>EM Algorithm Function for Estimation of the Misclassification Model</p></a></li>
<li><a href='#EM_function_poissonY'><p>EM Algorithm Function for Estimation of the Misclassification Model</p></a></li>
<li><a href='#EM_function_poissonY_XM'><p>EM Algorithm Function for Estimation of the Misclassification Model</p></a></li>
<li><a href='#misclassification_prob'><p>Compute Conditional Probability of Observed Mediator Given True Mediator, for Every Subject</p></a></li>
<li><a href='#NCHS2022_sample'><p>Example data from the National Vital Statistics System of the National Center for Health Statistics (NCHS), 2022</p></a></li>
<li><a href='#pi_compute'><p>Compute Probability of Each True Outcome, for Every Subject</p></a></li>
<li><a href='#pistar_compute'><p>Compute Conditional Probability of Each Observed Outcome Given Each True Outcome, for Every Subject</p></a></li>
<li><a href='#sum_every_n'><p>Sum Every &quot;n&quot;th Element</p></a></li>
<li><a href='#sum_every_n1'><p>Sum Every &quot;n&quot;th Element, then add 1</p></a></li>
<li><a href='#theta_optim'><p>Likelihood Function for Normal Outcome Mechanism with a Binary Mediator</p></a></li>
<li><a href='#theta_optim_XM'><p>Likelihood Function for Normal Outcome Mechanism with a Binary Mediator and an Interaction Term</p></a></li>
<li><a href='#true_classification_prob'><p>Compute Probability of Each True Mediator, for Every Subject</p></a></li>
<li><a href='#w_m_binaryY'><p>Compute E-step for Binary Mediator Misclassification Model Estimated With the EM Algorithm</p></a></li>
<li><a href='#w_m_normalY'><p>Compute E-step for Binary Mediator Misclassification Model Estimated With the EM Algorithm</p></a></li>
<li><a href='#w_m_poissonY'><p>Compute E-step for Binary Mediator Misclassification Model Estimated With the EM Algorithm</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Correcting Misclassified Mediation Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Kimberly Webb [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kimberly Webb  &lt;kah343@cornell.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Use three methods to estimate parameters from a mediation analysis
  with a binary misclassified mediator. These methods correct for the problem
  of "label switching" using Youden's J criteria. A detailed description of the 
  analysis methods is available in Webb and Wells (2024), "Effect estimation in 
  the presence of a misclassified binary mediator" &lt;<a href="https://doi.org/10.48550%2FarXiv.2407.06970">doi:10.48550/arXiv.2407.06970</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Matrix (&gt; 1.4-1), turboEM (&ge; 2021.1), dplyr (&ge; 1.1.4),
foreach (&ge; 1.5.2), parallel (&ge; 4.3.1), doParallel (&ge; 1.0.17)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr (&ge; 1.40), kableExtra (&ge; 1.3.4), ggplot2 (&ge; 3.5.0),
markdown (&ge; 1.13), stats (&ge; 4.3.1), svglite (&ge; 2.1.3)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Collate:</td>
<td>'sum_every_n1.R' 'sum_every_n.R' 'pistar_compute.R'
'pi_compute.R' 'COMBO_weight.R' 'COMBO_EM_function.R'
'COMBO_EM_algorithm.R' 'COMMA_data.R' 'w_m_normalY.R'
'w_m_binaryY.R' 'EM_function_normalY_XM.R'
'EM_function_normalY.R' 'EM_function_bernoulliY_XM.R'
'EM_function_bernoulliY.R' 'COMMA_EM.R' 'COMMA_boot_sample.R'
'COMMA_EM_bootstrap_SE.R' 'COMMA_OLS.R'
'COMMA_OLS_bootstrap_SE.R' 'COMMA_PVW.R'
'COMMA_PVW_bootstrap_SE.R' 'EM_function_poissonY.R'
'EM_function_poissonY_XM.R' 'NCHS2022_sample.R'
'misclassification_prob.R' 'theta_optim.R' 'theta_optim_XM.R'
'true_classification_prob.R' 'w_m_poissonY.R'</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-13 20:40:28 UTC; KIW58</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-13 21:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='COMBO_EM_algorithm'>EM-Algorithm Estimation of the Binary Outcome Misclassification Model</h2><span id='topic+COMBO_EM_algorithm'></span>

<h3>Description</h3>

<p>Jointly estimate <code class="reqn">\beta</code> and <code class="reqn">\gamma</code> parameters from the true outcome
and observation mechanisms, respectively, in a binary outcome misclassification
model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMBO_EM_algorithm(
  Ystar,
  x_matrix,
  z_matrix,
  beta_start,
  gamma_start,
  tolerance = 1e-07,
  max_em_iterations = 1500,
  em_method = "squarem"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="COMBO_EM_algorithm_+3A_ystar">Ystar</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the observed
outcome <code>Y*</code>. There should be no <code>NA</code> terms. The reference category is 2.</p>
</td></tr>
<tr><td><code id="COMBO_EM_algorithm_+3A_x_matrix">x_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true outcome mechanism.
<code>x_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_algorithm_+3A_z_matrix">z_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the observation mechanism.
<code>z_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_algorithm_+3A_beta_start">beta_start</code></td>
<td>
<p>A numeric vector or column matrix of starting values for the <code class="reqn">\beta</code>
parameters in the true outcome mechanism. The number of elements in <code>beta_start</code>
should be equal to the number of columns of <code>x_matrix</code> plus 1.</p>
</td></tr>
<tr><td><code id="COMBO_EM_algorithm_+3A_gamma_start">gamma_start</code></td>
<td>
<p>A numeric vector or matrix of starting values for the <code class="reqn">\gamma</code>
parameters in the observation mechanism. In matrix form, the <code>gamma_start</code> matrix rows
correspond to parameters for the <code>Y* = 1</code>
observed outcome, with the dimensions of <code>z_matrix</code> plus 1, and the
gamma parameter matrix columns correspond to the true outcome categories
<code class="reqn">M \in \{1, 2\}</code>. A numeric vector for <code>gamma_start</code> is
obtained by concatenating the gamma matrix, i.e. <code>gamma_start &lt;- c(gamma_matrix)</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_algorithm_+3A_tolerance">tolerance</code></td>
<td>
<p>A numeric value specifying when to stop estimation, based on
the difference of subsequent log-likelihood estimates. The default is <code>1e-7</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_algorithm_+3A_max_em_iterations">max_em_iterations</code></td>
<td>
<p>An integer specifying the maximum number of
iterations of the EM algorithm. The default is <code>1500</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_algorithm_+3A_em_method">em_method</code></td>
<td>
<p>A character string specifying which EM algorithm will be applied.
Options are <code>"em"</code>, <code>"squarem"</code>, or <code>"pem"</code>. The default and
recommended option is <code>"squarem"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>COMBO_EM_algorithm</code> returns a data frame containing four columns. The first
column, <code>Parameter</code>, represents a unique parameter value for each row.
The next column contains the parameter <code>Estimates</code>, followed by the standard
error estimates, <code>SE</code>. The final column, <code>Convergence</code>, reports
whether or not the algorithm converged for a given parameter estimate.
</p>

<hr>
<h2 id='COMBO_EM_function'>EM-Algorithm Function for Estimation of the Misclassification Model</h2><span id='topic+COMBO_EM_function'></span>

<h3>Description</h3>

<p>EM-Algorithm Function for Estimation of the Misclassification Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMBO_EM_function(param_current, obs_Y_matrix, X, Z, sample_size, n_cat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="COMBO_EM_function_+3A_param_current">param_current</code></td>
<td>
<p>A numeric vector of regression parameters, in the order
<code class="reqn">\beta, \gamma</code>. The <code class="reqn">\gamma</code> vector is obtained from the matrix form.
In matrix form, the gamma parameter matrix rows
correspond to parameters for the <code>Y* = 1</code>
observed outcome, with the dimensions of <code>Z</code>.
In matrix form, the gamma parameter matrix columns correspond to the true outcome categories
<code class="reqn">j = 1, \dots,</code> <code>n_cat</code>. The numeric vector <code>gamma_v</code> is
obtained by concatenating the gamma matrix, i.e. <code>gamma_v &lt;- c(gamma_matrix)</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_function_+3A_obs_y_matrix">obs_Y_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the observed
outcome <code>Y*</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="COMBO_EM_function_+3A_x">X</code></td>
<td>
<p>A numeric design matrix for the true outcome mechanism.</p>
</td></tr>
<tr><td><code id="COMBO_EM_function_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix for the observation mechanism.</p>
</td></tr>
<tr><td><code id="COMBO_EM_function_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>X</code> or <code>Z</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_function_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcome, <code>Y*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>COMBO_EM_function</code> returns a numeric vector of updated parameter
estimates from one iteration of the EM-algorithm.
</p>

<hr>
<h2 id='COMBO_weight'>Compute E-step for Binary Outcome Misclassification Model Estimated With the EM-Algorithm</h2><span id='topic+COMBO_weight'></span>

<h3>Description</h3>

<p>Compute E-step for Binary Outcome Misclassification Model Estimated With the EM-Algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMBO_weight(ystar_matrix, pistar_matrix, pi_matrix, sample_size, n_cat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="COMBO_weight_+3A_ystar_matrix">ystar_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the observed
outcome <code>Y*</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="COMBO_weight_+3A_pistar_matrix">pistar_matrix</code></td>
<td>
<p>A numeric matrix of conditional probabilities obtained from
the internal function <code>pistar_compute</code>. Rows of the matrix correspond to
each subject and to each observed outcome category. Columns of the matrix
correspond to each true, latent outcome category.</p>
</td></tr>
<tr><td><code id="COMBO_weight_+3A_pi_matrix">pi_matrix</code></td>
<td>
<p>A numeric matrix of probabilities obtained from the internal
function <code>pi_compute</code>. Rows of the matrix correspond to each subject.
Columns of the matrix correspond to each true, latent outcome category.</p>
</td></tr>
<tr><td><code id="COMBO_weight_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in
the sample. This value should be equal to the number of rows of the observed
outcome matrix, <code>ystar_matrix</code>.</p>
</td></tr>
<tr><td><code id="COMBO_weight_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcome, <code>Y*</code>, can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>COMBO_weight</code> returns a matrix of E-step weights for the EM-algorithm,
computed as follows:
<code class="reqn">\sum_{k = 1}^2 \frac{y^*_{ik} \pi^*_{ikj} \pi_{ij}}{\sum_{\ell = 1}^2 \pi^*_{i k \ell} \pi_{i \ell}}</code>.
Rows of the matrix correspond to each subject. Columns of the matrix correspond
to the true outcome categories <code class="reqn">j = 1, \dots,</code> <code>n_cat</code>.
</p>

<hr>
<h2 id='COMMA_boot_sample'>Generate Bootstrap Samples for Estimating Standard Errors</h2><span id='topic+COMMA_boot_sample'></span>

<h3>Description</h3>

<p>Generate Bootstrap Samples for Estimating Standard Errors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMMA_boot_sample(
  parameter_estimates,
  sigma_estimate = 1,
  outcome_distribution,
  interaction_indicator,
  x_matrix,
  z_matrix,
  c_matrix
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="COMMA_boot_sample_+3A_parameter_estimates">parameter_estimates</code></td>
<td>
<p>A column matrix of <code class="reqn">\beta</code>, <code class="reqn">\gamma</code>,
and <code class="reqn">\theta</code> parameter values obtained from a COMMA analysis function.
Parameter estimates should be supplied in the following order: 1) <code class="reqn">\beta</code>
(intercept, slope), 2) <code class="reqn">\gamma</code> (intercept and slope from the M = 1
mechanism, intercept and slope from the M = 2 mechanism), and 3) <code class="reqn">\theta</code>
(intercept, slope, coefficient for <code>x</code>, slope coefficient for <code>m</code>,
slope coefficient for <code>c</code>, and, optionally, slope coefficient for
<code>xm</code> if using).</p>
</td></tr>
<tr><td><code id="COMMA_boot_sample_+3A_sigma_estimate">sigma_estimate</code></td>
<td>
<p>A numeric value specifying the estimated
standard deviation. This value is only required if <code>outcome_distribution</code>
is <code>"Normal"</code>. Default is 1. For non-Normal outcome distributions, the
value should be <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="COMMA_boot_sample_+3A_outcome_distribution">outcome_distribution</code></td>
<td>
<p>A character string specifying the distribution of
the outcome variable. Options are <code>"Bernoulli"</code>, <code>"Normal"</code>, or
<code>"Poisson"</code>.</p>
</td></tr>
<tr><td><code id="COMMA_boot_sample_+3A_interaction_indicator">interaction_indicator</code></td>
<td>
<p>A logical value indicating if an interaction between
<code>x</code> and <code>m</code> should be used to generate the outcome variable, <code>y</code>.</p>
</td></tr>
<tr><td><code id="COMMA_boot_sample_+3A_x_matrix">x_matrix</code></td>
<td>
<p>A numeric matrix of predictors in the true mediator and outcome mechanisms.
<code>x_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_boot_sample_+3A_z_matrix">z_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the observation mechanism.
<code>z_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_boot_sample_+3A_c_matrix">c_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true mediator and outcome mechanisms.
<code>c_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>COMMA_boot_sample</code> returns a list with the bootstrap sample data:
</p>
<table role = "presentation">
<tr><td><code>obs_mediator</code></td>
<td>
<p>A vector of observed mediator values.</p>
</td></tr>
<tr><td><code>true_mediator</code></td>
<td>
<p>A vector of true mediator values.</p>
</td></tr>
<tr><td><code>outcome</code></td>
<td>
<p>A vector of outcome values.</p>
</td></tr>
<tr><td><code>x_matrix</code></td>
<td>
<p>A matrix of predictor values in the true mediator
mechanism. Identical to that supplied by the user.</p>
</td></tr>
<tr><td><code>z_matrix</code></td>
<td>
<p>A matrix of predictor values in the observed mediator
mechanism. Identical to that supplied by the user.</p>
</td></tr>
<tr><td><code>c_matrix</code></td>
<td>
<p>A matrix of covariates. Identical to that supplied by the user.</p>
</td></tr>
</table>

<hr>
<h2 id='COMMA_data'>Generate Data to use in COMMA Functions</h2><span id='topic+COMMA_data'></span>

<h3>Description</h3>

<p>Generate Data to use in COMMA Functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMMA_data(
  sample_size,
  x_mu,
  x_sigma,
  z_shape,
  c_shape,
  interaction_indicator,
  outcome_distribution,
  true_beta,
  true_gamma,
  true_theta
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="COMMA_data_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer specifying the sample size of the generated data set.</p>
</td></tr>
<tr><td><code id="COMMA_data_+3A_x_mu">x_mu</code></td>
<td>
<p>A numeric value specifying the mean of <code>x</code> predictors
generated from a Normal distribution.</p>
</td></tr>
<tr><td><code id="COMMA_data_+3A_x_sigma">x_sigma</code></td>
<td>
<p>A positive numeric value specifying the standard deviation of
<code>x</code> predictors generated from a Normal distribution.</p>
</td></tr>
<tr><td><code id="COMMA_data_+3A_z_shape">z_shape</code></td>
<td>
<p>A positive numeric value specifying the shape parameter of
<code>z</code> predictors generated from a Gamma distribution.</p>
</td></tr>
<tr><td><code id="COMMA_data_+3A_c_shape">c_shape</code></td>
<td>
<p>A positive numeric value specifying the shape parameter of
<code>c</code> covariates generated from a Gamma distribution.</p>
</td></tr>
<tr><td><code id="COMMA_data_+3A_interaction_indicator">interaction_indicator</code></td>
<td>
<p>A logical value indicating if an interaction between
<code>x</code> and <code>m</code> should be used to generate the outcome variable, <code>y</code>.</p>
</td></tr>
<tr><td><code id="COMMA_data_+3A_outcome_distribution">outcome_distribution</code></td>
<td>
<p>A character string specifying the distribution of
the outcome variable. Options are <code>"Bernoulli"</code>, <code>"Normal"</code>, or
<code>"Poisson"</code>.</p>
</td></tr>
<tr><td><code id="COMMA_data_+3A_true_beta">true_beta</code></td>
<td>
<p>A column matrix of <code class="reqn">\beta</code> parameter values (intercept, slope)
to generate data under in the true mediator mechanism.</p>
</td></tr>
<tr><td><code id="COMMA_data_+3A_true_gamma">true_gamma</code></td>
<td>
<p>A numeric matrix of <code class="reqn">\gamma</code> parameters
to generate data in the observed mediator mechanisms.
In matrix form, the <code>gamma</code> matrix rows correspond to intercept (row 1)
and slope (row 2) terms. The gamma parameter matrix columns correspond to the true mediator categories
<code class="reqn">M \in \{1, 2\}</code>.</p>
</td></tr>
<tr><td><code id="COMMA_data_+3A_true_theta">true_theta</code></td>
<td>
<p>A column matrix of <code class="reqn">\theta</code> parameter values (intercept, slope
coefficient for <code>x</code>, slope coefficient for <code>m</code>, slope coefficient for <code>c</code>,
and, optionally, slope coefficient for <code>xm</code> if using) to generate data
in the outcome mechanism.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>COMMA_data</code> returns a list of generated data elements:
</p>
<table role = "presentation">
<tr><td><code>obs_mediator</code></td>
<td>
<p>A vector of observed mediator values.</p>
</td></tr>
<tr><td><code>true_mediator</code></td>
<td>
<p>A vector of true mediator values.</p>
</td></tr>
<tr><td><code>outcome</code></td>
<td>
<p>A vector of outcome values.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>A vector of generated predictor values in the true mediator
mechanism, from the Normal distribution.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>A vector of generated predictor values in the observed mediator
mechanism from the Gamma distribution.</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p>A vector of generated covariates.</p>
</td></tr>
<tr><td><code>x_design_matrix</code></td>
<td>
<p>The design matrix for the <code>x</code> predictor.</p>
</td></tr>
<tr><td><code>z_design_matrix</code></td>
<td>
<p>The design matrix for the <code>z</code> predictor.</p>
</td></tr>
<tr><td><code>c_design_matrix</code></td>
<td>
<p>The design matrix for the <code>c</code> predictor.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20240709)
sample_size &lt;- 10000

n_cat &lt;- 2 # Number of categories in the binary mediator

# Data generation settings
x_mu &lt;- 0
x_sigma &lt;- 1
z_shape &lt;- 1
c_shape &lt;- 1

# True parameter values (gamma terms set the misclassification rate)
true_beta &lt;- matrix(c(1, -2, .5), ncol = 1)
true_gamma &lt;- matrix(c(1, 1, -.5, -1.5), nrow = 2, byrow = FALSE)
true_theta &lt;- matrix(c(1, 1.5, -2, -.2), ncol = 1)

example_data &lt;- COMMA_data(sample_size, x_mu, x_sigma, z_shape, c_shape,
                           interaction_indicator = FALSE,
                           outcome_distribution = "Bernoulli",
                           true_beta, true_gamma, true_theta)

head(example_data$obs_mediator)
head(example_data$true_mediator) 

</code></pre>

<hr>
<h2 id='COMMA_EM'>EM Algorithm Estimation of the Binary Mediator Misclassification Model</h2><span id='topic+COMMA_EM'></span>

<h3>Description</h3>

<p>Jointly estimate <code class="reqn">\beta</code>, <code class="reqn">\gamma</code>, and <code class="reqn">\theta</code> parameters from
the true mediator, observed mediator, and outcome mechanisms, respectively,
in a binary mediator misclassification model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMMA_EM(
  Mstar,
  outcome,
  outcome_distribution,
  interaction_indicator,
  x_matrix,
  z_matrix,
  c_matrix,
  beta_start,
  gamma_start,
  theta_start,
  sigma_start = NULL,
  tolerance = 1e-07,
  max_em_iterations = 1500,
  em_method = "squarem"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="COMMA_EM_+3A_mstar">Mstar</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the observed
mediator <code>M*</code>. There should be no <code>NA</code> terms. The reference category is 2.</p>
</td></tr>
<tr><td><code id="COMMA_EM_+3A_outcome">outcome</code></td>
<td>
<p>A vector containing the outcome variables of interest. There
should be no <code>NA</code> terms.</p>
</td></tr>
<tr><td><code id="COMMA_EM_+3A_outcome_distribution">outcome_distribution</code></td>
<td>
<p>A character string specifying the distribution of
the outcome variable. Options are <code>"Bernoulli"</code>, <code>"Normal"</code>, or
<code>"Poisson"</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_+3A_interaction_indicator">interaction_indicator</code></td>
<td>
<p>A logical value indicating if an interaction between
<code>x</code> and <code>m</code> should be used to generate the outcome variable, <code>y</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_+3A_x_matrix">x_matrix</code></td>
<td>
<p>A numeric matrix of predictors in the true mediator and outcome mechanisms.
<code>x_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_+3A_z_matrix">z_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the observation mechanism.
<code>z_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_+3A_c_matrix">c_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true mediator and outcome mechanisms.
<code>c_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_+3A_beta_start">beta_start</code></td>
<td>
<p>A numeric vector or column matrix of starting values for the <code class="reqn">\beta</code>
parameters in the true mediator mechanism. The number of elements in <code>beta_start</code>
should be equal to the number of columns of <code>x_matrix</code> and <code>c_matrix</code> plus 1.
Starting values should be provided in the following order: intercept, slope
coefficient for the <code>x_matrix</code> term, slope coefficient for first column
of the <code>c_matrix</code>, ..., slope coefficient for the final column of the <code>c_matrix</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_+3A_gamma_start">gamma_start</code></td>
<td>
<p>A numeric vector or matrix of starting values for the <code class="reqn">\gamma</code>
parameters in the observation mechanism. In matrix form, the <code>gamma_start</code> matrix rows
correspond to parameters for the <code>M* = 1</code>
observed mediator, with the dimensions of <code>z_matrix</code> plus 1, and the
gamma parameter matrix columns correspond to the true mediator categories
<code class="reqn">M \in \{1, 2\}</code>. A numeric vector for <code>gamma_start</code> is
obtained by concatenating the gamma matrix, i.e. <code>gamma_start &lt;- c(gamma_matrix)</code>.
Starting values should be provided in the following order within each column:
intercept, slope coefficient for first column of the <code>z_matrix</code>, ...,
slope coefficient for the final column of the <code>z_matrix</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_+3A_theta_start">theta_start</code></td>
<td>
<p>A numeric vector or column matrix of starting values for the <code class="reqn">\theta</code>
parameters in the outcome mechanism. The number of elements in <code>theta_start</code>
should be equal to the number of columns of <code>x_matrix</code> and <code>c_matrix</code> plus 2
(if <code>interaction_indicator</code> is <code>FALSE</code>) or 3 (if
<code>interaction_indicator</code> is <code>TRUE</code>). Starting values should be
provided in the following order: intercept, slope coefficient for the <code>x_matrix</code> term,
slope coefficient for the mediator <code>m</code> term,
slope coefficient for first column of the <code>c_matrix</code>, ...,
slope coefficient for the final column of the <code>c_matrix</code>,
and, optionally, slope coefficient for <code>xm</code>).</p>
</td></tr>
<tr><td><code id="COMMA_EM_+3A_sigma_start">sigma_start</code></td>
<td>
<p>A numeric value specifying the starting value for the
standard deviation. This value is only required if <code>outcome_distribution</code>
is <code>"Normal"</code>. Otherwise, this value is set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_+3A_tolerance">tolerance</code></td>
<td>
<p>A numeric value specifying when to stop estimation, based on
the difference of subsequent log-likelihood estimates. The default is <code>1e-7</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_+3A_max_em_iterations">max_em_iterations</code></td>
<td>
<p>A numeric value specifying when to stop estimation, based on
the difference of subsequent log-likelihood estimates. The default is <code>1e-7</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_+3A_em_method">em_method</code></td>
<td>
<p>A character string specifying which EM algorithm will be applied.
Options are <code>"em"</code>, <code>"squarem"</code>, or <code>"pem"</code>. The default and
recommended option is <code>"squarem"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>COMMA_EM</code> returns a data frame containing four columns. The first
column, <code>Parameter</code>, represents a unique parameter value for each row.
The next column contains the parameter <code>Estimates</code>, followed by the standard
error estimates, <code>SE</code>. The final column, <code>Convergence</code>, reports
whether or not the algorithm converged for a given parameter estimate.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20240709)
sample_size &lt;- 2000

n_cat &lt;- 2 # Number of categories in the binary mediator

# Data generation settings
x_mu &lt;- 0
x_sigma &lt;- 1
z_shape &lt;- 1
c_shape &lt;- 1

# True parameter values (gamma terms set the misclassification rate)
true_beta &lt;- matrix(c(1, -2, .5), ncol = 1)
true_gamma &lt;- matrix(c(1, 1, -.5, -1.5), nrow = 2, byrow = FALSE)
true_theta &lt;- matrix(c(1, 1.5, -2, -.2), ncol = 1)

example_data &lt;- COMMA_data(sample_size, x_mu, x_sigma, z_shape, c_shape,
                           interaction_indicator = FALSE,
                           outcome_distribution = "Bernoulli",
                           true_beta, true_gamma, true_theta)
                           
beta_start &lt;- matrix(rep(1, 3), ncol = 1)
gamma_start &lt;- matrix(rep(1, 4), nrow = 2, ncol = 2)
theta_start &lt;- matrix(rep(1, 4), ncol = 1)

Mstar = example_data[["obs_mediator"]]
outcome = example_data[["outcome"]]
x_matrix = example_data[["x"]]
z_matrix = example_data[["z"]]
c_matrix = example_data[["c"]]
                           
EM_results &lt;- COMMA_EM(Mstar, outcome, "Bernoulli", FALSE,
                       x_matrix, z_matrix, c_matrix,
                       beta_start, gamma_start, theta_start)

EM_results

</code></pre>

<hr>
<h2 id='COMMA_EM_bootstrap_SE'>Estimate Bootstrap Standard Errors using EM</h2><span id='topic+COMMA_EM_bootstrap_SE'></span>

<h3>Description</h3>

<p>Estimate Bootstrap Standard Errors using EM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMMA_EM_bootstrap_SE(
  parameter_estimates,
  sigma_estimate = 1,
  n_bootstrap,
  n_parallel,
  outcome_distribution,
  interaction_indicator,
  x_matrix,
  z_matrix,
  c_matrix,
  tolerance = 1e-07,
  max_em_iterations = 1500,
  em_method = "squarem",
  random_seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="COMMA_EM_bootstrap_SE_+3A_parameter_estimates">parameter_estimates</code></td>
<td>
<p>A column matrix of <code class="reqn">\beta</code>, <code class="reqn">\gamma</code>,
and <code class="reqn">\theta</code> parameter values obtained from a COMMA analysis function.
Parameter estimates should be supplied in the following order: 1) <code class="reqn">\beta</code>
(intercept, slope), 2) <code class="reqn">\gamma</code> (intercept and slope from the M = 1
mechanism, intercept and slope from the M = 2 mechanism), and 3) <code class="reqn">\theta</code>
(intercept, slope, coefficient for <code>x</code>, slope coefficient for <code>m</code>,
slope coefficient for <code>c</code>, and, optionally, slope coefficient for
<code>xm</code> if using).</p>
</td></tr>
<tr><td><code id="COMMA_EM_bootstrap_SE_+3A_sigma_estimate">sigma_estimate</code></td>
<td>
<p>A numeric value specifying the estimated
standard deviation. This value is only required if <code>outcome_distribution</code>
is <code>"Normal"</code>. Default is 1. For non-Normal outcome distributions, the
value should be <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_bootstrap_SE_+3A_n_bootstrap">n_bootstrap</code></td>
<td>
<p>A numeric value specifying the number of bootstrap samples
to draw.</p>
</td></tr>
<tr><td><code id="COMMA_EM_bootstrap_SE_+3A_n_parallel">n_parallel</code></td>
<td>
<p>A numeric value specifying the number of parallel cores to
run the computation on.</p>
</td></tr>
<tr><td><code id="COMMA_EM_bootstrap_SE_+3A_outcome_distribution">outcome_distribution</code></td>
<td>
<p>A character string specifying the distribution of
the outcome variable. Options are <code>"Bernoulli"</code>, <code>"Normal"</code>, or
<code>"Poisson"</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_bootstrap_SE_+3A_interaction_indicator">interaction_indicator</code></td>
<td>
<p>A logical value indicating if an interaction between
<code>x</code> and <code>m</code> should be used to generate the outcome variable, <code>y</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_bootstrap_SE_+3A_x_matrix">x_matrix</code></td>
<td>
<p>A numeric matrix of predictors in the true mediator and outcome mechanisms.
<code>x_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_bootstrap_SE_+3A_z_matrix">z_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the observation mechanism.
<code>z_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_bootstrap_SE_+3A_c_matrix">c_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true mediator and outcome mechanisms.
<code>c_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_bootstrap_SE_+3A_tolerance">tolerance</code></td>
<td>
<p>A numeric value specifying when to stop estimation, based on
the difference of subsequent log-likelihood estimates. The default is <code>1e-7</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_bootstrap_SE_+3A_max_em_iterations">max_em_iterations</code></td>
<td>
<p>A numeric value specifying when to stop estimation, based on
the difference of subsequent log-likelihood estimates. The default is <code>1e-7</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_bootstrap_SE_+3A_em_method">em_method</code></td>
<td>
<p>A character string specifying which EM algorithm will be applied.
Options are <code>"em"</code>, <code>"squarem"</code>, or <code>"pem"</code>. The default and
recommended option is <code>"squarem"</code>.</p>
</td></tr>
<tr><td><code id="COMMA_EM_bootstrap_SE_+3A_random_seed">random_seed</code></td>
<td>
<p>A numeric value specifying the random seed to set for bootstrap
sampling. Default is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>COMMA_EM_bootstrap_SE</code> returns a list with two elements: 1)
<code>bootstrap_df</code> and 2) <code>bootstrap_SE</code>. <code>bootstrap_df</code> is a data
frame containing <code>COMMA_EM</code> output for each bootstrap sample. <code>bootstrap_SE</code>
is a data frame containing bootstrap standard error estimates for each parameter.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(20240709)
sample_size &lt;- 2000

n_cat &lt;- 2 # Number of categories in the binary mediator

# Data generation settings
x_mu &lt;- 0
x_sigma &lt;- 1
z_shape &lt;- 1
c_shape &lt;- 1

# True parameter values (gamma terms set the misclassification rate)
true_beta &lt;- matrix(c(1, -2, .5), ncol = 1)
true_gamma &lt;- matrix(c(1, 1, -.5, -1.5), nrow = 2, byrow = FALSE)
true_theta &lt;- matrix(c(1, 1.5, -2, -.2), ncol = 1)

example_data &lt;- COMMA_data(sample_size, x_mu, x_sigma, z_shape, c_shape,
                           interaction_indicator = FALSE,
                           outcome_distribution = "Bernoulli",
                           true_beta, true_gamma, true_theta)
                           
beta_start &lt;- matrix(rep(1, 3), ncol = 1)
gamma_start &lt;- matrix(rep(1, 4), nrow = 2, ncol = 2)
theta_start &lt;- matrix(rep(1, 4), ncol = 1)

Mstar = example_data[["obs_mediator"]]
outcome = example_data[["outcome"]]
x_matrix = example_data[["x"]]
z_matrix = example_data[["z"]]
c_matrix = example_data[["c"]]
                           
EM_results &lt;- COMMA_EM(Mstar, outcome, "Bernoulli", FALSE,
                       x_matrix, z_matrix, c_matrix,
                       beta_start, gamma_start, theta_start)

EM_results

EM_SEs &lt;- COMMA_EM_bootstrap_SE(EM_results$Estimates, sigma_estimate = NULL,
                                n_bootstrap = 3,
                                n_parallel = 1,
                                outcome_distribution = "Bernoulli",
                                interaction_indicator = FALSE,
                                x_matrix, z_matrix, c_matrix,
                                random_seed = 1)                
EM_SEs$bootstrap_SE

</code></pre>

<hr>
<h2 id='COMMA_OLS'>Ordinary Least Squares Estimation of the Binary Mediator Misclassification Model</h2><span id='topic+COMMA_OLS'></span>

<h3>Description</h3>

<p>Estimate <code class="reqn">\beta</code>, <code class="reqn">\gamma</code>, and <code class="reqn">\theta</code> parameters from
the true mediator, observed mediator, and outcome mechanisms, respectively,
in a binary mediator misclassification model using an ordinary least squares
correction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMMA_OLS(
  Mstar,
  outcome,
  x_matrix,
  z_matrix,
  c_matrix,
  beta_start,
  gamma_start,
  theta_start,
  tolerance = 1e-07,
  max_em_iterations = 1500,
  em_method = "squarem"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="COMMA_OLS_+3A_mstar">Mstar</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the observed
mediator <code>M*</code>. There should be no <code>NA</code> terms. The reference category is 2.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_+3A_outcome">outcome</code></td>
<td>
<p>A vector containing the outcome variables of interest. There
should be no <code>NA</code> terms.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_+3A_x_matrix">x_matrix</code></td>
<td>
<p>A numeric matrix of predictors in the true mediator and outcome mechanisms.
<code>x_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_+3A_z_matrix">z_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the observation mechanism.
<code>z_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_+3A_c_matrix">c_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true mediator and outcome mechanisms.
<code>c_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_+3A_beta_start">beta_start</code></td>
<td>
<p>A numeric vector or column matrix of starting values for the <code class="reqn">\beta</code>
parameters in the true mediator mechanism. The number of elements in <code>beta_start</code>
should be equal to the number of columns of <code>x_matrix</code> and <code>c_matrix</code> plus 1.
Starting values should be provided in the following order: intercept, slope
coefficient for the <code>x_matrix</code> term, slope coefficient for first column
of the <code>c_matrix</code>, ..., slope coefficient for the final column of the <code>c_matrix</code>.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_+3A_gamma_start">gamma_start</code></td>
<td>
<p>A numeric vector or matrix of starting values for the <code class="reqn">\gamma</code>
parameters in the observation mechanism. In matrix form, the <code>gamma_start</code> matrix rows
correspond to parameters for the <code>M* = 1</code>
observed mediator, with the dimensions of <code>z_matrix</code> plus 1, and the
gamma parameter matrix columns correspond to the true mediator categories
<code class="reqn">M \in \{1, 2\}</code>. A numeric vector for <code>gamma_start</code> is
obtained by concatenating the gamma matrix, i.e. <code>gamma_start &lt;- c(gamma_matrix)</code>.
Starting values should be provided in the following order within each column:
intercept, slope coefficient for first column of the <code>z_matrix</code>, ...,
slope coefficient for the final column of the <code>z_matrix</code>.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_+3A_theta_start">theta_start</code></td>
<td>
<p>A numeric vector or column matrix of starting values for the <code class="reqn">\theta</code>
parameters in the outcome mechanism. The number of elements in <code>theta_start</code>
should be equal to the number of columns of <code>x_matrix</code> and <code>c_matrix</code>
plus 2. Starting values should be provided in the following order: intercept,
slope coefficient for the <code>x_matrix</code> term, slope coefficient for the
mediator <code>m</code> term, slope coefficient for first column of the <code>c_matrix</code>, ...,
slope coefficient for the final column of the <code>c_matrix</code>.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_+3A_tolerance">tolerance</code></td>
<td>
<p>A numeric value specifying when to stop estimation, based on
the difference of subsequent log-likelihood estimates. The default is <code>1e-7</code>.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_+3A_max_em_iterations">max_em_iterations</code></td>
<td>
<p>A numeric value specifying when to stop estimation, based on
the difference of subsequent log-likelihood estimates. The default is <code>1e-7</code>.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_+3A_em_method">em_method</code></td>
<td>
<p>A character string specifying which EM algorithm will be applied.
Options are <code>"em"</code>, <code>"squarem"</code>, or <code>"pem"</code>. The default and
recommended option is <code>"squarem"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that this method can only be used for Normal outcome models, and interaction
terms (between <code>x</code> and <code>m</code>) are not supported.
</p>


<h3>Value</h3>

<p><code>COMMA_PVW</code> returns a data frame containing four columns. The first
column, <code>Parameter</code>, represents a unique parameter value for each row.
The next column contains the parameter <code>Estimates</code>. The third column,
<code>Convergence</code>, reports whether or not the algorithm converged for a
given parameter estimate. The final column, <code>Method</code>, reports
that the estimates are obtained from the &quot;PVW&quot; procedure.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20240709)
sample_size &lt;- 2000

n_cat &lt;- 2 # Number of categories in the binary mediator

# Data generation settings
x_mu &lt;- 0
x_sigma &lt;- 1
z_shape &lt;- 1
c_shape &lt;- 1

# True parameter values (gamma terms set the misclassification rate)
true_beta &lt;- matrix(c(1, -2, .5), ncol = 1)
true_gamma &lt;- matrix(c(1, 1, -.5, -1.5), nrow = 2, byrow = FALSE)
true_theta &lt;- matrix(c(1, 1.5, -2, 2), ncol = 1)

example_data &lt;- COMMA_data(sample_size, x_mu, x_sigma, z_shape, c_shape,
                           interaction_indicator = FALSE,
                           outcome_distribution = "Normal",
                           true_beta, true_gamma, true_theta)
                           
beta_start &lt;- matrix(rep(1, 3), ncol = 1)
gamma_start &lt;- matrix(rep(1, 4), nrow = 2, ncol = 2)
theta_start &lt;- matrix(rep(1, 4), ncol = 1)

Mstar = example_data[["obs_mediator"]]
outcome = example_data[["outcome"]]
x_matrix = example_data[["x"]]
z_matrix = example_data[["z"]]
c_matrix = example_data[["c"]]
                           
OLS_results &lt;- COMMA_OLS(Mstar, outcome,
                         x_matrix, z_matrix, c_matrix,
                         beta_start, gamma_start, theta_start)
                         
OLS_results


</code></pre>

<hr>
<h2 id='COMMA_OLS_bootstrap_SE'>Estimate Bootstrap Standard Errors using OLS</h2><span id='topic+COMMA_OLS_bootstrap_SE'></span>

<h3>Description</h3>

<p>Estimate Bootstrap Standard Errors using OLS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMMA_OLS_bootstrap_SE(
  parameter_estimates,
  sigma_estimate = 1,
  n_bootstrap,
  n_parallel,
  x_matrix,
  z_matrix,
  c_matrix,
  tolerance = 1e-07,
  max_em_iterations = 1500,
  em_method = "squarem",
  random_seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="COMMA_OLS_bootstrap_SE_+3A_parameter_estimates">parameter_estimates</code></td>
<td>
<p>A column matrix of <code class="reqn">\beta</code>, <code class="reqn">\gamma</code>,
and <code class="reqn">\theta</code> parameter values obtained from a COMMA analysis function.
Parameter estimates should be supplied in the following order: 1) <code class="reqn">\beta</code>
(intercept, slope), 2) <code class="reqn">\gamma</code> (intercept and slope from the M = 1
mechanism, intercept and slope from the M = 2 mechanism), and 3) <code class="reqn">\theta</code>
(intercept, slope, coefficient for <code>x</code>, slope coefficient for <code>m</code>,
slope coefficient for <code>c</code>, and, optionally, slope coefficient for
<code>xm</code> if using).</p>
</td></tr>
<tr><td><code id="COMMA_OLS_bootstrap_SE_+3A_sigma_estimate">sigma_estimate</code></td>
<td>
<p>A numeric value specifying the estimated
standard deviation. Default is 1.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_bootstrap_SE_+3A_n_bootstrap">n_bootstrap</code></td>
<td>
<p>A numeric value specifying the number of bootstrap samples
to draw.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_bootstrap_SE_+3A_n_parallel">n_parallel</code></td>
<td>
<p>A numeric value specifying the number of parallel cores to
run the computation on.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_bootstrap_SE_+3A_x_matrix">x_matrix</code></td>
<td>
<p>A numeric matrix of predictors in the true mediator and outcome mechanisms.
<code>x_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_bootstrap_SE_+3A_z_matrix">z_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the observation mechanism.
<code>z_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_bootstrap_SE_+3A_c_matrix">c_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true mediator and outcome mechanisms.
<code>c_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_bootstrap_SE_+3A_tolerance">tolerance</code></td>
<td>
<p>A numeric value specifying when to stop estimation, based on
the difference of subsequent log-likelihood estimates. The default is <code>1e-7</code>.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_bootstrap_SE_+3A_max_em_iterations">max_em_iterations</code></td>
<td>
<p>A numeric value specifying when to stop estimation, based on
the difference of subsequent log-likelihood estimates. The default is <code>1e-7</code>.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_bootstrap_SE_+3A_em_method">em_method</code></td>
<td>
<p>A character string specifying which EM algorithm will be applied.
Options are <code>"em"</code>, <code>"squarem"</code>, or <code>"pem"</code>. The default and
recommended option is <code>"squarem"</code>.</p>
</td></tr>
<tr><td><code id="COMMA_OLS_bootstrap_SE_+3A_random_seed">random_seed</code></td>
<td>
<p>A numeric value specifying the random seed to set for bootstrap
sampling. Default is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>COMMA_OLS_bootstrap_SE</code> returns a list with two elements: 1)
<code>bootstrap_df</code> and 2) <code>bootstrap_SE</code>. <code>bootstrap_df</code> is a data
frame containing <code>COMMA_OLS</code> output for each bootstrap sample. <code>bootstrap_SE</code>
is a data frame containing bootstrap standard error estimates for each parameter.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(20240709)
sample_size &lt;- 2000

n_cat &lt;- 2 # Number of categories in the binary mediator

# Data generation settings
x_mu &lt;- 0
x_sigma &lt;- 1
z_shape &lt;- 1
c_shape &lt;- 1

# True parameter values (gamma terms set the misclassification rate)
true_beta &lt;- matrix(c(1, -2, .5), ncol = 1)
true_gamma &lt;- matrix(c(1, 1, -.5, -1.5), nrow = 2, byrow = FALSE)
true_theta &lt;- matrix(c(1, 1.5, -2, 2), ncol = 1)

example_data &lt;- COMMA_data(sample_size, x_mu, x_sigma, z_shape, c_shape,
                           interaction_indicator = FALSE,
                           outcome_distribution = "Normal",
                           true_beta, true_gamma, true_theta)
                           
beta_start &lt;- matrix(rep(1, 3), ncol = 1)
gamma_start &lt;- matrix(rep(1, 4), nrow = 2, ncol = 2)
theta_start &lt;- matrix(rep(1, 4), ncol = 1)

Mstar = example_data[["obs_mediator"]]
outcome = example_data[["outcome"]]
x_matrix = example_data[["x"]]
z_matrix = example_data[["z"]]
c_matrix = example_data[["c"]]
                           
OLS_results &lt;- COMMA_OLS(Mstar, outcome,
                         x_matrix, z_matrix, c_matrix,
                         beta_start, gamma_start, theta_start)
                         
OLS_results

OLS_SEs &lt;- COMMA_OLS_bootstrap_SE(OLS_results$Estimates, sigma_estimate = 1,
                                  n_bootstrap = 3,
                                  n_parallel = 1,
                                  x_matrix, z_matrix, c_matrix,
                                  random_seed = 1)
                                  
OLS_SEs$bootstrap_SE

</code></pre>

<hr>
<h2 id='COMMA_PVW'>Predictive Value Weighting Estimation of the Binary Mediator Misclassification Model</h2><span id='topic+COMMA_PVW'></span>

<h3>Description</h3>

<p>Estimate <code class="reqn">\beta</code>, <code class="reqn">\gamma</code>, and <code class="reqn">\theta</code> parameters from
the true mediator, observed mediator, and outcome mechanisms, respectively,
in a binary mediator misclassification model using a predictive value weighting
approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMMA_PVW(
  Mstar,
  outcome,
  outcome_distribution,
  interaction_indicator,
  x_matrix,
  z_matrix,
  c_matrix,
  beta_start,
  gamma_start,
  theta_start,
  tolerance = 1e-07,
  max_em_iterations = 1500,
  em_method = "squarem"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="COMMA_PVW_+3A_mstar">Mstar</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the observed
mediator <code>M*</code>. There should be no <code>NA</code> terms. The reference category is 2.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_+3A_outcome">outcome</code></td>
<td>
<p>A vector containing the outcome variables of interest. There
should be no <code>NA</code> terms.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_+3A_outcome_distribution">outcome_distribution</code></td>
<td>
<p>A character string specifying the distribution of
the outcome variable. Options are <code>"Bernoulli"</code>,
<code>"Poisson"</code>, or <code>"Normal"</code>.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_+3A_interaction_indicator">interaction_indicator</code></td>
<td>
<p>A logical value indicating if an interaction between
<code>x</code> and <code>m</code> should be used to generate the outcome variable, <code>y</code>.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_+3A_x_matrix">x_matrix</code></td>
<td>
<p>A numeric matrix of predictors in the true mediator and outcome mechanisms.
<code>x_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_+3A_z_matrix">z_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the observation mechanism.
<code>z_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_+3A_c_matrix">c_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true mediator and outcome mechanisms.
<code>c_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_+3A_beta_start">beta_start</code></td>
<td>
<p>A numeric vector or column matrix of starting values for the <code class="reqn">\beta</code>
parameters in the true mediator mechanism. The number of elements in <code>beta_start</code>
should be equal to the number of columns of <code>x_matrix</code> and <code>c_matrix</code> plus 1.
Starting values should be provided in the following order: intercept, slope
coefficient for the <code>x_matrix</code> term, slope coefficient for first column
of the <code>c_matrix</code>, ..., slope coefficient for the final column of the <code>c_matrix</code>.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_+3A_gamma_start">gamma_start</code></td>
<td>
<p>A numeric vector or matrix of starting values for the <code class="reqn">\gamma</code>
parameters in the observation mechanism. In matrix form, the <code>gamma_start</code> matrix rows
correspond to parameters for the <code>M* = 1</code>
observed mediator, with the dimensions of <code>z_matrix</code> plus 1, and the
gamma parameter matrix columns correspond to the true mediator categories
<code class="reqn">M \in \{1, 2\}</code>. A numeric vector for <code>gamma_start</code> is
obtained by concatenating the gamma matrix, i.e. <code>gamma_start &lt;- c(gamma_matrix)</code>.
Starting values should be provided in the following order within each column:
intercept, slope coefficient for first column of the <code>z_matrix</code>, ...,
slope coefficient for the final column of the <code>z_matrix</code>.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_+3A_theta_start">theta_start</code></td>
<td>
<p>A numeric vector or column matrix of starting values for the <code class="reqn">\theta</code>
parameters in the outcome mechanism. The number of elements in <code>theta_start</code>
should be equal to the number of columns of <code>x_matrix</code> and <code>c_matrix</code> plus 2
(if <code>interaction_indicator</code> is <code>FALSE</code>) or 3 (if
<code>interaction_indicator</code> is <code>TRUE</code>). Starting values should be
provided in the following order: intercept, slope coefficient for the <code>x_matrix</code> term,
slope coefficient for the mediator <code>m</code> term,
slope coefficient for first column of the <code>c_matrix</code>, ...,
slope coefficient for the final column of the <code>c_matrix</code>,
and, optionally, slope coefficient for <code>xm</code>).</p>
</td></tr>
<tr><td><code id="COMMA_PVW_+3A_tolerance">tolerance</code></td>
<td>
<p>A numeric value specifying when to stop estimation, based on
the difference of subsequent log-likelihood estimates. The default is <code>1e-7</code>.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_+3A_max_em_iterations">max_em_iterations</code></td>
<td>
<p>A numeric value specifying when to stop estimation, based on
the difference of subsequent log-likelihood estimates. The default is <code>1e-7</code>.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_+3A_em_method">em_method</code></td>
<td>
<p>A character string specifying which EM algorithm will be applied.
Options are <code>"em"</code>, <code>"squarem"</code>, or <code>"pem"</code>. The default and
recommended option is <code>"squarem"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that this method can only be used for binary outcome models.
</p>


<h3>Value</h3>

<p><code>COMMA_PVW</code> returns a data frame containing four columns. The first
column, <code>Parameter</code>, represents a unique parameter value for each row.
The next column contains the parameter <code>Estimates</code>. The third column,
<code>Convergence</code>, reports whether or not the algorithm converged for a
given parameter estimate. The final column, <code>Method</code>, reports
that the estimates are obtained from the &quot;PVW&quot; procedure.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20240709)
sample_size &lt;- 2000

n_cat &lt;- 2 # Number of categories in the binary mediator

# Data generation settings
x_mu &lt;- 0
x_sigma &lt;- 1
z_shape &lt;- 1
c_shape &lt;- 1

# True parameter values (gamma terms set the misclassification rate)
true_beta &lt;- matrix(c(1, -2, .5), ncol = 1)
true_gamma &lt;- matrix(c(1, 1, -.5, -1.5), nrow = 2, byrow = FALSE)
true_theta &lt;- matrix(c(1, 1.5, -2, -.2), ncol = 1)

example_data &lt;- COMMA_data(sample_size, x_mu, x_sigma, z_shape, c_shape,
                           interaction_indicator = FALSE,
                           outcome_distribution = "Bernoulli",
                           true_beta, true_gamma, true_theta)
                           
beta_start &lt;- matrix(rep(1, 3), ncol = 1)
gamma_start &lt;- matrix(rep(1, 4), nrow = 2, ncol = 2)
theta_start &lt;- matrix(rep(1, 4), ncol = 1)

Mstar = example_data[["obs_mediator"]]
outcome = example_data[["outcome"]]
x_matrix = example_data[["x"]]
z_matrix = example_data[["z"]]
c_matrix = example_data[["c"]]
                           
PVW_results &lt;- COMMA_PVW(Mstar, outcome, outcome_distribution = "Bernoulli",
                         interaction_indicator = FALSE,
                         x_matrix, z_matrix, c_matrix,
                         beta_start, gamma_start, theta_start)

PVW_results

</code></pre>

<hr>
<h2 id='COMMA_PVW_bootstrap_SE'>Estimate Bootstrap Standard Errors using PVW</h2><span id='topic+COMMA_PVW_bootstrap_SE'></span>

<h3>Description</h3>

<p>Estimate Bootstrap Standard Errors using PVW
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMMA_PVW_bootstrap_SE(
  parameter_estimates,
  sigma_estimate,
  n_bootstrap,
  n_parallel,
  outcome_distribution,
  interaction_indicator,
  x_matrix,
  z_matrix,
  c_matrix,
  tolerance = 1e-07,
  max_em_iterations = 1500,
  em_method = "squarem",
  random_seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="COMMA_PVW_bootstrap_SE_+3A_parameter_estimates">parameter_estimates</code></td>
<td>
<p>A column matrix of <code class="reqn">\beta</code>, <code class="reqn">\gamma</code>,
and <code class="reqn">\theta</code> parameter values obtained from a COMMA analysis function.
Parameter estimates should be supplied in the following order: 1) <code class="reqn">\beta</code>
(intercept, slope), 2) <code class="reqn">\gamma</code> (intercept and slope from the M = 1
mechanism, intercept and slope from the M = 2 mechanism), and 3) <code class="reqn">\theta</code>
(intercept, slope, coefficient for <code>x</code>, slope coefficient for <code>m</code>,
slope coefficient for <code>c</code>, and, optionally, slope coefficient for
<code>xm</code> if using).</p>
</td></tr>
<tr><td><code id="COMMA_PVW_bootstrap_SE_+3A_sigma_estimate">sigma_estimate</code></td>
<td>
<p>A numeric value specifying the estimated
standard deviation. This value is only required if <code>outcome_distribution</code>
is <code>"Normal"</code>. Default is 1. For non-Normal outcome distributions, the
value should be <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_bootstrap_SE_+3A_n_bootstrap">n_bootstrap</code></td>
<td>
<p>A numeric value specifying the number of bootstrap samples
to draw.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_bootstrap_SE_+3A_n_parallel">n_parallel</code></td>
<td>
<p>A numeric value specifying the number of parallel cores to
run the computation on.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_bootstrap_SE_+3A_outcome_distribution">outcome_distribution</code></td>
<td>
<p>A character string specifying the distribution of
the outcome variable. Options are <code>"Bernoulli"</code>, <code>"Normal"</code>, or
<code>"Poisson"</code>.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_bootstrap_SE_+3A_interaction_indicator">interaction_indicator</code></td>
<td>
<p>A logical value indicating if an interaction between
<code>x</code> and <code>m</code> should be used to generate the outcome variable, <code>y</code>.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_bootstrap_SE_+3A_x_matrix">x_matrix</code></td>
<td>
<p>A numeric matrix of predictors in the true mediator and outcome mechanisms.
<code>x_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_bootstrap_SE_+3A_z_matrix">z_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the observation mechanism.
<code>z_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_bootstrap_SE_+3A_c_matrix">c_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true mediator and outcome mechanisms.
<code>c_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_bootstrap_SE_+3A_tolerance">tolerance</code></td>
<td>
<p>A numeric value specifying when to stop estimation, based on
the difference of subsequent log-likelihood estimates. The default is <code>1e-7</code>.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_bootstrap_SE_+3A_max_em_iterations">max_em_iterations</code></td>
<td>
<p>A numeric value specifying when to stop estimation, based on
the difference of subsequent log-likelihood estimates. The default is <code>1e-7</code>.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_bootstrap_SE_+3A_em_method">em_method</code></td>
<td>
<p>A character string specifying which EM algorithm will be applied.
Options are <code>"em"</code>, <code>"squarem"</code>, or <code>"pem"</code>. The default and
recommended option is <code>"squarem"</code>.</p>
</td></tr>
<tr><td><code id="COMMA_PVW_bootstrap_SE_+3A_random_seed">random_seed</code></td>
<td>
<p>A numeric value specifying the random seed to set for bootstrap
sampling. Default is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>COMMA_PVW_bootstrap_SE</code> returns a list with two elements: 1)
<code>bootstrap_df</code> and 2) <code>bootstrap_SE</code>. <code>bootstrap_df</code> is a data
frame containing <code>COMMA_PVW</code> output for each bootstrap sample. <code>bootstrap_SE</code>
is a data frame containing bootstrap standard error estimates for each parameter.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(20240709)
sample_size &lt;- 2000

n_cat &lt;- 2 # Number of categories in the binary mediator

# Data generation settings
x_mu &lt;- 0
x_sigma &lt;- 1
z_shape &lt;- 1
c_shape &lt;- 1

# True parameter values (gamma terms set the misclassification rate)
true_beta &lt;- matrix(c(1, -2, .5), ncol = 1)
true_gamma &lt;- matrix(c(1, 1, -.5, -1.5), nrow = 2, byrow = FALSE)
true_theta &lt;- matrix(c(1, 1.5, -2, -.2), ncol = 1)

example_data &lt;- COMMA_data(sample_size, x_mu, x_sigma, z_shape, c_shape,
                           interaction_indicator = FALSE,
                           outcome_distribution = "Bernoulli",
                           true_beta, true_gamma, true_theta)
                           
beta_start &lt;- matrix(rep(1, 3), ncol = 1)
gamma_start &lt;- matrix(rep(1, 4), nrow = 2, ncol = 2)
theta_start &lt;- matrix(rep(1, 4), ncol = 1)

Mstar = example_data[["obs_mediator"]]
outcome = example_data[["outcome"]]
x_matrix = example_data[["x"]]
z_matrix = example_data[["z"]]
c_matrix = example_data[["c"]]
                           
PVW_results &lt;- COMMA_PVW(Mstar, outcome, outcome_distribution = "Bernoulli",
                         interaction_indicator = FALSE,
                         x_matrix, z_matrix, c_matrix,
                         beta_start, gamma_start, theta_start)

PVW_results

PVW_SEs &lt;- COMMA_PVW_bootstrap_SE(PVW_results$Estimates, 
                                  sigma_estimate = NULL,
                                  n_bootstrap = 3,
                                  n_parallel = 1,
                                  outcome_distribution = "Bernoulli",
                                  interaction_indicator = FALSE,
                                  x_matrix, z_matrix, c_matrix,
                                  random_seed = 1)
                                  
PVW_SEs$bootstrap_SE

</code></pre>

<hr>
<h2 id='EM_function_bernoulliY'>EM Algorithm Function for Estimation of the Misclassification Model</h2><span id='topic+EM_function_bernoulliY'></span>

<h3>Description</h3>

<p>Function is for cases with <code class="reqn">Y \sim Bernoulli</code> and with no interaction term
in the outcome mechanism.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EM_function_bernoulliY(
  param_current,
  obs_mediator,
  obs_outcome,
  X,
  Z,
  c_matrix,
  sample_size,
  n_cat
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EM_function_bernoulliY_+3A_param_current">param_current</code></td>
<td>
<p>A numeric vector of regression parameters, in the order
<code class="reqn">\beta, \gamma, \theta</code>. The <code class="reqn">\gamma</code> vector is obtained from the matrix form.
In matrix form, the gamma parameter matrix rows
correspond to parameters for the <code>M* = 1</code>
observed mediator, with the dimensions of <code>Z</code>.
In matrix form, the gamma parameter matrix columns correspond to the true mediator categories
<code class="reqn">j = 1, \dots,</code> <code>n_cat</code>. The numeric vector <code>gamma_v</code> is
obtained by concatenating the gamma matrix, i.e. <code>gamma_v &lt;- c(gamma_matrix)</code>.</p>
</td></tr>
<tr><td><code id="EM_function_bernoulliY_+3A_obs_mediator">obs_mediator</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the observed
mediator <code>M*</code>. There should be no <code>NA</code> terms. The reference category is 2.</p>
</td></tr>
<tr><td><code id="EM_function_bernoulliY_+3A_obs_outcome">obs_outcome</code></td>
<td>
<p>A vector containing the outcome variables of interest. There
should be no <code>NA</code> terms.</p>
</td></tr>
<tr><td><code id="EM_function_bernoulliY_+3A_x">X</code></td>
<td>
<p>A numeric design matrix for the true mediator mechanism.</p>
</td></tr>
<tr><td><code id="EM_function_bernoulliY_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix for the observation mechanism.</p>
</td></tr>
<tr><td><code id="EM_function_bernoulliY_+3A_c_matrix">c_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true mediator and outcome mechanisms.
<code>c_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="EM_function_bernoulliY_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>X</code> or <code>Z</code>.</p>
</td></tr>
<tr><td><code id="EM_function_bernoulliY_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>M</code>,
and the observed outcome, <code>M*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>EM_function_bernoulliY</code> returns a numeric vector of updated parameter
estimates from one iteration of the EM-algorithm.
</p>

<hr>
<h2 id='EM_function_bernoulliY_XM'>EM Algorithm Function for Estimation of the Misclassification Model</h2><span id='topic+EM_function_bernoulliY_XM'></span>

<h3>Description</h3>

<p>Function is for cases with <code class="reqn">Y \sim Bernoulli</code> and with an interaction term
in the outcome mechanism.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EM_function_bernoulliY_XM(
  param_current,
  obs_mediator,
  obs_outcome,
  X,
  Z,
  c_matrix,
  sample_size,
  n_cat
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EM_function_bernoulliY_XM_+3A_param_current">param_current</code></td>
<td>
<p>A numeric vector of regression parameters, in the order
<code class="reqn">\beta, \gamma, \theta</code>. The <code class="reqn">\gamma</code> vector is obtained from the matrix form.
In matrix form, the gamma parameter matrix rows
correspond to parameters for the <code>M* = 1</code>
observed mediator, with the dimensions of <code>Z</code>.
In matrix form, the gamma parameter matrix columns correspond to the true mediator categories
<code class="reqn">j = 1, \dots,</code> <code>n_cat</code>. The numeric vector <code>gamma_v</code> is
obtained by concatenating the gamma matrix, i.e. <code>gamma_v &lt;- c(gamma_matrix)</code>.</p>
</td></tr>
<tr><td><code id="EM_function_bernoulliY_XM_+3A_obs_mediator">obs_mediator</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the observed
mediator <code>M*</code>. There should be no <code>NA</code> terms. The reference category is 2.</p>
</td></tr>
<tr><td><code id="EM_function_bernoulliY_XM_+3A_obs_outcome">obs_outcome</code></td>
<td>
<p>A vector containing the outcome variables of interest. There
should be no <code>NA</code> terms.</p>
</td></tr>
<tr><td><code id="EM_function_bernoulliY_XM_+3A_x">X</code></td>
<td>
<p>A numeric design matrix for the true mediator mechanism.</p>
</td></tr>
<tr><td><code id="EM_function_bernoulliY_XM_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix for the observation mechanism.</p>
</td></tr>
<tr><td><code id="EM_function_bernoulliY_XM_+3A_c_matrix">c_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true mediator and outcome mechanisms.
<code>c_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="EM_function_bernoulliY_XM_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>X</code> or <code>Z</code>.</p>
</td></tr>
<tr><td><code id="EM_function_bernoulliY_XM_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>M</code>,
and the observed outcome, <code>M*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>EM_function_bernoulliY</code> returns a numeric vector of updated parameter
estimates from one iteration of the EM-algorithm.
</p>

<hr>
<h2 id='EM_function_normalY'>EM Algorithm Function for Estimation of the Misclassification Model</h2><span id='topic+EM_function_normalY'></span>

<h3>Description</h3>

<p>Function is for cases with <code class="reqn">Y \sim Normal</code> and with no interaction term
in the outcome mechanism.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EM_function_normalY(
  param_current,
  obs_mediator,
  obs_outcome,
  X,
  Z,
  c_matrix,
  sample_size,
  n_cat
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EM_function_normalY_+3A_param_current">param_current</code></td>
<td>
<p>A numeric vector of regression parameters, in the order
<code class="reqn">\beta, \gamma, \theta</code>. The <code class="reqn">\gamma</code> vector is obtained from the matrix form.
In matrix form, the gamma parameter matrix rows
correspond to parameters for the <code>M* = 1</code>
observed mediator, with the dimensions of <code>Z</code>.
In matrix form, the gamma parameter matrix columns correspond to the true mediator categories
<code class="reqn">j = 1, \dots,</code> <code>n_cat</code>. The numeric vector <code>gamma_v</code> is
obtained by concatenating the gamma matrix, i.e. <code>gamma_v &lt;- c(gamma_matrix)</code>.</p>
</td></tr>
<tr><td><code id="EM_function_normalY_+3A_obs_mediator">obs_mediator</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the observed
mediator <code>M*</code>. There should be no <code>NA</code> terms. The reference category is 2.</p>
</td></tr>
<tr><td><code id="EM_function_normalY_+3A_obs_outcome">obs_outcome</code></td>
<td>
<p>A vector containing the outcome variables of interest. There
should be no <code>NA</code> terms.</p>
</td></tr>
<tr><td><code id="EM_function_normalY_+3A_x">X</code></td>
<td>
<p>A numeric design matrix for the true mediator mechanism.</p>
</td></tr>
<tr><td><code id="EM_function_normalY_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix for the observation mechanism.</p>
</td></tr>
<tr><td><code id="EM_function_normalY_+3A_c_matrix">c_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true mediator and outcome mechanisms.
<code>c_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="EM_function_normalY_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>X</code> or <code>Z</code>.</p>
</td></tr>
<tr><td><code id="EM_function_normalY_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>M</code>,
and the observed outcome, <code>M*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>EM_function_bernoulliY</code> returns a numeric vector of updated parameter
estimates from one iteration of the EM-algorithm.
</p>

<hr>
<h2 id='EM_function_normalY_XM'>EM Algorithm Function for Estimation of the Misclassification Model</h2><span id='topic+EM_function_normalY_XM'></span>

<h3>Description</h3>

<p>Function is for cases with <code class="reqn">Y \sim Normal</code> and with an interaction term
in the outcome mechanism.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EM_function_normalY_XM(
  param_current,
  obs_mediator,
  obs_outcome,
  X,
  Z,
  c_matrix,
  sample_size,
  n_cat
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EM_function_normalY_XM_+3A_param_current">param_current</code></td>
<td>
<p>A numeric vector of regression parameters, in the order
<code class="reqn">\beta, \gamma, \theta</code>. The <code class="reqn">\gamma</code> vector is obtained from the matrix form.
In matrix form, the gamma parameter matrix rows
correspond to parameters for the <code>M* = 1</code>
observed mediator, with the dimensions of <code>Z</code>.
In matrix form, the gamma parameter matrix columns correspond to the true mediator categories
<code class="reqn">j = 1, \dots,</code> <code>n_cat</code>. The numeric vector <code>gamma_v</code> is
obtained by concatenating the gamma matrix, i.e. <code>gamma_v &lt;- c(gamma_matrix)</code>.</p>
</td></tr>
<tr><td><code id="EM_function_normalY_XM_+3A_obs_mediator">obs_mediator</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the observed
mediator <code>M*</code>. There should be no <code>NA</code> terms. The reference category is 2.</p>
</td></tr>
<tr><td><code id="EM_function_normalY_XM_+3A_obs_outcome">obs_outcome</code></td>
<td>
<p>A vector containing the outcome variables of interest. There
should be no <code>NA</code> terms.</p>
</td></tr>
<tr><td><code id="EM_function_normalY_XM_+3A_x">X</code></td>
<td>
<p>A numeric design matrix for the true mediator mechanism.</p>
</td></tr>
<tr><td><code id="EM_function_normalY_XM_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix for the observation mechanism.</p>
</td></tr>
<tr><td><code id="EM_function_normalY_XM_+3A_c_matrix">c_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true mediator and outcome mechanisms.
<code>c_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="EM_function_normalY_XM_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>X</code> or <code>Z</code>.</p>
</td></tr>
<tr><td><code id="EM_function_normalY_XM_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>M</code>,
and the observed outcome, <code>M*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>EM_function_bernoulliY</code> returns a numeric vector of updated parameter
estimates from one iteration of the EM-algorithm.
</p>

<hr>
<h2 id='EM_function_poissonY'>EM Algorithm Function for Estimation of the Misclassification Model</h2><span id='topic+EM_function_poissonY'></span>

<h3>Description</h3>

<p>Function is for cases with <code class="reqn">Y \sim Poisson</code> and without an interaction term
in the outcome mechanism.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EM_function_poissonY(
  param_current,
  obs_mediator,
  obs_outcome,
  X,
  Z,
  c_matrix,
  sample_size,
  n_cat
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EM_function_poissonY_+3A_param_current">param_current</code></td>
<td>
<p>A numeric vector of regression parameters, in the order
<code class="reqn">\beta, \gamma, \theta</code>. The <code class="reqn">\gamma</code> vector is obtained from the matrix form.
In matrix form, the gamma parameter matrix rows
correspond to parameters for the <code>M* = 1</code>
observed mediator, with the dimensions of <code>Z</code>.
In matrix form, the gamma parameter matrix columns correspond to the true mediator categories
<code class="reqn">j = 1, \dots,</code> <code>n_cat</code>. The numeric vector <code>gamma_v</code> is
obtained by concatenating the gamma matrix, i.e. <code>gamma_v &lt;- c(gamma_matrix)</code>.</p>
</td></tr>
<tr><td><code id="EM_function_poissonY_+3A_obs_mediator">obs_mediator</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the observed
mediator <code>M*</code>. There should be no <code>NA</code> terms. The reference category is 2.</p>
</td></tr>
<tr><td><code id="EM_function_poissonY_+3A_obs_outcome">obs_outcome</code></td>
<td>
<p>A vector containing the outcome variables of interest. There
should be no <code>NA</code> terms.</p>
</td></tr>
<tr><td><code id="EM_function_poissonY_+3A_x">X</code></td>
<td>
<p>A numeric design matrix for the true mediator mechanism.</p>
</td></tr>
<tr><td><code id="EM_function_poissonY_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix for the observation mechanism.</p>
</td></tr>
<tr><td><code id="EM_function_poissonY_+3A_c_matrix">c_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true mediator and outcome mechanisms.
<code>c_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="EM_function_poissonY_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>X</code> or <code>Z</code>.</p>
</td></tr>
<tr><td><code id="EM_function_poissonY_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>M</code>,
and the observed outcome, <code>M*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>EM_function_bernoulliY</code> returns a numeric vector of updated parameter
estimates from one iteration of the EM-algorithm.
</p>

<hr>
<h2 id='EM_function_poissonY_XM'>EM Algorithm Function for Estimation of the Misclassification Model</h2><span id='topic+EM_function_poissonY_XM'></span>

<h3>Description</h3>

<p>Function is for cases with <code class="reqn">Y \sim Poisson</code> and with an interaction term
in the outcome mechanism.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EM_function_poissonY_XM(
  param_current,
  obs_mediator,
  obs_outcome,
  X,
  Z,
  c_matrix,
  sample_size,
  n_cat
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EM_function_poissonY_XM_+3A_param_current">param_current</code></td>
<td>
<p>A numeric vector of regression parameters, in the order
<code class="reqn">\beta, \gamma, \theta</code>. The <code class="reqn">\gamma</code> vector is obtained from the matrix form.
In matrix form, the gamma parameter matrix rows
correspond to parameters for the <code>M* = 1</code>
observed mediator, with the dimensions of <code>Z</code>.
In matrix form, the gamma parameter matrix columns correspond to the true mediator categories
<code class="reqn">j = 1, \dots,</code> <code>n_cat</code>. The numeric vector <code>gamma_v</code> is
obtained by concatenating the gamma matrix, i.e. <code>gamma_v &lt;- c(gamma_matrix)</code>.</p>
</td></tr>
<tr><td><code id="EM_function_poissonY_XM_+3A_obs_mediator">obs_mediator</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the observed
mediator <code>M*</code>. There should be no <code>NA</code> terms. The reference category is 2.</p>
</td></tr>
<tr><td><code id="EM_function_poissonY_XM_+3A_obs_outcome">obs_outcome</code></td>
<td>
<p>A vector containing the outcome variables of interest. There
should be no <code>NA</code> terms.</p>
</td></tr>
<tr><td><code id="EM_function_poissonY_XM_+3A_x">X</code></td>
<td>
<p>A numeric design matrix for the true mediator mechanism.</p>
</td></tr>
<tr><td><code id="EM_function_poissonY_XM_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix for the observation mechanism.</p>
</td></tr>
<tr><td><code id="EM_function_poissonY_XM_+3A_c_matrix">c_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true mediator and outcome mechanisms.
<code>c_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="EM_function_poissonY_XM_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>X</code> or <code>Z</code>.</p>
</td></tr>
<tr><td><code id="EM_function_poissonY_XM_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>M</code>,
and the observed outcome, <code>M*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>EM_function_bernoulliY</code> returns a numeric vector of updated parameter
estimates from one iteration of the EM-algorithm.
</p>

<hr>
<h2 id='misclassification_prob'>Compute Conditional Probability of Observed Mediator Given True Mediator, for Every Subject</h2><span id='topic+misclassification_prob'></span>

<h3>Description</h3>

<p>Compute the conditional probability of observing mediator <code class="reqn">M^* \in \{1, 2 \}</code> given
the latent true mediator <code class="reqn">M \in \{1, 2 \}</code> as
<code class="reqn">\frac{\text{exp}\{\gamma_{kj0} + \gamma_{kjZ} Z_i\}}{1 + \text{exp}\{\gamma_{kj0} + \gamma_{kjZ} Z_i\}}</code>
for each of the <code class="reqn">i = 1, \dots,</code> <code>n</code> subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>misclassification_prob(gamma_matrix, z_matrix)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="misclassification_prob_+3A_gamma_matrix">gamma_matrix</code></td>
<td>
<p>A numeric matrix of estimated regression parameters for the
observation mechanism, <code>M* | M</code> (observed mediator, given the true mediator)
~ <code>Z</code> (misclassification predictor matrix). Rows of the matrix
correspond to parameters for the <code>M* = 1</code> observed mediator, with the
dimensions of <code>z_matrix</code>. Columns of the matrix correspond to the true
mediator categories <code class="reqn">j = 1, \dots,</code> <code>n_cat</code>. The matrix should be
obtained by <code>COMMA_EM</code>, <code>COMMA_PVW</code>, or <code>COMMA_OLS</code>.</p>
</td></tr>
<tr><td><code id="misclassification_prob_+3A_z_matrix">z_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the observation mechanism.
<code>z_matrix</code> should not contain an intercept.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>misclassification_prob</code> returns a dataframe containing four columns.
The first column, <code>Subject</code>, represents the subject ID, from <code class="reqn">1</code> to <code>n</code>,
where <code>n</code> is the sample size, or equivalently, the number of rows in <code>z_matrix</code>.
The second column, <code>M</code>, represents a true, latent mediator category <code class="reqn">M \in \{1, 2 \}</code>.
The third column, <code>Mstar</code>, represents an observed outcome category <code class="reqn">M^* \in \{1, 2 \}</code>.
The last column, <code>Probability</code>, is the value of the equation
<code class="reqn">\frac{\text{exp}\{\gamma_{kj0} + \gamma_{kjZ} Z_i\}}{1 + \text{exp}\{\gamma_{kj0} + \gamma_{kjZ} Z_i\}}</code>
computed for each subject, observed mediator category, and true, latent mediator category.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
sample_size &lt;- 1000
cov1 &lt;- rnorm(sample_size)
cov2 &lt;- rnorm(sample_size, 1, 2)
z_matrix &lt;- matrix(c(cov1, cov2), nrow = sample_size, byrow = FALSE)
estimated_gammas &lt;- matrix(c(1, -1, .5, .2, -.6, 1.5), ncol = 2)
P_Ystar_M &lt;- misclassification_prob(estimated_gammas, z_matrix)
head(P_Ystar_M)
</code></pre>

<hr>
<h2 id='NCHS2022_sample'>Example data from the National Vital Statistics System of the National Center for Health Statistics (NCHS), 2022</h2><span id='topic+NCHS2022_sample'></span>

<h3>Description</h3>

<p>Example data from the National Vital Statistics System of the National Center for Health Statistics (NCHS), 2022
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCHS2022_sample
</code></pre>


<h3>Format</h3>

<p>A dataframe 30 columns, including demographic and birth information
for a random sample of 20,000 singleton births from nulliparous mothers in the
US in 2022.
</p>


<h3>Source</h3>

<p><a href="https://data.nber.org/nvss/natality/inputs/raw/2022/">https://data.nber.org/nvss/natality/inputs/raw/2022/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("NCHS2022_sample")
head(NCHS2022_sample)

## End(Not run)
</code></pre>

<hr>
<h2 id='pi_compute'>Compute Probability of Each True Outcome, for Every Subject</h2><span id='topic+pi_compute'></span>

<h3>Description</h3>

<p>Compute Probability of Each True Outcome, for Every Subject
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pi_compute(beta, X, n, n_cat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pi_compute_+3A_beta">beta</code></td>
<td>
<p>A numeric column matrix of regression parameters for the
<code>Y</code> (true outcome) ~ <code>X</code> (predictor matrix of interest).</p>
</td></tr>
<tr><td><code id="pi_compute_+3A_x">X</code></td>
<td>
<p>A numeric design matrix.</p>
</td></tr>
<tr><td><code id="pi_compute_+3A_n">n</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>X</code>.</p>
</td></tr>
<tr><td><code id="pi_compute_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>pi_compute</code> returns a matrix of probabilities,
<code class="reqn">P(Y_i = j | X_i) = \frac{\exp(X_i \beta)}{1 + \exp(X_i \beta)}</code>
for each of the <code class="reqn">i = 1, \dots,</code> <code>n</code> subjects. Rows of the matrix
correspond to each subject. Columns of the matrix correspond to the true outcome
categories <code class="reqn">j = 1, \dots,</code> <code>n_cat</code>.
</p>

<hr>
<h2 id='pistar_compute'>Compute Conditional Probability of Each Observed Outcome Given Each True Outcome, for Every Subject</h2><span id='topic+pistar_compute'></span>

<h3>Description</h3>

<p>Compute Conditional Probability of Each Observed Outcome Given Each True Outcome, for Every Subject
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pistar_compute(gamma, Z, n, n_cat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pistar_compute_+3A_gamma">gamma</code></td>
<td>
<p>A numeric matrix of regression parameters for the observed
outcome mechanism, <code>Y* | Y</code>
(observed outcome, given the true outcome) ~ <code>Z</code> (misclassification
predictor matrix). Rows of the matrix correspond to parameters for the <code>Y* = 1</code>
observed outcome, with the dimensions of <code>Z</code>.
Columns of the matrix correspond to the true outcome categories
<code class="reqn">j = 1, \dots,</code> <code>n_cat</code>.</p>
</td></tr>
<tr><td><code id="pistar_compute_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix.</p>
</td></tr>
<tr><td><code id="pistar_compute_+3A_n">n</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>Z</code>.</p>
</td></tr>
<tr><td><code id="pistar_compute_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcome, <code>Y*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>pistar_compute</code> returns a matrix of conditional probabilities,
<code class="reqn">P(Y_i^* = k | Y_i = j, Z_i) = \frac{\text{exp}\{\gamma_{kj0} + \gamma_{kjZ} Z_i\}}{1 + \text{exp}\{\gamma_{kj0} + \gamma_{kjZ} Z_i\}}</code>
for each of the <code class="reqn">i = 1, \dots,</code> <code>n</code> subjects. Rows of the matrix
correspond to each subject and observed outcome. Specifically, the probability
for subject <code class="reqn">i</code> and observed category $1$ occurs at row <code class="reqn">i</code>. The probability
for subject <code class="reqn">i</code> and observed category $2$ occurs at row <code class="reqn">i +</code> <code>n</code>.
Columns of the matrix correspond to the true outcome categories <code class="reqn">j = 1, \dots,</code> <code>n_cat</code>.
</p>

<hr>
<h2 id='sum_every_n'>Sum Every &quot;n&quot;th Element</h2><span id='topic+sum_every_n'></span>

<h3>Description</h3>

<p>Sum Every &quot;n&quot;th Element
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sum_every_n(x, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sum_every_n_+3A_x">x</code></td>
<td>
<p>A numeric vector to sum over</p>
</td></tr>
<tr><td><code id="sum_every_n_+3A_n">n</code></td>
<td>
<p>A numeric value specifying the distance between the reference index and the next index to be summed</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>sum_every_n</code> returns a vector of sums of every <code>n</code>th element of the vector <code>x</code>.
</p>

<hr>
<h2 id='sum_every_n1'>Sum Every &quot;n&quot;th Element, then add 1</h2><span id='topic+sum_every_n1'></span>

<h3>Description</h3>

<p>Sum Every &quot;n&quot;th Element, then add 1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sum_every_n1(x, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sum_every_n1_+3A_x">x</code></td>
<td>
<p>A numeric vector to sum over</p>
</td></tr>
<tr><td><code id="sum_every_n1_+3A_n">n</code></td>
<td>
<p>A numeric value specifying the distance between the reference index and the next index to be summed</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>sum_every_n1</code> returns a vector of sums of every <code>n</code>th element of the vector <code>x</code>, plus 1.
</p>

<hr>
<h2 id='theta_optim'>Likelihood Function for Normal Outcome Mechanism with a Binary Mediator</h2><span id='topic+theta_optim'></span>

<h3>Description</h3>

<p>Likelihood Function for Normal Outcome Mechanism with a Binary Mediator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theta_optim(param_start, m, x, c_matrix, outcome, sample_size, n_cat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="theta_optim_+3A_param_start">param_start</code></td>
<td>
<p>A numeric vector or column matrix of starting values for the <code class="reqn">\theta</code>
parameters in the outcome mechanism and <code class="reqn">\sigma</code> parameter.
The number of elements in <code>param_start</code>
should be equal to the number of columns of <code>x_matrix</code> and <code>c_matrix</code> plus 2
(if <code>interaction_indicator</code> is <code>FALSE</code>) or 3 (if
<code>interaction_indicator</code> is <code>TRUE</code>). Starting values should be
provided in the following order: intercept, slope coefficient for the <code>x_matrix</code> term,
slope coefficient for the mediator <code>m</code> term,
slope coefficient for first column of the <code>c_matrix</code>, ...,
slope coefficient for the final column of the <code>c_matrix</code>,
and, optionally, slope coefficient for <code>xm</code>). The final entry should be
the starting value for <code class="reqn">\sigma</code>.</p>
</td></tr>
<tr><td><code id="theta_optim_+3A_m">m</code></td>
<td>
<p>A vector or column matrix containing the true binary mediator or the
E-step weight (with values between 0 and 1). There
should be no <code>NA</code> terms.</p>
</td></tr>
<tr><td><code id="theta_optim_+3A_x">x</code></td>
<td>
<p>A vector or column matrix of the predictor or exposure of interest. There
should be no <code>NA</code> terms.</p>
</td></tr>
<tr><td><code id="theta_optim_+3A_c_matrix">c_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true mediator and outcome mechanisms.
<code>c_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="theta_optim_+3A_outcome">outcome</code></td>
<td>
<p>A vector containing the outcome variables of interest. There
should be no <code>NA</code> terms.</p>
</td></tr>
<tr><td><code id="theta_optim_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>X</code> or <code>Z</code>.</p>
</td></tr>
<tr><td><code id="theta_optim_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>M</code>,
and the observed outcome, <code>M*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>theta_optim</code> returns a numeric value of the (negative) log-likelihood function.
</p>

<hr>
<h2 id='theta_optim_XM'>Likelihood Function for Normal Outcome Mechanism with a Binary Mediator and an Interaction Term</h2><span id='topic+theta_optim_XM'></span>

<h3>Description</h3>

<p>Likelihood Function for Normal Outcome Mechanism with a Binary Mediator and an Interaction Term
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theta_optim_XM(param_start, m, x, c_matrix, outcome, sample_size, n_cat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="theta_optim_XM_+3A_param_start">param_start</code></td>
<td>
<p>A numeric vector or column matrix of starting values for the <code class="reqn">\theta</code>
parameters in the outcome mechanism and <code class="reqn">\sigma</code> parameter.
The number of elements in <code>param_start</code>
should be equal to the number of columns of <code>x_matrix</code> and <code>c_matrix</code> plus 2
(if <code>interaction_indicator</code> is <code>FALSE</code>) or 3 (if
<code>interaction_indicator</code> is <code>TRUE</code>). Starting values should be
provided in the following order: intercept, slope coefficient for the <code>x_matrix</code> term,
slope coefficient for the mediator <code>m</code> term,
slope coefficient for first column of the <code>c_matrix</code>, ...,
slope coefficient for the final column of the <code>c_matrix</code>,
and, optionally, slope coefficient for <code>xm</code>). The final entry should be
the starting value for <code class="reqn">\sigma</code>.</p>
</td></tr>
<tr><td><code id="theta_optim_XM_+3A_m">m</code></td>
<td>
<p>vector or column matrix containing the true binary mediator or the
E-step weight (with values between 0 and 1). There
should be no <code>NA</code> terms.</p>
</td></tr>
<tr><td><code id="theta_optim_XM_+3A_x">x</code></td>
<td>
<p>A vector or column matrix of the predictor or exposure of interest. There
should be no <code>NA</code> terms.</p>
</td></tr>
<tr><td><code id="theta_optim_XM_+3A_c_matrix">c_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true mediator and outcome mechanisms.
<code>c_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="theta_optim_XM_+3A_outcome">outcome</code></td>
<td>
<p>A vector containing the outcome variables of interest. There
should be no <code>NA</code> terms.</p>
</td></tr>
<tr><td><code id="theta_optim_XM_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>X</code> or <code>Z</code>.</p>
</td></tr>
<tr><td><code id="theta_optim_XM_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>M</code>,
and the observed outcome, <code>M*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>theta_optim_XM</code> returns a numeric value of the (negative) log-likelihood function.
</p>

<hr>
<h2 id='true_classification_prob'>Compute Probability of Each True Mediator, for Every Subject</h2><span id='topic+true_classification_prob'></span>

<h3>Description</h3>

<p>Compute the probability of the latent true mediator <code class="reqn">M \in \{1, 2 \}</code> as
<code class="reqn">P(M_i = j | X_i) = \frac{\exp(X_i \beta)}{1 + \exp(X_i \beta)}</code>
for each of the <code class="reqn">i = 1, \dots,</code> <code>n</code> subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>true_classification_prob(beta_matrix, x_matrix)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="true_classification_prob_+3A_beta_matrix">beta_matrix</code></td>
<td>
<p>A numeric column matrix of estimated regression parameters for the
true mediator mechanism, <code>M</code> (true mediator) ~ <code>X</code> (predictor matrix of interest),
obtained from <code>COMMA_EM</code>, <code>COMMA_PVW</code>, or <code>COMMA_OLS</code>.</p>
</td></tr>
<tr><td><code id="true_classification_prob_+3A_x_matrix">x_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true mediator mechanism.
<code>x_matrix</code> should not contain an intercept.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>true_classification_prob</code> returns a dataframe containing three columns.
The first column, <code>Subject</code>, represents the subject ID, from <code class="reqn">1</code> to <code>n</code>,
where <code>n</code> is the sample size, or equivalently, the number of rows in <code>x_matrix</code>.
The second column, <code>M</code>, represents a true, latent mediator category <code class="reqn">M \in \{1, 2 \}</code>.
The last column, <code>Probability</code>, is the value of the equation
<code class="reqn">P(M_i = j | X_i) = \frac{\exp(X_i \beta)}{1 + \exp(X_i \beta)}</code> computed
for each subject and true, latent mediator category.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
sample_size &lt;- 1000
cov1 &lt;- rnorm(sample_size)
cov2 &lt;- rnorm(sample_size, 1, 2)
x_matrix &lt;- matrix(c(cov1, cov2), nrow = sample_size, byrow = FALSE)
estimated_betas &lt;- matrix(c(1, -1, .5), ncol = 1)
P_M &lt;- true_classification_prob(estimated_betas, x_matrix)
head(P_M)
</code></pre>

<hr>
<h2 id='w_m_binaryY'>Compute E-step for Binary Mediator Misclassification Model Estimated With the EM Algorithm</h2><span id='topic+w_m_binaryY'></span>

<h3>Description</h3>

<p>Note that this function should only be used for Binary outcome models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>w_m_binaryY(
  mstar_matrix,
  outcome_matrix,
  pistar_matrix,
  pi_matrix,
  p_yi_m0,
  p_yi_m1,
  sample_size,
  n_cat
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="w_m_binaryY_+3A_mstar_matrix">mstar_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the observed
mediator <code>M*</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed mediator category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="w_m_binaryY_+3A_outcome_matrix">outcome_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the observed
outcome <code>Y</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="w_m_binaryY_+3A_pistar_matrix">pistar_matrix</code></td>
<td>
<p>A numeric matrix of conditional probabilities obtained from
the internal function <code>pistar_compute</code>. Rows of the matrix correspond to
each subject and to each observed mediator category. Columns of the matrix
correspond to each true, latent mediator category.</p>
</td></tr>
<tr><td><code id="w_m_binaryY_+3A_pi_matrix">pi_matrix</code></td>
<td>
<p>A numeric matrix of probabilities obtained from the internal
function <code>pi_compute</code>. Rows of the matrix correspond to each subject.
Columns of the matrix correspond to each true, latent mediator category.</p>
</td></tr>
<tr><td><code id="w_m_binaryY_+3A_p_yi_m0">p_yi_m0</code></td>
<td>
<p>A numeric vector of outcome probabilities computed assuming a
true mediator value of 0.</p>
</td></tr>
<tr><td><code id="w_m_binaryY_+3A_p_yi_m1">p_yi_m1</code></td>
<td>
<p>A numeric vector of outcome probabilities computed assuming a
true mediator value of 1.</p>
</td></tr>
<tr><td><code id="w_m_binaryY_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in
the sample. This value should be equal to the number of rows of the observed
mediator matrix, <code>mstar_matrix</code>.</p>
</td></tr>
<tr><td><code id="w_m_binaryY_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>M</code>,
and the observed outcome, <code>M*</code>, can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>w_m_binaryY</code> returns a matrix of E-step weights for the EM-algorithm.
Rows of the matrix correspond to each subject. Columns of the matrix correspond
to the true mediator categories <code class="reqn">j = 1, \dots,</code> <code>n_cat</code>.
</p>

<hr>
<h2 id='w_m_normalY'>Compute E-step for Binary Mediator Misclassification Model Estimated With the EM Algorithm</h2><span id='topic+w_m_normalY'></span>

<h3>Description</h3>

<p>Note that this function should only be used for Normal outcome models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>w_m_normalY(
  mstar_matrix,
  pistar_matrix,
  pi_matrix,
  p_yi_m0,
  p_yi_m1,
  sample_size,
  n_cat
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="w_m_normalY_+3A_mstar_matrix">mstar_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the observed
mediator <code>M*</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed mediator category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="w_m_normalY_+3A_pistar_matrix">pistar_matrix</code></td>
<td>
<p>A numeric matrix of conditional probabilities obtained from
the internal function <code>pistar_compute</code>. Rows of the matrix correspond to
each subject and to each observed mediator category. Columns of the matrix
correspond to each true, latent mediator category.</p>
</td></tr>
<tr><td><code id="w_m_normalY_+3A_pi_matrix">pi_matrix</code></td>
<td>
<p>A numeric matrix of probabilities obtained from the internal
function <code>pi_compute</code>. Rows of the matrix correspond to each subject.
Columns of the matrix correspond to each true, latent mediator category.</p>
</td></tr>
<tr><td><code id="w_m_normalY_+3A_p_yi_m0">p_yi_m0</code></td>
<td>
<p>A numeric vector of Normal outcome likelihoods computed assuming a
true mediator value of 0.</p>
</td></tr>
<tr><td><code id="w_m_normalY_+3A_p_yi_m1">p_yi_m1</code></td>
<td>
<p>A numeric vector of Normal outcome likelihoods computed assuming a
true mediator value of 1.</p>
</td></tr>
<tr><td><code id="w_m_normalY_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in
the sample. This value should be equal to the number of rows of the observed
mediator matrix, <code>mstar_matrix</code>.</p>
</td></tr>
<tr><td><code id="w_m_normalY_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>M</code>,
and the observed outcome, <code>M*</code>, can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>w_m_normalY</code> returns a matrix of E-step weights for the EM-algorithm.
Rows of the matrix correspond to each subject. Columns of the matrix correspond
to the true mediator categories <code class="reqn">j = 1, \dots,</code> <code>n_cat</code>.
</p>

<hr>
<h2 id='w_m_poissonY'>Compute E-step for Binary Mediator Misclassification Model Estimated With the EM Algorithm</h2><span id='topic+w_m_poissonY'></span>

<h3>Description</h3>

<p>Note that this function should only be used for Poisson outcome models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>w_m_poissonY(
  mstar_matrix,
  outcome_matrix,
  pistar_matrix,
  pi_matrix,
  p_yi_m0,
  p_yi_m1,
  sample_size,
  n_cat
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="w_m_poissonY_+3A_mstar_matrix">mstar_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the observed
mediator <code>M*</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed mediator category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="w_m_poissonY_+3A_outcome_matrix">outcome_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the observed
outcome <code>Y</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="w_m_poissonY_+3A_pistar_matrix">pistar_matrix</code></td>
<td>
<p>A numeric matrix of conditional probabilities obtained from
the internal function <code>pistar_compute</code>. Rows of the matrix correspond to
each subject and to each observed mediator category. Columns of the matrix
correspond to each true, latent mediator category.</p>
</td></tr>
<tr><td><code id="w_m_poissonY_+3A_pi_matrix">pi_matrix</code></td>
<td>
<p>A numeric matrix of probabilities obtained from the internal
function <code>pi_compute</code>. Rows of the matrix correspond to each subject.
Columns of the matrix correspond to each true, latent mediator category.</p>
</td></tr>
<tr><td><code id="w_m_poissonY_+3A_p_yi_m0">p_yi_m0</code></td>
<td>
<p>A numeric vector of outcome probabilities computed assuming a
true mediator value of 0.</p>
</td></tr>
<tr><td><code id="w_m_poissonY_+3A_p_yi_m1">p_yi_m1</code></td>
<td>
<p>A numeric vector of outcome probabilities computed assuming a
true mediator value of 1.</p>
</td></tr>
<tr><td><code id="w_m_poissonY_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in
the sample. This value should be equal to the number of rows of the observed
mediator matrix, <code>mstar_matrix</code>.</p>
</td></tr>
<tr><td><code id="w_m_poissonY_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>M</code>,
and the observed outcome, <code>M*</code>, can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>w_m_poissonY</code> returns a matrix of E-step weights for the EM-algorithm.
Rows of the matrix correspond to each subject. Columns of the matrix correspond
to the true mediator categories <code class="reqn">j = 1, \dots,</code> <code>n_cat</code>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
