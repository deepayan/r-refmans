<!DOCTYPE html><html><head><title>Help for package experDesign</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {experDesign}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#experDesign-package'><p>experDesign: Expert experiment design in batches</p></a></li>
<li><a href='#batch_names'><p>Name the batch</p></a></li>
<li><a href='#check_data'><p>Check experiment data</p></a></li>
<li><a href='#check_index'><p>Check index distribution on batches</p></a></li>
<li><a href='#compare_index'><p>Compares two indexes</p></a></li>
<li><a href='#create_subset'><p>Create index of subsets of a data</p></a></li>
<li><a href='#design'><p>Design a batch experiment</p></a></li>
<li><a href='#distribution'><p>Distribution by batch</p></a></li>
<li><a href='#entropy'><p>Calculates the entropy</p></a></li>
<li><a href='#evaluate_entropy'><p>Evaluate entropy</p></a></li>
<li><a href='#evaluate_independence'><p>Compare independence by chisq.test</p></a></li>
<li><a href='#evaluate_index'><p>Evaluates a data.frame</p></a></li>
<li><a href='#evaluate_mad'><p>Evaluate median absolute deviation</p></a></li>
<li><a href='#evaluate_mean'><p>Evaluates the mean of the numeric values</p></a></li>
<li><a href='#evaluate_na'><p>Evaluate the dispersion of NAs</p></a></li>
<li><a href='#evaluate_orig'><p>Evaluate each variable provided</p></a></li>
<li><a href='#evaluate_sd'><p>Evaluates the mean of the numeric values</p></a></li>
<li><a href='#extreme_cases'><p>Select the subset of extreme cases to evaluation</p></a></li>
<li><a href='#follow_up'><p>Follow up experiments</p></a></li>
<li><a href='#follow_up2'><p>Follow up experiments in batches</p></a></li>
<li><a href='#inspect'><p>Inspect the index</p></a></li>
<li><a href='#optimum'><p>Optimum values for batches</p></a></li>
<li><a href='#position_name'><p>Create position names for a grid.</p></a></li>
<li><a href='#qcSubset'><p>Random subset</p></a></li>
<li><a href='#replicates'><p>Design a batch experiment with experimental controls</p></a></li>
<li><a href='#spatial'><p>Distribute the sample on the plate</p></a></li>
<li><a href='#use_index'><p>Convert a factor to index</p></a></li>
<li><a href='#valid_followup'><p>Check the data for a follow up experiment.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Design Experiments for Batches</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Distributes samples in batches while making batches
    homogeneous according to their description. Allows for an arbitrary
    number of variables, both numeric and categorical. For quality control
    it provides functions to subset a representative sample.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://experdesign.llrs.dev">https://experdesign.llrs.dev</a>, <a href="https://github.com/llrs/experDesign/">https://github.com/llrs/experDesign/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/llrs/experDesign/issues">https://github.com/llrs/experDesign/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, knitr, MASS, rmarkdown, spelling, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-20 20:26:56 UTC; lluis</td>
</tr>
<tr>
<td>Author:</td>
<td>Lluís Revilla Sancho
    <a href="https://orcid.org/0000-0001-9747-2570"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Juanjo Lozano <a href="https://orcid.org/0000-0001-7613-3908"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ths],
  Azucena Salas Martinez
    <a href="https://orcid.org/0000-0003-4572-2907"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lluís Revilla Sancho &lt;lluis.revilla@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-20 21:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='experDesign-package'>experDesign: Expert experiment design in batches</h2><span id='topic+experDesign-package'></span><span id='topic+experDesign'></span>

<h3>Description</h3>

<p>Enables easy distribution of samples per batch avoiding batch and
confounding effects by randomization of the variables in each batch.
</p>


<h3>Details</h3>

<p>The most important function is <code><a href="#topic+design">design()</a></code>, which distributes
samples in batches according to the information provided.
</p>
<p>To help in the bench there is the <code><a href="#topic+inspect">inspect()</a></code> function that appends
the group to the data provided.
</p>
<p>If you have a grid or some spatial data, you might want to look at the
<code><a href="#topic+spatial">spatial()</a></code> function to distribute the samples while keeping the original
design.
</p>
<p>In case an experiment was half processed and you need to extend it you can
use <code><a href="#topic+follow_up">follow_up()</a></code> or <code><a href="#topic+follow_up2">follow_up2()</a></code>. It helps selecting which samples
already used should be used in the follow up.
</p>


<h3>Author(s)</h3>

<p>Lluís Revilla
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://experdesign.llrs.dev">https://experdesign.llrs.dev</a>
</p>
</li>
<li> <p><a href="https://github.com/llrs/experDesign/">https://github.com/llrs/experDesign/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/llrs/experDesign/issues">https://github.com/llrs/experDesign/issues</a>
</p>
</li></ul>


<hr>
<h2 id='batch_names'>Name the batch</h2><span id='topic+batch_names'></span>

<h3>Description</h3>

<p>Given an index return the name of the batches the samples are in
</p>


<h3>Usage</h3>

<pre><code class='language-R'>batch_names(i)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="batch_names_+3A_i">i</code></td>
<td>
<p>A list of numeric indices.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector with the names of the batch for each the index.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_subset">create_subset()</a></code>, for the inverse look at
<code><a href="#topic+use_index">use_index()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>index &lt;- create_subset(100, 50, 2)
batch &lt;- batch_names(index)
head(batch)
</code></pre>

<hr>
<h2 id='check_data'>Check experiment data</h2><span id='topic+check_data'></span>

<h3>Description</h3>

<p>In order to run a successful experiment a good design is needed even before measuring the data.
This functions checks several heuristics for a good experiment and warns if they are not found.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_data(pheno, omit = NULL, na.omit = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_data_+3A_pheno">pheno</code></td>
<td>
<p>Data.frame with the variables of each sample, one row one sample.</p>
</td></tr>
<tr><td><code id="check_data_+3A_omit">omit</code></td>
<td>
<p>Character vector with the names of the columns to omit.</p>
</td></tr>
<tr><td><code id="check_data_+3A_na.omit">na.omit</code></td>
<td>
<p>Check the effects of missing values too.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical value indicating if everything is alright (<code>TRUE</code> or not (<code>FALSE</code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+valid_followup">valid_followup()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rdata &lt;- expand.grid(sex = c("M", "F"), class = c("lower", "median", "high"))
rdata2 &lt;- rbind(rdata, rdata)
check_data(rdata2)

#Different warnings
check_data(rdata)
check_data(rdata[-c(1, 3), ])
data(survey, package = "MASS")
check_data(survey)

</code></pre>

<hr>
<h2 id='check_index'>Check index distribution on batches</h2><span id='topic+check_index'></span>

<h3>Description</h3>

<p>Report the statistics for each subset and variable compared to the original.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_index(pheno, index, omit = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_index_+3A_pheno">pheno</code></td>
<td>
<p>Data.frame with the sample information.</p>
</td></tr>
<tr><td><code id="check_index_+3A_index">index</code></td>
<td>
<p>A list of indices indicating which samples go to which subset.</p>
</td></tr>
<tr><td><code id="check_index_+3A_omit">omit</code></td>
<td>
<p>Name of the columns of the <code>pheno</code> that will be omitted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The closer the values are to 0, the less difference is with the original
distribution, so it is a better randomization.
</p>


<h3>Value</h3>

<p>A matrix with the differences with the original data.
</p>


<h3>See Also</h3>

<p>Functions that create an index <code><a href="#topic+design">design()</a></code>, <code><a href="#topic+replicates">replicates()</a></code>,
<code><a href="#topic+spatial">spatial()</a></code>. See also <code><a href="#topic+create_subset">create_subset()</a></code> for a random index.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>index &lt;- create_subset(50, 24)
metadata &lt;- expand.grid(height = seq(60, 80, 5), weight = seq(100, 300, 50),
                        sex = c("Male","Female"))
check_index(metadata, index)
</code></pre>

<hr>
<h2 id='compare_index'>Compares two indexes</h2><span id='topic+compare_index'></span>

<h3>Description</h3>

<p>Compare the distribution of samples with two different batches.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_index(pheno, index1, index2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_index_+3A_pheno">pheno</code></td>
<td>
<p>A data.frame of the samples with the characteristics to normalize.</p>
</td></tr>
<tr><td><code id="compare_index_+3A_index1">index1</code>, <code id="compare_index_+3A_index2">index2</code></td>
<td>
<p>A list with the index for each sample, the name of the
column in <code>pheno</code> with the batch subset or the character .</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the variables and the columns of of each batch.
Negative values indicate <code>index1</code> was better.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+check_index">check_index()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>index1 &lt;- create_subset(50, 24)
index2 &lt;- batch_names(create_subset(50, 24))
metadata &lt;- expand.grid(height = seq(60, 80, 5), weight = seq(100, 300, 50),
                         sex = c("Male","Female"))
compare_index(metadata, index1, index2)
</code></pre>

<hr>
<h2 id='create_subset'>Create index of subsets of a data</h2><span id='topic+create_subset'></span>

<h3>Description</h3>

<p>Index of the samples grouped by batches.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_subset(size_data, size_subset = NULL, n = NULL, name = "SubSet")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_subset_+3A_size_data">size_data</code></td>
<td>
<p>A numeric value of the amount of samples to distribute.</p>
</td></tr>
<tr><td><code id="create_subset_+3A_size_subset">size_subset</code></td>
<td>
<p>A numeric value with the amount of samples per batch.</p>
</td></tr>
<tr><td><code id="create_subset_+3A_n">n</code></td>
<td>
<p>A numeric value with the number of batches.</p>
</td></tr>
<tr><td><code id="create_subset_+3A_name">name</code></td>
<td>
<p>A character used to name the subsets, either a single one or a
vector the same size as <code>n</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A random list of indices of the samples.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+batch_names">batch_names()</a></code>, <code><a href="#topic+use_index">use_index()</a></code> if you already
have a factor to be used as index.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>index &lt;- create_subset(100, 50, 2)
</code></pre>

<hr>
<h2 id='design'>Design a batch experiment</h2><span id='topic+design'></span>

<h3>Description</h3>

<p>Given some samples it distribute them in several batches, trying to have
equal number of samples per batch. It can handle both numeric and
categorical data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>design(pheno, size_subset, omit = NULL, iterations = 500, name = "SubSet")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="design_+3A_pheno">pheno</code></td>
<td>
<p>Data.frame with the sample information.</p>
</td></tr>
<tr><td><code id="design_+3A_size_subset">size_subset</code></td>
<td>
<p>Numeric value of the number of sample per batch.</p>
</td></tr>
<tr><td><code id="design_+3A_omit">omit</code></td>
<td>
<p>Name of the columns of the <code>pheno</code> that will be omitted.</p>
</td></tr>
<tr><td><code id="design_+3A_iterations">iterations</code></td>
<td>
<p>Numeric value of iterations that will be performed.</p>
</td></tr>
<tr><td><code id="design_+3A_name">name</code></td>
<td>
<p>A character used to name the subsets, either a single one or a
vector the same size as <code>n</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The indices of which samples go with which batch.
</p>


<h3>See Also</h3>

<p>The <code style="white-space: pre;">&#8288;evaluate_*&#8288;</code> functions and <code><a href="#topic+create_subset">create_subset()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(survey, package = "MASS")
index &lt;- design(survey[, c("Sex", "Smoke", "Age")], size_subset = 50,
                iterations = 10)
index
</code></pre>

<hr>
<h2 id='distribution'>Distribution by batch</h2><span id='topic+distribution'></span>

<h3>Description</h3>

<p>Checks if all the values are maximally distributed in the several batches.
Aimed for categorical variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distribution(report, column)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distribution_+3A_report">report</code></td>
<td>
<p>A data.frame which must contain a batch column. Which can be
obtained with <code><a href="#topic+inspect">inspect()</a></code>.</p>
</td></tr>
<tr><td><code id="distribution_+3A_column">column</code></td>
<td>
<p>The name of the column one wants to inspect.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> if the values are maximal distributed, otherwise <code>FALSE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(survey, package = "MASS")
columns &lt;- c("Sex", "Age", "Smoke")
nas &lt;- c(137, 70) # Omit rows with NA to avoid warnings in design
index &lt;- design(pheno = survey[-nas, columns], size_subset = 70,
                iterations = 10)
batches &lt;- inspect(index, survey[-nas, columns])
distribution(batches, "Sex")
distribution(batches, "Smoke")
</code></pre>

<hr>
<h2 id='entropy'>Calculates the entropy</h2><span id='topic+entropy'></span>

<h3>Description</h3>

<p>Calculates the entropy of a category. It uses the amount of categories to
scale between 0 and 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>entropy(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="entropy_+3A_x">x</code></td>
<td>
<p>A character or vector with two or more categories</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The numeric value of the Shannon entropy scaled between 0 and 1.
</p>


<h3>Note</h3>

<p>It omits the <code>NA</code> if present.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>entropy(c("H", "T", "H", "T"))
entropy(c("H", "T", "H", "T", "H", "H", "H"))
entropy(c("H", "T", "H", "T", "H", "H", NA))
entropy(c("H", "T", "H", "T", "H", "H"))
entropy(c("H", "H", "H", "H", "H", "H", NA))
</code></pre>

<hr>
<h2 id='evaluate_entropy'>Evaluate entropy</h2><span id='topic+evaluate_entropy'></span>

<h3>Description</h3>

<p>Looks if the nominal or character columns are equally distributed according
to the entropy and taking into account the independence between batches.
If any column is different in each row it is assumed to be the sample names
and thus omitted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_entropy(i, pheno)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_entropy_+3A_i">i</code></td>
<td>
<p>list of numeric indices of the data.frame</p>
</td></tr>
<tr><td><code id="evaluate_entropy_+3A_pheno">pheno</code></td>
<td>
<p>Data.frame with information about the samples</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value to minimize
</p>


<h3>See Also</h3>

<p>Other functions to evaluate samples: 
<code><a href="#topic+evaluate_independence">evaluate_independence</a>()</code>,
<code><a href="#topic+evaluate_index">evaluate_index</a>()</code>,
<code><a href="#topic+evaluate_mad">evaluate_mad</a>()</code>,
<code><a href="#topic+evaluate_mean">evaluate_mean</a>()</code>,
<code><a href="#topic+evaluate_na">evaluate_na</a>()</code>,
<code><a href="#topic+evaluate_orig">evaluate_orig</a>()</code>,
<code><a href="#topic+evaluate_sd">evaluate_sd</a>()</code>
</p>
<p>Other functions to evaluate categories: 
<code><a href="#topic+evaluate_independence">evaluate_independence</a>()</code>,
<code><a href="#topic+evaluate_na">evaluate_na</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(survey, package = "MASS")
index &lt;- design(survey[, c("Sex", "Smoke", "Age")], size_subset = 50,
                iterations = 10)
# Note that numeric columns will be omitted:
evaluate_entropy(index, survey[, c("Sex", "Smoke", "Age")])
</code></pre>

<hr>
<h2 id='evaluate_independence'>Compare independence by chisq.test</h2><span id='topic+evaluate_independence'></span>

<h3>Description</h3>

<p>Looks the independence between the categories and the batches.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_independence(i, pheno)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_independence_+3A_i">i</code></td>
<td>
<p>Index of subsets.</p>
</td></tr>
<tr><td><code id="evaluate_independence_+3A_pheno">pheno</code></td>
<td>
<p>A data.frame with the information about the samples.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector with the p-values of the chisq.test between the
category and the subset.
</p>


<h3>See Also</h3>

<p>Other functions to evaluate samples: 
<code><a href="#topic+evaluate_entropy">evaluate_entropy</a>()</code>,
<code><a href="#topic+evaluate_index">evaluate_index</a>()</code>,
<code><a href="#topic+evaluate_mad">evaluate_mad</a>()</code>,
<code><a href="#topic+evaluate_mean">evaluate_mean</a>()</code>,
<code><a href="#topic+evaluate_na">evaluate_na</a>()</code>,
<code><a href="#topic+evaluate_orig">evaluate_orig</a>()</code>,
<code><a href="#topic+evaluate_sd">evaluate_sd</a>()</code>
</p>
<p>Other functions to evaluate categories: 
<code><a href="#topic+evaluate_entropy">evaluate_entropy</a>()</code>,
<code><a href="#topic+evaluate_na">evaluate_na</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(survey, package = "MASS")
index &lt;- design(survey[, c("Sex", "Smoke", "Age")], size_subset = 50,
                iterations = 10)
# Note that numeric columns will be omitted:
evaluate_independence(index, survey[, c("Sex", "Smoke", "Age")])
</code></pre>

<hr>
<h2 id='evaluate_index'>Evaluates a data.frame</h2><span id='topic+evaluate_index'></span>

<h3>Description</h3>

<p>Measures several indicators per group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_index(i, pheno)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_index_+3A_i">i</code></td>
<td>
<p>Index</p>
</td></tr>
<tr><td><code id="evaluate_index_+3A_pheno">pheno</code></td>
<td>
<p>Data.frame with information about the samples</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An array of three dimensions with the mean, standard deviation
(<code><a href="stats.html#topic+sd">sd()</a></code>), and median absolute deviation (<code><a href="stats.html#topic+mad">mad()</a></code>) of the numeric variables, the
entropy of the categorical and the number of <code>NA</code> by each subgroup.
</p>


<h3>See Also</h3>

<p>If you have already an index you can use <code><a href="#topic+use_index">use_index()</a></code>.
</p>
<p>Other functions to evaluate samples: 
<code><a href="#topic+evaluate_entropy">evaluate_entropy</a>()</code>,
<code><a href="#topic+evaluate_independence">evaluate_independence</a>()</code>,
<code><a href="#topic+evaluate_mad">evaluate_mad</a>()</code>,
<code><a href="#topic+evaluate_mean">evaluate_mean</a>()</code>,
<code><a href="#topic+evaluate_na">evaluate_na</a>()</code>,
<code><a href="#topic+evaluate_orig">evaluate_orig</a>()</code>,
<code><a href="#topic+evaluate_sd">evaluate_sd</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(survey, package = "MASS")
index &lt;- create_subset(nrow(survey), 50, 5)
ev_index &lt;- evaluate_index(index, survey[, c("Sex", "Smoke")])
ev_index["entropy", , ]
</code></pre>

<hr>
<h2 id='evaluate_mad'>Evaluate median absolute deviation</h2><span id='topic+evaluate_mad'></span>

<h3>Description</h3>

<p>Looks for the median absolute deviation values in each subgroup.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_mad(i, pheno)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_mad_+3A_i">i</code></td>
<td>
<p>List of indices</p>
</td></tr>
<tr><td><code id="evaluate_mad_+3A_pheno">pheno</code></td>
<td>
<p>Data.frame with information about the samples</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the mean difference between the median absolute deviation
of each group and the original mad.
</p>


<h3>See Also</h3>

<p>Other functions to evaluate samples: 
<code><a href="#topic+evaluate_entropy">evaluate_entropy</a>()</code>,
<code><a href="#topic+evaluate_independence">evaluate_independence</a>()</code>,
<code><a href="#topic+evaluate_index">evaluate_index</a>()</code>,
<code><a href="#topic+evaluate_mean">evaluate_mean</a>()</code>,
<code><a href="#topic+evaluate_na">evaluate_na</a>()</code>,
<code><a href="#topic+evaluate_orig">evaluate_orig</a>()</code>,
<code><a href="#topic+evaluate_sd">evaluate_sd</a>()</code>
</p>
<p>Other functions to evaluate numbers: 
<code><a href="#topic+evaluate_mean">evaluate_mean</a>()</code>,
<code><a href="#topic+evaluate_na">evaluate_na</a>()</code>,
<code><a href="#topic+evaluate_sd">evaluate_sd</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(survey, package = "MASS")
index &lt;- design(survey[, c("Sex", "Smoke", "Age")], size_subset = 50,
                iterations = 10)
# Note that categorical columns will be omitted:
evaluate_mad(index, survey[, c("Sex", "Smoke", "Age")])
</code></pre>

<hr>
<h2 id='evaluate_mean'>Evaluates the mean of the numeric values</h2><span id='topic+evaluate_mean'></span>

<h3>Description</h3>

<p>Looks for the mean of the numeric values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_mean(i, pheno)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_mean_+3A_i">i</code></td>
<td>
<p>List of indices</p>
</td></tr>
<tr><td><code id="evaluate_mean_+3A_pheno">pheno</code></td>
<td>
<p>Data.frame with information about the samples</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the mean value for each column for each subset
</p>


<h3>See Also</h3>

<p>Other functions to evaluate samples: 
<code><a href="#topic+evaluate_entropy">evaluate_entropy</a>()</code>,
<code><a href="#topic+evaluate_independence">evaluate_independence</a>()</code>,
<code><a href="#topic+evaluate_index">evaluate_index</a>()</code>,
<code><a href="#topic+evaluate_mad">evaluate_mad</a>()</code>,
<code><a href="#topic+evaluate_na">evaluate_na</a>()</code>,
<code><a href="#topic+evaluate_orig">evaluate_orig</a>()</code>,
<code><a href="#topic+evaluate_sd">evaluate_sd</a>()</code>
</p>
<p>Other functions to evaluate numbers: 
<code><a href="#topic+evaluate_mad">evaluate_mad</a>()</code>,
<code><a href="#topic+evaluate_na">evaluate_na</a>()</code>,
<code><a href="#topic+evaluate_sd">evaluate_sd</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(survey, package = "MASS")
index &lt;- design(survey[, c("Sex", "Smoke", "Age")], size_subset = 50,
                iterations = 10)
# Note that categorical columns will be omitted:
evaluate_mean(index, survey[, c("Sex", "Smoke", "Age")])
</code></pre>

<hr>
<h2 id='evaluate_na'>Evaluate the dispersion of NAs</h2><span id='topic+evaluate_na'></span>

<h3>Description</h3>

<p>Looks how are <code>NA</code> distributed in each subset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_na(i, pheno)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_na_+3A_i">i</code></td>
<td>
<p>list of numeric indices of the data.frame</p>
</td></tr>
<tr><td><code id="evaluate_na_+3A_pheno">pheno</code></td>
<td>
<p>Data.frame</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The optimum value to reduce
</p>


<h3>See Also</h3>

<p>Other functions to evaluate samples: 
<code><a href="#topic+evaluate_entropy">evaluate_entropy</a>()</code>,
<code><a href="#topic+evaluate_independence">evaluate_independence</a>()</code>,
<code><a href="#topic+evaluate_index">evaluate_index</a>()</code>,
<code><a href="#topic+evaluate_mad">evaluate_mad</a>()</code>,
<code><a href="#topic+evaluate_mean">evaluate_mean</a>()</code>,
<code><a href="#topic+evaluate_orig">evaluate_orig</a>()</code>,
<code><a href="#topic+evaluate_sd">evaluate_sd</a>()</code>
</p>
<p>Other functions to evaluate categories: 
<code><a href="#topic+evaluate_entropy">evaluate_entropy</a>()</code>,
<code><a href="#topic+evaluate_independence">evaluate_independence</a>()</code>
</p>
<p>Other functions to evaluate numbers: 
<code><a href="#topic+evaluate_mad">evaluate_mad</a>()</code>,
<code><a href="#topic+evaluate_mean">evaluate_mean</a>()</code>,
<code><a href="#topic+evaluate_sd">evaluate_sd</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>samples &lt;- 10
m &lt;- matrix(rnorm(samples), nrow = samples)
m[sample(seq_len(samples), size = 5), ] &lt;- NA # Some NA
i &lt;- create_subset(samples, 3, 4) # random subsets
evaluate_na(i, m)
</code></pre>

<hr>
<h2 id='evaluate_orig'>Evaluate each variable provided</h2><span id='topic+evaluate_orig'></span>

<h3>Description</h3>

<p>Measure some summary statistics of the whole cohort of samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_orig(pheno)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_orig_+3A_pheno">pheno</code></td>
<td>
<p>Data.frame with information about the samples</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the mean, standard deviation, MAD values of the
numeric variables, the entropy of the categorical, and the amount of
<code>NA</code> per variable.
</p>


<h3>See Also</h3>

<p>Other functions to evaluate samples: 
<code><a href="#topic+evaluate_entropy">evaluate_entropy</a>()</code>,
<code><a href="#topic+evaluate_independence">evaluate_independence</a>()</code>,
<code><a href="#topic+evaluate_index">evaluate_index</a>()</code>,
<code><a href="#topic+evaluate_mad">evaluate_mad</a>()</code>,
<code><a href="#topic+evaluate_mean">evaluate_mean</a>()</code>,
<code><a href="#topic+evaluate_na">evaluate_na</a>()</code>,
<code><a href="#topic+evaluate_sd">evaluate_sd</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(survey, package = "MASS")
evaluate_orig(survey[, c("Sex", "Age", "Smoke")])
</code></pre>

<hr>
<h2 id='evaluate_sd'>Evaluates the mean of the numeric values</h2><span id='topic+evaluate_sd'></span>

<h3>Description</h3>

<p>Looks for the standard deviation of the numeric values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_sd(i, pheno)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_sd_+3A_i">i</code></td>
<td>
<p>List of indices</p>
</td></tr>
<tr><td><code id="evaluate_sd_+3A_pheno">pheno</code></td>
<td>
<p>Data.frame with the samples</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the standard deviation value for each column for each
subset
</p>


<h3>See Also</h3>

<p>Other functions to evaluate samples: 
<code><a href="#topic+evaluate_entropy">evaluate_entropy</a>()</code>,
<code><a href="#topic+evaluate_independence">evaluate_independence</a>()</code>,
<code><a href="#topic+evaluate_index">evaluate_index</a>()</code>,
<code><a href="#topic+evaluate_mad">evaluate_mad</a>()</code>,
<code><a href="#topic+evaluate_mean">evaluate_mean</a>()</code>,
<code><a href="#topic+evaluate_na">evaluate_na</a>()</code>,
<code><a href="#topic+evaluate_orig">evaluate_orig</a>()</code>
</p>
<p>Other functions to evaluate numbers: 
<code><a href="#topic+evaluate_mad">evaluate_mad</a>()</code>,
<code><a href="#topic+evaluate_mean">evaluate_mean</a>()</code>,
<code><a href="#topic+evaluate_na">evaluate_na</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(survey, package = "MASS")
index &lt;- design(survey[, c("Sex", "Smoke", "Age")], size_subset = 50,
                iterations = 10)
# Note that categorical columns will be omitted:
evaluate_sd(index, survey[, c("Sex", "Smoke", "Age")])
</code></pre>

<hr>
<h2 id='extreme_cases'>Select the subset of extreme cases to evaluation</h2><span id='topic+extreme_cases'></span>

<h3>Description</h3>

<p>Subset some samples that are mostly different.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extreme_cases(pheno, size, omit = NULL, iterations = 500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extreme_cases_+3A_pheno">pheno</code></td>
<td>
<p>Data.frame with the sample information.</p>
</td></tr>
<tr><td><code id="extreme_cases_+3A_size">size</code></td>
<td>
<p>The number of samples to subset.</p>
</td></tr>
<tr><td><code id="extreme_cases_+3A_omit">omit</code></td>
<td>
<p>Name of the columns of the <code>pheno</code> that will be omitted.</p>
</td></tr>
<tr><td><code id="extreme_cases_+3A_iterations">iterations</code></td>
<td>
<p>Numeric value of iterations that will be performed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the number of the rows that are selected.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+optimum">optimum()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>metadata &lt;- expand.grid(height = seq(60, 80, 5), weight = seq(100, 300, 50),
 sex = c("Male","Female"))
sel &lt;- extreme_cases(metadata, 10)
# We can see that it selected both Female and Males and wide range of height
# and weight:
metadata[sel, ]
</code></pre>

<hr>
<h2 id='follow_up'>Follow up experiments</h2><span id='topic+follow_up'></span>

<h3>Description</h3>

<p>If an experiment was carried out with some samples and you want to continue
with some other samples later on.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>follow_up(
  original,
  follow_up,
  size_subset,
  omit = NULL,
  old_new = "batch",
  iterations = 500
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="follow_up_+3A_original">original</code></td>
<td>
<p>A <code>data.frame</code> with the information of the samples used originally.</p>
</td></tr>
<tr><td><code id="follow_up_+3A_follow_up">follow_up</code></td>
<td>
<p>A <code>data.frame</code> with the information of the new samples.</p>
</td></tr>
<tr><td><code id="follow_up_+3A_size_subset">size_subset</code></td>
<td>
<p>Numeric value of the number of sample per batch.</p>
</td></tr>
<tr><td><code id="follow_up_+3A_omit">omit</code></td>
<td>
<p>Name of the columns of the <code>pheno</code> that will be omitted.</p>
</td></tr>
<tr><td><code id="follow_up_+3A_old_new">old_new</code></td>
<td>
<p>Name of the column where the batch status will be stored. If
it matches the name of a column in original it will be used to find previous
batches.</p>
</td></tr>
<tr><td><code id="follow_up_+3A_iterations">iterations</code></td>
<td>
<p>Numeric value of iterations that will be performed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with the common columns of data, a new column
<code>old_new</code>, and a batch column filled with the new batches needed.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+follow_up2">follow_up2()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(survey, package = "MASS")
survey1 &lt;- survey[1:118, ]
survey2 &lt;- survey[119:nrow(survey), ]
folu &lt;- follow_up(survey1, survey2, size_subset = 50, iterations = 10)
</code></pre>

<hr>
<h2 id='follow_up2'>Follow up experiments in batches</h2><span id='topic+follow_up2'></span>

<h3>Description</h3>

<p>Design experiment with all the data new and old together.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>follow_up2(all_data, batch_column = "batch", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="follow_up2_+3A_all_data">all_data</code></td>
<td>
<p>A <code>data.frame</code> with all the data about the samples.
Each row is a sample.</p>
</td></tr>
<tr><td><code id="follow_up2_+3A_batch_column">batch_column</code></td>
<td>
<p>The name of the column of <code>all_data</code> with the batches used.
If NA it is interpreted as a new data, if not empty it is considered a batch.</p>
</td></tr>
<tr><td><code id="follow_up2_+3A_...">...</code></td>
<td>

<p>Arguments passed on to <code><a href="#topic+design">design</a></code>
</p>

<dl>
<dt><code>size_subset</code></dt><dd><p>Numeric value of the number of sample per batch.</p>
</dd>
<dt><code>omit</code></dt><dd><p>Name of the columns of the <code>pheno</code> that will be omitted.</p>
</dd>
<dt><code>iterations</code></dt><dd><p>Numeric value of iterations that will be performed.</p>
</dd>
<dt><code>name</code></dt><dd><p>A character used to name the subsets, either a single one or a
vector the same size as <code>n</code>.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Details</h3>

<p>If the <code>batch_column</code> is empty the samples are considered new.
If the <code>size_subset</code> is missing, it will be estimated from the previous batch
Similarly, iterations and name will be guessed or inferred from the samples.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with the <code>batch_column</code> filled with the new batches needed.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+follow_up">follow_up()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(survey, package = "MASS")
# Create the first batch
first_batch_n &lt;- 118
variables &lt;- c("Sex", "Smoke", "Age")
survey1 &lt;- survey[seq_len(first_batch_n), variables]
index1 &lt;- design(survey1, size_subset = 50, iterations = 10)
r_survey &lt;- inspect(index1, survey1)
# Create the second batch with "new" students
survey2 &lt;- survey[seq(from = first_batch_n +1, to = nrow(survey)), variables]
survey2$batch &lt;- NA
# Prepare the follow up
all_classroom &lt;- rbind(r_survey, survey2)
follow_up2(all_classroom, size_subset = 50, iterations = 10)
</code></pre>

<hr>
<h2 id='inspect'>Inspect the index</h2><span id='topic+inspect'></span>

<h3>Description</h3>

<p>Given the index and the data of the samples append the batch assignment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inspect(i, pheno, omit = NULL, index_name = "batch")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inspect_+3A_i">i</code></td>
<td>
<p>List of indices of samples per batch</p>
</td></tr>
<tr><td><code id="inspect_+3A_pheno">pheno</code></td>
<td>
<p>Data.frame with the sample information.</p>
</td></tr>
<tr><td><code id="inspect_+3A_omit">omit</code></td>
<td>
<p>Name of the columns of the <code>pheno</code> that will be omitted.</p>
</td></tr>
<tr><td><code id="inspect_+3A_index_name">index_name</code></td>
<td>
<p>Column name of the index of the resulting data.frame.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The data.frame with a new column batch with the name of the batch the sample goes to.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(survey, package = "MASS")
columns &lt;- c("Sex", "Age", "Smoke")
index &lt;- design(pheno = survey[, columns], size_subset = 70,
                iterations = 10)
batches &lt;- inspect(index, survey[, columns])
head(batches)
</code></pre>

<hr>
<h2 id='optimum'>Optimum values for batches</h2><span id='topic+optimum'></span><span id='topic+optimum_batches'></span><span id='topic+optimum_subset'></span><span id='topic+sizes_batches'></span>

<h3>Description</h3>

<p>Calculates the optimum values for number of batches or size of the batches.
If you need to do several batches it can be better to distribute it evenly
and add replicates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimum_batches(size_data, size_subset)

optimum_subset(size_data, batches)

sizes_batches(size_data, size_subset, batches)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimum_+3A_size_data">size_data</code></td>
<td>
<p>A numeric value of the number of samples to use.</p>
</td></tr>
<tr><td><code id="optimum_+3A_size_subset">size_subset</code></td>
<td>
<p>Numeric value of the number of sample per batch.</p>
</td></tr>
<tr><td><code id="optimum_+3A_batches">batches</code></td>
<td>
<p>A numeric value of the number of batches.</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt><code>optimum_batches</code></dt><dd><p>A numeric value with the number of batches to
use.</p>
</dd>
<dt><code>optimum_subset</code></dt><dd><p>A numeric value with the maximum number of samples
per batch of the data.</p>
</dd>
<dt><code>sizes_batches</code></dt><dd><p>A numeric vector with the number of samples in each
batch.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>size_data &lt;- 50
size_batch &lt;- 24
(batches &lt;- optimum_batches(size_data, size_batch))
# So now the best number of samples for each batch is less than the available
(size &lt;- optimum_subset(size_data, batches))
# The distribution of samples per batch
sizes_batches(size_data, size, batches)
</code></pre>

<hr>
<h2 id='position_name'>Create position names for a grid.</h2><span id='topic+position_name'></span>

<h3>Description</h3>

<p>Create position names for a grid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>position_name(rows, columns)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="position_name_+3A_rows">rows</code></td>
<td>
<p>Names of the rows.</p>
</td></tr>
<tr><td><code id="position_name_+3A_columns">columns</code></td>
<td>
<p>Names of the columns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with the rows and columns and the resulting name row+column.
The name column is a factor for easier sorting in row, column order.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>position_name(c("A", "B"), 1:2)
</code></pre>

<hr>
<h2 id='qcSubset'>Random subset</h2><span id='topic+qcSubset'></span>

<h3>Description</h3>

<p>Select randomly some samples from an index
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qcSubset(index, size, each = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qcSubset_+3A_index">index</code></td>
<td>
<p>A list of indices indicating which samples go to which subset.</p>
</td></tr>
<tr><td><code id="qcSubset_+3A_size">size</code></td>
<td>
<p>The number of samples that should be taken.</p>
</td></tr>
<tr><td><code id="qcSubset_+3A_each">each</code></td>
<td>
<p>A logical value if the subset should be taken from all the
samples or for each batch.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(50)
index &lt;- create_subset(100, 50, 2)
QC_samples &lt;- qcSubset(index, 10)
QC_samplesBatch &lt;- qcSubset(index, 10, TRUE)
</code></pre>

<hr>
<h2 id='replicates'>Design a batch experiment with experimental controls</h2><span id='topic+replicates'></span>

<h3>Description</h3>

<p>To ensure that the batches are comparable some samples are processed in each
batch. This function allows to take into account that effect.
It uses the most different samples as controls as defined with <code><a href="#topic+extreme_cases">extreme_cases()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replicates(pheno, size_subset, controls, omit = NULL, iterations = 500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="replicates_+3A_pheno">pheno</code></td>
<td>
<p>Data.frame with the sample information.</p>
</td></tr>
<tr><td><code id="replicates_+3A_size_subset">size_subset</code></td>
<td>
<p>Numeric value of the number of sample per batch.</p>
</td></tr>
<tr><td><code id="replicates_+3A_controls">controls</code></td>
<td>
<p>The numeric value of the amount of technical controls per
batch.</p>
</td></tr>
<tr><td><code id="replicates_+3A_omit">omit</code></td>
<td>
<p>Name of the columns of the <code>pheno</code> that will be omitted.</p>
</td></tr>
<tr><td><code id="replicates_+3A_iterations">iterations</code></td>
<td>
<p>Numeric value of iterations that will be performed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To control for variance replicates are important, see for example <a href="https://www.nature.com/articles/nmeth.3091">https://www.nature.com/articles/nmeth.3091</a>.
</p>


<h3>Value</h3>

<p>A index with some samples duplicated in the batches.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+design">design()</a></code>, <code><a href="#topic+extreme_cases">extreme_cases()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>samples &lt;- data.frame(L = letters[1:25], Age = rnorm(25),
                      type = sample(LETTERS[1:5], 25, TRUE))
index &lt;- replicates(samples, 5, controls = 2, omit = "L", iterations = 10)
head(index)
</code></pre>

<hr>
<h2 id='spatial'>Distribute the sample on the plate</h2><span id='topic+spatial'></span>

<h3>Description</h3>

<p>This function assumes that to process the batch the samples are distributed in
a plate with a grid scheme.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatial(
  index,
  pheno,
  omit = NULL,
  remove_positions = NULL,
  rows = LETTERS[1:5],
  columns = 1:10,
  iterations = 500
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spatial_+3A_index">index</code></td>
<td>
<p>A list with the samples on each subgroup, as provided from
<code><a href="#topic+design">design()</a></code> or <code><a href="#topic+replicates">replicates()</a></code>.</p>
</td></tr>
<tr><td><code id="spatial_+3A_pheno">pheno</code></td>
<td>
<p>Data.frame with the sample information.</p>
</td></tr>
<tr><td><code id="spatial_+3A_omit">omit</code></td>
<td>
<p>Name of the columns of the <code>pheno</code> that will be omitted.</p>
</td></tr>
<tr><td><code id="spatial_+3A_remove_positions">remove_positions</code></td>
<td>
<p>Character, name of positions to be avoided in the grid.</p>
</td></tr>
<tr><td><code id="spatial_+3A_rows">rows</code></td>
<td>
<p>Character, name of the rows to be used.</p>
</td></tr>
<tr><td><code id="spatial_+3A_columns">columns</code></td>
<td>
<p>Character, name of the rows to be used.</p>
</td></tr>
<tr><td><code id="spatial_+3A_iterations">iterations</code></td>
<td>
<p>Numeric value of iterations that will be performed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The indices of which samples go with which batch.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(survey, package = "MASS")
index &lt;- design(survey[, c("Sex", "Smoke", "Age")], size_subset = 50,
                iterations = 10)
index2 &lt;- spatial(index, survey[, c("Sex", "Smoke", "Age")], iterations = 10)
head(index2)
</code></pre>

<hr>
<h2 id='use_index'>Convert a factor to index</h2><span id='topic+use_index'></span>

<h3>Description</h3>

<p>Convert a given factor to an accepted index
</p>


<h3>Usage</h3>

<pre><code class='language-R'>use_index(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="use_index_+3A_x">x</code></td>
<td>
<p>A character or a factor to be used as index</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>You can use <code><a href="#topic+evaluate_index">evaluate_index()</a></code> to evaluate how good an
index is. For the inverse look at  <code><a href="#topic+batch_names">batch_names()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plates &lt;- c("P1", "P2", "P1", "P2", "P2", "P3", "P1", "P3", "P1", "P1")
use_index(plates)
</code></pre>

<hr>
<h2 id='valid_followup'>Check the data for a follow up experiment.</h2><span id='topic+valid_followup'></span>

<h3>Description</h3>

<p>Sometimes some samples are collected and analyzed, later another batch of
samples is analyzed.
This function tries to detect if there are problems with the data or when
the data is combined in a single analysis.
To know specific problems with the data you need to use check_data()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>valid_followup(
  old_data = NULL,
  new_data = NULL,
  all_data = NULL,
  omit = NULL,
  column = "batch"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="valid_followup_+3A_old_data">old_data</code>, <code id="valid_followup_+3A_new_data">new_data</code></td>
<td>
<p>A data.frame with the old and new data respectively.</p>
</td></tr>
<tr><td><code id="valid_followup_+3A_all_data">all_data</code></td>
<td>
<p>A <code>data.frame</code> with all the data about the samples.
Each row is a sample.</p>
</td></tr>
<tr><td><code id="valid_followup_+3A_omit">omit</code></td>
<td>
<p>Name of the columns of the <code>pheno</code> that will be omitted.</p>
</td></tr>
<tr><td><code id="valid_followup_+3A_column">column</code></td>
<td>
<p>The name of the column where the old data has the batch
information, or whether the data is new or not (<code>NA</code>) in the case of all_data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Called by its side effects of warnings, but returns a logical value
if there are some issues (<code>FALSE</code>) or not (<code>TRUE</code>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+check_data">check_data()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(survey, package = "MASS")
survey1 &lt;- survey[1:118, ]
survey2 &lt;- survey[119:nrow(survey), ]
valid_followup(survey1, survey2)
survey$batch &lt;- NA
survey$batch[1:118]  &lt;- "old"
valid_followup(all_data = survey)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
