<!DOCTYPE html><html><head><title>Help for package SightabilityModel</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SightabilityModel}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SightabilityModel-package'><p>Wildlife Sightability Modeling</p></a></li>
<li><a href='#check.sightability.model.args'><p>Check the sightability model arguments for consistency</p></a></li>
<li><a href='#compute.detect.prob'><p>Compute the detection probability given a sightability model</p></a></li>
<li><a href='#compute.SCF'><p>Compute the sightability correction factor given a sightability and covariates</p></a></li>
<li><a href='#covtheta'><p>Estimates var/cov matrix of inflation factors (1/prob detection) using a</p>
non-parametric bootstrap.</a></li>
<li><a href='#exp.m'><p>Experimental (test trials) data set used to estimate detection probabilities</p>
for moose in MN</a></li>
<li><a href='#g.fit'><p>Mountain Goat Sightability Model Information</p></a></li>
<li><a href='#gdat'><p>Mountain Goat Survey Data from Olympic National park</p></a></li>
<li><a href='#MoosePopR'><p>R function that gives the same functionality as the MoosePop program.</p></a></li>
<li><a href='#MoosePopR_DomStrat'><p>Classical and Domain Stratification using MoosePopR()</p></a></li>
<li><a href='#MoosePopR_DomStrat_bootrep'><p>Generate a bootstrap replicate of data for call to MoosePopR_DomStrat()</p></a></li>
<li><a href='#obs.m'><p>MN moose survey data</p></a></li>
<li><a href='#print.sightest'><p>Print method for sightability estimators</p></a></li>
<li><a href='#sampinfo.m'><p>Data set containing sampling information for observation survey of moose in</p>
MN</a></li>
<li><a href='#Sight.Est'><p>Sightability Model Estimator</p></a></li>
<li><a href='#Sight.Est.Ratio'><p>Sightability Model Estimator - Ratio of variables</p></a></li>
<li><a href='#SightabilityPopR'><p>R function that interfaces with the SightabilityModel package and gives similar functionality</p>
as the AerialSurvey program</a></li>
<li><a href='#SightabilityPopR_DomStrat'><p>Classical and Domain Stratification using SightabilityPopR()</p></a></li>
<li><a href='#SS.est'><p>Sightability estimate with variance components estimator from Steinhorst and</p>
Samuel (1989) and Samuel et al. (1992).</a></li>
<li><a href='#SS.est.Ratio'><p>Sightability estimate or ratio with variance components estimator from</p>
Steinhorst and Samuel (1989) and Samuel et al. (1992).  This is merely a
stub and has not been implemented.</a></li>
<li><a href='#summary.sightest'><p>Summarize sightability estimator</p></a></li>
<li><a href='#vardiff'><p>Function to estimate the variance of the difference between two population</p>
estimates</a></li>
<li><a href='#varlog.lam'><p>Calculates the variance of the log rate of change between 2 population</p>
estimates that rely on the same sightability model.</a></li>
<li><a href='#Wong.est'><p>Sightability estimate with variance components estimator from Wong (1996)</p></a></li>
<li><a href='#Wong.est.Ratio'><p>Sightability estimate of ratio with variance components estimator from Wong</p>
(1996)</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Wildlife Sightability Modeling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-19</td>
</tr>
<tr>
<td>Description:</td>
<td>Uses logistic regression to model the probability of detection as a function of covariates. 
             This model is then used with observational survey data to estimate population size, while
             accounting for uncertain detection.  See Steinhorst and Samuel (1989).</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jfieberg/SightabilityModel">https://github.com/jfieberg/SightabilityModel</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>formula.tools, Matrix, msm, plyr, mvtnorm, stats, survey,
utils</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>car, data.table, GGally, ggplot2, kableExtra, knitr, readxl,
reshape2, rmarkdown, tidyr, R.rsp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp, knitr, rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-19 21:45:51 UTC; cschwarz</td>
</tr>
<tr>
<td>Author:</td>
<td>Fieberg John [aut],
  Schwarz Carl James [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Schwarz Carl James &lt;cschwarz.stat.sfu.ca@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-19 22:02:31 UTC</td>
</tr>
</table>
<hr>
<h2 id='SightabilityModel-package'>Wildlife Sightability Modeling</h2><span id='topic+SightabilityModel-package'></span><span id='topic+SightabilityModel'></span>

<h3>Description</h3>

<p>Uses logistic regression to model the probability of detection as a function
of covariates.  This model is then used with observational survey data to
estimate population size, while accounting for uncertain detection.  See
Steinhorst and Samuel (1989).
</p>


<h3>Author(s)</h3>

<p>John Fieberg
</p>
<p>Maintainer: John Fieberg &lt;jfieberg@umn.edu&gt;, Carl James Schwarz &lt;cschwarz.stat.sfu.ca@gmail.com&gt;
</p>


<h3>References</h3>

<p>Fieberg, J.  2012.  Estimating Population Abundance Using
Sightability Models: R SightabilityModel Package. Journal of Statistical
Software, 51(9), 1-20.  URL https://doi.org/10.18637/jss.v051.i09 
</p>
<p>Steinhorst, Kirk R. and Samuel, Michael D. 1989. Sightability Adjustment
Methods for Aerial Surveys of Wildlife Populations. Biometrics 45:415&ndash;425.
</p>

<hr>
<h2 id='check.sightability.model.args'>Check the sightability model arguments for consistency</h2><span id='topic+check.sightability.model.args'></span>

<h3>Description</h3>

<p>Check the sightability model arguments for consistency
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.sightability.model.args(data, sight.model, sight.beta, sight.beta.cov)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check.sightability.model.args_+3A_data">data</code></td>
<td>
<p>Data.frame containing covariates for sightability model</p>
</td></tr>
<tr><td><code id="check.sightability.model.args_+3A_sight.model">sight.model</code></td>
<td>
<p>Formula with sightability model</p>
</td></tr>
<tr><td><code id="check.sightability.model.args_+3A_sight.beta">sight.beta</code></td>
<td>
<p>Parameter estimates (from fitted sightability model</p>
</td></tr>
<tr><td><code id="check.sightability.model.args_+3A_sight.beta.cov">sight.beta.cov</code></td>
<td>
<p>Estimated variance-covariance matrix for  parameter estimates
from fitted sightability model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Error condition or invisible
</p>


<h3>Author(s)</h3>

<p>Schwarz, C. J. <a href="mailto:cschwarz.stat.sfu.ca@gmail.com">cschwarz.stat.sfu.ca@gmail.com</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sightability.table &lt;- data.frame(VegCoverClass=1:5)
sight.beta &lt;- c(4.2138, -1.5847)
sight.beta.cov &lt;- matrix(c(0.7821634, -0.2820000,-0.2820000,  0.1114892), nrow=2)
check.sightability.model.args( sightability.table, 
                               ~VegCoverClass, 
                               sight.beta, 
                               sight.beta.cov)
## Not run: 
check.sightability.model.args( sightability.table, 
                              ~VegCoverClass2, 
                              sight.beta,
                              sight.beta.cov)
check.sightability.model.args( sightability.table, 
                               ~VegCoverClass,
                                sight.beta[1],
                               sight.beta.cov)

## End(Not run)

</code></pre>

<hr>
<h2 id='compute.detect.prob'>Compute the detection probability given a sightability model</h2><span id='topic+compute.detect.prob'></span>

<h3>Description</h3>

<p>Compute the detection probability given a sightability model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute.detect.prob(
  data,
  sight.model,
  sight.beta,
  sight.beta.cov,
  check.args = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute.detect.prob_+3A_data">data</code></td>
<td>
<p>Data.frame containing covariates for sightability model</p>
</td></tr>
<tr><td><code id="compute.detect.prob_+3A_sight.model">sight.model</code></td>
<td>
<p>Formula with sightability model</p>
</td></tr>
<tr><td><code id="compute.detect.prob_+3A_sight.beta">sight.beta</code></td>
<td>
<p>Parameter estimates (from fitted sightability model</p>
</td></tr>
<tr><td><code id="compute.detect.prob_+3A_sight.beta.cov">sight.beta.cov</code></td>
<td>
<p>Estimated variance-covariance matrix for  parameter estimates
from fitted sightability model.</p>
</td></tr>
<tr><td><code id="compute.detect.prob_+3A_check.args">check.args</code></td>
<td>
<p>Should the sightability model arguments be checked for consistency/</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of detection probabilities
</p>


<h3>Author(s)</h3>

<p>Schwarz, C. J. <a href="mailto:cschwarz.stat.sfu.ca@gmail.com">cschwarz.stat.sfu.ca@gmail.com</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+compute.SCF">compute.SCF</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sightability.table &lt;- data.frame(VegCoverClass=1:5)
sight.beta &lt;- c(4.2138, -1.5847)
sight.beta.cov &lt;- matrix(c(0.7821634, -0.2820000,-0.2820000,  0.1114892), nrow=2)
sightability.table$detect.prob &lt;- compute.detect.prob( sightability.table, 
                                                      ~VegCoverClass, 
                                                      sight.beta, 
                                                      sight.beta.cov)
sightability.table$SCF         &lt;- compute.SCF        ( sightability.table,
                                                       ~VegCoverClass, 
                                                       sight.beta, 
                                                       sight.beta.cov)
sightability.table
#"Note that the SCF != 1/detect.prob because of correction terms for covariance of beta.terms"

</code></pre>

<hr>
<h2 id='compute.SCF'>Compute the sightability correction factor given a sightability and covariates</h2><span id='topic+compute.SCF'></span>

<h3>Description</h3>

<p>Compute the sightability correction factor given a sightability and covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute.SCF(
  data,
  sight.model,
  sight.beta,
  sight.beta.cov,
  check.args = FALSE,
  adjust = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute.SCF_+3A_data">data</code></td>
<td>
<p>Data.frame containing covariates for sightability model</p>
</td></tr>
<tr><td><code id="compute.SCF_+3A_sight.model">sight.model</code></td>
<td>
<p>Formula with sightability model</p>
</td></tr>
<tr><td><code id="compute.SCF_+3A_sight.beta">sight.beta</code></td>
<td>
<p>Parameter estimates (from fitted sightability model</p>
</td></tr>
<tr><td><code id="compute.SCF_+3A_sight.beta.cov">sight.beta.cov</code></td>
<td>
<p>Estimated variance-covariance matrix for  parameter estimates
from fitted sightability model.</p>
</td></tr>
<tr><td><code id="compute.SCF_+3A_check.args">check.args</code></td>
<td>
<p>Should the sightability model arguments be checked for consistency/</p>
</td></tr>
<tr><td><code id="compute.SCF_+3A_adjust">adjust</code></td>
<td>
<p>Should the sightability value be adjusted for the sight.beta.cov.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of sightability factors (SCF)
</p>


<h3>Author(s)</h3>

<p>Schwarz, C. J. <a href="mailto:cschwarz.stat.sfu.ca@gmail.com">cschwarz.stat.sfu.ca@gmail.com</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+compute.detect.prob">compute.detect.prob</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sightability.table &lt;- data.frame(VegCoverClass=1:5)
sight.beta &lt;- c(4.2138, -1.5847)
sight.beta.cov &lt;- matrix(c(0.7821634, -0.2820000,-0.2820000,  0.1114892), nrow=2)
sightability.table$detect.prob &lt;- compute.detect.prob( sightability.table, 
                                                       ~VegCoverClass, 
                                                       sight.beta, 
                                                       sight.beta.cov)
sightability.table$SCF         &lt;- compute.SCF        ( sightability.table, 
                                                       ~VegCoverClass, 
                                                       sight.beta, 
                                                       sight.beta.cov)
sightability.table
#"Note that the SCF != 1/detect.prob because of correction terms for covariance of beta.terms"

</code></pre>

<hr>
<h2 id='covtheta'>Estimates var/cov matrix of inflation factors (1/prob detection) using a
non-parametric bootstrap.</h2><span id='topic+covtheta'></span>

<h3>Description</h3>

<p>Estimates var/cov matrix of inflation factors (1/prob detection) using a
non-parametric bootstrap.  Called by function Sight.Est if Vm.boot = TRUE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covtheta(total, srates, stratum, subunit, covars, betas, varbetas, nboots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covtheta_+3A_total">total</code></td>
<td>
<p>Number of animals in each independently sighted group</p>
</td></tr>
<tr><td><code id="covtheta_+3A_srates">srates</code></td>
<td>
<p>Plot sampling probability (associated with the independently
observed animal groups)</p>
</td></tr>
<tr><td><code id="covtheta_+3A_stratum">stratum</code></td>
<td>
<p>Stratum identifiers (associated with the independently
observed animal groups)</p>
</td></tr>
<tr><td><code id="covtheta_+3A_subunit">subunit</code></td>
<td>
<p>Plot ID (associated with the independently observed animal
groups)</p>
</td></tr>
<tr><td><code id="covtheta_+3A_covars">covars</code></td>
<td>
<p>Matrix of sightability covariates (associated with the
independently observed animal groups)</p>
</td></tr>
<tr><td><code id="covtheta_+3A_betas">betas</code></td>
<td>
<p>Logistic regression parameter estimates (from fitted
sightability model)</p>
</td></tr>
<tr><td><code id="covtheta_+3A_varbetas">varbetas</code></td>
<td>
<p>Estimated variance-covariance matrix for the logistic
regression parameter estimates (from fitted sightability model)</p>
</td></tr>
<tr><td><code id="covtheta_+3A_nboots">nboots</code></td>
<td>
<p>Number of bootstrap resamples.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>smat</code></td>
<td>
<p>Estimated variance-covariance matrix for the inflation
factors theta = (1/probability of detection).  This is an n.animal x
n.animal matrix. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>John Fieberg
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sight.Est">Sight.Est</a></code>
</p>

<hr>
<h2 id='exp.m'>Experimental (test trials) data set used to estimate detection probabilities
for moose in MN</h2><span id='topic+exp.m'></span>

<h3>Description</h3>

<p>Experimental (test trials) data set used to estimate detection probabilities
for moose in MN
</p>


<h3>Format</h3>

<p>A data frame with 124 observations on the following 4 variables.
</p>
 
<dl>
<dt>year</dt><dd><p>year of the experimental survey (test trial)</p>
</dd>
<dt>observed</dt><dd><p>Boolean variable (=1 if moose was observed and 0 otherwise)</p>
</dd> 
<dt>voc</dt><dd><p>measurement of visual obstruction</p>
</dd>
<dt>grpsize</dt><dd><p>group size (number of observed moose in each independently sighted group)</p>
</dd>
</dl>



<h3>References</h3>

<p>Giudice, J H. and Fieberg, J. and Lenarz, M. S.  2012. Spending
Degrees of Freedom in a Poor Economy: A Case Study of Building a
Sightability Model for Moose in Northeastern Minnesota.  Journal of Wildlife
Management 76(1):75-87.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(exp.m)
exp.m[1:5,]

</code></pre>

<hr>
<h2 id='g.fit'>Mountain Goat Sightability Model Information</h2><span id='topic+g.fit'></span>

<h3>Description</h3>

<p>Model averaged regression parameters and unconditional variance-covariance
matrix for mountain goat sightability model (Rice et al. 2009)
</p>


<h3>Format</h3>

<p>The format is: beta.g = list of regression parameters (intercept and
parameters associated with GroupSize, Terrain, and X.VegCover) varbeta.g =
variance-covariance matrix (associated with beta.g)
</p>


<h3>References</h3>

<p>Rice C.G., Jenkins K.J., Chang W.Y. (2009). A Sightability Model
for Mountain Goats. The Journal of Wildlife Management, 73(3), 468-478.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(g.fit)

</code></pre>

<hr>
<h2 id='gdat'>Mountain Goat Survey Data from Olympic National park</h2><span id='topic+gdat'></span>

<h3>Description</h3>

<p>Mountain Goat Survey Data from Olympic National park collected in 2004
</p>


<h3>Format</h3>

<p>A data frame with 113 observations on the following 9 variables.
</p>
 
<dl>
<dt>GroupSize</dt><dd><p>number of animals observed in each
independently sighted group [cluster size]</p>
</dd> 
<dt>Terrain</dt><dd><p>measure
of terrain obstruction</p>
</dd> <dt>pct.VegCover</dt><dd><p>measure of vegetative
obstruction</p>
</dd> <dt>stratum</dt><dd><p>stratum identifier</p>
</dd>
<dt>total</dt><dd><p>number of animals observed in each independently
sighted group [same as GroupSize]</p>
</dd> 
<dt>subunit</dt><dd><p>a numeric vector, Plot ID</p>
</dd> 
</dl>



<h3>Source</h3>

<p>Patti Happe (Patti_Happe@nps.gov)
</p>


<h3>References</h3>

<p>Jenkins, K. J., Happe, P.J., Beirne, K.F, Hoffman, R.A.,
Griffin, P.C., Baccus, W. T., and J. Fieberg.  In press.  Recent population
trends in mountain goats in the Olympic mountains.  Northwest Science.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(gdat)

</code></pre>

<hr>
<h2 id='MoosePopR'>R function that gives the same functionality as the MoosePop program.</h2><span id='topic+MoosePopR'></span>

<h3>Description</h3>

<p>A stratified random sample of blocks in a survey area is conducted.
In each block, groups of moose are observed (usually through an aerial survey).
For each group of moose, the number of moose is recorded along with attributes
such as sex or age.
MoosePopR() assumes that sightability is 100%.
Use the SightabilityPopR() function to adjust for sightability &lt; 100%.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MoosePopR(
  survey.data,
  survey.block.area,
  stratum.data,
  density = NULL,
  abundance = NULL,
  numerator = NULL,
  denominator = NULL,
  block.id.var = "Block.ID",
  block.area.var = "Block.Area",
  stratum.var = "Stratum",
  stratum.blocks.var = "Stratum.Blocks",
  stratum.area.var = "Stratum.Area",
  conf.level = 0.9,
  survey.lonely.psu = "fail"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MoosePopR_+3A_survey.data">survey.data</code></td>
<td>
<p>A data frame containing counts of moose in each group along with a variable identifying 
the stratum (see stratum.var) and block (see block.id.var)</p>
</td></tr>
<tr><td><code id="MoosePopR_+3A_survey.block.area">survey.block.area</code></td>
<td>
<p>A data frame containing for each block, the block id (see block.id.var), the
area of the block (see block.area.var). The data frame can contain information for other blocks that
were not surveyed (e.g. for the entire population of blocks) and information from these
additional blocks will be ignored.</p>
</td></tr>
<tr><td><code id="MoosePopR_+3A_stratum.data">stratum.data</code></td>
<td>
<p>A data frame containing for each stratum, the stratum id (see stratum.var), the total
number of blocks in the stratum (see stratum.blocks.var) and the total area of the stratum (see stratum.area.var)</p>
</td></tr>
<tr><td><code id="MoosePopR_+3A_density">density</code>, <code id="MoosePopR_+3A_abundance">abundance</code>, <code id="MoosePopR_+3A_numerator">numerator</code>, <code id="MoosePopR_+3A_denominator">denominator</code></td>
<td>
<p>Right-handed formula identifying the variable(s) in the
survey.data data frame for which the density, abundance, or ratio (numerator/denominator) are to be estimated.</p>
</td></tr>
<tr><td><code id="MoosePopR_+3A_block.id.var">block.id.var</code></td>
<td>
<p>Name of the variable in the data frames that identifies the block.id (the sampling unit)</p>
</td></tr>
<tr><td><code id="MoosePopR_+3A_block.area.var">block.area.var</code></td>
<td>
<p>Name of the variable in data frames that contains the area of the blocks (area of sampling unit)</p>
</td></tr>
<tr><td><code id="MoosePopR_+3A_stratum.var">stratum.var</code></td>
<td>
<p>Name of the variable in the data frames that identifies the classical stratum</p>
</td></tr>
<tr><td><code id="MoosePopR_+3A_stratum.blocks.var">stratum.blocks.var</code></td>
<td>
<p>Name of the variable in the stratum.data data frame that contains the total number of
blocks in the stratum.</p>
</td></tr>
<tr><td><code id="MoosePopR_+3A_stratum.area.var">stratum.area.var</code></td>
<td>
<p>Name of the variable in the stratum.data data.frame that contains the total stratum area.</p>
</td></tr>
<tr><td><code id="MoosePopR_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level used to create confidence intervals.</p>
</td></tr>
<tr><td><code id="MoosePopR_+3A_survey.lonely.psu">survey.lonely.psu</code></td>
<td>
<p>How to deal with lonely PSU within strata. See <code>surveyoptions</code> in the <code>survey</code> package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing for each stratum and for all strata (identified as stratum id <code>.OVERALL</code>), the density,
or abundance or ratio estimate along with its estimated standard error and large-sample normal-based confidence interval.
</p>


<h3>Author(s)</h3>

<p>Schwarz, C. J. <a href="mailto:cschwarz.stat.sfu.ca@gmail.com">cschwarz.stat.sfu.ca@gmail.com</a>.
</p>


<h3>References</h3>

<p>To Be Added.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
##---- See the vignettes for examples on how to run this analysis.

</code></pre>

<hr>
<h2 id='MoosePopR_DomStrat'>Classical and Domain Stratification using MoosePopR()</h2><span id='topic+MoosePopR_DomStrat'></span>

<h3>Description</h3>

<p>This function allows for classical or domain stratification when using MoosePopR().
Caution **SE are NOT adjusted for measurements on multiple domains on the same
sampling unit. Bootstrapping may be required**. Consult the vignette for more details.
</p>
<p>MoosePopR_DomStrat() assumes that sightability is 100%.
Use the SightabilityPopR_DomStrat() function to adjust for sightability &lt; 100%.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MoosePopR_DomStrat(
  stratum.data,
  selected.unit.data,
  waypoint.data,
  density = NULL,
  abundance = NULL,
  numerator = NULL,
  denominator = NULL,
  stratum.var = "Stratum",
  domain.var = "Domain",
  stratum.total.blocks.var = "Total.Blocks",
  stratum.total.area.var = "Total.Area",
  block.id.var = "Block.ID",
  block.area.var = "Block.Area",
  conf.level = 0.9,
  survey.lonely.psu = "fail"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MoosePopR_DomStrat_+3A_stratum.data">stratum.data</code></td>
<td>
<p>A data frame containing for each combination of stratum and domain, the stratum id (see stratum.var), 
the domain id (see domain.var),
the total number of blocks in the stratum (see stratum.total.blocks.var) and 
the total area of the stratum (see stratum.total.area.var)</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_+3A_selected.unit.data">selected.unit.data</code></td>
<td>
<p>A data frame containing information on the selected survey units. Required variables
are the stratum (see stratum.var), domain (see domain.var), block.id (see block.id.var), and the
area of the block (see block.area.var).</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_+3A_waypoint.data">waypoint.data</code></td>
<td>
<p>A data frame containing counts of moose in each group along with a variable identifying 
the stratum (see stratum.var), domain (see domain.var) and block (see block.id.var). Additional variables can
be included such as covariates for the sightability function (not currently used in MoosePopR)</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_+3A_density">density</code>, <code id="MoosePopR_DomStrat_+3A_abundance">abundance</code>, <code id="MoosePopR_DomStrat_+3A_numerator">numerator</code>, <code id="MoosePopR_DomStrat_+3A_denominator">denominator</code></td>
<td>
<p>Right-handed formula identifying the variable(s) in the
waypoint data frame for which the density, abundance, or ratio (numerator/denominator) are to be estimated.</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_+3A_stratum.var">stratum.var</code></td>
<td>
<p>Name of the variable in the data frames that identifies the classical stratum</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_+3A_domain.var">domain.var</code></td>
<td>
<p>Name of the variable in the data frames that identifies the domain.</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_+3A_stratum.total.blocks.var">stratum.total.blocks.var</code></td>
<td>
<p>Name of the variable in the stratum.data data frame that contains the total number of
blocks in the stratum.</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_+3A_stratum.total.area.var">stratum.total.area.var</code></td>
<td>
<p>Name of the variable in the stratum.data data.frame that contains the total stratum area.</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_+3A_block.id.var">block.id.var</code></td>
<td>
<p>Name of the variable in the data frames that identifies the block.id (the sampling unit)</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_+3A_block.area.var">block.area.var</code></td>
<td>
<p>Name of the variable in data frames that contains the area of the blocks (area of sampling unit)</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level used to create confidence intervals.</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_+3A_survey.lonely.psu">survey.lonely.psu</code></td>
<td>
<p>How to deal with lonely PSU within strata. See <code>surveyoptions</code> in the <code>survey</code> package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing for each stratum and for all combinations of strata and domains
(identified as stratum id <code>.OVERALL</code>), the density,
or abundance or ratio estimate along with its estimated standard error and large-sample normal-based confidence interval.
</p>


<h3>Author(s)</h3>

<p>Schwarz, C. J. <a href="mailto:cschwarz.stat.sfu.ca@gmail.com">cschwarz.stat.sfu.ca@gmail.com</a>.
</p>


<h3>References</h3>

<p>To Be Added.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
##---- See the vignettes for examples on how to run this analysis.

</code></pre>

<hr>
<h2 id='MoosePopR_DomStrat_bootrep'>Generate a bootstrap replicate of data for call to MoosePopR_DomStrat()</h2><span id='topic+MoosePopR_DomStrat_bootrep'></span>

<h3>Description</h3>

<p>This function takes the data from a classical/domain stratification and generates
a bootstrap replicate suitable for analysis using MoosePopR_DomStrat().
A sightability model is allowed which &quot;adjusts&quot; the input data for sightability.
This can also be used for SightabilityPopR() models by forcing block areas to 1 and
the total block area in stratum to the number of blocks to mimic a mean-per-unit estimator.
See the vignette for examples of usage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MoosePopR_DomStrat_bootrep(
  stratum.data,
  selected.unit.data,
  waypoint.data,
  density = NULL,
  abundance = NULL,
  numerator = NULL,
  denominator = NULL,
  sight.model = NULL,
  sight.beta = NULL,
  sight.beta.cov = NULL,
  stratum.var = "Stratum",
  domain.var = "Domain",
  stratum.total.blocks.var = "Total.Blocks",
  stratum.total.area.var = "Total.Area",
  block.id.var = "Block.ID",
  block.area.var = "Block.Area",
  conf.level = 0.9,
  survey.lonely.psu = "fail",
  check.args = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MoosePopR_DomStrat_bootrep_+3A_stratum.data">stratum.data</code></td>
<td>
<p>A data frame containing for each combination of stratum and domain, the stratum id (see stratum.var), 
the domain id (see domain.var),
the total number of blocks in the stratum (see stratum.total.blocks.var) and 
the total area of the stratum (see stratum.total.area.var)</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_bootrep_+3A_selected.unit.data">selected.unit.data</code></td>
<td>
<p>A data frame containing information on the selected survey units. Required variables
are the stratum (see stratum.var), domain (see domain.var), block.id (see block.id.var), and the
area of the block (see block.area.var).</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_bootrep_+3A_waypoint.data">waypoint.data</code></td>
<td>
<p>A data frame containing counts of moose in each group along with a variable identifying 
the stratum (see stratum.var), domain (see domain.var) and block (see block.id.var). Additional variables can
be included such as covariates for the sightability function (not currently used in MoosePopR)</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_bootrep_+3A_density">density</code>, <code id="MoosePopR_DomStrat_bootrep_+3A_abundance">abundance</code>, <code id="MoosePopR_DomStrat_bootrep_+3A_numerator">numerator</code>, <code id="MoosePopR_DomStrat_bootrep_+3A_denominator">denominator</code></td>
<td>
<p>Right-handed formula identifying the variable(s) in the
waypoint data frame for which the density, abundance, or ratio (numerator/denominator) are to be estimated.</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_bootrep_+3A_sight.model">sight.model</code></td>
<td>
<p>A formula that identifies the model used
to estimate sightability. For example <code>observed ~ VegCoverClass</code> would indicate
that sightability is a function of the <code>VegCoverClass</code> variable in the survey 
data. The left hand variable is arbitrary. The right hand variables must be present
in the survey.data data frame.</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_bootrep_+3A_sight.beta">sight.beta</code></td>
<td>
<p>The vector of estimated coefficients for the logistic regression sightability model.</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_bootrep_+3A_sight.beta.cov">sight.beta.cov</code></td>
<td>
<p>The covariance matrix of <code>sight.beta</code></p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_bootrep_+3A_stratum.var">stratum.var</code></td>
<td>
<p>Name of the variable in the data frames that identifies the classical stratum</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_bootrep_+3A_domain.var">domain.var</code></td>
<td>
<p>Name of the variable in the data frames that identifies the domain.</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_bootrep_+3A_stratum.total.blocks.var">stratum.total.blocks.var</code></td>
<td>
<p>Name of the variable in the stratum.data data frame that contains the total number of
blocks in the stratum.</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_bootrep_+3A_stratum.total.area.var">stratum.total.area.var</code></td>
<td>
<p>Name of the variable in the stratum.data data.frame that contains the total stratum area.</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_bootrep_+3A_block.id.var">block.id.var</code></td>
<td>
<p>Name of the variable in the data frames that identifies the block.id (the sampling unit)</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_bootrep_+3A_block.area.var">block.area.var</code></td>
<td>
<p>Name of the variable in data frames that contains the area of the blocks (area of sampling unit)</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_bootrep_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level used to create confidence intervals.</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_bootrep_+3A_survey.lonely.psu">survey.lonely.psu</code></td>
<td>
<p>How to deal with lonely PSU within strata. See <code>surveyoptions</code> in the <code>survey</code> package.</p>
</td></tr>
<tr><td><code id="MoosePopR_DomStrat_bootrep_+3A_check.args">check.args</code></td>
<td>
<p>Should arguments be checked. Turn off for extensive bootstrapping to save time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the input data (<code>input.data</code>), 
the bootstrap replicate (<code>boot.data</code>), and a data frame (<code>boot.res</code>) with the estimated density,
or abundance or ratio along with its estimated standard error and large-sample normal-based confidence interval.
The density/abundance/ratio over all strata is also given on the last line of the data.frame.
</p>


<h3>Author(s)</h3>

<p>Schwarz, C. J. <a href="mailto:cschwarz.stat.sfu.ca@gmail.com">cschwarz.stat.sfu.ca@gmail.com</a>.
</p>


<h3>References</h3>

<p>To Be Added.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
##---- See the vignettes for examples on how to use this function

</code></pre>

<hr>
<h2 id='obs.m'>MN moose survey data</h2><span id='topic+obs.m'></span>

<h3>Description</h3>

<p>Operational survey data for moose in MN (during years 2004-2007).  Each
record corresponds to an independently sighted group of moose, with variables
that capture individual covariates (used in the detection model) as well as
plot-level information (stratum identifier, sampling probability, etc).
</p>


<h3>Format</h3>

<p>A data frame with 805 observations on the following 11 variables.
</p>
 
<dl>
<dt>year</dt><dd><p>year of survey</p>
</dd>
<dt>stratum</dt><dd><p>stratum identifier</p>
</dd> <dt>subunit</dt><dd><p>sample
plot ID</p>
</dd> 
<dt>total</dt><dd><p>number of moose observed</p>
</dd>
<dt>cows</dt><dd><p>number of cows observed</p>
</dd> <dt>calves</dt><dd><p>number of
calves observed</p>
</dd> 
<dt>bulls</dt><dd><p>number of bulls observed</p>
</dd>
<dt>unclass</dt><dd><p>number of unclassified animals observed (could not
identify sex/age class)</p>
</dd> 
<dt>voc</dt><dd><p> measurement of visual
obstruction</p>
</dd> 
<dt>grpsize</dt><dd><p>group size (cluster size)</p>
</dd> 
</dl>



<h3>References</h3>

<p>Giudice, J H. and Fieberg, J. and Lenarz, M. S.  2012. Spending
Degrees of Freedom in a Poor Economy: A Case Study of Building a
Sightability Model for Moose in Northeastern Minnesota.  Journal of Wildlife
Management 76(1):75-87.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(obs.m) 
obs.m[1:5, ]

</code></pre>

<hr>
<h2 id='print.sightest'>Print method for sightability estimators</h2><span id='topic+print.sightest'></span><span id='topic+print.sightest_ratio'></span>

<h3>Description</h3>

<p>Prints fitted sightability model, sampling information, and sightability
estimate (with confidence interval)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sightest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.sightest_+3A_x">x</code></td>
<td>
<p>Sightability object, output from call to Sight.Est() or
Sight.Est.Ratio() functions.</p>
</td></tr>
<tr><td><code id="print.sightest_+3A_...">...</code></td>
<td>
<p>arguments to be passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>John Fieberg and Carl James Schwarz
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sight.Est">Sight.Est</a></code>, <code><a href="#topic+Sight.Est.Ratio">Sight.Est.Ratio</a></code>,
<code><a href="#topic+summary.sightest">summary.sightest</a></code>, <code><a href="#topic+summary.sightest_ratio">summary.sightest_ratio</a></code>
</p>

<hr>
<h2 id='sampinfo.m'>Data set containing sampling information for observation survey of moose in
MN</h2><span id='topic+sampinfo.m'></span>

<h3>Description</h3>

<p>Data set containing sampling information from a survey of moose in MN
(during years 2004-2007)
</p>


<h3>Format</h3>

<p>A data frame with 12 observations on the following 5 variables.
</p>
 
<dl>
<dt>year</dt><dd><p>year of survey</p>
</dd>
<dt>stratum</dt><dd><p>stratum identifier</p>
</dd> 
<dt>Nh</dt><dd><p>number of
population units in stratum h</p>
</dd> 
<dt>nh</dt><dd><p>number of sample units in
stratum h</p>
</dd> 
</dl>



<h3>References</h3>

<p>Giudice, J H. and Fieberg, J. and Lenarz, M. S.  2012. Spending
Degrees of Freedom in a Poor Economy: A Case Study of Building a
Sightability Model for Moose in Northeastern Minnesota.  Journal of Wildlife
Management 76(1):75-87.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(sampinfo.m)
sampinfo.m

</code></pre>

<hr>
<h2 id='Sight.Est'>Sightability Model Estimator</h2><span id='topic+Sight.Est'></span>

<h3>Description</h3>

<p>Estimates population abundance by 1) fitting a sightability (logistic
regression) model to &quot;test trial&quot; data; 2) applying the fitted model to
independent (operational) survey data to correct for detection rates &lt; 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sight.Est(
  form,
  sdat = NULL,
  odat,
  sampinfo,
  method = "Wong",
  logCI = TRUE,
  alpha = 0.05,
  Vm.boot = FALSE,
  nboot = 1000,
  bet = NULL,
  varbet = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sight.Est_+3A_form">form</code></td>
<td>
<p>a symbolic description of the sightability model to be fit
(e.g., &quot;y ~ x1 + x2 + ...&quot;), where y is a binary response variable (= 1 if
the animal is seen and 0 otherwise) and x1, x2, ... are a set of predictor
variables thought to influence detection</p>
</td></tr>
<tr><td><code id="Sight.Est_+3A_sdat">sdat</code></td>
<td>
<p>'sightability' data frame.  Each row represents an independent
sightability trial, and columns contain the response (a binary random
variable = 1 if the animal was observed and 0 otherwise) and the covariates
used to model detection probabilities.</p>
</td></tr>
<tr><td><code id="Sight.Est_+3A_odat">odat</code></td>
<td>
<p>'observational survey' data frame containing the following
variable names (<em>stratum, subunit, total</em>) along with the same
covariates used to model detection probabilities (each record corresponds to
an independently sighted group of animals).  <em>stratum</em> = stratum
identifier (will take on a single value for non-stratified surveys);
<em>subunit</em> = numeric plot unit identifier; <em>total</em> = total number
of observed animals (for each independently sighted group of animals).</p>
</td></tr>
<tr><td><code id="Sight.Est_+3A_sampinfo">sampinfo</code></td>
<td>
<p>data frame containing sampling information pertaining to the
observational survey.  Must include the following variables (<em>stratum,
nh, Nh</em>).  <em>stratum</em> = stratum identifier (must take on the same values
as <em>stratum</em> variable in observational data set), <em>nh</em> = number of
sampled units in stratum h, <em>Nh</em> = number of population units in
stratum h; note (this dataset will contain a single record for
non-stratified designs).</p>
</td></tr>
<tr><td><code id="Sight.Est_+3A_method">method</code></td>
<td>
<p>method for estimating variance of the abundance estimator.
Should be one of (&quot;Wong&quot;, &quot;SS&quot;).  See details for more information.</p>
</td></tr>
<tr><td><code id="Sight.Est_+3A_logci">logCI</code></td>
<td>
<p>Boolean variable, default (= TRUE), indicates the confidence
interval should be constructed under the assumption that (tau^ - T) has a
lognormal distribution, where T is the total number of animals observed
(see details)</p>
</td></tr>
<tr><td><code id="Sight.Est_+3A_alpha">alpha</code></td>
<td>
<p>type I error rate for confidence interval construction</p>
</td></tr>
<tr><td><code id="Sight.Est_+3A_vm.boot">Vm.boot</code></td>
<td>
<p>Boolean variable, when = TRUE indicates a bootstrap should be
used to estimate cov(theta[i,j],theta[i',j']), var/cov matrix of the
expansion factors (1/detection prob)</p>
</td></tr>
<tr><td><code id="Sight.Est_+3A_nboot">nboot</code></td>
<td>
<p>number of bootstrap replicates to use if Vm.boot = TRUE</p>
</td></tr>
<tr><td><code id="Sight.Est_+3A_bet">bet</code></td>
<td>
<p>regression parameters (if the sightability model is not to be fit
by Sight.Est).  Make sure the order is consistent with the specification in
the &quot;form&quot; argument.</p>
</td></tr>
<tr><td><code id="Sight.Est_+3A_varbet">varbet</code></td>
<td>
<p>variance-covariance matrix for beta^ (if the sightability
model is not to be fit by Sight.Est).  Make sure the order is consistent
with the specification in the &quot;form&quot; argument.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Variance estimation methods: method = Wong implements the variance estimator
from Wong (1996) and is the recommended approach.  Method = SS implements
the variance estimator of Steinhorst and Samuel (1989), with a modification
detailed in the Appendix of Samuel et al. (1992).
</p>
<p>Estimates of the variance may be biased low when the number of test trials
used to estimate model parameters is small (see Wong 1996, Fieberg and
Giudice 2008).  A bootstrap can be used to aid the estimation process by
specifying Vm.boot = TRUE [note: this method is experimental, and can be
time intensive].
</p>
<p>Confidence interval construction: often the sampling distribution of tau^ is
skewed right.  If logCI = TRUE, the confidence interval for tau^ will be
constructed under an assumption that (tau^ - T) has a lognormal distribution,
where T is the total number of animals seen.  In this case, the upper and
lower limits are constructed as follows [see Wong(1996, p. 64-67)]:
</p>
<p>LCL = T + [(tau^-T)/C]*sqrt(1+cv^2), UCL = T+[(tau^-T)*C]*sqrt(1+cv^2),
where cv^2 = var(tau^)/(tau^-T)^2 and C = exp[z[alpha/2]*sqrt(ln(1+cv^2))].
</p>


<h3>Value</h3>

<p>An object of class <code>sightest</code>, a list that includes the
following elements: </p>
<table>
<tr><td><code>sight.model</code></td>
<td>
<p>the fitted sightability model</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>abundance estimate [tau.hat] and its estimate of uncertainty
[Vartot] as well as variance components due to sampling [Varsamp], detection
[VarSight], and model uncertainty [VarMod]</p>
</td></tr></table>
<p> The list also includes the
original test trial and operational survey data, sampling information, and
information needed to construct a confidence interval for the population
estimate.
</p>


<h3>Author(s)</h3>

<p>John Fieberg, Wildlife Biometrician, Minnesota Department of Natural
Resources
</p>


<h3>References</h3>

<p>Fieberg, J.  2012.  Estimating Population Abundance Using Sightability
Models: R SightabilityModel Package. Journal of Statistical Software, 51(9),
1-20.  URL https://doi.org/10.18637/jss.v051.i09.
</p>
<p>Fieberg, John and Giudice, John. 2008 Variance of Stratified Survey
Estimators With Probability of Detection Adjustments. Journal of Wildlife
Management 72:837-844.
</p>
<p>Samuel, Michael D. and Steinhorst, R. Kirk and Garton, Edward O. and
Unsworth, James W. 1992.  Estimation of Wildlife Population Ratios
Incorporating Survey Design and Visibility Bias.  Journal of Wildlife
Management 56:718-725.
</p>
<p>Steinhorst, R. K., and M.D. Samuel. 1989.  Sightability adjustment methods
for aerial surveys of wildlife populations.  Biometrics 45:415-425.
</p>
<p>Wong, C. 1996.  Population size estimation using the modified
Horvitz-Thompson estimator with estimated sighting probabilities.
Dissertation, Colorado State University, Fort Collins, USA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load data frames
  data(obs.m) # observational survey data frame
  data(exp.m) # experimental survey data frame
  data(sampinfo.m) # information on sampling rates (contained in a data frame)
 
# Estimate population size in 2007 only
  sampinfo &lt;- sampinfo.m[sampinfo.m$year == 2007,]
  Sight.Est(observed ~ voc, odat = obs.m[obs.m$year == 2007,],
    sdat = exp.m, sampinfo, method = "Wong", 
    logCI = TRUE, alpha = 0.05, Vm.boot = FALSE) 


# BELOW CODE IS SOMEWHAT TIME INTENSIVE (fits models using 2 variance estimators to 3 years of data)
# Estimate population size for 2004-2007
# Compare Wong's and Steinhorst and Samuel variance estimators
  tau.Wong &lt;- tau.SS &lt;- matrix(NA,4,3)
  count &lt;- 1
  for(i in 2004:2007){
    sampinfo &lt;- sampinfo.m[sampinfo.m$year == i,]

# Wong's variance estimator 
    temp &lt;- Sight.Est(observed ~ voc, odat = obs.m[obs.m$year == i,],
       sdat = exp.m, sampinfo, method = "Wong", 
       logCI = TRUE, alpha = 0.05, Vm.boot = FALSE) 
    tau.Wong[count, ] &lt;- unlist(summary(temp)) 
 
# Steinhorst and Samuel (with Samuel et al. 1992 modification) 
    temp &lt;- Sight.Est(observed ~ voc, odat = obs.m[obs.m$year == i,],  
       sdat = exp.m, sampinfo, method = "SS")
    tau.SS[count, ] &lt;- unlist(summary(temp)) 
    count&lt;-count+1
  }  
  rownames(tau.Wong) &lt;- rownames(tau.SS) &lt;- 2004:2007
  colnames(tau.Wong) &lt;- colnames(tau.SS) &lt;- c("tau.hat","LCL","UCL")
  (tau.Wong &lt;- apply(tau.Wong, 1:2, 
      FUN=function(x){as.numeric(gsub(",", "", x, fixed = TRUE))}))
  (tau.SS &lt;-   (tau.Wong &lt;- apply(tau.Wong, 1:2, 
     FUN = function(x){as.numeric(gsub(",", "", x, fixed = TRUE))})))

## Not run: 
  require(gplots)
  par(mfrow = c(1,1))
    plotCI(2004:2007-.1, tau.Wong[,1], ui = tau.Wong[,3], 
        li = tau.Wong[,2], type = "l", xlab = "", 
        ylab = "Population estimate", xaxt = "n",
        xlim=c(2003.8, 2007.2))
    plotCI(2004:2007+.1, tau.SS[,1], ui = tau.SS[,3], li = tau.SS[,2], 
         type = "b", lty = 2, add = TRUE)
    axis(side = 1, at = 2004:2007, labels = 2004:2007)  
  
## End(Not run)

</code></pre>

<hr>
<h2 id='Sight.Est.Ratio'>Sightability Model Estimator - Ratio of variables</h2><span id='topic+Sight.Est.Ratio'></span>

<h3>Description</h3>

<p>Estimates population ratios by 1) fitting a sightability (logistic
regression) model to &quot;test trial&quot; data; 2) applying the fitted model to
independent (operational) survey data to correct for detection rates &lt; 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sight.Est.Ratio(
  form,
  sdat = NULL,
  odat,
  sampinfo,
  method = "Wong",
  logCI = TRUE,
  alpha = 0.05,
  Vm.boot = FALSE,
  nboot = 1000,
  bet = NULL,
  varbet = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sight.Est.Ratio_+3A_form">form</code></td>
<td>
<p>a symbolic description of the sightability model to be fit
(e.g., &quot;y ~ x1 + x2 + ...&quot;), where y is a binary response variable (= 1 if
the animal is seen and 0 otherwise) and x1, x2, ... are a set of predictor
variables thought to influence detection</p>
</td></tr>
<tr><td><code id="Sight.Est.Ratio_+3A_sdat">sdat</code></td>
<td>
<p>'sightability' data frame.  Each row represents an independent
sightability trial, and columns contain the response (a binary random
variable = 1 if the animal was observed and 0 otherwise) and the covariates
used to model detection probabilities.</p>
</td></tr>
<tr><td><code id="Sight.Est.Ratio_+3A_odat">odat</code></td>
<td>
<p>'observational survey' data frame containing the following
variable names (<em>stratum, subunit, numerator, denominator</em>) along with
the same covariates used to model detection probabilities (each record
corresponds to an independently sighted group of animals).  <em>stratum</em>
= stratum identifier (will take on a single value for non-stratified
surveys); <em>subunit</em> = numeric plot unit identifier; <em>numerator</em> =
total number of observed animals (for each independently sighted group of
animals for numerator of ratio); <em>denominator</em> = total number of
observed animals (for each independently sighted group of animals for
denominator of ratio).</p>
</td></tr>
<tr><td><code id="Sight.Est.Ratio_+3A_sampinfo">sampinfo</code></td>
<td>
<p>data frame containing sampling information pertaining to the
observational survey.  Must include the following variables (<em>stratum,
nh, Nh</em>).  <em>stratum</em> = stratum identifier (must take on the same values
as <em>stratum</em> variable in observational data set), <em>nh</em> = number of
sampled units in stratum h, <em>Nh</em> = number of population units in
stratum h; note (this dataset will contain a single record for
non-stratified designs).</p>
</td></tr>
<tr><td><code id="Sight.Est.Ratio_+3A_method">method</code></td>
<td>
<p>method for estimating variance of the abundance estimator.
Should be one of (&quot;Wong&quot;, &quot;SS&quot;).  See details for more information.</p>
</td></tr>
<tr><td><code id="Sight.Est.Ratio_+3A_logci">logCI</code></td>
<td>
<p>Boolean variable, default (= TRUE), indicates the confidence
interval should be constructed under the assumption that (tau^ - T) has a
lognormal distribution, where T is the total number of animals observed
(see details)</p>
</td></tr>
<tr><td><code id="Sight.Est.Ratio_+3A_alpha">alpha</code></td>
<td>
<p>type I error rate for confidence interval construction</p>
</td></tr>
<tr><td><code id="Sight.Est.Ratio_+3A_vm.boot">Vm.boot</code></td>
<td>
<p>Boolean variable, when = TRUE indicates a bootstrap should be
used to estimate cov(theta[i,j],theta[i',j']), var/cov matrix of the
expansion factors (1/detection prob)</p>
</td></tr>
<tr><td><code id="Sight.Est.Ratio_+3A_nboot">nboot</code></td>
<td>
<p>number of bootstrap replicates to use if Vm.boot = TRUE</p>
</td></tr>
<tr><td><code id="Sight.Est.Ratio_+3A_bet">bet</code></td>
<td>
<p>regression parameters (if the sightability model is not to be fit
by Sight.Est).  Make sure the order is consistent with the specification in
the &quot;form&quot; argument.</p>
</td></tr>
<tr><td><code id="Sight.Est.Ratio_+3A_varbet">varbet</code></td>
<td>
<p>variance-covariance matrix for beta^ (if the sightability
model is not to be fit by Sight.Est).  Make sure the order is consistent
with the specification in the &quot;form&quot; argument.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Variance estimation methods: method = Wong implements the variance estimator
from Wong (1996) and is the recommended approach.  Method = SS implements
the variance estimator of Steinhorst and Samuel (1989), with a modification
detailed in the Appendix of Samuel et al. (1992).
</p>
<p>Estimates of the variance may be biased low when the number of test trials
used to estimate model parameters is small (see Wong 1996, Fieberg and
Giudice 2008).  A bootstrap can be used to aid the estimation process by
specifying Vm.boot = TRUE [note: this method is experimental, and can be
time intensive].
</p>
<p>Confidence interval construction: often the sampling distribution of tau^ is
skewed right.  If logCI = TRUE, the confidence interval for tau^ will be
constructed under an assumption that (tau^ - T) has a lognormal distribution,
where T is the total number of animals seen.  In this case, the upper and
lower limits are constructed as follows [see Wong(1996, p. 64-67)]:
</p>
<p>LCL = T + [(tau^-T)/C]*sqrt(1+cv^2), UCL = T+[(tau^-T)*C]*sqrt(1+cv^2),
where cv^2 = var(tau^)/(tau^-T)^2 and C = exp[z[alpha/2]*sqrt(ln(1+cv^2))].
</p>


<h3>Value</h3>

<p>An object of class <code>sightest_ratio</code>, a list that includes the
following elements: </p>
<table>
<tr><td><code>sight.model</code></td>
<td>
<p>the fitted sightability model</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>ratio estimate, ratio.hat,abundance estimate [tau.hat] and its
estimate of uncertainty [Varratio] as well as variance components due to
sampling [Varsamp], detection [VarSight], and model uncertainty [VarMod]</p>
</td></tr>
</table>
<p>The list also includes the estimates for the numerator and denominator
total, the original test trial and operational survey data, sampling
information, and information needed to construct a confidence interval for
the population estimate.
</p>


<h3>Author(s)</h3>

<p>Carl James Schwarz, StatMathComp Consulting by Schwarz,
cschwarz.stat.sfu.ca@gmail.com
</p>


<h3>References</h3>

<p>Fieberg, J.  2012.  Estimating Population Abundance Using Sightability
Models: R SightabilityModel Package. Journal of Statistical Software, 51(9),
1-20.  URL https://doi.org/10.18637/jss.v051.i09.
</p>
<p>Fieberg, John and Giudice, John. 2008 Variance of Stratified Survey
Estimators With Probability of Detection Adjustments. Journal of Wildlife
Management 72:837-844.
</p>
<p>Samuel, Michael D. and Steinhorst, R. Kirk and Garton, Edward O. and
Unsworth, James W. 1992.  Estimation of Wildlife Population Ratios
Incorporating Survey Design and Visibility Bias.  Journal of Wildlife
Management 56:718-725.
</p>
<p>Steinhorst, R. K., and M.D. Samuel. 1989.  Sightability adjustment methods
for aerial surveys of wildlife populations.  Biometrics 45:415-425.
</p>
<p>Wong, C. 1996.  Population size estimation using the modified
Horvitz-Thompson estimator with estimated sighting probabilities.
Dissertation, Colorado State University, Fort Collins, USA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load data frames
  data(obs.m) # observational survey data frame
  data(exp.m) # experimental survey data frame
  data(sampinfo.m) # information on sampling rates (contained in a data frame)
 
# Estimate ratio of bulls to cows in 2007 only
  sampinfo &lt;- sampinfo.m[sampinfo.m$year == 2007,]

  obs.m$numerator   &lt;- obs.m$bulls
  obs.m$denominator &lt;- obs.m$cows
  
  Sight.Est.Ratio(observed ~ voc, odat = obs.m[obs.m$year == 2007,],
    sdat = exp.m, sampinfo, method = "Wong", 
    logCI = TRUE, alpha = 0.05, Vm.boot = FALSE) 


</code></pre>

<hr>
<h2 id='SightabilityPopR'>R function that interfaces with the SightabilityModel package and gives similar functionality
as the AerialSurvey program</h2><span id='topic+SightabilityPopR'></span>

<h3>Description</h3>

<p>A stratified random sample of blocks in a survey area is conducted.
In each block, groups of moose are observed (usually through an aerial survey).
For each group of moose, the number of moose is recorded along with attributes
such as sex or age.
</p>
<p>The SightabilityPopR() function  adjusts for sightability &lt; 100%.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SightabilityPopR(
  survey.data,
  survey.block.area,
  stratum.data,
  density = NULL,
  abundance = NULL,
  numerator = NULL,
  denominator = NULL,
  sight.formula = observed ~ 1,
  sight.beta = 10,
  sight.beta.cov = matrix(0, nrow = 1, ncol = 1),
  sight.logCI = TRUE,
  sight.var.method = c("Wong", "SS")[1],
  block.id.var = "Block.ID",
  block.area.var = "Block.Area",
  stratum.var = "Stratum",
  stratum.blocks.var = "Stratum.Blocks",
  stratum.area.var = "Stratum.Area",
  conf.level = 0.9
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SightabilityPopR_+3A_survey.data">survey.data</code></td>
<td>
<p>A data frame containing counts of moose in each group along with a variable identifying 
the stratum (see stratum.var) and block (see block.id.var)</p>
</td></tr>
<tr><td><code id="SightabilityPopR_+3A_survey.block.area">survey.block.area</code></td>
<td>
<p>A data frame containing for each block, the block id (see block.id.var), the
area of the block (see block.area.var). The data frame can contain information for other blocks that
were not surveyed (e.g. for the entire population of blocks) and information from these
additional blocks will be ignored.</p>
</td></tr>
<tr><td><code id="SightabilityPopR_+3A_stratum.data">stratum.data</code></td>
<td>
<p>A data frame containing for each stratum, the stratum id (see stratum.var), the total
number of blocks in the stratum (see stratum.blocks.var) and the total area of the stratum (see stratum.area.var)</p>
</td></tr>
<tr><td><code id="SightabilityPopR_+3A_density">density</code>, <code id="SightabilityPopR_+3A_abundance">abundance</code>, <code id="SightabilityPopR_+3A_numerator">numerator</code>, <code id="SightabilityPopR_+3A_denominator">denominator</code></td>
<td>
<p>Right-handed formula identifying the variable(s) in the
survey.data data frame for which the density, abundance, or ratio (numerator/denominator) are to be estimated.</p>
</td></tr>
<tr><td><code id="SightabilityPopR_+3A_sight.formula">sight.formula</code></td>
<td>
<p>A formula that identifies the model used
to estimate sightability. For example <code>observed ~ VegCoverClass</code> would indicate
that sightability is a function of the <code>VegCoverClass</code> variable in the survey 
data. The left hand variable is arbitrary. The right hand variables must be present
in the survey.data data frame.</p>
</td></tr>
<tr><td><code id="SightabilityPopR_+3A_sight.beta">sight.beta</code></td>
<td>
<p>The vector of estimated coefficients for the logistic regression sightability model.</p>
</td></tr>
<tr><td><code id="SightabilityPopR_+3A_sight.beta.cov">sight.beta.cov</code></td>
<td>
<p>The covariance matrix of <code>sight.beta</code></p>
</td></tr>
<tr><td><code id="SightabilityPopR_+3A_sight.logci">sight.logCI</code></td>
<td>
<p>Should confidence intervals for the sightability adjusted estimates be computed
using a normal-based confidence interval on <code>log(abundance)</code></p>
</td></tr>
<tr><td><code id="SightabilityPopR_+3A_sight.var.method">sight.var.method</code></td>
<td>
<p>What method should be used to estimate the variances after adjusting
for sightability.</p>
</td></tr>
<tr><td><code id="SightabilityPopR_+3A_block.id.var">block.id.var</code></td>
<td>
<p>Name of the variable in the data frames that identifies the block.id (the sampling unit)</p>
</td></tr>
<tr><td><code id="SightabilityPopR_+3A_block.area.var">block.area.var</code></td>
<td>
<p>Name of the variable in data frames that contains the area of the blocks (area of sampling unit)</p>
</td></tr>
<tr><td><code id="SightabilityPopR_+3A_stratum.var">stratum.var</code></td>
<td>
<p>Name of the variable in the data frames that identifies the classical stratum</p>
</td></tr>
<tr><td><code id="SightabilityPopR_+3A_stratum.blocks.var">stratum.blocks.var</code></td>
<td>
<p>Name of the variable in the stratum.data data frame that contains the total number of
blocks in the stratum.</p>
</td></tr>
<tr><td><code id="SightabilityPopR_+3A_stratum.area.var">stratum.area.var</code></td>
<td>
<p>Name of the variable in the stratum.data data.frame that contains the total stratum area.</p>
</td></tr>
<tr><td><code id="SightabilityPopR_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level used to create confidence intervals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing for each stratum and for all strata (identified as stratum id <code>.OVERALL</code>), the density,
or abundance or ratio estimate along with its estimated standard error and large-sample normal-based confidence interval.
Additional information on the components of variance is also reported.
</p>


<h3>Author(s)</h3>

<p>Schwarz, C. J. <a href="mailto:cschwarz.stat.sfu.ca@gmail.com">cschwarz.stat.sfu.ca@gmail.com</a>.
</p>


<h3>References</h3>

<p>To Be Added.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
##---- See the vignettes for examples on how to run this analysis.

</code></pre>

<hr>
<h2 id='SightabilityPopR_DomStrat'>Classical and Domain Stratification using SightabilityPopR()</h2><span id='topic+SightabilityPopR_DomStrat'></span>

<h3>Description</h3>

<p>This function allows for classical or domain stratification when using SightabilityPopR().
Caution **SE are NOT adjusted for measurements on multiple domains on the same
sampling unit. Bootstrapping may be required**. Consult the vignette for more details.
</p>
<p>SightabilityPopR_DomStrat() adjusts for sightability &lt; 100%.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SightabilityPopR_DomStrat(
  stratum.data,
  selected.unit.data,
  waypoint.data,
  density = NULL,
  abundance = NULL,
  numerator = NULL,
  denominator = NULL,
  sight.formula = ~1,
  sight.beta = 10,
  sight.beta.cov = matrix(0, nrow = 1, ncol = 1),
  sight.logCI = TRUE,
  sight.var.method = c("Wong", "SS")[1],
  stratum.var = "Stratum",
  domain.var = "Domain",
  stratum.total.blocks.var = "Total.Blocks",
  stratum.total.area.var = "Total.Area",
  block.id.var = "Block.ID",
  block.area.var = "Block.Area",
  conf.level = 0.9
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SightabilityPopR_DomStrat_+3A_stratum.data">stratum.data</code></td>
<td>
<p>A data frame containing for each combination of stratum and domain, the stratum id (see stratum.var), 
the domain id (see domain.var),
the total number of blocks in the stratum (see stratum.total.blocks.var) and 
the total area of the stratum (see stratum.total.area.var)</p>
</td></tr>
<tr><td><code id="SightabilityPopR_DomStrat_+3A_selected.unit.data">selected.unit.data</code></td>
<td>
<p>A data frame containing information on the selected survey units. Required variables
are the stratum (see stratum.var), domain (see domain.var), block.id (see block.id.var), and the
area of the block (see block.area.var).</p>
</td></tr>
<tr><td><code id="SightabilityPopR_DomStrat_+3A_waypoint.data">waypoint.data</code></td>
<td>
<p>A data frame containing counts of moose in each group along with a variable identifying 
the stratum (see stratum.var), domain (see domain.var) and block (see block.id.var). Additional variables can
be included such as covariates for the sightability function (not currently used in MoosePopR)</p>
</td></tr>
<tr><td><code id="SightabilityPopR_DomStrat_+3A_density">density</code>, <code id="SightabilityPopR_DomStrat_+3A_abundance">abundance</code>, <code id="SightabilityPopR_DomStrat_+3A_numerator">numerator</code>, <code id="SightabilityPopR_DomStrat_+3A_denominator">denominator</code></td>
<td>
<p>Right-handed formula identifying the variable(s) in the
waypoint data frame for which the density, abundance, or ratio (numerator/denominator) are to be estimated.</p>
</td></tr>
<tr><td><code id="SightabilityPopR_DomStrat_+3A_sight.formula">sight.formula</code></td>
<td>
<p>A formula that identifies the model used
to estimate sightability. For example <code>observed ~ VegCoverClass</code> would indicate
that sightability is a function of the <code>VegCoverClass</code> variable in the survey 
data. The left hand variable is arbitrary. The right hand variables must be present
in the survey.data data frame.</p>
</td></tr>
<tr><td><code id="SightabilityPopR_DomStrat_+3A_sight.beta">sight.beta</code></td>
<td>
<p>The vector of estimated coefficients for the logistic regression sightability model.</p>
</td></tr>
<tr><td><code id="SightabilityPopR_DomStrat_+3A_sight.beta.cov">sight.beta.cov</code></td>
<td>
<p>The covariance matrix of <code>sight.beta</code></p>
</td></tr>
<tr><td><code id="SightabilityPopR_DomStrat_+3A_sight.logci">sight.logCI</code></td>
<td>
<p>Should confidence intervals for the sightability adjusted estimates be computed
using a normal-based confidence interval on <code>log(abundance)</code></p>
</td></tr>
<tr><td><code id="SightabilityPopR_DomStrat_+3A_sight.var.method">sight.var.method</code></td>
<td>
<p>What method should be used to estimate the variances after adjusting
for sightability.</p>
</td></tr>
<tr><td><code id="SightabilityPopR_DomStrat_+3A_stratum.var">stratum.var</code></td>
<td>
<p>Name of the variable in the data frames that identifies the classical stratum</p>
</td></tr>
<tr><td><code id="SightabilityPopR_DomStrat_+3A_domain.var">domain.var</code></td>
<td>
<p>Name of the variable in the data frames that identifies the domain.</p>
</td></tr>
<tr><td><code id="SightabilityPopR_DomStrat_+3A_stratum.total.blocks.var">stratum.total.blocks.var</code></td>
<td>
<p>Name of the variable in the stratum.data data frame that contains the total number of
blocks in the stratum.</p>
</td></tr>
<tr><td><code id="SightabilityPopR_DomStrat_+3A_stratum.total.area.var">stratum.total.area.var</code></td>
<td>
<p>Name of the variable in the stratum.data data.frame that contains the total stratum area.</p>
</td></tr>
<tr><td><code id="SightabilityPopR_DomStrat_+3A_block.id.var">block.id.var</code></td>
<td>
<p>Name of the variable in the data frames that identifies the block.id (the sampling unit)</p>
</td></tr>
<tr><td><code id="SightabilityPopR_DomStrat_+3A_block.area.var">block.area.var</code></td>
<td>
<p>Name of the variable in data frames that contains the area of the blocks (area of sampling unit)</p>
</td></tr>
<tr><td><code id="SightabilityPopR_DomStrat_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level used to create confidence intervals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing for each stratum and for all combinations of strata and domains
(identified as stratum id <code>.OVERALL</code>), the density,
or abundance or ratio estimate along with its estimated standard error and large-sample normal-based confidence interval.
</p>


<h3>Author(s)</h3>

<p>Schwarz, C. J. <a href="mailto:cschwarz.stat.sfu.ca@gmail.com">cschwarz.stat.sfu.ca@gmail.com</a>.
</p>


<h3>References</h3>

<p>To Be Added.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
##---- See the vignettes for examples on how to run this analysis.

</code></pre>

<hr>
<h2 id='SS.est'>Sightability estimate with variance components estimator from Steinhorst and
Samuel (1989) and Samuel et al. (1992).</h2><span id='topic+SS.est'></span>

<h3>Description</h3>

<p>Estimates population size, with variance estimated using Steinhorst and
Samuel (1989) and Samuel et al.'s (1992) estimator.  Usually, this function
will be called by Sight.Est
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SS.est(
  total,
  srates,
  nh,
  Nh,
  stratum,
  subunit,
  covars,
  beta,
  varbeta,
  smat = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SS.est_+3A_total">total</code></td>
<td>
<p>Number of animals in each independently sighted group</p>
</td></tr>
<tr><td><code id="SS.est_+3A_srates">srates</code></td>
<td>
<p>Plot-level sampling probability</p>
</td></tr>
<tr><td><code id="SS.est_+3A_nh">nh</code></td>
<td>
<p>Number of sample plots in each stratum</p>
</td></tr>
<tr><td><code id="SS.est_+3A_nh">Nh</code></td>
<td>
<p>Number of population plots in each stratum</p>
</td></tr>
<tr><td><code id="SS.est_+3A_stratum">stratum</code></td>
<td>
<p>Stratum identifiers (associated with the independently
observed animal groups)</p>
</td></tr>
<tr><td><code id="SS.est_+3A_subunit">subunit</code></td>
<td>
<p>Plot ID (associated with the independently observed animal
groups)</p>
</td></tr>
<tr><td><code id="SS.est_+3A_covars">covars</code></td>
<td>
<p>Matrix of sightability covariates (associated with the
independently observed animal groups)</p>
</td></tr>
<tr><td><code id="SS.est_+3A_beta">beta</code></td>
<td>
<p>Logistic regression parameter estimates (from fitted
sightability model)</p>
</td></tr>
<tr><td><code id="SS.est_+3A_varbeta">varbeta</code></td>
<td>
<p>Estimated variance-covariance matrix for the logistic
regression parameter estimates (from fitted sightability model)</p>
</td></tr>
<tr><td><code id="SS.est_+3A_smat">smat</code></td>
<td>
<p>Estimated variance-covariance matrix for the inflation factors
(1/probability of detection).  This is an n.animal x n.animal matrix, and is
usually calculated within the SS.est function.  Non-null values can be
passed to the function (e.g., if a bootstrap is used to estimate uncertainty
due to the estimated detection parameters).</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>tau.hat</code></td>
<td>
<p>Sightability estimate of population size, tau^</p>
</td></tr>
<tr><td><code>VarTot</code></td>
<td>
<p>Estimated variance of tau^</p>
</td></tr> <tr><td><code>VarSamp</code></td>
<td>
<p>Estimated variance
component due to sampling aerial units</p>
</td></tr> <tr><td><code>VarSight</code></td>
<td>
<p>Estimated variance
component due to sighting process (i.e., series of binomial rv for each
animal group)</p>
</td></tr> <tr><td><code>VarMod</code></td>
<td>
<p>Estimated variance component due to estimating
detection probabilities using test trial data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>John Fieberg
</p>


<h3>References</h3>

<p>Steinhorst, R. K., and M.D. Samuel. 1989.  Sightability adjustment methods
for aerial surveys of wildlife populations.  Biometrics 45:415-425.
</p>
<p>Wong, C. 1996.  Population size estimation using the modified
Horvitz-Thompson estimator with estimated sighting probabilities.
Dissertation, Colorado State University, Fort Collins, USA.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sight.Est">Sight.Est</a></code>, <code><a href="#topic+Wong.est">Wong.est</a></code>
</p>

<hr>
<h2 id='SS.est.Ratio'>Sightability estimate or ratio with variance components estimator from
Steinhorst and Samuel (1989) and Samuel et al. (1992).  This is merely a
stub and has not been implemented.</h2><span id='topic+SS.est.Ratio'></span>

<h3>Description</h3>

<p>Estimates ratio, with variance estimated using Steinhorst and Samuel (1989)
and Samuel et al.'s (1992) estimator.  Usually, this function will be
called by Sight.Est.Ratio()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SS.est.Ratio(
  numerator,
  denominator,
  srates,
  nh,
  Nh,
  stratum,
  subunit,
  covars,
  beta,
  varbeta,
  smat = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SS.est.Ratio_+3A_numerator">numerator</code>, <code id="SS.est.Ratio_+3A_denominator">denominator</code></td>
<td>
<p>Number of animals for the numerator and
denominator of the ratio in each independently sighted group</p>
</td></tr>
<tr><td><code id="SS.est.Ratio_+3A_srates">srates</code></td>
<td>
<p>Plot-level sampling probability</p>
</td></tr>
<tr><td><code id="SS.est.Ratio_+3A_nh">nh</code></td>
<td>
<p>Number of sample plots in each stratum</p>
</td></tr>
<tr><td><code id="SS.est.Ratio_+3A_nh">Nh</code></td>
<td>
<p>Number of population plots in each stratum</p>
</td></tr>
<tr><td><code id="SS.est.Ratio_+3A_stratum">stratum</code></td>
<td>
<p>Stratum identifiers (associated with the independently
observed animal groups)</p>
</td></tr>
<tr><td><code id="SS.est.Ratio_+3A_subunit">subunit</code></td>
<td>
<p>Plot ID (associated with the independently observed animal
groups)</p>
</td></tr>
<tr><td><code id="SS.est.Ratio_+3A_covars">covars</code></td>
<td>
<p>Matrix of sightability covariates (associated with the
independently observed animal groups)</p>
</td></tr>
<tr><td><code id="SS.est.Ratio_+3A_beta">beta</code></td>
<td>
<p>Logistic regression parameter estimates (from fitted
sightability model)</p>
</td></tr>
<tr><td><code id="SS.est.Ratio_+3A_varbeta">varbeta</code></td>
<td>
<p>Estimated variance-covariance matrix for the logistic
regression parameter estimates (from fitted sightability model)</p>
</td></tr>
<tr><td><code id="SS.est.Ratio_+3A_smat">smat</code></td>
<td>
<p>Estimated variance-covariance matrix for the inflation factors
(1/probability of detection).  This is an n.animal x n.animal matrix, and is
usually calculated within the SS.est.Ratio function.  Non-null values can be
passed to the function (e.g., if a bootstrap is used to estimate uncertainty
due to the estimated detection parameters).</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>ratio.hat</code></td>
<td>
<p>Sightability estimate of ratio, ratio^</p>
</td></tr>
<tr><td><code>VarRatio</code></td>
<td>
<p>Estimated variance of ratio^</p>
</td></tr> <tr><td><code>VarSamp</code>, <code>VarSight</code>, <code>VarMod</code></td>
<td>
<p>Estimated variance component due to sampling, sightability and model
set to NA</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Carl James Schwarz, cschwarz.stat.sfu.ca@gmail.com
</p>


<h3>References</h3>

<p>Steinhorst, R. K., and M.D. Samuel. 1989.  Sightability adjustment methods
for aerial surveys of wildlife populations.  Biometrics 45:415-425.
</p>
<p>Wong, C. 1996.  Population size estimation using the modified
Horvitz-Thompson estimator with estimated sighting probabilities.
Dissertation, Colorado State University, Fort Collins, USA.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sight.Est">Sight.Est</a></code>, <code><a href="#topic+Wong.est">Wong.est</a></code>
</p>

<hr>
<h2 id='summary.sightest'>Summarize sightability estimator</h2><span id='topic+summary.sightest'></span><span id='topic+summary.sightest_ratio'></span>

<h3>Description</h3>

<p>Calculates confidence interval (based on asymptotic [normal or log-normal
assumption])
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sightest'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.sightest_+3A_object">object</code></td>
<td>
<p>Sightability object, output from call to Sight.Est function.</p>
</td></tr>
<tr><td><code id="summary.sightest_+3A_...">...</code></td>
<td>
<p>arguments to be passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Nhat or Ratiohat</code></td>
<td>
<p>Sightability population estimate</p>
</td></tr>
<tr><td><code>lcl</code></td>
<td>
<p>Lower confidence limit</p>
</td></tr> <tr><td><code>ucl</code></td>
<td>
<p>Upper confidence limit</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>John Fieberg and Carl James Schwarz
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sight.Est">Sight.Est</a></code>, <code><a href="#topic+Sight.Est.Ratio">Sight.Est.Ratio</a></code>
</p>

<hr>
<h2 id='vardiff'>Function to estimate the variance of the difference between two population
estimates</h2><span id='topic+vardiff'></span>

<h3>Description</h3>

<p>Function to estimate the variance of the difference between two population
estimates formed using the same sightability model (to correct for
detection).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vardiff(sight1, sight2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vardiff_+3A_sight1">sight1</code></td>
<td>
<p>Sightability model object for the first population estimate
(formed by calling Sight.Est function)</p>
</td></tr>
<tr><td><code id="vardiff_+3A_sight2">sight2</code></td>
<td>
<p>Sightability model object for the second population estimate
(formed by calling Sight.Est function)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Population estimates constructed using the same sightability model will NOT
be independent (they will typically exhibit positive covariance).  This
function estimates the covariance due to using the same sightability model
and subtracts it from the summed variance.
</p>


<h3>Value</h3>

<table>
<tr><td><code>vardiff</code></td>
<td>
<p>numeric =
var(tau^[1])+var(tau^[2])-2*cov(tau^[1],tau^[2])</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>John Fieberg
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Example using moose survey data 
  data(obs.m) # observational moose survey data
  data(exp.m) # experimental moose survey data
  data(sampinfo.m) # information on sampling rates
 
# Estimate population size in 2006 and 2007 
 sampinfo &lt;- sampinfo.m[sampinfo.m$year == 2007, ]
 tau.2007 &lt;- Sight.Est(observed ~ voc, odat = obs.m[obs.m$year == 2007, ], 
                         sdat = exp.m, sampinfo.m[sampinfo.m$year == 2007, ], 
                         method = "Wong", logCI = TRUE, alpha = 0.05, Vm.boot = FALSE) 
 tau.2006 &lt;- Sight.Est(observed ~ voc, odat = obs.m[obs.m$year == 2006, ],
                         sdat = exp.m, sampinfo.m[sampinfo.m$year == 2006, ],
                         method = "Wong", logCI = TRUE, alpha = 0.05, Vm.boot = FALSE) 

# naive variance
  tau.2007$est[2]+tau.2006$est[2]

# variance after subtracting positvie covariance
  vardiff(tau.2007, tau.2006)

</code></pre>

<hr>
<h2 id='varlog.lam'>Calculates the variance of the log rate of change between 2 population
estimates that rely on the same sightability model.</h2><span id='topic+varlog.lam'></span>

<h3>Description</h3>

<p>Calculates the variance of the log rate of change between 2 population
estimates that rely on the same sightability model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varlog.lam(sight1, sight2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varlog.lam_+3A_sight1">sight1</code></td>
<td>
<p>Sightability model object for the first population estimate
(formed by calling Sight.Est function)</p>
</td></tr>
<tr><td><code id="varlog.lam_+3A_sight2">sight2</code></td>
<td>
<p>Sightability model object for the second population estimate
(formed by calling Sight.Est function)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses the delta method to calculate an approximate variance for
the log rate of change, log(tau^[t+1])-log(tau^[t]), while accounting for
the positive covariance between the two estimates (as a result of using the
same sightability model to correct for detection).
</p>


<h3>Value</h3>

<table>
<tr><td><code>loglambda</code></td>
<td>
<p>log rate of change = log(tau^[t+1]/tau^[t])</p>
</td></tr>
<tr><td><code>varloglamda</code></td>
<td>
<p>approximate variance of loglambda</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>John Fieberg
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vardiff">vardiff</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example using moose survey data 
  data(obs.m) # observational moose survey data
  data(exp.m) # experimental moose survey data
  data(sampinfo.m) # information on sampling rates
 
# Estimate population size in 2006 and 2007 
  sampinfo &lt;- sampinfo.m[sampinfo.m$year==2007, ]
  tau.2007 &lt;- Sight.Est(observed ~ voc, odat = obs.m[obs.m$year==2007, ],
                          sdat = exp.m, sampinfo.m[sampinfo.m$year == 2007, ],
                          method = "Wong", logCI = TRUE, alpha = 0.05, Vm.boot = FALSE) 
  tau.2006 &lt;- Sight.Est(observed ~ voc, odat = obs.m[obs.m$year==2006, ],
                          sdat = exp.m, sampinfo.m[sampinfo.m$year == 2006, ], 
                          method = "Wong", logCI = TRUE, alpha = 0.05, Vm.boot = FALSE)  

# Log rate of change 
  varlog.lam(tau.2006, tau.2007)

</code></pre>

<hr>
<h2 id='Wong.est'>Sightability estimate with variance components estimator from Wong (1996)</h2><span id='topic+Wong.est'></span>

<h3>Description</h3>

<p>Estimates population size, with variance estimated using Wong's (1996)
estimator.  This function will usually be called by Sight.Est function (but
see details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Wong.est(
  total,
  srates,
  nh,
  Nh,
  stratum,
  subunit,
  covars,
  beta,
  varbeta,
  smat = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Wong.est_+3A_total">total</code></td>
<td>
<p>Number of animals in each independently sighted group</p>
</td></tr>
<tr><td><code id="Wong.est_+3A_srates">srates</code></td>
<td>
<p>Vector of plot-level sampling probabilities (same dimension as
<code>total</code>).</p>
</td></tr>
<tr><td><code id="Wong.est_+3A_nh">nh</code></td>
<td>
<p>Number of sample plots in each stratum</p>
</td></tr>
<tr><td><code id="Wong.est_+3A_nh">Nh</code></td>
<td>
<p>Number of population plots in each stratum</p>
</td></tr>
<tr><td><code id="Wong.est_+3A_stratum">stratum</code></td>
<td>
<p>Stratum identifiers (associated with the independently
observed animal groups)</p>
</td></tr>
<tr><td><code id="Wong.est_+3A_subunit">subunit</code></td>
<td>
<p>Plot ID (associated with the independently observed animal
groups)</p>
</td></tr>
<tr><td><code id="Wong.est_+3A_covars">covars</code></td>
<td>
<p>Matrix of sightability covariates (associated with the
independently observed animal groups)</p>
</td></tr>
<tr><td><code id="Wong.est_+3A_beta">beta</code></td>
<td>
<p>Logistic regression parameter estimates (from fitted
sightability model)</p>
</td></tr>
<tr><td><code id="Wong.est_+3A_varbeta">varbeta</code></td>
<td>
<p>Estimated variance-covariance matrix for the logistic
regression parameter estimates (from fitted sightability model)</p>
</td></tr>
<tr><td><code id="Wong.est_+3A_smat">smat</code></td>
<td>
<p>Estimated variance-covariance matrix for the inflation factors
(1/probability of detection).  This is an n.animal x n.animal matrix, and is
usually calculated within the Wong.est function.  Non-null values can be
passed to the function (e.g., if a bootstrap is used to estimate uncertainty
due to the estimated detection parameters).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called by Sight.Est, but may also be called directly by the
user (e.g., in cases where the original sightability [test trial] data are
not available, but the parameters and var/cov matrix from the logistic
regression model is available in the literature).
</p>


<h3>Value</h3>

<table>
<tr><td><code>tau.hat</code></td>
<td>
<p>Sightability estimate of population size, tau^</p>
</td></tr>
<tr><td><code>VarTot</code></td>
<td>
<p>Estimated variance of tau^</p>
</td></tr> <tr><td><code>VarSamp</code></td>
<td>
<p>Estimated variance
component due to sampling aerial units</p>
</td></tr> <tr><td><code>VarSight</code></td>
<td>
<p>Estimated variance
component due to sighting process (i.e., series of binomial rv for each
animal group)</p>
</td></tr> <tr><td><code>VarMod</code></td>
<td>
<p>Estimated variance component due to estimating
detection probabilities using test trial data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>John Fieberg
</p>


<h3>References</h3>

<p>Rice CG, Jenkins KJ, Chang WY (2009).  Sightability Model for
Mountain Goats.&quot; The Journal of Wildlife Management, 73(3), 468- 478.
</p>
<p>Steinhorst, R. K., and M.D. Samuel. (1989).  Sightability adjustment methods
for aerial surveys of wildlife populations.  Biometrics 45:415-425.
</p>
<p>Wong, C. (1996).  Population size estimation using the modified
Horvitz-Thompson estimator with estimated sighting probabilities.
Dissertation, Colorado State University, Fort Collins, USA.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sight.Est">Sight.Est</a></code>, <code><a href="#topic+SS.est">SS.est</a></code>
</p>

<hr>
<h2 id='Wong.est.Ratio'>Sightability estimate of ratio with variance components estimator from Wong
(1996)</h2><span id='topic+Wong.est.Ratio'></span>

<h3>Description</h3>

<p>Estimates population ratio, with variance estimated using Wong's (1996)
estimator.  This function will usually be called by Sight.Est,Ratio()
function (but see details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Wong.est.Ratio(
  numerator,
  denominator,
  srates,
  nh,
  Nh,
  stratum,
  subunit,
  covars,
  beta,
  varbeta,
  smat = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Wong.est.Ratio_+3A_numerator">numerator</code>, <code id="Wong.est.Ratio_+3A_denominator">denominator</code></td>
<td>
<p>Number of animals in numerator and denominator
of each independently sighted group</p>
</td></tr>
<tr><td><code id="Wong.est.Ratio_+3A_srates">srates</code></td>
<td>
<p>Vector of plot-level sampling probabilities (same dimension as
<code>total</code>).</p>
</td></tr>
<tr><td><code id="Wong.est.Ratio_+3A_nh">nh</code></td>
<td>
<p>Number of sample plots in each stratum</p>
</td></tr>
<tr><td><code id="Wong.est.Ratio_+3A_nh">Nh</code></td>
<td>
<p>Number of population plots in each stratum</p>
</td></tr>
<tr><td><code id="Wong.est.Ratio_+3A_stratum">stratum</code></td>
<td>
<p>Stratum identifiers (associated with the independently
observed animal groups)</p>
</td></tr>
<tr><td><code id="Wong.est.Ratio_+3A_subunit">subunit</code></td>
<td>
<p>Plot ID (associated with the independently observed animal
groups)</p>
</td></tr>
<tr><td><code id="Wong.est.Ratio_+3A_covars">covars</code></td>
<td>
<p>Matrix of sightability covariates (associated with the
independently observed animal groups)</p>
</td></tr>
<tr><td><code id="Wong.est.Ratio_+3A_beta">beta</code></td>
<td>
<p>Logistic regression parameter estimates (from fitted
sightability model)</p>
</td></tr>
<tr><td><code id="Wong.est.Ratio_+3A_varbeta">varbeta</code></td>
<td>
<p>Estimated variance-covariance matrix for the logistic
regression parameter estimates (from fitted sightability model)</p>
</td></tr>
<tr><td><code id="Wong.est.Ratio_+3A_smat">smat</code></td>
<td>
<p>Estimated variance-covariance matrix for the inflation factors
(1/probability of detection).  This is an n.animal x n.animal matrix, and is
usually calculated within the Wong.est function.  Non-null values can be
passed to the function (e.g., if a bootstrap is used to estimate uncertainty
due to the estimated detection parameters).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called by Sight.Est.Ratio, but may also be called directly
by the user (e.g., in cases where the original sightability [test trial] data
are not available, but the parameters and var/cov matrix from the logistic
regression model is available in the literature).
</p>


<h3>Value</h3>

<table>
<tr><td><code>ratio.hat</code></td>
<td>
<p>Sightability estimate of ratio, ratio^</p>
</td></tr>
<tr><td><code>Vartot</code></td>
<td>
<p>Estimated variance of ratio^</p>
</td></tr> <tr><td><code>VarSamp</code>, <code>VarSight</code>, <code>VarMod</code></td>
<td>
<p>Estimated variance component due to sampling, sightability, model are
set to NA</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Carl James Schwarz cschwarz.stat.sfu.ca@gmail.com
</p>


<h3>References</h3>

<p>Rice CG, Jenkins KJ, Chang WY (2009).  Sightability Model for
Mountain Goats.&quot; The Journal of Wildlife Management, 73(3), 468- 478.
</p>
<p>Steinhorst, R. K., and M.D. Samuel. (1989).  Sightability adjustment methods
for aerial surveys of wildlife populations.  Biometrics 45:415-425.
</p>
<p>Wong, C. (1996).  Population size estimation using the modified
Horvitz-Thompson estimator with estimated sighting probabilities.
Dissertation, Colorado State University, Fort Collins, USA.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sight.Est.Ratio">Sight.Est.Ratio</a></code>, <code><a href="#topic+SS.est.Ratio">SS.est.Ratio</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
