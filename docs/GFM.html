<!DOCTYPE html><html><head><title>Help for package GFM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GFM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#chooseFacNumber'><p>Choose the Number of factors for  Generalized Factor Models</p></a></li>
<li><a href='#Factorm'><p>Factor Analysis Model</p></a></li>
<li><a href='#gendata'><p>Generate simulated data</p></a></li>
<li><a href='#gfm'><p>Generalized Factor Model</p></a></li>
<li><a href='#measurefun'><p>Assess the performance of  an estimator on a matrix</p></a></li>
<li><a href='#overdispersedGFM'><p>Overdispersed Generalized Factor Model</p></a></li>
<li><a href='#OverGFMchooseFacNumber'><p>Choose the Number of factors for  Overdispersed Generalized Factor Models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generalized Factor Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-10</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Author:</td>
<td>Wei Liu [aut, cre],
  Huazhen Lin [aut],
  Shurong Zheng [aut],
  Jin Liu [aut],
  Jinyu Nie [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wei Liu &lt;LiuWeideng@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Generalized factor model is implemented for ultra-high dimensional data with mixed-type variables.
    Two algorithms, variational EM and alternate maximization, are designed to implement the generalized factor model,
    respectively. The factor matrix and loading matrix together with the number of factors can be well estimated. 
    This model can be employed in social and behavioral sciences, economy and finance, and  genomics, 
    to extract interpretable nonlinear factors. More details can be referred to 
    Wei Liu, Huazhen Lin, Shurong Zheng and Jin Liu. (2021) &lt;<a href="https://doi.org/10.1080%2F01621459.2021.1999818">doi:10.1080/01621459.2021.1999818</a>&gt;. </td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/feiyoung/GFM">https://github.com/feiyoung/GFM</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/feiyoung/GFM/issues">https://github.com/feiyoung/GFM/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>doSNOW, parallel, R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, stats,irlba, Rcpp, methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-10 14:20:58 UTC; Liuxianju</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-11 06:22:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='chooseFacNumber'>Choose the Number of factors for  Generalized Factor Models</h2><span id='topic+chooseFacNumber'></span>

<h3>Description</h3>

<p>This function is designed to chooose the number of factors for a generalized factor model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  chooseFacNumber(XList, types, q_set = 2: 10,
          select_method = c("SVR", "IC"),offset=FALSE,
          dc_eps=1e-4, maxIter=30, verbose = TRUE, parallelList=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chooseFacNumber_+3A_xlist">XList</code></td>
<td>
<p>a list consisting of matrices with the same rows n, and different columns (p1,p2, ..., p_d),observational mixed data matrix list, d is the types of variables, p_j is the dimension of varibles with the j-th   type.</p>
</td></tr>
<tr><td><code id="chooseFacNumber_+3A_types">types</code></td>
<td>
<p>a d-dimensional character vector, specify the type of variables. For example, <code>types=c('gaussian','poisson', 'binomial')</code>, implies the  components of <code>XList</code> are matrices with continuous, count and binomial values, respectively.</p>
</td></tr>
<tr><td><code id="chooseFacNumber_+3A_q_set">q_set</code></td>
<td>
<p>a positive integer vector, specify the candidates of factor number q, (optional) default as <code>c(2:10)</code> according to Bai (2013).</p>
</td></tr>
<tr><td><code id="chooseFacNumber_+3A_select_method">select_method</code></td>
<td>
<p>a string, specify the method to choose the  number of factors. Two methods are supported: the singular value ratio (SVR) and information criterion (IC) based methods, default as 'SVR'. Empirically, 'SVR' is much faster than 'IC', especially for high-dimensional large-scale data.</p>
</td></tr>
<tr><td><code id="chooseFacNumber_+3A_offset">offset</code></td>
<td>
<p>a logical value, whether add an offset term (the total counts for each row in the count component of XList) when there are Poisson variables.</p>
</td></tr>
<tr><td><code id="chooseFacNumber_+3A_dc_eps">dc_eps</code></td>
<td>
<p> positive real number, specify the tolerance of varing quantity of objective function in the algorithm. Optional parameter with default as <code>1e-4</code>.</p>
</td></tr>
<tr><td><code id="chooseFacNumber_+3A_maxiter">maxIter</code></td>
<td>
<p>a positive integer, specify the times of iteration. Optional parameter with default as 50.</p>
</td></tr>
<tr><td><code id="chooseFacNumber_+3A_verbose">verbose</code></td>
<td>
<p>a logical value, specify whether ouput the information in iteration process, (optional) default as TRUE.</p>
</td></tr>
<tr><td><code id="chooseFacNumber_+3A_parallellist">parallelList</code></td>
<td>
<p>a list with two components:
</p>
<p>(1) parallel: a logical value with TRUE or FALSE, indicates wheter to use prallel computating. Optional parameter with default as FALSE.
</p>
<p>(2)ncores: a positive integer, specify the number of cores when parallel computing is used.
</p>
<p>This argument  plays its role if only <code>select_method='IC'</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return an integer value, the estimated number of factors.
</p>


<h3>Note</h3>

<p>nothing
</p>


<h3>Author(s)</h3>

<p>Liu Wei
</p>


<h3>References</h3>

<p><a href="https://www.tandfonline.com/doi/abs/10.1080/01621459.2021.1999818?journalCode=uasa20">Liu, W., Lin, H., Zheng, S., &amp; Liu, J. (2021). Generalized factor model for ultra-high dimensional correlated variables with mixed types. Journal of the American Statistical Association, (just-accepted), 1-42.</a>
</p>


<h3>See Also</h3>

<p>nothing
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  ## mix of normal and Poisson

  dat &lt;- gendata(seed=1, n=60, p=60, type='norm_pois', q=2, rho=2)
  ## we set maxIter=2 for example.
  hq &lt;- chooseFacNumber(dat$XList, dat$types, verbose = FALSE, maxIter=2)
</code></pre>

<hr>
<h2 id='Factorm'>Factor Analysis Model</h2><span id='topic+Factorm'></span>

<h3>Description</h3>

<p>Factor analysis to extract latent linear factor and estimate loadings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  Factorm(X, q=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Factorm_+3A_x">X</code></td>
<td>
<p>a <code>n</code>-by-<code>p</code> matrix, the observed data</p>
</td></tr>
<tr><td><code id="Factorm_+3A_q">q</code></td>
<td>
<p>an integer between 1 and <code>p</code> or <code>NULL</code>, default as <code>NULL</code> and automatically choose q by the eigenvalue ratio method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return a list with class named <code>fac</code>, including following components:
</p>
<table>
<tr><td><code>hH</code></td>
<td>
<p>a <code>n</code>-by-<code>q</code> matrix, the extracted lantent factor matrix.</p>
</td></tr>
<tr><td><code>hB</code></td>
<td>
<p>a <code>p</code>-by-<code>q</code> matrix, the estimated loading matrix.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>an integer between 1 and <code>p</code>, the number of factor extracted.</p>
</td></tr>
<tr><td><code>sigma2vec</code></td>
<td>
<p>a p-dimensional vector, the estimated variance for each error term in model.</p>
</td></tr>
<tr><td><code>propvar</code></td>
<td>
<p>a positive number between 0 and 1, the explained propotion of cummulative variance by the <code>q</code> factors.</p>
</td></tr>
<tr><td><code>egvalues</code></td>
<td>
<p>a n-dimensional(n&lt;=p) or p-dimensional(p&lt;n) vector, the eigenvalues of sample covariance matrix.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>nothing
</p>


<h3>Author(s)</h3>

<p>Liu Wei
</p>


<h3>References</h3>

<p>Fan, J., Xue, L., and Yao, J. (2017). Sufficient forecasting using factor models. Journal of Econometrics.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gfm">gfm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  dat &lt;- gendata(n = 300, p = 500)
  res &lt;- Factorm(dat$X)
  measurefun(res$hH, dat$H0) # the smallest canonical correlation
</code></pre>

<hr>
<h2 id='gendata'>Generate simulated data</h2><span id='topic+gendata'></span>

<h3>Description</h3>

<p>Generate simulated data from high dimensional genelized nonlinear factor model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gendata(seed = 1, n = 300, p = 50,
              type =  c('homonorm', 'heternorm',
              'pois', 'bino', 'norm_pois', 'pois_bino', 'npb'),
                     q = 6, rho = 1, n_bin=1)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gendata_+3A_seed">seed</code></td>
<td>
<p>a nonnegative integer, the random seed, default as 1.</p>
</td></tr>
<tr><td><code id="gendata_+3A_n">n</code></td>
<td>
<p>a positive integer, the sample size.</p>
</td></tr>
<tr><td><code id="gendata_+3A_p">p</code></td>
<td>
<p>an positive integer, the variable dimension.</p>
</td></tr>
<tr><td><code id="gendata_+3A_type">type</code></td>
<td>
<p>a character, specify the variables types for generated data, default as 'homonorm', representing the homogeneous gaussian variables.</p>
</td></tr>
<tr><td><code id="gendata_+3A_q">q</code></td>
<td>
<p>a positive integer, the number of factors.</p>
</td></tr>
<tr><td><code id="gendata_+3A_rho">rho</code></td>
<td>
<p>a positive number, controlling the magnitude of loading matrix.</p>
</td></tr>
<tr><td><code id="gendata_+3A_n_bin">n_bin</code></td>
<td>
<p>a positive integer, specify the number of trails for the binomial variables when <code>type</code> is set to one of 'bino', 'pois_bino' and 'npb'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides a variaty of mix of different variable types, in which 'homonorm' represents the generated data with only homogenous normal variables; 'heternorm' represents the data with only heterogenous normal variables; 'pois' means the data with only poisson variables; 'bino' means the data with only binomial variables; 'norm_pois' means the mix of normal and poisson variables; 'pois_bino' represents the mix of poisson and binomial variables; and 'npb' means the most complex mix of normal, poisson and binomial variables.
</p>


<h3>Value</h3>

<p>return a list including two components:
</p>
<table>
<tr><td><code>X</code></td>
<td>
<p>a <code>n</code>-by-<code>p</code> matrix, the observed data matrix.</p>
</td></tr>
<tr><td><code>XList</code></td>
<td>
<p>a list consisting of the above observed data matrices with the same rows n (observations), and different columns (p1,p2, ..., p_d) and p columns in total, where d is the types of variables, pj is the dimension of varibles with the j-th   type.</p>
</td></tr>
<tr><td><code>H0</code></td>
<td>
<p>a <code>n</code>-by-<code>q</code> matrix, the true lantent factor matrix.</p>
</td></tr>
<tr><td><code>B0</code></td>
<td>
<p>a <code>p</code>-by-<code>q</code> matrix, the true loading matrix, the last pzero rows are vectors of zeros.</p>
</td></tr>
<tr><td><code>mu0</code></td>
<td>
<p>a p-dimensional vector, the true intercept terms.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>nothing
</p>


<h3>Author(s)</h3>

<p>Wei Liu
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Factorm">Factorm</a>; <a href="#topic+gfm">gfm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  dat &lt;- gendata(n=300, p = 500)
  str(dat)
</code></pre>

<hr>
<h2 id='gfm'>Generalized Factor Model</h2><span id='topic+gfm'></span>

<h3>Description</h3>

<p>This function is to implement the generalized factor model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gfm(XList, types, q=10, offset=FALSE, dc_eps=1e-4, maxIter=30,
                verbose = TRUE, algorithm=c("VEM", "AM"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gfm_+3A_xlist">XList</code></td>
<td>
<p>a list consisting of matrices with the same rows n, and different columns (p1,p2, ..., p_d),observational mixed data matrix list, d is the types of variables, p_j is the dimension of varibles with the j-th   type.</p>
</td></tr>
<tr><td><code id="gfm_+3A_types">types</code></td>
<td>
<p>a d-dimensional character vector, specify the type of variables. For example, <code>types=c('gaussian','poisson', 'binomial')</code>, implies the  components of <code>XList</code> are matrices with continuous, count and binomial values, respectively.</p>
</td></tr>
<tr><td><code id="gfm_+3A_q">q</code></td>
<td>
<p>a positive integer or empty, specify the number of factors, defualt as 10.</p>
</td></tr>
<tr><td><code id="gfm_+3A_offset">offset</code></td>
<td>
<p>a logical value, whether add an offset term (the total counts for each row in the count component of XList) when there are Poisson variables.</p>
</td></tr>
<tr><td><code id="gfm_+3A_dc_eps">dc_eps</code></td>
<td>
<p>a positive real, specify the relative tolerance of objective function in the algorithm. Optional parameter with default as <code>1e-4</code>.</p>
</td></tr>
<tr><td><code id="gfm_+3A_maxiter">maxIter</code></td>
<td>
<p>a positive integer, specify the times of iteration. Optional parameter with default as 30.</p>
</td></tr>
<tr><td><code id="gfm_+3A_verbose">verbose</code></td>
<td>
<p>a logical value with TRUE or FALSE, specify whether ouput the information in iteration process, (optional) default as TRUE.</p>
</td></tr>
<tr><td><code id="gfm_+3A_algorithm">algorithm</code></td>
<td>
<p>a string, specify the algorithm to be used for fitting model. Now it supports two algorithms: variational EM (VEM) and alternate maximization (AM) algorithm, default as VEM. Empirically, we observed that VEM is more robust than AM to the high noise data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function also has the MATLAB version at <a href="https://github.com/feiyoung/MGFM/blob/master/gfm.m">https://github.com/feiyoung/MGFM/blob/master/gfm.m</a>.
</p>


<h3>Value</h3>

<p>return a list with class name 'gfm' and including following components,
</p>
<table>
<tr><td><code>hH</code></td>
<td>
<p>a n*q matrix, the estimated factor matrix.</p>
</td></tr>
<tr><td><code>hB</code></td>
<td>
<p>a p*q matrix, the estimated loading matrix.</p>
</td></tr>
<tr><td><code>hmu</code></td>
<td>
<p>a p-dimensional vector, the estimated intercept terms.</p>
</td></tr>
<tr><td><code>obj</code></td>
<td>
<p>a real number, the value of objective function when the convergence achieves.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>an integer, the used or estimated factor number.</p>
</td></tr>
<tr><td><code>history</code></td>
<td>
<p>a list including the following 7 components: (1)dB: the varied quantity of B in each iteration; (2)dH: the varied quantity of H in each iteration; (3)dc: the varied quantity of the objective function in each iteration; (4)c: the objective value in each iteration; (5) realIter: the real iterations to converge; (6)maxIter: the tolerance of maximum iterations; (7)elapsedTime: the elapsed time.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>nothing
</p>


<h3>Author(s)</h3>

<p>Liu Wei
</p>


<h3>References</h3>

<p><a href="https://www.tandfonline.com/doi/abs/10.1080/01621459.2021.1999818?journalCode=uasa20">Liu, W., Lin, H., Zheng, S., &amp; Liu, J. (2021). Generalized factor model for ultra-high dimensional correlated variables with mixed types. Journal of the American Statistical Association, (just-accepted), 1-42.</a>
</p>
<p>Bai, J. and Liao, Y. (2013). Statistical inferences using large esti-
mated covariances for panel data and factor models.
</p>


<h3>See Also</h3>

<p>nothing
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## mix of normal and Poisson

dat &lt;- gendata(seed=1, n=60, p=60, type='norm_pois', q=2, rho=2)
## we set maxIter=2 for example.
gfm2 &lt;- gfm(dat$XList,  dat$types,  q=2, verbose = FALSE, maxIter=2)
measurefun(gfm2$hH, dat$H0, type='ccor')
measurefun(gfm2$hB, dat$B0, type='ccor')
</code></pre>

<hr>
<h2 id='measurefun'>Assess the performance of  an estimator on a matrix</h2><span id='topic+measurefun'></span>

<h3>Description</h3>

<p>Evaluate the smallest cononical correlation (ccor) coefficients or trace statistic between two matrices, where a larger ccor or  trace statistic is better.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  measurefun(hH, H, type=c('trace_statistic','ccor'))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="measurefun_+3A_hh">hH</code></td>
<td>
<p>a <code>n</code>-by-<code>q</code> matrix, the estimated matrix.</p>
</td></tr>
<tr><td><code id="measurefun_+3A_h">H</code></td>
<td>
<p>a <code>n</code>-by-<code>q</code> matrix, the true  matrix.</p>
</td></tr>
<tr><td><code id="measurefun_+3A_type">type</code></td>
<td>
<p>a character taking value within <code>c('trace_statistic','ccor')</code>, default as 'trace_statistic'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return a real number.
</p>


<h3>Note</h3>

<p>nothing
</p>


<h3>Author(s)</h3>

<p>Liu Wei
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  dat &lt;- gendata(n = 100, p = 200, q=2, rho=3)
  res &lt;- Factorm(dat$XList[[1]])
  measurefun(res$hB, dat$B0)
</code></pre>

<hr>
<h2 id='overdispersedGFM'>Overdispersed Generalized Factor Model</h2><span id='topic+overdispersedGFM'></span>

<h3>Description</h3>

<p>This function is to implement the overdispersed generalized factor model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  overdispersedGFM(XList, types, q, offset=FALSE, epsELBO=1e-5,
                  maxIter=30, verbose=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="overdispersedGFM_+3A_xlist">XList</code></td>
<td>
<p>a list consisting of matrices with the same rows n, and different columns (p1,p2, ..., p_d),observational mixed data matrix list, d is the types of variables, p_j is the dimension of varibles with the j-th   type.</p>
</td></tr>
<tr><td><code id="overdispersedGFM_+3A_types">types</code></td>
<td>
<p>a d-dimensional character vector, specify the type of variables. For example, <code>types=c('gaussian','poisson', 'binomial')</code>, implies the  components of <code>XList</code> are matrices with continuous, count and binomial values, respectively.</p>
</td></tr>
<tr><td><code id="overdispersedGFM_+3A_q">q</code></td>
<td>
<p>a positive integer or empty, specify the number of factors.</p>
</td></tr>
<tr><td><code id="overdispersedGFM_+3A_offset">offset</code></td>
<td>
<p>a logical value, whether add an offset term (the total counts for each row in the count component of XList) when there are Poisson variables.</p>
</td></tr>
<tr><td><code id="overdispersedGFM_+3A_epselbo">epsELBO</code></td>
<td>
<p>a positive real, specify the relative tolerance of ELBO function in the algorithm. Optional parameter with default as <code>1e-5</code>.</p>
</td></tr>
<tr><td><code id="overdispersedGFM_+3A_maxiter">maxIter</code></td>
<td>
<p>a positive integer, specify the times of iteration. Optional parameter with default as 30.</p>
</td></tr>
<tr><td><code id="overdispersedGFM_+3A_verbose">verbose</code></td>
<td>
<p>a logical value with TRUE or FALSE, specify whether ouput the information in iteration process, (optional) default as TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Overdispersion is prevalent in practical applications, particularly in fields like biomedical and genomics studies. To address this practical demand,  we propose an overdispersed generalized factor model (OverGFM) for performing high-dimensional nonlinear factor analysis on overdispersed mixed-type data.
</p>


<h3>Value</h3>

<p>return a list with class name 'overdispersedGFM' and including following components,
</p>
<table>
<tr><td><code>hH</code></td>
<td>
<p>a n*q matrix, the estimated factor matrix.</p>
</td></tr>
<tr><td><code>hB</code></td>
<td>
<p>a p*q matrix, the estimated loading matrix.</p>
</td></tr>
<tr><td><code>hmu</code></td>
<td>
<p>a p-dimensional vector, the estimated intercept terms.</p>
</td></tr>
<tr><td><code>obj</code></td>
<td>
<p>a real number, the value of objective function when the convergence achieves.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>an integer, the used or estimated factor number.</p>
</td></tr>
<tr><td><code>history</code></td>
<td>
<p>a list including the following 7 components: (1)dB: the varied quantity of B in each iteration; (2)dH: the varied quantity of H in each iteration; (3)dc: the varied quantity of the objective function in each iteration; (4)c: the objective value in each iteration; (5) realIter: the real iterations to converge; (6)maxIter: the tolerance of maximum iterations; (7)elapsedTime: the elapsed time.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>nothing
</p>


<h3>Author(s)</h3>

<p>Liu Wei
</p>


<h3>See Also</h3>

<p>nothing
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## mix of normal and Poisson

dat &lt;- gendata(seed=1, n=60, p=60, type='norm_pois', q=2, rho=2)
## we set maxIter=2 for example.
gfm2 &lt;- overdispersedGFM(dat$XList,  dat$types,  q=2, verbose = FALSE, maxIter=2)
measurefun(gfm2$hH, dat$H0, type='ccor')
measurefun(gfm2$hB, dat$B0, type='ccor')
</code></pre>

<hr>
<h2 id='OverGFMchooseFacNumber'>Choose the Number of factors for  Overdispersed Generalized Factor Models</h2><span id='topic+OverGFMchooseFacNumber'></span>

<h3>Description</h3>

<p>This function is designed to chooose the number of factors for the overdispersed generalized factor model by using the singular value ratio (SVR) based method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  OverGFMchooseFacNumber(XList, types, q_max=15,offset=FALSE, epsELBO=1e-4, maxIter=30,
                            verbose = TRUE, threshold= 1e-2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OverGFMchooseFacNumber_+3A_xlist">XList</code></td>
<td>
<p>a list consisting of matrices with the same rows n, and different columns (p1,p2, ..., p_d),observational mixed data matrix list, d is the types of variables, p_j is the dimension of varibles with the j-th   type.</p>
</td></tr>
<tr><td><code id="OverGFMchooseFacNumber_+3A_types">types</code></td>
<td>
<p>a d-dimensional character vector, specify the type of variables. For example, <code>types=c('gaussian','poisson', 'binomial')</code>, implies the  components of <code>XList</code> are matrices with continuous, count and binomial values, respectively.</p>
</td></tr>
<tr><td><code id="OverGFMchooseFacNumber_+3A_q_max">q_max</code></td>
<td>
<p>a positive integer, specify the upper bound of the number of factors, defualt as 15.</p>
</td></tr>
<tr><td><code id="OverGFMchooseFacNumber_+3A_offset">offset</code></td>
<td>
<p>a logical value, whether add an offset term (the total counts for each row in the count component of XList) when there are Poisson variables.</p>
</td></tr>
<tr><td><code id="OverGFMchooseFacNumber_+3A_epselbo">epsELBO</code></td>
<td>
<p>a positive real, specify the relative tolerance of ELBO function in the algorithm. Optional parameter with default as <code>1e-5</code>.</p>
</td></tr>
<tr><td><code id="OverGFMchooseFacNumber_+3A_maxiter">maxIter</code></td>
<td>
<p>a positive integer, specify the times of iteration. Optional parameter with default as 30.</p>
</td></tr>
<tr><td><code id="OverGFMchooseFacNumber_+3A_verbose">verbose</code></td>
<td>
<p>a logical value with TRUE or FALSE, specify whether ouput the information in iteration process, (optional) default as TRUE.</p>
</td></tr>
<tr><td><code id="OverGFMchooseFacNumber_+3A_threshold">threshold</code></td>
<td>
<p>a postive real, the threshold that is used to filter the small singular values in the SVR criterion.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return an integer value, the estimated number of factors.
</p>


<h3>Note</h3>

<p>nothing
</p>


<h3>Author(s)</h3>

<p>Liu Wei
</p>


<h3>See Also</h3>

<p>nothing
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  ## mix of normal and Poisson

  dat &lt;- gendata(seed=1, n=60, p=60, type='norm_pois', q=2, rho=2)
  ## we set maxIter=2 for example.
  hq &lt;- OverGFMchooseFacNumber(dat$XList, dat$types, verbose = FALSE, maxIter=2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
