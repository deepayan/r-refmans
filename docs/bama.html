<!DOCTYPE html><html><head><title>Help for package bama</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bama}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bama'><p>Bayesian Mediation Analysis</p></a></li>
<li><a href='#bama.data'><p>Synthetic example data for bama</p></a></li>
<li><a href='#fdr.bama'><p>Bayesian Mediation Analysis Controlling For False Discovery</p></a></li>
<li><a href='#print.bama'><p>Printing bama objects</p></a></li>
<li><a href='#print.fdr.bama'><p>Printing bama objects</p></a></li>
<li><a href='#summary.bama'><p>Summarize objects of type &quot;bama&quot;</p></a></li>
<li><a href='#summary.fdr.bama'><p>Summarize objects of type &quot;fdr.bama&quot;</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>High Dimensional Bayesian Mediation Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.0</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/umich-cphds/bama">https://github.com/umich-cphds/bama</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/umich-cphds/bama/issues">https://github.com/umich-cphds/bama/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Perform mediation analysis in the presence of high-dimensional
    mediators based on the potential outcome framework. Bayesian Mediation
    Analysis (BAMA), developed by Song et al (2019) &lt;<a href="https://doi.org/10.1111%2Fbiom.13189">doi:10.1111/biom.13189</a>&gt; and
    Song et al (2020) &lt;<a href="https://arxiv.org/abs/2009.11409">arXiv:2009.11409</a>&gt;,
    relies on two Bayesian sparse linear mixed models to simultaneously analyze
    a relatively large number of mediators for a continuous exposure and outcome
    assuming a small number of mediators are truly active. This sparsity
    assumption also allows the extension of univariate mediator analysis by
    casting the identification of active mediators as a variable selection
    problem and applying Bayesian methods with continuous shrinkage priors on
    the effects.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, RcppDist, BH</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, parallel</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-24 17:46:06 UTC; mk</td>
</tr>
<tr>
<td>Author:</td>
<td>Alexander Rix [aut],
  Mike Kleinsasser [aut, cre],
  Yanyi Song [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mike Kleinsasser &lt;mkleinsa@umich.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-24 18:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bama'>Bayesian Mediation Analysis</h2><span id='topic+bama'></span>

<h3>Description</h3>

<p><code>bama</code> is a Bayesian inference method that uses continuous shrinkage priors
for high-dimensional Bayesian mediation analysis, developed by Song et al
(2019, 2020). <code>bama</code> provides estimates for the regression coefficients as
well as the posterior inclusion probability for ranking mediators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bama(
  Y,
  A,
  M,
  C1,
  C2,
  method,
  burnin,
  ndraws,
  weights = NULL,
  inits = NULL,
  control = list(k = 2, lm0 = 1e-04, lm1 = 1, lma1 = 1, l = 1, lambda0 = 0.04, lambda1 =
    0.2, lambda2 = 0.2, phi0 = 0.01, phi1 = 0.01, a0 = 0.01 * ncol(M), a1 = 0.05 *
    ncol(M), a2 = 0.05 * ncol(M), a3 = 0.89 * ncol(M)),
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bama_+3A_y">Y</code></td>
<td>
<p>Length <code>n</code> numeric outcome vector</p>
</td></tr>
<tr><td><code id="bama_+3A_a">A</code></td>
<td>
<p>Length <code>n</code> numeric exposure vector</p>
</td></tr>
<tr><td><code id="bama_+3A_m">M</code></td>
<td>
<p><code>n x p</code> numeric matrix of mediators of Y and A</p>
</td></tr>
<tr><td><code id="bama_+3A_c1">C1</code></td>
<td>
<p><code>n x nc1</code> numeric matrix of extra covariates to include in the
outcome model</p>
</td></tr>
<tr><td><code id="bama_+3A_c2">C2</code></td>
<td>
<p><code>n x nc2</code> numeric matrix of extra covariates to include in the
mediator model</p>
</td></tr>
<tr><td><code id="bama_+3A_method">method</code></td>
<td>
<p>String indicating which method to use. Options are
</p>

<ul>
<li><p>&quot;BSLMM&quot; - mixture of two normal components; Song et al. 2019
</p>
</li>
<li><p>&quot;PTG&quot; - product threshold Gaussian prior; Song et al. 2020
</p>
</li>
<li><p>&quot;GMM&quot; - NOTE: GMM not currently supported. Instead, use method = 'PTG'. four-component Gaussian mixture prior; Song et al. 2020
</p>
</li></ul>
</td></tr>
<tr><td><code id="bama_+3A_burnin">burnin</code></td>
<td>
<p>number of iterations to run the MCMC before sampling</p>
</td></tr>
<tr><td><code id="bama_+3A_ndraws">ndraws</code></td>
<td>
<p>number of draws to take from MCMC (includes burnin draws)</p>
</td></tr>
<tr><td><code id="bama_+3A_weights">weights</code></td>
<td>
<p>Length <code>n</code> numeric vector of weights</p>
</td></tr>
<tr><td><code id="bama_+3A_inits">inits</code></td>
<td>
<p>list of initial values for the Gibbs sampler. Options are
</p>

<ul>
<li><p>beta.m - Length <code>p</code> numeric vector of initial <code>beta.m</code> in the
outcome model. See details for equation
</p>
</li>
<li><p>alpha.a - Length <code>p</code> numeric vector of initial <code>alpha.a</code> in
the mediator model. See details for equation
</p>
</li></ul>
</td></tr>
<tr><td><code id="bama_+3A_control">control</code></td>
<td>
<p>list of Gibbs algorithm control options. These include prior
and hyper-prior parameters. Options vary by method selection. If
<code>method = "BSLMM"</code>
</p>

<ul>
<li><p>k - Shape parameter prior for inverse gamma
</p>
</li>
<li><p>lm0 - Scale parameter prior for inverse gamma for the small normal
components
</p>
</li>
<li><p>lm1 - Scale parameter prior for inverse gamma for the large normal
components of beta_m
</p>
</li>
<li><p>lma1 - Scale parameter prior for inverse gamma for the large normal
component of alpha_a
</p>
</li>
<li><p>l - Scale parameter prior for the other inverse gamma distributions
</p>
</li></ul>

<p>If <code>method = "PTG"</code>
</p>

<ul>
<li><p>lambda0 - threshold parameter for product of alpha.a and beta.m effect
</p>
</li>
<li><p>lambda1 - threshold parameter for beta.m effect
</p>
</li>
<li><p>lambda2 - threshold parameter for alpha.a effect
</p>
</li>
<li><p>ha - inverse gamma shape prior for sigma.sq.a
</p>
</li>
<li><p>la - inverse gamma scale prior for sigma.sq.a
</p>
</li>
<li><p>h1 - inverse gamma shape prior for sigma.sq.e
</p>
</li>
<li><p>l1 - inverse gamma scale prior for sigma.sq.e
</p>
</li>
<li><p>h2 - inverse gamma shape prior for sigma.sq.g
</p>
</li>
<li><p>l2 - inverse gamma scale prior for sigma.sq.g
</p>
</li>
<li><p>km - inverse gamma shape prior for tau.sq.b
</p>
</li>
<li><p>lm - inverse gamma scale prior for tau.sq.b
</p>
</li>
<li><p>kma - inverse gamma shape prior for tau.sq.a
</p>
</li>
<li><p>lma - inverse gamma scale prior for tau.sq.a
</p>
</li></ul>

<p>If <code>method = "GMM". NOTE: GMM not currently supported. Instead, use method = 'PTG'.</code>
</p>

<ul>
<li><p>phi0 - prior beta.m variance
</p>
</li>
<li><p>phi1 - prior alpha.a variance
</p>
</li>
<li><p>a0 - prior count of non-zero beta.m and alpha.a effects
</p>
</li>
<li><p>a1 - prior count of non-zero beta.m and zero alpha.a effects
</p>
</li>
<li><p>a2 - prior count of zero beta.m and non-zero alpha.a effects
</p>
</li>
<li><p>a3 - prior count of zero beta.m and zero alpha.a effects
</p>
</li>
<li><p>ha - inverse gamma shape prior for sigma.sq.a
</p>
</li>
<li><p>la - inverse gamma scale prior for sigma.sq.a
</p>
</li>
<li><p>h1 - inverse gamma shape prior for sigma.sq.e
</p>
</li>
<li><p>l1 - inverse gamma scale prior for sigma.sq.e
</p>
</li>
<li><p>h2 - inverse gamma shape prior for sigma.sq.g
</p>
</li>
<li><p>l2 - inverse gamma scale prior for sigma.sq.g
</p>
</li></ul>
</td></tr>
<tr><td><code id="bama_+3A_seed">seed</code></td>
<td>
<p>numeric seed for GIBBS sampler</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bama</code> uses two regression models for the two conditional relationships,
<code class="reqn">Y | A, M, C</code> and <code class="reqn">M | A, C</code>. For the outcome model, <code>bama</code>
uses
</p>
<p style="text-align: center;"><code class="reqn">Y = M \beta_M  + A * \beta_A + C* \beta_C + \epsilon_Y</code>
</p>

<p>For the mediator model, <code>bama</code> uses the model
</p>
<p style="text-align: center;"><code class="reqn">M = A * \alpha_A + C * \alpha_C + \epsilon_M</code>
</p>

<p>For high dimensional tractability, <code>bama</code> employs continuous Bayesian
shrinkage priors to select mediators and makes the two following assumptions:
First, it assumes that all the potential mediators contribute small effects
in mediating the exposure-outcome relationship. Second, it assumes
that only a small proportion of mediators exhibit large effects
(&quot;active&quot; mediators). <code>bama</code> uses a Metropolis-Hastings within Gibbs
MCMC to generate posterior samples from the model.
</p>
<p>NOTE: GMM not currently supported. Instead, use method = 'PTG'.
</p>


<h3>Value</h3>

<p>If method = &quot;BSLMM&quot;, then <code>bama</code> returns a object of type &quot;bama&quot; with 12 elements:
</p>

<dl>
<dt>beta.m</dt><dd><p><code>ndraws x p</code> matrix containing outcome model mediator
coefficients.
</p>
</dd>
<dt>r1</dt><dd><p><code>ndraws x p</code> matrix indicating whether or not each beta.m
belongs to the larger normal component (1) or smaller normal
component (0).
</p>
</dd>
<dt>alpha.a</dt><dd><p><code>ndraws x p</code> matrix containing the mediator model
exposure coefficients.
</p>
</dd>
<dt>r3</dt><dd><p><code>ndraws x p</code> matrix indicating whether or not each alpha.a
belongs to the larger normal component (1) or smaller normal component (0).
</p>
</dd>
<dt>beta.a</dt><dd><p>Vector of length <code>ndraws</code> containing the beta.a coefficient.</p>
</dd>
<dt>pi.m</dt><dd><p>Vector of length <code>ndraws</code> containing the proportion of
non zero beta.m coefficients.
</p>
</dd>
<dt>pi.a</dt><dd><p>Vector of length <code>ndraws</code> containing the proportion of
non zero alpha.a coefficients.
</p>
</dd>
<dt>sigma.m0</dt><dd><p>Vector of length <code>ndraws</code> containing the standard
deviation of the smaller normal component for mediator-outcome
coefficients (beta.m).
</p>
</dd>
<dt>sigma.m1</dt><dd><p>Vector of length <code>ndraws</code> containing standard deviation
of the larger normal component for mediator-outcome coefficients (beta.m).
</p>
</dd>
<dt>sigma.ma0</dt><dd><p>Vector of length <code>ndraws</code> containing standard
deviation of the smaller normal component for exposure-mediator
coefficients (alpha.a).
</p>
</dd>
<dt>sigma.ma1</dt><dd><p>Vector of length <code>ndraws</code> containing standard deviation
of the larger normal component for exposure-mediator coefficients
(alpha.a).
</p>
</dd>
<dt>call</dt><dd><p>The R call that generated the output.</p>
</dd>
</dl>

<p>NOTE: GMM not currently supported. Instead, use method = 'PTG'
If method = &quot;GMM&quot;, then <code>bama</code> returns a object of type &quot;bama&quot; with:
</p>

<dl>
<dt>beta.m</dt><dd><p><code>ndraws x p</code> matrix containing outcome model mediator
coefficients.</p>
</dd>
<dt>alpha.a</dt><dd><p><code>ndraws x p</code> matrix containing the mediator model
exposure coefficients.</p>
</dd>
<dt>betam_member</dt><dd><p><code>ndraws x p</code> matrix of 1's and 0's where
item = 1 only if beta.m is non-zero.</p>
</dd>
<dt>alphaa_member</dt><dd><p><code>ndraws x p</code> matrix of 1's and 0's where
item = 1 only if alpha.a is non-zero.</p>
</dd>
<dt>alpha.c</dt><dd><p><code>ndraws x (q2 + p)</code> matrix containing alpha_c coefficients.
Since alpha.c is a matrix of dimension q2 x p, the draws are indexed as
alpha_c(w, j) = w * p + j</p>
</dd>
<dt>beta.c</dt><dd><p><code>ndraws x q1</code> matrix containing beta_c coefficients.
Since beta.c is a matrix of dimension q1 x p</p>
</dd>
<dt>beta.a</dt><dd><p>Vector of length <code>ndraws</code> containing the beta.a coefficient.</p>
</dd>
<dt>sigma.sq.a</dt><dd><p>Vector of length <code>ndraws</code> variance of beta.a effect</p>
</dd>
<dt>sigma.sq.e</dt><dd><p>Vector of length <code>ndraws</code> variance of outcome model error</p>
</dd>
<dt>sigma.sq.g</dt><dd><p>Vector of length <code>ndraws</code> variance of mediator model error</p>
</dd>
</dl>

<p>If method = &quot;PTG&quot;, then <code>bama</code> returns a object of type &quot;bama&quot; with:
</p>

<dl>
<dt>beta.m</dt><dd><p><code>ndraws x p</code> matrix containing outcome model mediator
coefficients.</p>
</dd>
<dt>alpha.a</dt><dd><p><code>ndraws x p</code> matrix containing the mediator model
exposure coefficients.</p>
</dd>
<dt>alpha.c</dt><dd><p><code>ndraws x (q2 + p)</code> matrix containing alpha_c coefficients.
Since alpha.c is a matrix of dimension q2 x p, the draws are indexed as
alpha_c(w, j) = w * p + j</p>
</dd>
<dt>beta.c</dt><dd><p><code>ndraws x q1</code> matrix containing beta_c coefficients.
Since beta.c is a matrix of dimension q1 x p</p>
</dd>
<dt>betam_member</dt><dd><p><code>ndraws x p</code> matrix of 1's and 0's where
item = 1 only if beta.m is non-zero.</p>
</dd>
<dt>alphaa_member</dt><dd><p><code>ndraws x p</code> matrix of 1's and 0's where
item = 1 only if alpha.a is non-zero.</p>
</dd>
<dt>beta.a</dt><dd><p>Vector of length <code>ndraws</code> containing the beta.a coefficient.</p>
</dd>
<dt>sigma.sq.a</dt><dd><p>Vector of length <code>ndraws</code> variance of beta.a effect</p>
</dd>
<dt>sigma.sq.e</dt><dd><p>Vector of length <code>ndraws</code> variance of outcome model error</p>
</dd>
<dt>sigma.sq.g</dt><dd><p>Vector of length <code>ndraws</code> variance of mediator model error</p>
</dd>
</dl>



<h3>References</h3>

<p>Song, Y, Zhou, X, Zhang, M, et al. Bayesian shrinkage estimation of high
dimensional causal mediation effects in omics studies. Biometrics. 2019;
1-11. <a href="https://doi.org/10.1111/biom.13189">doi:10.1111/biom.13189</a>
</p>
<p>Song, Yanyi, Xiang Zhou, Jian Kang, Max T. Aung, Min Zhang, Wei Zhao,
Belinda L. Needham et al. &quot;Bayesian Sparse Mediation Analysis with
Targeted Penalization of Natural Indirect Effects.&quot;
arXiv preprint arXiv:2008.06366 (2020).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(bama)

Y &lt;- bama.data$y
A &lt;- bama.data$a

# grab the mediators from the example data.frame
M &lt;- as.matrix(bama.data[, paste0("m", 1:100)], nrow(bama.data))

# We just include the intercept term in this example as we have no covariates
C1 &lt;- matrix(1, 1000, 1)
C2 &lt;- matrix(1, 1000, 1)
beta.m  &lt;- rep(0, 100)
alpha.a &lt;- rep(0, 100)

out &lt;- bama(Y = Y, A = A, M = M, C1 = C1, C2 = C2, method = "BSLMM", seed = 1234,
            burnin = 100, ndraws = 110, weights = NULL, inits = NULL, 
            control = list(k = 2, lm0 = 1e-04, lm1 = 1, lma1 = 1, l = 1))

# The package includes a function to summarise output from 'bama'
summary &lt;- summary(out)
head(summary)


# Product Threshold Gaussian 
ptgmod = bama(Y = Y, A = A, M = M, C1 = C1, C2 = C2, method = "PTG", seed = 1234,
              burnin = 100, ndraws = 110, weights = NULL, inits = NULL, 
              control = list(lambda0 = 0.04, lambda1 = 0.2, lambda2 = 0.2))

mean(ptgmod$beta.a)
apply(ptgmod$beta.m, 2, mean)
apply(ptgmod$alpha.a, 2, mean)
apply(ptgmod$betam_member, 2, mean)
apply(ptgmod$alphaa_member, 2, mean)



</code></pre>

<hr>
<h2 id='bama.data'>Synthetic example data for bama</h2><span id='topic+bama.data'></span>

<h3>Description</h3>

<p>Synthetic example data for bama
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bama.data
</code></pre>


<h3>Format</h3>

<p>A data.frame with 1000 observations on 102 variables:
</p>

<dl>
<dt>y</dt><dd><p>Numeric response variable.</p>
</dd>
<dt>a</dt><dd><p>Numeric exposure variable.</p>
</dd>
<dt>m[1-100]</dt><dd><p>Numeric mediator variables</p>
</dd>
</dl>


<hr>
<h2 id='fdr.bama'>Bayesian Mediation Analysis Controlling For False Discovery</h2><span id='topic+fdr.bama'></span>

<h3>Description</h3>

<p><code>fdr.bama</code> uses the permutation test to estimate the null PIP
distribution for each mediator and determines a threshold (based off of the
<code>fdr</code> parameter) for significance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fdr.bama(
  Y,
  A,
  M,
  C1,
  C2,
  beta.m,
  alpha.a,
  burnin,
  ndraws,
  weights = NULL,
  npermutations = 200,
  fdr = 0.1,
  k = 2,
  lm0 = 1e-04,
  lm1 = 1,
  lma1 = 1,
  l = 1,
  mc.cores = 1,
  type = "PSOCK"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fdr.bama_+3A_y">Y</code></td>
<td>
<p>Length <code>n</code> numeric outcome vector</p>
</td></tr>
<tr><td><code id="fdr.bama_+3A_a">A</code></td>
<td>
<p>Length <code>n</code> numeric exposure vector</p>
</td></tr>
<tr><td><code id="fdr.bama_+3A_m">M</code></td>
<td>
<p><code>n x p</code> numeric matrix of mediators of Y and A</p>
</td></tr>
<tr><td><code id="fdr.bama_+3A_c1">C1</code></td>
<td>
<p><code>n x nc1</code> numeric matrix of extra covariates to include in the
outcome model</p>
</td></tr>
<tr><td><code id="fdr.bama_+3A_c2">C2</code></td>
<td>
<p><code>n x nc2</code> numeric matrix of extra covariates to include in the
mediator model</p>
</td></tr>
<tr><td><code id="fdr.bama_+3A_beta.m">beta.m</code></td>
<td>
<p>Length <code>p</code> numeric vector of initial <code>beta.m</code> in the
outcome model</p>
</td></tr>
<tr><td><code id="fdr.bama_+3A_alpha.a">alpha.a</code></td>
<td>
<p>Length <code>p</code> numeric vector of initial <code>alpha.a</code> in
the mediator model</p>
</td></tr>
<tr><td><code id="fdr.bama_+3A_burnin">burnin</code></td>
<td>
<p>Number of iterations to run the MCMC before sampling</p>
</td></tr>
<tr><td><code id="fdr.bama_+3A_ndraws">ndraws</code></td>
<td>
<p>Number of draws to take from MCMC after the burnin period</p>
</td></tr>
<tr><td><code id="fdr.bama_+3A_weights">weights</code></td>
<td>
<p>Length <code>n</code> numeric vector of weights</p>
</td></tr>
<tr><td><code id="fdr.bama_+3A_npermutations">npermutations</code></td>
<td>
<p>The number of permutations to generate while estimating
the null pip distribution. Default is 200</p>
</td></tr>
<tr><td><code id="fdr.bama_+3A_fdr">fdr</code></td>
<td>
<p>False discovery rate. Default is 0.1</p>
</td></tr>
<tr><td><code id="fdr.bama_+3A_k">k</code></td>
<td>
<p>Shape parameter prior for inverse gamma. Default is 2.0</p>
</td></tr>
<tr><td><code id="fdr.bama_+3A_lm0">lm0</code></td>
<td>
<p>Scale parameter prior for inverse gamma for the small normal
components. Default is 1e-4</p>
</td></tr>
<tr><td><code id="fdr.bama_+3A_lm1">lm1</code></td>
<td>
<p>Scale parameter prior for inverse gamma for the large normal
component of beta_m. Default is 1.0</p>
</td></tr>
<tr><td><code id="fdr.bama_+3A_lma1">lma1</code></td>
<td>
<p>Scale parameter prior for inverse gamma for the large normal
component of alpha_a. Default is 1.0</p>
</td></tr>
<tr><td><code id="fdr.bama_+3A_l">l</code></td>
<td>
<p>Scale parameter prior for the other inverse gamma distributions.
Default is 1.0</p>
</td></tr>
<tr><td><code id="fdr.bama_+3A_mc.cores">mc.cores</code></td>
<td>
<p>The number of cores to use while running <code>fdr.bama</code>.
<code>fdr.bama</code> uses the <code>parallel</code> package for parallelization,
so see that for more information. Default is 1 core</p>
</td></tr>
<tr><td><code id="fdr.bama_+3A_type">type</code></td>
<td>
<p>Type of cluster to make when <code>mc.cores &gt; 1</code>. See
<code>makeCluster</code> in the <code>parallel</code> package for more details.
Default is &quot;PSOCK&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>fdr.bama</code> returns a object of type &quot;fdr.bama&quot; with 5 elements:
</p>

<dl>
<dt>bama.out</dt><dd><p>Output from the <code>bama</code> run.</p>
</dd>
<dt>pip.null</dt><dd><p>A <code>p x npermutations</code> matrices containing the
estimated null PIP distribution for each mediator.
</p>
</dd>
<dt>threshold</dt><dd><p>The cutoff significance threshold for each PIP controlling
for the false discovery rate.
</p>
</dd>
<dt>fdr</dt><dd><p>The false discovery rate used to calculate <code>threshold</code>.</p>
</dd>
<dt>call</dt><dd><p>The R call that generated the output.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Alexander Rix
</p>


<h3>References</h3>

<p>Song, Y, Zhou, X, Zhang, M, et al. Bayesian shrinkage estimation of high
dimensional causal mediation effects in omics studies. Biometrics. 2019;
1-11. <a href="https://doi.org/10.1111/biom.13189">doi:10.1111/biom.13189</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(bama)

Y &lt;- bama.data$y
A &lt;- bama.data$a

# grab the mediators from the example data.frame
M &lt;- as.matrix(bama.data[, paste0("m", 1:100)], nrow(bama.data))

# We just include the intercept term in this example as we have no covariates
C1 &lt;- matrix(1, 1000, 1)
C2 &lt;- matrix(1, 1000, 1)
beta.m  &lt;- rep(0, 100)
alpha.a &lt;- rep(0, 100)

set.seed(12345)

out &lt;- fdr.bama(Y, A, M, C1, C2, beta.m, alpha.a, burnin = 100,
                ndraws = 120, npermutations = 10)

# The package includes a function to summarise output from 'fdr.bama'
summary(out)

</code></pre>

<hr>
<h2 id='print.bama'>Printing bama objects</h2><span id='topic+print.bama'></span>

<h3>Description</h3>

<p>Print a bama object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bama'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.bama_+3A_x">x</code></td>
<td>
<p>An object of class 'bama'.</p>
</td></tr>
<tr><td><code id="print.bama_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to print.data.frame or summary.bama</p>
</td></tr>
</table>

<hr>
<h2 id='print.fdr.bama'>Printing bama objects</h2><span id='topic+print.fdr.bama'></span>

<h3>Description</h3>

<p>Print a bama object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fdr.bama'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.fdr.bama_+3A_x">x</code></td>
<td>
<p>An object of class 'bama'.</p>
</td></tr>
<tr><td><code id="print.fdr.bama_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to print.data.frame or summary.bama</p>
</td></tr>
</table>

<hr>
<h2 id='summary.bama'>Summarize objects of type &quot;bama&quot;</h2><span id='topic+summary.bama'></span>

<h3>Description</h3>

<p>summary.bama summarizes the 'beta.m' estimates from <code>bama</code> and generates
an overall estimate, credible interval, and posterior inclusion probability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bama'
summary(object, rank = F, ci = c(0.025, 0.975), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.bama_+3A_object">object</code></td>
<td>
<p>An object of class &quot;bama&quot;.</p>
</td></tr>
<tr><td><code id="summary.bama_+3A_rank">rank</code></td>
<td>
<p>Whether or not to rank the output by posterior inclusion
probability. Default is TRUE.</p>
</td></tr>
<tr><td><code id="summary.bama_+3A_ci">ci</code></td>
<td>
<p>The credible interval to calculate. <code>ci</code> should be a length 2
numeric vector specifying the upper and lower bounds of the CI. By
default, <code>ci = c(0.025, .975)</code>.</p>
</td></tr>
<tr><td><code id="summary.bama_+3A_...">...</code></td>
<td>
<p>Additional optional arguments to <code>summary</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with 4 elements. The beta.m estimates, the estimates'
<em>credible</em> interval (which by default is 95\
inclusion probability (pip) of each 'beta.m'.
</p>

<hr>
<h2 id='summary.fdr.bama'>Summarize objects of type &quot;fdr.bama&quot;</h2><span id='topic+summary.fdr.bama'></span>

<h3>Description</h3>

<p><code>summary.fdr.bama</code> summarizes the <code>beta.m</code> estimates from
<code>fdr.bama</code> and for each mediator generates an overall estimate,
credible interval, posterior inclusion probability (PIP), and PIP threshold
for significance controlling for the specified false discovery rate (FDR).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fdr.bama'
summary(
  object,
  rank = F,
  ci = c(0.025, 0.975),
  fdr = object$fdr,
  filter = T,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.fdr.bama_+3A_object">object</code></td>
<td>
<p>An object of class &quot;bama&quot;.</p>
</td></tr>
<tr><td><code id="summary.fdr.bama_+3A_rank">rank</code></td>
<td>
<p>Whether or not to rank the output by posterior inclusion
probability. Default is TRUE.</p>
</td></tr>
<tr><td><code id="summary.fdr.bama_+3A_ci">ci</code></td>
<td>
<p>The credible interval to calculate. <code>ci</code> should be a length 2
numeric vector specifying the upper and lower bounds of the CI. By
default, <code>ci = c(0.025, .975)</code>.</p>
</td></tr>
<tr><td><code id="summary.fdr.bama_+3A_fdr">fdr</code></td>
<td>
<p>False discovery rate. By default, it is set to whatever the
<code>fdr</code> of <code>object</code> is. However, it can be changed to recalculate
the PIP cutoff threshold.</p>
</td></tr>
<tr><td><code id="summary.fdr.bama_+3A_filter">filter</code></td>
<td>
<p>Whether or not to filter out mediators with PIP less than the
PIP threshold.</p>
</td></tr>
<tr><td><code id="summary.fdr.bama_+3A_...">...</code></td>
<td>
<p>Additional optional arguments to <code>summary</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with 4 elements. The beta.m estimates, the estimates'
<em>credible</em> interval (which by default is 95\
inclusion probability (pip) of each 'beta.m'.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
