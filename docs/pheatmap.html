<!DOCTYPE html><html><head><title>Help for package pheatmap</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pheatmap}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pheatmap'><p>A function to draw clustered heatmaps.</p></a></li>
<li><a href='#pheatmap-package'><p>Pretty heatmaps</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Pretty Heatmaps</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.12</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-12-26</td>
</tr>
<tr>
<td>Author:</td>
<td>Raivo Kolde</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Raivo Kolde &lt;rkolde@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of heatmaps that offers more control
    over dimensions and appearance.</td>
</tr>
<tr>
<td>Imports:</td>
<td>grid, RColorBrewer, scales, gtable, stats, grDevices, graphics</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-01-02 15:37:50 UTC; kolde</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-01-04 13:50:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='pheatmap'>A function to draw clustered heatmaps.</h2><span id='topic+pheatmap'></span>

<h3>Description</h3>

<p>A function to draw clustered heatmaps where one has better control over some graphical 
parameters such as cell size, etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pheatmap(mat, color = colorRampPalette(rev(brewer.pal(n = 7, name =
  "RdYlBu")))(100), kmeans_k = NA, breaks = NA, border_color = "grey60",
  cellwidth = NA, cellheight = NA, scale = "none", cluster_rows = TRUE,
  cluster_cols = TRUE, clustering_distance_rows = "euclidean",
  clustering_distance_cols = "euclidean", clustering_method = "complete",
  clustering_callback = identity2, cutree_rows = NA, cutree_cols = NA,
  treeheight_row = ifelse((class(cluster_rows) == "hclust") || cluster_rows,
  50, 0), treeheight_col = ifelse((class(cluster_cols) == "hclust") ||
  cluster_cols, 50, 0), legend = TRUE, legend_breaks = NA,
  legend_labels = NA, annotation_row = NA, annotation_col = NA,
  annotation = NA, annotation_colors = NA, annotation_legend = TRUE,
  annotation_names_row = TRUE, annotation_names_col = TRUE,
  drop_levels = TRUE, show_rownames = T, show_colnames = T, main = NA,
  fontsize = 10, fontsize_row = fontsize, fontsize_col = fontsize,
  angle_col = c("270", "0", "45", "90", "315"), display_numbers = F,
  number_format = "%.2f", number_color = "grey30", fontsize_number = 0.8
  * fontsize, gaps_row = NULL, gaps_col = NULL, labels_row = NULL,
  labels_col = NULL, filename = NA, width = NA, height = NA,
  silent = FALSE, na_col = "#DDDDDD", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pheatmap_+3A_mat">mat</code></td>
<td>
<p>numeric matrix of the values to be plotted.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_color">color</code></td>
<td>
<p>vector of colors used in heatmap.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_kmeans_k">kmeans_k</code></td>
<td>
<p>the number of kmeans clusters to make, if we want to aggregate the 
rows before drawing heatmap. If NA then the rows are not aggregated.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_breaks">breaks</code></td>
<td>
<p>a sequence of numbers that covers the range of values in mat and is one 
element longer than color vector. Used for mapping values to colors. Useful, if needed 
to map certain values to certain colors, to certain values. If value is NA then the 
breaks are calculated automatically. When breaks do not cover the range of values, 
then any value larger than <code>max(breaks)</code> will have the largest color and any value 
lower than<code> min(breaks)</code> will get the lowest color.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_border_color">border_color</code></td>
<td>
<p>color of cell borders on heatmap, use NA if no border should be 
drawn.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_cellwidth">cellwidth</code></td>
<td>
<p>individual cell width in points. If left as NA, then the values 
depend on the size of plotting window.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_cellheight">cellheight</code></td>
<td>
<p>individual cell height in points. If left as NA, 
then the values depend on the size of plotting window.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_scale">scale</code></td>
<td>
<p>character indicating if the values should be centered and scaled in 
either the row direction or the column direction, or none. Corresponding values are 
<code>"row"</code>, <code>"column"</code> and <code>"none"</code></p>
</td></tr>
<tr><td><code id="pheatmap_+3A_cluster_rows">cluster_rows</code></td>
<td>
<p>boolean values determining if rows should be clustered or <code>hclust</code> object,</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_cluster_cols">cluster_cols</code></td>
<td>
<p>boolean values determining if columns should be clustered or <code>hclust</code> object.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_clustering_distance_rows">clustering_distance_rows</code></td>
<td>
<p>distance measure used in clustering rows. Possible 
values are <code>"correlation"</code> for Pearson correlation and all the distances 
supported by <code><a href="stats.html#topic+dist">dist</a></code>, such as <code>"euclidean"</code>, etc. If the value is none 
of the above it is assumed that a distance matrix is provided.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_clustering_distance_cols">clustering_distance_cols</code></td>
<td>
<p>distance measure used in clustering columns. Possible 
values the same as for clustering_distance_rows.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_clustering_method">clustering_method</code></td>
<td>
<p>clustering method used. Accepts the same values as 
<code><a href="stats.html#topic+hclust">hclust</a></code>.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_clustering_callback">clustering_callback</code></td>
<td>
<p>callback function to modify the clustering. Is 
called with two parameters: original <code>hclust</code> object and the matrix 
used for clustering. Must return a <code>hclust</code> object.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_cutree_rows">cutree_rows</code></td>
<td>
<p>number of clusters the rows are divided into, based on the
hierarchical clustering (using cutree), if rows are not clustered, the 
argument is ignored</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_cutree_cols">cutree_cols</code></td>
<td>
<p>similar to <code>cutree_rows</code>, but for columns</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_treeheight_row">treeheight_row</code></td>
<td>
<p>the height of a tree for rows, if these are clustered. 
Default value 50 points.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_treeheight_col">treeheight_col</code></td>
<td>
<p>the height of a tree for columns, if these are clustered. 
Default value 50 points.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_legend">legend</code></td>
<td>
<p>logical to determine if legend should be drawn or not.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_legend_breaks">legend_breaks</code></td>
<td>
<p>vector of breakpoints for the legend.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_legend_labels">legend_labels</code></td>
<td>
<p>vector of labels for the <code>legend_breaks</code>.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_annotation_row">annotation_row</code></td>
<td>
<p>data frame that specifies the annotations shown on left
side of the heatmap. Each row defines the features for a specific row. The 
rows in the data and in the annotation are matched using corresponding row
names. Note that color schemes takes into account if variable is continuous
or discrete.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_annotation_col">annotation_col</code></td>
<td>
<p>similar to annotation_row, but for columns.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_annotation">annotation</code></td>
<td>
<p>deprecated parameter that currently sets the annotation_col if it is missing</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_annotation_colors">annotation_colors</code></td>
<td>
<p>list for specifying annotation_row and 
annotation_col track colors manually. It is  possible to define the colors 
for only some of the features. Check examples for  details.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_annotation_legend">annotation_legend</code></td>
<td>
<p>boolean value showing if the legend for annotation 
tracks should be drawn.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_annotation_names_row">annotation_names_row</code></td>
<td>
<p>boolean value showing if the names for row annotation 
tracks should be drawn.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_annotation_names_col">annotation_names_col</code></td>
<td>
<p>boolean value showing if the names for column annotation 
tracks should be drawn.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_drop_levels">drop_levels</code></td>
<td>
<p>logical to determine if unused levels are also shown in 
the legend</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_show_rownames">show_rownames</code></td>
<td>
<p>boolean specifying if column names are be shown.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_show_colnames">show_colnames</code></td>
<td>
<p>boolean specifying if column names are be shown.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_main">main</code></td>
<td>
<p>the title of the plot</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_fontsize">fontsize</code></td>
<td>
<p>base fontsize for the plot</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_fontsize_row">fontsize_row</code></td>
<td>
<p>fontsize for rownames (Default: fontsize)</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_fontsize_col">fontsize_col</code></td>
<td>
<p>fontsize for colnames (Default: fontsize)</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_angle_col">angle_col</code></td>
<td>
<p>angle of the column labels, right now one can choose only from few 
predefined options (0, 45, 90, 270 and 315)</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_display_numbers">display_numbers</code></td>
<td>
<p>logical determining if the numeric values are also printed to 
the cells. If this is a matrix (with same dimensions as original matrix), the contents
of the matrix are shown instead of original values.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_number_format">number_format</code></td>
<td>
<p>format strings (C printf style) of the numbers shown in cells. 
For example &quot;<code>%.2f</code>&quot; shows 2 decimal places and &quot;<code>%.1e</code>&quot; shows exponential 
notation (see more in <code><a href="base.html#topic+sprintf">sprintf</a></code>).</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_number_color">number_color</code></td>
<td>
<p>color of the text</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_fontsize_number">fontsize_number</code></td>
<td>
<p>fontsize of the numbers displayed in cells</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_gaps_row">gaps_row</code></td>
<td>
<p>vector of row indices that show where to put gaps into
heatmap. Used only if the rows are not clustered. See <code>cutree_row</code>
to see how to introduce gaps to clustered rows.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_gaps_col">gaps_col</code></td>
<td>
<p>similar to gaps_row, but for columns.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_labels_row">labels_row</code></td>
<td>
<p>custom labels for rows that are used instead of rownames.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_labels_col">labels_col</code></td>
<td>
<p>similar to labels_row, but for columns.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_filename">filename</code></td>
<td>
<p>file path where to save the picture. Filetype is decided by 
the extension in the path. Currently following formats are supported: png, pdf, tiff,
bmp, jpeg. Even if the plot does not fit into the plotting window, the file size is 
calculated so that the plot would fit there, unless specified otherwise.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_width">width</code></td>
<td>
<p>manual option for determining the output file width in inches.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_height">height</code></td>
<td>
<p>manual option for determining the output file height in inches.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_silent">silent</code></td>
<td>
<p>do not draw the plot (useful when using the gtable output)</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_na_col">na_col</code></td>
<td>
<p>specify the color of the NA cell in the matrix.</p>
</td></tr>
<tr><td><code id="pheatmap_+3A_...">...</code></td>
<td>
<p>graphical parameters for the text used in plot. Parameters passed to 
<code><a href="grid.html#topic+grid.text">grid.text</a></code>, see <code><a href="grid.html#topic+gpar">gpar</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function also allows to aggregate the rows using kmeans clustering. This is 
advisable if number of rows is so big that R cannot handle their hierarchical 
clustering anymore, roughly more than 1000. Instead of showing all the rows 
separately one can cluster the rows in advance and show only the cluster centers. 
The number of clusters can be tuned with parameter kmeans_k.
</p>


<h3>Value</h3>

<p>Invisibly a <code>pheatmap</code> object that is a list with components 
</p>

<ul>
<li> <p><code>tree_row</code> the clustering of rows as <code><a href="stats.html#topic+hclust">hclust</a></code> object 
</p>
</li>
<li> <p><code>tree_col</code> the clustering of columns as <code><a href="stats.html#topic+hclust">hclust</a></code> object
</p>
</li>
<li> <p><code>kmeans</code> the kmeans clustering of rows if parameter <code>kmeans_k</code> was 
specified 
</p>
</li>
<li> <p><code>gtable</code> a <code><a href="gtable.html#topic+gtable">gtable</a></code> object containing the heatmap, 
can be used for combining the heatmap with other plots 
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Raivo Kolde &lt;rkolde@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create test matrix
test = matrix(rnorm(200), 20, 10)
test[1:10, seq(1, 10, 2)] = test[1:10, seq(1, 10, 2)] + 3
test[11:20, seq(2, 10, 2)] = test[11:20, seq(2, 10, 2)] + 2
test[15:20, seq(2, 10, 2)] = test[15:20, seq(2, 10, 2)] + 4
colnames(test) = paste("Test", 1:10, sep = "")
rownames(test) = paste("Gene", 1:20, sep = "")

# Draw heatmaps
pheatmap(test)
pheatmap(test, kmeans_k = 2)
pheatmap(test, scale = "row", clustering_distance_rows = "correlation")
pheatmap(test, color = colorRampPalette(c("navy", "white", "firebrick3"))(50))
pheatmap(test, cluster_row = FALSE)
pheatmap(test, legend = FALSE)

# Show text within cells
pheatmap(test, display_numbers = TRUE)
pheatmap(test, display_numbers = TRUE, number_format = "\%.1e")
pheatmap(test, display_numbers = matrix(ifelse(test &gt; 5, "*", ""), nrow(test)))
pheatmap(test, cluster_row = FALSE, legend_breaks = -1:4, legend_labels = c("0",
"1e-4", "1e-3", "1e-2", "1e-1", "1"))

# Fix cell sizes and save to file with correct size
pheatmap(test, cellwidth = 15, cellheight = 12, main = "Example heatmap")
pheatmap(test, cellwidth = 15, cellheight = 12, fontsize = 8, filename = "test.pdf")

# Generate annotations for rows and columns
annotation_col = data.frame(
                    CellType = factor(rep(c("CT1", "CT2"), 5)), 
                    Time = 1:5
                )
rownames(annotation_col) = paste("Test", 1:10, sep = "")

annotation_row = data.frame(
                    GeneClass = factor(rep(c("Path1", "Path2", "Path3"), c(10, 4, 6)))
                )
rownames(annotation_row) = paste("Gene", 1:20, sep = "")

# Display row and color annotations
pheatmap(test, annotation_col = annotation_col)
pheatmap(test, annotation_col = annotation_col, annotation_legend = FALSE)
pheatmap(test, annotation_col = annotation_col, annotation_row = annotation_row)

# Change angle of text in the columns
pheatmap(test, annotation_col = annotation_col, annotation_row = annotation_row, angle_col = "45")
pheatmap(test, annotation_col = annotation_col, angle_col = "0")

# Specify colors
ann_colors = list(
    Time = c("white", "firebrick"),
    CellType = c(CT1 = "#1B9E77", CT2 = "#D95F02"),
    GeneClass = c(Path1 = "#7570B3", Path2 = "#E7298A", Path3 = "#66A61E")
)

pheatmap(test, annotation_col = annotation_col, annotation_colors = ann_colors, main = "Title")
pheatmap(test, annotation_col = annotation_col, annotation_row = annotation_row, 
         annotation_colors = ann_colors)
pheatmap(test, annotation_col = annotation_col, annotation_colors = ann_colors[2]) 

# Gaps in heatmaps
pheatmap(test, annotation_col = annotation_col, cluster_rows = FALSE, gaps_row = c(10, 14))
pheatmap(test, annotation_col = annotation_col, cluster_rows = FALSE, gaps_row = c(10, 14), 
         cutree_col = 2)

# Show custom strings as row/col names
labels_row = c("", "", "", "", "", "", "", "", "", "", "", "", "", "", "", 
"", "", "Il10", "Il15", "Il1b")

pheatmap(test, annotation_col = annotation_col, labels_row = labels_row)

# Specifying clustering from distance matrix
drows = dist(test, method = "minkowski")
dcols = dist(t(test), method = "minkowski")
pheatmap(test, clustering_distance_rows = drows, clustering_distance_cols = dcols)

# Modify ordering of the clusters using clustering callback option
callback = function(hc, mat){
    sv = svd(t(mat))$v[,1]
    dend = reorder(as.dendrogram(hc), wts = sv)
    as.hclust(dend)
}

pheatmap(test, clustering_callback = callback)

## Not run: 
# Same using dendsort package
library(dendsort)

callback = function(hc, ...){dendsort(hc)}
pheatmap(test, clustering_callback = callback)

## End(Not run)

</code></pre>

<hr>
<h2 id='pheatmap-package'>Pretty heatmaps</h2><span id='topic+pheatmap-package'></span>

<h3>Description</h3>

<p>Implementation of heatmaps that offers more control
over dimensions and appearance.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
