<!DOCTYPE html><html><head><title>Help for package intRvals</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {intRvals}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anova.intRvals'><p>Compares model fits of <code>intRvals</code> objects</p></a></li>
<li><a href='#estinterval'><p>Estimate interval model accounting for missed arrival observations</p></a></li>
<li><a href='#fold'><p>Folds observed arrival intervals to a fundamental interval</p></a></li>
<li><a href='#fundamental'><p>Estimate which intervals are fundamental</p></a></li>
<li><a href='#goosedrop'><p>Dataset with dropping intervals observed for foraging Brent Geese (Branta bernicla bernicla)</p></a></li>
<li><a href='#interval2rate'><p>Conversion of interval estimates to rates</p></a></li>
<li><a href='#intervalpdf'><p>Probability density function of an observed interval distribution</p></a></li>
<li><a href='#intervalsim'><p>Simulate a set of observed intervals</p></a></li>
<li><a href='#intRvals-package'><p>Analysing time-ordered event data with missed observations</p></a></li>
<li><a href='#loglikinterval'><p>log-likelihood of an observed interval distribution</p></a></li>
<li><a href='#partition'><p>Estimate within-group variation</p></a></li>
<li><a href='#plot.intRvals'><p>Plot an interval histogram and fit of intRvals object</p></a></li>
<li><a href='#print.anova.intRvals'><p>print method for class <code>anova.intRvals</code></p></a></li>
<li><a href='#print.intRvals'><p>print method for class <code>intRvals</code></p></a></li>
<li><a href='#print.summary.intRvals'><p>print method for class <code>summary.intRvals</code></p></a></li>
<li><a href='#summary.intRvals'><p>summary method for class <code>intRvals</code></p></a></li>
<li><a href='#ttest'><p>Student's t-test to compare two means of objects of class <code>intRvals</code></p></a></li>
<li><a href='#vartest'><p>F Test to compare two variances of objects of class <code>intRvals</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Time-Ordered Event Data with Missed Observations</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-02</td>
</tr>
<tr>
<td>Author:</td>
<td>Adriaan M. Dokter</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Adriaan M. Dokter &lt;amd427@cornell.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculates event rates and compares means and variances of groups of interval data corrected for missed arrival observations.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GNU General Public License]</td>
</tr>
<tr>
<td>Imports:</td>
<td>plyr,lme4</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-02 18:38:24 UTC; amd427</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-02 22:52:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='anova.intRvals'>Compares model fits of <code>intRvals</code> objects</h2><span id='topic+anova.intRvals'></span>

<h3>Description</h3>

<p>Compare model fits of <code>intRvals</code> objects estimated on the same data.
If one object is provided, the results of a deviance test against a model without a missed event probability 'p'
is reported. If two objects are provided, the results of a deviance test between the model fits of the two objects is given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'intRvals'
anova(
  object,
  y = NULL,
  conf.level = 0.95,
  digits = max(3L, getOption("digits") - 3L),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anova.intRvals_+3A_object">object</code></td>
<td>
<p>an object of class <code>intRvals</code>, usually a result of a call to <a href="#topic+estinterval">estinterval</a></p>
</td></tr>
<tr><td><code id="anova.intRvals_+3A_y">y</code></td>
<td>
<p>an (optional) object of class <code>intRvals</code>, usually a result of a call to <a href="#topic+estinterval">estinterval</a></p>
</td></tr>
<tr><td><code id="anova.intRvals_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for the deviance test</p>
</td></tr>
<tr><td><code id="anova.intRvals_+3A_digits">digits</code></td>
<td>
<p>the number of digits for printing to screen</p>
</td></tr>
<tr><td><code id="anova.intRvals_+3A_...">...</code></td>
<td>
<p>other arguments to be passed to low level functions</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class &quot;<code>anova.intRvals</code>&quot; with the best model (1 or 2), deviance statistic and test results
</p>

<dl>
<dt><code>best.model</code></dt><dd><p>the index of the best model (1 is first argument, 2 is second)</p>
</dd>
<dt><code>deviance</code></dt><dd><p>the deviance between the two tested models</p>
</dd>
<dt><code>p.value</code></dt><dd><p>p-value for the deviance (likelihood-ratio) test</p>
</dd>
<dt><code>conf.level</code></dt><dd><p>assumed confidence level for the test</p>
</dd>
<dt><code>model1.call</code></dt><dd><p>call that generated model 1</p>
</dd>
<dt><code>model2.call</code></dt><dd><p>call that generated model 2</p>
</dd>
<dt><code>AIC</code></dt><dd><p>numeric 2-vector containg the AIC value for model 1 (first element) and model 2 (second element)</p>
</dd>
<dt><code>loglik</code></dt><dd><p>numeric 2-vector containg the log-likelihood value for model 1 (first element) and model 2 (second element)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(goosedrop)
model1=estinterval(goosedrop$interval,fun="gamma")
# visually inspect model1 fit:
plot(model1)
# The observed distribution has intervals near zero.
# We allow a small random baseline to reduce the effect
# of intervals near zero on the fit result.
model2=estinterval(goosedrop$interval,fun="gamma",fpp.method='auto')
# model2 performs better than model1:
anova(model1,model2)
</code></pre>

<hr>
<h2 id='estinterval'>Estimate interval model accounting for missed arrival observations</h2><span id='topic+estinterval'></span>

<h3>Description</h3>

<p>Estimate interval mean and variance accounting for missed arrival observations,
by fitting the probability density function <a href="#topic+intervalpdf">intervalpdf</a> to the interval data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estinterval(
  data,
  mu = median(data),
  sigma = sd(data)/2,
  p = 0.2,
  N = 5L,
  fun = "gamma",
  trunc = c(0, Inf),
  fpp = (if (fpp.method == "fixed") 0 else 0.1),
  fpp.method = "auto",
  p.method = "auto",
  conf.level = 0.9,
  group = NA,
  sigma.within = NA,
  iter = 10,
  tol = 0.001,
  silent = F,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estinterval_+3A_data">data</code></td>
<td>
<p>A numeric list of intervals.</p>
</td></tr>
<tr><td><code id="estinterval_+3A_mu">mu</code></td>
<td>
<p>Start value for the numeric optimization for the mean arrival interval.</p>
</td></tr>
<tr><td><code id="estinterval_+3A_sigma">sigma</code></td>
<td>
<p>Start value for the numeric optimization for the standard deviation of the arrival interval.</p>
</td></tr>
<tr><td><code id="estinterval_+3A_p">p</code></td>
<td>
<p>Start value for the numeric optimization for the probability to not observe an arrival.</p>
</td></tr>
<tr><td><code id="estinterval_+3A_n">N</code></td>
<td>
<p>Maximum number of missed observations to be taken into account (default N=5).</p>
</td></tr>
<tr><td><code id="estinterval_+3A_fun">fun</code></td>
<td>
<p>Assumed distribution for the intervals, one of &quot;<code>normal</code>&quot; or &quot;<code>gamma</code>&quot;, corresponding
to the <a href="stats.html#topic+Normal">Normal</a> and <a href="stats.html#topic+GammaDist">GammaDist</a> distributions</p>
</td></tr>
<tr><td><code id="estinterval_+3A_trunc">trunc</code></td>
<td>
<p>Use a truncated probability density function with range <code>trunc</code></p>
</td></tr>
<tr><td><code id="estinterval_+3A_fpp">fpp</code></td>
<td>
<p>Baseline proportion of intervals distributed as a random poisson process with mean arrival interval <code>mu</code></p>
</td></tr>
<tr><td><code id="estinterval_+3A_fpp.method">fpp.method</code></td>
<td>
<p>A string equal to 'fixed' or 'auto'. When 'auto' <code>fpp</code> is optimized as a free model parameter,
in which case <code>fpp</code> is taken as start value in the optimisation</p>
</td></tr>
<tr><td><code id="estinterval_+3A_p.method">p.method</code></td>
<td>
<p>A string equal to 'fixed' or 'auto'. When 'auto' <code>p</code> is optimized as a free model parameter,
in which case <code>p</code> is taken as start value in the optimisation</p>
</td></tr>
<tr><td><code id="estinterval_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level for deviance test that checks whether model with nonzero missed event probability
<code>p</code> significantly outperforms a model without a missed event probability (<code>p=0</code>).</p>
</td></tr>
<tr><td><code id="estinterval_+3A_group">group</code></td>
<td>
<p>optional vector of equal length as data, indicating the group or subject in which the interval was observed</p>
</td></tr>
<tr><td><code id="estinterval_+3A_sigma.within">sigma.within</code></td>
<td>
<p>optional within-subject standard deviation. When equal to default 'NA', assumes
no additional between-subject effect, with <code>sigma.within</code> equal to <code>sigma</code>. When equal to 'auto'
an estimate is provided by iteratively calling <a href="#topic+partition">partition</a></p>
</td></tr>
<tr><td><code id="estinterval_+3A_iter">iter</code></td>
<td>
<p>maximum number of iterations in numerical iteration for <code>sigma.within</code></p>
</td></tr>
<tr><td><code id="estinterval_+3A_tol">tol</code></td>
<td>
<p>tolerance in the iteration, when <code>sigma.within</code> changes less than this value in one iteration step, the optimization is considered converged.</p>
</td></tr>
<tr><td><code id="estinterval_+3A_silent">silent</code></td>
<td>
<p>logical. When <code>TRUE</code> print no information to console</p>
</td></tr>
<tr><td><code id="estinterval_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <a href="stats.html#topic+optim">optim</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probability density function for observed intervals <a href="#topic+intervalpdf">intervalpdf</a>
is fit to <code>data</code> by maximization of the
associated log-likelihood using <a href="stats.html#topic+optim">optim</a>.
</p>
<p>Within-group variation <code>sigma.within</code> may be separated from the total variation <code>sigma</code> in an iterative fit of <a href="#topic+intervalpdf">intervalpdf</a> on the interval data.
In the iteration <a href="#topic+partition">partition</a> is used to (1) determine which intervals according to the fit are a fundamental interval at a confidence level <code>conf.level</code>,
and (2) to partition the within-group variation from the total variation in interval length.
</p>
<p>Within- and between-group variation is estimated on the subset of fundamental intervals with repeated measures only.
As the set of fundamental interval depends on the precise value of <code>sigma.within</code>, the fit of <a href="#topic+intervalpdf">intervalpdf</a> and the subsequent estimation of
<code>sigma.within</code> using <a href="#topic+partition">partition</a> is iterated until both converge to a stable solution. Parameters <code>tol</code>
and <code>iter</code> set the threshold for convergence and the maximum number of iterations.
</p>
<p>We note that an exponential interval model can be fitted by setting <code>fpp=1</code> and <code>fpp.method=fixed</code>.
</p>


<h3>Value</h3>

<p>This function returns an object of class <code>intRvals</code>, which is a list containing the following:
</p>

<dl>
<dt><code>data</code></dt><dd><p>the interval data</p>
</dd>
<dt><code>mu</code></dt><dd><p>the modelled mean interval</p>
</dd>
<dt><code>mu.se</code></dt><dd><p>the modelled mean interval standard error</p>
</dd>
<dt><code>sigma</code></dt><dd><p>the modelled interval standard deviation</p>
</dd>
<dt><code>p</code></dt><dd><p>the modelled probability to not observe an arrival</p>
</dd>
<dt><code>fpp</code></dt><dd><p>the modelled fraction of arrivals following a random poisson process, see <a href="#topic+intervalpdf">intervalpdf</a></p>
</dd>
<dt><code>N</code></dt><dd><p>the highest number of consecutive missed arrivals taken into account, see <a href="#topic+intervalpdf">intervalpdf</a></p>
</dd>
<dt><code>convergence</code></dt><dd><p>convergence field of <a href="stats.html#topic+optim">optim</a></p>
</dd>
<dt><code>counts</code></dt><dd><p>counts field of <a href="stats.html#topic+optim">optim</a></p>
</dd>
<dt><code>loglik</code></dt><dd><p>vector of length 2, with first element the log-likelihood of the fitted model, and second element the log-likelihood of the model without a missed event probability (i.e. <code>p</code>=0)</p>
</dd>
<dt><code>df.residual</code></dt><dd><p>degrees of freedom, a 2-vector (1, number of intervals - <code>n.param</code>)</p>
</dd>
<dt><code>n.param</code></dt><dd><p>number of optimized model parameters</p>
</dd>
<dt><code>p.chisq</code></dt><dd><p>p value for a likelihood-ratio test of a model including a miss probability relative against a model without a miss probability</p>
</dd>
<dt><code>distribution</code></dt><dd><p>assumed interval distribution, one of 'gamma' or 'normal'</p>
</dd>
<dt><code>trunc</code></dt><dd><p>interval range over which the interval pdf was truncated and normalized</p>
</dd>
<dt><code>fpp.method</code></dt><dd><p>A string equal to 'fixed' or 'auto'. When 'auto' <code>fpp</code> has been optimized as a free model parameter</p>
</dd>
<dt><code>p.method</code></dt><dd><p>A string equal to 'fixed' or 'auto'. When 'auto' <code>p</code> has been optimized as a free model parameter</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(goosedrop)
# calculate mean and standard deviation of arrival intervals, accounting for missed observations:
dr=estinterval(goosedrop$interval)
# plot some summary information
summary(dr)
# plot a histogram of the intervals and fit:
plot(dr)
# test whether the mean arrival interval is greater than 200 seconds:
ttest(dr,mu=200,alternative="greater")

# let's estimate mean and variance of dropping intervals by site
# (schiermonnikoog vs terschelling) for time period 5.
# first prepare the two datasets:
set1=goosedrop[goosedrop$site=="schiermonnikoog" &amp; goosedrop$period == 5,]
set2=goosedrop[goosedrop$site=="terschelling"  &amp; goosedrop$period == 5,]
# allowing a fraction of intervals to be distributed randomly (fpp='auto')
dr1=estinterval(set1$interval,fpp.method='auto')
dr2=estinterval(set2$interval,fpp.method='auto')
# plot the fits:
plot(dr1,xlim=c(0,1000))
plot(dr2,xlim=c(0,1000))
# mean dropping interval are not significantly different
# at the two sites (on a 0.95 confidence level):
ttest(dr1,dr2)
# now compare this test with a t-test not accounting for unobserved intervals:
t.test(set1$interval,set2$interval)
# not accounting for missed observations leads to a (spurious)
# larger difference in means, which also increases
# the apparent statistical significance of the difference between means
</code></pre>

<hr>
<h2 id='fold'>Folds observed arrival intervals to a fundamental interval</h2><span id='topic+fold'></span>

<h3>Description</h3>

<p>Folds observed arrival intervals with missed observations back to their most likely fundamental interval
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fold(object, take.sample = F, sigma.within = NA, silent = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fold_+3A_object">object</code></td>
<td>
<p>an object of class <code>intRvals</code>, usually a result of a call to <a href="#topic+estinterval">estinterval</a></p>
</td></tr>
<tr><td><code id="fold_+3A_take.sample">take.sample</code></td>
<td>
<p>when <code>TRUE</code> the number of folds of the fundamental interval is sampled randomly, taking into account the probability weight of each possibility. When <code>FALSE</code> the fold with the highest probability weight is taken.</p>
</td></tr>
<tr><td><code id="fold_+3A_sigma.within">sigma.within</code></td>
<td>
<p>(optional) numeric value with an assumed within-group/subject standard deviation, or '<code>auto</code>' to estimate it automatically using <a href="#topic+partition">partition</a>.</p>
</td></tr>
<tr><td><code id="fold_+3A_silent">silent</code></td>
<td>
<p>logical, if <code>TRUE</code> print no text to console</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Arrival intervals containing missed observations are folded to their most likely
fundamental interval according to a fit of the distribution of intervals by <a href="#topic+estinterval">estinterval</a>.
</p>
<p>There is inherent uncertainty on how many missed arrival events an observed interval contains, and therefore to
which fundamental interval it should be folded. Intervals folded to the fundamental
can therefore introduce extra unexplained variance.
</p>
<p>The default is to fold intervals to the
fundamental with the highest probability weight (<code>take.sample = F</code>). Alternatively, randomly sampled intervals
can be generated, that take into account the probability weights of each possible fold (<code>take.sample = T</code>).
</p>
<p>Intervals <code>x</code> are transformed to their fundamental interval according to
</p>
<p style="text-align: center;"><code class="reqn">\mu+(x-i*\mu)/\sqrt i</code>
</p>

<p>with <code>i-1</code> the estimated number of missed observations within the interval. This transformation scales appropriately
with the expected broadening of the standard distributions <code class="reqn">\phi(x | i \mu,\sqrt i \sigma)</code> with <code>i</code> in <a href="#topic+intervalpdf">intervalpdf</a>.
</p>
<p>When no <code>sigma.within</code> is provided, <code class="reqn">\mu</code> equals the mean arrival rate, estimated by <a href="#topic+estinterval">estinterval</a>.
</p>
<p>When <code>sigma.within</code> is '<code>auto</code>', <code>sigma.within</code> is estimated using <a href="#topic+partition">partition</a>.
</p>
<p>When <code>sigma.within</code> is a user-specified numeric value or '<code>auto</code>', <code class="reqn">\mu</code> is estimated for each group (
as specified in the group argument of <a href="#topic+estinterval">estinterval</a>),
by maximizing the log-likelihood of <a href="#topic+intervalpdf">intervalpdf</a>, with its <code>data</code> argument equals to the intervals of the group,
its <code>sigma</code> argument equal to <code>sigma.within</code>, and its remaining arguments taken from <code>object</code>.
</p>
<p>Intervals assigned to the <code>fpp</code> component (see <a href="#topic+estinterval">estinterval</a>) are not
folded, and return as <code>NA</code> values.
</p>


<h3>Value</h3>

<p>numeric vector with intervals folded into the fundamental interval
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dr=estinterval(goosedrop$interval,group=goosedrop$bout_id)
# fold assuming no within-group variation:
interval.fundamental=fold(dr)
# test whether there is evidence for within-group variation:
partition(dr)$`p&lt;alpha`   #&gt; TRUE
# there is evidence, therefore better to fold
# while accounting for within-group variation:
interval.fundamental=fold(dr,sigma.within='auto')
</code></pre>

<hr>
<h2 id='fundamental'>Estimate which intervals are fundamental</h2><span id='topic+fundamental'></span>

<h3>Description</h3>

<p>Estimates which intervals in a dataset are fundamental intervals, i.e. an
interval not containing a missed arrival observation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fundamental(x, conf.level = 0.9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fundamental_+3A_x">x</code></td>
<td>
<p>object inheriting from class <code>intRvals</code>, usually a result of a call to <code><a href="#topic+estinterval">estinterval</a></code></p>
</td></tr>
<tr><td><code id="fundamental_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for identifying intervals as fundamental</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This functions thus determines for each interval <code>x$data</code> whether it has a probabiliy &gt; <code>conf.level</code> to be
a fundamental interval, given the model fit generated by <a href="#topic+estinterval">estinterval</a> for object <code>x</code>.
</p>
<p>The fit of an <code>intRvals</code> object gives the decomposition of the likelihood of an interval observation
into partial likelihoods <code class="reqn">\phi_{obs}(x,i | \mu, \sigma, p)</code> (see <a href="#topic+intervalpdf">intervalpdf</a>).
If the amplitude of the partial likelihood with i=0 (i.e. the likelihood component without missed observations)
is at least a proportion <code>conf.level</code> of the sum of all terms i=0..N,
an interval is considered to be fundamental (not containing a missed event observation).
</p>


<h3>Value</h3>

<p>logical atomic vector of the same length as <code>x$data</code>
</p>

<hr>
<h2 id='goosedrop'>Dataset with dropping intervals observed for foraging Brent Geese (Branta bernicla bernicla)</h2><span id='topic+goosedrop'></span>

<h3>Description</h3>

<p>The dataset contains observations from two sites: the island of Schiermonnikoog (saltmarsh) and Terschelling (agricultural grassland).
Brent geese were observed continuously with spotting scopes, and the time when geese excreted a dropping was written down.
The time in seconds between wo subsequently observed dropping arrivals of a single individual refers to one dropping interval.
The variables are as follows:
</p>

<dl>
<dt><code>date</code></dt><dd><p>observation start time of the interval</p>
</dd>
<dt><code>interval</code></dt><dd><p>length of the interval in seconds</p>
</dd>
<dt><code>bout_length</code></dt><dd><p>total observation time of individual</p>
</dd>
<dt><code>prop_abdomen_seen</code></dt><dd><p>proportion of total observation time when abdomen could be observed</p>
</dd>
<dt><code>bout_id</code></dt><dd><p>intervals belonging to the same observation bout of an individual have the same <code>bout_id</code></p>
</dd>
<dt><code>site</code></dt><dd><p>observation site. One of 'terschelling' (agricultural grassland) or 'schiermonnikoog' (salt marsh)</p>
</dd>
<dt><code>period</code></dt><dd><p>two-week observation period (1-5)</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>goosedrop
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 705 rows and 7 columns.
</p>


<h3>Author(s)</h3>

<p>Adriaan Dokter <a href="mailto:a.m.dokter@uva.nl">a.m.dokter@uva.nl</a>
</p>

<hr>
<h2 id='interval2rate'>Conversion of interval estimates to rates</h2><span id='topic+interval2rate'></span>

<h3>Description</h3>

<p>Conversion of interval estimates to rates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interval2rate(
  data,
  minint = data$mu/100,
  maxint = data$mu + 3 * data$sigma,
  digits = max(3L, getOption("digits") - 3L),
  method = "exact"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interval2rate_+3A_data">data</code></td>
<td>
<p>An object of class <code>intRvals</code>, usually a result of a call to <a href="#topic+estinterval">estinterval</a></p>
</td></tr>
<tr><td><code id="interval2rate_+3A_minint">minint</code></td>
<td>
<p>the minimum interval value from which numerical integrations converting to rates are started</p>
</td></tr>
<tr><td><code id="interval2rate_+3A_maxint">maxint</code></td>
<td>
<p>the maximum interval value up to which numerical integrations converting to rates are continued</p>
</td></tr>
<tr><td><code id="interval2rate_+3A_digits">digits</code></td>
<td>
<p>the number of digits for printing to screen</p>
</td></tr>
<tr><td><code id="interval2rate_+3A_method">method</code></td>
<td>
<p>A string equal to 'exact' or 'taylor'. When 'exact' exact formula or numeric integration
is used. When 'taylor' a Taylor approximation is used as in standard propagation of uncertainty in the case of division.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Gamma-distributed intervals</h4>

<p>When inter-arrival times (intervals) follow a gamma distribution with mean <code class="reqn">\mu</code> and
standard deviation <code class="reqn">\sigma</code>, i.e. follow the probability density function
<code><a href="stats.html#topic+GammaDist">GammaDist</a>(shape=</code><code class="reqn">\alpha=\mu^2/\sigma^2</code><code>, scale=</code><code class="reqn">\beta=\sigma^2/\mu)</code>,
then the associated distribution of rates is given by an inverse gamma distribution
with shape parameter <code class="reqn">\alpha</code> and scale parameter <code class="reqn">1/\beta</code>.
</p>
<p>The mean of this inverse gamma distribution is given by the formula
</p>
<p style="text-align: center;"><code class="reqn">\mu_{rate}=\mu/(\mu^2 - \sigma^2)</code>
</p>

<p>provided that <code class="reqn">\alpha &gt; 1</code>, i.e. <code class="reqn">\mu &gt; \sigma</code>.
</p>
<p>The variance of this inverse gamma distribution is given by the formula
</p>
<p style="text-align: center;"><code class="reqn">\sigma^2_{rate}=\mu^2\sigma^2/((\mu^2 - \sigma^2)(\mu^2 - 2\sigma^2)^2</code>
</p>

<p>provided that <code class="reqn">\alpha &gt; 2</code>, i.e. <code class="reqn">\mu &gt; sqrt(2) * \sigma</code>.
</p>
<p>Values <code class="reqn">\mu</code> and <code class="reqn">\sigma</code> are estimated on the interval data, and
above formula are used to calculate the estimated mean and variance of the arrival rate.
</p>
<p>If these formula cannot be used (because the provisions on the value
of <code class="reqn">\alpha</code> are not met), numerical integration is used instead,
analagous to the procedure for normal-distributed intervals, see below.
</p>



<h4>Normal-distributed intervals</h4>

<p>When inter-arrival times (intervals) <code class="reqn">x</code> follow a normal distribution with mean <code class="reqn">\mu</code> and
standard deviation <code class="reqn">\sigma</code>, i.e. follow the probability density function
<code><a href="stats.html#topic+Normal">Normal</a>(mean=</code><code class="reqn">\mu</code><code>, sd=</code><code class="reqn">\sigma)</code>,
then the mean rate (<code class="reqn">\mu_{rate}</code>) can be calculated numerically by:
</p>
<p style="text-align: center;"><code class="reqn">\mu_{rate}=\int_0^\infty (1/x) * \phi(x | \mu,\sigma)</code>
</p>

<p>and the variance of the rate (<code class="reqn">\sigma^2_{rate}</code>) by:
</p>
<p style="text-align: center;"><code class="reqn">\sigma^2_{rate}=\int_0^\infty (1/x^2) * \phi(x | \mu,\sigma) -\mu_{rate}^2</code>
</p>

<p>This approximation is only valid for distributions that have a negligable
density near <code class="reqn">x=0</code>, such that the distribution can be effectively
truncated before <code class="reqn">x</code> approaches zero, where the integral is not defined.
For interval data with intervals <code class="reqn">x</code>
near zero, use of a gamma distribution is recommended instead.
</p>



<h3>Value</h3>

<p>The function <code>interval2rate</code> computes and returns a named vector with the rate mean and standard deviation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(goosedrop)
dr=estinterval(goosedrop$interval)
interval2rate(dr)
</code></pre>

<hr>
<h2 id='intervalpdf'>Probability density function of an observed interval distribution</h2><span id='topic+intervalpdf'></span>

<h3>Description</h3>

<p>Observed intervals are assumed to be sampled through observation of continuous
distinct arrivals in time. Two subsequently observed arrivals mark the start and end
of an interval. The probability that an arrival is not observed can be nonzero, leading to
observed intervals at integer multiples of the true interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intervalpdf(
  data = seq(0, 1000),
  mu = 200,
  sigma = 40,
  p = 0.3,
  N = 5L,
  fun = "gamma",
  trunc = c(0, Inf),
  fpp = 0,
  sigma.within = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intervalpdf_+3A_data">data</code></td>
<td>
<p>A list of intervals for which to calculate the probability density</p>
</td></tr>
<tr><td><code id="intervalpdf_+3A_mu">mu</code></td>
<td>
<p>The mean of the true interval distribution</p>
</td></tr>
<tr><td><code id="intervalpdf_+3A_sigma">sigma</code></td>
<td>
<p>The standard deviation of the true interval distribution</p>
</td></tr>
<tr><td><code id="intervalpdf_+3A_p">p</code></td>
<td>
<p>The probability that an arrival that marks the start or end of an interval is not observed</p>
</td></tr>
<tr><td><code id="intervalpdf_+3A_n">N</code></td>
<td>
<p>The maximum number of consecutive missed arrivals to take into consideration</p>
</td></tr>
<tr><td><code id="intervalpdf_+3A_fun">fun</code></td>
<td>
<p>assumed distribution family of the true interval distribution, one of
&quot;<code>normal</code>&quot; or &quot;<code>gamma</code>&quot;, corresponding
to the <a href="stats.html#topic+Normal">Normal</a> and <a href="stats.html#topic+GammaDist">GammaDist</a> distributions.</p>
</td></tr>
<tr><td><code id="intervalpdf_+3A_trunc">trunc</code></td>
<td>
<p>Use a truncated probability density function with range <code>trunc</code></p>
</td></tr>
<tr><td><code id="intervalpdf_+3A_fpp">fpp</code></td>
<td>
<p>Baseline proportion of intervals distributed as a random poisson process with mean arrival rate <code>mu</code></p>
</td></tr>
<tr><td><code id="intervalpdf_+3A_sigma.within">sigma.within</code></td>
<td>
<p>within-subject standard deviation, only available when <code>fun</code> is &quot;normal&quot;</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>General</h4>

<p>intervals x are assumed to follow a standard distribution (either a normal
or gamma distribution) with probability density function <code class="reqn">\phi(x|\mu,\sigma)</code>
with <code class="reqn">\mu</code> the mean arrival interval and <code class="reqn">\sigma</code> its associated standard deviation.
The probability density function <code class="reqn">\phi_{obs}</code> of observed arrival intervals
in a scenario where the probability to not observe an arrival is nonzero,
will be a superposition of several standard distributions, at multiples of the fundamental mean
arrival interval. Standard distribution <code class="reqn">i</code> will correspond to those intervals where <code class="reqn">i</code> arrivals have been
missed consecutively. If <code class="reqn">p</code> equals this probability of not observing an arrival, then the
probability <code class="reqn">P(i)</code> to miss <code class="reqn">i</code> consecutive arrivals equals
</p>
<p style="text-align: center;"><code class="reqn">P(i)=p^i-p^{i+1}</code>
</p>

<p>The width of standard distribution i will be broadened relative to the fundamental, according to
standard uncertainty propagation in the case of addition. Both in the case
of normal and gamma-distributed intervals (see next subsections) we may write for the observed
probability density function, <code class="reqn">\phi_{obs}</code>:
</p>
<p style="text-align: center;"><code class="reqn">\phi_{obs}(x | \mu, \sigma, p)=\sum_{i=1}^\infty \phi_{obs}(x,i | \mu,\sigma,p)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\phi_{obs}(x,i | \mu, \sigma, p)= P(i-1) \phi(x | i \mu,\sqrt i \sigma)</code>
</p>

<p>In practice, this probability density function is well approximate when the infinite sum is capped at a finite integer N.
Be default the sum is ran up to N=5.
</p>



<h4>Gamma-distributed intervals</h4>

<p>By default intervals x are assumed to follow a Gamma (<a href="stats.html#topic+GammaDist">GammaDist</a>) distribution <code class="reqn">Gamma(\mu,\sigma)</code>~<code><a href="stats.html#topic+dgamma">dgamma</a>(shape=</code><code class="reqn">\mu^2/\sigma^2</code><code>, scale=</code><code class="reqn">\sigma^2/\mu)</code>
with a probability density function <code class="reqn">\phi(x)</code>:
</p>
<p style="text-align: center;"><code class="reqn">\phi(x|\mu,\sigma)~Gamma(\mu,\sigma)</code>
</p>

<p>which has a mean <code class="reqn">\mu</code> and standard deviation <code class="reqn">\sigma</code>.
</p>



<h4>Normal-distributed intervals</h4>

<p>intervals x may also be assumed to follow a <a href="stats.html#topic+Normal">Normal</a> distribution <code class="reqn">N(\mu,\sigma)</code>~<code><a href="stats.html#topic+dnorm">dnorm</a>(mean=</code><code class="reqn">\mu</code><code>,sd=</code><code class="reqn">\sigma)</code>,
with a probability density function <code class="reqn">\phi(x)</code>:
</p>
<p style="text-align: center;"><code class="reqn">\phi(x|\mu,\sigma)~N(\mu,\sigma)</code>
</p>

<p>which also has a mean <code class="reqn">\mu</code> and standard deviation <code class="reqn">\sigma</code>. Because intervals
are by definition non-negative, the Normal distribution is always truncated at zero.
In the limit that <code class="reqn">\mu&gt;\sigma</code> the gamma distribution tends to the normal distribution.
</p>



<h4>Within and between-subject variation</h4>

<p>To account for witin-subject and between-subject differences in mean interval length we define
<code class="reqn">\sigma_w</code> as within-subject standard deviation in interval length,
and <code class="reqn">\sigma_b</code> as between-subject standard deviation in interval length,
with <code class="reqn">\sigma^2 = \sigma^2_b + \sigma^2_w</code>.
In the normal limit (<code class="reqn">\mu&gt;\sigma</code>) the population pdf will be a convolution between <code class="reqn">\phi(x|\mu,\sigma_b)</code>
and <code class="reqn">\phi(x|\mu,\sigma_w)</code> equal to:
</p>
<p style="text-align: center;"><code class="reqn">\phi_{obs}(x | \mu, \sigma,\sigma_w,p)=\sum_{i=1}^\infty P(i-1) \phi(x | i \mu,\sqrt i \sigma)</code>
</p>




<h3>Value</h3>

<p>This function returns a list of points describing the interval distribution
</p>


<h3>Examples</h3>

<pre><code class='language-R'># a low probability of not observing an arrival
# results in an observed PDF with primarily
# a single peak, with a mean and standard
# deviation almost identical to the true interval
# distribution:
plot(intervalpdf(mu=200,sigma=40,p=0.01),type='l',col='red')

# a higher probability to miss an arrival
# results in an observed PDF with multiple
# peaks at integer multiples of the mean of the true
# interval distribution
plot(intervalpdf(mu=200,sigma=40,p=0.4),type='l',col='red')
</code></pre>

<hr>
<h2 id='intervalsim'>Simulate a set of observed intervals</h2><span id='topic+intervalsim'></span>

<h3>Description</h3>

<p>Simulate a set of observed intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intervalsim(
  n = 500,
  mu = 200,
  sigma = 40,
  p = 0.3,
  fun = "gamma",
  trunc = c(0, 600),
  fpp = 0,
  n.ind = NA,
  sigma.within = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intervalsim_+3A_n">n</code></td>
<td>
<p>Number of simulated interval observations.</p>
</td></tr>
<tr><td><code id="intervalsim_+3A_mu">mu</code></td>
<td>
<p>Mean arrival interval.</p>
</td></tr>
<tr><td><code id="intervalsim_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the arrival interval.</p>
</td></tr>
<tr><td><code id="intervalsim_+3A_p">p</code></td>
<td>
<p>Probability to not observe an arrival.</p>
</td></tr>
<tr><td><code id="intervalsim_+3A_fun">fun</code></td>
<td>
<p>Assumed distribution for the intervals, one of &quot;<code>normal</code>&quot; or &quot;<code>gamma</code>&quot;, corresponding
to the <a href="stats.html#topic+Normal">Normal</a> and <a href="stats.html#topic+GammaDist">GammaDist</a> distributions</p>
</td></tr>
<tr><td><code id="intervalsim_+3A_trunc">trunc</code></td>
<td>
<p>Observational range of intervals (intervals outside this range won't be observed)</p>
</td></tr>
<tr><td><code id="intervalsim_+3A_fpp">fpp</code></td>
<td>
<p>Baseline proportion of intervals distributed as a random poisson process with mean arrival interval <code>mu</code></p>
</td></tr>
<tr><td><code id="intervalsim_+3A_n.ind">n.ind</code></td>
<td>
<p>Number of intervals per group. Ignored without a numeric value for <code>sigma.within</code>.</p>
</td></tr>
<tr><td><code id="intervalsim_+3A_sigma.within">sigma.within</code></td>
<td>
<p>The within-group standard-deviation. When a numeric value is given for <code>sigma.within</code>, <code>sigma</code> denotes the total (within+between subject) standard deviation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simulates the observations process of arrival intervals.
</p>
<p>The default is to not differentiate between
within- and between-group variance.
</p>
<p>If both <code>n.ind</code> and <code>sigma.within</code> have numeric values, intervals are simulated
with separate within-group variation (<code>sigma.within</code>) and between-group variation,
for groups of size <code>n.ind</code>. Intervals belonging to the same group have:
</p>

<ul>
<li><p> a within-group mean interval length that has been randomly drawn from a distribution with mean <code>mu</code>
and between-group standard deviation <code class="reqn">\sqrt{sigma^2 - sigma.within^2}</code>
</p>
</li>
<li><p> a within-group standard deviation in interval length equal to <code>sigma.within</code>
</p>
</li></ul>



<h3>Value</h3>

<p>This function returns a dataframe containing the following:
</p>

<dl>
<dt><code>interval</code></dt><dd><p>the simulated interval data</p>
</dd>
<dt><code>group_id</code></dt><dd><p>a group identifier</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'># simulate observed intervals:
intervals=intervalsim(n=50,mu=200,sigma=40,trunc=c(0,600),fpp=0.1)
# check whether we retrieve the simulation parameters:
estinterval(goosedrop$interval)
</code></pre>

<hr>
<h2 id='intRvals-package'>Analysing time-ordered event data with missed observations</h2><span id='topic+intRvals'></span><span id='topic+intRvals-package'></span>

<h3>Description</h3>

<p><span class="pkg">intRvals</span> calculates means and variances of arrival intervals (and arrival rates)
corrected for missed arrival observations, and compares means
and variances of groups of interval data.
</p>


<h3>Details</h3>



<h4>General</h4>

<p>The central function of package <span class="pkg">intRvals</span> is
<code><a href="#topic+estinterval">estinterval</a></code>, which is used to estimate the
mean arrival interval (and its standard deviation) from interval
data with missed arrivals. This is
achieved by fitting the theoretical probability density
<code><a href="#topic+intervalpdf">intervalpdf</a></code> to the interval data
</p>
<p>The package can be used to analyse general interval data where
intervals are derived from distinct arrival observations.
For example, the authors have used it to analyze dropping intervals
of grazing geese for estimating their faecal output.
</p>
<p>Intervals are defined as the time between observed arrival events (e.g. the time between one excreted droppings to the next)
The package provides a way of taking into account missed observations
(e.g. defecations), which lead to occasional observed intervals at integer multiples of the
true arrival interval.
</p>



<h4>Typical workflow</h4>


<ol>
<li><p>Fit interval model <code>m</code> to an interval dataset <code>d</code> using <code><a href="#topic+estinterval">estinterval</a></code>, as in <code>m=estinterval(d)</code>.
</p>
</li>
<li><p>Visually inspect model fits using <code><a href="#topic+plot.intRvals">plot.intRvals</a></code>, as in <code>plot(m)</code>.
</p>
</li>
<li><p>Use <code><a href="#topic+anova.intRvals">anova.intRvals</a></code> to check whether the missed event probability was signficantly different from zero, as in <code>anova(m)</code>.
</p>
</li>
<li><p>Also use <code><a href="#topic+anova.intRvals">anova.intRvals</a></code> to perform model selection between competing models <code>m1</code>,<code>m2</code> for the same interval dataset <code>d</code>, as in <code>anova(m1,m2)</code>.
</p>
</li>
<li><p>Compare means and variances between different interval datasets <code>d1</code>,<code>d2</code> using <code><a href="#topic+ttest">ttest</a></code> and <code><a href="#topic+vartest">vartest</a></code>.
</p>
</li></ol>




<h4>Other useful functionality</h4>

<p><code><a href="#topic+fold">fold</a></code> provides functionality to fold observed intervals back to their fundamental interval
</p>
<p><code><a href="#topic+fundamental">fundamental</a></code> tests which intervals are fundamental, i.e. intervals not containing a missed arrival observation
</p>
<p><code><a href="#topic+interval2rate">interval2rate</a></code> converts interval estimates to rates
</p>
<p><code><a href="#topic+partition">partition</a></code> estimates and tests for the presence of within-subject variation
</p>
<p><code><a href="#topic+intervalsim">intervalsim</a></code> simulates a set of observed intervals
</p>
<p>The package comes with a example interval dataset <code><a href="#topic+goosedrop">goosedrop</a></code>
</p>
<p>Please cite this package using the publication &quot;Analysing time-ordered event data with missed observations, Ecology and Evolution, 2017&quot; by Dokter et al.
</p>



<h3>References</h3>

<p>Dokter, A.M., van Loon, E.E., Fokkema, W., Lameris, T.K, , Nolet, B.A. and van der Jeugd, H.P. 2017. Analysing time-ordered event data with missed observations, Ecology and Evolution, 2017, in press.
</p>
<p>B\'edard, J. &amp; Gauthier, G. 1986. Assessment of faecal output in geese. Journal of Applied Ecology, 23, 77-90.
</p>
<p>Owen, M. 1971. The Selection of Feeding Site by White-Fronted Geese in Winter. Journal of Applied Ecology 8: 905-917.
</p>

<hr>
<h2 id='loglikinterval'>log-likelihood of an observed interval distribution</h2><span id='topic+loglikinterval'></span>

<h3>Description</h3>

<p>log-likelihood of an observed interval distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglikinterval(
  data,
  mu,
  sigma,
  p,
  N = 5L,
  fun = "gamma",
  trunc = c(0, Inf),
  fpp = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglikinterval_+3A_data">data</code></td>
<td>
<p>A numeric list of intervals.</p>
</td></tr>
<tr><td><code id="loglikinterval_+3A_mu">mu</code></td>
<td>
<p>mean arrival interval.</p>
</td></tr>
<tr><td><code id="loglikinterval_+3A_sigma">sigma</code></td>
<td>
<p>standard deviation of the arrival interval.</p>
</td></tr>
<tr><td><code id="loglikinterval_+3A_p">p</code></td>
<td>
<p>chance to not observe an arrival.</p>
</td></tr>
<tr><td><code id="loglikinterval_+3A_n">N</code></td>
<td>
<p>Maximum number of missed observations to be taken into account (default N=5).</p>
</td></tr>
<tr><td><code id="loglikinterval_+3A_fun">fun</code></td>
<td>
<p>Assumed distribution for the intervals, one of &quot;<code>normal</code>&quot; or &quot;<code>gamma</code>&quot;, corresponding
to the <a href="stats.html#topic+Normal">Normal</a> and <a href="stats.html#topic+GammaDist">GammaDist</a> distributions</p>
</td></tr>
<tr><td><code id="loglikinterval_+3A_trunc">trunc</code></td>
<td>
<p>Use a truncated probability density function with range <code>trunc</code></p>
</td></tr>
<tr><td><code id="loglikinterval_+3A_fpp">fpp</code></td>
<td>
<p>Baseline proportion of intervals distributed as a random poisson process with mean arrival interval <code>mu</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Refer to <a href="#topic+intervalpdf">intervalpdf</a> for details on the functional form of
the probability density function of an observed interval distribution <code class="reqn">\phi_{obs}</code>.
The log-likelihood <code class="reqn">L</code> given a set of intervals <code class="reqn">x_j</code> in <code>data</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">L(\mu,\sigma,p)=\log \sum_j \phi_{obs}(x_j | \mu,\sigma,p)</code>
</p>

<p>The function is provided to allow likelihood maximisation by other optimization
tools than the default by <a href="stats.html#topic+optim">optim</a>.
</p>


<h3>Value</h3>

<p>returns the value of the loglikelihood
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(goosedrop)
loglikinterval(goosedrop$interval,mu=200,sigma=50,p=.3)
</code></pre>

<hr>
<h2 id='partition'>Estimate within-group variation</h2><span id='topic+partition'></span>

<h3>Description</h3>

<p>Estimate within-group variation in interval length
</p>


<h3>Usage</h3>

<pre><code class='language-R'>partition(x, conf.level = 0.9, alpha = 0.05, silent = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="partition_+3A_x">x</code></td>
<td>
<p>object inheriting from class <code>intRvals</code></p>
</td></tr>
<tr><td><code id="partition_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level passed to function <a href="#topic+fundamental">fundamental</a>, used in selecting fundamental intervals</p>
</td></tr>
<tr><td><code id="partition_+3A_alpha">alpha</code></td>
<td>
<p>significance level for differences within and between groups or subjects</p>
</td></tr>
<tr><td><code id="partition_+3A_silent">silent</code></td>
<td>
<p>logical, if <code>TRUE</code> print no text to console</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Within- and between-group variation is estimated on the subset of fundamental intervals only.
</p>
<p>The subset of fundamental intervals is selected using <a href="#topic+fundamental">fundamental</a>.
</p>
<p>We calculate <code class="reqn">sigma.within = s_w n_{ind}/(n_{ind}+1)</code> with <code class="reqn">s_w</code> the uncorrected sample standard deviation
of within-group centered values (obtained from subtracting the group's mean value from each observation value),
and <code class="reqn">n_{ind}/(n_{ind}+1)</code> Bessel's correction with <code class="reqn">n_{ind}</code> the average number of repeated measures
per group. Significance of within-group variation is determined by testing for a random effect
of group against a constant null model (van de Pol &amp; Wright 2009),
using the R-package lme4 (Bates et al. 2015).
</p>


<h3>Value</h3>

<p>A logical atomic vector indicating which intervals are fundamental.
</p>

<dl>
<dt><code>sigma.within</code></dt><dd><p>within-group standard deviation in interval length, estimated on fundamental intervals with repeated measures only</p>
</dd>
<dt><code>sigma</code></dt><dd><p>the total standard deviation in interval length, copied from <code>x$sigma</code></p>
</dd>
<dt><code>p.within</code></dt><dd><p>p-value form a likelihood-ratio test indicating whether there is evidence for a random effect of group or subject</p>
</dd>
<dt><code>n.within</code></dt><dd><p>average number of intervals per group</p>
</dd>
<dt><code>n.total</code></dt><dd><p>total number of intervals</p>
</dd>
<dt><code>n.repeat</code></dt><dd><p>number of fundamental intervals with repeated measures, the size of the dataset on which <code>sigma.within</code> was estimated</p>
</dd>
<dt><code>p&lt;alpha</code></dt><dd><p>logical. Whether there was significant evidence for a difference in within- and between-group/subject variance</p>
</dd>
</dl>



<h3>References</h3>

<p>van de Pol, M. &amp; Wright, J. (2009). A simple method for distinguishing within- versus between-subject effects using mixed models. Animal Behaviour, 77, 753-758.
</p>
<p>Bates, D., M\&quot;achler, M., Bolker, B.M. &amp; Walker, S.C. (2015). Fitting linear mixed-effects models using lme4. Journal of Statistical Software, 67, 1-48.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># select the group of intervals observed on Terschelling island
dropset=goosedrop[goosedrop$site=="terschelling",]
# estimate an interval model, with separate within- and between-group variation:
dr=estinterval(data=dropset$interval,group = dropset$bout_id)
# plot the model fit:
plot(dr)
# estimate within-group variation, and its significance:
output=partition(dr)
# print within-group standard deviation:
output$sigma.within
# is the model including within-group standard deviation signicant,
# relative to a null model without separate within-group sd,
# at the specified confidence level alpha?
output$`p&lt;alpha`  #&gt; TRUE
</code></pre>

<hr>
<h2 id='plot.intRvals'>Plot an interval histogram and fit of intRvals object</h2><span id='topic+plot.intRvals'></span>

<h3>Description</h3>

<p>Plot an interval histogram and fit of intRvals object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'intRvals'
plot(
  x,
  binsize = 20,
  xlab = "Interval",
  ylab = "Density",
  main = "Interval histogram and fit",
  line.col = "red",
  line.lwd = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.intRvals_+3A_x">x</code></td>
<td>
<p>An intRvals class object</p>
</td></tr>
<tr><td><code id="plot.intRvals_+3A_binsize">binsize</code></td>
<td>
<p>Width of the histogram bins</p>
</td></tr>
<tr><td><code id="plot.intRvals_+3A_xlab">xlab</code></td>
<td>
<p>a title for the x axis</p>
</td></tr>
<tr><td><code id="plot.intRvals_+3A_ylab">ylab</code></td>
<td>
<p>a title for the y axis</p>
</td></tr>
<tr><td><code id="plot.intRvals_+3A_main">main</code></td>
<td>
<p>an overall title for the plot</p>
</td></tr>
<tr><td><code id="plot.intRvals_+3A_line.col">line.col</code></td>
<td>
<p>Color of the plotted curve for the model fit</p>
</td></tr>
<tr><td><code id="plot.intRvals_+3A_line.lwd">line.lwd</code></td>
<td>
<p>Line width of the plotted curve for the model fit</p>
</td></tr>
<tr><td><code id="plot.intRvals_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the low level <a href="graphics.html#topic+hist">hist</a> plotting function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a list with data, corresponding to the model fit
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(goosedrop)
dr=estinterval(goosedrop$interval)
plot(dr)
plot(dr,binsize=10,line.col='blue')
</code></pre>

<hr>
<h2 id='print.anova.intRvals'>print method for class <code>anova.intRvals</code></h2><span id='topic+print.anova.intRvals'></span>

<h3>Description</h3>

<p>print method for class <code>anova.intRvals</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'anova.intRvals'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.anova.intRvals_+3A_x">x</code></td>
<td>
<p>An object of class <code>anova.intRvals</code>, usually a result of a call to <a href="#topic+anova.intRvals">anova.intRvals</a></p>
</td></tr>
</table>

<hr>
<h2 id='print.intRvals'>print method for class <code>intRvals</code></h2><span id='topic+print.intRvals'></span>

<h3>Description</h3>

<p>print method for class <code>intRvals</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'intRvals'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.intRvals_+3A_x">x</code></td>
<td>
<p>An object of class <code>intRvals</code>, usually a result of a call to <a href="#topic+estinterval">estinterval</a></p>
</td></tr>
</table>

<hr>
<h2 id='print.summary.intRvals'>print method for class <code>summary.intRvals</code></h2><span id='topic+print.summary.intRvals'></span>

<h3>Description</h3>

<p>print method for class <code>summary.intRvals</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.intRvals'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.intRvals_+3A_x">x</code></td>
<td>
<p>An object of class <code>symmary.intRvals</code>, usually a result of a call to <a href="#topic+summary.intRvals">summary.intRvals</a></p>
</td></tr>
</table>

<hr>
<h2 id='summary.intRvals'>summary method for class <code>intRvals</code></h2><span id='topic+summary.intRvals'></span>

<h3>Description</h3>

<p>summary method for class <code>intRvals</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'intRvals'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.intRvals_+3A_object">object</code></td>
<td>
<p>An object of class <code>intRvals</code>, usually a result of a call to <a href="#topic+estinterval">estinterval</a></p>
</td></tr>
<tr><td><code id="summary.intRvals_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>summary.intRvals</code> computes and returns a list of summary statistics
</p>

<dl>
<dt><code>data</code></dt><dd><p>the interval data</p>
</dd>
<dt><code>mu</code></dt><dd><p>the modelled mean interval</p>
</dd>
<dt><code>mu.se</code></dt><dd><p>the modelled mean interval standard error</p>
</dd>
<dt><code>sigma</code></dt><dd><p>the modelled interval standard deviation</p>
</dd>
<dt><code>p</code></dt><dd><p>the modelled probability to not observe an arrival</p>
</dd>
<dt><code>fpp</code></dt><dd><p>the modelled fraction of arrivals following a random poisson process, see <a href="#topic+intervalpdf">intervalpdf</a></p>
</dd>
<dt><code>N</code></dt><dd><p>the highest number of consecutive missed arrivals taken into account, see <a href="#topic+intervalpdf">intervalpdf</a></p>
</dd>
<dt><code>convergence</code></dt><dd><p>convergence field of <a href="stats.html#topic+optim">optim</a></p>
</dd>
<dt><code>counts</code></dt><dd><p>counts field of <a href="stats.html#topic+optim">optim</a></p>
</dd>
<dt><code>loglik</code></dt><dd><p>vector of length 2, with first element the log-likelihood of the fitted model, and second element the log-likelihood of the model without a missed event probability (i.e. <code>p</code>=0)</p>
</dd>
<dt><code>df.residual</code></dt><dd><p>degrees of freedom, a 2-vector (1, number of intervals - <code>n.param</code>)</p>
</dd>
<dt><code>n.param</code></dt><dd><p>number of optimized model parameters</p>
</dd>
<dt><code>distribution</code></dt><dd><p>assumed interval distribution, one of 'gamma' or 'normal'</p>
</dd>
<dt><code>trunc</code></dt><dd><p>interval range over which the interval pdf was truncated and normalized</p>
</dd>
<dt><code>fpp.method</code></dt><dd><p>A string equal to 'fixed' or 'auto'. When 'auto' fpp has been optimized as a free model parameter. When 'fixed' the model is fitted with a fixed value set by parameter <code>fpp</code></p>
</dd>
<dt><code>deviance</code></dt><dd><p>deviance between the fitted model and a model without a missed event probability (i.e. <code>p</code>=0)</p>
</dd>
<dt><code>p.value</code></dt><dd><p>numeric vector with two elements. First element contains the p.value for a
likelihood ratio (deviance) test between the fitted model and a model without a missed event probability (i.e. <code>p</code>=0).
Second element contains the p.value for a likelihood ratio (deviance) test between the fitted model and a saturated null model.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(goosedrop)
dr=estinterval(goosedrop$interval)
summary(dr)
</code></pre>

<hr>
<h2 id='ttest'>Student's t-test to compare two means of objects of class <code>intRvals</code></h2><span id='topic+ttest'></span>

<h3>Description</h3>

<p>Performs one and two sample t-tests on objects of class <code>intRvals</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ttest(
  x,
  y = NULL,
  alternative = c("two.sided", "less", "greater"),
  mu = 0,
  var.equal = FALSE,
  conf.level = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ttest_+3A_x">x</code></td>
<td>
<p>an object of class <code>intRvals</code>, usually a result of a call to <a href="#topic+estinterval">estinterval</a></p>
</td></tr>
<tr><td><code id="ttest_+3A_y">y</code></td>
<td>
<p>an (optional) object of class <code>intRvals</code>, usually a result of a call to <a href="#topic+estinterval">estinterval</a></p>
</td></tr>
<tr><td><code id="ttest_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis, must be one of &quot;<code>two.sided</code>&quot; (default), &quot;<code>greater</code>&quot; or &quot;<code>less</code>&quot;. You can specify just the initial letter.</p>
</td></tr>
<tr><td><code id="ttest_+3A_mu">mu</code></td>
<td>
<p>a number indicating the true value of the mean (or difference in means if you are performing a two sample test).</p>
</td></tr>
<tr><td><code id="ttest_+3A_var.equal">var.equal</code></td>
<td>
<p>a logical variable indicating whether to treat the two variances as being equal. If TRUE then the pooled variance is used to estimate the variance otherwise the Welch (or Satterthwaite) approximation to the degrees of freedom is used.</p>
</td></tr>
<tr><td><code id="ttest_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level of the interval</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>alternative = "greater"</code> is the alternative that <code>x</code> has a larger mean than <code>y</code>.
</p>
<p>If the input data are effectively constant (compared to the larger of the two means) an error is generated.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the same components as in <a href="stats.html#topic+t.test">t.test</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(goosedrop)
dr=estinterval(goosedrop$interval)
# perform a one-sample t-test
ttest(dr,mu=200)  #&gt; FALSE, true mean not equal to 200
# two sample t-test
data.beforeMay=goosedrop[goosedrop$date&lt;as.POSIXct('2013-05-01'),]
data.afterMay=goosedrop[goosedrop$date&gt;as.POSIXct('2013-05-01'),]
dr.beforeMay=estinterval(data.beforeMay$interval)
dr.afterMay=estinterval(data.afterMay$interval)
ttest(dr.beforeMay,dr.afterMay)

</code></pre>

<hr>
<h2 id='vartest'>F Test to compare two variances of objects of class <code>intRvals</code></h2><span id='topic+vartest'></span>

<h3>Description</h3>

<p>Performs an F test to compare the variances of objects of class <code>intRvals</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vartest(
  x,
  y,
  ratio = 1,
  alternative = c("two.sided", "less", "greater"),
  conf.level = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vartest_+3A_x">x</code></td>
<td>
<p>an object of class <code>intRvals</code>, usually a result of a call to <a href="#topic+estinterval">estinterval</a></p>
</td></tr>
<tr><td><code id="vartest_+3A_y">y</code></td>
<td>
<p>an (optional) object of class <code>intRvals</code>, usually a result of a call to <a href="#topic+estinterval">estinterval</a></p>
</td></tr>
<tr><td><code id="vartest_+3A_ratio">ratio</code></td>
<td>
<p>the hypothesized ratio of the population variances of <code>x</code> and <code>y</code>.</p>
</td></tr>
<tr><td><code id="vartest_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis, must be one of &quot;<code>two.sided</code>&quot; (default), &quot;<code>greater</code>&quot; or &quot;<code>less</code>&quot;. You can specify just the initial letter.</p>
</td></tr>
<tr><td><code id="vartest_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for the returned confidence interval</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The null hypothesis is that the ratio of the variances of the
data to which the models <code>x</code> and <code>y</code> were fitted, is equal to ratio.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the same components as in <a href="stats.html#topic+var.test">var.test</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(goosedrop)
dr=estinterval(goosedrop$interval)
# split the interval data into two periods
data.beforeMay=goosedrop[goosedrop$date&lt;as.POSIXct('2013-05-01'),]
data.afterMay=goosedrop[goosedrop$date&gt;as.POSIXct('2013-05-01'),]
dr.beforeMay=estinterval(data.beforeMay$interval)
dr.afterMay=estinterval(data.afterMay$interval)
# perform an F test
vartest(dr.beforeMay,dr.afterMay)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
