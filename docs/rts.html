<!DOCTYPE html><html><head><title>Help for package rts</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rts}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#apply.monthly'><p>Apply a function over calendar periods</p></a></li>
<li><a href='#cellFromXY'><p>Get cell number from row, column or XY</p></a></li>
<li><a href='#endpoints'><p>Locate endpoints by time</p></a></li>
<li><a href='#extract'><p>Extract values from raster time series</p></a></li>
<li><a href='#Extract+20by+20index'><p>Exrtract values from raster time series</p></a></li>
<li><a href='#index'><p>Extracting and replacing the index of raster time series</p></a></li>
<li><a href='#ModisDownload'><p>Download, reproject, and mosaic Modis satellite images</p></a></li>
<li><a href='#period.apply'><p>Apply a function over specified time intervals</p></a></li>
<li><a href='#plot'><p>Plot raster time series</p></a></li>
<li><a href='#RasterStackBrickTS-class'><p> rts classes</p></a></li>
<li><a href='#read.rts'><p>Read raster time Series data from a file</p></a></li>
<li><a href='#rts'><p>Create a Raster Time Series object</p></a></li>
<li><a href='#subset'><p>Subset layers in a raster time series object</p></a></li>
<li><a href='#subset+20by+20index'><p>Subset layers in a raster time series object by index</p></a></li>
<li><a href='#VHPdownload'><p>Download AVHRR-based Vegetation and Drought satellite image products</p></a></li>
<li><a href='#write.rts'><p>Write raster time Series data to a file</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Raster Time Series Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-14</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-01</td>
</tr>
<tr>
<td>Author:</td>
<td>Babak Naimi</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), terra, xts</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, zoo, RCurl, raster</td>
</tr>
<tr>
<td>Suggests:</td>
<td>digest, R.rsp</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Babak Naimi &lt;naimi.b@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>This framework aims to provide classes and methods for manipulating and processing of raster time series data (e.g. a time series of satellite images).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://r-gis.net/">https://r-gis.net/</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-01 01:21:41 UTC; babak</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-01 02:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='apply.monthly'>Apply a function over calendar periods</h2><span id='topic+apply.daily'></span><span id='topic+apply.weekly'></span><span id='topic+apply.monthly'></span><span id='topic+apply.quarterly'></span><span id='topic+apply.yearly'></span><span id='topic+apply.daily+2CRasterStackBrickTS-method'></span><span id='topic+apply.weekly+2CRasterStackBrickTS-method'></span><span id='topic+apply.monthly+2CRasterStackBrickTS-method'></span><span id='topic+apply.quarterly+2CRasterStackBrickTS-method'></span><span id='topic+apply.yearly+2CRasterStackBrickTS-method'></span><span id='topic+apply.daily+2CSpatRasterTS-method'></span><span id='topic+apply.weekly+2CSpatRasterTS-method'></span><span id='topic+apply.monthly+2CSpatRasterTS-method'></span><span id='topic+apply.quarterly+2CSpatRasterTS-method'></span><span id='topic+apply.yearly+2CSpatRasterTS-method'></span>

<h3>Description</h3>

<p>Apply a specified function to each distinct period in a given raster time series object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply.daily(x, FUN, ...)
apply.weekly(x, FUN, ...)
apply.monthly(x, FUN, ...)
apply.quarterly(x, FUN, ...)
apply.yearly(x, FUN, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apply.monthly_+3A_x">x</code></td>
<td>
<p> a raster time series (<code>Raster*TS</code>) object, created by <code><a href="#topic+rts">rts</a></code> </p>
</td></tr>
<tr><td><code id="apply.monthly_+3A_fun">FUN</code></td>
<td>
<p> an <span class="rlang"><b>R</b></span> function </p>
</td></tr>
<tr><td><code id="apply.monthly_+3A_...">...</code></td>
<td>
<p> additional arguments to FUN </p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions offer Simple mechanism to apply a function to non-overlapping time periods, e.g. weekly, monthly, etc, and return a raster time series object including a raster layer for each period in the original data, produced by <code>FUN</code>. The end of each period of time is assigned to the corresponding raster layer in the output.
</p>


<h3>Value</h3>

<p>A raster time series (<code>Raster*TS</code>) object
</p>


<h3>Author(s)</h3>

<p>Babak Naimi
</p>
<p><a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+endpoints">endpoints</a></code>, <code><a href="#topic+period.apply">period.apply</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/ndvi", package="rts")

ndvi &lt;- rts(file) # read the ndvi time series from the specified file
ndvi
ndvi.y &lt;- apply.yearly(ndvi, mean) # apply mean function for each year
ndvi.y
ndvi.q &lt;- apply.quarterly(ndvi,sd) # apply sd function for each quarter of years
ndvi.q 

## End(Not run)
</code></pre>

<hr>
<h2 id='cellFromXY'>Get cell number from row, column or XY</h2><span id='topic+cellFromRowCol'></span><span id='topic+cellFromXY'></span><span id='topic+cellFromRowCol+2CRasterStackBrickTS+2Cnumeric+2Cnumeric-method'></span><span id='topic+cellFromXY+2CRasterStackBrickTS-method'></span><span id='topic+cellFromRowCol+2CSpatRasterTS+2Cnumeric+2Cnumeric-method'></span><span id='topic+cellFromXY+2CSpatRasterTS-method'></span>

<h3>Description</h3>

<p>Get cell number(s) of a Raster*TS object from row and column numbers or X and Y coordinates.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RasterStackBrickTS,numeric,numeric'
cellFromRowCol(object, row, col)
## S4 method for signature 'RasterStackBrickTS'
cellFromXY(object, xy)

## S4 method for signature 'SpatRasterTS,numeric,numeric'
cellFromRowCol(object, row, col)
## S4 method for signature 'SpatRasterTS'
cellFromXY(object, xy)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cellFromXY_+3A_object">object</code></td>
<td>
<p>SpatRaster</p>
</td></tr>
<tr><td><code id="cellFromXY_+3A_col">col</code></td>
<td>
<p>integer. column number(s)</p>
</td></tr>
<tr><td><code id="cellFromXY_+3A_row">row</code></td>
<td>
<p>integer row number(s)</p>
</td></tr>
<tr><td><code id="cellFromXY_+3A_xy">xy</code></td>
<td>
<p>matrix of x and y coordinates</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are essentially a wrapper to <code><a href="raster.html#topic+cellFromRowCol">cellFromRowCol</a></code> and  <code><a href="raster.html#topic+cellFromXY">cellFromXY</a></code>
in <span class="pkg">raster</span> package, work with <code>Raster*TS</code> objects.
</p>


<h3>Value</h3>

<p>row, column or cell number(s). cellFromLine and cellFromPolygon return a list.
</p>


<h3>Author(s)</h3>

<p>Babak Naimi
<a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
<a href="https://r-gis.net/">https://r-gis.net/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/ndvi", package="rts")

rt &lt;- rts(file) # read the ndvi time series from the specified file
cellFromRowCol(rt,15,20)

cellFromRowCol(rt,c(16:20),c(11:15))

cellFromXY(rt,c(645000,57345000))

## End(Not run)

</code></pre>

<hr>
<h2 id='endpoints'>Locate endpoints by time</h2><span id='topic+endpoints'></span><span id='topic+endpoints+2CRasterStackBrickTS-method'></span><span id='topic+endpoints+2CSpatRasterTS-method'></span>

<h3>Description</h3>

<p>Extract index values of a given <code>Raster*TS</code> object corresponding
to the <em>last</em> observations given a period specified by <code>on</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>endpoints(x, on="months", k=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="endpoints_+3A_x">x</code></td>
<td>
<p> a raster time series (<code>Raster*TS</code>) object created by <code><a href="#topic+rts">rts</a></code> </p>
</td></tr>
<tr><td><code id="endpoints_+3A_on">on</code></td>
<td>
<p> the periods endpoints to find as a character string </p>
</td></tr>
<tr><td><code id="endpoints_+3A_k">k</code></td>
<td>
<p> along every k-th element - see notes </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is, indeed, <code><a href="xts.html#topic+endpoints">endpoints</a></code> in <span class="pkg">xts</span> that works with <code>Raster*TS</code> objects. It returns a numeric vector corresponding to the <em>last</em>  observation in each period specified by <code>on</code>, with a zero added to the beginning of the vector, and the index of the last raster in <code>x</code> at the end.
</p>
<p>Valid values for the argument <code>on</code> include: &ldquo;us&rdquo; (microseconds),
&ldquo;microseconds&rdquo;, &ldquo;ms&rdquo; (milliseconds),
&ldquo;milliseconds&rdquo;, &ldquo;secs&rdquo; (seconds),
&ldquo;seconds&rdquo;, &ldquo;mins&rdquo; (minutes), &ldquo;minutes&rdquo;,
&ldquo;hours&rdquo;, &ldquo;days&rdquo;, &ldquo;weeks&rdquo;, &ldquo;months&rdquo;, &ldquo;quarters&rdquo;,
and &ldquo;years&rdquo;.
</p>


<h3>Value</h3>

<p>A numeric vector of endpoints beginning with 0 and ending with a value equal to the number of raster layers in the x argument.
</p>


<h3>Note</h3>

<p>Windows support for subsecond periods is not supported. 
</p>


<h3>Author(s)</h3>

<p>Babak Naimi
</p>
<p><a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>


<h3>See Also</h3>

 <p><code><a href="xts.html#topic+endpoints">endpoints</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/ndvi", package="rts")

ndvi &lt;- rts(file) # read the ndvi time series from the specified file

endpoints(ndvi,"years")

endpoints(ndvi,"quarters")

## End(Not run)

</code></pre>

<hr>
<h2 id='extract'>Extract values from raster time series</h2><span id='topic+extract'></span><span id='topic+extract+2CRasterStackBrickTS+2CSpatial-method'></span><span id='topic+extract+2CRasterStackBrickTS+2CExtent-method'></span><span id='topic+extract+2CRasterStackBrickTS+2Cnumeric-method'></span><span id='topic+extract+2CSpatRasterTS+2CSpatVector-method'></span><span id='topic+extract+2CSpatRasterTS+2CSpatExtent-method'></span><span id='topic+extract+2CSpatRasterTS+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Extract values from a <code>Raster*TS</code> object for the spatial locations which can be specified by spatial points, lines, polygons or an Extent (rectangle) object or raster cell number(s). 
</p>


<h3>Details</h3>

<p>This function uses the <span class="pkg">raster</span> and <span class="pkg">xts</span> packages to extract the values in space and subset them in time by specifying ISO-8601 compatible range strings. This allows for natural range-based time queries without requiring prior knowledge of the underlying time object used in construction.
</p>
<p>When a raw character vector is used for the <code>time</code>, it is processed as if it was ISO-8601 compliant.  This means that it is parsed from left to right, according to the following specification:
</p>
<p>CCYYMMDD HH:MM:SS.ss+
</p>
<p>A full description will be expanded from a left-specified truncated one.
</p>
<p>Additionally, one may specify range-based queries by simply supplying two time descriptions seperated by a forward slash:
</p>
<p>CCYYMMDD HH:MM:SS.ss+/CCYYMMDD HH:MM:SS.ss
</p>
<p>The algorithm to parse the above is <code>.parseISO8601</code> from
the <span class="pkg">xts</span> package.
</p>


<h3>Value</h3>

<p>An <code>rts</code> object.
</p>


<h3>Methods</h3>


<p><code>extract(x, y, time)</code>
</p>
<p>Arguments
</p>
<p><code>x</code>  is a raster time series (<code>Raster*TS</code>) object created by <code><a href="#topic+rts">rts</a></code>
</p>
<p><code>y</code>  is a <code><a href="sp.html#topic+SpatialPoints">SpatialPoints</a>*</code>, <code><a href="sp.html#topic+SpatialPolygons">SpatialPolygons</a>*</code>, <code><a href="sp.html#topic+SpatialLines">SpatialLines</a></code>, <code><a href="raster.html#topic+Extent">Extent</a></code> object, or a vector (representing cell numbers)
</p>
<p><code>time</code> is Optional; the time index for which the values in raster should be extracted. It can be numeric, timeBased or ISO-8601 style (see details)
</p>


<h3>Author(s)</h3>

<p>Babak Naimi
</p>
<p><a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>


<h3>See Also</h3>

<p><code><a href="xts.html#topic++5B.xts">[.xts</a></code> and <code><a href="raster.html#topic+extract">extract</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/ndvi", package="rts")

ndvi &lt;- rts(file) # read the ndvi time series from the specified file

n1 &lt;- extract(ndvi,125)# extract the time series values at cell number 125 for all times

n1

plot(n1)

n2 &lt;- extract(ndvi,125,"/20090101") # extract the time series values at cell number 125
# for all times after 2009-01-01

n2
plot(n2)

n3 &lt;- extract(ndvi,125,"200901/") # extract the time series values at cell number 125 for 
# all times before 2009-01

n4 &lt;- extract(ndvi,10:20,"2008") # extract the values at cell numbers of 10:20 in 
# the year of 2008

n4

## End(Not run)



</code></pre>

<hr>
<h2 id='Extract+20by+20index'>Exrtract values from raster time series</h2><span id='topic++5B+2CRasterStackBrickTS+2CSpatial+2CANY-method'></span><span id='topic++5B+2CRasterStackBrickTS+2Cnumeric+2CANY-method'></span><span id='topic++5B+2CRasterStackBrickTS+2CExtent+2CANY-method'></span><span id='topic++5B+2CSpatRasterTS+2CSpatial+2CANY-method'></span><span id='topic++5B+2CSpatRasterTS+2CSpatVector+2CANY-method'></span><span id='topic++5B+2CSpatRasterTS+2Cnumeric+2CANY-method'></span><span id='topic++5B+2CSpatRasterTS+2CSpatExtent+2CANY-method'></span>

<h3>Description</h3>

<p>This is a short-hand method that acts the same as <code><a href="#topic+extract">extract</a></code>. This method extracts values from a <code>Raster*TS</code> object for spatial locations which can be specified by spatial points, lines, polygons, or an Extent (rectangle) object or raster cell number(s). 
</p>


<h3>Details</h3>

<p>This function uses the <span class="pkg">raster</span> and <span class="pkg">xts</span> packages to extract the values in space and subset them in time by specifying ISO-8601 compatible range strings. This allows for natural range-based time queries without requiring prior knowledge of the underlying time object used in construction.
</p>
<p>When a raw character vector is used for <code>j</code>, it is processed as if it was ISO-8601 compliant.  This means that it is parsed from left to right, according to the following specification:
</p>
<p>CCYYMMDD HH:MM:SS.ss+
</p>
<p>A full description will be expanded from a left-specified truncated one.
</p>
<p>Additionally, one may specify range-based queries by simply supplying two time descriptions seperated by a forward slash:
</p>
<p>CCYYMMDD HH:MM:SS.ss+/CCYYMMDD HH:MM:SS.ss
</p>
<p>The algorithm to parse the above is <code>.parseISO8601</code> from
the <span class="pkg">xts</span> package.
</p>


<h3>Value</h3>

<p><code>rts</code>.
</p>


<h3>Methods</h3>


<p><code>x[i, j]</code>
</p>
<p>Arguments
</p>
<p><code>x</code>  is a raster time series (<code>Raster*TS</code>) object created by <code><a href="#topic+rts">rts</a></code> 
</p>
<p><code>i</code>  is a <code><a href="sp.html#topic+SpatialPoints">SpatialPoints</a>*</code>, <code><a href="sp.html#topic+SpatialPolygons">SpatialPolygons</a>*</code>, <code><a href="sp.html#topic+SpatialLines">SpatialLines</a></code>, <code><a href="raster.html#topic+Extent">Extent</a></code> object, or a vector (representing cell numbers)
</p>
<p><code>j</code>  is optional; the time index for which the values in raster should be extracted. It can be numeric, timeBased or ISO-8601 style (see details)
</p>


<h3>Author(s)</h3>

<p>Babak Naimi
</p>
<p><a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+extract">extract</a></code> and <code><a href="xts.html#topic++5B.xts">[.xts</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/ndvi", package="rts")

ndvi &lt;- rts(file) # read the ndvi time series from the specified file

n1 &lt;- ndvi[125] # extract the time series values at cell number 125 for all available times

n1

plot(n1)

n2 &lt;- ndvi[125,"/20090101"] # extract the time series values at cell number 125 for 
# all times after 2009-01-01

n2

plot(n2)

n3 &lt;- ndvi[125,"200901/"] # extract the time series values at cell number 125 for all
# times before 2009-01

n4 &lt;- ndvi[10:20,"2008-05-01"] #extract the values at cell numbers of 10:20 for 
# the specified time

n4



## End(Not run)

</code></pre>

<hr>
<h2 id='index'>Extracting and replacing the index of raster time series</h2><span id='topic+index'></span><span id='topic+index+3C-'></span><span id='topic+index.RasterStackBrickTS'></span><span id='topic+index.SpatRasterTS'></span><span id='topic+index+3C-.RasterStackBrickTS'></span><span id='topic+index+3C-.SpatRasterTS'></span>

<h3>Description</h3>

<p><code>index</code> is a generic function for extracting the index of a raster time series (<code>Raster*TS</code>) object and replacing it.
</p>
<p><code>index(x) &lt;- value</code>, can be used to replace index with <code>value</code>, a vector of the same length as the number of raster layers in <code>Raster*TS</code> object .</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'RasterStackBrickTS'
index(x, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="index_+3A_x">x</code></td>
<td>
<p>A <code>RasterStack</code> or <code>RasterBrick</code> object </p>
</td></tr>
<tr><td><code id="index_+3A_...">...</code></td>
<td>
<p>further arguments passed to methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Babak Naimi
</p>
<p><a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>


<h3>See Also</h3>

 <p><code><a href="xts.html#topic+index.xts">index.xts</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/ndvi", package="rts")

ndvi &lt;- rts(file) # read the ndvi time series from the specified file

index(ndvi)


## End(Not run)

</code></pre>

<hr>
<h2 id='ModisDownload'>Download, reproject, and mosaic Modis satellite images</h2><span id='topic+ModisDownload'></span><span id='topic+getMODIS'></span><span id='topic+mosaicHDF'></span><span id='topic+reprojectHDF'></span><span id='topic+modisProducts'></span><span id='topic+setNASAauth'></span><span id='topic+setMRTpath'></span><span id='topic+getNativePixelSize'></span><span id='topic+getNativeTemporalResolution'></span><span id='topic+ModisDownload+2Ccharacter-method'></span><span id='topic+ModisDownload+2Cnumeric-method'></span><span id='topic+mosaicHDF+2Ccharacter-method'></span><span id='topic+mosaicHDF+2Cnumeric-method'></span><span id='topic+reprojectHDF+2Ccharacter-method'></span><span id='topic+reprojectHDF+2Cnumeric-method'></span><span id='topic+getMODIS+2Ccharacter-method'></span><span id='topic+getMODIS+2Cnumeric-method'></span><span id='topic+setNASAauth+2CANY-method'></span><span id='topic+setMRTpath+2CANY-method'></span>

<h3>Description</h3>

<p>'ModisDownload' downloads a series of MODIS images in a specific date or a period of times, and for specified tile(s). It can also use MODIS Reproject Tool (MRT) software to mosaic the downloaded images, in case of selecting more than one tile, and reproject them to a specified coordinate system. As the format of the source images in LP DAAC is HDF, this tool can also convert them into other formats (i.e. Geotif, hdr).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setNASAauth(username,password,update,...)

setMRTpath(MRTpath,update,...)

ModisDownload(x,h,v,dates, ...)

getMODIS(x,h,v,dates,version='006',forceReDownload=TRUE,ncore='auto')

mosaicHDF(hdfNames,filename,MRTpath,bands_subset,delete=FALSE)

reprojectHDF(hdfName,crs,subset,resample_method,filename,...)

modisProducts(version=NULL)

getNativePixelSize(product)

getNativeTemporalResolution(product)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ModisDownload_+3A_username">username</code></td>
<td>
<p> character; username for authentication</p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_password">password</code></td>
<td>
<p> character; password for authentication</p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_update">update</code></td>
<td>
<p> logical; specifies whether .nerc file that has been previously created by setNASAauth, should be updated</p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_x">x</code></td>
<td>
<p> product name or a number specifies the product row in the data.frame generated by <code>modisProduct</code> function. It can also be the http address of the product.</p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_h">h</code></td>
<td>
<p> together with <code>v</code> specify the position of the Modis image tile(s). Examples: h=15; h=c(14,15); v=c(4:7) </p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_v">v</code></td>
<td>
<p> see the above descriptopn for <code>h</code> </p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_dates">dates</code></td>
<td>
<p> a character vector with the length of one or two, specifiying an individual date or a range of dates as the form of <code>c(from, to)</code></p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_hdfname">hdfName</code></td>
<td>
<p>the name of hdf file</p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_crs">crs</code></td>
<td>
<p>coordinate reference system definiation (or a SpatRaster defines definition of new Raster for resampling)</p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_subset">subset</code></td>
<td>
<p>integer vector specifies the layer number for subsetting bands</p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_resample_method">resample_method</code></td>
<td>
<p>resample method for reprojection based on GDAL, can be one of &quot;near&quot;,&quot;bilinear&quot;,&quot;cubic&quot;,or &quot;cubicspline&quot; (default: &quot;near&quot;)</p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_hdfnames">hdfNames</code></td>
<td>
<p>the names of hdf files</p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_mrtpath">MRTpath</code></td>
<td>
<p>Path to the bin folder into the installed directory of MRT software. It is needed only if you need to mosaic and/or reproject the images. Example: MRTpath=&quot;d:/MRT/bin&quot;</p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_filename">filename</code></td>
<td>
<p> the name of new file</p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_version">version</code></td>
<td>
<p> the product version. The default value is '006'</p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_bands_subset">bands_subset</code></td>
<td>
<p>HDF-EOS input files contain several layers of data (bands). Through this argument you ca select a subset of bands. You need to know how many bands the product has, and which bands you want to be subset. Example: Suppose your image has 6 bands and you only need the second band. The parameter should be entered as: bands_subset=&quot;0 1 0 0 0 0&quot;.</p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_delete">delete</code></td>
<td>
<p> Logical. If <code>TRUE</code>, the original HDF files will be deleted after mosaic or reproject into new files.</p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_forceredownload">forceReDownload</code></td>
<td>
<p>logical, specify whether the product should be re-downloaded if it had been downloaded before. The downloaded products are cashed using a hash digest of the inputs. If the download is canceled mid-way and the same exact products are downloaded again, it can be useful to avoid re-downloading them.</p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_ncore">ncore</code></td>
<td>
<p>numerical; specify the number of cores used to speed up the download; 'auto' can be used instead to detect the number of cores and use half of them</p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_product">product</code></td>
<td>
<p>The product name; can be extracted from the <code>modisProduct</code> function</p>
</td></tr>
<tr><td><code id="ModisDownload_+3A_...">...</code></td>
<td>
<p> additional arguments including:
</p>
<p>- <code>mosaic</code>: logical, if <code>TRUE</code>, the images (several tiles) are mosaic into a single image
</p>
<p>- <code>proj</code>: Logical. If <code>TRUE</code>, it means that you want to reproject the images. Then reprojectHDF function will be called to reproject the images. 
</p>
<p>- <code>UL</code>: Optional. Upper Left coordinate (x,y) in output coordinate system. Only if you want to spatially subset your images.
</p>
<p>- <code>LR</code>: Optional. Lower right coordinate(x,y). Only if you want to spatially subset your images.
</p>
<p>- <code>resample_type</code>: Resampling kernel type for MRT (&quot;CUBIC_CONVOLUTION&quot;, &quot;NEAREST_NEIGHBOR&quot;, or &quot;BILINEAR&quot;). The default is &quot;NEAREST_NEIGHBOR&quot;.
</p>
<p>- <code>proj_type</code>: Output projection short name. Valid values are &quot;AEA&quot; (Albers EqualArea), &quot;ER&quot; (Equirectangular), &quot;GEO&quot; (Geographic), &quot;IGH&quot; (Interrupted Goode Homolosine), &quot;HAM&quot; (Hammer), &quot;ISIN&quot; (Integerized Sinusoidal), &quot;LA&quot; (Lambert Azimuthal Equal Area), &quot;LCC&quot; (Lambert Conformal Conic), &quot;MERCAT&quot; (Mercator), &quot;MOL&quot; (Molleweide), &quot;PS&quot; (Polar Stereographic), &quot;SIN&quot; (Sinusoidal), &quot;TM&quot; (Transverse Mercator), and &quot;UTM&quot; (Universal Transverse Mercator).
</p>
<p>- <code>proj_params</code>: Output projection parameters. This quoted, floating-point list includes up to 15 projection parameters, with each value separated by white space (&quot;p1 p2 ... p15&quot;). If there are fewer than 15 values specified in the list, the remaining values will be set to zero. Integer values will automatically be converted to floating point (See the MRT software manual for the details).
</p>
<p>- <code>datum</code>: Specifies the output projection datum. The default is &quot;WGS84&quot;
</p>
<p>- <code>utm_zone</code>: Valid only if &quot;UTM&quot; is selected for the proj_type.
</p>
<p>- <code>pixel_size</code>: Output pixel size.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To be able to download the data, you need to register on &quot;https://urs.earthdata.nasa.gov/&quot; and get a username and password. To pass the authentication by the website, you need to set the username and password on the machine (only first time) using <code>setNASAauth</code> function. Just specify the username and password in the function for the first time, and then the ModisDownload function can use it everytime you need to download the data.
</p>
<p>To have the functionality for Mosaic and reprojecting of the images, you need to first install MRT software on your machine, and introduce its' path through the MRTpath argument. Otherwise, it can only be used for automating the downloading procedure.
</p>
<p>The functions <code>ModisDownload</code> uses the functions including  <code>getMODIS</code>, <code>mosaicHDF</code>  (if needed), and <code>reprojectHDF</code>  (if needed). The functions <code>getMODIS</code>, can be used to download HDF files, while  <code>mosaicHDF</code> and <code>reprojectHDF</code> can mosaic and reproject the HDF files, respectively.
</p>


<h3>Author(s)</h3>

<p>Babak Naimi &amp; Pablo Alfaro
</p>
<p><a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(raster)

library(RCurl)

# First, you need to register on https://urs.earthdata.nasa.gov/ and get a username and password
# for the first time, set the authentication info:

setNASAauth(username='myusername',password='mypass') 

# product list:


modisProducts(version=5)
modisProducts(version=6)
modisProducts(version=NULL) # both versions

#x=3 # or x="MOD14A1"

# download 4 tiles (h14v04, h14v05, h15v04, h15v05) in single date (2011.05.01)

# Following command only downloads the source HDF images, no mosaic and no projection

ModisDownload(x=x,h=c(17,18),v=c(4,5),dates='2011.05.01',mosaic=F,proj=F,version='006')

 
# alternatively, you can use getMODIS to download only HDF images:

getMODIS(x=x,h=c(17,18),v=c(4,5),dates='2011.05.01',version='006')

# same as the above command, but downloads all available images in 2011:

ModisDownload(x=x,h=c(17,18),v=c(4,5),dates=c('2011.01.01','2011.12.31'),version='006')

#------

# Downloads selected tiles, and mosaic them, but no projections:

ModisDownload(x=x,h=c(17,18),v=c(4,5),dates=c('2011.05.01','2011.05.31'),
              MRTpath='d:/MRT/bin',mosaic=T,proj=F,version='006')

#--- alternatively, you can first download the HDF images using getMODIS, 
#and then mosaic them using mosaicHDF!

# Downloads selected tiles, and mosaic, reproject them in UTM_WGS84, zone 30 projection and 
#convert all bands into Geotif format (the original HDF will be deleted!):

ModisDownload(x=x,h=c(17,18),v=c(4,5),dates=c('2011.05.01','2011.05.31'),MRTpath='d:/MRT/bin',
              mosaic=T,proj=T,proj_type="UTM",utm_zone=30,datum="WGS84",
              pixel_size=1000,version='006')

# Same as above command, but only second band out of 6 bands will be kept. (You do not need 
#to specify proj_params when "UTM" is selected as proj_type and the zone also is specified,
#but for other types of projections you do).

ModisDownload(x=x,h=c(17,18),v=c(4,5),dates=c('2011.05.01','2011.05.31'),MRTpath='d:/MRT/bin',
              mosaic=T,proj=T, bands_subset="0 1 0 0 0 0", proj_type="UTM",
              proj_params="-3 0 0 0 0 0 0 0 0 0 0 0 0 0 0",utm_zone=30,
              datum="WGS84",pixel_size=1000,version='006')

 
# Same as above command, but it spatially subsets the images into the specified box (UL and LR):

ModisDownload(x=x,h=c(17,18),v=c(4,5),dates=c('2011.05.01','2011.05.31'),MRTpath='d:/MRT/bin',
             mosaic=T,proj=T,UL=c(-42841.0,4871530.0),LR=c(1026104,3983860), 
             bands_subset="0 1 0 0 0 0", proj_type="UTM",
             proj_params="-3 0 0 0 0 0 0 0 0 0 0 0 0 0 0",utm_zone=30,datum="WGS84",
             pixel_size=1000,version='006')



## End(Not run)

</code></pre>

<hr>
<h2 id='period.apply'>Apply a function over specified time intervals</h2><span id='topic+period.apply'></span><span id='topic+period.apply+2CRasterStackTS-method'></span><span id='topic+period.apply+2CRasterBrickTS-method'></span><span id='topic+period.apply+2CSpatRasterTS-method'></span>

<h3>Description</h3>

<p>Apply specified function over each period of date/time defined in INDEX at each grid cell.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>period.apply(x, INDEX, FUN, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="period.apply_+3A_x">x</code></td>
<td>
<p> a raster time series (<code>Raster*TS</code>) object created by <code><a href="#topic+rts">rts</a></code> </p>
</td></tr>
<tr><td><code id="period.apply_+3A_index">INDEX</code></td>
<td>
<p> a numeric vector of endpoints of time/date periods to apply function over </p>
</td></tr>
<tr><td><code id="period.apply_+3A_fun">FUN</code></td>
<td>
<p> an argument of type <code>function</code> </p>
</td></tr>
<tr><td><code id="period.apply_+3A_...">...</code></td>
<td>
<p> additional arguments for <code>FUN</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This functions subsets the raster data based on the specified time periods (endpoint for each period should be specified in <code>INDEX</code>), and <code>FUN</code> function will be applied to the subsetted values at each grid cell for each period. For each period, a raster will be calculated and the end of the date/time period will be assigned to it in the output raster time series object. If the <code>INDEX</code> is out of range, the function stops working and an error is generated.
</p>


<h3>Value</h3>

<p>RasterStackTS or RasterBrickTS
</p>


<h3>Author(s)</h3>

<p>Babak Naimi
</p>
<p><a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>


<h3>See Also</h3>

 <p><code><a href="xts.html#topic+period.apply">period.apply</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/ndvi", package="rts")

ndvi &lt;- rts(file) # read the ndvi time series from the specified file

ndvi

ep &lt;- endpoints(ndvi,'years') # extract the end index on each year period

ndvi.y &lt;- period.apply(ndvi,ep,mean) # apply the mean function on each year

ndvi.y

#---------
ep &lt;- endpoints(ndvi,'quarters') # extract the end index on each quarter of a year

# a function:
f &lt;- function(x) {
  if (min(x) &gt; 0.5) mean(x)
  else 0
}

ndvi.q &lt;- period.apply(ndvi,ep,f) # apply the function f on each quarter


## End(Not run)

</code></pre>

<hr>
<h2 id='plot'>Plot raster time series</h2><span id='topic+plot'></span><span id='topic+plot+2CRasterStackBrickTS-method'></span><span id='topic+plot+2Crts-method'></span><span id='topic+plot+2CRasterStackBrickTS+2CANY-method'></span><span id='topic+plot+2CSpatRasterTS+2CANY-method'></span><span id='topic+plot+2Crts+2CANY-method'></span>

<h3>Description</h3>

<p>Plot raster layers corresponding to specified times, or plot extracted time-series values at a location (cell) or a number of cells as a <code>rts</code> object. </p>


<h3>Usage</h3>

<pre><code class='language-R'>
## S4 method for signature 'RasterStackBrickTS,ANY'
plot(x, y, ...)
## S4 method for signature 'rts,ANY'
plot(x, y, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p> an object of raster time series class (<code>Raster*TS</code>), or an object of <code>rts</code> class.</p>
</td></tr>
<tr><td><code id="plot_+3A_y">y</code></td>
<td>
<p> optional. if <code>x</code> is a <code>Raster*TS</code> object, this item defines time range specifying which layers of raster time series should be plotted. if <code>x</code> is an <code>rts</code> object, this item specifies which column (corresponding to a cell) of time-series data should be plotted (default=1). <code>y='all'</code> indicates all series in <code>rts</code> object should be included in plot.  </p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p> additional argument as in <code>plot</code> in <code>raster</code> package or in <code>graphics</code> package.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>x</code> is a <code>Raster*TS</code> object:
</p>
<p>This function, first, selects the layers corresponding to the time range specified in <code>y</code> and then call <code>plot</code> function in <code>raster</code> package to plot the selected raster layers. If <code>y</code> is not specified, all layers will be sent to <code>plot</code> function.
</p>
<p>Same as in <code><a href="#topic+extract">extract</a></code> and <code><a href="#topic+subset">subset</a></code> functions, When a raw character vector is used for the <code>y</code>, it is processed as if it was ISO-8601 compliant.  This means that it is parsed from left to right, according to the following specification:
</p>
<p>CCYYMMDD HH:MM:SS.ss+
</p>
<p>A full description will be expanded from a left-specified truncated one.
</p>
<p>Additionally, one may specify range-based queries by simply supplying two time descriptions seperated by a forward slash:
</p>
<p>CCYYMMDD HH:MM:SS.ss+/CCYYMMDD HH:MM:SS.ss
</p>
<p><code>x</code> can be an <code>rts</code> object. <code>rts</code> is a subclass of <code>xts</code>, created by <code><a href="#topic+extract">extract</a></code> function.
</p>


<h3>Author(s)</h3>

<p>Babak Naimi 
</p>
<p><a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>


<h3>See Also</h3>

 <p><code><a href="raster.html#topic+plot">plot</a></code>, <code><a href="#topic+extract">extract</a></code>, <code><a href="#topic+subset">subset</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/ndvi", package="rts")

ndvi &lt;- rts(file) # read the ndvi time series from the specified file

plot(ndvi,1:4) # plot the first 4 layers in the raster time series

plot(ndvi,"/20010101")

plot(ndvi,"20010101/20010501")

plot(ndvi,"2001-02-01/2001-05-01")

plot(ndvi,"2001-02-01")


n1 &lt;- extract(ndvi,125)# extract the time series values at cell number 125 for all times


plot(n1)

n2 &lt;- extract(ndvi,125,"/20090101") # extract the time series values at cell number 125
# for all times after 2009-01-01

n2

plot(n2)


n3 &lt;- extract(ndvi,125:127,"200901/") # extract the time series values at the specified cell
# numbers for all times before 2009-01

n3

plot(n3) # plot the time-series values for the first series in n3 (i.e cell: 125)

plot(n3,y=1:3) # plot for the 3 series in n3 (i.e cells of 125:127)

plot(n3,y=1:3,col=1)

plot(n3,y=1:3,col=c(1,4,5))

plot(n3,y='all')

## End(Not run)

</code></pre>

<hr>
<h2 id='RasterStackBrickTS-class'> rts classes</h2><span id='topic+RasterStackTS-class'></span><span id='topic+RasterBrickTS-class'></span><span id='topic+RasterStackBrickTS-class'></span><span id='topic+SpatRasterTS-class'></span><span id='topic+rts-class'></span><span id='topic+xts-class'></span><span id='topic+show+2CRasterStackTS-method'></span><span id='topic+show+2CRasterBrickTS-method'></span><span id='topic+show+2CSpatRaster-method'></span>

<h3>Description</h3>

<p>A raster time series contains a collection of <code>RasterLayer</code> objects, each corresponds to a time/date.
</p>
<p><code>RasterStackTS</code> and <code>RasterBrickTS</code> classes are created by putting together a <code>RasterStack</code> or <code>RasterBrick</code> object, from the <span class="pkg">raster</span> package, and an <code>xts</code> object, from the <span class="pkg">xts</span> package. A <code>RasterStack</code> and <code>RasterBrick</code> represents a collection of <code>RasterLayer</code> objects with the same extent and resolution. An <code>xts</code> object extends the S3 class <code>zoo</code> from the package of the same name. This object provides the index values that is unique and ordered, and also is a time-based class. Currently acceptable classes include: 'Date', 'POSIXct', 'timeDate', as well as 'yearmon' and 'yearqtr' where the index values remain unique.
</p>
<p><code>rts</code> is a subclass of <code>xts</code> class.
</p>


<h3>Slots</h3>

<p>Slots for Raster*TS object:
</p>

<dl>
<dt><code>raster</code>:</dt><dd><p>object of class <code>RasterStack</code> or <code>RasterBrick</code></p>
</dd> 
<dt><code>rime</code>:</dt><dd><p>object of class <code>xts</code></p>
</dd>
</dl>
<p>See also <code><a href="raster.html#topic+Raster-class">Raster-class</a></code> for slots in <code>raster</code>.

</p>


<h3>Author(s)</h3>

<p>Babak Naimi 
</p>
<p><a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("RasterStackTS")
</code></pre>

<hr>
<h2 id='read.rts'>Read raster time Series data from a file</h2><span id='topic+read.rts'></span><span id='topic+read.rts+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Read a raster time series object from a file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.rts(filename,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.rts_+3A_filename">filename</code></td>
<td>
<p> Filename (character)</p>
</td></tr>
<tr><td><code id="read.rts_+3A_...">...</code></td>
<td>
<p> see details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function reads a raster time series object which has been writen by <code><a href="#topic+write.rts">write.rts</a></code>. Instead of <code>read.rts</code>, the <code>rts</code> function can be used (usage: <code>rts(filename)</code>).
</p>
<p>By default, the Raster Time Series is read as the class of <code>SpatRasterTS</code>, but the user can provide <code>cls</code> argument to specify a different rts class (e.g., <code>cls='RasterBrickTS'</code>)
</p>


<h3>Value</h3>

<p><code>RasterBrickTS</code>
</p>


<h3>Author(s)</h3>

<p>Babak Naimi
</p>
<p><a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+write.rts">write.rts</a>, <a href="#topic+rts">rts</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/ndvi", package="rts")

rt &lt;- read.rts(file)

rt

# or alternatively:
rt &lt;- rts(file)

## End(Not run)

</code></pre>

<hr>
<h2 id='rts'>Create a Raster Time Series object</h2><span id='topic+rts'></span><span id='topic+rts+2CRasterStack+2CANY-method'></span><span id='topic+rts+2CRasterBrick+2CANY-method'></span><span id='topic+rts+2CSpatRaster+2CANY-method'></span><span id='topic+rts+2Ccharacter+2CANY-method'></span><span id='topic+rts+2Cxts+2CANY-method'></span><span id='topic+rts+2Ccharacter+2Cmissing-method'></span>

<h3>Description</h3>

<p>Constructor function to create a raster time series (<code>Raster*TS</code>) object. rts object can be created from a vector of image files names,  a RasterStack or a RasterBrick object (defined in <span class="pkg">raster</span>) together with a vector of time/dates-must be of known time-based class. This function can also be used to read a raster time series file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rts(x, time,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rts_+3A_x">x</code></td>
<td>
<p>A character vector including names of image/raster files, or <code>RasterStack</code> or <code>RasterBrick</code> object, or the name (character) of a raster time series file</p>
</td></tr>
<tr><td><code id="rts_+3A_time">time</code></td>
<td>
<p>a vector holding date/time data with the same length as rasters in <code>Raster*</code> object or name of files in character vector</p>
</td></tr>
<tr><td><code id="rts_+3A_...">...</code></td>
<td>
<p>see details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A raster time series object is created by combining a <code>RasterStack</code> or <code>RasterBrick</code> objct, defined in <span class="pkg">raster</span> and a <code><a href="xts.html#topic+xts">xts</a></code> object in <code><a href="xts.html#topic+xts-package">xts-package</a></code>.
<code>RasterStack</code> or <code>RasterBrick</code> can be created by using <code><a href="raster.html#topic+stack">stack</a></code> and <code><a href="raster.html#topic+brick">brick</a></code> functions, respectively in <code>raster-package</code>. If a character vector including the name of raster files is used for <code>x</code>, <code>stack</code> function is internally called by <code>rts</code>. <code>time</code> information is handled by <code>xts</code> object. The date/time values in the vector of <code>time</code> should be correspond to the raster files (i.e. first date/time for first raster, ...) and have the same length as the number of rasters in <code>x</code>. 
</p>
<p>If a name of a raster time series file is provided for the <code>x</code> argument, it acts the same as code<a href="#topic+read.rts">read.rts</a>.
</p>
<p>If <code>x</code> is the name of Raster Time Series file (a character), it calls <code><a href="#topic+read.rts">read.rts</a></code> to read the file. By default, the Raster Time Series is read as the class of <code>SpatRasterTS</code>, but the user can provide <code>cls</code> argument to specify a different rts class (e.g., <code>cls='RasterBrickTS'</code>)
</p>


<h3>Value</h3>

<p>RasterStackTS or RasterBrickTS
</p>


<h3>Author(s)</h3>

<p>Babak Naimi
</p>
<p><a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>


<h3>See Also</h3>

 <p><code><a href="raster.html#topic+stack">stack</a>, <a href="raster.html#topic+brick">brick</a>, <a href="xts.html#topic+xts">xts</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
path &lt;- system.file("external", package="rts") # location of files

lst &lt;- list.files(path=path,pattern='.asc$',full.names=TRUE)
lst # list of raster files


r &lt;- rast(lst) # creating a RasterStack object

r

d &lt;- c("2000-02-01","2000-03-01","2000-04-01","2000-05-01") # corresponding dates to 4 rasters
d &lt;- as.Date(d) # or d &lt;- as.POSIXct(d) 

rt &lt;- rts(r,d) # creating a RasterStackTS object

rt

plot(rt)

## End(Not run)



</code></pre>

<hr>
<h2 id='subset'>Subset layers in a raster time series object</h2><span id='topic+subset'></span><span id='topic+subset+2CRasterStackBrickTS-method'></span><span id='topic+subset+2CSpatRasterTS-method'></span>

<h3>Description</h3>

<p>Extract layers from a <code>Raster*TS</code> object.   
</p>


<h3>Details</h3>

<p>This function can be used to extract a raster layer or a set of raster lasyers based on the time-index using date-like string. The format must left-specied with respect to the standard ISO:8601 time format &quot;CCYY-MM-DD HH:MM:SS&quot;. It is also possible to specify a range of times via the index-based subsetting, using ISO-recommended &quot;/&quot; as the range operator. The basic form is <em>&quot;from/to&quot;</em>, where both are optional. If either side is missing, it is interpretted as a request to retrieve raster layers from the beginning, or through the end of the raster time series object. Both <code>subset</code> function and <code>'[['</code> operator do the same thing.</p>


<h3>Value</h3>

<p><code>RasterStackTS</code> or <code>RasterBrickTS</code>.
</p>


<h3>Methods</h3>


<p><code>subset(x, subset, ...)</code>
</p>
<p>Arguments
</p>
<p><code>x</code> is a raster time series (<code>Raster*TS</code>) object created by <code><a href="#topic+rts">rts</a></code>
</p>
<p><code>subset</code> is indicates the layers (represented as a vector of numeric or character string relevant to time index, or by a time-based object).
</p>
<p><code>...</code>  - same as <code>...</code> in <code><a href="raster.html#topic+subset">subset</a></code> function in package <span class="pkg">raster</span>
</p>


<h3>Author(s)</h3>

<p>Babak Naimi
</p>
<p><a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>


<h3>See Also</h3>

 <p><code><a href="raster.html#topic+subset">subset</a></code> and <code><a href="xts.html#topic++5B.xts">[.xts</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/ndvi", package="rts")

ndvi &lt;- rts(file) # read the ndvi time series from the specified file

s1 &lt;- subset(ndvi,1:5) # subset the first 5 raster layers into a new raster time series object

s1

plot(s1)

s2 &lt;- subset(ndvi,"/2000") # subset all layers till end of year 2000

s2

plot(s2)

s3 &lt;- subset(ndvi,"2000-01-01/2000-05-31")

s3

plot(s3)


## End(Not run)

</code></pre>

<hr>
<h2 id='subset+20by+20index'>Subset layers in a raster time series object by index</h2><span id='topic++5B+5B+2CRasterStackBrickTS+2CANY+2CANY-method'></span><span id='topic++5B+5B+2CSpatRasterTS+2CANY+2CANY-method'></span>

<h3>Description</h3>

<p>Extract layers from a <code>Raster*TS</code> object by index (i.e. double bracket, <code>[[</code>).   
</p>


<h3>Details</h3>

<p>This function can be used to extract a raster layer or a set of raster lasyers based on the time-index using date-like string. The format must left-specied with respect to the standard ISO:8601 time format &quot;CCYY-MM-DD HH:MM:SS&quot;. It is also possible to specify a range of times via the index-based subsetting, using ISO-recommended &quot;/&quot; as the range operator. The basic form is <em>&quot;from/to&quot;</em>, where both are optional. If either side is missing, it is interpretted as a request to retrieve raster layers from the beginning, or through the end of the raster time series object. Both <code>subset</code> function and <code>'[['</code> operator do the same thing.</p>


<h3>Value</h3>

<p><code>RasterStackTS</code> or <code>RasterBrickTS</code>.
</p>


<h3>Methods</h3>


<p><code>x[[i, ...]]</code>
</p>
<p>Arguments
</p>
<p><code>i</code>  - indicates the layers (represented as a vector of numeric or character string relevant to time index, or by a time-based object).
</p>
<p><code>...</code>  - same as <code>...</code> in <code><a href="raster.html#topic+subset">subset</a></code> function in package <span class="pkg">raster</span>
</p>


<h3>Author(s)</h3>

<p>Babak Naimi
</p>
<p><a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+subset">subset</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/ndvi", package="rts")

ndvi &lt;- rts(file) # read the ndvi time series from the specified file

s1 &lt;- ndvi[["2000-01-01/2000-05-31"]]

s1

plot(s1)


## End(Not run)

</code></pre>

<hr>
<h2 id='VHPdownload'>Download AVHRR-based Vegetation and Drought satellite image products</h2><span id='topic+VHPdownload'></span><span id='topic+VHPdownload+2Ccharacter-method'></span>

<h3>Description</h3>

<p>'VHPdownload' downloads a series of AVHRR and VIIRS images in a specific date or a period of dates. The format of the files are downloaded as GeoTiff, and they can be optionally returned as a Raster Time Series Object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VHPdownload(x,dates,rts,ncore,...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VHPdownload_+3A_x">x</code></td>
<td>
<p> product name; it can be either of <code> c('VHI','VCI','SMN','SMT','TCI')</code></p>
</td></tr>
<tr><td><code id="VHPdownload_+3A_dates">dates</code></td>
<td>
<p> a vector, character or Date, with one or two items, specifiying an individual date or a range of dates as the form of <code>c(from, to)</code></p>
</td></tr>
<tr><td><code id="VHPdownload_+3A_rts">rts</code></td>
<td>
<p>logical; specifies whether the downloaded files should be returned as a Raster Time Series object</p>
</td></tr>
<tr><td><code id="VHPdownload_+3A_ncore">ncore</code></td>
<td>
<p>numeric; specifies the number of cores to use for parallel downloading of the files</p>
</td></tr>
<tr><td><code id="VHPdownload_+3A_...">...</code></td>
<td>
<p> additional arguments (Not implemented yet.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function assists to download Blended Vegetation Health Indices Product (blended VIIRS (2013-present) and AVHRR (1981-2012), below, referred as Blended-VHP or VHP). These images for are available with a weekly temporal resolution and a spatial resolution of 4 KM.
Five products are available that are specified with the following abbreviations:
</p>
<p>- <code>'SMT'</code>: Smoothed Brightness Temperature
- <code>'SMN'</code>: Smoothed NDVI
- <code>'TCI'</code>: Temperature Condition Index
- <code>'VHI'</code>: Vegetation Health Index
- <code>'VCI'</code>: Vegetation Condition Index
</p>
<p>Data arrays are in geographic projection (grid with equal latitude and longitude interval). 
</p>


<h3>Author(s)</h3>

<p>Babak Naimi
</p>
<p><a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(raster)

library(RCurl)


# download Vegetation Health Index for two months
vhi &lt;- VHPdownload(x='VHI',dates=c('2015.01.01','2015.02.28'),rts=TRUE) # output is as rts object

vhi

plot(vhi[[1]])

plot(vhi[2120000]) # plot time series at the specified cell number


# to make sure the dates are appropriately specified, use a Date object:

dates &lt;- as.Date(c('2015.01.01','2016.12.31'),format="

dates

class(dates)

dates &lt;- as.Date(c('2012-01-01','2012-12-31'),format="

dates
 
# If your machine has multiple cores, you can use parallel downloading to speed up the downloads
# Vegetation Condition Index for two years
vci &lt;- VHPdownload(x='VCI',dates=dates,rts=TRUE,ncore=4)

vci

plot(vci[[1:2]])




## End(Not run)

</code></pre>

<hr>
<h2 id='write.rts'>Write raster time Series data to a file</h2><span id='topic+write.rts'></span><span id='topic+write.rts+2CRasterStackBrickTS+2Ccharacter-method'></span><span id='topic+write.rts+2CSpatRasterTS+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Write an entire (<code>Raster*TS</code>) object to a file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.rts(x, filename, overwrite=FALSE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write.rts_+3A_x">x</code></td>
<td>
<p>a raster time series (<code>Raster*TS</code>) object created by <code><a href="#topic+rts">rts</a></code> </p>
</td></tr>
<tr><td><code id="write.rts_+3A_filename">filename</code></td>
<td>
<p>Output filename</p>
</td></tr>
<tr><td><code id="write.rts_+3A_overwrite">overwrite</code></td>
<td>
<p>Logical. If <code>TRUE</code>, &quot;filename&quot; will be overwritten if it exists </p>
</td></tr>
<tr><td><code id="write.rts_+3A_...">...</code></td>
<td>
<p>Additional arguments as for <code><a href="raster.html#topic+writeRaster">writeRaster</a></code>:
</p>
<p><code>datatype </code> Character. utput data type (e.g. 'INT2S' or 'FLT4S'). See <code><a href="raster.html#topic+dataType">dataType</a></code>. If no datatype is specified, 'FLT4S' is used.
</p>
<p><code>bandorder</code>: Character. 'BIL', 'BIP', or 'BSQ'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function writes a raster time series object into a directory which named as is specified in the <code>filename</code> argument. To write the raster data, <code><a href="raster.html#topic+writeRaster">writeRaster</a></code> in the package <span class="pkg">raster</span> is used. The function writes the time information into a separate ascii file.
</p>


<h3>Value</h3>

<p>This function is used for writing values to a series of files.
</p>


<h3>Author(s)</h3>

<p>Babak Naimi
</p>
<p><a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+read.rts">read.rts</a></code>, <code><a href="raster.html#topic+writeRaster">writeRaster</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
path &lt;- system.file("external", package="rts") # location of files

lst &lt;- list.files(path=path,pattern='.asc$',full.names=TRUE)
lst # list of raster files


r &lt;- stack(lst) # creating a RasterStack object

d &lt;- c("2000-02-01","2000-03-01","2000-04-01","2000-05-01") # corresponding dates to 4 rasters
d &lt;- as.Date(d) # or d &lt;- as.POSIXct(d) 

n &lt;- rts(r,as.Date(d)) # creating a RasterStackTS object

write.rts(n,"nf") # writing n into the working directory

rt &lt;- read.rts("nf") # reading nf from the working directory

rt


## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
