<!DOCTYPE html><html><head><title>Help for package SWIM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SWIM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cdf'><p>Distribution Function of a Stressed Model</p></a></li>
<li><a href='#cdf_stressed'><p>Empirical Distribution Function of a Stressed Model</p></a></li>
<li><a href='#convert_SWIMw_to_SWIM'><p>Convert SWIMw to SWIM</p></a></li>
<li><a href='#cor_stressed'><p>Correlation of a Stressed Model</p></a></li>
<li><a href='#credit_data'><p>Credit data set</p></a></li>
<li><a href='#ES_stressed'><p>Value-at-Risk and Expected Shortfall of a Stressed Model</p></a></li>
<li><a href='#get_data'><p>Extracting from a Stressed Model</p></a></li>
<li><a href='#importance_rank'><p>Importance Ranking for a Stressed Model</p></a></li>
<li><a href='#mean_stressed'><p>Mean of a Stressed Model</p></a></li>
<li><a href='#merge.SWIM'><p>Merging Two Stressed Models</p></a></li>
<li><a href='#merge.SWIMw'><p>Merging Two Stressed Models</p></a></li>
<li><a href='#plot_cdf'><p>Plotting the Distribution Functions of a Stressed Model</p></a></li>
<li><a href='#plot_hist'><p>Plotting Histograms of a Stressed Model</p></a></li>
<li><a href='#plot_quantile'><p>Plotting Quantile Functions of a Stressed Model</p></a></li>
<li><a href='#plot_sensitivity'><p>Plotting Sensitivities of a Stressed Model</p></a></li>
<li><a href='#plot_weights'><p>Plotting the scenario weights of a Stressed Model</p></a></li>
<li><a href='#quantile_stressed'><p>Sample Quantiles of a Stressed Model</p></a></li>
<li><a href='#rename'><p>Rename Stressed Models</p></a></li>
<li><a href='#sd_stressed'><p>Standard Deviation and Variance of a Stressed Model</p></a></li>
<li><a href='#sensitivity'><p>Sensitivities of a Stressed Model</p></a></li>
<li><a href='#stress'><p>Stressing Random Variables</p></a></li>
<li><a href='#stress_HARA_RM_w'><p>Stressing Risk Measure and HARA Utility</p></a></li>
<li><a href='#stress_mean'><p>Stressing Means</p></a></li>
<li><a href='#stress_mean_sd'><p>Stressing Mean and Standard Deviation</p></a></li>
<li><a href='#stress_mean_sd_w'><p>Stressing Mean and Standard Deviation</p></a></li>
<li><a href='#stress_mean_w'><p>Stressing Mean</p></a></li>
<li><a href='#stress_moment'><p>Stressing Moments</p></a></li>
<li><a href='#stress_prob'><p>Stressing Intervals</p></a></li>
<li><a href='#stress_RM_mean_sd_w'><p>Stressing Risk Measure, Mean and Standard Deviation</p></a></li>
<li><a href='#stress_RM_w'><p>Stressing Risk Measure</p></a></li>
<li><a href='#stress_user'><p>User Defined Stress</p></a></li>
<li><a href='#stress_VaR'><p>Stressing Value-at-Risk</p></a></li>
<li><a href='#stress_VaR_ES'><p>Stressing Value-at-Risk and Expected Shortfall</p></a></li>
<li><a href='#stress_wass'><p>Stressing Random Variables Using Wasserstein Distance</p></a></li>
<li><a href='#summary.SWIM'><p>Summarising Stressed Models</p></a></li>
<li><a href='#SWIM'><p>SWIM: A Package for Sensitivity Analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Scenario Weights for Importance Measurement</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Silvana M. Pesenti &lt;swimpackage@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>An efficient sensitivity analysis for stochastic models based on 
    Monte Carlo samples. Provides weights on simulated scenarios from a 
    stochastic model, such that stressed random variables fulfil given 
    probabilistic constraints (e.g. specified values for risk measures), 
    under the new scenario weights. Scenario weights are selected by 
    constrained minimisation of the relative entropy to the baseline model. 
    The 'SWIM' package is based on Pesenti S.M., Millossovich P., Tsanakas A. (2019)
    "Reverse Sensitivity Testing: What does it take to break the model" 
    &lt;openaccess.city.ac.uk/id/eprint/18896/&gt; and Pesenti S.M. (2021) 
    "Reverse Sensitivity Analysis for Risk Modelling" <a href="https://www.ssrn.com/abstract=3878879">https://www.ssrn.com/abstract=3878879</a>.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rdpack (&ge; 0.7), Hmisc, nleqslv, reshape2, plyr, ggplot2,
stats</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/spesenti/SWIM">https://github.com/spesenti/SWIM</a>,
<a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3515274">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3515274</a>,
<a href="https://utstat.toronto.edu/pesenti/?page_id=138">https://utstat.toronto.edu/pesenti/?page_id=138</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/spesenti/SWIM/issues">https://github.com/spesenti/SWIM/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>true</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, mvtnorm, spelling, Weighted.Desc.Stat, knitr,
rmarkdown, bookdown, ggpubr</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-01-09 14:39:55 UTC; silva</td>
</tr>
<tr>
<td>Author:</td>
<td>Silvana M. Pesenti
    <a href="https://orcid.org/0000-0002-6661-6970"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Alberto Bettini [aut],
  Pietro Millossovich
    <a href="https://orcid.org/0000-0001-8269-7507"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Andreas Tsanakas <a href="https://orcid.org/0000-0003-4552-5532"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Zhuomin Mao [ctb],
  Kent Wu [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-01-09 15:02:42 UTC</td>
</tr>
</table>
<hr>
<h2 id='cdf'>Distribution Function of a Stressed Model</h2><span id='topic+cdf'></span>

<h3>Description</h3>

<p>Provides the empirical distribution function of a stressed SWIM
model component (random variable) or KDE distribution of a stressed
SWIMw model component under the scenario weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdf(object, xCol = 1, wCol = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdf_+3A_object">object</code></td>
<td>
<p>A <code>SWIM</code> or <code>SWIMw</code> object.</p>
</td></tr>
<tr><td><code id="cdf_+3A_xcol">xCol</code></td>
<td>
<p>Numeric or character, (name of) the columns of the underlying data 
of the <code>object</code> (<code>default = 1</code>).</p>
</td></tr>
<tr><td><code id="cdf_+3A_wcol">wCol</code></td>
<td>
<p>Numeric, the columns of the scenario weights 
of the <code>object</code> (<code>default = 1</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The empirical or KDE distribution function (a function) of 
the <code>xCol</code> component of the stressed model with weights 
<code>wCol</code>. The empirical distribution function can be 
evaluated at a vector.
</p>


<h3>Author(s)</h3>

<p>Silvana M. Pesenti, Zhuomin Mao
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+plot_cdf">plot_cdf</a></code> for plotting the empirical or KDE 
distribution function of the stressed model and 
<code><a href="#topic+quantile_stressed">quantile_stressed</a></code> for sample quantiles of 
a stressed model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>     
## example with a stress on VaR
set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000), 
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress(type = "VaR", x = x, 
  alpha = c(0.9, 0.95), q_ratio = 1.05)
grid &lt;- seq(min(x$normal), max(x$normal), length.out = 5)
## stressed empirical distribution function
cdf(res1, xCol = 1, wCol = 1)(grid)
## baseline empirical distribution function
ecdf(x$normal)(grid)

</code></pre>

<hr>
<h2 id='cdf_stressed'>Empirical Distribution Function of a Stressed Model</h2><span id='topic+cdf_stressed'></span>

<h3>Description</h3>

<p>Provides the empirical distribution of a stressed model component (random variable) under the scenario weights
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdf_stressed(object, xCol = 1, wCol = "all", grid, base = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdf_stressed_+3A_object">object</code></td>
<td>
<p>A <code>SWIM</code> or <code>SWIMw</code> object.</p>
</td></tr>
<tr><td><code id="cdf_stressed_+3A_xcol">xCol</code></td>
<td>
<p>Numeric, (name of) the column of the underlying data 
of the <code>object</code> (<code>default = 1</code>).</p>
</td></tr>
<tr><td><code id="cdf_stressed_+3A_wcol">wCol</code></td>
<td>
<p>Vector or characters, the columns of the scenario weights 
of the <code>object</code> (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="cdf_stressed_+3A_grid">grid</code></td>
<td>
<p>Vector, the empirical distribution of the <code>xCol</code> component
of the stressed model with weights <code>wCol</code>.</p>
</td></tr>
<tr><td><code id="cdf_stressed_+3A_base">base</code></td>
<td>
<p>Logical, if TRUE, statistics under the baseline are also returned (default = &quot;FALSE&quot;).]</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>cdf_stressed</code> returns the values of the empirical distribution function 
of the <code>xCol</code> model components for weights <code>wCol</code>. In contrast, the <code>cdf</code> function 
returns a function, analogous to the <code>ecdf</code> from the base package. The 
function <code>cdf_stressed</code> is the <code>cdf</code> function applied to grid.
</p>


<h3>Value</h3>

<p>A matrix containing the empirical distribution function 
applied to <code>grid</code> of the <code>xCol</code> components of the 
stressed model with weights <code>wCol</code>.
</p>


<h3>Author(s)</h3>

<p>Kent Wu
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+cdf">cdf</a></code> for the empirical distribution function of a stressed 
model component and <code><a href="#topic+quantile_stressed">quantile_stressed</a></code> for sample quantiles of 
a stressed model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>     
## example with a stress on VaR
set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000), 
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress(type = "VaR", x = x, 
  alpha = c(0.9, 0.95), q_ratio = 1.05)
grid &lt;- seq(min(x$normal), max(x$normal), length.out = 5)
## stressed empirical distribution function
cdf_stressed(res1, xCol = 1, wCol = "all", grid = grid)

</code></pre>

<hr>
<h2 id='convert_SWIMw_to_SWIM'>Convert SWIMw to SWIM</h2><span id='topic+convert_SWIMw_to_SWIM'></span>

<h3>Description</h3>

<p>Convert SWIMw to SWIM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_SWIMw_to_SWIM(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_SWIMw_to_SWIM_+3A_object">object</code></td>
<td>
<p>A <code>SWIMw</code> object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Convert a SWIMw object into a SWIM object
</p>


<h3>Value</h3>

<p>A <code>SWIM</code> object containing:
</p>

<ul>
<li> <p><code>x</code>, a data.frame containing the data;
</p>
</li>
<li> <p><code>new_weights</code>, a list of functions, that applied to
the <code>k</code>th column of <code>x</code>, generates the vectors of scenario
weights. Each component corresponds to a different stress;
</p>
</li>
<li> <p><code>type = "VaR"</code>;
</p>
</li>
<li> <p><code>specs</code>, a list, each component corresponds to
a different stress and contains <code>k</code>,
<code>alpha</code> and <code>q</code>.
</p>
</li></ul>

<p>See <code><a href="#topic+SWIM">SWIM</a></code> for details.
</p>


<h3>Author(s)</h3>

<p>Kent Wu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000),
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress_wass(type = "RM", x = x,
  alpha = 0.9, q_ratio = 1.05)
convert_SWIMw_to_SWIM(res1)

## End(Not run)

</code></pre>

<hr>
<h2 id='cor_stressed'>Correlation of a Stressed Model</h2><span id='topic+cor_stressed'></span>

<h3>Description</h3>

<p>Provides the correlation of stressed model components
(random variable) under the scenario weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor_stressed(
  object,
  xCol = c(1, 2),
  wCol = "all",
  method = "Pearson",
  base = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cor_stressed_+3A_object">object</code></td>
<td>
<p>A <code>SWIM</code> or <code>SWIMw</code> object.</p>
</td></tr>
<tr><td><code id="cor_stressed_+3A_xcol">xCol</code></td>
<td>
<p>Numeric or character vector, (names of) the columns of 
the underlying data 
of the <code>object</code> (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="cor_stressed_+3A_wcol">wCol</code></td>
<td>
<p>Vector, the columns of the scenario weights 
of the <code>object</code> corresponding to different 
stresses (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="cor_stressed_+3A_method">method</code></td>
<td>
<p>Character, one of <code>"Pearson", "Spearman", "Kendall"</code>. (<code>default = "Pearson"</code>).</p>
</td></tr>
<tr><td><code id="cor_stressed_+3A_base">base</code></td>
<td>
<p>Logical, if <code>TRUE</code>, statistics under the baseline 
are also returned (<code>default = "FALSE"</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>cor_stressed</code>: The correlation coefficient of  
stressed model components, subject to the calculated scenario weights.
</p>


<h3>Value</h3>

<p><code>cor_stressed</code> returns a list of correlation matrices
corresponding to different stresses. Entries of the matrices denote 
correlation coefficients between stressed model components specified by <code>xCol</code>.
</p>


<h3>Author(s)</h3>

<p>Kent Wu
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+var_stressed">var_stressed</a></code> and <code><a href="#topic+sd_stressed">sd_stressed</a></code> compute
stressed variance and standard deviations under the scenario weights, respectively.
</p>
<p>See <code><a href="stats.html#topic+cor">cor</a></code> for unweighted correlations between model components, while 
<code>cor_stressed</code> return correlations between stressed model components
</p>


<h3>Examples</h3>

<pre><code class='language-R'>     
## example with a stress on VaR
set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000), 
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress(type = "VaR", x = x, 
  alpha = c(0.9, 0.95), q_ratio = 1.05)
## stressed correlation
cor_stressed(res1, xCol = c(1, 2), wCol = 1, base=TRUE)

</code></pre>

<hr>
<h2 id='credit_data'>Credit data set</h2><span id='topic+credit_data'></span>

<h3>Description</h3>

<p>A dataset containing total aggregate losses from three sub-portfolios, generated through a binomial credit model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>credit_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 100,000 rows and 7 variables:
</p>

<dl>
<dt>L</dt><dd><p>total aggregate loss of a portfolio consisting
of three homogeneous sub-portfolios L1, L2 and L3</p>
</dd>
<dt>L1</dt><dd><p>aggregate loss of sub-portfolio 1</p>
</dd>
<dt>L2</dt><dd><p>aggregate loss of sub-portfolio 2</p>
</dd>
<dt>L3</dt><dd><p>aggregate loss of sub-portfolio 3</p>
</dd>
<dt>H1</dt><dd><p>(conditional) default probability of sub-portfolio 1</p>
</dd>
<dt>H2</dt><dd><p>(conditional) default probability of sub-portfolio 2</p>
</dd>
<dt>H3</dt><dd><p>(conditional) default probability of sub-portfolio 3</p>
</dd>
</dl>



<h3>Source</h3>

<p>For a detailed case study of the credit data set using <code>SWIM</code> see <br />
Pesenti S BAMPTA (2020).
&ldquo;Scenario Weights for Importance Measurement (SWIM) - An R package for sensitivity analysis.&rdquo;
<em>Annals of Actuarial Science 15.2 (2021): 458-483. Available at SSRN: <a href="https://www.ssrn.com/abstract=3515274">https://www.ssrn.com/abstract=3515274</a></em>.
</p>

<hr>
<h2 id='ES_stressed'>Value-at-Risk and Expected Shortfall of a Stressed Model</h2><span id='topic+ES_stressed'></span><span id='topic+VaR_stressed'></span>

<h3>Description</h3>

<p>Provides the Value-at-Risk (VaR) and the Expected Shortfall (ES)
for components (random variables) of a stochastic model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ES_stressed(
  object,
  alpha = 0.95,
  xCol = "all",
  wCol = 1,
  base = FALSE,
  gamma = NULL
)

VaR_stressed(object, alpha = 0.95, xCol = "all", wCol = 1, base = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ES_stressed_+3A_object">object</code></td>
<td>
<p>A <code>SWIM</code> or <code>SWIMw</code> object.</p>
</td></tr>
<tr><td><code id="ES_stressed_+3A_alpha">alpha</code></td>
<td>
<p>Numeric vector, the levels of the stressed VaR and ES
(<code>default = 0.95</code>).</p>
</td></tr>
<tr><td><code id="ES_stressed_+3A_xcol">xCol</code></td>
<td>
<p>Numeric or character vector, (names of) the columns of 
the underlying data 
of the <code>object</code> (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="ES_stressed_+3A_wcol">wCol</code></td>
<td>
<p>Numeric, the column of the scenario weights
of the <code>object</code> (<code>default = 1</code>).</p>
</td></tr>
<tr><td><code id="ES_stressed_+3A_base">base</code></td>
<td>
<p>Logical, if <code>TRUE</code>, statistics under the baseline 
are also returned (<code>default = "FALSE"</code>).</p>
</td></tr>
<tr><td><code id="ES_stressed_+3A_gamma">gamma</code></td>
<td>
<p>Function that defines the gamma of the risk measure. If null,
the Expected Shortfall (ES) will be used.<br /></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ES_stressed</code>: The ES of a stressed model is the
ES of a chosen stressed model component, subject to the calculated scenario
weights. The ES at level <code>alpha</code> of a stressed model
component is given by:
</p>
<p style="text-align: center;"><code class="reqn">ES_{alpha} = 1 / (1 - alpha) * \int_{alpha}^1 VaR_u^W d u,</code>
</p>

<p>where <code>VaR_u^W</code> is the VaR of the stressed model component, defined below.
</p>
<p><code>VaR_stressed</code>: The VaR of a model is the VaR (quantile) of
a chosen stressed model component, subject to the calculated scenario weights.
The VaR at level <code>alpha</code> of a stressed model component with
stressed distribution function F^W is defined as its
left-quantile at alpha:
</p>
<p style="text-align: center;"><code class="reqn">VaR_{alpha}^W = F^{W,-1}(alpha).</code>
</p>

<p>The function <code>VaR_stressed</code> provides the empirical quantile, whereas
the function <code>quantile_stressed</code> calculates quantiles of model
components with different interpolations.
</p>


<h3>Value</h3>

<p><code>ES_stressed</code>: Returns a matrix with the empirical or KDE 
ES's at level <code>alpha</code> of
model components specified in <code>xCol</code>, under the scenario weights
<code>wCol</code>.
</p>
<p><code>VaR_stressed</code>: Returns a matrix with the empirical or KDE VaR's
at level <code>alpha</code> of
model components specified in <code>xCol</code>, under the scenario weights
<code>wCol</code>.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>ES_stressed</code>: Expected Shortfall of a stressed model
</p>
</li>
<li> <p><code>VaR_stressed</code>: Value-at-Risk of a stressed model.
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Silvana M. Pesenti, Zhuomin Mao
</p>


<h3>See Also</h3>

<p>See <code>quantile_stressed</code> for quantiles other than the
empirical quantiles and <code>cdf</code> for the empirical or KDE distribution
function of a stressed model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example with a stress on VaR
set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000),
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress(type = "VaR", x = x,
  alpha = c(0.9, 0.95), q_ratio = 1.05)
## stressed ES
quantile_stressed(res1, probs = seq(0.9, 0.99, 0.01),
                    xCol = 1, wCol = 2, type = "i/n")
quantile(x[, 1],  probs = seq(0.9, 0.99, 0.01), type = 1)
VaR_stressed(res1, alpha = seq(0.9, 0.99, 0.01), xCol = 1,
                    wCol = 2, base = TRUE)

## the ES of both model components under stress one
ES_stressed(res1, alpha = seq(0.9, 0.99, 0.01), xCol = "all",
                    wCol = 1)
## the ES of both model components under stress two
ES_stressed(res1, alpha = seq(0.9, 0.99, 0.01), xCol = "all",
                    wCol = 2)

</code></pre>

<hr>
<h2 id='get_data'>Extracting from a Stressed Model</h2><span id='topic+get_data'></span><span id='topic+get_weights'></span><span id='topic+get_weightsfun'></span><span id='topic+get_specs'></span><span id='topic+summary_weights'></span>

<h3>Description</h3>

<p>Extracting the data (realisations of the stochastic model), the 
scenario weights, the functions generating the scenario weights, 
or the specifications of the stress from an object of class 
<code>SWIM</code> or <code>SWIMw</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_data(object, xCol = "all")

get_weights(object, wCol = "all")

get_weightsfun(object, wCol = "all")

get_specs(object, wCol = "all")

summary_weights(object, wCol = "all")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_data_+3A_object">object</code></td>
<td>
<p>A <code>SWIM</code> or <code>SWIMw</code> object.</p>
</td></tr>
<tr><td><code id="get_data_+3A_xcol">xCol</code></td>
<td>
<p>Numeric or character vector, (names of) the columns of 
the underlying data 
of the <code>object</code> (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="get_data_+3A_wcol">wCol</code></td>
<td>
<p>Vector, the columns of the scenario weights 
of the <code>object</code> corresponding to different 
stresses (<code>default = "all"</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>get_data</code>: A data.frame containing the realisations of 
the stochastic model on which the <code>object</code> is based.
</p>
<p><code>get_weights:</code> A data.frame containing the scenario 
weights of the <code>object</code>. Columns corresponds 
to different stresses.
</p>
<p><code>get_weightsfun</code>: A list containing functions, which, 
when applied to a column of the data, generate the 
scenario weights of the <code>object</code>. The corresponding stressed 
columns can be obtained via <code>get_specs</code>.<br />
</p>
<p>Use <code><a href="#topic+get_weights">get_weights</a></code> if the <code>SWIM</code> object only contains 
scenario weights and not a list of functions.
</p>
<p><code>get_specs</code>: A data.frame containing specifications 
of the stresses with each row corresponding to a different 
stress. Only a selection of the specifications is returned; 
however, all input variables are stored in the <code>object</code>.
See also <code><a href="#topic+SWIM">SWIM</a></code>.
</p>
<p><code>summary_weights</code>: print a list containing summary statistics 
of the stresses with each element being a table for a different stress. 
The summary statistics include minimum, maximum, standard deviation, 
Gini coefficient, entropy and effective sample size. 
</p>
<p>Gini coefficient uses the formula <code class="reqn">\frac{\sum_{i=1}^{n} \sum_{j=1}^{n}\left|x_{i}-x_{j}\right|}{2 n^{2} \bar{x}}</code>.
</p>
<p>Effective Sample Size is equal to n / (1+Var(W)), see 
Equation (9.13) in Owen, Art B. &quot;Monte Carlo theory, methods and examples.&quot; (2013).
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>get_data</code>: extracting data.
</p>
</li>
<li> <p><code>get_weights</code>: extracting scenario weights.
</p>
</li>
<li> <p><code>get_weightsfun</code>: extracting weight functions.
</p>
</li>
<li> <p><code>get_specs</code>: extracting information of the stress.
</p>
</li>
<li> <p><code>summary_weights</code>: extracting summary statistics of scenario weights.
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Silvana M. Pesenti
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SWIM">SWIM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## continuing example in stress_VaR
set.seed(0)
x &lt;- as.data.frame(cbind(
     "normal" = rnorm(1000), 
     "gamma" = rgamma(1000, shape = 2)))
  res1 &lt;- stress(type = "VaR", x = x, 
                 alpha = 0.9, q_ratio = 1.05, k = 1)

## returning the underlying data
all(get_data(res1) == x)
 ## the scenario weights
w &lt;- get_weights(res1) 
get_weightsfun(res1)
get_specs(res1)
  
## now add a stress on the means of both variables
res1 &lt;- stress(type = "mean", x = res1, k = 1:2, new_means = c(0.5,1.5))
get_specs(res1)
## the required moments for a stress of type "mean" are not displayed 
## the type of stress and the specs for the second stress can be 
## extracted directly from the SWIM object.
res1$type[[2]]
res1$specs[[2]]
                                             
                                                              
                                                                                                
</code></pre>

<hr>
<h2 id='importance_rank'>Importance Ranking for a Stressed Model</h2><span id='topic+importance_rank'></span>

<h3>Description</h3>

<p>Provides the importance ranks of the components (random variables)
of a stressed model for different sensitivity measures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importance_rank(
  object,
  xCol = "all",
  wCol = "all",
  type = c("Gamma", "Wasserstein", "reverse", "all"),
  f = NULL,
  k = NULL,
  s = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="importance_rank_+3A_object">object</code></td>
<td>
<p>A <code>SWIM</code> or <code>SWIMw</code> object.</p>
</td></tr>
<tr><td><code id="importance_rank_+3A_xcol">xCol</code></td>
<td>
<p>Numeric or character vector, (names of) the columns
of the underlying data of the <code>object</code>
(<code>default = "all"</code>). If <code>xCol = NULL</code>, only
the transformed data <code>f(x)</code> is considered.</p>
</td></tr>
<tr><td><code id="importance_rank_+3A_wcol">wCol</code></td>
<td>
<p>Vector, the columns of the scenario weights 
of the <code>object</code> corresponding to different 
stresses (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="importance_rank_+3A_type">type</code></td>
<td>
<p>Character, one of <code>"Gamma", "Wasserstein", "Kolmogorov",
"reverse", "all"</code>.</p>
</td></tr>
<tr><td><code id="importance_rank_+3A_f">f</code></td>
<td>
<p>A function, or list of functions, that, applied to
<code>x</code>, constitute the transformation of the data
for which the sensitivity is calculated.</p>
</td></tr>
<tr><td><code id="importance_rank_+3A_k">k</code></td>
<td>
<p>A vector or list of vectors, same length as <code>f</code>,
indicating which columns of <code>x</code> each function
in <code>f</code> operates on.<br />
When <code>f</code> is a list, <code>k[[i]]</code> corresponds
to the input variables of <code>f[[i]]</code>.</p>
</td></tr>
<tr><td><code id="importance_rank_+3A_s">s</code></td>
<td>
<p>A function that, applied to <code>x</code>, defines the reverse
sensitivity measure. If <code>type = "reverse"</code> and 
<code>s = NULL</code>, defaults to <code>type = "Gamma"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the definition of the sensitivity
measures (<code>type</code>), see <code><a href="#topic+sensitivity">sensitivity</a></code>.
</p>


<h3>Value</h3>

<p>A data.frame containing the importance ranks of the
stressed model for different sensitivity measures. Small values
correspond to large sensitivities. Different rows correspond
to different random variables. The first two rows specify the
<code>stress</code> and <code>type</code> of the sensitivity measure on
which the ranking is calculated.
</p>


<h3>Author(s)</h3>

<p>Silvana M. Pesenti
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+sensitivity">sensitivity</a></code> for the values of the
sensitivity measures, <code><a href="#topic+plot_sensitivity">plot_sensitivity</a></code> for plotting
sensitivity measures and <code><a href="base.html#topic+summary">summary</a></code> for a
summary statistic of a stressed model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example with a stress on VaR
set.seed(0)
x &lt;- as.data.frame(cbind(
  "log-normal" = rlnorm(1000),
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress(type = "VaR", x = x,
  alpha = c(0.9, 0.95), q_ratio = 1.05)

importance_rank(res1, wCol = 1:2, type = "Gamma")
## sensitivity of log-transformed data
importance_rank(res1, wCol = 1, type = "all",
  f = list(function(x)log(x), function(x)log(x)), k = list(1, 2))

</code></pre>

<hr>
<h2 id='mean_stressed'>Mean of a Stressed Model</h2><span id='topic+mean_stressed'></span>

<h3>Description</h3>

<p>Provides the mean of stressed model components (random variables) under the scenario weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mean_stressed(object, xCol = "all", wCol = "all", base = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mean_stressed_+3A_object">object</code></td>
<td>
<p>A <code>SWIM</code> or <code>SWIMw</code> object.</p>
</td></tr>
<tr><td><code id="mean_stressed_+3A_xcol">xCol</code></td>
<td>
<p>Numeric or character vector, (names of) the columns of 
the underlying data 
of the <code>object</code> (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="mean_stressed_+3A_wcol">wCol</code></td>
<td>
<p>Vector, the columns of the scenario weights 
of the <code>object</code> corresponding to different 
stresses (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="mean_stressed_+3A_base">base</code></td>
<td>
<p>Logical, if <code>TRUE</code>, statistics under the baseline 
are also returned (<code>default = "FALSE"</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>mean_stressed</code>: Sample mean of chosen stressed model components, subject to the calculated scenario weights.
</p>


<h3>Value</h3>

<p>A matrix containing the means of the <code>xCol</code>
components of the stressed model with weights <code>wCol</code>.
</p>


<h3>Author(s)</h3>

<p>Kent Wu
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+var_stressed">var_stressed</a></code> and <code><a href="#topic+sd_stressed">sd_stressed</a></code> compute
stressed variance and standard deviations under the scenario weights, respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>     
## example with a stress on VaR
set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000), 
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress(type = "VaR", x = x, 
  alpha = c(0.9, 0.95), q_ratio = 1.05)
## stressed mean
mean_stressed(res1, xCol = "all", wCol = "all", base = TRUE)

</code></pre>

<hr>
<h2 id='merge.SWIM'>Merging Two Stressed Models</h2><span id='topic+merge.SWIM'></span>

<h3>Description</h3>

<p>This function is a <code>method</code> for an object of class 
<code>SWIM</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SWIM'
merge(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merge.SWIM_+3A_x">x</code>, <code id="merge.SWIM_+3A_y">y</code></td>
<td>
<p>Objects of class <code>SWIM</code>.</p>
</td></tr>
<tr><td><code id="merge.SWIM_+3A_...">...</code></td>
<td>
<p>Additional arguments will be ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Merges two objects of class <code>SWIM</code>, that 
are based on the same data. <br />
</p>


<h3>Value</h3>

<p>An object of class <code>SWIM</code> containing:
</p>

<ul>
<li> <p><code>x</code>, a data.frame containing the data;
</p>
</li>
<li> <p><code>new_weights</code>, a list, each component corresponds to 
a different stress and is either a vector of scenario weights or a
function, that applied to a column of <code>x</code>, generates the 
vectors of scenario weights; 
</p>
</li>
<li> <p><code>type</code>, a list, each component corresponds to a 
different stress and specifies the type of the stress;
</p>
</li>
<li> <p><code>specs</code>, a list, each component corresponds to 
a different stress and contains a list with the specifications 
of what has been stressed.
</p>
</li></ul>

<p>See <code><a href="#topic+SWIM">SWIM</a></code> for details.
</p>


<h3>Author(s)</h3>

<p>Silvana M. Pesenti
</p>

<hr>
<h2 id='merge.SWIMw'>Merging Two Stressed Models</h2><span id='topic+merge.SWIMw'></span>

<h3>Description</h3>

<p>This function is a <code>method</code> for an object of class 
<code>SWIMw</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SWIMw'
merge(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merge.SWIMw_+3A_x">x</code>, <code id="merge.SWIMw_+3A_y">y</code></td>
<td>
<p>Objects of class <code>SWIMw</code>.</p>
</td></tr>
<tr><td><code id="merge.SWIMw_+3A_...">...</code></td>
<td>
<p>Additional arguments will be ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Merges two objects of class <code>SWIMw</code>, that 
are based on the same data. <br />
</p>


<h3>Value</h3>

<p>A <code>SWIMw</code> object containing:
</p>

<ul>
<li> <p><code>x</code>, a data.frame containing the data;
</p>
</li>
<li> <p><code>h</code>, bandwidths;
</p>
</li>
<li> <p><code>u</code>, vector containing the gridspace on [0, 1]
</p>
</li>
<li> <p><code>lam</code>, vector containing the lambda's of the optimized model
</p>
</li>
<li> <p><code>str_fY</code>, function defining the densities of the stressed component;
</p>
</li>
<li> <p><code>str_FY</code>, function defining the distribution of the stressed component;
</p>
</li>
<li> <p><code>str_FY_inv</code>, function defining the quantiles of the stressed component;
</p>
</li>
<li> <p><code>gamma</code>, function defining the risk measure;
</p>
</li>
<li> <p><code>new_weights</code>, a list of functions, that applied to
the <code>k</code>th column of <code>x</code>, generates the vectors of scenario
weights. Each component corresponds to a different stress;
</p>
</li>
<li> <p><code>type</code>, specifies the stress type
</p>
</li>
<li> <p><code>specs</code>, a list, each component corresponds to
a different stress and contains a list with the specifications
of what has been stressed.
</p>
</li></ul>

<p>See <code><a href="#topic+SWIM">SWIM</a></code> for details.
</p>


<h3>Author(s)</h3>

<p>Zhuomin Mao
</p>

<hr>
<h2 id='plot_cdf'>Plotting the Distribution Functions of a Stressed Model</h2><span id='topic+plot_cdf'></span>

<h3>Description</h3>

<p>Plots the empirical distribution function of a stressed SWIM model
component (random variable) or KDE distribution function of a stressed
SWIMw model component under the scenario weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_cdf(
  object,
  xCol = 1,
  wCol = "all",
  base = FALSE,
  n = 500,
  x_limits,
  y_limits,
  displ = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_cdf_+3A_object">object</code></td>
<td>
<p>A <code>SWIM</code> or <code>SWIMw</code> object.</p>
</td></tr>
<tr><td><code id="plot_cdf_+3A_xcol">xCol</code></td>
<td>
<p>Numeric or character, (name of) the column of the underlying data
of the <code>object</code> (<code>default = 1</code>).</p>
</td></tr>
<tr><td><code id="plot_cdf_+3A_wcol">wCol</code></td>
<td>
<p>Vector, the columns of the scenario weights 
of the <code>object</code> corresponding to different 
stresses (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="plot_cdf_+3A_base">base</code></td>
<td>
<p>Logical, if <code>TRUE</code>, statistics under the baseline 
are also returned (<code>default = "FALSE"</code>).</p>
</td></tr>
<tr><td><code id="plot_cdf_+3A_n">n</code></td>
<td>
<p>Integer, the number of points used to plot
<code>stat_ecdf</code> in <code>ggplot</code> (<code>default
= 500</code>).</p>
</td></tr>
<tr><td><code id="plot_cdf_+3A_x_limits">x_limits</code></td>
<td>
<p>Vector, the limits of the x-axis of the plot, the
value for <code>xlim</code> in the <code>coord_cartesian</code>
function in <code>ggplot</code>.</p>
</td></tr>
<tr><td><code id="plot_cdf_+3A_y_limits">y_limits</code></td>
<td>
<p>Vector, the limits of the y-axis of the plot, the
value for <code>ylim</code> in the <code>coord_cartesian</code>
function in <code>ggplot</code>.</p>
</td></tr>
<tr><td><code id="plot_cdf_+3A_displ">displ</code></td>
<td>
<p>Logical, if <code>TRUE</code> the plot is displayed,
otherwise the data.frame for customised plotting with
<code>ggplot</code> is returned (<code>default = TRUE</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>displ = TRUE</code>, a plot displaying the empirical or KDE
distribution function of the stochastic model under the
scenario weights.
</p>
<p>If <code>displ = FALSE</code>, a data.frame for customised plotting with
<code>ggplot</code>. The data.frame contains the columns: the column,
<code>xCol</code>, of the data of the stressed model,
<code>stress</code> (the stresses) and <code>value</code> (the values). <br />
Denote by <code>res</code> the return of the function call, then
<code>ggplot</code> can be called via:
</p>
<p style="text-align: center;"><code class="reqn">ggplot(res, aes(x = res[ ,1], w = value))</code>
</p>

<p style="text-align: center;"><code class="reqn"> + stat_{ecdf}(aes(color = factor(stress)), n = n).</code>
</p>

<p>Note that the ggplot2 default of <code>stat_ecdf</code> does not
take <code>weight</code> as an aesthetic. We use the workaround
by Nicolas Woloszko, see Note below.
</p>


<h3>Note</h3>

<p>This function is based on the ggplot <code>stat_ecdf</code>
function. However, the <code>stat_ecdf</code> does not allow for
specifying <code>weights</code>, thus the function is based on
the workaround by Nicolas Woloszko, see
<a href="https://github.com/NicolasWoloszko/stat_ecdf_weighted">https://github.com/NicolasWoloszko/stat_ecdf_weighted</a>.
</p>


<h3>Author(s)</h3>

<p>Silvana M. Pesenti, Zhuomin Mao
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+cdf">cdf</a></code> for the empirical or KDE distribution function
of a stressed model and <code><a href="#topic+quantile_stressed">quantile_stressed</a></code> for
sample quantiles of a stressed model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example with a stress on VaR
set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(10 ^ 5),
  "gamma" = rgamma(10 ^ 5, shape = 2)))
res1 &lt;- stress(type = "VaR", x = x,
  alpha = c(0.75, 0.95), q_ratio = 1.15)
plot_cdf(res1, xCol = 1, wCol = 1:2, base = TRUE)
plot_cdf(res1, xCol = 1, wCol = 1:2, base = TRUE,
  x_limits = c(0, 5), y_limits = c(0.5, 1))

</code></pre>

<hr>
<h2 id='plot_hist'>Plotting Histograms of a Stressed Model</h2><span id='topic+plot_hist'></span>

<h3>Description</h3>

<p>Plots the histogram of a stressed model component (random variable)
under the scenario weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_hist(
  object,
  xCol = 1,
  wCol = "all",
  base = FALSE,
  x_limits,
  displ = TRUE,
  binwidth,
  displLines = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_hist_+3A_object">object</code></td>
<td>
<p>A <code>SWIM</code> or <code>SWIMw</code> object.</p>
</td></tr>
<tr><td><code id="plot_hist_+3A_xcol">xCol</code></td>
<td>
<p>Numeric or character, (name of) the column of the underlying data
of the <code>object</code> (<code>default = 1</code>).</p>
</td></tr>
<tr><td><code id="plot_hist_+3A_wcol">wCol</code></td>
<td>
<p>Vector, the columns of the scenario weights 
of the <code>object</code> corresponding to different 
stresses (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="plot_hist_+3A_base">base</code></td>
<td>
<p>Logical, if <code>TRUE</code>, statistics under the baseline 
are also returned (<code>default = "FALSE"</code>).</p>
</td></tr>
<tr><td><code id="plot_hist_+3A_x_limits">x_limits</code></td>
<td>
<p>Vector, the limits of the x-axis of the plot, the
value for <code>xlim</code> in the <code>coord_cartesian</code>
function in <code>ggplot</code>.</p>
</td></tr>
<tr><td><code id="plot_hist_+3A_displ">displ</code></td>
<td>
<p>Logical, if <code>TRUE</code> the plot is displayed,
otherwise the data.frame for customised plotting with
<code>ggplot</code> is returned (<code>default = TRUE</code>).</p>
</td></tr>
<tr><td><code id="plot_hist_+3A_binwidth">binwidth</code></td>
<td>
<p>Numeric, the width of the bins used to plot
the histogram, the <code>binwidth</code> in the
<code>geom_freqpoly</code> function  in <code>ggplot</code>
(default corresponds to 30 bins).</p>
</td></tr>
<tr><td><code id="plot_hist_+3A_displlines">displLines</code></td>
<td>
<p>Logical, if <code>TRUE</code> lines are displayed
instead of bins (<code>default = FALSE</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>displ = TRUE</code>, a histogram of the stochastic model
under the scenario weights.
</p>
<p>If <code>displ = FALSE</code>, a data.frame for customised plotting with
<code>ggplot</code>. The data.frame contains the columns: the column,
<code>xCol</code>, of the data of the stressed model, <code>stress</code>
(the stresses) and <code>value</code> (the values). <br />
Denote by <code>res</code> the return of the function call, then
<code>ggplot</code> can be called via:
</p>
<p style="text-align: center;"><code class="reqn">ggplot(res, aes(x = res[ ,1], y = ..density.., weight = value)))</code>
</p>

<p style="text-align: center;"><code class="reqn"> + geom_{freqpoly}(binwidth, aes(color = factor(stress))).</code>
</p>



<h3>See Also</h3>

<p>See <code><a href="#topic+cdf">cdf</a></code> and <code><a href="#topic+plot_cdf">plot_cdf</a></code> for
values and plotting of the empirical distribution
function of a stressed model, respectively, and
<code><a href="#topic+quantile_stressed">quantile_stressed</a></code> for sample quantiles of
a stressed model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example with a stress on VaR
set.seed(0)
x &lt;- data.frame("gamma" = rgamma(10^5, shape = 2))
res1 &lt;- stress(type = "VaR", x = x,
  alpha = c(0.75, 0.95), q_ratio = 1.1)
plot_hist(res1, xCol = "gamma", wCol = 1:2, base = TRUE, binwidth = 0.4)
plot_hist(res1, xCol = "gamma", wCol = 1:2, base = TRUE, binwidth = 0.4, displLines = TRUE)

</code></pre>

<hr>
<h2 id='plot_quantile'>Plotting Quantile Functions of a Stressed Model</h2><span id='topic+plot_quantile'></span>

<h3>Description</h3>

<p>Plots the empirical quantile function of a stressed SWIM model
component (random variable) or KDE quantile function of a stressed
SWIMw model component under the scenario weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_quantile(
  object,
  xCol = 1,
  wCol = "all",
  base = FALSE,
  n = 500,
  x_limits,
  y_limits,
  displ = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_quantile_+3A_object">object</code></td>
<td>
<p>A <code>SWIM</code> or <code>SWIMw</code> object.</p>
</td></tr>
<tr><td><code id="plot_quantile_+3A_xcol">xCol</code></td>
<td>
<p>Numeric or character, (name of) the column of the underlying data
of the <code>object</code> (<code>default = 1</code>).</p>
</td></tr>
<tr><td><code id="plot_quantile_+3A_wcol">wCol</code></td>
<td>
<p>Vector, the columns of the scenario weights 
of the <code>object</code> corresponding to different 
stresses (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="plot_quantile_+3A_base">base</code></td>
<td>
<p>Logical, if <code>TRUE</code>, statistics under the baseline 
are also returned (<code>default = "FALSE"</code>).</p>
</td></tr>
<tr><td><code id="plot_quantile_+3A_n">n</code></td>
<td>
<p>Integer, the number of points used to plot 
(<code>default = 500</code>).</p>
</td></tr>
<tr><td><code id="plot_quantile_+3A_x_limits">x_limits</code></td>
<td>
<p>Vector, the limits of the x-axis of the plot, the
value for <code>xlim</code> in the <code>coord_cartesian</code>
function in <code>ggplot</code>.</p>
</td></tr>
<tr><td><code id="plot_quantile_+3A_y_limits">y_limits</code></td>
<td>
<p>Vector, the limits of the y-axis of the plot, the
value for <code>ylim</code> in the <code>coord_cartesian</code>
function in <code>ggplot</code>.</p>
</td></tr>
<tr><td><code id="plot_quantile_+3A_displ">displ</code></td>
<td>
<p>Logical, if <code>TRUE</code> the plot is displayed,
otherwise the data.frame for customised plotting with
<code>ggplot</code> is returned (<code>default = TRUE</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>displ = TRUE</code>, a plot displaying the empirical or KDE 
quantile function of the stochastic model under the
scenario weights.
</p>
<p>If <code>displ = FALSE</code>, a data.frame for customised plotting with
<code>ggplot</code>. The data.frame contains the following columns:
<code>grid</code>, the grid points to plot the quantiles,
<code>stress</code> (the stresses) and <code>value</code> (the quantile values). <br />
Denote by <code>res</code> the return of the function call, then
<code>ggplot</code> can be called via:
</p>
<p style="text-align: center;"><code class="reqn">ggplot(res, aes(x = res[ ,1], y = value))</code>
</p>

<p style="text-align: center;"><code class="reqn"> + geom_lines(aes(color = factor(stress))).</code>
</p>



<h3>Author(s)</h3>

<p>Silvana M. Pesenti, Zhuomin Mao
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+quantile_stressed">quantile_stressed</a></code> for sample quantiles of a 
stressed model and <code><a href="#topic+plot_cdf">plot_cdf</a></code> for plotting empirical or KDE 
distribution functions under scenario weights.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example with a stress on VaR
set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(10 ^ 5),
  "gamma" = rgamma(10 ^ 5, shape = 2)))
res1 &lt;- stress(type = "VaR", x = x,
  alpha = c(0.75, 0.95), q_ratio = 1.15)
plot_quantile(res1, xCol = 1, wCol = 1:2, base = TRUE)
plot_quantile(res1, xCol = 1, wCol = 1:2, base = TRUE, x_limits = c(0.8, 1), 
              y_limits = c(0, 5))

</code></pre>

<hr>
<h2 id='plot_sensitivity'>Plotting Sensitivities of a Stressed Model</h2><span id='topic+plot_sensitivity'></span>

<h3>Description</h3>

<p>Plots the sensitivity measures for components (random variables)
of a stochastic model under the scenario weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_sensitivity(
  object,
  xCol = "all",
  wCol = "all",
  type = c("Gamma", "Kolmogorov", "Wasserstein", "reverse", "all"),
  f = NULL,
  k = NULL,
  s = NULL,
  displ = TRUE,
  p = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_sensitivity_+3A_object">object</code></td>
<td>
<p>A <code>SWIM</code> or <code>SWIMw</code> object.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_xcol">xCol</code></td>
<td>
<p>Numeric or character vector, (names of) the columns
of the underlying data of the <code>object</code>
(<code>default = "all"</code>). If <code>xCol = NULL</code>, only
the transformed data <code>f(x)</code> is considered.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_wcol">wCol</code></td>
<td>
<p>Vector, the columns of the scenario weights 
of the <code>object</code> corresponding to different 
stresses (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_type">type</code></td>
<td>
<p>Character, one of <code>"Gamma", "Kolmogorov",
"Wasserstein", "reverse", "all"</code> (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_f">f</code></td>
<td>
<p>A function, or list of functions, that, applied to
<code>x</code>, constitute the transformation of the data
for which the sensitivity is calculated.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_k">k</code></td>
<td>
<p>A vector or list of vectors, same length as <code>f</code>,
indicating which columns of <code>x</code> each function
in <code>f</code> operates on.<br />
When <code>f</code> is a list, <code>k[[i]]</code> corresponds
to the input variables of <code>f[[i]]</code>.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_s">s</code></td>
<td>
<p>A function that, applied to <code>x</code>, defines the reverse
sensitivity measure. If <code>type = "reverse"</code> and 
<code>s = NULL</code>, defaults to <code>type = "Gamma"</code>.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_displ">displ</code></td>
<td>
<p>Logical, if <code>TRUE</code> the plot is displayed,
otherwise the data.frame for customised plotting with
<code>ggplot</code> is returned (<code>default = TRUE</code>).</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_p">p</code></td>
<td>
<p>Numeric vector, the p-th moment of Wasserstein distance (<code>default = 1</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the definition of the sensitivity
measures (<code>type</code>), see <code><a href="#topic+sensitivity">sensitivity</a></code>.
</p>
<p>Note that the Kolmogorov distance is the same for all inputs under
the same stress for a SWIM object. Thus, it should only be used to 
compare different stresses, not individual components.
</p>


<h3>Value</h3>

<p>If <code>displ = TRUE</code>, a plot displaying the sensitivity
measures of the stochastic model under the scenario weights.
If <code>displ = FALSE</code>, a data.frame for customised plotting with
<code>ggplot</code>. The data.frame
contains the columns: <code>stress</code> (the stresses), <code>type</code>
(the types of sensitivity), <code>X_all</code> (the random variables),
<code>value</code> (the values of the sensitivities). <br />
Denote by <code>result</code> the return of the function call, then
<code>ggplot</code> can be called via:
</p>
<p style="text-align: center;"><code class="reqn">ggplot(result, aes(x = X_{all}, y = value))</code>
</p>

<p style="text-align: center;"><code class="reqn"> + geom_{point}(aes(color = factor(stress), shape = type)).</code>
</p>



<h3>Author(s)</h3>

<p>Silvana M. Pesenti
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+sensitivity">sensitivity</a></code> for the values of the
sensitivity measures of a stressed model and
<code><a href="#topic+importance_rank">importance_rank</a></code> for ranking of random
variables according to their sensitivities.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Consider the portfolio Y = X1 + X2 + X3 + X4 + X5,
## where (X1, X2, X3, X4, X5) are correlated normally
## distributed with equal mean and different standard deviations,
## see the README for further details.


set.seed(0)
SD &lt;- c(70, 45, 50, 60, 75)
Corr &lt;- matrix(rep(0.5, 5 ^ 2), nrow = 5) + diag(rep(1 - 0.5, 5))
if (!requireNamespace("mvtnorm", quietly = TRUE))
   stop("Package \"mvtnorm\" needed for this function
   to work. Please install it.")
x &lt;- mvtnorm::rmvnorm(10 ^ 5,
   mean =  rep(100, 5),
   sigma = (SD %*% t(SD)) * Corr)
data &lt;- data.frame(rowSums(x), x)
names(data) &lt;- c("Y", "X1", "X2", "X3", "X4", "X5")
rev.stress &lt;- stress(type = "VaR", x = data,
   alpha = c(0.75, 0.9), q_ratio = 1.1, k = 1)

sensitivity(rev.stress, type = "all")
plot_sensitivity(rev.stress, xCol = 2:6, type = "Gamma")
plot_sensitivity(rev.stress, xCol = 6, wCol = 1, type = "all")


</code></pre>

<hr>
<h2 id='plot_weights'>Plotting the scenario weights of a Stressed Model</h2><span id='topic+plot_weights'></span>

<h3>Description</h3>

<p>Plots the scenario weights of a stressed model against a model component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_weights(
  object,
  xCol = 1,
  wCol = "all",
  n,
  x_limits,
  y_limits,
  displ = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_weights_+3A_object">object</code></td>
<td>
<p>A <code>SWIM</code> or <code>SWIMw</code> object.</p>
</td></tr>
<tr><td><code id="plot_weights_+3A_xcol">xCol</code></td>
<td>
<p>Numeric or character, (name of) the column of the underlying data
of the <code>object</code> (<code>default = 1</code>).</p>
</td></tr>
<tr><td><code id="plot_weights_+3A_wcol">wCol</code></td>
<td>
<p>Vector, the columns of the scenario weights 
of the <code>object</code> corresponding to different 
stresses (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="plot_weights_+3A_n">n</code></td>
<td>
<p>Integer, the number of points used to plot 
(<code>default = 5000</code> or the minimum of the data). If 
<code>n = "all"</code>, all data points are plotted. If <code>n</code> is
a subset of points, the plotted scenario weights are chosen in 
an equidistant way.</p>
</td></tr>
<tr><td><code id="plot_weights_+3A_x_limits">x_limits</code></td>
<td>
<p>Vector, the limits of the x-axis of the plot, the
value for <code>xlim</code> in the <code>coord_cartesian</code>
function in <code>ggplot</code>.</p>
</td></tr>
<tr><td><code id="plot_weights_+3A_y_limits">y_limits</code></td>
<td>
<p>Vector, the limits of the y-axis of the plot, the
value for <code>ylim</code> in the <code>coord_cartesian</code>
function in <code>ggplot</code>.</p>
</td></tr>
<tr><td><code id="plot_weights_+3A_displ">displ</code></td>
<td>
<p>Logical, if <code>TRUE</code> the plot is displayed,
otherwise the data.frame for customised plotting with
<code>ggplot</code> is returned (<code>default = TRUE</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>displ = TRUE</code>, a plot displaying the scenario
weights of a stochastic model against a model component.
</p>
<p>If <code>displ = FALSE</code>, a data.frame for customised plotting with
<code>ggplot</code>. The data.frame contains the following columns:
<code>grid</code>, the grid points to plot the quantiles,
<code>stress</code> (the stresses) and <code>value</code> (the quantile values). <br />
Denote by <code>res</code> the return of the function call, then
<code>ggplot</code> can be called via:
</p>
<p style="text-align: center;"><code class="reqn">ggplot(res, aes(x = res[ ,1], y = value))</code>
</p>

<p style="text-align: center;"><code class="reqn"> + geom_lines(aes(color = factor(stress))).</code>
</p>



<h3>See Also</h3>

<p>See <code><a href="#topic+plot_quantile">plot_quantile</a></code> for plotting sample quantiles of a 
stressed model and <code><a href="#topic+plot_cdf">plot_cdf</a></code> for plotting empirical 
distribution functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
## example with a stress with \code{credit_data} data set:
data("credit_data")
## two stresses in VaR
model_stress &lt;- stress_VaR(credit_data, alpha = c(0.9, 0.95), q_ratio = 1.1, k =1) 
plot_weights(model_stress, xCol = "L", wCol = 1:2)

## additional stress on VaR and ES
model_stress &lt;- stress_VaR_ES(model_stress, alpha = 0.9, q_ratio = 1.1, s_ratio = 1.2, k =1) 
plot_weights(model_stress, xCol = "L", wCol = "all", n = 1000, x_limits = c(0, 3500), 
             y_limits = c(0, 10))
             

</code></pre>

<hr>
<h2 id='quantile_stressed'>Sample Quantiles of a Stressed Model</h2><span id='topic+quantile_stressed'></span>

<h3>Description</h3>

<p>Provides sample quantiles for components (random variables) of a 
stochastic model, corresponding to distribution functions 
under the scenario weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantile_stressed(
  object,
  probs = seq(0, 1, 0.25),
  xCol = "all",
  wCol = 1,
  type = c("quantile", "(i-1)/(n-1)", "i/(n+1)", "i/n"),
  base = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quantile_stressed_+3A_object">object</code></td>
<td>
<p>A <code>SWIM</code> or <code>SWIMw</code> object.</p>
</td></tr>
<tr><td><code id="quantile_stressed_+3A_probs">probs</code></td>
<td>
<p>Vector of probabilities with values 
in <code>[0,1]</code> (<code>default = (0, 0.25, 
0.5, 0.75, 1)</code>).</p>
</td></tr>
<tr><td><code id="quantile_stressed_+3A_xcol">xCol</code></td>
<td>
<p>Numeric or character vector, (names of) the columns of 
the underlying data 
of the <code>object</code> (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="quantile_stressed_+3A_wcol">wCol</code></td>
<td>
<p>Numeric, the column of the scenario weights 
of the <code>object</code> (<code>default = 1</code>).</p>
</td></tr>
<tr><td><code id="quantile_stressed_+3A_type">type</code></td>
<td>
<p>Character, one of <code>"quantile","(i-1)/(n-1)",
"i/(n+1)","i/n"</code>, (<code>default  = "quantile"</code>). 
See details below.</p>
</td></tr>
<tr><td><code id="quantile_stressed_+3A_base">base</code></td>
<td>
<p>Logical, if <code>TRUE</code>, statistics under the baseline 
are also returned (<code>default = "FALSE"</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>type</code> defines the choice of algorithm used for 
calculating the estimate of the sample quantiles.  
<code>"quantile"</code> corresponds to the default interpolation used in  
<code><a href="stats.html#topic+quantile">quantile</a></code>. Further options are 
<code>"(i-1)/(n-1)", "i/(n+1)", "i/n"</code> the inverse of the
empirical distribution function, using, respectively, 
<code>(wt - 1)/T, wt/(T+1), wt/T</code>, where <code>wt</code> is the 
cumulative weight and <code>T</code> the total weight (usually total 
sample size). See <code><a href="Hmisc.html#topic+wtd.quantile">wtd.quantile</a></code> 
for further details on <code>type</code>, on which
<code>quantile_stressed</code> is based. <code>type</code> is ignored for 
when evaluating quantiles for <code>SWIMw</code> objects.
</p>


<h3>Value</h3>

<p>Returns a matrix with estimates of the distribution quantiles
at the probabilities, <code>probs</code>, under the scenario weights 
<code>wCol</code>.
</p>


<h3>Author(s)</h3>

<p>Silvana M. Pesenti, Zhuomin Mao
</p>


<h3>See Also</h3>

<p>See <code><a href="Hmisc.html#topic+wtd.quantile">wtd.quantile</a></code> on which the function
<code>quantile_stressed</code> is based. <br />
See <code>cdf</code> for the empirical distribution function of 
a stressed model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>     
## example with a stress on VaR
set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000), 
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress(type = "VaR", x = x, 
  alpha = c(0.9, 0.95), q_ratio = 1.05)
## stressed sample quantiles  
quantile_stressed(res1, probs = seq(0.9, 0.99, 0.01), wCol = 2)    
    
</code></pre>

<hr>
<h2 id='rename'>Rename Stressed Models</h2><span id='topic+rename'></span>

<h3>Description</h3>

<p>Rename Stressed Models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rename(object, names, k = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rename_+3A_object">object</code></td>
<td>
<p>A <code>SWIM</code> or <code>SWIMw</code> object</p>
</td></tr>
<tr><td><code id="rename_+3A_names">names</code></td>
<td>
<p>Character vector, the new names of k-th stressed model.</p>
</td></tr>
<tr><td><code id="rename_+3A_k">k</code></td>
<td>
<p>Numeric vector, the k-th stressed model of object to rename. (<code>default = 1</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Get a new <code>SWIM</code> object with desired <code>name</code>
</p>


<h3>Value</h3>

<p>An renamed object of class <code>SWIM</code> containing:
</p>

<ul>
<li> <p><code>x</code>, a data.frame containing the data;
</p>
</li>
<li> <p><code>new_weights</code>, a list, each component corresponds to 
a different stress and is either a vector of scenario weights or a
function, that applied to a column of <code>x</code>, generates the 
vectors of scenario weights; 
</p>
</li>
<li> <p><code>type</code>, a list, each component corresponds to a 
different stress and specifies the type of the stress;
</p>
</li>
<li> <p><code>specs</code>, a list, each component corresponds to 
a different stress and contains a list with the specifications 
of what has been stressed.
</p>
</li></ul>

<p>See <code><a href="#topic+SWIM">SWIM</a></code> for details.
</p>


<h3>Author(s)</h3>

<p>Kent Wu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000),
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress(type = "VaR", x = x,
  alpha = 0.9, q_ratio = 1.05)
res1 &lt;- rename(res1, "VaR_09", 1)

</code></pre>

<hr>
<h2 id='sd_stressed'>Standard Deviation and Variance of a Stressed Model</h2><span id='topic+sd_stressed'></span><span id='topic+var_stressed'></span>

<h3>Description</h3>

<p>Provides the standard deviation and variance of stressed 
model components (random variables) under the scenario weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sd_stressed(object, xCol = "all", wCol = "all", base = FALSE)

var_stressed(object, xCol = "all", wCol = "all", base = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sd_stressed_+3A_object">object</code></td>
<td>
<p>A <code>SWIM</code> or <code>SWIMw</code> object.</p>
</td></tr>
<tr><td><code id="sd_stressed_+3A_xcol">xCol</code></td>
<td>
<p>Numeric or character vector, (names of) the columns of 
the underlying data 
of the <code>object</code> (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="sd_stressed_+3A_wcol">wCol</code></td>
<td>
<p>Vector, the columns of the scenario weights 
of the <code>object</code> corresponding to different 
stresses (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="sd_stressed_+3A_base">base</code></td>
<td>
<p>Logical, if <code>TRUE</code>, statistics under the baseline 
are also returned (<code>default = "FALSE"</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>sd_stressed</code>: The standard deviation of 
a chosen model component, subject to the calculated scenario weights.
</p>
<p><code>var_stressed</code>: The variance of 
a chosen stressed model component, subject to the calculated scenario weights.
</p>


<h3>Value</h3>

<p><code>sd_stressed</code>: Return the standard deviation of the <code>xCol</code>
component of the stressed model with weights <code>wCol</code>.
The quantity can be evaluated at a vector.
</p>
<p><code>var_stressed</code>: Return the variance of the <code>xCol</code>
component of the stressed model with weights <code>wCol</code>.
The quantity can be evaluated at a vector.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>sd_stressed</code>: Sample standard deviation of model components
</p>
</li>
<li> <p><code>var_stressed</code>: Sample variance of model components
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Kent Wu
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+mean_stressed">mean_stressed</a></code> for means of stressed model components,
and <code><a href="#topic+cor_stressed">cor_stressed</a></code> for correlations between stressed model components.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>     
## example with a stress on VaR
set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000), 
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress(type = "VaR", x = x, 
  alpha = c(0.9, 0.95), q_ratio = 1.05)
## stressed standard deviation
sd_stressed(res1, xCol = "all", wCol = "all", base = TRUE)

## stressed variance
var_stressed(res1, xCol = "all", wCol = "all", base = TRUE)

</code></pre>

<hr>
<h2 id='sensitivity'>Sensitivities of a Stressed Model</h2><span id='topic+sensitivity'></span>

<h3>Description</h3>

<p>Provides different sensitivity measures that compare the stressed
and the baseline model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sensitivity(
  object,
  xCol = "all",
  wCol = "all",
  type = c("Gamma", "Kolmogorov", "Wasserstein", "reverse", "all"),
  f = NULL,
  k = NULL,
  s = NULL,
  p = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sensitivity_+3A_object">object</code></td>
<td>
<p>A <code>SWIM</code> or <code>SWIMw</code> object.</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_xcol">xCol</code></td>
<td>
<p>Numeric or character vector, (names of) the columns
of the underlying data of the <code>object</code>
(<code>default = "all"</code>). If <code>xCol = NULL</code>, only
the transformed data <code>f(x)</code> is considered.</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_wcol">wCol</code></td>
<td>
<p>Vector, the columns of the scenario weights 
of the <code>object</code> corresponding to different 
stresses (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_type">type</code></td>
<td>
<p>Character, one of <code>"Gamma", "Kolmogorov",
"Wasserstein", "reverse", "all"</code> (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_f">f</code></td>
<td>
<p>A function, or list of functions, that, applied to
<code>x</code>, constitute the transformation of the data
for which the sensitivity is calculated.</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_k">k</code></td>
<td>
<p>A vector or list of vectors, same length as <code>f</code>,
indicating which columns of <code>x</code> each function
in <code>f</code> operates on.<br />
When <code>f</code> is a list, <code>k[[i]]</code> corresponds
to the input variables of <code>f[[i]]</code>.</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_s">s</code></td>
<td>
<p>A function that, applied to <code>x</code>, defines the reverse
sensitivity measure. If <code>type = "reverse"</code> and 
<code>s = NULL</code>, defaults to <code>type = "Gamma"</code>.</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_p">p</code></td>
<td>
<p>Numeric vector, the p-th moment of Wasserstein distance (<code>default = 1</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provides sensitivity measures that compare the stressed and
the baseline model. Implemented sensitivity measures:
</p>

<ol>
<li>
<p><code>Gamma</code>, the <em>Reverse Sensitivity Measure</em>, defined
for a random variable <code>Y</code> and scenario weights <code>w</code> by
</p>
<p style="text-align: center;"><code class="reqn">Gamma = ( E(Y * w) - E(Y) ) / c,</code>
</p>

<p>where <code>c</code> is a normalisation constant such that
<code>|Gamma| &lt;= 1</code>, see
(Pesenti et al. 2019). Loosely speaking, the
Reverse Sensitivity Measure is the normalised difference
between the first moment of the stressed and the baseline
distributions of <code>Y</code>.
</p>
</li>
<li>
<p><code>Kolmogorov</code>, the Kolmogorov distance, defined for
distribution functions <code>F,G</code> by
</p>
<p style="text-align: center;"><code class="reqn">Kolmogorov = sup |F(x) - G(x)|.</code>
</p>

</li>
<li>
<p><code>Wasserstein</code>, the Wasserstein distance of order 1, defined
for two distribution functions <code>F,G</code> by
</p>
<p style="text-align: center;"><code class="reqn">Wasserstein = \int |F(x) - G(x)| dx.</code>
</p>

</li>
<li>
<p><code>reverse</code>, the <em>General Reverse Sensitivity Measure</em>, defined
for a random variable <code>Y</code>, scenario weights <code>w</code>, and a function
<code>s:R -&gt; R</code> by </p>
<p style="text-align: center;"><code class="reqn">epsilon = ( E(s(Y) * w) - E(s(Y)) ) / c,</code>
</p>

<p>where <code>c</code> is a normalisation constant such that
<code>|epsilon| &lt;= 1</code>. <code>Gamma</code> is a special instance of
the reverse sensitivity measure when <code>s</code> is the identity function.
</p>
</li></ol>

<p>If <code>f</code> and <code>k</code> are provided, the sensitivity of the
transformed data is returned.
</p>


<h3>Value</h3>

<p>A data.frame containing the sensitivity measures of the
stressed model with rows corresponding to different random
variables. The first two rows specify the <code>stress</code> and
<code>type</code> of the sensitivity measure.
</p>


<h3>Author(s)</h3>

<p>Silvana M. Pesenti, Zhuomin Mao
</p>


<h3>References</h3>

<p>Pesenti SM, Millossovich P, Tsanakas A (2019).
&ldquo;Reverse sensitivity testing: What does it take to break the model?&rdquo;
<em>European Journal of Operational Research</em>, <b>274</b>(2), 654&ndash;670.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+importance_rank">importance_rank</a></code> for ranking of random
variables according to their sensitivities,
<code><a href="#topic+plot_sensitivity">plot_sensitivity</a></code> for plotting
sensitivity measures and <code><a href="base.html#topic+summary">summary</a></code> for
summary statistics of a stressed model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example with a stress on VaR
set.seed(0)
x &lt;- as.data.frame(cbind(
  "log-normal" = rlnorm(1000),
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress(type = "VaR", x = x,
  alpha = c(0.9, 0.95), q_ratio = 1.05)

sensitivity(res1, wCol = 1, type = "all")
## sensitivity of log-transformed data
sensitivity(res1, wCol = 1, type = "all",
  f = list(function(x)log(x), function(x)log(x)), k = list(1,2))

## Consider the portfolio Y = X1 + X2 + X3 + X4 + X5,
## where (X1, X2, X3, X4, X5) are correlated normally
## distributed with equal mean and different standard deviations,
## see the README for further details.


## Not run: 
set.seed(0)
SD &lt;- c(70, 45, 50, 60, 75)
Corr &lt;- matrix(rep(0.5, 5 ^ 2), nrow = 5) + diag(rep(1 - 0.5, 5))
if (!requireNamespace("mvtnorm", quietly = TRUE))
   stop("Package \"mvtnorm\" needed for this function
   to work. Please install it.")
x &lt;- mvtnorm::rmvnorm(10 ^ 5,
   mean =  rep(100, 5),
   sigma = (SD %*% t(SD)) * Corr)
data &lt;- data.frame(rowSums(x), x)
names(data) &lt;- c("Y", "X1", "X2", "X3", "X4", "X5")
rev.stress &lt;- stress(type = "VaR", x = data,
   alpha = c(0.75, 0.9), q_ratio = 1.1, k = 1)

sensitivity(rev.stress, type = "all")
## sensitivity to sub-portfolios X1 + X2 and X3 + X4
sensitivity(rev.stress, xCol = NULL, type = "Gamma",
  f = rep(list(function(x)x[1] + x[2]), 2), k = list(c(2, 3), c(4, 5)))
plot_sensitivity(rev.stress, xCol = 2:6, type = "Gamma")
importance_rank(rev.stress, xCol = 2:6, type = "Gamma")

## End(Not run)

</code></pre>

<hr>
<h2 id='stress'>Stressing Random Variables</h2><span id='topic+stress'></span>

<h3>Description</h3>

<p>Provides weights on simulated scenarios from a baseline stochastic
model, such that stressed random variables fulfil given 
probabilistic constraints (e.g. specified values for risk 
measures), under the new scenario weights. Scenario weights are 
selected by constrained minimisation of the relative entropy to the
baseline model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stress(
  type = c("VaR", "VaR ES", "mean", "mean sd", "moment", "prob", "user"),
  x,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stress_+3A_type">type</code></td>
<td>
<p>Type of stress, one of <code>"VaR", 
"VaR ES", "mean", "mean sd", "moment", "prob", "user"</code>.</p>
</td></tr>
<tr><td><code id="stress_+3A_x">x</code></td>
<td>
<p>A vector, matrix or data frame
containing realisations of random variables. Columns of <code>x</code>
correspond to random variables; OR<br />
A <code>SWIM</code> object, where <code>x</code> corresponds to the
underlying data of the <code>SWIM</code> object.</p>
</td></tr>
<tr><td><code id="stress_+3A_...">...</code></td>
<td>
<p>Arguments to be passed on, depending on <code>type</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>SWIM</code>, see <code><a href="#topic+SWIM">SWIM</a></code> 
for details.
</p>


<h3>Author(s)</h3>

<p>Silvana M. Pesenti
</p>


<h3>References</h3>

<p>Pesenti SM, Millossovich P, Tsanakas A (2019).
&ldquo;Reverse sensitivity testing: What does it take to break the model?&rdquo;
<em>European Journal of Operational Research</em>, <b>274</b>(2), 654&ndash;670.<br />
</p>
<p>Pesenti S BAMPTA (2020).
&ldquo;Scenario Weights for Importance Measurement (SWIM) - An R package for sensitivity analysis.&rdquo;
<em>Annals of Actuarial Science 15.2 (2021): 458-483. Available at SSRN: <a href="https://www.ssrn.com/abstract=3515274">https://www.ssrn.com/abstract=3515274</a></em>.<br />
</p>
<p>Csiszar I (1975).
&ldquo;I-divergence geometry of probability distributions and minimization problems.&rdquo;
<em>The Annals of Probability</em>, 146&ndash;158.
</p>


<h3>See Also</h3>

<p>Other stress functions: 
<code><a href="#topic+stress_HARA_RM_w">stress_HARA_RM_w</a>()</code>,
<code><a href="#topic+stress_RM_mean_sd_w">stress_RM_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_RM_w">stress_RM_w</a>()</code>,
<code><a href="#topic+stress_VaR_ES">stress_VaR_ES</a>()</code>,
<code><a href="#topic+stress_VaR">stress_VaR</a>()</code>,
<code><a href="#topic+stress_mean_sd_w">stress_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_mean_sd">stress_mean_sd</a>()</code>,
<code><a href="#topic+stress_mean_w">stress_mean_w</a>()</code>,
<code><a href="#topic+stress_mean">stress_mean</a>()</code>,
<code><a href="#topic+stress_moment">stress_moment</a>()</code>,
<code><a href="#topic+stress_prob">stress_prob</a>()</code>,
<code><a href="#topic+stress_user">stress_user</a>()</code>,
<code><a href="#topic+stress_wass">stress_wass</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000), 
  "gamma" = rgamma(1000, shape = 2)))
res &lt;- stress(type = "VaR", x = x, 
  alpha = 0.9, q_ratio = 1.05)
summary(res)   

</code></pre>

<hr>
<h2 id='stress_HARA_RM_w'>Stressing Risk Measure and HARA Utility</h2><span id='topic+stress_HARA_RM_w'></span>

<h3>Description</h3>

<p>Provides weights on simulated scenarios from a baseline stochastic
model, such that a stressed model component (random variable) fulfills a
constraint on its HARA utility defined by <code>a</code>, <code>b</code> and 
<code>eta</code> parameter and risk measure defined by a <code>gamma</code> 
function and evaluated at a given level <code>alpha</code>. Scenario weights are
selected by constrained minimisation of the Wasserstein distance to the
baseline model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stress_HARA_RM_w(
  x,
  alpha = 0.8,
  a,
  b,
  eta,
  q_ratio = NULL,
  q = NULL,
  hu_ratio = NULL,
  hu = NULL,
  k = 1,
  h = 1,
  gamma = NULL,
  names = NULL,
  log = FALSE,
  method = "Nelder-Mead"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stress_HARA_RM_w_+3A_x">x</code></td>
<td>
<p>A vector, matrix or data frame
containing realisations of random variables. Columns of <code>x</code>
correspond to random variables; OR<br />
A <code>SWIMw</code> object, where <code>x</code> corresponds to the
underlying data of the <code>SWIMw</code> object. The stressed random component is assumed continuously distributed.</p>
</td></tr>
<tr><td><code id="stress_HARA_RM_w_+3A_alpha">alpha</code></td>
<td>
<p>Numeric, vector, the level of the Expected Shortfall. (<code>default Expected Shortfall</code>)<br /></p>
</td></tr>
<tr><td><code id="stress_HARA_RM_w_+3A_a">a</code></td>
<td>
<p>Numeric vector, input to HARA utility function.<br /></p>
</td></tr>
<tr><td><code id="stress_HARA_RM_w_+3A_b">b</code></td>
<td>
<p>Numeric vector, input to HARA utility function.<br /></p>
</td></tr>
<tr><td><code id="stress_HARA_RM_w_+3A_eta">eta</code></td>
<td>
<p>Numeric vector, input to HARA utility function.<br /></p>
</td></tr>
<tr><td><code id="stress_HARA_RM_w_+3A_q_ratio">q_ratio</code></td>
<td>
<p>Numeric, vector, the ratio of the stressed RM to
the baseline RM (must be same length as <code>alpha</code>).<br /></p>
</td></tr>
<tr><td><code id="stress_HARA_RM_w_+3A_q">q</code></td>
<td>
<p>Numeric, vector, the stressed RM at level
<code>alpha</code> (must be same length as <code>alpha</code>).<br /></p>
</td></tr>
<tr><td><code id="stress_HARA_RM_w_+3A_hu_ratio">hu_ratio</code></td>
<td>
<p>Numeric, vector, the ratio of the HARA utility to the 
baseline HARA utility.<br /></p>
</td></tr>
<tr><td><code id="stress_HARA_RM_w_+3A_hu">hu</code></td>
<td>
<p>Numeric, vector, the stressed HARA utility with parameters
<code>a</code>, <code>b</code> and <code>eta</code>.<br /></p>
</td></tr>
<tr><td><code id="stress_HARA_RM_w_+3A_k">k</code></td>
<td>
<p>Numeric, the column of <code>x</code> that is stressed
<code>(default = 1)</code>.<br /></p>
</td></tr>
<tr><td><code id="stress_HARA_RM_w_+3A_h">h</code></td>
<td>
<p>Numeric, a multiplier of the default bandwidth using Silverman’s rule (default <code>h = 1</code>).<br /></p>
</td></tr>
<tr><td><code id="stress_HARA_RM_w_+3A_gamma">gamma</code></td>
<td>
<p>Function of one variable, that defined the gamma of the risk measure. (<code>default Expected Shortfall</code>).<br /></p>
</td></tr>
<tr><td><code id="stress_HARA_RM_w_+3A_names">names</code></td>
<td>
<p>Character vector, the names of stressed models.</p>
</td></tr>
<tr><td><code id="stress_HARA_RM_w_+3A_log">log</code></td>
<td>
<p>Boolean, the option to print weights' statistics.</p>
</td></tr>
<tr><td><code id="stress_HARA_RM_w_+3A_method">method</code></td>
<td>
<p>The method to be used in [stats::optim()]. (<code>default = Nelder-Mead</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements stresses on distortion risk measures.
Distortion risk measures are defined by a square-integrable function
<code>gamma</code> where
</p>
<p style="text-align: center;"><code class="reqn">\int_0^1 gamma(u) du = 1.</code>
</p>

<p>The distortion risk measure for some <code>gamma</code> and distribution 
<code>G</code> is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">\rho_{gamma}(G) = \int_0^1 \breve(G)(u) gamma(u) du.</code>
</p>

<p>Expected Shortfall (ES) is an example of a distortion risk measure.
The ES at level <code>alpha</code> of a random variable with distribution
function F is defined by:
</p>
<p style="text-align: center;"><code class="reqn">ES_{alpha} = 1 / (1 - alpha) * \int_{alpha}^1 VaR_u d u.</code>
</p>

<p>The HARA Utility is defined by 
</p>
<p style="text-align: center;"><code class="reqn">u(x) = \frac{1-eta}{eta}(\frac{ax}{1 - eta} + b)^eta</code>
</p>
<p>.
</p>


<h3>Value</h3>

<p>A <code>SWIMw</code> object containing:
</p>

<ul>
<li> <p><code>x</code>, a data.frame containing the data;
</p>
</li>
<li> <p><code>h</code>, h is a multiple of the Silverman’s rule;
</p>
</li>
<li> <p><code>u</code>, vector containing the gridspace on [0, 1];
</p>
</li>
<li> <p><code>lam</code>, vector containing the lambda's of the optimized model;
</p>
</li>
<li> <p><code>str_fY</code>, function defining the densities of the stressed component;
</p>
</li>
<li> <p><code>str_FY</code>, function defining the distribution of the stressed component;
</p>
</li>
<li> <p><code>str_FY_inv</code>, function defining the quantiles of the stressed component;
</p>
</li>
<li> <p><code>gamma</code>, function defining the risk measure;
</p>
</li>
<li> <p><code>new_weights</code>, a list of functions, that applied to
the <code>k</code>th column of <code>x</code>, generates the vectors of scenario
weights. Each component corresponds to a different stress;
</p>
</li>
<li> <p><code>type = "HARA RM"</code>;
</p>
</li>
<li> <p><code>specs</code>, a list, each component corresponds to
a different stress and contains <code>k</code>, <code>alpha</code>, <code>a</code>, <code>b</code>,
<code>eta</code>, <code>q</code>, and <code>hu</code>.
</p>
</li></ul>

<p>See <code><a href="#topic+SWIM">SWIM</a></code> for details.
</p>


<h3>Author(s)</h3>

<p>Zhuomin Mao
</p>


<h3>References</h3>

<p>Pesenti SM, Millossovich P, Tsanakas A (2019).
&ldquo;Reverse sensitivity testing: What does it take to break the model?&rdquo;
<em>European Journal of Operational Research</em>, <b>274</b>(2), 654&ndash;670.<br />
</p>
<p>Pesenti S BAMPTA (2020).
&ldquo;Scenario Weights for Importance Measurement (SWIM) - An R package for sensitivity analysis.&rdquo;
<em>Annals of Actuarial Science 15.2 (2021): 458-483. Available at SSRN: <a href="https://www.ssrn.com/abstract=3515274">https://www.ssrn.com/abstract=3515274</a></em>.<br />
</p>
<p>Pesenti SM (2021).
&ldquo;Reverse Sensitivity Analysis for Risk Modelling.&rdquo;
<em>Available at SSRN 3878879</em>.
</p>


<h3>See Also</h3>

<p>Other stress functions: 
<code><a href="#topic+stress_RM_mean_sd_w">stress_RM_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_RM_w">stress_RM_w</a>()</code>,
<code><a href="#topic+stress_VaR_ES">stress_VaR_ES</a>()</code>,
<code><a href="#topic+stress_VaR">stress_VaR</a>()</code>,
<code><a href="#topic+stress_mean_sd_w">stress_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_mean_sd">stress_mean_sd</a>()</code>,
<code><a href="#topic+stress_mean_w">stress_mean_w</a>()</code>,
<code><a href="#topic+stress_mean">stress_mean</a>()</code>,
<code><a href="#topic+stress_moment">stress_moment</a>()</code>,
<code><a href="#topic+stress_prob">stress_prob</a>()</code>,
<code><a href="#topic+stress_user">stress_user</a>()</code>,
<code><a href="#topic+stress_wass">stress_wass</a>()</code>,
<code><a href="#topic+stress">stress</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000),
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress_wass(type = "HARA RM", x = x, a=1, b=5, eta=0.5, alpha=0.95,
 q_ratio=1.05, hu_ratio=1.05, k=1)
  summary(res1)

## calling stress_RM_w directly
## stressing "gamma"
res2 &lt;- stress_HARA_RM_w(x = x, a=1, b=5, eta=0.5, alpha=0.95,
 q_ratio=1.05, hu_ratio=1.05, k=2)
summary(res2)

## End(Not run)

</code></pre>

<hr>
<h2 id='stress_mean'>Stressing Means</h2><span id='topic+stress_mean'></span>

<h3>Description</h3>

<p>Provides weights on simulated scenarios from a baseline stochastic
model, such that stressed model components (random variables)
fulfil the mean constraints. Scenario weights are selected by
constrained minimisation of the relative entropy to the
baseline model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stress_mean(x, k, new_means, normalise = TRUE, names = NULL, log = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stress_mean_+3A_x">x</code></td>
<td>
<p>A vector, matrix or data frame
containing realisations of random variables. Columns of <code>x</code>
correspond to random variables; OR<br />
A <code>SWIM</code> object, where <code>x</code> corresponds to the
underlying data of the <code>SWIM</code> object.</p>
</td></tr>
<tr><td><code id="stress_mean_+3A_k">k</code></td>
<td>
<p>Numeric vector, the columns of <code>x</code> that
are stressed.</p>
</td></tr>
<tr><td><code id="stress_mean_+3A_new_means">new_means</code></td>
<td>
<p>Numeric vector, same length as <code>k</code>,
containing the stressed means.</p>
</td></tr>
<tr><td><code id="stress_mean_+3A_normalise">normalise</code></td>
<td>
<p>Logical. If true, values of <code>f(x)</code> are linearly
scaled to the unit interval.</p>
</td></tr>
<tr><td><code id="stress_mean_+3A_names">names</code></td>
<td>
<p>Character vector, the names of stressed models.</p>
</td></tr>
<tr><td><code id="stress_mean_+3A_log">log</code></td>
<td>
<p>Boolean, the option to print weights' statistics.</p>
</td></tr>
<tr><td><code id="stress_mean_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to
<code><a href="nleqslv.html#topic+nleqslv">nleqslv</a></code> or
<code><a href="#topic+stress_moment">stress_moment</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>stress_mean</code> is a wrapper for the
function <code>stress_moment</code>. See <code><a href="#topic+stress_moment">stress_moment</a></code>
for details on the additional arguments to <code>...</code> and
the underlying algorithm.
</p>


<h3>Value</h3>

<p>A <code>SWIM</code> object containing:
</p>

<ul>
<li> <p><code>x</code>, a data.frame containing the data;
</p>
</li>
<li> <p><code>new_weights</code>, a list, each component corresponds to
a different stress and is a vector of scenario weights;
</p>
</li>
<li> <p><code>type = "mean"</code>;
</p>
</li>
<li> <p><code>specs</code>, a list, each component corresponds to
a different stress and contains <code>k</code> and <code>new_means</code>.
</p>
</li></ul>

<p>See <code><a href="#topic+SWIM">SWIM</a></code> for details.
</p>


<h3>References</h3>

<p>Pesenti SM, Millossovich P, Tsanakas A (2019).
&ldquo;Reverse sensitivity testing: What does it take to break the model?&rdquo;
<em>European Journal of Operational Research</em>, <b>274</b>(2), 654&ndash;670.<br />
</p>
<p>Pesenti S BAMPTA (2020).
&ldquo;Scenario Weights for Importance Measurement (SWIM) - An R package for sensitivity analysis.&rdquo;
<em>Annals of Actuarial Science 15.2 (2021): 458-483. Available at SSRN: <a href="https://www.ssrn.com/abstract=3515274">https://www.ssrn.com/abstract=3515274</a></em>.<br />
</p>
<p>Csiszar I (1975).
&ldquo;I-divergence geometry of probability distributions and minimization problems.&rdquo;
<em>The Annals of Probability</em>, 146&ndash;158.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+stress_mean_sd">stress_mean_sd</a></code> for stressing means
and standard deviations jointly, and <code><a href="#topic+stress_moment">stress_moment</a></code> for
moment constraints.
</p>
<p>Other stress functions: 
<code><a href="#topic+stress_HARA_RM_w">stress_HARA_RM_w</a>()</code>,
<code><a href="#topic+stress_RM_mean_sd_w">stress_RM_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_RM_w">stress_RM_w</a>()</code>,
<code><a href="#topic+stress_VaR_ES">stress_VaR_ES</a>()</code>,
<code><a href="#topic+stress_VaR">stress_VaR</a>()</code>,
<code><a href="#topic+stress_mean_sd_w">stress_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_mean_sd">stress_mean_sd</a>()</code>,
<code><a href="#topic+stress_mean_w">stress_mean_w</a>()</code>,
<code><a href="#topic+stress_moment">stress_moment</a>()</code>,
<code><a href="#topic+stress_prob">stress_prob</a>()</code>,
<code><a href="#topic+stress_user">stress_user</a>()</code>,
<code><a href="#topic+stress_wass">stress_wass</a>()</code>,
<code><a href="#topic+stress">stress</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
x &lt;- data.frame(cbind(
  "normal" = rnorm(1000),
  "gamma" = rgamma(1000, shape = 2),
  "beta" = rbeta(1000, shape1 = 2, shape2 = 2)))
## stressing means
res1 &lt;- stress(type = "mean", x = x, k = 1:3,
  new_means = c(1, 1, 0.75))
summary(res1)
res1$specs
## calling stress_mean directly
res2 &lt;- stress_mean(x = x, k = 1:3,
  new_means = c(1, 1, 0.75))
summary(res2)

## See also examples in stress_moment and stress_mean_sd.

</code></pre>

<hr>
<h2 id='stress_mean_sd'>Stressing Mean and Standard Deviation</h2><span id='topic+stress_mean_sd'></span>

<h3>Description</h3>

<p>Provides weights on simulated scenarios from a baseline stochastic
model, such that stressed model components (random variables)
fulfil the mean and standard deviation constraints.
Scenario weights are selected by constrained minimisation of
the relative entropy to the baseline model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stress_mean_sd(
  x,
  k,
  new_means,
  new_sd,
  normalise = TRUE,
  names = NULL,
  log = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stress_mean_sd_+3A_x">x</code></td>
<td>
<p>A vector, matrix or data frame
containing realisations of random variables. Columns of <code>x</code>
correspond to random variables; OR<br />
A <code>SWIM</code> object, where <code>x</code> corresponds to the
underlying data of the <code>SWIM</code> object.</p>
</td></tr>
<tr><td><code id="stress_mean_sd_+3A_k">k</code></td>
<td>
<p>Numeric vector, the columns of <code>x</code> that
are stressed.</p>
</td></tr>
<tr><td><code id="stress_mean_sd_+3A_new_means">new_means</code></td>
<td>
<p>Numeric vector, same length as <code>k</code>,
containing the stressed means.</p>
</td></tr>
<tr><td><code id="stress_mean_sd_+3A_new_sd">new_sd</code></td>
<td>
<p>Numeric vector, same length as <code>k</code>,
containing the stressed standard deviations.</p>
</td></tr>
<tr><td><code id="stress_mean_sd_+3A_normalise">normalise</code></td>
<td>
<p>Logical. If true, values of <code>f(x)</code> are linearly
scaled to the unit interval.</p>
</td></tr>
<tr><td><code id="stress_mean_sd_+3A_names">names</code></td>
<td>
<p>Character vector, the names of stressed models.</p>
</td></tr>
<tr><td><code id="stress_mean_sd_+3A_log">log</code></td>
<td>
<p>Boolean, the option to print weights' statistics.</p>
</td></tr>
<tr><td><code id="stress_mean_sd_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to
<code><a href="nleqslv.html#topic+nleqslv">nleqslv</a></code> or
<code><a href="#topic+stress_moment">stress_moment</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>stress_mean_sd</code> is a wrapper for the
function <code>stress_moment</code>. See <code><a href="#topic+stress_moment">stress_moment</a></code>
for details on the additional arguments to <code>...</code> and
the underlying algorithm.
</p>
<p>For stressing means only, see <code><a href="#topic+stress_mean">stress_mean</a></code>,
for stressing higher moments and functions of moments,
see <code><a href="#topic+stress_moment">stress_moment</a></code>.
</p>


<h3>Value</h3>

<p>A <code>SWIM</code> object containing:
</p>

<ul>
<li> <p><code>x</code>, a data.frame containing the data;
</p>
</li>
<li> <p><code>new_weights</code>, a list, each component corresponds to
a different stress and is a vector of scenario weights;
</p>
</li>
<li> <p><code>type = "mean"</code>;
</p>
</li>
<li> <p><code>specs</code>, a list, each component corresponds to
a different stress and contains <code>k</code>, <code>new_means</code> and
<code>new_sd</code>.
</p>
</li></ul>

<p>See <code><a href="#topic+SWIM">SWIM</a></code> for details.
</p>


<h3>References</h3>

<p>Pesenti SM, Millossovich P, Tsanakas A (2019).
&ldquo;Reverse sensitivity testing: What does it take to break the model?&rdquo;
<em>European Journal of Operational Research</em>, <b>274</b>(2), 654&ndash;670.<br />
</p>
<p>Pesenti S BAMPTA (2020).
&ldquo;Scenario Weights for Importance Measurement (SWIM) - An R package for sensitivity analysis.&rdquo;
<em>Annals of Actuarial Science 15.2 (2021): 458-483. Available at SSRN: <a href="https://www.ssrn.com/abstract=3515274">https://www.ssrn.com/abstract=3515274</a></em>.<br />
</p>
<p>Csiszar I (1975).
&ldquo;I-divergence geometry of probability distributions and minimization problems.&rdquo;
<em>The Annals of Probability</em>, 146&ndash;158.
</p>


<h3>See Also</h3>

<p>Other stress functions: 
<code><a href="#topic+stress_HARA_RM_w">stress_HARA_RM_w</a>()</code>,
<code><a href="#topic+stress_RM_mean_sd_w">stress_RM_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_RM_w">stress_RM_w</a>()</code>,
<code><a href="#topic+stress_VaR_ES">stress_VaR_ES</a>()</code>,
<code><a href="#topic+stress_VaR">stress_VaR</a>()</code>,
<code><a href="#topic+stress_mean_sd_w">stress_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_mean_w">stress_mean_w</a>()</code>,
<code><a href="#topic+stress_mean">stress_mean</a>()</code>,
<code><a href="#topic+stress_moment">stress_moment</a>()</code>,
<code><a href="#topic+stress_prob">stress_prob</a>()</code>,
<code><a href="#topic+stress_user">stress_user</a>()</code>,
<code><a href="#topic+stress_wass">stress_wass</a>()</code>,
<code><a href="#topic+stress">stress</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
x &lt;- data.frame(cbind(
  "normal" = rnorm(1000),
  "gamma" = rgamma(1000, shape = 2),
  "beta" = rbeta(1000, shape1 = 2, shape2 = 2)))
## stressing mean and sd of column 1
res1 &lt;- stress(type = "mean sd", x = x, k = 1, new_means = 0.1,
  new_sd = 1.1, method = "Newton",
  control = list(maxit = 1000, ftol = 1E-15))
summary(res1)
## calling stress_mean_sd directly
res2 &lt;- stress_mean_sd(x = x, k = 1, new_means = 0.1,
  new_sd = 1.1, method = "Newton",
  control = list(maxit = 1000, ftol = 1E-15))

## See also examples in stress_moment.

</code></pre>

<hr>
<h2 id='stress_mean_sd_w'>Stressing Mean and Standard Deviation</h2><span id='topic+stress_mean_sd_w'></span>

<h3>Description</h3>

<p>Provides weights on simulated scenarios from a baseline stochastic
model, such that a stressed model component (random variable) fulfils a
constraint on its mean and standard deviation.
Scenario weights are
selected by constrained minimisation of the Wasserstein distance to the
baseline model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stress_mean_sd_w(
  x,
  new_means,
  new_sd,
  k = 1,
  h = 1,
  names = NULL,
  log = FALSE,
  method = "Nelder-Mead",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stress_mean_sd_w_+3A_x">x</code></td>
<td>
<p>A vector, matrix or data frame
containing realisations of random variables. Columns of <code>x</code>
correspond to random variables; OR<br />
A <code>SWIMw</code> object, where <code>x</code> corresponds to the
underlying data of the <code>SWIMw</code> object. The stressed random component is assumed continuously distributed.</p>
</td></tr>
<tr><td><code id="stress_mean_sd_w_+3A_new_means">new_means</code></td>
<td>
<p>Numeric, the stressed mean.<br /></p>
</td></tr>
<tr><td><code id="stress_mean_sd_w_+3A_new_sd">new_sd</code></td>
<td>
<p>Numeric, the stressed standard deviation.<br /></p>
</td></tr>
<tr><td><code id="stress_mean_sd_w_+3A_k">k</code></td>
<td>
<p>Numeric, the column of <code>x</code> that is stressed
<code>(default = 1)</code>.<br /></p>
</td></tr>
<tr><td><code id="stress_mean_sd_w_+3A_h">h</code></td>
<td>
<p>Numeric, a multiplier of the default bandwidth using Silverman’s rule (default <code>h = 1</code>).<br /></p>
</td></tr>
<tr><td><code id="stress_mean_sd_w_+3A_names">names</code></td>
<td>
<p>Character vector, the names of stressed models.</p>
</td></tr>
<tr><td><code id="stress_mean_sd_w_+3A_log">log</code></td>
<td>
<p>Boolean, the option to print weights' statistics.</p>
</td></tr>
<tr><td><code id="stress_mean_sd_w_+3A_method">method</code></td>
<td>
<p>The method to be used in [stats::optim()]. (<code>default = Nelder-Mead</code>).</p>
</td></tr>
<tr><td><code id="stress_mean_sd_w_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to
<code><a href="nleqslv.html#topic+nleqslv">nleqslv</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>SWIMw</code> object containing:
</p>

<ul>
<li> <p><code>x</code>, a data.frame containing the data;
</p>
</li>
<li> <p><code>h</code>, h is a multiple of the Silverman’s rule;
</p>
</li>
<li> <p><code>u</code>, vector containing the gridspace on [0, 1];
</p>
</li>
<li> <p><code>lam</code>, vector containing the lambda's of the optimized model;
</p>
</li>
<li> <p><code>str_fY</code>, function defining the densities of the stressed component;
</p>
</li>
<li> <p><code>str_FY</code>, function defining the distribution of the stressed component;
</p>
</li>
<li> <p><code>str_FY_inv</code>, function defining the quantiles of the stressed component;
</p>
</li>
<li> <p><code>gamma</code>, function defining the risk measure;
</p>
</li>
<li> <p><code>new_weights</code>, a list of functions, that applied to
the <code>k</code>th column of <code>x</code>, generates the vectors of scenario
weights. Each component corresponds to a different stress;
</p>
</li>
<li> <p><code>type = "mean sd"</code>;
</p>
</li>
<li> <p><code>specs</code>, a list, each component corresponds to
a different stress and contains <code>k</code>, <code>new_means</code> 
and <code>new_sd</code>.
</p>
</li></ul>

<p>See <code><a href="#topic+SWIM">SWIM</a></code> for details.
</p>


<h3>Author(s)</h3>

<p>Zhuomin Mao
</p>


<h3>References</h3>

<p>Pesenti SM, Millossovich P, Tsanakas A (2019).
&ldquo;Reverse sensitivity testing: What does it take to break the model?&rdquo;
<em>European Journal of Operational Research</em>, <b>274</b>(2), 654&ndash;670.<br />
</p>
<p>Pesenti S BAMPTA (2020).
&ldquo;Scenario Weights for Importance Measurement (SWIM) - An R package for sensitivity analysis.&rdquo;
<em>Annals of Actuarial Science 15.2 (2021): 458-483. Available at SSRN: <a href="https://www.ssrn.com/abstract=3515274">https://www.ssrn.com/abstract=3515274</a></em>.<br />
</p>
<p>Pesenti SM (2021).
&ldquo;Reverse Sensitivity Analysis for Risk Modelling.&rdquo;
<em>Available at SSRN 3878879</em>.
</p>


<h3>See Also</h3>

<p>Other stress functions: 
<code><a href="#topic+stress_HARA_RM_w">stress_HARA_RM_w</a>()</code>,
<code><a href="#topic+stress_RM_mean_sd_w">stress_RM_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_RM_w">stress_RM_w</a>()</code>,
<code><a href="#topic+stress_VaR_ES">stress_VaR_ES</a>()</code>,
<code><a href="#topic+stress_VaR">stress_VaR</a>()</code>,
<code><a href="#topic+stress_mean_sd">stress_mean_sd</a>()</code>,
<code><a href="#topic+stress_mean_w">stress_mean_w</a>()</code>,
<code><a href="#topic+stress_mean">stress_mean</a>()</code>,
<code><a href="#topic+stress_moment">stress_moment</a>()</code>,
<code><a href="#topic+stress_prob">stress_prob</a>()</code>,
<code><a href="#topic+stress_user">stress_user</a>()</code>,
<code><a href="#topic+stress_wass">stress_wass</a>()</code>,
<code><a href="#topic+stress">stress</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000),
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress_wass(type = "mean sd", x = x, k = 1,
  new_means=1, new_sd=0.9)
  summary(res1)

## calling stress_RM_w directly
## stressing "gamma"
res2 &lt;- stress_mean_sd_w(x = x, 
  new_means=2.2, new_sd=1.5, k = 2)
summary(res2)

## End(Not run)

</code></pre>

<hr>
<h2 id='stress_mean_w'>Stressing Mean</h2><span id='topic+stress_mean_w'></span>

<h3>Description</h3>

<p>Provides weights on simulated scenarios from a baseline stochastic
model, such that a stressed model component (random variable) fulfils a
constraint on its mean.
Scenario weights are
selected by constrained minimisation of the Wasserstein distance to the
baseline model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stress_mean_w(
  x,
  new_means,
  k = 1,
  h = 1,
  names = NULL,
  log = FALSE,
  method = "Nelder-Mead",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stress_mean_w_+3A_x">x</code></td>
<td>
<p>A vector, matrix or data frame
containing realisations of random variables. Columns of <code>x</code>
correspond to random variables; OR<br />
A <code>SWIMw</code> object, where <code>x</code> corresponds to the
underlying data of the <code>SWIMw</code> object. The stressed random component is assumed continuously distributed.</p>
</td></tr>
<tr><td><code id="stress_mean_w_+3A_new_means">new_means</code></td>
<td>
<p>Numeric, the stressed mean.<br /></p>
</td></tr>
<tr><td><code id="stress_mean_w_+3A_k">k</code></td>
<td>
<p>Numeric, the column of <code>x</code> that is stressed
<code>(default = 1)</code>.<br /></p>
</td></tr>
<tr><td><code id="stress_mean_w_+3A_h">h</code></td>
<td>
<p>Numeric, a multiplier of the default bandwidth using Silverman’s rule (default <code>h = 1</code>).<br /></p>
</td></tr>
<tr><td><code id="stress_mean_w_+3A_names">names</code></td>
<td>
<p>Character vector, the names of stressed models.</p>
</td></tr>
<tr><td><code id="stress_mean_w_+3A_log">log</code></td>
<td>
<p>Boolean, the option to print weights' statistics.</p>
</td></tr>
<tr><td><code id="stress_mean_w_+3A_method">method</code></td>
<td>
<p>The method to be used in [stats::optim()]. (<code>default = Nelder-Mead</code>).</p>
</td></tr>
<tr><td><code id="stress_mean_w_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to
<code><a href="nleqslv.html#topic+nleqslv">nleqslv</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>SWIMw</code> object containing:
</p>

<ul>
<li> <p><code>x</code>, a data.frame containing the data;
</p>
</li>
<li> <p><code>h</code>, h is a multiple of the Silverman’s rule;
</p>
</li>
<li> <p><code>u</code>, vector containing the gridspace on [0, 1];
</p>
</li>
<li> <p><code>lam</code>, vector containing the lambda's of the optimized model;
</p>
</li>
<li> <p><code>str_fY</code>, function defining the densities of the stressed component;
</p>
</li>
<li> <p><code>str_FY</code>, function defining the distribution of the stressed component;
</p>
</li>
<li> <p><code>str_FY_inv</code>, function defining the quantiles of the stressed component;
</p>
</li>
<li> <p><code>gamma</code>, function defining the risk measure;
</p>
</li>
<li> <p><code>new_weights</code>, a list of functions, that applied to
the <code>k</code>th column of <code>x</code>, generates the vectors of scenario
weights. Each component corresponds to a different stress;
</p>
</li>
<li> <p><code>type = "mean"</code>;
</p>
</li>
<li> <p><code>specs</code>, a list, each component corresponds to
a different stress and contains <code>k</code> and <code>new_means</code>.
</p>
</li></ul>

<p>See <code><a href="#topic+SWIM">SWIM</a></code> for details.
</p>


<h3>Author(s)</h3>

<p>Zhuomin Mao
</p>


<h3>References</h3>

<p>Pesenti SM, Millossovich P, Tsanakas A (2019).
&ldquo;Reverse sensitivity testing: What does it take to break the model?&rdquo;
<em>European Journal of Operational Research</em>, <b>274</b>(2), 654&ndash;670.<br />
</p>
<p>Pesenti S BAMPTA (2020).
&ldquo;Scenario Weights for Importance Measurement (SWIM) - An R package for sensitivity analysis.&rdquo;
<em>Annals of Actuarial Science 15.2 (2021): 458-483. Available at SSRN: <a href="https://www.ssrn.com/abstract=3515274">https://www.ssrn.com/abstract=3515274</a></em>.<br />
</p>
<p>Pesenti SM (2021).
&ldquo;Reverse Sensitivity Analysis for Risk Modelling.&rdquo;
<em>Available at SSRN 3878879</em>.
</p>


<h3>See Also</h3>

<p>Other stress functions: 
<code><a href="#topic+stress_HARA_RM_w">stress_HARA_RM_w</a>()</code>,
<code><a href="#topic+stress_RM_mean_sd_w">stress_RM_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_RM_w">stress_RM_w</a>()</code>,
<code><a href="#topic+stress_VaR_ES">stress_VaR_ES</a>()</code>,
<code><a href="#topic+stress_VaR">stress_VaR</a>()</code>,
<code><a href="#topic+stress_mean_sd_w">stress_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_mean_sd">stress_mean_sd</a>()</code>,
<code><a href="#topic+stress_mean">stress_mean</a>()</code>,
<code><a href="#topic+stress_moment">stress_moment</a>()</code>,
<code><a href="#topic+stress_prob">stress_prob</a>()</code>,
<code><a href="#topic+stress_user">stress_user</a>()</code>,
<code><a href="#topic+stress_wass">stress_wass</a>()</code>,
<code><a href="#topic+stress">stress</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000),
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress_wass(type = "mean", x = x, k = 1,
  new_means=1)
  summary(res1)

## calling stress_RM_w directly
## stressing "gamma"
res2 &lt;- stress_mean_w(x = x, 
  new_means=2.2, k = 2)
summary(res2)

## End(Not run)

</code></pre>

<hr>
<h2 id='stress_moment'>Stressing Moments</h2><span id='topic+stress_moment'></span>

<h3>Description</h3>

<p>Provides weights on simulated scenarios from a baseline stochastic
model, such that stressed model components (random variables)
fulfill the moment constraints. Scenario weights are selected by
constrained minimisation of the relative entropy to the
baseline model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stress_moment(
  x,
  f,
  k,
  m,
  normalise = TRUE,
  show = FALSE,
  names = NULL,
  log = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stress_moment_+3A_x">x</code></td>
<td>
<p>A vector, matrix or data frame
containing realisations of random variables. Columns of <code>x</code>
correspond to random variables; OR<br />
A <code>SWIM</code> object, where <code>x</code> corresponds to the
underlying data of the <code>SWIM</code> object.</p>
</td></tr>
<tr><td><code id="stress_moment_+3A_f">f</code></td>
<td>
<p>A function, or list of functions, that, applied to
<code>x</code>, constitute the moment constraints.</p>
</td></tr>
<tr><td><code id="stress_moment_+3A_k">k</code></td>
<td>
<p>A vector or list of vectors, same length as <code>f</code>,
indicating which columns of <code>x</code> each function
in <code>f</code> operates on.<br />
When <code>f</code> is a list, <code>k[[i]]</code> corresponds
to the input variables of <code>f[[i]]</code>.</p>
</td></tr>
<tr><td><code id="stress_moment_+3A_m">m</code></td>
<td>
<p>Numeric vector, same length as <code>f</code>, containing
the stressed moments of <code>f(x)</code>. Must be in the
range of <code>f(x)</code>.</p>
</td></tr>
<tr><td><code id="stress_moment_+3A_normalise">normalise</code></td>
<td>
<p>Logical. If true, values of <code>f(x)</code> are linearly
scaled to the unit interval.</p>
</td></tr>
<tr><td><code id="stress_moment_+3A_show">show</code></td>
<td>
<p>Logical. If true, print the result of the call to
<code><a href="nleqslv.html#topic+nleqslv">nleqslv</a></code>.</p>
</td></tr>
<tr><td><code id="stress_moment_+3A_names">names</code></td>
<td>
<p>Character vector, the names of stressed models.</p>
</td></tr>
<tr><td><code id="stress_moment_+3A_log">log</code></td>
<td>
<p>Boolean, the option to print weights' statistics.</p>
</td></tr>
<tr><td><code id="stress_moment_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to
<code><a href="nleqslv.html#topic+nleqslv">nleqslv</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The moment constraints are given by <code>E^Q( f(x) ) = m</code>,
where <code>E^Q</code> denotes the expectation under the stressed
model. <code>stress_moment</code> solves the subsequent set of equations
with respect to theta, using <code><a href="nleqslv.html#topic+nleqslv">nleqslv</a></code> from package
<code><a href="nleqslv.html#topic+nleqslv">nleqslv</a></code>:
</p>
<p style="text-align: center;"><code class="reqn">E^Q( f(x) ) = E( f(x) * exp(theta * f(x)) ) = m.</code>
</p>

<p>There is no guarantee that the set of equations
has a solution, or that the solution is unique. <code>SWIM</code> will
return a warning if the termination code provided by <code>nleqslv</code> is
different from 1 (convergence has been achieved). It is recommended to
check the result of the call to <code>nleqslv</code> using the &quot;show&quot; argument. The
user is referred to the <code><a href="nleqslv.html#topic+nleqslv">nleqslv</a></code> documentation for
further details.
</p>
<p>Normalising the data may help avoiding numerical issues when the range of values is wide.
</p>


<h3>Value</h3>

<p>A <code>SWIM</code> object containing:
</p>

<ul>
<li> <p><code>x</code>, a data.frame containing the data;
</p>
</li>
<li> <p><code>new_weights</code>, a list, each component corresponds to
a different stress and is a vector of scenario weights;
</p>
</li>
<li> <p><code>type = "moment"</code>;
</p>
</li>
<li> <p><code>specs</code>, a list, each component corresponds to
a different stress and contains <code>f</code>, <code>k</code> and <code>m</code>.
</p>
</li></ul>

<p>See <code><a href="#topic+SWIM">SWIM</a></code> for details.
</p>
<p>The function call will print a message containing the termination code returned by the call to <code>nleqslv</code> and a table with the required and achieved moment, and the absolute and relative error.
</p>


<h3>References</h3>

<p>Pesenti SM, Millossovich P, Tsanakas A (2019).
&ldquo;Reverse sensitivity testing: What does it take to break the model?&rdquo;
<em>European Journal of Operational Research</em>, <b>274</b>(2), 654&ndash;670.<br />
</p>
<p>Pesenti S BAMPTA (2020).
&ldquo;Scenario Weights for Importance Measurement (SWIM) - An R package for sensitivity analysis.&rdquo;
<em>Annals of Actuarial Science 15.2 (2021): 458-483. Available at SSRN: <a href="https://www.ssrn.com/abstract=3515274">https://www.ssrn.com/abstract=3515274</a></em>.<br />
</p>
<p>Csiszar I (1975).
&ldquo;I-divergence geometry of probability distributions and minimization problems.&rdquo;
<em>The Annals of Probability</em>, 146&ndash;158.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+stress_mean">stress_mean</a></code> for stressing means and
<code><a href="#topic+stress_mean_sd">stress_mean_sd</a></code> for stressing mean and standard
deviation jointly.
</p>
<p>Other stress functions: 
<code><a href="#topic+stress_HARA_RM_w">stress_HARA_RM_w</a>()</code>,
<code><a href="#topic+stress_RM_mean_sd_w">stress_RM_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_RM_w">stress_RM_w</a>()</code>,
<code><a href="#topic+stress_VaR_ES">stress_VaR_ES</a>()</code>,
<code><a href="#topic+stress_VaR">stress_VaR</a>()</code>,
<code><a href="#topic+stress_mean_sd_w">stress_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_mean_sd">stress_mean_sd</a>()</code>,
<code><a href="#topic+stress_mean_w">stress_mean_w</a>()</code>,
<code><a href="#topic+stress_mean">stress_mean</a>()</code>,
<code><a href="#topic+stress_prob">stress_prob</a>()</code>,
<code><a href="#topic+stress_user">stress_user</a>()</code>,
<code><a href="#topic+stress_wass">stress_wass</a>()</code>,
<code><a href="#topic+stress">stress</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
x &lt;- data.frame(cbind(
  "normal" = rnorm(1000),
  "gamma" = rgamma(1000, shape = 2),
  "beta" = rbeta(1000, shape1 = 2, shape2 = 2)))

## stressing covariance of columns 1, 2 while leaving the means unchanged
res1 &lt;- stress_moment(x = x,
  f = list(function(x)x, function(x)x, function(x)x[1] * x[2]),
  k = list(1, 2, c(1, 2)), m = c(0, 2, 0.5),
  method = "Newton", control = list(maxit = 1000, ftol = 1E-10))
## means under the stressed model
summary(res1)
apply(x, 2, stats::weighted.mean, w = get_weights(res1))
## covariance of columns 1,2 under the stressed model
stats::weighted.mean(x[, 1] * x[, 2], w = get_weights(res1))

## stressing jointly the tail probabilities of columns 1, 3
res2 &lt;- stress_moment(x = x,
  f = list(function(x)(x &gt; 1.5), function(x)(x &gt; 0.9)),
  k = list(1, 3), m = c(0.9, 0.9))
summary(res2)
## probabilities under the stressed model
mean((x[, 1] &gt; 1.5) * get_weights(res2))
mean((x[, 3] &gt; 0.9) * get_weights(res2))

</code></pre>

<hr>
<h2 id='stress_prob'>Stressing Intervals</h2><span id='topic+stress_prob'></span>

<h3>Description</h3>

<p>Provides weights on simulated scenarios from a baseline stochastic
model, such that a stressed model component (random variable) 
fulfils constraints on probability of disjoint intervals. Scenario 
weights are selected by constrained minimisation of the 
relative entropy to the baseline model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stress_prob(x, prob, lower = NULL, upper, k = 1, names = NULL, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stress_prob_+3A_x">x</code></td>
<td>
<p>A vector, matrix or data frame
containing realisations of random variables. Columns of <code>x</code>
correspond to random variables; OR<br />
A <code>SWIM</code> object, where <code>x</code> corresponds to the
underlying data of the <code>SWIM</code> object.</p>
</td></tr>
<tr><td><code id="stress_prob_+3A_prob">prob</code></td>
<td>
<p>Numeric vector, stressed probabilities corresponding to
the intervals defined through <code>lower</code> and 
<code>upper</code>.</p>
</td></tr>
<tr><td><code id="stress_prob_+3A_lower">lower</code></td>
<td>
<p>Numeric vector, left endpoints of the intervals.</p>
</td></tr>
<tr><td><code id="stress_prob_+3A_upper">upper</code></td>
<td>
<p>Numeric vector, right endpoints of the intervals.</p>
</td></tr>
<tr><td><code id="stress_prob_+3A_k">k</code></td>
<td>
<p>Numeric, the column of <code>x</code> that is stressed
<code>(default = 1)</code>.</p>
</td></tr>
<tr><td><code id="stress_prob_+3A_names">names</code></td>
<td>
<p>Character vector, the names of stressed models.</p>
</td></tr>
<tr><td><code id="stress_prob_+3A_log">log</code></td>
<td>
<p>Boolean, the option to print weights' statistics.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The intervals are treated as half open intervals, that is
the lower endpoint are not included, whereas the upper endpoint 
are included. If <code>upper = NULL</code>, the intervals 
are consecutive and <code>prob</code> cumulative.<br />
The intervals defined through <code>lower</code> and <code>upper</code> must
be disjoint.
</p>


<h3>Value</h3>

<p>A <code>SWIM</code> object containing:
</p>

<ul>
<li> <p><code>x</code>, a data.frame containing the data;
</p>
</li>
<li> <p><code>new_weights</code>, a list of functions, that applied to the
<code>k</code>th column of <code>x</code>, generate the vectors of scenario
weights. Each component corresponds to a different stress;
</p>
</li>
<li> <p><code>type = "prob"</code>;
</p>
</li>
<li> <p><code>specs</code>, a list, each component corresponds to 
a different stress and contains <code>k</code>, <code>lower</code>,  
<code>upper</code> and <code>prob</code>. 
</p>
</li></ul>

<p>See <code><a href="#topic+SWIM">SWIM</a></code> for details.
</p>


<h3>Author(s)</h3>

<p>Silvana M. Pesenti
</p>


<h3>References</h3>

<p>Pesenti SM, Millossovich P, Tsanakas A (2019).
&ldquo;Reverse sensitivity testing: What does it take to break the model?&rdquo;
<em>European Journal of Operational Research</em>, <b>274</b>(2), 654&ndash;670.<br />
</p>
<p>Pesenti S BAMPTA (2020).
&ldquo;Scenario Weights for Importance Measurement (SWIM) - An R package for sensitivity analysis.&rdquo;
<em>Annals of Actuarial Science 15.2 (2021): 458-483. Available at SSRN: <a href="https://www.ssrn.com/abstract=3515274">https://www.ssrn.com/abstract=3515274</a></em>.<br />
</p>
<p>Csiszar I (1975).
&ldquo;I-divergence geometry of probability distributions and minimization problems.&rdquo;
<em>The Annals of Probability</em>, 146&ndash;158.
</p>


<h3>See Also</h3>

<p>Other stress functions: 
<code><a href="#topic+stress_HARA_RM_w">stress_HARA_RM_w</a>()</code>,
<code><a href="#topic+stress_RM_mean_sd_w">stress_RM_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_RM_w">stress_RM_w</a>()</code>,
<code><a href="#topic+stress_VaR_ES">stress_VaR_ES</a>()</code>,
<code><a href="#topic+stress_VaR">stress_VaR</a>()</code>,
<code><a href="#topic+stress_mean_sd_w">stress_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_mean_sd">stress_mean_sd</a>()</code>,
<code><a href="#topic+stress_mean_w">stress_mean_w</a>()</code>,
<code><a href="#topic+stress_mean">stress_mean</a>()</code>,
<code><a href="#topic+stress_moment">stress_moment</a>()</code>,
<code><a href="#topic+stress_user">stress_user</a>()</code>,
<code><a href="#topic+stress_wass">stress_wass</a>()</code>,
<code><a href="#topic+stress">stress</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
x &lt;- rnorm(1000)
## consecutive intervals
res1 &lt;- stress(type = "prob", x = x, prob = 0.008, upper = -2.4)
# probability under the stressed model
cdf(res1, xCol = 1)(-2.4)

## calling stress_prob directly
## multiple intervals
res2 &lt;- stress_prob(x = x, prob = c(0.008, 0.06), 
  lower = c(-3, -2), upper = c(-2.4, -1.6))
# probability under the stressed model
cdf(res2, xCol = 1)(c(-2.4, -1.6)) - cdf(res2, xCol = 1)(c(-3, -2))

</code></pre>

<hr>
<h2 id='stress_RM_mean_sd_w'>Stressing Risk Measure, Mean and Standard Deviation</h2><span id='topic+stress_RM_mean_sd_w'></span>

<h3>Description</h3>

<p>Provides weights on simulated scenarios from a baseline stochastic
model, such that a stressed model component (random variable) fulfils a
constraint on its mean, standard deviation, and risk measure 
defined by a <code>gamma</code> function and 
evaluated at a given level <code>alpha</code>. Scenario weights are
selected by constrained minimisation of the Wasserstein distance to the
baseline model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stress_RM_mean_sd_w(
  x,
  alpha = 0.8,
  new_means,
  new_sd,
  q_ratio = NULL,
  q = NULL,
  k = 1,
  h = 1,
  gamma = NULL,
  names = NULL,
  log = FALSE,
  method = "Nelder-Mead",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stress_RM_mean_sd_w_+3A_x">x</code></td>
<td>
<p>A vector, matrix or data frame
containing realisations of random variables. Columns of <code>x</code>
correspond to random variables; OR<br />
A <code>SWIMw</code> object, where <code>x</code> corresponds to the
underlying data of the <code>SWIMw</code> object. The stressed random component is assumed continuously distributed.</p>
</td></tr>
<tr><td><code id="stress_RM_mean_sd_w_+3A_alpha">alpha</code></td>
<td>
<p>Numeric, vector, the level of the Expected Shortfall. (<code>default Expected Shortfall</code>)<br /></p>
</td></tr>
<tr><td><code id="stress_RM_mean_sd_w_+3A_new_means">new_means</code></td>
<td>
<p>Numeric, the stressed mean. <br /></p>
</td></tr>
<tr><td><code id="stress_RM_mean_sd_w_+3A_new_sd">new_sd</code></td>
<td>
<p>Numeric, the stressed standard deviation. <br /></p>
</td></tr>
<tr><td><code id="stress_RM_mean_sd_w_+3A_q_ratio">q_ratio</code></td>
<td>
<p>Numeric, vector, the ratio of the stressed RM to
the baseline RM (must be same length as <code>alpha</code>).<br /></p>
</td></tr>
<tr><td><code id="stress_RM_mean_sd_w_+3A_q">q</code></td>
<td>
<p>Numeric, vector, the stressed RM at level
<code>alpha</code> (must be same length as <code>alpha</code>).<br /></p>
</td></tr>
<tr><td><code id="stress_RM_mean_sd_w_+3A_k">k</code></td>
<td>
<p>Numeric, the column of <code>x</code> that is stressed
<code>(default = 1)</code>.</p>
</td></tr>
<tr><td><code id="stress_RM_mean_sd_w_+3A_h">h</code></td>
<td>
<p>Numeric, a multiplier of the default bandwidth using Silverman’s rule (default <code>h = 1</code>).<br /></p>
</td></tr>
<tr><td><code id="stress_RM_mean_sd_w_+3A_gamma">gamma</code></td>
<td>
<p>Function of one variable, that defined the gamma of the risk measure. (<code>default Expected Shortfall</code>).<br /></p>
</td></tr>
<tr><td><code id="stress_RM_mean_sd_w_+3A_names">names</code></td>
<td>
<p>Character vector, the names of stressed models.</p>
</td></tr>
<tr><td><code id="stress_RM_mean_sd_w_+3A_log">log</code></td>
<td>
<p>Boolean, the option to print weights' statistics.</p>
</td></tr>
<tr><td><code id="stress_RM_mean_sd_w_+3A_method">method</code></td>
<td>
<p>The method to be used in [stats::optim()]. (<code>default = Nelder-Mead</code>).</p>
</td></tr>
<tr><td><code id="stress_RM_mean_sd_w_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to
<code><a href="nleqslv.html#topic+nleqslv">nleqslv</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements stresses on distortion risk measures.
Distortion risk measures are defined by a square-integrable function
<code>gamma</code> where
</p>
<p style="text-align: center;"><code class="reqn">\int_0^1 gamma(u) du = 1.</code>
</p>

<p>The distortion risk measure for some <code>gamma</code> and distribution 
<code>G</code> is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">\rho_{gamma}(G) = \int_0^1 \breve(G)(u) gamma(u) du.</code>
</p>

<p>Expected Shortfall (ES) is an example of a distortion risk measure.
The ES at level <code>alpha</code> of a random variable with distribution
function F is defined by:
</p>
<p style="text-align: center;"><code class="reqn">ES_{alpha} = 1 / (1 - alpha) * \int_{alpha}^1 VaR_u d u.</code>
</p>



<h3>Value</h3>

<p>A <code>SWIMw</code> object containing:
</p>

<ul>
<li> <p><code>x</code>, a data.frame containing the data;
</p>
</li>
<li> <p><code>h</code>, h is a multiple of the Silverman’s rule;
</p>
</li>
<li> <p><code>u</code>, vector containing the gridspace on [0, 1];
</p>
</li>
<li> <p><code>lam</code>, vector containing the lambda's of the optimized model;
</p>
</li>
<li> <p><code>str_fY</code>, function defining the densities of the stressed component;
</p>
</li>
<li> <p><code>str_FY</code>, function defining the distribution of the stressed component;
</p>
</li>
<li> <p><code>str_FY_inv</code>, function defining the quantiles of the stressed component;
</p>
</li>
<li> <p><code>gamma</code>, function defining the risk measure;
</p>
</li>
<li> <p><code>new_weights</code>, a list of functions, that applied to
the <code>k</code>th column of <code>x</code>, generates the vectors of scenario
weights. Each component corresponds to a different stress;
</p>
</li>
<li> <p><code>type = "RM mean sd"</code>;
</p>
</li>
<li> <p><code>specs</code>, a list, each component corresponds to
a different stress and contains <code>k</code>, <code>alpha</code>,
<code>q</code>, <code>new_means</code>, and <code>new_sd</code>.
</p>
</li></ul>

<p>See <code><a href="#topic+SWIM">SWIM</a></code> for details.
</p>


<h3>Author(s)</h3>

<p>Zhuomin Mao
</p>


<h3>References</h3>

<p>Pesenti SM, Millossovich P, Tsanakas A (2019).
&ldquo;Reverse sensitivity testing: What does it take to break the model?&rdquo;
<em>European Journal of Operational Research</em>, <b>274</b>(2), 654&ndash;670.<br />
</p>
<p>Pesenti S BAMPTA (2020).
&ldquo;Scenario Weights for Importance Measurement (SWIM) - An R package for sensitivity analysis.&rdquo;
<em>Annals of Actuarial Science 15.2 (2021): 458-483. Available at SSRN: <a href="https://www.ssrn.com/abstract=3515274">https://www.ssrn.com/abstract=3515274</a></em>.<br />
</p>
<p>Pesenti SM (2021).
&ldquo;Reverse Sensitivity Analysis for Risk Modelling.&rdquo;
<em>Available at SSRN 3878879</em>.
</p>


<h3>See Also</h3>

<p>Other stress functions: 
<code><a href="#topic+stress_HARA_RM_w">stress_HARA_RM_w</a>()</code>,
<code><a href="#topic+stress_RM_w">stress_RM_w</a>()</code>,
<code><a href="#topic+stress_VaR_ES">stress_VaR_ES</a>()</code>,
<code><a href="#topic+stress_VaR">stress_VaR</a>()</code>,
<code><a href="#topic+stress_mean_sd_w">stress_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_mean_sd">stress_mean_sd</a>()</code>,
<code><a href="#topic+stress_mean_w">stress_mean_w</a>()</code>,
<code><a href="#topic+stress_mean">stress_mean</a>()</code>,
<code><a href="#topic+stress_moment">stress_moment</a>()</code>,
<code><a href="#topic+stress_prob">stress_prob</a>()</code>,
<code><a href="#topic+stress_user">stress_user</a>()</code>,
<code><a href="#topic+stress_wass">stress_wass</a>()</code>,
<code><a href="#topic+stress">stress</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000),
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress_wass(type = "RM mean sd", x = x,
  alpha = 0.9, q_ratio = 1.05, new_means=1, new_sd=0.9)
  summary(res1)

## calling stress_RM_w directly
## stressing "gamma"
res2 &lt;- stress_RM_mean_sd_w(x = x, alpha = 0.9,
  q_ratio = 1.05, new_means=2.2, new_sd=1.5, k = 2)
summary(res2)

## End(Not run)

</code></pre>

<hr>
<h2 id='stress_RM_w'>Stressing Risk Measure</h2><span id='topic+stress_RM_w'></span>

<h3>Description</h3>

<p>Provides weights on simulated scenarios from a baseline 
stochastic model, such that a stressed model component 
(random variable) fulfils a constraint on its risk measure defined
by a gamma function. The default risk measure is the Expected 
Shortfall at level alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stress_RM_w(
  x,
  alpha = 0.8,
  q_ratio = NULL,
  q = NULL,
  k = 1,
  h = 1,
  gamma = NULL,
  names = NULL,
  log = FALSE,
  method = "Nelder-Mead"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stress_RM_w_+3A_x">x</code></td>
<td>
<p>A vector, matrix or data frame
containing realisations of random variables. Columns of <code>x</code>
correspond to random variables; OR<br />
A <code>SWIMw</code> object, where <code>x</code> corresponds to the
underlying data of the <code>SWIMw</code> object. The stressed random component is assumed continuously distributed.</p>
</td></tr>
<tr><td><code id="stress_RM_w_+3A_alpha">alpha</code></td>
<td>
<p>Numeric, vector, the level of the Expected Shortfall. (<code>default Expected Shortfall</code>)<br /></p>
</td></tr>
<tr><td><code id="stress_RM_w_+3A_q_ratio">q_ratio</code></td>
<td>
<p>Numeric, vector, the ratio of the stressed RM to
the baseline RM (must be of the same length as alpha or gamma).<br /></p>
</td></tr>
<tr><td><code id="stress_RM_w_+3A_q">q</code></td>
<td>
<p>Numeric, vector, the stressed RM at level
<code>alpha</code> (must be of the same length as alpha or gamma).<br /></p>
</td></tr>
<tr><td><code id="stress_RM_w_+3A_k">k</code></td>
<td>
<p>Numeric, the column of <code>x</code> that is stressed
<code>(default = 1)</code>.<br /></p>
</td></tr>
<tr><td><code id="stress_RM_w_+3A_h">h</code></td>
<td>
<p>Numeric, a multiplier of the default bandwidth using Silverman’s rule (default <code>h = 1</code>).<br /></p>
</td></tr>
<tr><td><code id="stress_RM_w_+3A_gamma">gamma</code></td>
<td>
<p>Function of one variable, that defined the gamma of the risk measure. (<code>default Expected Shortfall</code>).<br /></p>
</td></tr>
<tr><td><code id="stress_RM_w_+3A_names">names</code></td>
<td>
<p>Character vector, the names of stressed models.<br /></p>
</td></tr>
<tr><td><code id="stress_RM_w_+3A_log">log</code></td>
<td>
<p>Boolean, the option to print weights' statistics.<br /></p>
</td></tr>
<tr><td><code id="stress_RM_w_+3A_method">method</code></td>
<td>
<p>The method to be used in [stats::optim()]. (<code>default = Nelder-Mead</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements stresses on distortion risk measures.
Distortion risk measures are defined by a square-integrable function
<code>gamma</code> where
</p>
<p style="text-align: center;"><code class="reqn">\int_0^1 gamma(u) du = 1.</code>
</p>

<p>The distortion risk measure for some <code>gamma</code> and distribution 
<code>G</code> is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">\rho_{gamma}(G) = \int_0^1 \breve(G)(u) gamma(u) du.</code>
</p>

<p>Expected Shortfall (ES) is an example of a distortion risk measure.
The ES at level <code>alpha</code> of a random variable with distribution
function F is defined by:
</p>
<p style="text-align: center;"><code class="reqn">ES_{alpha} = 1 / (1 - alpha) * \int_{alpha}^1 VaR_u d u.</code>
</p>



<h3>Value</h3>

<p>A <code>SWIMw</code> object containing:
</p>

<ul>
<li> <p><code>x</code>, a data.frame containing the data;
</p>
</li>
<li> <p><code>h</code>, h is a multiple of the Silverman’s rule;
</p>
</li>
<li> <p><code>u</code>, vector containing the gridspace on [0, 1];
</p>
</li>
<li> <p><code>lam</code>, vector containing the lambda's of the optimized model;
</p>
</li>
<li> <p><code>str_fY</code>, function defining the densities of the stressed component;
</p>
</li>
<li> <p><code>str_FY</code>, function defining the distribution of the stressed component;
</p>
</li>
<li> <p><code>str_FY_inv</code>, function defining the quantiles of the stressed component;
</p>
</li>
<li> <p><code>gamma</code>, function defining the risk measure;
</p>
</li>
<li> <p><code>new_weights</code>, a list of functions, that applied to
the <code>k</code>th column of <code>x</code>, generates the vectors of scenario
weights. Each component corresponds to a different stress;
</p>
</li>
<li> <p><code>type = "RM"</code>;
</p>
</li>
<li> <p><code>specs</code>, a list, each component corresponds to
a different stress and contains <code>k</code>, <code>alpha</code>, and
<code>q</code>.
</p>
</li></ul>

<p>See <code><a href="#topic+SWIM">SWIM</a></code> for details.
</p>


<h3>Author(s)</h3>

<p>Zhuomin Mao
</p>


<h3>References</h3>

<p>Pesenti SM, Millossovich P, Tsanakas A (2019).
&ldquo;Reverse sensitivity testing: What does it take to break the model?&rdquo;
<em>European Journal of Operational Research</em>, <b>274</b>(2), 654&ndash;670.<br />
</p>
<p>Pesenti S BAMPTA (2020).
&ldquo;Scenario Weights for Importance Measurement (SWIM) - An R package for sensitivity analysis.&rdquo;
<em>Annals of Actuarial Science 15.2 (2021): 458-483. Available at SSRN: <a href="https://www.ssrn.com/abstract=3515274">https://www.ssrn.com/abstract=3515274</a></em>.<br />
</p>
<p>Pesenti SM (2021).
&ldquo;Reverse Sensitivity Analysis for Risk Modelling.&rdquo;
<em>Available at SSRN 3878879</em>.
</p>


<h3>See Also</h3>

<p>Other stress functions: 
<code><a href="#topic+stress_HARA_RM_w">stress_HARA_RM_w</a>()</code>,
<code><a href="#topic+stress_RM_mean_sd_w">stress_RM_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_VaR_ES">stress_VaR_ES</a>()</code>,
<code><a href="#topic+stress_VaR">stress_VaR</a>()</code>,
<code><a href="#topic+stress_mean_sd_w">stress_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_mean_sd">stress_mean_sd</a>()</code>,
<code><a href="#topic+stress_mean_w">stress_mean_w</a>()</code>,
<code><a href="#topic+stress_mean">stress_mean</a>()</code>,
<code><a href="#topic+stress_moment">stress_moment</a>()</code>,
<code><a href="#topic+stress_prob">stress_prob</a>()</code>,
<code><a href="#topic+stress_user">stress_user</a>()</code>,
<code><a href="#topic+stress_wass">stress_wass</a>()</code>,
<code><a href="#topic+stress">stress</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000),
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress_wass(type = "RM", x = x,
  alpha = 0.9, q_ratio = 1.05)
  summary(res1)

## calling stress_RM_w directly
## stressing "gamma"
res2 &lt;- stress_RM_w(x = x, alpha = 0.9,
  q_ratio = 1.05, k = 2)
summary(res2)

# dual power distortion with beta = 3
# gamma = beta * u^{beta - 1}, beta &gt; 0 

gamma &lt;- function(u){
  .res &lt;- 3 * u^2
  return(.res)
}
res3 &lt;- stress_wass(type = "RM", x = x, 
  gamma = gamma, q_ratio = 1.05)
summary(res3)

## End(Not run)
 
</code></pre>

<hr>
<h2 id='stress_user'>User Defined Stress</h2><span id='topic+stress_user'></span>

<h3>Description</h3>

<p>Returns a <code>SWIM</code> object with scenario weights defined by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stress_user(
  x,
  new_weights = NULL,
  new_weightsfun = NULL,
  k = 1,
  names = NULL,
  log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stress_user_+3A_x">x</code></td>
<td>
<p>A vector, matrix or data frame
containing realisations of random variables. Columns of <code>x</code>
correspond to random variables; OR<br />
A <code>SWIM</code> object, where <code>x</code> corresponds to the
underlying data of the <code>SWIM</code> object.</p>
</td></tr>
<tr><td><code id="stress_user_+3A_new_weights">new_weights</code></td>
<td>
<p>A vector, matrix or data frame containing scenario
weights. Columns of <code>new_weights</code> correspond to different
stresses. <br />
<code>new_weights</code> are normalised to have a mean of 1.</p>
</td></tr>
<tr><td><code id="stress_user_+3A_new_weightsfun">new_weightsfun</code></td>
<td>
<p>A list of functions, that applied to
the <code>k</code>th column of <code>x</code> generate the vectors of
the scenario weights. Each function corresponds to a stress. <br />
The weights generated for each stress are normalised to
have a mean of 1.</p>
</td></tr>
<tr><td><code id="stress_user_+3A_k">k</code></td>
<td>
<p>Numeric, the column of <code>x</code> that is stressed
<code>(default = 1)</code>.</p>
</td></tr>
<tr><td><code id="stress_user_+3A_names">names</code></td>
<td>
<p>Character vector, the names of stressed models.</p>
</td></tr>
<tr><td><code id="stress_user_+3A_log">log</code></td>
<td>
<p>Boolean, the option to print weights' statistics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>SWIM</code> object containing:
</p>

<ul>
<li> <p><code>x</code>, a data.frame containing the data;
</p>
</li>
<li> <p><code>new_weights</code>, a list, each component corresponds to
a different stress and is either a vector of scenario weights (if <code>new_weights</code> is provided) or (if <code>new_weightsfun</code> is provided) a
function, that applied to the <code>k</code>th column of <code>x</code>, generates the
vectors of scenario weights;
</p>
</li>
<li> <p><code>type = "user"</code>;
</p>
</li>
<li> <p><code>specs</code>, a list, each component corresponds to
a different stress and contains <code>k</code>.
</p>
</li></ul>

<p>See <code><a href="#topic+SWIM">SWIM</a></code> for details.
</p>


<h3>References</h3>

<p>Pesenti SM, Millossovich P, Tsanakas A (2019).
&ldquo;Reverse sensitivity testing: What does it take to break the model?&rdquo;
<em>European Journal of Operational Research</em>, <b>274</b>(2), 654&ndash;670.<br />
</p>
<p>Pesenti S BAMPTA (2020).
&ldquo;Scenario Weights for Importance Measurement (SWIM) - An R package for sensitivity analysis.&rdquo;
<em>Annals of Actuarial Science 15.2 (2021): 458-483. Available at SSRN: <a href="https://www.ssrn.com/abstract=3515274">https://www.ssrn.com/abstract=3515274</a></em>.<br />
</p>
<p>Csiszar I (1975).
&ldquo;I-divergence geometry of probability distributions and minimization problems.&rdquo;
<em>The Annals of Probability</em>, 146&ndash;158.
</p>


<h3>See Also</h3>

<p>Other stress functions: 
<code><a href="#topic+stress_HARA_RM_w">stress_HARA_RM_w</a>()</code>,
<code><a href="#topic+stress_RM_mean_sd_w">stress_RM_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_RM_w">stress_RM_w</a>()</code>,
<code><a href="#topic+stress_VaR_ES">stress_VaR_ES</a>()</code>,
<code><a href="#topic+stress_VaR">stress_VaR</a>()</code>,
<code><a href="#topic+stress_mean_sd_w">stress_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_mean_sd">stress_mean_sd</a>()</code>,
<code><a href="#topic+stress_mean_w">stress_mean_w</a>()</code>,
<code><a href="#topic+stress_mean">stress_mean</a>()</code>,
<code><a href="#topic+stress_moment">stress_moment</a>()</code>,
<code><a href="#topic+stress_prob">stress_prob</a>()</code>,
<code><a href="#topic+stress_wass">stress_wass</a>()</code>,
<code><a href="#topic+stress">stress</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000),
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress(type = "user", x = x, new_weightsfun = function(x)x ^ 2, k = 1)
## plot user defined weights against the first column of x.
plot(x$normal, get_weights(res1), pch = ".")

</code></pre>

<hr>
<h2 id='stress_VaR'>Stressing Value-at-Risk</h2><span id='topic+stress_VaR'></span>

<h3>Description</h3>

<p>Provides weights on simulated scenarios from a baseline stochastic
model, such that a stressed model component (random variable) fulfils a
constraint on its quantile at a given level, also known as
Value-at-Risk (VaR). Scenario weights are selected by
constrained minimisation of the relative entropy to the
baseline model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stress_VaR(
  x,
  alpha,
  q_ratio = NULL,
  q = NULL,
  k = 1,
  names = NULL,
  log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stress_VaR_+3A_x">x</code></td>
<td>
<p>A vector, matrix or data frame
containing realisations of random variables. Columns of <code>x</code>
correspond to random variables; OR<br />
A <code>SWIM</code> object, where <code>x</code> corresponds to the
underlying data of the <code>SWIM</code> object.</p>
</td></tr>
<tr><td><code id="stress_VaR_+3A_alpha">alpha</code></td>
<td>
<p>Numeric vector, the levels of the stressed VaR.</p>
</td></tr>
<tr><td><code id="stress_VaR_+3A_q_ratio">q_ratio</code></td>
<td>
<p>Numeric vector, the ratio of the stressed VaR to the
baseline VaR.<br />
If <code>alpha</code> and <code>q_ratio</code> are vectors, they
must have the same length.</p>
</td></tr>
<tr><td><code id="stress_VaR_+3A_q">q</code></td>
<td>
<p>Numeric vector, the stressed VaR at level
<code>alpha</code>.<br />
If <code>alpha</code> and <code>q</code> are vectors, they must
have the same length.</p>
</td></tr>
<tr><td><code id="stress_VaR_+3A_k">k</code></td>
<td>
<p>Numeric, the column of <code>x</code> that is stressed
<code>(default = 1)</code>.</p>
</td></tr>
<tr><td><code id="stress_VaR_+3A_names">names</code></td>
<td>
<p>Character vector, the names of stressed models.</p>
</td></tr>
<tr><td><code id="stress_VaR_+3A_log">log</code></td>
<td>
<p>Boolean, the option to print weights' statistics.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The stressed VaR is the quantile of the chosen model component,
subject to the calculated scenario weights.
The VaR at level <code>alpha</code> of a random variable with
distribution
function F is defined as its left-quantile at alpha:
</p>
<p style="text-align: center;"><code class="reqn">VaR_{alpha} = F^{-1}(alpha).</code>
</p>

<p>If one of <code>alpha, q</code> (<code>q_ratio</code>) is a vector,
the stressed VaR's of the <code>k</code>th column of <code>x</code>, at levels
<code>alpha</code>, are equal to <code>q</code>.
</p>
<p>The stressed VaR specified, either via <code>q</code> or <code>q_ratio</code>, might not equal
the attained empirical VaR of the model component. In this
case, <code>stress_VaR</code> will display a <code>message</code> and the <code>specs</code> contain
the achieved VaR.
</p>


<h3>Value</h3>

<p>A <code>SWIM</code> object containing:
</p>

<ul>
<li> <p><code>x</code>, a data.frame containing the data;
</p>
</li>
<li> <p><code>new_weights</code>, a list of functions, that applied to
the <code>k</code>th column of <code>x</code>, generates the vectors of scenario
weights. Each component corresponds to a different stress;
</p>
</li>
<li> <p><code>type = "VaR"</code>;
</p>
</li>
<li> <p><code>specs</code>, a list, each component corresponds to
a different stress and contains <code>k</code>,
<code>alpha</code> and <code>q</code>.
</p>
</li></ul>

<p>See <code><a href="#topic+SWIM">SWIM</a></code> for details.
</p>


<h3>Author(s)</h3>

<p>Silvana M. Pesenti
</p>


<h3>References</h3>

<p>Pesenti SM, Millossovich P, Tsanakas A (2019).
&ldquo;Reverse sensitivity testing: What does it take to break the model?&rdquo;
<em>European Journal of Operational Research</em>, <b>274</b>(2), 654&ndash;670.<br />
</p>
<p>Pesenti S BAMPTA (2020).
&ldquo;Scenario Weights for Importance Measurement (SWIM) - An R package for sensitivity analysis.&rdquo;
<em>Annals of Actuarial Science 15.2 (2021): 458-483. Available at SSRN: <a href="https://www.ssrn.com/abstract=3515274">https://www.ssrn.com/abstract=3515274</a></em>.<br />
</p>
<p>Csiszar I (1975).
&ldquo;I-divergence geometry of probability distributions and minimization problems.&rdquo;
<em>The Annals of Probability</em>, 146&ndash;158.
</p>


<h3>See Also</h3>

<p>Other stress functions: 
<code><a href="#topic+stress_HARA_RM_w">stress_HARA_RM_w</a>()</code>,
<code><a href="#topic+stress_RM_mean_sd_w">stress_RM_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_RM_w">stress_RM_w</a>()</code>,
<code><a href="#topic+stress_VaR_ES">stress_VaR_ES</a>()</code>,
<code><a href="#topic+stress_mean_sd_w">stress_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_mean_sd">stress_mean_sd</a>()</code>,
<code><a href="#topic+stress_mean_w">stress_mean_w</a>()</code>,
<code><a href="#topic+stress_mean">stress_mean</a>()</code>,
<code><a href="#topic+stress_moment">stress_moment</a>()</code>,
<code><a href="#topic+stress_prob">stress_prob</a>()</code>,
<code><a href="#topic+stress_user">stress_user</a>()</code>,
<code><a href="#topic+stress_wass">stress_wass</a>()</code>,
<code><a href="#topic+stress">stress</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000),
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress(type = "VaR", x = x,
  alpha = 0.9, q_ratio = 1.05)

## calling stress_VaR directly
## stressing "gamma"
res2 &lt;- stress_VaR(x = x, alpha = 0.9,
  q_ratio = c(1.03, 1.05), k = 2)
get_specs(res2)
summary(res2)

</code></pre>

<hr>
<h2 id='stress_VaR_ES'>Stressing Value-at-Risk and Expected Shortfall</h2><span id='topic+stress_VaR_ES'></span>

<h3>Description</h3>

<p>Provides weights on simulated scenarios from a baseline stochastic
model, such that a stressed model component (random variable) fulfils a
constraint on its Value-at-Risk (VaR) and Expected Shortfall (ES) risk
measures, both evaluated at a given level. Scenario weights are
selected by constrained minimisation of the relative entropy to the
baseline model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stress_VaR_ES(
  x,
  alpha,
  q_ratio = NULL,
  s_ratio = NULL,
  q = NULL,
  s = NULL,
  k = 1,
  normalise = FALSE,
  names = NULL,
  log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stress_VaR_ES_+3A_x">x</code></td>
<td>
<p>A vector, matrix or data frame
containing realisations of random variables. Columns of <code>x</code>
correspond to random variables; OR<br />
A <code>SWIM</code> object, where <code>x</code> corresponds to the
underlying data of the <code>SWIM</code> object.</p>
</td></tr>
<tr><td><code id="stress_VaR_ES_+3A_alpha">alpha</code></td>
<td>
<p>Numeric vector, the levels of the stressed VaR.</p>
</td></tr>
<tr><td><code id="stress_VaR_ES_+3A_q_ratio">q_ratio</code></td>
<td>
<p>Numeric vector, the ratio of the stressed VaR to the
baseline VaR.<br />
If <code>alpha</code> and <code>q_ratio</code> are vectors, they
must have the same length.</p>
</td></tr>
<tr><td><code id="stress_VaR_ES_+3A_s_ratio">s_ratio</code></td>
<td>
<p>Numeric, vector, the ratio of the stressed ES to
the baseline ES.<br />
If <code>q</code> (<code>q_ratio</code>) and <code>s_ratio</code> are vectors,
they must have the same length.</p>
</td></tr>
<tr><td><code id="stress_VaR_ES_+3A_q">q</code></td>
<td>
<p>Numeric vector, the stressed VaR at level
<code>alpha</code>.<br />
If <code>alpha</code> and <code>q</code> are vectors, they must
have the same length.</p>
</td></tr>
<tr><td><code id="stress_VaR_ES_+3A_s">s</code></td>
<td>
<p>Numeric, vector, the stressed ES at level
<code>alpha</code>.<br />
If <code>q</code> and <code>s</code> are vectors, they must have
the same length.</p>
</td></tr>
<tr><td><code id="stress_VaR_ES_+3A_k">k</code></td>
<td>
<p>Numeric, the column of <code>x</code> that is stressed
<code>(default = 1)</code>.</p>
</td></tr>
<tr><td><code id="stress_VaR_ES_+3A_normalise">normalise</code></td>
<td>
<p>Logical. If true, values of the columns to be stressed are linearly
normalised to the unit interval.</p>
</td></tr>
<tr><td><code id="stress_VaR_ES_+3A_names">names</code></td>
<td>
<p>Character vector, the names of stressed models.</p>
</td></tr>
<tr><td><code id="stress_VaR_ES_+3A_log">log</code></td>
<td>
<p>Boolean, the option to print weights' statistics.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The VaR at level <code>alpha</code> of a random variable with
distribution function F is defined as its left-quantile at <code>alpha</code>:
</p>
<p style="text-align: center;"><code class="reqn">VaR_{alpha} = F^{-1}(alpha).</code>
</p>

<p>The ES at level <code>alpha</code> of a random variable with distribution
function F is defined by:
</p>
<p style="text-align: center;"><code class="reqn">ES_{alpha} = 1 / (1 - alpha) * \int_{alpha}^1 VaR_u d u.</code>
</p>

<p>The stressed VaR and ES are the risk measures of the chosen model
component, subject to the calculated scenario weights. If one
of <code>alpha, q, s</code> (<code>q_ratio, s_ratio</code>) is
a vector, the stressed VaR's and ES's of the <code>k</code>th column of
<code>x</code>, at levels <code>alpha</code>, are equal to <code>q</code>
and <code>s</code>, respectively.
</p>
<p>The stressed VaR specified, either via <code>q</code> or <code>q_ratio</code>, might not equal
the attained empirical VaR of the model component. In this
case, <code>stress_VaR</code> will display a <code>message</code> and the <code>specs</code> contain
the achieved VaR. Further, ES is then calculated on the bases of the achieved VaR.
</p>
<p>Normalising the data may help avoiding numerical issues when the range of values is wide.
</p>


<h3>Value</h3>

<p>A <code>SWIM</code> object containing:
</p>

<ul>
<li> <p><code>x</code>, a data.frame containing the data;
</p>
</li>
<li> <p><code>new_weights</code>, a list of functions, that applied to
the <code>k</code>th column of <code>x</code>, generates the vectors of scenario
weights. Each component corresponds to a different stress;
</p>
</li>
<li> <p><code>type = "VaR ES"</code>;
</p>
</li>
<li> <p><code>specs</code>, a list, each component corresponds to
a different stress and contains <code>k</code>, <code>alpha</code>,
<code>q</code> and <code>s</code>.
</p>
</li></ul>

<p>See <code><a href="#topic+SWIM">SWIM</a></code> for details.
</p>


<h3>References</h3>

<p>Pesenti SM, Millossovich P, Tsanakas A (2019).
&ldquo;Reverse sensitivity testing: What does it take to break the model?&rdquo;
<em>European Journal of Operational Research</em>, <b>274</b>(2), 654&ndash;670.<br />
</p>
<p>Pesenti S BAMPTA (2020).
&ldquo;Scenario Weights for Importance Measurement (SWIM) - An R package for sensitivity analysis.&rdquo;
<em>Annals of Actuarial Science 15.2 (2021): 458-483. Available at SSRN: <a href="https://www.ssrn.com/abstract=3515274">https://www.ssrn.com/abstract=3515274</a></em>.<br />
</p>
<p>Csiszar I (1975).
&ldquo;I-divergence geometry of probability distributions and minimization problems.&rdquo;
<em>The Annals of Probability</em>, 146&ndash;158.
</p>


<h3>See Also</h3>

<p>Other stress functions: 
<code><a href="#topic+stress_HARA_RM_w">stress_HARA_RM_w</a>()</code>,
<code><a href="#topic+stress_RM_mean_sd_w">stress_RM_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_RM_w">stress_RM_w</a>()</code>,
<code><a href="#topic+stress_VaR">stress_VaR</a>()</code>,
<code><a href="#topic+stress_mean_sd_w">stress_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_mean_sd">stress_mean_sd</a>()</code>,
<code><a href="#topic+stress_mean_w">stress_mean_w</a>()</code>,
<code><a href="#topic+stress_mean">stress_mean</a>()</code>,
<code><a href="#topic+stress_moment">stress_moment</a>()</code>,
<code><a href="#topic+stress_prob">stress_prob</a>()</code>,
<code><a href="#topic+stress_user">stress_user</a>()</code>,
<code><a href="#topic+stress_wass">stress_wass</a>()</code>,
<code><a href="#topic+stress">stress</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000),
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress(type = "VaR ES", x = x,
  alpha = c(0.9, 0.95), q_ratio = 1.05, s_ratio = 1.08)

## calling stress_VaR_ES directly
## stressing "gamma"
res2 &lt;- stress_VaR_ES(x = x, alpha = 0.9,
  q_ratio = 1.03, s_ratio = c(1.05, 1.08), k = 2)
get_specs(res2)
summary(res2)

</code></pre>

<hr>
<h2 id='stress_wass'>Stressing Random Variables Using Wasserstein Distance</h2><span id='topic+stress_wass'></span>

<h3>Description</h3>

<p>Provides weights on simulated scenarios from a baseline stochastic
model, such that stressed random variables fulfill given 
probabilistic constraints (e.g. specified values for risk 
measures), under the new scenario weights. Scenario weights are 
selected by constrained minimisation of the Wasserstein Distance to the
baseline model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stress_wass(type = c("RM", "mean sd", "RM mean sd", "HARA RM"), x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stress_wass_+3A_type">type</code></td>
<td>
<p>Type of stress, one of <code>"RM", 
"mean sd", "RM mean sd", "HARA RM"</code>.</p>
</td></tr>
<tr><td><code id="stress_wass_+3A_x">x</code></td>
<td>
<p>A vector, matrix or data frame
containing realisations of random variables. Columns of <code>x</code>
correspond to random variables; OR<br />
A <code>SWIMw</code> object, where <code>x</code> corresponds to the
underlying data of the <code>SWIMw</code> object.</p>
</td></tr>
<tr><td><code id="stress_wass_+3A_...">...</code></td>
<td>
<p>Arguments to be passed on, depending on <code>type</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>SWIMw</code>, see <code><a href="#topic+SWIM">SWIM</a></code> 
for details.
</p>


<h3>Author(s)</h3>

<p>Zhuomin Mao
</p>


<h3>References</h3>

<p>Pesenti SM, Millossovich P, Tsanakas A (2019).
&ldquo;Reverse sensitivity testing: What does it take to break the model?&rdquo;
<em>European Journal of Operational Research</em>, <b>274</b>(2), 654&ndash;670.<br />
</p>
<p>Pesenti S BAMPTA (2020).
&ldquo;Scenario Weights for Importance Measurement (SWIM) - An R package for sensitivity analysis.&rdquo;
<em>Annals of Actuarial Science 15.2 (2021): 458-483. Available at SSRN: <a href="https://www.ssrn.com/abstract=3515274">https://www.ssrn.com/abstract=3515274</a></em>.<br />
</p>
<p>Csiszar I (1975).
&ldquo;I-divergence geometry of probability distributions and minimization problems.&rdquo;
<em>The Annals of Probability</em>, 146&ndash;158.
</p>


<h3>See Also</h3>

<p>Other stress functions: 
<code><a href="#topic+stress_HARA_RM_w">stress_HARA_RM_w</a>()</code>,
<code><a href="#topic+stress_RM_mean_sd_w">stress_RM_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_RM_w">stress_RM_w</a>()</code>,
<code><a href="#topic+stress_VaR_ES">stress_VaR_ES</a>()</code>,
<code><a href="#topic+stress_VaR">stress_VaR</a>()</code>,
<code><a href="#topic+stress_mean_sd_w">stress_mean_sd_w</a>()</code>,
<code><a href="#topic+stress_mean_sd">stress_mean_sd</a>()</code>,
<code><a href="#topic+stress_mean_w">stress_mean_w</a>()</code>,
<code><a href="#topic+stress_mean">stress_mean</a>()</code>,
<code><a href="#topic+stress_moment">stress_moment</a>()</code>,
<code><a href="#topic+stress_prob">stress_prob</a>()</code>,
<code><a href="#topic+stress_user">stress_user</a>()</code>,
<code><a href="#topic+stress">stress</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000), 
  "gamma" = rgamma(1000, shape = 2)))
res &lt;- stress_wass(type = "RM", x = x, 
  alpha = 0.9, q_ratio = 1.05)
summary(res)   

## End(Not run)

</code></pre>

<hr>
<h2 id='summary.SWIM'>Summarising Stressed Models</h2><span id='topic+summary.SWIM'></span><span id='topic+summary.SWIMw'></span>

<h3>Description</h3>

<p>This function is a <code><a href="utils.html#topic+methods">methods</a></code> for an object of class 
<code>SWIM</code> or <code>SWIMw</code>. Provides summary statistics of the stochastic model, 
stressed using the scenario weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SWIM'
summary(object, ..., xCol = "all", wCol = "all", base = FALSE)

## S3 method for class 'SWIMw'
summary(object, ..., xCol = "all", wCol = "all", base = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.SWIM_+3A_object">object</code></td>
<td>
<p>A <code>SWIM</code> or <code>SWIMw</code> object.</p>
</td></tr>
<tr><td><code id="summary.SWIM_+3A_...">...</code></td>
<td>
<p>Additional arguments will be ignored.</p>
</td></tr>
<tr><td><code id="summary.SWIM_+3A_xcol">xCol</code></td>
<td>
<p>Numeric or character vector, (names of) the columns of 
the underlying data 
of the <code>object</code> (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="summary.SWIM_+3A_wcol">wCol</code></td>
<td>
<p>Vector, the columns of the scenario weights 
of the <code>object</code> corresponding to different 
stresses (<code>default = "all"</code>).</p>
</td></tr>
<tr><td><code id="summary.SWIM_+3A_base">base</code></td>
<td>
<p>Logical, if <code>TRUE</code>, statistics under the baseline 
are also returned (<code>default = "FALSE"</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.SWIM</code> returns a list with components
corresponding to different stresses. Components contain a
summary statistic of each column of the data of the 
<code>SWIM</code> object:
</p>

<table>
<tr>
 <td style="text-align: left;">
      <code>mean</code>        </td><td style="text-align: left;"> The sample mean.</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>sd</code>          </td><td style="text-align: left;"> The sample standard deviation. </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>skewness</code>    </td><td style="text-align: left;"> The sample skewness.</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>ex kurtosis</code> </td><td style="text-align: left;"> The sample excess kurtosis</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>1st Qu.</code>     </td><td style="text-align: left;"> The 25% quantile.</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>Median</code>      </td><td style="text-align: left;"> The median, 50% quantile.</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>3rd Qu.</code>     </td><td style="text-align: left;"> The 75% quantile.
    </td>
</tr>

</table>



<h3>Functions</h3>


<ul>
<li> <p><code>summary.SWIM</code>: Summarising Stressed Models
</p>
</li>
<li> <p><code>summary.SWIMw</code>: Summarising Stressed Models
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Silvana M. Pesenti
</p>
<p>Zhuomin Mao
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+summary">summary</a></code>, <code><a href="#topic+SWIM">SWIM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>     
## Example with the Relative Entropy
## continuing example in stress_VaR 
set.seed(0)
x &lt;- as.data.frame(cbind(
  "normal" = rnorm(1000), 
  "gamma" = rgamma(1000, shape = 2)))
  
res1 &lt;- stress(type = "VaR", x = x, 
  alpha = 0.9, q_ratio = 1.05)
summary(res1, xCol = "normal", base = TRUE) 


     
## Example with the Wasserstein distance 
## Not run: 
resW &lt;- stress_wass(type = "RM", x = x, 
alpha = 0.9, q_ratio = 1.05)
summary(resW, xCol = "normal", base = TRUE) 

## End(Not run)

</code></pre>

<hr>
<h2 id='SWIM'>SWIM: A Package for Sensitivity Analysis</h2><span id='topic+SWIM'></span>

<h3>Description</h3>

<p>The <code>SWIM</code> package provides weights on simulated scenarios
from a stochastic model, such that a stressed model component
(random variable) fulfil given probabilistic constraints (e.g.
specified values for risk measures), under the new scenario weights.
Scenario weights are selected by constrained minimisation of the
relative entropy or Wasserstein distance to the baseline model.
</p>


<h3>Details</h3>

<p>The <code>SWIM</code> (Scenario Weights for Importance Measurement)
package provides weights on simulated scenarios from a stochastic
model, such that stressed random variables fulfil given
probabilistic constraints (e.g. specified values for risk
measures), under the new scenario weights. Scenario weights are
selected by constrained minimisation of the relative entropy or 
Wasserstein distance to the
baseline model.
</p>
<p>The <code>SWIM</code> package is based on the <em>reverse sensitivity
framework</em> developed by (Pesenti et al. 2019) and (Pesenti 2021).
</p>
<p>Consider the random vector <code>X = (X1,...,Xn)</code>. Let P
represent the probability measure under which all simulated
scenarios have the same probability. First, take the 
approach of minimizing the relative entropy. Then, for a random variable
<code>Xi</code>, the package solves:
</p>
<p style="text-align: center;"><code class="reqn">min D(P | Q)</code>
</p>

<p>subject to constraints on the distribution
of <code>Xi</code> under <code>Q</code>,
where <code>D(P | Q)</code> is the Kullback-Leibler divergence
(relative entropy) between <code>P</code> and <code>Q</code>.
</p>
<p>The approach of minimizing the Wasserstein distance of order 2 proceeds 
as follows: Let F be the distribution function of the random variable <code>Xi</code> 
under <code>P</code>, then the package solves
</p>
<p style="text-align: center;"><code class="reqn">argmin_{G} W_{2}(G, F)</code>
</p>

<p>subject to constraints on <code>G</code>, <code>W_{2}(G, F)</code> is the 2-Wasserstein distance 
between <code>G</code> and <code>F</code>. The solution to the above minimisation problem is the 
distribution of <code>Xi</code> under <code>Q</code>. The current implementation of the Wasserstein 
approach is based on Kernel density estimation with Gaussian kernels.
</p>
<p>For both approaches, the scenario weights are then formed via the Radon-Nikodym 
derivative <code>dQ / dP</code>. The weighting generates a model for which the joint distribution 
of <code>(X1,...,Xn)</code> is stressed.
</p>
<p>Different elements of <code>X</code> can be understood as
inputs or outputs of a model. For example, consider a model
<code>Y = g(Z)</code> with input vector <code>Z = (Z1,...,Z(n-1))</code>.
One can then identify <code>X1 = Y</code> and <code>X2 = Z1,...,Xn
    = Z(n-1)</code>. Subsequently, the user of the <code>SWIM</code> package can
stress the model output or any of the inputs, measuring the
resulting impact on the distributions of other variables.
</p>


<h3>Stresses for Relative Entropy Minimization</h3>

<p>Scenario weights for the following stresses are provided:
</p>

<table>
<tr>
 <td style="text-align: left;">
       <code><a href="#topic+stress">stress</a></code></td><td style="text-align: left;"> calls one of the functions below by
    using <code>type</code></td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+stress_VaR">stress_VaR</a></code> </td><td style="text-align: left;"> for stressing the VaR
    (<code>type = "VaR"</code>)</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+stress_VaR_ES">stress_VaR_ES</a></code> </td><td style="text-align: left;"> for stressing the VaR and
    ES jointly (<code>type = "VaR ES"</code>)</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+stress_mean">stress_mean</a></code></td><td style="text-align: left;"> for stressing means
    (<code>type = "mean"</code>) </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+stress_mean_sd">stress_mean_sd</a></code> </td><td style="text-align: left;"> for stressing means and
    standard deviations (<code>type = "mean std"</code>)</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+stress_moment">stress_moment</a></code> </td><td style="text-align: left;"> for stressing moments
    (<code>type = "moment"</code>)</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+stress_prob">stress_prob</a></code> </td><td style="text-align: left;"> for stressing the probabilities
      of intervals
    (<code>type = "prob"</code>) </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+stress_user">stress_user</a></code> </td><td style="text-align: left;"> for user defined scenario weights
    (<code>type = "user"</code>) </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td>
</tr>

</table>



<h3>Stresses for Wasserstein Distance Minimization</h3>

<p>Scenario weights for the following stresses are provided:
</p>

<table>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+stress_wass">stress_wass</a></code></td><td style="text-align: left;"> calls one of the functions below by
    using <code>type</code></td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+stress_RM_w">stress_RM_w</a></code> </td><td style="text-align: left;"> for stressing the distortion risk measure (RM)
    (<code>type = "RM"</code>)</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+stress_mean_sd_w">stress_mean_sd_w</a></code> </td><td style="text-align: left;"> for stressing mean and
    standard deviation (<code>type = "mean sd"</code>)</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+stress_RM_mean_sd_w">stress_RM_mean_sd_w</a></code> </td><td style="text-align: left;"> for stressing the RM, mean and 
      standard deviation (<code>type = "RM mean sd"</code>)</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+stress_HARA_RM_w">stress_HARA_RM_w</a></code> </td><td style="text-align: left;"> for stressing the HARA utility and RM
    (<code>type = "HARA RM"</code>)</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+stress_mean_w">stress_mean_w</a></code> </td><td style="text-align: left;"> for stressing mean (<code>type = "mean"</code>)
    </td>
</tr>

</table>



<h3>A <code>SWIM</code> object</h3>

<p>A SWIM object is generated by applying a stress function subject to a relative entropy minimisation. 
An object of class <code>SWIM</code> contains a list of:
</p>

<ul>
<li> <p><code>x</code>, a data.frame containing realisations of a random
vector;
</p>
</li>
<li> <p><code>new_weights</code>, a list, each component corresponds to
a different stress and is either a vector of scenario weights or a
function, that applied to the <code>k</code>th column of <code>x</code>,
generates the vectors of scenario weights;
</p>
</li>
<li> <p><code>type</code>: a list, each component corresponds to a
different stress and specifies the type of the stress;
</p>
</li>
<li> <p><code>specs</code>, a list, each component corresponds to
a different stress and contains a list with the specifications
of what has been stressed.
Specifications depend on the <code>type</code> of stress:
</p>

<ul>
<li> <p><code>type = "VaR"</code>: <code>k</code>, the column of <code>x</code>
on which the stress is applied to; <code>alpha</code>, the level of
the stressed VaR; <code>q</code>, the stressed VaR at level
<code>alpha</code>.
</p>
</li>
<li> <p><code>type = "VaR ES"</code>: <code>k</code>, the column of <code>x</code>
on which the stress is applied to; <code>alpha</code>, the level of the
stressed VaR and ES; <code>q</code>, the stressed VaR at level
<code>alpha</code>.
</p>
</li>
<li> <p><code>type = "mean"</code>: <code>k</code>, the columns of <code>x</code>
on which the stress is applied to; <code>new_means</code>, the
stressed means.
</p>
</li>
<li> <p><code>type = "mean sd"</code>: <code>k</code>, the columns of <code>x</code>
on which the stress is applied to; <code>new_means</code>, the
stressed means; <code>new_sd</code>, the stressed standard deviations.
<code>s</code>, the stressed ES at level <code>alpha</code>.
</p>
</li>
<li> <p><code>type = "moment"</code>: <code>f</code>, the list of functions,
that, applied to <code>x</code>, constitute the moment constraints;
<code>k</code>, the columns of <code>x</code> on which each function in
<code>f</code> operates on; <code>m</code>, the stressed moments of
<code>f(x)</code>.
</p>
</li>
<li> <p><code>type = "prob"</code>: <code>k</code>, the column of <code>x</code>
on which the stress is applied to; <code>lower</code>, the left
endpoints of the intervals; <code>upper</code>, the right endpoints
of the intervals; <code>prob</code>, stressed probabilities
corresponding to the intervals defined through <code>lower</code>
and <code>upper</code>.
</p>
</li>
<li> <p><code>type = "user"</code>: <code>k</code>, the column of <code>x</code>
on which the stress is applied to.
</p>
</li></ul>

</li></ul>



<h3>A <code>SWIMw</code> object</h3>

<p>A SWIMw object is generated by applying a stress function 
subject to a Wasserstein minimisation. The Wasserstein 
minimisation approach assumes that all model components, 
(random variables) are continuously distributed. If only 
the stressed model component is continuously distributed, 
the SWIMw stress should be converted to a SWIM object, see 
<code>convert_SWIMw_to_SWIM</code>. 
An object of class <code>SWIMw</code> contains a list of:
</p>

<ul>
<li> <p><code>x</code>, a data.frame containing realisations of a random
vector;
</p>
</li>
<li> <p><code>new_weights</code>: a list, each component corresponds to
a different stress and is either a vector of scenario weights or a
function, that applied to the <code>k</code>th column of <code>x</code>,
generates the vectors of scenario weights;
</p>
</li>
<li> <p><code>type</code>: a list, each component corresponds to a
different stress and specifies the type of the stress;
</p>
</li>
<li> <p><code>h</code>: a list, each component corresponds to a different stress
and specifies the bandwidth;
</p>
</li>
<li> <p><code>u</code>: a list, each component corresponds to a different stress
and is a vector containing the gridspace on [0, 1];
</p>
</li>
<li> <p><code>lam</code>: a list, each component corresponds to a different stress
and is vector containing the lambda's of the optimized model;
</p>
</li>
<li> <p><code>str_fY</code>: a list, each component corresponds to a different 
stress and is a function defining the densities of the stressed component;
</p>
</li>
<li> <p><code>str_FY</code>: a list, each component corresponds to a different 
stress and is a function defining the distribution of the stressed component;
</p>
</li>
<li> <p><code>str_FY_inv</code>: a list, each component corresponds to a different 
stress and is a function defining the quantiles of the stressed component;
</p>
</li>
<li> <p><code>gamma</code>: a list, each component corresponds to a different 
stress and is a function defining the risk measure;
</p>
</li>
<li> <p><code>specs</code>: a list, each component corresponds to
a different stress and contains a list with the specifications
of what has been stressed.
Specifications depend on the <code>type</code> of stress:
</p>

<ul>
<li> <p><code>type = "RM"</code>: <code>k</code>, the column of <code>x</code>
on which the stress is applied to; <code>alpha</code>, the level of
the RM; <code>q</code>, the stressed RM at level
<code>alpha</code>.
</p>
</li>
<li> <p><code>type = "mean sd"</code>: <code>k</code>, the columns of <code>x</code>
on which the stress is applied to; <code>new_mean</code>, the
stressed mean; <code>new_sd</code>, the stressed standard deviation.
</p>
</li>
<li> <p><code>type = "RM mean sd"</code>: <code>k</code>, the column of <code>x</code>
on which the stress is applied to; <code>alpha</code>, the level of the
stressed RM; <code>q</code>, the stressed RM at level
<code>alpha</code>; <code>new_mean</code>, the
stressed mean; <code>new_sd</code>, the stressed standard deviation.
</p>
</li>
<li> <p><code>type = "HARA RM"</code>: <code>k</code>, the column of <code>x</code>
on which the stress is applied to; <code>alpha</code>, the level of
the stressed RM; <code>q</code>, the stressed RM at level
<code>alpha</code>; <code>a</code> a parameter of the HARA utility function;
<code>b</code>, a parameter of the HARA utility function;
<code>eta</code> a parameter of the HARA utility function;
<code>hu</code>, the stressed HARA utility with parameters 
<code>a</code>, <code>b</code>, and <code>eta</code>.
</p>
</li></ul>

</li></ul>



<h3>References</h3>

<p>Pesenti SM, Millossovich P, Tsanakas A (2019).
&ldquo;Reverse sensitivity testing: What does it take to break the model?&rdquo;
<em>European Journal of Operational Research</em>, <b>274</b>(2), 654&ndash;670.<br />
</p>
<p>Pesenti S BAMPTA (2020).
&ldquo;Scenario Weights for Importance Measurement (SWIM) - An R package for sensitivity analysis.&rdquo;
<em>Annals of Actuarial Science 15.2 (2021): 458-483. Available at SSRN: <a href="https://www.ssrn.com/abstract=3515274">https://www.ssrn.com/abstract=3515274</a></em>.<br />
</p>
<p>Csiszar I (1975).
&ldquo;I-divergence geometry of probability distributions and minimization problems.&rdquo;
<em>The Annals of Probability</em>, 146&ndash;158.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+get_data">get_data</a></code> for extracting the data,
<code>x</code>; <code><a href="#topic+get_weights">get_weights</a></code> for extracting the scenario
weights, <code>new_weights</code>; <code><a href="#topic+get_weightsfun">get_weightsfun</a></code> for
extracting the functions generating the scenario weights; and
<code><a href="#topic+get_specs">get_specs</a></code> for extracting the specifications of
the stress on an object of class <code>SWIM</code>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
