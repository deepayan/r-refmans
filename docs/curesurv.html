<!DOCTYPE html><html lang="en"><head><title>Help for package curesurv</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {curesurv}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#curesurv-package'><p>Mixture and Non Mixture Parametric Cure Models to Estimate Cure Indicators</p></a></li>
<li><a href='#AIC.curesurv'><p>Akaike's An Information Criterion for cure models</p></a></li>
<li><a href='#anova.curesurv'><p>anova.curesurv function for likelihood-ratio test of two nested models from curesurv function</p></a></li>
<li><a href='#cumLexc_alphaeweibull'><p>cumLexc_alphaeweibull function</p></a></li>
<li><a href='#cumLexc_alphaweibull'><p>cumLexc_alphaweibull function</p></a></li>
<li><a href='#cumLexc_alphaweibull_topred'><p>cumLexc_alphaweibull_topred function</p></a></li>
<li><a href='#cumLexc_mul'><p>cumLexc_mul function</p></a></li>
<li><a href='#curesurv'><p>Fitting cure models using curesurv</p></a></li>
<li><a href='#dataweib'><p>Simulated data with vital status information from Weibull mixture cure model</p></a></li>
<li><a href='#dexhazdtheta_adtneh2'><p>dexhazdtheta_adtneh2 function</p></a></li>
<li><a href='#dexhazdtheta_multneh'><p>dexhazdtheta_multneh function</p></a></li>
<li><a href='#dexhazdtheta_wei'><p>dexhazdtheta_wei function</p></a></li>
<li><a href='#digamma'><p>digamma function</p></a></li>
<li><a href='#dlogCumHazdtheta_wei'><p>dlogCumHazdtheta_wei function</p></a></li>
<li><a href='#dloglogpdtheta_wei'><p>dloglogpdtheta_wei function</p></a></li>
<li><a href='#dlogpdtheta_wei'><p>dlogpdtheta_wei function</p></a></li>
<li><a href='#dlogsndtheta_wei'><p>dlogsndtheta_wei function</p></a></li>
<li><a href='#dlogTTCdtheta_wei'><p>dlogTTCdtheta_wei function</p></a></li>
<li><a href='#dpdtheta_adtneh2'><p>dpdtheta_adtneh2 function</p></a></li>
<li><a href='#dpdtheta_wei'><p>dpdtheta_wei function</p></a></li>
<li><a href='#dpidtheta_adtneh2'><p>dpidtheta_adtneh2 function</p></a></li>
<li><a href='#dpidtheta_multneh'><p>dpidtheta_multneh function</p></a></li>
<li><a href='#dpidtheta_wei'><p>dpitheta_wei function</p></a></li>
<li><a href='#dptdtheta_multneh'><p>dptdtheta_multneh function</p></a></li>
<li><a href='#dpttcdtheta_adtneh2'><p>dpttcdtheta_adtneh2 function</p></a></li>
<li><a href='#dpttcdtheta_multneh'><p>dpttcdtheta_adtneh2 function</p></a></li>
<li><a href='#dsndtheta_adtneh2'><p>dsndtheta_adtneh2 function</p></a></li>
<li><a href='#dsndtheta_multneh'><p>dsndtheta_multneh function</p></a></li>
<li><a href='#dsndtheta_wei'><p>dsndtheta_wei function</p></a></li>
<li><a href='#dTTCdtheta_wei'><p>dTTCdtheta_wei function</p></a></li>
<li><a href='#exhaz_ic_adtneh2'><p>exhaz_ic_adtneh2 function</p></a></li>
<li><a href='#exhaz_ic_adtneh2_log'><p>exhaz_ic_adtneh2_log function</p></a></li>
<li><a href='#exhaz_ic_adtneh2_loglog'><p>exhaz_ic_adtneh2_loglog function</p></a></li>
<li><a href='#exhaz_ic_multneh'><p>exhaz_ic_multneh function</p></a></li>
<li><a href='#exhaz_ic_multneh_log'><p>exhaz_ic_multneh_log function</p></a></li>
<li><a href='#exhaz_ic_multneh_loglog'><p>exhaz_ic_multneh_loglog function</p></a></li>
<li><a href='#exhaz_ic_wei'><p>exhaz_ic_wei function</p></a></li>
<li><a href='#exhaz_ic_wei_log'><p>exhaz_ic_wei_log function</p></a></li>
<li><a href='#exhaz_ic_wei_loglog'><p>exhaz_ic_wei_loglog function</p></a></li>
<li><a href='#inc.beta.deriv'><p>inc_beta_deriv function</p></a></li>
<li><a href='#lexc_alphaeweibull'><p>lexc_alphaeweibull function</p></a></li>
<li><a href='#lexc_alphaweibull'><p>lexc_alphaweibull function</p></a></li>
<li><a href='#logCumHaz_ic_wei'><p>logCumHaz_ic_wei function</p></a></li>
<li><a href='#pancreas_data'><p>Simulated pancreas data with vital status information</p></a></li>
<li><a href='#pcured'><p>pcured function</p></a></li>
<li><a href='#pi_ic_adtneh2'><p>pi_ic_adtneh2 function</p></a></li>
<li><a href='#pi_ic_adtneh2_log'><p>pi_ic_adtneh2_log function</p></a></li>
<li><a href='#pi_ic_adtneh2_loglog'><p>pi_ic_adtneh2_loglog function</p></a></li>
<li><a href='#pi_ic_log_wei'><p>pi_ic_log_wei function</p></a></li>
<li><a href='#pi_ic_loglog_wei'><p>pi_ic_loglog_wei function</p></a></li>
<li><a href='#pi_ic_multneh'><p>pi_ic_multneh function</p></a></li>
<li><a href='#pi_ic_multneh_log'><p>pi_ic_multneh_log function</p></a></li>
<li><a href='#pi_ic_multneh_loglog'><p>pi_ic_multneh_loglog function</p></a></li>
<li><a href='#pi_ic_wei'><p>pi_ic_wei function</p></a></li>
<li><a href='#plot.predCuresurv'><p>plot method for curesurv prediction objects</p></a></li>
<li><a href='#predcall_tneh'><p>predcall_tneh function</p></a></li>
<li><a href='#predcall_wei'><p>predcall_wei function</p></a></li>
<li><a href='#predict.curesurv'><p>Prediction for a curesurv cure model</p></a></li>
<li><a href='#print.curesurv'><p>print a curesurv object</p></a></li>
<li><a href='#pt_cure_ic_adtneh2'><p>pt_cure_ic_adtneh2 function</p></a></li>
<li><a href='#pt_cure_ic_adtneh2_log'><p>pt_cure_ic_adtneh2_log function</p></a></li>
<li><a href='#pt_cure_ic_adtneh2_loglog'><p>pt_cure_ic_adtneh2_loglog function</p></a></li>
<li><a href='#pt_cure_ic_log_wei'><p>pt_cure_ic_log_wei function</p></a></li>
<li><a href='#pt_cure_ic_loglog_wei'><p>pt_cure_ic_loglog_wei function</p></a></li>
<li><a href='#pt_cure_ic_multneh'><p>pt_cure_ic_multneh function</p></a></li>
<li><a href='#pt_cure_ic_multneh_log'><p>pt_cure_ic_multneh_log function</p></a></li>
<li><a href='#pt_cure_ic_multneh_loglog'><p>pt_cure_ic_multneh_loglog function</p></a></li>
<li><a href='#pt_cure_ic_noDM'><p>pt_cure_ic_noDM function</p></a></li>
<li><a href='#pt_cure_ic_wei'><p>pt_cure_ic_wei function</p></a></li>
<li><a href='#pt_cure_wei'><p>pt_cure_wei function</p></a></li>
<li><a href='#sn_ic_adtneh2'><p>sn_ic_adtneh2 function</p></a></li>
<li><a href='#sn_ic_adtneh2_log'><p>sn_ic_adtneh2_log function</p></a></li>
<li><a href='#sn_ic_adtneh2_loglog'><p>sn_ic_adtneh2_loglog function</p></a></li>
<li><a href='#sn_ic_log_wei'><p>sn_ic_log_wei function</p></a></li>
<li><a href='#sn_ic_multneh'><p>sn_ic_multneh function</p></a></li>
<li><a href='#sn_ic_multneh_log'><p>sn_ic_multneh_log function</p></a></li>
<li><a href='#sn_ic_multneh_loglog'><p>sn_ic_multneh_loglog function</p></a></li>
<li><a href='#sn_ic_wei'><p>sn_ic_wei function</p></a></li>
<li><a href='#summary.curesurv'><p>summary for a curesurv cure model</p></a></li>
<li><a href='#testiscancer'><p>Simulated testis cancer data using a cure model</p></a></li>
<li><a href='#trigamma'><p>trigamma function</p></a></li>
<li><a href='#TTC_adtneh2'><p>TTC_adtneh2 function</p></a></li>
<li><a href='#TTC_ic_adtneh2'><p>TTC_ic_adtneh2 function</p></a></li>
<li><a href='#TTC_ic_adtneh2_log'><p>TTC_ic_adtneh2_log function</p></a></li>
<li><a href='#TTC_ic_Jakobsen_wei'><p>TTC_ic_Jakobsen_wei function</p></a></li>
<li><a href='#TTC_ic_log_wei'><p>TTC_ic_log_wei function</p></a></li>
<li><a href='#TTC_ic_multneh'><p>TTC_ic_multneh function</p></a></li>
<li><a href='#TTC_ic_multneh_log'><p>TTC_ic_multneh_log function</p></a></li>
<li><a href='#TTC_ic_wei'><p>TTC_ic_wei function</p></a></li>
<li><a href='#TTC_multneh'><p>TTC_multneh function</p></a></li>
<li><a href='#TTC_theoric_adtneh'><p>TTC_theoric_adtneh function</p></a></li>
<li><a href='#TTC_wei'><p>TTC_wei function</p></a></li>
<li><a href='#var_logCumHaz_wei'><p>var_logCumHaz_wei function</p></a></li>
<li><a href='#var_pt_cure_wei'><p>var_pt_cure_wei function</p></a></li>
<li><a href='#var_TTC_Jakobsen_wei'><p>var_TTC_Jakobsen_wei function</p></a></li>
<li><a href='#var_TTC_multneh'><p>var_TTC_multneh function</p></a></li>
<li><a href='#var_TTC_tneh2'><p>var_TTC_tneh2 function</p></a></li>
<li><a href='#var_TTC_wei'><p>var_TTC_wei function</p></a></li>
<li><a href='#varexhaz_adtneh2'><p>varexhaz_adtneh2 function</p></a></li>
<li><a href='#varlogTTC_Jakobsen_wei'><p>varlogTTC_Jakobsen_wei function</p></a></li>
<li><a href='#varlogTTC_wei'><p>varlogTTC_wei function</p></a></li>
<li><a href='#z_alpha'><p>z_alpha function identifying variables acting on alpha parameter</p></a></li>
<li><a href='#z_riskpop.alpha'><p>z_riskpop.alpha function</p></a></li>
<li><a href='#z_tau'><p>z_tau function identifying variables acting on tau parameter</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Mixture and Non Mixture Parametric Cure Models to Estimate Cure
Indicators</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Juste Goungounga <a href="https://orcid.org/0000-0002-9039-2639"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Judith Breaud <a href="https://orcid.org/0009-0001-1432-6883"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Olayide Boussari <a href="https://orcid.org/0000-0002-0343-853X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Laura Botta <a href="https://orcid.org/0000-0002-2793-5338"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Valerie Jooste <a href="https://orcid.org/0000-0002-9902-0700"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Juste Goungounga &lt;juste.goungounga@ehesp.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits a variety of cure models using excess hazard modeling methodology such as the mixture model proposed by Phillips et al. (2002) &lt;<a href="https://doi.org/10.1002%2Fsim.1101">doi:10.1002/sim.1101</a>&gt; The Weibull distribution is used to represent the survival function of the uncured patients; Fits also non-mixture cure model such as the time-to-null excess hazard model proposed by Boussari et al. (2020) &lt;<a href="https://doi.org/10.1111%2Fbiom.13361">doi:10.1111/biom.13361</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5), stringr, survival</td>
</tr>
<tr>
<td>Imports:</td>
<td>numDeriv, stats, randtoolbox, bbmle, optimx, Formula, Deriv,
statmod</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, xhaz, survexp.fr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-07 12:39:20 UTC; jbreaud</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-07 13:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='curesurv-package'>Mixture and Non Mixture Parametric Cure Models to Estimate Cure Indicators</h2><span id='topic+curesurv-package'></span>

<h3>Description</h3>

<p>Fits cure models in net survival setting. It can be a mixture
cure model with the survival of the uncured following a Weibull or an
exponentiated Weibull. The package also implements non-mixture cure models
such as the time-to-null excess hazard model proposed by Boussari et al (2021).
If the modelling assumption of the comparability between expected hazard in
the cohort under study and that related to the general population doesn't hold,
an extra effect (due to life tables mismatch) can be estimated for these two
classes of cure models. The overall survival setting can also be considered in this package.
</p>


<h3>Details</h3>

<p>package: curesurv
</p>
<div class="sourceCode"><pre>     type: Package

     Version 0.1.2

     license: GPL 3 + LICENSE file
</pre></div>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N,
Remontet L, Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Phillips N, Coldman A, McBride ML. Estimating cancer prevalence using
mixture models for cancer survival. Stat Med. 2002 May 15;21(9):1257-70.
doi: 10.1002/sim.1101. PMID: 12111877.
(<a href="https://pubmed.ncbi.nlm.nih.gov/12111877/">pubmed</a>)
</p>
<p>De Angelis R, Capocaccia R, Hakulinen T, Soderman B, Verdecchia A. Mixture
models for cancer survival analysis: application to population-based data
with covariates. Stat Med. 1999 Feb 28;18(4):441-54.
doi: 10.1002/(sici)1097-0258(19990228)18:4&lt;441::aid-sim23&gt;3.0.co;2-m.
PMID: 10070685. (<a href="https://pubmed.ncbi.nlm.nih.gov/10070685/">pubmed</a>)
</p>

<hr>
<h2 id='AIC.curesurv'>Akaike's An Information Criterion for cure models</h2><span id='topic+AIC.curesurv'></span>

<h3>Description</h3>

<p>Calculates the Akaike's &quot;An Information Criterion&quot; for fitted models from <code>curesurv</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'curesurv'
AIC(object, ..., k = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AIC.curesurv_+3A_object">object</code></td>
<td>
<p>a fitted model object obtained from <code>curesurv</code></p>
</td></tr>
<tr><td><code id="AIC.curesurv_+3A_...">...</code></td>
<td>
<p>optionally more fitted model objects obtained from <code>curesurv</code>.</p>
</td></tr>
<tr><td><code id="AIC.curesurv_+3A_k">k</code></td>
<td>
<p>numeric, the penalty per parameter to be used; the default k = 2 is the classical AIC.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When comparing models fitted by maximum likelihood to the same data, the smaller the AIC, the better the fit.
</p>
<p>However in our case, one should be careful when comparing the AIC. Specifically, when one implements a mixture cure model with <code>curesurv</code>
without correcting the rate table (<code>pophaz.alpha=FALSE</code>), one is not obligated to specify <code>cumpophaz</code>. However, you cannot compare a model where <code>cumpophaz</code>
is not specified with a model where <code>cumpophaz</code> is specified. If one wants to compare different models using AIC, one should always specify <code>cumpophaz</code> when
using the <code>curesurv</code> function.
</p>


<h3>Value</h3>

<p>the value corresponds to the AIC calculated from the log-likelihood of the fitted model if just one object is provided. If multiple objects are provided, a data.frame with columns corresponding to the objects and row representing the AIC
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library("curesurv")
library("survival")

 testiscancer$age_crmin &lt;- (testiscancer$age- min(testiscancer$age)) /
              sd(testiscancer$age)

fit_m1_ad_tneh &lt;- curesurv(Surv(time_obs, event) ~ z_tau(age_crmin) +
                          z_alpha(age_crmin),
                          pophaz = "ehazard",
                          cumpophaz = "cumehazard",
                          model = "nmixture", dist = "tneh",
                          link_tau = "linear",
                          data = testiscancer,
                          method_opt = "L-BFGS-B")

 AIC(fit_m1_ad_tneh)

 
</code></pre>

<hr>
<h2 id='anova.curesurv'>anova.curesurv function for likelihood-ratio test of two nested models from curesurv function</h2><span id='topic+anova.curesurv'></span>

<h3>Description</h3>

<p>This function computes an analysis of deviance table for two excess hazard models fitted using the curesurv R package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'curesurv'
anova(object, ..., test = "LRT")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anova.curesurv_+3A_object">object</code></td>
<td>
<p>An object of class curesurv.</p>
</td></tr>
<tr><td><code id="anova.curesurv_+3A_...">...</code></td>
<td>
<p>Additional object of class curesurv.</p>
</td></tr>
<tr><td><code id="anova.curesurv_+3A_test">test</code></td>
<td>
<p>A character string. Computes the likelihood-ratio test for value <code>"LRT"</code>. In case the two models are the same, but one with the correction of mortality tables and one without, the likelihood ratio test is computed for value <code>"LRT_alpha"</code>  These are the only tests available for now.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class anova inheriting from class matrix. The different columns contain respectively the degrees of freedom and the log-likelihood values of the two nested models, the degree of freedom of the chi-square statistic, the chi-square statistic, and the p-value of the likelihood ratio test.
</p>


<h3>Note</h3>

<p>The comparison between two or more models by anova or more excess hazard models will only be valid if they are fitted to the same dataset, and if the compared models are nested. This may be a problem if there are missing values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library("curesurv")
library("survival")

testiscancer$age_crmin &lt;- (testiscancer$age - min(testiscancer$age)) / sd(testiscancer$age)

fit_m0 &lt;- curesurv(Surv(time_obs, event) ~ 1 | 1,
                          pophaz = "ehazard",
                          cumpophaz = "cumehazard",
                          model = "nmixture", dist = "tneh",
                          link_tau = "linear",
                          data = testiscancer,
                          method_opt = "L-BFGS-B")

fit_m1 &lt;- curesurv(Surv(time_obs, event) ~ age_crmin | 1,
                          pophaz = "ehazard",
                          cumpophaz = "cumehazard",
                          model = "nmixture", dist = "tneh",
                          link_tau = "linear",
                          data = testiscancer,
                          method_opt = "L-BFGS-B")

anova(fit_m0, fit_m1)


</code></pre>

<hr>
<h2 id='cumLexc_alphaeweibull'>cumLexc_alphaeweibull function</h2><span id='topic+cumLexc_alphaeweibull'></span>

<h3>Description</h3>

<p>calculates the cumulative excess hazard from an exponentiated
Weibull distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cumLexc_alphaeweibull(
  z_ucured = z_ucured,
  z_pcured = z_pcured,
  x = x,
  theta = theta,
  sign_delta = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cumLexc_alphaeweibull_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="cumLexc_alphaeweibull_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion.</p>
</td></tr>
<tr><td><code id="cumLexc_alphaeweibull_+3A_x">x</code></td>
<td>
<p>the time arguments at which to calculate the cumulative excess hazard</p>
</td></tr>
<tr><td><code id="cumLexc_alphaeweibull_+3A_theta">theta</code></td>
<td>
<p>the parameters of the cumulative excess hazard from an
exponentiated Weibull distribution</p>
</td></tr>
<tr><td><code id="cumLexc_alphaeweibull_+3A_sign_delta">sign_delta</code></td>
<td>
<p>only used for mixture cure rate models to specify if the
effects or minus the effects of covariates acting on uncured survival to be
considered. Default will be sign_delta = &quot;1&quot;. The alternative is
sign_delta = &quot;-1&quot;.
</p>
<p>@keywords cumLexc_alphaeweibull</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>curesurv</code>.
This object is a vector containing:
</p>
<table role = "presentation">
<tr><td><code>cumHazE</code></td>
<td>
<p>values of the cumulative excess hazard at the time
points considered for the calculations</p>
</td></tr>
</table>


<h3>References</h3>

<p>Mudholkar, G.S. and Srivastava, D.K. (1993).
Exponentiated Weibull family for analyzing bathtub failure-rate data,
IEEE Transactions on Reliability, 42, 299-302.
</p>
<p>Mudholkar, G.S., Srivastava, D.K., and Freimer, M. (1995). The exponentiated
Weibull family: a reanalysis of the bus-motor-failure data,
Technometrics, 37, 436-445.doi:10.2307/1269735
(<a href="https://www.jstor.org/stable/1269735">jstor</a>)
</p>

<hr>
<h2 id='cumLexc_alphaweibull'>cumLexc_alphaweibull function</h2><span id='topic+cumLexc_alphaweibull'></span>

<h3>Description</h3>

<p>calculates the cumulative excess hazard from a Weibull distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cumLexc_alphaweibull(
  z_ucured = z_ucured,
  z_pcured = z_pcured,
  x = x,
  theta = theta,
  sign_delta = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cumLexc_alphaweibull_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="cumLexc_alphaweibull_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion.</p>
</td></tr>
<tr><td><code id="cumLexc_alphaweibull_+3A_x">x</code></td>
<td>
<p>the time arguments at which to calculate the cumulative excess hazard</p>
</td></tr>
<tr><td><code id="cumLexc_alphaweibull_+3A_theta">theta</code></td>
<td>
<p>estimated parameters of the cumulative excess hazard from a mixture
model using curesurv and uncured survival following a Weibull distribution</p>
</td></tr>
<tr><td><code id="cumLexc_alphaweibull_+3A_sign_delta">sign_delta</code></td>
<td>
<p>only used for mixture cure rate models to specify if the
effects or minus the effects of covariates acting on uncured survival to be
considered. Default will be sign_delta = &quot;1&quot;. The alternative is
sign_delta = &quot;-1&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This object is a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>cumhaz</code></td>
<td>
<p>cumulative excess hazard estimates</p>
</td></tr>
<tr><td><code>usurv</code></td>
<td>
<p>survival of uncured</p>
</td></tr>
<tr><td><code>SurvE</code></td>
<td>
<p>net survival estimates</p>
</td></tr>
<tr><td><code>cured</code></td>
<td>
<p>cure fraction</p>
</td></tr>
<tr><td><code>ptcure</code></td>
<td>
<p>the probability Pi(t) of being cured at a given time t after diagnosis knowing that he/she was alive up to time t.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>

<hr>
<h2 id='cumLexc_alphaweibull_topred'>cumLexc_alphaweibull_topred function</h2><span id='topic+cumLexc_alphaweibull_topred'></span>

<h3>Description</h3>

<p>calculates the cumulative excess hazard from a Weibull distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cumLexc_alphaweibull_topred(
  z_ucured = z_ucured,
  z_pcured = z_pcured,
  x = x,
  theta = theta,
  sign_delta = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cumLexc_alphaweibull_topred_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="cumLexc_alphaweibull_topred_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion.</p>
</td></tr>
<tr><td><code id="cumLexc_alphaweibull_topred_+3A_x">x</code></td>
<td>
<p>the time arguments at which to calculate the cumulative excess hazard</p>
</td></tr>
<tr><td><code id="cumLexc_alphaweibull_topred_+3A_theta">theta</code></td>
<td>
<p>the parameters of the cumulative excess hazard from a Weibull distribution</p>
</td></tr>
<tr><td><code id="cumLexc_alphaweibull_topred_+3A_sign_delta">sign_delta</code></td>
<td>
<p>only used for mixture cure rate models to specify if the
effects or minus the effects of covariates acting on uncured survival to be
considered. Default will be sign_delta = &quot;1&quot;. The alternative is
sign_delta = &quot;-1&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This object is a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>cumhaz</code></td>
<td>
<p>cumulative excess hazard estimates</p>
</td></tr>
<tr><td><code>usurv</code></td>
<td>
<p>survival of uncured</p>
</td></tr>
<tr><td><code>SurvE</code></td>
<td>
<p>net survival estimates</p>
</td></tr>
<tr><td><code>cured</code></td>
<td>
<p>cure fraction</p>
</td></tr>
<tr><td><code>pt_cure</code></td>
<td>
<p>the conditionnal probability of being cured knowing they are alive at t</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>

<hr>
<h2 id='cumLexc_mul'>cumLexc_mul function</h2><span id='topic+cumLexc_mul'></span>

<h3>Description</h3>

<p>returns the cumulative excess hazard for an TNEH model
in case of parametrization of log the of the time to null excess hazard as
function to fit the data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cumLexc_mul(z_tau, z_alpha, x, theta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cumLexc_mul_+3A_z_tau">z_tau</code></td>
<td>
<p>covariates depending on tau</p>
</td></tr>
<tr><td><code id="cumLexc_mul_+3A_z_alpha">z_alpha</code></td>
<td>
<p>covariates depending on alpha</p>
</td></tr>
<tr><td><code id="cumLexc_mul_+3A_x">x</code></td>
<td>
<p>time value</p>
</td></tr>
<tr><td><code id="cumLexc_mul_+3A_theta">theta</code></td>
<td>
<p>of the coefficient of tneh parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class numeric containing the cumulative excess
hazard with the same length as the time.
</p>

<hr>
<h2 id='curesurv'>Fitting cure models using curesurv</h2><span id='topic+curesurv'></span>

<h3>Description</h3>

<p>Fits the non-mixture cure model proposed by Boussari et <em>al</em>. (2020),
or mixture cure model such as proposed by De Angelis et <em>al</em>. (1999) with
the possibility to correct the background mortality as proposed by Phillips et <em>al</em>. (2002)
in the net survival framework.
</p>


<h4>Non-mixture cure model</h4>



<h5>The Boussari model</h5>

<p>This model allows for direct estimation of time-to-null-excess-hazard which can be interpreted as time-to-cure.
The parametrization offers various link functions for the covariates effects on the time-to-null-excess-hazard:
&tau;(z<sub>k</sub>) = g(&tau;<sub>0</sub> + z<sub>k</sub> &tau;<sub>k</sub>).
If <code>link_tau=linear</code>, then g is the identity function. If <code>link_tau=loglinear</code> then g is the exponential function.
In this model, the cure proportion is expressed as:
&pi;(z;&theta;) = exp(&minus;g(&tau;<sub>0</sub> + z<sub>k</sub> &tau;<sub>k</sub>) \text{Beta}((\alpha_{0} + Z_{k} \alpha_{k}), \beta)).
</p>




<h4>Mixture cure model</h4>

<p>The user can choose the survival function modeling the uncured patients net
survival among Weibull (default) and exponentiated Weibull. The parametrization
for weibull distribution is S<sub>u</sub>(t) = exp(&#8722;&#955;t<sup>&#947;</sup>)<sup>exp(&#948;Z)</sup>.
The related hazard function is expressed as: &#955;<sub>u</sub>(t) = &#947;&#955;t<sup>&#947;&#8722; 1</sup> exp(&#948;z)
The net survival and the excess hazard functions can be respectively expressed
as S<sub>E</sub>(t) = &#960;(z;&#946;) + (1 &#8722; &#960;(z;&#946;)) * S<sub>u</sub>(t).
and &#955;<sub>E</sub>(t)=[((1&#8722;&#960;(z;&#946;))fu(t))/(&#960;(z;&#946;) + (1 &#8722; &#960;(z;&#946;))S<sub>u</sub>(t))],
with &#960;(z;&#946;) = [1/((1 + exp(&#8722;[&#946;<sub>0</sub> + Z&#946;])))].
</p>



<h4>Correction of background mortality</h4>

<p>Usually, in the net survival framework the expected hazard is directly obtained from life tables.
However some patients in cancer registries can have some factors impacting their expected mortality rates (such as comorbidities, deprivation)
that are not always accounted #'  for in the available life tables, and there is a need to account for this problem.
The correction proposed by Phillips et <em>al</em> (2002) assumes that &#955;<sub>exp</sub>(t,z)=&#945;&#955;<sub>pop</sub>(t,z<sub>k</sub>)
with &#955;<sub>exp</sub>(t,z) the patient expected hazard and &#955;<sub>pop</sub>(t,z<sub>k</sub>) the population hazard obtained from life table.
</p>



<h3>Usage</h3>

<pre><code class='language-R'>curesurv(
  formula,
  data,
  pophaz = NULL,
  cumpophaz = NULL,
  pophaz.alpha = FALSE,
  model = "nmixture",
  dist = "weib",
  link_tau = "linear",
  ncoor_des = NULL,
  init = NULL,
  maxit_opt = 10000,
  gradient = FALSE,
  hessian_varcov = TRUE,
  optim_func = "optim",
  optimizer = "optim",
  method_opt = "L-BFGS-B",
  trace = 0,
  nvalues = 10,
  iter_eps = 1e-08,
  optim_fixed = NULL,
  clustertype = NULL,
  nproc = 1,
  subset,
  na.action,
  sign_delta,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="curesurv_+3A_formula">formula</code></td>
<td>
<p>a formula object of the <code><a href="survival.html#topic+Surv">Surv</a></code> function with the
response on the left of a <code>~</code> operator and the terms on the right. The
response must be a survival object as returned by the <code><a href="survival.html#topic+Surv">Surv</a></code>
function (<code>time</code> in first and <code>status</code> in second).</p>
</td></tr>
<tr><td><code id="curesurv_+3A_data">data</code></td>
<td>
<p>a data frame in which to interpret the variables named in the
formula</p>
</td></tr>
<tr><td><code id="curesurv_+3A_pophaz">pophaz</code></td>
<td>
<p>corresponds to the name of the column in the data representing
the values of the population instantaneous mortality rates. If the
<code>pophaz</code> argument is not specified, overall survival is fitted.</p>
</td></tr>
<tr><td><code id="curesurv_+3A_cumpophaz">cumpophaz</code></td>
<td>
<p>corresponds to the name of the column in the data
representing the values of the instantaneous population cumulative mortality
rates. If not specified, the model cannot be compared with model with
<code>pophaz.alpha = TRUE</code> using AIC.</p>
</td></tr>
<tr><td><code id="curesurv_+3A_pophaz.alpha">pophaz.alpha</code></td>
<td>
<p>to be specified if user want an excess hazard model
with correction of mortality rates by a scale parameter</p>
</td></tr>
<tr><td><code id="curesurv_+3A_model">model</code></td>
<td>
<p>To fit a mixture model, specify <code>model = "mixture"</code>.
To fit Time-To-Null Excess Hazard model the argument is <code>model = "tneh"</code>.</p>
</td></tr>
<tr><td><code id="curesurv_+3A_dist">dist</code></td>
<td>
<p>For mixture model, it corresponds to the function used to fit
the uncured patients survival. By default, <code>("weib")</code> is used. Another
option is the exponentiated Weibull function <code>("eweib")</code>. For
non-mixture models, this argument corresponds to the name of the model. By
default, <code>("tneh")</code> is used to fit the time to null excess hazard model
proposed by Boussari et al..</p>
</td></tr>
<tr><td><code id="curesurv_+3A_link_tau">link_tau</code></td>
<td>
<p>must be specified only for <code>model ="tneh"</code>.
Default is linear link <code>("linear")</code>. Another link is loglinear
<code>("loglinear")</code>.</p>
</td></tr>
<tr><td><code id="curesurv_+3A_ncoor_des">ncoor_des</code></td>
<td>
<p>if null, the initial parameters are defaults. If else,
the initials parameters are obtained via coordinates descent algorithms</p>
</td></tr>
<tr><td><code id="curesurv_+3A_init">init</code></td>
<td>
<p>a list containing the vector of initial values <code>theta_init</code>,
the vector of upper bounds <code>theta_upper</code> and the vector of the
lower bounds <code>theta_lower</code> for the parameters to estimate.
For each elements of the list, give the name of the covariate followed by
the vector of the fixed initials values</p>
</td></tr>
<tr><td><code id="curesurv_+3A_maxit_opt">maxit_opt</code></td>
<td>
<p>option for maximum of iteration in optimization function</p>
</td></tr>
<tr><td><code id="curesurv_+3A_gradient">gradient</code></td>
<td>
<p>True if optimization process requires gradient to be provided</p>
</td></tr>
<tr><td><code id="curesurv_+3A_hessian_varcov">hessian_varcov</code></td>
<td>
<p>TRUE if user wants variance covariance matrix using
hessian function</p>
</td></tr>
<tr><td><code id="curesurv_+3A_optim_func">optim_func</code></td>
<td>
<p>specify which function to be used for optimization purposes.</p>
</td></tr>
<tr><td><code id="curesurv_+3A_optimizer">optimizer</code></td>
<td>
<p>only use this argument when <code>optim_func="bbmle"</code></p>
</td></tr>
<tr><td><code id="curesurv_+3A_method_opt">method_opt</code></td>
<td>
<p>optimization method used in <code>optim</code> function. The default
algorithm is &quot;L-BFGS-B&quot;.</p>
</td></tr>
<tr><td><code id="curesurv_+3A_trace">trace</code></td>
<td>
<p>Non-negative integer corresponding to the <code>trace</code> argument
as in <code>optim</code></p>
</td></tr>
<tr><td><code id="curesurv_+3A_nvalues">nvalues</code></td>
<td>
<p>number of set of initial values when using multiple
initials values</p>
</td></tr>
<tr><td><code id="curesurv_+3A_iter_eps">iter_eps</code></td>
<td>
<p>this parameter only works when <code>ncoor_des = "iter"</code>; It
allows to run coordinates descent algorithm until the stooping criteria
equal at least to the specified value.</p>
</td></tr>
<tr><td><code id="curesurv_+3A_optim_fixed">optim_fixed</code></td>
<td>
<p>to specify with parameter to not estimated in the
estimation process</p>
</td></tr>
<tr><td><code id="curesurv_+3A_clustertype">clustertype</code></td>
<td>
<p>related to cluster type in <code>marqLevAlg</code> package</p>
</td></tr>
<tr><td><code id="curesurv_+3A_nproc">nproc</code></td>
<td>
<p>number of processors for parallel computing as in <code>marqLevAlg</code></p>
</td></tr>
<tr><td><code id="curesurv_+3A_subset">subset</code></td>
<td>
<p>an expression indicating which subset of the data should be used
in the modeling. All observations are included by default</p>
</td></tr>
<tr><td><code id="curesurv_+3A_na.action">na.action</code></td>
<td>
<p>as in the coxph function, a missing-data filter function.</p>
</td></tr>
<tr><td><code id="curesurv_+3A_sign_delta">sign_delta</code></td>
<td>
<p>only used for mixture cure rate models to specify if the
effects or minus the effects of covariates acting on uncured survival to be
considered. Default will be sign_delta = &quot;1&quot;. The alternative is
sign_delta = &quot;-1&quot;.</p>
</td></tr>
<tr><td><code id="curesurv_+3A_...">...</code></td>
<td>
<p>additional parameters such <code>z_alpha</code>,
and <code>z_tau</code>. For more details, use the help function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>curesurv</code>.
This object is a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>iter_coords</code></td>
<td>
<p>number of iterations performed to obtain initial values
of the parameters in tneh model only</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>estimates found for the model</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>estimates in the appropriate scale for the model</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>corresponds to the log-likelihood computed; if only the
pophaz is provided, the log-likelihood doesn't correspond to the total
log-likelihood. The part of the cumulative population hazard is a constant
and is dropped for the computation as presented in Esteve et <em>al.</em> (1990);
The total log-likekihood is calculed if the user specifies a column name equal
expected cumulative mortality (cumpophaz)</p>
</td></tr>
<tr><td><code>iteractions</code></td>
<td>
<p>the number iterations attained to estimate the parameters of the related model</p>
</td></tr>
<tr><td><code>evaluations</code></td>
<td>
<p>the number of times the log-likelihood function was evaluated until to reach the convergence</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>an integer code as in optim when <code>L-BFGS-B</code> method
is used in optim.</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p>a character string returned by the optimizer</p>
</td></tr>
<tr><td><code>varcov</code></td>
<td>
<p>the variance covariance matrix of the parameters estimated</p>
</td></tr>
<tr><td><code>varcov_star</code></td>
<td>
<p>the variance covariance matrix of the coefficients of the model of interest</p>
</td></tr>
<tr><td><code>std_err</code></td>
<td>
<p>the standard errors of the estimated parameters</p>
</td></tr>
<tr><td><code>std_err_star</code></td>
<td>
<p>the standard errors of the coefficients of the model of interest</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>the Akaike information criteria from the model of interest</p>
</td></tr>
<tr><td><code>n.events</code></td>
<td>
<p>the number of events in the dataset. Events are considered</p>
</td></tr>
<tr><td><code>n.obs</code></td>
<td>
<p>the number of observations in the dataset.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>if fitted model is a mixture model, it returns &quot;mixture&quot;.
If fitted model is Time-To-Null Excess Hazard model, it returns &quot;nmixture&quot;.</p>
</td></tr>
<tr><td><code>Terms</code></td>
<td>
<p>the representation of the terms in the model</p>
</td></tr>
<tr><td><code>pophaz.alpha</code></td>
<td>
<p>logical value to indicate if fitted cure model requires
correction of mortality rates by a scale parameter</p>
</td></tr>
<tr><td><code>pophaz</code></td>
<td>
<p>corresponds to the the population instantaneous mortality rates.</p>
</td></tr>
<tr><td><code>cumpophaz</code></td>
<td>
<p>corresponds to the population cumulative mortality rates.</p>
</td></tr>
<tr><td><code>frailtyhp</code></td>
<td>
<p>a booleen to be specified if a frailty correction is needed for the population hazard.</p>
</td></tr>
<tr><td><code>dist</code></td>
<td>
<p>For mixture model, it corresponds to the function used to fit
the uncured patients survival. By default, (&quot;weib&quot;) is used. Another option
is the exponentiated Weibull function (&quot;eweib&quot;). For non-mixture models,
this argument corresponds to the name of the model. By default, (&quot;tneh&quot;)
is used to fit the time to null excess hazard model proposed by Boussari
et al.</p>
</td></tr>
<tr><td><code>xmax</code></td>
<td>
<p>maximum follow-up time to evaluate the TTC</p>
</td></tr>
<tr><td><code>z_tau</code></td>
<td>
<p>Covariates acting on parameter tau in non mixture cure model tneh</p>
</td></tr>
<tr><td><code>link_tau</code></td>
<td>
<p>returned  only for model =&quot;tneh&quot;; returned by default is
&quot;linear&quot; or &quot;loglinear&quot; for linear or loglinear link function of covariates
acting on tau parameter.</p>
</td></tr>
<tr><td><code>z_alpha</code></td>
<td>
<p>Covariates acting on parameter alpha in non mixture cure model tneh</p>
</td></tr>
<tr><td><code>z_c</code></td>
<td>
<p>Covariates acting on cure fraction in mixture cure model</p>
</td></tr>
<tr><td><code>z_ucured</code></td>
<td>
<p>covariates acting on survival of uncured in mixture cure model</p>
</td></tr>
<tr><td><code>z_pcured</code></td>
<td>
<p>Covariates acting on cure fraction in mixture cure model</p>
</td></tr>
<tr><td><code>z_ucured</code></td>
<td>
<p>covariates acting on survival of uncured in mixture cure model</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the dataset used to run the model</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the function call based on model</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>the formula as a formula object</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Note that all these models can be fitted in the overall survival
setting.
</p>
<p><code>time</code> is OBLIGATORY in years
</p>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>
<p>Phillips N, Coldman A, McBride ML. Estimating cancer prevalence using
mixture models for cancer survival. Stat Med. 2002 May 15;21(9):1257-70.
doi: 10.1002/sim.1101. PMID: 12111877.
(<a href="https://pubmed.ncbi.nlm.nih.gov/12111877/">pubmed</a>)
</p>
<p>De Angelis R, Capocaccia R, Hakulinen T, Soderman B, Verdecchia A. Mixture
models for cancer survival analysis: application to population-based data
with covariates. Stat Med. 1999 Feb 28;18(4):441-54.
doi: 10.1002/(sici)1097-0258(19990228)18:4&lt;441::aid-sim23&gt;3.0.co;2-m.
PMID: 10070685.
(<a href="https://pubmed.ncbi.nlm.nih.gov/10070685/">pubmed</a>)
</p>
<p>Botta L, Caffo O, Dreassi E, Pizzoli S, Quaglio F, Rugge M, Valsecchi MG.
A new cure model that corrects for increased risk of non-cancer death:
analysis of reliability and robustness, and application to real-life data.
BMC Med Res Methodol. 2023 Mar 25;23(1):70.
doi: 10.1186/s12874-023-01876-x. PMID: N/A.
(<a href="https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/s12874-023-01876-x">pubmed</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.curesurv">predict.curesurv()</a></code>, <code><a href="#topic+print.curesurv">print.curesurv()</a></code>, <code>browseVignettes("curesurv")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library("curesurv")
library("survival")



# Net survival setting
# Mixture cure model with Weibull function for the uncured patients survival:
# no covariate

theta_init2 &lt;- rep(0, 3)
theta_lower2 &lt;- c(-Inf,-Inf,-Inf)
theta_upper2 &lt;- c(Inf, Inf, Inf)


fit_m0_ml &lt;- curesurv(Surv(time_obs, event) ~ 1 | 1,
             pophaz = "ehazard",
             cumpophaz = "cumehazard",
             model = "mixture", dist = "weib",
             data = testiscancer,
             init = list(theta_init = theta_init2,
             theta_lower = theta_lower2,
             theta_upper = theta_upper2),
             method_opt = "L-BFGS-B")
fit_m0_ml



# Mixture cure model with Weibull function for the uncured patients survival:
#standardized age as covariate


fit_m2_ml &lt;- curesurv(Surv(time_obs, event) ~ age_cr | age_cr,
                   pophaz = "ehazard",
                   cumpophaz = "cumehazard",
                   model = "mixture", dist = "weib",
                   data = testiscancer,
                   method_opt = "L-BFGS-B")

 fit_m2_ml



## Non mixture cure model
### TNEH Null model
#### loglinear effect of covariates on time-to-null excess hazard

theta_init2 &lt;- rep(0, 3)
theta_lower2 &lt;- c(-Inf,-Inf,-Inf)
theta_upper2 &lt;- c(Inf, Inf, Inf)

fit_m0_mult_tneh &lt;- curesurv(Surv(time_obs, event) ~ 1,
                          pophaz = "ehazard",
                          cumpophaz = "cumehazard",
                          model = "nmixture",
                          dist = "tneh", link_tau = "loglinear",
                          data = testiscancer,
                          init = list(theta_init = theta_init2,
                                      theta_lower = theta_lower2,
                                      theta_upper = theta_upper2),
                          method_opt = "L-BFGS-B")


fit_m0_mult_tneh

#### Additive parametrization
theta_init2 &lt;- c(1, 6, 6)
theta_lower2 &lt;- c(0,1,0)
theta_upper2 &lt;- c(Inf, Inf, Inf)

fit_m0_ad_tneh &lt;- curesurv(Surv(time_obs, event) ~ 1,
                          pophaz = "ehazard",
                          cumpophaz = "cumehazard",
                          model = "nmixture",
                          dist = "tneh", link_tau = "linear",
                          data = testiscancer,
                          init = list(theta_init = theta_init2,
                                      theta_lower = theta_lower2,
                                      theta_upper = theta_upper2),
                          method_opt = "L-BFGS-B")



 fit_m0_ad_tneh

#### Additive parametrization, with covariates
fit_m1_ad_tneh &lt;- curesurv(Surv(time_obs, event) ~ z_alpha(age_cr) +
                          z_tau(age_cr),
                          pophaz = "ehazard",
                          cumpophaz = "cumehazard",
                          model = "nmixture",
                          dist = "tneh", link_tau = "linear",
                          data = testiscancer,
                          method_opt = "L-BFGS-B")



 fit_m1_ad_tneh




</code></pre>

<hr>
<h2 id='dataweib'>Simulated data with vital status information from Weibull mixture cure model</h2><span id='topic+dataweib'></span>

<h3>Description</h3>

<p>Simulated data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dataweib)
</code></pre>


<h3>Format</h3>

<p>This dataset contains the following variables:
</p>

<dl>
<dt>age</dt><dd><p>Age at diagnosis</p>
</dd>
<dt>age_cr</dt><dd><p>centered and scaled age at diagnosis</p>
</dd>
<dt>age_classe</dt><dd><p>&quot;&lt;45&quot;, &quot;45_59&quot; and  &quot;&gt;=60&quot; age groups </p>
</dd>
<dt>sexe</dt><dd><p>&quot;male&quot;, &quot;female&quot; gender groups </p>
</dd>
<dt>stage</dt><dd><p>&quot;&lt;0&quot;, &quot;1&quot; , &quot;2&quot; and  &quot;3&quot; for stage I-IV groups </p>
</dd>
<dt>time_obs</dt><dd><p>Follow-up time (years)</p>
</dd>
<dt>event</dt><dd><p>Vital status</p>
</dd>
<dt>cumehazard</dt><dd><p>individual cumulative expected hazard</p>
</dd>
<dt>ehazard</dt><dd><p>individual instantaneous expected hazard</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(dataweib)
summary(dataweib)
</code></pre>

<hr>
<h2 id='dexhazdtheta_adtneh2'>dexhazdtheta_adtneh2 function</h2><span id='topic+dexhazdtheta_adtneh2'></span>

<h3>Description</h3>

<p>Partial derivatives of excess hazard
by theta from non-mixture model with distribution &quot;tneh&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dexhazdtheta_adtneh2(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  cumLexctopred = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dexhazdtheta_adtneh2_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="dexhazdtheta_adtneh2_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="dexhazdtheta_adtneh2_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="dexhazdtheta_adtneh2_+3A_object">object</code></td>
<td>
<p>ouput from model implemented in curesurv</p>
</td></tr>
<tr><td><code id="dexhazdtheta_adtneh2_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre-prediction parameter, calculated if NULL</p>
</td></tr>
</table>

<hr>
<h2 id='dexhazdtheta_multneh'>dexhazdtheta_multneh function</h2><span id='topic+dexhazdtheta_multneh'></span>

<h3>Description</h3>

<p>@description Partial derivatives of excess hazard
by theta from non-mixture model with distribution &quot;tneh&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dexhazdtheta_multneh(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  cumLexctopred = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dexhazdtheta_multneh_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="dexhazdtheta_multneh_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="dexhazdtheta_multneh_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="dexhazdtheta_multneh_+3A_object">object</code></td>
<td>
<p>ouput from model implemented in curesurv</p>
</td></tr>
<tr><td><code id="dexhazdtheta_multneh_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre-prediction parameter, calculated if NULL</p>
</td></tr>
</table>

<hr>
<h2 id='dexhazdtheta_wei'>dexhazdtheta_wei function</h2><span id='topic+dexhazdtheta_wei'></span>

<h3>Description</h3>

<p>Produce partial derivatives of excess hazard
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dexhazdtheta_wei(
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x = x,
  theta,
  cumLexctopred
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dexhazdtheta_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="dexhazdtheta_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="dexhazdtheta_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="dexhazdtheta_wei_+3A_theta">theta</code></td>
<td>
<p>estimated parameters from a mixture model using curesurv
and uncured survival following a Weibull distribution</p>
</td></tr>
<tr><td><code id="dexhazdtheta_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained with cumLexc_alphaweibull_topred</p>
</td></tr>
</table>

<hr>
<h2 id='digamma'>digamma function</h2><span id='topic+digamma'></span>

<h3>Description</h3>

<p>digamma function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>digamma(z)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="digamma_+3A_z">z</code></td>
<td>
<p>positive argument</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of type <code>numeric</code>.
This object is a vector of the same length as x.
The output element is :
</p>
<table role = "presentation">
<tr><td><code>psi</code></td>
<td>
<p><code class="reqn">frac{d ln(\tau(x))}{dx} = \frac{\tau'(x)}{\tau(x)}</code>.
This equal to the output of base::digamma(x)</p>
</td></tr>
</table>

<hr>
<h2 id='dlogCumHazdtheta_wei'>dlogCumHazdtheta_wei function</h2><span id='topic+dlogCumHazdtheta_wei'></span>

<h3>Description</h3>

<p>function of partial derivates of log-log of net survival depending on
theta (estimated parameters) from a mixture cure model with uncured survival
following a Weibull distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlogCumHazdtheta_wei(
  z_ucured = z_ucured,
  z_pcured = z_pcured,
  x = x,
  theta = theta,
  cumLexctopred
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlogCumHazdtheta_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="dlogCumHazdtheta_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="dlogCumHazdtheta_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="dlogCumHazdtheta_wei_+3A_theta">theta</code></td>
<td>
<p>estimated parameters from the ouput of a mixture cure model implemented in curesurv</p>
</td></tr>
<tr><td><code id="dlogCumHazdtheta_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre-prediction parameter obtained with cumLexc_alphaweibull_topred</p>
</td></tr>
</table>

<hr>
<h2 id='dloglogpdtheta_wei'>dloglogpdtheta_wei function</h2><span id='topic+dloglogpdtheta_wei'></span>

<h3>Description</h3>

<p>Produce partial derivatives of log(log(p(t)))) the logarithm of the
probability to be cured
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dloglogpdtheta_wei(
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x = x,
  theta,
  cumLexctopred
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dloglogpdtheta_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="dloglogpdtheta_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="dloglogpdtheta_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="dloglogpdtheta_wei_+3A_theta">theta</code></td>
<td>
<p>estimated parameters of the cumulative excess hazard from a mixture
model using curesurv and uncured survival following a Weibull distribution</p>
</td></tr>
<tr><td><code id="dloglogpdtheta_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre-prediction parameter obtained with cumLexc_alphaweibull_topred</p>
</td></tr>
</table>

<hr>
<h2 id='dlogpdtheta_wei'>dlogpdtheta_wei function</h2><span id='topic+dlogpdtheta_wei'></span>

<h3>Description</h3>

<p>Produce partial derivatives of log(p(t)) the logarithm of the
probability to be cured
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlogpdtheta_wei(
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x = x,
  theta,
  cumLexctopred
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlogpdtheta_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="dlogpdtheta_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="dlogpdtheta_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="dlogpdtheta_wei_+3A_theta">theta</code></td>
<td>
<p>estimated parameters of the cumulative excess hazard from a mixture
model using curesurv and uncured survival following a Weibull distribution</p>
</td></tr>
<tr><td><code id="dlogpdtheta_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre-prediction parameter obtained with cumLexc_alphaweibull_topred</p>
</td></tr>
</table>

<hr>
<h2 id='dlogsndtheta_wei'>dlogsndtheta_wei function</h2><span id='topic+dlogsndtheta_wei'></span>

<h3>Description</h3>

<p>function of partial derivates of log of net survival depending on
theta (estimated parameters) from a mixture cure model with uncured survival
following a Weibull distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlogsndtheta_wei(
  z_ucured = z_ucured,
  z_pcured = z_pcured,
  x = x,
  theta = theta,
  cumLexctopred
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlogsndtheta_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="dlogsndtheta_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="dlogsndtheta_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="dlogsndtheta_wei_+3A_theta">theta</code></td>
<td>
<p>estimated parameters from the ouput of a mixture cure model implemented in curesurv</p>
</td></tr>
<tr><td><code id="dlogsndtheta_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre-prediction parameter obtained with cumLexc_alphaweibull_topred</p>
</td></tr>
</table>

<hr>
<h2 id='dlogTTCdtheta_wei'>dlogTTCdtheta_wei function</h2><span id='topic+dlogTTCdtheta_wei'></span>

<h3>Description</h3>

<p>function of partial derivates of log of time-to-cure <code>log(TTC)</code>
by theta (estimated parameters) from a mixture cure model with uncured survival
following a Weibull distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlogTTCdtheta_wei(
  z_ucured = z_ucured,
  z_pcured = z_pcured,
  object = object,
  epsilon = epsilon,
  TTC
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlogTTCdtheta_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="dlogTTCdtheta_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="dlogTTCdtheta_wei_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="dlogTTCdtheta_wei_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
<tr><td><code id="dlogTTCdtheta_wei_+3A_ttc">TTC</code></td>
<td>
<p>time to cure previsouly estimated by TTC_wei</p>
</td></tr>
</table>

<hr>
<h2 id='dpdtheta_adtneh2'>dpdtheta_adtneh2 function</h2><span id='topic+dpdtheta_adtneh2'></span>

<h3>Description</h3>

<p>Partial derivatives of probability to be cure by theta from
non-mixture model with distribution &quot;tneh&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpdtheta_adtneh2(
  z_alpha = z_alpha,
  z_tau = z_tau,
  x = x,
  object,
  cumLexctopred = NULL,
  Dpi = NULL,
  Dsn = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dpdtheta_adtneh2_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="dpdtheta_adtneh2_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="dpdtheta_adtneh2_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="dpdtheta_adtneh2_+3A_object">object</code></td>
<td>
<p>ouput from model implemented in curesurv</p>
</td></tr>
<tr><td><code id="dpdtheta_adtneh2_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre-prediction obtained with cumLexc_ad2_topred, if NULL will be calculated</p>
</td></tr>
<tr><td><code id="dpdtheta_adtneh2_+3A_dpi">Dpi</code></td>
<td>
<p>partial derivatives of pi the cure proportion by theta calculated by dpidtheta_adtneh2, if NULL will be calculated</p>
</td></tr>
<tr><td><code id="dpdtheta_adtneh2_+3A_dsn">Dsn</code></td>
<td>
<p>partial derivatives of net survival by theta calculated by dsndtheta_adtneh2, if NULL will be calculated</p>
</td></tr>
</table>

<hr>
<h2 id='dpdtheta_wei'>dpdtheta_wei function</h2><span id='topic+dpdtheta_wei'></span>

<h3>Description</h3>

<p>Produce partial derivatives of p(t) the probability to be cured
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpdtheta_wei(
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x = x,
  theta,
  cumLexctopred
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dpdtheta_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="dpdtheta_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="dpdtheta_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="dpdtheta_wei_+3A_theta">theta</code></td>
<td>
<p>estimated parameters from a mixture model using curesurv
and uncured survival following a Weibull distribution</p>
</td></tr>
<tr><td><code id="dpdtheta_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>description</p>
</td></tr>
</table>

<hr>
<h2 id='dpidtheta_adtneh2'>dpidtheta_adtneh2 function</h2><span id='topic+dpidtheta_adtneh2'></span>

<h3>Description</h3>

<p>Partial derivatives of pi (net survival at tau) by theta
</p>
<p>#' @description Partial derivatives of cure fraction (or net survival at tau)
by theta from non-mixture model with distribution &quot;tneh&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpidtheta_adtneh2(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  cumLexctopred = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dpidtheta_adtneh2_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="dpidtheta_adtneh2_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="dpidtheta_adtneh2_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="dpidtheta_adtneh2_+3A_object">object</code></td>
<td>
<p>ouput from model implemented in curesurv</p>
</td></tr>
<tr><td><code id="dpidtheta_adtneh2_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction (obtained from cumLexc_ad2_topred), if NULL then it is calculated</p>
</td></tr>
</table>

<hr>
<h2 id='dpidtheta_multneh'>dpidtheta_multneh function</h2><span id='topic+dpidtheta_multneh'></span>

<h3>Description</h3>

<p>@description Partial derivatives of cure fraction (or net survival at tau)
by theta from non-mixture model with distribution &quot;tneh&quot; when link_tau=&quot;loglinear&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpidtheta_multneh(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  cumLexctopred = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dpidtheta_multneh_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="dpidtheta_multneh_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="dpidtheta_multneh_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="dpidtheta_multneh_+3A_object">object</code></td>
<td>
<p>ouput from model implemented in curesurv</p>
</td></tr>
<tr><td><code id="dpidtheta_multneh_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained from cumLexc_mul_topred, calculated if NULL</p>
</td></tr>
</table>

<hr>
<h2 id='dpidtheta_wei'>dpitheta_wei function</h2><span id='topic+dpidtheta_wei'></span>

<h3>Description</h3>

<p>Produce partial derivatives of pi the cure proportion
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpidtheta_wei(
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x = x,
  theta,
  cumLexctopred
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dpidtheta_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="dpidtheta_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="dpidtheta_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="dpidtheta_wei_+3A_theta">theta</code></td>
<td>
<p>estimated parameters from a mixture model using curesurv
and uncured survival following a Weibull distribution</p>
</td></tr>
<tr><td><code id="dpidtheta_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>description</p>
</td></tr>
</table>

<hr>
<h2 id='dptdtheta_multneh'>dptdtheta_multneh function</h2><span id='topic+dptdtheta_multneh'></span>

<h3>Description</h3>

<p>Partial derivatives of probability to be cure by theta from
non-mixture model with distribution &quot;tneh&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dptdtheta_multneh(
  z_alpha = z_alpha,
  z_tau = z_tau,
  x = x,
  object,
  cumLexctopred = NULL,
  Dpi = NULL,
  Dsn = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dptdtheta_multneh_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="dptdtheta_multneh_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="dptdtheta_multneh_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="dptdtheta_multneh_+3A_object">object</code></td>
<td>
<p>ouput from model implemented in curesurv</p>
</td></tr>
<tr><td><code id="dptdtheta_multneh_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained from cumLexc_mul_topred, if NULL will be calculated</p>
</td></tr>
<tr><td><code id="dptdtheta_multneh_+3A_dpi">Dpi</code></td>
<td>
<p>partial derivative of pi according to theta, if NULL will be calculated</p>
</td></tr>
<tr><td><code id="dptdtheta_multneh_+3A_dsn">Dsn</code></td>
<td>
<p>partial derivative of net survival according to theta , if NULL will be calculated</p>
</td></tr>
</table>

<hr>
<h2 id='dpttcdtheta_adtneh2'>dpttcdtheta_adtneh2 function</h2><span id='topic+dpttcdtheta_adtneh2'></span>

<h3>Description</h3>

<p>Partial derivatives of probability to be cure by theta which
can be evaluated at t = TTC, from predictions based on non-mixture model
with distribution &quot;tneh&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpttcdtheta_adtneh2(
  z_tau,
  z_alpha,
  x = x,
  object,
  cumLexctopred = NULL,
  Dpi = NULL,
  Dsn = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dpttcdtheta_adtneh2_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="dpttcdtheta_adtneh2_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="dpttcdtheta_adtneh2_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="dpttcdtheta_adtneh2_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="dpttcdtheta_adtneh2_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre-prediction parameter obtained with cumLexc_ad2_topred, if NULL will be calculated</p>
</td></tr>
<tr><td><code id="dpttcdtheta_adtneh2_+3A_dpi">Dpi</code></td>
<td>
<p>partial derivative of pi according to theta at time TTC, if NULL will be calculated</p>
</td></tr>
<tr><td><code id="dpttcdtheta_adtneh2_+3A_dsn">Dsn</code></td>
<td>
<p>partial derivative of net survival according to theta at time TTC, if NULL will be calculated</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='dpttcdtheta_multneh'>dpttcdtheta_adtneh2 function</h2><span id='topic+dpttcdtheta_multneh'></span>

<h3>Description</h3>

<p>Partial derivatives of probability to be cure by theta which
can be evaluated at t = TTC, from predictions based on non-mixture model
with distribution &quot;tneh&quot;, link=&quot;loglinear&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpttcdtheta_multneh(
  z_tau,
  z_alpha,
  x = x,
  object,
  res_pred = NULL,
  Dpi = NULL,
  Dsn = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dpttcdtheta_multneh_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="dpttcdtheta_multneh_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="dpttcdtheta_multneh_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="dpttcdtheta_multneh_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="dpttcdtheta_multneh_+3A_res_pred">res_pred</code></td>
<td>
<p>a pre prediction parameter obtained with cumLexc_mul_topred</p>
</td></tr>
<tr><td><code id="dpttcdtheta_multneh_+3A_dpi">Dpi</code></td>
<td>
<p>Partial derivatives of Pi at time TTC, if NULL then calculated</p>
</td></tr>
<tr><td><code id="dpttcdtheta_multneh_+3A_dsn">Dsn</code></td>
<td>
<p>Partial derivatives of net survival at time TTC, if NULL then calculated</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='dsndtheta_adtneh2'>dsndtheta_adtneh2 function</h2><span id='topic+dsndtheta_adtneh2'></span>

<h3>Description</h3>

<p>Partial derivatives of sn (net survival) by theta
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dsndtheta_adtneh2(z_tau, z_alpha, x, object, cumLexctopred = NULL, Dpi = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dsndtheta_adtneh2_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="dsndtheta_adtneh2_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="dsndtheta_adtneh2_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="dsndtheta_adtneh2_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="dsndtheta_adtneh2_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction thing (obtained from cumLexc_ad2_topred), if NULL then it is calculated</p>
</td></tr>
<tr><td><code id="dsndtheta_adtneh2_+3A_dpi">Dpi</code></td>
<td>
<p>partial derivates of pi according to theta, if NULL it is calculated</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='dsndtheta_multneh'>dsndtheta_multneh function</h2><span id='topic+dsndtheta_multneh'></span>

<h3>Description</h3>

<p>Partial derivatives of sn (net survival) by theta for the link_tau=&quot;loglinear&quot; model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dsndtheta_multneh(z_tau, z_alpha, x, object, cumLexctopred = NULL, Dpi = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dsndtheta_multneh_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="dsndtheta_multneh_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="dsndtheta_multneh_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="dsndtheta_multneh_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="dsndtheta_multneh_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained from cumLexc_mul_topred, estimated if NULL</p>
</td></tr>
<tr><td><code id="dsndtheta_multneh_+3A_dpi">Dpi</code></td>
<td>
<p>partial derivative of pi according to theta, if NULL will be calculated</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='dsndtheta_wei'>dsndtheta_wei function</h2><span id='topic+dsndtheta_wei'></span>

<h3>Description</h3>

<p>function of partial derivates of net survival depending on
theta (estimated parameters) from a mixture cure model with uncured survival
following a Weibull distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dsndtheta_wei(
  z_ucured = z_ucured,
  z_pcured = z_pcured,
  x = x,
  theta = theta,
  cumLexctopred
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dsndtheta_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="dsndtheta_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="dsndtheta_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="dsndtheta_wei_+3A_theta">theta</code></td>
<td>
<p>estimated parameters from the ouput of a mixture cure model implemented in curesurv</p>
</td></tr>
<tr><td><code id="dsndtheta_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained with cumLexc_alphaweibull_topred</p>
</td></tr>
</table>

<hr>
<h2 id='dTTCdtheta_wei'>dTTCdtheta_wei function</h2><span id='topic+dTTCdtheta_wei'></span>

<h3>Description</h3>

<p>function of partial derivates of time-to-cure (TTC) by theta
(estimated parameters) from a mixture cure model with uncured survival
following a Weibull distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dTTCdtheta_wei(
  z_ucured = z_ucured,
  z_pcured = z_pcured,
  theta = theta,
  epsilon = epsilon,
  TTC
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dTTCdtheta_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="dTTCdtheta_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="dTTCdtheta_wei_+3A_theta">theta</code></td>
<td>
<p>estimated parameters from the ouput of a mixture cure model implemented in curesurv</p>
</td></tr>
<tr><td><code id="dTTCdtheta_wei_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
<tr><td><code id="dTTCdtheta_wei_+3A_ttc">TTC</code></td>
<td>
<p>time-to-cure previously estimated using TTC_wei</p>
</td></tr>
</table>

<hr>
<h2 id='exhaz_ic_adtneh2'>exhaz_ic_adtneh2 function</h2><span id='topic+exhaz_ic_adtneh2'></span>

<h3>Description</h3>

<p>produces confidence interval of excess hazard using a
time-to-null excess hazard model with linear effect on parameter tau
The confidence intervals calculation is based on the plain method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exhaz_ic_adtneh2(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  level = level,
  Dexhaz = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exhaz_ic_adtneh2_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="exhaz_ic_adtneh2_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="exhaz_ic_adtneh2_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="exhaz_ic_adtneh2_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="exhaz_ic_adtneh2_+3A_level">level</code></td>
<td>
<p><code>(1-alpha/2)</code>-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="exhaz_ic_adtneh2_+3A_dexhaz">Dexhaz</code></td>
<td>
<p>parital derivatives of exess hazard wrt theta obtained by dexhazdtheta_adtneh2, calculated if not given</p>
</td></tr>
</table>

<hr>
<h2 id='exhaz_ic_adtneh2_log'>exhaz_ic_adtneh2_log function</h2><span id='topic+exhaz_ic_adtneh2_log'></span>

<h3>Description</h3>

<p>produces confidence interval of excess hazard using a
time-to-null excess hazard model with linear effect on parameter tau
The confidence intervals calculation is based on the log method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exhaz_ic_adtneh2_log(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  level = level,
  Dexhaz = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exhaz_ic_adtneh2_log_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="exhaz_ic_adtneh2_log_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="exhaz_ic_adtneh2_log_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="exhaz_ic_adtneh2_log_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="exhaz_ic_adtneh2_log_+3A_level">level</code></td>
<td>
<p><code>(1-alpha/2)</code>-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="exhaz_ic_adtneh2_log_+3A_dexhaz">Dexhaz</code></td>
<td>
<p>parital derivatives of exess hazard wrt theta obtained by dexhazdtheta_adtneh2, calculated if not given</p>
</td></tr>
</table>

<hr>
<h2 id='exhaz_ic_adtneh2_loglog'>exhaz_ic_adtneh2_loglog function</h2><span id='topic+exhaz_ic_adtneh2_loglog'></span>

<h3>Description</h3>

<p>produces confidence interval of excess hazard using a
time-to-null excess hazard model with linear effect on parameter tau
The confidence intervals calculation is based on the log-log method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exhaz_ic_adtneh2_loglog(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  level = level,
  Dexhaz = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exhaz_ic_adtneh2_loglog_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="exhaz_ic_adtneh2_loglog_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="exhaz_ic_adtneh2_loglog_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="exhaz_ic_adtneh2_loglog_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="exhaz_ic_adtneh2_loglog_+3A_level">level</code></td>
<td>
<p><code>(1-alpha/2)</code>-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="exhaz_ic_adtneh2_loglog_+3A_dexhaz">Dexhaz</code></td>
<td>
<p>parital derivatives of exess hazard wrt theta obtained by dexhazdtheta_adtneh2, calculated if not given</p>
</td></tr>
</table>

<hr>
<h2 id='exhaz_ic_multneh'>exhaz_ic_multneh function</h2><span id='topic+exhaz_ic_multneh'></span>

<h3>Description</h3>

<p>produces confidence interval of excess hazard using a
time-to-null excess hazard model with loglinear effect on parameter tau
The confidence intervals calculation is based on the plain method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exhaz_ic_multneh(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  level = level,
  Dexhaz = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exhaz_ic_multneh_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="exhaz_ic_multneh_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="exhaz_ic_multneh_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="exhaz_ic_multneh_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="exhaz_ic_multneh_+3A_level">level</code></td>
<td>
<p><code>(1-alpha/2)</code>-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="exhaz_ic_multneh_+3A_dexhaz">Dexhaz</code></td>
<td>
<p>parital derivatives of exess hazard wrt theta obtained by dexhazdtheta_multneh, calculated if not given</p>
</td></tr>
</table>

<hr>
<h2 id='exhaz_ic_multneh_log'>exhaz_ic_multneh_log function</h2><span id='topic+exhaz_ic_multneh_log'></span>

<h3>Description</h3>

<p>produces confidence interval of excess hazard using a
time-to-null excess hazard model with loglinear effect on parameter tau
The confidence intervals calculation is based on the log method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exhaz_ic_multneh_log(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  level = level,
  Dexhaz = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exhaz_ic_multneh_log_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="exhaz_ic_multneh_log_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="exhaz_ic_multneh_log_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="exhaz_ic_multneh_log_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="exhaz_ic_multneh_log_+3A_level">level</code></td>
<td>
<p><code>(1-alpha/2)</code>-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="exhaz_ic_multneh_log_+3A_dexhaz">Dexhaz</code></td>
<td>
<p>parital derivatives of exess hazard wrt theta obtained by dexhazdtheta_multneh, calculated if not given</p>
</td></tr>
</table>

<hr>
<h2 id='exhaz_ic_multneh_loglog'>exhaz_ic_multneh_loglog function</h2><span id='topic+exhaz_ic_multneh_loglog'></span>

<h3>Description</h3>

<p>produces confidence interval of excess hazard using a
time-to-null excess hazard model with loglinear effect on parameter tau
The confidence intervals calculation is based on the log-log method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exhaz_ic_multneh_loglog(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  level = level,
  Dexhaz = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exhaz_ic_multneh_loglog_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="exhaz_ic_multneh_loglog_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="exhaz_ic_multneh_loglog_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="exhaz_ic_multneh_loglog_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="exhaz_ic_multneh_loglog_+3A_level">level</code></td>
<td>
<p><code>(1-alpha/2)</code>-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="exhaz_ic_multneh_loglog_+3A_dexhaz">Dexhaz</code></td>
<td>
<p>parital derivatives of exess hazard wrt theta obtained by dexhazdtheta_multneh, calculated if not given</p>
</td></tr>
</table>

<hr>
<h2 id='exhaz_ic_wei'>exhaz_ic_wei function</h2><span id='topic+exhaz_ic_wei'></span>

<h3>Description</h3>

<p>Calculates the confidence intervals of excess hazard by Delta Method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exhaz_ic_wei(
  object,
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x,
  level,
  cumLexctopred,
  Dexhaz,
  exhaz
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exhaz_ic_wei_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained with cumLexc_alphaweibull_topred</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_+3A_dexhaz">Dexhaz</code></td>
<td>
<p>partial derivatives of exhaz</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_+3A_exhaz">exhaz</code></td>
<td>
<p>estimation of exhaz</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='exhaz_ic_wei_log'>exhaz_ic_wei_log function</h2><span id='topic+exhaz_ic_wei_log'></span>

<h3>Description</h3>

<p>Calculates the confidence intervals of excess hazard by &quot;log&quot; Delta Method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exhaz_ic_wei_log(
  object,
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x,
  level,
  cumLexctopred,
  Dexhaz,
  exhaz
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exhaz_ic_wei_log_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_log_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_log_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_log_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_log_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_log_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained with cumLexc_alphaweibull_topred</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_log_+3A_dexhaz">Dexhaz</code></td>
<td>
<p>partial derivatives of exhaz</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_log_+3A_exhaz">exhaz</code></td>
<td>
<p>estimation of exhaz</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='exhaz_ic_wei_loglog'>exhaz_ic_wei_loglog function</h2><span id='topic+exhaz_ic_wei_loglog'></span>

<h3>Description</h3>

<p>Calculates the confidence intervals of excess hazard by &quot;log-log&quot; Delta Method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exhaz_ic_wei_loglog(
  object,
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x,
  level,
  cumLexctopred,
  Dexhaz,
  exhaz
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exhaz_ic_wei_loglog_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_loglog_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_loglog_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_loglog_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_loglog_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_loglog_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained with cumLexc_alphaweibull_topred</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_loglog_+3A_dexhaz">Dexhaz</code></td>
<td>
<p>partial derivatives of exhaz</p>
</td></tr>
<tr><td><code id="exhaz_ic_wei_loglog_+3A_exhaz">exhaz</code></td>
<td>
<p>estimation of exhaz</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='inc.beta.deriv'>inc_beta_deriv function</h2><span id='topic+inc.beta.deriv'></span>

<h3>Description</h3>

<p>computes the first and second derivatives of incomplete Beta
function with respect of Beta parameters p and or q using algorithm
differentiating the aproximants of <code class="reqn">I_{x,p,q}</code> formula in terms of forward
recurrence relations where the the <code class="reqn">n^{th}</code> approximant can be expressed as :
</p>
<p style="text-align: center;"><code class="reqn"> I_{x,p,q} \approx  K_{x,p,q} A_n/B_n</code>
</p>
<p>, <code class="reqn">n \geq 1</code>
</p>
<p>This technique was proposed by Moore (1982) to calculate the derivatives of
incomplete gamma function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inc.beta.deriv(
  x,
  p = stop("p must be specified"),
  q = stop("q must be specified"),
  err = .Machine$double.eps * 10000,
  minapp = 2,
  maxapp = 1000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inc.beta.deriv_+3A_x">x</code></td>
<td>
<p>vector of length k containing values to which the beta function is
to be integrated</p>
</td></tr>
<tr><td><code id="inc.beta.deriv_+3A_p">p</code></td>
<td>
<p>Beta shape1 parameter</p>
</td></tr>
<tr><td><code id="inc.beta.deriv_+3A_q">q</code></td>
<td>
<p>Beta shape2 parameter. shape1 and shape2 can be vertors in the same
dimension as x or scalars</p>
</td></tr>
<tr><td><code id="inc.beta.deriv_+3A_err">err</code></td>
<td>
<p>value for error</p>
</td></tr>
<tr><td><code id="inc.beta.deriv_+3A_minapp">minapp</code></td>
<td>
<p>minimal bound value</p>
</td></tr>
<tr><td><code id="inc.beta.deriv_+3A_maxapp">maxapp</code></td>
<td>
<p>external noud value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>FD.inc.beta</code>.
This object is a list containing 15 components. The first 13 components in
the list are each a vector of the same length as x (u in the model). The two
last elements are scalar terms. The output elements are:
</p>
<table role = "presentation">
<tr><td><code>I</code></td>
<td>
<p><code class="reqn">I_{x,p,q}</code>. This equal to the output of
<code>pbeta(x,shape1,shape2)</code></p>
</td></tr>
<tr><td><code>Ip</code></td>
<td>
<p><code class="reqn">I_{x,p,q}^{p}</code> denotes the first derivative of the incomplete
beta function with respect to p</p>
</td></tr>
<tr><td><code>Ipp</code></td>
<td>
<p><code class="reqn">I_{x,p,q}^{pp}</code> denotes the second derivative of the incomplete
beta function with respect to p</p>
</td></tr>
<tr><td><code>Iq</code></td>
<td>
<p><code class="reqn">I_{x,p,q}^{q}</code> denotes the first derivative of the incomplete
beta function with respect to q</p>
</td></tr>
<tr><td><code>Iqq</code></td>
<td>
<p><code class="reqn">I_{x,p,q}^{qq}</code> denotes the second derivative of the incomplete
beta function with respect to q</p>
</td></tr>
<tr><td><code>Ipq</code></td>
<td>
<p><code class="reqn">I_{x,p,q}^{pq}</code> denotes the first derivative of the incomplete
beta function with respect to p and q</p>
</td></tr>
<tr><td><code>log.Beta</code></td>
<td>
<p><code class="reqn">\log[\mathrm{Beta}(p,q)]</code></p>
</td></tr>
<tr><td><code>digamma.p</code></td>
<td>
<p><code class="reqn">\psi_p</code></p>
</td></tr>
<tr><td><code>trigamma.p</code></td>
<td>
<p><code class="reqn">\psi_p'</code></p>
</td></tr>
<tr><td><code>digamma.q</code></td>
<td>
<p><code class="reqn">\psi_q</code></p>
</td></tr>
<tr><td><code>trigamma.q</code></td>
<td>
<p><code class="reqn">\psi_q'</code></p>
</td></tr>
<tr><td><code>digamma.pq</code></td>
<td>
<p><code class="reqn">\psi_{p+q}</code></p>
</td></tr>
<tr><td><code>trigamma.pq</code></td>
<td>
<p><code class="reqn">\psi_{p+q}'</code></p>
</td></tr>
<tr><td><code>nappx</code></td>
<td>
<p> highest order approximant evaluated. Iteration stops if
nappx&gt;maxappx</p>
</td></tr>
<tr><td><code>errapx</code></td>
<td>
<p>approximate maximum absolute error of computed derivatives</p>
</td></tr>
</table>


<h3>References</h3>

<p>Boik, Robert J., and James F. Robison-Cox. &quot;Derivatives of the
incomplete beta function.&quot; Journal of Statistical Software 3.1 (1998): 1-20.
(<a href="https://www.jstatsoft.org/htaccess.php?volume=003&amp;type=i&amp;issue=01&amp;filename=paper">arXiv</a>)
</p>

<hr>
<h2 id='lexc_alphaeweibull'>lexc_alphaeweibull function</h2><span id='topic+lexc_alphaeweibull'></span>

<h3>Description</h3>

<p>calculates the instantaneous excess hazard from an exponentiated Weibull distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lexc_alphaeweibull(
  z_ucured = z_ucured,
  z_pcured = z_pcured,
  x = x,
  theta = theta,
  sign_delta = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lexc_alphaeweibull_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="lexc_alphaeweibull_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion.</p>
</td></tr>
<tr><td><code id="lexc_alphaeweibull_+3A_x">x</code></td>
<td>
<p>the time arguments at which to calculate the cumulative excess hazard</p>
</td></tr>
<tr><td><code id="lexc_alphaeweibull_+3A_theta">theta</code></td>
<td>
<p>the parameters of the cumulative excess hazard from an exponentiated Weibull distribution</p>
</td></tr>
<tr><td><code id="lexc_alphaeweibull_+3A_sign_delta">sign_delta</code></td>
<td>
<p>only used for mixture cure rate models to specify if the
effects or minus the effects of covariates acting on uncured survival to be
considered. Default will be sign_delta = &quot;1&quot;. The alternative is
sign_delta = &quot;-1&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>curesurv</code>.
This object is a vector containing:
</p>


<h3>References</h3>

<p>Mudholkar, G.S. and Srivastava, D.K. (1993).
Exponentiated Weibull family for analyzing bathtub failure-rate data,
IEEE Transactions on Reliability, 42, 299-302.
</p>
<p>Mudholkar, G.S., Srivastava, D.K., and Freimer, M. (1995). The exponentiated
Weibull family: a reanalysis of the bus-motor-failure data,
Technometrics, 37, 436445.doi:10.2307/1269735
(<a href="https://www.jstor.org/stable/1269735">jstor</a>)
</p>

<hr>
<h2 id='lexc_alphaweibull'>lexc_alphaweibull function</h2><span id='topic+lexc_alphaweibull'></span>

<h3>Description</h3>

<p>calculates the instantaneous excess hazard from a Weibull distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lexc_alphaweibull(
  z_ucured = z_ucured,
  z_pcured = z_pcured,
  x = x,
  theta = theta,
  sign_delta = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lexc_alphaweibull_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="lexc_alphaweibull_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion.</p>
</td></tr>
<tr><td><code id="lexc_alphaweibull_+3A_x">x</code></td>
<td>
<p>the time arguments at which to calculate the cumulative excess hazard</p>
</td></tr>
<tr><td><code id="lexc_alphaweibull_+3A_theta">theta</code></td>
<td>
<p>the parameters of the cumulative excess hazard from a
Weibull distribution</p>
</td></tr>
<tr><td><code id="lexc_alphaweibull_+3A_sign_delta">sign_delta</code></td>
<td>
<p>only used for mixture cure rate models to specify if the
effects or minus the effects of covariates acting on uncured survival to be
considered. Default will be sign_delta = &quot;1&quot;. The alternative is
sign_delta = &quot;-1&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>curesurv</code>.
This object is a vector containing:
</p>


<h3>References</h3>

<p>Mudholkar, G.S. and Srivastava, D.K. (1993).
Exponentiated Weibull family for analyzing bathtub failure-rate data,
IEEE Transactions on Reliability, 42, 299302.
</p>
<p>Mudholkar, G.S., Srivastava, D.K., and Freimer, M. (1995). The exponentiated
Weibull family: a reanalysis of the bus-motor-failure data,
Technometrics, 37, 436-445.doi:10.2307/1269735
(<a href="https://www.jstor.org/stable/1269735">jstor</a>)
</p>

<hr>
<h2 id='logCumHaz_ic_wei'>logCumHaz_ic_wei function</h2><span id='topic+logCumHaz_ic_wei'></span>

<h3>Description</h3>

<p>calculates the confidence intervals of the log of cumulative excess hazard log(-log(Sn(t)))
using variances of log(-log(Sn(t))). In this formula, the variance of log of
the cumulative excess hazard is obtained using delta method at the scale of log-log of net survival, and with
the expression Var(log(log(Sn(t)))) = (dlog(-log(Sn(t)))/dtheta)Var(theta)(dlog(-log(Sn(t)))/dtheta)^T;
the Var(theta) is the variance-covariance matrix of theta (estimated parameters).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logCumHaz_ic_wei(
  object,
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x,
  level,
  cumLexctopred
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logCumHaz_ic_wei_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="logCumHaz_ic_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="logCumHaz_ic_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="logCumHaz_ic_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="logCumHaz_ic_wei_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="logCumHaz_ic_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre prediction obtained with cumLexc_alphaweibull</p>
</td></tr>
</table>

<hr>
<h2 id='pancreas_data'>Simulated pancreas data with vital status information</h2><span id='topic+pancreas_data'></span>

<h3>Description</h3>

<p>Simulated data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pancreas_data)
</code></pre>


<h3>Format</h3>

<p>This dataset contains the following variables:
</p>

<dl>
<dt>age</dt><dd><p>Age at diagnosis</p>
</dd>
<dt>age_cr</dt><dd><p>centered and scaled age at diagnosis</p>
</dd>
<dt>age_classe</dt><dd><p>&quot;&lt;45&quot;, &quot;45_59&quot; and  &quot;&gt;=60&quot; age groups </p>
</dd>
<dt>time_obs</dt><dd><p>Follow-up time (years)</p>
</dd>
<dt>event</dt><dd><p>Vital status</p>
</dd>
<dt>cumehazard</dt><dd><p>individual cumulative expected hazard</p>
</dd>
<dt>ehazard</dt><dd><p>individual instantaneous expected hazard</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(pancreas_data)
summary(pancreas_data)
</code></pre>

<hr>
<h2 id='pcured'>pcured function</h2><span id='topic+pcured'></span>

<h3>Description</h3>

<p>calculates cure fraction of mixture and non mixture cure models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcured(
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcured_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="pcured_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="pcured_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="pcured_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="pcured_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="pcured_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>c("cure_fraction", "data.frame")</code>.
This object is a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>time</code></td>
<td>
<p>time in the input new data</p>
</td></tr>
<tr><td><code>netsurv</code></td>
<td>
<p>predicted net survival at the time provided in the new data</p>
</td></tr>
<tr><td><code>pi</code></td>
<td>
<p>pi or net survival at time tau</p>
</td></tr>
</table>

<hr>
<h2 id='pi_ic_adtneh2'>pi_ic_adtneh2 function</h2><span id='topic+pi_ic_adtneh2'></span>

<h3>Description</h3>

<p>produces confidence interval of cure fraction pi using a
time-to-null excess hazard model with linear effect on parameter tau
The confidence intervals calculation is based on the plain method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pi_ic_adtneh2(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  level = level,
  cumLexc_topred = NULL,
  Dpi = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pi_ic_adtneh2_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="pi_ic_adtneh2_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="pi_ic_adtneh2_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="pi_ic_adtneh2_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="pi_ic_adtneh2_+3A_level">level</code></td>
<td>
<p><code>(1-alpha/2)</code>-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="pi_ic_adtneh2_+3A_cumlexc_topred">cumLexc_topred</code></td>
<td>
<p>a pre prediction, if NULL it is calculated</p>
</td></tr>
<tr><td><code id="pi_ic_adtneh2_+3A_dpi">Dpi</code></td>
<td>
<p>partial derivative of pi by theta obtained by dpidtheta_adtneh2 function, if NULL it is calculated</p>
</td></tr>
</table>

<hr>
<h2 id='pi_ic_adtneh2_log'>pi_ic_adtneh2_log function</h2><span id='topic+pi_ic_adtneh2_log'></span>

<h3>Description</h3>

<p>produces confidence interval of cure fraction pi using a
time-to-null excess hazard model with linear effect on parameter tau
The confidence intervals based on log method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pi_ic_adtneh2_log(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  level = level,
  cumLexc_topred = NULL,
  Dpi = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pi_ic_adtneh2_log_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="pi_ic_adtneh2_log_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="pi_ic_adtneh2_log_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="pi_ic_adtneh2_log_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="pi_ic_adtneh2_log_+3A_level">level</code></td>
<td>
<p><code>(1-alpha/2)</code>-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="pi_ic_adtneh2_log_+3A_cumlexc_topred">cumLexc_topred</code></td>
<td>
<p>a pre prediction, if NULL it is calculated</p>
</td></tr>
<tr><td><code id="pi_ic_adtneh2_log_+3A_dpi">Dpi</code></td>
<td>
<p>partial derivative of pi by theta obtained by dpidtheta_adtneh2 function, if NULL it is calculated</p>
</td></tr>
</table>

<hr>
<h2 id='pi_ic_adtneh2_loglog'>pi_ic_adtneh2_loglog function</h2><span id='topic+pi_ic_adtneh2_loglog'></span>

<h3>Description</h3>

<p>produces confidence interval of cure fraction pi using a
time-to-null excess hazard model with linear effect on parameter tau
The confidence intervals based on log-log method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pi_ic_adtneh2_loglog(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  level = level,
  cumLexc_topred = NULL,
  Dpi = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pi_ic_adtneh2_loglog_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="pi_ic_adtneh2_loglog_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="pi_ic_adtneh2_loglog_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="pi_ic_adtneh2_loglog_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="pi_ic_adtneh2_loglog_+3A_level">level</code></td>
<td>
<p><code>(1-alpha/2)</code>-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="pi_ic_adtneh2_loglog_+3A_cumlexc_topred">cumLexc_topred</code></td>
<td>
<p>a pre prediction, if NULL it is calculated</p>
</td></tr>
<tr><td><code id="pi_ic_adtneh2_loglog_+3A_dpi">Dpi</code></td>
<td>
<p>partial derivative of pi by theta obtained by dpidtheta_adtneh2 function, if NULL it is calculated</p>
</td></tr>
</table>

<hr>
<h2 id='pi_ic_log_wei'>pi_ic_log_wei function</h2><span id='topic+pi_ic_log_wei'></span>

<h3>Description</h3>

<p>calculates the confidence intervals of the cure proportion pi
using variances of log(pi) by delta method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pi_ic_log_wei(
  object,
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x,
  level,
  cumLexctopred,
  Dpi
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pi_ic_log_wei_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="pi_ic_log_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="pi_ic_log_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="pi_ic_log_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="pi_ic_log_wei_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="pi_ic_log_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre prediction obtained with cumLexc_alphaweibull_topred</p>
</td></tr>
<tr><td><code id="pi_ic_log_wei_+3A_dpi">Dpi</code></td>
<td>
<p>Partial derivative of Pi calculated by dpidtheta_wei function</p>
</td></tr>
</table>

<hr>
<h2 id='pi_ic_loglog_wei'>pi_ic_loglog_wei function</h2><span id='topic+pi_ic_loglog_wei'></span>

<h3>Description</h3>

<p>calculates the confidence intervals of the cure proportion pi
using variances of log(-log(pi)) by delta method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pi_ic_loglog_wei(
  object,
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x,
  level,
  cumLexctopred,
  Dpi
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pi_ic_loglog_wei_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="pi_ic_loglog_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="pi_ic_loglog_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="pi_ic_loglog_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="pi_ic_loglog_wei_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="pi_ic_loglog_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre prediction obtained with cumLexc_alphaweibull_topred</p>
</td></tr>
<tr><td><code id="pi_ic_loglog_wei_+3A_dpi">Dpi</code></td>
<td>
<p>Partial derivative of Pi calculated by dpidtheta_wei function</p>
</td></tr>
</table>

<hr>
<h2 id='pi_ic_multneh'>pi_ic_multneh function</h2><span id='topic+pi_ic_multneh'></span>

<h3>Description</h3>

<p>produces confidence interval of cure fraction pi using a
time-to-null excess hazard model with loglinear effect on parameter tau
The confidence intervals calculation is based on the plain method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pi_ic_multneh(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  level = level,
  cumLexctopred = NULL,
  Dpi = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pi_ic_multneh_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="pi_ic_multneh_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="pi_ic_multneh_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="pi_ic_multneh_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="pi_ic_multneh_+3A_level">level</code></td>
<td>
<p><code>(1-alpha/2)</code>-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="pi_ic_multneh_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained from cumLexc_mul_topred, calculated if NULL</p>
</td></tr>
<tr><td><code id="pi_ic_multneh_+3A_dpi">Dpi</code></td>
<td>
<p>partial derivative of pi according to theta, if NULL calculated</p>
</td></tr>
</table>

<hr>
<h2 id='pi_ic_multneh_log'>pi_ic_multneh_log function</h2><span id='topic+pi_ic_multneh_log'></span>

<h3>Description</h3>

<p>produces confidence interval of cure fraction pi using a
time-to-null excess hazard model with loglinear effect on parameter tau
The confidence intervals based on log method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pi_ic_multneh_log(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  level = level,
  cumLexctopred = NULL,
  Dpi = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pi_ic_multneh_log_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="pi_ic_multneh_log_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="pi_ic_multneh_log_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="pi_ic_multneh_log_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="pi_ic_multneh_log_+3A_level">level</code></td>
<td>
<p><code>(1-alpha/2)</code>-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="pi_ic_multneh_log_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained from cumLexc_mul_topred, calculated if NULL</p>
</td></tr>
<tr><td><code id="pi_ic_multneh_log_+3A_dpi">Dpi</code></td>
<td>
<p>partial derivative of pi according to theta, if NULL calculated</p>
</td></tr>
</table>

<hr>
<h2 id='pi_ic_multneh_loglog'>pi_ic_multneh_loglog function</h2><span id='topic+pi_ic_multneh_loglog'></span>

<h3>Description</h3>

<p>produces confidence interval of cure fraction pi using a
time-to-null excess hazard model with log linear effect on parameter tau
The confidence intervals based on log-log method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pi_ic_multneh_loglog(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  level = level,
  cumLexctopred = NULL,
  Dpi = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pi_ic_multneh_loglog_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="pi_ic_multneh_loglog_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="pi_ic_multneh_loglog_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="pi_ic_multneh_loglog_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="pi_ic_multneh_loglog_+3A_level">level</code></td>
<td>
<p><code>(1-alpha/2)</code>-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="pi_ic_multneh_loglog_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained from cumLexc_mul_topred, calculated if NULL</p>
</td></tr>
<tr><td><code id="pi_ic_multneh_loglog_+3A_dpi">Dpi</code></td>
<td>
<p>partial derivative of pi according to theta, if NULL calculated</p>
</td></tr>
</table>

<hr>
<h2 id='pi_ic_wei'>pi_ic_wei function</h2><span id='topic+pi_ic_wei'></span>

<h3>Description</h3>

<p>Calculates the confidence intervals of the cure proportion
by Delta Method on pi
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pi_ic_wei(
  object,
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x,
  level,
  cumLexctopred,
  Dpi
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pi_ic_wei_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="pi_ic_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="pi_ic_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="pi_ic_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="pi_ic_wei_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="pi_ic_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre-prediction parameter obtained with cumLexc_alphaweibull</p>
</td></tr>
<tr><td><code id="pi_ic_wei_+3A_dpi">Dpi</code></td>
<td>
<p>partial derivatives of pi by theta, obtained with dpidtheta_wei function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste#'
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='plot.predCuresurv'>plot method for curesurv prediction objects</h2><span id='topic+plot.predCuresurv'></span>

<h3>Description</h3>

<p>Produces figures of (excess) hazard, (net) survival and
probability P(t) of being cured at a given time t after diagnosis knowing
that he/she was alive up to time t.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predCuresurv'
plot(
  x,
  fun = "all",
  conf.int = FALSE,
  conf.type = c("log", "log-log", "plain"),
  legend.out = TRUE,
  xlab = "Time since diagnosis",
  ylab.haz = "excess hazard",
  ylab.surv = "net survival",
  ylab.ptcure = "P(t)",
  ylab.cumhaz = "cumulative excess hazard",
  ylab.logcumhaz = "logarithm of cumulative excess hazard",
  col.haz = "black",
  col.surv = "black",
  col.ptcure = "black",
  col.cumhaz = "black",
  col.logcumhaz = "black",
  col.tau = "red",
  col.ttc = "green4",
  col.p95 = "black",
  col.pi = "blue",
  lty.surv = 1,
  lty.haz = 1,
  lty.ptcure = 1,
  lty.cumhaz = 1,
  lty.logcumhaz = 1,
  lty.pi = 2,
  lty.tau = 2,
  lty.ttc = 3,
  lty.p95 = 4,
  lty.ic = 5,
  lwd.main = 1,
  lwd.sub = 1,
  lwd.ic = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.predCuresurv_+3A_x">x</code></td>
<td>
<p>result of the <code>predCuresurv</code> function</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_fun">fun</code></td>
<td>
<p>in &quot;haz&quot; or &quot;surv&quot; or &quot;pt_cure&quot;, &quot;cumhaz&quot;, &quot;logcumhaz&quot;, the plot
produced is that of (excess) hazard, or that of (net) survival, or that of
the probability P(t) of being cured at a given time t after diagnosis
knowing that he/she was alive up to time t is provided, or that of
cumulative hazard or that of the logarithm of the cumulative hazard; if
<code>fun = "all"</code>, the plots of the three first indicators are produced.</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_conf.int">conf.int</code></td>
<td>
<p>an argument expected to be TRUE if the confidence intervals of the
related-indicator specified by the argument &quot;fun&quot; are needed. The default
option is FALSE. Confidence intervals are not available for <code>fun="cumhaz"</code> and <code>fun="logcumhaz"</code></p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_conf.type">conf.type</code></td>
<td>
<p>One of &quot;plain&quot;, &quot;log&quot;, &quot;log-log&quot;.
The first option causes the standard intervals curve +- k *se(curve),
where k is determined from conf.int. The log option calculates intervals
based on log(curve). The log-log option bases
the intervals on the log(-log(curve)).</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_legend.out">legend.out</code></td>
<td>
<p>an argument deciding the place of the legend if <code>fun="all"</code>.
The default value is TRUE and forces most of the legend on the empty bottom-right plot slot.
If value is FALSE, the legend will be printed entirely in each subplot.</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_xlab">xlab</code></td>
<td>
<p>label for the x-axis of the plot.</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_ylab.haz">ylab.haz</code></td>
<td>
<p>optional label for the y-axis of the plot of excess hazard</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_ylab.surv">ylab.surv</code></td>
<td>
<p>optional label for the y-axis of the plot of net survival</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_ylab.ptcure">ylab.ptcure</code></td>
<td>
<p>optional label for the y-axis of the plot of the probability
<code>P(t)</code> of being cured at a given time t after diagnosis knowing that
he/she was alive up to time t</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_ylab.cumhaz">ylab.cumhaz</code></td>
<td>
<p>optional label for the y-axis of the plot of cumulative excess hazard</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_ylab.logcumhaz">ylab.logcumhaz</code></td>
<td>
<p>optional label for the y-axis of the plot of logarithm of cumulative excess hazard</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_col.haz">col.haz</code></td>
<td>
<p>optional argument to specify the color of curve of the excess hazard</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_col.surv">col.surv</code></td>
<td>
<p>optional argument to specify the color of curve of the net survival</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_col.ptcure">col.ptcure</code></td>
<td>
<p>optional argument to specify the color of curve of probability
<code>P(t)</code> of being cured at a given time t after diagnosis knowing that
he/she was alive up to time <code>t</code>.</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_col.cumhaz">col.cumhaz</code></td>
<td>
<p>optional argument to specify the color of curve of cumulative excess hazard</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_col.logcumhaz">col.logcumhaz</code></td>
<td>
<p>optional argument to specify the color of curve of the logarithm of cumulative excess hazard</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_col.tau">col.tau</code></td>
<td>
<p>optional argument to specify the color of curve of time-to-null excess hazard</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_col.ttc">col.ttc</code></td>
<td>
<p>optional argument to specify the color of curve of time-to-cure</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_col.p95">col.p95</code></td>
<td>
<p>optional argument to specify the color for the line highlighting <code class="reqn">\epsilon</code> when <code class="reqn">P(t) \ge 1-\epsilon</code></p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_col.pi">col.pi</code></td>
<td>
<p>optional argument to specify the color of cure proportion</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_lty.surv">lty.surv</code></td>
<td>
<p>stands for line types for net survival</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_lty.haz">lty.haz</code></td>
<td>
<p>stands for line types for excess hazard</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_lty.ptcure">lty.ptcure</code></td>
<td>
<p>stands for line types for probability P(t) of being cured
at a given time t after diagnosis knowing that he/she was alive up to time t.</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_lty.cumhaz">lty.cumhaz</code></td>
<td>
<p>stands for line types for cumulative excess hazard</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_lty.logcumhaz">lty.logcumhaz</code></td>
<td>
<p>stands for line types for logarithm cumulative excess hazard</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_lty.pi">lty.pi</code></td>
<td>
<p>stands for line types for cure proportion</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_lty.tau">lty.tau</code></td>
<td>
<p>stands for line types for time-to-null excess hazard</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_lty.ttc">lty.ttc</code></td>
<td>
<p>stands for line types for time-to-cure</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_lty.p95">lty.p95</code></td>
<td>
<p>stands for line types for the line highlighting <code class="reqn">\epsilon</code> when <code class="reqn">P(t) \ge 1-\epsilon</code></p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_lty.ic">lty.ic</code></td>
<td>
<p>stands for line types for confidence intervals</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_lwd.main">lwd.main</code></td>
<td>
<p>line width for the main line (haz, surv, pt_cure, cumhaz, logcumhaz)</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_lwd.sub">lwd.sub</code></td>
<td>
<p>line width for the additionnal lines (ttc, p95, tau...)</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_lwd.ic">lwd.ic</code></td>
<td>
<p>line width for the confidence intervals lines</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_...">...</code></td>
<td>
<p>additional options as in the classical plot method.</p>
</td></tr>
<tr><td><code id="plot.predCuresurv_+3A_ylab">ylab</code></td>
<td>
<p>optional label for the y-axis of the plot. Depending to the curve
of interest (hazard, survival, probability of being cured at a given time t,
or all),the argument must be named <code>ylab.haz, ylab.surv, ylab.ptcure</code>.
If missing some default labels are provided depending on the curve of
interest. This name can be found in the data.frame from the result of
the <code>predict.curesurv</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned.
</p>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.curesurv">predict.curesurv()</a></code>, <code><a href="#topic+print.curesurv">print.curesurv()</a></code>, <code><a href="#topic+curesurv">curesurv()</a></code>, <code>browseVignettes("curesurv")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


library("curesurv")
library("survival")

 testiscancer$age_crmin &lt;- (testiscancer$age- min(testiscancer$age)) /
              sd(testiscancer$age)

fit_m1_ad_tneh &lt;- curesurv(Surv(time_obs, event) ~ z_tau(age_crmin) +
                          z_alpha(age_crmin),
                          pophaz = "ehazard",
                          cumpophaz = "cumehazard",
                          model = "nmixture", dist = "tneh",
                          link_tau = "linear",
                          data = testiscancer,
                          method_opt = "L-BFGS-B")

 fit_m1_ad_tneh


#'  #mean of age
 newdata1 &lt;- with(testiscancer,
 expand.grid(event = 0, age_crmin = mean(age_crmin), time_obs  = seq(0.001,10,0.1)))

 pred_agemean &lt;- predict(object = fit_m1_ad_tneh, newdata = newdata1)


 #max of age
 newdata2 &lt;- with(testiscancer,
 expand.grid(event = 0,
 age_crmin = max(age_crmin),
  time_obs  = seq(0.001,10,0.1)))

 pred_agemax &lt;- predict(object = fit_m1_ad_tneh, newdata = newdata2)

   # predictions at time 2 years and  of age

   newdata3 &lt;- with(testiscancer,
      expand.grid(event = 0,
      age_crmin = seq(min(testiscancer$age_crmin),max(testiscancer$age_crmin), 0.1),
      time_obs  = 2))

   pred_age_val &lt;- predict(object = fit_m1_ad_tneh, newdata = newdata3)

 #plot of 3 indicators for mean age

 plot(pred_agemean, fun="all")


 #plot of net survival for mean and maximum age (comparison)

oldpar &lt;- par(no.readonly = TRUE)

par(mfrow = c(2, 2),
    cex = 1.0)
plot(pred_agemax$time,
    pred_agemax$ex_haz,
    type = "l",
    lty = 1,
    lwd = 2,
    xlab = "Time since diagnosis",
    ylab = "excess hazard")
lines(pred_agemean$time,
     pred_agemean$ex_haz,
     type = "l",
     lty = 2,
     lwd = 2)

legend("topright",
      horiz = FALSE,
      legend = c("hE(t) age.max = 79.9", "hE(t) age.mean = 50.8"),
      col = c("black", "black"),
      lty = c(1, 2, 1, 1, 2, 2))
grid()

plot(pred_agemax$time,
    pred_agemax$netsurv,
    type = "l",
    lty = 1,
    lwd = 2,
    ylim = c(0, 1),
    xlab = "Time since diagnosis",
    ylab = "net survival")
lines(pred_agemean$time,
     pred_agemean$netsurv,
     type = "l",
     lty = 2,
     lwd = 2)
legend("bottomleft",
       horiz = FALSE,
       legend = c("Sn(t) age.max = 79.9", "Sn(t) age.mean = 50.8"),
       col = c("black", "black"),
      lty = c(1, 2, 1, 1, 2, 2))
grid()

plot(pred_agemax$time,
    pred_agemax$pt_cure,
    type = "l",
    lty = 1,
    lwd = 2,
    ylim = c(0, 1), xlim = c(0,30),
    xlab = "Time since diagnosis",
    ylab = "probability of being cured P(t)")

lines(pred_agemean$time,
     pred_agemean$pt_cure,
     type = "l",
     lty = 2,
     lwd = 2)


abline(v = pred_agemean$tau[1],
      lty = 2,
      lwd = 2,
      col = "blue")
abline(v = pred_agemean$TTC[1],
       lty = 2,
       lwd = 2,
       col = "red")
abline(v = pred_agemax$tau[1],
       lty = 1,
       lwd = 2,
       col = "blue")
abline(v = pred_agemax$TTC[1],
       lty = 1,
       lwd = 2,
      col = "red")
grid()

legend("bottomright",
       horiz = FALSE,
       legend = c("P(t) age.max = 79.9",
                 "P(t) age.mean = 50.8",
                 "TNEH age.max = 79.9",
                 "TTC age.max = 79.9",
                 "TNEH age.mean = 50.8",
                 "TTC age.mean = 50.8"),
      col = c("black", "black", "blue", "red", "blue", "red"),
      lty = c(1, 2, 1, 1, 2, 2))


 val_age &lt;- seq(min(testiscancer$age_crmin),
                max(testiscancer$age_crmin), 0.1) * sd(testiscancer$age) +
                min(testiscancer$age)


 pred_age_val &lt;- predict(object = fit_m1_ad_tneh, newdata = newdata3)


par(mfrow=c(2,2))
 plot(val_age,
     pred_age_val$ex_haz, type = "l",
     lty=1, lwd=2,
     xlab = "age",
     ylab = "excess hazard")
grid()

 plot(val_age,
     pred_age_val$netsurv, type = "l", lty=1,
     lwd=2, xlab = "age", ylab = "net survival")
     grid()

 plot(val_age,
     pred_age_val$pt_cure, type = "l", lty=1, lwd=2,
     xlab = "age",
     ylab = "P(t)")
     grid()
par(oldpar)
 

</code></pre>

<hr>
<h2 id='predcall_tneh'>predcall_tneh function</h2><span id='topic+predcall_tneh'></span>

<h3>Description</h3>

<p>calculates the predicted cure indicators from a Time to null
excess hazard model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predcall_tneh(
  object,
  pred,
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  xmax = NULL,
  level = level,
  epsilon = epsilon,
  cumLexc_topred
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predcall_tneh_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="predcall_tneh_+3A_pred">pred</code></td>
<td>
<p>some predicted estimates</p>
</td></tr>
<tr><td><code id="predcall_tneh_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="predcall_tneh_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="predcall_tneh_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="predcall_tneh_+3A_xmax">xmax</code></td>
<td>
<p>time max at which Pi(t) is calculated.</p>
</td></tr>
<tr><td><code id="predcall_tneh_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="predcall_tneh_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
<tr><td><code id="predcall_tneh_+3A_cumlexc_topred">cumLexc_topred</code></td>
<td>
<p>pre prediction obtained either from cumLexc_adtneh2_topred or cumLexc_mul_topred</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='predcall_wei'>predcall_wei function</h2><span id='topic+predcall_wei'></span>

<h3>Description</h3>

<p>calculates the predicted cure indicators from a mixture cure
model with the survival of uncured specified by a Weibull distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predcall_wei(
  object,
  pred,
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x = x,
  level = level,
  epsilon = epsilon,
  sign_delta = 1,
  cumLexctopred
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predcall_wei_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented using curesurv</p>
</td></tr>
<tr><td><code id="predcall_wei_+3A_pred">pred</code></td>
<td>
<p>some predicted estimates</p>
</td></tr>
<tr><td><code id="predcall_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="predcall_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="predcall_wei_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="predcall_wei_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="predcall_wei_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
<tr><td><code id="predcall_wei_+3A_sign_delta">sign_delta</code></td>
<td>
<p>only used for mixture cure rate models to specify if the
effects or minus the effects of covariates acting on uncured survival to be
considered. Default will be sign_delta = &quot;1&quot;. The alternative is
sign_delta = &quot;-1&quot;.</p>
</td></tr>
<tr><td><code id="predcall_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained by cumLexc_alphaweibull_topred</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>
<p>Phillips N, Coldman A, McBride ML. Estimating cancer prevalence using
mixture models for cancer survival. Stat Med. 2002 May 15;21(9):1257-70.
doi: 10.1002/sim.1101. PMID: 12111877.
(<a href="https://pubmed.ncbi.nlm.nih.gov/12111877/">pubmed</a>)
</p>
<p>De Angelis R, Capocaccia R, Hakulinen T, Soderman B, Verdecchia A. Mixture
models for cancer survival analysis: application to population-based data
with covariates. Stat Med. 1999 Feb 28;18(4):441-54.
doi: 10.1002/(sici)1097-0258(19990228)18:4&lt;441::aid-sim23&gt;3.0.co;2-m.
PMID: 10070685.
(<a href="https://pubmed.ncbi.nlm.nih.gov/10070685/">pubmed</a>)
</p>

<hr>
<h2 id='predict.curesurv'>Prediction for a curesurv cure model</h2><span id='topic+predict.curesurv'></span>

<h3>Description</h3>

<p>return predicted (excess) hazard, (net) survival, cure fraction and
time to null excess hazard or time to cure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'curesurv'
predict(
  object,
  newdata = NULL,
  xmax = 10^9,
  level = 0.975,
  epsilon = 0.05,
  sign_delta = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.curesurv_+3A_object">object</code></td>
<td>
<p>Output from <code>curesurv</code> function</p>
</td></tr>
<tr><td><code id="predict.curesurv_+3A_newdata">newdata</code></td>
<td>
<p>the new data to be specified for predictions; If else,
predictions are made using the data provided during the estimation step in
order to obtain the output from curesurv function.</p>
</td></tr>
<tr><td><code id="predict.curesurv_+3A_xmax">xmax</code></td>
<td>
<p>maximum time at which Time-to-Cure is evaluated numerically.</p>
</td></tr>
<tr><td><code id="predict.curesurv_+3A_level">level</code></td>
<td>
<p><code class="reqn">1-\frac{\alpha}{2}</code>-order quantile of a normal distribution for the confidence intervals</p>
</td></tr>
<tr><td><code id="predict.curesurv_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">Pi(t) \ge 1-\epsilon</code>.
By default epsilon = 0.05.</p>
</td></tr>
<tr><td><code id="predict.curesurv_+3A_sign_delta">sign_delta</code></td>
<td>
<p>sign of effect of delta on covariates acting on survival function,
positive by default &quot;sign_delta = 1&quot; and alternative is &quot;sign_delta = -1&quot;</p>
</td></tr>
<tr><td><code id="predict.curesurv_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>c("pred_curesurv", "data.frame")</code>.
This object is a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>time</code></td>
<td>
<p>time in the input new data</p>
</td></tr>
<tr><td><code>ex_haz</code></td>
<td>
<p>predicted excess hazard at the time provided in the new data</p>
</td></tr>
<tr><td><code>netsurv</code></td>
<td>
<p>predicted net survival at the time provided in the new data</p>
</td></tr>
<tr><td><code>pt_cure</code></td>
<td>
<p>probability to be cured</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>time to null in model TNEH when object corresponds to the
results from Boussari model or its extension.</p>
</td></tr>
<tr><td><code>netsurv_tau</code></td>
<td>
<p>pi or net survival at time tau when object corresponds to the
results from Boussari model or its extension.</p>
</td></tr>
<tr><td><code>time_to_cure_ttc</code></td>
<td>
<p>time to cure (TTC)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>
<p>Phillips N, Coldman A, McBride ML. Estimating cancer prevalence using
mixture models for cancer survival. Stat Med. 2002 May 15;21(9):1257-70.
doi: 10.1002/sim.1101. PMID: 12111877.
(<a href="https://pubmed.ncbi.nlm.nih.gov/12111877/">pubmed</a>)
</p>
<p>De Angelis R, Capocaccia R, Hakulinen T, Soderman B, Verdecchia A. Mixture
models for cancer survival analysis: application to population-based data
with covariates. Stat Med. 1999 Feb 28;18(4):441-54.
doi: 10.1002/(sici)1097-0258(19990228)18:4&lt;441::aid-sim23&gt;3.0.co;2-m.
PMID: 10070685.
(<a href="https://pubmed.ncbi.nlm.nih.gov/10070685/">pubmed</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.curesurv">print.curesurv()</a></code>, <code><a href="#topic+curesurv">curesurv()</a></code>, <code>browseVignettes("curesurv")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library("curesurv")
library("survival")

fit_m2_ml &lt;- curesurv(Surv(time_obs, event) ~ age_cr|age_cr,
                   pophaz = "ehazard",
                   cumpophaz = "cumehazard",
                   model = "mixture",
                   data = pancreas_data,
                   method_opt = "L-BFGS-B")

 fit_m2_ml

 newdata &lt;- pancreas_data[2,]

 predict(object = fit_m2_ml, newdata = newdata)

## Non mixture cure model
### TNEH model

#### Additive parametrization

testiscancer$age_crmin &lt;- (testiscancer$age- min(testiscancer$age)) /
              sd(testiscancer$age)

fit_m1_ad_tneh &lt;- curesurv(Surv(time_obs, event) ~ z_tau(age_crmin) +
                          z_alpha(age_crmin),
                          pophaz = "ehazard",
                          cumpophaz = "cumehazard",
                          model = "nmixture", dist = "tneh",
                          link_tau = "linear",
                          data = testiscancer,
                          method_opt = "L-BFGS-B")

 fit_m1_ad_tneh

 predict(object = fit_m1_ad_tneh, newdata = testiscancer[3:6,])

 #mean of age
 newdata1 &lt;- with(testiscancer,
 expand.grid(event = 0, age_crmin = mean(age_crmin), time_obs  = seq(0.001,10,0.1)))

 pred_agemean &lt;- predict(object = fit_m1_ad_tneh, newdata = newdata1)


 #max of age
 newdata2 &lt;- with(testiscancer,
 expand.grid(event = 0,
 age_crmin = max(age_crmin),
  time_obs  = seq(0.001,10,0.1)))

 pred_agemax &lt;- predict(object = fit_m1_ad_tneh, newdata = newdata2)
 head(pred_agemax)




</code></pre>

<hr>
<h2 id='print.curesurv'>print a curesurv object</h2><span id='topic+print.curesurv'></span>

<h3>Description</h3>

<p>Print an object of class &quot;curesurv&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'curesurv'
print(x, digits = max(1L, getOption("digits") - 3L), signif.stars = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.curesurv_+3A_x">x</code></td>
<td>
<p>an object of class &quot;curesurv&quot;.</p>
</td></tr>
<tr><td><code id="print.curesurv_+3A_digits">digits</code></td>
<td>
<p>minimum number of significant digits to be used for
most numbers.</p>
</td></tr>
<tr><td><code id="print.curesurv_+3A_signif.stars">signif.stars</code></td>
<td>
<p>logical; if TRUE, P-values are additionally encoded
visually as &quot;significance stars&quot; in order to help scanning of long
coefficient tables.</p>
</td></tr>
<tr><td><code id="print.curesurv_+3A_...">...</code></td>
<td>
<p>additional options</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class &quot;curesurv&quot; representing the fit. See <code>curesurv</code> for details.
</p>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N,
Remontet L, Jooste V. Modeling excess hazard with time-to-cure
as a parameter. Biometrics. 2020 Aug 31.
doi: 10.1111/biom.13361. Epub ahead of print.
PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Phillips N, Coldman A, McBride ML. Estimating cancer prevalence using
mixture models for cancer survival. Stat Med. 2002 May 15;21(9):1257-70.
doi: 10.1002/sim.1101. PMID: 12111877.
(<a href="https://pubmed.ncbi.nlm.nih.gov/12111877/">pubmed</a>)
</p>
<p>De Angelis R, Capocaccia R, Hakulinen T, Soderman B, Verdecchia A. Mixture
models for cancer survival analysis: application to population-based data
with covariates. Stat Med. 1999 Feb 28;18(4):441-54.
doi: 10.1002/(sici)1097-0258(19990228)18:4&lt;441::aid-sim23&gt;3.0.co;2-m.
PMID: 10070685. (<a href="https://pubmed.ncbi.nlm.nih.gov/10070685/">pubmed</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.curesurv">predict.curesurv()</a></code>, <code><a href="#topic+curesurv">curesurv()</a></code>, <code>browseVignettes("curesurv")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library("curesurv")
library("survival")



# overall survival setting
# Mixture cure model with Weibull function for the uncured patients survival:
# no covariate



fit_ml0 &lt;- curesurv(Surv(time_obs, event) ~ 1 | 1,
             model = "mixture", dist = "weib",
             data = testiscancer,
             method_opt = "L-BFGS-B")


print(fit_ml0)

</code></pre>

<hr>
<h2 id='pt_cure_ic_adtneh2'>pt_cure_ic_adtneh2 function</h2><span id='topic+pt_cure_ic_adtneh2'></span>

<h3>Description</h3>

<p>calculates the probability Pi(t) of being
cured at a given time t after diagnosis knowing that he/she was alive up to
time t. It also provides the related confidence intervals using plain_method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pt_cure_ic_adtneh2(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  level = level,
  cumLexctopred = NULL,
  Dpt_cure = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pt_cure_ic_adtneh2_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="pt_cure_ic_adtneh2_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="pt_cure_ic_adtneh2_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="pt_cure_ic_adtneh2_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="pt_cure_ic_adtneh2_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="pt_cure_ic_adtneh2_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre-prediction parameter obtained with cumLexc_ad2_topred, if NULL it will be calculated here</p>
</td></tr>
<tr><td><code id="pt_cure_ic_adtneh2_+3A_dpt_cure">Dpt_cure</code></td>
<td>
<p>Partial derivatives of the cure propability according to theta, if NULL it will be calculated here</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='pt_cure_ic_adtneh2_log'>pt_cure_ic_adtneh2_log function</h2><span id='topic+pt_cure_ic_adtneh2_log'></span>

<h3>Description</h3>

<p>calculates the probability of the probability Pi(t) of being
cured at a given time t after diagnosis knowing that he/she was alive up to
time t. It also provides the related confidence intervals using log method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pt_cure_ic_adtneh2_log(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  level = level,
  cumLexctopred = NULL,
  Dpt_cure = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pt_cure_ic_adtneh2_log_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="pt_cure_ic_adtneh2_log_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="pt_cure_ic_adtneh2_log_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="pt_cure_ic_adtneh2_log_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="pt_cure_ic_adtneh2_log_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="pt_cure_ic_adtneh2_log_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre-prediction parameter obtained with cumLexc_ad2_topred, if NULL it will be calculated here</p>
</td></tr>
<tr><td><code id="pt_cure_ic_adtneh2_log_+3A_dpt_cure">Dpt_cure</code></td>
<td>
<p>Partial derivatives of the cure propability according to theta, if NULL it will be calculated here</p>
</td></tr>
</table>

<hr>
<h2 id='pt_cure_ic_adtneh2_loglog'>pt_cure_ic_adtneh2_loglog function</h2><span id='topic+pt_cure_ic_adtneh2_loglog'></span>

<h3>Description</h3>

<p>calculates the probability of the probability Pi(t) of being
cured at a given time t after diagnosis knowing that he/she was alive up to
time t. It also provides the related confidence intervals using log-log method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pt_cure_ic_adtneh2_loglog(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  level = level,
  cumLexctopred = NULL,
  Dpt_cure = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pt_cure_ic_adtneh2_loglog_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="pt_cure_ic_adtneh2_loglog_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="pt_cure_ic_adtneh2_loglog_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="pt_cure_ic_adtneh2_loglog_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="pt_cure_ic_adtneh2_loglog_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="pt_cure_ic_adtneh2_loglog_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre-prediction parameter obtained with cumLexc_ad2_topred, if NULL it will be calculated here</p>
</td></tr>
<tr><td><code id="pt_cure_ic_adtneh2_loglog_+3A_dpt_cure">Dpt_cure</code></td>
<td>
<p>Partial derivatives of the cure propability according to theta, if NULL it will be calculated here</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='pt_cure_ic_log_wei'>pt_cure_ic_log_wei function</h2><span id='topic+pt_cure_ic_log_wei'></span>

<h3>Description</h3>

<p>confidence intervals of the probability to be cured at time t by
Delta Method on logarithm of P(t)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pt_cure_ic_log_wei(
  object,
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x,
  level,
  cumLexctopred,
  Dpt_cure
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pt_cure_ic_log_wei_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="pt_cure_ic_log_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="pt_cure_ic_log_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="pt_cure_ic_log_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="pt_cure_ic_log_wei_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="pt_cure_ic_log_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre-prediction parameter obtained with cumLexc_alphaweibull</p>
</td></tr>
<tr><td><code id="pt_cure_ic_log_wei_+3A_dpt_cure">Dpt_cure</code></td>
<td>
<p>partial derivatives of pt_cure by theta, obtained with dpdtheta_wei function</p>
</td></tr>
</table>

<hr>
<h2 id='pt_cure_ic_loglog_wei'>pt_cure_ic_loglog_wei function</h2><span id='topic+pt_cure_ic_loglog_wei'></span>

<h3>Description</h3>

<p>confidence intervals of the probability to be cured at time t by
delta method on log(-log(p(t)))
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pt_cure_ic_loglog_wei(
  object,
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x,
  level,
  cumLexctopred,
  Dpt_cure
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pt_cure_ic_loglog_wei_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="pt_cure_ic_loglog_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="pt_cure_ic_loglog_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="pt_cure_ic_loglog_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="pt_cure_ic_loglog_wei_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="pt_cure_ic_loglog_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre-prediction parameter obtained with cumLexc_alphaweibull</p>
</td></tr>
<tr><td><code id="pt_cure_ic_loglog_wei_+3A_dpt_cure">Dpt_cure</code></td>
<td>
<p>partial derivatives of pt_cure by theta, obtained with dpdtheta_wei function</p>
</td></tr>
</table>

<hr>
<h2 id='pt_cure_ic_multneh'>pt_cure_ic_multneh function</h2><span id='topic+pt_cure_ic_multneh'></span>

<h3>Description</h3>

<p>calculates the probability Pi(t) of being
cured at a given time t after diagnosis knowing that he/she was alive up to
time t. It also provides the related confidence intervals using plain_method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pt_cure_ic_multneh(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  level = level,
  cumLexctopred = NULL,
  Dpt_cure = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pt_cure_ic_multneh_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="pt_cure_ic_multneh_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="pt_cure_ic_multneh_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="pt_cure_ic_multneh_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="pt_cure_ic_multneh_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="pt_cure_ic_multneh_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained from cumLexc_mul_topred, if NULL will be calculated</p>
</td></tr>
<tr><td><code id="pt_cure_ic_multneh_+3A_dpt_cure">Dpt_cure</code></td>
<td>
<p>partial derivative of pt_cure according to theta, if NULL will be calculated</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='pt_cure_ic_multneh_log'>pt_cure_ic_multneh_log function</h2><span id='topic+pt_cure_ic_multneh_log'></span>

<h3>Description</h3>

<p>calculates the probability of the probability Pi(t) of being
cured at a given time t after diagnosis knowing that he/she was alive up to
time t. It also provides the related confidence intervals using log method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pt_cure_ic_multneh_log(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  level = level,
  cumLexctopred = NULL,
  Dpt_cure = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pt_cure_ic_multneh_log_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="pt_cure_ic_multneh_log_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="pt_cure_ic_multneh_log_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="pt_cure_ic_multneh_log_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="pt_cure_ic_multneh_log_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="pt_cure_ic_multneh_log_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained from cumLexc_mul_topred, if NULL will be calculated</p>
</td></tr>
<tr><td><code id="pt_cure_ic_multneh_log_+3A_dpt_cure">Dpt_cure</code></td>
<td>
<p>partial derivative of pt_cure according to theta, if NULL will be calculated</p>
</td></tr>
</table>

<hr>
<h2 id='pt_cure_ic_multneh_loglog'>pt_cure_ic_multneh_loglog function</h2><span id='topic+pt_cure_ic_multneh_loglog'></span>

<h3>Description</h3>

<p>calculates the probability of the probability Pi(t) of being
cured at a given time t after diagnosis knowing that he/she was alive up to
time t. It also provides the related confidence intervals using log-log method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pt_cure_ic_multneh_loglog(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object,
  level = level,
  cumLexctopred = NULL,
  Dpt_cure = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pt_cure_ic_multneh_loglog_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="pt_cure_ic_multneh_loglog_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="pt_cure_ic_multneh_loglog_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="pt_cure_ic_multneh_loglog_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="pt_cure_ic_multneh_loglog_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="pt_cure_ic_multneh_loglog_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained from cumLexc_mul_topred, if NULL will be calculated</p>
</td></tr>
<tr><td><code id="pt_cure_ic_multneh_loglog_+3A_dpt_cure">Dpt_cure</code></td>
<td>
<p>partial derivative of pt_cure according to theta, if NULL will be calculated</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='pt_cure_ic_noDM'>pt_cure_ic_noDM function</h2><span id='topic+pt_cure_ic_noDM'></span>

<h3>Description</h3>

<p>Variance of p(t) without delta method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pt_cure_ic_noDM(x, z_pcured, t, level = 0.975, theta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pt_cure_ic_noDM_+3A_x">x</code></td>
<td>
<p>fit ouput from curesurv</p>
</td></tr>
<tr><td><code id="pt_cure_ic_noDM_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates</p>
</td></tr>
<tr><td><code id="pt_cure_ic_noDM_+3A_t">t</code></td>
<td>
<p>time</p>
</td></tr>
<tr><td><code id="pt_cure_ic_noDM_+3A_level">level</code></td>
<td>
<p>level of confidence</p>
</td></tr>
<tr><td><code id="pt_cure_ic_noDM_+3A_theta">theta</code></td>
<td>
<p>estimated parameters</p>
</td></tr>
</table>

<hr>
<h2 id='pt_cure_ic_wei'>pt_cure_ic_wei function</h2><span id='topic+pt_cure_ic_wei'></span>

<h3>Description</h3>

<p>Calculates the confidence intervals of the probability Pi(t)
of being cured at a given time t after diagnosis knowing that he/she was
alive up to time t. by Delta Method on P(t)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pt_cure_ic_wei(
  object,
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x,
  level,
  cumLexctopred,
  Dpt_cure
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pt_cure_ic_wei_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="pt_cure_ic_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="pt_cure_ic_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="pt_cure_ic_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="pt_cure_ic_wei_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="pt_cure_ic_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre-prediction parameter obtained with cumLexc_alphaweibull</p>
</td></tr>
<tr><td><code id="pt_cure_ic_wei_+3A_dpt_cure">Dpt_cure</code></td>
<td>
<p>partial derivatives of pt_cure by theta, obtained with dpdtheta_wei function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='pt_cure_wei'>pt_cure_wei function</h2><span id='topic+pt_cure_wei'></span>

<h3>Description</h3>

<p>calculates the probability Pi(t) of being
cured at a given time t after diagnosis knowing that he/she was alive up to
time t. The predictions are based on a mixture cure model with weibull
distribution for the survival of uncured patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pt_cure_wei(z_pcured = z_pcured, z_ucured = z_ucured, x, theta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pt_cure_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="pt_cure_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="pt_cure_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="pt_cure_wei_+3A_theta">theta</code></td>
<td>
<p>estimated parameters of the cumulative excess hazard from a mixture
model using curesurv and uncured survival following a Weibull distribution</p>
</td></tr>
</table>

<hr>
<h2 id='sn_ic_adtneh2'>sn_ic_adtneh2 function</h2><span id='topic+sn_ic_adtneh2'></span>

<h3>Description</h3>

<p>calculates the net survival at time t. It also provides
the related confidence intervals using plain_method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sn_ic_adtneh2(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object = object,
  level = level,
  cumLexctopred = NULL,
  Dsn = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sn_ic_adtneh2_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="sn_ic_adtneh2_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="sn_ic_adtneh2_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="sn_ic_adtneh2_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="sn_ic_adtneh2_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="sn_ic_adtneh2_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre-prediction thing obtained from cumLexc_ad2_topred, calculated if not NULL</p>
</td></tr>
<tr><td><code id="sn_ic_adtneh2_+3A_dsn">Dsn</code></td>
<td>
<p>partial derivatives of Sn obtained from dsndtheta_adtneh2 function, calculated if not NULL</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>

<hr>
<h2 id='sn_ic_adtneh2_log'>sn_ic_adtneh2_log function</h2><span id='topic+sn_ic_adtneh2_log'></span>

<h3>Description</h3>

<p>calculates the net survival at time t. It also provides the
related confidence intervals using log method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sn_ic_adtneh2_log(
  z_tau,
  z_alpha,
  x,
  object,
  level = 0.975,
  cumLexctopred = NULL,
  Dsn = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sn_ic_adtneh2_log_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="sn_ic_adtneh2_log_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="sn_ic_adtneh2_log_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="sn_ic_adtneh2_log_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="sn_ic_adtneh2_log_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="sn_ic_adtneh2_log_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre-prediction thing obtained from cumLexc_ad2_topred, calculated if not NULL</p>
</td></tr>
<tr><td><code id="sn_ic_adtneh2_log_+3A_dsn">Dsn</code></td>
<td>
<p>partial derivatives of Sn obtained from dsndtheta_adtneh2 function, calculated if not NULL</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='sn_ic_adtneh2_loglog'>sn_ic_adtneh2_loglog function</h2><span id='topic+sn_ic_adtneh2_loglog'></span>

<h3>Description</h3>

<p>calculates the net survival at time t. It also provides the
related confidence intervals using log-log method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sn_ic_adtneh2_loglog(
  z_tau,
  z_alpha,
  x,
  object,
  level = 0.975,
  cumLexctopred = NULL,
  Dsn = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sn_ic_adtneh2_loglog_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="sn_ic_adtneh2_loglog_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="sn_ic_adtneh2_loglog_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="sn_ic_adtneh2_loglog_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="sn_ic_adtneh2_loglog_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="sn_ic_adtneh2_loglog_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre-prediction thing obtained from cumLexc_ad2_topred, calculated if not NULL</p>
</td></tr>
<tr><td><code id="sn_ic_adtneh2_loglog_+3A_dsn">Dsn</code></td>
<td>
<p>partial derivatives of Sn obtained from dsndtheta_adtneh2 function, calculated if not NULL</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='sn_ic_log_wei'>sn_ic_log_wei function</h2><span id='topic+sn_ic_log_wei'></span>

<h3>Description</h3>

<p>calculates the confidence intervals of the net survival (Sn(t))
using variances of log(Sn(t)). In this formula, the variance of net survival
is obtained using delta method at the scale of log of net survival, and with
the expression Var(log(Sn(t))) = (dlog(Sn)/dtheta)Var(theta)(dlog(Sn)/dtheta)^T;
the Var(theta) is the variance-covariance matrix of theta (estimated parameters).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sn_ic_log_wei(
  object,
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x,
  level,
  cumLexctopred,
  Dsn
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sn_ic_log_wei_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="sn_ic_log_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="sn_ic_log_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="sn_ic_log_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="sn_ic_log_wei_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="sn_ic_log_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>a pre prediction obtained with cumLexc_alphaweibull_topred</p>
</td></tr>
<tr><td><code id="sn_ic_log_wei_+3A_dsn">Dsn</code></td>
<td>
<p>Partial derivative of Sn calculated by dsndtheta_wei function</p>
</td></tr>
</table>

<hr>
<h2 id='sn_ic_multneh'>sn_ic_multneh function</h2><span id='topic+sn_ic_multneh'></span>

<h3>Description</h3>

<p>calculates the net survival at time t. It also provides
the related confidence intervals using plain_method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sn_ic_multneh(
  z_tau = z_tau,
  z_alpha = z_alpha,
  x = x,
  object = object,
  level = level,
  cumLexctopred = NULL,
  Dsn = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sn_ic_multneh_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="sn_ic_multneh_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="sn_ic_multneh_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="sn_ic_multneh_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="sn_ic_multneh_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="sn_ic_multneh_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained from cumLexc_mul_topred, if NULL will be calculated</p>
</td></tr>
<tr><td><code id="sn_ic_multneh_+3A_dsn">Dsn</code></td>
<td>
<p>partial derivates of net survival, if NULL will be calculated</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>

<hr>
<h2 id='sn_ic_multneh_log'>sn_ic_multneh_log function</h2><span id='topic+sn_ic_multneh_log'></span>

<h3>Description</h3>

<p>calculates the net survival at time t. It also provides the
related confidence intervals using log method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sn_ic_multneh_log(
  z_tau,
  z_alpha,
  x,
  object,
  level = 0.975,
  cumLexctopred = NULL,
  Dsn = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sn_ic_multneh_log_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="sn_ic_multneh_log_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="sn_ic_multneh_log_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="sn_ic_multneh_log_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="sn_ic_multneh_log_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="sn_ic_multneh_log_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained from cumLexc_mul_topred, if NULL will be calculated</p>
</td></tr>
<tr><td><code id="sn_ic_multneh_log_+3A_dsn">Dsn</code></td>
<td>
<p>partial derivates of net survival, if NULL will be calculated</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='sn_ic_multneh_loglog'>sn_ic_multneh_loglog function</h2><span id='topic+sn_ic_multneh_loglog'></span>

<h3>Description</h3>

<p>calculates the net survival at time t. It also provides the
related confidence intervals using log-log method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sn_ic_multneh_loglog(
  z_tau,
  z_alpha,
  x,
  object,
  level = 0.975,
  cumLexctopred = NULL,
  Dsn = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sn_ic_multneh_loglog_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="sn_ic_multneh_loglog_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="sn_ic_multneh_loglog_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="sn_ic_multneh_loglog_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="sn_ic_multneh_loglog_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="sn_ic_multneh_loglog_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained from cumLexc_mul_topred, if NULL will be calculated</p>
</td></tr>
<tr><td><code id="sn_ic_multneh_loglog_+3A_dsn">Dsn</code></td>
<td>
<p>partial derivates of net survival, if NULL will be calculated</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='sn_ic_wei'>sn_ic_wei function</h2><span id='topic+sn_ic_wei'></span>

<h3>Description</h3>

<p>calculates the confidence intervals of the net survival (Sn(t))
using variances of Sn(t). In this formula, the variance of net survival
is obtained using the expression Var(Sn(t)) = (dSn/dtheta)Var(theta)(dSn/dtheta)^T
where Var(theta) is the variance-covariance matrix of theta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sn_ic_wei(
  object,
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x,
  level,
  cumLexctopred,
  Dsn
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sn_ic_wei_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="sn_ic_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="sn_ic_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="sn_ic_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="sn_ic_wei_+3A_level">level</code></td>
<td>
<p>(1-alpha/2)-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="sn_ic_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained with cumLexc_alphaweibull_topred</p>
</td></tr>
<tr><td><code id="sn_ic_wei_+3A_dsn">Dsn</code></td>
<td>
<p>Partial derivative of Sn calculated by dsndtheta_wei function</p>
</td></tr>
</table>

<hr>
<h2 id='summary.curesurv'>summary for a curesurv cure model</h2><span id='topic+summary.curesurv'></span>

<h3>Description</h3>

<p>summary an object of class &quot;curesurv&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'curesurv'
summary(
  object,
  digits = max(1L, getOption("digits") - 3L),
  signif.stars = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.curesurv_+3A_object">object</code></td>
<td>
<p>an object of class &quot;curesurv&quot;.</p>
</td></tr>
<tr><td><code id="summary.curesurv_+3A_digits">digits</code></td>
<td>
<p>minimum number of significant digits to be used for
most numbers.</p>
</td></tr>
<tr><td><code id="summary.curesurv_+3A_signif.stars">signif.stars</code></td>
<td>
<p>logical; if TRUE, P-values are additionally encoded
visually as &quot;significance stars&quot; in order to help scanning of long
coefficient tables.</p>
</td></tr>
<tr><td><code id="summary.curesurv_+3A_...">...</code></td>
<td>
<p>additional options</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class &quot;curesurv&quot; representing the fit. See <code>curesurv</code> for details.
</p>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N,
Remontet L, Jooste V. Modeling excess hazard with time-to-cure
as a parameter. Biometrics. 2020 Aug 31.
doi: 10.1111/biom.13361. Epub ahead of print.
PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Phillips N, Coldman A, McBride ML. Estimating cancer prevalence using
mixture models for cancer survival. Stat Med. 2002 May 15;21(9):1257-70.
doi: 10.1002/sim.1101. PMID: 12111877.
(<a href="https://pubmed.ncbi.nlm.nih.gov/12111877/">pubmed</a>)
</p>
<p>De Angelis R, Capocaccia R, Hakulinen T, Soderman B, Verdecchia A. Mixture
models for cancer survival analysis: application to population-based data
with covariates. Stat Med. 1999 Feb 28;18(4):441-54.
doi: 10.1002/(sici)1097-0258(19990228)18:4&lt;441::aid-sim23&gt;3.0.co;2-m.
PMID: 10070685. (<a href="https://pubmed.ncbi.nlm.nih.gov/10070685/">pubmed</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.curesurv">predict.curesurv()</a></code>, <code><a href="#topic+curesurv">curesurv()</a></code>, <code>browseVignettes("curesurv")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library("curesurv")
library("survival")



# overall survival setting
# Mixture cure model with Weibull function for the uncured patients survival:
# no covariate



fit_ml0 &lt;- curesurv(Surv(time_obs, event) ~ 1 | 1,
             model = "mixture", dist = "weib",
             data = testiscancer,
             method_opt = "L-BFGS-B")


 summary(fit_ml0)

</code></pre>

<hr>
<h2 id='testiscancer'>Simulated testis cancer data using a cure model</h2><span id='topic+testiscancer'></span>

<h3>Description</h3>

<p>Simulated dataset of 2000 individuals as in Boussari et <em>al</em>. (2020),
following setting 1 sub-scenario design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(testiscancer)
</code></pre>


<h3>Format</h3>

<p>This dataset contains the following variables:
</p>

<dl>
<dt>age</dt><dd><p>Age at diagnosis</p>
</dd>
<dt>age_cr</dt><dd><p>centered and scaled age at diagnosis</p>
</dd>
<dt>age_classe</dt><dd><p>&quot;&lt;40&quot;, &quot;40_65&quot; and  &quot;&gt;=65&quot; age groups </p>
</dd>
<dt>time_obs</dt><dd><p>Follow-up time (years)</p>
</dd>
<dt>event</dt><dd><p>Vital status</p>
</dd>
<dt>cumehazard</dt><dd><p>individual cumulative expected hazard</p>
</dd>
<dt>ehazard</dt><dd><p>individual instantaneous expected hazard</p>
</dd>
<dt>weisurvpop</dt><dd><p>individual expected survival</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(testiscancer)
summary(testiscancer)
</code></pre>

<hr>
<h2 id='trigamma'>trigamma function</h2><span id='topic+trigamma'></span>

<h3>Description</h3>

<p>trigamma function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trigamma(z)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trigamma_+3A_z">z</code></td>
<td>
<p>positive parameter</p>
</td></tr>
</table>

<hr>
<h2 id='TTC_adtneh2'>TTC_adtneh2 function</h2><span id='topic+TTC_adtneh2'></span>

<h3>Description</h3>

<p>calculates the probability Pi(t) of being cured at a given time
t after diagnosis knowing that he/she was alive up to time t from a
Time-to-Null excess hazard model using numerical method, uniroot. In other
words,
Pi(t)=(probability of being cured and alive up to time t given xi)/
(probability of being alive up to time t given xi)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TTC_adtneh2(z_alpha, z_tau, xmax, object, epsilon = epsilon)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TTC_adtneh2_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="TTC_adtneh2_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="TTC_adtneh2_+3A_xmax">xmax</code></td>
<td>
<p>time max at which Pi(t) is calculated.</p>
</td></tr>
<tr><td><code id="TTC_adtneh2_+3A_object">object</code></td>
<td>
<p>ouput from a non mixture model with distribution &quot;tneh&quot;
from curesurv function.</p>
</td></tr>
<tr><td><code id="TTC_adtneh2_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='TTC_ic_adtneh2'>TTC_ic_adtneh2 function</h2><span id='topic+TTC_ic_adtneh2'></span>

<h3>Description</h3>

<p>calculates confidence interval of the time TTC from a
non-mixture model with distribution &quot;tneh&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TTC_ic_adtneh2(
  z_alpha,
  z_tau,
  xmax,
  object,
  epsilon = epsilon,
  level = level,
  TTC,
  varTTC
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TTC_ic_adtneh2_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="TTC_ic_adtneh2_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="TTC_ic_adtneh2_+3A_xmax">xmax</code></td>
<td>
<p>time max at which Pi(t) is calculated.</p>
</td></tr>
<tr><td><code id="TTC_ic_adtneh2_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="TTC_ic_adtneh2_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
<tr><td><code id="TTC_ic_adtneh2_+3A_level">level</code></td>
<td>
<p><code>1-alpha/2</code>-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="TTC_ic_adtneh2_+3A_ttc">TTC</code></td>
<td>
<p>time to cure TTC,if NULL then calculated</p>
</td></tr>
<tr><td><code id="TTC_ic_adtneh2_+3A_varttc">varTTC</code></td>
<td>
<p>variance of time to cure ,if NULL then calculated</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='TTC_ic_adtneh2_log'>TTC_ic_adtneh2_log function</h2><span id='topic+TTC_ic_adtneh2_log'></span>

<h3>Description</h3>

<p>Produce confidence interval of the time TTC with log method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TTC_ic_adtneh2_log(
  z_alpha,
  z_tau,
  xmax,
  object,
  epsilon = epsilon,
  level = level,
  TTC = NULL,
  varTTC = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TTC_ic_adtneh2_log_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="TTC_ic_adtneh2_log_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="TTC_ic_adtneh2_log_+3A_xmax">xmax</code></td>
<td>
<p>time max at which Pi(t) is calculated.</p>
</td></tr>
<tr><td><code id="TTC_ic_adtneh2_log_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="TTC_ic_adtneh2_log_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
<tr><td><code id="TTC_ic_adtneh2_log_+3A_level">level</code></td>
<td>
<p><code>1-alpha/2</code>-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="TTC_ic_adtneh2_log_+3A_ttc">TTC</code></td>
<td>
<p>time to cure TTC,if NULL then calculated</p>
</td></tr>
<tr><td><code id="TTC_ic_adtneh2_log_+3A_varttc">varTTC</code></td>
<td>
<p>variance of time to cure ,if NULL then calculated</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='TTC_ic_Jakobsen_wei'>TTC_ic_Jakobsen_wei function</h2><span id='topic+TTC_ic_Jakobsen_wei'></span>

<h3>Description</h3>

<p>calculates the confidence interval of the time TTC using the
Jakobsen's approach.
Note that this function is for mixture cure model with Weibull distribution
considered for uncured patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TTC_ic_Jakobsen_wei(
  object,
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  epsilon = 0.05,
  level = 0.975
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TTC_ic_Jakobsen_wei_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="TTC_ic_Jakobsen_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="TTC_ic_Jakobsen_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="TTC_ic_Jakobsen_wei_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
<tr><td><code id="TTC_ic_Jakobsen_wei_+3A_level">level</code></td>
<td>
<p><code>1-alpha/2</code>-order quantile of a normal distribution</p>
</td></tr>
</table>

<hr>
<h2 id='TTC_ic_log_wei'>TTC_ic_log_wei function</h2><span id='topic+TTC_ic_log_wei'></span>

<h3>Description</h3>

<p>calculates the confidence interval of the time TTC using
delta method by assuming normality on log scale of TTC.
<code>IC = exp(log(TTC) +/- z*sqrt(var(log(TTC))))</code>,
where <code>Var(log(TTC)) = (dlog(TTC)/dtheta)Var(theta)(dlog(TTC)/dtheta)^T</code>.
</p>
<p>Note that this function is for mixture cure model with Weibull distribution
considered for uncured patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TTC_ic_log_wei(
  object,
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  epsilon = 0.05,
  level,
  TTC = NULL,
  Dttc = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TTC_ic_log_wei_+3A_object">object</code></td>
<td>
<p>An object of class <code>curesurv</code>.</p>
</td></tr>
<tr><td><code id="TTC_ic_log_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="TTC_ic_log_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="TTC_ic_log_wei_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
<tr><td><code id="TTC_ic_log_wei_+3A_level">level</code></td>
<td>
<p><code>1-alpha/2</code>-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="TTC_ic_log_wei_+3A_ttc">TTC</code></td>
<td>
<p>time to cure calculated by TTC_wei</p>
</td></tr>
<tr><td><code id="TTC_ic_log_wei_+3A_dttc">Dttc</code></td>
<td>
<p>partial derivates of TTC by dTTCdtheta_wei</p>
</td></tr>
</table>

<hr>
<h2 id='TTC_ic_multneh'>TTC_ic_multneh function</h2><span id='topic+TTC_ic_multneh'></span>

<h3>Description</h3>

<p>calculates confidence interval of the time TTC from a
non-mixture model with distribution &quot;tneh&quot;, link_tau=&quot;loglinear&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TTC_ic_multneh(
  z_alpha,
  z_tau,
  xmax,
  object,
  epsilon = epsilon,
  level = level,
  TTC = NULL,
  DpTTC = NULL,
  cumLexctopred = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TTC_ic_multneh_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="TTC_ic_multneh_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="TTC_ic_multneh_+3A_xmax">xmax</code></td>
<td>
<p>time max at which Pi(t) is calculated.</p>
</td></tr>
<tr><td><code id="TTC_ic_multneh_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="TTC_ic_multneh_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
<tr><td><code id="TTC_ic_multneh_+3A_level">level</code></td>
<td>
<p><code>1-alpha/2</code>-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="TTC_ic_multneh_+3A_ttc">TTC</code></td>
<td>
<p>The time to cure, if NULL it is recalculated</p>
</td></tr>
<tr><td><code id="TTC_ic_multneh_+3A_dpttc">DpTTC</code></td>
<td>
<p>partial derivatives, recalculated if not given</p>
</td></tr>
<tr><td><code id="TTC_ic_multneh_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction, calculated if NULL</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='TTC_ic_multneh_log'>TTC_ic_multneh_log function</h2><span id='topic+TTC_ic_multneh_log'></span>

<h3>Description</h3>

<p>Produce confidence interval of the time TTC with log method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TTC_ic_multneh_log(
  z_alpha,
  z_tau,
  xmax,
  object,
  epsilon = epsilon,
  level = level,
  TTC = NULL,
  DpTTC = NULL,
  cumLexctopred = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TTC_ic_multneh_log_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="TTC_ic_multneh_log_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="TTC_ic_multneh_log_+3A_xmax">xmax</code></td>
<td>
<p>time max at which Pi(t) is calculated.</p>
</td></tr>
<tr><td><code id="TTC_ic_multneh_log_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="TTC_ic_multneh_log_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
<tr><td><code id="TTC_ic_multneh_log_+3A_level">level</code></td>
<td>
<p><code>1-alpha/2</code>-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="TTC_ic_multneh_log_+3A_ttc">TTC</code></td>
<td>
<p>The time to cure, if NULL it is recalculated</p>
</td></tr>
<tr><td><code id="TTC_ic_multneh_log_+3A_dpttc">DpTTC</code></td>
<td>
<p>partial derivatives, recalculated if not given</p>
</td></tr>
<tr><td><code id="TTC_ic_multneh_log_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction, calculated if NULL</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='TTC_ic_wei'>TTC_ic_wei function</h2><span id='topic+TTC_ic_wei'></span>

<h3>Description</h3>

<p>calculates the confidence interval of the time TTC.
Note that this function is for mixture cure model with Weibull distribution
considered for uncured patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TTC_ic_wei(
  object,
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  epsilon = 0.05,
  level,
  TTC = NULL,
  Dttc = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TTC_ic_wei_+3A_object">object</code></td>
<td>
<p>An object of class <code>curesurv</code>.</p>
</td></tr>
<tr><td><code id="TTC_ic_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="TTC_ic_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="TTC_ic_wei_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
<tr><td><code id="TTC_ic_wei_+3A_level">level</code></td>
<td>
<p><code>1-alpha/2</code>-order quantile of a normal distribution</p>
</td></tr>
<tr><td><code id="TTC_ic_wei_+3A_ttc">TTC</code></td>
<td>
<p>time to cure calculated by TTC_wei</p>
</td></tr>
<tr><td><code id="TTC_ic_wei_+3A_dttc">Dttc</code></td>
<td>
<p>partial derivates of TTC by dTTCdtheta_wei</p>
</td></tr>
</table>

<hr>
<h2 id='TTC_multneh'>TTC_multneh function</h2><span id='topic+TTC_multneh'></span>

<h3>Description</h3>

<p>calculates the probability Pi(t) of being cured at a given time
t after diagnosis knowing that he/she was alive up to time t from a
Time-to-Null excess hazard model using numerical method, uniroot. In other
words,
Pi(t)=(probability of being cured and alive up to time t given xi)/
(probability of being alive up to time t given xi)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TTC_multneh(z_alpha, z_tau, xmax, object, epsilon = epsilon)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TTC_multneh_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="TTC_multneh_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="TTC_multneh_+3A_xmax">xmax</code></td>
<td>
<p>time max at which Pi(t) is calculated.</p>
</td></tr>
<tr><td><code id="TTC_multneh_+3A_object">object</code></td>
<td>
<p>ouput from a non mixture model with distribution &quot;tneh&quot;
from curesurv function, with link_tau=&quot;loglinear&quot;</p>
</td></tr>
<tr><td><code id="TTC_multneh_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='TTC_theoric_adtneh'>TTC_theoric_adtneh function</h2><span id='topic+TTC_theoric_adtneh'></span>

<h3>Description</h3>

<p>Product the value of TTC with TNEH model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TTC_theoric_adtneh(newdata, object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TTC_theoric_adtneh_+3A_newdata">newdata</code></td>
<td>
<p>newdata</p>
</td></tr>
<tr><td><code id="TTC_theoric_adtneh_+3A_object">object</code></td>
<td>
<p>An object of class <code>curesurv</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='TTC_wei'>TTC_wei function</h2><span id='topic+TTC_wei'></span>

<h3>Description</h3>

<p>calculates the probability Pi(t) of being cured at a given time
t after diagnosis knowing that he/she was alive up to time t. In other words,
Pi(t)=(probability of being cured and alive up to time t given xi)/
(probability of being alive up to time t given xi)
</p>
<p>Note that this function is for mixture cure model with Weibull distribution
considered for uncured patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TTC_wei(z_pcured = z_pcured, z_ucured = z_ucured, theta, epsilon = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TTC_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="TTC_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="TTC_wei_+3A_theta">theta</code></td>
<td>
<p>estimated parameters</p>
</td></tr>
<tr><td><code id="TTC_wei_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>
<p>Phillips N, Coldman A, McBride ML. Estimating cancer prevalence using
mixture models for cancer survival. Stat Med. 2002 May 15;21(9):1257-70.
doi: 10.1002/sim.1101. PMID: 12111877.
(<a href="https://pubmed.ncbi.nlm.nih.gov/12111877/">pubmed</a>)
</p>
<p>De Angelis R, Capocaccia R, Hakulinen T, Soderman B, Verdecchia A. Mixture
models for cancer survival analysis: application to population-based data
with covariates. Stat Med. 1999 Feb 28;18(4):441-54.
doi: 10.1002/(sici)1097-0258(19990228)18:4&lt;441::aid-sim23&gt;3.0.co;2-m.
PMID: 10070685.
(<a href="https://pubmed.ncbi.nlm.nih.gov/10070685/">pubmed</a>)
</p>

<hr>
<h2 id='var_logCumHaz_wei'>var_logCumHaz_wei function</h2><span id='topic+var_logCumHaz_wei'></span>

<h3>Description</h3>

<p>Calculates the variance of log of cumulative excess hazard with
delta method on the log-log of net survival scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var_logCumHaz_wei(
  object,
  z_ucured = z_ucured,
  z_pcured = z_pcured,
  x = x,
  cumLexctopred
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="var_logCumHaz_wei_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="var_logCumHaz_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="var_logCumHaz_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="var_logCumHaz_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="var_logCumHaz_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained with cumLexc_alphaweibull_topred</p>
</td></tr>
</table>

<hr>
<h2 id='var_pt_cure_wei'>var_pt_cure_wei function</h2><span id='topic+var_pt_cure_wei'></span>

<h3>Description</h3>

<p>Variance of p(t) with delta method. Var(p(t)) = (dp/dtheta)Var(theta)(dp/dtheta)^T
where Var(theta) is the variance-covariance matrix of theta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var_pt_cure_wei(
  object,
  z_pcured = z_pcured,
  z_ucured = z_ucured,
  x = x,
  cumLexctopred
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="var_pt_cure_wei_+3A_object">object</code></td>
<td>
<p>ouput from mixture cure model implemented in curesurv</p>
</td></tr>
<tr><td><code id="var_pt_cure_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="var_pt_cure_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="var_pt_cure_wei_+3A_x">x</code></td>
<td>
<p>time at which the estimates are predicted</p>
</td></tr>
<tr><td><code id="var_pt_cure_wei_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction obtained with cumLexc_alphaweibull_topred</p>
</td></tr>
</table>

<hr>
<h2 id='var_TTC_Jakobsen_wei'>var_TTC_Jakobsen_wei function</h2><span id='topic+var_TTC_Jakobsen_wei'></span>

<h3>Description</h3>

<p>Calculates the variance of TTC from a mixture cure model with
uncured survival as Weibull distribution using the Jakobsen approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var_TTC_Jakobsen_wei(
  object,
  z_ucured = z_ucured,
  z_pcured = z_pcured,
  epsilon = epsilon,
  TTC,
  cumLexc_topred_TTC
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="var_TTC_Jakobsen_wei_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="var_TTC_Jakobsen_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="var_TTC_Jakobsen_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="var_TTC_Jakobsen_wei_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
<tr><td><code id="var_TTC_Jakobsen_wei_+3A_ttc">TTC</code></td>
<td>
<p>time to cure TTC</p>
</td></tr>
<tr><td><code id="var_TTC_Jakobsen_wei_+3A_cumlexc_topred_ttc">cumLexc_topred_TTC</code></td>
<td>
<p>a pre prediction given by cumLexc_alphaweibull_topred</p>
</td></tr>
</table>

<hr>
<h2 id='var_TTC_multneh'>var_TTC_multneh function</h2><span id='topic+var_TTC_multneh'></span>

<h3>Description</h3>

<p>calculates the variance of TTC in a non-mixture model with
distribution &quot;TNEH&quot;, link_tau=&quot;loglinear&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var_TTC_multneh(
  z_alpha,
  z_tau,
  xmax,
  object,
  epsilon = epsilon,
  TTC = NULL,
  cumLexctopred = NULL,
  DpTTC = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="var_TTC_multneh_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="var_TTC_multneh_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="var_TTC_multneh_+3A_xmax">xmax</code></td>
<td>
<p>time max at which Pi(t) is calculated.</p>
</td></tr>
<tr><td><code id="var_TTC_multneh_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="var_TTC_multneh_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
<tr><td><code id="var_TTC_multneh_+3A_ttc">TTC</code></td>
<td>
<p>The time to cure, if NULL it is recalculated</p>
</td></tr>
<tr><td><code id="var_TTC_multneh_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction, calculated if NULL</p>
</td></tr>
<tr><td><code id="var_TTC_multneh_+3A_dpttc">DpTTC</code></td>
<td>
<p>partial derivatives, recalculated if not given</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='var_TTC_tneh2'>var_TTC_tneh2 function</h2><span id='topic+var_TTC_tneh2'></span>

<h3>Description</h3>

<p>calculates the variance of TTC in a non-mixture model with
distribution &quot;TNEH&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var_TTC_tneh2(
  z_alpha,
  z_tau,
  xmax,
  object,
  epsilon = epsilon,
  TTC,
  cumLexctopred = NULL,
  Dpttc = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="var_TTC_tneh2_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="var_TTC_tneh2_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="var_TTC_tneh2_+3A_xmax">xmax</code></td>
<td>
<p>time max at which Pi(t) is calculated.</p>
</td></tr>
<tr><td><code id="var_TTC_tneh2_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="var_TTC_tneh2_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
<tr><td><code id="var_TTC_tneh2_+3A_ttc">TTC</code></td>
<td>
<p>time to cure calculated by TTC_adtneh2</p>
</td></tr>
<tr><td><code id="var_TTC_tneh2_+3A_cumlexctopred">cumLexctopred</code></td>
<td>
<p>pre prediction, if NULL recalculated</p>
</td></tr>
<tr><td><code id="var_TTC_tneh2_+3A_dpttc">Dpttc</code></td>
<td>
<p>Partial derivatives of probability to be cure by theta which
can be evaluated at t = TTC, if NULL it is recalculated</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='var_TTC_wei'>var_TTC_wei function</h2><span id='topic+var_TTC_wei'></span>

<h3>Description</h3>

<p>Calculates the variance of TTC with delta method. The expression
of this variance is expressed as Var(TTC) = (dTTC/dtheta)Var(theta)(dTTC/dtheta)^T
where Var(theta) is the variance-covariance matrix of theta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var_TTC_wei(
  object,
  z_ucured = z_ucured,
  z_pcured = z_pcured,
  epsilon = epsilon,
  TTC
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="var_TTC_wei_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="var_TTC_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="var_TTC_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="var_TTC_wei_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
<tr><td><code id="var_TTC_wei_+3A_ttc">TTC</code></td>
<td>
<p>time to cure previously calculated using TTC_wei</p>
</td></tr>
</table>

<hr>
<h2 id='varexhaz_adtneh2'>varexhaz_adtneh2 function</h2><span id='topic+varexhaz_adtneh2'></span>

<h3>Description</h3>

<p>variance of excess hazard in non-mixture cure model with
distribution &quot;tneh&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varexhaz_adtneh2(z_tau = z_tau, z_alpha = z_alpha, x = x, object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="varexhaz_adtneh2_+3A_z_tau">z_tau</code></td>
<td>
<p>Covariates matrix acting on time-to-null parameter.</p>
</td></tr>
<tr><td><code id="varexhaz_adtneh2_+3A_z_alpha">z_alpha</code></td>
<td>
<p>Covariates matrix acting on parameter alpha of the density of
time-to-null excess hazard model</p>
</td></tr>
<tr><td><code id="varexhaz_adtneh2_+3A_x">x</code></td>
<td>
<p>time at which the predictions are provided</p>
</td></tr>
<tr><td><code id="varexhaz_adtneh2_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N, Remontet L,
Jooste V. Modeling excess hazard with time-to-cure as a parameter.
Biometrics. 2021 Dec;77(4):1289-1302. doi: 10.1111/biom.13361.
Epub 2020 Sep 12. PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>
<p>Boussari O, Romain G, Remontet L, Bossard N, Mounier M, Bouvier AM,
Binquet C, Colonna M, Jooste V. A new approach to estimate time-to-cure from
cancer registries data. Cancer Epidemiol. 2018 Apr;53:72-80.
doi: 10.1016/j.canep.2018.01.013. Epub 2018 Feb 4. PMID: 29414635.
(<a href="https://pubmed.ncbi.nlm.nih.gov/29414635/">pubmed</a>)
</p>

<hr>
<h2 id='varlogTTC_Jakobsen_wei'>varlogTTC_Jakobsen_wei function</h2><span id='topic+varlogTTC_Jakobsen_wei'></span>

<h3>Description</h3>

<p>Calculates the variance of log(TTC) from a mixture cure model with
uncured survival as Weibull distribution using the Jakobsen approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varlogTTC_Jakobsen_wei(
  object,
  z_ucured = z_ucured,
  z_pcured = z_pcured,
  epsilon = epsilon,
  TTC,
  cumLexc_topred_TTC
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="varlogTTC_Jakobsen_wei_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="varlogTTC_Jakobsen_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="varlogTTC_Jakobsen_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="varlogTTC_Jakobsen_wei_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
<tr><td><code id="varlogTTC_Jakobsen_wei_+3A_ttc">TTC</code></td>
<td>
<p>time to cure estimatec by TTC_wei</p>
</td></tr>
<tr><td><code id="varlogTTC_Jakobsen_wei_+3A_cumlexc_topred_ttc">cumLexc_topred_TTC</code></td>
<td>
<p>a pre prediction given by cumLexc_alphaweibull_topred</p>
</td></tr>
</table>

<hr>
<h2 id='varlogTTC_wei'>varlogTTC_wei function</h2><span id='topic+varlogTTC_wei'></span>

<h3>Description</h3>

<p>Calculates the variance of <code>log(TTC)</code>  with delta method.
The expression of this variance is expressed as:
<code>Var(log(TTC)) = (dlog(TTC)/dtheta)Var(theta)(dlog(TTC)/dtheta)^T</code>
</p>
<p>where Var(theta) is the variance-covariance matrix of theta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varlogTTC_wei(
  object = object,
  z_ucured = z_ucured,
  z_pcured = z_pcured,
  epsilon = epsilon,
  TTC
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="varlogTTC_wei_+3A_object">object</code></td>
<td>
<p>ouput from a model implemented in curesurv</p>
</td></tr>
<tr><td><code id="varlogTTC_wei_+3A_z_ucured">z_ucured</code></td>
<td>
<p>covariates matrix acting on survival function of uncured</p>
</td></tr>
<tr><td><code id="varlogTTC_wei_+3A_z_pcured">z_pcured</code></td>
<td>
<p>covariates matrix acting on cure proportion</p>
</td></tr>
<tr><td><code id="varlogTTC_wei_+3A_epsilon">epsilon</code></td>
<td>
<p>value fixed by user to estimate the TTC <code class="reqn">\text{Pi}(t)\geq (1-\epsilon)</code>.
By default <code class="reqn">\epsilon = 0.05</code>.</p>
</td></tr>
<tr><td><code id="varlogTTC_wei_+3A_ttc">TTC</code></td>
<td>
<p>time to cure previsouly estimated by TTC_wei</p>
</td></tr>
</table>

<hr>
<h2 id='z_alpha'>z_alpha function identifying variables acting on alpha parameter</h2><span id='topic+z_alpha'></span>

<h3>Description</h3>

<p>variables adjusted on alpha parameter in
non-mixture cure model with &quot;tneh&quot; specified for the distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>z_alpha(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="z_alpha_+3A_x">x</code></td>
<td>
<p>a simple formula.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the variable x
</p>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N,
Remontet L, Jooste V. Modeling excess hazard with time-to-cure
as a parameter. Biometrics. 2020 Aug 31.
doi: 10.1111/biom.13361. Epub ahead of print.
PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>

<hr>
<h2 id='z_riskpop.alpha'>z_riskpop.alpha function</h2><span id='topic+z_riskpop.alpha'></span>

<h3>Description</h3>

<p>indicator variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>z_riskpop.alpha(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="z_riskpop.alpha_+3A_x">x</code></td>
<td>
<p>a simple formula.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the variable x
</p>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N,
Remontet L, Jooste V. Modeling excess hazard with time-to-cure
as a parameter. Biometrics. 2020 Aug 31.
doi: 10.1111/biom.13361. Epub ahead of print.
PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>

<hr>
<h2 id='z_tau'>z_tau function identifying variables acting on tau parameter</h2><span id='topic+z_tau'></span>

<h3>Description</h3>

<p>variables adjusted on tau parameter in
non-mixture cure model with &quot;tneh&quot; specified for the distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>z_tau(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="z_tau_+3A_x">x</code></td>
<td>
<p>the name of the column in the dataset representing the variable that will act on tau parameter of the &quot;tneh&quot; model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the variable x
</p>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Olayide Boussari, Laura Botta, Valerie Jooste
</p>


<h3>References</h3>

<p>Boussari O, Bordes L, Romain G, Colonna M, Bossard N,
Remontet L, Jooste V. Modeling excess hazard with time-to-cure
as a parameter. Biometrics. 2020 Aug 31.
doi: 10.1111/biom.13361. Epub ahead of print.
PMID: 32869288.
(<a href="https://pubmed.ncbi.nlm.nih.gov/32869288/">pubmed</a>)
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
