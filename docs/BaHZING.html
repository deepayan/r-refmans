<!DOCTYPE html><html lang="en"><head><title>Help for package BaHZING</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BaHZING}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#BaHZING_Model'><p>BaHZING_Model Function</p>
This function implements the BaHZING model for microbiome data analysis.</a></li>
<li><a href='#Format_BaHZING'><p>Format_BaHZING Function</p></a></li>
<li><a href='#iHMP'><p>iHMP data</p></a></li>
<li><a href='#iHMP_Reduced'><p>iHMP_Reduced data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Bayesian Hierarchical Zero-Inflated Negative Binomial Regression
with G-Computation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>A Bayesian model for examining the association between
    environmental mixtures and all Taxa measured in a hierarchical
    microbiome dataset in a single integrated analysis. Compared with
    analyzing the associations of environmental mixtures with each Taxa
    individually, 'BaHZING' controls Type 1 error rates and provides more
    stable effect estimates when dealing with small sample sizes.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0), rjags (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>bayestestR, dplyr, magrittr, phyloseq, pscl, R2jags, stats,
stringr, tidyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Config/testthat/parallel:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>JAGS 4.x.y (http://mcmc-jags.sourceforge.net)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-13 20:53:48 UTC; jagoodri</td>
</tr>
<tr>
<td>Author:</td>
<td>Hailey Hampson [aut],
  Jesse Goodrich <a href="https://orcid.org/0000-0001-6615-0472"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Hongxu Wang [aut],
  Tanya Alderete [ctb],
  Shardul Nazirkar [ctb],
  David Conti [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jesse Goodrich &lt;jagoodri@usc.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-17 11:20:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='BaHZING_Model'>BaHZING_Model Function
This function implements the BaHZING model for microbiome data analysis.</h2><span id='topic+BaHZING_Model'></span>

<h3>Description</h3>

<p>BaHZING_Model Function
This function implements the BaHZING model for microbiome data analysis.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BaHZING_Model_+3A_formatted_data">formatted_data</code></td>
<td>
<p>An object containing formatted microbiome data.</p>
</td></tr>
<tr><td><code id="BaHZING_Model_+3A_x">x</code></td>
<td>
<p>A vector of column names of the exposures.</p>
</td></tr>
<tr><td><code id="BaHZING_Model_+3A_covar">covar</code></td>
<td>
<p>An optional vector of the column names of covariates.</p>
</td></tr>
<tr><td><code id="BaHZING_Model_+3A_n.chains">n.chains</code></td>
<td>
<p>An optional integer specifying the number of parallel chains
for the model in jags.model function. Default is 3.</p>
</td></tr>
<tr><td><code id="BaHZING_Model_+3A_n.adapt">n.adapt</code></td>
<td>
<p>An optional integer specifying the number of iterations for
adaptation in jags.model function. Default is 5000.</p>
</td></tr>
<tr><td><code id="BaHZING_Model_+3A_n.iter.burnin">n.iter.burnin</code></td>
<td>
<p>An optional integer specifying number of iterations in
update function. Default is 10000.</p>
</td></tr>
<tr><td><code id="BaHZING_Model_+3A_n.iter.sample">n.iter.sample</code></td>
<td>
<p>An optional integer specifying the number of iterations
in coda.samples function. Default is 10000.</p>
</td></tr>
<tr><td><code id="BaHZING_Model_+3A_exposure_standardization">exposure_standardization</code></td>
<td>
<p>Method for standardizing the exposures.
Should be one of &quot;standard_normal&quot; (the default), &quot;quantile&quot;, or &quot;none&quot;. If
&quot;none&quot;, exposures are not standardized before analysis, and counterfactual
profiles must be specified by the user.</p>
</td></tr>
<tr><td><code id="BaHZING_Model_+3A_counterfactual_profiles">counterfactual_profiles</code></td>
<td>
<p>A 2xP matrix or a vector with length of 2; P
is the number of exposures in x. If a 2xP matrix is provided,
the effect estimates for the mixture are interpreted as the estimated change
in the outcome when changing each exposure p in 1:P is changed from
<code>counterfactual_profiles[1,p]</code> to <code>counterfactual_profiles[2,p]</code>. If a vector of
length 2 is provided, the effect estimates for the mixture are interpreted as
the estimated change in the outcome when changing each exposure from
<code>counterfactual_profiles[1]</code> to <code>counterfactual_profiles[2]</code>. If
exposure_standardization = &quot;standard_normal&quot;, then the default is c(-0.5, 0.5),
and the effect estimate is calculated based on increasing all exposures in
the mixture by one standard deviation. If exposure_standardization = &quot;quantile&quot;,
then the default is c(0,1), and the effect estimate is calculated based on
increasing all exposures in the mixture by one quantile (where the number of
quantiles is based on the parameter q).</p>
</td></tr>
<tr><td><code id="BaHZING_Model_+3A_q">q</code></td>
<td>
<p>An integer specifying the number of quantiles. Only required if
exposure_standardization = &quot;quantile&quot;. If exposure_standardization =
&quot;quantile&quot; and q is not specified, then a default of q = 4 is used.</p>
</td></tr>
<tr><td><code id="BaHZING_Model_+3A_verbose">verbose</code></td>
<td>
<p>If TRUE (default), function returns information a data quality
check.</p>
</td></tr>
<tr><td><code id="BaHZING_Model_+3A_return_all_estimates">return_all_estimates</code></td>
<td>
<p>If FALSE (default), results do not include
the dispersion and omega estimates from the BaHZING model.</p>
</td></tr>
<tr><td><code id="BaHZING_Model_+3A_rope_range">ROPE_range</code></td>
<td>
<p>Region of practical equivalence (ROPE) for calculating
p_rope. Default is c(-0.1, 0.1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing results of the Bayesian analysis, with the
following columns:
</p>

<ul>
<li><p> taxa_full: Full Taxa information, including all levels of the taxonomy.
Taxanomic levels are split by two underscores ('__').
</p>
</li>
<li><p> taxa_name: Taxa name, which is the last level of the taxonomy.
</p>
</li>
<li><p> domain: domain of the taxa.
</p>
</li>
<li><p> exposure: Exposure name (either one of  the individual exposures, or the
mixture).
</p>
</li>
<li><p> component: Zero inflated model estimate or the Count model estimate.
</p>
</li>
<li><p> estimate: Point estimate of the posterior distributions.
</p>
</li>
<li><p> bci_lcl: 95% Bayesian Credible Interval Lower Limit. Calculated as the
equal tailed interval of posterior distributions using the quantiles method.
</p>
</li>
<li><p> bci_ucl: 95% Bayesian Credible Interval Upper Limit. Calculated as the
equal tailed interval of posterior distributions using the quantiles method.
</p>
</li>
<li><p> p_direction: The Probability of Direction, calculated with <code>bayestestR</code>. A
higher value suggests a higher probability that the estimate is strictly
positive or negative. In other words, the closer the value to 1, the higher
the probability that the estimate is non-zero. Values can not be less than
50%. From <code>bayestestR</code>: also known as the Maximum Probability of Effect
(MPE). This can be interpreted as the probability that a parameter (described
by its posterior distribution) is strictly positive or negative (whichever
is the most probable). Although differently expressed, this index is fairly
similar (i.e., is strongly correlated) to the frequentist p-value.
</p>
</li>
<li><p> p_rope: The probability that the estimate is not within the Region of
practical equivalence (ROPE), calculated with <code>bayestestR</code>. The proportion
of the whole posterior distribution that doesn't lie within the <code>ROPE_range</code>.
</p>
</li>
<li><p> p_map: Bayesian equivalent of the p-value, calculated with <code>bayestestR</code>.
From <code>bayestestR</code>:  p_map is related to the odds that a parameter (described
by its posterior distribution) has against the null hypothesis (h0) using
Mills' (2014, 2017) Objective Bayesian Hypothesis Testing framework. It
corresponds to the density value at the null (e.g., 0) divided by the
density at the Maximum A Posteriori (MAP).
</p>
</li></ul>


<hr>
<h2 id='Format_BaHZING'>Format_BaHZING Function</h2><span id='topic+Format_BaHZING'></span>

<h3>Description</h3>

<p>This function takes a phyloseq object and performs formatting operations on it,
including modifying the taxonomic table, uniting taxonomic levels, and creating
matrices based on taxonomic information.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Format_BaHZING_+3A_phyloseq.object">phyloseq.object</code></td>
<td>
<p>A phyloseq object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Format_BaHZING function is the core function of the Format_BaHZING package.
It takes a phyloseq object as input and performs various formatting operations
to prepare the data for analysis. The function modifies the taxonomic table to add
taxonomic prefixes (e.g., &quot;d__&quot; for Kingdom), unites taxonomic levels, and creates
matrices based on taxonomic information. The formatted data is then returned as a list
containing different data frames for further analysis.
</p>
<p>The package relies on the <code>phyloseq</code>, <code>dplyr</code>, and <code>stringr</code> packages for data manipulation,
and also uses functions from <code>tidyr</code> to unite taxonomic levels.
</p>
<p>The main function <code>Format_BaHZING</code> is exported and can be accessed by other packages or scripts
that depend on the functionalities provided by this package.
</p>
<p>The column names 'Kingdom', 'Phylum', 'Class', 'Order', 'Family', 'Genus', and 'Species'
in the tax_table of the phyloseq object should be user-defined and assigned in this function.
The function will use these column names to perform various operations.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>

<ul>
<li> <p><code>Table</code>: Formatted microbiome data as a data frame.
</p>
</li>
<li> <p><code>Species.Genus.Matrix</code>: Data frame for species-genus relationships (optional).
</p>
</li>
<li> <p><code>Genus.Family.Matrix</code>: Data frame for genus-family relationships (optional).
</p>
</li>
<li> <p><code>Family.Order.Matrix</code>: Data frame for family-order relationships (optional).
</p>
</li>
<li> <p><code>Order.Class.Matrix</code>: Data frame for order-class relationships (optional).
</p>
</li>
<li> <p><code>Class.Phylum.Matrix</code>: Data frame for class-phylum relationships (optional).
</p>
</li></ul>



<h3>Note</h3>

<p>The column names 'Kingdom', 'Phylum', 'Class', 'Order', 'Family', 'Genus', and 'Species' in the
tax_table are expected to be user-defined and assigned within the function.
</p>

<hr>
<h2 id='iHMP'>iHMP data</h2><span id='topic+iHMP'></span>

<h3>Description</h3>

<p>A subset of data from the Integrative Human Microbiome Project
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iHMP
</code></pre>


<h3>Format</h3>



<h4><code>iHMP</code></h4>

<p>A phyloseq object with microbiome data for 105 participants at their
first visit.
</p>



<h3>Source</h3>

<p>https://www.nature.com/articles/s41586-019-1237-9&gt;
</p>

<hr>
<h2 id='iHMP_Reduced'>iHMP_Reduced data</h2><span id='topic+iHMP_Reduced'></span>

<h3>Description</h3>

<p>A subset of data from the Integrative Human Microbiome Project
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iHMP_Reduced
</code></pre>


<h3>Format</h3>



<h4><code>iHMP_Reduced</code></h4>

<p>A phyloseq object with subset microbiome data for 105 participants at their
first visit.
</p>



<h3>Source</h3>

<p>https://www.nature.com/articles/s41586-019-1237-9&gt;
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
