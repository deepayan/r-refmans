<!DOCTYPE html><html><head><title>Help for package MultiKink</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MultiKink}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MultiKink-package'><p>MultiKink: Estimation and Inference for Multi-Kink Quantile Regression</p></a></li>
<li><a href='#fit.control'><p>Auxiliary parameters to control the model fitting</p></a></li>
<li><a href='#KinkTest'><p>Test the existence of kink effect in the multi-kink quantile regression</p></a></li>
<li><a href='#mkqr.bea'><p>Fit the multi-kink quantile regression in the absence of the number of change points.</p></a></li>
<li><a href='#mkqr.fit'><p>Fit the multi-kink quantile regression conditional on a given or pre-specified number of change points.</p></a></li>
<li><a href='#triceps'><p>Triceps Skinfold Thickness Dataset</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation and Inference for Multi-Kink Quantile Regression</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation and inference for multiple kink quantile regression for longitudinal data and the i.i.d data. A bootstrap restarting iterative segmented quantile algorithm is proposed to estimate the multiple kink quantile regression model conditional on a given number of change points. The number of kinks is also allowed to be unknown. In such case, the backward elimination algorithm and the bootstrap restarting iterative segmented quantile algorithm are combined to select the number of change points based on a quantile BIC. For longitudinal data, we also develop the GEE estimator to incorporate the within-subject correlations.  A score-type based test statistic is also developed for testing the existence of kink effect. The package is based on the paper, &ldquo;Wei Zhong, Chuang Wan and Wenyang Zhang (2022). Estimation and inference for multikink quantile regression, JBES&rdquo; and &ldquo;Chuang Wan, Wei Zhong, Wenyang Zhang and Changliang Zou (2022). Multi-kink quantile regression for longitudinal data with application to progesterone data analysis, Biometrics". </td>
</tr>
<tr>
<td>Imports:</td>
<td>Matrix, quantreg, methods, gam, utils, stats, pracma</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Author:</td>
<td>Chuang Wan [aut, cre],
  Wei Zhong [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chuang Wan &lt;wanchuanghnu@126.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-05 15:22:10 UTC; zenghao</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-05 18:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='MultiKink-package'>MultiKink: Estimation and Inference for Multi-Kink Quantile Regression</h2><span id='topic+MultiKink'></span><span id='topic+MultiKink-package'></span>

<h3>Description</h3>

<p>Estimation and inference for multiple kink quantile regression for longitudinal data and the i.i.d data. A bootstrap restarting iterative segmented quantile algorithm is proposed to estimate the multiple kink quantile regression model conditional on a given number of change points. The number of kinks is also allowed to be unknown. In such case, the backward elimination algorithm and the bootstrap restarting iterative segmented quantile algorithm are combined to select the number of change points based on a quantile BIC. For longitudinal data, we also develop the GEE estimator to incorporate the within-subject correlations. A score-type based test statistic is also developed for testing the existence of kink effect. The package is based on the paper, &ldquo;Wei Zhong, Chuang Wan and Wenyang Zhang (2022). Estimation and inference for multikink quantile regression, JBES&rdquo; and &ldquo;Chuang Wan, Wei Zhong, Wenyang Zhang and Changliang Zou (2022). Multi-kink quantile regression for longitudinal data with application to progesterone data analysis, Biometrics&quot;.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Chuang Wan <a href="mailto:wanchuanghnu@126.com">wanchuanghnu@126.com</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Wei Zhong <a href="mailto:wzhong@xmu.edu.cn">wzhong@xmu.edu.cn</a>
</p>
</li></ul>


<hr>
<h2 id='fit.control'>Auxiliary parameters to control the model fitting</h2><span id='topic+fit.control'></span>

<h3>Description</h3>

<p>This function defines auxiliary parameters that control the model fitting process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.control(
  toll = 1e-04,
  h = 1,
  it.max = 50,
  K.max = 6,
  stop.if.error = TRUE,
  dev0 = NULL,
  visual = FALSE,
  visualBoot = FALSE,
  pow = c(1, 1),
  digits = NULL,
  grid = NULL,
  n.boot = 20
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.control_+3A_toll">toll</code></td>
<td>
<p>Positive convergence tolerance.</p>
</td></tr>
<tr><td><code id="fit.control_+3A_h">h</code></td>
<td>
<p>Positive factor (from zero to one) modifying the increments in kink parameter updates during the iterative process.</p>
</td></tr>
<tr><td><code id="fit.control_+3A_it.max">it.max</code></td>
<td>
<p>Positive integer for the maximal number of iterations.</p>
</td></tr>
<tr><td><code id="fit.control_+3A_k.max">K.max</code></td>
<td>
<p>Positive integer for the maximal given number of kink points.</p>
</td></tr>
<tr><td><code id="fit.control_+3A_stop.if.error">stop.if.error</code></td>
<td>
<p>Logical indicating if the estimation algorithm should be stopped if some kink point estimators belong to the non-admissible set. Default is FALSE which suggests removing the non-admissible change points automatically.</p>
</td></tr>
<tr><td><code id="fit.control_+3A_dev0">dev0</code></td>
<td>
<p>Initial objective value or deviance. Default is NULL which implies that the initial value is unknown.</p>
</td></tr>
<tr><td><code id="fit.control_+3A_visual">visual</code></td>
<td>
<p>Logical indicating if the results of the estimation process should be printed at each iteration.</p>
</td></tr>
<tr><td><code id="fit.control_+3A_visualboot">visualBoot</code></td>
<td>
<p>Logical indicating if the results of estimation should be printed at each iteration in the bootstrap restarting process.</p>
</td></tr>
<tr><td><code id="fit.control_+3A_pow">pow</code></td>
<td>
<p>The powers of the pseudo covariates employed by the algorithm.</p>
</td></tr>
<tr><td><code id="fit.control_+3A_digits">digits</code></td>
<td>
<p>If specified, it means the desired number of decimal points of the kink estimators to be used during the iterative algorithm.</p>
</td></tr>
<tr><td><code id="fit.control_+3A_grid">grid</code></td>
<td>
<p>It measures how close between the two adjacent change points should be merged, default is NULL.</p>
</td></tr>
<tr><td><code id="fit.control_+3A_n.boot">n.boot</code></td>
<td>
<p>Positive integer indicating the times of bootstrap re-sampling in the bootstrap restarting algorithm, default is 20.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the arguments as components to be used by <em>mkqr.fit</em> and <em>mkqr.bea</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example usage
fit.control(K.max=8)

</code></pre>

<hr>
<h2 id='KinkTest'>Test the existence of kink effect in the multi-kink quantile regression</h2><span id='topic+KinkTest'></span>

<h3>Description</h3>

<p>This function tests the existence of a kink effect in the multi-kink quantile regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KinkTest(
  y,
  thre.x,
  cont.z,
  id,
  tau = 0.5,
  NB = 200,
  sparsity = "nid",
  bandwidth_type = c("Hall-Sheather", "Bofinger", "Chamberlain")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KinkTest_+3A_y">y</code></td>
<td>
<p>A numeric vector of response.</p>
</td></tr>
<tr><td><code id="KinkTest_+3A_thre.x">thre.x</code></td>
<td>
<p>A numeric vector of scalar covariate with threshold effect.</p>
</td></tr>
<tr><td><code id="KinkTest_+3A_cont.z">cont.z</code></td>
<td>
<p>A numeric matrix of design covariates with constant slopes.</p>
</td></tr>
<tr><td><code id="KinkTest_+3A_id">id</code></td>
<td>
<p>A numeric vector of index used for longitudinal data; can be missing or NULL for iid data.</p>
</td></tr>
<tr><td><code id="KinkTest_+3A_tau">tau</code></td>
<td>
<p>A numeric scalar representing the quantile level (default is 0.5).</p>
</td></tr>
<tr><td><code id="KinkTest_+3A_nb">NB</code></td>
<td>
<p>An integer specifying the resampling times (default is 200).</p>
</td></tr>
<tr><td><code id="KinkTest_+3A_sparsity">sparsity</code></td>
<td>
<p>The error term type. Specify one from &quot;iid&quot; and &quot;nid&quot; (default is &quot;nid&quot;).</p>
</td></tr>
<tr><td><code id="KinkTest_+3A_bandwidth_type">bandwidth_type</code></td>
<td>
<p>The bandwidth type. Specify one from &quot;Hall-Sheather&quot;, &quot;Bofinger&quot;, or &quot;Chamberlain&quot; (default is &quot;Hall-Sheather&quot;).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the p-value (pv), the statistic based on the original data (Tn), and the statistics by wild bootstrap (Tn.NB).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: i.i.d data type
library(quantreg)
n = 200
Z1 &lt;- rexp(n,1)
Z2 &lt;- rbinom(n,1,0.5)
Z &lt;- cbind(Z1,Z2)
epsilon &lt;- rnorm(n,0,1)
X &lt;- runif(n,-2,1)
psi &lt;- c(-1,0)
k &lt;- length(psi)
PSI &lt;- matrix(rep(psi,rep(n,k)),ncol=k)
XP &lt;- matrix(rep(X,k),nrow=n)
XR &lt;- cbind(1,X,pmax((XP-PSI),0),Z)
bet &lt;- c(1,-1,0,0,sqrt(3),-sqrt(3))
Y &lt;- XR %*% bet + epsilon
obj &lt;- KinkTest(y=Y,thre.x=X,cont.z=Z,
                bandwidth_type=c("Hall-Sheather"))
obj$pv

## Not run: 
# Example 2: longitudinal data
library(quantreg)
N = 200
T = 5
subject = rep(1:N,each=T)
NT = N*T
Z1 &lt;- rexp(NT,1)
Z2 &lt;- rbinom(NT,1,0.5)
Z &lt;- cbind(Z1,Z2)
epsilon &lt;- rnorm(NT,0,1)
X &lt;- runif(NT,-2,1)
psi &lt;- c(-1,0)
k &lt;- length(psi)
PSI &lt;- matrix(rep(psi,rep(NT,k)),ncol=k)
a &lt;- rnorm(N,0,1)
A &lt;- rep(a,each=T)
XP &lt;- matrix(rep(X,k),nrow=NT)
XR &lt;- cbind(1,X,pmax((XP-PSI),0),Z)
bet &lt;- c(1,-1,0,0,sqrt(3),-sqrt(3))
Y &lt;- XR %*% bet + A + epsilon
obj &lt;- KinkTest(y=Y,thre.x=X,cont.z=Z,id=subject,
                bandwidth_type=c("Hall-Sheather"))
obj$pv

## End(Not run)
</code></pre>

<hr>
<h2 id='mkqr.bea'>Fit the multi-kink quantile regression in the absence of the number of change points.</h2><span id='topic+mkqr.bea'></span>

<h3>Description</h3>

<p>Fit the multi-kink quantile regression in the absence of the number of change points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkqr.bea(
  y,
  thre.x,
  cont.z,
  id,
  tau = 0.5,
  Cn = 1,
  bandwidth_type = "Hall-Sheather",
  control = fit.control(),
  est.type = "WI",
  wi.type = "general",
  wc.type = "cs"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mkqr.bea_+3A_y">y</code></td>
<td>
<p>A numeric vector of response.</p>
</td></tr>
<tr><td><code id="mkqr.bea_+3A_thre.x">thre.x</code></td>
<td>
<p>A numeric vector of scalar covariate with threshold effect.</p>
</td></tr>
<tr><td><code id="mkqr.bea_+3A_cont.z">cont.z</code></td>
<td>
<p>A numeric matrix of design with constant slopes.</p>
</td></tr>
<tr><td><code id="mkqr.bea_+3A_id">id</code></td>
<td>
<p>A numeric vector of index used for longitudinal data; can be missing or NULL for iid data.</p>
</td></tr>
<tr><td><code id="mkqr.bea_+3A_tau">tau</code></td>
<td>
<p>The quantile level that belongs to (0,1). Default is 0.5.</p>
</td></tr>
<tr><td><code id="mkqr.bea_+3A_cn">Cn</code></td>
<td>
<p>A positive number corresponding to different types of BIC. Default is 1.</p>
</td></tr>
<tr><td><code id="mkqr.bea_+3A_bandwidth_type">bandwidth_type</code></td>
<td>
<p>The bandwidth type. Specify one from &quot;Hall-Sheather&quot;, &quot;Bofinger&quot;, and &quot;Chamberlain&quot;. Default is &quot;Hall-Sheather&quot;.</p>
</td></tr>
<tr><td><code id="mkqr.bea_+3A_control">control</code></td>
<td>
<p>A list returned by fit.control.</p>
</td></tr>
<tr><td><code id="mkqr.bea_+3A_est.type">est.type</code></td>
<td>
<p>The estimation type for the longitudinal data. Specify one from &quot;WI&quot;, &quot;WC&quot;, corresponding to the working independence (WI) estimator and working correlation (WC) estimator. Default is &quot;WI&quot;.</p>
</td></tr>
<tr><td><code id="mkqr.bea_+3A_wi.type">wi.type</code></td>
<td>
<p>If est.type = &quot;WI&quot;, then set the error structure of the variance-covariance matrix estimation. Specify one from &quot;Compound&quot;, &quot;AR&quot;, and &quot;general&quot;.</p>
</td></tr>
<tr><td><code id="mkqr.bea_+3A_wc.type">wc.type</code></td>
<td>
<p>If est.type = &quot;WC&quot;, then set the correlation structure within subject. Specify one from &quot;ar&quot; and &quot;cs&quot;. Default is &quot;cs&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the estimated number of kink points (n.psi), the fitted quantile objective value (rho), estimated regression coefficients with intercept (bet.est), the estimated standard error of the regression coefficients (bet.se), the estimated change points (psi.est), and the estimated standard errors of threshold parameters (psi.se).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Simple examples for iid data type
n &lt;- 500
Z1 &lt;- rexp(n,1)
Z2 &lt;- rbinom(n,1,0.5)
Z &lt;- cbind(Z1,Z2)
epsilon &lt;- rnorm(n,0,1)
X &lt;- runif(n,-2,1)
psi &lt;- c(-1,0)
k &lt;- length(psi)
PSI &lt;- matrix(rep(psi,rep(n,k)),ncol=k)
XP &lt;- matrix(rep(X,k),nrow=n)
XR &lt;- cbind(1,X,pmax((XP-PSI),0),Z)
bet &lt;- c(1,-1,3,-3,sqrt(3),-sqrt(3))
Y &lt;- XR %*% bet + epsilon

# Estimation setting
tau &lt;- 0.5
K.max &lt;- 5
control &lt;- fit.control(K.max = K.max)
Cn &lt;- 1
mkqr.bea(y = Y, thre.x = X, cont.z = Z, tau = tau, Cn = Cn, control = control)

# Simple examples for longitudinal data
N &lt;- 200
T &lt;- 5
subject &lt;- rep(1:N, each = T)
NT &lt;- N * T
Z1 &lt;- rexp(NT, 1)
Z2 &lt;- rbinom(NT, 1, 0.5)
Z &lt;- cbind(Z1, Z2)
epsilon &lt;- rnorm(NT, 0, 1)
X &lt;- runif(NT, -2, 1)
psi &lt;- c(-1, 0)
k &lt;- length(psi)
PSI &lt;- matrix(rep(psi, rep(NT, k)), ncol = k)
a &lt;- rnorm(N, 0, 1)
A &lt;- rep(a, each = T)
XP &lt;- matrix(rep(X, k), nrow = NT)
XR &lt;- cbind(1, X, pmax((XP - PSI), 0), Z)
bet &lt;- c(1, -1, 3, -3, sqrt(3), -sqrt(3))
Y &lt;- XR %*% bet + A + epsilon
tau &lt;- 0.5
k &lt;- 2

# Example 1: the working independence estimator; the error structure is "general"
est.type &lt;- "WI"
wi.type &lt;- "Compound"
tau &lt;- 0.5
K.max &lt;- 5
control &lt;- fit.control(K.max = K.max)
Cn &lt;- 1
mkqr.bea(y = Y, thre.x = X, cont.z = Z, id = subject, tau = tau, Cn = Cn,
         control = control, est.type = est.type, wi.type = wi.type)

# Example 2: the working correlated estimator; the correlation structure is "cs"
est.type &lt;- "WC"
wc.type &lt;- "cs"
tau &lt;- 0.5
K.max &lt;- 5
control &lt;- fit.control(K.max = K.max)
Cn &lt;- 1
mkqr.bea(y = Y, thre.x = X, cont.z = Z, id = subject, tau = tau, Cn = Cn,
         control = control, est.type = est.type, wc.type = wc.type)

## End(Not run)

</code></pre>

<hr>
<h2 id='mkqr.fit'>Fit the multi-kink quantile regression conditional on a given or pre-specified number of change points.</h2><span id='topic+mkqr.fit'></span>

<h3>Description</h3>

<p>Fit the multi-kink quantile regression conditional on a given or pre-specified number of change points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkqr.fit(
  y,
  thre.x,
  cont.z,
  id,
  tau = 0.5,
  k,
  psi = NULL,
  bandwidth_type = "Hall-Sheather",
  control = fit.control(),
  est.type = "WI",
  wi.type = "general",
  wc.type = "cs"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mkqr.fit_+3A_y">y</code></td>
<td>
<p>A numeric vector of response.</p>
</td></tr>
<tr><td><code id="mkqr.fit_+3A_thre.x">thre.x</code></td>
<td>
<p>A numeric vector of scalar covariate with threshold effect.</p>
</td></tr>
<tr><td><code id="mkqr.fit_+3A_cont.z">cont.z</code></td>
<td>
<p>A numeric matrix of design with constant slopes.</p>
</td></tr>
<tr><td><code id="mkqr.fit_+3A_id">id</code></td>
<td>
<p>A numeric vector of index used for longitudinal data; can be missing or NULL for iid data.</p>
</td></tr>
<tr><td><code id="mkqr.fit_+3A_tau">tau</code></td>
<td>
<p>The quantile level that belongs to (0,1).</p>
</td></tr>
<tr><td><code id="mkqr.fit_+3A_k">k</code></td>
<td>
<p>The pre-specified number of change points.</p>
</td></tr>
<tr><td><code id="mkqr.fit_+3A_psi">psi</code></td>
<td>
<p>Numeric vector to indicate the starting values for the change points. When psi=NULL (default), k quantiles are assumed.</p>
</td></tr>
<tr><td><code id="mkqr.fit_+3A_bandwidth_type">bandwidth_type</code></td>
<td>
<p>The bandwidth type. Specify one from &quot;Hall-Sheather&quot;, &quot;Bofinger&quot;, and &quot;Chamberlain&quot;. Default is &quot;Hall-Sheather&quot;.</p>
</td></tr>
<tr><td><code id="mkqr.fit_+3A_control">control</code></td>
<td>
<p>A list returned by fit.control.</p>
</td></tr>
<tr><td><code id="mkqr.fit_+3A_est.type">est.type</code></td>
<td>
<p>The estimation type for the longitudinal data. Specify one from &quot;WI&quot;, &quot;WC&quot;, corresponding to the working independence (WI) estimator and working correlation (WC) estimator. Default is &quot;WI&quot;.</p>
</td></tr>
<tr><td><code id="mkqr.fit_+3A_wi.type">wi.type</code></td>
<td>
<p>If est.type = &quot;WI&quot;, then set the error structure of the variance-covariance matrix estimation. Specify one from &quot;Compound&quot;, &quot;AR&quot; and &quot;general&quot;.</p>
</td></tr>
<tr><td><code id="mkqr.fit_+3A_wc.type">wc.type</code></td>
<td>
<p>If est.type = &quot;WC&quot;, then set the correlation structure within subject. Specify one from &quot;ar&quot; and &quot;cs&quot;. Default is &quot;cs&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the estimated regression coefficients with intercept (bet.est), the estimated standard error of the regression coefficients (bet.se), the estimated change points (psi.est), the estimated standard errors of threshold parameters (psi.se), and the fitted quantile objective value (rho).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Simple examples for iid data type
n &lt;- 500
Z1 &lt;- rexp(n, 1)
Z2 &lt;- rbinom(n, 1, 0.5)
Z &lt;- cbind(Z1, Z2)
epsilon &lt;- rnorm(n, 0, 1)
X &lt;- runif(n, -2, 1)
psi &lt;- c(-1, 0)
k &lt;- length(psi)
Y &lt;- XR %*% bet + epsilon
result_iid &lt;- mkqr.fit(Y, X, Z, tau = 0.5, k = k)

# Simple examples for longitudinal data
N &lt;- 200
T &lt;- 5
subject &lt;- rep(1:N, each = T)
NT &lt;- N * T
Z1 &lt;- rexp(NT, 1)
Z2 &lt;- rbinom(NT, 1, 0.5)
Z &lt;- cbind(Z1, Z2)
epsilon &lt;- rnorm(NT, 0, 1)
X &lt;- runif(NT, -2, 1)
psi &lt;- c(-1, 0)
k &lt;- length(psi)
PSI &lt;- matrix(rep(psi, rep(NT, k)), ncol = k)
a &lt;- rnorm(N, 0, 1)
A &lt;- rep(a, each = T)
XP &lt;- matrix(rep(X, k), nrow = NT)
XR &lt;- cbind(1, X, pmax((XP - PSI), 0), Z)
bet &lt;- c(1, -1, 3, -3, sqrt(3), -sqrt(3))
Y &lt;- XR %*% bet + A + epsilon
tau = 0.5
k = 2

# Example 1: the working independence estimator; the error structure is "general"
est.type = "WI";
wi.type = "Compound"
result_WI_Compound &lt;- mkqr.fit(y = Y, thre.x = X, cont.z = Z, id = subject, tau = tau,
                               k = k, est.type = est.type, wi.type = wi.type)

# Example 2: the working correlated estimator; the correlation structure is "cs"
est.type = "WC";
wc.type = "cs"
result_WC_cs &lt;- mkqr.fit(y = Y, thre.x = X, cont.z = Z, id = subject, tau = tau,
                         k = k, est.type = est.type, wc.type = wc.type)


## End(Not run)
</code></pre>

<hr>
<h2 id='triceps'>Triceps Skinfold Thickness Dataset</h2><span id='topic+triceps'></span>

<h3>Description</h3>

<p>The data are derived from an anthropometric study of 892 females under 50 years in three Gambian villages in West Africa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(triceps)
</code></pre>


<h3>Format</h3>

<p>A data frame with 892 observations on the following 3 variables:
</p>

<dl>
<dt><code>age</code></dt><dd><p>Age of respondents.</p>
</dd>
<dt><code>lntriceps</code></dt><dd><p>Log of the triceps skinfold thickness.</p>
</dd>
<dt><code>triceps</code></dt><dd><p>Triceps skinfold thickness.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Cole T.J., Green P.J. (1992). Smoothing reference centile curves: the LMS method and penalized likelihood. Statistics in medicine, 11(10): 1305-1319.
</p>


<h3>References</h3>

<p>Cole T.J., Green P.J. (1992). Smoothing reference centile curves: the LMS method and penalized likelihood. Statistics in medicine, 11(10): 1305-1319.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(triceps)
## maybe str(triceps) ...
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
