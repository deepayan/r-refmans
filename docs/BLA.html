<!DOCTYPE html><html><head><title>Help for package BLA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BLA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BLA-package'><p>BLA: Boundary Line Analysis</p></a></li>
<li><a href='#blbin'><p>Binning method for determining the boundary line model</p></a></li>
<li><a href='#ble_profile'><p>Likelihood profile for various measurement error values</p></a></li>
<li><a href='#blqr'><p>Boundary line model determination using quantile regression</p></a></li>
<li><a href='#bolides'><p>Boundary line determination technique</p></a></li>
<li><a href='#cbvn'><p>Fitting boundary line using censored bivariate normal model</p></a></li>
<li><a href='#evapotranspiration'><p>Evapotranspiration data</p></a></li>
<li><a href='#expl_boundary'><p>Testing evidence of boundary existence in dataset</p></a></li>
<li><a href='#kurt'><p>kurtosis</p></a></li>
<li><a href='#limfactor'><p>Determination of the most limiting factor to biological response</p></a></li>
<li><a href='#na.drop'><p>Remove NA values</p></a></li>
<li><a href='#ocskew'><p>Octile Skewness</p></a></li>
<li><a href='#predictBL'><p>Predict boundary response</p></a></li>
<li><a href='#print.cm'><p>Print class cm</p></a></li>
<li><a href='#print.wm'><p>Print class wm</p></a></li>
<li><a href='#seHessian'><p>Hessian matrix</p></a></li>
<li><a href='#skew'><p>Skewness</p></a></li>
<li><a href='#soil'><p>Soil survey data</p></a></li>
<li><a href='#SoilP'><p>Soil Phosphorus data</p></a></li>
<li><a href='#SoilpH'><p>Soil pH data</p></a></li>
<li><a href='#startValues'><p>Starting values for optimization functions</p></a></li>
<li><a href='#summastat'><p>Summary statistics</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Boundary Line Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits boundary line models to datasets as proposed by Webb
    (1972) &lt;<a href="https://doi.org/10.1080%2F00221589.1972.11514472">doi:10.1080/00221589.1972.11514472</a>&gt; and makes statistical
    inferences about their parameters. Provides additional tools for
    testing datasets for evidence of boundary presence and selecting
    initial starting values for model optimization prior to fitting the
    boundary line models. It also includes tools for conducting post-hoc
    analyses such as predicting boundary values and identifying the most
    limiting factor (Miti, Milne, Giller, Lark (2024)
    &lt;<a href="https://doi.org/10.1016%2Fj.fcr.2024.109365">doi:10.1016/j.fcr.2024.109365</a>&gt;). This ensures a comprehensive
    analysis for datasets that exhibit upper boundary structures.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://chawezimiti.github.io/BLA/">https://chawezimiti.github.io/BLA/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/chawezimiti/BLA/issues">https://github.com/chawezimiti/BLA/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table, MASS, mvtnorm, numDeriv, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-28 13:48:22 UTC; stxcm28</td>
</tr>
<tr>
<td>Author:</td>
<td>Chawezi Miti <a href="https://orcid.org/0000-0001-7776-8366"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut, cph],
  Richard M Lark <a href="https://orcid.org/0000-0003-2571-8521"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Alice E Milne <a href="https://orcid.org/0000-0002-4509-0578"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Ken E Giller <a href="https://orcid.org/0000-0002-5998-4652"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Victor O Sadras [ctb],
  University of Nottingham/Rothamsted Research [fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chawezi Miti &lt;chawezi.miti@nottingham.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-28 16:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='BLA-package'>BLA: Boundary Line Analysis</h2><span id='topic+BLA'></span><span id='topic+BLA-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Fits boundary line models to datasets as proposed by Webb (1972) <a href="https://doi.org/10.1080/00221589.1972.11514472">doi:10.1080/00221589.1972.11514472</a> and makes statistical inferences about their parameters. Provides additional tools for testing datasets for evidence of boundary presence and selecting initial starting values for model optimization prior to fitting the boundary line models. It also includes tools for conducting post-hoc analyses such as predicting boundary values and identifying the most limiting factor (Miti, Milne, Giller, Lark (2024) <a href="https://doi.org/10.1016/j.fcr.2024.109365">doi:10.1016/j.fcr.2024.109365</a>). This ensures a comprehensive analysis for datasets that exhibit upper boundary structures.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Chawezi Miti <a href="mailto:chawezi.miti@nottingham.ac.uk">chawezi.miti@nottingham.ac.uk</a> (<a href="https://orcid.org/0000-0001-7776-8366">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Richard M Lark (<a href="https://orcid.org/0000-0003-2571-8521">ORCID</a>)
</p>
</li>
<li><p> Alice E Milne (<a href="https://orcid.org/0000-0002-4509-0578">ORCID</a>)
</p>
</li>
<li><p> Ken E Giller (<a href="https://orcid.org/0000-0002-5998-4652">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Victor O Sadras [contributor]
</p>
</li>
<li><p> University of Nottingham/Rothamsted Research [funder]
</p>
</li></ul>



<h3>References</h3>

<p>Lark, R. M., &amp; Milne, A. E. (2016). Boundary line analysis of the
effect of water filled pore space on nitrous oxide emission from
cores of arable soil. European Journal of Soil Science, 67 ,
148-159.
</p>
<p>Milne, A. E., Ferguson, R. B., &amp; Lark, R. M. (2006). Estimating a
boundary line model for a biological response by maximum likelihood.
Annals of Applied Biology, 149, 223â€“234.
</p>
<p>Schnug, E., Heym, J. M., &amp; Murphy, D. P. L. (1995). Boundary line
determination technique (BOLIDES). In P. C. Robert, R. H. Rust, &amp;
W. E. Larson (Eds.), site specific management for agricultural
systems (p. 899-908). Wiley Online Library.
</p>
<p>Webb, R. A. (1972). Use of the boundary line in analysis of biological
data. Journal of Horticultural Science, 47, 309-319.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://chawezimiti.github.io/BLA/">https://chawezimiti.github.io/BLA/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/chawezimiti/BLA/issues">https://github.com/chawezimiti/BLA/issues</a>
</p>
</li></ul>


<hr>
<h2 id='blbin'>Binning method for determining the boundary line model</h2><span id='topic+blbin'></span>

<h3>Description</h3>

<p>This function fits a boundary model to the upper bounds of a scatter plot of
<code>x</code> and <code>y</code> based on the binning method. The data are first divided
into equal sized sections in the x-axis and a boundary point in each section
is selected based on a set criteria (e.g. 0.90, 0.95 or 0.99 percentile of
<code>y</code> among other criteria). A model is then fitted to the resulting boundary
points by the least squares method. This is done using optimization procedure
and hence requires some starting guess parameters for the proposed model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blbin(x,y,bins, model="explore", equation=NULL, start, tau=0.95,
      optim.method="Nelder-Mead", xmin=min(bound$x), xmax=max(bound$x),plot=TRUE,
      bp_col="red", bp_pch=16, bl_col="red", lwd=1,line_smooth=1000,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="blbin_+3A_x">x</code></td>
<td>
<p>A numeric vector of values for the independent variable.</p>
</td></tr>
<tr><td><code id="blbin_+3A_y">y</code></td>
<td>
<p>A numeric vector of values for the response variable.</p>
</td></tr>
<tr><td><code id="blbin_+3A_bins">bins</code></td>
<td>
<p>A numeric vector of length 3 or 4 that determines the size of sections.
The first and second values give the range of the data to be binned while the
third and fourth values give the width of the bins and the step size
respectively. If only three values are provided, the step size is assumed to be
equal to bin width.</p>
</td></tr>
<tr><td><code id="blbin_+3A_model">model</code></td>
<td>
<p>Selects the functional form of the boundary line. It includes
<code>"explore"</code> as default, <code>"blm"</code> for linear model, <code>"lp"</code> for
linear plateau model, <code>"mit"</code> for the Mitscherlich model, <code>"schmidt"</code>
for the Schmidt model, <code>"logistic"</code> for logistic model, <code>"logisticND"</code>
for logistic model proposed by Nelder (1961), <code>"inv-logistic"</code> for
the inverse logistic model, <code>"double-logistic"</code> for the double logistic model,
<code>"qd"</code> for quadratic model and the <code>"trapezium"</code> for the trapezium model.
The <code>"explore"</code> is used to check the position of boundary points in each bin
so that the correct <code>model</code> can be applied. For custom models, set
<code>model = "other"</code>.</p>
</td></tr>
<tr><td><code id="blbin_+3A_equation">equation</code></td>
<td>
<p>A custom model function writen in the form of an R function. Applies
only when argument <code>model="other"</code>, else it is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="blbin_+3A_start">start</code></td>
<td>
<p>A numeric vector of initial starting values for optimization
in fitting the boundary model. Its length and arrangement depend on the
suggested model: </p>

<ul>
<li><p> For the <code>"blm"</code> model, it is a vector of length 2 arranged as intercept
and slope.
</p>
</li>
<li><p> For the <code>"lp"</code> model, it is a vector of length 3 arranged as intercept,
slope and maximum response.
</p>
</li>
<li><p> For the <code>"logistic"</code> and <code>"inv-logistic"</code> models, it is a
vector of length 3 arranged as the scaling parameter, shape parameter and maximum
response.
</p>
</li>
<li><p> For the <code>"logisticND"</code> model proposed by Nelder (1961), it is a
vector of length 3 arranged as the scaling parameter, shape parameter and maximum
response.
</p>
</li>
<li><p> For the <code>"double-logistic"</code> model, it is a vector of length 6 arranged
as the scaling parameter one, shape parameter one, maximum response, maximum
response, scaling parameter two and shape parameter two.
</p>
</li>
<li><p> For the <code>"qd"</code> model, it is a vector of length 3 arranged as constant,
linear coefficient and quadratic coefficient.
</p>
</li>
<li><p> For the <code>"trapezium"</code> model, it is a vector of length 3  arranged as
intercept one, slope one, maximum response, intercept two and slope two.
</p>
</li>
<li><p> For the <code>"mit"</code> model, it is a vector of length 3 arranged as the
intercept, shape parameter and the maximum response.
</p>
</li>
<li><p> For the <code>"schmidt"</code> model, it is a vector of length 3 arranged as scaling
parameter, shape parameter (x-value at maximum response ) and maximum response.</p>
</li></ul>
</td></tr>
<tr><td><code id="blbin_+3A_tau">tau</code></td>
<td>
<p>A percentile value (0-1) that represents the boundary point within each
bin (default is <code>tau = 0.95</code>).</p>
</td></tr>
<tr><td><code id="blbin_+3A_optim.method">optim.method</code></td>
<td>
<p>Describes the method used to optimize the model as in the
<code>optim()</code> function. The methods include <code>"Nelder-Mead"</code>, <code>"BFGS"</code>,
<code>"CG"</code>, <code>"L-BFGS-B"</code>, <code>"SANN"</code> and <code>"Brent"</code>.</p>
</td></tr>
<tr><td><code id="blbin_+3A_xmin">xmin</code></td>
<td>
<p>Numeric value that describes the minimum <code>x</code> value to which the
boundary line is to be fitted (default is <code>min(x)</code>).</p>
</td></tr>
<tr><td><code id="blbin_+3A_xmax">xmax</code></td>
<td>
<p>A numeric value that describes the maximum <code>x</code> value to which the
boundary line is to be fitted (default is <code>max(x)</code>). <code>xmin</code> and
<code>xmax</code> determine the subset of the data set used to fit boundary model.</p>
</td></tr>
<tr><td><code id="blbin_+3A_plot">plot</code></td>
<td>
<p>If <code>TRUE</code>, a plot is part of the output. If <code>FALSE</code>, plot
is not part of output (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="blbin_+3A_bp_col">bp_col</code></td>
<td>
<p>Selects the color of the boundary points.</p>
</td></tr>
<tr><td><code id="blbin_+3A_bp_pch">bp_pch</code></td>
<td>
<p>Point character as <code>pch</code> of the <code>plot()</code> function. It controls
the shape of the boundary points on plot (<code>bp_pch = 16</code> as default).</p>
</td></tr>
<tr><td><code id="blbin_+3A_bl_col">bl_col</code></td>
<td>
<p>Colour of the boundary line.</p>
</td></tr>
<tr><td><code id="blbin_+3A_lwd">lwd</code></td>
<td>
<p>Determines the thickness of the boundary line on the plot (default is 1).</p>
</td></tr>
<tr><td><code id="blbin_+3A_line_smooth">line_smooth</code></td>
<td>
<p>Parameter that describes the smoothness of the boundary line.
(default is 1000). The higher the value, the smoother the line.</p>
</td></tr>
<tr><td><code id="blbin_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters as in the <code>par()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Some inbuilt models are available for the <code>blbin()</code> function. The
<code>"explore"</code> option for the argument <code>model</code> generates a plot showing the
location of the boundary points selected by the binning procedure. This helps to
identify which model type is suitable to fit as a boundary line. The suggest model
forms are as follows: </p>

<ol>
<li><p> Linear model (<code>"blm"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y=\beta_1 + \beta_2x</code>
</p>

<p>where <code class="reqn">\beta_1</code> is the intercept and <code class="reqn">\beta_2</code> is the slope.
</p>
</li>
<li><p> Linear plateau model (<code>"lp"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y= {\rm min}(\beta_1+\beta_2x, \beta_0)</code>
</p>

<p>where <code class="reqn">\beta_1</code> is the intercept , <code class="reqn">\beta_2</code> is the slope  and <code class="reqn">\beta_0</code>
is the maximum response.
</p>
</li>
<li><p> The logistic (<code>"logistic"</code>) and inverse logistic (<code>"inv-logistic"</code>)
models
</p>
<p style="text-align: center;"><code class="reqn"> y= \frac{\beta_0}{1+e^{\beta_2(\beta_1-x)}}</code>
</p>

<p style="text-align: center;"><code class="reqn"> y= \beta_0 - \frac{\beta_0}{1+e^{\beta_2(\beta_1-x)}}</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter , <code class="reqn">\beta_2</code> is a shape parameter
and <code class="reqn">\beta_0</code> is the maximum response.
</p>
</li>
<li><p> Logistic model (<code>"logisticND"</code>)  (Nelder (2009))
</p>
<p style="text-align: center;"><code class="reqn"> y= \frac{\beta_0}{1+(\beta_1 \times e^{-\beta_2x})}</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter, <code class="reqn">\beta_2</code> is a shape
parameter and <code class="reqn">\beta_0</code> is the maximum response.
</p>
</li>
<li><p> Double logistic model (<code>"double-logistic"</code>)
</p>
<p style="text-align: center;"><code class="reqn"> y= \frac{\beta_{0,1}}{1+e^{\beta_2(\beta_1-x)}} -
 \frac{\beta_{0,2}}{1+e^{\beta_4(\beta_3-x)}}</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter one, <code class="reqn">\beta_2</code> is shape parameter one,
<code class="reqn">\beta_{0,1}</code> and <code class="reqn">\beta_{0,2}</code> are the maximum response ,
<code class="reqn">\beta_3</code> is a scaling parameter two and  <code class="reqn">\beta_4</code> is a shape parameter two.
</p>
</li>
<li><p> Quadratic model (<code>"qd"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y=\beta_1 + \beta_2x + \beta_3x^2</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a constant, <code class="reqn">\beta_2</code> is a linear coefficient
and  <code class="reqn">\beta_3</code> is the quadratic coefficient.
</p>
</li>
<li><p> Trapezium model (<code>"trapezium"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y={\rm min}(\beta_1+\beta_2x, \beta_0, \beta_3 + \beta_4x)</code>
</p>

<p>where  <code class="reqn">\beta_1</code> is the intercept one, <code class="reqn">\beta_2</code> is the slope one,
<code class="reqn">\beta_0</code> is the maximum response, <code class="reqn">\beta_3</code> is the intercept two
and <code class="reqn">\beta_3</code> is the slope two.
</p>
</li>
<li><p> Mitscherlich model (<code>"mit"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y= \beta_0 - \beta_1*\beta_2^x</code>
</p>

<p>where <code class="reqn">\beta_1</code> is the intercept, <code class="reqn">\beta_2</code> is a shape parameter
and <code class="reqn">\beta_0</code> is the maximum response.
</p>
</li>
<li><p> Schmidt model (<code>"schmidt"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y= \beta_0 + \beta_1(x-\beta_2)^2</code>
</p>

<p>where <code class="reqn">\beta_1</code> is ascaling parameter, <code class="reqn">\beta_2</code> is a
shape parameter (x-value at maximum response ) and <code class="reqn">\beta_0</code> is the
maximum response .
</p>
</li>
<li><p> Custom model (&quot;other&quot;)
This option allows you to create your own model form using the function
<code>function()</code>. The custom model should be assigned to the argument
<code>equation</code>. Note that the parameters for the custom model should be
<code>a</code> and <code>b</code> for a two parameter model; <code>a</code>, <code>b</code> and <code>c</code>
for a three parameter model; <code>a</code>, <code>b</code>, <code>c</code> and <code>d</code> for a
four parameter model and so on.
</p>
</li></ol>

<p>The function <code>blbin()</code> utilities the optimization procedure of the
<code>optim()</code> function to determine the model parameters. There is a tendency
for optimization algorithms to settle at a local optimum. To remove the risk of
settling for local optimum parameters, it is advised that the function is run using
several starting values and the results with the smallest error (residue mean square)
can be taken as a representation of the global optimum.
</p>
<p>The common errors encountered due to poor start values </p>

<ol>
<li><p> function cannot be evaluated at initial parameters
</p>
</li>
<li><p> initial value in 'vmmin' is not finite</p>
</li></ol>



<h3>Value</h3>

<p>A list of length 5 consisting of the fitted model, equation form, parameters
of the boundary line, the residue mean square and the boundary points. Additionally,
a graphical representation of the boundary line on the scatter plot is produced.
</p>


<h3>Author(s)</h3>

<p>Chawezi Miti &lt;chawezi.miti@nottingham.ac.uk&gt;
</p>


<h3>References</h3>

<p>Casanova, D., Goudriaan, J., Bouma, J., &amp; Epema, G. (1999). Yield gap analysis
in relation to soil properties in direct-seeded flooded rice.
</p>
<p>Nelder, J.A. 1961. The fitting of a generalization of the logistic curve.
Biometrics 17: 89â€“110.
</p>
<p>Phillips, B.F. &amp; Campbell, N.A. 1968. A new method of fitting the von Bertelanffy
growth curve using data on the whelk. Dicathais, Growth 32: 317â€“329.
</p>
<p>Schmidt, U., ThÃ¶ni, H., &amp; Kaupenjohann, M. (2000). Using a boundary line approach
to analyze N2O flux data from agricultural soils. Nutrient Cycling in Agro-ecosystems,
57, 119-129.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-log(SoilP$P)
y&lt;-SoilP$yield
start&lt;-c(4,3,13.6, 35, -5)
bins&lt;-c(1.6,4.74,0.314)

blbin(x,y, bins=bins, start=start,model = "trapezium", tau=0.99,
       xlab=expression("Phosphorus/ln(mg L"^-1*")"),
       ylab=expression("Yield/ t ha"^-1), pch=16,
       col="grey", bp_col="grey")

</code></pre>

<hr>
<h2 id='ble_profile'>Likelihood profile for various measurement error values</h2><span id='topic+ble_profile'></span>

<h3>Description</h3>

<p>Estimates the standard deviation of measurement error (<code>sign</code>) of the response
variable, an input of the <code>cbvn()</code> function, when a measured value is not
available (Lark &amp; Milne, 2016). <code>sigh</code> is fixed at each of a set of
values in turn, and remaining parameters are estimated conditional on <code>sigh</code>
by maximum likelihood. The maximized likelihoods for the sequence of values
constitutes a likelihood profile. The value of <code>sigh</code> where the profile
is maximized is selected.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ble_profile(data, sigh, model="lp", equation=NULL,  start, UpLo="U",
             optim.method="BFGS", plot=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ble_profile_+3A_data">data</code></td>
<td>
<p>A dataframe with two numeric columns, independent (<code>x</code>) and
dependent (<code>y</code>) variables respectively.</p>
</td></tr>
<tr><td><code id="ble_profile_+3A_sigh">sigh</code></td>
<td>
<p>A vector of the suggested standard deviations of the measurement error
values.</p>
</td></tr>
<tr><td><code id="ble_profile_+3A_model">model</code></td>
<td>
<p>Selects the functional form of the boundary line. It includes
<code>"blm"</code> for linear model, <code>"lp"</code> for linear plateau model, <code>"mit"</code>
for the Mitscherlich model, <code>"schmidt"</code> for the Schmidt model,
<code>"logistic"</code> for logistic model, <code>"logisticND"</code> for logistic model
proposed by Nelder (1961), <code>"inv-logistic"</code> for the inverse logistic
model, <code>"double-logistic"</code> for the double logistic model, <code>"qd"</code> for
quadratic model and the <code>"trapezium"</code> for the trapezium model. For custom
models, set <code>model = "other"</code>.</p>
</td></tr>
<tr><td><code id="ble_profile_+3A_equation">equation</code></td>
<td>
<p>A custom model function writen in the form of an R function. Applies
only when argument <code>model="other"</code>, else it is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ble_profile_+3A_start">start</code></td>
<td>
<p>A numeric vector of initial starting values for optimization
in fitting the boundary model. Its length and arrangement depend on the
suggested model: </p>

<ul>
<li><p> For the <code>"blm"</code> model, it is a vector of length 7 arranged as the
intercept, the slope, mean of <code>x</code>, mean of <code>y</code>, standard deviation
of <code>x</code>, standard deviation of <code>y</code> and the correlation of <code>x</code>
and <code>y</code>.
</p>
</li>
<li><p> For the <code>"lp"</code> model, it is a vector of length 8 arranged as the
intercept, the slope, the maximum or plateau response, mean of <code>x</code>,
mean of <code>y</code>, standard deviation of <code>x</code>, standard deviation of <code>y</code>
and the correlation of <code>x</code> and <code>y</code>.
</p>
</li>
<li><p> For the <code>"mit"</code> model, it is a vector of length 8 arranged as the
intercept, shape parameter, the maximum or plateau response, mean of <code>x</code>,
mean of <code>y</code>, standard deviation of <code>x</code>, standard deviation of <code>y</code>
and the correlation of <code>x</code> and <code>y</code>.
</p>
</li>
<li><p> For the <code>"logistic"</code>, <code>"inv-logistic"</code> and <code>"logisticND"</code>
models, it is a vector of length 8 arranged as scaling parameter, shape parameter,
the maximum or plateau value, mean of <code>x</code>, mean of <code>y</code>,
standard deviation of <code>x</code>, standard deviation of <code>y</code> and the
correlation of <code>x</code> and <code>y</code>.
</p>
</li>
<li><p> For the <code>"double-logistic"</code> model, it is a vector of length 11
arranged as scaling parameter, shape parameter, maximum response, maximum response,
scaling parameter two, shape parameter two, mean of <code>x</code>, mean of <code>y</code>,
standard deviation of <code>x</code>, standard deviation of <code>y</code> and the correlation
of <code>x</code> and <code>y</code>.
</p>
</li>
<li><p> For the <code>"trapezium"</code> model, it is a vector of length 10 arranged
as intercept one, slope one, maximum response, intercept two, slope two,
mean of <code>x</code>, mean of <code>y</code>, standard deviation of <code>x</code>,
standard deviation of <code>y</code> and the correlation of <code>x</code> and <code>y</code>.
</p>
</li>
<li><p> For the <code>"qd"</code> model, it is a vector of length 8 arranged as a
constant, linear coefficient, quadratic coefficient,mean of <code>x</code>,
mean of <code>y</code>, standard deviation of <code>x</code>, standard deviation of <code>y</code>
and the correlation of <code>x</code> and <code>y</code>.
</p>
</li>
<li><p> For the <code>"schmidt"</code> model, it is a vector of length 8 arranged the
scaling parameter, shape parameter (x-value at maximum response ),
maximum response, mean of <code>x</code>, mean of <code>y</code>, standard deviation of
<code>x</code>, standard deviation of <code>y</code> and the correlation of <code>x</code>
and <code>y</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="ble_profile_+3A_uplo">UpLo</code></td>
<td>
<p>Selects the type of boundary. <code>"U"</code> fits the upper boundary and
&quot;L&quot; fits the lower boundary.</p>
</td></tr>
<tr><td><code id="ble_profile_+3A_optim.method">optim.method</code></td>
<td>
<p>Describes the method used to optimize the model as in the
<code>optim()</code> function. The methods include <code>"Nelder-Mead"</code>, <code>"BFGS"</code>,
<code>"CG"</code>, <code>"L-BFGS-B"</code>, <code>"SANN"</code> and <code>"Brent"</code>.</p>
</td></tr>
<tr><td><code id="ble_profile_+3A_plot">plot</code></td>
<td>
<p>If <code>TRUE</code>, a plot is part of the output. If <code>FALSE</code>, plot
is not part of output (default is <code>TRUE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Some inbuilt models are available for the <code>cbvn()</code> function. The suggest model
forms are as follows: </p>

<ol>
<li><p> Linear model (<code>"blm"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y=\beta_1 + \beta_2x</code>
</p>

<p>where <code class="reqn">\beta_1</code> is the intercept and <code class="reqn">\beta_2</code> is the slope.
</p>
</li>
<li><p> Linear plateau model (<code>"lp"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y= {\rm min}(\beta_1+\beta_2x, \beta_0)</code>
</p>

<p>where <code class="reqn">\beta_1</code> is the intercept , <code class="reqn">\beta_2</code> is the slope  and <code class="reqn">\beta_0</code>
is the maximum response.
</p>
</li>
<li><p> The logistic (<code>"logistic"</code>) and inverse logistic (<code>"inv-logistic"</code>)
models
</p>
<p style="text-align: center;"><code class="reqn"> y= \frac{\beta_0}{1+e^{\beta_2(\beta_1-x)}}</code>
</p>

<p style="text-align: center;"><code class="reqn"> y= \beta_0 - \frac{\beta_0}{1+e^{\beta_2(\beta_1-x)}}</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter , <code class="reqn">\beta_2</code> is a shape parameter
and <code class="reqn">\beta_0</code> is the maximum response.
</p>
</li>
<li><p> Logistic model (<code>"logisticND"</code>)  (Nelder (1961))
</p>
<p style="text-align: center;"><code class="reqn"> y= \frac{\beta_0}{1+(\beta_1 \times e^{-\beta_2x})}</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter, <code class="reqn">\beta_2</code> is a shape
parameter and <code class="reqn">\beta_0</code> is the maximum response.
</p>
</li>
<li><p> Double logistic model (<code>"double-logistic"</code>)
</p>
<p style="text-align: center;"><code class="reqn"> y= \frac{\beta_{0,1}}{1+e^{\beta_2(\beta_1-x)}} -
 \frac{\beta_{0,2}}{1+e^{\beta_4(\beta_3-x)}}</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter one, <code class="reqn">\beta_2</code> is shape parameter one,
<code class="reqn">\beta_{0,1}</code> and <code class="reqn">\beta_{0,2}</code> are the maximum response ,
<code class="reqn">\beta_3</code> is a scaling parameter two and  <code class="reqn">\beta_4</code> is a shape parameter two.
</p>
</li>
<li><p> Quadratic model (<code>"qd"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y=\beta_1 + \beta_2x + \beta_3x^2</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a constant, <code class="reqn">\beta_2</code> is a linear coefficient
and  <code class="reqn">\beta_3</code> is the quadratic coefficient.
</p>
</li>
<li><p> Trapezium model (<code>"trapezium"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y={\rm min}(\beta_1+\beta_2x, \beta_0, \beta_3 + \beta_4x)</code>
</p>

<p>where  <code class="reqn">\beta_1</code> is the intercept one, <code class="reqn">\beta_2</code> is the slope one,
<code class="reqn">\beta_0</code> is the maximum response, <code class="reqn">\beta_3</code> is the intercept two
and <code class="reqn">\beta_3</code> is the slope two.
</p>
</li>
<li><p> Mitscherlich model (<code>"mit"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y= \beta_0 - \beta_1*\beta_2^x</code>
</p>

<p>where <code class="reqn">\beta_1</code> is the intercept, <code class="reqn">\beta_2</code> is a shape parameter
and <code class="reqn">\beta_0</code> is the maximum response.
</p>
</li>
<li><p> Schmidt model (<code>"schmidt"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y= \beta_0 + \beta_1(x-\beta_2)^2</code>
</p>

<p>where <code class="reqn">\beta_1</code> is ascaling parameter, <code class="reqn">\beta_2</code> is a
shape parameter (x-value at maximum response ) and <code class="reqn">\beta_0</code> is the
maximum response .
</p>
</li></ol>

<p>The function <code>ble_profile()</code> utilities the optimization procedure of the
<code>optim()</code> function to determine the model parameters. There is a tendency
for optimization algorithms to settle at a local optimum. To remove the risk of
settling for local optimum parameters, it is advised that the function is run
using several starting values and the results with the largest likelihood
can be taken as a representation of the global optimum.
</p>
<p>The common errors encountered due to poor start values </p>

<ol>
<li><p> function cannot be evaluated at initial parameters
</p>
</li>
<li><p> initial value in 'vmmin' is not finite</p>
</li></ol>



<h3>Value</h3>

<p>A list of length 2 containing the suggested standard deviations of
measurement error values and the corresponding log-likelihood values.
additionally, a likelihood profile plot (log-likelihood against the standard
deviation of measurement error) is produced.
</p>


<h3>Author(s)</h3>

<p>Chawezi Miti &lt;chawezi.miti@nottingham.ac.uk&gt;
</p>


<h3>References</h3>

<p>Lark, R. M., &amp; Milne, A. E. (2016). Boundary line analysis of the effect of water
filled pore space on nitrous oxide emission from cores of arable soil. European
Journal of Soil Science, 67 , 148-159.
</p>
<p>Nelder, J.A. 1961. The fitting of a generalization of the logistic curve.
Biometrics 17: 89â€“110.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x&lt;-evapotranspiration$`ET(mm)`
y&lt;-evapotranspiration$`yield(t/ha)`
data&lt;-data.frame(x,y)
start&lt;-c(0.5,0.02,289.6,2.4,83.7,1.07,0.287)
sigh &lt;- c(0.6,0.7,0.8,0.9)

ble_profile(data,start=start,model = "blm", sigh = sigh)

</code></pre>

<hr>
<h2 id='blqr'>Boundary line model determination using quantile regression</h2><span id='topic+blqr'></span>

<h3>Description</h3>

<p>This function fits a boundary model to the upper bounds of a scatter plot of
<code>x</code> and <code>y</code> by estimating the conditional quantile (0-1) of the
response variable, <code>y</code>, across values of the predictor variables, <code>x</code>.
This is achieved using optimization procedure and hence requires some starting
guess parameters of a proposed model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blqr(x,y,model, equation=NULL,start,tau=0.95,optim.method="Nelder-Mead",
     xmin=min(bound$x),xmax=max(bound$x), plot=TRUE,line_col="red",lwd=1,
     line_smooth=1000,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="blqr_+3A_x">x</code></td>
<td>
<p>A numeric vector of values for the independent variable.</p>
</td></tr>
<tr><td><code id="blqr_+3A_y">y</code></td>
<td>
<p>A numeric vector of values for the response variable.</p>
</td></tr>
<tr><td><code id="blqr_+3A_model">model</code></td>
<td>
<p>Selects the functional form of the boundary line. It includes
<code>"blm"</code> for linear model, <code>"lp"</code> for linear plateau model, <code>"mit"</code>
for the Mitscherlich model, <code>"schmidt"</code> for the Schmidt model,
<code>"logistic"</code> for logistic model, <code>"logisticND"</code> for logistic model
proposed by Nelder (1961), <code>"inv-logistic"</code> for the inverse logistic
model, <code>"double-logistic"</code> for the double logistic model, <code>"qd"</code>
for quadratic model and the <code>"trapezium"</code> for the trapezium model.For custom
models, set <code>model = "other"</code>.</p>
</td></tr>
<tr><td><code id="blqr_+3A_equation">equation</code></td>
<td>
<p>A custom model function writen in the form of an R function. Applies
only when argument <code>model="other"</code>, else it is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="blqr_+3A_start">start</code></td>
<td>
<p>A numeric vector of initial starting values for optimization
in fitting the boundary model. Its length and arrangement depend on the
suggested model: </p>

<ul>
<li><p> For the <code>"blm"</code> model, it is a vector of length 2 arranged as intercept
and slope.
</p>
</li>
<li><p> For the <code>"lp"</code> model, it is a vector of length 3 arranged as intercept,
slope and maximum response.
</p>
</li>
<li><p> For the <code>"logistic"</code> and <code>"inv-logistic"</code> models, it is a
vector of length 3 arranged as the scaling parameter, shape parameter and maximum
response.
</p>
</li>
<li><p> For the <code>"logisticND"</code> model proposed by Nelder (1961), it is a
vector of length 3 arranged as the scaling parameter, shape parameter and maximum
response.
</p>
</li>
<li><p> For the <code>"double-logistic"</code> model, it is a vector of length 6 arranged
as the scaling parameter one, shape parameter one, maximum response, maximum
response, scaling parameter two and shape parameter two.
</p>
</li>
<li><p> For the <code>"qd"</code> model, it is a vector of length 3 arranged as constant,
linear coefficient and quadratic coefficient.
</p>
</li>
<li><p> For the <code>"trapezium"</code> model, it is a vector of length 3  arranged as
intercept one, slope one, maximum response, intercept two and slope two.
</p>
</li>
<li><p> For the <code>"mit"</code> model, it is a vector of length 3 arranged as the
intercept, shape parameter and the maximum response.
</p>
</li>
<li><p> For the <code>"schmidt"</code> model, it is a vector of length 3 arranged as scaling
parameter, shape parameter (x-value at maximum response ) and maximum response.</p>
</li></ul>
</td></tr>
<tr><td><code id="blqr_+3A_tau">tau</code></td>
<td>
<p>The quantile value (0- 1) that represents the boundary
(<code>default is tau = 0.95</code>).</p>
</td></tr>
<tr><td><code id="blqr_+3A_optim.method">optim.method</code></td>
<td>
<p>Describes the method used to optimize the model as in the
<code>optim()</code> function. The methods include <code>"Nelder-Mead"</code>, <code>"BFGS"</code>,
<code>"CG"</code>, <code>"L-BFGS-B"</code>, <code>"SANN"</code> and <code>"Brent"</code>.</p>
</td></tr>
<tr><td><code id="blqr_+3A_xmin">xmin</code></td>
<td>
<p>Numeric value that describes the minimum <code>x</code> value to which the
boundary line is to be fitted (default is <code>min(x)</code>).</p>
</td></tr>
<tr><td><code id="blqr_+3A_xmax">xmax</code></td>
<td>
<p>A numeric value that describes the maximum <code>x</code> value to which the
boundary line is to be fitted (default is <code>max(x)</code>). <code>xmin</code> and
<code>xmax</code> determine the subset of the data set used to fit boundary model.</p>
</td></tr>
<tr><td><code id="blqr_+3A_plot">plot</code></td>
<td>
<p>If <code>TRUE</code>, a plot is part of the output. If <code>FALSE</code>, plot
is not part of output (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="blqr_+3A_line_col">line_col</code></td>
<td>
<p>Selects the color of the boundary line.</p>
</td></tr>
<tr><td><code id="blqr_+3A_lwd">lwd</code></td>
<td>
<p>Determines the thickness of the boundary line on the plot (default is 1).</p>
</td></tr>
<tr><td><code id="blqr_+3A_line_smooth">line_smooth</code></td>
<td>
<p>Parameter that describes the smoothness of the boundary line.
(default is 1000). The higher the value, the smoother the line.</p>
</td></tr>
<tr><td><code id="blqr_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Some inbuilt models are available for the <code>blqr()</code> function. The suggest model
forms are as follows: </p>

<ol>
<li><p> Linear model (<code>"blm"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y=\beta_1 + \beta_2x</code>
</p>

<p>where <code class="reqn">\beta_1</code> is the intercept and <code class="reqn">\beta_2</code> is the slope.
</p>
</li>
<li><p> Linear plateau model (<code>"lp"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y= {\rm min}(\beta_1+\beta_2x, \beta_0)</code>
</p>

<p>where <code class="reqn">\beta_1</code> is the intercept , <code class="reqn">\beta_2</code> is the slope  and <code class="reqn">\beta_0</code>
is the maximum response.
</p>
</li>
<li><p> The logistic (<code>"logistic"</code>) and inverse logistic (<code>"inv-logistic"</code>)
models
</p>
<p style="text-align: center;"><code class="reqn"> y= \frac{\beta_0}{1+e^{\beta_2(\beta_1-x)}}</code>
</p>

<p style="text-align: center;"><code class="reqn"> y= \beta_0 - \frac{\beta_0}{1+e^{\beta_2(\beta_1-x)}}</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter , <code class="reqn">\beta_2</code> is a shape parameter
and <code class="reqn">\beta_0</code> is the maximum response.
</p>
</li>
<li><p> Logistic model (<code>"logisticND"</code>)  (Nelder (1961))
</p>
<p style="text-align: center;"><code class="reqn"> y= \frac{\beta_0}{1+(\beta_1 \times e^{-\beta_2x})}</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter, <code class="reqn">\beta_2</code> is a shape
parameter and <code class="reqn">\beta_0</code> is the maximum response.
</p>
</li>
<li><p> Double logistic model (<code>"double-logistic"</code>)
</p>
<p style="text-align: center;"><code class="reqn"> y= \frac{\beta_{0,1}}{1+e^{\beta_2(\beta_1-x)}} -
 \frac{\beta_{0,2}}{1+e^{\beta_4(\beta_3-x)}}</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter one, <code class="reqn">\beta_2</code> is a shape parameter
one, <code class="reqn">\beta_{0,1}</code> and <code class="reqn">\beta_{0,2}</code> are the maximum response ,
<code class="reqn">\beta_3</code> is a scaling parameter two and  <code class="reqn">\beta_4</code> is a shape parameter two.
</p>
</li>
<li><p> Quadratic model (<code>"qd"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y=\beta_1 + \beta_2x + \beta_3x^2</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a constant, <code class="reqn">\beta_2</code> is a linear coefficient
and  <code class="reqn">\beta_3</code> is the quadratic coefficient.
</p>
</li>
<li><p> Trapezium model (<code>"trapezium"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y={\rm min}(\beta_1+\beta_2x, \beta_0, \beta_3 + \beta_4x)</code>
</p>

<p>where  <code class="reqn">\beta_1</code> is the intercept one, <code class="reqn">\beta_2</code> is the slope one,
<code class="reqn">\beta_0</code> is the maximum response, <code class="reqn">\beta_3</code> is the intercept two
and <code class="reqn">\beta_3</code> is the slope two.
</p>
</li>
<li><p> Mitscherlich model (<code>"mit"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y= \beta_0 - \beta_1*\beta_2^x</code>
</p>

<p>where <code class="reqn">\beta_1</code> is the intercept, <code class="reqn">\beta_2</code> is a shape parameter
and <code class="reqn">\beta_0</code> is the maximum response.
</p>
</li>
<li><p> Schmidt model (<code>"schmidt"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y= \beta_0 + \beta_1(x-\beta_2)^2</code>
</p>

<p>where <code class="reqn">\beta_1</code> is ascaling parameter, <code class="reqn">\beta_2</code> is a
shape parameter (x-value at maximum response ) and <code class="reqn">\beta_0</code> is the
maximum response .
</p>
</li>
<li><p> Custom model (&quot;other&quot;)
This option allows you to create your own model form using the function
<code>function()</code>. The custom model should be assigned to the argument
<code>equation</code>. Note that the parameters for the custom model should be
<code>a</code> and <code>b</code> for a two parameter model; <code>a</code>, <code>b</code> and <code>c</code>
for a three parameter model; <code>a</code>, <code>b</code>, <code>c</code> and <code>d</code> for a
four parameter model and so on.
</p>
</li></ol>

<p>The function <code>blbin()</code> utilities the optimization procedure of the
<code>optim()</code> function to determine the model parameters. There is a tendency
for optimization algorithms to settle at a local optimum. To remove the risk of
settling for local optimum parameters, it is advised that the function is run
using several starting values and the results with the smallest error
(weighted residue sum square) can be taken as a representation of the global
optimum.
</p>
<p>The common errors encountered due to poor start values </p>

<ol>
<li><p> function cannot be evaluated at initial parameters
</p>
</li>
<li><p> initial value in 'vmmin' is not finite</p>
</li></ol>



<h3>Value</h3>

<p>A list of length 5 consisting of the fitted model, equation form, parameters
of the boundary line, the weighted residue sum square. Additionally, a graphical
representation of the boundary line on the scatter plot is produced.
</p>


<h3>Author(s)</h3>

<p>Chawezi Miti &lt;chawezi.miti@nottingham.ac.uk&gt;
</p>


<h3>References</h3>

<p>Cade, B. S., &amp; Noon, B. R. (2003). A gentle introduction to quantile regression
for ecologists. Frontiers in Ecology and the Environment, 1(8), 412-420.
</p>
<p>Nelder, J.A. 1961. The fitting of a generalization of the logistic curve.
Biometrics 17: 89â€“110.
</p>
<p>Phillips, B.F. &amp; Campbell, N.A. 1968. A new method of fitting the von Bertelanffy
growth curve using data on the whelk. Dicathais, Growth 32: 317â€“329.
</p>
<p>Schmidt, U., ThÃ¶ni, H., &amp; Kaupenjohann, M. (2000). Using a boundary line approach
to analyze N2O flux data from agricultural soils. Nutrient Cycling in Agroecosystems,
57, 119-129.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x&lt;-log(SoilP$P)
y&lt;-SoilP$yield
start&lt;-c(4,3,13.6)

blqr(x,y, start=start,model = "lp", tau=0.99,
      xlab=expression("ET mm ha"^-1),
      ylab=expression("Wheat yield/ ton ha"^-1),
      pch=16, col="grey")

</code></pre>

<hr>
<h2 id='bolides'>Boundary line determination technique</h2><span id='topic+bolides'></span>

<h3>Description</h3>

<p>This function selects upper bounding points of a scatter plot of <code>x</code> and
<code>y</code> based on the boundary line determination technique proposed by
Schnug et al. (1995). A model is then fitted to the resulting boundary points
by the least squares method. This is done using optimization procedure and
hence requires some starting values for the model parameters for the proposed
model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bolides(x,y,model="explore", equation=NULL, start, optim.method="Nelder-Mead",
        xmin=min(bound$x), xmax=max(bound$x), plot=TRUE,bp_col="red", bp_pch=16,
        bl_col="red" ,lwd=1,line_smooth=1000,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bolides_+3A_x">x</code></td>
<td>
<p>A numeric vector of values for the independent variable.</p>
</td></tr>
<tr><td><code id="bolides_+3A_y">y</code></td>
<td>
<p>A numeric vector of values for the response variable.</p>
</td></tr>
<tr><td><code id="bolides_+3A_model">model</code></td>
<td>
<p>Selects the functional form of the boundary line. It includes
<code>"explore"</code> as default, <code>"blm"</code> for linear model, <code>"lp"</code> for
linear plateau model, <code>"mit"</code> for the Mitscherlich model, <code>"schmidt"</code>
for the Schmidt model, <code>"logistic"</code> for logistic model, <code>"logisticND"</code>
for logistic model proposed by Nelder (1961), <code>"inv-logistic"</code> for
the inverse logistic model, <code>"double-logistic"</code> for the double logistic model,
<code>"qd"</code> for quadratic model and the <code>"trapezium"</code> for the trapezium model.
The <code>"explore"</code> is used to check the position of boundary points so that the
correct <code>model</code> can be applied. For custom models, set <code>model = "other"</code>.</p>
</td></tr>
<tr><td><code id="bolides_+3A_equation">equation</code></td>
<td>
<p>A custom model function writen in the form of an R function. Applies
only when argument <code>model="other"</code>, else it is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="bolides_+3A_start">start</code></td>
<td>
<p>A numeric vector of initial starting values for optimization
in fitting the boundary model. Its length and arrangement depend on the
suggested model: </p>

<ul>
<li><p> For the <code>"blm"</code> model, it is a vector of length 2 arranged as intercept
and slope.
</p>
</li>
<li><p> For the <code>"lp"</code> model, it is a vector of length 3 arranged as intercept,
slope and maximum response.
</p>
</li>
<li><p> For the <code>"logistic"</code> and <code>"inv-logistic"</code> models, it is a
vector of length 3 arranged as the scaling parameter, shape parameter and maximum
response.
</p>
</li>
<li><p> For the <code>"logisticND"</code> model proposed by Nelder (1961), it is a
vector of length 3 arranged as the scaling parameter, shape parameter and maximum
response.
</p>
</li>
<li><p> For the <code>"double-logistic"</code> model, it is a vector of length 6 arranged
as the scaling parameter one, shape parameter one, maximum response, maximum
response, scaling parameter two and shape parameter two.
</p>
</li>
<li><p> For the <code>"qd"</code> model, it is a vector of length 3 arranged as constant,
linear coefficient and quadratic coefficient.
</p>
</li>
<li><p> For the <code>"trapezium"</code> model, it is a vector of length 3  arranged as
intercept one, slope one, maximum response, intercept two and slope two.
</p>
</li>
<li><p> For the <code>"mit"</code> model, it is a vector of length 3 arranged as the
intercept, shape parameter and the maximum response.
</p>
</li>
<li><p> For the <code>"schmidt"</code> model, it is a vector of length 3 arranged as scaling
parameter, shape parameter (x-value at maximum response ) and maximum response.</p>
</li></ul>
</td></tr>
<tr><td><code id="bolides_+3A_optim.method">optim.method</code></td>
<td>
<p>Describes the method used to optimize the model as in the
<code>optim()</code> function. The methods include <code>"Nelder-Mead"</code>, <code>"BFGS"</code>,
<code>"CG"</code>, <code>"L-BFGS-B"</code>, <code>"SANN"</code> and <code>"Brent"</code>.</p>
</td></tr>
<tr><td><code id="bolides_+3A_xmin">xmin</code></td>
<td>
<p>Numeric value that describes the minimum <code>x</code> value to which the
boundary line is to be fitted (default is <code>min(x)</code>).</p>
</td></tr>
<tr><td><code id="bolides_+3A_xmax">xmax</code></td>
<td>
<p>A numeric value that describes the maximum <code>x</code> value to which the
boundary line is to be fitted (default is <code>max(x)</code>). <code>xmin</code> and
<code>xmax</code> determine the subset of the data set used to fit boundary model.</p>
</td></tr>
<tr><td><code id="bolides_+3A_plot">plot</code></td>
<td>
<p>If <code>TRUE</code>, a plot is part of the output. If <code>FALSE</code>, plot
is not part of output (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="bolides_+3A_bp_col">bp_col</code></td>
<td>
<p>Selects the color of the boundary points.</p>
</td></tr>
<tr><td><code id="bolides_+3A_bp_pch">bp_pch</code></td>
<td>
<p>Point character as <code>pch</code> of the <code>plot()</code> function. It controls
the shape of the boundary points on plot (<code>bp_pch = 16</code> as default).</p>
</td></tr>
<tr><td><code id="bolides_+3A_bl_col">bl_col</code></td>
<td>
<p>Colour of the boundary line.</p>
</td></tr>
<tr><td><code id="bolides_+3A_lwd">lwd</code></td>
<td>
<p>Determines the thickness of the boundary line on the plot (default is 1).</p>
</td></tr>
<tr><td><code id="bolides_+3A_line_smooth">line_smooth</code></td>
<td>
<p>Parameter that describes the smoothness of the boundary line.
(default is 1000). The higher the value, the smoother the line.</p>
</td></tr>
<tr><td><code id="bolides_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters as in the <code>par()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Some inbuilt models are available for the <code>bolides()</code> function. The
<code>"explore"</code> option for the argument <code>model</code> generates a plot showing the
ocation of the boundary points selected by the binning procedure. This helps to
identify which model type is suitable to fit as a boundary line. The suggest model
forms are as follows: </p>

<ol>
<li><p> Linear model (<code>"blm"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y=\beta_1 + \beta_2x</code>
</p>

<p>where <code class="reqn">\beta_1</code> is the intercept and <code class="reqn">\beta_2</code> is the slope.
</p>
</li>
<li><p> Linear plateau model (<code>"lp"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y= {\rm min}(\beta_1+\beta_2x, \beta_0)</code>
</p>

<p>where <code class="reqn">\beta_1</code> is the intercept , <code class="reqn">\beta_2</code> is the slope  and <code class="reqn">\beta_0</code>
is the maximum response.
</p>
</li>
<li><p> The logistic (<code>"logistic"</code>) and inverse logistic (<code>"inv-logistic"</code>)
models
</p>
<p style="text-align: center;"><code class="reqn"> y= \frac{\beta_0}{1+e^{\beta_2(\beta_1-x)}}</code>
</p>

<p style="text-align: center;"><code class="reqn"> y= \beta_0 - \frac{\beta_0}{1+e^{\beta_2(\beta_1-x)}}</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter , <code class="reqn">\beta_2</code> is a shape parameter
and <code class="reqn">\beta_0</code> is the maximum response.
</p>
</li>
<li><p> Logistic model (<code>"logisticND"</code>)  (Nelder (1961))
</p>
<p style="text-align: center;"><code class="reqn"> y= \frac{\beta_0}{1+(\beta_1 \times e^{-\beta_2x})}</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter, <code class="reqn">\beta_2</code> is a shape
parameter and <code class="reqn">\beta_0</code> is the maximum response.
</p>
</li>
<li><p> Double logistic model (<code>"double-logistic"</code>)
</p>
<p style="text-align: center;"><code class="reqn"> y= \frac{\beta_{0,1}}{1+e^{\beta_2(\beta_1-x)}} -
 \frac{\beta_{0,2}}{1+e^{\beta_4(\beta_3-x)}}</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter one, <code class="reqn">\beta_2</code> is a shape parameter
one, <code class="reqn">\beta_{0,1}</code> and <code class="reqn">\beta_{0,2}</code> are the maximum response ,
<code class="reqn">\beta_3</code> is a scaling parameter two and  <code class="reqn">\beta_4</code> is a shape parameter two.
</p>
</li>
<li><p> Quadratic model (<code>"qd"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y=\beta_1 + \beta_2x + \beta_3x^2</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a constant, <code class="reqn">\beta_2</code> is a linear coefficient
and  <code class="reqn">\beta_3</code> is the quadratic coefficient.
</p>
</li>
<li><p> Trapezium model (<code>"trapezium"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y={\rm min}(\beta_1+\beta_2x, \beta_0, \beta_3 + \beta_4x)</code>
</p>

<p>where  <code class="reqn">\beta_1</code> is the intercept one, <code class="reqn">\beta_2</code> is the slope one,
<code class="reqn">\beta_0</code> is the maximum response, <code class="reqn">\beta_3</code> is the intercept two
and <code class="reqn">\beta_3</code> is the slope two.
</p>
</li>
<li><p> Mitscherlich model (<code>"mit"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y= \beta_0 - \beta_1*\beta_2^x</code>
</p>

<p>where <code class="reqn">\beta_1</code> is the intercept, <code class="reqn">\beta_2</code> is a shape parameter
and <code class="reqn">\beta_0</code> is the maximum response.
</p>
</li>
<li><p> Schmidt model (<code>"schmidt"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y= \beta_0 + \beta_1(x-\beta_2)^2</code>
</p>

<p>where <code class="reqn">\beta_1</code> is ascaling parameter, <code class="reqn">\beta_2</code> is a
shape parameter (x-value at maximum response ) and <code class="reqn">\beta_0</code> is the
maximum response .
</p>
</li>
<li><p> Custom model (&quot;other&quot;)
This option allows you to create your own model form using the function
<code>function()</code>. The custom model should be assigned to the argument
<code>equation</code>. Note that the parameters for the custom model should be
<code>a</code> and <code>b</code> for a two parameter model; <code>a</code>, <code>b</code> and <code>c</code>
for a three parameter model; <code>a</code>, <code>b</code>, <code>c</code> and <code>d</code> for a
four parameter model and so on.
</p>
</li></ol>

<p>The function <code>bolides()</code> utilities the optimization procedure of the
<code>optim()</code> function to determine the model parameters. There is a tendency
for optimization algorithms to settle at a local optimum. To remove the risk of
settling for local optimum parameters, it is advised that the function is run using
several starting values and the results with the smallest error (residue mean square)
can be taken as a representation of the global optimum.
</p>
<p>The common errors encountered due to poor start values </p>

<ol>
<li><p> function cannot be evaluated at initial parameters
</p>
</li>
<li><p> initial value in 'vmmin' is not finite</p>
</li></ol>



<h3>Value</h3>

<p>A list of length 5 consisting of the fitted model, equation form, parameters
of the boundary line, the residue mean square and the boundary points. Additionally,
a graphical representation of the boundary line on the scatter plot is produced.
</p>


<h3>Author(s)</h3>

<p>Chawezi Miti &lt;chawezi.miti@nottingham.ac.uk&gt;
</p>


<h3>References</h3>

<p>Nelder, J.A. 1961. The fitting of a generalization of the logistic curve.
Biometrics 17: 89â€“110.
</p>
<p>Phillips, B.F. &amp; Campbell, N.A. 1968. A new method of fitting the von Bertelanffy
growth curve using data on the whelk. Dicathais, Growth 32: 317â€“329.
</p>
<p>Schmidt, U., ThÃ¶ni, H., &amp; Kaupenjohann, M. (2000). Using a boundary line approach
to analyze N2O flux data from agricultural soils. Nutrient Cycling in Agroecosystems,
57, 119-129.
Schnug, E., Heym, J. M., &amp; Murphy, D. P. L. (1995). Boundary line determination
technique (BOLIDES). In P. C. Robert, R. H. Rust, &amp; W. E. Larson (Eds.), site
specific management for agricultural systems (p. 899-908). Wiley Online Library.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x&lt;-log(SoilP$P)
y&lt;-SoilP$yield
start&lt;-c(4,3,13.6,35,-5)

bolides(x,y,start=start,model = "trapezium",
        xlab=expression("Phosphorus/ln(mg L"^-1*")"),
        ylab=expression("Yield/ t ha"^-1), pch=16,
        col="grey", bp_col="grey")



</code></pre>

<hr>
<h2 id='cbvn'>Fitting boundary line using censored bivariate normal model</h2><span id='topic+cbvn'></span>

<h3>Description</h3>

<p>This function fits a response model to the upper limits  of a scatter plot of
of <code>x</code> and <code>y</code> to determine the most efficient response of <code>y</code>
as a function of <code>x</code> (given a measurement error of <code>y</code>) based on a
censored distribution (Milne et al., 2016). The location of censor in the data
cloud is determined based on the maximum likelihood approach. This is done using
optimization procedure and hence requires some starting guess parameters for the
proposed model. It then compares the results with an uncensored normal bivariate
distribution to access the appropriateness of the censored model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cbvn(data,model="lp", equation=NULL, start, sigh, UpLo="U", optim.method="BFGS",
      Hessian=FALSE, plot=TRUE, line_smooth=1000, lwd=2, l_col="red",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cbvn_+3A_data">data</code></td>
<td>
<p>A dataframe with two numeric columns, independent (<code>x</code>) and
dependent (<code>y</code>) variables respectively.</p>
</td></tr>
<tr><td><code id="cbvn_+3A_model">model</code></td>
<td>
<p>Selects the functional form of the boundary line. It includes
<code>"blm"</code> for linear model, <code>"lp"</code> for linear plateau model, <code>"mit"</code>
for the Mitscherlich model, <code>"schmidt"</code> for the Schmidt model,
<code>"logistic"</code> for logistic model, <code>"logisticND"</code> for logistic model
proposed by Nelder (1961), <code>"inv-logistic"</code> for the inverse logistic model,
<code>"double-logistic"</code> for the double logistic model, <code>"qd"</code> for
quadratic model and the <code>"trapezium"</code> for the trapezium model. For custom
models, set <code>model = "other"</code>.</p>
</td></tr>
<tr><td><code id="cbvn_+3A_equation">equation</code></td>
<td>
<p>A custom model function writen in the form of an R function. Applies
only when argument <code>model="other"</code>, else it is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="cbvn_+3A_start">start</code></td>
<td>
<p>A numeric vector of initial starting values for optimization
in fitting the boundary model. Its length and arrangement depend on the
suggested model: </p>

<ul>
<li><p> For the <code>"blm"</code> model, it is a vector of length 7 arranged as the
intercept, the slope, mean of <code>x</code>, mean of <code>y</code>, standard deviation
of <code>x</code>, standard deviation of <code>y</code> and the correlation of <code>x</code>
and <code>y</code>.
</p>
</li>
<li><p> For the <code>"lp"</code> model, it is a vector of length 8 arranged as the
intercept, the slope, the maximum or plateau response, mean of <code>x</code>,
mean of <code>y</code>, standard deviation of <code>x</code>, standard deviation of <code>y</code>
and the correlation of <code>x</code> and <code>y</code>.
</p>
</li>
<li><p> For the <code>"mit"</code> model, it is a vector of length 8 arranged as the
intercept, shape parameter, the maximum or plateau response, mean of <code>x</code>,
mean of <code>y</code>, standard deviation of <code>x</code>, standard deviation of <code>y</code>
and the correlation of <code>x</code> and <code>y</code>.
</p>
</li>
<li><p> For the <code>"logistic"</code>, <code>"inv-logistic"</code> and <code>"logisticND"</code>
models, it is a vector of length 8 arranged as scaling parameter, shape parameter,
the maximum or plateau value, mean of <code>x</code>, mean of <code>y</code>,
standard deviation of <code>x</code>, standard deviation of <code>y</code> and the
correlation of <code>x</code> and <code>y</code>.
</p>
</li>
<li><p> For the <code>"double-logistic"</code> model, it is a vector of length 11
arranged as scaling parameter, shape parameter, maximum response, maximum response,
scaling parameter two, shape parameter two, mean of <code>x</code>, mean of <code>y</code>,
standard deviation of <code>x</code>, standard deviation of <code>y</code> and the correlation
of <code>x</code> and <code>y</code>.
</p>
</li>
<li><p> For the <code>"trapezium"</code> model, it is a vector of length 10 arranged
as intercept one, slope one, maximum response, intercept two, slope two,
mean of <code>x</code>, mean of <code>y</code>, standard deviation of <code>x</code>,
standard deviation of <code>y</code> and the correlation of <code>x</code> and <code>y</code>.
</p>
</li>
<li><p> For the <code>"qd"</code> model, it is a vector of length 8 arranged as a
constant, linear coefficient, quadratic coefficient,mean of <code>x</code>,
mean of <code>y</code>, standard deviation of <code>x</code>, standard deviation of <code>y</code>
and the correlation of <code>x</code> and <code>y</code>.
</p>
</li>
<li><p> For the <code>"schmidt"</code> model, it is a vector of length 8 arranged the
scaling parameter, shape parameter (x-value at maximum response ),
maximum response, mean of <code>x</code>, mean of <code>y</code>, standard deviation of
<code>x</code>, standard deviation of <code>y</code> and the correlation of <code>x</code>
and <code>y</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="cbvn_+3A_sigh">sigh</code></td>
<td>
<p>Standard deviation of the measurement error.</p>
</td></tr>
<tr><td><code id="cbvn_+3A_uplo">UpLo</code></td>
<td>
<p>Selects the type of boundary. <code>"U"</code> fits the upper boundary and
&quot;L&quot; fits the lower boundary.</p>
</td></tr>
<tr><td><code id="cbvn_+3A_optim.method">optim.method</code></td>
<td>
<p>Describes the method used to optimize the model as in the
<code>optim()</code> function. The methods include <code>"Nelder-Mead"</code>, <code>"BFGS"</code>,
<code>"CG"</code>, <code>"L-BFGS-B"</code>, <code>"SANN"</code> and <code>"Brent"</code>.</p>
</td></tr>
<tr><td><code id="cbvn_+3A_hessian">Hessian</code></td>
<td>
<p>If <code>True</code>, the hessian matrix is part of the output
(default is <code>FALSE</code>').</p>
</td></tr>
<tr><td><code id="cbvn_+3A_plot">plot</code></td>
<td>
<p>If <code>TRUE</code>, a plot is part of the output. If <code>FALSE</code>, plot
is not part of output (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="cbvn_+3A_line_smooth">line_smooth</code></td>
<td>
<p>Parameter that describes the smoothness of the boundary line.
(default is 1000). The higher the value, the smoother the line.</p>
</td></tr>
<tr><td><code id="cbvn_+3A_lwd">lwd</code></td>
<td>
<p>Determines the thickness of the boundary line on the plot (default is 1).</p>
</td></tr>
<tr><td><code id="cbvn_+3A_l_col">l_col</code></td>
<td>
<p>Selects the color of the boundary line.</p>
</td></tr>
<tr><td><code id="cbvn_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters as in the <code>par()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Some inbuilt models are available for the <code>cbvn()</code> function. The suggest model
forms are as follows: </p>

<ol>
<li><p> Linear model (<code>"blm"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y=\beta_1 + \beta_2x</code>
</p>

<p>where <code class="reqn">\beta_1</code> is the intercept and <code class="reqn">\beta_2</code> is the slope.
</p>
</li>
<li><p> Linear plateau model (<code>"lp"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y= {\rm min}(\beta_1+\beta_2x, \beta_0)</code>
</p>

<p>where <code class="reqn">\beta_1</code> is the intercept , <code class="reqn">\beta_2</code> is the slope  and <code class="reqn">\beta_0</code>
is the maximum response.
</p>
</li>
<li><p> The logistic (<code>"logistic"</code>) and inverse logistic (<code>"inv-logistic"</code>)
models
</p>
<p style="text-align: center;"><code class="reqn"> y= \frac{\beta_0}{1+e^{\beta_2(\beta_1-x)}}</code>
</p>

<p style="text-align: center;"><code class="reqn"> y= \beta_0 - \frac{\beta_0}{1+e^{\beta_2(\beta_1-x)}}</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter , <code class="reqn">\beta_2</code> is a shape parameter
and <code class="reqn">\beta_0</code> is the maximum response.
</p>
</li>
<li><p> Logistic model (<code>"logisticND"</code>)  (Nelder (1961))
</p>
<p style="text-align: center;"><code class="reqn"> y= \frac{\beta_0}{1+(\beta_1 \times e^{-\beta_2x})}</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter, <code class="reqn">\beta_2</code> is a shape
parameter and <code class="reqn">\beta_0</code> is the maximum response.
</p>
</li>
<li><p> Double logistic model (<code>"double-logistic"</code>)
</p>
<p style="text-align: center;"><code class="reqn"> y= \frac{\beta_{0,1}}{1+e^{\beta_2(\beta_1-x)}} -
 \frac{\beta_{0,2}}{1+e^{\beta_4(\beta_3-x)}}</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter one, <code class="reqn">\beta_2</code> is shape parameter one,
<code class="reqn">\beta_{0,1}</code> and <code class="reqn">\beta_{0,2}</code> are the maximum response ,
<code class="reqn">\beta_3</code> is a scaling parameter two and  <code class="reqn">\beta_4</code> is a shape parameter two.
</p>
</li>
<li><p> Quadratic model (<code>"qd"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y=\beta_1 + \beta_2x + \beta_3x^2</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a constant, <code class="reqn">\beta_2</code> is a linear coefficient
and  <code class="reqn">\beta_3</code> is the quadratic coefficient.
</p>
</li>
<li><p> Trapezium model (<code>"trapezium"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y={\rm min}(\beta_1+\beta_2x, \beta_0, \beta_3 + \beta_4x)</code>
</p>

<p>where  <code class="reqn">\beta_1</code> is the intercept one, <code class="reqn">\beta_2</code> is the slope one,
<code class="reqn">\beta_0</code> is the maximum response, <code class="reqn">\beta_3</code> is the intercept two
and <code class="reqn">\beta_3</code> is the slope two.
</p>
</li>
<li><p> Mitscherlich model (<code>"mit"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y= \beta_0 - \beta_1*\beta_2^x</code>
</p>

<p>where <code class="reqn">\beta_1</code> is the intercept, <code class="reqn">\beta_2</code> is a shape parameter
and <code class="reqn">\beta_0</code> is the maximum response.
</p>
</li>
<li><p> Schmidt model (<code>"schmidt"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y= \beta_0 + \beta_1(x-\beta_2)^2</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter, <code class="reqn">\beta_2</code> is a
shape parameter (x-value at maximum response ) and <code class="reqn">\beta_0</code> is the
maximum response .
</p>
</li></ol>

<p>The function <code>cbvn()</code> utilities the optimization procedure of the
<code>optim()</code> function to determine the model parameters. There is a tendency
for optimization algorithms to settle at a local optimum. To remove the risk of
settling for local optimum parameters, it is advised that the function is run using
several starting values and the results with the smallest likelihood (or AIC)
can be taken as a representation of the global optimum.
</p>
<p>The common errors encountered due to poor start values </p>

<ol>
<li><p> function cannot be evaluated at initial parameters
</p>
</li>
<li><p> initial value in 'vmmin' is not finite</p>
</li></ol>



<h3>Value</h3>

<p>A list of length 5 consisting of the fitted model, equation form,
parameters of the boundary line, AIC (for boundary line model and a null model)
and a hessian matrix.  Additionally, a graphical representation of the boundary
line on the scatter plot is produced.
</p>


<h3>Author(s)</h3>


<ol>
<li><p> Chawezi Miti <a href="mailto:chawezi.miti@nottingham.ac.uk">chawezi.miti@nottingham.ac.uk</a>
</p>
</li>
<li><p> Richard Murray Lark <a href="mailto:murray.lark@nottingham.ac.uk">murray.lark@nottingham.ac.uk</a>
</p>
</li></ol>



<h3>References</h3>

<p>Nelder, J.A. 1961. The fitting of a generalization of the logistic curve.
Biometrics 17: 89â€“110.
</p>
<p>Lark, R. M., &amp; Milne, A. E. (2016). Boundary line analysis of the effect of water
filled pore space on nitrous oxide emission from cores of arable soil. European
Journal of Soil Science, 67 , 148-159.
</p>
<p>Lark, R. M., Gillingham, V., Langton, D., &amp; Marchant, B. P. (2020). Boundary line
models for soil nutrient concentrations and wheat yield in national-scale datasets.
European Journal of Soil Science, 71 , 334-351.
</p>
<p>Milne, A. E., Ferguson, R. B., &amp; Lark, R. M. (2006). Estimating a boundary line
model for a biological response by maximum likelihood.Annals of Applied Biology,
149, 223â€“234.
</p>
<p>Phillips, B.F. &amp; Campbell, N.A. 1968. A new method of fitting the von Bertelanffy
growth curve using data on the whelk. Dicathais, Growth 32: 317â€“329.
</p>
<p>Schmidt, U., ThÃ¶ni, H., &amp; Kaupenjohann, M. (2000). Using a boundary line approach
to analyze N2O flux data from agricultural soils. Nutrient Cycling in Agroecosystems,
57, 119-129.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x&lt;-evapotranspiration$`ET(mm)`
y&lt;-evapotranspiration$`yield(t/ha)`
data&lt;-data.frame(x,y)
start&lt;-c(0.5,0.02,289.6,2.4,83.7,1.07,0.287)

cbvn(data, start=start, model = "blm", sigh=0.51,
        xlab=expression("ET/ mm ha"^-1),
        ylab=expression("Yield/ ton ha"^-1),
        pch=16, col="grey", line_smooth = 100)

</code></pre>

<hr>
<h2 id='evapotranspiration'>Evapotranspiration data</h2><span id='topic+evapotranspiration'></span>

<h3>Description</h3>

<p>This is a dataset compiled by Sadras &amp; Angus (2006) that is comprises measures of
wheat yield and estimated evapotranspiration (ET) from sites in China, the
Mediterranean regions of Europe, North America, and Australia. For more details about
this dataset refer to Sadras &amp; Angus (2006).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evapotranspiration
</code></pre>


<h3>Format</h3>

<p>A data.frame with 691 rows and 3 columns:
</p>

<dl>
<dt>Region</dt><dd><p> Location of measurement</p>
</dd></dl>
<p>.
</p>
<dl>
<dt>ET (mm)</dt><dd><p> Evapotranspiration measurement(mm) measured</p>
</dd></dl>
<p>.
</p>
<dl>
<dt>Yield (t/ha)</dt><dd><p> Wheat yield (ton/ha) measured</p>
</dd></dl>
<p>.

</p>


<h3>Details</h3>

<p>This data set should only be used for illustration purposes for this package and
should not be used in any form publication without permission from the owners.
</p>


<h3>Source</h3>

<p>Sadras, V. O., &amp; Angus, J. F. (2006). Benchmarking water-use efficiency of
rainfed wheat in dry environments. Australian Journal of Agricultural Research, 57 ,
847-856.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(evapotranspiration)
</code></pre>

<hr>
<h2 id='expl_boundary'>Testing evidence of boundary existence in dataset</h2><span id='topic+expl_boundary'></span>

<h3>Description</h3>

<p>This function determines the probability of having bounding effects in a scatter
plot of of <code>x</code> and <code>y</code> based on the clustering of points at the upper
edge of the scatter plot (Miti et al.2024). It tests the hypothesis of larger
clustering at the upper bounds of a scatter plot against a null bivariate normal
distribution with no bounding effect (random scatter at upper edges). It returns
the probability (p-value) of the observed clustering given that it a realization
of an unbounded bivariate normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expl_boundary(x, y, shells = 10, simulations = 1000, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expl_boundary_+3A_x">x</code></td>
<td>
<p>A numeric vector of values for the independent variable.</p>
</td></tr>
<tr><td><code id="expl_boundary_+3A_y">y</code></td>
<td>
<p>A numeric vector of values for the response variable.</p>
</td></tr>
<tr><td><code id="expl_boundary_+3A_shells">shells</code></td>
<td>
<p>A numeric value indicating the number of boundary peels
(default is 10).</p>
</td></tr>
<tr><td><code id="expl_boundary_+3A_simulations">simulations</code></td>
<td>
<p>The number of simulations for the null bivariate normally
distributed data sets used to test the hypothesis (default is 1000).</p>
</td></tr>
<tr><td><code id="expl_boundary_+3A_plot">plot</code></td>
<td>
<p>If <code>TRUE</code>, a plot is part of the output. If <code>FALSE</code>, plot
is not part of output (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="expl_boundary_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters as with the <code>par()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is recommended that any outlying observations, as identified by the
<code>bagplot()</code> function of the <code>aplpack</code> package are removed from
the data. This is also implemented in the simulation step in the
<code>expl_boundary()</code> function.
</p>


<h3>Value</h3>

<p>A dataframe with the p-values of obtaining the observed standard deviation
of the euclidean distances of vertices in the upper peels to the center of the
dataset for the left and right sections of the dataset.
</p>


<h3>Author(s)</h3>

<p>Chawezi Miti &lt;chawezi.miti@nottingham.ac.uk&gt;
</p>


<h3>References</h3>

<p>Eddy, W. F. (1982). Convex hull peeling, COMPSTAT 1982-Part I: Proceedings in
Computational Statistics, 42-47. Physica-Verlag, Vienna.
</p>
<p>Miti. c., Milne. A. E., Giller. K. E. and Lark. R. M (2024). Exploration of data
for analysis using boundary line methodology. Computers and Electronics in Agriculture
219 (2024) 108794.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-evapotranspiration$`ET(mm)`
y&lt;-evapotranspiration$`yield(t/ha)`
expl_boundary(x,y,10,100) # recommendation is to set simulations to greater than 1000

</code></pre>

<hr>
<h2 id='kurt'>kurtosis</h2><span id='topic+kurt'></span>

<h3>Description</h3>

<p>A function to calculate an estimate of the coefficient of kurtosis
from a set of data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kurt(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kurt_+3A_x">x</code></td>
<td>
<p>A vector of numeric values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The reduced coefficient of kurtosis.
</p>


<h3>Author(s)</h3>

<p>Richard Murray Lark &lt;murray.lark@nottingham.ac.uk&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-evapotranspiration$`ET(mm)`
kurt(x)

</code></pre>

<hr>
<h2 id='limfactor'>Determination of the most limiting factor to biological response</h2><span id='topic+limfactor'></span>

<h3>Description</h3>

<p>This function determines the most limiting factor based on von Liebig law of
the minimum given results of the predicted boundary line values for the different
factors of interest. Boundary lines for various factors are fitted and the factor
that predicts the minimum response for a particular point is considered as the
most limiting factor (Casanova et al. 1995).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>limfactor(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="limfactor_+3A_...">...</code></td>
<td>
<p>vectors with predicted values from the boundary line models for
each factor being evaluated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe consisting of the most limiting factor and the minimum
predicted response
</p>


<h3>Author(s)</h3>

<p>Chawezi Miti &lt;chawezi.miti@nottingham.ac.uk&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
N&lt;-rnorm(10,50,5)#assuming these are predicted responses using the fitted BL for N,P,K
K&lt;-rnorm(10,50,4)
P&lt;-rnorm(10,50,6)

limfactor(N,K,P)

</code></pre>

<hr>
<h2 id='na.drop'>Remove NA values</h2><span id='topic+na.drop'></span>

<h3>Description</h3>

<p>Removes missing values from a dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>na.drop(xin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="na.drop_+3A_xin">xin</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector without missing values
</p>


<h3>Author(s)</h3>

<p>Richard Murray Lark &lt;murray.lark@nottingham.ac.uk&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-evapotranspiration$`ET(mm)`
na.drop(x)

</code></pre>

<hr>
<h2 id='ocskew'>Octile Skewness</h2><span id='topic+ocskew'></span>

<h3>Description</h3>

<p>A function to calculate an estimate of the octile skewness from a set of data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ocskew(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ocskew_+3A_x">x</code></td>
<td>
<p>A vector of numeric values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The octile skewness.
</p>


<h3>Author(s)</h3>

<p>Richard Murray Lark &lt;murray.lark@nottingham.ac.uk&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-evapotranspiration$`ET(mm)`
ocskew(x)

</code></pre>

<hr>
<h2 id='predictBL'>Predict boundary response</h2><span id='topic+predictBL'></span>

<h3>Description</h3>

<p>This function predicts the most efficient response at a level of factor,
<code>x</code>, given the parameters of the fitted boundary line.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictBL(object, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predictBL_+3A_object">object</code></td>
<td>
<p>An output in form of a list from the boundary line fitting using
the <code>blqr()</code>, <code>blbin()</code>, <code>bolides()</code> or <code>cbvn()</code> functions.</p>
</td></tr>
<tr><td><code id="predictBL_+3A_x">x</code></td>
<td>
<p>A numeric vector of values for the factor with which response is
to be predicted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector predicted value of response.
</p>


<h3>Author(s)</h3>

<p>Chawezi Miti &lt;chawezi.miti@nottingham.ac.uk&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x&lt;-evapotranspiration$`ET(mm)`
y&lt;-evapotranspiration$`yield(t/ha)`
z&lt;-bolides(x,y, start = c(0.5,0.02), model= "blm", xmax = 350)

Results&lt;-predictBL(z,x)

head(Results) # prediction for first 6 lines


</code></pre>

<hr>
<h2 id='print.cm'>Print class cm</h2><span id='topic+print.cm'></span>

<h3>Description</h3>

<p>This is an S3 print function that Prints only the first 4 elements of
cm class objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.cm_+3A_x">x</code></td>
<td>
<p>Print object.</p>
</td></tr>
<tr><td><code id="print.cm_+3A_...">...</code></td>
<td>
<p>Other parameters associated with the <code>print()</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A object containing only the first four items.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>numbers&lt;- 1:10
class(numbers)&lt;-"cm"
numbers

</code></pre>

<hr>
<h2 id='print.wm'>Print class wm</h2><span id='topic+print.wm'></span>

<h3>Description</h3>

<p>This is an S3 print function that Prints only the first 4 elements of
wm class objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.wm_+3A_x">x</code></td>
<td>
<p>Print object.</p>
</td></tr>
<tr><td><code id="print.wm_+3A_...">...</code></td>
<td>
<p>Other parameters associated with the <code>print()</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A object containing only the first four items.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>numbers&lt;- 1:10
class(numbers)&lt;-"wm"
numbers

</code></pre>

<hr>
<h2 id='seHessian'>Hessian matrix</h2><span id='topic+seHessian'></span>

<h3>Description</h3>

<p>This is a set of functions that support the censored bivariate normal model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seHessian(a, hessian = FALSE, silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seHessian_+3A_a">a</code></td>
<td>
<p>The hessian matrix.</p>
</td></tr>
<tr><td><code id="seHessian_+3A_hessian">hessian</code></td>
<td>
<p>If 'True', hessian matrix is used.</p>
</td></tr>
<tr><td><code id="seHessian_+3A_silent">silent</code></td>
<td>
<p>Condition of matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The standard error from hessian matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
hessian&lt;-matrix(c(37.45965, 83.0686,83.06863,188.92427),2,2)

seHessian(hessian) # calculates the standard error

</code></pre>

<hr>
<h2 id='skew'>Skewness</h2><span id='topic+skew'></span>

<h3>Description</h3>

<p>Function to calculate an estimate of the coefficient of skewness from
a set of data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skew(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="skew_+3A_x">x</code></td>
<td>
<p>A vector of numeric values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The coefficient of skewness.
</p>


<h3>Author(s)</h3>

<p>Richard Murray Lark &lt;murray.lark@nottingham.ac.uk&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-evapotranspiration$`ET(mm)`
skew(x)

</code></pre>

<hr>
<h2 id='soil'>Soil survey data</h2><span id='topic+soil'></span>

<h3>Description</h3>

<p>This data set is a subset of a data set that was assembled by AgSpace Agriculture Ltd
in a soil survey conducted on farms in various management units across England. The
survey included measurements of wheat yield as well as various soil parameters. This
particular dataset only contains the soil properties pH and  phosphorus (P).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>soil
</code></pre>


<h3>Format</h3>

<p>A data.frame with 6110 rows and 3 columns:
</p>

<dl>
<dt>yield</dt><dd><p> Wheat yield (ton/ha) measured</p>
</dd></dl>
<p>.
</p>
<dl>
<dt>pH</dt><dd><p> pH measurement</p>
</dd></dl>
<p>.
</p>
<dl>
<dt>P</dt><dd><p> soil p (mg/kg)</p>
</dd></dl>
<p>.

</p>


<h3>Details</h3>

<p>This data set should only be used for illustration purposes for this package and
should not be used in any form publication without permission from the owners.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soil)
</code></pre>

<hr>
<h2 id='SoilP'>Soil Phosphorus data</h2><span id='topic+SoilP'></span>

<h3>Description</h3>

<p>This data set is a subset of a data set that was assembled by AgSpace Agriculture Ltd
in a soil survey conducted on farms in various management units across England.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SoilP
</code></pre>


<h3>Format</h3>

<p>A data.frame with 6020 rows and 2 columns:
</p>

<dl>
<dt>yield</dt><dd><p> Wheat yield (ton/ha) measured</p>
</dd></dl>
<p>.
</p>
<dl>
<dt>P</dt><dd><p> Phosphorus (mg/l)</p>
</dd></dl>
<p>.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SoilP)
</code></pre>

<hr>
<h2 id='SoilpH'>Soil pH data</h2><span id='topic+SoilpH'></span>

<h3>Description</h3>

<p>This data set is a subset of a data set that was assembled by AgSpace Agriculture Ltd
in a soil survey conducted on farms in various management units across England.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SoilpH
</code></pre>


<h3>Format</h3>

<p>A data.frame with 6047 rows and 2 columns:
</p>

<dl>
<dt>yield</dt><dd><p> Wheat yield (ton/ha) measured</p>
</dd></dl>
<p>.
</p>
<dl>
<dt>pH</dt><dd><p> pH measurement</p>
</dd></dl>
<p>.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SoilpH)
</code></pre>

<hr>
<h2 id='startValues'>Starting values for optimization functions</h2><span id='topic+startValues'></span>

<h3>Description</h3>

<p>This functions helps to determine initial values for a selected boundary line
model when using the functions <code>blbin()</code>, <code>blqr()</code>, <code>bolides()</code>,
<code>cbvn()</code> and <code>ble_profile()</code> to determine model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>startValues(model = "explore", p = NULL, digits = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="startValues_+3A_model">model</code></td>
<td>
<p>Selects the functional form of the boundary line. It includes
<code>"blm"</code> for linear model, <code>"lp"</code> for
linear plateau model, <code>"mit"</code> for the Mitscherlich model, <code>"schmidt"</code>
for the Schmidt model, <code>"logistic"</code> for logistic model, <code>"logisticND"</code>
for logistic model proposed by Nelder (1961), <code>"inv-logistic"</code> for
the inverse logistic model, <code>"double-logistic"</code> for the double logistic model,
<code>"qd"</code> for quadratic model, <code>"trapezium"</code> for the trapezium model and
<code>"explore"</code> for function use exploration. The default is <code>"explore"</code>.</p>
</td></tr>
<tr><td><code id="startValues_+3A_p">p</code></td>
<td>
<p>The number of selected points used to obtain start values for the logistic
mitcherlich and schmidt models. It is <code>NULL</code> for other models.</p>
</td></tr>
<tr><td><code id="startValues_+3A_digits">digits</code></td>
<td>
<p>Number of decimal points for logistic type models (default is 2).</p>
</td></tr>
<tr><td><code id="startValues_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters. Applies to the logistic, mitcherlich and
schmidt models to control the text on the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses the <code>locator()</code> function. Once the model is selected,
the points that make up the boundary points are selected using mouse click on
the plots.
</p>


<h3>Value</h3>

<p>A list containing the parameters of the suggested model.
</p>


<h3>Author(s)</h3>

<p>Chawezi Miti &lt;chawezi.miti@nottingham.ac.uk&gt;
</p>


<h3>References</h3>

<p>Fekedulegn, D., Mac Siurtain, M.P., &amp; Colbert, J.J. 1999. Parameter estimation of
nonlinear growth models in forestry. Silva Fennica 33(4): 327â€“336.
</p>
<p>Lark, R. M., &amp; Milne, A. E. (2016). Boundary line analysis of the effect of water
filled pore space on nitrous oxide emission from cores of arable soil. European
Journal of Soil Science, 67 , 148-159.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>startValues(model="explore")


</code></pre>

<hr>
<h2 id='summastat'>Summary statistics</h2><span id='topic+summastat'></span>

<h3>Description</h3>

<p>A function to calculate summary statistics of a set of data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summastat(x, sigf, varname, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summastat_+3A_x">x</code></td>
<td>
<p>A vector of numeric values.</p>
</td></tr>
<tr><td><code id="summastat_+3A_sigf">sigf</code></td>
<td>
<p>The number of significant figures to report (optional).</p>
</td></tr>
<tr><td><code id="summastat_+3A_varname">varname</code></td>
<td>
<p>The name of the variable (optional), character so in quotes e.g.
&quot;Clay content&quot;. If not used then the variable is called x on plots.</p>
</td></tr>
<tr><td><code id="summastat_+3A_plot">plot</code></td>
<td>
<p>If <code>TRUE</code>, a plot is part of the output. If <code>FALSE</code>, plot
is not part of output (default is <code>TRUE</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the mean value, median value,
first and third quartiles, sample variance, sample standard deviation,
coefficient of skewness, octile skewness, coefficient of kurtosis and
the number of probable outliers in a data set. A histogram with a boxplot
over it and QQ plot of the variable x if <code>plot=TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Richard Murray Lark &lt;murray.lark@nottingham.ac.uk&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-evapotranspiration$`ET(mm)`
summastat(x,2)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
