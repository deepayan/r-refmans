<!DOCTYPE html><html lang="en"><head><title>Help for package psy</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {psy}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ckappa'><p>Cohen's Kappa for 2 raters</p></a></li>
<li><a href='#cronbach'><p>Cronbach's coefficient alpha</p></a></li>
<li><a href='#ehd'><p>Depressive Mood Scale</p></a></li>
<li><a href='#expsy'><p>Data set related to psychometry</p></a></li>
<li><a href='#fpca'><p>Focused Principal Components Analysis</p></a></li>
<li><a href='#icc'><p>Intraclass correlation coefficient (ICC)</p></a></li>
<li><a href='#lkappa'><p>Light's kappa for n raters</p></a></li>
<li><a href='#mdspca'><p>Graphical representation of a correlation matrix using a Principal Component Analysis</p></a></li>
<li><a href='#mtmm'><p>Multitrait Multimethod approach of scale validation</p></a></li>
<li><a href='#psy'><p>Various procedures used in psychometry</p></a></li>
<li><a href='#scree.plot'><p>Screeplot of eigenvalues, simulated data are available</p></a></li>
<li><a href='#sleep'><p> Ecological and Constitutional Data in Mammals</p></a></li>
<li><a href='#sphpca'><p>Spherical Representation of a Correlation Matrix</p></a></li>
<li><a href='#wkappa'><p>weighted Kappa for 2 raters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Various Procedures Used in Psychometrics</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Kappa, ICC, reliability coefficient, parallel analysis, 
     multi-traits multi-methods, spherical representation of a correlation matrix.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-21 13:20:08 UTC; Bruno</td>
</tr>
<tr>
<td>Author:</td>
<td>Bruno Falissard [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bruno Falissard &lt;falissard_b@wanadoo.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-21 22:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ckappa'>Cohen's Kappa for 2 raters</h2><span id='topic+ckappa'></span>

<h3>Description</h3>

<p>Computes Cohen's Kappa for agreement in the case of 2 raters. The diagnosis (the object of the rating) may have k possible values.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ckappa(r)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ckappa_+3A_r">r</code></td>
<td>
<p>n*2 matrix or dataframe, n subjects and 2 raters</p>
</td></tr></table>


<h3>Details</h3>

<p>The function deals with the case where the two raters have not exactly the same scope of rating (some software associate an error with this situation).
Missing value are omitted.</p>


<h3>Value</h3>

<p>A list with :
</p>
<table role = "presentation">
<tr><td><code>$table</code></td>
<td>
<p>the 2*k table of raw data (first rater in rows, second rater in columns)</p>
</td></tr>
<tr><td><code>$kappa</code></td>
<td>
<p>Cohen's Kappa</p>
</td></tr></table>


<h3>Author(s)</h3>

<p>Bruno Falissard</p>


<h3>References</h3>

<p>Cohen, J. (1960), A coefficient of agreement for nominal scales, Educational and Psychological measurements, 20, 37-46.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(expsy)
## Cohen's kappa for binary diagnosis
ckappa(expsy[,c(12,14)])

##to obtain a 95%confidence interval:
#library(boot)
#ckappa.boot &lt;- function(data,x) {ckappa(data[x,])[[2]]}
#res &lt;- boot(expsy[,c(12,14)],ckappa.boot,1000)
## two-sided bootstrapped confidence interval of kappa
#quantile(res$t,c(0.025,0.975))
## adjusted bootstrap percentile (BCa) confidence interval (better)
#boot.ci(res,type="bca")
##Cohen's kappa for non binary diagnosis
#ckappa(expsy[,c(11,13)])
</code></pre>

<hr>
<h2 id='cronbach'>Cronbach's coefficient alpha</h2><span id='topic+cronbach'></span>

<h3>Description</h3>

<p>Computes the Cronbach's reliability coefficient alpha. This coefficient may be applied to a series of items destinated to be aggregated in a single score. It estimates reliability in the framework of the domain sampling model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cronbach(v1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cronbach_+3A_v1">v1</code></td>
<td>
<p>n*p matrix or dataframe, n subjects and p items</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Missing value are omitted in a &quot;listwise&quot; way (all items are removed even if only one of them is missing).
</p>


<h3>Value</h3>

<p>A list with :
</p>
<table role = "presentation">
<tr><td><code>$sample.size</code></td>
<td>
<p>Number of subjects under study</p>
</td></tr>
<tr><td><code>$number.of.items</code></td>
<td>
<p>Number of items of the scale or questionnaire</p>
</td></tr>
<tr><td><code>$alpha</code></td>
<td>
<p>alpha</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bruno Falissard</p>


<h3>References</h3>

<p>Nunnaly, J.C., Bernstein, I.H. (1994), Psychometric Theory, 3rd edition, McGraw-Hill Series in Psychology.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(expsy)
cronbach(expsy[,1:10])  ## not good because item 2 is reversed (1 is high and 4 is low)
cronbach(cbind(expsy[,c(1,3:10)],-1*expsy[,2]))  ## better

#to obtain a 95%confidence interval:
#datafile &lt;- cbind(expsy[,c(1,3:10)],-1*expsy[,2])
#library(boot)
#cronbach.boot &lt;- function(data,x) {cronbach(data[x,])[[3]]}
#res &lt;- boot(datafile,cronbach.boot,1000)
#quantile(res$t,c(0.025,0.975))  ## two-sided bootstrapped confidence interval of Cronbach's alpha
#boot.ci(res,type="bca")         ## adjusted bootstrap percentile (BCa) confidence interval (better)
</code></pre>

<hr>
<h2 id='ehd'>Depressive Mood Scale</h2><span id='topic+ehd'></span>

<h3>Description</h3>

<p>A data frame with 269 observations on the following 20 variables.
Jouvent, R et al 1988 La clinique polydimensionnelle de humeur depressive.
Nouvelle version echelle EHD  : Polydimensional rating scale of depressive mood.
Psychiatrie et Psychobiologie.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ehd)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>e1</dt><dd><p>Observed painfull sadness</p>
</dd>
<dt>e2</dt><dd><p>Emotional hyperexpressiveness</p>
</dd>
<dt>e3</dt><dd><p>Emotional instability</p>
</dd>
<dt>e4</dt><dd><p>Observed monotony</p>
</dd>
<dt>e5</dt><dd><p>Lack spontaneous expressivity</p>
</dd>
<dt>e6</dt><dd><p>Lack affective reactivity</p>
</dd>
<dt>e7</dt><dd><p>Emotional incontinence</p>
</dd>
<dt>e8</dt><dd><p>Affective hyperesthesia</p>
</dd>
<dt>e9</dt><dd><p>Observed explosive mood</p>
</dd>
<dt>e10</dt><dd><p>Worried gesture</p>
</dd>
<dt>e11</dt><dd><p>Observed anhedonia</p>
</dd>
<dt>e12</dt><dd><p>Felt sadness</p>
</dd>
<dt>e13</dt><dd><p>Situational anhedonia</p>
</dd>
<dt>e14</dt><dd><p>Felt affective indifference</p>
</dd>
<dt>e15</dt><dd><p>Hypersensibility unpleasent events</p>
</dd>
<dt>e16</dt><dd><p>Sensory anhedonia</p>
</dd>
<dt>e17</dt><dd><p>Felt affective monotony</p>
</dd>
<dt>e18</dt><dd><p>Felt hyperemotionalism</p>
</dd>
<dt>e19</dt><dd><p>Felt irritability</p>
</dd>
<dt>e20</dt><dd><p>Felt explosive mood</p>
</dd>
</dl>



<h3>Source</h3>

<p>Jouvent, R et al 1988 La clinique polydimensionnelle de humeur depressive.
Nouvelle version echelle EHD  : Polydimensional rating scale of depressive mood.
Psychiatrie et Psychobiologie.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ehd)
str(ehd)
</code></pre>

<hr>
<h2 id='expsy'>Data set related to psychometry</h2><span id='topic+expsy'></span>

<h3>Description</h3>

<p>The <code>expsy</code>
data frame has 30 rows and 16 columns with missing data.
it1-it10 correspond to the rating of 30 patients with a 10 items scale.
r1, r2, r3 to the rating of item 1 by 3 different clinicians of the same 30 patients.
rb1, rb2, rb3 to the binary transformation of r1, r2, r3 (1 or 2 -&gt; 0; and 3 or 4 -&gt; 1) .
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(expsy)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>it1</dt><dd><p>a numeric vector corresponding to item 1 (rated from 1:low to 4:high)</p>
</dd>
<dt>it2</dt><dd><p>a numeric vector corresponding to item 2 (rated from 1:high to 4:low)</p>
</dd>
<dt>it3</dt><dd><p>a numeric vector corresponding to item 3 (rated from 1:low to 4:high)</p>
</dd>
<dt>it4</dt><dd><p>a numeric vector corresponding to item 4 (rated from 1:low to 4:high)</p>
</dd>
<dt>it5</dt><dd><p>a numeric vector corresponding to item 5 (rated from 1:low to 4:high)</p>
</dd>
<dt>it6</dt><dd><p>a numeric vector corresponding to item 6 (rated from 1:low to 4:high)</p>
</dd>
<dt>it7</dt><dd><p>a numeric vector corresponding to item 7 (rated from 1:low to 4:high)</p>
</dd>
<dt>it8</dt><dd><p>a numeric vector corresponding to item 8 (rated from 1:low to 4:high)</p>
</dd>
<dt>it9</dt><dd><p>a numeric vector corresponding to item 9 (rated from 1:low to 4:high)</p>
</dd>
<dt>it10</dt><dd><p>a numeric vector corresponding to item 10 (rated from 1:low to 4:high)</p>
</dd>
<dt>r1</dt><dd><p>a numeric vector corresponding to item 1 rated by rater 1</p>
</dd>
<dt>rb1</dt><dd><p>binary transformation of r1</p>
</dd>
<dt>r2</dt><dd><p>a numeric vector corresponding to item 1 rated by rater 2</p>
</dd>
<dt>rb2</dt><dd><p>binary transformation of r2</p>
</dd>
<dt>r3</dt><dd><p>a numeric vector corresponding to item 1 rated by rater 3</p>
</dd>
<dt>rb3</dt><dd><p>binary transformation of r3</p>
</dd>
</dl>



<h3>Source</h3>

<p>artificial data</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(expsy)
expsy[1:4,]
</code></pre>

<hr>
<h2 id='fpca'>Focused Principal Components Analysis</h2><span id='topic+fpca'></span>

<h3>Description</h3>

<p>Graphical representation similar to a principal components analysis but adapted to data structured with dependent/independent variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fpca(formula=NULL,y=NULL, x=NULL, data, cx=0.75, pvalues="No",
     partial="Yes", input="data", contraction="No", sample.size=1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fpca_+3A_formula">formula</code></td>
<td>
<p>&quot;model&quot; formula, of the form y ~ x </p>
</td></tr>
<tr><td><code id="fpca_+3A_y">y</code></td>
<td>
<p>column number of the dependent variable</p>
</td></tr>
<tr><td><code id="fpca_+3A_x">x</code></td>
<td>
<p>column numbers of the independent (explanatory) variables</p>
</td></tr>
<tr><td><code id="fpca_+3A_data">data</code></td>
<td>
<p>name of datafile</p>
</td></tr>
<tr><td><code id="fpca_+3A_cx">cx</code></td>
<td>
<p>size of the lettering (0.75 by default, 1 for bigger letters, 0.5 for smaller)</p>
</td></tr>
<tr><td><code id="fpca_+3A_pvalues">pvalues</code></td>
<td>
<p>vector of prespecified pvalues (pvalues=&quot;No&quot; by default) (see below)</p>
</td></tr>
<tr><td><code id="fpca_+3A_partial">partial</code></td>
<td>
<p>partial=&quot;Yes&quot; by default, corresponds to the original method (see below)</p>
</td></tr>
<tr><td><code id="fpca_+3A_input">input</code></td>
<td>
<p>input=&quot;Cor&quot; for a correlation matrix (input=&quot;data&quot; by default)</p>
</td></tr>
<tr><td><code id="fpca_+3A_contraction">contraction</code></td>
<td>
<p>change the aspect of the diagram, contraction=&quot;Yes&quot; is convenient for large data set (contraction=&quot;No&quot; by default)</p>
</td></tr>
<tr><td><code id="fpca_+3A_sample.size">sample.size</code></td>
<td>
<p>to be specified if input=&quot;Cor&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This representation is close to a Principal Components Analysis (PCA).
Contrary to PCA, correlations between the dependent variable and the other variables are represented faithfully. The relationships between non dependent variables are interpreted like in a PCA: correlated variables are close or diametrically opposite (for negative correlations), independent variables make a right angle with the origin.
The focus on the dependent variable leads formally to a partialisation of the correlations between the non dependent variables by the dependent variable (see reference). To avoid this partialisation, the option partial=&quot;No&quot; can be used.
It may be interesting to represent graphically the strength of association between the dependent variable and the other variables using p values coming from a model. A vector of pvalue may be specified in this case.
</p>


<h3>Value</h3>

<p>A plot (q plots in fact).
</p>


<h3>Author(s)</h3>

<p>Bruno Falissard, Bill Morphey, Adeline Abbe</p>


<h3>References</h3>

<p>Falissard B, Focused Principal Components Analysis: looking at a correlation matrix with a particular interest in a given variable. Journal of Computational and Graphical Statistics (1999), 8(4): 906-912.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sleep)
fpca(Paradoxical.sleep~Body.weight+Brain.weight+Slow.wave.sleep+Maximum.life.span+
     Gestation.time+Predation+Sleep.exposure+Danger,data=sleep)
fpca(y="Paradoxical.sleep",x=c("Body.weight","Brain.weight","Slow.wave.sleep",
     "Maximum.life.span","Gestation.time","Predation","Sleep.exposure","Danger"),data=sleep)


## focused PCA of the duration of paradoxical sleep (dreams, 5th column)
## against constitutional variables in mammals (columns 2, 3, 4, 7, 8, 9, 10, 11).
## Variables inside the red cercle are significantly correlated
## to the dependent variable with p&lt;0.05.
## Green variables are positively correlated to the dependent variable,
## yellow variables are negatively correlated.
## There are three clear clusters of independent variables.

corsleep &lt;- as.data.frame(cor(sleep[,2:11],use="pairwise.complete.obs"))
fpca(Paradoxical.sleep~Body.weight+Brain.weight+Slow.wave.sleep+Maximum.life.span+
    Gestation.time+Predation+Sleep.exposure+Danger,
data=corsleep,input="Cor",sample.size=60)

## when missing data are numerous, the representation of a pairwise correlation
## matrix may be preferred (even if mathematical properties are not so good...)

numer &lt;- c(2:4,7:11)
l &lt;- length(numer)
resu &lt;- vector(length=l)
for(i in 1:l)
{
int &lt;- sleep[,numer[i]]
mod &lt;- lm(sleep$Paradoxical.sleep~int)
resu[i] &lt;-  summary(mod)[[4]][2,4]*sign(summary(mod)[[4]][2,1])
}
fpca(Paradoxical.sleep~Body.weight+Brain.weight+Slow.wave.sleep+Maximum.life.span+
     Gestation.time+Predation+Sleep.exposure+Danger,
data=sleep,pvalues=resu)
## A representation with p values
## When input="Cor" or pvalues="Yes" partial is turned to "No"

mod &lt;- lm(sleep$Paradoxical.sleep~sleep$Body.weight+sleep$Brain.weight+
sleep$Slow.wave.sleep+sleep$Maximum.life.span+sleep$Gestation.time+
sleep$Predation+sleep$Sleep.exposure+sleep$Danger)
resu &lt;-  summary(mod)[[4]][2:9,4]*sign(summary(mod)[[4]][2:9,1])
fpca(Paradoxical.sleep~Body.weight+Brain.weight+Slow.wave.sleep+Maximum.life.span+
     Gestation.time+Predation+Sleep.exposure+Danger,
data=sleep,pvalues=resu)
## A representation with p values which come from a multiple linear model
## (here results are difficult to interpret)
</code></pre>

<hr>
<h2 id='icc'>Intraclass correlation coefficient (ICC)</h2><span id='topic+icc'></span>

<h3>Description</h3>

<p>Computes the ICC of several series of measurements, for example in an interrater agreement study. Two types of ICC are proposed: consistency and agreement.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>icc(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="icc_+3A_data">data</code></td>
<td>
<p>n*p matrix or dataframe, n subjects p raters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Missing data are omitted in a listwise way. The &quot;agreement&quot; ICC is the ratio of the subject variance by the sum of the subject variance, the rater variance and the residual; it is generally prefered. The &quot;consistency&quot; version is the ratio of the subject variance by the sum of the subject variance and the residual; it may be of interest when estimating the reliability of pre/post variations in measurements.
</p>


<h3>Value</h3>

<p>A list with :
</p>
<table role = "presentation">
<tr><td><code>$nb.subjects</code></td>
<td>
<p>number of subjects under study</p>
</td></tr>
<tr><td><code>$nb.raters</code></td>
<td>
<p>number of raters</p>
</td></tr>
<tr><td><code>$subject.variance</code></td>
<td>
<p>subject variance</p>
</td></tr>
<tr><td><code>$rater.variance</code></td>
<td>
<p>rater variance</p>
</td></tr>
<tr><td><code>$residual</code></td>
<td>
<p>residual variance</p>
</td></tr>
<tr><td><code>$icc.consistency</code></td>
<td>
<p>Intra class correlation coefficient, &quot;consistency&quot; version</p>
</td></tr>
<tr><td><code>$icc.agreement</code></td>
<td>
<p>Intra class correlation coefficient, &quot;agreement&quot; version</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bruno Falissard</p>


<h3>References</h3>

<p>Shrout, P.E., Fleiss, J.L. (1979), Intraclass correlation: uses in assessing rater reliability, Psychological Bulletin, 86, 420-428.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(expsy)
icc(expsy[,c(12,14,16)])

#to obtain a 95%confidence interval:
#library(boot)
#icc.boot &lt;- function(data,x) {icc(data[x,])[[7]]}
#res &lt;- boot(expsy[,c(12,14,16)],icc.boot,1000)
#quantile(res$t,c(0.025,0.975))  # two-sided bootstrapped confidence interval of icc (agreement)
#boot.ci(res,type="bca")         # adjusted bootstrap percentile (BCa) confidence interval (better)
</code></pre>

<hr>
<h2 id='lkappa'>Light's kappa for n raters</h2><span id='topic+lkappa'></span>

<h3>Description</h3>

<p>Computes Light's Kappa for agreement in the case of n raters. The diagnosis (the object of the rating) may have k possible values (ordered or not).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lkappa(r, type="Cohen", weights="squared")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lkappa_+3A_r">r</code></td>
<td>
<p>m*n matrix, m subjects and n raters</p>
</td></tr>
<tr><td><code id="lkappa_+3A_type">type</code></td>
<td>
<p>type=&quot;Cohen&quot; for a categorical diagnosis. If not, the diagnosis is supposed to be ordered</p>
</td></tr>
<tr><td><code id="lkappa_+3A_weights">weights</code></td>
<td>
<p>weights=&quot;squared&quot; for a weighted kappa with squared weights. If not, weigths are computed with absolute values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Light's Kappa is equal to the mean of the n(n-1)/2 kappas obtained from each pair of raters. Missing values are omitted locally when considering each pair of raters.
If type=&quot;Cohen&quot; the diagnosis is considered as a categorical variable. If not, the diagnosis is considered as an ordered variable and weigthed kappa's are computed.
In this last situation, the type of weights that is used (squared or absolute values) is given by the variable weigths.
</p>


<h3>Value</h3>

<p>kappa (mean of the n(n-1)/2 kappas obtained from each pair of raters)
</p>


<h3>Author(s)</h3>

<p>Bruno Falissard</p>


<h3>References</h3>

<p>Conger, A.J. (1980), Integration and generalisation of Kappas for multiple raters, Psychological Bulletin, 88, 322-328.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(expsy)
lkappa(expsy[,c(11,13,15)])       # Light's kappa for non binary diagnosis
lkappa(expsy[,c(12,14,16)])       # Light's kappa for binary diagnosis
lkappa(expsy[,c(11,13,15)], type="weighted")      # Light's kappa for non binary ordered diagnosis

#to obtain a 95%confidence interval:
#library(boot)
#lkappa.boot &lt;- function(data,x) {lkappa(data[x,], type="weighted")}
#res &lt;- boot(expsy[,c(11,13,15)],lkappa.boot,1000)
#quantile(res$t,c(0.025,0.975))    # Bootstrapped confidence interval of Light's kappa
#boot.ci(res,type="bca")           # adjusted bootstrap percentile (BCa) confidence interval
</code></pre>

<hr>
<h2 id='mdspca'>Graphical representation of a correlation matrix using a Principal Component Analysis</h2><span id='topic+mdspca'></span>

<h3>Description</h3>

<p>Similar to many routines, the interest is in the possible representation of both variables and subjects (and by the way categorical variables) with active and supplementary points. Missing data are omitted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdspca(datafile, supvar="no", supsubj="no", namesupvar=colnames(supvar,do.NULL=FALSE),
       namesupsubj=colnames(supsubj, do.NULL=FALSE), dimx=1, dimy=2, cx=0.75)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mdspca_+3A_datafile">datafile</code></td>
<td>
<p>name of datafile</p>
</td></tr>
<tr><td><code id="mdspca_+3A_supvar">supvar</code></td>
<td>
<p>matrix corresponding to supplementary variables (if any), supvar=&quot;no&quot; by default</p>
</td></tr>
<tr><td><code id="mdspca_+3A_supsubj">supsubj</code></td>
<td>
<p>matrix corresponding to supplementary subjects (if any), supsubj=&quot;no&quot; by default</p>
</td></tr>
<tr><td><code id="mdspca_+3A_namesupvar">namesupvar</code></td>
<td>
<p>names of the points corresponding to the supplementary variables</p>
</td></tr>
<tr><td><code id="mdspca_+3A_namesupsubj">namesupsubj</code></td>
<td>
<p>names of the points corresponding to the supplementary subjects</p>
</td></tr>
<tr><td><code id="mdspca_+3A_dimx">dimx</code></td>
<td>
<p>rank of the component displayed on the x axis (1 by default)</p>
</td></tr>
<tr><td><code id="mdspca_+3A_dimy">dimy</code></td>
<td>
<p>rank of the component displayed on the y axis (2 by default)</p>
</td></tr>
<tr><td><code id="mdspca_+3A_cx">cx</code></td>
<td>
<p>size of the lettering (0.75 by default, 1 for bigger letters, 0.5 for smaller)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A diagram (two diagrams if supplementary subjects are used)
</p>


<h3>Author(s)</h3>

<p>Bruno Falissard</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sleep)

mdspca(sleep[,c(2:5,7:11)])
## three consistent groups of variables, paradoxical sleep (in other words: dream)
## is negatively correlated with danger

mdspca(sleep[,c(2:5,7:11)],supvar=sleep[,6],namesupvar="Total.sleep",supsubj=sleep[,1],
       namesupsubj="",cx=0.5)
## Total.sleep is here a supplementary variable since it is deduced
## from Paradoxical.sleep and Slow.wave.sleep
## The variable Species is displayed in the subject plane,
## Rabbit and Cow have a high level of danger
</code></pre>

<hr>
<h2 id='mtmm'>Multitrait Multimethod approach of scale validation</h2><span id='topic+mtmm'></span>

<h3>Description</h3>

<p>This function is destinated to assess the convergent and discriminant validity of subscales of a given scale.
Items belonging to the same subscale should correlate highly amongst themselves.
Items belonging to different subscales should not correlate highly.
This approach is simpler and more robust than confirmatory factor analysis (CFA).
It can be interesting to verify (at least approximately) the proposed structure of an existing instrument in a new population.
Most psychometricians will however prefer CFA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtmm(datafile,x,color=FALSE,itemTot=FALSE,graphItem=FALSE,stripChart=FALSE,namesDim=NULL)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mtmm_+3A_datafile">datafile</code></td>
<td>
<p>name of datafile</p>
</td></tr>
<tr><td><code id="mtmm_+3A_x">x</code></td>
<td>
<p>a list of variable names (as many elements as there are subscales)</p>
</td></tr>
<tr><td><code id="mtmm_+3A_color">color</code></td>
<td>
<p>boxplot are in colour: FALSE = colourless just in grey and white (by default), TRUE = with colours</p>
</td></tr>
<tr><td><code id="mtmm_+3A_itemtot">itemTot</code></td>
<td>
<p>if TRUE, for subscale i (i=1,...,n), boxplot of Pearson's correlations between total score of subscale i and the items of subscale j (j=1,...n).
If j=i, the item is omited in the computation of the total score. If FALSE, for subscale i (i=1,...,n), boxplot of Pearson's correlations between the items of
subscale i and the items of subscale j (j=1,...n)</p>
</td></tr>
<tr><td><code id="mtmm_+3A_graphitem">graphItem</code></td>
<td>
<p>if TRUE represents graphically each correlation</p>
</td></tr>
<tr><td><code id="mtmm_+3A_stripchart">stripChart</code></td>
<td>
<p>if TRUE, dot charts are preferred to boxplots. Used with small number of items</p>
</td></tr>
<tr><td><code id="mtmm_+3A_namesdim">namesDim</code></td>
<td>
<p>Labels foreach boxplots</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For subscale i (i=1,...,n), displays the n boxplots of the distributions of the Pearson's correlations between items of subscale i and items of subscale j (j=1,...,n).
If j=i, the correlation of a given item with itself is ommited.
Boxplot for i=j (grey by default) should be above boxplots for i!=j.
Likewise, the correlation of an item with the global score of its subscale should be above its correlations with the global score of the other subscales.
</p>


<h3>Author(s)</h3>

<p>Adeline Abbe</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ehd)

par(mfrow=c(1,5))
mtmm(ehd,list(c("e15","e18","e19","e20"),c("e4","e5","e6","e14","e17"),c("e11","e13","e16")
,c("e1","e10","e12"),c("e2","e3","e7","e8","e9")))

# Boxplots of the distributions of the Pearson's correlations between total score of
# subscale i and the items of subscale j
par(mfrow=c(1,5))
mtmm(ehd,list(c("e15","e18","e19","e20"),c("e4","e5","e6","e14","e17"),c("e11","e13","e16")
,c("e1","e10","e12"),c("e2","e3","e7","e8","e9")))

# Pearson's correlations between total score of subscale i and all items
par(mfrow=c(3,2))
mtmm(ehd,list(c("e15","e18","e19","e20"),c("e4","e5","e6","e14","e17"),c("e11","e13","e16")
,c("e1","e10","e12"),c("e2","e3","e7","e8","e9")),graphItem=TRUE)

</code></pre>

<hr>
<h2 id='psy'>Various procedures used in psychometry</h2><span id='topic+psy'></span>

<h3>Description</h3>

<p>Kappa, Intra class correlation coefficient, Cronbach alpha, Scree plot,
Multitraits multimethods, Spherical representation of a correlation matrix</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> psy</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2009-12-23</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> free</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Bruno Falissard &lt;falissard_b@wanadoo.fr&gt;</p>


<h3>References</h3>

<p>Falissard B, A spherical representation of a correlation matrix, Journal of Classification (1996), 13:2, 267-280.<br />
Horn, JL (1965) A Rationale and Test for the Number of Factors in Factor Analysis, Psychometrika, 30, 179-185.<br />
Mammals: Ecological and Constitutional Correlates, by Allison, T. and Cicchetti, D. (1976)
Science, November 12, vol. 194, pp.732-734<br />
Jouvent, R et al 1988 La clinique polydimensionnelle de humeur depressive.
Nouvelle version echelle EHD  : Polydimensional rating scale of depressive mood.
Psychiatrie et Psychobiologie.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sleep)
sphpca(sleep[,c(2:5,7:11)])
data(expsy)
scree.plot(expsy[,1:10],simu=20,use="P")
data(ehd)
par(mfrow=c(1,5))
mtmm(ehd,list(c("e15","e18","e19","e20"),c("e4","e5","e6","e14","e17"),c("e11","e13","e16")
,c("e1","e10","e12"),c("e2","e3","e7","e8","e9")))
</code></pre>

<hr>
<h2 id='scree.plot'>Screeplot of eigenvalues, simulated data are available</h2><span id='topic+scree.plot'></span>

<h3>Description</h3>

<p>Graphical representation of the eigenvalues of a correlation/covariance matrix.
Usefull to determine the dimensional structure of a set of variables.
Simulation are proposed to help the interpretation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scree.plot(namefile, title = "Scree Plot", type = "R", use = "complete.obs", simu = "F")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scree.plot_+3A_namefile">namefile</code></td>
<td>
<p>dataset</p>
</td></tr>
<tr><td><code id="scree.plot_+3A_title">title</code></td>
<td>
<p>Title</p>
</td></tr>
<tr><td><code id="scree.plot_+3A_type">type</code></td>
<td>
<p> type=&quot;R&quot; to obtain the eigenvalues of the correlation matrix of dataset, type=&quot;V&quot; for the covariance matrix, type=&quot;M&quot; if the input data is directly the matrix, type=&quot;E&quot; if the input data are directly the eigenvalues</p>
</td></tr>
<tr><td><code id="scree.plot_+3A_use">use</code></td>
<td>
<p>omit missing values by default, use=&quot;P&quot; to analyse the pairwise correlation/covariance matrix</p>
</td></tr>
<tr><td><code id="scree.plot_+3A_simu">simu</code></td>
<td>
<p>simu=p to add p screeplots of simulated random normal data (same number of patients and variables as in the original data set, same pattern of missing data if use=&quot;P&quot;)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simulations lead sometimes to underestimate the actual number of dimensions (as opposed to Kayser rule: eigen values superior to 1). Basically, simu=20 is enough.
</p>


<h3>Value</h3>

<p>a plot
</p>


<h3>Author(s)</h3>

<p>Bruno Falissard</p>


<h3>References</h3>

<p>Horn, JL (1965) A Rationale and Test for the Number of Factors in Factor Analysis, Psychometrika, 30, 179-185.
Cattell, RB (1966) The scree test for the number of factors. Multivariate Behavioral Research, 1, 245-276.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(expsy)
scree.plot(expsy[,1:10],simu=20,use="P") #no obvious structure with such a small sample
</code></pre>

<hr>
<h2 id='sleep'> Ecological and Constitutional Data in Mammals </h2><span id='topic+sleep'></span>

<h3>Description</h3>

<p>Data from which conclusions were drawn in the article
Mammals: Ecological and Constitutional Correlates,
by Allison, T. and Cicchetti, D. (1976)
Science, November 12, vol. 194, pp.732-734
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sleep)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Species</dt><dd><p>a factor with levels</p>
</dd>
<dt>Body.weight</dt><dd><p>a numeric vector, body weight in kg</p>
</dd>
<dt>Brain.weight</dt><dd><p>a numeric vector, Brain weight in g</p>
</dd>
<dt>Slow.wave.sleep</dt><dd><p>a numeric vector, nondreaming sleep (hrs/day)</p>
</dd>
<dt>Paradoxical.sleep</dt><dd><p>a numeric vector, dreaming sleep (hrs/day)</p>
</dd>
<dt>Total.sleep</dt><dd><p>a numeric vector, nondreaming + &quot;dreaming&quot; (hrs/day)</p>
</dd>
<dt>Maximum.life.span</dt><dd><p>a numeric vector (in years)</p>
</dd>
<dt>Gestation.time</dt><dd><p>a numeric vector (in days)</p>
</dd>
<dt>Predation</dt><dd><p>a numeric vector, Predation index (1 min - 5 max)</p>
</dd>
<dt>Sleep.exposure</dt><dd><p>a numeric vector, Sleep exposure index (1 min - 5 max)</p>
</dd>
<dt>Danger</dt><dd><p>a numeric vector, Overall danger index (1 min - 5 max)</p>
</dd>
</dl>



<h3>Source</h3>

<p>http://lib.stat.cmu.edu/datasets/sleep
</p>


<h3>References</h3>

<p>Mammals: Ecological and Constitutional Correlates, by Allison, T. and Cicchetti, D. (1976)
Science, November 12, vol. 194, pp.732-734
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sleep)
str(sleep)
</code></pre>

<hr>
<h2 id='sphpca'>Spherical Representation of a Correlation Matrix</h2><span id='topic+sphpca'></span>

<h3>Description</h3>

<p>Graphical representation of a correlation matrix, similar to principal component analysis (PCA) but the mapping is on a sphere. The information is close to a 3d PCA, the picture is however easier to interpret since the variables are in fact on a 2d map.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sphpca(datafile, h=0, v=0, f=0, cx=0.75, nbsphere=2, back=FALSE, input="data",
       method="approx", maxiter=500, output=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sphpca_+3A_datafile">datafile</code></td>
<td>
<p>name of datafile</p>
</td></tr>
<tr><td><code id="sphpca_+3A_h">h</code></td>
<td>
<p>rotation of the sphere on a horizontal plane (in degres)</p>
</td></tr>
<tr><td><code id="sphpca_+3A_v">v</code></td>
<td>
<p>rotation of the sphere on a vertical plane (in degres)</p>
</td></tr>
<tr><td><code id="sphpca_+3A_f">f</code></td>
<td>
<p>rotation of the sphere on a frontal plane (in degres)</p>
</td></tr>
<tr><td><code id="sphpca_+3A_cx">cx</code></td>
<td>
<p>size of the lettering (0.75 by default, 1 for bigger letters, 0.5 for smaller)</p>
</td></tr>
<tr><td><code id="sphpca_+3A_nbsphere">nbsphere</code></td>
<td>
<p>two by default: front and back</p>
</td></tr>
<tr><td><code id="sphpca_+3A_back">back</code></td>
<td>
<p>&quot;FALSE&quot; by default: the back sphere is not seen through</p>
</td></tr>
<tr><td><code id="sphpca_+3A_input">input</code></td>
<td>
<p>&quot;data&quot; by default: raw data are analysed, if not &quot;data&quot;: correlation matrix is expected</p>
</td></tr>
<tr><td><code id="sphpca_+3A_method">method</code></td>
<td>
<p>&quot;approx&quot; by default: the estimation is based on a principal component analysis approximation. If &quot;exact&quot; the &quot;approx&quot; estimation is optimized (may be computationaly consumming). if &quot;rscal&quot; a multidimensional scaling approach is used: distances between points on the sphere are optimized so that they represent at best the original correlations. The scaling that is used leads to angles on the sphere proportional to correlation between variables</p>
</td></tr>
<tr><td><code id="sphpca_+3A_maxiter">maxiter</code></td>
<td>
<p>maximum number of iterations in the optim process</p>
</td></tr>
<tr><td><code id="sphpca_+3A_output">output</code></td>
<td>
<p>FALSE by default: if TRUE and method=&quot;rscal&quot; numerical results are proposed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There is an isophormism between a correlation matrix and points on the unit hypersphere of Rn. It can be shown that a 3d spherical representation of a correlation matrix is statistically and cognitively interesting (see reference).
The default option method=&quot;approx&quot; is based on a principal components approximation (see reference). It is fast and gives rather good results.
If method=&quot;exact&quot; the representation is sligthly improved in terms of fit (the sphere minimizes the sum of squared distances between the original variables on the hypersphere and their projections on the sphere).
The option method=&quot;rscal&quot; optimizes the representation of correlations between variables with distances between points (in a least squares sense). For convenience, the scaling of points on the sphere is chosen so that angles between points are linearly related to correlations between variables (this is not the case on the hypersphere were d=[2*(1-r)]^0.5).
For method=&quot;exact&quot; or method=&quot;rscal&quot; computations may be rather lengthy (and not sensible for more than 20-40 variables).
The sphere may be rotated to help in visualising most of variables on a same side (front for example).
By default, the back of the sphere (right plot) is not seen showing through.
</p>


<h3>Value</h3>

<p>A plot.
If method=&quot;rscal&quot; and output=TRUE, a list with :
</p>
<table role = "presentation">
<tr><td><code>$stress.before.optim</code></td>
<td>
<p>Stress before optimization. The stress is equal to the sum of squares of differences between distances on the 3d sphere and distances on the hypersphere.</p>
</td></tr>
<tr><td><code>$stress.after.optim</code></td>
<td>
<p>Stress after optimization.</p>
</td></tr>
<tr><td><code>$convergence</code></td>
<td>
<p>If 0, convergence is OK. If not, maxiter may be increased.</p>
</td></tr>
<tr><td><code>$correlations</code></td>
<td>
<p>Correlation matrix of variables (Pearson).</p>
</td></tr>
<tr><td><code>$residuals</code></td>
<td>
<p>Differences between observed correlations (hypersphere) and correlations estimated from points on the 3d sphere.</p>
</td></tr>
<tr><td><code>$mean.abs.resid</code></td>
<td>
<p>Mean of absolute values of residuals.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bruno Falissard</p>


<h3>References</h3>

<p>Falissard B, A spherical representation of a correlation matrix, Journal of Classification (1996), 13:2, 267-280.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sleep)
sphpca(sleep[,c(2:5,7:11)])
## spherical representation of ecological and constitutional correlates in mammals

sphpca(sleep[,c(2:5,7:11)],method="rscal",output=TRUE)
## idem, but optimizes the representation of correlations between variables with distances
## between points

corsleep &lt;- as.data.frame(cor(sleep[,c(2:5,7:11)],use="pairwise.complete.obs"))
sphpca(corsleep,input="Cor")
sphpca(corsleep,method="rscal",input="Cor")
## when missing data are numerous, the representation of a pairwise correlation
## matrix may be preferred (even if mathematical properties are not so good...)

sphpca(corsleep,method="rscal",input="Cor",h=180,f=180,nbsphere=1,back=TRUE)
## other option of presentation

##
# library(polycor)
# sleep$Predation &lt;- as.ordered(sleep$Predation)
# sleep$Sleep.exposure &lt;- as.ordered(sleep$Sleep.exposure)
# sleep$Danger &lt;- as.ordered(sleep$Danger)
# corsleeph &lt;- as.data.frame(hetcor(sleep[,c(2:5,7:11)])$correlations)
# sphpca(corsleeph,input="Cor",f=180)
# sphpca(corsleeph,method="rscal",input="Cor",f=180)
## --&gt; Correlations between discrete variables may appear shoking to some statisticians (?)
## --&gt; Representation of polychoric/polyserial correlations could be prefered in this situation
</code></pre>

<hr>
<h2 id='wkappa'>weighted Kappa for 2 raters</h2><span id='topic+wkappa'></span>

<h3>Description</h3>

<p>Computes a weighted Kappa for agreement in the case of 2 raters. The diagnosis (the object of the rating) may have k possible ordered values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wkappa(r,weights="squared")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wkappa_+3A_r">r</code></td>
<td>
<p>n*2 matrix or dataframe, n subjects and 2 raters</p>
</td></tr>
<tr><td><code id="wkappa_+3A_weights">weights</code></td>
<td>
<p>weights=&quot;squared&quot; to obtain squared weights. If not, absolute weights are computed (see details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Diagnoses have to be coded by numbers (ordered naturally).
For weigths=&quot;squared&quot;, weights are related to squared differences between rows and columns indices (in this situation wkappa is close to an icc).
For weights!=&quot;squared&quot;, weights are related to absolute values of differences between rows and columns indices.
The function is supposed to deal with the case where the two raters have not exactly the same scope of rating.
Missing value are omitted.
</p>


<h3>Value</h3>

<p>A list with :
</p>
<table role = "presentation">
<tr><td><code>$table</code></td>
<td>
<p>the 2*k table of raw data (first rater in rows, second rater in columns)</p>
</td></tr>
<tr><td><code>$weights</code></td>
<td>
<p>&quot;squared&quot; or &quot;absolute&quot;</p>
</td></tr>
<tr><td><code>$kappa</code></td>
<td>
<p>Weighted Kappa</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bruno Falissard</p>


<h3>References</h3>

<p>Cohen, J. Weighted kappa: nominal scale agreement with provision for scaled disagreement or partial credit. Psychological Bulletin 70 (1968): 213-220.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(expsy)
wkappa(expsy[,c(11,13)])        # weighted kappa (squared weights)

#to obtain a 95%confidence interval:
#library(boot)
#wkappa.boot &lt;- function(data,x) {wkappa(data[x,])[[3]]}
#res &lt;- boot(expsy[,c(11,13)],wkappa.boot,1000)
#quantile(res$t,c(0.025,0.975))  # two-sided bootstrapped confidence interval of weighted kappa
#boot.ci(res,type="bca")         # adjusted bootstrap percentile (BCa) confidence interval (better)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
