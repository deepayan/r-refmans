<!DOCTYPE html><html><head><title>Help for package chantrics</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {chantrics}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adj_loglik'><p>Loglikelihood adjustments for fitted models</p></a></li>
<li><a href='#alrtest'><p>Adjusted Likelihood Ratio Test of Nested Models</p></a></li>
<li><a href='#anova.chantrics'><p>ANOVA tables: compare nested models</p></a></li>
<li><a href='#chantrics'><p>chantrics: Loglikelihood Adjustments for Econometric Models</p></a></li>
<li><a href='#glm'><p>Loglikelihood adjustments for glm fits</p></a></li>
<li><a href='#hurdle'><p>Loglikelihood adjustments for pscl::hurdle fits</p></a></li>
<li><a href='#internal'><p>chandwich internal functions</p></a></li>
<li><a href='#logLik_vec'><p>Evaluate loglikelihood contributions from specific observations</p></a></li>
<li><a href='#predict.chantrics'><p>Predict Method for chantrics fits</p></a></li>
<li><a href='#residuals.chantrics'><p>Residuals of chantrics model fits</p></a></li>
<li><a href='#update.chantrics'><p>Update, re-fit and re-adjust a Model Call</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Loglikelihood Adjustments for Econometric Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-09-28</td>
</tr>
<tr>
<td>Description:</td>
<td>Adjusts the loglikelihood of common econometric models for
    clustered data based on the estimation process suggested in 
    Chandler and Bate (2007) &lt;<a href="https://doi.org/10.1093%2Fbiomet%2Fasm015">doi:10.1093/biomet/asm015</a>&gt;, using the 'chandwich' 
    package <a href="https://cran.r-project.org/package=chandwich">https://cran.r-project.org/package=chandwich</a>, and provides 
    convenience functions for inference on the adjusted models. </td>
</tr>
<tr>
<td>Imports:</td>
<td>AER, chandwich, graphics, sandwich, stats, utils, methods,
lmtest, rlang, progress, purrr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://chantrics.theobruckbauer.eu">https://chantrics.theobruckbauer.eu</a>,
<a href="https://github.com/tbruckbauer/chantrics">https://github.com/tbruckbauer/chantrics</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/tbruckbauer/chantrics/issues">https://github.com/tbruckbauer/chantrics/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat, lax, covr, MASS, pscl</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-09-28 14:04:03 UTC; theobruckbauer</td>
</tr>
<tr>
<td>Author:</td>
<td>Theo Bruckbauer <a href="https://orcid.org/0000-0002-4764-9953"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Theo Bruckbauer &lt;chantrics@theobruckbauer.eu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-09-29 08:20:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='adj_loglik'>Loglikelihood adjustments for fitted models</h2><span id='topic+adj_loglik'></span><span id='topic+coef.chantrics'></span><span id='topic+confint.chantrics'></span><span id='topic+coeftest.chantrics'></span><span id='topic+conf_region.chantrics'></span><span id='topic+conf_intervals.chantrics'></span><span id='topic+logLik.chantrics'></span><span id='topic+plot.chantrics'></span><span id='topic+print.chantrics'></span><span id='topic+summary.chantrics'></span><span id='topic+vcov.chantrics'></span>

<h3>Description</h3>

<p>This function adjusts the loglikelihood of fitted model objects based on
Chandler and Bate (2007). It is a
generic function for different types of models, which are listed in
<strong>Supported models</strong>. This section also contains links to function-specific
help pages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adj_loglik(x, cluster = NULL, use_vcov = TRUE, use_mle = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adj_loglik_+3A_x">x</code></td>
<td>
<p>A supported fitted model object, see <strong>Supported models</strong></p>
</td></tr>
<tr><td><code id="adj_loglik_+3A_cluster">cluster</code></td>
<td>
<p>A vector or factor indicating the cluster the corresponding
loglikelihood contribution belongs to. It is required to have the same
length as the vector returned by <code><a href="#topic+logLik_vec">logLik_vec()</a></code>. If <code>cluster</code> is not
supplied or <code>NULL</code>, then it is assumed that each observation forms its own
cluster.</p>
</td></tr>
<tr><td><code id="adj_loglik_+3A_use_vcov">use_vcov</code></td>
<td>
<p>A logical scalar. By default, the <code><a href="stats.html#topic+vcov">vcov()</a></code> method for <code>x</code> is
used to estimate the Hessian of the independence loglikelihood, if the
function exists. Otherwise, or if <code>use_vcov = FALSE</code>, <code>H</code> is estimated
using <code><a href="stats.html#topic+optim">stats::optimHess()</a></code> inside <code><a href="chandwich.html#topic+adjust_loglik">chandwich::adjust_loglik()</a></code>.</p>
</td></tr>
<tr><td><code id="adj_loglik_+3A_use_mle">use_mle</code></td>
<td>
<p>A logical scalar. By default, the MLE from <code>x</code> is taken as
given, and is not reestimated. By setting <code>use_mle</code> to <code>FALSE</code>, the parameters
are reestimated in the function <code><a href="chandwich.html#topic+adjust_loglik">chandwich::adjust_loglik()</a></code> using
<code><a href="stats.html#topic+optim">stats::optim()</a></code>.This feature is currently for development purposes only,
may return misleading/false results and may be removed without notice.</p>
</td></tr>
<tr><td><code id="adj_loglik_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code><a href="sandwich.html#topic+vcovCL">sandwich::meatCL()</a></code> if
<code>cluster</code> is defined, if <code>cluster = NULL</code>, they are passed into
<code><a href="sandwich.html#topic+meat">sandwich::meat()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>use_vcov = TRUE</code>, the current default, the function will test
whether a <code>vcov</code> S3 method exists for <code>x</code>, and will take the
variance-covariance matrix from there. Otherwise, or if <code>use_vcov = FALSE</code>
the variance-covariance matrix of the MLE is estimated inside
<code><a href="chandwich.html#topic+adjust_loglik">chandwich::adjust_loglik()</a></code> using <code><a href="stats.html#topic+optim">stats::optimHess()</a></code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"chantrics"</code> inheriting from class <code>"chandwich"</code>.
See the documentation provided with <code><a href="chandwich.html#topic+adjust_loglik">chandwich::adjust_loglik()</a></code>.
</p>


<h3>Supported models</h3>


<ul>
<li> <p><a href="#topic+glm">glm</a>
</p>
</li>
<li> <p><a href="#topic+glm.nb">glm.nb</a>
</p>
</li></ul>



<h3>Available methods</h3>

<p><code>"chantrics"</code> objects have the following methods available to them:
</p>

<ul>
<li> <p><code><a href="stats.html#topic+AIC">AIC</a></code>
</p>
</li>
<li> <p><code><a href="#topic+anova.chantrics">anova</a></code>
</p>
</li>
<li> <p><code><a href="#topic+alrtest">alrtest</a></code> - Adjusted Likelihood ratio tests
</p>
</li>
<li> <p><code><a href="chandwich.html#topic+coef.chandwich">coef</a></code>
</p>
</li>
<li> <p><code><a href="lmtest.html#topic+coeftest">lmtest::coeftest</a></code> - \(z\) tests for all
coefficients
</p>
</li>
<li> <p><code><a href="chandwich.html#topic+confint.chandwich">confint</a></code>
and <code><a href="chandwich.html#topic+plot.confint">plot.confint</a></code> - confidence intervals for
all coefficients, and diagnostics plots for <code>confint()</code>.
</p>
</li>
<li> <p><code><a href="chandwich.html#topic+conf_intervals">conf_intervals</a></code> - enhanced confidence
interval reports
</p>
</li>
<li> <p><code><a href="chandwich.html#topic+conf_region">conf_region</a></code> - two-dimensional confidence
regions
</p>
</li>
<li> <p><code><a href="stats.html#topic+df.residual">df.residual</a></code>
</p>
</li>
<li> <p><code><a href="stats.html#topic+fitted.values">fitted</a></code>
</p>
</li>
<li> <p><code><a href="chandwich.html#topic+logLik.chandwich">logLik</a></code>
</p>
</li>
<li> <p><code><a href="#topic+logLik_vec">logLik_vec</a></code>
</p>
</li>
<li> <p><code><a href="stats.html#topic+nobs">nobs</a></code>
</p>
</li>
<li> <p><code><a href="chandwich.html#topic+plot.chandwich">plot</a></code>
</p>
</li>
<li> <p><code><a href="stats.html#topic+predict">predict</a></code>
</p>
</li>
<li> <p><code><a href="chandwich.html#topic+print.chandwich">print</a></code>
</p>
</li>
<li> <p><code><a href="#topic+residuals.chantrics">residuals</a></code>
</p>
</li>
<li> <p><code><a href="chandwich.html#topic+summary.chandwich">summary</a></code>
</p>
</li>
<li> <p><code><a href="stats.html#topic+terms">terms</a></code>
</p>
</li>
<li> <p><code><a href="chandwich.html#topic+vcov.chandwich">vcov</a></code>
</p>
</li></ul>



<h3>Examples</h3>

<p>See the model-specific pages in the <em>supported models</em>
section.
</p>


<h3>References</h3>

<p>R. E. Chandler and S. Bate, Inference for clustered data using the
independence loglikelihood, Biometrika, 94 (2007), pp. 167–183.
doi: <a href="https://doi.org/10.1093/biomet/asm015">10.1093/biomet/asm015</a>.
</p>


<h3>See Also</h3>

<p><code><a href="lax.html#topic+alogLik">lax::alogLik()</a></code> supports adjustment for user-supplied objects.
</p>

<hr>
<h2 id='alrtest'>Adjusted Likelihood Ratio Test of Nested Models</h2><span id='topic+alrtest'></span>

<h3>Description</h3>

<p><code>alrtest</code> is a helper function to simulate the functions <code><a href="lmtest.html#topic+waldtest">lmtest::waldtest()</a></code>
and <code><a href="lmtest.html#topic+lrtest">lmtest::lrtest()</a></code> for adjusted <code>chantrics</code> objects. The method can be
employed to compare nested models (see details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alrtest(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alrtest_+3A_object">object</code></td>
<td>
<p>a <code>chantrics</code> object as returned from <code><a href="#topic+adj_loglik">adj_loglik()</a></code>.</p>
</td></tr>
<tr><td><code id="alrtest_+3A_...">...</code></td>
<td>
<p>further object specifications (see details), as well as named
parameters that will be passed to <code><a href="chandwich.html#topic+compare_models">chandwich::compare_models()</a></code>. The type
of adjustment, out of <code>"vertical"</code>, <code>"cholesky"</code>, <code>"spectral"</code>, <code>"none"</code>,
as specified in the parameter <code>type</code>, can also be specified here.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a helper function that creates an interface to
<code><a href="#topic+anova.chantrics">anova.chantrics()</a></code> that is similar to <code><a href="lmtest.html#topic+waldtest">lmtest::waldtest()</a></code> and
<code><a href="lmtest.html#topic+lrtest">lmtest::lrtest()</a></code>.
</p>
<p>The standard method is to compare the fitted model object <code>object</code> with the
models in <code>...</code>. Instead of passing the fitted models into <code>...</code>, other
specifications are possible. Note that the types of specifications cannot be
mixed, except between numerics/characters. The type of the second object
supplied determines the algorithm used.
</p>

<ul>
<li> <p><strong><code>"chantrics"</code> objects</strong>: When
supplying two or more <code>"chantrics"</code> objects, they will be sorted as in
<code><a href="#topic+anova.chantrics">anova.chantrics()</a></code>. Then, the ALRTS will be computed consecutively between
the two neighbouring models. Note that all models must be nested. For
details refer to <code><a href="#topic+anova.chantrics">anova.chantrics()</a></code>.
</p>
</li>
<li> <p><strong><code>"numeric"</code></strong>: If the second
object is <code>"numeric"</code> or <code>"character"</code>, then <code>"numeric"</code> objects
corresponding element in <code>attr(terms(object1), "term.labels")</code> will be
turned into their corresponding <code>"character"</code> element and will be handled
as in <code>"character"</code> below.
</p>
</li>
<li> <p><strong><code>"character"</code></strong>: If the second object is
<code>"numeric"</code> or <code>"character"</code>, then the <code>"character"</code> objects are
consecutively included in an update formula like <code>update(object1, . ~ . -   object2)</code>
</p>
</li>
<li> <p><strong><code>"formula"</code></strong>: If the second object is a <code>"formula"</code>, then
the second model will be computed as <code>update(object1, object2)</code>.
</p>
</li></ul>

<p>Then, the adjusted likelihood ratio test statistic (ALRTS), as described in
Section 3.5 of Chandler and Bate
(2007), is computed by
<code><a href="#topic+anova.chantrics">anova.chantrics()</a></code>.
</p>
<p>If a single unnamed object is passed in <code>...</code>, sequential ANOVA is
performed on <code>object</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"anova"</code> inheriting from class <code>"data.frame"</code>.
The columns are as follows: </p>
<table>
<tr><td><code>Resid.df</code></td>
<td>
<p>The residual number of degrees
of freedom in the model.</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>The increase in residual degrees of
freedom with respect to the model in the row above.</p>
</td></tr> <tr><td><code>ALRTS</code></td>
<td>
<p>The
adjusted likelihood ratio statistic.</p>
</td></tr> <tr><td><code>Pr(&gt;ALRTS)</code></td>
<td>
<p>The p-value of the
test that the model above is a &quot;significantly better&quot; model as the one in
the current row.</p>
</td></tr>
</table>


<h3>References</h3>

<p>R. E. Chandler and S. Bate, Inference for clustered data using the
independence loglikelihood, Biometrika, 94 (2007), pp.
167–183. doi: <a href="https://doi.org/10.1093/biomet/asm015">10.1093/biomet/asm015</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+anova.chantrics">anova.chantrics()</a></code> for the implementation of the computations of
the test statistics.
</p>
<p><code><a href="lmtest.html#topic+waldtest">lmtest::waldtest()</a></code> and <code><a href="lmtest.html#topic+lrtest">lmtest::lrtest()</a></code> for syntax.
</p>

<hr>
<h2 id='anova.chantrics'>ANOVA tables: compare nested models</h2><span id='topic+anova.chantrics'></span>

<h3>Description</h3>

<p><code>anova</code> method for <code>chantrics</code> objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'chantrics'
anova(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anova.chantrics_+3A_object">object</code></td>
<td>
<p>Object of class <code>chantrics</code>, as returned by
<code><a href="#topic+adj_loglik">adj_loglik()</a></code>.</p>
</td></tr>
<tr><td><code id="anova.chantrics_+3A_...">...</code></td>
<td>
<p>Further objects of class <code>chantrics</code>, as returned by
<code><a href="#topic+adj_loglik">adj_loglik()</a></code>, and named parameters that should be passed to
<code><a href="chandwich.html#topic+compare_models">chandwich::compare_models()</a></code>. The type of adjustment, out of
<code>"vertical"</code>, <code>"cholesky"</code>, <code>"spectral"</code>, <code>"none"</code>, as
specified in the parameter <code>type</code>, can also be specified here.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Create an analysis of adjusted deviance table for one object (sequential), or
two or more nested models that have been adjusted using the
<code><a href="#topic+adj_loglik">adj_loglik()</a></code> method. It uses the adjusted likelihood ratio test
statistic (ALRTS), as described in Section 3.5 of
Chandler and Bate (2007).
</p>
<p>Each line represents the model as given above the table, with each
line (except for the first line) showing the residual degrees of freedom of
that model, the change in degrees of freedom, the ALRTS and the
associated p-value in comparison to the model in the line above.
</p>
<p>When a single model is specified, the function returns a sequential
analysis of deviance table, where, iteratively, one term is being removed
from the right of the full formula. This process is continued until the
&quot;intercept only&quot; model is left. The row names are the names of the dropped
term in comparison to the model in the line above.
</p>
<p>If more than one model is specified, the function sorts the models by their
number of variables as returned by <code><a href="#topic+adj_loglik">adj_loglik()</a></code> in
<code>attr(x, "p_current")</code>.
</p>
<p>Details of the ALRT can be found in <code><a href="chandwich.html#topic+compare_models">chandwich::compare_models()</a></code> and in
Chandler and Bate (2007).
</p>


<h3>Value</h3>

<p>An object of class <code>"anova"</code> inheriting from class <code>"data.frame"</code>.
The columns are as follows: </p>
<table>
<tr><td><code>Resid.df</code></td>
<td>
<p>The residual number of degrees
of freedom in the model.</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>The increase in residual degrees of
freedom with respect to the model in the row above.</p>
</td></tr> <tr><td><code>ALRTS</code></td>
<td>
<p>The
adjusted likelihood ratio statistic.</p>
</td></tr> <tr><td><code>Pr(&gt;ALRTS)</code></td>
<td>
<p>The p-value of the
test that the model above is a &quot;significantly better&quot; model as the one in
the current row.</p>
</td></tr>
</table>


<h3>References</h3>

<p>R. E. Chandler and S. Bate, Inference for clustered data using the
independence loglikelihood, Biometrika, 94 (2007), pp.
167–183. doi: <a href="https://doi.org/10.1093/biomet/asm015">10.1093/biomet/asm015</a>.
</p>


<h3>See Also</h3>

<p><a href="chandwich.html#topic+compare_models">chandwich::compare_models</a>: implementation of the comparison
mechanism
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# from Introducing Chandwich.
set.seed(123)
x &lt;- rnorm(250)
y &lt;- rnbinom(250, mu = exp(1 + x), size = 1)
fm_pois &lt;- glm(y ~ x + I(x^2), family = poisson)
fm_pois_adj &lt;- adj_loglik(fm_pois)
fm_pois_small_adj &lt;- update(fm_pois_adj, formula = . ~ . - I(x^2))
fm_pois_smallest_adj &lt;- update(fm_pois_adj, formula = . ~ 1)

anova(fm_pois_adj, fm_pois_small_adj, fm_pois_smallest_adj)
# use different types of adjustment with type, default is "vertical"
anova(fm_pois_adj, fm_pois_small_adj, fm_pois_smallest_adj, type = "cholesky")

# sequential anova
anova(fm_pois_adj)
</code></pre>

<hr>
<h2 id='chantrics'>chantrics: Loglikelihood Adjustments for Econometric Models</h2><span id='topic+chantrics'></span>

<h3>Description</h3>

<p><code>chantrics</code> adjusts the loglikelihood of common econometric models for
clustered data based on the estimation process suggested in
Chandler and Bate (2007),
using the <a href="https://cran.r-project.org/package=chandwich">chandwich</a> package,
and provides convenience functions for inference on the adjusted models.
<code>adj_loglik()</code> adjusts the model's parameter covariance matrix to
incorporate clustered data, and can mitigate model misspecification by
wrapping <code>chandwich::adjust_loglik</code> for the supported models.
</p>


<h3>Details</h3>

<p>The returned model of class <code>chantrics</code> can be plugged into standard model
evaluation and model comparison methods, for example, <code>summary()</code>, <code>confint()</code>
and <code>anova()</code>, and a hypothesis test framework provided by <code>alrtest()</code>.
</p>
<p>See <code>vignette("chantrics-vignette", package = "chantrics")</code> for an
overview of the package.
</p>


<h3>References</h3>

<p>R. E. Chandler and S. Bate, Inference for clustered data using the
independence loglikelihood, Biometrika, 94 (2007), pp.
167–183. doi: <a href="https://doi.org/10.1093/biomet/asm015">10.1093/biomet/asm015</a>.
</p>

<hr>
<h2 id='glm'>Loglikelihood adjustments for glm fits</h2><span id='topic+glm'></span><span id='topic+glm.nb'></span>

<h3>Description</h3>

<p>In a generalised linear model (glm), the user can choose between a range of
distributions of a response <code class="reqn">y</code>, and can allow for non-linear relations
between the mean outcome for a particular combination of covariates <code class="reqn">x</code>,
<code class="reqn">E(y_i\mid x_i)=\mu_i</code>, and the linear predictor,
<code class="reqn">\eta_i=x_i^T\beta</code>, which is the link function <code class="reqn">g(\mu_i)=\eta_i</code>.
it is required to be monotonic. (For a quick introduction, see
Kleiber and Zeileis (2008, Ch. 5.1), for more complete coverage of the
topic, see, for example, Davison (2003, Ch. 10.3))
</p>


<h3>Details</h3>

<p>For more usage examples and more information on <code>glm</code> models, see the
<em>Introducing <code>chantrics</code></em> vignette by running
<code>vignette("chantrics-vignette", package = "chantrics")</code>
</p>


<h3>Supported families (within each family, any link function should work)</h3>


<ul>
<li> <p><code>gaussian</code>
</p>
</li>
<li> <p><code>poisson</code>
</p>
</li>
<li> <p><code>binomial</code>
</p>
</li>
<li> <p><code>MASS::negative.binomial</code>
</p>
</li></ul>

<p>Also works for <code><a href="MASS.html#topic+glm.nb">MASS::glm.nb()</a></code>, note that the standard errors of the theta
are not adjusted.
</p>


<h3>References</h3>

<p>Davison, A. C. 2003. Statistical Models. Cambridge Series on
Statistical and Probabilistic Mathematics 11. Cambridge University Press,
Cambridge.
</p>
<p>Kleiber, Christian, and Achim
Zeileis. 2008. Applied Econometrics with R. Edited by Robert Gentleman,
Kurt Hornik, and Giovanni Parmigiani. Use r! New York: Springer-Verlag.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># binomial example from Applied Econometrics in R, Kleiber/Zeileis (2008)
# ==  probit  ==
data("SwissLabor", package = "AER")
swiss_probit &lt;- glm(participation ~ . + I(age^2),
  data = SwissLabor,
  family = binomial(link = "probit")
)
summary(swiss_probit)
swiss_probit_adj &lt;- adj_loglik(swiss_probit)
summary(swiss_probit_adj)

# == logit ==
swiss_logit &lt;- glm(participation ~ . + I(age^2),
  data = SwissLabor,
  family = binomial(link = "logit")
)
summary(swiss_logit)
swiss_logit_adj &lt;- adj_loglik(swiss_logit)
summary(swiss_logit_adj)
</code></pre>

<hr>
<h2 id='hurdle'>Loglikelihood adjustments for pscl::hurdle fits</h2><span id='topic+hurdle'></span>

<h3>Description</h3>

<p>NOTE: <em>Hurdle models are currently not supported.</em>
</p>


<h3>Details</h3>

<p>Adjust the loglikelihood and the standard errors of a fitted <code><a href="pscl.html#topic+hurdle">pscl::hurdle()</a></code>
model.
</p>
<p>Note that the <code><a href="pscl.html#topic+hurdle">pscl::hurdle()</a></code> model has to be run with the option <code>x = TRUE</code>
in order for the adjustment to execute properly. The functions
<code><a href="#topic+residuals.chantrics">residuals.chantrics()</a></code> and <code><a href="stats.html#topic+fitted">fitted.chantrics()</a></code> are currently
disabled for <code>hurdle</code> models. Additionally, sequential <code><a href="#topic+anova.chantrics">anova.chantrics()</a></code>
are not available.
</p>


<h3>Supported families</h3>

<p>Within each family, any link function should work.
</p>

<ul>
<li> <p><code>geometric</code>
</p>
</li>
<li> <p><code>poisson</code>
</p>
</li>
<li> <p><code>negbin</code>
</p>
</li>
<li> <p><code>binomial</code> (for the zero mass distribution only)
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># hurdle model from AER, pg. 139-140
library(pscl)
data("RecreationDemand", package = "AER")
rd_hurdle &lt;- hurdle(trips ~ . | quality + income,
  data = RecreationDemand,
  dist = "negbin", x = TRUE
)
summary(rd_hurdle)

# adjust model
# adj_loglik(rd_hurdle)
</code></pre>

<hr>
<h2 id='internal'>chandwich internal functions</h2><span id='topic+internal'></span><span id='topic+is.error'></span><span id='topic+get_unadj_object'></span><span id='topic+raise_yield_error'></span><span id='topic+get_response_from_formula'></span><span id='topic+get_response_from_model'></span><span id='topic+get_design_matrix_from_model'></span><span id='topic+abort_not_chantrics'></span><span id='topic+get_variable_str_from_chantrics'></span><span id='topic+get_formula_str_from_chantrics'></span><span id='topic+get_additional_args_from_chantrics_call'></span><span id='topic+get_named'></span><span id='topic+get_unnamed'></span>

<h3>Description</h3>

<p>Internal functions: These are not to be exported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.error(x)

get_unadj_object(object)

raise_yield_error(model = "model", what = "property", try_this = NULL)

get_response_from_formula(x)

get_response_from_model(object)

get_design_matrix_from_model(object, type = NULL)

abort_not_chantrics(x)

get_variable_str_from_chantrics(x)

get_formula_str_from_chantrics(x)

get_additional_args_from_chantrics_call(x)

get_named(x)

get_unnamed(x)
</code></pre>

<hr>
<h2 id='logLik_vec'>Evaluate loglikelihood contributions from specific observations</h2><span id='topic+logLik_vec'></span>

<h3>Description</h3>

<p>Generic function for calculating the loglikelihood contributions from
individual observations for a fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logLik_vec(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik_vec_+3A_object">object</code></td>
<td>
<p>A fitted model object.</p>
</td></tr>
<tr><td><code id="logLik_vec_+3A_...">...</code></td>
<td>
<p>Further arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"logLik_vec"</code>, which is a numeric vector of length
<code>nobs(object)</code> (i.e. the number of observations in <code>object</code>) of the
loglikelihood of each observation. Additionally, it contains the
attributes <code>df</code> (model degrees of freedom) and <code>nobs</code> (number of
observations).
</p>
<p>The methods <code><a href="stats.html#topic+logLik">stats::logLik()</a></code>, and <code><a href="stats.html#topic+nobs">stats::nobs()</a></code> are available.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+logLik">stats::logLik()</a></code>
</p>

<hr>
<h2 id='predict.chantrics'>Predict Method for chantrics fits</h2><span id='topic+predict.chantrics'></span>

<h3>Description</h3>

<p>Obtains predictions from chantrics objects. The function can currently only
supply predictions of the <code>link</code> and the <code>response</code> values of the data used
for the fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'chantrics'
predict(object, newdata = NULL, type = c("response", "link"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.chantrics_+3A_object">object</code></td>
<td>
<p>Object of class <code>chantrics</code>, as returned by <code><a href="#topic+adj_loglik">adj_loglik()</a></code></p>
</td></tr>
<tr><td><code id="predict.chantrics_+3A_newdata">newdata</code></td>
<td>
<p>optionally, a data frame in which to look for variables with
which to predict. If omitted, the fitted linear predictors are used.
Supplying new data is currently not supported.</p>
</td></tr>
<tr><td><code id="predict.chantrics_+3A_type">type</code></td>
<td>
<p>the type of prediction required. The default <code>"response"</code> is on
the scale of the response variables. The alternative <code>"link"</code> is on the
scale of the linear predictors, if applicable. Otherwise, an error is
returned.</p>
</td></tr>
<tr><td><code id="predict.chantrics_+3A_...">...</code></td>
<td>
<p>unused.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>newdata</code> is omitted, the predictions are based on the data used
for the fit. Any instances of <code>NA</code> will return <code>NA</code>.
</p>


<h3>Value</h3>

<p>A vector of predictions.
</p>

<hr>
<h2 id='residuals.chantrics'>Residuals of chantrics model fits</h2><span id='topic+residuals.chantrics'></span>

<h3>Description</h3>

<p><code>residuals()</code> returns the residuals specified in <code>type</code> from a <code>"chantrics"</code>
object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'chantrics'
residuals(object, type = c("response", "working", "pearson"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.chantrics_+3A_object">object</code></td>
<td>
<p>an object of class <code>"chantrics"</code>, returned by <code><a href="#topic+adj_loglik">adj_loglik()</a></code>.</p>
</td></tr>
<tr><td><code id="residuals.chantrics_+3A_type">type</code></td>
<td>
<p>the type of residuals which should be returned. The alternatives
are: <code>"response"</code> (default), <code>"working"</code>, and <code>"pearson"</code> (for glm fits).</p>
</td></tr>
<tr><td><code id="residuals.chantrics_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The different types of residuals are as in <code><a href="stats.html#topic+glm.summaries">stats::residuals.glm()</a></code>.
</p>


<h3>Value</h3>

<p>A vector of residuals.
</p>


<h3>References</h3>

<p>A. C. Davison and E. J. Snell, Residuals and diagnostics. In:
Statistical Theory and Modelling. In Honour of Sir David Cox, FRS, 1991.
Eds. Hinkley, D. V., Reid, N. and Snell, E. J., Chapman &amp; Hall.
</p>
<p>M. Döring, Interpreting Generalised Linear Models. In: Data Science Blog,
2018.
<a href="https://www.datascienceblog.net/post/machine-learning/interpreting_generalized_linear_models/">https://www.datascienceblog.net/post/machine-learning/interpreting_generalized_linear_models/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+adj_loglik">adj_loglik()</a></code> for model fitting, <code><a href="stats.html#topic+glm.summaries">stats::residuals.glm()</a></code>, and
<code><a href="stats.html#topic+residuals">stats::residuals()</a></code>.
</p>

<hr>
<h2 id='update.chantrics'>Update, re-fit and re-adjust a Model Call</h2><span id='topic+update.chantrics'></span>

<h3>Description</h3>

<p><code>update.chantrics()</code> will update a model that has been adjusted by
<code><a href="#topic+adj_loglik">adj_loglik()</a></code>. It passes all arguments to the standard <code><a href="stats.html#topic+update">stats::update()</a></code>
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'chantrics'
update(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update.chantrics_+3A_object">object</code></td>
<td>
<p>A <code>"chantrics"</code> returned by <code><a href="#topic+adj_loglik">adj_loglik()</a></code>.</p>
</td></tr>
<tr><td><code id="update.chantrics_+3A_...">...</code></td>
<td>
<p>Additional arguments to the call, passed to <code><a href="stats.html#topic+update">stats::update()</a></code> to
update the original model specification.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function cannot change any arguments passed to the <code>adj_loglik()</code>
function. To change any of these arguments, re-run <code>adj_loglik()</code>.
</p>
<p>Passing <code>evaluate = FALSE</code> is not supported, if this is required,
run <code><a href="stats.html#topic+update">stats::update()</a></code> on the unadjusted object.
</p>


<h3>Value</h3>

<p>The fitted, adjusted <code>"chantrics"</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+update">stats::update()</a></code>
</p>
<p><code><a href="stats.html#topic+update.formula">stats::update.formula()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># from Introducing Chandwich.
set.seed(123)
x &lt;- rnorm(250)
y &lt;- rnbinom(250, mu = exp(1 + x), size = 1)
fm_pois &lt;- glm(y ~ x + I(x^2), family = poisson)
fm_pois_adj &lt;- adj_loglik(fm_pois)
fm_pois_small_adj &lt;- update(fm_pois_adj, formula = . ~ . - I(x^2))
summary(fm_pois_small_adj)
fm_pois_smallest_adj &lt;- update(fm_pois_adj, formula = . ~ 1)
summary(fm_pois_smallest_adj)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
