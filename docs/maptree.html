<!DOCTYPE html><html><head><title>Help for package maptree</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {maptree}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#clip.clust'><p>Prunes a Hierarchical Cluster Tree</p></a></li>
<li><a href='#clip.rpart'><p>Prunes an Rpart Classification or Regression Tree</p></a></li>
<li><a href='#draw.clust'><p>Graph a Hierarchical Cluster Tree</p></a></li>
<li><a href='#draw.tree'><p>Graph a Classification or Regression Tree</p></a></li>
<li><a href='#group.clust'><p>Observation Groups for a Hierarchical Cluster Tree</p></a></li>
<li><a href='#group.tree'><p>Observation Groups for Classification or Regression Tree</p></a></li>
<li><a href='#kgs'><p>KGS Measure for Pruning Hierarchical Clusters</p></a></li>
<li><a href='#map.groups'><p>Map Groups of Observations</p></a></li>
<li><a href='#map.key'><p>Draw Key to accompany Map of Groups</p></a></li>
<li><a href='#ngon'><p>Outline or Fill a Regular Polygon</p></a></li>
<li><a href='#oregon.bird.dist'><p>Presence/Absence of Bird Species in Oregon, USA</p></a></li>
<li><a href='#oregon.bird.names'><p>Names of Bird Species in Oregon, USA</p></a></li>
<li><a href='#oregon.border'><p>Boundary of Oregon, USA</p></a></li>
<li><a href='#oregon.env.vars'><p>Environmental Variables for Oregon, USA</p></a></li>
<li><a href='#oregon.grid'><p>Hexagonal Grid Cell Polygons covering Oregon, USA</p></a></li>
<li><a href='#twins.to.hclust'><p>Converts agnes or diana object to hclust object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.4-8</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-04-03</td>
</tr>
<tr>
<td>Title:</td>
<td>Mapping, Pruning, and Graphing Tree Models</td>
</tr>
<tr>
<td>Author:</td>
<td>Denis White, Robert B. Gramacy &lt;rbg@vt.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Robert B. Gramacy &lt;rbg@vt.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.14), cluster, rpart</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions with example data for graphing, pruning, and
        mapping models from hierarchical clustering, and classification
        and regression trees.</td>
</tr>
<tr>
<td>License:</td>
<td>Unlimited</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-05 15:36:23 UTC; bobby</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-06 11:52:39 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
</table>
<hr>
<h2 id='clip.clust'>Prunes a Hierarchical Cluster Tree</h2><span id='topic+clip.clust'></span>

<h3>Description</h3>

<p>Reduces a hierarchical cluster tree to a smaller tree either
by pruning until a given number of observation groups remain,
or by pruning tree splits below a given height.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  clip.clust (cluster, data=NULL, k=NULL, h=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clip.clust_+3A_cluster">cluster</code></td>
<td>
<p>object of class <code>hclust</code> or <code>twins</code>.</p>
</td></tr>
<tr><td><code id="clip.clust_+3A_data">data</code></td>
<td>
<p>clustered dataset for hclust application.</p>
</td></tr>
<tr><td><code id="clip.clust_+3A_k">k</code></td>
<td>
<p>desired number of groups.</p>
</td></tr>
<tr><td><code id="clip.clust_+3A_h">h</code></td>
<td>
<p>height at which to prune for grouping.</p>
</td></tr>
</table>
<p>At least one of <code>k</code> or <code>h</code> must be specified; <code>k</code> takes
precedence if both are given.
</p>


<h3>Details</h3>

<p>Used with <code><a href="#topic+draw.clust">draw.clust</a></code>.  See example.
</p>


<h3>Value</h3>

<p>Pruned cluster object of class <code>hclust</code>.</p>


<h3>Author(s)</h3>

<p>Denis White </p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+hclust">hclust</a></code>, 
<code><a href="cluster.html#topic+twins.object">twins.object</a></code>, 
<code><a href="stats.html#topic+cutree">cutree</a></code>, 
<code><a href="#topic+draw.clust">draw.clust</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  library (cluster)
  data (oregon.bird.dist)

  draw.clust (clip.clust (agnes (oregon.bird.dist), k=6))
</code></pre>

<hr>
<h2 id='clip.rpart'>Prunes an Rpart Classification or Regression Tree</h2><span id='topic+clip.rpart'></span>

<h3>Description</h3>

<p>Reduces a prediction tree produced by <code><a href="rpart.html#topic+rpart">rpart</a></code> to a
smaller tree by specifying either a cost-complexity parameter,
or a number of nodes to which to prune.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  clip.rpart (tree, cp=NULL, best=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clip.rpart_+3A_tree">tree</code></td>
<td>
<p>object of class <code>rpart</code>.</p>
</td></tr>
<tr><td><code id="clip.rpart_+3A_cp">cp</code></td>
<td>
<p>cost-complexity parameter.</p>
</td></tr>
<tr><td><code id="clip.rpart_+3A_best">best</code></td>
<td>
<p>number of nodes to which to prune.</p>
</td></tr>
</table>
<p>If both <code>cp</code> and <code>best</code> are not <code>NULL</code>, then
<code>cp</code> is used.
</p>


<h3>Details</h3>

<p>A minor enhancement of the existing <code><a href="rpart.html#topic+prune.rpart">prune.rpart</a></code> to
incorporate the parameter <code>best</code> as it is used in the 
(now defunct)  <code>prune.tree</code> function in the old <span class="pkg">tree</span>
package.  See example.
</p>


<h3>Value</h3>

<p>Pruned tree object of class <code>rpart</code>.</p>


<h3>Author(s)</h3>

<p>Denis White</p>


<h3>See Also</h3>

<p><code><a href="rpart.html#topic+rpart">rpart</a></code>, 
<code><a href="rpart.html#topic+prune.rpart">prune.rpart</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  library (rpart)
  data (oregon.env.vars, oregon.border, oregon.grid)

  draw.tree (clip.rpart (rpart (oregon.env.vars), best=7), 
    nodeinfo=TRUE, units="species", cases="cells", digits=0)

  group &lt;- group.tree (clip.rpart (rpart (oregon.env.vars), best=7))
  names(group) &lt;- row.names(oregon.env.vars)
  map.groups (oregon.grid, group)
  lines (oregon.border)
  map.key (0.05, 0.65, labels=as.character(seq(6)), 
    size=1, new=FALSE, sep=0.5, pch=19, head="node")
</code></pre>

<hr>
<h2 id='draw.clust'>Graph a Hierarchical Cluster Tree</h2><span id='topic+draw.clust'></span>

<h3>Description</h3>

<p>Graph a hierarchical cluster tree of class <code>twins</code>
or <code>hclust</code> using colored symbols at observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  draw.clust (cluster, data=NULL, cex=par("cex"), pch=par("pch"), size=2.5*cex, 
      col=NULL, nodeinfo=FALSE, cases="obs", new=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw.clust_+3A_cluster">cluster</code></td>
<td>
<p>object of class <code>hclust</code> or <code>twins</code>.</p>
</td></tr>
<tr><td><code id="draw.clust_+3A_data">data</code></td>
<td>
<p>clustered dataset for hclust application.</p>
</td></tr>
<tr><td><code id="draw.clust_+3A_cex">cex</code></td>
<td>
<p>size of text, par parameter.</p>
</td></tr>
<tr><td><code id="draw.clust_+3A_pch">pch</code></td>
<td>
<p>shape of symbol at leaves, par parameter.</p>
</td></tr>
<tr><td><code id="draw.clust_+3A_size">size</code></td>
<td>
<p>size in cex units of symbol at leaves.</p>
</td></tr>
<tr><td><code id="draw.clust_+3A_col">col</code></td>
<td>
<p>vector of colors from <code><a href="grDevices.html#topic+hsv">hsv</a></code>, <code><a href="grDevices.html#topic+rgb">rgb</a></code>,
etc, or if <code>NULL</code>, then use <code><a href="grDevices.html#topic+rainbow">rainbow</a></code>.</p>
</td></tr>
<tr><td><code id="draw.clust_+3A_nodeinfo">nodeinfo</code></td>
<td>
<p>if <code>TRUE</code>, add a line at each node with number
of observations included in each leaf.</p>
</td></tr>
<tr><td><code id="draw.clust_+3A_cases">cases</code></td>
<td>
<p>label for type of observations.</p>
</td></tr>
<tr><td><code id="draw.clust_+3A_new">new</code></td>
<td>
<p>if <code>TRUE</code>, call <code><a href="graphics.html#topic+plot.new">plot.new</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An alternative to <code><a href="cluster.html#topic+pltree">pltree</a></code> and <code><a href="stats.html#topic+plot.hclust">plot.hclust</a></code>.
</p>


<h3>Value</h3>

<p>The vector of colors supplied or generated.</p>


<h3>Author(s)</h3>

<p>Denis White</p>


<h3>See Also</h3>

<p><code><a href="cluster.html#topic+agnes">agnes</a></code>, 
<code><a href="cluster.html#topic+diana">diana</a></code>, 
<code><a href="stats.html#topic+hclust">hclust</a></code>, 
<code><a href="#topic+draw.tree">draw.tree</a></code>, 
<code><a href="#topic+map.groups">map.groups</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  library (cluster)
  data (oregon.bird.dist)

  draw.clust (clip.clust (agnes (oregon.bird.dist), k=6))
</code></pre>

<hr>
<h2 id='draw.tree'>Graph a Classification or Regression Tree</h2><span id='topic+draw.tree'></span>

<h3>Description</h3>

<p>Graph a classification or regression tree with a hierarchical
tree diagram, optionally including colored symbols at leaves 
and additional info at intermediate nodes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  draw.tree (tree, cex=par("cex"), pch=par("pch"), size=2.5*cex, 
      col=NULL, nodeinfo=FALSE, units="", cases="obs", 
      digits=getOption("digits"), print.levels=TRUE, 
      new=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw.tree_+3A_tree">tree</code></td>
<td>
<p>object of class <code>rpart</code> or <code>tree</code>.</p>
</td></tr>
<tr><td><code id="draw.tree_+3A_cex">cex</code></td>
<td>
<p>size of text, par parameter.</p>
</td></tr>
<tr><td><code id="draw.tree_+3A_pch">pch</code></td>
<td>
<p>shape of symbol at leaves, par parameter.</p>
</td></tr>
<tr><td><code id="draw.tree_+3A_size">size</code></td>
<td>
<p>if <code>size=0</code>, draw terminal symbol at leaves else a
symbol of size in cex units.</p>
</td></tr>
<tr><td><code id="draw.tree_+3A_col">col</code></td>
<td>
<p>vector of colors from <code><a href="grDevices.html#topic+hsv">hsv</a></code>, <code><a href="grDevices.html#topic+rgb">rgb</a></code>,
etc, or if <code>NULL</code>, then use <code><a href="grDevices.html#topic+rainbow">rainbow</a></code>.</p>
</td></tr>
<tr><td><code id="draw.tree_+3A_nodeinfo">nodeinfo</code></td>
<td>
<p>if <code>TRUE</code>, add a line at each node with mean value
of response, number of observations, and percent
deviance explained (or classified correct).</p>
</td></tr>
<tr><td><code id="draw.tree_+3A_units">units</code></td>
<td>
<p>label for units of mean value of response, if
regression tree.</p>
</td></tr>
<tr><td><code id="draw.tree_+3A_cases">cases</code></td>
<td>
<p>label for type of observations.</p>
</td></tr>
<tr><td><code id="draw.tree_+3A_digits">digits</code></td>
<td>
<p>number of digits to round mean value of response, if
regression tree.</p>
</td></tr>
<tr><td><code id="draw.tree_+3A_print.levels">print.levels</code></td>
<td>
<p>if <code>TRUE</code>, print levels of factors at splits,
otherwise only the factor name.</p>
</td></tr>
<tr><td><code id="draw.tree_+3A_new">new</code></td>
<td>
<p>if <code>TRUE</code>, call <code><a href="graphics.html#topic+plot.new">plot.new</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As in <code>plot.rpart(,uniform=TRUE)</code>, each level has constant depth.  
Specifying <code>nodeinfo=TRUE</code>, shows the deviance explained or the 
classification rate at each node.
</p>
<p>A split is shown, for numerical variables, as 
<code>variable &lt;&gt; value</code> when the cases with lower values go left, or as 
<code>variable &gt;&lt; value</code> when the cases with lower values go right.
When the splitting variable is a factor, and print.levels=TRUE, 
the split is shown as <code>levels = factor = levels</code> with the cases 
on the left having factor levels equal to those on the left of the 
factor name, and correspondingly for the right.
</p>


<h3>Value</h3>

<p>The vector of colors supplied or generated.</p>


<h3>Author(s)</h3>

<p>Denis White</p>


<h3>See Also</h3>

<p><code><a href="rpart.html#topic+rpart">rpart</a></code>, 
<code><a href="#topic+draw.clust">draw.clust</a></code>, 
<code><a href="#topic+map.groups">map.groups</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  library (rpart)
  data (oregon.env.vars)

  draw.tree (clip.rpart (rpart (oregon.env.vars), best=7), 
      nodeinfo=TRUE, units="species", cases="cells", digits=0)
</code></pre>

<hr>
<h2 id='group.clust'>Observation Groups for a Hierarchical Cluster Tree</h2><span id='topic+group.clust'></span>

<h3>Description</h3>

<p>Alternative to <code><a href="stats.html#topic+cutree">cutree</a></code> that orders pruned groups from
left to right in draw order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  group.clust (cluster, k=NULL, h=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="group.clust_+3A_cluster">cluster</code></td>
<td>
<p>object of class <code>hclust</code> or <code>twins</code>.</p>
</td></tr>
<tr><td><code id="group.clust_+3A_k">k</code></td>
<td>
<p>desired number of groups.</p>
</td></tr>
<tr><td><code id="group.clust_+3A_h">h</code></td>
<td>
<p>height at which to prune for grouping.</p>
</td></tr>
</table>
<p>At least one of <code>k</code> or <code>h</code> must be specified; <code>k</code> takes
precedence if both are given.
</p>


<h3>Details</h3>

<p>Normally used with <code><a href="#topic+map.groups">map.groups</a></code>.  See example.
</p>


<h3>Value</h3>

<p>Vector of pruned cluster membership</p>


<h3>Author(s)</h3>

<p>Denis White</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+hclust">hclust</a></code>, 
<code><a href="cluster.html#topic+twins.object">twins.object</a></code>, 
<code><a href="stats.html#topic+cutree">cutree</a></code>, 
<code><a href="#topic+map.groups">map.groups</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data (oregon.bird.dist, oregon.grid)

  group &lt;- group.clust (hclust (dist (oregon.bird.dist)), k=6)
  names(group) &lt;- row.names(oregon.bird.dist)
  map.groups (oregon.grid, group)
</code></pre>

<hr>
<h2 id='group.tree'>Observation Groups for Classification or Regression Tree</h2><span id='topic+group.tree'></span>

<h3>Description</h3>

<p>Alternative to <code>tree[["where"]]</code> that orders groups from left
to right in draw order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  group.tree (tree)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="group.tree_+3A_tree">tree</code></td>
<td>
<p>object of class <code>rpart</code> or <code>tree</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Normally used with <code><a href="#topic+map.groups">map.groups</a></code>.  See example.
</p>


<h3>Value</h3>

<p>Vector of rearranged <code>tree[["where"]]</code></p>


<h3>Author(s)</h3>

<p>Denis White</p>


<h3>See Also</h3>

<p><code><a href="rpart.html#topic+rpart">rpart</a></code>, 
<code><a href="#topic+map.groups">map.groups</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  library (rpart)
  data (oregon.env.vars, oregon.grid)

  group &lt;- group.tree (clip.rpart (rpart (oregon.env.vars), best=7))
  names(group) &lt;- row.names(oregon.env.vars)
  map.groups (oregon.grid, group=group)
</code></pre>

<hr>
<h2 id='kgs'>KGS Measure for Pruning Hierarchical Clusters</h2><span id='topic+kgs'></span>

<h3>Description</h3>

<p>Computes the Kelley-Gardner-Sutcliffe penalty function for a 
hierarchical cluster tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  kgs (cluster, diss, alpha=1, maxclust=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kgs_+3A_cluster">cluster</code></td>
<td>
<p>object of class <code>hclust</code> or <code>twins</code>.</p>
</td></tr>
<tr><td><code id="kgs_+3A_diss">diss</code></td>
<td>
<p>object of class <code>dissimilarity</code> or <code>dist</code>.</p>
</td></tr>
<tr><td><code id="kgs_+3A_alpha">alpha</code></td>
<td>
<p>weight for number of clusters.</p>
</td></tr>
<tr><td><code id="kgs_+3A_maxclust">maxclust</code></td>
<td>
<p>maximum number of clusters for which to compute
measure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Kelley et al. (see reference) proposed a method that can help decide 
where to prune a hierarchical cluster tree.  At any level of the 
tree the mean across all clusters of the mean within clusters of the 
dissimilarity measure is calculated.  After normalizing, the number 
of clusters times alpha is added.  The minimum of this function  
corresponds to the suggested pruning size.
</p>
<p>The current implementation has complexity O(n*n*maxclust), thus 
very slow with large n.  For improvements, at least it should only 
calculate the spread for clusters that are split at each level, 
rather than over again for all.
</p>


<h3>Value</h3>

<p>Vector of the penalty function for trees of size 2:maxclust. 
The names of vector elements are the respective numbers of clusters.</p>


<h3>Author(s)</h3>

<p>Denis White</p>


<h3>References</h3>

<p>Kelley, L.A., Gardner, S.P., Sutcliffe, M.J.  (1996)  An automated
approach for clustering an ensemble of NMR-derived protein structures 
into conformationally-related subfamilies, <em>Protein Engineering</em>, 
<b>9</b>, 1063-1065.
</p>


<h3>See Also</h3>

<p><code><a href="cluster.html#topic+twins.object">twins.object</a></code>, 
<code><a href="cluster.html#topic+dissimilarity.object">dissimilarity.object</a></code>, 
<code><a href="stats.html#topic+hclust">hclust</a></code>, 
<code><a href="stats.html#topic+dist">dist</a></code>,
<code><a href="#topic+clip.clust">clip.clust</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  library (cluster)
  data (votes.repub)

  a &lt;- agnes (votes.repub, method="ward")
  b &lt;- kgs (a, a$diss, maxclust=20)
  plot (names (b), b, xlab="# clusters", ylab="penalty")
</code></pre>

<hr>
<h2 id='map.groups'>Map Groups of Observations</h2><span id='topic+map.groups'></span>

<h3>Description</h3>

<p>Draws maps of groups of observations created by clustering,
classification or regression trees, or some other type of
classification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  map.groups (pts, group, pch=par("pch"), size=2, col=NULL, 
      border=NULL, new=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map.groups_+3A_pts">pts</code></td>
<td>
<p>matrix or data frame with components <code>"x"</code>,
and <code>"y"</code> for each observation (see details).</p>
</td></tr>
<tr><td><code id="map.groups_+3A_group">group</code></td>
<td>
<p>vector of integer class numbers corresponding to
<code>pts</code> (see details), and indexing colors
in <code>col</code>.</p>
</td></tr>
<tr><td><code id="map.groups_+3A_pch">pch</code></td>
<td>
<p>symbol number from <code>par("pch")</code> if &lt; 100, otherwise
parameter <code>n</code> for ngon.</p>
</td></tr>
<tr><td><code id="map.groups_+3A_size">size</code></td>
<td>
<p>size in cex units of point symbol.</p>
</td></tr>
<tr><td><code id="map.groups_+3A_col">col</code></td>
<td>
<p>vector of fill colors from <code><a href="grDevices.html#topic+hsv">hsv</a></code>, <code><a href="grDevices.html#topic+rgb">rgb</a></code>,
etc, or if <code>NULL</code>, then use <code><a href="grDevices.html#topic+rainbow">rainbow</a></code>.</p>
</td></tr>
<tr><td><code id="map.groups_+3A_border">border</code></td>
<td>
<p>vector of border colors from <code><a href="grDevices.html#topic+hsv">hsv</a></code>,
<code><a href="grDevices.html#topic+rgb">rgb</a></code>,
etc, or if <code>NULL</code>, then use <code><a href="grDevices.html#topic+rainbow">rainbow</a></code>.</p>
</td></tr>
<tr><td><code id="map.groups_+3A_new">new</code></td>
<td>
<p>if <code>TRUE</code>, call <code><a href="graphics.html#topic+plot.new">plot.new</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the number of rows of <code>pts</code> is not equal to the length
of <code>group</code>, then (1) <code>pts</code> are assumed to represent
polygons and <code><a href="graphics.html#topic+polygon">polygon</a></code> is used, (2) the identifiers in 
<code>group</code> are matched to the polygons in <code>pts</code> through 
<code>names(group)</code> and <code>pts$x[is.na(pts$y)]</code>, and (3) these
identifiers are mapped to dense integers to reference colours.
Otherwise, <code>group</code> is assumed to parallel <code>pts</code>, and,
if <code>pch &lt; 100</code>, then <code><a href="graphics.html#topic+points">points</a></code> is used, otherwise
<code><a href="#topic+ngon">ngon</a></code>, to draw shaded polygon symbols for each
observation in pts.
</p>


<h3>Value</h3>

<p>The vector of fill colors supplied or generated.</p>


<h3>Author(s)</h3>

<p>Denis White</p>


<h3>See Also</h3>

<p><code><a href="#topic+ngon">ngon</a></code>, 
<code><a href="graphics.html#topic+polygon">polygon</a></code>, 
<code><a href="#topic+group.clust">group.clust</a></code>, 
<code><a href="#topic+group.tree">group.tree</a></code>, 
<code><a href="#topic+map.key">map.key</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data (oregon.bird.names, oregon.env.vars, oregon.bird.dist)
  data (oregon.border, oregon.grid)

  # range map for American Avocet
  spp &lt;- match ("American avocet", oregon.bird.names[["common.name"]])
  group &lt;- oregon.bird.dist[,spp] + 1
  names(group) &lt;- row.names(oregon.bird.dist)
  kol &lt;- gray (seq(0.8,0.2,length.out=length (table (group))))
  map.groups (oregon.grid, group=group, col=kol)
  lines (oregon.border)

  # distribution of January temperatures
  cuts &lt;- quantile (oregon.env.vars[["jan.temp"]], probs=seq(0,1,1/5))
  group &lt;- cut (oregon.env.vars[["jan.temp"]], cuts, labels=FALSE, 
    include.lowest=TRUE)
  names(group) &lt;- row.names(oregon.env.vars)
  kol &lt;- gray (seq(0.8,0.2,length.out=length (table (group))))
  map.groups (oregon.grid, group=group, col=kol)
  lines (oregon.border)

  # January temperatures using point symbols rather than polygons
  map.groups (oregon.env.vars, group, col=kol, pch=19)
  lines (oregon.border)
</code></pre>

<hr>
<h2 id='map.key'>Draw Key to accompany Map of Groups</h2><span id='topic+map.key'></span>

<h3>Description</h3>

<p>Draws legends for maps of groups of observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  map.key (x, y, labels=NULL, cex=par("cex"), pch=par("pch"),
      size=2.5*cex, col=NULL, head="", sep=0.25*cex, new=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map.key_+3A_x">x</code>, <code id="map.key_+3A_y">y</code></td>
<td>
<p>coordinates of lower left position of key
in proportional units (0-1) of plot.</p>
</td></tr>
<tr><td><code id="map.key_+3A_labels">labels</code></td>
<td>
<p>vector of labels for classes, or if <code>NULL</code>,
then integers <code>1:length(col)</code>, or <code>1</code>.</p>
</td></tr>
<tr><td><code id="map.key_+3A_size">size</code></td>
<td>
<p>size in cex units of shaded key symbol.</p>
</td></tr>
<tr><td><code id="map.key_+3A_pch">pch</code></td>
<td>
<p>symbol number for <code><a href="graphics.html#topic+par">par</a></code> if &lt; 100, otherwise
parameter <code>n</code> for <code><a href="#topic+ngon">ngon</a></code>.</p>
</td></tr>
<tr><td><code id="map.key_+3A_cex">cex</code></td>
<td>
<p>pointsize of text, <code><a href="graphics.html#topic+par">par</a></code> parameter.</p>
</td></tr>
<tr><td><code id="map.key_+3A_head">head</code></td>
<td>
<p>text heading for key.</p>
</td></tr>
<tr><td><code id="map.key_+3A_sep">sep</code></td>
<td>
<p>separation in cex units between adjacent symbols in key.
If <code>sep=0</code>, assume a continuous scale, use square
symbols, and put labels at breaks between squares.</p>
</td></tr>
<tr><td><code id="map.key_+3A_col">col</code></td>
<td>
<p>vector of colors from <code><a href="grDevices.html#topic+hsv">hsv</a></code>, <code><a href="grDevices.html#topic+rgb">rgb</a></code>,
etc, or if <code>NULL</code>, then use <code><a href="grDevices.html#topic+rainbow">rainbow</a></code>.</p>
</td></tr>
<tr><td><code id="map.key_+3A_new">new</code></td>
<td>
<p>if <code>TRUE</code>, call <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses <code><a href="graphics.html#topic+points">points</a></code> or <code><a href="#topic+ngon">ngon</a></code>, depending on value of
<code>pch</code>, to draw shaded polygon symbols for key.
</p>


<h3>Value</h3>

<p>The vector of colors supplied or generated.</p>


<h3>Author(s)</h3>

<p>Denis White</p>


<h3>See Also</h3>

<p><code><a href="#topic+ngon">ngon</a></code>, 
<code><a href="#topic+map.groups">map.groups</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data (oregon.env.vars)

  # key for examples in help(map.groups)
  # range map for American Avocet
  kol &lt;- gray (seq(0.8,0.2,length.out=2))
  map.key (0.2, 0.2, labels=c("absent","present"), pch=106, 
    col=kol, head="key", new=TRUE)
  # distribution of January temperatures
  cuts &lt;- quantile (oregon.env.vars[["jan.temp"]], probs=seq(0,1,1/5))
  kol &lt;- gray (seq(0.8,0.2,length.out=5))
  map.key (0.2, 0.2, labels=as.character(round(cuts,0)), 
    col=kol, sep=0, head="key", new=TRUE)

  # key for example in help file for group.tree
  map.key (0.2, 0.2, labels=as.character(seq(6)), 
    pch=19, head="node", new=TRUE)
</code></pre>

<hr>
<h2 id='ngon'>Outline or Fill a Regular Polygon</h2><span id='topic+ngon'></span>

<h3>Description</h3>

<p>Draws a regular polygon at specified coordinates as an
outline or shaded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ngon (xydc, n=4, angle=0, type=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ngon_+3A_xydc">xydc</code></td>
<td>
<p>four element vector with <code>x</code> and <code>y</code>
coordinates of center, <code>d</code> diameter in mm, and
<code>c</code> color.</p>
</td></tr>
<tr><td><code id="ngon_+3A_n">n</code></td>
<td>
<p>number of sides for polygon (&gt;8 =&gt; circle).</p>
</td></tr>
<tr><td><code id="ngon_+3A_angle">angle</code></td>
<td>
<p>rotation angle of figure, in degrees.</p>
</td></tr>
<tr><td><code id="ngon_+3A_type">type</code></td>
<td>
<p><code>type=1</code> =&gt; interior filled, <code>type=2</code> =&gt; edge,
<code>type=3</code> =&gt; both.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses <code><a href="graphics.html#topic+polygon">polygon</a></code> to draw shaded polygons and
<code><a href="graphics.html#topic+lines">lines</a></code> for outline.  If n is odd, there is
a vertex at (0, d/2), otherwise the midpoint of a side is
at (0, d/2).
</p>


<h3>Value</h3>

<p>Invisible.</p>


<h3>Author(s)</h3>

<p>Denis White</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+polygon">polygon</a></code>, 
<code><a href="graphics.html#topic+lines">lines</a></code>, 
<code><a href="#topic+map.key">map.key</a></code>, 
<code><a href="#topic+map.groups">map.groups</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  plot (c(0,1), c(0,1), type="n")
  ngon (c(.5, .5, 10, "blue"), angle=30, n=3)
  apply (cbind (runif(8), runif(8), 6, 2), 1, ngon)
</code></pre>

<hr>
<h2 id='oregon.bird.dist'>Presence/Absence of Bird Species in Oregon, USA</h2><span id='topic+oregon.bird.dist'></span>

<h3>Description</h3>

<p>Binary matrix (1 = present) for distributions of 248 native
breeding bird species for 389 grid cells in Oregon, USA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data (oregon.bird.dist)</code></pre>


<h3>Format</h3>

<p>A data frame with 389 rows and 248 columns.</p>


<h3>Details</h3>

<p>Row names are hexagon identifiers from White et al. (1992).
Column names are species element codes developed by
The Nature Conservancy (TNC),
the Oregon Natural Heritage Program (ONHP), and
NatureServe.
</p>


<h3>Source</h3>

<p>Denis White</p>


<h3>References</h3>

<p>Master, L. (1996) Predicting distributions for vertebrate
species: some observations, <em>Gap Analysis: A Landscape
Approach to Biodiversity Planning</em>, Scott, J.M., Tear, T.H.,
and Davis, F.W., editors, American Society for Photogrammetry
and Remote Sensing, Bethesda, MD, pp. 171-176.
</p>
<p>White, D., Preston, E.M., Freemark, K.E., Kiester, A.R. (1999)
A hierarchical framework for conserving biodiversity,
<em>Landscape ecological analysis: issues and applications</em>,
Klopatek, J.M., Gardner, R.H., editors, Springer-Verlag, pp.
127-153.
</p>
<p>White, D., Kimerling, A.J., Overton, W.S.  (1992)  Cartographic
and geometric components of a global sampling design for
environmental monitoring, <em>Cartography and Geographic
Information Systems</em>, <b>19</b>(1), 5-22.
</p>
<p>TNC, <a href="https://www.nature.org/en-us/">https://www.nature.org/en-us/</a>
</p>
<p>ONHP, <a href="https://inr.oregonstate.edu/orbic/">https://inr.oregonstate.edu/orbic/</a>
</p>
<p>NatureServe, <a href="https://www.natureserve.org/">https://www.natureserve.org/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oregon.env.vars">oregon.env.vars</a></code>, 
<code><a href="#topic+oregon.bird.names">oregon.bird.names</a></code>, 
<code><a href="#topic+oregon.grid">oregon.grid</a></code>, 
<code><a href="#topic+oregon.border">oregon.border</a></code>
</p>

<hr>
<h2 id='oregon.bird.names'>Names of Bird Species in Oregon, USA</h2><span id='topic+oregon.bird.names'></span>

<h3>Description</h3>

<p>Scientific and common names for 248 native breeding bird species
in Oregon, USA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data (oregon.bird.names)</code></pre>


<h3>Format</h3>

<p>A data frame with 248 rows and 2 columns.</p>


<h3>Details</h3>

<p>Row names are species element codes.  Columns are
<code>"scientific.name"</code> and <code>"common.name"</code>.
Data are provided by The Nature Conservancy (TNC),
the Oregon Natural Heritage Program (ONHP), and
NatureServe.
</p>


<h3>Source</h3>

<p>Denis White</p>


<h3>References</h3>

<p>Master, L. (1996) Predicting distributions for vertebrate
species: some observations, <em>Gap Analysis: A Landscape
Approach to Biodiversity Planning</em>, Scott, J.M., Tear, T.H.,
and Davis, F.W., editors, American Society for Photogrammetry
and Remote Sensing, Bethesda, MD, pp. 171-176.
</p>
<p>TNC, <a href="https://www.nature.org/en-us/">https://www.nature.org/en-us/</a>
</p>
<p>ONHP, <a href="https://inr.oregonstate.edu/orbic/">https://inr.oregonstate.edu/orbic/</a>
</p>
<p>NatureServe, <a href="https://www.natureserve.org/">https://www.natureserve.org/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oregon.bird.dist">oregon.bird.dist</a></code>
</p>

<hr>
<h2 id='oregon.border'>Boundary of Oregon, USA</h2><span id='topic+oregon.border'></span>

<h3>Description</h3>

<p>The boundary of the state of Oregon, USA, in
<code><a href="graphics.html#topic+lines">lines</a></code> format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data (oregon.border)</code></pre>


<h3>Format</h3>

<p>A data frame with 485 rows and 2 columns (the components
<code>"x"</code> and <code>"y"</code>).</p>


<h3>Details</h3>

<p>The map projection for this boundary, as well as the point
coordinates in <code><a href="#topic+oregon.env.vars">oregon.env.vars</a></code>, is the Lambert
Conformal Conic with standard parallels at 33 and 45
degrees North latitude, with the longitude of the central
meridian at 120 degrees, 30 minutes West longitude,
and with the projection origin latitude at 41 degrees,
45 minutes North latitude.
</p>


<h3>Source</h3>

<p>Denis White</p>

<hr>
<h2 id='oregon.env.vars'>Environmental Variables for Oregon, USA</h2><span id='topic+oregon.env.vars'></span>

<h3>Description</h3>

<p>Distributions of 10 environmental variables for 389 grid
cells in Oregon, USA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data (oregon.env.vars)</code></pre>


<h3>Format</h3>

<p>A data frame with 389 rows and 10 columns.</p>


<h3>Details</h3>

<p>Row names are hexagon identifiers from White et al. (1992).
Variables (columns) are 
</p>

<table>
<tr>
 <td style="text-align: left;">
    bird.spp </td><td style="text-align: left;"> number of native breeding bird species</td>
</tr>
<tr>
 <td style="text-align: left;">
    x </td><td style="text-align: left;"> x coordinate of center of grid cell</td>
</tr>
<tr>
 <td style="text-align: left;">
    y </td><td style="text-align: left;"> y coordinate of center of grid cell</td>
</tr>
<tr>
 <td style="text-align: left;">
    jan.temp </td><td style="text-align: left;"> mean minimum January temperature (C)</td>
</tr>
<tr>
 <td style="text-align: left;">
    jul.temp </td><td style="text-align: left;"> mean maximum July temperature (C)</td>
</tr>
<tr>
 <td style="text-align: left;">
    rng.temp </td><td style="text-align: left;"> mean difference between July and January temperatures (C)</td>
</tr>
<tr>
 <td style="text-align: left;">
    ann.ppt </td><td style="text-align: left;"> mean annual precipitation (mm)</td>
</tr>
<tr>
 <td style="text-align: left;">
    min.elev </td><td style="text-align: left;"> minimum elevation (m)</td>
</tr>
<tr>
 <td style="text-align: left;">
    rng.elev </td><td style="text-align: left;"> range of elevation (m)</td>
</tr>
<tr>
 <td style="text-align: left;">
    max.slope </td><td style="text-align: left;"> maximum slope (percent)
  </td>
</tr>

</table>



<h3>Source</h3>

<p>Denis White</p>


<h3>References</h3>

<p>White, D., Preston, E.M., Freemark, K.E., Kiester, A.R. (1999)
A hierarchical framework for conserving biodiversity,
<em>Landscape ecological analysis: issues and applications</em>,
Klopatek, J.M., Gardner, R.H., editors, Springer-Verlag, pp.
127-153.
</p>
<p>White, D., Kimerling, A.J., Overton, W.S.  (1992)  Cartographic
and geometric components of a global sampling design for
environmental monitoring, <em>Cartography and Geographic
Information Systems</em>, <b>19</b>(1), 5-22.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oregon.bird.dist">oregon.bird.dist</a></code>, 
<code><a href="#topic+oregon.grid">oregon.grid</a></code>, 
<code><a href="#topic+oregon.border">oregon.border</a></code>
</p>

<hr>
<h2 id='oregon.grid'>Hexagonal Grid Cell Polygons covering Oregon, USA</h2><span id='topic+oregon.grid'></span>

<h3>Description</h3>

<p>Polygon borders for 389 hexagonal grid cells covering Oregon, USA,
in <code><a href="graphics.html#topic+polygon">polygon</a></code> format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data (oregon.grid)</code></pre>


<h3>Format</h3>

<p>A data frame with 3112 rows and 2 columns (the components
<code>"x"</code> and <code>"y"</code>).</p>


<h3>Details</h3>

<p>The polygon format used for these grid cell boundaries is a slight
variation from the standard R/S format.  Each cell polygon is
described by seven coordinate pairs, the last repeating the first.
Prior to the first coordinate pair of each cell is a row containing
NA in the <code>"y"</code> column and, in the <code>"x"</code> column, an
identifier for the cell.  The identifiers are the same as the
row names in <code><a href="#topic+oregon.bird.dist">oregon.bird.dist</a></code> and
<code><a href="#topic+oregon.env.vars">oregon.env.vars</a></code>.  See <code><a href="#topic+map.groups">map.groups</a></code> for
how the linkage is made in mapping.
</p>
<p>These grid cells are extracted from a larger set covering the
conterminous United States and adjacent parts of Canada and
Mexico, as described in White et al. (1992).  Only cells with
at least 50 percent of their area contained within the state of
Oregon are included.
</p>
<p>The map projection for the coordinates, as well as the point
coordinates in <code><a href="#topic+oregon.env.vars">oregon.env.vars</a></code>, is the Lambert
Conformal Conic with standard parallels at 33 and 45
degrees North latitude, with the longitude of the central
meridian at 120 degrees, 30 minutes West longitude,
and with the projection origin latitude at 41 degrees,
45 minutes North latitude.
</p>


<h3>Source</h3>

<p>Denis White</p>


<h3>References</h3>

<p>White, D., Kimerling, A.J., Overton, W.S.  (1992)  Cartographic
and geometric components of a global sampling design for
environmental monitoring, <em>Cartography and Geographic
Information Systems</em>, <b>19</b>(1), 5-22.
</p>

<hr>
<h2 id='twins.to.hclust'>Converts agnes or diana object to hclust object</h2><span id='topic+twins.to.hclust'></span>

<h3>Description</h3>

<p>Alternative to <code><a href="stats.html#topic+as.hclust">as.hclust</a></code> that retains cluster data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  twins.to.hclust (cluster)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twins.to.hclust_+3A_cluster">cluster</code></td>
<td>
<p>object of class <code>twins</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used internally in with <code><a href="#topic+clip.clust">clip.clust</a></code> and 
<code><a href="#topic+draw.clust">draw.clust</a></code>.
</p>


<h3>Value</h3>

<p>hclust object</p>


<h3>Author(s)</h3>

<p>Denis White</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+hclust">hclust</a></code>, 
<code><a href="cluster.html#topic+twins.object">twins.object</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
