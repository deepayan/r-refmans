<!DOCTYPE html><html lang="en"><head><title>Help for package superdiag</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {superdiag}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#hellinger.diag'><p>Hellinger Distance Diagnostics for MCMC</p></a></li>
<li><a href='#superdiag'><p>Test for Markov Chain Nonconvergence</p></a></li>
<li><a href='#superdiagPlot'><p>Summary Plots for <code>mcmc</code> Objects</p></a></li>
<li><a href='#tobit.list'><p>Data: A <code>mcmc.list</code> from a Tobit model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Comprehensive Test Suite for Testing Markov Chain
Nonconvergence</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Le Bao &lt;lbaole17@gmail.com&gt;, Jeff Gill &lt;jgill@mac.com&gt;, Tsung-han Tsai &lt;thtsai@nccu.edu.tw&gt; and Jonathan Rapkin</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Le Bao &lt;lbaole17@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The 'superdiag' package provides a comprehensive test suite for testing
  Markov Chain nonconvergence. It integrates five standard empirical MCMC convergence
  diagnostics (Gelman-Rubin, Geweke, Heidelberger-Welch, Raftery-Lewis, and Hellinger
  distance) and plotting functions for trace plots and density histograms. The functions
  of the package can be used to present all diagnostic statistics and graphs at once
  for conveniently checking MCMC nonconvergence.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>coda</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-12-05 01:06:03 UTC; baole</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-12-05 09:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='hellinger.diag'>Hellinger Distance Diagnostics for MCMC</h2><span id='topic+hellinger.diag'></span><span id='topic+hellinger.diag.list'></span><span id='topic+hellinger.diag.mcmc.list'></span><span id='topic+hellinger.diag.matrix'></span><span id='topic+hellinger.diag.mcmc'></span>

<h3>Description</h3>

<p>This computes the Hellinger distance for <code>mcmc</code> or <code>mcmc.list</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hellinger.diag(x)

## S3 method for class 'list'
hellinger.diag(x)

## S3 method for class 'mcmc.list'
hellinger.diag(x)

## S3 method for class 'matrix'
hellinger.diag(x, bins, binwidth)

## S3 method for class 'mcmc'
hellinger.diag(x, bins, binwidth)
</code></pre>


<h3>Details</h3>

<p>@param x A <code>mcmc</code> or <code>mcmc.list</code> object. For mcmc object contains
one single MCMC chain, the within-chain distance is computed. For <code>mcmc.list</code>
object containing multiple MCMC chains, the between distribution distance(s)
is computed.
@param bins Number of bins for testing within-chain distance. Defaults to 10.
@param binwidth Alternative specification for <code>bins</code>. The size of bin for each batch
of the chain(s) for computing the distance between batches.
</p>


<h3>Value</h3>

<p>A matrix of the estimates.
</p>


<h3>References</h3>

<p>Boone, Edward L., Jason RW Merrick, and Matthew J. Krachey (2014). &quot;A
Hellinger distance approach to MCMC diagnostics.&quot; <em>Journal of Statistical Computation
and Simulation</em>, 84 (4), 833-849, <code>doi:10.1080/00949655.2012.729588</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

data(tobit.list)
summary(tobit.list[1])

# FOR mcmc.list OBJECT
hellinger.diag.mcmc.list(tobit.list)

# FOR mcmc OBJECT
hellinger.diag.mcmc(tobit.list[[1]])


## End(Not run)

</code></pre>

<hr>
<h2 id='superdiag'>Test for Markov Chain Nonconvergence</h2><span id='topic+superdiag'></span>

<h3>Description</h3>

<p>The <code>superdiag</code> function takes MCMC samples as input. It provides a comprehensive
test suite for Markov chain nonconvergence, which integrates five standard
empirical MCMC convergence diagnostics: Gelman-Rubin, Geweke, Heidelberger-Welch,
Raftery-Lewis, Hellinger distance. It can also present trace plots and density
histograms along with the diagnostics as options.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>superdiag(
  mcmcoutput,
  burnin,
  terms = "all",
  plot = FALSE,
  confidence.gr = 0.95,
  frac1.gw = 0.1,
  frac2.gw = 0.5,
  eps.hw = 0.1,
  pvalue.hw = 0.05,
  q.rl = 0.025,
  r.rl = 0.005,
  s.rl = 0.95,
  eps.rl = 0.001,
  bins = 5,
  binwidth = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="superdiag_+3A_mcmcoutput">mcmcoutput</code></td>
<td>
<p>A <code>mcmc</code> or <code>mcmc.list</code> object.</p>
</td></tr>
<tr><td><code id="superdiag_+3A_burnin">burnin</code></td>
<td>
<p>The number of burn-in iterations. Defaults to half of the chain(s).</p>
</td></tr>
<tr><td><code id="superdiag_+3A_terms">terms</code></td>
<td>
<p>The convergence diagnostic methods. Defaults to all five methods.
Users can also specify one or more particular methods chosen from &quot;<code>geweke</code>&quot;,
&quot;<code>heidel</code>&quot;, &quot;<code>raftery</code>&quot;, &quot;<code>gelman</code>&quot;, &quot;<code>hellinger</code>&quot;.</p>
</td></tr>
<tr><td><code id="superdiag_+3A_plot">plot</code></td>
<td>
<p>Logical values indicates whether a graph of <code>superdiagPlot</code>
should be presented with a run of the function. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="superdiag_+3A_confidence.gr">confidence.gr</code></td>
<td>
<p>(1-<code class="reqn">\alpha</code>)% for the Gelman and Rubin test. The upper
95% credible interval is the default.</p>
</td></tr>
<tr><td><code id="superdiag_+3A_frac1.gw">frac1.gw</code></td>
<td>
<p>frac1 for the Geweke test. The proportion of the early era of
the chain, defaulted to 0.1.</p>
</td></tr>
<tr><td><code id="superdiag_+3A_frac2.gw">frac2.gw</code></td>
<td>
<p>frac2 for the Geweke test. The proportion of the late era of
the chain, defaulted to 0.5.</p>
</td></tr>
<tr><td><code id="superdiag_+3A_eps.hw">eps.hw</code></td>
<td>
<p><code>epsilon</code> for the Heidelberger and Welch test. The accuracy
parameter determines whether the halfwidth is passed or not, defaulted to 0.1.</p>
</td></tr>
<tr><td><code id="superdiag_+3A_pvalue.hw">pvalue.hw</code></td>
<td>
<p>p-value for the Heidelberger and Welch test. The halfwidth of
the test calculates a (1-<code class="reqn">\alpha</code>)% credible interval around the sample
mean for each parameter dimension. The default is 0.05.</p>
</td></tr>
<tr><td><code id="superdiag_+3A_q.rl">q.rl</code></td>
<td>
<p>q-parameter for the Raftery and Lewis test. The posterior tail threshold
of interest, defaulted to 0.025.</p>
</td></tr>
<tr><td><code id="superdiag_+3A_r.rl">r.rl</code></td>
<td>
<p>r-parameter for the Raftery and Lewis test. The tolerance for the
tail threshold, defaulted to 0.0005.</p>
</td></tr>
<tr><td><code id="superdiag_+3A_s.rl">s.rl</code></td>
<td>
<p>s-parameter for the Raftery and Lewis test. The desired probability
of being within the tolerance, defaulted to 0.95.</p>
</td></tr>
<tr><td><code id="superdiag_+3A_eps.rl">eps.rl</code></td>
<td>
<p>convergence epsilon for the Raftery and Lewis test. The convergence
tolerance value, which is used to determine a stopping point based on a parallel chain process, defaulted to 0.001.</p>
</td></tr>
<tr><td><code id="superdiag_+3A_bins">bins</code></td>
<td>
<p>Number of bins for within-chain Hellinger distance test. Defaults to 5.</p>
</td></tr>
<tr><td><code id="superdiag_+3A_binwidth">binwidth</code></td>
<td>
<p>Alternative specification for <code>bins</code>. The size of bin for each batch
of the chain(s) for computing the distance between batches.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If only one chain is analyzed, the default settings in <code>boa</code> and
<code>coda</code> for Geweke, Raftery-Lewis, and Heidelberger-Welch diagnostics are
used. If multiple chains are provided, only the first chain uses the defaults
and all other chain analyses get random values as follows. For Geweke test,
random non-overlapping proportions up from the start of the chain and down
from the end of the chain are generated. For Heidelberger-Welch test, the
value of <code>pvalue.hw</code> is sampled with replacement from common <code class="reqn">\alpha</code>
values; the value of <code>eps.hw</code> is sampled uniformly in the interval [0.01:0.2].
For Raftery-Lewis test, each of these four parameters are sample from a vector
(changeable by users) of values around the defaults (larger and smaller) to
provide a reasonable range of alternatives. For Hellinger distance, if only
one chain is analyzed, only within-chain distance will be reported.
</p>


<h3>Value</h3>

<p>A list object including the results for all the diagnostics. A <code>superdiagPlot</code>
including both traceplot(s) and density histogram will also be returned if <code>plot=TRUE</code>.
</p>


<h3>References</h3>

<p>Tsai, Tsung-han and Gill, Jeff (2012). &ldquo;superdiag: A Comprehensive Test
Suite for Markov Chain Non-Convergence.&rdquo; <em>The Political Methodologist</em>,
19 (2), 12-18.
</p>
<p>Plummer, Martyn, Nicky Best, Kate Cowles, and Karen Vines (2006). &quot;CODA: convergence
diagnosis and output analysis for MCMC.&quot; <em>R news</em>, 6 (1), 7-11.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+superdiagPlot">superdiagPlot</a></code>, <code><a href="coda.html#topic+gelman.diag">gelman.diag</a></code>, <code><a href="coda.html#topic+heidel.diag">heidel.diag</a></code>,
<code><a href="coda.html#topic+raftery.diag">raftery.diag</a></code>, <code><a href="coda.html#topic+gelman.diag">gelman.diag</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

data(tobit.list)
summary(tobit.list[1])

# FOR mcmc.list OBJECT
superdiag(tobit.list, burnin=0)

# FOR mcmc OBJECT
tobit.diag &lt;- superdiag(tobit.list[[1]], burnin=0, plot=TRUE)
tobit.diag

## End(Not run)

</code></pre>

<hr>
<h2 id='superdiagPlot'>Summary Plots for <code>mcmc</code> Objects</h2><span id='topic+superdiagPlot'></span><span id='topic+superdiagPlot.mcmc'></span><span id='topic+superdiagPlot.mcmc.list'></span>

<h3>Description</h3>

<p>The <code>superdiagPlot</code> function takes <code>mcmc</code> or <code>mcmc.list</code> as input.
It provides summary plots including trace plot(s) and density histogram(s) for
each variable in the MCMC chain(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>superdiagPlot(
  mcmcoutput,
  burnin,
  params,
  title,
  col,
  trace.options,
  density.options,
  title.options
)

## S3 method for class 'mcmc'
superdiagPlot(
  mcmcoutput,
  burnin,
  params = "all",
  title,
  col = c("grey25", "grey75"),
  trace.options = list(trace.axis = TRUE, box = TRUE),
  density.options = list(),
  title.options = list()
)

## S3 method for class 'mcmc.list'
superdiagPlot(
  mcmcoutput,
  burnin,
  params = "all",
  title,
  col,
  trace.options = list(trace.axis = TRUE, box = TRUE),
  density.options = list(),
  title.options = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="superdiagPlot_+3A_mcmcoutput">mcmcoutput</code></td>
<td>
<p>A <code>mcmc</code> or <code>mcmc.list</code> object.</p>
</td></tr>
<tr><td><code id="superdiagPlot_+3A_burnin">burnin</code></td>
<td>
<p>The number of burn-in iterations. Defaults to half of the chain(s).</p>
</td></tr>
<tr><td><code id="superdiagPlot_+3A_params">params</code></td>
<td>
<p>The parameters to be summarized. Defaults to all. Users can specify
a subset of variables by name or index to reduce the size of plots.</p>
</td></tr>
<tr><td><code id="superdiagPlot_+3A_title">title</code></td>
<td>
<p>A character vector specifies the title of the plot.</p>
</td></tr>
<tr><td><code id="superdiagPlot_+3A_col">col</code></td>
<td>
<p>A vector or list specifies the color schemes of the plot. For <code>mcmc</code>
object, the default is a two-color grey scheme; Users can specify any numbers of color
no more than the number of variables. For <code>mcmc.list</code> object, it requires a list
or vector with multiple colors to examine the mixing. The default is a list of two sets
of colors.</p>
</td></tr>
<tr><td><code id="superdiagPlot_+3A_trace.options">trace.options</code></td>
<td>
<p>Additional options for trace plots. It can take arguments as
in <code>plot</code> and <code>lines</code> functions.</p>
</td></tr>
<tr><td><code id="superdiagPlot_+3A_density.options">density.options</code></td>
<td>
<p>Additional options for density histograms. It can take arguments
as in <code>hist</code> (e.g <code>breaks</code>, <code>freq</code>, <code>probability</code>) and <code>barplot</code>
functions.</p>
</td></tr>
<tr><td><code id="superdiagPlot_+3A_title.options">title.options</code></td>
<td>
<p>Additional options for title. It can take arguments as in
<code>mtext</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A summary plot for each variable in the MCMC chain(s).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+superdiag">superdiag</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

data(tobit.list)
summary(tobit.list[1])

# FOR mcmc.list OBJECT
superdiagPlot(tobit.list, burnin=0)

# FOR mcmc OBJECT
superdiagPlot(tobit.list[[1]], burnin=0, col=c("grey25", "dodgerblue"),
  title = "Tobit Model (Chain 1)", title.options=list(cex=1.2))

## End(Not run)

</code></pre>

<hr>
<h2 id='tobit.list'>Data: A <code>mcmc.list</code> from a Tobit model</h2><span id='topic+tobit.list'></span>

<h3>Description</h3>

<p>The data is the output from a Tobit model that was estimated with MCMC techniques.
The estimation was performed with five parallel chains of 50,000 iterations
each and the first 40,000 iterations were discarded.
</p>


<h3>Details</h3>

<p>The R code for the Gibbs sampler is available at <a href="https://jeffgill.org/">https://jeffgill.org/</a>.
</p>


<h3>References</h3>

<p>Gill, Jeff. (2007). <em>Bayesian Methods for the Social and Behavior
Sciences.</em> Second Edition. New York: Chapman &amp; Hall.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
