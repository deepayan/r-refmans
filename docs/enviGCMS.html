<!DOCTYPE html><html><head><title>Help for package enviGCMS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {enviGCMS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#batch'><p>Get the MIR and related information from the files</p></a></li>
<li><a href='#cbmd'><p>Combine two data with similar retention time while different mass range</p></a></li>
<li><a href='#dotpanno'><p>Perform MS/MS dot product annotation for mgf file</p></a></li>
<li><a href='#enviGCMS-deprecated'><p>Deprecated functions in package <span class="pkg">enviGCMS</span>.</p></a></li>
<li><a href='#findline'><p>find line of the regression model for GC-MS</p></a></li>
<li><a href='#findlipid'><p>Find lipid class of metabolites base on referenced Kendrick mass defect</p></a></li>
<li><a href='#findmet'><p>Screen metabolites by Mass Defect</p></a></li>
<li><a href='#findohc'><p>Screen organohalogen compounds by retention time, mass defect analysis and isotope relationship modified by literature report. Also support compounds with [M] and [M+2] ratio cutoff.</p></a></li>
<li><a href='#findpfc'><p>Find PFCs based on mass defect analysis</p></a></li>
<li><a href='#getalign'><p>Align two peaks vectors by mass to charge ratio and/or retention time</p></a></li>
<li><a href='#getalign2'><p>Align mass to charge ratio and/or retention time to remove redundancy</p></a></li>
<li><a href='#getarea'><p>Get the peak information from samples for SCCPs detection</p></a></li>
<li><a href='#getareastd'><p>Get the peak information from SCCPs standards</p></a></li>
<li><a href='#getbgremove'><p>Get the peak list with blank samples' peaks removed</p></a></li>
<li><a href='#getbiotechrep'><p>Get the report for biological replicates.</p></a></li>
<li><a href='#getcompare'><p>Align multiple peaks list to one peak list</p></a></li>
<li><a href='#getcsv'><p>Convert an list object to csv file.</p></a></li>
<li><a href='#getdata'><p>Get xcmsset object in one step with optimized methods.</p></a></li>
<li><a href='#getdata2'><p>Get XCMSnExp object in one step from structured folder path for xcms 3.</p></a></li>
<li><a href='#getdoe'><p>Generate the group level rsd and average intensity based on DoE,</p></a></li>
<li><a href='#getdwtus'><p>Density weighted intensity for one sample</p></a></li>
<li><a href='#getfeaturesanova'><p>Get the features from anova, with p value, q value, rsd and power restriction</p></a></li>
<li><a href='#getfeaturest'><p>Get the features from t test, with p value, q value, rsd and power restriction</p></a></li>
<li><a href='#getfilter'><p>Filter the data based on row and column index</p></a></li>
<li><a href='#getformula'><p>Get chemical formula for mass to charge ratio.</p></a></li>
<li><a href='#getgrouprep'><p>Get the report for samples with biological and technique replicates in different groups</p></a></li>
<li><a href='#getimputation'><p>Impute the peaks list data</p></a></li>
<li><a href='#GetIntegration'><p>GetIntegration was mainly used for get the integration of certain ion's chromatogram data and plot the data</p></a></li>
<li><a href='#Getisotopologues'><p>Get the selected isotopologues at certain MS data</p></a></li>
<li><a href='#getmass'><p>Get the exact mass of the isotopologues from a chemical formula or reaction's isotope patterns with the highest abundances</p></a></li>
<li><a href='#getmassdefect'><p>Get mass defect with certain scaled factor</p></a></li>
<li><a href='#getmd'><p>Import data and return the annotated matrix for GC/LC-MS by m/z range and retention time</p></a></li>
<li><a href='#getmdh'><p>Get the high order unit based Mass Defect</p></a></li>
<li><a href='#getmdr'><p>Get the raw Mass Defect</p></a></li>
<li><a href='#getmr'><p>Get the mzrt profile and group information for batch correction and plot as a list directly from path with default setting</p></a></li>
<li><a href='#getms1anno'><p>Annotation of MS1 data by compounds database by predefined paired mass distance</p></a></li>
<li><a href='#getMSP'><p>read in MSP file as list for ms/ms or ms(EI) annotation</p></a></li>
<li><a href='#getmzrt'><p>Get the mzrt profile and group information as a mzrt list and/or save them as csv or rds for further analysis.</p></a></li>
<li><a href='#getmzrt2'><p>Get the mzrt profile and group information for batch correction and plot as a list for xcms 3 object</p></a></li>
<li><a href='#getmzrtcsv'><p>Covert the peaks list csv file into list</p></a></li>
<li><a href='#getoverlappeak'><p>Get the overlap peaks by mass and retention time range</p></a></li>
<li><a href='#getpn'><p>Merge positive and negative mode data</p></a></li>
<li><a href='#getpower'><p>Get the index with power restriction for certain study with BH adjusted p-value and certain power.</p></a></li>
<li><a href='#getpqsi'><p>Compute pooled QC linear index according to run order</p></a></li>
<li><a href='#getQCraw'><p>get the data of QC compound for a group of data</p></a></li>
<li><a href='#getrangecsv'><p>Get a mzrt list and/or save mz and rt range as csv file.</p></a></li>
<li><a href='#getretcor'><p>Perform peaks list alignment and return features table</p></a></li>
<li><a href='#getrmd'><p>Get the Relative Mass Defect</p></a></li>
<li><a href='#getsccp'><p>Quantitative analysis for short-chain chlorinated paraffins(SCCPs)</p></a></li>
<li><a href='#getsim'><p>output the similarity of two dataset</p></a></li>
<li><a href='#gettechrep'><p>Get the report for technique replicates.</p></a></li>
<li><a href='#gettimegrouprep'><p>Get the time series or two factor DoE report for samples with biological and technique replicates in different groups</p></a></li>
<li><a href='#getupload'><p>Get the csv files from xcmsset/XCMSnExp/list object</p></a></li>
<li><a href='#getupload2'><p>Get the csv files to be submitted to Metaboanalyst</p></a></li>
<li><a href='#getupload3'><p>Get the csv files to be submitted to Metaboanalyst</p></a></li>
<li><a href='#gifmr'><p>plot scatter plot for rt-mz profile and output gif file for multiple groups</p></a></li>
<li><a href='#Integration'><p>Just integrate data according to fixed rt and fixed noise area</p></a></li>
<li><a href='#list'><p>Demo data</p></a></li>
<li><a href='#ma'><p>filter data by average moving box</p></a></li>
<li><a href='#Mode'><p>define the Mode function</p></a></li>
<li><a href='#plotanno'><p>Show MS/MS pmd annotation result</p></a></li>
<li><a href='#plotcc'><p>plot the calibration curve with error bar, r squared and equation.</p></a></li>
<li><a href='#plotden'><p>plot the density for multiple samples</p></a></li>
<li><a href='#plotdwtus'><p>plot density weighted intensity for multiple samples</p></a></li>
<li><a href='#plote'><p>plot EIC and boxplot for all peaks and return diffreport</p></a></li>
<li><a href='#plotgroup'><p>Plot the response group of GC-MS</p></a></li>
<li><a href='#plothist'><p>plot the density of the GC-MS data with EM algorithm to separate the data into two log normal distribution.</p></a></li>
<li><a href='#plothm'><p>Plot the heatmap of mzrt profiles</p></a></li>
<li><a href='#plotint'><p>plot the information of integration</p></a></li>
<li><a href='#plotintslope'><p>plot the slope information of integration</p></a></li>
<li><a href='#plotkms'><p>plot the kendrick mass defect diagram</p></a></li>
<li><a href='#plotmr'><p>plot the scatter plot for peaks list with threshold</p></a></li>
<li><a href='#plotmrc'><p>plot the diff scatter plot for peaks list with threshold between two groups</p></a></li>
<li><a href='#plotms'><p>plot GC/LC-MS data as a heatmap with TIC</p></a></li>
<li><a href='#plotmsrt'><p>Plot EIC of certain m/z and return dataframe for integration</p></a></li>
<li><a href='#plotmz'><p>plot GC/LC-MS data as scatter plot</p></a></li>
<li><a href='#plotpca'><p>plot the PCA for multiple samples</p></a></li>
<li><a href='#plotpeak'><p>plot intensity of peaks across samples or samples across peaks</p></a></li>
<li><a href='#plotridge'><p>plot ridgeline density plot</p></a></li>
<li><a href='#plotridges'><p>Relative Log Abundance Ridge (RLAR) plots for samples or peaks</p></a></li>
<li><a href='#plotrla'><p>Relative Log Abundance (RLA) plots</p></a></li>
<li><a href='#plotrsd'><p>plot the rsd influences of data in different groups</p></a></li>
<li><a href='#plotrtms'><p>Plot mass spectrum of certain retention time and return mass spectrum vector (MSP file) for NIST search</p></a></li>
<li><a href='#plotrug'><p>plot 1-d density for multiple samples</p></a></li>
<li><a href='#plotsms'><p>Plot the intensity distribution of GC-MS</p></a></li>
<li><a href='#plotsub'><p>Plot the background of data</p></a></li>
<li><a href='#plott'><p>plot GC-MS data as a heatmap for constant speed of temperature rising</p></a></li>
<li><a href='#plottic'><p>Plot Total Ion Chromatogram (TIC)</p></a></li>
<li><a href='#qbatch'><p>Get the MIR from the file</p></a></li>
<li><a href='#runMDPlot'><p>Shiny application for interactive mass defect plots analysis</p></a></li>
<li><a href='#runsccp'><p>Shiny application for Short-Chain Chlorinated Paraffins analysis</p></a></li>
<li><a href='#sccp'><p>Short-Chain Chlorinated Paraffins(SCCPs) peaks information for quantitative analysis</p></a></li>
<li><a href='#submd'><p>Get the differences of two GC/LC-MS data</p></a></li>
<li><a href='#svabatch'><p>Plot the influences of DoE and Batch effects on each peaks</p></a></li>
<li><a href='#svacor'><p>Surrogate variable analysis(SVA) to correct the unknown batch effects</p></a></li>
<li><a href='#svadata'><p>Filter the data with p value and q value</p></a></li>
<li><a href='#svapca'><p>Principal component analysis(PCA) for SVA corrected data and raw data</p></a></li>
<li><a href='#svaplot'><p>Filter the data with p value and q value and show them</p></a></li>
<li><a href='#svaupload'><p>Get the corrected data after SVA for metabolanalyst</p></a></li>
<li><a href='#TBBPA'><p>Demo data for TBBPA metabolism in Pumpkin</p></a></li>
<li><a href='#writeMSP'><p>Write MSP file for NIST search</p></a></li>
<li><a href='#xrankanno'><p>Perform MS/MS X rank annotation for mgf file</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>GC/LC-MS Data Analysis for Environmental Science</td>
</tr>
<tr>
<td>Version:</td>
<td>0.7.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Gas/Liquid Chromatography-Mass Spectrometer(GC/LC-MS) Data Analysis for Environmental Science. This package covered topics such molecular isotope ratio, matrix effects and Short-Chain Chlorinated Paraffins analysis etc. in environmental analysis.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/yufree/enviGCMS">https://github.com/yufree/enviGCMS</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/yufree/enviGCMS/issues">https://github.com/yufree/enviGCMS/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, testthat, xcms, MSnbase, plotly, shiny, rmarkdown, DT,
crosstalk</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rdisop, BiocParallel, grDevices, graphics, stats, utils,
methods, animation (&ge; 2.2.3), RColorBrewer, mixtools,
data.table, igraph</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-05 23:31:18 UTC; yufree</td>
</tr>
<tr>
<td>Author:</td>
<td>Miao YU <a href="https://orcid.org/0000-0002-2804-6014"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Thanh Wang <a href="https://orcid.org/0000-0002-5729-1908"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Miao YU &lt;yufreecas@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-06 08:42:34 UTC</td>
</tr>
</table>
<hr>
<h2 id='batch'>Get the MIR and related information from the files</h2><span id='topic+batch'></span>

<h3>Description</h3>

<p>Get the MIR and related information from the files
</p>


<h3>Usage</h3>

<pre><code class='language-R'>batch(file, mz1, mz2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="batch_+3A_file">file</code></td>
<td>
<p>data file, CDF or other format supportted by xcmsRaw</p>
</td></tr>
<tr><td><code id="batch_+3A_mz1">mz1</code></td>
<td>
<p>the lowest mass</p>
</td></tr>
<tr><td><code id="batch_+3A_mz2">mz2</code></td>
<td>
<p>the highest mass</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Molecular isotope ratio
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
mr &lt;- batch(data,mz1 = 79, mz2 = 81)

## End(Not run)
</code></pre>

<hr>
<h2 id='cbmd'>Combine two data with similar retention time while different mass range</h2><span id='topic+cbmd'></span>

<h3>Description</h3>

<p>Combine two data with similar retention time while different mass range
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cbmd(data1, data2, mzstep = 0.1, rtstep = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cbmd_+3A_data1">data1</code></td>
<td>
<p>data file path of lower mass range</p>
</td></tr>
<tr><td><code id="cbmd_+3A_data2">data2</code></td>
<td>
<p>data file path of higher mass range</p>
</td></tr>
<tr><td><code id="cbmd_+3A_mzstep">mzstep</code></td>
<td>
<p>the m/z step for generating matrix data from raw mass spectral data</p>
</td></tr>
<tr><td><code id="cbmd_+3A_rtstep">rtstep</code></td>
<td>
<p>the alignment accuracy of retention time, e.g. 0.01 means the retention times of combined data should be the same at the accuracy 0.01s. Higher rtstep would return less scans for combined data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix with the row as scantime in second and column as m/z
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mz100_200 and mz201_300 were the path to the raw data
matrix &lt;- getmd(mz100_200,mz201_300)

## End(Not run)
</code></pre>

<hr>
<h2 id='dotpanno'>Perform MS/MS dot product annotation for mgf file</h2><span id='topic+dotpanno'></span>

<h3>Description</h3>

<p>Perform MS/MS dot product annotation for mgf file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dotpanno(file, db = NULL, ppm = 10, prems = 1.1, binstep = 1, consinc = 0.6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dotpanno_+3A_file">file</code></td>
<td>
<p>mgf file generated from MS/MS data</p>
</td></tr>
<tr><td><code id="dotpanno_+3A_db">db</code></td>
<td>
<p>database could be list object from 'getMSP'</p>
</td></tr>
<tr><td><code id="dotpanno_+3A_ppm">ppm</code></td>
<td>
<p>mass accuracy, default 10</p>
</td></tr>
<tr><td><code id="dotpanno_+3A_prems">prems</code></td>
<td>
<p>precursor mass range, default 1.1 to include M+H or M-H</p>
</td></tr>
<tr><td><code id="dotpanno_+3A_binstep">binstep</code></td>
<td>
<p>bin step for consin similarity</p>
</td></tr>
<tr><td><code id="dotpanno_+3A_consinc">consinc</code></td>
<td>
<p>consin similarity cutoff for annotation. Default 0.6.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with MSMS annotation results
</p>

<hr>
<h2 id='enviGCMS-deprecated'>Deprecated functions in package <span class="pkg">enviGCMS</span>.</h2><span id='topic+enviGCMS-deprecated'></span>

<h3>Description</h3>

<p>The functions listed below are deprecated and will be defunct in
the near future. When possible, alternative functions with similar
functionality are also mentioned. Help pages for deprecated functions are
available at <code>help("&lt;function&gt;-deprecated")</code>.
</p>

<hr>
<h2 id='findline'>find line of the regression model for GC-MS</h2><span id='topic+findline'></span>

<h3>Description</h3>

<p>find line of the regression model for GC-MS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findline(data, threshold = 2, temp = c(100, 320))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findline_+3A_data">data</code></td>
<td>
<p>imported data matrix of GC-MS</p>
</td></tr>
<tr><td><code id="findline_+3A_threshold">threshold</code></td>
<td>
<p>the threshold of the response (log based 10)</p>
</td></tr>
<tr><td><code id="findline_+3A_temp">temp</code></td>
<td>
<p>the scale of the oven temperature (constant rate)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list linear regression model for the matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data &lt;- getmd(rawdata)
findline(data)

## End(Not run)
</code></pre>

<hr>
<h2 id='findlipid'>Find lipid class of metabolites base on referenced Kendrick mass defect</h2><span id='topic+findlipid'></span>

<h3>Description</h3>

<p>Find lipid class of metabolites base on referenced Kendrick mass defect
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findlipid(list, mode = "pos")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findlipid_+3A_list">list</code></td>
<td>
<p>list with data as peaks list, mz, rt and group information, retention time should be in seconds</p>
</td></tr>
<tr><td><code id="findlipid_+3A_mode">mode</code></td>
<td>
<p>'pos' for positive mode, 'neg' for negative mode and 'none' for neutral mass, only support [M+H] and [M-H] for each mode</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list list with dataframe with the lipid referenced Kendrick mass defect(RKMD) and logical for class
</p>


<h3>References</h3>

<p>Method for the Identification of Lipid Classes Based on Referenced Kendrick Mass Analysis. Lerno LA, German JB, Lebrilla CB. Anal Chem. 2010 May 15;82(10):4236–45.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
RKMD &lt;- findlipid(list)
</code></pre>

<hr>
<h2 id='findmet'>Screen metabolites by Mass Defect</h2><span id='topic+findmet'></span>

<h3>Description</h3>

<p>Screen metabolites by Mass Defect
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findmet(list, mass, mdr = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findmet_+3A_list">list</code></td>
<td>
<p>list with data as peaks list, mz, rt and group information, retention time should be in seconds</p>
</td></tr>
<tr><td><code id="findmet_+3A_mass">mass</code></td>
<td>
<p>mass to charge ratio of specific compounds</p>
</td></tr>
<tr><td><code id="findmet_+3A_mdr">mdr</code></td>
<td>
<p>mass defect range, default 50mDa</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with filtered metabolites mass to charge index of certain compound
</p>

<hr>
<h2 id='findohc'>Screen organohalogen compounds by retention time, mass defect analysis and isotope relationship modified by literature report. Also support compounds with [M] and [M+2] ratio cutoff.</h2><span id='topic+findohc'></span>

<h3>Description</h3>

<p>Screen organohalogen compounds by retention time, mass defect analysis and isotope relationship modified by literature report. Also support compounds with [M] and [M+2] ratio cutoff.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findohc(
  list,
  sf = 78/77.91051,
  step = 0.001,
  stepsd1 = 0.003,
  stepsd2 = 0.005,
  mzc = 700,
  cutoffint = 1000,
  cutoffr = 0.4,
  clustercf = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findohc_+3A_list">list</code></td>
<td>
<p>list with data as peaks list, mz, rt and group information, retention time should be in seconds</p>
</td></tr>
<tr><td><code id="findohc_+3A_sf">sf</code></td>
<td>
<p>scale factor, default 78/77.91051(Br)</p>
</td></tr>
<tr><td><code id="findohc_+3A_step">step</code></td>
<td>
<p>mass defect step, default 0.001</p>
</td></tr>
<tr><td><code id="findohc_+3A_stepsd1">stepsd1</code></td>
<td>
<p>mass defect uncertainty for lower mass, default 0.003</p>
</td></tr>
<tr><td><code id="findohc_+3A_stepsd2">stepsd2</code></td>
<td>
<p>mass defect uncertainty for higher mass, default 0.005</p>
</td></tr>
<tr><td><code id="findohc_+3A_mzc">mzc</code></td>
<td>
<p>threshold of lower mass and higher mass, default 700</p>
</td></tr>
<tr><td><code id="findohc_+3A_cutoffint">cutoffint</code></td>
<td>
<p>the cutoff of intensity, default 1000</p>
</td></tr>
<tr><td><code id="findohc_+3A_cutoffr">cutoffr</code></td>
<td>
<p>the cutoff of [M] and [M+2] ratio, default 0.4</p>
</td></tr>
<tr><td><code id="findohc_+3A_clustercf">clustercf</code></td>
<td>
<p>the cutoff of cluster analysis to separate two different ions groups for retention time, default 10</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with filtered organohalogen compounds
</p>


<h3>References</h3>

<p>Identification of Novel Brominated Compounds in Flame Retarded Plastics Containing TBBPA by Combining Isotope Pattern and Mass Defect Cluster Analysis Ana Ballesteros-Gómez, Joaquín Ballesteros, Xavier Ortiz, Willem Jonker, Rick Helmus, Karl J. Jobst, John R. Parsons, and Eric J. Reiner Environmental Science &amp; Technology 2017 51 (3), 1518-1526 DOI: 10.1021/acs.est.6b03294
</p>

<hr>
<h2 id='findpfc'>Find PFCs based on mass defect analysis</h2><span id='topic+findpfc'></span>

<h3>Description</h3>

<p>Find PFCs based on mass defect analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findpfc(list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findpfc_+3A_list">list</code></td>
<td>
<p>list with data as peaks list, mz, rt and group information, retention time should be in seconds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list list with potential PFCs compounds index
</p>


<h3>References</h3>

<p>Liu, Y.; D’Agostino, L. A.; Qu, G.; Jiang, G.; Martin, J. W. High-Resolution Mass Spectrometry (HRMS) Methods for Nontarget Discovery and Characterization of Poly- and per-Fluoroalkyl Substances (PFASs) in Environmental and Human Samples. TrAC Trends in Analytical Chemistry 2019, 121, 115420.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
pfc &lt;- findpfc(list)
</code></pre>

<hr>
<h2 id='getalign'>Align two peaks vectors by mass to charge ratio and/or retention time</h2><span id='topic+getalign'></span>

<h3>Description</h3>

<p>Align two peaks vectors by mass to charge ratio and/or retention time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getalign(mz1, mz2, rt1 = NULL, rt2 = NULL, ppm = 10, deltart = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getalign_+3A_mz1">mz1</code></td>
<td>
<p>the mass to charge of reference peaks</p>
</td></tr>
<tr><td><code id="getalign_+3A_mz2">mz2</code></td>
<td>
<p>the mass to charge of peaks to be aligned</p>
</td></tr>
<tr><td><code id="getalign_+3A_rt1">rt1</code></td>
<td>
<p>retention time of reference peaks</p>
</td></tr>
<tr><td><code id="getalign_+3A_rt2">rt2</code></td>
<td>
<p>retention time of peaks to be aligned</p>
</td></tr>
<tr><td><code id="getalign_+3A_ppm">ppm</code></td>
<td>
<p>mass accuracy, default 10</p>
</td></tr>
<tr><td><code id="getalign_+3A_deltart">deltart</code></td>
<td>
<p>retention time shift table, default 10 seconds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with aligned peaks table
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mz1 &lt;- c(221.1171, 227.1390, 229.1546, 233.1497, 271.0790 )
mz2 &lt;- c(282.279, 281.113, 227.139, 227.139, 302.207)
rt1 &lt;- c(590.8710, 251.3820, 102.9230, 85.8850, 313.8240)
rt2 &lt;- c(787.08, 160.02, 251.76, 251.76, 220.26)
getalign(mz1,mz2,rt1,rt2)
</code></pre>

<hr>
<h2 id='getalign2'>Align mass to charge ratio and/or retention time to remove redundancy</h2><span id='topic+getalign2'></span>

<h3>Description</h3>

<p>Align mass to charge ratio and/or retention time to remove redundancy
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getalign2(mz, rt, ppm = 5, deltart = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getalign2_+3A_mz">mz</code></td>
<td>
<p>the mass to charge of reference peaks</p>
</td></tr>
<tr><td><code id="getalign2_+3A_rt">rt</code></td>
<td>
<p>retention time of reference peaks</p>
</td></tr>
<tr><td><code id="getalign2_+3A_ppm">ppm</code></td>
<td>
<p>mass accuracy, default 10</p>
</td></tr>
<tr><td><code id="getalign2_+3A_deltart">deltart</code></td>
<td>
<p>retention time shift table, default 10 seconds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>index for
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mz &lt;- c(221.1171, 221.1170, 229.1546, 233.1497, 271.0790 )
rt &lt;- c(590.8710, 587.3820, 102.9230, 85.8850, 313.8240)
getalign2(mz,rt)
</code></pre>

<hr>
<h2 id='getarea'>Get the peak information from samples for SCCPs detection</h2><span id='topic+getarea'></span>

<h3>Description</h3>

<p>Get the peak information from samples for SCCPs detection
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getarea(data, ismz = 323, ppm = 5, rt = NULL, rts = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getarea_+3A_data">data</code></td>
<td>
<p>list from 'xcmsRaw' function</p>
</td></tr>
<tr><td><code id="getarea_+3A_ismz">ismz</code></td>
<td>
<p>internal standards m/z</p>
</td></tr>
<tr><td><code id="getarea_+3A_ppm">ppm</code></td>
<td>
<p>resolution of mass spectrum</p>
</td></tr>
<tr><td><code id="getarea_+3A_rt">rt</code></td>
<td>
<p>retention time range of sccps</p>
</td></tr>
<tr><td><code id="getarea_+3A_rts">rts</code></td>
<td>
<p>retention time range of internal standards</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with peak information
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getareastd">getareastd</a></code>,<code><a href="#topic+getsccp">getsccp</a></code>
</p>

<hr>
<h2 id='getareastd'>Get the peak information from SCCPs standards</h2><span id='topic+getareastd'></span>

<h3>Description</h3>

<p>Get the peak information from SCCPs standards
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getareastd(data = NULL, ismz = 323, ppm = 5, con = 2000, rt = NULL, rts = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getareastd_+3A_data">data</code></td>
<td>
<p>list from 'xcmsRaw' function</p>
</td></tr>
<tr><td><code id="getareastd_+3A_ismz">ismz</code></td>
<td>
<p>internal standards m/z</p>
</td></tr>
<tr><td><code id="getareastd_+3A_ppm">ppm</code></td>
<td>
<p>resolution of mass spectrum</p>
</td></tr>
<tr><td><code id="getareastd_+3A_con">con</code></td>
<td>
<p>concentration of standards</p>
</td></tr>
<tr><td><code id="getareastd_+3A_rt">rt</code></td>
<td>
<p>retention time range of sccps</p>
</td></tr>
<tr><td><code id="getareastd_+3A_rts">rts</code></td>
<td>
<p>retention time range of internal standards</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with peak information
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getarea">getarea</a></code>,<code><a href="#topic+getsccp">getsccp</a></code>
</p>

<hr>
<h2 id='getbgremove'>Get the peak list with blank samples' peaks removed</h2><span id='topic+getbgremove'></span>

<h3>Description</h3>

<p>Get the peak list with blank samples' peaks removed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getbgremove(
  xset,
  method = "medret",
  intensity = "into",
  file = NULL,
  rsdcf = 30,
  inscf = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getbgremove_+3A_xset">xset</code></td>
<td>
<p>the xcmsset object with blank and certain group samples' data</p>
</td></tr>
<tr><td><code id="getbgremove_+3A_method">method</code></td>
<td>
<p>parameter for groupval function</p>
</td></tr>
<tr><td><code id="getbgremove_+3A_intensity">intensity</code></td>
<td>
<p>parameter for groupval function</p>
</td></tr>
<tr><td><code id="getbgremove_+3A_file">file</code></td>
<td>
<p>file name for further annotation, default NULL</p>
</td></tr>
<tr><td><code id="getbgremove_+3A_rsdcf">rsdcf</code></td>
<td>
<p>rsd cutoff for peaks, default 30</p>
</td></tr>
<tr><td><code id="getbgremove_+3A_inscf">inscf</code></td>
<td>
<p>intensity cutoff for peaks, default 1000</p>
</td></tr>
</table>


<h3>Value</h3>

<p>diff report
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file("cdf", package = "faahKO")
xset &lt;- getdata(cdfpath, pmethod = ' ')
getbgremove(xset)

## End(Not run)
</code></pre>

<hr>
<h2 id='getbiotechrep'>Get the report for biological replicates.</h2><span id='topic+getbiotechrep'></span>

<h3>Description</h3>

<p>Get the report for biological replicates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getbiotechrep(
  xset,
  method = "medret",
  intensity = "into",
  file = NULL,
  rsdcf = 30,
  inscf = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getbiotechrep_+3A_xset">xset</code></td>
<td>
<p>the xcmsset object which for all of your technique replicates for bio replicated sample in single group</p>
</td></tr>
<tr><td><code id="getbiotechrep_+3A_method">method</code></td>
<td>
<p>parameter for groupval function</p>
</td></tr>
<tr><td><code id="getbiotechrep_+3A_intensity">intensity</code></td>
<td>
<p>parameter for groupval function</p>
</td></tr>
<tr><td><code id="getbiotechrep_+3A_file">file</code></td>
<td>
<p>file name for further annotation, default NULL</p>
</td></tr>
<tr><td><code id="getbiotechrep_+3A_rsdcf">rsdcf</code></td>
<td>
<p>rsd cutoff for peaks, default 30</p>
</td></tr>
<tr><td><code id="getbiotechrep_+3A_inscf">inscf</code></td>
<td>
<p>intensity cutoff for peaks, default 0</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe with mean, standard deviation and RSD for those technique replicates &amp; biological replicates combined with raw data
</p>

<hr>
<h2 id='getcompare'>Align multiple peaks list to one peak list</h2><span id='topic+getcompare'></span>

<h3>Description</h3>

<p>Align multiple peaks list to one peak list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getcompare(..., index = 1, ppm = 5, deltart = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getcompare_+3A_...">...</code></td>
<td>
<p>peaks list, mzrt objects</p>
</td></tr>
<tr><td><code id="getcompare_+3A_index">index</code></td>
<td>
<p>numeric, the index of reference peaks.</p>
</td></tr>
<tr><td><code id="getcompare_+3A_ppm">ppm</code></td>
<td>
<p>pmd mass accuracy, default 5</p>
</td></tr>
<tr><td><code id="getcompare_+3A_deltart">deltart</code></td>
<td>
<p>retention time shift table, default 10 seconds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list object with aligned mzrt objects
</p>

<hr>
<h2 id='getcsv'>Convert an list object to csv file.</h2><span id='topic+getcsv'></span>

<h3>Description</h3>

<p>Convert an list object to csv file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getcsv(list, name, mzdigit = 4, rtdigit = 1, type = "o", target = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getcsv_+3A_list">list</code></td>
<td>
<p>list with data as peaks list, mz, rt and group information</p>
</td></tr>
<tr><td><code id="getcsv_+3A_name">name</code></td>
<td>
<p>result name for csv and/or eic file, default NULL</p>
</td></tr>
<tr><td><code id="getcsv_+3A_mzdigit">mzdigit</code></td>
<td>
<p>m/z digits of row names of data frame, default 4</p>
</td></tr>
<tr><td><code id="getcsv_+3A_rtdigit">rtdigit</code></td>
<td>
<p>retention time digits of row names of data frame, default 1</p>
</td></tr>
<tr><td><code id="getcsv_+3A_type">type</code></td>
<td>
<p>csv format for further analysis, m means  Metaboanalyst, a means xMSannotator, p means Mummichog(NA values are imputed by 'getimputation', and F test is used here to generate stats and p value), o means full information csv (for 'pmd' package), default o. mapo could output all those format files.</p>
</td></tr>
<tr><td><code id="getcsv_+3A_target">target</code></td>
<td>
<p>logical, preserve original rowname of data or not for target data, default FALSE.</p>
</td></tr>
<tr><td><code id="getcsv_+3A_...">...</code></td>
<td>
<p>other parameters for 'write.table'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL, csv file
</p>


<h3>References</h3>

<p>Li, S.; Park, Y.; Duraisingham, S.; Strobel, F. H.; Khan, N.; Soltow, Q. A.; Jones, D. P.; Pulendran, B. PLOS Computational Biology 2013, 9 (7), e1003123.
Xia, J., Sinelnikov, I.V., Han, B., Wishart, D.S., 2015. MetaboAnalyst 3.0—making metabolomics more meaningful. Nucl. Acids Res. 43, W251–W257.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(list)
getcsv(list,name='demo')

## End(Not run)
</code></pre>

<hr>
<h2 id='getdata'>Get xcmsset object in one step with optimized methods.</h2><span id='topic+getdata'></span>

<h3>Description</h3>

<p>Get xcmsset object in one step with optimized methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getdata(
  path,
  index = FALSE,
  BPPARAM = BiocParallel::SnowParam(),
  pmethod = "hplcorbitrap",
  minfrac = 0.67,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getdata_+3A_path">path</code></td>
<td>
<p>the path to your data</p>
</td></tr>
<tr><td><code id="getdata_+3A_index">index</code></td>
<td>
<p>the index of the files</p>
</td></tr>
<tr><td><code id="getdata_+3A_bpparam">BPPARAM</code></td>
<td>
<p>used for BiocParallel package</p>
</td></tr>
<tr><td><code id="getdata_+3A_pmethod">pmethod</code></td>
<td>
<p>parameters used for different instrumentals such as 'hplcorbitrap', 'uplcorbitrap', 'hplcqtof', 'hplchqtof', 'uplcqtof', 'uplchqtof'. The parameters were from the reference</p>
</td></tr>
<tr><td><code id="getdata_+3A_minfrac">minfrac</code></td>
<td>
<p>minimum fraction of samples necessary in at least one of the sample groups for it to be a valid group, default 0.67</p>
</td></tr>
<tr><td><code id="getdata_+3A_...">...</code></td>
<td>
<p>arguments for xcmsSet function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>the parameters are extracted from the papers. If you use name other than the name above, you will use the default setting of XCMS. Also I suggest IPO packages or apLCMS packages to get reasonable data for your own instrumental. If you want to summit the results to a paper, remember to include those parameters.
</p>


<h3>Value</h3>

<p>a xcmsset object for that path or selected samples
</p>


<h3>References</h3>

<p>Patti, G. J.; Tautenhahn, R.; Siuzdak, G. Nat. Protocols 2012, 7 (3), 508–516.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getdata2">getdata2</a></code>, <code><a href="#topic+getmzrt">getmzrt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file('cdf', package = 'faahKO')
xset &lt;- getdata(cdfpath, pmethod = ' ')

## End(Not run)
</code></pre>

<hr>
<h2 id='getdata2'>Get XCMSnExp object in one step from structured folder path for xcms 3.</h2><span id='topic+getdata2'></span>

<h3>Description</h3>

<p>Get XCMSnExp object in one step from structured folder path for xcms 3.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getdata2(
  path,
  index = FALSE,
  snames = NULL,
  sclass = NULL,
  phenoData = NULL,
  BPPARAM = BiocParallel::SnowParam(),
  mode = "onDisk",
  ppp = xcms::CentWaveParam(ppm = 5, peakwidth = c(5, 25), prefilter = c(3, 5000)),
  rtp = xcms::ObiwarpParam(binSize = 1),
  gpp = xcms::PeakDensityParam(sampleGroups = 1, minFraction = 0.67, bw = 2, binSize =
    0.025),
  fpp = xcms::FillChromPeaksParam()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getdata2_+3A_path">path</code></td>
<td>
<p>the path to your data</p>
</td></tr>
<tr><td><code id="getdata2_+3A_index">index</code></td>
<td>
<p>the index of the files</p>
</td></tr>
<tr><td><code id="getdata2_+3A_snames">snames</code></td>
<td>
<p>sample names. By default the file name without extension is used</p>
</td></tr>
<tr><td><code id="getdata2_+3A_sclass">sclass</code></td>
<td>
<p>sample classes.</p>
</td></tr>
<tr><td><code id="getdata2_+3A_phenodata">phenoData</code></td>
<td>
<p>data.frame or NAnnotatedDataFrame defining the sample names and classes and other sample related properties. If not provided, the argument sclass or the subdirectories in which the samples are stored will be used to specify sample grouping.</p>
</td></tr>
<tr><td><code id="getdata2_+3A_bpparam">BPPARAM</code></td>
<td>
<p>used for BiocParallel package</p>
</td></tr>
<tr><td><code id="getdata2_+3A_mode">mode</code></td>
<td>
<p>'inMemory' or 'onDisk' see &lsquo;?MSnbase::readMSData' for details, default &rsquo;onDisk'</p>
</td></tr>
<tr><td><code id="getdata2_+3A_ppp">ppp</code></td>
<td>
<p>parameters for peaks picking, e.g. xcms::CentWaveParam()</p>
</td></tr>
<tr><td><code id="getdata2_+3A_rtp">rtp</code></td>
<td>
<p>parameters for retention time correction, e.g. xcms::ObiwarpParam()</p>
</td></tr>
<tr><td><code id="getdata2_+3A_gpp">gpp</code></td>
<td>
<p>parameters for peaks grouping, e.g. xcms::PeakDensityParam()</p>
</td></tr>
<tr><td><code id="getdata2_+3A_fpp">fpp</code></td>
<td>
<p>parameters for peaks filling, e.g. xcms::FillChromPeaksParam(), PeakGroupsParam()</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a wrap function for metabolomics data process for xcms 3.
</p>


<h3>Value</h3>

<p>a XCMSnExp object with processed data
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getdata">getdata</a></code>,<code><a href="#topic+getmzrt">getmzrt</a></code>
</p>

<hr>
<h2 id='getdoe'>Generate the group level rsd and average intensity based on DoE,</h2><span id='topic+getdoe'></span>

<h3>Description</h3>

<p>Generate the group level rsd and average intensity based on DoE,
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getdoe(
  list,
  inscf = 5,
  rsdcf = 100,
  rsdcft = 30,
  imputation = "l",
  tr = FALSE,
  BPPARAM = BiocParallel::bpparam()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getdoe_+3A_list">list</code></td>
<td>
<p>list with data as peaks list, mz, rt and group information</p>
</td></tr>
<tr><td><code id="getdoe_+3A_inscf">inscf</code></td>
<td>
<p>Log intensity cutoff for peaks across samples. If any peaks show a intensity higher than the cutoff in any samples, this peaks would not be filtered. default 5</p>
</td></tr>
<tr><td><code id="getdoe_+3A_rsdcf">rsdcf</code></td>
<td>
<p>the rsd cutoff of all peaks in all group</p>
</td></tr>
<tr><td><code id="getdoe_+3A_rsdcft">rsdcft</code></td>
<td>
<p>the rsd cutoff of all peaks in technical replicates</p>
</td></tr>
<tr><td><code id="getdoe_+3A_imputation">imputation</code></td>
<td>
<p>parameters for 'getimputation' function method</p>
</td></tr>
<tr><td><code id="getdoe_+3A_tr">tr</code></td>
<td>
<p>logical. TRUE means dataset with technical replicates at the base level folder</p>
</td></tr>
<tr><td><code id="getdoe_+3A_bpparam">BPPARAM</code></td>
<td>
<p>An optional BiocParallelParam instance determining the parallel back-end to be used during evaluation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with group mean, standard deviation, and relative standard deviation for all peaks, and filtered peaks index
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getdata2">getdata2</a></code>,<code><a href="#topic+getdata">getdata</a></code>, <code><a href="#topic+getmzrt">getmzrt</a></code>, <code><a href="#topic+getimputation">getimputation</a></code>, <code><a href="#topic+getmr">getmr</a></code>,<code><a href="#topic+getpower">getpower</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
getdoe(list)
</code></pre>

<hr>
<h2 id='getdwtus'>Density weighted intensity for one sample</h2><span id='topic+getdwtus'></span>

<h3>Description</h3>

<p>Density weighted intensity for one sample
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getdwtus(peak, n = 512, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getdwtus_+3A_peak">peak</code></td>
<td>
<p>peaks intensity one sample</p>
</td></tr>
<tr><td><code id="getdwtus_+3A_n">n</code></td>
<td>
<p>the number of equally spaced points at which the density is to be estimated, default 512</p>
</td></tr>
<tr><td><code id="getdwtus_+3A_log">log</code></td>
<td>
<p>log transformation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Density weighted intensity for one sample
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
getdwtus(list$data[,1])
</code></pre>

<hr>
<h2 id='getfeaturesanova'>Get the features from anova, with p value, q value, rsd and power restriction</h2><span id='topic+getfeaturesanova'></span>

<h3>Description</h3>

<p>Get the features from anova, with p value, q value, rsd and power restriction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getfeaturesanova(
  list,
  power = 0.8,
  pt = 0.05,
  qt = 0.05,
  n = 3,
  ng = 3,
  rsdcf = 100,
  inscf = 5,
  imputation = "l",
  index = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getfeaturesanova_+3A_list">list</code></td>
<td>
<p>list with data as peaks list, mz, rt and group information (more than two groups)</p>
</td></tr>
<tr><td><code id="getfeaturesanova_+3A_power">power</code></td>
<td>
<p>defined power</p>
</td></tr>
<tr><td><code id="getfeaturesanova_+3A_pt">pt</code></td>
<td>
<p>p value threshold</p>
</td></tr>
<tr><td><code id="getfeaturesanova_+3A_qt">qt</code></td>
<td>
<p>q value threshold, BH adjust</p>
</td></tr>
<tr><td><code id="getfeaturesanova_+3A_n">n</code></td>
<td>
<p>sample numbers in one group</p>
</td></tr>
<tr><td><code id="getfeaturesanova_+3A_ng">ng</code></td>
<td>
<p>group numbers</p>
</td></tr>
<tr><td><code id="getfeaturesanova_+3A_rsdcf">rsdcf</code></td>
<td>
<p>the rsd cutoff of all peaks in all group</p>
</td></tr>
<tr><td><code id="getfeaturesanova_+3A_inscf">inscf</code></td>
<td>
<p>Log intensity cutoff for peaks across samples. If any peaks show a intensity higher than the cutoff in any samples, this peaks would not be filtered. default 5</p>
</td></tr>
<tr><td><code id="getfeaturesanova_+3A_imputation">imputation</code></td>
<td>
<p>parameters for 'getimputation' function method</p>
</td></tr>
<tr><td><code id="getfeaturesanova_+3A_index">index</code></td>
<td>
<p>the index of peaks considered, default NULL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe with peaks fit the setting above
</p>

<hr>
<h2 id='getfeaturest'>Get the features from t test, with p value, q value, rsd and power restriction</h2><span id='topic+getfeaturest'></span>

<h3>Description</h3>

<p>Get the features from t test, with p value, q value, rsd and power restriction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getfeaturest(list, power = 0.8, pt = 0.05, qt = 0.05, n = 3, imputation = "l")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getfeaturest_+3A_list">list</code></td>
<td>
<p>list with data as peaks list, mz, rt and group information (two groups)</p>
</td></tr>
<tr><td><code id="getfeaturest_+3A_power">power</code></td>
<td>
<p>defined power</p>
</td></tr>
<tr><td><code id="getfeaturest_+3A_pt">pt</code></td>
<td>
<p>p value threshold</p>
</td></tr>
<tr><td><code id="getfeaturest_+3A_qt">qt</code></td>
<td>
<p>q value threshold, BH adjust</p>
</td></tr>
<tr><td><code id="getfeaturest_+3A_n">n</code></td>
<td>
<p>sample numbers in one group</p>
</td></tr>
<tr><td><code id="getfeaturest_+3A_imputation">imputation</code></td>
<td>
<p>parameters for 'getimputation' function method</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe with peaks fit the setting above
</p>

<hr>
<h2 id='getfilter'>Filter the data based on row and column index</h2><span id='topic+getfilter'></span>

<h3>Description</h3>

<p>Filter the data based on row and column index
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getfilter(list, rowindex = TRUE, colindex = TRUE, name = NULL, type = "o", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getfilter_+3A_list">list</code></td>
<td>
<p>list with data as peaks list, mz, rt and group information</p>
</td></tr>
<tr><td><code id="getfilter_+3A_rowindex">rowindex</code></td>
<td>
<p>logical, row index to keep</p>
</td></tr>
<tr><td><code id="getfilter_+3A_colindex">colindex</code></td>
<td>
<p>logical, column index to keep</p>
</td></tr>
<tr><td><code id="getfilter_+3A_name">name</code></td>
<td>
<p>file name for csv and/or eic file, default NULL</p>
</td></tr>
<tr><td><code id="getfilter_+3A_type">type</code></td>
<td>
<p>csv format for further analysis, m means  Metaboanalyst, a means xMSannotator, p means Mummichog(NA values are imputed by 'getimputation', and F test is used here to generate stats and p value), o means full information csv (for 'pmd' package), default o. mapo could output all those format files.</p>
</td></tr>
<tr><td><code id="getfilter_+3A_...">...</code></td>
<td>
<p>other parameters for 'getcsv'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with remain peaks, and filtered peaks index
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getdata2">getdata2</a></code>,<code><a href="#topic+getdata">getdata</a></code>, <code><a href="#topic+getmzrt">getmzrt</a></code>, <code><a href="#topic+getimputation">getimputation</a></code>, <code><a href="#topic+getmr">getmr</a></code>, <code><a href="#topic+getcsv">getcsv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
li &lt;- getdoe(list)
lif &lt;- getfilter(li,rowindex = li$rsdindex)
</code></pre>

<hr>
<h2 id='getformula'>Get chemical formula for mass to charge ratio.</h2><span id='topic+getformula'></span>

<h3>Description</h3>

<p>Get chemical formula for mass to charge ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getformula(
  mz,
  charge = 0,
  window = 0.001,
  elements = list(C = c(1, 50), H = c(1, 50), N = c(0, 50), O = c(0, 50), P = c(0, 1), S
    = c(0, 1))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getformula_+3A_mz">mz</code></td>
<td>
<p>a vector with mass to charge ratio</p>
</td></tr>
<tr><td><code id="getformula_+3A_charge">charge</code></td>
<td>
<p>The charge value of the formula, default 0 for autodetect</p>
</td></tr>
<tr><td><code id="getformula_+3A_window">window</code></td>
<td>
<p>The window accuracy in the same units as mass</p>
</td></tr>
<tr><td><code id="getformula_+3A_elements">elements</code></td>
<td>
<p>Elements list to take into account.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with chemical formula
</p>

<hr>
<h2 id='getgrouprep'>Get the report for samples with biological and technique replicates in different groups</h2><span id='topic+getgrouprep'></span>

<h3>Description</h3>

<p>Get the report for samples with biological and technique replicates in different groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getgrouprep(
  xset,
  file = NULL,
  method = "medret",
  intensity = "into",
  rsdcf = 30,
  inscf = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getgrouprep_+3A_xset">xset</code></td>
<td>
<p>the xcmsset object all of samples with technique replicates</p>
</td></tr>
<tr><td><code id="getgrouprep_+3A_file">file</code></td>
<td>
<p>file name for the peaklist to MetaboAnalyst</p>
</td></tr>
<tr><td><code id="getgrouprep_+3A_method">method</code></td>
<td>
<p>parameter for groupval function</p>
</td></tr>
<tr><td><code id="getgrouprep_+3A_intensity">intensity</code></td>
<td>
<p>parameter for groupval function</p>
</td></tr>
<tr><td><code id="getgrouprep_+3A_rsdcf">rsdcf</code></td>
<td>
<p>rsd cutoff for peaks, default 30</p>
</td></tr>
<tr><td><code id="getgrouprep_+3A_inscf">inscf</code></td>
<td>
<p>intensity cutoff for peaks, default 1000</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe with mean, standard deviation and RSD for those technique replicates &amp; biological replicates combined with raw data in different groups if file are defaults NULL.
</p>

<hr>
<h2 id='getimputation'>Impute the peaks list data</h2><span id='topic+getimputation'></span>

<h3>Description</h3>

<p>Impute the peaks list data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getimputation(list, method = "l")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getimputation_+3A_list">list</code></td>
<td>
<p>list with data as peaks list, mz, rt and group information</p>
</td></tr>
<tr><td><code id="getimputation_+3A_method">method</code></td>
<td>
<p>'r' means remove, 'l' means use half the minimum of the values across the peaks list, 'mean' means mean of the values across the samples, 'median' means median of the values across the samples, '0' means 0, '1' means 1. Default 'l'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with imputed peaks
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getdata2">getdata2</a></code>,<code><a href="#topic+getdata">getdata</a></code>, <code><a href="#topic+getmzrt">getmzrt</a></code>,<code><a href="#topic+getdoe">getdoe</a></code>, <code><a href="#topic+getmr">getmr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
getimputation(list)
</code></pre>

<hr>
<h2 id='GetIntegration'>GetIntegration was mainly used for get the integration of certain ion's chromatogram data and plot the data</h2><span id='topic+GetIntegration'></span>

<h3>Description</h3>

<p>GetIntegration was mainly used for get the integration of certain ion's chromatogram data and plot the data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetIntegration(
  data,
  rt = c(8.3, 9),
  n = 5,
  m = 5,
  slope = c(2, 2),
  baseline = 10,
  noslope = TRUE,
  smoothit = TRUE,
  half = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GetIntegration_+3A_data">data</code></td>
<td>
<p>file should be a dataframe with the first column RT and second column intensity of the SIM ions.</p>
</td></tr>
<tr><td><code id="GetIntegration_+3A_rt">rt</code></td>
<td>
<p>a rough RT range contained only one peak to get the area</p>
</td></tr>
<tr><td><code id="GetIntegration_+3A_n">n</code></td>
<td>
<p>points in the moving average smooth box, default value is 5</p>
</td></tr>
<tr><td><code id="GetIntegration_+3A_m">m</code></td>
<td>
<p>numbers of points for regression to get the slope</p>
</td></tr>
<tr><td><code id="GetIntegration_+3A_slope">slope</code></td>
<td>
<p>the threshold value for start/stop peak as percentage of max slope</p>
</td></tr>
<tr><td><code id="GetIntegration_+3A_baseline">baseline</code></td>
<td>
<p>numbers of the points for the baseline of the signal</p>
</td></tr>
<tr><td><code id="GetIntegration_+3A_noslope">noslope</code></td>
<td>
<p>logical, if using a horizon line to get area or not</p>
</td></tr>
<tr><td><code id="GetIntegration_+3A_smoothit">smoothit</code></td>
<td>
<p>logical, if using an average smooth box or not. If using, n will be used</p>
</td></tr>
<tr><td><code id="GetIntegration_+3A_half">half</code></td>
<td>
<p>logical, if using the left half peak to calculate the area</p>
</td></tr>
</table>


<h3>Value</h3>

<p>integration data such as peak area, peak height, signal and the slope data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
list &lt;- GetIntegration(data)

## End(Not run)
</code></pre>

<hr>
<h2 id='Getisotopologues'>Get the selected isotopologues at certain MS data</h2><span id='topic+Getisotopologues'></span>

<h3>Description</h3>

<p>Get the selected isotopologues at certain MS data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Getisotopologues(formula = "C12OH6Br4", charge = 1, width = 0.3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Getisotopologues_+3A_formula">formula</code></td>
<td>
<p>the molecular formula. C12OH6Br4 means BDE-47 as default</p>
</td></tr>
<tr><td><code id="Getisotopologues_+3A_charge">charge</code></td>
<td>
<p>the charge of that molecular. 1 in EI mode as default</p>
</td></tr>
<tr><td><code id="Getisotopologues_+3A_width">width</code></td>
<td>
<p>the width of the peak width on mass spectrum. 0.3 as default for low resolution mass spectrum.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># show isotopologues for BDE-47
Getisotopologues(formula = 'C12OH6Br4')
</code></pre>

<hr>
<h2 id='getmass'>Get the exact mass of the isotopologues from a chemical formula or reaction's isotope patterns with the highest abundances</h2><span id='topic+getmass'></span>

<h3>Description</h3>

<p>Get the exact mass of the isotopologues from a chemical formula or reaction's isotope patterns with the highest abundances
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getmass(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getmass_+3A_data">data</code></td>
<td>
<p>a chemical formula or reaction e.g. 'Cl-H', 'C2H4'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numerical vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getmass('CH2')
</code></pre>

<hr>
<h2 id='getmassdefect'>Get mass defect with certain scaled factor</h2><span id='topic+getmassdefect'></span>

<h3>Description</h3>

<p>Get mass defect with certain scaled factor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getmassdefect(mass, sf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getmassdefect_+3A_mass">mass</code></td>
<td>
<p>vector of mass</p>
</td></tr>
<tr><td><code id="getmassdefect_+3A_sf">sf</code></td>
<td>
<p>scaled factors</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe with mass, scaled mass and scaled mass defect
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotkms">plotkms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mass &lt;- c(100.1022,245.2122,267.3144,400.1222,707.2294)
sf &lt;- 0.9988
mf &lt;- getmassdefect(mass,sf)
</code></pre>

<hr>
<h2 id='getmd'>Import data and return the annotated matrix for GC/LC-MS by m/z range and retention time</h2><span id='topic+getmd'></span>

<h3>Description</h3>

<p>Import data and return the annotated matrix for GC/LC-MS by m/z range and retention time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getmd(data, mzstep = 0.1, mzrange = FALSE, rtrange = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getmd_+3A_data">data</code></td>
<td>
<p>file type which xcmsRaw could handle</p>
</td></tr>
<tr><td><code id="getmd_+3A_mzstep">mzstep</code></td>
<td>
<p>the m/z step for generating matrix data from raw mass spectral data</p>
</td></tr>
<tr><td><code id="getmd_+3A_mzrange">mzrange</code></td>
<td>
<p>vector range of the m/z, default all</p>
</td></tr>
<tr><td><code id="getmd_+3A_rtrange">rtrange</code></td>
<td>
<p>vector range of the retention time, default all</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix with the row as increasing m/z second and column as increasing scantime
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file('cdf', package = 'faahKO')
cdffiles &lt;- list.files(cdfpath, recursive = TRUE, full.names = TRUE)
matrix &lt;- getmd(cdffiles[1])

## End(Not run)
</code></pre>

<hr>
<h2 id='getmdh'>Get the high order unit based Mass Defect</h2><span id='topic+getmdh'></span>

<h3>Description</h3>

<p>Get the high order unit based Mass Defect
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getmdh(mz, cus = c("CH2,H2"), method = "round")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getmdh_+3A_mz">mz</code></td>
<td>
<p>numeric vector for exact mass</p>
</td></tr>
<tr><td><code id="getmdh_+3A_cus">cus</code></td>
<td>
<p>chemical formula or reaction</p>
</td></tr>
<tr><td><code id="getmdh_+3A_method">method</code></td>
<td>
<p>you could use 'round', 'floor' or 'ceiling'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>high order Mass Defect with details
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getmdh(getmass('C2H4'))
</code></pre>

<hr>
<h2 id='getmdr'>Get the raw Mass Defect</h2><span id='topic+getmdr'></span>

<h3>Description</h3>

<p>Get the raw Mass Defect
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getmdr(mz)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getmdr_+3A_mz">mz</code></td>
<td>
<p>numeric vector for exact mass</p>
</td></tr>
</table>


<h3>Value</h3>

<p>raw Mass Defect
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getmdr(getmass('C2H4'))
</code></pre>

<hr>
<h2 id='getmr'>Get the mzrt profile and group information for batch correction and plot as a list directly from path with default setting</h2><span id='topic+getmr'></span>

<h3>Description</h3>

<p>Get the mzrt profile and group information for batch correction and plot as a list directly from path with default setting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getmr(
  path,
  index = FALSE,
  BPPARAM = BiocParallel::SnowParam(),
  pmethod = "hplcorbitrap",
  minfrac = 0.67,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getmr_+3A_path">path</code></td>
<td>
<p>the path to your data</p>
</td></tr>
<tr><td><code id="getmr_+3A_index">index</code></td>
<td>
<p>the index of the files</p>
</td></tr>
<tr><td><code id="getmr_+3A_bpparam">BPPARAM</code></td>
<td>
<p>used for BiocParallel package</p>
</td></tr>
<tr><td><code id="getmr_+3A_pmethod">pmethod</code></td>
<td>
<p>parameters used for different instrumentals such as 'hplcorbitrap', 'uplcorbitrap', 'hplcqtof', 'hplchqtof', 'uplcqtof', 'uplchqtof'. The parameters were from the references</p>
</td></tr>
<tr><td><code id="getmr_+3A_minfrac">minfrac</code></td>
<td>
<p>minimum fraction of samples necessary in at least one of the sample groups for it to be a valid group, default 0.67</p>
</td></tr>
<tr><td><code id="getmr_+3A_...">...</code></td>
<td>
<p>arguments for xcmsSet function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with rtmz profile and group infomation
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getdata">getdata</a></code>,<code><a href="#topic+getupload">getupload</a></code>, <code><a href="#topic+getmzrt">getmzrt</a></code>, <code><a href="#topic+getdoe">getdoe</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file('cdf', package = 'faahKO')
list &lt;- getmr(cdfpath, pmethod = ' ')

## End(Not run)
</code></pre>

<hr>
<h2 id='getms1anno'>Annotation of MS1 data by compounds database by predefined paired mass distance</h2><span id='topic+getms1anno'></span>

<h3>Description</h3>

<p>Annotation of MS1 data by compounds database by predefined paired mass distance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getms1anno(pmd, mz, ppm = 10, db = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getms1anno_+3A_pmd">pmd</code></td>
<td>
<p>adducts formula or paired mass distance for ions</p>
</td></tr>
<tr><td><code id="getms1anno_+3A_mz">mz</code></td>
<td>
<p>unknown mass to charge ratios vector</p>
</td></tr>
<tr><td><code id="getms1anno_+3A_ppm">ppm</code></td>
<td>
<p>mass accuracy</p>
</td></tr>
<tr><td><code id="getms1anno_+3A_db">db</code></td>
<td>
<p>compounds database as dataframe. Two required columns are name and monoisotopic molecular weight with column names of name and mass</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list or data frame
</p>

<hr>
<h2 id='getMSP'>read in MSP file as list for ms/ms or ms(EI) annotation</h2><span id='topic+getMSP'></span>

<h3>Description</h3>

<p>read in MSP file as list for ms/ms or ms(EI) annotation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMSP(file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getMSP_+3A_file">file</code></td>
<td>
<p>the path to your MSP file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list a list with MSP information for annotation
</p>

<hr>
<h2 id='getmzrt'>Get the mzrt profile and group information as a mzrt list and/or save them as csv or rds for further analysis.</h2><span id='topic+getmzrt'></span>

<h3>Description</h3>

<p>Get the mzrt profile and group information as a mzrt list and/or save them as csv or rds for further analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getmzrt(
  xset,
  name = NULL,
  mzdigit = 4,
  rtdigit = 1,
  method = "medret",
  value = "into",
  eic = FALSE,
  type = "o"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getmzrt_+3A_xset">xset</code></td>
<td>
<p>xcmsSet/XCMSnExp objects</p>
</td></tr>
<tr><td><code id="getmzrt_+3A_name">name</code></td>
<td>
<p>file name for csv and/or eic file, default NULL</p>
</td></tr>
<tr><td><code id="getmzrt_+3A_mzdigit">mzdigit</code></td>
<td>
<p>m/z digits of row names of data frame, default 4</p>
</td></tr>
<tr><td><code id="getmzrt_+3A_rtdigit">rtdigit</code></td>
<td>
<p>retention time digits of row names of data frame, default 1</p>
</td></tr>
<tr><td><code id="getmzrt_+3A_method">method</code></td>
<td>
<p>parameter for groupval or featureDefinitions function, default medret</p>
</td></tr>
<tr><td><code id="getmzrt_+3A_value">value</code></td>
<td>
<p>parameter for groupval or featureDefinitions function, default into</p>
</td></tr>
<tr><td><code id="getmzrt_+3A_eic">eic</code></td>
<td>
<p>logical, save xcmsSet and xcmsEIC objects for further investigation with the same name of files, you will need raw files in the same directory as defined in xcmsSet to extract the EIC based on the binned data. You could use &lsquo;plot' to plot EIC for specific peaks. For example, 'plot(xcmsEIC,xcmsSet,groupidx = &rsquo;M123.4567T278.9')' could show the EIC for certain peaks with m/z 206 and retention time 2789. default F</p>
</td></tr>
<tr><td><code id="getmzrt_+3A_type">type</code></td>
<td>
<p>csv format for further analysis, m means  Metaboanalyst, a means xMSannotator, p means Mummichog(NA values are imputed by 'getimputation', and F test is used here to generate stats and p value), o means full information csv (for 'pmd' package), default o. mapo could output all those format files.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mzrt object, a list with mzrt profile and group information
</p>


<h3>References</h3>

<p>Smith, C.A., Want, E.J., O’Maille, G., Abagyan, R., Siuzdak, G., 2006. XCMS: Processing Mass Spectrometry Data for Metabolite Profiling Using Nonlinear Peak Alignment, Matching, and Identification. Anal. Chem. 78, 779–787.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getdata">getdata</a></code>,<code><a href="#topic+getdata2">getdata2</a></code>, <code><a href="#topic+getdoe">getdoe</a></code>, <code><a href="#topic+getcsv">getcsv</a></code>, <code><a href="#topic+getfilter">getfilter</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file('cdf', package = 'faahKO')
xset &lt;- getdata(cdfpath, pmethod = ' ')
getmzrt(xset, name = 'demo', type = 'mapo')

## End(Not run)
</code></pre>

<hr>
<h2 id='getmzrt2'>Get the mzrt profile and group information for batch correction and plot as a list for xcms 3 object</h2><span id='topic+getmzrt2'></span>

<h3>Description</h3>

<p>Get the mzrt profile and group information for batch correction and plot as a list for xcms 3 object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getmzrt2(xset, name = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getmzrt2_+3A_xset">xset</code></td>
<td>
<p>a XCMSnExp object with processed data</p>
</td></tr>
<tr><td><code id="getmzrt2_+3A_name">name</code></td>
<td>
<p>file name for csv file, default NULL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with rtmz profile and group information
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getdata2">getdata2</a></code>,<code><a href="#topic+getupload2">getupload2</a></code>, <code><a href="#topic+getmzrt">getmzrt</a></code>, <code><a href="#topic+getdoe">getdoe</a></code>,<code><a href="#topic+getmzrtcsv">getmzrtcsv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file('cdf', package = 'faahKO')
xset &lt;- getdata2(cdfpath,
ppp = xcms::MatchedFilterParam(),
rtp = xcms::ObiwarpParam(),
gpp = xcms::PeakDensityParam())
getmzrt2(xset)

## End(Not run)
</code></pre>

<hr>
<h2 id='getmzrtcsv'>Covert the peaks list csv file into list</h2><span id='topic+getmzrtcsv'></span>

<h3>Description</h3>

<p>Covert the peaks list csv file into list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getmzrtcsv(path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getmzrtcsv_+3A_path">path</code></td>
<td>
<p>the path to your csv file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with rtmz profile and group information as the first row
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getmzrt">getmzrt</a></code>
</p>

<hr>
<h2 id='getoverlappeak'>Get the overlap peaks by mass and retention time range</h2><span id='topic+getoverlappeak'></span>

<h3>Description</h3>

<p>Get the overlap peaks by mass and retention time range
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getoverlappeak(list1, list2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getoverlappeak_+3A_list1">list1</code></td>
<td>
<p>list with data as peaks list, mz, rt, mzrange, rtrange and group information to be overlapped</p>
</td></tr>
<tr><td><code id="getoverlappeak_+3A_list2">list2</code></td>
<td>
<p>list with data as peaks list, mz, rt, mzrange, rtrange and group information to overlap</p>
</td></tr>
</table>


<h3>Value</h3>

<p>logical index for list 1's peaks
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getmzrt">getmzrt</a></code>, <code><a href="#topic+getimputation">getimputation</a></code>, <code><a href="#topic+getmr">getmr</a></code>,<code><a href="#topic+getdoe">getdoe</a></code>
</p>

<hr>
<h2 id='getpn'>Merge positive and negative mode data</h2><span id='topic+getpn'></span>

<h3>Description</h3>

<p>Merge positive and negative mode data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getpn(pos, neg, ppm = 5, pmd = 2.02, digits = 2, cutoff = 0.9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getpn_+3A_pos">pos</code></td>
<td>
<p>a list with mzrt profile collected from positive mode. The sample order should match the negative mode.</p>
</td></tr>
<tr><td><code id="getpn_+3A_neg">neg</code></td>
<td>
<p>a list with mzrt profile collected from negative mode.The sample order should match the positive mode.</p>
</td></tr>
<tr><td><code id="getpn_+3A_ppm">ppm</code></td>
<td>
<p>pmd mass accuracy, default 5</p>
</td></tr>
<tr><td><code id="getpn_+3A_pmd">pmd</code></td>
<td>
<p>numeric or numeric vector</p>
</td></tr>
<tr><td><code id="getpn_+3A_digits">digits</code></td>
<td>
<p>mass or mass to charge ratio accuracy for pmd, default 2</p>
</td></tr>
<tr><td><code id="getpn_+3A_cutoff">cutoff</code></td>
<td>
<p>correlation coefficients, default 0.9</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mzrt object with group information from pos mode
</p>

<hr>
<h2 id='getpower'>Get the index with power restriction for certain study with BH adjusted p-value and certain power.</h2><span id='topic+getpower'></span>

<h3>Description</h3>

<p>Get the index with power restriction for certain study with BH adjusted p-value and certain power.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getpower(list, pt = 0.05, qt = 0.05, powert = 0.8, imputation = "l")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getpower_+3A_list">list</code></td>
<td>
<p>list with data as peaks list, mz, rt and group information</p>
</td></tr>
<tr><td><code id="getpower_+3A_pt">pt</code></td>
<td>
<p>p value threshold, default 0.05</p>
</td></tr>
<tr><td><code id="getpower_+3A_qt">qt</code></td>
<td>
<p>q value threshold, BH adjust, default 0.05</p>
</td></tr>
<tr><td><code id="getpower_+3A_powert">powert</code></td>
<td>
<p>power cutoff, default 0.8</p>
</td></tr>
<tr><td><code id="getpower_+3A_imputation">imputation</code></td>
<td>
<p>parameters for 'getimputation' function method</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with current power and sample numbers for each peaks
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getdata2">getdata2</a></code>,<code><a href="#topic+getdata">getdata</a></code>, <code><a href="#topic+getmzrt">getmzrt</a></code>, <code><a href="#topic+getimputation">getimputation</a></code>, <code><a href="#topic+getmr">getmr</a></code>,<code><a href="#topic+getdoe">getdoe</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
getpower(list)
</code></pre>

<hr>
<h2 id='getpqsi'>Compute pooled QC linear index according to run order</h2><span id='topic+getpqsi'></span>

<h3>Description</h3>

<p>Compute pooled QC linear index according to run order
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getpqsi(data, order, n = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getpqsi_+3A_data">data</code></td>
<td>
<p>peaks intensity list with row as peaks and column as samples</p>
</td></tr>
<tr><td><code id="getpqsi_+3A_order">order</code></td>
<td>
<p>run order of pooled QC samples</p>
</td></tr>
<tr><td><code id="getpqsi_+3A_n">n</code></td>
<td>
<p>samples numbers used for linear regression</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector for the peaks proportion with significant changes in linear regression after FDR control.
</p>

<hr>
<h2 id='getQCraw'>get the data of QC compound for a group of data</h2><span id='topic+getQCraw'></span>

<h3>Description</h3>

<p>get the data of QC compound for a group of data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getQCraw(path, mzrange, rtrange, index = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getQCraw_+3A_path">path</code></td>
<td>
<p>data path for your QC samples</p>
</td></tr>
<tr><td><code id="getQCraw_+3A_mzrange">mzrange</code></td>
<td>
<p>mass of the QC compound</p>
</td></tr>
<tr><td><code id="getQCraw_+3A_rtrange">rtrange</code></td>
<td>
<p>retention time of the QC compound</p>
</td></tr>
<tr><td><code id="getQCraw_+3A_index">index</code></td>
<td>
<p>index of the files contained QC compounds, default is all of the compounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>number vector, each number indicate the peak area of that mass and retention time range
</p>

<hr>
<h2 id='getrangecsv'>Get a mzrt list and/or save mz and rt range as csv file.</h2><span id='topic+getrangecsv'></span>

<h3>Description</h3>

<p>Get a mzrt list and/or save mz and rt range as csv file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getrangecsv(list, name, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getrangecsv_+3A_list">list</code></td>
<td>
<p>list with data as peaks list, mz, rt and group information</p>
</td></tr>
<tr><td><code id="getrangecsv_+3A_name">name</code></td>
<td>
<p>result name for csv and/or eic file, default NULL</p>
</td></tr>
<tr><td><code id="getrangecsv_+3A_...">...</code></td>
<td>
<p>other parameters for 'write.table'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL, csv file
</p>

<hr>
<h2 id='getretcor'>Perform peaks list alignment and return features table</h2><span id='topic+getretcor'></span>

<h3>Description</h3>

<p>Perform peaks list alignment and return features table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getretcor(list, ts = 1, ppm = 10, deltart = 5, FUN)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getretcor_+3A_list">list</code></td>
<td>
<p>each element should be a data.frame with mz, rt and ins as m/z, retention time in seconds and intensity of certain peaks.</p>
</td></tr>
<tr><td><code id="getretcor_+3A_ts">ts</code></td>
<td>
<p>template sample index in the list, default 1</p>
</td></tr>
<tr><td><code id="getretcor_+3A_ppm">ppm</code></td>
<td>
<p>mass accuracy, default 10</p>
</td></tr>
<tr><td><code id="getretcor_+3A_deltart">deltart</code></td>
<td>
<p>retention time shift table, default 5 seconds</p>
</td></tr>
<tr><td><code id="getretcor_+3A_fun">FUN</code></td>
<td>
<p>function to deal with multiple aligned peaks from one sample</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mzrt object without group information
</p>

<hr>
<h2 id='getrmd'>Get the Relative Mass Defect</h2><span id='topic+getrmd'></span>

<h3>Description</h3>

<p>Get the Relative Mass Defect
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getrmd(mz)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getrmd_+3A_mz">mz</code></td>
<td>
<p>numeric vector for exact mass</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Relative Mass Defect
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getrmd(getmass('C2H4'))
</code></pre>

<hr>
<h2 id='getsccp'>Quantitative analysis for short-chain chlorinated paraffins(SCCPs)</h2><span id='topic+getsccp'></span>

<h3>Description</h3>

<p>Quantitative analysis for short-chain chlorinated paraffins(SCCPs)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getsccp(
  pathstds,
  pathsample,
  ismz = 323,
  ppm = 5,
  con = 2000,
  rt = NULL,
  rts = NULL,
  log = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getsccp_+3A_pathstds">pathstds</code></td>
<td>
<p>mzxml file path for SCCPs standards</p>
</td></tr>
<tr><td><code id="getsccp_+3A_pathsample">pathsample</code></td>
<td>
<p>mzxml file path for samples</p>
</td></tr>
<tr><td><code id="getsccp_+3A_ismz">ismz</code></td>
<td>
<p>internal standards m/z</p>
</td></tr>
<tr><td><code id="getsccp_+3A_ppm">ppm</code></td>
<td>
<p>resolution of mass spectrum</p>
</td></tr>
<tr><td><code id="getsccp_+3A_con">con</code></td>
<td>
<p>concentration of standards</p>
</td></tr>
<tr><td><code id="getsccp_+3A_rt">rt</code></td>
<td>
<p>retention time range of sccps</p>
</td></tr>
<tr><td><code id="getsccp_+3A_rts">rts</code></td>
<td>
<p>retention time range of internal standards</p>
</td></tr>
<tr><td><code id="getsccp_+3A_log">log</code></td>
<td>
<p>log transformation for response factor</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with peak information
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getareastd">getareastd</a></code>,<code><a href="#topic+getarea">getarea</a></code>
</p>

<hr>
<h2 id='getsim'>output the similarity of two dataset</h2><span id='topic+getsim'></span>

<h3>Description</h3>

<p>output the similarity of two dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getsim(xset1, xset2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getsim_+3A_xset1">xset1</code></td>
<td>
<p>the first dataset</p>
</td></tr>
<tr><td><code id="getsim_+3A_xset2">xset2</code></td>
<td>
<p>the second dateset</p>
</td></tr>
</table>


<h3>Value</h3>

<p>similarity on retention time and rsd 
</p>

<hr>
<h2 id='gettechrep'>Get the report for technique replicates.</h2><span id='topic+gettechrep'></span>

<h3>Description</h3>

<p>Get the report for technique replicates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gettechrep(
  xset,
  method = "medret",
  intensity = "into",
  file = NULL,
  rsdcf = 30,
  inscf = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gettechrep_+3A_xset">xset</code></td>
<td>
<p>the xcmsset object which for all of your technique replicates for one sample</p>
</td></tr>
<tr><td><code id="gettechrep_+3A_method">method</code></td>
<td>
<p>parameter for groupval function</p>
</td></tr>
<tr><td><code id="gettechrep_+3A_intensity">intensity</code></td>
<td>
<p>parameter for groupval function</p>
</td></tr>
<tr><td><code id="gettechrep_+3A_file">file</code></td>
<td>
<p>file name for further annotation, default NULL</p>
</td></tr>
<tr><td><code id="gettechrep_+3A_rsdcf">rsdcf</code></td>
<td>
<p>rsd cutoff for peaks, default 30</p>
</td></tr>
<tr><td><code id="gettechrep_+3A_inscf">inscf</code></td>
<td>
<p>intensity cutoff for peaks, default 1000</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe with mean, standard deviation and RSD for those technique replicates combined with raw data
</p>

<hr>
<h2 id='gettimegrouprep'>Get the time series or two factor DoE report for samples with biological and technique replicates in different groups</h2><span id='topic+gettimegrouprep'></span>

<h3>Description</h3>

<p>Get the time series or two factor DoE report for samples with biological and technique replicates in different groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gettimegrouprep(
  xset,
  file = NULL,
  method = "medret",
  intensity = "into",
  rsdcf = 30,
  inscf = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gettimegrouprep_+3A_xset">xset</code></td>
<td>
<p>the xcmsset object all of samples with technique replicates in time series or two factor DoE</p>
</td></tr>
<tr><td><code id="gettimegrouprep_+3A_file">file</code></td>
<td>
<p>file name for the peaklist to MetaboAnalyst</p>
</td></tr>
<tr><td><code id="gettimegrouprep_+3A_method">method</code></td>
<td>
<p>parameter for groupval function</p>
</td></tr>
<tr><td><code id="gettimegrouprep_+3A_intensity">intensity</code></td>
<td>
<p>parameter for groupval function</p>
</td></tr>
<tr><td><code id="gettimegrouprep_+3A_rsdcf">rsdcf</code></td>
<td>
<p>rsd cutoff for peaks, default 30</p>
</td></tr>
<tr><td><code id="gettimegrouprep_+3A_inscf">inscf</code></td>
<td>
<p>intensity cutoff for peaks, default 1000</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe with time series or two factor DoE mean, standard deviation and RSD for those technique replicates &amp; biological replicates combined with raw data in different groups if file are defaults NULL.
</p>

<hr>
<h2 id='getupload'>Get the csv files from xcmsset/XCMSnExp/list object</h2><span id='topic+getupload'></span>

<h3>Description</h3>

<p>Get the csv files from xcmsset/XCMSnExp/list object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getupload(
  xset,
  method = "medret",
  value = "into",
  name = "Peaklist",
  type = "m",
  mzdigit = 4,
  rtdigit = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getupload_+3A_xset">xset</code></td>
<td>
<p>the xcmsset/XCMSnExp/list object which you want to submitted to Metaboanalyst</p>
</td></tr>
<tr><td><code id="getupload_+3A_method">method</code></td>
<td>
<p>parameter for groupval function</p>
</td></tr>
<tr><td><code id="getupload_+3A_value">value</code></td>
<td>
<p>parameter for groupval function</p>
</td></tr>
<tr><td><code id="getupload_+3A_name">name</code></td>
<td>
<p>file name</p>
</td></tr>
<tr><td><code id="getupload_+3A_type">type</code></td>
<td>
<p>m means  Metaboanalyst, a means xMSannotator, o means full information csv</p>
</td></tr>
<tr><td><code id="getupload_+3A_mzdigit">mzdigit</code></td>
<td>
<p>m/z digits of row names of data frame</p>
</td></tr>
<tr><td><code id="getupload_+3A_rtdigit">rtdigit</code></td>
<td>
<p>retention time digits of row names of data frame</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe with data needed for Metaboanalyst/xMSannotator/pmd if your want to perform local analysis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getdata">getdata</a></code>, <code><a href="#topic+getmzrt">getmzrt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file('cdf', package = 'faahKO')
xset &lt;- getdata(cdfpath, pmethod = ' ')
getupload(xset)

## End(Not run)
</code></pre>

<hr>
<h2 id='getupload2'>Get the csv files to be submitted to Metaboanalyst</h2><span id='topic+getupload2'></span>

<h3>Description</h3>

<p>Get the csv files to be submitted to Metaboanalyst
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getupload2(xset, value = "into", name = "Peaklist")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getupload2_+3A_xset">xset</code></td>
<td>
<p>a XCMSnExp object with processed data which you want to submitted to Metaboanalyst</p>
</td></tr>
<tr><td><code id="getupload2_+3A_value">value</code></td>
<td>
<p>value for 'xcms::featureValues'</p>
</td></tr>
<tr><td><code id="getupload2_+3A_name">name</code></td>
<td>
<p>file name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe with data needed for Metaboanalyst if your want to perform local analysis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getdata2">getdata2</a></code>,<code><a href="#topic+getupload">getupload</a></code>, <code><a href="#topic+getmzrt2">getmzrt2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file('cdf', package = 'faahKO')
xset &lt;- getdata2(cdfpath)
getupload2(xset)

## End(Not run)
</code></pre>

<hr>
<h2 id='getupload3'>Get the csv files to be submitted to Metaboanalyst</h2><span id='topic+getupload3'></span>

<h3>Description</h3>

<p>Get the csv files to be submitted to Metaboanalyst
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getupload3(list, name = "Peaklist")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getupload3_+3A_list">list</code></td>
<td>
<p>list with data as peaks list, mz, rt and group information</p>
</td></tr>
<tr><td><code id="getupload3_+3A_name">name</code></td>
<td>
<p>file name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe with data needed for Metaboanalyst if your want to perform local analysis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getmzrt">getmzrt</a></code>, <code><a href="#topic+getmzrt2">getmzrt2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file('cdf', package = 'faahKO')
xset &lt;- getdata2(cdfpath,
ppp = xcms::MatchedFilterParam(),
rtp = xcms::ObiwarpParam(),
gpp = xcms::PeakDensityParam())
xset &lt;- enviGCMS::getmzrt2(xset)
getupload3(xset)

## End(Not run)
</code></pre>

<hr>
<h2 id='gifmr'>plot scatter plot for rt-mz profile and output gif file for multiple groups</h2><span id='topic+gifmr'></span>

<h3>Description</h3>

<p>plot scatter plot for rt-mz profile and output gif file for multiple groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gifmr(
  list,
  ms = c(100, 500),
  rsdcf = 30,
  inscf = 5,
  imputation = "i",
  name = "test",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gifmr_+3A_list">list</code></td>
<td>
<p>list with data as peaks list, mz, rt and group information</p>
</td></tr>
<tr><td><code id="gifmr_+3A_ms">ms</code></td>
<td>
<p>the mass range to plot the data</p>
</td></tr>
<tr><td><code id="gifmr_+3A_rsdcf">rsdcf</code></td>
<td>
<p>the rsd cutoff of all peaks in all group</p>
</td></tr>
<tr><td><code id="gifmr_+3A_inscf">inscf</code></td>
<td>
<p>Log intensity cutoff for peaks across samples. If any peaks show a intensity higher than the cutoff in any samples, this peaks would not be filtered. default 5</p>
</td></tr>
<tr><td><code id="gifmr_+3A_imputation">imputation</code></td>
<td>
<p>parameters for 'getimputation' function method</p>
</td></tr>
<tr><td><code id="gifmr_+3A_name">name</code></td>
<td>
<p>file name for gif file, default test</p>
</td></tr>
<tr><td><code id="gifmr_+3A_...">...</code></td>
<td>
<p>parameters for 'plot' function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>gif file
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(list)
gifmr(list)

## End(Not run)
</code></pre>

<hr>
<h2 id='Integration'>Just integrate data according to fixed rt and fixed noise area</h2><span id='topic+Integration'></span>

<h3>Description</h3>

<p>Just integrate data according to fixed rt and fixed noise area
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Integration(data, rt = c(8.3, 9), brt = c(8.3, 8.4), smoothit = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Integration_+3A_data">data</code></td>
<td>
<p>file should be a dataframe with the first column RT and second column intensity of the SIM ions.</p>
</td></tr>
<tr><td><code id="Integration_+3A_rt">rt</code></td>
<td>
<p>a rough RT range contained only one peak to get the area</p>
</td></tr>
<tr><td><code id="Integration_+3A_brt">brt</code></td>
<td>
<p>a rough RT range contained only one peak and enough noises to get the area</p>
</td></tr>
<tr><td><code id="Integration_+3A_smoothit">smoothit</code></td>
<td>
<p>logical, if using an average smooth box or not. If using, n will be used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>area integration data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
area &lt;- Integration(data)

## End(Not run)
</code></pre>

<hr>
<h2 id='list'>Demo data</h2><span id='topic+list'></span>

<h3>Description</h3>

<p>Demo data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(list)
</code></pre>


<h3>Format</h3>

<p>A list object with data, mass to charge ratio, retention time and group information. The list is generated from faahKO package by 'getmr' function.
</p>

<hr>
<h2 id='ma'>filter data by average moving box</h2><span id='topic+ma'></span>

<h3>Description</h3>

<p>filter data by average moving box
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ma(x, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ma_+3A_x">x</code></td>
<td>
<p>a vector</p>
</td></tr>
<tr><td><code id="ma_+3A_n">n</code></td>
<td>
<p>A number to identify the size of the moving box.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The filtered data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ma(rnorm(1000),5)
</code></pre>

<hr>
<h2 id='Mode'>define the Mode function</h2><span id='topic+Mode'></span>

<h3>Description</h3>

<p>define the Mode function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Mode(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Mode_+3A_x">x</code></td>
<td>
<p>vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Mode of the vector
</p>

<hr>
<h2 id='plotanno'>Show MS/MS pmd annotation result</h2><span id='topic+plotanno'></span>

<h3>Description</h3>

<p>Show MS/MS pmd annotation result
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotanno(anno, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotanno_+3A_anno">anno</code></td>
<td>
<p>list from MSMS anno function</p>
</td></tr>
<tr><td><code id="plotanno_+3A_...">...</code></td>
<td>
<p>other parameter for plot function</p>
</td></tr>
</table>

<hr>
<h2 id='plotcc'>plot the calibration curve with error bar, r squared and equation.</h2><span id='topic+plotcc'></span>

<h3>Description</h3>

<p>plot the calibration curve with error bar, r squared and equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotcc(x, y, upper, lower = upper, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotcc_+3A_x">x</code></td>
<td>
<p>concentration</p>
</td></tr>
<tr><td><code id="plotcc_+3A_y">y</code></td>
<td>
<p>response</p>
</td></tr>
<tr><td><code id="plotcc_+3A_upper">upper</code></td>
<td>
<p>upper error bar</p>
</td></tr>
<tr><td><code id="plotcc_+3A_lower">lower</code></td>
<td>
<p>lower error bar</p>
</td></tr>
<tr><td><code id="plotcc_+3A_...">...</code></td>
<td>
<p>parameters for 'plot' function</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
plotcc(x,y,upper)

## End(Not run)
</code></pre>

<hr>
<h2 id='plotden'>plot the density for multiple samples</h2><span id='topic+plotden'></span>

<h3>Description</h3>

<p>plot the density for multiple samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotden(data, lv, index = NULL, name = NULL, lwd = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotden_+3A_data">data</code></td>
<td>
<p>data row as peaks and column as samples</p>
</td></tr>
<tr><td><code id="plotden_+3A_lv">lv</code></td>
<td>
<p>group information</p>
</td></tr>
<tr><td><code id="plotden_+3A_index">index</code></td>
<td>
<p>index for selected peaks</p>
</td></tr>
<tr><td><code id="plotden_+3A_name">name</code></td>
<td>
<p>name on the figure for samples</p>
</td></tr>
<tr><td><code id="plotden_+3A_lwd">lwd</code></td>
<td>
<p>the line width for density plot, default 1</p>
</td></tr>
<tr><td><code id="plotden_+3A_...">...</code></td>
<td>
<p>parameters for 'plot' function</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
plotden(list$data, lv = as.character(list$group$sample_group),ylim = c(0,1))
</code></pre>

<hr>
<h2 id='plotdwtus'>plot density weighted intensity for multiple samples</h2><span id='topic+plotdwtus'></span>

<h3>Description</h3>

<p>plot density weighted intensity for multiple samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotdwtus(list, n = 512, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotdwtus_+3A_list">list</code></td>
<td>
<p>list with data as peaks list, mz, rt and group information</p>
</td></tr>
<tr><td><code id="plotdwtus_+3A_n">n</code></td>
<td>
<p>the number of equally spaced points at which the density is to be estimated, default 512</p>
</td></tr>
<tr><td><code id="plotdwtus_+3A_...">...</code></td>
<td>
<p>parameters for 'plot' function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Density weighted intensity for multiple samples
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
plotdwtus(list)
</code></pre>

<hr>
<h2 id='plote'>plot EIC and boxplot for all peaks and return diffreport</h2><span id='topic+plote'></span>

<h3>Description</h3>

<p>plot EIC and boxplot for all peaks and return diffreport
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plote(xset, name = "test", test = "t", nonpara = "n", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plote_+3A_xset">xset</code></td>
<td>
<p>xcmsset object</p>
</td></tr>
<tr><td><code id="plote_+3A_name">name</code></td>
<td>
<p>filebase of the sub dir</p>
</td></tr>
<tr><td><code id="plote_+3A_test">test</code></td>
<td>
<p>'t' means two-sample welch t-test, 't.equalvar' means two-sample welch t-test with equal variance, 'wilcoxon' means rank sum wilcoxon test, 'f' means F-test, 'pairt' means paired t test, 'blockf' means Two-way analysis of variance, default 't'</p>
</td></tr>
<tr><td><code id="plote_+3A_nonpara">nonpara</code></td>
<td>
<p>'y' means using nonparametric ranked data, 'n' means original data</p>
</td></tr>
<tr><td><code id="plote_+3A_...">...</code></td>
<td>
<p>other parameters for 'diffreport'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>diffreport and pdf figure for EIC and boxplot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file('cdf', package = 'faahKO')
xset &lt;- getdata(cdfpath, pmethod = ' ')
plote(xset)

## End(Not run)
</code></pre>

<hr>
<h2 id='plotgroup'>Plot the response group of GC-MS</h2><span id='topic+plotgroup'></span>

<h3>Description</h3>

<p>Plot the response group of GC-MS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotgroup(data, threshold = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotgroup_+3A_data">data</code></td>
<td>
<p>imported data matrix of GC-MS</p>
</td></tr>
<tr><td><code id="plotgroup_+3A_threshold">threshold</code></td>
<td>
<p>the threshold of the response (log based 10) to separate the group</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list linear regression model for the data matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data &lt;- getmd(rawdata)
plotgroup(data)

## End(Not run)
</code></pre>

<hr>
<h2 id='plothist'>plot the density of the GC-MS data with EM algorithm to separate the data into two log normal distribution.</h2><span id='topic+plothist'></span>

<h3>Description</h3>

<p>plot the density of the GC-MS data with EM algorithm to separate the data into two log normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plothist(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plothist_+3A_data">data</code></td>
<td>
<p>imported data matrix of GC-MS</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
matrix &lt;- getmd(rawdata)
plothist(matrix)

## End(Not run)
</code></pre>

<hr>
<h2 id='plothm'>Plot the heatmap of mzrt profiles</h2><span id='topic+plothm'></span>

<h3>Description</h3>

<p>Plot the heatmap of mzrt profiles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plothm(data, lv, index = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plothm_+3A_data">data</code></td>
<td>
<p>data row as peaks and column as samples</p>
</td></tr>
<tr><td><code id="plothm_+3A_lv">lv</code></td>
<td>
<p>group information</p>
</td></tr>
<tr><td><code id="plothm_+3A_index">index</code></td>
<td>
<p>index for selected peaks</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
plothm(list$data, lv = as.factor(list$group$sample_group))
</code></pre>

<hr>
<h2 id='plotint'>plot the information of integration</h2><span id='topic+plotint'></span>

<h3>Description</h3>

<p>plot the information of integration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotint(list, name = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotint_+3A_list">list</code></td>
<td>
<p>list from getinteagtion</p>
</td></tr>
<tr><td><code id="plotint_+3A_name">name</code></td>
<td>
<p>the title of the plot</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
list &lt;- getinteagtion(rawdata)
plotint(list)

## End(Not run)
</code></pre>

<hr>
<h2 id='plotintslope'>plot the slope information of integration</h2><span id='topic+plotintslope'></span>

<h3>Description</h3>

<p>plot the slope information of integration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotintslope(list, name = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotintslope_+3A_list">list</code></td>
<td>
<p>list from getintegration</p>
</td></tr>
<tr><td><code id="plotintslope_+3A_name">name</code></td>
<td>
<p>the title of the plot</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
list &lt;- getinteragtion(rawdata)
plotintslope(list)

## End(Not run)
</code></pre>

<hr>
<h2 id='plotkms'>plot the kendrick mass defect diagram</h2><span id='topic+plotkms'></span>

<h3>Description</h3>

<p>plot the kendrick mass defect diagram
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotkms(data, cutoff = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotkms_+3A_data">data</code></td>
<td>
<p>vector with the name m/z</p>
</td></tr>
<tr><td><code id="plotkms_+3A_cutoff">cutoff</code></td>
<td>
<p>remove the low intensity</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+getmassdefect">getmassdefect</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
mz &lt;- c(10000,5000,20000,100,40000)
names(mz) &lt;- c(100.1022,245.2122,267.3144,400.1222,707.2294)
plotkms(mz)

## End(Not run)
</code></pre>

<hr>
<h2 id='plotmr'>plot the scatter plot for peaks list with threshold</h2><span id='topic+plotmr'></span>

<h3>Description</h3>

<p>plot the scatter plot for peaks list with threshold
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotmr(
  list,
  rt = NULL,
  ms = NULL,
  inscf = 5,
  rsdcf = 30,
  imputation = "l",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotmr_+3A_list">list</code></td>
<td>
<p>list with data as peaks list, mz, rt and group information</p>
</td></tr>
<tr><td><code id="plotmr_+3A_rt">rt</code></td>
<td>
<p>vector range of the retention time</p>
</td></tr>
<tr><td><code id="plotmr_+3A_ms">ms</code></td>
<td>
<p>vector vector range of the m/z</p>
</td></tr>
<tr><td><code id="plotmr_+3A_inscf">inscf</code></td>
<td>
<p>Log intensity cutoff for peaks across samples. If any peaks show a intensity higher than the cutoff in any samples, this peaks would not be filtered. default 5</p>
</td></tr>
<tr><td><code id="plotmr_+3A_rsdcf">rsdcf</code></td>
<td>
<p>the rsd cutoff of all peaks in all group, default 30</p>
</td></tr>
<tr><td><code id="plotmr_+3A_imputation">imputation</code></td>
<td>
<p>parameters for 'getimputation' function method</p>
</td></tr>
<tr><td><code id="plotmr_+3A_...">...</code></td>
<td>
<p>parameters for 'plot' function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data fit the cutoff
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
plotmr(list)
</code></pre>

<hr>
<h2 id='plotmrc'>plot the diff scatter plot for peaks list with threshold between two groups</h2><span id='topic+plotmrc'></span>

<h3>Description</h3>

<p>plot the diff scatter plot for peaks list with threshold between two groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotmrc(list, ms = c(100, 800), inscf = 5, rsdcf = 30, imputation = "l", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotmrc_+3A_list">list</code></td>
<td>
<p>list with data as peaks list, mz, rt and group information</p>
</td></tr>
<tr><td><code id="plotmrc_+3A_ms">ms</code></td>
<td>
<p>the mass range to plot the data</p>
</td></tr>
<tr><td><code id="plotmrc_+3A_inscf">inscf</code></td>
<td>
<p>Log intensity cutoff for peaks across samples. If any peaks show a intensity higher than the cutoff in any samples, this peaks would not be filtered. default 5</p>
</td></tr>
<tr><td><code id="plotmrc_+3A_rsdcf">rsdcf</code></td>
<td>
<p>the rsd cutoff of all peaks in all group</p>
</td></tr>
<tr><td><code id="plotmrc_+3A_imputation">imputation</code></td>
<td>
<p>parameters for 'getimputation' function method</p>
</td></tr>
<tr><td><code id="plotmrc_+3A_...">...</code></td>
<td>
<p>parameters for 'plot' function</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
plotmrc(list)
</code></pre>

<hr>
<h2 id='plotms'>plot GC/LC-MS data as a heatmap with TIC</h2><span id='topic+plotms'></span>

<h3>Description</h3>

<p>plot GC/LC-MS data as a heatmap with TIC
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotms(data, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotms_+3A_data">data</code></td>
<td>
<p>imported data matrix of GC-MS</p>
</td></tr>
<tr><td><code id="plotms_+3A_log">log</code></td>
<td>
<p>transform the intensity into log based 10</p>
</td></tr>
</table>


<h3>Value</h3>

<p>heatmap
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file('cdf', package = 'faahKO')
cdffiles &lt;- list.files(cdfpath, recursive = TRUE, full.names = TRUE)
matrix &lt;- getmd(cdffiles[1])
png('test.png')
plotms(matrix)
dev.off()

## End(Not run)
</code></pre>

<hr>
<h2 id='plotmsrt'>Plot EIC of certain m/z and return dataframe for integration</h2><span id='topic+plotmsrt'></span>

<h3>Description</h3>

<p>Plot EIC of certain m/z and return dataframe for integration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotmsrt(data, ms, rt, n = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotmsrt_+3A_data">data</code></td>
<td>
<p>imported data matrix of GC-MS</p>
</td></tr>
<tr><td><code id="plotmsrt_+3A_ms">ms</code></td>
<td>
<p>m/z to be extracted</p>
</td></tr>
<tr><td><code id="plotmsrt_+3A_rt">rt</code></td>
<td>
<p>vector range of the retention time</p>
</td></tr>
<tr><td><code id="plotmsrt_+3A_n">n</code></td>
<td>
<p>logical smooth or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe with  with the first column RT and second column intensity of the SIM ions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
matrix &lt;- getmd(rawdata)
plotmsrt(matrix,rt = c(500,1000),ms = 300)

## End(Not run)
</code></pre>

<hr>
<h2 id='plotmz'>plot GC/LC-MS data as scatter plot</h2><span id='topic+plotmz'></span>

<h3>Description</h3>

<p>plot GC/LC-MS data as scatter plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotmz(data, inscf = 5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotmz_+3A_data">data</code></td>
<td>
<p>imported data matrix of GC-MS</p>
</td></tr>
<tr><td><code id="plotmz_+3A_inscf">inscf</code></td>
<td>
<p>Log intensity cutoff for peaks, default 5</p>
</td></tr>
<tr><td><code id="plotmz_+3A_...">...</code></td>
<td>
<p>parameters for 'plot' function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>scatter plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file('cdf', package = 'faahKO')
cdffiles &lt;- list.files(cdfpath, recursive = TRUE, full.names = TRUE)
matrix &lt;- getmd(cdffiles[1])
png('test.png')
plotmz(matrix)
dev.off()

## End(Not run)
</code></pre>

<hr>
<h2 id='plotpca'>plot the PCA for multiple samples</h2><span id='topic+plotpca'></span>

<h3>Description</h3>

<p>plot the PCA for multiple samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotpca(
  data,
  lv = NULL,
  index = NULL,
  center = TRUE,
  scale = TRUE,
  xrange = NULL,
  yrange = NULL,
  pch = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotpca_+3A_data">data</code></td>
<td>
<p>data row as peaks and column as samples</p>
</td></tr>
<tr><td><code id="plotpca_+3A_lv">lv</code></td>
<td>
<p>group information</p>
</td></tr>
<tr><td><code id="plotpca_+3A_index">index</code></td>
<td>
<p>index for selected peaks</p>
</td></tr>
<tr><td><code id="plotpca_+3A_center">center</code></td>
<td>
<p>parameters for PCA</p>
</td></tr>
<tr><td><code id="plotpca_+3A_scale">scale</code></td>
<td>
<p>parameters for scale</p>
</td></tr>
<tr><td><code id="plotpca_+3A_xrange">xrange</code></td>
<td>
<p>x axis range for return samples, default NULL</p>
</td></tr>
<tr><td><code id="plotpca_+3A_yrange">yrange</code></td>
<td>
<p>y axis range for return samples, default NULL</p>
</td></tr>
<tr><td><code id="plotpca_+3A_pch">pch</code></td>
<td>
<p>default pch would be the first character of group information or samples name</p>
</td></tr>
<tr><td><code id="plotpca_+3A_...">...</code></td>
<td>
<p>other parameters for 'plot' function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>if xrange and yrange are not NULL, return file name of all selected samples on 2D score plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
plotpca(list$data, lv = as.character(list$group$sample_group))
</code></pre>

<hr>
<h2 id='plotpeak'>plot intensity of peaks across samples or samples across peaks</h2><span id='topic+plotpeak'></span>

<h3>Description</h3>

<p>plot intensity of peaks across samples or samples across peaks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotpeak(data, lv = NULL, indexx = NULL, indexy = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotpeak_+3A_data">data</code></td>
<td>
<p>matrix</p>
</td></tr>
<tr><td><code id="plotpeak_+3A_lv">lv</code></td>
<td>
<p>factor vector for the column</p>
</td></tr>
<tr><td><code id="plotpeak_+3A_indexx">indexx</code></td>
<td>
<p>index for matrix row</p>
</td></tr>
<tr><td><code id="plotpeak_+3A_indexy">indexy</code></td>
<td>
<p>index for matrix column</p>
</td></tr>
<tr><td><code id="plotpeak_+3A_...">...</code></td>
<td>
<p>parameters for 'title' function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>parallel coordinates plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
# selected peaks across samples
plotpeak(t(list$data), lv = as.factor(c(rep(1,5),rep(2,nrow(list$data)-5))),1:10,1:10)
# selected samples across peaks
plotpeak(list$data, lv = as.factor(list$group$sample_group),1:10,1:10)
</code></pre>

<hr>
<h2 id='plotridge'>plot ridgeline density plot</h2><span id='topic+plotridge'></span>

<h3>Description</h3>

<p>plot ridgeline density plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotridge(data, lv = NULL, indexx = NULL, indexy = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotridge_+3A_data">data</code></td>
<td>
<p>matrix</p>
</td></tr>
<tr><td><code id="plotridge_+3A_lv">lv</code></td>
<td>
<p>factor vector for the column</p>
</td></tr>
<tr><td><code id="plotridge_+3A_indexx">indexx</code></td>
<td>
<p>index for matrix row</p>
</td></tr>
<tr><td><code id="plotridge_+3A_indexy">indexy</code></td>
<td>
<p>index for matrix column</p>
</td></tr>
<tr><td><code id="plotridge_+3A_...">...</code></td>
<td>
<p>parameters for 'title' function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ridgeline density plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
plotridge(t(list$data),indexy=c(1:10),xlab = 'Intensity',ylab = 'peaks')
plotridge(log(list$data),as.factor(list$group$sample_group),xlab = 'Intensity',ylab = 'peaks')
</code></pre>

<hr>
<h2 id='plotridges'>Relative Log Abundance Ridge (RLAR) plots for samples or peaks</h2><span id='topic+plotridges'></span>

<h3>Description</h3>

<p>Relative Log Abundance Ridge (RLAR) plots for samples or peaks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotridges(data, lv, type = "g")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotridges_+3A_data">data</code></td>
<td>
<p>data row as peaks and column as samples</p>
</td></tr>
<tr><td><code id="plotridges_+3A_lv">lv</code></td>
<td>
<p>factor vector for the group information of samples</p>
</td></tr>
<tr><td><code id="plotridges_+3A_type">type</code></td>
<td>
<p>'g' means group median based, other means all samples median based.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Relative Log Abundance Ridge(RLA) plots
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
plotridges(list$data, as.factor(list$group$sample_group))
</code></pre>

<hr>
<h2 id='plotrla'>Relative Log Abundance (RLA) plots</h2><span id='topic+plotrla'></span>

<h3>Description</h3>

<p>Relative Log Abundance (RLA) plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotrla(data, lv, type = "g", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotrla_+3A_data">data</code></td>
<td>
<p>data row as peaks and column as samples</p>
</td></tr>
<tr><td><code id="plotrla_+3A_lv">lv</code></td>
<td>
<p>factor vector for the group information</p>
</td></tr>
<tr><td><code id="plotrla_+3A_type">type</code></td>
<td>
<p>'g' means group median based, other means all samples median based.</p>
</td></tr>
<tr><td><code id="plotrla_+3A_...">...</code></td>
<td>
<p>parameters for boxplot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Relative Log Abundance (RLA) plots
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
plotrla(list$data, as.factor(list$group$sample_group))
</code></pre>

<hr>
<h2 id='plotrsd'>plot the rsd influences of data in different groups</h2><span id='topic+plotrsd'></span>

<h3>Description</h3>

<p>plot the rsd influences of data in different groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotrsd(list, ms = c(100, 800), inscf = 5, rsdcf = 100, imputation = "l", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotrsd_+3A_list">list</code></td>
<td>
<p>list with data as peaks list, mz, rt and group information</p>
</td></tr>
<tr><td><code id="plotrsd_+3A_ms">ms</code></td>
<td>
<p>the mass range to plot the data</p>
</td></tr>
<tr><td><code id="plotrsd_+3A_inscf">inscf</code></td>
<td>
<p>Log intensity cutoff for peaks across samples. If any peaks show a intensity higher than the cutoff in any samples, this peaks would not be filtered. default 5</p>
</td></tr>
<tr><td><code id="plotrsd_+3A_rsdcf">rsdcf</code></td>
<td>
<p>the rsd cutoff of all peaks in all group</p>
</td></tr>
<tr><td><code id="plotrsd_+3A_imputation">imputation</code></td>
<td>
<p>parameters for 'getimputation' function method</p>
</td></tr>
<tr><td><code id="plotrsd_+3A_...">...</code></td>
<td>
<p>other parameters for 'plot' function</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
plotrsd(list)
</code></pre>

<hr>
<h2 id='plotrtms'>Plot mass spectrum of certain retention time and return mass spectrum vector (MSP file) for NIST search</h2><span id='topic+plotrtms'></span>

<h3>Description</h3>

<p>Plot mass spectrum of certain retention time and return mass spectrum vector (MSP file) for NIST search
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotrtms(data, rt, ms, msp = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotrtms_+3A_data">data</code></td>
<td>
<p>imported data matrix of GC-MS</p>
</td></tr>
<tr><td><code id="plotrtms_+3A_rt">rt</code></td>
<td>
<p>vector range of the retention time</p>
</td></tr>
<tr><td><code id="plotrtms_+3A_ms">ms</code></td>
<td>
<p>vector range of the m/z</p>
</td></tr>
<tr><td><code id="plotrtms_+3A_msp">msp</code></td>
<td>
<p>logical, return MSP files or not, default False</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot, vector and MSP files for NIST search
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
matrix &lt;- getmd(rawdata)
plotrtms(matrix,rt = c(500,1000),ms = (300,500))

## End(Not run)
</code></pre>

<hr>
<h2 id='plotrug'>plot 1-d density for multiple samples</h2><span id='topic+plotrug'></span>

<h3>Description</h3>

<p>plot 1-d density for multiple samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotrug(data, lv = NULL, indexx = NULL, indexy = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotrug_+3A_data">data</code></td>
<td>
<p>matrix</p>
</td></tr>
<tr><td><code id="plotrug_+3A_lv">lv</code></td>
<td>
<p>factor vector for the column</p>
</td></tr>
<tr><td><code id="plotrug_+3A_indexx">indexx</code></td>
<td>
<p>index for matrix row</p>
</td></tr>
<tr><td><code id="plotrug_+3A_indexy">indexy</code></td>
<td>
<p>index for matrix column</p>
</td></tr>
<tr><td><code id="plotrug_+3A_...">...</code></td>
<td>
<p>parameters for 'title' function</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(list)
plotrug(list$data)
plotrug(log(list$data), lv = as.factor(list$group$sample_group))
</code></pre>

<hr>
<h2 id='plotsms'>Plot the intensity distribution of GC-MS</h2><span id='topic+plotsms'></span>

<h3>Description</h3>

<p>Plot the intensity distribution of GC-MS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotsms(meanmatrix, rsdmatrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotsms_+3A_meanmatrix">meanmatrix</code></td>
<td>
<p>mean data matrix of GC-MS(n=5)</p>
</td></tr>
<tr><td><code id="plotsms_+3A_rsdmatrix">rsdmatrix</code></td>
<td>
<p>standard deviation matrix of GC-MS(n=5)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data1 &lt;- getmd(‘sample1-1’)
data2 &lt;- getmd(‘sample1-2’)
data3 &lt;- getmd(‘sample1-3’)
data4 &lt;- getmd(‘sample1-4’)
data5 &lt;- getmd(‘sample1-5’)
data &lt;- (data1+data2+data3+data4+data5)/5
datasd &lt;- sqrt(((data1-data)^2+(data2-data)^2+(data3-data)^2+(data4-data)^2+(data5-data)^2)/4)
databrsd &lt;- datasd/data
plotsms(meanmatrix,rsdmatrix)

## End(Not run)
</code></pre>

<hr>
<h2 id='plotsub'>Plot the background of data</h2><span id='topic+plotsub'></span>

<h3>Description</h3>

<p>Plot the background of data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotsub(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotsub_+3A_data">data</code></td>
<td>
<p>imported data matrix of GC-MS</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
matrix &lt;- getmd(rawdata)
plotsub(matrix)

## End(Not run)
</code></pre>

<hr>
<h2 id='plott'>plot GC-MS data as a heatmap for constant speed of temperature rising</h2><span id='topic+plott'></span>

<h3>Description</h3>

<p>plot GC-MS data as a heatmap for constant speed of temperature rising
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plott(data, log = FALSE, temp = c(100, 320))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plott_+3A_data">data</code></td>
<td>
<p>imported data matrix of GC-MS</p>
</td></tr>
<tr><td><code id="plott_+3A_log">log</code></td>
<td>
<p>transform the intensity into log based 10</p>
</td></tr>
<tr><td><code id="plott_+3A_temp">temp</code></td>
<td>
<p>temperature range for constant speed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>heatmap
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
matrix &lt;- getmd(rawdata)
plott(matrix)

## End(Not run)
</code></pre>

<hr>
<h2 id='plottic'>Plot Total Ion Chromatogram (TIC)</h2><span id='topic+plottic'></span>

<h3>Description</h3>

<p>Plot Total Ion Chromatogram (TIC)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plottic(data, n = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plottic_+3A_data">data</code></td>
<td>
<p>imported data matrix of GC-MS</p>
</td></tr>
<tr><td><code id="plottic_+3A_n">n</code></td>
<td>
<p>logical smooth or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
matrix &lt;- getmd(rawdata)
plottic(matrix)

## End(Not run)
</code></pre>

<hr>
<h2 id='qbatch'>Get the MIR from the file</h2><span id='topic+qbatch'></span>

<h3>Description</h3>

<p>Get the MIR from the file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qbatch(file, mz1, mz2, rt = c(8.65, 8.74), brt = c(8.74, 8.85))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qbatch_+3A_file">file</code></td>
<td>
<p>data file, CDF or other format supportted by xcmsRaw</p>
</td></tr>
<tr><td><code id="qbatch_+3A_mz1">mz1</code></td>
<td>
<p>the lowest mass</p>
</td></tr>
<tr><td><code id="qbatch_+3A_mz2">mz2</code></td>
<td>
<p>the highest mass</p>
</td></tr>
<tr><td><code id="qbatch_+3A_rt">rt</code></td>
<td>
<p>a rough RT range contained only one peak to get the area</p>
</td></tr>
<tr><td><code id="qbatch_+3A_brt">brt</code></td>
<td>
<p>a rough RT range contained only one peak and enough noises to get the area</p>
</td></tr>
</table>


<h3>Value</h3>

<p>arearatio
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
arearatio &lt;- qbatch(datafile)

## End(Not run)
</code></pre>

<hr>
<h2 id='runMDPlot'>Shiny application for interactive mass defect plots analysis</h2><span id='topic+runMDPlot'></span>

<h3>Description</h3>

<p>Shiny application for interactive mass defect plots analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runMDPlot()
</code></pre>

<hr>
<h2 id='runsccp'>Shiny application for Short-Chain Chlorinated Paraffins analysis</h2><span id='topic+runsccp'></span>

<h3>Description</h3>

<p>Shiny application for Short-Chain Chlorinated Paraffins analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runsccp()
</code></pre>

<hr>
<h2 id='sccp'>Short-Chain Chlorinated Paraffins(SCCPs) peaks information for quantitative analysis</h2><span id='topic+sccp'></span>

<h3>Description</h3>

<p>A dataset containing the ions, formula, Cl
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sccp)
</code></pre>


<h3>Format</h3>

<p>A data frame with 24 rows and 8 variables:
</p>

<dl>
<dt>Cln</dt><dd><p>Chlorine atom numbers</p>
</dd>
<dt>Cn</dt><dd><p>Carbon atom numbers</p>
</dd>
<dt>formula</dt><dd><p>molecular formula</p>
</dd>
<dt>Hn</dt><dd><p>hydrogen atom numbers</p>
</dd>
<dt>ions</dt><dd><p>[M-Cl]- ions</p>
</dd>
<dt>mz</dt><dd><p>m/z for the isotopologues with highest intensity</p>
</dd>
<dt>intensity</dt><dd><p>abundance of the isotopologues with highest intensity</p>
</dd>
<dt>Clp</dt><dd><p>Chlorine contents</p>
</dd>
</dl>


<hr>
<h2 id='submd'>Get the differences of two GC/LC-MS data</h2><span id='topic+submd'></span>

<h3>Description</h3>

<p>Get the differences of two GC/LC-MS data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>submd(data1, data2, mzstep = 0.1, rtstep = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="submd_+3A_data1">data1</code></td>
<td>
<p>data file path of first data</p>
</td></tr>
<tr><td><code id="submd_+3A_data2">data2</code></td>
<td>
<p>data file path of second data</p>
</td></tr>
<tr><td><code id="submd_+3A_mzstep">mzstep</code></td>
<td>
<p>the m/z step for generating matrix data from raw mass spectral data</p>
</td></tr>
<tr><td><code id="submd_+3A_rtstep">rtstep</code></td>
<td>
<p>the alignment accuracy of retention time, e.g. 0.01 means the retention times of combined data should be the same at the accuracy 0.01s. Higher rtstep would return less scans for combined data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list four matrix with the row as scantime in second and column as m/z, the first matrix refer to data 1, the second matrix refer to data 2, the third matrix refer to data1 - data2 while the fourth refer to data2 - data1, minus values are imputed by 0
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file('cdf', package = 'faahKO')
cdffiles &lt;- list.files(cdfpath, recursive = TRUE, full.names = TRUE)
matrix &lt;- submd(cdffiles[1],cdffiles[7])

## End(Not run)
</code></pre>

<hr>
<h2 id='svabatch'>Plot the influences of DoE and Batch effects on each peaks</h2><span id='topic+svabatch'></span>

<h3>Description</h3>

<p>Plot the influences of DoE and Batch effects on each peaks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svabatch(df, dfsv, dfanova)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svabatch_+3A_df">df</code></td>
<td>
<p>data output from 'svacor' function</p>
</td></tr>
<tr><td><code id="svabatch_+3A_dfsv">dfsv</code></td>
<td>
<p>data output from 'svaplot' function for corrected data</p>
</td></tr>
<tr><td><code id="svabatch_+3A_dfanova">dfanova</code></td>
<td>
<p>data output from 'svaplot' function for raw data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>influences plot
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svacor">svacor</a></code>, <code><a href="#topic+svaplot">svaplot</a></code>, <code><a href="#topic+svapca">svapca</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file("cdf", package = "faahKO")
cdffiles &lt;- list.files(cdfpath, recursive = TRUE, full.names = TRUE)
xset &lt;- xcmsSet(cdffiles)
xset &lt;- group(xset)
xset2 &lt;- retcor(xset, family = "symmetric", plottype = "mdevden")
xset2 &lt;- group(xset2, bw = 10)
xset3 &lt;- fillPeaks(xset2)
df &lt;- svacor(xset3)
dfsv &lt;- svaplot(xset3)
dfanova &lt;- svaplot(xset3, pqvalues = "anova")
svabatch(df,dfsv,dfanova)

## End(Not run)
</code></pre>

<hr>
<h2 id='svacor'>Surrogate variable analysis(SVA) to correct the unknown batch effects</h2><span id='topic+svacor'></span>

<h3>Description</h3>

<p>Surrogate variable analysis(SVA) to correct the unknown batch effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svacor(xset, lv = NULL, method = "medret", intensity = "into")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svacor_+3A_xset">xset</code></td>
<td>
<p>xcmsset object</p>
</td></tr>
<tr><td><code id="svacor_+3A_lv">lv</code></td>
<td>
<p>group information</p>
</td></tr>
<tr><td><code id="svacor_+3A_method">method</code></td>
<td>
<p>parameter for groupval function</p>
</td></tr>
<tr><td><code id="svacor_+3A_intensity">intensity</code></td>
<td>
<p>parameter for groupval function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>this is used for reviesed version of SVA to correct the unknown batch effects
</p>


<h3>Value</h3>

<p>list object with various components such raw data, corrected data, signal part, random errors part, batch part, p-values, q-values, mass, rt, Posterior Probabilities of Surrogate variables and Posterior Probabilities of Mod. If no surrogate variable found, corresponding part would miss.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svapca">svapca</a></code>, <code><a href="#topic+svaplot">svaplot</a></code>, <code><a href="#topic+svabatch">svabatch</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file("cdf", package = "faahKO")
cdffiles &lt;- list.files(cdfpath, recursive = TRUE, full.names = TRUE)
xset &lt;- xcmsSet(cdffiles)
xset &lt;- group(xset)
xset2 &lt;- retcor(xset, family = "symmetric", plottype = "mdevden")
xset2 &lt;- group(xset2, bw = 10)
xset3 &lt;- fillPeaks(xset2)
df &lt;- svacor(xset3)

## End(Not run)
</code></pre>

<hr>
<h2 id='svadata'>Filter the data with p value and q value</h2><span id='topic+svadata'></span>

<h3>Description</h3>

<p>Filter the data with p value and q value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svadata(list, pqvalues = "sv", pt = 0.05, qt = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svadata_+3A_list">list</code></td>
<td>
<p>results from svacor function</p>
</td></tr>
<tr><td><code id="svadata_+3A_pqvalues">pqvalues</code></td>
<td>
<p>method for ANOVA or SVA</p>
</td></tr>
<tr><td><code id="svadata_+3A_pt">pt</code></td>
<td>
<p>threshold for p value, default is 0.05</p>
</td></tr>
<tr><td><code id="svadata_+3A_qt">qt</code></td>
<td>
<p>threshold for q value, default is 0.05</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data, corrected data, mz and retention for filerted data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file("cdf", package = "faahKO")
cdffiles &lt;- list.files(cdfpath, recursive = TRUE, full.names = TRUE)
xset &lt;- xcmsSet(cdffiles)
xset &lt;- group(xset)
xset2 &lt;- retcor(xset, family = "symmetric", plottype = "mdevden")
xset2 &lt;- group(xset2, bw = 10)
xset3 &lt;- fillPeaks(xset2)
df &lt;- svacor(xset3)
svadata(df)

## End(Not run)
</code></pre>

<hr>
<h2 id='svapca'>Principal component analysis(PCA) for SVA corrected data and raw data</h2><span id='topic+svapca'></span>

<h3>Description</h3>

<p>Principal component analysis(PCA) for SVA corrected data and raw data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svapca(list, center = TRUE, scale = TRUE, lv = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svapca_+3A_list">list</code></td>
<td>
<p>results from svacor function</p>
</td></tr>
<tr><td><code id="svapca_+3A_center">center</code></td>
<td>
<p>parameters for PCA</p>
</td></tr>
<tr><td><code id="svapca_+3A_scale">scale</code></td>
<td>
<p>parameters for scale</p>
</td></tr>
<tr><td><code id="svapca_+3A_lv">lv</code></td>
<td>
<p>group information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svacor">svacor</a></code>, <code><a href="#topic+svaplot">svaplot</a></code>, <code><a href="#topic+svabatch">svabatch</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file("cdf", package = "faahKO")
cdffiles &lt;- list.files(cdfpath, recursive = TRUE, full.names = TRUE)
xset &lt;- xcmsSet(cdffiles)
xset &lt;- group(xset)
xset2 &lt;- retcor(xset, family = "symmetric", plottype = "mdevden")
xset2 &lt;- group(xset2, bw = 10)
xset3 &lt;- fillPeaks(xset2)
df &lt;- svacor(xset3)
svapca(df)

## End(Not run)
</code></pre>

<hr>
<h2 id='svaplot'>Filter the data with p value and q value and show them</h2><span id='topic+svaplot'></span>

<h3>Description</h3>

<p>Filter the data with p value and q value and show them
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svaplot(list, pqvalues = "sv", pt = 0.05, qt = 0.05, lv = NULL, index = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svaplot_+3A_list">list</code></td>
<td>
<p>results from svacor function</p>
</td></tr>
<tr><td><code id="svaplot_+3A_pqvalues">pqvalues</code></td>
<td>
<p>method for ANOVA or SVA</p>
</td></tr>
<tr><td><code id="svaplot_+3A_pt">pt</code></td>
<td>
<p>threshold for p value, default is 0.05</p>
</td></tr>
<tr><td><code id="svaplot_+3A_qt">qt</code></td>
<td>
<p>threshold for q value, default is 0.05</p>
</td></tr>
<tr><td><code id="svaplot_+3A_lv">lv</code></td>
<td>
<p>group information</p>
</td></tr>
<tr><td><code id="svaplot_+3A_index">index</code></td>
<td>
<p>index for selected peaks</p>
</td></tr>
</table>


<h3>Value</h3>

<p>heatmap for the data
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svacor">svacor</a></code>, <code><a href="#topic+svapca">svapca</a></code>, <code><a href="#topic+svabatch">svabatch</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file("cdf", package = "faahKO")
cdffiles &lt;- list.files(cdfpath, recursive = TRUE, full.names = TRUE)
xset &lt;- xcmsSet(cdffiles)
xset &lt;- group(xset)
xset2 &lt;- retcor(xset, family = "symmetric", plottype = "mdevden")
xset2 &lt;- group(xset2, bw = 10)
xset3 &lt;- fillPeaks(xset2)
df &lt;- svacor(xset3)
svaplot(df)

## End(Not run)
</code></pre>

<hr>
<h2 id='svaupload'>Get the corrected data after SVA for metabolanalyst</h2><span id='topic+svaupload'></span>

<h3>Description</h3>

<p>Get the corrected data after SVA for metabolanalyst
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svaupload(xset, lv = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svaupload_+3A_xset">xset</code></td>
<td>
<p>xcmsset object</p>
</td></tr>
<tr><td><code id="svaupload_+3A_lv">lv</code></td>
<td>
<p>group information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>csv files for both raw and corrected data for metaboanalyst if SVA could be applied
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(faahKO)
cdfpath &lt;- system.file("cdf", package = "faahKO")
cdffiles &lt;- list.files(cdfpath, recursive = TRUE, full.names = TRUE)
xset &lt;- xcmsSet(cdffiles)
xset &lt;- group(xset)
xset2 &lt;- retcor(xset, family = "symmetric", plottype = "mdevden")
xset2 &lt;- group(xset2, bw = 10)
xset3 &lt;- fillPeaks(xset2)
svaupload(xset3)

## End(Not run)
</code></pre>

<hr>
<h2 id='TBBPA'>Demo data for TBBPA metabolism in Pumpkin</h2><span id='topic+TBBPA'></span>

<h3>Description</h3>

<p>Demo data for TBBPA metabolism in Pumpkin
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(TBBPA)
</code></pre>


<h3>Format</h3>

<p>A list object with data, mass to charge ratio, retention time and group information. Three pumpkin seeding root samples' peaks list is extracted by xcms online.
</p>


<h3>References</h3>

<p>Hou, X., Yu, M., Liu, A., Wang, X., Li, Y., Liu, J., Schnoor, J.L., Jiang, G., 2019. Glycosylation of Tetrabromobisphenol A in Pumpkin. Environ. Sci. Technol. https://doi.org/10.1021/acs.est.9b02122
</p>

<hr>
<h2 id='writeMSP'>Write MSP file for NIST search</h2><span id='topic+writeMSP'></span>

<h3>Description</h3>

<p>Write MSP file for NIST search
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeMSP(list, name = "unknown", sep = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="writeMSP_+3A_list">list</code></td>
<td>
<p>a list with spectra information</p>
</td></tr>
<tr><td><code id="writeMSP_+3A_name">name</code></td>
<td>
<p>name of the compounds</p>
</td></tr>
<tr><td><code id="writeMSP_+3A_sep">sep</code></td>
<td>
<p>numeric or logical the numbers of spectra in each file and FALSE to include all of the spectra in one msp file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>none a MSP file will be created.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
ins &lt;- c(10000,20000,10000,30000,5000)
mz &lt;- c(101,143,189,221,234)
writeMSP(list(list(spectra = cbind.data.frame(mz,ins))), name = 'test')

## End(Not run)
</code></pre>

<hr>
<h2 id='xrankanno'>Perform MS/MS X rank annotation for mgf file</h2><span id='topic+xrankanno'></span>

<h3>Description</h3>

<p>Perform MS/MS X rank annotation for mgf file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xrankanno(file, db = NULL, ppm = 10, prems = 1.1, intc = 0.1, quantile = 0.75)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xrankanno_+3A_file">file</code></td>
<td>
<p>mgf file generated from MS/MS data</p>
</td></tr>
<tr><td><code id="xrankanno_+3A_db">db</code></td>
<td>
<p>database could be list object from 'getms2pmd'</p>
</td></tr>
<tr><td><code id="xrankanno_+3A_ppm">ppm</code></td>
<td>
<p>mass accuracy, default 10</p>
</td></tr>
<tr><td><code id="xrankanno_+3A_prems">prems</code></td>
<td>
<p>precursor mass range, default 1.1 to include M+H or M-H</p>
</td></tr>
<tr><td><code id="xrankanno_+3A_intc">intc</code></td>
<td>
<p>intensity cutoff for peaks. Default 0.1</p>
</td></tr>
<tr><td><code id="xrankanno_+3A_quantile">quantile</code></td>
<td>
<p>X rank quantiles cutoff for annotation. Default 0.75.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with MSMS annotation results
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
