<!DOCTYPE html><html><head><title>Help for package BHTSpack</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BHTSpack}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#abfun'>
<p>package internal function</p></a></li>
<li><a href='#alpha.u'>
<p>package internal function</p></a></li>
<li><a href='#b.u'>
<p>package internal function</p></a></li>
<li><a href='#bhts'>
<p>Bayesian High-Throughput Screening</p></a></li>
<li><a href='#bhts2HTML'>
<p>Convert to HTML</p></a></li>
<li><a href='#BHTSpack-package'>
<p>Bayesian Multi-Plate High-Throughput Screening of Compounds</p></a></li>
<li><a href='#data.create'>
<p>Create Synthetic Data</p></a></li>
<li><a href='#fdr.r'>
<p>package internal function</p></a></li>
<li><a href='#h.pr.u'>
<p>package internal function</p></a></li>
<li><a href='#hatpai.u'>
<p>package internal function</p></a></li>
<li><a href='#ind.u'>
<p>package internal function</p></a></li>
<li><a href='#lambda.u'>
<p>package internal function</p></a></li>
<li><a href='#lg.mu.sig'>
<p>package internal function</p></a></li>
<li><a href='#mu.k.u'>
<p>package internal function</p></a></li>
<li><a href='#nu.u'>
<p>package internal function</p></a></li>
<li><a href='#pai.u'>
<p>package internal function</p></a></li>
<li><a href='#ptrace'>
<p>Trace (ACF) Plots</p></a></li>
<li><a href='#r.fdr'>
<p>Significant Hits</p></a></li>
<li><a href='#sig.k.u'>
<p>package internal function</p></a></li>
<li><a href='#tau.u'>
<p>package internal function</p></a></li>
<li><a href='#z.pr.u'>
<p>package internal function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Multi-Plate High-Throughput Screening of Compounds</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6</td>
</tr>
<tr>
<td>Description:</td>
<td>Can be used for joint identification of candidate compound hits from multiple assays, in drug discovery. This package implements the framework of I. D. Shterev, D. B. Dunson, C. Chan and G. D. Sempowski. "Bayesian Multi-Plate High-Throughput Screening of Compounds", Scientific Reports 8(1):9551, 2018. This project was funded by the Division of Allergy, Immunology, and Transplantation, National Institute of Allergy and Infectious Diseases, National Institutes of Health, Department of Health and Human Services, under contract No. HHSN272201400054C entitled "Adjuvant Discovery For Vaccines Against West Nile Virus and Influenza", awarded to Duke University and lead by Drs. Herman Staats and Soman Abraham.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.3), R2HTML (&ge; 2.3.2), xtable (&ge; 1.8-2)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-02-08 16:02:47 UTC; is33</td>
</tr>
<tr>
<td>Author:</td>
<td>Ivo D. Shterev [aut, cre],
  David B. Dunson [aut],
  Cliburn Chan [aut],
  Gregory D. Sempowski [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ivo D. Shterev &lt;i.shterev@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-02-08 16:30:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='abfun'>
package internal function
</h2><span id='topic+abfun'></span>

<h3>Description</h3>

<p>package internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>abfun(m, v)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="abfun_+3A_m">m</code></td>
<td>

<p>Description
</p>
</td></tr>
<tr><td><code id="abfun_+3A_v">v</code></td>
<td>

<p>Description
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>abfun(0.26, 10^-4)
</code></pre>

<hr>
<h2 id='alpha.u'>
package internal function
</h2><span id='topic+alpha.u'></span>

<h3>Description</h3>

<p>package internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alpha.u(nu, a0, b0, H)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alpha.u_+3A_nu">nu</code></td>
<td>

<p>Description
</p>
</td></tr>
<tr><td><code id="alpha.u_+3A_a0">a0</code></td>
<td>

<p>Description
</p>
</td></tr>
<tr><td><code id="alpha.u_+3A_b0">b0</code></td>
<td>

<p>Description
</p>
</td></tr>
<tr><td><code id="alpha.u_+3A_h">H</code></td>
<td>

<p>Description
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>  M = 5
  H = 10
  a = 10^-6
  b = 10^-6
  nu = lapply(1:M, function(x){rbeta(H, a, b)})
  alpha.u(nu, a, b, H)
</code></pre>

<hr>
<h2 id='b.u'>
package internal function
</h2><span id='topic+b.u'></span>

<h3>Description</h3>

<p>package internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>b.u(hatpai)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="b.u_+3A_hatpai">hatpai</code></td>
<td>

<p>Description
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>pai = 0.5
M = 10
H = 10
K = 5
n = 100

z = abs(rnorm(n))

sigma1 = abs(rnorm(K))
sigma0 = abs(rnorm(K))

mu1 = abs(rnorm(K))
mu0 = abs(rnorm(K))

hk0 = matrix(sample(K, M*H, replace=TRUE), M, H)
hk1 = matrix(sample(K, M*H, replace=TRUE), M, H)

nu.h0 = lapply(1:H, function(x){rbeta(1,5,5)})
nu.h1 = lapply(1:H, function(x){rbeta(1,5,5)})

ph0 = lapply(nu.h0, lambda.u)
ph1 = lapply(nu.h1, lambda.u)

b.u(hatpai.u(z, hk1, hk0, ph1, ph0, sigma1, sigma0, mu1, mu0, pai, H, n))
</code></pre>

<hr>
<h2 id='bhts'>
Bayesian High-Throughput Screening
</h2><span id='topic+bhts'></span>

<h3>Description</h3>

<p>This is the package main function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bhts(Z, iters, H, K, mu00=NULL, mu10=NULL, a.alpha, b.alpha, a.tau, b.tau, 
pnorm=FALSE, s=NULL, store=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhts_+3A_z">Z</code></td>
<td>

<p>A list of compounds.
</p>
</td></tr>
<tr><td><code id="bhts_+3A_iters">iters</code></td>
<td>

<p>Number of iterations to perform.
</p>
</td></tr>
<tr><td><code id="bhts_+3A_h">H</code></td>
<td>

<p>Number of local DP components.
</p>
</td></tr>
<tr><td><code id="bhts_+3A_k">K</code></td>
<td>

<p>Number of global DP components.
</p>
</td></tr>
<tr><td><code id="bhts_+3A_mu00">mu00</code></td>
<td>

<p>Activity level (mean) of non-hit compounds
</p>
</td></tr>
<tr><td><code id="bhts_+3A_mu10">mu10</code></td>
<td>

<p>Activity level (mean) of hit compounds
</p>
</td></tr>
<tr><td><code id="bhts_+3A_a.alpha">a.alpha</code></td>
<td>

<p>Gamma shape parameter specifying local DP concentration prior.
</p>
</td></tr>
<tr><td><code id="bhts_+3A_b.alpha">b.alpha</code></td>
<td>

<p>Gamma rate parameter specifying local DP concentration prior.
</p>
</td></tr>
<tr><td><code id="bhts_+3A_a.tau">a.tau</code></td>
<td>

<p>Gamma shape parameter specifying global DP concentration prior.
</p>
</td></tr>
<tr><td><code id="bhts_+3A_b.tau">b.tau</code></td>
<td>

<p>Gamma rate parameter specifying global DP concentration prior.
</p>
</td></tr>
<tr><td><code id="bhts_+3A_pnorm">pnorm</code></td>
<td>

<p>Plate normalization. If <code class="reqn">TRUE</code>, each plate is normalized 
to zero mean and unit variance, prior to analysis. Default is <code class="reqn">FALSE</code>.
</p>
</td></tr>
<tr><td><code id="bhts_+3A_s">s</code></td>
<td>

<p>Random seed (for reproducibility purposes). Default is <code class="reqn">NULL</code>.
</p>
</td></tr>
<tr><td><code id="bhts_+3A_store">store</code></td>
<td>

<p>If <code class="reqn">TRUE</code>, all samples of certain latent variables are stored in the output object. 
Default is <code class="reqn">FALSE</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a list consisting of the following elements:
</p>
<table>
<tr><td><code>hatpai</code></td>
<td>
<p>A list of vectors of posterior probabilities, 
estimating the probability of a compound being a hit.</p>
</td></tr>
<tr><td><code>dat.store</code></td>
<td>
<p>If <code class="reqn">store=TRUE</code> (default is <code class="reqn">FALSE</code>), 
the output contains a list of <code class="reqn">iters</code><code class="reqn">\times</code><code class="reqn">K</code> matrices 
of samples. Each matrix contains the samples of a separate latent variable. 
At each iteration, the following six variables are stored in a different row
of their corrpsponding matrix, <code class="reqn">(\lambda_{1}^{(0)},\ldots,\lambda_{K}^{(0)})</code>, 
<code class="reqn">(\lambda_{1}^{(1)},\ldots,\lambda_{K}^{(1)})</code>, <code class="reqn">(\mu_{01},\ldots,\mu_{0K})</code>, 
<code class="reqn">(\mu_{11},\ldots,\mu_{1K})</code>, <code class="reqn">(\sigma_{01}^2,\ldots,\sigma_{0K}^2)</code> 
and <code class="reqn">(\sigma_{11}^2,\ldots,\sigma_{1K}^2)</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>  set.seed(1234)
  Nmax = 100
  M = 100
  n = sample(Nmax, M, replace=TRUE)
  Z = lapply(n, function(x){abs(rnorm(x))})
  bhts(Z, iters=100, H=10, K=5, mu00=0, mu10=10, a.alpha=10, b.alpha=5, a.tau=10, b.tau=5)
</code></pre>

<hr>
<h2 id='bhts2HTML'>
Convert to HTML
</h2><span id='topic+bhts2HTML'></span>

<h3>Description</h3>

<p>This function creates an HTML file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bhts2HTML(dat, dir, fname, title=NULL, bgcolor="#BBBBEE")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhts2HTML_+3A_dat">dat</code></td>
<td>

<p>An object which is the output of <code class="reqn">bhts()</code>.
</p>
</td></tr>
<tr><td><code id="bhts2HTML_+3A_dir">dir</code></td>
<td>

<p>Directory in which to store the file.
</p>
</td></tr>
<tr><td><code id="bhts2HTML_+3A_fname">fname</code></td>
<td>

<p>File name.
</p>
</td></tr>
<tr><td><code id="bhts2HTML_+3A_title">title</code></td>
<td>

<p>The title of the html file.
</p>
</td></tr>
<tr><td><code id="bhts2HTML_+3A_bgcolor">bgcolor</code></td>
<td>

<p>Color for the html background.
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'> #See package vignette
</code></pre>

<hr>
<h2 id='BHTSpack-package'>
Bayesian Multi-Plate High-Throughput Screening of Compounds
</h2><span id='topic+BHTSpack-package'></span><span id='topic+BHTSpack'></span>

<h3>Description</h3>

<p>Can be used for joint identification of candidate hits from multiple assays, in drug discovery. This package implements the framework of I. D. Shterev, D. B. Dunson, C. Chan and G. D. Sempowski. &quot;Bayesian Multi Plate High Throughput Screening of Compounds&quot;, arXiv:1709.10041, September 2017. This project was funded by the Division of Allergy, Immunology, and Transplantation, National Institute of Allergy and Infectious Diseases, National Institutes of Health, Department of Health and Human Services, under contract No. HHSN272201400054C entitled &quot;Adjuvant Discovery For Vaccines Against West Nile Virus and Influenza&quot;, awarded to Duke University and lead by Drs. Herman Staats and Soman Abraham.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> BHTSpack</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Bayesian Multi-Plate High-Throughput Screening of Compounds</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.6</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> c(person(c("Ivo", "D."), "Shterev", role = c("aut", "cre"),
              email = "i.shterev@gmail.com"),
              person(c("David", "B."), "Dunson", role = "aut"),
              person("Cliburn", "Chan", role = "aut"),
              person(c("Gregory", "D."), "Sempowski", role = "aut"))</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Can be used for joint identification of candidate compound hits from multiple assays, in drug discovery. This package implements the framework of I. D. Shterev, D. B. Dunson, C. Chan and G. D. Sempowski. "Bayesian Multi-Plate High-Throughput Screening of Compounds", Scientific Reports 8(1):9551, 2018. This project was funded by the Division of Allergy, Immunology, and Transplantation, National Institute of Allergy and Infectious Diseases, National Institutes of Health, Department of Health and Human Services, under contract No. HHSN272201400054C entitled "Adjuvant Discovery For Vaccines Against West Nile Virus and Influenza", awarded to Duke University and lead by Drs. Herman Staats and Soman Abraham.</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 3.2.3), R2HTML (&gt;= 2.3.2), xtable (&gt;= 1.8-2)</td>
</tr>
<tr>
 <td style="text-align: left;">
VignetteBuilder: </td><td style="text-align: left;"> knitr</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> knitr</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Ivo D. Shterev [aut, cre],
  David B. Dunson [aut],
  Cliburn Chan [aut],
  Gregory D. Sempowski [aut]</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Ivo D. Shterev &lt;i.shterev@gmail.com&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
BHTSpack-package        Bayesian Multi-Plate High-Throughput Screening
                        of Compounds
abfun                   package internal function
alpha.u                 package internal function
b.u                     package internal function
bhts                    Bayesian High-Throughput Screening
bhts2HTML               Convert to HTML
data.create             Create Synthetic Data
fdr.r                   package internal function
h.pr.u                  package internal function
hatpai.u                package internal function
ind.u                   package internal function
lambda.u                package internal function
lg.mu.sig               package internal function
mu.k.u                  package internal function
nu.u                    package internal function
pai.u                   package internal function
ptrace                  Trace (ACF) Plots
r.fdr                   Significant Hits
sig.k.u                 package internal function
tau.u                   package internal function
z.pr.u                  package internal function
</pre>


<h3>Author(s)</h3>

<p>I. D. Shterev, D. B. Dunson, C. Chan and G. D. Sempowski
</p>
<p>Maintainer: I. D. Shterev &lt;i.shterev@duke.edu&gt;
</p>


<h3>References</h3>

<p>I. D. Shterev, D. B. Dunson, C. Chan and G. D. Sempowski. 
&quot;Bayesian Multi-Plate High-Throughput Screening of Compounds&quot;. <em>Scientific Reports</em>, 8(1):9551, 2018.
</p>

<hr>
<h2 id='data.create'>
Create Synthetic Data
</h2><span id='topic+data.create'></span>

<h3>Description</h3>

<p>This function generates synthetic compound data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.create(N, nr, nc, M, p, s=NULL, covrow=NULL, covcol=NULL, c=0.0001, mat=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.create_+3A_n">N</code></td>
<td>

<p>Number of compounds per plate.
</p>
</td></tr>
<tr><td><code id="data.create_+3A_nr">nr</code></td>
<td>

<p>Number of plate rows.
</p>
</td></tr>
<tr><td><code id="data.create_+3A_nc">nc</code></td>
<td>

<p>Number of plate columns.
</p>
</td></tr>
<tr><td><code id="data.create_+3A_m">M</code></td>
<td>

<p>Number of plates.
</p>
</td></tr>
<tr><td><code id="data.create_+3A_p">p</code></td>
<td>

<p>Probability of a compound being a hit.
</p>
</td></tr>
<tr><td><code id="data.create_+3A_s">s</code></td>
<td>

<p>Random seed (for reproducibility perposes). Default is <code class="reqn">NULL</code>.
</p>
</td></tr>
<tr><td><code id="data.create_+3A_covrow">covrow</code></td>
<td>

<p>Noise plate row-covariance matrix. Default is <code class="reqn">NULL</code>.
</p>
</td></tr>
<tr><td><code id="data.create_+3A_covcol">covcol</code></td>
<td>

<p>Noise plate column-covariance matrix. Default is <code class="reqn">NULL</code>.
</p>
</td></tr>
<tr><td><code id="data.create_+3A_c">c</code></td>
<td>

<p>Constant for scaling plate noise. Default is <code class="reqn">0.0001</code>.
</p>
</td></tr>
<tr><td><code id="data.create_+3A_mat">mat</code></td>
<td>

<p>Specifies a matrix (<code class="reqn">TRUE</code>) or a vector (<code class="reqn">FALSE</code>) plate format. Default is <code class="reqn">FALSE</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a list consisting of the following elements:
</p>
<table>
<tr><td><code>Z</code></td>
<td>
<p>A list of matrices (<code class="reqn">mat=TRUE</code>) or vectors (<code class="reqn">mat=FALSE</code>) of compounds.</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>A list of compound indicators specifying a hit (<code class="reqn">1</code>) or a non-hit (<code class="reqn">0</code>).</p>
</td></tr>
<tr><td><code>I</code></td>
<td>
<p>A list of compound indicators specifying the muxture component (from <code class="reqn">1</code> to <code class="reqn">K</code>).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'> #See package vignette
</code></pre>

<hr>
<h2 id='fdr.r'>
package internal function
</h2><span id='topic+fdr.r'></span>

<h3>Description</h3>

<p>package internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fdr.r(r, hatpai, fdr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fdr.r_+3A_r">r</code></td>
<td>

<p>Description
</p>
</td></tr>
<tr><td><code id="fdr.r_+3A_hatpai">hatpai</code></td>
<td>

<p>Description
</p>
</td></tr>
<tr><td><code id="fdr.r_+3A_fdr">fdr</code></td>
<td>

<p>Description
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'> #See package vignette
</code></pre>

<hr>
<h2 id='h.pr.u'>
package internal function
</h2><span id='topic+h.pr.u'></span>

<h3>Description</h3>

<p>package internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h.pr.u(z, ih, mu, sigma, pk, K, H, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h.pr.u_+3A_z">z</code></td>
<td>

</td></tr>
<tr><td><code id="h.pr.u_+3A_ih">ih</code></td>
<td>

</td></tr>
<tr><td><code id="h.pr.u_+3A_mu">mu</code></td>
<td>

</td></tr>
<tr><td><code id="h.pr.u_+3A_sigma">sigma</code></td>
<td>

</td></tr>
<tr><td><code id="h.pr.u_+3A_pk">pk</code></td>
<td>

</td></tr>
<tr><td><code id="h.pr.u_+3A_k">K</code></td>
<td>

</td></tr>
<tr><td><code id="h.pr.u_+3A_h">H</code></td>
<td>

</td></tr>
<tr><td><code id="h.pr.u_+3A_n">n</code></td>
<td>

</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>  Nmax = 100
  K = 5
  H = 10
  M = 20
  n = sample(Nmax, M, replace=TRUE)

  z = abs(rnorm(sum(n)))
  mu = abs(rnorm(K))
  sigma = 1/rgamma(n=K, shape=10, rate=10)

  ih = sample(H,sum(n), replace=TRUE)

  pk = lambda.u(rbeta(K, 1, 1))

  h.pr.u(z, ih, mu, sigma, pk, K, H, n)
</code></pre>

<hr>
<h2 id='hatpai.u'>
package internal function
</h2><span id='topic+hatpai.u'></span>

<h3>Description</h3>

<p>package internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hatpai.u(z, hk1, hk0, ph1, ph0, sigma1, sigma0, mu1, mu0, pai, H, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hatpai.u_+3A_z">z</code></td>
<td>

</td></tr>
<tr><td><code id="hatpai.u_+3A_hk1">hk1</code></td>
<td>

</td></tr>
<tr><td><code id="hatpai.u_+3A_hk0">hk0</code></td>
<td>

</td></tr>
<tr><td><code id="hatpai.u_+3A_ph1">ph1</code></td>
<td>

</td></tr>
<tr><td><code id="hatpai.u_+3A_ph0">ph0</code></td>
<td>

</td></tr>
<tr><td><code id="hatpai.u_+3A_sigma1">sigma1</code></td>
<td>

</td></tr>
<tr><td><code id="hatpai.u_+3A_sigma0">sigma0</code></td>
<td>

</td></tr>
<tr><td><code id="hatpai.u_+3A_mu1">mu1</code></td>
<td>

</td></tr>
<tr><td><code id="hatpai.u_+3A_mu0">mu0</code></td>
<td>

</td></tr>
<tr><td><code id="hatpai.u_+3A_pai">pai</code></td>
<td>

</td></tr>
<tr><td><code id="hatpai.u_+3A_h">H</code></td>
<td>

</td></tr>
<tr><td><code id="hatpai.u_+3A_n">n</code></td>
<td>

</td></tr>
</table>


<h3>Value</h3>

<p>value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pai = 0.5
M = 10
H = 10
K = 5
n = 100

z = abs(rnorm(n))

sigma1 = abs(rnorm(K))
sigma0 = abs(rnorm(K))

mu1 = abs(rnorm(K))
mu0 = abs(rnorm(K))

hk0 = matrix(sample(K, M*H, replace=TRUE), M, H)
hk1 = matrix(sample(K, M*H, replace=TRUE), M, H)

nu.h0 = lapply(1:H, function(x){rbeta(1,5,5)})
nu.h1 = lapply(1:H, function(x){rbeta(1,5,5)})

ph0 = lapply(nu.h0, lambda.u)
ph1 = lapply(nu.h1, lambda.u)

hatpai.u(z, hk1, hk0, ph1, ph0, sigma1, sigma0, mu1, mu0, pai, H, n)
</code></pre>

<hr>
<h2 id='ind.u'>
package internal function
</h2><span id='topic+ind.u'></span>

<h3>Description</h3>

<p>package internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ind.u(pr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ind.u_+3A_pr">pr</code></td>
<td>

</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>  Nmax = 100
  K = 5
  H = 10
  M = 20
  n = sample(Nmax, M, replace=TRUE)

  z = abs(rnorm(sum(n)))
  mu = abs(rnorm(K))
  sigma = 1/rgamma(n=K, shape=10, rate=10)

  hk = sample(K,M*H, replace=TRUE)

  ph = as.vector(sapply(1:M, function(x){lambda.u(rbeta(H, 1, 1))}))

  ind.u(z.pr.u(z, hk, mu, sigma, ph, H, n))
</code></pre>

<hr>
<h2 id='lambda.u'>
package internal function
</h2><span id='topic+lambda.u'></span>

<h3>Description</h3>

<p>package internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambda.u(nu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambda.u_+3A_nu">nu</code></td>
<td>

</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>  H = 5
  nu = rbeta(H, 1, 1)
  lambda.u(nu)
</code></pre>

<hr>
<h2 id='lg.mu.sig'>
package internal function
</h2><span id='topic+lg.mu.sig'></span>

<h3>Description</h3>

<p>package internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lg.mu.sig(m, v)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lg.mu.sig_+3A_m">m</code></td>
<td>

<p>Description
</p>
</td></tr>
<tr><td><code id="lg.mu.sig_+3A_v">v</code></td>
<td>

<p>Description
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'> #See package vignette
</code></pre>

<hr>
<h2 id='mu.k.u'>
package internal function
</h2><span id='topic+mu.k.u'></span>

<h3>Description</h3>

<p>package internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mu.k.u(k, ik, z, sigma, mu0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mu.k.u_+3A_k">k</code></td>
<td>

</td></tr>
<tr><td><code id="mu.k.u_+3A_ik">ik</code></td>
<td>

</td></tr>
<tr><td><code id="mu.k.u_+3A_z">z</code></td>
<td>

</td></tr>
<tr><td><code id="mu.k.u_+3A_sigma">sigma</code></td>
<td>

</td></tr>
<tr><td><code id="mu.k.u_+3A_mu0">mu0</code></td>
<td>

</td></tr>
</table>


<h3>Value</h3>

<p>Describe
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  K = 5
  n = 100
  z = abs(rnorm(n))
  sigma = sapply(1:K, function(x){1/rgamma(n=1, shape=10, rate=10)})
  mu0 = 0
  ik = sample(K, n, replace=TRUE)
  sapply(1:K, mu.k.u, ik, z, sigma, mu0)
</code></pre>

<hr>
<h2 id='nu.u'>
package internal function
</h2><span id='topic+nu.u'></span>

<h3>Description</h3>

<p>package internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nu.u(ind, tau, H)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nu.u_+3A_ind">ind</code></td>
<td>

</td></tr>
<tr><td><code id="nu.u_+3A_tau">tau</code></td>
<td>

</td></tr>
<tr><td><code id="nu.u_+3A_h">H</code></td>
<td>

</td></tr>
</table>


<h3>Value</h3>

<p>Describe
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  H = 5
  n = 100
  tau = rgamma(1, 1, 1)
  ind = sample(H, n, replace=TRUE)
  nu.u(ind, tau, H)
</code></pre>

<hr>
<h2 id='pai.u'>
package internal function
</h2><span id='topic+pai.u'></span>

<h3>Description</h3>

<p>package internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pai.u(b, a.pai, b.pai)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pai.u_+3A_b">b</code></td>
<td>

</td></tr>
<tr><td><code id="pai.u_+3A_a.pai">a.pai</code></td>
<td>

</td></tr>
<tr><td><code id="pai.u_+3A_b.pai">b.pai</code></td>
<td>

</td></tr>
</table>


<h3>Value</h3>

<p>Describe
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  n = 100
  b = rbinom(n, 1, 0.5)
  a.pai = 10^-6
  b.pai = 10^-6
  pai.u(b, a.pai, b.pai)
</code></pre>

<hr>
<h2 id='ptrace'>
Trace (ACF) Plots
</h2><span id='topic+ptrace'></span>

<h3>Description</h3>

<p>This function outputs trace plots of certain latent variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ptrace(res, var, ndisc, nr, nc, type="trace")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ptrace_+3A_res">res</code></td>
<td>

<p>An output object from <code class="reqn">bhts()</code>.
</p>
</td></tr>
<tr><td><code id="ptrace_+3A_var">var</code></td>
<td>

<p>Variable for which to display convergence diagnostic plots. Current options are <code class="reqn">mu0</code> (displaying <code class="reqn">\mu_{01},\ldots,\mu_{0K}</code>), <code class="reqn">mu1</code> (displaying <code class="reqn">\mu_{11},\ldots,\mu_{1K}</code>), <code class="reqn">sigma0</code> (displaying <code class="reqn">\sigma_{01}^2,\ldots,\sigma_{0K}^2</code>), <code class="reqn">sigma1</code> (displaying <code class="reqn">\sigma_{11}^2,\ldots,\sigma_{1K}^2</code>), <code class="reqn">pk0</code> (displaying <code class="reqn">\lambda_{1}^{(0)},\ldots,\lambda_{K}^{(0)}</code>) and <code class="reqn">pk1</code> (displaying <code class="reqn">\lambda_{1}^{(1)},\ldots,\lambda_{K}^{(1)}</code>).
</p>
</td></tr>
<tr><td><code id="ptrace_+3A_ndisc">ndisc</code></td>
<td>

<p>Number of iterations for which to discard samples.
</p>
</td></tr>
<tr><td><code id="ptrace_+3A_nr">nr</code></td>
<td>

<p>Number of rows in the resulting composite plot.
</p>
</td></tr>
<tr><td><code id="ptrace_+3A_nc">nc</code></td>
<td>

<p>Number of columns in the resulting composite plot.
</p>
</td></tr>
<tr><td><code id="ptrace_+3A_type">type</code></td>
<td>

<p>Type of convergence diagnostic. Currently implemented are trace plots (default <code class="reqn">type="trace"</code>) and ACF plots (<code class="reqn">type="acf"</code>)
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'> #See package vignette
</code></pre>

<hr>
<h2 id='r.fdr'>
Significant Hits
</h2><span id='topic+r.fdr'></span>

<h3>Description</h3>

<p>This function determines significant hits, based on a specified expected FDR.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r.fdr(res, fdr=0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="r.fdr_+3A_res">res</code></td>
<td>

<p>An output object from <code class="reqn">bhts()</code>.
</p>
</td></tr>
<tr><td><code id="r.fdr_+3A_fdr">fdr</code></td>
<td>

<p>Expected FDR (default is 0.05).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a list consisting of the following elements:
</p>
<table>
<tr><td><code>res</code></td>
<td>
<p>A data frame containing significant hits and their probabilities.</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>The computed significant hit probability threshold.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'> #See package vignette
</code></pre>

<hr>
<h2 id='sig.k.u'>
package internal function
</h2><span id='topic+sig.k.u'></span>

<h3>Description</h3>

<p>package internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sig.k.u(k, ik, z, mu0, a0, b0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sig.k.u_+3A_k">k</code></td>
<td>

</td></tr>
<tr><td><code id="sig.k.u_+3A_ik">ik</code></td>
<td>

</td></tr>
<tr><td><code id="sig.k.u_+3A_z">z</code></td>
<td>

</td></tr>
<tr><td><code id="sig.k.u_+3A_mu0">mu0</code></td>
<td>

</td></tr>
<tr><td><code id="sig.k.u_+3A_a0">a0</code></td>
<td>

</td></tr>
<tr><td><code id="sig.k.u_+3A_b0">b0</code></td>
<td>

</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>  K = 5
  n = 100
  z = abs(rnorm(n))
  mu0 = 0
  ik = sample(K, n, replace=TRUE)
  a0 = 5
  b0 = 5
  sapply(1:K, sig.k.u, ik, z, mu0, a0, b0)
</code></pre>

<hr>
<h2 id='tau.u'>
package internal function
</h2><span id='topic+tau.u'></span>

<h3>Description</h3>

<p>package internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tau.u(nu, a0, b0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tau.u_+3A_nu">nu</code></td>
<td>

<p>Description
</p>
</td></tr>
<tr><td><code id="tau.u_+3A_a0">a0</code></td>
<td>

<p>Description
</p>
</td></tr>
<tr><td><code id="tau.u_+3A_b0">b0</code></td>
<td>

<p>Description
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>  K = 5
  a = 10^-6
  b = 10^-6
  nu = rbeta(K, a, b)
  tau.u(nu, a, b)
</code></pre>

<hr>
<h2 id='z.pr.u'>
package internal function
</h2><span id='topic+z.pr.u'></span>

<h3>Description</h3>

<p>package internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>z.pr.u(z, hk, mu, sigma, ph, H, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="z.pr.u_+3A_z">z</code></td>
<td>

</td></tr>
<tr><td><code id="z.pr.u_+3A_hk">hk</code></td>
<td>

</td></tr>
<tr><td><code id="z.pr.u_+3A_mu">mu</code></td>
<td>

</td></tr>
<tr><td><code id="z.pr.u_+3A_sigma">sigma</code></td>
<td>

</td></tr>
<tr><td><code id="z.pr.u_+3A_ph">ph</code></td>
<td>

</td></tr>
<tr><td><code id="z.pr.u_+3A_h">H</code></td>
<td>

</td></tr>
<tr><td><code id="z.pr.u_+3A_n">n</code></td>
<td>

</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>  Nmax = 100
  K = 5
  H = 10
  M = 20
  n = sample(Nmax, M, replace=TRUE)

  z = abs(rnorm(sum(n)))
  mu = abs(rnorm(K))
  sigma = 1/rgamma(n=K, shape=10, rate=10)

  hk = sample(K,M*H, replace=TRUE)

  ph = as.vector(sapply(1:M, function(x){lambda.u(rbeta(H, 1, 1))}))

  z.pr.u(z, hk, mu, sigma, ph, H, n)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
