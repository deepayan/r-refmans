<!DOCTYPE html><html><head><title>Help for package phyloclim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {phyloclim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#age.range.correlation'><p>Age-Range Correlation</p></a></li>
<li><a href='#anc.clim'>
<p>Estimation of Ancestral Climatic Tolerances</p></a></li>
<li><a href='#enneaphylla_laciniata'>
<p>Niche overlap for Oxalis enneaphylla and O. lacinita</p></a></li>
<li><a href='#hypothesis.testing'><p>Niche Equivalency and Background Similarity Test</p></a></li>
<li><a href='#niche.overlap'>
<p>Quantification of Niche Overlap</p></a></li>
<li><a href='#palmatifoliae'>
<p><em>Oxalis</em> section <em>Palmatifoliae</em></p></a></li>
<li><a href='#phyloclim-internal'><p>Internal PhyloClim Functions</p></a></li>
<li><a href='#phyloclim-package'><p>Phyloclimatic Data Analysis</p></a></li>
<li><a href='#plotAncClim'><p>Chronograms with Climatic Data on the Y-Axis</p></a></li>
<li><a href='#plotPNO'>
<p>Plot Predicted Niche Occupancy Profiles</p></a></li>
<li><a href='#pno'>
<p>Predicted Niche Occupancy Profiles</p></a></li>
<li><a href='#pno.weighted.mean'>
<p>Weighted means of niche dimensions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Integrating Phylogenetics and Climatic Niche Modeling</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-05-25</td>
</tr>
<tr>
<td>Author:</td>
<td>Christoph Heibl, Clement Calenge (\code{import.ascii})</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Christoph Heibl &lt;christoph.heibl@gmx.net&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>ape, raster</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, sp</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements some methods in phyloclimatic modeling: 
  estimation of ancestral climatic niches, age-range-correlation, 
  niche equivalency test and background-similarity test.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-05-25 05:05:23 UTC; heibl</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-05-25 05:54:39 UTC</td>
</tr>
</table>
<hr>
<h2 id='age.range.correlation'>Age-Range Correlation
</h2><span id='topic+age.range.correlation'></span>

<h3>Description</h3>

<p>This function can be used to test for phylogenetic signal in patterns of niche overlap (Warren et al., 2008) based on the age-range correlation (ARC) as implemented by Turelli &amp; Fitzpatrick (2006).  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>age.range.correlation(phy, overlap, tri = "upper", n = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="age.range.correlation_+3A_phy">phy</code></td>
<td>
<p>an object of class <code>"phylo"</code>, which must be ultrametric.
</p>
</td></tr>
<tr><td><code id="age.range.correlation_+3A_overlap">overlap</code></td>
<td>
<p>a matrix of class <code>"niolap"</code>, containing pairwise measures of niche overlap as produced by <code><a href="#topic+niche.overlap">niche.overlap</a></code>.
</p>
</td></tr>
<tr><td><code id="age.range.correlation_+3A_tri">tri</code></td>
<td>
<p>either <code>"upper"</code> or <code>"lower"</code>, indicating which triangle of the overlap matrix to use (see <code><a href="#topic+niche.overlap">niche.overlap</a></code>).
</p>
</td></tr>
<tr><td><code id="age.range.correlation_+3A_n">n</code></td>
<td>
<p>an integer giving the number of iterations for the Monte Carlo resampling procedure.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In age-range correlation (ARC; <em>sensu</em> Fitzpatrick &amp; Turelli 2006), phylogentic relationships are taken into account when computing average range (or niche) overlap between two clades at node i by 
</p>
<p style="text-align: center;"><code class="reqn">
	\bar{o}_{i} = \sum_{j \in Clade1} \sum_{k \in Clade2} (\frac{1}{2})^{n_{jk} - 1} o_{jk}
	</code>
</p>
 
<p>where the double sum is over all species in the two clades, o(jk) denotes the overlap between species j and k, and n(jk) is the number of nodes separating the two species on the phylogeny. Plotting <code class="reqn">\bar{o}_{i}</code> against node ages depicts the ARC for a given clade. Slopes and intercept derived from a linear model can be used to characterize speciation mode (allopatric versus sympatric) or niche evolution (conservatism versus flexibility) in the clade (see Fitzpatrick &amp; Turelli [2006] and Warren et al. [2008], respectively).
</p>
<p>The significance of the ARC is assessed via Monte Carlo simulation by random permutation of the overlap matrix to estimate the distribution  of slope and intercept unter the null hypothesis of no phylogenetic signal.
</p>


<h3>Value</h3>

<p>A list of four elements: 
</p>
<table>
<tr><td><code>age.range.correlation</code></td>
<td>
<p>A matrix with age and average overlap for each node.</p>
</td></tr>
<tr><td><code>linear.regression</code></td>
<td>
<p>A linear model of mean niche (or range)overlap versus node age.</p>
</td></tr>
<tr><td><code>sig</code></td>
<td>
<p>Significance of intercept and slope derived by randomization. <code>f</code> is the fraction of randomized datasets with intercept and slopes greater than the observed data. <code>p</code>-values are calculated as 2 * min(f, 1 - f).</p>
</td></tr>
<tr><td><code>MonteCarlo.replicates</code></td>
<td>
<p>A matrix containing intercepts and slopes of randomized datasets.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Christoph Heibl</p>


<h3>References</h3>

<p>Fitzpatrick, B.M &amp; Turelli, M. 2006. The geography of mammalian speciation: mixed signals from phylogenies and range maps. <em>Evolution</em> <b>60</b>: 601-615.	
</p>
<p>Warren, D., R.E. Glor, &amp; M. Turelli. 2008. Environmental niche equivalency versus conservatism: quantitative approaches to niche evolution. <em>Evolution</em> <b>62</b>: 2868-2883.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+niche.overlap">niche.overlap</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># load PNOs for Oxalis sect. Palmatifoliae ...
data(PNO)

# ... and calculate niche overlap between species
no &lt;- niche.overlap(PNO$AnnualMeanTemperature)

# load phylogeny and PNOs of Oxalis sect. Palmatifoliae
data(tree)

# age-range correlation
x &lt;- age.range.correlation(phy = tree, overlap = no, n = 100)

# plot average niche overlap versus node age
plot(x$age.range.correlation)

# add a regression line
abline(x$linear.regression$coefficients)

# add regression lines from Monte Carlo randomization
apply(x$MonteCarlo.replicates, 1, abline, lwd = 0.2, col = "grey50")
</code></pre>

<hr>
<h2 id='anc.clim'>
Estimation of Ancestral Climatic Tolerances
</h2><span id='topic+anc.clim'></span>

<h3>Description</h3>

<p>This function implements a nonparametric approach to estimate ancestral climatic tolerances proposed by Evans et al. (2009), using <code><a href="ape.html#topic+ace">ace</a></code> from the <code>ape</code> package. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anc.clim(target, posterior = NULL, pno, n = 100, method = "GLS")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anc.clim_+3A_target">target</code></td>
<td>
<p>An object of class <code>"phylo"</code>; a best estimate  (e.g., ML estimate) of topology on which to summarize mean estimated climatic tolerances, must be ultrametric.
</p>
</td></tr>
<tr><td><code id="anc.clim_+3A_posterior">posterior</code></td>
<td>
<p>An object of class <code>"multiPhylo"</code> containing a sample of ultrametric trees from the posterior distribution of a Bayesian tree search to be used for reconstruction of ancestral climatic tolerances. <code>posterior = NULL</code> (the default) means that reconstruction uses <code>target</code> instead.
</p>
</td></tr>
<tr><td><code id="anc.clim_+3A_pno">pno</code></td>
<td>
<p>A data frame containing predicted niche occupancy (PNO) profiles, produced e.g. with <code><a href="#topic+pno">pno</a></code>.</p>
</td></tr>
<tr><td><code id="anc.clim_+3A_n">n</code></td>
<td>
<p>An integer: The PNO profile given by <code>pno</code> argument will be resamples <code>n</code> times.</p>
</td></tr>
<tr><td><code id="anc.clim_+3A_method">method</code></td>
<td>
<p>A character string specifying the method used for estimation. Two choices are possible: <code>"ML"</code> or <code>"GLS"</code> (see <code><a href="ape.html#topic+ace">ace</a></code> for details).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing three elements:
</p>
<table>
<tr><td><code>tree</code></td>
<td>
<p>An object of class <code>"phylo"</code>, the <code>target</code> tree used in the estimation.</p>
</td></tr>
<tr><td><code>means</code></td>
<td>
<p>A vector containing the means of estimated ancestral climatic tolerances. The elements of <code>means</code> are in the same order as node numbers in element <code>tree</code>.</p>
</td></tr>
<tr><td><code>central.density</code></td>
<td>
<p>A matrix, which for each of the terminal nodes in <code>tree</code> contains the minimum and the maximum of the 80 percent density interval of climatic tolerances (as sampled from the PNO).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Christoph Heibl</p>


<h3>References</h3>

<p>Evans, M. E. K., S. A. Smith, R. S. Flynn, and M. J. Donoghue. 2009. Climate, niche evolution,
and diversification of the 'bird-cage evening primroses' (<em>Oenothera</em>, sections <em>Anogra</em> and 
<em>Kleinia</em>). <em>Am. Nat.</em> <b>173</b>: 225-240.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pno">pno</a></code>, 
<code><a href="#topic+plotAncClim">plotAncClim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load phylogeny and PNOs of Oxalis sect. Palmatifoliae
data(tree)
data(PNO)

# choose summer precipitation for analysis
clim &lt;- PNO$PrecipitationWarmestQuarter

# estimate ancestral tolerances
ac &lt;- anc.clim(target = tree, pno = clim, n = 100)

# visualize results
plotAncClim(ac, ylab = "Precipitation of warmest quarter (mm)")
</code></pre>

<hr>
<h2 id='enneaphylla_laciniata'>
Niche overlap for Oxalis enneaphylla and O. lacinita
</h2><span id='topic+equ'></span><span id='topic+sim'></span>

<h3>Description</h3>

<p>Objects <code>equ</code> and <code>sim</code> contain the results of the <code><a href="#topic+niche.equivalency.test">niche.equivalency.test</a></code> and the <code><a href="#topic+bg.similarity.test">bg.similarity.test</a></code> (Warren et al. 2008) for <em>Oxalis enneaphylla</em> and <em>O. laciniata</em> from section <em>Palmatifoliae</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(equ)
data(sim)
</code></pre>


<h3>Format</h3>

<p>A list containing five elements:
</p>

<dl>
<dt>method</dt><dd><p>Name of the test.
</p>
</dd>
<dt>species</dt><dd><p>Names of the two species compared.
</p>
</dd>
<dt>statistic</dt><dd><p>Test statistics D and I of niche overlap based on Schoeners D and modified Hellinger distances.
</p>
</dd>
<dt>p.value</dt><dd><p>p-values for the test statistics (if <code>method = "niche equivalency test"</code>).
</p>
</dd>
<dt>null</dt><dd><p>Formulation of the null hypothesis.
</p>
</dd>
<dt>null.distribution</dt><dd><p>Null distributions of D and I derived from randomization (if <code>method = "niche equivalency test"</code>).
</p>
</dd>
<dt>ci.x.randomY</dt><dd><p>Confidence intervals based on null distributions (if <code>method = "background similarity test"</code>).
</p>
</dd>
<dt>ci.y.randomX</dt><dd><p>Confidence intervals based on null distributions (if <code>method = "background similarity test"</code>).
</p>
</dd>
<dt>nd.x.randomY</dt><dd><p>Null distributions of D and I derived from randomization (if <code>method = "background similarity test"</code>).
</p>
</dd>
<dt>nd.y.randomX</dt><dd><p>Null distributions of D and I derived from randomization (if <code>method = "background similarity test"</code>).
</p>
</dd>
</dl>



<h3>Source</h3>

<p>C. Heibl, unpublished data.
</p>


<h3>References</h3>

<p>Warren, D., R.E. Glor, &amp; M. Turelli. 2008. Environmental niche equivalency versus conservatism: quantitative approaches to niche evolution. <em>Evolution</em>. <b>62</b>: 2868-2883.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># plot results of niche equivalency test
data(equ)
plot(equ)

# plot results of background similarity test
data(sim)
plot(sim)
</code></pre>

<hr>
<h2 id='hypothesis.testing'>Niche Equivalency and Background Similarity Test</h2><span id='topic+niche.equivalency.test'></span><span id='topic+niche.identity.test'></span><span id='topic+identity.test'></span><span id='topic+bg.similarity.test'></span><span id='topic+print.ntest'></span><span id='topic+plot.ntest'></span>

<h3>Description</h3>

<p>Hypothesis testing as proposed by Warren et al. (2008) based on the generation of pseudoreplicate datasets. The niche equivalency (or identity) test asks whether the ecological niche models (ENMs) of two species are more different than expected if they were drawn from the same underlying distribution. The background similarity test asks whether ENMs drawn from populations with partially or entirely non-overlapping distributions are any more different from one another than expected by random chance. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>niche.equivalency.test(p, env, n = 99, app, dir)

bg.similarity.test(p, env, n = 99, conf.level = .95, app, dir)


## S3 method for class 'ntest'
print(x, ...)

## S3 method for class 'ntest'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hypothesis.testing_+3A_p">p</code></td>
<td>
<p>a <code><a href="sp.html#topic+SpatialPointsDataFrame">SpatialPointsDataFrame</a></code> or a simple data frame containing the <b>p</b>resence points. In the latter case the first column contains the species names, the second and third column longitude and latitude (see SWD-formatted (=Samples-With-Data) files in the MAXENT tutorial).</p>
</td></tr>
<tr><td><code id="hypothesis.testing_+3A_env">env</code></td>
<td>
<p>an object of class <code><a href="sp.html#topic+SpatialGridDataFrame">SpatialGridDataFrame</a></code> containing the environmental covariates.</p>
</td></tr>
<tr><td><code id="hypothesis.testing_+3A_n">n</code></td>
<td>
<p>an integer giving the number of permutations of the original data (default: <code>n = 99</code>).</p>
</td></tr>
<tr><td><code id="hypothesis.testing_+3A_conf.level">conf.level</code></td>
<td>
<p>a real number between 0 and 1 setting the confidence level of the confidence intervals to be calculated.</p>
</td></tr>
<tr><td><code id="hypothesis.testing_+3A_app">app</code></td>
<td>
<p>a character string giving the path to the MAXENT application.</p>
</td></tr>
<tr><td><code id="hypothesis.testing_+3A_dir">dir</code></td>
<td>
<p>a character string giving the name of a directory where the input and output data for MAXENT will be saved. Already existing directories will be overwritten <b>without</b> a warning. If <code>dir</code> is left empty the data will be written to a temporary directory, which will be deleted after execution.</p>
</td></tr>
<tr><td><code id="hypothesis.testing_+3A_x">x</code></td>
<td>
<p>an object of class <code>ntest</code>.</p>
</td></tr>
<tr><td><code id="hypothesis.testing_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An installation of MAXENT (Phillips et al., 2006; <a href="http://www.cs.princeton.edu/~schapire/maxent/">http://www.cs.princeton.edu/~schapire/maxent/</a>) is required in order to run <code>niche.equivalency.test</code> and <code>bg.similarity.test</code>. Both functions use the logistic output of MAXENT estimated using auto features. 
</p>
<p>By default, the environmental covariates given with <code>env</code> are assumend to be <em>continuous</em>. In order to use <em>categorical</em> environmental covariates, you have to prepend <code>"cat_"</code> to the layer name, e.g. <code>"cat_landuse"</code>.
</p>


<h3>Value</h3>

<p><code>niche.equivalency.test</code> gives a list with six elements:
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>name of the test.</p>
</td></tr>
<tr><td><code>species</code></td>
<td>
<p>names of the two species compared.</p>
</td></tr>
<tr><td><code>null</code></td>
<td>
<p>formulation of the null hypothesis.</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>statistics of niche overlap D based on Schoeners D and modified Hellinger distances.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-values associated with the statistics.</p>
</td></tr>
<tr><td><code>null.distribution</code></td>
<td>
<p>null distributions of D and I derived from randomization.</p>
</td></tr>
</table>
<p><code>bg.similarity.test</code> gives a list with eight elements:
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>name of the test.</p>
</td></tr>
<tr><td><code>species</code></td>
<td>
<p>names of the two species compared.</p>
</td></tr>
<tr><td><code>null</code></td>
<td>
<p>formulation of the null hypothesis.</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>statistics of niche overlap D based on Schoeners D and modified Hellinger distances.</p>
</td></tr>
<tr><td><code>ci.x.randomY</code></td>
<td>
<p>confidence interval for D and I based on the comparison of the first species against a randomized background derived from the second species.</p>
</td></tr>
<tr><td><code>ci.y.randomX</code></td>
<td>
<p>confidence interval for D and I based on the comparison of the second species against a randomized background derived from the first species.</p>
</td></tr>
<tr><td><code>nd.x.randomY</code></td>
<td>
<p>null distributions of D and I calculated from the comparison of the first species against a randomized background derived from the second species.</p>
</td></tr>
<tr><td><code>nd.y.randomX</code></td>
<td>
<p>null distributions of D and I calculated from the comparison of the second species against a randomized background derived from the first species.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>These functions have been completely rewritten and have been tested with MAXENT 3.3.3k</p>


<h3>Author(s)</h3>

<p>Christoph Heibl</p>


<h3>References</h3>

	
<p>Phillips, S.J, M. Dudik, &amp; R.E. Schapire. 2006. Maximum entropy modeling of species geographic distributions. <em>Ecological Modeling</em> <b>190</b>: 231-259.	
</p>
<p>Warren, D., R.E. Glor, &amp; M. Turelli. 2008. Environmental niche equivalency versus conservatism: quantitative approaches to niche evolution. <em>Evolution</em>. <b>62</b>: 2868-2883.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+niche.overlap">niche.overlap</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># path to MAXENT
# --------------
maxent.exe &lt;- paste(system.file(package="dismo"), 
"/java/maxent.jar", sep = "")

# a data frame of coordinates where two species 
# have been detected ('presence points') and
# a raster stack of environmental covariables
# --------------------------------------
species &lt;- c("enneaphylla", "laciniata")
data(sites)
samples &lt;- sites[grep(paste(species, collapse = "|"), sites$spec), ]
data.path &lt;- system.file("extdata", package = "phyloclim")
preds &lt;- list.files(path = data.path, pattern = "[.]asc")
preds &lt;- paste(data.path, preds, sep = "/")
preds &lt;- stack(lapply(X = preds, FUN = raster))

# testing against 9 permutations of the data
# -------------------------------------------
reps &lt;- 9

# run hypothesis tests
# --------------------
if (file.exists(maxent.exe)){
  net &lt;- niche.equivalency.test(samples, preds, reps, maxent.exe)
  net; plot(net)
  bst &lt;- bg.similarity.test(samples, preds, reps, app = maxent.exe)
  bst; plot(bst)
} else {
  message("get a copy of MAXENT (see Details)")
}
</code></pre>

<hr>
<h2 id='niche.overlap'>
Quantification of Niche Overlap
</h2><span id='topic+niche.overlap'></span>

<h3>Description</h3>

<p>This function quantifies the degree of niche overlap using the statistics D and I (as proposed by Warren et al., 2008) based on Schoeners D (Schoener, 1968) and Hellinger Distances (van der Vaart, 1998). Niche overlap can be calculated either from the probability surfaces of entire ecological niche models (Warren et al., 2008) or from single dimensions of the climatic niches (Evans et al., 2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>niche.overlap(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="niche.overlap_+3A_x">x</code></td>
<td>
<p>Might take one of the follwing forms: (1) a data frame containing predicted niche occupancy (PNO) profiles, e.g., as derived by <code><a href="#topic+pno">pno</a></code>; (2) a vector of filenames referencing to probability surfaces saved in ASCII-format with an ArcGIS-compatible header; (3) a list containing probability surfaces stored as objects of class <code><a href="sp.html#topic+SpatialGrid">SpatialGrid</a></code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of class <code>"niolap"</code>. The upper triangle contains pairwise comparisons of niche overlap in terms of D, whereas the lower triangle contains values of I.
</p>


<h3>Author(s)</h3>

<p>Christoph Heibl</p>


<h3>References</h3>

<p>Evans, M. E. K., S. A. Smith, R. S. Flynn, and M. J. Donoghue. 2009. Climate, niche evolution,
and diversification of the 'bird-cage evening primroses' (<em>Oenothera</em>, sections <em>Anogra</em> and 
<em>Kleinia</em>). <em>Am. Nat.</em> <b>173</b>: 225-240.
</p>
<p>Schoener, T.W. 1968. <em>Anolis</em> lizards in Bimini: resource partitioning in a complex fauna. <em>Ecology</em> <b>49</b>: 704-726.
</p>
<p>Van der Vaart, A.W. 1998. Asymptotic statistics. Cambridge University Press, U.K.
</p>
<p>Warren, D. L., R. E. Glor, &amp; M. Turelli. 2008. Environmental niche equivalency versus conservatism: quantitative approaches to niche evolution. <em>Evolution</em> <b>62</b>: 2868-2883.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pno">pno</a></code>, 
<code><a href="#topic+niche.equivalency.test">niche.equivalency.test</a></code>, 
<code><a href="#topic+bg.similarity.test">bg.similarity.test</a></code>,
<code><a href="#topic+age.range.correlation">age.range.correlation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load PNOs for Oxalis sect. Palmatifoliae
data(PNO)

# niche overlap on a annual precipitation gradient:
no &lt;- niche.overlap(PNO$AnnualPrecipitation)

# upper triangle: based on Schoeners D
# lower triangle: based on Hellinger distances
print(no)	
</code></pre>

<hr>
<h2 id='palmatifoliae'>
<em>Oxalis</em> section <em>Palmatifoliae</em>
</h2><span id='topic+palmatifoliae'></span><span id='topic+PNO'></span><span id='topic+sites'></span><span id='topic+tree'></span>

<h3>Description</h3>

<p>This is a data set of <em>Oxalis</em> sect. <em>Palmatifoliae</em> derived from a larger scale study by Heibl &amp; Renner (2012). The <code>sites</code> data frame gives the coordinates (WGS1984) of the sites where <em>Oxalis</em> sect. Palmatifoliae has been collected. These were taken as presence points in distribution modeling and the list of predicted niche occupancy profiles (<code>PNO</code>). Finally, <code>tree</code> holds a phylogenetic hypothesis for the section extracted from a relaxed molecular clock model of the phylogeny of Oxalidales based approx. 7500 bp of chloroplast and nuclear markers.
For 19 bioclimatic variables summarizing temperature and precipiation and five species of <em>Oxalis</em>, the suitability or probability of occurence is given along the environmental gradients. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(PNO)
	data(sites)
	data(tree)
	</code></pre>


<h3>Format</h3>


<dl>
<dt><code>sites</code></dt><dd><p>a data frame representing 290 collections of <em>Oxalis</em> sect. <em>Palmatifoliae</em>.</p>
</dd>
<dt><code>PNO</code></dt><dd><p>a list consisting of 19 matrixes. Each matrix corresponds to an environmental variable and contains the predicted niche occupancy profile (PNO) for each species of <em>Oxalis</em> sect. <em>Palmatifoliae</em>, whereby column 1 of each matrix gives the values of the environmental variable and columns 2-6 give probabilites of occurance of each species along the environmental gradient in column 1.</p>
</dd>
<dt><code>tree</code></dt><dd><p>an object of class <code>"phylo"</code> (see Value section of <code><a href="ape.html#topic+read.tree">read.tree</a></code>).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Heibl, C. &amp; S.S. Renner. Arid-adapted Distribution models and a dated phylogeny for Chilean <em>Oxalis</em> species reveal occupation of new habitats by different lineages, not rapid adaptive radiation. 2012. <em>Syst. Biol.</em> <b>61</b>(5): 823-834.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 290 collections of Palmatifoliae
# --------------------------------
data(sites)
plot(sites$long, sites$lat,
  xlab = "Longitude", ylab = "Latitude")

## PNO profiles along 19 bioclimatic variables
## -------------------------------------------
data(PNO); names(PNO)
temp &lt;- names(PNO)[1]
plotPNO(PNO[[temp]], xlab = temp)

## phylogenetic hypothesis for Palmatifoliae
## -----------------------------------------
data(tree)
plot(tree)
</code></pre>

<hr>
<h2 id='phyloclim-internal'>Internal PhyloClim Functions</h2><span id='topic+AC.node.trans'></span><span id='topic+descendants'></span><span id='topic+di.enm'></span><span id='topic+di.pno'></span><span id='topic+import.asc'></span><span id='topic+nbConnectingNodes'></span><span id='topic+nested.mean.overlap'></span><span id='topic+noi'></span><span id='topic+sister'></span><span id='topic+terminal.sisters'></span><span id='topic+thinPNO'></span>

<h3>Description</h3>

<p>Internal <span class="pkg">phyloclim</span> functions.</p>


<h3>Note</h3>

<p>These are internal functions in <code>PhyloClim</code> and are not intended to be called by the user.
</p>

<hr>
<h2 id='phyloclim-package'>Phyloclimatic Data Analysis</h2><span id='topic+phyloclim-package'></span><span id='topic+phyloclim'></span>

<h3>Description</h3>

<p>This package implements some recently developed methods in phyloclimatic modeling.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
 Package: </td><td style="text-align: left;"> phyloclim</td>
</tr>
<tr>
 <td style="text-align: left;">
 Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.9.5</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-05-25</td>
</tr>
<tr>
 <td style="text-align: left;">
 License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><code>phyloclim</code> is intended to provide methods for the quantification of niche occupancy and niche overlap and combine this data with phylogenetic trees. 
Niche overlap can be quantified either from profiles of environmental suitability for a given environmental variable (PNO or predicted niche occupancy profiles, see <code><a href="#topic+pno">pno</a></code>) or from two-dimensional suitability surfaces (environmental niche models (ENMs) or species distribution models (SDMs)) with <code><a href="#topic+niche.overlap">niche.overlap</a></code>. Randomization tests for testing the significance of niche overlap in terms of niche identity and niche similarity are available in <code><a href="#topic+niche.equivalency.test">niche.equivalency.test</a></code> and <code><a href="#topic+bg.similarity.test">bg.similarity.test</a></code>.
Phylogenetic data can be integrated into comparative methods such as <code><a href="#topic+age.range.correlation">age.range.correlation</a></code> and the estimation of ancestral environmental tolerances (<code><a href="#topic+anc.clim">anc.clim</a></code>), which is a non-parametric approach based on resampling of PNO profiles.
The functions in <code>phyloclim</code> are in an early stage of development, so they should be used with care! Any feedback is welcome!
</p>


<h3>Author(s)</h3>

<p>Maintainer: Christoph Heibl (<a href="mailto:christoph.heibl@gmx.net">christoph.heibl@gmx.net</a>)
</p>


<h3>References</h3>

<p>Evans, M. E. K., S. A. Smith, R. S. Flynn, and M. J. Donoghue. 2009. Climate, niche evolution,
and diversification of the 'bird-cage evening primroses' (<em>Oenothera</em>, sections <em>Anogra</em> and 
<em>Kleinia</em>). <em>Am. Nat.</em> <b>173</b>: 225-240.
Fitzpatrick, B.M &amp; Turelli, M. 2006. The geography of mammalian speciation: mixed signals from phylogenies and range maps. <em>Evolution</em> <b>60</b>: 601-615.
Phillips, S.J, M. Dudik, &amp; R.E. Schapire. 2006. Maximum entropy modeling of species geographic distributions. <em>Ecological Modeling</em> <b>190</b>: 231-259.
</p>
<p>Warren, D., R.E. Glor, &amp; M. Turelli. 2008. Environmental niche equivalency versus conservatism: quantitative approaches to niche evolution. <em>Evolution</em> <b>62</b>: 2868-2883.
</p>


<h3>See Also</h3>

<p><code><a href="ape.html#topic+ape-package">ape</a></code>
</p>

<hr>
<h2 id='plotAncClim'>Chronograms with Climatic Data on the Y-Axis</h2><span id='topic+plotAncClim'></span>

<h3>Description</h3>

<p>Plot the history of climatic tolerance for a clade <em>sensu</em>
Evans et al. (2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotAncClim(x, layer, clades = NULL, col, density = TRUE, tipmode = 1,
  nchar = 3, cex, tipspace, cladespace = 1, lwd, ylab = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotAncClim_+3A_x">x</code></td>
<td>
<p>A list with elements <code>tree</code>, <code>data</code>, and (optional)
<code>central.density</code> (see details).</p>
</td></tr>
<tr><td><code id="plotAncClim_+3A_layer">layer</code></td>
<td>
<p><em>Do not use.</em></p>
</td></tr>
<tr><td><code id="plotAncClim_+3A_clades">clades</code></td>
<td>
<p>A list containing vectors of tip labels which define  the clades
to highlight.</p>
</td></tr>
<tr><td><code id="plotAncClim_+3A_col">col</code></td>
<td>
<p>A vector containing colors for different clades (see Examples).</p>
</td></tr>
<tr><td><code id="plotAncClim_+3A_density">density</code></td>
<td>
<p>Logical, if <code>TRUE</code>, the central density intervals for
recent species are plotted.</p>
</td></tr>
<tr><td><code id="plotAncClim_+3A_tipmode">tipmode</code></td>
<td>
<p>Integer: <code>tipmode = 0</code> means no tiplabels (and no central
density intervals) are plotted; values <code>1</code>, <code>2</code>, and <code>3</code>
define different ways of plotting the tiplabels (see Examples).</p>
</td></tr>
<tr><td><code id="plotAncClim_+3A_nchar">nchar</code></td>
<td>
<p>An integer giving the number of characters to which the tiplabels
are truncated.</p>
</td></tr>
<tr><td><code id="plotAncClim_+3A_cex">cex</code></td>
<td>
<p>Numeric <b>c</b>haracter <b>ex</b>pansion factor for tiplabels;
multiplied by <code><a href="graphics.html#topic+par">par</a></code>(<code>"cex"</code>) yields the final character
size. <code>NULL</code> is are equivalent to <code>1.0</code>.</p>
</td></tr>
<tr><td><code id="plotAncClim_+3A_tipspace">tipspace</code></td>
<td>
<p>The fraction of the x-axis that is reserved for tiplabel
plotting. If no value is given (default), <code>plotAncClim</code> calculates the
fraction as <em>1 - (4 / nbtips)</em>, but this can be overridden by
specifiying a fixed value for <code>tipspace</code> in <em>]0, 1[</em>.</p>
</td></tr>
<tr><td><code id="plotAncClim_+3A_cladespace">cladespace</code></td>
<td>
<p>A positive reel number; <b>tentative</b>: a factor
controlling the space between tiplabels of different clades.</p>
</td></tr>
<tr><td><code id="plotAncClim_+3A_lwd">lwd</code></td>
<td>
<p>The line width, a positive number, defaulting to 1.</p>
</td></tr>
<tr><td><code id="plotAncClim_+3A_ylab">ylab</code></td>
<td>
<p>A character string, giving a label for the y-axis, i.e., for the
bioclimatic dimension of the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The main argument <code>x</code> is a list consisting of at least the first
two of the following elements: (1) <code>tree</code> is an ultrametric
phylogenetic tree stored as object of class <code>phylo</code>; (2) <code>data</code> is
an object of class <code>matrix</code>; its columns correspond to bioclimatic
variables and its rows corresond to node numbers such as defined by class
<code>phylo</code> objects; (3) <code>central.density</code> must only be included if
<code>density = TRUE</code> &ndash; it is a list, which for every bioclimatic variable,
contains a matrix that contains the some minimum and maximum quantile of the
respective bioclimatic variable for every tip in the tree.
</p>


<h3>References</h3>

<p>Evans, M. E. K., S. A. Smith, R. S. Flynn, and M. J. Donoghue.
2009. Climate, niche evolution, and diversification of the 'bird-cage
evening primroses' (<em>Oenothera</em>, sections <em>Anogra</em> and
<em>Kleinia</em>). <em>Am. Nat.</em> <b>173</b>: 225-240.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pno">pno</a></code>, <code><a href="#topic+pno.weighted.mean">pno.weighted.mean</a></code>,
<code><a href="#topic+anc.clim">anc.clim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # load phylogeny and PNOs of Oxalis sect. Palmatifoliae
 data(tree)
 data(PNO)

# choose summer precipitation for analysis
clim &lt;- PNO$PrecipitationWarmestQuarter

# estimate ancestral tolerances
ac &lt;- anc.clim(target = tree, pno = clim, n = 100)

# visualize results with default branch coloration
plotAncClim(ac)

# alternative clade colors are given according to the order
# in which tip labels appear from left to right
plotAncClim(ac, col = c("red", "purple", "blue"))

# the 'tipmode' argument
plotAncClim(ac, tipmode = 0)
plotAncClim(ac, tipmode = 1)
plotAncClim(ac, tipmode = 2, nchar = 5)
plotAncClim(ac, tipmode = 3, nchar = 4)
</code></pre>

<hr>
<h2 id='plotPNO'>
Plot Predicted Niche Occupancy Profiles
</h2><span id='topic+plotPNO'></span>

<h3>Description</h3>

<p>This function can be used to plot predicted niche occupancy profiles (PNOs). PNOs can be obtained in a geographical information system by summing the cumulative probabilies of each climatical value for a species distribution model (SDM).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPNO(x, subset = NULL, thinning = NULL, xlab = NULL, 
	tail_threshold = 0, wm = FALSE, legend.pos = "topleft")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPNO_+3A_x">x</code></td>
<td>
<p>A data frame or matrix with columns corresponding to species and rows corresponding to values along an environmental gradient. The first columns contains the environmental variable, the remaining colums probabilities of suitability.
</p>
</td></tr>
<tr><td><code id="plotPNO_+3A_subset">subset</code></td>
<td>
<p>A vector of mode <code>"character"</code> which can be used to restrict the calculation of weighted means to those columsn in <code>x</code> whose column names match <code>subset</code>; defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plotPNO_+3A_thinning">thinning</code></td>
<td>
<p>An integer that can be used to thin fuzzy PNOs prior to plotting; defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plotPNO_+3A_xlab">xlab</code></td>
<td>
<p>A character string given the label for the x-axis.</p>
</td></tr>
<tr><td><code id="plotPNO_+3A_tail_threshold">tail_threshold</code></td>
<td>
<p>A numeric that can be used cut long tails of PNOs; defaults to <code>0</code>.</p>
</td></tr>
<tr><td><code id="plotPNO_+3A_wm">wm</code></td>
<td>
<p>A logical indicating if weighted mean should added for each species.</p>
</td></tr>
<tr><td><code id="plotPNO_+3A_legend.pos">legend.pos</code></td>
<td>
<p>Controls the position of the legend. Might eihter be a list object containing x and y coordinates (such as e.g. returned by <code><a href="graphics.html#topic+locator">locator</a></code>) of the <b>topleft corner</b> of the legend box or one of the following: <code>"topleft"</code> (default), <code>"bottomleft"</code>, <code>"topright"</code>, or <code>"bottomright"</code>. If <code>legend.pos == NULL</code> the plotting of the legend is suppressed.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Christoph Heibl</p>


<h3>References</h3>

<p>Evans, M. E. K., S. A. Smith, R. S. Flynn, and M. J. Donoghue. 2009. Climate, niche evolution,
and diversification of the 'bird-cage evening primroses' (<em>Oenothera</em>, sections <em>Anogra</em> and 
<em>Kleinia</em>). <em>Am. Nat.</em> <b>173</b>: 225-240.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pno">pno</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load PNOs for Oxalis sect. Palmatifoliae
data(PNO)

# plot predicted niche occupany for annual mean temperature
plotPNO(x = PNO$AnnualMeanTemperature, 
	xlab = "Annual Mean Temperature (degree C)")
	
# same plot, but with weighted means added
plotPNO(x = PNO$AnnualMeanTemperature, 
	xlab = "Annual Mean Temperature (degree C)", wm = TRUE)
</code></pre>

<hr>
<h2 id='pno'>
Predicted Niche Occupancy Profiles
</h2><span id='topic+pno'></span>

<h3>Description</h3>

<p>Following the approach of Evans et al. (2009), <code>pno</code> integrates species probability (suitability) distributions (e.g. derived with MAXENT) with respect to single climatic (or other environmental) variables in order to get predicted niche occupancy (PNO) profiles for each species and environmenatal variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pno(path_bioclim, path_model, subset = NULL, 
	bin_width = 1, bin_number = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pno_+3A_path_bioclim">path_bioclim</code></td>
<td>
<p>The path leading to an ASCII raster map with environmental data (bioclimatic layer) and ArcGIS-compatible header.</p>
</td></tr>
<tr><td><code id="pno_+3A_path_model">path_model</code></td>
<td>
<p>The path leading to the directory, where MAXENT probability surfaces are stored as ASCII raster maps with ArcGIS-compatible header.</p>
</td></tr>
<tr><td><code id="pno_+3A_subset">subset</code></td>
<td>
<p>A vector of mode 'character' giving taxon names if only a subset of the species ENMs in <code>path_model</code> is to be used</p>
</td></tr>
<tr><td><code id="pno_+3A_bin_width">bin_width</code></td>
<td>
<p>A numeric, giving the bin interval.</p>
</td></tr>
<tr><td><code id="pno_+3A_bin_number">bin_number</code></td>
<td>
<p>An integer, giving the number of bins used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The path arguments <code>path_bioclim</code> and <code>path_model</code> point to the directories where the environmental data and the MAXENT probability distributions must be stored as ASCII maps with an <b>ArcGIS-compatible</b> header (as obtained with MAXENT output filetype: <b>asc</b>). An example header:
</p>

<table>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;"> ncols         </td><td style="text-align: left;"> 958 </td>
</tr>
<tr>
 <td style="text-align: right;">
	</td><td style="text-align: left;"> nrows         </td><td style="text-align: left;"> 376 </td>
</tr>
<tr>
 <td style="text-align: right;">
	</td><td style="text-align: left;"> xllcorner     </td><td style="text-align: left;"> -73.440304 </td>
</tr>
<tr>
 <td style="text-align: right;">
	</td><td style="text-align: left;"> yllcorner     </td><td style="text-align: left;"> -55.27622 </td>
</tr>
<tr>
 <td style="text-align: right;">
	</td><td style="text-align: left;"> cellsize      </td><td style="text-align: left;"> 0.0166 </td>
</tr>
<tr>
 <td style="text-align: right;">
	</td><td style="text-align: left;"> NODATA_value  </td><td style="text-align: left;"> -9999 </td>
</tr>
<tr>
 <td style="text-align: right;">
	</td>
</tr>

</table>



<h3>Value</h3>

<p>A data frame of cumulative probalities of suitability for each value on an environmental gradient (rows) for the a set of studied taxa (rows). The first column gives the mean of each category.
</p>


<h3>Author(s)</h3>

<p>Christoph Heibl</p>


<h3>References</h3>

<p>Evans, M. E. K., S. A. Smith, R. S. Flynn, and M. J. Donoghue. 2009. Climate, niche evolution,
and diversification of the 'bird-cage evening primroses' (<em>Oenothera</em>, sections <em>Anogra</em> and 
<em>Kleinia</em>). <em>Am. Nat.</em> <b>173</b>: 225-240.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pno.weighted.mean">pno.weighted.mean</a></code>, 
<code><a href="#topic+niche.overlap">niche.overlap</a></code>, 
<code><a href="#topic+anc.clim">anc.clim</a></code>
</p>

<hr>
<h2 id='pno.weighted.mean'>
Weighted means of niche dimensions
</h2><span id='topic+pno.weighted.mean'></span>

<h3>Description</h3>

<p>This function calculates the mean of an environmental variable weighted by the cumulative probability of each value of the environmental gradient extracted from a species distibution model (e.g. MAXENT)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pno.weighted.mean(x, subset = NULL, normalize = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pno.weighted.mean_+3A_x">x</code></td>
<td>
<p>A data frame or matrix with columns corresponding to species and rows corresponding to values along an environmental gradient. The first columns contains the environmental variable, the remaining colums probabilities of suitability.
</p>
</td></tr>
<tr><td><code id="pno.weighted.mean_+3A_subset">subset</code></td>
<td>
<p>A vector of mode <code>"character"</code> which can be used to restrict the calculation of weighted means to those columsn in <code>x</code> whose column names match <code>subset</code>; defaults to <code>NULL</code>. </p>
</td></tr>
<tr><td><code id="pno.weighted.mean_+3A_normalize">normalize</code></td>
<td>
<p>A logical, indicating whether to normalize PNOs prior to calculation of weighted means.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of weighted means corresponding to the columns in <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Christoph Heibl</p>


<h3>References</h3>

<p>Evans, M. E. K., S. A. Smith, R. S. Flynn, and M. J. Donoghue. 2009. Climate, niche evolution,
and diversification of the 'bird-cage evening primroses' (<em>Oenothera</em>, sections <em>Anogra</em> and 
<em>Kleinia</em>) <em>Am. Nat.</em> <b>173</b>: 225-240.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pno">pno</a></code>, 
<code><a href="#topic+anc.clim">anc.clim</a></code>, 
<code><a href="#topic+plotAncClim">plotAncClim</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
