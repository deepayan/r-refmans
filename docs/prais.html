<!DOCTYPE html><html><head><title>Help for package prais</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {prais}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#prais_winsten'><p>Prais-Winsten Estimator for AR(1) Serial Correlation</p></a></li>
<li><a href='#summary.prais'><p>Summarising the Prais-Winsten Estimator</p></a></li>
<li><a href='#vcovHC.prais'><p>Semirobust Covariance Matrix Estimators</p></a></li>
<li><a href='#vcovPC.prais'><p>Extract Panel-Corrected Variance Covariance Matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Prais-Winsten Estimator for AR(1) Serial Correlation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>The Prais-Winsten estimator (Prais &amp; Winsten, 1954) takes into account AR(1) serial correlation of the errors in a linear regression model. The procedure recursively estimates the coefficients and the error autocorrelation of the specified model until sufficient convergence of the AR(1) coefficient is attained.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0), sandwich, pcse</td>
</tr>
<tr>
<td>Imports:</td>
<td>lmtest, stats</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/franzmohr/prais">https://github.com/franzmohr/prais</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/franzmohr/prais/issues">https://github.com/franzmohr/prais/issues</a></td>
</tr>
<tr>
<td>Collate:</td>
<td>'prais_winsten.R' 'print.prais.R' 'summary.prais.R'
'print.summary.prais.R' 'pw_transform.R' 'vcovHC.R' 'vcovPC.R'
'zzz.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-11-01 14:50:16 UTC; franz</td>
</tr>
<tr>
<td>Author:</td>
<td>Franz X. Mohr [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Franz X. Mohr &lt;prais.r@outlook.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-11-01 15:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='prais_winsten'>Prais-Winsten Estimator for AR(1) Serial Correlation</h2><span id='topic+prais_winsten'></span><span id='topic+print.prais'></span>

<h3>Description</h3>

<p>The Prais-Winsten estimator takes into account AR(1) serial correlation of the errors
in a linear regression model. The procedure recursively estimates the coefficients
and the error autocorrelation of the specified model until sufficient convergence of
the AR(1) coefficient is reached. All estimates are obtained by OLS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prais_winsten(
  formula,
  data,
  index,
  max_iter = 50L,
  tol = 1e-06,
  twostep = FALSE,
  panelwise = FALSE,
  rhoweight = c("none", "T", "T1"),
  ...
)

## S3 method for class 'prais'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prais_winsten_+3A_formula">formula</code></td>
<td>
<p>an object of class <code>"formula"</code> (or one that can be coerced to that class):
a symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="prais_winsten_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model. If panel data is used,
it must also contain the ID and time variables.</p>
</td></tr>
<tr><td><code id="prais_winsten_+3A_index">index</code></td>
<td>
<p>a character vector specifying the ID and time variables. If only one variable
is provided, it is assumed to be the time variable and the data will be reordered
accordingly.</p>
</td></tr>
<tr><td><code id="prais_winsten_+3A_max_iter">max_iter</code></td>
<td>
<p>integer specifying the maximum number of allowed iterations. Default is 50.</p>
</td></tr>
<tr><td><code id="prais_winsten_+3A_tol">tol</code></td>
<td>
<p>numeric specifying the maximum absolute difference between the estimator of <code class="reqn">rho</code>
in the current and the previous iteration that has to be attained to reach convergence.
Default is 1e-6.</p>
</td></tr>
<tr><td><code id="prais_winsten_+3A_twostep">twostep</code></td>
<td>
<p>logical. If <code>TRUE</code>, the estimation will stop after the first iteration.</p>
</td></tr>
<tr><td><code id="prais_winsten_+3A_panelwise">panelwise</code></td>
<td>
<p>logical. If <code>TRUE</code>, <code class="reqn">\rho</code> will be calculated for each panel separately.
Default is <code>FALSE</code>. Only used for panel data. See 'Details'.</p>
</td></tr>
<tr><td><code id="prais_winsten_+3A_rhoweight">rhoweight</code></td>
<td>
<p>character specifying how <code class="reqn">\rho</code> should be calculated if <code>panelwise = TRUE</code>.
See 'Details'.</p>
</td></tr>
<tr><td><code id="prais_winsten_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="stats.html#topic+lm">lm</a></code>.</p>
</td></tr>
<tr><td><code id="prais_winsten_+3A_x">x</code></td>
<td>
<p>an object of class &quot;prais&quot;, usually, a result of a call to <code><a href="#topic+prais_winsten">prais_winsten</a></code>.</p>
</td></tr>
<tr><td><code id="prais_winsten_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code class="reqn">\rho</code> takes a value above 1 during the estimation process,
the Prais-Winsten transformation cannot be applied to the first
observations, because <code class="reqn">(1 - \rho^2)^{(1 / 2)}</code> is not real. These observations
are dropped during the respective iteration and the estimator effectively becomes
the Cochrane-Orcutt estimator.
</p>
<p>If <code>panelwise = TRUE</code>, <code>twostep = FALSE</code> and <code>rhoweight = "none"</code>,
each individual estimate of <code class="reqn">rho</code> is re-estimated until convergence is achieved for all coefficients.
</p>
<p>If <code>panelwise = TRUE</code>, the calculation of <code class="reqn">\rho</code> can be further specified in argument
<code>rhoweight</code>. If <code>rhoweight = "none"</code>, <code class="reqn">\rho</code> is assumed to be panel-specific. If
<code>rhoweight = "T"</code>, <code class="reqn">\rho</code> is calculated as a weighted mean of panel-specific estimates, where
the number of available observations per panel, i.e. <code class="reqn">T_i</code>, is used as weight. If <code>rhoweight = "T1"</code>,
<code class="reqn">\rho</code> is calculated as a weighted mean of panel-specific estimates, where the number of available
observations per panel minus one, i.e. <code class="reqn">T_i - 1</code>, is used as weight.
</p>


<h3>Value</h3>

<p>A list of class <code>"prais"</code> containing the following components:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>the values of the AR(1) coefficient <code class="reqn">\rho</code> from all iterations.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the residuals, that is the response minus the fitted values.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the fitted mean values.</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>the numeric rank of the fitted linear model.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>the residual degrees of freedom.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>the terms object used.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the original model frame, i.e., before the Prais-Winsten transformation.</p>
</td></tr>
<tr><td><code>index</code></td>
<td>
<p>a character specifying the ID and time variables.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Beck, N. L. and Katz, J. N. (1995): What to do (and not to do) with time-series cross-section data. American Political Science Review 89, 634-647.
</p>
<p>Prais, S. J. and Winsten, C. B. (1954): Trend Estimators and Serial Correlation. Cowles Commission Discussion Paper, 383 (Chicago).
</p>
<p>Wooldridge, J. M. (2013): Introductory Econometrics. A Modern Approach. 5th ed. Mason, OH: South-Western Cengage Learning Cengage.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate an artificial sample
set.seed(1234567)
n &lt;- 100
x &lt;- sample(20:40, n, replace = TRUE)
rho &lt;- .5

# AR(1) errors
u &lt;- rnorm(n, 0, 5)
for (i in 2:n) {
  u[i] &lt;- u[i] + rho * u[i - 1]
}
pw_sample &lt;- data.frame("x" = x, "y" = 10 + 1.5 * x + u, "time" = 1:n)

# Estimate
pw &lt;- prais_winsten(y ~ x, data = pw_sample, index = "time")
summary(pw)

</code></pre>

<hr>
<h2 id='summary.prais'>Summarising the Prais-Winsten Estimator</h2><span id='topic+summary.prais'></span><span id='topic+print.summary.prais'></span>

<h3>Description</h3>

<p>Summary method for class <code>"prais"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'prais'
summary(object, ...)

## S3 method for class 'summary.prais'
print(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.prais_+3A_object">object</code></td>
<td>
<p>an object of class <code>"prais"</code>, usually, a result of a call to
<code><a href="#topic+prais_winsten">prais_winsten</a></code>.</p>
</td></tr>
<tr><td><code id="summary.prais_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="summary.prais_+3A_x">x</code></td>
<td>
<p>an object of class <code>"summary.prais"</code>, usually, a result of a call to
<code><a href="#topic+summary.prais">summary.prais</a></code>.</p>
</td></tr>
<tr><td><code id="summary.prais_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing.</p>
</td></tr>
<tr><td><code id="summary.prais_+3A_signif.stars">signif.stars</code></td>
<td>
<p>logical. If <code>TRUE</code>, 'significance stars' are printed
for each coefficient.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.prais</code> returns a list of class <code>"summary.prais"</code>,
which contains the following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the residuals, that is the response minus the fitted values.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>the values of the AR(1) coefficient <code class="reqn">\rho</code> from all iterations.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>the square root of the estimated variance of the random error.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom, a 3-vector <em>(p, n-p, p*)</em>,
the first being the number of non-aliased coefficients, the last being
the total number of coefficients.</p>
</td></tr>
<tr><td><code>r.squared</code></td>
<td>
<p>R^2, the 'fraction of variance explained by the model',
</p>
<p style="text-align: center;"><code class="reqn">R^2 = 1 - \frac{\sum {(y_i - \hat{y}_i)^2}}{\sum {(y_i - \overline{y})^2}},</code>
</p>

<p>where <code class="reqn">\overline{y}</code> is the mean of <code class="reqn">y_i</code> for <code class="reqn">y_i = 1, ..., N</code>
if there is an intercept and zero otherwise.</p>
</td></tr>
<tr><td><code>adj.r.squared</code></td>
<td>
<p>the above <em>R^2</em> statistic <em>'adjusted'</em>, penalising
for higher <em>p</em>.</p>
</td></tr>
<tr><td><code>fstatistic</code></td>
<td>
<p>(for models including non-intercept terms) a 3-vector with the
value of the F-statistic with its numerator and denominator degrees of freedom.</p>
</td></tr>
<tr><td><code>cov.unscaled</code></td>
<td>
<p>a <code class="reqn">p \times p</code> matrix of (unscaled) covariances of the
<em>coef[j], j=1, ..., p</em>.</p>
</td></tr>
<tr><td><code>dw</code></td>
<td>
<p>a named 2-vector with the Durbin-Watson statistic of the original
linear model and the Prais-Winsten estimator.</p>
</td></tr>
<tr><td><code>index</code></td>
<td>
<p>a character specifying the ID and time variables.</p>
</td></tr>
</table>

<hr>
<h2 id='vcovHC.prais'>Semirobust Covariance Matrix Estimators</h2><span id='topic+vcovHC.prais'></span>

<h3>Description</h3>

<p>Semirobust covariance matrix estimators for models of class <code>"prais"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'prais'
vcovHC(x, type = c("const", "HC1", "HC0"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcovHC.prais_+3A_x">x</code></td>
<td>
<p>an object of class <code>"prais"</code>, usually, the result of a call to <code><a href="#topic+prais_winsten">prais_winsten</a></code>.</p>
</td></tr>
<tr><td><code id="vcovHC.prais_+3A_type">type</code></td>
<td>
<p>a character string specifying the estimation type.</p>
</td></tr>
<tr><td><code id="vcovHC.prais_+3A_...">...</code></td>
<td>
<p>not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>vcovHC</code> is a function for estimating a robust covariance matrix of parameters for
the Prais-Winsten estimator. The weighting schemes specified by type are analogous to those in
<code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code> in package <a href="https://cran.r-project.org/package=sandwich">sandwich</a>
with the caveat that only <code>"const"</code>, <code>"HC0"</code> and <code>"HC1"</code> are available.
</p>


<h3>Value</h3>

<p>An object of class &quot;matrix&quot; containing the estimate of the asymptotic covariance matrix
of coefficients.
</p>


<h3>See Also</h3>

<p><code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>
</p>

<hr>
<h2 id='vcovPC.prais'>Extract Panel-Corrected Variance Covariance Matrix</h2><span id='topic+vcovPC.prais'></span>

<h3>Description</h3>

<p>Panel-corrected covariance matrix estimators for models of class <code>"prais"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'prais'
vcovPC(x, pairwise = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcovPC.prais_+3A_x">x</code></td>
<td>
<p>an object of class <code>"prais"</code>, usually, the result of a call to <code><a href="#topic+prais_winsten">prais_winsten</a></code>.</p>
</td></tr>
<tr><td><code id="vcovPC.prais_+3A_pairwise">pairwise</code></td>
<td>
<p>logical. If <code>FALSE</code> (default), only those residuals from periods that are common to
all panels are used to computed the covariances. If <code>TRUE</code> all observations that can be matched by
period between two panels are used.</p>
</td></tr>
<tr><td><code id="vcovPC.prais_+3A_...">...</code></td>
<td>
<p>not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>vcovPC</code> is a function for estimating a panel-corrected covariance matrix of parameters for
the Prais-Winsten estimator.
</p>


<h3>Value</h3>

<p>An object of class &quot;matrix&quot;.
</p>


<h3>References</h3>

<p>Beck, N. L. and Katz, J. N. (1995): What to do (and not to do) with time-series cross-section data. American Political Science Review 89, 634-647.
</p>


<h3>See Also</h3>

<p><code><a href="pcse.html#topic+vcovPC">vcovPC</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
