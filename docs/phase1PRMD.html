<!DOCTYPE html><html><head><title>Help for package phase1PRMD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {phase1PRMD}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#eff'><p>Efficacy response generation parameters</p></a></li>
<li><a href='#eff_suggest'><p>Suggest the input <code>eff.structure</code> of function <code>SimPRMD</code> with</p>
selected <code>eff.sd_tran</code></a></li>
<li><a href='#eff_summary'><p>Compute the summary statistics of efficacy measure with specified</p>
parameters.</a></li>
<li><a href='#nTTP_summary'><p>Generate the mean nTTP score and the probability of observing DLT for all</p>
doses and cycles</a></li>
<li><a href='#nTTP.array'><p>Generate the nTTP dictionary</p></a></li>
<li><a href='#patlist_sim'><p>A list of patient information</p></a></li>
<li><a href='#patlist.display'><p>Display patient records</p></a></li>
<li><a href='#plot.RunPRMD'><p>Plot nTTP and efficacy boxplots of a RunPRMD object</p></a></li>
<li><a href='#plot.SimPRMD'><p>Plots of a SimPRMD object</p></a></li>
<li><a href='#print.summary.RunPRMD'><p>Displays a useful description of a summary.RunPRMD object</p></a></li>
<li><a href='#print.summary.SimPRMD'><p>Displays a useful description of a summary.SimPRMD object</p></a></li>
<li><a href='#prob'><p>Toxicity probability matrix</p></a></li>
<li><a href='#RunPRMD'><p>Implement a Multi-Stage Phase I Dose-Finding Design to recommend dosage</p>
selection based on the data collected in the available patient cohorts</a></li>
<li><a href='#SimPRMD'><p>Simulation for a Multi-Stage Phase I Dose-Finding Design</p></a></li>
<li><a href='#summary.RunPRMD'><p>Summary a RunPRMD object</p></a></li>
<li><a href='#summary.SimPRMD'><p>Summary a SimPRMD object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-03-08</td>
</tr>
<tr>
<td>Title:</td>
<td>Personalized Repeated Measurement Design for Phase I Clinical
Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Lu Zhang, Jun Yin</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lu Zhang &lt;luzhangstat@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements Bayesian phase I repeated measurement design that 
    accounts for multidimensional toxicity endpoints and longitudinal efficacy 
    measure from multiple treatment cycles. The package provides flags to 
    fit a variety of model-based phase I design, including 1 stage models with
    or without individualized dose modification, 3-stage models with or without
    individualized dose modification, etc. Functions are provided to recommend 
    dosage selection based on the data collected in the available patient cohorts 
    and to simulate trial characteristics given design parameters. 
    Yin, Jun, et al. (2017) &lt;<a href="https://doi.org/10.1002%2Fsim.7134">doi:10.1002/sim.7134</a>&gt;. </td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>JAGS (http://mcmc-jags.sourceforge.net)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), coda (&ge; 0.13), ggplot2, stats</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>rjags, arrayhelpers, MASS, reshape2, plyr, dplyr,
RColorBrewer, gridExtra, kableExtra, knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-09 05:55:13 UTC; luzhang</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-09 06:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='eff'>Efficacy response generation parameters</h2><span id='topic+eff'></span>

<h3>Description</h3>

<p>A list of 4 records the parameters for efficacy measure generation. This
serves as an example of the parameter settings for efficacy measure
generation in function <code>SimPRMD</code>. Check <code><a href="#topic+eff_summary">eff_summary</a></code> or
<code><a href="#topic+SimPRMD">SimPRMD</a></code> to see the examples of using dataset <code>eff</code> in
generating efficacy measure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eff
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 4.</p>


<h3>Value</h3>

<table>
<tr><td><code>Dose_Cycle_Meff</code></td>
<td>
<p>Dose-cycle mean efficacy matrix. An array of 4
dimension providing the mean of the multivariate Gaussian distribution in
efficacy data generation. The dimension of the Dose-cycle mean efficacy
matrix is 5 5 6 6 which represents dose efficacy pattern, cycle efficacy
pattern, dose and cycle. Patterns are ordered in a way that the first is
increasing, the second is flat, the third is platform, the fourth is
decreasing, and the fifth is quadratic efficacy across dose levels and
cycles.</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>A 6 by 6 matrix, the covariance matrix of the multivariate
Guassian distribution in efficacy data generation.</p>
</td></tr>
<tr><td><code>sd_trans</code></td>
<td>
<p>A positive number controls the skewness of the distribution
of the efficacy response</p>
</td></tr>
<tr><td><code>eff.M</code></td>
<td>
<p>An array recording the corresponding mean of the generated
efficacy data with parameters specified by <code>eff$Dose_Cycle_Meff</code>,
<code>eff$Sigma</code>, and <code>eff$sd_trans</code></p>
</td></tr>
</table>

<hr>
<h2 id='eff_suggest'>Suggest the input <code>eff.structure</code> of function <code>SimPRMD</code> with
selected <code>eff.sd_tran</code></h2><span id='topic+eff_suggest'></span>

<h3>Description</h3>

<p>Suggest the input <code>eff.structure</code> of function SimPRMD  with selected
<code>eff.sd_tran</code> for given efficacy mean matrix and efficacy standard
deviation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eff_suggest(eff.M, eff.sd, eff.sd_trans, n.sim = 30000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eff_suggest_+3A_eff.m">eff.M</code></td>
<td>
<p>The efficacy mean matrix whose (i,j)th element save the
target mean of the efficacy data</p>
</td></tr>
<tr><td><code id="eff_suggest_+3A_eff.sd">eff.sd</code></td>
<td>
<p>The target standard deviation matrix for all dose and
cycles. Notice that the generated efficacy may have different standard
deviation matrix due to the correlations across cycles</p>
</td></tr>
<tr><td><code id="eff_suggest_+3A_eff.sd_trans">eff.sd_trans</code></td>
<td>
<p>The eff.sd_trans for test. Notice variance of the
generated efficacy data will be effected by <code>eff.sd_trans</code>.</p>
</td></tr>
<tr><td><code id="eff_suggest_+3A_n.sim">n.sim</code></td>
<td>
<p>The number of simulations for the numerical calculation in
the function. The default is 30,000</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>eff.suggest</code></td>
<td>
<p>The matrix suggested for the input
<code>eff.structure</code> of function <code>SimPRMD</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Provide an target efficacy mean matrix for all dose and cycles
eff.M &lt;- matrix(rep(3:8/10, 6), nrow = 6, ncol = 6)

# Give a target standard deviation matrix for all dose and cycles
# Notice that the generated efficacy may have difference standard deviation
# matrix due to the correlations across cycles
eff.sd &lt;- matrix(0.2, nrow = 6, ncol = 6)

# Select a eff.sd_trans for testing. The efficacy variance are mainly
# controlled by the eff.sd_trans
eff.sd_trans &lt;- 1.5  # or other positive value
eff.structure &lt;- eff_suggest(eff.M = eff.M, eff.sd = eff.sd,
                             eff.sd_trans = eff.sd_trans)

# check whether the suggested eff.M and the selected sd_trans
# generate the desirable scenario
eff.Sigma &lt;- diag(6)
diag(eff.Sigma[-1,]) = 0.5
diag(eff.Sigma[, -1]) = 0.5
eff.check &lt;- eff_summary(eff.structure = eff.structure,
                         eff.Sigma = eff.Sigma,
                         eff.sd_trans = eff.sd_trans,
                         plot.flag = FALSE)
eff.check$eff.M
eff.check$eff.cor.ls


</code></pre>

<hr>
<h2 id='eff_summary'>Compute the summary statistics of efficacy measure with specified
parameters.</h2><span id='topic+eff_summary'></span>

<h3>Description</h3>

<p>Numerically compute the Mean, mariginal standard deviance and mariginal
correlation matrix of efficacy measure generated with specified parameters.
The function provides plots of marginal density of generated efficacy and
correlation matrix for each dose. Check details to see the efficacy data
generation procedures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eff_summary(
  eff.structure,
  eff.Sigma,
  eff.sd_trans,
  n.sim = 3e+05,
  seed = 123,
  plot.flag = F,
  plot.title = T
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eff_summary_+3A_eff.structure">eff.structure</code></td>
<td>
<p>A matrix providing the mean of the multivariate
Gaussian distribution in efficacy data generation. Specifically, the
<code class="reqn">(i, j)</code>th element represents the mean value of <code class="reqn">i</code>th dose and
<code class="reqn">j</code>th cycle of the Gaussian distribution for efficacy data
generation.</p>
</td></tr>
<tr><td><code id="eff_summary_+3A_eff.sigma">eff.Sigma</code></td>
<td>
<p>The covariance matrix of the multivariate Guassian
distribution in efficacy data generation.</p>
</td></tr>
<tr><td><code id="eff_summary_+3A_eff.sd_trans">eff.sd_trans</code></td>
<td>
<p>A positive number controling the skewness of the
distribution of the efficacy response.</p>
</td></tr>
<tr><td><code id="eff_summary_+3A_n.sim">n.sim</code></td>
<td>
<p>Number of simulations for calculation summary statistics.
Default is 300,000</p>
</td></tr>
<tr><td><code id="eff_summary_+3A_seed">seed</code></td>
<td>
<p>The seed of R's random number generator. Default is 123</p>
</td></tr>
<tr><td><code id="eff_summary_+3A_plot.flag">plot.flag</code></td>
<td>
<p>Whether output the marginal density, and correlation
matrix or not. Default is FALSE.</p>
</td></tr>
<tr><td><code id="eff_summary_+3A_plot.title">plot.title</code></td>
<td>
<p>Whether display the title of the plot or not. Default is
TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The user can simulate longitudinal efficacy response with
different dose-efficacy and cycle-efficacy pattern using argument
<code>eff.structure</code>, <code>eff.Sigma</code> and <code>eff.sd_trans</code>. The
sampling process of efficacy response starts from generating <code class="reqn">z =
  {z1, \ldots, zd} </code> from multivariate Gaussian distribution </p>
<p style="text-align: center;"><code class="reqn">z ~
  MVN(\mu, V)</code>
</p>
<p>, where <code class="reqn">\mu</code> and <code class="reqn">V</code> are specified by
<code>eff.structure</code> and <code>eff.Sigma</code>, respectively. Define
<code class="reqn">\phi</code> be the density of <code class="reqn">N(0, \sigma^2)</code> with CDF <code class="reqn">\Phi</code>,
where <code class="reqn">\sigma^2</code> is set by <code>eff.sd_trans</code>. Then the efficacy
measure is generated by taking the CDF of <code class="reqn">z</code>: </p>
<p style="text-align: center;"><code class="reqn">x={x1, \ldots,
  xd} = \Phi(z) = { \Phi(z1), \ldots, \Phi(zd)}</code>
</p>
<p>. Notice here the variance
parameter <code class="reqn">\sigma^2_{trans}</code> controls the variance of the generated
efficacy.
</p>


<h3>Value</h3>

<table>
<tr><td><code>eff.M</code></td>
<td>
<p>A matrix recording the efficacy mean whose <code class="reqn">(i,
j)</code>th element represents the efficacy mean of <code class="reqn">i</code>th dose level and
<code class="reqn">j</code>th cycle </p>
</td></tr>
<tr><td><code>eff.cor.ls</code></td>
<td>
<p>A list with a length of dose levels numbers recording the
marginal correlation matrix across cycles of efficacy data for each dose
level</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data("eff")       # load eff.RData from package phase1PRMD. Details see "?eff"
eff.structure = eff$Dose_Cycle_Meff["plat", "dec", , ]
eff.Sigma = eff$Sigma
eff.sd_trans = eff$sd_trans

# res &lt;- eff_summary(eff.structure, eff.Sigma, eff.sd_trans, n.sim = 300000,
#                    seed = 123)
# res
# set a special cases and check the density and correlation plots
# eff_summary(eff.structure = matrix(eff.structure[cbind(c(1:6), c(1:6))],
#                                   nrow = 1, ncol = 6),
#             eff.Sigma, eff.sd_trans, n.sim = 300000, seed = 123,
#             plot.flag = TRUE, plot.title = FALSE)

</code></pre>

<hr>
<h2 id='nTTP_summary'>Generate the mean nTTP score and the probability of observing DLT for all
doses and cycles</h2><span id='topic+nTTP_summary'></span>

<h3>Description</h3>

<p><code>nTTP_summary</code> generates the mean nTTP score and the probability of
observing DLT for all doses and cycles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nTTP_summary(Tox.prob.M, nTTP.all, wm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nTTP_summary_+3A_tox.prob.m">Tox.prob.M</code></td>
<td>
<p>Toxicity probability matrix with 4 dimension: dose,
cycle, type, grade. Tox.prob.M can be the output of the build-in matrix
of function <code><a href="phase1RMD.html#topic+GenToxProb">GenToxProb</a></code> in package phase1RMD.
See more details about how to generate toxicity probability matrices in
the help document of <code><a href="phase1RMD.html#topic+GenToxProb">GenToxProb</a></code>.</p>
</td></tr>
<tr><td><code id="nTTP_summary_+3A_nttp.all">nTTP.all</code></td>
<td>
<p>The output of <code><a href="#topic+nTTP.array">nTTP.array</a></code></p>
</td></tr>
<tr><td><code id="nTTP_summary_+3A_wm">wm</code></td>
<td>
<p>(numerical matrix) Toxicity weighted matrix, with row be the
type of the toxicity and column be the toxicity grade</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>mnTTP.M</code></td>
<td>
<p>matrix of mean nTTP for all doses and cycles</p>
</td></tr>
<tr><td><code>pDLT.M</code></td>
<td>
<p>matrix of probability of observing DLT for all doses and
cycles</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
data("prob")

wm &lt;- matrix(c(0, 0.5, 0.75, 1, 1.5,
               0, 0.5, 0.75, 1, 1.5,
               0, 0, 0, 0.5, 1),
             byrow = TRUE, ncol = 5)          # weighted matrix for toxicity matrix
                                              # nrow = No.of type; ncol = No. of grade
toxmax &lt;- 2.5

nTTP.all &lt;- nTTP.array(wm, toxmax)

tox.matrix &lt;- prob["MTD4", "flat", , , , ]

nTTP_summary(tox.matrix, nTTP.all, wm)

</code></pre>

<hr>
<h2 id='nTTP.array'>Generate the nTTP dictionary</h2><span id='topic+nTTP.array'></span>

<h3>Description</h3>

<p><code>nTTP.array</code> generates the nTTP dictionary for all combination of
toxicity type and grade with a given toxicity weighted matrix. Used in
function <code><a href="#topic+nTTP_summary">nTTP_summary</a></code> for checking the toxicity scenario.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nTTP.array(wm, toxmax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nTTP.array_+3A_wm">wm</code></td>
<td>
<p>(numeric matrix, m by n) Toxicity weighted matrix, with row
be the type of the toxicity and column be the toxicity grade</p>
</td></tr>
<tr><td><code id="nTTP.array_+3A_toxmax">toxmax</code></td>
<td>
<p>(scalar)         Normalized constant for nTTP</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An m dimensional array with dimension <code class="reqn">(n, n, \ldots, n)</code>. The
<code class="reqn">(d1, d2 ,\ldots,dm), {di, i = 1\ldots, m} \in (1, \ldots, n)</code>th
element is the nTTP when the grade of <code class="reqn">i</code>th type of toxicity has
<code class="reqn">di</code>th toxicity grade.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wm = matrix(c(0, 0.5, 0.75, 1, 1.5,
              0, 0.5, 0.75, 1, 1.5,
              0, 0, 0, 0.5, 1),
            byrow = TRUE, ncol = 5)          # weighted matrix for toxicity matrix
                                             # nrow = No.of type; ncol = No. of grade
toxmax = 2.5

nTTP.array(wm, toxmax)

</code></pre>

<hr>
<h2 id='patlist_sim'>A list of patient information</h2><span id='topic+patlist_sim'></span>

<h3>Description</h3>

<p>The data &quot;patlist_sim&quot; is a trial generated by &quot;SimPRMD&quot;. The model utilized
for generating trial is a 3-stage model with individualized dose modification.
The MTD = 4 and the MED = 1 since the dose-efficacy pattern when generating
the trial was set to be flat. The dose-toxicity trend and efficacy-cycle trend
are flat. There are in total 12 cohorts with 3 patients in each cohort. This
also serves as an example of the input data of function <code><a href="#topic+RunPRMD">RunPRMD</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patlist_sim
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 6.</p>


<h3>Value</h3>

<table>
<tr><td><code>PatID</code></td>
<td>
<p>denotes the patient ID where the elements are specified by cohort
and subject number. For example, &quot;cohort2subject3&quot; denotes the third subject
in the second cohort</p>
</td></tr>
<tr><td><code>dose</code></td>
<td>
<p>records the dose assigned for each patient on different cycles</p>
</td></tr>
<tr><td><code>cycle</code></td>
<td>
<p>shows the treatment cycle</p>
</td></tr>
<tr><td><code>nTTP</code></td>
<td>
<p>records th corresponding nTTP score.</p>
</td></tr>
<tr><td><code>dlt</code></td>
<td>
<p>indicates whether a DLT event is observed or not?</p>
</td></tr>
<tr><td><code>efficacy</code></td>
<td>
<p>provides the continuous efficacy for each cycle. The range of
efficacy measure is (0, 1).</p>
</td></tr>
</table>

<hr>
<h2 id='patlist.display'>Display patient records</h2><span id='topic+patlist.display'></span>

<h3>Description</h3>

<p>Display patient records in a human-readable table. Each cell contains 3
values including observed nTTP, DLT, and dose assignment. The higher the
dose, the warmer the cell background color is. The black color of the
records indicates DLT equals 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patlist.display(patlist, n.dose, n.cycle)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="patlist.display_+3A_patlist">patlist</code></td>
<td>
<p>A list of the patient treatment records, which must contains
the following variables: </p>
 <dl>
<dt>PatID</dt><dd><p>denotes the patient ID
where the elements are specified by cohort and subject number. For
example, &quot;cohort2subject3&quot; denotes the third subject in the second
cohort</p>
</dd> <dt>dose</dt><dd><p>records the dose level assigned for each patient
through the whole treatment</p>
</dd> <dt>cycle</dt><dd><p>shows the treatment cycle
information of each record</p>
</dd> <dt>nTTP</dt><dd><p>records the corresponding nTTP
score.</p>
</dd> <dt>dlt</dt><dd><p>indicates whether a DLT event is observed or not?</p>
</dd></dl>
</td></tr>
<tr><td><code id="patlist.display_+3A_n.dose">n.dose</code></td>
<td>
<p>The number of dose in the study</p>
</td></tr>
<tr><td><code id="patlist.display_+3A_n.cycle">n.cycle</code></td>
<td>
<p>The number of cycle in the study</p>
</td></tr>
</table>

<hr>
<h2 id='plot.RunPRMD'>Plot nTTP and efficacy boxplots of a RunPRMD object</h2><span id='topic+plot.RunPRMD'></span>

<h3>Description</h3>

<p>Plot nTTP boxplots of a RunPRMD object. Plot efficacy boxplots when
implementing <code>RunPRMD</code> with option <code>effcy.flag == TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'RunPRMD'
plot(x, ..., select_cycle = x$cycles)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.RunPRMD_+3A_x">x</code></td>
<td>
<p>RunPRMD object to summarise</p>
</td></tr>
<tr><td><code id="plot.RunPRMD_+3A_...">...</code></td>
<td>
<p>other arguments ignored (for compatibility with generic)</p>
</td></tr>
<tr><td><code id="plot.RunPRMD_+3A_select_cycle">select_cycle</code></td>
<td>
<p>A vector indication the cycle in the boxplot. Default
is <code>cycle</code> of <code>x</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Check ?RunPRMD for example

</code></pre>

<hr>
<h2 id='plot.SimPRMD'>Plots of a SimPRMD object</h2><span id='topic+plot.SimPRMD'></span>

<h3>Description</h3>

<p>Plot the predictive probability of nTTP &lt; target toxicity for all cycles
and doses , the mean nTTP vs cycle1 and cycle &gt; 2 for all doses of a
SimPRMD object. Plot median treatment duration boxplot along with the DLT
drop off rate when implementing <code><a href="#topic+SimPRMD">SimPRMD</a></code> with option
<code>DLT.drop.flag = TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SimPRMD'
plot(x, ..., title.add = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.SimPRMD_+3A_x">x</code></td>
<td>
<p>SimPRMD object to summarise</p>
</td></tr>
<tr><td><code id="plot.SimPRMD_+3A_...">...</code></td>
<td>
<p>other arguments ignored (for compatibility with generic)</p>
</td></tr>
<tr><td><code id="plot.SimPRMD_+3A_title.add">title.add</code></td>
<td>
<p>controls whether there is a title on plots or not.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Check ?SimPRMD for example

</code></pre>

<hr>
<h2 id='print.summary.RunPRMD'>Displays a useful description of a summary.RunPRMD object</h2><span id='topic+print.summary.RunPRMD'></span>

<h3>Description</h3>

<p>Displays a useful description of a summary.RunPRMD object. Call by
<code>link{summary.RunPRMD}</code>. Check <code>link{summary.RunPRMD}</code> for the
details of the print information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.RunPRMD'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.RunPRMD_+3A_x">x</code></td>
<td>
<p>summary.RunPRMD object to summarise</p>
</td></tr>
<tr><td><code id="print.summary.RunPRMD_+3A_...">...</code></td>
<td>
<p>other arguments ignored (for compatibility with generic)</p>
</td></tr>
</table>

<hr>
<h2 id='print.summary.SimPRMD'>Displays a useful description of a summary.SimPRMD object</h2><span id='topic+print.summary.SimPRMD'></span>

<h3>Description</h3>

<p>Displays a useful description of a summary.SimPRMD object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.SimPRMD'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.SimPRMD_+3A_x">x</code></td>
<td>
<p>summary.SimPRMD object to summarise</p>
</td></tr>
<tr><td><code id="print.summary.SimPRMD_+3A_...">...</code></td>
<td>
<p>other arguments ignored (for compatibility with generic)</p>
</td></tr>
</table>

<hr>
<h2 id='prob'>Toxicity probability matrix</h2><span id='topic+prob'></span>

<h3>Description</h3>

<p>A 6 dimension array providing the toxicity probability of different
scenarios. The dimension is 4 3 6 6 3 5 which represents scenario, cycle
effect, dose level, cycle number, toxicity type, and tox grade. Scenarios are
ordered in a way that the first scenario is MTD = dose 2, the second is MTD =
dose 3, the third is MTD = dose 4, and the fourth is MTD = dose 5. The three
Cycle effect trend are decreasing, flat, and increasing toxicity trend over
cycles. There are 6 doses, 6 cycles, 3 toxicity types and 5 toxicity grades.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prob
</code></pre>


<h3>Format</h3>

<p>An object of class <code>array</code> of dimension 4 x 3 x 6 x 6 x 3 x 5.</p>

<hr>
<h2 id='RunPRMD'>Implement a Multi-Stage Phase I Dose-Finding Design to recommend dosage
selection based on the data collected in the available patient cohorts</h2><span id='topic+RunPRMD'></span>

<h3>Description</h3>

<p>A function to implement a Multi-Stage Phase I Dose-Finding Design to
recommend dosage selection based on the data collected in the available
patient cohorts. The available models include 1-stage model with/without
individualized dose modification, 3-stage model with/without individualized
dose modification, 3-stage model with individualized dose modification on
stage II and 3-stage model with individualized dose modification on stage I
and dose modification on stage II.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RunPRMD(
  seed = 1234,
  patlist,
  patID_act = NULL,
  cycle_act = NULL,
  dose_act = NULL,
  dlt_act = NULL,
  doses = 1:6,
  cycles = 1:6,
  tox.target = 0.28,
  p_tox1 = 0.2,
  p_tox2 = 0.2,
  trialSize = 36,
  chSize = 3,
  thrd1 = 0.28,
  thrd2 = 0.28,
  proxy.thrd = 0.1,
  param.ctrl = list(),
  n.iters = 10000,
  burn.in = 5000,
  thin = 2,
  n.chains = 1,
  effcy.flag = T,
  ICD.flag = T,
  DLT.drop.flag = T,
  testedD = T,
  IED.flag = T,
  ICD_thrd = 0.3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RunPRMD_+3A_seed">seed</code></td>
<td>
<p>The seed of R's random number generator. Default is 1234</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_patlist">patlist</code></td>
<td>
<p>A list of the patient treatment records, which must contains
the following variables:
</p>
 <dl>
<dt>PatID</dt><dd><p>denotes the patient ID where the elements are
specified by cohort and subject number. For example, &quot;cohort2subject3&quot;
denotes the third subject in the second cohort</p>
</dd>
<dt>dose</dt><dd><p>records the dose level assigned for each patient through the
whole treatment</p>
</dd>
<dt>cycle</dt><dd><p>shows the treatment cycle information of each record</p>
</dd>
<dt>nTTP</dt><dd><p>records the corresponding nTTP score.</p>
</dd>
<dt>dlt</dt><dd><p>indicates whether a DLT event is observed or not?</p>
</dd>
<dt>efficacy</dt><dd><p>provides the continuous efficacy for each cycle. Required
when <code>effcy.flag == T</code>. The range of efficacy is (0, 1), use -1 for
missing efficacy response.</p>
</dd> </dl>
<p> See <code><a href="#topic+patlist_sim">patlist_sim</a></code> for an
example.</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_patid_act">patID_act</code></td>
<td>
<p>A vector recording the patients' ID who need dose
recommendation for next cycle. Default is <code>NULL</code></p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_cycle_act">cycle_act</code></td>
<td>
<p>A vector recording the current cycle of patID_act. Default
is <code>NULL</code></p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_dose_act">dose_act</code></td>
<td>
<p>A vector recording the current dose level of patID_act.
Default is <code>NULL</code></p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_dlt_act">dlt_act</code></td>
<td>
<p>A vector indicating whether a dlt is observed in current
cycle for current patients. Default is <code>NULL</code></p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_doses">doses</code></td>
<td>
<p>A vector of doses that users are going to explore. Default is
1:6, where dose 1 through dose 6 are being tested.</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_cycles">cycles</code></td>
<td>
<p>A vector of cycles that the treatment plans to go through.
Default is 1:6, where patients will experience up to 6 cycles of the
treatment</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_tox.target">tox.target</code></td>
<td>
<p>The target toxicity of the treatment. Default is 0.28.
See details below.</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_p_tox1">p_tox1</code></td>
<td>
<p>The probability cutoff for cycle 1 toxicity. Default is 0.2.
See details below.</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_p_tox2">p_tox2</code></td>
<td>
<p>The probability cutoff for later cycles toxicity beyond
cycle 1. Default is 0.2. See Details below.</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_trialsize">trialSize</code></td>
<td>
<p>The maximum sample size for trial simulation. Default is
36. Must be the multiple of cohort size (<code>chSize</code>).</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_chsize">chSize</code></td>
<td>
<p>The cohort size of patients recruited. Default is 3.</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_thrd1">thrd1</code></td>
<td>
<p>An upper bound of toxicity for cycle 1 of the treatment.
Default is 0.28. See Details below.</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_thrd2">thrd2</code></td>
<td>
<p>An upper bound of toxicity for late cycles of the treatment,
beyond cycle 1. Default is 0.28. See Details below</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_proxy.thrd">proxy.thrd</code></td>
<td>
<p>A distance parameter to define efficacious doses. Any
dose whose predicted efficacy is within proxy.thrd away from the largest
one among the safe doses will be declared an efficacious dose.</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_param.ctrl">param.ctrl</code></td>
<td>
<p>A list specifying the prior distribution for the
parameters. </p>
<dl>
<dt>p1_beta_intercept</dt><dd><p>the prior mean of
intercept of toxicity model assuming a normal prior</p>
</dd>
<dt>p2_beta_intercept</dt><dd><p>the precision (inverse of variance) of intercept
of toxicity model assuming a normal prior</p>
</dd>
<dt>p1_beta_cycle</dt><dd><p>the prior mean of cycle effect of toxicity model
assuming a normal prior</p>
</dd>
<dt>p2_beta_cycle</dt><dd><p>the precision (inverse of variance) of cycle effect
of toxicity model assuming a normal prior</p>
</dd>
<dt>p1_beta_dose</dt><dd><p>the prior minimum of dose effect of toxicity model
assuming a uniform prior</p>
</dd>
<dt>p2_beta_dose</dt><dd><p>the prior maximum of dose effect of toxicity model
assuming a uniform prior</p>
</dd>
<dt>p1_alpha</dt><dd><p>the prior mean vector of the parameters from efficacy
model assuming a multivariate normal prior</p>
</dd>
<dt>p2_alpha</dt><dd><p>the prior precision matrix (inverse of covariance matrix)
of the parameters from efficacy model assuming a multivariate normal
prior</p>
</dd>
<dt>p1_gamma0</dt><dd><p>the prior mean of association parameter <code class="reqn">\gamma</code>
(See Du et al(2017)) of two submodels of the joint model assuming a
normal prior</p>
</dd>
<dt>p2_gamma0</dt><dd><p>the prior precision (inverse of variance) of association
parameter <code class="reqn">\gamma</code> of two submodels of the joint model assuming a
normal prior. </p>
</dd></dl>
<p> Default is non-informative priors. </p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_n.iters">n.iters</code></td>
<td>
<p>Total number of MCMC simulations. Default is 10,000.</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_burn.in">burn.in</code></td>
<td>
<p>Number of burn=ins in the MCMC simulation. Default is 5,000.</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_thin">thin</code></td>
<td>
<p>Thinning parameter. Default is 2.</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_n.chains">n.chains</code></td>
<td>
<p>No. of MCMC chains in Bayesian model fitting. Default is
1. Will check the convergence of MCMC chains by the potential scale
reduction factor (PSRF) when <code>n.chains</code> &gt; 1.</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_effcy.flag">effcy.flag</code></td>
<td>
<p>Whether efficacy data is modeled in the model fitting or
not. Default is TRUE.</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_icd.flag">ICD.flag</code></td>
<td>
<p>Whether we allow individualized dose modification in stage
1 model or not? Default is TRUE. See details below</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_dlt.drop.flag">DLT.drop.flag</code></td>
<td>
<p>Whether the patients should suspend the treatment when
observing DLT. Default is TRUE.</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_testedd">testedD</code></td>
<td>
<p>Default is TRUE. Whether we only allow ICD or IED to be less
than or equal to the maximum dose tested in first cycle.</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_ied.flag">IED.flag</code></td>
<td>
<p>Default is TRUE. Whether we allow dose changing for cycle &gt;
1 in stage 2 model or not?</p>
</td></tr>
<tr><td><code id="RunPRMD_+3A_icd_thrd">ICD_thrd</code></td>
<td>
<p>The cut-off point of the posterior toxicity probability in
defining ICD. Default is 0.3. See details below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The RunPRMD function implement a Multi-Stage Phase I Dose&ndash;Finding
Design to recommend dosage selection based on the data collected in the
available patient cohorts. The function will automatically identify the
model and the stage based on all flags and the records. For the details
of argument <code>tox.target</code>, <code>p_tox1</code>, <code>p_tox2</code>, <code>thrd1</code>,
<code>thrd2</code> and <code>ICD_thrd</code>, please check the help document of
<code><a href="#topic+SimPRMD">SimPRMD</a></code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>patlist</code></td>
<td>
<p>The input data <code>patlist</code></p>
</td></tr> <tr><td><code>doseA</code></td>
<td>
<p>The
recommended dose level for cycle 1 for new cohorts</p>
</td></tr> <tr><td><code>pat_rec</code></td>
<td>
<p>The
recommended dose for current patients for next cycle</p>
</td></tr>
<tr><td><code>effcy.flag</code></td>
<td>
<p>The input argument <code>effcy.flag</code></p>
</td></tr> <tr><td><code>doses</code></td>
<td>
<p>The
input argument <code>doses</code></p>
</td></tr> <tr><td><code>cycles</code></td>
<td>
<p>The input argument
<code>cycles</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data("patlist_sim")
# check the whole dataset by function patlist.display
patlist.display(patlist_sim, n.dose = 6, n.cycle = 6)

# When we pick the records before 6th cohort enrolled in the study
L &lt;- length(patlist_sim$PatID)
patlist &lt;- lapply(patlist_sim, function(a){a &lt;- a[-(44:L)]})
patlist.display(patlist, n.dose = 6, n.cycle = 6)

#The table shows the current patient in the trial. Now record the active
#patient ID and records as follows

patID_act &lt;- c("cohort1subject1", "cohort1subject2", "cohort1subject3",
               "cohort2subject1", "cohort2subject2", "cohort2subject3",
               "cohort3subject2", "cohort3subject3",
               "cohort4subject1", "cohort4subject2", "cohort4subject3",
               "cohort5subject1", "cohort5subject2", "cohort5subject3")
cycle_act &lt;- c(5, 5, 5, 4, 4, 4, 3, 3, 2, 2, 2, 1, 1 ,1)
dose_act &lt;- c(3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4)
dlt_act &lt;- c(0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0)


test &lt;- RunPRMD(patlist = patlist, patID_act = patID_act,
                cycle_act = cycle_act, dose_act = dose_act,
                dlt_act = dlt_act, trialSize = 36, chSize = 3,
                effcy.flag = TRUE, ICD.flag = TRUE, DLT.drop.flag = TRUE,
                IED.flag = TRUE, ICD_thrd = 0.3)

summary(test)
plot(test)
plot(test, select_cycle = 1:2)


</code></pre>

<hr>
<h2 id='SimPRMD'>Simulation for a Multi-Stage Phase I Dose-Finding Design</h2><span id='topic+SimPRMD'></span>

<h3>Description</h3>

<p>A function to implement simulations for a multi-stage phase 1 dose-finding
design incorporating a longitudinal continuous efficacy outcome and
toxicity data from multiple treatment cycles. The available models include
1-stage model with/without individualized dose modification, 3-stage model
with/without individualized dose modification, 3-stage model with
individualized dose modification on stage II and 3-stage model with
individualized dose modification on stage I and dose modification on stage
II.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimPRMD(
  seed = 1234,
  numTrials = 100,
  doses = 1:6,
  cycles = 1:6,
  eff.structure = matrix(0, nrow = 6, ncol = 6),
  eff.Sigma = diag(6),
  eff.sd_trans = 1.5,
  tox.target = 0.28,
  p_tox1 = 0.2,
  p_tox2 = 0.2,
  trialSize = 36,
  chSize = 3,
  thrd1 = 0.28,
  thrd2 = 0.28,
  proxy.thrd = 0.1,
  tox.matrix = NULL,
  wm = matrix(c(0, 0.5, 0.75, 1, 1.5, 0, 0.5, 0.75, 1, 1.5, 0, 0, 0, 0.5, 1), byrow = T,
    ncol = 5),
  toxmax = 2.5,
  toxtype = NULL,
  intercept.alpha = NULL,
  coef.beta = NULL,
  cycle.gamma = NULL,
  param.ctrl = list(),
  n.iters = 10000,
  burn.in = 5000,
  thin = 2,
  n.chains = 1,
  effcy.flag = T,
  ICD.flag = T,
  DLT.drop.flag = T,
  testedD = T,
  IED.flag = T,
  ICD_thrd = 0.3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimPRMD_+3A_seed">seed</code></td>
<td>
<p>The seed of R's random number generator. Default is 1234</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_numtrials">numTrials</code></td>
<td>
<p>An integer specifying the number of simulations</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_doses">doses</code></td>
<td>
<p>A vector of doses that users are going to explore. Default is
1:6, where dose 1 through dose 6 are being tested.</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_cycles">cycles</code></td>
<td>
<p>A vector of cycles that the treatment plans to go through.
Default is 1:6, where patients will experience up to 6 cycles of the
treatment</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_eff.structure">eff.structure</code></td>
<td>
<p>A matrix provides the mean of the multivariate
Gaussian distribution in efficacy data generation. Specifically, the
<code class="reqn">(i, j)</code>th element represents the mean value of <code class="reqn">i</code>th dose level
and <code class="reqn">j</code>th cycle of the Gaussian distribution for efficacy data
generation. Default is a 6 by 6 zero matrix</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_eff.sigma">eff.Sigma</code></td>
<td>
<p>The covariance matrix of the multivariate Guassian
distribution in efficacy data generation. See details below.</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_eff.sd_trans">eff.sd_trans</code></td>
<td>
<p>A positive number controls the skewness of the
distribution of the efficacy response. Default is 1.5. See details below.</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_tox.target">tox.target</code></td>
<td>
<p>The target toxicity of the treatment. Default is 0.28.
See details below.</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_p_tox1">p_tox1</code></td>
<td>
<p>The probability cutoff for cycle 1 toxicity. Default is 0.2.
See details below.</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_p_tox2">p_tox2</code></td>
<td>
<p>The probability cutoff for later cycles toxicity beyond
cycle 1. Default is 0.2. See Details below.</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_trialsize">trialSize</code></td>
<td>
<p>The maximum sample size for trial simulation. Default is
36. Must be the multiple of cohort size, represented by chSize</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_chsize">chSize</code></td>
<td>
<p>The cohort size of patients recruited. Default is 3.</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_thrd1">thrd1</code></td>
<td>
<p>An upper bound of toxicity for cycle 1 of the treatment.
Default is 0.28. See Details below.</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_thrd2">thrd2</code></td>
<td>
<p>An upper bound of toxicity for late cycles of the treatment,
beyond cycle 1. Default is 0.28. See Details below</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_proxy.thrd">proxy.thrd</code></td>
<td>
<p>A distance parameter to define efficacious doses. Any
dose whose predicted efficacy is within proxy.thrd away from the largest
one among the safe doses will be declared an efficacious dose.</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_tox.matrix">tox.matrix</code></td>
<td>
<p>Optional. A four-dimension array specifying the
probabilities of the occurrences of certain grades for certain types of
toxicities, at each dose level and cycle under consideration. Dimension 1
refers to doses; dimension 2 corresponds to cycles of the treatment;
dimension 3 regards the types of toxicities while dimension 4 relates to
grades. If null, which is default choice, the arguments toxtype,
intercept.alpha, coef.beta, cycle.gamma must be provided to simulate this
array.</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_wm">wm</code></td>
<td>
<p>Clinical weight matrix, where toxicity types define the rows
while the toxicity grades define the columns. Usually solicited from
physicians.</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_toxmax">toxmax</code></td>
<td>
<p>The normalization constant used in computing nTTP score. For
details, see Ezzalfani et al(2013).</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_toxtype">toxtype</code></td>
<td>
<p>Only specified when tox.matrix is null. This argument, a
character vector, specifies toxicity types considered in the trial.</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_intercept.alpha">intercept.alpha</code></td>
<td>
<p>Only specified when tox.matrix is null. A four
element numeric vector specifying the intercepts for the cumulative
probabilities of the occurrences of grades 0-4 of toxicities in
proportional odds model. See Details below.</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_coef.beta">coef.beta</code></td>
<td>
<p>Only specified when tox.matrix is null. A n numeric vector
specifying the slope for dose in proportional odds model for n types of
toxicities. See Details below</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_cycle.gamma">cycle.gamma</code></td>
<td>
<p>Only specified when tox.matrix is null. A scalar
controlling the cycle effect in simulation in proportional odds model.
See Details below</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_param.ctrl">param.ctrl</code></td>
<td>
<p>A list specifying the prior distribution for the
parameters. </p>
<dl>
<dt>p1_beta_intercept</dt><dd><p>the prior mean of
intercept of toxicity model assuming a normal prior</p>
</dd>
<dt>p2_beta_intercept</dt><dd><p>the precision (inverse of variance) of intercept
of toxicity model assuming a normal prior</p>
</dd>
<dt>p1_beta_cycle</dt><dd><p>the prior mean of cycle effect of toxicity model
assuming a normal prior</p>
</dd>
<dt>p2_beta_cycle</dt><dd><p>the precision (inverse of variance) of cycle effect
of toxicity model assuming a normal prior</p>
</dd>
<dt>p1_beta_dose</dt><dd><p>the prior minimum of dose effect of toxicity model
assuming a uniform prior</p>
</dd>
<dt>p2_beta_dose</dt><dd><p>the prior maximum of dose effect of toxicity model
assuming a uniform prior</p>
</dd>
<dt>p1_alpha</dt><dd><p>the prior mean vector of the parameters from efficacy
model assuming a multivariate normal prior</p>
</dd>
<dt>p2_alpha</dt><dd><p>the prior precision matrix (inverse of covariance matrix)
of the parameters from efficacy model assuming a multivariate normal
prior</p>
</dd>
<dt>p1_gamma0</dt><dd><p>the prior mean of association parameter <code class="reqn">\gamma</code>
(See Du et al(2017)) of two submodels of the joint model assuming a
normal prior</p>
</dd>
<dt>p2_gamma0</dt><dd><p>the prior precision (inverse of variance) of association
parameter <code class="reqn">\gamma</code> of two submodels of the joint model assuming a
normal prior. </p>
</dd></dl>
<p> Default is non-informative priors. </p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_n.iters">n.iters</code></td>
<td>
<p>Total number of MCMC simulations. Default is 10,000.</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_burn.in">burn.in</code></td>
<td>
<p>Number of burn=ins in the MCMC simulation. Default is 5,000.</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_thin">thin</code></td>
<td>
<p>Thinning parameter. Default is 2.</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_n.chains">n.chains</code></td>
<td>
<p>No. of MCMC chains in Bayesian model fitting. Default is 1</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_effcy.flag">effcy.flag</code></td>
<td>
<p>Whether we include efficacy response in modeling or not?</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_icd.flag">ICD.flag</code></td>
<td>
<p>Whether we allow dose changing for cycle &gt; 1 in stage 1
model or not? Default is TRUE. See details below</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_dlt.drop.flag">DLT.drop.flag</code></td>
<td>
<p>Whether the patients should suspend the treatment when
observing DLT. Default is TRUE</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_testedd">testedD</code></td>
<td>
<p>Default is TRUE. Whether we only allow ICD or IED among
cycle 1 tested dose level</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_ied.flag">IED.flag</code></td>
<td>
<p>Default is TRUE. Whether we allow dose changing for cycle &gt;
1 in stage 2 model or not?</p>
</td></tr>
<tr><td><code id="SimPRMD_+3A_icd_thrd">ICD_thrd</code></td>
<td>
<p>The cut-off point of the posterior toxicity probability in
defining ICD. Default is 0.3. See details below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The user can simulation efficacy response with different
dose-efficacy and cycle-efficacy pattern using argument
<code>eff.structure</code>, <code>eff.Sigma</code> and <code>eff.sd_trans</code>. The
sampling process of efficacy response start from generating sample <code class="reqn">z
  = {z1, \ldots, zd} </code> from multivariate Gaussian distribution </p>
<p style="text-align: center;"><code class="reqn">z ~
  MVN(\mu, V)</code>
</p>
<p>, where <code class="reqn">\mu</code> and <code class="reqn">V</code> are specified by
<code>eff.structure</code> and <code>eff.Sigma</code>, respectively. Define
<code class="reqn">\phi</code> be the density of <code class="reqn">N(0, \sigma^2)</code> with CDF <code class="reqn">\Phi</code>,
and <code class="reqn">\sigma^2</code> is set by <code>eff.sd_trans</code>. Then the efficacy
response is calculated by taking the CDF of <code class="reqn">z</code>: </p>
<p style="text-align: center;"><code class="reqn">x={x1, \ldots,
  xd} = \Phi(z) = { \Phi(z1), \ldots, \Phi(zd)}</code>
</p>
<p> is the generated efficacy
response. Notice here the variance parameter <code class="reqn">\sigma^2_{trans}</code>
controls the variance of the generated efficacy.
</p>
<p>The user can simulate longitudinal efficacy response with
different dose-efficacy and cycle-efficacy pattern using argument
<code>eff.structure</code>, <code>eff.Sigma</code> and <code>eff.sd_trans</code>. The
sampling process of efficacy response starts from generating <code class="reqn">z =
  {z1, \ldots, zd} </code> from multivariate Gaussian distribution </p>
<p style="text-align: center;"><code class="reqn">z ~
  MVN(\mu, V)</code>
</p>
<p>, where <code class="reqn">\mu</code> and <code class="reqn">V</code> are specified by
<code>eff.structure</code> and <code>eff.Sigma</code>, respectively. Define
<code class="reqn">\phi</code> be the density of <code class="reqn">N(0, \sigma^2)</code> with CDF <code class="reqn">\Phi</code>,
where <code class="reqn">\sigma^2</code> is set by <code>eff.sd_trans</code>. Then the efficacy
measure is generated by taking the CDF of <code class="reqn">z</code>: </p>
<p style="text-align: center;"><code class="reqn">x={x1, \ldots,
  xd} = \Phi(z) = { \Phi(z1), \ldots, \Phi(zd)}</code>
</p>
<p>. Notice here the variance
parameter <code class="reqn">\sigma^2_{trans}</code> controls the variance of the generated
efficacy.
</p>
<p><code>p_tox1</code>, <code>p_tox2</code>, <code>thrd1</code> and <code>thrd2</code> are used to
define allowable (safe) doses the probability conditions for cycle 1:
</p>
<p style="text-align: center;"><code class="reqn">P(nTTP1 &lt; thrd1) &gt; p_tox1</code>
</p>
<p> and for cycle &gt; 1: </p>
<p style="text-align: center;"><code class="reqn">p(nTTP2 &lt;
  thrd2) &gt; p_tox2</code>
</p>
<p> , where <code class="reqn">nTTP1</code> and <code class="reqn">nTTP2</code> denote the posterior
estimate of nTTP for cycle 1 and the average of cycle &gt; 1. When we
implement model with individualized dose modification, we only check the
condition for cycle 1 for defining allowable (safe) doses.
</p>
<p><code>ICD_thrd</code> are used to find ICD. ICD is defined as the maximum dose
which satisfy the condition </p>
<p style="text-align: center;"><code class="reqn">P(nTTPi &lt;  target.tox) &gt; ICD_thrd</code>
</p>
<p> ,
where <code class="reqn">nTTPi</code> is the individualized posterior predicted nTTP score.
The individualized dose modification for next cycle will not escalate
more than 1 dose from the current dose.
</p>


<h3>Value</h3>

<table>
<tr><td><code>senerio_sum</code></td>
<td>
<p>contains <code>mnTTP.M</code> the matrix of mean nTTP
for each dose and cycle and <code>pDLT.M</code> matrix of probability of
observing DLT for each dose and cycle</p>
</td></tr> <tr><td><code>eff_sum</code></td>
<td>
<p>When
<code>effcy.flag == TRUE</code>, contains <code>eff.M</code> the mean efficacy for
each dose and cycle and <code>err.cor.ls</code> A list with a length of dose
levels numbers recording the marginal correlation matrix across cycles of
efficacy data for each dose level</p>
</td></tr> <tr><td><code>list_simul</code></td>
<td>
<p>A list of length
numTrials. Each element includes <code>patlist</code> which records all the
treatment and outcome information; <code>dose_aloca</code> which shows the
cycle 1 dose allocation; <code>doseA</code> which saves the recommended dose
level for cycle 1 at the end of the phase I simulation, equals &quot;early
break&quot; if the trial was stop before finishing the trial; <code>n.cohort</code>
indicates the last cohort in the trial; <code>pp.nTTPM</code> gives the
posterior probability of nTTP less than target toxicity <code>tox.target</code>
for all dose level any cycles and <code>message</code> saves the message of
each trial.</p>
</td></tr> <tr><td><code>chSize</code></td>
<td>
<p>The input argument <code>chSize</code></p>
</td></tr>
<tr><td><code>sim.time</code></td>
<td>
<p>Time cost in simulation</p>
</td></tr> <tr><td><code>doses</code></td>
<td>
<p>The input argument
<code>doese</code></p>
</td></tr> <tr><td><code>cycles</code></td>
<td>
<p>The input argument <code>cycles</code></p>
</td></tr>
<tr><td><code>effcy.flag</code></td>
<td>
<p>The input argument <code>effcy.flag</code></p>
</td></tr>
<tr><td><code>proxy.thrd</code></td>
<td>
<p>The input argument <code>proxy.thrd</code></p>
</td></tr>
<tr><td><code>DLT.drop.flag</code></td>
<td>
<p>The input argument <code>DLT.drop.flag</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data("prob")      # load prob.RData from package phaseI, Details see "?prob"
data("eff")       # load eff.RData from package phaseI. Details see "?eff"

eff.structure = eff$Dose_Cycle_Meff[2, 2, , ]
eff.Sigma = eff$Sigma
eff.sd_trans = eff$sd_trans

wm &lt;- matrix(c(0, 0.5, 0.75, 1, 1.5,
               0, 0.5, 0.75, 1, 1.5,
               0, 0, 0, 0.5, 1),
             byrow = TRUE, ncol
              = 5)                          # weighted matrix for toxicity matrix
                                            # nrow = No.of type; ncol = No. of grade
toxmax &lt;- 2.5
tox.matrix &lt;- prob["MTD4", "flat", , , , ]


#------- a flat dose-toxicity, dose-efficacy, cycle-efficacy pattern------#

simul1 &lt;- SimPRMD(numTrials = 1, tox.matrix = tox.matrix,
                  eff.structure = eff.structure, eff.Sigma = eff.Sigma,
                  eff.sd_trans = eff.sd_trans, wm = wm, toxmax = toxmax,
                  trialSize = 36)

#------- a flat dose-toxicity pattern model ------#

simul2 &lt;- SimPRMD(numTrials = 1, toxtype = c("H", "L", "M"),
                  intercept.alpha = c(1.9, 2.3, 2.6, 3.1),
                  coef.beta = c(-0.3, -0.2, -0.25),
                  cycle.gamma = 0, tox.target = 0.23,
                  thrd1 = 0.23, thrd2 = 0.23, p_tox1 = 0.2, p_tox2 = 0.2,
                  ICD.flag = FALSE, IED.flag = FALSE, effcy.flag = TRUE)

summary(simul2)
plot(simul2)


</code></pre>

<hr>
<h2 id='summary.RunPRMD'>Summary a RunPRMD object</h2><span id='topic+summary.RunPRMD'></span>

<h3>Description</h3>

<p>Summary a RunPRMD object. Print the information of recommended dosage
selection along with the mean nTTP and the number of DLT for all doses and
cycles. Will print the mean efficacy for all doses and cycles when
implementing <code><a href="#topic+RunPRMD">RunPRMD</a></code> with option <code>effcy.flag = TRUE</code>. The
collected data is displayed in a human-readable table whose cell contain 3
values including observed nTTP, DLT, and dose assignment. The higher the
dose, the warmer the cell background color is. The black color of the
records indicates DLT equals 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'RunPRMD'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.RunPRMD_+3A_object">object</code></td>
<td>
<p>RunPRMD object to summarise</p>
</td></tr>
<tr><td><code id="summary.RunPRMD_+3A_...">...</code></td>
<td>
<p>other arguments ignored (for compatibility with generic)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>object</code></td>
<td>
<p>The output of function <code>RunPRMD</code></p>
</td></tr>
<tr><td><code>mnttp.M</code></td>
<td>
<p>The mean nTTP for all doses and cycles</p>
</td></tr>
<tr><td><code>dlt.count.M</code></td>
<td>
<p>The number of DLT for all doses and cycles</p>
</td></tr>
<tr><td><code>eff.M</code></td>
<td>
<p>The mean efficacy for all doses and cycles. Return
<code>NULL</code> when <code>object$effcy.flag == TRUE</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Check ?RunPRMD for example

</code></pre>

<hr>
<h2 id='summary.SimPRMD'>Summary a SimPRMD object</h2><span id='topic+summary.SimPRMD'></span>

<h3>Description</h3>

<p>Summary a SimPRMD object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SimPRMD'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.SimPRMD_+3A_object">object</code></td>
<td>
<p>SimPRMD object to summarise</p>
</td></tr>
<tr><td><code id="summary.SimPRMD_+3A_...">...</code></td>
<td>
<p>other arguments ignored (for compatibility with generic)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>senerio_sum</code></td>
<td>
<p>Output <code>senerio_sum</code> of function <code>SimPRMD</code></p>
</td></tr>
<tr><td><code>eff_sum</code></td>
<td>
<p>Output <code>eff_sum</code> of function <code>SimPRMD</code></p>
</td></tr>
<tr><td><code>n.trial</code></td>
<td>
<p>The number of trials in the simulation</p>
</td></tr>
<tr><td><code>alloc.perc</code></td>
<td>
<p>The dose allocation percentage for cycle1</p>
</td></tr>
<tr><td><code>n.stop</code></td>
<td>
<p>The number of early stop cases</p>
</td></tr>
<tr><td><code>m.n.pat</code></td>
<td>
<p>The average number of patient in each trial</p>
</td></tr>
<tr><td><code>m.dlt.rt</code></td>
<td>
<p>dlt rate</p>
</td></tr>
<tr><td><code>c1_dlt.rt</code></td>
<td>
<p>Cycle 1 dlt rate</p>
</td></tr>
<tr><td><code>cs_dlt.rt</code></td>
<td>
<p>Subsequent cycle (cycle &gt; 1) dlt rate</p>
</td></tr>
<tr><td><code>alloc.perc</code></td>
<td>
<p>Dose allocation of cycle 1</p>
</td></tr>
<tr><td><code>sbsq.alloc</code></td>
<td>
<p>Dose allocation of subsequent cycles (cycle &gt; 1)</p>
</td></tr>
<tr><td><code>rec.prec</code></td>
<td>
<p>The percentage of Recommended doses for cycle 1</p>
</td></tr>
<tr><td><code>effcy.flag</code></td>
<td>
<p>Argument <code>effcy.flag</code> of function <code>SimPRMD</code></p>
</td></tr>
<tr><td><code>DLT.drop.flag</code></td>
<td>
<p>Argument <code>DLT.drop.flag</code> of function
<code>SimPRMD</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Check ?SimPRMD for example

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
