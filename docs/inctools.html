<!DOCTYPE html><html><head><title>Help for package inctools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {inctools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#inctools'><p>inctools: A Package for Incidence Estimation</p></a></li>
<li><a href='#excalibdata'><p>The dataset 'excalibdata.Rdata' contains example data from an evaluation of</p>
an assay measuring recency of infection. At an assay result of &lt;10, the
specimen is considered to be recently infected. It further contains viral
load data, which is commonly used to reduce false recency. For example,
when recency is defined as assay result &lt;10 and viral load &gt; 1000, the FRR
is substantially lower (but the MDRI is also reduced).</a></li>
<li><a href='#frrcal'><p>Estimate False-Recent Rate</p></a></li>
<li><a href='#inccounts'><p>Incidence and incidence difference statistics from trinomial counts of HIV and recency</p></a></li>
<li><a href='#incpower'><p>Power and Required Sample Size</p></a></li>
<li><a href='#incprecision'><p>Precision and Required Sample Size</p></a></li>
<li><a href='#incprops'><p>Incidence and incidence difference statistics from trinomial prevalences of HIV and recency</p></a></li>
<li><a href='#mdrical'><p>Estimate Mean Duration of Recent Infection (MDRI)</p></a></li>
<li><a href='#prevcounts'><p>Prevalence and Relative Standard Errors by Counts</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Incidence Estimation Tools</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.15</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-11-05</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for estimating incidence from biomarker data in cross-
    sectional surveys, and for calibrating tests for recent infection. 
    Implements and extends the method of Kassanjee et al. (2012)
    &lt;<a href="https://doi.org/10.1097%2FEDE.0b013e3182576c07">doi:10.1097/EDE.0b013e3182576c07</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.incidence-estimation.org/page/inctools">http://www.incidence-estimation.org/page/inctools</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/SACEMA/inctools/issues">https://github.com/SACEMA/inctools/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>True</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils, magrittr, rlang, dplyr, tibble, cubature,
tmvtnorm, ggplot2, glm2, plyr, pracma, foreach, parallel,
doParallel, binom</td>
</tr>
<tr>
<td>Suggests:</td>
<td>survey, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-11-06 00:19:59 UTC; eduard</td>
</tr>
<tr>
<td>Author:</td>
<td>Eduard Grebe [cre, aut],
  Alex Welte [aut],
  Avery McIntosh [aut],
  Petra BÃ¤umler [aut],
  Reshma Kassanjee [ctb],
  Hilmarie Brand [ctb],
  Cari Van Schalkwyk [ctb],
  Yuruo Li [ctb],
  Simon Daniel [ctb],
  Stefano Ongarello [aut],
  Yusuke Asai [ctb],
  Jeffrey Eaton [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Eduard Grebe &lt;Eduard.Grebe@ucsf.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-11-07 14:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='inctools'>inctools: A Package for Incidence Estimation</h2><span id='topic+inctools'></span><span id='topic+inctools-package'></span>

<h3>Description</h3>

<p>The inctools package uses methods described by Kassanjee, et al. 'A new general biomarker-based incidence estimator,' <em>Epidemiology</em> (2012), to implement functions to calculate incidence and tests of incidence difference between two populations, as well as power and sample size constraints for different study scenarios.
inctools also provides functions for calculation of mean duration of recent infection and false recency rates from assays for recent infection.
</p>


<h3>inctools Functions</h3>

<p>inctools has functions <em>frrcal</em> to estimate false recency rate; <em>mdrical</em> to estimate mean duration of recent infection; <em>incprops</em> and <em>inccounts</em> to calculate estimates and confidence intervals for incidence and incidence difference, as well as other summary and inferential statistics related to the survey; <em>incpower</em> to calculate sample size needed for a given power in a test of incidence difference, or vice versa; and <em>incprecision</em>, which gives sample size needed for a given precision in the incidence estimate or vice versa.
</p>
<p>For a longer introduction, see the introductory vignette for this package. Use browseVignettes(package = &quot;inctools&quot;) to access the vignettes.
</p>

<hr>
<h2 id='excalibdata'>The dataset 'excalibdata.Rdata' contains example data from an evaluation of
an assay measuring recency of infection. At an assay result of &lt;10, the
specimen is considered to be recently infected. It further contains viral
load data, which is commonly used to reduce false recency. For example,
when recency is defined as assay result &lt;10 and viral load &gt; 1000, the FRR
is substantially lower (but the MDRI is also reduced).</h2><span id='topic+excalibdata'></span>

<h3>Description</h3>

<p>The dataset 'excalibdata.Rdata' contains example data from an evaluation of
an assay measuring recency of infection. At an assay result of &lt;10, the
specimen is considered to be recently infected. It further contains viral
load data, which is commonly used to reduce false recency. For example,
when recency is defined as assay result &lt;10 and viral load &gt; 1000, the FRR
is substantially lower (but the MDRI is also reduced).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>excalibdata
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 1460 rows and 7 columns.</p>

<hr>
<h2 id='frrcal'>Estimate False-Recent Rate</h2><span id='topic+frrcal'></span>

<h3>Description</h3>

<p>Estimates subject-level false-recent rate (FRR) for a given time cutoff.
Each subject with any observations after the time cutoff is assigned a recency status according to the majority
of observations for that subject after the cutoff. In the event of exactly half of the observations being
classified as recent, the subject contributes a count of 0.5.
The function performs an exact binomial test and reports the estimated probability of testing recent after the
cutoff, a confidence interval for the proportion, the number of recent results ('successes'),
number of subjects ('trials') and the number of data points contributing to the subject-level estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>frrcal(data = NULL, subid_var = NULL, time_var = NULL,
  recency_cutoff_time = 730.5, recency_rule = "binary_data",
  recency_vars = NULL, recency_params = NULL, alpha = 0.05,
  method = "exact", debug = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="frrcal_+3A_data">data</code></td>
<td>
<p>A data frame containing variables for subject identifier, time (since detectable infection), and variables with biomarker readings or recency status (to be specified in recency_vars)</p>
</td></tr>
<tr><td><code id="frrcal_+3A_subid_var">subid_var</code></td>
<td>
<p>The variable in the dataframe identifying subjects</p>
</td></tr>
<tr><td><code id="frrcal_+3A_time_var">time_var</code></td>
<td>
<p>The variable in the dataframe indicating time between 'time zero' (usually detectable infection) and biomarker measurement</p>
</td></tr>
<tr><td><code id="frrcal_+3A_recency_cutoff_time">recency_cutoff_time</code></td>
<td>
<p>Recency time cut-off ('Big T'). Default=730.5.</p>
</td></tr>
<tr><td><code id="frrcal_+3A_recency_rule">recency_rule</code></td>
<td>
<p>Specified rule for defining recent/non-recent outcomes from biomarker data (see Details)</p>
</td></tr>
<tr><td><code id="frrcal_+3A_recency_vars">recency_vars</code></td>
<td>
<p>Variables to be used in determining recency outcomes</p>
</td></tr>
<tr><td><code id="frrcal_+3A_recency_params">recency_params</code></td>
<td>
<p>Vector of numeric parameters (e.g. thresholds) for determining recency according to the relevant rule</p>
</td></tr>
<tr><td><code id="frrcal_+3A_alpha">alpha</code></td>
<td>
<p>Confidence level, default=0.05.</p>
</td></tr>
<tr><td><code id="frrcal_+3A_method">method</code></td>
<td>
<p>Method for computing confidence interval on binomial probability (passed to binom::binom.confint). Default is Clopper-Pearson 'exact' method. Accepted values: 'c(&quot;exact&quot;, &quot;ac&quot;, &quot;asymptotic&quot;, &quot;wilson&quot;, &quot;prop.test&quot;, &quot;bayes&quot;, &quot;logit&quot;, &quot;cloglog&quot;, &quot;probit&quot;)'.</p>
</td></tr>
<tr><td><code id="frrcal_+3A_debug">debug</code></td>
<td>
<p>Enable debugging mode (browser)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The package contains long form documentation in the form of vignettes that cover the use of the main fucntions. Use browseVignettes(package=&quot;inctools&quot;) to access them.
</p>
<p>recency_rule: binary_data - supply a binary variable with 1=recent and 0=non-recent in recency_vars.
</p>
<p>recency_rule: independent_thresholds: supply one threshold variable per biomarker in recency_vars and the relevant
thresholds, as well as whether a value below or above each threshold indicates recency in recency_params.
</p>
<p>recency_params expects a list of pairs of thresholds and thresholdtypes, with zero indicating a reading below
the threshold implies recency and 1 that a reading above the threshold implies recency. (Note: two values,
a threshold and a thresholdtype per variable must be specified in recency_params. For example, if you specify
recency_vars = c('ODn','ViralLoad') you may specify recency_params = c(1.5,0,500,1), meaning that an ODn reading
below 1.5 AND a viral load reasing above 500 indicates a recent result. Objects with missing values in its
biomarker readings will be excluded from caculation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>frrcal(data=excalibdata,
       subid_var = "SubjectID",
       time_var = "DaysSinceEDDI",
       recency_cutoff_time = 730.5,
       recency_rule = "independent_thresholds",
       recency_vars = c("Result","VL"),
       recency_params = c(10,0,1000,1),
       method = "exact",
       alpha = 0.05)
</code></pre>

<hr>
<h2 id='inccounts'>Incidence and incidence difference statistics from trinomial counts of HIV and recency</h2><span id='topic+inccounts'></span>

<h3>Description</h3>

<p>Incidence and incidence difference statistics from trinomial counts of HIV and recency
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inccounts(N, N_H, N_testR, N_R, DE_H = 1, DE_R = 1, BS_Count = 10000,
  Boot = FALSE, alpha = 0.05, BMest = "same.test", MDRI, RSE_MDRI,
  FRR, RSE_FRR, BigT = 730, Covar_HR = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inccounts_+3A_n">N</code></td>
<td>
<p>Counts of total survey sample size(s) (vector/integer).</p>
</td></tr>
<tr><td><code id="inccounts_+3A_n_h">N_H</code></td>
<td>
<p>Number of HIV positive found in survey(s) (vector/integer).</p>
</td></tr>
<tr><td><code id="inccounts_+3A_n_testr">N_testR</code></td>
<td>
<p>Number tested for recency in survey(s) (vector/integer).</p>
</td></tr>
<tr><td><code id="inccounts_+3A_n_r">N_R</code></td>
<td>
<p>Number of recent cases in survey(s) (vector/integer).</p>
</td></tr>
<tr><td><code id="inccounts_+3A_de_h">DE_H</code></td>
<td>
<p>Design effect of HIV prevalence test (vector/numeric), greater than or equal to 1. If multiple surveys are entered but only one design effect is specified, function assumes entered design effect is identical for both surveys.</p>
</td></tr>
<tr><td><code id="inccounts_+3A_de_r">DE_R</code></td>
<td>
<p>Design effect of recency test (vector/numeric), greater than or equal to 1. If multiple surveys are entered but only one design effect is specified, function assumes entered design effect is identical for both surveys.</p>
</td></tr>
<tr><td><code id="inccounts_+3A_bs_count">BS_Count</code></td>
<td>
<p>Specifies number of bootstrap samples for bootstrapped confidence intervals of incidence.</p>
</td></tr>
<tr><td><code id="inccounts_+3A_boot">Boot</code></td>
<td>
<p>True/False variable indicating whether variance of point estimates is to be calculated by Empirical Bootstrapping (TRUE) or Delta Method (FALSE), the default setting.</p>
</td></tr>
<tr><td><code id="inccounts_+3A_alpha">alpha</code></td>
<td>
<p>test rejection threshold.</p>
</td></tr>
<tr><td><code id="inccounts_+3A_bmest">BMest</code></td>
<td>
<p>Biomarker estimation by one the 3 options 'same.test'(=default), 'FRR.indep', 'MDRI.FRR.indep' (string).</p>
</td></tr>
<tr><td><code id="inccounts_+3A_mdri">MDRI</code></td>
<td>
<p>mean duration of recent infection [days] (vector/integer).</p>
</td></tr>
<tr><td><code id="inccounts_+3A_rse_mdri">RSE_MDRI</code></td>
<td>
<p>Relative standard error of MDRI [days] (vector/integer).</p>
</td></tr>
<tr><td><code id="inccounts_+3A_frr">FRR</code></td>
<td>
<p>False recent rate (vector/integer).</p>
</td></tr>
<tr><td><code id="inccounts_+3A_rse_frr">RSE_FRR</code></td>
<td>
<p>Relative standard error of FRR (vector/integer).</p>
</td></tr>
<tr><td><code id="inccounts_+3A_bigt">BigT</code></td>
<td>
<p>Cut point in days of recency used in biomarker assay to test recency in a given prevalence survey.</p>
</td></tr>
<tr><td><code id="inccounts_+3A_covar_hr">Covar_HR</code></td>
<td>
<p>Covariance of probability of being postive and being categorized recent from survey (or as a vector for multiple surveys).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements assay-based incidence estimation through cross-sectional prevalence and recency of infection tests as described by Kassanjee, et al. 'A new general biomarker-based incidence estimator,' <em>Epidemiology</em> (2012). Function parameters must be specified to include assay test characteristics and survey results as proportions. Confidence intervals are computed via Delta method approximation, except when Boot=TRUE is specified, in which case confidence intervals are generated by empirical bootstrap resampling. Inputs must be in appropriate ranges for appropriate units. Extreme input values may make calculation impossible, and if entered will elicit error notices.
The package contains long form documentation in the form of vignettes that cover the use of the main fucntions. Use browseVignettes(package=&quot;inctools&quot;) to access them.
</p>


<h3>Value</h3>

<p>Incidence estimate, annual risk of infection, confidence interval, relative standard error of estimate and of assay characteristics MDRI and FRR. If multiple surveys are entered, function returns said results, as well as estimates of incidence  differences, confidence intervals of differences, difference relative standard errors, and p-values testing the hypothesis that the difference in incidence measures are zero. Theoretical relative standard error of incidence and incidence difference at infinite sample size is returned only if Boot = FALSE, as that calculation relies on the asymptotic behavior of components of the Delta method approximation, and is not calculable from bootstrapped values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>inccounts(N = c(5000) ,N_H = 1000, N_testR = 1000, N_R = 70,
Boot = FALSE, BMest = 'MDRI.FRR.indep', MDRI = 200, RSE_MDRI = 0.05,
FRR = 0.01, RSE_FRR = 0.2, BigT = 730)


inccounts(N = c(4000,4000,4050) ,N_H = c(1010,1000,900),
N_testR = c(1000,1000,880), N_R = c(60,70,50), Boot = TRUE,
BMest = 'same.test', MDRI = 210, RSE_MDRI = 0.05, FRR = 0.005,
RSE_FRR = 0.19, BigT = 700)


inccounts(N = c(4000,4000) ,N_H = c(1050,1090),
N_testR = c(1000,1000), N_R = c(60,67), Boot = FALSE, BMest = 'FRR.indep',
MDRI = 220, RSE_MDRI = 0.05, FRR = c(0.005,0.005), RSE_FRR = 0.19,
BigT = 610)

</code></pre>

<hr>
<h2 id='incpower'>Power and Required Sample Size</h2><span id='topic+incpower'></span>

<h3>Description</h3>

<p>Calculate power and required sample size for a given power to detect
incidence change.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incpower(I1, I2, PrevH1, PrevH2, n1 = "both", n2 = "both",
  alpha = 0.05, Power = 0.8, SS = "out", CR = 1, DE_H = 1,
  DE_R = 1, BMest = "same.test", MDRI, RSE_MDRI, FRR, RSE_FRR,
  BigT = 730, Boot = FALSE, BS_Count = 1e+05, Cov.PrevH.I = c(0,
  0), debug = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="incpower_+3A_i1">I1</code></td>
<td>
<p>Predicted incidence of HIV in survey 1.</p>
</td></tr>
<tr><td><code id="incpower_+3A_i2">I2</code></td>
<td>
<p>Predicted incidence of HIV in survey 2.</p>
</td></tr>
<tr><td><code id="incpower_+3A_prevh1">PrevH1</code></td>
<td>
<p>Predicted prevalence of HIV in survey 1.</p>
</td></tr>
<tr><td><code id="incpower_+3A_prevh2">PrevH2</code></td>
<td>
<p>Predicted prevalence of HIV in survey 2.</p>
</td></tr>
<tr><td><code id="incpower_+3A_n1">n1</code></td>
<td>
<p>Sample size for survey 1. If equal sample sizes for both surveys are desired at a given power level, both n1 and n2 must have value 'both', which is the default.</p>
</td></tr>
<tr><td><code id="incpower_+3A_n2">n2</code></td>
<td>
<p>Sample size for survey 2. If equal sample sizes for both surveys are desired at a given power level, both n1 and n2 must have value 'both', which is the default.</p>
</td></tr>
<tr><td><code id="incpower_+3A_alpha">alpha</code></td>
<td>
<p>Significance level for test (default alpha=0.05).</p>
</td></tr>
<tr><td><code id="incpower_+3A_power">Power</code></td>
<td>
<p>Desired power used to calculate a sample size for the surveys. Default is 0.80, meaning the function outputs the necessary sample size to achieve stated power for a test of differences in incidence. If Power is set to 'out', function will return power of detecting a difference in incidences for given sample size inputs.</p>
</td></tr>
<tr><td><code id="incpower_+3A_ss">SS</code></td>
<td>
<p>Sample size. Default is 'out', meaning the function takes a power argument and outputs a common sample size needed to achieve power level for test of differences for incidence. If power is desired for a given sample size, parameter value is irrelevant; however, values for n1 and n2 must be specified.</p>
</td></tr>
<tr><td><code id="incpower_+3A_cr">CR</code></td>
<td>
<p>Coverage rate (0-1).</p>
</td></tr>
<tr><td><code id="incpower_+3A_de_h">DE_H</code></td>
<td>
<p>Design effect of HIV prevalence test (vector/integer). If a single value is specified, that value is assumed to be the value for both surveys.</p>
</td></tr>
<tr><td><code id="incpower_+3A_de_r">DE_R</code></td>
<td>
<p>Design effect of recency test (vector/integer). If a single value is specified, that value is assumed to be the value for both surveys.</p>
</td></tr>
<tr><td><code id="incpower_+3A_bmest">BMest</code></td>
<td>
<p>Biomarker test parameter (MDRI, FRR, and RSE) estimation by one the 3 options 'same.test'(default), 'FRR.indep', 'MDRI.FRR.indep' (string).</p>
</td></tr>
<tr><td><code id="incpower_+3A_mdri">MDRI</code></td>
<td>
<p>mean duration of recent infection [days] (vector/integer). If a single value is specified, that value is assumed to be the value for both surveys.</p>
</td></tr>
<tr><td><code id="incpower_+3A_rse_mdri">RSE_MDRI</code></td>
<td>
<p>Relative standard error of MDRI [days] (vector/integer). If a single value is specified, that value is assumed to be the value for both surveys.</p>
</td></tr>
<tr><td><code id="incpower_+3A_frr">FRR</code></td>
<td>
<p>False recent rate (vector/integer). If a single value is specified, that value is assumed to be the value for both surveys.</p>
</td></tr>
<tr><td><code id="incpower_+3A_rse_frr">RSE_FRR</code></td>
<td>
<p>Relative standard error of FRR (vector/integer). If a single value is specified, that value is assumed to be the value for both surveys.</p>
</td></tr>
<tr><td><code id="incpower_+3A_bigt">BigT</code></td>
<td>
<p>Post-infection time cut-off (days). Default 730. If a single value is specified, that value is assumed to be the value for both surveys.</p>
</td></tr>
<tr><td><code id="incpower_+3A_boot">Boot</code></td>
<td>
<p>True/False variable indicating whether variance of point estimates is to be calculated by Empirical Bootstrapping (TRUE) or Delta Method (FALSE), the default setting.</p>
</td></tr>
<tr><td><code id="incpower_+3A_bs_count">BS_Count</code></td>
<td>
<p>Specifies number of bootstrap samples for bootstrapped confidence intervals of incidence.</p>
</td></tr>
<tr><td><code id="incpower_+3A_cov.prevh.i">Cov.PrevH.I</code></td>
<td>
<p>Covariance of prevalence and incidence for bootstrap resampling.</p>
</td></tr>
<tr><td><code id="incpower_+3A_debug">debug</code></td>
<td>
<p>Enable debugging mode (browser)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The package contains long form documentation in the form of vignettes that cover the use of the main fucntions. Use browseVignettes(package=&quot;inctools&quot;) to access them.
</p>


<h3>Value</h3>

<p>Common sample size of two surveys&ndash;or the sample size of one survey given the other has already been completed&ndash;necessary to achieve a given power level for testing a null hypothesis that the incidence rates are identical between populations; alternatively, the power of said test under a particular sample size scenario. Function also returns implied statistics from input values on paramters, confidence limits, and population counts.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>incpower(I1 = 0.05, I2 = 0.03, PrevH1 = 0.20, PrevH2 = 0.20,
n1 = 5000, n2 = 5000, alpha = 0.05, Power = "out", SS = NULL,
DE_H = c(1,1.1), DE_R = 1, BMest = 'same.test', MDRI = 200,
RSE_MDRI = 0.05, FRR = 0.01, RSE_FRR = 0.20, BigT = 730)


incpower(I1 = 0.05, I2 = 0.03, PrevH1 = 0.20, PrevH2 = 0.20,
alpha = 0.05, Power = 0.80, SS = "out", DE_H = 1, DE_R = 1,
BMest = 'FRR.indep', MDRI = 200, RSE_MDRI = 0.05,
FRR = c(0.01,0.009), RSE_FRR = c(0.20,0.21), BigT = 730)
</code></pre>

<hr>
<h2 id='incprecision'>Precision and Required Sample Size</h2><span id='topic+incprecision'></span>

<h3>Description</h3>

<p>Calculate precision of incidence estimate and required sample size for a
given precision of the incidence estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incprecision(I, RSE_I, PrevH, CR, MDRI, RSE_MDRI, FRR, RSE_FRR,
  BigT = 730, DE_H = 1, DE_R = 1, n = "out", step = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="incprecision_+3A_i">I</code></td>
<td>
<p>Expected Incidence.</p>
</td></tr>
<tr><td><code id="incprecision_+3A_rse_i">RSE_I</code></td>
<td>
<p>Relative Standard Error of Incidence Estimate. If this is the desired output, set to &quot;out&quot;.</p>
</td></tr>
<tr><td><code id="incprecision_+3A_prevh">PrevH</code></td>
<td>
<p>Prevalence of HIV.</p>
</td></tr>
<tr><td><code id="incprecision_+3A_cr">CR</code></td>
<td>
<p>Coverage rate: probability (0-1) of being tested for recency when positive for HIV.</p>
</td></tr>
<tr><td><code id="incprecision_+3A_mdri">MDRI</code></td>
<td>
<p>mean duration of recent infection in days (vector/integer).</p>
</td></tr>
<tr><td><code id="incprecision_+3A_rse_mdri">RSE_MDRI</code></td>
<td>
<p>Relative standard error of MDRI (vector/integer).</p>
</td></tr>
<tr><td><code id="incprecision_+3A_frr">FRR</code></td>
<td>
<p>False recent rate (vector/integer).</p>
</td></tr>
<tr><td><code id="incprecision_+3A_rse_frr">RSE_FRR</code></td>
<td>
<p>Relative standard error of FRR (vector/integer).</p>
</td></tr>
<tr><td><code id="incprecision_+3A_bigt">BigT</code></td>
<td>
<p>post-infection time cut-off for true vs. false recency. Default is 730 days.</p>
</td></tr>
<tr><td><code id="incprecision_+3A_de_h">DE_H</code></td>
<td>
<p>Design effect of HIV prevalence test (vector/integer).</p>
</td></tr>
<tr><td><code id="incprecision_+3A_de_r">DE_R</code></td>
<td>
<p>Design effect of recency test (vector/integer).</p>
</td></tr>
<tr><td><code id="incprecision_+3A_n">n</code></td>
<td>
<p>Sample Size: Set to a hypothetical value if the desired output is RSE_I, othewise set to &quot;out&quot; to obtain required sample size.</p>
</td></tr>
<tr><td><code id="incprecision_+3A_step">step</code></td>
<td>
<p>number of steps between minimum I and maximum I in the calculation of a range of output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The package contains long form documentation in the form of vignettes that cover the use of the main fucntions. Use browseVignettes(package=&quot;inctools&quot;) to access them.
</p>
<p>This function summarizes performance of a recent infection test into a standard error of the incidence estimate, given the
estimated test properties and hypothetical survey context or the sample size necessary for a given level of precision.
</p>
<p>Up to two arguments can be specified as ranges, with the input parameter 'step' specifying the number of increments
between the endpoints of the two ranges supplied under the argument name. This yields output for each step.
See the second and third example below
for an illustration of this output.
</p>
<p>Either the argument RSE_I or the argument n must be set to &quot;out&quot;.
</p>


<h3>Value</h3>

<p>Either sample size necessary for a given precision under a given set of testing characteristics and a hypothetical prevalence/incidence scenario, or precision under a particular sample size scenario, with a given hypothetical prevalence/incidence scenario.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>incprecision(I = 0.015, RSE_I = 0.25, PrevH = 0.2, CR = 1,
MDRI = 200, RSE_MDRI = 0.05, FRR = 0.01, RSE_FRR = 0.2,
BigT = 730, DE_H = 1.1, DE_R = 1, n = 'out')

incprecision(I = c(0.015,0.02), RSE_I = 0.25, PrevH = c(0.10,0.20),
CR = 1, MDRI = 200, RSE_MDRI = 0.05, FRR = 0.01, RSE_FRR = 0.2,
BigT = 700, DE_H = 1, DE_R = 1, n = 'out', step = 5)

incprecision(I = 0.017, RSE_I = 'out', PrevH = c(0.10,0.20),
CR = 1, MDRI = 211, RSE_MDRI = 0.05, FRR = 0.009, RSE_FRR = 0.2,
BigT = 720, n = 5000, step = 5)
</code></pre>

<hr>
<h2 id='incprops'>Incidence and incidence difference statistics from trinomial prevalences of HIV and recency</h2><span id='topic+incprops'></span>

<h3>Description</h3>

<p>Incidence and incidence difference statistics from trinomial prevalences of HIV and recency
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incprops(PrevH, RSE_PrevH, PrevR, RSE_PrevR, Boot = FALSE,
  BS_Count = 10000, alpha = 0.05, BMest = "same.test", MDRI,
  RSE_MDRI, FRR, RSE_FRR, BigT = 730, Covar_HR = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="incprops_+3A_prevh">PrevH</code></td>
<td>
<p>Prevalence of HIV (vector/integer).</p>
</td></tr>
<tr><td><code id="incprops_+3A_rse_prevh">RSE_PrevH</code></td>
<td>
<p>Relative Standard Error (RSE) of estimate for population prevalence of HIV (vector/integer).</p>
</td></tr>
<tr><td><code id="incprops_+3A_prevr">PrevR</code></td>
<td>
<p>Proportion of persons found to be 'recent' by biomarker assay among total persons found positive for HIV (vector/integer).</p>
</td></tr>
<tr><td><code id="incprops_+3A_rse_prevr">RSE_PrevR</code></td>
<td>
<p>Relative Standard Error (RSE) of estimate for population proportion of those testing positive for HIV who have been infected recently (vector/integer).</p>
</td></tr>
<tr><td><code id="incprops_+3A_boot">Boot</code></td>
<td>
<p>True/False variable indicating whether variance of point estimates is to be calculated by Empirical Bootstrapping (TRUE) or Delta Method (FALSE), the default setting.</p>
</td></tr>
<tr><td><code id="incprops_+3A_bs_count">BS_Count</code></td>
<td>
<p>Specifies number of bootstrap samples for bootstrapped confidence intervals of incidence.</p>
</td></tr>
<tr><td><code id="incprops_+3A_alpha">alpha</code></td>
<td>
<p>test rejection threshold.</p>
</td></tr>
<tr><td><code id="incprops_+3A_bmest">BMest</code></td>
<td>
<p>Biomarker estimation by one the 3 options 'same.test'(=default), 'FRR.indep', 'MDRI.FRR.indep' (string).</p>
</td></tr>
<tr><td><code id="incprops_+3A_mdri">MDRI</code></td>
<td>
<p>mean duration of recent infection [days] (vector/integer).</p>
</td></tr>
<tr><td><code id="incprops_+3A_rse_mdri">RSE_MDRI</code></td>
<td>
<p>Relative standard error of MDRI [days] (vector/integer).</p>
</td></tr>
<tr><td><code id="incprops_+3A_frr">FRR</code></td>
<td>
<p>False recent rate (vector/integer).</p>
</td></tr>
<tr><td><code id="incprops_+3A_rse_frr">RSE_FRR</code></td>
<td>
<p>Relative standard error of FRR (vector/integer).</p>
</td></tr>
<tr><td><code id="incprops_+3A_bigt">BigT</code></td>
<td>
<p>post-infection time cut-off true vs false recent [days] default 730 days (integer).</p>
</td></tr>
<tr><td><code id="incprops_+3A_covar_hr">Covar_HR</code></td>
<td>
<p>Covariance of probability of being positive and being categorized recent from survey (vector/integer). Note that as the variances of PrevH and PrevR are often quite small, only a suitably commensurate covariance will enable the inversion of the bootstrap covariance matrix for random number generation to proceed without error.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements assay-based incidence estimation through cross-sectional prevalence and recency of infection tests as described by Kassanjee, et al. 'A new general biomarker-based incidence estimator,' <em>Epidemiology</em> (2012). Function parameters must be specified to include assay test characteristics and survey results as proportions. Confidence intervals are computed via Delta method approximation, except when Boot=TRUE is specified, in which case confidence intervals are generated by empirical bootstrap resampling. Inputs must be in appropriate ranges for appropriate units. Extreme input values may make calculation impossible, and if entered will elicit error notices.
</p>
<p>The package contains long form documentation in the form of vignettes that cover the use of the main fucntions. Use browseVignettes(package=&quot;inctools&quot;) to access them.
</p>


<h3>Value</h3>

<p>Returns incidence and incidence difference statistics, annualised risk and implied CIs on test characteristics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>incprops(PrevH = 0.20, RSE_PrevH = 0.028, PrevR = 0.10, RSE_PrevR = 0.09,
         BS_Count = 10000, Boot = TRUE, MDRI = 200, RSE_MDRI = 0.05,
         FRR = 0.01,
         RSE_FRR = 0.2, BigT = 730)


incprops(PrevH = c(0.20,0.21,0.18), RSE_PrevH = c(0.028,0.03,0.022),
         PrevR = c(0.10,0.13,0.12), RSE_PrevR = c(0.094,0.095,0.05),
         BS_Count = 10000, Boot = FALSE, BMest = 'MDRI.FRR.indep', MDRI = c(200,180,180),
         RSE_MDRI = c(0.05,0.07,0.06), FRR = c(0.01,0.009,0.02), RSE_FRR = c(0.2,0.2,0.1),
         BigT = 730)
</code></pre>

<hr>
<h2 id='mdrical'>Estimate Mean Duration of Recent Infection (MDRI)</h2><span id='topic+mdrical'></span>

<h3>Description</h3>

<p>Estimates MDRI (point estimate and confidence interval) using binomial
regression and a maximum likelihood approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdrical(data = NULL, subid_var = NULL, time_var = NULL,
  functional_forms = c("cloglog_linear", "logit_cubic"),
  recency_cutoff_time = 730.5, inclusion_time_threshold = 800,
  recency_rule = "binary_data", recency_vars = NULL,
  recency_params = NULL, n_bootstraps = 10000, alpha = 0.05,
  plot = TRUE, parallel = ifelse(n_bootstraps == 0, FALSE, TRUE),
  cores = parallel::detectCores(), output_bs_parms = FALSE,
  debug = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdrical_+3A_data">data</code></td>
<td>
<p>A data frame containing variables for subject identifier,
time (since detectable infection), and variables with biomarker readings or
recency status (to be specified in recency_vars)</p>
</td></tr>
<tr><td><code id="mdrical_+3A_subid_var">subid_var</code></td>
<td>
<p>The variable in the dataframe identifying subjects</p>
</td></tr>
<tr><td><code id="mdrical_+3A_time_var">time_var</code></td>
<td>
<p>The variable in the dataframe indicating time between
'time zero' (usually detectable infection) and biomarker measurement</p>
</td></tr>
<tr><td><code id="mdrical_+3A_functional_forms">functional_forms</code></td>
<td>
<p>Select functional form/link function combinations
for fitting probability of testing recent as a function of time to data using
binomial regression
(see Details). Default=all supported functional forms.</p>
</td></tr>
<tr><td><code id="mdrical_+3A_recency_cutoff_time">recency_cutoff_time</code></td>
<td>
<p>Recency time cut-off ('Big T'). Default = 730.5.</p>
</td></tr>
<tr><td><code id="mdrical_+3A_inclusion_time_threshold">inclusion_time_threshold</code></td>
<td>
<p>Data points beyond this time are excluded
from the calculation (in same unit as recency_cutoff_time, default = 800).</p>
</td></tr>
<tr><td><code id="mdrical_+3A_recency_rule">recency_rule</code></td>
<td>
<p>Specified rule for defining recent/non-recent outcomes
from biomarker data (see Details)</p>
</td></tr>
<tr><td><code id="mdrical_+3A_recency_vars">recency_vars</code></td>
<td>
<p>Variables to be used in determining recency outcomes</p>
</td></tr>
<tr><td><code id="mdrical_+3A_recency_params">recency_params</code></td>
<td>
<p>Vector of numeric parameters (e.g. thresholds) for
determining recency according to the relevant rule</p>
</td></tr>
<tr><td><code id="mdrical_+3A_n_bootstraps">n_bootstraps</code></td>
<td>
<p>Number of subject-level bootstrap resampling operations
for estimating confidence intervals, default = 10000.</p>
</td></tr>
<tr><td><code id="mdrical_+3A_alpha">alpha</code></td>
<td>
<p>Confidence level, default=0.05.</p>
</td></tr>
<tr><td><code id="mdrical_+3A_plot">plot</code></td>
<td>
<p>Specifies whether a plot of the probability of testing recent
over time should be produced</p>
</td></tr>
<tr><td><code id="mdrical_+3A_parallel">parallel</code></td>
<td>
<p>Set to TRUE in order to perform bootstrapping in parallel on
a multicore or multiprocessor system.</p>
</td></tr>
<tr><td><code id="mdrical_+3A_cores">cores</code></td>
<td>
<p>Set number of cores for parallel processing when parallel=TRUE.
This defaults to four.</p>
</td></tr>
<tr><td><code id="mdrical_+3A_output_bs_parms">output_bs_parms</code></td>
<td>
<p>Return a matrix of the fitting parameters for each
bootstrap iteration.</p>
</td></tr>
<tr><td><code id="mdrical_+3A_debug">debug</code></td>
<td>
<p>Enable debugging mode (browser)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The package contains long form documentation in the form of
vignettes that cover the use of the main fucntions. Use
browseVignettes(package=&quot;inctools&quot;) to access them.
</p>
<p>Expected data frame format: Before calling the function, please import your dataset into R environment.
</p>
<p>time_var: Time since infection; Note: this package does not assume any specific time unit. It is important to specify the
recency time cut-off 'T' and the time-based data exclusion rule (inclusion_time_threshold) in the same unit as the input times.
The estimated MDRI will be in this unit.
</p>
<p>Method: This function fits a function for probability of testing recent as a function of time to the supplied data using
binomial regression. This requires binary outcomes (recent/non-recent) coded as 1 for recent and 0 for non-recent test
resutls. Either a recency status variable must be specified, or a recency rule for determinging recency
status from a biomarker or set of biomarkers must be specified. Currently only independent biomarker
thresholds are supported (i.e. all biomarker criteria must be met in order for a specimen to be classified as recent).
</p>
<p>Functional forms currently supported for the binomial regression fitting procedure:
cloglog_linear, logit_cubic
</p>
<p>To be implemented in the near future: logit_spline
</p>
<p>logit_cubic: Fits a binomial regression to probability of testing recent with a logit link on a polynomial in t of the
third degree, where t is time since (detectable) infection.
</p>
<p>cloglog_linear: Fits a binomial regression to probability of testing recent with a log log link on log(t), where t is
time since (detectable) infection.
</p>
<p>recency_rule: binary_data - supply a binary variable with 1=recent and 0=non-recent in recency_vars.
</p>
<p>recency_rule:independent_thresholds: supply one threshold variable per biomarker in recency_vars and the relevant
thresholds, as well as whether a value below or above each threshold indicates recency in recency_params.
</p>
<p>recency_params expects a list of pairs of thresholds and thresholdtypes, with zero indicating a reading below the threshold
implies recency and 1 that a reading above the threshold implies recency. (Note: two values, a threshold and a
thresholdtype per variable must be specified in recency_params. For example, if you specify recency_vars =
c('ODn','ViralLoad') you may specify recency_params = c(1.5,0,500,1), meaning that an ODn reading below 1.5 AND a
viral load reasing above 500 indicates a recent result. Objects with missing values in its biomarker readings will be
excluded from caculation.
</p>


<h3>Value</h3>

<p>MDRI Dataframe containing MDRI point estimates, CI lower and upper
bounds and standard deviation of point estimates produced during
bootstrapping.
One row per functional form.
</p>
<p>Plots A plot of Probability of testing recent over time for each
functional form.
</p>
<p>Models The fitted GLM models for each functional form.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mdrical(data=excalibdata,
        subid_var = "SubjectID",
        time_var = "DaysSinceEDDI",
        recency_cutoff_time = 730.5,
        inclusion_time_threshold = 800,
        functional_forms = c("cloglog_linear"),
        recency_rule = "binary_data",
        recency_vars = "Recent",
        n_bootstraps = 10,
        parallel = FALSE,
        alpha = 0.05,
        plot = TRUE)
</code></pre>

<hr>
<h2 id='prevcounts'>Prevalence and Relative Standard Errors by Counts</h2><span id='topic+prevcounts'></span>

<h3>Description</h3>

<p>Prevalence and Relative Standard Errors by Counts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prevcounts(N, N_H, N_testR, N_R, DE_H = 1, DE_R = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prevcounts_+3A_n">N</code></td>
<td>
<p>Counts of total survey sample size(s) (vector/integer).</p>
</td></tr>
<tr><td><code id="prevcounts_+3A_n_h">N_H</code></td>
<td>
<p>Number of HIV positive found in survey(s) (vector/integer).</p>
</td></tr>
<tr><td><code id="prevcounts_+3A_n_testr">N_testR</code></td>
<td>
<p>Number tested for recency in survey(s) (vector/integer).</p>
</td></tr>
<tr><td><code id="prevcounts_+3A_n_r">N_R</code></td>
<td>
<p>Number of recent cases in survey(s) (vector/integer).</p>
</td></tr>
<tr><td><code id="prevcounts_+3A_de_h">DE_H</code></td>
<td>
<p>Design effect of HIV prevalence test (vector/numeric), greater than or equal to 1. If multiple surveys are entered but only one design effect is specified, function assumes entered design effect is identical for both surveys.</p>
</td></tr>
<tr><td><code id="prevcounts_+3A_de_r">DE_R</code></td>
<td>
<p>Design effect of recency test (vector/numeric), greater than or equal to 1. If multiple surveys are entered but only one design effect is specified, function assumes entered design effect is identical for both surveys.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The package contains long form documentation in the form of vignettes that cover the use of the main fucntions. Use browseVignettes(package=&quot;inctools&quot;) to access them.
</p>


<h3>Value</h3>

<p>Prevalences and relative standard errors. Design effects are assumed negligible unless user specifies otherwise.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prevcounts(N = 5000, N_H = 1000, N_testR = 1000, N_R = 70, DE_R = 1.1)

prevcounts (N = c(5000,5000), N_H = c(1000,1000), N_testR = c(1000,1000),
N_R = c(100,70), DE_H = c(1,1.1), DE_R = c(1,1.1))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
