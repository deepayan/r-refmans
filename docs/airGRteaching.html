<!DOCTYPE html><html><head><title>Help for package airGRteaching</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {airGRteaching}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#airGRteaching'><p>Teaching Hydrological Modelling with the GR Rainfall-Runoff Models ('Shiny' Interface Included)</p></a></li>
<li><a href='#as.data.frame'><p>Function to coerce the outputs of PrepGR, CalGR and SimGR to a data.frame</p></a></li>
<li><a href='#CalGR'><p>Calibration algorithm that optimises the error criterion selected as objective function</p></a></li>
<li><a href='#dyplot'><p>Interactive plots for time series of PrepGR, CalGR and SimGR objects</p></a></li>
<li><a href='#GetModelConfig'>
<p>Get model configuration</p></a></li>
<li><a href='#plot'><p>Static plots for time series of PrepGR, CalGR and SimGR objects</p></a></li>
<li><a href='#PrepGR'><p>Creation of the inputs required to run the CalGR and SimGR functions</p></a></li>
<li><a href='#ShinyGR'><p>Interactive Web application to run manually the GR2M, GR4J, GR5 and GR6J hydrological models with or without CemaNeige</p></a></li>
<li><a href='#SimGR'><p>Running one of the GR hydrological models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Teaching Hydrological Modelling with the GR Rainfall-Runoff
Models ('Shiny' Interface Included)</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-07-11</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0), airGR (&ge; 1.6.9.27)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dygraphs (&ge; 1.1.1.6), markdown, plotrix, shiny (&ge; 1.1.0),
shinyjs (&ge; 1.0), xts, graphics, grDevices, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>airGRdatasets, knitr, rmarkdown, testthat, tibble,
htmlwidgets (&ge; 1.5.3)</td>
</tr>
<tr>
<td>Description:</td>
<td>Add-on package to the 'airGR' package that simplifies its use and is aimed at being used for teaching hydrology. The package provides 1) three functions that allow to complete very simply a hydrological modelling exercise 2) plotting functions to help students to explore observed data and to interpret the results of calibration and simulation of the GR ('Génie rural') models 3) a 'Shiny' graphical interface that allows for displaying the impact of model parameters on hydrographs and models internal variables.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://hydrogr.github.io/airGRteaching/">https://hydrogr.github.io/airGRteaching/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://gitlab.irstea.fr/HYCAR-Hydro/airgrteaching/-/issues">https://gitlab.irstea.fr/HYCAR-Hydro/airgrteaching/-/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-11 14:31:24 UTC; odelaigue</td>
</tr>
<tr>
<td>Author:</td>
<td>Olivier Delaigue <a href="https://orcid.org/0000-0002-7668-8468"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Laurent Coron <a href="https://orcid.org/0000-0002-1503-6204"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Pierre Brigode <a href="https://orcid.org/0000-0001-8257-0741"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Guillaume Thirel <a href="https://orcid.org/0000-0002-1444-1830"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Olivier Delaigue &lt;airGR@inrae.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-12 22:50:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='airGRteaching'>Teaching Hydrological Modelling with the GR Rainfall-Runoff Models ('Shiny' Interface Included)</h2><span id='topic+airGRteaching'></span><span id='topic+airGRteaching-package'></span>

<h3>Description</h3>

<p>airGRteaching is an add-on package to the airGR package that simplifies its use and is teaching oriented.
It allows to use with very low programming skills several lumped rainfall-runoff models (GR4H, GR5H, GR4J, GR5J, GR6J, GR2M and GR1A) and a snow melt and accumulation model (CemaNeige). This package also provides graphical devices to help students to explore data and modelling results.
<br />
</p>
<p>The airGRteaching package has been designed to fulfil a major requirement: facilitating the use of the airGR functionalities by students. The names of the functions and their arguments were chosen to this end.
</p>
<p>The package is mostly based on three families of functions:
</p>

<ul>
<li><p> the functions that allow to complete very simply a hydrological modelling exercise;
</p>
</li>
<li><p> plotting functions to help students to explore observed data and to interpret the results of calibration and simulation of the GR models;
</p>
</li>
<li><p> a function which runs a 'Shiny' graphical user interface that allows for displaying in real-time the impacts of model parameters on hydrographs.
</p>
</li></ul>

<p>This package brings into R the hydrological modelling tools developed at INRAE-Antony (<a href="https://webgr.inrae.fr/en/home/">Catchment Hydrology research group</a> of the HYCAR Research Unit, France).
<br /><br />
</p>
<p># &mdash; Modelling Functions
</p>
<p>Three functions allow to complete very simply a hydrological modelling exercise:
</p>

<ul>
<li><p> preparation of data: <code><a href="#topic+PrepGR">PrepGR</a>()</code>;
</p>
</li>
<li><p> calibration of the models: <code><a href="#topic+CalGR">CalGR</a>()</code>;
</p>
</li>
<li><p> simulation with the models: <code><a href="#topic+SimGR">SimGR</a>()</code>.
</p>
</li></ul>

<p># &mdash; Plotting Functions
</p>
<p>airGRteaching provides two types of plotting functions that allow to produce static (<code>plot</code>()) or dynamic (<code><a href="#topic+dyplot">dyplot</a>()</code>) graphics (incl. mouse events and interactive graphics).
The devices allow to explore observed data and to interpret the results of calibration and simulation of the GR models.
<br />
</p>
<p># &mdash; Graphical user interface
</p>
<p>The package also provides the <code><a href="#topic+ShinyGR">ShinyGR</a>()</code> function, which allows to launch a Shiny interface. Thus it is possible to perform:
</p>

<ul>
<li><p> interactive flow simulations with parameters modifications;
</p>
</li>
<li><p> automatic calibration;
</p>
</li>
<li><p> display of internal variables evolution;
</p>
</li>
<li><p> time period selection.
</p>
</li></ul>

<p>A demonstrator of the graphical interface is available for free online on the <a href="https://sunshine.inrae.fr/">Sunshine</a> platform.
<br />
</p>
<p># &mdash; Models
</p>
<p>The six hydrological models and the snow melt and accumulation model already available in airGR are accessible from airGRteaching. <br />
These models can be called within airGRteaching using the following model names (*: available in the Shiny interface):
</p>

<ul>
<li> <p><code>GR4H</code>: four-parameter hourly lumped hydrological model (Mathevet, 2005)
</p>
</li>
<li> <p><code>GR5H</code>: five-parameter hourly lumped hydrological model (Ficchi, 2017; Ficchi <em>et al.</em>, 2019)
</p>
</li>
<li> <p><code>GR4J</code>*: four-parameter daily lumped hydrological model (Perrin et al., 2003)
</p>
</li>
<li> <p><code>GR5J</code>*: five-parameter daily lumped hydrological model (Le Moine, 2008)
</p>
</li>
<li> <p><code>GR6J</code>*: six-parameter daily lumped hydrological model (Pushpalatha et al., 2011)
</p>
</li>
<li> <p><code>GR2M</code>*: two-parameter monthly lumped hydrological model (Mouelhi, 2003; Mouelhi et al., 2006a)
</p>
</li>
<li> <p><code>GR1A</code>: one-parameter annual lumped hydrological model (Mouelhi, 2003; Mouelhi et al., 2006b)
</p>
</li>
<li> <p><code>CemaNeige</code>: two-parameter degree-day snow melt and accumulation daily model (combined with GR4H, GR5H, GR4J, GR5J or GR6J) (Valéry et al., 2014)
</p>
</li></ul>

<p>For more information and to get started with the package, you can refer to the vignette (<code>vignette("get_started", package = "airGRteaching")</code>) and go on the <a href="https://hydrogr.github.io/airGRteaching/">airGRteaching website</a>.
<br />
</p>
<p># &mdash; References
</p>

<ul>
<li><p> Coron, L., G. Thirel, O. Delaigue, C. Perrin and V. Andréassian (2017). The Suite of Lumped GR Hydrological Models in an R Package. Environmental Modelling and Software, 94, 166–171, <a href="https://doi.org/10.1016/j.envsoft.2017.05.002">doi:10.1016/j.envsoft.2017.05.002</a>.
</p>
</li>
<li><p> Ficchi, A. (2017). An adaptive hydrological model for multiple time-steps: Diagnostics and improvements based on fluxes consistency. PhD thesis, Irstea (Antony), GRNE (Paris), France.
</p>
</li>
<li><p> Ficchi, A., C. Perrin and V. Andréassian (2019). Hydrological modelling at multiple sub-daily time steps: model improvement via flux-matching. Journal of Hydrology, 575, 1308-1327, <a href="https://doi.org/10.1016/j.jhydrol.2019.05.084">doi:10.1016/j.jhydrol.2019.05.084</a>.
</p>
</li>
<li><p> Le Moine, N. (2008). Le bassin versant de surface vu par le souterrain : une voie d'amélioration des performances et du réalisme des modèles pluie-débit ?, PhD thesis (in French), UPMC - Cemagref Antony, Paris, France, 324 pp.
</p>
</li>
<li><p> Mathevet, T. (2005). Quels modèles pluie-débit globaux pour le pas de temps horaire ? Développement empirique et comparaison de modèles sur un large échantillon de bassins versants, PhD thesis (in French), ENGREF - Cemagref Antony, Paris, France, 463 pp.
</p>
</li>
<li><p> Mouelhi S. (2003). Vers une chaîne cohérente de modèles pluie-débit conceptuels globaux aux pas de temps pluriannuel, annuel, mensuel et journalier, PhD thesis (in French), ENGREF - Cemagref Antony, Paris, France, 323 pp.
</p>
</li>
<li><p> Mouelhi, S., C. Michel, C. Perrin and V. Andréassian (2006a). Stepwise development of a two-parameter monthly water balance model, Journal of Hydrology, 318(1-4), 200-214, <a href="https://doi.org/10.1016/j.jhydrol.2005.06.014">doi:10.1016/j.jhydrol.2005.06.014</a>.
</p>
</li>
<li><p> Mouelhi, S., C. Michel, C. Perrin. and V. Andreassian (2006b). Linking stream flow to rainfall at the annual time step: the Manabe bucket model revisited, Journal of Hydrology, 328, 283-296, <a href="https://doi.org/10.1016/j.jhydrol.2005.12.022">doi:10.1016/j.jhydrol.2005.12.022</a>.
</p>
</li>
<li><p> Perrin, C., C. Michel and V. Andréassian (2003). Improvement of a parsimonious model for streamflow simulation, Journal of Hydrology, 279(1-4), 275-289, <a href="https://doi.org/10.1016/S0022-1694%2803%2900225-7">doi:10.1016/S0022-1694(03)00225-7</a>.
</p>
</li>
<li><p> Pushpalatha, R., C. Perrin, N. Le Moine, T. Mathevet and V. Andréassian (2011). A downward structural sensitivity analysis of hydrological models to improve low-flow simulation, Journal of Hydrology, 411(1-2), 66-76, <a href="https://doi.org/10.1016/j.jhydrol.2011.09.034">doi:10.1016/j.jhydrol.2011.09.034</a>.
</p>
</li>
<li><p> Valéry, A., V. Andréassian and C. Perrin (2014). &quot;As simple as possible but not simpler&quot;: What is useful in a temperature-based snow-accounting routine? Part 2 - Sensitivity analysis of the Cemaneige snow accounting routine on 380 catchments, Journal of Hydrology, 517(0): 1176-1187, <a href="https://doi.org/10.1016/j.jhydrol.2014.04.058">doi:10.1016/j.jhydrol.2014.04.058</a>.
</p>
</li></ul>


<hr>
<h2 id='as.data.frame'>Function to coerce the outputs of PrepGR, CalGR and SimGR to a data.frame</h2><span id='topic+as.data.frame.PrepGR'></span><span id='topic+as.data.frame.CalGR'></span><span id='topic+as.data.frame.SimGR'></span><span id='topic+as.data.frame'></span>

<h3>Description</h3>

<p>Function to coerce the outputs of PrepGR, CalGR and SimGR to a data.frame</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PrepGR'
as.data.frame(x, row.names = NULL, ...)

## S3 method for class 'CalGR'
as.data.frame(x, row.names = NULL, ...)

## S3 method for class 'SimGR'
as.data.frame(x, row.names = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame_+3A_x">x</code></td>
<td>
<p>[<code><a href="#topic+PrepGR">PrepGR</a></code>], [<code><a href="#topic+CalGR">CalGR</a></code>] or [<code><a href="#topic+SimGR">SimGR</a></code>] objects</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_row.names">row.names</code></td>
<td>
<p><code>NULL</code> or a character vector giving the row names for the data.frame. Missing values are not allowed</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to or from methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>[data.frame] containing:
</p>
<table>
<tr><td><code>Dates</code></td>
<td>
<p>[POSIXct] vector of dates</p>
</td></tr>
<tr><td><code>PotEvap</code></td>
<td>
<p>[numeric] time series of potential evapotranspiration (catchment average) [mm/time step]</p>
</td></tr>
<tr><td><code>PrecipObs</code></td>
<td>
<p>[numeric] time series of total precipitation (catchment average) [mm/time step]</p>
</td></tr>
<tr><td><code>PrecipFracSolid_CemaNeige</code></td>
<td>
<p>[numeric] time series of solid precipitation fraction (layer average) [-],
must be defined if CemaNeige is used</p>
</td></tr>
<tr><td><code>TempMeanSim_CemaNeige</code></td>
<td>
<p>[numeric] time series of mean air temperature (layer average) [°C],
must be defined if CemaNeige is used</p>
</td></tr>
<tr><td><code>Qobs</code></td>
<td>
<p>[numeric] time series of observed flow (for the same time steps than simulated) [mm/time step]</p>
</td></tr>
<tr><td><code>Qsim</code></td>
<td>
<p>[numeric] time series of simulated flow (for the same time steps than simulated) [mm/time step] (only for objects of class <code><a href="#topic+CalGR">CalGR</a></code> or <code><a href="#topic+SimGR">SimGR</a></code>)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olivier Delaigue</p>


<h3>See Also</h3>

<p><code><a href="#topic+PrepGR">PrepGR</a></code>, <code><a href="#topic+CalGR">CalGR</a></code>, <code><a href="#topic+SimGR">SimGR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(airGRteaching)

## data.frame of observed data
data(L0123001, package = "airGR")
BasinObs2 &lt;- BasinObs[, c("DatesR", "P", "E", "Qmm", "T")]

## Preparation of observed data for modelling
PREP &lt;- PrepGR(ObsDF = BasinObs2, HydroModel = "GR4J", CemaNeige = FALSE)
head(as.data.frame(PREP))

## Calibration step
CAL &lt;- CalGR(PrepGR = PREP, CalCrit = "KGE2",
             WupPer = NULL, CalPer = c("1990-01-01", "1991-12-31"))
head(as.data.frame(CAL))

## Simulation step using the result of the automatic calibration method to set the model parameters
SIM &lt;- SimGR(PrepGR = PREP, CalGR = CAL, EffCrit = "KGE2",
             WupPer = NULL, SimPer = c("1992-01-01", "1992-12-31"))
head(as.data.frame(SIM))
</code></pre>

<hr>
<h2 id='CalGR'>Calibration algorithm that optimises the error criterion selected as objective function</h2><span id='topic+CalGR'></span>

<h3>Description</h3>

<p>Calibration algorithm that optimises the error criterion selected as objective function using the INRAE-HYCAR procedure described by C. Michel</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalGR(PrepGR, CalCrit = c("NSE", "KGE", "KGE2", "RMSE"),
      WupPer = NULL, CalPer,
      transfo = c("", "sqrt", "log", "inv", "sort"), verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalGR_+3A_prepgr">PrepGR</code></td>
<td>
<p>[object of class <code>PrepGR</code>] see <code><a href="#topic+PrepGR">PrepGR</a></code> for details</p>
</td></tr>
<tr><td><code id="CalGR_+3A_calcrit">CalCrit</code></td>
<td>
<p>[character] name of the objective function (must be one of <code>"NSE"</code>, <code>"KGE"</code>, <code>"KGE2"</code> or <code>"RMSE"</code>)</p>
</td></tr>
<tr><td><code id="CalGR_+3A_wupper">WupPer</code></td>
<td>
<p>(optional) [character] vector of 2 values to define the beginning and end of the warm-up period [<code>"YYYY-mm-dd"</code> or <code>"YYYY-mm-dd HH:MM:SS"</code>]; [0L] to disable the warm-up period. See details</p>
</td></tr>
<tr><td><code id="CalGR_+3A_calper">CalPer</code></td>
<td>
<p>[character] vector of 2 values to define the beginning and end of the calibration period [<code>"YYYY-mm-dd"</code> or <code>"YYYY-mm-dd HH:MM:SS"</code>]</p>
</td></tr>
<tr><td><code id="CalGR_+3A_transfo">transfo</code></td>
<td>
<p>(optional) [character] name of the transformation transformation applied to discharge for calculating the objective function (must be one of <code>""</code>, <code>"sqrt"</code>, <code>"log"</code>, <code>"inv"</code> or <code>"sort"</code>)</p>
</td></tr>
<tr><td><code id="CalGR_+3A_verbose">verbose</code></td>
<td>
<p>(optional) [boolean] logical value indicating if the function is run in verbose mode or not</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>WupPer = NULL</code> indicates that, if available, a period of one year immediately present before the CalPer period is used. <code>WupPer = 0L</code> allows to disable the warm up of the model.
</p>


<h3>Value</h3>

<p>[list] object of class <code>CalGR</code> containing:
</p>
<table>
<tr><td><code>OptionsCalib</code></td>
<td>
<p>[list] object of class <code>RunOptions</code> (see: <code><a href="airGR.html#topic+CreateRunOptions">CreateRunOptions</a></code>)</p>
</td></tr>
<tr><td><code>Qobs</code></td>
<td>
<p>[numeric]  series of observed discharges [mm/time step]</p>
</td></tr>
<tr><td><code>OutputsCalib</code></td>
<td>
<p>[list] object of class <code>OutputsCalib</code> (see: <code><a href="airGR.html#topic+Calibration">Calibration</a></code>)</p>
</td></tr>
<tr><td><code>OutputsModel</code></td>
<td>
<p>[list] object of class <code>OutputsModel</code> (see: <code><a href="airGR.html#topic+RunModel">RunModel</a></code>)</p>
</td></tr>
<tr><td><code>TypeModel</code></td>
<td>
<p>[character] name of the function of the hydrological model used</p>
</td></tr>
<tr><td><code>CalCrit</code></td>
<td>
<p>[character] name of the function that computes the error criterion during the calibration step</p>
</td></tr>
<tr><td><code>PeriodModel</code></td>
<td>
<p>[list] <code>$WarmUp</code>: vector of 2 <code>POSIXct</code> values defining the beginning and end of the warm-up period, <code>$Run</code>: vector of 2 <code>POSIXct</code> values defining the beginning and end of the calibration period</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olivier Delaigue, Guillaume Thirel</p>


<h3>See Also</h3>

<p>airGRteaching
<code><a href="#topic+plot">plot</a></code> and  <code><a href="#topic+dyplot">dyplot</a></code>
functions to display static and dynamic plots
<br /><br />
airGR
<code><a href="airGR.html#topic+CreateRunOptions">CreateRunOptions</a></code>, <code><a href="airGR.html#topic+CreateInputsCrit">CreateInputsCrit</a></code>, <code><a href="airGR.html#topic+CreateCalibOptions">CreateCalibOptions</a></code>, <code><a href="airGR.html#topic+ErrorCrit_RMSE">ErrorCrit_RMSE</a></code>, <code><a href="airGR.html#topic+ErrorCrit_NSE">ErrorCrit_NSE</a></code>, <code><a href="airGR.html#topic+ErrorCrit_KGE">ErrorCrit_KGE</a></code>, <code><a href="airGR.html#topic+ErrorCrit_KGE2">ErrorCrit_KGE2</a></code>, <code><a href="airGR.html#topic+Calibration_Michel">Calibration_Michel</a></code>
functions
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(airGRteaching)

## data.frame of observed data
data(L0123001, package = "airGR")
BasinObs2 &lt;- BasinObs[, c("DatesR", "P", "E", "Qmm", "T")]

## Preparation of observed data for modelling
PREP &lt;- PrepGR(ObsDF = BasinObs2, HydroModel = "GR4J", CemaNeige = TRUE)

## Calibration step
CAL &lt;- CalGR(PrepGR = PREP, CalCrit = "KGE2",
             WupPer = NULL, CalPer = c("1990-01-01", "1993-12-31"))


## Structure of CalGR object
str(CAL)

## Parameter and criterion evolution during
## the steepest descent step of the calibration algorithm
plot(CAL, which = "iter")

## Plot diagnostics
plot(CAL)

## Static plot of observed and simulated time series
plot(CAL, which = "ts")
plot(CAL, which = c("Precip", "Flows"))

## Dynamic plot of observed and simulated time series
dyplot(CAL)
</code></pre>

<hr>
<h2 id='dyplot'>Interactive plots for time series of PrepGR, CalGR and SimGR objects</h2><span id='topic+dyplot'></span><span id='topic+dyplot.PrepGR'></span><span id='topic+dyplot.CalGR'></span><span id='topic+dyplot.SimGR'></span>

<h3>Description</h3>

<p>Interactive plots for time series of <em>PrepGR</em>, <em>CalGR</em> and <em>SimGR</em> objects.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PrepGR'
dyplot(x, Qsup = NULL, Qsup.name = "Qsup",
       col.Precip = c("royalblue", "lightblue"),
       col.Q = c("black", "orangered", "grey"), col.na = "lightgrey",
       ylab = NULL, main = NULL,
       plot.na = TRUE, RangeSelector = TRUE, Roller = FALSE,
       LegendShow = c("follow", "auto", "always", "onmouseover", "never"), ...)

## S3 method for class 'CalGR'
dyplot(x, Qsup = NULL, Qsup.name = "Qsup",
       col.Precip = c("royalblue", "lightblue"),
       col.Q = c("black", "orangered", "grey"), col.na = "lightgrey",
       ylab = NULL, main = NULL,
       plot.na = TRUE, RangeSelector = TRUE, Roller = FALSE,
       LegendShow = c("follow", "auto", "always", "onmouseover", "never"), ...)

## S3 method for class 'SimGR'
dyplot(x, Qsup = NULL, Qsup.name = "Qsup",
       col.Precip = c("royalblue", "lightblue"),
       col.Q = c("black", "orangered", "grey"), col.na = "lightgrey",
       ylab = NULL, main = NULL,
       plot.na = TRUE, RangeSelector = TRUE, Roller = FALSE,
       LegendShow = c("follow", "auto", "always", "onmouseover", "never"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dyplot_+3A_x">x</code></td>
<td>
<p>[<code><a href="#topic+PrepGR">PrepGR</a></code>], [<code><a href="#topic+CalGR">CalGR</a></code>] or [<code><a href="#topic+SimGR">SimGR</a></code>] objects</p>
</td></tr>
<tr><td><code id="dyplot_+3A_qsup">Qsup</code></td>
<td>
<p>(optional) [numeric] additional time series of flows (at the same time step than argument <code>x</code>) [mm/time step]</p>
</td></tr>
<tr><td><code id="dyplot_+3A_qsup.name">Qsup.name</code></td>
<td>
<p>(optional) [character] a label for the legend of Qsup</p>
</td></tr>
<tr><td><code id="dyplot_+3A_col.precip">col.Precip</code></td>
<td>
<p>(optional) [character] vector of 1 (total precip.) or 2 (liquid and solid precip. with CemaNeige) color codes or names for precipitation (these can be of the form <code>"#RRGGBB"</code> or <code>"rgb(255, 100, 200)"</code> or <code>"yellow"</code>), see <code><a href="graphics.html#topic+par">par</a></code> and <code><a href="grDevices.html#topic+rgb">rgb</a></code></p>
</td></tr>
<tr><td><code id="dyplot_+3A_col.q">col.Q</code></td>
<td>
<p>(optional) [character] vector of up to 3 color codes or names for observed (first value), simulated (second value, if provided) and additional (last value, if provided) flows, respectively (these can be of the form <code>"#RRGGBB"</code> or <code>"rgb(255, 100, 200)"</code> or <code>"yellow"</code>), see <code><a href="graphics.html#topic+par">par</a></code> and <code><a href="grDevices.html#topic+rgb">rgb</a></code></p>
</td></tr>
<tr><td><code id="dyplot_+3A_col.na">col.na</code></td>
<td>
<p>(optional) [character] color code or name for missing values(these can be of the form <code>"#RRGGBB"</code> or <code>"rgb(255, 100, 200)"</code> or <code>"yellow"</code>), see <code><a href="graphics.html#topic+par">par</a></code> and <code><a href="grDevices.html#topic+rgb">rgb</a></code></p>
</td></tr>
<tr><td><code id="dyplot_+3A_ylab">ylab</code></td>
<td>
<p>(optional) [character] a label for the y-axis (flow and precipitation)</p>
</td></tr>
<tr><td><code id="dyplot_+3A_main">main</code></td>
<td>
<p>(optional) [character] a main title for the plot</p>
</td></tr>
<tr><td><code id="dyplot_+3A_plot.na">plot.na</code></td>
<td>
<p>[boolean] indicating if the missing values are plotted on the x-axis</p>
</td></tr>
<tr><td><code id="dyplot_+3A_rangeselector">RangeSelector</code></td>
<td>
<p>(optional) [boolean] add a range selector to the bottom of the chart that allows users to pan and zoom to various date ranges (see <code><a href="dygraphs.html#topic+dyRangeSelector">dyRangeSelector</a></code>)</p>
</td></tr>
<tr><td><code id="dyplot_+3A_roller">Roller</code></td>
<td>
<p>(optional) [numeric] number of time scale units (e.g. days, months, years) to average values over (see <code><a href="dygraphs.html#topic+dyRoller">dyRoller</a></code>)</p>
</td></tr>
<tr><td><code id="dyplot_+3A_legendshow">LegendShow</code></td>
<td>
<p>(optional) [character] when to display the legend. Specify <code>"always"</code> to always show the legend. Specify <code>"onmouseover"</code> to only display it when a user mouses over the chart. Specify <code>"follow"</code> (default) to have the legend show as overlay to the chart which follows the mouse. See <code><a href="dygraphs.html#topic+dyLegend">dyLegend</a></code></p>
</td></tr>
<tr><td><code id="dyplot_+3A_...">...</code></td>
<td>
<p>other parameters to be passed through to plotting functions</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olivier Delaigue</p>


<h3>See Also</h3>

<p>airGRteaching static <code><a href="#topic+plot">plot</a></code> functions
<br /><br />
<code><a href="#topic+PrepGR">PrepGR</a></code>, <code><a href="#topic+CalGR">CalGR</a></code>, <code><a href="#topic+SimGR">SimGR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(airGRteaching)

## data.frame of observed data
data(L0123001, package = "airGR")
BasinObs2 &lt;- BasinObs[, c("DatesR", "P", "E", "Qmm", "T")]

## Preparation of observed data for modelling
PREP &lt;- PrepGR(ObsDF = BasinObs2, HydroModel = "GR4J", CemaNeige = FALSE)
dyplot(PREP, main = "Observation")

## Calibration step
CAL &lt;- CalGR(PrepGR = PREP, CalCrit = "KGE2",
             WupPer = NULL, CalPer = c("1990-01-01", "1993-12-31"))
dyplot(CAL, main = "Calibration")

## Simulation
SIM &lt;- SimGR(PrepGR = PREP, CalGR = CAL, EffCrit = "KGE2",
             WupPer = NULL, SimPer = c("1994-01-01", "1998-12-31"))
dyplot(SIM, main = "Simulation")
</code></pre>

<hr>
<h2 id='GetModelConfig'>
Get model configuration
</h2><span id='topic+GetModelConfig'></span><span id='topic+GetCrit'></span><span id='topic+GetCrit.CalGR'></span><span id='topic+GetCrit.SimGR'></span><span id='topic+GetParam'></span><span id='topic+GetParam.CalGR'></span><span id='topic+GetParam.SimGR'></span>

<h3>Description</h3>

<p>Get the error criterion value or the model parameter set from <em>CalGR</em> and <em>SimGR</em> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CalGR'
GetCrit(x, ...)

## S3 method for class 'SimGR'
GetCrit(x, ...)

## S3 method for class 'CalGR'
GetParam(x, ...)

## S3 method for class 'SimGR'
GetParam(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GetModelConfig_+3A_x">x</code></td>
<td>
<p>[<code><a href="#topic+CalGR">CalGR</a></code>] or [<code><a href="#topic+SimGR">SimGR</a></code>] objects</p>
</td></tr>
<tr><td><code id="GetModelConfig_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to or from methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olivier Delaigue
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CalGR">CalGR</a></code>, <code><a href="#topic+SimGR">SimGR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(airGRteaching)

## data.frame of observed data
data(L0123001, package = "airGR")
BasinObs2 &lt;- BasinObs[, c("DatesR", "P", "E", "Qmm", "T")]

## Preparation of observed data for modelling
PREP &lt;- PrepGR(ObsDF = BasinObs2, HydroModel = "GR4J", CemaNeige = TRUE)

## Calibration step
CAL &lt;- CalGR(PrepGR = PREP, CalCrit = "KGE2",
             WupPer = NULL, CalPer = c("1990-01-01", "1993-12-31"))

## Get the error criterion selected as objective function obtained at the end of the calibration
GetCrit(CAL)

## Get the parameter set obtained at the end of the calibration
GetParam(CAL)

## Simulation step using the result of the automatic calibration method to set the model parameters
SIM &lt;- SimGR(PrepGR = PREP, Param = CAL, EffCrit = "KGE2",
             WupPer = NULL, SimPer = c("1994-01-01", "1998-12-31"))

## Get the error criterion computed during the simulation step
GetCrit(SIM)

## Get the parameter set used during the simulation step
GetParam(SIM)
</code></pre>

<hr>
<h2 id='plot'>Static plots for time series of PrepGR, CalGR and SimGR objects</h2><span id='topic+plot'></span><span id='topic+plot.PrepGR'></span><span id='topic+plot.CalGR'></span><span id='topic+plot.SimGR'></span>

<h3>Description</h3>

<p>Static plots for time series of <em>PrepGR</em>, <em>CalGR</em> and <em>SimGR</em> objects.
Also plot of the evolution  of parameters and objective function during the calibration step for CalGR object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PrepGR'
plot(x, type = "l",
     col.Precip = "royalblue", col.Q = "black", col.na = "grey",
     xlab = NULL, ylab = NULL, main = NULL,
     plot.na = TRUE, ...)

## S3 method for class 'CalGR'
plot(x, xlab = NULL, ylab = NULL, main = NULL,
     which = "synth", log_scale = FALSE, ...)

## S3 method for class 'SimGR'
plot(x,
     which = "synth", log_scale = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>[PrepGR], [CalGR] or [SimGR] objects (see <code><a href="#topic+PrepGR">PrepGR</a></code>, <code><a href="#topic+CalGR">CalGR</a></code> and <code><a href="#topic+SimGR">SimGR</a></code>)</p>
</td></tr>
<tr><td><code id="plot_+3A_type">type</code></td>
<td>
<p>[character] the type of plot that should be drawn (see <code><a href="graphics.html#topic+plot">plot</a></code> for details)</p>
</td></tr>
<tr><td><code id="plot_+3A_col.precip">col.Precip</code></td>
<td>
<p>(optional) [character]color code or name for precipitation, see <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
<tr><td><code id="plot_+3A_col.q">col.Q</code></td>
<td>
<p>(optional) [character] color code or name for observed flow, see <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
<tr><td><code id="plot_+3A_col.na">col.na</code></td>
<td>
<p>(optional) [character] color code or name for missing values, see <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
<tr><td><code id="plot_+3A_xlab">xlab</code></td>
<td>
<p>(optional) [character] a label for the x-axis (see <code><a href="graphics.html#topic+title">title</a></code>)</p>
</td></tr>
<tr><td><code id="plot_+3A_ylab">ylab</code></td>
<td>
<p>(optional) [character] a label for the y-axis (vector of 1 or 2 values for rainfall and flow respectively; see <code><a href="graphics.html#topic+title">title</a></code>)</p>
</td></tr>
<tr><td><code id="plot_+3A_main">main</code></td>
<td>
<p>(optional) [character] a main title for the plot (see <code><a href="graphics.html#topic+title">title</a></code>)</p>
</td></tr>
<tr><td><code id="plot_+3A_plot.na">plot.na</code></td>
<td>
<p>[boolean] boolean indicating if the missing values are plotted on the x-axis</p>
</td></tr>
<tr><td><code id="plot_+3A_which">which</code></td>
<td>
<p>[character] choice of the plot type (<code>"synth"</code> (default): plot diagnostics; <code>"iter"</code>: parameter and calibration criterion values during the iterations of the steepest descent step of the airGR calibration algorithm; <code>"ts"</code>: time series of observed precipitation and observed and simulated flows; <code>"perf"</code>: error time series and other graphic to compare simulated to observed flows; for other graphical outputs, see <code><a href="airGR.html#topic+plot.OutputsModel">plot.OutputsModel</a></code>)</p>
</td></tr>
<tr><td><code id="plot_+3A_log_scale">log_scale</code></td>
<td>
<p>(optional) [boolean] indicating if the flow and the error time series axis and the flow error time series axis are to be logarithmic, default = <code>FALSE</code></p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>other parameters to be passed through to plotting functions</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olivier Delaigue</p>


<h3>See Also</h3>

<p>airGR
<code><a href="airGR.html#topic+plot.OutputsModel">plot.OutputsModel</a></code>
function
<br /><br />
airGRteaching
<code><a href="#topic+dyplot">dyplot</a></code>
function to display dynamic plots
<br /><br />
<code><a href="#topic+PrepGR">PrepGR</a></code>, <code><a href="#topic+CalGR">CalGR</a></code>, <code><a href="#topic+SimGR">SimGR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(airGRteaching)

## data.frame of observed data
data(L0123001, package = "airGR")
BasinObs2 &lt;- BasinObs[, c("DatesR", "P", "E", "Qmm", "T")]

## Preparation of observed data for modelling
PREP &lt;- PrepGR(ObsDF = BasinObs2, HydroModel = "GR4J", CemaNeige = FALSE)

## Observed data plotting
plot(PREP)
</code></pre>

<hr>
<h2 id='PrepGR'>Creation of the inputs required to run the CalGR and SimGR functions</h2><span id='topic+PrepGR'></span>

<h3>Description</h3>

<p>Creation of the inputs required to run the CalGR and SimGR functions</p>


<h3>Usage</h3>

<pre><code class='language-R'>PrepGR(ObsDF = NULL, DatesR = NULL, Precip = NULL, PotEvap = NULL,
       Qobs = NULL, TempMean = NULL,
       ZInputs = NULL, HypsoData = NULL, NLayers = 5,
       HydroModel, CemaNeige = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PrepGR_+3A_obsdf">ObsDF</code></td>
<td>
<p>(optional) [data.frame] data.frame of dates, total precipitation, potential evapotranspiration, observed discharges and mean air temperature (only if CemaNeige is used) (variables must be in this order; see below for the units)</p>
</td></tr>
<tr><td><code id="PrepGR_+3A_datesr">DatesR</code></td>
<td>
<p>(optional) [POSIXt] vector of dates required to create the GR and CemaNeige (if used) models inputs. Time zone must be defined as &quot;UTC&quot;</p>
</td></tr>
<tr><td><code id="PrepGR_+3A_precip">Precip</code></td>
<td>
<p>(optional) [numeric] time series of total precipitation (catchment average) [mm/time step], required to create the GR and CemaNeige (if used) models inputs</p>
</td></tr>
<tr><td><code id="PrepGR_+3A_potevap">PotEvap</code></td>
<td>
<p>(optional) [numeric] time series of potential evapotranspiration (catchment average) [mm/time step], required to create the GR model inputs</p>
</td></tr>
<tr><td><code id="PrepGR_+3A_qobs">Qobs</code></td>
<td>
<p>(optional) [numeric] time series of observed discharges [mm/time step]</p>
</td></tr>
<tr><td><code id="PrepGR_+3A_tempmean">TempMean</code></td>
<td>
<p>(optional) [numeric] time series of mean air temperature [°C], required to create the CemaNeige model inputs</p>
</td></tr>
<tr><td><code id="PrepGR_+3A_zinputs">ZInputs</code></td>
<td>
<p>(optional) [numeric] real giving the mean elevation of the Precip and TempMean series (before extrapolation) [m], possibly used to create the CemaNeige (if used) model inputs</p>
</td></tr>
<tr><td><code id="PrepGR_+3A_hypsodata">HypsoData</code></td>
<td>
<p>(optional) [numeric] vector of 101 reals: min, q01 to q99 and max of catchment elevation distribution [m]; if not defined a single elevation is used for CemaNeige (if used)</p>
</td></tr>
<tr><td><code id="PrepGR_+3A_nlayers">NLayers</code></td>
<td>
<p>(optional) [numeric] integer giving the number of elevation layers requested [-], required to create CemaNeige (if used) model inputs</p>
</td></tr>
<tr><td><code id="PrepGR_+3A_hydromodel">HydroModel</code></td>
<td>
<p>[character] name of the hydrological model (must be one of <code>"GR1A"</code>, <code>"GR2M"</code>, <code>"GR4J"</code>, <code>"GR5J"</code>, <code>"GR6J"</code>, <code>"GR4H"</code> or <code>"GR5H"</code>)</p>
</td></tr>
<tr><td><code id="PrepGR_+3A_cemaneige">CemaNeige</code></td>
<td>
<p>[boolean] option indicating whether CemaNeige should be activated (only available for hourly or daily models, when <code>HydroModel</code> is equal to any of <code>"GR4J"</code>, <code>"GR5J"</code>, <code>"GR6J"</code>, <code>"GR4H"</code> or <code>"GR5H"</code>). See details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the <code>ObsDF</code> argument is provided, <code>DatesR</code>, <code>Precip</code>, <code>PotEvap</code>, <code>Qobs</code> and <code>TempMean</code> are not necessary, and vice-versa. If one variable is provided in <code>ObsDF</code> and also separately, then only the data included in <code>ObsDF</code> are used.
<br /><br />
If <code>HydroModel = "GR5H"</code>, by default, this model is used without the interception store (i.e. without specifying <code>Imax</code>; see <code><a href="airGR.html#topic+RunModel_GR5H">RunModel_GR5H</a></code>).
<br /><br />
If the <code>CemaNeige</code> argument is set to <code>TRUE</code>, the default version of CemaNeige is used (i.e. without the Linear Hysteresis, see the details part in <code><a href="airGR.html#topic+CreateRunOptions">CreateRunOptions</a></code>).
<br /><br />
The <code>PrepGR</code> function can be used even if no observed discharges are available. In this case, it is necessary to provide observed discharges time series equal to NA: this means that either the <code>ObsDF</code> observed discharges column or the <code>Qobs</code> arguments, depending on the format of data you provide, must be provided and filled with NAs.
</p>


<h3>Value</h3>

<p>[list] object of class <code>PrepGR</code> containing the data required to evaluate the model outputs:
</p>
<table>
<tr><td><code>InputsModel</code></td>
<td>
<p>[list] object of class <em>InputsModel</em> containing the data required to evaluate the model outputs (see: <code><a href="airGR.html#topic+CreateInputsModel">CreateInputsModel</a></code> outputs)</p>
</td></tr>
<tr><td><code>Qobs</code></td>
<td>
<p>[numeric] time series of observed discharges [mm/time step]</p>
</td></tr>
<tr><td><code>HydroModel</code></td>
<td>
<p>[character] name of the function of the hydrological model used</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olivier Delaigue</p>


<h3>See Also</h3>

<p>airGRteaching
<code><a href="#topic+plot">plot</a></code> and  <code><a href="#topic+dyplot">dyplot</a></code>
functions to display static and dynamic plots
<br /><br />
airGR
<code><a href="airGR.html#topic+CreateInputsModel">CreateInputsModel</a></code>
function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(airGRteaching)

## data.frame of observed data
data(L0123001, package = "airGR")
BasinObs2 &lt;- BasinObs[, c("DatesR", "P", "E", "Qmm", "T")]

## Preparation of observed data for modelling when inputs set by using a data.frame
PREP &lt;- PrepGR(ObsDF = BasinObs2, HydroModel = "GR4J", CemaNeige = FALSE)


## Structure of PrepGR object
str(PREP)

## Static plot of observed time series
plot(PREP)

## Dynamic plot of observed time series
dyplot(PREP)


## Preparation of observed data for modelling when inputs set by using independant vectors
PREP &lt;- PrepGR(DatesR = BasinObs2$DatesR, Precip = BasinObs2$P,
               PotEvap = BasinObs2$E, Qobs = BasinObs2$Qmm,
               HydroModel = "GR4J", CemaNeige = FALSE)


## Preparation of observed data for an ungauged catchment (i.e. no observed discharge available)
## Observed discharge set to NA in the Qobs argument
##   or in the 4th column of the data.frame if the ObsDF argument is used
PREP &lt;- PrepGR(DatesR = BasinObs2$DatesR, Precip = BasinObs2$P,
               PotEvap = BasinObs2$E, Qobs = NA,
               HydroModel = "GR4J", CemaNeige = FALSE)
</code></pre>

<hr>
<h2 id='ShinyGR'>Interactive Web application to run manually the GR2M, GR4J, GR5 and GR6J hydrological models with or without CemaNeige</h2><span id='topic+ShinyGR'></span>

<h3>Description</h3>

<p>Shiny application to understand and to display in a interactive way the impact of each parameter of the GR models on the simulated flows</p>


<h3>Usage</h3>

<pre><code class='language-R'>ShinyGR(ObsDF = NULL,
        DatesR = NULL, Precip = NULL, PotEvap = NULL, Qobs = NULL, TempMean = NULL,
        ZInputs = NULL, HypsoData = NULL, NLayers = 5,
        SimPer, NamesObsBV = NULL, theme = "RStudio")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ShinyGR_+3A_obsdf">ObsDF</code></td>
<td>
<p>(optional) [data.frame or list of data.frame] <code>data.frame</code> of dates, total precipitation, potential evapotranspiration, observed discharge and mean air temperature (only if CemaNeige is used) (variables must be in this order; see below for the units)</p>
</td></tr>
<tr><td><code id="ShinyGR_+3A_datesr">DatesR</code></td>
<td>
<p>(optional) [POSIXt] vector of daily or monthly dates required to create the GR and CemaNeige models inputs. Time zone must be defined as &quot;UTC&quot;</p>
</td></tr>
<tr><td><code id="ShinyGR_+3A_precip">Precip</code></td>
<td>
<p>(optional) [numeric] time series of total precipitation (catchment average) [mm/time step], required to create the GR and CemaNeige models inputs</p>
</td></tr>
<tr><td><code id="ShinyGR_+3A_potevap">PotEvap</code></td>
<td>
<p>(optional) [numeric] time series of potential evapotranspiration (catchment average) [mm/time step], required to create the GR model inputs</p>
</td></tr>
<tr><td><code id="ShinyGR_+3A_qobs">Qobs</code></td>
<td>
<p>(optional) [numeric] time series of observed discharge [mm/time step]</p>
</td></tr>
<tr><td><code id="ShinyGR_+3A_tempmean">TempMean</code></td>
<td>
<p>(optional) [numeric] time series of mean air temperature [°C], required to create the CemaNeige model inputs (if used)</p>
</td></tr>
<tr><td><code id="ShinyGR_+3A_zinputs">ZInputs</code></td>
<td>
<p>(optional) [numeric or list of numerics] real giving the mean elevation of the Precip and TempMean series (before extrapolation) [m], used to create the CemaNeige model inputs (if used)</p>
</td></tr>
<tr><td><code id="ShinyGR_+3A_hypsodata">HypsoData</code></td>
<td>
<p>(optional) [numeric or list of numerics] vector of 101 reals: min, q01 to q99 and max of catchment elevation distribution [m]; if not defined a single elevation is used for CemaNeige (if used)</p>
</td></tr>
<tr><td><code id="ShinyGR_+3A_nlayers">NLayers</code></td>
<td>
<p>(optional) [numeric or list of numerics] integer giving the number of elevation layers requested [-], required to create CemaNeige model inputs (if used)</p>
</td></tr>
<tr><td><code id="ShinyGR_+3A_simper">SimPer</code></td>
<td>
<p>[character or list of characters] vector of 2 values to define the beginning and the end of the simulation period [<code>"YYYY-mm-dd"</code> or <code>"YYYY-mm-dd HH:MM:SS"</code>], see below for details</p>
</td></tr>
<tr><td><code id="ShinyGR_+3A_namesobsbv">NamesObsBV</code></td>
<td>
<p>(optional) [character] vector of values to define the data inputs name(s) (if the ObsDF list is not already named)</p>
</td></tr>
<tr><td><code id="ShinyGR_+3A_theme">theme</code></td>
<td>
<p>(optional) [character] alternative stylesheet [<code>"RStudio"</code> (default), <code>"Cerulean"</code>, <code>"Cyborg"</code>, <code>"Flatly"</code>, <code>"Inrae"</code>, <code>"Saclay"</code>, <code>"United"</code> or <code>"Yeti"</code>]</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The warm-up period always starts from the first date of the dataset to the time step just before the beginning of the simulation period (<code>SimPer</code>). <br />
The <code>ShinyGR</code> function can be used even if no observed discharges are available. In this case, it is necessary to provide observed discharges time series equal to NA: this means that either the <code>ObsDF</code> observed discharges column or the <code>Qobs</code> arguments, depending on the format of data you provide, must be provided and filled with NAs. <br />
Several datasets can be proposed at the same time in the interface (see the code example below). A dataset with a daily time step can be proposed at the same time as a dataset at the monthly time step. <br />
CemaNeige can only be used with the daily models at the moment.
</p>


<h3>Note</h3>

<p>A demo version of the GUI is available on the <a href="https://sunshine.inrae.fr/">Sunshine</a> platform.
</p>


<h3>Author(s)</h3>

<p>Olivier Delaigue,
Laurent Coron,
Pierre Brigode</p>


<h3>See Also</h3>

<p><code><a href="#topic+CalGR">CalGR</a>, <a href="#topic+SimGR">SimGR</a>, <a href="#topic+plot">plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(airGRteaching)

## data.frame of daily observed data of a low-land basin
data(L0123001, package = "airGR")
BV_L0123001 &lt;- BasinObs[0001:6000, c("DatesR", "P", "E", "Qmm", "T")]
BI_L0123001 &lt;- BasinInfo

## data.frame of daily observed data of a mountainous basin
data(L0123002, package = "airGR")
BV_L0123002 &lt;- BasinObs[5000:9999, c("DatesR", "P", "E", "Qmm", "T")]
BI_L0123002 &lt;- BasinInfo

## data.frame of monthly aggregated time series from daily observed data of a low-land basin
BV_L0123001m &lt;- SeriesAggreg(BV_L0123001[BV_L0123001$DatesR &lt; "2000-06-01", ],
                             Format = "%Y%m", ConvertFun = c("sum", "sum", "sum", "mean"))


## Interactive simulation when inputs set by using a data.frame
if (interactive()) {
  ShinyGR(ObsDF = list("Low-land basin" = BV_L0123001, "Mountainous basin" = BV_L0123002),
          ZInputs = list(NULL, median(BI_L0123002$HypsoData)),
          HypsoData = list(NULL, BI_L0123002$HypsoData),
          NLayers = list(5, 5),
          SimPer = list(c("1994-01-01", "1998-12-31"), c("2004-01-01", "2006-12-31")),
          theme = "United")
}

## Interactive simulation using when inputs set by using independant vectors
if (interactive()) {
  ShinyGR(DatesR = BV_L0123002$DatesR,
          Precip = BV_L0123002$P,
          PotEvap = BV_L0123002$E,
          Qobs = BV_L0123002$Qmm,
          Temp = BV_L0123002$T,
          ZInputs = median(BI_L0123002$HypsoData),
          HypsoData = BI_L0123002$HypsoData,
          NLayers = 5,
          SimPer = c("2004-01-01", "2006-12-31"),
          NamesObsBV = "Mountainous basin",
          theme = "Saclay")
}

## Interactive simulation for an ungauged catchment (i.e. no observed discharge available)
## Observed discharge set to NA in the Qobs argument
##   or in the 4th column of the data.frame if the ObsDF argument is used
if (interactive()) {
  ShinyGR(DatesR = BV_L0123001$DatesR,
          Precip = BV_L0123001$P,
          PotEvap = BV_L0123001$E,
          Qobs = NA,
          SimPer = c("1994-01-01", "1998-12-31"),
          NamesObsBV = "Low-land basin",
          theme = "Cyborg")
}

## Interactive simulation when inputs are at different time steps
if (interactive()) {
  ShinyGR(ObsDF = list("Low-land basin [daily]" = BV_L0123001,
                       "Low-land basin [monthly]" = BV_L0123001m),
        SimPer = list(c("1994-01-01", "1998-12-01"),
                      c("1994-01-01", "1998-12-01")),
        theme = "Flatly")
}
</code></pre>

<hr>
<h2 id='SimGR'>Running one of the GR hydrological models</h2><span id='topic+SimGR'></span>

<h3>Description</h3>

<p>Function for running the GR hydrological models</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimGR(PrepGR, CalGR = NULL, Param, EffCrit = c("NSE", "KGE", "KGE2", "RMSE"),
  WupPer = NULL, SimPer,
  transfo = c("", "sqrt", "log", "inv", "sort"), verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimGR_+3A_prepgr">PrepGR</code></td>
<td>
<p>[object of class <em>PrepGR</em>] see <code><a href="#topic+PrepGR">PrepGR</a></code> for details</p>
</td></tr>
<tr><td><code id="SimGR_+3A_calgr">CalGR</code></td>
<td>
<p>(deprecated) use the <code>Param</code> argument instead</p>
</td></tr>
<tr><td><code id="SimGR_+3A_param">Param</code></td>
<td>
<p>[object of class <em>CalGR</em> or numeric] see <code><a href="#topic+CalGR">CalGR</a></code>. The length of the vector of parameters depends on the model used, see below for details</p>
</td></tr>
<tr><td><code id="SimGR_+3A_effcrit">EffCrit</code></td>
<td>
<p>[character] name of the efficiency criterion (must be one of <code>"NSE"</code>, <code>"KGE"</code>, <code>"KGE2"</code> or <code>"RMSE"</code>)</p>
</td></tr>
<tr><td><code id="SimGR_+3A_wupper">WupPer</code></td>
<td>
<p>(optional) [character] vector of 2 values to define the beginning and end of the warm-up period [<code>"YYYY-mm-dd"</code> or <code>"YYYY-mm-dd HH:MM:SS"</code>]; [0L] to disable the warm-up period. See details</p>
</td></tr>
<tr><td><code id="SimGR_+3A_simper">SimPer</code></td>
<td>
<p>[character] vector of 2 values to define the beginning and end of the simulation period  [<code>"YYYY-mm-dd"</code> or <code>"YYYY-mm-dd HH:MM:SS"</code>]</p>
</td></tr>
<tr><td><code id="SimGR_+3A_transfo">transfo</code></td>
<td>
<p>(optional) [character] name of the transformation applied to discharge for calculating the error criterion (must be one of <code>""</code>, <code>"sqrt"</code>, <code>"log"</code>, <code>"inv"</code> or <code>"sort"</code>)</p>
</td></tr>
<tr><td><code id="SimGR_+3A_verbose">verbose</code></td>
<td>
<p>(optional) [boolean] logical value indicating if the function is run in verbose mode or not</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The user can customize the parameters with the <code>Param</code> argument.
The user can also use the parameters resulting from a calibration. In this case, it is necessary to use the <code><a href="#topic+CalGR">CalGR</a></code> function.
<br /><br />
<code>WupPer = NULL</code> indicates that, if available, a period of one year immediately present before the CalPer period is used. <code>WupPer = 0L</code> allows to disable the warm up of the model.
</p>


<h3>Value</h3>

<p>[list] object of class <code>SimGR</code> containing:
</p>
<table>
<tr><td><code>OptionsSimul</code></td>
<td>
<p>[list] object of class <code>RunOptions</code> (see: <code><a href="airGR.html#topic+CreateRunOptions">CreateRunOptions</a></code>)</p>
</td></tr>
<tr><td><code>OptionsCrit</code></td>
<td>
<p>[list] object of class <code>InputsCrit</code> (see: <code><a href="airGR.html#topic+CreateInputsCrit">CreateInputsCrit</a></code>)</p>
</td></tr>
<tr><td><code>OutputsModel</code></td>
<td>
<p>[list] object of class <code>OutputsModel</code> (see: <code><a href="airGR.html#topic+RunModel">RunModel</a></code>)</p>
</td></tr>
<tr><td><code>Qobs</code></td>
<td>
<p>[numeric]  series of observed discharges [mm/time step]</p>
</td></tr>
<tr><td><code>TypeModel</code></td>
<td>
<p>[character] name of the function of the hydrological model used</p>
</td></tr>
<tr><td><code>CalCrit</code></td>
<td>
<p>[character] name of the function that computes the error criterion during the calibration step</p>
</td></tr>
<tr><td><code>EffCrit</code></td>
<td>
<p>[list] name of the function that computes the error criterion during the simulation step</p>
</td></tr>
<tr><td><code>PeriodModel</code></td>
<td>
<p>[list] <code>$WarmUp</code>: vector of 2 <code>POSIXct</code> values defining the beginning and end of the warm-up period; <code>$Run</code>: vector of 2 <code>POSIXct</code> values defining the beginning and end of the calibration period</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olivier Delaigue, Guillaume Thirel</p>


<h3>See Also</h3>

<p>airGRteaching
<code><a href="#topic+plot">plot</a></code> and  <code><a href="#topic+dyplot">dyplot</a></code>
functions to display static and dynamic plots
<br /><br />
airGR
<code><a href="airGR.html#topic+CreateRunOptions">CreateRunOptions</a></code>, <code><a href="airGR.html#topic+CreateInputsCrit">CreateInputsCrit</a></code>, <code><a href="airGR.html#topic+RunModel">RunModel</a></code>, <code><a href="airGR.html#topic+ErrorCrit_RMSE">ErrorCrit_RMSE</a></code>, <code><a href="airGR.html#topic+ErrorCrit_NSE">ErrorCrit_NSE</a></code>, <code><a href="airGR.html#topic+ErrorCrit_KGE">ErrorCrit_KGE</a></code>, <code><a href="airGR.html#topic+ErrorCrit_KGE2">ErrorCrit_KGE2</a></code>
functions
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(airGRteaching)

## data.frame of observed data
data(L0123001, package = "airGR")
BasinObs2 &lt;- BasinObs[, c("DatesR", "P", "E", "Qmm", "T")]

## Preparation of observed data for modelling
PREP &lt;- PrepGR(ObsDF = BasinObs2, HydroModel = "GR4J", CemaNeige = FALSE)

## Calibration step
CAL &lt;- CalGR(PrepGR = PREP, CalCrit = "KGE2",
             WupPer = NULL, CalPer = c("1990-01-01", "1993-12-31"))

## Simulation step using the result of the automatic calibration method to set the model parameters
SIM &lt;- SimGR(PrepGR = PREP, Param = CAL, EffCrit = "KGE2",
             WupPer = NULL, SimPer = c("1994-01-01", "1998-12-31"))

## Simulation step using model parameters set by the user
SIM &lt;- SimGR(PrepGR = PREP, Param = c(270.426, 0.984, 108.853, 2.149), EffCrit = "KGE2",
             WupPer = NULL, SimPer = c("1994-01-01", "1998-12-31"))


## Structure of SimGR object
str(SIM)

## Plot diagnostics
plot(SIM)

## Static plot of observed and simulated time series
plot(SIM, which = "ts")
plot(SIM, which = c("Precip", "Flows"))

## Dynamic plot of observed and simulated time series
dyplot(SIM)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
