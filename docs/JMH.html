<!DOCTYPE html><html lang="en-US"><head><title>Help for package JMH</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {JMH}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AUCJMMLSM'><p>Time-dependent AUC  for joint models</p></a></li>
<li><a href='#cdata'><p>Simulated competing risks data</p></a></li>
<li><a href='#JMMLSM'><p>Joint Modeling for Continuous outcomes</p></a></li>
<li><a href='#MAEQJMMLSM'><p>A metric of prediction accuracy of joint model by comparing the predicted risk</p>
with the empirical risks stratified on different predicted risk group.</a></li>
<li><a href='#PEJMMLSM'><p>A metric of prediction accuracy of joint model by comparing the predicted risk</p>
with the counting process.</a></li>
<li><a href='#plot.survfitJMMLSM'><p>Plot conditional probabilities for new subjects</p></a></li>
<li><a href='#print.JMMLSM'><p>Print JMMLSM</p></a></li>
<li><a href='#print.survfitJMMLSM'><p>Print survfitJMMLSM</p></a></li>
<li><a href='#summary.AUCJMMLSM'><p>Print AUCJMMLSM</p></a></li>
<li><a href='#summary.MAEQJMMLSM'><p>Print MAEQJMMLSM</p></a></li>
<li><a href='#summary.PEJMMLSM'><p>Print PEJMMLSM</p></a></li>
<li><a href='#survfitJMMLSM'><p>Prediction in Joint Models</p></a></li>
<li><a href='#vcov'><p>Variance-covariance matrix of the estimated parameters for joint models</p></a></li>
<li><a href='#ydata'><p>Simulated longitudinal data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Joint Model of Heterogeneous Repeated Measures and Survival Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-19</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Shanpeng Li &lt;lishanpeng0913@ucla.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Maximum likelihood estimation for the semi-parametric joint modeling of competing risks and longitudinal data in the presence of heterogeneous within-subject variability, proposed by Li and colleagues (2023) &lt;<a href="https://doi.org/10.48550/arXiv.2301.06584">doi:10.48550/arXiv.2301.06584</a>&gt;.
             The proposed method models the within-subject variability of the biomarker and associates it with the risk of the competing risks event. The time-to-event data is modeled using a (cause-specific) Cox proportional hazards regression model with time-fixed covariates. 
             The longitudinal outcome is modeled using a mixed-effects location and scale model. The association is captured by shared random effects. The model 
             is estimated using an Expectation Maximization algorithm.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.7), parallel, dplyr, stats, caret, timeROC</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), survival, nlme, utils, MASS, statmod</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), spelling</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-20 06:22:18 UTC; shanpengli</td>
</tr>
<tr>
<td>Author:</td>
<td>Shanpeng Li [aut, cre],
  Jin Zhou [ctb],
  Hua Zhou [ctb],
  Gang Li [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-20 06:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AUCJMMLSM'>Time-dependent AUC  for joint models</h2><span id='topic+AUCJMMLSM'></span>

<h3>Description</h3>

<p>Time-dependent AUC  for joint models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AUCJMMLSM(
  object,
  seed = 100,
  landmark.time = NULL,
  horizon.time = NULL,
  obs.time = NULL,
  method = c("Laplace", "GH"),
  quadpoint = NULL,
  maxiter = 1000,
  n.cv = 3,
  survinitial = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AUCJMMLSM_+3A_object">object</code></td>
<td>
<p>object of class 'JMMLSM'.</p>
</td></tr>
<tr><td><code id="AUCJMMLSM_+3A_seed">seed</code></td>
<td>
<p>a numeric value of seed to be specified for cross validation.</p>
</td></tr>
<tr><td><code id="AUCJMMLSM_+3A_landmark.time">landmark.time</code></td>
<td>
<p>a numeric value of time for which dynamic prediction starts..</p>
</td></tr>
<tr><td><code id="AUCJMMLSM_+3A_horizon.time">horizon.time</code></td>
<td>
<p>a numeric vector of future times for which predicted probabilities are to be computed.</p>
</td></tr>
<tr><td><code id="AUCJMMLSM_+3A_obs.time">obs.time</code></td>
<td>
<p>a character string of specifying a longitudinal time variable.</p>
</td></tr>
<tr><td><code id="AUCJMMLSM_+3A_method">method</code></td>
<td>
<p>estimation method for predicted probabilities. If <code>Laplace</code>, then the empirical empirical
estimates of random effects is used. If <code>GH</code>, then the pseudo-adaptive Gauss-Hermite quadrature is used.</p>
</td></tr>
<tr><td><code id="AUCJMMLSM_+3A_quadpoint">quadpoint</code></td>
<td>
<p>the number of pseudo-adaptive Gauss-Hermite quadrature points if <code>method = "GH"</code>.</p>
</td></tr>
<tr><td><code id="AUCJMMLSM_+3A_maxiter">maxiter</code></td>
<td>
<p>the maximum number of iterations of the EM algorithm that the 
function will perform. Default is 10000.</p>
</td></tr>
<tr><td><code id="AUCJMMLSM_+3A_n.cv">n.cv</code></td>
<td>
<p>number of folds for cross validation. Default is 3.</p>
</td></tr>
<tr><td><code id="AUCJMMLSM_+3A_survinitial">survinitial</code></td>
<td>
<p>Fit a Cox model to obtain initial values of the parameter estimates. Default is TRUE.</p>
</td></tr>
<tr><td><code id="AUCJMMLSM_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of matrices with conditional probabilities for subjects.
</p>


<h3>Author(s)</h3>

<p>Shanpeng Li <a href="mailto:lishanpeng0913@ucla.edu">lishanpeng0913@ucla.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JMMLSM">JMMLSM</a>, <a href="#topic+survfitJMMLSM">survfitJMMLSM</a></code>
</p>

<hr>
<h2 id='cdata'>Simulated competing risks data</h2><span id='topic+cdata'></span>

<h3>Description</h3>

<p>The <code>cdata</code> data frame has 200 rows and 6 columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cdata)
</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt><code>ID</code></dt><dd><p>patient identifier.</p>
</dd>
<dt><code>survtime</code></dt><dd><p>event time.</p>
</dd>
<dt><code>cmprsk</code></dt><dd><p>event indicator. <code>0</code> denotes censoring, <code>1</code> risk 1, 
and <code>2</code> risk 2.</p>
</dd>
<dt><code>var1</code></dt><dd><p>treatment indicator. <code>0</code> denotes the placebo group and <code>1</code> the treatment group.</p>
</dd>
<dt><code>var2</code></dt><dd><p>continuous variable.</p>
</dd>
<dt><code>var3</code></dt><dd><p>continuous variable.</p>
</dd>
</dl>


<hr>
<h2 id='JMMLSM'>Joint Modeling for Continuous outcomes</h2><span id='topic+JMMLSM'></span>

<h3>Description</h3>

<p>Joint modeling of longitudinal continuous data and competing risks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JMMLSM(
  cdata,
  ydata,
  long.formula,
  surv.formula,
  variance.formula,
  random,
  maxiter = 1000,
  epsilon = 1e-04,
  quadpoint = NULL,
  print.para = FALSE,
  survinitial = TRUE,
  initial.para = NULL,
  method = "adaptive",
  opt = "nlminb",
  initial.optimizer = "BFGS"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="JMMLSM_+3A_cdata">cdata</code></td>
<td>
<p>a survival data frame with competing risks or single failure.
Each subject has one data entry.</p>
</td></tr>
<tr><td><code id="JMMLSM_+3A_ydata">ydata</code></td>
<td>
<p>a longitudinal data frame in long format.</p>
</td></tr>
<tr><td><code id="JMMLSM_+3A_long.formula">long.formula</code></td>
<td>
<p>a formula object with the response variable and fixed effects covariates
to be included in the longitudinal sub-model.</p>
</td></tr>
<tr><td><code id="JMMLSM_+3A_surv.formula">surv.formula</code></td>
<td>
<p>a formula object with the survival time, event indicator, and the covariates
to be included in the survival sub-model.</p>
</td></tr>
<tr><td><code id="JMMLSM_+3A_variance.formula">variance.formula</code></td>
<td>
<p>an one-sided formula object with the fixed effects covariates to model the variance of longitudinal sub-model.</p>
</td></tr>
<tr><td><code id="JMMLSM_+3A_random">random</code></td>
<td>
<p>a one-sided formula object describing the random effects part of the longitudinal sub-model.
For example, fitting a random intercept model takes the form ~ 1|ID.
Alternatively. Fitting a random intercept and slope model takes the form ~ x1 + ... + xn|ID.</p>
</td></tr>
<tr><td><code id="JMMLSM_+3A_maxiter">maxiter</code></td>
<td>
<p>the maximum number of iterations of the EM algorithm that the function will perform. Default is 10000.</p>
</td></tr>
<tr><td><code id="JMMLSM_+3A_epsilon">epsilon</code></td>
<td>
<p>Tolerance parameter. Default is 0.0001.</p>
</td></tr>
<tr><td><code id="JMMLSM_+3A_quadpoint">quadpoint</code></td>
<td>
<p>the number of Gauss-Hermite quadrature points
to be chosen for numerical integration. Default is 15 which produces stable estimates in most dataframes.</p>
</td></tr>
<tr><td><code id="JMMLSM_+3A_print.para">print.para</code></td>
<td>
<p>Print detailed information of each iteration. Default is FALSE, i.e., not to print the iteration details.</p>
</td></tr>
<tr><td><code id="JMMLSM_+3A_survinitial">survinitial</code></td>
<td>
<p>Fit a Cox model to obtain initial values of the parameter estimates. Default is TRUE.</p>
</td></tr>
<tr><td><code id="JMMLSM_+3A_initial.para">initial.para</code></td>
<td>
<p>a list of initialized parameters for EM iteration. Default is NULL.</p>
</td></tr>
<tr><td><code id="JMMLSM_+3A_method">method</code></td>
<td>
<p>Method for proceeding numerical integration in the E-step. Default is adaptive.</p>
</td></tr>
<tr><td><code id="JMMLSM_+3A_opt">opt</code></td>
<td>
<p>Optimization method to fit a linear mixed effects model, either nlminb (default) or optim.</p>
</td></tr>
<tr><td><code id="JMMLSM_+3A_initial.optimizer">initial.optimizer</code></td>
<td>
<p>Method for numerical optimization to be used. Default is <code>BFGS</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>JMMLSM</code> with elements
</p>
<table role = "presentation">
<tr><td><code>ydata</code></td>
<td>
<p>the input longitudinal dataset for fitting a joint model.
It has been re-ordered in accordance with descending observation times in <code>cdata</code>.</p>
</td></tr>
<tr><td><code>cdata</code></td>
<td>
<p>the input survival dataset for fitting a joint model.
It has been re-ordered in accordance with descending observation times.</p>
</td></tr>
<tr><td><code>PropEventType</code></td>
<td>
<p>a frequency table of number of events.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>the vector of fixed effects for the mean trajectory in the mixed effects location and scale model.</p>
</td></tr> 
<tr><td><code>tau</code></td>
<td>
<p>the vector of fixed effects for the within-subject variability in the mixed effects location and scale model.</p>
</td></tr> 
<tr><td><code>gamma1</code></td>
<td>
<p>the vector of fixed effects for type 1 failure for the survival model.</p>
</td></tr>
<tr><td><code>gamma2</code></td>
<td>
<p>the vector of fixed effects for type 2 failure for the survival model. 
Valid only if <code>CompetingRisk = TRUE</code>.</p>
</td></tr>
<tr><td><code>alpha1</code></td>
<td>
<p>the vector of association parameter(s) for the mean trajectory for type 1 failure.</p>
</td></tr>
<tr><td><code>alpha2</code></td>
<td>
<p>the vector of association parameter(s) for the mean trajectory for type 2 failure. Valid only if <code>CompetingRisk = TRUE</code>.</p>
</td></tr>
<tr><td><code>vee1</code></td>
<td>
<p>the vector of association parameter(s) for the within-subject variability for type 1 failure.</p>
</td></tr>
<tr><td><code>vee2</code></td>
<td>
<p>the vector of association parameter(s) for the within-subject variability for type 2 failure. Valid only if <code>CompetingRisk = TRUE</code>.</p>
</td></tr>
<tr><td><code>H01</code></td>
<td>
<p>the matrix that collects baseline hazards evaluated at each uncensored event time for type 1 failure. 
The first column denotes uncensored event times, the second column the number of events, and the third columns 
the hazards obtained by Breslow estimator.</p>
</td></tr>
<tr><td><code>H02</code></td>
<td>
<p>the matrix that collects baseline hazards evaluated at each uncensored event time for type 2 failure. 
The data structure is the same as <code>H01</code>. Valid only if <code>CompetingRisk = TRUE</code>.</p>
</td></tr>
<tr><td><code>Sig</code></td>
<td>
<p>the variance-covariance matrix of the random effects.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>the total number of iterations until convergence.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>convergence identifier: 1 corresponds to successful convergence, 
whereas 0 to a problem (i.e., when 0, usually more iterations are required).</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>the variance-covariance matrix of all the fixed effects for both models.</p>
</td></tr>
<tr><td><code>sebeta</code></td>
<td>
<p>the standard error of <code>beta</code>.</p>
</td></tr>
<tr><td><code>setau</code></td>
<td>
<p>the standard error of <code>tau</code>.</p>
</td></tr>
<tr><td><code>segamma1</code></td>
<td>
<p>the standard error of <code>gamma1</code>.</p>
</td></tr>
<tr><td><code>segamma2</code></td>
<td>
<p>the standard error of <code>gamma2</code>. 
Valid only if <code>CompetingRisk = TRUE</code>.</p>
</td></tr>
<tr><td><code>sealpha1</code></td>
<td>
<p>the standard error of <code>alpha1</code>.</p>
</td></tr>
<tr><td><code>sealpha2</code></td>
<td>
<p>the standard error of <code>alpha2</code>. Valid only if <code>CompetingRisk = TRUE</code>.</p>
</td></tr>
<tr><td><code>sevee1</code></td>
<td>
<p>the standard error of <code>vee1</code>.</p>
</td></tr>
<tr><td><code>sevee2</code></td>
<td>
<p>the standard error of <code>vee2</code>. Valid only if <code>CompetingRisk = TRUE</code>.</p>
</td></tr>
<tr><td><code>seSig</code></td>
<td>
<p>the vector of standard errors of covariance of random effects.</p>
</td></tr>
<tr><td><code>loglike</code></td>
<td>
<p>the log-likelihood value.</p>
</td></tr>
<tr><td><code>EFuntheta</code></td>
<td>
<p>a list with the expected values of all the functions of random effects.</p>
</td></tr>
<tr><td><code>CompetingRisk</code></td>
<td>
<p>logical value; TRUE if a competing event are accounted for.</p>
</td></tr>
<tr><td><code>quadpoint</code></td>
<td>
<p>the number of Gauss Hermite quadrature points used for numerical integration.</p>
</td></tr>
<tr><td><code>LongitudinalSubmodelmean</code></td>
<td>
<p>the component of the <code>long.formula</code>.</p>
</td></tr>
<tr><td><code>LongitudinalSubmodelvariance</code></td>
<td>
<p>the component of the <code>variance.formula</code>.</p>
</td></tr>
<tr><td><code>SurvivalSubmodel</code></td>
<td>
<p>the component of the <code>surv.formula</code>.</p>
</td></tr>
<tr><td><code>random</code></td>
<td>
<p>the component of the <code>random</code>.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>require(JMH)
data(ydata)
data(cdata)
## fit a joint model
## Not run: 
fit &lt;- JMMLSM(cdata = cdata, ydata = ydata, 
              long.formula = Y ~ Z1 + Z2 + Z3 + time,
              surv.formula = Surv(survtime, cmprsk) ~ var1 + var2 + var3,
              variance.formula = ~ Z1 + Z2 + Z3 + time, 
              quadpoint = 6, random = ~ 1|ID, print.para = FALSE)
              
## make dynamic prediction of two subjects
cnewdata &lt;- cdata[cdata$ID %in% c(122, 152), ]
ynewdata &lt;- ydata[ydata$ID %in% c(122, 152), ]
survfit &lt;- survfitJMMLSM(fit, seed = 100, ynewdata = ynewdata, cnewdata = cnewdata, 
                         u = seq(5.2, 7.2, by = 0.5), Last.time = "survtime",
                         obs.time = "time", method = "GH")
oldpar &lt;- par(mfrow = c(2, 2), mar = c(5, 4, 4, 4))
plot(survfit, include.y = TRUE)
par(oldpar)

## End(Not run)
</code></pre>

<hr>
<h2 id='MAEQJMMLSM'>A metric of prediction accuracy of joint model by comparing the predicted risk
with the empirical risks stratified on different predicted risk group.</h2><span id='topic+MAEQJMMLSM'></span>

<h3>Description</h3>

<p>A metric of prediction accuracy of joint model by comparing the predicted risk
with the empirical risks stratified on different predicted risk group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MAEQJMMLSM(
  seed = 100,
  object,
  landmark.time = NULL,
  horizon.time = NULL,
  obs.time = NULL,
  method = c("Laplace", "GH"),
  quadpoint = NULL,
  maxiter = 1000,
  survinitial = TRUE,
  n.cv = 3,
  quantile.width = 0.25,
  opt = "nlminb",
  initial.para = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MAEQJMMLSM_+3A_seed">seed</code></td>
<td>
<p>a numeric value of seed to be specified for cross validation.</p>
</td></tr>
<tr><td><code id="MAEQJMMLSM_+3A_object">object</code></td>
<td>
<p>object of class 'JMMLSM'.</p>
</td></tr>
<tr><td><code id="MAEQJMMLSM_+3A_landmark.time">landmark.time</code></td>
<td>
<p>a numeric value of time for which dynamic prediction starts..</p>
</td></tr>
<tr><td><code id="MAEQJMMLSM_+3A_horizon.time">horizon.time</code></td>
<td>
<p>a numeric vector of future times for which predicted probabilities are to be computed.</p>
</td></tr>
<tr><td><code id="MAEQJMMLSM_+3A_obs.time">obs.time</code></td>
<td>
<p>a character string of specifying a longitudinal time variable.</p>
</td></tr>
<tr><td><code id="MAEQJMMLSM_+3A_method">method</code></td>
<td>
<p>estimation method for predicted probabilities. If <code>Laplace</code>, then the empirical empirical
estimates of random effects is used. If <code>GH</code>, then the standard Gauss-Hermite quadrature is used.</p>
</td></tr>
<tr><td><code id="MAEQJMMLSM_+3A_quadpoint">quadpoint</code></td>
<td>
<p>the number of standard Gauss-Hermite quadrature points if <code>method = "GH"</code>.</p>
</td></tr>
<tr><td><code id="MAEQJMMLSM_+3A_maxiter">maxiter</code></td>
<td>
<p>the maximum number of iterations of the EM algorithm that the 
function will perform. Default is 10000.</p>
</td></tr>
<tr><td><code id="MAEQJMMLSM_+3A_survinitial">survinitial</code></td>
<td>
<p>Fit a Cox model to obtain initial values of the parameter estimates. Default is TRUE.</p>
</td></tr>
<tr><td><code id="MAEQJMMLSM_+3A_n.cv">n.cv</code></td>
<td>
<p>number of folds for cross validation. Default is 3.</p>
</td></tr>
<tr><td><code id="MAEQJMMLSM_+3A_quantile.width">quantile.width</code></td>
<td>
<p>a numeric value of width of quantile to be specified. Default is 0.25.</p>
</td></tr>
<tr><td><code id="MAEQJMMLSM_+3A_opt">opt</code></td>
<td>
<p>Optimization method to fit a linear mixed effects model, either nlminb (default) or optim.</p>
</td></tr>
<tr><td><code id="MAEQJMMLSM_+3A_initial.para">initial.para</code></td>
<td>
<p>Initial guess of parameters for cross validation. Default is FALSE.</p>
</td></tr>
<tr><td><code id="MAEQJMMLSM_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of matrices with conditional probabilities for subjects.
</p>


<h3>Author(s)</h3>

<p>Shanpeng Li <a href="mailto:lishanpeng0913@ucla.edu">lishanpeng0913@ucla.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JMMLSM">JMMLSM</a>, <a href="#topic+survfitJMMLSM">survfitJMMLSM</a></code>
</p>

<hr>
<h2 id='PEJMMLSM'>A metric of prediction accuracy of joint model by comparing the predicted risk
with the counting process.</h2><span id='topic+PEJMMLSM'></span>

<h3>Description</h3>

<p>A metric of prediction accuracy of joint model by comparing the predicted risk
with the counting process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PEJMMLSM(
  seed = 100,
  object,
  landmark.time = NULL,
  horizon.time = NULL,
  obs.time = NULL,
  method = c("Laplace", "GH"),
  quadpoint = NULL,
  maxiter = 1000,
  n.cv = 3,
  survinitial = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PEJMMLSM_+3A_seed">seed</code></td>
<td>
<p>a numeric value of seed to be specified for cross validation.</p>
</td></tr>
<tr><td><code id="PEJMMLSM_+3A_object">object</code></td>
<td>
<p>object of class 'JMMLSM'.</p>
</td></tr>
<tr><td><code id="PEJMMLSM_+3A_landmark.time">landmark.time</code></td>
<td>
<p>a numeric value of time for which dynamic prediction starts..</p>
</td></tr>
<tr><td><code id="PEJMMLSM_+3A_horizon.time">horizon.time</code></td>
<td>
<p>a numeric vector of future times for which predicted probabilities are to be computed.</p>
</td></tr>
<tr><td><code id="PEJMMLSM_+3A_obs.time">obs.time</code></td>
<td>
<p>a character string of specifying a longitudinal time variable.</p>
</td></tr>
<tr><td><code id="PEJMMLSM_+3A_method">method</code></td>
<td>
<p>estimation method for predicted probabilities. If <code>Laplace</code>, then the empirical empirical
estimates of random effects is used. If <code>GH</code>, then the pseudo-adaptive Gauss-Hermite quadrature is used.</p>
</td></tr>
<tr><td><code id="PEJMMLSM_+3A_quadpoint">quadpoint</code></td>
<td>
<p>the number of pseudo-adaptive Gauss-Hermite quadrature points if <code>method = "GH"</code>.</p>
</td></tr>
<tr><td><code id="PEJMMLSM_+3A_maxiter">maxiter</code></td>
<td>
<p>the maximum number of iterations of the EM algorithm that the 
function will perform. Default is 10000.</p>
</td></tr>
<tr><td><code id="PEJMMLSM_+3A_n.cv">n.cv</code></td>
<td>
<p>number of folds for cross validation. Default is 3.</p>
</td></tr>
<tr><td><code id="PEJMMLSM_+3A_survinitial">survinitial</code></td>
<td>
<p>Fit a Cox model to obtain initial values of the parameter estimates. Default is TRUE.</p>
</td></tr>
<tr><td><code id="PEJMMLSM_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of matrices with conditional probabilities for subjects.
</p>


<h3>Author(s)</h3>

<p>Shanpeng Li <a href="mailto:lishanpeng0913@ucla.edu">lishanpeng0913@ucla.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JMMLSM">JMMLSM</a>, <a href="#topic+survfitJMMLSM">survfitJMMLSM</a></code>
</p>

<hr>
<h2 id='plot.survfitJMMLSM'>Plot conditional probabilities for new subjects</h2><span id='topic+plot.survfitJMMLSM'></span>

<h3>Description</h3>

<p>Plot conditional probabilities for new subjects. 
If <code>CompetingRisk = FALSE</code>, print the survival probabilities. 
Otherwise, print the cumulative incidence probabilities for each failure type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survfitJMMLSM'
plot(
  x,
  include.y = FALSE,
  xlab = NULL,
  ylab = NULL,
  xlim = NULL,
  ylim.long = NULL,
  ylim.surv = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.survfitJMMLSM_+3A_x">x</code></td>
<td>
<p>x of class <code>survfitJMMLSM</code>.</p>
</td></tr>
<tr><td><code id="plot.survfitJMMLSM_+3A_include.y">include.y</code></td>
<td>
<p>include longitudinal responses of this subject versus time. Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot.survfitJMMLSM_+3A_xlab">xlab</code></td>
<td>
<p>X axis label.</p>
</td></tr>
<tr><td><code id="plot.survfitJMMLSM_+3A_ylab">ylab</code></td>
<td>
<p>Y axis label.</p>
</td></tr>
<tr><td><code id="plot.survfitJMMLSM_+3A_xlim">xlim</code></td>
<td>
<p>X axis support.</p>
</td></tr>
<tr><td><code id="plot.survfitJMMLSM_+3A_ylim.long">ylim.long</code></td>
<td>
<p>Y axis support for the longitudinal outcome.</p>
</td></tr>
<tr><td><code id="plot.survfitJMMLSM_+3A_ylim.surv">ylim.surv</code></td>
<td>
<p>Y axis support for the event / survival probability.</p>
</td></tr>
<tr><td><code id="plot.survfitJMMLSM_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plots of conditional probabilities over different pre-specified time points for subjects. 
If single failure type, then survival probabilities will be returned. 
Otherwise, cumulative incidence probabilities for each failure type will be returned.
</p>


<h3>Author(s)</h3>

<p>Shanpeng Li <a href="mailto:lishanpeng0913@ucla.edu">lishanpeng0913@ucla.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+survfitJMMLSM">survfitJMMLSM</a></code>
</p>

<hr>
<h2 id='print.JMMLSM'>Print JMMLSM</h2><span id='topic+print.JMMLSM'></span>

<h3>Description</h3>

<p>Print contents of JMMLSM object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'JMMLSM'
print(x, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.JMMLSM_+3A_x">x</code></td>
<td>
<p>Object of class 'JMMLSM'.</p>
</td></tr>
<tr><td><code id="print.JMMLSM_+3A_digits">digits</code></td>
<td>
<p>number of digits of decimal to be printed.</p>
</td></tr>
<tr><td><code id="print.JMMLSM_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a summary of data, joint model, log likelihood, and parameter estimates.
</p>


<h3>Author(s)</h3>

<p>Shanpeng Li
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JMMLSM">JMMLSM</a></code>
</p>

<hr>
<h2 id='print.survfitJMMLSM'>Print survfitJMMLSM</h2><span id='topic+print.survfitJMMLSM'></span>

<h3>Description</h3>

<p>Print survfitJMMLSM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survfitJMMLSM'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.survfitJMMLSM_+3A_x">x</code></td>
<td>
<p>x of class 'survfitJMMLSM'.</p>
</td></tr>
<tr><td><code id="print.survfitJMMLSM_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of matrices with conditional probabilities for subjects.
</p>


<h3>Author(s)</h3>

<p>Shanpeng Li <a href="mailto:lishanpeng0913@ucla.edu">lishanpeng0913@ucla.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JMMLSM">JMMLSM</a>, <a href="#topic+survfitJMMLSM">survfitJMMLSM</a></code>
</p>

<hr>
<h2 id='summary.AUCJMMLSM'>Print AUCJMMLSM</h2><span id='topic+summary.AUCJMMLSM'></span>

<h3>Description</h3>

<p>Print AUCJMMLSM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'AUCJMMLSM'
summary(object, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.AUCJMMLSM_+3A_object">object</code></td>
<td>
<p>object of class 'AUCJMMLSM'.</p>
</td></tr>
<tr><td><code id="summary.AUCJMMLSM_+3A_digits">digits</code></td>
<td>
<p>number of digits of decimal to be printed.</p>
</td></tr>
<tr><td><code id="summary.AUCJMMLSM_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of matrices with conditional probabilities for subjects.
</p>


<h3>Author(s)</h3>

<p>Shanpeng Li <a href="mailto:lishanpeng0913@ucla.edu">lishanpeng0913@ucla.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JMMLSM">JMMLSM</a>, <a href="#topic+survfitJMMLSM">survfitJMMLSM</a></code>
</p>

<hr>
<h2 id='summary.MAEQJMMLSM'>Print MAEQJMMLSM</h2><span id='topic+summary.MAEQJMMLSM'></span>

<h3>Description</h3>

<p>Print MAEQJMMLSM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MAEQJMMLSM'
summary(object, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.MAEQJMMLSM_+3A_object">object</code></td>
<td>
<p>object of class 'MAEQJMMLSM'.</p>
</td></tr>
<tr><td><code id="summary.MAEQJMMLSM_+3A_digits">digits</code></td>
<td>
<p>number of decimal points to be rounded.</p>
</td></tr>
<tr><td><code id="summary.MAEQJMMLSM_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of matrices with conditional probabilities for subjects.
</p>


<h3>Author(s)</h3>

<p>Shanpeng Li <a href="mailto:lishanpeng0913@ucla.edu">lishanpeng0913@ucla.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JMMLSM">JMMLSM</a>, <a href="#topic+survfitJMMLSM">survfitJMMLSM</a></code>
</p>

<hr>
<h2 id='summary.PEJMMLSM'>Print PEJMMLSM</h2><span id='topic+summary.PEJMMLSM'></span>

<h3>Description</h3>

<p>Print PEJMMLSM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PEJMMLSM'
summary(object, error = c("MAE", "Brier"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.PEJMMLSM_+3A_object">object</code></td>
<td>
<p>object of class 'PEJMMLSM'.</p>
</td></tr>
<tr><td><code id="summary.PEJMMLSM_+3A_error">error</code></td>
<td>
<p>a character string that specifies the loss function.</p>
</td></tr>
<tr><td><code id="summary.PEJMMLSM_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of matrices with conditional probabilities for subjects.
</p>


<h3>Author(s)</h3>

<p>Shanpeng Li <a href="mailto:lishanpeng0913@ucla.edu">lishanpeng0913@ucla.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JMMLSM">JMMLSM</a>, <a href="#topic+survfitJMMLSM">survfitJMMLSM</a></code>
</p>

<hr>
<h2 id='survfitJMMLSM'>Prediction in Joint Models</h2><span id='topic+survfitJMMLSM'></span>

<h3>Description</h3>

<p>This function computes the conditional probability of 
surviving later times than the last observed time for which a longitudinal 
measurement was available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survfitJMMLSM(
  object,
  seed = 100,
  ynewdata = NULL,
  cnewdata = NULL,
  u = NULL,
  Last.time = NULL,
  obs.time = NULL,
  method = c("Laplace", "GH"),
  quadpoint = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="survfitJMMLSM_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code>JMMLSM</code>.</p>
</td></tr>
<tr><td><code id="survfitJMMLSM_+3A_seed">seed</code></td>
<td>
<p>a random seed number to proceed non-parametric bootstrap. Default is 100.</p>
</td></tr>
<tr><td><code id="survfitJMMLSM_+3A_ynewdata">ynewdata</code></td>
<td>
<p>a data frame that contains the longitudinal and covariate information for the subjects 
for which prediction of survival probabilities is required.</p>
</td></tr>
<tr><td><code id="survfitJMMLSM_+3A_cnewdata">cnewdata</code></td>
<td>
<p>a data frame that contains the survival and covariate information for the subjects 
for which prediction of survival probabilities is required.</p>
</td></tr>
<tr><td><code id="survfitJMMLSM_+3A_u">u</code></td>
<td>
<p>a numeric vector of times for which prediction survival probabilities are to be computed.</p>
</td></tr>
<tr><td><code id="survfitJMMLSM_+3A_last.time">Last.time</code></td>
<td>
<p>a numeric vector or character string. This specifies the known time at which each of 
the subjects in cnewdata was known to be alive. If NULL, then this is automatically taken as the 
survival time of each subject. If a numeric vector, then it is assumed to be greater than or equals to the 
last available longitudinal time point for each subject. If a character string, then it should be 
a variable in cnewdata.</p>
</td></tr>
<tr><td><code id="survfitJMMLSM_+3A_obs.time">obs.time</code></td>
<td>
<p>a character string of specifying a longitudinal time variable in ynewdata.</p>
</td></tr>
<tr><td><code id="survfitJMMLSM_+3A_method">method</code></td>
<td>
<p>a character string specifying the type of probability approximation; if <code>Laplace</code>, then a first order estimator is computed.
If <code>GH</code>, then the standard Gauss-Hermite quadrature is used instead.</p>
</td></tr>
<tr><td><code id="survfitJMMLSM_+3A_quadpoint">quadpoint</code></td>
<td>
<p>number of quadrature points used for estimating conditional probabilities 
when <code>method = "GH"</code>. Default is NULL. If <code>method = "GH"</code>, then 15 is used.</p>
</td></tr>
<tr><td><code id="survfitJMMLSM_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of matrices with conditional probabilities for subjects.
</p>


<h3>Author(s)</h3>

<p>Shanpeng Li <a href="mailto:lishanpeng0913@ucla.edu">lishanpeng0913@ucla.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JMMLSM">JMMLSM</a></code>
</p>

<hr>
<h2 id='vcov'>Variance-covariance matrix of the estimated parameters for joint models</h2><span id='topic+vcov'></span><span id='topic+vcov.JMMLSM'></span>

<h3>Description</h3>

<p>Extract variance-covariance matrix for joint models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'JMMLSM'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code>JMMLSM</code>.</p>
</td></tr>
<tr><td><code id="vcov_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix of variance covariance of all parameter estimates.
</p>


<h3>Author(s)</h3>

<p>Shanpeng Li <a href="mailto:lishanpeng0913@ucla.edu">lishanpeng0913@ucla.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JMMLSM">JMMLSM</a></code>
</p>

<hr>
<h2 id='ydata'>Simulated longitudinal data</h2><span id='topic+ydata'></span>

<h3>Description</h3>

<p>The <code>ydata</code> data frame has 1353 rows and 6 columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ydata)
</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt><code>ID</code></dt><dd><p>patient identifier.</p>
</dd>
<dt><code>Y</code></dt><dd><p>response variable.</p>
</dd>
<dt><code>time</code></dt><dd><p>visit time.</p>
</dd>
<dt><code>Z1</code></dt><dd><p>treatment indicator. <code>0</code> denotes the placebo group and <code>1</code> the treatment group.</p>
</dd>
<dt><code>Z2</code></dt><dd><p>continuous variable..</p>
</dd>
<dt><code>Z3</code></dt><dd><p>continuous variable..</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
