<!DOCTYPE html><html lang="en"><head><title>Help for package madness</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {madness}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#madness-pkg'><p>Multivariate Automatic Differentiation.</p></a></li>
<li><a href='#+5B'><p>Extract parts of a <code>madness</code> value.</p></a></li>
<li><a href='#accessor'><p>Accessor methods.</p></a></li>
<li><a href='#arithops'><p>Basic Arithmetic Operations.</p></a></li>
<li><a href='#as'><p>Coerce madness to something else</p></a></li>
<li><a href='#as.madness'><p>Coerce to a madness object.</p></a></li>
<li><a href='#bind'><p>Row and Column Bind</p></a></li>
<li><a href='#blockrep'><p>Replicate blocks of multidimensional value.</p></a></li>
<li><a href='#colsums'><p>Form Row and Column Sums and Means</p></a></li>
<li><a href='#det'><p>Matrix Determinant</p></a></li>
<li><a href='#eigen'><p>Spectral Decomposition of a Matrix</p></a></li>
<li><a href='#elwise'><p>Element-wise Multivariate Operations</p></a></li>
<li><a href='#madness-class'><p>Madness Class.</p></a></li>
<li><a href='#madness-NEWS'><p>News for package &lsquo;madness&rsquo;:</p></a></li>
<li><a href='#marithops'><p>Basic Matrix Arithmetic Operations.</p></a></li>
<li><a href='#matrix.trace'><p>Matrix Trace</p></a></li>
<li><a href='#matwise'><p>Matrix-wise Multivariate Operations</p></a></li>
<li><a href='#max'><p>Maxima and Minima</p></a></li>
<li><a href='#norm'><p>Matrix and vector norms.</p></a></li>
<li><a href='#numderiv'><p>Numerical (approximate) Differentiation.</p></a></li>
<li><a href='#outer'><p>Outer product.</p></a></li>
<li><a href='#reshapes'><p>Basic Reshape Operations</p></a></li>
<li><a href='#setter'><p>Setter methods.</p></a></li>
<li><a href='#show'><p>Show a madness object.</p></a></li>
<li><a href='#solve'><p>Basic Matrix Inversion</p></a></li>
<li><a href='#stock_returns'><p>Stock Returns Data</p></a></li>
<li><a href='#sumprod'><p>Sum and Product.</p></a></li>
<li><a href='#theta'><p>Estimate the symmetric second moment array of values.</p></a></li>
<li><a href='#to_objective'><p>Convert a madness object into an objective value with gradient</p></a></li>
<li><a href='#todiag'><p>Diagonal Operations</p></a></li>
<li><a href='#twomoments'><p>Estimate the mean and covariance of values.</p></a></li>
<li><a href='#vcov.madness'><p>Calculate Variance-Covariance Matrix for a model.</p></a></li>
<li><a href='#vec'><p>vectorize a multidimensional array.</p></a></li>
<li><a href='#wff3'><p>Weekly Fama French 3 Factor Returns</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Maintainer:</td>
<td>Steven E. Pav &lt;shabbychef@gmail.com&gt;</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.8</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-20</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a></td>
</tr>
<tr>
<td>Title:</td>
<td>Automatic Differentiation of Multivariate Operations</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/shabbychef/madness/issues">https://github.com/shabbychef/madness/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>An object that supports automatic differentiation
    of matrix- and multidimensional-valued functions with 
    respect to multidimensional independent variables. 
    Automatic differentiation is via 'forward accumulation'.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Matrix, matrixcalc, expm, methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, dplyr, tidyr, lubridate, SharpeR, sandwich,
formatR, knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/shabbychef/madness">https://github.com/shabbychef/madness</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Collate:</td>
<td>'AllClass.r' 'utils.r' 'Ops.r' 'bind.r' 'blockrep.r'
'coerce.r' 'data.r' 'det.r' 'diag.r' 'eigen.r' 'elwise.r'
'madness_pkg.r' 'matwise.r' 'max.r' 'norm.r' 'numderiv.r'
'reshape.r' 'solve.r' 'sum.r' 'sums.r' 'theta.r'
'to_objective.r' 'trace.r' 'twomoments.r' 'vcov.r' 'vec.r'</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-21 04:59:53 UTC; spav</td>
</tr>
<tr>
<td>Author:</td>
<td>Steven E. Pav <a href="https://orcid.org/0000-0002-4197-6195"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-21 07:42:32 UTC</td>
</tr>
</table>
<hr>
<h2 id='madness-pkg'>Multivariate Automatic Differentiation.</h2><span id='topic+madness-pkg'></span><span id='topic+_PACKAGE'></span><span id='topic+madness-package'></span>

<h3>Description</h3>

<p>Automatic Differentiation of Matrix Operations.
</p>


<h3>Legal Mumbo Jumbo</h3>

<p>madness is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Lesser General Public License for more details.
</p>


<h3>Note</h3>

<p>This package is maintained as a hobby.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>
<p><strong>Maintainer</strong>: Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a> (<a href="https://orcid.org/0000-0002-4197-6195">ORCID</a>)
</p>


<h3>References</h3>

<p>Petersen, Kaare Brandt and Pedersen, Michael Syskind. &quot;The Matrix Cookbook.&quot;
Technical University of Denmark (2012). 
<a href="http://www2.imm.dtu.dk/pubdb/pubs/3274-full.html">http://www2.imm.dtu.dk/pubdb/pubs/3274-full.html</a>
</p>
<p>Griewank, Andreas and Walther, Andrea. &quot;Evaluating Derivatives: principles and techniques of algorithmic differentiation.&quot;
SIAM (2008).
</p>
<p>Magnus, Jan R. and Neudecker, H. &quot;Matrix Differential Calculus with Applications in Statistics and Econometrics.&quot;
3rd Edition. Wiley Series in Probability and Statistics: Texts and References Section (2007).
</p>
<p>Magnus, Jan R. and Neudecker, H. &quot;The elimination matrix: some lemmas and applications,&quot; 
SIAM Journal on Algebraic Discrete Methods 1, no. 4 (1980): 422-449.
<a href="http://www.janmagnus.nl/papers/JRM008.pdf">http://www.janmagnus.nl/papers/JRM008.pdf</a>
</p>
<p>Magnus, Jan R. and Neudecker, H. &quot;Symmetry, 0-1 Matrices and Jacobians,&quot;
Econometric Theory 2 (1986): 157-190.
<a href="http://www.janmagnus.nl/papers/JRM014.pdf">http://www.janmagnus.nl/papers/JRM014.pdf</a>,
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/shabbychef/madness">https://github.com/shabbychef/madness</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/shabbychef/madness/issues">https://github.com/shabbychef/madness/issues</a>
</p>
</li></ul>


<hr>
<h2 id='+5B'>Extract parts of a <code>madness</code> value.</h2><span id='topic++5B'></span><span id='topic++5B+2Cmadness+2CANY+2CANY+2CANY-method'></span><span id='topic++5B+2Cmadness+2CANY+2Cmissing+2CANY-method'></span>

<h3>Description</h3>

<p>Extract parts of a <code>madness</code> value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'madness,ANY,ANY,ANY'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'madness,ANY,missing,ANY'
x[i, j, ..., drop = TRUE]
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B5B_+3A_x">x</code></td>
<td>
<p>a <code>madness</code> object.</p>
</td></tr>
<tr><td><code id="+2B5B_+3A_i">i</code></td>
<td>

<p>indices specifying elements to extract or replace.  Indices are
<code>numeric</code> or <code>character</code> vectors or empty (missing) or
<code>NULL</code>.  Numeric values are coerced to integer or whole numbers as
by <code><a href="base.html#topic+as.integer">as.integer</a></code> or for large values by <code><a href="base.html#topic+trunc">trunc</a></code>
(and hence truncated towards zero).
Character vectors will be matched to the <code><a href="base.html#topic+names">names</a></code> of the
object (or for matrices/arrays, the <code><a href="base.html#topic+dimnames">dimnames</a></code>):
see &lsquo;Character indices&rsquo; below for further details.
</p>
<p>For <code>[</code>-indexing only: <code>i</code>, <code>j</code>, <code>...</code> can be
logical vectors, indicating elements/slices to select.  Such vectors
are recycled if necessary to match the corresponding extent.
<code>i</code>, <code>j</code>, <code>...</code> can also be negative integers,
indicating elements/slices to leave out of the selection.
</p>
<p>When indexing arrays by <code>[</code> a single argument <code>i</code> can be a
matrix with as many columns as there are dimensions of <code>x</code>; the
result is then a vector with elements corresponding to the sets of
indices in each row of <code>i</code>.
</p>
<p>An index value of <code>NULL</code> is treated as if it were <code>integer(0)</code>.
</p>
</td></tr>
<tr><td><code id="+2B5B_+3A_j">j</code>, <code id="+2B5B_+3A_...">...</code></td>
<td>
<p>further indices specifying elements to extract or 
replace.</p>
</td></tr>
<tr><td><code id="+2B5B_+3A_drop">drop</code></td>
<td>
<p>For matrices and arrays.  If <code>TRUE</code> the result is
coerced to the lowest possible dimension (see the examples).  This
only works for extracting elements, not for the replacement.  See
<code><a href="base.html#topic+drop">drop</a></code> for further details.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>

<hr>
<h2 id='accessor'>Accessor methods.</h2><span id='topic+accessor'></span><span id='topic+val'></span><span id='topic+val+2Cmadness-method'></span><span id='topic+dim+2Cmadness-method'></span><span id='topic+length+2Cmadness-method'></span><span id='topic+dvdx'></span><span id='topic+dvdx+2Cmadness-method'></span><span id='topic+xtag'></span><span id='topic+xtag+2Cmadness-method'></span><span id='topic+vtag'></span><span id='topic+vtag+2Cmadness-method'></span><span id='topic+varx'></span><span id='topic+varx+2Cmadness-method'></span>

<h3>Description</h3>

<p>Access slot data from a <code>madness</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>val(x)

## S4 method for signature 'madness'
val(x)

## S4 method for signature 'madness'
dim(x)

## S4 method for signature 'madness'
length(x)

dvdx(x)

## S4 method for signature 'madness'
dvdx(x)

xtag(x)

## S4 method for signature 'madness'
xtag(x)

vtag(x)

## S4 method for signature 'madness'
vtag(x)

varx(x)

## S4 method for signature 'madness'
varx(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="accessor_+3A_x">x</code></td>
<td>
<p>a <code>madness</code> object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>

<hr>
<h2 id='arithops'>Basic Arithmetic Operations.</h2><span id='topic+arithops'></span><span id='topic++2B+2Cmadness+2Cmissing-method'></span><span id='topic++2B+2Cmadness-class'></span><span id='topic+-+2Cmadness+2Cmissing-method'></span><span id='topic+-+2Cmadness-class'></span><span id='topic++2B+2Cmadness+2Cmadness-method'></span><span id='topic++2B+2Cmadness+2Cmadness-class'></span><span id='topic++2B+2Cmadness+2Cnumeric-method'></span><span id='topic++2B+2Cmadness+2Cnumeric-class'></span><span id='topic++2B+2Cmadness+2Carray-method'></span><span id='topic++2B+2Cmadness+2Carray-class'></span><span id='topic++2B+2Cnumeric+2Cmadness-method'></span><span id='topic++2B+2Cnumeric+2Cmadness-class'></span><span id='topic++2B+2Carray+2Cmadness-method'></span><span id='topic++2B+2Carray+2Cmadness-class'></span><span id='topic+-+2Cmadness+2Cmadness-method'></span><span id='topic+-+2Cmadness+2Cmadness-class'></span><span id='topic+-+2Cmadness+2Cnumeric-method'></span><span id='topic+-+2Cmadness+2Cnumeric-class'></span><span id='topic+-+2Cmadness+2Carray-method'></span><span id='topic+-+2Cmadness+2Carray-class'></span><span id='topic+-+2Cnumeric+2Cmadness-method'></span><span id='topic+-+2Cnumeric+2Cmadness-class'></span><span id='topic+-+2Carray+2Cmadness-method'></span><span id='topic+-+2Carray+2Cmadness-class'></span><span id='topic++2A+2Cmadness+2Cmadness-method'></span><span id='topic++2A+2Cmadness+2Cmadness-class'></span><span id='topic++2A+2Cmadness+2Cnumeric-method'></span><span id='topic++2A+2Cmadness+2Cnumeric-class'></span><span id='topic++2A+2Cmadness+2Carray-method'></span><span id='topic++2A+2Cmadness+2Carray-class'></span><span id='topic++2A+2Cnumeric+2Cmadness-method'></span><span id='topic++2A+2Cnumeric+2Cmadness-class'></span><span id='topic++2A+2Carray+2Cmadness-method'></span><span id='topic++2A+2Carray+2Cmadness-class'></span><span id='topic++2F+2Cmadness+2Cmadness-method'></span><span id='topic++2F+2Cmadness+2Cmadness-class'></span><span id='topic++2F+2Cmadness+2Cnumeric-method'></span><span id='topic++2F+2Cmadness+2Cnumeric-class'></span><span id='topic++2F+2Cmadness+2Carray-method'></span><span id='topic++2F+2Cmadness+2Carray-class'></span><span id='topic++2F+2Cnumeric+2Cmadness-method'></span><span id='topic++2F+2Cnumeric+2Cmadness-class'></span><span id='topic++2F+2Carray+2Cmadness-method'></span><span id='topic++2F+2Carray+2Cmadness-class'></span><span id='topic++5E+2Cmadness+2Cmadness-method'></span><span id='topic++5E+2Cmadness+2Cmadness-class'></span><span id='topic++5E+2Cmadness+2Cnumeric-method'></span><span id='topic++5E+2Cmadness+2Cnumeric-class'></span><span id='topic++5E+2Cmadness+2Carray-method'></span><span id='topic++5E+2Cmadness+2Carray-class'></span><span id='topic++5E+2Cnumeric+2Cmadness-method'></span><span id='topic++5E+2Cnumeric+2Cmadness-class'></span><span id='topic++5E+2Carray+2Cmadness-method'></span><span id='topic++5E+2Carray+2Cmadness-class'></span>

<h3>Description</h3>

<p>These perform basic arithmetic operations on <code>madness</code> objects: unary
plus and minus, addition, subtraction, multiplication, division and power.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'madness,missing'
e1 + e2

## S4 method for signature 'madness,missing'
e1 - e2

## S4 method for signature 'madness,madness'
e1 + e2

## S4 method for signature 'madness,numeric'
e1 + e2

## S4 method for signature 'madness,array'
e1 + e2

## S4 method for signature 'numeric,madness'
e1 + e2

## S4 method for signature 'array,madness'
e1 + e2

## S4 method for signature 'madness,madness'
e1 - e2

## S4 method for signature 'madness,numeric'
e1 - e2

## S4 method for signature 'madness,array'
e1 - e2

## S4 method for signature 'numeric,madness'
e1 - e2

## S4 method for signature 'array,madness'
e1 - e2

## S4 method for signature 'madness,madness'
e1 * e2

## S4 method for signature 'madness,numeric'
e1 * e2

## S4 method for signature 'madness,array'
e1 * e2

## S4 method for signature 'numeric,madness'
e1 * e2

## S4 method for signature 'array,madness'
e1 * e2

## S4 method for signature 'madness,madness'
e1 / e2

## S4 method for signature 'madness,numeric'
e1 / e2

## S4 method for signature 'madness,array'
e1 / e2

## S4 method for signature 'numeric,madness'
e1 / e2

## S4 method for signature 'array,madness'
e1 / e2

## S4 method for signature 'madness,madness'
e1 ^ e2

## S4 method for signature 'madness,numeric'
e1 ^ e2

## S4 method for signature 'madness,array'
e1 ^ e2

## S4 method for signature 'numeric,madness'
e1 ^ e2

## S4 method for signature 'array,madness'
e1 ^ e2
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arithops_+3A_e1">e1</code>, <code id="arithops_+3A_e2">e2</code></td>
<td>
<p><code>madness</code> or numeric values</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
y &lt;- array(rnorm(3*3),dim=c(3,3))
dy &lt;- matrix(rnorm(length(y)*2),ncol=2)
dx &lt;- crossprod(matrix(rnorm(ncol(dy)*100),nrow=100))
obj0 &lt;- madness(val=y,vtag='y',xtag='x',dvdx=dy,varx=dx)
z &lt;- array(rnorm(3*3),dim=c(3,3))

anobj &lt;- + obj0
anobj &lt;- - obj0
anobj &lt;- 6 - obj0
anobj &lt;- 1 + obj0
anobj &lt;- obj0 - 3
anobj &lt;- z + obj0 
anobj &lt;- obj0 - z

obj1 &lt;- obj0 ^ 2
anobj &lt;- (0.3 * obj0) + (5.1 * obj1)

anobj &lt;- 2 ^ obj0
anobj &lt;- obj1 ^ obj0
anobj &lt;- obj1 / obj0
anobj &lt;- z / obj0

</code></pre>

<hr>
<h2 id='as'>Coerce madness to something else</h2><span id='topic+as'></span><span id='topic+as.array+2Cmadness-method'></span><span id='topic+as.array'></span><span id='topic+as.matrix+2Cmadness-method'></span><span id='topic+as.matrix'></span><span id='topic+as.numeric+2Cmadness-method'></span><span id='topic+as.numeric'></span>

<h3>Description</h3>

<p>Coerce as something else
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'madness'
as.array(x, ...)

## S4 method for signature 'madness'
as.matrix(x, ...)

## S4 method for signature 'madness'
as.numeric(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_+3A_x">x</code></td>
<td>
<p>a <code>madness</code> object</p>
</td></tr>
<tr><td><code id="as_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>

<hr>
<h2 id='as.madness'>Coerce to a madness object.</h2><span id='topic+as.madness'></span><span id='topic+as.madness.default'></span>

<h3>Description</h3>

<p>Convert model to a madness object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.madness(x, vtag=NULL, xtag=NULL)

## Default S3 method:
as.madness(x, vtag = NULL, xtag = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.madness_+3A_x">x</code></td>
<td>
<p>an object which can be fed to <code>coef</code>, and possibly <code>vcov</code></p>
</td></tr>
<tr><td><code id="as.madness_+3A_vtag">vtag</code></td>
<td>
<p>an optional name for the <code class="reqn">val</code> variable.</p>
</td></tr>
<tr><td><code id="as.madness_+3A_xtag">xtag</code></td>
<td>
<p>an optional name for the <code class="reqn">X</code> variable.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Attempts to stuff the coefficients and variance-covariance matrix of a model
into a madness object.
</p>


<h3>Value</h3>

<p>A madness object.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xy &lt;- data.frame(x=rnorm(100),y=runif(100),z=runif(100))
amod &lt;- lm(z ~ x + y,xy)
amad &lt;- as.madness(amod)
</code></pre>

<hr>
<h2 id='bind'>Row and Column Bind</h2><span id='topic+bind'></span><span id='topic+c.madness'></span><span id='topic+cbind2+2Cmadness+2Cmissing-method'></span><span id='topic+cbind2+2Cmadness+2Cmadness-method'></span><span id='topic+cbind2+2Cmadness+2CANY-method'></span><span id='topic+cbind2+2CANY+2Cmadness-method'></span><span id='topic+rbind2+2Cmadness+2Cmissing-method'></span><span id='topic+rbind2+2Cmadness+2Cmadness-method'></span><span id='topic+rbind2+2Cmadness+2CANY-method'></span><span id='topic+rbind2+2CANY+2Cmadness-method'></span>

<h3>Description</h3>

<p>Row and Column Bind
</p>


<h3>Usage</h3>

<pre><code class='language-R'>\method{c}{madness}(...)

## S4 method for signature 'madness,missing'
cbind2(x, y, ...)

## S4 method for signature 'madness,madness'
cbind2(x, y, ...)

## S4 method for signature 'madness,ANY'
cbind2(x, y, ...)

## S4 method for signature 'ANY,madness'
cbind2(x, y, ...)

## S4 method for signature 'madness,missing'
rbind2(x, y, ...)

## S4 method for signature 'madness,madness'
rbind2(x, y, ...)

## S4 method for signature 'madness,ANY'
rbind2(x, y, ...)

## S4 method for signature 'ANY,madness'
rbind2(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bind_+3A_...">...</code></td>
<td>
<p>optional arguments for methods (ignored here).</p>
</td></tr>
<tr><td><code id="bind_+3A_x">x</code>, <code id="bind_+3A_y">y</code></td>
<td>
<p><code>madness</code> or array, numeric, matrix objects.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>

<hr>
<h2 id='blockrep'>Replicate blocks of multidimensional value.</h2><span id='topic+blockrep'></span><span id='topic+repto'></span>

<h3>Description</h3>

<p>Replicates a multidimensional object a number of times along
given dimensions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blockrep(x, nreps)

repto(x, newdim)

repto(x, newdim)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="blockrep_+3A_x">x</code></td>
<td>
<p>a <code>madness</code> object, representing a k-dimensional object.</p>
</td></tr>
<tr><td><code id="blockrep_+3A_nreps">nreps</code></td>
<td>
<p>an l-vector of positive integers, representing how
many times to copy the object.</p>
</td></tr>
<tr><td><code id="blockrep_+3A_newdim">newdim</code></td>
<td>
<p>an l-vector of positive integers of the new dimension
of the output object. These must be integer multiples of the 
input dimensions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a k-dimensional object, and an l-vector of positive
integers, for l &gt;= k, copy the input object l_i times in
the ith dimension. Useful for replication and (slow, fake)
outer products.
</p>
<p><code>repto</code> replicates to the given dimension, assuming the
given dimension are integer multiples of the input dimensions.
</p>


<h3>Value</h3>

<p>A <code>madness</code> object replicated out.
</p>


<h3>Note</h3>

<p>An error will be thrown if <code>nreps</code> or <code>newdim</code> are improper.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
y &lt;- array(rnorm(3*3),dim=c(3,3))
dy &lt;- matrix(rnorm(length(y)*2),ncol=2)
dx &lt;- crossprod(matrix(rnorm(ncol(dy)*100),nrow=100))
obj0 &lt;- madness(val=y,vtag='y',xtag='x',dvdx=dy,varx=dx)

anobj &lt;- blockrep(obj0,c(1,2,1))
anobj &lt;- blockrep(obj0,c(1,1,2))
anobj &lt;- repto(obj0,c(9,12,4))
</code></pre>

<hr>
<h2 id='colsums'>Form Row and Column Sums and Means</h2><span id='topic+colsums'></span><span id='topic+colSums'></span><span id='topic+colSums+2Cmadness-method'></span><span id='topic+colMeans+2Cmadness-method'></span><span id='topic+colMeans'></span><span id='topic+rowSums+2Cmadness-method'></span><span id='topic+rowSums'></span><span id='topic+rowMeans+2Cmadness-method'></span><span id='topic+rowMeans'></span>

<h3>Description</h3>

<p>Form Row and Column Sums and Means for <code>madness</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'madness'
colSums(x, na.rm = FALSE, dims = 1)

## S4 method for signature 'madness'
colMeans(x, na.rm = FALSE, dims = 1)

## S4 method for signature 'madness'
rowSums(x, na.rm = FALSE, dims = 1)

## S4 method for signature 'madness'
rowMeans(x, na.rm = FALSE, dims = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="colsums_+3A_x">x</code></td>
<td>
<p><code>madness</code> object.</p>
</td></tr>
<tr><td><code id="colsums_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.  Should missing values (including <code>NaN</code>)
be omitted from the calculations?</p>
</td></tr>
<tr><td><code id="colsums_+3A_dims">dims</code></td>
<td>
<p>integer: Which dimensions are regarded as &lsquo;rows&rsquo; or
&lsquo;columns&rsquo; to sum over.  For <code>row*</code>, the sum or mean is
over dimensions <code>dims+1, ...</code>; for <code>col*</code> it is over
dimensions <code>1:dims</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>madness</code> object. Note that the sums are flattened to a
column vector.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>

<hr>
<h2 id='det'>Matrix Determinant</h2><span id='topic+det'></span><span id='topic+determinant.madness'></span><span id='topic+determinant+2Cmadness+2CANY-method'></span><span id='topic+determinant'></span><span id='topic+determinant+2Cmadness+2Cmissing-method'></span><span id='topic+determinant+2Cmadness+2Clogical-method'></span>

<h3>Description</h3>

<p>Compute the determinant of a matrix. As for <code>base::determinant</code>,
a list of the modulus and sign are returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'madness'
determinant(x, logarithm = TRUE, ...)

det(x, ...)

## S4 method for signature 'madness,ANY'
determinant(x, logarithm = TRUE, ...)

## S4 method for signature 'madness,missing'
determinant(x, logarithm = TRUE, ...)

## S4 method for signature 'madness,logical'
determinant(x, logarithm = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="det_+3A_x">x</code></td>
<td>
<p><code>madness</code> object.</p>
</td></tr>
<tr><td><code id="det_+3A_logarithm">logarithm</code></td>
<td>
<p>logical; if <code>TRUE</code> (default) return the
logarithm of the modulus of the determinant.</p>
</td></tr>
<tr><td><code id="det_+3A_...">...</code></td>
<td>
<p>Optional arguments.  At present none are used.  Previous
versions of <code>det</code> allowed an optional <code>method</code> argument.
This argument will be ignored but will not produce an error.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with elements <code>modulus</code> and <code>sign</code>, 
which are <code>madness</code> objects.
</p>


<h3>Note</h3>

<p>throws an error for non-square matrices or non-matrix input.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>

<hr>
<h2 id='eigen'>Spectral Decomposition of a Matrix</h2><span id='topic+eigen'></span><span id='topic+eigen+2Cmadness-method'></span>

<h3>Description</h3>

<p>Computes eigenvalues and eigenvectors of numeric (double, integer, logical) or 
complex <code>madness</code> matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'madness'
eigen(x, symmetric, only.values = FALSE, EISPACK = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eigen_+3A_x">x</code></td>
<td>
<p><code>madness</code> object representing a numeric matrix
whose spectral decomposition is to be computed.</p>
</td></tr>
<tr><td><code id="eigen_+3A_symmetric">symmetric</code></td>
<td>
<p>if <code>TRUE</code>, the matrix is assumed to be symmetric
(or Hermitian if complex) and only its lower triangle (diagonal
included) is used.  If <code>symmetric</code> is not specified,
<code><a href="base.html#topic+isSymmetric">isSymmetric</a>(x)</code> is used.</p>
</td></tr>
<tr><td><code id="eigen_+3A_only.values">only.values</code></td>
<td>
<p>if <code>TRUE</code>, only the eigenvalues are computed
and returned, otherwise both eigenvalues and eigenvectors are
returned.</p>
</td></tr>
<tr><td><code id="eigen_+3A_eispack">EISPACK</code></td>
<td>
<p>logical. Defunct and ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The singular value decomposition of the matrix <code class="reqn">X</code> is
</p>
<p style="text-align: center;"><code class="reqn">X = U D V',</code>
</p>

<p>where <code class="reqn">U</code> and <code class="reqn">V</code> are orthogonal, <code class="reqn">V'</code> is <code class="reqn">V</code>
transposed, and <code class="reqn">D</code> is a diagonal matrix with the singular
values on the diagonal.
</p>


<h3>Value</h3>

<p>a list with components
</p>

<dl>
<dt>values</dt><dd><p>a <code>madness</code> object of a vector containing
the <code class="reqn">p</code> eigenvalues of <code>x</code>, sorted in <em>decreasing</em> order,
according to <code>Mod(value)</code> in the assymetric case when they might
be complex (even for real matrices). For real asymmetric matrices
the vector will be complex only if complex conjugate pairs of eigenvalues are 
detected.</p>
</dd>
<dt>vectors</dt><dd><p>either a <code class="reqn">p \times p</code> matrix whose columns contain the
eigenvectors of <code>x</code> or <code>NULL</code> if <code>only.values</code> is 
<code>TRUE</code>. The vectors are normalized to unit length.
</p>
<p>Recall that the eigenvectors are only defined up to a constant: 
even when the length is specified they are still only defined up to a 
scalar of modulus one (the sign for real matrices).  
If <code>r &lt;- eigen(A)</code>, and <code>V &lt;- r$vectors; lam &lt;- r$values</code>, then
</p>
<p style="text-align: center;"><code class="reqn">A = V Lmbd V^{-1}</code>
</p>

<p>(up to numerical fuzz), where <code>Lmbd =diag(lam)</code>.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>Izenman, Alan Julian. &quot;Reduced-Rank Regression for the Multivariate Linear
Model.&quot; Journal of Multivariate Analysis 5, pp 248-264 (1975).
<a href="https://www.sciencedirect.com/science/article/pii/0047259X75900421">https://www.sciencedirect.com/science/article/pii/0047259X75900421</a>
</p>
<p>Kato, Tosio. &quot;Perturbation Theory for Linear Operators.&quot;
Springer (1995).
<a href="https://www.maths.ed.ac.uk/~v1ranick/papers/kato1.pdf">https://www.maths.ed.ac.uk/~v1ranick/papers/kato1.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eigen">eigen</a></code>.
</p>

<hr>
<h2 id='elwise'>Element-wise Multivariate Operations</h2><span id='topic+elwise'></span><span id='topic+abs+2Cmadness-method'></span><span id='topic+exp+2Cmadness-method'></span><span id='topic+log+2Cmadness-method'></span><span id='topic+log10+2Cmadness-method'></span><span id='topic+sqrt+2Cmadness-method'></span><span id='topic+sin+2Cmadness-method'></span><span id='topic+cos+2Cmadness-method'></span><span id='topic+tan+2Cmadness-method'></span>

<h3>Description</h3>

<p>Element-wise multivariate operations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'madness'
abs(x)

## S4 method for signature 'madness'
exp(x)

## S4 method for signature 'madness'
log(x)

## S4 method for signature 'madness'
log10(x)

## S4 method for signature 'madness'
sqrt(x)

## S4 method for signature 'madness'
sin(x)

## S4 method for signature 'madness'
cos(x)

## S4 method for signature 'madness'
tan(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="elwise_+3A_x">x</code></td>
<td>
<p><code>madness</code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These operations are scalar-to-scalar operations applied to each element of a 
multidimensional array.
</p>


<h3>Note</h3>

<p>The <code>exp</code>, <code>log</code>, and <code>sqrt</code>
functions are not to be confused with the matrix-wise operations,
<code>expm</code>, <code>logm</code> and <code>sqrtm</code>
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+matwise">matwise</a>
</p>

<hr>
<h2 id='madness-class'>Madness Class.</h2><span id='topic+madness-class'></span><span id='topic+initialize+2Cmadness-method'></span><span id='topic+initialize+2Cmadness-class'></span><span id='topic+madness'></span>

<h3>Description</h3>

<p>An S4 class to enable forward differentiation of multivariate computations.
Think of &lsquo;madness&rsquo; as &lsquo;multivariate automatic differentiation -ness.&rsquo;
There is also a constructor method for <code>madness</code> objects, and a 
wrapper method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'madness'
initialize(
  .Object,
  val,
  dvdx,
  xtag = NA_character_,
  vtag = NA_character_,
  varx = matrix(nrow = 0, ncol = 0)
)

madness(val, dvdx = NULL, vtag = NULL, xtag = NULL, varx = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="madness-class_+3A_.object">.Object</code></td>
<td>
<p>a <code>madness</code> object, or proto-object.</p>
</td></tr>
<tr><td><code id="madness-class_+3A_val">val</code></td>
<td>
<p>an <code>array</code> of some numeric value, of arbitrary
dimension.</p>
</td></tr>
<tr><td><code id="madness-class_+3A_dvdx">dvdx</code></td>
<td>
<p>a <code>matrix</code> of the derivative of 
(the vector of) <code>val</code> with respect to some independent 
variable, <code class="reqn">X</code>.</p>
</td></tr>
<tr><td><code id="madness-class_+3A_xtag">xtag</code></td>
<td>
<p>an optional name for the <code class="reqn">X</code> variable.</p>
</td></tr>
<tr><td><code id="madness-class_+3A_vtag">vtag</code></td>
<td>
<p>an optional name for the <code class="reqn">val</code> variable.</p>
</td></tr>
<tr><td><code id="madness-class_+3A_varx">varx</code></td>
<td>
<p>an optional variance-covariance matrix of
the independent variable, <code class="reqn">X</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A <code>madness</code> object contains a (multidimensional) 
value, and the derivative of that with respect to some independent
variable. The purpose is to simplify computation of multivariate 
derivatives, especially for use in the Delta method. Towards this
usage, one may store the covariance of the independent variable
in the object as well, from which the approximate variance-covariance
matrix can easily be computed. See <code><a href="stats.html#topic+vcov">vcov</a></code>.
</p>
<p>Note that derivatives are all implicitly 'flattened'. That is,
when we talk of the derivative of <code class="reqn">i \times j</code> 
matrix <code class="reqn">Y</code> with respect to <code class="reqn">m \times n</code>
matrix <code class="reqn">X</code>, we mean the derivative of the <code class="reqn">ij</code>
vector <code class="reqn">\mathrm{vec}\left(Y\right)</code> with
respect to the <code class="reqn">mn</code> vector
<code class="reqn">\mathrm{vec}\left(X\right)</code>. Moreover,
derivatives follow the 'numerator layout' convention: 
this derivative is a <code class="reqn">ij \times mn</code> matrix
whose first column is the derivative of 
<code class="reqn">\mathrm{vec}\left(Y\right)</code> with respect
to <code class="reqn">X_{1,1}</code>. Numerator layout feels unnatural
because it makes a gradient vector of a scalar-valued function
into a row vector. Despite this deficiency, it makes 
the product rule feel more natural. (2FIX: is this so?)
</p>


<h3>Value</h3>

<p>An object of class <code>madness</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>val</code></dt><dd><p>an <code>array</code> of some numeric value. (Note that
<code>array</code> includes <code>matrix</code> as a subclass.) The numeric
value can have arbitrary dimension.</p>
</dd>
<dt><code>dvdx</code></dt><dd><p>a <code>matrix</code> of the derivative of 
(the vector of) <code>val</code> with respect to some independent 
variable, <code class="reqn">X</code>. 
A Derivative is indeed a 2-dimensional matrix.
Derivatives have all been 'flattened'. See the details. 
If not given, defaults
to the identity matrix, in which case <code class="reqn">val=X</code>,
which is useful to initialization. Note that the derivative
is with respect to an 'unrestricted' <code class="reqn">X</code>.</p>
</dd>
<dt><code>xtag</code></dt><dd><p>an optional name for the <code class="reqn">X</code> variable. 
Operations between two objects of the class with distinct
<code>xtag</code> data will result in an error, since they are 
considered to have different independent variables.</p>
</dd>
<dt><code>vtag</code></dt><dd><p>an optional name for the <code class="reqn">val</code> variable. 
This will be propagated forward.</p>
</dd>
<dt><code>varx</code></dt><dd><p>an optional variance-covariance matrix of
the independent variable, <code class="reqn">X</code>.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>Petersen, Kaare Brandt and Pedersen, Michael Syskind. &quot;The Matrix Cookbook.&quot;
Technical University of Denmark (2012). 
<a href="http://www2.imm.dtu.dk/pubdb/pubs/3274-full.html">http://www2.imm.dtu.dk/pubdb/pubs/3274-full.html</a>
</p>
<p>Magnus, Jan R. and Neudecker, H. &quot;Matrix Differential Calculus with Applications in Statistics and Econometrics.&quot;
3rd Edition. Wiley Series in Probability and Statistics: Texts and References Section (2007).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>obj &lt;- new("madness", val=matrix(rnorm(10*10),nrow=10), dvdx=diag(100), xtag="foo", vtag="foo")
obj2 &lt;- madness(val=matrix(rnorm(10*10),nrow=10), xtag="foo", vtag="foo^2")

</code></pre>

<hr>
<h2 id='madness-NEWS'>News for package &lsquo;madness&rsquo;:</h2><span id='topic+madness-NEWS'></span>

<h3>Description</h3>

<p>News for package &lsquo;madness&rsquo;.
</p>





<h3><a href="https://cran.r-project.org/package=madness">madness</a> Version 0.2.8 (2023-08-20) </h3>


<ul>
<li><p> emergency CRAN release to fix package documentation.
</p>
</li></ul>



<h3><a href="https://cran.r-project.org/package=madness">madness</a> Version 0.2.7 (2020-02-07) </h3>


<ul>
<li><p> emergency CRAN release to deal with ellipsis in documentation.
</p>
</li></ul>



<h3><a href="https://cran.r-project.org/package=madness">madness</a> Version 0.2.6 (2019-04-19) </h3>


<ul>
<li><p> emergency CRAN release to deal with change in generic
signature for <code>colSums</code>, <code>colMeans</code>,
<code>rowSums</code>, <code>rowMeans</code>.
</p>
</li></ul>



<h3><a href="https://cran.r-project.org/package=madness">madness</a> Version 0.2.5 (2018-08-27) </h3>


<ul>
<li><p> emergency CRAN release to deal with failing vignette on alternative
BLAS.
</p>
</li></ul>



<h3><a href="https://cran.r-project.org/package=madness">madness</a> Version 0.2.4 (2018-08-26) </h3>


<ul>
<li><p> adding to unit tests.
</p>
</li>
<li><p> fix scalar to array promotion.
</p>
</li>
<li><p> fix broken vtag in aperm.
</p>
</li>
<li><p> add FF3 and stock returns data to build vignette.
</p>
</li></ul>



<h3><a href="https://cran.r-project.org/package=madness">madness</a> Version 0.2.3 (2018-02-14) </h3>


<ul>
<li><p> emergency CRAN release to deal with failing tests
under alternative BLAS/LAPACK libraries.
</p>
</li></ul>



<h3><a href="https://cran.r-project.org/package=madness">madness</a> Version 0.2.2 (2017-04-26) </h3>


<ul>
<li><p> emergency CRAN release for upstream changes to <code>diag</code>.
thanks to Martin Maechler for the patch.
</p>
</li></ul>



<h3><a href="https://cran.r-project.org/package=madness">madness</a> Version 0.2.1 (2017-04-13) </h3>


<ul>
<li><p> emergency CRAN release for failed build.
</p>
</li>
<li><p> no new functionality.
</p>
</li></ul>



<h3><a href="https://cran.r-project.org/package=madness">madness</a> Version 0.2.0 (2016-01-19) </h3>


<ul>
<li><p> add static vignette.
</p>
</li>
<li><p> modify <code>twomoments</code>.
</p>
</li>
<li><p> release to CRAN.
</p>
</li></ul>



<h3><a href="https://cran.r-project.org/package=madness">madness</a> Version 0.1.0.400 (2016-01-12) </h3>


<ul>
<li><p> adding <code>max</code> and <code>min</code>.
</p>
</li></ul>



<h3><a href="https://cran.r-project.org/package=madness">madness</a> Version 0.1.0.300 (2016-01-10) </h3>


<ul>
<li><p> adding <code>eigen</code>.
</p>
</li></ul>



<h3><a href="https://cran.r-project.org/package=madness">madness</a> Version 0.1.0.200 (2016-01-07) </h3>


<ul>
<li><p> exporting <code>diag</code>.
</p>
</li></ul>



<h3><a href="https://cran.r-project.org/package=madness">madness</a> Version 0.1.0 (2015-12-15) </h3>


<ul>
<li><p> first CRAN release.
</p>
</li></ul>



<h3><a href="https://cran.r-project.org/package=madness">madness</a> Initial Version 0.0.0.5000 (2015-12-01) </h3>


<ul>
<li><p> first github release.
</p>
</li></ul>


<hr>
<h2 id='marithops'>Basic Matrix Arithmetic Operations.</h2><span id='topic+marithops'></span><span id='topic++25+2A+25+2Cmadness+2Cmadness-method'></span><span id='topic++60+25+2A+25+60+2Cmadness+2Cmadness-class'></span><span id='topic++25+2A+25+2Cmadness+2Carray-method'></span><span id='topic++25+2A+25+2Cmadness+2Carray-class'></span><span id='topic++25+2A+25+2Carray+2Cmadness-method'></span><span id='topic++25+2A+25+2Carray+2Cmadness-class'></span><span id='topic+crossprod+2Cmadness+2Cmadness-method'></span><span id='topic+crossprod'></span><span id='topic+crossprod+2Cmadness+2CANY-method'></span><span id='topic+crossprod+2Cmadness+2Cmissing-method'></span><span id='topic+crossprod+2CANY+2Cmadness-method'></span><span id='topic+tcrossprod+2Cmadness+2Cmadness-method'></span><span id='topic+tcrossprod'></span><span id='topic+tcrossprod+2Cmadness+2CANY-method'></span><span id='topic+tcrossprod+2Cmadness+2Cmissing-method'></span><span id='topic+tcrossprod+2CANY+2Cmadness-method'></span>

<h3>Description</h3>

<p>These perform basic matrix arithmetic on <code>madness</code> objects: matrix
multiplication, cross product, Kronecker product.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'madness,madness'
x %*% y

## S4 method for signature 'madness,array'
x %*% y

## S4 method for signature 'array,madness'
x %*% y

## S4 method for signature 'madness,madness'
crossprod(x, y)

## S4 method for signature 'madness,ANY'
crossprod(x, y)

## S4 method for signature 'madness,missing'
crossprod(x, y)

## S4 method for signature 'ANY,madness'
crossprod(x, y)

## S4 method for signature 'madness,madness'
tcrossprod(x, y)

## S4 method for signature 'madness,ANY'
tcrossprod(x, y)

## S4 method for signature 'madness,missing'
tcrossprod(x, y)

## S4 method for signature 'ANY,madness'
tcrossprod(x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="marithops_+3A_x">x</code>, <code id="marithops_+3A_y">y</code></td>
<td>
<p><code>madness</code> or numeric matrix values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
y &lt;- array(rnorm(3*3),dim=c(3,3))
dy &lt;- matrix(rnorm(length(y)*2),ncol=2)
dx &lt;- crossprod(matrix(rnorm(ncol(dy)*100),nrow=100))
obj0 &lt;- madness(val=y,vtag='y',xtag='x',dvdx=dy,varx=dx)
z &lt;- array(rnorm(3*3),dim=c(3,3))

anobj &lt;- obj0 %*% obj0
anobj &lt;- z %*% obj0
anobj &lt;- crossprod(obj0)
anobj &lt;- crossprod(obj0,z)
anobj &lt;- tcrossprod(obj0,obj0)
# NYI: 
# anobj &lt;- obj0 %x% obj0

</code></pre>

<hr>
<h2 id='matrix.trace'>Matrix Trace</h2><span id='topic+matrix.trace'></span><span id='topic+matrix.trace+2CANY-method'></span><span id='topic+matrix.trace+2Cmadness-method'></span>

<h3>Description</h3>

<p>Matrix Trace
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrix.trace(x)

## S4 method for signature 'ANY'
matrix.trace(x)

## S4 method for signature 'madness'
matrix.trace(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="matrix.trace_+3A_x">x</code></td>
<td>
<p><code>madness</code> object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>

<hr>
<h2 id='matwise'>Matrix-wise Multivariate Operations</h2><span id='topic+matwise'></span><span id='topic+sqrtm'></span><span id='topic+sqrtm+2Cmadness-method'></span><span id='topic+chol.madness'></span><span id='topic+chol'></span>

<h3>Description</h3>

<p>Element-wise multivariate operations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'madness'
sqrtm(x)

## S3 method for class 'madness'
chol(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="matwise_+3A_x">x</code></td>
<td>
<p><code>madness</code> object.</p>
</td></tr>
<tr><td><code id="matwise_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These operations are operations on matrices: compute the symmetric square root
or the Cholesky factor. In the future, the matrix exponent and logarithm may
be implemented?
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>

<hr>
<h2 id='max'>Maxima and Minima</h2><span id='topic+max'></span><span id='topic+max+2Cmadness-method'></span><span id='topic+max+2Cmadness-class'></span><span id='topic+min+2Cmadness-method'></span><span id='topic+min'></span><span id='topic+min+2Cmadness-class'></span>

<h3>Description</h3>

<p>Return the maxima and minima of the input values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'madness'
max(x, ..., na.rm = FALSE)

## S4 method for signature 'madness'
min(x, ..., na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="max_+3A_x">x</code></td>
<td>
<p><code>madness</code> object arguments.</p>
</td></tr>
<tr><td><code id="max_+3A_...">...</code></td>
<td>
<p><code>madness</code> object arguments.</p>
</td></tr>
<tr><td><code id="max_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical indicating whether missing values should be
removed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>max</code> and <code>min</code> return the maximum or minimum of <em>all</em> the
values present in their arguments.
</p>
<p>If <code>na.rm</code> is <code>FALSE</code> and <code>NA</code> value in any of the arguments
will cause a value of <code>NA</code> to be returned, otherwise <code>NA</code> values are
ignored.
</p>
<p>The minimum and maximum of a numeric empty set are <code>+Inf</code> and 
<code>-Inf</code> (in this order!) which ensures <em>transitivity</em>, e.g.,
<code>min(x1, min(x2)) == min(x1, x2)</code>.  For numeric <code>x</code> 
<code>max(x) == -Inf</code> and <code>min(x) == +Inf</code> whenever 
<code>length(x) == 0</code> (after removing missing values if requested).
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>

<hr>
<h2 id='norm'>Matrix and vector norms.</h2><span id='topic+norm'></span><span id='topic+maxeig'></span><span id='topic+maxeig+2Cmadness-method'></span><span id='topic+norm+2Cmadness-method'></span><span id='topic+norm+2Cmadness+2Cmissing-method'></span><span id='topic+norm+2Cmadness+2CANY-method'></span>

<h3>Description</h3>

<p>Compute the norm of a vector or matrix, as determined by the
<code>type</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maxeig(x)

## S4 method for signature 'madness'
maxeig(x)

## S4 method for signature 'madness,missing'
norm(x)

## S4 method for signature 'madness,ANY'
norm(x, type = "One")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="norm_+3A_x">x</code></td>
<td>
<p><code>madness</code> object.</p>
</td></tr>
<tr><td><code id="norm_+3A_type">type</code></td>
<td>
<p>character string, specifying the <em>type</em> of matrix
norm to be computed.
A character indicating the type of norm desired.
</p>

<dl>
<dt><code>"O"</code>, <code>"o"</code> or <code>"1"</code></dt><dd><p>specifies the <b>o</b>ne norm,
(maximum absolute column sum);</p>
</dd>
<dt><code>"I"</code> or <code>"i"</code></dt><dd><p>specifies the <b>i</b>nfinity norm (maximum
absolute row sum);</p>
</dd>
<dt><code>"F"</code> or <code>"f"</code></dt><dd><p>specifies the <b>F</b>robenius norm (the
Euclidean norm of <code>x</code> treated as if it were a vector);</p>
</dd>
<dt><code>"M"</code> or <code>"m"</code></dt><dd><p>specifies the <b>m</b>aximum modulus of
all the elements in <code>x</code>; and</p>
</dd>
<dt><code>"2"</code></dt><dd><p>specifies the &ldquo;spectral&rdquo; or 2-norm, which
is the largest singular value (<code><a href="base.html#topic+svd">svd</a></code>) of <code>x</code>.</p>
</dd>
</dl>

<p>The default is <code>"O"</code>.  Only the first character of
<code>type[1]</code> is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the matrix norm, a non-negative number.
</p>


<h3>Note</h3>

<p>This should probably be fixed to return a scalar, not a 1 by 1 matrix?
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>

<hr>
<h2 id='numderiv'>Numerical (approximate) Differentiation.</h2><span id='topic+numderiv'></span><span id='topic+numderiv+2CANY+2Carray-method'></span><span id='topic+ANY+2Carray-method'></span><span id='topic+numderiv+2CANY+2Cmadness-method'></span><span id='topic+ANY+2Cmadness-method'></span>

<h3>Description</h3>

<p>Approximates the derivative of a function at the input
by numerical methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>numderiv(f, x, eps=1e-8, type=c('forward','central','backward'),...)

## S4 method for signature 'ANY,array'
numderiv(f, x, eps = 1e-08, type = c("forward", "central", "backward"), ...)

## S4 method for signature 'ANY,madness'
numderiv(f, x, eps = 1e-08, type = c("forward", "central", "backward"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="numderiv_+3A_f">f</code></td>
<td>
<p>a function, to be evaluated at and near <code>x</code>.</p>
</td></tr>
<tr><td><code id="numderiv_+3A_x">x</code></td>
<td>
<p>array, matrix, or <code>madness</code> object.</p>
</td></tr>
<tr><td><code id="numderiv_+3A_eps">eps</code></td>
<td>
<p>the 'epsilon', a small value added or subtracted from <code>x</code> to
compute the first differences.</p>
</td></tr>
<tr><td><code id="numderiv_+3A_type">type</code></td>
<td>
<p>the type of first difference, case-insensitive, substrings ok.</p>
</td></tr>
<tr><td><code id="numderiv_+3A_...">...</code></td>
<td>
<p>arguments passed on to <code>f</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a multivariate-valued function of multivariate
data, approximates the derivative at a point via the
forward, central, or backward first differences, 
returning a <code>madness</code> object.
</p>


<h3>Value</h3>

<p>A matrix if <code>x</code> is numeric; a <code>madness</code> object if
<code>x</code> is a <code>madness</code> object.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- function(x,h) {
  cos(x + h)
}
x &lt;- array(rnorm(100),dim=c(10,10))
madx &lt;- numderiv(f,x,1e-8,h=pi)
</code></pre>

<hr>
<h2 id='outer'>Outer product.</h2><span id='topic+outer'></span><span id='topic+outer+2CANY+2CANY-method'></span><span id='topic+outer+2Cmadness+2Cmadness-method'></span><span id='topic+outer+2Cmadness+2Carray-method'></span><span id='topic+outer+2Carray+2Cmadness-method'></span><span id='topic++25o+25'></span><span id='topic+kronecker+2Cmadness+2Cmadness-method'></span><span id='topic+kronecker+2Cmadness+2Cmadness-class'></span><span id='topic+kronecker+2Cmadness+2Carray-method'></span><span id='topic+kronecker+2Cmadness+2Carray-class'></span><span id='topic+kronecker+2Carray+2Cmadness-method'></span><span id='topic+kronecker+2Carray+2Cmadness-class'></span>

<h3>Description</h3>

<p>Computes the outer product (or sum, quotient, etc) of the Cartesian
product of two inputs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ANY,ANY'
outer(X, Y, FUN = "*", ...)

## S4 method for signature 'madness,madness'
outer(X, Y, FUN = "*", ...)

## S4 method for signature 'madness,array'
outer(X, Y, FUN = "*", ...)

## S4 method for signature 'array,madness'
outer(X, Y, FUN = "*", ...)

X %o% Y

## S4 method for signature 'madness,madness'
kronecker(X, Y)

## S4 method for signature 'madness,array'
kronecker(X, Y)

## S4 method for signature 'array,madness'
kronecker(X, Y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="outer_+3A_x">X</code>, <code id="outer_+3A_y">Y</code></td>
<td>
<p><code>madness</code> or numeric matrix values.</p>
</td></tr>
<tr><td><code id="outer_+3A_fun">FUN</code></td>
<td>
<p>a function to use on the outer products, found <em>via</em>
<code><a href="base.html#topic+match.fun">match.fun</a></code> (except for the special case <code>"*"</code>).</p>
</td></tr>
<tr><td><code id="outer_+3A_...">...</code></td>
<td>
<p>optional arguments to be passed to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>madness</code> object.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
y &lt;- array(rnorm(3*3),dim=c(3,3))
dy &lt;- matrix(rnorm(length(y)*2),ncol=2)
dx &lt;- crossprod(matrix(rnorm(ncol(dy)*100),nrow=100))
obj0 &lt;- madness(val=y,vtag='y',xtag='x',dvdx=dy,varx=dx)

y1 &lt;- array(rnorm(3*3),dim=c(3,3))
dy1 &lt;- matrix(rnorm(length(y1)*2),ncol=2)
dx1 &lt;- crossprod(matrix(rnorm(ncol(dy1)*100),nrow=100))
obj1 &lt;- madness(val=y1,vtag='y1',xtag='x',dvdx=dy1,varx=dx1)

anobj &lt;- outer(obj0,obj0,'*')
anobj &lt;- outer(obj0,obj0,'+')
anobj &lt;- outer(obj0,obj1,'-')
anobj &lt;- outer(obj0,obj1,'/')

</code></pre>

<hr>
<h2 id='reshapes'>Basic Reshape Operations</h2><span id='topic+reshapes'></span><span id='topic+t+2Cmadness-method'></span><span id='topic+t'></span><span id='topic+tril+2Cmadness-method'></span><span id='topic+tril'></span><span id='topic+triu+2Cmadness-method'></span><span id='topic+triu'></span><span id='topic+dim+3C-+2Cmadness-method'></span><span id='topic+dim+3C-+2Cmadness+2CANY-method'></span><span id='topic+aperm.madness'></span><span id='topic+aperm'></span>

<h3>Description</h3>

<p>Basic Reshape Operations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'madness'
t(x)

## S4 method for signature 'madness'
tril(x, k = 0)

## S4 method for signature 'madness'
triu(x, k = 0)

## S4 replacement method for signature 'madness'
dim(x) &lt;- value

## S3 method for class 'madness'
aperm(a, perm = NULL, resize = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reshapes_+3A_x">x</code></td>
<td>
<p><code>madness</code> object.</p>
</td></tr>
<tr><td><code id="reshapes_+3A_k">k</code></td>
<td>
<p>the index of the diagonal number from which to extract.<code>madness</code> object.</p>
</td></tr>
<tr><td><code id="reshapes_+3A_value">value</code></td>
<td>
<p>an array of the new dimensions of the object value.</p>
</td></tr>
<tr><td><code id="reshapes_+3A_a">a</code></td>
<td>
<p>the array to be transposed.</p>
</td></tr>
<tr><td><code id="reshapes_+3A_perm">perm</code></td>
<td>
<p>the subscript permutation vector, usually a permutation of
the integers <code>1:n</code>, where <code>n</code> is the number of dimensions
of <code>a</code>.  When <code>a</code> has named dimnames, it can be a
character vector of length <code>n</code> giving a permutation of those
names. The default (used whenever <code>perm</code> has zero length) is to
reverse the order of the dimensions.</p>
</td></tr>
<tr><td><code id="reshapes_+3A_resize">resize</code></td>
<td>
<p>a flag indicating whether the vector should be
resized as well as having its elements reordered (default <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="reshapes_+3A_...">...</code></td>
<td>
<p>Optional arguments used by specific methods. (None used at present.)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vec">vec</a></code>, <code><a href="#topic+todiag">todiag</a></code>
</p>

<hr>
<h2 id='setter'>Setter methods.</h2><span id='topic+setter'></span><span id='topic+xtag+3C-'></span><span id='topic+xtag+3C-+2Cmadness-method'></span><span id='topic+vtag+3C-'></span><span id='topic+vtag+3C-+2Cmadness-method'></span><span id='topic+varx+3C-'></span><span id='topic+varx+3C-+2Cmadness-method'></span>

<h3>Description</h3>

<p>Modify slot data of a <code>madness</code> object. Note that the value and the
derivative cannot easily be changed, as allowing this form of access would
likely result in badly computed derivatives.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xtag(x) &lt;- value

## S4 replacement method for signature 'madness'
xtag(x) &lt;- value

vtag(x) &lt;- value

## S4 replacement method for signature 'madness'
vtag(x) &lt;- value

varx(x) &lt;- value

## S4 replacement method for signature 'madness'
varx(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setter_+3A_x">x</code></td>
<td>
<p>a <code>madness</code> object.</p>
</td></tr>
<tr><td><code id="setter_+3A_value">value</code></td>
<td>
<p>the new value of the tag or derivative.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>

<hr>
<h2 id='show'>Show a madness object.</h2><span id='topic+show'></span><span id='topic+show+2Cmadness-method'></span>

<h3>Description</h3>

<p>Displays the madness object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show(object)

## S4 method for signature 'madness'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show_+3A_object">object</code></td>
<td>
<p>a <code>madness</code> object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>obj &lt;- madness(val=matrix(rnorm(10*10),nrow=10), xtag="foo", vtag="foo^2")
obj
</code></pre>

<hr>
<h2 id='solve'>Basic Matrix Inversion</h2><span id='topic+solve'></span><span id='topic+solve+2CANY+2Cmissing-method'></span><span id='topic+solve+2Cmadness+2Cmissing-method'></span><span id='topic+solve+2Cmadness+2Cmadness-method'></span><span id='topic+solve+2Cmadness+2Carray-method'></span><span id='topic+solve+2Cmadness+2CANY-method'></span><span id='topic+solve+2Carray+2Cmadness-method'></span><span id='topic+solve+2CANY+2Cmadness-method'></span>

<h3>Description</h3>

<p>Basic Matrix Inversion
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ANY,missing'
solve(a, b)

## S4 method for signature 'madness,missing'
solve(a, b)

## S4 method for signature 'madness,madness'
solve(a, b)

## S4 method for signature 'madness,array'
solve(a, b)

## S4 method for signature 'madness,ANY'
solve(a, b)

## S4 method for signature 'array,madness'
solve(a, b)

## S4 method for signature 'ANY,madness'
solve(a, b)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="solve_+3A_a">a</code>, <code id="solve_+3A_b">b</code></td>
<td>
<p><code>madness</code> object or matrix value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>

<hr>
<h2 id='stock_returns'>Stock Returns Data</h2><span id='topic+stock_returns'></span>

<h3>Description</h3>

<p>Historical weekly relative returns of common shares of IBM and AAPL, 
downloaded from Quandl.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(stock_returns)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> object with 1930 observations and 3 columns
The columns are defined as follows:
</p>

<dl>
<dt><code>Date</code></dt><dd><p>The closing date at which the return was observed, as a <code>Date</code> object.
These are Friday dates, ranging from January 1981 through December 2017.</p>
</dd>
<dt><code>AAPL</code></dt><dd><p>The simple returns of AAPL common shares, based on
weekly (adjusted) close prices.  A value of <code>0.01</code> corresponds to a one percent return.
Close prices are adjusted for splits and dividends by Quandl.</p>
</dd>
<dt><code>IBM</code></dt><dd><p>The simple returns of IBM common shares, based on
weekly (adjusted) close prices.  A value of <code>0.01</code> corresponds to a one percent return.
Close prices are adjusted for splits and dividends by Quandl.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>Source</h3>

<p>Data were collated from Quandl on August 25, 2018. This data is no longer
freely available from Quandl, but may be available directly from Nasdaq,
see:
<a href="https://www.nasdaq.com/market-activity/stocks/aapl/historical">https://www.nasdaq.com/market-activity/stocks/aapl/historical</a>
and 
<a href="https://www.nasdaq.com/market-activity/stocks/ibm/historical">https://www.nasdaq.com/market-activity/stocks/ibm/historical</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(stock_returns)
str(stock_returns)
</code></pre>

<hr>
<h2 id='sumprod'>Sum and Product.</h2><span id='topic+sumprod'></span><span id='topic+sum+2Cmadness-method'></span><span id='topic+sum'></span><span id='topic+sum+2Cmadness-class'></span><span id='topic+prod+2Cmadness-method'></span><span id='topic+prod'></span><span id='topic+prod+2Cmadness-class'></span>

<h3>Description</h3>

<p>Compute sum or product of <code>madness</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'madness'
sum(x, ..., na.rm = FALSE)

## S4 method for signature 'madness'
prod(x, ..., na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sumprod_+3A_x">x</code></td>
<td>
<p>a numeric or <code>madness</code> object.</p>
</td></tr>
<tr><td><code id="sumprod_+3A_...">...</code></td>
<td>
<p>ignored here.</p>
</td></tr>
<tr><td><code id="sumprod_+3A_na.rm">na.rm</code></td>
<td>
<p>logical. Should missing values (including &lsquo;NaN&rsquo;) be
removed?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>madness</code> object representing a scalar value.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xv &lt;- matrix(rnorm(5*5),ncol=5)
xmad &lt;- madness(xv)
prod(xv)
sum(xv)
</code></pre>

<hr>
<h2 id='theta'>Estimate the symmetric second moment array of values.</h2><span id='topic+theta'></span>

<h3>Description</h3>

<p>Given rows of observations of some vector (or multidimensional
data), estimates the second moment by taking a simple mean,
returning a <code>madness</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theta(X, vcov.func=vcov, xtag=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="theta_+3A_x">X</code></td>
<td>
<p>a multidimensional array (or a data frame) of observed values.</p>
</td></tr>
<tr><td><code id="theta_+3A_vcov.func">vcov.func</code></td>
<td>
<p>a function which takes an object of class <code>lm</code>,
and computes a variance-covariance matrix. If equal to the string
&quot;normal&quot;, we assume multivariate normal returns.</p>
</td></tr>
<tr><td><code id="theta_+3A_xtag">xtag</code></td>
<td>
<p>an optional string tag giving the name of the input data.
defaults to figuring it out from the input expression.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a 
<code class="reqn">n\times k_1 \times k_2 \times ... \times k_l</code>
array whose 'rows' are independent observations of <code class="reqn">X</code>, computes the 
<code class="reqn">k_1 \times k_2 \times ... \times k_l \times k_1 \times k_2 ... k_l</code>
array of the mean of <code class="reqn">\mathrm{outer}(X,X)</code> based on <code class="reqn">n</code> observations,
returned as a <code><a href="#topic+madness">madness</a></code> object. The variance-covariance
is also estimated, and stored in the object.
</p>
<p>One may use the default method for computing covariance,
via the <code><a href="stats.html#topic+vcov">vcov</a></code> function, or via a 'fancy' estimator,
like <code>sandwich:vcovHAC</code>, <code>sandwich:vcovHC</code>, <em>etc.</em>
</p>


<h3>Value</h3>

<p>A <code>madness</code> object representing the mean of the outer
product of the tail dimensions of <code>X</code>.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+twomoments">twomoments</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
X &lt;- matrix(rnorm(1000*3),ncol=3)
th &lt;- theta(X)

## Not run: 
if (require(sandwich)) {
 th2 &lt;- theta(X,vcov.func=vcovHC)
}

## End(Not run)
# works on data frames too:
set.seed(456)
X &lt;- data.frame(a=runif(100),b=rnorm(100),c=1)
th &lt;- theta(X)
</code></pre>

<hr>
<h2 id='to_objective'>Convert a madness object into an objective value with gradient</h2><span id='topic+to_objective'></span>

<h3>Description</h3>

<p>Given a <code>madness</code> object representing a scalar value, strip out
that value and attach an attribute of its derivative as a gradient.
This is a convenience method that simplifies construction of objective
functions for optimization routines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_objective(X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="to_objective_+3A_x">X</code></td>
<td>
<p>a <code>madness</code> object representing a scalar.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A scalar numeric with a <code>gradient</code> attribute of the derivative.
</p>


<h3>Note</h3>

<p>An error will be thrown if the value is not a scalar.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># an objective function for matrix factorization with penalty:
fitfun &lt;- function(R,L,Y,nu=-0.1) {
 dim(R) &lt;- c(length(R),1)
Rmad &lt;- madness(R)
dim(Rmad) &lt;- c(ncol(L),ncol(Y))
Err &lt;- Y - L %*% Rmad
penalty &lt;- sum(exp(nu * Rmad))
fit &lt;- norm(Err,'f') + penalty
to_objective(fit)
}
set.seed(1234)
L &lt;- array(runif(30*5),dim=c(30,5)) 
Y &lt;- array(runif(nrow(L)*20),dim=c(nrow(L),20))
R0 &lt;- array(runif(ncol(L)*ncol(Y)),dim=c(ncol(L),ncol(Y)))
obj0 &lt;- fitfun(R0,L,Y)
fooz &lt;- nlm(fitfun, R0, L, Y, iterlim=3)
</code></pre>

<hr>
<h2 id='todiag'>Diagonal Operations</h2><span id='topic+todiag'></span><span id='topic+diag+2Cmadness-method'></span><span id='topic+diag'></span><span id='topic+todiag+2Cmadness-method'></span>

<h3>Description</h3>

<p>Diagonal Operations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'madness'
diag(x)

todiag(x)

## S4 method for signature 'madness'
todiag(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="todiag_+3A_x">x</code></td>
<td>
<p><code>madness</code> object.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>the (somewhat odd) use of <code>stats::diag</code> for two different
functions is <em>not</em> repeated here, at least for now.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+reshapes">reshapes</a></code>
</p>

<hr>
<h2 id='twomoments'>Estimate the mean and covariance of values.</h2><span id='topic+twomoments'></span>

<h3>Description</h3>

<p>Given rows of observations of some vector (or multidimensional
data), estimates the mean and covariance of the values,
returning two <code>madness</code> objects. These have a common covariance
and 'xtag', so can be combined together.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twomoments(X, diag.only=FALSE, vcov.func=vcov, xtag=NULL, df=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="twomoments_+3A_x">X</code></td>
<td>
<p>a multidimensional array (or a data frame) of observed values.</p>
</td></tr>
<tr><td><code id="twomoments_+3A_diag.only">diag.only</code></td>
<td>
<p>logical flag, defaulting to <code>FALSE</code>. When
<code>TRUE</code>, only the diagonal of the covariance is computed, and
returned instead of the entire covariance. This should be used for
reasons of efficiency when only the marginal variances are needed.</p>
</td></tr>
<tr><td><code id="twomoments_+3A_vcov.func">vcov.func</code></td>
<td>
<p>a function which takes an object of class <code>lm</code>,
and computes a variance-covariance matrix. If equal to the string
&quot;normal&quot;, we assume multivariate normal returns.</p>
</td></tr>
<tr><td><code id="twomoments_+3A_xtag">xtag</code></td>
<td>
<p>an optional string tag giving the name of the input data.
defaults to figuring it out from the input expression.</p>
</td></tr>
<tr><td><code id="twomoments_+3A_df">df</code></td>
<td>
<p>the number of degrees of freedom to subtract
from the sample size in the denominator of the covariance
matrix estimate. The default value is the number of elements in
the mean, the so-called Bessel's correction.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a 
<code class="reqn">n\times k_1 \times k_2 \times ... \times k_l</code>
array whose 'rows' are independent observations of <code class="reqn">X</code>, computes the 
<code class="reqn">k_1 \times k_2 \times ... \times k_l</code>
array of the mean of <code class="reqn">X</code> and the 
<code class="reqn">k_1 \times k_2 \times ... \times k_l \times k_1 \times k_2 ... k_l</code>
array of the covariance, based on <code class="reqn">n</code> observations,
returned as two <code><a href="#topic+madness">madness</a></code> objects. The variance-covariance
of each is estimated. The two objects have the same 'xtag', and so
may be combined together.
When the <code>diag.only=TRUE</code>, only the diagonal of the covariance is
computed and returned.
</p>
<p>One may use the default method for computing covariance,
via the <code><a href="stats.html#topic+vcov">vcov</a></code> function, or via a 'fancy' estimator,
like <code>sandwich:vcovHAC</code>, <code>sandwich:vcovHC</code>, <em>etc.</em>
</p>


<h3>Value</h3>

<p>A two element list. When <code>diag.only=FALSE</code>, the first
element of the list is <code>mu</code>, representing the mean,
a <code>madness</code> object, the second is <code>Sigma</code>, representing the covariance,
also a <code>madness</code> object. When <code>diag.only=TRUE</code>, the first element
is <code>mu</code>, but the second is <code>sigmasq</code>, a <code>madness</code> object
representing the diagonal of the covariance matrix.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+theta">theta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
X &lt;- matrix(rnorm(1000*8),ncol=8)
alst &lt;- twomoments(X)
markowitz &lt;- solve(alst$Sigma,alst$mu)
vcov(markowitz)

# now compute the Sharpe ratios:
alst &lt;- twomoments(X,diag.only=TRUE,df=1)
srs &lt;- alst$mu / sqrt(alst$sigmasq)

</code></pre>

<hr>
<h2 id='vcov.madness'>Calculate Variance-Covariance Matrix for a model.</h2><span id='topic+vcov.madness'></span>

<h3>Description</h3>

<p>Returns the variance-covariance matrix of the parameters
computed by a <code>madness</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'madness'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov.madness_+3A_object">object</code></td>
<td>
<p>a <code>madness</code> object. A <code>varx</code> matrix must have
been set on the object, otherwise an error will be thrown.</p>
</td></tr>
<tr><td><code id="vcov.madness_+3A_...">...</code></td>
<td>
<p>additional arguments for method functions. Ignored here.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">X</code> represent some quantity which is estimated from
data. Let <code class="reqn">\Sigma</code> be the (known or estimated)
variance-covariance matrix of <code class="reqn">X</code>. If <code class="reqn">Y</code>
is some computed function of <code class="reqn">X</code>, then, by the 
Delta method (which is a first order Taylor approximation),
the variance-covariance matrix of <code class="reqn">Y</code> is approximately
</p>
<p style="text-align: center;"><code class="reqn">\frac{\mathrm{d}Y}{\mathrm{d}{X}} \Sigma \left(\frac{\mathrm{d}Y}{\mathrm{d}{X}}\right)^{\top},</code>
</p>

<p>where the derivatives are defined over the 'unrolled' (or vectorized)
<code class="reqn">Y</code> and <code class="reqn">X</code>. 
</p>
<p>Note that <code class="reqn">Y</code> can represent a multidimensional quantity. Its
variance covariance matrix, however, is two dimensional, as it too
is defined over the 'unrolled' <code class="reqn">Y</code>.
</p>


<h3>Value</h3>

<p>A matrix of the estimated covariances between the values being
estimated by the <code>madness</code> object. While <code class="reqn">Y</code> may be 
multidimensional, the return value is a square matrix whose side length
is the number of elements of <code class="reqn">Y</code>
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+vcov">vcov</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;- array(rnorm(2*3),dim=c(2,3))
dy &lt;- matrix(rnorm(length(y)*2),ncol=2)
dx &lt;- crossprod(matrix(rnorm(ncol(dy)*100),nrow=100))
obj &lt;- madness(val=y,dvdx=dy,varx=dx)
print(vcov(obj))

</code></pre>

<hr>
<h2 id='vec'>vectorize a multidimensional array.</h2><span id='topic+vec'></span><span id='topic+vec+2Cmadness-method'></span><span id='topic+vec+2Carray-method'></span><span id='topic+vech'></span><span id='topic+vech+2Carray-method'></span><span id='topic+vech+2Cmadness-method'></span><span id='topic+ivech'></span><span id='topic+ivech+2CANY-method'></span><span id='topic+ivech+2Cmadness-method'></span>

<h3>Description</h3>

<p>Turn a multidimensional array into a (column) vector. 
Turn a (typically symmetric) matrix into a (column) vector of
the lower triangular part. Or reverse these
operations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vec(x)

## S4 method for signature 'madness'
vec(x)

## S4 method for signature 'array'
vec(x)

vech(x, k = 0)

## S4 method for signature 'array'
vech(x, k = 0)

## S4 method for signature 'madness'
vech(x, k = 0)

ivech(x, k = 0, symmetric = FALSE)

## S4 method for signature 'ANY'
ivech(x, k = 0, symmetric = FALSE)

## S4 method for signature 'madness'
ivech(x, k = 0, symmetric = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vec_+3A_x">x</code></td>
<td>
<p>a <code>madness</code> object or multidimensional array or matrix.</p>
</td></tr>
<tr><td><code id="vec_+3A_k">k</code></td>
<td>
<p>the diagonal from which to subselect.</p>
</td></tr>
<tr><td><code id="vec_+3A_symmetric">symmetric</code></td>
<td>
<p>logical whether to put the array on the antidiagonal
as well. Will throw an error if <code>k &gt; 0</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>madness</code> object or an array, of the vectorized array
or the subselected part. For the inverse operations, promotes to a
<code>madness</code> of a matrix, or a matrix.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+reshapes">reshapes</a></code>, in particular <code>tril</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;- matrix(rnorm(16),ncol=4)
sy &lt;- y + t(y)
vy &lt;- vec(sy)
vmy &lt;- vec(madness(sy))
vhy &lt;- vech(sy)
vmhy &lt;- vech(madness(sy))

ivech(c(1,2,3))
ivech(c(1,2,3),-1)
ivech(c(1,2,3),-1,symmetric=TRUE)
ivech(c(1,2,3,4,5,6,7,8),1)
</code></pre>

<hr>
<h2 id='wff3'>Weekly Fama French 3 Factor Returns</h2><span id='topic+wff3'></span>

<h3>Description</h3>

<p>The weekly returns of the 3 Fama French Factors: Market, the cap factor SMB, 
and the growth factor HML.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wff3
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> object with 4800 observations and 5 columns.
The data run from July, 1926 through June, 2018.
As in the upstream source, the data are given in <em>percents</em>, meaning a
value of 1.00 corresponds to a 1% movement.
Note also that returns presumably are &lsquo;simple&rsquo; returns, not log
returns, though this is not clarified by the upstream source.
The columns are defined as follows:
</p>

<dl>
<dt><code>Date</code></dt><dd><p>The closing data, as a <code>Date</code> object. These are typically Saturdays.</p>
</dd>
<dt><code>Mkt</code></dt><dd><p>The Market weekly return. Note that the risk free rate has been added back
to the excess returns published by the upstream source.</p>
</dd>
<dt><code>SMB</code></dt><dd><p>The cap factor weekly return.</p>
</dd>
<dt><code>HML</code></dt><dd><p>The growth factor weekly return.</p>
</dd>
<dt><code>RF</code></dt><dd><p>The risk-free rate, presumably as an weekly rate, though note that no corrections have been
made for weekend effects when adding the risk-free rate back to the market
rate.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>Source</h3>

<p>Kenneth French data library, via Quandl. 
See <a href="http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html">http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html</a>,
data description at <a href="http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/Data_Library/f-f_factors.html">http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/Data_Library/f-f_factors.html</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(wff3)
str(wff3)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
