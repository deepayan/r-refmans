<!DOCTYPE html><html lang="en"><head><title>Help for package MALDIquant</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MALDIquant}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MALDIquant-package'>
<p>Quantitative Analysis of Mass Spectrometry Data</p></a></li>
<li><a href='#AbstractMassObject-class'><p>Class &quot;AbstractMassObject&quot;</p></a></li>
<li><a href='#alignSpectra'>
<p>Align MassSpectrum objects.</p></a></li>
<li><a href='#averageMassSpectra'>
<p>Averages <code>MassSpectrum</code> objects.</p></a></li>
<li><a href='#binPeaks'>
<p>Align Peaks into discrete bins.</p></a></li>
<li><a href='#calibrateIntensity-methods'><p>Calibrates intensities of a MassSpectrum object.</p></a></li>
<li><a href='#createMassPeaks'>
<p>Creates a MassPeaks object.</p></a></li>
<li><a href='#createMassSpectrum'>
<p>Creates a MassSpectrum object.</p></a></li>
<li><a href='#detectPeaks-methods'><p>Detects peaks in a MassSpectrum object.</p></a></li>
<li><a href='#determineWarpingFunctions'>
<p>Determine warping functions of MassPeaks objects.</p></a></li>
<li><a href='#estimateBaseline-methods'><p>Estimates the baseline of a MassSpectrum object.</p></a></li>
<li><a href='#estimateNoise-methods'><p>Estimates the noise of a MassSpectrum object.</p></a></li>
<li><a href='#fiedler2009subset'><p>Example Mass Spectra (raw)</p></a></li>
<li><a href='#filterPeaks'>
<p>Removes less frequent peaks.</p></a></li>
<li><a href='#findEmptyMassObjects'>
<p>Finds or removes empty AbstractMassObject objects in a list.</p></a></li>
<li><a href='#intensityMatrix'>
<p>Converts a list of MassPeaks objects into a matrix.</p></a></li>
<li><a href='#isMassSpectrum'>
<p>Tests for MassSpectrum or MassPeaks object.</p></a></li>
<li><a href='#isMassSpectrumList'>
<p>Tests a list of MassSpectrum or MassPeaks objects.</p></a></li>
<li><a href='#labelPeaks-methods'><p>Draws peak labels to plot.</p></a></li>
<li><a href='#MALDIquant-defunct'><p>Removed Functions/Methods in Package <span class="pkg">MALDIquant</span></p></a></li>
<li><a href='#MALDIquant-deprecated'><p>Deprecated Functions/Methods in Package <span class="pkg">MALDIquant</span></p></a></li>
<li><a href='#MALDIquant-parallel'><p>Parallel Support in Package <span class="pkg">MALDIquant</span></p></a></li>
<li><a href='#MassPeaks-class'><p>Class &quot;MassPeaks&quot;</p></a></li>
<li><a href='#MassSpectrum-class'><p>Class &quot;MassSpectrum&quot;</p></a></li>
<li><a href='#match.closest'><p>Relaxed Value Matching</p></a></li>
<li><a href='#mergeMassPeaks'>
<p>Merges <code>MassPeaks</code> objects.</p></a></li>
<li><a href='#monoisotopicPeaks-methods'><p>Finds monoisotopic peaks in a MassPeaks object.</p></a></li>
<li><a href='#msiSlices'><p>Turn a list of AbstractMassObjects into a mass spectrometry imaging</p>
slice.</a></li>
<li><a href='#plot-methods'><p>Plots an AbstractMassObject object.</p></a></li>
<li><a href='#plotMsiSlice-methods'><p>Plots a Mass Spectrometry Imaging dataset.</p></a></li>
<li><a href='#referencePeaks'>
<p>Creates a reference <code>MassPeaks</code> object.</p></a></li>
<li><a href='#removeBaseline-methods'><p>Removes the baseline of a MassSpectrum object.</p></a></li>
<li><a href='#smoothIntensity-methods'><p>Smoothes intensities of a MassSpectrum object.</p></a></li>
<li><a href='#transformIntensity-methods'><p>Transforms intensities of an AbstractMassObject object.</p></a></li>
<li><a href='#trim-methods'><p>Trim an AbstractMassObject object.</p></a></li>
<li><a href='#warpMassSpectra'>
<p>Run warping functions on AbstractMassObject objects.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.22.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-08-19</td>
</tr>
<tr>
<td>Title:</td>
<td>Quantitative Analysis of Mass Spectrometry Data</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), methods</td>
</tr>
<tr>
<td>Imports:</td>
<td>parallel</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, testthat (&ge; 0.8)</td>
</tr>
<tr>
<td>Description:</td>
<td>A complete analysis pipeline for matrix-assisted laser
        desorption/ionization-time-of-flight (MALDI-TOF) and other
        two-dimensional mass spectrometry data. In addition to commonly
        used plotting and processing methods it includes distinctive
        features, namely baseline subtraction methods such as
        morphological filters (TopHat) or the statistics-sensitive
        non-linear iterative peak-clipping algorithm (SNIP), peak
        alignment using warping functions, handling of replicated
        measurements as well as allowing spectra with different
        resolutions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>,
<a href="https://github.com/sgibb/MALDIquant/">https://github.com/sgibb/MALDIquant/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/sgibb/MALDIquant/issues/">https://github.com/sgibb/MALDIquant/issues/</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-08-19 20:58:22 UTC; sebastian</td>
</tr>
<tr>
<td>Author:</td>
<td>Sebastian Gibb <a href="https://orcid.org/0000-0001-7406-4443"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Korbinian Strimmer
    <a href="https://orcid.org/0000-0001-7917-2056"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ths],
  Sigurdur Smarason [ctb],
  Laurent Gatto <a href="https://orcid.org/0000-0002-1520-2268"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Paolo Inglese [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sebastian Gibb &lt;mail@sebastiangibb.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-08-19 23:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='MALDIquant-package'>
Quantitative Analysis of Mass Spectrometry Data
</h2><span id='topic+MALDIquant-package'></span><span id='topic+MALDIquant'></span>

<h3>Description</h3>

<p>MALDIquant provides a complete analysis pipeline for
matrix-assisted laser desorption/ionization-time-of-flight (MALDI-TOF)
and other two-dimensional mass spectrometry data.
</p>
<p>In addition to commonly used plotting and processing methods it
includes distinctive features, namely baseline
subtraction methods such as morphological filters (TopHat) or the
statistics-sensitive non-linear iterative peak-clipping algorithm
(SNIP), peak alignment using warping functions, handling of replicated
measurements as well as allowing spectra with different resolutions.
</p>
<p>For a first overview see
<code>vignette("MALDIquant-intro", package="MALDIquant")</code> and/or run
<code>demo("MALDIquant")</code>.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> MALDIquant</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 3)</td>
</tr>
<tr>
 <td style="text-align: left;">
URL: </td><td style="text-align: left;"> https://strimmerlab.github.io/software/maldiquant/</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Main classes:
</p>

<ul>
<li> <p><code><a href="#topic+MassPeaks-class">MassPeaks</a></code>: Represents a peak list of a single
spectrum.
</p>
</li>
<li> <p><code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>: Represents a single spectrum.
</p>
</li></ul>

<p>The accompanying website (see below) provides example R scripts to illustrate
the functionality of this package, too.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb
</p>
<p>Maintainer: Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>References</h3>

<p>S. Gibb and K. Strimmer. 2012. <br />
MALDIquant: a versatile R package for the analysis of mass spectrometry data. <br />
Bioinformatics 28: 2270-2271. <br />
<a href="https://doi.org/10.1093/bioinformatics/bts447">doi:10.1093/bioinformatics/bts447</a> <br />
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>See Also</h3>


<ul>
<li><p> Introduction:
<code>vignette("MALDIquant-intro", package="MALDIquant")</code>.
</p>
</li>
<li><p> Run demo files: <code>demo("MALDIquant")</code>.
</p>
</li>
<li><p> List all available manual pages: <code>library(help="MALDIquant")</code>.
</p>
</li>
<li><p> MALDIquant website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>.
</p>
</li>
<li><p> more MALDIquant examples and complete analyses:
<a href="https://github.com/sgibb/MALDIquantExamples/">https://github.com/sgibb/MALDIquantExamples/</a>.
</p>
</li></ul>


<hr>
<h2 id='AbstractMassObject-class'>Class &quot;AbstractMassObject&quot;</h2><span id='topic+AbstractMassObject-class'></span><span id='topic++5B+2CAbstractMassObject+2Clogical+2Cmissing-method'></span><span id='topic++5B+2CAbstractMassObject+2Cnumeric+2Cmissing-method'></span><span id='topic++5B+2CMassPeaks+2Clogical+2Cmissing-method'></span><span id='topic++5B+2CMassPeaks+2Cnumeric+2Cmissing-method'></span><span id='topic+as.matrix+2CAbstractMassObject-method'></span><span id='topic+intensity'></span><span id='topic+intensity+3C-'></span><span id='topic+intensity+2CAbstractMassObject-method'></span><span id='topic+intensity+3C-+2CAbstractMassObject+2Cnumeric-method'></span><span id='topic+isEmpty'></span><span id='topic+isEmpty+2CAbstractMassObject-method'></span><span id='topic+length+2CAbstractMassObject-method'></span><span id='topic+lines+2CAbstractMassObject-method'></span><span id='topic+mass'></span><span id='topic+mass+3C-'></span><span id='topic+mass+2CAbstractMassObject-method'></span><span id='topic+mass+3C-+2CAbstractMassObject+2Cnumeric-method'></span><span id='topic+mz'></span><span id='topic+mz+3C-'></span><span id='topic+mz+2CAbstractMassObject-method'></span><span id='topic+mz+3C-+2CAbstractMassObject+2Cnumeric-method'></span><span id='topic+metaData'></span><span id='topic+metaData+3C-'></span><span id='topic+metaData+2CAbstractMassObject-method'></span><span id='topic+metaData+3C-+2CAbstractMassObject-method'></span><span id='topic+coordinates'></span><span id='topic+coordinates+3C-'></span><span id='topic+coordinates+2CAbstractMassObject-method'></span><span id='topic+coordinates+3C-+2CAbstractMassObject+2Cnumeric-method'></span><span id='topic+coordinates+3C-+2CAbstractMassObject+2Cmatrix-method'></span><span id='topic+coordinates+2Clist-method'></span><span id='topic+coordinates+3C-+2Clist+2Cmatrix-method'></span><span id='topic+points+2CAbstractMassObject-method'></span>

<h3>Description</h3>

<p><code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> is an abstract (means pure virtual)
class. It is the parent class of <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> and
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code>.
It shouldn't create or handle by the user because it is for internal use only.
</p>


<h3>Derived classes</h3>

<p><code><a href="#topic+MassPeaks-class">MassPeaks</a></code>,
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>
</p>


<h3>Slots</h3>


<dl>
<dt><code>mass</code>:</dt><dd><p><code>numeric</code>, mass or mass-to-charge ratio</p>
</dd>
<dt><code>intensity</code>:</dt><dd><p><code>numeric</code>, intensities for measured
mass-to-charge ratios</p>
</dd>
<dt><code>metaData</code>:</dt><dd><p><code>list</code>, some metadata to describe the
spectrum</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>[</dt><dd><p><code>signature(x = "AbstractMassObject", i = "numeric")</code>:
Extracts a range of an <code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> object
and returns a new one.</p>
</dd>
<dt>as.matrix</dt><dd><p><code>signature(x = "AbstractMassObject")</code>:
Converts an <code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> object to a
matrix with 2 columns (<code>mass</code>, <code>intensity</code>).</p>
</dd>
<dt>coordinates</dt><dd><p><code>signature(object = "AbstractMassObject")</code>:
Accessor function for coordinates stored in object generated from imaging
mass spectrometry data.</p>
</dd>
<dt>coordinates&lt;-</dt><dd><p><code>signature(object = "AbstractMassObject",
      value = "numeric|matrix")</code>
Replacement function for coordinates used in imaging mass spectrometry
datasets.</p>
</dd>
<dt>intensity</dt><dd><p><code>signature(object = "AbstractMassObject")</code>:
Accessor function for slot <code>intensity</code>.</p>
</dd>
<dt>intensity&lt;-</dt><dd><p><code>signature(object = "AbstractMassObject",
      value = "numeric")</code>
Replacement function for slot <code>intensity</code>.</p>
</dd>
<dt>isEmpty</dt><dd><p><code>signature(object = "AbstractMassObject")</code>:
Returns <code>TRUE</code> if length of <code>intensity</code> is 0 or all
<code>intensity</code> values are 0.</p>
</dd>
<dt>length</dt><dd><p><code>signature(x = "AbstractMassObject")</code>:
Returns length of slot <code>intensity</code>.</p>
</dd>
<dt>lines</dt><dd><p><code>signature(x = "AbstractMassObject")</code>:
Extented function for adding <code>AbstractMassObject</code> object as a
line to a specific plot.
See <code><a href="graphics.html#topic+lines">lines</a></code> for details.</p>
</dd>
<dt>mass</dt><dd><p><code>signature(object = "AbstractMassObject")</code>:
Accessor function for slot <code>mass</code>.</p>
</dd>
<dt>mass&lt;-</dt><dd><p><code>signature(object = "AbstractMassObject",
      value = "numeric")</code>
Replacement function for slot <code>mass</code>.</p>
</dd>
<dt>mz</dt><dd><p><code>signature(object = "AbstractMassObject")</code>:
Accessor function for slot <code>mass</code>.</p>
</dd>
<dt>mz&lt;-</dt><dd><p><code>signature(object = "AbstractMassObject",
      value = "numeric")</code>
Replacement function for slot <code>mass</code>.</p>
</dd>
<dt>metaData</dt><dd><p><code>signature(object = "AbstractMassObject")</code>:
Accessor function for slot <code>metaData</code>.</p>
</dd>
<dt>metaData&lt;-</dt><dd><p><code>signature(object = "AbstractMassObject")</code>:
Replacement function for slot <code>metaData</code>.</p>
</dd>
<dt>plot</dt><dd><p><code>signature(x = "AbstractMassObject", y = "missing")</code>:
Extented function for plotting an <code>AbstractMassObject</code> object.
See <code><a href="#topic+plot+2CAbstractMassObject+2Cmissing-method">plot,AbstractMassObject,missing-method</a></code> for
details.</p>
</dd>
<dt>points</dt><dd><p><code>signature(x = "AbstractMassObject")</code>:
Extented function for adding
<code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> object as points
to a specific plot.
See <code><a href="graphics.html#topic+points">points</a></code> for details.</p>
</dd>
<dt>trim</dt><dd><p><code>signature(object = "AbstractMassObject",
      range = "numeric")</code>: Trim an <code>AbstractMassObject</code>
object. See <code><a href="#topic+trim+2CAbstractMassObject+2Cnumeric-method">trim,AbstractMassObject,numeric-method</a></code>
for details.</p>
</dd>
<dt>transformIntensity</dt><dd><p><code>signature(object = "AbstractMassObject")</code>:
Transforms the intensities of an <code>AbstractMassObject</code> object.
See <code><a href="#topic+transformIntensity+2CAbstractMassObject-method">transformIntensity,AbstractMassObject-method</a></code>
for details.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MassPeaks-class">MassPeaks</a></code>,
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>,
<code><a href="#topic+plot+2CAbstractMassObject+2Cmissing-method">plot,AbstractMassObject,missing-method</a></code>,
<code><a href="#topic+transformIntensity+2CAbstractMassObject-method">transformIntensity,AbstractMassObject-method</a></code>,
<code><a href="#topic+trim+2CAbstractMassObject+2Cnumeric-method">trim,AbstractMassObject,numeric-method</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## create example spectrum
s &lt;- createMassSpectrum(mass=1:10, intensity=11:20,
                        metaData=list(name="Example Spectrum"))

## get intensity
intensity(s)

## get mass
mass(s)

## get metaData
metaData(s)

## replace metaData
metaData(s) &lt;- list(name="Spectrum")

## trim spectrum
trim(s, c(2, 9))

## select a range
s[3:6]
</code></pre>

<hr>
<h2 id='alignSpectra'>
Align MassSpectrum objects.
</h2><span id='topic+alignSpectra'></span>

<h3>Description</h3>

<p>This function aligns a list of <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> objects
(spectra alignment is also known as <em>warping/phase correction</em>). <br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alignSpectra(spectra, halfWindowSize=20, noiseMethod="MAD", SNR=2,
  reference, tolerance=0.002, warpingMethod="lowess",
  allowNoMatches=FALSE, emptyNoMatches=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="alignSpectra_+3A_spectra">spectra</code></td>
<td>

<p><code>list</code>, list of <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> objects.
</p>
</td></tr>
<tr><td><code id="alignSpectra_+3A_halfwindowsize">halfWindowSize</code></td>
<td>
<p><code>numeric</code>, half window size; see
<code><a href="#topic+detectPeaks">detectPeaks</a></code>.
</p>
</td></tr>
<tr><td><code id="alignSpectra_+3A_noisemethod">noiseMethod</code></td>
<td>
<p>a noise estimation method; see
<code><a href="#topic+detectPeaks">detectPeaks</a></code>.
</p>
</td></tr>
<tr><td><code id="alignSpectra_+3A_snr">SNR</code></td>
<td>
<p>single numeric value. <code>SNR</code> is an abbreviation for
<em>s</em>ignal-to-<em>n</em>oise-<em>r</em>atio; see
<code><a href="#topic+detectPeaks">detectPeaks</a></code>.
</p>
</td></tr>
<tr><td><code id="alignSpectra_+3A_reference">reference</code></td>
<td>

<p><code><a href="#topic+MassPeaks-class">MassPeaks</a></code>, reference object to which the samples
(<code>l</code>) should be aligned. If missing
<code><a href="#topic+referencePeaks">referencePeaks</a></code> is used; see
<code><a href="#topic+determineWarpingFunctions">determineWarpingFunctions</a></code>.
</p>
</td></tr>
<tr><td><code id="alignSpectra_+3A_tolerance">tolerance</code></td>
<td>

<p><code>double</code>, maximal relative deviation of a peak position (mass) to be
considered as identical. Must be multiplied by <code>10^-6</code> for ppm,
e.g. use <code>tolerance=5e-6</code> for 5 ppm; see
<code><a href="#topic+determineWarpingFunctions">determineWarpingFunctions</a></code>.
</p>
</td></tr>
<tr><td><code id="alignSpectra_+3A_warpingmethod">warpingMethod</code></td>
<td>

<p>used basic warping function; see
<code><a href="#topic+determineWarpingFunctions">determineWarpingFunctions</a></code>.
</p>
</td></tr>
<tr><td><code id="alignSpectra_+3A_allownomatches">allowNoMatches</code></td>
<td>

<p><code>logical</code>, don't throw an error if an <code><a href="#topic+MassPeaks-class">MassPeaks</a></code>
object could not match to the <code>reference</code>; see
<code><a href="#topic+determineWarpingFunctions">determineWarpingFunctions</a></code>.
</p>
</td></tr>
<tr><td><code id="alignSpectra_+3A_emptynomatches">emptyNoMatches</code></td>
<td>

<p><code>logical</code>, if <code>TRUE</code> (default: <code>FALSE</code>)
the intensity values of
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> or
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects with missing (<code>NA</code>)
warping functions are set to zero; see
<code><a href="#topic+warpMassSpectra">warpMassSpectra</a></code>.
</p>
</td></tr>
<tr><td><code id="alignSpectra_+3A_...">...</code></td>
<td>
<p>arguments to be passed to
<code><a href="#topic+detectPeaks+2CMassSpectrum-method">detectPeaks,MassSpectrum-method</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>alignSpectra</code> is a wrapper function around
<code><a href="#topic+detectPeaks">detectPeaks</a></code>,
<code><a href="#topic+determineWarpingFunctions">determineWarpingFunctions</a></code> and
<code><a href="#topic+warpMassSpectra">warpMassSpectra</a></code>. Please call these functions
manually if you need finer control (e.g. plotting of warping functions).
</p>


<h3>Value</h3>

<p>Returns a <code>list</code> of aligned <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> objects.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+detectPeaks">detectPeaks</a></code>,
<code><a href="#topic+determineWarpingFunctions">determineWarpingFunctions</a></code>,
<code><a href="#topic+referencePeaks">referencePeaks</a></code>,
<code><a href="#topic+warpMassSpectra">warpMassSpectra</a></code>,
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>
</p>
<p><code>demo("warping")</code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## load example data
data("fiedler2009subset", package="MALDIquant")

## running typical workflow

## transform intensities
spectra &lt;- transformIntensity(fiedler2009subset, method="sqrt")

## smooth spectra
spectra &lt;- smoothIntensity(spectra, method="MovingAverage")

## baseline correction
spectra &lt;- removeBaseline(spectra)

## align spectra
spectra &lt;- alignSpectra(spectra)
</code></pre>

<hr>
<h2 id='averageMassSpectra'>
Averages <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> objects.
</h2><span id='topic+averageMassSpectra'></span>

<h3>Description</h3>

<p>This function averages <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>averageMassSpectra(l, labels, method=c("mean", "median", "sum"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="averageMassSpectra_+3A_l">l</code></td>
<td>

<p><code>list</code>, list of <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> objects.
</p>
</td></tr>
<tr><td><code id="averageMassSpectra_+3A_labels">labels</code></td>
<td>

<p><code>list</code>, list of <code><a href="base.html#topic+factor">factor</a></code>s (one for each
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object) to do groupwise averaging.
</p>
</td></tr>
<tr><td><code id="averageMassSpectra_+3A_method">method</code></td>
<td>
<p>used aggregation function.</p>
</td></tr>
<tr><td><code id="averageMassSpectra_+3A_...">...</code></td>
<td>
<p>arguments to be passed to underlying functions (currently only
<code>mc.cores</code> is supported).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The mass of the averaged <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object
will be the mass of the first non-empty
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object (of each group).
</p>


<h3>Value</h3>

<p>Returns a single (no <code>labels</code> given) or a <code><a href="base.html#topic+list">list</a></code>
(<code>labels</code> given) of averaged <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> objects.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>,
<code><a href="#topic+mergeMassPeaks">mergeMassPeaks</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## create four MassSpectrum objects and add them to a list
s &lt;- list(createMassSpectrum(mass=1:5, intensity=1:5),
          createMassSpectrum(mass=1:5, intensity=1:5),
          createMassSpectrum(mass=1:5, intensity=6:10),
          createMassSpectrum(mass=1:5, intensity=6:10))

## average all four MassSpectrum objects into a single new one
## by sum their intensities
## (no labels, returns only one new MassSpectrum object)
summedSpectra &lt;- averageMassSpectra(s, method="sum")

## only average MassSpectrum objects in a group
## (e.g. useful for technical replicates)
## (two different labels, returns a list of two new MassPeaks objects)
groups &lt;- factor(c("a", "a", "b", "b"), levels=c("a", "b"))
averagedSpectra &lt;- averageMassSpectra(s, labels=groups, method="mean")
</code></pre>

<hr>
<h2 id='binPeaks'>
Align Peaks into discrete bins.
</h2><span id='topic+binPeaks'></span>

<h3>Description</h3>

<p>This function looks for similar peaks (mass) across
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects and equalizes their mass.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binPeaks(l, method=c("strict", "relaxed", "reference"), tolerance=0.002)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="binPeaks_+3A_l">l</code></td>
<td>

<p><code>list</code>, list of <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects.
</p>
</td></tr>
<tr><td><code id="binPeaks_+3A_method">method</code></td>
<td>

<p>bin creation rule. <code>"strict"</code> creates bins never containing two
or more peaks of the same sample. <code>"relaxed"</code> allows multiple
peaks of the same sample in one bin. <code>"reference"</code> generates bins
around the mass values from the first <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object
in <code>l</code>.</p>
</td></tr>
<tr><td><code id="binPeaks_+3A_tolerance">tolerance</code></td>
<td>

<p><code>double</code>, maximal relative deviation of a peak position (mass) to be
considered as identical. Must be multiplied by <code>10^-6</code> for ppm,
e.g. use <code>tolerance=5e-6</code> for 5 ppm.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm is based on the following workflow:
</p>

<ol>
<li><p>Put all mass in a sorted vector.
</p>
</li>
<li><p>Calculate differences between each neighbor.
</p>
</li>
<li><p>Divide the mass vector at the largest gap (largest difference) and form
a left and a right bin.
</p>
</li>
<li><p>Rerun step 3 for the left and/or the right bin if they don't fulfill
the following criteria:
</p>

<ul>
<li><p>All peaks in a bin are near to the mean (<code>method == "strict"</code>
or <code>method == "relaxed"</code>)
(<code>abs(mass-meanMass)/meanMass &lt; tolerance</code>) or the
reference mass (<code>method == "reference"</code>;
<code>abs(mass-reference)/reference &lt; tolerance</code>).
</p>
</li>
<li><p><code>method == "strict"</code>: The bin doesn't contain two or more
peaks of the same sample.
</p>
</li></ul>


</li></ol>

<p><code>method == "strict"</code>: The new peak positions (mass value) are the
mean mass of a bin. <br />
<code>method == "relaxed"</code>: The new peak positions for the highest peaks of each
sample in a bin are generated by the mean mass of this peaks. The lower
peaks are not changed.
<code>method == "reference"</code>: The new peak positions for the highest peaks of
each sample in a bin are generated by the mass of peaks of the first
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object. Lower peaks are not changed.
</p>


<h3>Value</h3>

<p>Returns a <code><a href="base.html#topic+list">list</a></code> of mass adjusted
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+intensityMatrix">intensityMatrix</a></code>,
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## create two MassPeaks objects
p &lt;- list(createMassPeaks(mass=seq(100, 500, 100), intensity=1:5),
          createMassPeaks(mass=c(seq(100.2, 300.2, 100), 395), intensity=1:4))

binnedPeaks &lt;- binPeaks(p, tolerance=0.002)

## compare result
iM1 &lt;- intensityMatrix(p)
iM2 &lt;- intensityMatrix(binnedPeaks)

all(dim(iM1) == c(2, 9)) # TRUE
all(dim(iM2) == c(2, 6)) # TRUE

show(iM2)

## increase tolerance
binnedPeaks &lt;- binPeaks(p, tolerance=0.1)

iM3 &lt;- intensityMatrix(binnedPeaks)

all(dim(iM3) == c(2, 5)) # TRUE

show(iM3)

## differences between "strict" and "relaxed"
p &lt;- c(createMassPeaks(mass=c(1, 1.01, 3), intensity=c(2, 1, 1)),
       createMassPeaks(mass=c(0.99, 3), intensity=rep(1, 2)),
       createMassPeaks(mass=c(1.02, 3), intensity=rep(1, 2)))

intensityMatrix(binPeaks(p, method="strict", tolerance=0.05))
intensityMatrix(binPeaks(p, method="relaxed", tolerance=0.05))

## use a reference
ref &lt;- createMassPeaks(mass=c(1, 3), intensity=rep(1, 2))
## include the reference
intensityMatrix(binPeaks(c(ref, p), method="reference", tolerance=0.05))
## drop the reference
intensityMatrix(binPeaks(c(ref, p), method="reference", tolerance=0.05)[-1])
</code></pre>

<hr>
<h2 id='calibrateIntensity-methods'>Calibrates intensities of a MassSpectrum object.</h2><span id='topic+calibrateIntensity'></span><span id='topic+calibrateIntensity+2CMassSpectrum-method'></span><span id='topic+calibrateIntensity+2Clist-method'></span>

<h3>Description</h3>

<p>This function calibrates (normalize) intensities of
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MassSpectrum'
calibrateIntensity(object,
  method=c("TIC", "PQN", "median"), range, ...)
## S4 method for signature 'list'
calibrateIntensity(object,
  method=c("TIC", "PQN", "median"), range, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calibrateIntensity-methods_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object or a <code>list</code> of
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> objects.</p>
</td></tr>
<tr><td><code id="calibrateIntensity-methods_+3A_method">method</code></td>
<td>
<p>the calibration method to be used. This should be one of
<code>"TIC"</code>, <code>"PQN"</code> or <code>"median"</code>.
See &lsquo;Details&rsquo; section.</p>
</td></tr>
<tr><td><code id="calibrateIntensity-methods_+3A_range">range</code></td>
<td>
<p><code>numeric</code> of length 2, if given the scaling factor is
calculated on the mass range from <code>range[1L]</code> to <code>range[2L]</code> and
applied to the whole spectrum.</p>
</td></tr>
<tr><td><code id="calibrateIntensity-methods_+3A_...">...</code></td>
<td>
<p>arguments to be passed to other functions. Currently only
<code>mc.cores</code> is supported if <code>object</code> is a <code>list</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A number of different calibration methods are provided:
</p>

<dl>
<dt><code>"TIC"</code>:</dt><dd><p>The TIC (<em>T</em>otal <em>I</em>on <em>C</em>urrent) of a
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object is set to one. If <code>range</code> is
given the <em>TIC</em> is only calculated for the intensities in the
specified mass range.</p>
</dd>
<dt><code>"PQN"</code>:</dt><dd><p>The PQN (<em>P</em>robabilistic <em>Q</em>uotient
<em>N</em>ormalization) is described in <em>Dieterle et al 2006</em>.
<code>calibrateIntensity</code> uses the following algorithm:
</p>

<ol>
<li><p>Calibrate all spectra using the <code>"TIC"</code> calibration.
</p>
</li>
<li><p>Calculate a median reference spectrum.
</p>
</li>
<li><p>Calculate the quotients of all intensities of the spectra with
those of the reference spectrum.
</p>
</li>
<li><p>Calculate the median of these quotients for each spectrum.
</p>
</li>
<li><p>Divide all intensities of each spectrum by its median of
quotients.
</p>
</li></ol>

</dd>
<dt><code>"median"</code>:</dt><dd><p>The median of intensities of a
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object is set to one.</p>
</dd>
</dl>



<h3>Value</h3>

<p>Returns a modified <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object with calibrated
intensities.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>References</h3>

<p>F. Dieterle, A. Ross, G. Schlotterbeck, and Hans Senn. 2006.
Probabilistic quotient normalization as robust method to account for
dilution of complex biological mixtures. Application in 1H NMR metabonomics.
Analytical Chemistry 78(13): 4281-4290.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## load example data
data("fiedler2009subset", package="MALDIquant")

## baseline correction
b &lt;- removeBaseline(fiedler2009subset)

## calibrate intensity values
calibrateIntensity(b, method="TIC")

## calibrate intensity values using TIC for a specific mass range
calibrateIntensity(b, method="TIC", range=c(3000, 5000))
</code></pre>

<hr>
<h2 id='createMassPeaks'>
Creates a MassPeaks object.
</h2><span id='topic+createMassPeaks'></span>

<h3>Description</h3>

<p>This function creates a <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object. Normally it
shouldn't called by the user. Try
<code><a href="#topic+detectPeaks+2CMassSpectrum-method">detectPeaks,MassSpectrum-method</a></code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createMassPeaks(mass, intensity, snr=rep.int(NA_real_, length(intensity)),
                metaData=list())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createMassPeaks_+3A_mass">mass</code></td>
<td>

<p><code>vector</code>, mass or mass-to-charge ratio.
</p>
</td></tr>
<tr><td><code id="createMassPeaks_+3A_intensity">intensity</code></td>
<td>

<p><code>vector</code>, intensities for measured mass-to-charge ratios.
</p>
</td></tr>
<tr><td><code id="createMassPeaks_+3A_snr">snr</code></td>
<td>

<p><code>vector</code>, signal-to-noise ratios for intensity values.
</p>
</td></tr>
<tr><td><code id="createMassPeaks_+3A_metadata">metaData</code></td>
<td>

<p><code>list</code>, some metadata to describe the peaks.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+detectPeaks+2CMassSpectrum-method">detectPeaks,MassSpectrum-method</a></code>,
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## create a MassPeaks object by default constructor
s &lt;- createMassPeaks(mass=1:100, intensity=rnorm(100)^2,
                     metaData=list(name="example peaks"))

## show some details
s
</code></pre>

<hr>
<h2 id='createMassSpectrum'>
Creates a MassSpectrum object.
</h2><span id='topic+createMassSpectrum'></span>

<h3>Description</h3>

<p>This function creates a <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createMassSpectrum(mass, intensity, metaData=list())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createMassSpectrum_+3A_mass">mass</code></td>
<td>

<p><code>vector</code>, mass or mass-to-charge ratio
</p>
</td></tr>
<tr><td><code id="createMassSpectrum_+3A_intensity">intensity</code></td>
<td>

<p><code>vector</code>, intensities for measured mass-to-charge ratios
</p>
</td></tr>
<tr><td><code id="createMassSpectrum_+3A_metadata">metaData</code></td>
<td>

<p><code>list</code>, some metadata to describe the spectrum
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## create a MassSpectrum object by default constructor
s &lt;- createMassSpectrum(mass=1:100, intensity=rnorm(100)^2,
                        metaData=list(name="example spectrum"))

## show some details
s
</code></pre>

<hr>
<h2 id='detectPeaks-methods'>Detects peaks in a MassSpectrum object.</h2><span id='topic+detectPeaks'></span><span id='topic+detectPeaks+2CMassSpectrum-method'></span><span id='topic+detectPeaks+2Clist-method'></span>

<h3>Description</h3>

<p>This method looks for peaks in mass spectrometry data
(represented by a <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object).<br />
A peak is a local maximum above a user defined noise threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MassSpectrum'
detectPeaks(object,
  halfWindowSize=20, method=c("MAD", "SuperSmoother"), SNR=2,
  ...)
## S4 method for signature 'list'
detectPeaks(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="detectPeaks-methods_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object or a <code>list</code> of
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> objects.</p>
</td></tr>
<tr><td><code id="detectPeaks-methods_+3A_halfwindowsize">halfWindowSize</code></td>
<td>
<p><code>numeric</code>, half window size. <br />
The resulting window reaches from <code>mass[currentIndex-halfWindowSize]</code>
to <code>mass[currentIndex+halfWindowSize]</code>. A local maximum have to be
the highest one in the given window to be recognized as peak.</p>
</td></tr>
<tr><td><code id="detectPeaks-methods_+3A_method">method</code></td>
<td>
<p>a noise estimation function; see
<code><a href="#topic+estimateNoise+2CMassSpectrum-method">estimateNoise,MassSpectrum-method</a></code>.
</p>
</td></tr>
<tr><td><code id="detectPeaks-methods_+3A_snr">SNR</code></td>
<td>
<p>single numeric value. <code>SNR</code> is an abbreviation for
<em>s</em>ignal-to-<em>n</em>oise-<em>r</em>atio. A local maximum has to
be higher than <code>SNR*noise</code> to be recognize as peak.</p>
</td></tr>
<tr><td><code id="detectPeaks-methods_+3A_...">...</code></td>
<td>
<p>arguments to be passed to
<code><a href="#topic+estimateNoise+2CMassSpectrum-method">estimateNoise,MassSpectrum-method</a></code>. If
<code>object</code> is a <code>list</code> <code>mc.cores</code> is also supported.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MassPeaks-class">MassPeaks</a></code>,
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>,
<code><a href="#topic+estimateNoise+2CMassSpectrum-method">estimateNoise,MassSpectrum-method</a></code>
</p>
<p><code>demo("peaks")</code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## load example data
data("fiedler2009subset", package="MALDIquant")

## choose only the first mass spectrum
s &lt;- fiedler2009subset[[1]]

## transform intensities
s &lt;- transformIntensity(s, method="sqrt")

## smoothing spectrum
s &lt;- smoothIntensity(s, method="MovingAverage")

## remove baseline
s &lt;- removeBaseline(s)

## plot spectrum
plot(s)

## call peak detection
p &lt;- detectPeaks(s)

## draw peaks on the plot
points(p)

## label 10 highest peaks
top10 &lt;- intensity(p) %in% sort(intensity(p), decreasing=TRUE)[1:10]
labelPeaks(p, index=top10)
</code></pre>

<hr>
<h2 id='determineWarpingFunctions'>
Determine warping functions of MassPeaks objects.
</h2><span id='topic+determineWarpingFunctions'></span>

<h3>Description</h3>

<p>This function determines a warping function for a list of
<code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> objects
(warping is also known as <em>phase correction/spectra alignment</em>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>determineWarpingFunctions(l, reference, tolerance=0.002,
                          method=c("lowess", "linear", "quadratic", "cubic"),
                          allowNoMatches=FALSE,
                          plot=FALSE, plotInteractive=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="determineWarpingFunctions_+3A_l">l</code></td>
<td>

<p><code>list</code>, list of <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects.
</p>
</td></tr>
<tr><td><code id="determineWarpingFunctions_+3A_reference">reference</code></td>
<td>

<p><code><a href="#topic+MassPeaks-class">MassPeaks</a></code>, reference object to which the samples
(<code>l</code>) should be aligned. If missing
<code><a href="#topic+referencePeaks">referencePeaks</a></code> is used.
</p>
</td></tr>
<tr><td><code id="determineWarpingFunctions_+3A_tolerance">tolerance</code></td>
<td>

<p><code>double</code>, maximal relative deviation of a peak position (mass) to be
considered as identical. Must be multiplied by <code>10^-6</code> for ppm,
e.g. use <code>tolerance=5e-6</code> for 5 ppm.
</p>
</td></tr>
<tr><td><code id="determineWarpingFunctions_+3A_method">method</code></td>
<td>

<p>used basic warping function.
</p>
</td></tr>
<tr><td><code id="determineWarpingFunctions_+3A_allownomatches">allowNoMatches</code></td>
<td>

<p><code>logical</code>, don't throw an error if an <code><a href="#topic+MassPeaks-class">MassPeaks</a></code>
object could not match to the <code>reference</code>.
</p>
</td></tr>
<tr><td><code id="determineWarpingFunctions_+3A_plot">plot</code></td>
<td>

<p><code>logical</code>, if <code>TRUE</code> a warping plot is drawn for each sample.
</p>
</td></tr>
<tr><td><code id="determineWarpingFunctions_+3A_plotinteractive">plotInteractive</code></td>
<td>

<p><code>logical</code>, if <code>FALSE</code> a non-interactive device (e.g.
<code>pdf</code>) is used for warping plots.
</p>
</td></tr>
<tr><td><code id="determineWarpingFunctions_+3A_...">...</code></td>
<td>

<p>arguments to be passed to <code>warpingFunction</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>warpingFunction</code>: <code>determineWarpingFunctions</code> estimates a warping
function to overcome the difference between mass in <code>reference</code> and in
the current sample. To calculate the differences each reference peak would
match with the highest sample peak in the nearer neighborhood
(defined by <code>mass of reference peak*tolerance</code>). <br />
<code>allowNoMatches</code>: If <code>allowNoMatches</code> is <code>TRUE</code> a warning instead
of an error is thrown if an <code><a href="#topic+MassPeaks-class">MassPeaks</a></code>
object could not match to the <code>reference</code>. The returned list of warping
functions will contain <code>NA</code> for this object (same index in the list).
<code>plotInteractive</code>: If <code>plot</code> is <code>TRUE</code> a lot of output is
created (each sample in <code>l</code> gets its own plot).
That's why an non-interactive devices is recommended:
</p>
<pre>
## create a device
pdf()
## calculate warping functions
w &lt;- determineWarpingFunctions(p, plot=TRUE)
## close device
dev.off()
  </pre>


<h3>Value</h3>

<p>Returns a <code>list</code> of individual warping functions. The attribute
<code>nmatch</code> contains the number of matches of each
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> element in <code>l</code> against <code>reference</code>.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+referencePeaks">referencePeaks</a></code>,
<code><a href="#topic+warpMassPeaks">warpMassPeaks</a></code>,
<code><a href="#topic+warpMassSpectra">warpMassSpectra</a></code>,
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code>
</p>
<p><code>demo("warping")</code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## create a reference MassPeaks object
r &lt;- createMassPeaks(mass=1:5, intensity=1:5)

## create test samples
p &lt;- list(createMassPeaks(mass=((1:5)*1.01), intensity=1:5),
          createMassPeaks(mass=((1:5)*0.99), intensity=1:5))

## create an interactive device with 2 rows
par(mfrow=c(2, 1))
## calculate warping function
## (using a linear function as basic warping function)
## and show warping plot
w &lt;- determineWarpingFunctions(p, tolerance=0.02, method="linear",
                               plot=TRUE, plotInteractive=TRUE)
par(mfrow=c(1, 1))

## access number of matches
attr(w, "nmatch")

## w contains the individual warping functions
warpedPeaks &lt;- warpMassPeaks(p, w)

## compare results
all(mass(r) == mass(warpedPeaks[[1]])) # TRUE
all(mass(r) == mass(warpedPeaks[[2]])) # TRUE



## realistic example

## load example data
data("fiedler2009subset", package="MALDIquant")

## running typical workflow

## use only four spectra of the subset
spectra &lt;- fiedler2009subset[1:4]

## transform intensities
spectra &lt;- transformIntensity(spectra, method="sqrt")

## smooth spectra
spectra &lt;- smoothIntensity(spectra, method="MovingAverage")

## baseline correction
spectra &lt;- removeBaseline(spectra)

## detect peaks
peaks &lt;- detectPeaks(spectra)

## create an interactive device with 2 rows
par(mfrow=c(4, 1))
## calculate warping functions (using LOWESS based basic function [default])
w &lt;- determineWarpingFunctions(peaks, plot=TRUE, plotInteractive=TRUE)
par(mfrow=c(1, 1))



## realistic example with user defined reference/calibration peaks

## use the workflow above for fiedler2009subset

## create reference peaks
refPeaks &lt;- createMassPeaks(mass=c(1207, 1264, 1351, 1466, 1616, 2769, 2932,
                                   3191, 3262, 4091, 4209, 5904, 7762, 9285),
                            intensity=rep(1, 14))

## create an interactive device with 2 rows
par(mfrow=c(4, 1))
## calculate warping functions (using a quadratic function as basic function)
w &lt;- determineWarpingFunctions(peaks, reference=refPeaks, method="quadratic",
                               plot=TRUE, plotInteractive=TRUE)
par(mfrow=c(1, 1))
</code></pre>

<hr>
<h2 id='estimateBaseline-methods'>Estimates the baseline of a MassSpectrum object.</h2><span id='topic+estimateBaseline'></span><span id='topic+estimateBaseline+2CMassSpectrum-method'></span>

<h3>Description</h3>

<p>This method estimates the baseline of mass spectrometry data
(represented by a <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object).<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MassSpectrum'
estimateBaseline(object,
  method=c("SNIP", "TopHat", "ConvexHull", "median"),
  ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimateBaseline-methods_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object</p>
</td></tr>
<tr><td><code id="estimateBaseline-methods_+3A_method">method</code></td>
<td>
<p>used baseline estimation method, one of
<code>"SNIP"</code>, <code>"TopHat"</code>, <code>"ConvexHull"</code> or <code>"median"</code>.
</p>
</td></tr>
<tr><td><code id="estimateBaseline-methods_+3A_...">...</code></td>
<td>
<p>arguments to be passed to <code>method</code></p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt><code>"SNIP"</code>:</dt><dd>
<p>This baseline estimation is based on the Statistics-sensitive Non-linear
Iterative Peak-clipping algorithm (SNIP) described in Ryan et al 1988.<br />
</p>
<p>The algorithm based on the following equation:
</p>
<p style="text-align: center;"><code class="reqn">y_i(k) = \min \{ y_i, \frac{(y_{i-k}+y_{i+k})}{2} \}</code>
</p>

<p>It has two additional arguments namely <code>iterations</code> and
<code>decreasing</code>. <code>iterations</code> controls the window size (<em>k</em>;
similar to <code>halfWindowSize</code> in <code>"TopHat"</code>, <code>"Median"</code>) of
the algorithm. The resulting window reaches from
<code>mass[cur_index-iterations]</code> to <code>mass[cur_index+iterations]</code>.
</p>
<p><code>decreasing</code>: In Morhac 2009 a decreasing clipping window is
suggested to get a smoother baseline.  For <code>decreasing = TRUE</code>
(<code>decreasing = FALSE</code>) <em>k</em>=<code>iterations</code> is decreased
(increased) by one until zero (<code>iterations</code>) is reached. The default
setting is <code>decreasing = TRUE</code>.
</p>
</dd>
<dt><code>"TopHat"</code>:</dt><dd>
<p>This algorithm applies a moving minimum (erosion filter) and subsequently
a moving maximum (dilation filter) filter on the intensity values. The
implementation is based on van Herk 1996.
It has an additional <code>halfWindowSize</code> argument determining the half
size of the moving window for the TopHat filter. The resulting window
reaches from <code>mass[cur_index-halfWindowSize]</code> to
<code>mass[cur_index+halfWindowSize]</code>.
</p>
</dd>
<dt><code>"ConvexHull"</code>:</dt><dd>
<p>The baseline estimation is based on a convex hull constructed below the
spectrum.
</p>
</dd>
<dt><code>"median"</code>:</dt><dd>
<p>This baseline estimation uses a moving median. It is based on
<code><a href="stats.html#topic+runmed">runmed</a></code>. The additional argument <code>halfWindowSize</code>
corresponds to the <code>k</code> argument in <code><a href="stats.html#topic+runmed">runmed</a></code>
(<code>k = 2 * halfWindowSize + 1</code>) and controls the half size of the
moving window. The resulting window reaches from
<code>mass[cur_index-halfWindowSize]</code> to
<code>mass[cur_index+halfWindowSize]</code>.
</p>
</dd>
</dl>



<h3>Value</h3>

<p>Returns a two column matrix (first column: mass, second column: intensity)
of the estimated baseline.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>References</h3>

<p><code>"SNIP"</code>:<br />
C.G. Ryan, E. Clayton, W.L. Griffin, S.H. Sie, and D.R. Cousens. 1988.
Snip, a statistics-sensitive background treatment for the quantitative analysis
of pixe spectra in geoscience applications.
Nuclear Instruments and Methods in Physics Research Section B:
Beam Interactions with Materials and Atoms, 34(3): 396-402.
</p>
<p>M. Morhac. 2009.
An algorithm for determination of peak regions and baseline elimination in
spectroscopic data.
Nuclear Instruments and Methods in Physics Research Section A:
Accelerators, Spectrometers, Detectors and Associated Equipment, 600(2),
478-487.
</p>
<p><code>"TopHat"</code>:<br />
M. van Herk. 1992.
A Fast Algorithm for Local Minimum and Maximum Filters on Rectangular and
Octagonal Kernels.
Pattern Recognition Letters 13.7: 517-521.
</p>
<p>J. Y. Gil and M. Werman. 1996.
Computing 2-Dimensional Min, Median and Max Filters.
IEEE Transactions: 504-507.
</p>
<p><code>"ConvexHull"</code>:<br />
Andrew, A. M. 1979.
Another efficient algorithm for convex hulls in two dimensions.
Information Processing Letters, 9(5), 216-219.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>,
<code><a href="#topic+removeBaseline+2CMassSpectrum-method">removeBaseline,MassSpectrum-method</a></code>
</p>
<p><code>demo("baseline")</code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## load example data
data("fiedler2009subset", package="MALDIquant")

## choose only the first mass spectrum
s &lt;- fiedler2009subset[[1]]


## SNIP
plot(s)

## estimate baseline
b &lt;- estimateBaseline(s, method="SNIP", iterations=100)

## draw baseline on the plot
lines(b, col="red")


## TopHat
plot(s)

## estimate baseline (try different parameters)
b1 &lt;- estimateBaseline(s, method="TopHat", halfWindowSize=75)
b2 &lt;- estimateBaseline(s, method="TopHat", halfWindowSize=150)

## draw baselines on the plot
lines(b1, col=2)
lines(b2, col=3)

## draw legend
legend(x="topright", lwd=1, legend=paste0("halfWindowSize=", c(75, 150)),
       col=c(2, 3))


## ConvexHull
plot(s)

## estimate baseline
b &lt;- estimateBaseline(s, method="ConvexHull")

## draw baseline on the plot
lines(b, col="red")


## Median
plot(s)

## estimate baseline
b &lt;- estimateBaseline(s, method="median")

## draw baseline on the plot
lines(b, col="red")
</code></pre>

<hr>
<h2 id='estimateNoise-methods'>Estimates the noise of a MassSpectrum object.</h2><span id='topic+estimateNoise'></span><span id='topic+estimateNoise+2CMassSpectrum-method'></span>

<h3>Description</h3>

<p>This method estimates the noise of mass spectrometry data
(represented by a <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object).<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MassSpectrum'
estimateNoise(object,
  method=c("MAD", "SuperSmoother"),
  ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimateNoise-methods_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object</p>
</td></tr>
<tr><td><code id="estimateNoise-methods_+3A_method">method</code></td>
<td>
<p>used noise estimation method, one of
<code>"MAD"</code> or <code>"SuperSmoother"</code>.
</p>
</td></tr>
<tr><td><code id="estimateNoise-methods_+3A_...">...</code></td>
<td>
<p>arguments to be passed to <code>method</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt><code>"MAD"</code>:</dt><dd>
<p>This function estimates the noise of mass spectrometry data
by calculating the median absolute deviation, see also
<code><a href="stats.html#topic+mad">mad</a></code>.
</p>
</dd>
<dt><code>"SuperSmoother"</code>:</dt><dd>
<p>This function estimates the noise of mass spectrometry data using
Friedman's Super Smoother. Please refer
<code><a href="stats.html#topic+supsmu">supsmu</a></code> for details and additional arguments.
</p>
</dd>
</dl>



<h3>Value</h3>

<p>Returns a two column matrix (first column: mass, second column: intensity)
of the estimated noise.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>,
<code><a href="#topic+detectPeaks+2CMassSpectrum-method">detectPeaks,MassSpectrum-method</a></code>,
<code><a href="stats.html#topic+mad">mad</a></code>,
<code><a href="stats.html#topic+supsmu">supsmu</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## load example data
data("fiedler2009subset", package="MALDIquant")

## choose only the first mass spectrum
s &lt;- fiedler2009subset[[1]]

## transform intensities
s &lt;- transformIntensity(s, method="sqrt")

## remove baseline
s &lt;- removeBaseline(s)

## plot spectrum
plot(s)

## estimate noise
nm &lt;- estimateNoise(s, method="MAD")
nss &lt;- estimateNoise(s, method="SuperSmoother")

## draw noise on the plot
lines(nm, col=2)
lines(nss, col=4)

## draw legend
legend(x="topright", lwd=1, legend=c("MAD", "SuperSmoother"),
       col=c(2, 4))
</code></pre>

<hr>
<h2 id='fiedler2009subset'>Example Mass Spectra (raw)</h2><span id='topic+fiedler2009subset'></span>

<h3>Description</h3>

<p>This dataset contains 16 example mass spectra.
It is used to demonstrate the usage of <code><a href="#topic+MALDIquant-package">MALDIquant-package</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fiedler2009subset)</code></pre>


<h3>Format</h3>

<p>A list containing 16 <code><a href="#topic+MassSpectrum-class">MassSpectrum-class</a></code>
objects.</p>


<h3>Details</h3>

<p>The dataset is a subset of data used in <em>Fiedler et al 2009</em>. <br />
It contains spectra of 8 different patients (each one has 2 technical
replicates).
</p>

<table>
<tr>
 <td style="text-align: right;">
list_index  </td><td style="text-align: left;"> laboratory </td><td style="text-align: left;"> patient_id </td><td style="text-align: left;"> sex    </td><td style="text-align: left;"> age </td><td style="text-align: left;"> type   </td>
</tr>
<tr>
 <td style="text-align: right;">
1           </td><td style="text-align: left;"> Leipzig    </td><td style="text-align: left;"> LC77       </td><td style="text-align: left;"> male   </td><td style="text-align: left;"> 37  </td><td style="text-align: left;"> control</td>
</tr>
<tr>
 <td style="text-align: right;">
2           </td><td style="text-align: left;"> Leipzig    </td><td style="text-align: left;"> LC77       </td><td style="text-align: left;"> male   </td><td style="text-align: left;"> 37  </td><td style="text-align: left;"> control</td>
</tr>
<tr>
 <td style="text-align: right;">
3           </td><td style="text-align: left;"> Leipzig    </td><td style="text-align: left;"> LC213      </td><td style="text-align: left;"> female </td><td style="text-align: left;"> 51  </td><td style="text-align: left;"> control</td>
</tr>
<tr>
 <td style="text-align: right;">
4           </td><td style="text-align: left;"> Leipzig    </td><td style="text-align: left;"> LC213      </td><td style="text-align: left;"> female </td><td style="text-align: left;"> 51  </td><td style="text-align: left;"> control</td>
</tr>
<tr>
 <td style="text-align: right;">
5           </td><td style="text-align: left;"> Leipzig    </td><td style="text-align: left;"> LT178      </td><td style="text-align: left;"> male   </td><td style="text-align: left;"> 58  </td><td style="text-align: left;"> cancer </td>
</tr>
<tr>
 <td style="text-align: right;">
6           </td><td style="text-align: left;"> Leipzig    </td><td style="text-align: left;"> LT178      </td><td style="text-align: left;"> male   </td><td style="text-align: left;"> 58  </td><td style="text-align: left;"> cancer </td>
</tr>
<tr>
 <td style="text-align: right;">
7           </td><td style="text-align: left;"> Leipzig    </td><td style="text-align: left;"> LT157      </td><td style="text-align: left;"> male   </td><td style="text-align: left;"> 60  </td><td style="text-align: left;"> cancer </td>
</tr>
<tr>
 <td style="text-align: right;">
8           </td><td style="text-align: left;"> Leipzig    </td><td style="text-align: left;"> LT157      </td><td style="text-align: left;"> male   </td><td style="text-align: left;"> 60  </td><td style="text-align: left;"> cancer </td>
</tr>
<tr>
 <td style="text-align: right;">
9           </td><td style="text-align: left;"> Heidelberg </td><td style="text-align: left;"> HC49       </td><td style="text-align: left;"> male   </td><td style="text-align: left;"> 43  </td><td style="text-align: left;"> control</td>
</tr>
<tr>
 <td style="text-align: right;">
10          </td><td style="text-align: left;"> Heidelberg </td><td style="text-align: left;"> HC49       </td><td style="text-align: left;"> male   </td><td style="text-align: left;"> 43  </td><td style="text-align: left;"> control</td>
</tr>
<tr>
 <td style="text-align: right;">
11          </td><td style="text-align: left;"> Heidelberg </td><td style="text-align: left;"> HC54       </td><td style="text-align: left;"> female </td><td style="text-align: left;"> 71  </td><td style="text-align: left;"> control</td>
</tr>
<tr>
 <td style="text-align: right;">
12          </td><td style="text-align: left;"> Heidelberg </td><td style="text-align: left;"> HC54       </td><td style="text-align: left;"> female </td><td style="text-align: left;"> 71  </td><td style="text-align: left;"> control</td>
</tr>
<tr>
 <td style="text-align: right;">
13          </td><td style="text-align: left;"> Heidelberg </td><td style="text-align: left;"> HT151      </td><td style="text-align: left;"> male   </td><td style="text-align: left;"> 53  </td><td style="text-align: left;"> cancer </td>
</tr>
<tr>
 <td style="text-align: right;">
14          </td><td style="text-align: left;"> Heidelberg </td><td style="text-align: left;"> HT151      </td><td style="text-align: left;"> male   </td><td style="text-align: left;"> 53  </td><td style="text-align: left;"> cancer </td>
</tr>
<tr>
 <td style="text-align: right;">
15          </td><td style="text-align: left;"> Heidelberg </td><td style="text-align: left;"> HT429      </td><td style="text-align: left;"> female </td><td style="text-align: left;"> 58  </td><td style="text-align: left;"> cancer </td>
</tr>
<tr>
 <td style="text-align: right;">
16          </td><td style="text-align: left;"> Heidelberg </td><td style="text-align: left;"> HT429      </td><td style="text-align: left;"> female </td><td style="text-align: left;"> 58  </td><td style="text-align: left;"> cancer </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>



<h3>References</h3>

<p>G.M. Fiedler, A.B. Leichtle, J. Kase, S. Baumann, U. Ceglarek, K. Felix,
T. Conrad, H. Witzigmann, A. Weimann, C. Schtte, J. Hauss, M. Bchler
and J. Thiery
<br />
&ldquo;Serum Peptidome Profiling Revealed Platelet Factor 4 as a Potential
Discriminating Peptide Associated with Pancreatic Cancer&rdquo; <br />
Clinical Cancer Research, 11(15): 3812-3819, 2009 <br />
ISSN 1557-3265; <a href="https://doi.org/10.1158/1078-0432.CCR-08-2701">doi:10.1158/1078-0432.CCR-08-2701</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MassSpectrum-class">MassSpectrum-class</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>

<hr>
<h2 id='filterPeaks'>
Removes less frequent peaks.
</h2><span id='topic+filterPeaks'></span>

<h3>Description</h3>

<p>This function removes infrequently occuring peaks in a list of
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filterPeaks(l, minFrequency, minNumber, labels, mergeWhitelists=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filterPeaks_+3A_l">l</code></td>
<td>

<p><code>list</code>, list of <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects.
</p>
</td></tr>
<tr><td><code id="filterPeaks_+3A_minfrequency">minFrequency</code></td>
<td>

<p><code>double</code>, remove all peaks which occur in less than
<code>minFrequency*length(l)</code> <code><a href="#topic+MassPeaks-class">MassPeaks</a></code>
objects. It is a relative threshold.
</p>
</td></tr>
<tr><td><code id="filterPeaks_+3A_minnumber">minNumber</code></td>
<td>

<p><code>double</code>, remove all peaks which occur in less than
<code>minNumber</code> <code><a href="#topic+MassPeaks-class">MassPeaks</a></code>
objects. It is an absolute threshold.
</p>
</td></tr>
<tr><td><code id="filterPeaks_+3A_labels">labels</code></td>
<td>

<p><code>factor</code>, (one for each <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object)
to do groupwise filtering. The <em>levels</em> of the factor
<code>label</code> define the groups. If not specified a single group is assumed.
</p>
</td></tr>
<tr><td><code id="filterPeaks_+3A_mergewhitelists">mergeWhitelists</code></td>
<td>

<p><code>logical</code>, if <code>FALSE</code> the filtering criteria are applied
groupwise. If <code>TRUE</code> peaks that survive the filtering in one group
(level of <code>labels</code>) these peaks are also kept in other groups even if
their frequencies are below <code>minFrequency</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code>mergeWhitelists=FALSE</code> the filtering uses a separate peak whitelist
for each group specified by <code>labels</code>, and is done independently in each
group. For <code>mergeWhitelists=TRUE</code> the peak whitelists are combined,
which means that peaks that occur frequently in at least one group are also
kept in all other groups.
</p>
<p>If both <code>minFrequency</code> and <code>minNumber</code> arguments are specified the
more stringent threshold is used.
</p>


<h3>Value</h3>

<p>Returns a <code><a href="base.html#topic+list">list</a></code> of filtered
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+intensityMatrix">intensityMatrix</a></code>,
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## create four MassPeaks objects and add them to the list
p &lt;- list(createMassPeaks(mass=1:2, intensity=1:2),
          createMassPeaks(mass=1:3, intensity=1:3),
          createMassPeaks(mass=1:4, intensity=1:4),
          createMassPeaks(mass=1:5, intensity=1:5))

## only keep peaks which occur in all MassPeaks objects
filteredPeaks &lt;- filterPeaks(p, minFrequency=1)

## compare result
intensities &lt;- intensityMatrix(filteredPeaks)

## peaks at mass 3,4,5 are removed
all(dim(intensities) == c(4, 2)) # TRUE
all(intensities[,1] == 1)        # TRUE
all(intensities[,2] == 2)        # TRUE

## only keep peaks which occur in all MassPeaks objects in a group
## (e.g. useful for technical replicates)
groups &lt;- factor(c("a", "a", "b", "b"), levels=c("a", "b"))
filteredPeaks &lt;- filterPeaks(p, minFrequency=1, labels=groups)

## peaks at mass 3 were removed in group "a"
filteredPeaks[groups == "a"]

## peaks at mass 5 were removed in group "b"
filteredPeaks[groups == "b"]

## only keep peaks which occur at least twice in a group
groups &lt;- factor(c("a", "a", "b", "b", "b"), levels=c("a", "b"))
filteredPeaks &lt;- filterPeaks(c(p, p[[3]]), minNumber=2, labels=groups)

## peaks at mass 3 were removed in group "a"
filteredPeaks[groups == "a"]

## peaks at mass 5 were removed in group "b"
filteredPeaks[groups == "b"]

## apply different minFrequency arguments to each group
groups &lt;- factor(c("a", "a", "b", "b", "b"), levels=c("a", "b"))
filteredPeaks &lt;- filterPeaks(c(p, p[[3]]), minFrequency=c(1, 2/3), labels=groups)
intensityMatrix(filteredPeaks)
#     1 2  3  4
#[1,] 1 2 NA NA
#[2,] 1 2 NA NA
#[3,] 1 2  3  4
#[4,] 1 2  3  4
#[4,] 1 2  3  4


## demonstrate the use of mergeWhitelists
groups &lt;- factor(c("a", "a", "b", "b"), levels=c("a", "b"))

## default behaviour
filteredPeaks &lt;- filterPeaks(p, minNumber=2, labels=groups)
intensityMatrix(filteredPeaks)
#     1 2  3  4
#[1,] 1 2 NA NA
#[2,] 1 2 NA NA
#[3,] 1 2  3  4
#[4,] 1 2  3  4

## use mergeWhitelists=TRUE to keep peaks of group "a" that match all filtering
## criteria in group "b"
## (please note that mass == 3 is not removed in the second MassPeaks object)
filteredPeaks &lt;- filterPeaks(p, minNumber=2, labels=groups,
                             mergeWhitelists=TRUE)
intensityMatrix(filteredPeaks)
#     1 2  3  4
#[1,] 1 2 NA NA
#[2,] 1 2  3 NA
#[3,] 1 2  3  4
#[4,] 1 2  3  4
</code></pre>

<hr>
<h2 id='findEmptyMassObjects'>
Finds or removes empty AbstractMassObject objects in a list.
</h2><span id='topic+findEmptyMassObjects'></span><span id='topic+removeEmptyMassObjects'></span>

<h3>Description</h3>

<p>These functions looks for empty <code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> objects
in a <code><a href="base.html#topic+list">list</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findEmptyMassObjects(l)

removeEmptyMassObjects(l)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findEmptyMassObjects_+3A_l">l</code></td>
<td>

<p><code>list</code>, list of <code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> where empty
objects should be found or removed.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>findEmptyMassObjects</code>: Returns a <code><a href="base.html#topic+vector">vector</a></code> of indices referring to empty
<code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> objects.
</p>
<p><code>removeEmptyMassObjects</code>: Returns a <code><a href="base.html#topic+list">list</a></code> of
<code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> objects but without empty ones.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+isEmpty+2CAbstractMassObject-method">isEmpty,AbstractMassObject-method</a></code>,
<code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## create list
peakList &lt;- list()

## create two MassPeaks objects and add them to the list
peakList[[1]] &lt;- createMassPeaks(mass=1:100, intensity=1:100,
                                 metaData=list(name="example 1"))
peakList[[2]] &lt;- createMassPeaks(mass=1:100, intensity=1:100,
                                 metaData=list(name="example 2"))

## find empty objects (there should not be any one)
findEmptyMassObjects(peakList)

## add an empty MassPeaks object to the list
peakList[[3]] &lt;- createMassPeaks(mass=double(), intensity=double(),
                                 metaData=list(name="empty MassPeaks object"))

## look for empty objects (isEmptyIdx == 3)
(isEmptyIdx &lt;- findEmptyMassObjects(peakList))

## to remove all empty MassObjects from a list
length(peakList) # 3
peakList &lt;- removeEmptyMassObjects(peakList)
length(peakList) # 2; WARNING: all indices could changed
</code></pre>

<hr>
<h2 id='intensityMatrix'>
Converts a list of MassPeaks objects into a matrix.
</h2><span id='topic+intensityMatrix'></span>

<h3>Description</h3>

<p>This function converts a <code><a href="base.html#topic+list">list</a></code> of
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects into a <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intensityMatrix(peaks, spectra)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="intensityMatrix_+3A_peaks">peaks</code></td>
<td>

<p><code>list</code>, list of <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects.
</p>
</td></tr>
<tr><td><code id="intensityMatrix_+3A_spectra">spectra</code></td>
<td>

<p><code>list</code>, list of <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> objects. If a peak
is missing the corresponding intensity value of the spectrum is used. If
<code>spectra</code> is missing <code>NA</code> is used instead.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>peaks</code> have to be binned by <code><a href="#topic+binPeaks">binPeaks</a></code> before
calling <code><a href="#topic+intensityMatrix">intensityMatrix</a></code>.
</p>


<h3>Value</h3>

<p>Returns a <code><a href="base.html#topic+matrix">matrix</a></code> containing intensities of all
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects of <code>peaks</code> and interpolated
intensity values for missing peaks if <code>spectra</code> was given or <code>NA</code>
otherwise. <br />
The <code><a href="base.html#topic+matrix">matrix</a></code> has <code>length(peaks)</code> rows
(one row for each sample) and <code>length(unique(mass))</code> columns.
There is an additional attribute <code>"mass"</code> that stores the mass values.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+binPeaks">binPeaks</a></code>,
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code>,
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## create example MassPeaks objects
p &lt;- list(createMassPeaks(mass=1:4,
                          intensity=11:14,
                          metaData=list(name="test mass peaks 1")),
          createMassPeaks(mass=2:5,
                          intensity=22:25,
                          metaData=list(name="test mass peaks 2")))

## converts MassPeaks objects into a matrix
intensityMatrix(p)


## realistic example

## load example data
data("fiedler2009subset", package="MALDIquant")

## transform intensities
s &lt;- transformIntensity(fiedler2009subset, method="sqrt")

## smoothing spectrum
s &lt;- smoothIntensity(s, method="MovingAverage")

## remove baseline
s &lt;- removeBaseline(s)

## call peak detection
p &lt;- detectPeaks(s)

## bin peaks
p &lt;- binPeaks(p)

## convert MassPeaks objects into a matrix with missing intensity
## values
intensityMatrix(p)

## convert MassPeaks and MassSpectrum objects into a matrix without
## missing intensity values
intensityMatrix(p, s)
</code></pre>

<hr>
<h2 id='isMassSpectrum'>
Tests for MassSpectrum or MassPeaks object.
</h2><span id='topic+isMassSpectrum'></span><span id='topic+isMassPeaks'></span>

<h3>Description</h3>

<p>These functions test for a <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> or
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isMassSpectrum(x)

isMassPeaks(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isMassSpectrum_+3A_x">x</code></td>
<td>

<p>object to be tested.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns <code><a href="base.html#topic+TRUE">TRUE</a></code> or <code><a href="base.html#topic+FALSE">FALSE</a></code> depending on whether its
argument is an <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> or
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MassPeaks-class">MassPeaks</a></code>,
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>,
<code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## create a MassPeaks object
peaks &lt;- createMassPeaks(mass=1:100, intensity=1:100,
                         metaData=list(name="example 1"))

## test
isMassPeaks(peaks)      # returns TRUE
isMassSpectrum(peaks)   # returns FALSE
isMassPeaks(double())   # returns FALSE
</code></pre>

<hr>
<h2 id='isMassSpectrumList'>
Tests a list of MassSpectrum or MassPeaks objects.
</h2><span id='topic+isMassSpectrumList'></span><span id='topic+isMassPeaksList'></span>

<h3>Description</h3>

<p>These functions test a <code><a href="base.html#topic+list">list</a></code> whether containing
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> or <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>
objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isMassSpectrumList(x)

isMassPeaksList(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isMassSpectrumList_+3A_x">x</code></td>
<td>

<p>object to be tested.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns <code><a href="base.html#topic+TRUE">TRUE</a></code> or <code><a href="base.html#topic+FALSE">FALSE</a></code> depending on whether its
argument is a <code><a href="base.html#topic+list">list</a></code> of <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>
or <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MassPeaks-class">MassPeaks</a></code>,
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>,
<code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## create list
p &lt;- list()

## test list
isMassPeaksList(p) # returns FALSE

## create two MassPeaks objects and add them to the list
p &lt;- createMassPeaks(mass=1:100, intensity=1:100,
                     metaData=list(name="example 1"))
p &lt;- createMassPeaks(mass=1:100, intensity=1:100,
                     metaData=list(name="example 2"))

## test list
isMassPeaksList(p)    # returns TRUE
isMassSpectrumList(p) # returns FALSE
</code></pre>

<hr>
<h2 id='labelPeaks-methods'>Draws peak labels to plot.</h2><span id='topic+labelPeaks'></span><span id='topic+labelPeaks+2CMassPeaks-method'></span>

<h3>Description</h3>

<p><code><a href="#topic+labelPeaks">labelPeaks</a></code> draws the corresponding mass values on top
of the peaks stored in a <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object to a plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MassPeaks'
labelPeaks(object,
  index,
  mass,
  labels,
  digits=3, underline=TRUE,
  verticalOffset=abs(diff(par("usr")[3:4]))*0.01,
  absoluteVerticalPos,
  adj=c(0.5, 0), cex=0.7, srt=0,
  avoidOverlap=FALSE,
  arrowLength=0, arrowLwd=0.5, arrowCol=1,
  ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="labelPeaks-methods_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object.</p>
</td></tr>
<tr><td><code id="labelPeaks-methods_+3A_index">index</code></td>
<td>
<p><code>integer</code>/<code>logical</code>, indices of peaks to label.</p>
</td></tr>
<tr><td><code id="labelPeaks-methods_+3A_mass">mass</code></td>
<td>
<p><code>numeric</code>, mass of peaks to label.</p>
</td></tr>
<tr><td><code id="labelPeaks-methods_+3A_labels">labels</code></td>
<td>
<p><code>character</code>, use <code>labels</code> instead of mass values as
peak label.</p>
</td></tr>
<tr><td><code id="labelPeaks-methods_+3A_digits">digits</code></td>
<td>
<p><code>integer</code>, number of decimal places.</p>
</td></tr>
<tr><td><code id="labelPeaks-methods_+3A_underline">underline</code></td>
<td>
<p>logical, underline peak values?</p>
</td></tr>
<tr><td><code id="labelPeaks-methods_+3A_verticaloffset">verticalOffset</code></td>
<td>
<p><code>numeric</code>, move label vertically (relative to
peak height).</p>
</td></tr>
<tr><td><code id="labelPeaks-methods_+3A_absoluteverticalpos">absoluteVerticalPos</code></td>
<td>
<p><code>numeric</code>, absolute <code>y</code> value for the
label. If missing <code>verticalOffset</code> is used.</p>
</td></tr>
<tr><td><code id="labelPeaks-methods_+3A_adj">adj</code></td>
<td>
<p><code>numeric</code>, adjust text to the left, center, right and top,
center, bottom; see <code><a href="graphics.html#topic+text">text</a></code>.</p>
</td></tr>
<tr><td><code id="labelPeaks-methods_+3A_cex">cex</code></td>
<td>
<p><code>numeric</code>, font size, see <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="labelPeaks-methods_+3A_srt">srt</code></td>
<td>
<p><code>numeric</code>, the label rotation in degrees.</p>
</td></tr>
<tr><td><code id="labelPeaks-methods_+3A_avoidoverlap">avoidOverlap</code></td>
<td>
<p><code>logical</code>, try to find label coordinates to avoid
overlap.</p>
</td></tr>
<tr><td><code id="labelPeaks-methods_+3A_arrowlength">arrowLength</code>, <code id="labelPeaks-methods_+3A_arrowlwd">arrowLwd</code>, <code id="labelPeaks-methods_+3A_arrowcol">arrowCol</code></td>
<td>
<p>arrow parameters, possible vectors.
<code>NA</code> values in <code>arrowCol</code> cause the arrow to be omitted, see
<code><a href="graphics.html#topic+arrows">arrows</a></code>.</p>
</td></tr>
<tr><td><code id="labelPeaks-methods_+3A_...">...</code></td>
<td>
<p>arguments to be passed to <code><a href="graphics.html#topic+text">text</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please note that <code>avoidOverlap = TRUE</code> is just supported for
<code>srt %% 90 == 0</code> (means <code>srt</code> has to be a multiple of 90 degree).
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb</p>


<h3>See Also</h3>

<p><code><a href="#topic+MassPeaks-class">MassPeaks</a></code>,
<code><a href="#topic+plot+2CAbstractMassObject+2Cmissing-method">plot,AbstractMassObject,missing-method</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## create a MassPeaks object from scratch
p &lt;- createMassPeaks(mass=1:20, intensity=sample(x=100:10000, size=20),
                     metaData=list(name="example"))

## plot peaks
plot(p)

## label the first 5 peaks
labelPeaks(p, index=1:5)

## label all peaks in mass range 15 to 20
labelPeaks(p, mass=15:20, underline=FALSE)

## label highest peaks (top 5)
top5 &lt;- intensity(p) %in% sort(intensity(p), decreasing=TRUE)[1:5]
labelPeaks(p, index=top5, col="red")


## real example
data("fiedler2009subset")

## a simplified preprocessing
r &lt;- removeBaseline(fiedler2009subset[[1]])
p &lt;- detectPeaks(r)
plot(p)

## label highest peaks (top 10) and avoid label overlap
top10 &lt;- sort(intensity(p), decreasing=TRUE, index.return=TRUE)$ix[1:10]
labelPeaks(p, index=top10, avoidOverlap=TRUE, digits=1)

## use own labels and rotate by 90 degree
plot(p)
labelPeaks(p, index=top10, labels=paste("TOP", 1:10), underline=FALSE,
           srt=90, adj=c(0, 0.5), col=2)
</code></pre>

<hr>
<h2 id='MALDIquant-defunct'>Removed Functions/Methods in Package <span class="pkg">MALDIquant</span></h2><span id='topic+MALDIquant-defunct'></span>

<h3>Description</h3>

<p>These functions/methods are removed.
</p>


<h3>Details</h3>


<dl>
<dt><code>plotImsSlice</code></dt><dd><p>use <code><a href="#topic+plotMsiSlice">plotMsiSlice</a></code>
instead.</p>
</dd>
<dt>totalIonCurrent</dt><dd><p><code>signature(object = "MassPeaks")</code>: removed.</p>
</dd>
<dt>totalIonCurrent&lt;-</dt><dd><p><code>signature(object = "AbstractMassObject",
      value = "numeric")</code>:
use <code><a href="#topic+calibrateIntensity">calibrateIntensity</a></code> instead.</p>
</dd>
<dt>calibrate</dt><dd><p><code>signature(x = "matrix")</code>:
use <code><a href="#topic+calibrateIntensity">calibrateIntensity</a></code> instead.</p>
</dd>
<dt>standardizeTotalIonCurrent</dt><dd><p><code>signature(object = "list")</code>:
use <code><a href="#topic+calibrateIntensity">calibrateIntensity</a></code> instead.</p>
</dd>
<dt>ltrim</dt><dd>
<p><code>signature(object = "AbstractMassObject", minMass = "numeric")</code>:
use <code><a href="#topic+trim">trim</a></code> instead.</p>
</dd>
<dt>rtrim</dt><dd>
<p>use <code><a href="#topic+trim">trim</a></code> instead.</p>
</dd>
<dt>mergeMassSpectra</dt><dd><p>use <code><a href="#topic+averageMassSpectra">averageMassSpectra</a></code>
instead.</p>
</dd>
<dt>movingAverage</dt><dd><p>use <code><a href="#topic+smoothIntensity">smoothIntensity</a></code>
instead.</p>
</dd>
<dt>savitzkyGolay</dt><dd><p>use <code><a href="#topic+smoothIntensity">smoothIntensity</a></code>
instead.</p>
</dd>
<dt>isMassObject</dt><dd><p>removed.</p>
</dd>
<dt>isMassObjectList</dt><dd><p>removed.</p>
</dd>
<dt>intensityMatrix</dt><dd>
<p>does not support <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> objects anymore.</p>
</dd>
</dl>


<hr>
<h2 id='MALDIquant-deprecated'>Deprecated Functions/Methods in Package <span class="pkg">MALDIquant</span></h2><span id='topic+MALDIquant-deprecated'></span>

<h3>Description</h3>

<p>These functions/methods are provided for compatibility with older versions
<code><a href="#topic+MALDIquant">MALDIquant</a></code> only, and may be defunct as soon as the next release.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+Deprecated">Deprecated</a></code>
</p>

<hr>
<h2 id='MALDIquant-parallel'>Parallel Support in Package <span class="pkg">MALDIquant</span></h2><span id='topic+MALDIquant-parallel'></span>

<h3>Description</h3>

<p><code><a href="#topic+MALDIquant">MALDIquant</a></code> offers multi-core support using
<code><a href="parallel.html#topic+mclapply">mclapply</a></code> and <code><a href="parallel.html#topic+mcmapply">mcmapply</a></code>. This
approach is limited to unix-based platforms.
</p>
<p>Please note that not all functions benfit from parallelisation. Often the
overhead to create/copy objects outrun the time saving of parallel runs. This
is true for functions that are very fast to compute (e.g.
<code>sqrt</code>-transformation). That's why the default value for the
<code>mc.cores</code> argument in all functions is <code>1L</code>.
It depends on the size of the dataset which step (often only
<code><a href="#topic+removeBaseline">removeBaseline</a></code> and
<code><a href="#topic+detectPeaks">detectPeaks</a></code>) benefits from parallelisation. <br />
In general it is faster to encapsulate the complete workflow into a function
and parallelise it using <code><a href="parallel.html#topic+mclapply">mclapply</a></code> instead of using the
<code>mc.cores</code> argument of each method. The reason is the reduced overhead
for object management (only one split/combine is needed instead of doing these
operations in each function again and again).
</p>


<h3>Details</h3>


<p>The following functions/methods support the <code>mc.cores</code> argument:
</p>

<ul>
<li><p><code><a href="#topic+trim+2Clist+2Cnumeric-method">trim,list,numeric-method</a></code>
</p>
</li>
<li><p><code><a href="#topic+transformIntensity+2Clist-method">transformIntensity,list-method</a></code>
</p>
</li>
<li><p><code><a href="#topic+smoothIntensity+2Clist-method">smoothIntensity,list-method</a></code>
</p>
</li>
<li><p><code><a href="#topic+removeBaseline+2Clist-method">removeBaseline,list-method</a></code>
</p>
</li>
<li><p><code><a href="#topic+calibrateIntensity+2Clist-method">calibrateIntensity,list-method</a></code>
</p>
</li>
<li><p><code><a href="#topic+detectPeaks+2Clist-method">detectPeaks,list-method</a></code>
</p>
</li>
<li><p><code><a href="#topic+alignSpectra">alignSpectra</a></code>
</p>
</li>
<li><p><code><a href="#topic+averageMassSpectra">averageMassSpectra</a></code>
</p>
</li>
<li><p><code><a href="#topic+mergeMassPeaks">mergeMassPeaks</a></code>
</p>
</li></ul>




<h3>See Also</h3>

<p><code><a href="parallel.html#topic+mclapply">mclapply</a></code>,
<code><a href="parallel.html#topic+mcmapply">mcmapply</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## load package
library("MALDIquant")

## load example data
data("fiedler2009subset", package="MALDIquant")

## run single-core baseline correction
print(system.time(
  b1 &lt;- removeBaseline(fiedler2009subset, method="SNIP")
))

if(.Platform$OS.type == "unix") {
  ## run multi-core baseline correction
  print(system.time(
    b2 &lt;- removeBaseline(fiedler2009subset, method="SNIP", mc.cores=2)
  ))
  stopifnot(all.equal(b1, b2))
}

## parallelise complete workflow
workflow &lt;- function(spectra, cores) {
  s &lt;- transformIntensity(spectra, method="sqrt", mc.cores=cores)
  s &lt;- smoothIntensity(s, method="SavitzkyGolay", halfWindowSize=10,
                       mc.cores=cores)
  s &lt;- removeBaseline(s, method="SNIP", iterations=100, mc.cores=cores)
  s &lt;- calibrateIntensity(s, method="TIC", mc.cores=cores)
  detectPeaks(s, method="MAD", halfWindowSize=20, SNR=2, mc.cores=cores)
}

if(.Platform$OS.type == "unix") {
  ## parallelise the complete workflow is often faster because the overhead is
  ## reduced
  print(system.time(
    p1 &lt;- unlist(parallel::mclapply(fiedler2009subset,
                                    function(x)workflow(list(x), cores=1),
                                    mc.cores=2), use.names=FALSE)
  ))
  print(system.time(
    p2 &lt;- workflow(fiedler2009subset, cores=2)
  ))
  stopifnot(all.equal(p1, p2))
}

## End(Not run)
</code></pre>

<hr>
<h2 id='MassPeaks-class'>Class &quot;MassPeaks&quot;</h2><span id='topic+MassPeaks'></span><span id='topic+MassPeaks-class'></span><span id='topic+snr'></span><span id='topic+snr+2CMassPeaks-method'></span>

<h3>Description</h3>

<p><code><a href="#topic+MassPeaks-class">MassPeaks</a></code> represents extracted peaks of a single
spectrum of a MALDI-TOF mass spectrometry measurement.
</p>


<h3>Objects from the Class</h3>

<p><code><a href="#topic+createMassPeaks">createMassPeaks</a></code>: Creates a
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object.
</p>


<h3>Extends</h3>

<p>Class <code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code>, directly.
</p>


<h3>Slots</h3>


<dl>
<dt><code>snr</code>:</dt><dd><p><code>vector</code>, <em>s</em>ignal-to-<em>n</em>oise
<em>r</em>atio</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>labelPeaks</dt><dd><p><code>signature(x = "MassPeaks")</code>:
Draws peak labels to plot.
See <code><a href="#topic+labelPeaks+2CMassPeaks-method">labelPeaks,MassPeaks-method</a></code> for
details.</p>
</dd>
<dt>monoisotopicPeaks</dt><dd><p><code>signature(x = "MassPeaks")</code>:
Finds monoisotopic peaks in peak lists.
See <code><a href="#topic+monoisotopicPeaks+2CMassPeaks-method">monoisotopicPeaks,MassPeaks-method</a></code> for
details.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+createMassPeaks">createMassPeaks</a></code>,
<code><a href="#topic+detectPeaks+2CMassSpectrum-method">detectPeaks,MassSpectrum-method</a></code>,
<code><a href="#topic+labelPeaks+2CMassPeaks-method">labelPeaks,MassPeaks-method</a></code>,
<code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>

<hr>
<h2 id='MassSpectrum-class'>Class &quot;MassSpectrum&quot;</h2><span id='topic+MassSpectrum'></span><span id='topic+MassSpectrum-class'></span><span id='topic+isRegular'></span><span id='topic+isRegular+2CMassSpectrum-method'></span><span id='topic+totalIonCurrent'></span><span id='topic+totalIonCurrent+2CMassSpectrum-method'></span>

<h3>Description</h3>

<p><code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> represents a single spectrum of a MALDI-TOF
mass spectrometry measurement. It provides an easy framework for doing
some preprocessing steps like peak detection, baseline correction and
much more. <br />
</p>


<h3>Objects from the Class</h3>

<p><code><a href="#topic+createMassSpectrum">createMassSpectrum</a></code>: Creates a
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object.
</p>


<h3>Extends</h3>

<p>Class <code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code>, directly.
</p>


<h3>Methods</h3>


<dl>
<dt>calibrateIntensity</dt><dd><p><code>signature(x = "MassSpectrum")</code>:
Calibrates the intensity of a
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object.
See <code><a href="#topic+calibrateIntensity+2CMassSpectrum-method">calibrateIntensity,MassSpectrum-method</a></code> for
details.</p>
</dd>
<dt>detectPeaks</dt><dd><p><code>signature(x = "MassSpectrum")</code>:
Look for local maxima and estimate noise to extract peaks out of a
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object.
See <code><a href="#topic+detectPeaks+2CMassSpectrum-method">detectPeaks,MassSpectrum-method</a></code> for
details.</p>
</dd>
<dt>estimateBaseline</dt><dd><p><code>signature(x = "MassSpectrum")</code>:
Estimates the baseline of a
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object.
See <code><a href="#topic+estimateBaseline+2CMassSpectrum-method">estimateBaseline,MassSpectrum-method</a></code> for
details.</p>
</dd>
<dt>estimateNoise</dt><dd><p><code>signature(x = "MassSpectrum")</code>:
Estimates the noise of a
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object.
See <code><a href="#topic+estimateNoise+2CMassSpectrum-method">estimateNoise,MassSpectrum-method</a></code> for
details.</p>
</dd>
<dt>isRegular</dt><dd><p><code>signature(object = "MassSpectrum")</code>:
Returns <code>FALSE</code> if the frequency of mass values with irregular
intervals is greater than <code>threshold</code> (because <code>object</code>
was measured in <em>centroid</em> mode or some <code>intensity</code>
values were filtered).</p>
</dd>
<dt>removeBaseline</dt><dd><p><code>signature(x = "MassSpectrum")</code>:
Estimates and removes the baseline of a
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object.
See <code><a href="#topic+removeBaseline+2CMassSpectrum-method">removeBaseline,MassSpectrum-method</a></code> for
details.</p>
</dd>
<dt>smoothIntensity</dt><dd><p><code>signature(object = "MassSpectrum")</code>:
Smoothes the intensities of an <code>MassSpectrum</code> object.
See <code><a href="#topic+smoothIntensity+2CMassSpectrum-method">smoothIntensity,MassSpectrum-method</a></code> for
details.</p>
</dd>
<dt>totalIonCurrent</dt><dd><p><code>signature(object = "MassSpectrum")</code>:
Accessor function for Total Ion Current (TIC, area under the curve).</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+createMassSpectrum">createMassSpectrum</a></code>,
<code><a href="#topic+calibrateIntensity+2CMassSpectrum-method">calibrateIntensity,MassSpectrum-method</a></code>,
<code><a href="#topic+detectPeaks+2CMassSpectrum-method">detectPeaks,MassSpectrum-method</a></code>,
<code><a href="#topic+estimateBaseline+2CMassSpectrum-method">estimateBaseline,MassSpectrum-method</a></code>,
<code><a href="#topic+estimateNoise+2CMassSpectrum-method">estimateNoise,MassSpectrum-method</a></code>,
<code><a href="#topic+removeBaseline+2CMassSpectrum-method">removeBaseline,MassSpectrum-method</a></code>,
<code><a href="#topic+smoothIntensity+2CMassSpectrum-method">smoothIntensity,MassSpectrum-method</a></code>,
<code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## create a MassSpectrum object by default constructor
s &lt;- createMassSpectrum(mass=1:100, intensity=rnorm(100)^2,
                        metaData=list(name="example"))

## show some details
s

## plot spectrum
plot(s)

## get TIC
totalIonCurrent(s)

## modify intensity and metaData
intensity(s)[1:50] &lt;- 0
metaData(s) &lt;- list(name="modified example")

## plot again
plot(s)
</code></pre>

<hr>
<h2 id='match.closest'>Relaxed Value Matching</h2><span id='topic+match.closest'></span>

<h3>Description</h3>

<p><code>match.closest</code> returns a vector of the positions of (first) matches
its first arguments in its second. In contrast to the similar
<code><a href="base.html#topic+match">match</a></code> it just accept <code>numeric</code> arguments but
has an additional <code>tolerance</code> argument that allows relaxed
matching.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>match.closest(x, table, tolerance = Inf, nomatch = NA_integer_)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="match.closest_+3A_x">x</code></td>
<td>
<p><code>numeric</code>, the values to be matched.</p>
</td></tr>
<tr><td><code id="match.closest_+3A_table">table</code></td>
<td>
<p><code>numeric</code>, the values to be matched against. In contrast to
<code><a href="base.html#topic+match">match</a></code> <code>table</code> has to be sorted in increasing order.</p>
</td></tr>
<tr><td><code id="match.closest_+3A_tolerance">tolerance</code></td>
<td>
<p><code>numeric</code>, accepted tolerance. Use <code>Inf</code> to match without
restrictions. Could be of length one or the same length as <code>table</code>.</p>
</td></tr>
<tr><td><code id="match.closest_+3A_nomatch">nomatch</code></td>
<td>
<p><code>numeric</code>, if the difference
between the value in <code>x</code> and <code>table</code> is larger than
<code>tolerance</code> <code>nomatch</code> is returned. Has to be of length one.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>integer</code> vector of the same length as <code>x</code> giving the
closest position in <code>table</code> of the first match or <code>nomatch</code> if
there is no match.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+match">match</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("MALDIquant")
match.closest(c(1.1, 1.4, 9.8), 1:10)
# [1]  1  1 10
match.closest(c(1.1, 1.4, 9.8), 1:10, tolerance=0.25)
# [1]  1 NA 10
match.closest(c(1.1, 1.4, 9.8), 1:10, tolerance=0.25, nomatch=0)
# [1]  1  0 10

## this function is most useful if you want to subset an intensityMatrix
## by a few (reference) peaks

## create an example intensityMatrix
im &lt;- matrix(1:10, nrow=2, dimnames=list(NULL, 1:5))
attr(im, "mass") &lt;- 1:5
im
#      1 2 3 4  5
# [1,] 1 3 5 7  9
# [2,] 2 4 6 8 10
# attr(,"mass")
# [1] 1 2 3 4 5

## reference peaks
ref &lt;- c(2.2, 4.8)

im[, match.closest(ref, attr(im, "mass"), tolerance=0.25, nomatch=0)]
#      2  5
# [1,] 3  9
# [2,] 4 10

</code></pre>

<hr>
<h2 id='mergeMassPeaks'>
Merges <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects.
</h2><span id='topic+mergeMassPeaks'></span>

<h3>Description</h3>

<p>This function merges <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mergeMassPeaks(l, labels, method=c("mean", "median", "sum"), ignore.na=TRUE,
               ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mergeMassPeaks_+3A_l">l</code></td>
<td>

<p><code>list</code>, list of <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects.
</p>
</td></tr>
<tr><td><code id="mergeMassPeaks_+3A_labels">labels</code></td>
<td>

<p><code>list</code>, list of <code><a href="base.html#topic+factor">factor</a></code>s (one for each
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object) to do groupwise merging.
</p>
</td></tr>
<tr><td><code id="mergeMassPeaks_+3A_method">method</code></td>
<td>
<p>used merge method.</p>
</td></tr>
<tr><td><code id="mergeMassPeaks_+3A_ignore.na">ignore.na</code></td>
<td>
<p>Should <code>NA</code> (positions where a peak is missing)
ignored (<code>ignore.na=TRUE</code>) or treated as zero
(<code>ignore.na=FALSE</code>)?</p>
</td></tr>
<tr><td><code id="mergeMassPeaks_+3A_...">...</code></td>
<td>
<p>arguments to be passed to underlying functions (currently only
<code>mc.cores</code> is supported).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a single (no <code>labels</code> given) or a <code><a href="base.html#topic+list">list</a></code>
(<code>labels</code> given) of merged <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MassPeaks-class">MassPeaks</a></code>,
<code><a href="#topic+averageMassSpectra">averageMassSpectra</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## create four MassPeaks objects and add them to the list
p &lt;- list(createMassPeaks(mass=1:2, intensity=1:2),
          createMassPeaks(mass=1:3, intensity=1:3),
          createMassPeaks(mass=1:4, intensity=1:4),
          createMassPeaks(mass=1:5, intensity=1:5))

## merge all four MassPeaks objects into a single new one
## by sum their intensities
## (no labels, returns only one new MassPeaks object)
mergedPeaks &lt;- mergeMassPeaks(p, method="sum")

## only merge MassPeaks objects in a group
## (two different labels, returns a list of two new MassPeaks objects)
groups &lt;- factor(c("a", "a", "b", "b"), levels=c("a", "b"))
mergedPeaks &lt;- mergeMassPeaks(p, labels=groups, method="mean")

## the same, but treat NA as zero
mergedPeaks &lt;- mergeMassPeaks(p, labels=groups, method="mean", ignore.na=FALSE)
</code></pre>

<hr>
<h2 id='monoisotopicPeaks-methods'>Finds monoisotopic peaks in a MassPeaks object.</h2><span id='topic+monoisotopicPeaks'></span><span id='topic+monoisotopicPeaks+2CMassPeaks-method'></span><span id='topic+monoisotopicPeaks+2Clist-method'></span>

<h3>Description</h3>

<p>This method looks for monoisotopic peaks in peak list data
(represented by a <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects).<br />
It is based on the poisson model for isotopic patterns described in Breen et al
2000.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MassPeaks'
monoisotopicPeaks(object,
  minCor=0.95, tolerance=1e-4, distance=1.00235, size=3L:10L)
## S4 method for signature 'list'
monoisotopicPeaks(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="monoisotopicPeaks-methods_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object or a <code>list</code> of
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects.</p>
</td></tr>
<tr><td><code id="monoisotopicPeaks-methods_+3A_mincor">minCor</code></td>
<td>
<p><code>double</code>, minimal correlation between the peak pattern
generated by the model and the experimental peaks in the
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object to be recognized as isotopic pattern.</p>
</td></tr>
<tr><td><code id="monoisotopicPeaks-methods_+3A_tolerance">tolerance</code></td>
<td>
<p><code>double</code>, maximal relative deviation of peaks
position (mass) to be considered as isotopic distance (
<code>abs(((mass[i]+distance)-mass[i+1])/mass[i]) &lt; tolerance</code>).</p>
</td></tr>
<tr><td><code id="monoisotopicPeaks-methods_+3A_distance">distance</code></td>
<td>
<p><code>double</code>, distance between two consecutive peaks in an
isotopic pattern (default value taken from Park et al 2008). Could contain
more than one value, e.g. <code>distance=(1:3)^-1</code> to find isotopic
patterns for multiple charged patterns (e.g. 1+, 2+, and 3+). Please note
that the order matters here if there is a monoisotopic peak for charge
state 1 and 3 it would be reported as charge 1 for
<code>distance=(1:3)^-1</code> and as 3 for <code>distance=(3:1)^-1</code>
respectively.</p>
</td></tr>
<tr><td><code id="monoisotopicPeaks-methods_+3A_size">size</code></td>
<td>
<p><code>double</code>, size (length) of isotopic pattern, longer patterns
are prefered over shorter ones.</p>
</td></tr>
<tr><td><code id="monoisotopicPeaks-methods_+3A_...">...</code></td>
<td>
<p>arguments to be passed to
<code><a href="#topic+monoisotopicPeaks+2CMassPeaks-method">monoisotopicPeaks,MassPeaks-method</a></code>. If
<code>object</code> is a <code>list</code> <code>mc.cores</code> is also supported.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object with monoisotopic peaks only.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>References</h3>

<p>K. Park, J.Y. Yoon, S. Lee, E. Paek, H. Park, H.J. Jung, and S.W. Lee. 2008.
Isotopic peak intensity ratio based algorithm for determination of isotopic
clusters and monoisotopic masses of polypeptides from high-resolution
mass spectrometric data.
Analytical Chemistry, 80: 7294-7303.
</p>
<p>E.J. Breen, F.G. Hopwood, K.L. Williams, and M.R. Wilkins. 2000.
Automatic poisson peak harvesting for high throughput protein identification.
Electrophoresis 21: 2243-2251.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MassPeaks-class">MassPeaks</a></code>,
<code><a href="#topic+detectPeaks+2CMassSpectrum-method">detectPeaks,MassSpectrum-method</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## create example peaks
p &lt;- createMassPeaks(mass=995:1005,
                     intensity=c(100, 10, 30, 10, 40, # noise
                                 550, 330, 110, 10,   # isotopic pattern
                                 5, 15))              # more noise
m &lt;- monoisotopicPeaks(p)
as.matrix(m)

## plot the peaks and mark the monoisotopic one
plot(p)
points(m, col=2, pch=4)
</code></pre>

<hr>
<h2 id='msiSlices'>Turn a list of AbstractMassObjects into a mass spectrometry imaging
slice.</h2><span id='topic+msiSlices'></span>

<h3>Description</h3>

<p>This function turns a mass spectrometry imaging dataset represented by a
<code>list</code> of <code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> objects into an
<code><a href="#topic+intensityMatrix">intensityMatrix</a></code> for each slice (stored in an
<code>array</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msiSlices(x, center, tolerance, method=c("sum", "mean", "median"), adjust=TRUE)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="msiSlices_+3A_x">x</code></td>
<td>
<p>a <code>list</code> of <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>/
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects.</p>
</td></tr>
<tr><td><code id="msiSlices_+3A_center">center</code></td>
<td>
<p><code>double</code>, the <code>center</code> mass value of each slice.</p>
</td></tr>
<tr><td><code id="msiSlices_+3A_tolerance">tolerance</code></td>
<td>
<p><code>double</code>, specifies the thickness of the slices
(<code>center + c(-tolerance, tolerance)</code>).</p>
</td></tr>
<tr><td><code id="msiSlices_+3A_method">method</code></td>
<td>
<p>used aggregation function.</p>
</td></tr>
<tr><td><code id="msiSlices_+3A_adjust">adjust</code></td>
<td>
<p><code>logical</code>, if <code>TRUE</code> the lowest coordinates of the
mass spectrometry imaging dataset are set to <code>c(x=1, y=1)</code> to avoid
<code>NA</code> values at the borders.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>/<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object in
<code>x</code> must contain a <code>list</code> named <code>imaging</code> with an element
<code>pos</code> that stores the <code>x</code> and <code>y</code> value of the spectrum, e.g.:
</p>
<pre>
&gt; metaData(spectra[[1]])$imaging$pos
x y
1 5
</pre>


<h3>Value</h3>

<p>Returns an <code><a href="base.html#topic+array">array</a></code> of three dimensions. The first and second
dimensions contains the x and y coordinates of the image. The third dimension
represents the index of the <code>center</code> of each slice. There are two
additional attributes, namely <code>"center"</code> and <code>"tolerance"</code> which store
the original <code>center</code> and <code>tolerance</code> information.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code>,
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>,
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code>,
<code><a href="#topic+coordinates+2CAbstractMassObject-method">coordinates,AbstractMassObject-method</a></code>,
<code><a href="#topic+plotMsiSlice+2Clist-method">plotMsiSlice,list-method</a></code>
</p>
<p>Please find real examples on:
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>
<p>Vignette: <a href="https://github.com/sgibb/MALDIquantExamples/raw/master/inst/doc/nyakas2013.pdf">https://github.com/sgibb/MALDIquantExamples/raw/master/inst/doc/nyakas2013.pdf</a>
</p>
<p>Shiny: <a href="https://github.com/sgibb/ims-shiny/">https://github.com/sgibb/ims-shiny/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## load example data
data("fiedler2009subset", package="MALDIquant")

## please note: this is NOT a MSI data set
## we just add some coordinates for demonstration
coordinates(fiedler2009subset) &lt;- cbind(x=rep(1:4, 2), y=rep(1:2, each=4))

slices &lt;- msiSlices(fiedler2009subset, center=c(5864.49, 8936.97),
                    tolerance=0.25)

slices
</code></pre>

<hr>
<h2 id='plot-methods'>Plots an AbstractMassObject object.</h2><span id='topic+plot+2CAbstractMassObject+2Cmissing-method'></span><span id='topic+plot+2CMassSpectrum+2Cmissing-method'></span>

<h3>Description</h3>

<p>This is an overloaded method to allow plotting of an
<code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AbstractMassObject,missing'
plot(x, col="black",
   xlab=expression(italic(m/z)), ylab="intensity",
   type=ifelse(isMassPeaks(x), "h", "l"),
   xlim=c(ifelse(length(x@mass), min(x@mass, na.rm=TRUE), 0),
      ifelse(length(x@mass), max(x@mass, na.rm=TRUE), 1)),
   ylim=c(0, ifelse(length(x@intensity), max(x@intensity, na.rm=TRUE), 1)),
   main=x@metaData$name, sub=x@metaData$file,
   cex.sub=0.75, col.sub="#808080", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot-methods_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object.</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_col">col</code></td>
<td>
<p>line colour, see <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_xlab">xlab</code></td>
<td>
<p>title for the x-axis, see <code><a href="graphics.html#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_ylab">ylab</code></td>
<td>
<p>title for the y-axis, see <code><a href="graphics.html#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_type">type</code></td>
<td>
<p>type of plot: see <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_xlim">xlim</code></td>
<td>
<p>the x limits (x1, x2) of the plot, see
<code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_ylim">ylim</code></td>
<td>
<p>the y limits (y1, y2) of the plot, see
<code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_main">main</code></td>
<td>
<p>title for the plot, see <code><a href="graphics.html#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_sub">sub</code></td>
<td>
<p>sub title for the plot, see <code><a href="graphics.html#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_cex.sub">cex.sub</code></td>
<td>
<p>sub title font size, see <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_col.sub">col.sub</code></td>
<td>
<p>sub title color, see <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_...">...</code></td>
<td>
<p>arguments to be passed to <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## create a MassSpectrum object by default constructor
s &lt;- createMassSpectrum(mass=1:100, intensity=rnorm(100)^2,
                        metaData=list(name="example"))

## show some details
s

## plot spectrum
plot(s)
</code></pre>

<hr>
<h2 id='plotMsiSlice-methods'>Plots a Mass Spectrometry Imaging dataset.</h2><span id='topic+plotMsiSlice'></span><span id='topic+plotMsiSlice+2Clist-method'></span><span id='topic+plotMsiSlice+2Carray-method'></span><span id='topic+plotMsiSlice+2Cmatrix-method'></span>

<h3>Description</h3>

<p>This function allows to plot a slice of a mass spectrometry imaging dataset
represented by a <code>list</code> of <code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> objects
or an <code>array</code> or a <code>matrix</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'list'
plotMsiSlice(x, center, tolerance,
  colRamp=colorRamp(c("black", "blue", "green", "yellow", "red")),
  interpolate=FALSE, legend=TRUE, alignLabels=FALSE, combine=FALSE,
  ...)
## S4 method for signature 'array'
plotMsiSlice(x,
  colRamp=colorRamp(c("black", "blue", "green", "yellow", "red")),
  interpolate=FALSE, legend=TRUE, alignLabels=FALSE, combine=FALSE,
  plotInteractive=FALSE, ...)
## S4 method for signature 'matrix'
plotMsiSlice(x,
  colRamp=colorRamp(c("black", "blue", "green", "yellow", "red")),
  interpolate=FALSE, scale=TRUE, legend=scale, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotMsiSlice-methods_+3A_x">x</code></td>
<td>
<p>The mass spectrometry imaging dataset. It could be a <code>list</code> of
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>/<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects or
an <code>array</code> (e.g. generated by <code><a href="#topic+msiSlices">msiSlices</a></code>) or
a <code>matrix</code>.</p>
</td></tr>
<tr><td><code id="plotMsiSlice-methods_+3A_center">center</code></td>
<td>
<p><code>double</code>, if <code>x</code> is a <code>list</code> of
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>/<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects
this argument represent the <em>center</em> mass value of the slices,
see <code><a href="#topic+msiSlices">msiSlices</a></code> for details.</p>
</td></tr>
<tr><td><code id="plotMsiSlice-methods_+3A_tolerance">tolerance</code></td>
<td>
<p><code>double</code>, if <code>center</code> is given <code>tolerance</code>
specifies the thickness of the slices (<code>center + c(-tolerance,
    tolerance)</code>), see <code><a href="#topic+msiSlices">msiSlices</a></code> for details.</p>
</td></tr>
<tr><td><code id="plotMsiSlice-methods_+3A_colramp">colRamp</code></td>
<td>
<p>colours as <code>colorRamp</code> <code>function</code>, see
<code><a href="grDevices.html#topic+colorRamp">colorRamp</a></code> for details. If <code>combine=TRUE</code>
multiple colour functions must be applied as <code>list</code> with an length that
equals the number of given centers.</p>
</td></tr>
<tr><td><code id="plotMsiSlice-methods_+3A_interpolate">interpolate</code></td>
<td>
<p><code>logical</code>, use linear interpolation when drawing the
image, see <code><a href="graphics.html#topic+rasterImage">rasterImage</a></code> for details.</p>
</td></tr>
<tr><td><code id="plotMsiSlice-methods_+3A_scale">scale</code></td>
<td>
<p><code>logical</code>, if <code>TRUE</code> all values are divided by the
maximal value of the slice to get values between 0 and 1.</p>
</td></tr>
<tr><td><code id="plotMsiSlice-methods_+3A_legend">legend</code></td>
<td>
<p><code>logical</code>, if <code>TRUE</code> a reference color gradient is
plotted on the right hand side of the plot. The upper color represents the
highest value in the slice and the lower color the lowest value
respectively. The <code>legend</code> is disabled if <code>scale=FALSE</code>.</p>
</td></tr>
<tr><td><code id="plotMsiSlice-methods_+3A_alignlabels">alignLabels</code></td>
<td>
<p><code>logical</code>, if <code>combine=TRUE</code> and
<code>alignLabels=TRUE</code> the center positions below the legend are aligned
on the right margin otherwise the aligned to their corresponding gradient.</p>
</td></tr>
<tr><td><code id="plotMsiSlice-methods_+3A_combine">combine</code></td>
<td>
<p><code>logical</code>, if <code>TRUE</code> multiple centers are plotted in
one image. Therefore it would be necessary to apply a list of <code>colRamp</code>
functions (one function for each center). The intensity values for each
center of each pixel are compared against each other and the highest scaled
intensity determines the center (and the corresponding <code>colRamp</code>).</p>
</td></tr>
<tr><td><code id="plotMsiSlice-methods_+3A_plotinteractive">plotInteractive</code></td>
<td>

<p><code>logical</code>, if the slice <code>array</code> contains multiple centers,
<code>combine=FALSE</code> and an interactive plotting device is used a warning is
thrown and only the first center would be plotted. Use
<code>plotInteractive=TRUE</code> to overwrite this behaviour and to plot multiple
centers on an interactive device.</p>
</td></tr>
<tr><td><code id="plotMsiSlice-methods_+3A_...">...</code></td>
<td>
<p>arguments to be passed to <code><a href="graphics.html#topic+plot">plot</a></code>, e.g.
<code>main</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>/<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object in
<code>x</code> must contain a <code>list</code> named <code>imaging</code> with an element
<code>pos</code> that stores the <code>x</code> and <code>y</code> value of the spectrum, e.g.:
</p>
<pre>
&gt; metaData(spectra[[1]])$imaging$pos
x y
1 5
</pre>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code>,
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>,
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code>,
<code><a href="#topic+coordinates+2CAbstractMassObject-method">coordinates,AbstractMassObject-method</a></code>,
<code><a href="#topic+msiSlices">msiSlices</a></code>,
<code><a href="#topic+plot+2CMassSpectrum+2Cmissing-method">plot,MassSpectrum,missing-method</a></code>
</p>
<p>Please find real examples on:
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>
<p>Vignette: <a href="https://github.com/sgibb/MALDIquantExamples/raw/master/inst/doc/nyakas2013.pdf">https://github.com/sgibb/MALDIquantExamples/raw/master/inst/doc/nyakas2013.pdf</a>
</p>
<p>Shiny: <a href="https://github.com/sgibb/ims-shiny/">https://github.com/sgibb/ims-shiny/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## load example data
data("fiedler2009subset", package="MALDIquant")

## please note: this is NOT a MSI data set
## we just add some coordinates for demonstration
coordinates(fiedler2009subset) &lt;- cbind(x=rep(1:4, 2), y=rep(1:2, each=4))

plotMsiSlice(fiedler2009subset, center=8936.97, tolerance=0.25)

plotMsiSlice(fiedler2009subset, center=c(5864.49, 8936.97), tolerance=0.25,
             combine=TRUE,
             colRamp=list(colorRamp(c("#000000", "#FF00FF")),
                          colorRamp(c("#000000", "#00FF00"))))
</code></pre>

<hr>
<h2 id='referencePeaks'>
Creates a reference <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object.
</h2><span id='topic+referencePeaks'></span>

<h3>Description</h3>

<p>This function creates a reference <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> object (also
called <em>Anchor Peaks</em>) from a list of <code><a href="#topic+MassPeaks-class">MassPeaks</a></code>
objects.<br />
Generally it is a combination of <code><a href="#topic+binPeaks">binPeaks</a></code> and
<code><a href="#topic+filterPeaks">filterPeaks</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>referencePeaks(l, method=c("strict", "relaxed"), minFrequency=0.9,
               tolerance=0.002)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="referencePeaks_+3A_l">l</code></td>
<td>

<p><code>list</code>, list of <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects.
</p>
</td></tr>
<tr><td><code id="referencePeaks_+3A_method">method</code></td>
<td>

<p>bin creation rule (see <code><a href="#topic+binPeaks">binPeaks</a></code>).
</p>
</td></tr>
<tr><td><code id="referencePeaks_+3A_minfrequency">minFrequency</code></td>
<td>

<p><code>double</code>, remove all peaks which occur in less than
<code>minFrequency*length(l)</code> <code><a href="#topic+MassPeaks-class">MassPeaks</a></code>
objects.
</p>
</td></tr>
<tr><td><code id="referencePeaks_+3A_tolerance">tolerance</code></td>
<td>

<p><code>double</code>, maximal relative deviation of a peak position (mass) to be
considered as identical. Must be multiplied by <code>10^-6</code> for ppm,
e.g. use <code>tolerance=5e-6</code> for 5 ppm.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a new <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects. <br />
The <code><a href="#topic+intensity">intensity</a></code> slot of the returned
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> represents the frequency of this mass position
in all samples.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+binPeaks">binPeaks</a></code>,
<code><a href="#topic+filterPeaks">filterPeaks</a></code>,
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## create four MassPeaks objects and add them to the list
p&lt;- list(createMassPeaks(mass=1:2, intensity=1:2),
         createMassPeaks(mass=1:3, intensity=1:3),
         createMassPeaks(mass=1:4, intensity=1:4),
         createMassPeaks(mass=1:5, intensity=1:5))

## only use peaks which occur in all MassPeaks objects as reference peaks
refPeaks &lt;- referencePeaks(p, minFrequency=1)

mass(refPeaks)      # 1:2
intensity(refPeaks) # c(1, 1)
</code></pre>

<hr>
<h2 id='removeBaseline-methods'>Removes the baseline of a MassSpectrum object.</h2><span id='topic+removeBaseline'></span><span id='topic+removeBaseline+2CMassSpectrum-method'></span><span id='topic+removeBaseline+2Clist-method'></span>

<h3>Description</h3>

<p>This method removes the baseline of mass spectrometry data
(represented by a <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object).<br />
The intensity of the mass spectrometry data would be reduced by
<code>baseline</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MassSpectrum'
removeBaseline(object,
  method=c("SNIP", "TopHat", "ConvexHull", "median"),
  ...)
## S4 method for signature 'list'
removeBaseline(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeBaseline-methods_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object or a <code>list</code> of
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> objects.</p>
</td></tr>
<tr><td><code id="removeBaseline-methods_+3A_method">method</code></td>
<td>
<p>used baseline estimation method, one of
<code>"SNIP"</code>, <code>"TopHat"</code>, <code>"ConvexHull"</code> or <code>"median"</code>. See
<code><a href="#topic+estimateBaseline+2CMassSpectrum-method">estimateBaseline,MassSpectrum-method</a></code> for details.
</p>
</td></tr>
<tr><td><code id="removeBaseline-methods_+3A_...">...</code></td>
<td>
<p>arguments to be passed to
<code><a href="#topic+estimateBaseline+2CMassSpectrum-method">estimateBaseline,MassSpectrum-method</a></code>. If
<code>object</code> is a <code>list</code> <code>mc.cores</code> is also supported.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a modified <code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object with reduced
intensities.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>,
<code><a href="#topic+estimateBaseline+2CMassSpectrum-method">estimateBaseline,MassSpectrum-method</a></code>
</p>
<p><code>demo("baseline")</code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## load example data
data("fiedler2009subset", package="MALDIquant")

## choose only the first mass spectrum
s &lt;- fiedler2009subset[[1]]

## plot spectrum
plot(s)

## subtract baseline
b &lt;- removeBaseline(s, method="SNIP")

## draw modified spectrum on the plot
lines(b, col="blue")
</code></pre>

<hr>
<h2 id='smoothIntensity-methods'>Smoothes intensities of a MassSpectrum object.</h2><span id='topic+smoothIntensity'></span><span id='topic+smoothIntensity+2CMassSpectrum-method'></span><span id='topic+smoothIntensity+2Clist-method'></span>

<h3>Description</h3>

<p>This method smoothes the intensity values of a
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MassSpectrum'
smoothIntensity(object,
  method=c("SavitzkyGolay", "MovingAverage"), halfWindowSize,
  ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="smoothIntensity-methods_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> object or a
<code>list</code> of <code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> objects.</p>
</td></tr>
<tr><td><code id="smoothIntensity-methods_+3A_method">method</code></td>
<td>
<p>used smoothing method, one of <code>"SavitzkyGolay"</code> or
<code>"MovingAverage"</code>.</p>
</td></tr>
<tr><td><code id="smoothIntensity-methods_+3A_halfwindowsize">halfWindowSize</code></td>
<td>
<p>half window size. The resulting
window reaches from <code>mass[currentIndex-halfWindowSize]</code> to
<code>mass[currentIndex+halfWindowSize]</code> (window size is
<code>2*halfWindowSize+1</code>).
The best size differs depending on the selected <code>method</code>.</p>
</td></tr>
<tr><td><code id="smoothIntensity-methods_+3A_...">...</code></td>
<td>
<p>arguments to be passed to <code>method</code>. <code>SavitzkyGolay</code> has
an additional <code>polynomialOrder</code> argument (default: <code>3</code>) to control
the order of the filter.
<code>MovingAverage</code> has an additional <code>weighted</code> argument (default:
<code>FALSE</code>) to indicate if the average should be equal weight (default) or
if it should have weights depending on the distance from the center as
calculated as <code>1/2^abs(-halfWindowSize:halfWindowSize)</code> with the sum
of all weigths normalized to 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>halfWindowSize</code>: Depends on the selected <code>method</code>.
For the <code>SavitzkyGolay</code> the <code>halfWindowSize</code> should be smaller than
<em>FWHM</em> of the peaks (full width at half maximum; please find details in
Bromba and Ziegler 1981).
In general the <code>halfWindowSize</code> for the <code>MovingAverage</code> has to be
much smaller than for <code>SavitzkyGolay</code> to conserve the peak shape.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>
<p>Weighted moving average: Sigurdur Smarason
</p>


<h3>References</h3>

<p>A. Savitzky and M. J. Golay. 1964.
Smoothing and differentiation of data by simplified least squares procedures.
Analytical chemistry, 36(8), 1627-1639.
</p>
<p>M. U. Bromba and H. Ziegler. 1981.
Application hints for Savitzky-Golay digital smoothing filters.
Analytical Chemistry, 53(11), 1583-1586.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## load example data
data("fiedler2009subset", package="MALDIquant")

## smooth spectra
s &lt;- smoothIntensity(fiedler2009subset, method="MovingAverage",
                     halfWindowSize=2)
## or
s &lt;- smoothIntensity(fiedler2009subset, method="MovingAverage",
                     halfWindowSize=2, weighted=TRUE)
## or
s &lt;- smoothIntensity(fiedler2009subset, method="SavitzkyGolay",
                     halfWindowSize=10)
</code></pre>

<hr>
<h2 id='transformIntensity-methods'>Transforms intensities of an AbstractMassObject object.</h2><span id='topic+transformIntensity'></span><span id='topic+transformIntensity+2CAbstractMassObject-method'></span><span id='topic+transformIntensity+2Clist-method'></span>

<h3>Description</h3>

<p>This method performs a transformation (e.g. sqrt-transformation) on the
intensities of an <code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AbstractMassObject'
transformIntensity(object,
  method=c("sqrt", "log", "log2", "log10"))
## S4 method for signature 'list'
transformIntensity(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transformIntensity-methods_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> object or a
<code>list</code> of <code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> objects.</p>
</td></tr>
<tr><td><code id="transformIntensity-methods_+3A_method">method</code></td>
<td>
<p>used transformation method.</p>
</td></tr>
<tr><td><code id="transformIntensity-methods_+3A_...">...</code></td>
<td>
<p>arguments to be passed to underlying functions. If
<code>object</code> is a <code>list</code> <code>mc.cores</code> is also supported.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code>,
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## load example data
data("fiedler2009subset", package="MALDIquant")

## choose only the first mass spectrum
s &lt;- fiedler2009subset[[1]]

## transform spectrum
t &lt;- transformIntensity(s, method="sqrt")

## plot spectrum
par(mfrow=c(2, 1))
plot(s, main="raw spectrum")
plot(t, main="transformed spectrum")
par(mfrow=c(1, 1))
</code></pre>

<hr>
<h2 id='trim-methods'>Trim an AbstractMassObject object.</h2><span id='topic+trim'></span><span id='topic+trim+2CAbstractMassObject+2Cnumeric-method'></span><span id='topic+trim+2Clist+2Cnumeric-method'></span><span id='topic+trim+2Clist+2Cmissing-method'></span>

<h3>Description</h3>

<p>This method trims an <code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> object.
That is useful if some mass ranges should be excluded from further analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AbstractMassObject,numeric'
trim(object, range)
## S4 method for signature 'list,numeric'
trim(object, range, ...)
## S4 method for signature 'list,missing'
trim(object, range, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trim-methods_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> object or a
<code>list</code> of <code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> objects.</p>
</td></tr>
<tr><td><code id="trim-methods_+3A_range">range</code></td>
<td>
<p><code>numeric</code>, limits of trimming (left/minimal mass,
right/maximal mass). If missing it is automatically determined (largest
overlapping mass range) for a <code>list</code> of
<code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code>.</p>
</td></tr>
<tr><td><code id="trim-methods_+3A_...">...</code></td>
<td>
<p>arguments to be passed to underlying functions (currently only
<code>mc.cores</code> is supported).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code>,
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code>,
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## load example data
data("fiedler2009subset", package="MALDIquant")

## select only one spectrum
s &lt;- fiedler2009subset[[1]]

## remove all mass lower 3000
trim(s, range=c(3000, Inf))

## remove all mass higher 8000
trim(s, range=c(0, 8000))

## remove all mass lower 3000 and higher 8000
trim(s, range=c(3000, 8000))

## choose largest overlapping mass range for all spectra
trim(fiedler2009subset)
</code></pre>

<hr>
<h2 id='warpMassSpectra'>
Run warping functions on AbstractMassObject objects.
</h2><span id='topic+warpMassSpectra'></span><span id='topic+warpMassPeaks'></span>

<h3>Description</h3>

<p>These functions run warping functions on
<code><a href="#topic+AbstractMassObject-class">AbstractMassObject</a></code> objects
(warping is also known as <em>phase correction</em>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>warpMassPeaks(l, w, emptyNoMatches=FALSE)

warpMassSpectra(l, w, emptyNoMatches=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="warpMassSpectra_+3A_l">l</code></td>
<td>

<p><code>list</code>, list of <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> or
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> objects.
</p>
</td></tr>
<tr><td><code id="warpMassSpectra_+3A_w">w</code></td>
<td>

<p>a <code>list</code> of warping functions determined by
<code><a href="#topic+determineWarpingFunctions">determineWarpingFunctions</a></code>. Has to be of the
same length as <code>l</code>.
</p>
</td></tr>
<tr><td><code id="warpMassSpectra_+3A_emptynomatches">emptyNoMatches</code></td>
<td>

<p><code>logical</code>, if <code>TRUE</code> (default: <code>FALSE</code>)
the intensity values of
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> or
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code> objects with missing (<code>NA</code>)
warping functions are set to zero.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The warping function <code>w</code> is called in the following way:
</p>
<p style="text-align: center;"><code class="reqn">newMass = oldMass + w(oldMass)</code>
</p>



<h3>Value</h3>

<p>Returns a <code>list</code> of warped <code><a href="#topic+MassPeaks-class">MassPeaks</a></code> or
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code> objects.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+determineWarpingFunctions">determineWarpingFunctions</a></code>,
<code><a href="#topic+MassPeaks-class">MassPeaks</a></code>,
<code><a href="#topic+MassSpectrum-class">MassSpectrum</a></code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load package
library("MALDIquant")

## create a MassPeaks object
p &lt;- createMassPeaks(mass=1:5, intensity=1:5)

## stupid warping function for demonstration
## (please use determineWarpingFunctions in real life applications)
simpleWarp &lt;- function(x) { return(1) }

## run warping function
w &lt;- warpMassPeaks(list(p), list(simpleWarp))[[1]]

## compare results
all(mass(w) == mass(p)+1) # TRUE

## no warping (MassPeaks object is not changed)
warpMassPeaks(list(p), list(NA))

## no warping (intensity values of MassPeaks object are set to zero)
warpMassPeaks(list(p), list(NA), emptyNoMatches=TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
