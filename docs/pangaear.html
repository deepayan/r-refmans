<!DOCTYPE html><html><head><title>Help for package pangaear</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pangaear}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pangaear-package'><p>Client for the Pangaea Database</p></a></li>
<li><a href='#pg_cache'><p>Caching</p></a></li>
<li><a href='#pg_cache_clear'><p>cache path clear</p></a></li>
<li><a href='#pg_cache_list'><p>cache list</p></a></li>
<li><a href='#pg_data'><p>Download data from Pangaea.</p></a></li>
<li><a href='#pg_get_record'><p>Get record from the Pangaea repository</p></a></li>
<li><a href='#pg_identify'><p>Identify information about the Pangaea repository</p></a></li>
<li><a href='#pg_list_identifiers'><p>List identifiers of the Pangaea repository</p></a></li>
<li><a href='#pg_list_metadata_formats'><p>Get metadata formats from the Pangaea repository</p></a></li>
<li><a href='#pg_list_records'><p>List records from Pangaea</p></a></li>
<li><a href='#pg_list_sets'><p>List the set structure of the Pangaea repository</p></a></li>
<li><a href='#pg_search'><p>Search the Pangaea database</p></a></li>
<li><a href='#pg_search_es'><p>Search the Pangaea database with Elasticsearch</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Client for the 'Pangaea' Database</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools to interact with the 'Pangaea' Database
    (<a href="https://www.pangaea.de">https://www.pangaea.de</a>), including functions for searching for data,
    fetching 'datasets' by 'dataset' 'ID', and working with the 'Pangaea'
    'OAI-PMH' service.</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ropensci/pangaear">https://github.com/ropensci/pangaear</a> (devel),
<a href="https://docs.ropensci.org/pangaear/">https://docs.ropensci.org/pangaear/</a> (documentation)</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ropensci/pangaear/issues">https://github.com/ropensci/pangaear/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Imports:</td>
<td>crul (&ge; 0.4.0), jsonlite (&ge; 1.5), xml2 (&ge; 1.1.1), oai (&ge;
0.2.2), tibble (&ge; 1.1), hoardr (&ge; 0.2.0), png</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, testthat, vcr, markdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>X-schema.org-applicationCategory:</td>
<td>Biodiversity</td>
</tr>
<tr>
<td>X-schema.org-keywords:</td>
<td>Pangaea, environmental science, earth science,
archive, paleontology, ecology, chemistry, atmosphere</td>
</tr>
<tr>
<td>X-schema.org-isPartOf:</td>
<td>https://ropensci.org</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-05-14 04:44:12 UTC; sckott</td>
</tr>
<tr>
<td>Author:</td>
<td>Scott Chamberlain <a href="https://orcid.org/0000-0003-1444-9135"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Kara Woo [aut],
  Andrew MacDonald [aut],
  Naupaka Zimmerman [aut],
  Gavin Simpson [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Scott Chamberlain &lt;myrmecocystus@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-05-14 05:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='pangaear-package'>Client for the Pangaea Database</h2><span id='topic+pangaear-package'></span><span id='topic+pangaear'></span>

<h3>Description</h3>

<p><a href="https://www.pangaea.de/">Pangaea database</a>
</p>


<h3>Details</h3>

<p>Package includes tools to interact with the Pangaea Database,
including functions for searching for data, fetching datasets by
dataset ID, working with the Pangaea OAI-PMH service, and
Elasticsearch service.
</p>


<h3>Getting data</h3>

<p>The main workhorse function for getting data is <code><a href="#topic+pg_data">pg_data()</a></code>.
One thing you may want to do is set a different path for caching
the data you download: see <a href="#topic+pg_cache">pg_cache</a> for details
</p>

<hr>
<h2 id='pg_cache'>Caching</h2><span id='topic+pg_cache'></span>

<h3>Description</h3>

<p>Manage cached <code>pangaear</code> files with <span class="pkg">hoardr</span>
</p>


<h3>Details</h3>

<p>The dafault cache directory is
<code>paste0(rappdirs::user_cache_dir(), "/R/pangaear")</code>, but you can set
your own path using <code>cache_path_set()</code>
</p>
<p><code>cache_delete</code> only accepts 1 file name, while
<code>cache_delete_all</code> doesn't accept any names, but deletes all files.
For deleting many specific files, use <code>cache_delete</code> in a <code><a href="base.html#topic+lapply">lapply()</a></code>
type call
</p>


<h3>Useful user functions</h3>


<ul>
<li> <p><code>pg_cache$cache_path_get()</code> get cache path
</p>
</li>
<li> <p><code>pg_cache$cache_path_set()</code> set cache path
</p>
</li>
<li> <p><code>pg_cache$list()</code> returns a character vector of full path file names
</p>
</li>
<li> <p><code>pg_cache$files()</code> returns file objects with metadata
</p>
</li>
<li> <p><code>pg_cache$details()</code> returns files with details
</p>
</li>
<li> <p><code>pg_cache$delete()</code> delete specific files
</p>
</li>
<li> <p><code>pg_cache$delete_all()</code> delete all files, returns nothing
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pg_cache

# list files in cache
pg_cache$list()

# delete certain database files
# pg_cache$delete("file path")
# pg_cache$list()

# delete all files in cache
# pg_cache$delete_all()
# pg_cache$list()

# set a different cache path from the default
# pg_cache$cache_path_set(full_path = "/Foo/Bar")

## End(Not run)
</code></pre>

<hr>
<h2 id='pg_cache_clear'>cache path clear</h2><span id='topic+pg_cache_clear'></span>

<h3>Description</h3>

<p>cache path clear
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pg_cache_clear(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pg_cache_clear_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>

<hr>
<h2 id='pg_cache_list'>cache list</h2><span id='topic+pg_cache_list'></span>

<h3>Description</h3>

<p>cache list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pg_cache_list(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pg_cache_list_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>

<hr>
<h2 id='pg_data'>Download data from Pangaea.</h2><span id='topic+pg_data'></span>

<h3>Description</h3>

<p>Grabs data as a dataframe or list of dataframes from a Pangaea data
repository URI; see: <a href="https://www.pangaea.de/">https://www.pangaea.de/</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pg_data(doi, overwrite = TRUE, mssgs = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pg_data_+3A_doi">doi</code></td>
<td>
<p>DOI of Pangaeae single dataset, or of a collection of datasets.
Expects either just a DOI of the form <code>10.1594/PANGAEA.746398</code>, or with
the URL part in front, like
<a href="https://doi.pangaea.de/10.1594/PANGAEA.746398">https://doi.pangaea.de/10.1594/PANGAEA.746398</a></p>
</td></tr>
<tr><td><code id="pg_data_+3A_overwrite">overwrite</code></td>
<td>
<p>(logical) Ovewrite a file if one is found with the same name</p>
</td></tr>
<tr><td><code id="pg_data_+3A_mssgs">mssgs</code></td>
<td>
<p>(logical) print information messages. Default: <code>TRUE</code></p>
</td></tr>
<tr><td><code id="pg_data_+3A_...">...</code></td>
<td>
<p>Curl options passed on to <a href="crul.html#topic+verb-GET">crul::verb-GET</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data files are stored in an operating system appropriate location.
Run <code>pg_cache$cache_path_get()</code> to get the storage location
on your machine. See <a href="#topic+pg_cache">pg_cache</a> for more information, including how to
set a different base path for downloaded files.
</p>
<p>Some files/datasets require the user to be logged in. For now we
just pass on these - that is, give back nothing other than metadata.
</p>


<h3>Value</h3>

<p>One or more items of class pangaea, each with the doi, parent doi
(if many dois within a parent doi), url, citation, path, and data object.
Data object depends on what kind of file it is. For tabular data, we print
the first 10 columns or so; for a zip file we list the files in the zip
(but leave it up to the user to dig unzip and get files from the zip file);
for png files, we point the user to read the file in with <code><a href="png.html#topic+readPNG">png::readPNG()</a></code>
</p>


<h3>Author(s)</h3>

<p>Naupaka Zimmerman, Scott Chamberlain
</p>


<h3>References</h3>

<p><a href="https://www.pangaea.de">https://www.pangaea.de</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# a single file
(res &lt;- pg_data(doi='10.1594/PANGAEA.807580'))
res[[1]]$doi
res[[1]]$citation
res[[1]]$data
res[[1]]$metadata

# another single file
pg_data(doi='10.1594/PANGAEA.807584')

# Many files
(res &lt;- pg_data(doi='10.1594/PANGAEA.761032'))
res[[1]]
res[[2]]

# Manipulating the cache
## list files in the cache
pg_cache$list()

## clear all data
# pg_cache$delete_all()
pg_cache$list()

## clear a single dataset by DOI
pg_data(doi='10.1594/PANGAEA.812093')
pg_cache$list()
path &lt;- grep("PANGAEA.812093", pg_cache$list(), value = TRUE)
pg_cache$delete(path)
pg_cache$list()

# search for datasets, then pass in DOIs
(searchres &lt;- pg_search(query = 'birds', count = 20))
pg_data(searchres$doi[1])

# png file
pg_data(doi = "10.1594/PANGAEA.825428")

# zip file
pg_data(doi = "10.1594/PANGAEA.860500")

# login required
## we skip file download
pg_data("10.1594/PANGAEA.788547")

## End(Not run)
</code></pre>

<hr>
<h2 id='pg_get_record'>Get record from the Pangaea repository</h2><span id='topic+pg_get_record'></span>

<h3>Description</h3>

<p>Get record from the Pangaea repository
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pg_get_record(identifier, prefix = "oai_dc", as = "df", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pg_get_record_+3A_identifier">identifier</code></td>
<td>
<p>Dataset identifier. See Examples.</p>
</td></tr>
<tr><td><code id="pg_get_record_+3A_prefix">prefix</code></td>
<td>
<p>A character string to specify the metadata format in OAI-PMH
requests issued to the repository. The default (<code>oai_dc</code>) corresponds
to the mandatory OAI unqualified Dublin Core metadata schema.</p>
</td></tr>
<tr><td><code id="pg_get_record_+3A_as">as</code></td>
<td>
<p>(character) What to return. One of &quot;df&quot; (for data.frame; default),
&quot;list&quot;, or &quot;raw&quot; (raw text)</p>
</td></tr>
<tr><td><code id="pg_get_record_+3A_...">...</code></td>
<td>
<p>Curl debugging options passed on to <code><a href="oai.html#topic+get_records">oai::get_records()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>XML character string, data.frame, or list, depending on what
requested with the <code>as</code> parameter
</p>


<h3>References</h3>

<p><a href="https://www.openarchives.org/pmh/">OAI-PMH documentation</a>
</p>


<h3>See Also</h3>

<p>wraps <code><a href="oai.html#topic+get_records">oai::get_records()</a></code>
</p>
<p>Other oai methods: 
<code><a href="#topic+pg_identify">pg_identify</a>()</code>,
<code><a href="#topic+pg_list_identifiers">pg_list_identifiers</a>()</code>,
<code><a href="#topic+pg_list_metadata_formats">pg_list_metadata_formats</a>()</code>,
<code><a href="#topic+pg_list_records">pg_list_records</a>()</code>,
<code><a href="#topic+pg_list_sets">pg_list_sets</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pg_get_record(identifier = "oai:pangaea.de:doi:10.1594/PANGAEA.788382")
pg_get_record(identifier = "oai:pangaea.de:doi:10.1594/PANGAEA.269656",
prefix="iso19139")
pg_get_record(identifier = "oai:pangaea.de:doi:10.1594/PANGAEA.269656",
prefix="dif")

# invalid record id
# pg_get_record(identifier = "oai:pangaea.de:doi:10.1594/PANGAEA.11111")
# pg_get_record(identifier = "oai:pangaea.de:doi:10.1594/PANGAEA.11111",
#   prefix="adfadf")

## End(Not run)
</code></pre>

<hr>
<h2 id='pg_identify'>Identify information about the Pangaea repository</h2><span id='topic+pg_identify'></span>

<h3>Description</h3>

<p>Identify information about the Pangaea repository
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pg_identify(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pg_identify_+3A_...">...</code></td>
<td>
<p>Curl debugging options passed on to <code><a href="oai.html#topic+id">oai::id()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>list
</p>


<h3>References</h3>

<p><a href="https://www.openarchives.org/pmh/">OAI-PMH documentation</a>
</p>


<h3>See Also</h3>

<p>wraps <code><a href="oai.html#topic+id">oai::id()</a></code>
</p>
<p>Other oai methods: 
<code><a href="#topic+pg_get_record">pg_get_record</a>()</code>,
<code><a href="#topic+pg_list_identifiers">pg_list_identifiers</a>()</code>,
<code><a href="#topic+pg_list_metadata_formats">pg_list_metadata_formats</a>()</code>,
<code><a href="#topic+pg_list_records">pg_list_records</a>()</code>,
<code><a href="#topic+pg_list_sets">pg_list_sets</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pg_identify()

## End(Not run)
</code></pre>

<hr>
<h2 id='pg_list_identifiers'>List identifiers of the Pangaea repository</h2><span id='topic+pg_list_identifiers'></span>

<h3>Description</h3>

<p>List identifiers of the Pangaea repository
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pg_list_identifiers(
  prefix = "oai_dc",
  from = NULL,
  until = NULL,
  set = NULL,
  token = NULL,
  as = "df",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pg_list_identifiers_+3A_prefix">prefix</code></td>
<td>
<p>A character string to specify the metadata format in OAI-PMH
requests issued to the repository. The default (<code>oai_dc</code>) corresponds
to the mandatory OAI unqualified Dublin Core metadata schema.</p>
</td></tr>
<tr><td><code id="pg_list_identifiers_+3A_from">from</code></td>
<td>
<p>Character string giving datestamp to be used as lower bound for
datestamp-based selective harvesting (i.e., only harvest records with
datestamps in the given range). Dates and times must be encoded using
ISO 8601. The trailing Z must be used when including time. OAI-PMH implies
UTC for data/time specifications.</p>
</td></tr>
<tr><td><code id="pg_list_identifiers_+3A_until">until</code></td>
<td>
<p>Character string giving a datestamp to be used as an upper
bound, for datestamp-based selective harvesting (i.e., only harvest records
with datestamps in the given range).</p>
</td></tr>
<tr><td><code id="pg_list_identifiers_+3A_set">set</code></td>
<td>
<p>A character string giving a set to be used for selective
harvesting (i.e., only harvest records in the given set).</p>
</td></tr>
<tr><td><code id="pg_list_identifiers_+3A_token">token</code></td>
<td>
<p>(character) a token previously provided by the server to
resume a request where it last left off. 50 is max number of records
returned. We will loop for you internally to get all the records you
asked for.</p>
</td></tr>
<tr><td><code id="pg_list_identifiers_+3A_as">as</code></td>
<td>
<p>(character) What to return. One of &quot;df&quot; (for data.frame; default),
&quot;list&quot;, or &quot;raw&quot; (raw text)</p>
</td></tr>
<tr><td><code id="pg_list_identifiers_+3A_...">...</code></td>
<td>
<p>Curl debugging options passed on to <code><a href="oai.html#topic+list_identifiers">oai::list_identifiers()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>XML character string, data.frame, or list, depending on what
requested with the <code>as</code> parameter
</p>


<h3>References</h3>

<p><a href="https://www.openarchives.org/pmh/">OAI-PMH documentation</a>
</p>


<h3>See Also</h3>

<p>wraps <code><a href="oai.html#topic+list_identifiers">oai::list_identifiers()</a></code>
</p>
<p>Other oai methods: 
<code><a href="#topic+pg_get_record">pg_get_record</a>()</code>,
<code><a href="#topic+pg_identify">pg_identify</a>()</code>,
<code><a href="#topic+pg_list_metadata_formats">pg_list_metadata_formats</a>()</code>,
<code><a href="#topic+pg_list_records">pg_list_records</a>()</code>,
<code><a href="#topic+pg_list_sets">pg_list_sets</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pg_list_identifiers(
  from = paste0(Sys.Date() - 4, "T00:00:00Z"),
  until = paste0(Sys.Date() - 3, "T18:00:00Z")
)
pg_list_identifiers(set="geocode1", from=Sys.Date()-1, until=Sys.Date())
pg_list_identifiers(prefix="iso19139", from=Sys.Date()-1, until=Sys.Date())
pg_list_identifiers(prefix="dif",
  from = paste0(Sys.Date() - 2, "T00:00:00Z"),
  until = paste0(Sys.Date() - 1, "T18:00:00Z")
)

## End(Not run)
</code></pre>

<hr>
<h2 id='pg_list_metadata_formats'>Get metadata formats from the Pangaea repository</h2><span id='topic+pg_list_metadata_formats'></span>

<h3>Description</h3>

<p>Get metadata formats from the Pangaea repository
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pg_list_metadata_formats(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pg_list_metadata_formats_+3A_...">...</code></td>
<td>
<p>Curl debugging options passed on to <code><a href="oai.html#topic+list_metadataformats">oai::list_metadataformats()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame
</p>


<h3>References</h3>

<p><a href="https://www.openarchives.org/pmh/">OAI-PMH documentation</a>
</p>


<h3>See Also</h3>

<p>wraps <code><a href="oai.html#topic+list_metadataformats">oai::list_metadataformats()</a></code>
</p>
<p>Other oai methods: 
<code><a href="#topic+pg_get_record">pg_get_record</a>()</code>,
<code><a href="#topic+pg_identify">pg_identify</a>()</code>,
<code><a href="#topic+pg_list_identifiers">pg_list_identifiers</a>()</code>,
<code><a href="#topic+pg_list_records">pg_list_records</a>()</code>,
<code><a href="#topic+pg_list_sets">pg_list_sets</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pg_list_metadata_formats()

## End(Not run)
</code></pre>

<hr>
<h2 id='pg_list_records'>List records from Pangaea</h2><span id='topic+pg_list_records'></span>

<h3>Description</h3>

<p>List records from Pangaea
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pg_list_records(
  prefix = "oai_dc",
  from = NULL,
  until = NULL,
  set = NULL,
  token = NULL,
  as = "df",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pg_list_records_+3A_prefix">prefix</code></td>
<td>
<p>A character string to specify the metadata format in OAI-PMH
requests issued to the repository. The default (<code>oai_dc</code>) corresponds
to the mandatory OAI unqualified Dublin Core metadata schema.</p>
</td></tr>
<tr><td><code id="pg_list_records_+3A_from">from</code></td>
<td>
<p>Character string giving datestamp to be used as lower bound for
datestamp-based selective harvesting (i.e., only harvest records with
datestamps in the given range). Dates and times must be encoded using
ISO 8601. The trailing Z must be used when including time. OAI-PMH implies
UTC for data/time specifications.</p>
</td></tr>
<tr><td><code id="pg_list_records_+3A_until">until</code></td>
<td>
<p>Character string giving a datestamp to be used as an upper
bound, for datestamp-based selective harvesting (i.e., only harvest records
with datestamps in the given range).</p>
</td></tr>
<tr><td><code id="pg_list_records_+3A_set">set</code></td>
<td>
<p>A character string giving a set to be used for selective
harvesting (i.e., only harvest records in the given set).</p>
</td></tr>
<tr><td><code id="pg_list_records_+3A_token">token</code></td>
<td>
<p>(character) a token previously provided by the server to
resume a request where it last left off. 50 is max number of records
returned. We will loop for you internally to get all the records you
asked for.</p>
</td></tr>
<tr><td><code id="pg_list_records_+3A_as">as</code></td>
<td>
<p>(character) What to return. One of &quot;df&quot; (for data.frame; default),
&quot;list&quot;, or &quot;raw&quot; (raw text)</p>
</td></tr>
<tr><td><code id="pg_list_records_+3A_...">...</code></td>
<td>
<p>Curl debugging options passed on to <code><a href="oai.html#topic+list_records">oai::list_records()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>XML character string, data.frame, or list, depending on what
requested witht the <code>as</code> parameter
</p>


<h3>References</h3>

<p><a href="https://www.openarchives.org/pmh/">OAI-PMH documentation</a>
</p>


<h3>See Also</h3>

<p>wraps <code><a href="oai.html#topic+list_records">oai::list_records()</a></code>
</p>
<p>Other oai methods: 
<code><a href="#topic+pg_get_record">pg_get_record</a>()</code>,
<code><a href="#topic+pg_identify">pg_identify</a>()</code>,
<code><a href="#topic+pg_list_identifiers">pg_list_identifiers</a>()</code>,
<code><a href="#topic+pg_list_metadata_formats">pg_list_metadata_formats</a>()</code>,
<code><a href="#topic+pg_list_sets">pg_list_sets</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pg_list_records(set='citable', from=Sys.Date()-1, until=Sys.Date())

# When no results found &gt; "'noRecordsMatch'"
# pg_list_records(set='geomound', from='2015-01-01', until='2015-01-01')

pg_list_records(prefix="iso19139", set='citable', from=Sys.Date()-1,
  until=Sys.Date())

## FIXME - below are broken
# pg_list_records(prefix="dif", set='citable', from=Sys.Date()-4,
#   until=Sys.Date())
# pg_list_records(prefix="dif", set='project4094', from=Sys.Date()-4,
#   until=Sys.Date())

## End(Not run)
</code></pre>

<hr>
<h2 id='pg_list_sets'>List the set structure of the Pangaea repository</h2><span id='topic+pg_list_sets'></span>

<h3>Description</h3>

<p>List the set structure of the Pangaea repository
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pg_list_sets(token = NULL, as = "df", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pg_list_sets_+3A_token">token</code></td>
<td>
<p>(character) a token previously provided by the server to
resume a request where it last left off. 50 is max number of records
returned. We will loop for you internally to get all the records you
asked for.</p>
</td></tr>
<tr><td><code id="pg_list_sets_+3A_as">as</code></td>
<td>
<p>(character) What to return. One of &quot;df&quot; (for data.frame; default),
&quot;list&quot;, or &quot;raw&quot; (raw text)</p>
</td></tr>
<tr><td><code id="pg_list_sets_+3A_...">...</code></td>
<td>
<p>Curl debugging options passed on to <code><a href="oai.html#topic+list_sets">oai::list_sets()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>XML character string, data.frame, or list, depending on what
requested with the <code>as</code> parameter
</p>


<h3>References</h3>

<p><a href="https://www.openarchives.org/pmh/">OAI-PMH documentation</a>
</p>


<h3>See Also</h3>

<p>wraps <code><a href="oai.html#topic+list_sets">oai::list_sets()</a></code>
</p>
<p>Other oai methods: 
<code><a href="#topic+pg_get_record">pg_get_record</a>()</code>,
<code><a href="#topic+pg_identify">pg_identify</a>()</code>,
<code><a href="#topic+pg_list_identifiers">pg_list_identifiers</a>()</code>,
<code><a href="#topic+pg_list_metadata_formats">pg_list_metadata_formats</a>()</code>,
<code><a href="#topic+pg_list_records">pg_list_records</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pg_list_sets()
pg_list_sets(as = "list")
pg_list_sets(as = "raw")

## End(Not run)
</code></pre>

<hr>
<h2 id='pg_search'>Search the Pangaea database</h2><span id='topic+pg_search'></span>

<h3>Description</h3>

<p>Search the Pangaea database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pg_search(
  query,
  count = 10,
  offset = 0,
  topic = NULL,
  bbox = NULL,
  mindate = NULL,
  maxdate = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pg_search_+3A_query">query</code></td>
<td>
<p>(character) Query terms. You can refine a search by prefixing
the term(s) with a category, one of citation, reference, parameter, event,
project, campaign, or basis. See examples.</p>
</td></tr>
<tr><td><code id="pg_search_+3A_count">count</code></td>
<td>
<p>(integer) Number of items to return. Default: 10. Maximum: 500.
Use <code>offset</code> parameter to page through results - see examples</p>
</td></tr>
<tr><td><code id="pg_search_+3A_offset">offset</code></td>
<td>
<p>(integer) Record number to start at. Default: 0</p>
</td></tr>
<tr><td><code id="pg_search_+3A_topic">topic</code></td>
<td>
<p>(character) topic area: one of NULL (all areas), &quot;Agriculture&quot;,
&quot;Atomosphere&quot;, &quot;Biological Classification&quot;, &quot;Biospshere&quot;, &quot;Chemistry&quot;,
&quot;Cryosphere&quot;, &quot;Ecology&quot;, &quot;Fisheries&quot;, &quot;Geophysics&quot;, &quot;Human Dimensions&quot;,
&quot;Lakes &amp; Rivers&quot;, &quot;Land Surface&quot;, &quot;Lithosphere&quot;, &quot;Oceans&quot;, &quot;Paleontology&quot;</p>
</td></tr>
<tr><td><code id="pg_search_+3A_bbox">bbox</code></td>
<td>
<p>(numeric) A bounding box, of the form: minlon, minlat, maxlon,
maxlat</p>
</td></tr>
<tr><td><code id="pg_search_+3A_mindate">mindate</code>, <code id="pg_search_+3A_maxdate">maxdate</code></td>
<td>
<p>(character) Dates to search for, of the form
&quot;2014-10-28&quot;</p>
</td></tr>
<tr><td><code id="pg_search_+3A_...">...</code></td>
<td>
<p>Curl options passed on to <a href="crul.html#topic+verb-GET">crul::verb-GET</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a thin wrapper around the GUI search interface on the page
<a href="https://www.pangaea.de">https://www.pangaea.de</a>. Everything you can do there, you can do here.
</p>


<h3>Value</h3>

<p>tibble/data.frame with the structure:
</p>

<ul>
<li><p> score: match score, higher is a better match
</p>
</li>
<li><p> doi: the DOI for the data package
</p>
</li>
<li><p> size: size number
</p>
</li>
<li><p> size_measure: size measure, one of &quot;data points&quot; or &quot;datasets&quot;
</p>
</li>
<li><p> citation: citation for the data package
</p>
</li>
<li><p> supplement_to: citation for what the data package is a supplement to
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+pg_search_es">pg_search_es()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pg_search(query='water')
pg_search(query='water', count=2)
pg_search(query='water', count=20)
pg_search(query='water', mindate="2013-06-01", maxdate="2013-07-01")
pg_search(query='water', bbox=c(-124.2, 41.8, -116.8, 46.1))
pg_search(query='reference:Archer')
pg_search(query='parameter:"carbon dioxide"')
pg_search(query='event:M2-track')
pg_search(query='event:TT011_2-CTD31')
pg_search(query='project:Joint Global Ocean Flux Study')
pg_search(query='campaign:M2')
pg_search(query='basis:Meteor')

# paging with count and offset
# max is 500 records per request - if you need &gt; 500, use offset and count
res1 &lt;- pg_search(query = "florisphaera", count = 500, offset = 0)
res2 &lt;- pg_search(query = "florisphaera", count = 500, offset = 500)
res3 &lt;- pg_search(query = "florisphaera", count = 500, offset = 1000)
do.call("rbind.data.frame", list(res1, res2, res3))

# get attributes: maxScore, totalCount, and offset
res &lt;- pg_search(query='water', bbox=c(-124.2, 41.8, -116.8, 46.1))
attributes(res)
attr(res, "maxScore")
attr(res, "totalCount")
attr(res, "offset")

# curl options
pg_search(query='citation:Archer', verbose = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='pg_search_es'>Search the Pangaea database with Elasticsearch</h2><span id='topic+pg_search_es'></span>

<h3>Description</h3>

<p>Search the Pangaea database with Elasticsearch
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pg_search_es(
  query = NULL,
  size = 10,
  from = NULL,
  source = NULL,
  df = NULL,
  analyzer = NULL,
  default_operator = NULL,
  explain = NULL,
  sort = NULL,
  track_scores = NULL,
  timeout = NULL,
  terminate_after = NULL,
  search_type = NULL,
  lowercase_expanded_terms = NULL,
  analyze_wildcard = NULL,
  version = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pg_search_es_+3A_query">query</code></td>
<td>
<p>(character) Query terms..</p>
</td></tr>
<tr><td><code id="pg_search_es_+3A_size">size</code></td>
<td>
<p>(character) The number of hits to return. Pass in as a
character string to avoid problems with large number conversion to
scientific notation. Default: 10. The default maximum is 10,000 - however,
you can change this default maximum by changing the
<code>index.max_result_window</code> index level parameter.</p>
</td></tr>
<tr><td><code id="pg_search_es_+3A_from">from</code></td>
<td>
<p>(character) The starting from index of the hits to return.
Pass in as a character string to avoid problems with large number
conversion to scientific notation. Default: 0</p>
</td></tr>
<tr><td><code id="pg_search_es_+3A_source">source</code></td>
<td>
<p>(character) character vector of fields to return</p>
</td></tr>
<tr><td><code id="pg_search_es_+3A_df">df</code></td>
<td>
<p>(character) The default field to use when no field prefix is
defined within the query.</p>
</td></tr>
<tr><td><code id="pg_search_es_+3A_analyzer">analyzer</code></td>
<td>
<p>(character) The analyzer name to be used when analyzing the
query string.</p>
</td></tr>
<tr><td><code id="pg_search_es_+3A_default_operator">default_operator</code></td>
<td>
<p>(character) The default operator to be used, can be
<code>AND</code> or <code>OR</code>. Default: <code>OR</code></p>
</td></tr>
<tr><td><code id="pg_search_es_+3A_explain">explain</code></td>
<td>
<p>(logical) For each hit, contain an explanation of how
scoring of the hits was computed. Default: <code>FALSE</code></p>
</td></tr>
<tr><td><code id="pg_search_es_+3A_sort">sort</code></td>
<td>
<p>(character) Sorting to perform. Can either be in the form of
fieldName, or <code>fieldName:asc</code>/<code>fieldName:desc</code>. The fieldName
can either be an actual field within the document, or the special
<code style="white-space: pre;">&#8288;_score&#8288;</code> name to indicate sorting based on scores. There can be several
sort parameters (order is important).</p>
</td></tr>
<tr><td><code id="pg_search_es_+3A_track_scores">track_scores</code></td>
<td>
<p>(logical) When sorting, set to <code>TRUE</code> in order to
still track scores and return them as part of each hit.</p>
</td></tr>
<tr><td><code id="pg_search_es_+3A_timeout">timeout</code></td>
<td>
<p>(numeric) A search timeout, bounding the search request to
be executed within the specified time value and bail with the hits
accumulated up to that point when expired. Default: no timeout.</p>
</td></tr>
<tr><td><code id="pg_search_es_+3A_terminate_after">terminate_after</code></td>
<td>
<p>(numeric) The maximum number of documents to collect
for each shard, upon reaching which the query execution will terminate
early. If set, the response will have a boolean field terminated_early to
indicate whether the query execution has actually terminated_early.
Default: no terminate_after</p>
</td></tr>
<tr><td><code id="pg_search_es_+3A_search_type">search_type</code></td>
<td>
<p>(character) The type of the search operation to perform.
Can be <code>query_then_fetch</code> (default) or <code>dfs_query_then_fetch</code>.
Types <code>scan</code> and <code>count</code> are deprecated.</p>
</td></tr>
<tr><td><code id="pg_search_es_+3A_lowercase_expanded_terms">lowercase_expanded_terms</code></td>
<td>
<p>(logical) Should terms be automatically
lowercased or not. Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="pg_search_es_+3A_analyze_wildcard">analyze_wildcard</code></td>
<td>
<p>(logical) Should wildcard and prefix queries be
analyzed or not. Default: <code>FALSE</code></p>
</td></tr>
<tr><td><code id="pg_search_es_+3A_version">version</code></td>
<td>
<p>(logical) Print the document version with each document.</p>
</td></tr>
<tr><td><code id="pg_search_es_+3A_...">...</code></td>
<td>
<p>Curl options passed on to <a href="crul.html#topic+verb-GET">crul::verb-GET</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>An interface to Pangaea's Elasticsearch query interface.
You can also just use <a href="https://github.com/ropensci/elastic">elastic</a>
package to interact with it. The base URL is
https://ws.pangaea.de/es/pangaea/panmd/_search
</p>


<h3>Value</h3>

<p>tibble/data.frame, empty if no results
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pg_search">pg_search()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
(res &lt;- pg_search_es())
attributes(res)
attr(res, "total")
attr(res, "max_score")

pg_search_es(query = 'water', source = c('parentURI', 'minElevation'))
pg_search_es(query = 'water', size = 3)
pg_search_es(query = 'water', size = 3, from = 10)

pg_search_es(query = 'water sky', default_operator = "OR")
pg_search_es(query = 'water sky', default_operator = "AND")

pg_search_es(query = 'water', sort = "minElevation")
pg_search_es(query = 'water', sort = "minElevation:desc")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
