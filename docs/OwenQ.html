<!DOCTYPE html><html><head><title>Help for package OwenQ</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {OwenQ}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#OwenQ1'><p>First Owen Q-function</p></a></li>
<li><a href='#OwenQ2'><p>Second Owen Q-function</p></a></li>
<li><a href='#OwenT'><p>Owen T-function</p></a></li>
<li><a href='#powen'><p>Owen distribution functions when &delta;<sub>1</sub>>&delta;<sub>2</sub></p></a></li>
<li><a href='#psbt'><p>Owen distribution functions</p></a></li>
<li><a href='#ptOwen'><p>Student CDF with integer number of degrees of freedom</p></a></li>
<li><a href='#spowen2'><p>Special case of second Owen distribution function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Owen Q-Function</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.7</td>
</tr>
<tr>
<td>Author:</td>
<td>Stéphane Laurent</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stéphane Laurent &lt;laurent_step@outlook.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Evaluates the Owen Q-function for an integer value of the
    degrees of freedom, by applying Owen's algorithm (1965)
    &lt;<a href="https://doi.org/10.1093%2Fbiomet%2F52.3-4.437">doi:10.1093/biomet/52.3-4.437</a>&gt;.  It is useful for the calculation of
    the power of equivalence tests.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-3-Clause">BSD_3_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/stla/OwenQ">https://github.com/stla/OwenQ</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/stla/OwenQ/issues">https://github.com/stla/OwenQ/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.10), stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, mvtnorm, rmarkdown, testthat</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH, Rcpp, RcppEigen, RcppNumerical</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++17</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-11 11:50:51 UTC; stla</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-11 12:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='OwenQ1'>First Owen Q-function</h2><span id='topic+OwenQ1'></span>

<h3>Description</h3>

<p>Evaluates the first Owen Q-function (integral from <code class="reqn">0</code> to <code class="reqn">R</code>)
for an integer value of the degrees of freedom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OwenQ1(nu, t, delta, R, algo = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OwenQ1_+3A_nu">nu</code></td>
<td>
<p>integer greater than <code class="reqn">1</code>, the number of degrees of freedom</p>
</td></tr>
<tr><td><code id="OwenQ1_+3A_t">t</code></td>
<td>
<p>number, positive or negative, possibly infinite</p>
</td></tr>
<tr><td><code id="OwenQ1_+3A_delta">delta</code></td>
<td>
<p>vector of finite numbers, with the same length as <code>R</code></p>
</td></tr>
<tr><td><code id="OwenQ1_+3A_r">R</code></td>
<td>
<p>(upper bound of the integral) vector of finite positive numbers,
with the same length as <code>delta</code></p>
</td></tr>
<tr><td><code id="OwenQ1_+3A_algo">algo</code></td>
<td>
<p>the algorithm, <code>1</code> or <code>2</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of numbers between <code class="reqn">0</code> and <code class="reqn">1</code>, the values of the
integral from <code class="reqn">0</code> to <code class="reqn">R</code>.
</p>


<h3>Note</h3>

<p>When the number of degrees of freedom is odd, the procedure resorts to
the Owen T-function (<code><a href="#topic+OwenT">OwenT</a></code>).
</p>


<h3>References</h3>

<p>Owen, D. B. (1965).
A special case of a bivariate noncentral t-distribution.
<em>Biometrika</em> <b>52</b>, 437-446.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># As R goes to Inf, OwenQ1(nu, t, delta, R) goes to pt(t, nu, delta):
OwenQ1(nu=5, t=3, delta=2, R=100)
pt(q=3, df=5, ncp=2)
</code></pre>

<hr>
<h2 id='OwenQ2'>Second Owen Q-function</h2><span id='topic+OwenQ2'></span>

<h3>Description</h3>

<p>Evaluates the second Owen Q-function (integral from <code class="reqn">R</code> to <code class="reqn">\infty</code>)
for an integer value of the degrees of freedom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OwenQ2(nu, t, delta, R, algo = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OwenQ2_+3A_nu">nu</code></td>
<td>
<p>integer greater than <code class="reqn">1</code>, the number of degrees of freedom</p>
</td></tr>
<tr><td><code id="OwenQ2_+3A_t">t</code></td>
<td>
<p>number, positive or negative, possibly infinite</p>
</td></tr>
<tr><td><code id="OwenQ2_+3A_delta">delta</code></td>
<td>
<p>vector of finite numbers, with the same length as <code>R</code></p>
</td></tr>
<tr><td><code id="OwenQ2_+3A_r">R</code></td>
<td>
<p>(lower bound of the integral) vector of finite positive numbers,
with the same length as <code>delta</code></p>
</td></tr>
<tr><td><code id="OwenQ2_+3A_algo">algo</code></td>
<td>
<p>the algorirthm used, <code>1</code> or <code>2</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of numbers between <code class="reqn">0</code> and <code class="reqn">1</code>, the values of the integral
from <code class="reqn">R</code> to <code class="reqn">\infty</code>.
</p>


<h3>Note</h3>

<p>When the number of degrees of freedom is odd, the procedure resorts to
the Owen T-function (<code><a href="#topic+OwenT">OwenT</a></code>).
</p>


<h3>References</h3>

<p>Owen, D. B. (1965).
A special case of a bivariate noncentral t-distribution.
<em>Biometrika</em> <b>52</b>, 437-446.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># OwenQ1(nu, t, delta, R) + OwenQ2(nu, t, delta, R) equals pt(t, nu, delta):
OwenQ1(nu=5, t=3, delta=2, R=1) + OwenQ2(nu=5, t=3, delta=2, R=1)
pt(q=3, df=5, ncp=2)
</code></pre>

<hr>
<h2 id='OwenT'>Owen T-function</h2><span id='topic+OwenT'></span>

<h3>Description</h3>

<p>Evaluates the Owen T-function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OwenT(h, a)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OwenT_+3A_h">h</code></td>
<td>
<p>numeric scalar</p>
</td></tr>
<tr><td><code id="OwenT_+3A_a">a</code></td>
<td>
<p>numeric scalar</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a port of the function <code>owens_t</code> of the <strong>boost</strong>
collection of C++ libraries.
</p>


<h3>Value</h3>

<p>A number between <code>0</code> and <code>0.25</code>.
</p>


<h3>References</h3>

<p>Owen, D. B. (1956).
Tables for computing bivariate normal probabilities.
<em>Ann. Math. Statist.</em> <b>27</b>, 1075-1090.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>integrate(function(x) pnorm(1+2*x)^2*dnorm(x), lower=-Inf, upper=Inf)
pnorm(1/sqrt(5)) - 2*OwenT(1/sqrt(5), 1/3)
</code></pre>

<hr>
<h2 id='powen'>Owen distribution functions when &delta;<sub>1</sub>>&delta;<sub>2</sub></h2><span id='topic+powen'></span><span id='topic+powen1'></span><span id='topic+powen2'></span><span id='topic+powen3'></span><span id='topic+powen4'></span>

<h3>Description</h3>

<p>Evaluates the Owen distribution functions
when the noncentrality parameters satisfy &delta;<sub>1</sub>>&delta;<sub>2</sub> and
the number of degrees of freedom is integer.
</p>

<ul>
<li> <p><code>powen1</code> evaluates P(T<sub>1</sub> &le; t<sub>1</sub>, T<sub>2</sub> &le; t<sub>2</sub>)
(Owen's equality 8)
</p>
</li>
<li> <p><code>powen2</code> evaluates P(T<sub>1</sub> &le; t<sub>1</sub>, T<sub>2</sub> > t<sub>2</sub>)
(Owen's equality 9)
</p>
</li>
<li> <p><code>powen3</code> evaluates P(T<sub>1</sub> > t<sub>1</sub>, T<sub>2</sub> > t<sub>2</sub>)
(Owen's equality 10)
</p>
</li>
<li> <p><code>powen4</code> evaluates P(T<sub>1</sub> > t<sub>1</sub>, T<sub>2</sub> &le; t<sub>2</sub>)
(Owen's equality 11)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>powen1(nu, t1, t2, delta1, delta2, algo = 2)

powen2(nu, t1, t2, delta1, delta2, algo = 2)

powen3(nu, t1, t2, delta1, delta2, algo = 2)

powen4(nu, t1, t2, delta1, delta2, algo = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powen_+3A_nu">nu</code></td>
<td>
<p>integer greater than <code class="reqn">1</code>, the number of degrees of freedom;
infinite allowed</p>
</td></tr>
<tr><td><code id="powen_+3A_t1">t1</code>, <code id="powen_+3A_t2">t2</code></td>
<td>
<p>two numbers, positive or negative, possible infinite</p>
</td></tr>
<tr><td><code id="powen_+3A_delta1">delta1</code>, <code id="powen_+3A_delta2">delta2</code></td>
<td>
<p>two vectors of possibly infinite numbers with the same length,
the noncentrality parameters;
must satisfy <code>delta1&gt;delta2</code></p>
</td></tr>
<tr><td><code id="powen_+3A_algo">algo</code></td>
<td>
<p>the algorithm used, <code>1</code> or <code>2</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of numbers between <code class="reqn">0</code> and <code class="reqn">1</code>, possibly
containing some <code>NaN</code>.
</p>


<h3>Note</h3>

<p>When the number of degrees of freedom is odd, the procedure resorts to
the Owen T-function (<code><a href="#topic+OwenT">OwenT</a></code>).
</p>


<h3>References</h3>

<p>Owen, D. B. (1965).
A special case of a bivariate noncentral t-distribution.
<em>Biometrika</em> <b>52</b>, 437-446.
</p>


<h3>See Also</h3>

<p>Use <code><a href="#topic+psbt">psbt</a></code> for general values of <code>delta1</code> and <code>delta2</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nu=5; t1=2; t2=1; delta1=3; delta2=2
# Wolfram integration gives 0.1394458271284726
( p1 &lt;- powen1(nu, t1, t2, delta1, delta2) )
# Wolfram integration gives 0.0353568969628651
( p2 &lt;- powen2(nu, t1, t2, delta1, delta2) )
# Wolfram integration gives 0.806507459306199
( p3 &lt;- powen3(nu, t1, t2, delta1, delta2) )
# Wolfram integration gives 0.018689824158
( p4 &lt;- powen4(nu, t1, t2, delta1, delta2) )
# the sum should be 1
p1+p2+p3+p4
</code></pre>

<hr>
<h2 id='psbt'>Owen distribution functions</h2><span id='topic+psbt'></span><span id='topic+psbt1'></span><span id='topic+psbt2'></span><span id='topic+psbt3'></span><span id='topic+psbt4'></span>

<h3>Description</h3>

<p>Evaluates the Owen cumulative distribution function
for an integer number of degrees of freedom.
</p>

<ul>
<li> <p><code>psbt1</code> evaluates P(T<sub>1</sub> &le; t<sub>1</sub>, T<sub>2</sub> &le; t<sub>2</sub>)
</p>
</li>
<li> <p><code>psbt2</code> evaluates P(T<sub>1</sub> &le; t<sub>1</sub>, T<sub>2</sub> > t<sub>2</sub>)
</p>
</li>
<li> <p><code>psbt3</code> evaluates P(T<sub>1</sub> > t<sub>1</sub>, T<sub>2</sub> > t<sub>2</sub>)
</p>
</li>
<li> <p><code>psbt4</code> evaluates P(T<sub>1</sub> > t<sub>1</sub>, T<sub>2</sub> &le; t<sub>2</sub>)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>psbt1(nu, t1, t2, delta1, delta2, algo = 2)

psbt2(nu, t1, t2, delta1, delta2, algo = 2)

psbt3(nu, t1, t2, delta1, delta2, algo = 2)

psbt4(nu, t1, t2, delta1, delta2, algo = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psbt_+3A_nu">nu</code></td>
<td>
<p>integer greater than <code class="reqn">1</code>, the number of degrees of freedom;
infinite allowed</p>
</td></tr>
<tr><td><code id="psbt_+3A_t1">t1</code>, <code id="psbt_+3A_t2">t2</code></td>
<td>
<p>two numbers, positive or negative, possibly infinite</p>
</td></tr>
<tr><td><code id="psbt_+3A_delta1">delta1</code>, <code id="psbt_+3A_delta2">delta2</code></td>
<td>
<p>two vectors of possibly infinite numbers with the same length,
the noncentrality parameters</p>
</td></tr>
<tr><td><code id="psbt_+3A_algo">algo</code></td>
<td>
<p>the algorithm used, <code>1</code> or <code>2</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of numbers between <code class="reqn">0</code> and <code class="reqn">1</code>,
possibly containing some <code>NaN</code>.
</p>


<h3>Note</h3>

<p>When the number of degrees of freedom is odd, the procedure resorts to
the Owen T-function (<code><a href="#topic+OwenT">OwenT</a></code>).
</p>


<h3>References</h3>

<p>Owen, D. B. (1965).
A special case of a bivariate noncentral t-distribution.
<em>Biometrika</em> <b>52</b>, 437-446.
</p>


<h3>See Also</h3>

<p>It is better to use <code><a href="#topic+powen">powen</a></code> if <code>delta1&gt;delta2</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nu=5; t1=1; t2=2; delta1=2; delta2=3
( p1 &lt;- psbt1(nu, t1, t2, delta1, delta2) )
( p2 &lt;- psbt2(nu, t1, t2, delta1, delta2) )
( p3 &lt;- psbt3(nu, t1, t2, delta1, delta2) )
( p4 &lt;- psbt4(nu, t1, t2, delta1, delta2) )
# the sum should be 1
p1+p2+p3+p4
</code></pre>

<hr>
<h2 id='ptOwen'>Student CDF with integer number of degrees of freedom</h2><span id='topic+ptOwen'></span>

<h3>Description</h3>

<p>Cumulative distribution function of the noncentrel Student
distribution with an integer number of degrees of freedom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ptOwen(q, nu, delta = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ptOwen_+3A_q">q</code></td>
<td>
<p>quantile, a finite number</p>
</td></tr>
<tr><td><code id="ptOwen_+3A_nu">nu</code></td>
<td>
<p>integer greater than <code class="reqn">1</code>, the number of degrees of freedom;
possibly infinite</p>
</td></tr>
<tr><td><code id="ptOwen_+3A_delta">delta</code></td>
<td>
<p>numeric vector of noncentrality parameters; possibly infinite</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector, the CDF evaluated at <code>q</code>.
</p>


<h3>Note</h3>

<p>The results are theoretically exact when the number of degrees of
freedom is even.
When odd, the procedure resorts to the Owen T-function.
</p>


<h3>References</h3>

<p>Owen, D. B. (1965).
A special case of a bivariate noncentral t-distribution.
<em>Biometrika</em> <b>52</b>, 437-446.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ptOwen(2, 3) - pt(2, 3)
ptOwen(2, 3, delta=1) - pt(2, 3, ncp=1)
</code></pre>

<hr>
<h2 id='spowen2'>Special case of second Owen distribution function</h2><span id='topic+spowen2'></span>

<h3>Description</h3>

<p>Evaluation of the second Owen distribution function in a
special case (see details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spowen2(nu, t, delta, algo = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spowen2_+3A_nu">nu</code></td>
<td>
<p>positive integer, possibly infinite</p>
</td></tr>
<tr><td><code id="spowen2_+3A_t">t</code></td>
<td>
<p>positive number</p>
</td></tr>
<tr><td><code id="spowen2_+3A_delta">delta</code></td>
<td>
<p>vector of positive numbers</p>
</td></tr>
<tr><td><code id="spowen2_+3A_algo">algo</code></td>
<td>
<p>the algorithm used, <code>1</code> or <code>2</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The value of <code>spowen2(nu, t, delta)</code> is the same as the value
of <code>powen2(nu, t, -t, delta, -delta)</code>, but it is evaluated more efficiently.
</p>


<h3>Value</h3>

<p>A vector of numbers between 0 and 1.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+powen2">powen2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spowen2(4, 1, 2) == powen2(4, 1, -1, 2, -2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
