<!DOCTYPE html><html lang="en"><head><title>Help for package spphpr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spphpr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ADD'>
<p>Function for Implementing the Accumulated Degree Days Method</p></a></li>
<li><a href='#ADP'>
<p>Function for Implementing the Accumulated Developmental Progress Method</p></a></li>
<li><a href='#ADTS'>
<p>Function for Implementing the Accumulated Days Transferred to a Standardized Temperature Method</p></a></li>
<li><a href='#apricotFFD'>
<p>First flowering date records of <em>Prunus armeniaca</em></p></a></li>
<li><a href='#BJDAT'>
<p>Daily Air Temperature Data of Beijing from 1952 to 2012.</p></a></li>
<li><a href='#predADD'>
<p>Prediction Function of the Accumulated Degree Days Method</p></a></li>
<li><a href='#predADP'>
<p>Prediction Function of the Accumulated Developmental Progress Method</p></a></li>
<li><a href='#predADTS'>
<p>Prediction Function of the Accumulated Days Transferred</p>
to a Standardized Temperature Method</a></li>
<li><a href='#spphpr'>
<p>Spring Phenological Prediction</p></a></li>
<li><a href='#toDOY'>
<p>Function for Transferring a Date to the Value of Day-of-Year</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Spring Phenological Prediction</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-01-06</td>
</tr>
<tr>
<td>Author:</td>
<td>Peijian Shi [aut, cre],
  Zhenghong Chen [aut],
  Brady K. Quinn [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Peijian Shi &lt;pjshi@njfu.edu.cn&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Predicts the occurrence times (in day-of-year) of spring phenological events. Three methods, including the accumulated degree days (ADD) method, the accumulated days transferred to a standardized temperature (ADTS) method, and the accumulated developmental progress (ADP) method, were used. See Shi et al. (2017a) &lt;<a href="https://doi.org/10.1016%2Fj.agrformet.2017.04.001">doi:10.1016/j.agrformet.2017.04.001</a>&gt; and Shi et al. (2017b) &lt;<a href="https://doi.org/10.1093%2Faesa%2Fsax063">doi:10.1093/aesa/sax063</a>&gt; for details.  </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-08 05:12:07 UTC; PEIJIAN SHI</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-08 05:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='ADD'>
Function for Implementing the Accumulated Degree Days Method
</h2><span id='topic+ADD'></span>

<h3>Description</h3>

<p>Estimates the starting date (<code class="reqn">S</code>, in day-of-year) and base tempeature (<code class="reqn">T_{0}</code>, in <code class="reqn">{}^{\circ}</code>C) 
in the accumulated degree days method using mean daily air temperatures (Aono, 1993; Shi et al., 2017a, 2017b).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ADD(S.pd = NULL, T0.arr, Year1, Time, Year2, DOY, Temp, DOY.ul = 120, 
    fig.opt = TRUE, S.def = 54, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ADD_+3A_s.pd">S.pd</code></td>
<td>
<p>the pre-determined starting date for thermal accumulation (in day-of-year)</p>
</td></tr>
<tr><td><code id="ADD_+3A_t0.arr">T0.arr</code></td>
<td>
<p>the candidate base temperatures (in <code class="reqn">{}^{\circ}</code>C)</p>
</td></tr>
<tr><td><code id="ADD_+3A_year1">Year1</code></td>
<td>
<p>the vector of the years in which a particular phenological event was recorded</p>
</td></tr>
<tr><td><code id="ADD_+3A_time">Time</code></td>
<td>
<p>the vector of the occurence times (in day-of-year) of a particular phenological event across many years</p>
</td></tr>
<tr><td><code id="ADD_+3A_year2">Year2</code></td>
<td>
<p>the vector of the years recording the climate data corresponding to the occurrence times</p>
</td></tr>
<tr><td><code id="ADD_+3A_doy">DOY</code></td>
<td>
<p>the vector of the dates (in day-of-year) for which climate data exist</p>
</td></tr>
<tr><td><code id="ADD_+3A_temp">Temp</code></td>
<td>
<p>the mean daily air temperature data (in <code class="reqn">{}^{\circ}</code>C) corresponding to <code>DOY</code></p>
</td></tr>
<tr><td><code id="ADD_+3A_doy.ul">DOY.ul</code></td>
<td>
<p>the upper limit of <code>DOY</code> used to predict the occurrence time</p>
</td></tr>
<tr><td><code id="ADD_+3A_fig.opt">fig.opt</code></td>
<td>
<p>an optional argument to draw the figures associated with the determinations 
of the starting date and base temperature, and a comparision between the predicted and observed occurrence times</p>
</td></tr>
<tr><td><code id="ADD_+3A_s.def">S.def</code></td>
<td>
<p>a mandatory defintion of the starting date when (i) <code>S.pd</code> is NULL 
and (ii) the minimum correlation coefficient method fails to find a suitable starting date</p>
</td></tr>
<tr><td><code id="ADD_+3A_verbose">verbose</code></td>
<td>
<p>an optional argument allowing users to suppress the printing of computation progress</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default of <code>S.pd</code> is NULL. In this case, the date associated with the minimum 
correlation coefficient [between the mean of the mean daily temperatures (from a candidate starting 
date to the observed occurrence time) and the observed occurrence time] 
will be determined to be the starting date on the condition that it is smaller than 
the mininum phenological occurence time. If the determined date associated with the minimum 
correlation coefficient is greater than the mininum phenological occurence time, <code>S.def</code> 
will be used as the starting date. If <code>S.pd</code> is not NULL, the starting date will be 
directly set as <code>S.pd</code> irrespective of the minimum correlation coefficient method 
and the value of <code>S.def</code>. This means that <code>S.pd</code> is superior to <code>S.def</code> in determining 
the starting date.
</p>
<p><code class="reqn">\qquad</code>The function does not require that <code>Year1</code> is the same as <code>unique(Year2)</code>, 
and the intersection of the two vectors of years will be kept. The unused years that have phenological 
records but lack climate data will be showed in <code>unused.years</code> in the returned list. 
</p>
<p><code class="reqn">\qquad</code>The numerical value of <code>DOY.ul</code> should be greater than or equal to the maximum <code>Time</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>S.arr</code></td>
<td>
<p>the candidate starting dates (in day-of-year), whose default ranges from 
the minimum <code>DOY</code> to min(<code>DOY.ul</code>, the maximum <code>DOY</code>)</p>
</td></tr>
<tr><td><code>cor.coef.arr</code></td>
<td>
<p>the candidate correlation coefficients between the mean of the mean daily tempertures 
(from a candidate starting date to the observed occurrence time) and the observed occurrence time</p>
</td></tr>
<tr><td><code>cor.coef</code></td>
<td>
<p>the minimum correlation coefficient, i.e., min(<code>cor.coef.arr</code>)</p>
</td></tr>
<tr><td><code>search.failure</code></td>
<td>
<p>a value of 0 or 1 of showing whether the starting date is successfully determined 
by the minimum correlation coefficient method when <code>S.pd = NULL</code>, where 0 represents success and 1 represents failure</p>
</td></tr>
<tr><td><code>mAADD.arr</code></td>
<td>
<p>an vector saving the interannual mean of the annual acccumulated degree days 
(AADD) values for each of the candidate base temperatures</p>
</td></tr>
<tr><td><code>RMSE.arr</code></td>
<td>
<p>a vector saving the candidate root-mean-square errors (in days) between 
the observed and predicted occurrence times for each of the candidate base temperatures</p>
</td></tr>
<tr><td><code>AADD.arr</code></td>
<td>
<p>the annual accumulated degree days (AADD) values in different years</p>
</td></tr>
<tr><td><code>Year</code></td>
<td>
<p>The overlapping years between <code>Year1</code> and <code>Year2</code></p>
</td></tr>
<tr><td><code>Time</code></td>
<td>
<p>The observed occurence times (day-of-year) in the overlapping years 
between <code>Year1</code> and <code>Year2</code></p>
</td></tr>
<tr><td><code>Time.pred</code></td>
<td>
<p>the predicted occurence times in different years</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>the determined starting date (day-of-year)</p>
</td></tr>
<tr><td><code>T0</code></td>
<td>
<p>the determined base temperature (in <code class="reqn">{}^{\circ}</code>C)</p>
</td></tr>
<tr><td><code>AADD</code></td>
<td>
<p>the expected annual accumulated degree days</p>
</td></tr>
<tr><td><code>RMSE</code></td>
<td>
<p>the smallest RMSE (in days) from the different candidate base temperatures</p>
</td></tr>
<tr><td><code>unused.years</code></td>
<td>
<p>the years that have phenological records but lack climate data</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The entire mean daily temperature data set for the spring of each year should be provided. 
<code>AADD</code> is represented by the mean of <code>AADD.arr</code> in the output. 
When the argument of <code>S.pd</code> is not <code>NULL</code>, the returned value of <code>search.failure</code> will be <code>NA</code>. 
When the argument of <code>S.pd</code> is <code>NULL</code>, and the minimum correlation coefficient method fails 
to find a suitable starting date, the argument of <code>S.def</code> is then defined as the determined starting 
date, i.e., the returned value of <code>S</code>. At the same time, the returned value of <code>cor.coef</code> is defined as <code>NA</code>.   
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Zhenghong Chen <a href="mailto:chenzh64@126.com">chenzh64@126.com</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Aono, Y. (1993) Climatological studies on blooming of cherry tree (<em>Prunus yedoensis</em>) by means 
of DTS method. <em>Bulletin of the University of Osaka Prefecture. Ser. B, Agriculture and life sciences</em> 
45, 155<code class="reqn">-</code>192 (in Japanese with English abstract).
</p>
<p>Shi, P., Chen, Z., Reddy, G.V.P., Hui, C., Huang, J., Xiao, M. (2017a) Timing of cherry tree blooming: 
Contrasting effects of rising winter low temperatures and early spring temperatures. 
<em>Agricultural and Forest Meteorology</em> 240<code class="reqn">-</code>241, 78<code class="reqn">-</code>89. <a href="https://doi.org/10.1016/j.agrformet.2017.04.001">doi:10.1016/j.agrformet.2017.04.001</a>
</p>
<p>Shi, P., Fan, M., Reddy, G.V.P. (2017b) Comparison of thermal performance equations in describing 
temperature-dependent developmental rates of insects: (III) Phenological applications.  
<em>Annals of the Entomological Society of America</em> 110, 558<code class="reqn">-</code>564. <a href="https://doi.org/10.1093/aesa/sax063">doi:10.1093/aesa/sax063</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predADD">predADD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(apricotFFD)
data(BJDAT)
X1 &lt;- apricotFFD
X2 &lt;- BJDAT

Year1.val  &lt;- X1$Year
Time.val   &lt;- X1$Time
Year2.val  &lt;- X2$Year
DOY.val    &lt;- X2$DOY
Temp.val   &lt;- X2$MDT
DOY.ul.val &lt;- 120
T0.arr0    &lt;- seq(-5, 5, by = 0.1) 
S.pd0      &lt;- NULL


  res1 &lt;- ADD( S.pd = S.pd0, T0.arr = T0.arr0, Year1 = Year1.val, Time = Time.val, 
               Year2 = Year2.val, DOY = DOY.val, Temp = Temp.val, 
               DOY.ul = DOY.ul.val, fig.opt = TRUE, S.def=54, verbose = TRUE )
  res1

  S0 &lt;- res1$S.arr 
  r0 &lt;- res1$cor.coef.arr
  
  dev.new()
  par1 &lt;- par(family="serif")
  par2 &lt;- par(mar=c(5, 5, 2, 2))
  par3 &lt;- par(mgp=c(3, 1, 0))
  plot( S0, r0, cex.lab = 1.5, cex.axis = 1.5, xlab = "Candidate starting date (day-of-year)", 
        ylab="Correlation coefficient between the mean temperature and FFD", type="l" )
  ind &lt;- which.min(r0)
  points(S0[ind], r0[ind], cex = 1.5, pch = 16)
  text(S0[ind], r0[ind] + 0.1, bquote(paste(italic(S), " = ", .(S0[ind]), sep = "")), cex = 1.5)
  par(par1)
  par(par2)
  par(par3)

  resu1 &lt;- ADD( S.pd = 47, T0.arr = seq(-10, 0, by = 0.1), Year1 = Year1.val, Time = Time.val, 
                Year2 = Year2.val, DOY = DOY.val, Temp = Temp.val, 
                DOY.ul = DOY.ul.val, fig.opt = TRUE, S.def = 54, verbose = TRUE )
  resu1

  # graphics.off()


</code></pre>

<hr>
<h2 id='ADP'>
Function for Implementing the Accumulated Developmental Progress Method 
</h2><span id='topic+ADP'></span>

<h3>Description</h3>

<p>Estimates the starting date (<code class="reqn">S</code>, in day-of-year) and the parameters of 
a developmental rate model in the accumulated developmental progress (ADP) 
method using mean daily air temperatures (Wagner et al., 1984; Shi et al., 2017a, 2017b).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ADP( S.arr, expr, ini.val, Year1, Time, Year2, DOY, Temp, DOY.ul = 120,
     fig.opt = TRUE, control = list(), verbose = TRUE )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ADP_+3A_s.arr">S.arr</code></td>
<td>
<p>the candidate starting dates for thermal accumulation (in day-of-year)</p>
</td></tr>
<tr><td><code id="ADP_+3A_expr">expr</code></td>
<td>
<p>a user-defined model that is used in the accumulated developmental progress (ADP) method</p>
</td></tr>
<tr><td><code id="ADP_+3A_ini.val">ini.val</code></td>
<td>
<p>a vector or a list that saves the initial values of the parameters in <code>expr</code></p>
</td></tr>
<tr><td><code id="ADP_+3A_year1">Year1</code></td>
<td>
<p>the vector of the years in which a particular phenological event was recorded</p>
</td></tr>
<tr><td><code id="ADP_+3A_time">Time</code></td>
<td>
<p>the vector of the occurence times (in day-of-year) of a particular phenological event across many years</p>
</td></tr>
<tr><td><code id="ADP_+3A_year2">Year2</code></td>
<td>
<p>the vector of the years recording the climate data corresponding to the occurrence times</p>
</td></tr>
<tr><td><code id="ADP_+3A_doy">DOY</code></td>
<td>
<p>the vector of the dates (in day-of-year) for which climate data exist</p>
</td></tr>
<tr><td><code id="ADP_+3A_temp">Temp</code></td>
<td>
<p>the mean daily air temperature data (in <code class="reqn">{}^{\circ}</code>C) corresponding to <code>DOY</code></p>
</td></tr>
<tr><td><code id="ADP_+3A_doy.ul">DOY.ul</code></td>
<td>
<p>the upper limit of <code>DOY</code> used to predict the occurrence time</p>
</td></tr>
<tr><td><code id="ADP_+3A_fig.opt">fig.opt</code></td>
<td>
<p>an optional argument to draw the figures associated with the temperature-dependent developmental rate curve, 
the mean daily temperatures versus years, and a comparision between the predicted and observed occurrence times</p>
</td></tr>
<tr><td><code id="ADP_+3A_control">control</code></td>
<td>
<p>the list of control parameters for using the <code><a href="stats.html#topic+optim">optim</a></code> function in the <span class="pkg">stats</span> package</p>
</td></tr>
<tr><td><code id="ADP_+3A_verbose">verbose</code></td>
<td>
<p>an optional argument allowing users to suppress the printing of computation progress</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is better not to set too many candiate starting dates, as doing so will be time-consuming. If <code>expr</code> 
is selected as Arrhenius' equation, <code>S.arr</code> can be selected as the <code>S</code> obtained from the output of 
the <code><a href="#topic+ADTS">ADTS</a></code> function. Here, <code>expr</code> can be other nonlinear temperature-dependent 
developmental rate functions (see Shi et al. [2017b] for details). Further, <code>expr</code> can be any an arbitrary 
user-defined temperature-dependent developmental rate function, e.g., a function named <code>myfun</code>, 
but it needs to take the form of <code>myfun &lt;- function(P, x){...}</code>, 
where <code>P</code> is the vector of the model parameter(s), and <code>x</code> is the vector of the 
predictor variable, i.e., the temperature variable.
</p>
<p><code class="reqn">\qquad</code>The function does not require that <code>Year1</code> is the same as <code>unique(Year2)</code>, 
and the intersection of the two vectors of years will be kept. The unused years that have phenological 
records but lack climate data will be showed in <code>unused.years</code> in the returned list. 
</p>
<p><code class="reqn">\qquad</code>The numerical value of <code>DOY.ul</code> should be greater than or equal to the maximum <code>Time</code>.
</p>
<p><code class="reqn">\qquad</code> Let <code class="reqn">r</code> represent the temperature-dependent developmental rate, i.e., 
the reciprocal of the developmental 
duration required for completing a particular phenological event, at a constant temperature. 
In the accumulated developmental progress (ADP) method, when the annual accumulated developmental 
progress (AADP) reaches 100%, the phenological event is predicted to occurr for each year. 
Let <code class="reqn">\mathrm{AADP}_{i}</code> denote the AADP of the <code class="reqn">i</code>th year, which equals
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{AADP}_{i} = \sum_{j=S}^{E_{i}}r_{ij}\left(\mathrm{\mathbf{P}}; T_{ij}\right),</code>
</p>

<p>where <code class="reqn">S</code> represents the starting date (in day-of-year), <code class="reqn">E_{i}</code> represents the ending date 
(in day-of-year), i.e., the occurrence time of a pariticular phenological event in the <code class="reqn">i</code>th year, 
<code class="reqn">\mathrm{\mathbf{P}}</code> is the vector of the model parameters in <code>expr</code>, 
and <code class="reqn">T_{ij}</code> represents the mean daily temperature of the <code class="reqn">j</code>th day of the <code class="reqn">i</code>th 
year (in <code class="reqn">{}^{\circ}</code>C or K). In theory, <code class="reqn">\mathrm{AADP}_{i} = 100\%</code>, 
i.e., the AADP values of different years are a constant 100%. However, in practice, there is 
a certain deviation of <code class="reqn">\mathrm{AADP}_{i}</code> from 100%. The following approach 
is used to determine the predicted occurrence time. 
When <code class="reqn">\sum_{j=S}^{F}r_{ij} = 100\%</code> (where <code class="reqn">F \geq S</code>), it follows that <code class="reqn">F</code> is 
the predicted occurrence time; when <code class="reqn">\sum_{j=S}^{F}r_{ij} &lt; 100\%</code> and 
<code class="reqn">\sum_{j=S}^{F+1}r_{ij} &gt; 100\%</code>, the trapezoid method (Ring and Harris, 1983) 
is used to determine the predicted occurrence time. Assume that there are <code class="reqn">n</code>-year phenological records. 
When the starting date <code class="reqn">S</code> and the temperature-dependent developmental rate model are known, 
the model parameters can be estimated using the Nelder-Mead optiminization method 
(Nelder and Mead, 1965) to minimize the root-mean-square error (RMSE) between the observed and predicted 
occurrence times, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{\mathbf{\hat{P}}} = \mathrm{arg}\,\mathop{\mathrm{min}}\limits_{
\mathrm{\mathbf{P}}}\left\{\mathrm{RMSE}\right\} = \mathrm{arg}\,\mathop{\mathrm{min}}\limits_{
\mathrm{\mathbf{P}}}\sqrt{\frac{\sum_{i=1}^{n}\left(E_{i}-\hat{E}_i\right){}^{2}}{n}}.</code>
</p>

<p>Because <code class="reqn">S</code> is not determined, a group of candidate <code class="reqn">S</code> values (in day-of-year) need to 
be provided. Assume that there are <code class="reqn">m</code> candidate <code class="reqn">S</code> values, i.e., <code class="reqn">S_{1}, S_{2}, S_{3}, 
\cdots, S_{m}</code>. For each <code class="reqn">S_{q}</code> (where <code class="reqn">q</code> ranges between 1 and <code class="reqn">m</code>), we can obtain 
a vector of the estimated model parameters, <code class="reqn">\mathrm{\mathbf{\hat{P}}}_{q}</code>, by minimizing 
<code class="reqn">\mathrm{RMSE}_{q}</code> using the Nelder-Mead optiminization method. Then we finally selected 
<code class="reqn">\mathrm{\mathbf{\hat{P}}}</code> associated with <code class="reqn">\mathrm{min}\left\{\mathrm{RMSE}_{1}, 
\mathrm{RMSE}_{2}, \mathrm{RMSE}_{3}, \cdots, \mathrm{RMSE}_{m}\right\}</code> 
as the target parameter vector.      
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>TDDR</code></td>
<td>
<p>the temperature-dependent developmental rate matrix consisting of the year, 
day-of-year, mean daily temperature and developmental rate columns</p>
</td></tr>
<tr><td><code>MAT</code></td>
<td>
<p>a matrix consisting of the candidate starting dates and the estimates of 
candidate model parameters with the corresponding RMSEs</p>
</td></tr>
<tr><td><code>Dev.accum</code></td>
<td>
<p>the calculated annual accumulated developmental progresses in different years</p>
</td></tr> 
<tr><td><code>Year</code></td>
<td>
<p>The overlapping years between <code>Year1</code> and <code>Year2</code></p>
</td></tr>
<tr><td><code>Time</code></td>
<td>
<p>The observed occurence times (day-of-year) in the overlapping years 
between <code>Year1</code> and <code>Year2</code></p>
</td></tr>
<tr><td><code>Time.pred</code></td>
<td>
<p>the predicted occurence times in different years</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>the determined starting date (day-of-year)</p>
</td></tr>
<tr><td><code>par</code></td>
<td>
<p>the estimates of model parameters</p>
</td></tr>
<tr><td><code>RMSE</code></td>
<td>
<p>the RMSE (in days) between the observed and predicted occurrence times</p>
</td></tr>
<tr><td><code>unused.years</code></td>
<td>
<p>the years that have phenological records but lack climate data</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The entire mean daily temperature data set for the spring of each year should be provided. 
In <code>TDDR</code>, the first column of <code>Year</code> saves the years, the second column 
of <code>DOY</code> saves the day-of-year values, the third column of <code>Temperature</code> 
saves the mean daily air temperatures calculated between the starting date to the occurrence times, 
and the fourth column of <code>Rate</code> saves the calculated developmental rates 
corresponding to the mean daily temperatures. 
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Zhenghong Chen <a href="mailto:chenzh64@126.com">chenzh64@126.com</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Nelder, J.A., Mead, R. (1965) A simplex method for function minimization. 
<em>Computer Journal</em> 7, 308<code class="reqn">-</code>313. <a href="https://doi.org/10.1093/comjnl/7.4.308">doi:10.1093/comjnl/7.4.308</a>
</p>
<p>Ring, D.R., Harris, M.K. (1983) Predicting pecan nut casebearer (Lepidoptera: Pyralidae) activity 
at College Station, Texas. <em>Environmental Entomology</em> 12, 482<code class="reqn">-</code>486. <a href="https://doi.org/10.1093/ee/12.2.482">doi:10.1093/ee/12.2.482</a>
</p>
<p>Shi, P., Chen, Z., Reddy, G.V.P., Hui, C., Huang, J., Xiao, M. (2017a) Timing of cherry tree blooming: 
Contrasting effects of rising winter low temperatures and early spring temperatures. 
<em>Agricultural and Forest Meteorology</em> 240<code class="reqn">-</code>241, 78<code class="reqn">-</code>89. <a href="https://doi.org/10.1016/j.agrformet.2017.04.001">doi:10.1016/j.agrformet.2017.04.001</a>
</p>
<p>Shi, P., Fan, M., Reddy, G.V.P. (2017b) Comparison of thermal performance equations in describing 
temperature-dependent developmental rates of insects: (III) Phenological applications.  
<em>Annals of the Entomological Society of America</em> 110, 558<code class="reqn">-</code>564. <a href="https://doi.org/10.1093/aesa/sax063">doi:10.1093/aesa/sax063</a>
</p>
<p>Wagner, T.L., Wu, H.-I., Sharpe, P.J.H., Shcoolfield, R.M., Coulson, R.N. (1984) Modelling insect 
development rates: a literature review and application of a biophysical model. 
<em>Annals of the Entomological Society of America</em> 77, 208<code class="reqn">-</code>225. <a href="https://doi.org/10.1093/aesa/77.2.208">doi:10.1093/aesa/77.2.208</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predADP">predADP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(apricotFFD)
data(BJDAT)
X1 &lt;- apricotFFD
X2 &lt;- BJDAT

Year1.val  &lt;- X1$Year
Time.val   &lt;- X1$Time
Year2.val  &lt;- X2$Year
DOY.val    &lt;- X2$DOY
Temp.val   &lt;- X2$MDT
DOY.ul.val &lt;- 120
S.arr0     &lt;- 47

#### Defines a re-parameterized Arrhenius' equation ########################### 
Arrhenius.eqn &lt;- function(P, x){
  B  &lt;- P[1]
  Ea &lt;- P[2]
  R  &lt;- 1.987 * 10^(-3)
  x  &lt;- x + 273.15
  10^12*exp(B-Ea/(R*x))
}
##############################################################################

#### Provides the initial values of the parameter of Arrhenius' equation #####
ini.val0 &lt;- list( B = 20, Ea = 14 )
##############################################################################


  res5 &lt;- ADP( S.arr = S.arr0, expr = Arrhenius.eqn, ini.val = ini.val0, Year1 = Year1.val, 
               Time = Time.val, Year2 = Year2.val, DOY = DOY.val, Temp = Temp.val, 
               DOY.ul = DOY.ul.val, fig.opt = TRUE, control = list(trace = FALSE, 
               reltol = 1e-12, maxit = 5000), verbose = TRUE )
  res5

  TDDR &lt;- res5$TDDR
  T    &lt;- TDDR$Temperature
  r    &lt;- TDDR$Rate
  Y    &lt;- res5$Year
  DP   &lt;- res5$Dev.accum

  dev.new()
  par1 &lt;- par(family="serif")
  par2 &lt;- par(mar=c(5, 5, 2, 2))
  par3 &lt;- par(mgp=c(3, 1, 0))
  Ind &lt;- sort(T, index.return=TRUE)$ix 
  T1  &lt;- T[Ind]
  r1  &lt;- r[Ind]
  plot( T1, r1, cex.lab = 1.5, cex.axis = 1.5, pch = 1, cex = 1.5, col = 2, type = "l", 
        xlab = expression(paste("Mean daily temperature (", degree, "C)", sep = "")), 
        ylab = expression(paste("Calculated developmental rate (", {day}^{"-1"}, ")", sep = "")) ) 
  par(par1)
  par(par2)
  par(par3)

  dev.new()
  par1 &lt;- par(family="serif")
  par2 &lt;- par(mar=c(5, 5, 2, 2))
  par3 &lt;- par(mgp=c(3, 1, 0))
  plot( Y, DP * 100, xlab = "Year", 
        ylab = "Accumulated developmental progress (%)", 
        ylim = c(50, 150), cex.lab=1.5, cex.axis = 1.5, cex = 1.5 )
  abline( h = 1 * 100, lwd = 1, col = 4, lty = 2 ) 
  par(par1)
  par(par2)
  par(par3)

  # graphics.off()

</code></pre>

<hr>
<h2 id='ADTS'>
Function for Implementing the Accumulated Days Transferred to a Standardized Temperature Method 
</h2><span id='topic+ADTS'></span>

<h3>Description</h3>

<p>Estimates the starting date (<code class="reqn">S</code>, in day-of-year) and activation free energy (<code class="reqn">E_{a}</code>, in kcal 
<code class="reqn">\cdot</code> mol<code class="reqn">{}^{-1}</code>) in the accumulated days transferred to a standardized 
temperature (ADTS) method using mean daily air temperatures 
(Konno and Sugihara, 1986; Aono, 1993; Shi et al., 2017a, 2017b).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ADTS( S.arr, Ea.arr, Year1, Time, Year2, DOY, Temp, DOY.ul = 120, 
      fig.opt = TRUE, verbose = TRUE )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ADTS_+3A_s.arr">S.arr</code></td>
<td>
<p>the candidate starting dates for thermal accumulation (in day-of-year)</p>
</td></tr>
<tr><td><code id="ADTS_+3A_ea.arr">Ea.arr</code></td>
<td>
<p>the candidate activation free energy values (in kcal <code class="reqn">\cdot</code> mol<code class="reqn">{}^{-1}</code>)</p>
</td></tr>
<tr><td><code id="ADTS_+3A_year1">Year1</code></td>
<td>
<p>the vector of the years in which a particular phenological event was recorded</p>
</td></tr>
<tr><td><code id="ADTS_+3A_time">Time</code></td>
<td>
<p>the vector of the occurence times (in day-of-year) of a particular phenological event across many years</p>
</td></tr>
<tr><td><code id="ADTS_+3A_year2">Year2</code></td>
<td>
<p>the vector of the years recording the climate data corresponding to the occurrence times</p>
</td></tr>
<tr><td><code id="ADTS_+3A_doy">DOY</code></td>
<td>
<p>the vector of the dates (in day-of-year) for which climate data exist</p>
</td></tr>
<tr><td><code id="ADTS_+3A_temp">Temp</code></td>
<td>
<p>the mean daily air temperature data (in <code class="reqn">{}^{\circ}</code>C) corresponding to <code>DOY</code></p>
</td></tr>
<tr><td><code id="ADTS_+3A_doy.ul">DOY.ul</code></td>
<td>
<p>the upper limit of <code>DOY</code> used to predict the occurrence time</p>
</td></tr>
<tr><td><code id="ADTS_+3A_fig.opt">fig.opt</code></td>
<td>
<p>an optional argument to draw the figures associated with the determination 
of the combination the starting date and activation free energy, 
and a comparision between the predicted and observed occurrence times</p>
</td></tr>
<tr><td><code id="ADTS_+3A_verbose">verbose</code></td>
<td>
<p>an optional argument allowing users to suppress the printing of computation progress</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>fig.opt</code> is equal to <code>TRUE</code>, it will show the contours of the root-mean-square 
errors (RMSEs) based on different combinations of <code class="reqn">S</code> and <code class="reqn">E_{a}</code>.
</p>
<p><code class="reqn">\qquad</code>The function does not require that <code>Year1</code> is the same as <code>unique(Year2)</code>, 
and the intersection of the two vectors of years will be kept. The unused years that have phenological 
records but lack climate data will be showed in <code>unused.years</code> in the returned list. 
</p>
<p><code class="reqn">\qquad</code>The numerical value of <code>DOY.ul</code> should be greater than or equal to the maximum <code>Time</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mAADTS.mat</code></td>
<td>
<p>a matrix consisiting of the means of the annual accumulated days transferred 
to a standardized temperature (AADTS) values from the combinations of <code class="reqn">S</code> and <code class="reqn">E_{a}</code></p>
</td></tr>
<tr><td><code>RMSE.mat</code></td>
<td>
<p>the matrix consisting of the RMSEs (in days) from different 
combinations of <code class="reqn">S</code> and <code class="reqn">E_{a}</code></p>
</td></tr>
<tr><td><code>AADTS.arr</code></td>
<td>
<p>the AADTS values in different years 
associated with the smallest value in <code>RMSE.mat</code></p>
</td></tr> 
<tr><td><code>Year</code></td>
<td>
<p>The overlapping years between <code>Year1</code> and <code>Year2</code></p>
</td></tr>
<tr><td><code>Time</code></td>
<td>
<p>The observed occurence times (day-of-year) in the overlapping years 
between <code>Year1</code> and <code>Year2</code></p>
</td></tr>
<tr><td><code>Time.pred</code></td>
<td>
<p>the predicted occurence times in different years</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>the determined starting date (day-of-year)</p>
</td></tr>
<tr><td><code>Ea</code></td>
<td>
<p>the determined activation free energy values (in kcal<code class="reqn">\cdot</code>mol<code class="reqn">{}^{-1}</code>)</p>
</td></tr> 
<tr><td><code>AADD</code></td>
<td>
<p>the expected AADTS</p>
</td></tr>
<tr><td><code>RMSE</code></td>
<td>
<p>the smallest RMSE (in days) in <code>RMSE.mat</code> from 
different combinations of <code class="reqn">S</code> and <code class="reqn">E_{a}</code></p>
</td></tr>
<tr><td><code>unused.years</code></td>
<td>
<p>the years that have phenological records but lack climate data</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The entire mean daily temperature data set for the spring of each year should be provided. 
<code>AADTS</code> is represented by the mean of <code>AADTS.arr</code> in the output.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Zhenghong Chen <a href="mailto:chenzh64@126.com">chenzh64@126.com</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Aono, Y. (1993) Climatological studies on blooming of cherry tree (<em>Prunus yedoensis</em>) by means 
of DTS method. <em>Bulletin of the University of Osaka Prefecture. Ser. B, Agriculture and life sciences</em> 
45, 155<code class="reqn">-</code>192 (in Japanese with English abstract).
</p>
<p>Konno, T., Sugihara, S. (1986) Temperature index for characterizing biological activity in soil and 
its application to decomposition of soil organic matter. <em>Bulletin of National Institute for 
Agro-Environmental Sciences</em> 1, 51<code class="reqn">-</code>68 (in Japanese with English abstract).
</p>
<p>Shi, P., Chen, Z., Reddy, G.V.P., Hui, C., Huang, J., Xiao, M. (2017a) Timing of cherry tree blooming: 
Contrasting effects of rising winter low temperatures and early spring temperatures. 
<em>Agricultural and Forest Meteorology</em> 240<code class="reqn">-</code>241, 78<code class="reqn">-</code>89. <a href="https://doi.org/10.1016/j.agrformet.2017.04.001">doi:10.1016/j.agrformet.2017.04.001</a>
</p>
<p>Shi, P., Fan, M., Reddy, G.V.P. (2017b) Comparison of thermal performance equations in describing 
temperature-dependent developmental rates of insects: (III) Phenological applications.  
<em>Annals of the Entomological Society of America</em> 110, 558<code class="reqn">-</code>564. <a href="https://doi.org/10.1093/aesa/sax063">doi:10.1093/aesa/sax063</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predADTS">predADTS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(apricotFFD)
data(BJDAT)
X1 &lt;- apricotFFD
X2 &lt;- BJDAT

Year1.val  &lt;- X1$Year
Time.val   &lt;- X1$Time
Year2.val  &lt;- X2$Year
DOY.val    &lt;- X2$DOY
Temp.val   &lt;- X2$MDT
DOY.ul.val &lt;- 120
S.arr0     &lt;- seq(40, 60, by = 1)
Ea.arr0    &lt;- seq(10, 20, by = 1)


  res3 &lt;- ADTS( S.arr = S.arr0, Ea.arr = Ea.arr0, Year1 = Year1.val, Time = Time.val, 
                Year2 = Year2.val, DOY = DOY.val, Temp = Temp.val, DOY.ul = DOY.ul.val, 
                fig.opt = TRUE, verbose = TRUE)
  res3

  RMSE.mat0  &lt;- res3$RMSE.mat
  RMSE.range &lt;- range(RMSE.mat0)

  dev.new()
  par1 &lt;- par(family="serif")
  par2 &lt;- par(mar=c(5, 5, 2, 2))
  par3 &lt;- par(mgp=c(3, 1, 0))
  image( S.arr0, Ea.arr0, RMSE.mat0, col = terrain.colors(200), axes = TRUE, 
         cex.axis = 1.5, cex.lab = 1.5, xlab = "Starting date (day-of-year)", 
         ylab = expression(paste(italic(E["a"]), " (kcal" %.% "mol"^{"-1"}, ")", sep = "")))
  points( res3$S, res3$Ea, cex = 1.5, pch = 16, col = 2 )
  contour( S.arr0, Ea.arr0, RMSE.mat0, levels = round(seq(RMSE.range[1], 
           RMSE.range[2], len = 20), 4), add = TRUE, cex = 1.5, col = "#696969", labcex = 1.5)
  par(par1)
  par(par2)
  par(par3)

  resu3 &lt;- ADTS( S.arr = 47, Ea.arr = seq(10, 20, by = 0.5), Year1 = Year1.val, Time = Time.val, 
                 Year2 = Year2.val, DOY = DOY.val, Temp = Temp.val, DOY.ul = DOY.ul.val, 
                 fig.opt = TRUE, verbose = TRUE)
  resu3

  # graphics.off()


</code></pre>

<hr>
<h2 id='apricotFFD'>
First flowering date records of <em>Prunus armeniaca</em>
</h2><span id='topic+apricotFFD'></span>

<h3>Description</h3>

<p>The data consist of the first flowering date records of <em>Prunus armeniaca</em> 
at the Summer Palace (39<code class="reqn">{}^{\circ}</code>54<code class="reqn">'</code>38<code class="reqn">''</code> N, 
116<code class="reqn">{}^{\circ}</code>8<code class="reqn">'</code>28<code class="reqn">''</code> E, 50 m a.s.l.) in Beijing, China 
between 1963 and 2010 with the exception of 1969<code class="reqn">-</code>1971, and 1997<code class="reqn">-</code>2002. 
<b>Data source</b>: Chinese Phenological Observation Network (Guo et al., 2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(apricotFFD)
</code></pre>


<h3>Details</h3>

<p>In the data set, there are two columns of vectors: <code>Year</code> and <code>Time</code>. 
<code>Year</code> saves the recording years; and 
<code>Time</code> saves the 1963<code class="reqn">-</code>2010 first flowering dates of <em>Prunus armeniaca</em> (in day-of-year).
</p>


<h3>References</h3>

<p>Guo, L., Xu, J., Dai, J., Cheng, J., Wu, H., Luedeling, E. (2015) Statistical identification of chilling 
and heat requirements for apricotflower buds in Beijing, China. 
<em>Scientia Horticulturae</em> 195, 138<code class="reqn">-</code>144. <a href="https://doi.org/10.1016/j.scienta.2015.09.006">doi:10.1016/j.scienta.2015.09.006</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(apricotFFD)
attach(apricotFFD)

dev.new()
par1 &lt;- par(family="serif")
par2 &lt;- par(mar=c(5, 5, 2, 2))
par3 &lt;- par(mgp=c(3, 1, 0))
plot( Year, Time, asp = 1, cex.lab = 1.5, cex.axis = 1.5, 
      xlab = "Year", ylab = "First flowering date (day-of-year)" ) 
par(par1)
par(par2)
par(par3)

# graphics.off()
</code></pre>

<hr>
<h2 id='BJDAT'>
Daily Air Temperature Data of Beijing from 1952 to 2012. 
</h2><span id='topic+BJDAT'></span>

<h3>Description</h3>

<p>The data include the mean, minimum, and maximum daily temperatures (in <code class="reqn">{}^{\circ}</code>C) 
of Beijing between 1952 and 2012. 
<b>Data source</b>: China Meteorological Data Service Centre (<a href="https://data.cma.cn/en">https://data.cma.cn/en</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BJDAT)
</code></pre>


<h3>Details</h3>

<p>In the data set, there are seven columns of vectors: <code>Year</code>, <code>Month</code>, 
<code>Day</code>, <code>DOY</code>, <code>MDT</code>, <code>MinDT</code>, and <code>MaxDT</code>. 
<code>Year</code> saves the recording years; 
<code>Month</code> saves the recording months; 
<code>Day</code> saves the recording days; 
<code>DOY</code> saves the dates in day-of-year; 
<code>MDT</code> saves the mean daily temperatures (in <code class="reqn">{}^{\circ}</code>C) corresponding to <code>DOY</code>; 
<code>MinDT</code> saves the minimum daily temperatures (in <code class="reqn">{}^{\circ}</code>C) corresponding to <code>DOY</code>; 
<code>MaxDT</code> saves the maximum daily temperatures (in <code class="reqn">{}^{\circ}</code>C) corresponding to <code>DOY</code>.
</p>


<h3>References</h3>

<p>Guo, L., Xu, J., Dai, J., Cheng, J., Wu, H., Luedeling, E. (2015) Statistical identification of chilling 
and heat requirements for apricotflower buds in Beijing, China. 
<em>Scientia Horticulturae</em> 195, 138<code class="reqn">-</code>144. <a href="https://doi.org/10.1016/j.scienta.2015.09.006">doi:10.1016/j.scienta.2015.09.006</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(BJDAT)
attach(BJDAT)

x    &lt;- as.numeric( tapply(DOY, DOY, mean) )
y    &lt;- as.numeric( tapply(MDT, DOY, mean) )
y.sd &lt;- as.numeric( tapply(MDT, DOY, sd) )

dev.new()
par1 &lt;- par(family="serif")
par2 &lt;- par(mar=c(5, 5, 2, 2))
par3 &lt;- par(mgp=c(3, 1, 0))
plot( x, y, cex = 1.5, xlim = c(0, 367), ylim = c(-10, 30), 
      cex.lab = 1.5, cex.axis = 1.5, type = "n", xlab = "Day-of-year", 
      ylab = expression(paste("Mean daily temperature (", degree, "C)", sep="")) )
for(i in 1:length(x)){
  lines(c(x[i], x[i]), c(y[i]-y.sd[i], y[i]+y.sd[i]), col=4)
}
points(x, y, cex = 1.5)
par(par1)
par(par2)
par(par3)

# graphics.off()
</code></pre>

<hr>
<h2 id='predADD'>
Prediction Function of the Accumulated Degree Days Method
</h2><span id='topic+predADD'></span>

<h3>Description</h3>

<p>Predicts the occurrence times using the accumulated degree days method based on 
observed or predicted mean daily air temperatures (Aono, 1993; Shi et al., 2017a, 2017b).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predADD(S, T0, AADD, Year2, DOY, Temp, DOY.ul = 120)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predADD_+3A_s">S</code></td>
<td>
<p>the starting date for thermal accumulation (in day-of-year)</p>
</td></tr>
<tr><td><code id="predADD_+3A_t0">T0</code></td>
<td>
<p>the base temperature (in <code class="reqn">{}^{\circ}</code>C)</p>
</td></tr>
<tr><td><code id="predADD_+3A_aadd">AADD</code></td>
<td>
<p>the expected annual accumulated degree days</p>
</td></tr>
<tr><td><code id="predADD_+3A_year2">Year2</code></td>
<td>
<p>the vector of the years recording the climate data for predicting the occurrence times</p>
</td></tr>
<tr><td><code id="predADD_+3A_doy">DOY</code></td>
<td>
<p>the vector of the dates (in day-of-year) for which climate data exist</p>
</td></tr>
<tr><td><code id="predADD_+3A_temp">Temp</code></td>
<td>
<p>the mean daily air temperature data (in <code class="reqn">{}^{\circ}</code>C) corresponding to <code>DOY</code></p>
</td></tr>
<tr><td><code id="predADD_+3A_doy.ul">DOY.ul</code></td>
<td>
<p>the upper limit of <code>DOY</code> used to predict the occurrence time</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the accumulated degree days (ADD) method (Shi et al., 2017a, 2017b), the starting date 
(<code class="reqn">S</code>), the base temperature 
(<code class="reqn">T_{0}</code>), and the annual accumulated degree days (AADD, which is denoted by <code class="reqn">k</code>) 
are assumed to be constants across different years. Let <code class="reqn">k_{i}</code> denote the AADD of 
the <code class="reqn">i</code>th year, which equals
</p>
<p style="text-align: center;"><code class="reqn">k_{i} = \sum_{j=S}^{E_{i}}\left(T_{ij}-T_{0}\right),</code>
</p>

<p>where <code class="reqn">E_{i}</code> represents the ending date (in day-of-year), i.e., the occurrence time of a particular 
phenological event in the <code class="reqn">i</code>th year, and <code class="reqn">T_{ij}</code> represents the mean daily temperature of the 
<code class="reqn">j</code>th day of the <code class="reqn">i</code>th year (in <code class="reqn">{}^{\circ}</code>C). In theory, <code class="reqn">k_{i} = k</code>, 
i.e., the AADD values of different years are a constant. However, in practice, there is 
a certain deviation of <code class="reqn">k_{i}</code> from <code class="reqn">k</code>. The following approach 
is used to determine the predicted occurrence time. 
When <code class="reqn">\sum_{j=S}^{F}\left(T_{ij}-T_{0}\right) = k</code> (where <code class="reqn">F \geq S</code>), it follows that <code class="reqn">F</code> is 
the predicted occurrence time; when <code class="reqn">\sum_{j=S}^{F}\left(T_{ij}-T_{0}\right) &lt; k</code> and 
<code class="reqn">\sum_{j=S}^{F+1}\left(T_{ij}-T_{0}\right) &gt; k</code>, the trapezoid method (Ring and Harris, 1983) 
is used to determine the predicted occurrence time. 
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Year</code></td>
<td>
<p>the years with climate data</p>
</td></tr>
<tr><td><code>Time.pred</code></td>
<td>
<p>the predicted occurence times (day-of-year) in different years</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The entire mean daily temperature data set for the spring of each year should be provided.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Zhenghong Chen <a href="mailto:chenzh64@126.com">chenzh64@126.com</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Aono, Y. (1993) Climatological studies on blooming of cherry tree (<em>Prunus yedoensis</em>) by means 
of DTS method. <em>Bulletin of the University of Osaka Prefecture. Ser. B, Agriculture and life sciences</em> 
45, 155<code class="reqn">-</code>192 (in Japanese with English abstract).
</p>
<p>Ring, D.R., Harris, M.K. (1983) Predicting pecan nut casebearer (Lepidoptera: Pyralidae) activity 
at College Station, Texas. <em>Environmental Entomology</em> 12, 482<code class="reqn">-</code>486. <a href="https://doi.org/10.1093/ee/12.2.482">doi:10.1093/ee/12.2.482</a>
</p>
<p>Shi, P., Chen, Z., Reddy, G.V.P., Hui, C., Huang, J., Xiao, M. (2017a) Timing of cherry tree blooming: 
Contrasting effects of rising winter low temperatures and early spring temperatures. 
<em>Agricultural and Forest Meteorology</em> 240<code class="reqn">-</code>241, 78<code class="reqn">-</code>89. <a href="https://doi.org/10.1016/j.agrformet.2017.04.001">doi:10.1016/j.agrformet.2017.04.001</a>
</p>
<p>Shi, P., Fan, M., Reddy, G.V.P. (2017b) Comparison of thermal performance equations in describing 
temperature-dependent developmental rates of insects: (III) Phenological applications.  
<em>Annals of the Entomological Society of America</em> 110, 558<code class="reqn">-</code>564. <a href="https://doi.org/10.1093/aesa/sax063">doi:10.1093/aesa/sax063</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ADD">ADD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(apricotFFD)
data(BJDAT)
X1 &lt;- apricotFFD
X2 &lt;- BJDAT
Year1.val  &lt;- X1$Year
Time.val   &lt;- X1$Time
Year2.val  &lt;- X2$Year
DOY.val    &lt;- X2$DOY
Temp.val   &lt;- X2$MDT
DOY.ul.val &lt;- 120
S.val      &lt;- 65
T0.val     &lt;- -0.5 
AADD.val   &lt;- 235.5282

res2 &lt;- predADD( S = S.val, T0 = T0.val, AADD = AADD.val, 
                 Year2 = Year2.val, DOY = DOY.val, Temp = Temp.val, 
                 DOY.ul = DOY.ul.val )
res2


ind1  &lt;- res2$Year %in% intersect(res2$Year, Year1.val)
ind2  &lt;- Year1.val %in% intersect(res2$Year, Year1.val)
RMSE1 &lt;- sqrt( sum((Time.val[ind2]-res2$Time.pred[ind1])^2) / length(Time.val[ind2]) ) 
RMSE1 


</code></pre>

<hr>
<h2 id='predADP'>
Prediction Function of the Accumulated Developmental Progress Method
</h2><span id='topic+predADP'></span>

<h3>Description</h3>

<p>Predicts the occurrence times using the accumulated developmental progress (ADP) 
method based on observed or predicted mean daily air temperatures 
(Wagner et al., 1984; Shi et al., 2017a, 2017b).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predADP(S, expr, theta, Year2, DOY, Temp, DOY.ul = 120)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predADP_+3A_s">S</code></td>
<td>
<p>the starting date for thermal accumulation (in day-of-year)</p>
</td></tr>
<tr><td><code id="predADP_+3A_expr">expr</code></td>
<td>
<p>a user-defined model that is used in the accumulated developmental progress (ADP) method</p>
</td></tr>
<tr><td><code id="predADP_+3A_theta">theta</code></td>
<td>
<p>a vector saves the numerical values of the parameters in <code>expr</code></p>
</td></tr>
<tr><td><code id="predADP_+3A_year2">Year2</code></td>
<td>
<p>the vector of the years recording the climate data for predicting the occurrence times</p>
</td></tr>
<tr><td><code id="predADP_+3A_doy">DOY</code></td>
<td>
<p>the vector of the dates (in day-of-year) for which climate data exist</p>
</td></tr>
<tr><td><code id="predADP_+3A_temp">Temp</code></td>
<td>
<p>the mean daily air temperature data (in <code class="reqn">{}^{\circ}</code>C) corresponding to <code>DOY</code></p>
</td></tr>
<tr><td><code id="predADP_+3A_doy.ul">DOY.ul</code></td>
<td>
<p>the upper limit of <code>DOY</code> used to predict the occurrence time</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Organisms exhibiting phenological events in early spring often experience several cold days 
during their development. In this case, Arrhenius' equation (Shi et al., 2017a, 2017b, 
and references therein) has been recommended to describe the effect of the absolute temperature 
(<code class="reqn">T</code> in Kelvin [K]) on the developmental rate (<code class="reqn">r</code>):
</p>
<p style="text-align: center;"><code class="reqn">r = \mathrm{exp}\left(B - \frac{E_{a}}{R\,T}\right),</code>
</p>

<p>where <code class="reqn">E_{a}</code> represents the activation free energy (in kcal <code class="reqn">\cdot</code> mol<code class="reqn">{}^{-1}</code>); 
<code class="reqn">R</code> is the universal gas constant (= 1.987 cal <code class="reqn">\cdot</code> mol<code class="reqn">{}^{-1}</code> <code class="reqn">\cdot</code> K<code class="reqn">{}^{-1}</code>); 
<code class="reqn">B</code> is a constant. To maintain consistency between the units used for <code class="reqn">E_{a}</code> and <code class="reqn">R</code>, we need to 
re-assign <code class="reqn">R</code> to be 1.987<code class="reqn">\times {10}^{-3}</code>, making its unit 1.987<code class="reqn">\times {10}^{-3}</code> 
kcal <code class="reqn">\cdot</code> mol<code class="reqn">{}^{-1}</code> <code class="reqn">\cdot</code> K<code class="reqn">{}^{-1}</code> in the above formula. 
</p>
<p><code class="reqn">\qquad</code>In the accumulated developmental progress (ADP) method, when the annual accumulated developmental 
progress (AADP) reaches 100%, the phenological event is predicted to occur for each year. 
Let <code class="reqn">\mathrm{AADP}_{i}</code> denote the AADP of the <code class="reqn">i</code>th year, which equals
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{AADP}_{i} = \sum_{j=S}^{E_{i}}r_{ij},</code>
</p>

<p>where <code class="reqn">E_{i}</code> represents the ending date (in day-of-year), i.e., the occurrence time of a pariticular 
phenological event in the <code class="reqn">i</code>th year. If the temperature-dependent developmental rate follows 
Arrhenius' equation, the AADP of the <code class="reqn">i</code>th year is equal to  
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{AADP}_{i} = \sum_{j=S}^{E_{i}}\mathrm{exp}\left(B - \frac{E_{a}}{R\,T_{ij}}\right),</code>
</p>

<p>where <code class="reqn">T_{ij}</code> represents the mean daily temperature of the 
<code class="reqn">j</code>th day of the <code class="reqn">i</code>th year (in K). In theory, <code class="reqn">\mathrm{AADP}_{i} = 100\%</code>, 
i.e., the AADP values of different years are a constant 100%. However, in practice, there is 
a certain deviation of <code class="reqn">\mathrm{AADP}_{i}</code> from 100%. The following approach 
is used to determine the predicted occurrence time. 
When <code class="reqn">\sum_{j=S}^{F}r_{ij} = 100\%</code> (where <code class="reqn">F \geq S</code>), it follows that <code class="reqn">F</code> is 
the predicted occurrence time; when <code class="reqn">\sum_{j=S}^{F}r_{ij} &lt; 100\%</code> and 
<code class="reqn">\sum_{j=S}^{F+1}r_{ij} &gt; 100\%</code>, the trapezoid method (Ring and Harris, 1983) 
is used to determine the predicted occurrence time. 
</p>
<p><code class="reqn">\qquad</code>The argument of <code>expr</code> can be any an arbitrary user-defined temperature-dependent 
developmental rate function, e.g., a function named <code>myfun</code>, 
but it needs to take the form of <code>myfun &lt;- function(P, x){...}</code>, 
where <code>P</code> is the vector of the model parameter(s), and <code>x</code> is the vector of the 
predictor variable, i.e., the temperature variable.  
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Year</code></td>
<td>
<p>the years with climate data</p>
</td></tr>
<tr><td><code>Time.pred</code></td>
<td>
<p>the predicted occurence times (day-of-year) in different years</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The entire mean daily temperature data set for the spring of each year should be provided. 
It should be noted that the unit of <code>Temp</code> in <b>Arguments</b> is <code class="reqn">{}^{\circ}</code>C, not K. 
In addition, when using Arrhenius' equation to describe <code class="reqn">r</code>, to reduce the size of <code class="reqn">B</code> 
in this equation, Arrhenius' equation is multiplied by <code class="reqn">{10}^{12}</code> in calculating the 
AADP value for each year, i.e., 
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{AADP}_{i} = \sum_{j=S}^{E_{i}}\left[{10}^{12} \cdot \mathrm{exp}\left(B - \frac{E_{a}}{R\,T_{ij}}\right)\right].</code>
</p>



<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Zhenghong Chen <a href="mailto:chenzh64@126.com">chenzh64@126.com</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Ring, D.R., Harris, M.K. (1983) Predicting pecan nut casebearer (Lepidoptera: Pyralidae) activity 
at College Station, Texas. <em>Environmental Entomology</em> 12, 482<code class="reqn">-</code>486. <a href="https://doi.org/10.1093/ee/12.2.482">doi:10.1093/ee/12.2.482</a>
</p>
<p>Shi, P., Chen, Z., Reddy, G.V.P., Hui, C., Huang, J., Xiao, M. (2017a) Timing of cherry tree blooming: 
Contrasting effects of rising winter low temperatures and early spring temperatures. 
<em>Agricultural and Forest Meteorology</em> 240<code class="reqn">-</code>241, 78<code class="reqn">-</code>89. <a href="https://doi.org/10.1016/j.agrformet.2017.04.001">doi:10.1016/j.agrformet.2017.04.001</a>
</p>
<p>Shi, P., Fan, M., Reddy, G.V.P. (2017b) Comparison of thermal performance equations in describing 
temperature-dependent developmental rates of insects: (III) Phenological applications.  
<em>Annals of the Entomological Society of America</em> 110, 558<code class="reqn">-</code>564. <a href="https://doi.org/10.1093/aesa/sax063">doi:10.1093/aesa/sax063</a>
</p>
<p>Wagner, T.L., Wu, H.-I., Sharpe, P.J.H., Shcoolfield, R.M., Coulson, R.N. (1984) Modelling insect 
development rates: a literature review and application of a biophysical model. 
<em>Annals of the Entomological Society of America</em> 77, 208<code class="reqn">-</code>225. <a href="https://doi.org/10.1093/aesa/77.2.208">doi:10.1093/aesa/77.2.208</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ADP">ADP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(apricotFFD)
data(BJDAT)
X1 &lt;- apricotFFD
X2 &lt;- BJDAT
Year1.val  &lt;- X1$Year
Time.val   &lt;- X1$Time
Year2.val  &lt;- X2$Year
DOY.val    &lt;- X2$DOY
Temp.val   &lt;- X2$MDT
DOY.ul.val &lt;- 120
S.val      &lt;- 47

# Defines a re-parameterized Arrhenius' equation
Arrhenius.eqn &lt;- function(P, x){
  B  &lt;- P[1]
  Ea &lt;- P[2]
  R  &lt;- 1.987 * 10^(-3)
  x  &lt;- x + 273.15
  10^12*exp(B-Ea/(R*x))
}

P0 &lt;- c(-4.3787, 15.0431)
T2 &lt;- seq(-10, 20, len = 2000)
r2 &lt;- Arrhenius.eqn(P = P0, x = T2)

dev.new()
par1 &lt;- par(family="serif")
par2 &lt;- par(mar=c(5, 5, 2, 2))
par3 &lt;- par(mgp=c(3, 1, 0))
plot( T2, r2, cex.lab = 1.5, cex.axis = 1.5, pch = 1, cex = 1.5, col = 2, type = "l", 
      xlab = expression(paste("Temperature (", degree, "C)", sep = "")), 
      ylab = expression(paste("Developmental rate (", {day}^{"-1"}, ")", sep="")) ) 
par(par1)
par(par2)
par(par3)

res6 &lt;- predADP( S = S.val, expr = Arrhenius.eqn, theta = P0, Year2 = Year2.val, 
                 DOY = DOY.val, Temp = Temp.val, DOY.ul = DOY.ul.val )
res6

ind5 &lt;- res6$Year %in% intersect(res6$Year, Year1.val)
ind6  &lt;- Year1.val %in% intersect(res6$Year, Year1.val)
RMSE3 &lt;- sqrt( sum((Time.val[ind6]-res6$Time.pred[ind5])^2) / length(Time.val[ind6]) ) 
RMSE3 

</code></pre>

<hr>
<h2 id='predADTS'>
Prediction Function of the Accumulated Days Transferred 
to a Standardized Temperature Method
</h2><span id='topic+predADTS'></span>

<h3>Description</h3>

<p>Predicts the occurrence times using the accumulated days transferred to a standardized 
temperature (ADTS) method based on observed or predicted mean daily air temperatures 
(Konno and Sugihara, 1986; Aono, 1993; Shi et al., 2017a, 2017b).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predADTS(S, Ea, AADTS, Year2, DOY, Temp, DOY.ul = 120)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predADTS_+3A_s">S</code></td>
<td>
<p>the starting date for thermal accumulation (in day-of-year)</p>
</td></tr>
<tr><td><code id="predADTS_+3A_ea">Ea</code></td>
<td>
<p>the activation free energy (in kcal <code class="reqn">\cdot</code> mol<code class="reqn">{}^{-1}</code>)</p>
</td></tr>
<tr><td><code id="predADTS_+3A_aadts">AADTS</code></td>
<td>
<p>the expected annual accumulated days transferred to a standardized temperature</p>
</td></tr>
<tr><td><code id="predADTS_+3A_year2">Year2</code></td>
<td>
<p>the vector of the years recording the climate data for predicting the occurrence times</p>
</td></tr>
<tr><td><code id="predADTS_+3A_doy">DOY</code></td>
<td>
<p>the vector of the dates (in day-of-year) for which climate data exist</p>
</td></tr>
<tr><td><code id="predADTS_+3A_temp">Temp</code></td>
<td>
<p>the mean daily air temperature data (in <code class="reqn">{}^{\circ}</code>C) corresponding to <code>DOY</code></p>
</td></tr>
<tr><td><code id="predADTS_+3A_doy.ul">DOY.ul</code></td>
<td>
<p>the upper limit of <code>DOY</code> used to predict the occurrence time</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Organisms exhibiting phenological events in early spring often experience several cold days 
during their development. In this case, Arrhenius' equation (Shi et al., 2017a, 2017b, 
and references therein) has been recommended to describe the effect of the absolute temperature 
(<code class="reqn">T</code> in Kelvin [K]) on the developmental rate (<code class="reqn">r</code>):
</p>
<p style="text-align: center;"><code class="reqn">r = \mathrm{exp}\left(B - \frac{E_{a}}{R\,T}\right),</code>
</p>

<p>where <code class="reqn">E_{a}</code> represents the activation free energy (in kcal <code class="reqn">\cdot</code> mol<code class="reqn">{}^{-1}</code>); 
<code class="reqn">R</code> is the universal gas constant (= 1.987 cal <code class="reqn">\cdot</code> mol<code class="reqn">{}^{-1}</code> <code class="reqn">\cdot</code> K<code class="reqn">{}^{-1}</code>); 
<code class="reqn">B</code> is a constant. To maintain consistence between the units used for <code class="reqn">E_{a}</code> and <code class="reqn">R</code>, we need to 
re-assign <code class="reqn">R</code> to be 1.987<code class="reqn">\times {10}^{-3}</code>, making its unit 1.987<code class="reqn">\times {10}^{-3}</code> 
kcal <code class="reqn">\cdot</code> mol<code class="reqn">{}^{-1}</code> <code class="reqn">\cdot</code> K<code class="reqn">{}^{-1}</code> in the above formula. 
</p>
<p><code class="reqn">\qquad</code>According to the definition of the developmental rate (<code class="reqn">r</code>), 
it is the developmental progress per unit time (e.g., per day, per hour), 
which equals the reciprocal of the developmental duration <code class="reqn">D</code>, i.e., <code class="reqn">r = 1/D</code>. Let <code class="reqn">T_{s}</code> 
represent the standard temperature (in K), and <code class="reqn">r_{s}</code> represent the developmental rate at <code class="reqn">T_{s}</code>. 
Let <code class="reqn">r_{j}</code> represent the developmental rate at <code class="reqn">T_{j}</code>, an arbitrary 
temperature (in K). It is apparent that <code class="reqn">D_{s}r_{s} = D_{j}r_{j} = 1</code>. It follows that 
</p>
<p style="text-align: center;"><code class="reqn">\frac{D_{s}}{D_{j}} = \frac{r_{j}}{r_{s}} = 
\mathrm{exp}\left[\frac{E_{a}\left(T_{j}-T_{s}\right)}{R\,T_{j}\,T_{s}}\right],</code>
</p>

<p>where <code class="reqn">D_{s}/D_{j}</code> is referred to as the number of days transferred to a standardized temperature 
(DTS) (Konno and Sugihara, 1986; Aono, 1993). 
</p>
<p><code class="reqn">\qquad</code>In the accumulated days transferred to a standardized temperature (ADTS) method, 
the annual accumulated days transferred to a standardized temperature (AADTS) is assumed to be a constant. 
Let <code class="reqn">\mathrm{AADTS}_{i}</code> denote the AADTS of the <code class="reqn">i</code>th year, which equals
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{AADTS}_{i} = \sum_{j=S}^{E_{i}}\left\{\mathrm{exp}\left[\frac{E_{a}\left(T_{ij}-T_{s}\right)}{R\,T_{ij}\,T_{s}}\right]\right\},</code>
</p>

<p>where <code class="reqn">E_{i}</code> represents the ending date (in day-of-year), i.e., the occurrence time of a pariticular 
phenological event in the <code class="reqn">i</code>th year, and <code class="reqn">T_{ij}</code> represents the mean daily temperature of the 
<code class="reqn">j</code>th day of the <code class="reqn">i</code>th year (in K). In theory, <code class="reqn">\mathrm{AADTS}_{i} = \mathrm{AADTS}</code>, 
i.e., the AADTS values of different years are a constant. However, in practice, there is 
a certain deviation of <code class="reqn">\mathrm{AADTS}_{i}</code> from <code class="reqn">\mathrm{AADTS}</code>. The following approach 
is used to determine the predicted occurrence time. 
When <code class="reqn">\sum_{j=S}^{F}\left\{\mathrm{exp}\left[\frac{E_{a}\left(T_{ij}-T_{s}\right)}
{R\,T_{ij}\,T_{s}}\right]\right\} = \mathrm{AADTS}</code> (where <code class="reqn">F \geq S</code>), it follows that <code class="reqn">F</code> is 
the predicted occurrence time; when <code class="reqn">\sum_{j=S}^{F}\left\{\mathrm{exp}\left[
\frac{E_{a}\left(T_{ij}-T_{s}\right)}{R\,T_{ij}\,T_{s}}\right]\right\} &lt; \mathrm{AADTS}</code> and 
<code class="reqn">\sum_{j=S}^{F+1}\left\{\mathrm{exp}\left[\frac{E_{a}\left(T_{ij}-T_{s}\right)}
{R\,T_{ij}\,T_{s}}\right]\right\} &gt; \mathrm{AADTS}</code>, the trapezoid method (Ring and Harris, 1983) 
is used to determine the predicted occurrence time. 
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Year</code></td>
<td>
<p>the years with climate data</p>
</td></tr>
<tr><td><code>Time.pred</code></td>
<td>
<p>the predicted occurence times (day-of-year) in different years</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The entire mean daily temperature data set for the spring of each year should be provided. 
It should be noted that the unit of <code>Temp</code> in <b>Arguments</b> is <code class="reqn">{}^{\circ}</code>C, not K.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Zhenghong Chen <a href="mailto:chenzh64@126.com">chenzh64@126.com</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Aono, Y. (1993) Climatological studies on blooming of cherry tree (<em>Prunus yedoensis</em>) by means 
of DTS method. <em>Bulletin of the University of Osaka Prefecture. Ser. B, Agriculture and life sciences</em> 
45, 155<code class="reqn">-</code>192 (in Japanese with English abstract).
</p>
<p>Konno, T., Sugihara, S. (1986) Temperature index for characterizing biological activity in soil and 
its application to decomposition of soil organic matter. <em>Bulletin of National Institute for 
Agro-Environmental Sciences</em> 1, 51<code class="reqn">-</code>68 (in Japanese with English abstract).
</p>
<p>Ring, D.R., Harris, M.K. (1983) Predicting pecan nut casebearer (Lepidoptera: Pyralidae) activity 
at College Station, Texas. <em>Environmental Entomology</em> 12, 482<code class="reqn">-</code>486. <a href="https://doi.org/10.1093/ee/12.2.482">doi:10.1093/ee/12.2.482</a>
</p>
<p>Shi, P., Chen, Z., Reddy, G.V.P., Hui, C., Huang, J., Xiao, M. (2017a) Timing of cherry tree blooming: 
Contrasting effects of rising winter low temperatures and early spring temperatures. 
<em>Agricultural and Forest Meteorology</em> 240<code class="reqn">-</code>241, 78<code class="reqn">-</code>89. <a href="https://doi.org/10.1016/j.agrformet.2017.04.001">doi:10.1016/j.agrformet.2017.04.001</a>
</p>
<p>Shi, P., Fan, M., Reddy, G.V.P. (2017b) Comparison of thermal performance equations in describing 
temperature-dependent developmental rates of insects: (III) Phenological applications.  
<em>Annals of the Entomological Society of America</em> 110, 558<code class="reqn">-</code>564. <a href="https://doi.org/10.1093/aesa/sax063">doi:10.1093/aesa/sax063</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ADTS">ADTS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(apricotFFD)
data(BJDAT)
X1 &lt;- apricotFFD
X2 &lt;- BJDAT
Year1.val  &lt;- X1$Year
Time.val   &lt;- X1$Time
Year2.val  &lt;- X2$Year
DOY.val    &lt;- X2$DOY
Temp.val   &lt;- X2$MDT
DOY.ul.val &lt;- 120
S.val      &lt;- 47
Ea.val     &lt;- 15 
AADTS.val  &lt;- 8.5879

res4 &lt;- predADTS( S = S.val, Ea = Ea.val, AADTS = AADTS.val, 
                  Year2 = Year2.val, DOY = DOY.val, Temp = Temp.val, 
                  DOY.ul = DOY.ul.val )
res4

ind3  &lt;- res4$Year %in% intersect(res4$Year, Year1.val)
ind4  &lt;- Year1.val %in% intersect(res4$Year, Year1.val)
RMSE2 &lt;- sqrt( sum((Time.val[ind4]-res4$Time.pred[ind3])^2) / length(Time.val[ind4]) ) 
RMSE2 

</code></pre>

<hr>
<h2 id='spphpr'>
Spring Phenological Prediction
</h2><span id='topic+spphpr'></span>

<h3>Description</h3>

<p>Predicts the occurrence times (in day-of-year) of spring phenological events. 
Three methods, including the accumulated degree days (ADD) method, 
the accumulated days transferred to a standardized temperature (ADTS) method, 
and the accumulated developmental progress (ADP) method, were used. 
See Shi et al. (2017a, 2017b) for details.  
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> spphpr</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Spring Phenological Prediction</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2025-01-06</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> c(person(given="Peijian", family="Shi", email="pjshi@njfu.edu.cn", role=c("aut", "cre")),
        person(given=c("Zhenghong"), family="Chen", email="chenzh64@126.com", role=c("aut")),
        person(given=c("Brady K."), family="Quinn", email="brady.quinn@dfo-mpo.gc.ca", role=c("aut")))</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Peijian Shi [aut, cre], Zhenghong Chen [aut], Brady K. Quinn [aut]</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Peijian Shi &lt;pjshi@njfu.edu.cn&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Predicts the occurrence times (in day-of-year) of spring phenological events. Three methods, including the accumulated degree days (ADD) method, the accumulated days transferred to a standardized temperature (ADTS) method, and the accumulated developmental progress (ADP) method, were used. See Shi et al. (2017a) &lt;doi:10.1016/j.agrformet.2017.04.001&gt; and Shi et al. (2017b) &lt;doi:10.1093/aesa/sax063&gt; for details.  </td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 4.2.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
ADD                     Function for Implementing the Accumulated
                        Degree Days Method
ADP                     Function for Implementing the Accumulated
                        Developmental Progress Method
ADTS                    Function for Implementing the Accumulated Days
                        Transferred to a Standardized Temperature
                        Method
BJDAT                   Daily Air Temperature Data of Beijing from 1952
                        to 2012.
apricotFFD              First flowering date records of _Prunus
                        armeniaca_
predADD                 Prediction Function of the Accumulated Degree
                        Days Method
predADP                 Prediction Function of the Accumulated
                        Developmental Progress Method
predADTS                Prediction Function of the Accumulated Days
                        Transferred to a Standardized Temperature
                        Method
spphpr                  Spring Phenological Prediction
toDOY                   Function for Transferring a Date to the Value
                        of Day-of-Year
</pre>


<h3>Note</h3>

<p>We thank Benjamin Altmann, Lei Chen, Linli Deng, Feng Ge, Wen Gu, Liang Guo, Jianguo Huang, 
Cang Hui, Konstanze Lauseker, Gadi V.P. Reddy, Jing Tan, Di Tang, Yunfeng Yang, Mei Xiao, Lin Wang, 
and Wangxiang Zhang for their valuable help during the development of this package.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi [aut, cre], Zhenghong Chen [aut], Brady K. Quinn [aut]
</p>
<p>Maintainer: Peijian Shi &lt;pjshi@njfu.edu.cn&gt;
</p>


<h3>References</h3>

<p>Shi, P., Chen, Z., Reddy, G.V.P., Hui, C., Huang, J., Xiao, M. (2017a) Timing of cherry tree blooming: 
Contrasting effects of rising winter low temperatures and early spring temperatures. 
<em>Agricultural and Forest Meteorology</em> 240<code class="reqn">-</code>241, 78<code class="reqn">-</code>89. <a href="https://doi.org/10.1016/j.agrformet.2017.04.001">doi:10.1016/j.agrformet.2017.04.001</a>
</p>
<p>Shi, P., Fan, M., Reddy, G.V.P. (2017b) Comparison of thermal performance equations in describing 
temperature-dependent developmental rates of insects: (III) Phenological applications.  
<em>Annals of the Entomological Society of America</em> 110, 558<code class="reqn">-</code>564. <a href="https://doi.org/10.1093/aesa/sax063">doi:10.1093/aesa/sax063</a>
</p>

<hr>
<h2 id='toDOY'>
Function for Transferring a Date to the Value of Day-of-Year
</h2><span id='topic+toDOY'></span>

<h3>Description</h3>

<p>Transfers the date (from year, month and day) to the value of day-of-year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toDOY(Year, Month, Day)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="toDOY_+3A_year">Year</code></td>
<td>
<p>the vector of years</p>
</td></tr>
<tr><td><code id="toDOY_+3A_month">Month</code></td>
<td>
<p>the vector of months</p>
</td></tr>
<tr><td><code id="toDOY_+3A_day">Day</code></td>
<td>
<p>the vector of days</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The user needs to provide the three separate vectors of <code>Year</code>, <code>Month</code> and <code>Day</code>, 
rather than providing a single date vector. The arguments can be numerical vectors or character vectors.
</p>


<h3>Value</h3>

<p>The returned value is a vector of transferred dates in day-of-year.
</p>


<h3>Note</h3>

<p>The returned vector, <code>DOY</code>, usually matches with the year vector and the mean daily 
temperature vector as arguments in other functions, e.g., the <code><a href="#topic+ADD">ADD</a></code> function.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Zhenghong Chen <a href="mailto:chenzh64@126.com">chenzh64@126.com</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Shi, P., Chen, Z., Reddy, G.V.P., Hui, C., Huang, J., Xiao, M. (2017a) Timing of cherry tree blooming: 
Contrasting effects of rising winter low temperatures and early spring temperatures. 
<em>Agricultural and Forest Meteorology</em> 240<code class="reqn">-</code>241, 78<code class="reqn">-</code>89. <a href="https://doi.org/10.1016/j.agrformet.2017.04.001">doi:10.1016/j.agrformet.2017.04.001</a>
</p>
<p>Shi, P., Fan, M., Reddy, G.V.P. (2017b) Comparison of thermal performance equations in describing 
temperature-dependent developmental rates of insects: (III) Phenological applications.  
<em>Annals of the Entomological Society of America</em> 110, 558<code class="reqn">-</code>564. <a href="https://doi.org/10.1093/aesa/sax063">doi:10.1093/aesa/sax063</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BJDAT">BJDAT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(BJDAT)
X2   &lt;- BJDAT
DOY2 &lt;- toDOY(X2$Year, X2$Month, X2$Day)
# cbind(X2$DOY, DOY2)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
