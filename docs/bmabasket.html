<!DOCTYPE html><html><head><title>Help for package bmabasket</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bmabasket}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bma'><p>Compute posterior model probabilities</p></a></li>
<li><a href='#bma_design'><p>Simulate a BMA design</p></a></li>
<li><a href='#bmabasket-package'><p>bmabasket: Bayesian Model Averaging for Basket Trials</p></a></li>
<li><a href='#numModels'><p>Compute number of models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Model Averaging for Basket Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-02-24</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matt Psioda &lt;matt_psioda@unc.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of the Bayesian model averaging method 
    of Psioda and others (2019) &lt;<a href="https://doi.org/10.1093%2Fbiostatistics%2Fkxz014">doi:10.1093/biostatistics/kxz014</a>&gt; for basket trials. 
    Contains a user-friendly wrapper for simulating basket trials under conditions 
    and analyzing them with a Bayesian model averaging approach.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.3), partitions</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ethan-alt/bmabasket">https://github.com/ethan-alt/bmabasket</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ethan-alt/bmabasket/issues">https://github.com/ethan-alt/bmabasket/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-02-24 17:24:55 UTC; ea516</td>
</tr>
<tr>
<td>Author:</td>
<td>Matt Psioda [cre],
  Ethan Alt [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-02-24 17:50:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='bma'>Compute posterior model probabilities</h2><span id='topic+bma'></span>

<h3>Description</h3>

<p>Given data and hyperparameters, computes posterior model probabilities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bma(pi0, y, n, P = NULL, mu0 = 0.5, phi0 = 1, priorModelProbs = NULL, pmp0 = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bma_+3A_pi0">pi0</code></td>
<td>
<p>scalar or vector whose elements are between 0 and 1 giving threshold for the hypothesis test. If a scalar is provided, assumes same threshold for each basket</p>
</td></tr>
<tr><td><code id="bma_+3A_y">y</code></td>
<td>
<p>vector of responses</p>
</td></tr>
<tr><td><code id="bma_+3A_n">n</code></td>
<td>
<p>vector of sample sizes</p>
</td></tr>
<tr><td><code id="bma_+3A_p">P</code></td>
<td>
<p>integer giving maximum number of distinct parameters; default is all possible models</p>
</td></tr>
<tr><td><code id="bma_+3A_mu0">mu0</code></td>
<td>
<p>prior mean for beta prior</p>
</td></tr>
<tr><td><code id="bma_+3A_phi0">phi0</code></td>
<td>
<p>prior dispersion for beta prior</p>
</td></tr>
<tr><td><code id="bma_+3A_priormodelprobs">priorModelProbs</code></td>
<td>
<p>(optional) vector giving prior for models. Default is proportional to <code>exp(pmp0 * D)</code>, where <code>D</code> is the number of distinct parameters in the model</p>
</td></tr>
<tr><td><code id="bma_+3A_pmp0">pmp0</code></td>
<td>
<p>nonnegative scalar. Value of 0 corresponds to uniform prior across model space. Ignored if priorModelProbs is specified</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with the following structure:
</p>

<dl>
<dt>bmaProbs</dt><dd><p>model-averaged probabilities that each basket is larger than <code>pi0</code></p>
</dd>
<dt>bmaMeans</dt><dd><p>model-averaged posterior mean for each basket</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>## Simulate data with 3 baskets
probs &lt;- c(0.5, 0.25, 0.25)
n &lt;- rep(100, length(probs))
y &lt;- rbinom(length(probs), size = n, prob = probs)
bma(0.5, y, n)

</code></pre>

<hr>
<h2 id='bma_design'>Simulate a BMA design</h2><span id='topic+bma_design'></span>

<h3>Description</h3>

<p>Simulates a BMA design given hyperparameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bma_design(
  nSims,
  nBaskets,
  maxDistinct = nBaskets,
  eRates,
  rRates,
  meanTime,
  sdTime,
  ppEffCrit,
  ppFutCrit,
  futOnly = FALSE,
  rRatesNull,
  rRatesAlt,
  minSSFut,
  minSSEff,
  minSSEnr,
  maxSSEnr,
  targSSPer,
  I0,
  mu0 = 0.5,
  phi0 = 1,
  priorModelProbs = NULL,
  pmp0 = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bma_design_+3A_nsims">nSims</code></td>
<td>
<p>number of simulation studies to be performed</p>
</td></tr>
<tr><td><code id="bma_design_+3A_nbaskets">nBaskets</code></td>
<td>
<p>number of baskets</p>
</td></tr>
<tr><td><code id="bma_design_+3A_maxdistinct">maxDistinct</code></td>
<td>
<p>integer between 1 and <code>nBaskets</code> giving number of distinct model probabilities to use. Defaults to <code>nBaskets</code>. It is recommended to call <code><a href="#topic+numModels">numModels</a></code> to ensure that computation is tractable.</p>
</td></tr>
<tr><td><code id="bma_design_+3A_erates">eRates</code></td>
<td>
<p>scalar or vector of Poisson process rates for each basket</p>
</td></tr>
<tr><td><code id="bma_design_+3A_rrates">rRates</code></td>
<td>
<p>scalar or vector of true response rates for each basket</p>
</td></tr>
<tr><td><code id="bma_design_+3A_meantime">meanTime</code></td>
<td>
<p>mean parameter for time to outcome ascertainment</p>
</td></tr>
<tr><td><code id="bma_design_+3A_sdtime">sdTime</code></td>
<td>
<p>standard deviation parameter for time to outcome ascertainment</p>
</td></tr>
<tr><td><code id="bma_design_+3A_ppeffcrit">ppEffCrit</code></td>
<td>
<p>scalar or vector giving basket-specific posterior probability threshold for activity (i.e., efficacy).</p>
</td></tr>
<tr><td><code id="bma_design_+3A_ppfutcrit">ppFutCrit</code></td>
<td>
<p>scalar or vector giving basket-specific posterior probability threshold for futility</p>
</td></tr>
<tr><td><code id="bma_design_+3A_futonly">futOnly</code></td>
<td>
<p><code>logical</code> giving whether design allows only for futility stopping (<code>TRUE</code> = futility only, <code>FALSE</code> = both futility and efficacy)</p>
</td></tr>
<tr><td><code id="bma_design_+3A_rratesnull">rRatesNull</code></td>
<td>
<p>scalar or vector of basket-specific null hypothesis values (for efficacy determination)</p>
</td></tr>
<tr><td><code id="bma_design_+3A_rratesalt">rRatesAlt</code></td>
<td>
<p>scalar or vector of basket-specific hypothesized alternative values (for futility determination)</p>
</td></tr>
<tr><td><code id="bma_design_+3A_minssfut">minSSFut</code></td>
<td>
<p>minimum number of subjects in basket to assess futility</p>
</td></tr>
<tr><td><code id="bma_design_+3A_minsseff">minSSEff</code></td>
<td>
<p>minimum number of subjects in basket to assess activity</p>
</td></tr>
<tr><td><code id="bma_design_+3A_minssenr">minSSEnr</code></td>
<td>
<p>matrix giving minimum number of new subjects per basket before next analysis (each row is an interim analysis, each column is a basket)</p>
</td></tr>
<tr><td><code id="bma_design_+3A_maxssenr">maxSSEnr</code></td>
<td>
<p>matrix giving maximum number of new subjects per basket before next analysis (each row is an interim analysis, each column is a basket)</p>
</td></tr>
<tr><td><code id="bma_design_+3A_targssper">targSSPer</code></td>
<td>
<p>scalar or vector giving target sample size increment for each basket</p>
</td></tr>
<tr><td><code id="bma_design_+3A_i0">I0</code></td>
<td>
<p>maximum number of analyses</p>
</td></tr>
<tr><td><code id="bma_design_+3A_mu0">mu0</code></td>
<td>
<p>prior mean for the response probabilities</p>
</td></tr>
<tr><td><code id="bma_design_+3A_phi0">phi0</code></td>
<td>
<p>prior dispersion response probabilities</p>
</td></tr>
<tr><td><code id="bma_design_+3A_priormodelprobs">priorModelProbs</code></td>
<td>
<p>vector giving prior probabilities for models. Default is prior of each model is proportional <code>exp(pmp0 * D)</code> where <code>D</code> is the number of distinct parameters in the model</p>
</td></tr>
<tr><td><code id="bma_design_+3A_pmp0">pmp0</code></td>
<td>
<p>scalar giving power for <code>priorModelProbs</code>. If <code>pmp0==0</code>, a uniform prior is used for model probabilities. Defaults to 1. Ignored if <code>priorModelProbs</code> is not <code>NULL</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a nested list giving results of the simulation with the following structure:
</p>

<ul>
<li> <p><strong>hypothesis.testing</strong>       - hypothesis testing information
</p>

<ul>
<li> <p><strong>rr</strong>                     - basket-specific null hypothesis rejection rate
</p>
</li>
<li> <p><strong>fw.fpr</strong>                 - family-wise false positive rate (across all inactive baskets)
</p>
</li>
<li> <p><strong>nerr</strong>                   - average number of false null hypothesis rejections
</p>
</li>
<li> <p><strong>fut</strong>                    - basket-specific probability of futility stopping
</p>
</li></ul>

</li>
<li> <p><strong>sample.size</strong>              - trial sample size information
</p>

<ul>
<li> <p><strong>basket.ave</strong>             - basket-specific expected sample size
</p>
</li>
<li> <p><strong>basket.med</strong>             - basket-specific median sample size
</p>
</li>
<li> <p><strong>basket.min</strong>             - basket-specific minimum sample size
</p>
</li>
<li> <p><strong>basket.max</strong>             - basket-specific maximum sample size
</p>
</li>
<li> <p><strong>overall.ave</strong>            - expected overall sample size
</p>
</li></ul>

</li>
<li> <p><strong>point.estimation</strong>         - point estimation information
</p>

<ul>
<li> <p><strong>PM.ave</strong>                 - basket-specific average posterior mean
</p>
</li>
<li> <p><strong>SP.ave</strong>                 - basket-specific average sample proportion
</p>
</li>
<li> <p><strong>PP.ave</strong>                 - basket-specific average posterior probability
</p>
</li>
<li> <p><strong>bias</strong>                   - basket-specific bias of the posterior mean
</p>
</li>
<li> <p><strong>mse</strong>                    - basket-specific MSE of the posterior mean
</p>
</li></ul>

</li>
<li> <p><strong>early.stopping</strong>           - early stopping information
</p>

<ul>
<li> <p><strong>interim.stop.prob</strong>      - probability of trial stoppage by interim
</p>
</li>
<li> <p><strong>baskets.continuing.ave</strong> - average number of baskets continuing past interim
</p>
</li></ul>

</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## SIMULATE DATA AND SET SIMULATION PARAMS
nSims      &lt;- 100             ## would be much more in practice                     
meanTime   &lt;- 0.01
sdTime     &lt;- 0.0000000001
mu0        &lt;- 0.45
phi0       &lt;- 1.00
ppEffCrit  &lt;- 0.985
ppFutCrit  &lt;- 0.2750
pmp0       &lt;- 2
n1         &lt;- 7
n2         &lt;- 16
targSSPer  &lt;- c(n1, n2)
nInterim   &lt;- 2
futOnly    &lt;- 1
K0         &lt;- 5
row        &lt;- 0
mss        &lt;- 4
minSSFut   &lt;- mss  ## minimum number of subjects in basket to assess futility using BMA
minSSEff   &lt;- mss  ## minimum number of subjects in basket to assess activity using BMA
rTarg      &lt;- 0.45
rNull      &lt;- 0.15
rRatesMod  &lt;- matrix(rNull,(K0+1)+3,K0)
rRatesNull &lt;- rep(rNull,K0)
rRatesMid  &lt;- rep(rTarg,K0)
eRatesMod  &lt;- rep(1, K0)

## min and max #' of new subjects per basket before next analysis (each row is interim)
minSSEnr &lt;- matrix(rep(mss, K0), nrow=nInterim ,ncol=K0, byrow=TRUE) 
maxSSEnr &lt;- matrix(rep(100, K0), nrow=nInterim, ncol=K0, byrow=TRUE) 

## construct matrix of rates
for (i in 1:K0)  
{
  rRatesMod[(i+1):(K0+1),i]= rTarg     
}
rRatesMod[(K0+2),] &lt;- c(0.05,0.15,0.25,0.35,0.45)
rRatesMod[(K0+3),] &lt;- c(0.15,0.30,0.30,0.30,0.45)
rRatesMod[(K0+4),] &lt;- c(0.15,0.15,0.30,0.30,0.30)

## conduct simulation of trial data and analysis
x &lt;- bma_design(
  nSims, K0, K0, eRatesMod, rRatesMod[i+1,], meanTime, sdTime, 
  ppEffCrit, ppFutCrit, as.logical(futOnly), rRatesNull, rRatesMid, 
  minSSFut, minSSEff, minSSEnr, maxSSEnr, targSSPer, nInterim, mu0, 
  phi0, priorModelProbs = NULL, pmp0 = pmp0
)
</code></pre>

<hr>
<h2 id='bmabasket-package'>bmabasket: Bayesian Model Averaging for Basket Trials</h2><span id='topic+bmabasket'></span><span id='topic+bmabasket-package'></span>

<h3>Description</h3>

<p>An implementation of the Bayesian model averaging method 
of Psioda and others (2019) &lt;doi:10.1093/biostatistics/kxz014&gt; for basket trials. 
Contains a user-friendly wrapper for simulating basket trials under conditions 
and analyzing them with a Bayesian model averaging approach.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Matt Psioda <a href="mailto:matt_psioda@unc.edu">matt_psioda@unc.edu</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Ethan Alt <a href="mailto:ethanalt@live.unc.edu">ethanalt@live.unc.edu</a>
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/ethan-alt/bmabasket">https://github.com/ethan-alt/bmabasket</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ethan-alt/bmabasket/issues">https://github.com/ethan-alt/bmabasket/issues</a>
</p>
</li></ul>


<hr>
<h2 id='numModels'>Compute number of models</h2><span id='topic+numModels'></span>

<h3>Description</h3>

<p>Given a basket size and maximal number of distinct
response rates, compute the number of possible models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>numModels(K, P)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="numModels_+3A_k">K</code></td>
<td>
<p>positive integer giving number of baskets</p>
</td></tr>
<tr><td><code id="numModels_+3A_p">P</code></td>
<td>
<p>positive integer giving maximal number of distinct rates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>integer giving number of possible models
</p>


<h3>Examples</h3>

<pre><code class='language-R'>numModels(10, 10)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
