<!DOCTYPE html><html><head><title>Help for package ellipse</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ellipse}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ellipse'>
<p>Make an ellipse</p></a></li>
<li><a href='#ellipse-package'>
<p>Functions for drawing ellipses and ellipse-like confidence</p>
regions</a></li>
<li><a href='#ellipse.arima0'>
<p>Outline an approximate pairwise confidence region</p></a></li>
<li><a href='#ellipse.glm'>
<p>Outline an approximate pairwise confidence region</p></a></li>
<li><a href='#ellipse.lm'>
<p>Outline a pairwise confidence region for a linear model fit.</p></a></li>
<li><a href='#ellipse.nls'>
<p>Outline an approximate pairwise confidence region</p></a></li>
<li><a href='#ellipse.profile'>
<p>Pairwise profile sketch</p></a></li>
<li><a href='#ellipse.profile.glm'>
<p>Pairwise profile sketch	for GLM profiles</p></a></li>
<li><a href='#ellipse.profile.nls'>
<p>Pairwise profile sketch</p></a></li>
<li><a href='#pairs_profile'>
<p>Profile pairs</p></a></li>
<li><a href='#plotcorr'>
<p>Plot correlation matrix ellipses</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.5.0</td>
</tr>
<tr>
<td>Title:</td>
<td>Functions for Drawing Ellipses and Ellipse-Like Confidence
Regions</td>
</tr>
<tr>
<td>Author:</td>
<td>Duncan Murdoch and E. D. Chow (porting to R by Jesus M. Frias Celayeta)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Duncan Murdoch &lt;murdoch.duncan@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains various routines for drawing
    ellipses and ellipse-like confidence regions, implementing the plots
    described in Murdoch and Chow (1996, &lt;<a href="https://doi.org/10.2307%2F2684435">doi:10.2307/2684435</a>&gt;). There are
    also routines implementing the profile plots described in Bates and
    Watts (1988, &lt;<a href="https://doi.org/10.1002%2F9780470316757">doi:10.1002/9780470316757</a>&gt;).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.0.0),graphics,stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/dmurdoch/ellipse">https://github.com/dmurdoch/ellipse</a>,
<a href="https://dmurdoch.github.io/ellipse/">https://dmurdoch.github.io/ellipse/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/dmurdoch/ellipse/issues">https://github.com/dmurdoch/ellipse/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-20 18:27:17 UTC; murdoch</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-20 19:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ellipse'>
Make an ellipse
</h2><span id='topic+ellipse'></span><span id='topic+ellipse.default'></span>

<h3>Description</h3>

<p>A generic function returning an ellipse or other outline of a confidence region
for two parameters.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ellipse(x, ...)
## Default S3 method:
ellipse(x, scale = c(1, 1), centre = c(0, 0), level = 0.95,
    t = sqrt(qchisq(level, 2)), which = c(1, 2), npoints = 100, center = centre,
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ellipse_+3A_x">x</code></td>
<td>

<p>An object. In the default method the parameter <code>x</code> should be a correlation between -1 and 1 or a
square positive definite matrix at least 2x2
in size. It will be treated as the correlation or covariance 
of a multivariate normal distribution.
</p>
</td></tr>
<tr><td><code id="ellipse_+3A_...">...</code></td>
<td>

<p>Descendant methods may require additional parameters.
</p>
</td></tr>
<tr><td><code id="ellipse_+3A_scale">scale</code></td>
<td>

<p>If <code>x</code> is a correlation matrix, then the standard deviations of each
parameter can be given in the scale parameter.  This defaults to <code>c(1, 1)</code>,
so no rescaling will be done.
</p>
</td></tr>
<tr><td><code id="ellipse_+3A_centre">centre</code></td>
<td>

<p>The centre of the ellipse will be at this position.
</p>
</td></tr>
<tr><td><code id="ellipse_+3A_level">level</code></td>
<td>

<p>The confidence level of a pairwise confidence region.  The default is
0.95, for a 95% region.  This is used to control the size of the ellipse
being plotted.  A vector of levels may be used.
</p>
</td></tr>
<tr><td><code id="ellipse_+3A_t">t</code></td>
<td>

<p>The size of the ellipse may also be controlled by specifying the value
of a t-statistic on its boundary.  This defaults to the appropriate
value for the confidence region.
</p>
</td></tr>
<tr><td><code id="ellipse_+3A_which">which</code></td>
<td>

<p>This parameter selects which pair of variables from the matrix will be
plotted.  The default is the first 2.
</p>
</td></tr>
<tr><td><code id="ellipse_+3A_npoints">npoints</code></td>
<td>

<p>The number of points used in the ellipse.  Default is 100.
</p>
</td></tr>
<tr><td><code id="ellipse_+3A_center">center</code></td>
<td>

<p>An alternative to <code>centre</code> to accommodate US spelling.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default method uses the 
<code>(cos(theta + d/2), cos(theta - d/2))</code> parametrization of an ellipse, where 
<code>cos(d)</code> is the correlation of the parameters.
</p>


<h3>Value</h3>

<p>An <code>npoints</code> x <code>2</code> matrix is returned with columns named according to the
row names of the matrix <code>x</code> (default <code>'x'</code> and <code>'y'</code>), suitable
for plotting.
</p>


<h3>References</h3>

<p>Murdoch, D.J. and Chow, E.D. (1996). A graphical display of large 
correlation matrices. The American Statistician 50, 178-180. <a href="https://doi.org/10.2307/2684435">doi:10.2307/2684435</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ellipse.lm">ellipse.lm</a></code>, <code><a href="#topic+ellipse.nls">ellipse.nls</a></code>, 
<code><a href="#topic+ellipse.profile">ellipse.profile</a></code>, <code><a href="#topic+ellipse.profile.nls">ellipse.profile.nls</a></code>,
<code><a href="#topic+ellipse.arima0">ellipse.arima0</a></code>,
<code><a href="#topic+plotcorr">plotcorr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot an ellipse corresponding to a 95% probability region for a
# bivariate normal distribution with mean 0, unit variances and 
# correlation 0.8.
plot(ellipse(0.8), type = 'l')
</code></pre>

<hr>
<h2 id='ellipse-package'>
Functions for drawing ellipses and ellipse-like confidence
regions
</h2><span id='topic+ellipse-package'></span>

<h3>Description</h3>

<p>This package contains various routines for drawing
ellipses and ellipse-like confidence regions, implementing the
plots described in Murdoch and Chow (1996).
</p>
<p>There are also routines implementing
the profile plots described in Bates and Watts (1988).
</p>


<h3>Details</h3>

<p>There are three groups of routines in the ellipse package.  The first
consists of those involved with <code><a href="#topic+plotcorr">plotcorr</a></code>, which implements the plots
described in Murdoch and Chow (1996). These display correlations using
ellipses, whose shape is that of the contours of a bivariate normal
distribution with matching correlation.
</p>
<p>The second group implements a version of the profile plots described in
Bates and Watts (1988); see <code><a href="#topic+ellipse.profile">ellipse.profile</a></code> and <code><a href="#topic+pairs.profile">pairs.profile</a></code>.
</p>
<p>The last group provide the basis for the others, drawing ellipses based on
various S objects, including scalar correlations, covariance matrices
<code><a href="stats.html#topic+arima">arima</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>, and <code><a href="stats.html#topic+nls">nls</a></code> fits:  see <code><a href="#topic+ellipse">ellipse</a></code>.
</p>


<h3>Author(s)</h3>

<p>Duncan Murdoch and E. D. Chow (porting
to R by Jesus M. Frias Celayeta.)
</p>
<p>Maintainer: Duncan Murdoch &lt;murdoch.duncan@gmail.com&gt;
</p>


<h3>References</h3>

<p>Bates and Watts (1988) Nonlinear Regression Analysis and Its Applications. Wiley. <a href="https://doi.org/10.1002/9780470316757">doi:10.1002/9780470316757</a>.
</p>
<p>Murdoch, D.J. and Chow, E.D. (1996). A graphical
display of large correlation matrices. The American
Statistician 50, 178-180. <a href="https://doi.org/10.2307/2684435">doi:10.2307/2684435</a>.
</p>

<hr>
<h2 id='ellipse.arima0'>
Outline an approximate pairwise confidence region 
</h2><span id='topic+ellipse.arima0'></span>

<h3>Description</h3>

<p>This function produces the ellipsoidal outline of an approximate 
pairwise confidence region for an ARIMA model fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'arima0'
ellipse(x, which = c(1, 2), level = 0.95, t = sqrt(qchisq(level, 2)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ellipse.arima0_+3A_x">x</code></td>
<td>

<p>The first argument should be an <code>arima0</code> object, usually resulting from a call
to <code>arima0()</code>.
</p>
</td></tr>
<tr><td><code id="ellipse.arima0_+3A_which">which</code></td>
<td>

<p>Which selects the pair of parameters to be plotted.  The default is the
first two.
</p>
</td></tr>
<tr><td><code id="ellipse.arima0_+3A_level">level</code></td>
<td>

<p>The confidence level of the region.  Default 95%.
</p>
</td></tr>
<tr><td><code id="ellipse.arima0_+3A_t">t</code></td>
<td>

<p>The t statistic on the boundary of the ellipse.
</p>
</td></tr>
<tr><td><code id="ellipse.arima0_+3A_...">...</code></td>
<td>

<p>Other <code>ellipse.default</code> parameters may also be used.
</p>
</td></tr></table>


<h3>Details</h3>

<p>The <code>summary</code> function is used to obtain the approximate covariance matrix of the
fitted parameters.
</p>


<h3>Value</h3>

<p>A matrix with columns <code>x</code> and <code>y</code> to outline the confidence region.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ellipse">ellipse</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(USAccDeaths)
fit &lt;- arima0(USAccDeaths, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 1)))
# Plot the approximate 95% confidence region for the first two parameters
# of the model
plot(ellipse(fit), type = 'l')
points(fit$coef[1], fit$coef[2])
</code></pre>

<hr>
<h2 id='ellipse.glm'>
Outline an approximate pairwise confidence region 
</h2><span id='topic+ellipse.glm'></span>

<h3>Description</h3>

<p>This function produces the ellipsoidal outline of an approximate 
pairwise confidence region for a generalized linear model fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm'
ellipse(x, which = c(1, 2), level = 0.95, t, npoints = 100, 
        dispersion, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ellipse.glm_+3A_x">x</code></td>
<td>

<p>The first argument should be a <code>glm</code> object, usually resulting from a call
to <code>glm()</code>.
</p>
</td></tr>
<tr><td><code id="ellipse.glm_+3A_which">which</code></td>
<td>

<p>Which selects the pair of parameters to be plotted.  The default is the
first two.
</p>
</td></tr>
<tr><td><code id="ellipse.glm_+3A_level">level</code></td>
<td>

<p>The confidence level of the region.  Default 95%.
</p>
</td></tr>
<tr><td><code id="ellipse.glm_+3A_t">t</code></td>
<td>

<p>The t statistic on the boundary of the ellipse.  For Binomial or Poisson
families, <code>sqrt(qchisq(level, 2))</code> is used; for other distributions,
<code>sqrt(2*qf(level, 2, df))</code> where <code>df</code> is the residual degrees of freedom.
</p>
</td></tr>
<tr><td><code id="ellipse.glm_+3A_npoints">npoints</code></td>
<td>

<p>How many points to return in the ellipse.
</p>
</td></tr>
<tr><td><code id="ellipse.glm_+3A_dispersion">dispersion</code></td>
<td>

<p>The value of dispersion to use.  If specified, it is treated as fixed,
and the chi-square limits for <code>t</code> are used. If missing, it is 
taken from <code>summary(x)</code>.
</p>
</td></tr>
<tr><td><code id="ellipse.glm_+3A_...">...</code></td>
<td>

<p>Other <code>ellipse.default</code> parameters may also be used.
</p>
</td></tr></table>


<h3>Details</h3>

<p>The summary function is used to obtain the approximate covariance matrix of the
fitted parameters, the dispersion estimate, and the degrees of freedom.
</p>


<h3>Value</h3>

<p>A matrix with columns named according to which to outline the confidence region.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ellipse.default">ellipse.default</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>     
## Dobson (1990) Page 93: Randomized Controlled Trial :

     counts &lt;- c(18,17,15,20,10,20,25,13,12)
     outcome &lt;- gl(3,1,9)
     treatment &lt;- gl(3,3)
     glm.D93 &lt;- glm(counts ~ outcome + treatment, family=poisson())

# Plot an approximate 95 % confidence region for the two Outcome parameters

	plot(ellipse(glm.D93, which = c(2,3)), type = 'l')
	points(glm.D93$coefficients[2], glm.D93$coefficients[3])
</code></pre>

<hr>
<h2 id='ellipse.lm'>
Outline a pairwise confidence region for a linear model fit.
</h2><span id='topic+ellipse.lm'></span>

<h3>Description</h3>

<p>This function produces the ellipsoidal outline of a pairwise confidence
region for a linear model fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lm'
ellipse(x, which = c(1, 2), level = 0.95, 
    t = sqrt(2 * qf(level, 2, x$df.residual)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ellipse.lm_+3A_x">x</code></td>
<td>

<p>The first argument should be an <code>lm</code> object, usually resulting from a call
to <code>lm()</code>.
</p>
</td></tr>
<tr><td><code id="ellipse.lm_+3A_which">which</code></td>
<td>

<p>Which selects the pair of parameters to be plotted.  The default is the
first two.
</p>
</td></tr>
<tr><td><code id="ellipse.lm_+3A_level">level</code></td>
<td>

<p>The confidence level of the region.  Default 95%.
</p>
</td></tr>
<tr><td><code id="ellipse.lm_+3A_t">t</code></td>
<td>

<p>The t statistic on the boundary of the ellipse.
</p>
</td></tr>
<tr><td><code id="ellipse.lm_+3A_...">...</code></td>
<td>

<p>Other <code>ellipse.default</code> parameters may also be used.
</p>
</td></tr></table>


<h3>Details</h3>

<p>The summary function is used to obtain the covariance matrix of the
fitted parameters.
</p>


<h3>Value</h3>

<p>A matrix with columns <code>x</code> and <code>y</code> to outline the confidence region.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ellipse.default">ellipse.default</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot the estimate and joint 90% confidence region for the displacement and cylinder
# count linear coefficients in the mtcars dataset
data(mtcars)
fit &lt;- lm(mpg ~ disp + cyl , mtcars)
plot(ellipse(fit, which = c('disp', 'cyl'), level = 0.90), type = 'l')
points(fit$coefficients['disp'], fit$coefficients['cyl'])
</code></pre>

<hr>
<h2 id='ellipse.nls'>
Outline an approximate pairwise confidence region 
</h2><span id='topic+ellipse.nls'></span>

<h3>Description</h3>

<p>This function produces the ellipsoidal outline of an approximate 
pairwise confidence region for a nonlinear model fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nls'
ellipse(x, which = c(1, 2), level = 0.95, 
    t = sqrt(2 * qf(level, 2, s$df[2])), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ellipse.nls_+3A_x">x</code></td>
<td>

<p>The first argument should be an <code>nls</code> object, usually resulting from a call
to <code>nls()</code>.
</p>
</td></tr>
<tr><td><code id="ellipse.nls_+3A_which">which</code></td>
<td>

<p>Which selects the pair of parameters to be plotted.  The default is the
first two.
</p>
</td></tr>
<tr><td><code id="ellipse.nls_+3A_level">level</code></td>
<td>

<p>The confidence level of the region.  Default 95%.
</p>
</td></tr>
<tr><td><code id="ellipse.nls_+3A_t">t</code></td>
<td>

<p>The t statistic on the boundary of the ellipse.
</p>
</td></tr>
<tr><td><code id="ellipse.nls_+3A_...">...</code></td>
<td>

<p>Other <code>ellipse.default</code> parameters may also be used.
</p>
</td></tr></table>


<h3>Details</h3>

<p>The summary function is used to obtain the approximate covariance matrix of the
fitted parameters.
</p>


<h3>Value</h3>

<p>A matrix with columns <code>x</code> and <code>y</code> to outline the confidence region.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ellipse.default">ellipse.default</a></code>, <code><a href="#topic+ellipse.profile">ellipse.profile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot an approximate 95% confidence region for the weight and displacement
# parameters in the Michaelis Menten model
data(Puromycin)
fit &lt;- nls(rate ~ Vm*conc/(K + conc), data = Puromycin, subset = state=="treated", 
    start = list(K = 0.05, Vm = 200))
plot(ellipse(fit,which=c('Vm','K')), type = 'l')
params &lt;- fit$m$getPars()
points(params['Vm'],params['K'])
</code></pre>

<hr>
<h2 id='ellipse.profile'>
Pairwise profile sketch
</h2><span id='topic+ellipse.profile'></span>

<h3>Description</h3>

<p>This routine approximates a contour of a function based on the profile
of that function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'profile'
ellipse(x, which = c(1, 2), level = 0.95, t = sqrt(qchisq(level, 2)), 
    npoints = 100, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ellipse.profile_+3A_x">x</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+profile">profile</a></code>, e.g. from 
<a href="MASS.html#topic+confint">profile.glm</a> in the MASS package.
</p>
</td></tr>
<tr><td><code id="ellipse.profile_+3A_which">which</code></td>
<td>

<p>Which pair of parameters to use.
</p>
</td></tr>
<tr><td><code id="ellipse.profile_+3A_level">level</code></td>
<td>

<p>The <code>ellipse.profile</code> function defaults assume that the profiled
function is -2 times the log likelihood of a regular model. 
With this assumption the <code>level</code> argument
specifies the confidence level for an asymptotic confidence region.
</p>
</td></tr>
<tr><td><code id="ellipse.profile_+3A_t">t</code></td>
<td>

<p>The square root of the value to be contoured.
</p>
</td></tr>
<tr><td><code id="ellipse.profile_+3A_npoints">npoints</code></td>
<td>

<p>How many points to use in the ellipse.
</p>
</td></tr>
<tr><td><code id="ellipse.profile_+3A_...">...</code></td>
<td>

<p>Extra arguments are not used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses the 4 point approximation to the contour as described
in Appendix 6 of Bates and Watts (1988).  It produces the exact contour for
quadratic surfaces, and good approximations for mild deviations from
quadratic.  If the surface is multimodal, the algorithm is likely to
produce nonsense.
</p>


<h3>Value</h3>

<p>An <code>npoints</code> x <code>2</code> matrix with columns having the chosen parameter names, 
which approximates a contour of the function that was profiled.
</p>


<h3>References</h3>

<p>Bates and Watts (1988). Nonlinear Regression Analysis and Its Applications. Wiley. <a href="https://doi.org/10.1002/9780470316757">doi:10.1002/9780470316757</a>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+profile">profile</a></code>, <code><a href="#topic+ellipse.nls">ellipse.nls</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot an approximate 95% confidence region for the Puromycin
# parameters Vm and K, and overlay the ellipsoidal region

data(Puromycin)
Purboth &lt;- nls(formula = rate ~ ((Vm + delV * (state == "treated"))
  * conc)/(K + conc), data = Puromycin,
  start = list(Vm = 160, delV = 40, K = 0.05))
Pur.prof &lt;- profile(Purboth)
plot(ellipse(Pur.prof, which = c('Vm', 'K')), type = 'l')
lines(ellipse(Purboth, which = c('Vm', 'K')), lty = 2)
params &lt;- Purboth$m$getPars()
points(params['Vm'],params['K'])
</code></pre>

<hr>
<h2 id='ellipse.profile.glm'>
Pairwise profile sketch	for GLM profiles
</h2><span id='topic+ellipse.profile.glm'></span>

<h3>Description</h3>

<p>This routine approximates a pairwise confidence region for a <code>glm</code>
model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'profile.glm'
ellipse(x, which = c(1, 2), level = 0.95, t, 
    npoints = 100, dispersion, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ellipse.profile.glm_+3A_x">x</code></td>
<td>

<p>An object of class <code><a href="MASS.html#topic+profile.glm">profile.glm</a></code>.
</p>
</td></tr>
<tr><td><code id="ellipse.profile.glm_+3A_which">which</code></td>
<td>

<p>Which pair of parameters to use.
</p>
</td></tr>
<tr><td><code id="ellipse.profile.glm_+3A_level">level</code></td>
<td>

<p>The <code>level</code> argument
specifies the confidence level for an asymptotic confidence region.
</p>
</td></tr>
<tr><td><code id="ellipse.profile.glm_+3A_t">t</code></td>
<td>

<p>The square root of the value to be contoured.  By default, this is <code>qchisq(level, 2)</code>
for models with fixed dispersion (i.e. binomial and Poisson), and <code>2 * qf(level, 2, df)</code> for other models,
where <code>df</code> is the residual degrees of freedom.
</p>
</td></tr>
<tr><td><code id="ellipse.profile.glm_+3A_npoints">npoints</code></td>
<td>

<p>How many points to use in the ellipse.
</p>
</td></tr>
<tr><td><code id="ellipse.profile.glm_+3A_dispersion">dispersion</code></td>
<td>

<p>If specified, fixed dispersion is assumed, otherwise the dispersion is taken from the model.
</p>
</td></tr>
<tr><td><code id="ellipse.profile.glm_+3A_...">...</code></td>
<td>

<p>Extra parameters which are not used (for compatibility with the generic).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses the 4 point approximation to the contour as described
in Appendix 6 of Bates and Watts (1988).  It produces the exact contour for
quadratic surfaces, and good approximations for mild deviations from
quadratic.  If the surface is multimodal, the algorithm is likely to
produce nonsense.
</p>


<h3>Value</h3>

<p>An <code>npoints</code> x <code>2</code> matrix with columns having the chosen parameter names, 
which approximates a contour of the function that was profiled.
</p>


<h3>References</h3>

<p>Bates and Watts (1988). Nonlinear Regression Analysis and Its Applications. Wiley. <a href="https://doi.org/10.1002/9780470316757">doi:10.1002/9780470316757</a>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+profile">profile</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="#topic+ellipse.glm">ellipse.glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## MASS has a pairs.profile function that conflicts with ours, so
## do a little trickery here
	 noMASS &lt;- is.na(match('package:MASS', search()))
	 if (noMASS) require(MASS)

## Dobson (1990) Page 93: Randomized Controlled Trial :

     counts &lt;- c(18,17,15,20,10,20,25,13,12)
     outcome &lt;- gl(3,1,9)
     treatment &lt;- gl(3,3)
     glm.D93 &lt;- glm(counts ~ outcome + treatment, family=poisson())

##  Plot an approximate 95% confidence region for the two outcome variables
     prof.D93 &lt;- profile(glm.D93)
     plot(ellipse(prof.D93, which = 2:3), type = 'l')
     lines(ellipse(glm.D93, which = 2:3), lty = 2)
     params &lt;- glm.D93$coefficients
     points(params[2],params[3])
     
##  Clean up our trickery
	 if (noMASS) detach('package:MASS')
	 
</code></pre>

<hr>
<h2 id='ellipse.profile.nls'>
Pairwise profile sketch
</h2><span id='topic+ellipse.profile.nls'></span>

<h3>Description</h3>

<p>This routine approximates a pairwise confidence region for a nonlinear regression
model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'profile.nls'
ellipse(x, which = c(1, 2), level = 0.95, 
          t = sqrt(2 * qf(level, 2, attr(x, "summary")$df[2])), 
          npoints = 100, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ellipse.profile.nls_+3A_x">x</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+profile.nls">profile.nls</a></code>.
</p>
</td></tr>
<tr><td><code id="ellipse.profile.nls_+3A_which">which</code></td>
<td>

<p>Which pair of parameters to use.
</p>
</td></tr>
<tr><td><code id="ellipse.profile.nls_+3A_level">level</code></td>
<td>

<p>The <code>level</code> argument
specifies the confidence level for an asymptotic confidence region.
</p>
</td></tr>
<tr><td><code id="ellipse.profile.nls_+3A_t">t</code></td>
<td>

<p>The square root of the value to be contoured.
</p>
</td></tr>
<tr><td><code id="ellipse.profile.nls_+3A_npoints">npoints</code></td>
<td>

<p>How many points to use in the ellipse.
</p>
</td></tr>
<tr><td><code id="ellipse.profile.nls_+3A_...">...</code></td>
<td>

<p>Extra parameters which are not used (for compatibility with the generic).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses the 4 point approximation to the contour as described
in Appendix 6 of Bates and Watts (1988).  It produces the exact contour for
quadratic surfaces, and good approximations for mild deviations from
quadratic.  If the surface is multimodal, the algorithm is likely to
produce nonsense.
</p>


<h3>Value</h3>

<p>An <code>npoints</code> x <code>2</code> matrix with columns having the chosen parameter names, 
which approximates a contour of the function that was profiled.
</p>


<h3>References</h3>

<p>Bates and Watts (1988). Nonlinear Regression Analysis and Its Applications. Wiley. <a href="https://doi.org/10.1002/9780470316757">doi:10.1002/9780470316757</a>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+profile">profile</a></code>, <code><a href="#topic+ellipse.nls">ellipse.nls</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot an approximate 95% confidence region for the Puromycin
# parameters Vm and K, and overlay the ellipsoidal region
data(Puromycin)
Purboth &lt;- nls(formula = rate ~ ((Vm + delV * (state == "treated"))
  * conc)/(K + conc), data = Puromycin,
  start = list(Vm = 160, delV = 40, K = 0.05))
Pur.prof &lt;- profile(Purboth)
plot(ellipse(Pur.prof, which = c('Vm', 'K')), type = 'l')
lines(ellipse(Purboth, which = c('Vm', 'K')), lty = 2)
params &lt;- Purboth$m$getPars()
points(params['Vm'],params['K'])
</code></pre>

<hr>
<h2 id='pairs_profile'>
Profile pairs
</h2><span id='topic+pairs_profile'></span><span id='topic+pairs.profile'></span><span id='topic+ellipse-deprecated'></span><span id='topic+pairs'></span>

<h3>Description</h3>

<p>This function produces pairwise plots of profile traces, profile
sketches, and ellipse approximations to confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pairs_profile(x, labels = c(names(x), "Profile tau"), panel = lines, invert = TRUE, 
    plot.tau = TRUE, plot.trace = TRUE, plot.sketch = TRUE, 
	plot.ellipse = FALSE, level = 0.95, ...)
	
# Deprecated generic function.  Use graphics::pairs instead.
pairs(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pairs_profile_+3A_x">x</code></td>
<td>

<p>An object of class <code>profile</code>, generally the result of the <code>profile()</code>
function. 
</p>
</td></tr>
<tr><td><code id="pairs_profile_+3A_labels">labels</code></td>
<td>

<p>The labels to use for each variable.  These default to the variable
names.
</p>
</td></tr>
<tr><td><code id="pairs_profile_+3A_panel">panel</code></td>
<td>

<p>The function to use to draw the sketch in each panel.
</p>
</td></tr>
<tr><td><code id="pairs_profile_+3A_invert">invert</code></td>
<td>

<p>Whether to swap the axes so things look better.
</p>
</td></tr>
<tr><td><code id="pairs_profile_+3A_plot.tau">plot.tau</code></td>
<td>

<p>Whether to do the profile tau (profile t) plots.
</p>
</td></tr>
<tr><td><code id="pairs_profile_+3A_plot.trace">plot.trace</code></td>
<td>

<p>Whether to do the profile trace plots.
</p>
</td></tr>
<tr><td><code id="pairs_profile_+3A_plot.sketch">plot.sketch</code></td>
<td>

<p>Whether to do the profile sketch plots.
</p>
</td></tr>
<tr><td><code id="pairs_profile_+3A_plot.ellipse">plot.ellipse</code></td>
<td>

<p>Whether to do the ellipse approximations.
</p>
</td></tr>
<tr><td><code id="pairs_profile_+3A_level">level</code></td>
<td>

<p>The nominal confidence level for the profile sketches and ellipses.
</p>
</td></tr>
<tr><td><code id="pairs_profile_+3A_...">...</code></td>
<td>

<p>Other plotting parameters.
</p>
</td></tr></table>


<h3>Details</h3>

<p>This function implements the plots used in Bates and Watts (1988) for
nonlinear regression diagnostics.
</p>
<p>Prior to <span class="pkg">ellipse</span> version 0.5,
the <code>pairs_profile</code> function was a <code>profile</code>
method for the <code>pairs</code> generic.  This caused
various conflicts, because <span class="pkg">graphics</span> also exports a <code>pairs</code>
generic, and package <span class="pkg">MASS</span> exported a <code>profile</code>
method for <code>graphics::pairs</code>.  As of <span class="rlang"><b>R</b></span> version 4.4.0,
the <span class="pkg">MASS</span> method will be in <span class="pkg">stats</span> instead.
</p>
<p>If <code>x</code> is a profile object then <code>pairs_profile(x)</code> 
will call the function from this package.  If you'd rather use
the <span class="pkg">MASS</span>/<span class="pkg">stats</span> method, then make sure the appropriate
package is loaded, and call <code>pairs(x)</code>.  (Prior to
<span class="pkg">ellipse</span> 0.5, there were complicated rules to determine what
<code>pairs(x)</code> would do; those should still work for now, but
<code>ellipse::pairs</code> will disappear in a future release.)
</p>


<h3>Side Effects</h3>

<p>Produces a plot on the current device for each pair of variables in the
profile object.
</p>


<h3>References</h3>

<p>Bates and Watts (1988). Nonlinear Regression Analysis and Its Applications. Wiley. <a href="https://doi.org/10.1002/9780470316757">doi:10.1002/9780470316757</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pairs">pairs</a></code>, <code><a href="stats.html#topic+profile">profile</a></code>, <code><a href="#topic+ellipse.profile">ellipse.profile</a></code>, <code><a href="#topic+ellipse.nls">ellipse.nls</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Plot everything for the Puromycin data
 data(Puromycin)
 Purboth &lt;- nls(formula = rate ~ ((Vm + delV * (state == "treated"))
   * conc)/(K + conc), data = Puromycin,
   start = list(Vm = 160, delV = 40, K = 0.05))
 Pur.prof &lt;- profile(Purboth)
 pairs_profile(Pur.prof, plot.ellipse = TRUE)
 
 # Show the corresponding plot from MASS/stats:
 if (getRversion() &lt; "4.4.0") {
   loadNamespace("MASS")
 } else
   loadNamespace("stats")
   
 graphics::pairs(Pur.prof)
</code></pre>

<hr>
<h2 id='plotcorr'>
Plot correlation matrix ellipses
</h2><span id='topic+plotcorr'></span>

<h3>Description</h3>

<p>This function plots a correlation matrix using ellipse-shaped glyphs for
each entry.  The ellipse represents a level curve of the density of a
bivariate normal with the matching correlation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotcorr(corr, outline = TRUE, col = 'grey', numbers = FALSE, 
         type = c("full","lower","upper"),
	       diag = (type == "full"), bty = "n", axes = FALSE,
	       xlab = "", ylab = "", asp = 1,
	       cex.lab = par("cex.lab"), cex = 0.75*par("cex"),
	       mar = 0.1 + c(2,2,4,2), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotcorr_+3A_corr">corr</code></td>
<td>

<p>A matrix containing entries between <code>-1</code> and <code>1</code> to be plotted as
correlations.
</p>
</td></tr>
<tr><td><code id="plotcorr_+3A_outline">outline</code></td>
<td>

<p>Whether the ellipses should be outlined in the default colour.
</p>
</td></tr>
<tr><td><code id="plotcorr_+3A_col">col</code></td>
<td>

<p>Which colour(s) to use to fill the ellipses.
</p>
</td></tr>
<tr><td><code id="plotcorr_+3A_numbers">numbers</code></td>
<td>

<p>Whether to plot numerical correlations in place of ellipses.  If
numbers is <code>TRUE</code>, then the correlations will be rounded to a single decimal
place and placed on the plot.
</p>
</td></tr>
<tr><td><code id="plotcorr_+3A_type">type</code></td>
<td>
<p>Character. Plot <code>"full"</code> matrix or just <code>"upper"</code> or
<code>"lower"</code> triangular part of it.</p>
</td></tr>
<tr><td><code id="plotcorr_+3A_diag">diag</code></td>
<td>
<p>Logical. Plot diagonal elements or not. </p>
</td></tr>
<tr><td><code id="plotcorr_+3A_bty">bty</code>, <code id="plotcorr_+3A_axes">axes</code>, <code id="plotcorr_+3A_xlab">xlab</code>, <code id="plotcorr_+3A_ylab">ylab</code>, <code id="plotcorr_+3A_asp">asp</code>, <code id="plotcorr_+3A_mar">mar</code>, <code id="plotcorr_+3A_cex.lab">cex.lab</code>, <code id="plotcorr_+3A_...">...</code></td>
<td>
<p>Graphical parameters
which will be passed to <code><a href="graphics.html#topic+plot">plot</a></code> when plotting.</p>
</td></tr>
<tr><td><code id="plotcorr_+3A_cex">cex</code></td>
<td>
<p>Graphical parameter
which will be passed to <code><a href="graphics.html#topic+text">text</a></code> when plotting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ellipses being plotted will be tangent to a unit character square,
with the shape chosen to match the required correlation.  If <code>numbers = FALSE</code>,
the <code>col</code> vector will be recycled to colour each of the ellipses; if
<code>TRUE</code>, it will be ignored.
</p>


<h3>Author(s)</h3>

<p>Duncan Murdoch; Gregor Gorjanc suggested the <code>type</code> and <code>diag</code>
options.</p>


<h3>References</h3>

<p>Murdoch, D.J. and Chow, E.D. (1996). A graphical display of large
correlation matrices. The American Statistician 50, 178-180. <a href="https://doi.org/10.2307/2684435">doi:10.2307/2684435</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ellipse">ellipse</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>save.par &lt;- par(ask = interactive())

# Plot the correlation matrix for the mtcars data full model fit 
data(mtcars)
fit &lt;- lm(mpg ~ ., mtcars)
plotcorr(summary(fit, correlation = TRUE)$correlation)

# Plot a second figure with numbers in place of the
# ellipses
plotcorr(summary(fit, correlation = TRUE)$correlation, numbers = TRUE)

# Colour the ellipses to emphasize the differences.  The color range
# is based on RColorBrewer's Reds and Blues (suggested by Gregor Gorjanc)

corr.mtcars &lt;- cor(mtcars)
ord &lt;- order(corr.mtcars[1,])
xc &lt;- corr.mtcars[ord, ord]
colors &lt;- c("#A50F15","#DE2D26","#FB6A4A","#FCAE91","#FEE5D9","white",
            "#EFF3FF","#BDD7E7","#6BAED6","#3182BD","#08519C")   
plotcorr(xc, col=colors[5*xc + 6])

plotcorr(xc, col=colors[5*xc + 6], type = "upper")
plotcorr(xc, col=colors[5*xc + 6], type = "lower", diag = TRUE)
par(save.par)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
