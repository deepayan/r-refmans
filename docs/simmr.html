<!DOCTYPE html><html><head><title>Help for package simmr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {simmr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#simmr'><p>simmr: A package for fitting stable isotope mixing models via JAGS and</p>
FFVB in R</a></li>
<li><a href='#combine_sources'><p>Combine the dietary proportions from two food sources after running simmr</p></a></li>
<li><a href='#compare_groups'><p>Compare dietary proportions for a single source across different groups</p></a></li>
<li><a href='#compare_sources'><p>Compare dietary proportions between multiple sources</p></a></li>
<li><a href='#geese_data'><p>Geese stable isotope mixing data set</p></a></li>
<li><a href='#geese_data_day1'><p>A smaller version of the Geese stable isotope mixing data set</p></a></li>
<li><a href='#plot.simmr_input'><p>Plot the <code>simmr_input</code> data created from <code>simmr_load</code></p></a></li>
<li><a href='#plot.simmr_output'><p>Plot different features of an object created from <code>simmr_mcmc</code></p>
or <code>simmr_ffvb</code>.</a></li>
<li><a href='#posterior_predictive'><p>Plot the posterior predictive distribution for a simmr run</p></a></li>
<li><a href='#print.simmr_input'><p>Print simmr input object</p></a></li>
<li><a href='#print.simmr_output'><p>Print simmr output object</p></a></li>
<li><a href='#prior_viz'><p>Plot the prior distribution for a simmr run</p></a></li>
<li><a href='#simmr_data_1'><p>A simple fake stable isotope mixing data set</p></a></li>
<li><a href='#simmr_data_2'><p>A 3-isotope fake stable isotope mixing data set</p></a></li>
<li><a href='#simmr_elicit'><p>Function to allow informative prior distribution to be included in simmr</p></a></li>
<li><a href='#simmr_ffvb'><p>Run a <code>simmr_input</code> object through the Fixed Form Variational</p>
Bayes(FFVB) function</a></li>
<li><a href='#simmr_load'><p>Function to load in simmr data and check for errors</p></a></li>
<li><a href='#simmr_mcmc'><p>Run a <code>simmr_input</code> object through the main simmr Markov chain Monte</p>
Carlo (MCMC) function</a></li>
<li><a href='#square_data'><p>An artificial data set used to indicate effect of priors</p></a></li>
<li><a href='#summary.simmr_output'><p>Summarises the output created with <code>simmr_mcmc</code> or</p>
<code>simmr_ffvb</code></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Stable Isotope Mixing Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.1.216</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-02</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/andrewcparnell/simmr">https://github.com/andrewcparnell/simmr</a>,
<a href="https://andrewcparnell.github.io/simmr/">https://andrewcparnell.github.io/simmr/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/andrewcparnell/simmr/issues">https://github.com/andrewcparnell/simmr/issues</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits Stable Isotope Mixing Models (SIMMs) and is meant as a longer term replacement to the previous widely-used package SIAR. SIMMs are used to infer dietary proportions of organisms consuming various food sources from observations on the stable isotope values taken from the organisms' tissue samples. However SIMMs can also be used in other scenarios, such as in sediment mixing or the composition of fatty acids. The main functions are simmr_load() and simmr_mcmc(). The two vignettes contain a quick start and a full listing of all the features. The methods used are detailed in the papers Parnell et al 2010 &lt;<a href="https://doi.org/10.1371%2Fjournal.pone.0009672">doi:10.1371/journal.pone.0009672</a>&gt;, and Parnell et al 2013 &lt;<a href="https://doi.org/10.1002%2Fenv.2221">doi:10.1002/env.2221</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), R2jags, ggplot2</td>
</tr>
<tr>
<td>Imports:</td>
<td>compositions, boot, reshape2, graphics, stats, viridis,
bayesplot, checkmate, Rcpp, GGally</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, readxl, testthat, covr, vdiffr, tibble,
ggnewscale</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-27 13:53:10 UTC; emmagovan</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-27 14:20:02 UTC</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, RcppDist,</td>
</tr>
<tr>
<td>Author:</td>
<td>Emma Govan [cre, aut],
  Andrew Parnell [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Emma Govan &lt;emma.govan.2021@mumail.ie&gt;</td>
</tr>
</table>
<hr>
<h2 id='simmr'>simmr: A package for fitting stable isotope mixing models via JAGS and
FFVB in R</h2><span id='topic+simmr'></span><span id='topic+simmr-package'></span>

<h3>Description</h3>

<p>This package runs a
simple Stable Isotope Mixing Model (SIMM) and is meant as a longer term
replacement to the previous function SIAR.. These are used to infer dietary
proportions of organisms consuming various food sources from observations on
the stable isotope values taken from the organisms' tissue samples. However
SIMMs can also be used in other scenarios, such as in sediment mixing or the
composition of fatty acids. The main functions are <code><a href="#topic+simmr_load">simmr_load</a></code>,
<code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code>, and <code><a href="#topic+simmr_ffvb">simmr_ffvb</a></code>. The help files 
contain examples of the use of this package. See also the vignette for a 
longer walkthrough.
</p>


<h3>Details</h3>

<p>An even longer term replacement for properly running SIMMs is MixSIAR, which
allows for more detailed random effects and the inclusion of covariates.
</p>


<h3>Author(s)</h3>

<p>Andrew Parnell &lt;andrew.parnell@mu.ie&gt;
</p>


<h3>References</h3>

<p>Andrew C. Parnell, Donald L. Phillips, Stuart Bearhop, Brice X.
Semmens, Eric J. Ward, Jonathan W. Moore, Andrew L. Jackson, Jonathan Grey,
David J. Kelly, and Richard Inger. Bayesian stable isotope mixing models.
Environmetrics, 24(6):387â€“399, 2013.
</p>
<p>Andrew C Parnell, Richard Inger, Stuart Bearhop, and Andrew L Jackson.
Source partitioning using stable isotopes: coping with too much variation.
PLoS ONE, 5(3):5, 2010.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# A first example with 2 tracers (isotopes), 10 observations, and 4 food sources
data(geese_data_day1)
simmr_in &lt;- with(
  geese_data_day1,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot
plot(simmr_in)

# MCMC run
simmr_out &lt;- simmr_mcmc(simmr_in)

# Check convergence - values should all be close to 1
summary(simmr_out, type = "diagnostics")

# Look at output
summary(simmr_out, type = "statistics")

# Look at influence of priors
prior_viz(simmr_out)

# Plot output
plot(simmr_out, type = "histogram")

</code></pre>

<hr>
<h2 id='combine_sources'>Combine the dietary proportions from two food sources after running simmr</h2><span id='topic+combine_sources'></span>

<h3>Description</h3>

<p>This function takes in an object of class <code>simmr_output</code> and combines
two of the food sources. It works for single and multiple group data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine_sources(
  simmr_out,
  to_combine = NULL,
  new_source_name = "combined_source"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combine_sources_+3A_simmr_out">simmr_out</code></td>
<td>
<p>An object of class <code>simmr_output</code> created from
<code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> or <code><a href="#topic+simmr_ffvb">simmr_ffvb</a></code></p>
</td></tr>
<tr><td><code id="combine_sources_+3A_to_combine">to_combine</code></td>
<td>
<p>The names of exactly two sources. These should match the
names given to <code><a href="#topic+simmr_load">simmr_load</a></code>.</p>
</td></tr>
<tr><td><code id="combine_sources_+3A_new_source_name">new_source_name</code></td>
<td>
<p>A name to give to the new combined source.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Often two sources either (1) lie in similar location on the iso-space plot,
or (2) are very similar in phylogenetic terms. In case (1) it is common to
experience high (negative) posterior correlations between the sources.
Combining them can reduce this correlation and improve precision of the
estimates. In case (2) we might wish to determine the joint amount eaten of
the two sources when combined. This function thus combines two sources after
a run of <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> or <code><a href="#topic+simmr_ffvb">simmr_ffvb</a></code> (known as
a posteriori combination). The new object can then be called with
<code><a href="#topic+plot.simmr_input">plot.simmr_input</a></code> or <code><a href="#topic+plot.simmr_output">plot.simmr_output</a></code> to
produce iso-space plots of summaries of the output after combination.
</p>


<h3>Value</h3>

<p>A new <code>simmr_output</code> object
</p>


<h3>Author(s)</h3>

<p>Andrew Parnell &lt;andrew.parnell@mu.ie&gt;, Emma Govan
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> and <code><a href="#topic+simmr_ffvb">simmr_ffvb</a></code> and
the associated vignette for examples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# The data
data(geese_data)

# Load into simmr
simmr_1 &lt;- with(
  geese_data_day1,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot
plot(simmr_1)

# Print
simmr_1

# MCMC run
simmr_1_out &lt;- simmr_mcmc(simmr_1)

# Print it
print(simmr_1_out)

# Summary
summary(simmr_1_out)
summary(simmr_1_out, type = "diagnostics")
summary(simmr_1_out, type = "correlations")
summary(simmr_1_out, type = "statistics")
ans &lt;- summary(simmr_1_out, type = c("quantiles", "statistics"))

# Plot
plot(simmr_1_out)
plot(simmr_1_out, type = "boxplot")
plot(simmr_1_out, type = "histogram")
plot(simmr_1_out, type = "density")
plot(simmr_1_out, type = "matrix")

simmr_out_combine &lt;- combine_sources(simmr_1_out,
  to_combine = c("U.lactuca", "Enteromorpha"),
  new_source_name = "U.lac+Ent"
)
plot(simmr_out_combine$input)
plot(simmr_out_combine, type = "boxplot", title = "simmr output: combined sources")

</code></pre>

<hr>
<h2 id='compare_groups'>Compare dietary proportions for a single source across different groups</h2><span id='topic+compare_groups'></span>

<h3>Description</h3>

<p>This function takes in an object of class <code>simmr_output</code> and creates
probabilistic comparisons for a given source and a set of at least two
groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_groups(
  simmr_out,
  source_name = simmr_out$input$source_names[1],
  groups = 1:2,
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_groups_+3A_simmr_out">simmr_out</code></td>
<td>
<p>An object of class <code>simmr_output</code> created from
<code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> or <code><a href="#topic+simmr_ffvb">simmr_ffvb</a></code>.</p>
</td></tr>
<tr><td><code id="compare_groups_+3A_source_name">source_name</code></td>
<td>
<p>The name of a source. This should match the names exactly
given to <code><a href="#topic+simmr_load">simmr_load</a></code>.</p>
</td></tr>
<tr><td><code id="compare_groups_+3A_groups">groups</code></td>
<td>
<p>The integer values of the group numbers to be compared. At
least two groups must be specified.</p>
</td></tr>
<tr><td><code id="compare_groups_+3A_plot">plot</code></td>
<td>
<p>A logical value specifying whether plots should be produced or
not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When two groups are specified, the function produces a direct calculation of
the probability that one group is bigger than the other. When more than two
groups are given, the function produces a set of most likely probabilistic
orderings for each combination of groups. The function produces boxplots by
default and also allows for the storage of the output for further analysis if
required.
</p>


<h3>Value</h3>

<p>If there are two groups, a vector containing the differences between
the two groups proportions for that source. If there are multiple groups, a
list containing the following fields: </p>
<table>
<tr><td><code>Ordering</code></td>
<td>
<p>The different
possible orderings of the dietary proportions across groups</p>
</td></tr> <tr><td><code>out_all</code></td>
<td>
<p>The dietary proportions for this source across the groups specified as
columns in a matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andrew Parnell &lt;andrew.parnell@mu.ie&gt;
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> for complete examples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(geese_data)
simmr_in &lt;- with(
  geese_data,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means,
    group = groups
  )
)

# Print
simmr_in

# Plot
plot(simmr_in,
  group = 1:8, xlab = expression(paste(delta^13, "C (per mille)", sep = "")),
  ylab = expression(paste(delta^15, "N (per mille)", sep = "")),
  title = "Isospace plot of Inger et al Geese data"
)

# Run MCMC for each group
simmr_out &lt;- simmr_ffvb(simmr_in)

# Print output
simmr_out

# Summarise output
summary(simmr_out, type = "quantiles", group = 1)
summary(simmr_out, type = "quantiles", group = c(1, 3))
summary(simmr_out, type = c("quantiles", "statistics"), group = c(1, 3))

# Plot - only a single group allowed
plot(simmr_out, type = "boxplot", group = 2, title = "simmr output group 2")
plot(simmr_out, type = c("density", "matrix"), grp = 6, title = "simmr output group 6")

# Compare groups
compare_groups(simmr_out, source = "Zostera", groups = 1:2)
compare_groups(simmr_out, source = "Zostera", groups = 1:3)
compare_groups(simmr_out, source = "U.lactuca", groups = c(4:5, 7, 2))

## End(Not run)

</code></pre>

<hr>
<h2 id='compare_sources'>Compare dietary proportions between multiple sources</h2><span id='topic+compare_sources'></span>

<h3>Description</h3>

<p>This function takes in an object of class <code>simmr_output</code> and creates
probabilistic comparisons between the supplied sources. The group number can
also be specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_sources(
  simmr_out,
  source_names = simmr_out$input$source_names,
  group = 1,
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_sources_+3A_simmr_out">simmr_out</code></td>
<td>
<p>An object of class <code>simmr_output</code> created from
<code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> or <code><a href="#topic+simmr_ffvb">simmr_ffvb</a></code>.</p>
</td></tr>
<tr><td><code id="compare_sources_+3A_source_names">source_names</code></td>
<td>
<p>The names of at least two sources. These should match
the names exactly given to <code><a href="#topic+simmr_load">simmr_load</a></code>.</p>
</td></tr>
<tr><td><code id="compare_sources_+3A_group">group</code></td>
<td>
<p>The integer values of the group numbers to be compared. If not
specified assumes the first or only group</p>
</td></tr>
<tr><td><code id="compare_sources_+3A_plot">plot</code></td>
<td>
<p>A logical value specifying whether plots should be produced or
not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When two sources are specified, the function produces a direct calculation
of the probability that the dietary proportion for one source is bigger than
the other. When more than two sources are given, the function produces a set
of most likely probabilistic orderings for each combination of sources. The
function produces boxplots by default and also allows for the storage of the
output for further analysis if required.
</p>


<h3>Value</h3>

<p>If there are two sources, a vector containing the differences
between the two dietary proportion proportions for these two sources. If
there are multiple sources, a list containing the following fields:
</p>
<table>
<tr><td><code>Ordering</code></td>
<td>
<p>The different possible orderings of the dietary proportions
across sources</p>
</td></tr> <tr><td><code>out_all</code></td>
<td>
<p>The dietary proportions for these sources
specified as columns in a matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andrew Parnell &lt;andrew.parnell@mu.ie&gt;
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> for complete examples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(geese_data_day1)
simmr_1 &lt;- with(
  geese_data_day1,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot
plot(simmr_1)

# Print
simmr_1

# MCMC run
simmr_1_out &lt;- simmr_mcmc(simmr_1)

# Print it
print(simmr_1_out)

# Summary
summary(simmr_1_out)
summary(simmr_1_out, type = "diagnostics")
summary(simmr_1_out, type = "correlations")
summary(simmr_1_out, type = "statistics")
ans &lt;- summary(simmr_1_out, type = c("quantiles", "statistics"))

# Plot
plot(simmr_1_out, type = "boxplot")
plot(simmr_1_out, type = "histogram")
plot(simmr_1_out, type = "density")
plot(simmr_1_out, type = "matrix")

# Compare two sources
compare_sources(simmr_1_out, source_names = c("Zostera", "Grass"))

# Compare multiple sources
compare_sources(simmr_1_out)


</code></pre>

<hr>
<h2 id='geese_data'>Geese stable isotope mixing data set</h2><span id='topic+geese_data'></span>

<h3>Description</h3>

<p>A real Geese data set with 251 observations on 2 isotopes, with 4 sources, and with corrections/trophic enrichment factors (TEFs or TDFs), and concentration dependence means. Taken from Inger et al (2016). See link for paper
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geese_data
</code></pre>


<h3>Format</h3>

<p>A list with the following elements
</p>

<dl>
<dt>mixtures</dt><dd><p>A two column matrix containing delta 13C and delta 15N values respectively</p>
</dd>
<dt>source_names</dt><dd><p>A character vector of the food source names</p>
</dd>
<dt>tracer_names</dt><dd><p>A character vector of the tracer names (d13C, d15N, d34S)</p>
</dd>
<dt>source_means</dt><dd><p>A matrix of source mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>source_sds</dt><dd><p>A matrix of source sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_means</dt><dd><p>A matrix of TEFs mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_sds</dt><dd><p>A matrix of TEFs sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>concentration_means</dt><dd><p>A matrix of concentration dependence mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
</dl>
<p>...
</p>
<p>@seealso <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> for an example where it is used

</p>


<h3>Source</h3>

<p>&lt;doi:10.1111/j.1365-2656.2006.01142.x&gt;
</p>

<hr>
<h2 id='geese_data_day1'>A smaller version of the Geese stable isotope mixing data set</h2><span id='topic+geese_data_day1'></span>

<h3>Description</h3>

<p>A real Geese data set with 9 observations on 2 isotopes, with 4 sources, and with corrections/trophic enrichment factors (TEFs or TDFs), and concentration dependence means. Taken from Inger et al (2016). See link for paper
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geese_data_day1
</code></pre>


<h3>Format</h3>

<p>A list with the following elements
</p>

<dl>
<dt>mixtures</dt><dd><p>A two column matrix containing delta 13C and delta 15N values respectively</p>
</dd>
<dt>source_names</dt><dd><p>A character vector of the food source names</p>
</dd>
<dt>tracer_names</dt><dd><p>A character vector of the tracer names (d13C, d15N, d34S)</p>
</dd>
<dt>source_means</dt><dd><p>A matrix of source mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>source_sds</dt><dd><p>A matrix of source sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_means</dt><dd><p>A matrix of TEFs mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_sds</dt><dd><p>A matrix of TEFs sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>concentration_means</dt><dd><p>A matrix of concentration dependence mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
</dl>
<p>...
</p>
<p>@seealso <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> for an example where it is used

</p>


<h3>Source</h3>

<p>&lt;doi:10.1111/j.1365-2656.2006.01142.x&gt;
</p>

<hr>
<h2 id='plot.simmr_input'>Plot the <code>simmr_input</code> data created from <code>simmr_load</code></h2><span id='topic+plot.simmr_input'></span>

<h3>Description</h3>

<p>This function creates iso-space (AKA tracer-space or delta-space) plots.
They are vital in determining whether the data are suitable for running in a
SIMM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simmr_input'
plot(
  x,
  tracers = c(1, 2),
  title = "Tracers plot",
  xlab = colnames(x$mixtures)[tracers[1]],
  ylab = colnames(x$mixtures)[tracers[2]],
  sigmas = 1,
  group = 1:x$n_groups,
  mix_name = "Mixtures",
  ggargs = NULL,
  colour = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.simmr_input_+3A_x">x</code></td>
<td>
<p>An object of class <code>simmr_input</code> created via the function 
<code><a href="#topic+simmr_load">simmr_load</a></code></p>
</td></tr>
<tr><td><code id="plot.simmr_input_+3A_tracers">tracers</code></td>
<td>
<p>The choice of tracers to plot. If there are more than two
tracers, it is recommended to plot every pair of tracers to determine
whether the mixtures lie in the mixing polygon defined by the sources</p>
</td></tr>
<tr><td><code id="plot.simmr_input_+3A_title">title</code></td>
<td>
<p>A title for the graph</p>
</td></tr>
<tr><td><code id="plot.simmr_input_+3A_xlab">xlab</code></td>
<td>
<p>The x-axis label. By default this is assumed to be delta-13C but
can be made richer if required. See examples below.</p>
</td></tr>
<tr><td><code id="plot.simmr_input_+3A_ylab">ylab</code></td>
<td>
<p>The y-axis label. By default this is assumed to be delta-15N in
per mil but can be changed as with the x-axis label</p>
</td></tr>
<tr><td><code id="plot.simmr_input_+3A_sigmas">sigmas</code></td>
<td>
<p>The number of standard deviations to plot on the source
values. Defaults to 1.</p>
</td></tr>
<tr><td><code id="plot.simmr_input_+3A_group">group</code></td>
<td>
<p>Which groups to plot. Can be a single group or multiple groups</p>
</td></tr>
<tr><td><code id="plot.simmr_input_+3A_mix_name">mix_name</code></td>
<td>
<p>A optional string containing the name of the mixture
objects, e.g. Geese.</p>
</td></tr>
<tr><td><code id="plot.simmr_input_+3A_ggargs">ggargs</code></td>
<td>
<p>Extra arguments to be included in the ggplot (e.g. axis limits)</p>
</td></tr>
<tr><td><code id="plot.simmr_input_+3A_colour">colour</code></td>
<td>
<p>If TRUE (default) creates a plot. If not, puts the plot in
black and white</p>
</td></tr>
<tr><td><code id="plot.simmr_input_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is desirable to have the vast majority of the mixture observations to be
inside the convex hull defined by the food sources. When there are more than
two tracers (as in one of the examples below) it is recommended to plot all
the different pairs of the food sources. See the vignette for further
details of richer plots.
</p>


<h3>Value</h3>

<p>isospace plot
</p>


<h3>Author(s)</h3>

<p>Andrew Parnell &lt;andrew.parnell@mu.ie&gt;
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+plot.simmr_output">plot.simmr_output</a></code> for plotting the output of a
simmr run. See <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> for running a simmr object once the
iso-space is deemed acceptable.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# A simple example with 10 observations, 4 food sources and 2 tracers
data(geese_data_day1)
simmr_1 &lt;- with(
  geese_data_day1,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot
plot(simmr_1)

### A more complicated example with 30 obs, 3 tracers and 4 sources
data(simmr_data_2)
simmr_3 &lt;- with(
  simmr_data_2,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot 3 times - first default d13C vs d15N
plot(simmr_3)
# Now plot d15N vs d34S
plot(simmr_3, tracers = c(2, 3))
# and finally d13C vs d34S
plot(simmr_3, tracers = c(1, 3))
# See vignette('simmr') for fancier x-axis labels

# An example with multiple groups - the Geese data from Inger et al 2006
data(geese_data)
simmr_4 &lt;- with(
  geese_data,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means,
    group = groups
  )
)

# Print
simmr_4

# Plot
plot(simmr_4,
  xlab = expression(paste(delta^13, "C (per mille)", sep = "")),
  ylab = expression(paste(delta^15, "N (per mille)", sep = "")),
  title = "Isospace plot of Inger et al Geese data"
) #'
</code></pre>

<hr>
<h2 id='plot.simmr_output'>Plot different features of an object created from <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code>
or <code><a href="#topic+simmr_ffvb">simmr_ffvb</a></code>.</h2><span id='topic+plot.simmr_output'></span>

<h3>Description</h3>

<p>This function allows for 4 different types of plots of the simmr output
created from <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> or <code><a href="#topic+simmr_ffvb">simmr_ffvb</a></code>. The
types are: histogram, kernel density plot, matrix plot (most useful) and
boxplot. There are some minor customisation options.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simmr_output'
plot(
  x,
  type = c("isospace", "histogram", "density", "matrix", "boxplot"),
  group = 1,
  binwidth = 0.05,
  alpha = 0.5,
  title = if (length(group) == 1) {
     "simmr output plot"
 } else {
    
    paste("simmr output plot: group", group)
 },
  ggargs = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.simmr_output_+3A_x">x</code></td>
<td>
<p>An object of class <code>simmr_output</code> created via
<code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> or <code><a href="#topic+simmr_ffvb">simmr_ffvb</a></code>.</p>
</td></tr>
<tr><td><code id="plot.simmr_output_+3A_type">type</code></td>
<td>
<p>The type of plot required. Can be one or more of 'histogram',
'density', 'matrix', or 'boxplot'</p>
</td></tr>
<tr><td><code id="plot.simmr_output_+3A_group">group</code></td>
<td>
<p>Which group(s) to plot.</p>
</td></tr>
<tr><td><code id="plot.simmr_output_+3A_binwidth">binwidth</code></td>
<td>
<p>The width of the bins for the histogram. Defaults to 0.05</p>
</td></tr>
<tr><td><code id="plot.simmr_output_+3A_alpha">alpha</code></td>
<td>
<p>The degree of transparency of the plots. Not relevant for
matrix plots</p>
</td></tr>
<tr><td><code id="plot.simmr_output_+3A_title">title</code></td>
<td>
<p>The title of the plot.</p>
</td></tr>
<tr><td><code id="plot.simmr_output_+3A_ggargs">ggargs</code></td>
<td>
<p>Extra arguments to be included in the ggplot (e.g. axis limits)</p>
</td></tr>
<tr><td><code id="plot.simmr_output_+3A_...">...</code></td>
<td>
<p>Currently not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The matrix plot should form a necessary part of any SIMM analysis since it
allows the user to judge which sources are identifiable by the model.
Further detail about these plots is provided in the vignette.
Some code from
https://stackoverflow.com/questions/14711550/is-there-a-way-to-change-the-color-palette-for-ggallyggpairs-using-ggplot
accessed March 2023
</p>


<h3>Value</h3>

<p>one or more of  'histogram', 'density', 'matrix', or 'boxplot'
</p>


<h3>Author(s)</h3>

<p>Andrew Parnell &lt;andrew.parnell@mu.ie&gt;, Emma Govan
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> and <code><a href="#topic+simmr_ffvb">simmr_ffvb</a></code> for
creating objects suitable for this function, and many more examples. See
also <code><a href="#topic+simmr_load">simmr_load</a></code> for creating simmr objects,
<code><a href="#topic+plot.simmr_input">plot.simmr_input</a></code> for creating isospace plots,
<code><a href="#topic+summary.simmr_output">summary.simmr_output</a></code> for summarising output.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# A simple example with 10 observations, 2 tracers and 4 sources

# The data
data(geese_data)

# Load into simmr
simmr_1 &lt;- with(
  geese_data_day1,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)
# Plot
plot(simmr_1)


# MCMC run
simmr_1_out &lt;- simmr_mcmc(simmr_1)

# Plot
plot(simmr_1_out) # Creates all 4 plots
plot(simmr_1_out, type = "boxplot")
plot(simmr_1_out, type = "histogram")
plot(simmr_1_out, type = "density")
plot(simmr_1_out, type = "matrix")

</code></pre>

<hr>
<h2 id='posterior_predictive'>Plot the posterior predictive distribution for a simmr run</h2><span id='topic+posterior_predictive'></span>

<h3>Description</h3>

<p>This function takes the output from <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code>and plots the 
posterior predictive distribution to enable visualisation of model fit. 
The simulated posterior predicted values are returned as part of the 
object and can be saved for external use
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posterior_predictive(simmr_out, group = 1, prob = 0.5, plot_ppc = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="posterior_predictive_+3A_simmr_out">simmr_out</code></td>
<td>
<p>A run of the simmr model from <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code></p>
</td></tr>
<tr><td><code id="posterior_predictive_+3A_group">group</code></td>
<td>
<p>Which group to run it for (currently only numeric rather than group names)</p>
</td></tr>
<tr><td><code id="posterior_predictive_+3A_prob">prob</code></td>
<td>
<p>The probability interval for the posterior predictives. The default is 0.5 (i.e. 50pc intervals)</p>
</td></tr>
<tr><td><code id="posterior_predictive_+3A_plot_ppc">plot_ppc</code></td>
<td>
<p>Whether to create a bayesplot of the posterior predictive or not.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot of posterior predictives and simulated values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(geese_data_day1)
simmr_1 &lt;- with(
  geese_data_day1,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot
plot(simmr_1)

# Print
simmr_1

# MCMC run
simmr_1_out &lt;- simmr_mcmc(simmr_1)

# Prior predictive
post_pred &lt;- posterior_predictive(simmr_1_out)

</code></pre>

<hr>
<h2 id='print.simmr_input'>Print simmr input object</h2><span id='topic+print.simmr_input'></span>

<h3>Description</h3>

<p>Print simmr input object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simmr_input'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.simmr_input_+3A_x">x</code></td>
<td>
<p>An object of class <code>simmr_input</code></p>
</td></tr>
<tr><td><code id="print.simmr_input_+3A_...">...</code></td>
<td>
<p>Other arguments (not supported)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A neat presentation of your simmr object.
</p>

<hr>
<h2 id='print.simmr_output'>Print simmr output object</h2><span id='topic+print.simmr_output'></span>

<h3>Description</h3>

<p>Print simmr output object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simmr_output'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.simmr_output_+3A_x">x</code></td>
<td>
<p>An object of class <code>simmr_output</code></p>
</td></tr>
<tr><td><code id="print.simmr_output_+3A_...">...</code></td>
<td>
<p>Other arguments (not supported)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a neat summary of the object
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> and <code><a href="#topic+simmr_ffvb">simmr_ffvb</a></code> for creating
<code>simmr_output</code> objects
</p>

<hr>
<h2 id='prior_viz'>Plot the prior distribution for a simmr run</h2><span id='topic+prior_viz'></span>

<h3>Description</h3>

<p>This function takes the output from <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> or
<code><a href="#topic+simmr_ffvb">simmr_ffvb</a></code> and plots the prior distribution to enable visual
inspection. This can be used by itself or together with
<code><a href="#topic+posterior_predictive">posterior_predictive</a></code> to visually evaluate the influence of
the prior on the posterior distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prior_viz(
  simmr_out,
  group = 1,
  plot = TRUE,
  include_posterior = TRUE,
  n_sims = 10000,
  scales = "free"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prior_viz_+3A_simmr_out">simmr_out</code></td>
<td>
<p>A run of the simmr model from <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> or
<code><a href="#topic+simmr_ffvb">simmr_ffvb</a></code></p>
</td></tr>
<tr><td><code id="prior_viz_+3A_group">group</code></td>
<td>
<p>Which group to run it for (currently only numeric rather than group names)</p>
</td></tr>
<tr><td><code id="prior_viz_+3A_plot">plot</code></td>
<td>
<p>Whether to create a density plot of the prior or not. The simulated prior values are returned as part of the object</p>
</td></tr>
<tr><td><code id="prior_viz_+3A_include_posterior">include_posterior</code></td>
<td>
<p>Whether to include the posterior distribution on top of the priors. Defaults to TRUE</p>
</td></tr>
<tr><td><code id="prior_viz_+3A_n_sims">n_sims</code></td>
<td>
<p>The number of simulations from the prior distribution</p>
</td></tr>
<tr><td><code id="prior_viz_+3A_scales">scales</code></td>
<td>
<p>The type of scale from <code>facet_wrap</code> allowing for <code>fixed</code>, <code>free</code>, <code>free_x</code>, <code>free_y</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing <code>plot</code>: the ggplot object (useful if requires customisation), and <code>sim</code>: the simulated prior values which can be compared with the posterior densities
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(geese_data_day1)
simmr_1 &lt;- with(
  geese_data_day1,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot
plot(simmr_1)

# Print
simmr_1

# MCMC run
simmr_1_out &lt;- simmr_mcmc(simmr_1)

# Prior predictive
prior &lt;- prior_viz(simmr_1_out)
head(prior$p_prior_sim)
summary(prior$p_prior_sim)

</code></pre>

<hr>
<h2 id='simmr_data_1'>A simple fake stable isotope mixing data set</h2><span id='topic+simmr_data_1'></span>

<h3>Description</h3>

<p>A simple fake data set with 10 observations on 2 isotopes, with 4 sources, and with corrections/trophic enrichment factors (TEFs or TDFs), and concentration dependence means
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simmr_data_1
</code></pre>


<h3>Format</h3>

<p>A list with the following elements
</p>

<dl>
<dt>mixtures</dt><dd><p>A two column matrix containing delta 13C and delta 15N values respectively</p>
</dd>
<dt>source_names</dt><dd><p>A character vector of the food source names</p>
</dd>
<dt>tracer_names</dt><dd><p>A character vector of the tracer names (d13C and d15N)</p>
</dd>
<dt>source_means</dt><dd><p>A matrix of source mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>source_sds</dt><dd><p>A matrix of source sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_means</dt><dd><p>A matrix of TEFs mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_sds</dt><dd><p>A matrix of TEFs sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>concentration_means</dt><dd><p>A matrix of concentration dependence mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
</dl>
<p>...
</p>
<p>@seealso <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> for an example where it is used
</p>


<hr>
<h2 id='simmr_data_2'>A 3-isotope fake stable isotope mixing data set</h2><span id='topic+simmr_data_2'></span>

<h3>Description</h3>

<p>A fake data set with 30 observations on 3 isotopes, with 4 sources, and with corrections/trophic enrichment factors (TEFs or TDFs), and concentration dependence means
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simmr_data_2
</code></pre>


<h3>Format</h3>

<p>A list with the following elements
</p>

<dl>
<dt>mixtures</dt><dd><p>A three column matrix containing delta 13C, delta 15N, and delta 34S values respectively</p>
</dd>
<dt>source_names</dt><dd><p>A character vector of the food source names</p>
</dd>
<dt>tracer_names</dt><dd><p>A character vector of the tracer names (d13C, d15N, d34S)</p>
</dd>
<dt>source_means</dt><dd><p>A matrix of source mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>source_sds</dt><dd><p>A matrix of source sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_means</dt><dd><p>A matrix of TEFs mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_sds</dt><dd><p>A matrix of TEFs sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>concentration_means</dt><dd><p>A matrix of concentration dependence mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
</dl>
<p>...
</p>
<p>@seealso <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> for an example where it is used
</p>


<hr>
<h2 id='simmr_elicit'>Function to allow informative prior distribution to be included in simmr</h2><span id='topic+simmr_elicit'></span>

<h3>Description</h3>

<p>The main <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> function allows for a prior distribution
to be set for the dietary proportions. The prior distribution is specified
by transforming the dietary proportions using the centralised log ratio
(CLR). The <code><a href="#topic+simmr_elicit">simmr_elicit</a></code> and <code><a href="#topic+simmr_elicit">simmr_elicit</a></code>
functions allows the user to specify
prior means and standard deviations for each of the dietary proportions, and
then finds CLR-transformed values suitable for input into
<code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simmr_elicit(
  n_sources,
  proportion_means = rep(1/n_sources, n_sources),
  proportion_sds = rep(0.1, n_sources),
  n_sims = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simmr_elicit_+3A_n_sources">n_sources</code></td>
<td>
<p>The number of sources required</p>
</td></tr>
<tr><td><code id="simmr_elicit_+3A_proportion_means">proportion_means</code></td>
<td>
<p>The desired prior proportion means. These should sum
to 1. Should be a vector of length <code>n_sources</code></p>
</td></tr>
<tr><td><code id="simmr_elicit_+3A_proportion_sds">proportion_sds</code></td>
<td>
<p>The desired prior proportions standard deviations.
These have no restricted sum but should be reasonable estimates for a
proportion.</p>
</td></tr>
<tr><td><code id="simmr_elicit_+3A_n_sims">n_sims</code></td>
<td>
<p>The number of simulations for which to run the optimisation
routine.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function takes the desired proportion means and standard deviations,
and fits an optimised least squares to the means and standard deviations in
turn to produced CLR-transformed estimates for use in
<code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code>. Using prior information in SIMMs is highly
desirable given the restricted nature of the inference. The prior
information might come from previous studies, other experiments, or other
observations of e.g. animal behaviour.
</p>
<p>Due to the nature of the restricted space over which the dietary proportions
can span, and the fact that this function uses numerical optimisation, the
procedure will not match the target dietary proportion means and standard
deviations exactly. If this problem is severe, try increasing the
<code>n_sims</code> value.
</p>


<h3>Value</h3>

<p>A list object with two components </p>
<table>
<tr><td><code>mean</code></td>
<td>
<p>The best estimates of
the mean to use in <code>control.prior</code> in <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code></p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>The best estimates of the standard deviations to use in
<code>control.prior</code> in <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andrew Parnell &lt;andrew.parnell@mu.ie&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Data set: 10 observations, 2 tracers, 4 sources
data(geese_data_day1)
simmr_1 &lt;- with(
  geese_data_day1,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# MCMC run
simmr_1_out &lt;- simmr_mcmc(simmr_1)

# Look at the prior influence
prior_viz(simmr_1_out)

# Summary
summary(simmr_1_out, "quantiles")
# A bit vague:
#           2.5%   25%   50%   75% 97.5%
# Source A 0.029 0.115 0.203 0.312 0.498
# Source B 0.146 0.232 0.284 0.338 0.453
# Source C 0.216 0.255 0.275 0.296 0.342
# Source D 0.032 0.123 0.205 0.299 0.465

# Now suppose I had prior information that:
# proportion means = 0.5,0.2,0.2,0.1
# proportion sds = 0.08,0.02,0.01,0.02
prior &lt;- simmr_elicit(4, c(0.5, 0.2, 0.2, 0.1), c(0.08, 0.02, 0.01, 0.02))

simmr_1a_out &lt;- simmr_mcmc(simmr_1, prior_control = 
list(means = prior$mean, 
      sd = prior$sd, 
      sigma_shape = c(3,3), 
      sigma_rate = c(3/50, 3/50)))

#' # Look at the prior influence now
prior_viz(simmr_1a_out)

summary(simmr_1a_out, "quantiles")
# Much more precise:
#           2.5%   25%   50%   75% 97.5%
# Source A 0.441 0.494 0.523 0.553 0.610
# Source B 0.144 0.173 0.188 0.204 0.236
# Source C 0.160 0.183 0.196 0.207 0.228
# Source D 0.060 0.079 0.091 0.105 0.135

</code></pre>

<hr>
<h2 id='simmr_ffvb'>Run a <code>simmr_input</code> object through the Fixed Form Variational
Bayes(FFVB) function</h2><span id='topic+simmr_ffvb'></span>

<h3>Description</h3>

<p>This is the main function of simmr. It takes a <code>simmr_input</code> object
created via <code><a href="#topic+simmr_load">simmr_load</a></code>, runs it in fixed form
Variational Bayes to determine the dietary proportions, and then
outputs a <code>simmr_output</code> object for further analysis and plotting
via <code><a href="#topic+summary.simmr_output">summary.simmr_output</a></code> and <code><a href="#topic+plot.simmr_output">plot.simmr_output</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simmr_ffvb(
  simmr_in,
  prior_control = list(mu_0 = rep(0, simmr_in$n_sources), sigma_0 = 1),
  ffvb_control = list(n_output = 3600, S = 100, P = 10, beta_1 = 0.9, beta_2 = 0.9, tau =
    100, eps_0 = 0.0225, t_W = 50)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simmr_ffvb_+3A_simmr_in">simmr_in</code></td>
<td>
<p>An object created via the function <code><a href="#topic+simmr_load">simmr_load</a></code></p>
</td></tr>
<tr><td><code id="simmr_ffvb_+3A_prior_control">prior_control</code></td>
<td>
<p>A list of values including arguments named <code>mu_0</code>
(prior for mu), and <code>sigma_0</code> (prior for sigma).</p>
</td></tr>
<tr><td><code id="simmr_ffvb_+3A_ffvb_control">ffvb_control</code></td>
<td>
<p>A list of values including arguments named <code>n_output</code>
(number of rows in theta output), <code>S</code> (number of samples taken at each
iteration of the algorithm), <code>P</code> (patience parameter), <code>beta_1</code>
and <code>beta_2</code> (adaptive learning weights), <code>tau</code> (threshold for
exploring learning space), <code>eps_0</code> (fixed learning rate),
<code>t_W</code> (rolling window size)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>simmr_output</code> with two named top-level
components: </p>
<table>
<tr><td><code>input</code></td>
<td>
<p>The <code>simmr_input</code> object given to the
<code>simmr_ffvb</code> function</p>
</td></tr> <tr><td><code>output</code></td>
<td>
<p>A set of outputs produced by
the FFVB function. These can be analysed using the
<code><a href="#topic+summary.simmr_output">summary.simmr_output</a></code> and <code><a href="#topic+plot.simmr_output">plot.simmr_output</a></code>
functions.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andrew Parnell &lt;andrew.parnell@mu.ie&gt;, Emma Govan
</p>


<h3>References</h3>

<p>Andrew C. Parnell, Donald L. Phillips, Stuart Bearhop, Brice X.
Semmens, Eric J. Ward, Jonathan W. Moore, Andrew L. Jackson, Jonathan Grey,
David J. Kelly, and Richard Inger. Bayesian stable isotope mixing models.
Environmetrics, 24(6):387â€“399, 2013.
</p>
<p>Andrew C Parnell, Richard Inger, Stuart Bearhop, and Andrew L Jackson.
Source partitioning using stable isotopes: coping with too much variation.
PLoS ONE, 5(3):5, 2010.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simmr_load">simmr_load</a></code> for creating objects suitable for this
function, <code><a href="#topic+plot.simmr_input">plot.simmr_input</a></code> for creating isospace plots,
<code><a href="#topic+summary.simmr_output">summary.simmr_output</a></code> for summarising output, and
<code><a href="#topic+plot.simmr_output">plot.simmr_output</a></code> for plotting output.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## See the package vignette for a detailed run through of these 4 examples

# Data set 1: 10 obs on 2 isos, 4 sources, with tefs and concdep
data(geese_data_day1)
simmr_1 &lt;- with(
  geese_data_day1,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot
plot(simmr_1)

# Print
simmr_1

# FFVB run
simmr_1_out &lt;- simmr_ffvb(simmr_1)

# Print it
print(simmr_1_out)

# Summary
summary(simmr_1_out, type = "correlations")
summary(simmr_1_out, type = "statistics")
ans &lt;- summary(simmr_1_out, type = c("quantiles", "statistics"))

# Plot
plot(simmr_1_out, type = "boxplot")
plot(simmr_1_out, type = "histogram")
plot(simmr_1_out, type = "density")
plot(simmr_1_out, type = "matrix")

# Compare two sources
compare_sources(simmr_1_out, source_names = c("Zostera", "Enteromorpha"))

# Compare multiple sources
compare_sources(simmr_1_out)

#####################################################################################

# A version with just one observation
data(geese_data_day1)
simmr_2 &lt;- with(
  geese_data_day1,
  simmr_load(
    mixtures = mixtures[1, , drop = FALSE],
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot
plot(simmr_2)

# FFVB run - automatically detects the single observation
simmr_2_out &lt;- simmr_ffvb(simmr_2)

# Print it
print(simmr_2_out)

# Summary
summary(simmr_2_out)
ans &lt;- summary(simmr_2_out, type = c("quantiles"))

# Plot
plot(simmr_2_out)
plot(simmr_2_out, type = "boxplot")
plot(simmr_2_out, type = "histogram")
plot(simmr_2_out, type = "density")
plot(simmr_2_out, type = "matrix")

#####################################################################################

# Data set 2: 3 isotopes (d13C, d15N and d34S), 30 observations, 4 sources
data(simmr_data_2)
simmr_3 &lt;- with(
  simmr_data_2,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Get summary
print(simmr_3)

# Plot 3 times
plot(simmr_3)
plot(simmr_3, tracers = c(2, 3))
plot(simmr_3, tracers = c(1, 3))
# See vignette('simmr') for fancier axis labels

# FFVB run
simmr_3_out &lt;- simmr_ffvb(simmr_3)

# Print it
print(simmr_3_out)

# Summary
summary(simmr_3_out)
summary(simmr_3_out, type = "quantiles")
summary(simmr_3_out, type = "correlations")

# Plot
plot(simmr_3_out)
plot(simmr_3_out, type = "boxplot")
plot(simmr_3_out, type = "histogram")
plot(simmr_3_out, type = "density")
plot(simmr_3_out, type = "matrix")

################################################################

# Data set 5 - Multiple groups Geese data from Inger et al 2006

# Do this in raw data format - Note that there's quite a few mixtures!
data(geese_data)
simmr_5 &lt;- with(
  geese_data,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means,
    group = groups
  )
)

# Plot
plot(simmr_5,
  xlab = expression(paste(delta^13, "C (per mille)", sep = "")),
  ylab = expression(paste(delta^15, "N (per mille)", sep = "")),
  title = "Isospace plot of Inger et al Geese data"
)

# Run MCMC for each group
simmr_5_out &lt;- simmr_ffvb(simmr_5)

# Summarise output
summary(simmr_5_out, type = "quantiles", group = 1)
summary(simmr_5_out, type = "quantiles", group = c(1, 3))
summary(simmr_5_out, type = c("quantiles", "statistics"), group = c(1, 3))

# Plot - only a single group allowed
plot(simmr_5_out, type = "boxplot", group = 2, title = "simmr output group 2")
plot(simmr_5_out, type = c("density", "matrix"), grp = 6, title = "simmr output group 6")

# Compare sources within a group
compare_sources(simmr_5_out, source_names = c("Zostera", "U.lactuca"), group = 2)
compare_sources(simmr_5_out, group = 2)

# Compare between groups
compare_groups(simmr_5_out, source = "Zostera", groups = 1:2)
compare_groups(simmr_5_out, source = "Zostera", groups = 1:3)
compare_groups(simmr_5_out, source = "U.lactuca", groups = c(4:5, 7, 2))

## End(Not run)

</code></pre>

<hr>
<h2 id='simmr_load'>Function to load in simmr data and check for errors</h2><span id='topic+simmr_load'></span>

<h3>Description</h3>

<p>This function takes in the mixture data, food source means and standard
deviations, and (optionally) correction factor means and standard
deviations, and concentration proportions. It performs some (non-exhaustive)
checking of the data to make sure it will run through simmr. It outputs an
object of class <code>simmr_input</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simmr_load(
  mixtures,
  source_names,
  source_means,
  source_sds,
  correction_means = NULL,
  correction_sds = NULL,
  concentration_means = NULL,
  group = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simmr_load_+3A_mixtures">mixtures</code></td>
<td>
<p>The mixture data given as a matrix where the number of rows
is the number of observations and the number of columns is the number of
tracers (usually isotopes)</p>
</td></tr>
<tr><td><code id="simmr_load_+3A_source_names">source_names</code></td>
<td>
<p>The names of the sources given as a character string</p>
</td></tr>
<tr><td><code id="simmr_load_+3A_source_means">source_means</code></td>
<td>
<p>The means of the source values, given as a matrix where
the number of rows is the number of sources and the number of columns is the
number of tracers</p>
</td></tr>
<tr><td><code id="simmr_load_+3A_source_sds">source_sds</code></td>
<td>
<p>The standard deviations of the source values, given as a
matrix where the number of rows is the number of sources and the number of
columns is the number of tracers</p>
</td></tr>
<tr><td><code id="simmr_load_+3A_correction_means">correction_means</code></td>
<td>
<p>The means of the correction values, given as a
matrix where the number of rows is the number of sources and the number of
columns is the number of tracers. If not provided these are set to 0.</p>
</td></tr>
<tr><td><code id="simmr_load_+3A_correction_sds">correction_sds</code></td>
<td>
<p>The standard deviations of the correction values,
given as a matrix where the number of rows is the number of sources and the
number of columns is the number of tracers. If not provided these are set to
0.</p>
</td></tr>
<tr><td><code id="simmr_load_+3A_concentration_means">concentration_means</code></td>
<td>
<p>The means of the concentration values, given as a
matrix where the number of rows is the number of sources and the number of
columns is the number of tracers. These should be between 0 and 1. If not
provided these are all set to 1.</p>
</td></tr>
<tr><td><code id="simmr_load_+3A_group">group</code></td>
<td>
<p>A grouping variable. These can be a character or factor variable</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For standard stable isotope mixture modelling, the mixture matrix will
contain a row for each individual and a column for each isotopic value.
<code>simmr</code> will allow for any number of isotopes and any number of
observations, within computational limits. The source means/sds should be
provided for each food source on each isotope. The correction means (usually
trophic enrichment factors) can be set as zero if required, and should be of
the same shape as the source values. The concentration dependence means
should be estimated values of the proportion of each element in the food
source in question and should be given in proportion format between 0 and 1.
At present there is no means to include concentration standard deviations.
</p>


<h3>Value</h3>

<p>An object of class <code>simmr_input</code> with the following elements:
</p>
<table>
<tr><td><code>mixtures</code></td>
<td>
<p>The mixture data</p>
</td></tr> <tr><td><code>source_neams</code></td>
<td>
<p>Source means</p>
</td></tr>
<tr><td><code>sources_sds</code></td>
<td>
<p>Source standard deviations</p>
</td></tr> <tr><td><code>correction_means</code></td>
<td>
<p>Correction means</p>
</td></tr> <tr><td><code>correction_sds</code></td>
<td>
<p>Correction standard deviations</p>
</td></tr>
<tr><td><code>concentration_means</code></td>
<td>
<p>Concentration dependence means</p>
</td></tr> <tr><td><code>n_obs</code></td>
<td>
<p>The number of observations</p>
</td></tr> <tr><td><code>n_tracers</code></td>
<td>
<p>The number of
tracers/isotopes</p>
</td></tr> <tr><td><code>n_sources</code></td>
<td>
<p>The number of sources</p>
</td></tr> <tr><td><code>n_groups</code></td>
<td>
<p>The number of groups</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andrew Parnell &lt;andrew.parnell@mu.ie&gt;
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> for complete examples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# A simple example with 10 observations, 2 tracers and 4 sources
data(geese_data_day1)
simmr_1 &lt;- with(
  geese_data_day1,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

print(simmr_1)
</code></pre>

<hr>
<h2 id='simmr_mcmc'>Run a <code>simmr_input</code> object through the main simmr Markov chain Monte
Carlo (MCMC) function</h2><span id='topic+simmr_mcmc'></span>

<h3>Description</h3>

<p>This is the main function of simmr. It takes a <code>simmr_input</code> object
created via <code><a href="#topic+simmr_load">simmr_load</a></code>, runs an MCMC to determine the dietary
proportions, and then outputs a <code>simmr_output</code> object for further
analysis and plotting via <code><a href="#topic+summary.simmr_output">summary.simmr_output</a></code> and
<code><a href="#topic+plot.simmr_output">plot.simmr_output</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simmr_mcmc(
  simmr_in,
  prior_control = list(means = rep(0, simmr_in$n_sources), sd = rep(1,
    simmr_in$n_sources), sigma_shape = rep(3, simmr_in$n_tracers), sigma_rate = rep(3/50,
    simmr_in$n_tracers)),
  mcmc_control = list(iter = 10000, burn = 1000, thin = 10, n.chain = 4)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simmr_mcmc_+3A_simmr_in">simmr_in</code></td>
<td>
<p>An object created via the function <code><a href="#topic+simmr_load">simmr_load</a></code></p>
</td></tr>
<tr><td><code id="simmr_mcmc_+3A_prior_control">prior_control</code></td>
<td>
<p>A list of values including arguments named: <code>means</code>
and <code>sd</code> which represent the prior means and standard deviations of the
dietary proportions in centralised log-ratio space; <code>shape</code> and 
<code>rate</code> which represent the prior distribution on the residual standard
deviation. These can usually be
left at their default values unless you wish to include to include prior
information, in which case you should use the function
<code><a href="#topic+simmr_elicit">simmr_elicit</a></code>.</p>
</td></tr>
<tr><td><code id="simmr_mcmc_+3A_mcmc_control">mcmc_control</code></td>
<td>
<p>A list of values including arguments named <code>iter</code>
(number of iterations), <code>burn</code> (size of burn-in), <code>thin</code> (amount
of thinning), and <code>n.chain</code> (number of MCMC chains).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If, after running <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> the convergence diagnostics in
<code><a href="#topic+summary.simmr_output">summary.simmr_output</a></code> are not satisfactory, the values of
<code>iter</code>, <code>burn</code> and <code>thin</code> in <code>mcmc_control</code> should be
increased by a factor of 10.
</p>


<h3>Value</h3>

<p>An object of class <code>simmr_output</code> with two named top-level
components: </p>
<table>
<tr><td><code>input</code></td>
<td>
<p>The <code>simmr_input</code> object given to the
<code>simmr_mcmc</code> function</p>
</td></tr> <tr><td><code>output</code></td>
<td>
<p>A set of MCMC chains of class
<code>mcmc.list</code> from the coda package. These can be analysed using the
<code><a href="#topic+summary.simmr_output">summary.simmr_output</a></code> and <code><a href="#topic+plot.simmr_output">plot.simmr_output</a></code>
functions.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andrew Parnell &lt;andrew.parnell@mu.ie&gt;
</p>


<h3>References</h3>

<p>Andrew C. Parnell, Donald L. Phillips, Stuart Bearhop, Brice X.
Semmens, Eric J. Ward, Jonathan W. Moore, Andrew L. Jackson, Jonathan Grey,
David J. Kelly, and Richard Inger. Bayesian stable isotope mixing models.
Environmetrics, 24(6):387â€“399, 2013.
</p>
<p>Andrew C Parnell, Richard Inger, Stuart Bearhop, and Andrew L Jackson.
Source partitioning using stable isotopes: coping with too much variation.
PLoS ONE, 5(3):5, 2010.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simmr_load">simmr_load</a></code> for creating objects suitable for this
function, <code><a href="#topic+plot.simmr_input">plot.simmr_input</a></code> for creating isospace plots,
<code><a href="#topic+summary.simmr_output">summary.simmr_output</a></code> for summarising output, and
<code><a href="#topic+plot.simmr_output">plot.simmr_output</a></code> for plotting output.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## See the package vignette for a detailed run through of these 4 examples

# Data set 1: 10 obs on 2 isos, 4 sources, with tefs and concdep
data(geese_data_day1)
simmr_1 &lt;- with(
  geese_data_day1,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot
plot(simmr_1)

# Print
simmr_1

# MCMC run
simmr_1_out &lt;- simmr_mcmc(simmr_1)

# Print it
print(simmr_1_out)

# Summary
summary(simmr_1_out, type = "diagnostics")
summary(simmr_1_out, type = "correlations")
summary(simmr_1_out, type = "statistics")
ans &lt;- summary(simmr_1_out, type = c("quantiles", "statistics"))

# Plot
plot(simmr_1_out, type = "boxplot")
plot(simmr_1_out, type = "histogram")
plot(simmr_1_out, type = "density")
plot(simmr_1_out, type = "matrix")

# Compare two sources
compare_sources(simmr_1_out, source_names = c("Zostera", "Enteromorpha"))

# Compare multiple sources
compare_sources(simmr_1_out)

#####################################################################################

# A version with just one observation
data(geese_data_day1)
simmr_2 &lt;- with(
  geese_data_day1,
  simmr_load(
    mixtures = mixtures[1, , drop = FALSE],
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot
plot(simmr_2)

# MCMC run - automatically detects the single observation
simmr_2_out &lt;- simmr_mcmc(simmr_2)

# Print it
print(simmr_2_out)

# Summary
summary(simmr_2_out)
summary(simmr_2_out, type = "diagnostics")
ans &lt;- summary(simmr_2_out, type = c("quantiles"))

# Plot
plot(simmr_2_out)
plot(simmr_2_out, type = "boxplot")
plot(simmr_2_out, type = "histogram")
plot(simmr_2_out, type = "density")
plot(simmr_2_out, type = "matrix")

#####################################################################################

# Data set 2: 3 isotopes (d13C, d15N and d34S), 30 observations, 4 sources
data(simmr_data_2)
simmr_3 &lt;- with(
  simmr_data_2,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Get summary
print(simmr_3)

# Plot 3 times
plot(simmr_3)
plot(simmr_3, tracers = c(2, 3))
plot(simmr_3, tracers = c(1, 3))
# See vignette('simmr') for fancier axis labels

# MCMC run
simmr_3_out &lt;- simmr_mcmc(simmr_3)

# Print it
print(simmr_3_out)

# Summary
summary(simmr_3_out)
summary(simmr_3_out, type = "diagnostics")
summary(simmr_3_out, type = "quantiles")
summary(simmr_3_out, type = "correlations")

# Plot
plot(simmr_3_out)
plot(simmr_3_out, type = "boxplot")
plot(simmr_3_out, type = "histogram")
plot(simmr_3_out, type = "density")
plot(simmr_3_out, type = "matrix")

#####################################################################################

# Data set 5 - Multiple groups Geese data from Inger et al 2006

# Do this in raw data format - Note that there's quite a few mixtures!
data(geese_data)
simmr_5 &lt;- with(
  geese_data,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means,
    group = groups
  )
)

# Plot
plot(simmr_5,
  xlab = expression(paste(delta^13, "C (per mille)", sep = "")),
  ylab = expression(paste(delta^15, "N (per mille)", sep = "")),
  title = "Isospace plot of Inger et al Geese data"
)

# Run MCMC for each group
simmr_5_out &lt;- simmr_mcmc(simmr_5)

# Summarise output
summary(simmr_5_out, type = "quantiles", group = 1)
summary(simmr_5_out, type = "quantiles", group = c(1, 3))
summary(simmr_5_out, type = c("quantiles", "statistics"), group = c(1, 3))

# Plot - only a single group allowed
plot(simmr_5_out, type = "boxplot", group = 2, title = "simmr output group 2")
plot(simmr_5_out, type = c("density", "matrix"), grp = 6, title = "simmr output group 6")

# Compare sources within a group
compare_sources(simmr_5_out, source_names = c("Zostera", "U.lactuca"), group = 2)
compare_sources(simmr_5_out, group = 2)

# Compare between groups
compare_groups(simmr_5_out, source = "Zostera", groups = 1:2)
compare_groups(simmr_5_out, source = "Zostera", groups = 1:3)
compare_groups(simmr_5_out, source = "U.lactuca", groups = c(4:5, 7, 2))

## End(Not run)

</code></pre>

<hr>
<h2 id='square_data'>An artificial data set used to indicate effect of priors</h2><span id='topic+square_data'></span>

<h3>Description</h3>

<p>A fake box data set identified by Fry (2014) as a failing of SIMMs
See the link for more interpretation of these data and the output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>square_data
</code></pre>


<h3>Format</h3>

<p>A list with the following elements
</p>

<dl>
<dt>mixtures</dt><dd><p>A two column matrix containing delta 13C and delta 15N values respectively</p>
</dd>
<dt>source_names</dt><dd><p>A character vector of the food source names</p>
</dd>
<dt>tracer_names</dt><dd><p>A character vector of the tracer names (d13C, d15N)</p>
</dd>
<dt>source_means</dt><dd><p>A matrix of source mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>source_sds</dt><dd><p>A matrix of source sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_means</dt><dd><p>A matrix of TEFs mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_sds</dt><dd><p>A matrix of TEFs sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>concentration_means</dt><dd><p>A matrix of concentration dependence mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
</dl>
<p>...
</p>
<p>@seealso <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> for an example where it is used
</p>



<h3>Source</h3>

<p>&lt;doi:10.3354/meps10535&gt;
</p>

<hr>
<h2 id='summary.simmr_output'>Summarises the output created with <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> or 
<code><a href="#topic+simmr_ffvb">simmr_ffvb</a></code></h2><span id='topic+summary.simmr_output'></span>

<h3>Description</h3>

<p>Produces textual summaries and convergence diagnostics for an object created
with <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> or <code><a href="#topic+simmr_ffvb">simmr_ffvb</a></code>. The different
options are: 'diagnostics' which produces Brooks-Gelman-Rubin diagnostics
to assess MCMC convergence, 'quantiles' which produces credible intervals
for the parameters, 'statistics' which produces means and standard
deviations, and 'correlations' which produces correlations between the
parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simmr_output'
summary(
  object,
  type = c("diagnostics", "quantiles", "statistics", "correlations"),
  group = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.simmr_output_+3A_object">object</code></td>
<td>
<p>An object of class <code>simmr_output</code> produced by the
function <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> or <code><a href="#topic+simmr_ffvb">simmr_ffvb</a></code></p>
</td></tr>
<tr><td><code id="summary.simmr_output_+3A_type">type</code></td>
<td>
<p>The type of output required. At least none of 'diagnostics',
'quantiles', 'statistics', or 'correlations'.</p>
</td></tr>
<tr><td><code id="summary.simmr_output_+3A_group">group</code></td>
<td>
<p>Which group or groups the output is required for.</p>
</td></tr>
<tr><td><code id="summary.simmr_output_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The quantile output allows easy calculation of 95 per cent credible
intervals of the posterior dietary proportions. The correlations, along with
the matrix plot in <code><a href="#topic+plot.simmr_output">plot.simmr_output</a></code> allow the user to judge
which sources are non-identifiable. The Gelman diagnostic values should be
close to 1 to ensure satisfactory convergence.
</p>
<p>When multiple groups are included, the output automatically includes the
results for all groups.
</p>


<h3>Value</h3>

<p>A list containing the following components: </p>
<table>
<tr><td><code>gelman</code></td>
<td>
<p>The
convergence diagnostics</p>
</td></tr> <tr><td><code>quantiles</code></td>
<td>
<p>The quantiles of each parameter
from the posterior distribution</p>
</td></tr> <tr><td><code>statistics</code></td>
<td>
<p>The means and standard
deviations of each parameter</p>
</td></tr> <tr><td><code>correlations</code></td>
<td>
<p>The posterior
correlations between the parameters</p>
</td></tr></table>
<p> Note that this object is reported
silently so will be discarded unless the function is called with an object
as in the example below.
</p>


<h3>Author(s)</h3>

<p>Andrew Parnell &lt;andrew.parnell@mu.ie&gt;, Emma Govan
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+simmr_mcmc">simmr_mcmc</a></code> and <code><a href="#topic+simmr_ffvb">simmr_ffvb</a></code>for
creating objects suitable for this function, and many more examples.
See also <code><a href="#topic+simmr_load">simmr_load</a></code> for creating simmr objects,
<code><a href="#topic+plot.simmr_input">plot.simmr_input</a></code> for creating isospace plots,
<code><a href="#topic+plot.simmr_output">plot.simmr_output</a></code> for plotting output.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# A simple example with 10 observations, 2 tracers and 4 sources

# The data
data(geese_data_day1)
simmr_1 &lt;- with(
  geese_data_day1,
  simmr_load(
    mixtures = mixtures,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot
plot(simmr_1)


# MCMC run
simmr_1_out &lt;- simmr_mcmc(simmr_1)

# Summarise
summary(simmr_1_out) # This outputs all the summaries
summary(simmr_1_out, type = "diagnostics") # Just the diagnostics
# Store the output in an
ans &lt;- summary(simmr_1_out,
  type = c("quantiles", "statistics")
)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
