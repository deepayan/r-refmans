<!DOCTYPE html><html><head><title>Help for package straweib</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {straweib}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#HRatio'><p>Estimate hazard ratio between two subjects</p></a></li>
<li><a href='#hyper'><p>Treatment of hypernephroma data</p></a></li>
<li><a href='#icweib'><p>Fit stratified Weibull regression model</p></a></li>
<li><a href='#plot.icweib'><p>Plot estimated survival function</p></a></li>
<li><a href='#print.icweib'><p>Print icweib object</p></a></li>
<li><a href='#simdata'><p>Simulated data with mixed types of events</p></a></li>
<li><a href='#tooth24'><p>Tooth data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Stratified Weibull Regression Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-11-17</td>
</tr>
<tr>
<td>Author:</td>
<td>Xiangdong Gu and Raji Balasubramanian</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xiangdong Gu &lt;ustcgxd@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The main function is icweib(), which fits a stratified Weibull
    proportional hazards model for left censored, right censored, interval censored,
    and non-censored survival data. We parameterize the Weibull regression model
    so that it allows a stratum-specific baseline hazard function, but where the
    effects of other covariates are assumed to be constant across strata. 
    Please refer to Xiangdong Gu, David Shapiro, Michael D. Hughes and
    Raji Balasubramanian (2014) &lt;<a href="https://doi.org/10.32614%2FRJ-2014-003">doi:10.32614/RJ-2014-003</a>&gt; for more details.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-11-17 14:54:07 UTC; xiangdong</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-11-17 15:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='HRatio'>Estimate hazard ratio between two subjects</h2><span id='topic+HRatio'></span>

<h3>Description</h3>

<p>This function estimates the  hazard ratio between two subjects at given
times, along with the associated 95% confidence interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HRatio(x, times, NumStra, NumZ = NULL, DemStra, DemZ = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HRatio_+3A_x">x</code></td>
<td>
<p>results from the model fit returned by the icweib function.</p>
</td></tr>
<tr><td><code id="HRatio_+3A_times">times</code></td>
<td>
<p>the vector of times at which the hazard ratio is estimated.</p>
</td></tr>
<tr><td><code id="HRatio_+3A_numstra">NumStra</code></td>
<td>
<p>the strata of the subject in the numerator. If the model is
unstratified, then set it to be the constant that is used for
<em>strata</em> argument in <em>icweib</em> function, e.g. &quot;ALL&quot;.</p>
</td></tr>
<tr><td><code id="HRatio_+3A_numz">NumZ</code></td>
<td>
<p>the vector of values of the explanatory variables for
the subject in the numerator. The order and length should match
the estimated coefficients as shown in x$coef. The default is NULL,
corresponding to all 0 or baseline.</p>
</td></tr>
<tr><td><code id="HRatio_+3A_demstra">DemStra</code></td>
<td>
<p>the strata of the subject in the denominator. If the
model is unstratified, then set it to be the constant that is used
for <em>strata</em> argument in <em>icweib</em> function, e.g. &quot;ALL&quot;.</p>
</td></tr>
<tr><td><code id="HRatio_+3A_demz">DemZ</code></td>
<td>
<p>the vector of values of the explanatory variables for the
subject in the denominator. The order and length should match the
estimated coefficients as shown in x$coef. The default is NULL,
corresponding to all 0 or baseline.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The hazard ratio between two subjects is obtained from the
maximum likelihood estimates from the stratified Weibull regression
model, along with the corresponding 95% confidence interval.
</p>


<h3>Value</h3>

<p>A data frame of estimated hazard ratios and confidence intervals for
two subjects at each time point is returned.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+icweib">icweib</a></code>, <code><a href="graphics.html#topic+plot">plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tooth24)
fit &lt;- icweib(L = left, R = right, data = tooth24,
              strata = dmf, covariates = ~sex)
HRatio(fit, times = 1:7, NumStra = 0, NumZ=0, DemStra = 1, DemZ=0)

</code></pre>

<hr>
<h2 id='hyper'>Treatment of hypernephroma data</h2><span id='topic+hyper'></span>

<h3>Description</h3>

<p>This dataset contains survival times for 36
patients with malignant tumour in the kidney. Some of the patients received
nephrectomy. See Example 3.4 and example 5.9 of the Collett (2003) for more
details. The  event time in this example is right censored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hyper
</code></pre>


<h3>Format</h3>

<p>A data frame with 36 observations on the following 4 variables:
</p>
 <dl>
<dt><code>nephrectomy</code></dt><dd><p>indicator on whether or not the patient
had recived a nephrectomy</p>
</dd> <dt><code>age</code></dt><dd><p>age group at the time of
diagnosis. 1 = &lt;60, 2 = 60-70, 3 = &gt;70.</p>
</dd> <dt><code>time</code></dt><dd><p>observed time.</p>
</dd>
<dt><code>status</code></dt><dd><p>status of the observed time. 0 = censored, 1 = event.</p>
</dd>
</dl>


<h3>Details</h3>

<p>The data uses time and status to represent the observed survival
time. To fit into the icweib function, left and right endpoints of censoring
interval need to be derived (see examples).
</p>


<h3>References</h3>

<p>Collett, D. (2003). <em>Modelling Survival Data in Medical
Research, Second Edition</em>, Texts in statistical science. Taylor &amp; Francis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hyper)
## Derive left and right endpoints from time and status
hyper$left &lt;- hyper$time
hyper$right &lt;- ifelse(hyper$status==1, hyper$time, Inf)

</code></pre>

<hr>
<h2 id='icweib'>Fit stratified Weibull regression model</h2><span id='topic+icweib'></span>

<h3>Description</h3>

<p>This function fits a stratified Weibull regression model using maximum
likelihood estimation. The function can incorporate right, left, interval
censored outcomes in addition to fully observed (i.e. uncensored) time to
event data. (see details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>icweib(L, R, data, strata = "ALL", covariates = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="icweib_+3A_l">L</code></td>
<td>
<p>left endpoint of censoring interval. To indicate
left censoring, set L=0.</p>
</td></tr>
<tr><td><code id="icweib_+3A_r">R</code></td>
<td>
<p>right endpoint of censoring interval. To indicate right
censoring, set R=Inf.</p>
</td></tr>
<tr><td><code id="icweib_+3A_data">data</code></td>
<td>
<p>dataset</p>
</td></tr>
<tr><td><code id="icweib_+3A_strata">strata</code></td>
<td>
<p>variable for stratification. Set it to a character or
numeric constant for un-stratified model.</p>
</td></tr>
<tr><td><code id="icweib_+3A_covariates">covariates</code></td>
<td>
<p>a formula to specify explanatory variables in the
proportional hazards model. The input is a right hand formula object,
such as ~x1 + x2. The default is NULL, corresponding to the no covariate case.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As in the stratified Cox proportional hazards model (Collett (2003)),
this model allows a baseline hazard function that is stratum-specific. However,
the model assumes that the regression coefficients for all other explanatory
variables (excluding the stratum indicator) are constant across strata.
Assuming a Weibull distribution for the random variable corresponding to the
time to event in conjunction with the Cox proportional hazards model, the survival
function can be expressed as S(t | Z) = exp(-lambda*exp(beta*Z)*t^(gamma)), where
Z denotes the vector of covariates, gamma denotes the shape parameter and lambda
the scale parameter.  To allow stratum-specific baseline hazard functions,
we generalize the model given above by  expressing the survival function as
S(t | Z, Stratum=i) = exp(-lambda_i*exp(beta*Z)*t^(gamma_i)), where i denotes
the stratum, Z denotes the vector of covariates, gamma_i and lambda_i denote
the shape and scale parameters for stratum i, respectively.  In particular,
the model assumes that the coefficients for explanatory covariates Z (denoted by beta)
are the same for all strata i.
</p>
<p>In the likelihood optimization, u_i=log(lambda_i) and v_i=log(gamma_i) are used as
parameters to remove the parameters' range constriction. The likelihood function is
optimized using optim() function. The maximum likelihood estimates are used to
estimate baseline hazard ratios between two subjects (see <code><a href="#topic+HRatio">HRatio</a></code>),
and survival function (see <code><a href="#topic+plot.icweib">plot.icweib</a></code>).
</p>
<p>This function can accommondate different types of censored time-to-event outcomes:
left censoring, right censoring, interval censoring, and non-censoring (event),
by appropriately setting L and R,
</p>

<table>
<tr>
 <td style="text-align: left;">
L     </td><td style="text-align: left;"> R     </td><td style="text-align: left;"> INTERPRETATION </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
a   </td><td style="text-align: left;"> b   </td><td style="text-align: left;"> interval censoring, [a, b] </td>
</tr>
<tr>
 <td style="text-align: left;">
0   </td><td style="text-align: left;"> b   </td><td style="text-align: left;"> left censoring, [0, b] </td>
</tr>
<tr>
 <td style="text-align: left;">
a   </td><td style="text-align: left;"> Inf </td><td style="text-align: left;"> right censoring, [a, Inf] </td>
</tr>
<tr>
 <td style="text-align: left;">
a   </td><td style="text-align: left;"> a   </td><td style="text-align: left;"> no censoring, event time = a </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>This function returns an object with class <em>icweib</em>. The items in the object are,
</p>
<table>
<tr><td><code>loglik</code></td>
<td>
<p>log-likelihood functions of the full, reduced, and null models. Reduced model refers to the model that all shape parameters are same. Null model refers to the model that there is no covariate in the model.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>results for estimated coefficients for explanatory variables.</p>
</td></tr>
<tr><td><code>weib</code></td>
<td>
<p>estimated Weibull shape and scale parameters for each stratum.</p>
</td></tr>
<tr><td><code>stratatest</code></td>
<td>
<p>results of likelihood ratio test and Wald test corresponding to the null hypothesis that all the strata specific shape parameters are equal.</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>covariance matrix of the parameters</p>
</td></tr>
<tr><td><code>ns</code></td>
<td>
<p>information of different counts</p>
</td></tr>
<tr><td><code>delete</code></td>
<td>
<p>observation numbers in the data that are deleted due to inappropriate input.</p>
</td></tr>
<tr><td><code>maxT</code></td>
<td>
<p>maximum observed time in the data</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>returned object from the <em>optim</em> function for the full model.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Collett, D. (2003). <em>Modelling Survival Data in Medical Research,
Second Edition</em>, Texts in statistical science. Taylor &amp; Francis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HRatio">HRatio</a></code>, <code><a href="#topic+plot.icweib">plot.icweib</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Analyze tooth data
data(tooth24)   ## load data
## Stratified on dmf, and sex as explanatory variable
fit &lt;- icweib(L = left, R = right, data = tooth24, strata = dmf, covariates = ~sex)

## Analyze hypernephroma data
data(hyper)

## Derive left and right endpoints from time and status
hyper$left &lt;- hyper$time
hyper$right &lt;- ifelse(hyper$status==1, hyper$time, Inf)

## Stratified on nephrectomy, and age group as explanatory variable
fit1 &lt;- icweib(L = left, R = right, data = hyper, strata = nephrectomy, covariates = ~factor(age))

</code></pre>

<hr>
<h2 id='plot.icweib'>Plot estimated survival function</h2><span id='topic+plot.icweib'></span>

<h3>Description</h3>

<p>This function plots the estimated survival function along with associated
pointwise 95% confidence intervals corresponding to the input strata and
values of explanatory variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'icweib'
plot(x, strata = NULL, Z = NULL, tRange = NULL,
  tEst = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.icweib_+3A_x">x</code></td>
<td>
<p>output returned by icweib function.</p>
</td></tr>
<tr><td><code id="plot.icweib_+3A_strata">strata</code></td>
<td>
<p>the vector of strata for which the survival function is
estimated and plotted. The default is NULL, corresponding to all strata.</p>
</td></tr>
<tr><td><code id="plot.icweib_+3A_z">Z</code></td>
<td>
<p>the vector of values of explanatory variables for which the survival
function is estimated and plotted. The order and length should match the
estimated coefficients as shown in x$coef. The default is NULL, corresponding
to all 0 or baseline.</p>
</td></tr>
<tr><td><code id="plot.icweib_+3A_trange">tRange</code></td>
<td>
<p>the range of time to plot. It should be in the format of c(t1, t2),
which means that the range of time is t1 to t2. The default is NULL, corresponding
to 0 to maximum observed time in the data.</p>
</td></tr>
<tr><td><code id="plot.icweib_+3A_test">tEst</code></td>
<td>
<p>the vector of times at which the survival function along with
associated pointwise 95% confidence internval is estimated and output.
The default is NULL, which means no estimated survival function is output.</p>
</td></tr>
<tr><td><code id="plot.icweib_+3A_...">...</code></td>
<td>
<p>arguments of <code><a href="graphics.html#topic+plot">plot</a></code> function except <em>col</em> and
<em>lty</em>. For example, the axis labels and title of the plot can be specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The survival function and associated pointwise 95% confidence intervals
are estimated for input values of time and covariates.
</p>


<h3>Value</h3>

<p>If tEst is specified, then a dataframe of estimated survival function
along with 95% confidence interval is returned.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+icweib">icweib</a></code> <code><a href="graphics.html#topic+plot">plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tooth24)
fit &lt;- icweib(L = left, R = right, data = tooth24, strata = dmf, covariates = ~sex)
surv &lt;- plot(fit, Z = 1, tRange = c(1, 7), tEst=1:7, xlab = "Time", ylab = "Survival Function",
             main = "Estimated survival function for sex = 1 (girls)")

</code></pre>

<hr>
<h2 id='print.icweib'>Print icweib object</h2><span id='topic+print.icweib'></span>

<h3>Description</h3>

<p>This function prints the summary of the fitting results from icweib.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'icweib'
print(x, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.icweib_+3A_x">x</code></td>
<td>
<p>output returned by icweib function.</p>
</td></tr>
<tr><td><code id="print.icweib_+3A_digits">digits</code></td>
<td>
<p>digits to print.</p>
</td></tr>
<tr><td><code id="print.icweib_+3A_...">...</code></td>
<td>
<p>other arguments to be passed from print function.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(tooth24)
fit &lt;- icweib(L = left, R = right, data = tooth24, strata = dmf, covariates = ~sex)
fit

</code></pre>

<hr>
<h2 id='simdata'>Simulated data with mixed types of events</h2><span id='topic+simdata'></span>

<h3>Description</h3>

<p>This simulated data contains event times that are left censored, right
censored, interval censored, or non-censored (observed event). The data is
generated from a stratified Weibull distribution model in which each stratum
is assumed to have an independent stratum-specific shape parameter. In
addition, the regression coefficients corresponding to the vector of
explanatory variables excluding the stratum indicator are assumed to be
constant across strata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simdata
</code></pre>


<h3>Format</h3>

<p>A data frame with 298 observations on the following 6 variables:
</p>
 <dl>
<dt><code>ID</code></dt><dd><p>subject id</p>
</dd> <dt><code>strata</code></dt><dd><p>strata</p>
</dd>
<dt><code>cov1</code></dt><dd><p>a continuous covariate</p>
</dd> <dt><code>cov2</code></dt><dd><p>a continuous
covariate</p>
</dd> <dt><code>left</code></dt><dd><p>left endpoint of censoring interval</p>
</dd>
<dt><code>right</code></dt><dd><p>right endpoint of censoring interval</p>
</dd> </dl>


<h3>References</h3>

<p>see <code><a href="#topic+icweib">icweib</a></code> for details on how to set <em>L</em> and
<em>R</em> for different types of events.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdata)

</code></pre>

<hr>
<h2 id='tooth24'>Tooth data</h2><span id='topic+tooth24'></span>

<h3>Description</h3>

<p>This data set contains data from the Signal Tandmobiel study, which is
described in the paper by Gomez G and others (2009). The time to event
is interval censored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tooth24
</code></pre>


<h3>Format</h3>

<p>A data frame with 4386 observations on the following 5 variables:
</p>

<dl>
<dt><code>id</code></dt><dd><p>child id</p>
</dd>
<dt><code>left</code></dt><dd><p>left endpoint of censoring interval.</p>
</dd>
<dt><code>right</code></dt><dd><p>right endpoint of censoring interval.</p>
</dd>
<dt><code>sex</code></dt><dd><p>child's gender. 0 = boy, 1 = girl.</p>
</dd>
<dt><code>dmf</code></dt><dd><p>status of primary predecessor of the tooth.
0 = sound, 1 = decayed or missing due to caries or filled</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="http://grass.upc.edu/software/tooth24/copy_of_tooth24-data-set/view">http://grass.upc.edu/software/tooth24/copy_of_tooth24-data-set/view</a>
</p>


<h3>References</h3>

<p>G. Gomez, M. Calle, R. Oller, and K. Langohr (2009). Tutorial on methods
for interval-censored data and their implementation in R.
<em>Statistical Modeling</em> 9(4), 259
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tooth24)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
