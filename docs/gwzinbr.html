<!DOCTYPE html><html lang="en"><head><title>Help for package gwzinbr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gwzinbr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Golden'><p>Golden Section Search</p></a></li>
<li><a href='#gwzinbr'><p>Geographically Weighted Zero Inflated Negative Binomial Regression</p></a></li>
<li><a href='#southkorea_covid19'><p>South Korea COVID-19 dataset</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Geographically Weighted Zero Inflated Negative Binomial
Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jéssica Vasconcelos &lt;jehh.vasconcelosabreu@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits a geographically weighted regression model
	using zero inflated probability distributions. Has the zero 
	inflated negative binomial distribution (zinb) as default, 
	but also accepts the zero inflated Poisson (zip), negative
	binomial (negbin) and Poisson distributions. Can also fit 
	the global versions of each regression model.
	Da Silva, A. R. &amp; De Sousa, M. D. R. (2023). "Geographically weighted zero-inflated negative binomial regression: A general case for count data", Spatial Statistics &lt;<a href="https://doi.org/10.1016%2Fj.spasta.2023.100790">doi:10.1016/j.spasta.2023.100790</a>&gt;.
	Brunsdon, C., Fotheringham, A. S., &amp; Charlton, M. E. (1996). "Geographically weighted regression: a method for exploring spatial nonstationarity", Geographical Analysis, &lt;<a href="https://doi.org/10.1111%2Fj.1538-4632.1996.tb00936.x">doi:10.1111/j.1538-4632.1996.tb00936.x</a>&gt;.
	Yau, K. K. W., Wang, K., &amp; Lee, A. H. (2003). "Zero-inflated negative binomial mixed regression modeling of over-dispersed count data with extra zeros", Biometrical Journal, &lt;<a href="https://doi.org/10.1002%2Fbimj.200390024">doi:10.1002/bimj.200390024</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>sp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-08 19:07:35 UTC; Juliana Rosa</td>
</tr>
<tr>
<td>Author:</td>
<td>Jéssica Vasconcelos [aut, cre],
  Juliana Rosa [aut],
  Alan da Silva [aut]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-10 17:20:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='Golden'>Golden Section Search</h2><span id='topic+Golden'></span>

<h3>Description</h3>

<p>Runs a Golden Section Search (GSS) algorithm for determining the optimum bandwidth for the geographically weighted zero inflated negative binomial regression and other spatial regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Golden(
  data,
  formula,
  xvarinf = NULL,
  weight = NULL,
  lat,
  long,
  globalmin = TRUE,
  method,
  model = "zinb",
  bandwidth = "cv",
  offset = NULL,
  force = FALSE,
  maxg = 100,
  distancekm = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Golden_+3A_data">data</code></td>
<td>
<p>name of the dataset.</p>
</td></tr>
<tr><td><code id="Golden_+3A_formula">formula</code></td>
<td>
<p>regression model formula as in <code>lm</code>.</p>
</td></tr>
<tr><td><code id="Golden_+3A_xvarinf">xvarinf</code></td>
<td>
<p>name of the covariates for the zero inflated part of the model, default value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="Golden_+3A_weight">weight</code></td>
<td>
<p>name of the variable containing the sample weights, default value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="Golden_+3A_lat">lat</code></td>
<td>
<p>name of the variable containing the latitudes in the dataset.</p>
</td></tr>
<tr><td><code id="Golden_+3A_long">long</code></td>
<td>
<p>name of the variable containing the longitudes in the dataset.</p>
</td></tr>
<tr><td><code id="Golden_+3A_globalmin">globalmin</code></td>
<td>
<p>logical value indicating whether to find a global minimum in the optimization process, default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="Golden_+3A_method">method</code></td>
<td>
<p>indicates the method to be used for the bandwidth calculation (<code>adaptive_bsq</code> or <code>fixed_g</code>).</p>
</td></tr>
<tr><td><code id="Golden_+3A_model">model</code></td>
<td>
<p>indicates the model to be used for the regression (<code>zinb</code>, <code>zip</code>, <code>negbin</code>, <code>poisson</code>), default value is<code>"zinb"</code>.</p>
</td></tr>
<tr><td><code id="Golden_+3A_bandwidth">bandwidth</code></td>
<td>
<p>indicates the criterion to be used for the bandwidth calculation (<code>cv</code>, <code>aic</code>), default value is <code>"cv"</code>.</p>
</td></tr>
<tr><td><code id="Golden_+3A_offset">offset</code></td>
<td>
<p>name of the variable containing the offset values, if null then is set to a vector of zeros, default value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="Golden_+3A_force">force</code></td>
<td>
<p>logical value indicating whether to force the indicated model even if it is not the best fit for the data, default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="Golden_+3A_maxg">maxg</code></td>
<td>
<p>integer indicating the maximum number of iterations for the zero inflated part of the model, default value is <code>100</code>.</p>
</td></tr>
<tr><td><code id="Golden_+3A_distancekm">distancekm</code></td>
<td>
<p>logical value indicating whether to calculate the distances in km, default value is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list that contains:
</p>

<ul>
<li> <p><code>h_values</code> - Initial values tested for the bandwidth.
</p>
</li>
<li> <p><code>iterations</code> - All bandwidth values tested and respective cv/aic results for each Golden Section Search executed.
</p>
</li>
<li> <p><code>gss_results</code> - Optimum bandwidth found and respective cv/aic.
</p>
</li>
<li> <p><code>min_bandwidth</code> - Optimum bandwidth.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Data


data(southkorea_covid19)


## GSS algorithm

gss &lt;- Golden(data = southkorea_covid19[1:122, ],
formula = n_covid1~diff_sd,
xvarinf = NULL, weight = NULL, lat = "y", long = "x",
offset = NULL, model = "poisson", method = "fixed_g",
bandwidth = "cv", globalmin = FALSE, distancekm = FALSE,
force=FALSE)

## Bandwidth
gss$min_bandwidth

## Iterations
gss$iterations

</code></pre>

<hr>
<h2 id='gwzinbr'>Geographically Weighted Zero Inflated Negative Binomial Regression</h2><span id='topic+gwzinbr'></span>

<h3>Description</h3>

<p>Fits a geographically weighted regression model using zero inflated probability distributions. Has the zero inflated negative binomial distribution (zinb) as default, but also accepts the zero inflated Poisson (zip), negative binomial (negbin) and Poisson distributions. Can also fit the global versions of each regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gwzinbr(
  data,
  formula,
  xvarinf = NULL,
  weight = NULL,
  lat,
  long,
  grid = NULL,
  method,
  model = "zinb",
  offset = NULL,
  distancekm = FALSE,
  force = FALSE,
  int_inf = TRUE,
  maxg = 100,
  h = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gwzinbr_+3A_data">data</code></td>
<td>
<p>name of the dataset.</p>
</td></tr>
<tr><td><code id="gwzinbr_+3A_formula">formula</code></td>
<td>
<p>regression model formula as in <code>lm</code>.</p>
</td></tr>
<tr><td><code id="gwzinbr_+3A_xvarinf">xvarinf</code></td>
<td>
<p>name of the covariates for the zero inflated part of the model, default value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gwzinbr_+3A_weight">weight</code></td>
<td>
<p>name of the variable containing the sample weights, default value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gwzinbr_+3A_lat">lat</code></td>
<td>
<p>name of the variable containing the latitudes in the dataset.</p>
</td></tr>
<tr><td><code id="gwzinbr_+3A_long">long</code></td>
<td>
<p>name of the variable containing the longitudes in the dataset.</p>
</td></tr>
<tr><td><code id="gwzinbr_+3A_grid">grid</code></td>
<td>
<p>name of the dataset containing the coordinates for the model locations, default value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gwzinbr_+3A_method">method</code></td>
<td>
<p>indicates the method to be used for the bandwidth calculation (<code>adaptive_bsq</code> or <code>fixed_g</code>).</p>
</td></tr>
<tr><td><code id="gwzinbr_+3A_model">model</code></td>
<td>
<p>indicates the model to be used for the regression (<code>zinb</code>, <code>zip</code>, <code>negbin</code>, <code>poisson</code>), default value is<code>"zinb"</code>.</p>
</td></tr>
<tr><td><code id="gwzinbr_+3A_offset">offset</code></td>
<td>
<p>name of the variable containing the offset values, if null then is set to a vector of zeros, default value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gwzinbr_+3A_distancekm">distancekm</code></td>
<td>
<p>logical value indicating whether to calculate the distances in km, default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="gwzinbr_+3A_force">force</code></td>
<td>
<p>logical value indicating whether to force the indicated model even if it is not the best fit for the data, default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="gwzinbr_+3A_int_inf">int_inf</code></td>
<td>
<p>logical value indicating whether to include an intercept in the zero inflated part of the model, default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="gwzinbr_+3A_maxg">maxg</code></td>
<td>
<p>integer indicating the maximum number of iterations for the zero inflated part of the model, default value is <code>100</code>.</p>
</td></tr>
<tr><td><code id="gwzinbr_+3A_h">h</code></td>
<td>
<p>integer indicating the bandwidth value (obtained from <code>golden()</code>), default value is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list that contains:
</p>

<ul>
<li> <p><code>bandwidth</code> - Bandwidth value.
</p>
</li>
<li> <p><code>measures</code> - Goodness of fit statistics and other measures.
</p>
</li>
<li> <p><code>qntls_gwr_param_estimates</code> - Quantiles of GWR parameter estimates.
</p>
</li>
<li> <p><code>descript_stats_gwr_param_estimates</code> - Descriptive statistics of GWR parameter estimates.
</p>
</li>
<li> <p><code>t_test_gwr_param_estimates</code> - Results for the parameters significance t tests.
</p>
</li>
<li> <p><code>qntls_gwr_se</code> - Quantiles of GWR standard errors.
</p>
</li>
<li> <p><code>descript_stats_gwr_se</code> - Descriptive statistics of GWR standard errors.
</p>
</li>
<li> <p><code>qntls_gwr_zero_infl_param_estimates</code> - Quantiles of GWR zero inflated parameter estimates.
</p>
</li>
<li> <p><code>descript_stats_gwr_zero_infl_param_estimates</code> - Descriptive statistics of GWR zero inflated parameter estimates.
</p>
</li>
<li> <p><code>t_test_gwr_zero_infl_param_estimates</code> - Results for the zero inflated parameters significance t tests.
</p>
</li>
<li> <p><code>qntls_gwr_zero_infl_se</code> - Quantiles of GWR zero inflated standard errors.
</p>
</li>
<li> <p><code>descript_stats_gwr_zero_infl_se</code> - Descriptive statistics of GWR zero inflated standard errors.
</p>
</li>
<li> <p><code>non_stationary_test</code> - Results for the Non-Stationary Test for GWR parameter estimates.
</p>
</li>
<li> <p><code>non_stationary_test_zero_infl</code> - Results for the Non-Stationary Test for GWR zero inflated parameter estimates.
</p>
</li>
<li> <p><code>global_param_estimates</code> - Parameter estimates for the global model.
</p>
</li>
<li> <p><code>analysis_max_like_zero_infl_param_estimated</code> - Analysis of Maximum Likelihood Zero Inflation Parameter Estimates.
</p>
</li>
<li> <p><code>analysis_max_like_gof_measures</code> - Goodness of fit measures for the Analysis of Maximum Likelihood Zero Inflation Parameter Estimates.
</p>
</li>
<li> <p><code>variance_covariance_matrix</code> - Variance-covariance matrix.
</p>
</li>
<li> <p><code>residuals</code> - Model residuals.
</p>
</li>
<li> <p><code>param_estimates_grid</code> - GWR parameter estimates using grid dataset.
</p>
</li>
<li> <p><code>alpha_estimates</code> - Estimates for the alpha parameter (for zinb and negbin).
</p>
</li>
<li> <p><code>gwr_param_estimates</code> - GWR parameter estimates.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Data


data(southkorea_covid19)


## Model

mod &lt;- gwzinbr(data = southkorea_covid19,
formula = n_covid1~Morbidity+high_sch_p+Healthcare_access+
diff_sd+Crowding+Migration+Health_behavior,
lat = "x", long = "y", offset = "ln_total", method = "adaptive_bsq",
model = "negbin", distancekm = TRUE, h=230, force=TRUE)

## Bandwidth
mod$bandwidth

## Goodness of fit measures
mod$measures

</code></pre>

<hr>
<h2 id='southkorea_covid19'>South Korea COVID-19 dataset</h2><span id='topic+southkorea_covid19'></span>

<h3>Description</h3>

<p>COVID-19 data for South Korea from January 20th 2019 to March 20th 2020.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(southkorea_covid19)
</code></pre>


<h3>Format</h3>

<p>A data frame with with 244 observations on the following 11 variables:
</p>

<ul>
<li> <p><code>n_covid1</code> - number of COVID-19 cases in the early phase of the pandemic (prequarantine)
</p>
</li>
<li> <p><code>Morbidity</code> - area morbidity rate
</p>
</li>
<li> <p><code>high_sch_p</code> - percentage of high school educated people
</p>
</li>
<li> <p><code>Healthcare_access</code> - access to healthcare
</p>
</li>
<li> <p><code>diff_sd</code> - difficulty to social distancing
</p>
</li>
<li> <p><code>Crowding</code> - area crowding
</p>
</li>
<li> <p><code>Migration</code> - population mobility
</p>
</li>
<li> <p><code>Health_behavior</code> - an index calculated based on habits as alcohol drinking, current smoking, etc
</p>
</li>
<li> <p><code>x</code> - a numeric vector of x coordinates
</p>
</li>
<li> <p><code>y</code> - a numeric vector of y coordinates
</p>
</li>
<li> <p><code>ln_total</code> - log transformation of the province's total population
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
