<!DOCTYPE html><html lang="en"><head><title>Help for package transmem</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {transmem}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#transmem-package'><p>transmem: Treatment of membrane-transport data.</p></a></li>
<li><a href='#calibCurve'><p>Calculates regression curve for external standard calibration.</p></a></li>
<li><a href='#calibPlane'><p>Calculates regression plane for external standard calibration.</p></a></li>
<li><a href='#conc2frac'><p>Creates a data frame as a complete self-contained transport data set</p></a></li>
<li><a href='#concentrationcycles'><p>Lithium concentration results using a membrane</p></a></li>
<li><a href='#curvelithium'><p>External standard calibration curve for lithium in water.</p></a></li>
<li><a href='#cyclesPlot'><p>Plots transport profiles for processes involving several cycles</p></a></li>
<li><a href='#fixSecondary'><p>Interpolates secondary species concentration at missing time values</p></a></li>
<li><a href='#multiPlotSP'><p>Plots several single-phase transport profiles overlayed</p></a></li>
<li><a href='#permcoef'><p>Calculates permeability coefficients</p></a></li>
<li><a href='#planelithium'><p>Bivariated calibration plane for lithium in prescence of sodium.</p></a></li>
<li><a href='#reusecycles'><p>Membrane reuse capability to transport lithium</p></a></li>
<li><a href='#seawaterLiNaK'><p>Lithium, sodium and potassium transport profiles across a membrane</p></a></li>
<li><a href='#sepfactor'><p>Calculates separation factors between two transported species</p></a></li>
<li><a href='#signal2conc'><p>Converts signals into concentration by using given model.</p></a></li>
<li><a href='#transPlot'><p>Plots transport profiles of single run experiments</p></a></li>
<li><a href='#transPlotWR'><p>Plots transport profiles of replicated experiments</p></a></li>
<li><a href='#transTrend'><p>Fits trend equations that model transport profiles</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-6-05</td>
</tr>
<tr>
<td>Title:</td>
<td>Treatment of Membrane-Transport Data</td>
</tr>
<tr>
<td>Author:</td>
<td>Cristhian Paredes [aut, cre],
    Eduardo Rodríguez de San Miguel [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cristhian Paredes &lt;craparedesca@unal.edu.co&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Treatment and visualization of membrane (selective) transport 
    data. Transport profiles involving up to three species are produced as
    publication-ready plots and several membrane performance parameters 
    (e.g. separation factors as defined in Koros et al. (1996) 
    &lt;<a href="https://doi.org/10.1351%2Fpac199668071479">doi:10.1351/pac199668071479</a>&gt; and non-linear regression parameters
    for the equations described in Rodriguez de San Miguel et al. (2014)
    &lt;<a href="https://doi.org/10.1016%2Fj.jhazmat.2014.03.052">doi:10.1016/j.jhazmat.2014.03.052</a>&gt;) can be obtained. Many widely used 
    experimental setups (e.g. membrane physical aging) can be easily studied
    through the package's graphical representations. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://CRAN.R-project.org/package=transmem">https://CRAN.R-project.org/package=transmem</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Crparedes/transmem/issues">https://github.com/Crparedes/transmem/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2.9000</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cmna, ggformula, ggplot2, plot3D</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-06-05 05:24:26 UTC; cris</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-06-05 10:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='transmem-package'>transmem: Treatment of membrane-transport data.</h2><span id='topic+transmem-package'></span>

<h3>Description</h3>

<p>Treatment and visualization of membrane (selective) transport
data. Transport profiles involving up to three species are produced as
publication-ready plots and several membrane performance parameters
(e.g. separation factors as defined in Koros et al. (1996)
&lt;doi:10.1351/pac199668071479&gt; and non-linear regression parameters
for the equations described in Rodriguez de San Miguel et al. (2014)
&lt;doi:10.1016/j.jhazmat.2014.03.052&gt;) can be obtained. Many widely used
experimental setups (e.g. membrane physical aging) can be easily studied
through the package's graphical representations.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Eduardo Rodriguez de San Miguel, <a href="mailto:erdsmg@unam.mx">erdsmg@unam.mx</a>
</p>


<h3>References</h3>

<p>C. Paredes, E. Rodriguez de San Miguel, Polymer inclusion membrane for
the recovery and concentration of lithium from seawater. Master thesis,
Universidad Nacional Autónoma de México, México City, México, 2020.
</p>

<hr>
<h2 id='calibCurve'>Calculates regression curve for external standard calibration.</h2><span id='topic+calibCurve'></span>

<h3>Description</h3>

<p>Polinomial regression curves for external standard calibration are
calculated to later convert signals into concentration values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibCurve(curve, order = 1, badpoint = NULL, intercept = TRUE, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calibCurve_+3A_curve">curve</code></td>
<td>
<p>Data frame of numeric vectors named 'Conc' and 'Signal'
containing the concentrations and the signals,
respectively.</p>
</td></tr>
<tr><td><code id="calibCurve_+3A_order">order</code></td>
<td>
<p>Regression curve order. 1 for linear (default) and 2 for
quadratic.</p>
</td></tr>
<tr><td><code id="calibCurve_+3A_badpoint">badpoint</code></td>
<td>
<p>Numeric vector with the points to be ignored in the
regresion. This allows the easy elimination of outliers
without losing the stored measurement information.</p>
</td></tr>
<tr><td><code id="calibCurve_+3A_intercept">intercept</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the default, the intercept is
calculated normally instead of being forced to 0.</p>
</td></tr>
<tr><td><code id="calibCurve_+3A_plot">plot</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the default, the calibration data
is plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A linear method (i.e <code>lm()</code>) is applied to obtain the
regression curve.
</p>


<h3>Value</h3>

<p>Model of the calibration curve.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Eduardo Rodriguez de San Miguel, <a href="mailto:erdsmg@unam.mx">erdsmg@unam.mx</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calibPlane">calibPlane</a></code> when using more than one explanatory
variable.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(curvelithium)
  model1 &lt;- calibCurve(curve = curvelithium, order = 1)
  model2 &lt;- calibCurve(curve = curvelithium, order = 2)
  summary(model1)
  summary(model2)
</code></pre>

<hr>
<h2 id='calibPlane'>Calculates regression plane for external standard calibration.</h2><span id='topic+calibPlane'></span>

<h3>Description</h3>

<p>A bivariated regression plane for external standard calibration is
calculated to later convert signals into concentration values.
It differs from <code><a href="#topic+calibCurve">calibCurve</a></code> in the number of explanatory
variables, 2 in this case. This function is useful when some
interference effect is being considered such as the magnification of
the interest species signal due to the presence of another (known) species
in the same sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibPlane(plane, badpoint = NULL, plot = TRUE, lines = 13, theta = -30,
  phi = 40, xlab = "Species 1", ylab = "Species 2", zlab = "Signal",
  pch = 18, cex = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calibPlane_+3A_plane">plane</code></td>
<td>
<p>Data frame of numeric vectors named 'Conc', 'Conc.S' and
'Signal'. The vectors must contain the concentrations of
the main species (the one whose concentration in the
samples is to be known) and the secondary species (the
interferent), and the standard's signals, respectively.</p>
</td></tr>
<tr><td><code id="calibPlane_+3A_badpoint">badpoint</code></td>
<td>
<p>Numeric vector with the points to be ignored in the
regresion. This allows the easy elimination of outliers
without losing the stored measurement information.</p>
</td></tr>
<tr><td><code id="calibPlane_+3A_plot">plot</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the default, the calibration data
is plotted.</p>
</td></tr>
<tr><td><code id="calibPlane_+3A_lines">lines</code></td>
<td>
<p>Number of lines to use in the mesh of the plane in the plot.</p>
</td></tr>
<tr><td><code id="calibPlane_+3A_theta">theta</code></td>
<td>
<p>Azimuthal angle at which the plane is visualized.</p>
</td></tr>
<tr><td><code id="calibPlane_+3A_phi">phi</code></td>
<td>
<p>Altitude angle  at which the plane is visualized.</p>
</td></tr>
<tr><td><code id="calibPlane_+3A_xlab">xlab</code></td>
<td>
<p>Label for X axis (main species concentration).</p>
</td></tr>
<tr><td><code id="calibPlane_+3A_ylab">ylab</code></td>
<td>
<p>Label for Y axis (secondary species concentration).</p>
</td></tr>
<tr><td><code id="calibPlane_+3A_zlab">zlab</code></td>
<td>
<p>Label for Z axis (response).</p>
</td></tr>
<tr><td><code id="calibPlane_+3A_pch">pch</code></td>
<td>
<p>Plotting symbols available in R.</p>
</td></tr>
<tr><td><code id="calibPlane_+3A_cex">cex</code></td>
<td>
<p>The size of pch symbols.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A linear method (i.e <code>lm()</code>) is applied to obtain the
regression equation. The user must verify model assumptions
such as normal distribution of residuals.
</p>


<h3>Value</h3>

<p>Model of the calibration plane
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Eduardo Rodriguez de San Miguel, <a href="mailto:erdsmg@unam.mx">erdsmg@unam.mx</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(planelithium)
  planeModel &lt;- calibPlane(plane = planelithium)
  summary(planeModel$model)
</code></pre>

<hr>
<h2 id='conc2frac'>Creates a data frame as a complete self-contained transport data set</h2><span id='topic+conc2frac'></span>

<h3>Description</h3>

<p>The function transforms the data contained in concentration vectors of
feed and strip phases to a data frame that contains the complete data
of a transport process. This new data frame can be used by several functions
inside the package. The output data frame may contain normalized fractions
remaining in the feed and already transported to the strip phase, or the
original data provided in concentration units.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conc2frac(feed, strip, time = NULL, correct.strip = FALSE, normalize = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="conc2frac_+3A_feed">feed</code></td>
<td>
<p>Numeric vector with concentrations in the feed phase.</p>
</td></tr>
<tr><td><code id="conc2frac_+3A_strip">strip</code></td>
<td>
<p>Numeric vector with concentrations in the strip phase.</p>
</td></tr>
<tr><td><code id="conc2frac_+3A_time">time</code></td>
<td>
<p>Numeric vector with time at which the aliquots were
sampled. It is an optional parameter. If not provided,
regular unitary time intervals are assumed.</p>
</td></tr>
<tr><td><code id="conc2frac_+3A_correct.strip">correct.strip</code></td>
<td>
<p>Logical. If <code>FALSE</code>, the default, the information
about the amount transported to the strip phase is used
as received but if it is set to <code>TRUE</code>, the
initial concentration in the strip phase is substracted
to all concentrations in the same phase. This is
particularly useful when the blank signal is
significative or there is background noise.</p>
</td></tr>
<tr><td><code id="conc2frac_+3A_normalize">normalize</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the default, all
concentrations are divided by the initial concentration
in the feed phase to give results in fraction units.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The change in concentration of species in the feed and strip phases as a
function of time are the main magnitudes being measured in processes
involving transport across membranes. The best form to deal with such data
is inside a dataframe containing the information about the concentration
of given species in both phases and the time transcurred.
</p>
<p>Usually, this function is required after using <code><a href="#topic+signal2conc">signal2conc</a></code>
wich convert instrumental signals to concentrations.
</p>


<h3>Value</h3>

<p>Data frame with the transport proccess information
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Eduardo Rodriguez de San Miguel, <a href="mailto:erdsmg@unam.mx">erdsmg@unam.mx</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  transData &lt;- conc2frac(feed = c(0.200, 0.169, 0.152, 0.141, 0.138),
                         strip = c(0.000, 0.035, 0.045, 0.062, 0.069),
                         time = c(0, 2, 4, 6, 8))
  print(transData)
</code></pre>

<hr>
<h2 id='concentrationcycles'>Lithium concentration results using a membrane</h2><span id='topic+concentrationcycles'></span>

<h3>Description</h3>

<p>A list of 5 datasets, each of one with the transport data of each cycle in
a concentration experiment of lithium using a polymer inclusion membrane.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>concentrationcycles
</code></pre>


<h3>Format</h3>

<p>A list of 5 data frames with 10 rows and 3 variables:
</p>

<dl>
<dt>Time</dt><dd><p>Time in hours of each aliquot taken during the experiment</p>
</dd>
<dt>Phase</dt><dd><p>Phase of corresponding aliquot, Feed or Strip</p>
</dd>
<dt>Fraction</dt><dd><p>Remaining lithium concentration in the feed solution or
transported lithium concentration to the strip solution</p>
</dd>
</dl>


<h3>Source</h3>

<p>Paredes, C. and Rodríguez de San Miguel, E., Selective lithium extraction
and concentration from diluted alkaline aqueous media by a polymer
inclusion membrane and application to seawater, Desalination, Volume 487,
2020, 114500, https://doi.org/10.1016/j.desal.2020.114500.
</p>

<hr>
<h2 id='curvelithium'>External standard calibration curve for lithium in water.</h2><span id='topic+curvelithium'></span>

<h3>Description</h3>

<p>A dataset containing the concentrations and emission signals of aqueous
lithium standards measured by Flame Atomic Emission Spectrometry (FAES) at a
Perkin-Elmer 3100 Atomic Absorption Spectrometer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>curvelithium
</code></pre>


<h3>Format</h3>

<p>A data frame with 8 rows and 2 variables:
</p>

<dl>
<dt>Conc</dt><dd><p>lithium concentration in the standards, in mg/kg</p>
</dd>
<dt>Signal</dt><dd><p>emission signal of lithium at 670.8 nm, in arbitrary units</p>
</dd>
</dl>


<h3>Source</h3>

<p>Paredes, C. and Rodríguez de San Miguel, E., Selective lithium extraction
and concentration from diluted alkaline aqueous media by a polymer
inclusion membrane and application to seawater, Desalination, Volume 487,
2020, 114500, https://doi.org/10.1016/j.desal.2020.114500.
</p>

<hr>
<h2 id='cyclesPlot'>Plots transport profiles for processes involving several cycles</h2><span id='topic+cyclesPlot'></span>

<h3>Description</h3>

<p>Given the data (data frames) of a transport process that was carried
in several cycles (e.g. membrane reuse or metal concentration studies),
plots the transport profiles like in a continuous experiment indicating
the end of each cycle
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cyclesPlot(trans, xlab = "Time (h)", ylab = expression(Phi), xlim = NULL,
  ylim = NULL, xbreaks = NULL, ybreaks = NULL, size = 1.8,
  legend = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cyclesPlot_+3A_trans">trans</code></td>
<td>
<p>List containing the (ordered) transport data of each cycle.
Each data frame must be generated using
<code><a href="#topic+conc2frac">conc2frac</a></code>.</p>
</td></tr>
<tr><td><code id="cyclesPlot_+3A_xlab">xlab</code></td>
<td>
<p>Label to be used for x axis. Text and expression allowed.</p>
</td></tr>
<tr><td><code id="cyclesPlot_+3A_ylab">ylab</code></td>
<td>
<p>Label to be used for y axis. Text and expression allowed.</p>
</td></tr>
<tr><td><code id="cyclesPlot_+3A_xlim">xlim</code></td>
<td>
<p>Numeric vector of limits for X-axis.</p>
</td></tr>
<tr><td><code id="cyclesPlot_+3A_ylim">ylim</code></td>
<td>
<p>Numeric vector of limits for X-axis.</p>
</td></tr>
<tr><td><code id="cyclesPlot_+3A_xbreaks">xbreaks</code></td>
<td>
<p>Numeric vector of x-axis breaks.</p>
</td></tr>
<tr><td><code id="cyclesPlot_+3A_ybreaks">ybreaks</code></td>
<td>
<p>Numeric vector of x-axis breaks.</p>
</td></tr>
<tr><td><code id="cyclesPlot_+3A_size">size</code></td>
<td>
<p>Size used for points in the plot.</p>
</td></tr>
<tr><td><code id="cyclesPlot_+3A_legend">legend</code></td>
<td>
<p>Logical. If <code>FALSE</code>, the default, the legend is not
included.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If a concentration experiment has been made through the cycles, it is
recommended the y-axis to be in concentration scale instead of fractions.
To get the transport data frame in concentration units use
<code>conc2frac(..., normalize = FALSE)</code>. For more details see
<code><a href="#topic+conc2frac">conc2frac</a></code>.
</p>
<p>Most <code>transmem</code> graphical representations are made using the package
<code>ggplot2</code> so the function returns a ggplot2 object that can be
assigned to a variable for further modification.
</p>


<h3>Value</h3>

<p>Plot of the transport process carried in several cycles
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Eduardo Rodriguez de San Miguel, <a href="mailto:erdsmg@unam.mx">erdsmg@unam.mx</a>
</p>


<h3>References</h3>

<p>Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis.
Springer-Verlag New York. ISBN 978-3-319-24277-4,
<a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</p>

<hr>
<h2 id='fixSecondary'>Interpolates secondary species concentration at missing time values</h2><span id='topic+fixSecondary'></span>

<h3>Description</h3>

<p>If the secondary species concentration is determined in just a fraction
of the aliquots and for some reason, the concentration in all the aliquots
is required or desired, the function fits a polynomial trend line to the
existing data and interpolates the concentration in missing aliquots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fixSecondary(conc, time, compTime, order = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fixSecondary_+3A_conc">conc</code></td>
<td>
<p>Species concentration original vector.</p>
</td></tr>
<tr><td><code id="fixSecondary_+3A_time">time</code></td>
<td>
<p>Times at which given concentrations were determined.</p>
</td></tr>
<tr><td><code id="fixSecondary_+3A_comptime">compTime</code></td>
<td>
<p>Times at which the given species concentration must be
interpolated.</p>
</td></tr>
<tr><td><code id="fixSecondary_+3A_order">order</code></td>
<td>
<p>Order of the polynomial to be fitted to data (1 or 2).
Default to 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of interpolated concentrations at times provided in
<code>compTime</code>.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Eduardo Rodriguez de San Miguel, <a href="mailto:erdsmg@unam.mx">erdsmg@unam.mx</a>
</p>

<hr>
<h2 id='multiPlotSP'>Plots several single-phase transport profiles overlayed</h2><span id='topic+multiPlotSP'></span>

<h3>Description</h3>

<p>Given a list of several complete transport data, the function overlays the
transport profiles in a defined phase. The function is useful in membrane
reuse experiments as transport profile deterioration is easily visualized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiPlotSP(trans, phase = "strip", trend = NULL, legend = FALSE,
  xlab = "Time (h)", ylab = expression(Phi), xlim = NULL, ylim = NULL,
  xbreaks = NULL, ybreaks = NULL, size = 3, plot = TRUE, shape = 15,
  bw = FALSE, arw = FALSE, arw.pos = NULL, arw.txt = NULL,
  txt.pos = NULL, txt.size = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiPlotSP_+3A_trans">trans</code></td>
<td>
<p>List of data frames with the complete transport
information of interest species. Must be generated
using <code><a href="#topic+conc2frac">conc2frac</a></code>. This is the only
non-optional parameter.</p>
</td></tr>
<tr><td><code id="multiPlotSP_+3A_phase">phase</code></td>
<td>
<p>Phase to be represented in the plot: <code>'strip'</code>,
the default, or <code>'feed'</code>.</p>
</td></tr>
<tr><td><code id="multiPlotSP_+3A_trend">trend</code></td>
<td>
<p>List of Non-linear regression models of the main species
transport profil. Generated using <code><a href="#topic+transTrend">transTrend</a></code>.</p>
</td></tr>
<tr><td><code id="multiPlotSP_+3A_legend">legend</code></td>
<td>
<p>Logical. If <code>FALSE</code>, the default, the legend is not
included.</p>
</td></tr>
<tr><td><code id="multiPlotSP_+3A_xlab">xlab</code></td>
<td>
<p>Label to be used for x axis. Text and expression allowed.</p>
</td></tr>
<tr><td><code id="multiPlotSP_+3A_ylab">ylab</code></td>
<td>
<p>Label to be used for y axis. Text and expression allowed.</p>
</td></tr>
<tr><td><code id="multiPlotSP_+3A_xlim">xlim</code></td>
<td>
<p>Numeric vector of limits for X-axis.</p>
</td></tr>
<tr><td><code id="multiPlotSP_+3A_ylim">ylim</code></td>
<td>
<p>Numeric vector of limits for X-axis.</p>
</td></tr>
<tr><td><code id="multiPlotSP_+3A_xbreaks">xbreaks</code></td>
<td>
<p>Numeric vector of x-axis breaks.</p>
</td></tr>
<tr><td><code id="multiPlotSP_+3A_ybreaks">ybreaks</code></td>
<td>
<p>Numeric vector of x-axis breaks.</p>
</td></tr>
<tr><td><code id="multiPlotSP_+3A_size">size</code></td>
<td>
<p>Size used for points in the plot.</p>
</td></tr>
<tr><td><code id="multiPlotSP_+3A_plot">plot</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the default, the plot is printed
in the current graphical device.</p>
</td></tr>
<tr><td><code id="multiPlotSP_+3A_shape">shape</code></td>
<td>
<p>Shape to use in the points to be plotted.</p>
</td></tr>
<tr><td><code id="multiPlotSP_+3A_bw">bw</code></td>
<td>
<p>Logical, if <code>FALSE</code>, the default, a color version of
the plot is given. If a black and white version is
required, it must be set to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="multiPlotSP_+3A_arw">arw</code></td>
<td>
<p>Logical default to <code>FALSE</code>. If <code>TRUE</code>, a vertical
arrow is drawn in the plot. Its use is recommended when
a trend along the profiles is to be indicated.</p>
</td></tr>
<tr><td><code id="multiPlotSP_+3A_arw.pos">arw.pos</code></td>
<td>
<p>Numeric vector of the coordinates of the arrow if
<code>arw = TRUE</code>. The format is (x0, x1, y0, y1)</p>
</td></tr>
<tr><td><code id="multiPlotSP_+3A_arw.txt">arw.txt</code></td>
<td>
<p>Text to be (optionally) printed alongside the arrow.</p>
</td></tr>
<tr><td><code id="multiPlotSP_+3A_txt.pos">txt.pos</code></td>
<td>
<p>Numeric vector of the position of the center of the text
provided in <code>arw.txt</code>. The format is (x, y). If not
provided, the text is located close to the arrow but a
little alignment could be required.</p>
</td></tr>
<tr><td><code id="multiPlotSP_+3A_txt.size">txt.size</code></td>
<td>
<p>Size of the text accompanying the arrow.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Most <code>transmem</code> graphical representations are made using the package
<code>ggplot2</code> so the function returns a ggplot2 object that can be
assigned to a variable for further modification.
</p>


<h3>Value</h3>

<p>Plot with the overlayed transport profiles for a single phase
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Eduardo Rodriguez de San Miguel, <a href="mailto:erdsmg@unam.mx">erdsmg@unam.mx</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(reusecycles)
  # First step is to get trend lines for each cycle:
  trend &lt;- list()
  for (i in 1:length(reusecycles)) {
    trend[[i]] &lt;- transTrend(trans = reusecycles[[i]])
  }
  # Default plot using colors:
  multiPlotSP(trans = reusecycles, trend = trend, legend = TRUE)

  # Black and white plot including an arrow:
  multiPlotSP(trans = reusecycles, trend = trend, legend = TRUE, bw = TRUE,
              arw = TRUE, arw.pos = c(6.1, 6.1, 0.8, 0.6),
              arw.txt = 'Cycle', txt.pos = c(6.15, 0.7))
</code></pre>

<hr>
<h2 id='permcoef'>Calculates permeability coefficients</h2><span id='topic+permcoef'></span>

<h3>Description</h3>

<p>Permeability coefficients across a membrane as derived from integrated
Fick's law can be obtained from transport data according to the equation
</p>
<p style="text-align: center;"><code class="reqn">\ln{\Bigg(\frac{C}{C^0}\Bigg)}=
-\frac{P~a}{V}t</code>
</p>
<p> where <code class="reqn">P</code> is the permeability coefficient, <code class="reqn">a</code> is
the membrane exposed area, <code class="reqn">C</code> and <code class="reqn">C^0</code> are
the species concentrations at any time and at initial time in the feed phase,
respectively, and <code class="reqn">V</code> is solution volume.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permcoef(trans, vol, area, units = c("cm^3", "cm^2", "h"), conc0 = NULL,
  plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="permcoef_+3A_trans">trans</code></td>
<td>
<p>Data frame with the complete transport information of
interest species. Must be generated using
<code><a href="#topic+conc2frac">conc2frac</a></code>.</p>
</td></tr>
<tr><td><code id="permcoef_+3A_vol">vol</code></td>
<td>
<p>Volume of the feed solution.</p>
</td></tr>
<tr><td><code id="permcoef_+3A_area">area</code></td>
<td>
<p>Membrane exposed area to the feed solution.</p>
</td></tr>
<tr><td><code id="permcoef_+3A_units">units</code></td>
<td>
<p>Units in which volume, area and time are provided. Volume
and area are function's parameters while the time is
extracted from the <code>trans</code> data frame.</p>
</td></tr>
<tr><td><code id="permcoef_+3A_conc0">conc0</code></td>
<td>
<p>Initial concentration of the species in the feed solution. The
value may be extracted from transport information if the data
frame provided in <code>trans</code> is not normalized. See
<code><a href="#topic+conc2frac">conc2frac</a></code> for details.</p>
</td></tr>
<tr><td><code id="permcoef_+3A_plot">plot</code></td>
<td>
<p>logical default to <code>TRUE</code>. Should the plot be made?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Species concentration units may be arbitrary as long as the permeability
coefficient is calculated using the change in concentration ratio which is,
as most ratios, adimensional
</p>


<h3>Value</h3>

<p>A numeric vector with the permeability coefficient and it's
standard uncertainty from the regression. Units are meters per second.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Eduardo Rodriguez de San Miguel, <a href="mailto:erdsmg@unam.mx">erdsmg@unam.mx</a>
</p>

<hr>
<h2 id='planelithium'>Bivariated calibration plane for lithium in prescence of sodium.</h2><span id='topic+planelithium'></span>

<h3>Description</h3>

<p>A dataset containing the concentrations of lithium and sodium combined
standards and absorbance signals measured by Flame Atomic Absorption
Spectrometry (FAAS) at a Perkin-Elmer 3100 Atomic Absorption Spectrometer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>planelithium
</code></pre>


<h3>Format</h3>

<p>A data frame with 40 rows and 3 variables:
</p>

<dl>
<dt>Conc</dt><dd><p>lithium concentration in the standards, in mg/kg</p>
</dd>
<dt>Signal</dt><dd><p>absorbance signal of lithium at 670.8 nm, in absorbance
units</p>
</dd>
<dt>Conc.S</dt><dd><p>sodium concentration in the standards, in mg/kg</p>
</dd>
</dl>


<h3>Source</h3>

<p>Paredes, C. and Rodríguez de San Miguel, E., Selective lithium extraction
and concentration from diluted alkaline aqueous media by a polymer
inclusion membrane and application to seawater, Desalination, Volume 487,
2020, 114500, https://doi.org/10.1016/j.desal.2020.114500.
</p>

<hr>
<h2 id='reusecycles'>Membrane reuse capability to transport lithium</h2><span id='topic+reusecycles'></span>

<h3>Description</h3>

<p>A list of 10 datasets, each of one with the transport data of each
cycle in a reuse capability experiment of a polimeric inclusion membrane
selective to lithium ions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reusecycles
</code></pre>


<h3>Format</h3>

<p>A list of 10 data frames with 10 rows and 3 variables:
</p>

<dl>
<dt>Time</dt><dd><p>Time in hours of each aliquot taken during the cycle</p>
</dd>
<dt>Phase</dt><dd><p>Phase of corresponding aliquot, Feed or Strip</p>
</dd>
<dt>Fraction</dt><dd><p>Remaining lithium fraction in the feed solution or
transported lithium fraction to the strip solution</p>
</dd>
</dl>


<h3>Source</h3>

<p>Paredes, C. and Rodríguez de San Miguel, E., Selective lithium extraction
and concentration from diluted alkaline aqueous media by a polymer
inclusion membrane and application to seawater, Desalination, Volume 487,
2020, 114500, https://doi.org/10.1016/j.desal.2020.114500.
</p>

<hr>
<h2 id='seawaterLiNaK'>Lithium, sodium and potassium transport profiles across a membrane</h2><span id='topic+seawaterLiNaK'></span>

<h3>Description</h3>

<p>A list of 6 datasets containing by duplicate the transport profiles for
lithium, sodium, and potassium from a synthetic simplified seawater matrix
using a polymer inclusion membrane selective to lithium. Lithium samples
were taken every 45 minutes during 4.5 hours while sodium and potassium
determinations were made in samples taken every 1.5 hours.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seawaterLiNaK
</code></pre>


<h3>Format</h3>

<p>A list of 6 data frames (two for each lithium, sodium, and
potassium) with 14 or 8 rows and 3 variables:
</p>

<dl>
<dt>Time</dt><dd><p>Time in hours of each aliquot taken during the experiment</p>
</dd>
<dt>Phase</dt><dd><p>Phase of corresponding aliquot, Feed or Strip</p>
</dd>
<dt>Fraction</dt><dd><p>Remaining lithium concentration in the feed solution or
transported lithium concentration to the strip solution</p>
</dd>
</dl>


<h3>Source</h3>

<p>Paredes, C. and Rodríguez de San Miguel, E., Selective lithium extraction
and concentration from diluted alkaline aqueous media by a polymer
inclusion membrane and application to seawater, Desalination, Volume 487,
2020, 114500, https://doi.org/10.1016/j.desal.2020.114500.
</p>

<hr>
<h2 id='sepfactor'>Calculates separation factors between two transported species</h2><span id='topic+sepfactor'></span>

<h3>Description</h3>

<p>Given the transport data frames of two species, the function calculates
the separation factors of the main species A against a secondary species B
for each sample taken. If the dataset of secondary species is
smaller than that of the main species (e.g. if secondary species were
determined in only half the aliquots), the transport profile is completed
using <code><a href="#topic+fixSecondary">fixSecondary</a></code> function and a message will be printed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sepfactor(main, secon, order = 2, mode = "batch", plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sepfactor_+3A_main">main</code></td>
<td>
<p>Main species transport data. Must be a data frame generated
using <code>conc2frac</code>, data normalization is indifferent.</p>
</td></tr>
<tr><td><code id="sepfactor_+3A_secon">secon</code></td>
<td>
<p>Undesired species transport data. Must be a data frame
generated using <code>conc2frac</code>, data normalization is
indifferent.</p>
</td></tr>
<tr><td><code id="sepfactor_+3A_order">order</code></td>
<td>
<p>Gives the polinomia order to be used if the secondary species
information needs to be corrected due to missing data.</p>
</td></tr>
<tr><td><code id="sepfactor_+3A_mode">mode</code></td>
<td>
<p>Operation mode of the membranse system. Only <code>'batch'</code>
and <code>'continuous'</code> allowed. For semicontinuous systems
the separation factor is calculated as for continuous
systems.</p>
</td></tr>
<tr><td><code id="sepfactor_+3A_plot">plot</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the default, the plot is printed
in the current graphical device.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Separation factor for batch systems at any time different from zero is
defined as </p>
<p style="text-align: center;"><code class="reqn">SF_{A/B}(t)=\frac{C_a/C_b}{C_a^0/C_b^0}</code>
</p>
<p> where <code class="reqn">C_a</code>
and <code class="reqn">C_b</code> are the concentrations of A and B, respectively, in the
strip solution at a time <code class="reqn">t</code>, and <code class="reqn">C_a^0</code> and <code class="reqn">C_b^0</code> are
the concentrations of A and B, respectively, in the feed phase at
<code class="reqn">t=0</code> (Chen et al., 2018).
</p>
<p>For continuous or semicontinuous systems,
the separation factor is calculated according to the equation
</p>
<p style="text-align: center;"><code class="reqn">SF_{A/B}(t)\frac{C_{a,~s}/C_{b,~s}}{C_{a,~f}/C_{b,~f}}</code>
</p>
<p> where
<code class="reqn">C_{a,~s}</code>, <code class="reqn">C_{b,~s}</code> are A and B concentrations in the
strip phase at a time <code class="reqn">t</code> and <code class="reqn">C_{a,~f}</code>, <code class="reqn">C_{b,~f}</code> are
the concentrations of A and B in the feed solution at a time <code class="reqn">t</code>
(Koros and Shimidzu, 1996). Separation factor at <code class="reqn">t=0</code> equals 1
indicating that no species separation has occurred yet.
</p>


<h3>Value</h3>

<p>Data frame with two variables: Time in the same units as provided
data and SF with the separation factors at each time.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Eduardo Rodriguez de San Miguel, <a href="mailto:erdsmg@unam.mx">erdsmg@unam.mx</a>
</p>


<h3>References</h3>

<p>Q. B. Chen, Z. Y. Ji, J. Liu, Y. Y. Zhao, S. Z. Wang, J. S. Yuan,
Development of recovering lithium from brines by selective-electrodialysis:
Effect of coexisting cations on the migration of lithium, Journal of
Membrane Science 548 (2018) 408-420. doi:10.1016/j.memsci.2017.11.040.505
</p>
<p>J. Koros, H. Ma, T. Shimidzu, Terminology for membranes and membrane
processes (iupac recommendations 1996), Pure and Applied Chemistry 68 (7)
(1996) 1479-1489. doi:10.1351/pac199668071479.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(seawaterLiNaK)
  sepfactor(main = seawaterLiNaK$Lithium.1,
            secon = seawaterLiNaK$Sodium.1)
  sepfactor(main = seawaterLiNaK$Lithium.1,
            secon = seawaterLiNaK$Potassium.1)
</code></pre>

<hr>
<h2 id='signal2conc'>Converts signals into concentration by using given model.</h2><span id='topic+signal2conc'></span>

<h3>Description</h3>

<p>After a calibration model is established (either by using
<code><a href="#topic+calibCurve">calibCurve</a></code> or <code><a href="#topic+calibPlane">calibPlane</a></code>), the function
interpolates the signals of samples to get the associated concentrations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signal2conc(signal, model, dilution = NULL, planar = FALSE, Conc.S = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="signal2conc_+3A_signal">signal</code></td>
<td>
<p>Numeric vector of signals to be interpolated.</p>
</td></tr>
<tr><td><code id="signal2conc_+3A_model">model</code></td>
<td>
<p>Regression model of the calibration. Must be obtained
using <code><a href="#topic+calibCurve">calibCurve</a></code> or <code><a href="#topic+calibPlane">calibPlane</a></code>.</p>
</td></tr>
<tr><td><code id="signal2conc_+3A_dilution">dilution</code></td>
<td>
<p>Numeric vector of dilution factors applied to samples
before measurement</p>
</td></tr>
<tr><td><code id="signal2conc_+3A_planar">planar</code></td>
<td>
<p>Logical, default to <code>FALSE</code>. It must be set to TRUE if
more than one explanatory variable is used. A planar
calibration model must be provided to <code>model</code>
parameter.</p>
</td></tr>
<tr><td><code id="signal2conc_+3A_conc.s">Conc.S</code></td>
<td>
<p>Numeric vector of the concentrations of the interferent
species to be considered when a planar calibration model is
provided to <code>model</code>. It is taken into account if
<code>planar = TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of species concentrations.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Eduardo Rodriguez de San Miguel, <a href="mailto:erdsmg@unam.mx">erdsmg@unam.mx</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # A regression model is needed:
  data(curvelithium)
  model &lt;- calibCurve(curve = curvelithium, order = 2)

  signal &lt;- c(0.395, 0.259, 0.188, 0.141, 0.110, 0.095, 0.084)
  (conc &lt;- signal2conc(signal = signal, model = model))
</code></pre>

<hr>
<h2 id='transPlot'>Plots transport profiles of single run experiments</h2><span id='topic+transPlot'></span>

<h3>Description</h3>

<p>Given the transport complete information of the interest species and,
optionally, secondary and tertiary species, the function plots transport
profiles including (if given) non-linear regression models that can be
obtained using <code><a href="#topic+transTrend">transTrend</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transPlot(trans, trend = NULL, secondary = NULL, tertiary = NULL,
  sec.trend = "spline", lin.secon = FALSE, span = 0.75, legend = FALSE,
  xlab = "Time (h)", ylab = expression(Phi), xlim = NULL, ylim = NULL,
  xbreaks = NULL, ybreaks = NULL, size = 2.8, bw = FALSE, srs = NULL,
  plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transPlot_+3A_trans">trans</code></td>
<td>
<p>Data frame with the complete transport information of
interest species. Must be generated using
<code><a href="#topic+conc2frac">conc2frac</a></code>. This is the only non-optional
parameter.</p>
</td></tr>
<tr><td><code id="transPlot_+3A_trend">trend</code></td>
<td>
<p>Non-linear regression model of the main transport profile
generated using <code><a href="#topic+transTrend">transTrend</a></code>.</p>
</td></tr>
<tr><td><code id="transPlot_+3A_secondary">secondary</code></td>
<td>
<p>Secondary species transport data frame (see
<code><a href="#topic+conc2frac">conc2frac</a></code>).</p>
</td></tr>
<tr><td><code id="transPlot_+3A_tertiary">tertiary</code></td>
<td>
<p>Tertiaty species transport data frame (see
<code><a href="#topic+conc2frac">conc2frac</a></code>).</p>
</td></tr>
<tr><td><code id="transPlot_+3A_sec.trend">sec.trend</code></td>
<td>
<p>Type of trend line to be used for secondary and tertiary
species data. Default is <code>'spline'</code> but
<code>'linear'</code>, <code>'loess'</code> and <code>'logarithmic'</code>
are also allowed.</p>
</td></tr>
<tr><td><code id="transPlot_+3A_lin.secon">lin.secon</code></td>
<td>
<p>Deprecated. Use <code>sec.trend = 'linear'</code> instead.</p>
</td></tr>
<tr><td><code id="transPlot_+3A_span">span</code></td>
<td>
<p>Amount of smoothing when <code>sec.tred = 'loess'</code>. Is a
value between 0 and 1. Default is 0.75</p>
</td></tr>
<tr><td><code id="transPlot_+3A_legend">legend</code></td>
<td>
<p>Logical. If <code>FALSE</code>, the default, the legend is not
included.</p>
</td></tr>
<tr><td><code id="transPlot_+3A_xlab">xlab</code></td>
<td>
<p>Label to be used for x axis. Text and expression allowed.</p>
</td></tr>
<tr><td><code id="transPlot_+3A_ylab">ylab</code></td>
<td>
<p>Label to be used for y axis. Text and expression allowed.</p>
</td></tr>
<tr><td><code id="transPlot_+3A_xlim">xlim</code></td>
<td>
<p>Numeric vector of limits for X-axis.</p>
</td></tr>
<tr><td><code id="transPlot_+3A_ylim">ylim</code></td>
<td>
<p>Numeric vector of limits for X-axis.</p>
</td></tr>
<tr><td><code id="transPlot_+3A_xbreaks">xbreaks</code></td>
<td>
<p>Numeric vector of x-axis breaks.</p>
</td></tr>
<tr><td><code id="transPlot_+3A_ybreaks">ybreaks</code></td>
<td>
<p>Numeric vector of x-axis breaks.</p>
</td></tr>
<tr><td><code id="transPlot_+3A_size">size</code></td>
<td>
<p>Size used for points in the plot.</p>
</td></tr>
<tr><td><code id="transPlot_+3A_bw">bw</code></td>
<td>
<p>Logical, if <code>FALSE</code>, the default, a color version of
the plot is given. If a black and white version is
required, it must be set to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="transPlot_+3A_srs">srs</code></td>
<td>
<p>Deprecated.</p>
</td></tr>
<tr><td><code id="transPlot_+3A_plot">plot</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the default, the plot is printed
in the current graphical device.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Most <code>transmem</code> graphical representations are made using the package
<code>ggplot2</code> so the function returns a ggplot2 object that can be
assigned to a variable for further modification.
</p>
<p>This function has a version that uses replicated experiments and
may be useful to illustrate repeateability. For more information see
<code><a href="#topic+transPlotWR">transPlotWR</a></code>.
</p>


<h3>Value</h3>

<p>Plot of the transport profile considering all provided species.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Eduardo Rodriguez de San Miguel, <a href="mailto:erdsmg@unam.mx">erdsmg@unam.mx</a>
</p>


<h3>References</h3>

<p>Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis.
Springer-Verlag New York. ISBN 978-3-319-24277-4,
<a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(seawaterLiNaK)
  trend &lt;- transTrend(trans = seawaterLiNaK$Lithium.1, model = 'paredes')
  transPlot(trans = seawaterLiNaK$Lithium.1, trend = trend,
            secondary = seawaterLiNaK$Sodium.1,
            tertiary = seawaterLiNaK$Potassium.1)
  transPlot(trans = seawaterLiNaK$Lithium.1, trend = trend,
            secondary = seawaterLiNaK$Sodium.1,
            tertiary = seawaterLiNaK$Potassium.1, bw = TRUE)
</code></pre>

<hr>
<h2 id='transPlotWR'>Plots transport profiles of replicated experiments</h2><span id='topic+transPlotWR'></span>

<h3>Description</h3>

<p>The function works the same way as <code><a href="#topic+transPlot">transPlot</a></code> but requires
several experimental data sets that must be concatenated in lists.
This allows the process reproducibility to be evaluated in the analysis
of the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transPlotWR(trans, trend = NULL, secondary = NULL, tertiary = NULL,
  legend = FALSE, xlab = "Time (h)", ylab = expression(Phi),
  xlim = NULL, ylim = NULL, xbreaks = NULL, ybreaks = NULL,
  lin.secon = FALSE, sec.trend = "spline", span = 0.75,
  explicit = FALSE, size = 3, plot = TRUE, bw = FALSE, srs = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transPlotWR_+3A_trans">trans</code></td>
<td>
<p>List of data frames with the complete transport
information of interest species. Must be generated
using <code><a href="#topic+conc2frac">conc2frac</a></code>. This is the only
non-optional parameter.</p>
</td></tr>
<tr><td><code id="transPlotWR_+3A_trend">trend</code></td>
<td>
<p>List of Non-linear regression models of the main species
transport profil. Generated using <code><a href="#topic+transTrend">transTrend</a></code>.</p>
</td></tr>
<tr><td><code id="transPlotWR_+3A_secondary">secondary</code></td>
<td>
<p>List of secondary species transport data frame (see
<code><a href="#topic+conc2frac">conc2frac</a></code>).</p>
</td></tr>
<tr><td><code id="transPlotWR_+3A_tertiary">tertiary</code></td>
<td>
<p>List of tertiary species transport data frame (see
<code><a href="#topic+conc2frac">conc2frac</a></code>).</p>
</td></tr>
<tr><td><code id="transPlotWR_+3A_legend">legend</code></td>
<td>
<p>Logical. If <code>FALSE</code>, the default, the legend is not
included.</p>
</td></tr>
<tr><td><code id="transPlotWR_+3A_xlab">xlab</code></td>
<td>
<p>Label to be used for x axis. Text and expression allowed.</p>
</td></tr>
<tr><td><code id="transPlotWR_+3A_ylab">ylab</code></td>
<td>
<p>Label to be used for y axis. Text and expression allowed.</p>
</td></tr>
<tr><td><code id="transPlotWR_+3A_xlim">xlim</code></td>
<td>
<p>Numeric vector of limits for X-axis.</p>
</td></tr>
<tr><td><code id="transPlotWR_+3A_ylim">ylim</code></td>
<td>
<p>Numeric vector of limits for X-axis.</p>
</td></tr>
<tr><td><code id="transPlotWR_+3A_xbreaks">xbreaks</code></td>
<td>
<p>Numeric vector of x-axis breaks.</p>
</td></tr>
<tr><td><code id="transPlotWR_+3A_ybreaks">ybreaks</code></td>
<td>
<p>Numeric vector of x-axis breaks.</p>
</td></tr>
<tr><td><code id="transPlotWR_+3A_lin.secon">lin.secon</code></td>
<td>
<p>Deprecated. Use <code>sec.trend = 'linear'</code> instead.</p>
</td></tr>
<tr><td><code id="transPlotWR_+3A_sec.trend">sec.trend</code></td>
<td>
<p>Type of trend line to be used for secondary and tertiary
species data. Default is <code>'spline'</code> but
<code>'linear'</code>, <code>'loess'</code> and <code>'logarithmic'</code>
are also allowed.</p>
</td></tr>
<tr><td><code id="transPlotWR_+3A_span">span</code></td>
<td>
<p>Amount of smoothing when <code>sec.tred = 'loess'</code>. Is a
value between 0 and 1. Default is 0.75</p>
</td></tr>
<tr><td><code id="transPlotWR_+3A_explicit">explicit</code></td>
<td>
<p>Logical, if <code>FALSE</code>, the default, transport
informations are averaged and plotted using errorbars that
with the standard deviation values. If <code>TRUE</code>, all
provided data is plotted in the same graphic.</p>
</td></tr>
<tr><td><code id="transPlotWR_+3A_size">size</code></td>
<td>
<p>Size used for points in the plot.</p>
</td></tr>
<tr><td><code id="transPlotWR_+3A_plot">plot</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the default, the plot is printed
in the current graphical device.</p>
</td></tr>
<tr><td><code id="transPlotWR_+3A_bw">bw</code></td>
<td>
<p>Logical, if <code>FALSE</code>, the default, a color version of
the plot is given. If a black and white version is
required, it must be set to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="transPlotWR_+3A_srs">srs</code></td>
<td>
<p>Deprecated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Most <code>transmem</code> graphical representations are made using the package
<code>ggplot2</code> so the function returns a ggplot2 object that can be
assigned to a variable for further modification.
</p>


<h3>Value</h3>

<p>Plot of replicated transport profiles including all provided species
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Eduardo Rodriguez de San Miguel, <a href="mailto:erdsmg@unam.mx">erdsmg@unam.mx</a>
</p>


<h3>References</h3>

<p>Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis.
Springer-Verlag New York. ISBN 978-3-319-24277-4,
<a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(seawaterLiNaK)
  # Transport data frames and transport NLS regresions must be in lists
  lithium   &lt;- list(seawaterLiNaK$Lithium.1, seawaterLiNaK$Lithium.2)
  sodium    &lt;- list(seawaterLiNaK$Sodium.1, seawaterLiNaK$Sodium.2)
  potassium &lt;- list(seawaterLiNaK$Potassium.1, seawaterLiNaK$Potassium.2)
  trend     &lt;- list(transTrend(trans = seawaterLiNaK$Lithium.1),
                    transTrend(trans = seawaterLiNaK$Lithium.2))

  transPlotWR(trans = lithium, trend = trend, secondary = sodium,
              tertiary = potassium, bw = TRUE)
</code></pre>

<hr>
<h2 id='transTrend'>Fits trend equations that model transport profiles</h2><span id='topic+transTrend'></span>

<h3>Description</h3>

<p>Given a transport profile dataset, the results may be studied and
compared in terms of empirical functions that describe the transport
process in terms of regression parameters that can be asociated with
the performance of the membrane system. The parameters are obtained by
non-linear regression and are independent for each solution at both sides
of the membrane. This is particularly useful when performing system
optimizations since the parameters can be used as response variables
depending on the optimization goal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transTrend(trans, model = "paredes", eccen = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transTrend_+3A_trans">trans</code></td>
<td>
<p>Data frame with the complete transport information of
interest species. Must be generated using
<code><a href="#topic+conc2frac">conc2frac</a></code>. This is the only non-optional
parameter.</p>
</td></tr>
<tr><td><code id="transTrend_+3A_model">model</code></td>
<td>
<p>Model to be used in the regression. Default to
<code>'paredes'</code> but <code>'rodriguez'</code> also allowed.
See details.</p>
</td></tr>
<tr><td><code id="transTrend_+3A_eccen">eccen</code></td>
<td>
<p>Eccentricity factor (<code class="reqn">\gamma</code>) for the model when
<code>model</code> is set to <code>'paredes'</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Two empirical equations have been implemented in the function. In the
<code>'rodriguez'</code> model (Rodriguez de San Miguel et al., 2014), the
fractions (<code class="reqn">\Phi</code>) in feed or
strip phases as a function of time (<code class="reqn">t</code>) are fitted to
</p>
<p style="text-align: center;"><code class="reqn">\Phi(t)=Ae^{-t/d}+y_0</code>
</p>
<p> where <code class="reqn">A</code>, <code class="reqn">d</code> and <code class="reqn">y_0</code> are the
parameters to be found. In this model, parameter <code class="reqn">d</code> determines the
steepness of the species concentration change in time, <code class="reqn">y_0</code> reflects
the limiting value to which the profiles tend to at long pertraction
times and <code class="reqn">A</code> is not supposed to play an important role in the
transport description. The parameters of each phase are summarized in
the functions <code class="reqn">G_{feed}</code> and <code class="reqn">G_{strip}</code> for the feed and
strip phases: </p>
<p style="text-align: center;"><code class="reqn">G_{feed}=\frac{1}{y_0d},\qquad G_{strip}=\frac{y_0}{d}</code>
</p>

<p>The bigger each <code class="reqn">G</code> function, the better the transport process.
</p>
<p>In the <code>'paredes'</code> model (Paredes and Rodriguez de San Miguel, 2020),
the transported fractions to the strip solution and from the feed solution
are adjusted to the equations:
</p>
<p style="text-align: center;"><code class="reqn">\Phi_s(t)=\frac{\alpha_s t^\gamma}{\beta_s^{-1}+t^\gamma}</code>
</p>

<p style="text-align: center;"><code class="reqn">\Phi_f(t)=1-\frac{\alpha_f t^\gamma}{\beta_f^{-1}+t^\gamma}</code>
</p>

<p>respectively. In those equations, adjustable parameters <code class="reqn">\alpha</code> and
<code class="reqn">\beta</code> relates the
maximum fraction transported at long pertraction times and the steepness
of the concentration change, respectively. <code class="reqn">\gamma</code> is an excentricity
factor to improve the adjustment and does not need to be changed for
systems under similar conditions. The subscripts <code class="reqn">s</code> and <code class="reqn">f</code>
means strip and feed phases, respectively.
</p>
<p>The later model has the disadvantage over the former that the equation
to use depends on the phase to be modeled but has the great advantage
that if no significant accumulation is presented in the membrane,
the parameters <code class="reqn">\alpha</code> and <code class="reqn">\beta</code> should be quite similar for
both phases and a consensus value can be obtained in various simple ways,
while the other model yields quite diferent parameters for each phase.
Paredes parameters are combined by using meta-analysis tools that consider
the associated uncertainty of each one due to lack of fit to get summarized,
lower-uncertainty results. Besides, once the <code class="reqn">\gamma</code> parameter
has been chosen, the later model uses only two parameters and while
comparing models with similar performance, the simpler the better.
</p>


<h3>Value</h3>

<p>A list of 4 or 5 components (depending on the model chosen) with
the regression information for each phase, the eccentricity factor
(only in Paredes model), the name of the model used, and the
sumarized results of the regression: <code class="reqn">G_{feed}</code> and
<code class="reqn">G_{strip}</code> values for the Rodriguez model or summarized
<code class="reqn">\alpha</code> and <code class="reqn">\beta</code> parameters with asocciated uncertainty
for the Paredes model.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Eduardo Rodriguez de San Miguel, <a href="mailto:erdsmg@unam.mx">erdsmg@unam.mx</a>
</p>


<h3>References</h3>

<p>E. Rodriguez de San Miguel, X. Vital, J. de Gyves, Cr(vi) transport via a
sup ported ionic liquid membrane containing cyphos il101 as carrier:
System analysis and optimization through experimental design strategies,
Journal of Hazardous Materials 273 (2014) 253 - 262.<br />
doi:10.1016/j.jhazmat.2014.03.052.
</p>
<p>C. Paredes, E. Rodriguez de San Miguel, Polymer inclusion membrane for
the recovery and concentration of lithium from seawater. Master thesis,
Universidad Nacional Autónoma de México, México City, México, 2020.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
