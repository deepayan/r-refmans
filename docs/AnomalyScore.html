<!DOCTYPE html><html lang="en"><head><title>Help for package AnomalyScore</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AnomalyScore}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AnomalyScore-package'><p>AnomalyScore: Anomaly Scoring for Multivariate Time Series</p></a></li>
<li><a href='#all_bands'><p>Pairwise band generation in a multivariate time series</p></a></li>
<li><a href='#Anomalyscoresframe'><p>Anomaly score computation for a set of distances</p></a></li>
<li><a href='#Cort'><p>Temporal correlation coefficient</p></a></li>
<li><a href='#DEcort'><p>Distance based on value and behavior of the time series</p></a></li>
<li><a href='#DEcortNorm'><p>Normalized version of the Cort distance the modification is based on</p>
using the coefficient of variation rather than euclidean distance,
performed by normalizing by the absolute value of the total differences
of the series.</a></li>
<li><a href='#distance_matrix_banddepth'><p>Pairwise distance matrix based on the band depth distance</p></a></li>
<li><a href='#distance_matrix_CGCI'><p>Pairwise distance matrix based on the conditional Granger causality index</p></a></li>
<li><a href='#distance_matrix_coherence'><p>Distance matrix from a coherence measure</p></a></li>
<li><a href='#distance_matrix_cort'><p>Distance matrix from a pattern recognition distance</p></a></li>
<li><a href='#distance_matrix_cortNorm'><p>Normalized distance matrix from a pattern recognition distance</p></a></li>
<li><a href='#distance_matrix_dtw'><p>Normalized distance matrix from dynamic time-warping distance</p></a></li>
<li><a href='#distance_matrix_mahalanobis'><p>Pairwise distance matrix based on the mahalanobis distance</p></a></li>
<li><a href='#distance_matrix_mvLWS'><p>Pairwise distance matrix based on the multivariate locally wavelet partial</p>
coherence</a></li>
<li><a href='#distance_matrix_PDC'><p>Distance matrix from a partial directed coherence measure (PDC)</p></a></li>
<li><a href='#distance_matrix_PMIME'><p>Pairwise distance matrix based on the partial mutual information of mixed</p>
embedings (PMIME) method</a></li>
<li><a href='#distance_matrix_RGPDC'><p>Pairwise distance matrix based on the restricted generalized partial</p>
directed coherence</a></li>
<li><a href='#distance_matrix_wasserstein'><p>Distance matrix from based on the Wasserstein distance</p></a></li>
<li><a href='#DTWcort'><p>Extention of the dynamic time warping distance</p></a></li>
<li><a href='#dxy_bands'><p>Band depth distance between 2 time series given a set of bands</p></a></li>
<li><a href='#informative_bands'><p>indexes where a series is within a specific band</p></a></li>
<li><a href='#kneighbors_distance_docall'><p>K-Nearest neighbors algorithm to compute an anomaly score</p></a></li>
<li><a href='#matrix_PDC'><p>Partial directed coherence matrix</p></a></li>
<li><a href='#mBTS'><p>modified Back-in-time Selection for vector AR parameters estimation</p></a></li>
<li><a href='#mBTS_Af_mat'><p>mBTS Vector Autoregressive coefficients fourier transform</p></a></li>
<li><a href='#mBTSCGCI'><p>computation of the conditional Granger causality index</p></a></li>
<li><a href='#mBTSRGPDC'><p>Restricted Generalized Partial Directed Coherence</p></a></li>
<li><a href='#multilagmatrix'><p>multilagmatrix</p></a></li>
<li><a href='#PMIME'><p>PMIME Partial mutual information from mixed embedding</p></a></li>
<li><a href='#sqnorms'><p>Quadratic multiplication of a matrix M with respect to a matrix A:</p>
Conj(M)  A M, where Conj() is the complex conjugate function</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Anomaly Scoring for Multivariate Time Series</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Compute an anomaly score for multivariate time series based on the k-nearest neighbors algorithm. Different computations of distances between time series are provided.  </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>dtw, class, astsa, transport, marima, TSA, RANN, MASS, mvLSW,
stats</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-11-20 14:21:40 UTC; guillermocgg</td>
</tr>
<tr>
<td>Author:</td>
<td>Guillermo Granados
    <a href="https://orcid.org/0000-0003-4868-6163"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Guillermo Granados &lt;guillermo.granadosgarcia@outlook.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-11-21 08:00:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='AnomalyScore-package'>AnomalyScore: Anomaly Scoring for Multivariate Time Series</h2><span id='topic+AnomalyScore'></span><span id='topic+AnomalyScore-package'></span>

<h3>Description</h3>

<p>Compute an anomaly score for multivariate time series based on the k-nearest neighbors algorithm. Different computations of distances between time series are provided.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Guillermo Granados <a href="mailto:guillermo.granadosgarcia@outlook.com">guillermo.granadosgarcia@outlook.com</a> (<a href="https://orcid.org/0000-0003-4868-6163">ORCID</a>)
</p>

<hr>
<h2 id='all_bands'>Pairwise band generation in a multivariate time series</h2><span id='topic+all_bands'></span>

<h3>Description</h3>

<p>takes all the pairs of series in a multivariate set and compute the band
between each pair od series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>all_bands(series)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="all_bands_+3A_series">series</code></td>
<td>
<p>A matrix of n columns representing a multivariate time series,
each column is a univariate time series</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with two elements the lowerbounds of all (n)(n-1)/2 pairs
and the upperbounds of the pairwise bands
</p>


<h3>See Also</h3>

<p>Band Depth Clustering for Nonstationary Time Series and
Wind Speed Behavior (2018) Tupper et al
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=matrix( rnorm(200), ncol=10  )
all_bands(X)

</code></pre>

<hr>
<h2 id='Anomalyscoresframe'>Anomaly score computation for a set of distances</h2><span id='topic+Anomalyscoresframe'></span>

<h3>Description</h3>

<p>Computes anomaly scores for a selection of different distances
for a single dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Anomalyscoresframe(unit, knn, measures, dparams)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Anomalyscoresframe_+3A_unit">unit</code></td>
<td>
<p>A matrix representing a multivariate time series where each
column is a univariate time series.</p>
</td></tr>
<tr><td><code id="Anomalyscoresframe_+3A_knn">knn</code></td>
<td>
<p>number of nearest neighbors to consider for the anomaly scores</p>
</td></tr>
<tr><td><code id="Anomalyscoresframe_+3A_measures">measures</code></td>
<td>
<p>vector with the indexes of the selected measures
1=Cort, 2=Wasserstein, 3=Mahalanobis, 4=Normalized Cort,
5=Coherence, 6=PDC, 7=CGCI,8=RGPDC, 9=PMIME, 10=mvLWS, 11=Band depth</p>
</td></tr>
<tr><td><code id="Anomalyscoresframe_+3A_dparams">dparams</code></td>
<td>
<p>a list where each element is a list with all the parameters
necessary to compute the selected distances. If the distance does not need
further parameters then define an empty list</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the names of series in unit as a column called
&quot;series&quot; and the corresponding scores computed for each distance. The rank is
ordered with respect to the first measure in the measures index vector
</p>


<h3>See Also</h3>

<p>Guillermo Granados, and Idris Eckley. &quot;Electricity Demand of Buildings Benchmarked via Regression Trees on Nearest Neighbors Anomaly Scores&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>unit=matrix( rnorm(500), ncol=5  )
measures= c(1,5,11 ) # Cort, Coherence and Band depth
knn=3
dparams=list(
  list(k=2),
  list( span1=2, span2=2, period = 5),
  list( )
)
Anomalyscoresframe(unit, knn,measures, dparams)
</code></pre>

<hr>
<h2 id='Cort'>Temporal correlation coefficient</h2><span id='topic+Cort'></span>

<h3>Description</h3>

<p>Return the temporal correlations of two time series by first taking the lag
one differences of each series and the computing the correlation coefficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Cort(S1, S2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Cort_+3A_s1">S1</code></td>
<td>
<p>A vector representing a univariate time series</p>
</td></tr>
<tr><td><code id="Cort_+3A_s2">S2</code></td>
<td>
<p>A second vector representing a univariate time series</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A coefficient in the interval <code class="reqn">[-1,1]</code> representing the lag 1 correlation
</p>


<h3>See Also</h3>

<p>Douzal-Chouakria, Ahlame, and Cecile Amblard. &quot;Classification
Trees for Time Series.&quot; Pattern Recognition 45, no. 3 (March 2012):
1076-91. <a href="https://doi.org/10.1016/j.patcog.2011.08.018">doi:10.1016/j.patcog.2011.08.018</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>S1=rnorm(100)
S2=rnorm(100)
Cort(S1, S2)
</code></pre>

<hr>
<h2 id='DEcort'>Distance based on value and behavior of the time series</h2><span id='topic+DEcort'></span>

<h3>Description</h3>

<p>Return a weighted distance based on a weighted sum of the Euclidean norm
and the temporal correlation coefficient. The distance is inflated in the
presence of NA compensating for the lack of information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DEcort(k, S1, S2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DEcort_+3A_k">k</code></td>
<td>
<p>The parameter $k$ controls the contribution of the sum of squares
comparison as a value-based metric and the $Cort$ quantity as a behavioral
metric; when $k=0$, then the distance is equal to the value-based metric,
on the other hand, when $k=6$ the distance is mainly determined by the value
of the temporal correlation $Cort$.</p>
</td></tr>
<tr><td><code id="DEcort_+3A_s1">S1</code></td>
<td>
<p>A vector representing a univariate time series</p>
</td></tr>
<tr><td><code id="DEcort_+3A_s2">S2</code></td>
<td>
<p>A second vector representing a univariate time series</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a non-zero value
</p>


<h3>See Also</h3>

<p>Douzal-Chouakria, Ahlame, and Cecile Amblard. &quot;Classification
Trees for Time Series.&quot; Pattern Recognition 45, no. 3 (March 2012):
1076-91. <a href="https://doi.org/10.1016/j.patcog.2011.08.018">doi:10.1016/j.patcog.2011.08.018</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>S1=rnorm(100)
S2=rnorm(100)
k=1
DEcort(k,S1, S2)
</code></pre>

<hr>
<h2 id='DEcortNorm'>Normalized version of the Cort distance the modification is based on
using the coefficient of variation rather than euclidean distance,
performed by normalizing by the absolute value of the total differences
of the series.</h2><span id='topic+DEcortNorm'></span>

<h3>Description</h3>

<p>Normalized version of the Cort distance the modification is based on
using the coefficient of variation rather than euclidean distance,
performed by normalizing by the absolute value of the total differences
of the series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DEcortNorm(k, S1, S2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DEcortNorm_+3A_k">k</code></td>
<td>
<p>The parameter $k$ controls the contribution of the sum of squares
comparison as a value-based metric and the $Cort$ quantity as a behavioral
metric; when $k=0$, then the distance is equal to the value-based metric,
on the other hand, when $k=6$ the distance is mainly determined by the value
of the temporal correlation $Cort$.</p>
</td></tr>
<tr><td><code id="DEcortNorm_+3A_s1">S1</code></td>
<td>
<p>A vector representing a univariate time series</p>
</td></tr>
<tr><td><code id="DEcortNorm_+3A_s2">S2</code></td>
<td>
<p>A second vector representing a univariate time series</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a non-zero value
</p>


<h3>See Also</h3>

<p>Granados-Garcia, and Idris Eckley. &quot;Building Electricity Demand
Benchmarking via a Regression Trees on Anomaly Scores&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>S1=rnorm(100)
S2=rnorm(100)
k=1
DEcortNorm(k,S1, S2)
</code></pre>

<hr>
<h2 id='distance_matrix_banddepth'>Pairwise distance matrix based on the band depth distance</h2><span id='topic+distance_matrix_banddepth'></span>

<h3>Description</h3>

<p>Pairwise distance matrix based on the band depth distance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distance_matrix_banddepth(unit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distance_matrix_banddepth_+3A_unit">unit</code></td>
<td>
<p>A matrix representing a multivariate time series where each
column is a univariate time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with pairwise distances
</p>


<h3>See Also</h3>

<p>Band Depth Clustering for Nonstationary Time Series and
Wind Speed Behavior (2018) Tupper et al
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=matrix( rnorm(2000), ncol=10  )
distance_matrix_banddepth(unit=X)
</code></pre>

<hr>
<h2 id='distance_matrix_CGCI'>Pairwise distance matrix based on the conditional Granger causality index</h2><span id='topic+distance_matrix_CGCI'></span>

<h3>Description</h3>

<p>Pairwise distance matrix of a multivariate time series based on the
the conditional Granger causality index distance between two series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distance_matrix_CGCI(unit, pmax)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distance_matrix_CGCI_+3A_unit">unit</code></td>
<td>
<p>A matrix representing a multivariate time series where each
column is a univariate time series.</p>
</td></tr>
<tr><td><code id="distance_matrix_CGCI_+3A_pmax">pmax</code></td>
<td>
<p>maximum order(lag) of the VAR model to be considered</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with pairwise distances
</p>


<h3>See Also</h3>

<p>Siggiridou, Elsa, and Dimitris Kugiumtzis. &quot;Granger Causality
in Multivariate Time Series Using a Time-Ordered Restricted Vector
Autoregressive Model.&quot; IEEE Transactions on Signal Processing 64, no.
7 (April 2016): 1759-73. <a href="https://doi.org/10.1109/TSP.2015.2500893">doi:10.1109/TSP.2015.2500893</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=matrix( rnorm(2000), ncol=10  )
pmax=4
distance_matrix_CGCI(unit=X, pmax)
</code></pre>

<hr>
<h2 id='distance_matrix_coherence'>Distance matrix from a coherence measure</h2><span id='topic+distance_matrix_coherence'></span>

<h3>Description</h3>

<p>Pairwise distance matrix of a multivariate time series based on computing the
squared coherence and transformed it to represent a distance at a specific
frequency
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distance_matrix_coherence(unit, span1, span2, period)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distance_matrix_coherence_+3A_unit">unit</code></td>
<td>
<p>A matrix representing a multivariate time series where each
column is a univariate time series.</p>
</td></tr>
<tr><td><code id="distance_matrix_coherence_+3A_span1">span1</code></td>
<td>
<p>Odd integer giving the widths of modified Daniell
smoothers to be used to smooth the periodogram. Refers to the bandwidth of
the smoothing process.</p>
</td></tr>
<tr><td><code id="distance_matrix_coherence_+3A_span2">span2</code></td>
<td>
<p>Odd integer giving the widths of modified Daniell
smoothers to be used to smooth the periodogram. Control another level of
smoothing to the spectral density estimation without altering the peaks</p>
</td></tr>
<tr><td><code id="distance_matrix_coherence_+3A_period">period</code></td>
<td>
<p>Integer referencing the index of the frequency to use for the
distance. It gives the Hertz or periods per unit of time; i.e., if the
sampling is per minute, and each hour cycle is the period of interest</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with pairwise distances
</p>


<h3>See Also</h3>

<p>For more details, check the <code>astsa</code> package documentation on CRAN or visit
the GitHub repository <a href="https://github.com/nickpoison/astsa">https://github.com/nickpoison/astsa</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=matrix( rnorm(2000), ncol=10  )
span1=2
span2=2
period=3
distance_matrix_coherence(unit=X, span1, span2, period )
</code></pre>

<hr>
<h2 id='distance_matrix_cort'>Distance matrix from a pattern recognition distance</h2><span id='topic+distance_matrix_cort'></span>

<h3>Description</h3>

<p>pairwise distance matrix of a multivariate time series based on a value
(Euclidean distance) and behavior (temporal correlation) measures
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distance_matrix_cort(k, unit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distance_matrix_cort_+3A_k">k</code></td>
<td>
<p>The parameter $k$ controls the contribution of the sum of squares
comparison as a value-based metric and the $Cort$ quantity as a behavioral
metric; when $k=0$, then the distance is equal to the value-based metric,
on the other hand, when $k=6$ the distance is mainly determined by the value
of the temporal correlation $Cort$.</p>
</td></tr>
<tr><td><code id="distance_matrix_cort_+3A_unit">unit</code></td>
<td>
<p>A matrix representing a multivariate time series where each
column is a univariate time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with pairwise distances
</p>


<h3>See Also</h3>

<p>Douzal-Chouakria, Ahlame, and Cecile Amblard. &quot;Classification
Trees for Time Series.&quot; Pattern Recognition 45, no. 3 (March 2012):
1076-91. <a href="https://doi.org/10.1016/j.patcog.2011.08.018">doi:10.1016/j.patcog.2011.08.018</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=matrix( rnorm(200), ncol=10  )
k=2
distance_matrix_cort(k,X)
</code></pre>

<hr>
<h2 id='distance_matrix_cortNorm'>Normalized distance matrix from a pattern recognition distance</h2><span id='topic+distance_matrix_cortNorm'></span>

<h3>Description</h3>

<p>pairwise distance matrix of a multivariate time series based on a value
(Coefficient of variation) and behavior (temporal correlation) measures
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distance_matrix_cortNorm(k, unit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distance_matrix_cortNorm_+3A_k">k</code></td>
<td>
<p>The parameter $k$ controls the contribution of the sum of squares
comparison as a value-based metric and the $Cort$ quantity as a behavioral
metric; when $k=0$, then the distance is equal to the value-based metric,
on the other hand, when $k=6$ the distance is mainly determined by the value
of the temporal correlation $Cort$.</p>
</td></tr>
<tr><td><code id="distance_matrix_cortNorm_+3A_unit">unit</code></td>
<td>
<p>A matrix representing a multivariate time series where each
column is a univariate time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with pairwise distances
</p>


<h3>See Also</h3>

<p>Guillermo Granados, and Idris Eckley. &quot;Electricity Demand of Buildings Benchmarked via Regression Trees on Nearest Neighbors Anomaly Scores&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=matrix( rnorm(200), ncol=10  )
k=2
distance_matrix_cortNorm(k,X)
</code></pre>

<hr>
<h2 id='distance_matrix_dtw'>Normalized distance matrix from dynamic time-warping distance</h2><span id='topic+distance_matrix_dtw'></span>

<h3>Description</h3>

<p>pairwise distance matrix of a multivariate time series based on a minimal
mapping between two time series weighted by temporal correlation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distance_matrix_dtw(k, unit, maxwindow)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distance_matrix_dtw_+3A_k">k</code></td>
<td>
<p>The parameter $k$ controls the contribution of the sum of squares
comparison as a value-based metric and the $Cort$ quantity as a behavioral
metric; when $k=0$, then the distance is equal to the value-based metric,
on the other hand, when $k=6$ the distance is mainly determined by the value
of the temporal correlation $Cort$.</p>
</td></tr>
<tr><td><code id="distance_matrix_dtw_+3A_unit">unit</code></td>
<td>
<p>A matrix representing a multivariate time series where each
column is a univariate time series.</p>
</td></tr>
<tr><td><code id="distance_matrix_dtw_+3A_maxwindow">maxwindow</code></td>
<td>
<p>the maximum shift allowed between time series points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with pairwise distances
</p>


<h3>See Also</h3>

<p>For more details, check the <code>dtw</code> package documentation on CRAN
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=matrix( rnorm(200), ncol=10  )
k=2
maxwindow=10
distance_matrix_dtw(k,X,maxwindow)
</code></pre>

<hr>
<h2 id='distance_matrix_mahalanobis'>Pairwise distance matrix based on the mahalanobis distance</h2><span id='topic+distance_matrix_mahalanobis'></span>

<h3>Description</h3>

<p>Pairwise distance matrix of a multivariate time series based on the
Mahalanobis distance between two series, modified to consider the different
scales of series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distance_matrix_mahalanobis(unit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distance_matrix_mahalanobis_+3A_unit">unit</code></td>
<td>
<p>A matrix representing a multivariate time series where each
column is a univariate time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with pairwise distances
</p>


<h3>See Also</h3>

<p>Prekopcsak, Zoltan, and Daniel Lemire. &quot;Time Series Classification
by Class-Specific Mahalanobis Distance Measures.&quot; Advances in Data Analysis
and Classification 6, no. 3 (October 2012): 185-200. <a href="https://doi.org/10.1007/s11634-012-0110-6">doi:10.1007/s11634-012-0110-6</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=matrix( rnorm(2000), ncol=10  )
distance_matrix_mahalanobis(unit=X )
</code></pre>

<hr>
<h2 id='distance_matrix_mvLWS'>Pairwise distance matrix based on the multivariate locally wavelet partial
coherence</h2><span id='topic+distance_matrix_mvLWS'></span>

<h3>Description</h3>

<p>Pairwise distance matrix based on the multivariate locally wavelet partial
coherence
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distance_matrix_mvLWS(unit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distance_matrix_mvLWS_+3A_unit">unit</code></td>
<td>
<p>A matrix representing a multivariate time series where each
column is a univariate time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with pairwise distances
</p>


<h3>See Also</h3>

<p>Park, Timothy, Idris A. Eckley, and Hernando C. Ombao.
&quot;Estimating Time-Evolving Partial Coherence Between Signals via Multivariate
Locally Stationary Wavelet Processes.&quot; IEEE Transactions on Signal
Processing 62, no. 20 (October 2014): 5240-50. <a href="https://doi.org/10.1109/TSP.2014.2343937">doi:10.1109/TSP.2014.2343937</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=matrix( rnorm(2000), ncol=10  )
distance_matrix_mvLWS(unit=X)
</code></pre>

<hr>
<h2 id='distance_matrix_PDC'>Distance matrix from a partial directed coherence measure (PDC)</h2><span id='topic+distance_matrix_PDC'></span>

<h3>Description</h3>

<p>Pairwise distance matrix of a multivariate time series based on the
partial directed coherence among two series. The distance considers both
directions of causality and transform it to give 0 in absence of
causality between the series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distance_matrix_PDC(unit, ar, period)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distance_matrix_PDC_+3A_unit">unit</code></td>
<td>
<p>A matrix representing a multivariate time series where each
column is a univariate time series.</p>
</td></tr>
<tr><td><code id="distance_matrix_PDC_+3A_ar">ar</code></td>
<td>
<p>Integer vector containing all the lags considered for the
vector autoregressive model</p>
</td></tr>
<tr><td><code id="distance_matrix_PDC_+3A_period">period</code></td>
<td>
<p>Integer referencing the index of the frequency to use for the
distance. It gives the Hertz or periods per unit of time; i.e., if the
sampling is per minute, and each hour cycle is the period of interest</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with pairwise distances
</p>


<h3>See Also</h3>

<p>Guillermo Granados, and Idris Eckley. &quot;Electricity Demand of Buildings Benchmarked via Regression Trees on Nearest Neighbors Anomaly Scores&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=matrix( rnorm(2000), ncol=10  )
ar=c(1, 2)
period=10
distance_matrix_PDC(  unit=X, ar,  period )
</code></pre>

<hr>
<h2 id='distance_matrix_PMIME'>Pairwise distance matrix based on the partial mutual information of mixed
embedings (PMIME) method</h2><span id='topic+distance_matrix_PMIME'></span>

<h3>Description</h3>

<p>Pairwise distance matrix based on the partial mutual information of mixed
embedings (PMIME) method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distance_matrix_PMIME(unit, Lmax, Tl, nnei, A)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distance_matrix_PMIME_+3A_unit">unit</code></td>
<td>
<p>A matrix representing a multivariate time series where each
column is a univariate time series.</p>
</td></tr>
<tr><td><code id="distance_matrix_PMIME_+3A_lmax">Lmax</code></td>
<td>
<p>: the maximum delay to search for X and Y components for the mixed
embedding vector ,default is 5.</p>
</td></tr>
<tr><td><code id="distance_matrix_PMIME_+3A_tl">Tl</code></td>
<td>
<p>: Tl steps ahead that the mixed embedding vector has to explain.
Note that if Tl&gt;1 the future vector is of length Tl and contains
the samples at times t+1,..,t+Tl ,dafault is 1.</p>
</td></tr>
<tr><td><code id="distance_matrix_PMIME_+3A_nnei">nnei</code></td>
<td>
<p>: number of nearest neighbors for density estimation ,default is 5</p>
</td></tr>
<tr><td><code id="distance_matrix_PMIME_+3A_a">A</code></td>
<td>
<p>: the threshold for the ratio of CMI over MI of the lagged variables
for the termination criterion.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with pairwise distances
</p>


<h3>See Also</h3>

<p>Kugiumtzis, D. &quot;Direct-Coupling Information Measure from Nonuniform
Embedding.&quot; Physical Review E 87, no. 6 (June 25, 2013): 062918.
<a href="https://doi.org/10.1103/PhysRevE.87.062918">doi:10.1103/PhysRevE.87.062918</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=matrix( rnorm(300), ncol=3  )
Lmax=2
Tl=1
nnei=5
A=.95
distance_matrix_PMIME(unit=X, Lmax, Tl, nnei, A )
</code></pre>

<hr>
<h2 id='distance_matrix_RGPDC'>Pairwise distance matrix based on the restricted generalized partial
directed coherence</h2><span id='topic+distance_matrix_RGPDC'></span>

<h3>Description</h3>

<p>Pairwise distance matrix of a multivariate time series based on the
the restricted generalized partial directed coherence distance
between two series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distance_matrix_RGPDC(unit, pmax, period)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distance_matrix_RGPDC_+3A_unit">unit</code></td>
<td>
<p>A matrix representing a multivariate time series where each
column is a univariate time series.</p>
</td></tr>
<tr><td><code id="distance_matrix_RGPDC_+3A_pmax">pmax</code></td>
<td>
<p>maximum order(lag) of the VAR model to be considered</p>
</td></tr>
<tr><td><code id="distance_matrix_RGPDC_+3A_period">period</code></td>
<td>
<p>Integer referencing the index of the frequency to use for the
distance. It gives the Hertz or periods per unit of time; i.e., if the
sampling is per minute, and each hour cycle is the period of interest</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with pairwise distances
</p>


<h3>See Also</h3>

<p>Siggiridou, Elsa, Vasilios K. Kimiskidis, and Dimitris Kugiumtzis.
&quot;Dimension Reduction of Frequency-Based Direct Granger Causality Measures
on Short Time Series.&quot; Journal of Neuroscience Methods 289 (September 2017)
: 64-74. <a href="https://doi.org/10.1016/j.jneumeth.2017.06.021">doi:10.1016/j.jneumeth.2017.06.021</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=matrix( rnorm(2000), ncol=10  )
pmax=4
period=3
distance_matrix_RGPDC(unit=X, pmax, period)
</code></pre>

<hr>
<h2 id='distance_matrix_wasserstein'>Distance matrix from based on the Wasserstein distance</h2><span id='topic+distance_matrix_wasserstein'></span>

<h3>Description</h3>

<p>Pairwise distance matrix of a multivariate time series based on the
Wasserstein distance between the empirical distribution of the series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distance_matrix_wasserstein(unit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distance_matrix_wasserstein_+3A_unit">unit</code></td>
<td>
<p>A matrix representing a multivariate time series where each
column is a univariate time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with pairwise distances
</p>


<h3>See Also</h3>

<p>For more details, check the <code>transport</code> package documentation on CRAN
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=matrix( rnorm(2000), ncol=10  )
distance_matrix_wasserstein(unit=X)
</code></pre>

<hr>
<h2 id='DTWcort'>Extention of the dynamic time warping distance</h2><span id='topic+DTWcort'></span>

<h3>Description</h3>

<p>This function uses the dtw() function from the dtw R package to compute
a distance based on the mapping than minimizes the distance between two sets
of points, the parameters chosen are the &quot;Manhattan&quot; distance to compute the
differences between points and the &quot;sakoechiba&quot; window type. Important note:
the dtw function does not accept NA values, therefore these types of values
are removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DTWcort(k, S1, S2, maxwindow)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DTWcort_+3A_k">k</code></td>
<td>
<p>The parameter $k$ controls the contribution of the sum of squares
comparison as a value-based metric and the $Cort$ quantity as a behavioral
metric; when $k=0$, then the distance is equal to the value-based metric,
on the other hand, when $k=6$ the distance is mainly determined by the value
of the temporal correlation $Cort$.</p>
</td></tr>
<tr><td><code id="DTWcort_+3A_s1">S1</code></td>
<td>
<p>A vector representing a univariate time series</p>
</td></tr>
<tr><td><code id="DTWcort_+3A_s2">S2</code></td>
<td>
<p>A second vector representing a univariate time series</p>
</td></tr>
<tr><td><code id="DTWcort_+3A_maxwindow">maxwindow</code></td>
<td>
<p>the maximum shift allowed between time series points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A non-negative value representing the distance between two time
series
</p>


<h3>See Also</h3>

<p>Douzal-Chouakria, Ahlame, and Cecile Amblard. &quot;Classification
Trees for Time Series.&quot; Pattern Recognition 45, no. 3 (March 2012):
1076-91. <a href="https://doi.org/10.1016/j.patcog.2011.08.018">doi:10.1016/j.patcog.2011.08.018</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>S1=rnorm(100)
S2=rnorm(100)
k=1
maxwindow=20
DTWcort(k,S1, S2,maxwindow)

</code></pre>

<hr>
<h2 id='dxy_bands'>Band depth distance between 2 time series given a set of bands</h2><span id='topic+dxy_bands'></span>

<h3>Description</h3>

<p>Distance based on a depth concept, given a set of bands a modified Jaccard
measure is compute between the sets of indices that two series share,
the Jaccard distances then are averaged over all informative bands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dxy_bands(allbands, x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dxy_bands_+3A_allbands">allbands</code></td>
<td>
<p>a list with two elements the lowerbounds of all (n)(n-1)/2
pairs and the upperbounds of the pairwise bands.</p>
</td></tr>
<tr><td><code id="dxy_bands_+3A_x">x</code></td>
<td>
<p>A vector  representing a univariate time series</p>
</td></tr>
<tr><td><code id="dxy_bands_+3A_y">y</code></td>
<td>
<p>A vector  representing a univariate time series</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A non-negative value representing the distance between two time
series, based on the concept of band depth.
</p>


<h3>See Also</h3>

<p>Band Depth Clustering for Nonstationary Time Series and
Wind Speed Behavior (2018) Tupper et al
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=matrix( rnorm(200), ncol=10  )
M=all_bands(X)
dxy_bands(M,X[,1],X[,2] )

</code></pre>

<hr>
<h2 id='informative_bands'>indexes where a series is within a specific band</h2><span id='topic+informative_bands'></span>

<h3>Description</h3>

<p>Return the indicies in which the values of a series x are located within a
band b, called the informative bands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>informative_bands(allbands, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="informative_bands_+3A_allbands">allbands</code></td>
<td>
<p>a list with two elements the lowerbounds of all (n)(n-1)/2
pairs and the upperbounds of the pairwise bands.
Result of the function all_bands</p>
</td></tr>
<tr><td><code id="informative_bands_+3A_x">x</code></td>
<td>
<p>A vector  representing a univariate time series</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with indices
</p>


<h3>See Also</h3>

<p>Band Depth Clustering for Nonstationary Time Series and
Wind Speed Behavior (2018) Tupper et al
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=matrix( rnorm(200), ncol=10  )
M=all_bands(X)
informative_bands(M,X[,1] )

</code></pre>

<hr>
<h2 id='kneighbors_distance_docall'>K-Nearest neighbors algorithm to compute an anomaly score</h2><span id='topic+kneighbors_distance_docall'></span>

<h3>Description</h3>

<p>The method obtain a distance matrix and find the K-nearest neighbors of
each series and sum their distances in the neighborhood.
The sum is defined as the anomaly score, the series with higher scores
implies their neighbors are far away and such a series is a potential
outlier
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kneighbors_distance_docall(knn, distance, dparams)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kneighbors_distance_docall_+3A_knn">knn</code></td>
<td>
<p>number of nearest neighbors to consider for the anomaly score</p>
</td></tr>
<tr><td><code id="kneighbors_distance_docall_+3A_distance">distance</code></td>
<td>
<p>function name of the available distance matrices</p>
</td></tr>
<tr><td><code id="kneighbors_distance_docall_+3A_dparams">dparams</code></td>
<td>
<p>a list with all the parameters for the distance matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two elements with the anomaly scores and the distance
matrix
</p>


<h3>See Also</h3>

<p>Guillermo Granados, and Idris Eckley. &quot;Electricity Demand of Buildings Benchmarked via Regression Trees on Nearest Neighbors Anomaly Scores&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=matrix( rnorm(2000), ncol=10  )
distance=distance_matrix_coherence
dparams=list(unit=X, span1=2, span2=2, period = 5 )
knn=5
kneighbors_distance_docall(knn,distance, dparams)
</code></pre>

<hr>
<h2 id='matrix_PDC'>Partial directed coherence matrix</h2><span id='topic+matrix_PDC'></span>

<h3>Description</h3>

<p>Partial directed coherence matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrix_PDC(unit, ar)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="matrix_PDC_+3A_unit">unit</code></td>
<td>
<p>A Matrix containing the multivariate time series. Each column
represents a univariate time series.</p>
</td></tr>
<tr><td><code id="matrix_PDC_+3A_ar">ar</code></td>
<td>
<p>Integer vector containing all the lags considered for the
vector autoregressive model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An real array of dimensions, ncol(unit), ncol(unit), n, where n is the number of
frequencies at which the PDC is estimated.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=matrix( rnorm(2000), ncol=10  )
ar=c(1, 2)
matrix_PDC(X, ar)
</code></pre>

<hr>
<h2 id='mBTS'>modified Back-in-time Selection for vector AR parameters estimation</h2><span id='topic+mBTS'></span>

<h3>Description</h3>

<p>modified Back-in-time Selection for vector AR parameters estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mBTS(xM, responseindex, pmax)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mBTS_+3A_xm">xM</code></td>
<td>
<p>the matrix of K time series (variables in columns)</p>
</td></tr>
<tr><td><code id="mBTS_+3A_responseindex">responseindex</code></td>
<td>
<p>the index of the response variable in <code class="reqn">\{1,\ldots,K\}</code></p>
</td></tr>
<tr><td><code id="mBTS_+3A_pmax">pmax</code></td>
<td>
<p>maximum order(lag) of the VAR model to be considered</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the matrix of all explanatory lagged variables in the
DR model. The sequence of the lagged variables in 'lagM'
</p>


<h3>See Also</h3>

<p>I. Vlachos and D. Kugiumtzis, &quot;Backward-in-time selection of the
order of dynamic regression prediction model,&quot; J. Forecast.,
vol. 32, pp. 685-701, 2013.
</p>

<hr>
<h2 id='mBTS_Af_mat'>mBTS Vector Autoregressive coefficients fourier transform</h2><span id='topic+mBTS_Af_mat'></span>

<h3>Description</h3>

<p>DFT Vector Autoregressive coefficients matrix using the mBTS algorithm.
This matrix is the base to compute the generalized partial directed coherence
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mBTS_Af_mat(xM, responseindex, pmax, freqs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mBTS_Af_mat_+3A_xm">xM</code></td>
<td>
<p>the matrix of K time series (variables in columns)</p>
</td></tr>
<tr><td><code id="mBTS_Af_mat_+3A_responseindex">responseindex</code></td>
<td>
<p>the index of the response variable in <code class="reqn">\{1,\ldots,K\}</code></p>
</td></tr>
<tr><td><code id="mBTS_Af_mat_+3A_pmax">pmax</code></td>
<td>
<p>maximum order(lag) of the VAR model to be considered</p>
</td></tr>
<tr><td><code id="mBTS_Af_mat_+3A_freqs">freqs</code></td>
<td>
<p>frequencies at which the spectral density is estimated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the matrix of all the Restricted Generalized Partial Directed
Coherence index across the series of a multivariate set.
</p>

<hr>
<h2 id='mBTSCGCI'>computation of the conditional Granger causality index</h2><span id='topic+mBTSCGCI'></span>

<h3>Description</h3>

<p>computation of the conditional Granger causality index
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mBTSCGCI(xM, responseindex, pmax)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mBTSCGCI_+3A_xm">xM</code></td>
<td>
<p>the matrix of K time series (variables in columns)</p>
</td></tr>
<tr><td><code id="mBTSCGCI_+3A_responseindex">responseindex</code></td>
<td>
<p>the index of the response variable in <code class="reqn">\{1,\ldots,K\}</code></p>
</td></tr>
<tr><td><code id="mBTSCGCI_+3A_pmax">pmax</code></td>
<td>
<p>maximum order(lag) of the VAR model to be considered</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the matrix of all the conditional Granger causality index across
the series of a multivariate set.
</p>


<h3>See Also</h3>

<p>Siggiridou, Elsa, and Dimitris Kugiumtzis. &quot;Granger Causality
in Multivariate Time Series Using a Time-Ordered Restricted Vector
Autoregressive Model.&quot; IEEE Transactions on Signal Processing 64,
no. 7 (April 2016): 1759-73. <a href="https://doi.org/10.1109/TSP.2015.2500893">doi:10.1109/TSP.2015.2500893</a>
</p>

<hr>
<h2 id='mBTSRGPDC'>Restricted Generalized Partial Directed Coherence</h2><span id='topic+mBTSRGPDC'></span>

<h3>Description</h3>

<p>partial directed coherence matrix values based on the mBTS algorithm
for estimation of the VAR parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mBTSRGPDC(xM, pmax, freqs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mBTSRGPDC_+3A_xm">xM</code></td>
<td>
<p>the matrix of K time series (variables in columns)</p>
</td></tr>
<tr><td><code id="mBTSRGPDC_+3A_pmax">pmax</code></td>
<td>
<p>maximum order(lag) of the VAR model to be considered</p>
</td></tr>
<tr><td><code id="mBTSRGPDC_+3A_freqs">freqs</code></td>
<td>
<p>frequencies at which the spectral density is estimated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the matrix of all the Restricted Generalized Partial Directed
Coherence index across the series of a multivariate set.
#'
</p>

<hr>
<h2 id='multilagmatrix'>multilagmatrix</h2><span id='topic+multilagmatrix'></span>

<h3>Description</h3>

<p>multilagmatrix builds the set of explanatory variables for the dynamic
regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multilagmatrix(xM, responseindex, ordersV, indexV)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multilagmatrix_+3A_xm">xM</code></td>
<td>
<p>the matrix of K time series (variables in columns)</p>
</td></tr>
<tr><td><code id="multilagmatrix_+3A_responseindex">responseindex</code></td>
<td>
<p>the index of the response variable in <code class="reqn">\{1,\ldots,K\}</code></p>
</td></tr>
<tr><td><code id="multilagmatrix_+3A_ordersv">ordersV</code></td>
<td>
<p>vector of size 1xK of the maximum order for each of the K
variables.</p>
</td></tr>
<tr><td><code id="multilagmatrix_+3A_indexv">indexV</code></td>
<td>
<p>the vector of size 1 x K<em>pmax of zeros and ones
e.g. if the component in position 2</em>pmax+3 is one, the
third variable, lag 3, X3(t-3), is selected.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the matrix of all explanatory lagged variables in the
DR model. The sequence of the lagged variables in 'lagM'
</p>


<h3>See Also</h3>

<p>Kugiumtzis, D. &quot;Direct-Coupling Information Measure from Nonuniform
Embedding.&quot; Physical Review E 87, no. 6 (June 25, 2013): 062918.
<a href="https://doi.org/10.1103/PhysRevE.87.062918">doi:10.1103/PhysRevE.87.062918</a>
</p>

<hr>
<h2 id='PMIME'>PMIME Partial mutual information from mixed embedding</h2><span id='topic+PMIME'></span>

<h3>Description</h3>

<p>computes the measure <code class="reqn">R_{X-&gt;Y|Z}</code> for all combinations of <code class="reqn">X</code> and <code class="reqn">Y</code> time
series from the multivariate time series given in matrix 'allM', of size
<code class="reqn">N x K</code>, where <code class="reqn">Z</code> contains the rest <code class="reqn">K-2</code> time series.
The components of X,Y, and Z, are found from a mixed embedding aiming at
explaining <code class="reqn">Y</code>. The mixed embedding is formed by using the progressive
embedding algorithm based on conditional mutual information (CMI).
CMI is estimated by the method of nearest neighbors (Kraskov's method).
The function is the same as PMIMEsig.m but defines the stopping criterion
differently, using a fixed rather than adjusted threshold. Specifically,
the algorithm terminates if the contribution of the selected lagged
variable in explaining the future response state is small enough, as
compared to a threshold 'A'. Concretely, the algorithm terminates if
<code class="reqn">I(x^F; w| wemb) / I(x^F; w,wemb) &lt;= A</code>
where <code class="reqn">I(x^F; w| wemb)</code> is the CMI of the selected lagged variable w and
the future response state x^F given the current mixed embedding vector,
and <code class="reqn">I(x^F; w,wemb)</code> is the MI between <code class="reqn">x^F</code> and the augmented mixed
embedding vector <code class="reqn">wemb, w</code>.
We experienced that in rare cases the termination condition is not
satisfied and the algorithm does not terminate. Therefore we included a
second condition for termination of the algorithm when the ratio
<code class="reqn">I(x^F; w| wemb) / I(x^F; w,wemb)</code> increases in the last two embedding
cycles.
The derived <code class="reqn">R</code> measure indicates the information flow of time series <code class="reqn">X</code> to
time series <code class="reqn">Y</code> conditioned on the rest time series in <code class="reqn">Z</code>. The measure
values are stored in a <code class="reqn">K x K</code> matrix 'RM' and given to the output, where
the value at position <code class="reqn">(i,j)</code> indicates the effect from <code class="reqn">i</code> to <code class="reqn">j</code> (row to
col), and the <code class="reqn">(i,i)</code> components are zero. The library RANN was used
for the nearest neighbor estimation of the mutual information
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PMIME(allM, Lmax = 5, Tl = 1, nnei = 5, A = 0.03, showtxt = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PMIME_+3A_allm">allM</code></td>
<td>
<p>the N x K matrix of the K time series of length N.</p>
</td></tr>
<tr><td><code id="PMIME_+3A_lmax">Lmax</code></td>
<td>
<p>the maximum delay to search for X and Y components for the
mixed embedding vector ,default is 5.</p>
</td></tr>
<tr><td><code id="PMIME_+3A_tl">Tl</code></td>
<td>
<p>Tl steps ahead that the mixed embedding vector has to explain.
Note that if T&gt;1 the future vector is of length T and contains the samples
at times t+1,..,t+T ,dafault is 1.</p>
</td></tr>
<tr><td><code id="PMIME_+3A_nnei">nnei</code></td>
<td>
<p>number of nearest neighbors for density estimation ,default is 5</p>
</td></tr>
<tr><td><code id="PMIME_+3A_a">A</code></td>
<td>
<p>the threshold for the ratio of CMI over MI of the lagged variables
for the termination criterion.</p>
</td></tr>
<tr><td><code id="PMIME_+3A_showtxt">showtxt</code></td>
<td>
<p>: if 0 or negative do not print out anything, if 1 print out
the response variable index at each run, if 2 or larger print also info for
each embedding cycle ,default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><em>RM</em>: A K x K matrix containing the R values computed by PMIME using
the surrogates for setting the stopping criterion.
<em>ecC</em>: cell array of K components, where each component is a matrix of
size E x 5, and E is the number of embedding cycles. For each
embedding cycle the following 5 results are stored:
1. variable index, 2. lag index, 3. CMI of the selected lagged
variable w and the future response state x^F given the current
mixed embedding vector, I(x^F; w| wemb). 4. MI between x^F and
the augmented mixed embedding vector wemb w, I(x^F; w,wemb).
5. The ration of 3. and 4.: I(x^F; w| wemb)/I(x^F; w,wemb)
</p>


<h3>See Also</h3>

<p>Kugiumtzis, D. &quot;Direct-Coupling Information Measure from Nonuniform
Embedding.&quot; Physical Review E 87, no. 6 (June 25, 2013): 062918.
<a href="https://doi.org/10.1103/PhysRevE.87.062918">doi:10.1103/PhysRevE.87.062918</a>
</p>

<hr>
<h2 id='sqnorms'>Quadratic multiplication of a matrix M with respect to a matrix A:
Conj(M)  A M, where Conj() is the complex conjugate function</h2><span id='topic+sqnorms'></span>

<h3>Description</h3>

<p>Quadratic multiplication of a matrix M with respect to a matrix A:
Conj(M)  A M, where Conj() is the complex conjugate function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sqnorms(M, A)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sqnorms_+3A_m">M</code></td>
<td>
<p>A Matrix of dimension P by P</p>
</td></tr>
<tr><td><code id="sqnorms_+3A_a">A</code></td>
<td>
<p>A squared Matrix of dimension P by P</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The squared root of the absolute values of the matrix result of the
operation Conj(M) A M
</p>


<h3>Examples</h3>

<pre><code class='language-R'>M=matrix( rnorm(100), ncol=10  )
A=matrix( rnorm(100), ncol=10  )
sqnorms(M, A)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
