<!DOCTYPE html><html lang="en"><head><title>Help for package GenHMM1d</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GenHMM1d}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#alpha2theta'><p>Transformation of unconstrained parameters to constrained  parameters</p></a></li>
<li><a href='#bfun'><p>Bootstrap for the univariate distributions</p></a></li>
<li><a href='#CDF'><p>Cumulative distribution function</p></a></li>
<li><a href='#CDF_est'><p>Cumulative distribution function</p></a></li>
<li><a href='#distributions'><p>The names and descriptions of the univariate distributions</p></a></li>
<li><a href='#ES'><p>Expected shortfall function</p></a></li>
<li><a href='#EstHMMGen'><p>Estimation of univariate hidden Markov model</p></a></li>
<li><a href='#ForecastHMMCdf'><p>Forecasted cumulative distribution function of a univariate HMM at times n+k1, n+k2,....</p></a></li>
<li><a href='#ForecastHMMeta'><p>Predicted probabilities of regimes of a univariate HMM for a new observation</p></a></li>
<li><a href='#ForecastHMMPdf'><p>Forecasted density function of a univariate HMM at time n+k1, n+k2, ...</p></a></li>
<li><a href='#ForecastHMMVAR'><p>Value at risk (VAR) of a univariate HMM at time n+k1, n+k2, ...</p></a></li>
<li><a href='#GofHMMGen'><p>Goodness-of-fit of univariate hidden Markov model</p></a></li>
<li><a href='#graphEstim'><p>Graphs</p></a></li>
<li><a href='#GridSearchS0'><p>Gridsearch</p></a></li>
<li><a href='#PDF'><p>Probability density function</p></a></li>
<li><a href='#PDF_unc'><p>Probability density function</p></a></li>
<li><a href='#QUANTILE'><p>Quantile function</p></a></li>
<li><a href='#SimHMMGen'><p>Simulation of univariate hidden Markov model</p></a></li>
<li><a href='#SimMarkovChain'><p>Markov chain simulation</p></a></li>
<li><a href='#Snd1'><p>Cramer-von Mises statistic for the goodness-of-fit test of the null hypothesis of a univariate uniform distribution over [0,1]</p></a></li>
<li><a href='#theta2alpha'><p>Transform constrained parameters to unconstrained parameters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Goodness-of-Fit for Zero-Inflated Univariate Hidden Markov
Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Inference, goodness-of-fit tests, and predictions for continuous and discrete univariate  Hidden Markov Models (HMM), including zero-inflated distributions. The goodness-of-fit test is based on a Cramer-von Mises statistic and uses parametric bootstrap to estimate the p-value. The description of the methodology is taken from Nasri et al (2020) &lt;<a href="https://doi.org/10.1029%2F2019WR025122">doi:10.1029/2019WR025122</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bouchra R. Nasri &lt;bouchra.nasri@umontreal.ca&gt;</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), doParallel, parallel, foreach</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, stats, matrixcalc, reshape2, rmutil, VaRES, VGAM,
EnvStats, GLDEX, GeneralizedHyperbolic, actuar, extraDistr,
gamlss.dist, sgt, skewt, sn, ssdtools, stabledist</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-11 09:43:46 UTC; 49009427</td>
</tr>
<tr>
<td>Author:</td>
<td>Bouchra R. Nasri [aut, cre, cph],
  Mamadou Yamar Thioub [aut, cph],
  Bruno N. Remillard [aut, cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-13 12:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='alpha2theta'>Transformation of unconstrained parameters to constrained  parameters</h2><span id='topic+alpha2theta'></span>

<h3>Description</h3>

<p>This function computes the constrained  parameters theta of a univariate distribution, from the unconstrained parameter alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alpha2theta(family, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="alpha2theta_+3A_family">family</code></td>
<td>
<p>distribution name; run the command distributions() for help</p>
</td></tr>
<tr><td><code id="alpha2theta_+3A_alpha">alpha</code></td>
<td>
<p>unconstrained parameters of the univariate distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>theta</code></td>
<td>
<p>constrained parameters</p>
</td></tr>
</table>

<hr>
<h2 id='bfun'>Bootstrap for the univariate distributions</h2><span id='topic+bfun'></span>

<h3>Description</h3>

<p>Bootstrap for the univariate distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bfun(
  theta,
  Q,
  ZI,
  family,
  n,
  size = 0,
  max_iter = 10000,
  eps = 1e-04,
  useFest = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bfun_+3A_theta">theta</code></td>
<td>
<p>parameters</p>
</td></tr>
<tr><td><code id="bfun_+3A_q">Q</code></td>
<td>
<p>transition matrix for the regimes</p>
</td></tr>
<tr><td><code id="bfun_+3A_zi">ZI</code></td>
<td>
<p>1 if zero-inflated, 0 otherwise (default)</p>
</td></tr>
<tr><td><code id="bfun_+3A_family">family</code></td>
<td>
<p>distribution name; (run the command distributions() for help)</p>
</td></tr>
<tr><td><code id="bfun_+3A_n">n</code></td>
<td>
<p>number of simulated observations</p>
</td></tr>
<tr><td><code id="bfun_+3A_size">size</code></td>
<td>
<p>additional parameter for some discrete distributions; run the command distributions() for help</p>
</td></tr>
<tr><td><code id="bfun_+3A_max_iter">max_iter</code></td>
<td>
<p>maximum number of iterations of the EM algorithm; suggestion 10000</p>
</td></tr>
<tr><td><code id="bfun_+3A_eps">eps</code></td>
<td>
<p>precision (stopping criteria); suggestion 0.0001</p>
</td></tr>
<tr><td><code id="bfun_+3A_usefest">useFest</code></td>
<td>
<p>TRUE (default) to use the first estimated parameters as starting value for the bootstrap, FALSE otherwise</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Internal function used for the parametric bootstrap
</p>

<hr>
<h2 id='CDF'>Cumulative distribution function</h2><span id='topic+CDF'></span>

<h3>Description</h3>

<p>This function computes the cumulative distribution function (cdf) of a univariate distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CDF(family, y, param, size = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CDF_+3A_family">family</code></td>
<td>
<p>distribution name; run the function distributions() for help</p>
</td></tr>
<tr><td><code id="CDF_+3A_y">y</code></td>
<td>
<p>values at which the cdf is evaluated</p>
</td></tr>
<tr><td><code id="CDF_+3A_param">param</code></td>
<td>
<p>parameters of the distribution; (1 x p)</p>
</td></tr>
<tr><td><code id="CDF_+3A_size">size</code></td>
<td>
<p>additional parameter for some discrete distributions; run the command distributions() for help</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>f</code></td>
<td>
<p>cdf</p>
</td></tr>
</table>

<hr>
<h2 id='CDF_est'>Cumulative distribution function</h2><span id='topic+CDF_est'></span>

<h3>Description</h3>

<p>This function computes the cumulative distribution function of an univariate distribution (used) in the CVM calculation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CDF_est(family, y, param, size = 0, u_Ros = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CDF_est_+3A_family">family</code></td>
<td>
<p>distribution name; run the command distributions() for help</p>
</td></tr>
<tr><td><code id="CDF_est_+3A_y">y</code></td>
<td>
<p>observations</p>
</td></tr>
<tr><td><code id="CDF_est_+3A_param">param</code></td>
<td>
<p>parameters of the distribution</p>
</td></tr>
<tr><td><code id="CDF_est_+3A_size">size</code></td>
<td>
<p>additional parameter for some discrete distributions</p>
</td></tr>
<tr><td><code id="CDF_est_+3A_u_ros">u_Ros</code></td>
<td>
<p>used internally for the computation of the Rosenblatt transform for non continuous distributions</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>f</code></td>
<td>
<p>cdf</p>
</td></tr>
</table>

<hr>
<h2 id='distributions'>The names and descriptions of the univariate distributions</h2><span id='topic+distributions'></span>

<h3>Description</h3>

<p>This function allows the users to find the details on the available distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distributions()
</code></pre>


<h3>Value</h3>

<p>No returned value, allows the users to know the different distributions and parameters
</p>

<hr>
<h2 id='ES'>Expected shortfall function</h2><span id='topic+ES'></span>

<h3>Description</h3>

<p>This function computes the expected shortfall of an univariate distribution, excluding zero-inflated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ES(p, param, family, size = 0, Nsim = 25000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ES_+3A_p">p</code></td>
<td>
<p>value (1  x 1) at which the expected shortfall needs to be computed; between 0 and 1; (e.g 0.01, 0.05)</p>
</td></tr>
<tr><td><code id="ES_+3A_param">param</code></td>
<td>
<p>parameters of the distribution; (1 x p)</p>
</td></tr>
<tr><td><code id="ES_+3A_family">family</code></td>
<td>
<p>distribution name; run the function distributions() for help</p>
</td></tr>
<tr><td><code id="ES_+3A_size">size</code></td>
<td>
<p>additional parameter for some discrete distributions; run the command distributions() for help</p>
</td></tr>
<tr><td><code id="ES_+3A_nsim">Nsim</code></td>
<td>
<p>number of simulations</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>es</code></td>
<td>
<p>expected shortfall</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>family = "gaussian"

theta = c(-1.5, 1.7) ;
es = ES( 0.01, theta, family)
print('Expected shortfall : ')
print(es$es)


</code></pre>

<hr>
<h2 id='EstHMMGen'>Estimation of univariate hidden Markov model</h2><span id='topic+EstHMMGen'></span>

<h3>Description</h3>

<p>This function estimates the parameters from a univariate hidden Markov model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EstHMMGen(
  y,
  ZI = 0,
  reg,
  family,
  start = 0,
  max_iter = 10000,
  eps = 1e-04,
  size = 0,
  theta0 = NULL,
  graph = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EstHMMGen_+3A_y">y</code></td>
<td>
<p>observations; (n x 1)</p>
</td></tr>
<tr><td><code id="EstHMMGen_+3A_zi">ZI</code></td>
<td>
<p>1 if zero-inflated, 0 otherwise (default)</p>
</td></tr>
<tr><td><code id="EstHMMGen_+3A_reg">reg</code></td>
<td>
<p>number of regimes (including zero-inflated; must be &gt; ZI)</p>
</td></tr>
<tr><td><code id="EstHMMGen_+3A_family">family</code></td>
<td>
<p>distribution name; run the function distributions() for help</p>
</td></tr>
<tr><td><code id="EstHMMGen_+3A_start">start</code></td>
<td>
<p>starting parameters for the estimation; (1 x p)</p>
</td></tr>
<tr><td><code id="EstHMMGen_+3A_max_iter">max_iter</code></td>
<td>
<p>maximum number of iterations of the EM algorithm; suggestion 10000</p>
</td></tr>
<tr><td><code id="EstHMMGen_+3A_eps">eps</code></td>
<td>
<p>precision (stopping criteria); suggestion 0.001.</p>
</td></tr>
<tr><td><code id="EstHMMGen_+3A_size">size</code></td>
<td>
<p>additional parameter for some discrete distributions; run the command distributions() for help</p>
</td></tr>
<tr><td><code id="EstHMMGen_+3A_theta0">theta0</code></td>
<td>
<p>initial parameters for each regimes; (r x p), default is NULL</p>
</td></tr>
<tr><td><code id="EstHMMGen_+3A_graph">graph</code></td>
<td>
<p>TRUE a graph, FALSE otherwise (default); only for continuous distributions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>#############################################################################
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>theta</code></td>
<td>
<p> estimated parameters; (r x p)</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>estimated transition matrix for the regimes; (r x r)</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>
<p>conditional probabilities of being in regime k at time t given observations up to time t; (n x r) </p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>conditional probabilities of being in regime k at time t given all observations; (n x r)</p>
</td></tr>
<tr><td><code>U</code></td>
<td>
<p>matrix of Rosenblatt transforms; (n x r)</p>
</td></tr>
<tr><td><code>cvm</code></td>
<td>
<p>cramer-von-Mises statistic for goodness-of-fit</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>pseudo-observations that should be uniformly distributed under the null hypothesis</p>
</td></tr>
<tr><td><code>LL</code></td>
<td>
<p>log-likelihood</p>
</td></tr>
<tr><td><code>nu</code></td>
<td>
<p>stationary distribution</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike information criterion</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian information criterion</p>
</td></tr>
<tr><td><code>CAIC</code></td>
<td>
<p>consistent Akaike information criterion</p>
</td></tr>
<tr><td><code>AICcorrected</code></td>
<td>
<p>Akaike information criterion corrected</p>
</td></tr>
<tr><td><code>HQC</code></td>
<td>
<p>Hannan-Quinn information criterion</p>
</td></tr>
<tr><td><code>stats</code></td>
<td>
<p>empirical means and standard deviation of each regimes using lambda</p>
</td></tr>
<tr><td><code>pred_l</code></td>
<td>
<p>estimated regime using lambda</p>
</td></tr>
<tr><td><code>pred_e</code></td>
<td>
<p>estimated regime using eta</p>
</td></tr>
<tr><td><code>runs_l</code></td>
<td>
<p>estimated number of runs using lambda</p>
</td></tr>
<tr><td><code>runs_e</code></td>
<td>
<p>estimated number of runs using eta</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>family = "gaussian"
Q = matrix(c(0.8, 0.3, 0.2, 0.7), 2, 2) ;
theta = matrix(c(-1.5, 1.7, 1, 1),2,2) ;
y = SimHMMGen(theta, Q=Q, family=family,  n=100)$SimData
est = EstHMMGen(y, reg=2, family=family)






</code></pre>

<hr>
<h2 id='ForecastHMMCdf'>Forecasted cumulative distribution function of a univariate HMM at times n+k1, n+k2,....</h2><span id='topic+ForecastHMMCdf'></span>

<h3>Description</h3>

<p>This function computes the forecasted cumulative distribution function of a univariate HMM for multiple horizons, given observations up to time n
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ForecastHMMCdf(
  x,
  ZI = 0,
  family,
  theta,
  Q,
  eta,
  size = 0,
  k = 1,
  graph = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ForecastHMMCdf_+3A_x">x</code></td>
<td>
<p>points at which the cdf function is computed</p>
</td></tr>
<tr><td><code id="ForecastHMMCdf_+3A_zi">ZI</code></td>
<td>
<p>1 if zero-inflated, 0 otherwise (default)</p>
</td></tr>
<tr><td><code id="ForecastHMMCdf_+3A_family">family</code></td>
<td>
<p>distribution name; run the function distributions() for help</p>
</td></tr>
<tr><td><code id="ForecastHMMCdf_+3A_theta">theta</code></td>
<td>
<p>parameters; (r  x p)</p>
</td></tr>
<tr><td><code id="ForecastHMMCdf_+3A_q">Q</code></td>
<td>
<p>probability transition matrix for the regimes; (r  x r)</p>
</td></tr>
<tr><td><code id="ForecastHMMCdf_+3A_eta">eta</code></td>
<td>
<p>vector of the estimated probability of each regime at time n; (1 x r)</p>
</td></tr>
<tr><td><code id="ForecastHMMCdf_+3A_size">size</code></td>
<td>
<p>additional parameter for some discrete distributions; run the command distributions() for help</p>
</td></tr>
<tr><td><code id="ForecastHMMCdf_+3A_k">k</code></td>
<td>
<p>prediction times</p>
</td></tr>
<tr><td><code id="ForecastHMMCdf_+3A_graph">graph</code></td>
<td>
<p>TRUE to produce plots (FALSE by default).</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>cdf</code></td>
<td>
<p>values of the cdf function</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>family = "gaussian"
theta = matrix(c(-1.5, 1.7, 1, 1),2,2)
Q = matrix(c(0.8, 0.3, 0.2, 0.7), 2, 2)
eta = c(0.96, 0.04)
x=seq(from=-6, to=6, by=0.1)
k=c(1,5,10,20)
cdf = ForecastHMMCdf(x, 0, family, theta, Q, eta, size=0, k, graph=TRUE)


</code></pre>

<hr>
<h2 id='ForecastHMMeta'>Predicted probabilities of regimes of a univariate HMM for a new observation</h2><span id='topic+ForecastHMMeta'></span>

<h3>Description</h3>

<p>This function computes the predicted probabilities of the regimes for a new observation of a univariate HMM, given observations up to time n
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ForecastHMMeta(ynew, ZI = 0, family, theta, Q, eta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ForecastHMMeta_+3A_ynew">ynew</code></td>
<td>
<p>new observations</p>
</td></tr>
<tr><td><code id="ForecastHMMeta_+3A_zi">ZI</code></td>
<td>
<p>1 if zero-inflated, 0 otherwise (default)</p>
</td></tr>
<tr><td><code id="ForecastHMMeta_+3A_family">family</code></td>
<td>
<p>distribution name; run the function distributions() for help</p>
</td></tr>
<tr><td><code id="ForecastHMMeta_+3A_theta">theta</code></td>
<td>
<p>parameters; (r  x p)</p>
</td></tr>
<tr><td><code id="ForecastHMMeta_+3A_q">Q</code></td>
<td>
<p>probability transition  matrix for the regimes; (r  x r)</p>
</td></tr>
<tr><td><code id="ForecastHMMeta_+3A_eta">eta</code></td>
<td>
<p>vector of the estimated probability of each regime at time n; (1  x r)</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>etanew</code></td>
<td>
<p>predicted probabilities of the regimes</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>family = "gaussian"
theta = matrix(c(-1.5, 1.7, 1, 1),2,2)
Q = matrix(c(0.8, 0.3, 0.2, 0.7), 2, 2)
eta = c(0.96, 0.04)
ForecastHMMeta(1.5, 0, family, theta, Q, eta)

</code></pre>

<hr>
<h2 id='ForecastHMMPdf'>Forecasted density function of a univariate HMM at time n+k1, n+k2, ...</h2><span id='topic+ForecastHMMPdf'></span>

<h3>Description</h3>

<p>This function computes the probability forecasted density function (with respect to Dirac(0)+Lesbesgue) of a univariate HMM for multiple horizons, given observations up to time n
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ForecastHMMPdf(
  y,
  ZI = 0,
  family,
  theta,
  Q,
  eta,
  size = 0,
  k = 1,
  graph = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ForecastHMMPdf_+3A_y">y</code></td>
<td>
<p>points at which the pdf function is computed</p>
</td></tr>
<tr><td><code id="ForecastHMMPdf_+3A_zi">ZI</code></td>
<td>
<p>1 if zero-inflated, 0 otherwise (default)</p>
</td></tr>
<tr><td><code id="ForecastHMMPdf_+3A_family">family</code></td>
<td>
<p>distribution name; run the function distributions() for help</p>
</td></tr>
<tr><td><code id="ForecastHMMPdf_+3A_theta">theta</code></td>
<td>
<p>parameters; (r  x p)</p>
</td></tr>
<tr><td><code id="ForecastHMMPdf_+3A_q">Q</code></td>
<td>
<p>probability transition  matrix for the regimes; (r  x r)</p>
</td></tr>
<tr><td><code id="ForecastHMMPdf_+3A_eta">eta</code></td>
<td>
<p>vector of the estimated probability of each regime at time n; (1  x r)</p>
</td></tr>
<tr><td><code id="ForecastHMMPdf_+3A_size">size</code></td>
<td>
<p>additional parameter for some discrete distributions; run the command distributions() for help</p>
</td></tr>
<tr><td><code id="ForecastHMMPdf_+3A_k">k</code></td>
<td>
<p>prediction times (may be a vector of integers)</p>
</td></tr>
<tr><td><code id="ForecastHMMPdf_+3A_graph">graph</code></td>
<td>
<p>TRUE to produce plots (FALSE is default)</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>pdf</code></td>
<td>
<p>values of the pdf function</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>family = "gaussian"
theta = matrix(c(-1.5, 1.7, 1, 1),2,2)
Q = matrix(c(0.8, 0.3, 0.2, 0.7), 2, 2)
eta = c(0.06, 0.94)
x=seq(from=-6, to=6, by=0.1)
k=c(1,5,10,20)
pdf = ForecastHMMPdf(x, 1, family, theta, Q, eta, k=k, graph=TRUE)


</code></pre>

<hr>
<h2 id='ForecastHMMVAR'>Value at risk (VAR) of a univariate HMM at time n+k1, n+k2, ...</h2><span id='topic+ForecastHMMVAR'></span>

<h3>Description</h3>

<p>This function computes the VAR of a univariate HMM for multiple horizons, given observations up to time n
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ForecastHMMVAR(U, ZI = 0, family, theta, Q, eta, k = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ForecastHMMVAR_+3A_u">U</code></td>
<td>
<p>values (n  x 1) between 0 and 1</p>
</td></tr>
<tr><td><code id="ForecastHMMVAR_+3A_zi">ZI</code></td>
<td>
<p>1 if zero-inflated, 0 otherwise (default)</p>
</td></tr>
<tr><td><code id="ForecastHMMVAR_+3A_family">family</code></td>
<td>
<p>distribution name; run the function distributions() for help</p>
</td></tr>
<tr><td><code id="ForecastHMMVAR_+3A_theta">theta</code></td>
<td>
<p>parameters; (r  x p)</p>
</td></tr>
<tr><td><code id="ForecastHMMVAR_+3A_q">Q</code></td>
<td>
<p>probability transition  matrix for the regimes; (r  x r)</p>
</td></tr>
<tr><td><code id="ForecastHMMVAR_+3A_eta">eta</code></td>
<td>
<p>vector of the estimated probability of each regime at time n; (1  x r)</p>
</td></tr>
<tr><td><code id="ForecastHMMVAR_+3A_k">k</code></td>
<td>
<p>prediction times (may be a vector of integers).</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>var</code></td>
<td>
<p>values at risk (1 x horizon)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
family = "gaussian"
theta = matrix(c(-1.5, 1.7, 1, 1),2,2)
Q = matrix(c(0.8, 0.3, 0.2, 0.7), 2, 2)
eta = c(0.96, 0.04)
U=c(0.01,0.05)
k=c(1,2,3,4,5)
ForecastHMMVAR(U, 0, family, theta, Q, eta=eta,k)




</code></pre>

<hr>
<h2 id='GofHMMGen'>Goodness-of-fit of univariate hidden Markov model</h2><span id='topic+GofHMMGen'></span>

<h3>Description</h3>

<p>This function performs a goodness-of-fit test for a univariate hidden Markov model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GofHMMGen(
  y,
  ZI = 0,
  reg,
  family,
  start = 0,
  max_iter = 10000,
  eps = 1e-04,
  size = 0,
  n_samples = 1000,
  n_cores = 1,
  useFest = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GofHMMGen_+3A_y">y</code></td>
<td>
<p>observations</p>
</td></tr>
<tr><td><code id="GofHMMGen_+3A_zi">ZI</code></td>
<td>
<p>1 if zero-inflated, 0 otherwise (default)</p>
</td></tr>
<tr><td><code id="GofHMMGen_+3A_reg">reg</code></td>
<td>
<p>number of regimes</p>
</td></tr>
<tr><td><code id="GofHMMGen_+3A_family">family</code></td>
<td>
<p>distribution name; run the function distributions() for help</p>
</td></tr>
<tr><td><code id="GofHMMGen_+3A_start">start</code></td>
<td>
<p>starting parameter for the estimation</p>
</td></tr>
<tr><td><code id="GofHMMGen_+3A_max_iter">max_iter</code></td>
<td>
<p>maximum number of iterations of the EM algorithm; suggestion 10000</p>
</td></tr>
<tr><td><code id="GofHMMGen_+3A_eps">eps</code></td>
<td>
<p>precision (stopping criteria); suggestion 0.0001.</p>
</td></tr>
<tr><td><code id="GofHMMGen_+3A_size">size</code></td>
<td>
<p>additional parameter for some discrete distributions; run the command distributions() for help</p>
</td></tr>
<tr><td><code id="GofHMMGen_+3A_n_samples">n_samples</code></td>
<td>
<p>number of bootstrap samples; suggestion 1000</p>
</td></tr>
<tr><td><code id="GofHMMGen_+3A_n_cores">n_cores</code></td>
<td>
<p>number of cores to use in the parallel computing</p>
</td></tr>
<tr><td><code id="GofHMMGen_+3A_usefest">useFest</code></td>
<td>
<p>TRUE (default) to use the first estimated parameters as starting value for the bootstrap, FALSE otherwise</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>pvalue</code></td>
<td>
<p>pvalue of the Cramer-von Mises statistic in percent</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>Estimated parameters; (r x p) </p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>estimated transition matrix; ; (r x r)</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>
<p>(conditional probabilities of being in regime k at time t given observations up to time t; (n x r)</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>conditional probabilities of being in regime k at time t given all observations; (n x r)</p>
</td></tr>
<tr><td><code>U</code></td>
<td>
<p>matrix of Rosenblatt transforms; (n x r)</p>
</td></tr>
<tr><td><code>cvm</code></td>
<td>
<p>Cramer-von-Mises statistic for goodness-of-fit</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>pseudo-observations that should be uniformly distributed under the null hypothesis</p>
</td></tr>
<tr><td><code>LL</code></td>
<td>
<p>log-likelihood</p>
</td></tr>
<tr><td><code>nu</code></td>
<td>
<p>stationary distribution</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike information criterion</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>bayesian information criterion</p>
</td></tr>
<tr><td><code>CAIC</code></td>
<td>
<p>consistent Akaike information criterion</p>
</td></tr>
<tr><td><code>AICcorrected</code></td>
<td>
<p>Akaike information criterion corrected</p>
</td></tr>
<tr><td><code>HQC</code></td>
<td>
<p>Hannan-Quinn information criterion</p>
</td></tr>
<tr><td><code>stats</code></td>
<td>
<p>Empirical means and standard deviation of each regimes using lambda</p>
</td></tr>
<tr><td><code>pred_l</code></td>
<td>
<p>Estimated regime using lambda</p>
</td></tr>
<tr><td><code>pred_e</code></td>
<td>
<p>Estimated regime using eta</p>
</td></tr>
<tr><td><code>runs_l</code></td>
<td>
<p>Estimated number of runs using lambda</p>
</td></tr>
<tr><td><code>runs_e</code></td>
<td>
<p>Estimated number of runs using eta</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>family = "gaussian"
Q = matrix(c(0.8, 0.3, 0.2, 0.7), 2, 2) ; theta = matrix(c(0, 1.7, 0, 1),2,2) ;
y = SimHMMGen(theta, size=0, Q, ZI=1, family,  100)$SimData
out=GofHMMGen(y,1,2,family,n_samples=10)


</code></pre>

<hr>
<h2 id='graphEstim'>Graphs</h2><span id='topic+graphEstim'></span>

<h3>Description</h3>

<p>This function shows the graphs resulting from the estimation of a HMM model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graphEstim(y, ZI = 0, reg, theta, family, pred_l, pred_e)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="graphEstim_+3A_y">y</code></td>
<td>
<p>observations</p>
</td></tr>
<tr><td><code id="graphEstim_+3A_zi">ZI</code></td>
<td>
<p>1 if zero-inflated, 0 otherwise (default)</p>
</td></tr>
<tr><td><code id="graphEstim_+3A_reg">reg</code></td>
<td>
<p>number of regimes</p>
</td></tr>
<tr><td><code id="graphEstim_+3A_theta">theta</code></td>
<td>
<p>estimated parameters; (r x p)</p>
</td></tr>
<tr><td><code id="graphEstim_+3A_family">family</code></td>
<td>
<p>distribution name; run the function distributions() for help</p>
</td></tr>
<tr><td><code id="graphEstim_+3A_pred_l">pred_l</code></td>
<td>
<p>estimated regime using lambda</p>
</td></tr>
<tr><td><code id="graphEstim_+3A_pred_e">pred_e</code></td>
<td>
<p>estimated regime using eta</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No returned value; produces figures of interest for the HMM model
</p>

<hr>
<h2 id='GridSearchS0'>Gridsearch</h2><span id='topic+GridSearchS0'></span>

<h3>Description</h3>

<p>This function performs a gridsearch to find a good starting value for the EM algorithm. A good starting value for the EM algorithm is one for which all observations have strictly positive density (the higher the better)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GridSearchS0(family, y, params, size = 0, lbpdf = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GridSearchS0_+3A_family">family</code></td>
<td>
<p>distribution name; run the function distributions() for help</p>
</td></tr>
<tr><td><code id="GridSearchS0_+3A_y">y</code></td>
<td>
<p>observations</p>
</td></tr>
<tr><td><code id="GridSearchS0_+3A_params">params</code></td>
<td>
<p>list of six vectors named (p1, p2, p3, p4, p5, p6). Each corresponding to a parameter of the distribution (additionnal parameters will be ignored).
For example : params = list(p1=c(0.5, 5, 0.5), p2=c(1, 5, 1), p3=c(0.1, 0.9, 0.1), p4=c(1,1,1), p5=c(1,1,1), p6=c(1,1,1)) where p1 is the grid of value for the first parameter.</p>
</td></tr>
<tr><td><code id="GridSearchS0_+3A_size">size</code></td>
<td>
<p>additional parameter for some discrete distributions; run the command distributions() for help</p>
</td></tr>
<tr><td><code id="GridSearchS0_+3A_lbpdf">lbpdf</code></td>
<td>
<p>minimal acceptable value of the density; (should be &gt;= 0)</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>goodStart</code></td>
<td>
<p>accepted parameter set</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>family = "gaussian"

Q = matrix(c(0.8, 0.3, 0.2, 0.7), 2, 2) ;
theta = matrix(c(-1.5, 1.7, 1, 1),2,2) ;
sim = SimHMMGen(theta, size=0, Q, ZI=0,"gaussian", 50)$SimData ;
params = list(p1=c(-2, 2, 0.5), p2=c(1, 5, 1), p3=c(1, 1, 1), p4=c(1,1,1), p5=c(1,1,1), p6=c(1,1,1))
accepted_params = GridSearchS0(family, sim, params)


</code></pre>

<hr>
<h2 id='PDF'>Probability density function</h2><span id='topic+PDF'></span>

<h3>Description</h3>

<p>This function computes the probability density function (pdf) of a univariate distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PDF(family, y, param, size = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PDF_+3A_family">family</code></td>
<td>
<p>distribution name; run the function distributions() for help</p>
</td></tr>
<tr><td><code id="PDF_+3A_y">y</code></td>
<td>
<p>observations</p>
</td></tr>
<tr><td><code id="PDF_+3A_param">param</code></td>
<td>
<p>parameters of the distribution; (1 x p)</p>
</td></tr>
<tr><td><code id="PDF_+3A_size">size</code></td>
<td>
<p>additional parameter for some discrete distributions; run the command distributions() for help</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>f</code></td>
<td>
<p>pdf</p>
</td></tr>
</table>

<hr>
<h2 id='PDF_unc'>Probability density function</h2><span id='topic+PDF_unc'></span>

<h3>Description</h3>

<p>This function computes the probability density function of a univariate distribution with unconstrained parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PDF_unc(family, y, param, size = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PDF_unc_+3A_family">family</code></td>
<td>
<p>distribution name; run the command distributions() for help</p>
</td></tr>
<tr><td><code id="PDF_unc_+3A_y">y</code></td>
<td>
<p>observations</p>
</td></tr>
<tr><td><code id="PDF_unc_+3A_param">param</code></td>
<td>
<p>parameters of the distribution (unconstrained,  in R)</p>
</td></tr>
<tr><td><code id="PDF_unc_+3A_size">size</code></td>
<td>
<p>additional parameter for some discrete distributions</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>f</code></td>
<td>
<p>pdf</p>
</td></tr>
</table>

<hr>
<h2 id='QUANTILE'>Quantile function</h2><span id='topic+QUANTILE'></span>

<h3>Description</h3>

<p>This function computes the quantile function of a univariate distribution, excluding zero-inflated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QUANTILE(p, param, family, size = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="QUANTILE_+3A_p">p</code></td>
<td>
<p>values at which the quantile needs to be computed; between 0 and 1; (e.g 0.01, 0.05)</p>
</td></tr>
<tr><td><code id="QUANTILE_+3A_param">param</code></td>
<td>
<p>parameters of the distribution; (1 x p)</p>
</td></tr>
<tr><td><code id="QUANTILE_+3A_family">family</code></td>
<td>
<p>distribution name; run the function distributions() for help</p>
</td></tr>
<tr><td><code id="QUANTILE_+3A_size">size</code></td>
<td>
<p>additional parameter for some discrete distributions; run the command distributions() for help</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>q</code></td>
<td>
<p>quantile/VAR</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>family = "gaussian"

theta = matrix(c(-1.5, 1.7),1,2) ;
quantile = QUANTILE(0.01, theta, family)
print('Quantile : ')
print(quantile)

</code></pre>

<hr>
<h2 id='SimHMMGen'>Simulation of univariate hidden Markov model</h2><span id='topic+SimHMMGen'></span>

<h3>Description</h3>

<p>This function simulates observation from a univariate hidden Markov model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimHMMGen(theta, size = 0, Q, ZI = 0, family, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SimHMMGen_+3A_theta">theta</code></td>
<td>
<p>parameters; (r x p)</p>
</td></tr>
<tr><td><code id="SimHMMGen_+3A_size">size</code></td>
<td>
<p>additional parameter for some discrete distributions; run the command distributions() for help</p>
</td></tr>
<tr><td><code id="SimHMMGen_+3A_q">Q</code></td>
<td>
<p>transition probability matrix for regimes; (r x r)</p>
</td></tr>
<tr><td><code id="SimHMMGen_+3A_zi">ZI</code></td>
<td>
<p>1 if zero-inflated, 0 otherwise (default)</p>
</td></tr>
<tr><td><code id="SimHMMGen_+3A_family">family</code></td>
<td>
<p>distribution name; run the function distributions() for help</p>
</td></tr>
<tr><td><code id="SimHMMGen_+3A_n">n</code></td>
<td>
<p>number of simulated observations</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>SimData</code></td>
<td>
<p>Simulated data</p>
</td></tr>
<tr><td><code>MC</code></td>
<td>
<p>Simulated Markov chain</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
family = "gaussian"
Q = matrix(c(0.8, 0.3, 0.2, 0.7), 2, 2) ;
theta = matrix(c(0, 1.7, 0, 10),2,2) ;
y = SimHMMGen(theta, Q=Q, ZI=1,family=family, n=50)$SimData

</code></pre>

<hr>
<h2 id='SimMarkovChain'>Markov chain simulation</h2><span id='topic+SimMarkovChain'></span>

<h3>Description</h3>

<p>This function generates a Markov chain X(1), ..., X(n) with transition matrix Q, starting from a state eta0 or the uniform distribution on 1,..., r.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimMarkovChain(Q, n, eta0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SimMarkovChain_+3A_q">Q</code></td>
<td>
<p>transition probability matrix</p>
</td></tr>
<tr><td><code id="SimMarkovChain_+3A_n">n</code></td>
<td>
<p>number of simulated vectors</p>
</td></tr>
<tr><td><code id="SimMarkovChain_+3A_eta0">eta0</code></td>
<td>
<p>initial value in 1,...,r.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>Generated Markov chain</p>
</td></tr>
</table>

<hr>
<h2 id='Snd1'>Cramer-von Mises statistic for the goodness-of-fit test of the null hypothesis of a univariate uniform distribution over [0,1]</h2><span id='topic+Snd1'></span>

<h3>Description</h3>

<p>This function computes the Cramer-von Mises statistic Sn for goodness-of-fit of the null hypothesis of a univariate uniform distrubtion over [0,1]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Snd1(U)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Snd1_+3A_u">U</code></td>
<td>
<p>vector of pseudos-observations (approximating uniform)</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>sta</code></td>
<td>
<p>Cramer-von Mises statistic</p>
</td></tr>
</table>

<hr>
<h2 id='theta2alpha'>Transform constrained parameters to unconstrained parameters</h2><span id='topic+theta2alpha'></span>

<h3>Description</h3>

<p>This function computes the unconstrained parameters alpha of a univariate distribution corresponding to constrained parameters theta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theta2alpha(family, theta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="theta2alpha_+3A_family">family</code></td>
<td>
<p>distribution name; run the command distributions() for help</p>
</td></tr>
<tr><td><code id="theta2alpha_+3A_theta">theta</code></td>
<td>
<p>constrained parameters of the univariate distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>alpha</code></td>
<td>
<p>unconstrained parameters</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
