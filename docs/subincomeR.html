<!DOCTYPE html><html lang="en-US"><head><title>Help for package subincomeR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {subincomeR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#subincomeR-package'><p>subincomeR: Access to Global Sub-National Income Data</p></a></li>
<li><a href='#getDOSE'><p>Download and load the DOSE dataset into memory</p></a></li>
<li><a href='#getDOSE_geom'><p>Download and load GADM-DOSE geometries</p></a></li>
<li><a href='#matchDOSE'><p>Match coordinates to DOSE dataset</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Access to Global Sub-National Income Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides access to granular sub-national income data from the
    MCC-PIK Database Of Sub-national Economic Output (DOSE). The package
    downloads and processes the data from its open repository on 'Zenodo'
    (<a href="https://zenodo.org/records/13773040">https://zenodo.org/records/13773040</a>). Functions are provided to
    fetch data at multiple geographic levels, match coordinates to
    administrative regions, and access associated geometries.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/pablogguz/subincomeR">https://github.com/pablogguz/subincomeR</a>,
<a href="https://pablogguz.github.io/subincomeR/">https://pablogguz.github.io/subincomeR/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/pablogguz/subincomeR/issues">https://github.com/pablogguz/subincomeR/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>countrycode, curl, dplyr, rlang, sf, tidygeocoder, utils, zip</td>
</tr>
<tr>
<td>Suggests:</td>
<td>extrafont, fixest, ggplot2, ggtext, knitr, rmarkdown,
spelling</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-16 14:06:34 UTC; pablo</td>
</tr>
<tr>
<td>Author:</td>
<td>Pablo García Guzmán [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pablo García Guzmán &lt;garciagp@ebrd.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-16 14:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='subincomeR-package'>subincomeR: Access to Global Sub-National Income Data</h2><span id='topic+subincomeR'></span><span id='topic+subincomeR-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Provides access to granular sub-national income data from the MCC-PIK Database Of Sub-national Economic Output (DOSE). The package downloads and processes the data from its open repository on 'Zenodo' (<a href="https://zenodo.org/records/13773040">https://zenodo.org/records/13773040</a>). Functions are provided to fetch data at multiple geographic levels, match coordinates to administrative regions, and access associated geometries.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Pablo García Guzmán <a href="mailto:garciagp@ebrd.com">garciagp@ebrd.com</a> [copyright holder]
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/pablogguz/subincomeR">https://github.com/pablogguz/subincomeR</a>
</p>
</li>
<li> <p><a href="https://pablogguz.github.io/subincomeR/">https://pablogguz.github.io/subincomeR/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/pablogguz/subincomeR/issues">https://github.com/pablogguz/subincomeR/issues</a>
</p>
</li></ul>


<hr>
<h2 id='getDOSE'>Download and load the DOSE dataset into memory</h2><span id='topic+getDOSE'></span>

<h3>Description</h3>

<p>This function downloads the DOSE dataset from Zenodo and loads it into memory as a dataframe.
It allows for optional filtering of the dataset based on specific years and/or countries.
The country format can be specified to ensure correct filtering. The function automatically
handles different download methods based on system capabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDOSE(
  years = NULL,
  countries = NULL,
  format_countries = "country.name",
  path = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getDOSE_+3A_years">years</code></td>
<td>
<p>Optional vector of years for which to filter the DOSE dataset.
If NULL (the default), data for all years are returned.</p>
</td></tr>
<tr><td><code id="getDOSE_+3A_countries">countries</code></td>
<td>
<p>Optional vector of countries for which to filter the DOSE dataset.
Countries can be specified in ISO2C, ISO3C, or country name format.
Use the format_countries parameter to specify the format of the countries vector.</p>
</td></tr>
<tr><td><code id="getDOSE_+3A_format_countries">format_countries</code></td>
<td>
<p>The format of the countries provided in the countries parameter.
Acceptable values are 'iso2c', 'iso3c', or 'country.name'. Default is 'country.name'.
This parameter is used only if the countries parameter is not NULL.</p>
</td></tr>
<tr><td><code id="getDOSE_+3A_path">path</code></td>
<td>
<p>Optional character string specifying where to store the downloaded data.
If NULL (default), uses tempdir().</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing the filtered DOSE dataset based on the input parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load the entire dataset
data_all &lt;- getDOSE()

# Load dataset filtered by specific years
data_2018_2019 &lt;- getDOSE(years = c(2018, 2019))

# Load dataset filtered by specific countries (using ISO3C codes)
data_usa_can &lt;- getDOSE(countries = c('USA', 'CAN'), format_countries = 'iso3c')

# Load dataset filtered by year and countries (using country names)
data_mex_2019 &lt;- getDOSE(years = 2019, countries = c('Mexico'), 
                         format_countries = 'country.name')

</code></pre>

<hr>
<h2 id='getDOSE_geom'>Download and load GADM-DOSE geometries</h2><span id='topic+getDOSE_geom'></span>

<h3>Description</h3>

<p>This function downloads and loads GADM-DOSE geometries from a remote source.
The geometries are stored in a temporary directory by default, or in a user-specified
location if provided. The uncompressed geometries file is approximately 769 MB.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDOSE_geom(path = NULL, countries = NULL, download = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getDOSE_geom_+3A_path">path</code></td>
<td>
<p>Optional character string specifying where to store the files.
If NULL (default), uses tempdir().</p>
</td></tr>
<tr><td><code id="getDOSE_geom_+3A_countries">countries</code></td>
<td>
<p>Optional vector of ISO3C country codes to filter geometries.
If NULL (default), all available geometries are returned.</p>
</td></tr>
<tr><td><code id="getDOSE_geom_+3A_download">download</code></td>
<td>
<p>Logical indicating whether to download without confirmation.
Default is FALSE, which will prompt for confirmation in interactive sessions.
Set to TRUE to skip confirmation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An sf object containing the GADM-DOSE geometries
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load all geometries with download confirmation
geom_all &lt;- getDOSE_geom()

# Load geometries with automatic download
geom_auto &lt;- getDOSE_geom(download = TRUE)

# Load geometries for specific countries
geom_subset &lt;- getDOSE_geom(
  countries = c("USA", "CAN", "MEX"),
  download = TRUE
)

</code></pre>

<hr>
<h2 id='matchDOSE'>Match coordinates to DOSE dataset</h2><span id='topic+matchDOSE'></span>

<h3>Description</h3>

<p>This function matches input coordinates (latitude and longitude) to the DOSE dataset.
It accepts either vectors of latitudes and longitudes or a dataframe containing
these coordinates. Before matching, it ensures that only unique coordinates are processed
to avoid duplicating operations on identical coordinates. It uses GADM-1 geometries
to match coordinates to regions and returns a dataframe with unique input coordinates
and matched DOSE data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matchDOSE(
  lat = NULL,
  long = NULL,
  df = NULL,
  lat_col = "lat",
  long_col = "long",
  years = NULL,
  countries = NULL,
  format_countries = "iso3c",
  path = NULL,
  download = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="matchDOSE_+3A_lat">lat</code></td>
<td>
<p>Optional vector of latitudes of the points to match. Required if no dataframe is provided.</p>
</td></tr>
<tr><td><code id="matchDOSE_+3A_long">long</code></td>
<td>
<p>Optional vector of longitudes of the points to match. Required if no dataframe is provided.</p>
</td></tr>
<tr><td><code id="matchDOSE_+3A_df">df</code></td>
<td>
<p>Optional dataframe containing coordinates and possibly additional columns. If provided,
'lat' and 'long' vectors should not be provided. The dataframe must include columns specified
by 'lat_col' and 'long_col' parameters.</p>
</td></tr>
<tr><td><code id="matchDOSE_+3A_lat_col">lat_col</code></td>
<td>
<p>Optional name of the latitude column in 'df'. Only used if 'df' is provided.
Defaults to &quot;lat&quot;.</p>
</td></tr>
<tr><td><code id="matchDOSE_+3A_long_col">long_col</code></td>
<td>
<p>Optional name of the longitude column in 'df'. Only used if 'df' is provided.
Defaults to &quot;long&quot;.</p>
</td></tr>
<tr><td><code id="matchDOSE_+3A_years">years</code></td>
<td>
<p>Optional vector of years for which to filter the DOSE dataset.
If NULL (the default), a 1:m matching is performed and data for all years are returned.</p>
</td></tr>
<tr><td><code id="matchDOSE_+3A_countries">countries</code></td>
<td>
<p>Optional vector or dataframe column name of country identifiers.
If provided, the function skips the country matching step. Can significantly reduce processing time.</p>
</td></tr>
<tr><td><code id="matchDOSE_+3A_format_countries">format_countries</code></td>
<td>
<p>Specifies the format of the country identifiers in 'countries'.
Options are &quot;country.name&quot; (default), &quot;iso3c&quot;, and &quot;iso2c&quot;. This parameter is ignored if 'countries' is NULL.</p>
</td></tr>
<tr><td><code id="matchDOSE_+3A_path">path</code></td>
<td>
<p>Optional character string specifying where to store downloaded files.
If NULL (default), uses tempdir().</p>
</td></tr>
<tr><td><code id="matchDOSE_+3A_download">download</code></td>
<td>
<p>Logical indicating whether to download without confirmation.
Default is FALSE, which will prompt for confirmation in interactive sessions.
Set to TRUE to skip confirmation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with input coordinates (and any additional input dataframe columns) and matched DOSE data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Match coordinates using vectors
matched_data &lt;- matchDOSE(lat = c(19.4326, 51.5074), 
                         long = c(-99.1332, -0.1276))

# Match coordinates using a dataframe
df &lt;- data.frame(ID = 1:2, 
                 latitude = c(19.4326, 51.5074), 
                 longitude = c(-99.1332, -0.1276))
matched_data_df &lt;- matchDOSE(df = df, 
                            lat_col = "latitude", 
                            long_col = "longitude")

# Match coordinates for a specific year
matched_data_2019 &lt;- matchDOSE(lat = c(19.4326), 
                               long = c(-99.1332), 
                               years = 2019)

# Match coordinates with known countries
matched_data_countries &lt;- matchDOSE(lat = c(19.4326, 51.5074),
                                   long = c(-99.1332, -0.1276),
                                   countries = c("MEX", "GBR"),
                                   format_countries = "iso3c")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
