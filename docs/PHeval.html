<!DOCTYPE html><html><head><title>Help for package PHeval</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PHeval}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PHeval-package'>
<p>Evaluation of the proportional hazards assumption with a standardized score process</p></a></li>
<li><a href='#plotscore'><p> Plot of the standardized score process</p></a></li>
<li><a href='#R2'><p>R2 coefficient</p></a></li>
<li><a href='#standscore'><p>Standardized Score Process</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Evaluation of the Proportional Hazards Assumption with a
Standardized Score Process</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-09-12</td>
</tr>
<tr>
<td>Author:</td>
<td>Cecile Chauvel</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cecile Chauvel &lt;chauvel.cecile@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides tools for the evaluation of the goodness of fit and the predictive capacity of the proportional hazards model.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 1.8.0), survival, graphics, splines</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-09-13 11:35:41 UTC; formation</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-09-13 11:50:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='PHeval-package'>
Evaluation of the proportional hazards assumption with a standardized score process
</h2><span id='topic+PHeval-package'></span><span id='topic+PHeval'></span>

<h3>Description</h3>

<p>This package provides tools for the evaluation of the goodness of fit and the predictive capacity of the proportional hazards model.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> PHeval</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.5.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2014-04-20</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>This package provides functions to evaluate and plot the standardized score process of OQuigley (2003). The plot of this process over the ranks of the failure times gives an indication of the validity of the proportional hazards assumption. A function to evaluate the <code class="reqn">R^2</code> coefficient of OQuigley and Flandre (1994) is provided. This coefficient is a measure of the predictive ability of the proportional hazards model.
</p>


<h3>Author(s)</h3>

<p>Cecile Chauvel &lt;cecile.chauvel@upmc.fr&gt;
</p>


<h3>References</h3>


<table>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">
	
Chauvel, C. and OQuigley, J. (2014) Tests for comparing estimated survival functions. <em>Biometrika</em> </td>
</tr>
<tr>
 <td style="text-align: left;"> <b>101</b>, 535-552. https://doi.org/10.1093/biomet/asu015 </td>
</tr>
<tr>
 <td style="text-align: left;">
Chauvel, C. and OQuigley, J. (2017) Survival model construction guided by fit and predictive strength.  </td>
</tr>
<tr>
 <td style="text-align: left;"> <em>Biometrics</em> <b>73</b>, 483-494. https://doi.org/10.1111/biom.12611 </td>
</tr>
<tr>
 <td style="text-align: left;">
OQuigley, J. (2008) <em>Proportional hazards regression</em>. Springer New-York. </td>
</tr>
<tr>
 <td style="text-align: left;">		
OQuigley J, Flandre P. (1994) Predictive capability of proportional hazards regression. <em>PNAS</em> <b>91</b>, 2310-2314. </td>
</tr>
<tr>
 <td style="text-align: left;">
			</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>library(survival)
S=standscore(futime+fustat~resid.ds+rx,data=ovarian)
plotscore(S,printCB = TRUE)
R2(futime+fustat~resid.ds+rx,data=ovarian)
</code></pre>

<hr>
<h2 id='plotscore'> Plot of the standardized score process</h2><span id='topic+plotscore'></span>

<h3>Description</h3>

<p>The function plots the standardized score process. This process is a list resulting of an appeal to the function standscore. </p>


<h3>Usage</h3>

<pre><code class='language-R'>plotscore(s, printCB = FALSE , component.num = 1:dim(s[[1]])[2], main = "" ,
 xlab = "Time", ylab = "Standardized score", ylim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotscore_+3A_s">s</code></td>
<td>
<p> A list resulting from a call to the function standscore which corresponds to the process and, possibly, its confidence bands. </p>
</td></tr>
<tr><td><code id="plotscore_+3A_printcb">printCB</code></td>
<td>
<p>Set printCB = TRUE for plotting the confidence bands. Default is printCB = FALSE.
</p>
</td></tr>
<tr><td><code id="plotscore_+3A_component.num">component.num</code></td>
<td>
<p> A vector of length lower than the number of covariates. Indicates which components of the process to plot. For example, set component.num=c(2,3) for plotting the second and third components. By default, all components are plotted.</p>
</td></tr>
<tr><td><code id="plotscore_+3A_main">main</code>, <code id="plotscore_+3A_xlab">xlab</code>, <code id="plotscore_+3A_ylab">ylab</code>, <code id="plotscore_+3A_ylim">ylim</code></td>
<td>
<p> Classical arguments for plotting. See help(plot). </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cecile Chauvel &lt;chauvel.cecile@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+standscore">standscore</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(survival)
data(ovarian)

#############################################
# Evaluation and plot of the standardized score process at parameter beta0 = 0
score1=standscore(futime+fustat~age+rx,data=ovarian)
plotscore(score1,printCB=TRUE)


#############################################
# Evaluation of the standardized score process at parameter
# beta0 = maximum partial likelihood estimator of beta
beta=coxph(Surv(futime,fustat)~age+rx,data=ovarian)$coeff
score2=standscore(futime+fustat~age+rx,data=ovarian,beta0=beta)

# Separated plots for each regression effect
par(mfrow=c(1,2))
plotscore(score2,printCB=TRUE,component.num=1,main="age")
plotscore(score2,printCB=TRUE,component.num=2,main="rx")

#############################################
# Evaluation and plot of the standardized score process at parameter beta0 = 0
# without global standardization 
score3=standscore(futime+fustat~age+rx,data=ovarian,globstan=FALSE)
plotscore(score3)	

</code></pre>

<hr>
<h2 id='R2'>R2 coefficient</h2><span id='topic+R2'></span>

<h3>Description</h3>

<p>This function calcultates the <code class="reqn">R^2</code> coefficient of OQuigley and Flandre (1994) to evaluate the predictive capacity of the proportional hazards model (or Cox model).</p>


<h3>Usage</h3>

<pre><code class='language-R'>R2(formula, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="R2_+3A_formula">formula</code></td>
<td>

<p>A formula object or character string with the time and censoring status separated by &quot;+&quot; on the left hand side and the covariates separated by &quot;+&quot; on the right. For instance, if the time name is &quot;Time&quot;, the censoring status is &quot;Status&quot; and the covariates are called &quot;Cov1&quot; and &quot;Cov2&quot;, the formula is &quot;Time+Status~Cov1+Cov2&quot;.
</p>
</td></tr>
<tr><td><code id="R2_+3A_data">data</code></td>
<td>
 
<p>A data.frame with the data. The censoring status should be 1 for failure and 0 for censoring. No missing data accepted.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p> The program does not handle ties in the data. We suggest to randomly split the ties before using the program.
</p>


<h3>Value</h3>


<ul>
<li><p> If one covariate Z is present in the model, the <code class="reqn">R^2</code> coefficient is 
</p>
<p style="text-align: center;"><code class="reqn"> R^2=1-\frac{\sum(Zi-E_b(Zi))^2}{\sum(Zi-E_0(Zi))^2}, </code>
</p>

<p>where the sums are over the failures. <code class="reqn">E_b(Zi)</code> is the expectation of <code class="reqn">Z</code> at the ith failure time under the model of parameter <code class="reqn">b</code> = the maximum partial likelihood estimator of the regression coefficient. <code class="reqn">E_0(Zi)</code> is the expectation of <code class="reqn">Z</code> under the model of parameter 0 at the ith failure time. 
</p>
</li>
<li><p> If several covariates are present in the model, the <code class="reqn">R^2</code> coefficient is evaluated as in the previous case except that the covariate Z is replaced by the prognostic index <code class="reqn">b'Z</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Cecile Chauvel</p>


<h3>References</h3>

<p>OQuigley, J. (2008) <em>Proportional hazards regression</em>. Springer New-York. Chapter 12. <br />
OQuigley J, Flandre P. (1994) Predictive capability of proportional hazards regression. <em>PNAS</em> <b>91</b>, 2310-2314. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(survival)
data(ovarian)
R2(futime+fustat~age,data=ovarian)
R2(futime+fustat~age+rx,data=ovarian)
</code></pre>

<hr>
<h2 id='standscore'>Standardized Score Process</h2><span id='topic+standscore'></span>

<h3>Description</h3>

<p>This function evaluates the standardized score process of OQuigley (2003). The process helps evaluating the goodness of fit of the proportional hazards model and visualizing the shape of time-dependent effects.</p>


<h3>Usage</h3>

<pre><code class='language-R'>standscore(formula, data, globstan = TRUE, beta0 = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="standscore_+3A_formula">formula</code></td>
<td>

<p>A formula object or character string with the time and censoring status separated by &quot;+&quot; on the left hand side and the covariates separated by &quot;+&quot; on the right. For instance, if the time name is &quot;Time&quot;, the censoring status is &quot;Status&quot; and the covariates are &quot;Cov1&quot; and &quot;Cov2&quot;, the formula is &quot;Time+Status~Cov1+Cov2&quot;.
</p>
</td></tr>
<tr><td><code id="standscore_+3A_data">data</code></td>
<td>
 
<p>A data.frame with the data. The censoring status should be 1 for failure and 0 for censoring. No missing data accepted. </p>
</td></tr> 
<tr><td><code id="standscore_+3A_globstan">globstan</code></td>
<td>

<p>With one covariate in the model, globstan has no effect. With several covariates, 
</p>
 
<ul>
<li><p> if globstan = TRUE (default) a global standardization by the matrix Sigma is applied to the process. Sigma is the estimator of the variance-covariance matrix between the covariates to the power of - 1 / 2. With this sandardization, each component of the process represents the cumulative regression effect of each covariates.
</p>
</li>
<li><p> if globstan = FALSE, no standardization is applied. In this case, the components of the process are dependent and do not reflect the shapes of the cumulative effects. The confidence bands are not given. The use of globstan = FALSE is aimed at performing tests of the value of the regression coefficients (null hypothesis : regression parameter = beta0).
</p>
</li></ul>
</td></tr>
<tr><td><code id="standscore_+3A_beta0">beta0</code></td>
<td>

<p>a vector of parameters to evaluate the process (by default, parameters set to 0). Its length is the number of covariates. Each value corresponds to the regression coefficient for a covariate, in the same order as appearing in formula. 
</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The program does not handle ties in the data. We suggest to randomly split the ties before using the program.</p>


<h3>Value</h3>

<table>
<tr><td><code>Score</code></td>
<td>
<p>A vector or matrix with the value of the standardized score process. Each row corresponds to a failure time, each column to a covariate.
</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>The matrix used for the standardization of the process. Sigma is the estimator of the variance-covariance matrix between the coviates to the power of - 1 / 2. This value is present only with multiple covariates and globstan = TRUE.
</p>
</td></tr>
<tr><td><code>confbandCOV</code></td>
<td>
<p>A matrix with the confidence bands of the process for a constant regression effect associated with the covariate named COV. Each row corresponds to a failure time. The first column is the lower band and the second column is the upper band. This value is present with one covariate or with multiple covariates and globstan = TRUE.  </p>
</td></tr>	
</table>


<h3>Author(s)</h3>

<p>Cecile Chauvel &lt;chauvel.cecile@gmail.com&gt;
</p>


<h3>References</h3>

	

<table>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">

Chauvel, C. and OQuigley, J. (2014) Tests for comparing estimated survival functions. <em>Biometrika</em> </td>
</tr>
<tr>
 <td style="text-align: left;"> <b>101</b>, 535-552. https://doi.org/10.1093/biomet/asu015 </td>
</tr>
<tr>
 <td style="text-align: left;">
Chauvel, C. and OQuigley, J. (2017) Survival model construction guided by fit and predictive strength. </td>
</tr>
<tr>
 <td style="text-align: left;"> <em>Biometrics</em> <b>73</b>, 483-494. https://doi.org/10.1111/biom.12611 </td>
</tr>
<tr>
 <td style="text-align: left;">
OQuigley, J. (2008) <em>Proportional hazards regression</em>. Springer New-York. Chapter 8. </td>
</tr>
<tr>
 <td style="text-align: left;">	
				</td>
</tr>

</table>



<h3>See Also</h3>

<p><code><a href="#topic+plotscore">plotscore</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(survival)
data(ovarian)

#############################################
# Evaluation and plot of the standardized score process at parameter beta0 = 0

score1=standscore(futime+fustat~age+rx,data=ovarian)
plotscore(score1,printCB=TRUE)


#############################################
# Evaluation of the standardized score process at parameter
# beta0 = maximum partial likelihood estimator of beta

beta=coxph(Surv(futime,fustat)~age+rx,data=ovarian)$coeff
score2=standscore(futime+fustat~age+rx,data=ovarian,beta0=beta)

# Separated plots for each regression effect

par(mfrow=c(1,2))
plotscore(score2,printCB=TRUE,component.num=1,main="age")
plotscore(score2,printCB=TRUE,component.num=2,main="rx")

#############################################
# Evaluation and plot of the standardized score process at parameter beta0 = 0
# without global standardization 

fo="futime+fustat~age+rx"
score3=standscore(fo,data=ovarian,globstan=FALSE)
plotscore(score3)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
