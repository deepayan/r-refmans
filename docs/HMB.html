<!DOCTYPE html><html lang="en"><head><title>Help for package HMB</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {HMB}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#getSpec'><p>Method getSpec</p></a></li>
<li><a href='#ghmb'><p>Generalized Hierarchical Model-Based estimation method</p></a></li>
<li><a href='#gtsmb'><p>Generalized Two-Staged Model-Based estmation</p></a></li>
<li><a href='#hmb'><p>Hierarchical Model-Based estmation</p></a></li>
<li><a href='#HMB_data'>
<p>Sample Data for HMB package</p></a></li>
<li><a href='#HMB-class'><p>Class HMB</p></a></li>
<li><a href='#show'><p>Method show</p></a></li>
<li><a href='#summary'><p>Method summary</p></a></li>
<li><a href='#SummaryHMB-class'><p>Class SummaryHMB</p></a></li>
<li><a href='#tsmb'><p>Two-staged Model-Based estmation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Hierarchical Model-Based Estimation Approach</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-05-06</td>
</tr>
<tr>
<td>Description:</td>
<td>For estimation of a variable of interest using two sources of auxiliary information available in a nested structure. For reference see Saarela et al. (2016)&lt;<a href="https://doi.org/10.1007%2Fs13595-016-0590-1">doi:10.1007/s13595-016-0590-1</a>&gt; and Saarela et al. (2018) &lt;<a href="https://doi.org/10.3390%2Frs10111832">doi:10.3390/rs10111832</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.16)</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods, stats, R (&ge; 3.5)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Collate:</td>
<td>RcppExports.R helper_functions.R HMB-class.R
SummaryHMB-class.R ghmb.R gtsmb.R hmb.R tsmb.R</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-05-06 06:36:16 UTC; svla0001</td>
</tr>
<tr>
<td>Author:</td>
<td>Svetlana Saarela [cre, aut],
  Sören Holm [aut],
  Zhiqiang Yang [aut],
  Wilmer Prentius [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Svetlana Saarela &lt;admin@svetlanasaarela.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-05-06 07:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='getSpec'>Method getSpec</h2><span id='topic+getSpec'></span><span id='topic+getSpec+2CHMB-method'></span>

<h3>Description</h3>

<p>Get model specifications of HMB-class object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSpec(obj)

## S4 method for signature 'HMB'
getSpec(obj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSpec_+3A_obj">obj</code></td>
<td>
<p>Object of class HMB</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the estimated parameters, together with model arguments
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pop_U  = sample(nrow(HMB_data), 20000)
pop_Sa = sample(pop_U, 5000)
pop_S  = sample(pop_U, 300)

y_S    = HMB_data[pop_S, "GSV"]
X_S    = HMB_data[pop_S, c("hMAX", "h80", "CRR", "pVeg")]
X_Sa   = HMB_data[pop_Sa, c("hMAX", "h80", "CRR", "pVeg")]
Z_Sa   = HMB_data[pop_Sa, c("B20", "B30", "B50")]
Z_U    = HMB_data[pop_U, c("B20", "B30", "B50")]

hmb_model = hmb(y_S, X_S, X_Sa, Z_Sa, Z_U)
getSpec(hmb_model)
</code></pre>

<hr>
<h2 id='ghmb'>Generalized Hierarchical Model-Based estimation method</h2><span id='topic+ghmb'></span>

<h3>Description</h3>

<p>Generalized Hierarchical Model-Based estimation method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ghmb(y_S, X_S, X_Sa, Z_Sa, Z_U, Omega_S, Sigma_Sa)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ghmb_+3A_y_s">y_S</code></td>
<td>
<p>Response object that can be coerced into a column vector. The
<code>_S</code> denotes that <code>y</code> is part of the sample <em>S</em>, with
<code class="reqn">N_S \le N_{Sa} \le N_U</code>.</p>
</td></tr>
<tr><td><code id="ghmb_+3A_x_s">X_S</code></td>
<td>
<p>Object of predictors variables that can be coerced into a matrix.
The rows of <code>X_S</code> correspond to the rows of <code>y_S</code>.</p>
</td></tr>
<tr><td><code id="ghmb_+3A_x_sa">X_Sa</code></td>
<td>
<p>Object of predictor variables that can be coerced into a matrix.
The set <em>Sa</em> is the intermediate sample.</p>
</td></tr>
<tr><td><code id="ghmb_+3A_z_sa">Z_Sa</code></td>
<td>
<p>Object of predictor variables that can be coerced into a matrix.
The set <em>Sa</em> is the intermediate sample, and the Z-variables often some
sort of auxilairy, inexpensive data. The rows of <code>Z_Sa</code> correspond to
the rows of <code>X_Sa</code></p>
</td></tr>
<tr><td><code id="ghmb_+3A_z_u">Z_U</code></td>
<td>
<p>Object of predictor variables that can be coerced into a matrix.
The set <em>U</em> is the universal population sample.</p>
</td></tr>
<tr><td><code id="ghmb_+3A_omega_s">Omega_S</code></td>
<td>
<p>The covariance structure of <code class="reqn">\boldsymbol{\epsilon}_{S}</code>, up to a constant.</p>
</td></tr>
<tr><td><code id="ghmb_+3A_sigma_sa">Sigma_Sa</code></td>
<td>
<p>The covariance structure of <code class="reqn">\boldsymbol{u}_{Sa}</code>, up to a constant.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The GHMB assumes two models
</p>
<p style="text-align: center;"><code class="reqn">y = \boldsymbol{x} \boldsymbol{\beta} + \epsilon</code>
</p>

<p style="text-align: center;"><code class="reqn">\boldsymbol{x} \boldsymbol{\beta} = \boldsymbol{z} \boldsymbol{\alpha} + \boldsymbol{u}</code>
</p>

<p style="text-align: center;"><code class="reqn">\epsilon \perp u</code>
</p>

<p>For a sample from the superpopulation, the GHMB assumes
</p>
<p style="text-align: center;"><code class="reqn">E(\boldsymbol{\epsilon}) = \mathbf{0},
      E(\boldsymbol{\epsilon} \boldsymbol{\epsilon}^T) = \omega^2 \boldsymbol{\Omega}</code>
</p>

<p style="text-align: center;"><code class="reqn">E(\boldsymbol{u}) = \mathbf{0},
      E(\boldsymbol{u} \boldsymbol{u}^T) = \sigma^2 \boldsymbol{\Sigma}</code>
</p>



<h3>Value</h3>

<p>A fitted object of class HMB.
</p>


<h3>References</h3>

<p>Saarela, S., Holm, S., Healey, S.P., Andersen, H.-E., Petersson, H., Prentius, W., Patterson, P.L., Næsset, E., Gregoire, T.G. &amp; Ståhl, G. (2018). 
Generalized Hierarchical Model-Based Estimation for Aboveground Biomass Assessment Using GEDI and Landsat Data, <em>Remote Sensing, 10(11),</em> 1832.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary">summary</a></code>,
<code><a href="#topic+getSpec">getSpec</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pop_U    = sample(nrow(HMB_data), 20000)
pop_Sa   = sample(pop_U, 2500)
pop_S    = sample(pop_U, 300)

y_S      = HMB_data[pop_S, "GSV"]
X_S      = HMB_data[pop_S, c("hMAX", "h80", "CRR", "pVeg")]
X_Sa     = HMB_data[pop_Sa, c("hMAX", "h80", "CRR", "pVeg")]
Z_Sa     = HMB_data[pop_Sa, c("B20", "B30", "B50")]
Z_U      = HMB_data[pop_U, c("B20", "B30", "B50")]

Omega_S  = diag(1, nrow(X_S))
Sigma_Sa = diag(1, nrow(Z_Sa))

ghmb_model = ghmb(
  y_S, X_S, X_Sa, Z_Sa, Z_U, Omega_S, Sigma_Sa)
ghmb_model
</code></pre>

<hr>
<h2 id='gtsmb'>Generalized Two-Staged Model-Based estmation</h2><span id='topic+gtsmb'></span>

<h3>Description</h3>

<p>Generalized Two-Staged Model-Based estmation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gtsmb(y_S, X_S, X_Sa, Z_Sa, Z_U, Omega_S, Phis_Sa)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gtsmb_+3A_y_s">y_S</code></td>
<td>
<p>Response object that can be coersed into a column vector. The
<code>_S</code> denotes that <code>y</code> is part of the sample <em>S</em>, with
<code class="reqn">N_S \le N_{Sa} \le N_U</code>.</p>
</td></tr>
<tr><td><code id="gtsmb_+3A_x_s">X_S</code></td>
<td>
<p>Object of predictors variables that can be coersed into a matrix.
The rows of <code>X_S</code> correspond to the rows of <code>y_S</code>.</p>
</td></tr>
<tr><td><code id="gtsmb_+3A_x_sa">X_Sa</code></td>
<td>
<p>Object of predictor variables that can be coresed into a matrix.
The set <em>Sa</em> is the intermediate sample.</p>
</td></tr>
<tr><td><code id="gtsmb_+3A_z_sa">Z_Sa</code></td>
<td>
<p>Object of predictor variables that can be coresed into a matrix.
The set <em>Sa</em> is the intermediate sample, and the Z-variables often some
sort of auxilairy, inexpensive data. The rows of <code>Z_Sa</code> correspond to
the rows of <code>X_Sa</code></p>
</td></tr>
<tr><td><code id="gtsmb_+3A_z_u">Z_U</code></td>
<td>
<p>Object of predictor variables that can be coresed into a matrix.
The set <em>U</em> is the universal population sample.</p>
</td></tr>
<tr><td><code id="gtsmb_+3A_omega_s">Omega_S</code></td>
<td>
<p>The covariance structure of <code class="reqn">\boldsymbol{\epsilon}_{S}</code>, up to a constant.</p>
</td></tr>
<tr><td><code id="gtsmb_+3A_phis_sa">Phis_Sa</code></td>
<td>
<p>A 3D array, where the third dimension corresponds to the
covariance structure of
<code class="reqn">E(\boldsymbol{\xi}_{k,Sa} \boldsymbol{\xi}_{j,Sa}^T)</code>,
in the order <code class="reqn">k=1, \ldots, p, j=1, \ldots k</code>.
For p = 3, the order (k,j) will thus be (1,1), (2,1), (2,2), (3,1), (3,2),
(3,3).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The GTSMB assumes the superpopulations
</p>
<p style="text-align: center;"><code class="reqn">y = \boldsymbol{x} \boldsymbol{\beta} + \epsilon</code>
</p>

<p style="text-align: center;"><code class="reqn">x_k = \boldsymbol{z} \boldsymbol{\gamma}_k + \xi_k</code>
</p>

<p style="text-align: center;"><code class="reqn">\epsilon \perp \xi_k</code>
</p>

<p>For a sample from the superpopulation, the GTSMB assumes
</p>
<p style="text-align: center;"><code class="reqn">E(\boldsymbol{\epsilon}) = \mathbf{0},
      E(\boldsymbol{\epsilon} \boldsymbol{\epsilon}^T) = \omega^2 \boldsymbol{\Omega}</code>
</p>

<p style="text-align: center;"><code class="reqn">E(\boldsymbol{\xi}_k) = \mathbf{0},
      E(\boldsymbol{\xi}_k \boldsymbol{\xi}_j^T) = \theta_{\Phi,k,j}^2 \boldsymbol{\Phi}_{k,j},
      \theta_{\Phi,k,j}^2 \boldsymbol{\Phi}_{k,j} = \theta_{\Phi,j,k}^2 \boldsymbol{\Phi}_{j,k}</code>
</p>



<h3>Value</h3>

<p>A fitted object of class HMB.
</p>


<h3>References</h3>

<p>Holm, S., Nelson, R. &amp; Ståhl, G. (2017) Hybrid three-phase estimators for large-area forest inventory using ground plots, 
airborne lidar, and space lidar. <em>Remote Sensing of Environment, 197,</em> 85–97.
</p>
<p>Saarela, S., Holm, S., Healey, S.P., Andersen, H.-E., Petersson, H., Prentius, W., Patterson, P.L., Næsset, E., Gregoire, T.G. &amp; Ståhl, G. (2018). 
Generalized Hierarchical Model-Based Estimation for Aboveground Biomass Assessment Using GEDI and Landsat Data, <em>Remote Sensing, 10(11),</em> 1832.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary">summary</a></code>,
<code><a href="#topic+getSpec">getSpec</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pop_U   = sample(nrow(HMB_data), 20000)
pop_Sa  = sample(pop_U, 500)
pop_S   = sample(pop_U, 100)

y_S     = HMB_data[pop_S, "GSV"]
X_S     = HMB_data[pop_S, c("hMAX", "h80", "CRR")]
X_Sa    = HMB_data[pop_Sa, c("hMAX", "h80", "CRR")]
Z_Sa    = HMB_data[pop_Sa, c("B20", "B30", "B50")]
Z_U     = HMB_data[pop_U, c("B20", "B30", "B50")]

Omega_S = diag(1, nrow(X_S))
Phis_Sa = array(0, c(nrow(X_Sa), nrow(X_Sa), ncol(X_Sa) * (ncol(X_Sa) + 1) / 2))
Phis_Sa[, , 1] = diag(1, nrow(X_Sa)) # Phi(1,1)
Phis_Sa[, , 2] = diag(1, nrow(X_Sa)) # Phi(2,1)
Phis_Sa[, , 3] = diag(1, nrow(X_Sa)) # Phi(2,2)
Phis_Sa[, , 4] = diag(1, nrow(X_Sa)) # Phi(3,1)
Phis_Sa[, , 5] = diag(1, nrow(X_Sa)) # Phi(3,2)
Phis_Sa[, , 6] = diag(1, nrow(X_Sa)) # Phi(3,3)

gtsmb_model = gtsmb(y_S, X_S, X_Sa, Z_Sa, Z_U, Omega_S, Phis_Sa)
gtsmb_model
</code></pre>

<hr>
<h2 id='hmb'>Hierarchical Model-Based estmation</h2><span id='topic+hmb'></span>

<h3>Description</h3>

<p>Hierarchical Model-Based estmation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hmb(y_S, X_S, X_Sa, Z_Sa, Z_U)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hmb_+3A_y_s">y_S</code></td>
<td>
<p>Response object that can be coersed into a column vector. The
<code>_S</code> denotes that <code>y</code> is part of the sample <em>S</em>, with
<code class="reqn">N_S \le N_{Sa} \le N_U</code>.</p>
</td></tr>
<tr><td><code id="hmb_+3A_x_s">X_S</code></td>
<td>
<p>Object of predictors variables that can be coersed into a matrix.
The rows of <code>X_S</code> correspond to the rows of <code>y_S</code>.</p>
</td></tr>
<tr><td><code id="hmb_+3A_x_sa">X_Sa</code></td>
<td>
<p>Object of predictor variables that can be coresed into a matrix.
The set <em>Sa</em> is the intermediate sample.</p>
</td></tr>
<tr><td><code id="hmb_+3A_z_sa">Z_Sa</code></td>
<td>
<p>Object of predictor variables that can be coresed into a matrix.
The set <em>Sa</em> is the intermediate sample, and the Z-variables often some
sort of auxilairy, inexpensive data. The rows of <code>Z_Sa</code> correspond to
the rows of <code>X_Sa</code></p>
</td></tr>
<tr><td><code id="hmb_+3A_z_u">Z_U</code></td>
<td>
<p>Object of predictor variables that can be coresed into a matrix.
The set <em>U</em> is the universal population sample.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The HMB assumes two models
</p>
<p style="text-align: center;"><code class="reqn">y = \boldsymbol{x} \boldsymbol{\beta} + \epsilon</code>
</p>

<p style="text-align: center;"><code class="reqn">\boldsymbol{x} \boldsymbol{\beta} = \boldsymbol{z} \boldsymbol{\alpha} + u</code>
</p>

<p style="text-align: center;"><code class="reqn">\epsilon \perp u</code>
</p>

<p>For a sample from the superpopulation, the HMB assumes
</p>
<p style="text-align: center;"><code class="reqn">E(\boldsymbol{\epsilon}) = \mathbf{0},
      E(\boldsymbol{\epsilon} \boldsymbol{\epsilon}^T) = \omega^2 \mathbf{I}</code>
</p>

<p style="text-align: center;"><code class="reqn">E(\boldsymbol{u}) = \mathbf{0},
      E(\boldsymbol{u} \boldsymbol{u}^T) = \sigma^2 \mathbf{I}</code>
</p>



<h3>Value</h3>

<p>A fitted object of class HMB.
</p>


<h3>References</h3>

<p>Saarela, S., Holm, S., Grafström, A., Schnell, S., Næsset, E., Gregoire, T.G., Nelson, R.F. &amp; Ståhl, G. (2016). 
Hierarchical model-based inference for forest inventory utilizing three sources of information, <em>Annals of Forest Science, 73(4),</em> 895-910.
</p>
<p>Saarela, S., Holm, S., Healey, S.P., Andersen, H.-E., Petersson, H., Prentius, W., Patterson, P.L., Næsset, E., Gregoire, T.G. &amp; Ståhl, G. (2018). 
Generalized Hierarchical Model-Based Estimation for Aboveground Biomass Assessment Using GEDI and Landsat Data, <em>Remote Sensing, 10(11),</em> 1832.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary">summary</a></code>,
<code><a href="#topic+getSpec">getSpec</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pop_U  = sample(nrow(HMB_data), 20000)
pop_Sa = sample(pop_U, 5000)
pop_S  = sample(pop_U, 300)

y_S    = HMB_data[pop_S, "GSV"]
X_S    = HMB_data[pop_S, c("hMAX", "h80", "CRR", "pVeg")]
X_Sa   = HMB_data[pop_Sa, c("hMAX", "h80", "CRR", "pVeg")]
Z_Sa   = HMB_data[pop_Sa, c("B20", "B30", "B50")]
Z_U    = HMB_data[pop_U, c("B20", "B30", "B50")]

hmb_model = hmb(y_S, X_S, X_Sa, Z_Sa, Z_U)
hmb_model
</code></pre>

<hr>
<h2 id='HMB_data'>
Sample Data for HMB package
</h2><span id='topic+HMB_data'></span>

<h3>Description</h3>

<p>A data frame with 100000 records.
</p>
<p>Names are
GSV:
hMAX:
h80:
CRR:
pVeg:
B20:
B30:
B50:
</p>

<hr>
<h2 id='HMB-class'>Class HMB</h2><span id='topic+HMB-class'></span>

<h3>Description</h3>

<p>Class <code>HMB</code> is the base class for the HMB-package
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hmb">hmb</a></code>, <code><a href="#topic+ghmb">ghmb</a></code>, <code><a href="#topic+tsmb">tsmb</a></code>, <code><a href="#topic+gtsmb">gtsmb</a></code>
</p>

<hr>
<h2 id='show'>Method show</h2><span id='topic+show'></span><span id='topic+show+2CHMB-method'></span><span id='topic+show+2CSummaryHMB-method'></span>

<h3>Description</h3>

<p>Display model outputs
</p>
<p>Display model summary properties
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'HMB'
show(object)

## S4 method for signature 'SummaryHMB'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show_+3A_object">object</code></td>
<td>
<p>Object of class HMB</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>pop_U  = sample(nrow(HMB_data), 20000)
pop_Sa = sample(pop_U, 5000)
pop_S  = sample(pop_U, 300)

y_S    = HMB_data[pop_S, "GSV"]
X_S    = HMB_data[pop_S, c("hMAX", "h80", "CRR", "pVeg")]
X_Sa   = HMB_data[pop_Sa, c("hMAX", "h80", "CRR", "pVeg")]
Z_Sa   = HMB_data[pop_Sa, c("B20", "B30", "B50")]
Z_U    = HMB_data[pop_U, c("B20", "B30", "B50")]

hmb_model = hmb(y_S, X_S, X_Sa, Z_Sa, Z_U)
show(hmb_model)
pop_U  = sample(nrow(HMB_data), 20000)
pop_Sa = sample(pop_U, 5000)
pop_S  = sample(pop_U, 300)

y_S    = HMB_data[pop_S, "GSV"]
X_S    = HMB_data[pop_S, c("hMAX", "h80", "CRR", "pVeg")]
X_Sa   = HMB_data[pop_Sa, c("hMAX", "h80", "CRR", "pVeg")]
Z_Sa   = HMB_data[pop_Sa, c("B20", "B30", "B50")]
Z_U    = HMB_data[pop_U, c("B20", "B30", "B50")]

hmb_model = hmb(y_S, X_S, X_Sa, Z_Sa, Z_U)
show(summary(hmb_model))
</code></pre>

<hr>
<h2 id='summary'>Method summary</h2><span id='topic+summary'></span><span id='topic+summary+2CHMB-method'></span>

<h3>Description</h3>

<p>Summary of HMB model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary(obj)

## S4 method for signature 'HMB'
summary(obj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary_+3A_obj">obj</code></td>
<td>
<p>Object of class HMB</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Summary of HMB model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pop_U  = sample(nrow(HMB_data), 20000)
pop_Sa = sample(pop_U, 5000)
pop_S  = sample(pop_U, 300)

y_S    = HMB_data[pop_S, "GSV"]
X_S    = HMB_data[pop_S, c("hMAX", "h80", "CRR", "pVeg")]
X_Sa   = HMB_data[pop_Sa, c("hMAX", "h80", "CRR", "pVeg")]
Z_Sa   = HMB_data[pop_Sa, c("B20", "B30", "B50")]
Z_U    = HMB_data[pop_U, c("B20", "B30", "B50")]

S_Sa_map = matrix(pop_S, nrow = nrow(X_S), ncol = nrow(X_Sa))
S_Sa_map = t(apply(S_Sa_map, 1, function(x) {
  return(x == pop_Sa)
})) * 1

hmb_model = hmb(y_S, X_S, X_Sa, Z_Sa, Z_U)
summary(hmb_model)
</code></pre>

<hr>
<h2 id='SummaryHMB-class'>Class SummaryHMB</h2><span id='topic+SummaryHMB-class'></span>

<h3>Description</h3>

<p>Class <code>SummaryHMB</code> defines summary information for HMB object.
</p>

<hr>
<h2 id='tsmb'>Two-staged Model-Based estmation</h2><span id='topic+tsmb'></span>

<h3>Description</h3>

<p>Two-staged Model-Based estmation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsmb(y_S, X_S, X_Sa, Z_Sa, Z_U)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tsmb_+3A_y_s">y_S</code></td>
<td>
<p>Response object that can be coersed into a column vector. The
<code>_S</code> denotes that <code>y</code> is part of the sample <em>S</em>, with
<code class="reqn">N_S \le N_{Sa} \le N_U</code>.</p>
</td></tr>
<tr><td><code id="tsmb_+3A_x_s">X_S</code></td>
<td>
<p>Object of predictors variables that can be coersed into a matrix.
The rows of <code>X_S</code> correspond to the rows of <code>y_S</code>.</p>
</td></tr>
<tr><td><code id="tsmb_+3A_x_sa">X_Sa</code></td>
<td>
<p>Object of predictor variables that can be coresed into a matrix.
The set <em>Sa</em> is the intermediate sample.</p>
</td></tr>
<tr><td><code id="tsmb_+3A_z_sa">Z_Sa</code></td>
<td>
<p>Object of predictor variables that can be coresed into a matrix.
The set <em>Sa</em> is the intermediate sample, and the Z-variables often some
sort of auxilairy, inexpensive data. The rows of <code>Z_Sa</code> correspond to
the rows of <code>X_Sa</code></p>
</td></tr>
<tr><td><code id="tsmb_+3A_z_u">Z_U</code></td>
<td>
<p>Object of predictor variables that can be coresed into a matrix.
The set <em>U</em> is the universal population sample.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The TSMB assumes the superpopulations
</p>
<p style="text-align: center;"><code class="reqn">y = \boldsymbol{x}^T \boldsymbol{\beta} + \epsilon</code>
</p>

<p style="text-align: center;"><code class="reqn">x_k = \boldsymbol{z}^T \boldsymbol{\gamma}_k + \xi_k</code>
</p>

<p style="text-align: center;"><code class="reqn">\epsilon \perp \xi_k</code>
</p>

<p>For a sample from the superpopulation, the TSMB assumes
</p>
<p style="text-align: center;"><code class="reqn">E(\boldsymbol{\epsilon}) = \mathbf{0},
      E(\boldsymbol{\epsilon} \boldsymbol{\epsilon}^T) = \omega^2 \mathbf{I}</code>
</p>

<p style="text-align: center;"><code class="reqn">E(\boldsymbol{\xi}_k) = \mathbf{0},
      E(\boldsymbol{\xi}_k \boldsymbol{\xi}_j^T) = \phi_{k,j}^2 \mathbf{I}</code>
</p>



<h3>Value</h3>

<p>A fitted object of class HMB.
</p>


<h3>References</h3>

<p>Saarela, S., Holm, S., Grafström, A., Schnell, S., Næsset, E., Gregoire, T.G., Nelson, R.F. &amp; Ståhl, G. (2016). 
Hierarchical model-based inference for forest inventory utilizing three sources of information. <em>Annals of Forest Science, 73(4),</em> 895-910.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary">summary</a></code>,
<code><a href="#topic+getSpec">getSpec</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pop_U  = sample(nrow(HMB_data), 20000)
pop_Sa = sample(pop_U, 5000)
pop_S  = sample(pop_U, 300)

y_S    = HMB_data[pop_S, "GSV"]
X_S    = HMB_data[pop_S, c("hMAX", "h80", "CRR", "pVeg")]
X_Sa   = HMB_data[pop_Sa, c("hMAX", "h80", "CRR", "pVeg")]
Z_Sa   = HMB_data[pop_Sa, c("B20", "B30", "B50")]
Z_U    = HMB_data[pop_U, c("B20", "B30", "B50")]

tsmb_model = tsmb(y_S, X_S, X_Sa, Z_Sa, Z_U)
tsmb_model
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
