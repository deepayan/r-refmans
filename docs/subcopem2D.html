<!DOCTYPE html><html><head><title>Help for package subcopem2D</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {subcopem2D}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Bcopula'>
<p>Bernstein Copula Approximation</p></a></li>
<li><a href='#dependence'>
<p>Dependence Measures</p></a></li>
<li><a href='#subcopem'>
<p>Bivariate Empirical Subcopula</p></a></li>
<li><a href='#subcopemc'>
<p>Bivariate Empirical Sucopula of Given Approximation Order</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bivariate Empirical Subcopula</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-03-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Arturo Erdely</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Arturo Erdely &lt;arturo.erdely@comunidad.unam.mx&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculate empirical subcopula and dependence measures from a given bivariate sample, and Bernstein copula approximations.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-03-19 00:15:36 UTC; aerde</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-03-19 05:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Bcopula'>
Bernstein Copula Approximation
</h2><span id='topic+Bcopula'></span>

<h3>Description</h3>

<p>Bernstein copula approximation from the empirical subcopula of given bivariate data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bcopula(mat.xy, m, both.cont = FALSE, tolimit = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bcopula_+3A_mat.xy">mat.xy</code></td>
<td>

<p>2-column matrix with bivariate observations of a random vector <code class="reqn">(X,Y)</code>.
</p>
</td></tr>
<tr><td><code id="Bcopula_+3A_m">m</code></td>
<td>

<p>integer value of approximation order, where <code class="reqn">m = 2,...,n</code> with <code class="reqn">n</code> equal to sample size. A recommended value for <code class="reqn">m</code> would be the minimum between <code class="reqn">\sqrt{n}</code> and <code class="reqn">50</code>.
</p>
</td></tr>
<tr><td><code id="Bcopula_+3A_both.cont">both.cont</code></td>
<td>

<p>logical value, if TRUE then (X,Y) are considered (both) as continuos random variables, and jittering will be applied to repeated values (if any).
</p>
</td></tr>
<tr><td><code id="Bcopula_+3A_tolimit">tolimit</code></td>
<td>

<p>tolerance limit in numerical approximation of the inverse of the first partial derivatives of the estimated Bernstein copula.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each of the random variables <code class="reqn">X</code> and <code class="reqn">Y</code> may be of any kind (discrete, continuous, or mixed). NA values are not allowed.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>copula</code></td>
<td>
<p>bivariate Bernstein Copula function (BC) of order <code class="reqn">m</code></p>
</td></tr>
<tr><td><code>du</code></td>
<td>
<p>bivariate function <code class="reqn">\partial BC(u,v)/\partial u</code></p>
</td></tr>
<tr><td><code>dv</code></td>
<td>
<p>bivariate function <code class="reqn">\partial BC(u,v)/\partial v</code></p>
</td></tr>
<tr><td><code>du.inv</code></td>
<td>
<p>inverse of <code>du</code> with respect to v, given u and alpha (numerical approx)</p>
</td></tr>
<tr><td><code>dv.inv</code></td>
<td>
<p>inverse of <code>dv</code> with respect to u, given v and alpha (numerical approx)</p>
</td></tr>
<tr><td><code>density</code></td>
<td>
<p>bivariate Bernstein copula density function of order <code class="reqn">m</code></p>
</td></tr>
<tr><td><code>bilinearCopula</code></td>
<td>
<p>bivariate function of bilinear approximation of copula</p>
</td></tr>
<tr><td><code>bilinearSubcopula</code></td>
<td>
<p><code class="reqn">(m+1)\times (m+1)</code> matrix with empirical subcopula values</p>
</td></tr>
<tr><td><code>sample.size</code></td>
<td>
<p>sample size of bivariate observations</p>
</td></tr>
<tr><td><code>order</code></td>
<td>
<p>approximation order <code class="reqn">m</code> used</p>
</td></tr>
<tr><td><code>both.cont</code></td>
<td>
<p>logical value, TRUE if both variables considered as continuous</p>
</td></tr>
<tr><td><code>tolimit</code></td>
<td>
<p>tolerance limit in numerical approximation of <code>du.inv</code> and <code>dv.inv</code></p>
</td></tr>
<tr><td><code>subcopemObject</code></td>
<td>
<p>list object with the output from <code>subcopem</code> if <code>both.cont = FALSE</code> or from <code>subcopemc</code> if <code>both.cont = TRUE</code></p>
</td></tr>
</table>


<h3>Acknowledgement</h3>

<p>Development of this code was partially supported by Programa UNAM DGAPA PAPIIT through project IN115817.</p>


<h3>Note</h3>

<p>If both <code class="reqn">X</code> and <code class="reqn">Y</code> are continuous random variables it is faster and better to set <code>both.cont = TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Arturo Erdely <a href="https://sites.google.com/site/arturoerdely">https://sites.google.com/site/arturoerdely</a>
</p>


<h3>References</h3>

<p>Erdely, A. (2017) <em>A subcopula based dependence measure</em>. Kybernetika 53(2), 231-243. DOI: 10.14736/kyb-2017-2-0231
</p>
<p>Nelsen, R.B. (2006) <em>An Introduction to Copulas</em>. Springer, New York.
</p>
<p>Sancetta, A., Satchell, S. (2004) <em>The Bernstein copula and its applications to modeling and approximations of multivariate distributions.</em> Econometric Theory 20, 535-562. DOI: 10.1017/S026646660420305X
</p>


<h3>See Also</h3>

<p><code><a href="#topic+subcopem">subcopem</a></code>, <code><a href="#topic+subcopemc">subcopemc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## (X,Y) continuous random variables with copula FGM(param = 1)

# Theoretical formulas
FGMcopula &lt;- function(u, v) u*v*(1 + (1 - u)*(1 - v))
dFGM.du &lt;- function(u, v) (2*u - 1)*(v^2) + 2*v*(1 - u)
dFGM.dv &lt;- function(u, v) (2*v - 1)*(u^2) + 2*u*(1 - v)
A1 &lt;- function(u) 2*(1 - u)
A2 &lt;- function(u, z) sqrt(A1(u)^2 - 4*(A1(u) - 1)*z)
dFGM.du.inv &lt;- function(u, z) 2*z/(A1(u) + A2(u, z))
FGMdensity &lt;- function(u, v) 2*(1 - u - v + 2*u*v)

# Simulating FGM observations
n &lt;- 3000
U &lt;- runif(n)
Z &lt;- runif(n)
V &lt;- mapply(dFGM.du.inv, U, Z)

# Applying Bcopula to FGM simulated values
B &lt;- Bcopula(cbind(U, V), 50, TRUE)
str(B)

# Comparing theoretical values versus Bernstein and Bilinear approximations
u &lt;- 0.70; v &lt;- 0.55
FGMcopula(u, v); B[["copula"]](u, v); B[["bilinearCopula"]](u, v)
dFGM.du(u, v); B[["du"]](u, v)
dFGM.dv(u, v); B[["dv"]](u, v)
dFGM.du.inv(u, 0.8); B[["du.inv"]](u, 0.8)
FGMdensity(u, v); B[["density"]](u, v)
</code></pre>

<hr>
<h2 id='dependence'>
Dependence Measures
</h2><span id='topic+dependence'></span>

<h3>Description</h3>

<p>Calculation of pairwise monotone and supremum dependence, monotone/supremum dependence ratio, and proportion of pairwise NAs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dependence(mat, cont = NULL, sc.order = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dependence_+3A_mat">mat</code></td>
<td>

<p><code class="reqn">k</code>-column matrix with <code class="reqn">n</code> observations of a <code class="reqn">k</code>-dimensional random vector (NA values are allowed).
</p>
</td></tr>
<tr><td><code id="dependence_+3A_cont">cont</code></td>
<td>

<p>vector of column numbers to consider/coerce as continuous random variables (optional).
</p>
</td></tr>
<tr><td><code id="dependence_+3A_sc.order">sc.order</code></td>
<td>

<p>order of subcopula approximation (continuous random variables). If <code class="reqn">0</code> (default) then maximum order <code class="reqn">m = n</code> is used. Often <code class="reqn">m = 50</code> is a good recommended value, higher values demand more computing time.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each of the random variables in the <code class="reqn">k</code>-dimensional random vector under consideration may be of any kind (discrete, continuous, or mixed). NA values are allowed.
</p>


<h3>Value</h3>

<p>A 3-dimensional array <code class="reqn">k\times k\times 4</code> with pairwise monotone and supremum dependence, monotone/supremum dependence ratio, and proportion of pairwise NAs.
</p>


<h3>Note</h3>

<p>NA values are allowed.
</p>


<h3>Author(s)</h3>

<p>Arturo Erdely <a href="https://sites.google.com/site/arturoerdely">https://sites.google.com/site/arturoerdely</a>
</p>


<h3>References</h3>

<p>Erdely, A. (2017) <em>A subcopula based dependence measure</em>. Kybernetika 53(2), 231-243. DOI: 10.14736/kyb-2017-2-0231
</p>
<p>Nelsen, R.B. (2006) <em>An Introduction to Copulas</em>. Springer, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+subcopem">subcopem</a></code>, <code><a href="#topic+subcopemc">subcopemc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>V &lt;- runif(300)  # Continuous Uniform(0,1)
W &lt;- V*(1-V)     # Continuous transform of V
# X given V=v as continuous Uniform(0,v)
X &lt;- mapply(runif, rep(1, length(V)), rep(0, length(V)), V)
Y &lt;- 1*(0.2 &lt; X)*(X &lt; 0.6)  # Discrete transform of X
Z &lt;- X*(0.1 &lt; X)*(X &lt; 0.9) + 1*(X &gt;= 0.9)  # Mixed transform of X
V[1:10] &lt;- NA  # Introducing some NAs
W[3:12] &lt;- NA  # Introducing some NAs
Y[5:25] &lt;- NA  # Introducing some NAs
vector5D &lt;- cbind(V, W, X, Y, Z)  # Matrix of 5-variate observations
# Monotone and supremum dependence, ratio and proportion of NAs:
(deparray &lt;- dependence(vector5D, cont = c(1, 2, 3), 30))
# Pearson's correlations:
cor(vector5D, method = "pearson", use = "pairwise.complete.obs")
# Spearman's correlations:
cor(vector5D, method = "spearman", use = "pairwise.complete.obs") 
# Kendall's correlations:
cor(vector5D, method = "kendall", use = "pairwise.complete.obs")   
pairs(vector5D)  # Matrix of pairwise scatterplots
</code></pre>

<hr>
<h2 id='subcopem'>
Bivariate Empirical Subcopula
</h2><span id='topic+subcopem'></span>

<h3>Description</h3>

<p>Calculation of bivariate empirical subcopula matrix, induced partitions, standardized bivariate sample, and dependence measures for a given bivariate sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subcopem(mat.xy, display = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subcopem_+3A_mat.xy">mat.xy</code></td>
<td>

<p>2-column matrix with bivariate observations of a random vector <code class="reqn">(X,Y)</code>.
</p>
</td></tr>
<tr><td><code id="subcopem_+3A_display">display</code></td>
<td>

<p>logical value indicating if graphs and dependence measures should be displayed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each of the random variables <code class="reqn">X</code> and <code class="reqn">Y</code> may be of any kind (discrete, continuous, or mixed). NA values are not allowed.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>depMon</code></td>
<td>
<p>monotone standardized supremum distance in <code class="reqn">[-1,1].</code></p>
</td></tr>
<tr><td><code>depMonNonSTD</code></td>
<td>
<p>monotone non-standardized supremum distance <code class="reqn">[min,value,max].</code></p>
</td></tr>
<tr><td><code>depSup</code></td>
<td>
<p>standardized supremum distance in <code class="reqn">[0,1].</code></p>
</td></tr>
<tr><td><code>depSupNonSTD</code></td>
<td>
<p>non-standardized supremum distance <code class="reqn">[min,value,max].</code></p>
</td></tr>
<tr><td><code>matrix</code></td>
<td>
<p>matrix with empirical subcopula values.</p>
</td></tr>
<tr><td><code>part1</code></td>
<td>
<p>vector with partition induced by first variable <code class="reqn">X</code>.</p>
</td></tr>
<tr><td><code>part2</code></td>
<td>
<p>vector with partition induced by second variable <code class="reqn">Y</code>.</p>
</td></tr>
<tr><td><code>sample.size</code></td>
<td>
<p>numeric value of sample size.</p>
</td></tr>
<tr><td><code>std.sample</code></td>
<td>
<p>2-column matrix with the standardized bivariate sample.</p>
</td></tr>
<tr><td><code>sample</code></td>
<td>
<p>2-column matrix with the original bivariate sample of <code class="reqn">(X,Y)</code>.</p>
</td></tr>
</table>
<p>If <code>display = TRUE</code> then the values of <code>depMon</code>, <code>depMonNonSTD</code>, <code>depSup</code>, and <code>depSupNonSTD</code> will be displayed, and the following graphs will be generated: marginal histograms of <code class="reqn">X</code> and <code class="reqn">Y</code>, scatterplots of the original and the standardized bivariate sample, contour and image bivariate graphs of the empirical subcopula.
</p>


<h3>Note</h3>

<p>If both <code class="reqn">X</code> and <code class="reqn">Y</code> are continuous random variables it is faster and better to use <code><a href="#topic+subcopemc">subcopemc</a></code>.
</p>


<h3>Author(s)</h3>

<p>Arturo Erdely <a href="https://sites.google.com/site/arturoerdely">https://sites.google.com/site/arturoerdely</a>
</p>


<h3>References</h3>

<p>Durante, F. and Sempi, C. (2016) <em>Principles of Copula Theory</em>. Taylor and Francis Group, Boca Raton.
</p>
<p>Erdely, A. (2017) <em>A subcopula based dependence measure</em>. Kybernetika 53(2), 231-243. DOI: 10.14736/kyb-2017-2-0231
</p>
<p>Nelsen, R.B. (2006) <em>An Introduction to Copulas</em>. Springer, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+subcopemc">subcopemc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1: Discrete-discrete Poisson positive dependence
n &lt;- 1000  # sample size
X &lt;- rpois(n, 5)  # Poisson(parameter = 5)
p &lt;- 2  # another parameter
Y &lt;- mapply(rpois, rep(1, n), 1 + p*X)  # creating dependence
XY &lt;- cbind(X, Y)  # 2-column matrix with bivariate sample
cor(XY, method = "pearson")[1, 2]   # Pearson's correlation
cor(XY, method = "spearman")[1, 2]  # Spearman's correlation
cor(XY, method = "kendall")[1, 2]  # Kendall's correlation
SC &lt;- subcopem(XY, display = TRUE)
str(SC)

## Example 2: Continuous-discrete non-monotone dependence
n &lt;- 1000      # sample size
X &lt;- rnorm(n)                  # Normal(0,1)
Y &lt;- 2*(X &gt; 1) - 1*(X &gt; -1)    # Discrete({-1, 0, 1})
XY &lt;- cbind(X, Y)  # 2-column matrix with bivariate sample
cor(XY, method = "pearson")[1, 2]   # Pearson's correlation
cor(XY, method = "spearman")[1, 2]  # Spearman's correlation
cor(XY, method = "kendall")[1, 2]  # Kendall's correlation
SC &lt;- subcopem(XY, display = TRUE)
str(SC)
</code></pre>

<hr>
<h2 id='subcopemc'>
Bivariate Empirical Sucopula of Given Approximation Order
</h2><span id='topic+subcopemc'></span>

<h3>Description</h3>

<p>Calculation of bivariate empirical subcopula matrix of given approximation order, induced partitions, standardized bivariate sample, and dependence measures for a given <b>continuous</b> bivariate sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subcopemc(mat.xy, m = nrow(mat.xy), display = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subcopemc_+3A_mat.xy">mat.xy</code></td>
<td>

<p>2-column matrix with bivariate observations of a continuous random vector <code class="reqn">(X,Y)</code>.
</p>
</td></tr>
<tr><td><code id="subcopemc_+3A_m">m</code></td>
<td>

<p>integer value of approximation order, where <code class="reqn">m = 2,...,n</code> with <code class="reqn">n</code> equal to sample size.
</p>
</td></tr>
<tr><td><code id="subcopemc_+3A_display">display</code></td>
<td>

<p>logical value indicating if graphs and dependence values should be displayed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both random variables <code class="reqn">X</code> and <code class="reqn">Y</code> must be continuous, and therefore repeated values in the sample are not expected. If found, <code>jitter</code> will be applied to break ties. NA values are not allowed.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>depMon</code></td>
<td>
<p>monotone standardized supremum distance in <code class="reqn">[-1,1].</code></p>
</td></tr>  
<tr><td><code>depMonNonSTD</code></td>
<td>
<p>monotone non-standardized supremum distance <code class="reqn">[min,value,max].</code></p>
</td></tr>
<tr><td><code>depSup</code></td>
<td>
<p>standardized supremum distance in <code class="reqn">[0,1].</code></p>
</td></tr>
<tr><td><code>depSupNonSTD</code></td>
<td>
<p>non-standardized supremum distance <code class="reqn">[min,value,max].</code></p>
</td></tr>
<tr><td><code>matrix</code></td>
<td>
<p>matrix with empirical subcopula values.</p>
</td></tr>
<tr><td><code>part1</code></td>
<td>
<p>vector with partition induced by first variable <code class="reqn">X</code>.</p>
</td></tr>
<tr><td><code>part2</code></td>
<td>
<p>vector with partition induced by second variable <code class="reqn">Y</code>.</p>
</td></tr>
<tr><td><code>sample.size</code></td>
<td>
<p>numeric value of sample size.</p>
</td></tr>
<tr><td><code>order</code></td>
<td>
<p>numeric value of approximation order.</p>
</td></tr>
<tr><td><code>std.sample</code></td>
<td>
<p>2-column matrix with the standardized bivariate sample.</p>
</td></tr>
<tr><td><code>sample</code></td>
<td>
<p>2-column matrix with the original bivariate sample of <code class="reqn">(X,Y)</code>.</p>
</td></tr>
</table>
<p>If <code>display = TRUE</code> then the values of <code>depMon</code>, <code>depMonNonSTD</code>, <code>depSup</code>, and <code>depSupNonSTD</code> will be displayed, and the following graphs will be generated: marginal histograms of <code class="reqn">X</code> and <code class="reqn">Y</code>, scatterplots of the original and the standardized bivariate sample, contour and image bivariate graphs of the empirical subcopula.
</p>


<h3>Note</h3>

<p>If approximation order <code class="reqn">m &gt; 2000</code> calculation may take more than 2 minutes. Usually <code class="reqn">m = 50</code> would be enough for an acceptable approximation.
</p>


<h3>Author(s)</h3>

<p>Arturo Erdely <a href="https://sites.google.com/site/arturoerdely">https://sites.google.com/site/arturoerdely</a>
</p>


<h3>References</h3>

<p>Durante, F. and Sempi, C. (2016) <em>Principles of Copula Theory</em>. Taylor and Francis Group, Boca Raton.
</p>
<p>Erdely, A. (2017) <em>A subcopula based dependence measure</em>. Kybernetika 53(2), 231-243. DOI: 10.14736/kyb-2017-2-0231
</p>
<p>Nelsen, R.B. (2006) <em>An Introduction to Copulas</em>. Springer, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+subcopem">subcopem</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1: Independent Normal and Gamma

n &lt;- 300  # sample size
X &lt;- rnorm(n)         # Normal(0,1)
Y &lt;- rgamma(n, 2, 3)  # Gamma(2,3)
XY &lt;- cbind(X, Y)  # 2-column matrix with bivariate sample
cor(XY, method = "pearson")[1, 2]   # Pearson's correlation
cor(XY, method = "spearman")[1, 2]  # Spearman's correlation
cor(XY, method = "kendall")[1, 2]  # Kendall's correlation
SC &lt;- subcopemc(XY,, display = TRUE)
str(SC)
## Approximation of order m = 15
SCm15 &lt;- subcopemc(XY, 15, display = TRUE)
str(SCm15)

## Example 2: Non-monotone dependence

n &lt;- 300  # sample size
Theta &lt;- runif(n, 0, 2*pi)  # Uniform circular distribution
X &lt;- cos(Theta)
Y &lt;- sin(Theta)
XY &lt;- cbind(X, Y)  # 2-column matrix with bivariate sample
cor(XY, method = "pearson")[1, 2]   # Pearson's correlation
cor(XY, method = "spearman")[1, 2]  # Spearman's correlation
cor(XY, method = "kendall")[1, 2]  # Kendall's correlation
SC &lt;- subcopemc(XY,, display = TRUE)
str(SC)
## Approximation of order m = 15
SCm15 &lt;- subcopemc(XY, 15, display = TRUE)
str(SCm15)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
