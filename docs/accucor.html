<!DOCTYPE html><html><head><title>Help for package accucor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {accucor}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#accucor'><p>accucor: A package for natural abundance correction of mass spectrometer data</p></a></li>
<li><a href='#carbon_isotope_correction'><p>Natural Abundance carbon isotope correction for one metabolite</p></a></li>
<li><a href='#clean_data_frame'><p>Standardize data frame columns and data types</p></a></li>
<li><a href='#deuterium_isotope_correction'><p>Natural Abundance deuterium isotope correction for one metabolite</p></a></li>
<li><a href='#natural_abundance_correction'><p>Natural Abundance correction for mass spectrometry data</p></a></li>
<li><a href='#nitrogen_isotope_correction'><p>Natural Abundance deuterium isotope correction for one metabolite</p></a></li>
<li><a href='#read_elmaven'><p>Natural Abundance correction for Carbon labeled samples</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Natural Abundance Correction of Mass Spectrometer Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.1</td>
</tr>
<tr>
<td>Description:</td>
<td>An isotope natural abundance correction algorithm that
  is needed especially for high resolution mass spectrometers. Supports
  correction for 13C, 2H and 15N. Su X, Lu W and Rabinowitz J (2017)
  &lt;<a href="https://doi.org/10.1021%2Facs.analchem.7b00396">doi:10.1021/acs.analchem.7b00396</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/XiaoyangSu/AccuCor">https://github.com/XiaoyangSu/AccuCor</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/XiaoyangSu/AccuCor/issues">https://github.com/XiaoyangSu/AccuCor/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>nnls, dplyr, stringr, readxl, readr, rlang, tibble, writexl,
CHNOSZ</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-14 14:08:53 UTC; lparsons</td>
</tr>
<tr>
<td>Author:</td>
<td>Xiaoyang Su <a href="https://orcid.org/0000-0001-8081-1396"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Lance Parsons <a href="https://orcid.org/0000-0002-8521-714X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Yujue Wang <a href="https://orcid.org/0000-0001-7088-1729"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Princeton University [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lance Parsons &lt;lparsons@princeton.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-14 15:30:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='accucor'>accucor: A package for natural abundance correction of mass spectrometer data</h2><span id='topic+accucor'></span><span id='topic+accucor-package'></span>

<h3>Description</h3>

<p>AccuCor is an isotope natural abundance correction algorithm that
is needed especially for high resolution mass spectrometers. AccuCor
supports correction for 13C, 2H and 15N.
</p>


<h3>AccuCor functions</h3>

<p><code><a href="#topic+natural_abundance_correction">natural_abundance_correction</a></code>
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Lance Parsons <a href="mailto:lparsons@princeton.edu">lparsons@princeton.edu</a> (<a href="https://orcid.org/0000-0002-8521-714X">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Xiaoyang Su <a href="mailto:xs137@rwjms.rutgers.edu">xs137@rwjms.rutgers.edu</a> (<a href="https://orcid.org/0000-0001-8081-1396">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Yujue Wang <a href="mailto:yw429@rwjms.rutgers.edu">yw429@rwjms.rutgers.edu</a> (<a href="https://orcid.org/0000-0001-7088-1729">ORCID</a>) [contributor]
</p>
</li>
<li><p> Princeton University [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/XiaoyangSu/AccuCor">https://github.com/XiaoyangSu/AccuCor</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/XiaoyangSu/AccuCor/issues">https://github.com/XiaoyangSu/AccuCor/issues</a>
</p>
</li></ul>


<hr>
<h2 id='carbon_isotope_correction'>Natural Abundance carbon isotope correction for one metabolite</h2><span id='topic+carbon_isotope_correction'></span>

<h3>Description</h3>

<p>Natural Abundance carbon isotope correction for one metabolite
</p>


<h3>Usage</h3>

<pre><code class='language-R'>carbon_isotope_correction(
  formula,
  datamatrix,
  label,
  Resolution,
  ResDefAt = 200,
  purity = 0.99,
  ReportPoolSize = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="carbon_isotope_correction_+3A_formula">formula</code></td>
<td>
<p>String representing molecular formula</p>
</td></tr>
<tr><td><code id="carbon_isotope_correction_+3A_datamatrix">datamatrix</code></td>
<td>
<p>Matrix of abundances for each sample for each isotope</p>
</td></tr>
<tr><td><code id="carbon_isotope_correction_+3A_label">label</code></td>
<td>
<p>vector of integer labels</p>
</td></tr>
<tr><td><code id="carbon_isotope_correction_+3A_resolution">Resolution</code></td>
<td>
<p>For Exactive, the Resolution is 100000, defined at Mw 200</p>
</td></tr>
<tr><td><code id="carbon_isotope_correction_+3A_resdefat">ResDefAt</code></td>
<td>
<p>Resolution defined at (in Mw), e.g. 200 Mw</p>
</td></tr>
<tr><td><code id="carbon_isotope_correction_+3A_purity">purity</code></td>
<td>
<p>Carbon 13 purity, default: 0.99</p>
</td></tr>
<tr><td><code id="carbon_isotope_correction_+3A_reportpoolsize">ReportPoolSize</code></td>
<td>
<p>default: TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list of matrices: 'Corrected', 'Normalized',
'PoolBeforeDF', and 'PoolAfterDF'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
carbon_isotope_correction(
  formula = "C6H13O9P",
  datamatrix = DataMatrix,
  label = c(0, 1, 2, 3, 4, 5),
  Resolution = 100000
)

## End(Not run)
</code></pre>

<hr>
<h2 id='clean_data_frame'>Standardize data frame columns and data types</h2><span id='topic+clean_data_frame'></span>

<h3>Description</h3>

<p>Standardize data frame columns and data types
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_data_frame(df, columns_to_skip = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean_data_frame_+3A_df">df</code></td>
<td>
<p>Data frame to clean</p>
</td></tr>
<tr><td><code id="clean_data_frame_+3A_columns_to_skip">columns_to_skip</code></td>
<td>
<p>Specify column heading to skip. All other columns not
named 'compound', 'formula', and 'isotopelabel' will be assumed to be
sample names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>&quot;cleaned&quot; data.frame which with columns 'compound', 'formula',
'isotope_label', label_index', followed by columns for each sample
</p>

<hr>
<h2 id='deuterium_isotope_correction'>Natural Abundance deuterium isotope correction for one metabolite</h2><span id='topic+deuterium_isotope_correction'></span>

<h3>Description</h3>

<p>Natural Abundance deuterium isotope correction for one metabolite
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deuterium_isotope_correction(
  formula,
  datamatrix,
  label,
  Resolution,
  ResDefAt = 200,
  purity = 0.99,
  ReportPoolSize = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deuterium_isotope_correction_+3A_formula">formula</code></td>
<td>
<p>String representing molecular formula</p>
</td></tr>
<tr><td><code id="deuterium_isotope_correction_+3A_datamatrix">datamatrix</code></td>
<td>
<p>Matrix of abundances for each sample for each isotope</p>
</td></tr>
<tr><td><code id="deuterium_isotope_correction_+3A_label">label</code></td>
<td>
<p>vector of integer labels</p>
</td></tr>
<tr><td><code id="deuterium_isotope_correction_+3A_resolution">Resolution</code></td>
<td>
<p>For Exactive, the Resolution is 100000, defined at Mw 200</p>
</td></tr>
<tr><td><code id="deuterium_isotope_correction_+3A_resdefat">ResDefAt</code></td>
<td>
<p>Resolution defined at (in Mw), e.g. 200 Mw</p>
</td></tr>
<tr><td><code id="deuterium_isotope_correction_+3A_purity">purity</code></td>
<td>
<p>Deuterium purity, default: 0.99</p>
</td></tr>
<tr><td><code id="deuterium_isotope_correction_+3A_reportpoolsize">ReportPoolSize</code></td>
<td>
<p>default: TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list of matrices: 'Corrected', 'Normalized',
'PoolBeforeDF', and 'PoolAfterDF'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
deuterium_isotope_correction(
  formula = "C6H13O9P",
  datamatrix = DataMatrix,
  label = c(0, 1),
  Resolution = 100000
)

## End(Not run)
</code></pre>

<hr>
<h2 id='natural_abundance_correction'>Natural Abundance correction for mass spectrometry data</h2><span id='topic+natural_abundance_correction'></span>

<h3>Description</h3>

<p><code>natural_abundance_correction</code> returns the corrected and normalized
intensities of isotopically labeled mass spectrometry data. It was designed
to work with input data from
<a href="https://elucidatainc.github.io/ElMaven/">El-MAVEN</a> and
<a href="https://github.com/eugenemel/maven">MAVEN</a> software.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>natural_abundance_correction(
  data,
  sheet = NULL,
  compound_database = NULL,
  output_base = NULL,
  output_filetype = "xlsx",
  columns_to_skip = NULL,
  resolution,
  resolution_defined_at = 200,
  purity = NULL,
  report_pool_size_before_df = FALSE,
  path = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="natural_abundance_correction_+3A_data">data</code></td>
<td>
<p>Path to input data file (xlsx, xls, csv, txt, or tsv) OR
dataframe. If dataframe is specified, specify output_base to output files
automatically written.</p>
</td></tr>
<tr><td><code id="natural_abundance_correction_+3A_sheet">sheet</code></td>
<td>
<p>Name of sheet in xlsx file with columns 'compound',
'formula', 'isotopelabel', and one column per sample. Defaults to the
first sheet.</p>
</td></tr>
<tr><td><code id="natural_abundance_correction_+3A_compound_database">compound_database</code></td>
<td>
<p>Path to compound database in csv format. Only used
for classic MAVEN style input when formula is not specified.</p>
</td></tr>
<tr><td><code id="natural_abundance_correction_+3A_output_base">output_base</code></td>
<td>
<p>Path to basename of output file, default is the basename
of the input path. '_corrected' will be appended. If 'FALSE' then no
output file is written.</p>
</td></tr>
<tr><td><code id="natural_abundance_correction_+3A_output_filetype">output_filetype</code></td>
<td>
<p>Filetype of the output file, one of: 'xls', xlsx',
'csv', or 'tsv'. The default is 'xlsx'.</p>
</td></tr>
<tr><td><code id="natural_abundance_correction_+3A_columns_to_skip">columns_to_skip</code></td>
<td>
<p>Specify column heading to skip. All other columns not
named 'compound', 'formula', and 'isotopelabel' will be assumed to be
sample names.</p>
</td></tr>
<tr><td><code id="natural_abundance_correction_+3A_resolution">resolution</code></td>
<td>
<p>For Exactive, the resolution is 100000, defined at Mw 200</p>
</td></tr>
<tr><td><code id="natural_abundance_correction_+3A_resolution_defined_at">resolution_defined_at</code></td>
<td>
<p>Mw at which the resolution is defined, default
200 Mw</p>
</td></tr>
<tr><td><code id="natural_abundance_correction_+3A_purity">purity</code></td>
<td>
<p>Isotope purity, default: Carbon 0.99; Deuterium 0.98;
Nitrogen 0.99</p>
</td></tr>
<tr><td><code id="natural_abundance_correction_+3A_report_pool_size_before_df">report_pool_size_before_df</code></td>
<td>
<p>Report PoolSizeBeforeDF, default = FALSE</p>
</td></tr>
<tr><td><code id="natural_abundance_correction_+3A_path">path</code></td>
<td>
<p>Deprecated. Specify path to input data file (alias for 'data').</p>
</td></tr>
</table>


<h3>Details</h3>

<p>C13, H2, and N15 isotopes are supported. The isotopes are detected from the
<code>isotopeLabel</code> column of the input file. The expected label text is
<code>C13-label-#</code>. <code>D-label-#</code>. or <code>N15-label-#</code>. Parent
(unlabeled) compounds are specified by <code>C12 PARENT</code>.
</p>


<h3>Value</h3>

<p>Named list of matrices: 'Corrected', 'Normalized',
'PoolBeforeDF', and 'PoolAfterDF'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
natural_abundance_correction("inst/extdata/C_Sample_Input_Simple.xlsx",
  Resolution = 100000, ResDefAt = 200
)

## End(Not run)
</code></pre>

<hr>
<h2 id='nitrogen_isotope_correction'>Natural Abundance deuterium isotope correction for one metabolite</h2><span id='topic+nitrogen_isotope_correction'></span>

<h3>Description</h3>

<p>Natural Abundance deuterium isotope correction for one metabolite
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nitrogen_isotope_correction(
  formula,
  datamatrix,
  label,
  Resolution,
  ResDefAt = 200,
  purity = 0.99,
  ReportPoolSize = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nitrogen_isotope_correction_+3A_formula">formula</code></td>
<td>
<p>String representing molecular formula</p>
</td></tr>
<tr><td><code id="nitrogen_isotope_correction_+3A_datamatrix">datamatrix</code></td>
<td>
<p>Matrix of abundances for each sample for each isotope</p>
</td></tr>
<tr><td><code id="nitrogen_isotope_correction_+3A_label">label</code></td>
<td>
<p>vector of integer labels</p>
</td></tr>
<tr><td><code id="nitrogen_isotope_correction_+3A_resolution">Resolution</code></td>
<td>
<p>For Exactive, the Resolution is 100000, defined at Mw 200</p>
</td></tr>
<tr><td><code id="nitrogen_isotope_correction_+3A_resdefat">ResDefAt</code></td>
<td>
<p>Resolution defined at (in Mw), e.g. 200 Mw</p>
</td></tr>
<tr><td><code id="nitrogen_isotope_correction_+3A_purity">purity</code></td>
<td>
<p>Nitrogen purity, default: 0.99</p>
</td></tr>
<tr><td><code id="nitrogen_isotope_correction_+3A_reportpoolsize">ReportPoolSize</code></td>
<td>
<p>default: TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list of matrices: 'Corrected', 'Normalized',
'PoolBeforeDF', and 'PoolAfterDF'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
nitrogen_isotope_correction(
  formula = "C23H38N7O17P3S",
  datamatrix = DataMatrix,
  label = c(0, 1, 2, 3, 4, 5, 6, 7),
  Resolution = 140000
)

## End(Not run)
</code></pre>

<hr>
<h2 id='read_elmaven'>Natural Abundance correction for Carbon labeled samples</h2><span id='topic+read_elmaven'></span>

<h3>Description</h3>

<p>Natural Abundance correction for Carbon labeled samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_elmaven(
  path,
  sheet = NULL,
  compound_database = NULL,
  columns_to_skip = NULL,
  filetype = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_elmaven_+3A_path">path</code></td>
<td>
<p>Path to input file.</p>
</td></tr>
<tr><td><code id="read_elmaven_+3A_sheet">sheet</code></td>
<td>
<p>Name of sheet in xlsx file with columns 'compound',
'formula', 'isotopelabel', and one column per sample. Defaults to the
first sheet.</p>
</td></tr>
<tr><td><code id="read_elmaven_+3A_compound_database">compound_database</code></td>
<td>
<p>Path to compound database in csv format. Only used
for classic MAVEN style input when formula is not specified.</p>
</td></tr>
<tr><td><code id="read_elmaven_+3A_columns_to_skip">columns_to_skip</code></td>
<td>
<p>Specify column heading to skip. All other columns not
named 'compound', 'formula', and 'isotopelabel' will be assumed to be
sample names.</p>
</td></tr>
<tr><td><code id="read_elmaven_+3A_filetype">filetype</code></td>
<td>
<p>Specify file type, default is to determine by file extension.</p>
</td></tr>
<tr><td><code id="read_elmaven_+3A_...">...</code></td>
<td>
<p>Pass additional parameters to readxl::read_excel</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing three items: &quot;original&quot; data.frame which is result
of read_excel, &quot;cleaned&quot; data.frame which with columns 'compound',
'formula', 'isotope_label', label_index', followed by columns for each
sample, and &quot;isotope&quot; which is a character indicating the isotope
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
read_elmaven_xlsx("ExcelFile", "Sheet1")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
