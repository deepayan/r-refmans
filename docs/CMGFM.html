<!DOCTYPE html><html><head><title>Help for package CMGFM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CMGFM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CMGFM'><p>Fit the CMGFM model</p></a></li>
<li><a href='#gendata_cmgfm'><p>Generate simulated data</p></a></li>
<li><a href='#MSVR'><p>Select the number of factors</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Covariate-Augumented Generalized Factor Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-06-21</td>
</tr>
<tr>
<td>Author:</td>
<td>Wei Liu [aut, cre],
  Jiakun Jiang [aut],
  Dewei Xiang [aut],
  Xuancheng Zhou [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wei Liu &lt;LiuWeideng@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Covariate-augumented generalized factor model is designed to account for cross-modal heterogeneity, capture nonlinear dependencies among the data, incorporate additional information, and provide excellent interpretability while maintaining high computational efficiency.</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/feiyoung/CMGFM/issues">https://github.com/feiyoung/CMGFM/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>irlba, R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, stats, GFM, Rcpp (&ge; 1.0.10)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-25 04:40:10 UTC; 10297</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-25 15:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='CMGFM'>Fit the CMGFM model</h2><span id='topic+CMGFM'></span>

<h3>Description</h3>

<p>Fit the covariate-augumented generalized factor model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CMGFM(
  XList,
  Z,
  types,
  numvarmat,
  q = 15,
  Alist = NULL,
  init = c("LFM", "GFM", "random"),
  maxIter = 30,
  epsELBO = 1e-08,
  verbose = TRUE,
  add_IC_iter = FALSE,
  seed = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CMGFM_+3A_xlist">XList</code></td>
<td>
<p>a list consisting of multiple matrices in which each matrix has the same type of values, i.e., continuous, or count, or binomial/binary values.</p>
</td></tr>
<tr><td><code id="CMGFM_+3A_z">Z</code></td>
<td>
<p>a matrix, the fixed-dimensional covariate matrix with control variables.</p>
</td></tr>
<tr><td><code id="CMGFM_+3A_types">types</code></td>
<td>
<p>a string vector, specify the variable type in each matrix in <code>XList</code>;</p>
</td></tr>
<tr><td><code id="CMGFM_+3A_numvarmat">numvarmat</code></td>
<td>
<p>a <code>length(types)</code>-by-d matrix, specify the number of variables in modalities that belong to the same type.</p>
</td></tr>
<tr><td><code id="CMGFM_+3A_q">q</code></td>
<td>
<p>an optional string, specify the number of factors; default as 15.</p>
</td></tr>
<tr><td><code id="CMGFM_+3A_alist">Alist</code></td>
<td>
<p>an optional vector, the offset for each unit; default as full-zero vector.</p>
</td></tr>
<tr><td><code id="CMGFM_+3A_init">init</code></td>
<td>
<p>an optional character, specify the method in initialization.</p>
</td></tr>
<tr><td><code id="CMGFM_+3A_maxiter">maxIter</code></td>
<td>
<p>the maximum iteration of the VEM algorithm. The default is 30.</p>
</td></tr>
<tr><td><code id="CMGFM_+3A_epselbo">epsELBO</code></td>
<td>
<p>an optional positive value, tolerance of relative variation rate of the evidence lower bound value, default as '1e-8'.</p>
</td></tr>
<tr><td><code id="CMGFM_+3A_verbose">verbose</code></td>
<td>
<p>a logical value, whether output the information in iteration.</p>
</td></tr>
<tr><td><code id="CMGFM_+3A_add_ic_iter">add_IC_iter</code></td>
<td>
<p>a logical value, add the identifiability condition in iterative algorithm or add it after algorithm converges; default as FALSE.</p>
</td></tr>
<tr><td><code id="CMGFM_+3A_seed">seed</code></td>
<td>
<p>an integer, set the random seed in initialization, default as 1;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>None
</p>


<h3>Value</h3>

<p>return a list including the following components:
</p>

<ul>
<li> <p><code>betaf</code> - the estimated regression coefficient vector for each modality; 
</p>
</li>
<li> <p><code>Bf</code> - the estimated loading matrix for each modality; 
</p>
</li>
<li> <p><code>M</code> - the estimated modality-shared factor matrix; 
</p>
</li>
<li> <p><code>Xif</code> - the estimated modality-specified factor vector;
</p>
</li>
<li> <p><code>S</code> - the estimated covariance matrix of modality-shared latent factors;
</p>
</li>
<li> <p><code>Om</code> - the posterior variance of modality-specified latent factors;
</p>
</li>
<li> <p><code>muf</code> - the estimated intercept vector for each modality;
</p>
</li>
<li> <p><code>Sigmam</code> - the variance of modality-specified factors;
</p>
</li>
<li> <p><code>invLambdaf</code> - the inverse of the estimated variances of error for each modality.
</p>
</li>
<li> <p><code>ELBO</code> -  the ELBO value when algorithm stops;
</p>
</li>
<li> <p><code>ELBO_seq</code> - the sequence of ELBO values.
</p>
</li>
<li> <p><code>time_use</code> - the running time in model fitting;
</p>
</li></ul>



<h3>References</h3>

<p>None
</p>


<h3>See Also</h3>

<p>None
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pveclist &lt;- list('gaussian'=c(50, 150),'poisson'=c(50, 150),
   'binomial'=c(100,60))
q &lt;- 6
sigmavec &lt;- rep(1,3)
pvec &lt;- unlist(pveclist)
datlist &lt;- gendata_cmgfm(pveclist = pveclist, seed = 1, n = 300,d = 3,
                         q = q, rho = rep(1,length(pveclist)), rho_z=0.2,
                         sigmavec=sigmavec, sigma_eps=1)
XList &lt;- datlist$XList
Z &lt;- datlist$Z
numvarmat &lt;- datlist$numvarmat
types &lt;- datlist$types
rlist &lt;- CMGFM(XList, Z, types=types, numvarmat, q=q)
str(rlist)

</code></pre>

<hr>
<h2 id='gendata_cmgfm'>Generate simulated data</h2><span id='topic+gendata_cmgfm'></span>

<h3>Description</h3>

<p>Generate simulated data from covariate-augumented generalized factor model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gendata_cmgfm(
  seed = 1,
  n = 300,
  pveclist = list(gaussian = c(50, 150), poisson = c(50), binomial = c(100, 60)),
  q = 6,
  d = 3,
  rho = rep(1, length(pveclist)),
  rho_z = 1,
  sigmavec = rep(0.5, length(pveclist)),
  n_bin = 1,
  sigma_eps = 1,
  seed.para = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gendata_cmgfm_+3A_seed">seed</code></td>
<td>
<p>a positive integer, the random seed for reproducibility of data generation process.</p>
</td></tr>
<tr><td><code id="gendata_cmgfm_+3A_n">n</code></td>
<td>
<p>a positive integer, specify the sample size.</p>
</td></tr>
<tr><td><code id="gendata_cmgfm_+3A_pveclist">pveclist</code></td>
<td>
<p>a named list, specify the number of modalities for each variable type and dimension of variables in each modality.</p>
</td></tr>
<tr><td><code id="gendata_cmgfm_+3A_q">q</code></td>
<td>
<p>a positive integer,  specify the number of modality-shared factors.</p>
</td></tr>
<tr><td><code id="gendata_cmgfm_+3A_d">d</code></td>
<td>
<p>a positive integer,  specify the dimension of covariate matrix.</p>
</td></tr>
<tr><td><code id="gendata_cmgfm_+3A_rho">rho</code></td>
<td>
<p>a numeric vector with length <code>length(pveclist)</code> and positive elements, specify the signal strength of loading matrix for each modality with the same variable type.</p>
</td></tr>
<tr><td><code id="gendata_cmgfm_+3A_rho_z">rho_z</code></td>
<td>
<p>a positive real, specify the signal strength of covariates.</p>
</td></tr>
<tr><td><code id="gendata_cmgfm_+3A_sigmavec">sigmavec</code></td>
<td>
<p>a positive vector with length <code>length(pveclist)</code>, the variance of modality-specified latent factors.</p>
</td></tr>
<tr><td><code id="gendata_cmgfm_+3A_n_bin">n_bin</code></td>
<td>
<p>a positive integer, specify the number of trails in Binomial distribution.</p>
</td></tr>
<tr><td><code id="gendata_cmgfm_+3A_sigma_eps">sigma_eps</code></td>
<td>
<p>a positive real, the variance of overdispersion error.</p>
</td></tr>
<tr><td><code id="gendata_cmgfm_+3A_seed.para">seed.para</code></td>
<td>
<p>a positive integer, the random seed for reproducibility of data generation process by fixing the regression coefficient vector and loading matrices.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>None
</p>


<h3>Value</h3>

<p>return a list including the following components:
</p>

<ul>
<li> <p><code>XList</code> - a list consisting of multiple matrices in which each matrix has the same type of values, i.e., continuous, or count, or binomial/binary values.
</p>
</li>
<li> <p><code>Z</code> - a matrix, the fixed-dimensional covariate matrix with control variables;
</p>
</li>
<li> <p><code>Alist</code> - the the offset vector for each modality; 
</p>
</li>
<li> <p><code>B0list</code> - the true loading matrix for each modality; 
</p>
</li>
<li> <p><code>mu0</code> - the true intercept vector for each modality;
</p>
</li>
<li> <p><code>U0</code> - the  modality-specified factor vector;
</p>
</li>
<li> <p><code>F0</code> -  the  modality-shared factor matrix; 
</p>
</li>
<li> <p><code>Uplist</code> - the true intercept-loading matrix for each modality;
</p>
</li>
<li> <p><code>beta</code> - the true regression coefficient vector for each modality; 
</p>
</li>
<li> <p><code>sigma_eps</code> -  the standard deviation of error term;
</p>
</li>
<li> <p><code>numvarmat</code> - a length(types)-by-d matrix, the number of variables in modalities that belong to the same type.
</p>
</li></ul>



<h3>References</h3>

<p>None
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CMGFM">CMGFM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 300; 
pveclist = list('gaussian'=c(50, 150),'poisson'=c(50),'binomial'=c(100,60))
d &lt;- 20; q &lt;- 6;
datlist &lt;- gendata_cmgfm(n=n, pveclist=pveclist, q=q, d=d)
str(datlist)
</code></pre>

<hr>
<h2 id='MSVR'>Select the number of factors</h2><span id='topic+MSVR'></span>

<h3>Description</h3>

<p>Select the number of factors using maximum singular value ratio based method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MSVR(
  XList,
  Z,
  types,
  numvarmat,
  Alist = NULL,
  q_max = 20,
  threshold = 1e-05,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MSVR_+3A_xlist">XList</code></td>
<td>
<p>a list consisting of multiple matrices in which each matrix has the same type of values, i.e., continuous, or count, or binomial/binary values.</p>
</td></tr>
<tr><td><code id="MSVR_+3A_z">Z</code></td>
<td>
<p>a matrix, the fixed-dimensional covariate matrix with control variables.</p>
</td></tr>
<tr><td><code id="MSVR_+3A_types">types</code></td>
<td>
<p>a string vector, specify the variable type in each matrix in <code>XList</code>;</p>
</td></tr>
<tr><td><code id="MSVR_+3A_numvarmat">numvarmat</code></td>
<td>
<p>a <code>length(types)</code>-by-d matrix, specify the number of variables in modalities that belong to the same type.</p>
</td></tr>
<tr><td><code id="MSVR_+3A_alist">Alist</code></td>
<td>
<p>an optional vector, the offset for each unit; default as full-zero vector.</p>
</td></tr>
<tr><td><code id="MSVR_+3A_q_max">q_max</code></td>
<td>
<p>an optional string, specify the maximum number of factors; default as 20.</p>
</td></tr>
<tr><td><code id="MSVR_+3A_threshold">threshold</code></td>
<td>
<p>an optional positive value, a cutoff to filter the singular values that are smaller than it.</p>
</td></tr>
<tr><td><code id="MSVR_+3A_...">...</code></td>
<td>
<p>other arguments passed to CMGFM</p>
</td></tr>
</table>


<h3>Details</h3>

<p>None
</p>


<h3>Value</h3>

<p>return the estimated number of factors.
</p>


<h3>References</h3>

<p>None
</p>


<h3>See Also</h3>

<p>None
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pveclist &lt;- list('gaussian'=c(50, 150),'poisson'=c(50, 150),
   'binomial'=c(100,60))
q &lt;- 6
sigmavec &lt;- rep(1,3)
pvec &lt;- unlist(pveclist)
datlist &lt;- gendata_cmgfm(pveclist = pveclist, seed = 1, n = 300,d = 3,
                         q = q, rho = rep(1,length(pveclist)), rho_z=0.2,
                         sigmavec=sigmavec, sigma_eps=1)
XList &lt;- datlist$XList
Z &lt;- datlist$Z
numvarmat &lt;- datlist$numvarmat
types &lt;- datlist$types
hq &lt;- MSVR(XList, Z, types=types, numvarmat, q_max=20)

print(c(q_true=q, q_est=hq))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
