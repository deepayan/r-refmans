<!DOCTYPE html><html lang="en"><head><title>Help for package mixpoissonreg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mixpoissonreg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Attendance'><p>Attendance Records data set</p></a></li>
<li><a href='#augment.mixpoissonreg'><p>Augment data with information from a <code>mixpoissonreg</code> object</p></a></li>
<li><a href='#autoplot.mixpoissonreg'><p>Autoplot Method for <code>mixpoissonreg</code> Objects</p></a></li>
<li><a href='#coef.mixpoissonreg'><p>Coef Method for <code>mixpoissonreg</code> Objects.</p></a></li>
<li><a href='#fitted.mixpoissonreg'><p>Fitted Method for <code>mixpoissonreg</code> Objects</p></a></li>
<li><a href='#glance.mixpoissonreg'><p>Glance at a <code>mixpoissonreg</code> object</p></a></li>
<li><a href='#influence.mixpoissonreg'><p>Global Influence Diagnostics for Mixed Poisson Regression Models</p></a></li>
<li><a href='#local_influence'><p>Local Influence Diagnostics</p></a></li>
<li><a href='#local_influence_autoplot.mixpoissonreg'><p>Local Influence Autoplots for <code>mixpoissonreg</code> Objects</p></a></li>
<li><a href='#local_influence_plot.mixpoissonreg'><p>Local Influence Plot Diagnostics for Mixed Poisson Regression Models</p></a></li>
<li><a href='#local_influence.mixpoissonreg'><p>Local Influence Diagnostics for Mixed Poisson Regression Models</p></a></li>
<li><a href='#logLik.mixpoissonreg'><p>logLik Method for <code>mixpoissonreg</code> Objects</p></a></li>
<li><a href='#mixpoissonreg'><p>Mixed Poisson Regression for Overdispersed Count Data</p></a></li>
<li><a href='#mixpoissonregML'><p>Maximum Likelihood Mixed Poisson Regression Models for Overdispersed Count Data</p></a></li>
<li><a href='#plot.mixpoissonreg'><p>Plot Diagnostics for <code>mixpoissonreg</code> Objects</p></a></li>
<li><a href='#predict.mixpoissonreg'><p>Predict Method for <code>mixpoissonreg</code> Objects</p></a></li>
<li><a href='#residuals.mixpoissonreg'><p>Residuals Method for <code>mixpoissonreg</code> Objects</p></a></li>
<li><a href='#summary.mixpoissonreg'><p>Summary Method for <code>mixpoissonreg</code> Objects.</p></a></li>
<li><a href='#tidy_local_influence'><p>Tidy Functions for Local Influence Diagnostics</p></a></li>
<li><a href='#tidy_local_influence.mixpoissonreg'><p>Tidy Functions for Local Influence Diagnostics for <code>mixpoissonreg</code> Objects</p></a></li>
<li><a href='#tidy.mixpoissonreg'><p>Tidy a <code>mixpoissonreg</code> object</p></a></li>
<li><a href='#vcov.mixpoissonreg'><p>Calculate Variance-Covariance Matrix for <code>mixpoissonreg</code> Objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Mixed Poisson Regression for Overdispersed Count Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alexandre B. Simas &lt;alexandre.impa@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits mixed Poisson regression models (Poisson-Inverse Gaussian or Negative-Binomial) on data sets with response variables being count data. The models can have varying precision parameter, where a linear regression structure (through a link function) is assumed to hold on the precision parameter. The Expectation-Maximization algorithm for both these models (Poisson Inverse Gaussian and Negative Binomial) is an important contribution of this package. Another important feature of this package is the set of functions to perform global and local influence analysis. See Barreto-Souza and Simas (2016) &lt;<a href="https://doi.org/10.1007%2Fs11222-015-9601-6">doi:10.1007/s11222-015-9601-6</a>&gt; for further details.  </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/vpnsctl/mixpoissonreg/">https://github.com/vpnsctl/mixpoissonreg/</a>,
<a href="https://vpnsctl.github.io/mixpoissonreg/">https://vpnsctl.github.io/mixpoissonreg/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/vpnsctl/mixpoissonreg/issues">https://github.com/vpnsctl/mixpoissonreg/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>pbapply, Formula, Rfast, dplyr, gamlss.dist, generics,
ggplot2, gridExtra, lmtest, magrittr, statmod, tibble, rlang,
ggrepel, gamlss</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, devtools, bbreg, testthat, covr, tidyr,
ggfortify, broom</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-03-08 16:00:16 UTC; debusta</td>
</tr>
<tr>
<td>Author:</td>
<td>Alexandre B. Simas
    <a href="https://orcid.org/0000-0003-2562-2829"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Wagner Barreto-Souza
    <a href="https://orcid.org/0000-0003-0831-7881"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-03-10 19:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='Attendance'>Attendance Records data set</h2><span id='topic+Attendance'></span>

<h3>Description</h3>

<p>School administrators study the attendance behavior of high school juniors at two schools.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Attendance")
</code></pre>


<h3>Format</h3>

<p>Data frame containing 314 observations on 4 variables.
</p>

<dl>
<dt>daysabs</dt><dd><p>number of days absent.</p>
</dd>
<dt>gender</dt><dd><p>gender of the student.</p>
</dd>
<dt>prog</dt><dd><p>three-level factor indicating the type of instructional program in which the student is enrolled.</p>
</dd>
<dt>math</dt><dd><p>standardized math score.</p>
</dd>
</dl>



<h3>Details</h3>

<p>School administrators study the attendance behavior of high school juniors at two schools. Predictors of the number of days of absence include the type of program in which
the student is enrolled and a standardized test in math. Attendance data on 314 high school juniors from two urban high schools.
The response variable of interest is days absent, <code>daysabs</code>. The variable <code>math</code> is the standardized math score for each student.
The variable <code>prog</code> is a three-level factor indicating the type of instructional program in which the student is enrolled.
</p>


<h3>Source</h3>

<p>Data can be obtained from <a href="https://github.com/tjfisher19/introStatModeling">Introduction to Statistical Modeling Github Repository</a>. See also <em>Barreto-Souza and Simas (2020)</em> for further details.
</p>


<h3>References</h3>

<p>Hughes, M. and Fisher, T. (2020)  <a href="http://www.users.miamioh.edu/fishert4/sta363/">Introduction to Statistical Modeling.</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Attendance", package = "mixpoissonreg")

daysabs_fit &lt;- mixpoissonregML(daysabs ~ gender + math + prog | gender + 
math + prog, data = Attendance)
summary(daysabs_fit)

</code></pre>

<hr>
<h2 id='augment.mixpoissonreg'>Augment data with information from a <code>mixpoissonreg</code> object</h2><span id='topic+augment.mixpoissonreg'></span><span id='topic+augment'></span>

<h3>Description</h3>

<p>Augment accepts a model object and a dataset and adds information about each observation in the dataset. It includes
predicted values in the <code>.fitted</code> column, residuals in the <code>.resid</code> column, and standard errors for the fitted values in a <code>.se.fit</code> column, if
the type of prediction is 'link'. New columns always begin with a . prefix to avoid overwriting columns in the original dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixpoissonreg'
augment(
  x,
  data = stats::model.frame(x),
  newdata = NULL,
  type.predict = c("response", "link", "precision", "variance"),
  type.residuals = c("pearson", "score"),
  se_fit = FALSE,
  conf_int = TRUE,
  pred_int = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="augment.mixpoissonreg_+3A_x">x</code></td>
<td>
<p>A <code>mixpoissonreg</code> object.</p>
</td></tr>
<tr><td><code id="augment.mixpoissonreg_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">base::data.frame</a></code> or <code><a href="tibble.html#topic+tibble">tibble::tibble()</a></code> containing the original data that was used to produce the object x.</p>
</td></tr>
<tr><td><code id="augment.mixpoissonreg_+3A_newdata">newdata</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">base::data.frame</a></code> or <code><a href="tibble.html#topic+tibble">tibble::tibble()</a></code> containing all the original predictors used to create x.
Defaults to <code>NULL</code>, indicating that nothing has been passed to <code>newdata</code>. If <code>newdata</code> is specified, the data argument will be ignored.</p>
</td></tr>
<tr><td><code id="augment.mixpoissonreg_+3A_type.predict">type.predict</code></td>
<td>
<p>Type of prediction. The options are 'response', 'link', 'precision' and 'variance'. The default is &quot;response&quot;.</p>
</td></tr>
<tr><td><code id="augment.mixpoissonreg_+3A_type.residuals">type.residuals</code></td>
<td>
<p>Type of residuals. The options are 'pearson' and 'score'. The default is 'pearson'.</p>
</td></tr>
<tr><td><code id="augment.mixpoissonreg_+3A_se_fit">se_fit</code></td>
<td>
<p>Logical indicating whether or not a .se.fit column should be added to the augmented output. If TRUE, it only returns a non-NA value if type of prediction is 'link'.</p>
</td></tr>
<tr><td><code id="augment.mixpoissonreg_+3A_conf_int">conf_int</code></td>
<td>
<p>Logical indicating whether or not confidence intervals for the fitted variable with type chosen from type.predict should be built. The available type options are
'response' and 'link'.</p>
</td></tr>
<tr><td><code id="augment.mixpoissonreg_+3A_pred_int">pred_int</code></td>
<td>
<p>Logical indicating whether or not prediction intervals for future observations should be built. It only works with type.predict = 'response'. The arguments
<code>level</code>, <code>nsim_pred</code>, <code>nsim_pred_y</code> are passed through additional arguments '...'. Notice that this can be computationally intensive.</p>
</td></tr>
<tr><td><code id="augment.mixpoissonreg_+3A_...">...</code></td>
<td>
<p>Additional arguments. Possible additional arguments are <code>level</code>, <code>nsim_pred</code>, <code>nsim_pred_y</code>, that are passed to <code>predict.mixpoissonreg</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="tibble.html#topic+tibble">tibble::tibble()</a></code> with columns:
</p>

<ul>
<li> <p><code>.cooksd</code> Cook's distance.
</p>
</li>
<li> <p><code>.fitted</code> Fitted or predicted value.
</p>
</li>
<li> <p><code>.fittedlwrconf</code> Lower bound of the confidence interval, if conf_int = TRUE
</p>
</li>
<li> <p><code>.fitteduprconf</code> Upper bound of the confidence interval, if conf_int = TRUE
</p>
</li>
<li> <p><code>.fittedlwrpred</code> Lower bound of the prediction interval, if pred_int = TRUE
</p>
</li>
<li> <p><code>.fitteduprpred</code> Upper bound of the prediction interval, if pred_int = TRUE
</p>
</li>
<li> <p><code>.hat</code> Diagonal of the hat matrix.
</p>
</li>
<li> <p><code>.resid</code> The chosen residual.
</p>
</li>
<li> <p><code>.resfit</code> The chosen residual of the fitted object.
</p>
</li>
<li> <p><code>.se.fit</code> Standard errors of fitted values, if se_fit = TRUE.
</p>
</li>
<li> <p><code>.gencooksd</code> Generalized Cook's distance.
</p>
</li>
<li> <p><code>.lwrenv</code> Lower bound of the simulated envelope, if the fitted <code>mixpoissonreg</code> object, was fitted with envelopes &gt; 0.
</p>
</li>
<li> <p><code>.mdnenv</code> Median of the simulated envelope, if the fitted <code>mixpoissonreg</code> object, was fitted with envelopes &gt; 0.
</p>
</li>
<li> <p><code>.uprenv</code> Upper bound of the simulated envelope, if the fitted <code>mixpoissonreg</code> object, was fitted with envelopes &gt; 0.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+glance.mixpoissonreg">glance.mixpoissonreg</a></code>, <code><a href="#topic+tidy.mixpoissonreg">tidy.mixpoissonreg</a></code>, <code><a href="#topic+tidy_local_influence.mixpoissonreg">tidy_local_influence.mixpoissonreg</a></code>,
<code><a href="#topic+autoplot.mixpoissonreg">autoplot.mixpoissonreg</a></code>, <code><a href="#topic+local_influence_autoplot.mixpoissonreg">local_influence_autoplot.mixpoissonreg</a></code>
</p>

<hr>
<h2 id='autoplot.mixpoissonreg'>Autoplot Method for <code>mixpoissonreg</code> Objects</h2><span id='topic+autoplot.mixpoissonreg'></span><span id='topic+autoplot'></span>

<h3>Description</h3>

<p>This function provides <span class="pkg">ggplot2</span>-based counterparts to the plots produced by <code><a href="#topic+plot.mixpoissonreg">plot.mixpoissonreg</a></code>.
Currently there are six plots available. They contain residual analysis and global influence diagnostics. The plots are selectable by
the <code>which</code> argument. The plots are: Residuals vs. obs. numbers; Normal Q-Q plots, which may contain simulated envelopes, if the fitted object
has simulated envelopes; Cook's distances vs. obs. numbers; Generalized Cook's distances vs. obs. numbers; Cook's distances vs. Generalized Cook's distances;
Response variables vs. fitted means. By default, the first two plots and the last two plots are provided.
</p>
<p>If both ncol and nrow are <code>NULL</code>, the plots will be placed one at a time. To place multiple plots, set the values for <code>nrow</code> or <code>ncol</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixpoissonreg'
autoplot(
  object,
  which = c(1, 2, 5, 6),
  title = list("Residuals vs Obs. number", "Normal Q-Q", "Cook's distance",
    "Generalized Cook's distance", "Cook's dist vs Generalized Cook's dist",
    "Response vs Fitted means"),
  title.bold = FALSE,
  title.size = NULL,
  title.colour = NULL,
  label.repel = TRUE,
  x.axis.col = NULL,
  y.axis.col = NULL,
  x.axis.size = NULL,
  y.axis.size = NULL,
  cook.plot.type = "linerange",
  cook.plot.pointshape = NULL,
  nrow = NULL,
  ncol = NULL,
  qqline = TRUE,
  ask = prod(graphics::par("mfcol")) &lt; length(which) &amp;&amp; grDevices::dev.interactive(),
  include.modeltype = TRUE,
  include.residualtype = FALSE,
  sub.caption = NULL,
  sub.caption.col = NULL,
  sub.caption.size = NULL,
  sub.caption.face = NULL,
  sub.caption.hjust = 0.5,
  env_alpha = 0.5,
  env_fill = "grey70",
  gpar_sub.caption = list(fontface = "bold"),
  colour = "#444444",
  size = NULL,
  linetype = NULL,
  alpha = NULL,
  fill = NULL,
  shape = NULL,
  label = TRUE,
  label.label = NULL,
  label.colour = "#000000",
  label.alpha = NULL,
  label.size = NULL,
  label.angle = NULL,
  label.family = NULL,
  label.fontface = NULL,
  label.lineheight = NULL,
  label.hjust = NULL,
  label.vjust = NULL,
  label.n = 3,
  ad.colour = "#888888",
  ad.linetype = "dashed",
  ad.size = 0.2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="autoplot.mixpoissonreg_+3A_object">object</code></td>
<td>
<p>A <code>mixpoissonreg</code> object.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_which">which</code></td>
<td>
<p>a list or vector indicating which plots should be displayed.     If a subset of the plots is required, specify a subset of the numbers 1:6,
see title below for the different kinds. In
plot number 2, 'Normal Q-Q', if the <code>mixpoissonreg</code> object was fitted with envelopes, a quantile-quantile plot with simulated envelopes will be displayed.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_title">title</code></td>
<td>
<p>titles to appear above the plots; character vector or list of valid graphics annotations. Can be set to &quot;&quot; to suppress all titles.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_title.bold">title.bold</code></td>
<td>
<p>logical indicating whether the titles should be bold. The default is FALSE.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_title.size">title.size</code></td>
<td>
<p>numerical indicating the size of the titles.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_title.colour">title.colour</code></td>
<td>
<p>title colour.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_label.repel">label.repel</code></td>
<td>
<p>Logical flag indicating whether to use <span class="pkg">ggrepel</span> to place the labels.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_x.axis.col">x.axis.col</code></td>
<td>
<p>colour of the x axis title.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_y.axis.col">y.axis.col</code></td>
<td>
<p>colour of the y axis title.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_x.axis.size">x.axis.size</code></td>
<td>
<p>size of the x axis title.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_y.axis.size">y.axis.size</code></td>
<td>
<p>size of the y axis title.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_cook.plot.type">cook.plot.type</code></td>
<td>
<p>character indicating the type of plot for Cook's distance
and generalized Cook's distance. Default is &quot;linerange&quot;. The options are &quot;linerange&quot; and &quot;points&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_cook.plot.pointshape">cook.plot.pointshape</code></td>
<td>
<p>the shape of points if &quot;cook.plot.type&quot; is set to &quot;points&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_nrow">nrow</code></td>
<td>
<p>Number of facet/subplot rows. If both <code>nrow</code> and <code>ncol</code> are <code>NULL</code>, the plots will be placed one at a time. For multiple plots, set values for <code>nrow</code>
or <code>ncol</code>.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_ncol">ncol</code></td>
<td>
<p>Number of facet/subplot columns. If both <code>nrow</code> and <code>ncol</code> are <code>NULL</code>, the plots will be placed one at a time. For multiple plots, set values for <code>nrow</code>
or <code>ncol</code>.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_qqline">qqline</code></td>
<td>
<p>logical; if <code>TRUE</code> and the fit does <em>not</em> contain simulated
envelopes, a qqline passing through the first and third quartiles of a standard normal distribution will be added to the normal Q-Q plot.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_ask">ask</code></td>
<td>
<p>logical; if <code>TRUE</code>, the user is asked before each plot.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_include.modeltype">include.modeltype</code></td>
<td>
<p>logical. Indicates whether the model type ('NB' or 'PIG') should be displayed on the titles.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_include.residualtype">include.residualtype</code></td>
<td>
<p>local. Indicates whether the name of the residual ('Pearson' or 'Score') should be displayed on the title of plot 1 (Residuals vs. Index).</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_sub.caption">sub.caption</code></td>
<td>
<p>common title-above the figures if there are more than one. If NULL, as by default, a possible abbreviated version of <code>deparse(x$call)</code> is used.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_sub.caption.col">sub.caption.col</code></td>
<td>
<p>color of subcaption (when one figure at a time).</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_sub.caption.size">sub.caption.size</code></td>
<td>
<p>size of subcaption (when one figure at a time).</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_sub.caption.face">sub.caption.face</code></td>
<td>
<p>font face for subcaption, options are: &quot;plain&quot;, &quot;bold&quot;, &quot;italic&quot; and &quot;bold.italic&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_sub.caption.hjust">sub.caption.hjust</code></td>
<td>
<p>indicates the position of the subcaption (when one figure at a time). The
default is 0.5, which indicates that the subcaption is centered, a value 0 places the subcaption
at the left side of the plot whereas a value of 1 places the subcaption at the right side of the plot.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_env_alpha">env_alpha</code></td>
<td>
<p>alpha of the envelope region (when the fitted model has envelopes)</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_env_fill">env_fill</code></td>
<td>
<p>the colour of the filling in the envelopes.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_gpar_sub.caption">gpar_sub.caption</code></td>
<td>
<p>list of gpar parameters to be used as common title in the case of multiple plots. The title will be given in sub.caption argument. See
the help of <code><a href="grid.html#topic+gpar">gpar</a></code> function from the <span class="pkg">grid</span> package for all the available options.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_colour">colour</code></td>
<td>
<p>line colour.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_size">size</code></td>
<td>
<p>point size.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_linetype">linetype</code></td>
<td>
<p>line type.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_alpha">alpha</code></td>
<td>
<p>alpha of the plot.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_fill">fill</code></td>
<td>
<p>fill colour.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_shape">shape</code></td>
<td>
<p>point shape.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_label">label</code></td>
<td>
<p>Logical value whether to display labels.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_label.label">label.label</code></td>
<td>
<p>vector of labels. If <code>NULL</code>, rownames will be used as labels.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_label.colour">label.colour</code></td>
<td>
<p>Colour for text labels.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_label.alpha">label.alpha</code></td>
<td>
<p>Alpha for text labels.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_label.size">label.size</code></td>
<td>
<p>Size for text labels.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_label.angle">label.angle</code></td>
<td>
<p>Angle for text labels.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_label.family">label.family</code></td>
<td>
<p>Font family for text labels.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_label.fontface">label.fontface</code></td>
<td>
<p>Fontface for text labels.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_label.lineheight">label.lineheight</code></td>
<td>
<p>Lineheight for text labels.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_label.hjust">label.hjust</code></td>
<td>
<p>Horizontal adjustment for text labels.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_label.vjust">label.vjust</code></td>
<td>
<p>Vertical adjustment for text labels.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_label.n">label.n</code></td>
<td>
<p>Number of points to be laeled in each plot, starting with the most extreme.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_ad.colour">ad.colour</code></td>
<td>
<p>Line colour for additional lines.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_ad.linetype">ad.linetype</code></td>
<td>
<p>Line type for additional lines.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_ad.size">ad.size</code></td>
<td>
<p>Fill colour for additional lines.</p>
</td></tr>
<tr><td><code id="autoplot.mixpoissonreg_+3A_...">...</code></td>
<td>
<p>other arguments passed to methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on <code>autoplot.lm</code> from the excellent <span class="pkg">ggfortify</span> package, <a href="https://github.com/sinhrks/ggfortify/">ggfortify</a>.
</p>
<p>sub.caption - by default the function call - is shown as a subtitle (under the x-axis title) on each plot when plots are on separate pages, or as a subtitle
in the outer margin when there are multiple plots per page.
</p>


<h3>Value</h3>

<p>Called for its side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>daysabs_prog &lt;- mixpoissonregML(daysabs ~ prog, data = Attendance)
autoplot(daysabs_prog)

</code></pre>

<hr>
<h2 id='coef.mixpoissonreg'>Coef Method for <code>mixpoissonreg</code> Objects.</h2><span id='topic+coef.mixpoissonreg'></span>

<h3>Description</h3>

<p>Extract model coefficients of fitted mixed Poisson regression models. The parameters arguments allows one to chose if all coefficients should be extracted,
with <code>parameters = 'all'</code>; if the coefficients of the mean-related parameters should be extracted, with <code>parameters = 'mean'</code>; if the coefficients of the
precision-related parameters should be extracted, with <code>parameters = 'precision'</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixpoissonreg'
coef(object, parameters = c("all", "mean", "precision"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.mixpoissonreg_+3A_object">object</code></td>
<td>
<p>object of class &quot;mixpoissonreg&quot; containing results from the fitted model.</p>
</td></tr>
<tr><td><code id="coef.mixpoissonreg_+3A_parameters">parameters</code></td>
<td>
<p>a string to determine which coefficients should be extracted: 'all' extracts all coefficients, 'mean' extracts the coefficients of the mean parameters and 'precision' extracts coefficients of the precision parameters.</p>
</td></tr>
<tr><td><code id="coef.mixpoissonreg_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the coefficients of a <em>mixpoissonreg</em> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vcov.mixpoissonreg">vcov.mixpoissonreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
daysabs_prog &lt;- mixpoissonreg(daysabs ~ prog, data = Attendance)
coef(daysabs_prog)

</code></pre>

<hr>
<h2 id='fitted.mixpoissonreg'>Fitted Method for <code>mixpoissonreg</code> Objects</h2><span id='topic+fitted.mixpoissonreg'></span>

<h3>Description</h3>

<p>Function providing the fitted means, linear predictors, precisions or variances for mixed Poisson regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixpoissonreg'
fitted(object, type = c("response", "link", "precision", "variance"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted.mixpoissonreg_+3A_object">object</code></td>
<td>
<p>object of class &quot;mixpoissonreg&quot; containing results from the fitted model.</p>
</td></tr>
<tr><td><code id="fitted.mixpoissonreg_+3A_type">type</code></td>
<td>
<p>the type of variable to get the fitted values. The default is the &quot;response&quot; type, which provided the estimated values for the means.
The type &quot;link&quot; provides the estimates for the linear predictor of the mean. The type &quot;precision&quot; provides estimates for the precision parameters
whereas the type &quot;variance&quot; provides estimates for the variances.</p>
</td></tr>
<tr><td><code id="fitted.mixpoissonreg_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the fitted values of a <em>mixpoissonreg</em> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.mixpoissonreg">predict.mixpoissonreg</a></code>, <code><a href="#topic+summary.mixpoissonreg">summary.mixpoissonreg</a></code>,
<code><a href="#topic+coef.mixpoissonreg">coef.mixpoissonreg</a></code>, <code><a href="#topic+vcov.mixpoissonreg">vcov.mixpoissonreg</a></code>,
<code><a href="#topic+plot.mixpoissonreg">plot.mixpoissonreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
daysabs_prog &lt;- mixpoissonreg(daysabs ~ prog, data = Attendance)
fitted(daysabs_prog)

</code></pre>

<hr>
<h2 id='glance.mixpoissonreg'>Glance at a <code>mixpoissonreg</code> object</h2><span id='topic+glance.mixpoissonreg'></span><span id='topic+glance'></span>

<h3>Description</h3>

<p>Glance accepts a <code>mixpoissonreg</code> object and returns a
<code><a href="tibble.html#topic+tibble">tibble::tibble()</a></code> with exactly one row of model summaries.
The summaries are Efron's pseudo-<code class="reqn">R^2</code>, degrees of freedom, AIC, BIC, log-likelihood,
the type of model used in the fit ('NB' or 'PIG'), the total number of observations and the estimation method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixpoissonreg'
glance(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glance.mixpoissonreg_+3A_x">x</code></td>
<td>
<p>A <code>mixpoissonreg</code> object.</p>
</td></tr>
<tr><td><code id="glance.mixpoissonreg_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="tibble.html#topic+tibble">tibble::tibble()</a></code> with exactly one row and columns:
</p>

<ul>
<li> <p><code>efron.pseudo.r2</code> Efron's pseudo-<code class="reqn">R^2</code>, that is, the squared correlation between the fitted values and the response values.
</p>
</li>
<li> <p><code>df.null</code> Degrees of freedom used by the null model.
</p>
</li>
<li> <p><code>logLik</code> The log-likelihood of the model.
</p>
</li>
<li> <p><code>AIC</code> Akaike's Information Criterion for the model.
</p>
</li>
<li> <p><code>BIC</code> Bayesian Information Criterion for the model.
</p>
</li>
<li> <p><code>df.residual</code> Residual degrees of freedom.
</p>
</li>
<li> <p><code>nobs</code> Number of observations used.
</p>
</li>
<li> <p><code>model.type</code> Type of model fitted, &quot;NB&quot; or &quot;PIG&quot;.
</p>
</li>
<li> <p><code>est.method</code> The estimation method of the fitted model, &quot;EM&quot; or &quot;ML&quot;.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+augment.mixpoissonreg">augment.mixpoissonreg</a></code>, <code><a href="#topic+tidy.mixpoissonreg">tidy.mixpoissonreg</a></code>, <code><a href="#topic+tidy_local_influence.mixpoissonreg">tidy_local_influence.mixpoissonreg</a></code>,
<code><a href="#topic+autoplot.mixpoissonreg">autoplot.mixpoissonreg</a></code>, <code><a href="#topic+local_influence_autoplot.mixpoissonreg">local_influence_autoplot.mixpoissonreg</a></code>
</p>

<hr>
<h2 id='influence.mixpoissonreg'>Global Influence Diagnostics for Mixed Poisson Regression Models</h2><span id='topic+influence.mixpoissonreg'></span><span id='topic+hatvalues.mixpoissonreg'></span><span id='topic+cooks.distance.mixpoissonreg'></span>

<h3>Description</h3>

<p>These functions provides global influence diagnostic quantities such as Cook's distance, hat values, generalized Cook's distance (through argument
on <code>cooks.distance.mixpoissonreg</code> function), likelihood displacement (through argument
on <code>cooks.distance.mixpoissonreg</code> function) and Q-displacement (through argument
on <code>cooks.distance.mixpoissonreg</code> function).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixpoissonreg'
hatvalues(model, parameters = c("mean", "precision"), ...)

## S3 method for class 'mixpoissonreg'
cooks.distance(
  model,
  type = c("CD", "GCD", "GCDmean", "GCDprecision", "LD", "QD"),
  hat = c("mean", "precision"),
  ...
)

## S3 method for class 'mixpoissonreg'
influence(model, do.coef = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="influence.mixpoissonreg_+3A_model">model</code></td>
<td>
<p>a <code>mixpoissonreg</code> object.</p>
</td></tr>
<tr><td><code id="influence.mixpoissonreg_+3A_parameters">parameters</code></td>
<td>
<p>the parameter to which the hat values will be computed. The options are 'mean' and 'precision'. The default is 'mean'. For hatvalues with respect to the mean
the model must be fitted with 'x' set to TRUE, and for hatvalues with respect to the precision the model must be fitted with 'w' set to TRUE.</p>
</td></tr>
<tr><td><code id="influence.mixpoissonreg_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="influence.mixpoissonreg_+3A_type">type</code></td>
<td>
<p>the type of Cook's distance to be used. The options are 'CD', the standard Cook's distance;
'GCD', the generalized Cook's distance with respect to all parameters, Zhu et al. (2001);
'GCDmean', the generalized Cook's distance with respect to the mean parameters;
'GCDprecision', the generalized Cook's distance with respect to the precision parameters;
'LD', the likelihood displacement (also known as likelihood distance), see Cook and Weisberg (1982); 'QD', the Q-displacement, see Zhu et al. (2001).
See 'details' for more informations. For 'GCD', 'GCDmean', 'LD' and 'QD', the model must be fitted with 'x' set to TRUE,
and for 'GCD', 'GCDprecision', 'LD' and 'QD', the model must be fitted with 'w' set to TRUE. For 'CD', if 'hat' is set to 'mean',
the model must be fitted with 'x' set to TRUE, whereas
if 'hat' is set to 'precision', the model must be fitted with 'w' set to TRUE.</p>
</td></tr>
<tr><td><code id="influence.mixpoissonreg_+3A_hat">hat</code></td>
<td>
<p>hat values <code>H[i,i]</code>. The default is obtained through the second-derivative of the Q-function in the spirit of Zhu et al. (2001) and Pregibon (1981), see details.</p>
</td></tr>
<tr><td><code id="influence.mixpoissonreg_+3A_do.coef">do.coef</code></td>
<td>
<p>logical indicating if the the approximation to the change of coefficients values after case removal are desired. The model must be fitted with x = TRUE. See details for further explanations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For hat values of mixed Poisson regression models, we follow Zhu et al. (2001) to consider the negative of the hessian of the Q-function as weight matrix, and follow
Pregibon (1981) to define the 'hat' matrix with respect to this weight matrix. We can consider the hessian of the Q-function with respect to mean-related parameters,
which is the default. We can also consider the hessian of the Q-function with respect to the precision-related parameters to give rise to hat values related to the precision
parameters.
</p>
<p>The Generalized Cook's distance and Q-displacement for EM-based models were defined in Zhu et al. (2001) and computed for mixed Poisson regression models
in Barreto-Souza and Simas (2016). We implemented first-order approximation to these quantities to make it computationally feasible. These first-order approximations
are available in Barreto-Souza and Simas (2016). We also provide versions of generalized Cook's distance for mean-related or precision-related parameters, whose
details can be found in Barreto-Souza and Simas (2016).
</p>
<p>In the influence method we provide a 'do.coef' argument that computes first-order approximations to the impact of removal of each case to each parameter, in the
same spirit as the 'do.coeff' argument in 'influence.lm'.
</p>


<h3>Value</h3>

<p>The method <code>influence.mixpoissonreg</code> returns a list containing
<em>hat.mean</em>, a vector containing the hat values with respect to the mean, <em>hat.precision</em>,
a vector containing the hat values with respect to the precision, <em>coefficients.mean</em> (if <code>do.coef=TRUE</code>), a matrix
containing the first
order approximations for the mean-related coefficients after the removal
of each observation, <em>coefficients.precision</em> (if <code>do.coef=TRUE</code>), a matrix containing the first
order approximations for the precision-related coefficients after the removal
of each observation, <em>pear.res</em>, a vector containing the Pearson residuals,
<em>score.res</em>, a vector containing the score residuals.
</p>
<p>The <em>cooks.distance.mixpoissonreg</em> returns a vector containing the Cook's distances.
</p>
<p>The <em>hatvalues.mixpoissonreg</em> returns a vector containing the hat values.
</p>


<h3>References</h3>

<p>DOI:10.1007/s11222-015-9601-6 doi: <a href="https://doi.org/10.1007/s11222-015-9601-6">10.1007/s11222-015-9601-6</a>(Barreto-Souza and Simas, 2016)
</p>
<p>Cook, D.R. and Weisberg, S. (1982) <em>Residuals and Influence in Regression</em>. (New York: Chapman and Hall, 1982)
</p>
<p>Pregibon, D. (1981) <em>Logistic Regression Diagnostics</em>. Ann. Stat. 9, 705-724.
</p>
<p>Zhu, H.T., Lee, S.Y., Wei, B.C., Zhu, J. (2001) <em>Case-deletion measures formodels with incomplete data.</em> Biometrika, 88, 727–737.
</p>

<hr>
<h2 id='local_influence'>Local Influence Diagnostics</h2><span id='topic+local_influence'></span><span id='topic+local_influence_plot'></span>

<h3>Description</h3>

<p>Local Influence Diagnostics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>local_influence(model, ...)

local_influence_plot(model, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="local_influence_+3A_model">model</code></td>
<td>
<p>an object for which the local influence is desired</p>
</td></tr>
<tr><td><code id="local_influence_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>local_influence</code> is a generic function to return local influence diagnostics under different perturbation schemes and different directions.
<code>local_influence_plot</code> is a generic function to provide friendly plots of such diagnostics.
</p>
<p>Local influence diagnostics were first introduced by Cook (1986), where several perturbation schemes were introduced and normal curvatures were obtained. Poon and Poon (1999)
introduced the conformal normal curvature, which has nice properties and takes values on the unit interval <code class="reqn">[0,1]</code>. Zhu and Lee (2001) following Cook (1986) and Poon and Poon (1999)
introduced normal and conformal normal curvatures for EM-based models.
</p>


<h3>Value</h3>

<p>The <em>local_influence</em> method returns a list containing the resulting perturbation schemes as elements.
The <em>local_influence_plot</em> is called for its side effects.
</p>


<h3>References</h3>

<p>Cook, R. D. (1986) <em>Assessment of Local Influence.</em> Journal of the Royal Statistical Society. Series B (Methodological), Vol. 48, pp.133-169. <a href="https://rss.onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1986.tb01398.x">https://rss.onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1986.tb01398.x</a>
</p>
<p>Poon, W.-Y. and Poon, Y.S. (1999) <em>Conformal normal curvature and assessment of local influence.</em>  Journal of the Royal Statistical Society. Series B (Methodological), Vol. 61, pp.51-61. <a href="https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00162">https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00162</a>
</p>
<p>Zhu, H.-T. and Lee, S.-Y. (2001) <em>Local influence for incomplete data models.</em> Journal of the Royal Statistical Society. Series B (Methodological), Vol. 63, pp.111-126. <a href="https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00279">https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00279</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+local_influence.mixpoissonreg">local_influence.mixpoissonreg</a></code>, <code><a href="#topic+local_influence_plot.mixpoissonreg">local_influence_plot.mixpoissonreg</a></code>,
<code><a href="#topic+local_influence_autoplot.mixpoissonreg">local_influence_autoplot.mixpoissonreg</a></code>
</p>

<hr>
<h2 id='local_influence_autoplot.mixpoissonreg'>Local Influence Autoplots for <code>mixpoissonreg</code> Objects</h2><span id='topic+local_influence_autoplot.mixpoissonreg'></span>

<h3>Description</h3>

<p>Function to provide customizable ggplot2-based plots of local influence diagnostics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixpoissonreg'
local_influence_autoplot(
  model,
  which = c(1, 2, 3, 4),
  title = list("Case Weights Perturbation", "Hidden Variable Perturbation",
    "Mean Explanatory Perturbation", "Precision Explanatory Perturbation",
    "Simultaneous Explanatory Perturbation"),
  title.size = NULL,
  title.bold = FALSE,
  title.colour = NULL,
  x.axis.col = NULL,
  y.axis.col = NULL,
  x.axis.size = NULL,
  y.axis.size = NULL,
  type.plot = "linerange",
  curvature = c("conformal", "normal"),
  direction = c("canonical", "max.eigen"),
  parameters = c("all", "mean", "precision"),
  mean.covariates = NULL,
  precision.covariates = NULL,
  label.repel = TRUE,
  nrow = NULL,
  ncol = NULL,
  ask = prod(graphics::par("mfcol")) &lt; length(which) &amp;&amp; grDevices::dev.interactive(),
  include.modeltype = TRUE,
  sub.caption = NULL,
  sub.caption.col = NULL,
  sub.caption.size = NULL,
  sub.caption.face = NULL,
  sub.caption.hjust = 0.5,
  gpar_sub.caption = list(fontface = "bold"),
  detect.influential = TRUE,
  n.influential = 5,
  draw.benchmark = FALSE,
  colour = "#444444",
  size = NULL,
  linetype = NULL,
  alpha = NULL,
  fill = NULL,
  shape = NULL,
  label = TRUE,
  label.label = NULL,
  label.colour = "#000000",
  label.alpha = NULL,
  label.size = NULL,
  label.angle = NULL,
  label.family = NULL,
  label.fontface = NULL,
  label.lineheight = NULL,
  label.hjust = NULL,
  label.vjust = NULL,
  ad.colour = "#888888",
  ad.linetype = "dashed",
  ad.size = 0.2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_model">model</code></td>
<td>
<p>A <code>mixpoissonreg</code> model.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_which">which</code></td>
<td>
<p>a list or vector indicating which plots should be displayed.     If a subset of the plots is required, specify a subset of the numbers 1:5, see caption below (and the 'Details') for the different kinds.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_title">title</code></td>
<td>
<p>titles to appear above the plots; character vector or list of valid graphics annotations. Can be set to &quot;&quot; to suppress all titles.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_title.size">title.size</code></td>
<td>
<p>numerical indicating the size of the titles.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_title.bold">title.bold</code></td>
<td>
<p>logical indicating whether the titles should be bold. The default is FALSE.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_title.colour">title.colour</code></td>
<td>
<p>title colour.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_x.axis.col">x.axis.col</code></td>
<td>
<p>colour of the x axis title.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_y.axis.col">y.axis.col</code></td>
<td>
<p>colour of the y axis title.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_x.axis.size">x.axis.size</code></td>
<td>
<p>size of the x axis title.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_y.axis.size">y.axis.size</code></td>
<td>
<p>size of the y axis title.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_type.plot">type.plot</code></td>
<td>
<p>a character indicating the type of the plots. The default is &quot;linerange&quot;. The options are &quot;linerange&quot; and &quot;points&quot;.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_curvature">curvature</code></td>
<td>
<p>the curvature to be returned, 'conformal' for the conformal normal curvature (see Zhu and Lee, 2001 and Poon and Poon, 1999) or
'normal' (see Zhu and Lee, 2001 and Cook, 1986).</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_direction">direction</code></td>
<td>
<p>the 'max.eigen' returns the eigenvector associated to the largest eigenvalue of the perturbation matrix. The 'canonical' considers
the curvatures under the canonical directions, which is known as &quot;total local curvature&quot; (see Lesaffre and Verbeke, 1998). For conformal
normal curvatures both of them coincide. The default is 'canonical'.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_parameters">parameters</code></td>
<td>
<p>the parameter to which the local influence will be computed. The options are 'all', 'mean' and 'precision'.
This argument affects the 'case_weights' and 'hidden_variable' perturbation schemes. The default is 'all'.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_mean.covariates">mean.covariates</code></td>
<td>
<p>a list or vector of characters containing the mean-explanatory variables to be used in the 'mean-explanatory' and 'simultaneous-explanatory'
perturbation schemes. If NULL, the 'mean-explanatory' and 'simultaneous-explanatory' perturbation schemes will be computed by perturbing all
mean-related covariates. The default is NULL.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_precision.covariates">precision.covariates</code></td>
<td>
<p>a list or vector of characters containing the precision-explanatory variables to be used in the 'precision-explanatory'
and 'simultaneous-explanatory'
perturbation schemes. If NULL, the 'precision-explanatory' and 'simultaneous-explanatory' perturbation schemes will be computed by perturbing all
precision-related covariates. The default is NULL.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_label.repel">label.repel</code></td>
<td>
<p>Logical flag indicating whether to use <span class="pkg">ggrepel</span> to place the labels.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_nrow">nrow</code></td>
<td>
<p>Number of facet/subplot rows. If both <code>nrow</code> and <code>ncol</code> are <code>NULL</code>, the plots will be placed one at a time. For multiple plots, set values for <code>nrow</code>
or <code>ncol</code>.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_ncol">ncol</code></td>
<td>
<p>Number of facet/subplot columns. If both <code>nrow</code> and <code>ncol</code> are <code>NULL</code>, the plots will be placed one at a time. For multiple plots, set values for <code>nrow</code>
or <code>ncol</code>.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_ask">ask</code></td>
<td>
<p>logical; if <code>TRUE</code>, the user is asked before each plot.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_include.modeltype">include.modeltype</code></td>
<td>
<p>logical. Indicates whether the model type ('NB' or 'PIG') should be displayed on the captions.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_sub.caption">sub.caption</code></td>
<td>
<p>common title-above the figures if there are more than one. If NULL, as by default, a possible abbreviated version of deparse(x$call) is used.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_sub.caption.col">sub.caption.col</code></td>
<td>
<p>color of subcaption (when one figure at a time).</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_sub.caption.size">sub.caption.size</code></td>
<td>
<p>size of subcaption (when one figure at a time).</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_sub.caption.face">sub.caption.face</code></td>
<td>
<p>font face for subcaption, options are: &quot;plain&quot;, &quot;bold&quot;, &quot;italic&quot; and &quot;bold.italic&quot;.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_sub.caption.hjust">sub.caption.hjust</code></td>
<td>
<p>indicates the position of the subcaption (when one figure at a time). The
default is 0.5, which indicates that the subcaption is centered, a value 0 places the subcaption
at the left side of the plot whereas a value of 1 places the subcaption at the right side of the plot.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_gpar_sub.caption">gpar_sub.caption</code></td>
<td>
<p>list of gpar parameters to be used as common title in the case of multiple plots. The title will be given in sub.caption argument. See
the help of <code><a href="grid.html#topic+gpar">gpar</a></code> function from the <span class="pkg">grid</span> package for all the available options.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_detect.influential">detect.influential</code></td>
<td>
<p>logical. Indicates whether the benchmark should be used to detect influential observations and identify them on the plot. If there is no benchmark available,
the top 'n.influential' observations will be identified in the plot by their indexes.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_n.influential">n.influential</code></td>
<td>
<p>interger. The maximum number of influential observations to be identified on the plot.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_draw.benchmark">draw.benchmark</code></td>
<td>
<p>logical. Indicates whether a horizontal line identifying the benchmark should be drawn.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_colour">colour</code></td>
<td>
<p>line colour.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_size">size</code></td>
<td>
<p>point size.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_linetype">linetype</code></td>
<td>
<p>line type.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_alpha">alpha</code></td>
<td>
<p>alpha of the plot.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_fill">fill</code></td>
<td>
<p>fill colour.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_shape">shape</code></td>
<td>
<p>point shape.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_label">label</code></td>
<td>
<p>Logical value whether to display labels.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_label.label">label.label</code></td>
<td>
<p>vector of labels. If <code>NULL</code>, rownames will be used as labels.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_label.colour">label.colour</code></td>
<td>
<p>Colour for text labels.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_label.alpha">label.alpha</code></td>
<td>
<p>Alpha for text labels.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_label.size">label.size</code></td>
<td>
<p>Size for text labels.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_label.angle">label.angle</code></td>
<td>
<p>Angle for text labels.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_label.family">label.family</code></td>
<td>
<p>Font family for text labels.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_label.fontface">label.fontface</code></td>
<td>
<p>Fontface for text labels.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_label.lineheight">label.lineheight</code></td>
<td>
<p>Lineheight for text labels.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_label.hjust">label.hjust</code></td>
<td>
<p>Horizontal adjustment for text labels.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_label.vjust">label.vjust</code></td>
<td>
<p>Vertical adjustment for text labels.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_ad.colour">ad.colour</code></td>
<td>
<p>Line colour for additional lines.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_ad.linetype">ad.linetype</code></td>
<td>
<p>Line type for additional lines.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_ad.size">ad.size</code></td>
<td>
<p>Fill colour for additional lines.</p>
</td></tr>
<tr><td><code id="local_influence_autoplot.mixpoissonreg_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Called for its side effects.
</p>


<h3>References</h3>

<p>DOI:10.1007/s11222-015-9601-6 doi: <a href="https://doi.org/10.1007/s11222-015-9601-6">10.1007/s11222-015-9601-6</a>(Barreto-Souza and Simas; 2016)
</p>
<p>Cook, R. D. (1986) <em>Assessment of Local Influence.</em> Journal of the Royal Statistical Society. Series B (Methodological), Vol. 48, pp.133-169. <a href="https://rss.onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1986.tb01398.x">https://rss.onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1986.tb01398.x</a>
</p>
<p>Lesaffre, E. and Verbeke, G. (1998) <em>Local Influence in Linear Mixed Models</em>. Biometrics, 54, pp. 570-582.
</p>
<p>Poon, W.-Y. and Poon, Y.S. (2002) <em>Conformal normal curvature and assessment of local influence.</em>  Journal of the Royal Statistical Society. Series B (Methodological), Vol. 61, pp.51-61. <a href="https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00162">https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00162</a>
</p>
<p>Zhu, H.-T. and Lee, S.-Y. (2001) <em>Local influence for incomplete data models.</em> Journal of the Royal Statistical Society. Series B (Methodological), Vol. 63, pp.111-126. <a href="https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00279">https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00279</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glance.mixpoissonreg">glance.mixpoissonreg</a></code>, <code><a href="#topic+augment.mixpoissonreg">augment.mixpoissonreg</a></code>, <code><a href="#topic+tidy.mixpoissonreg">tidy.mixpoissonreg</a></code>, <code><a href="#topic+autoplot.mixpoissonreg">autoplot.mixpoissonreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>daysabs_prog &lt;- mixpoissonreg(daysabs ~ prog | prog, data = Attendance)
local_influence_autoplot(daysabs_prog)

</code></pre>

<hr>
<h2 id='local_influence_plot.mixpoissonreg'>Local Influence Plot Diagnostics for Mixed Poisson Regression Models</h2><span id='topic+local_influence_plot.mixpoissonreg'></span>

<h3>Description</h3>

<p>Local influence plots for mixed Poisson regression models. Currently the conformal normal and normal curvatures are available
under several perturbation schemes. The default is the conformal normal curvature since
it takes values on <code class="reqn">[0,1]</code> and other nice properties (see Zhu and Lee, 2001 and Poon and Poon, 1999 for further details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixpoissonreg'
local_influence_plot(
  model,
  which = c(1, 2, 3, 4),
  caption = list("Case Weights Perturbation", "Hidden Variable Perturbation",
    "Mean Explanatory Perturbation", "Precision Explanatory Perturbation",
    "Simultaneous Explanatory Perturbation"),
  sub.caption = NULL,
  detect.influential = TRUE,
  n.influential = 5,
  draw.benchmark = FALSE,
  lty.benchmark = 2,
  type_plot = "h",
  curvature = c("conformal", "normal"),
  direction = c("canonical", "max.eigen"),
  parameters = c("all", "mean", "precision"),
  mean.covariates = NULL,
  precision.covariates = NULL,
  main = "",
  ask = prod(graphics::par("mfcol")) &lt; length(which) &amp;&amp; grDevices::dev.interactive(),
  labels.id = names(stats::residuals(model)),
  cex.id = 0.75,
  cex.oma.main = 1.25,
  cex.caption = 1,
  include.modeltype = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_model">model</code></td>
<td>
<p>a <code>mixpoissonreg</code> object.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_which">which</code></td>
<td>
<p>a list or vector indicating which plots should be displayed.     If a subset of the plots is required, specify a subset of the numbers 1:5, see caption below (and the 'Details') for the different kinds.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_caption">caption</code></td>
<td>
<p>captions to appear above the plots; character vector or list of valid graphics annotations. Can be set to &quot;&quot; or NA to suppress all captions.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_sub.caption">sub.caption</code></td>
<td>
<p>common title-above the figures if there are more than one. If NULL, as by default, a possible abbreviated version of deparse(x$call) is used.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_detect.influential">detect.influential</code></td>
<td>
<p>logical. Indicates whether the benchmark should be used to detect influential observations and identify them on the plot. If there is no benchmark available,
the top 'n.influential' observations will be identified in the plot by their indexes.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_n.influential">n.influential</code></td>
<td>
<p>interger. The maximum number of influential observations to be identified on the plot.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_draw.benchmark">draw.benchmark</code></td>
<td>
<p>logical. Indicates whether a horizontal line identifying the benchmark should be drawn.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_lty.benchmark">lty.benchmark</code></td>
<td>
<p>the line type of the benchmark if drawn.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_type_plot">type_plot</code></td>
<td>
<p>what type of plot should be drawn. The default is 'h'.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_curvature">curvature</code></td>
<td>
<p>the curvature to be returned, 'conformal' for the conformal normal curvature (see Zhu and Lee, 2001 and Poon and Poon, 1999) or
'normal' (see Zhu and Lee, 2001 and Cook, 1986).</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_direction">direction</code></td>
<td>
<p>the 'max.eigen' returns the eigenvector associated to the largest eigenvalue of the perturbation matrix. The 'canonical' considers
the curvatures under the canonical directions, which is known as &quot;total local curvature&quot; (see Lesaffre and Verbeke, 1998). For conformal
normal curvatures both of them coincide. The default is 'canonical'.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_parameters">parameters</code></td>
<td>
<p>the parameter to which the local influence will be computed. The options are 'all', 'mean' and 'precision'.
This argument affects the 'case_weights' and 'hidden_variable' perturbation schemes. The default is 'all'.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_mean.covariates">mean.covariates</code></td>
<td>
<p>a list or vector of characters containing the mean-explanatory variables to be used in the 'mean-explanatory' and 'simultaneous-explanatory'
perturbation schemes. If NULL, the 'mean-explanatory' and 'simultaneous-explanatory' perturbation schemes will be computed by perturbing all
mean-related covariates. The default is NULL.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_precision.covariates">precision.covariates</code></td>
<td>
<p>a list or vector of characters containing the precision-explanatory variables to be used in the 'precision-explanatory'
and 'simultaneous-explanatory'
perturbation schemes. If NULL, the 'precision-explanatory' and 'simultaneous-explanatory' perturbation schemes will be computed by perturbing all
precision-related covariates. The default is NULL.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_main">main</code></td>
<td>
<p>character; title to be placed at each plot additionally (and above) all captions.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_ask">ask</code></td>
<td>
<p>logical; if <code>TRUE</code>, the user is asked before each plot.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_labels.id">labels.id</code></td>
<td>
<p>vector of labels, from which the labels for extreme points will be chosen. The default uses the observation numbers.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_cex.id">cex.id</code></td>
<td>
<p>magnification of point labels.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_cex.oma.main">cex.oma.main</code></td>
<td>
<p>controls the size of the sub.caption only if that is above the figures when there is more than one.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_cex.caption">cex.caption</code></td>
<td>
<p>controls the size of caption.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_include.modeltype">include.modeltype</code></td>
<td>
<p>logical. Indicates whether the model type ('NB' or 'PIG') should be displayed on the captions.</p>
</td></tr>
<tr><td><code id="local_influence_plot.mixpoissonreg_+3A_...">...</code></td>
<td>
<p>other graphical arguments to be passed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>local_influence.mixpoissonreg</code> provides local influence diagnostics for mixed Poisson regression models for all perturbation schemes considered in
Barreto-Souza and Simas (2016), for normal and conformal normal curvatures. Further, it is also provides results for the canonical directions, which is called
the total local influence (see Lesaffre and Verbeke, 1998), as well as for the direction of largest curvature, which is the direction of the eigenvector of the
perturbation matrix associated to the largest eigenvalue.
</p>
<p><code>local_influence_plot.mixpoissonreg</code> provides a plot of the local influence diagnostics. Each plot corresponds to a perturbation scheme. The first plot considers
the 'case-weights' perturbation; the second plot considers the 'hidden-variable' perturbation (which was introduced in Barreto-Souza and Simas, 2016); the third plot
considers the mean-explanatory perturbation; the fourth plot considers the precision-explanatory perturbation; the fifth plot considers the simultanous-explanatory perturbation.
</p>
<p>For both <code>local_influence.mixpoissonreg</code> and <code>local_influence_plot.mixpoissonreg</code>, one can select which covariates will be perturbed in the 'mean-explanatory',
'precision-explanatory' and 'simultaneous-explanatory' perturbation schemes. These are chosen in the 'mean.covariates' and 'precision.covariates' arguments.
</p>
<p>If one considers the total local influence, then Zhu and Lee (2001) provides benchmark for influential observations for all perturbation schemes. These are returned as
attributes in the returned list from <code>local_influence.mixpoissonreg</code>. When using the <code>local_influence_plot.mixpoissonreg</code>, only points above the benchmark
will be displayed. One can also set the option 'draw_benchmark' to TRUE to plot the benchmark line.
</p>


<h3>Value</h3>

<p>Called for its side effects.
</p>


<h3>References</h3>

<p>DOI:10.1007/s11222-015-9601-6 doi: <a href="https://doi.org/10.1007/s11222-015-9601-6">10.1007/s11222-015-9601-6</a>(Barreto-Souza and Simas; 2016)
</p>
<p>Cook, R. D. (1986) <em>Assessment of Local Influence.</em> Journal of the Royal Statistical Society. Series B (Methodological), Vol. 48, pp.133-169. <a href="https://rss.onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1986.tb01398.x">https://rss.onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1986.tb01398.x</a>
</p>
<p>Lesaffre, E. and Verbeke, G. (1998) <em>Local Influence in Linear Mixed Models</em>. Biometrics, 54, pp. 570-582.
</p>
<p>Poon, W.-Y. and Poon, Y.S. (1999) <em>Conformal normal curvature and assessment of local influence.</em>  Journal of the Royal Statistical Society. Series B (Methodological), Vol. 61, pp.51-61. <a href="https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00162">https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00162</a>
</p>
<p>Zhu, H.-T. and Lee, S.-Y. (2001) <em>Local influence for incomplete data models.</em> Journal of the Royal Statistical Society. Series B (Methodological), Vol. 63, pp.111-126. <a href="https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00279">https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00279</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>daysabs_progML &lt;- mixpoissonregML(daysabs ~ prog | prog, data = Attendance)
local_influence_plot(daysabs_progML)

</code></pre>

<hr>
<h2 id='local_influence.mixpoissonreg'>Local Influence Diagnostics for Mixed Poisson Regression Models</h2><span id='topic+local_influence.mixpoissonreg'></span>

<h3>Description</h3>

<p>This function provides local influence diagnostic quantities. Currently the conformal normal and normal curvatures are available
under several perturbation schemes. The default is the conformal normal curvature since
it takes values on <code class="reqn">[0,1]</code> and other nice properties (see Zhu and Lee, 2001 and Poon and Poon, 1999 for further details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixpoissonreg'
local_influence(
  model,
  perturbation = c("case_weights", "hidden_variable", "mean_explanatory",
    "precision_explanatory", "simultaneous_explanatory"),
  curvature = c("conformal", "normal"),
  direction = c("canonical", "max.eigen"),
  parameters = c("all", "mean", "precision"),
  mean.covariates = NULL,
  precision.covariates = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="local_influence.mixpoissonreg_+3A_model">model</code></td>
<td>
<p>a <code>mixpoissonreg</code> object.</p>
</td></tr>
<tr><td><code id="local_influence.mixpoissonreg_+3A_perturbation">perturbation</code></td>
<td>
<p>a list or vector of perturbation schemes to be returned. The currently available schemes are
&quot;case_weights&quot;, &quot;hidden_variable&quot;, &quot;mean_explanatory&quot;, &quot;precision_explanatory&quot;, &quot;simultaneous_explanatory&quot;. See Barreto-Souza and Simas (2016) for further details.</p>
</td></tr>
<tr><td><code id="local_influence.mixpoissonreg_+3A_curvature">curvature</code></td>
<td>
<p>the curvature to be returned, 'conformal' for the conformal normal curvature (see Zhu and Lee, 2001 and Poon and Poon, 1999) or
'normal' (see Zhu and Lee, 2001 and Cook, 1986).</p>
</td></tr>
<tr><td><code id="local_influence.mixpoissonreg_+3A_direction">direction</code></td>
<td>
<p>the 'max.eigen' returns the eigenvector associated to the largest eigenvalue of the perturbation matrix. The 'canonical' considers
the curvatures under the canonical directions, which is known as &quot;total local curvature&quot; (see Lesaffre and Verbeke, 1998). For conformal
normal curvatures both of them coincide. The default is 'canonical'.</p>
</td></tr>
<tr><td><code id="local_influence.mixpoissonreg_+3A_parameters">parameters</code></td>
<td>
<p>the parameter to which the local influence will be computed. The options are 'all', 'mean' and 'precision'.
This argument affects the 'case_weights' and 'hidden_variable' perturbation schemes. The default is 'all'.</p>
</td></tr>
<tr><td><code id="local_influence.mixpoissonreg_+3A_mean.covariates">mean.covariates</code></td>
<td>
<p>a list or vector of characters containing the mean-explanatory variables to be used in the 'mean-explanatory' and 'simultaneous-explanatory'
perturbation schemes. If NULL, the 'mean-explanatory' and 'simultaneous-explanatory' perturbation schemes will be computed by perturbing all
mean-related covariates. The default is NULL.</p>
</td></tr>
<tr><td><code id="local_influence.mixpoissonreg_+3A_precision.covariates">precision.covariates</code></td>
<td>
<p>a list or vector of characters containing the precision-explanatory variables to be used in the 'precision-explanatory'
and 'simultaneous-explanatory'
perturbation schemes. If NULL, the 'precision-explanatory' and 'simultaneous-explanatory' perturbation schemes will be computed by perturbing all
precision-related covariates. The default is NULL.</p>
</td></tr>
<tr><td><code id="local_influence.mixpoissonreg_+3A_...">...</code></td>
<td>
<p>other graphical arguments to be passed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>local_influence.mixpoissonreg</code> provides local influence diagnostics for mixed Poisson regression models for all perturbation schemes considered in
Barreto-Souza and Simas (2016), for normal and conformal normal curvatures. Further, it is also provides results for the canonical directions, which is called
the total local influence (see Lesaffre and Verbeke, 1998), as well as for the direction of largest curvature, which is the direction of the eigenvector of the
perturbation matrix associated to the largest eigenvalue.
</p>
<p><code>local_influence_plot.mixpoissonreg</code> provides a plot of the local influence diagnostics. Each plot corresponds to a perturbation scheme. The first plot considers
the 'case-weights' perturbation; the second plot considers the 'hidden-variable' perturbation (which was introduced in Barreto-Souza and Simas, 2016); the third plot
considers the mean-explanatory perturbation; the fourth plot considers the precision-explanatory perturbation; the fifth plot considers the simultanous-explanatory perturbation.
</p>
<p>For both <code>local_influence.mixpoissonreg</code> and <code>local_influence_plot.mixpoissonreg</code>, one can select which covariates will be perturbed in the 'mean-explanatory',
'precision-explanatory' and 'simultaneous-explanatory' perturbation schemes. These are chosen in the 'mean.covariates' and 'precision.covariates' arguments.
</p>
<p>If one considers the total local influence, then Zhu and Lee (2001) provides benchmark for influential observations for all perturbation schemes. These are returned as
attributes in the returned list from <code>local_influence.mixpoissonreg</code>. When using the <code>local_influence_plot.mixpoissonreg</code>, only points above the benchmark
will be displayed. One can also set the option 'draw_benchmark' to TRUE to plot the benchmark line.
</p>


<h3>Value</h3>

<p>a list containing the resulting perturbation schemes as elements. Each returned element has an attribute 'benchmark', which for
the conformal normal curvature, it is computed following Zhu and Lee (2001), and for normal curvature it is computed following Verbeke and ...
If the 'direction' is 'max.eigen' the 'benchmark' attribute is NA.
</p>
<p>The 'mean_explanatory', 'precision_explanatory' and 'simultaneous_explanatory' elements of the list contain an attribute 'covariates' indicating
which covariates were used in the perturbation schemes.
</p>


<h3>References</h3>

<p>DOI:10.1007/s11222-015-9601-6 doi: <a href="https://doi.org/10.1007/s11222-015-9601-6">10.1007/s11222-015-9601-6</a>(Barreto-Souza and Simas; 2016)
</p>
<p>Cook, R. D. (1986) <em>Assessment of Local Influence.</em> Journal of the Royal Statistical Society. Series B (Methodological), Vol. 48, pp.133-169. <a href="https://rss.onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1986.tb01398.x">https://rss.onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1986.tb01398.x</a>
</p>
<p>Lesaffre, E. and Verbeke, G. (1998) <em>Local Influence in Linear Mixed Models</em>. Biometrics, 54, pp. 570-582.
</p>
<p>Poon, W.-Y. and Poon, Y.S. (1999) <em>Conformal normal curvature and assessment of local influence.</em>  Journal of the Royal Statistical Society. Series B (Methodological), Vol. 61, pp.51-61. <a href="https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00162">https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00162</a>
</p>
<p>Zhu, H.-T. and Lee, S.-Y. (2001) <em>Local influence for incomplete data models.</em> Journal of the Royal Statistical Society. Series B (Methodological), Vol. 63, pp.111-126. <a href="https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00279">https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00279</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>daysabs_progML &lt;- mixpoissonregML(daysabs ~ prog | prog, data = Attendance)
local_influence(daysabs_progML)

</code></pre>

<hr>
<h2 id='logLik.mixpoissonreg'>logLik Method for <code>mixpoissonreg</code> Objects</h2><span id='topic+logLik.mixpoissonreg'></span>

<h3>Description</h3>

<p>Function to compute the log-likelihood at the estimated parameters for mixed Poisson regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixpoissonreg'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLik.mixpoissonreg_+3A_object">object</code></td>
<td>
<p>an object of class &quot;mixpoissonreg&quot; containing results from the fitted model.</p>
</td></tr>
<tr><td><code id="logLik.mixpoissonreg_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code>LogLik</code> containing the log-likelihood
of the fitted <em>mixpoissonreg</em> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vcov.mixpoissonreg">vcov.mixpoissonreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>daysabs_prog &lt;- mixpoissonreg(daysabs ~ prog, data = Attendance)
logLik(daysabs_prog)

</code></pre>

<hr>
<h2 id='mixpoissonreg'>Mixed Poisson Regression for Overdispersed Count Data</h2><span id='topic+mixpoissonreg'></span><span id='topic+mixpoissonreg.fit'></span>

<h3>Description</h3>

<p>Fits mixed Poisson regression models (Poisson-Inverse Gaussian or Negative-Binomial) on data sets with response variables being count data.
The models can have varying precision parameter, where a linear regression structure (through a link function) is assumed to hold on the precision parameter.
The Expectation-Maximization algorithm for both these models (Poisson Inverse Gaussian and Negative Binomial) is an important contribution of this package.
Another important feature of this package is the set of functions to perform global and local influence analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixpoissonreg(
  formula,
  data,
  link.mean = c("log", "sqrt"),
  link.precision = c("identity", "log", "inverse.sqrt"),
  model = c("NB", "PIG"),
  method = c("EM", "ML"),
  residual = c("pearson", "score"),
  y = TRUE,
  x = TRUE,
  w = TRUE,
  envelope = 0,
  prob = 0.95,
  model.frame = TRUE,
  em_controls = list(maxit = 5000, em_tol = 10^(-5), em_tolgrad = 10^(-2)),
  optim_method = "L-BFGS-B",
  optim_controls = list()
)

mixpoissonreg.fit(
  x,
  y,
  w = NULL,
  link.mean = c("log", "sqrt"),
  link.precision = c("identity", "log", "inverse.sqrt"),
  model = c("NB", "PIG"),
  method = c("EM", "ML"),
  residual = c("pearson", "score"),
  envelope = 0,
  prob = 0.95,
  em_controls = list(maxit = 5000, em_tol = 10^(-5), em_tolgrad = 10^(-2)),
  optim_method = "L-BFGS-B",
  optim_controls = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mixpoissonreg_+3A_formula">formula</code></td>
<td>
<p>symbolic description of the model (examples: <code>y ~ x1 + ... + xnbeta</code> and <code>y ~ x1 + ... + xnbeta | w1 + ... + wnalpha</code>); see details below.</p>
</td></tr>
<tr><td><code id="mixpoissonreg_+3A_data">data</code></td>
<td>
<p>elements expressed in formula. This is usually a data frame composed by:
(i) the observations formed by count data <code>z</code>, with z_i being non-negative integers,
(ii) covariates for the mean submodel (columns <code>x1, ..., xnbeta</code>) and
(iii) covariates for the precision submodel (columns <code>w1, ..., wnalphla</code>).</p>
</td></tr>
<tr><td><code id="mixpoissonreg_+3A_link.mean">link.mean</code></td>
<td>
<p>optionally, a string containing the link function for the mean. If omitted, the 'log' link function will be used.
The possible link functions for the mean are &quot;log&quot; and &quot;sqrt&quot;.</p>
</td></tr>
<tr><td><code id="mixpoissonreg_+3A_link.precision">link.precision</code></td>
<td>
<p>optionally, a string containing the link function the precision parameter. If omitted and the only precision
covariate is the intercept, the 'identity' link function will be used, if omitted and there is a precision covariate other than the
intercept, the 'log' link function will be used. The possible link functions for the precision parameter are &quot;identity&quot; and &quot;inverse.sqrt&quot; (which is <code class="reqn">\phi^{-1/2} = w_i^T alpha</code>).</p>
</td></tr>
<tr><td><code id="mixpoissonreg_+3A_model">model</code></td>
<td>
<p>character (&quot;NB&quot; or &quot;PIG&quot;) indicating the type of model to be fitted, with
&quot;NB&quot; standing for Negative-Binomial and &quot;PIG&quot; standing for Poisson Inverse Gaussian. The default is &quot;NB&quot;.</p>
</td></tr>
<tr><td><code id="mixpoissonreg_+3A_method">method</code></td>
<td>
<p>estimation method to be chosen between &quot;EM&quot; (Expectation-Maximization) and &quot;ML&quot; (Maximum-Likelihood). The default method is &quot;EM&quot;.</p>
</td></tr>
<tr><td><code id="mixpoissonreg_+3A_residual">residual</code></td>
<td>
<p>character indicating the type of residual to be evaluated (&quot;pearson&quot; or &quot;score&quot;). The default is &quot;pearson&quot;. Notice that they coincide for Negative-Binomial models.</p>
</td></tr>
<tr><td><code id="mixpoissonreg_+3A_y">y</code></td>
<td>
<p>For <code>mixpoissonreg</code>: logical values indicating if the response vector should be returned as component.
</p>
<p>For <code>mixpoissonreg.fit</code>: a numerical vector of response variables with length <code>n</code>. Each coordinate must be a nonnegative-integer.</p>
</td></tr>
<tr><td><code id="mixpoissonreg_+3A_x">x</code></td>
<td>
<p>For <code>mixpoissonreg</code>: logical values indicating if the model matrix <code>x</code> should be returned as component.
</p>
<p>For <code>mixpoissonreg.fit</code>: a matrix of covariates with respect to the mean with dimension <code>(n,nbeta)</code>.</p>
</td></tr>
<tr><td><code id="mixpoissonreg_+3A_w">w</code></td>
<td>
<p>For <code>mixpoissonreg</code>: logical values indicating if the model matrix <code>w</code> should be returned as component.
</p>
<p>For <code>mixpoissonreg.fit</code> a matrix of covariates with respect to the precision parameter. The default is <code>NULL</code>.
If not <code>NULL</code> must be of dimension <code>(n,nalpha)</code>.</p>
</td></tr>
<tr><td><code id="mixpoissonreg_+3A_envelope">envelope</code></td>
<td>
<p>number of simulations (synthetic data sets) to build envelopes for residuals (with <code>100*prob%</code> confidence level).
The default <code>envelope = 0</code> dismisses the envelope analysis.</p>
</td></tr>
<tr><td><code id="mixpoissonreg_+3A_prob">prob</code></td>
<td>
<p>probability indicating the confidence level for the envelopes (default: <code>prob</code> = 0.95).
If <code>envelope</code> = 0, <code>prob</code> is ignored.</p>
</td></tr>
<tr><td><code id="mixpoissonreg_+3A_model.frame">model.frame</code></td>
<td>
<p>logical indicating whether the model frame should be returned as component of the returned value.</p>
</td></tr>
<tr><td><code id="mixpoissonreg_+3A_em_controls">em_controls</code></td>
<td>
<p>only used with the 'EM' method. A list containing two elements: <code>maxit</code> that contains the maximum number of iterations of the EM algorithm,
the default is set to 5000;
<code>em_tol</code> that defines the tolerance value to control the convergence criterion in the EM-algorithm, the default is set to 10^(-5);
<code>em_tolgrad</code> that defines the tolerance value
of the maximum-norm of the the gradient of the Q-function, the default is set to 10^(-2).</p>
</td></tr>
<tr><td><code id="mixpoissonreg_+3A_optim_method">optim_method</code></td>
<td>
<p>main optimization algorithm to be used. The available methods are the same as those of <code>optim</code> function. The default is set to &quot;L-BFGS-B&quot;.</p>
</td></tr>
<tr><td><code id="mixpoissonreg_+3A_optim_controls">optim_controls</code></td>
<td>
<p>a list of control arguments to be passed to the <code>optim</code> function in the optimization of the model. For the control options, see
the 'Details' in the help of <code><a href="stats.html#topic+optim">optim</a></code> for the possible arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Among the regression models with discrete response variables, Poisson regression is the most popular
for modeling count data. See, for instance Sellers and Shmueli (2010).
It is well-known that this model is equidispersed (that is, the mean is equal to the variance),
which in practice may be an unrealistic
assumption. Several models have been introduced in the literature to overcome this problem such as
negative binomial (NB) and Poisson inverse gaussian (PIG) distributions (see Lawless, 1987).
The most common way to do this is to consider a mixed Poisson distribution, which is defined as follows.
Let <code class="reqn">Z</code> be a positive random variable (generally being continuous) with distribution
function <code class="reqn">G_{\tau}(\cdot)</code>,
where <code class="reqn">\tau</code> denotes the parameter vector associated to the <code class="reqn">G</code> distribution. Let
<code class="reqn">Y|Z=z\sim</code>Poisson<code class="reqn">(\mu z)</code>, for
some constant <code class="reqn">\mu&gt;0</code>. Therefore <code class="reqn">Y</code> follows a mixed Poisson (MP) distribution with probability
function given by
</p>
<p style="text-align: center;"><code class="reqn">P(Y=y)=\int_0^\infty\frac{e^{-\mu z}(\mu z)^y}{y!}dG_{\tau}(z),</code>
</p>

<p>for <code class="reqn">y=0,1,\ldots</code>. With this,
<code class="reqn">Y</code> has an overdispersed distribution and hence it is a natural alternative to the Poisson distribution.
The most common choices for <code class="reqn">Z</code> are gamma and inverse-gaussian distributions,
which yields <code class="reqn">Y</code> following, respectively, NB and PIG distributions.
General properties of the MP distributions can be found in Karlis and Xekalaki (2005) and in the references therein.
</p>
<p>In <code>mixpoissonreg</code> two regression models are implemented, namely, the NB and PIG regression models.
We follow the definitions and notations given in Barreto-Souza and Simas (2016). The mixed Poisson regression model
is defined by assuming <code class="reqn">Y_1,\ldots,Y_n</code> is a random sample where
<code class="reqn">Y_i\sim NB(\mu_i,\phi_i)</code> or <code class="reqn">Y_i\sim PIG(\mu_i,\phi_i)</code> for <code class="reqn">i = 1,\ldots,n</code>.
Under this parameterization we have <code class="reqn">E(Y_i) = \mu_i</code> and <code class="reqn">Var(Y_i) = \mu_i(1+\mu_i\phi_i^{-1}b''(\xi_0))</code>, where
<code class="reqn">b(\theta) = -\log(-\theta)</code> and <code class="reqn">\xi_0 = -1</code> for the NB case, and <code class="reqn">b(\theta) = -(-2\theta)^{1/2}</code> and <code class="reqn">\xi_0 = -1/2</code> for
the PIG case, with <code class="reqn">b''(\cdot)</code> being the second derivative of the function <code class="reqn">b(\cdot)</code>.
The following linear relations are assumed
</p>
<p style="text-align: center;"><code class="reqn">\Lambda_1(\mu_i) = x_i^T \beta</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\Lambda_2(\phi_i) = w_i^T \alpha,</code>
</p>

<p>where <code class="reqn">\beta = (\beta_1,...,\beta_p)</code> and <code class="reqn">\alpha = (\alpha_1,...,\alpha_q)</code> are real valued vectors.
The terms <code class="reqn">x_i^T</code> and <code class="reqn">v_i^T</code> represent, respectively, the i-th row of the matrices &quot;x&quot; (<code class="reqn">n\times p</code>)
and &quot;w&quot; (<code class="reqn">n\times q</code>) containing covariates in their columns
(<code class="reqn">x_{i,1}</code> and <code class="reqn">v_{i,1}</code> may be 1 to handle intercepts).
</p>
<p>Therefore, the <code>mixpoissonreg</code> package handles up to two regression structures
at the same time: one for the mean parameter, one for the precision parameter. The regression structure for
the mean is determined through a formula <code>y ~ x1 + ... + xn</code>, whereas the regression structure for
the precision parameter is determined through the right-hand side of the formula using the separator &quot;<code>|</code>&quot;. So,
for example, a regression with <code>x1,...,xn</code> as covariates for the mean and <code>z1,...,zm</code> as covariates for the precision
parameter corresponds to the formula <code>y ~ x1 + ... + xn | z1 + ... + zm</code>. If only there is only formula for
the regression structure for the mean, the regression structure for the precision parameter will only have the intercept,
that is, <code>y ~ x1 + ... + xn</code> is the same as <code>y ~ x1 + ... + xn | 1</code>.
</p>
<p>In general, in this package, the EM-algorithm estimation method obtains estimates closer to the maximum likelihood estimate than the maximum likelihood estimation method,
in the sense that the likelihood function evaluated at the EM-algorithm estimate is greater or equal (usually strictly greater) than the likelihood function evaluated
at the maximum likelihood estimate. So, unless the processing time is an issue, we strongly recommend the EM-algorithm as the estimation method.
</p>
<p>In Barreto-Souza and Simas (2016) two residuals were studied: the pearson residuals
and the score residuals. Both these residuals are implemented in the <code>mixpoissonreg</code>
package. They coincide for NB regression models. They can be accessed via
the <a href="#topic+residuals.mixpoissonreg">residuals</a> method.
</p>
<p>It is also noteworthy that all the global and local influence analysis tools developed
in Barreto-Souza and Simas (2016) are implemented in this package. See <code><a href="#topic+influence.mixpoissonreg">influence.mixpoissonreg</a></code>,
<code><a href="#topic+local_influence.mixpoissonreg">local_influence.mixpoissonreg</a></code>, <code><a href="#topic+local_influence_plot.mixpoissonreg">local_influence_plot.mixpoissonreg</a></code>
and <code><a href="#topic+local_influence_autoplot.mixpoissonreg">local_influence_autoplot.mixpoissonreg</a></code>.
</p>


<h3>Value</h3>

<p><code>mixpoissonreg</code> returns an object of class &quot;mixpoissonreg&quot; whereas <code>mixpoissonreg.fit</code>
returns an object of class &quot;mixpoissonreg_fit&quot;. Both objects are given by lists containing the outputs from the model fit (Negative-Binomial or Poisson Inverse Gaussian regression).
</p>
<p>An object of the class &quot;mixpoissonreg&quot; is a list containing the following elements:
</p>

<ul>
<li> <p><code>coefficients</code> - a list with elements &quot;mean&quot; and &quot;precision&quot; containing the estimated coefficients of the model;
</p>
</li>
<li> <p><code>call</code> - the formula used by the model. If using <code>mixpoissonreg.fit</code>, this returns <code>NULL</code>.
</p>
</li>
<li> <p><code>modelname</code> - the fitted model, NB or PIG;
</p>
</li>
<li> <p><code>modeltype</code> - the abbreviated model name
</p>
</li>
<li> <p><code>residualname</code> - the name of the chosen residual in the call, 'pearson' or 'score';
</p>
</li>
<li> <p><code>niter</code> - number of iterations of the EM algorithm if method = &quot;EM&quot; and number of iterations
of the <code>optim</code> function, if method = &quot;ML&quot;;
</p>
</li>
<li> <p><code>start</code> - the initial guesses of the parameters
</p>
</li>
<li> <p><code>intercept</code> - vector indicating if the intercept is present in the mean and/or in the precision regressions;
</p>
</li>
<li> <p><code>link.mean</code> - link function of the mean;
</p>
</li>
<li> <p><code>link.precision</code> - link function of the precision parameter;
</p>
</li>
<li> <p><code>fitted.values</code> - a vector of fitted values in the response scale;
</p>
</li>
<li> <p><code>fitted.precisions</code> - a vector of fitted precisions;
</p>
</li>
<li> <p><code>efron.pseudo.r2</code> - Efron's pseudo R^2: the squared correlation between the response variables and the predicted values;
</p>
</li>
<li> <p><code>vcov</code> - covariance matrix of the parameters of the fitted model;
</p>
</li>
<li> <p><code>logLik</code> - log-likelihood at the estimated parameters;
</p>
</li>
<li> <p><code>Qfunction</code> - Q-function at the estimated parameters;
</p>
</li>
<li> <p><code>x</code> - the covariates related to the mean (if x = TRUE);
</p>
</li>
<li> <p><code>w</code> - the covariates related to the precision parameter (if w = TRUE);
</p>
</li>
<li> <p><code>y</code> - the response variables (if y = TRUE);
</p>
</li>
<li> <p><code>model</code> - if requested (the default), the model frame;
</p>
</li>
<li> <p><code>formula</code> - the formula supplied;
</p>
</li>
<li> <p><code>nobs</code> - number of observations
</p>
</li>
<li> <p><code>df.null</code> - the residual degrees of freedom for the model with constant mean and constant precision;
</p>
</li>
<li> <p><code>df.residual</code> - the residual degrees of freedom of the fitted model;
</p>
</li>
<li> <p><code>estimation_method</code> - the estimation method, &quot;EM&quot; or &quot;ML&quot;
</p>
</li>
<li> <p><code>residuals</code> - vector of raw residuals, that is, the response variable minus the fitted means;
</p>
</li>
<li> <p><code>std_errors</code> - the standard errors of the estimated parameters;
</p>
</li>
<li> <p><code>envelope</code> - the numerical envelopes used to build the Q-Q plot with simulated envelopes;
</p>
</li>
<li> <p><code>terms</code> - (only for <code>mixpoissonreg</code>)the <code>terms</code> object used;
</p>
</li>
<li> <p><code>levels</code> - (where relevant, only for <code>mixpoissonreg</code>) the levels of the factors used;
</p>
</li>
<li> <p><code>contrasts</code> - (where relevant, only for <code>mixpoissonreg</code>) the contrasts used.
</p>
</li></ul>



<h3>References</h3>

<p>DOI:10.1007/s11222-015-9601-6 doi: <a href="https://doi.org/10.1007/s11222-015-9601-6">10.1007/s11222-015-9601-6</a>(Barreto-Souza and Simas; 2016)
</p>
<p>URL:https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1751-5823.2005.tb00250.x (<a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1751-5823.2005.tb00250.x">Karlis and Xekalaki; 2005</a>)
</p>
<p>DOI:10.2307/3314912 doi: <a href="https://doi.org/10.2307/3314912">10.2307/3314912</a>(Lawless; 1987)
</p>
<p>Sellers, K.F. and Shmueli, G. (2010) <em>A flexible regression model for count data.</em> Ann. Appl. Stat., 4, 943-961
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.mixpoissonreg">summary.mixpoissonreg</a></code>, <code><a href="#topic+plot.mixpoissonreg">plot.mixpoissonreg</a></code>, <code><a href="#topic+autoplot.mixpoissonreg">autoplot.mixpoissonreg</a></code>,
<code><a href="#topic+residuals.mixpoissonreg">residuals.mixpoissonreg</a></code>, <code><a href="#topic+predict.mixpoissonreg">predict.mixpoissonreg</a></code>,<code><a href="#topic+influence.mixpoissonreg">influence.mixpoissonreg</a></code>,
<code><a href="#topic+cooks.distance.mixpoissonreg">cooks.distance.mixpoissonreg</a></code>,
<code><a href="#topic+local_influence.mixpoissonreg">local_influence.mixpoissonreg</a></code>, <code><a href="#topic+local_influence_plot.mixpoissonreg">local_influence_plot.mixpoissonreg</a></code>, <code><a href="#topic+local_influence_autoplot.mixpoissonreg">local_influence_autoplot.mixpoissonreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Examples using the Attendance dataset:

daysabs_prog &lt;- mixpoissonreg(daysabs ~ prog, data = Attendance)
summary(daysabs_prog)

</code></pre>

<hr>
<h2 id='mixpoissonregML'>Maximum Likelihood Mixed Poisson Regression Models for Overdispersed Count Data</h2><span id='topic+mixpoissonregML'></span><span id='topic+mixpoissonregML.fit'></span>

<h3>Description</h3>

<p>Uses maximum likelihood estimators to fit mixed Poisson regression models (Poisson-Inverse Gaussian or Negative-Binomial) on data sets with response variables being count data. The models can have varying precision parameter, where a linear regression structure (through a link function) is assumed to hold on the precision parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixpoissonregML(
  formula,
  data,
  link.mean = c("log", "sqrt"),
  link.precision = c("identity", "log", "inverse.sqrt"),
  model = c("NB", "PIG"),
  residual = c("pearson", "score"),
  y = TRUE,
  x = TRUE,
  w = TRUE,
  envelope = 0,
  prob = 0.95,
  model.frame = TRUE,
  em_controls = list(maxit = 5000, em_tol = 10^(-5), em_tolgrad = 10^(-2)),
  optim_method = "L-BFGS-B",
  optim_controls = list()
)

mixpoissonregML.fit(
  x,
  y,
  w = NULL,
  link.mean = c("log", "sqrt"),
  link.precision = c("identity", "log", "inverse.sqrt"),
  model = c("NB", "PIG"),
  residual = c("pearson", "score"),
  envelope = 0,
  prob = 0.95,
  em_controls = list(maxit = 5000, em_tol = 10^(-5), em_tolgrad = 10^(-2)),
  optim_method = "L-BFGS-B",
  optim_controls = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mixpoissonregML_+3A_formula">formula</code></td>
<td>
<p>symbolic description of the model (examples: <code>y ~ x1 + ... + xnbeta</code> and <code>y ~ x1 + ... + xnbeta | w1 + ... + wnalpha</code>); see details below.</p>
</td></tr>
<tr><td><code id="mixpoissonregML_+3A_data">data</code></td>
<td>
<p>elements expressed in formula. This is usually a data frame composed by:
(i) the observations formed by count data <code>z</code>, with z_i being non-negative integers,
(ii) covariates for the mean submodel (columns <code>x1, ..., xnbeta</code>) and
(iii) covariates for the precision submodel (columns <code>w1, ..., wnalphla</code>).</p>
</td></tr>
<tr><td><code id="mixpoissonregML_+3A_link.mean">link.mean</code></td>
<td>
<p>optionally, a string containing the link function for the mean. If omitted, the 'log' link function will be used.
The possible link functions for the mean are &quot;log&quot; and &quot;sqrt&quot;.</p>
</td></tr>
<tr><td><code id="mixpoissonregML_+3A_link.precision">link.precision</code></td>
<td>
<p>optionally, a string containing the link function the precision parameter. If omitted and the only precision
covariate is the intercept, the 'identity' link function will be used, if omitted and there is a precision covariate other than the
intercept, the 'log' link function will be used. The possible link functions for the precision parameter are &quot;identity&quot; and &quot;inverse.sqrt&quot; (which is <code class="reqn">\phi^{-1/2} = w_i^T alpha</code>).</p>
</td></tr>
<tr><td><code id="mixpoissonregML_+3A_model">model</code></td>
<td>
<p>character (&quot;NB&quot; or &quot;PIG&quot;) indicating the type of model to be fitted, with
&quot;NB&quot; standing for Negative-Binomial and &quot;PIG&quot; standing for Poisson Inverse Gaussian. The default is &quot;NB&quot;.</p>
</td></tr>
<tr><td><code id="mixpoissonregML_+3A_residual">residual</code></td>
<td>
<p>character indicating the type of residual to be evaluated (&quot;pearson&quot; or &quot;score&quot;). The default is &quot;pearson&quot;. Notice that they coincide for Negative-Binomial models.</p>
</td></tr>
<tr><td><code id="mixpoissonregML_+3A_y">y</code></td>
<td>
<p>For <code>mixpoissonregML</code>: logical values indicating if the response vector should be returned as component.
</p>
<p>For <code>mixpoissonregML.fit</code>: a numerical vector of response variables with length <code>n</code>. Each coordinate must be a nonnegative-integer.</p>
</td></tr>
<tr><td><code id="mixpoissonregML_+3A_x">x</code></td>
<td>
<p>For <code>mixpoissonregML</code>: logical values indicating if the model matrix <code>x</code> should be returned as component.
</p>
<p>For <code>mixpoissonregML.fit</code>: a matrix of covariates with respect to the mean with dimension <code>(n,nbeta)</code>.</p>
</td></tr>
<tr><td><code id="mixpoissonregML_+3A_w">w</code></td>
<td>
<p>For <code>mixpoissonregML</code>: logical values indicating if the model matrix <code>w</code> should be returned as component.
</p>
<p>For <code>mixpoissonregML.fit</code> a matrix of covariates with respect to the precision parameter. The default is <code>NULL</code>. If not <code>NULL</code> must be of dimension <code>(n,nalpha)</code>.</p>
</td></tr>
<tr><td><code id="mixpoissonregML_+3A_envelope">envelope</code></td>
<td>
<p>number of simulations (synthetic data sets) to build envelopes for residuals (with <code>100*prob%</code> confidence level).
The default <code>envelope = 0</code> dismisses the envelope analysis.</p>
</td></tr>
<tr><td><code id="mixpoissonregML_+3A_prob">prob</code></td>
<td>
<p>probability indicating the confidence level for the envelopes (default: <code>prob</code> = 0.95).
If <code>envelope</code> = 0, <code>prob</code> is ignored.</p>
</td></tr>
<tr><td><code id="mixpoissonregML_+3A_model.frame">model.frame</code></td>
<td>
<p>logical indicating whether the model frame should be returned as component of the returned value.</p>
</td></tr>
<tr><td><code id="mixpoissonregML_+3A_em_controls">em_controls</code></td>
<td>
<p>only used with the 'EM' method. A list containing two elements: <code>maxit</code> that contains the maximum number of iterations of the EM algorithm, the default is set to 5000;
<code>em_tol</code> that defines the tolerance value to control the convergence criterion in the EM-algorithm, the default is set to 10^(-5). <code>em_tolgrad</code> that defines the tolerance value
of the maximum-norm of the the gradient of the Q-function, the default is set to 10^(-2).</p>
</td></tr>
<tr><td><code id="mixpoissonregML_+3A_optim_method">optim_method</code></td>
<td>
<p>main optimization algorithm to be used. The available methods are the same as those of <code>optim</code> function. The default is set to &quot;L-BFGS-B&quot;.</p>
</td></tr>
<tr><td><code id="mixpoissonregML_+3A_optim_controls">optim_controls</code></td>
<td>
<p>a list of control arguments to be passed to the <code>optim</code> function in the optimization of the model. For the control options, see
the 'Details' in the help of <code><a href="stats.html#topic+optim">optim</a></code> for the possible arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Among the regression models with discrete response variables, Poisson regression is the most popular
for modeling count data. See, for instance Sellers and Shmueli (2010).
It is well-known that this model is equidispersed (that is, the mean is equal to the variance),
which in practice may be an unrealistic
assumption. Several models have been introduced in the literature to overcome this problem such as
negative binomial (NB) and Poisson inverse gaussian (PIG) distributions (see Lawless, 1987).
The most common way to do this is to consider a mixed Poisson distribution, which is defined as follows.
Let <code class="reqn">Z</code> be a positive random variable (generally being continuous) with distribution
function <code class="reqn">G_{\tau}(\cdot)</code>,
where <code class="reqn">\tau</code> denotes the parameter vector associated to the <code class="reqn">G</code> distribution. Let
<code class="reqn">Y|Z=z\sim</code>Poisson<code class="reqn">(\mu z)</code>, for
some constant <code class="reqn">\mu&gt;0</code>. Therefore <code class="reqn">Y</code> follows a mixed Poisson (MP) distribution with probability
function given by
</p>
<p style="text-align: center;"><code class="reqn">P(Y=y)=\int_0^\infty\frac{e^{-\mu z}(\mu z)^y}{y!}dG_{\tau}(z),</code>
</p>

<p>for <code class="reqn">y=0,1,\ldots</code>. With this,
<code class="reqn">Y</code> has an overdispersed distribution and hence it is a natural alternative to the Poisson distribution.
The most common choices for <code class="reqn">Z</code> are gamma and inverse-gaussian distributions,
which yields <code class="reqn">Y</code> following, respectively, NB and PIG distributions.
General properties of the MP distributions can be found in Karlis and Xekalaki (2005) and in the references therein.
</p>
<p>In <code>mixpoissonreg</code> two regression models are implemented, namely, the NB and PIG regression models.
We follow the definitions and notations given in Barreto-Souza and Simas (2016). The mixed Poisson regression model
is defined by assuming <code class="reqn">Y_1,\ldots,Y_n</code> is a random sample where
<code class="reqn">Y_i\sim NB(\mu_i,\phi_i)</code> or <code class="reqn">Y_i\sim PIG(\mu_i,\phi_i)</code> for <code class="reqn">i = 1,\ldots,n</code>.
Under this parameterization we have <code class="reqn">E(Y_i) = \mu_i</code> and <code class="reqn">Var(Y_i) = \mu_i(1+\mu_i\phi_i^{-1}b''(\xi_0))</code>, where
<code class="reqn">b(\theta) = -\log(-\theta)</code> and <code class="reqn">\xi_0 = -1</code> for the NB case, and <code class="reqn">b(\theta) = -(-2\theta)^{1/2}</code> and <code class="reqn">\xi_0 = -1/2</code> for
the PIG case, with <code class="reqn">b''(\cdot)</code> being the second derivative of the function <code class="reqn">b(\cdot)</code>.
The following linear relations are assumed
</p>
<p style="text-align: center;"><code class="reqn">\Lambda_1(\mu_i) = x_i^T \beta</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\Lambda_2(\phi_i) = w_i^T \alpha,</code>
</p>

<p>where <code class="reqn">\beta = (\beta_1,...,\beta_p)</code> and <code class="reqn">\alpha = (\alpha_1,...,\alpha_q)</code> are real valued vectors.
The terms <code class="reqn">x_i^T</code> and <code class="reqn">v_i^T</code> represent, respectively, the i-th row of the matrices &quot;x&quot; (<code class="reqn">n\times p</code>)
and &quot;w&quot; (<code class="reqn">n\times q</code>) containing covariates in their columns
(<code class="reqn">x_{i,1}</code> and <code class="reqn">v_{i,1}</code> may be 1 to handle intercepts).
</p>
<p>Therefore, the <code>mixpoissonreg</code> package handles up to two regression structures
at the same time: one for the mean parameter, one for the precision parameter. The regression structure for
the mean is determined through a formula <code>y ~ x1 + ... + xn</code>, whereas the regression structure for
the precision parameter is determined through the right-hand side of the formula using the separator &quot;<code>|</code>&quot;. So,
for example, a regression with <code>x1,...,xn</code> as covariates for the mean and <code>z1,...,zm</code> as covariates for the precision
parameter corresponds to the formula <code>y ~ x1 + ... + xn | z1 + ... + zm</code>. If only there is only formula for
the regression structure for the mean, the regression structure for the precision parameter will only have the intercept,
that is, <code>y ~ x1 + ... + xn</code> is the same as <code>y ~ x1 + ... + xn | 1</code>.
</p>
<p>In general, in this package, the EM-algorithm estimation method obtains estimates closer to the maximum likelihood estimate than the maximum likelihood estimation method,
in the sense that the likelihood function evaluated at the EM-algorithm estimate is greater or equal (usually strictly greater) than the likelihood function evaluated
at the maximum likelihood estimate. So, unless the processing time is an issue, we strongly recommend the EM-algorithm as the estimation method.
</p>
<p>In Barreto-Souza and Simas (2016) two residuals were studied: the pearson residuals
and the score residuals. Both these residuals are implemented in the <code>mixpoissonreg</code>
package. They coincide for NB regression models. They can be accessed via
the <a href="#topic+residuals.mixpoissonreg">residuals</a> method.
</p>
<p>It is also noteworthy that all the global and local influence analysis tools developed
in Barreto-Souza and Simas (2016) are implemented in this package. See <code><a href="#topic+influence.mixpoissonreg">influence.mixpoissonreg</a></code>,
<code><a href="#topic+local_influence.mixpoissonreg">local_influence.mixpoissonreg</a></code>, <code><a href="#topic+local_influence_plot.mixpoissonreg">local_influence_plot.mixpoissonreg</a></code>
and <code><a href="#topic+local_influence_autoplot.mixpoissonreg">local_influence_autoplot.mixpoissonreg</a></code>.
</p>


<h3>Value</h3>

<p><code>mixpoissonregML</code> returns an object of class &quot;mixpoissonreg&quot; whereas <code>mixpoissonregML.fit</code>
returns an object of class &quot;mixpoissonreg_fit&quot;. Both objects are given by lists containing the outputs from the model fit (Negative-Binomial or Poisson Inverse Gaussian regression).
</p>
<p>An object of the class &quot;mixpoissonreg&quot; is a list containing the following elements:
</p>

<ul>
<li> <p><code>coefficients</code> - a list with elements &quot;mean&quot; and &quot;precision&quot; containing the estimated coefficients of the model;
</p>
</li>
<li> <p><code>call</code> - the formula used by the model. If using <code>mixpoissonreg.fit</code>, this returns <code>NULL</code>.
</p>
</li>
<li> <p><code>modelname</code> - the fitted model, NB or PIG;
</p>
</li>
<li> <p><code>modeltype</code> - the abbreviated model name
</p>
</li>
<li> <p><code>residualname</code> - the name of the chosen residual in the call, 'pearson' or 'score';
</p>
</li>
<li> <p><code>niter</code> - number of iterations of the EM algorithm if method = &quot;EM&quot; and number of iterations
of the <code>optim</code> function, if method = &quot;ML&quot;;
</p>
</li>
<li> <p><code>start</code> - the initial guesses of the parameters
</p>
</li>
<li> <p><code>intercept</code> - vector indicating if the intercept is present in the mean and/or in the precision regressions;
</p>
</li>
<li> <p><code>link.mean</code> - link function of the mean;
</p>
</li>
<li> <p><code>link.precision</code> - link function of the precision parameter;
</p>
</li>
<li> <p><code>fitted.values</code> - a vector of fitted values in the response scale;
</p>
</li>
<li> <p><code>fitted.precisions</code> - a vector of fitted precisions;
</p>
</li>
<li> <p><code>efron.pseudo.r2</code> - Efron's pseudo R^2: the squared correlation between the response variables and the predicted values;
</p>
</li>
<li> <p><code>vcov</code> - covariance matrix of the parameters of the fitted model;
</p>
</li>
<li> <p><code>logLik</code> - log-likelihood at the estimated parameters;
</p>
</li>
<li> <p><code>Qfunction</code> - Q-function at the estimated parameters;
</p>
</li>
<li> <p><code>x</code> - the covariates related to the mean (if x = TRUE);
</p>
</li>
<li> <p><code>w</code> - the covariates related to the precision parameter (if w = TRUE);
</p>
</li>
<li> <p><code>y</code> - the response variables (if y = TRUE);
</p>
</li>
<li> <p><code>model</code> - if requested (the default), the model frame;
</p>
</li>
<li> <p><code>formula</code> - the formula supplied;
</p>
</li>
<li> <p><code>nobs</code> - number of observations
</p>
</li>
<li> <p><code>df.null</code> - the residual degrees of freedom for the model with constant mean and constant precision;
</p>
</li>
<li> <p><code>df.residual</code> - the residual degrees of freedom of the fitted model;
</p>
</li>
<li> <p><code>estimation_method</code> - the estimation method, &quot;EM&quot; or &quot;ML&quot;
</p>
</li>
<li> <p><code>residuals</code> - vector of raw residuals, that is, the response variable minus the fitted means;
</p>
</li>
<li> <p><code>std_errors</code> - the standard errors of the estimated parameters;
</p>
</li>
<li> <p><code>envelope</code> - the numerical envelopes used to build the Q-Q plot with simulated envelopes;
</p>
</li>
<li> <p><code>terms</code> - (only for <code>mixpoissonreg</code>)the <code>terms</code> object used;
</p>
</li>
<li> <p><code>levels</code> - (where relevant, only for <code>mixpoissonreg</code>) the levels of the factors used;
</p>
</li>
<li> <p><code>contrasts</code> - (where relevant, only for <code>mixpoissonreg</code>) the contrasts used.
</p>
</li></ul>



<h3>References</h3>

<p>DOI:10.1007/s11222-015-9601-6 doi: <a href="https://doi.org/10.1007/s11222-015-9601-6">10.1007/s11222-015-9601-6</a>(Barreto-Souza and Simas; 2016)
</p>
<p>URL:https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1751-5823.2005.tb00250.x (<a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1751-5823.2005.tb00250.x">Karlis and Xekalaki; 2005</a>)
</p>
<p>DOI:10.2307/3314912 doi: <a href="https://doi.org/10.2307/3314912">10.2307/3314912</a>(Lawless; 1987)
</p>
<p>Sellers, K.F. and Shmueli, G. (2010) <em>A flexible regression model for count data.</em> Ann. Appl. Stat., 4, 943-961
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.mixpoissonreg">summary.mixpoissonreg</a></code>, <code><a href="#topic+plot.mixpoissonreg">plot.mixpoissonreg</a></code>, <code><a href="#topic+autoplot.mixpoissonreg">autoplot.mixpoissonreg</a></code>,
<code><a href="#topic+residuals.mixpoissonreg">residuals.mixpoissonreg</a></code>, <code><a href="#topic+predict.mixpoissonreg">predict.mixpoissonreg</a></code>,<code><a href="#topic+influence.mixpoissonreg">influence.mixpoissonreg</a></code>,
<code><a href="#topic+cooks.distance.mixpoissonreg">cooks.distance.mixpoissonreg</a></code>,
<code><a href="#topic+local_influence.mixpoissonreg">local_influence.mixpoissonreg</a></code>, <code><a href="#topic+local_influence_plot.mixpoissonreg">local_influence_plot.mixpoissonreg</a></code>, <code><a href="#topic+local_influence_autoplot.mixpoissonreg">local_influence_autoplot.mixpoissonreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Examples using the Attendance dataset:

daysabs_progML &lt;- mixpoissonregML(daysabs ~ prog, data = Attendance)
summary(daysabs_progML)

</code></pre>

<hr>
<h2 id='plot.mixpoissonreg'>Plot Diagnostics for <code>mixpoissonreg</code> Objects</h2><span id='topic+plot.mixpoissonreg'></span>

<h3>Description</h3>

<p>Currently there are six plots available. They contain residual analysis and global influence diagnostics. The plots are selectable by
the <code>which</code> argument. The plots are: Residuals vs. obs. numbers; Normal Q-Q plots, which may contain simulated envelopes, if the fitted object
has simulated envelopes; Cook's distances vs. obs. numbers; Generalized Cook's distances vs. obs. numbers; Cook's distances vs. Generalized Cook's distances;
Response variables vs. fitted means. By default, the first two plots and the last two plots are provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixpoissonreg'
plot(
  x,
  which = c(1, 2, 5, 6),
  caption = list("Residuals vs Obs. number", "Normal Q-Q", "Cook's distance",
    "Generalized Cook's distance", "Cook's dist vs Generalized Cook's dist",
    "Response vs Fitted means"),
  sub.caption = NULL,
  qqline = TRUE,
  col.qqline = "black",
  main = "",
  line_col_env = "gray",
  line_col_median = "black",
  fill_col_env = "gray",
  fill_alpha_env = 0.7,
  ask = prod(graphics::par("mfcol")) &lt; length(which) &amp;&amp; grDevices::dev.interactive(),
  labels.id = names(stats::residuals(x)),
  label.pos = c(4, 2),
  type.cookplot = "h",
  id.n = 3,
  col.id = NULL,
  cex.id = 0.75,
  cex.oma.main = 1.25,
  cex.caption = 1,
  col.caption = "black",
  cex.points = 1,
  col.points = "black",
  include.modeltype = TRUE,
  include.residualtype = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.mixpoissonreg_+3A_x">x</code></td>
<td>
<p>object of class &quot;mixpoissonreg&quot; containing results from the fitted model.
If the model was fitted with envelope = 0, the Q-Q plot will be produced without envelopes.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_which">which</code></td>
<td>
<p>a list or vector indicating which plots should be displayed.     If a subset of the plots is required, specify a subset of the numbers 1:6,
see caption below for the different kinds. In
plot number 2, 'Normal Q-Q', if the <code>mixpoissonreg</code> object was fitted with envelopes, a quantile-quantile plot with simulated envelopes will be displayed.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_caption">caption</code></td>
<td>
<p>captions to appear above the plots; character vector or list of valid graphics annotations. Can be set to &quot;&quot; or NA to suppress all captions.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_sub.caption">sub.caption</code></td>
<td>
<p>common title-above the figures if there are more than one. If NULL, as by default, a possible abbreviated version of <code>deparse(x$call)</code> is used.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_qqline">qqline</code></td>
<td>
<p>logical; if <code>TRUE</code> and the fit does <em>not</em> contain simulated
envelopes, a qqline passing through the first and third quartiles of a standard normal distribution will be added to the normal Q-Q plot.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_col.qqline">col.qqline</code></td>
<td>
<p>color of the qqline.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_main">main</code></td>
<td>
<p>character; title to be placed at each plot additionally (and above) all captions.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_line_col_env">line_col_env</code></td>
<td>
<p>line color for the upper and lower quantile curves of the simulated envelopes if the <code>mixpoissonreg</code> object was fitted with envelopes.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_line_col_median">line_col_median</code></td>
<td>
<p>line color for the median curve of the simulated envelopes if the <code>mixpoissonreg</code> object was fitted with envelopes.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_fill_col_env">fill_col_env</code></td>
<td>
<p>fill color for the simulated envelopes if the <code>mixpoissonreg</code> object was fitted with envelopes.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_fill_alpha_env">fill_alpha_env</code></td>
<td>
<p>alpha of the envelope region, when the <code>mixpoissonreg</code> object was fitted with envelopes.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_ask">ask</code></td>
<td>
<p>logical; if <code>TRUE</code>, the user is asked before each plot.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_labels.id">labels.id</code></td>
<td>
<p>vector of labels, from which the labels for extreme points will be chosen. The default uses the observation numbers.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_label.pos">label.pos</code></td>
<td>
<p>positioning of labels, for the left half and right half of the graph respectively, for plots 2 and 6.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_type.cookplot">type.cookplot</code></td>
<td>
<p>character; what type of plot should be drawn for Cook's and Generalized Cook's distances (plots 3 and 4). The default is 'h'.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_id.n">id.n</code></td>
<td>
<p>number of points to be labelled in each plot, starting with the most extreme.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_col.id">col.id</code></td>
<td>
<p>color of point labels.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_cex.id">cex.id</code></td>
<td>
<p>magnification of point labels.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_cex.oma.main">cex.oma.main</code></td>
<td>
<p>controls the size of the sub.caption only if that is above the figures when there is more than one.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_cex.caption">cex.caption</code></td>
<td>
<p>controls the size of caption.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_col.caption">col.caption</code></td>
<td>
<p>controls the caption color.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_cex.points">cex.points</code></td>
<td>
<p>controls the size of the points.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_col.points">col.points</code></td>
<td>
<p>controls the colors of the points.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_include.modeltype">include.modeltype</code></td>
<td>
<p>logical. Indicates whether the model type ('NB' or 'PIG') should be displayed on the captions.</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_include.residualtype">include.residualtype</code></td>
<td>
<p>local. Indicates whether the name of the residual ('Pearson' or 'Score') should be displayed on the caption of plot 1 (Residuals vs. Index).</p>
</td></tr>
<tr><td><code id="plot.mixpoissonreg_+3A_...">...</code></td>
<td>
<p>graphical parameters to be passed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>plot</code> method is implemented following the same structure as the <a href="stats.html#topic+plot.lm">plot.lm</a>, so it will be easy to be used by practitioners that
are familiar with <code>glm</code> objects.
</p>
<p>These plots allows one to perform residuals analsysis and influence diagnostics. There are other global influence functions, see <code><a href="#topic+influence.mixpoissonreg">influence.mixpoissonreg</a></code>.
</p>
<p>See Barreto-Souza and Simas (2016), Cook and Weisberg (1982) and Zhu et al. (2001).
</p>


<h3>Value</h3>

<p>It is called for its side effects.
</p>


<h3>References</h3>

<p>DOI:10.1007/s11222-015-9601-6 doi: <a href="https://doi.org/10.1007/s11222-015-9601-6">10.1007/s11222-015-9601-6</a>(Barreto-Souza and Simas; 2016)
</p>
<p>Cook, D.R. and Weisberg, S. (1982) <em>Residuals and Influence in Regression</em>. (New York: Chapman and Hall, 1982)
</p>
<p>Zhu, H.T., Lee, S.Y., Wei, B.C., Zhu, J. (2001) <em>Case-deletion measures formodels with incomplete data.</em> Biometrika, 88, 727–737.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+autoplot.mixpoissonreg">autoplot.mixpoissonreg</a></code>, <code><a href="#topic+local_influence_plot.mixpoissonreg">local_influence_plot.mixpoissonreg</a></code>, <code><a href="#topic+local_influence_autoplot.mixpoissonreg">local_influence_autoplot.mixpoissonreg</a></code>,
<code><a href="#topic+summary.mixpoissonreg">summary.mixpoissonreg</a></code>, <code><a href="#topic+predict.mixpoissonreg">predict.mixpoissonreg</a></code>, <code><a href="#topic+influence.mixpoissonreg">influence.mixpoissonreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>daysabs_prog &lt;- mixpoissonreg(daysabs ~ prog, data = Attendance)
plot(daysabs_prog)

</code></pre>

<hr>
<h2 id='predict.mixpoissonreg'>Predict Method for <code>mixpoissonreg</code> Objects</h2><span id='topic+predict.mixpoissonreg'></span>

<h3>Description</h3>

<p>Function to obtain various predictions based on the fitted mixed Poisson regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixpoissonreg'
predict(
  object,
  newdata = NULL,
  type = c("response", "link", "precision", "variance"),
  se.fit = FALSE,
  interval = c("none", "confidence", "prediction"),
  level = 0.95,
  nsim_pred = 100,
  nsim_pred_y = 100,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.mixpoissonreg_+3A_object">object</code></td>
<td>
<p>object of class &quot;mixpoissonreg&quot; containing results from the fitted model.</p>
</td></tr>
<tr><td><code id="predict.mixpoissonreg_+3A_newdata">newdata</code></td>
<td>
<p>optionally, a data frame in which to look for variables with which to predict. If omitted, the fitted response values will be provided.</p>
</td></tr>
<tr><td><code id="predict.mixpoissonreg_+3A_type">type</code></td>
<td>
<p>the type of prediction. The default is the &quot;response&quot; type, which provided the estimated values for the means. The type &quot;link&quot; provides the estimates for the linear predictor. The type &quot;precision&quot; provides estimates for the precision parameters whereas the type &quot;variance&quot; provides estimates for the variances.</p>
</td></tr>
<tr><td><code id="predict.mixpoissonreg_+3A_se.fit">se.fit</code></td>
<td>
<p>logical switch indicating if standard errors on the scale of linear predictors should be returned. If <code>TRUE</code>, it only returns the standard deviations of
the linear predictors when type = 'link', otherwise returns NA and a warning indicating that the type must be 'link'.  When using <code>mixpoissonreg</code> objects, the fit must be done with <code>x = TRUE</code>.</p>
</td></tr>
<tr><td><code id="predict.mixpoissonreg_+3A_interval">interval</code></td>
<td>
<p>Type of interval calculation for the response variables, 'none', 'confidence' or 'prediction'. If 'confidence', the confidence intervals for the means are returned.
If 'prediction', prediction intervals for future response variables are reported. For confidence intervals, the type of the prediction must be 'response' or 'link'.
For prediction intervals the type of prediction must be 'response'. For 'confidence' intervals, when using <code>mixpoissonreg</code> objects, the fit must be done with <code>x = TRUE</code> and for
predictions intervals, the fit must be done with <code>x = TRUE</code> and <code>w = TRUE</code>.</p>
</td></tr>
<tr><td><code id="predict.mixpoissonreg_+3A_level">level</code></td>
<td>
<p>Tolerance/confidence level. The default is set to 0.95.</p>
</td></tr>
<tr><td><code id="predict.mixpoissonreg_+3A_nsim_pred">nsim_pred</code></td>
<td>
<p>number of means and predictions to be generated in each step of the simulation. The default is set to 100.</p>
</td></tr>
<tr><td><code id="predict.mixpoissonreg_+3A_nsim_pred_y">nsim_pred_y</code></td>
<td>
<p>number of response variables generated for each pair of mean and precision to compute the prediction intervals. The default is set to 100.</p>
</td></tr>
<tr><td><code id="predict.mixpoissonreg_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>se.fit</code> argument only returns a non-NA vector for type = 'link', that is, on the scale of the linear predictor for the mean parameter. For the response scale,
one can obtain confidence or prediction intervals. It is important to notice that confidence intervals <em>must not</em> be used for future observations as they will underestimate
the uncertainty. In this case prediction intervals should be used. Currently, we do not have closed-form expressions for the prediction interval and, therefore, they
are obtained by simulation and can be computationally-intensive.
</p>


<h3>Value</h3>

<p>A vector containing the predicted values if <code>se.fit=FALSE</code>, a list with
elements <em>fit</em> and <em>se.fit</em> if <code>se.fit=TRUE</code>, and a matrix if <code>interval</code>
is set to <em>confidence</em> or <em>prediction</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitted.mixpoissonreg">fitted.mixpoissonreg</a></code>, <code><a href="#topic+summary.mixpoissonreg">summary.mixpoissonreg</a></code>, <code><a href="#topic+plot.mixpoissonreg">plot.mixpoissonreg</a></code>, <code><a href="#topic+autoplot.mixpoissonreg">autoplot.mixpoissonreg</a></code>,
<code><a href="#topic+coef.mixpoissonreg">coef.mixpoissonreg</a></code>, <code><a href="#topic+vcov.mixpoissonreg">vcov.mixpoissonreg</a></code>,
<code><a href="#topic+plot.mixpoissonreg">plot.mixpoissonreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
daysabs_prog &lt;- mixpoissonreg(daysabs ~ prog, data = Attendance)
predict(daysabs_prog)

</code></pre>

<hr>
<h2 id='residuals.mixpoissonreg'>Residuals Method for <code>mixpoissonreg</code> Objects</h2><span id='topic+residuals.mixpoissonreg'></span>

<h3>Description</h3>

<p>Function to return 'pearson' or 'score' residuals for mixed Poisson regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixpoissonreg'
residuals(object, type = c("pearson", "score"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.mixpoissonreg_+3A_object">object</code></td>
<td>
<p>an object of class &quot;mixpoissonreg&quot; containing results from the fitted model.</p>
</td></tr>
<tr><td><code id="residuals.mixpoissonreg_+3A_type">type</code></td>
<td>
<p>the type of residual to be returned. Currently, the options are 'pearson' or 'score'. The default is set to 'pearson'. Notice that these
residuals coincide for Negative-Binomial models.</p>
</td></tr>
<tr><td><code id="residuals.mixpoissonreg_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the residuals of a <em>mixpoissonreg</em> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.mixpoissonreg">plot.mixpoissonreg</a></code>, <code><a href="#topic+predict.mixpoissonreg">predict.mixpoissonreg</a></code>,
<code><a href="#topic+autoplot.mixpoissonreg">autoplot.mixpoissonreg</a></code>, <code><a href="#topic+summary.mixpoissonreg">summary.mixpoissonreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
daysabs_prog &lt;- mixpoissonreg(daysabs ~ prog, data = Attendance)
residuals(daysabs_prog)

</code></pre>

<hr>
<h2 id='summary.mixpoissonreg'>Summary Method for <code>mixpoissonreg</code> Objects.</h2><span id='topic+summary.mixpoissonreg'></span>

<h3>Description</h3>

<p>Function providing a summary of results related to mixed Poisson regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixpoissonreg'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.mixpoissonreg_+3A_object">object</code></td>
<td>
<p>an object of class &quot;mixpoissonreg&quot; containing results from the fitted model.</p>
</td></tr>
<tr><td><code id="summary.mixpoissonreg_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>summary_mixpoissonreg</code> containing several
informations of a <em>mixpoissonreg</em> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.mixpoissonreg">plot.mixpoissonreg</a></code>, <code><a href="#topic+autoplot.mixpoissonreg">autoplot.mixpoissonreg</a></code>,
<code><a href="#topic+local_influence_plot.mixpoissonreg">local_influence_plot.mixpoissonreg</a></code>, <code><a href="#topic+local_influence_autoplot.mixpoissonreg">local_influence_autoplot.mixpoissonreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>daysabs_prog &lt;- mixpoissonreg(daysabs ~ prog, data = Attendance)
summary(daysabs_prog)

</code></pre>

<hr>
<h2 id='tidy_local_influence'>Tidy Functions for Local Influence Diagnostics</h2><span id='topic+tidy_local_influence'></span><span id='topic+local_influence_autoplot'></span><span id='topic+local_influence_benchmarks'></span>

<h3>Description</h3>

<p>Functions to provide tidy outputs or ggplot2-based plots of local influence diagnostics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>local_influence_autoplot(model, ...)

tidy_local_influence(model, ...)

local_influence_benchmarks(model, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tidy_local_influence_+3A_model">model</code></td>
<td>
<p>A model object for which local influence diagnostics are desired.</p>
</td></tr>
<tr><td><code id="tidy_local_influence_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Local influence diagnostics were first introduced by Cook (1986), where several perturbation schemes were introduced and normal curvatures were obtained. Poon and Poon (1999)
introduced the conformal normal curvature, which has nice properties and takes values on the unit interval <code class="reqn">[0,1]</code>. Zhu and Lee (2001) following Cook (1986) and Poon and Poon (1999)
introduced normal and conformal normal curvatures for EM-based models.
</p>


<h3>Value</h3>

<p>The <em>tidy_local_influence</em> method returns a <em>tibble</em> containing the resulting perturbation schemes as columns.
The <em>local_influence_benchmarks</em> method returns a <em>tibble</em> with the benchmarks as columns.
The <em>local_influence_autoplot</em> method is called for its side effects.
</p>


<h3>References</h3>

<p>Cook, R. D. (1986) <em>Assessment of Local Influence.</em> Journal of the Royal Statistical Society. Series B (Methodological), Vol. 48, pp.133-169. <a href="https://rss.onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1986.tb01398.x">https://rss.onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1986.tb01398.x</a>
</p>
<p>Poon, W.-Y. and Poon, Y.S. (1999) <em>Conformal normal curvature and assessment of local influence.</em>  Journal of the Royal Statistical Society. Series B (Methodological), Vol. 61, pp.51-61. <a href="https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00162">https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00162</a>
</p>
<p>Zhu, H.-T. and Lee, S.-Y. (2001) <em>Local influence for incomplete data models.</em> Journal of the Royal Statistical Society. Series B (Methodological), Vol. 63, pp.111-126. <a href="https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00279">https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00279</a>
</p>

<hr>
<h2 id='tidy_local_influence.mixpoissonreg'>Tidy Functions for Local Influence Diagnostics for <code>mixpoissonreg</code> Objects</h2><span id='topic+tidy_local_influence.mixpoissonreg'></span><span id='topic+local_influence_benchmarks.mixpoissonreg'></span>

<h3>Description</h3>

<p>Functions to provide tidy outputs of local influence diagnostics. <code>tidy_local_influence.mixpoissonreg</code>
provides a <code><a href="tibble.html#topic+tibble">tibble::tibble()</a></code> containing the local influence diagnostics under the chosen perturbation schemes.
<code>local_influence_benchmarks.mixpoissonreg</code> provides a <code><a href="tibble.html#topic+tibble">tibble::tibble()</a></code> with a single row and one column
for each selected perturbation scheme containing influential benchmarks for each perturbation scheme.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixpoissonreg'
tidy_local_influence(
  model,
  perturbation = c("case_weights", "hidden_variable", "mean_explanatory",
    "precision_explanatory", "simultaneous_explanatory"),
  curvature = c("conformal", "normal"),
  direction = c("canonical", "max.eigen"),
  parameters = c("all", "mean", "precision"),
  mean.covariates = NULL,
  precision.covariates = NULL,
  ...
)

## S3 method for class 'mixpoissonreg'
local_influence_benchmarks(
  model,
  perturbation = c("case_weights", "hidden_variable", "mean_explanatory",
    "precision_explanatory", "simultaneous_explanatory"),
  curvature = c("conformal", "normal"),
  direction = c("canonical", "max.eigen"),
  parameters = c("all", "mean", "precision"),
  mean.covariates = NULL,
  precision.covariates = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tidy_local_influence.mixpoissonreg_+3A_model">model</code></td>
<td>
<p>A <code>mixpoissonreg</code> model.</p>
</td></tr>
<tr><td><code id="tidy_local_influence.mixpoissonreg_+3A_perturbation">perturbation</code></td>
<td>
<p>a list or vector of perturbation schemes to be returned. The currently available schemes are
&quot;case_weights&quot;, &quot;hidden_variable&quot;, &quot;mean_explanatory&quot;, &quot;precision_explanatory&quot;, &quot;simultaneous_explanatory&quot;. See Barreto-Souza and Simas (2016) for further details.</p>
</td></tr>
<tr><td><code id="tidy_local_influence.mixpoissonreg_+3A_curvature">curvature</code></td>
<td>
<p>the curvature to be returned, 'conformal' for the conformal normal curvature (see Zhu and Lee, 2001 and Poon and Poon, 1999) or
'normal' (see Zhu and Lee, 2001 and Cook, 1986).</p>
</td></tr>
<tr><td><code id="tidy_local_influence.mixpoissonreg_+3A_direction">direction</code></td>
<td>
<p>the 'max.eigen' returns the eigenvector associated to the largest eigenvalue of the perturbation matrix. The 'canonical' considers
the curvatures under the canonical directions, which is known as &quot;total local curvature&quot; (see Lesaffre and Verbeke, 1998). For conformal
normal curvatures both of them coincide. The default is 'canonical'.</p>
</td></tr>
<tr><td><code id="tidy_local_influence.mixpoissonreg_+3A_parameters">parameters</code></td>
<td>
<p>the parameter to which the local influence will be computed. The options are 'all', 'mean' and 'precision'.
This argument affects the 'case_weights' and 'hidden_variable' perturbation schemes. The default is 'all'.</p>
</td></tr>
<tr><td><code id="tidy_local_influence.mixpoissonreg_+3A_mean.covariates">mean.covariates</code></td>
<td>
<p>a list or vector of characters containing the mean-explanatory variables to be used in the 'mean-explanatory' and 'simultaneous-explanatory'
perturbation schemes. If NULL, the 'mean-explanatory' and 'simultaneous-explanatory' perturbation schemes will be computed by perturbing all
mean-related covariates. The default is NULL.</p>
</td></tr>
<tr><td><code id="tidy_local_influence.mixpoissonreg_+3A_precision.covariates">precision.covariates</code></td>
<td>
<p>a list or vector of characters containing the precision-explanatory variables to be used in the 'precision-explanatory'
and 'simultaneous-explanatory'
perturbation schemes. If NULL, the 'precision-explanatory' and 'simultaneous-explanatory' perturbation schemes will be computed by perturbing all
precision-related covariates. The default is NULL.</p>
</td></tr>
<tr><td><code id="tidy_local_influence.mixpoissonreg_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble containing the perturbations schemes as columns.
</p>


<h3>References</h3>

<p>DOI:10.1007/s11222-015-9601-6 doi: <a href="https://doi.org/10.1007/s11222-015-9601-6">10.1007/s11222-015-9601-6</a>(Barreto-Souza and Simas; 2016)
</p>
<p>Cook, R. D. (1986) <em>Assessment of Local Influence.</em> Journal of the Royal Statistical Society. Series B (Methodological), Vol. 48, pp.133-169. <a href="https://rss.onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1986.tb01398.x">https://rss.onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1986.tb01398.x</a>
</p>
<p>Lesaffre, E. and Verbeke, G. (1998) <em>Local Influence in Linear Mixed Models</em>. Biometrics, 54, pp. 570-582.
</p>
<p>Poon, W.-Y. and Poon, Y.S. (1999) <em>Conformal normal curvature and assessment of local influence.</em>  Journal of the Royal Statistical Society. Series B (Methodological), Vol. 61, pp.51-61. <a href="https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00162">https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00162</a>
</p>
<p>Zhu, H.-T. and Lee, S.-Y. (2001) <em>Local influence for incomplete data models.</em> Journal of the Royal Statistical Society. Series B (Methodological), Vol. 63, pp.111-126. <a href="https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00279">https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00279</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glance.mixpoissonreg">glance.mixpoissonreg</a></code>, <code><a href="#topic+augment.mixpoissonreg">augment.mixpoissonreg</a></code>, <code><a href="#topic+tidy.mixpoissonreg">tidy.mixpoissonreg</a></code>, <code><a href="#topic+autoplot.mixpoissonreg">autoplot.mixpoissonreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
daysabs_prog &lt;- mixpoissonreg(daysabs ~ prog | prog, data = Attendance)
tidy_local_influence(daysabs_prog)

</code></pre>

<hr>
<h2 id='tidy.mixpoissonreg'>Tidy a <code>mixpoissonreg</code> object</h2><span id='topic+tidy.mixpoissonreg'></span><span id='topic+tidy'></span>

<h3>Description</h3>

<p>Tidy returns a <code><a href="tibble.html#topic+tibble">tibble::tibble()</a></code> containing
informations on the coefficients of the model, such as the estimated parameters,
standard errors, z-statistics and p-values. Additionally, it may return confidence
intervals for the model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixpoissonreg'
tidy(x, conf.int = FALSE, conf.level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tidy.mixpoissonreg_+3A_x">x</code></td>
<td>
<p>A <code>mixpoissonreg</code> object.</p>
</td></tr>
<tr><td><code id="tidy.mixpoissonreg_+3A_conf.int">conf.int</code></td>
<td>
<p>Logical indicating whether or not to include a confidence interval in the tidied output. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="tidy.mixpoissonreg_+3A_conf.level">conf.level</code></td>
<td>
<p>The confidence level to use for the confidence interval if conf.int = TRUE.
Must be strictly greater than 0 and less than 1. Defaults to 0.95, which corresponds to a 95 percent confidence interval.</p>
</td></tr>
<tr><td><code id="tidy.mixpoissonreg_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>tibble</em> containing the coefficients of the fitted <em>mixpoissonreg</em>
object along with its estimates, std. errors, z-statistics and p-values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glance.mixpoissonreg">glance.mixpoissonreg</a></code>, <code><a href="#topic+augment.mixpoissonreg">augment.mixpoissonreg</a></code>, <code><a href="#topic+tidy_local_influence.mixpoissonreg">tidy_local_influence.mixpoissonreg</a></code>,
<code><a href="#topic+autoplot.mixpoissonreg">autoplot.mixpoissonreg</a></code>, <code><a href="#topic+local_influence_autoplot.mixpoissonreg">local_influence_autoplot.mixpoissonreg</a></code>
</p>

<hr>
<h2 id='vcov.mixpoissonreg'>Calculate Variance-Covariance Matrix for <code>mixpoissonreg</code> Objects</h2><span id='topic+vcov.mixpoissonreg'></span>

<h3>Description</h3>

<p>Returns the variance-covariance matrix of the parameters for fitted mixed Poisson regression models. The <code>parameters</code> argument
indicates for which parameters the variance-covariance matrix should be computed, namely, 'mean' for mean-relatex parameters or 'precision' for precision-related parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixpoissonreg'
vcov(object, parameters = c("all", "mean", "precision"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov.mixpoissonreg_+3A_object">object</code></td>
<td>
<p>an object of class &quot;mixpoissonreg&quot; containing results from the fitted model.</p>
</td></tr>
<tr><td><code id="vcov.mixpoissonreg_+3A_parameters">parameters</code></td>
<td>
<p>a string to determine which coefficients should be extracted: 'all' extracts all coefficients, 'mean' extracts the coefficients of the mean parameters and 'precision' extracts coefficients of the precision parameters.</p>
</td></tr>
<tr><td><code id="vcov.mixpoissonreg_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the covariance matrix of a <em>mixpoissonreg</em> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coef.mixpoissonreg">coef.mixpoissonreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
daysabs_prog &lt;- mixpoissonreg(daysabs ~ prog, data = Attendance)
vcov(daysabs_prog)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
