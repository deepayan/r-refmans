<!DOCTYPE html><html><head><title>Help for package nlmixr2extra</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nlmixr2extra}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adaptivelassoCoefficients'><p>Return Adaptive lasso coefficients after finding optimal t</p></a></li>
<li><a href='#addCatCovariates'><p>Make dummy variable cols and updated covarsVec</p></a></li>
<li><a href='#addorremoveCovariate'><p>Add covariate</p></a></li>
<li><a href='#adjustedlassoCoefficients'><p>Return Adjusted adaptive lasso coefficients after finding optimal t</p></a></li>
<li><a href='#backwardSearch'><p>Backward covariate search</p></a></li>
<li><a href='#bootplot'><p>Produce delta objective function for boostrap</p></a></li>
<li><a href='#bootstrapFit'><p>Bootstrap nlmixr2 fit</p></a></li>
<li><a href='#buildcovInfo'><p>Build covInfo list from varsVec and covarsVec</p></a></li>
<li><a href='#buildupatedUI'><p>Build updated from the covariate and variable vector list</p></a></li>
<li><a href='#covarSearchAuto'><p>Stepwise Covariate Model-selection (SCM) method</p></a></li>
<li><a href='#foldgen'><p>Stratified cross-validation fold generator function, inspired from the caret</p></a></li>
<li><a href='#forwardSearch'><p>Forward covariate search</p></a></li>
<li><a href='#horseshoeSummardf'><p>Create Horseshoe summary posterior estimates</p></a></li>
<li><a href='#knit_print.nlmixr2FitCore'><p>Extract the equations from an nlmixr2/rxode2 model to produce a 'LaTeX'</p>
equation.</a></li>
<li><a href='#lassoCoefficients'><p>Return Final lasso coefficients after finding optimal t</p></a></li>
<li><a href='#lassoSummardf'><p>Create Lasso summary posterior estimates</p></a></li>
<li><a href='#normalizedData'><p>Function to return data of normalized covariates</p></a></li>
<li><a href='#optimUnisampling'><p>Sample from uniform distribution by optim</p></a></li>
<li><a href='#preconditionFit'><p>Linearly re-parameterize the model to be less sensitive to rounding errors</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#regularmodel'><p>Regular lasso model</p></a></li>
<li><a href='#theoFitOde'><p>Example single dose Theophylline ODE model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Nonlinear Mixed Effects Models in Population PK/PD, Extra
Support Functions</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.9</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matthew Fidler &lt;matthew.fidler@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit and compare nonlinear mixed-effects models in
    differential equations with flexible dosing information commonly seen
    in pharmacokinetics and pharmacodynamics (Almquist, Leander, and
    Jirstrand 2015 &lt;<a href="https://doi.org/10.1007%2Fs10928-015-9409-1">doi:10.1007/s10928-015-9409-1</a>&gt;). Differential equation
    solving is by compiled C code provided in the 'rxode2' package (Wang,
    Hallow, and James 2015 &lt;<a href="https://doi.org/10.1002%2Fpsp4.12052">doi:10.1002/psp4.12052</a>&gt;). This package is for
    support functions like preconditioned fits
    &lt;<a href="https://doi.org/10.1208%2Fs12248-016-9866-5">doi:10.1208/s12248-016-9866-5</a>&gt;, boostrap and stepwise covariate
    selection.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://nlmixr2.github.io/nlmixr2extra/">https://nlmixr2.github.io/nlmixr2extra/</a>,
<a href="https://github.com/nlmixr2/nlmixr2extra/">https://github.com/nlmixr2/nlmixr2extra/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/nlmixr2/nlmixr2extra/issues/">https://github.com/nlmixr2/nlmixr2extra/issues/</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate, cli (&ge; 3.4.0), crayon, data.table, digest,
ggplot2, ggtext, knitr, lotri, methods, nlme, nlmixr2est (&ge;
2.1.1), Rcpp, rxode2 (&ge; 2.0.10), stats, symengine, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>brms, nlmixr2data, testthat (&ge; 3.0.0), withr, dplyr,
devtools, rxode2parse</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-31 12:36:04 UTC; matt</td>
</tr>
<tr>
<td>Author:</td>
<td>Matthew Fidler <a href="https://orcid.org/0000-0001-8538-6691"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Vipul Mann [aut],
  Vishal Sarsani <a href="https://orcid.org/0000-0002-9272-3438"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Christian Bartels [ctb],
  Bill Denney <a href="https://orcid.org/0000-0002-5759-428X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-31 14:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='adaptivelassoCoefficients'>Return Adaptive lasso coefficients after finding optimal t</h2><span id='topic+adaptivelassoCoefficients'></span>

<h3>Description</h3>

<p>Return Adaptive lasso coefficients after finding optimal t
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adaptivelassoCoefficients(
  fit,
  varsVec,
  covarsVec,
  catvarsVec,
  constraint = 1e-08,
  stratVar = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adaptivelassoCoefficients_+3A_fit">fit</code></td>
<td>
<p>nlmixr2 fit.</p>
</td></tr>
<tr><td><code id="adaptivelassoCoefficients_+3A_varsvec">varsVec</code></td>
<td>
<p>character vector of variables that need to be added</p>
</td></tr>
<tr><td><code id="adaptivelassoCoefficients_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be added</p>
</td></tr>
<tr><td><code id="adaptivelassoCoefficients_+3A_catvarsvec">catvarsVec</code></td>
<td>
<p>character vector of categorical covariates that need to be added</p>
</td></tr>
<tr><td><code id="adaptivelassoCoefficients_+3A_constraint">constraint</code></td>
<td>
<p>theta cutoff. below cutoff then the theta will be fixed to zero.</p>
</td></tr>
<tr><td><code id="adaptivelassoCoefficients_+3A_stratvar">stratVar</code></td>
<td>
<p>A variable to stratify on for cross-validation.</p>
</td></tr>
<tr><td><code id="adaptivelassoCoefficients_+3A_...">...</code></td>
<td>
<p>Other parameters to be passed to optimalTvaluelasso</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return data frame of final lasso coefficients
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
one.cmt &lt;- function() {
  ini({
    tka &lt;- 0.45; label("Ka")
    tcl &lt;- log(c(0, 2.7, 100)); label("Cl")
    tv &lt;- 3.45; label("V")
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd &lt;- 0.7
  })
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl + eta.cl)
    v &lt;- exp(tv + eta.v)
    linCmt() ~ add(add.sd)
  })
}

d &lt;- nlmixr2data::theo_sd
d$SEX &lt;-0
d$SEX[d$ID&lt;=6] &lt;-1

fit &lt;-
 nlmixr2(
   one.cmt, d,
   est = "saem",
   control = list(print = 0)
 )
varsVec &lt;- c("ka","cl","v")
covarsVec &lt;- c("WT")
catvarsVec &lt;- c("SEX")

# Adaptive Lasso coefficients:

lassoDf &lt;- adaptivelassoCoefficients(fit, varsVec, covarsVec, catvarsVec)

## End(Not run)
</code></pre>

<hr>
<h2 id='addCatCovariates'>Make dummy variable cols and updated covarsVec</h2><span id='topic+addCatCovariates'></span>

<h3>Description</h3>

<p>Make dummy variable cols and updated covarsVec
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addCatCovariates(data, covarsVec, catcovarsVec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addCatCovariates_+3A_data">data</code></td>
<td>
<p>data frame used in the analysis</p>
</td></tr>
<tr><td><code id="addCatCovariates_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be
added</p>
</td></tr>
<tr><td><code id="addCatCovariates_+3A_catcovarsvec">catcovarsVec</code></td>
<td>
<p>character vector of categorical covariates that
need to be added</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return updated Data along with the updated covarsVec
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani
</p>

<hr>
<h2 id='addorremoveCovariate'>Add covariate</h2><span id='topic+addorremoveCovariate'></span>

<h3>Description</h3>

<p>Add covariate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addorremoveCovariate(ui, varName, covariate, add = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addorremoveCovariate_+3A_ui">ui</code></td>
<td>
<p>compiled rxode2 nlmir2 model or fit</p>
</td></tr>
<tr><td><code id="addorremoveCovariate_+3A_varname">varName</code></td>
<td>
<p>the variable name to which the given covariate is to be added</p>
</td></tr>
<tr><td><code id="addorremoveCovariate_+3A_covariate">covariate</code></td>
<td>
<p>the covariate that needs string to be constructed</p>
</td></tr>
<tr><td><code id="addorremoveCovariate_+3A_add">add</code></td>
<td>
<p>boolean indicating if the covariate needs to be added or removed.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matthew Fidler, Vishal Sarsani
</p>

<hr>
<h2 id='adjustedlassoCoefficients'>Return Adjusted adaptive lasso coefficients after finding optimal t</h2><span id='topic+adjustedlassoCoefficients'></span>

<h3>Description</h3>

<p>Return Adjusted adaptive lasso coefficients after finding optimal t
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adjustedlassoCoefficients(
  fit,
  varsVec,
  covarsVec,
  catvarsVec,
  constraint = 1e-08,
  stratVar = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adjustedlassoCoefficients_+3A_fit">fit</code></td>
<td>
<p>nlmixr2 fit.</p>
</td></tr>
<tr><td><code id="adjustedlassoCoefficients_+3A_varsvec">varsVec</code></td>
<td>
<p>character vector of variables that need to be added</p>
</td></tr>
<tr><td><code id="adjustedlassoCoefficients_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be added</p>
</td></tr>
<tr><td><code id="adjustedlassoCoefficients_+3A_catvarsvec">catvarsVec</code></td>
<td>
<p>character vector of categorical covariates that need to be added</p>
</td></tr>
<tr><td><code id="adjustedlassoCoefficients_+3A_constraint">constraint</code></td>
<td>
<p>theta cutoff. below cutoff then the theta will be fixed to zero.</p>
</td></tr>
<tr><td><code id="adjustedlassoCoefficients_+3A_stratvar">stratVar</code></td>
<td>
<p>A variable to stratify on for cross-validation.</p>
</td></tr>
<tr><td><code id="adjustedlassoCoefficients_+3A_...">...</code></td>
<td>
<p>Other parameters to be passed to optimalTvaluelasso</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return data frame of final lasso coefficients
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
one.cmt &lt;- function() {
  ini({
    tka &lt;- 0.45; label("Ka")
    tcl &lt;- log(c(0, 2.7, 100)); label("Cl")
    tv &lt;- 3.45; label("V")
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd &lt;- 0.7
  })
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl + eta.cl)
    v &lt;- exp(tv + eta.v)
    linCmt() ~ add(add.sd)
  })
}

d &lt;- nlmixr2data::theo_sd
d$SEX &lt;-0
d$SEX[d$ID&lt;=6] &lt;-1

fit &lt;- nlmixr2(one.cmt, d, est = "saem", control = list(print = 0))
varsVec &lt;- c("ka","cl","v")
covarsVec &lt;- c("WT")
catvarsVec &lt;- c("SEX")

# Adaptive Lasso coefficients:

lassoDf &lt;- adjustedlassoCoefficients(fit,varsVec,covarsVec,catvarsVec)

## End(Not run)
</code></pre>

<hr>
<h2 id='backwardSearch'>Backward covariate search</h2><span id='topic+backwardSearch'></span>

<h3>Description</h3>

<p>Backward covariate search
</p>


<h3>Usage</h3>

<pre><code class='language-R'>backwardSearch(
  varsVec,
  covarsVec,
  catvarsVec = NULL,
  fitorig,
  fitupdated,
  pVal = 0.01,
  reFitCovars = FALSE,
  outputDir,
  restart = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="backwardSearch_+3A_varsvec">varsVec</code></td>
<td>
<p>character vector of variables that need to be added</p>
</td></tr>
<tr><td><code id="backwardSearch_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be added</p>
</td></tr>
<tr><td><code id="backwardSearch_+3A_catvarsvec">catvarsVec</code></td>
<td>
<p>character vector of categorical covariates that need to be added</p>
</td></tr>
<tr><td><code id="backwardSearch_+3A_fitorig">fitorig</code></td>
<td>
<p>the original 'fit' object before forward search</p>
</td></tr>
<tr><td><code id="backwardSearch_+3A_fitupdated">fitupdated</code></td>
<td>
<p>the updated 'fit' object, if any, after the forward search</p>
</td></tr>
<tr><td><code id="backwardSearch_+3A_pval">pVal</code></td>
<td>
<p>p-value that should be used for selecting covariates in the forward search</p>
</td></tr>
<tr><td><code id="backwardSearch_+3A_refitcovars">reFitCovars</code></td>
<td>
<p>if the covariates should be added before performing backward search - useful for directly performing backward search without forward search; default is FALSE</p>
</td></tr>
<tr><td><code id="backwardSearch_+3A_outputdir">outputDir</code></td>
<td>
<p>the name of the output directory that stores the covariate search result</p>
</td></tr>
<tr><td><code id="backwardSearch_+3A_restart">restart</code></td>
<td>
<p>a boolean that controls if the search should be restarted; default is FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the updated 'fit' object at the end of the backward search and a table of information for all the covariates tested
</p>


<h3>Author(s)</h3>

<p>Vipul Mann, Matthew Fidler, Vishal Sarsani
</p>

<hr>
<h2 id='bootplot'>Produce delta objective function for boostrap</h2><span id='topic+bootplot'></span><span id='topic+bootplot.nlmixr2FitCore'></span>

<h3>Description</h3>

<p>Produce delta objective function for boostrap
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootplot(x, ...)

## S3 method for class 'nlmixr2FitCore'
bootplot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootplot_+3A_x">x</code></td>
<td>
<p>fit object</p>
</td></tr>
<tr><td><code id="bootplot_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fit traceplot or nothing.
</p>


<h3>Author(s)</h3>

<p>Vipul Mann,  Matthew L. Fidler
</p>


<h3>References</h3>

<p>R Niebecker,  MO Karlsson. (2013)
<em>Are datasets for NLME models large enough for a bootstrap to provide reliable parameter uncertainty distributions?</em>
PAGE 2013.
<a href="https://www.page-meeting.org/?abstract=2899">https://www.page-meeting.org/?abstract=2899</a>
</p>

<hr>
<h2 id='bootstrapFit'>Bootstrap nlmixr2 fit</h2><span id='topic+bootstrapFit'></span>

<h3>Description</h3>

<p>Bootstrap input dataset and rerun the model to get confidence bounds and aggregated parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrapFit(
  fit,
  nboot = 200,
  nSampIndiv,
  stratVar,
  stdErrType = c("perc", "se"),
  ci = 0.95,
  pvalues = NULL,
  restart = FALSE,
  plotHist = FALSE,
  fitName = as.character(substitute(fit))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootstrapFit_+3A_fit">fit</code></td>
<td>
<p>the nlmixr2 fit object</p>
</td></tr>
<tr><td><code id="bootstrapFit_+3A_nboot">nboot</code></td>
<td>
<p>an integer giving the number of bootstrapped models to
be fit; default value is 200</p>
</td></tr>
<tr><td><code id="bootstrapFit_+3A_nsampindiv">nSampIndiv</code></td>
<td>
<p>an integer specifying the number of samples in
each bootstrapped sample; default is the number of unique
subjects in the original dataset</p>
</td></tr>
<tr><td><code id="bootstrapFit_+3A_stratvar">stratVar</code></td>
<td>
<p>Variable in the original dataset to stratify on;
This is useful to distinguish between sparse and full sampling
and other features you may wish to keep distinct in your
bootstrap</p>
</td></tr>
<tr><td><code id="bootstrapFit_+3A_stderrtype">stdErrType</code></td>
<td>
<p>This gives the standard error type for the
updated standard errors; The current possibilities are:
<code>"perc"</code> which gives the standard errors by percentiles
(default) or <code>"se"</code> which gives the standard errors by the
traditional formula.</p>
</td></tr>
<tr><td><code id="bootstrapFit_+3A_ci">ci</code></td>
<td>
<p>Confidence interval level to calculate.  Default is 0.95
for a 95 percent confidence interval</p>
</td></tr>
<tr><td><code id="bootstrapFit_+3A_pvalues">pvalues</code></td>
<td>
<p>a vector of pvalues indicating the probability of
each subject to get selected; default value is <code>NULL</code> implying that
probability of each subject is the same</p>
</td></tr>
<tr><td><code id="bootstrapFit_+3A_restart">restart</code></td>
<td>
<p>A boolean to try to restart an interrupted or
incomplete boostrap.  By default this is <code>FALSE</code></p>
</td></tr>
<tr><td><code id="bootstrapFit_+3A_plothist">plotHist</code></td>
<td>
<p>A boolean indicating if a histogram plot to assess
how well the bootstrap is doing.  By default this is turned off (<code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="bootstrapFit_+3A_fitname">fitName</code></td>
<td>
<p>is the fit name that is used for the name of the
boostrap files.  By default it is the fit provided though it
could be something else.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, called for the side effects; The original fit is
updated with the bootstrap confidence bands
</p>


<h3>Author(s)</h3>

<p>Vipul Mann, Matthew Fidler
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
one.cmt &lt;- function() {
  ini({
    tka &lt;- 0.45; label("Ka")
    tcl &lt;- 1; label("Cl")
    tv &lt;- 3.45; label("V")
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd &lt;- 0.7
  })
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl + eta.cl)
    v &lt;- exp(tv + eta.v)
    linCmt() ~ add(add.sd)
  })
}

fit &lt;- nlmixr2(one.cmt, nlmixr2data::theo_sd, est = "saem", control = list(print = 0))

withr::with_tempdir({ # Run example in temp dir

bootstrapFit(fit, nboot = 5, restart = TRUE) # overwrites any of the existing data or model files
bootstrapFit(fit, nboot = 7) # resumes fitting using the stored data and model files

# Note this resumes because the total number of bootstrap samples is not 10

bootstrapFit(fit, nboot=10)

# Note the boostrap standard error and variance/covariance matrix is retained.
# If you wish to switch back you can change the covariance matrix by

nlmixr2est::setCov(fit, "linFim")

# And change it back again

nlmixr2est::setCov(fit, "boot10")

# This change will affect any simulations with uncertainty in their parameters

# You may also do a chi-square diagnostic plot check for the bootstrap with
bootplot(fit)
})

## End(Not run)
</code></pre>

<hr>
<h2 id='buildcovInfo'>Build covInfo list from varsVec and covarsVec</h2><span id='topic+buildcovInfo'></span>

<h3>Description</h3>

<p>Build covInfo list from varsVec and covarsVec
</p>


<h3>Usage</h3>

<pre><code class='language-R'>buildcovInfo(varsVec, covarsVec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="buildcovInfo_+3A_varsvec">varsVec</code></td>
<td>
<p>character vector of variables that need to be added</p>
</td></tr>
<tr><td><code id="buildcovInfo_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be added</p>
</td></tr>
</table>


<h3>Value</h3>

<p>covInfo list of covariate info
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani
</p>

<hr>
<h2 id='buildupatedUI'>Build updated from the covariate and variable vector list</h2><span id='topic+buildupatedUI'></span>

<h3>Description</h3>

<p>Build updated from the covariate and variable vector list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>buildupatedUI(ui, varsVec, covarsVec, add = TRUE, indep = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="buildupatedUI_+3A_ui">ui</code></td>
<td>
<p>compiled rxode2 nlmir2 model or fit</p>
</td></tr>
<tr><td><code id="buildupatedUI_+3A_varsvec">varsVec</code></td>
<td>
<p>character vector of variables that need to be added</p>
</td></tr>
<tr><td><code id="buildupatedUI_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be added</p>
</td></tr>
<tr><td><code id="buildupatedUI_+3A_add">add</code></td>
<td>
<p>boolean indicating if the covariate needs to be added or removed</p>
</td></tr>
<tr><td><code id="buildupatedUI_+3A_indep">indep</code></td>
<td>
<p>a boolean indicating if the covariates should be added independently, or
sequentially (append to the previous model). only applicable to adding covariate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>updated ui with added covariates
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani
</p>

<hr>
<h2 id='covarSearchAuto'>Stepwise Covariate Model-selection (SCM) method</h2><span id='topic+covarSearchAuto'></span>

<h3>Description</h3>

<p>Stepwise Covariate Model-selection (SCM) method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covarSearchAuto(
  fit,
  varsVec,
  covarsVec,
  pVal = list(fwd = 0.05, bck = 0.01),
  catvarsVec = NULL,
  searchType = c("scm", "forward", "backward"),
  restart = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covarSearchAuto_+3A_fit">fit</code></td>
<td>
<p>an nlmixr2 'fit' object</p>
</td></tr>
<tr><td><code id="covarSearchAuto_+3A_varsvec">varsVec</code></td>
<td>
<p>a list of candidate variables to which the
covariates could be added</p>
</td></tr>
<tr><td><code id="covarSearchAuto_+3A_covarsvec">covarsVec</code></td>
<td>
<p>a list of candidate covariates that need to be
tested</p>
</td></tr>
<tr><td><code id="covarSearchAuto_+3A_pval">pVal</code></td>
<td>
<p>a named list with names 'fwd' and 'bck' for specifying
the p-values for the forward and backward searches, respectively</p>
</td></tr>
<tr><td><code id="covarSearchAuto_+3A_catvarsvec">catvarsVec</code></td>
<td>
<p>character vector of categorical covariates that need to be added</p>
</td></tr>
<tr><td><code id="covarSearchAuto_+3A_searchtype">searchType</code></td>
<td>
<p>one of 'scm', 'forward' and 'backward' to specify
the covariate search method; default is 'scm'</p>
</td></tr>
<tr><td><code id="covarSearchAuto_+3A_restart">restart</code></td>
<td>
<p>a boolean that controls if the search should be
restarted; default is FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list summarizing the covariate selection steps and
output; This list has the &quot;summaryTable&quot; for the overall summary
of the covariate selection as well as &quot;resFwd&quot; for the forward
selection method and &quot;resBck&quot; for the backward selection method.
</p>


<h3>Author(s)</h3>

<p>Vipul Mann, Matthew Fidler, Vishal Sarsani
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
one.cmt &lt;- function() {
  ini({
    tka &lt;- 0.45; label("Ka")
    tcl &lt;- log(c(0, 2.7, 100)); label("Cl")
    tv &lt;- 3.45; label("V")
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd &lt;- 0.7
  })
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl + eta.cl)
    v &lt;- exp(tv + eta.v)
    linCmt() ~ add(add.sd)
  })
}

fit &lt;- nlmixr2(one.cmt, nlmixr2data::theo_sd, est = "saem", control = list(print = 0))
rxode2::.rxWithWd(tempdir(), {# with temporary directory

auto1 &lt;- covarSearchAuto(fit, varsVec = c("ka", "cl"),
    covarsVec = c("WT"))

})

## Note that this didn't include sex, add it to dataset and restart model


d &lt;- nlmixr2data::theo_sd
d$SEX &lt;-0
d$SEX[d$ID&lt;=6] &lt;-1

fit &lt;- nlmixr2(one.cmt, d, est = "saem", control = list(print = 0))

# This would restart if for some reason the search crashed:

rxode2::.rxWithWd(tempdir(), {# with temporary directory

auto2 &lt;- covarSearchAuto(fit, varsVec = c("ka", "cl"), covarsVec = c("WT"),
                catvarsVec= c("SEX"), restart = TRUE)

auto3 &lt;- covarSearchAuto(fit, varsVec = c("ka", "cl"), covarsVec = c("WT"),
                catvarsVec=  c("SEX"), restart = TRUE,
                searchType = "forward")
})

## End(Not run)
</code></pre>

<hr>
<h2 id='foldgen'>Stratified cross-validation fold generator function, inspired from the caret</h2><span id='topic+foldgen'></span>

<h3>Description</h3>

<p>Stratified cross-validation fold generator function, inspired from the caret
</p>


<h3>Usage</h3>

<pre><code class='language-R'>foldgen(data, nfold = 5, stratVar = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="foldgen_+3A_data">data</code></td>
<td>
<p>data frame used in the analysis</p>
</td></tr>
<tr><td><code id="foldgen_+3A_nfold">nfold</code></td>
<td>
<p>number of k-fold cross validations. Default is 5</p>
</td></tr>
<tr><td><code id="foldgen_+3A_stratvar">stratVar</code></td>
<td>
<p>Stratification Variable. Default is NULL and ID is used for CV</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return data.frame with the fold column attached
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani, caret
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- nlmixr2data::theo_sd
d$SEX &lt;-0
d$SEX[d$ID&lt;=6] &lt;-1

covarsVec &lt;- c("WT")

# Stratified cross-validation data with CMT
df1 &lt;- foldgen(d, nfold=5, stratVar="CMT")

# Stratified cross-validation data with ID (individual)
df2 &lt;- foldgen(d, nfold=5, stratVar=NULL)
</code></pre>

<hr>
<h2 id='forwardSearch'>Forward covariate search</h2><span id='topic+forwardSearch'></span>

<h3>Description</h3>

<p>Forward covariate search
</p>


<h3>Usage</h3>

<pre><code class='language-R'>forwardSearch(
  varsVec,
  covarsVec,
  catvarsVec = NULL,
  fit,
  pVal = 0.05,
  outputDir,
  restart = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="forwardSearch_+3A_varsvec">varsVec</code></td>
<td>
<p>character vector of variables that need to be added</p>
</td></tr>
<tr><td><code id="forwardSearch_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be added</p>
</td></tr>
<tr><td><code id="forwardSearch_+3A_catvarsvec">catvarsVec</code></td>
<td>
<p>character vector of categorical covariates that need to be added</p>
</td></tr>
<tr><td><code id="forwardSearch_+3A_fit">fit</code></td>
<td>
<p>an nlmixr2 'fit' object</p>
</td></tr>
<tr><td><code id="forwardSearch_+3A_pval">pVal</code></td>
<td>
<p>p-value that should be used for selecting covariates in the forward search</p>
</td></tr>
<tr><td><code id="forwardSearch_+3A_outputdir">outputDir</code></td>
<td>
<p>the name of the output directory that stores the covariate search result</p>
</td></tr>
<tr><td><code id="forwardSearch_+3A_restart">restart</code></td>
<td>
<p>a boolean that controls if the search should be restarted; default is FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the updated 'fit' object at the end of the forward search and a table of information for all the covariates tested
</p>


<h3>Author(s)</h3>

<p>Vipul Mann, Matthew Fidler, Vishal Sarsani
</p>

<hr>
<h2 id='horseshoeSummardf'>Create Horseshoe summary posterior estimates</h2><span id='topic+horseshoeSummardf'></span>

<h3>Description</h3>

<p>Create Horseshoe summary posterior estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>horseshoeSummardf(fit, covarsVec, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="horseshoeSummardf_+3A_fit">fit</code></td>
<td>
<p>compiled rxode2 nlmir2 model fit</p>
</td></tr>
<tr><td><code id="horseshoeSummardf_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be added</p>
</td></tr>
<tr><td><code id="horseshoeSummardf_+3A_...">...</code></td>
<td>
<p>other parameters passed to brm(): warmup = 1000, iter = 2000, chains = 4, cores = 4,
control = list(adapt_delta = 0.99, max_treedepth = 15)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Horse shoe Summary data frame of all covariates
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani, Christian Bartels
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
one.cmt &lt;- function() {
  ini({
    tka &lt;- 0.45; label("Ka")
    tcl &lt;- log(c(0, 2.7, 100)); label("Cl")
    tv &lt;- 3.45; label("V")
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd &lt;- 0.7
  })
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl + eta.cl)
    v &lt;- exp(tv + eta.v)
    linCmt() ~ add(add.sd)
  })
}

d &lt;- nlmixr2data::theo_sd
fit &lt;- nlmixr2(one.cmt, d, est = "saem", control = list(print = 0))
covarsVec &lt;- c("WT")

# Horseshoe summary posterior estimates:

#hsDf &lt;- horseshoeSummardf(fit,covarsVec,cores=2)
#brms sometimes may throw a Error in sink(type = “output”)
#Issue Should be fixed by uninstalling and re-installing rstan

## End(Not run)
</code></pre>

<hr>
<h2 id='knit_print.nlmixr2FitCore'>Extract the equations from an nlmixr2/rxode2 model to produce a 'LaTeX'
equation.</h2><span id='topic+knit_print.nlmixr2FitCore'></span><span id='topic+knit_print.rxUi'></span>

<h3>Description</h3>

<p>Extract the equations from an nlmixr2/rxode2 model to produce a 'LaTeX'
equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlmixr2FitCore'
knit_print(x, ..., output = "equations")

## S3 method for class 'rxUi'
knit_print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="knit_print.nlmixr2FitCore_+3A_x">x</code></td>
<td>
<p>The model to extract equations from</p>
</td></tr>
<tr><td><code id="knit_print.nlmixr2FitCore_+3A_...">...</code></td>
<td>
<p>Ignored</p>
</td></tr>
<tr><td><code id="knit_print.nlmixr2FitCore_+3A_output">output</code></td>
<td>
<p>The type of output to request (currently, just &quot;equations&quot;)</p>
</td></tr>
</table>

<hr>
<h2 id='lassoCoefficients'>Return Final lasso coefficients after finding optimal t</h2><span id='topic+lassoCoefficients'></span>

<h3>Description</h3>

<p>Return Final lasso coefficients after finding optimal t
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lassoCoefficients(
  fit,
  varsVec,
  covarsVec,
  catvarsVec,
  constraint = 1e-08,
  stratVar = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lassoCoefficients_+3A_fit">fit</code></td>
<td>
<p>nlmixr2 fit.</p>
</td></tr>
<tr><td><code id="lassoCoefficients_+3A_varsvec">varsVec</code></td>
<td>
<p>character vector of variables that need to be added</p>
</td></tr>
<tr><td><code id="lassoCoefficients_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be added</p>
</td></tr>
<tr><td><code id="lassoCoefficients_+3A_catvarsvec">catvarsVec</code></td>
<td>
<p>character vector of categorical covariates that need to be added</p>
</td></tr>
<tr><td><code id="lassoCoefficients_+3A_constraint">constraint</code></td>
<td>
<p>theta cutoff. below cutoff then the theta will be fixed to zero</p>
</td></tr>
<tr><td><code id="lassoCoefficients_+3A_stratvar">stratVar</code></td>
<td>
<p>A variable to stratify on for cross-validation</p>
</td></tr>
<tr><td><code id="lassoCoefficients_+3A_...">...</code></td>
<td>
<p>Other parameters to be passed to optimalTvaluelasso</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return data frame of final lasso coefficients
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
one.cmt &lt;- function() {
  ini({
    tka &lt;- 0.45; label("Ka")
    tcl &lt;- log(c(0, 2.7, 100)); label("Cl")
    tv &lt;- 3.45; label("V")
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd &lt;- 0.7
  })
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl + eta.cl)
    v &lt;- exp(tv + eta.v)
    linCmt() ~ add(add.sd)
  })
}

d &lt;- nlmixr2data::theo_sd
d$SEX &lt;-0
d$SEX[d$ID&lt;=6] &lt;-1

fit &lt;- nlmixr2(one.cmt, d, est = "saem", control = list(print = 0))
varsVec &lt;- c("ka","cl","v")
covarsVec &lt;- c("WT")
catvarsVec &lt;- c("SEX")

# Lasso coefficients:

lassoDf &lt;- lassoCoefficients(fit, varsVec, covarsVec, catvarsVec, constraint=1e-08, stratVar = NULL)

## End(Not run)
</code></pre>

<hr>
<h2 id='lassoSummardf'>Create Lasso summary posterior estimates</h2><span id='topic+lassoSummardf'></span>

<h3>Description</h3>

<p>Create Lasso summary posterior estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lassoSummardf(fit, covarsVec, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lassoSummardf_+3A_fit">fit</code></td>
<td>
<p>compiled rxode2 nlmir2 model fit</p>
</td></tr>
<tr><td><code id="lassoSummardf_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be added</p>
</td></tr>
<tr><td><code id="lassoSummardf_+3A_...">...</code></td>
<td>
<p>other parameters passed to brm(): warmup = 1000, iter = 2000, chains = 4, cores = 4,
control = list(adapt_delta = 0.99, max_treedepth = 15)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Horse shoe Summary data frame of all covariates
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani, Christian Bartels
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
one.cmt &lt;- function() {
  ini({
    tka &lt;- 0.45; label("Ka")
    tcl &lt;- log(c(0, 2.7, 100)); label("Cl")
    tv &lt;- 3.45; label("V")
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd &lt;- 0.7
  })
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl + eta.cl)
    v &lt;- exp(tv + eta.v)
    linCmt() ~ add(add.sd)
  })
}

d &lt;- nlmixr2data::theo_sd
fit &lt;- nlmixr2(one.cmt, d, est = "saem", control = list(print = 0))
covarsVec &lt;- c("WT")

# Horseshoe summary posterior estimates:

#lassoDf &lt;- lassoSummardf(fit,covarsVec,cores=2)
#brms sometimes may throw a Error in sink(type = “output”)
#Issue Should be fixed by uninstalling and re-installing rstan

## End(Not run)
</code></pre>

<hr>
<h2 id='normalizedData'>Function to return data of normalized covariates</h2><span id='topic+normalizedData'></span>

<h3>Description</h3>

<p>Function to return data of normalized covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalizedData(data, covarsVec, replace = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalizedData_+3A_data">data</code></td>
<td>
<p>a dataframe with covariates to normalize</p>
</td></tr>
<tr><td><code id="normalizedData_+3A_covarsvec">covarsVec</code></td>
<td>
<p>a list of covariate names (parameters) that need to be estimates</p>
</td></tr>
<tr><td><code id="normalizedData_+3A_replace">replace</code></td>
<td>
<p>replace the original covariate data with normalized data for easier updated model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with all normalized covariates
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
d &lt;- nlmixr2data::theo_sd
d$SEX &lt;-0
d$SEX[d$ID&lt;=6] &lt;-1

covarsVec &lt;- c("WT")

# Normalized covariate (replaced)
df1 &lt;- normalizedData(d,covarsVec,replace=TRUE)

# Normalized covariate (without replacement)
df2 &lt;- normalizedData(d,covarsVec,replace=FALSE)
</code></pre>

<hr>
<h2 id='optimUnisampling'>Sample from uniform distribution by optim</h2><span id='topic+optimUnisampling'></span>

<h3>Description</h3>

<p>Sample from uniform distribution by optim
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimUnisampling(xvec, N = 1000, medValue, floorT = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimUnisampling_+3A_xvec">xvec</code></td>
<td>
<p>A vector of min,max values . Ex:c(10,20)</p>
</td></tr>
<tr><td><code id="optimUnisampling_+3A_n">N</code></td>
<td>
<p>Desired number of values</p>
</td></tr>
<tr><td><code id="optimUnisampling_+3A_medvalue">medValue</code></td>
<td>
<p>Desired Median</p>
</td></tr>
<tr><td><code id="optimUnisampling_+3A_floort">floorT</code></td>
<td>
<p>boolean indicating whether to round up</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Samples with approx desired median.
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate 1000 creatine clearance values with median of 71.7 within range of c(6.7,140)
creatCl &lt;- optimUnisampling(xvec=c(6.7,140), N=1000, medValue = 71.7, floorT=FALSE)
</code></pre>

<hr>
<h2 id='preconditionFit'>Linearly re-parameterize the model to be less sensitive to rounding errors</h2><span id='topic+preconditionFit'></span>

<h3>Description</h3>

<p>Linearly re-parameterize the model to be less sensitive to rounding errors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preconditionFit(fit, estType = c("full", "posthoc", "none"), ntry = 10L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preconditionFit_+3A_fit">fit</code></td>
<td>
<p>A nlmixr2 fit to be preconditioned</p>
</td></tr>
<tr><td><code id="preconditionFit_+3A_esttype">estType</code></td>
<td>
<p>Once the fit has been linearly reparameterized,
should a &quot;full&quot; estimation, &quot;posthoc&quot; estimation or simply a
estimation of the covariance matrix &quot;none&quot; before the fit is
updated</p>
</td></tr>
<tr><td><code id="preconditionFit_+3A_ntry">ntry</code></td>
<td>
<p>number of tries before giving up on a pre-conditioned
covariance estimate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A nlmixr2 fit object that was preconditioned to stabilize
the variance/covariance calculation
</p>


<h3>References</h3>

<p>Aoki Y, Nordgren R, Hooker AC. Preconditioning of
Nonlinear Mixed Effects Models for Stabilisation of
Variance-Covariance Matrix Computations. AAPS
J. 2016;18(2):505-518. doi:10.1208/s12248-016-9866-5
</p>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+knit_print'></span><span id='topic+ini'></span><span id='topic+model'></span><span id='topic+nlmixrWithTiming'></span><span id='topic+nlmixr'></span><span id='topic+nlmixr2'></span><span id='topic+setCov'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>knitr</dt><dd><p><code><a href="knitr.html#topic+knit_print">knit_print</a></code></p>
</dd>
<dt>nlmixr2est</dt><dd><p><code><a href="nlmixr2est.html#topic+nlmixr2">nlmixr</a></code>, <code><a href="nlmixr2est.html#topic+nlmixr2">nlmixr2</a></code>, <code><a href="nlmixr2est.html#topic+nlmixrWithTiming">nlmixrWithTiming</a></code>, <code><a href="nlmixr2est.html#topic+setCov">setCov</a></code></p>
</dd>
<dt>rxode2</dt><dd><p><code><a href="rxode2.html#topic+ini">ini</a></code>, <code><a href="rxode2.html#topic+model">model</a></code></p>
</dd>
</dl>

<hr>
<h2 id='regularmodel'>Regular lasso model</h2><span id='topic+regularmodel'></span>

<h3>Description</h3>

<p>Regular lasso model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regularmodel(
  fit,
  varsVec,
  covarsVec,
  catvarsVec,
  constraint = 1e-08,
  lassotype = c("regular", "adaptive", "adjusted"),
  stratVar = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regularmodel_+3A_fit">fit</code></td>
<td>
<p>nlmixr2 fit.</p>
</td></tr>
<tr><td><code id="regularmodel_+3A_varsvec">varsVec</code></td>
<td>
<p>character vector of variables that need to be added</p>
</td></tr>
<tr><td><code id="regularmodel_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be added</p>
</td></tr>
<tr><td><code id="regularmodel_+3A_catvarsvec">catvarsVec</code></td>
<td>
<p>character vector of categorical covariates that need to be added</p>
</td></tr>
<tr><td><code id="regularmodel_+3A_constraint">constraint</code></td>
<td>
<p>theta cutoff. below cutoff then the theta will be fixed to zero.</p>
</td></tr>
<tr><td><code id="regularmodel_+3A_lassotype">lassotype</code></td>
<td>
<p>must be  'regular' , 'adaptive', 'adjusted'</p>
</td></tr>
<tr><td><code id="regularmodel_+3A_stratvar">stratVar</code></td>
<td>
<p>A variable to stratify on for cross-validation.</p>
</td></tr>
<tr><td><code id="regularmodel_+3A_...">...</code></td>
<td>
<p>Other parameters to be passed to optimalTvaluelasso</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return fit of the selected lasso coefficients
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
one.cmt &lt;- function() {
  ini({
    tka &lt;- 0.45; label("Ka")
    tcl &lt;- log(c(0, 2.7, 100)); label("Cl")
    tv &lt;- 3.45; label("V")
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd &lt;- 0.7
  })
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl + eta.cl)
    v &lt;- exp(tv + eta.v)
    linCmt() ~ add(add.sd)
  })
}

d &lt;- nlmixr2data::theo_sd
d$SEX &lt;-0
d$SEX[d$ID&lt;=6] &lt;-1

fit &lt;- nlmixr2(one.cmt, d, est = "saem", control = list(print = 0))
varsVec &lt;- c("ka","cl","v")
covarsVec &lt;- c("WT")
catvarsVec &lt;- c("SEX")

# Model fit with regular lasso coefficients:

lassoDf &lt;- regularmodel(fit,varsVec,covarsVec,catvarsVec)
# Model fit with adaptive lasso coefficients:

lassoDf &lt;- regularmodel(fit,varsVec,covarsVec,catvarsVec,lassotype='adaptive')
# Model fit with adaptive-adjusted lasso coefficients:

lassoDf &lt;- regularmodel(fit,varsVec,covarsVec,catvarsVec, lassotype='adjusted')

## End(Not run)
</code></pre>

<hr>
<h2 id='theoFitOde'>Example single dose Theophylline ODE model</h2><span id='topic+theoFitOde'></span>

<h3>Description</h3>

<p>This is a nlmixr2 model that is pre-run so that it can be used in
package testing and development.  It is regenerated whenever
binaries of <code>nlmixr2extra</code> are created.  If there is a binary
incompatability between the fit objects, a simple rerun of the
installation will fix this nlmixr2 fit object.
</p>


<h3>Format</h3>

<p>A (modified) data frame with  132 rows and 22 columns.
</p>

<dl>
<dt>ID</dt><dd><p>Patient identifier</p>
</dd>
<dt>TIME</dt><dd><p>Time (hr)</p>
</dd>
<dt>DV</dt><dd><p>Dependent variable (concentration)</p>
</dd>
<dt>PRED</dt><dd><p>Predictions without any between subject variability</p>
</dd>
<dt>RES</dt><dd><p>Population Residual</p>
</dd>
<dt>WRES</dt><dd><p>Weighted Residuals under the FO assumption</p>
</dd>
<dt>IPRED</dt><dd><p>Individual Predictions</p>
</dd>
<dt>IRES</dt><dd><p>Individual Residuals</p>
</dd>
<dt>IWRES</dt><dd><p>Individual Weighted Residuals</p>
</dd>
<dt>CPRED</dt><dd><p>Conditional Prediction under the FOCE assumption</p>
</dd>
<dt>CRES</dt><dd><p>Conditional Residuals under the FOCE assumption</p>
</dd>
<dt>CWRES</dt><dd><p>Conditional Weighted Residuals under the FOCE assumption</p>
</dd>
<dt>eta.ka</dt><dd><p>Between subject changes for ka</p>
</dd>
<dt>eta.cl</dt><dd><p>Between subject changes for v</p>
</dd>
<dt>depot</dt><dd><p>amount in the depot compartment</p>
</dd>
<dt>center</dt><dd><p>amount in the central compartment</p>
</dd>
<dt>ka</dt><dd><p>Individual ka values</p>
</dd>
<dt>cl</dt><dd><p>Individual cl values</p>
</dd>
<dt>v</dt><dd><p>Individual volume of distribution</p>
</dd>
<dt>tad</dt><dd><p>Time after dose</p>
</dd>
<dt>dosenum</dt><dd><p>Dose number</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
