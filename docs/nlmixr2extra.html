<!DOCTYPE html><html lang="en"><head><title>Help for package nlmixr2extra</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nlmixr2extra}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adaptivelassoCoefficients'><p>Return Adaptive lasso coefficients after finding optimal t</p></a></li>
<li><a href='#addCatCovariates'><p>Make dummy variable cols and updated covarsVec</p></a></li>
<li><a href='#addorremoveCovariate'><p>Add covariate</p></a></li>
<li><a href='#adjustedlassoCoefficients'><p>Return Adjusted adaptive lasso coefficients after finding optimal t</p></a></li>
<li><a href='#bootplot'><p>Produce delta objective function for boostrap</p></a></li>
<li><a href='#bootstrapFit'><p>Bootstrap nlmixr2 fit</p></a></li>
<li><a href='#buildcovInfo'><p>Build covInfo list from varsVec and covarsVec</p></a></li>
<li><a href='#buildupatedUI'><p>Build updated from the covariate and variable vector list</p></a></li>
<li><a href='#fixedControl'><p>Control options for fixed-value likelihood profiling</p></a></li>
<li><a href='#foldgen'><p>Stratified cross-validation fold generator function, inspired from the caret</p></a></li>
<li><a href='#horseshoeSummardf'><p>Create Horseshoe summary posterior estimates</p></a></li>
<li><a href='#knit_print.nlmixr2FitCore'><p>Extract the equations from an nlmixr2/rxode2 model to produce a 'LaTeX'</p>
equation.</a></li>
<li><a href='#lassoCoefficients'><p>Return Final lasso coefficients after finding optimal t</p></a></li>
<li><a href='#lassoSummardf'><p>Create Lasso summary posterior estimates</p></a></li>
<li><a href='#llpControl'><p>Control options for log-likelihood profiling</p></a></li>
<li><a href='#normalizedData'><p>Function to return data of normalized covariates</p></a></li>
<li><a href='#optimUnisampling'><p>Sample from uniform distribution by optim</p></a></li>
<li><a href='#preconditionFit'><p>Linearly re-parameterize the model to be less sensitive to rounding errors</p></a></li>
<li><a href='#profile.nlmixr2FitCore'><p>Perform likelihood profiling on nlmixr2 focei fits</p></a></li>
<li><a href='#profileFixed'><p>Estimate the objective function values for a model while fixing defined</p>
parameter values</a></li>
<li><a href='#profileLlp'><p>Profile confidence intervals with log-likelihood profiling</p></a></li>
<li><a href='#profileNlmixr2FitCoreRet'><p>Give the output data.frame for a single model for profile.nlmixr2FitCore</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#regularmodel'><p>Regular lasso model</p></a></li>
<li><a href='#theoFitOde'><p>Example single dose Theophylline ODE model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Nonlinear Mixed Effects Models in Population PK/PD, Extra
Support Functions</td>
</tr>
<tr>
<td>Version:</td>
<td>3.0.2</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matthew Fidler &lt;matthew.fidler@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit and compare nonlinear mixed-effects models in
    differential equations with flexible dosing information commonly seen
    in pharmacokinetics and pharmacodynamics (Almquist, Leander, and
    Jirstrand 2015 &lt;<a href="https://doi.org/10.1007%2Fs10928-015-9409-1">doi:10.1007/s10928-015-9409-1</a>&gt;). Differential equation
    solving is by compiled C code provided in the 'rxode2' package (Wang,
    Hallow, and James 2015 &lt;<a href="https://doi.org/10.1002%2Fpsp4.12052">doi:10.1002/psp4.12052</a>&gt;). This package is for
    support functions like preconditioned fits
    &lt;<a href="https://doi.org/10.1208%2Fs12248-016-9866-5">doi:10.1208/s12248-016-9866-5</a>&gt;, boostrap and stepwise covariate
    selection.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://nlmixr2.github.io/nlmixr2extra/">https://nlmixr2.github.io/nlmixr2extra/</a>,
<a href="https://github.com/nlmixr2/nlmixr2extra/">https://github.com/nlmixr2/nlmixr2extra/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/nlmixr2/nlmixr2extra/issues/">https://github.com/nlmixr2/nlmixr2extra/issues/</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate, cli (&ge; 3.4.0), crayon, data.table, digest, dplyr,
ggplot2, ggtext, knitr, lotri, methods, nlme, nlmixr2est (&ge;
2.1.1), Rcpp, rxode2 (&ge; 2.0.10), stats, symengine, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>brms, nlmixr2data, testthat (&ge; 3.0.0), withr, devtools</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-17 02:32:58 UTC; matt</td>
</tr>
<tr>
<td>Author:</td>
<td>Matthew Fidler <a href="https://orcid.org/0000-0001-8538-6691"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Vipul Mann [aut],
  Vishal Sarsani <a href="https://orcid.org/0000-0002-9272-3438"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Christian Bartels [ctb],
  Bill Denney <a href="https://orcid.org/0000-0002-5759-428X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-17 05:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='adaptivelassoCoefficients'>Return Adaptive lasso coefficients after finding optimal t</h2><span id='topic+adaptivelassoCoefficients'></span>

<h3>Description</h3>

<p>Return Adaptive lasso coefficients after finding optimal t
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adaptivelassoCoefficients(
  fit,
  varsVec,
  covarsVec,
  catvarsVec,
  constraint = 1e-08,
  stratVar = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="adaptivelassoCoefficients_+3A_fit">fit</code></td>
<td>
<p>nlmixr2 fit.</p>
</td></tr>
<tr><td><code id="adaptivelassoCoefficients_+3A_varsvec">varsVec</code></td>
<td>
<p>character vector of variables that need to be added</p>
</td></tr>
<tr><td><code id="adaptivelassoCoefficients_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be added</p>
</td></tr>
<tr><td><code id="adaptivelassoCoefficients_+3A_catvarsvec">catvarsVec</code></td>
<td>
<p>character vector of categorical covariates that need to be added</p>
</td></tr>
<tr><td><code id="adaptivelassoCoefficients_+3A_constraint">constraint</code></td>
<td>
<p>theta cutoff. below cutoff then the theta will be fixed to zero.</p>
</td></tr>
<tr><td><code id="adaptivelassoCoefficients_+3A_stratvar">stratVar</code></td>
<td>
<p>A variable to stratify on for cross-validation.</p>
</td></tr>
<tr><td><code id="adaptivelassoCoefficients_+3A_...">...</code></td>
<td>
<p>Other parameters to be passed to optimalTvaluelasso</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return data frame of final lasso coefficients
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
one.cmt &lt;- function() {
  ini({
    tka &lt;- 0.45; label("Ka")
    tcl &lt;- log(c(0, 2.7, 100)); label("Cl")
    tv &lt;- 3.45; label("V")
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd &lt;- 0.7
  })
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl + eta.cl)
    v &lt;- exp(tv + eta.v)
    linCmt() ~ add(add.sd)
  })
}

d &lt;- nlmixr2data::theo_sd
d$SEX &lt;-0
d$SEX[d$ID&lt;=6] &lt;-1

fit &lt;-
 nlmixr2(
   one.cmt, d,
   est = "saem",
   control = list(print = 0)
 )
varsVec &lt;- c("ka","cl","v")
covarsVec &lt;- c("WT")
catvarsVec &lt;- c("SEX")

# Adaptive Lasso coefficients:

lassoDf &lt;- adaptivelassoCoefficients(fit, varsVec, covarsVec, catvarsVec)

## End(Not run)
</code></pre>

<hr>
<h2 id='addCatCovariates'>Make dummy variable cols and updated covarsVec</h2><span id='topic+addCatCovariates'></span>

<h3>Description</h3>

<p>Make dummy variable cols and updated covarsVec
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addCatCovariates(data, covarsVec, catcovarsVec)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addCatCovariates_+3A_data">data</code></td>
<td>
<p>data frame used in the analysis</p>
</td></tr>
<tr><td><code id="addCatCovariates_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be
added</p>
</td></tr>
<tr><td><code id="addCatCovariates_+3A_catcovarsvec">catcovarsVec</code></td>
<td>
<p>character vector of categorical covariates that
need to be added</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return updated Data along with the updated covarsVec
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani
</p>

<hr>
<h2 id='addorremoveCovariate'>Add covariate</h2><span id='topic+addorremoveCovariate'></span>

<h3>Description</h3>

<p>Add covariate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addorremoveCovariate(ui, varName, covariate, add = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addorremoveCovariate_+3A_ui">ui</code></td>
<td>
<p>compiled rxode2 nlmir2 model or fit</p>
</td></tr>
<tr><td><code id="addorremoveCovariate_+3A_varname">varName</code></td>
<td>
<p>the variable name to which the given covariate is to be added</p>
</td></tr>
<tr><td><code id="addorremoveCovariate_+3A_covariate">covariate</code></td>
<td>
<p>the covariate that needs string to be constructed</p>
</td></tr>
<tr><td><code id="addorremoveCovariate_+3A_add">add</code></td>
<td>
<p>boolean indicating if the covariate needs to be added or removed.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matthew Fidler, Vishal Sarsani
</p>

<hr>
<h2 id='adjustedlassoCoefficients'>Return Adjusted adaptive lasso coefficients after finding optimal t</h2><span id='topic+adjustedlassoCoefficients'></span>

<h3>Description</h3>

<p>Return Adjusted adaptive lasso coefficients after finding optimal t
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adjustedlassoCoefficients(
  fit,
  varsVec,
  covarsVec,
  catvarsVec,
  constraint = 1e-08,
  stratVar = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="adjustedlassoCoefficients_+3A_fit">fit</code></td>
<td>
<p>nlmixr2 fit.</p>
</td></tr>
<tr><td><code id="adjustedlassoCoefficients_+3A_varsvec">varsVec</code></td>
<td>
<p>character vector of variables that need to be added</p>
</td></tr>
<tr><td><code id="adjustedlassoCoefficients_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be added</p>
</td></tr>
<tr><td><code id="adjustedlassoCoefficients_+3A_catvarsvec">catvarsVec</code></td>
<td>
<p>character vector of categorical covariates that need to be added</p>
</td></tr>
<tr><td><code id="adjustedlassoCoefficients_+3A_constraint">constraint</code></td>
<td>
<p>theta cutoff. below cutoff then the theta will be fixed to zero.</p>
</td></tr>
<tr><td><code id="adjustedlassoCoefficients_+3A_stratvar">stratVar</code></td>
<td>
<p>A variable to stratify on for cross-validation.</p>
</td></tr>
<tr><td><code id="adjustedlassoCoefficients_+3A_...">...</code></td>
<td>
<p>Other parameters to be passed to optimalTvaluelasso</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return data frame of final lasso coefficients
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
one.cmt &lt;- function() {
  ini({
    tka &lt;- 0.45; label("Ka")
    tcl &lt;- log(c(0, 2.7, 100)); label("Cl")
    tv &lt;- 3.45; label("V")
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd &lt;- 0.7
  })
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl + eta.cl)
    v &lt;- exp(tv + eta.v)
    linCmt() ~ add(add.sd)
  })
}

d &lt;- nlmixr2data::theo_sd
d$SEX &lt;-0
d$SEX[d$ID&lt;=6] &lt;-1

fit &lt;- nlmixr2(one.cmt, d, est = "saem", control = list(print = 0))
varsVec &lt;- c("ka","cl","v")
covarsVec &lt;- c("WT")
catvarsVec &lt;- c("SEX")

# Adaptive Lasso coefficients:

lassoDf &lt;- adjustedlassoCoefficients(fit,varsVec,covarsVec,catvarsVec)

## End(Not run)
</code></pre>

<hr>
<h2 id='bootplot'>Produce delta objective function for boostrap</h2><span id='topic+bootplot'></span><span id='topic+bootplot.nlmixr2FitCore'></span>

<h3>Description</h3>

<p>Produce delta objective function for boostrap
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootplot(x, ...)

## S3 method for class 'nlmixr2FitCore'
bootplot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootplot_+3A_x">x</code></td>
<td>
<p>fit object</p>
</td></tr>
<tr><td><code id="bootplot_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fit traceplot or nothing.
</p>


<h3>Author(s)</h3>

<p>Vipul Mann,  Matthew L. Fidler
</p>


<h3>References</h3>

<p>R Niebecker,  MO Karlsson. (2013)
<em>Are datasets for NLME models large enough for a bootstrap to provide reliable parameter uncertainty distributions?</em>
PAGE 2013.
<a href="https://www.page-meeting.org/?abstract=2899">https://www.page-meeting.org/?abstract=2899</a>
</p>

<hr>
<h2 id='bootstrapFit'>Bootstrap nlmixr2 fit</h2><span id='topic+bootstrapFit'></span>

<h3>Description</h3>

<p>Bootstrap input dataset and rerun the model to get confidence bounds and aggregated parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrapFit(
  fit,
  nboot = 200,
  nSampIndiv,
  stratVar,
  stdErrType = c("perc", "sd", "se"),
  ci = 0.95,
  pvalues = NULL,
  restart = FALSE,
  plotHist = FALSE,
  fitName = as.character(substitute(fit))
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootstrapFit_+3A_fit">fit</code></td>
<td>
<p>the nlmixr2 fit object</p>
</td></tr>
<tr><td><code id="bootstrapFit_+3A_nboot">nboot</code></td>
<td>
<p>an integer giving the number of bootstrapped models to
be fit; default value is 200</p>
</td></tr>
<tr><td><code id="bootstrapFit_+3A_nsampindiv">nSampIndiv</code></td>
<td>
<p>an integer specifying the number of samples in
each bootstrapped sample; default is the number of unique
subjects in the original dataset</p>
</td></tr>
<tr><td><code id="bootstrapFit_+3A_stratvar">stratVar</code></td>
<td>
<p>Variable in the original dataset to stratify on;
This is useful to distinguish between sparse and full sampling
and other features you may wish to keep distinct in your
bootstrap</p>
</td></tr>
<tr><td><code id="bootstrapFit_+3A_stderrtype">stdErrType</code></td>
<td>
<p>This gives the standard error type for the
updated standard errors; The current possibilities are: <code>"perc"</code>
which gives the standard errors by percentiles (default), <code>"sd"</code>
which gives the standard errors by the using the normal
approximation of the mean with standard devaition, or <code>"se"</code>
which uses the normal approximation with standard errors
calculated with <code>nSampIndiv</code></p>
</td></tr>
<tr><td><code id="bootstrapFit_+3A_ci">ci</code></td>
<td>
<p>Confidence interval level to calculate.  Default is 0.95
for a 95 percent confidence interval</p>
</td></tr>
<tr><td><code id="bootstrapFit_+3A_pvalues">pvalues</code></td>
<td>
<p>a vector of pvalues indicating the probability of
each subject to get selected; default value is <code>NULL</code> implying
that probability of each subject is the same</p>
</td></tr>
<tr><td><code id="bootstrapFit_+3A_restart">restart</code></td>
<td>
<p>A boolean to try to restart an interrupted or
incomplete boostrap.  By default this is <code>FALSE</code></p>
</td></tr>
<tr><td><code id="bootstrapFit_+3A_plothist">plotHist</code></td>
<td>
<p>A boolean indicating if a histogram plot to assess
how well the bootstrap is doing.  By default this is turned off
(<code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="bootstrapFit_+3A_fitname">fitName</code></td>
<td>
<p>is the fit name that is used for the name of the
boostrap files.  By default it is the fit provided though it
could be something else.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, called for the side effects; The original fit is
updated with the bootstrap confidence bands
</p>


<h3>Author(s)</h3>

<p>Vipul Mann, Matthew Fidler
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
one.cmt &lt;- function() {
  ini({
    tka &lt;- 0.45; label("Ka")
    tcl &lt;- 1; label("Cl")
    tv &lt;- 3.45; label("V")
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd &lt;- 0.7
  })
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl + eta.cl)
    v &lt;- exp(tv + eta.v)
    linCmt() ~ add(add.sd)
  })
}

fit &lt;- nlmixr2(one.cmt, nlmixr2data::theo_sd, est = "saem", control = list(print = 0))

withr::with_tempdir({ # Run example in temp dir

bootstrapFit(fit, nboot = 5, restart = TRUE) # overwrites any of the existing data or model files
bootstrapFit(fit, nboot = 7) # resumes fitting using the stored data and model files

# Note this resumes because the total number of bootstrap samples is not 10

bootstrapFit(fit, nboot=10)

# Note the boostrap standard error and variance/covariance matrix is retained.
# If you wish to switch back you can change the covariance matrix by

nlmixr2est::setCov(fit, "linFim")

# And change it back again

nlmixr2est::setCov(fit, "boot10")

# This change will affect any simulations with uncertainty in their parameters

# You may also do a chi-square diagnostic plot check for the bootstrap with
bootplot(fit)
})

## End(Not run)
</code></pre>

<hr>
<h2 id='buildcovInfo'>Build covInfo list from varsVec and covarsVec</h2><span id='topic+buildcovInfo'></span>

<h3>Description</h3>

<p>Build covInfo list from varsVec and covarsVec
</p>


<h3>Usage</h3>

<pre><code class='language-R'>buildcovInfo(varsVec, covarsVec)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="buildcovInfo_+3A_varsvec">varsVec</code></td>
<td>
<p>character vector of variables that need to be added</p>
</td></tr>
<tr><td><code id="buildcovInfo_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be added</p>
</td></tr>
</table>


<h3>Value</h3>

<p>covInfo list of covariate info
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani
</p>

<hr>
<h2 id='buildupatedUI'>Build updated from the covariate and variable vector list</h2><span id='topic+buildupatedUI'></span>

<h3>Description</h3>

<p>Build updated from the covariate and variable vector list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>buildupatedUI(ui, varsVec, covarsVec, add = TRUE, indep = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="buildupatedUI_+3A_ui">ui</code></td>
<td>
<p>compiled rxode2 nlmir2 model or fit</p>
</td></tr>
<tr><td><code id="buildupatedUI_+3A_varsvec">varsVec</code></td>
<td>
<p>character vector of variables that need to be added</p>
</td></tr>
<tr><td><code id="buildupatedUI_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be added</p>
</td></tr>
<tr><td><code id="buildupatedUI_+3A_add">add</code></td>
<td>
<p>boolean indicating if the covariate needs to be added or removed</p>
</td></tr>
<tr><td><code id="buildupatedUI_+3A_indep">indep</code></td>
<td>
<p>a boolean indicating if the covariates should be added independently, or
sequentially (append to the previous model). only applicable to adding covariate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>updated ui with added covariates
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani
</p>

<hr>
<h2 id='fixedControl'>Control options for fixed-value likelihood profiling</h2><span id='topic+fixedControl'></span>

<h3>Description</h3>

<p>Control options for fixed-value likelihood profiling
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fixedControl()
</code></pre>


<h3>Value</h3>

<p>A validated list of control options for fixed-value likelihood
profiling
</p>


<h3>See Also</h3>

<p><code><a href="#topic+profileFixed">profileFixed()</a></code>
</p>
<p>Other Profiling: 
<code><a href="#topic+llpControl">llpControl</a>()</code>,
<code><a href="#topic+profile.nlmixr2FitCore">profile.nlmixr2FitCore</a>()</code>,
<code><a href="#topic+profileFixed">profileFixed</a>()</code>,
<code><a href="#topic+profileLlp">profileLlp</a>()</code>,
<code><a href="#topic+profileNlmixr2FitCoreRet">profileNlmixr2FitCoreRet</a>()</code>
</p>

<hr>
<h2 id='foldgen'>Stratified cross-validation fold generator function, inspired from the caret</h2><span id='topic+foldgen'></span>

<h3>Description</h3>

<p>Stratified cross-validation fold generator function, inspired from the caret
</p>


<h3>Usage</h3>

<pre><code class='language-R'>foldgen(data, nfold = 5, stratVar = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="foldgen_+3A_data">data</code></td>
<td>
<p>data frame used in the analysis</p>
</td></tr>
<tr><td><code id="foldgen_+3A_nfold">nfold</code></td>
<td>
<p>number of k-fold cross validations. Default is 5</p>
</td></tr>
<tr><td><code id="foldgen_+3A_stratvar">stratVar</code></td>
<td>
<p>Stratification Variable. Default is NULL and ID is used for CV</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return data.frame with the fold column attached
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani, caret
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- nlmixr2data::theo_sd
d$SEX &lt;-0
d$SEX[d$ID&lt;=6] &lt;-1

covarsVec &lt;- c("WT")

# Stratified cross-validation data with CMT
df1 &lt;- foldgen(d, nfold=5, stratVar="CMT")

# Stratified cross-validation data with ID (individual)
df2 &lt;- foldgen(d, nfold=5, stratVar=NULL)
</code></pre>

<hr>
<h2 id='horseshoeSummardf'>Create Horseshoe summary posterior estimates</h2><span id='topic+horseshoeSummardf'></span>

<h3>Description</h3>

<p>Create Horseshoe summary posterior estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>horseshoeSummardf(fit, covarsVec, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="horseshoeSummardf_+3A_fit">fit</code></td>
<td>
<p>compiled rxode2 nlmir2 model fit</p>
</td></tr>
<tr><td><code id="horseshoeSummardf_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be added</p>
</td></tr>
<tr><td><code id="horseshoeSummardf_+3A_...">...</code></td>
<td>
<p>other parameters passed to brm(): warmup = 1000, iter = 2000, chains = 4, cores = 4,
control = list(adapt_delta = 0.99, max_treedepth = 15)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Horse shoe Summary data frame of all covariates
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani, Christian Bartels
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
one.cmt &lt;- function() {
  ini({
    tka &lt;- 0.45; label("Ka")
    tcl &lt;- log(c(0, 2.7, 100)); label("Cl")
    tv &lt;- 3.45; label("V")
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd &lt;- 0.7
  })
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl + eta.cl)
    v &lt;- exp(tv + eta.v)
    linCmt() ~ add(add.sd)
  })
}

d &lt;- nlmixr2data::theo_sd
fit &lt;- nlmixr2(one.cmt, d, est = "saem", control = list(print = 0))
covarsVec &lt;- c("WT")

# Horseshoe summary posterior estimates:

#hsDf &lt;- horseshoeSummardf(fit,covarsVec,cores=2)
#brms sometimes may throw a Error in sink(type = “output”)
#Issue Should be fixed by uninstalling and re-installing rstan

## End(Not run)
</code></pre>

<hr>
<h2 id='knit_print.nlmixr2FitCore'>Extract the equations from an nlmixr2/rxode2 model to produce a 'LaTeX'
equation.</h2><span id='topic+knit_print.nlmixr2FitCore'></span><span id='topic+knit_print.rxUi'></span>

<h3>Description</h3>

<p>Extract the equations from an nlmixr2/rxode2 model to produce a 'LaTeX'
equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlmixr2FitCore'
knit_print(x, ..., output = "equations")

## S3 method for class 'rxUi'
knit_print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="knit_print.nlmixr2FitCore_+3A_x">x</code></td>
<td>
<p>The model to extract equations from</p>
</td></tr>
<tr><td><code id="knit_print.nlmixr2FitCore_+3A_...">...</code></td>
<td>
<p>Ignored</p>
</td></tr>
<tr><td><code id="knit_print.nlmixr2FitCore_+3A_output">output</code></td>
<td>
<p>The type of output to request (currently, just &quot;equations&quot;)</p>
</td></tr>
</table>

<hr>
<h2 id='lassoCoefficients'>Return Final lasso coefficients after finding optimal t</h2><span id='topic+lassoCoefficients'></span>

<h3>Description</h3>

<p>Return Final lasso coefficients after finding optimal t
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lassoCoefficients(
  fit,
  varsVec,
  covarsVec,
  catvarsVec,
  constraint = 1e-08,
  stratVar = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lassoCoefficients_+3A_fit">fit</code></td>
<td>
<p>nlmixr2 fit.</p>
</td></tr>
<tr><td><code id="lassoCoefficients_+3A_varsvec">varsVec</code></td>
<td>
<p>character vector of variables that need to be added</p>
</td></tr>
<tr><td><code id="lassoCoefficients_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be added</p>
</td></tr>
<tr><td><code id="lassoCoefficients_+3A_catvarsvec">catvarsVec</code></td>
<td>
<p>character vector of categorical covariates that need to be added</p>
</td></tr>
<tr><td><code id="lassoCoefficients_+3A_constraint">constraint</code></td>
<td>
<p>theta cutoff. below cutoff then the theta will be fixed to zero</p>
</td></tr>
<tr><td><code id="lassoCoefficients_+3A_stratvar">stratVar</code></td>
<td>
<p>A variable to stratify on for cross-validation</p>
</td></tr>
<tr><td><code id="lassoCoefficients_+3A_...">...</code></td>
<td>
<p>Other parameters to be passed to optimalTvaluelasso</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return data frame of final lasso coefficients
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
one.cmt &lt;- function() {
  ini({
    tka &lt;- 0.45; label("Ka")
    tcl &lt;- log(c(0, 2.7, 100)); label("Cl")
    tv &lt;- 3.45; label("V")
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd &lt;- 0.7
  })
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl + eta.cl)
    v &lt;- exp(tv + eta.v)
    linCmt() ~ add(add.sd)
  })
}

d &lt;- nlmixr2data::theo_sd
d$SEX &lt;-0
d$SEX[d$ID&lt;=6] &lt;-1

fit &lt;- nlmixr2(one.cmt, d, est = "saem", control = list(print = 0))
varsVec &lt;- c("ka","cl","v")
covarsVec &lt;- c("WT")
catvarsVec &lt;- c("SEX")

# Lasso coefficients:

lassoDf &lt;- lassoCoefficients(fit, varsVec, covarsVec, catvarsVec, constraint=1e-08, stratVar = NULL)

## End(Not run)
</code></pre>

<hr>
<h2 id='lassoSummardf'>Create Lasso summary posterior estimates</h2><span id='topic+lassoSummardf'></span>

<h3>Description</h3>

<p>Create Lasso summary posterior estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lassoSummardf(fit, covarsVec, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lassoSummardf_+3A_fit">fit</code></td>
<td>
<p>compiled rxode2 nlmir2 model fit</p>
</td></tr>
<tr><td><code id="lassoSummardf_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be added</p>
</td></tr>
<tr><td><code id="lassoSummardf_+3A_...">...</code></td>
<td>
<p>other parameters passed to brm(): warmup = 1000, iter = 2000, chains = 4, cores = 4,
control = list(adapt_delta = 0.99, max_treedepth = 15)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Horse shoe Summary data frame of all covariates
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani, Christian Bartels
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
one.cmt &lt;- function() {
  ini({
    tka &lt;- 0.45; label("Ka")
    tcl &lt;- log(c(0, 2.7, 100)); label("Cl")
    tv &lt;- 3.45; label("V")
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd &lt;- 0.7
  })
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl + eta.cl)
    v &lt;- exp(tv + eta.v)
    linCmt() ~ add(add.sd)
  })
}

d &lt;- nlmixr2data::theo_sd
fit &lt;- nlmixr2(one.cmt, d, est = "saem", control = list(print = 0))
covarsVec &lt;- c("WT")

# Horseshoe summary posterior estimates:

#lassoDf &lt;- lassoSummardf(fit,covarsVec,cores=2)
#brms sometimes may throw a Error in sink(type = “output”)
#Issue Should be fixed by uninstalling and re-installing rstan

## End(Not run)
</code></pre>

<hr>
<h2 id='llpControl'>Control options for log-likelihood profiling</h2><span id='topic+llpControl'></span>

<h3>Description</h3>

<p>Control options for log-likelihood profiling
</p>


<h3>Usage</h3>

<pre><code class='language-R'>llpControl(
  ofvIncrease = qchisq(0.95, df = 1),
  rseTheta = 30,
  itermax = 10,
  ofvtol = 0.005,
  paramDigits = 3,
  extrapolateExpand = 1.5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="llpControl_+3A_ofvincrease">ofvIncrease</code></td>
<td>
<p>The targetted change in objective function value (3.84
corresponds to a Chi-squared test with a 95% confidence interval)</p>
</td></tr>
<tr><td><code id="llpControl_+3A_rsetheta">rseTheta</code></td>
<td>
<p>The relative standard error (percent) for the model
parameters.  It can be missing (the default) in which case a default value
of 30% will be applied.  If given as a single number, it will be applied to
all parameters.  If given as a named vector of numbers, it will be applied
to each named parameter.</p>
</td></tr>
<tr><td><code id="llpControl_+3A_itermax">itermax</code></td>
<td>
<p>Maximum number of likelihood profiling iterations for each
bound estimated</p>
</td></tr>
<tr><td><code id="llpControl_+3A_ofvtol">ofvtol</code></td>
<td>
<p>The relative tolerance for the objective function being close
enough to the <code>ofvIncrease</code>.</p>
</td></tr>
<tr><td><code id="llpControl_+3A_paramdigits">paramDigits</code></td>
<td>
<p>The number of significant digits required for the
parameter.  When interpolation attempts to get smaller than that number of
significant digits, it will stop.</p>
</td></tr>
<tr><td><code id="llpControl_+3A_extrapolateexpand">extrapolateExpand</code></td>
<td>
<p>When extrapolating outside the range previously
tested, how far should the step occur as a ratio</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A validated list of control options for log-likelihood profiling
</p>


<h3>See Also</h3>

<p><code><a href="#topic+profileLlp">profileLlp()</a></code>
</p>
<p>Other Profiling: 
<code><a href="#topic+fixedControl">fixedControl</a>()</code>,
<code><a href="#topic+profile.nlmixr2FitCore">profile.nlmixr2FitCore</a>()</code>,
<code><a href="#topic+profileFixed">profileFixed</a>()</code>,
<code><a href="#topic+profileLlp">profileLlp</a>()</code>,
<code><a href="#topic+profileNlmixr2FitCoreRet">profileNlmixr2FitCoreRet</a>()</code>
</p>

<hr>
<h2 id='normalizedData'>Function to return data of normalized covariates</h2><span id='topic+normalizedData'></span>

<h3>Description</h3>

<p>Function to return data of normalized covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalizedData(data, covarsVec, replace = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="normalizedData_+3A_data">data</code></td>
<td>
<p>a dataframe with covariates to normalize</p>
</td></tr>
<tr><td><code id="normalizedData_+3A_covarsvec">covarsVec</code></td>
<td>
<p>a list of covariate names (parameters) that need to be estimates</p>
</td></tr>
<tr><td><code id="normalizedData_+3A_replace">replace</code></td>
<td>
<p>replace the original covariate data with normalized data for easier updated model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with all normalized covariates
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
d &lt;- nlmixr2data::theo_sd
d$SEX &lt;-0
d$SEX[d$ID&lt;=6] &lt;-1

covarsVec &lt;- c("WT")

# Normalized covariate (replaced)
df1 &lt;- normalizedData(d,covarsVec,replace=TRUE)

# Normalized covariate (without replacement)
df2 &lt;- normalizedData(d,covarsVec,replace=FALSE)
</code></pre>

<hr>
<h2 id='optimUnisampling'>Sample from uniform distribution by optim</h2><span id='topic+optimUnisampling'></span>

<h3>Description</h3>

<p>Sample from uniform distribution by optim
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimUnisampling(xvec, N = 1000, medValue, floorT = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="optimUnisampling_+3A_xvec">xvec</code></td>
<td>
<p>A vector of min,max values . Ex:c(10,20)</p>
</td></tr>
<tr><td><code id="optimUnisampling_+3A_n">N</code></td>
<td>
<p>Desired number of values</p>
</td></tr>
<tr><td><code id="optimUnisampling_+3A_medvalue">medValue</code></td>
<td>
<p>Desired Median</p>
</td></tr>
<tr><td><code id="optimUnisampling_+3A_floort">floorT</code></td>
<td>
<p>boolean indicating whether to round up</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Samples with approx desired median.
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate 1000 creatine clearance values with median of 71.7 within range of c(6.7,140)
creatCl &lt;- optimUnisampling(xvec=c(6.7,140), N=1000, medValue = 71.7, floorT=FALSE)
</code></pre>

<hr>
<h2 id='preconditionFit'>Linearly re-parameterize the model to be less sensitive to rounding errors</h2><span id='topic+preconditionFit'></span>

<h3>Description</h3>

<p>Linearly re-parameterize the model to be less sensitive to rounding errors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preconditionFit(fit, estType = c("full", "posthoc", "none"), ntry = 10L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="preconditionFit_+3A_fit">fit</code></td>
<td>
<p>A nlmixr2 fit to be preconditioned</p>
</td></tr>
<tr><td><code id="preconditionFit_+3A_esttype">estType</code></td>
<td>
<p>Once the fit has been linearly reparameterized,
should a &quot;full&quot; estimation, &quot;posthoc&quot; estimation or simply a
estimation of the covariance matrix &quot;none&quot; before the fit is
updated</p>
</td></tr>
<tr><td><code id="preconditionFit_+3A_ntry">ntry</code></td>
<td>
<p>number of tries before giving up on a pre-conditioned
covariance estimate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A nlmixr2 fit object that was preconditioned to stabilize
the variance/covariance calculation
</p>


<h3>References</h3>

<p>Aoki Y, Nordgren R, Hooker AC. Preconditioning of
Nonlinear Mixed Effects Models for Stabilisation of
Variance-Covariance Matrix Computations. AAPS
J. 2016;18(2):505-518. doi:10.1208/s12248-016-9866-5
</p>

<hr>
<h2 id='profile.nlmixr2FitCore'>Perform likelihood profiling on nlmixr2 focei fits</h2><span id='topic+profile.nlmixr2FitCore'></span>

<h3>Description</h3>

<p>Perform likelihood profiling on nlmixr2 focei fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlmixr2FitCore'
profile(
  fitted,
  ...,
  which = NULL,
  method = c("llp", "fixed"),
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="profile.nlmixr2FitCore_+3A_fitted">fitted</code></td>
<td>
<p>The fit model</p>
</td></tr>
<tr><td><code id="profile.nlmixr2FitCore_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="profile.nlmixr2FitCore_+3A_which">which</code></td>
<td>
<p>The parameter names to perform likelihood profiling on
(<code>NULL</code> indicates all parameters)</p>
</td></tr>
<tr><td><code id="profile.nlmixr2FitCore_+3A_method">method</code></td>
<td>
<p>Method to use for profiling (see the details)</p>
</td></tr>
<tr><td><code id="profile.nlmixr2FitCore_+3A_control">control</code></td>
<td>
<p>Control arguments for the <code>method</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with one column named <code>Parameter</code> indicating the
parameter being fixed on that row, one column for the <code>OFV</code> indicating the
OFV estimated for the model at that step, one column named <code>profileBound</code>
indicating the estimated value for the profile likelihood and its step
above the minimum profile likelihood value, and columns for each parameter
estimate (or fixed) in the model.
</p>


<h3>Log-likelihood profiling</h3>

<p><code>method = "llp"</code>
</p>
<p>The search will stop when either the OFV is within <code>ofvtol</code> of the desired
OFV change or when the parameter is interpolating to more significant digits
than specified in <code>paramDigits</code>.  The &quot;llp&quot; method uses the <code>profileLlp()</code>
function.  See its help for more details.
</p>


<h3>Fixed points</h3>

<p><code>method = "fixed"</code>
</p>
<p>Estimate the OFV for specific fixed values.  The &quot;fixed&quot; method uses the
<code>profileFixed()</code> function.  See its help for more details.
</p>


<h3>See Also</h3>

<p>Other Profiling: 
<code><a href="#topic+fixedControl">fixedControl</a>()</code>,
<code><a href="#topic+llpControl">llpControl</a>()</code>,
<code><a href="#topic+profileFixed">profileFixed</a>()</code>,
<code><a href="#topic+profileLlp">profileLlp</a>()</code>,
<code><a href="#topic+profileNlmixr2FitCoreRet">profileNlmixr2FitCoreRet</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Likelihood profiling takes a long time to run each model multiple times, so
# be aware that running this example may take a few minutes.
oneCmt &lt;- function() {
  ini({
    tka &lt;- log(1.57)
    tcl &lt;- log(2.72)
    tv &lt;- fixed(log(31.5))
    eta.ka ~ 0.6
    add.sd &lt;- 0.7
  })
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl)
    v &lt;- exp(tv)
    cp &lt;- linCmt()
    cp ~ add(add.sd)
  })
}

fit &lt;-
  nlmixr2(
    oneCmt, data = nlmixr2data::theo_sd, est="focei", control = list(print=0)
  )
# profile all parameters
profall &lt;- profile(fit)

# profile a single parameter
proftka &lt;- profile(fit, which = "tka")

## End(Not run)
</code></pre>

<hr>
<h2 id='profileFixed'>Estimate the objective function values for a model while fixing defined
parameter values</h2><span id='topic+profileFixed'></span><span id='topic+profileFixedSingle'></span>

<h3>Description</h3>

<p>Estimate the objective function values for a model while fixing defined
parameter values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>profileFixed(fitted, which, control = list())

profileFixedSingle(fitted, which)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="profileFixed_+3A_fitted">fitted</code></td>
<td>
<p>The fit model</p>
</td></tr>
<tr><td><code id="profileFixed_+3A_which">which</code></td>
<td>
<p>A data.frame with column names of parameters to fix and values
of the fitted value to fix (one row only).</p>
</td></tr>
<tr><td><code id="profileFixed_+3A_control">control</code></td>
<td>
<p>A list passed to <code>fixedControl()</code> (currently unused)</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>which</code> with a column named <code>OFV</code> added with the objective function
value of the fitted estimate fixing the parameters in the other columns
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>profileFixedSingle()</code>: Estimate the objective function value for a model
while fixing a single set of defined parameter values (for use in parameter
profiling)
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Bill Denney (changed by Matt Fidler to take out R 4.1 specific code)
</p>


<h3>See Also</h3>

<p>Other Profiling: 
<code><a href="#topic+fixedControl">fixedControl</a>()</code>,
<code><a href="#topic+llpControl">llpControl</a>()</code>,
<code><a href="#topic+profile.nlmixr2FitCore">profile.nlmixr2FitCore</a>()</code>,
<code><a href="#topic+profileLlp">profileLlp</a>()</code>,
<code><a href="#topic+profileNlmixr2FitCoreRet">profileNlmixr2FitCoreRet</a>()</code>
</p>
<p>Other Profiling: 
<code><a href="#topic+fixedControl">fixedControl</a>()</code>,
<code><a href="#topic+llpControl">llpControl</a>()</code>,
<code><a href="#topic+profile.nlmixr2FitCore">profile.nlmixr2FitCore</a>()</code>,
<code><a href="#topic+profileLlp">profileLlp</a>()</code>,
<code><a href="#topic+profileNlmixr2FitCoreRet">profileNlmixr2FitCoreRet</a>()</code>
</p>

<hr>
<h2 id='profileLlp'>Profile confidence intervals with log-likelihood profiling</h2><span id='topic+profileLlp'></span>

<h3>Description</h3>

<p>Profile confidence intervals with log-likelihood profiling
</p>


<h3>Usage</h3>

<pre><code class='language-R'>profileLlp(fitted, which, control)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="profileLlp_+3A_fitted">fitted</code></td>
<td>
<p>The fit model</p>
</td></tr>
<tr><td><code id="profileLlp_+3A_which">which</code></td>
<td>
<p>Either <code>NULL</code> to profile all parameters or a character vector of
parameters to estimate</p>
</td></tr>
<tr><td><code id="profileLlp_+3A_control">control</code></td>
<td>
<p>A list passed to <code>llpControl()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with columns named &quot;Parameter&quot; (the parameter name(s)
that were fixed), OFV (the objective function value), and the current
estimate for each of the parameters.  In addition, if any boundary is
found, the OFV increase will be indicated by the absolute value of the
&quot;profileBound&quot; column and if that boundary is the upper or lower boundary
will be indicated by the &quot;profileBound&quot; column being positive or negative,
respectively.
</p>


<h3>See Also</h3>

<p>Other Profiling: 
<code><a href="#topic+fixedControl">fixedControl</a>()</code>,
<code><a href="#topic+llpControl">llpControl</a>()</code>,
<code><a href="#topic+profile.nlmixr2FitCore">profile.nlmixr2FitCore</a>()</code>,
<code><a href="#topic+profileFixed">profileFixed</a>()</code>,
<code><a href="#topic+profileNlmixr2FitCoreRet">profileNlmixr2FitCoreRet</a>()</code>
</p>

<hr>
<h2 id='profileNlmixr2FitCoreRet'>Give the output data.frame for a single model for profile.nlmixr2FitCore</h2><span id='topic+profileNlmixr2FitCoreRet'></span>

<h3>Description</h3>

<p>Give the output data.frame for a single model for profile.nlmixr2FitCore
</p>


<h3>Usage</h3>

<pre><code class='language-R'>profileNlmixr2FitCoreRet(fitted, which, fixedVal)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="profileNlmixr2FitCoreRet_+3A_fitted">fitted</code></td>
<td>
<p>The fit model</p>
</td></tr>
<tr><td><code id="profileNlmixr2FitCoreRet_+3A_which">which</code></td>
<td>
<p>The parameter names to perform likelihood profiling on
(<code>NULL</code> indicates all parameters)</p>
</td></tr>
<tr><td><code id="profileNlmixr2FitCoreRet_+3A_fixedval">fixedVal</code></td>
<td>
<p>The value that <code>which</code> is fixed to in case the model does not
converge.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with columns named &quot;Parameter&quot; (the parameter name(s)
that were fixed), OFV (the objective function value), and the current
estimate for each of the parameters.  Omega values are given as their
variances and covariances.
</p>


<h3>See Also</h3>

<p>Other Profiling: 
<code><a href="#topic+fixedControl">fixedControl</a>()</code>,
<code><a href="#topic+llpControl">llpControl</a>()</code>,
<code><a href="#topic+profile.nlmixr2FitCore">profile.nlmixr2FitCore</a>()</code>,
<code><a href="#topic+profileFixed">profileFixed</a>()</code>,
<code><a href="#topic+profileLlp">profileLlp</a>()</code>
</p>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+knit_print'></span><span id='topic+ini'></span><span id='topic+model'></span><span id='topic+nlmixrWithTiming'></span><span id='topic+nlmixr'></span><span id='topic+nlmixr2'></span><span id='topic+setCov'></span><span id='topic+rxUiDeparse'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>knitr</dt><dd><p><code><a href="knitr.html#topic+knit_print">knit_print</a></code></p>
</dd>
<dt>nlmixr2est</dt><dd><p><code><a href="nlmixr2est.html#topic+nlmixr2">nlmixr</a></code>, <code><a href="nlmixr2est.html#topic+nlmixr2">nlmixr2</a></code>, <code><a href="nlmixr2est.html#topic+nlmixrWithTiming">nlmixrWithTiming</a></code>, <code><a href="nlmixr2est.html#topic+setCov">setCov</a></code></p>
</dd>
<dt>rxode2</dt><dd><p><code><a href="rxode2.html#topic+ini">ini</a></code>, <code><a href="rxode2.html#topic+model">model</a></code>, <code><a href="rxode2.html#topic+rxUiDeparse">rxUiDeparse</a></code></p>
</dd>
</dl>

<hr>
<h2 id='regularmodel'>Regular lasso model</h2><span id='topic+regularmodel'></span>

<h3>Description</h3>

<p>Regular lasso model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regularmodel(
  fit,
  varsVec,
  covarsVec,
  catvarsVec,
  constraint = 1e-08,
  lassotype = c("regular", "adaptive", "adjusted"),
  stratVar = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regularmodel_+3A_fit">fit</code></td>
<td>
<p>nlmixr2 fit.</p>
</td></tr>
<tr><td><code id="regularmodel_+3A_varsvec">varsVec</code></td>
<td>
<p>character vector of variables that need to be added</p>
</td></tr>
<tr><td><code id="regularmodel_+3A_covarsvec">covarsVec</code></td>
<td>
<p>character vector of covariates that need to be added</p>
</td></tr>
<tr><td><code id="regularmodel_+3A_catvarsvec">catvarsVec</code></td>
<td>
<p>character vector of categorical covariates that need to be added</p>
</td></tr>
<tr><td><code id="regularmodel_+3A_constraint">constraint</code></td>
<td>
<p>theta cutoff. below cutoff then the theta will be fixed to zero.</p>
</td></tr>
<tr><td><code id="regularmodel_+3A_lassotype">lassotype</code></td>
<td>
<p>must be  'regular' , 'adaptive', 'adjusted'</p>
</td></tr>
<tr><td><code id="regularmodel_+3A_stratvar">stratVar</code></td>
<td>
<p>A variable to stratify on for cross-validation.</p>
</td></tr>
<tr><td><code id="regularmodel_+3A_...">...</code></td>
<td>
<p>Other parameters to be passed to optimalTvaluelasso</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return fit of the selected lasso coefficients
</p>


<h3>Author(s)</h3>

<p>Vishal Sarsani
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
one.cmt &lt;- function() {
  ini({
    tka &lt;- 0.45; label("Ka")
    tcl &lt;- log(c(0, 2.7, 100)); label("Cl")
    tv &lt;- 3.45; label("V")
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd &lt;- 0.7
  })
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl + eta.cl)
    v &lt;- exp(tv + eta.v)
    linCmt() ~ add(add.sd)
  })
}

d &lt;- nlmixr2data::theo_sd
d$SEX &lt;-0
d$SEX[d$ID&lt;=6] &lt;-1

fit &lt;- nlmixr2(one.cmt, d, est = "saem", control = list(print = 0))
varsVec &lt;- c("ka","cl","v")
covarsVec &lt;- c("WT")
catvarsVec &lt;- c("SEX")

# Model fit with regular lasso coefficients:

lassoDf &lt;- regularmodel(fit,varsVec,covarsVec,catvarsVec)
# Model fit with adaptive lasso coefficients:

lassoDf &lt;- regularmodel(fit,varsVec,covarsVec,catvarsVec,lassotype='adaptive')
# Model fit with adaptive-adjusted lasso coefficients:

lassoDf &lt;- regularmodel(fit,varsVec,covarsVec,catvarsVec, lassotype='adjusted')

## End(Not run)
</code></pre>

<hr>
<h2 id='theoFitOde'>Example single dose Theophylline ODE model</h2><span id='topic+theoFitOde'></span>

<h3>Description</h3>

<p>This is a nlmixr2 model that is pre-run so that it can be used in
package testing and development.  It is regenerated whenever
binaries of <code>nlmixr2extra</code> are created.  If there is a binary
incompatability between the fit objects, a simple rerun of the
installation will fix this nlmixr2 fit object.
</p>


<h3>Format</h3>

<p>A (modified) data frame with  132 rows and 22 columns.
</p>

<dl>
<dt>ID</dt><dd><p>Patient identifier</p>
</dd>
<dt>TIME</dt><dd><p>Time (hr)</p>
</dd>
<dt>DV</dt><dd><p>Dependent variable (concentration)</p>
</dd>
<dt>PRED</dt><dd><p>Predictions without any between subject variability</p>
</dd>
<dt>RES</dt><dd><p>Population Residual</p>
</dd>
<dt>WRES</dt><dd><p>Weighted Residuals under the FO assumption</p>
</dd>
<dt>IPRED</dt><dd><p>Individual Predictions</p>
</dd>
<dt>IRES</dt><dd><p>Individual Residuals</p>
</dd>
<dt>IWRES</dt><dd><p>Individual Weighted Residuals</p>
</dd>
<dt>CPRED</dt><dd><p>Conditional Prediction under the FOCE assumption</p>
</dd>
<dt>CRES</dt><dd><p>Conditional Residuals under the FOCE assumption</p>
</dd>
<dt>CWRES</dt><dd><p>Conditional Weighted Residuals under the FOCE assumption</p>
</dd>
<dt>eta.ka</dt><dd><p>Between subject changes for ka</p>
</dd>
<dt>eta.cl</dt><dd><p>Between subject changes for v</p>
</dd>
<dt>depot</dt><dd><p>amount in the depot compartment</p>
</dd>
<dt>center</dt><dd><p>amount in the central compartment</p>
</dd>
<dt>ka</dt><dd><p>Individual ka values</p>
</dd>
<dt>cl</dt><dd><p>Individual cl values</p>
</dd>
<dt>v</dt><dd><p>Individual volume of distribution</p>
</dd>
<dt>tad</dt><dd><p>Time after dose</p>
</dd>
<dt>dosenum</dt><dd><p>Dose number</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
