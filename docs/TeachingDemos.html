<!DOCTYPE html><html><head><title>Help for package TeachingDemos</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TeachingDemos}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%&lt;%'>
<p>Less than or Less than and equal operators that can be chained together.</p></a></li>
<li><a href='#bct'><p>Box-Cox Transforms</p></a></li>
<li><a href='#cal'>
<p>Plot a month or year calendar</p></a></li>
<li><a href='#char2seed'><p> Convert a character string into a random seed</p></a></li>
<li><a href='#chisq.detail'><p>Print details of a chi-squared test</p></a></li>
<li><a href='#ci.examp'><p> Plot examples of Confidence Intervals</p></a></li>
<li><a href='#clipplot'><p> Clip plotting to a rectangular region</p></a></li>
<li><a href='#clt.examp'><p>Plot Examples of the Central Limit Theorem</p></a></li>
<li><a href='#cnvrt.coords'><p>Convert between the 5 different coordinate sytems on a graphical device</p></a></li>
<li><a href='#coin.faces'><p> Designs for coin faces for use with plot.rgl.coin</p></a></li>
<li><a href='#col2grey'><p>Convert colors to grey/grayscale</p></a></li>
<li><a href='#cor.rect.plot'>
<p>Plot a visualization of the correlation using colored rectangles</p></a></li>
<li><a href='#dice'><p>Simulate rolling dice</p></a></li>
<li><a href='#digits'>
<p>Return the digits that make up an integer</p></a></li>
<li><a href='#dots'><p> Create a quick dotchart (histogram)</p></a></li>
<li><a href='#dynIdentify'><p> Interacively place labels for points in a plot</p></a></li>
<li><a href='#evap'>
<p>Data on soil evaporation.</p></a></li>
<li><a href='#faces'><p>    Chernoff Faces</p></a></li>
<li><a href='#faces2'><p> Chernoff Faces</p></a></li>
<li><a href='#fagan.plot'><p>Create a Fagan plot to demonstrate Bayes Theorem and screening</p>
tests</a></li>
<li><a href='#gp.open'><p>Alpha version functions to send plotting commands to GnuPlot</p></a></li>
<li><a href='#hpd'><p>Compute Highest Posterior Density Intervals</p></a></li>
<li><a href='#HWidentify'><p> Show label for point being Hovered over.</p></a></li>
<li><a href='#lattice.demo'><p> Interactively explore the conditioned panels in lattice plots.</p></a></li>
<li><a href='#ldsgrowth'>
<p>Growth of The Church of Jesus Christ of Latter-day Saints.</p></a></li>
<li><a href='#loess.demo'><p> Demonstrate the internals of loess curve fits</p></a></li>
<li><a href='#mle.demo'><p> Demonstrate the basic concept of Maximum Likelihood Estimation</p></a></li>
<li><a href='#ms.polygram'><p>Symbol functions/data to be passed as symb argument to</p>
my.symbols</a></li>
<li><a href='#my.symbols'><p>Draw Symbols (User Defined) on a Plot</p></a></li>
<li><a href='#outliers'>
<p>Outliers data</p></a></li>
<li><a href='#pairs2'><p>Create part of a scatterplot matrix</p></a></li>
<li><a href='#panel.my.symbols'><p>Draw Symbols (User Defined) on a Lattice Plot</p></a></li>
<li><a href='#petals'>
<p>Play the Petals Around the Rose game</p></a></li>
<li><a href='#plot2script'><p>Create a script from the current plot</p></a></li>
<li><a href='#power.examp'><p> Graphically illustrate the concept of power.</p></a></li>
<li><a href='#put.points.demo'><p> Demonstrate Correlation and Regression by placing and moving</p>
data points</a></li>
<li><a href='#Pvalue.norm.sim'><p> Simulate P-values</p></a></li>
<li><a href='#rgl.coin'><p> Animated die roll or coin flip</p></a></li>
<li><a href='#rgl.Map'><p> Plot a map in an rgl window</p></a></li>
<li><a href='#roc.demo'><p> Demonstrate ROC curves by interactively building one</p></a></li>
<li><a href='#rotate.cloud'><p> Interactively rotate 3D plots</p></a></li>
<li><a href='#run.cor.examp'><p> Interactively demonstrate correlations</p></a></li>
<li><a href='#run.hist.demo'><p> Create a histogram and interactively change the number of bars.</p></a></li>
<li><a href='#SensSpec.demo'><p> Demonstrate Sensitivity, Specificity, PPV, and NPV</p></a></li>
<li><a href='#shadowtext'><p>Add text to a plot with a contrasting background.</p></a></li>
<li><a href='#sigma.test'><p> One sample Chi-square test for a population variance</p></a></li>
<li><a href='#simfun'>
<p>Create a function to simulate data</p></a></li>
<li><a href='#slider'><p>slider / button control widgets</p></a></li>
<li><a href='#sliderv'><p> Create a Tk slider window</p></a></li>
<li><a href='#SnowsCorrectlySizedButOtherwiseUselessTestOfAnything'>
<p>Snow's Correctly Sized But Otherwise Useless Test of Anything</p></a></li>
<li><a href='#SnowsPenultimateNormalityTest'>
<p>Test the uninteresting question of whether the data represents an</p>
exact normal distribution.</a></li>
<li><a href='#spread.labs'><p> Spread out close points for labeling in plots</p></a></li>
<li><a href='#squishplot'><p>Squish the plotting area to a specified aspect ratio</p></a></li>
<li><a href='#steps'>
<p>Steps data</p></a></li>
<li><a href='#stork'>
<p>Neyman's Stork data</p></a></li>
<li><a href='#subplot'><p>Embed a new plot within an existing plot</p></a></li>
<li><a href='#TeachingDemos-package'>
<p>Various functions for demonstration and learning.</p></a></li>
<li><a href='#TkApprox'><p>Plot a set of data in a Tk window and interactively move lines to</p>
see predicted y-values corresponding to selected x-values.</a></li>
<li><a href='#tkBrush'><p>Change the Color and Styles of points interactively</p></a></li>
<li><a href='#TkBuildDist'>
<p>Interactively create a probability distribution.</p></a></li>
<li><a href='#tkexamp'><p>Create Tk dialog boxes with controls to show examples of changing</p>
parameters on a graph.</a></li>
<li><a href='#TkListView'><p> Interactivly view structures of list and list like objects.</p></a></li>
<li><a href='#TkPredict'><p>Plot predicted values from a model against one of the predictors</p>
for a given value of the othe predictors</a></li>
<li><a href='#TkSpline'><p>Plot a set of data in a Tk window and interactively move a line to</p>
see predicted y-values from a spline fit corresponding to selected x-values.</a></li>
<li><a href='#towork'><p> Sample data downloaded and converted from a GPS unit</p></a></li>
<li><a href='#tree.demo'><p> Interactively demonstrate regression trees</p></a></li>
<li><a href='#triplot'><p> Create or add to a Trilinear Plot</p></a></li>
<li><a href='#txtStart'><p>Save a transcript of commands and/or output to a text file.</p></a></li>
<li><a href='#updateusr'><p>Updates the 'usr' coordinates in the current plot.</p></a></li>
<li><a href='#USCrimes'>
<p>US Crime Statistics</p></a></li>
<li><a href='#vis.binom'><p> Plot various distributions then interactivly adjust the parameters.</p></a></li>
<li><a href='#vis.boxcox'><p> Interactively visualize Box-Cox transformations</p></a></li>
<li><a href='#vis.test'>
<p>Do a Visual test of a null hypothesis by choosing the graph that does</p>
not belong.</a></li>
<li><a href='#z.test'><p> Z test for known population standard deviation</p></a></li>
<li><a href='#zoomplot'><p>Zoom or unzoom an existing plot in the plot window</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Demonstrations for Teaching and Learning</td>
</tr>
<tr>
<td>Version:</td>
<td>2.13</td>
</tr>
<tr>
<td>Author:</td>
<td>Greg Snow</td>
</tr>
<tr>
<td>Description:</td>
<td>Demonstration functions that can be used in a classroom to demonstrate statistical concepts, or on your own to better understand the concepts or the programming.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Greg Snow &lt;538280@gmail.com&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/Artistic-2.0">Artistic-2.0</a></td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-13</td>
</tr>
<tr>
<td>Suggests:</td>
<td>tkrplot, lattice, MASS, rgl, tcltk, tcltk2, png, ggplot2,
logspline, spData, sf</td>
</tr>
<tr>
<td>Enhances:</td>
<td>manipulate, R2wd</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>KeepSource:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-16 21:07:53 UTC; gls33</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-16 23:10:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26lt+3B+25'>
Less than or Less than and equal operators that can be chained together.
</h2><span id='topic++25+3C+25'></span><span id='topic++25+3C+3D+25'></span>

<h3>Description</h3>

<p>Comparison operators that can be chained together into
something like 0 %&lt;% x %&lt;% 1 instead of 0 &lt; x &amp;&amp; x &lt; 1. </p>


<h3>Usage</h3>

<pre><code class='language-R'>x %&lt;% y
x %&lt;=% y
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26lt+2B3B+2B25_+3A_x">x</code>, <code id="+2B25+2B26lt+2B3B+2B25_+3A_y">y</code></td>
<td>
<p>Values to compare
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions/operators allow chained inequalities.  To specify that
you want the values between two values (say 0 and 1) you can use <code>0
  %&lt;% x %&lt;% 1 </code> rather than <code> 0 &lt; x \&amp;\&amp; x &lt; 1 </code>.
</p>


<h3>Value</h3>






<p>A logical vector is returned that can be used for subsetting like
<code>&lt;</code>, but the original values are included as attributes to be used
in additional comparisons.
</p>


<h3>Note</h3>


<p>This operator is not fully associative and has different precedence than
<code>&lt;</code> and <code>&lt;=</code>, so be careful with parentheses.
See the examples.
</p>


<h3>Author(s)</h3>

<p>Greg Snow, <a href="mailto:538280@gmail.com">538280@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- -3:3

 -2 %&lt;% x %&lt;% 2
c( -2 %&lt;% x %&lt;% 2 )
x[ -2 %&lt;% x %&lt;% 2 ]
x[ -2 %&lt;=% x %&lt;=% 2 ]


x &lt;- rnorm(100)
y &lt;- rnorm(100)

x[ -1 %&lt;% x %&lt;% 1 ]
range( x[ -1 %&lt;% x %&lt;% 1 ] )


cbind(x,y)[ -1 %&lt;% x %&lt;% y %&lt;% 1, ]
cbind(x,y)[ (-1 %&lt;% x) %&lt;% (y %&lt;% 1), ]
cbind(x,y)[ ((-1 %&lt;% x) %&lt;% y) %&lt;% 1, ]
cbind(x,y)[ -1 %&lt;% (x %&lt;% (y %&lt;% 1)), ]
cbind(x,y)[ -1 %&lt;% (x %&lt;% y) %&lt;% 1, ] # oops


3 
3 


</code></pre>

<hr>
<h2 id='bct'>Box-Cox Transforms</h2><span id='topic+bct'></span>

<h3>Description</h3>

<p>Computes the Box-Cox transform of the data for a given value of
lambda.  Includes the scaling factor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bct(y, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bct_+3A_y">y</code></td>
<td>
<p>Vector of data to be transformed.</p>
</td></tr>
<tr><td><code id="bct_+3A_lambda">lambda</code></td>
<td>
<p>Scalar exponent for transform (1 is linear, 0 is log).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bct</code> computes the Box-Cox family of transforms:  y = (y^lambda -
1)/(lambda*gm^(lambda-1)), where gm is the geometric mean of the y's.
returns log(y)*gm when lambda equals 0.
</p>


<h3>Value</h3>

<p>A vector of the same length as y with the corresponding transformed values.
</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+vis.boxcox">vis.boxcox</a></code>, <code><a href="#topic+vis.boxcoxu">vis.boxcoxu</a></code>,
<code><a href="MASS.html#topic+boxcox">boxcox</a></code> in package MASS, other implementations in various
packages</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;- rlnorm(500, 3, 2)
par(mfrow=c(2,2))
qqnorm(y)
qqnorm(bct(y,1/2))
qqnorm(bct(y,0))
hist(bct(y,0))



</code></pre>

<hr>
<h2 id='cal'>
Plot a month or year calendar
</h2><span id='topic+cal'></span>

<h3>Description</h3>

<p>Plot a calendar of the specified year or month.  Monthly calendars can
have additional information (text/plots) added to the individual cells.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cal(month, year)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cal_+3A_month">month</code></td>
<td>

<p>The month for the calendar, if ommitted will do a yearly calendar,
can either be a number from 1 to 12 or a character string that will
be matched (using <code>pmatch</code>) against <code>month.name</code>.
</p>
</td></tr>
<tr><td><code id="cal_+3A_year">year</code></td>
<td>

<p>The year for the calendar.  If ommitted and <code>month</code> is an
integer less than or equal to 12 then <code>month</code> will be used as
the year.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots on the current (or default) graphics device a
yearly or monthly calendar.  It tries to guess what you want, if both
<code>year</code> and <code>month</code> are ommitted then it will plot the
current month.  If <code>month</code> is an integer greater than 12 and no
<code>year</code> is specified then
that value will be used as the year for a yearly calendar.  The
<code>month</code> can be either an integer from 1 to 12 or a character
string that will be matched against <code>month.name</code> using
<code>pmatch</code>.
</p>
<p>Each day of the monthly calendar is a plotting frame that can be
added to using stardard low level functions, the coordinates of the
plotting region (the entire box) are from 0 to 1 in both
dimensions.  The <code><a href="#topic+updateusr">updateusr</a></code> function can be used to
change the coordinates.  The return from the function (when creating
a monthly calendar) can be used to select the day.
</p>


<h3>Value</h3>

<p>Nothing is returned when a whole year calendar is created.  When the
month calendar is created a function is returned invisibly that if
passed an integer corresponding to a day of the month will set the
graphics parameters so the corresponding day in the calendar becomes
the current plotting figure.  See the examples below.
</p>


<h3>Author(s)</h3>

<p>Greg Snow, <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+Sys.time">Sys.time</a></code>, <code><a href="base.html#topic+as.POSIXlt">as.POSIXlt</a></code>, <code><a href="graphics.html#topic+par">par</a></code>, <code><a href="#topic+updateusr">updateusr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cal(2011)

cal('May')

setday &lt;- cal(11, 2011)

setday(3)
text(0.5,0.5, 'Some\nCentered\nText')

setday(8)
text(1,1,'Top Right',adj=c(1,1))

setday(18)
text(0,0,'Bottom Left', adj=c(0,0) )

setday(21)
tmp.x &lt;- runif(25)
tmp.y &lt;- rnorm(25, tmp.x, .1)
mrgn.x &lt;- 0.04*diff(range(tmp.x))
mrgn.y &lt;- 0.04*diff(range(tmp.y))
updateusr( 0:1, 0:1, range(tmp.x)+c(-1,1)*mrgn.x, range(tmp.y)+c(-1,1)*mrgn.y)
points(tmp.x, tmp.y)

setday(30)
tmp &lt;- hist(rnorm(100), plot=FALSE)
updateusr( 0:1, 0:1, range(tmp$breaks), range(tmp$counts*1.1,0) )
lines(tmp)
</code></pre>

<hr>
<h2 id='char2seed'> Convert a character string into a random seed </h2><span id='topic+char2seed'></span>

<h3>Description</h3>

<p>This function creates a seed for the random number generator from a
character string.  Character strings can be based on student names so
that every student has a different random sample, but the teacher can
generate the same datasets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>char2seed(x, set = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="char2seed_+3A_x">x</code></td>
<td>
<p> A character string </p>
</td></tr>
<tr><td><code id="char2seed_+3A_set">set</code></td>
<td>
<p> Logical, should the seed be set or just returned </p>
</td></tr>
<tr><td><code id="char2seed_+3A_...">...</code></td>
<td>
<p> Additional parameters passed on to <code>set.seed</code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simulations or other situations call for the need to have repeatable
random numbers, it is easier to remember a word or string than a
number, so this function converts words or character strings to an
integer and optionally sets the seed based on this.
</p>
<p>Teachers can assign students to generate a random dataset using their
name to seed the rng, this way each student will have a different
dataset, but the teacher can generate the same set of data to check
values.
</p>
<p>Any characters other than letters (a-zA-Z) or digits (0-9) will be
silently removed.  This function is not case sensitive, so &quot;ABC&quot; and
&quot;abc&quot; will generate the same seed.
</p>
<p>This is a many to one function, so it is possible to find different
words that generate the same seed, but this is unlikely by chance alone.
</p>


<h3>Value</h3>

<p>This returns an integer (but mode numeric) to use as a seed for the
RNG.  If <code>set</code> is true then it is returned invisibly.
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

 <p><code><a href="base.html#topic+set.seed">set.seed</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>char2seed('Snow')
x &lt;- rnorm(100)
rnorm(10)
tmp &lt;- char2seed('Snow',set=FALSE)
set.seed(tmp)
y &lt;- rnorm(100)

all.equal(x,y) # should be true

</code></pre>

<hr>
<h2 id='chisq.detail'>Print details of a chi-squared test</h2><span id='topic+chisq.detail'></span>

<h3>Description</h3>

<p>Prints out the details of the computations involved in a chi-squared
test on a table.  Includes the expected values and the chi-squared
contribution of each cell.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chisq.detail(tab)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chisq.detail_+3A_tab">tab</code></td>
<td>
<p>Matrix or table to be analyzed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function prints out the input table along with the expected value
for each cell under the null hypothesis.  It also prints out the
chi-squared contribution of each cell in the same pattern as the
table.  This shows the computations involved and one rule of thumb is
to look for these values that are greater than 4 as a post-hoc analysis.
</p>


<h3>Value</h3>

<p>This function is used primarily for its side effect of printing the
results, but does return invisibly a list with the following components:
</p>
<table>
<tr><td><code>obs</code></td>
<td>
<p>A matrix of the observed values, same as tab.</p>
</td></tr>
<tr><td><code>expected</code></td>
<td>
<p>A matrix of the expected values under the null hypothesis.</p>
</td></tr>
<tr><td><code>chi.table</code></td>
<td>
<p>A matrix of the chi-squared contributions of each
cell.</p>
</td></tr>
<tr><td><code>chi2</code></td>
<td>
<p>The chi-squared test statistic.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Greg Snow, <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>References</h3>

<p> ~put references to the literature/web site here ~ Moore, bps </p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+chisq.test">chisq.test</a></code>,<code><a href="stats.html#topic+loglin">loglin</a></code>,
<code><a href="stats.html#topic+xtabs">xtabs</a></code>, <code><a href="base.html#topic+table">table</a></code>, <code><a href="base.html#topic+prop.table">prop.table</a></code>,
<code>CrossTable</code> from the gmodels package.</p>


<h3>Examples</h3>

<pre><code class='language-R'>chisq.detail(HairEyeColor[,,1])
chisq.detail(HairEyeColor[,,2])
</code></pre>

<hr>
<h2 id='ci.examp'> Plot examples of Confidence Intervals </h2><span id='topic+ci.examp'></span><span id='topic+run.ci.examp'></span>

<h3>Description</h3>

<p>Generate <code>reps</code> samples from a normal distribution then compute
and plot confidence intervals for each sample along with information
about the population to demonstrate confidence intervals.  Optionally
change the confidence level using a Tk slider.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ci.examp(mean.sim = 100, sd = 10, n = 25, reps = 50, conf.level = 0.95,
  method = "z", lower.conf = (1 - conf.level)/2,
  upper.conf = 1 - (1 - conf.level)/2)
run.ci.examp(reps = 100, seed, method="z", n=25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ci.examp_+3A_mean.sim">mean.sim</code></td>
<td>
<p> The mean of the population. </p>
</td></tr>
<tr><td><code id="ci.examp_+3A_sd">sd</code></td>
<td>
<p> The standard deviation of the population. </p>
</td></tr>
<tr><td><code id="ci.examp_+3A_n">n</code></td>
<td>
<p> The sample size for each sample. </p>
</td></tr>
<tr><td><code id="ci.examp_+3A_reps">reps</code></td>
<td>
<p> The number of samples/intervals to create. </p>
</td></tr>
<tr><td><code id="ci.examp_+3A_conf.level">conf.level</code></td>
<td>
<p> The confidence level of the intervals.  </p>
</td></tr>
<tr><td><code id="ci.examp_+3A_method">method</code></td>
<td>
<p> 'z', 't', or 'both', should the intervals be based on
the normal, the t, or both distributions. </p>
</td></tr>
<tr><td><code id="ci.examp_+3A_lower.conf">lower.conf</code></td>
<td>
<p> Quantile for lower confidence bound. </p>
</td></tr>
<tr><td><code id="ci.examp_+3A_upper.conf">upper.conf</code></td>
<td>
<p> Quantile for upper confidence bound. </p>
</td></tr>
<tr><td><code id="ci.examp_+3A_seed">seed</code></td>
<td>
<p> The seed to use for the random number generation. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions demonstrate the concept of confidence intervals by
taking multiple samples from a known normal distribution and
calculating a confidence interval for each sample and plotting the
interval relative to the true mean.  Intervals that contain the true
mean will be plotted in black and those that do not include the true
mean will be plotted in different colors.
</p>
<p>The <code>method</code> argument determines the type of interval: 'z' will
use the normal distribution and the known population standard
deviation, 't' will use the t distribution and the sample standard
deviations, 'both' will compute both for each sample for easy
comparison (it is best to reduce <code>reps</code> to about 25 when using
'both').
</p>
<p>The optional arguments <code>lower.conf</code> and <code>upper.conf</code> can be
used to plot non-symmetric or 1 sided confidence intervals.
</p>
<p>The function <code>run.ci.examp</code> also creates a Tk slider that will
allow you to interactively change the confidence level and replot the
intervals to show how the interval widths change with the confidence
level.
</p>


<h3>Value</h3>

<p>These functions are run solely for the side effect of plotting the
intervals, there is no meaningfull return value.
</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

<p><code><a href="#topic+z.test">z.test</a></code>, <code><a href="stats.html#topic+t.test">t.test</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>ci.examp()

if(interactive()) {
  run.ci.examp()
}

# 1 sided confidence intervals
ci.examp(lower.conf=0, upper.conf=0.95)

# non-symmetric intervals
ci.examp(lower.conf=0.02, upper.conf=0.97)
</code></pre>

<hr>
<h2 id='clipplot'> Clip plotting to a rectangular region </h2><span id='topic+clipplot'></span>

<h3>Description</h3>

<p>Clip plotting to a rectangular region that is a subset of the plotting area
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clipplot(fun, xlim = par("usr")[1:2], ylim = par("usr")[3:4])
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clipplot_+3A_fun">fun</code></td>
<td>
<p> The function or expression to do the plotting. </p>
</td></tr>
<tr><td><code id="clipplot_+3A_xlim">xlim</code></td>
<td>
<p> A vector of length 2 representing the x-limits to clip
plotting to, defaults to the entire width of the plotting region. </p>
</td></tr>
<tr><td><code id="clipplot_+3A_ylim">ylim</code></td>
<td>
<p> A vector of length 2 representing the y-limits to clip
the plot to, defaults to the entire height of the plotting region. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function resets the active region for plotting to a rectangle
within the plotting area and turns on clipping so that any points,
lines, etc. that are outside the rectange are not plotted.
</p>
<p>A side effect of this function is a call to the <code>box()</code> command,
it is called with a fully transparent color so if your graphics device
honors transparency then you will probably see no effect.
</p>


<h3>Value</h3>

<p>Nothing meaningful is returned
</p>


<h3>Note</h3>

<p>This function abuses some of the intent of what par(plt=...) is
supposed to mean.  In R2.7.0 and beyond there is a new funcntion
<code>clip</code> with the intended purpose of doing this in a more proper
manner (however as of my last test it is not working perfectly either,
so <code>clipplot</code> will remain undepricated for now).
</p>
<p>It uses some hacks to make sure that the clipping region is set, but
it does this by plotting some tranparent boxes, therefore you should
not use this on devices where tranparency is not supported (or you may
see extra boxes).
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

 <p><code><a href="graphics.html#topic+par">par</a></code>, <code><a href="graphics.html#topic+lines">lines</a></code>, <code>clip</code> in R2.7.0
and later </p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(1,100)
y &lt;- rnorm(100)
plot(x,y, type='b', col='blue')
clipplot( lines(x,y, type='b', col='red'), ylim=c(par('usr')[3],0))


attach(iris)

tmp &lt;- c('red','green','blue')
names(tmp) &lt;- levels(Species)
plot(Petal.Width,Petal.Length, col=tmp[Species])
for(s in levels(Species)){
  clipplot( abline(
    lm(Petal.Length~Petal.Width, data=iris, subset=Species==s),
    col=tmp[s]),
    xlim=range(Petal.Width[Species==s]))
}

detach(iris)

</code></pre>

<hr>
<h2 id='clt.examp'>Plot Examples of the Central Limit Theorem</h2><span id='topic+clt.examp'></span>

<h3>Description</h3>

<p>Takes samples of size <code>n</code> from 4 different distributions and
plots histograms of the means along with a normal curve with matching
mean and standard deviation.  Creating the plots for different values
of <code>n</code> demonstrates the Central Limit Theorem.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clt.examp(n = 1, reps = 10000, nclass = 16, norm.param=list(mean=0,sd=1),
          gamma.param=list(shape=1, rate=1/3), unif.param=list(min=0,max=1),
          beta.param=list(shape1=0.35, shape2=0.25))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clt.examp_+3A_n">n</code></td>
<td>
<p>size of the individual samples</p>
</td></tr>
<tr><td><code id="clt.examp_+3A_reps">reps</code></td>
<td>
<p>number of samples to take from each distribution</p>
</td></tr>
<tr><td><code id="clt.examp_+3A_nclass">nclass</code></td>
<td>
<p>number of bars in the histograms</p>
</td></tr>
<tr><td><code id="clt.examp_+3A_norm.param">norm.param</code></td>
<td>
<p>List with parameters passed to <code>rnorm</code></p>
</td></tr>
<tr><td><code id="clt.examp_+3A_gamma.param">gamma.param</code></td>
<td>
<p>List with parameters passed to <code>rgamma</code></p>
</td></tr>
<tr><td><code id="clt.examp_+3A_unif.param">unif.param</code></td>
<td>
<p>List with parameters passed to <code>runif</code></p>
</td></tr>
<tr><td><code id="clt.examp_+3A_beta.param">beta.param</code></td>
<td>
<p>List with parameters passed to <code>rbeta</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 4 distributions sampled from are a Normal with defaults mean 0 and
standard deviation 1, a gamma with defaults shape 1 (exponential) and
lambda 1/3 (mean = 3), a uniform
distribution from 0 to 1 (default), and a beta distribution with
default
alpha 0.35 and beta 0.25 (U shaped left skewed).
</p>
<p>The <code>norm.param</code>, <code>gamma.param</code>, <code>unif.param</code>, and
<code>beta.param</code> arguments can be used to change the parameters of
the generating distributions.
</p>
<p>Running the function with <code>n</code>=1 will show the populations.  Run
the function again with <code>n</code> at higher values to show that the
sampling distribution of the uniform quickly becomes normal and the
exponential and beta distributions eventually become normal (but much
slower than the uniform).
</p>


<h3>Value</h3>

<p>This function is run for its side effect of creating plots.  It
returns NULL invisibly.
</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rnorm">rnorm</a></code>, <code><a href="stats.html#topic+rexp">rexp</a></code>, <code><a href="stats.html#topic+runif">runif</a></code>,
<code><a href="stats.html#topic+rbeta">rbeta</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>clt.examp()
clt.examp(5)
clt.examp(30)
clt.examp(50)

</code></pre>

<hr>
<h2 id='cnvrt.coords'>Convert between the 5 different coordinate sytems on a graphical device</h2><span id='topic+cnvrt.coords'></span>

<h3>Description</h3>

<p>Takes a set of coordinates in any of the 5 coordinate systems (usr,
plt, fig, dev, or tdev) and returns the same points in all 5
coordinate systems.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cnvrt.coords(x, y = NULL, input = c("usr", "plt", "fig", "dev","tdev"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cnvrt.coords_+3A_x">x</code></td>
<td>
<p>Vector, Matrix, or list of x coordinates (or x and y
coordinates), NA's allowed. </p>
</td></tr>
<tr><td><code id="cnvrt.coords_+3A_y">y</code></td>
<td>
<p>y coordinates (if <code>x</code> is a vector), NA's allowed. </p>
</td></tr>
<tr><td><code id="cnvrt.coords_+3A_input">input</code></td>
<td>
<p>Character scalar indicating the coordinate system of the
input points. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Every plot has 5 coordinate systems:
</p>
<p>usr (User): the coordinate system of the data, this is shown by the
tick marks and axis labels.
</p>
<p>plt (Plot): Plot area, coordinates range from 0 to 1 with 0
corresponding to the x and y axes and 1 corresponding to the top and
right of the plot area.  Margins of the plot correspond to plot
coordinates less than 0 or greater than 1.
</p>
<p>fig (Figure): Figure area, coordinates range from 0 to 1 with 0
corresponding to the bottom and left edges of the figure (including
margins, label areas) and 1 corresponds to the top and right edges.
fig and dev coordinates will be identical if there is only 1 figure
area on the device (layout, mfrow, or mfcol has not been used).
</p>
<p>dev (Device): Device area, coordinates range from 0 to 1 with 0
corresponding to the bottom and left of the device region within the
outer margins and 1 is the top and right of the region withing the
outer margins.  If the outer margins are all set to 0 then tdev and
dev should be identical.
</p>
<p>tdev (Total Device): Total Device area, coordinates range from 0 to 1 with 0
corresponding to the bottom and left edges of the device (piece of
paper, window on screen) and 1 corresponds to the top and right edges.
</p>


<h3>Value</h3>

<p>A list with 5 components, each component is a list with vectors named
x and y.  The 5 sublists are:
</p>
<table>
<tr><td><code>usr</code></td>
<td>
<p>The coordinates of the input points in usr (User) coordinates.</p>
</td></tr>
<tr><td><code>plt</code></td>
<td>
<p>The coordinates of the input points in plt (Plot)
coordinates.</p>
</td></tr>
<tr><td><code>fig</code></td>
<td>
<p>The coordinates of the input points in fig (Figure)
coordinates.</p>
</td></tr>
<tr><td><code>dev</code></td>
<td>
<p>The coordinates of the input points in dev (Device)
coordinates.</p>
</td></tr>
<tr><td><code>tdev</code></td>
<td>
<p>The coordinates of the input points in tdev (Total Device)
coordinates.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p> You must provide both x and y, but one of them may be <code>NA</code>.
</p>
<p>This function is now depricated with the new functions
<code>grconvertX</code> and <code>grconvertY</code> in R version 2.7.0 and beyond.
These new functions use the correct coordinate system names and have
more coordinate systems available, you should start using them instead.
</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

 <p><code><a href="graphics.html#topic+par">par</a></code> specifically 'usr','plt', and 'fig'.  Also
'xpd' for plotting outside of the plotting region and 'mfrow' and
'mfcol' for multi figure plotting. <code><a href="#topic+subplot">subplot</a></code>,
<code>grconvertX</code> and <code>grconvertY</code> in R2.7.0 and later</p>


<h3>Examples</h3>

<pre><code class='language-R'>
old.par &lt;- par(no.readonly=TRUE)

par(mfrow=c(2,2),xpd=NA)

# generate some sample data
tmp.x &lt;- rnorm(25, 10, 2)
tmp.y &lt;- rnorm(25, 50, 10)
tmp.z &lt;- rnorm(25, 0, 1)

plot( tmp.x, tmp.y)

# draw a diagonal line across the plot area
tmp1 &lt;- cnvrt.coords( c(0,1), c(0,1), input='plt' )
lines(tmp1$usr, col='blue')

# draw a diagonal line accross figure region
tmp2 &lt;- cnvrt.coords( c(0,1), c(1,0), input='fig')
lines(tmp2$usr, col='red')

# save coordinate of point 1 and y value near top of plot for future plots
tmp.point1 &lt;- cnvrt.coords(tmp.x[1], tmp.y[1])
tmp.range1 &lt;- cnvrt.coords(NA, 0.98, input='plt')

# make a second plot and draw a line linking point 1 in each plot
plot(tmp.y, tmp.z)

tmp.point2 &lt;- cnvrt.coords( tmp.point1$dev, input='dev' )
arrows( tmp.y[1], tmp.z[1], tmp.point2$usr$x, tmp.point2$usr$y,
 col='green')

# draw another plot and add rectangle showing same range in 2 plots

plot(tmp.x, tmp.z)
tmp.range2 &lt;- cnvrt.coords(NA, 0.02, input='plt')
tmp.range3 &lt;- cnvrt.coords(NA, tmp.range1$dev$y, input='dev')
rect( 9, tmp.range2$usr$y, 11, tmp.range3$usr$y, border='yellow')

# put a label just to the right of the plot and
#  near the top of the figure region.
text( cnvrt.coords(1.05, NA, input='plt')$usr$x,
	cnvrt.coords(NA, 0.75, input='fig')$usr$y,
	"Label", adj=0)

par(mfrow=c(1,1))

## create a subplot within another plot (see also subplot)

plot(1:10, 1:10)

tmp &lt;- cnvrt.coords( c( 1, 4, 6, 9), c(6, 9, 1, 4) )

par(plt = c(tmp$dev$x[1:2], tmp$dev$y[1:2]), new=TRUE)
hist(rnorm(100))

par(fig = c(tmp$dev$x[3:4], tmp$dev$y[3:4]), new=TRUE)
hist(rnorm(100))

par(old.par)

</code></pre>

<hr>
<h2 id='coin.faces'> Designs for coin faces for use with plot.rgl.coin</h2><span id='topic+coin.faces'></span>

<h3>Description</h3>

<p>This is a list of matricies where each matrix represents a design for
drawing lines on the face of a coin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(coin.faces)</code></pre>


<h3>Format</h3>

<p>The format is:
List of 4
$ qh: num [1:57, 1:2] 0.387 0.443 0.515 0.606 0.666 ...
$ qt: num [1:62, 1:2] 0.862 0.873 0.875 0.857 0.797 ...
$ H : num [1:28, 1:2] 0.503 0.506 0.548 0.548 0.500 ...
$ T : num [1:18, 1:2] 0.506 0.520 0.569 0.626 0.626 ...
</p>


<h3>Details</h3>

<p>The current options are a capitol &quot;H&quot;, a capitol &quot;T&quot;, a design
representing George Washingtons head traced from the heads of a US
quarter, and a design representing an eagle traced from the tails of a
US quarter.
</p>
<p>The tracings here have pretty much exhausted my artistic ability, if
you can do better, please do, I will be happy to include it in future
versions.  It would also be nice to include some designs representing
faces of non-US coins, please submit your contributions (the design
should fit within a circle inscribed within the unit square).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
plot.rgl.coin(heads=coin.faces$H, tails=coin.faces$T)

## End(Not run)
</code></pre>

<hr>
<h2 id='col2grey'>Convert colors to grey/grayscale</h2><span id='topic+col2grey'></span><span id='topic+col2gray'></span>

<h3>Description</h3>

<p>Convert colors to grey/grayscale so that you can see how your plot
will look after photocopying or printing to a non-color printer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>col2grey(cols)
col2gray(cols)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="col2grey_+3A_cols">cols</code></td>
<td>
<p> Colors to convert.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>converts colors to greyscale using the formula grey=0.3*red +
0.59*green + 0.11*blue.  This allows you to see how your color plot
will approximately look when printed on a non-color printer or photocopied.
</p>


<h3>Value</h3>

<p>A vector of colors (greys) corresponding to the input colors.
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

 <p><code><a href="grDevices.html#topic+grey">grey</a></code>, <code><a href="grDevices.html#topic+col2rgb">col2rgb</a></code>, dichromat package </p>


<h3>Examples</h3>

<pre><code class='language-R'>par(mfcol=c(2,2))
tmp &lt;- 1:3
names(tmp) &lt;- c('red','green','blue')

barplot( tmp, col=c('red','green','blue') )
barplot( tmp, col=col2gray( c('red','green','blue') ) )

barplot( tmp, col=c('red','#008100','#3636ff') )
barplot( tmp, col=col2grey( c('red','#008100','#3636ff') ) )
</code></pre>

<hr>
<h2 id='cor.rect.plot'>
Plot a visualization of the correlation using colored rectangles
</h2><span id='topic+cor.rect.plot'></span>

<h3>Description</h3>

<p>This function creates a scatterplot of the data, then adds colored
rectangles between the points and the mean of x and y to represent the
idea of the correlation coefficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor.rect.plot(x, y, corr = TRUE, xlab = deparse(substitute(x)),
  ylab = deparse(substitute(y)), col = c("#ff000055", "#0000ff55"),
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cor.rect.plot_+3A_x">x</code></td>
<td>

<p>The <code>x</code> value or any object that can be interpreted by <code>xy.coords</code>
</p>
</td></tr>
<tr><td><code id="cor.rect.plot_+3A_y">y</code></td>
<td>

<p>The <code>y</code> value
</p>
</td></tr>
<tr><td><code id="cor.rect.plot_+3A_corr">corr</code></td>
<td>

<p>Should the standardized axes (right and top) show the values divided
by the standard deviation (TRUE, which shows correlation ideas) or not
(FALSE, shows covariance idea)
</p>
</td></tr>
<tr><td><code id="cor.rect.plot_+3A_xlab">xlab</code></td>
<td>

<p>The label for the <code>x</code> axis
</p>
</td></tr>
<tr><td><code id="cor.rect.plot_+3A_ylab">ylab</code></td>
<td>

<p>The label for the <code>y</code> axis
</p>
</td></tr>
<tr><td><code id="cor.rect.plot_+3A_col">col</code></td>
<td>

<p>A vector of length 2 with the colors to use for the fill of the
rectangles, the 1st value will be used for &quot;positive&quot; rectangles and the 2nd value will be used for the &quot;negative&quot; rectangles.
</p>
</td></tr>
<tr><td><code id="cor.rect.plot_+3A_...">...</code></td>
<td>

<p>Possible further arguments, currently ignored
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This will create a scatterplot of the data, draw refrence lines at
the mean of <code>x</code> and the mean of <code>y</code>, then draw rectangles
from the mean point to the data points.  The right and top axes will
show the centered (and possibly scaled if <code>corr=TRUE</code>) values.
</p>
<p>The idea is that the correlation/covariance is based on summing the
area of the &quot;positive&quot; rectangles and subtracting the sum of the areas
of the &quot;negative&quot; rectangles (then dividing by n-1).  If the positive
and negative areas are about the same then the correlation/covariance
is near 0, if there is more area in the positive rectangles then the
correlation/covariance will be positive.
</p>


<h3>Value</h3>

<p>This function returns an invisible NULL, it is run for its side effects.
</p>


<h3>Author(s)</h3>

<p>Greg Snow, <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cor">cor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## low correlation
x &lt;- rnorm(25)
y &lt;- rnorm(25)
cor(x,y)
cor.rect.plot(x,y)

## Positive correlation
x &lt;- rnorm(25)
y &lt;- x + rnorm(25,3, .5)
cor(x,y)
cor.rect.plot(x,y)

## negative correlation
x &lt;- rnorm(25)
y &lt;- rnorm(25,10,1.5) - x
cor(x,y)
cor.rect.plot(x,y)

## zero correlation but a definite relationship
x &lt;- -5:5
y &lt;- x^2
cor(x,y)
cor.rect.plot(x,y)
</code></pre>

<hr>
<h2 id='dice'>Simulate rolling dice </h2><span id='topic+dice'></span><span id='topic+plot.dice'></span><span id='topic+panel.dice'></span><span id='topic+prepanel.dice'></span>

<h3>Description</h3>

<p>Simulate and optionally plot rolls of dice.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dice(rolls = 1, ndice = 2, sides = 6, plot.it = FALSE, load = rep(1, sides))
## S3 method for class 'dice'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dice_+3A_rolls">rolls</code></td>
<td>
<p> Scalar, the number of times to roll the dice. </p>
</td></tr>
<tr><td><code id="dice_+3A_ndice">ndice</code></td>
<td>
<p> Scalar, the number of dice to roll each time. </p>
</td></tr>
<tr><td><code id="dice_+3A_sides">sides</code></td>
<td>
<p> Scalar, the number of sides per die. </p>
</td></tr>
<tr><td><code id="dice_+3A_plot.it">plot.it</code></td>
<td>
<p> Logical, Should the results be plotted. </p>
</td></tr>
<tr><td><code id="dice_+3A_load">load</code></td>
<td>
<p> Vector of length <code>sides</code>, how the dice should be
loaded.</p>
</td></tr>
<tr><td><code id="dice_+3A_x">x</code></td>
<td>
<p> Data frame, return value from <code>dice</code>. </p>
</td></tr>
<tr><td><code id="dice_+3A_...">...</code></td>
<td>
<p> Additional arguments passed to lattice plotting function. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simulates the rolling of dice.  By default it will roll 2 dice 1 time
and the dice will be fair.  Internally the <code>sample</code> function is
used and the load option is passed to sample.  <code>load</code> is not
required to sum to 1, but the elements will be divided by the sum of
all the values.
</p>


<h3>Value</h3>

<p>A data frame with <code>rolls</code> rows and <code>ndice</code> columns
representing the results from rolling the dice.
</p>
<p>If only 1 die is rolled, then the return value will be a vector.
</p>
<p>If <code>plot.it</code> is TRUE, then the return value will be invisible.
</p>


<h3>Note</h3>

<p> If the plot function is used or if <code>plot.it</code> is TRUE, then a
plot will be created on the current graphics device.</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

 <p><code><a href="base.html#topic+sample">sample</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 10 rolls of 4 fair dice
dice(10,4, plot.it=TRUE)

# or

plot(dice(10,4))

# or

tmp &lt;- dice(10,4)
plot(tmp)

# a loaded die
table(tmp &lt;- dice(100,1,plot.it=TRUE, load=6:1 ) )
colMeans(tmp)

# Efron's dice
ed &lt;- list( rep( c(4,0), c(4,2) ),
  rep(3,6), rep( c(6,2), c(2,4) ),
  rep( c(5,1), c(3,3) ) )

tmp &lt;- dice( 10000, ndice=4 )
ed.out &lt;- sapply(1:4, function(i) ed[[i]][ tmp[[i]] ] )

mean(ed.out[,1] &gt; ed.out[,2])
mean(ed.out[,2] &gt; ed.out[,3])
mean(ed.out[,3] &gt; ed.out[,4])
mean(ed.out[,4] &gt; ed.out[,1])


## redo De Mere's question

demere1 &lt;- dice(10000,4)
demere2 &lt;- dice(10000,24,sides=36)

mean(apply( demere1, 1, function(x) 6 %in% x ))

mean(apply( demere2, 1, function(x) 36 %in% x))

plot(demere1[1:10,])

## plot all possible combinations of 2 dice

plot.dice( expand.grid(1:6,1:6), layout=c(6,6) )
</code></pre>

<hr>
<h2 id='digits'>
Return the digits that make up an integer
</h2><span id='topic+digits'></span>

<h3>Description</h3>

<p>Takes an integer or vector of integers and returns a vector, list, or
matrix of the individual digits (decimal) that make up that number.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>digits(x, n = NULL, simplify = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="digits_+3A_x">x</code></td>
<td>

<p>An integer or vector of integers (if not integer, the fractional
part will be ignored)
</p>
</td></tr>
<tr><td><code id="digits_+3A_n">n</code></td>
<td>

<p>The number of digits to be returned, this can be used to place 0's
in front of smaller numbers.  If this is less than the number of
digits then the last <code>n</code> digits are returned.
</p>
</td></tr>
<tr><td><code id="digits_+3A_simplify">simplify</code></td>
<td>

<p>Should <code>sapply</code> simplify the list into a matrix
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function transforms an integer (or real ignoring the fractional
part) into the decimal digits that make of the decimal representation
of the number using modular mathematics rather than converting to
character, splitting the string, and converting back to numeric.
</p>


<h3>Value</h3>

<p>If <code>x</code> is of length 1 then a vector of the digits is returned.
</p>
<p>If <code>x</code> is a vector and <code>simplify</code> is <code>FALSE</code> then a list
of vectors is returned, one element for each element of <code>x</code>.
</p>
<p>If <code>x</code> is a vector and <code>simplify</code> is <code>TRUE</code> then a
matrix with 1 column for each element of <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic++25+25">%%</a></code>, <code><a href="base.html#topic++25+2F+25">%/%</a></code>, <code><a href="base.html#topic+strsplit">strsplit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
digits( 12345 )
digits( 567, n=5 )

x &lt;- c(1, 23, 456, 7890)

digits(x)
digits(x, simplify=TRUE)

</code></pre>

<hr>
<h2 id='dots'> Create a quick dotchart (histogram)</h2><span id='topic+dots'></span><span id='topic+dots2'></span>

<h3>Description</h3>

<p>Create a quick dotchart of 1 or 2 datasets.  These dotcharts are a poor
man's histogram, not the trellis dotplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dots(x,...)
dots2(x, y, colx = "green", coly = "blue", lab1 =
deparse(substitute(x)), lab2 = deparse(substitute(y)),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dots_+3A_x">x</code></td>
<td>
<p> Vector, data to be plotted (should be rounded). </p>
</td></tr>
<tr><td><code id="dots_+3A_y">y</code></td>
<td>
<p> Vector, second dataset to be plotted. </p>
</td></tr>
<tr><td><code id="dots_+3A_colx">colx</code></td>
<td>
<p> Color of points for <code>x</code>. </p>
</td></tr>
<tr><td><code id="dots_+3A_coly">coly</code></td>
<td>
<p> Color of points for <code>y</code>. </p>
</td></tr>
<tr><td><code id="dots_+3A_lab1">lab1</code></td>
<td>
<p> Label for <code>x</code>.</p>
</td></tr>
<tr><td><code id="dots_+3A_lab2">lab2</code></td>
<td>
<p> Label for <code>y</code>.</p>
</td></tr>
<tr><td><code id="dots_+3A_...">...</code></td>
<td>
<p> Additional arguments passed to plotting functions. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions create basic dotcharts that are quick &quot;back of the
envelope&quot; approximations to histograms.  Mainly intended for demonstration.
</p>


<h3>Value</h3>

<p>No meaninful value.  These functions are run for the side effect of
creating a plot.
</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

 <p><code><a href="lattice.html#topic+dotplot">dotplot</a></code> in the lattice package, <code><a href="graphics.html#topic+hist">hist</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
dots( round( rnorm(50, 10,3) ) )
dots2( round( rnorm(20, 10,3) ), round(rnorm(20,12,2)) )

</code></pre>

<hr>
<h2 id='dynIdentify'> Interacively place labels for points in a plot </h2><span id='topic+dynIdentify'></span><span id='topic+TkIdentify'></span>

<h3>Description</h3>

<p>These functions create a scatterplot of your points and place labels
for the points on them.  You can then use the mouse to click and drag
the labels to new positions with a line stretching between the point
and label.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dynIdentify(x, y, labels = seq_along(x),
  corners = cbind(c(-1, 0, 1, -1, 1, -1, 0, 1),
    c(1, 1, 1, 0, 0, -1, -1, -1)), ...)
TkIdentify(x, y, labels=seq_along(x), hscale=1.75, vscale=1.75,
  corners = cbind( c(-1,0,1,-1,1,-1,0,1), c(1,1,1,0,0,-1,-1,-1) ),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dynIdentify_+3A_x">x</code></td>
<td>
<p>x-values to plot </p>
</td></tr>
<tr><td><code id="dynIdentify_+3A_y">y</code></td>
<td>
<p>y-values to plot </p>
</td></tr>
<tr><td><code id="dynIdentify_+3A_labels">labels</code></td>
<td>
<p>Labels for the points, defaults to a sequence of integers </p>
</td></tr>
<tr><td><code id="dynIdentify_+3A_corners">corners</code></td>
<td>
<p> 2 column matrix of locations where the line can attach
to the label, see below</p>
</td></tr>
<tr><td><code id="dynIdentify_+3A_hscale">hscale</code>, <code id="dynIdentify_+3A_vscale">vscale</code></td>
<td>
<p>Scaling passed to tkrplot</p>
</td></tr>
<tr><td><code id="dynIdentify_+3A_...">...</code></td>
<td>
<p>Additional parameters passed to <code>plot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions create a scatterplot of the x and y points with the
labels (from the argument above) plotted on top.  You can then use the
mouse to click and drag the labels to new locations.  The Tk version
shows the labels being dragged, <code>dynIdentify</code> does not show the
labels being dragged, but the label will jump to the new location as
soon as you release the mouse button.
</p>
<p>The <code>corners</code> argument is a 2 column matrix that gives the
allowable points at which the line from the point can attach to the
label (so the line does not cover thelabel).  The first column
represents the x-coordinates and the 2nd column the y-coordinates.  A
1 represents the right/top of the label, A -1 is the left/bottom and a
0 is the center.  The default values allow attachments at the 4
corners and the centers of the 4 sides of the rectangle bounding the label.
</p>


<h3>Value</h3>

<p>A list of lists with the coordinates of the final positions of the
labels and the line ends.
</p>


<h3>Note</h3>

<p>The <code>dynIdentify</code> function only works on windows,
<code>TkIdentify</code> should work on any platform with tcltk.
</p>


<h3>Author(s)</h3>

<p> Greg Snow, <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+identify">identify</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()) {
  tmp &lt;- TkIdentify(state.x77[,'Frost'], state.x77[,'Murder'],
  state.abb)
     ### now move the labels

     ### recreate the graph on the current device
  plot( state.x77[,'Frost'], state.x77[,'Murder'],
        xlab='Frost', ylab='Frost')
  text( tmp$labels$x, tmp$labels$y, state.abb )
  segments( state.x77[,'Frost'], state.x77[,'Murder'],
            tmp$lineends$x, tmp$lineends$y )
}
</code></pre>

<hr>
<h2 id='evap'>
Data on soil evaporation.
</h2><span id='topic+evap'></span>

<h3>Description</h3>

<p>Data from 46 consecutive days on weather variables used to estimate
amount of evaporation from the soil. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(evap)</code></pre>


<h3>Format</h3>

<p>A data frame with 46 observations on the following 14 variables.
</p>

<dl>
<dt><code>Obs</code></dt><dd><p>Observation number</p>
</dd>
<dt><code>Month</code></dt><dd><p>Month (6-June, 7-July)</p>
</dd>
<dt><code>day</code></dt><dd><p>Day of the month</p>
</dd>
<dt><code>MaxST</code></dt><dd><p>Maximum Soil Temperature</p>
</dd>
<dt><code>MinST</code></dt><dd><p>Minimum Soil Temperature</p>
</dd>
<dt><code>AvST</code></dt><dd><p>Average (integrated) Soil Temperature</p>
</dd>
<dt><code>MaxAT</code></dt><dd><p>Maximum Air Temperature</p>
</dd>
<dt><code>MinAT</code></dt><dd><p>Minimum Air Temperature</p>
</dd>
<dt><code>AvAT</code></dt><dd><p>Average (integrated) Air Temperature</p>
</dd>
<dt><code>MaxH</code></dt><dd><p>Maximum Relative Humidity</p>
</dd>
<dt><code>MinH</code></dt><dd><p>Minimum Relative Humidity</p>
</dd>
<dt><code>AvH</code></dt><dd><p>Average (integrated) Relative Humidity</p>
</dd>
<dt><code>Wind</code></dt><dd><p>Total Wind</p>
</dd>
<dt><code>Evap</code></dt><dd><p>Total evoporation from the soil</p>
</dd>
</dl>



<h3>Details</h3>

<p>The idea of the data is to predict the amount of evaporation given the
other variables.  Note that the &quot;average&quot; values are scaled differently
from the others, this is more an area under the curve measure
representing the total/average value.
</p>
<p>This dataset was entered by hand from a low quality copy of the paper.
If you find any typos, please e-mail them to the package maintainer.
</p>


<h3>Source</h3>

<p>Freund, R.J. (1979) Multicollinearity etc., Some &quot;New&quot; Examples.
Proceedings of the Statistical Computing Section, *4*, 111-112.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(evap)
pairs(evap[,-c(1,2,3)], panel=panel.smooth)
## maybe str(evap) ; plot(evap) ...
</code></pre>

<hr>
<h2 id='faces'>    Chernoff Faces    </h2><span id='topic+faces'></span>

<h3>Description</h3>

<p>faces represent the rows of a data matrix by faces
</p>


<h3>Usage</h3>

<pre><code class='language-R'>faces(xy, which.row, fill = FALSE, nrow, ncol, scale = TRUE, byrow = FALSE, main, labels)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="faces_+3A_xy">xy</code></td>
<td>
   <p><code>xy</code> data matrix, rows represent individuals and columns attributes  </p>
</td></tr>
<tr><td><code id="faces_+3A_which.row">which.row</code></td>
<td>
<p>   defines a permutation of the rows of the input matrix   </p>
</td></tr>
<tr><td><code id="faces_+3A_fill">fill</code></td>
<td>
   <p><code>if(fill==TRUE)</code>, only the first <code>nc</code> attributes of the faces are
transformed, <code>nc</code> is the number of columns of <code>xy</code>   </p>
</td></tr>
<tr><td><code id="faces_+3A_nrow">nrow</code></td>
<td>
<p>   number of columns of faces on graphics device   </p>
</td></tr>
<tr><td><code id="faces_+3A_ncol">ncol</code></td>
<td>
<p>   number of rows of faces   </p>
</td></tr>
<tr><td><code id="faces_+3A_scale">scale</code></td>
<td>
   <p><code>if(scale==TRUE)</code>, attributes will be normalized   </p>
</td></tr>
<tr><td><code id="faces_+3A_byrow">byrow</code></td>
<td>
   <p><code>if(byrow==TRUE)</code>, <code>xy</code> will be transposed   </p>
</td></tr>
<tr><td><code id="faces_+3A_main">main</code></td>
<td>
<p>   title   </p>
</td></tr>
<tr><td><code id="faces_+3A_labels">labels</code></td>
<td>
<p>   character strings to use as names for the faces   </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The features paramters of this implementation are:
1-height of face,
2-width of face,
3-shape of face,
4-height of mouth,
5-width of mouth,
6-curve of smile,
7-height of eyes,
8-width of eyes,
9-height of hair,
10-width of hair,
11-styling of hair,
12-height of nose,
13-width of nose,
14-width of ears,
15-height of ears. For details look at the literate program of <code>faces</code>
</p>


<h3>Value</h3>

<p>a plot of faces is created on the graphics device,
no numerical results
</p>


<h3>Note</h3>

<p> version 12/2003   </p>


<h3>Author(s)</h3>

<p>   H. P. Wolf    </p>


<h3>References</h3>

<p>  Chernoff, H. (1973): The use of faces to represent statistiscal assoziation,
JASA, 68, pp 361&ndash;368.
The smooth curves are computed by an algorithm found in
Ralston, A. and Rabinowitz, P. (1985):
A first course in numerical analysis, McGraw-Hill, pp 76ff.
<a href="http://www.uni-bielefeld.de/fakultaeten/wirtschaftswissenschaften">http://www.uni-bielefeld.de/fakultaeten/wirtschaftswissenschaften</a> : S/R - functions : faces
</p>


<h3>See Also</h3>

<p>   &mdash;    </p>


<h3>Examples</h3>

<pre><code class='language-R'>faces(rbind(1:3,5:3,3:5,5:7))

data(longley)
faces(longley[1:9,])

set.seed(17)
faces(matrix(sample(1:1000,128,),16,8),main="random faces")

if(interactive()){
  tke1 &lt;- rep( list(list('slider',from=0,to=1,init=0.5,resolution=0.1)), 15)
  names(tke1) &lt;- c('FaceHeight','FaceWidth','FaceShape','MouthHeight',
	'MouthWidth','SmileCurve','EyesHeight','EyesWidth','HairHeight',
	'HairWidth','HairStyle','NoseHeight','NoseWidth','EarWidth','EarHeight')
  tkfun1 &lt;- function(...){
	tmpmat &lt;- rbind(Min=0,Adjust=unlist(list(...)),Max=1)
	faces(tmpmat, scale=FALSE)
  }

  tkexamp( tkfun1, list(tke1), plotloc='left', hscale=2, vscale=2 )
}


</code></pre>

<hr>
<h2 id='faces2'> Chernoff Faces </h2><span id='topic+faces2'></span><span id='topic+face2.plot'></span>

<h3>Description</h3>

<p>Plot Chernoff Faces of the dataset, rows represent
subjects/observations, columns represent variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>faces2(mat, which = 1:ncol(mat), labels = rownames(mat),
  nrows = ceiling(nrow(mat)/ncols), ncols = ceiling(sqrt(nrow(mat))),
  byrow = TRUE, scale = c("columns", "all", "center", "none"),
  fill = c(0.5, 0.5, 1, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5,
           0.5, 0.5, 0.5, 0.5, 1, 0.5), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="faces2_+3A_mat">mat</code></td>
<td>
<p> Matrix containing the data to plot. </p>
</td></tr>
<tr><td><code id="faces2_+3A_which">which</code></td>
<td>
<p> Which columns correspond to which features (see details). </p>
</td></tr>
<tr><td><code id="faces2_+3A_labels">labels</code></td>
<td>
<p> Labels for the individual faces </p>
</td></tr>
<tr><td><code id="faces2_+3A_nrows">nrows</code></td>
<td>
<p> Number of rows in the graphical layout </p>
</td></tr>
<tr><td><code id="faces2_+3A_ncols">ncols</code></td>
<td>
<p> Number of columns in the graphical layout </p>
</td></tr>
<tr><td><code id="faces2_+3A_byrow">byrow</code></td>
<td>
<p> Logical, should the faces be drawn rowwise or columnwise.
</p>
</td></tr>
<tr><td><code id="faces2_+3A_scale">scale</code></td>
<td>
<p> Character, how should the data be scaled. </p>
</td></tr>
<tr><td><code id="faces2_+3A_fill">fill</code></td>
<td>
<p> What value to use for features not assocaiated with a
column of data. </p>
</td></tr>
<tr><td><code id="faces2_+3A_...">...</code></td>
<td>
<p> Additional arguments passed on to plotting functions. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The features are:
1  Width of center
2  Top vs. Bottom width (height of split)
3  Height of Face
4  Width of top half of face
5  Width of bottom half of face
6  Length of Nose
7  Height of Mouth
8  Curvature of Mouth (abs &lt; 9)
9  Width of Mouth
10 Height of Eyes
11 Distance between Eyes (.5-.9)
12 Angle of Eyes/Eyebrows
13 Circle/Ellipse of Eyes
14 Size of Eyes
15 Position Left/Right of Eyeballs/Eyebrows
16 Height of Eyebrows
17 Angle of Eyebrows
18 Width of Eyebrows
</p>
<p>The face plotting routine needs the data values to be between 0 and 1
(inclusive).  The <code>scale</code> option controls how scaling will be
done on <code>mat</code>:  &quot;columns&quot; scales each column to range from 0 to
1, &quot;all&quot; scales the entire dataset to vary from 0 to 1, &quot;center&quot;
scales each column so that the mean of the column becomes 0.5 and all
other values are between 0 and 1, and &quot;none&quot; does no scaling assuming
that the data has already been scaled.
</p>


<h3>Value</h3>

<p>This function is run for its side effect of plotting and does not
return anything.
</p>


<h3>Note</h3>

<p> If you choose to not scale the data and any data values are
outside of the 0 to 1 range, then strange things may happen.
</p>
<p>This function is based on code found on the internet, the good things
come from there, any problems are likely due to my (Greg's) tweaking.
</p>


<h3>Author(s)</h3>

<p> Original code by  ; current implementation by Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>References</h3>

<p> Chernoff, H. (1973): The use of faces to represent statistiscal assoziation,
JASA, 68, pp 361&ndash;368. </p>


<h3>See Also</h3>

<p><code><a href="#topic+faces">faces</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  faces2(matrix( runif(18*10), nrow=10), main='Random Faces')

if(interactive()){
  tke2 &lt;- rep( list(list('slider',from=0,to=1,init=0.5,resolution=0.1)), 18)
  names(tke2) &lt;- c('CenterWidth','TopBottomWidth','FaceHeight','TopWidth',
	'BottomWidth','NoseLength','MouthHeight','MouthCurve','MouthWidth',
	'EyesHeight','EyesBetween','EyeAngle','EyeShape','EyeSize','EyeballPos',
	'EyebrowHeight','EyebrowAngle','EyebrowWidth')
  tkfun2 &lt;- function(...){
	tmpmat &lt;- rbind(Min=0,Adjust=unlist(list(...)),Max=1)
	faces2(tmpmat, scale='none')
  }

  tkexamp( tkfun2, list(tke2), plotloc='left', hscale=2, vscale=2 )
}
</code></pre>

<hr>
<h2 id='fagan.plot'>Create a Fagan plot to demonstrate Bayes Theorem and screening
tests</h2><span id='topic+fagan.plot'></span><span id='topic+plotFagan'></span><span id='topic+plotFagan2'></span><span id='topic+plotFagan.old'></span><span id='topic+plotFagan2.old'></span>

<h3>Description</h3>

<p>These functions create a plot showing the relationship between the
prior probability, the LR (combination of sensitivity and
specificity), and the posterior probability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fagan.plot(probs.pre.test, LR, test.result="+")
plotFagan(hscale=1.5, vscale=1.5, wait=FALSE)
plotFagan2(hscale=1.5, vscale=1.5, wait=FALSE)
plotFagan.old()
plotFagan2.old()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fagan.plot_+3A_probs.pre.test">probs.pre.test</code></td>
<td>
<p> The prior probability </p>
</td></tr>
<tr><td><code id="fagan.plot_+3A_lr">LR</code></td>
<td>
<p> the likelihood ratio (sensitivity/(1-specificity))</p>
</td></tr>
<tr><td><code id="fagan.plot_+3A_test.result">test.result</code></td>
<td>
<p>either '+' or '-' indicating whether you want the
probability of the event or of not seeing the event</p>
</td></tr>
<tr><td><code id="fagan.plot_+3A_hscale">hscale</code></td>
<td>
<p>Horizontal scale, passed to <code>tkrplot</code></p>
</td></tr>
<tr><td><code id="fagan.plot_+3A_vscale">vscale</code></td>
<td>
<p>Vertical scale, passed to <code>tkrplot</code></p>
</td></tr>
<tr><td><code id="fagan.plot_+3A_wait">wait</code></td>
<td>
<p>Should the R session wait for the window to close</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When Bayes theorem is expressed in terms of log-odds it turns out that
the posterior log-odds are a linear function of the prior log-odds
and the log likelihood ratio.  These functions plot an axis on the left
with the prior log-odds, an axis in the middle representing the log
likelihood ratio and an axis on the right representing the posterior
log-odds.  A line is then drawn from the prior probability on the left
through the LR in the center and extended to the posterior probability
on the right.  The <code>fagan.plot</code> creates the plot based on input
to the function.  The <code>plotFagan</code> and <code>plotFagan2</code>
functions set up Tk windows with sliders representing the possible
inputs and show how the plot and the posterior probability changes
when you adjust the inputs.  The <code>plotFagan</code> function creates
sliders for the prior probability and the LR, while the
<code>plotFagan2</code> function replaces the LR slider with 2 sliders for
the sensitivity and specificity.
</p>
<p>More detail on the plots and the math behind them can be found at the
websites below.
</p>


<h3>Value</h3>

<p> The old functions are run for their side effects and do not return
a meaningful value.  If <code>wait</code> is FALSE then NULL is returned, if
<code>wait</code> is TRUE, then a list with the current values is returned.</p>


<h3>Author(s)</h3>

<p> Guazzetti Stefano and Greg Snow
<a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>References</h3>

<p>Fagan TJ. Nomogram for Bayes theorem. N Engl J Med 1975;293(5):257-61.
<a href="https://ebm.bmj.com/content/6/6/164.full">https://ebm.bmj.com/content/6/6/164.full</a>
</p>


<h3>See Also</h3>

 <p><code>slider</code></p>


<h3>Examples</h3>

<pre><code class='language-R'> fagan.plot(0.8, 2)

 fagan.plot(0.8, 0.95/(1-0.90) )

if(interactive()) {
 plotFagan()

 plotFagan2()
}
</code></pre>

<hr>
<h2 id='gp.open'>Alpha version functions to send plotting commands to GnuPlot</h2><span id='topic+gp.open'></span><span id='topic+gp.close'></span><span id='topic+gp.send'></span><span id='topic+gp.plot'></span><span id='topic+gp.splot'></span>

<h3>Description</h3>

<p>These functions allow you to open a connection to a gnuplot
process, send data and possibly other information to gnuplot for it to
plot, then close gnuplot and clean up temporary files and variables.
These functions are alpha level at best, use at your own risk.</p>


<h3>Usage</h3>

<pre><code class='language-R'>gp.open(where='c:/progra~1/GnuPlot/bin/pgnuplot.exe')
gp.close(pipe=gpenv$gp)
gp.send(cmd='replot',pipe=gpenv$gp)
gp.plot(x,y,type='p',add=FALSE, title=deparse(substitute(y)),pipe=gpenv$gp)
gp.splot(x,y,z, add=FALSE, title=deparse(substitute(z)), pipe=gpenv$gp,
  datafile=tempfile())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gp.open_+3A_where">where</code></td>
<td>
<p>Path to GnuPlot Executable</p>
</td></tr>
<tr><td><code id="gp.open_+3A_pipe">pipe</code></td>
<td>
<p>The pipe object connected to GnuPlot (returned from
<code>gp.open</code>), warning: changing this from the default will
probably break things</p>
</td></tr>
<tr><td><code id="gp.open_+3A_cmd">cmd</code></td>
<td>
<p>Text string, the command to be sent verbatim to the GnuPlot
process</p>
</td></tr>
<tr><td><code id="gp.open_+3A_x">x</code></td>
<td>
<p>The <code>x</code> coordinates to plot</p>
</td></tr>
<tr><td><code id="gp.open_+3A_y">y</code></td>
<td>
<p>the <code>y</code> coordinates to plot</p>
</td></tr>
<tr><td><code id="gp.open_+3A_z">z</code></td>
<td>
<p>the <code>z</code> coordinates to splot</p>
</td></tr>
<tr><td><code id="gp.open_+3A_type">type</code></td>
<td>
<p>Either 'p' or 'l' for plotting points or lines</p>
</td></tr>
<tr><td><code id="gp.open_+3A_add">add</code></td>
<td>
<p>Logical, should the data be added to the existing plot or
start a new plot</p>
</td></tr>
<tr><td><code id="gp.open_+3A_title">title</code></td>
<td>
<p>The title or legend entry</p>
</td></tr>
<tr><td><code id="gp.open_+3A_datafile">datafile</code></td>
<td>
<p>The file to store the data in for transfer to gnuplot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions provide a basic interface to the GnuPlot program (you
must have GnuPlot installed (separate install)), <code>gp.open</code> runs
GnuPlot and establishes a pipe connection, <code>gp.close</code> sends a
quite command to gnuplot and cleans up temporary variables and files,
<code>gp.send</code> sends a command to the GnuPlot process verbatim, and
<code>gp.plot</code> sends data and commands to the process to create a
standard scatterplot or line plot.
</p>


<h3>Value</h3>

<p><code>gp.open</code> returns and invisible copy of the pipe connection
object (to pass to other functions, but don't do this because it
doesn't work right yet).
</p>
<p>The other 3 functions don't return anything meaningful.  All functions
are run for their side effects.
</p>


<h3>Note</h3>

<p>These functions create some temporary files and 2 temporary global
variables (.gp and .gp.tempfiles), running <code>gp.close</code> will clean
these up (so use it).
</p>
<p>These functions are still alpha level.
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>References</h3>

<p><a href="http://www.gnuplot.info/">http://www.gnuplot.info/</a>
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'> ## Not run: 

x &lt;- 1:10
y &lt;- 3-2*x+x*x+rnorm(10)

gp.open()
gp.plot(x,y)
gp.send('replot 3-2*x+x**2')

tmp &lt;- expand.grid(x=1:10, y=1:10)
tmp &lt;- transform(tmp, z=(x-5)*(y-3))
gp.splot(tmp$x, tmp$y, tmp$z)

gp.close()
 
## End(Not run)
</code></pre>

<hr>
<h2 id='hpd'>Compute Highest Posterior Density Intervals</h2><span id='topic+hpd'></span><span id='topic+emp.hpd'></span>

<h3>Description</h3>

<p>Compute the Highest Posterior Density Interval (HPD) from an inverse
density function (hpd) or a vector of realizations of the distribution
(emp.hpd).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hpd(posterior.icdf, conf=0.95, tol=0.00000001,...)

emp.hpd(x, conf=0.95, lower, upper)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hpd_+3A_posterior.icdf">posterior.icdf</code></td>
<td>
<p> Function, the inverse cdf of the posterior
distribution (usually a function whose name starts with 'q').</p>
</td></tr>
<tr><td><code id="hpd_+3A_x">x</code></td>
<td>
<p> A vector of realizations from the posterior distribution.</p>
</td></tr>
<tr><td><code id="hpd_+3A_conf">conf</code></td>
<td>
<p> Scalar, the credible level desired. </p>
</td></tr>
<tr><td><code id="hpd_+3A_tol">tol</code></td>
<td>
<p> Scalar, the tolerance for <code>optimize</code>.</p>
</td></tr>
<tr><td><code id="hpd_+3A_...">...</code></td>
<td>
<p>Additional arguments to <code>posterior.icdf</code>.</p>
</td></tr>
<tr><td><code id="hpd_+3A_lower">lower</code></td>
<td>
<p>Optional lower bound on support of x.</p>
</td></tr>
<tr><td><code id="hpd_+3A_upper">upper</code></td>
<td>
<p>Optional upper bound on support of x.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions compute the highest posterior density intervals
(sometimes called minimum length confidence intervals) for a Bayesian
posterior distribution.  The <code>hpd</code> function is used when you have
a function representing the inverse cdf (the common case with
conjugate families).  The <code>emp.hpd</code> function is used when you
have realizations of the posterior (when you have results from an MCMC
run).
</p>


<h3>Value</h3>

<p>A vector of length 2 with the lower and upper limits of the interval.
</p>


<h3>Note</h3>

<p>These functions assume that the posterior distribution is
unimodal, they compute only 1 interval, not the set of intervals that
are appropriate for multimodal distributions.</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p><code>hdr</code> in the hdrcde package.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
hpd(qbeta, shape1=50, shape2=250)

tmp &lt;- rbeta(10000, 50, 250)
emp.hpd(tmp)

</code></pre>

<hr>
<h2 id='HWidentify'> Show label for point being Hovered over. </h2><span id='topic+HWidentify'></span><span id='topic+HTKidentify'></span>

<h3>Description</h3>

<p>These functions create a scatterplot then you Hover the mouse pointer
over a point in the plot and it will show an id label for that point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HWidentify(x, y, label = seq_along(x), lab.col="darkgreen",
pt.col="red", adj=c(0,0), clean=TRUE, xlab = deparse(substitute(x)),
ylab = deparse(substitute(y)), ...)
HTKidentify(x, y, label = seq_along(x), lab.col="darkgreen",
pt.col="red", adj=c(0,0), xlab = deparse(substitute(x)),
ylab = deparse(substitute(y)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HWidentify_+3A_x">x</code></td>
<td>
<p> x-coordinates to plot </p>
</td></tr>
<tr><td><code id="HWidentify_+3A_y">y</code></td>
<td>
<p> y-coordinates to plot</p>
</td></tr>
<tr><td><code id="HWidentify_+3A_label">label</code></td>
<td>
<p> Labels to show for each point </p>
</td></tr>
<tr><td><code id="HWidentify_+3A_lab.col">lab.col</code></td>
<td>
<p>The color to plot the labels</p>
</td></tr>
<tr><td><code id="HWidentify_+3A_pt.col">pt.col</code></td>
<td>
<p>The color of the highlighting point</p>
</td></tr>
<tr><td><code id="HWidentify_+3A_adj">adj</code></td>
<td>
<p>The adjustment of the labels relative to the cursor point.
The default places the label so that its bottom left corner is at
the curser, values below 0 or greater than 1 will move the label to
not touch the cursor.</p>
</td></tr>
<tr><td><code id="HWidentify_+3A_clean">clean</code></td>
<td>
<p>Logical value, should any labels on the plot be removed
at the end of the plotting.</p>
</td></tr>
<tr><td><code id="HWidentify_+3A_xlab">xlab</code></td>
<td>
<p> Label for x-axis </p>
</td></tr>
<tr><td><code id="HWidentify_+3A_ylab">ylab</code></td>
<td>
<p> Label for y-axis</p>
</td></tr>
<tr><td><code id="HWidentify_+3A_...">...</code></td>
<td>
<p>additional arguments passed through to plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an alternative to the <code>identify</code> function.  The label
only shows up for the point currently closest to the mouse pointer.
When the mouse pointer moves closer to a different point, the label
changes to the one for the new point.  The currently labeled point is
also highlighted.  HWidentify only works on windows, HTKidentify
requires the tkrplot package.
</p>


<h3>Value</h3>

<p>These functions are run for their side effects, nothing meaningful is returned.
</p>


<h3>Author(s)</h3>

<p>Greg Snow, <a href="mailto:538280@gmail.com">538280@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+identify">identify</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if( interactive() ){
  tmpx &lt;- runif(25)
  tmpy &lt;- rnorm(25)
  HTKidentify(tmpx,tmpy, LETTERS[1:25], pch=letters)
}
</code></pre>

<hr>
<h2 id='lattice.demo'> Interactively explore the conditioned panels in lattice plots. </h2><span id='topic+lattice.demo'></span>

<h3>Description</h3>

<p>Plot 1 panel from an xyplot, and optionally a 3d graph highligting the
shown points, then allow you to interactively set the conditioning set
of data to see the effects and help you better understand how xyplot works.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lattice.demo(x, y, z, show3d = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lattice.demo_+3A_x">x</code></td>
<td>
<p> The x variable to plot (numeric). </p>
</td></tr>
<tr><td><code id="lattice.demo_+3A_y">y</code></td>
<td>
<p> The y variable to plot (numeric). </p>
</td></tr>
<tr><td><code id="lattice.demo_+3A_z">z</code></td>
<td>
<p> The variable to condition on (numeric). </p>
</td></tr>
<tr><td><code id="lattice.demo_+3A_show3d">show3d</code></td>
<td>
<p> Logical, should a 3D cloud be shown as well.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is intended to for demonstration purposes to help
understand what is happening in an <code>xyplot</code> (lattice).  When you
run the demo it will create a single panel from a conditioned
<code>xyplot</code> and optionally a 3D cloud with the points included in
the panel highlighted.  The function then opens a tcl/tk dialog box
that allows you to choose which points are included in the panel
(based on the conditioning variable).  You can choose the center and
width of the shingle displayed and the graph will update to show the
new selection.
</p>
<p>The intent for this function is for a teacher to show a class how
lattice graphics take slices of a 3d plot and show each slice
seperately.  Students could then work through some examples on their
own to better understand what functions like <code>xyplot</code> are doing
automatically. 
</p>


<h3>Value</h3>

<p>No meaningful return value, this function is run for the side effects.
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p><code>xyplot</code> in lattice package</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if(interactive()){
require(stats)
lattice.demo(quakes$long, quakes$lat, quakes$depth)
}

</code></pre>

<hr>
<h2 id='ldsgrowth'>
Growth of The Church of Jesus Christ of Latter-day Saints.
</h2><span id='topic+ldsgrowth'></span>

<h3>Description</h3>

<p>Data on the Growth of The Church of Jesus Christ of Latter-day Saints
(commonly known as the Mormon church (<a href="https://www.churchofjesuschrist.org/comeuntochrist">https://www.churchofjesuschrist.org/comeuntochrist</a>)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ldsgrowth)</code></pre>


<h3>Format</h3>

<p>A data frame with 179 observations on the following 6 variables.
</p>

<dl>
<dt><code>Year</code></dt><dd><p>Year from 1830 to 2008</p>
</dd>
<dt><code>Members</code></dt><dd><p>Total number of Members</p>
</dd>
<dt><code>Wards</code></dt><dd><p>Number of Wards and Branches (individual congregations)</p>
</dd>
<dt><code>Stakes</code></dt><dd><p>Number of Stakes (a group of wards/branches)</p>
</dd>
<dt><code>Missions</code></dt><dd><p>Number of Missions</p>
</dd>
<dt><code>Missionaries</code></dt><dd><p>Number of Missionaries called</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data comes from the church records and are as of December 31st of
each year.
</p>
<p>The church was officially organized on 6 April 1830 (hence the starting
year of 1830).
</p>
<p>The <code>Missionaries</code> column represents the number of missionaries
called each year.  Missionaries generally serve for about 2 years.
</p>


<h3>Source</h3>

<p>Deseret News 2010 Church News Almanac
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ldsgrowth)
with(ldsgrowth, plot(Year, log(Members)))
</code></pre>

<hr>
<h2 id='loess.demo'> Demonstrate the internals of loess curve fits </h2><span id='topic+loess.demo'></span>

<h3>Description</h3>

<p>Creates a scatterplot with a loess fit, then interactively shows the
window and case weights used to create the curve at the selected value
of <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loess.demo(x, y, span = 2/3, degree = 1, nearest = FALSE,
  xlim = numeric(0), ylim = numeric(0), verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loess.demo_+3A_x">x</code></td>
<td>
<p> The <code>x</code> coordinates to be plotted. </p>
</td></tr>
<tr><td><code id="loess.demo_+3A_y">y</code></td>
<td>
<p> The <code>y</code> coordinates to be plotted. </p>
</td></tr>
<tr><td><code id="loess.demo_+3A_span">span</code></td>
<td>
<p> The relative width of the window, passed on to <code>loess</code>. </p>
</td></tr>
<tr><td><code id="loess.demo_+3A_degree">degree</code></td>
<td>
<p> Degree of polynomial to use (0, 1, or 2), passed on to <code>loess</code>. </p>
</td></tr>
<tr><td><code id="loess.demo_+3A_nearest">nearest</code></td>
<td>
<p> Logical, should predictions be made at the point where
you clicked (FALSE), or at the nearest x value of the data to where
you clicked (TRUE).</p>
</td></tr>
<tr><td><code id="loess.demo_+3A_xlim">xlim</code></td>
<td>
<p> Limits of the Horizonal axis. </p>
</td></tr>
<tr><td><code id="loess.demo_+3A_ylim">ylim</code></td>
<td>
<p> Limits of the Vertical axis. </p>
</td></tr>
<tr><td><code id="loess.demo_+3A_verbose">verbose</code></td>
<td>
<p> If true then print the x coordinate being predicted. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function demonstrates the underlying calculations of loess
curves.
</p>
<p>Given <code>x</code> and <code>y</code> vectors it will create a scatterplot and
add 2 loess fit lines (one using straight loess smooth with linear
interpolation and one that does a spline interpolation of the loess
fit).
</p>
<p>The function then waits for the user to click on the plot.  The
function then shows the window of points (centered at the <code>x</code>
value clicked on) used in the weighting for predicting that point and
shows a circle around each point in the window where the area of the
circle is proportional to the weight of that point in the linear fit.
The function also shows the linear (or quadratic) fit used to predict
at the selected point.
</p>
<p>The basic steps of the loess algorithm (as demonstrated by the
function)  is that to predict the y-value for a given x-value the
computer:
</p>
<p>1. Find all the points within a window around the x-value (the width
of the window is based on the parameter <code>span</code>).
2. Weight the points in the window with points nearest the x-value
having the highest weight.
3. Fit a weighted linear (quadratic) line to the points in the
window.
4. Use the y-value of the fitted line (curve) at the x-value to give
loess prediction at that x-value.
</p>
<p>Clicking on another point in the graph will replot with the new
situation.
</p>
<p>Right click and select 'stop' to end the demonstration.
</p>


<h3>Value</h3>

<p>This function does not return anything, it is run purely for its side
effects.
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+loess">loess</a></code>, <code><a href="graphics.html#topic+locator">locator</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
if(interactive()){
data(ethanol, package='lattice')
attach(ethanol)
loess.demo(E, NOx)
# now click a few places, right click to end
loess.demo(E, NOx, span=1.5)
loess.demo(E, NOx, span=0.25)
loess.demo(E, NOx, degree=0)
loess.demo(E, NOx, degree=2)
detach()
}
</code></pre>

<hr>
<h2 id='mle.demo'> Demonstrate the basic concept of Maximum Likelihood Estimation </h2><span id='topic+mle.demo'></span>

<h3>Description</h3>

<p>This function graphically shows log likelihoods for a set of data and
the normal distribution and allows you to interactively change the
parameter estimates to see the effect on the log likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mle.demo(x = rnorm(10, 10, 2), start.mean = mean(x) - start.sd,
  start.sd = 1.2 * sqrt(var(x)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mle.demo_+3A_x">x</code></td>
<td>
<p> A vector of data (presumably from a normal distribution). </p>
</td></tr>
<tr><td><code id="mle.demo_+3A_start.mean">start.mean</code></td>
<td>
<p> The initial value for estimating the mean. </p>
</td></tr>
<tr><td><code id="mle.demo_+3A_start.sd">start.sd</code></td>
<td>
<p> The initial value for estimating the standard deviation. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function creates a plot with 3 panels:  the top panel shows a
normal curve based on the current values of the mean and standard
deviation along with a vertical line for each point in <code>x</code> (the
product of the heights of these lines is the likelihood, the sum of
the logs of their heights is the log likelihood).
</p>
<p>The lower 2 plots show the profiles of the mean and standard
deviation. The y-axis is the likelihoods of the parameters tried so
far, and the x-axes are the mean and standard deviation tried.  The
point corresponding to the current parameter estimates will be solid
red.
</p>
<p>A Tk slider box is also created that allows you to change the current
estimates of the mean and standard deviation to show the effect on the
log likelihood and find the maximum likelihood estimate.
</p>


<h3>Value</h3>

<p>This function is run for its side effects and returns NULL.
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

 <p><code>fitdistr</code> in package MASS, <code>mle</code> in
package stats4, <code><a href="#topic+slider">slider</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
if(interactive()){
mle.demo()

m &lt;- runif(1, 50,100)
s &lt;- runif(1, 1, 10)
x &lt;- rnorm(15, m, s)

mm &lt;- mean(x)
ss &lt;- sqrt(var(x))
ss2 &lt;- sqrt(var(x)*11/12)
mle.demo(x)
# now find the mle from the graph and compare it to mm, ss, ss2, m, and s
}
</code></pre>

<hr>
<h2 id='ms.polygram'>Symbol functions/data to be passed as symb argument to
my.symbols</h2><span id='topic+ms.polygram'></span><span id='topic+ms.polygon'></span><span id='topic+ms.filled.polygon'></span><span id='topic+ms.male'></span><span id='topic+ms.female'></span><span id='topic+ms.arrows'></span><span id='topic+ms.sunflowers'></span><span id='topic+ms.image'></span><span id='topic+ms.face'></span>

<h3>Description</h3>

<p>These functions/data matricies are examples of what can be passed as
the <code>symb</code> argument in the <code>my.symbols</code> function.  They are
provided both to be used for some common symbols and as examples of
what can be passed as the <code>symb</code> argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ms.polygram(n, r=1, adj=pi/2, ...)
ms.polygon(n, r=1, adj=pi/2, ...)
ms.filled.polygon(n, r=1, adj=pi/2, fg=par('fg'), bg=par('fg'), ... )
ms.male
ms.female
ms.arrows(angle, r=1, adj=0.5, length=0.1, ...)
ms.sunflowers(n,r=0.3,adj=pi/2, ...)
ms.image(img, transpose=TRUE, ...)
ms.face(features, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ms.polygram_+3A_n">n</code></td>
<td>
<p>The number of sides for polygons and polygrams, the number of
petals(lines) for sunflowers.</p>
</td></tr>
<tr><td><code id="ms.polygram_+3A_r">r</code></td>
<td>
<p>The radius of the enclosing circle for polygons and polygrams
(1 means that it will pretty much fill the bounding square).  For
sunflowers this is the radius (relative to the inches square) of the
inner circle.  For arrows this controls the length of the arrow, a
value of 2 means the length of the arrow will be the same as inches
(but it may then stick out of the box if adj != 1).</p>
</td></tr>
<tr><td><code id="ms.polygram_+3A_adj">adj</code></td>
<td>
<p>For polygons, polygrams, and sunflowers this is the angle
in radians that the first corner/point will be.  The default puts a
corner/point straight up, this can be used to rotate the symbols.  For
arrows, this determines the positioning of the arrow, a value of 0
means the arrow will start at the x,y point and point away from it,
0.5 means the arrow will be centered at x,y and 1 means that the arrow
will end (point at) x,y.</p>
</td></tr>
<tr><td><code id="ms.polygram_+3A_fg">fg</code>, <code id="ms.polygram_+3A_bg">bg</code></td>
<td>
<p>Colors for the filled polygons.  <code>fg</code> is the color
of the line around the polygon and <code>bg</code> is the fill color, see
<code><a href="graphics.html#topic+polygon">polygon</a></code>.</p>
</td></tr>
<tr><td><code id="ms.polygram_+3A_angle">angle</code></td>
<td>
<p>The angle in radians that the arrow will point.</p>
</td></tr>
<tr><td><code id="ms.polygram_+3A_length">length</code></td>
<td>
<p>The length of the arrow head (see
<code><a href="graphics.html#topic+arrows">arrows</a></code>).</p>
</td></tr>
<tr><td><code id="ms.polygram_+3A_img">img</code></td>
<td>
<p> A 3 dimensional array representing an image such as
produced by the png or EBImage packages.</p>
</td></tr>
<tr><td><code id="ms.polygram_+3A_transpose">transpose</code></td>
<td>
<p>Should the image be tranposed, use TRUE for images
imported using package png and FALSE for images imported using
EBImage.</p>
</td></tr>
<tr><td><code id="ms.polygram_+3A_features">features</code></td>
<td>
<p>A list of data representing the features of
the faces, each element represents 1 face and the values need to be
scaled between 0 and 1, see <code><a href="#topic+faces">faces</a></code> for details on which
elements match which features.</p>
</td></tr>
<tr><td><code id="ms.polygram_+3A_...">...</code></td>
<td>
<p>additional parameters that will be passed to plotting
functions or be ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions/matricies can be passed as the <code>symb</code> argument to
the <code>my.symbols</code> function.  The represent examples that can be
used to create your own symbols or may be used directly.
</p>


<h3>Value</h3>

<p>These functions either return a 2 column matrix of points to be passed
to <code>lines</code> or <code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+my.symbols">my.symbols</a></code>, <code><a href="graphics.html#topic+polygon">polygon</a></code>,
<code><a href="graphics.html#topic+arrows">arrows</a></code>, <code><a href="graphics.html#topic+lines">lines</a></code>, <code><a href="#topic+faces">faces</a></code>, also see
<code><a href="graphics.html#topic+rasterImage">rasterImage</a></code> for an alternative to ms.image
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
plot(1:10,1:10)
my.symbols(1:10,1:10, ms.polygram, n=1:10, r=seq(0.5,1,length.out=10),
inches=0.3)

my.symbols(1:10,1:10, ms.polygon, n=1:10, add=FALSE, inches=0.3)

my.symbols(1:5, 5:1, ms.filled.polygon, add=FALSE, n=3:7, fg='green',
  bg=c('red','blue','yellow','black','white'), inches=0.3 )

my.symbols( 1:10, 1:10, ms.female, inches=0.3, add=FALSE)
my.symbols( 1:10, 10:1, ms.male, inches=0.3, add=TRUE)

plot(1:10, 1:10)
my.symbols(1:10, 1:10, ms.arrows, angle=runif(10)*2*pi, inches=0.5,
adj=seq(0,1,length.out=10), symb.plots=TRUE)

my.symbols(1:10, 1:10, ms.sunflowers, n=1:10, inches=0.3, add=FALSE)

if( require(png) ) {
  img &lt;- readPNG(system.file("img", "Rlogo.png", package="png"))

  my.symbols( runif(10), runif(10), ms.image, MoreArgs=list(img=img),
                 inches=0.5, symb.plots=TRUE, add=FALSE)
}

tmp.mtcars &lt;- scale(mtcars, center=sapply(mtcars,min),
	scale=sapply(mtcars,function(x) diff(range(x))) )
tmp2.mtcars &lt;- lapply( seq_len(nrow(tmp.mtcars)), function(i) tmp.mtcars[i,] )
my.symbols(mtcars$wt, mtcars$mpg, ms.face, inches=0.3, features=tmp2.mtcars,
	add=FALSE)


</code></pre>

<hr>
<h2 id='my.symbols'>Draw Symbols (User Defined) on a Plot</h2><span id='topic+my.symbols'></span>

<h3>Description</h3>

<p>This function draws symbols on a plot.  It is similar to
the builtin <code>symbols</code> function with the difference that it plots
symbols defined by the user rather than a prespecified set of
symbols.</p>


<h3>Usage</h3>

<pre><code class='language-R'>my.symbols(x, y=NULL, symb, inches=1, xsize, ysize,
                       add=TRUE,
                       vadj=0.5, hadj=0.5,
                       symb.plots=FALSE,
                       xlab=deparse(substitute(x)),
                       ylab=deparse(substitute(y)), main=NULL,
                       xlim=NULL, ylim=NULL, linesfun=lines,
                       ..., MoreArgs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="my.symbols_+3A_x">x</code>, <code id="my.symbols_+3A_y">y</code></td>
<td>
<p>The <code>x</code> and <code>y</code> coordinates for the position of
the symbols to be plotted.  These can be specified in any way which is
accepted by <code>xy.coords</code>.</p>
</td></tr>
<tr><td><code id="my.symbols_+3A_symb">symb</code></td>
<td>
<p>Either a matrix, list, or function defining the symbol to
be plotted.  If it is a matrix or list it needs to be formatted that
it can be passed directly to the <code>lines</code> function.  It then
defines the shape of the symbol on on a range/domain of -1 to 1.  If
this is a function it can either return a matrix or list as above
(points on the range/domain of -1 to 1), or it can do the plotting
itself.</p>
</td></tr>
<tr><td><code id="my.symbols_+3A_inches">inches</code></td>
<td>
<p>The size of the square containing the symbol in inches
(note: unlike <code>symbols</code> this cannot be <code>FALSE</code>).  This is
ignored if <code>xsize</code> or <code>ysize</code> is specified.</p>
</td></tr>
<tr><td><code id="my.symbols_+3A_xsize">xsize</code></td>
<td>
<p>The width of the bounding box(s) of the symbols in the same
units as the <code>x</code> variable.  Computed from <code>ysize</code> or
<code>inches</code> if not specified.  Can be a single value or a vector.</p>
</td></tr>
<tr><td><code id="my.symbols_+3A_ysize">ysize</code></td>
<td>
<p>The height of the bounding box(s) of the symbols in the
same units as the <code>y</code> variable.  Computed from <code>xsize</code> or
<code>inches</code> if not specified.  Can be a single value or a vector.</p>
</td></tr>
<tr><td><code id="my.symbols_+3A_add">add</code></td>
<td>
<p>if 'add' is 'TRUE' then the symbols are added to the
existing plot, otherwise a new plot is created.</p>
</td></tr>
<tr><td><code id="my.symbols_+3A_vadj">vadj</code>, <code id="my.symbols_+3A_hadj">hadj</code></td>
<td>
<p>Numbers between 0 and 1 indicating how 'x' and 'y'
specify the location of the symbol.  The defaults center the symbol at
x,y; 0 means put the bottom/left at x,y; and 1 means put
the top/right of the symbol at x,y.</p>
</td></tr>
<tr><td><code id="my.symbols_+3A_symb.plots">symb.plots</code></td>
<td>
<p>If <code>symb</code> is a function that does its own
plotting, set this to TRUE, otherwise it should be FALSE.</p>
</td></tr>
<tr><td><code id="my.symbols_+3A_xlab">xlab</code>, <code id="my.symbols_+3A_ylab">ylab</code>, <code id="my.symbols_+3A_main">main</code>, <code id="my.symbols_+3A_xlim">xlim</code>, <code id="my.symbols_+3A_ylim">ylim</code></td>
<td>
<p>If 'add' is 'FALSE' these are
passed to the <code>plot</code> function when setting up the plot.</p>
</td></tr>
<tr><td><code id="my.symbols_+3A_linesfun">linesfun</code></td>
<td>
<p>The function to draw the lines if the function does not do its own drawing.  The default is <code>lines</code> but could be replaced with <code>polygon</code> to draw filled polygons</p>
</td></tr>
<tr><td><code id="my.symbols_+3A_...">...</code></td>
<td>
<p>Additional arguments will be replicated to the same length
as <code>x</code> then passed to <code>symb</code> (if <code>symb</code> is a function)
and/or the <code>lines</code> function (one value per symbol drawn).</p>
</td></tr>
<tr><td><code id="my.symbols_+3A_moreargs">MoreArgs</code></td>
<td>
<p>A list with any additional arguments to be passed to
the <code>symb</code> function (as is, without being replicated/split).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>symb</code> argument can be a 2 column matrix or a list with
components 'x' and 'y' that defines points on the interval [-1,1] that
will be connected with lines to draw the symbol.  If you want a closed
polygon then be sure to replicate the 1st point as the last point.
</p>
<p>If any point contains an NA then the line will not be drawn to or from
that point.  This can be used to create a symbol with disjoint parts
that should not be connected.
</p>
<p>If <code>symb</code> is a function then it should include a '...' argument
along with any arguments to define the symbol.  Any unmatched
arguments that end up in the '...' argument will be replicated to the
same length as 'x' (using the <code>rep</code> function) then the values
will be passed one at a time to the <code>symb</code> function.  If
<code>MoreArgs</code> is specified, the elements of it will also be passed
to <code>symb</code> without modification.  The <code>symb</code> function can
either return a matrix or list with the points that will then be
passed to the <code>lines</code> function (see above).  Or the function can
call the plotting functions itself (set <code>symb.plots</code> to TRUE).
High level plotting can be done (<code>plot</code>, <code>hist</code>, and other
functions), or low level plotting functions (<code>lines</code>,
<code>points</code>, etc) can be used; in this case they should add things
to a plot with 'x' and 'y' limits of -1 to 1.
</p>
<p>The size of the symbols can be specified by using <code>inches</code> in
which case the symbol will be set inside of squares whose sizes are
<code>inches</code> size based on the plotting device.  The size can also be
set using <code>xsize</code> and/or <code>ysize</code> which use the same units as
the <code>x</code> and/or <code>y</code> variables.  If only one is specified then
the box will be square.  If both are specified and they do not match
the aspect ratio of the plot then the bounding box will not be square
and the symbol will be distorted.
</p>


<h3>Value</h3>

<p>This function is run for its side effect of plotting, it returns an
invisible NULL.
</p>


<h3>Note</h3>

<p>Since the '...' argument is passed to both <code>lines</code> and
<code>symb</code>, the <code>symb</code> function should have a '...' argument so
that it will ignore any additional arguments.
</p>
<p>Arguments such as 'type' can be passed through the '...' argument if
you want the symbol made of something other than lines.
</p>
<p>Plotting coordinates and sizes are based on the size of the device at
the time the function is called.  If you resize the device after
plotting, all bets are off.
</p>
<p>Currently missing values in <code>x</code> or <code>y</code> are not handled
well.  It is best if remove all missing values first.
</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+symbols">symbols</a></code>, <code><a href="#topic+subplot">subplot</a></code>,
<code><a href="base.html#topic+mapply">mapply</a></code>, <code><a href="#topic+ms.polygram">ms.polygram</a></code>, <code><a href="graphics.html#topic+lines">lines</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
# symb is matrix

my.symbols( 1:10, runif(10), ms.male, add=FALSE, xlab='x',
  ylab='y', inches=0.3, col=c('blue','green'), xlim=c(0,11), ylim=c(-0.1,1.1))
my.symbols( (1:10)+0.5, runif(10), ms.female, add=TRUE, inches=0.3,
  col=c('red','green') )

# symb is function returning matrix

plot(1:10, 1:10)
my.symbols( 1:10, 1:10, ms.polygram, n=1:10, inches=0.3 )


# symb is plotting function
# create a variation on monthplot

fit &lt;- lm( log(co2) ~ time(co2) )
fit.r &lt;- resid(fit)

x &lt;- 1:12
y &lt;- tapply(fit.r, cycle(co2), mean)

tmp.r &lt;- split( fit.r, cycle(co2) )
tmp.r &lt;- lapply( tmp.r, function(x) x-mean(x) )

yl &lt;- do.call('range',tmp.r)

tmpfun &lt;- function(w,data,ylim,...){
  tmp &lt;- data[[w]]
  plot(seq(along=tmp),tmp, type='l', xlab='',ylab='',
       axes=FALSE, ylim=ylim)
  lines(par('usr')[1:2], c(0,0), col='grey')
}

my.symbols(x,y, symb=tmpfun, inches=0.4, add=FALSE, symb.plots=TRUE,
  xlab='Month',ylab='Adjusted CO2', xlim=c(0.5,12.5),
  ylim=c(-0.012,0.012),
  w=1:12, MoreArgs=list(data=tmp.r,ylim=yl) )

# using xsize and ysize
plot( 1:10, (1:10)*100, type='n', xlab='', ylab='' )
my.symbols( 5, 500, ms.polygon, n=250, inches=1.5 )
my.symbols( 5, 500, ms.polygon, n=250, xsize=2, col='blue' )
my.symbols( 5, 500, ms.polygon, n=250, ysize=200, col='green' )
my.symbols( 5, 500, ms.polygon, n=250, xsize=2, ysize=200, col='red' )
abline( v=c(4,6), col='grey' )
abline( h=c(400, 600), col='grey' )


# hand crafted hexagonal grid

x1 &lt;- seq(0, by=2*sqrt(3), length.out=10)
y1 &lt;- seq(0, by=3, length.out=10)

mypoints &lt;- expand.grid(x=x1, y=y1)
mypoints[,1] &lt;- mypoints[,1] + rep( c(0,sqrt(3)), each=10, length.out=100 )

plot(mypoints, asp=1, xlim=c(-2,35))
my.symbols(mypoints, symb=ms.filled.polygon, n=6,
  inches=par('pin')[1]/(diff(par('usr')[1:2]))*4,
  bg=paste('gray',1:100,sep=''), fg='green' )

</code></pre>

<hr>
<h2 id='outliers'>
Outliers data
</h2><span id='topic+outliers'></span>

<h3>Description</h3>

<p>This dataset is approximately bell shaped, but with some outliers.  It
is meant to be used for demonstration purposes.  If students are tempted
to throw out all outliers, then have them work with this data (or use a
scaled/centered/shuffled version as errors in a regression problem) and
see how many throw away 3/4 of the data before rethinking their strategy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(outliers)</code></pre>


<h3>Format</h3>

<p>The format is:
num [1:100] -1.548 0.172 -0.638 0.233 -0.228 ...
</p>


<h3>Details</h3>

<p>This is simulated data meant to demonstrate &quot;outliers&quot;.
</p>


<h3>Source</h3>

<p>Simulated, see the examples section.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(outliers)
qqnorm(outliers)
qqline(outliers)
hist(outliers)

o.chuck &lt;- function(x) {  # function to throw away outliers
	qq &lt;- quantile(x, c(1,3)/4, names=FALSE)
	r &lt;- diff(qq) * 1.5
	tst &lt;- x &lt; qq[1] - r | x &gt; qq[2] + r
	if(any(tst)) {
		cat('Removing ', paste(x[tst], collapse=', '), '\n')
		x &lt;- x[!tst]
		out &lt;- Recall(x)
	} else {
		out &lt;- x
	}
	out
}

x &lt;- o.chuck( outliers )
length(x)

if(require(MASS)) {
  char2seed('robust')
  x &lt;- 1:100
  y &lt;- 3 + 2*x + sample(scale(outliers))*10

  plot(x,y)
  fit &lt;- lm(y~x)
  abline(fit, col='red')

  fit.r &lt;- rlm(y~x)
  abline(fit.r, col='blue', lty='dashed')

  rbind(coef(fit), coef(fit.r))
  length(o.chuck(resid(fit)))
}



### The data was generated using code similar to:

char2seed('outlier')

outliers &lt;- rnorm(25)

dir &lt;- 1

while( length(outliers) &lt; 100 ){
	qq &lt;- quantile(c(outliers, dir*Inf), c(1,3)/4)
	outliers &lt;- c(outliers,
		qq[ 1.5 + dir/2 ] + dir*1.55*diff(qq) + dir*abs(rnorm(1)) )
	dir &lt;- -dir
}

</code></pre>

<hr>
<h2 id='pairs2'>Create part of a scatterplot matrix</h2><span id='topic+pairs2'></span>

<h3>Description</h3>

<p>This function is similar to the <code>pairs</code> function, but instead of
doing all pairwise plots, it takes 2 matricies or data frames and does
all combinations of the first on the x-axis with the 2nd on the
y-axis.  Used with pairs and subsets can spread a scatterplot matrix
accross several pages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pairs2(x, y, xlabels, ylabels, panel = points, ..., row1attop = TRUE, gap = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pairs2_+3A_x">x</code></td>
<td>
<p> Matrix or data frame of variables to be used as the x-axes. </p>
</td></tr>
<tr><td><code id="pairs2_+3A_y">y</code></td>
<td>
<p> Matrix or data frame of variables to be used as the y-axes. </p>
</td></tr>
<tr><td><code id="pairs2_+3A_xlabels">xlabels</code></td>
<td>
<p> Labels for x variables (defaults to colnames of <code>x</code>). </p>
</td></tr>
<tr><td><code id="pairs2_+3A_ylabels">ylabels</code></td>
<td>
<p> Labels for y variables (defaults to colnames of <code>y</code>). </p>
</td></tr>
<tr><td><code id="pairs2_+3A_panel">panel</code></td>
<td>
<p> Function to do the plotting (see <code>pairs</code>). </p>
</td></tr>
<tr><td><code id="pairs2_+3A_...">...</code></td>
<td>
<p> additional arguments passed to graphics functions</p>
</td></tr>
<tr><td><code id="pairs2_+3A_row1attop">row1attop</code></td>
<td>
<p> Logical, should the 1st row be the top.</p>
</td></tr>
<tr><td><code id="pairs2_+3A_gap">gap</code></td>
<td>
<p> Distance between plots. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This functios is similar to the <code>pairs</code> function, but by giving
it 2 sets of data it only does the combinations between them.  Think
of it as giving the upper right or lower left set of plots from
<code>pairs</code>.  If a regular scatterplot matrix is too small on the
page/device then use <code>pairs</code> on subsets of the data to get the
diagonal blocks of a scatterplot matrix and this function to get the
off diagonal blocks.
</p>


<h3>Value</h3>

<p>This function is run for the side effect of the plot.  It does not
return anything useful.
</p>


<h3>Note</h3>

<p>Large amounts of the code for this function were blatently
borrowed/stolen from the <code>pairs</code> function, the credit for the
useful parts should go to the original authors, blame for any problems
should go to me.  This function is also released under GPL since much
of it comes from GPL code.
</p>


<h3>Author(s)</h3>

<p> Greg Snow, <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+pairs">pairs</a></code>, <code>splom</code> in the lattice package</p>


<h3>Examples</h3>

<pre><code class='language-R'>pairs2(iris[,1:2], iris[,3:4], col=c('red','green','blue')[iris$Species])

# compare the following plot:
pairs(state.x77, panel=panel.smooth)

# to the following 4 plots

pairs(state.x77[,1:4], panel=panel.smooth)
pairs(state.x77[,5:8], panel=panel.smooth)
pairs2( state.x77[,1:4], state.x77[,5:8], panel=panel.smooth)
pairs2( state.x77[,5:8], state.x77[,1:4], panel=panel.smooth)

</code></pre>

<hr>
<h2 id='panel.my.symbols'>Draw Symbols (User Defined) on a Lattice Plot</h2><span id='topic+panel.my.symbols'></span>

<h3>Description</h3>

<p>This function draws symbols on a lattice plot.  It is similar to
the builtin <code>symbols</code> function with the difference that it plots
symbols defined by the user rather than a prespecified set of
symbols.</p>


<h3>Usage</h3>

<pre><code class='language-R'>panel.my.symbols(x, y, symb, inches=1, polygon=FALSE,
                       ..., symb.plots=FALSE, subscripts, MoreArgs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="panel.my.symbols_+3A_x">x</code>, <code id="panel.my.symbols_+3A_y">y</code></td>
<td>
<p>The <code>x</code> and <code>y</code> coordinates for the position of
the symbols to be plotted.  These can be specified in any way which is
accepted by <code>xy.coords</code>.</p>
</td></tr>
<tr><td><code id="panel.my.symbols_+3A_symb">symb</code></td>
<td>
<p>Either a matrix, list, or function defining the symbol to
be plotted.  If it is a matrix or list it needs to be formatted that
it can be passed directly to the <code>llines</code> function.  It then
defines the shape of the symbol on on a range/domain of -1 to 1.  If
this is a function it can either return a matrix or list as above
(points on the range/domain of -1 to 1).</p>
</td></tr>
<tr><td><code id="panel.my.symbols_+3A_inches">inches</code></td>
<td>
<p>The size of the square containing the symbol in inches
(note: unlike <code>symbols</code> this cannot be <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="panel.my.symbols_+3A_polygon">polygon</code></td>
<td>
<p>If TRUE, use <code>lpolygon</code> function to plot rather than the
<code>llines</code> function.</p>
</td></tr>
<tr><td><code id="panel.my.symbols_+3A_symb.plots">symb.plots</code></td>
<td>
<p>Currently not implemented.</p>
</td></tr>
<tr><td><code id="panel.my.symbols_+3A_...">...</code></td>
<td>
<p>Additional arguments will be replicated to the same length
as <code>x</code> then passed to <code>symb</code> (if <code>symb</code> is a function)
and/or the <code>lines</code> function (one value per symbol drawn).</p>
</td></tr>
<tr><td><code id="panel.my.symbols_+3A_subscripts">subscripts</code></td>
<td>
<p>subscripts for the current panel</p>
</td></tr>
<tr><td><code id="panel.my.symbols_+3A_moreargs">MoreArgs</code></td>
<td>
<p>A list with any additional arguments to be passed to
the <code>symb</code> function (as is, without being replicated/split).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>symb</code> argument can be a 2 column matrix or a list with
components 'x' and 'y' that defines points on the interval [-1,1] that
will be connected with lines to draw the symbol.  If you want a closed
polygon then be sure to replicate the 1st point as the last point or
use the <code>polygon</code> option.
</p>
<p>If any point contains an NA then the line will not be drawn to or from
that point.  This can be used to create a symbol with disjoint parts
that should not be connected.
</p>
<p>If <code>symb</code> is a function then any unmatched
arguments that end up in the '...' argument will be replicated to the
same length as 'x' (using the <code>rep</code> function) then the values
will be passed one at a time to the <code>symb</code> function.  If
<code>MoreArgs</code> is specified, the elements of it will also be passed
to <code>symb</code> without modification.  The <code>symb</code> function can
either return a matrix or list with the points that will then be
passed to the <code>llines</code> function (see above).
</p>


<h3>Value</h3>

<p>This function is run for its side effect of plotting, it returns an
invisible NULL.
</p>


<h3>Note</h3>

<p>Plotting coordinates and sizes are based on the size of the device at
the time the function is called.  If you resize the device after
plotting, all bets are off.
</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+symbols">symbols</a></code>, <code><a href="#topic+my.symbols">my.symbols</a></code>, <code><a href="#topic+subplot">subplot</a></code>,
<code><a href="base.html#topic+mapply">mapply</a></code>, <code><a href="#topic+ms.polygram">ms.polygram</a></code>, <code><a href="graphics.html#topic+lines">lines</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>if(require(lattice)) {
  tmpdf &lt;- data.frame( x=1:10, y=1:10, g=factor(rep( c("A","B"), each=5 )),
	z=c(1:5,5:1) )

  xyplot( y ~ x, tmpdf, panel=panel.my.symbols, symb=ms.female, inches=0.3 )

  xyplot( y ~ x | g, tmpdf, panel=panel.my.symbols, symb=ms.male, inches=0.3)

  xyplot( y ~ x, tmpdf, panel=panel.superpose, groups=g,
	panel.groups= function(group.number, ...) {
		if(group.number==1) {
			panel.my.symbols(..., symb=ms.male)
		} else {
			panel.my.symbols(..., symb=ms.female)
		} },
		inches=0.3
	)

  xyplot( y ~ x, tmpdf, panel=panel.my.symbols, symb=ms.polygram, n=tmpdf$z,
		inches=0.3)

  xyplot( y ~ x | g, tmpdf, panel=panel.my.symbols, symb=ms.polygram,
		n=tmpdf$z, inches=0.3)

  xyplot( y ~ x, tmpdf, panel=panel.superpose, groups=g,
	panel.groups = panel.my.symbols,
		inches=0.3, symb=ms.polygon, n=tmpdf$z, polygon=TRUE,
		adj=rep(c(0,pi/4),5)
	)
}
</code></pre>

<hr>
<h2 id='petals'>
Play the Petals Around the Rose game
</h2><span id='topic+petals'></span>

<h3>Description</h3>

<p>This plays the lateral thinking game Petals Around the Rose.  This is a
game where 5 regular dice are rolled and the players then try to figure
out how many petals are around the rose.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>petals(plot = TRUE, txt = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="petals_+3A_plot">plot</code></td>
<td>
<p> Should the dice be plotted to the current/default
graphics device.
</p>
</td></tr>
<tr><td><code id="petals_+3A_txt">txt</code></td>
<td>
<p> Should the dice be shown in the console window using text.

</p>
</td></tr>
</table>


<h3>Details</h3>

<p>At least one of the arguments <code>plot</code> and <code>txt</code> needs to be
true, otherwise you will be guessing blind (or testing your psychic
abilities).
</p>
<p>The game is usually played with 5 physical dice, one person who knows
the rules (the potentate of the rose, here the computer), and one or
more players trying to learn the puzzle.  The potentate can only give
the players the following 3 rules:
</p>

<ol>
<li><p> The name of the game is &quot;Petals Around the Rose&quot; and the name is
significant.
</p>
</li>
<li><p> The answer is always 0 or an even number.
</p>
</li>
<li><p> The potentate can tell the answer for any roll after any guesses
are made.
</p>
</li></ol>

<p>The potentate (or other player) then rolls the 5 dice and any players
are then allowed to guess.  The potentate either confirms a correct
guess or tells the correct answer, then the game continues with another
roll.  Players are not to discuss their reasoning so that each can solve
it themselves.  When a player thinks they have worked out the reasoning
they demonstrate it by getting correct guesses, but not by discussing it
with anyone.  Generally 6 correct guesses in a row is considered
evidence that they have figured out the rules and they are then
considered a potentate of the rose.
</p>
<p>For this implementation the computer will simulate the role of 5 dice
and display the results and ask for a guess of how many petals are
around the rose.  The player then enters their guess and the computer
then either confirms that it is correct or gives the correct answer.
</p>
<p>Pressing enter without making a guess ends the game.
</p>


<h3>Value</h3>

<p>This function only returns NULL, it is run for its side effects.
</p>







<h3>Note</h3>

<p>Casual viewing of the function source code is unlikely to reveal the
secret (and therefore this could be used as an example of one way to
disguise portions of code from casual examination).  More on
disguising source code is at <a href="https://stat.ethz.ch/pipermail/r-devel/2011-October/062236.html">https://stat.ethz.ch/pipermail/r-devel/2011-October/062236.html</a>.
</p>
<p>Some basic debugging can reveal the secret, but that would be cheating
and an admission that such a simple game has defeated you, so don't do
it, just keep playing until you figure it out.
</p>


<h3>Author(s)</h3>

<p>Greg Snow, <a href="mailto:538280@gmail.com">538280@gmail.com</a>

</p>


<h3>References</h3>

<p><a href="http://www.borrett.id.au/computing/petals-bg.htm">http://www.borrett.id.au/computing/petals-bg.htm</a>

</p>


<h3>See Also</h3>

<p><code>dice</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
  petals()
}
</code></pre>

<hr>
<h2 id='plot2script'>Create a script from the current plot</h2><span id='topic+plot2script'></span>

<h3>Description</h3>

<p>This function attempts to create a script that will
recreate the current plot (in the graphics window).  You can then edit
any parts of the script that you want changed and rerun to get the
modified plot.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot2script(file='clipboard')
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot2script_+3A_file">file</code></td>
<td>
<p>The filename (the clipboard by default) for the script to
create or append to.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function works with the graphics window and mainly traditional
graphics (it may work with lattice or other graphics, but has not
really been tested with those).
</p>
<p>This function creates a script file (or puts it on the clipboard so
that you can past into a script window or text editor) that will
recreate the current graph in the current graph window.  The script
consists of very low level functions (calls to <code>plot.window</code> and
<code>axis</code> rather than letting <code>plot</code> handle all this).
</p>
<p>If you want the higher level functions that were actually used, then
use the <code>history</code> or <code>savehistory</code> commands (this will
probably be the better method for most cases).
</p>
<p>Some of the low level plotting functions use different arguments to
the internal version than the user callable version (<code>box</code> for
example), the arguments to these functions may need to be editted
before the full script will run correctly.
</p>
<p>The lengths of command lines between the creation of the script and
what can be run in R do not always match, you may need to manually
wrap long lines in the script before it will run properly.
</p>


<h3>Value</h3>

<p>This function is run for its side effects and does not return anything
meaningful.
</p>


<h3>Note</h3>

<p> For any serious projects it is best to put your code into a
script to begin with and edit the original script rather than using
this function.
</p>
<p>This function depends on the <code>recordPlot</code> function which can
change in any version.  Therefore this function should not be
considered stable.
</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+history">history</a></code>, <code><a href="utils.html#topic+savehistory">savehistory</a></code>,
<code><a href="grDevices.html#topic+recordPlot">recordPlot</a></code>, <code><a href="base.html#topic+source">source</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){

# create a plot
plot(runif(10),rnorm(10))
lines( seq(0,1,length=10), rnorm(10,1,3) )

# create the script
plot2script()

# now paste the script into a script window or text processor.
# edit the ranges in plot.window() and change some colors or
# other options.  Then run the script.
 }
</code></pre>

<hr>
<h2 id='power.examp'> Graphically illustrate the concept of power. </h2><span id='topic+power.examp'></span><span id='topic+run.power.examp'></span><span id='topic+run.power.examp.old'></span><span id='topic+power.refresh'></span>

<h3>Description</h3>

<p>Create graphs of a normal test statistic under the null and
alternative hypotheses to graphically show the idea of power.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.examp(n = 1, stdev = 1, diff = 1, alpha = 0.05, xmin = -2, xmax = 4)
run.power.examp(hscale=1.5, vscale=1.5, wait=FALSE)
run.power.examp.old()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power.examp_+3A_n">n</code></td>
<td>
<p> The sample size for the test statistic. </p>
</td></tr>
<tr><td><code id="power.examp_+3A_stdev">stdev</code></td>
<td>
<p> The standard deviation of the population. </p>
</td></tr>
<tr><td><code id="power.examp_+3A_diff">diff</code></td>
<td>
<p> The true difference in means (alternate hypothesis). </p>
</td></tr>
<tr><td><code id="power.examp_+3A_alpha">alpha</code></td>
<td>
<p> The type I error rate to use for the test. </p>
</td></tr>
<tr><td><code id="power.examp_+3A_xmin">xmin</code></td>
<td>
<p> The minimum x value to show on the graph. </p>
</td></tr>
<tr><td><code id="power.examp_+3A_xmax">xmax</code></td>
<td>
<p> The maximum x value to show on the graph. </p>
</td></tr>
<tr><td><code id="power.examp_+3A_hscale">hscale</code></td>
<td>
<p>Controls width of plot, passed to <code>tkrplot</code>.</p>
</td></tr>
<tr><td><code id="power.examp_+3A_vscale">vscale</code></td>
<td>
<p>Controls height of plot, passed to <code>tkrplot</code>.</p>
</td></tr>
<tr><td><code id="power.examp_+3A_wait">wait</code></td>
<td>
<p>Should R wait for the window to close.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will draw 2 graphs representing an upper-tailed test of
hypothesis.
</p>
<p>The upper panel represents the test statistic under the
null hypothesis that the true mean (or mean difference) is 0.  It then
also shows the upper tail area equal to <code>alpha</code> and the rejection
region for the test statistic.
</p>
<p>The lower panel shows the normal distribution for the test statistic
under the alternative hypothesis where the true mean (or mean
difference) is <code>diff</code>.  Using the rejection region from the upper
panel it shades the upper tail area that corresponds to the power of
the test.
</p>
<p>Both curves are affected by the specified <code>stdev</code> and sample size
<code>n</code>.
</p>
<p>The function <code>run.power.examp</code> will in addition create a Tk
slider box that will allow you to interactively change the values of
<code>stdev</code>, <code>diff</code>, <code>alpha</code>, and <code>n</code> to dynamically
see the effects of the change on the graphs and on the power of the
test.
</p>
<p>This can be used to demonstrate the concept of power, show the effect
of sample size on power, show the inverse relationship between the
type I and type II error rates, and show how power is dependent on the
true mean (or difference) and the population standard deviation.
</p>


<h3>Value</h3>

<p><code>power.examp</code> invisibly returns the power computed.
</p>
<p><code>run.power.examp</code> returns a list with the parameter settings and
the power if <code>wait</code> is TRUE.
</p>
<p><code>run.power.examp.old</code> does not return anything meaningful.
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+power.t.test">power.t.test</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>power.examp()
power.examp(n=25)
power.examp(alpha=0.1)
</code></pre>

<hr>
<h2 id='put.points.demo'> Demonstrate Correlation and Regression by placing and moving
data points </h2><span id='topic+put.points.demo'></span>

<h3>Description</h3>

<p>Place data points on a graph to demonstrate concepts related to
correlation and regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>put.points.demo(x = NULL, y = NULL, lsline = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="put.points.demo_+3A_x">x</code></td>
<td>
<p> x-coordinates for initial points. </p>
</td></tr>
<tr><td><code id="put.points.demo_+3A_y">y</code></td>
<td>
<p> y-coordinates for initial points. </p>
</td></tr>
<tr><td><code id="put.points.demo_+3A_lsline">lsline</code></td>
<td>
<p> Logical, should the ls regresion line be included. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot area is divided into 2 sections, the left section shows a
scatterplot of your points, the right panel controls what happens when
you click in the left panel.
</p>
<p>The top of the right panel has an &quot;end&quot; button that you click on to
end the demonstration.
</p>
<p>The middle right panel toggles the least squares line and information.
</p>
<p>The bottom right panel has radio buttons that determine what clicking
in the left panel will do, the options are to add a point, delete a
point, or move a point.
</p>
<p>To move a point click on the point you want to move, it will become
solid, then click in the place you want it to move to.
</p>
<p>When deleting or moving points, the closest point to where you click
will be deleted or moved, even if you click in an empty area.
</p>
<p>Whenever you add, delete, or move a point the correlation, r^2, and
regression line will be updated.  You can start with a set of points
then demonstrate what happens to the correlation and regression line
when outliers are added or important points are moved or deleted.
</p>


<h3>Value</h3>

<p>This function does not return anything.
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

 <p><code><a href="graphics.html#topic+plot">plot</a></code>, <code><a href="stats.html#topic+cor">cor</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
if(interactive()){
put.points.demo()

x &lt;- rnorm(25, 5, 1)
y &lt;- x + rnorm(25)
put.points.demo(x,y)
}

</code></pre>

<hr>
<h2 id='Pvalue.norm.sim'> Simulate P-values </h2><span id='topic+Pvalue.norm.sim'></span><span id='topic+Pvalue.binom.sim'></span><span id='topic+run.Pvalue.norm.sim'></span><span id='topic+run.Pvalue.binom.sim'></span>

<h3>Description</h3>

<p>Simulate and plot p-values from a normal or binomial based test under
various conditions.  When all the assumptions are true, the p-values
should follow an approximate uniform distribution.  These functions
show that along with how violating the assumptions changes the
distribution of the p-values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Pvalue.norm.sim(n = 50, mu = 0, mu0 = 0, sigma = 1, sigma0 = sigma,
     test= c("z", "t"), alternative = c("two.sided", "less", "greater", "&lt;&gt;",
           "!=", "&lt;", "&gt;"), alpha = 0.05, B = 10000)
Pvalue.binom.sim(n=100, p=0.5, p0=0.5, test=c('exact','approx'),
                            alternative=c('two.sided', 'less', 'greater',
                            '&lt;&gt;','!=','&lt;','&gt;'),
                            alpha=0.05, B=1000)
run.Pvalue.norm.sim()
run.Pvalue.binom.sim()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pvalue.norm.sim_+3A_n">n</code></td>
<td>
<p>Sample Size for each simulated dataset</p>
</td></tr>
<tr><td><code id="Pvalue.norm.sim_+3A_mu">mu</code></td>
<td>
<p>Simulation mean for samples</p>
</td></tr>
<tr><td><code id="Pvalue.norm.sim_+3A_mu0">mu0</code></td>
<td>
<p>Hypothesized mean for tests</p>
</td></tr>
<tr><td><code id="Pvalue.norm.sim_+3A_sigma">sigma</code></td>
<td>
<p>Simulation SD for samples</p>
</td></tr>
<tr><td><code id="Pvalue.norm.sim_+3A_sigma0">sigma0</code></td>
<td>
<p>Hypothesized SD for tests, if blank or missing, use the
sample SD in the tests</p>
</td></tr>
<tr><td><code id="Pvalue.norm.sim_+3A_p">p</code></td>
<td>
<p>Simulation proportion for samples</p>
</td></tr>
<tr><td><code id="Pvalue.norm.sim_+3A_p0">p0</code></td>
<td>
<p>Hypothesized proportion for tests</p>
</td></tr>
<tr><td><code id="Pvalue.norm.sim_+3A_test">test</code></td>
<td>
<p>Which test to use, &quot;z&quot; or &quot;t&quot; tests for normal, &quot;exact&quot;
(binomial) or &quot;approx&quot; (normal approximation) for binomial </p>
</td></tr>
<tr><td><code id="Pvalue.norm.sim_+3A_alternative">alternative</code></td>
<td>
<p>Direction for alternative hypothesis </p>
</td></tr>
<tr><td><code id="Pvalue.norm.sim_+3A_alpha">alpha</code></td>
<td>
<p>alpha level for test (optional) </p>
</td></tr>
<tr><td><code id="Pvalue.norm.sim_+3A_b">B</code></td>
<td>
<p>Number of simulated datasets </p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions generate <code>B</code> samples from either a normal or
binomial distribution, then compute the P-values for the test of
significance on each sample and plot the P-values.
</p>
<p>The <code>run.Pvalue.norm.sim</code> and <code>run.Pvalue.binom.sim</code>
functions are GUI wrappers for the other 2 functions allowing you to
change the parameters and click on &quot;refresh&quot; to run a new set of
simulations.
</p>
<p>Using <code>NA</code> for <code>sigma0</code> will result in the sample standard
deviations being used (leave blank in the GUI).
</p>
<p>When the simulation conditions and the hypothesized values match, the
distributions of the p-values will be approximately uniform.
Changing the parameter of interest will show the idea of power.
Changing the other parameters can show the effects of assumptions not
being met.
</p>


<h3>Value</h3>

<p>The P-values are invisibly returned.
</p>


<h3>Note</h3>

<p>Note: the 2-sided p-values for the binomial may not match the results
from binom.test and prop.test.  The method used here is an
approximation for speed.
</p>


<h3>Author(s)</h3>

<p>Greg Snow, <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>References</h3>

<p> Murdock, D, Tsai, Y, and Adcock, J (2008) _P-Values are
Random Variables_. The American Statistician. (62) 242-245.</p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+t.test">t.test</a></code>, <code><a href="#topic+z.test">z.test</a></code>,
<code><a href="stats.html#topic+binom.test">binom.test</a></code>, <code><a href="stats.html#topic+prop.test">prop.test</a></code>, <code><a href="#topic+tkexamp">tkexamp</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'> if(interactive()) {
  run.Pvalue.norm.sim()
  run.Pvalue.binom.sim()
}
</code></pre>

<hr>
<h2 id='rgl.coin'> Animated die roll or coin flip </h2><span id='topic+rgl.coin'></span><span id='topic+rgl.die'></span><span id='topic+flip.rgl.coin'></span><span id='topic+roll.rgl.die'></span>

<h3>Description</h3>

<p>Open an rgl window, plot either a representation of a coin or a die
then animate the flipping/rolling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rgl.coin(x, col = "black", heads = x[[1]], tails = x[[2]], ...)

rgl.die(x=1:6, col.cube = "white", col.pip = "black", sides = x, ...)

flip.rgl.coin(side = sample(2, 1), steps = 150)

roll.rgl.die(side = sample(6, 1), steps = 250)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rgl.coin_+3A_x">x</code></td>
<td>
<p> for <code>rgl.coin</code> a list with information for drawing
the faces of the coin, defaults to <code>coin.faces</code>.  For
<code>rgl.die</code> a vector with the number of pips to put on the
sides of the die (alternative way of specifying <code>sides</code>). </p>
</td></tr>
<tr><td><code id="rgl.coin_+3A_col">col</code></td>
<td>
<p> Color of lines on the coin faces. </p>
</td></tr>
<tr><td><code id="rgl.coin_+3A_heads">heads</code></td>
<td>
<p> Design to use as &quot;heads&quot; side of coin. </p>
</td></tr>
<tr><td><code id="rgl.coin_+3A_tails">tails</code></td>
<td>
<p> Design to use as &quot;tails&quot; side of coin. </p>
</td></tr>
<tr><td><code id="rgl.coin_+3A_col.cube">col.cube</code></td>
<td>
<p> Color of the cube for the die. </p>
</td></tr>
<tr><td><code id="rgl.coin_+3A_col.pip">col.pip</code></td>
<td>
<p> Color of the pips (spots) on the die </p>
</td></tr>
<tr><td><code id="rgl.coin_+3A_sides">sides</code></td>
<td>
<p> Vector of length 6 indicating which numbers to show on
the die.  </p>
</td></tr>
<tr><td><code id="rgl.coin_+3A_side">side</code></td>
<td>
<p> Which side of the coin (1 or 2) or die (1 through 6)
should end up face up. </p>
</td></tr>
<tr><td><code id="rgl.coin_+3A_steps">steps</code></td>
<td>
<p> The number of steps in each part of the animation,
higher values will be smoother and slower, lower values will be
faster but more jumpy. </p>
</td></tr>
<tr><td><code id="rgl.coin_+3A_...">...</code></td>
<td>
<p> Currently any additional options are silently ignored. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>You must use the plot function first to create the coin or die, then
use the flip or roll function to start the animation.  You can animate
multiple times for a single use of the plotting function.
</p>
<p>You can manually rotate the image as well, see the <code>rgl</code> package
for details.
</p>
<p>The defaults plot a regular coin and die, but arguments are available
to create special casses (2 headed coin, die with 2 6's and no 1,
...).
</p>
<p>The data list <code>coin.faces</code> contains information on designs for
the faces of the coins in case you want to choose a different design.
</p>
<p>The default rolling and flipping options ranomly choose which side
will be face up following a uniform distribution.  You can specify the
side yourself, or use the <code>sample</code> function to do a biased random
flip/roll.
</p>


<h3>Value</h3>

<p>Which side ended up face up (1 or 2 for coin, 1 through 6 for die).
This is the internal numbering and does not match a change in the
<code>sides</code> argument.
</p>


<h3>Note</h3>

<p> The current algorithm for animating the die roll shows all the
sides, but I am not satisfied with it.  Please suggest improvements. </p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

 <p><code><a href="#topic+dice">dice</a></code>, <code><a href="#topic+plot.dice">plot.dice</a></code>,
<code><a href="#topic+coin.faces">coin.faces</a></code>, <code><a href="base.html#topic+sample">sample</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
rgl.coin()
flip.rgl.coin()
flip.rgl.coin(1)
flip.rgl.coin(2)

rgl.clear()

# two-headed coin
rgl.coin(tails=coin.faces$qh)

rgl.clear()

# letters instead of pictures
rgl.coin(heads=coin.faces$H, tails=coin.faces$T)

# biased flip
flip.rgl.coin( sample(2,1, prob=c(0.65, 0.35) ) )

rgl.clear()

rgl.die()
roll.rgl.die()
roll.rgl.die(6)

# biased roll
roll.rgl.die( sample(6,1, prob=c(1,2,3,3,2,1) ) )
}
</code></pre>

<hr>
<h2 id='rgl.Map'> Plot a map in an rgl window </h2><span id='topic+rgl.Map'></span>

<h3>Description</h3>

<p>Plots a map (from a Map object from package spData) on a unit sphere
in an rgl window that can then be interactively rotated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rgl.Map(Map, which, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rgl.Map_+3A_map">Map</code></td>
<td>
<p> An <code>sfc_MULTIPOLYGON</code> object </p>
</td></tr>
<tr><td><code id="rgl.Map_+3A_which">which</code></td>
<td>
<p> Vector indicating the subset of polygons to plot. </p>
</td></tr>
<tr><td><code id="rgl.Map_+3A_...">...</code></td>
<td>
<p> Additional arguments passed on to <code>rgl.lines</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This assumes that the map is cordinates in degrees and plots the map
on a unit sphere in an rgl window making a globe.  You can then rotate
the globe by clicking and dragging in the window.
</p>


<h3>Value</h3>

<p>There is no return value, this function is run for its side effect.
</p>


<h3>Note</h3>

<p> This function is still beta level software (some extra lines show
up).</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p><code>rgl</code> in package rgl, <code>plot</code> method in
package sp </p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){

if(require("spData")) {
  data(world)
  rgl.Map(world$geom)
  spheres3d(0,0,0,.999, col='lightblue')
}
}
</code></pre>

<hr>
<h2 id='roc.demo'> Demonstrate ROC curves by interactively building one </h2><span id='topic+roc.demo'></span>

<h3>Description</h3>

<p>This demonstration allows you to interactively build a Receiver
Operator Curve to better understand what goes into creating them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roc.demo(x = rnorm(25, 10, 1), y = rnorm(25, 11, 1.5))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="roc.demo_+3A_x">x</code></td>
<td>
<p> Data values for group 1 (controls). </p>
</td></tr>
<tr><td><code id="roc.demo_+3A_y">y</code></td>
<td>
<p> Data values for group 2 (cases). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Density plots for the 2 groups will be created in the lower panel of
the plot (colored red (group 1) and blue (group 2)) along with rug
plots of the actual datapoints.  There is also a
green vertical line that represents a decision rule cutoff, any points
higher than the cutoff are predicted to be in group 2 and points less
than the cuttoff are predicted to be in group 1.  The sensitivity and
specificity for the current cuttoff value are printed below the plot.
</p>
<p>A Tk slider box is also created that allows you to move the cuttoff
value and update the plots.  As the cutoff value changes, the
different combinations of sensitivity and specificity are added to the
ROC curve in the top panel (the point corresponding to the current
cuttoff value is highlighted in red).  A line is also drawn from the
point representing sensitivity and specificity both equal to 1 to the
point closest to it.
</p>


<h3>Value</h3>

<p>No meaninful value is returned, this function is run solely for the
side effects.
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

 <p><code><a href="#topic+slider">slider</a></code>, <code>ROC</code> function in package
Epi, <code>auROC</code> in package limma, package ROC </p>


<h3>Examples</h3>

<pre><code class='language-R'>
if(interactive()){
roc.demo()
with(CO2,
  roc.demo(uptake[Type=='Mississippi'],
           uptake[Type=='Quebec']       )
)
}
</code></pre>

<hr>
<h2 id='rotate.cloud'> Interactively rotate 3D plots </h2><span id='topic+rotate.cloud'></span><span id='topic+rotate.persp'></span><span id='topic+rotate.wireframe'></span>

<h3>Description</h3>

<p>Interactively rotate common 3d plots: cloud, persp, and wireframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rotate.cloud(x, ...)
rotate.persp(x, y, z)
rotate.wireframe(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rotate.cloud_+3A_x">x</code></td>
<td>
 <p><code>x</code>, see <code>persp</code>, or formula/matrix to pass to
cloud or wireframe </p>
</td></tr>
<tr><td><code id="rotate.cloud_+3A_y">y</code></td>
<td>
 <p><code>y</code>, see <code>persp</code>  </p>
</td></tr>
<tr><td><code id="rotate.cloud_+3A_z">z</code></td>
<td>
 <p><code>z</code>, see <code>persp</code>  </p>
</td></tr>  
<tr><td><code id="rotate.cloud_+3A_...">...</code></td>
<td>
<p> additional arguments passed on to <code>cloud</code> or <code>persp</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use these functions just like <code>cloud</code>, <code>persp</code>, and
<code>wireframe</code>.  In addition to the default plot a Tk slider window
will be created that will allow you to rotate the plot.
</p>
<p>The rotations parameters are passed the <code>screen</code> argument of
<code>cloud</code> and <code>wireframe</code> and the <code>theta</code>, <code>phi</code>,
<code>r</code>, <code>d</code>, <code>ltheta</code>, <code>lphi</code>, and <code>shade</code>
arguments of <code>persp</code>.
</p>
<p>For <code>cloud</code> and <code>wireframe</code> plots the order of the <code>x</code>,
<code>y</code>, and <code>z</code> argumets can be rearanged, just type the
appropriate letters in the boxes on the left, then press the &quot;refresh&quot;
button (changing the order changes the plot for these 2 plots).
</p>


<h3>Value</h3>

<p>These functions are run for the side effects of the plots and Tk
windows, nothing meaninful is returned.
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

 <p><code>cloud</code> it the lattice package,
<code><a href="graphics.html#topic+persp">persp</a></code>, <code>wireframe</code> in the lattice package </p>


<h3>Examples</h3>

<pre><code class='language-R'>
if(interactive()){
rotate.cloud(Sepal.Length ~ Petal.Length*Petal.Width, data=iris)

rotate.wireframe(volcano)

z &lt;- 2 * volcano        # Exaggerate the relief
x &lt;- 10 * (1:nrow(z))   # 10 meter spacing (S to N)
y &lt;- 10 * (1:ncol(z))   # 10 meter spacing (E to W)
rotate.persp(x,y,z)
}
</code></pre>

<hr>
<h2 id='run.cor.examp'> Interactively demonstrate correlations </h2><span id='topic+run.cor.examp'></span><span id='topic+run.cor2.examp'></span><span id='topic+run.old.cor.examp'></span><span id='topic+run.old.cor2.examp'></span>

<h3>Description</h3>

<p>Make a scatterplot and a Tk slider window that allows you to
interactively set the correlation and/or R^2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run.cor.examp(n=100, seed, vscale=1.5, hscale=1.5, wait=FALSE)
run.cor2.examp(n=100, seed, vscale=1.5, hscale=1.5, wait=FALSE)
run.old.cor.examp(n = 100, seed)
run.old.cor2.examp(n = 100, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run.cor.examp_+3A_n">n</code></td>
<td>
<p> Number of points to plot. </p>
</td></tr>
<tr><td><code id="run.cor.examp_+3A_seed">seed</code></td>
<td>
<p> What seed to use. </p>
</td></tr>
<tr><td><code id="run.cor.examp_+3A_vscale">vscale</code></td>
<td>
<p> Vertical scale passed to tkrplot. </p>
</td></tr>
<tr><td><code id="run.cor.examp_+3A_hscale">hscale</code></td>
<td>
<p> Horizontal scale passed to tkrplot. </p>
</td></tr>
<tr><td><code id="run.cor.examp_+3A_wait">wait</code></td>
<td>
<p> Should R wait for the tk window to close. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>run.cor.examp</code> draws a scatterplot and allows you
to set the correlation using a Tk slider window.
</p>
<p>The function <code>run.cor2.examp</code> does the same, but has a slider for
R^2 as well as the correlation, when either slider is moved the other
one will update to match.
</p>
<p>The 2 &quot;old&quot; versions use the default graphics device with a seperate
window with the sliders, the versions without &quot;old&quot; in the name
include the plot and sliders together in a single tk window.
</p>
<p>The size of the plot can be changed by changing the values in the
hscale and vscale boxes and clicking on the &quot;Refresh&quot; button.
</p>


<h3>Value</h3>

<p>If <code>wait</code> is TRUE, then the return value is a list with the x and
y values of the final plot.
</p>
<p>If <code>wait</code> is FALSE (and in the &quot;old&quot; versions) an invisible NULL
is returned.
</p>


<h3>Note</h3>

<p> If <code>wait</code> is TRUE then R will wait until you click on the
&quot;Exit&quot; button before you can use your R session again.  If <code>wait</code>
is FALSE then the tk window will appear, but R will regain control so
that you can continue to use R as well as interact with the
demonstration window.</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+cor">cor</a></code>, <code><a href="#topic+tkexamp">tkexamp</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()) {
  run.cor2.examp()
}
</code></pre>

<hr>
<h2 id='run.hist.demo'> Create a histogram and interactively change the number of bars. </h2><span id='topic+run.hist.demo'></span>

<h3>Description</h3>

<p>Create a histogram then use a Tk slider window to change the number of
bars, the minimum, and the maximum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run.hist.demo(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run.hist.demo_+3A_x">x</code></td>
<td>
<p> Data to plot. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Draws a histogram and creates a Tk slider window that allows you to
explore how changing the parameters affects the appearance of the plot.
</p>


<h3>Value</h3>

<p>No meaninful value is returned.
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

 <p><code><a href="graphics.html#topic+hist">hist</a></code>, <code><a href="#topic+slider">slider</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
run.hist.demo( rnorm(250, 100, 5) )
}
</code></pre>

<hr>
<h2 id='SensSpec.demo'> Demonstrate Sensitivity, Specificity, PPV, and NPV </h2><span id='topic+SensSpec.demo'></span>

<h3>Description</h3>

<p>This function demonstrates how to get PPV and NPV from Sensitivity,
Specificity, and Prevalence by using a virtual population rather than
a direct application of Bayes Rule.  This approach is more intuitive
to mathphobes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SensSpec.demo(sens, spec, prev, n = 100000, step = 11)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SensSpec.demo_+3A_sens">sens</code></td>
<td>
<p> Sensitivity (between 0 and 1) </p>
</td></tr>
<tr><td><code id="SensSpec.demo_+3A_spec">spec</code></td>
<td>
<p> Specificity (between 0 and 1) </p>
</td></tr>
<tr><td><code id="SensSpec.demo_+3A_prev">prev</code></td>
<td>
<p> Prevalence (between 0 and 1) </p>
</td></tr>
<tr><td><code id="SensSpec.demo_+3A_n">n</code></td>
<td>
<p> Size of the virtual population (large round number) </p>
</td></tr>
<tr><td><code id="SensSpec.demo_+3A_step">step</code></td>
<td>
<p> which step of the process to display </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The common way to compute Positive Predictive Value (probability of
disease given a positive test (PPV)) and Negative Predictive Value
(probability of no disease given negative test (NPV)) is to use Bayes' rule
with the Sensitivity, Specificity, and Prevalence.
</p>
<p>This approach can be overwhelming to non-math types, so this
demonstration goes through the steps of assuming a virtual population, then
filling in a 2x2 table based on the population and given values of
Sensitivity, Specificity, and Prevalence.  PPV and NPV are then
computed from this table.  This approach is more intuitive to many
people.
</p>
<p>The function can be run multiple times with different values of
<code>step</code> to show the steps in building the table, then rerun with
different values to show how changes in the inputs affect the results.
</p>


<h3>Value</h3>

<p>An invisible matrix with the 2x2 table
</p>


<h3>Author(s)</h3>

<p> Greg Snow, <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

 <p><code><a href="#topic+roc.demo">roc.demo</a></code>, <code><a href="#topic+fagan.plot">fagan.plot</a></code>,
the various Epi packages, <code><a href="#topic+tkexamp">tkexamp</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>for(i in seq(1,11,2)) {
  SensSpec.demo(sens=0.95, spec=0.99, prev=0.01, step=i)
  if( interactive() ) {
    readline("Press Enter to continue")
  }
}
</code></pre>

<hr>
<h2 id='shadowtext'>Add text to a plot with a contrasting background.</h2><span id='topic+shadowtext'></span>

<h3>Description</h3>

<p>This is similar to the text function, but it also puts a background
shadow (outline) behind the text to make it stand out from the
background better.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shadowtext(x, y = NULL, labels, col = "white", bg = "black",
  theta = seq(pi/32, 2 * pi, length.out = 64), r = 0.1, 
  cex = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shadowtext_+3A_x">x</code></td>
<td>
<p>x-coordinates for the text</p>
</td></tr>
<tr><td><code id="shadowtext_+3A_y">y</code></td>
<td>
<p>y-coordinates for the text</p>
</td></tr>
<tr><td><code id="shadowtext_+3A_labels">labels</code></td>
<td>
<p>The text labels to plot</p>
</td></tr>
<tr><td><code id="shadowtext_+3A_col">col</code></td>
<td>
<p>Color of the text</p>
</td></tr>
<tr><td><code id="shadowtext_+3A_bg">bg</code></td>
<td>
<p>Color of the background shadow</p>
</td></tr>
<tr><td><code id="shadowtext_+3A_theta">theta</code></td>
<td>
<p>Angles for plotting the background</p>
</td></tr>
<tr><td><code id="shadowtext_+3A_r">r</code></td>
<td>
<p>Thickness of the shadow relative to plotting size</p>
</td></tr>
<tr><td><code id="shadowtext_+3A_cex">cex</code></td>
<td>
<p>Character expansion passed through to <code>text</code>  and used in computing text size.</p>
</td></tr>
<tr><td><code id="shadowtext_+3A_...">...</code></td>
<td>
<p>Additional arguments passed on to <code>text</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>When adding text to a plot it is possible that the color of the text
may make it difficult to see relative to its background.  If the text
spans different backgrounds then it may not be possible to find a
single color to give proper contrast.
</p>
<p>This function creates a contrasting shadow for the text by first
plotting several copies of the text at angles <code>theta</code> and
distance <code>r</code> in the background color, then plotting the text on
top.
</p>
<p>This gives a shadowing or outlining effect to the text making it
easier to read on any background.
</p>


<h3>Value</h3>

<p>This function is run for its side effects, returns NULL.
</p>


<h3>Author(s)</h3>

<p>Greg Snow, <a href="mailto:538280@gmail.com">538280@gmail.com</a>, with improvements by Thomas Danhorn</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+text">text</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(1:10, 1:10, bg='aliceblue')
 rect(3,3,5,8, col='navy')
 text(5,6, 'Test 1', col='lightsteelblue')
 shadowtext(5,4, 'Test 2', col='lightsteelblue')
</code></pre>

<hr>
<h2 id='sigma.test'> One sample Chi-square test for a population variance </h2><span id='topic+sigma.test'></span>

<h3>Description</h3>

<p>Compute the test of hypothesis and compute a confidence interval on the
variance of a population.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigma.test(x, sigma = 1, sigmasq = sigma^2,
  alternative = c("two.sided", "less", "greater"), conf.level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sigma.test_+3A_x">x</code></td>
<td>
<p> Vector of data values. </p>
</td></tr>
<tr><td><code id="sigma.test_+3A_sigma">sigma</code></td>
<td>
<p> Hypothesized standard deviation of the population. </p>
</td></tr>
<tr><td><code id="sigma.test_+3A_sigmasq">sigmasq</code></td>
<td>
<p> Hypothesized variance of the population. </p>
</td></tr>
<tr><td><code id="sigma.test_+3A_alternative">alternative</code></td>
<td>
<p> Direction of the alternative hypothesis. </p>
</td></tr>
<tr><td><code id="sigma.test_+3A_conf.level">conf.level</code></td>
<td>
<p> Confidence level for the interval computation. </p>
</td></tr>
<tr><td><code id="sigma.test_+3A_...">...</code></td>
<td>
<p> Additional arguments are silently ignored. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Many introductory statistical texts discuss inference on a single
population variance and introduce the chi-square test for a population
variance as another example of a hypothesis test that can be easily
derived.  Most statistical packages do not include the chi-square
test, perhaps because it is not used in practice very often, or
because the test is known to be highly sensitive to nonnormal
data. For the two-sample problem, see <code>var.test</code>. 
</p>


<h3>Value</h3>

<p>An object of class <code>htest</code> containing the results
</p>


<h3>Note</h3>

<p> This test is highly sensitive to nonnormality. </p>


<h3>Author(s)</h3>

<p> G. Jay Kerns <a href="mailto:gkerns@ysu.edu">gkerns@ysu.edu</a> </p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+var.test">var.test</a></code>, <code><a href="stats.html#topic+print.htest">print.htest</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(20, mean = 15, sd = 7)
sigma.test(x, sigma = 6)

</code></pre>

<hr>
<h2 id='simfun'>
Create a function to simulate data
</h2><span id='topic+simfun'></span>

<h3>Description</h3>

<p>This function is used to create a new function that will simulate data.
This could be used by a teacher to create homework or test conditions
that the students would then simulate data from (each student could have
their own unique data set) or this function could be used in simulations
for power or other values of interest. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simfun(expr, drop, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simfun_+3A_expr">expr</code></td>
<td>

<p>This is an expression, usually just one or more statements, that will
generate the simulated data. 
</p>
</td></tr>
<tr><td><code id="simfun_+3A_drop">drop</code></td>
<td>

<p>A character vector of names of objects/columns that will be dropped from
the return value.  These are usually intermediate objects or parameter
values that you don't want carried into the final returned object. 
</p>
</td></tr>
<tr><td><code id="simfun_+3A_...">...</code></td>
<td>

<p>Additional named items that will be in the environment when <code>expr</code>
is evaluated. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates another function to simulate data.  You supply
the general ideas of the simulation to this function and the resulting
function can then be used to create simulated datasets.  The resulting
function can then be given to students for them to simulate datasets,
or used localy as part of larger simulations. 
</p>
<p>The environment where the expression is evaluated will have all the
columns or elements of the <code>data</code> argument available as well as
the <code>data</code> argument itself.  Any variables/parameters passed
through <code>...</code> in the original function will also be available.
You then supply the code based on those variables to create the
simulated data.  The names of any columns or parameters submitted as
part of <code>data</code> will need to match the code exactly (provide
specific directions to the users on what columns need to be named).
Rember that indexing using factors indexes based on the underlying
integers not the character representation.  See the examples for
details. 
</p>
<p>The resulting function can be saved and loaded/attached in different R
sessions (it is important to use <code>save</code> rather than something
like <code>dput</code> so that the environment of the function is
preserved). 
</p>
<p>The function includes an optional seed that will be used with the
<code><a href="#topic+char2seed">char2seed</a></code> function (if the seed is a character) so that
each student could use a unique but identifiable seed (such as their
name or something based on their name) so that each student will use a
different dataset, but the instructor will be able to generate the
exact same dataset to check answers. 
</p>
<p>The &quot;True&quot; parameters are hidden in the environment of the function so
the student will not see the &quot;true&quot; values by simply printing the
function.  However an intermediate level R programmer/user would be
able to extract the simulation parameters (but the correct homework or
test answer will not be the simulation parameters). 
</p>


<h3>Value</h3>

<p>The return value is a function that will generate simulated datasets.
The function will have 2 arguments, <code>data</code> and <code>seed</code>.  The
<code>data</code> argument can be either a data frame of the predictor
variables (study design) or a list of simulation parameters.  The
<code>seed</code> argument will be passed on to <code><a href="base.html#topic+set.seed">set.seed</a></code> if it
is numeric and <code><a href="#topic+char2seed">char2seed</a></code> if it is a character. 
</p>
<p>The return value of this function is a dataframe with the simulated data
and any explanitory variables passed to the function. 
</p>
<p>See the examples for how to use the result function.
</p>


<h3>Note</h3>

<p>This function was not designed for speed, if you are doing long
simulations then hand crafting the simulation function will probably
run quicker than one created using this function. 
</p>
<p>Like the prediction functions the data frame passed in as the data
argument will need to have exact names of the columns to match with
the code (including capitolization). 
</p>
<p>This function is different from the <code><a href="stats.html#topic+simulate">simulate</a></code> functions
in that it allows for different sample sizes, user specified
parameters, and different predictor variables. 
</p>


<h3>Author(s)</h3>

<p>Greg Snow, <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+set.seed">set.seed</a></code>, <code><a href="#topic+char2seed">char2seed</a></code>, <code><a href="base.html#topic+within">within</a></code>, <code><a href="stats.html#topic+simulate">simulate</a></code>, <code><a href="base.html#topic+save">save</a></code>, <code><a href="base.html#topic+load">load</a></code>, <code><a href="base.html#topic+attach">attach</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a function to simulate heights for a given dataset

simheight &lt;- simfun( {h &lt;- c(64,69); height&lt;-h[sex]+ rnorm(10,0,3)}, drop='h' )

my.df &lt;- data.frame(sex=factor(rep(c('Male','Female'),each=5)))
simdat &lt;- simheight(my.df)
t.test(height~sex, data=simdat)

# a more general version, and have the expression predefined
# (note that this assumes that the levels are Female, Male in that order)

myexpr &lt;- quote({
  n &lt;- length(sex)
  h &lt;- c(64,69)
  height &lt;- h[sex] + rnorm(n,0,3)
})

simheight &lt;- simfun(eval(myexpr), drop=c('n','h'))
my.df &lt;- data.frame(sex=factor(sample(rep(c('Male','Female'),c(5,10)))))
(simdat &lt;- simheight(my.df))

# similar to above, but use named parameter vector and index by names

myexpr &lt;- quote({
  n &lt;- length(sex)
  height &lt;- h[ as.character(sex)] + rnorm(n,0,sig)
})

simheight &lt;- simfun(eval(myexpr), drop=c('n','h','sig'), 
  h=c(Male=69,Female=64), sig=3)
my.df &lt;- data.frame(sex=factor(sample(c('Male','Female'),100, replace=TRUE)))
(simdat &lt;- simheight(my.df, seed='example'))

# Create a function to simulate Sex and Height for a given sample size 
# (actually it will generate n males and n females for a total of 2*n samples)
# then use it in a set of simulations
simheight &lt;- simfun( {sex &lt;- factor(rep(c('Male','Female'),each=n))
                      height &lt;- h[sex] + rnorm(2*n,0,s)
                      }, drop=c('h','n'), h=c(64,69), s=3)
(simdat &lt;- simheight(list(n=10)))

out5  &lt;- replicate(1000, t.test(height~sex, data=simheight(list(n= 5)))$p.value)
out15 &lt;- replicate(1000, t.test(height~sex, data=simheight(list(n=15)))$p.value)

mean(out5  &lt;= 0.05)
mean(out15 &lt;= 0.05)

# use a fixed population

simstate &lt;- simfun({
  tmp &lt;- state.df[as.character(State),]
  Population &lt;- tmp[['Population']]
  Income &lt;- tmp[['Income']]
  Illiteracy &lt;- tmp[['Illiteracy']]
}, state.df=as.data.frame(state.x77), drop=c('tmp','state.df'))
simstate(data.frame(State=sample(state.name,10)))

# Use simulation, but override setting the seed

simheight &lt;- simfun({
  set.seed(1234)
  h &lt;- c(64,69)
  sex &lt;- factor(rep(c('Female','Male'),each=50))
  height &lt;- round(rnorm(100, rep(h,each=50),3),1)
  sex &lt;- sex[ID]
  height &lt;- height[ID]
}, drop='h')
(newdat &lt;- simheight(list(ID=c(1:5,51:55))))
(newdat2&lt;- simheight(list(ID=1:10)))

# Using a fitted object

fit &lt;- lm(Fertility ~ . , data=swiss)
simfert &lt;- simfun({
  Fertility &lt;- predict(fit, newdata=data)
  Fertility &lt;- Fertility + rnorm(length(Fertility),0,summary(fit)$sigma)
}, drop=c('fit'), fit=fit)

tmpdat &lt;- as.data.frame(lapply(swiss[,-1], 
            function(x) round(runif(100, min(x), max(x)))))
names(tmpdat) &lt;- names(swiss)[-1]
fertdat &lt;- simfert(tmpdat)
head(fertdat)
rbind(coef(fit), coef(lm(Fertility~., data=fertdat)))

# simulate a nested mixed effects model
simheight &lt;- simfun({
  n.city &lt;- length(unique(city))
  n.state &lt;- length(unique(state))
  n &lt;- length(city)
  height &lt;- h[sex] + rnorm(n.state,0,sig.state)[state] + 
    rnorm(n.city,0,sig.city)[city] + rnorm(n,0,sig.e)
}, sig.state=1, sig.city=0.5, sig.e=3, h=c(64,69),
  drop=c('sig.state','sig.city','sig.e','h','n.city','n.state','n'))

tmpdat &lt;- data.frame(state=gl(5,20), city=gl(10,10), 
  sex=gl(2,5,length=100, labels=c('F','M')))
heightdat &lt;- simheight(tmpdat)

# similar to above, but include cost information, this assumes that 
# each new state costs $100, each new city is $10, and each subject is $1
# this shows 2 possible methods

simheight &lt;- simfun({
  n.city &lt;- length(unique(city))
  n.state &lt;- length(unique(state))
  n &lt;- length(city)
  height &lt;- h[sex] + rnorm(n.state,0,sig.state)[state] + 
    rnorm(n.city,0,sig.city)[city] + rnorm(n,0,sig.e)
  cost &lt;- 100 * (!duplicated(state)) + 10*(!duplicated(city)) + 1
  cat('The total cost for this design is $', 100*n.state+10*n.city+1*n, 
  '\n', sep='')
}, sig.state=1, sig.city=0.5, sig.e=3, h=c(64,69),
  drop=c('sig.state','sig.city','sig.e','h','n.city','n.state','n'))

tmpdat &lt;- data.frame(state=gl(5,20), city=gl(10,10), 
  sex=gl(2,5,length=100, labels=c('F','M')))
heightdat &lt;- simheight(tmpdat)
sum(heightdat$cost)


# another mixed model method

simheight &lt;- simfun({
  state &lt;- gl(n.state, n/n.state)
  city &lt;- gl(n.city*n.state, n/n.city/n.state)
  sex &lt;- gl(2, n.city, length=n, labels=c('F','M') )
  height &lt;- h[sex] + rnorm(n.state,0,sig.state)[state] + 
    rnorm(n.city*n.state,0,sig.city)[city] + rnorm(n,0,sig.e)
}, drop=c('n.state','n.city','n','sig.city','sig.state','sig.e','h'))

heightdat &lt;- simheight( list(
  n.state=5, n.city=2, n=100, sig.state=10, sig.city=3, sig.e=1, h=c(64,69)
))

</code></pre>

<hr>
<h2 id='slider'>slider / button control widgets</h2><span id='topic+slider'></span>

<h3>Description</h3>

<p><code>slider</code> constructs a Tcl/Tk-widget with sliders and buttons
automated calculation and plotting. For example slider allows complete
all axes rotation of objects in a plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slider(sl.functions, sl.names, sl.mins, sl.maxs, sl.deltas, sl.defaults,
but.functions, but.names, no, set.no.value, obj.name, obj.value,
reset.function, title) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slider_+3A_sl.functions">sl.functions</code></td>
<td>
<p>set of functions or function connected to the slider(s)</p>
</td></tr>
<tr><td><code id="slider_+3A_sl.names">sl.names</code></td>
<td>
<p>labels of the sliders</p>
</td></tr>
<tr><td><code id="slider_+3A_sl.mins">sl.mins</code></td>
<td>
<p>minimum values of the sliders' ranges</p>
</td></tr>
<tr><td><code id="slider_+3A_sl.maxs">sl.maxs</code></td>
<td>
<p>maximum values of the sliders' ranges</p>
</td></tr>
<tr><td><code id="slider_+3A_sl.deltas">sl.deltas</code></td>
<td>
<p>change of step per click</p>
</td></tr>
<tr><td><code id="slider_+3A_sl.defaults">sl.defaults</code></td>
<td>
<p>default values for the sliders</p>
</td></tr>
<tr><td><code id="slider_+3A_but.functions">but.functions</code></td>
<td>
<p>function or list of functions
that are assigned to the button(s)</p>
</td></tr>
<tr><td><code id="slider_+3A_but.names">but.names</code></td>
<td>
<p>labels of the buttons</p>
</td></tr>
<tr><td><code id="slider_+3A_no">no</code></td>
<td>
<p><code>slider(no=i)</code> requests slider <code>i</code></p>
</td></tr>
<tr><td><code id="slider_+3A_set.no.value">set.no.value</code></td>
<td>
<p><code>slider(set.no.value=c(i,val))</code> sets slider <code>i</code> to value <code>val</code></p>
</td></tr>
<tr><td><code id="slider_+3A_obj.name">obj.name</code></td>
<td>
<p><code>slider(obj.name=name)</code> requests the value of
variable <code>name</code> from environment <code>slider.env</code></p>
</td></tr>
<tr><td><code id="slider_+3A_obj.value">obj.value</code></td>
<td>
<p><code>slider(obj.name=name,obj.value=value)</code> assigns <code>value</code>
to variable <code>name</code> in environment <code>slider.env</code></p>
</td></tr>
<tr><td><code id="slider_+3A_reset.function">reset.function</code></td>
<td>
<p>function that comprises the commands of the
<code>reset.button</code></p>
</td></tr>
<tr><td><code id="slider_+3A_title">title</code></td>
<td>
<p>title of the control window</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With slider you can:
a. define (multiple) sliders and buttons,
b. request or set slider values, and
c. request or set variables in the environment <code>slider.env</code>.
Slider function management takes place in the
environment <code>slider.env</code>. If <code>slider.env</code>
is not found it is generated.
</p>
<p>Definition: ... of sliders: First of all you have to define sliders, buttons and the attributes of them.
Sliders are established by six arguments:
<code>sl.functions, sl.names, sl.minima, sl.maxima,sl.deltas</code>, and <code>sl.defaults</code>.
The first argument,
<code>sl.functions</code>, is either a list of functions or a single function that
entails the commands for the sliders.
If there are three sliders and slider 2 is moved with the mouse the function stored in
<code>sl.functions[[2]]</code> (or in case of one function for all sliders the function <code>sl.functions</code>)
is called.
</p>
<p>Definition:  ... of buttons: Buttons are defined by a vector of labels <code>but.names</code> and a list of functions:
<code>but.functions</code>. If button <code>i</code> is pressed the function stored in <code>but.functions[[i]]</code> is called.
</p>
<p>Requesting: ... a slider:
<code>slider(no=1)</code> returns the actual value of slider 1,
<code>slider(no=2)</code> returns the value of slider 2, etc.
You are allowed to include expressions of the type
<code>slider(no=i)</code> in functions describing the effect of
sliders or buttons.
</p>
<p>Setting: ... a slider: <code>slider(set.no.value=c(2,333))</code> sets slider <code>2</code> to value 333.
<code>slider(set.no.value=c(i,value))</code> can be included in the functions
defining the effects of moving sliders or pushing buttons.
</p>
<p>Variables: ... of the environment <code>slider.env</code>: Sometimes information
has to be trransferred back and forth between functions defining the effects of sliders and buttons.
Imagine for example two sliders: one to control <code>p</code> and another one to control <code>q</code>,
but they should satisfy: <code>p+q=1</code>. Consequently, you have to correct the value of the first slider
after the second one was moved. To prevent the creation of  global
variables store them in the environment <code>slider.env</code>.
Use <code>slider(obj.name="p.save",obj.value=1-slider(no=2))</code>
to assign value  <code>1-slider(no=2)</code> to the variable <code>p.save</code> .
<code>slider(obj.name=p.save)</code> returns the value of variable <code>p.save</code>.
</p>


<h3>Value</h3>

<p>Using <code>slider</code> in definition mode <code>slider</code> returns the value of new created the top level widget.
<code>slider(no=i)</code> returns the actual value of slider <code>i</code>.
<code>slider(obj.name=name)</code> returns the value of variable <code>name</code> in environment <code>slider.env</code>.
</p>


<h3>Note</h3>

<p>You can move the slider in 3 different ways:  You can left click
and drag the slider itself, you can left click in the trough to either
side of the slider and the slider will move 1 unit in the direction
you clicked, or you can right click in the trough and the slider will
jump to the location you clicked at.
</p>
<p>This function may not stay in this package (consider it
semi-depricated), the original of the slider function is in the relax
package and can be used from there.  In TeachingDemos the
<code><a href="#topic+tkexamp">tkexamp</a></code>
function is taking the place of <code>slider</code> and gives a possibly
more general approach.
</p>


<h3>Author(s)</h3>

<p>Hans Peter Wolf</p>


<h3>See Also</h3>

<p><code><a href="#topic+tkexamp">tkexamp</a></code>, <code><a href="#topic+sliderv">sliderv</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
# example 1, sliders only
## Not run: 
## This example cannot be run by examples() but should work in an interactive R session
plot.sample.norm&lt;-function(){
 refresh.code&lt;-function(...){
   mu&lt;-slider(no=1); sd&lt;-slider(no=1); n&lt;-slider(no=3)
   x&lt;-rnorm(n,mu,sd)
   plot(x)
 }
 slider(refresh.code,sl.names=c("value of mu","value of sd","n number of observations"),
       sl.mins=c(-10,.01,5),sl.maxs=c(+10,50,100),sl.deltas=c(.01,.01,1),sl.defaults=c(0,1,20))
}
plot.sample.norm()

## End(Not run)

# example 2, sliders and buttons
## Not run: 
## This example cannot be run by examples() but should work in an interactive R session
plot.sample.norm.2&lt;-function(){
 refresh.code&lt;-function(...){
   mu&lt;-slider(no=1); sd&lt;-slider(no=2); n&lt;-slider(no=3)
   type=  slider(obj.name="type")
   x&lt;-rnorm(n,mu,sd)
   plot(seq(x),x,ylim=c(-20,20),type=type)
 }
 slider(refresh.code,sl.names=c("value of mu","value of sd","n number of observations"),
       sl.mins=c(-10,.01,5),sl.maxs=c(10,10,100),sl.deltas=c(.01,.01,1),sl.defaults=c(0,1,20),
       but.functions=list(
              function(...){slider(obj.name="type",obj.value="l");refresh.code()},
              function(...){slider(obj.name="type",obj.value="p");refresh.code()},
              function(...){slider(obj.name="type",obj.value="b");refresh.code()}
       ),
       but.names=c("lines","points","both"))
  slider(obj.name="type",obj.value="l")
}
plot.sample.norm.2()

## End(Not run)

# example 3, dependent sliders
## Not run: 
## This example cannot be run by examples() but should work in an interactive R session
print.of.p.and.q&lt;-function(){
 refresh.code&lt;-function(...){
   p.old&lt;-slider(obj.name="p.old")
   p&lt;-slider(no=1); if(abs(p-p.old)&gt;0.001) {slider(set.no.value=c(2,1-p))}
   q&lt;-slider(no=2); if(abs(q-(1-p))&gt;0.001) {slider(set.no.value=c(1,1-q))}
   slider(obj.name="p.old",obj.value=p)
   cat("p=",p,"q=",1-p,"\n")
 }
 slider(refresh.code,sl.names=c("value of p","value of q"),
       sl.mins=c(0,0),sl.maxs=c(1,1),sl.deltas=c(.01,.01),sl.defaults=c(.2,.8))
 slider(obj.name="p.old",obj.value=slider(no=1))
}
print.of.p.and.q()

## End(Not run)

# example 4, rotating a surface
## Not run: 
## This example cannot be run by examples() but should work in an interactive R session
R.veil.in.the.wind&lt;-function(){
  # Mark Hempelmann / Peter Wolf
  par(bg="blue4", col="white", col.main="white",
      col.sub="white", font.sub=2, fg="white") # set colors and fonts
  samp  &lt;- function(N,D) N*(1/4+D)/(1/4+D*N)
  z&lt;-outer(seq(1, 800, by=10), seq(.0025, 0.2, .0025)^2/1.96^2, samp) # create 3d matrix
  h&lt;-100
  z[10:70,20:25]&lt;-z[10:70,20:25]+h; z[65:70,26:45]&lt;-z[65:70,26:45]+h
  z[64:45,43:48]&lt;-z[64:45,43:48]+h; z[44:39,26:45]&lt;-z[44:39,26:45]+h
  x&lt;-26:59; y&lt;-11:38; zz&lt;-outer(x,y,"+"); zz&lt;-zz*(65&lt;zz)*(zz&lt;73)
  cz&lt;-10+col(zz)[zz&gt;0];rz&lt;-25+row(zz)[zz&gt;0]; z[cbind(cz,rz)]&lt;-z[cbind(cz,rz)]+h
  refresh.code&lt;-function(...){
    theta&lt;-slider(no=1); phi&lt;-slider(no=2)
    persp(x=seq(1,800,by=10),y=seq(.0025,0.2,.0025),z=z,theta=theta,phi=phi,
          scale=T, shade=.9, box=F, ltheta = 45,
          lphi = 45, col="aquamarine", border="NA",ticktype="detailed")
  }
  slider(refresh.code, c("theta", "phi"), c(0, 0),c(360, 360),c(.2, .2),c(85, 270)  )
}
R.veil.in.the.wind()

## End(Not run)



</code></pre>

<hr>
<h2 id='sliderv'> Create a Tk slider window </h2><span id='topic+sliderv'></span>

<h3>Description</h3>

<p>Create a Tk slider window with the sliders positioned vertically
instead of horizontally.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sliderv(refresh.code, names, minima, maxima, resolutions, starts,
  title = "control", no = 0, set.no.value = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sliderv_+3A_refresh.code">refresh.code</code></td>
<td>
<p> Function to be called when sliders are moved. </p>
</td></tr>
<tr><td><code id="sliderv_+3A_names">names</code></td>
<td>
<p> Labels for the sliders. </p>
</td></tr>
<tr><td><code id="sliderv_+3A_minima">minima</code></td>
<td>
<p> Vector of minimum values for the sliders. </p>
</td></tr>
<tr><td><code id="sliderv_+3A_maxima">maxima</code></td>
<td>
<p> Vector of maximum values for the sliders. </p>
</td></tr>
<tr><td><code id="sliderv_+3A_resolutions">resolutions</code></td>
<td>
<p> Vector of resolutions for the sliders. </p>
</td></tr>
<tr><td><code id="sliderv_+3A_starts">starts</code></td>
<td>
<p> Vector of starting values for the sliders. </p>
</td></tr>
<tr><td><code id="sliderv_+3A_title">title</code></td>
<td>
<p> Title to put at the top of the Tk box. </p>
</td></tr>
<tr><td><code id="sliderv_+3A_no">no</code></td>
<td>
<p> The number of the slider whose value you want. </p>
</td></tr>
<tr><td><code id="sliderv_+3A_set.no.value">set.no.value</code></td>
<td>
<p> Vector of length 2 with the number of slider to
set and the new value. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a variation on the <code>slider</code> function with vertical sliders
arranged in a row rather than horizontal sliders arranged in a column.
</p>
<p>This is based on an early version of <code>slider</code> and therefore does
not have as many bells and whistles (but sometimes fits the screen better).
</p>


<h3>Value</h3>

<p>Returns the value of a given slider when used as: <code>slider(no=i)</code>.
</p>


<h3>Note</h3>

<p>You can move the slider in 3 different ways:  You can left click
and drag the slider itself, you can left click in the trough to either
side of the slider and the slider will move 1 unit in the direction
you clicked, or you can right click in the trough and the slider will
jump to the location you clicked at.
</p>
<p>This function may not stay in this package (consider it
semi-depricated).  See the <code><a href="#topic+tkexamp">tkexamp</a></code> function for another
approach to do the same thing.
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

 <p><code><a href="#topic+tkexamp">tkexamp</a></code>, <code><a href="#topic+slider">slider</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
face.refresh &lt;- function(...){
	vals &lt;- sapply(1:15, function(x) slider(no=x))
	faces( rbind(0, vals, 1), scale=F)
}

sliderv( face.refresh, as.character(1:15), rep(0,15), rep(1,15),
	rep(0.05, 15), rep(0.5,15), title='Face Demo')
}
</code></pre>

<hr>
<h2 id='SnowsCorrectlySizedButOtherwiseUselessTestOfAnything'>
Snow's Correctly Sized But Otherwise Useless Test of Anything
</h2><span id='topic+SnowsCorrectlySizedButOtherwiseUselessTestOfAnything'></span>

<h3>Description</h3>

<p>This is a hypothesis test designed to be correctly sized in that the
probability of rejecting the null when it is true will be equal to your
alpha level.  Other than that it is a pretty useless test mainly
intended for when people say something like &quot;I just need a p-value&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SnowsCorrectlySizedButOtherwiseUselessTestOfAnything(x,
  data.name = deparse(substitute(x)),
  alternative = "You Are Lucky", ..., seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SnowsCorrectlySizedButOtherwiseUselessTestOfAnything_+3A_x">x</code></td>
<td>
<p> The data, or nothing, or something equally irrelevant</p>
</td></tr>
<tr><td><code id="SnowsCorrectlySizedButOtherwiseUselessTestOfAnything_+3A_data.name">data.name</code></td>
<td>
<p> The name of  the data for the output</p>
</td></tr>
<tr><td><code id="SnowsCorrectlySizedButOtherwiseUselessTestOfAnything_+3A_alternative">alternative</code></td>
<td>
<p>The phrase for the alternate hypothesis in the output</p>
</td></tr>
<tr><td><code id="SnowsCorrectlySizedButOtherwiseUselessTestOfAnything_+3A_...">...</code></td>
<td>
<p> Additional arguments that will be silently ignored (like
<code>x</code>), future versions may mockingly ignore these instead</p>
</td></tr>
<tr><td><code id="SnowsCorrectlySizedButOtherwiseUselessTestOfAnything_+3A_seed">seed</code></td>
<td>
<p> A seed (numeric or character) used to seed the random
number generator.  Use this or manually set the seed if you want
reproducible (but still meaningless) results</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Some of the advantages/disadvantages of this test include:
</p>

<ul>
<li><p>The probability of a Type I error is alpha
</p>
</li>
<li><p>Power can be easily computed (it is alpha)
</p>
</li>
<li><p>Power is independent of the sample size
</p>
</li>
<li><p>Power is independent of the hypotheses
</p>
</li>
<li><p>This test is not affected by missing data (present data
either)
</p>
</li>
<li><p>This test does not depend on any distributional or
independence assumptions
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class htest with the following elements:
</p>
<table>
<tr><td><code>p.value</code></td>
<td>
<p>The p-value</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>The test statistic (identical to the p-value)</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>The name of the data (if any)</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The name of the test</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a phrase representing the alternative hypothesis</p>
</td></tr>
<tr><td><code>seed</code></td>
<td>
<p>optionally the seed that was used</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If someone has suggested that you consider this test, they most likely
do not intend for you to actually use the test, rather to reconsider
your question or the assumptions that you are making or trying to
avoid.  This test should only be used to illustrate a point and
decisions (other than maybe who should pay for lunch) should never be
made based on the results of this test.
</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a>
</p>


<h3>References</h3>

<p>The author is unlikely to be willing to publish in any &quot;journal&quot; that
would be willing to publish this test.
</p>
<p>fortune(264)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+runif">runif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  SnowsCorrectlySizedButOtherwiseUselessTestOfAnything(log(rnorm(100)))
</code></pre>

<hr>
<h2 id='SnowsPenultimateNormalityTest'>
Test the uninteresting question of whether the data represents an
exact normal distribution.
</h2><span id='topic+SnowsPenultimateNormalityTest'></span>

<h3>Description</h3>

<p>This function tests the null hypothesis that the data comes from an
exact normal population.  This is a much less interesting/useful null
than what people usually want, which is to know if the data come from
a distribution that is similar enough to the normal to use normal
theory inference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SnowsPenultimateNormalityTest(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SnowsPenultimateNormalityTest_+3A_x">x</code></td>
<td>
<p> The data </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The theory for this test is based on the probability of getting a
rational number from a truly continuous distribution defined on the
reals.
</p>
<p>The main goal of this test is to quickly give a p-value for those that
feel it necessary to test the uninteresting and uninformative null
hypothesis that the data represents an exact normal, and allows the
user to then move on to much more important questions, like &quot;is the
data close enough to the normal to use normal theory inference?&quot;.
</p>
<p>After running this test (or better instead of running this and any
other test of normality) you should ask yourself what it means to test
for normality and why you would want to do so.  Then plot the data and
explore the interesting/useful questions.
</p>


<h3>Value</h3>






<p>An object of class &quot;htest&quot; with components:
</p>
<table>
<tr><td><code>p.value</code></td>
<td>
<p>The p-value</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a string representing the alternative hypothesis</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a string describing the method</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a string describing the name of the data</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Note: if you just use this function and report the p-value then the
function has failed in its purpose.  If this function helps you to think
about your analysis and what question(s) you are really interested in,
create meaningful plots, and focus on the more meaningful parts of
research, then it has succeeded.  See also Cochrane's Aphorism.
</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a>
</p>


<h3>References</h3>

<p><code>fortune(234)</code>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+qqnorm">qqnorm</a></code>, <code><a href="#topic+vis.test">vis.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>SnowsPenultimateNormalityTest(rt(100,25))
</code></pre>

<hr>
<h2 id='spread.labs'> Spread out close points for labeling in plots </h2><span id='topic+spread.labs'></span>

<h3>Description</h3>

<p>This function takes as set of coordinates and spreads out the close
values so that they can be used in labeling plots without overlapping.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spread.labs(x, mindiff, maxiter = 1000, stepsize = 1/10, min = -Inf, max = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spread.labs_+3A_x">x</code></td>
<td>
<p> The coordinate values (x or y, not both) to spread out. </p>
</td></tr>
<tr><td><code id="spread.labs_+3A_mindiff">mindiff</code></td>
<td>
<p> The minimum distance between return values </p>
</td></tr>
<tr><td><code id="spread.labs_+3A_maxiter">maxiter</code></td>
<td>
<p> The maximum number of iterations </p>
</td></tr>
<tr><td><code id="spread.labs_+3A_stepsize">stepsize</code></td>
<td>
<p> How far to move values in each iteration </p>
</td></tr>
<tr><td><code id="spread.labs_+3A_min">min</code></td>
<td>
<p> Minimum bound for returned values </p>
</td></tr>
<tr><td><code id="spread.labs_+3A_max">max</code></td>
<td>
<p> Maximum bound for returned values </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sometimes the desired locations for labels in plots results in the
labels overlapping.  This function takes the coordinate values (x or
y, not both) and finds those points that are less than <code>mindiff</code>
(usually a function of <code>strheight</code> or <code>strwidth</code>) apart and
increases the space between them (by <code>stepsize</code> *
<code>mindiff</code>).  This may or may not be enough and moving some points
away from their nearest neighbor may move them too close to another
neighbor, so the process is iterated until either <code>maxiter</code> steps
have been tried, or all the values are at least <code>mindiff</code> apart.
</p>
<p>The <code>min</code> and <code>max</code> arguments prevent the values from going
outside that range (they should be specified such that the original
values are all inside the range).
</p>
<p>The values do not need to be presorted.
</p>


<h3>Value</h3>

<p>A vector of coordinates (order corresponding to the original <code>x</code>)
that can be used as a replacement for <code>x</code> in placing labels.
</p>


<h3>Author(s)</h3>

<p> Greg Snow, <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

 <p><code><a href="graphics.html#topic+text">text</a></code>, the <code>spread.labels</code> function in the
<code>plotrix</code> package. </p>


<h3>Examples</h3>

<pre><code class='language-R'># overlapping labels
plot(as.integer(state.region), state.x77[,1], ylab='Population',
	xlab='Region',xlim=c(1,4.75), xaxt='n')
axis(1, at=1:4, lab=levels(state.region) )

text( as.integer(state.region)+.5, state.x77[,1], state.abb )
segments( as.integer(state.region)+0.025, state.x77[,1],
		as.integer(state.region)+.375, state.x77[,1] )

# now lets redo the plot without overlap

tmp.y &lt;- state.x77[,1]
for(i in levels(state.region) ) {
  tmp &lt;- state.region == i
  tmp.y[ tmp ] &lt;- spread.labs( tmp.y[ tmp ], 1.2*strheight('A'),
	maxiter=1000, min=0 )
}

plot(as.integer(state.region), state.x77[,1], ylab='Population',
	xlab='Region', xlim=c(1,4.75), xaxt='n')
axis(1, at=1:4, lab=levels(state.region) )

text( as.integer(state.region)+0.5, tmp.y, state.abb )
segments( as.integer(state.region)+0.025, state.x77[,1],
		as.integer(state.region)+0.375, tmp.y )
</code></pre>

<hr>
<h2 id='squishplot'>Squish the plotting area to a specified aspect ratio </h2><span id='topic+squishplot'></span>

<h3>Description</h3>

<p>Adjusts the plotting area to a specific aspect ratio.  This is
different from using the <code>asp</code> argument in that it puts the extra
space in the margins rather than inside the plotting region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>squishplot(xlim, ylim, asp = 1, newplot=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="squishplot_+3A_xlim">xlim</code></td>
<td>
<p> The x limits of the plot, or the entire x vector.</p>
</td></tr>
<tr><td><code id="squishplot_+3A_ylim">ylim</code></td>
<td>
<p> The y limits of the plot, or the entire y vector.</p>
</td></tr>
<tr><td><code id="squishplot_+3A_asp">asp</code></td>
<td>
<p> The y/x aspect ratio.</p>
</td></tr>
<tr><td><code id="squishplot_+3A_newplot">newplot</code></td>
<td>
<p> Should plot.new() be called before making the
calculations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function sets the plot area of the current graph device so that
the following plot command will plot with the specified aspect ratio.
</p>
<p>This is different from using the <code>asp</code> argument to
<code>plot.default</code> in where the created white space goes (see the
example).  Using <code>plot.default</code> will place the whitespace within
the plotting region and can result in the axes and annotations being
quite far from the actual data.  This command sets up the plotting
region so that the extra whitespace is in the margin areas and moves
the axes and annotations close to the data.
</p>
<p>Any other desired parameter settings or resizing of the graphics
device should be set before calling
<code>squishplot</code>, especially settings dealing with multiple figures
or margin areas.
</p>
<p>After plotting, the parameters need to be reset or later plots may
come out wrong.
</p>


<h3>Value</h3>

<p>Invisible list containing the '<code>plt</code>' values from <code>par</code> that
were in place before the call to <code>squishplot</code> that can be used to
reset the graphical parameters after plotting is finished.
</p>


<h3>Note</h3>

<p>Remember to set other graphical parameters, then call
<code>squishplot</code>, then call the plotting function(s), then reset the
parameters.
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

 <p><code><a href="graphics.html#topic+plot.default">plot.default</a></code>, <code><a href="graphics.html#topic+plot.window">plot.window</a></code>,
<code><a href="graphics.html#topic+par">par</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(25, 10, 2 )
y &lt;- 5 + 1.5*x + rnorm(25,0,2)

par(mfrow=c(1,3))
plot(x,y)

op &lt;- squishplot(x,y,1)
plot(x,y)
par(op)

plot(x,y, asp=1)
</code></pre>

<hr>
<h2 id='steps'>
Steps data
</h2><span id='topic+steps'></span>

<h3>Description</h3>

<p>This is the export from a pedometer worn for nearly about 11 months by
the package author.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(steps)</code></pre>


<h3>Format</h3>

<p>A data frame with 331 observations on the following 79 variables.
</p>

<dl>
<dt><code>Date</code></dt><dd><p>The Date for the given data</p>
</dd>
<dt><code>Total.Steps</code></dt><dd><p>Total Steps recorded for the day</p>
</dd>
<dt><code>Aerobic.Steps</code></dt><dd><p>Total Aerobic Steps recorded for the day (see below)</p>
</dd>
<dt><code>Aerobic.Walking.Time</code></dt><dd><p>Time spent in aerobic walking for
the day</p>
</dd>
<dt><code>Calories</code></dt><dd><p>Estimated calories burned for the day</p>
</dd>
<dt><code>Distance</code></dt><dd><p>Estimated distance walked for the day in miles</p>
</dd>
<dt><code>Fat.Burned</code></dt><dd><p>Estimated grams of fat burned by walking</p>
</dd>
<dt><code>Steps.12AM</code></dt><dd><p>Steps recorded between Midnight and 1 am</p>
</dd>
<dt><code>Steps.1AM</code></dt><dd><p>Steps recorded between 1 am and 2 am</p>
</dd>
<dt><code>Steps.2AM</code></dt><dd><p>Steps recorded between 2 am and 3 am</p>
</dd>
<dt><code>Steps.3AM</code></dt><dd><p>Steps recorded between 3 am and 4 am</p>
</dd>
<dt><code>Steps.4AM</code></dt><dd><p>Steps recorded between 4 am and 5 am</p>
</dd>
<dt><code>Steps.5AM</code></dt><dd><p>Steps recorded between 5 am and 6 am</p>
</dd>
<dt><code>Steps.6AM</code></dt><dd><p>Steps recorded between 6 am and 7 am</p>
</dd>
<dt><code>Steps.7AM</code></dt><dd><p>Steps recorded between 7 am and 8 am</p>
</dd>
<dt><code>Steps.8AM</code></dt><dd><p>Steps recorded between 8 am and 9 am</p>
</dd>
<dt><code>Steps.9AM</code></dt><dd><p>Steps recorded between 9 am and 10 am</p>
</dd>
<dt><code>Steps.10AM</code></dt><dd><p>Steps recorded between 10 am and 11 am</p>
</dd>
<dt><code>Steps.11AM</code></dt><dd><p>Steps recorded between 11 am and Noon</p>
</dd>
<dt><code>Steps.12PM</code></dt><dd><p>Steps recorded between Noon and 1 pm</p>
</dd>
<dt><code>Steps.1PM</code></dt><dd><p>Steps recorded between 1 pm and 2 pm</p>
</dd>
<dt><code>Steps.2PM</code></dt><dd><p>Steps recorded between 2 pm and 3 pm</p>
</dd>
<dt><code>Steps.3PM</code></dt><dd><p>Steps recorded between 3 pm and 4 pm</p>
</dd>
<dt><code>Steps.4PM</code></dt><dd><p>Steps recorded between 4 pm and 5 pm</p>
</dd>
<dt><code>Steps.5PM</code></dt><dd><p>Steps recorded between 5 pm and 6 pm</p>
</dd>
<dt><code>Steps.6PM</code></dt><dd><p>Steps recorded between 6 pm and 7 pm</p>
</dd>
<dt><code>Steps.7PM</code></dt><dd><p>Steps recorded between 7 pm and 8 pm</p>
</dd>
<dt><code>Steps.8PM</code></dt><dd><p>Steps recorded between 8 pm and 9 pm</p>
</dd>
<dt><code>Steps.9PM</code></dt><dd><p>Steps recorded between 9 pm and 10 pm</p>
</dd>
<dt><code>Steps.10PM</code></dt><dd><p>Steps recorded between 10 pm and 11 pm</p>
</dd>
<dt><code>Steps.11PM</code></dt><dd><p>Steps recorded between 11 pm and Midnight</p>
</dd>
<dt><code>Aerobic.Steps.12AM</code></dt><dd><p>Aerobic steps recorded between
Midnight and 1 am</p>
</dd>
<dt><code>Aerobic.Steps.1AM</code></dt><dd><p>Aerobic steps recorded between 1 am
and 2 am</p>
</dd>
<dt><code>Aerobic.Steps.2AM</code></dt><dd><p>Aerobic steps recorded between 2 am
and 3 am</p>
</dd>
<dt><code>Aerobic.Steps.3AM</code></dt><dd><p>Aerobic steps recorded between 3 am
and 4 am</p>
</dd>
<dt><code>Aerobic.Steps.4AM</code></dt><dd><p>Aerobic steps recorded between 4 am
and 5 am</p>
</dd>
<dt><code>Aerobic.Steps.5AM</code></dt><dd><p>Aerobic steps recorded between 5 am
and 6 am</p>
</dd>
<dt><code>Aerobic.Steps.6AM</code></dt><dd><p>Aerobic steps recorded between 6 am
and 7 am</p>
</dd>
<dt><code>Aerobic.Steps.7AM</code></dt><dd><p>Aerobic steps recorded between 7 am
and 8 am</p>
</dd>
<dt><code>Aerobic.Steps.8AM</code></dt><dd><p>Aerobic steps recorded between 8 am
and 9 am</p>
</dd>
<dt><code>Aerobic.Steps.9AM</code></dt><dd><p>Aerobic steps recorded between 9 am
and 10 am</p>
</dd>
<dt><code>Aerobic.Steps.10AM</code></dt><dd><p>Aerobic steps recorded between 10
am and 11 am</p>
</dd>
<dt><code>Aerobic.Steps.11AM</code></dt><dd><p>Aerobic steps recorded between 11
am and Noon</p>
</dd>
<dt><code>Aerobic.Steps.12PM</code></dt><dd><p>Aerobic steps recorded between Noon
and 1 pm</p>
</dd>
<dt><code>Aerobic.Steps.1PM</code></dt><dd><p>Aerobic steps recorded between 1 pm
and 2 pm</p>
</dd>
<dt><code>Aerobic.Steps.2PM</code></dt><dd><p>Aerobic steps recorded between 2 pm
and 3 pm</p>
</dd>
<dt><code>Aerobic.Steps.3PM</code></dt><dd><p>Aerobic steps recorded between 3 pm
and 4 pm</p>
</dd>
<dt><code>Aerobic.Steps.4PM</code></dt><dd><p>Aerobic steps recorded between 4 pm
and 5 pm</p>
</dd>
<dt><code>Aerobic.Steps.5PM</code></dt><dd><p>Aerobic steps recorded between 5 pm
and 6 pm</p>
</dd>
<dt><code>Aerobic.Steps.6PM</code></dt><dd><p>Aerobic steps recorded between 6 pm
and 7 pm</p>
</dd>
<dt><code>Aerobic.Steps.7PM</code></dt><dd><p>Aerobic steps recorded between 7 pm
and 8 pm</p>
</dd>
<dt><code>Aerobic.Steps.8PM</code></dt><dd><p>Aerobic steps recorded between 8 pm
and 9 pm</p>
</dd>
<dt><code>Aerobic.Steps.9PM</code></dt><dd><p>Aerobic steps recorded between 9 pm
and 10 pm</p>
</dd>
<dt><code>Aerobic.Steps.10PM</code></dt><dd><p>Aerobic steps recorded between 10
pm and 11 pm</p>
</dd>
<dt><code>Aerobic.Steps.11PM</code></dt><dd><p>Aerobic steps recorded between 11
pm and Midnight</p>
</dd>
<dt><code>Used.12AM</code></dt><dd><p>Any movement detected between Midnight and 1 am</p>
</dd>
<dt><code>Used.1AM</code></dt><dd><p>Any movement detected between 1 am and 2 am</p>
</dd>
<dt><code>Used.2AM</code></dt><dd><p>Any movement detected between 2 am and 3 am</p>
</dd>
<dt><code>Used.3AM</code></dt><dd><p>Any movement detected between 3 am and 4 am</p>
</dd>
<dt><code>Used.4AM</code></dt><dd><p>Any movement detected between 4 am and 5 am</p>
</dd>
<dt><code>Used.5AM</code></dt><dd><p>Any movement detected between 5 am and 6 am</p>
</dd>
<dt><code>Used.6AM</code></dt><dd><p>Any movement detected between 6 am and 7 am</p>
</dd>
<dt><code>Used.7AM</code></dt><dd><p>Any movement detected between 7 am and 8 am</p>
</dd>
<dt><code>Used.8AM</code></dt><dd><p>Any movement detected between 8 am and 9 am</p>
</dd>
<dt><code>Used.9AM</code></dt><dd><p>Any movement detected between 9 am and 10 am</p>
</dd>
<dt><code>Used.10AM</code></dt><dd><p>Any movement detected between 10 am and 11 am</p>
</dd>
<dt><code>Used.11AM</code></dt><dd><p>Any movement detected between 11 am and Noon</p>
</dd>
<dt><code>Used.12PM</code></dt><dd><p>Any movement detected between Noon and 1 pm</p>
</dd>
<dt><code>Used.1PM</code></dt><dd><p>Any movement detected between 1 pm and 2 pm</p>
</dd>
<dt><code>Used.2PM</code></dt><dd><p>Any movement detected between 2 pm and 3 pm</p>
</dd>
<dt><code>Used.3PM</code></dt><dd><p>Any movement detected between 3 pm and 4 pm</p>
</dd>
<dt><code>Used.4PM</code></dt><dd><p>Any movement detected between 4 pm and 5 pm</p>
</dd>
<dt><code>Used.5PM</code></dt><dd><p>Any movement detected between 5 pm and 6 pm</p>
</dd>
<dt><code>Used.6PM</code></dt><dd><p>Any movement detected between 6 pm and 7 pm</p>
</dd>
<dt><code>Used.7PM</code></dt><dd><p>Any movement detected between 7 pm and 8 pm</p>
</dd>
<dt><code>Used.8PM</code></dt><dd><p>Any movement detected between 8 pm and 9 pm</p>
</dd>
<dt><code>Used.9PM</code></dt><dd><p>Any movement detected between 9 pm and 10 pm</p>
</dd>
<dt><code>Used.10PM</code></dt><dd><p>Any movement detected between 10 pm and 11 pm</p>
</dd>
<dt><code>Used.11PM</code></dt><dd><p>Any movement detected between 11 pm and Midnight</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(steps)
## maybe str(steps) ; plot(steps) ...
</code></pre>

<hr>
<h2 id='stork'>
Neyman's Stork data
</h2><span id='topic+stork'></span>

<h3>Description</h3>

<p>Data invented by Neyman to look at spurious correlations and adjusting
for lurking variables by looking at the relationship between storks and biths.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(stork)</code></pre>


<h3>Format</h3>

<p>A data frame with 54 observations on the following 6 variables.
</p>

<dl>
<dt><code>County</code></dt><dd><p>ID of county</p>
</dd>
<dt><code>Women</code></dt><dd><p>Number of Women (*10,000)</p>
</dd>
<dt><code>No.storks</code></dt><dd><p>Number of Storks sighted</p>
</dd>
<dt><code>No.babies</code></dt><dd><p>Number of Babies Born</p>
</dd>
<dt><code>Stork.rate</code></dt><dd><p>Storks per 10,000 women (=No.storks/Women)</p>
</dd>
<dt><code>Birth.rate</code></dt><dd><p>Babies per 10,000 women (=No.babies/Women)</p>
</dd>
</dl>



<h3>Details</h3>

<p>This is an entertaining example to show a relationship that is due to a
third possibly lurking variable.  The source paper shows how completely
different relationships can be found by mis-analyzing the data.
</p>


<h3>Source</h3>

<p>Kronmal, Richard A. (1993) Spurious Cerrolation and the Fallacy of the
Ratio Standard Revisited. Journal of the Royal Statistical
Society. Series A, Vol. 156, No. 3, 379-392.
</p>


<h3>References</h3>

<p>Neyman, J. (1952) Lectures and Conferences on Mathematical Statistics
and Probability, 2nd edn, pp. 143-154. Washington DC: US Department of Agriculture.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(stork)
pairs(stork[,-1], panel=panel.smooth)
## maybe str(stork) ; plot(stork) ...
</code></pre>

<hr>
<h2 id='subplot'>Embed a new plot within an existing plot</h2><span id='topic+subplot'></span>

<h3>Description</h3>

<p>Subplot will embed a new plot within an existing plot at the
coordinates specified (in user units of the existing plot).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subplot(fun, x, y, size=c(1,1), vadj=0.5, hadj=0.5,
 inset=c(0,0), type=c('plt','fig'), pars=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subplot_+3A_fun">fun</code></td>
<td>
<p>an expression defining the new plot to be embedded.</p>
</td></tr>
<tr><td><code id="subplot_+3A_x">x</code></td>
<td>
<p><code>x</code>-coordinate(s) of the new plot (in user coordinates
of the existing plot), or a character string.</p>
</td></tr>
<tr><td><code id="subplot_+3A_y">y</code></td>
<td>
<p><code>y</code>-coordinate(s) of the new plot, <code>x</code> and <code>y</code>
can be specified in any of the ways understood by <code>xy.coords</code>.</p>
</td></tr>
<tr><td><code id="subplot_+3A_size">size</code></td>
<td>
<p>The size of the embedded plot in inches if <code>x</code> and
<code>y</code> have length 1.</p>
</td></tr>
<tr><td><code id="subplot_+3A_vadj">vadj</code></td>
<td>
<p>vertical adjustment of the plot when <code>y</code> is a scalar,
the default is to center vertically, 0 means place the bottom of the
plot at <code>y</code>, 1 places the top of the plot at <code>y</code>.</p>
</td></tr>
<tr><td><code id="subplot_+3A_hadj">hadj</code></td>
<td>
<p>horizontal adjustment of the plot when <code>x</code> is a
scalar, the default is to center horizontally, 0 means place the
left edge of the plot at <code>x</code>, and 1 means place the right edge
of the plot at <code>x</code>.</p>
</td></tr>
<tr><td><code id="subplot_+3A_inset">inset</code></td>
<td>
<p>1 or 2 numbers representing the proportion of the plot to
inset the subplot from edges when x is a character string.  The first
element is the horizontal inset, the second is the vertical inset.</p>
</td></tr>
<tr><td><code id="subplot_+3A_type">type</code></td>
<td>
<p>Character string, if 'plt' then the plotting region is
defined by <code>x</code>, <code>y</code>, and <code>size</code> with axes,
etc. outside that box; if 'fig' then all annotations are also inside
the box.</p>
</td></tr>
<tr><td><code id="subplot_+3A_pars">pars</code></td>
<td>
<p>a list of parameters to be passed to <code>par</code> before
running <code>fun</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The coordinates <code>x</code> and <code>y</code> can be scalars or vectors of
length 2.  If vectors of length 2 then they determine the opposite
corners of the rectangle for the embedded plot (and the parameters
<code>size</code>, <code>vadj</code>, and <code>hadj</code> are all ignored).
</p>
<p>If <code>x</code> and <code>y</code> are given as scalars then the plot position
relative to the point and the size of the plot will be determined by
the arguments <code>size</code>, <code>vadj</code>, and <code>hadj</code>.  The default
is to center a 1 inch by 1 inch plot at <code>x,y</code>.  Setting
<code>vadj</code> and <code>hadj</code> to <code>(0,0)</code> will position the lower
left corner of the plot at <code>(x,y)</code>.
</p>
<p>If <code>x</code> is a character string, then it will be parsed for the
strings &quot;left&quot;, &quot;right&quot;, &quot;top&quot;, and &quot;bottom&quot; and x and y will be set
appropriately (anything not specified will be set at the center in
that dimension) using also the <code>inset</code> argument.  This allows the
position of the subplot to be specified as 'topleft' or 'bottom', etc.
The <code>inset</code> argument is in proportion of the plot units, so 0.1
means inset 10% of the width/height of the plotting distance.  If
<code>hadj</code>/<code>vadj</code> are not specified, they will be set appropriately.
</p>
<p>The rectangle defined by <code>x</code>, <code>y</code>, <code>size</code>, <code>vadj</code>,
and <code>hadj</code> will be used as the plotting area of the new plot.
Any tick marks, axis labels, main and sub titles will be outside of
this rectangle if <code>type</code> is 'plt'.  If type is 'fig' then the
annotations will be inside the box.
</p>
<p>Any graphical parameter settings that you would like to be in place
before <code>fun</code> is evaluated can be specified in the <code>pars</code>
argument (warning: specifying layout parameters here (<code>plt</code>,
<code>mfrow</code>, etc.) may cause unexpected results).
</p>
<p>After the function completes the graphical parameters will have been
reset to what they were before calling the function (so you can
continue to augment the original plot).
</p>


<h3>Value</h3>

<p>An invisible list with the graphical parameters that were in effect
when the subplot was created.  Passing this list to <code>par</code> will
enable you to augment the embedded plot.
</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+grconvertX">grconvertX</a></code>, <code><a href="graphics.html#topic+par">par</a></code>,
<code><a href="graphics.html#topic+symbols">symbols</a></code>, <code><a href="#topic+my.symbols">my.symbols</a></code>, <code><a href="#topic+ms.image">ms.image</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># make an original plot
plot( 11:20, sample(51:60) )

# add some histograms

subplot( hist(rnorm(100)), 15, 55)
subplot( hist(runif(100),main='',xlab='',ylab=''), 11, 51, hadj=0, vadj=0)
subplot( hist(rexp(100, 1/3)), 20, 60, hadj=1, vadj=1, size=c(0.5,2) )
subplot( hist(rt(100,3)), c(12,16), c(57,59), pars=list(lwd=3,ask=FALSE) )

### some of the following examples work fine in an interactive session,
### but loading the packages required does not work well in testing.

# augment a map
if( interactive() &amp;&amp; require(spData) ){
	plot(state.vbm,fg=NULL)
	tmp &lt;- cbind( state.vbm$center_x, state.vbm$center_y )
	for( i in 1:50 ){
		tmp2 &lt;- as.matrix(USArrests[i,c(1,4)])
		tmp3 &lt;- max(USArrests[,c(1,4)])
		subplot( barplot(tmp2, ylim=c(0,tmp3),names=c('',''),yaxt='n'),
			x=tmp[i,1], y=tmp[i,2], size=c(.1,.1))
	}
}

tmp &lt;- rnorm(25)
qqnorm(tmp)
qqline(tmp)
tmp2 &lt;- subplot( hist(tmp,xlab='',ylab='',main=''),
		grconvertX(0.1,from='npc'), grconvertY(0.9,from='npc'), 
		vadj=1, hadj=0 )
abline(v=0, col='red') # wrong way to add a reference line to histogram

# right way to add a reference line to histogram
op &lt;- par(no.readonly=TRUE)
par(tmp2)
abline(v=0, col='green')
par(op)


# scatter-plot using images
if(interactive() &amp;&amp; require(png)) {

  image.png &lt;- function(x,...) {
    cols &lt;- rgb( x[,,1], x[,,2], x[,,3], x[,,4] )
    z &lt;- 1:length(cols)
    dim(z) &lt;- dim(x[,,1])
    z &lt;- t(z)
    z &lt;- z[ ,rev(seq_len(ncol(z))) ]
    image(z, col=cols, axes=FALSE, ...)
  }

  logo &lt;- readPNG(system.file("img", "Rlogo.png", package="png"))

  x &lt;- runif(10)
  y &lt;- runif(10)
  plot(x,y, type='n')
  for(i in 1:10) {
    subplot(image.png(logo), x[i], y[i], size=c(0.3,0.3))
  }
}

</code></pre>

<hr>
<h2 id='TeachingDemos-package'>
Various functions for demonstration and learning.
</h2><span id='topic+TeachingDemos-package'></span><span id='topic+TeachingDemos'></span>

<h3>Description</h3>

<p>This package provides various demonstrations that can be used in
classes or by individuals to better learn statistical concepts and
usage of R.  Various utility functions are also included</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
    Package: </td><td style="text-align: left;"> TeachingDemos</td>
</tr>
<tr>
 <td style="text-align: left;">
    Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
    License: </td><td style="text-align: left;"> Artistic-2.0</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p>Demonstration functions in this package include:
</p>

<table>
<tr>
 <td style="text-align: left;">
    ci.examp, run.ci.examp </td><td style="text-align: left;"> Confidence Interval Examples </td>
</tr>
<tr>
 <td style="text-align: left;">
    clt.examp </td><td style="text-align: left;"> Central Limit Theorem Example</td>
</tr>
<tr>
 <td style="text-align: left;">
    dice, plot.dice </td><td style="text-align: left;"> Roll and Plot dice (possibly loaded)</td>
</tr>
<tr>
 <td style="text-align: left;">
    faces, faces2 </td><td style="text-align: left;"> Chernoff face plots</td>
</tr>
<tr>
 <td style="text-align: left;">
    fagan.plot </td><td style="text-align: left;"> Fagan plot for screening designs</td>
</tr>
<tr>
 <td style="text-align: left;">
    lattice.demo </td><td style="text-align: left;"> The 3d slicing idea behind lattice/trellis
    graphics</td>
</tr>
<tr>
 <td style="text-align: left;">
    loess.demo </td><td style="text-align: left;"> Interactive demo to show ideas of loess smooths</td>
</tr>
<tr>
 <td style="text-align: left;">
    mle.demo </td><td style="text-align: left;"> Interactive demo of Maximum Likelihood Estimation</td>
</tr>
<tr>
 <td style="text-align: left;">
    plot.rgl.coin, plot.rgl.die </td><td style="text-align: left;"> Animate flipping a coin or rolling
    a die</td>
</tr>
<tr>
 <td style="text-align: left;">
    power.examp </td><td style="text-align: left;"> Demonstrate concepts of Power.</td>
</tr>
<tr>
 <td style="text-align: left;">
    put.points.demo </td><td style="text-align: left;"> Add/move points on a plot and see the effect on
    correlation and regression.</td>
</tr>
<tr>
 <td style="text-align: left;">
    roc.demo </td><td style="text-align: left;"> Interactive demo of ROC curves.</td>
</tr>
<tr>
 <td style="text-align: left;">
    rotate.cloud </td><td style="text-align: left;"> Interactively rotate 3d plots.</td>
</tr>
<tr>
 <td style="text-align: left;">
    run.cor.examp </td><td style="text-align: left;"> Show plots representing different
    correlations.</td>
</tr>
<tr>
 <td style="text-align: left;">
    run.hist.demo </td><td style="text-align: left;"> Interactively change parameters for
    histograms.</td>
</tr>
<tr>
 <td style="text-align: left;">
    SensSpec.demo </td><td style="text-align: left;"> Show relationship between Sensitivity,
    Specificity, Prevalence and PPV and NPV.</td>
</tr>
<tr>
 <td style="text-align: left;">
    TkApprox </td><td style="text-align: left;"> Interactive linear interpolations of data.</td>
</tr>
<tr>
 <td style="text-align: left;">
    tkBrush </td><td style="text-align: left;"> Brush points in a scatterplot matrix.</td>
</tr>
<tr>
 <td style="text-align: left;">
    TkSpline </td><td style="text-align: left;"> Interactive spline interpolations of data.</td>
</tr>
<tr>
 <td style="text-align: left;">
    tree.demo </td><td style="text-align: left;"> Interactively Recursive partition data (create
    trees).</td>
</tr>
<tr>
 <td style="text-align: left;">
    vis.binom </td><td style="text-align: left;"> Plot various probability distributions and
    interactively change parameters.</td>
</tr>
<tr>
 <td style="text-align: left;">
    vis.boxcox </td><td style="text-align: left;"> Interactively change lambda for Box Cox
    Transforms.</td>
</tr>
<tr>
 <td style="text-align: left;">
    z.test </td><td style="text-align: left;"> Z-test similar to t.test for students who have not
    learned t tests yet.</td>
</tr>
<tr>
 <td style="text-align: left;">
    Pvalue.norm.sim </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
    Pvalue.binom.sim </td><td style="text-align: left;"> Simulate P-values to see how they are
    distributed.</td>
</tr>
<tr>
 <td style="text-align: left;">
    run.Pvalue.norm.sim </td><td style="text-align: left;"> GUI for above. </td>
</tr>
<tr>
 <td style="text-align: left;">
    run.Pvalue.binom.sim </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
    HWidentify </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
    HTKidentify </td><td style="text-align: left;"> Identify the point Hovered over with the mouse. </td>
</tr>
<tr>
 <td style="text-align: left;">
    vis.test </td><td style="text-align: left;"> test a null hypothesis by comparing graphs. </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p>Utility functions include:
</p>

<table>
<tr>
 <td style="text-align: left;">
    bct </td><td style="text-align: left;"> Box-Cox Transforms.</td>
</tr>
<tr>
 <td style="text-align: left;">
    char2seed </td><td style="text-align: left;"> set or create the random number seed using a
    character string</td>
</tr>
<tr>
 <td style="text-align: left;">
    clipplot </td><td style="text-align: left;"> clip a plot to a rectangular region within the plot</td>
</tr>
<tr>
 <td style="text-align: left;">
    col2grey </td><td style="text-align: left;"> convert colors to greyscale</td>
</tr>
<tr>
 <td style="text-align: left;">
    cnvrt.coords </td><td style="text-align: left;"> Convert between the different coordinate
    systems</td>
</tr>
<tr>
 <td style="text-align: left;">
    dynIdentify </td><td style="text-align: left;"> Scatterplot with point labels that can be dragged
    to a new position </td>
</tr>
<tr>
 <td style="text-align: left;">
    TkIdentify </td><td style="text-align: left;"> Scatterplot with lables that can be dragged to new
    positions </td>
</tr>
<tr>
 <td style="text-align: left;">
    gp.plot gp.splot </td><td style="text-align: left;"> send commands to gnuplot</td>
</tr>
<tr>
 <td style="text-align: left;">
    hpd </td><td style="text-align: left;"> Highest Posterior Density intervals</td>
</tr>
<tr>
 <td style="text-align: left;">
    my.symbols </td><td style="text-align: left;"> Create plots using user defined symbols.</td>
</tr>
<tr>
 <td style="text-align: left;">
    panel.my.symbols </td><td style="text-align: left;"> Create lattice plots using user defined symbols.</td>
</tr>
<tr>
 <td style="text-align: left;">
    plot2script </td><td style="text-align: left;"> Create a script file that recreates the current
    plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
    shadowtext </td><td style="text-align: left;"> plot text with contrasting shadow for better
  readability. </td>
</tr>
<tr>
 <td style="text-align: left;">
    squishplot </td><td style="text-align: left;"> Set the margins so that a plot has a specific aspect
    ratio without large white space inside.</td>
</tr>
<tr>
 <td style="text-align: left;">
    spread.labs </td><td style="text-align: left;"> Spread out coordinates so that labels do not overlap.</td>
</tr>
<tr>
 <td style="text-align: left;">
    subplot </td><td style="text-align: left;"> create a plot inside of an existing plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
    tkexamp </td><td style="text-align: left;"> create plots that can have parameters adjusted
    interactively.</td>
</tr>
<tr>
 <td style="text-align: left;">
    triplot </td><td style="text-align: left;"> Trilinear plot for 3 proportions.</td>
</tr>
<tr>
 <td style="text-align: left;">
    txtStart/etxtStart/wdtxtStart </td><td style="text-align: left;"> Save commands and output to a text file
  (possibly for post processing with enscript).</td>
</tr>
<tr>
 <td style="text-align: left;">
    zoomplot </td><td style="text-align: left;"> recreate the current plot with different x/y limits
    (zoom in out).</td>
</tr>
<tr>
 <td style="text-align: left;">
    
  </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a>
</p>


<h3>See Also</h3>

<p> The tkrplot package </p>


<h3>Examples</h3>

<pre><code class='language-R'>ci.examp()

clt.examp()
clt.examp(5)

plot.dice( expand.grid(1:6,1:6), layout=c(6,6) )

faces(rbind(1:3,5:3,3:5,5:7))

plot(1:10, 1:10)
my.symbols( 1:10, 1:10, ms.polygram, n=1:10, inches=0.3 )

x &lt;- seq(1,100)
y &lt;- rnorm(100)
plot(x,y, type='b', col='blue')
clipplot( lines(x,y, type='b', col='red'), ylim=c(par('usr')[3],0))

power.examp()
power.examp(n=25)
power.examp(alpha=0.1)


</code></pre>

<hr>
<h2 id='TkApprox'>Plot a set of data in a Tk window and interactively move lines to
see predicted y-values corresponding to selected x-values.</h2><span id='topic+TkApprox'></span>

<h3>Description</h3>

<p>This function plots a dataset in a Tk window then places 3 lines on
the plot which show a predicted y value for the given x value.  The
lines can be clicked on and dragged to new x-values with the predicted
y-values automatically updating.  A table at the bottom of the graph
shows the differences between the pairs of x-values and y-values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TkApprox(x, y, type = "b", snap.to.x = FALSE, digits = 4,
  cols = c("red", "#009900", "blue"), xlab = deparse(substitute(x)),
  ylab = deparse(substitute(y)), hscale = 1.5, vscale = 1.5,
  wait = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TkApprox_+3A_x">x</code></td>
<td>
<p> The x-values of the data, should be sorted </p>
</td></tr>
<tr><td><code id="TkApprox_+3A_y">y</code></td>
<td>
<p> The corresponding y-values of the data </p>
</td></tr>
<tr><td><code id="TkApprox_+3A_type">type</code></td>
<td>
<p> Type of plot (lines, points, both) passed to <code>plot</code> </p>
</td></tr>
<tr><td><code id="TkApprox_+3A_snap.to.x">snap.to.x</code></td>
<td>
<p>If True then the lines will snap to x-values (can be
changed with a checkbox in the Tk window) </p>
</td></tr>
<tr><td><code id="TkApprox_+3A_digits">digits</code></td>
<td>
<p>Number of significant digits to display (passed to
<code>format</code>) </p>
</td></tr>
<tr><td><code id="TkApprox_+3A_cols">cols</code></td>
<td>
<p>Vector of 3 colors, used for the reference lines </p>
</td></tr>
<tr><td><code id="TkApprox_+3A_xlab">xlab</code></td>
<td>
<p> Label for x-axis </p>
</td></tr>
<tr><td><code id="TkApprox_+3A_ylab">ylab</code></td>
<td>
<p> Label for y-axis </p>
</td></tr>
<tr><td><code id="TkApprox_+3A_hscale">hscale</code></td>
<td>
<p> Horizontal Scale of the plot, passed to <code>tkrplot</code> </p>
</td></tr>
<tr><td><code id="TkApprox_+3A_vscale">vscale</code></td>
<td>
<p> Vertical Scale of the plot, passed to <code>tkrplot</code> </p>
</td></tr>
<tr><td><code id="TkApprox_+3A_wait">wait</code></td>
<td>
<p> Should R wait for the window to be closed </p>
</td></tr>
<tr><td><code id="TkApprox_+3A_...">...</code></td>
<td>
<p> Additional parameters passed to <code>plot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This provides an interactive way to explore predictions from a set of
x and y values.  Internally the function <code>approxfun</code> is used to
make the predictions.
</p>
<p>The x-value of the 3 reference lines can be changed by clicking and
dragging the line to a new position.  The x and y values are shown in
the margins of the graph.  Below the graph is a table with the
differences (absolute value) between the pairs of points.
</p>
<p>This can be used to find peaks/valleys in trends and to see how they
differ from starting points, other peaks/valleys, etc..
</p>


<h3>Value</h3>

<p>If <code>wait</code> is FALSE then an invisible NULL is returned, if
<code>wait</code> is TRUE then an invisible list with the x and y values of
the 3 reference lines is returned.
</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+approxfun">approxfun</a></code>, <code><a href="#topic+TkSpline">TkSpline</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()) {
  with(ccc, TkApprox(Time2,Elevation))
}
</code></pre>

<hr>
<h2 id='tkBrush'>Change the Color and Styles of points interactively</h2><span id='topic+tkBrush'></span>

<h3>Description</h3>

<p>Creates a Tk window with a scatterplot matrix, then allows
you to &quot;brush&quot; the points to change their color and/or style.</p>


<h3>Usage</h3>

<pre><code class='language-R'>tkBrush(mat,hscale=1.75,vscale=1.75,wait=TRUE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tkBrush_+3A_mat">mat</code></td>
<td>
<p>A matrix of the data to plot, columns are variables, rows
are observations, same as <code>pairs</code></p>
</td></tr>
<tr><td><code id="tkBrush_+3A_hscale">hscale</code></td>
<td>
<p>Passed to <code>tkrplot</code></p>
</td></tr>
<tr><td><code id="tkBrush_+3A_vscale">vscale</code></td>
<td>
<p>Passed to <code>tkrplot</code></p>
</td></tr>
<tr><td><code id="tkBrush_+3A_wait">wait</code></td>
<td>
<p>Should the function wait for you to finish, see below</p>
</td></tr>
<tr><td><code id="tkBrush_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the panel functions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates a Tk window with a pairs plot of <code>mat</code>,
then allows you to interactively move a rectangle (the brush) over the
points to change their color and plotting character.
</p>
<p>The arrow keys can be used to change the size and shape of the brush.
The left arrow makes the rectangle wider, the right makes it
narrower.  The up arrow key makes it taller, the right makes it
shorter.
</p>
<p>When the mouse button is not pressed the points inside the brush will
change while in the brush, but return to their previous state when the
brush moves off them.  If the mouse button is pressed then the points
inside the brush will be changed and the change will remain until a
different set of conditions is brushed on them.
</p>
<p>The style of the brushed points is determined by the values of the 2
entry boxes on the right side of the plot.  You can specify the
plotting character in the <code>pch</code> box, this can be anything that
you would regularly pass to the <code>pch</code> argument of <code>points</code>,
e.g. an integer or single character.  You can specify the color of the
brushed points using the <code>color</code> entry box, specify the name of
any color recognized by R (see <code>colors</code>), if this box does not
contain a legal color name then black will be used.
</p>
<p>If <code>wait</code> is FALSE then the Tk window will exist independently of
R and you can continue to do other things in the R window, in this
case the function returns NULL.  If <code>wait</code> is TRUE then R waits
for you to close the Tk window (using the quit button) then returns a
list with the colors and plotting characters resulting from your
brushing, this information can be used to recreate the plot using
<code>pairs</code> on a new graphics device (for printing or saving).
</p>


<h3>Value</h3>

<p>Either NULL (if Wait=FALSE) or a list with components <code>col</code> and
<code>pch</code> corresponding to the state of the points.
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+pairs">pairs</a></code>,<code>colors</code>,<code><a href="graphics.html#topic+points">points</a></code>,
the <code>iplots</code> package</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){

# Iris dataset

out1 &lt;- tkBrush(iris)

#  Now brush the points

pairs(iris, col=out1$col, pch=out1$pch)

# or

colhist &lt;- function(x,...){
    tmp &lt;- hist(x,plot=F)
    br &lt;- tmp$breaks
    w &lt;- as.numeric(cut(x,br,include.lowest=TRUE))
    sy &lt;- unlist(lapply(tmp$counts,function(x)seq(length=x)))
    my &lt;- max(sy)
    sy &lt;- sy/my
    my &lt;- 1/my
    sy &lt;- sy[order(order(x))]
    tmp.usr &lt;- par('usr'); on.exit(par(usr=tmp.usr))
    par(usr=c(tmp.usr[1:2],0,1.5))
    rect(br[w], sy-my, br[w+1], sy, 
       col=out1$col, # note out1$col is hardcoded here.
       border=NA)
    rect(br[-length(br)], 0, br[-1], tmp$counts*my)
}
pairs(iris, col=out1$col, pch=out1$pch, diag.panel=colhist)


# some spheres

s1 &lt;- matrix(nrow=0,ncol=3)

while( nrow(s1) &lt; 1000 ){
	tmp &lt;- rnorm(3)
	if( sum(tmp^2) &lt;= 1 ){
		s1 &lt;- rbind(s1,tmp)
	}
}

s2 &lt;- matrix(rnorm(3000), ncol=3)
s2 &lt;- s2/apply(s2,1,function(x) sqrt(sum(x^2)))

tkBrush(s1, wait=FALSE)
tkBrush(s2, wait=FALSE)

# now paint values where var 2 is close to 0 in both plots 
# and compare the var 1 and var 3 relationship

}
</code></pre>

<hr>
<h2 id='TkBuildDist'>
Interactively create a probability distribution.
</h2><span id='topic+TkBuildDist'></span><span id='topic+TkBuildDist2'></span>

<h3>Description</h3>

<p>Build a probability distribution (one option for creating a prior
distribution) by clicking or dragging a plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TkBuildDist(x = seq(min + (max - min)/nbin/2, max - (max - min)/nbin/2,
  length.out = nbin), min = 0, max = 10, nbin = 10, logspline = TRUE,
  intervals = FALSE)

TkBuildDist2( min=0, max=1, nbin=10, logspline=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TkBuildDist_+3A_x">x</code></td>
<td>

<p>A starting set of data points, will default to a sequence of uniform values.
</p>
</td></tr>
<tr><td><code id="TkBuildDist_+3A_min">min</code></td>
<td>

<p>The minimum value for the histogram
</p>
</td></tr>
<tr><td><code id="TkBuildDist_+3A_max">max</code></td>
<td>

<p>The maximum value for the histogram
</p>
</td></tr>
<tr><td><code id="TkBuildDist_+3A_nbin">nbin</code></td>
<td>

<p>The number of bins for the histogram
</p>
</td></tr>
<tr><td><code id="TkBuildDist_+3A_logspline">logspline</code></td>
<td>

<p>Logical, whether to include a logspline curve on the plot and in the output.
</p>
</td></tr>
<tr><td><code id="TkBuildDist_+3A_intervals">intervals</code></td>
<td>

<p>Logical, should the logspline fit be based on the interval counts
rather than the clicked data points, also should the interval
summary be returned.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bothe of these functions will open a Tk window to interact with.  The
window will show a histogram (the defaults will show a uniform
distribution), optionally a logspline fit line will be included as
well.  Including the logspline will slow things down a bit, so you may
want to skip it on slow computers.
</p>
<p>If you use the <code>TkBuildDist</code> function then a left click on the
histogram will add an additional point to the histogram bar clicked on
(the actual x-value where clicked will be saved, returned, and used in
the optional logspline unless <code>intervals</code> is TRUE).  Right
clicking on the histogram will remove the point closest to where
clicked (based only on x), which will usually have the effect of
decreasing the clicked bar by 1, but could affect the neigboring bar
if you click near the edge or click on a bar that is 0.
</p>
<p>If you use the <code>TkBuildDist2</code> function then the individual bars
can be adjusted by clicking at the top of a bar and dragging up or
down, or clicking at what you want the new height of the bar to be.
As the current bar is adjusted the other bars will adjust in the
oposite direction proportional to their current heights.
</p>
<p>The logspline fit assumes the basis for the distribution is the real
line, the <code>min</code> and <code>max</code> arguments only control the
histogram and where values can be changed.
</p>


<h3>Value</h3>

<p>Both functions return a list with the breaks that were used the
logspline fit (if <code>logspline</code> is TRUE), the x-values clicked on
(for <code>TkBuildDist</code>), and the proportion of the distribution
within each interval (for <code>TkBuildDist2</code> or if <code>intervals</code>
is TRUE).
</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p>The logspline package
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if(interactive()){
tmp1 &lt;- TkBuildDist()
tmp2 &lt;- TkBuildDist2()
}

</code></pre>

<hr>
<h2 id='tkexamp'>Create Tk dialog boxes with controls to show examples of changing
parameters on a graph.</h2><span id='topic+tkexamp'></span>

<h3>Description</h3>

<p>This utility will create a Tk window with a graph and controls to
change the parameters of the plotting function interactively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> tkexamp(FUN, param.list, vscale=1.5, hscale=1.5, wait=FALSE,
plotloc='top', an.play=TRUE, print=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tkexamp_+3A_fun">FUN</code></td>
<td>
<p>A function call to create the example plot</p>
</td></tr>
<tr><td><code id="tkexamp_+3A_param.list">param.list</code></td>
<td>
<p>A list of lists with information on the parameters
to control and the controls to use.  See Details Below</p>
</td></tr>
<tr><td><code id="tkexamp_+3A_vscale">vscale</code></td>
<td>
<p>Vertical size of plot, passed to <code>tkrplot</code></p>
</td></tr>
<tr><td><code id="tkexamp_+3A_hscale">hscale</code></td>
<td>
<p>Horizontal size of plot, passed to <code>tkrplot</code></p>
</td></tr>
<tr><td><code id="tkexamp_+3A_wait">wait</code></td>
<td>
<p>Should R wait for the demo to end</p>
</td></tr>
<tr><td><code id="tkexamp_+3A_plotloc">plotloc</code></td>
<td>
<p>Character with &quot;top&quot;, &quot;left&quot;, or &quot;right&quot; indicating
where the plot should be placed relative to the controls</p>
</td></tr>
<tr><td><code id="tkexamp_+3A_an.play">an.play</code></td>
<td>
<p>Should the scheduling in tcltk2 package be used for animations</p>
</td></tr>
<tr><td><code id="tkexamp_+3A_print">print</code></td>
<td>
<p>Automatically print the result (useful for ggplot2/lattice)</p>
</td></tr>
<tr><td><code id="tkexamp_+3A_...">...</code></td>
<td>
<p>Extra arguments, currently ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a helper function to create interactive demonstrations of the
effect of various function arguments on the resulting graph.
</p>
<p>The <code>FUN</code> argument should be a function call to create the basic
plot (if run stand alone this should create the starting plot).  The
arguments to be changed should not be included.
</p>
<p>The <code>param.list</code> is a nested list of lists that defines which
controls to use for which function arguments.  Additional levels of
nested lists creates groups of controls (see examples below) and if
the list is named in the enclosing list, that name will be used to
label the group.
</p>
<p>The
lowest level of lists control a single function argument with the
control to be used.  The name of the list in the enclosing list is the
name of the function argument to be used, e.g. <code>"pch=list(...)"</code>
will  create a control for the <code>pch</code> parameter.
</p>
<p>The first element of the innermost list is a character string
specifying which control to use (from the list below), the rest of the
elements must be named and specify parameters of the controls.  For
details on all possible parameters see the tcltk documentation.  Any
parameter can be set using this list, for example most controls have a
<code>width</code> parameter that can be set with code like <code>width=5</code>.
Most controls also have an <code>init</code> argument that specifies the
initial value that the control will be set to (most have a default in
case you don't specify the value).
</p>
<p>The following are the possible controls you can specify as the first
element of the list along with the most common parameters to specify:
</p>
<p>&quot;numentry&quot;, an entry box where a number can be typed in, this will be
passed to <code>FUN</code> wrapped in <code>as.numeric()</code>.
</p>
<p>&quot;entry&quot;, an entry box where a character string can be typed in (this
will be passed to <code>FUN</code> as a character string, not converted).
</p>
<p>&quot;slider&quot;, a slider (or scale) that can be dragged left and right to
choose the different values.  The common parameters to specify are
&quot;from&quot; (the lowest value), &quot;to&quot; (the largest value), and &quot;resolution&quot;
(the increment size when sliding).
</p>
<p>&quot;vslider&quot;, just like slider except that the slider is dragged up and
down rather than left and right.
</p>
<p>&quot;spinbox&quot;, an entry widget for a number with small arrows on the right
side that can be used to increment/decrement the value, or you can
type in a value.  The common parameters to set are &quot;from&quot; (smallest
value), &quot;to&quot; (largest value), and &quot;increment&quot; (how much to change the
value by when clicking on the arrows).  You can also set &quot;values&quot;
which is a vector of values that can be used.  This will be passed to
<code>FUN</code> as a number.
</p>
<p>&quot;checkbox&quot;, a box that can be checked, passed to <code>FUN</code> as a
logical (TRUE if checked, FALSE if not checked).  To set the intial
value as TRUE (the default is FALSE) use <code>init='T'</code>.
</p>
<p>&quot;combobox&quot;, an entry widget with an arrow on the right side that will
bring up a list of values to choose from.  This value is passed to
<code>FUN</code> as a character string.  The important parameter to set is
&quot;values&quot; which is a vector of character strings to choose between.
This option will only work with tcl version 8.5 or later and will
probably produce an error in earlier versions.
</p>
<p>&quot;radiobuttons&quot;, a set of choices with check boxes next to each, when
one is selected the previous selection is cleared.  The important
parameter to set is &quot;values&quot; wich is a vector of character strings to
choose between.
</p>
<p>&quot;animate&quot;, is a combination of a slider and a button.  If the tcltk2
package is avaliable and <code>an.play=TRUE</code> then the button will say
&quot;Play&quot; and pressing the button will automatically increment the slider
(and update the graph) until it reaches the maximum value.  Otherwise
the button will say &quot;Inc&quot; and you must click and hold on the button to
run the animation (this might be prefered in that you can stop the
animation).  Either way you can set the delay option (all other
options match with the slider option) and move the slider when the
interaction is not happening.  The animation starts at the current
value on the slider and goes to the maximum value.  You should only
have at most one animation control (multiple will confuse each other),
this includes not having multiple windows operating at the same time
with animation controls.
</p>
<p>Each nesting of lists will also change how the controls are placed
(top to bottom vs. left to right).
</p>
<p>The Tk window will also have a default set of controls at the bottom.
These include entry widgets for <code>vscale</code> and <code>hscale</code> for
changing the size of the graph (initially set by arguments to
<code>tkexamp</code>).  A &quot;Refresh&quot; button that will refresh the graph with
the new parameter values (some controls like sliders will
automatically refresh, but others like entries will not refresh on
their own and you will need to click on this button to see the
updates).  A &quot;Print Call&quot; button that when clicked will print a text
string to the R terminal that represents the function call with the
current argument settings (copying and pasting this to the command
line should recreate the current plot on the current plotting
device).  And an &quot;Exit&quot; button that will end the demo and close the window.
</p>


<h3>Value</h3>

<p>If <code>wait</code> is FALSE then it returns an invisible NULL, if
<code>wait</code> is TRUE then it returns a list with the argument values
when the window was closed.
</p>


<h3>Note</h3>

<p>You can move the sliders in 3 different ways:  You can left click
and drag the slider itself, you can left click in the trough to either
side of the slider and the slider will move 1 unit in the direction
you clicked, or you can right click in the trough and the slider will
jump to the location you clicked at.
</p>


<h3>Author(s)</h3>

<p>Greg Snow, <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

 <p><code>tkrplot</code>, the fgui package, the playwith package, and
the rpanel package </p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()) {

x &lt;- sort( runif(25,1,10) )
y &lt;- rnorm(25, x)

# some common plotting parameters

tke.test1 &lt;- list(Parameters=list(
                 pch=list('spinbox',init=1,from=0,to=255,width=5),
                 cex=list('slider',init=1.5,from=0.1,to=5,resolution=0.1),
                 type=list('combobox',init='b',
                   values=c('p','l','b','o','c','h','s','S','n'),
                        width=5),
                 lwd=list('spinbox',init=1,from=0,to=5,increment=1,width=5),
                 lty=list('spinbox',init=1,from=0,to=6,increment=1,width=5)
                 ))

tkexamp( plot(x,y), tke.test1, plotloc='top' )

# different controls for the parameters

tke.test2 &lt;- list(Parameters=list(
                 pch=list('spinbox',init=1,values=c(0:25,32:255),width=5),
                 cex=list('slider',init=1.5,from=0.1,to=5,resolution=0.1),
                 type=list('radiobuttons',init='b',
                   values=c('p','l','b','o','c','h','s','S','n'),
                        width=5),
                 lwd=list('spinbox',init=1,from=0,to=5,increment=1,width=5),
                 lty=list('spinbox',init=1,from=0,to=6,increment=1,width=5),
                 xpd=list('checkbox')
                 ))

tkexamp( plot(x,y), tke.test2, plotloc='left')

tmp &lt;- tkexamp( plot(x,y), list(tke.test2), plotloc='right', wait=TRUE )

# now recreate the plot
tmp$x &lt;- x
tmp$xlab &lt;- 'x'
tmp$y &lt;- y
tmp$ylab &lt;- 'y'
do.call('plot', tmp)

# a non plotting example

tke.test3 &lt;- list(
        sens=list('slider', init=0.95, from=0.9, to=1, resolution=0.005),
        spec=list('slider', init=0.9, from=0.8, to=1, resolution=0.005),
        prev=list('slider', init=0.01, from=0.0001, to=0.1, resolution=0.0001),
        step=list('spinbox', init=1, from=1, to=11, width=5),
        n=list('numentry',init=100000, width=7)
)

options(scipen=1)
tkexamp( SensSpec.demo(), tke.test3 )
# now increment step and watch the console

# Above example but converting it to plot

tempfun &lt;- function(sens,spec,prev,step,n) {
	if(missing(sens) || missing(n)) return(invisible(NULL))
	tmp &lt;- capture.output( SensSpec.demo(sens=sens,spec=spec,
				prev=prev, n=n, step=step) )
	par(cex=2.25)
	plot.new()
	tmp2 &lt;- strheight(tmp)
	text(0, 1-cumsum(tmp2*1.5), tmp, family='mono', adj=0)
	title('Sensitivity and Specificity Example')
}

tkexamp( tempfun(), tke.test3, hscale=4, vscale=2 )

# an example using trellis graphics

tke.test4 &lt;- list(
   alpha=list('slider', from=0,to=1,init=1,
                resolution=0.05),
   cex=list('spinbox',init=.8,from=.1,to=3,increment=.1,width=5),
   col=list('entry',init='#0080ff'),
   pch=list('spinbox',init=1, from=0,to=255,
                increment=1,width=5),
   fill=list('entry',init='transparent')
)

tempfun &lt;- function(x,y,alpha,cex,col,pch,fill) {
	if(missing(alpha) || missing(cex)) {return()}
	trellis.par.set(plot.symbol=list(alpha=alpha, cex=cex, col=col,
					font=1,pch=pch,fill=fill))
	print(xyplot( y~x ))
}

require(lattice)

tkexamp( tempfun(x,y), list(tke.test4), plotloc='left')


# Two example using ggplot2

if( require(ggplot2) ) {

##  1
  tkexamp( qplot(cty,data=mpg, geom='histogram'),
      list(binwidth=list('slider',from=1,to=25)),
      print=TRUE)

##  2
  tmpfun &lt;- function(bw=2){
	print(ggplot(mpg, aes(cty)) +
  		geom_histogram(binwidth = bw))
  }

  tkexamp( tmpfun, list(bw=list('slider',from=1, to=5)))


}

}
</code></pre>

<hr>
<h2 id='TkListView'> Interactivly view structures of list and list like objects. </h2><span id='topic+TkListView'></span>

<h3>Description</h3>

<p>This is somewhat like the <code>str</code> function, except that it creates
a new Tk window and a tree object representing the list or object.
You can then click on the '+' signs to expand branches of the list to
see what they contain.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TkListView(list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TkListView_+3A_list">list</code></td>
<td>
<p> The list or object to be viewed. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function opens a Tk window with a tree view of the list in the
leftmost pane.  Next to the tree is the result from the <code>str</code>
function for each element of the list.  Clicking on the '+' symbol
next to list elements will expand the tree branch to show what that
list/sublist contains.  On the right is an output pane with 3 buttons
below it.  These can be used by first selecting (clicking on) a list
element in the left pane (this can be a whole list or single
element), then clicking on one of the buttons.  The output from the
button appears in the right pane (replacing anything that may have
been there before).  The 'print' button just prints the element/sublist
selected.  The 'str' button calls the <code>str</code> function on the
selected element/list/sublist.  The 'Eval:' button will evaluate the
code in the entry box next to it with the selected element of the list
being the 'x' variable.  For example you could click on an element in
the list that is a numeric vector, type 'hist(x)' in the entry box,
and click on the 'Eval:' button to produce a histogram
(current/default R graphics device) of the data in that element.
</p>
<p>any lists/objects with attributes will show the attributes as an
additional branch in the tree with a label of &quot;&lt;&lt;attributes&gt;&gt;&quot;.
</p>
<p>This function works on S3 objects that are stored as lists.  Since
currently S4 objects are saved as attributes, wrapping them in a list
will work with this function to view their structure, see the example below.
</p>


<h3>Value</h3>

<p>This function is ran for its side effects, it does not return anything
of use.
</p>


<h3>Author(s)</h3>

<p>Greg Snow, <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

 <p><code><a href="utils.html#topic+str">str</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()) {
  tmp &lt;- list( a=letters, b=list(1:10, 10:1), c=list( x=rnorm(100),
        z=data.frame(x=rnorm(10),y=rnorm(10))))
  TkListView(tmp)

  fit &lt;- lm(Petal.Width ~ ., data=iris)
  TkListView(fit)


  if(require(stats4)){
   # this example is copied almost verbatim from ?mle
         x &lt;- 0:10
     y &lt;- c(26, 17, 13, 12, 20, 5, 9, 8, 5, 4, 8)
     ll &lt;- function(ymax=15, xhalf=6)
         -sum(stats::dpois(y, lambda=ymax/(1+x/xhalf), log=TRUE))
     (fit &lt;- mle(ll))
     TkListView(list(fit))
  }
}
</code></pre>

<hr>
<h2 id='TkPredict'>Plot predicted values from a model against one of the predictors
for a given value of the othe predictors</h2><span id='topic+TkPredict'></span><span id='topic+Predict.Plot'></span>

<h3>Description</h3>

<p>These functions create a plot of predicted values vs. one of the
predictors for given values of the other predictors.  TkPredict
further creates a Tk gui to allow you to change the values of the
other predictors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Predict.Plot(model, pred.var, ..., type='response', add=FALSE,
plot.args=list(), n.points=100, ref.val, ref.col='green', ref.lty=1,
data)
TkPredict(model, data, pred.var, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TkPredict_+3A_model">model</code></td>
<td>
<p>A model of class 'lm' or 'glm' (or possibly others) from
which to plot predictions.</p>
</td></tr>
<tr><td><code id="TkPredict_+3A_pred.var">pred.var</code></td>
<td>
<p>A character string indicating which predictor variable
to put on the x-axis of the plot.</p>
</td></tr>
<tr><td><code id="TkPredict_+3A_...">...</code></td>
<td>
<p>for <code>Predict.Plot</code> The predictor variables and their
values for the predictions.  See below for detail.</p>
</td></tr>
<tr><td><code id="TkPredict_+3A_type">type</code></td>
<td>
<p>The type value passed on to the predict function.</p>
</td></tr>
<tr><td><code id="TkPredict_+3A_add">add</code></td>
<td>
<p>Whether to add a line to the existing plot or start a new
plot.</p>
</td></tr>
<tr><td><code id="TkPredict_+3A_plot.args">plot.args</code></td>
<td>
<p>A list of additional options passed on to the
plotting function.</p>
</td></tr>
<tr><td><code id="TkPredict_+3A_n.points">n.points</code></td>
<td>
<p>The number of points to use in the approximation of
the curve.</p>
</td></tr>
<tr><td><code id="TkPredict_+3A_ref.val">ref.val</code></td>
<td>
<p>A reference value for the <code>pred.var</code>, a reference
line will be drawn at this value to the corresponding predicted value.</p>
</td></tr>
<tr><td><code id="TkPredict_+3A_ref.col">ref.col</code>, <code id="TkPredict_+3A_ref.lty">ref.lty</code></td>
<td>
<p>The color and line type of the reference line
if plotted.</p>
</td></tr>
<tr><td><code id="TkPredict_+3A_data">data</code></td>
<td>
<p>The data frame or environment where the variables that the
model was fit to are found.  If missing, the model will be examined
for an attempt find the needed data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions plot the predicted values from a regression model
(<code>lm</code> or <code>glm</code>) against one of the predictor variables for
given values of the other predictors.  The values of the other
predictors are passed as the <code>...</code> argument to
<code>Predict.Plot</code> or are set using gui controls in <code>TkPredict</code>
(initial values are the medians).
</p>
<p>If the variable for the x axis (name put in <code>pred.var</code>) is not
included with the <code>...</code> variables, then the range will be
computed from the <code>data</code> argument or the data component of the
<code>model</code> argument.
</p>
<p>If the variable passed as <code>pred.var</code> is also included in the
<code>...</code> arguments and contains a single value, then this value will
be used as the <code>ref.val</code> argument.
</p>
<p>If it contains 2 or more values, then the range of these values will
be used as the x-limits for the predictions.
</p>
<p>When running <code>TkPredict</code> you can click on the &quot;Print Call&quot; button
to print out the call of <code>Predict.Plot</code> that will recreate the
same plot.  Doing this for different combinations of predictor values
and editing the <code>plot.args</code> and <code>add</code> arguments will give
you a script that will create a static version of the predictions.
</p>


<h3>Value</h3>

<p>These functions are run for their side effects of creating plots and
do not return anything.
</p>


<h3>Note</h3>

<p> The GUI currently allows you to select a factor as the
x-variable.  If you do this it will generate some errors and you will
not see the plot, just choose a different variable as the x-variable
and the plot will return. </p>


<h3>Author(s)</h3>

<p>Greg Snow, <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

 <p><code>tkrplot</code>, <code><a href="#topic+tkexamp">tkexamp</a></code>, <code><a href="stats.html#topic+predict">predict</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(splines)

fit.lm1 &lt;- lm( Sepal.Width ~ ns(Petal.Width,3)*ns(Petal.Length,3)+Species,
	data=iris)

Predict.Plot(fit.lm1, pred.var = "Petal.Width", Petal.Width = 1.22,
      Petal.Length = 4.3, Species = "versicolor",
 	plot.args = list(ylim=range(iris$Sepal.Width), col='blue'),
      type = "response")
Predict.Plot(fit.lm1, pred.var = "Petal.Width", Petal.Width = 1.22,
      Petal.Length = 4.3, Species = "virginica",
	plot.args = list(col='red'),
      type = "response", add=TRUE)
Predict.Plot(fit.lm1, pred.var = "Petal.Width", Petal.Width = 1.22,
      Petal.Length = 4.4, Species = "virginica",
	plot.args = list(col='purple'),
      type = "response", add=TRUE)

fit.glm1 &lt;- glm( Species=='virginica' ~ Sepal.Width+Sepal.Length,
	data=iris, family=binomial)

Predict.Plot(fit.glm1, pred.var = "Sepal.Length", Sepal.Width = 1.99,
      Sepal.Length = 6.34, plot.args = list(ylim=c(0,1), col='blue'),
 	type = "response")
Predict.Plot(fit.glm1, pred.var = "Sepal.Length", Sepal.Width = 4.39,
      Sepal.Length = 6.34, plot.args = list(col='red'),
	type = "response", add=TRUE)




if(interactive()){
TkPredict(fit.lm1)

TkPredict(fit.glm1)
}

</code></pre>

<hr>
<h2 id='TkSpline'>Plot a set of data in a Tk window and interactively move a line to
see predicted y-values from a spline fit corresponding to selected x-values.</h2><span id='topic+TkSpline'></span>

<h3>Description</h3>

<p>This function plots a dataset in a Tk window then draws the spline fit
through the points.  It places a line to show the predicted y from the
given x value.  The line can be clicked on and dragged to new x-values
with the predicted y-values automatically updating.  A table at the
bottem of the graph shows the values and the 3 derivatives.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TkSpline(x, y, method='natural', snap.to.x=FALSE, digits=4,
                     col=c('blue','#009900','red','black'),
                     xlab=deparse(substitute(x)), ylab=deparse(substitute(y)),
                     hscale=1.5, vscale=1.5, wait=TRUE,
                     ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TkSpline_+3A_x">x</code></td>
<td>
<p> The x-values of the data, should be sorted </p>
</td></tr>
<tr><td><code id="TkSpline_+3A_y">y</code></td>
<td>
<p> The corresponding y-values of the data </p>
</td></tr>
<tr><td><code id="TkSpline_+3A_method">method</code></td>
<td>
<p>Spline Method, passed to <code>splinefun</code></p>
</td></tr>
<tr><td><code id="TkSpline_+3A_snap.to.x">snap.to.x</code></td>
<td>
<p>Logical, if TRUE then the line will only take on the
values of <code>x</code></p>
</td></tr>
<tr><td><code id="TkSpline_+3A_digits">digits</code></td>
<td>
<p>Number of digits to print, passed to <code>format</code></p>
</td></tr>
<tr><td><code id="TkSpline_+3A_col">col</code></td>
<td>
<p>Colors of the prediction and other lines</p>
</td></tr>
<tr><td><code id="TkSpline_+3A_xlab">xlab</code></td>
<td>
<p>Label for the x-axis, passed to <code>plot</code></p>
</td></tr>
<tr><td><code id="TkSpline_+3A_ylab">ylab</code></td>
<td>
<p>Label for the y-axis, passed to <code>plot</code></p>
</td></tr>
<tr><td><code id="TkSpline_+3A_hscale">hscale</code></td>
<td>
<p>Horizontal scaling, passed to <code>tkrplot</code></p>
</td></tr>
<tr><td><code id="TkSpline_+3A_vscale">vscale</code></td>
<td>
<p>Vertical scaling, passed to <code>tkrplot</code></p>
</td></tr>
<tr><td><code id="TkSpline_+3A_wait">wait</code></td>
<td>
<p>Should R wait for the window to close</p>
</td></tr>
<tr><td><code id="TkSpline_+3A_...">...</code></td>
<td>
<p> Additional parameters passed to <code>plot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This provides an interactive way to explore predictions from a set of
x and y values.  Internally the function <code>splinefun</code> is used to
make the predictions.
</p>
<p>The x-value of the reference line can be changed by clicking and
dragging the line to a new position.  The x and y values are shown in
the margins of the graph.  Below the graph is a table with the
y-value and derivatives.
</p>


<h3>Value</h3>

<p>If <code>wait</code> is FALSE then an invisible NULL is returned, if
<code>wait</code> is TRUE then an invisible list with the x and y values and
derivatives is returned.
</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+splinefun">splinefun</a></code>, <code><a href="#topic+TkApprox">TkApprox</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()) {
  x &lt;- 1:10
  y &lt;- sin(x)
  TkSpline(x,y, xlim=c(0,11))
}
</code></pre>

<hr>
<h2 id='towork'> Sample data downloaded and converted from a GPS unit</h2><span id='topic+towork'></span><span id='topic+h2h'></span><span id='topic+ccc'></span>

<h3>Description</h3>

<p>These are GPS information from 3 trips.
</p>


<h3>Format</h3>

<p>Data frames with the following variables.
</p>

<dl>
<dt><code>Index</code></dt><dd><p>Measurement number</p>
</dd>
<dt><code>Time</code></dt><dd><p>a POSIXt, Time of measurement</p>
</dd>
<dt><code>Elevation</code></dt><dd><p>a numeric vector, Elevation in Feet</p>
</dd>
<dt><code>Leg.Dist</code></dt><dd><p>a character/numeric vector, The distance
traveled in that leg (in feet for <code>ccc</code>)</p>
</dd>
<dt><code>Leg.Time</code></dt><dd><p>a difftime, the time of that leg</p>
</dd>
<dt><code>Speed</code></dt><dd><p>a numeric vector, Speed in mph</p>
</dd>
<dt><code>Direction</code></dt><dd><p>a numeric vector, Direction in Degrees, 0 is
North, 90 is East, 180 is South, 270 is West</p>
</dd>
<dt><code>LatLon</code></dt><dd><p>a character vector, Latitude and Longitude as
characters</p>
</dd>
<dt><code>Leg.Dist.f</code></dt><dd><p>a numeric vector, Length of that leg in feet</p>
</dd>
<dt><code>Leg.Dist.m</code></dt><dd><p>a numeric vector, Length of that leg in miles</p>
</dd>
<dt><code>Lat</code></dt><dd><p>a numeric vector, Numeric latitude</p>
</dd>
<dt><code>Lon</code></dt><dd><p>a numeric vector, Numeric longitude (negative for west)</p>
</dd>
<dt><code>Distance</code></dt><dd><p>a numeric vector, Distance from start in feet</p>
</dd>
<dt><code>Distance.f</code></dt><dd><p>a numeric vector, Distance from start in feet</p>
</dd>
<dt><code>Distance.m</code></dt><dd><p>a numeric vector, Distance from start in miles</p>
</dd>
<dt><code>Time2</code></dt><dd><p>a difftime, Time from start</p>
</dd>
<dt><code>Time3</code></dt><dd><p>a difftime, cumsum of <code>Leg.Time</code></p>
</dd>
</dl>



<h3>Details</h3>

<p>The data frame <code>ccc</code> came from when I was walking back to my
office from a meeting and decided to take the scenic route and started
the GPS.
</p>
<p>The data frame <code>h2h</code> is a trip from my office to another for a
meeting.  The first part is traveling by car, the last part by foot
from the parking lot to the building.  Speed is a mixture of
distributions.
</p>
<p>The data frame <code>towork</code> came from driving to work one morning
(the first point is where the GPS got it's first lock, not my house).
The overall trip was mostly NorthWest but with enough North and
NorthEast that a simple average of direction shows SouthEast, good
example for circular stats.
</p>


<h3>Source</h3>

<p>My GPS device
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if( interactive() ){
  with(ccc, TkApprox(Distance, Elevation))
}
</code></pre>

<hr>
<h2 id='tree.demo'> Interactively demonstrate regression trees </h2><span id='topic+tree.demo'></span>

<h3>Description</h3>

<p>Interactively recursively partition a dataset to demonstrate
regression trees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tree.demo(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tree.demo_+3A_x">x</code></td>
<td>
<p> The predictor variable. </p>
</td></tr>
<tr><td><code id="tree.demo_+3A_y">y</code></td>
<td>
<p> The response variable. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function first creates a scatterplot of <code>x</code> and <code>y</code> and
shows the residual sum of squares from fitting a horizontal line to
the y-values.
</p>
<p>Clicking anywhere on the graph will show an updated graph where the
data is partitioned into 2 groups based on the x-value where you
clicked with a horizontal line fit to each group (including showing
the updated residual sum of squares).  Clicking again will move the
partitioning value based on the new click.
</p>
<p>When you have found a good partitioning (reduces the RSS), right click
and choose 'stop' and that partition will become fixed.  Now you can
click to do a second set of partions (breaking the data into 3
groups).
</p>
<p>To finish the demo, right click and choose 'stop', then right click
again and choose 'stop' again.
</p>


<h3>Value</h3>

<p>A vector with the x-values of the cut points that you selected (sorted).
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

<p> The rpart and tree packages </p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
data('ethanol', package='lattice')
print(with(ethanol, tree.demo(E,NOx)))
}
</code></pre>

<hr>
<h2 id='triplot'> Create or add to a Trilinear Plot </h2><span id='topic+triplot'></span>

<h3>Description</h3>

<p>Create (or add to) a trilinear plot of 3 proportions that sum to 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>triplot(x, y = NULL, z = NULL, labels = dimnames(x)[[2]],
  txt = dimnames(x)[[1]], legend = NULL, legend.split = NULL,
  inner = TRUE, inner.col = c("lightblue", "pink"), inner.lty = c(2, 3),
  add = FALSE, main = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="triplot_+3A_x">x</code></td>
<td>
<p> Vector or matrix of up to 3 columns. </p>
</td></tr>
<tr><td><code id="triplot_+3A_y">y</code></td>
<td>
<p> Vector (if <code>x</code> is a vector). </p>
</td></tr>
<tr><td><code id="triplot_+3A_z">z</code></td>
<td>
<p> Vector (if <code>x</code> is a vector). </p>
</td></tr>
<tr><td><code id="triplot_+3A_labels">labels</code></td>
<td>
<p> Labels for the 3 components (printed at corners). </p>
</td></tr>
<tr><td><code id="triplot_+3A_txt">txt</code></td>
<td>
<p> Vector of text strings to be plotted instead of points. </p>
</td></tr>
<tr><td><code id="triplot_+3A_legend">legend</code></td>
<td>
<p> Labels for the data points </p>
</td></tr>
<tr><td><code id="triplot_+3A_legend.split">legend.split</code></td>
<td>
<p> What proportion of the labels will go on the left. </p>
</td></tr>
<tr><td><code id="triplot_+3A_inner">inner</code></td>
<td>
<p> Logical, should the inner reference lines be plotted. </p>
</td></tr>
<tr><td><code id="triplot_+3A_inner.col">inner.col</code></td>
<td>
<p> Colors for the 2 inner triangles. </p>
</td></tr>
<tr><td><code id="triplot_+3A_inner.lty">inner.lty</code></td>
<td>
<p> Line types for the 2 inner triangles. </p>
</td></tr>
<tr><td><code id="triplot_+3A_add">add</code></td>
<td>
<p> Add points to existing plot (TRUE), or create a new plot (FALSE). </p>
</td></tr>
<tr><td><code id="triplot_+3A_main">main</code></td>
<td>
<p> Main title for the plot. </p>
</td></tr>
<tr><td><code id="triplot_+3A_...">...</code></td>
<td>
<p> Additional arguments passed on to <code>points</code> or <code>text</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Trilinear plots are useful for visualizing membership in 3 groups by
plotting sets of 3 proportions that sum to 1 within each set.
</p>
<p>The data can be passed to the function as a matrix with either 2 or 3
columns, or as seperate vectors to <code>x</code>, <code>y</code>, and optionaly
<code>z</code>.  If 2 columns are passed in, then they must be between 0 and
1 and the 3rd column will be created by subtracting both from 1.  If 3
columns of data are given to the function then each will be divided by
the sum of the 3 columns (they don't need to sum to 1 before being
passed in).
</p>


<h3>Value</h3>

<p>An invisible matrix with 2 columns and the same number of rows as <code>x</code>
corresponding to the points plotted (after transforming to 2
dimensions).
</p>
<p>The return matrix can be passed to <code>identify</code> for labeling of
individual points.
</p>
<p>Using <code>type='n'</code> and <code>add=FALSE</code> will return the transformed
points without doing any plotting.
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>References</h3>

<p> Allen, Terry. Using and Interpreting the Trilinear Plot.
Chance. 15 (Summer 2002). </p>


<h3>See Also</h3>

 <p><code>triangle.plot</code> in package ade4,
<code>ternaryplot</code> in package vcd, <code>tri</code> in package cwhtool,
<code>soil.texture</code> and <code>triax.plot</code> in package plotrix. </p>


<h3>Examples</h3>

<pre><code class='language-R'>triplot(USArrests[c(1,4,2)])
tmp &lt;- triplot(USArrests[c(1,4,2)],txt=NULL)
if(interactive()){ identify(tmp, lab=rownames(USArrests) ) }

tmp &lt;- rbind( HairEyeColor[,,'Male'], HairEyeColor[,,'Female'])
tmp[,3] &lt;- tmp[,3] + tmp[,4]
tmp &lt;- tmp[,1:3]
triplot(tmp, legend=rep(c('Male','Femal'),each=4),
 col=rep(c('black','brown','red','yellow'),2))
</code></pre>

<hr>
<h2 id='txtStart'>Save a transcript of commands and/or output to a text file. </h2><span id='topic+txtStart'></span><span id='topic+txtStop'></span><span id='topic+txtComment'></span><span id='topic+txtSkip'></span><span id='topic+etxtStart'></span><span id='topic+etxtStop'></span><span id='topic+etxtComment'></span><span id='topic+etxtSkip'></span><span id='topic+etxtPlot'></span><span id='topic+wdtxtStart'></span><span id='topic+wdtxtStop'></span><span id='topic+wdtxtComment'></span><span id='topic+wdtxtSkip'></span><span id='topic+wdtxtPlot'></span><span id='topic+mdtxtStart'></span><span id='topic+mdtxtStop'></span><span id='topic+mdtxtComment'></span><span id='topic+mdtxtSkip'></span><span id='topic+mdtxtPlot'></span>

<h3>Description</h3>

<p>These functions save a transcript of your commands and their output to
a script file, possibly for later processing with the &quot;enscript&quot; or
&quot;pandoc&quot;
program.
</p>
<p>They work as a combinations of <code>sink</code> and <code>history</code> with a
couple extra bells and whistles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>txtStart(file, commands=TRUE, results=TRUE, append=FALSE, cmdfile,
          visible.only=TRUE)

txtStop()

txtComment(txt,cmdtxt)

txtSkip(expr)

etxtStart(dir = tempfile("etxt"), file = "transcript.txt",
           commands = TRUE, results = TRUE, append = FALSE,
           cmdbg = "white", cmdcol = "red", resbg = "white",
           rescol = "navy", combg = "cyan", comcol = "black",
           cmdfile, visible.only = TRUE)

etxtStop()

etxtComment(txt, cmdtxt)

etxtSkip(expr)

etxtPlot(file=paste(tempfile('plot',R2txt.vars$dir),'.eps',sep=''),
         width=4, height=4)

wdtxtStart(commands=TRUE, results=TRUE, fontsize=9, cmdfile,
          visible.only=TRUE)

wdtxtStop()

wdtxtComment(txt,cmdtxt)

wdtxtSkip(expr)

wdtxtPlot(height=5, width=5, pointsize=10)

mdtxtStart(dir=tempfile('mdtxt'), file='transcript.md',
           commands=TRUE, results=TRUE, append=FALSE,
           cmdfile, visible.only=TRUE)

mdtxtStop()

mdtxtComment(txt,cmdtxt)

mdtxtSkip(expr)

mdtxtPlot(file=tempfile('plot',R2txt.vars$dir,'.png'),
                     width=4, height=4)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="txtStart_+3A_dir">dir</code></td>
<td>
<p> Directory to store transcript file and any graphics file in </p>
</td></tr>
<tr><td><code id="txtStart_+3A_file">file</code></td>
<td>
<p> Text file to save transcript in </p>
</td></tr>
<tr><td><code id="txtStart_+3A_commands">commands</code></td>
<td>
<p> Logical, should the commands be echoed to the
transcript file </p>
</td></tr>
<tr><td><code id="txtStart_+3A_results">results</code></td>
<td>
<p> Logical, should the results be saved in the transcript
file </p>
</td></tr>
<tr><td><code id="txtStart_+3A_append">append</code></td>
<td>
<p> Logical, should we append to <code>file</code> or replace it </p>
</td></tr>
<tr><td><code id="txtStart_+3A_cmdbg">cmdbg</code></td>
<td>
<p> Background color for command lines in <code>file</code> </p>
</td></tr>
<tr><td><code id="txtStart_+3A_cmdcol">cmdcol</code></td>
<td>
<p> Color of text for command lines in <code>file</code> </p>
</td></tr>
<tr><td><code id="txtStart_+3A_resbg">resbg</code></td>
<td>
<p> Background color for results sections in <code>file</code> </p>
</td></tr>
<tr><td><code id="txtStart_+3A_rescol">rescol</code></td>
<td>
<p> Text color of results sections in <code>file</code> </p>
</td></tr>
<tr><td><code id="txtStart_+3A_combg">combg</code></td>
<td>
<p> Background color for comments in <code>file</code> </p>
</td></tr>
<tr><td><code id="txtStart_+3A_comcol">comcol</code></td>
<td>
<p> Text color of comments in <code>file</code> </p>
</td></tr>
<tr><td><code id="txtStart_+3A_cmdfile">cmdfile</code></td>
<td>
<p> A filename to store commands such that it can be
<code>source</code>d or copied and pasted from </p>
</td></tr>
<tr><td><code id="txtStart_+3A_visible.only">visible.only</code></td>
<td>
<p> Should non-printed output be included, not
currently implemented.</p>
</td></tr>
<tr><td><code id="txtStart_+3A_txt">txt</code></td>
<td>
<p>Text of a comment to be inserted into <code>file</code> </p>
</td></tr>
<tr><td><code id="txtStart_+3A_cmdtxt">cmdtxt</code></td>
<td>
<p>Text of a comment to be inserted into <code>cmdfile</code> </p>
</td></tr>
<tr><td><code id="txtStart_+3A_expr">expr</code></td>
<td>
<p>An expression to be executed without being included in
<code>file</code> or <code>cmdfile</code> </p>
</td></tr>
<tr><td><code id="txtStart_+3A_width">width</code></td>
<td>
<p>Width of plot, passed to <code>dev.copy2eps</code>,
<code>wdPlot</code>, or <code>dev.copy</code></p>
</td></tr>
<tr><td><code id="txtStart_+3A_height">height</code></td>
<td>
<p>Height of plot, passed to <code>dev.copy2eps</code>,
<code>wdPlot</code>, or <code>dev.copy</code></p>
</td></tr>
<tr><td><code id="txtStart_+3A_fontsize">fontsize</code></td>
<td>
<p>Size of font to use in MSWord</p>
</td></tr>
<tr><td><code id="txtStart_+3A_pointsize">pointsize</code></td>
<td>
<p> passed to <code>wdPlot</code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are used to create transcript/command files of your R
session.  There are 4 sets of functions, those starting with
&quot;txt&quot;,those starting with &quot;etxt&quot;, and those starting with
&quot;wdtxt&quot; and those starting with &quot;mdtxt&quot;.  The &quot;txt&quot; functions
create a plain text transcript while the &quot;etxt&quot; functions
create a text file with extra escapes and commands so that it
can be post processed with enscript (an external program) to
create a postscript file and can include graphics as well.  The
postscript file can be converted to pdf or other format file.
</p>
<p>The &quot;wdtxt&quot; functions will insert the commands and results into
a Microsoft Word document.
</p>
<p>The &quot;mdtxt&quot; functions create a text file but with MarkDown
escapes so that it can be post processed with &quot;pandoc&quot; (an
external program) to create other formats such as html, pdf, MS
Word documents, etc.  If the command starts with the string
&quot;pander&quot; or &quot;pandoc&quot; (after optional whitespace) then the
results will be inserted directly, without escapes, into the
transcript file.  This assumes that you are using code from the
&quot;pander&quot; package which generates markdown formatted output.
This will create nicer looking tables and other output.
</p>
<p>If <code>results</code> is TRUE and <code>commands</code> is FALSE then the result
is similar to the results of <code>sink</code>.  If <code>commands</code>
is true as well then the transcript file will show both the commands
and results similar to the output on the screen.  If both
<code>commands</code> and <code>results</code> are FALSE then pretty much
the only thing these functions will accomplish is to waste some
computing time.
</p>
<p>If <code>cmdfile</code> is
specified then an additional file is created with the commands
used (similar to the <code>history</code> command), this file can be
used with <code>source</code> or copied and
pasted to the terminal.
</p>
<p>The Start functions specify the file/directory to create and
start the transcript, <code>wdtxtStart</code> will open Word if it is
not already open or create a connection to an open word window.
The prompts are changed to remind you
that the commands/results are being copied to the transcript.
The Stop functions stop the recording and reset the prompts.
</p>
<p>The R parser strips comments and does some reformatting so the
transcript file may not match exactly with the terminal
output.  Use the <code>txtComment</code>, <code>etxtComment</code>,
<code>wdtxtComment</code>, or <code>mdtxtComment</code>
functions to add a comment.  This will show up as a line offset
by whitespace in the transcript file, highlighted in the
etxt version, and the default font in Word.
If <code>cmdtxt</code> is specified then that line
will be inserted into <code>cmdfile</code> preceded by a # so it
will be skipped if sourced or copied.
</p>
<p>The <code>txtSkip</code>, <code>etxtSkip</code>, <code>wdtxtSkip</code>, and
<code>mdtxtSkip</code> functions will run the code in <code>expr</code> but
will not include the commands or results in the transcript file
(this can be used for side computations, or requests for help,
etc.).
</p>
<p>The <code>etxtPlot</code> function calls <code>dev.copy2eps</code> to
create a copy of the current plot and inserts the proper command
into the transcript file so that the eps file will be included
in the final postscript file after processing.
</p>
<p>The <code>wdtxtPlot</code> function calls <code>wdPlot</code> to send a
copy of the current graph to MS Word.
</p>
<p>The <code>mdtxtPlot</code> function calls <code>dev.copy</code> to create a
copy of the current plot as a .png file and inserts the proper
command into the transcript file so that the .png file will be
included when processing with pandoc.
</p>


<h3>Value</h3>

<p>Most of these commands do not return anything of use.  The exceptions
are:
</p>
<p><code>etxtStop</code> returns the name of the transcript file (including the
directory path).
</p>
<p><code>txtSkip</code>, <code>etxtSkip</code>, <code>wdtxtSkip</code>, and
<code>mdtxtSkip</code> return the value of <code>expr</code>.
</p>


<h3>Note</h3>

<p>These commands do not do any fancy formatting of output, just what you
see in the regular terminal window.  If you want more formatted output
then you should look into <code>Sweave</code>, <code>knitr</code>, or the R2HTML package.
</p>
<p>The MS word functions will insert into the current word document at the
location of the cursor.  This means that if you look at the document and
move the current location to somewhere in the middle (or have another
word document open with the location in the middle), when you go back to
R, the new transcript will be inserted into the middle of the document.
So be careful to position the cursor at the end of the correct document
before going back to R.  Note that the &quot;wdtxt&quot; functions depend on the
&quot;R2wd&quot; package which in turn depends on tools that are not free.
</p>
<p>Do not use these functions in combination with R2HTML or <code>sink</code>.
Only one of these sets of functions will work at a time.
</p>


<h3>Author(s)</h3>

<p> Greg Snow, <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+sink">sink</a></code>, <code><a href="utils.html#topic+history">history</a></code>,
<code><a href="utils.html#topic+Sweave">Sweave</a></code>, the odfWeave package, the R2HTML package, the
R2wd package, the pander package </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
etxtStart()
etxtComment('This is todays transcript')
date()
x &lt;- rnorm(25)
summary(x)
stem(x)
etxtSkip(?hist)
hist(x)
etxtPlot()
Sys.Date()
Sys.time()
my.file &lt;- etxtStop()

# assumes enscript and ps2pdf are on your path
system(paste('enscript -e -B -p transcript.ps ', my.file) )
system('ps2pdf transcript.ps')

# if the above commands used mdtxt instead of etxt and the pandoc
# program is installed and on your path (and dependent programs) then use:
system(paste('pandoc -o transcript.docx ', my.file))

## End(Not run)
</code></pre>

<hr>
<h2 id='updateusr'>Updates the 'usr' coordinates in the current plot. </h2><span id='topic+updateusr'></span>

<h3>Description</h3>

<p>For a traditional graphics plot this function will update the 'usr'
coordinates by transforming a pair of points from the current usr
coordinates to those specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateusr(x1, y1 = NULL, x2, y2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="updateusr_+3A_x1">x1</code></td>
<td>
<p> The x-coords of 2 points in the current 'usr' coordianates,
or anything that can be passed to <code>xy.coords</code>.</p>
</td></tr>
<tr><td><code id="updateusr_+3A_y1">y1</code></td>
<td>
<p> The y-coords of 2 points in the current 'usr' coordinates,
or an object representing the points in the new 'usr' coordinates. </p>
</td></tr>
<tr><td><code id="updateusr_+3A_x2">x2</code></td>
<td>
<p> The x-coords for the 2 points in the new coordinates. </p>
</td></tr>
<tr><td><code id="updateusr_+3A_y2">y2</code></td>
<td>
<p> The y-coords for the 2 points in the new coordinates. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sometimes graphs (in the traditional graphing scheme) end up with usr
coordinates different from expected for adding to the plot (for
example <code>barplot</code> does not center the bars at integers).  This
function will take 2 points in the current 'usr' coordinates and the
desired 'usr' coordinates of the 2 points and transform the user
coordinates to make this happen.  The updating only shifts and scales
the coordinates, it does not do any rotation or warping transforms.
</p>
<p>If <code>x1</code> and <code>y1</code> are lists or matricies and <code>x2</code> and
<code>y2</code> are not specified, then <code>x1</code> is taken to be the
coordinates in the current system and <code>y1</code> is the coordinates in
the new system.
</p>
<p>Currently you need to give the function exactly 2 points in each
system.  The 2 points cannot have the same x values or y values in
either system.
</p>


<h3>Value</h3>

<p>An invisible list with the previous 'usr' coordinates from <code>par</code>.
</p>


<h3>Note</h3>

<p>Currently you need to give coordinates for exactly 2 points without
missing values.  Future versions of the function will allow missing
values or multiple points.
</p>


<h3>Author(s)</h3>

<p> Greg Snow, <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+par">par</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>tmp &lt;- barplot(1:4)
updateusr(tmp[1:2], 0:1, 1:2, 0:1)
lines(1:4, c(1,3,2,2), lwd=3, type='b',col='red')

# update the y-axis to put a reference distribution line in the bottom
# quarter

tmp &lt;- rnorm(100)
hist(tmp)
tmp2 &lt;- par('usr')
xx &lt;- seq(min(tmp), max(tmp), length.out=250)
yy &lt;- dnorm(xx, mean(tmp), sd(tmp))
updateusr( tmp2[1:2], tmp2[3:4], tmp2[1:2], c(0, max(yy)*4) )
lines(xx,yy)

</code></pre>

<hr>
<h2 id='USCrimes'>
US Crime Statistics
</h2><span id='topic+USCrimes'></span>

<h3>Description</h3>

<p>This is a 3 dimensional Array of the US crime statistics downloaded
from the &quot;Uniform Crime Reporting Statistics&quot; of the US government.
It comprises the years 1960 through 2010 for all 50 states, Washington
DC, and a total for the country.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(USCrimes)</code></pre>


<h3>Format</h3>

<p>The format is:
num [1:52, 1:51, 1:19] 3266740 226167 1302161 1786272 15717204 ...
- attr(*, &quot;dimnames&quot;)=List of 3
..$ State: chr [1:52] &quot;Alabama&quot; &quot;Alaska&quot; &quot;Arizona&quot; &quot;Arkansas&quot; ...
..$      : chr [1:51] &quot;1960&quot; &quot;1961&quot; &quot;1962&quot; &quot;1963&quot; ...
..$      : chr [1:19] &quot;Population&quot; &quot;ViolentCrimeRate&quot; &quot;MurderRate&quot; &quot;RapeRate&quot; ...
</p>


<h3>Details</h3>

<p>The first dimension is the state, the dimnames match the variable
<code>state.name</code> with the exception of including &quot;District of Columbia&quot;
in the 9th position (alphabetically) and &quot;United States-Total&quot; in
position 45 (alphabetical).
</p>
<p>The second dimension is the year, ranging from 1960 to 2010.  If indexing
by year, remember to put the year in quotes.
</p>
<p>The third dimension is the variable:
</p>

<dl>
<dt>Population:</dt><dd><p>Total number of residents</p>
</dd>
<dt>ViolentCrimeRate:</dt><dd><p>The total of the violent crimes (Murder,
Rape, Robbery, Assault) per 100,000 population</p>
</dd>
<dt>MurderRate:</dt><dd><p>The number of Murders and Nonnegligent
Manslaughters per 100,000 population</p>
</dd>
<dt>RapeRate:</dt><dd><p>Forcible Rapes per 100,000 population</p>
</dd>
<dt>RobberyRate:</dt><dd><p>Robberies per 100,000 population</p>
</dd>
<dt>AssaultRate:</dt><dd><p>Aggravated Assults per 100,000</p>
</dd>
<dt>PropertyCrimeRate:</dt><dd><p>The total of the property crimes (Burglary,
Theft, Vehicle Theft) per 100,000 population</p>
</dd>
<dt>BurglaryRate:</dt><dd><p>Burglaries per 100,000 population</p>
</dd>
<dt>TheftRate:</dt><dd><p>Larceny-Thefts per 100,000 population</p>
</dd>
<dt>VehicleTheftRate:</dt><dd><p>Motor Vehicle Thefts per 100,000 population</p>
</dd>
<dt>ViolentCrimeTotal:</dt><dd><p>The total of the violent crimes (Murder,
Rape, Robbery, Assault</p>
</dd>
<dt>Murder:</dt><dd><p>The number of Murders and Nonnegligent
Manslaughters</p>
</dd>
<dt>Rape:</dt><dd><p>Forcible Rapes</p>
</dd>
<dt>Robbery:</dt><dd><p>Robberies</p>
</dd>
<dt>Assault:</dt><dd><p>Aggravated Assults</p>
</dd>
<dt>PropertyCrimeTotal:</dt><dd><p>The total of the property crimes (Burglary,
Theft, Vehicle Theft)</p>
</dd>
<dt>Burglary:</dt><dd><p>Burglaries</p>
</dd>
<dt>Theft:</dt><dd><p>Larceny-Thefts</p>
</dd>
<dt>VehicleTheft:</dt><dd><p>Motor Vehicle Thefts</p>
</dd>
</dl>



<h3>Source</h3>

<p>Originally: &quot;https://ucrdatatool.gov/&quot;&quot;, but that site does not work any more.  Likely source for similar data: &quot;https://www.fbi.gov/how-we-can-help-you/more-fbi-services-and-information/ucr/publications&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(USCrimes)
## maybe str(USCrimes)

# plot time series/sparkline for each state
if(require(spData) &amp;&amp; interactive()) {
	data(state.vbm)
	plot(state.vbm)

	tmp.x &lt;- state.vbm$center_x
	tmp.x &lt;- c( tmp.x[1:8], 147, tmp.x[9:43], 83, tmp.x[44:50] )
	tmp.y &lt;- state.vbm$center_y
	tmp.y &lt;- c( tmp.y[1:8], 45, tmp.y[9:43], -18, tmp.y[44:50] )
	tmp.r &lt;- range( USCrimes[,,'ViolentCrimeRate'], na.rm=TRUE)
	for(i in 1:52) {
		subplot( plot(1960:2010, USCrimes[i,,'ViolentCrimeRate'],
					ann=FALSE, bty='n', type='l', axes=FALSE),
			tmp.x[i], tmp.y[i], size=c(0.2,0.2) )
	}
}


## Gapminder style animation over time
if( interactive() ) {
x.r &lt;- range( USCrimes[-c(9,45),,'Population'], na.rm=TRUE )
y.r &lt;- range( USCrimes[-c(9,45),,'PropertyCrimeRate'], na.rm=TRUE )

tmpfun &lt;- function(Year=1960, ... ) {
	y &lt;- as.character(Year)
	plot( USCrimes[-c(9,45),y,'Population'],
		 USCrimes[-c(9,45),y,'PropertyCrimeRate'],
		type='n', xlab='log Population',
		ylab='Property Crime Rate',
		main=y, xlim=x.r, ylim=y.r, log='x' )
	text( USCrimes[-c(9,45),y,'Population'],
		 USCrimes[-c(9,45),y,'PropertyCrimeRate'],
		state.abb, ... )
}

tmp.list &lt;- list( Year=list('animate', from=1960, to=2010, delay=250) )

tmpcol &lt;- c('blue','darkgreen','red','purple')[state.region]
tkexamp( tmpfun(col=tmpcol), tmp.list )
}
</code></pre>

<hr>
<h2 id='vis.binom'> Plot various distributions then interactivly adjust the parameters. </h2><span id='topic+vis.binom'></span><span id='topic+vis.gamma'></span><span id='topic+vis.normal'></span><span id='topic+vis.t'></span>

<h3>Description</h3>

<p>Plot a curve of a distribution, then using a Tk slider window adjust
the parameters and see how the distribution changes.  Optionally also
plots reference distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vis.binom()
vis.gamma()
vis.normal()
vis.t()
</code></pre>


<h3>Details</h3>

<p>These functions plot a distribution, then create a Tk slider box that
allows you to adjust the parameters of the distribution to see how the
curve changes.
</p>
<p>Check boxes are available in some cases to also show reference
distributions (normal and poisson for the binomial, exponential and
chi-squared for gamma, and normal for t).  The exponential and
chi-squared distributions are those with the same mean as the plotted
gamma. 
</p>
<p>If you change the plotting
ranges then you need to click on the 'refresh' button to update the plot.
</p>


<h3>Value</h3>

<p>These functions are run for their side effects and do not return
anything meaningful.
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+dnorm">dnorm</a></code>, <code><a href="stats.html#topic+dgamma">dgamma</a></code>, etc. </p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
vis.binom()
vis.normal()
vis.gamma()
vis.t()
}
</code></pre>

<hr>
<h2 id='vis.boxcox'> Interactively visualize Box-Cox transformations </h2><span id='topic+vis.boxcox'></span><span id='topic+vis.boxcox.old'></span><span id='topic+vis.boxcoxu'></span><span id='topic+vis.boxcoxu.old'></span>

<h3>Description</h3>

<p>Explore the Box-Cox family of distributions by plotting data
transformed and untransformed and interactively choose values for lambda.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vis.boxcox(lambda = sample(c(-1,-0.5,0,1/3,1/2,1,2), 1),
           hscale=1.5, vscale=1.5, wait=FALSE)

vis.boxcoxu(lambda = sample( c(-1,-0.5,0,1/3,1/2,1,2), 1),
                        y, xlab=deparse(substitute(y)), 
                        hscale=1.5, vscale=1.5, wait=FALSE)

vis.boxcox.old(lambda = sample(c(-1, -0.5, 0, 1/3, 1/2, 1, 2), 1))

vis.boxcoxu.old(lambda = sample(c(-1, -0.5, 0, 1/3, 1/2, 1, 2), 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vis.boxcox_+3A_lambda">lambda</code></td>
<td>
<p> The true value of lambda to use. </p>
</td></tr>
<tr><td><code id="vis.boxcox_+3A_y">y</code></td>
<td>
<p> Optional data to use in the transform. </p>
</td></tr>
<tr><td><code id="vis.boxcox_+3A_xlab">xlab</code></td>
<td>
<p> Label for x-axis.</p>
</td></tr>
<tr><td><code id="vis.boxcox_+3A_hscale">hscale</code></td>
<td>
<p> The horizontal scale, passed to <code>tkrplot</code>. </p>
</td></tr>
<tr><td><code id="vis.boxcox_+3A_vscale">vscale</code></td>
<td>
<p> The vertical scale, passed to <code>tkrplot</code>. </p>
</td></tr>
<tr><td><code id="vis.boxcox_+3A_wait">wait</code></td>
<td>
<p> Should R wait for the demo window to close. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions will generate a sample of data and plot the
untrasformed data (left panels) and the transformed data (right
panels).  Initially the value of <code>lambda</code> is 1 and the 2 sets of
plots will be identical.
</p>
<p>You then adjust the transformation parameter <code>lambda</code> to see how
the right panels change.
</p>
<p>The function <code>vis.boxcox</code> shows the effect of transforming the
y-variable in a simple linear regression.
</p>
<p>The function <code>vis.boxcoxu</code> shows a single variable compared to
the normal distribution.
</p>


<h3>Value</h3>

<p>The old versions have no useful return value.  If <code>wait</code> is FALSE
then they will return an invisible NULL, if <code>wait</code> is TRUE then
the return value will be a list with the final value of <code>lamda</code>,
the original data, and the transformed y (at the final <code>lamda</code> value).
</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>References</h3>

<p> GEP Box; DR Cox. An Analysis of Transformations.  Journal
of the Royal Statitical Society. Series B, Vol. 26, No. 2 (1964) 211-252 </p>


<h3>See Also</h3>

 <p><code><a href="#topic+bct">bct</a></code>, <code>boxcox</code> in package MASS </p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()) {
vis.boxcoxu()
vis.boxcox()
}
</code></pre>

<hr>
<h2 id='vis.test'>
Do a Visual test of a null hypothesis by choosing the graph that does
not belong.
</h2><span id='topic+vis.test'></span><span id='topic+vt.qqnorm'></span><span id='topic+vt.normhist'></span><span id='topic+vt.scatterpermute'></span><span id='topic+vt.tspermute'></span><span id='topic+vt.residpermute'></span><span id='topic+vt.residsim'></span>

<h3>Description</h3>

<p>These functions help in creating a set of plots based on the real data
and some modification that makes the null hypothesis true.  The user
then tries to choose which graph represents the real data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vis.test(..., FUN, nrow=3, ncol=3, npage=3, data.name = "", alternative)
vt.qqnorm(x, orig=TRUE)
vt.normhist(x, ..., orig=TRUE)
vt.scatterpermute(x, y, ..., orig=TRUE)
vt.tspermute(x, type='l', ..., orig=TRUE)
vt.residpermute(model, ..., orig=TRUE)
vt.residsim(model, ..., orig=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vis.test_+3A_...">...</code></td>
<td>
<p> data and arguments to be passed on to <code>FUN</code> or to
plotting functions, see details below</p>
</td></tr>
<tr><td><code id="vis.test_+3A_fun">FUN</code></td>
<td>
<p> The function to create the plots on the original or null
hypothesis data</p>
</td></tr>
<tr><td><code id="vis.test_+3A_nrow">nrow</code></td>
<td>
<p> The number of rows of graphs per page </p>
</td></tr>
<tr><td><code id="vis.test_+3A_ncol">ncol</code></td>
<td>
<p> The number of columns of graphs per page </p>
</td></tr>
<tr><td><code id="vis.test_+3A_npage">npage</code></td>
<td>
<p> The number of pages to use in the testing </p>
</td></tr>
<tr><td><code id="vis.test_+3A_data.name">data.name</code></td>
<td>
<p>Optional character string for the name of the data in
the output</p>
</td></tr>
<tr><td><code id="vis.test_+3A_alternative">alternative</code></td>
<td>
<p>Optional character string for the alternative
hypothesis in the output</p>
</td></tr>
<tr><td><code id="vis.test_+3A_orig">orig</code></td>
<td>
<p> Logical, should the original data be plotted, or data
based on the null hypothesis </p>
</td></tr>
<tr><td><code id="vis.test_+3A_x">x</code></td>
<td>
<p>data or x-coordinates of the data</p>
</td></tr>
<tr><td><code id="vis.test_+3A_y">y</code></td>
<td>
<p>y-coordinates of the data</p>
</td></tr>
<tr><td><code id="vis.test_+3A_type">type</code></td>
<td>
<p>type of plot, passed on to plot function (use 'p' for
points)</p>
</td></tr>
<tr><td><code id="vis.test_+3A_model">model</code></td>
<td>
<p>An <code>lm</code> object, or any model object for which
<code>fitted</code> and <code>resid</code> return vectors</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>vis.test</code> function will create a <code>nrow</code> by <code>ncol</code>
grid of plots, one
of which is based on the real (original) data and the others which
are based on a null hypothesis simulation (a statistical &quot;lineup&quot;).
The real plot is placed at
random within the set.  The user then clicks on their best guess
of which plot is the real one (the most different from the others).
If the null hypothesis is true for the real data, then this will be a
guess with a 1/(<code>nrow</code>*<code>ncol</code>) probability of success.  This
process is then
repeated for a total of <code>npage</code> times.   A p-value is then
constructed based on the
number of correct guesses and the null hypothesis that
there is a 1/(<code>nrow</code>*<code>ncol</code>) chance of guessing correct each
time (this will work
best if the person doing the choosing has not already seen
plots/summaries of the data).
</p>
<p>If the plotting function (<code>FUN</code>) is not passed as a named
argument, then the first argument (in the ...) that is a function
will be used.  If no functions are passed then the function will stop
with an error.
</p>
<p>The plotting function (<code>FUN</code>) can be an existing function or a
user supplied function.  The function must have an argument named
&quot;orig&quot; which indicates whether to plot the original data or the null
hypothesis data.  A new seed will be set before each call to
<code>FUN</code> except when <code>orig</code> is <code>TRUE</code>.  Inside the
function if <code>orig</code> is <code>TRUE</code> then the function should plot
the original data.  When <code>orig</code> is <code>FALSE</code> then the function
should do some form of simulation based on the data with the null
hypothesis true and plot the simulated data (making sure to give no
signs that it is different from the original plot).
</p>
<p>The return object includes a list with the seeds set before each of
the plots (<code>NA</code> for the original data plot) and a vector of the
plots selected by the user.  This information can be used to recreate
the simulated plots by setting the seed then calling <code>FUN</code>.
</p>
<p>The <code>vt.qqnorm</code> function tests the null hypothesis that a vector
of data comes from a normal distribution (or at least pretty close) by
creating a <code>qqnorm</code> plot of the original data, or the same plot
of random data from a normal distribution with the same mean and
standard deviation as the original data.
</p>
<p>The <code>vt.normhist</code> function tests the null hypothesis that a
vector of data comes from a normal distribution (or at least pretty
close) by plotting a histogram with a reference line representing a
normal distribution of either the original data or a set of random
data from a normal distribution with the same mean and standard
deviation as the original.
</p>
<p>The <code>vt.scatterpermute</code> function tests the null hypothesis of &quot;no
relationship&quot; between 2 vectors of data.  When <code>orig</code> is <code>TRUE</code> the
function creates a scatterplot of the 2 variables, when <code>orig</code> is
<code>FALSE</code> the function first permutes the y variable randomly
(making no relationship) then creates a scatter plot with the original
x and permuted y variables.
</p>
<p>The <code>vt.tspermute</code> function creates a time series type plot of a
single vector against its index.  When <code>orig</code> is false, the
vector is permuted before plotting.
</p>
<p>The <code>vt.residpermute</code> function takes a regression object (class
lm, or any model type object for which <code>fitted</code> and <code>resid</code>
return vectors) and does a residual plot of the fitted values on the x
axis and residuals on the y axis.  The loess smooth curve
(<code>scatter.smooth</code> is the plotting function) and a reference line
at 0 are included.  When <code>orig</code> is <code>FALSE</code> the residuals are
randomly permuted before being plotted.
</p>
<p>The <code>vt.residsim</code> function takes a regression object (class lm,
or any model type object for which <code>fitted</code> and <code>resid</code>
return vectors) and does a residual plot of the fitted values on the x
axis and residuals on the y axis.  The loess smooth curve
(<code>scatter.smooth</code> is the plotting function) and a reference line
at 0 are included.  When <code>orig</code> is <code>FALSE</code> the residuals are
simulate from a normal distribution with mean 0 and standard deviation
the same as the residuals.
</p>


<h3>Value</h3>

<p>The <code>vis.test</code> function returns an object of class <code>htest</code>
with the following components:
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>The string &quot;Visual Test&quot;</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>The name of the data passed to the function</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>The number of correct &quot;guesses&quot;</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The p-value based on the number of correct &quot;guesses&quot;</p>
</td></tr>
<tr><td><code>nrow</code></td>
<td>
<p>The number of rows per page</p>
</td></tr>
<tr><td><code>ncol</code></td>
<td>
<p>The number of columns per page</p>
</td></tr>
<tr><td><code>npage</code></td>
<td>
<p>The number of pages</p>
</td></tr>
<tr><td><code>seeds</code></td>
<td>
<p>A list with 3 vectors containing the seeds set before
calling <code>FUN</code>, the correct plot has an <code>NA</code></p>
</td></tr>
<tr><td><code>selected</code></td>
<td>
<p>A vector of length <code>npage</code> indicating the number of the
figure picked in each of the <code>npage</code> tries</p>
</td></tr>
</table>
<p>The other functions are run for their side effects and do not return
anything meaningful.
</p>


<h3>Warning</h3>

<p>The p-value is based on the assumption that under the
null hypothesis there is a 1/(<code>nrow</code>*<code>ncol</code>) chance of
picking the correct plot
and that the <code>npage</code> choices are independent of each other.  This
may not be
true if the user is familiar with the data or remembers details of the
plot between picks.</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>References</h3>

<p>Buja, A., Cook, D. Hofmann, H., Lawrence, M. Lee, E.-K., Swayne, D.F and
Wickham, H. (2009) Statistical Inference for exploratory data analysis
and model diagnostics Phil. Trans. R. Soc. A 2009 367, 4361-4383 doi:
10.1098/rsta.2009.0120
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+set.seed">set.seed</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
if(interactive()) {
  x &lt;- rexp(25, 1/3)
  vis.test(x, vt.qqnorm)

  x &lt;- rnorm(100, 50, 3)
  vis.test(x, vt.normhist)
}

</code></pre>

<hr>
<h2 id='z.test'> Z test for known population standard deviation </h2><span id='topic+z.test'></span>

<h3>Description</h3>

<p>Compute the test of hypothesis and compute confidence interval on the
mean of a population when the standard deviation of the population is known.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>z.test(x, mu = 0, stdev, alternative = c("two.sided", "less", "greater"),
  sd = stdev, n=length(x), conf.level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="z.test_+3A_x">x</code></td>
<td>
<p> Vector of data values or the mean of the data. </p>
</td></tr>
<tr><td><code id="z.test_+3A_mu">mu</code></td>
<td>
<p> Hypothesized mean of the population. </p>
</td></tr>
<tr><td><code id="z.test_+3A_stdev">stdev</code></td>
<td>
<p> Known standard deviation of the population. </p>
</td></tr>
<tr><td><code id="z.test_+3A_alternative">alternative</code></td>
<td>
<p> Direction of the alternative hypothesis. </p>
</td></tr>
<tr><td><code id="z.test_+3A_sd">sd</code></td>
<td>
<p> Alternative to <code>stdev</code> </p>
</td></tr>
<tr><td><code id="z.test_+3A_n">n</code></td>
<td>
<p> The sample size if <code>x</code> is the sample mean. </p>
</td></tr>
<tr><td><code id="z.test_+3A_conf.level">conf.level</code></td>
<td>
<p> Confidence level for the interval computation. </p>
</td></tr>
<tr><td><code id="z.test_+3A_...">...</code></td>
<td>
<p> Additional arguments are silently ignored. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Many introductory statistical texts introduce inference by using the Z
test and Z based confidence intervals based on knowing the population
standard deviation.  Most statistical packages do not include
functions to do Z tests since the T test is usually more appropriate
for real world situations.  This function is meant to be used during
that short period of learning when the student is learning about
inference using Z procedures, but has not learned the T based
procedures yet.  Once the student has learned about the T
distribution the <code>t.test</code> function should be used instead of this
one (but the syntax is very similar, so this function should be an
appropriate introductory step to learning <code>t.test</code>).
</p>


<h3>Value</h3>

<p>An object of class <code>htest</code> containing the results
</p>


<h3>Note</h3>

<p> This function should be used for learning only, real data should
generally use <code>t.test</code>. </p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a> </p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+t.test">t.test</a></code>, <code><a href="stats.html#topic+print.htest">print.htest</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(25, 100, 5)
z.test(x, 99, 5)

</code></pre>

<hr>
<h2 id='zoomplot'>Zoom or unzoom an existing plot in the plot window</h2><span id='topic+oldzoomplot'></span><span id='topic+zoomplot'></span>

<h3>Description</h3>

<p>This function allows you to change the x and y ranges of
the plot that is currently in the plot window.  This has the effect of
zooming into a section of the plot, or zooming out (unzooming) to show
a larger region than is currently shown.</p>


<h3>Usage</h3>

<pre><code class='language-R'>zoomplot(xlim, ylim=NULL )
oldzoomplot(xlim, ylim=NULL )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zoomplot_+3A_xlim">xlim</code>, <code id="zoomplot_+3A_ylim">ylim</code></td>
<td>
<p>The new x and y limits of the plot.  These can be
passed in in any form understood by <code>xy.coords</code>.  The range of
xlim and ylim are actually used so you can pass in more than 2 points.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function recreates the current plot in the graphics window but
with different xlim, ylim arguments.  This gives the effect of zooming
or unzooming the plot.
</p>
<p>This only works with traditional graphics (not lattice/trellis).
</p>
<p>This function is a quick hack that should only be used for quick
exploring of data.  For any serious work you should create a script
with the plotting commands and adjust the xlim and ylim parameters to
give the plot that you want.
</p>
<p>Only the x and y ranges are changed, the size of the plotting
characters and text will stay the same.
</p>
<p>The <code>oldzoomplot</code> function is the version that worked for 2.15
and earlier, <code>zoomplot</code> should be used for R 3.0.
</p>


<h3>Value</h3>

<p>This function is run for its side effects and does not return anything
meaningful.
</p>


<h3>Note</h3>

<p> For any serious projects it is best to put your code into a
script to begin with and edit the original script rather than using
this function.
</p>
<p>This function works with the standard <code>plot</code> function and some
others, but may not work for more complicated plots.
</p>
<p>This function depends on the <code>recordPlot</code> function which can
change in any version.  Therefore this function should not be
considered stable.
</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot.default">plot.default</a></code>, <code><a href="graphics.html#topic+par">par</a></code>,
<code><a href="graphics.html#topic+matplot">matplot</a></code>, <code><a href="#topic+plot2script">plot2script</a></code>,
<code><a href="base.html#topic+source">source</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){

with(iris, plot(Sepal.Length, Petal.Width,
    col=c('red','green','blue')[Species]))
text( 6.5, 1.5, 'test' )
zoomplot( locator(2) ) # now click on 2 points in the plot to zoom in

plot( 1:10, rnorm(10) )
tmp &lt;- rnorm(10,1,3)
lines( (1:10) + 0.5, tmp, col='red' )
zoomplot( c(0,11), range(tmp) )
}
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
