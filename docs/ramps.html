<!DOCTYPE html><html><head><title>Help for package ramps</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ramps}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#corRCauchy'><p>Cauchy Spatial Correlation Structure</p></a></li>
<li><a href='#corRClasses'><p>Spatial Correlation Structure Classes</p></a></li>
<li><a href='#corRExp'><p>Exponential Spatial Correlation Structure</p></a></li>
<li><a href='#corRExp2'><p>Non-Separable Exponential Spatio-Temporal Correlation Structure</p></a></li>
<li><a href='#corRExpwr'><p>Powered Exponential Spatial Correlation Structure</p></a></li>
<li><a href='#corRExpwr2'><p>Non-Separable Powered Exponential Spatio-Temporal Correlation Structure</p></a></li>
<li><a href='#corRExpwr2Dt'><p>Non-Separable Temporally Integrated Powered Exponential Spatial Correlation Structure</p></a></li>
<li><a href='#corRGaus'><p>Gaussian Spatial Correlation Structure</p></a></li>
<li><a href='#corRGneit'><p>Gneiting Spatial Correlation Structure</p></a></li>
<li><a href='#corRLin'><p>Linear Spatial Correlation Structure</p></a></li>
<li><a href='#corRMatern'><p>Matern Spatial Correlation Structure</p></a></li>
<li><a href='#corRSpher'><p>Spherical Spatial Correlation Structure</p></a></li>
<li><a href='#corRWave'><p>Sine Wave Spatial Correlation Structure</p></a></li>
<li><a href='#DIC'><p>Deviance Information Criterion</p></a></li>
<li><a href='#expand.chain'><p>Expand MCMC Samples for georamps Model Fits</p></a></li>
<li><a href='#genUSStateGrid'><p> Generating a Grid over a US State</p></a></li>
<li><a href='#genUSStateSites'><p> Generating Random Sites in a US State</p></a></li>
<li><a href='#georamps'><p>Bayesian Geostatistical Model Fitting with RAMPS</p></a></li>
<li><a href='#NURE'><p>Dataset of USGS NURE Uranium Measurements</p></a></li>
<li><a href='#param'><p>Initialization of georamps Model Parameters</p></a></li>
<li><a href='#plot'><p>Posterior Spatial Distribution Plots</p></a></li>
<li><a href='#predict.ramps'><p>Prediction Method for georamps Model Fits</p></a></li>
<li><a href='#ramps.control'><p>Auxiliary for Controlling georamps Model Fitting</p></a></li>
<li><a href='#simJSS'><p>Dataset of Simulated Measurements from JSS Publication</p></a></li>
<li><a href='#summary.ramps'><p>Posterior Summaries of georamps Model Fits</p></a></li>
<li><a href='#window'><p>Subsetting of MCMC Sampler Results</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Bayesian Geostatistical Modeling with RAMPS</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.18</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-03-13</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Brian J Smith &lt;brian-j-smith@uiowa.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>coda, maps, Matrix, nlme</td>
</tr>
<tr>
<td>Imports:</td>
<td>fields, graphics, grDevices, methods, stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Bayesian geostatistical modeling of Gaussian processes using a
    reparameterized and marginalized posterior sampling (RAMPS) algorithm
    designed to lower autocorrelation in MCMC samples.  Package performance is
    tuned for large spatial datasets.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.jstatsoft.org/v25/i10">https://www.jstatsoft.org/v25/i10</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-13 13:30:00 UTC; bjsmith</td>
</tr>
<tr>
<td>Author:</td>
<td>Brian J Smith [aut, cre],
  Jun Yan [aut],
  Mary Kathryn Cowles [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-13 14:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='corRCauchy'>Cauchy Spatial Correlation Structure</h2><span id='topic+corRCauchy'></span>

<h3>Description</h3>

<p>This function is a constructor for the <code>'corRCauchy'</code> class, representing a Cauchy (rational quadratic) spatial correlation structure. Letting <code class="reqn">r</code> denote the range, the correlation between two observations a distance <code class="reqn">d</code> apart is <code class="reqn">1/(1+(d/r)^2)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   corRCauchy(value = numeric(0), form = ~ 1,
             metric = c("euclidean", "maximum", "manhattan", "haversine"),
             radius = 3956)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corRCauchy_+3A_value">value</code></td>
<td>
<p>optional numeric &ldquo;range&rdquo; parameter value for the rational quadratic correlation structure, which must be greater than zero.  Defaults to <code>numeric(0)</code>, which results in a range of 90% of the minimum distance being assigned to the parameter when <code>object</code> is initialized.</p>
</td></tr>
<tr><td><code id="corRCauchy_+3A_form">form</code></td>
<td>
<p>one-sided formula of the form <code>~ S1+...+Sp</code>, specifying spatial covariates <code>S1</code> through <code>Sp</code>. Defaults to <code>~ 1</code>, which corresponds to using the order of the observations in the data as a covariate.</p>
</td></tr>
<tr><td><code id="corRCauchy_+3A_metric">metric</code></td>
<td>
<p>optional character string specifying the distance metric to be used. The currently available options are <code>"euclidean"</code> for the root sum-of-squares of distances;   <code>"maximum"</code> for the maximum difference; <code>"manhattan"</code> for the sum of the absolute differences; and <code>"haversine"</code> for the great-circle distance (miles) between longitude/latitude coordinates. Partial matching of arguments is used, so only the first three characters need to be provided. Defaults to <code>"euclidean"</code>.</p>
</td></tr>
<tr><td><code id="corRCauchy_+3A_radius">radius</code></td>
<td>
<p>radius to be used in the haversine formula for great-circle distance.  Defaults to the Earth's radius of 3,956 miles.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>'corRCauchy'</code>, also inheriting from class <code>'corRSpatial'</code>, representing a rational quadratic spatial correlation structure.
</p>


<h3>Note</h3>

<p>When <code>"haversine"</code> is used as the distance metric, longitude and latitude coordinates must be given as the first and second covariates, respectively, in the formula specification for the <code>form</code> argument.
</p>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a> and Jose Pinheiro <a href="mailto:Jose.Pinheiro@pharma.novartis.com">Jose.Pinheiro@pharma.novartis.com</a>, and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a> 
</p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), &ldquo;Statistics for Spatial Data&rdquo;, J. Wiley &amp; Sons.
</p>
<p>Venables, W.N. and Ripley, B.D. (1997) &ldquo;Modern Applied Statistics with S-plus&rdquo;, 2nd Edition, Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+corRClasses">corRClasses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sp1 &lt;- corRCauchy(form = ~ x + y + z)

spatDat &lt;- data.frame(x = (0:4)/4, y = (0:4)/4)

cs1Cauchy &lt;- corRCauchy(1, form = ~ x + y)
cs1Cauchy &lt;- Initialize(cs1Cauchy, spatDat)
corMatrix(cs1Cauchy)

cs2Cauchy &lt;- corRCauchy(1, form = ~ x + y, metric = "man")
cs2Cauchy &lt;- Initialize(cs2Cauchy, spatDat)
corMatrix(cs2Cauchy)
</code></pre>

<hr>
<h2 id='corRClasses'>Spatial Correlation Structure Classes</h2><span id='topic+corRClasses'></span>

<h3>Description</h3>

<p>Standard classes of spatial correlation structures available for the <code><a href="#topic+georamps">georamps</a></code> function.
</p>
<p>Spatial Structures:
</p>

<dl>
<dt><code><a href="#topic+corRCauchy">corRCauchy</a></code></dt><dd><p>Cauchy correlation.</p>
</dd>
<dt><code><a href="#topic+corRExp">corRExp</a></code></dt><dd><p>exponential correlation.</p>
</dd>
<dt><code><a href="#topic+corRExpwr">corRExpwr</a></code></dt><dd><p>powered exponential correlation.</p>
</dd>
<dt><code><a href="#topic+corRGaus">corRGaus</a></code></dt><dd><p>Gaussian correlation.</p>
</dd>
<dt><code><a href="#topic+corRGneit">corRGneit</a></code></dt><dd><p>Gneiting approximation to Gaussian correlation.</p>
</dd>
<dt><code><a href="#topic+corRLin">corRLin</a></code></dt><dd><p>linear correlation.</p>
</dd>
<dt><code><a href="#topic+corRMatern">corRMatern</a></code></dt><dd><p>Matern correlation.</p>
</dd>
<dt><code><a href="#topic+corRSpher">corRSpher</a></code></dt><dd><p>spherical correlation.</p>
</dd>
<dt><code><a href="#topic+corRWave">corRWave</a></code></dt><dd><p>sine wave correlation.</p>
</dd>
</dl>

<p>Spatio-Temporal Structures:
</p>

<dl>
<dt><code><a href="#topic+corRExp2">corRExp2</a></code></dt><dd><p>exponential correlation.</p>
</dd>
<dt><code><a href="#topic+corRExpwr2">corRExpwr2</a></code></dt><dd><p>powered exponential correlation.</p>
</dd>
</dl>

<p>Temporally Integrated Spatial Structure:
</p>

<dl>
<dt><code><a href="#topic+corRExpwr2Dt">corRExpwr2Dt</a></code></dt><dd><p>powered exponential correlation.</p>
</dd>
</dl>



<h3>Note</h3>

<p>Users may define their own <code>corRStruct</code> classes by specifying a <code>constructor</code> function and, at a minimum, methods for the functions <code>corMatrix</code> and <code>coef</code>.
</p>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a> and Jose Pinheiro <a href="mailto:Jose.Pinheiro@pharma.novartis.com">Jose.Pinheiro@pharma.novartis.com</a>, and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a> 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+corRCauchy">corRCauchy</a></code>,
<code><a href="#topic+corRExp">corRExp</a></code>,
<code><a href="#topic+corRExp2">corRExp2</a></code>,
<code><a href="#topic+corRExpwr">corRExpwr</a></code>,
<code><a href="#topic+corRExpwr2">corRExpwr2</a></code>,
<code><a href="#topic+corRExpwr2Dt">corRExpwr2Dt</a></code>,
<code><a href="#topic+corRGaus">corRGaus</a></code>,
<code><a href="#topic+corRGneit">corRGneit</a></code>,
<code><a href="#topic+corRLin">corRLin</a></code>,
<code><a href="#topic+corRMatern">corRMatern</a></code>,
<code><a href="#topic+corRSpher">corRSpher</a></code>
<code><a href="#topic+corRWave">corRWave</a></code>
</p>

<hr>
<h2 id='corRExp'>Exponential Spatial Correlation Structure</h2><span id='topic+corRExp'></span>

<h3>Description</h3>

<p>This function is a constructor for the <code>'corRExp'</code> class, representing an exponential spatial correlation structure. Letting <code class="reqn">r</code> denote the range, the correlation between two observations a distance <code class="reqn">d</code> apart is <code class="reqn">\exp(-d/r)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   corRExp(value = numeric(0), form = ~ 1,
           metric = c("euclidean", "maximum", "manhattan", "haversine"),
           radius = 3956)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corRExp_+3A_value">value</code></td>
<td>
<p>optional numeric &ldquo;range&rdquo; parameter value for the exponential correlation structure, which must be greater than zero.  Defaults to <code>numeric(0)</code>, which results in a range of 90% of the minimum distance being assigned to the parameter when <code>object</code> is initialized.</p>
</td></tr>
<tr><td><code id="corRExp_+3A_form">form</code></td>
<td>
<p>one-sided formula of the form <code>~ S1+...+Sp</code>, specifying spatial covariates <code>S1</code> through <code>Sp</code>. Defaults to <code>~ 1</code>, which corresponds to using the order of the observations in the data as a covariate.</p>
</td></tr>
<tr><td><code id="corRExp_+3A_metric">metric</code></td>
<td>
<p>optional character string specifying the distance metric to be used. The currently available options are <code>"euclidean"</code> for the root sum-of-squares of distances;   <code>"maximum"</code> for the maximum difference; <code>"manhattan"</code> for the sum of the absolute differences; and <code>"haversine"</code> for the great-circle distance between longitude/latitude coordinates. Partial matching of arguments is used, so only the first three characters need to be provided. Defaults to <code>"euclidean"</code>.</p>
</td></tr>
<tr><td><code id="corRExp_+3A_radius">radius</code></td>
<td>
<p>radius to be used in the haversine formula for great-circle distance.  Defaults to the Earth's radius of 3,956 miles.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>'corRExp'</code>, also inheriting from class <code>'corRSpatial'</code>, representing an exponential spatial correlation structure.
</p>


<h3>Note</h3>

<p>When <code>"haversine"</code> is used as the distance metric, longitude and latitude coordinates must be given as the first and second covariates, respectively, in the formula specification for the <code>form</code> argument.
</p>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a> and Jose Pinheiro <a href="mailto:Jose.Pinheiro@pharma.novartis.com">Jose.Pinheiro@pharma.novartis.com</a>, and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a> 
</p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), &ldquo;Statistics for Spatial Data&rdquo;, J. Wiley &amp; Sons.
</p>
<p>Venables, W.N. and Ripley, B.D. (1997) &ldquo;Modern Applied Statistics with S-plus&rdquo;, 2nd Edition, Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+corRClasses">corRClasses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sp1 &lt;- corRExp(form = ~ x + y + z)

spatDat &lt;- data.frame(x = (0:4)/4, y = (0:4)/4)

cs1Exp &lt;- corRExp(1, form = ~ x + y)
cs1Exp &lt;- Initialize(cs1Exp, spatDat)
corMatrix(cs1Exp)

cs2Exp &lt;- corRExp(1, form = ~ x + y, metric = "man")
cs2Exp &lt;- Initialize(cs2Exp, spatDat)
corMatrix(cs2Exp)
</code></pre>

<hr>
<h2 id='corRExp2'>Non-Separable Exponential Spatio-Temporal Correlation Structure</h2><span id='topic+corRExp2'></span>

<h3>Description</h3>

<p>This function is a constructor for the <code>'corRExp2'</code> class, representing a non-separable spatial correlation structure. Letting <code class="reqn">rs</code> denote the spatial range, <code class="reqn">rt</code> the temporal range, and <code class="reqn">lambda</code> the space-time interaction, the correlation between two observations a distance <code class="reqn">d</code> apart in space and <code class="reqn">t</code> in time is <code class="reqn">\exp(-d/rs - t/rt - \lambda (d/rs) (t/rt))</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   corRExp2(value = numeric(0), form = ~ 1,
            metric = c("euclidean", "maximum", "manhattan", "haversine"),
            radius = 3956)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corRExp2_+3A_value">value</code></td>
<td>
<p>optional numeric vector of three parameter values for the exponential correlation structure, corresponding to the &ldquo;spatial range&rdquo;, &ldquo;temporal range&rdquo;, and &ldquo;space-time interaction&rdquo;.  The range parameter values must be greater than zero, and the interaction greater than or equal to zero.  Defaults to <code>numeric(0)</code>, which results in ranges of 90% of the minimum distances and an interaction of 0 being assigned to the parameters when <code>object</code> is initialized.</p>
</td></tr>
<tr><td><code id="corRExp2_+3A_form">form</code></td>
<td>
<p>one-sided formula of the form <code>~ S1+...+Sp+T</code>, specifying spatial covariates <code>S1</code> through <code>Sp</code> and the times <code>T</code> at which measurement were taken.</p>
</td></tr>
<tr><td><code id="corRExp2_+3A_metric">metric</code></td>
<td>
<p>optional character string specifying the distance metric to be used. The currently available options are <code>"euclidean"</code> for the root sum-of-squares of distances;   <code>"maximum"</code> for the maximum difference; <code>"manhattan"</code> for the sum of the absolute differences; and <code>"haversine"</code> for the great-circle distance (miles) between longitude/latitude coordinates. Partial matching of arguments is used, so only the first three characters need to be provided. Defaults to <code>"euclidean"</code>.</p>
</td></tr>
<tr><td><code id="corRExp2_+3A_radius">radius</code></td>
<td>
<p>radius to be used in the haversine formula for great-circle distance.  Defaults to the Earth's radius of 3,956 miles.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>'corRExp2'</code>, inheriting from class <code>'corRSpatioTemporal'</code>, representing a non-separable spatial correlation structure.
</p>


<h3>Note</h3>

<p>When <code>"haversine"</code> is used as the distance metric, longitude and latitude coordinates must be given as the first and second covariates, respectively, in the formula specification for the <code>form</code> argument.
</p>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a>
</p>


<h3>References</h3>

<p>Cressie, N. and Huang, H.-C. (1993) &ldquo;Classes of Nonseperable, Spatio-Temporal Stationary Covariance Functions&rdquo;, <em>Journal of the American Statistical Association</em>, 94, 1330-1340.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+corRClasses">corRClasses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sp1 &lt;- corRExp2(form = ~ x + y + t)

spatDat &lt;- data.frame(x = (0:4)/4, y = (0:4)/4, t=(0:4)/4)

cs1Exp &lt;- corRExp2(c(1, 1, 1), form = ~ x + y + t)
cs1Exp &lt;- Initialize(cs1Exp, spatDat)
corMatrix(cs1Exp)

cs2Exp &lt;- corRExp2(c(1, 1, 1), form = ~ x + y + t, metric = "man")
cs2Exp &lt;- Initialize(cs2Exp, spatDat)
corMatrix(cs2Exp)
</code></pre>

<hr>
<h2 id='corRExpwr'>Powered Exponential Spatial Correlation Structure</h2><span id='topic+corRExpwr'></span>

<h3>Description</h3>

<p>This function is a constructor for the <code>'corRExpwr'</code> class, representing a powered exponential spatial correlation structure. Letting <code class="reqn">r</code> denote the range and <code class="reqn">p</code> the shape, the correlation between two observations a distance <code class="reqn">d</code> apart is <code class="reqn">\exp(-(d/r)^p)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   corRExpwr(value = numeric(0), form = ~ 1,
             metric = c("euclidean", "maximum", "manhattan", "haversine"),
             radius = 3956)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corRExpwr_+3A_value">value</code></td>
<td>
<p>optional numeric vector of two parameter values for the powered exponential correlation structure, corresponding to the &ldquo;range&rdquo; and &ldquo;shape&rdquo;.  The range parameter value must be greater than zero, and the shape in the interval (0, 2].  Defaults to <code>numeric(0)</code>, which results in a range of 90% of the minimum distance and a shape of 1 being assigned to the parameter when <code>object</code> is initialized.</p>
</td></tr>
<tr><td><code id="corRExpwr_+3A_form">form</code></td>
<td>
<p>one-sided formula of the form <code>~ S1+...+Sp</code>, specifying spatial covariates <code>S1</code> through <code>Sp</code>. Defaults to <code>~ 1</code>, which corresponds to using the order of the observations in the data as a covariate.</p>
</td></tr>
<tr><td><code id="corRExpwr_+3A_metric">metric</code></td>
<td>
<p>optional character string specifying the distance metric to be used. The currently available options are <code>"euclidean"</code> for the root sum-of-squares of distances;   <code>"maximum"</code> for the maximum difference; <code>"manhattan"</code> for the sum of the absolute differences; and <code>"haversine"</code> for the great-circle distance (miles) between longitude/latitude coordinates. Partial matching of arguments is used, so only the first three characters need to be provided. Defaults to <code>"euclidean"</code>.</p>
</td></tr>
<tr><td><code id="corRExpwr_+3A_radius">radius</code></td>
<td>
<p>radius to be used in the haversine formula for great-circle distance.  Defaults to the Earth's radius of 3,956 miles.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>'corRExpwr'</code>, also inheriting from class <code>'corRSpatial'</code>, representing a powered exponential spatial correlation structure.
</p>


<h3>Note</h3>

<p>When <code>"haversine"</code> is used as the distance metric, longitude and latitude coordinates must be given as the first and second covariates, respectively, in the formula specification for the <code>form</code> argument.
</p>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a>
</p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), &ldquo;Statistics for Spatial Data&rdquo;, J. Wiley &amp; Sons.
</p>
<p>Venables, W.N. and Ripley, B.D. (1997) &ldquo;Modern Applied Statistics with S-plus&rdquo;, 2nd Edition, Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+corRClasses">corRClasses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sp1 &lt;- corRExpwr(form = ~ x + y + z)

spatDat &lt;- data.frame(x = (0:4)/4, y = (0:4)/4)

cs1Expwr &lt;- corRExpwr(c(1, 1), form = ~ x + y)
cs1Expwr &lt;- Initialize(cs1Expwr, spatDat)
corMatrix(cs1Expwr)

cs2Expwr &lt;- corRExpwr(c(1, 1), form = ~ x + y, metric = "man")
cs2Expwr &lt;- Initialize(cs2Expwr, spatDat)
corMatrix(cs2Expwr)
</code></pre>

<hr>
<h2 id='corRExpwr2'>Non-Separable Powered Exponential Spatio-Temporal Correlation Structure</h2><span id='topic+corRExpwr2'></span>

<h3>Description</h3>

<p>This function is a constructor for the <code>'corRExpwr2'</code> class, representing a non-separable spatial correlation structure. Letting <code class="reqn">rs</code> denote the spatial range, <code class="reqn">ps</code> the spatial shape, <code class="reqn">rt</code> the temporal range, <code class="reqn">pt</code> the temporal shape, and <code class="reqn">lambda</code> the space-time interaction, the correlation between two observations a distance <code class="reqn">d</code> apart in space and <code class="reqn">t</code> in time is <code class="reqn">\exp(-(d/rs)^ps - (t/rt)^pt - \lambda (d/rs)^ps (t/rt)^pt)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   corRExpwr2(value = numeric(0), form = ~ 1,
              metric = c("euclidean", "maximum", "manhattan", "haversine"),
              radius = 3956)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corRExpwr2_+3A_value">value</code></td>
<td>
<p>optional numeric vector of five parameter values for the powered exponential correlation structure, corresponding to the &ldquo;spatial range&rdquo;, &ldquo;spatial shape&rdquo;, &ldquo;temporal range&rdquo;, &ldquo;temporal shape&rdquo;, and &ldquo;space-time interaction&rdquo;.  The range parameter values must be greater than zero, the shapes in the interval (0, 2], and the interaction greater than or equal to zero.  Defaults to <code>numeric(0)</code>, which results in ranges of 90% of the minimum distances, shapes of 1, and an interaction of 0 being assigned to the parameters when <code>object</code> is initialized.</p>
</td></tr>
<tr><td><code id="corRExpwr2_+3A_form">form</code></td>
<td>
<p>one-sided formula of the form <code>~ S1+...+Sp+T</code>, specifying spatial covariates <code>S1</code> through <code>Sp</code> and the times <code>T</code> at which measurement were taken.</p>
</td></tr>
<tr><td><code id="corRExpwr2_+3A_metric">metric</code></td>
<td>
<p>optional character string specifying the distance metric to be used. The currently available options are <code>"euclidean"</code> for the root sum-of-squares of distances;   <code>"maximum"</code> for the maximum difference; <code>"manhattan"</code> for the sum of the absolute differences; and <code>"haversine"</code> for the great-circle distance (miles) between longitude/latitude coordinates. Partial matching of arguments is used, so only the first three characters need to be provided. Defaults to <code>"euclidean"</code>.</p>
</td></tr>
<tr><td><code id="corRExpwr2_+3A_radius">radius</code></td>
<td>
<p>radius to be used in the haversine formula for great-circle distance.  Defaults to the Earth's radius of 3,956 miles.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>'corRExpwr2'</code>, inheriting from class <code>'corRSpatioTemporal'</code>, representing a non-separable spatial correlation structure.
</p>


<h3>Note</h3>

<p>When <code>"haversine"</code> is used as the distance metric, longitude and latitude coordinates must be given as the first and second covariates, respectively, in the formula specification for the <code>form</code> argument.
</p>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a>
</p>


<h3>References</h3>

<p>Cressie, N. and Huang, H.-C. (1993) &ldquo;Classes of Nonseperable, Spatio-Temporal Stationary Covariance Functions&rdquo;, <em>Journal of the American Statistical Association</em>, 94, 1330-1340.
</p>
<p>Gneiting, T. (2002) &ldquo;Nonseparable, stationary covariance functions for space-time data&rdquo;, <em>Journal of the American Statistical Association</em>, 97, 590-600.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+corRClasses">corRClasses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sp1 &lt;- corRExpwr2(form = ~ x + y + t)

spatDat &lt;- data.frame(x = (0:4)/4, y = (0:4)/4, t=(0:4)/4)

cs1Expwr &lt;- corRExpwr2(c(1, 1, 1, 1, 1), form = ~ x + y + t)
cs1Expwr &lt;- Initialize(cs1Expwr, spatDat)
corMatrix(cs1Expwr)

cs2Expwr &lt;- corRExpwr2(c(1, 1, 1, 1, 1), form = ~ x + y + t, metric = "man")
cs2Expwr &lt;- Initialize(cs2Expwr, spatDat)
corMatrix(cs2Expwr)
</code></pre>

<hr>
<h2 id='corRExpwr2Dt'>Non-Separable Temporally Integrated Powered Exponential Spatial Correlation Structure</h2><span id='topic+corRExpwr2Dt'></span>

<h3>Description</h3>

<p>This function is a constructor for the <code>'corRExpwr2Dt'</code> class, representing a non-separable spatial correlation structure for temporally integrated measurements. Letting <code class="reqn">rs</code> denote the spatial range, <code class="reqn">ps</code> the spatial shape, <code class="reqn">rt</code> the temporal range, and <code class="reqn">lambda</code> the space-time interaction, the correlation between two observations a distance <code class="reqn">d</code> apart in space and <code class="reqn">t</code> in time is <code class="reqn">\exp(-(d/rs)^ps - t/rt - \lambda (d/rs)^ps (t/rt))</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   corRExpwr2Dt(value = numeric(0), form = ~ 1,
                metric = c("euclidean", "maximum", "manhattan", "haversine"),
                radius = 3956)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corRExpwr2Dt_+3A_value">value</code></td>
<td>
<p>optional numeric vector of four parameter values for the powered exponential correlation structure, corresponding to the &ldquo;spatial range&rdquo;, &ldquo;spatial shape&rdquo;, &ldquo;temporal range&rdquo;, and &ldquo;space-time interaction&rdquo;.  The range parameter values must be greater than zero, the shape in the interval (0, 2], and the interaction greater than or equal to zero.  Defaults to <code>numeric(0)</code>, which results in ranges of 90% of the minimum distances, a shape of 1, and an interaction of 0 being assigned to the parameters when <code>object</code> is initialized.</p>
</td></tr>
<tr><td><code id="corRExpwr2Dt_+3A_form">form</code></td>
<td>
<p>one-sided formula of the form <code>~ S1+...+Sp+T1+T2</code>, specifying spatial covariates <code>S1</code> through <code>Sp</code> and the times <code>(T1, T2)</code> at which measurement periods begin and end, respectively.</p>
</td></tr>
<tr><td><code id="corRExpwr2Dt_+3A_metric">metric</code></td>
<td>
<p>optional character string specifying the distance metric to be used. The currently available options are <code>"euclidean"</code> for the root sum-of-squares of distances;   <code>"maximum"</code> for the maximum difference; <code>"manhattan"</code> for the sum of the absolute differences; and <code>"haversine"</code> for the great-circle distance (miles) between longitude/latitude coordinates. Partial matching of arguments is used, so only the first three characters need to be provided. Defaults to <code>"euclidean"</code>.</p>
</td></tr>
<tr><td><code id="corRExpwr2Dt_+3A_radius">radius</code></td>
<td>
<p>radius to be used in the haversine formula for great-circle distance.  Defaults to the Earth's radius of 3,956 miles.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>'corRExpwr2Dt'</code>, also inheriting from class <code>'corRSpatial'</code>, representing a non-separable spatial correlation structure.
</p>


<h3>Note</h3>

<p>When <code>"haversine"</code> is used as the distance metric, longitude and latitude coordinates must be given as the first and second covariates, respectively, in the formula specification for the <code>form</code> argument.
</p>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a>
</p>


<h3>References</h3>

<p>Cressie, N. and Huang, H.-C. (1993) &ldquo;Classes of Nonseperable, Spatio-Temporal Stationary Covariance Functions&rdquo;, <em>Journal of the American Statistical Association</em>, 94, 1330-1340.
</p>
<p>Smith, B.J. and Oleson, J.J. (2007) &ldquo;Geostatistical Hierarchical Model for Temporally Integrated Radon Measurements&rdquo;, <em>Jounal of Agricultural, Biological, and Environmental Statistics</em>, in press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+corRClasses">corRClasses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sp1 &lt;- corRExpwr2Dt(form = ~ x + y + t1 + t2)

spatDat &lt;- data.frame(x = (0:4)/4, y = (0:4)/4, t1=(0:4)/4, t2=(1:5)/4)

cs1ExpwrDt &lt;- corRExpwr2Dt(c(1, 1, 1, 1), form = ~ x + y + t1 + t2)
cs1ExpwrDt &lt;- Initialize(cs1ExpwrDt, spatDat)
corMatrix(cs1ExpwrDt)

cs2ExpwrDt &lt;- corRExpwr2Dt(c(1, 1, 1, 1), form = ~ x + y + t1 + t2, metric = "man")
cs2ExpwrDt &lt;- Initialize(cs2ExpwrDt, spatDat)
corMatrix(cs2ExpwrDt)
</code></pre>

<hr>
<h2 id='corRGaus'>Gaussian Spatial Correlation Structure</h2><span id='topic+corRGaus'></span>

<h3>Description</h3>

<p>This function is a constructor for the <code>'corRGaus'</code> class, representing a Gaussian spatial correlation structure. Letting <code class="reqn">r</code> denote the range, the correlation between two observations a distance <code class="reqn">d</code> apart is <code class="reqn">\exp(-(d/r)^2)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   corRGaus(value = numeric(0), form = ~ 1,
            metric = c("euclidean", "maximum", "manhattan", "haversine"),
            radius = 3956)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corRGaus_+3A_value">value</code></td>
<td>
<p>optional numeric &ldquo;range&rdquo; parameter value for the Gaussian correlation structure, which must be greater than zero.  Defaults to <code>numeric(0)</code>, which results in a range of 90% of the minimum distance being assigned to the parameter when <code>object</code> is initialized.</p>
</td></tr>
<tr><td><code id="corRGaus_+3A_form">form</code></td>
<td>
<p>one-sided formula of the form <code>~ S1+...+Sp</code>, specifying spatial covariates <code>S1</code> through <code>Sp</code>. Defaults to <code>~ 1</code>, which corresponds to using the order of the observations in the data as a covariate.</p>
</td></tr>
<tr><td><code id="corRGaus_+3A_metric">metric</code></td>
<td>
<p>optional character string specifying the distance metric to be used. The currently available options are <code>"euclidean"</code> for the root sum-of-squares of distances;   <code>"maximum"</code> for the maximum difference; <code>"manhattan"</code> for the sum of the absolute differences; and <code>"haversine"</code> for the great-circle distance (miles) between longitude/latitude coordinates. Partial matching of arguments is used, so only the first three characters need to be provided. Defaults to <code>"euclidean"</code>.</p>
</td></tr>
<tr><td><code id="corRGaus_+3A_radius">radius</code></td>
<td>
<p>radius to be used in the haversine formula for great-circle distance.  Defaults to the Earth's radius of 3,956 miles.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>'corRGaus'</code>, also inheriting from class <code>'corRSpatial'</code>, representing a Gaussian spatial correlation structure.
</p>


<h3>Note</h3>

<p>When <code>"haversine"</code> is used as the distance metric, longitude and latitude coordinates must be given as the first and second covariates, respectively, in the formula specification for the <code>form</code> argument.
</p>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a> and Jose Pinheiro <a href="mailto:Jose.Pinheiro@pharma.novartis.com">Jose.Pinheiro@pharma.novartis.com</a>, and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a> 
</p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), &ldquo;Statistics for Spatial Data&rdquo;, J. Wiley &amp; Sons.
</p>
<p>Venables, W.N. and Ripley, B.D. (1997) &ldquo;Modern Applied Statistics with S-plus&rdquo;, 2nd Edition, Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+corRClasses">corRClasses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sp1 &lt;- corRGaus(form = ~ x + y + z)

spatDat &lt;- data.frame(x = (0:4)/4, y = (0:4)/4)

cs1Gaus &lt;- corRGaus(1, form = ~ x + y)
cs1Gaus &lt;- Initialize(cs1Gaus, spatDat)
corMatrix(cs1Gaus)

cs2Gaus &lt;- corRGaus(1, form = ~ x + y, metric = "man")
cs2Gaus &lt;- Initialize(cs2Gaus, spatDat)
corMatrix(cs2Gaus)
</code></pre>

<hr>
<h2 id='corRGneit'>Gneiting Spatial Correlation Structure</h2><span id='topic+corRGneit'></span>

<h3>Description</h3>

<p>This function is a constructor for the <code>'corRGneit'</code> class, representing the Gneiting approximation to the Gaussian correlation structure. Letting <code class="reqn">r</code> denote the range, the correlation between two observations a distance <code class="reqn">d &lt; r / s</code> apart is <code class="reqn">(1 + 8 s x + 25 (s x)^2 + 32 (s x)^3) (1 - s x)^8</code>, where s = 0.301187465825.  If <code class="reqn">d \geq r / s</code> the correlation is zero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   corRGneit(value = numeric(0), form = ~ 1,
             metric = c("euclidean", "maximum", "manhattan", "haversine"),
             radius = 3956)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corRGneit_+3A_value">value</code></td>
<td>
<p>optional numeric &ldquo;range&rdquo; parameter value for the Gneiting correlation structure, which must be greater than zero.  Defaults to <code>numeric(0)</code>, which results in a range of 90% of the minimum distance being assigned to the parameter when <code>object</code> is initialized.</p>
</td></tr>
<tr><td><code id="corRGneit_+3A_form">form</code></td>
<td>
<p>one-sided formula of the form <code>~ S1+...+Sp</code>, specifying spatial covariates <code>S1</code> through <code>Sp</code>. Defaults to <code>~ 1</code>, which corresponds to using the order of the observations in the data as a covariate.</p>
</td></tr>
<tr><td><code id="corRGneit_+3A_metric">metric</code></td>
<td>
<p>optional character string specifying the distance metric to be used. The currently available options are <code>"euclidean"</code> for the root sum-of-squares of distances;   <code>"maximum"</code> for the maximum difference; <code>"manhattan"</code> for the sum of the absolute differences; and <code>"haversine"</code> for the great-circle distance between longitude/latitude coordinates. Partial matching of arguments is used, so only the first three characters need to be provided. Defaults to <code>"euclidean"</code>.</p>
</td></tr>
<tr><td><code id="corRGneit_+3A_radius">radius</code></td>
<td>
<p>radius to be used in the haversine formula for great-circle distance.  Defaults to the Earth's radius of 3,956 miles.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>'corRGneit'</code>, also inheriting from class <code>'corRSpatial'</code>, representing the Gneiting spatial correlation structure.
</p>


<h3>Note</h3>

<p>When <code>"haversine"</code> is used as the distance metric, longitude and latitude coordinates must be given as the first and second covariates, respectively, in the formula specification for the <code>form</code> argument.
</p>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a>
</p>


<h3>References</h3>

<p>Gneiting, T. (1999), &ldquo;Correlation Functions for Atmospheric Data Analysis&rdquo;, <em>Quarterly Journal of the Royal Meteorological Society</em>, 125(559), 2449-2464.
</p>
<p>Venables, W.N. and Ripley, B.D. (1997) &ldquo;Modern Applied Statistics with S-plus&rdquo;, 2nd Edition, Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+corRClasses">corRClasses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sp1 &lt;- corRGneit(form = ~ x + y + z)

spatDat &lt;- data.frame(x = (0:4)/4, y = (0:4)/4)

cs1Gneit &lt;- corRGneit(1, form = ~ x + y)
cs1Gneit &lt;- Initialize(cs1Gneit, spatDat)
corMatrix(cs1Gneit)

cs2Gneit &lt;- corRGneit(1, form = ~ x + y, metric = "man")
cs2Gneit &lt;- Initialize(cs2Gneit, spatDat)
corMatrix(cs2Gneit)
</code></pre>

<hr>
<h2 id='corRLin'>Linear Spatial Correlation Structure</h2><span id='topic+corRLin'></span>

<h3>Description</h3>

<p>This function is a constructor for the <code>'corRLin'</code> class, representing a linear spatial correlation structure. Letting <code class="reqn">r</code> denote the range, the correlation between two observations a distance <code class="reqn">d &lt; r</code> apart is <code class="reqn">1-(d/r)</code>. If <code class="reqn">d \geq r</code> the correlation is zero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   corRLin(value = numeric(0), form = ~ 1,
           metric = c("euclidean", "maximum", "manhattan", "haversine"),
           radius = 3956)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corRLin_+3A_value">value</code></td>
<td>
<p>optional numeric &ldquo;range&rdquo; parameter value for the linear correlation structure, which must be greater than zero.  Defaults to <code>numeric(0)</code>, which results in a range of 90% of the minimum distance being assigned to the parameter when <code>object</code> is initialized.</p>
</td></tr>
<tr><td><code id="corRLin_+3A_form">form</code></td>
<td>
<p>one-sided formula of the form <code>~ S1+...+Sp</code>, specifying spatial covariates <code>S1</code> through <code>Sp</code>. Defaults to <code>~ 1</code>, which corresponds to using the order of the observations in the data as a covariate.</p>
</td></tr>
<tr><td><code id="corRLin_+3A_metric">metric</code></td>
<td>
<p>optional character string specifying the distance metric to be used. The currently available options are <code>"euclidean"</code> for the root sum-of-squares of distances;   <code>"maximum"</code> for the maximum difference; <code>"manhattan"</code> for the sum of the absolute differences; and <code>"haversine"</code> for the great-circle distance (miles) between longitude/latitude coordinates. Partial matching of arguments is used, so only the first three characters need to be provided. Defaults to <code>"euclidean"</code>.</p>
</td></tr>
<tr><td><code id="corRLin_+3A_radius">radius</code></td>
<td>
<p>radius to be used in the haversine formula for great-circle distance.  Defaults to the Earth's radius of 3,956 miles.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>'corRLin'</code>, also inheriting from class <code>'corRSpatial'</code>, representing a linear spatial correlation structure.
</p>


<h3>Note</h3>

<p>When <code>"haversine"</code> is used as the distance metric, longitude and latitude coordinates must be given as the first and second covariates, respectively, in the formula specification for the <code>form</code> argument.
</p>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a> and Jose Pinheiro <a href="mailto:Jose.Pinheiro@pharma.novartis.com">Jose.Pinheiro@pharma.novartis.com</a>, and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a> 
</p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), &ldquo;Statistics for Spatial Data&rdquo;, J. Wiley &amp; Sons.
</p>
<p>Venables, W.N. and Ripley, B.D. (1997) &ldquo;Modern Applied Statistics with S-plus&rdquo;, 2nd Edition, Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+corRClasses">corRClasses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sp1 &lt;- corRLin(form = ~ x + y + z)

spatDat &lt;- data.frame(x = (0:4)/4, y = (0:4)/4)

cs1Lin &lt;- corRLin(1, form = ~ x + y)
cs1Lin &lt;- Initialize(cs1Lin, spatDat)
corMatrix(cs1Lin)

cs2Lin &lt;- corRLin(1, form = ~ x + y, metric = "man")
cs2Lin &lt;- Initialize(cs2Lin, spatDat)
corMatrix(cs2Lin)
</code></pre>

<hr>
<h2 id='corRMatern'>Matern Spatial Correlation Structure</h2><span id='topic+corRMatern'></span>

<h3>Description</h3>

<p>This function is a constructor for the <code>'corRMatern'</code> class, representing a Matern spatial correlation structure. Letting <code class="reqn">r</code> denote the range, and <code class="reqn">s</code> the scale, the correlation between two observations a distance <code class="reqn">d</code> apart is <code class="reqn">1/(2^{s-1} \Gamma(s)) (d/r)^s K_s(d/r)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   corRMatern(value = numeric(0), form = ~ 1,
              metric = c("euclidean", "maximum", "manhattan", "haversine"),
              radius = 3956)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corRMatern_+3A_value">value</code></td>
<td>
<p>optional numeric vector of two parameter values for the Matern correlation structure, corresponding to the &ldquo;range&rdquo; and &ldquo;scale&rdquo;.  The range parameter value must be greater than zero, and the scale in the interval (0, 2].  Defaults to <code>numeric(0)</code>, which results in a range of 90% of the minimum distance and a scale of 0.5 being assigned to the parameter when <code>object</code> is initialized.</p>
</td></tr>
<tr><td><code id="corRMatern_+3A_form">form</code></td>
<td>
<p>one-sided formula of the form <code>~ S1+...+Sp</code>, specifying spatial covariates <code>S1</code> through <code>Sp</code>. Defaults to <code>~ 1</code>, which corresponds to using the order of the observations in the data as a covariate.</p>
</td></tr>
<tr><td><code id="corRMatern_+3A_metric">metric</code></td>
<td>
<p>optional character string specifying the distance metric to be used. The currently available options are <code>"euclidean"</code> for the root sum-of-squares of distances;   <code>"maximum"</code> for the maximum difference; <code>"manhattan"</code> for the sum of the absolute differences; and <code>"haversine"</code> for the great-circle distance (miles) between longitude/latitude coordinates. Partial matching of arguments is used, so only the first three characters need to be provided. Defaults to <code>"euclidean"</code>.</p>
</td></tr>
<tr><td><code id="corRMatern_+3A_radius">radius</code></td>
<td>
<p>radius to be used in the haversine formula for great-circle distance.  Defaults to the Earth's radius of 3,956 miles.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>'corRMatern'</code>, also inheriting from class <code>'corRSpatial'</code>, representing a Matern spatial correlation structure.
</p>


<h3>Note</h3>

<p>When <code>"haversine"</code> is used as the distance metric, longitude and latitude coordinates must be given as the first and second covariates, respectively, in the formula specification for the <code>form</code> argument.
</p>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a>
</p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), &ldquo;Statistics for Spatial Data&rdquo;, J. Wiley &amp; Sons.
</p>
<p>Venables, W.N. and Ripley, B.D. (1997) &ldquo;Modern Applied Statistics with S-plus&rdquo;, 2nd Edition, Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+corRClasses">corRClasses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sp1 &lt;- corRMatern(form = ~ x + y + z)

spatDat &lt;- data.frame(x = (0:4)/4, y = (0:4)/4)

cs1Matern &lt;- corRMatern(c(1, 1), form = ~ x + y)
cs1Matern &lt;- Initialize(cs1Matern, spatDat)
corMatrix(cs1Matern)

cs2Matern &lt;- corRMatern(c(1, 1), form = ~ x + y, metric = "man")
cs2Matern &lt;- Initialize(cs2Matern, spatDat)
corMatrix(cs2Matern)
</code></pre>

<hr>
<h2 id='corRSpher'>Spherical Spatial Correlation Structure</h2><span id='topic+corRSpher'></span>

<h3>Description</h3>

<p>This function is a constructor for the <code>'corRSpher'</code> class, representing a spherical spatial correlation structure. Letting <code class="reqn">r</code> denote the range, the correlation between two observations a distance <code class="reqn">d &lt; r</code> apart is <code class="reqn">1-1.5(d/r)+0.5(d/r)^3</code>. If <code class="reqn">d \geq r</code> the correlation is zero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   corRSpher(value = numeric(0), form = ~ 1,
             metric = c("euclidean", "maximum", "manhattan", "haversine"),
             radius = 3956)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corRSpher_+3A_value">value</code></td>
<td>
<p>optional numeric &ldquo;range&rdquo; parameter value for the spherical correlation structure, which must be greater than zero.  Defaults to <code>numeric(0)</code>, which results in a range of 90% of the minimum distance being assigned to the parameter when <code>object</code> is initialized.</p>
</td></tr>
<tr><td><code id="corRSpher_+3A_form">form</code></td>
<td>
<p>one-sided formula of the form <code>~ S1+...+Sp</code>, specifying spatial covariates <code>S1</code> through <code>Sp</code>. Defaults to <code>~ 1</code>, which corresponds to using the order of the observations in the data as a covariate.</p>
</td></tr>
<tr><td><code id="corRSpher_+3A_metric">metric</code></td>
<td>
<p>optional character string specifying the distance metric to be used. The currently available options are <code>"euclidean"</code> for the root sum-of-squares of distances;   <code>"maximum"</code> for the maximum difference; <code>"manhattan"</code> for the sum of the absolute differences; and <code>"haversine"</code> for the great-circle distance (miles) between longitude/latitude coordinates. Partial matching of arguments is used, so only the first three characters need to be provided. Defaults to <code>"euclidean"</code>.</p>
</td></tr>
<tr><td><code id="corRSpher_+3A_radius">radius</code></td>
<td>
<p>radius to be used in the haversine formula for great-circle distance.  Defaults to the Earth's radius of 3,956 miles.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>'corRSpher'</code>, also inheriting from class <code>'corRSpatial'</code>, representing a spherical spatial correlation structure.
</p>


<h3>Note</h3>

<p>When <code>"haversine"</code> is used as the distance metric, longitude and latitude coordinates must be given as the first and second covariates, respectively, in the formula specification for the <code>form</code> argument.
</p>


<h3>Author(s)</h3>

<p>Jose Pinheiro <a href="mailto:Jose.Pinheiro@pharma.novartis.com">Jose.Pinheiro@pharma.novartis.com</a>, Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a>, and Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a>
</p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), &ldquo;Statistics for Spatial Data&rdquo;, J. Wiley &amp; Sons.
</p>
<p>Venables, W.N. and Ripley, B.D. (1997) &ldquo;Modern Applied Statistics with S-plus&rdquo;, 2nd Edition, Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+corRClasses">corRClasses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sp1 &lt;- corRSpher(form = ~ x + y + z)

spatDat &lt;- data.frame(x = (0:4)/4, y = (0:4)/4)

cs1Spher &lt;- corRSpher(1, form = ~ x + y)
cs1Spher &lt;- Initialize(cs1Spher, spatDat)
corMatrix(cs1Spher)

cs2Spher &lt;- corRSpher(1, form = ~ x + y, metric = "man")
cs2Spher &lt;- Initialize(cs2Spher, spatDat)
corMatrix(cs2Spher)
</code></pre>

<hr>
<h2 id='corRWave'>Sine Wave Spatial Correlation Structure</h2><span id='topic+corRWave'></span>

<h3>Description</h3>

<p>This function is a constructor for the <code>'corRWave'</code> class, representing a sine wave spatial correlation structure. Letting <code class="reqn">r</code> denote the range, the correlation between two observations a distance <code class="reqn">d</code> apart is <code class="reqn">\sin(d/r)/(d/r)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   corRWave(value = numeric(0), form = ~ 1,
            metric = c("euclidean", "maximum", "manhattan", "haversine"),
            radius = 3956)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corRWave_+3A_value">value</code></td>
<td>
<p>optional numeric &ldquo;range&rdquo; parameter value for the sine wave correlation structure, which must be greater than zero.  Defaults to <code>numeric(0)</code>, which results in a range of 90% of the minimum distance being assigned to the parameter when <code>object</code> is initialized.</p>
</td></tr>
<tr><td><code id="corRWave_+3A_form">form</code></td>
<td>
<p>one-sided formula of the form <code>~ S1+...+Sp</code>, specifying spatial covariates <code>S1</code> through <code>Sp</code>. Defaults to <code>~ 1</code>, which corresponds to using the order of the observations in the data as a covariate.</p>
</td></tr>
<tr><td><code id="corRWave_+3A_metric">metric</code></td>
<td>
<p>optional character string specifying the distance metric to be used. The currently available options are <code>"euclidean"</code> for the root sum-of-squares of distances;   <code>"maximum"</code> for the maximum difference; <code>"manhattan"</code> for the sum of the absolute differences; and <code>"haversine"</code> for the great-circle distance (miles) between longitude/latitude coordinates. Partial matching of arguments is used, so only the first three characters need to be provided. Defaults to <code>"euclidean"</code>.</p>
</td></tr>
<tr><td><code id="corRWave_+3A_radius">radius</code></td>
<td>
<p>radius to be used in the haversine formula for great-circle distance.  Defaults to the Earth's radius of 3,956 miles.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>'corRWave'</code>, also inheriting from class <code>'corRSpatial'</code>, representing a sine wave spatial correlation structure.
</p>


<h3>Note</h3>

<p>When <code>"haversine"</code> is used as the distance metric, longitude and latitude coordinates must be given as the first and second covariates, respectively, in the formula specification for the <code>form</code> argument.
</p>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a>
</p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), &ldquo;Statistics for Spatial Data&rdquo;, J. Wiley &amp; Sons.
</p>
<p>Venables, W.N. and Ripley, B.D. (1997) &ldquo;Modern Applied Statistics with S-plus&rdquo;, 2nd Edition, Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+corRClasses">corRClasses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sp1 &lt;- corRWave(form = ~ x + y + z)

spatDat &lt;- data.frame(x = (0:4)/4, y = (0:4)/4)

cs1Wave &lt;- corRWave(1, form = ~ x + y)
cs1Wave &lt;- Initialize(cs1Wave, spatDat)
corMatrix(cs1Wave)

cs2Wave &lt;- corRWave(1, form = ~ x + y, metric = "man")
cs2Wave &lt;- Initialize(cs2Wave, spatDat)
corMatrix(cs2Wave)
</code></pre>

<hr>
<h2 id='DIC'>Deviance Information Criterion</h2><span id='topic+DIC'></span><span id='topic+DIC.ramps'></span>

<h3>Description</h3>

<p>Calculates the Deviance Information Criterion (DIC) for comparisons of <code>georamps</code> model fits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'ramps'
DIC(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DIC_+3A_object">object</code></td>
<td>
<p>object returned by <code>georamps</code>.</p>
</td></tr>
<tr><td><code id="DIC_+3A_...">...</code></td>
<td>
<p>some methods for this generic require additional arguments.  None are used in this method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An numeric vector with the following two elements:
</p>
<table>
<tr><td><code>DIC</code></td>
<td>
<p>value of the Deviance Information Criterion.</p>
</td></tr>
<tr><td><code>pD</code></td>
<td>
<p>effective number of model parameters.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a>
</p>


<h3>References</h3>

<p>Spiegelhalter, D.J., Best, N.G., Carlin, B.P., and van der Linde, A. (2002) &ldquo;Bayesian Measures of Model Complexity and Fit&rdquo;, <em>Journal of the Royal Statistical Society - Series B</em>, 64, 583-639.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+georamps">georamps</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## DIC calculation for georamps example results

## Not run: 
DIC(NURE.fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='expand.chain'>Expand MCMC Samples for georamps Model Fits</h2><span id='topic+expand.chain'></span>

<h3>Description</h3>

<p>Generates additional posterior samples for <code>georamps</code> model fits by restarting the MCMC sampler at the last set of sampled parameter values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   expand.chain(object, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expand.chain_+3A_object">object</code></td>
<td>
<p>object returned by <code>georamps</code>.</p>
</td></tr>
<tr><td><code id="expand.chain_+3A_n">n</code></td>
<td>
<p>additional number of times to iterate the MCMC sampler.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>'ramps'</code> object containing the previously and newly sampled parameter values.
</p>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+georamps">georamps</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate 25 additional samples for the georamps example

## Not run: 
fit &lt;- expand.chain(NURE.fit, 25)

## End(Not run)
</code></pre>

<hr>
<h2 id='genUSStateGrid'> Generating a Grid over a US State </h2><span id='topic+genUSStateGrid'></span>

<h3>Description</h3>

<p>This function generate a grid of points over a US state with given
increment size or resolution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   genUSStateGrid(state, incr = NULL, resolution = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genUSStateGrid_+3A_state">state</code></td>
<td>
<p> the name of a US state. </p>
</td></tr>
<tr><td><code id="genUSStateGrid_+3A_incr">incr</code></td>
<td>
<p> a numeric vector of length 2 specifying the increment in
longitude and latitude. </p>
</td></tr>
<tr><td><code id="genUSStateGrid_+3A_resolution">resolution</code></td>
<td>
<p> a numeric vector of length 2 specifying the size of
the grid in longitude and latitude. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame:
</p>
<table>
<tr><td><code>lon</code></td>
<td>
<p>longitude of the grid point.</p>
</td></tr>
<tr><td><code>lat</code></td>
<td>
<p>latitude of the grid point.</p>
</td></tr>
<tr><td><code>id</code></td>
<td>
<p>the id number of the county in which the grid point is located.</p>
</td></tr>
<tr><td><code>county</code></td>
<td>
<p>the name of the county in which the grid point is located.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jun Yan <a href="mailto:jun.yan@uconn.edu">jun.yan@uconn.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+genUSStateSites">genUSStateSites</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mygrid &lt;- genUSStateGrid('iowa', resolution=c(8, 4))
map('state', 'iowa')
points(mygrid)
</code></pre>

<hr>
<h2 id='genUSStateSites'> Generating Random Sites in a US State </h2><span id='topic+genUSStateSites'></span>

<h3>Description</h3>

<p>A completely spatial random set of point is generated for a US state.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   genUSStateSites(state, nsites)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genUSStateSites_+3A_state">state</code></td>
<td>
<p> the name of a US state. </p>
</td></tr>
<tr><td><code id="genUSStateSites_+3A_nsites">nsites</code></td>
<td>
<p> the number of sites needed. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of longitude and latitude....
</p>


<h3>See Also</h3>

<p><code><a href="#topic+genUSStateGrid">genUSStateGrid</a></code>
</p>

<hr>
<h2 id='georamps'>Bayesian Geostatistical Model Fitting with RAMPS</h2><span id='topic+georamps'></span><span id='topic+print.ramps'></span>

<h3>Description</h3>

<p>General function for fitting Bayesian geostatistical models using the reparameterized and marginalized posterior sampling (RAMPS) algorithm of Yan et al. (2007).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   georamps(fixed, random, correlation, data, subset, weights,
            variance = list(fixed = ~ 1, random = ~ 1, spatial = ~ 1),
            aggregate = list(grid = NULL, blockid = ""), kmat = NULL,
            control = ramps.control(...), contrasts = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="georamps_+3A_fixed">fixed</code></td>
<td>
<p>two-sided linear <code>"formula"</code> object describing the main effects in the mean structure of the model, with the response on the left of a <code>~</code> operator and the terms, separated by <code>+</code> operators, on the right.</p>
</td></tr>
<tr><td><code id="georamps_+3A_random">random</code></td>
<td>
<p>optional one-sided formula of the form <code>~ 1 | g</code>, specifying random intercepts for groups defined by the factor <code>g</code>. Several grouping variables may be simultaneously specified, separated by the <code>*</code> operator, as in <code>~ 1 | g1 * g2 * g3</code>. In such cases, the levels of each variable are pasted together and the resulting factor used to group the observations.  Missing <code>NA</code> values may be given in the grouping variable to omit random effects for the associated measurements.</p>
</td></tr>
<tr><td><code id="georamps_+3A_correlation">correlation</code></td>
<td>
<p><code>'corRSpatial'</code> object describing the spatial correlation structure.  See the <code>corRClasses</code> documentation for a listing of the available structures.</p>
</td></tr>
<tr><td><code id="georamps_+3A_data">data</code></td>
<td>
<p>optional data frame containing the variables named in <code>fixed</code>, <code>random</code>, <code>correlation</code>, <code>weights</code>, <code>variance</code>, and <code>subset</code>.</p>
</td></tr>
<tr><td><code id="georamps_+3A_subset">subset</code></td>
<td>
<p>optional expression indicating the subset of rows in <code>data</code> that should be used in the fit. This can be a logical vector, or a numerical vector indicating which observation numbers are to be included, or a character vector of the row names to be included. All observations are included by default.</p>
</td></tr>
<tr><td><code id="georamps_+3A_weights">weights</code></td>
<td>
<p>optional numerical vector of measurement error variance (inverse) weights to be used in the fitting process. Defaults to a value of 1 for point-source measurements and the number of grid points for areal measurements (see the <code>aggregate</code> argument below).</p>
</td></tr>
<tr><td><code id="georamps_+3A_variance">variance</code></td>
<td>
<p>optional list of one-sided formulas, each of the form <code>~ g</code> where <code>g</code> defines a grouping factor for the following elements: <code>fixed</code> for measurement error variances; <code>random</code> for random effects error variances; and <code>spatial</code> for spatial variances.  A single variance is assumed in each case by default.</p>
</td></tr>
<tr><td><code id="georamps_+3A_aggregate">aggregate</code></td>
<td>
<p>optional list of elements: <code>grid</code> a data frame of coordinates to use for Monte Carlo integration over geographic blocks at which areal measurements are available; and <code>blockid</code> a character string specifying the column by which to merge the areal measurements in <code>data</code> with the grid coordinates in <code>grid</code>.  Merging is only performed for <code>blockid</code> values that are common to both datasets.  All observations in <code>data</code> are treated as point-source measurements by default.</p>
</td></tr>
<tr><td><code id="georamps_+3A_kmat">kmat</code></td>
<td>
<p>optional <code class="reqn">n \times s</code> design matrix for mapping spatial sites to outcome responses, where <code class="reqn">n</code> is the number of responses and <code class="reqn">s</code> the number of unique sites.  Unique sites are ordered first according to those supplied to the <code>data</code> argument and second to those supplied to the <code>aggregate</code> argument.  Defaults to <code>kmat[i,j] = 1 / N[i]</code> if site <code>j</code> is one of <code>N[i]</code> measurement sites contributing to response <code>i</code>; otherwise <code>kmat[i,j] = 0</code>.  Rows or columns of zeros are not supported.</p>
</td></tr>
<tr><td><code id="georamps_+3A_control">control</code></td>
<td>
<p>list of parameters for controlling the fitting process. See the <code>ramps.control</code> documentation for details.</p>
</td></tr>
<tr><td><code id="georamps_+3A_contrasts">contrasts</code></td>
<td>
<p>optional list. See the <code>contrasts.arg</code> of <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>.</p>
</td></tr>
<tr><td><code id="georamps_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>'ramps'</code> containing the following elements:
</p>
<table>
<tr><td><code>params</code></td>
<td>
<p><code>'mcmc'</code> object of monitored model parameters with variable labels in the column names and MCMC iteration numbers in the row names.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p><code>'mcmc'</code> object of monitored latent spatial parameters with variable labels in the column names and MCMC iteration numbers in the row names.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>vector of data log-likelihood values at each MCMC iteration.</p>
</td></tr>
<tr><td><code>evals</code></td>
<td>
<p>vector of slice sampler evaluations at each MCMC iteration.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched function call to <code>georamps</code>.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>response vector.</p>
</td></tr>
<tr><td><code>xmat</code></td>
<td>
<p>design matrix for the main effects.</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>the <code>'terms'</code> object for <code>xmat</code>.</p>
</td></tr>
<tr><td><code>xlevels</code></td>
<td>
<p>list of the factor levels for <code>xmat</code>.</p>
</td></tr>
<tr><td><code>etype</code></td>
<td>
<p>grouping factor for the measurement error variances.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>weights used in the fitting process.</p>
</td></tr>
<tr><td><code>kmat</code></td>
<td>
<p>matrix for mapping the spatial parameters to the observed data.</p>
</td></tr>
<tr><td><code>correlation</code></td>
<td>
<p>specified <code>'corRSpatial'</code> object for the spatial correlation structure.</p>
</td></tr>
<tr><td><code>coords</code></td>
<td>
<p>matrix of unique coordinates for the measurement and grid sites.</p>
</td></tr>
<tr><td><code>ztype</code></td>
<td>
<p>grouping factor for the spatial variances.</p>
</td></tr>
<tr><td><code>wmat</code></td>
<td>
<p>matrix for mapping the random effects to the observed data.</p>
</td></tr>
<tr><td><code>retype</code></td>
<td>
<p>grouping factor for the random effects variances.</p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p>a list of control parameters used in the fitting process.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a>, Jun Yan <a href="mailto:jun.yan@uconn.edu">jun.yan@uconn.edu</a>, and Kate Cowles <a href="mailto:kate-cowles@uiowa.edu">kate-cowles@uiowa.edu</a></p>


<h3>References</h3>

<p>Yan, J., Cowles, M.K., Wang, S., and Armstrong, M. (2007) &ldquo;Parallelizing MCMC for Bayesian Spatiotemporal Geostatistical Models&rdquo;, <em>Statistics and Computing</em>, 17(4), 323-335.
</p>
<p>Smith, B. J., Yan, J., and Cowles, M. K. (2008) &ldquo;Unified Geostatistical Modeling for Data Fusion and Spatial Heteroskedasticity with R Package ramps&rdquo;, <em>Journal of Statistical Software</em>, 25(10), 1-21.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+corRClasses">corRClasses</a></code>,
<code><a href="#topic+ramps.control">ramps.control</a></code>,
<code><a href="coda.html#topic+mcmc">mcmc</a></code>,
<code><a href="#topic+DIC.ramps">DIC.ramps</a></code>,
<code><a href="#topic+plot.ramps">plot.ramps</a></code>,
<code><a href="#topic+predict.ramps">predict.ramps</a></code>,
<code><a href="#topic+summary.ramps">summary.ramps</a></code>,
<code><a href="#topic+window.ramps">window.ramps</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Load the included uranium datasets for use in this example
data(NURE)

## Geostatistical analysis of areal measurements
NURE.ctrl1 &lt;- ramps.control(
   iter = 25,
   beta = param(0, "flat"),
   sigma2.e = param(1, "invgamma", shape = 2.0, scale = 0.1, tuning = 0.75),
   phi = param(10, "uniform", min = 0, max = 35, tuning = 0.50),
   sigma2.z = param(1, "invgamma", shape = 2.0, scale = 0.1)
)

NURE.fit1 &lt;- georamps(log(ppm) ~ 1,
   correlation = corRExp(form = ~ lon + lat, metric = "haversine"),
   weights = area,
   data = NURE,
   subset = (measurement == 1),
   aggregate = list(grid = NURE.grid, blockid = "id"),
   control = NURE.ctrl1
)
print(NURE.fit1)
summary(NURE.fit1)


## Analysis of point-source measurements
NURE.ctrl2 &lt;- ramps.control(
   iter = 25,
   beta = param(0, "flat"),
   sigma2.e = param(1, "invgamma", shape = 2.0, scale = 0.1, tuning = 0.75),
   phi = param(10, "uniform", min = 0, max = 35, tuning = 0.5),
   sigma2.z = param(1, "invgamma", shape = 2.0, scale = 0.1)
)

NURE.fit2 &lt;- georamps(log(ppm) ~ 1,
   correlation = corRExp(form = ~ lon + lat, metric = "haversine"),
   data = NURE,
   subset = (measurement == 2),
   control = NURE.ctrl2
)
print(NURE.fit2)
summary(NURE.fit2)


## Joint analysis of areal and point-source measurements with
## prediction only at grid sites
NURE.ctrl &lt;- ramps.control(
   iter = 25,
   beta = param(rep(0, 2), "flat"),
   sigma2.e = param(rep(1, 2), "invgamma", shape = 2.0, scale = 0.1, tuning = 0.75),
   phi = param(10, "uniform", min = 0, max = 35, tuning = 0.5),
   sigma2.z = param(1, "invgamma", shape = 2.0, scale = 0.1),
   z.monitor = NURE.grid
)

NURE.fit &lt;- georamps(log(ppm) ~ factor(measurement) - 1,
   correlation = corRExp(form = ~ lon + lat, metric = "haversine"),
   variance = list(fixed = ~ measurement),
   weights = area * (measurement == 1) + (measurement == 2),
   data = NURE,
   aggregate = list(grid = NURE.grid, blockid = "id"),
   control = NURE.ctrl
)
print(NURE.fit)
summary(NURE.fit)


## Discard initial 5 MCMC samples as a burn-in sequence
fit &lt;- window(NURE.fit, iter = 6:25)
print(fit)
summary(fit)

## Deviance Information Criterion
DIC(fit)

## Prediction at unmeasured sites
ct &lt;- map("state", "connecticut", plot = FALSE)
lon &lt;- seq(min(ct$x, na.rm = TRUE), max(ct$x, na.rm = TRUE), length = 20)
lat &lt;- seq(min(ct$y, na.rm = TRUE), max(ct$y, na.rm = TRUE), length = 15)
grid &lt;- expand.grid(lon, lat)

newsites &lt;- data.frame(lon = grid[,1], lat = grid[,2],
                       measurement = 1)
pred &lt;- predict(fit, newsites)

plot(pred, func = function(x) exp(mean(x)),
     database = "state", regions = "connecticut",
     resolution = c(200, 150), bw = 5,
     main = "Posterior Mean",
     legend.args = list(text = "ppm", side = 3, line = 1))

plot(pred, func = function(x) exp(sd(x)),
     database = "state", regions = "connecticut",
     resolution = c(200, 150), bw = 5,
     main = "Posterior Standard Deviation",
     legend.args = list(text = "ppm", side = 3, line = 1))

## End(Not run)
</code></pre>

<hr>
<h2 id='NURE'>Dataset of USGS NURE Uranium Measurements</h2><span id='topic+NURE'></span><span id='topic+NURE.grid'></span>

<h3>Description</h3>

<p>Connecticut, USA, areal and point-source uranium measurements from the United States Geological Survey (USGS) National Uranium Resource Evaluation (NURE) project.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(NURE)</code></pre>


<h3>Format</h3>

<p>The following variables are provided in the <code>NURE</code> data frame:
</p>

<dl>
<dt><code>ppm</code></dt><dd><p>uranium measurements in parts per million.</p>
</dd>
<dt><code>measurement</code></dt><dd><p>type of measurement: 1 = areal, 2 = point-source.</p>
</dd>
<dt><code>lon</code></dt><dd><p>longitude coordinates of point-source measurements.</p>
</dd>
<dt><code>lat</code></dt><dd><p>latitude coordinates of point-source measurements.</p>
</dd>
<dt><code>easting</code></dt><dd><p>Universal Transverse Mercator easting coordinates - projected distances from the central meridian.</p>
</dd>
<dt><code>northing</code></dt><dd><p>Universal Transverse Mercator northing coordinates - projected distances from the equator.</p>
</dd>
<dt><code>county</code></dt><dd><p>counties from which measurements were taken.</p>
</dd>
<dt><code>area</code></dt><dd><p>county land mass areas in square miles.</p>
</dd>
<dt><code>id</code></dt><dd><p>unique identifiers for measured counties or sites.</p>
</dd>
</dl>

<p>A grid of coordinates is provided by the <code>NURE.grid</code> data frame to facilitate Monte Carlo integration in geostatistical modeling of areal measurements.  The included columns are 
</p>

<dl>
<dt><code>lon</code></dt><dd><p>longitude coordinates of grid sites.</p>
</dd>
<dt><code>lat</code></dt><dd><p>latitude coordinates of grid sites.</p>
</dd>
<dt><code>id</code></dt><dd><p>county identifiers.</p>
</dd>
</dl>

<p>Areal measurements in <code>NURE</code> can be matched to the grid coordinates in <code>NURE.grid</code> via the shared <code>"id"</code> variable.
</p>


<h3>References</h3>

<p>Duval, J.S., Jones, W.J., Riggle, F.R., and Pitkin, J.A. (1989) &ldquo;Equivalent uranium map of conterminous United States&rdquo;, USGS Open-File Report 89-478.
</p>
<p>Smith, S.M.(2006) &ldquo;National Geochemical Database Reformatted Data from the National Uranium Resource Evaluation (NURE) Hydrogeochemical and Stream Sediment Reconnaissance (HSSR) Program&rdquo;, USGS Open-File Report 97-492.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(NURE)

## Map areal and point-source measurements
ppm1 &lt;- NURE$ppm[NURE$measurement == 1]
level &lt;- (max(ppm1) - ppm1) / diff(range(ppm1))
map("county", "connecticut", fill = TRUE, col = gray(level))
title("Connecticut Uranium Measurements")
points(NURE$lon, NURE$lat)

## Map grid sites
map("county", "connecticut")
title("Regular Grid of Coordinates")
points(NURE.grid$lon, NURE.grid$lat)
</code></pre>

<hr>
<h2 id='param'>Initialization of georamps Model Parameters</h2><span id='topic+param'></span>

<h3>Description</h3>

<p>Function used in conjunction with <code>ramps.control</code> to specify the initial values and prior distributions used in calls to <code>georamps</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   param(init, prior = c("flat", "invgamma", "normal", "uniform", "user"), tuning,
         ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_+3A_init">init</code></td>
<td>
<p>numerical vector of initial parameter values.  <code>NA</code> elements will be replaced with random draws from the prior distribution when possible.</p>
</td></tr>
<tr><td><code id="param_+3A_prior">prior</code></td>
<td>
<p>character string specifying the prior distribution.  This must be one of <code>"flat"</code>, <code>"invgamma"</code>, <code>"normal"</code>, <code>"uniform"</code>, or <code>"user"</code>, with default <code>"flat"</code>, and may be abbreviated to a unique prefix.</p>
</td></tr>
<tr><td><code id="param_+3A_tuning">tuning</code></td>
<td>
<p>numerical tuning values the slice-simplex routine in the MCMC sampler.</p>
</td></tr>
<tr><td><code id="param_+3A_...">...</code></td>
<td>
<p>hyperparameters of the specified prior distribution.  See details below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The supported prior distributions and associated hyperparameters are:
</p>

<dl>
<dt><code>"flat"</code></dt><dd><p>Flat prior with no hyperparameters.</p>
</dd>
<dt><code>"invgamma"</code></dt><dd><p>Inverse-gamma with hyperparameters <code>shape &gt; 0</code> and <code>scale &gt; 0</code> such that <code class="reqn">f(x) = scale^{shape} / \Gamma(shape) x^{-shape - 1} \exp(-scale / x)</code>.</p>
</dd>
<dt><code>"normal"</code></dt><dd><p>Normal with hyperparameters <code>mean</code> and <code>variance</code> such that <code class="reqn">f(x) = (2 \pi)^{-n/2} |\Sigma|^{-1/2} \exp(-1/2 (x - \mu)' \Sigma^{-1} (x - \mu))</code>. The <code>variance</code> hyperparameter must be positive definite and may be supplied either as a vector (independence) or a matrix.</p>
</dd>
<dt><code>"uniform"</code></dt><dd><p>Uniform with hyperparameters <code>min</code> and <code>max &gt; min</code> such that <code class="reqn">f(x) = 1 / (max - min)</code>.</p>
</dd>
<dt><code>"user"</code></dt><dd><p>Use-defined function supplied as hyperparameter <code>f</code> which takes a single numeric vector of length and order equal to the associated model parameters and whose returns values are proportional to the prior distribution.</p>
</dd>
</dl>

<p>The number of model parameters to be initialized is determined by <code>length(init)</code>. Missing values occurring in the supplied <code>init</code> vector will be replaced with draws from the prior distribution, for all but the <code>"flat"</code> specification.
</p>


<h3>Value</h3>

<p>A list of class <code>'param'</code> containing the following components:
</p>
<table>
<tr><td><code>init</code></td>
<td>
<p>numerical vector of initial parameter values.</p>
</td></tr>
<tr><td><code>prior</code></td>
<td>
<p>character string specifying the prior distribution.</p>
</td></tr>
<tr><td><code>tuning</code></td>
<td>
<p>numerical vector of tuning values of <code>length(init)</code>.</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>hyperparameters of the specified prior distribution.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+georamps">georamps</a></code>,
<code><a href="#topic+ramps.control">ramps.control</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Initial values for a flat prior
param(rep(0, 2), "flat")

## Random generation of initial values for an inverse-gamma prior
param(rep(NA, 2), "invgamma", shape = 2.0, scale = 0.1)

## Independent normal priors
param(rep(0, 2), "normal", mean = c(0, 0), variance = c(100, 100))

## Correlated normal priors
npv &lt;- rbind(c(100, 25), c(25, 100))
param(rep(0, 2), "normal", mean = c(0, 0), variance = npv)

## Uniform prior and MCMC tuning parameter specification
param(10, "uniform", min = 0, max = 100, tuning = 0.5)
</code></pre>

<hr>
<h2 id='plot'>Posterior Spatial Distribution Plots</h2><span id='topic+plot.ramps'></span><span id='topic+plot.predict.ramps'></span>

<h3>Description</h3>

<p>Creates surface maps of posterior spatial distributions from <code><a href="#topic+georamps">georamps</a></code> or <code><a href="#topic+predict.ramps">predict.ramps</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'ramps'
plot(x, type = c("i", "c", "w"), col = tim.colors(64), func = mean,
        sites = FALSE, database = NULL, regions = ".", resolution = c(64, 64),
        bw = 1, ...)

   ## S3 method for class 'predict.ramps'
plot(x, type = c("i", "c", "w"), col = tim.colors(64), func = mean,
        database = NULL, regions = ".", resolution = c(64, 64), bw = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>object returned by <code>georamps</code> or <code>predict.ramps</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_type">type</code></td>
<td>
<p>type of plot to produce: <code>"i"</code> = <code>image.plot</code> (default), <code>"c"</code> = <code>contour</code> and <code>image</code>, and <code>"w"</code> = <code>drape.plot</code> wireframe.</p>
</td></tr>
<tr><td><code id="plot_+3A_col">col</code></td>
<td>
<p>vector of colors such as that generated by <code><a href="grDevices.html#topic+palettes">rainbow</a></code>, <code><a href="grDevices.html#topic+palettes">heat.colors</a></code>, <code><a href="grDevices.html#topic+palettes">topo.colors</a></code>, <code><a href="grDevices.html#topic+palettes">terrain.colors</a></code>, or similar functions.</p>
</td></tr>
<tr><td><code id="plot_+3A_func">func</code></td>
<td>
<p>function defining the posterior summary statistic to be plotted.</p>
</td></tr>
<tr><td><code id="plot_+3A_sites">sites</code></td>
<td>
<p>logical value indicating whether to include the measurements sites in the plot.</p>
</td></tr>
<tr><td><code id="plot_+3A_database">database</code></td>
<td>
<p>character string naming a geographical database for the mapping of geographic boundaries.  See <code>map</code> documentation for details.</p>
</td></tr>
<tr><td><code id="plot_+3A_regions">regions</code></td>
<td>
<p>character vector naming the polygons to draw.  See <code>map</code> documentation for details.</p>
</td></tr>
<tr><td><code id="plot_+3A_resolution">resolution</code></td>
<td>
<p>numerical vector of length 2 specifying the number of pixels (width x height) for the surface image.</p>
</td></tr>
<tr><td><code id="plot_+3A_bw">bw</code></td>
<td>
<p>numerical value specifying the bandwidth used for smoothing the spatial surface as a percentage of the diagonal length of the plot region.  Defaults to 1% of the diagonal length.</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to the underlying plotting function associated with the specified <code>type</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+georamps">georamps</a></code>
<code><a href="#topic+predict.ramps">predict.ramps</a></code>
<code><a href="graphics.html#topic+contour">contour</a></code>
<code><a href="fields.html#topic+drape.plot">drape.plot</a></code>
<code><a href="graphics.html#topic+image">image</a></code>
<code><a href="fields.html#topic+image.plot">image.plot</a></code>
<code><a href="maps.html#topic+map">map</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Surface maps of the georamps example results

## Not run: 
plot(NURE.fit, database = "state", regions = "connecticut",
     resolution = c(200, 150), bw = 5,
     main = "Spatial Process Posterior Mean")

## End(Not run)
</code></pre>

<hr>
<h2 id='predict.ramps'>Prediction Method for georamps Model Fits</h2><span id='topic+predict.ramps'></span>

<h3>Description</h3>

<p>Obtains prediction of main effects plus spatial variability from a <code><a href="#topic+georamps">georamps</a></code> model fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'ramps'
predict(object, newdata, type = c("response", "spatial", "error", "random"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.ramps_+3A_object">object</code></td>
<td>
<p>object returned by <code>georamps</code>.</p>
</td></tr>
<tr><td><code id="predict.ramps_+3A_newdata">newdata</code></td>
<td>
<p>data frame containing covariate values for the main effect, unmeasured spatial coordinates, and (if applicable) spatial variance indices with which to predict.</p>
</td></tr>
<tr><td><code id="predict.ramps_+3A_type">type</code></td>
<td>
<p>character string specifying the type of spatial prediction to perform.  The default value <code>"response"</code> provides spatial prediction which includes measurement error and non-spatial random effects; <code>"spatial"</code> excludes measurement error and non-spatial random effects from the prediction; <code>"error"</code> excludes non-spatial random effects; and <code>"random"</code> excludes measurement error.</p>
</td></tr>
<tr><td><code id="predict.ramps_+3A_...">...</code></td>
<td>
<p>some methods for this generic require additional arguments.  None are used in this method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Prediction will be performed only at the coordinates in <code>newdata</code> that differ from those used in the initial <code>georamps</code> model fitting.  In particular, overlapping coordinates will be excluded automatically in the prediction.
</p>


<h3>Value</h3>

<p><code>'predict.ramps'</code> object, inheriting from class <code>'matrix'</code>, of samples from the posterior predictive distribution.  Labels for the samples at each new coordinate are supplied in the returned column names and MCMC iteration numbers in the row names.  A matrix containing the new coordinates is supplied in the <code>coords</code> attribute of the object.
</p>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+georamps">georamps</a></code>
<code><a href="#topic+plot.predict.ramps">plot.predict.ramps</a></code>,
<code><a href="#topic+window.predict.ramps">window.predict.ramps</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Prediction for georamps example results

## Not run: 
ct &lt;- map("state", "connecticut", plot = FALSE)
lon &lt;- seq(min(ct$x, na.rm = TRUE), max(ct$x, na.rm = TRUE), length = 20)
lat &lt;- seq(min(ct$y, na.rm = TRUE), max(ct$y, na.rm = TRUE), length = 15)
grid &lt;- expand.grid(lon, lat)

newsites &lt;- data.frame(lon = grid[,1], lat = grid[,2],
                       measurement = 1)
NURE.pred &lt;- predict(NURE.fit, newsites)

par(mfrow=c(2,1))
plot(NURE.pred, func = function(x) exp(mean(x)),
     database = "state", regions = "connecticut",
     resolution = c(200, 150), bw = 5,
     main = "Posterior Mean",
     legend.args = list(text = "ppm", side = 3, line = 1))
plot(NURE.pred, func = function(x) exp(sd(x)),
     database = "state", regions = "connecticut",
     resolution = c(200, 150), bw = 5,
     main = "Posterior Standard Deviation",
     legend.args = list(text = "ppm", side = 3, line = 1))

## End(Not run)
</code></pre>

<hr>
<h2 id='ramps.control'>Auxiliary for Controlling georamps Model Fitting</h2><span id='topic+ramps.control'></span>

<h3>Description</h3>

<p>Auxiliary function that provides a user interface to control the <code><a href="#topic+georamps">georamps</a></code> model fitting algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ramps.control(iter = 1000, beta, sigma2.e, phi, sigma2.z, sigma2.re,
                 z.monitor = TRUE, mpdfun = c("mpdbeta", "mpdbetaz"), file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ramps.control_+3A_iter">iter</code></td>
<td>
<p>numerical value indicating the number of consecutive MCMC samples to generate, or a vector indicating specific iterations to monitor.</p>
</td></tr>
<tr><td><code id="ramps.control_+3A_beta">beta</code></td>
<td>
<p><code>'param'</code> object of initial values and hyperparameters for the main effects coefficients.  Flat priors are currently supported for these parameters.  Argument is optional if no main effects appear in the model.</p>
</td></tr>
<tr><td><code id="ramps.control_+3A_sigma2.e">sigma2.e</code></td>
<td>
<p><code>'param'</code> object of initial values and hyperparameters for the measurement error variances.  Inverse-gamma priors are currently supported.  Argument is optional if no measurement error variances appear in the model.</p>
</td></tr>
<tr><td><code id="ramps.control_+3A_phi">phi</code></td>
<td>
<p><code>'param'</code> object of initial values and hyperparameters for the spatial correlation parameters.  Uniform and user-defined priors are currently supported.  Argument is optional if no correlation parameters appear in the model.</p>
</td></tr>
<tr><td><code id="ramps.control_+3A_sigma2.z">sigma2.z</code></td>
<td>
<p><code>'param'</code> object of initial values and hyperparameters for the spatial variances.  Inverse-gamma priors are currently supported.  Argument is optional if no spatial variances appear in the model.</p>
</td></tr>
<tr><td><code id="ramps.control_+3A_sigma2.re">sigma2.re</code></td>
<td>
<p><code>'param'</code> object of initial values and hyperparameters for the random effects variances.  Inverse-gamma priors are currently supported.  Argument is optional if no random effects appear in the model.</p>
</td></tr>
<tr><td><code id="ramps.control_+3A_z.monitor">z.monitor</code></td>
<td>
<p>logical value indicating whether to monitor the latent spatial parameters, or data frame containing a subset of the coordinates at which to monitor the parameters.</p>
</td></tr>
<tr><td><code id="ramps.control_+3A_mpdfun">mpdfun</code></td>
<td>
<p>character string giving the type of marginalized posterior density used for slice sampling and calculation of the data likelihood.  Default is marginalization with respect to the beta parameters <code>"mpdbeta"</code>, and the alternative is with respect to both the beta and z parameters <code>"mpdbetaz"</code>.  The latter may provide faster MCMC sampling when analyzing data with multiple observation per measurement site.  The two options generate samples from the same posterior distribution.</p>
</td></tr>
<tr><td><code id="ramps.control_+3A_file">file</code></td>
<td>
<p>vector or list of character strings specifying external files to which to save monitored parameters.  Elements of the object named &ldquo;params&rdquo; and &ldquo;z&rdquo; will be taken to be the output files for model parameters and latent parameters, respectively.  If these element names are not supplied, then the first element is taken to be the &ldquo;params&rdquo; output file and the second the &ldquo;z&rdquo; output file.  Defaults to no external outputting of monitored parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tuning parameters may be set for the <code>sigma2</code> and <code>phi</code> arguments via the <code>param</code> function.  If a user-defined prior is specified, then tuning parameters must be supplied and are taken to be the initial widths of the slice sampling windows.  Otherwise, tuning parameters are taken to be factors by which the initial widths are multiplied.  Separate tuning parameters may be set for each of the arguments.  However, only the minimum of all <code>sigma2</code> tuning parameters is used in the sampling of those parameters.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>iter</code></td>
<td>
<p>sorted numerical vector of unique MCMC iterations to be monitored.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p><code>'param'</code> object of initial values for the main effects coefficients.</p>
</td></tr>
<tr><td><code>sigma2.e</code></td>
<td>
<p><code>'param'</code> object of initial values for the measurement error variances.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p><code>'param'</code> object of initial values for the spatial correlation parameters.</p>
</td></tr>
<tr><td><code>sigma2.z</code></td>
<td>
<p><code>'param'</code> object of initial values for the spatial variances.</p>
</td></tr>
<tr><td><code>sigma2.re</code></td>
<td>
<p><code>'param'</code> object of initial values for the random effects variances.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>list with element: <code>monitor</code> containing a logical monitoring indicator for the latent spatial parameters or a data frame of coordinates at which to monitor the parameters.</p>
</td></tr>
<tr><td><code>mpdfun</code></td>
<td>
<p>character string specifying the marginalized posterior distribution.</p>
</td></tr>
<tr><td><code>file</code></td>
<td>
<p>list with elements: <code>params</code> and <code>z</code> character strings specifying external files to which to save monitored model and spatial parameters.</p>
</td></tr>
<tr><td><code>expand</code></td>
<td>
<p>non-negative integer value indicating the starting point of the MCMC sampler, initialized to zero.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+georamps">georamps</a></code>,
<code><a href="#topic+param">param</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ctrl &lt;- ramps.control(
   iter = seq(1, 100, by = 2),
   beta = param(rep(0, 2), "flat"),
   sigma2.e = param(rep(1, 2), "invgamma", shape = 2.0, scale = 0.1),
   phi = param(10, "uniform", min = 0, max = 100, tuning = 0.5),
   sigma2.z = param(1, "invgamma", shape = 2.0, scale = 0.1),
   file = c("params.txt", "z.txt")
)
</code></pre>

<hr>
<h2 id='simJSS'>Dataset of Simulated Measurements from JSS Publication</h2><span id='topic+simJSS'></span><span id='topic+simIowa'></span><span id='topic+simGrid'></span>

<h3>Description</h3>

<p>Simulated Iowa, USA, areal and point-source measurements analyzed in the Working Example of the ramps package paper published in <em>Journal of Statistical Software</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simJSS)</code></pre>


<h3>Format</h3>

<p>The following variables are provided in the <code>simIowa</code> data frame:
</p>

<dl>
<dt><code>areal</code></dt><dd><p>type of measurement: 1 = areal, 0 = point-source.</p>
</dd>
<dt><code>y</code></dt><dd><p>simulated measurement.</p>
</dd>
<dt><code>id</code></dt><dd><p>unique identifiers for measurements.</p>
</dd>
<dt><code>siteId</code></dt><dd><p>unique identifiers for point-source measurement sites.</p>
</dd>
<dt><code>lon</code></dt><dd><p>longitude coordinates of point-source measurements.</p>
</dd>
<dt><code>lat</code></dt><dd><p>latitude coordinates of point-source measurements.</p>
</dd>
<dt><code>weights</code></dt><dd><p>number of sites per measurement.</p>
</dd>
</dl>

<p>A grid of coordinates is provided by the <code>simGrid</code> data frame to facilitate Monte Carlo integration in geostatistical modeling of areal measurements.  The included columns are
</p>

<dl>
<dt><code>lon</code></dt><dd><p>longitude coordinates of grid sites.</p>
</dd>
<dt><code>lat</code></dt><dd><p>latitude coordinates of grid sites.</p>
</dd>
<dt><code>id</code></dt><dd><p>county identifiers.</p>
</dd>
<dt><code>county</code></dt><dd><p>county names.</p>
</dd>
</dl>

<p>Areal measurements in <code>simIowa</code> can be matched to the grid coordinates in <code>simGrid</code> via the shared <code>"id"</code> variable.
</p>


<h3>Details</h3>

<p>Areal and point-source observations were generated from from a geostatistical model using the county structure in the state of Iowa, USA.  There are 99 counties in the state.  Areal observations were generated from each as county averages from a uniform grid of 391 sites - approximately 4 sites per county.  An additional 600 point-source observations were generated from a set of 300 unique sites sampled from a uniform distribution in Iowa.
</p>
<p>An exponential correlation structure with a range parameter of 10 was used for the underlying Gaussian spatial structure.  Measurement errors were generated with variances of 0.25 for point-source data and 0.09 for areal data.  Site-specific non-spatial random effects were generated with a variance 0.16.  One fixed effects covariate with coefficient equal to 0.5 was included as an indicator for areal observations.
</p>


<h3>References</h3>

<p>Smith, B. J., Yan, J., and Cowles, M. K. (2008) &ldquo;Unified Geostatistical Modeling for Data Fusion and Spatial Heteroskedasticity with R Package ramps&rdquo;, <em>Journal of Statistical Software</em>, 25(10), 1-21.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simJSS)

## Map areal and point-source measurements
y &lt;- simIowa$y[simIowa$areal == 1]
level &lt;- (max(y) - y) / diff(range(y))
map("county", "iowa", fill = TRUE, col = gray(level))
title("Simulated Iowa Measurements")
points(simIowa$lon, simIowa$lat)

## Map grid sites
map("county", "iowa")
title("Regular Grid of Coordinates")
points(simGrid$lon, simGrid$lat)
</code></pre>

<hr>
<h2 id='summary.ramps'>Posterior Summaries of georamps Model Fits</h2><span id='topic+summary.ramps'></span>

<h3>Description</h3>

<p>Posterior summaries of <code><a href="#topic+georamps">georamps</a></code> model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'ramps'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.ramps_+3A_object">object</code></td>
<td>
<p>object returned by <code>georamps</code>.</p>
</td></tr>
<tr><td><code id="summary.ramps_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code>summary.mcmc</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Two sets of summary statistics for each model parameter.  Sample mean, standard deviation, naive standard error of the mean, and time-series-based standard error are included in the first set.  Quantiles are included in the second.
</p>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+georamps">georamps</a></code>
<code><a href="coda.html#topic+summary.mcmc">summary.mcmc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Posterior summaries for georamps example results

## Not run: 
summary(NURE.fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='window'>Subsetting of MCMC Sampler Results</h2><span id='topic+window.predict.ramps'></span><span id='topic+window.ramps'></span>

<h3>Description</h3>

<p>Post-processing function to subset the MCMC iterations in <code>georamps</code> or <code>predict.ramps</code> results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'ramps'
window(x, iter, ...)

   ## S3 method for class 'predict.ramps'
window(x, iter, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="window_+3A_x">x</code></td>
<td>
<p>object returned by <code>georamps</code> or <code>predict.ramps</code>.</p>
</td></tr>
<tr><td><code id="window_+3A_iter">iter</code></td>
<td>
<p>numerical vector specifying the MCMC iterations to subset.</p>
</td></tr>
<tr><td><code id="window_+3A_...">...</code></td>
<td>
<p>some methods for this generic require additional arguments.  None are used in this method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Subsetted object of the same class as the one supplied.
</p>


<h3>Author(s)</h3>

<p>Brian Smith <a href="mailto:brian-j-smith@uiowa.edu">brian-j-smith@uiowa.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+georamps">georamps</a></code>
<code><a href="#topic+predict.ramps">predict.ramps</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Exclude first five iterations of the georamps example results

## Not run: 
fit &lt;- window(NURE.fit, iter = 6:25)
print(fit)
summary(fit)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
