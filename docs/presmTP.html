<!DOCTYPE html><html><head><title>Help for package presmTP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {presmTP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#colonIDM'><p>Chemotherapy for Stage B/C colon cancer.</p></a></li>
<li><a href='#plot.pstp'><p>Plot for an object of class &quot;pstp&quot;</p></a></li>
<li><a href='#presmTP'><p>Methods for estimation of transition probabilities in the illness-death model</p></a></li>
<li><a href='#summary.pstp'><p>Summarizing fits of &quot;pstp&quot; class</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Methods for Transition Probabilities</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-10-04</td>
</tr>
<tr>
<td>Author:</td>
<td>Gustavo Soutinho, Luis Meira-Machado and Pedro Oliveira</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gustavo Soutinho &lt;gustavosoutinho@sapo.pt&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a function for estimating the transition probabilities in an illness-death model. 
            The transition probabilities can be estimated from the unsmoothed landmark estimators developed 
            by de Una-Alvarez and Meira-Machado (2015) &lt;<a href="https://doi.org/10.1111%2Fbiom.12288">doi:10.1111/biom.12288</a>&gt;.
            Presmoothed estimates can also be obtained through the use of a parametric family of binary
            regression curves, such as logit, probit or cauchit. The additive logistic regression model 
            and nonparametric regression are also alternatives which have been implemented.
            The idea behind the presmoothed landmark estimators is to use the presmoothing techniques 
            developed by  Cao et al. (2005) &lt;<a href="https://doi.org/10.1007%2Fs00180-007-0076-6">doi:10.1007/s00180-007-0076-6</a>&gt; in the 
            landmark estimation of the transition probabilities.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>survPresmooth, mgcv</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-10-29 14:39:01 UTC; ASUS</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-11-01 11:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='colonIDM'>Chemotherapy for Stage B/C colon cancer.</h2><span id='topic+colonIDM'></span>

<h3>Description</h3>

<p>These are data from one of the first successful trials of adjuvant chemotherapy for colon cancer. Levamisole is a low-toxicity compound previously used to treat worm infestations in animals; 5-FU is a moderately toxic (as these things go) chemotherapy agent. </p>


<h3>Usage</h3>

<pre><code class='language-R'>data("colonIDM")</code></pre>


<h3>Format</h3>

<p>A data frame with 929 observations on the following 15 variables.
Below a brief description is given for some of these variables.
</p>

<dl>
<dt>time1</dt><dd><p>Time to recurrence/censoring/death, whichever occurs first.</p>
</dd>
<dt>event1</dt><dd><p>Recurrence/censoring indicator (recurrence=1, alive=0).</p>
</dd>
<dt>Stime</dt><dd><p>Time to censoring/death, whichever occurs first.</p>
</dd>
<dt>event</dt><dd><p>Death/censoring indicator (death=1, alive=0).</p>
</dd>
<dt>rx</dt><dd><p>Treatment - Obs(ervation), Lev(amisole), Lev(amisole)+5-FU.</p>
</dd>
<dt>sex</dt><dd><p>Sex indicator (male=1, female=0).</p>
</dd>
<dt>age</dt><dd><p>Age in years.</p>
</dd>
<dt>obstruct</dt><dd><p>Obstruction of colon by tumour.</p>
</dd>
<dt>perfor</dt><dd><p>Perforation of colon.</p>
</dd>
<dt>adhere</dt><dd><p>Adherence to nearby organs.</p>
</dd>
<dt>nodes</dt><dd><p>Number of lymph nodes with detectable cancer.</p>
</dd>
<dt>differ</dt><dd><p>Differentiation of tumour (1=well, 2=moderate, 3=poor).</p>
</dd>
<dt>extent</dt><dd><p>Extent of local spread (1=submucosa, 2=muscle, 3=serosa,
4=contiguous structures).</p>
</dd>
<dt>surg</dt><dd><p>Time from surgery to registration (0=short, 1=long).</p>
</dd>
<dt>node4</dt><dd><p>More than 4 positive lymph nodes.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The study is originally described in Laurie (1989).The main report is found in Moertel (1990). This data set is closest to that of the final report in Moertel (1991). A version of the data with less follow-up time was used in the paper by Lin (1994).
</p>


<h3>References</h3>

<p>JA Laurie, CG Moertel, TR Fleming, HS Wieand, JE Leigh, J Rubin, GW McCormack, JB Gerstner, JE Krook and J Malliard. Surgical adjuvant therapy of large-bowel carcinoma: An evaluation of levamisole and the combination of levamisole and fluorouracil: The North Central Cancer Treatment Group and the Mayo Clinic. Journal of Clinical Oncology, 7:1447-1456, 1989.
</p>
<p>DY Lin. Cox regression analysis of multivariate failure time data: the marginal approach. Statistics in Medicine, 13:2233-2247, 1994.
</p>
<p>CG Moertel, TR Fleming, JS MacDonald, DG Haller, JA Laurie, PJ Goodman, JS Ungerleider, WA Emerson, DC Tormey, JH Glick, MH Veeder and JA Maillard. Levamisole and fluorouracil for adjuvant therapy of resected colon carcinoma. New England Journal of Medicine, 332:352-358, 1990.
</p>
<p>CG Moertel, TR Fleming, JS MacDonald, DG Haller, JA Laurie, CM Tangen, JS Ungerleider, WA Emerson, DC Tormey, JH Glick, MH Veeder and JA Maillard. Fluorouracil plus Levamisole as and effective adjuvant therapy after resection of stage II colon carcinoma: a final report. Annals of Internal Medicine, 122:321-326, 1991.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(colonIDM)
head(colonIDM)
</code></pre>

<hr>
<h2 id='plot.pstp'>Plot for an object of class &quot;pstp&quot;</h2><span id='topic+plot.pstp'></span>

<h3>Description</h3>

<p>It draws the estimated probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pstp'
plot(x = object, state_ini = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.pstp_+3A_x">x</code></td>
<td>
<p>A fitted pstp object as produced by presmTP.</p>
</td></tr>
<tr><td><code id="plot.pstp_+3A_state_ini">state_ini</code></td>
<td>
<p>Initial state of the transition. Defaults to state_ini=0</p>
</td></tr>
<tr><td><code id="plot.pstp_+3A_...">...</code></td>
<td>
<p>For future methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned.
</p>


<h3>Author(s)</h3>

<p>Gustavo Soutinho, Luis Meira-Machado, Pedro Oliveira.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>res&lt;- presmTP(data = colonIDM, s = 365,method = "uns")
plot(res)

</code></pre>

<hr>
<h2 id='presmTP'>Methods for estimation of transition probabilities in the illness-death model</h2><span id='topic+presmTP'></span>

<h3>Description</h3>

<p>This function is used to obtain unsmoothed and presmoothed estimates of
the transition probabilities in the illness-death model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>presmTP(data, s, method = "uns", estimand = "S",
  bw.selec = "plug-in", fixed.bw = NULL, bound = "none")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="presmTP_+3A_data">data</code></td>
<td>
<p>A numeric value to be squared</p>
</td></tr>
<tr><td><code id="presmTP_+3A_s">s</code></td>
<td>
<p>The first time for obtaining estimates for the transition
probabilities.</p>
</td></tr>
<tr><td><code id="presmTP_+3A_method">method</code></td>
<td>
<p>The method used to compute the transition probabilities.
Possible options are <code>"uns"</code>, <code>"np"</code> <code>"logit"</code>, <code>"logit.gam"</code>,
<code>"probit"</code> and <code>"cauchit"</code>. Defaults to <code>"uns"</code>.</p>
</td></tr>
<tr><td><code id="presmTP_+3A_estimand">estimand</code></td>
<td>
<p>An optional character string identifying the function to estimate: &quot;S&quot; 
for survival function and &quot;H&quot; for cumulative hazard function. Defaults to &quot;S&quot;.</p>
</td></tr>
<tr><td><code id="presmTP_+3A_bw.selec">bw.selec</code></td>
<td>
<p>An optional (partially matched) character string specifying the method of 
bandwidth selection. &quot;fixed&quot; if no bandwidth selection is done, in which case the bandwidth(s)
given by the fixed.bw argument is (are) used, &quot;plug-in&quot; for plug-in bandwidth selection and
&quot;bootstrap&quot; for bootstrap bandwidth selection. Defaults to &quot;fixed&quot;.</p>
</td></tr>
<tr><td><code id="presmTP_+3A_fixed.bw">fixed.bw</code></td>
<td>
<p>An optional numeric vector with the fixed bandwidth(s) used when the value of
the bw.selec argument is &quot;fixed&quot;. It must be of length 1 for estimating survival and cumulative
hazard functions, and of length 2 for density and hazard functions (in this case, the first element
is the presmoothing bandwidth).</p>
</td></tr>
<tr><td><code id="presmTP_+3A_bound">bound</code></td>
<td>
<p>An optional numeric vector with the fixed bandwidth(s) used when the value of the bw.selec
argument is &quot;fixed&quot;. It must be of length 1 for estimating survival and cumulative hazard functions, and
of length 2 for density and hazard functions (in this case, the first element is the presmoothing bandwidth).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;pstp&quot; and one of the following classes: <code>"uns"</code>, 
<code>"np"</code>, <code>"logit"</code>, <code>"logit.gam"</code>,
<code>"probit"</code> and <code>"cauchit"</code>. Objects are implemented as a list with elements:
</p>
<table>
<tr><td><code>est0</code></td>
<td>
<p>data.frame with estimates of the transition probabilities 0-&gt;0, 0-&gt;1 and 0-&gt;2.</p>
</td></tr>
<tr><td><code>est1</code></td>
<td>
<p>data.frame with estimates of the transition probabilities 1-&gt;1 and 1-&gt;2.</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>The first time for obtaining estimates for the transition probabilities.</p>
</td></tr>
<tr><td><code>callp</code></td>
<td>
<p>The expression of the estimated probability.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>A call object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gustavo Soutinho, Luis Meira-Machado, Pedro Oliveira.
</p>


<h3>References</h3>

<p>Aalen O. O., Johansen S. (1978) An Empirical Transition Matrix for
Nonhomogeneous Markov Chains Based on Censored Observations. Scandinavian
Journal of Statistics 5(3), 141&ndash;150.
</p>
<p>Cao, R., Lopez-de-Ullibarri, I., Janssen, P. and Veraverbeke, N. (2005). Presmoothed Kaplan-Meier 
and Nelson-Aalen estimators, Journal of Nonparametric Statistics, 17, 31-56.
</p>
<p>Meira-Machado L. F., de Una-Alvarez J. and Cadarso-Suarez C. (2006).
Nonparametric estimation of transition probabilities in a non-Markov
illness-death model. Lifetime Data Anal 12(3), 325&ndash;344.
</p>
<p>Lopez-de-Ullibarri, I and Jacome, M. A. (2013). survPresmooth: An R Package for Presmoothed
Estimation in Survival Analysis, Journal of Statistical Software, 54(11), 1-26. 
URL: http://www.jstatsoft.org/v54/i11/.
de Una-Alvarez J. and Meira-Machado L. (2015). Nonparametric estimation
of transition probabilities in a non-Markov illness-death model:
a comparative study. Biometrics 71, 364&ndash;375.
</p>
<p>Meira-Machado, L. (2016). Smoothed landmark estimators of the transition probabilities, 
SORT-Statistics and Operations Research Transactions, 40, 375-398.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Unsmoothed
res1&lt;- presmTP(data = colonIDM, s = 365,method = "uns" )
res1$est0$t
res1$est0$p02
res1$est1$t
summary(res1, state_ini=1, time=365*1:5)
plot(res1)
res1$call
class(res1)
#Nonparametric
res2&lt;- presmTP(data = colonIDM, s = 365,method = "np" )
res3&lt;- presmTP(data = colonIDM, s = 365,method = "np", estimand="S")
res4&lt;- presmTP(data = colonIDM, s = 365,method = "np", estimand="H")
res5&lt;- presmTP(data = colonIDM, s = 365,method = "np", 
               bw.selec="fixed", fixed.bw=30)
#Presmoothed - Logit
res6&lt;- presmTP(data = colonIDM, s = 365,method = "logit" )
summary(res6, state_ini=1, time=365*1:5)
#Presmoothed - Logit GAM
res7&lt;- presmTP(data = colonIDM, s = 365,method = "logit.gam" )



</code></pre>

<hr>
<h2 id='summary.pstp'>Summarizing fits of &quot;pstp&quot; class</h2><span id='topic+summary.pstp'></span>

<h3>Description</h3>

<p>Returns a a data.frame or list containing the estimates of the probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pstp'
summary(object, state_ini = 0, times = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.pstp_+3A_object">object</code></td>
<td>
<p>A fitted pstp object as produced by presmTP.</p>
</td></tr>
<tr><td><code id="summary.pstp_+3A_state_ini">state_ini</code></td>
<td>
<p>Initial state of the transition. Defaults to state_ini=0.</p>
</td></tr>
<tr><td><code id="summary.pstp_+3A_times">times</code></td>
<td>
<p>Vector of times; the returned data frame will contain 1 row for each time.</p>
</td></tr>
<tr><td><code id="summary.pstp_+3A_...">...</code></td>
<td>
<p>For future methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame or a list containing the estimates of the probability.
</p>


<h3>Author(s)</h3>

<p>Gustavo Soutinho, Luis Meira-Machado, Pedro Oliveira.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>res&lt;- presmTP(data = colonIDM, s = 365, method = "uns")
summary(res, state_ini=1, times=365*1:5)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
