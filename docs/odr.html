<!DOCTYPE html><html lang="en-US"><head><title>Help for package odr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {odr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#odr-package'><p>Optimal Design and Statistical Power for Experimental Studies</p>
Investigating Main, Mediation, and Moderation Effects</a></li>
<li><a href='#gen.design.pars'><p>Generate optimal design parameters using ant colony optimization</p></a></li>
<li><a href='#od.1'><p>Optimal sample allocation calculation for single-level experiments</p>
detecting main effects</a></li>
<li><a href='#od.1.111'><p>Optimal sample allocation calculation for single-level randomized controlled</p>
trials (RCTs) investigating mediation effects (1-1-1)</a></li>
<li><a href='#od.2'><p>Optimal sample allocation calculation for two-level CRTs detecting main effects</p></a></li>
<li><a href='#od.2.221'><p>Optimal sample allocation calculation for two-level CRTs probing</p>
mediation effects with cluster-level mediators</a></li>
<li><a href='#od.2m'><p>Optimal sample allocation calculation for two-level MRTs detecting main effects</p></a></li>
<li><a href='#od.2m.111'><p>Optimal sample allocation calculation for two-level multisite-randomized</p>
trials investigating mediation effects with individual-level mediators
(1-1-1)</a></li>
<li><a href='#od.3'><p>Optimal sample allocation calculation for three-level CRTs detecting main effects</p></a></li>
<li><a href='#od.3m'><p>Optimal sample allocation calculation for three-level MRTs detecting main effects</p></a></li>
<li><a href='#od.4'><p>Optimal sample allocation calculation for four-level CRTs detecting main effects</p></a></li>
<li><a href='#od.4m'><p>Optimal sample allocation calculation for four-level MRTs detecting main effects</p></a></li>
<li><a href='#power.1'><p>Budget and/or sample size, power, MDES calculation for</p>
single-level experiments detecting main effects</a></li>
<li><a href='#power.1.111'><p>Budget and/or sample size, power, MDES calculation for MRTs investigating</p>
mediation effects with individual-level mediators</a></li>
<li><a href='#power.2'><p>Budget and/or sample size, power, MDES calculation for</p>
two-level CRTs detecting main effects</a></li>
<li><a href='#power.2.221'><p>Budget and/or sample size, power calculation for CRTs probing</p>
mediation effects with cluster-level mediators</a></li>
<li><a href='#power.2m'><p>Budget and/or sample size, power, MDES calculation for two-level</p>
MRTs detecting main effects</a></li>
<li><a href='#power.2m.111'><p>Budget and/or sample size, power, MDES calculation for MRTs investigating</p>
mediation effects with individual-level mediators</a></li>
<li><a href='#power.3'><p>Budget and/or sample size, power, MDES calculation for</p>
three-level CRTs detecting main effects</a></li>
<li><a href='#power.3m'><p>Budget and/or sample size, power, MDES calculation for</p>
three-level MRTs detecting main effects</a></li>
<li><a href='#power.4'><p>Budget and/or sample size, power, MDES calculation for</p>
four-level CRTs detecting main effects</a></li>
<li><a href='#power.4m'><p>Budget and/or sample size, power, MDES calculation for</p>
four-level MRTs detecting main effects</a></li>
<li><a href='#re'><p>Relative efficiency (RE) calculation</p></a></li>
<li><a href='#rpe'><p>Relative precision and efficiency (RPE) calculation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Optimal Design and Statistical Power for Experimental Studies
Investigating Main, Mediation, and Moderation Effects</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-8-8</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculate the optimal sample size allocation that 
    produces the highest statistical power for experimental 
    studies under a budget constraint, and
    perform power analyses with and without accommodating 
    cost structures of sampling. The designs cover single-level 
    and multilevel experiments detecting main, mediation, 
    and moderation effects (and some combinations). 
    The references for the proposed methods include: 
    (1) Shen, Z., &amp; Kelcey, B. (2020). 
    Optimal sample allocation under unequal costs in 
    cluster-randomized trials.
    Journal of Educational and Behavioral Statistics, 45(4): 446-474.
        &lt;<a href="https://doi.org/10.3102%2F1076998620912418">doi:10.3102/1076998620912418</a>&gt;.
    (2) Shen, Z., &amp; Kelcey, B. (2022b). Optimal sample allocation for
    three-level multisite cluster-randomized trials. 
    Journal of Research on Educational Effectiveness, 15 (1), 130-150.
    &lt;<a href="https://doi.org/10.1080%2F19345747.2021.1953200">doi:10.1080/19345747.2021.1953200</a>&gt;.
    (3) Shen, Z., &amp; Kelcey, B. (2022a). Optimal sample allocation in
    multisite randomized trials. The Journal of Experimental Education.
    &lt;<a href="https://doi.org/10.1080%2F00220973.2020.1830361">doi:10.1080/00220973.2020.1830361</a>&gt;.
    (4) Champely, S. (2020). pwr: Basic functions for power analysis 
    (Version 1.3-0) [Software]. Available from 
    <a href="https://CRAN.R-project.org/package=pwr">https://CRAN.R-project.org/package=pwr</a>.</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0), stats (&ge; 3.0.0), graphics (&ge; 3.0.0), base(&ge;
3.0.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, markdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>rmarkdown, knitr, markdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-08 14:15:49 UTC; zucha</td>
</tr>
<tr>
<td>Author:</td>
<td>Zuchao Shen <a href="https://orcid.org/0000-0003-3483-0451"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Benjamin Kelcey [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zuchao Shen &lt;zuchao.shen@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-08 14:30:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='odr-package'>Optimal Design and Statistical Power for Experimental Studies
Investigating Main, Mediation, and Moderation Effects</h2><span id='topic+odr'></span><span id='topic+odr-package'></span>

<h3>Description</h3>

<p>This package is to help researchers design cost-efficient and well-powered
experimental studies investigating main, mediation, and moderation
effects (and some combinations). Specifically, this package can
(a) identify optimal sample allocations,
(b) compare design efficiency between different sample allocations,
and (c) perform power analyses with and without
accommodating costs and budget.
</p>


<h3>Details</h3>

<p>The package covers seven types of experiments aiming to detect
main, moderation, and mediation effects. These experiments are
individual randomized controlled trials (RCTs), two-,
three-, and four-level cluster-randomized trials (CRTs),
two-, three-, and four-level multisite randomized trials (MRTs).
The two categorical functions are
'od' and 'power'. The 'od' function can
calculate the optimal sample allocation with and without constraint for
each type of experiments.
The 'power' function by default can calculate required budget
(and required sample size) for desired
power, minimum detectable effect size (MDES) under a fixed budget,
statistical power under a fixed budget.
The 'power' function can perform conventional power analyses
(e.g., required sample size, power, MDES calculation).
The uniform function 're' (or 'rpe') is to compare
the relative (precision and) efficiency between two designs
with different sample allocations (limited to main effects).
</p>


<h3>Author(s)</h3>

<p>Zuchao Shen, Benjamin Kelcey
</p>
<p>Maintainer: Zuchao Shen <a href="mailto:zuchao.shen@gmail.com">zuchao.shen@gmail.com</a>
(University of Georgia)
</p>

<hr>
<h2 id='gen.design.pars'>Generate optimal design parameters using ant colony optimization</h2><span id='topic+gen.design.pars'></span>

<h3>Description</h3>

<p>This function can generate a set of optimal design parameters
based on given distributions of the rank of optimization target
(or budget).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen.design.pars(
  dist.mean,
  dist.rank,
  n.of.ants,
  nl,
  q = 1e-04,
  n.of.archive = 100,
  xi = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gen.design.pars_+3A_dist.mean">dist.mean</code></td>
<td>
<p>List of means - coordinates</p>
</td></tr>
<tr><td><code id="gen.design.pars_+3A_dist.rank">dist.rank</code></td>
<td>
<p>Rank of the archived values of objective function</p>
</td></tr>
<tr><td><code id="gen.design.pars_+3A_n.of.ants">n.of.ants</code></td>
<td>
<p>Number of ants used in each iteration after the initialization
of power analysis for calculating required budget, default value is 10.</p>
</td></tr>
<tr><td><code id="gen.design.pars_+3A_nl">nl</code></td>
<td>
<p>Neighborhood of the search area</p>
</td></tr>
<tr><td><code id="gen.design.pars_+3A_q">q</code></td>
<td>
<p>Locality of the search (0,1), default is 0.0001.</p>
</td></tr>
<tr><td><code id="gen.design.pars_+3A_n.of.archive">n.of.archive</code></td>
<td>
<p>Size of the solution archive, default is 100.</p>
</td></tr>
<tr><td><code id="gen.design.pars_+3A_xi">xi</code></td>
<td>
<p>Convergence pressure (0, Inf), suggested: (0, 1), default is 0.5.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Generated optimal design parameter value(s) (i.e., a matrix with n.of.ants
rows and n.of.design.pars columns)
</p>


<h3>References</h3>

<p>Socha, K., &amp; Dorigo, M. (2008). Ant colony optimization for
continuous domains. European Journal of Operational Research,
185(3), 1155-1173.
</p>
<p>We thank Dr. Krzysztof Socha for providing us the
original code (http://iridia.ulb.ac.be/supp/IridiaSupp2008-001/)
for this function.
</p>

<hr>
<h2 id='od.1'>Optimal sample allocation calculation for single-level experiments
detecting main effects</h2><span id='topic+od.1'></span>

<h3>Description</h3>

<p>The optimal design of single-level experiments detecting main effects
is to choose
the optimal sample allocation that minimizes the variance of
a treatment effect under a fixed budget,  which is approximately the optimal
sample allocation that maximizes statistical power under a fixed budget.
The optimal design parameter is
the proportion of individuals to be assigned to treatment (<code>p</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>od.1(
  p = NULL,
  r12 = NULL,
  c1 = NULL,
  c1t = NULL,
  m = NULL,
  plots = TRUE,
  plim = NULL,
  varlim = NULL,
  plab = NULL,
  varlab = NULL,
  vartitle = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="od.1_+3A_p">p</code></td>
<td>
<p>The proportion of individuals to be assigned to treatment.</p>
</td></tr>
<tr><td><code id="od.1_+3A_r12">r12</code></td>
<td>
<p>The proportion of outcome variance explained by covariates.</p>
</td></tr>
<tr><td><code id="od.1_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling one unit in control condition.</p>
</td></tr>
<tr><td><code id="od.1_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling one unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.1_+3A_m">m</code></td>
<td>
<p>Total budget, default value is the total costs of sampling 60
individuals across treatment conditions.</p>
</td></tr>
<tr><td><code id="od.1_+3A_plots">plots</code></td>
<td>
<p>Logical, provide variance plots if TRUE, otherwise not; default value is TRUE.</p>
</td></tr>
<tr><td><code id="od.1_+3A_plim">plim</code></td>
<td>
<p>The plot range for p, default value is c(0, 1).</p>
</td></tr>
<tr><td><code id="od.1_+3A_varlim">varlim</code></td>
<td>
<p>The plot range for variance, default value is c(0, 0.05).</p>
</td></tr>
<tr><td><code id="od.1_+3A_plab">plab</code></td>
<td>
<p>The plot label for <code>p</code> ,
default value is &quot;Proportion of Individuals in Treatment: p&quot;.</p>
</td></tr>
<tr><td><code id="od.1_+3A_varlab">varlab</code></td>
<td>
<p>The plot label for variance,
default value is &quot;Variance&quot;.</p>
</td></tr>
<tr><td><code id="od.1_+3A_vartitle">vartitle</code></td>
<td>
<p>The title of variance plot, default value is NULL.</p>
</td></tr>
<tr><td><code id="od.1_+3A_verbose">verbose</code></td>
<td>
<p>Logical; print the value of <code>p</code> if TRUE,
otherwise not; default value is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Unconstrained or constrained optimal sample allocation (<code>p</code>).
The function also returns the variance of the treatment effect,
function name, design type,
and parameters used in the calculation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Unconstrained optimal design #---------
  myod1 &lt;- od.1(r12 = 0.5, c1 = 1, c1t = 5, varlim = c(0, 0.2))
  myod1$out # output

# Constrained p, no calculation performed #---------
  myod2 &lt;- od.1(r12 = 0.5, c1 = 1, c1t = 5, varlim = c(0, 0.2), p = 0.5)
  myod2$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod2)
  myre$re # RE = 0.87

# When sampling costs are equal, a balanced  design with p = 0.5 is the best #---------
  myod3 &lt;- od.1(r12 = 0.5, c1 = 1, c1t = 1, varlim = c(0, 0.2))
  myod3$out # output

</code></pre>

<hr>
<h2 id='od.1.111'>Optimal sample allocation calculation for single-level randomized controlled
trials (RCTs) investigating mediation effects (1-1-1)</h2><span id='topic+od.1.111'></span>

<h3>Description</h3>

<p>The optimal design of single-level RCTs
probing mediation effects is to identify the optimal sample
allocation that use the minimum budget to achieve a fixed level of
statistical power. The optimal design parameter is the proportion of
individuals/units to be assigned to the experimental condition.
This function identifies the optimal <code>p</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>od.1.111(
  a = NULL,
  b = NULL,
  c1 = NULL,
  c1t = NULL,
  m = NULL,
  r.yx = 0,
  r.mx = 0,
  r.mw = 0,
  q.a = 0,
  q.b = 0,
  test = "joint",
  p = NULL,
  n = NULL,
  tol = 1e-11,
  power = 0.8,
  d.p = c(0.1, 0.5),
  sig.level = 0.05,
  two.tailed = TRUE,
  plim = c(0.01, 0.99),
  varlim = c(0, 0.001),
  plab = NULL,
  varlab = NULL,
  vartitle = NULL,
  nlim = c(6, 1e+06),
  verbose = TRUE,
  max.value = Inf,
  max.iter = 300,
  e = 1e-10,
  n.of.ants = 10,
  n.of.archive = 20,
  q = 1e-04,
  xi = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="od.1.111_+3A_a">a</code></td>
<td>
<p>The treatment effect on the mediator.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_b">b</code></td>
<td>
<p>The within-treatment correlation between the outcome and
the mediator.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling an individual in the control group.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling an individual in the treated group.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_m">m</code></td>
<td>
<p>Total budget.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_r.yx">r.yx</code></td>
<td>
<p>The within-treatment correlation between the outcome and the
covariate(s) in the outcome model.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_r.mx">r.mx</code></td>
<td>
<p>The within-treatment correlation between the mediator and the
covariate(s) in the outcome model.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_r.mw">r.mw</code></td>
<td>
<p>The within-treatment correlation between the mediator and the
covariate(s) in the mediator model.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_q.a">q.a</code></td>
<td>
<p>The number of covariates at the mediator model
(except the treatment indicator), the default value is zero.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_q.b">q.b</code></td>
<td>
<p>The number of covariates in the outcome model (except the treatment
indicator and the mediator), the default value is zero.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_test">test</code></td>
<td>
<p>The type of test will be used to detect mediation effects.
The default is the joint significance test (i.e., test = &quot;joint&quot;,
&quot;Joint&quot;,&quot;JOINT&quot;). Another choice is the Sobel test by
specifying the argument as test = &quot;sobel&quot;, &quot;Sobel&quot;, or &quot;SOBEL&quot;.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_p">p</code></td>
<td>
<p>The proportion of level-4 clusters/units to be assigned to treatment.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_n">n</code></td>
<td>
<p>Total number of individuals in the experimental study, the default
value is NULL.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_tol">tol</code></td>
<td>
<p>convergence tolerance.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_power">power</code></td>
<td>
<p>Statistical power specified, default is .80.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_d.p">d.p</code></td>
<td>
<p>The initial sampling domains for p. Default is c(0.10, 0.50).</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level or type I error rate, default value is 0.05.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_two.tailed">two.tailed</code></td>
<td>
<p>Two tailed test, the default value is TRUE.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_plim">plim</code></td>
<td>
<p>The plot range for p, default value is c(0, 1).</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_varlim">varlim</code></td>
<td>
<p>The plot range for variance, default value is c(0, 0.05).</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_plab">plab</code></td>
<td>
<p>The plot label for <code>p</code> ,
default value is &quot;Proportion of Individuals in Treatment: p&quot;.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_varlab">varlab</code></td>
<td>
<p>The plot label for variance,
default value is &quot;Variance&quot;.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_vartitle">vartitle</code></td>
<td>
<p>The title of variance plot, default value is NULL.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_nlim">nlim</code></td>
<td>
<p>The interval/range used to numerically solve for n,
the default values are c(6, 1e7).</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_verbose">verbose</code></td>
<td>
<p>Print out evaluation process if TRUE, default is TRUE.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_max.value">max.value</code></td>
<td>
<p>Maximal value of optimization when used as
the stopping criterion. Default is infinite.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_max.iter">max.iter</code></td>
<td>
<p>Maximal number of function evaluations when used as
the stopping criterion. Default is 200.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_e">e</code></td>
<td>
<p>Maximum error value used when solution quality used as
the stopping criterion, default is 1e-10.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_n.of.ants">n.of.ants</code></td>
<td>
<p>Number of ants used in each iteration after
the initialization stage, the default value is 10.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_n.of.archive">n.of.archive</code></td>
<td>
<p>Size of the solution archive, default is 20.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_q">q</code></td>
<td>
<p>Locality of the search (0,1), default is 0.0001.</p>
</td></tr>
<tr><td><code id="od.1.111_+3A_xi">xi</code></td>
<td>
<p>Convergence pressure (0, Inf), suggested: (0, 1), default is 0.5.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Unconstrained or constrained optimal sample allocation <code>p</code>).
The function also returns statistical power,
function name, design type,
and parameters used in the calculation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myod &lt;- od.1.111(a = .3, b = .5, c1 = 10, c1t = 100)
myod
</code></pre>

<hr>
<h2 id='od.2'>Optimal sample allocation calculation for two-level CRTs detecting main effects</h2><span id='topic+od.2'></span>

<h3>Description</h3>

<p>The optimal design of two-level
cluster randomized trials (CRTs) detecting main effects is to calculate
the optimal sample allocation that minimizes the variance of
a treatment effect under a fixed budget, which is approximately the optimal
sample allocation that maximizes statistical power under a fixed budget.
The optimal design parameters include
the level-1 sample size per level-2 unit (<code>n</code>)
and the proportion of level-2 clusters/groups to be assigned to treatment (<code>p</code>).
This function solves the optimal <code>n</code> and/or <code>p</code>
with and without constraints.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>od.2(
  n = NULL,
  p = NULL,
  icc = NULL,
  r12 = NULL,
  r22 = NULL,
  c1 = NULL,
  c2 = NULL,
  c1t = NULL,
  c2t = NULL,
  m = NULL,
  plots = TRUE,
  plot.by = NULL,
  nlim = NULL,
  plim = NULL,
  varlim = NULL,
  nlab = NULL,
  plab = NULL,
  varlab = NULL,
  vartitle = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="od.2_+3A_n">n</code></td>
<td>
<p>The level-1 sample size per level-2 unit.</p>
</td></tr>
<tr><td><code id="od.2_+3A_p">p</code></td>
<td>
<p>The proportion of level-2 clusters/units to be assigned to treatment.</p>
</td></tr>
<tr><td><code id="od.2_+3A_icc">icc</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) in population or in
each treatment condition.</p>
</td></tr>
<tr><td><code id="od.2_+3A_r12">r12</code></td>
<td>
<p>The proportion of level-1 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="od.2_+3A_r22">r22</code></td>
<td>
<p>The proportion of level-2 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="od.2_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling one level-1 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.2_+3A_c2">c2</code></td>
<td>
<p>The cost of sampling one level-2 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.2_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling one level-1 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.2_+3A_c2t">c2t</code></td>
<td>
<p>The cost of sampling one level-2 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.2_+3A_m">m</code></td>
<td>
<p>Total budget, default value is the total costs of sampling 60
level-2 units across treatment conditions.</p>
</td></tr>
<tr><td><code id="od.2_+3A_plots">plots</code></td>
<td>
<p>Logical, provide variance plots if TRUE, otherwise not; default value is TRUE.</p>
</td></tr>
<tr><td><code id="od.2_+3A_plot.by">plot.by</code></td>
<td>
<p>Plot the variance by <code>n</code> and/or <code>p</code>; default value is
plot.by = list(n = &quot;n&quot;, p = &quot;p&quot;).</p>
</td></tr>
<tr><td><code id="od.2_+3A_nlim">nlim</code></td>
<td>
<p>The plot range for n, default value is c(2, 50).</p>
</td></tr>
<tr><td><code id="od.2_+3A_plim">plim</code></td>
<td>
<p>The plot range for p, default value is c(0, 1).</p>
</td></tr>
<tr><td><code id="od.2_+3A_varlim">varlim</code></td>
<td>
<p>The plot range for variance, default value is c(0, 0.05).</p>
</td></tr>
<tr><td><code id="od.2_+3A_nlab">nlab</code></td>
<td>
<p>The plot label for <code>n</code>,
default value is &quot;Level-1 Sample Size: n&quot;.</p>
</td></tr>
<tr><td><code id="od.2_+3A_plab">plab</code></td>
<td>
<p>The plot label for p,
default value is &quot;Proportion Level-2 Units in Treatment: p&quot;.</p>
</td></tr>
<tr><td><code id="od.2_+3A_varlab">varlab</code></td>
<td>
<p>The plot label for variance,
default value is &quot;Variance&quot;.</p>
</td></tr>
<tr><td><code id="od.2_+3A_vartitle">vartitle</code></td>
<td>
<p>The title of variance plot, default value is NULL.</p>
</td></tr>
<tr><td><code id="od.2_+3A_verbose">verbose</code></td>
<td>
<p>Logical; print the values of <code>n</code> and <code>p</code> if TRUE,
otherwise not; default value is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Unconstrained or constrained optimal sample allocation (<code>n</code> and <code>p</code>).
The function also returns the variance of the treatment effect,
function name, design type,
and parameters used in the calculation.
</p>


<h3>References</h3>

<p>Shen, Z., &amp; Kelcey, B. (2020). Optimal sample allocation under unequal
costs in cluster-randomized trials. Journal of Educational
and Behavioral Statistics, 45(4): 446â€“474. &lt;https://doi.org/10.3102/1076998620912418&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Unconstrained optimal design #---------
  myod1 &lt;- od.2(icc = 0.2, r12 = 0.5, r22 = 0.5, c1 = 1, c2 = 5, c1t = 1, c2t = 50,
              varlim = c(0.01, 0.02))
  myod1$out # output
# Plot by p
  myod1 &lt;- od.2(icc = 0.2, r12 = 0.5, r22 = 0.5, c1 = 1, c2 = 5, c1t = 1, c2t = 50,
              varlim = c(0.01, 0.02), plot.by = list(p = 'p'))

# Constrained optimal design with n = 20 #---------
  myod2 &lt;- od.2(icc = 0.2, r12 = 0.5, r22 = 0.5, c1 = 1, c2 = 5, c1t = 1, c2t = 50,
              n = 20, varlim = c(0.005, 0.025))
  myod2$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod2)
  myre$re # RE = 0.88

# Constrained optimal design with p = 0.5 #---------
  myod3 &lt;- od.2(icc = 0.2, r12 = 0.5, r22 = 0.5, c1 = 1, c2 = 5, c1t = 1, c2t = 50,
             p = 0.5, varlim = c(0.005, 0.025))
  myod3$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod3)
  myre$re # RE = 0.90

# Constrained n and p, no calculation performed #---------
  myod4 &lt;- od.2(icc = 0.2, r12 = 0.5, r22 = 0.5, c1 = 1, c2 = 5, c1t = 1, c2t = 50,
              n = 20, p = 0.5, varlim = c(0.005, 0.025))
  myod4$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod4)
  myre$re # RE = 0.83

</code></pre>

<hr>
<h2 id='od.2.221'>Optimal sample allocation calculation for two-level CRTs probing
mediation effects with cluster-level mediators</h2><span id='topic+od.2.221'></span>

<h3>Description</h3>

<p>The optimal design of two-level
cluster randomized trials (CRTs) probing mediation effects with
cluster-level mediators is to to identify
the optimal sample allocation that requires the minimum budget
to achieve certain power level.
The optimal design parameters include
the level-1 sample size per level-2 unit (<code>n</code>)
and the proportion of level-2 clusters/groups to be assigned to
treatment (<code>p</code>).
This function solves the optimal <code>n</code> and/or <code>p</code>
with and without a constraint.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>od.2.221(
  a = NULL,
  b = NULL,
  n = NULL,
  p = NULL,
  icc = NULL,
  c1 = NULL,
  c1t = NULL,
  c2 = NULL,
  c2t = NULL,
  m = NULL,
  r2m = 0,
  r.yx = 0,
  r.mw = 0,
  r.yw = 0,
  q.a = 0,
  q.b = 0,
  test = "joint",
  tol = 1e-11,
  power = 0.8,
  d.p = c(0.1, 0.5),
  d.n = c(2, 100),
  sig.level = 0.05,
  two.tailed = TRUE,
  Jlim = c(max(q.a, q.b) + 4, 1e+06),
  verbose = TRUE,
  nrange = c(1.5, 10000),
  max.value = Inf,
  max.iter = 300,
  e = 1e-10,
  n.of.ants = 10,
  n.of.archive = 50,
  q = 1e-04,
  xi = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="od.2.221_+3A_a">a</code></td>
<td>
<p>The treatment effect on the mediator.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_b">b</code></td>
<td>
<p>The within treatment correlation between the outcome and
the mediator at the cluster level.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_n">n</code></td>
<td>
<p>The level-1 sample size per level-2 unit.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_p">p</code></td>
<td>
<p>The proportion of level-2 clusters/units to be assigned to treatment.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_icc">icc</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) in population or in
each treatment condition.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling one level-1 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling one level-1 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_c2">c2</code></td>
<td>
<p>The cost of sampling one level-2 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_c2t">c2t</code></td>
<td>
<p>The cost of sampling one level-2 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_m">m</code></td>
<td>
<p>Total budget.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_r2m">r2m</code></td>
<td>
<p>The proportion of mediator variance explained by covariates in
the mediator model.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_r.yx">r.yx</code></td>
<td>
<p>The correlation between the outcome and the covariate at the
individual level.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_r.mw">r.mw</code></td>
<td>
<p>The correlation between the mediator and the covariate at the
cluster level.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_r.yw">r.yw</code></td>
<td>
<p>The correlation between the outcome and the covariate at the
cluster level.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_q.a">q.a</code></td>
<td>
<p>The number of covariates in the mediator model
(except the treatment indicator).</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_q.b">q.b</code></td>
<td>
<p>The  number of covariates in the outcome model
at the cluster level
(except the treatment indicator and the mediator).</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_test">test</code></td>
<td>
<p>The type of test will be used to detect mediation effects.
Default is the joint significance test (i.e., test = &quot;joint&quot;).
The other choice is the Sobel test
by specifying the argument as test = &quot;sobel&quot;.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_tol">tol</code></td>
<td>
<p>convergence tolerance.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_power">power</code></td>
<td>
<p>Statistical power specified. The default value is .80.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_d.p">d.p</code></td>
<td>
<p>The initial sampling domains for p. Default is c(0.1, 0.5).</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_d.n">d.n</code></td>
<td>
<p>The initial sampling domain for n. Default is c(2, 100).</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level or type I error rate, default value is 0.05.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_two.tailed">two.tailed</code></td>
<td>
<p>Two tailed test, the default value is TRUE.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_jlim">Jlim</code></td>
<td>
<p>The range for J to solve for a numerical solution.
Default is c(max(q.a, q.b)+4, 1e6).</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_verbose">verbose</code></td>
<td>
<p>Print out evaluation process if TRUE, default is TRUE.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_nrange">nrange</code></td>
<td>
<p>The range of the individual-level sample size per cluster
that used to exclude unreasonable values. Default value is c(1.5, 10000).</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_max.value">max.value</code></td>
<td>
<p>Maximal value of optimization when used as
the stopping criterion. Default is -Inf.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_max.iter">max.iter</code></td>
<td>
<p>Maximal number of function evaluations when used as
the stopping criterion.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_e">e</code></td>
<td>
<p>Maximum error value used when solution quality used as
the stopping criterion, default is 1e-10.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_n.of.ants">n.of.ants</code></td>
<td>
<p>Number of ants used in each iteration after the initialization
of power analysis for calculating required budget, default value is 10.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_n.of.archive">n.of.archive</code></td>
<td>
<p>Size of the solution archive, default is 100.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_q">q</code></td>
<td>
<p>Locality of the search (0,1), default is 0.0001.</p>
</td></tr>
<tr><td><code id="od.2.221_+3A_xi">xi</code></td>
<td>
<p>Convergence pressure (0, Inf), suggested: (0, 1), default is 0.5.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Unconstrained or constrained optimal sample allocation
(<code>n</code> and <code>p</code>).
The function also returns the variance of a mediation effect
or statistical power,
function name, design type,
and parameters used in the calculation.
</p>

<hr>
<h2 id='od.2m'>Optimal sample allocation calculation for two-level MRTs detecting main effects</h2><span id='topic+od.2m'></span>

<h3>Description</h3>

<p>The optimal design of two-level
multisite randomized trials (MRTs) detecting main effects is to calculate
the sample allocation that minimizes the variance of a
treatment effect under a fixed budget, which is approximately the optimal
sample allocation that maximizes statistical power under a fixed budget.
The optimal design parameters include
the level-one sample size per site (<code>n</code>)
and the proportion of level-one unit to be assigned to treatment (<code>p</code>).
This function solves the optimal <code>n</code> and/or <code>p</code>
with and without a constraint.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>od.2m(
  n = NULL,
  p = NULL,
  icc = NULL,
  r12 = NULL,
  r22m = NULL,
  c1 = NULL,
  c2 = NULL,
  c1t = NULL,
  omega = NULL,
  m = NULL,
  plots = TRUE,
  plot.by = NULL,
  nlim = NULL,
  plim = NULL,
  varlim = NULL,
  nlab = NULL,
  plab = NULL,
  varlab = NULL,
  vartitle = NULL,
  verbose = TRUE,
  iter = 100,
  tol = 1e-10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="od.2m_+3A_n">n</code></td>
<td>
<p>The level-1 sample size per level-2 unit.</p>
</td></tr>
<tr><td><code id="od.2m_+3A_p">p</code></td>
<td>
<p>The proportion of level-4 clusters/units to be assigned to treatment.</p>
</td></tr>
<tr><td><code id="od.2m_+3A_icc">icc</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) in population or in
each treatment condition.</p>
</td></tr>
<tr><td><code id="od.2m_+3A_r12">r12</code></td>
<td>
<p>The proportion of level-1 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="od.2m_+3A_r22m">r22m</code></td>
<td>
<p>The proportion of variance of site-specific treatment effect explained by covariates.</p>
</td></tr>
<tr><td><code id="od.2m_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling one level-1 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.2m_+3A_c2">c2</code></td>
<td>
<p>The cost of sampling one level-2 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.2m_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling one level-1 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.2m_+3A_omega">omega</code></td>
<td>
<p>The standardized variance of site-specific treatment effect.</p>
</td></tr>
<tr><td><code id="od.2m_+3A_m">m</code></td>
<td>
<p>Total budget, default is the total costs of sampling 60
sites.</p>
</td></tr>
<tr><td><code id="od.2m_+3A_plots">plots</code></td>
<td>
<p>Logical, provide variance plots if TRUE, otherwise not; default value is TRUE.</p>
</td></tr>
<tr><td><code id="od.2m_+3A_plot.by">plot.by</code></td>
<td>
<p>Plot the variance by <code>n</code> and/or <code>p</code>;
default value is plot.by = list(n = &quot;n&quot;, p = &quot;p&quot;).</p>
</td></tr>
<tr><td><code id="od.2m_+3A_nlim">nlim</code></td>
<td>
<p>The plot range for n, default value is c(2, 50).</p>
</td></tr>
<tr><td><code id="od.2m_+3A_plim">plim</code></td>
<td>
<p>The plot range for p, default value is c(0, 1).</p>
</td></tr>
<tr><td><code id="od.2m_+3A_varlim">varlim</code></td>
<td>
<p>The plot range for variance, default value is c(0, 0.05).</p>
</td></tr>
<tr><td><code id="od.2m_+3A_nlab">nlab</code></td>
<td>
<p>The plot label for <code>n</code>,
default value is &quot;Level-1 Sample Size: n&quot;.</p>
</td></tr>
<tr><td><code id="od.2m_+3A_plab">plab</code></td>
<td>
<p>The plot label for <code>p</code>,
default value is &quot;Proportion Level-1 Units in Treatment: p&quot;.</p>
</td></tr>
<tr><td><code id="od.2m_+3A_varlab">varlab</code></td>
<td>
<p>The plot label for variance,
default value is &quot;Variance&quot;.</p>
</td></tr>
<tr><td><code id="od.2m_+3A_vartitle">vartitle</code></td>
<td>
<p>The title of variance plot, default value is NULL.</p>
</td></tr>
<tr><td><code id="od.2m_+3A_verbose">verbose</code></td>
<td>
<p>Logical; print the values of <code>n</code>
and <code>p</code> if TRUE, otherwise not; default value is TRUE.</p>
</td></tr>
<tr><td><code id="od.2m_+3A_iter">iter</code></td>
<td>
<p>Number of iterations; default value is 100.</p>
</td></tr>
<tr><td><code id="od.2m_+3A_tol">tol</code></td>
<td>
<p>Tolerance for convergence; default value is 1e-10.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Unconstrained or constrained optimal sample allocation
(<code>n</code> and <code>p</code>).
The function also returns the variance of the treatment effect,
function name, design type,
and parameters used in the calculation.
</p>


<h3>References</h3>

<p>Shen, Z., &amp; Kelcey, B. (in press). Optimal sample
allocation in multisite randomized trials.
The Journal of Experimental Education.
&lt;https://doi.org/10.1080/00220973.2020.1830361&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Unconstrained optimal design #---------
  myod1 &lt;- od.2m(icc = 0.2, omega = 0.02, r12 = 0.5, r22m = 0.5,
              c1 = 1, c2 = 10, c1t = 10,
              varlim = c(0, 0.005))
  myod1$out # n = 20, p =0.37
# Plots by p
  myod1 &lt;- od.2m(icc = 0.2, omega = 0.02,
              r12 = 0.5, r22m = 0.5,
              c1 = 1, c2 = 10, c1t = 10,
              varlim = c(0, 0.005), plot.by = list(p = 'p'))

# Constrained optimal design with p = 0.5 #---------
  myod2 &lt;- od.2m(icc = 0.2, omega = 0.02,
              r12 = 0.5, r22m = 0.5,
              c1 = 1, c2 = 10, c1t = 10,
              varlim = c(0, 0.005), p = 0.5)
  myod2$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod2)
  myre$re # RE = 0.86

# Constrained optimal design with n = 5 #---------
  myod3 &lt;- od.2m(icc = 0.2, omega = 0.02,
              r12 = 0.5, r22m = 0.5, c1 = 1, c2 = 10,
              c1t = 10, varlim = c(0, 0.005), n = 5)
  myod3$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod3)
  myre$re # RE = 0.79

# Constrained n and p, no calculation performed #---------
  myod4 &lt;- od.2m(icc = 0.2, omega = 0.02, r12 = 0.5, r22m = 0.5,
              c1 = 1, c2 = 10, c1t = 10,
              varlim = c(0, 0.005), p = 0.5, n = 10)
  myod4$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod4)
  myre$re # RE = 0.84

</code></pre>

<hr>
<h2 id='od.2m.111'>Optimal sample allocation calculation for two-level multisite-randomized
trials investigating mediation effects with individual-level mediators
(1-1-1)</h2><span id='topic+od.2m.111'></span>

<h3>Description</h3>

<p>The optimal design of two-level
multisite-randomized trials (MRTs) probing mediation effects with
individual-level mediators, for the
Sobel test, is to calculate
the optimal sample allocation that minimizes the variance of
a mediation effect under a fixed budget. For the joint significance test, it is to identify
the optimal sample allocation that requires the minimum budget
to achieve certain power level.
The optimal design parameters include
the level-1 sample size per level-2 unit (<code>n</code>)
and the proportion of level-1 individuals/units to be assigned to treatment (<code>p</code>).
This function solves the optimal <code>n</code> and/or <code>p</code>
with and without a constraint.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>od.2m.111(
  a = NULL,
  b = NULL,
  icc.m = NULL,
  icc = NULL,
  c1 = NULL,
  c1t = NULL,
  c2 = NULL,
  m = NULL,
  r12m = 0,
  r22m = 0,
  r12 = 0,
  omega = 0.01,
  q.a = 0,
  q.b = 3,
  test = "joint",
  n = NULL,
  p = NULL,
  iter = 100,
  tol = 1e-11,
  power = 0.8,
  d.p = c(0.1, 0.5),
  d.n = c(5, 50),
  sig.level = 0.05,
  two.tailed = TRUE,
  plots = TRUE,
  nlim = c(4, 100),
  plim = c(0.01, 0.99),
  varlim = c(0, 0.001),
  nlab = NULL,
  plab = NULL,
  varlab = NULL,
  vartitle = NULL,
  Jlim = c(3, 1e+05),
  verbose = TRUE,
  max.value = Inf,
  max.iter = 300,
  e = 1e-10,
  n.of.ants = 10,
  n.of.archive = 50,
  q = 1e-04,
  xi = 0.5,
  plot.by = list(n = "n", p = "p")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="od.2m.111_+3A_a">a</code></td>
<td>
<p>The treatment effect on the mediator.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_b">b</code></td>
<td>
<p>The within treatment correlation between the outcome and the mediator.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_icc.m">icc.m</code></td>
<td>
<p>The intraclass correlation coefficient for the mediator.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_icc">icc</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) in population or in
each treatment condition.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling one level-1 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling one level-1 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_c2">c2</code></td>
<td>
<p>The cost of sampling one level-2 unit.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_m">m</code></td>
<td>
<p>Total budget.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_r12m">r12m</code></td>
<td>
<p>The proportion of within treatment mediator variance at the level one
explained by covariates.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_r22m">r22m</code></td>
<td>
<p>The proportion of treatment-by-site variance 
explained by covariates.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_r12">r12</code></td>
<td>
<p>The proportion of within treatment individual-level outcome variance
explained by covariates.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_omega">omega</code></td>
<td>
<p>The treatment-by-site variance of the outcome.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_q.a">q.a</code></td>
<td>
<p>The number of covariates at the individual level of the mediator model
(except the treatment indicator).</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_q.b">q.b</code></td>
<td>
<p>The number of covariates in the outcome model (except the treatment indicator
and the mediator).</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_test">test</code></td>
<td>
<p>The type of test will be used to detect mediation effects. Default is
the joint significance test (i.e., test = &quot;joint&quot;).
Another choice is the Sobel test by specifying the argument as test = &quot;sobel&quot;.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_n">n</code></td>
<td>
<p>The level-1 sample size per level-2 unit.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_p">p</code></td>
<td>
<p>The proportion of level-1 units to be assigned to treatment.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_iter">iter</code></td>
<td>
<p>number of iteration used for solving roots in the Sobel test.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_tol">tol</code></td>
<td>
<p>convergence tolerance.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_power">power</code></td>
<td>
<p>Statistical power specified, default is .80.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_d.p">d.p</code></td>
<td>
<p>The initial sampling domains for p. Default is c(0.10, 0.50).</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_d.n">d.n</code></td>
<td>
<p>The initial sampling domain for n. Default is c(4, 500).</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level or type I error rate, default value is 0.05.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_two.tailed">two.tailed</code></td>
<td>
<p>Logical; two-tailed tests if TRUE,
otherwise one-tailed tests; default value is TRUE.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_plots">plots</code></td>
<td>
<p>Logical, provide variance plots if TRUE, otherwise not; default value is TRUE.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_nlim">nlim</code></td>
<td>
<p>The plot range for n, default value is c(2, 50).</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_plim">plim</code></td>
<td>
<p>The plot range for p, default value is c(0, 1).</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_varlim">varlim</code></td>
<td>
<p>The plot range for variance, default value is c(0, 0.05).</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_nlab">nlab</code></td>
<td>
<p>The plot label for <code>n</code>,
default value is &quot;Level-1 Sample Size: n&quot;.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_plab">plab</code></td>
<td>
<p>The plot label for <code>p</code>,
default value is &quot;Proportion Level-3 Units in Treatment: p&quot;.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_varlab">varlab</code></td>
<td>
<p>The plot label for variance,
default value is &quot;Variance&quot;.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_vartitle">vartitle</code></td>
<td>
<p>The title of variance plot, default value is NULL.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_jlim">Jlim</code></td>
<td>
<p>The range for J to search for a numerical solution. Default is c(3, 10e4).</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_verbose">verbose</code></td>
<td>
<p>Print out evaluation process if TRUE, default is TRUE.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_max.value">max.value</code></td>
<td>
<p>Maximal value of optimization when used as
the stopping criterion. Default is infinite.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_max.iter">max.iter</code></td>
<td>
<p>Maximal number of function evaluations when used as
the stopping criterion. Default is 200.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_e">e</code></td>
<td>
<p>Maximum error value used when solution quality used as
the stopping criterion, default is 1e-10.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_n.of.ants">n.of.ants</code></td>
<td>
<p>Number of ants used in each iteration after the initialization
of power analysis for calculating required budget, default value is 10.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_n.of.archive">n.of.archive</code></td>
<td>
<p>Size of the solution archive, default is 100.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_q">q</code></td>
<td>
<p>Locality of the search (0,1), default is 0.0001.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_xi">xi</code></td>
<td>
<p>Convergence pressure (0, Inf), suggested: (0, 1), default is 0.5.</p>
</td></tr>
<tr><td><code id="od.2m.111_+3A_plot.by">plot.by</code></td>
<td>
<p>Plot the variance by <code>n</code>, <code>J</code>, <code>K</code> and/or <code>p</code>;
default value is plot.by = list(n = &quot;n&quot;, J = &quot;J&quot;, K = 'K', p = &quot;p&quot;).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Unconstrained or constrained optimal sample allocation (<code>n</code> and <code>p</code>).
The function also returns statistical power,
function name, design type,
and parameters used in the calculation.
</p>

<hr>
<h2 id='od.3'>Optimal sample allocation calculation for three-level CRTs detecting main effects</h2><span id='topic+od.3'></span>

<h3>Description</h3>

<p>The optimal design of three-level
cluster randomized trials (CRTs) is to calculate
the optimal sample allocation that minimizes the variance of
treatment effect under fixed budget, which is approximately the optimal
sample allocation that maximizes statistical power under a fixed budget.
The optimal design parameters include
the level-1 sample size per level-2 unit (<code>n</code>),
the level-2 sample size per level-3 unit (<code>J</code>),
and the proportion of level-3 clusters/groups to be assigned to treatment (<code>p</code>).
This function solves the optimal <code>n</code>, <code>J</code> and/or <code>p</code>
with and without constraints.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>od.3(
  n = NULL,
  J = NULL,
  p = NULL,
  icc2 = NULL,
  icc3 = NULL,
  r12 = NULL,
  r22 = NULL,
  r32 = NULL,
  c1 = NULL,
  c2 = NULL,
  c3 = NULL,
  c1t = NULL,
  c2t = NULL,
  c3t = NULL,
  m = NULL,
  plots = TRUE,
  plot.by = NULL,
  nlim = NULL,
  Jlim = NULL,
  plim = NULL,
  varlim = NULL,
  nlab = NULL,
  Jlab = NULL,
  plab = NULL,
  varlab = NULL,
  vartitle = NULL,
  verbose = TRUE,
  iter = 100,
  tol = 1e-10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="od.3_+3A_n">n</code></td>
<td>
<p>The level-1 sample size per level-2 unit.</p>
</td></tr>
<tr><td><code id="od.3_+3A_j">J</code></td>
<td>
<p>The level-2 sample size per level-3 unit.</p>
</td></tr>
<tr><td><code id="od.3_+3A_p">p</code></td>
<td>
<p>The proportion of level-3 clusters/units assigned to treatment.</p>
</td></tr>
<tr><td><code id="od.3_+3A_icc2">icc2</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 2.</p>
</td></tr>
<tr><td><code id="od.3_+3A_icc3">icc3</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 3.</p>
</td></tr>
<tr><td><code id="od.3_+3A_r12">r12</code></td>
<td>
<p>The proportion of level-1 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="od.3_+3A_r22">r22</code></td>
<td>
<p>The proportion of level-2 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="od.3_+3A_r32">r32</code></td>
<td>
<p>The proportion of level-3 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="od.3_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling one level-1 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.3_+3A_c2">c2</code></td>
<td>
<p>The cost of sampling one level-2 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.3_+3A_c3">c3</code></td>
<td>
<p>The cost of sampling one level-3 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.3_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling one level-1 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.3_+3A_c2t">c2t</code></td>
<td>
<p>The cost of sampling one level-2 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.3_+3A_c3t">c3t</code></td>
<td>
<p>The cost of sampling one level-3 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.3_+3A_m">m</code></td>
<td>
<p>Total budget, default is the total costs of sampling 60
level-3 units across treatment conditions.</p>
</td></tr>
<tr><td><code id="od.3_+3A_plots">plots</code></td>
<td>
<p>Logical, provide variance plots if TRUE, otherwise not; default value is TRUE.</p>
</td></tr>
<tr><td><code id="od.3_+3A_plot.by">plot.by</code></td>
<td>
<p>Plot the variance by <code>n</code>, <code>J</code>
and/or <code>p</code>; default is plot.by = list(n = &quot;n&quot;, J = &quot;J&quot;, p = &quot;p&quot;).</p>
</td></tr>
<tr><td><code id="od.3_+3A_nlim">nlim</code></td>
<td>
<p>The plot range for n, default value is c(2, 50).</p>
</td></tr>
<tr><td><code id="od.3_+3A_jlim">Jlim</code></td>
<td>
<p>The plot range for J, default value is c(2, 50).</p>
</td></tr>
<tr><td><code id="od.3_+3A_plim">plim</code></td>
<td>
<p>The plot range for p, default value is c(0, 1).</p>
</td></tr>
<tr><td><code id="od.3_+3A_varlim">varlim</code></td>
<td>
<p>The plot range for variance, default value is c(0, 0.05).</p>
</td></tr>
<tr><td><code id="od.3_+3A_nlab">nlab</code></td>
<td>
<p>The plot label for <code>n</code>,
default value is &quot;Level-1 Sample Size: n&quot;.</p>
</td></tr>
<tr><td><code id="od.3_+3A_jlab">Jlab</code></td>
<td>
<p>The plot label for <code>J</code>,
default value is &quot;Level-2 Sample Size: J&quot;.</p>
</td></tr>
<tr><td><code id="od.3_+3A_plab">plab</code></td>
<td>
<p>The plot label for p, default is &quot;Proportion Level-3
Units in Treatment: p&quot;.</p>
</td></tr>
<tr><td><code id="od.3_+3A_varlab">varlab</code></td>
<td>
<p>The plot label for variance,
default value is &quot;Variance&quot;.</p>
</td></tr>
<tr><td><code id="od.3_+3A_vartitle">vartitle</code></td>
<td>
<p>The title of variance plot, default value is NULL.</p>
</td></tr>
<tr><td><code id="od.3_+3A_verbose">verbose</code></td>
<td>
<p>Logical; print the values of <code>n</code>, <code>J</code>, and <code>p</code> if TRUE,
otherwise not; default is TRUE.</p>
</td></tr>
<tr><td><code id="od.3_+3A_iter">iter</code></td>
<td>
<p>Number of iterations; default value is 100.</p>
</td></tr>
<tr><td><code id="od.3_+3A_tol">tol</code></td>
<td>
<p>Tolerance for convergence; default value is 1e-10.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Unconstrained or constrained optimal sample allocation
(<code>n</code>, <code>J</code>, and <code>p</code>).
The function also returns the variance of the treatment effect,
function name, design type,
and parameters used in the calculation.
</p>


<h3>References</h3>

<p>Shen, Z., &amp; Kelcey, B. (2020).
Optimal sample allocation under unequal costs in cluster-randomized trials.
Journal of Educational and Behavioral Statistics, 45(4): 446â€“474.
&lt;https://doi.org/10.3102/1076998620912418&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Unconstrained optimal design #---------
  myod1 &lt;- od.3(icc2 = 0.2, icc3 = 0.1, r12 = 0.5, r22 = 0.5, r32 = 0.5,
             c1 = 1, c2 = 5, c3 = 25, c1t = 1, c2t = 50, c3t = 250,
             varlim = c(0.005, 0.025))
  myod1$out # output
# Plots by p and J
  myod1 &lt;- od.3(icc2 = 0.2, icc3 = 0.1, r12 = 0.5, r22 = 0.5, r32 = 0.5,
             c1 = 1, c2 = 5, c3 = 25, c1t = 1, c2t = 50, c3t = 250,
             varlim = c(0.005, 0.025), plot.by = list(p = 'p', J = 'J'))

# Constrained optimal design with J = 20 #---------
  myod2 &lt;- od.3(icc2 = 0.2, icc3 = 0.1, r12 = 0.5, r22 = 0.5, r32 = 0.5, J = 20,
             c1 = 1, c2 = 5, c3 = 25, c1t = 1, c2t = 50, c3t = 250,
             varlim = c(0, 0.025))
  myod2$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod2)
  myre$re # RE = 0.53

# Constrained optimal design with p = 0.5 #---------
  myod3 &lt;- od.3(icc2 = 0.2, icc3 = 0.1, r12 = 0.5, r22 = 0.5, r32 = 0.5, p = 0.5,
             c1 = 1, c2 = 5, c3 = 25, c1t = 1, c2t = 50, c3t = 250,
             varlim = c(0.005, 0.025))
  myod3$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod3)
  myre$re # RE = 0.84

# Constrained n, J and p, no calculation performed #---------
  myod4 &lt;- od.3(icc2 = 0.2, icc3 = 0.1, r12 = 0.5, r22 = 0.5, r32 = 0.5, n = 10, J = 10, p = 0.5,
             c1 = 1, c2 = 5, c3 = 25, c1t = 1, c2t = 50, c3t = 250,
             varlim = c(0, 0.025))
  myod4$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod4)
  myre$re # RE = 0.61

</code></pre>

<hr>
<h2 id='od.3m'>Optimal sample allocation calculation for three-level MRTs detecting main effects</h2><span id='topic+od.3m'></span>

<h3>Description</h3>

<p>The optimal design of three-level
multisite randomized trials (MRTs) is to calculate
the optimal sample allocation that minimizes the variance of
treatment effect under fixed budget, which is approximately the optimal
sample allocation that maximizes statistical power under a fixed budget.
The optimal design parameters include
the level-1 sample size per level-2 unit (<code>n</code>),
the level-2 sample size per level-3 unit (<code>J</code>),
and the proportion of level-2 unit to be assigned to treatment (<code>p</code>).
This function solves the optimal <code>n</code>, <code>J</code> and/or <code>p</code>
with and without constraints.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>od.3m(
  n = NULL,
  J = NULL,
  p = NULL,
  icc2 = NULL,
  icc3 = NULL,
  r12 = NULL,
  r22 = NULL,
  r32m = NULL,
  c1 = NULL,
  c2 = NULL,
  c3 = NULL,
  c1t = NULL,
  c2t = NULL,
  omega = NULL,
  m = NULL,
  plots = TRUE,
  plot.by = NULL,
  nlim = NULL,
  Jlim = NULL,
  plim = NULL,
  varlim = NULL,
  nlab = NULL,
  Jlab = NULL,
  plab = NULL,
  varlab = NULL,
  vartitle = NULL,
  verbose = TRUE,
  iter = 100,
  tol = 1e-10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="od.3m_+3A_n">n</code></td>
<td>
<p>The level-1 sample size per level-2 unit.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_j">J</code></td>
<td>
<p>The level-2 sample size per level-3 unit.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_p">p</code></td>
<td>
<p>The proportion of level-4 clusters/units to be assigned to treatment.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_icc2">icc2</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 2.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_icc3">icc3</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 3.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_r12">r12</code></td>
<td>
<p>The proportion of level-1 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_r22">r22</code></td>
<td>
<p>The proportion of level-2 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_r32m">r32m</code></td>
<td>
<p>The proportion of variance of site-specific treatment effect explained by covariates.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling one level-1 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_c2">c2</code></td>
<td>
<p>The cost of sampling one level-2 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_c3">c3</code></td>
<td>
<p>The cost of sampling one level-3 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling one level-1 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_c2t">c2t</code></td>
<td>
<p>The cost of sampling one level-2 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_omega">omega</code></td>
<td>
<p>The standardized variance of site-specific treatment effect.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_m">m</code></td>
<td>
<p>Total budget, default is the total costs of sampling 60
level-3 units.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_plots">plots</code></td>
<td>
<p>Logical, provide variance plots if TRUE, otherwise not; default value is TRUE.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_plot.by">plot.by</code></td>
<td>
<p>Plot the variance by <code>n</code>, <code>J</code> and/or <code>p</code>;
default value is plot.by = list(n = &quot;n&quot;, J = &quot;J&quot;, p = &quot;p&quot;).</p>
</td></tr>
<tr><td><code id="od.3m_+3A_nlim">nlim</code></td>
<td>
<p>The plot range for n, default value is c(2, 50).</p>
</td></tr>
<tr><td><code id="od.3m_+3A_jlim">Jlim</code></td>
<td>
<p>The plot range for J, default value is c(2, 50).</p>
</td></tr>
<tr><td><code id="od.3m_+3A_plim">plim</code></td>
<td>
<p>The plot range for p, default value is c(0, 1).</p>
</td></tr>
<tr><td><code id="od.3m_+3A_varlim">varlim</code></td>
<td>
<p>The plot range for variance, default value is c(0, 0.05).</p>
</td></tr>
<tr><td><code id="od.3m_+3A_nlab">nlab</code></td>
<td>
<p>The plot label for <code>n</code>,
default value is &quot;Level-1 Sample Size: n&quot;.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_jlab">Jlab</code></td>
<td>
<p>The plot label for <code>J</code>,
default value is &quot;Level-2 Sample Size: J&quot;.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_plab">plab</code></td>
<td>
<p>The plot label for <code>p</code>,
default value is &quot;Proportion Level-2 Units in Treatment: p&quot;.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_varlab">varlab</code></td>
<td>
<p>The plot label for variance,
default value is &quot;Variance&quot;.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_vartitle">vartitle</code></td>
<td>
<p>The title of variance plot, default value is NULL.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_verbose">verbose</code></td>
<td>
<p>Logical; print the values of <code>n</code>, <code>J</code>,
and <code>p</code> if TRUE, otherwise not; default value is TRUE.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_iter">iter</code></td>
<td>
<p>Number of iterations; default value is 100.</p>
</td></tr>
<tr><td><code id="od.3m_+3A_tol">tol</code></td>
<td>
<p>Tolerance for convergence; default value is 1e-10.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Unconstrained or constrained optimal sample allocation
(<code>n</code>, <code>J</code>, and <code>p</code>).
The function also returns the variance of the treatment effect,
function name, design type,
and parameters used in the calculation.
</p>


<h3>References</h3>

<p>Shen, Z., &amp; Kelcey, B. (2022). Optimal sampling ratios in three-level
multisite experiments. Journal of Research on Educational Effectiveness.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Unconstrained optimal design #---------
  myod1 &lt;- od.3m(icc2 = 0.2, icc3 = 0.1, omega = 0.02,
              r12 = 0.5, r22 = 0.5, r32m = 0.5,
              c1 = 1, c2 = 5,
              c1t = 1, c2t = 200, c3 = 200,
              varlim = c(0, 0.005))
  myod1$out # output
# Plots by p and J
  myod1 &lt;- od.3m(icc2 = 0.2, icc3 = 0.1, omega = 0.02,
              r12 = 0.5, r22 = 0.5, r32m = 0.5,
              c1 = 1, c2 = 5,
              c1t = 1, c2t = 200, c3 = 200,
              varlim = c(0, 0.005), plot.by = list(p = 'p', J = 'J'))

# Constrained optimal design with p = 0.5 #---------
  myod2 &lt;- od.3m(icc2 = 0.2, icc3 = 0.1, omega = 0.02,
              r12 = 0.5, r22 = 0.5, r32m = 0.5,
              c1 = 1, c2 = 5,
              c1t = 1, c2t = 200, c3 = 200,
              varlim = c(0, 0.005), p = 0.5)
  myod2$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod2)
  myre$re # RE = 0.81

# Constrained optimal design with n = 5 #---------
  myod3 &lt;- od.3m(icc2 = 0.2, icc3 = 0.1, omega = 0.02,
              r12 = 0.5, r22 = 0.5, r32m = 0.5,
              c1 = 1, c2 = 5,
              c1t = 1, c2t = 200, c3 = 200,
              varlim = c(0, 0.005), n = 5)
  myod3$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod3)
  myre$re # RE = 0.89

# Constrained n, J and p, no calculation performed #---------
  myod4 &lt;- od.3m(icc2 = 0.2, icc3 = 0.1, omega = 0.02,
              r12 = 0.5, r22 = 0.5, r32m = 0.5,
              c1 = 1, c2 = 5,
              c1t = 1, c2t = 200, c3 = 200,
              varlim = c(0, 0.005), p = 0.5, n = 15, J = 20)
  myod4$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod4)
  myre$re # RE = 0.75

</code></pre>

<hr>
<h2 id='od.4'>Optimal sample allocation calculation for four-level CRTs detecting main effects</h2><span id='topic+od.4'></span>

<h3>Description</h3>

<p>The optimal design of four-level
cluster randomized trials (CRTs) is to calculate
the optimal sample allocation that minimizes the variance of
treatment effect under fixed budget, which is approximately the optimal
sample allocation that maximizes statistical power under a fixed budget.
The optimal design parameters include
the level-1 sample size per level-2 unit (<code>n</code>),
the level-2 sample size per level-3 unit (<code>J</code>),
the level-3 sample size per level-4 unit (<code>K</code>),
and the proportion of level-4 clusters/groups to be assigned to treatment (<code>p</code>).
This function solves the optimal <code>n</code>, <code>J</code>, <code>K</code> and/or <code>p</code>
with and without constraints.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>od.4(
  n = NULL,
  J = NULL,
  K = NULL,
  p = NULL,
  icc2 = NULL,
  icc3 = NULL,
  icc4 = NULL,
  r12 = NULL,
  r22 = NULL,
  r32 = NULL,
  r42 = NULL,
  c1 = NULL,
  c2 = NULL,
  c3 = NULL,
  c4 = NULL,
  c1t = NULL,
  c2t = NULL,
  c3t = NULL,
  c4t = NULL,
  m = NULL,
  plots = TRUE,
  plot.by = NULL,
  nlim = NULL,
  Jlim = NULL,
  Klim = NULL,
  plim = NULL,
  varlim = NULL,
  nlab = NULL,
  Jlab = NULL,
  Klab = NULL,
  plab = NULL,
  varlab = NULL,
  vartitle = NULL,
  verbose = TRUE,
  iter = 100,
  tol = 1e-10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="od.4_+3A_n">n</code></td>
<td>
<p>The level-1 sample size per level-2 unit.</p>
</td></tr>
<tr><td><code id="od.4_+3A_j">J</code></td>
<td>
<p>The level-2 sample size per level-3 unit.</p>
</td></tr>
<tr><td><code id="od.4_+3A_k">K</code></td>
<td>
<p>The level-3 sample size per level-4 unit.</p>
</td></tr>
<tr><td><code id="od.4_+3A_p">p</code></td>
<td>
<p>The proportion of level-4 clusters/units to be assigned to treatment.</p>
</td></tr>
<tr><td><code id="od.4_+3A_icc2">icc2</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 2.</p>
</td></tr>
<tr><td><code id="od.4_+3A_icc3">icc3</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 3.</p>
</td></tr>
<tr><td><code id="od.4_+3A_icc4">icc4</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 4.</p>
</td></tr>
<tr><td><code id="od.4_+3A_r12">r12</code></td>
<td>
<p>The proportion of level-1 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="od.4_+3A_r22">r22</code></td>
<td>
<p>The proportion of level-2 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="od.4_+3A_r32">r32</code></td>
<td>
<p>The proportion of level-3 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="od.4_+3A_r42">r42</code></td>
<td>
<p>The proportion of level-4 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="od.4_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling one level-1 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.4_+3A_c2">c2</code></td>
<td>
<p>The cost of sampling one level-2 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.4_+3A_c3">c3</code></td>
<td>
<p>The cost of sampling one level-3 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.4_+3A_c4">c4</code></td>
<td>
<p>The cost of sampling one level-4 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.4_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling one level-1 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.4_+3A_c2t">c2t</code></td>
<td>
<p>The cost of sampling one level-2 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.4_+3A_c3t">c3t</code></td>
<td>
<p>The cost of sampling one level-3 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.4_+3A_c4t">c4t</code></td>
<td>
<p>The cost of sampling one level-4 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.4_+3A_m">m</code></td>
<td>
<p>Total budget, default value is the total costs of sampling 60
level-4 units across treatment conditions.</p>
</td></tr>
<tr><td><code id="od.4_+3A_plots">plots</code></td>
<td>
<p>Logical, provide variance plots if TRUE, otherwise not; default value is TRUE.</p>
</td></tr>
<tr><td><code id="od.4_+3A_plot.by">plot.by</code></td>
<td>
<p>Plot the variance by <code>n</code>, <code>J</code>, <code>K</code> and/or <code>p</code>;
default value is plot.by = list(n = &quot;n&quot;, J = &quot;J&quot;, K = 'K', p = &quot;p&quot;).</p>
</td></tr>
<tr><td><code id="od.4_+3A_nlim">nlim</code></td>
<td>
<p>The plot range for n, default value is c(2, 50).</p>
</td></tr>
<tr><td><code id="od.4_+3A_jlim">Jlim</code></td>
<td>
<p>The plot range for J, default value is c(2, 50).</p>
</td></tr>
<tr><td><code id="od.4_+3A_klim">Klim</code></td>
<td>
<p>The plot range for K, default value is c(2, 50).</p>
</td></tr>
<tr><td><code id="od.4_+3A_plim">plim</code></td>
<td>
<p>The plot range for p, default value is c(0, 1).</p>
</td></tr>
<tr><td><code id="od.4_+3A_varlim">varlim</code></td>
<td>
<p>The plot range for variance, default value is c(0, 0.05).</p>
</td></tr>
<tr><td><code id="od.4_+3A_nlab">nlab</code></td>
<td>
<p>The plot label for <code>n</code>,
default value is &quot;Level-1 Sample Size: n&quot;.</p>
</td></tr>
<tr><td><code id="od.4_+3A_jlab">Jlab</code></td>
<td>
<p>The plot label for <code>J</code>,
default value is &quot;Level-2 Sample Size: J&quot;.</p>
</td></tr>
<tr><td><code id="od.4_+3A_klab">Klab</code></td>
<td>
<p>The plot label for <code>K</code>,
default value is &quot;Level-3 Sample Size: K&quot;.</p>
</td></tr>
<tr><td><code id="od.4_+3A_plab">plab</code></td>
<td>
<p>The plot label for <code>p</code>,
default value is &quot;Proportion Level-4 Units in Treatment: p&quot;.</p>
</td></tr>
<tr><td><code id="od.4_+3A_varlab">varlab</code></td>
<td>
<p>The plot label for variance,
default value is &quot;Variance&quot;.</p>
</td></tr>
<tr><td><code id="od.4_+3A_vartitle">vartitle</code></td>
<td>
<p>The title of variance plot, default value is NULL.</p>
</td></tr>
<tr><td><code id="od.4_+3A_verbose">verbose</code></td>
<td>
<p>Logical; print the values of <code>n</code>, <code>J</code>,
<code>K</code>, and <code>p</code> if TRUE,
otherwise not; default value is TRUE.</p>
</td></tr>
<tr><td><code id="od.4_+3A_iter">iter</code></td>
<td>
<p>Number of iterations; default value is 100.</p>
</td></tr>
<tr><td><code id="od.4_+3A_tol">tol</code></td>
<td>
<p>Tolerance for convergence; default value is 1e-10.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Unconstrained or constrained optimal sample allocation
(<code>n</code>, <code>J</code>, <code>K</code>, and <code>p</code>).
The function also returns the variance of the treatment effect,
function name, design type,
and parameters used in the calculation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Unconstrained optimal design #---------
  myod1 &lt;- od.4(icc2 = 0.2, icc3 = 0.1, icc4 = 0.05,
              r12 = 0.5, r22 = 0.5, r32 = 0.5, r42 = 0.5,
              c1 = 1, c2 = 5, c3 = 25, c4 = 125,
              c1t = 1, c2t = 50, c3t = 250, c4t = 2500,
              varlim = c(0, 0.01))
  myod1$out # output
# Plots by p and K
  myod1 &lt;- od.4(icc2 = 0.2, icc3 = 0.1, icc4 = 0.05,
              r12 = 0.5, r22 = 0.5, r32 = 0.5, r42 = 0.5,
              c1 = 1, c2 = 5, c3 = 25, c4 = 125,
              c1t = 1, c2t = 50, c3t = 250, c4t = 2500,
              varlim = c(0, 0.01), plot.by = list(p = 'p', K = 'K'))

# Constrained optimal design with p = 0.5 #---------
  myod2 &lt;- od.4(icc2 = 0.2, icc3 = 0.1, icc4 = 0.05, p = 0.5,
              r12 = 0.5, r22 = 0.5, r32 = 0.5, r42 = 0.5,
              c1 = 1, c2 = 5, c3 = 25, c4 = 125,
              c1t = 1, c2t = 50, c3t = 250, c4t = 2500,
              varlim = c(0, 0.01))
  myod2$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod2)
  myre$re # RE = 0.78

# Constrained optimal design with K = 20 #---------
  myod3 &lt;- od.4(icc2 = 0.2, icc3 = 0.1, icc4 = 0.05,  K = 20,
              r12 = 0.5, r22 = 0.5, r32 = 0.5, r42 = 0.5,
              c1 = 1, c2 = 5, c3 = 25, c4 = 125,
              c1t = 1, c2t = 50, c3t = 250, c4t = 2500,
              varlim = c(0, 0.01))
  myod3$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod3)
  myre$re # RE = 0.67

# Constrained n, J, K and p, no calculation performed #---------
  myod4 &lt;- od.4(icc2 = 0.2, icc3 = 0.1, icc4 = 0.05,
              r12 = 0.5, n = 10, J = 10, K = 20, p = 0.5,
              r22 = 0.5, r32 = 0.5, r42 = 0.5,
              c1 = 1, c2 = 5, c3 = 25, c4 = 125,
              c1t = 1, c2t = 50, c3t = 250, c4t = 2500,
              varlim = c(0, 0.01))
  myod4$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod4)
  myre$re # RE = 0.27

</code></pre>

<hr>
<h2 id='od.4m'>Optimal sample allocation calculation for four-level MRTs detecting main effects</h2><span id='topic+od.4m'></span>

<h3>Description</h3>

<p>The optimal design of four-level
multisite randomized trials (MRTs) is to calculate
the optimal sample allocation that minimizes the variance of
treatment effect under fixed budget, which is approximately the optimal
sample allocation that maximizes statistical power under a fixed budget.
The optimal design parameters include
the level-1 sample size per level-2 unit (<code>n</code>),
the level-2 sample size per level-3 unit (<code>J</code>),
the level-3 sample size per level-4 unit (<code>K</code>),
and the proportion of level-3 units to be assigned to treatment (<code>p</code>).
This function solves the optimal <code>n</code>, <code>J</code>, <code>K</code> and/or <code>p</code>
with and without constraints.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>od.4m(
  n = NULL,
  J = NULL,
  K = NULL,
  p = NULL,
  icc2 = NULL,
  icc3 = NULL,
  icc4 = NULL,
  r12 = NULL,
  r22 = NULL,
  r32 = NULL,
  r42m = NULL,
  c1 = NULL,
  c2 = NULL,
  c3 = NULL,
  c4 = NULL,
  c1t = NULL,
  c2t = NULL,
  c3t = NULL,
  omega = NULL,
  m = NULL,
  plots = TRUE,
  plot.by = NULL,
  nlim = NULL,
  Jlim = NULL,
  Klim = NULL,
  plim = NULL,
  varlim = NULL,
  nlab = NULL,
  Jlab = NULL,
  Klab = NULL,
  plab = NULL,
  varlab = NULL,
  vartitle = NULL,
  verbose = TRUE,
  iter = 100,
  tol = 1e-10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="od.4m_+3A_n">n</code></td>
<td>
<p>The level-1 sample size per level-2 unit.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_j">J</code></td>
<td>
<p>The level-2 sample size per level-3 unit.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_k">K</code></td>
<td>
<p>The level-3 sample size per level-4 unit.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_p">p</code></td>
<td>
<p>The proportion of level-3 units to be assigned to treatment.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_icc2">icc2</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 2.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_icc3">icc3</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 3.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_icc4">icc4</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 4.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_r12">r12</code></td>
<td>
<p>The proportion of level-1 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_r22">r22</code></td>
<td>
<p>The proportion of level-2 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_r32">r32</code></td>
<td>
<p>The proportion of level-3 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_r42m">r42m</code></td>
<td>
<p>The proportion of variance of site-specific treatment effect explained by covariates.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling one level-1 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_c2">c2</code></td>
<td>
<p>The cost of sampling one level-2 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_c3">c3</code></td>
<td>
<p>The cost of sampling one level-3 unit in control condition.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_c4">c4</code></td>
<td>
<p>The cost of sampling one level-4 unit.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling one level-1 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_c2t">c2t</code></td>
<td>
<p>The cost of sampling one level-2 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_c3t">c3t</code></td>
<td>
<p>The cost of sampling one level-3 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_omega">omega</code></td>
<td>
<p>The standardized variance of site-specific treatment effect.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_m">m</code></td>
<td>
<p>Total budget, default is the total costs of sampling 60
level-4 units.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_plots">plots</code></td>
<td>
<p>Logical, provide variance plots if TRUE, otherwise not; default value is TRUE.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_plot.by">plot.by</code></td>
<td>
<p>Plot the variance by <code>n</code>, <code>J</code>, <code>K</code> and/or <code>p</code>;
default value is plot.by = list(n = &quot;n&quot;, J = &quot;J&quot;, K = 'K', p = &quot;p&quot;).</p>
</td></tr>
<tr><td><code id="od.4m_+3A_nlim">nlim</code></td>
<td>
<p>The plot range for n, default value is c(2, 50).</p>
</td></tr>
<tr><td><code id="od.4m_+3A_jlim">Jlim</code></td>
<td>
<p>The plot range for J, default value is c(2, 50).</p>
</td></tr>
<tr><td><code id="od.4m_+3A_klim">Klim</code></td>
<td>
<p>The plot range for K, default value is c(2, 50).</p>
</td></tr>
<tr><td><code id="od.4m_+3A_plim">plim</code></td>
<td>
<p>The plot range for p, default value is c(0, 1).</p>
</td></tr>
<tr><td><code id="od.4m_+3A_varlim">varlim</code></td>
<td>
<p>The plot range for variance, default value is c(0, 0.05).</p>
</td></tr>
<tr><td><code id="od.4m_+3A_nlab">nlab</code></td>
<td>
<p>The plot label for <code>n</code>,
default value is &quot;Level-1 Sample Size: n&quot;.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_jlab">Jlab</code></td>
<td>
<p>The plot label for <code>J</code>,
default value is &quot;Level-2 Sample Size: J&quot;.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_klab">Klab</code></td>
<td>
<p>The plot label for <code>K</code>,
default value is &quot;Level-3 Sample Size: K&quot;.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_plab">plab</code></td>
<td>
<p>The plot label for <code>p</code>,
default value is &quot;Proportion Level-3 Units in Treatment: p&quot;.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_varlab">varlab</code></td>
<td>
<p>The plot label for variance,
default value is &quot;Variance&quot;.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_vartitle">vartitle</code></td>
<td>
<p>The title of variance plot, default value is NULL.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_verbose">verbose</code></td>
<td>
<p>Logical; print the values of <code>n</code>, <code>J</code>,
<code>K</code>, and <code>p</code> if TRUE,
otherwise not; default value is TRUE.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_iter">iter</code></td>
<td>
<p>Number of iterations; default value is 100.</p>
</td></tr>
<tr><td><code id="od.4m_+3A_tol">tol</code></td>
<td>
<p>Tolerance for convergence; default value is 1e-10.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Unconstrained or constrained optimal sample allocation
(<code>n</code>, <code>J</code>, <code>K</code>, and <code>p</code>).
The function also returns the variance of the treatment effect,
function name, design type,
and parameters used in the calculation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Unconstrained optimal design #---------
  myod1 &lt;- od.4m(icc2 = 0.2, icc3 = 0.1, icc4 = 0.05, omega = 0.02,
              r12 = 0.5, r22 = 0.5, r32 = 0.5, r42m = 0.5,
              c1 = 1, c2 = 5, c3 = 25,
              c1t = 1, c2t = 50, c3t = 250, c4 = 500,
              varlim = c(0, 0.005))
  myod1$out # output
# Plots by p and K
  myod1 &lt;- od.4m(icc2 = 0.2, icc3 = 0.1, icc4 = 0.05, omega = 0.02,
              r12 = 0.5, r22 = 0.5, r32 = 0.5, r42m = 0.5,
              c1 = 1, c2 = 5, c3 = 25,
              c1t = 1, c2t = 50, c3t = 250, c4 = 500,
              varlim = c(0, 0.005), plot.by = list(p = 'p', K = 'K'))

# Constrained optimal design with p = 0.5 #---------
  myod2 &lt;- od.4m(icc2 = 0.2, icc3 = 0.1, icc4 = 0.05, omega = 0.02,
              r12 = 0.5, r22 = 0.5, r32 = 0.5, r42m = 0.5,
              c1 = 1, c2 = 5, c3 = 25,
              c1t = 1, c2t = 50, c3t = 250, c4 = 500,
              varlim = c(0, 0.005), p = 0.5)
  myod2$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod2)
  myre$re # RE = 0.88

# Constrained optimal design with J = 20 #---------
  myod3 &lt;- od.4m(icc2 = 0.2, icc3 = 0.1, icc4 = 0.05, omega = 0.02,
              r12 = 0.5, r22 = 0.5, r32 = 0.5, r42m = 0.5,
              c1 = 1, c2 = 5, c3 = 25,
              c1t = 1, c2t = 50, c3t = 250, c4 = 500,
              varlim = c(0, 0.005), J = 20)
  myod3$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod3)
  myre$re # RE = 0.58

# Constrained n, J, K and p, no calculation performed #---------
  myod4 &lt;- od.4m(icc2 = 0.2, icc3 = 0.1, icc4 = 0.05, omega = 0.02,
              r12 = 0.5, r22 = 0.5, r32 = 0.5, r42m = 0.5,
              c1 = 1, c2 = 5, c3 = 25,
              c1t = 1, c2t = 50, c3t = 250, c4 = 500,
              varlim = c(0, 0.005), p = 0.5, n = 15, J = 20, K = 5)
  myod4$out
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod4)
  myre$re # RE = 0.46

</code></pre>

<hr>
<h2 id='power.1'>Budget and/or sample size, power, MDES calculation for
single-level experiments detecting main effects</h2><span id='topic+power.1'></span>

<h3>Description</h3>

<p>This function can calculate required budget for desired power,
power or minimum detectable effect size (MDES) under fixed budget
for  single-level experiments.
It also can perform conventional power analyses
(e.g., required sample size, power, and MDES calculation).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.1(
  cost.model = TRUE,
  expr = NULL,
  constraint = NULL,
  sig.level = 0.05,
  two.tailed = TRUE,
  d = NULL,
  power = NULL,
  m = NULL,
  n = NULL,
  p = NULL,
  r12 = NULL,
  q = NULL,
  c1 = NULL,
  c1t = NULL,
  dlim = NULL,
  powerlim = NULL,
  nlim = NULL,
  mlim = NULL,
  rounded = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.1_+3A_cost.model">cost.model</code></td>
<td>
<p>Logical; power analyses accommodating costs and budget
(e.g., required budget for desired power, power/MDES under fixed budget)
if TRUE, otherwise conventional power analyses
(e.g., required sample size, power, or MDES calculation); default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.1_+3A_expr">expr</code></td>
<td>
<p>Returned object from function <code><a href="#topic+od.1">od.1</a></code>; default value is NULL;
if <code>expr</code> is specified, parameter values of <code>r12</code>,
<code>c1</code>, <code>c1t</code>, and <code>p</code>
used or solved in function <code><a href="#topic+od.1">od.1</a></code> will
be passed to the current function;
only the value of <code>p</code> that specified or solved in
function <code><a href="#topic+od.1">od.1</a></code> can be overwritten
if <code>constraint</code> is specified.</p>
</td></tr>
<tr><td><code id="power.1_+3A_constraint">constraint</code></td>
<td>
<p>Specify the constrained value of
<code>p</code> in list format to overwrite that
from <code>expr</code>; default value is NULL.</p>
</td></tr>
<tr><td><code id="power.1_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level or type I error rate, default value is 0.05.</p>
</td></tr>
<tr><td><code id="power.1_+3A_two.tailed">two.tailed</code></td>
<td>
<p>Logical; two-tailed tests if TRUE,
otherwise one-tailed tests; default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.1_+3A_d">d</code></td>
<td>
<p>Effect size.</p>
</td></tr>
<tr><td><code id="power.1_+3A_power">power</code></td>
<td>
<p>Statistical power.</p>
</td></tr>
<tr><td><code id="power.1_+3A_m">m</code></td>
<td>
<p>Total budget.</p>
</td></tr>
<tr><td><code id="power.1_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="power.1_+3A_p">p</code></td>
<td>
<p>The proportion of individuals to be assigned to treatment.</p>
</td></tr>
<tr><td><code id="power.1_+3A_r12">r12</code></td>
<td>
<p>The proportion of outcome variance explained by covariates.</p>
</td></tr>
<tr><td><code id="power.1_+3A_q">q</code></td>
<td>
<p>The number of covariates.</p>
</td></tr>
<tr><td><code id="power.1_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling one unit in control condition.</p>
</td></tr>
<tr><td><code id="power.1_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling one unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.1_+3A_dlim">dlim</code></td>
<td>
<p>The range for solving the root of effect size (<code>d</code>) numerically,
default value is c(0, 5).</p>
</td></tr>
<tr><td><code id="power.1_+3A_powerlim">powerlim</code></td>
<td>
<p>The range for solving the root of power (<code>power</code>) numerically,
default value is c(1e-10, 1 - 1e-10).</p>
</td></tr>
<tr><td><code id="power.1_+3A_nlim">nlim</code></td>
<td>
<p>The range for searching the root of sample size (<code>n</code>) numerically,
default value is c(4, 10e10).</p>
</td></tr>
<tr><td><code id="power.1_+3A_mlim">mlim</code></td>
<td>
<p>The range for searching the root of budget (<code>m</code>) numerically,
default value is the costs sampling <code>nlim</code> units across treatment conditions
or c(4 * ncost, 10e10 * ncost) with ncost = ((1 - p) * c1 + p * c1t).</p>
</td></tr>
<tr><td><code id="power.1_+3A_rounded">rounded</code></td>
<td>
<p>Logical; round <code>p</code> that is from functions <code>od.1</code>
to two decimal places if TRUE,
otherwise no rounding; default value is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Required budget (or required sample size), statistical power, or MDES
depending on the specification of parameters.
The function also returns the function name, design type,
and parameters used in the calculation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Unconstrained optimal design
  myod1 &lt;- od.1(r12 = 0.5, c1 = 1, c1t = 5, varlim = c(0, 0.2))
  myod1$out   # p = 0.31

# ------- Power analyses by default considering costs and budget -------
# Required budget and sample size
  mym.1 &lt;- power.1(expr = myod1, d = 0.2, q = 1, power = 0.8)
  mym.1$out  # m = 1032 n = 461
  # mym.1$par  # parameters and their values used for the function
# Or, equivalently, specify every argument in the function
  mym.1 &lt;- power.1(d = 0.2, power = 0.8, c1 = 1, c1t = 5,
                  r12 = 0.5, p = 0.31, q = 1)
# Required budget and sample size with constrained p
  mym.2 &lt;- power.1(expr = myod1, d = 0.2, q = 1, power = 0.8,
               constraint = list(p = 0.5))
  mym.2$out  # m = 1183, n = 394

# Power calculation
  mypower &lt;- power.1(expr = myod1, q = 1, d = 0.2, m = 1032)
  mypower$out  # power = 0.80
# Power calculation under constrained p (p = 0.5)
  mypower.1 &lt;- power.1(expr = myod1, q = 1, d = 0.2, m = 1032,
               constraint = list(p = 0.5))
  mypower.1$out  # power = 0.74

# MDES calculation
  mymdes &lt;- power.1(expr = myod1, q = 1, power = 0.80, m = 1032)
  mymdes$out  # d = 0.20


# ------- Conventional power analyses with cost.model = FALSE-------
# Required sample size n
  myn &lt;- power.1(cost.model = FALSE, expr = myod1, d = 0.2, q = 1, power = 0.8)
  myn$out  # n = 461
  # myn$par  # parameters and their values used for the function
# Or, equivalently, specify every argument in the function
  myn &lt;- power.1(cost.model = FALSE, d = 0.2, power = 0.8,
                  r12 = 0.5, p = 0.31, q = 1)

# Power calculation
  mypower1 &lt;- power.1(cost.model = FALSE, expr = myod1, n = 461, d = 0.2, q = 1)
  mypower1$out  # power = 0.80

# MDES calculation
  mymdes1 &lt;- power.1(cost.model = FALSE, expr = myod1, n = 461, power = 0.8, q = 1)
  mymdes1$out  # d = 0.20

</code></pre>

<hr>
<h2 id='power.1.111'>Budget and/or sample size, power, MDES calculation for MRTs investigating
mediation effects with individual-level mediators</h2><span id='topic+power.1.111'></span>

<h3>Description</h3>

<p>This function can calculate required budget for desired power and
power under a fixed budget
for multisite-randomized trials (MRTs) with individual mediators
probing mediation effects.
It also can perform conventional power analyses
(e.g., required sample size and power calculation).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.1.111(
  cost.model = TRUE,
  expr = NULL,
  constraint = NULL,
  sig.level = 0.05,
  two.tailed = TRUE,
  a = NULL,
  b = NULL,
  power = NULL,
  m = NULL,
  test = NULL,
  n = NULL,
  p = NULL,
  c1 = NULL,
  c1t = NULL,
  r.yx = 0,
  r.mx = 0,
  r.mw = 0,
  q.a = 0,
  q.b = 0,
  max.iter = 300,
  alim = c(0, 4),
  blim = c(0.01, 0.99),
  powerlim = NULL,
  nlim = c(6, 1e+07),
  mlim = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.1.111_+3A_cost.model">cost.model</code></td>
<td>
<p>Logical; power analyses accommodating costs and budget
(e.g., required budget for a desired power, power under fixed budget)
if TRUE. Otherwise, conventional power analyses are performed
(e.g., required sample size and power calculation); default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_expr">expr</code></td>
<td>
<p>Returned object from function <code><a href="#topic+od.1.111">od.1.111</a></code>; default value is NULL;
if <code>expr</code> is specified, parameter values of <code>a</code>, <code>b</code>,
<code>c</code>, <code>ct</code>, and <code>p</code>
used or solved in function <code><a href="#topic+od.1.111">od.1.111</a></code> will
be passed to the current function;
only the values of <code>p</code> that specified or solved in
function <code><a href="#topic+od.1.111">od.1.111</a></code> can be overwritten
if <code>constraint</code> is specified.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_constraint">constraint</code></td>
<td>
<p>If specified, the constrained value of
<code>p</code> in a list format (e.g., constraint = list(p = 0.5))
will overwrite that
from <code>expr</code>; default value is NULL.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level or type I error rate, default value is 0.05.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_two.tailed">two.tailed</code></td>
<td>
<p>Two tailed test, the default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_a">a</code></td>
<td>
<p>The treatment effect on the mediator.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_b">b</code></td>
<td>
<p>The within-treatment correlation between the outcome and
the mediator.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_power">power</code></td>
<td>
<p>Statistical power specified, default is .80.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_m">m</code></td>
<td>
<p>Total budget.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_test">test</code></td>
<td>
<p>The type of test will be used to detect mediation effects.
The default is the NULL or the one used in the expr
Choices are the joint significance test (i.e., test = &quot;joint&quot;,
&quot;Joint&quot;,&quot;JOINT&quot;) or the Sobel test (test = &quot;sobel&quot;, &quot;Sobel&quot;, or &quot;SOBEL&quot;).</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_n">n</code></td>
<td>
<p>Total number of individuals in the experimental study, the default
value is NULL.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_p">p</code></td>
<td>
<p>The proportion of level-4 clusters/units to be assigned to treatment.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling an individual in the control group.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling an individual in the treated group.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_r.yx">r.yx</code></td>
<td>
<p>The within-treatment correlation between the outcome and the
covariate(s) in the outcome model.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_r.mx">r.mx</code></td>
<td>
<p>The within-treatment correlation between the mediator and the
covariate(s) in the outcome model.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_r.mw">r.mw</code></td>
<td>
<p>The within-treatment correlation between the mediator and the
covariate(s) in the mediator model.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_q.a">q.a</code></td>
<td>
<p>The number of covariates at the mediator model
(except the treatment indicator), the default value is zero.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_q.b">q.b</code></td>
<td>
<p>The number of covariates in the outcome model (except the treatment
indicator and the mediator), the default value is zero.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_max.iter">max.iter</code></td>
<td>
<p>Maximal number of function evaluations when used as
the stopping criterion. Default is 200.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_alim">alim</code></td>
<td>
<p>The range for identifying the root of a path
effect (<code>a</code>) numerically. Default value is c(0, 4).</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_blim">blim</code></td>
<td>
<p>The range for identifying the root of b path within-treatment
correlation between the mediator and outcome (<code>b</code>) numerically.
Default value is (.01, .99), if (<code>b</code>) is negative, please re-code
the outcome or mediator to make it positive.</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_powerlim">powerlim</code></td>
<td>
<p>The range for solving the root of power (<code>power</code>) numerically,
default value is c(1e-10, 1 - 1e-10).</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_nlim">nlim</code></td>
<td>
<p>The interval/range used to numerically solve for n,
the default values are c(6, 1e7).</p>
</td></tr>
<tr><td><code id="power.1.111_+3A_mlim">mlim</code></td>
<td>
<p>The range for identifying the root of budget (<code>m</code>) numerically,
default value is the costs sampling <code>nlim</code> units.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Required budget (or required sample size), statistical power,
(<code>a</code>) , or (<code>b</code>)  depending on the specification of parameters.
The function also returns the function name, design type,
and parameters used in the calculation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Optimal design and power analyses accommodating costs and budget
myod &lt;- od.1.111(a = .3, b = .5, c1 = 10, c1t = 100)
# myod
mypower &lt;- power.1.111(expr = myod, power = .8)
#mypower

# Conventional power analyses
mypower &lt;- power.1.111(cost.model = FALSE, a = .3, b = .5, test = "joint",
                       power = .8, p =.5)
#mypower
mypower &lt;- power.1.111(cost.model = FALSE, n = 350, b = .5, test = "joint",
                       power = .8, p =.5)
#mypower

</code></pre>

<hr>
<h2 id='power.2'>Budget and/or sample size, power, MDES calculation for
two-level CRTs detecting main effects</h2><span id='topic+power.2'></span>

<h3>Description</h3>

<p>This function can calculate required budget for desired power,
power or minimum detectable effect size (MDES) under fixed budget
for two-level cluster randomized trials (CRTs).
It also can perform conventional power analyses
(e.g., required sample size, power, and MDES calculation).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.2(
  cost.model = TRUE,
  expr = NULL,
  constraint = NULL,
  sig.level = 0.05,
  two.tailed = TRUE,
  d = NULL,
  power = NULL,
  m = NULL,
  n = NULL,
  J = NULL,
  p = NULL,
  icc = NULL,
  r12 = NULL,
  r22 = NULL,
  q = NULL,
  c1 = NULL,
  c2 = NULL,
  c1t = NULL,
  c2t = NULL,
  dlim = NULL,
  powerlim = NULL,
  Jlim = NULL,
  mlim = NULL,
  rounded = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.2_+3A_cost.model">cost.model</code></td>
<td>
<p>Logical; power analyses accommodating costs and budget
(e.g., required budget for desired power, power/MDES under fixed budget)
if TRUE, otherwise conventional power analyses
(e.g., required sample size, power, or MDES calculation); default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.2_+3A_expr">expr</code></td>
<td>
<p>Returned object from function <code><a href="#topic+od.2">od.2</a></code>; default is NULL;
if <code>expr</code> is specified, parameter values of <code>icc</code>,
<code>r12</code>, <code>r22</code>,
<code>c1</code>, <code>c2</code>, <code>c1t</code>, <code>c2t</code>, <code>n</code>, and <code>p</code>
used or solved in function <code><a href="#topic+od.2">od.2</a></code> will
be passed to the current function;
only the values of <code>n</code> and <code>p</code> that specified or solved in
function <code><a href="#topic+od.2">od.2</a></code> can be overwritten
if <code>constraint</code> is specified.</p>
</td></tr>
<tr><td><code id="power.2_+3A_constraint">constraint</code></td>
<td>
<p>Specify the constrained values of <code>n</code>
and/or <code>p</code> in list format to overwrite those
from <code>expr</code>; default is NULL.</p>
</td></tr>
<tr><td><code id="power.2_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level or type I error rate, default value is 0.05.</p>
</td></tr>
<tr><td><code id="power.2_+3A_two.tailed">two.tailed</code></td>
<td>
<p>Logical; two-tailed tests if TRUE,
otherwise one-tailed tests; default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.2_+3A_d">d</code></td>
<td>
<p>Effect size.</p>
</td></tr>
<tr><td><code id="power.2_+3A_power">power</code></td>
<td>
<p>Statistical power.</p>
</td></tr>
<tr><td><code id="power.2_+3A_m">m</code></td>
<td>
<p>Total budget.</p>
</td></tr>
<tr><td><code id="power.2_+3A_n">n</code></td>
<td>
<p>The level-1 sample size per level-2 unit.</p>
</td></tr>
<tr><td><code id="power.2_+3A_j">J</code></td>
<td>
<p>The total level-2 sample size.</p>
</td></tr>
<tr><td><code id="power.2_+3A_p">p</code></td>
<td>
<p>The proportion of level-2 clusters/units to be assigned to treatment.</p>
</td></tr>
<tr><td><code id="power.2_+3A_icc">icc</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) in population or in
each treatment condition.</p>
</td></tr>
<tr><td><code id="power.2_+3A_r12">r12</code></td>
<td>
<p>The proportion of level-1 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="power.2_+3A_r22">r22</code></td>
<td>
<p>The proportion of level-2 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="power.2_+3A_q">q</code></td>
<td>
<p>The number of level-2 covariates.</p>
</td></tr>
<tr><td><code id="power.2_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling one level-1 unit in control condition.</p>
</td></tr>
<tr><td><code id="power.2_+3A_c2">c2</code></td>
<td>
<p>The cost of sampling one level-2 unit in control condition.</p>
</td></tr>
<tr><td><code id="power.2_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling one level-1 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.2_+3A_c2t">c2t</code></td>
<td>
<p>The cost of sampling one level-2 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.2_+3A_dlim">dlim</code></td>
<td>
<p>The range for solving the root of effect size (<code>d</code>) numerically,
default value is c(0, 5).</p>
</td></tr>
<tr><td><code id="power.2_+3A_powerlim">powerlim</code></td>
<td>
<p>The range for solving the root of power (<code>power</code>) numerically,
default value is c(1e-10, 1 - 1e-10).</p>
</td></tr>
<tr><td><code id="power.2_+3A_jlim">Jlim</code></td>
<td>
<p>The range for searching the root of level-2 sample size (<code>J</code>) numerically,
default is c(4, 10e10).</p>
</td></tr>
<tr><td><code id="power.2_+3A_mlim">mlim</code></td>
<td>
<p>The range for searching the root of budget (<code>m</code>) numerically,
default is the costs sampling <code>Jlim</code> level-2 units across treatment conditions
or c(4 * Jcost, 10e10 * Jcost), with Jcost = ((1 - p) * (c1 * n + c2) + p * (c1t * n + c2t)).</p>
</td></tr>
<tr><td><code id="power.2_+3A_rounded">rounded</code></td>
<td>
<p>Logical; round <code>n</code> and <code>p</code> that are from functions <code>od.2</code>
to integer and two decimal places, respectively if TRUE,
otherwise no rounding; default value is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Required budget (and/or required level-2 sample size), statistical power, or MDES
depending on the specification of parameters.
The function also returns the function name, design type,
and parameters used in the calculation.
</p>


<h3>References</h3>

<p>Shen, Z., &amp; Kelcey, B. (2020). Optimal sample allocation under unequal
costs in cluster-randomized trials. Journal of Educational
and Behavioral Statistics, 45(4): 446â€“474.
&lt;https://doi.org/10.3102/1076998620912418&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Unconstrained optimal design
  myod1 &lt;- od.2(icc = 0.2, r12 = 0.5, r22 = 0.5, c1 = 1, c2 = 5, c1t = 1, c2t = 50)
  myod1$out   # n = 8.9, p = 0.33

# ------- Power analyses by default considering costs and budget -------
# Required budget and sample size
  mym.1 &lt;- power.2(expr = myod1, d = 0.2, q = 1, power = 0.8)
  mym.1$out  # m = 3755, J = 130.2
  #mym.1$par  # parameters and their values used for the function
# Or, equivalently, specify every argument in the function
  mym.1 &lt;- power.2(d = 0.2, power = 0.8, icc = 0.2,
                 c1 = 1, c2 = 5, c1t = 1, c2t = 50,
                  r12 = 0.5, r22 = 0.5, n = 9, p = 0.33, q = 1)
# Required budget and sample size with constrained p
  mym.2 &lt;- power.2(expr = myod1, d = 0.2, q = 1, power = 0.8,
               constraint = list(p = 0.5))
  mym.2$out  # m = 4210, J = 115.3
# Required budget and sample size with constrained p and n
  mym.3 &lt;- power.2(expr = myod1, d = 0.2, q = 1, power = 0.8,
               constraint = list(p = 0.5, n = 20))
  mym.3$out  # m = 4568, J = 96.2

# Power calculation
  mypower &lt;- power.2(expr = myod1, q = 1, d = 0.2, m = 3755)
  mypower$out  # power = 0.80
# Power calculation under constrained p (p = 0.5)
  mypower.1 &lt;- power.2(expr = myod1, q = 1, d = 0.2, m = 3755,
               constraint = list(p = 0.5))
  mypower.1$out  # power = 0.75

# MDES calculation
  mymdes &lt;- power.2(expr = myod1, q = 1, power = 0.80, m = 3755)
  mymdes$out  # d = 0.20


# ------- Conventional power analyses with cost.model = FALSE-------
# Required J
  myJ &lt;- power.2(cost.model = FALSE, expr = myod1, d = 0.2, q = 1, power = 0.8)
  myJ$out  # J = 130.2
  #myJ$par  # parameters and their values used for the function
# Or, equivalently, specify every argument in the function
  myJ &lt;- power.2(cost.model = FALSE, d = 0.2, power = 0.8, icc = 0.2,
                  r12 = 0.5, r22 = 0.5, n = 9, p = 0.33, q = 1)

# Power calculation
  mypower1 &lt;- power.2(cost.model = FALSE, expr = myod1, J = 130, d = 0.2, q = 1)
  mypower1$out  # power = 0.80

# MDES calculation
  mymdes1 &lt;- power.2(cost.model = FALSE, expr = myod1, J = 130, power = 0.8, q = 1)
  mymdes1$out  # d = 0.20

</code></pre>

<hr>
<h2 id='power.2.221'>Budget and/or sample size, power calculation for CRTs probing
mediation effects with cluster-level mediators</h2><span id='topic+power.2.221'></span>

<h3>Description</h3>

<p>This function can calculate required budget for desired power and
power under a fixed budget
for experimental studies with group mediators probing mediation effects.
It also can perform conventional power analyses
(e.g., required sample size and power calculation).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.2.221(
  cost.model = TRUE,
  expr = NULL,
  constraint = NULL,
  sig.level = 0.05,
  two.tailed = TRUE,
  a = NULL,
  b = NULL,
  test = "joint",
  n = NULL,
  p = NULL,
  power = NULL,
  J = NULL,
  m = NULL,
  c1 = NULL,
  c1t = NULL,
  c2 = NULL,
  c2t = NULL,
  r2m = r2m,
  r.yx = 0,
  r.mw = 0,
  r.yw = 0,
  icc = NULL,
  q = 0,
  q.a = 0,
  q.b = 0,
  powerlim = NULL,
  Jlim = NULL,
  mlim = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.2.221_+3A_cost.model">cost.model</code></td>
<td>
<p>Logical; power analyses accommodating costs and budget
(e.g., required budget for desired power, power/MDES under fixed budget)
if TRUE, otherwise conventional power analyses
(e.g., required sample size, power, or MDES calculation); default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_expr">expr</code></td>
<td>
<p>returned object from function <code><a href="#topic+od.2.221">od.2.221</a></code>;
default value is NULL;
if <code>expr</code> is specified, parameter values of <code>a</code>, <code>b</code>,
<code>c1</code>, <code>c1t</code>, and <code>p</code>
used or solved in function <code><a href="#topic+od.2.221">od.2.221</a></code> will
be passed to the current function;
only the values of <code>p</code> and <code>n</code> that specified or solved in
function <code><a href="#topic+od.2.221">od.2.221</a></code> can be overwritten
if <code>constraint</code> is specified.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_constraint">constraint</code></td>
<td>
<p>specify the constrained value of
<code>p</code> and/or <code>n</code> in a list format to overwrite that/those
from <code>expr</code>; default value is NULL.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level or type I error rate, default value is 0.05.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_two.tailed">two.tailed</code></td>
<td>
<p>Logical; two-tailed tests if TRUE,
otherwise one-tailed tests; default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_a">a</code></td>
<td>
<p>The treatment effect on the mediator.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_b">b</code></td>
<td>
<p>The within treatment correlation between the outcome and
the mediator at the cluster level.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_test">test</code></td>
<td>
<p>The type of test will be used to detect mediation effects.
Default is the joint significance test (i.e., test = &quot;joint&quot;).
The other choice is the Sobel test
by specifying the argument as test = &quot;sobel&quot;.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_n">n</code></td>
<td>
<p>The level-1 sample size per level-2 unit.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_p">p</code></td>
<td>
<p>The proportion of level-2 clusters/units to be assigned to treatment.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_power">power</code></td>
<td>
<p>Statistical power.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_j">J</code></td>
<td>
<p>The total level-2 sample size.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_m">m</code></td>
<td>
<p>Total budget.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling one level-1 unit in control condition.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling one level-1 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_c2">c2</code></td>
<td>
<p>The cost of sampling one level-2 unit in control condition.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_c2t">c2t</code></td>
<td>
<p>The cost of sampling one level-2 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_r2m">r2m</code></td>
<td>
<p>The proportion of mediator variance explained by covariates in
the mediator model.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_r.yx">r.yx</code></td>
<td>
<p>The correlation between the outcome and the covariate at the
individual level.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_r.mw">r.mw</code></td>
<td>
<p>The correlation between the mediator and the covariate at the
cluster level.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_r.yw">r.yw</code></td>
<td>
<p>The correlation between the outcome and the covariate at the
cluster level.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_icc">icc</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) in population or in
each treatment condition.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_q">q</code></td>
<td>
<p>The number of level-2 covariates.</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_q.a">q.a</code></td>
<td>
<p>The number of covariates in the mediator model
(except the treatment indicator).</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_q.b">q.b</code></td>
<td>
<p>The  number of covariates in the outcome model
at the cluster level
(except the treatment indicator and the mediator).</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_powerlim">powerlim</code></td>
<td>
<p>The range for solving the root of power (<code>power</code>) numerically,
default value is c(1e-10, 1 - 1e-10).</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_jlim">Jlim</code></td>
<td>
<p>The range for searching the root of level-2 sample size (<code>J</code>) numerically,
default is c(4, 10e10).</p>
</td></tr>
<tr><td><code id="power.2.221_+3A_mlim">mlim</code></td>
<td>
<p>the range for searching the root of budget (<code>m</code>) numerically,
default value is the costs sampling <code>nlim</code>
units across treatment conditions
or c(4 * ncost, 10e10 * ncost) with ncost = ((1 - p) * c1 + p * c1t)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Required budget (or required sample size), statistical power, or MDES
depending on the specification of parameters.
The function also returns the function name, design type,
and parameters used in the calculation.
</p>

<hr>
<h2 id='power.2m'>Budget and/or sample size, power, MDES calculation for two-level
MRTs detecting main effects</h2><span id='topic+power.2m'></span>

<h3>Description</h3>

<p>This function can calculate required budget for desired power,
power or minimum detectable effect size (MDES) under fixed budget
for two-level multisite randomized trials (MRTs).
It also can perform conventional power analyses
(e.g., required sample size, power, and MDES calculation).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.2m(
  cost.model = TRUE,
  expr = NULL,
  constraint = NULL,
  sig.level = 0.05,
  two.tailed = TRUE,
  d = NULL,
  power = NULL,
  m = NULL,
  n = NULL,
  J = NULL,
  p = NULL,
  icc = NULL,
  r12 = NULL,
  r22m = NULL,
  q = NULL,
  c1 = NULL,
  c2 = NULL,
  c1t = NULL,
  omega = NULL,
  dlim = NULL,
  powerlim = NULL,
  Jlim = NULL,
  mlim = NULL,
  rounded = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.2m_+3A_cost.model">cost.model</code></td>
<td>
<p>Logical; power analyses accommodating costs and budget
(e.g., required budget for desired power, power/MDES under fixed budget)
if TRUE, otherwise conventional power analyses
(e.g., required sample size, power, or MDES calculation); default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_expr">expr</code></td>
<td>
<p>Returned objects from function <code><a href="#topic+od.2m">od.2m</a></code>; default is NULL;
if <code>expr</code> is specified, parameter values of <code>icc</code>,
<code>r12</code>, <code>r22m</code>,
<code>c1</code>, <code>c2</code>,
<code>c1t</code>, <code>p</code>, and <code>n</code>
used or solved in function <code><a href="#topic+od.2m">od.2m</a></code> will
be passed to current function;
only the values of <code>p</code> and <code>n</code> that specified or solved in
function <code><a href="#topic+od.2m">od.2m</a></code> can be overwritten
if <code>constraint</code> is specified.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_constraint">constraint</code></td>
<td>
<p>Specify the constrained values of <code>p</code> and/or <code>n</code>
in list format to overwrite those from <code>expr</code>; default value is NULL.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level or type I error rate, default value is 0.05.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_two.tailed">two.tailed</code></td>
<td>
<p>Logical; two-tailed tests if TRUE,
otherwise one-tailed tests; default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_d">d</code></td>
<td>
<p>Effect size.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_power">power</code></td>
<td>
<p>Statistical power.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_m">m</code></td>
<td>
<p>Total budget.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_n">n</code></td>
<td>
<p>The level-1 sample size per level-2 unit.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_j">J</code></td>
<td>
<p>The number of sites.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_p">p</code></td>
<td>
<p>The proportion of level-1 units to be assigned to treatment.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_icc">icc</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) in population or in
each treatment condition.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_r12">r12</code></td>
<td>
<p>The proportion of level-1 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_r22m">r22m</code></td>
<td>
<p>The proportion of variance of site-specific treatment effect explained by covariates.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_q">q</code></td>
<td>
<p>The number of covariates at level 2.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling one level-1 unit in control condition.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_c2">c2</code></td>
<td>
<p>The cost of sampling one level-2 unit.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling one level-1 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_omega">omega</code></td>
<td>
<p>The standardized variance of site-specific treatment effect.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_dlim">dlim</code></td>
<td>
<p>The range for solving the root of effect size (<code>d</code>) numerically,
default value is c(0, 5).</p>
</td></tr>
<tr><td><code id="power.2m_+3A_powerlim">powerlim</code></td>
<td>
<p>The range for solving the root of power (<code>power</code>) numerically,
default value is c(1e-10, 1 - 1e-10).</p>
</td></tr>
<tr><td><code id="power.2m_+3A_jlim">Jlim</code></td>
<td>
<p>The range for searching the root of level-2 sample size (<code>J</code>) numerically,
default is c(4, 10e10).</p>
</td></tr>
<tr><td><code id="power.2m_+3A_mlim">mlim</code></td>
<td>
<p>The range for searching the root of budget (<code>m</code>) numerically,
default is the costs sampling <code>Jlim</code> level-2 units
or c(4 * Jcost, 1e+10 * Jcost) with Jcost =
(1 - p) * c1 * n + p * c1t * n + c2.</p>
</td></tr>
<tr><td><code id="power.2m_+3A_rounded">rounded</code></td>
<td>
<p>Logical; round the values of <code>p</code>, <code>n</code>/<code>J</code>/<code>K</code>
that are from functions <code><a href="#topic+od.4">od.4</a></code>
to two decimal places and integer, respectively if TRUE,
otherwise no rounding; default value is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Required budget (and/or required level-2 sample size), statistical power, or MDES
depending on the specification of parameters.
The function also returns the function name, design type,
and parameters used in the calculation.
</p>


<h3>References</h3>

<p>Shen, Z., &amp; Kelcey, B. (in press). Optimal sample
allocation in multisite randomized trials. The Journal of Experimental Education.
&lt;https://doi.org/10.1080/00220973.2020.1830361&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Unconstrained optimal design #---------
  myod1 &lt;- od.2m(icc = 0.2, omega = 0.02, r12 = 0.5, r22m = 0.5,
              c1 = 1, c2 = 10, c1t = 10,
              varlim = c(0, 0.005))
  myod1$out # n = 19.8, p = 0.37

# ------- Power analyses by default considering costs and budget -------
# Required budget and sample size
  mym.1 &lt;- power.2m(expr = myod1, d = 0.2, q = 1, power = 0.8)
  mym.1$out  # m = 2019, J = 20.9
  # mym.1$par  # parameters and their values used for the function
# Or, equivalently, specify every argument in the function
  mym.1 &lt;- power.2m(d = 0.2, power = 0.8, q = 1,
                 icc = 0.2, omega = 0.02, r12 = 0.5, r22m = 0.5,
                 c1 = 1, c2 = 10, c1t = 10,
                 n = 20, p = 0.37)
# Required budget and sample size with constrained p
  mym.2 &lt;- power.2m(expr = myod1, d = 0.2, q = 1, power = 0.8,
                 constraint = list(p = 0.5))
  mym.2$out  # m = 2373, J = 19.8
# Required budget and sample size with constrained p and n
  mym.3 &lt;- power.2m(expr = myod1, d = 0.2, q = 1, power = 0.8,
                 constraint = list(p = 0.5, n = 5))
  mym.3$out  # m = 2502, J = 66.7

# Power calculation
  mypower &lt;- power.2m(expr = myod1, q = 1, d = 0.2, m = 2019)
  mypower$out  # power = 0.80
# Power calculation under constrained p (p = 0.5)
  mypower.1 &lt;- power.2m(expr = myod1, q = 1, d = 0.2, m = 2019,
                 constraint = list(p = 0.5))
  mypower.1$out  # power = 0.72

# MDES calculation
  mymdes &lt;- power.2m(expr = myod1, q = 1, power = 0.80, m = 2019)
  mymdes$out  # d = 0.20


# ------- Conventional power analyses with cost.model = FALSE-------
# Required sample size
  myJ &lt;- power.2m(cost.model = FALSE, expr = myod1, d = 0.2, q = 1, power = 0.8)
  myJ$out  # J = 6.3
  # myL$par  # parameters and their values used for the function
# Or, equivalently, specify every argument in the function
  myJ &lt;- power.2m(cost.model = FALSE, d = 0.2, power = 0.8, q = 1,
                 icc = 0.2, omega = 0.02, r12 = 0.5, r22m = 0.5,
                 c1 = 1, c2 = 10, c1t = 10,
                 n = 20, p = 0.37)

# Power calculation
  mypower1 &lt;- power.2m(cost.model = FALSE, expr = myod1, J = 6.3, d = 0.2, q = 1)
  mypower1$out  # power = 0.80

# MDES calculation
  mymdes1 &lt;- power.2m(cost.model = FALSE, expr = myod1, J = 6.3, power = 0.8, q = 1)
  mymdes1$out  # d = 0.20

</code></pre>

<hr>
<h2 id='power.2m.111'>Budget and/or sample size, power, MDES calculation for MRTs investigating
mediation effects with individual-level mediators</h2><span id='topic+power.2m.111'></span>

<h3>Description</h3>

<p>This function can calculate required budget for desired power and
power under a fixed budget
for multisite-randomized trials (MRTs) with individual mediators
probing mediation effects.
It also can perform conventional power analyses
(e.g., required sample size and power calculation).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.2m.111(
  cost.model = TRUE,
  expr = NULL,
  constraint = NULL,
  sig.level = 0.05,
  two.tailed = TRUE,
  a = NULL,
  b = NULL,
  power = NULL,
  m = NULL,
  test = NULL,
  n = NULL,
  p = NULL,
  c1 = NULL,
  c1t = NULL,
  c2 = NULL,
  r12 = 0,
  r22m = 0,
  r12m = 0,
  icc.m = NULL,
  omega = NULL,
  icc = NULL,
  J = NULL,
  q = 0,
  q.a = 0,
  q.b = 0,
  max.iter = 300,
  powerlim = NULL,
  Jlim = NULL,
  mlim = NULL,
  rounded = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.2m.111_+3A_cost.model">cost.model</code></td>
<td>
<p>Logical; power analyses accommodating costs and budget
(e.g., required budget for desired power, power/MDES under fixed budget)
if TRUE, otherwise conventional power analyses
(e.g., required sample size, power, or MDES calculation); default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_expr">expr</code></td>
<td>
<p>returned object from function <code><a href="#topic+od.2m.111">od.2m.111</a></code>; default value is NULL;
if <code>expr</code> is specified, parameter values of <code>a</code>, <code>b</code>,
<code>c1</code>, <code>c1t</code>, and <code>p</code>
used or solved in function <code><a href="#topic+od.2m.111">od.2m.111</a></code> will
be passed to the current function;
only the values of <code>p</code> and <code>n</code> that specified or solved in
function <code><a href="#topic+od.2m.111">od.2m.111</a></code> can be overwritten
if <code>constraint</code> is specified.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_constraint">constraint</code></td>
<td>
<p>specify the constrained value of
<code>p</code> and/or <code>n</code> in a list format to overwrite that/those
from <code>expr</code>; default value is NULL.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level or type I error rate, default value is 0.05.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_two.tailed">two.tailed</code></td>
<td>
<p>Logical; two-tailed tests if TRUE,
otherwise one-tailed tests; default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_a">a</code></td>
<td>
<p>The treatment effect on the mediator.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_b">b</code></td>
<td>
<p>The within treatment correlation between the outcome and the mediator.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_power">power</code></td>
<td>
<p>Statistical power.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_m">m</code></td>
<td>
<p>Total budget.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_test">test</code></td>
<td>
<p>The type of test will be used to detect mediation effects. Default is
the joint significance test (i.e., test = &quot;joint&quot;).
Another choice is the Sobel test by specifying the argument as test = &quot;sobel&quot;.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_n">n</code></td>
<td>
<p>The level-1 sample size per level-2 unit.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_p">p</code></td>
<td>
<p>The proportion of level-1 units to be assigned to treatment.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling one level-1 unit in control condition.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling one level-1 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_c2">c2</code></td>
<td>
<p>The cost of sampling one level-2 unit.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_r12">r12</code></td>
<td>
<p>The proportion of level-1 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_r22m">r22m</code></td>
<td>
<p>The proportion of variance of site-specific treatment effect explained by covariates.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_r12m">r12m</code></td>
<td>
<p>The proportion of within treatment mediator variance at the level one
explained by covariates.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_icc.m">icc.m</code></td>
<td>
<p>The intraclass correlation coefficient for the mediator.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_omega">omega</code></td>
<td>
<p>The standardized variance of site-specific treatment effect.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_icc">icc</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) in population or in
each treatment condition.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_j">J</code></td>
<td>
<p>The number of sites.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_q">q</code></td>
<td>
<p>The number of covariates at level 2.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_q.a">q.a</code></td>
<td>
<p>The number of covariates at the individual level of the mediator model
(except the treatment indicator).</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_q.b">q.b</code></td>
<td>
<p>The number of covariates in the outcome model (except the treatment indicator
and the mediator).</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_max.iter">max.iter</code></td>
<td>
<p>Maximal number of function evaluations when used as
the stopping criterion. Default is 200.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_powerlim">powerlim</code></td>
<td>
<p>The range for solving the root of power (<code>power</code>) numerically,
default value is c(1e-10, 1 - 1e-10).</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_jlim">Jlim</code></td>
<td>
<p>The range for searching the root of level-2 sample size (<code>J</code>) numerically,
default is c(4, 10e10).</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_mlim">mlim</code></td>
<td>
<p>the range for searching the root of budget (<code>m</code>) numerically,
default value is the costs sampling <code>nlim</code> units.</p>
</td></tr>
<tr><td><code id="power.2m.111_+3A_rounded">rounded</code></td>
<td>
<p>Logical; round the values of <code>p</code>, <code>n</code>/<code>J</code>/<code>K</code>
that are from functions <code><a href="#topic+od.4">od.4</a></code>
to two decimal places and integer, respectively if TRUE,
otherwise no rounding; default value is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Required budget (or required sample size), statistical power, or MDES
depending on the specification of parameters.
The function also returns the function name, design type,
and parameters used in the calculation.
</p>

<hr>
<h2 id='power.3'>Budget and/or sample size, power, MDES calculation for
three-level CRTs detecting main effects</h2><span id='topic+power.3'></span>

<h3>Description</h3>

<p>This function can calculate required budget for desired power,
power or minimum detectable effect size (MDES) under fixed budget
for three-level cluster randomized trials (CRTs).
It also can perform conventional power analyses
(e.g., required sample size, power, and MDES calculation).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.3(
  cost.model = TRUE,
  expr = NULL,
  constraint = NULL,
  sig.level = 0.05,
  two.tailed = TRUE,
  d = NULL,
  power = NULL,
  m = NULL,
  n = NULL,
  J = NULL,
  K = NULL,
  p = NULL,
  icc2 = NULL,
  icc3 = NULL,
  r12 = NULL,
  r22 = NULL,
  r32 = NULL,
  q = NULL,
  c1 = NULL,
  c2 = NULL,
  c3 = NULL,
  c1t = NULL,
  c2t = NULL,
  c3t = NULL,
  dlim = NULL,
  powerlim = NULL,
  Klim = NULL,
  mlim = NULL,
  rounded = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.3_+3A_cost.model">cost.model</code></td>
<td>
<p>Logical; power analyses accommodating costs and budget
(e.g., required budget for desired power, power/MDES under fixed budget)
if TRUE, otherwise conventional power analyses
(e.g., required sample size, power, or MDES calculation); default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.3_+3A_expr">expr</code></td>
<td>
<p>Returned objects from function <code><a href="#topic+od.3">od.3</a></code>; default is NULL;
if <code>expr</code> is specified, parameter values of <code>icc2</code>, <code>icc3</code>,
<code>r12</code>, <code>r22</code>, <code>r32</code>,
<code>c1</code>, <code>c2</code>, <code>c3</code>, <code>c1t</code>, <code>c2t</code>, <code>c3t</code>,
<code>p</code>, <code>n</code>, and <code>J</code>
used or solved in function <code><a href="#topic+od.3">od.3</a></code> will
be passed to the current function;
only the values of <code>p</code>, <code>n</code>, and/or <code>J</code> that specified or solved in
function <code><a href="#topic+od.3">od.3</a></code> can be overwritten
if <code>constraint</code> is specified.</p>
</td></tr>
<tr><td><code id="power.3_+3A_constraint">constraint</code></td>
<td>
<p>Specify the constrained values of <code>p</code>, <code>n</code>,
and/or <code>J</code> in list format to overwrite those
from <code>expr</code>; default is NULL.</p>
</td></tr>
<tr><td><code id="power.3_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level or type I error rate, default value is 0.05.</p>
</td></tr>
<tr><td><code id="power.3_+3A_two.tailed">two.tailed</code></td>
<td>
<p>Logical; two-tailed tests if TRUE,
otherwise one-tailed tests; default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.3_+3A_d">d</code></td>
<td>
<p>Effect size.</p>
</td></tr>
<tr><td><code id="power.3_+3A_power">power</code></td>
<td>
<p>Statistical power.</p>
</td></tr>
<tr><td><code id="power.3_+3A_m">m</code></td>
<td>
<p>Total budget.</p>
</td></tr>
<tr><td><code id="power.3_+3A_n">n</code></td>
<td>
<p>The level-1 sample size per level-2 unit.</p>
</td></tr>
<tr><td><code id="power.3_+3A_j">J</code></td>
<td>
<p>The level-2 sample size per level-3 unit.</p>
</td></tr>
<tr><td><code id="power.3_+3A_k">K</code></td>
<td>
<p>The total level-3 sample size.</p>
</td></tr>
<tr><td><code id="power.3_+3A_p">p</code></td>
<td>
<p>The proportion of level-3 clusters/units assigned to treatment.</p>
</td></tr>
<tr><td><code id="power.3_+3A_icc2">icc2</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 2.</p>
</td></tr>
<tr><td><code id="power.3_+3A_icc3">icc3</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 3.</p>
</td></tr>
<tr><td><code id="power.3_+3A_r12">r12</code></td>
<td>
<p>The proportion of level-1 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="power.3_+3A_r22">r22</code></td>
<td>
<p>The proportion of level-2 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="power.3_+3A_r32">r32</code></td>
<td>
<p>The proportion of level-3 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="power.3_+3A_q">q</code></td>
<td>
<p>The number of covariates at level 3.</p>
</td></tr>
<tr><td><code id="power.3_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling one level-1 unit in control condition.</p>
</td></tr>
<tr><td><code id="power.3_+3A_c2">c2</code></td>
<td>
<p>The cost of sampling one level-2 unit in control condition.</p>
</td></tr>
<tr><td><code id="power.3_+3A_c3">c3</code></td>
<td>
<p>The cost of sampling one level-3 unit in control condition.</p>
</td></tr>
<tr><td><code id="power.3_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling one level-1 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.3_+3A_c2t">c2t</code></td>
<td>
<p>The cost of sampling one level-2 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.3_+3A_c3t">c3t</code></td>
<td>
<p>The cost of sampling one level-3 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.3_+3A_dlim">dlim</code></td>
<td>
<p>The range for solving the root of effect size (<code>d</code>) numerically,
default value is c(0, 5).</p>
</td></tr>
<tr><td><code id="power.3_+3A_powerlim">powerlim</code></td>
<td>
<p>The range for solving the root of power (<code>power</code>) numerically,
default value is c(1e-10, 1 - 1e-10).</p>
</td></tr>
<tr><td><code id="power.3_+3A_klim">Klim</code></td>
<td>
<p>The range for searching the root of level-3 sample size (<code>K</code>) numerically,
default value is c(4, 1e+10).</p>
</td></tr>
<tr><td><code id="power.3_+3A_mlim">mlim</code></td>
<td>
<p>The range for searching the root of budget (<code>m</code>) numerically,
default value is the costs sampling <code>Klim</code> level-3 units across treatment conditions
or c(4 * Kcost, 1e+10 * Kcost) with Kcost =
((1 - p) * (c1 * n * J + c2 * J + c3) + p * (c1t * n * J + c2t * J + c3t)).</p>
</td></tr>
<tr><td><code id="power.3_+3A_rounded">rounded</code></td>
<td>
<p>Logical; round the values of <code>p</code>, <code>n</code>/<code>J</code> that are
from functions <code><a href="#topic+od.3">od.3</a></code>
to two decimal places and integer, respectively if TRUE,
otherwise no rounding; default value is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Required budget (and/or required level-3 sample size), statistical power, or MDES
depending on the specification of parameters.
The function also returns the function name, design type,
and parameters used in the calculation.
</p>


<h3>References</h3>

<p>Shen, Z., &amp; Kelcey, B. (2020). Optimal sample allocation under unequal
costs in cluster-randomized trials. Journal of Educational
and Behavioral Statistics, 45(4): 446â€“474.
&lt;https://doi.org/10.3102/1076998620912418&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Unconstrained optimal design
  myod1 &lt;- od.3(icc2 = 0.2, icc3 = 0.1, r12 = 0.5, r22 = 0.5, r32 = 0.5,
              c1 = 1, c2 = 5, c3 = 25, c1t = 1, c2t = 50, c3t = 250)
  myod1$out # output  # n = 7.9, J = 3.2, p = 0.28

# ------- Power analyses by default considering costs and budget -------
# Required budget and sample size
  mym.1 &lt;- power.3(expr = myod1, d = 0.2, q = 1, power = 0.8)
  mym.1$out  # m = 16032, K = 97.3
  #mym.1$par  # parameters and their values used for the function
# Or, equivalently, specify every argument in the function
  mym.1 &lt;- power.3(d = 0.2, power = 0.8, q = 1,
                 icc2 = 0.2, icc3 = 0.1, r12 = 0.5, r22 = 0.5, r32 = 0.5,
                 c1 = 1, c2 = 5, c3 = 25, c1t = 1, c2t = 50, c3t = 250,
                 n = 8, J = 3, p = 0.28)
# Required budget and sample size with constrained p
  mym.2 &lt;- power.3(expr = myod1, d = 0.2, q = 1, power = 0.8,
                 constraint = list(p = 0.5))
  mym.2$out  # m = 19239, K = 78.8
# Required budget and sample size with constrained p and J
  mym.3 &lt;- power.3(expr = myod1, d = 0.2, q = 1, power = 0.8,
                 constraint = list(p = 0.5, J = 20))
  mym.3$out  # m = 39774, K = 46.9

# Power calculation
  mypower &lt;- power.3(expr = myod1, q = 1, d = 0.2, m = 16032)
  mypower$out  # power = 0.80
# Power calculation under constrained p (p = 0.5)
  mypower.1 &lt;- power.3(expr = myod1, q = 1, d = 0.2, m = 16032,
                 constraint = list(p = 0.5))
  mypower.1$out  # power = 0.72

# MDES calculation
  mymdes &lt;- power.3(expr = myod1, q = 1, power = 0.80, m = 16032)
  mymdes$out  # d = 0.20


# ------- Conventional power analyses with cost.model = FALSE-------
# Required sample size
  myK &lt;- power.3(cost.model = FALSE, expr = myod1, d = 0.2, q = 1, power = 0.8)
  myK$out  # K = 97.3
  #myK$par  # parameters and their values used for the function
# Or, equivalently, specify every argument in the function
  myK &lt;- power.3(cost.model = FALSE, d = 0.2, power = 0.8, q = 1,
                  icc2 = 0.2, icc3 = 0.1, r12 = 0.5, r22 = 0.5, r32 = 0.5,
                  n = 8, J = 3, p = 0.28)

# Power calculation
  mypower1 &lt;- power.3(cost.model = FALSE, expr = myod1, K = 97, d = 0.2, q = 1)
  mypower1$out  # power = 0.80

# MDES calculation
  mymdes1 &lt;- power.3(cost.model = FALSE, expr = myod1, K = 97, power = 0.8, q = 1)
  mymdes1$out  # d = 0.20

</code></pre>

<hr>
<h2 id='power.3m'>Budget and/or sample size, power, MDES calculation for
three-level MRTs detecting main effects</h2><span id='topic+power.3m'></span>

<h3>Description</h3>

<p>This function can calculate required budget for desired power,
power or minimum detectable effect size (MDES) under fixed budget
for three-level multisite randomized trials (MRTs).
It also can perform conventional power analyses
(e.g., required sample size, power, and MDES calculation).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.3m(
  cost.model = TRUE,
  expr = NULL,
  constraint = NULL,
  sig.level = 0.05,
  two.tailed = TRUE,
  d = NULL,
  power = NULL,
  m = NULL,
  n = NULL,
  J = NULL,
  K = NULL,
  p = NULL,
  icc2 = NULL,
  icc3 = NULL,
  r12 = NULL,
  r22 = NULL,
  r32m = NULL,
  q = NULL,
  c1 = NULL,
  c2 = NULL,
  c3 = NULL,
  c1t = NULL,
  c2t = NULL,
  omega = NULL,
  dlim = NULL,
  powerlim = NULL,
  Klim = NULL,
  mlim = NULL,
  rounded = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.3m_+3A_cost.model">cost.model</code></td>
<td>
<p>Logical; power analyses accommodating costs and budget
(e.g., required budget for desired power, power/MDES under fixed budget)
if TRUE, otherwise conventional power analyses
(e.g., required sample size, power, or MDES calculation); default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_expr">expr</code></td>
<td>
<p>Returned objects from function <code><a href="#topic+od.3m">od.3m</a></code>; default is NULL;
if <code>expr</code> is specified, parameter values of <code>icc2</code>, <code>icc3</code>,
<code>r12</code>, <code>r22</code>, <code>r32m</code>,
<code>c1</code>, <code>c2</code>, <code>c3</code>,
<code>c1t</code>, <code>c2t</code>, <code>p</code>, <code>n</code>, and <code>J</code>
used or solved in function <code><a href="#topic+od.3m">od.3m</a></code> will
be passed to current function;
only the values of <code>p</code>, <code>n</code>, and/or <code>J</code> that specified or solved in
function <code><a href="#topic+od.3m">od.3m</a></code> can be overwritten
if <code>constraint</code> is specified.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_constraint">constraint</code></td>
<td>
<p>Specify the constrained values of <code>p</code>, <code>n</code>, and/or <code>J</code>,
in list format to overwrite
those from <code>expr</code>; default value is NULL.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level or type I error rate, default value is 0.05.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_two.tailed">two.tailed</code></td>
<td>
<p>Logical; two-tailed tests if TRUE,
otherwise one-tailed tests; default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_d">d</code></td>
<td>
<p>Effect size.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_power">power</code></td>
<td>
<p>Statistical power.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_m">m</code></td>
<td>
<p>Total budget.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_n">n</code></td>
<td>
<p>The level-1 sample size per level-2 unit.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_j">J</code></td>
<td>
<p>The level-2 sample size per level-3 unit.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_k">K</code></td>
<td>
<p>The level-3 sample size per level-4 unit.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_p">p</code></td>
<td>
<p>The proportion of level-2 units to be assigned to treatment.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_icc2">icc2</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 2.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_icc3">icc3</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 3.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_r12">r12</code></td>
<td>
<p>The proportion of level-1 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_r22">r22</code></td>
<td>
<p>The proportion of level-2 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_r32m">r32m</code></td>
<td>
<p>The proportion of variance of site-specific treatment effect explained by covariates.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_q">q</code></td>
<td>
<p>The number of covariates at level 3.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling one level-1 unit in control condition.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_c2">c2</code></td>
<td>
<p>The cost of sampling one level-2 unit in control condition.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_c3">c3</code></td>
<td>
<p>The cost of sampling one level-3 unit.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling one level-1 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_c2t">c2t</code></td>
<td>
<p>The cost of sampling one level-2 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_omega">omega</code></td>
<td>
<p>The standardized variance of site-specific treatment effect.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_dlim">dlim</code></td>
<td>
<p>The range for solving the root of effect size (<code>d</code>) numerically,
default value is c(0, 5).</p>
</td></tr>
<tr><td><code id="power.3m_+3A_powerlim">powerlim</code></td>
<td>
<p>The range for solving the root of power (<code>power</code>) numerically,
default value is c(1e-10, 1 - 1e-10).</p>
</td></tr>
<tr><td><code id="power.3m_+3A_klim">Klim</code></td>
<td>
<p>The range for searching the root of level-3 sample size (<code>K</code>) numerically,
default value is c(4, 1e+10).</p>
</td></tr>
<tr><td><code id="power.3m_+3A_mlim">mlim</code></td>
<td>
<p>The range for searching the root of budget (<code>m</code>) numerically,
default is the costs sampling <code>Klim</code> level-3 units
or c(4 * Kcost, 1e+10 * Kcost) with Kcost =
((1 - p) * (c1 * n * J + c2 * J) +
p * (c1t * n * J + c2t * J) + c3.</p>
</td></tr>
<tr><td><code id="power.3m_+3A_rounded">rounded</code></td>
<td>
<p>Logical; round the values of <code>p</code>, <code>n</code>/<code>J</code>/<code>K</code>
that are from functions <code><a href="#topic+od.4">od.4</a></code>
to two decimal places and integer, respectively if TRUE,
otherwise no rounding; default value is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Required budget (and/or required level-3 sample size), statistical power, or MDES
depending on the specification of parameters.
The function also returns the function name, design type,
and parameters used in the calculation.
</p>


<h3>References</h3>

<p>Shen, Z., &amp; Kelcey, B. (in press). Optimal sampling ratios in three-level
multisite experiments. Journal of Research on Educational Effectiveness.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Unconstrained optimal design #---------
  myod1 &lt;- od.3m(icc2 = 0.2, icc3 = 0.1, omega = 0.02,
              r12 = 0.5, r22 = 0.5, r32m = 0.5,
              c1 = 1, c2 = 5,
              c1t = 1, c2t = 200, c3 = 200,
              varlim = c(0, 0.005))
  myod1$out # n = 13.1, J = 15.3, p = 0.23

# ------- Power analyses by default considering costs and budget -------
# Required budget and sample size
  mym.1 &lt;- power.3m(expr = myod1, d = 0.2, q = 1, power = 0.8)
  mym.1$out  # m = 15491, K = 13.6
  # mym.1$par  # parameters and their values used for the function
# Or, equivalently, specify every argument in the function
  mym.1 &lt;- power.3m(d = 0.2, power = 0.8, q = 1,
                 icc2 = 0.2, icc3 = 0.1, omega = 0.02,
                  r12 = 0.5, r22 = 0.5, r32m = 0.5,
                  c1 = 1, c2 = 5,
                  c1t = 1, c2t = 200, c3 = 200,
                  n = 13, J = 15, p = 0.23)
# Required budget and sample size with constrained p
  mym.2 &lt;- power.3m(expr = myod1, d = 0.2, q = 1, power = 0.8,
                 constraint = list(p = 0.5))
  mym.2$out  # m = 21072, K = 10.9
# Required budget and sample size with constrained p and n
  mym.3 &lt;- power.3m(expr = myod1, d = 0.2, q = 1, power = 0.8,
                 constraint = list(p = 0.5, n = 20))
  mym.3$out  # m = 21252, K = 10.4

# Power calculation
  mypower &lt;- power.3m(expr = myod1, q = 1, d = 0.2, m = 15491)
  mypower$out  # power = 0.80
# Power calculation under constrained p (p = 0.5)
  mypower.1 &lt;- power.3m(expr = myod1, q = 1, d = 0.2, m = 15491,
                 constraint = list(p = 0.5))
  mypower.1$out  # power = 0.62

# MDES calculation
  mymdes &lt;- power.3m(expr = myod1, q = 1, power = 0.80, m = 15491)
  mymdes$out  # d = 0.20


# ------- Conventional power analyses with cost.model = FALSE-------
# Required sample size
  myK &lt;- power.3m(cost.model = FALSE, expr = myod1, d = 0.2, q = 1, power = 0.8)
  myK$out  # K = 13.6
  # myK$par  # parameters and their values used for the function
# Or, equivalently, specify every argument in the function
  myK &lt;- power.3m(cost.model = FALSE, d = 0.2, power = 0.8, q = 1,
                  icc2 = 0.2, icc3 = 0.1, omega = 0.02,
                  r12 = 0.5, r22 = 0.5, r32m = 0.5,
                  c1 = 1, c2 = 5,
                  c1t = 1, c2t = 200, c3 = 200,
                  n = 13, J = 15, p = 0.23)

# Power calculation
  mypower1 &lt;- power.3m(cost.model = FALSE, expr = myod1, K = 13.6, d = 0.2, q = 1)
  mypower1$out  # power = 0.80

# MDES calculation
  mymdes1 &lt;- power.3m(cost.model = FALSE, expr = myod1, K = 13.6, power = 0.8, q = 1)
  mymdes1$out  # d = 0.20

</code></pre>

<hr>
<h2 id='power.4'>Budget and/or sample size, power, MDES calculation for
four-level CRTs detecting main effects</h2><span id='topic+power.4'></span>

<h3>Description</h3>

<p>This function can calculate required budget for desired power,
power or minimum detectable effect size (MDES) under fixed budget
for four-level cluster randomized trials (CRTs).
It also can perform conventional power analyses
(e.g., required sample size, power, and MDES calculation).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.4(
  cost.model = TRUE,
  expr = NULL,
  constraint = NULL,
  sig.level = 0.05,
  two.tailed = TRUE,
  d = NULL,
  power = NULL,
  m = NULL,
  n = NULL,
  J = NULL,
  K = NULL,
  L = NULL,
  p = NULL,
  icc2 = NULL,
  icc3 = NULL,
  icc4 = NULL,
  r12 = NULL,
  r22 = NULL,
  r32 = NULL,
  r42 = NULL,
  q = NULL,
  c1 = NULL,
  c2 = NULL,
  c3 = NULL,
  c4 = NULL,
  c1t = NULL,
  c2t = NULL,
  c3t = NULL,
  c4t = NULL,
  dlim = NULL,
  powerlim = NULL,
  Llim = NULL,
  mlim = NULL,
  rounded = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.4_+3A_cost.model">cost.model</code></td>
<td>
<p>Logical; power analyses accommodating costs and budget
(e.g., required budget for desired power, power/MDES under fixed budget)
if TRUE, otherwise conventional power analyses
(e.g., required sample size, power, or MDES calculation); default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.4_+3A_expr">expr</code></td>
<td>
<p>Returned objects from function <code><a href="#topic+od.4">od.4</a></code>; default value is NULL;
if <code>expr</code> is specified, parameter values of <code>icc2</code>, <code>icc3</code>, <code>icc4</code>,
<code>r12</code>, <code>r22</code>, <code>r32</code>, <code>r42</code>,
<code>c1</code>, <code>c2</code>, <code>c3</code>, <code>c4</code>,
<code>c1t</code>, <code>c2t</code>, <code>c3t</code>, <code>c4t</code>, <code>p</code>, <code>n</code>, <code>J</code>, and <code>K</code>
used or solved in function <code><a href="#topic+od.4">od.4</a></code> will
be passed to current function;
only the values of <code>p</code>, <code>n</code>, <code>J</code>, and/or <code>K</code> that specified or solved in
function <code><a href="#topic+od.4">od.4</a></code> can be overwritten
if <code>constraint</code> is specified.</p>
</td></tr>
<tr><td><code id="power.4_+3A_constraint">constraint</code></td>
<td>
<p>Specify the constrained values of <code>p</code>, <code>n</code>, <code>J</code>,
and/or <code>K</code> in list format to overwrite
those from <code>expr</code>; default value is NULL.</p>
</td></tr>
<tr><td><code id="power.4_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level or type I error rate, default value is 0.05.</p>
</td></tr>
<tr><td><code id="power.4_+3A_two.tailed">two.tailed</code></td>
<td>
<p>Logical; two-tailed tests if TRUE,
otherwise one-tailed tests; default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.4_+3A_d">d</code></td>
<td>
<p>Effect size.</p>
</td></tr>
<tr><td><code id="power.4_+3A_power">power</code></td>
<td>
<p>Statistical power.</p>
</td></tr>
<tr><td><code id="power.4_+3A_m">m</code></td>
<td>
<p>Total budget.</p>
</td></tr>
<tr><td><code id="power.4_+3A_n">n</code></td>
<td>
<p>The level-1 sample size per level-2 unit.</p>
</td></tr>
<tr><td><code id="power.4_+3A_j">J</code></td>
<td>
<p>The level-2 sample size per level-3 unit.</p>
</td></tr>
<tr><td><code id="power.4_+3A_k">K</code></td>
<td>
<p>The level-3 sample size per level-4 unit.</p>
</td></tr>
<tr><td><code id="power.4_+3A_l">L</code></td>
<td>
<p>The total level-4 sample size.</p>
</td></tr>
<tr><td><code id="power.4_+3A_p">p</code></td>
<td>
<p>The proportion of level-4 clusters/units to be assigned to treatment.</p>
</td></tr>
<tr><td><code id="power.4_+3A_icc2">icc2</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 2.</p>
</td></tr>
<tr><td><code id="power.4_+3A_icc3">icc3</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 3.</p>
</td></tr>
<tr><td><code id="power.4_+3A_icc4">icc4</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 4.</p>
</td></tr>
<tr><td><code id="power.4_+3A_r12">r12</code></td>
<td>
<p>The proportion of level-1 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="power.4_+3A_r22">r22</code></td>
<td>
<p>The proportion of level-2 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="power.4_+3A_r32">r32</code></td>
<td>
<p>The proportion of level-3 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="power.4_+3A_r42">r42</code></td>
<td>
<p>The proportion of level-4 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="power.4_+3A_q">q</code></td>
<td>
<p>The number of covariates at level 4.</p>
</td></tr>
<tr><td><code id="power.4_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling one level-1 unit in control condition.</p>
</td></tr>
<tr><td><code id="power.4_+3A_c2">c2</code></td>
<td>
<p>The cost of sampling one level-2 unit in control condition.</p>
</td></tr>
<tr><td><code id="power.4_+3A_c3">c3</code></td>
<td>
<p>The cost of sampling one level-3 unit in control condition.</p>
</td></tr>
<tr><td><code id="power.4_+3A_c4">c4</code></td>
<td>
<p>The cost of sampling one level-4 unit in control condition.</p>
</td></tr>
<tr><td><code id="power.4_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling one level-1 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.4_+3A_c2t">c2t</code></td>
<td>
<p>The cost of sampling one level-2 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.4_+3A_c3t">c3t</code></td>
<td>
<p>The cost of sampling one level-3 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.4_+3A_c4t">c4t</code></td>
<td>
<p>The cost of sampling one level-4 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.4_+3A_dlim">dlim</code></td>
<td>
<p>The range for solving the root of effect size (<code>d</code>) numerically,
default value is c(0, 5).</p>
</td></tr>
<tr><td><code id="power.4_+3A_powerlim">powerlim</code></td>
<td>
<p>The range for solving the root of power (<code>power</code>) numerically,
default value is c(1e-10, 1 - 1e-10).</p>
</td></tr>
<tr><td><code id="power.4_+3A_llim">Llim</code></td>
<td>
<p>The range for solving the root of level-4 sample size (<code>L</code>) numerically,
default value is c(4, 1e+10).</p>
</td></tr>
<tr><td><code id="power.4_+3A_mlim">mlim</code></td>
<td>
<p>The range for searching the root of budget (<code>m</code>) numerically,
default value is the costs sampling <code>Llim</code> level-4 units across treatment conditions
or c(4 * Lcost, 1e+10 * Lcost) with Lcost =
((1 - p) * (c1 * n * J * K + c2 * J * K + c3 * K + c4) +
p * (c1t * n * J * K + c2t * J * K + c3t * K + c4t)).</p>
</td></tr>
<tr><td><code id="power.4_+3A_rounded">rounded</code></td>
<td>
<p>Logical; round the values of <code>p</code>, <code>n</code>/<code>J</code>/<code>K</code>
that are from functions <code><a href="#topic+od.4">od.4</a></code>
to two decimal places and integer, respectively if TRUE,
otherwise no rounding; default value is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Required budget (and/or required level-4 sample size), statistical power, or MDES
depending on the specification of parameters.
The function also returns the function name, design type,
and parameters used in the calculation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Unconstrained optimal design
  myod1 &lt;- od.4(icc2 = 0.2, icc3 = 0.1, icc4 = 0.05,
              r12 = 0.5, r22 = 0.5, r32 = 0.5, r42 = 0.5,
              c1 = 1, c2 = 5, c3 = 25, c4 = 125,
              c1t = 1, c2t = 50, c3t = 250, c4t = 2500)
  myod1$out # output # n = 7.1, J = 3.2, K = 4.2, p = 0.23

# ------- Power analyses by default considering costs and budget -------
# Required budget and sample size
  mym.1 &lt;- power.4(expr = myod1, d = 0.2, q = 1, power = 0.8)
  mym.1$out  # m = 71161, L = 57.1
  #mym.1$par  # parameters and their values used for the function
# Or, equivalently, specify every argument in the function
  mym.1 &lt;- power.4(d = 0.2, power = 0.8, q = 1,
                 icc2 = 0.2, icc3 = 0.1, icc4 = 0.05,
                 r12 = 0.5, r22 = 0.5, r32 = 0.5, r42 = 0.5,
                 c1 = 1, c2 = 5, c3 = 25, c4 = 125,
                 c1t = 1, c2t = 50, c3t = 250, c4t = 2500,
                 n = 7, J = 3, K = 4, p = 0.23)
# Required budget and sample size with constrained p (p = 0.5)
  mym.2 &lt;- power.4(expr = myod1, d = 0.2, q = 1, power = 0.8,
                 constraint = list(p = 0.5))
  mym.2$out  # m = 93508, L = 41.1
# Required budget and sample size with constrained p and K
  mym.3 &lt;- power.4(expr = myod1, d = 0.2, q = 1, power = 0.8,
                 constraint = list(p = 0.5, K = 20))
  mym.3$out  # m = 157365, L = 25.7

# Power calculation
  mypower &lt;- power.4(expr = myod1, q = 1, d = 0.2, m = 71161)
  mypower$out  # power = 0.80
# Power calculation under constrained p (p = 0.5)
  mypower.1 &lt;- power.4(expr = myod1, q = 1, d = 0.2, m = 71161,
                 constraint = list(p = 0.5))
  mypower.1$out  # power = 0.68

# MDES calculation
  mymdes &lt;- power.4(expr = myod1, q = 1, power = 0.80, m = 71161)
  mymdes$out  # d = 0.20


# ------- Conventional power analyses with cost.model = FALSE-------
# Required sample size
  myL &lt;- power.4(cost.model = FALSE, expr = myod1, d = 0.2, q = 1, power = 0.8)
  myL$out  # L = 57.1
#myL$par  # parameters and their values used for the function
# Or, equivalently, specify every argument in the function
  myL &lt;- power.4(cost.model = FALSE, d = 0.2, power = 0.8, q = 1,
                  icc2 = 0.2, icc3 = 0.1, icc4 = 0.05,
                  r12 = 0.5, r22 = 0.5, r32 = 0.5, r42 = 0.5,
                  n = 7, J = 3, K = 4, p = 0.23)

# Power calculation
  mypower1 &lt;- power.4(cost.model = FALSE, expr = myod1, L = 57, d = 0.2, q = 1)
  mypower1$out  # power = 0.80

# MDES calculation
  mymdes1 &lt;- power.4(cost.model = FALSE, expr = myod1, L = 57, power = 0.8, q = 1)
  mymdes1$out  # d = 0.20

</code></pre>

<hr>
<h2 id='power.4m'>Budget and/or sample size, power, MDES calculation for
four-level MRTs detecting main effects</h2><span id='topic+power.4m'></span>

<h3>Description</h3>

<p>This function can calculate required budget for desired power,
power or minimum detectable effect size (MDES) under fixed budget
for four-level multisite randomized trials (MRTs).
It also can perform conventional power analyses
(e.g., required sample size, power, and MDES calculation).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.4m(
  cost.model = TRUE,
  expr = NULL,
  constraint = NULL,
  sig.level = 0.05,
  two.tailed = TRUE,
  d = NULL,
  power = NULL,
  m = NULL,
  n = NULL,
  J = NULL,
  K = NULL,
  L = NULL,
  p = NULL,
  icc2 = NULL,
  icc3 = NULL,
  icc4 = NULL,
  r12 = NULL,
  r22 = NULL,
  r32 = NULL,
  r42m = NULL,
  q = NULL,
  c1 = NULL,
  c2 = NULL,
  c3 = NULL,
  c4 = NULL,
  c1t = NULL,
  c2t = NULL,
  c3t = NULL,
  omega = NULL,
  dlim = NULL,
  powerlim = NULL,
  Llim = NULL,
  mlim = NULL,
  rounded = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.4m_+3A_cost.model">cost.model</code></td>
<td>
<p>Logical; power analyses accommodating costs and budget
(e.g., required budget for desired power, power/MDES under fixed budget)
if TRUE, otherwise conventional power analyses
(e.g., required sample size, power, or MDES calculation); default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_expr">expr</code></td>
<td>
<p>Returned objects from function <code><a href="#topic+od.4m">od.4m</a></code>; default is NULL;
if <code>expr</code> is specified, parameter values of <code>icc2</code>, <code>icc3</code>, <code>icc4</code>,
<code>r12</code>, <code>r22</code>, <code>r32</code>, <code>r42m</code>,
<code>c1</code>, <code>c2</code>, <code>c3</code>, <code>c4</code>,
<code>c1t</code>, <code>c2t</code>, <code>c3t</code>, <code>p</code>, <code>n</code>, <code>J</code>, and <code>K</code>
used or solved in function <code><a href="#topic+od.4m">od.4m</a></code> will
be passed to current function;
only the values of <code>p</code>, <code>n</code>, <code>J</code>, and/or <code>K</code> that specified or solved in
function <code><a href="#topic+od.4m">od.4m</a></code> can be overwritten
if <code>constraint</code> is specified.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_constraint">constraint</code></td>
<td>
<p>The constrained values of <code>p</code>, <code>n</code>, <code>J</code>,
and/or <code>K</code> in list format to overwrite
those from <code>expr</code>; default value is NULL.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level or type I error rate, default value is 0.05.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_two.tailed">two.tailed</code></td>
<td>
<p>Logical; two-tailed tests if TRUE,
otherwise one-tailed tests; default value is TRUE.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_d">d</code></td>
<td>
<p>Effect size.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_power">power</code></td>
<td>
<p>Statistical power.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_m">m</code></td>
<td>
<p>Total budget.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_n">n</code></td>
<td>
<p>The level-1 sample size per level-2 unit.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_j">J</code></td>
<td>
<p>The level-2 sample size per level-3 unit.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_k">K</code></td>
<td>
<p>The level-3 sample size per level-4 unit.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_l">L</code></td>
<td>
<p>The total level-4 sample size.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_p">p</code></td>
<td>
<p>The proportion of level-3 units to be assigned to treatment.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_icc2">icc2</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 2.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_icc3">icc3</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 3.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_icc4">icc4</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 4.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_r12">r12</code></td>
<td>
<p>The proportion of level-1 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_r22">r22</code></td>
<td>
<p>The proportion of level-2 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_r32">r32</code></td>
<td>
<p>The proportion of level-3 variance explained by covariates.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_r42m">r42m</code></td>
<td>
<p>The proportion of variance of site-specific treatment effect explained by covariates.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_q">q</code></td>
<td>
<p>The number of covariates at level 4.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_c1">c1</code></td>
<td>
<p>The cost of sampling one level-1 unit in control condition.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_c2">c2</code></td>
<td>
<p>The cost of sampling one level-2 unit in control condition.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_c3">c3</code></td>
<td>
<p>The cost of sampling one level-3 unit in control condition.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_c4">c4</code></td>
<td>
<p>The cost of sampling one level-4 unit.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_c1t">c1t</code></td>
<td>
<p>The cost of sampling one level-1 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_c2t">c2t</code></td>
<td>
<p>The cost of sampling one level-2 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_c3t">c3t</code></td>
<td>
<p>The cost of sampling one level-3 unit in treatment condition.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_omega">omega</code></td>
<td>
<p>The standardized variance of site-specific treatment effect.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_dlim">dlim</code></td>
<td>
<p>The range for solving the root of effect size (<code>d</code>) numerically,
default value is c(0, 5).</p>
</td></tr>
<tr><td><code id="power.4m_+3A_powerlim">powerlim</code></td>
<td>
<p>The range for solving the root of power (<code>power</code>) numerically,
default value is c(1e-10, 1 - 1e-10).</p>
</td></tr>
<tr><td><code id="power.4m_+3A_llim">Llim</code></td>
<td>
<p>The range for solving the root of level-4 sample size (<code>L</code>) numerically,
default value is c(4, 1e+10).</p>
</td></tr>
<tr><td><code id="power.4m_+3A_mlim">mlim</code></td>
<td>
<p>The range for searching the root of budget (<code>m</code>) numerically,
default is the costs sampling <code>Llim</code> level-4 units
or c(4 * Lcost, 1e+10 * Lcost) with Lcost =
((1 - p) * (c1 * n * J * K + c2 * J * K + c3 * K) +
p * (c1t * n * J * K + c2t * J * K + c3t * K) + c4.</p>
</td></tr>
<tr><td><code id="power.4m_+3A_rounded">rounded</code></td>
<td>
<p>Logical; round the values of <code>p</code>, <code>n</code>/<code>J</code>/<code>K</code>
that are from functions <code><a href="#topic+od.4">od.4</a></code>
to two decimal places and integer, respectively if TRUE,
otherwise no rounding; default value is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Required budget (and/or required level-4 sample size), statistical power, or MDES
depending on the specification of parameters.
The function also returns the function name, design type,
and parameters used in the calculation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Unconstrained optimal design #---------
  myod1 &lt;- od.4m(icc2 = 0.2, icc3 = 0.1, icc4 = 0.05, omega = 0.02,
              r12 = 0.5, r22 = 0.5, r32 = 0.5, r42m = 0.5,
              c1 = 1, c2 = 5, c3 = 25,
              c1t = 1, c2t = 50, c3t = 250, c4 = 500,
              varlim = c(0, 0.005))
  myod1$out # n = 8.3, J = 3.2, K = 4.9, p = 0.36

# ------- Power analyses by default considering costs and budget -------
# Required budget and sample size
  mym.1 &lt;- power.4m(expr = myod1, d = 0.2, q = 1, power = 0.8)
  mym.1$out  # m = 30201, L = 20.6
  # mym.1$par  # parameters and their values used for the function
# Or, equivalently, specify every argument in the function
  mym.1 &lt;- power.4m(d = 0.2, power = 0.8, q = 1,
                 icc2 = 0.2, icc3 = 0.1, icc4 = 0.05, omega = 0.02,
                 r12 = 0.5, r22 = 0.5, r32 = 0.5, r42m = 0.5,
                 c1 = 1, c2 = 5, c3 = 25,
                 c1t = 1, c2t = 50, c3t = 250, c4 = 500,
                 n = 8, J = 3, K = 5, p = 0.36)
# Required budget and sample size with constrained p
  mym.2 &lt;- power.4m(expr = myod1, d = 0.2, q = 1, power = 0.8,
                 constraint = list(p = 0.5))
  mym.2$out  # m = 33183, L = 19.3
# Required budget and sample size with constrained p and n
  mym.3 &lt;- power.4m(expr = myod1, d = 0.2, q = 1, power = 0.8,
                 constraint = list(p = 0.5, n = 20))
  mym.3$out  # m = 34262, L = 18.0

# Power calculation
  mypower &lt;- power.4m(expr = myod1, q = 1, d = 0.2, m = 30201)
  mypower$out  # power = 0.80
# Power calculation under constrained p (p = 0.5)
  mypower.1 &lt;- power.4m(expr = myod1, q = 1, d = 0.2, m = 30201,
                 constraint = list(p = 0.5))
  mypower.1$out  # power = 0.76

# MDES calculation
  mymdes &lt;- power.4m(expr = myod1, q = 1, power = 0.80, m = 30201)
  mymdes$out  # d = 0.20


# ------- Conventional power analyses with cost.model = FALSE-------
# Required sample size
  myL &lt;- power.4m(cost.model = FALSE, expr = myod1, d = 0.2, q = 1, power = 0.8)
  myL$out  # L = 20.6
  # myL$par  # parameters and their values used for the function
# Or, equivalently, specify every argument in the function
  myL &lt;- power.4m(cost.model = FALSE, d = 0.2, power = 0.8, q = 1,
                  icc2 = 0.2, icc3 = 0.1, icc4 = 0.05, omega = 0.02,
                 r12 = 0.5, r22 = 0.5, r32 = 0.5, r42m = 0.5,
                 c1 = 1, c2 = 5, c3 = 25,
                 c1t = 1, c2t = 50, c3t = 250, c4 = 500,
                 n = 8, J = 3, K = 5, p = 0.36)

# Power calculation
  mypower1 &lt;- power.4m(cost.model = FALSE, expr = myod1, L = 20.6, d = 0.2, q = 1)
  mypower1$out  # power = 0.80

# MDES calculation
  mymdes1 &lt;- power.4m(cost.model = FALSE, expr = myod1, L = 20.6, power = 0.8, q = 1)
  mymdes1$out  # d = 0.20

</code></pre>

<hr>
<h2 id='re'>Relative efficiency (RE) calculation</h2><span id='topic+re'></span>

<h3>Description</h3>

<p>Calculate the relative efficiency (RE) between two designs, it returns
same results as those from function <code><a href="#topic+rpe">rpe</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>re(od, subod, rounded = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="re_+3A_od">od</code></td>
<td>
<p>Returned object of first design (e.g., unconstrained optimal design)
from function <code><a href="#topic+od.1">od.1</a></code>, <code><a href="#topic+od.2">od.2</a></code>,
<code><a href="#topic+od.3">od.3</a></code>, <code><a href="#topic+od.4">od.4</a></code>, <code><a href="#topic+od.2m">od.2m</a></code>,
<code><a href="#topic+od.3m">od.3m</a></code>, or <code><a href="#topic+od.4m">od.4m</a></code>.</p>
</td></tr>
<tr><td><code id="re_+3A_subod">subod</code></td>
<td>
<p>Returned object of second design (e.g., constrained optimal design)
from function <code><a href="#topic+od.1">od.1</a></code>, <code><a href="#topic+od.2">od.2</a></code>,
<code><a href="#topic+od.3">od.3</a></code>, <code><a href="#topic+od.4">od.4</a></code>, <code><a href="#topic+od.2m">od.2m</a></code>,
<code><a href="#topic+od.3m">od.3m</a></code>, or <code><a href="#topic+od.4m">od.4m</a></code>.</p>
</td></tr>
<tr><td><code id="re_+3A_rounded">rounded</code></td>
<td>
<p>Logical; round the values of <code>p</code>, <code>n</code>/<code>J</code>/<code>K</code>
that are from functions to two decimal places and integer, respectively if TRUE,
no rounding if FALSE; default is TRUE.</p>
</td></tr>
<tr><td><code id="re_+3A_verbose">verbose</code></td>
<td>
<p>Logical; print the value of relative efficiency if TRUE,
otherwise not; default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Relative efficiency value.
</p>


<h3>References</h3>

<p>(1) Shen, Z., &amp; Kelcey, B. (2020). Optimal sample allocation under
unequal costs in cluster-randomized trials.
Journal of Educational and Behavioral Statistics, 45(4): 446â€“474.
&lt;https://doi.org/10.3102/1076998620912418&gt;
(2) Shen, Z., &amp; Kelcey, B. (in press). Optimal sample
allocation in multisite randomized trials.
The Journal of Experimental Education.
&lt;https://doi.org/10.1080/00220973.2020.1830361&gt;
(3) Shen, Z., &amp; Kelcey, B. (in press).
Optimal sampling ratios in three-level
multisite experiments. Journal of Research on Educational Effectiveness.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Unconstrained optimal design of 2-level CRT #----------
  myod1 &lt;- od.2(icc = 0.2, r12 = 0.5, r22 = 0.5, c1 = 1, c2 = 5, c1t = 1, c2t = 50,
              varlim = c(0.01, 0.02))
# Constrained optimal design with n = 20
  myod2 &lt;- od.2(icc = 0.2, r12 = 0.5, r22 = 0.5, c1 = 1, c2 = 5, c1t = 1, c2t = 50,
              n = 20, varlim = c(0.005, 0.025))
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod2)
  myre$re # RE = 0.88
# Constrained optimal design with p = 0.5
  myod2 &lt;- od.2(icc = 0.2, r12 = 0.5, r22 = 0.5, c1 = 1, c2 = 5, c1t = 1, c2t = 50,
             p = 0.5, varlim = c(0.005, 0.025))
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod2)
  myre$re # RE = 0.90

# Unconstrained optimal design of 3-level CRT #----------
  myod1 &lt;- od.3(icc2 = 0.2, icc3 = 0.1, r12 = 0.5, r22 = 0.5, r32 = 0.5,
             c1 = 1, c2 = 5, c3 = 25, c1t = 1, c2t = 50, c3t = 250,
             varlim = c(0.005, 0.025))
# Constrained optimal design with J = 20
  myod2 &lt;- od.3(icc2 = 0.2, icc3 = 0.1, r12 = 0.5, r22 = 0.5, r32 = 0.5, J = 20,
             c1 = 1, c2 = 5, c3 = 25, c1t = 1, c2t = 50, c3t = 250,
             varlim = c(0, 0.025))
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod2)
  myre$re # RE = 0.53

# Unconstrained optimal design of 4-level CRT #---------
  myod1 &lt;- od.4(icc2 = 0.2, icc3 = 0.1, icc4 = 0.05, r12 = 0.5,
              r22 = 0.5, r32 = 0.5, r42 = 0.5,
              c1 = 1, c2 = 5, c3 = 25, c4 = 125,
              c1t = 1, c2t = 50, c3t = 250, c4t = 2500,
              varlim = c(0, 0.01))
# Constrained optimal design with p = 0.5
  myod2 &lt;- od.4(icc2 = 0.2, icc3 = 0.1, icc4 = 0.05, r12 = 0.5, p = 0.5,
              r22 = 0.5, r32 = 0.5, r42 = 0.5,
              c1 = 1, c2 = 5, c3 = 25, c4 = 125,
              c1t = 1, c2t = 50, c3t = 250, c4t = 2500,
              varlim = c(0, 0.01))
# Relative efficiency (RE)
  myre &lt;- re(od = myod1, subod= myod2)
  myre$re # RE = 0.78

</code></pre>

<hr>
<h2 id='rpe'>Relative precision and efficiency (RPE) calculation</h2><span id='topic+rpe'></span>

<h3>Description</h3>

<p>Calculate the relative precision and efficiency (RPE) between two designs,
it returns same results as those from function <code><a href="#topic+re">re</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpe(od, subod, rounded = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rpe_+3A_od">od</code></td>
<td>
<p>Returned object of first design (e.g., unconstrained optimal design)
from function <code><a href="#topic+od.1">od.1</a></code>, <code><a href="#topic+od.2">od.2</a></code>,
<code><a href="#topic+od.3">od.3</a></code>, <code><a href="#topic+od.4">od.4</a></code>, <code><a href="#topic+od.2m">od.2m</a></code>,
<code><a href="#topic+od.3m">od.3m</a></code>, or <code><a href="#topic+od.4m">od.4m</a></code>.</p>
</td></tr>
<tr><td><code id="rpe_+3A_subod">subod</code></td>
<td>
<p>Returned object of second design (e.g., constrained optimal design)
from function <code><a href="#topic+od.1">od.1</a></code>, <code><a href="#topic+od.2">od.2</a></code>,
<code><a href="#topic+od.3">od.3</a></code>, <code><a href="#topic+od.4">od.4</a></code>, <code><a href="#topic+od.2m">od.2m</a></code>,
<code><a href="#topic+od.3m">od.3m</a></code>, or <code><a href="#topic+od.4m">od.4m</a></code>.</p>
</td></tr>
<tr><td><code id="rpe_+3A_rounded">rounded</code></td>
<td>
<p>Logical; round the values of <code>p</code>, <code>n</code>/<code>J</code>/<code>K</code>
that are from functions to two decimal places and integer, respectively if TRUE,
no rounding if FALSE; default is TRUE.</p>
</td></tr>
<tr><td><code id="rpe_+3A_verbose">verbose</code></td>
<td>
<p>Logical; print the value of relative precision and efficiency if TRUE,
otherwise not; default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Relative precision and efficiency value.
</p>


<h3>References</h3>

<p>(1) Shen, Z., &amp; Kelcey, B. (2020). Optimal sample allocation under
unequal costs in cluster-randomized trials.
Journal of Educational and Behavioral Statistics, 45(4): 446â€“474.
&lt;https://doi.org/10.3102/1076998620912418&gt;
(2) Shen, Z., &amp; Kelcey, B. (in press). Optimal sample
allocation in multisite randomized trials.
The Journal of Experimental Education.
&lt;https://doi.org/10.1080/00220973.2020.1830361&gt;
(3) Shen, Z., &amp; Kelcey, B. (in press).
Optimal sampling ratios in three-level
multisite experiments. Journal of Research on Educational Effectiveness.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Unconstrained optimal design of 2-level CRT #----------
  myod1 &lt;- od.2(icc = 0.2, r12 = 0.5, r22 = 0.5, c1 = 1, c2 = 5, c1t = 1, c2t = 50,
              varlim = c(0.01, 0.02))
# Constrained optimal design with n = 20
  myod2 &lt;- od.2(icc = 0.2, r12 = 0.5, r22 = 0.5, c1 = 1, c2 = 5, c1t = 1, c2t = 50,
              n = 20, varlim = c(0.005, 0.025))
# Relative precision and efficiency (RPE)
  myrpe &lt;- rpe(od = myod1, subod= myod2)
  myrpe$rpe # RPE = 0.88
# Constrained optimal design with p = 0.5
  myod2 &lt;- od.2(icc = 0.2, r12 = 0.5, r22 = 0.5, c1 = 1, c2 = 5, c1t = 1, c2t = 50,
             p = 0.5, varlim = c(0.005, 0.025))
# Relative precision and efficiency (RPE)
  myrpe &lt;- rpe(od = myod1, subod= myod2)
  myrpe$rpe # RPE = 0.90

# Unconstrained optimal design of 3-level CRT #----------
  myod1 &lt;- od.3(icc2 = 0.2, icc3 = 0.1, r12 = 0.5, r22 = 0.5, r32 = 0.5,
             c1 = 1, c2 = 5, c3 = 25, c1t = 1, c2t = 50, c3t = 250,
             varlim = c(0.005, 0.025))
# Constrained optimal design with J = 20
  myod2 &lt;- od.3(icc2 = 0.2, icc3 = 0.1, r12 = 0.5, r22 = 0.5, r32 = 0.5, J = 20,
             c1 = 1, c2 = 5, c3 = 25, c1t = 1, c2t = 50, c3t = 250,
             varlim = c(0, 0.025))
# Relative precision and efficiency (RPE)
  myrpe &lt;- rpe(od = myod1, subod= myod2)
  myrpe$rpe # RPE = 0.53

# Unconstrained optimal design of 4-level CRT #---------
  myod1 &lt;- od.4(icc2 = 0.2, icc3 = 0.1, icc4 = 0.05, r12 = 0.5,
              r22 = 0.5, r32 = 0.5, r42 = 0.5,
              c1 = 1, c2 = 5, c3 = 25, c4 = 125,
              c1t = 1, c2t = 50, c3t = 250, c4t = 2500,
              varlim = c(0, 0.01))
# Constrained optimal design with p = 0.5
  myod2 &lt;- od.4(icc2 = 0.2, icc3 = 0.1, icc4 = 0.05, r12 = 0.5, p = 0.5,
              r22 = 0.5, r32 = 0.5, r42 = 0.5,
              c1 = 1, c2 = 5, c3 = 25, c4 = 125,
              c1t = 1, c2t = 50, c3t = 250, c4t = 2500,
              varlim = c(0, 0.01))
# Relative precision and efficiency (RPE)
  myrpe &lt;- rpe(od = myod1, subod= myod2)
  myrpe$rpe # RPE = 0.78

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
