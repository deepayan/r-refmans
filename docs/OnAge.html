<!DOCTYPE html><html lang="en"><head><title>Help for package OnAge</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {OnAge}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#onset.test'><p>Tests the null hypothesis that the age at the onset of senescence is</p>
the same in two groups</a></li>
<li><a href='#RoeDeerMassData'><p>Data on 454 roe deer</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Test of Between-Group Differences in the Onset of Senescence</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-10-20</td>
</tr>
<tr>
<td>Author:</td>
<td>Laurent Jacob, Frédéric Douhard, Jean-François Lemaître, Jean-Michel Gaillard, Aurélie Siberchicot</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aurélie Siberchicot &lt;aurelie.siberchicot@univ-lyon1.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of a likelihood ratio test of differential
    onset of senescence between two groups. Given two groups with
    measures of age and of an individual trait likely to be subjected to
    senescence (e.g. body mass), 'OnAge' provides an asymptotic p-value
    for the null hypothesis that senescence starts at the same age in
    both groups. The package implements the procedure used in 
    Douhard et al. (2017) &lt;<a href="https://doi.org/10.1111%2Foik.04421">doi:10.1111/oik.04421</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://lbbe.univ-lyon1.fr/OnAge.html">https://lbbe.univ-lyon1.fr/OnAge.html</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>lme4</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>BuildVignettes:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-10-20 09:35:34 UTC; aurelie</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-10-20 10:21:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='onset.test'>Tests the null hypothesis that the age at the onset of senescence is
the same in two groups</h2><span id='topic+onset.test'></span>

<h3>Description</h3>

<p>The function takes as input a log-likelihood function
defining a statistical model of the senescence and two datasets. It
performs a likelihood ratio test of the null hypothesis that the age
at the onset of senescence is the same in the two groups.</p>


<h3>Usage</h3>

<pre><code class='language-R'>onset.test(ll, data1, data2, search.range, CI.lvl=0.95, 
    tol=.Machine$double.eps^0.25, warn=FALSE, do.plot=FALSE, 
    plot.file=NULL, grid.len=100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="onset.test_+3A_ll">ll</code></td>
<td>
<p>A function computing the log-likelihood of data under a
statistical model of the senescence.</p>
</td></tr>
<tr><td><code id="onset.test_+3A_data1">data1</code></td>
<td>
<p>A <a href="base.html#topic+data.frame">data.frame</a> object containing the data for the first
group.</p>
</td></tr>
<tr><td><code id="onset.test_+3A_data2">data2</code></td>
<td>
<p>A <a href="base.html#topic+data.frame">data.frame</a> object containing the data for the second
group.</p>
</td></tr>
<tr><td><code id="onset.test_+3A_search.range">search.range</code></td>
<td>
<p>The range over which the log-likelihood should be
maximized with respect to the age at the onset of senescence.</p>
</td></tr>
<tr><td><code id="onset.test_+3A_ci.lvl">CI.lvl</code></td>
<td>
<p>An optional confidence level to obtain a confidence
interval for each onset estimate. No confidence interval is computed
if <code>NA</code>. Default <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="onset.test_+3A_tol">tol</code></td>
<td>
<p>A tolerance, to be passed to the optimize function. Optional.</p>
</td></tr>
<tr><td><code id="onset.test_+3A_warn">warn</code></td>
<td>
<p>A logical variable indicating whether the function should
issue a warning when the computed likelihood ratio is negative (which
may happen for numerical reasons). Optional.</p>
</td></tr>
<tr><td><code id="onset.test_+3A_do.plot">do.plot</code></td>
<td>
<p>A logical variable indicating whether the function should
produce a plot of the log-likelihood against age at the onset of senescence (with
vertical dotted lines indicating the confidence interval if <code>CI.lvl</code> is not
<code>NA</code>). Optional (default <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="onset.test_+3A_plot.file">plot.file</code></td>
<td>
<p>If not <code>NULL</code> and <code>do.plot</code> is <code>TRUE</code>, the function makes the
plot in a pdf file with name <code>plot.file</code>. Optional (default <code>NULL</code>).</p>
</td></tr>
<tr><td><code id="onset.test_+3A_grid.len">grid.len</code></td>
<td>
<p>Integer value. If <code>do.plot</code> is <code>TRUE</code>, specifies the number
of onset values for which the log-likelihood is evaluated between
<code>search.range[1]</code> and <code>search.range[2]</code>. Optional (default <code>100</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+list">list</a></code> with elements:
</p>
<table role = "presentation">
<tr><td><code>pv</code></td>
<td>
<p>A p-value for the tested null hypothesis.</p>
</td></tr>
<tr><td><code>est.1</code></td>
<td>
<p>A maximum likelihood estimate for the age at the onset of
senescence in the first group.</p>
</td></tr>
<tr><td><code>est.2</code></td>
<td>
<p>A maximum likelihood estimate for the age at the onset of
senescence in the second group.</p>
</td></tr>
<tr><td><code>est.joint</code></td>
<td>
<p>A maximum likelihood estimate for the age at the
onset of senescence in the merged groups.</p>
</td></tr>
<tr><td><code>CI.1</code></td>
<td>
<p>A confidence interval for the age at the onset of
senescence in the first group, with confidence level <code>CI.lvl</code> 
(<code>NA</code> if <code>CI.lvl</code> is <code>NA</code>).</p>
</td></tr>
<tr><td><code>CI.2</code></td>
<td>
<p>A confidence interval for the age at the onset of
senescence in the second group, with confidence level <code>CI.lvl</code> 
(<code>NA</code> if <code>CI.lvl</code> is <code>NA</code>).</p>
</td></tr>
<tr><td><code>joint.CI</code></td>
<td>
<p>A confidence interval for the age at the onset of
senescence in the total group, with confidence level <code>CI.lvl</code> 
(<code>NA</code> if <code>CI.lvl</code> is <code>NA</code>).</p>
</td></tr>
<tr><td><code>lh0</code></td>
<td>
<p>The log-likelihood maximized under the null hypothesis.</p>
</td></tr>
<tr><td><code>lh1</code></td>
<td>
<p>The log-likelihood maximized under the alternative hypothesis.</p>
</td></tr>
<tr><td><code>llr</code></td>
<td>
<p>The likelihood ratio statistic.</p>
</td></tr>  
<tr><td><code>cvg.ok</code></td>
<td>
<p>A logical variable indicating whether the computed
likelihood ratio was negative (the returned value is <code>0</code> in this case).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>if(requireNamespace("lme4", quietly=TRUE)) {
    data(RoeDeerMassData)
    RoeDeerMassData$ID &lt;- factor(RoeDeerMassData$ID)
    RoeDeerMassData$cohort &lt;- factor(RoeDeerMassData$cohort)

    dataFCH &lt;- RoeDeerMassData[RoeDeerMassData$sex%in%"F"&amp;
                                 RoeDeerMassData$population%in%"CH", ]
    dataMCH &lt;- RoeDeerMassData[RoeDeerMassData$sex%in%"M"&amp;
                                 RoeDeerMassData$population%in%"CH", ]
    dataFTF &lt;- RoeDeerMassData[RoeDeerMassData$sex%in%"F"&amp;
                                 RoeDeerMassData$population%in%"TF", ]
    dataMTF &lt;- RoeDeerMassData[RoeDeerMassData$sex%in%"M"&amp;
                                 RoeDeerMassData$population%in%"TF", ]

    ## b1: function for piecewise regression (transforms x into 0 before bp)
    b1 &lt;- function(x, bp) ifelse(x &lt; bp, 0, x - bp)

    ## Use this function to define the model in which the differential
    ## onset hypothesis is tested.
    ll &lt;- function(thr, dataIn){
        logLik(lme4::lmer(body.mass ~ b1(age, thr) + age.at.last.capture + 
            last.year.of.capture + (1|ID) + (1|cohort), data=dataIn, 
            REML="FALSE"))
    }

    search.range &lt;- c(6,12) # data not available before 6 years old
    search.range.TF &lt;- search.range.CH &lt;- search.range

    ## Not run: 
      # if you don't run the example in RStudio, create a new graphic 
      # window with suitable dimensions
      if(.Platform$GUI!="RStudio") {dev.new(width=15, height=5)}
      # all graphs are square
      par(pty="s")
      
      # test for Trois Fontaines
      res.tf &lt;- onset.test(ll, dataFTF, dataMTF, search.range.TF, do.plot=TRUE)
      
      if(.Platform$GUI!="RStudio") {dev.new(width=15, height=5)}
      par(pty="s")
      
      # test for Chizé
      res.ch &lt;- onset.test(ll, dataFCH, dataMCH, search.range.CH, do.plot=TRUE)
      
      cat(sprintf("p-value for differential age at onset is %g in 
          Trois Fontaines, %g in Chizé", res.tf$pv, res.ch$pv))
    
## End(Not run)
    
    # a shorter executable example for Trois Fontaines
    set.seed(40)
    shortdataFTF &lt;- dataFTF[sample(1:NROW(dataFTF), 200), ]
    shortdataMTF &lt;- dataMTF[sample(1:NROW(dataMTF), 100), ]
    res.tf.short &lt;- onset.test(ll, shortdataFTF, shortdataMTF, search.range.TF, 
      do.plot=FALSE, CI.lvl=NA)
  }
</code></pre>

<hr>
<h2 id='RoeDeerMassData'>Data on 454 roe deer</h2><span id='topic+RoeDeerMassData'></span>

<h3>Description</h3>

<p>A dataset containing the age, body weight and other
attributes of 454 roe deer from Chizé and Trois Fontaines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(RoeDeerMassData)</code></pre>


<h3>Format</h3>

<p>A data frame with 1428 rows and 16 variables:
</p>

<dl>
<dt>ID</dt><dd><p>An individual specific identifier.</p>
</dd>
<dt>age</dt><dd><p>The age of the individual (in years).</p>
</dd>
<dt>sex</dt><dd><p>The sex of the individual (F for females, M for males).</p>
</dd>
<dt>population</dt><dd><p>The population site of the individual: either Chizé (CH)
or Trois Fontaines (TF).</p>
</dd>
<dt>cohort</dt><dd><p>The year of birth of the individual.</p>
</dd>
<dt>body.mass</dt><dd><p>The individual body mass measurement at this
particular age (in kg).</p>
</dd>
<dt>year.of.capture</dt><dd><p>The year of capture of the individual for this particular
body mass measurement.</p>
</dd>
<dt>age.at.last.capture</dt><dd><p>The age of the individual at its last capture (in years).</p>
</dd>
<dt>last.year.of.capture</dt><dd><p>A binary variable indicating whether or
not the body mass measurement was done in the last capture of
individual's life (no = 0; yes = 1).</p>
</dd>
<dt>early.mass</dt><dd><p>The predicted body mass during the first winter at
the median date of capture (27th of January) (in kg).</p>
</dd>
<dt>residual.early.mass</dt><dd><p>The difference between the individual
early mass and the average early mass of individuals within each sex
and population (in kg).</p>
</dd>
<dt>adult.body.mass</dt><dd><p>Median body mass during the prime age stage
between four (after body growth has ceased) and six years of age
(when senescence in body mass can begin)</p>
</dd>
<dt>mass.gain</dt><dd><p>The body mass gain corresponding to the difference
between adult body mass and early mass (in kg).</p>
</dd>    
<dt>late.growth</dt><dd><p>The body mass gain once the effect of early mass
has been accounted for within each sex and population (i.e. residual
of the linear regression model between early mas and mass gain) (in
kg)</p>
</dd>
<dt>early.mass.group</dt><dd><p>The binary variable indicating whether the
individual has an early mass less, or equal or greater than the median
early mass within each sex and population (no = 0; yes =1).</p>
</dd>  
<dt>late.growth.group</dt><dd><p>The binary variable indicating whether the
individual has a late growth less, or equal or greater than the
median early mass within each sex and population (no = 0; yes = 1).</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="http://onlinelibrary.wiley.com/doi/10.1111/oik.04421/abstract">http://onlinelibrary.wiley.com/doi/10.1111/oik.04421/abstract</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RoeDeerMassData)
str(RoeDeerMassData)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
