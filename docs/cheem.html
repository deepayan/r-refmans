<!DOCTYPE html><html lang="en-US"><head><title>Help for package cheem</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cheem}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cheem'><p>cheem</p></a></li>
<li><a href='#ames_rf_pred'><p>Ames random forest model predictions and shap values</p></a></li>
<li><a href='#amesHousing2018'><p>Ames housing data 2018</p></a></li>
<li><a href='#as_logical_index'><p>Assure a full length logical index</p></a></li>
<li><a href='#cheem_ls'><p>Preprocessing for use in shiny app</p></a></li>
<li><a href='#chocolates'><p>Chocolates dataset</p></a></li>
<li><a href='#chocolates_svm_pred'><p>Chocolate svm model predictions and shap values</p></a></li>
<li><a href='#color_scale_of'><p>Suggest a color and fill scale.</p></a></li>
<li><a href='#contains_nonnumeric'><p>Check if a vector contains non-numeric character</p></a></li>
<li><a href='#devMessage'><p>Development message</p></a></li>
<li><a href='#global_view'><p>Linked <code>plotly</code> display, global view of data and attribution space.</p></a></li>
<li><a href='#global_view_df_1layer'><p>Create the plot data.frame for the global linked plotly display.</p></a></li>
<li><a href='#global_view_legwork'><p>The legwork behind the scenes for the global view</p></a></li>
<li><a href='#ifDev'><p>Evaluate if development</p></a></li>
<li><a href='#is_discrete'><p>Check if a vector is discrete</p></a></li>
<li><a href='#is_diverging'><p>Check if a vector diverges a value</p></a></li>
<li><a href='#linear_tform'><p>Linear function to help set alpha opacity</p></a></li>
<li><a href='#logistic_tform'><p>Logistic function to help set alpha opacity</p></a></li>
<li><a href='#model_performance'><p>Extract higher level model performance statistics</p></a></li>
<li><a href='#penguin_xgb_pred'><p>Penguins xgb model predictions and shap values</p></a></li>
<li><a href='#problem_type'><p>The type of model for a given Y variable</p></a></li>
<li><a href='#proto_basis1d_distribution'><p>Adds the distribution of the row local attributions to a ggtour</p></a></li>
<li><a href='#radial_cheem_tour'><p>Cheem tour; 1D manual tour on the selected attribution</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#rnorm_from'><p>Draw new samples from the supplied data given its mean and covariances.</p></a></li>
<li><a href='#run_app'><p>Runs a shiny app demonstrating manual tours</p></a></li>
<li><a href='#subset_cheem'><p>Subset a cheem list</p></a></li>
<li><a href='#sug_basis'><p>Suggest a 1D Basis</p></a></li>
<li><a href='#sug_manip_var'><p>Suggest a manipulation variable</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Interactively Explore Local Explanations with the Radial Tour</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Given a non-linear model, calculate the local explanation. 
    We purpose view the data space, explanation 
    space, and model residuals as ensemble graphic interactive on a shiny 
    application. After an observation of interest is identified, the normalized 
    variable importance of the local explanation is used as a 1D projection
    basis. The support of the local explanation is then explored by changing
    the basis with the use of the radial tour &lt;<a href="https://doi.org/10.32614%2FRJ-2020-027">doi:10.32614/RJ-2020-027</a>&gt;; 
    &lt;<a href="https://doi.org/10.1080%2F10618600.1997.10474754">doi:10.1080/10618600.1997.10474754</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/nspyrison/cheem/">https://github.com/nspyrison/cheem/</a>,
<a href="https://nspyrison.github.io/cheem/">https://nspyrison.github.io/cheem/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/nspyrison/cheem/issues">https://github.com/nspyrison/cheem/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>spinifex (&ge; 0.3.3), ggplot2, plotly, magrittr, shiny,
shinythemes, shinycssloaders, DT, conflicted</td>
</tr>
<tr>
<td>Suggests:</td>
<td>methods, tourr, lqmm, mvtnorm, gganimate, dplyr, tidyr,
tictoc, beepr, knitr, testthat (&ge; 3.0.0), rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-08 18:12:02 UTC; nxs9837</td>
</tr>
<tr>
<td>Author:</td>
<td>Nicholas Spyrison <a href="https://orcid.org/0000-0002-8417-0212"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nicholas Spyrison &lt;spyrison@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-08 21:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cheem'>cheem</h2><span id='topic+cheem'></span><span id='topic+cheem-package'></span>

<h3>Description</h3>

<p>Consider an arbitrary black-box model. Local explanations are a class of
point-measures of the variable importance to the model for one location in
the explanatory variables. The package <code>cheem</code> extracts the local attribution
of all observations and first creates a 2D approximated space comparing
data- and attribution-spaces. After a primary and comparison observation have
been selected the attribution of the primary is used as the 1D basis for a
manual tour. This tour changes the contribution from the variable that
deviates the most from its expected value. By viewing the positions of the
primary and comparison points, the analyst can scrutinize the explanation
identify variable attribution leading to a misclassification or large
residual.
</p>


<h3>Details</h3>

<p>GitHub: <a href="https://github.com/nspyrison/cheem">https://github.com/nspyrison/cheem</a>
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Nicholas Spyrison <a href="mailto:spyrison@gmail.com">spyrison@gmail.com</a> (<a href="https://orcid.org/0000-0002-8417-0212">ORCID</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cheem_ls">cheem_ls()</a></code> or <code><a href="#topic+run_app">run_app()</a></code> for help getting started
</p>

<hr>
<h2 id='ames_rf_pred'>Ames random forest model predictions and shap values</h2><span id='topic+ames_rf_pred'></span><span id='topic+ames_rf_shap'></span>

<h3>Description</h3>

<p>Predictions and treeshap attribution of a random forest model of North Ames
house sales data regressing Sales Price from house and lot variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ames_rf_pred

ames_rf_shap
</code></pre>


<h3>Format</h3>

<p><code>ames_rf_pred</code> is a n=338 length vector of the prediction of an
random forest model predicting the numeric House Sales in North Ames.
<code>ames_rf_shap</code> is a (338 x 9) data frame of the treeshap SHAP attribution of
the random forest model for each observation.
</p>
<p><strong>Replicating</strong>
</p>
<div class="sourceCode"><pre>library(cheem)
library(randomForest)
library(treeshap)
set.seed(135)

## Regression setup
dat  &lt;- amesHousing2018_NorthAmes
X    &lt;- dat[, 1:9]
Y    &lt;- dat$SalePrice
clas &lt;- dat$SubclassMS

## Model and treeSHAP
ames_rf_fit &lt;- randomForest::randomForest(
  X, Y, ntree = 125,
  mtry = ifelse(is_discrete(Y), sqrt(ncol(X)), ncol(X) / 3),
  nodesize = max(ifelse(is_discrete(Y), 1, 5), nrow(X) / 500))
ames_rf_pred &lt;- predict(ames_rf_fit, X)
ames_rf_shap &lt;- treeshap::treeshap(
  treeshap::randomForest.unify(ames_rf_fit, X), X, FALSE, FALSE)
ames_rf_shap &lt;- ames_rf_shap$shaps

if(F){ ## Don't accidentally save
  save(ames_rf_pred, file = "./data/ames_rf_pred.rda")
  save(ames_rf_shap, file = "./data/ames_rf_shap.rda")
  #usethis::use_data(ames_rf_pred)
  #usethis::use_data(ames_rf_shap)
}
</pre></div>
<p>An object of class <code>data.frame</code> with 338 rows and 9 columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

## Regression setup
dat  &lt;- amesHousing2018_NorthAmes
X    &lt;- dat[, 1:9]
Y    &lt;- dat$SalePrice
clas &lt;- dat$SubclassMS

## Precomputed predictions and shap attribution
str(ames_rf_pred)
str(ames_rf_shap)

## Cheem
ames_chm &lt;- cheem_ls(X, Y, ames_rf_shap, ames_rf_pred, clas,
                     label = "Ames, random forest, treeshap")

## Save for use with shiny app (expects an rds file)
if(FALSE){ ## Don't accidentally save.
  saveRDS(ames_chm, "./chm_ames_rf_tshap.rds")
  run_app() ## Select the saved rds file from the data dropdown.
}

## Cheem visuals
if(interactive()){
  prim &lt;- 1
  comp &lt;- 2
  global_view(ames_chm, primary_obs = prim, comparison_obs = comp)
  bas &lt;- sug_basis(ames_rf_shap, prim, comp)
  mv  &lt;- sug_manip_var(ames_rf_shap, primary_obs = prim, comp)
  ggt &lt;- radial_cheem_tour(ames_chm, basis = bas, manip_var = mv)
  animate_plotly(ggt)
}
</code></pre>

<hr>
<h2 id='amesHousing2018'>Ames housing data 2018</h2><span id='topic+amesHousing2018'></span><span id='topic+amesHousing2018_raw'></span><span id='topic+amesHousing2018_NorthAmes'></span>

<h3>Description</h3>

<p>House sales prices from Ames, Iowa, USA between 2006 and 2010. Only complete
numeric observations remain.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>amesHousing2018

amesHousing2018_raw

amesHousing2018_NorthAmes
</code></pre>


<h3>Format</h3>

<p>complete data.frame with 2291 rows and 18 numeric variables,
SalesPrice, the response variable, and 3 class variables
</p>
<p>An object of class <code>data.frame</code> with 2930 rows and 82 columns.
</p>
<p>An object of class <code>data.frame</code> with 338 rows and 11 columns.
</p>


<h3>Details</h3>


<dl>
<dt>amesHousing2018</dt><dd><p>Complete data.frame, n = 2291, 18 numeric variable
(including 2 temporal: MoSold, YrSold ), response variable SalePrice,
3 class factors.</p>
</dd>
<dt>amesHousing2018_NorthAmes</dt><dd><p>A simplified subsample, just North Ames
(largest neighborhood). Complete data.frame, n = 338, 9 numeric variables,
response variable SalePrice, 1 class factor SubclassMS, a zoning subclass.</p>
</dd>
<dt>amesHousing2018_raw</dt><dd><p>Original data from Kaggle, 2930 rows of 82
variables. Sparse rows (639) and sparse/defaulted columns (64) are removed.</p>
</dd>
</dl>

<p>No data dictionary is provided on Kaggle, but amesHousing2018 variables
are inferred to be:
</p>

<ul>
<li><p> LotFrontage, Length of the front (street facing) side of the lot
in yards (0.914m)
</p>
</li>
<li><p> LotArea, Area of the lot in square yards (0.836m^2)
</p>
</li>
<li><p> OverallQual, Overall quality (of the house?), integer in (1, 10)
</p>
</li>
<li><p> OverallCond, Overall condition (of the lot?), integer in (1, 10)
</p>
</li>
<li><p> YearBuild, The year the house was originally built
</p>
</li>
<li><p> BsmtUnfArea, Unfinished basement area, in square yards (0.836m^2)
</p>
</li>
<li><p> TotBsmtArea, Total basement area, in square yards (0.836m^2)
</p>
</li>
<li><p> 1stFlrArea,  First (ground) floor living area in square yards (0.836m^2)
</p>
</li>
<li><p> LivingArea, Total living area in square yards (0.836m^2)
</p>
</li>
<li><p> Bathrms, The number of bathrooms
</p>
</li>
<li><p> Bedrms, The number of bedrooms
</p>
</li>
<li><p> TotRms, The total number of rooms
</p>
</li>
<li><p> GarageYrBlt, The year the garage was build
</p>
</li>
<li><p> GarageCars, The number of car spaces in the garage
</p>
</li>
<li><p> GarageArea, The area of the garage in square yards (0.836m^2)
</p>
</li>
<li><p> MoSold, The number of the month of the house sale
</p>
</li>
<li><p> YrSold, The number of the year of the house sale
</p>
</li>
<li><p> SalePrice, The sale of the house in USD (as of the year of sale?)
</p>
</li>
<li><p> SubclassMS, Factor subclass of construction zone, 16 levels
</p>
</li>
<li><p> SubclassMS, Factor major class of construction zone, 7 levels
</p>
</li>
<li><p> Neighborhd, Factor neighborhood of Ames, IA, 28 levels
</p>
</li></ul>



<h3>Source</h3>

<p>De Cock, D. (2011). &quot;Ames, Iowa: Alternative to the Boston Housing Data as an End of Semester Regression Project,&quot; <em>Journal of Statistics Education</em>,  Volume 19, Number 3.
<a href="http://jse.amstat.org/v19n3/decock/DataDocumentation.txt">http://jse.amstat.org/v19n3/decock/DataDocumentation.txt</a>
<a href="http://jse.amstat.org/v19n3/decock.pdf">http://jse.amstat.org/v19n3/decock.pdf</a>
</p>
<p>Kaggle, Ames Housing Dataset
<a href="https://www.kaggle.com/prevek18/ames-housing-dataset">https://www.kaggle.com/prevek18/ames-housing-dataset</a>
</p>
<p><strong>Replicating this dataset:</strong>
</p>
<div class="sourceCode"><pre>if(FALSE) ## Don't accidentally open the URL.
  browseURL("https://www.kaggle.com/prevek18/ames-housing-dataset")
ames &lt;- readr::read_csv("./buildignore/AmesHousing.csv")
amesHousing2018_raw &lt;- data.frame(ames)
## save(amesHousing2018_raw, file = "./data/amesHousing2018_raw.rda")

## Complete rows and numeric variables
ames1 &lt;- ames[, unlist(lapply(ames, is.numeric))]
ames1$Bathrooms &lt;- ames1$`Full Bath` + ames1$`Half Bath`
ames1 &lt;- ames1[, c(1:18, 38, 19:37)]
col_idx &lt;- !(colnames(ames1) %in% c(
  "Order", "Mas Vnr Area", "BsmtFin SF 1", "BsmtFin SF 2",
  "Bsmt Full Bath", "Bsmt Half Bath", "Fireplaces",
  "Wood Deck SF", "Open Porch SF", "Enclosed Porch",
  "3Ssn Porch", "Screen Porch", "Pool Area", "Misc Val", "2nd Flr SF",
  "Low Qual Fin SF", "Full Bath", "Half Bath", "Kitchen AbvGr"))
row_idx &lt;- !is.na(ames1$"Garage Yr Blt") &amp;
  !is.na(ames1$"Lot Frontage") &amp;
  !is.na(ames1$"Bsmt Unf SF") &amp;
  !is.na(ames1$"Total Bsmt SF")
ames2 &lt;- as.data.frame(ames1[row_idx, col_idx])

## Looking for character classes to keep:
ames_char &lt;- ames[, unlist(lapply(ames, is.character))]
ames_clas &lt;- as.data.frame(lapply(ames_char, factor))[, -1]
ames_clasint &lt;- data.frame(lapply(ames_clas, as.integer))
col_idx_char &lt;- which(names(ames_clas) %in%
                        c("MS.SubClass", "MS.Zoning", "Neighborhood"))
classes &lt;- ames_clas[row_idx, col_idx_char]

amesHousing2018 &lt;- cbind(ames2, classes)
names(amesHousing2018) &lt;- c(
  "LotFrontage", "LotArea","OverallQual", "OverallCond", "YearBuild",
  "YearRemod", "BsmtUnfArea", "TotBsmtArea", "1stFlrArea", "LivingArea",
  "Bathrms", "Bedrms", "TotRms", "GarageYrBlt", "GarageCars", "GarageArea",
  "MoSold", "YrSold", "SalePrice", "SubclassMS", "ZoneMS", "Neighborhd")
## save(amesHousing2018, file = "./data/amesHousing2018.rda")

.thin_col_idx &lt;- names(amesHousing2018) %in% c(
  "LotArea", "OverallQual", "YearBuild",
  "LivingArea", "Bathrms", "Bedrms", "TotRms",
  "GarageYrBlt", "GarageArea", "SalePrice", "SubclassMS")
amesHousing2018_thin &lt;- amesHousing2018[, .thin_col_idx]

## subset to north ames, and only 5 largest subclasses
r_idx &lt;- amesHousing2018$Neighborhd == "NAmes" &amp;
  amesHousing2018$SubclassMS %in% c("020", "050", "080", "090", "060")
amesHousing2018_NorthAmes &lt;- amesHousing2018_thin[r_idx, ]
amesHousing2018_NorthAmes$SubclassMS &lt;- factor(
  amesHousing2018_NorthAmes$SubclassMS,
  unique(amesHousing2018_NorthAmes$SubclassMS))
if(F){ ## Don't accidentally save
  save(amesHousing2018_NorthAmes, file = "./data/amesHousing2018_NorthAmes.rda")
</pre></div>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

## Regression setup:
dat  &lt;- amesHousing2018_NorthAmes
X    &lt;- dat[, 1:9]
Y    &lt;- dat$SalePrice
clas &lt;- dat$SubclassMS

## Cheem list
ames_rf_chm &lt;- cheem_ls(X, Y, ames_rf_shap, ames_rf_pred, clas,
                        label = "North Ames, RF, SHAP")
## Cheem visuals
if(interactive()){
  prim &lt;- 1
  comp &lt;- 2
  global_view(ames_rf_chm, primary_obs = prim, comparison_obs = comp)
  bas &lt;- sug_basis(ames_rf_chm, prim, comp)
  mv  &lt;- sug_manip_var(ames_rf_chm, primary_obs = prim, comp)
  ggt &lt;- radial_cheem_tour(ames_rf_chm, basis = bas, manip_var = mv)
  animate_plotly(ggt)
}

## Save for use with shiny app (expects an rds file)
if(FALSE){ ## Don't accidentally save.
  saveRDS(ames_rf_chm, "./chm_NAmes_rf_tshap.rds")
  run_app() ## Select the saved rds file from the data drop down.
}
</code></pre>

<hr>
<h2 id='as_logical_index'>Assure a full length logical index</h2><span id='topic+as_logical_index'></span>

<h3>Description</h3>

<p>Suggests a alpha opacity to plot with as a function of the number of
observation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_logical_index(index, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_logical_index_+3A_index">index</code></td>
<td>
<p>A vector, typically a numeric row index of the data to
coerce to a logical index.</p>
</td></tr>
<tr><td><code id="as_logical_index_+3A_n">n</code></td>
<td>
<p>Single numeric, the number of rows of the data use as a replicate
return length.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical index of length n.
</p>


<h3>See Also</h3>

<p>Other cheem utility: 
<code><a href="#topic+color_scale_of">color_scale_of</a>()</code>,
<code><a href="#topic+contains_nonnumeric">contains_nonnumeric</a>()</code>,
<code><a href="#topic+is_discrete">is_discrete</a>()</code>,
<code><a href="#topic+is_diverging">is_diverging</a>()</code>,
<code><a href="#topic+linear_tform">linear_tform</a>()</code>,
<code><a href="#topic+logistic_tform">logistic_tform</a>()</code>,
<code><a href="#topic+problem_type">problem_type</a>()</code>,
<code><a href="#topic+rnorm_from">rnorm_from</a>()</code>,
<code><a href="#topic+sug_basis">sug_basis</a>()</code>,
<code><a href="#topic+sug_manip_var">sug_manip_var</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

## Coerce a numeric index to logical
as_logical_index(c(1, 4:10, 15), nrow(mtcars))

## Logical indexs are unchanged
as_logical_index(mtcars$mpg &gt; 30, nrow(mtcars))
</code></pre>

<hr>
<h2 id='cheem_ls'>Preprocessing for use in shiny app</h2><span id='topic+cheem_ls'></span>

<h3>Description</h3>

<p>Performs the preprocessing steps needs to supply the plot functions
<code>global_view()</code> and <code>radial_cheem_tour()</code> used in the shiny app.
The user need to supply the attributions and predictions. For help getting
started with this see <code>vignette("getting-started-with-cheem")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cheem_ls(
  x,
  y = NULL,
  attr_df,
  pred = NULL,
  class = NULL,
  label = "label",
  verbose = getOption("verbose")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cheem_ls_+3A_x">x</code></td>
<td>
<p>The explanatory variables of the model.</p>
</td></tr>
<tr><td><code id="cheem_ls_+3A_y">y</code></td>
<td>
<p>The target variable of the model.</p>
</td></tr>
<tr><td><code id="cheem_ls_+3A_attr_df">attr_df</code></td>
<td>
<p>A data frame or matrix of (n, p) local explanation
attributions.</p>
</td></tr>
<tr><td><code id="cheem_ls_+3A_pred">pred</code></td>
<td>
<p>A (n, 1) vector, the predictions from the associated model.</p>
</td></tr>
<tr><td><code id="cheem_ls_+3A_class">class</code></td>
<td>
<p>Optional, (n, 1) vector, a variable to group points by.
This can be the same as or different from <code>y</code>, the target variable.</p>
</td></tr>
<tr><td><code id="cheem_ls_+3A_label">label</code></td>
<td>
<p>Optionally provide a character label to store reminder
text for the type of model and local explanation used.
Defaults to &quot;label&quot;.</p>
</td></tr>
<tr><td><code id="cheem_ls_+3A_verbose">verbose</code></td>
<td>
<p>Logical, if start time and run duration should be printed.
Defaults to getOption(&quot;verbose&quot;).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data.frames needed for the <code>shiny</code> application.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+global_view">global_view()</a></code> <code><a href="#topic+radial_cheem_tour">radial_cheem_tour()</a></code> <code><a href="#topic+radial_cheem_tour">radial_cheem_tour()</a></code>
</p>
<p>Other cheem preprocessing: 
<code><a href="#topic+subset_cheem">subset_cheem</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

## Classification setup
X    &lt;- spinifex::penguins_na.rm[, 1:4]
Y    &lt;- spinifex::penguins_na.rm$species
clas &lt;- spinifex::penguins_na.rm$species

## Bring your own attributions and predictions, 
## for help review the vignette or package down site;
if(FALSE){
  vignette("getting-started-with-cheem")
  browseURL("https://nspyrison.github.io/cheem/articles/getting-started-with-cheem.html")
}

## Cheem
peng_chm &lt;- cheem_ls(X, Y, penguin_xgb_shap, penguin_xgb_pred, clas,
                     label = "Penguins, xgb, shapviz")

## Save for use with shiny app (expects an rds file)
if(FALSE){ ## Don't accidentally save.
  saveRDS(peng_chm, "./chm_peng_xgb_shapviz.rds")
  run_app() ## Select the saved rds file from the data dropdown.
}

## Cheem visuals
if(interactive()){
  prim &lt;- 1
  comp &lt;- 2
  global_view(peng_chm, primary_obs = prim, comparison_obs = comp)
  bas &lt;- sug_basis(penguin_xgb_shap, prim, comp)
  mv  &lt;- sug_manip_var(penguin_xgb_shap, primary_obs = prim, comp)
  ggt &lt;- radial_cheem_tour(peng_chm, basis = bas, manip_var = mv)
  animate_plotly(ggt)
}

## Regression example
library(cheem)

## Regression setup
dat  &lt;- amesHousing2018_NorthAmes
X    &lt;- dat[, 1:9]
Y    &lt;- dat$SalePrice
clas &lt;- dat$SubclassMS

#' ## Bring your own attributions and predictions, 
## for help review the vignette or package down site;
if(FALSE){
  vignette("getting-started-with-cheem")
  browseURL("https://nspyrison.github.io/cheem/articles/getting-started-with-cheem.html")
}

## Cheem list
ames_rf_chm &lt;- cheem_ls(X, Y, ames_rf_shap, ames_rf_pred, clas,
                        label = "North Ames, RF, treeshap")

## Save for use with shiny app (expects an rds file)
if(FALSE){ ## Don't accidentally save.
  saveRDS(ames_rf_chm, "./chm_NAmes_rf_tshap.rds")
  run_app() ## Select the saved rds file from the data drop down.
}

## Cheem visuals
if(interactive()){
  prim &lt;- 1
  comp &lt;- 2
  global_view(ames_rf_chm, primary_obs = prim, comparison_obs = comp)
  bas &lt;- sug_basis(ames_rf_shap, prim, comp)
  mv  &lt;- sug_manip_var(ames_rf_shap, primary_obs = prim, comp)
  ggt &lt;- radial_cheem_tour(ames_rf_chm, basis = bas, manip_var = mv)
  animate_plotly(ggt)
}
</code></pre>

<hr>
<h2 id='chocolates'>Chocolates dataset</h2><span id='topic+chocolates'></span>

<h3>Description</h3>

<p>The chocolates data was compiled by students at Iowa State University of
STAT503 (circa 2015) taught by Dianne Cook. Nutrition label information
on the chocolates as listed on manufacturer websites.
All numbers were normalized to be equivalent to a 100g serving.
Units of measurement are listed in the variable name.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chocolates
</code></pre>


<h3>Format</h3>

<p>A complete data.frame with 88 observations and 10 numeric variables,
name of the chocolate, manufacturer, country, and type of the chocolate.
</p>

<ul>
<li><p> Name, the name of the chocolate
</p>
</li>
<li><p> MFR, chocolate manufacturer
</p>
</li>
<li><p> Country, the country the manufacturer is incorporated.
</p>
</li>
<li><p> Type, the type of chocolate according to the website, either 'Dark'
or 'Milk&quot;
</p>
</li>
<li><p> Calories, the number of calories per 100 grams
</p>
</li>
<li><p> CalFat, calories from fat per 100 grams
</p>
</li>
<li><p> TotFat_g, grams of total fat per 100 grams
</p>
</li>
<li><p> SatFat_g, grams of saturated fat per 100 grams
</p>
</li>
<li><p> Chol_mg, milligrams of cholesterol per 100 grams
</p>
</li>
<li><p> Na_mg, milligrams of sodium (salt) per 100 grams
</p>
</li>
<li><p> Carbs_g, grams of carbohydrates per 100 grams
</p>
</li>
<li><p> Fiber_g, grams of fiber per 100 grams
</p>
</li>
<li><p> Sugars_g, grams of sugar per 100 grams
</p>
</li>
<li><p> Protein_g, grams of sugar per 100 grams
</p>
</li></ul>



<h3>Source</h3>

<p>Monash University, Introduction to Machine Learning course <a href="https://iml.numbat.space/">https://iml.numbat.space/</a>
</p>
<p><strong>Replicating this dataset:</strong>
</p>
<div class="sourceCode"><pre>if(FALSE) ## Don't accidentally open the URL.
  browseURL("https://iml.numbat.space/")
## Accessed Jan 2022
chocolates &lt;- readr::read_csv("https://iml.numbat.space/data/chocolates.csv")
chocolates &lt;- data.frame(chocolates)
chocolates[, 2] &lt;- factor(chocolates[, 2])
chocolates[, 3] &lt;- factor(chocolates[, 3])
chocolates[, 4] &lt;- factor(chocolates[, 4])
if(F){ ## Don't accidentally save
  save(chocolates, file = "./data/chocolates.rda")
</pre></div>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

## Classification setup
X    &lt;- chocolates[, 5:14]
Y    &lt;- chocolates$Type
clas &lt;- chocolates$Type

## Cheem
choc_chm &lt;- cheem_ls(X, Y, chocolates_svm_shap, chocolates_svm_pred, clas,
                     label = "Chocolates, LM, shap")

## Save for use with shiny app (expects an rds file)
if(FALSE){ ## Don't accidentally save.
  saveRDS(choc_chm, "./chm_chocolates_svm_shap.rds")
  run_app() ## Select the saved rds file from the data dropdown.
}

## Cheem visuals
if(interactive()){
  prim &lt;- 1
  comp &lt;- 2
  global_view(peng_chm, primary_obs = prim, comparison_obs = comp)
  bas &lt;- sug_basis(penguin_xgb_shap, prim, comp)
  mv  &lt;- sug_manip_var(penguin_xgb_shap, primary_obs = prim, comp)
  ggt &lt;- radial_cheem_tour(peng_chm, basis = bas, manip_var = mv)
  animate_plotly(ggt)
}
</code></pre>

<hr>
<h2 id='chocolates_svm_pred'>Chocolate svm model predictions and shap values</h2><span id='topic+chocolates_svm_pred'></span><span id='topic+chocolates_svm_shap'></span>

<h3>Description</h3>

<p>Predictions and DALEX shap attribution of an svm model of Chocolate data
classifying type of chocolate (light/dark).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chocolates_svm_pred

chocolates_svm_shap
</code></pre>


<h3>Format</h3>

<p><code>chocolate_svm_pred</code> is a n=88 length vector of the prediction of an
svm model predicting the number of the factor level of the species of penguin.
<code>chocolate_svm_shap</code> is a (88 x 10) data frame of the DALEX SHAP attribution
of the svm model for each observation.
</p>
<p><strong>Replicating</strong>
</p>
<div class="sourceCode"><pre>library(cheem)
library(e1071)
library(DALEX)
set.seed(135)

## Classification setup
X    &lt;- chocolates[, 5:14]
Y    &lt;- chocolates$Type
clas &lt;- chocolates$Type

## Model and predict
choc_svm_fit &lt;- svm(
  formula = Y ~ ., data = data.frame(Y, X),
  type = 'C-classification', kernel = 'linear', probability = TRUE)
chocolates_svm_pred &lt;- predict(choc_svm_fit, data.frame(Y, X))

## SHAP via DALEX, versatile but slow
choc_svm_exp &lt;- explain(choc_svm_fit, data = X, y = Y,
                        label = "Chocolates, svm")
## Note that cheem expects a full [n, p] attribution space
## Shap takes about ~30-40 sec for me
chocolates_svm_shap &lt;- matrix(NA, nrow(X), ncol(X)) ## init a df of the same structure
sapply(1:nrow(X), function(i){
  pps &lt;- predict_parts_shap(choc_svm_exp, new_observation = X[i, ])
  ## Keep just the [n, p] local explanations
  chocolates_svm_shap[i, ] &lt;&lt;- tapply(
    pps$contribution, pps$variable, mean, na.rm = TRUE) %&gt;% as.vector()
})
chocolates_svm_shap &lt;- as.data.frame(chocolates_svm_shap)

if(F){ ## Don't accidentally save
  save(chocolates_svm_pred, file = "./data/chocolates_svm_pred.rda")
  save(chocolates_svm_shap, file = "./data/chocolates_svm_shap.rda")
  #usethis::use_data(chocolates_svm_pred)
  #usethis::use_data(chocolates_svm_shap)
}
</pre></div>
<p>An object of class <code>data.frame</code> with 88 rows and 10 columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

## Classification setup
X    &lt;- chocolates[, 5:14]
Y    &lt;- chocolates$Type
clas &lt;- chocolates$Type

## Precomputed predictions and shap attribution
str(chocolates_svm_pred)
str(chocolates_svm_shap)

## Cheem
choc_chm &lt;- cheem_ls(X, Y, chocolates_svm_shap,
                     chocolates_svm_pred, clas,
                     label = "Chocolates, SVM, shap")

## Save for use with shiny app (expects an rds file)
if(FALSE){ ## Don't accidentally save.
  saveRDS(choc_chm, "./cmh_chocolates_svm_shap.rds")
  run_app() ## Select the saved rds file from the data dropdown.
}

## Cheem visuals
if(interactive()){
  prim &lt;- 1
  comp &lt;- 2
  global_view(choc_chm, primary_obs = prim, comparison_obs = comp)
  bas &lt;- sug_basis(chocolates_svm_shap, prim, comp)
  mv  &lt;- sug_manip_var(chocolates_svm_shap, primary_obs = prim, comp)
  ggt &lt;- radial_cheem_tour(choc_chm, basis = bas, manip_var = mv)
  animate_plotly(ggt)
}
</code></pre>

<hr>
<h2 id='color_scale_of'>Suggest a color and fill scale.</h2><span id='topic+color_scale_of'></span><span id='topic+colour_scale_of'></span>

<h3>Description</h3>

<p>Whether or not a vector is a diverges a value, returns a logical.
Used to help default a scale_color for ggplot2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>color_scale_of(x, mid_pt = 0, limits = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="color_scale_of_+3A_x">x</code></td>
<td>
<p>A vector to to scale the color to.</p>
</td></tr>
<tr><td><code id="color_scale_of_+3A_mid_pt">mid_pt</code></td>
<td>
<p>A single number checking divergence from. Defaults to 0.</p>
</td></tr>
<tr><td><code id="color_scale_of_+3A_limits">limits</code></td>
<td>
<p>A vector of the min and max values for the scale.
Useful for setting an absolute range, such as (-1, 1) for attribution/y
correlation of each point. Points outside of limits show as default grey.
Defaults to NULL; the range of x.</p>
</td></tr>
<tr><td><code id="color_scale_of_+3A_...">...</code></td>
<td>
<p>Optional other arguments passed to ggplot2::continuous_scale
or ggplot2::discrete_scale.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing a scale_color, and scale_fill;
the suggested color/fill scale for a ggplot.
</p>


<h3>See Also</h3>

<p>Other cheem utility: 
<code><a href="#topic+as_logical_index">as_logical_index</a>()</code>,
<code><a href="#topic+contains_nonnumeric">contains_nonnumeric</a>()</code>,
<code><a href="#topic+is_discrete">is_discrete</a>()</code>,
<code><a href="#topic+is_diverging">is_diverging</a>()</code>,
<code><a href="#topic+linear_tform">linear_tform</a>()</code>,
<code><a href="#topic+logistic_tform">logistic_tform</a>()</code>,
<code><a href="#topic+problem_type">problem_type</a>()</code>,
<code><a href="#topic+rnorm_from">rnorm_from</a>()</code>,
<code><a href="#topic+sug_basis">sug_basis</a>()</code>,
<code><a href="#topic+sug_manip_var">sug_manip_var</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)
library(ggplot2)
g &lt;- ggplot(mtcars, aes(disp, mpg))

## Discrete
g + geom_point(aes(color = factor(vs))) +
  color_scale_of(mtcars$vs) 
## Sequential increasing
g + geom_point(aes(color = mpg)) +
  color_scale_of(mtcars$mpg)
## Dummy sequential decr
g + geom_point(aes(color = -1 *mpg)) +
  color_scale_of(-1 * mtcars$mpg)
## Dummy diverging
g + geom_point(aes(color = mpg - median(mpg))) +
  color_scale_of(mtcars$mpg - median(mtcars$mpg))
## Dummy limits
g + geom_point(aes(color = mpg - median(mpg))) +
  color_scale_of(mtcars$mpg - median(mtcars$mpg), limits = c(-5, 5))
</code></pre>

<hr>
<h2 id='contains_nonnumeric'>Check if a vector contains non-numeric character</h2><span id='topic+contains_nonnumeric'></span>

<h3>Description</h3>

<p>Returns a logical, whether or not a vector contains any non-numeric
characters. Typically used to test if row names hold non-index information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contains_nonnumeric(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contains_nonnumeric_+3A_x">x</code></td>
<td>
<p>A vector to be tested for existence of non-numeric characters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical, whether or not x contains any non-numeric characters.
</p>


<h3>See Also</h3>

<p>Other cheem utility: 
<code><a href="#topic+as_logical_index">as_logical_index</a>()</code>,
<code><a href="#topic+color_scale_of">color_scale_of</a>()</code>,
<code><a href="#topic+is_discrete">is_discrete</a>()</code>,
<code><a href="#topic+is_diverging">is_diverging</a>()</code>,
<code><a href="#topic+linear_tform">linear_tform</a>()</code>,
<code><a href="#topic+logistic_tform">logistic_tform</a>()</code>,
<code><a href="#topic+problem_type">problem_type</a>()</code>,
<code><a href="#topic+rnorm_from">rnorm_from</a>()</code>,
<code><a href="#topic+sug_basis">sug_basis</a>()</code>,
<code><a href="#topic+sug_manip_var">sug_manip_var</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

contains_nonnumeric(mtcars$mpg)
contains_nonnumeric(rownames(mtcars)) ## Meaningful info to use in tooltip
contains_nonnumeric(rownames(cars)) ## Assume no meaningful info to use in tooltip
</code></pre>

<hr>
<h2 id='devMessage'>Development message</h2><span id='topic+devMessage'></span>

<h3>Description</h3>

<p>Send a message if the 4th chunk of the package version is 9000.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>devMessage(text)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="devMessage_+3A_text">text</code></td>
<td>
<p>A character string to message() if package version is 9000.</p>
</td></tr>
</table>

<hr>
<h2 id='global_view'>Linked <code>plotly</code> display, global view of data and attribution space.</h2><span id='topic+global_view'></span>

<h3>Description</h3>

<p>from a cheem_ls() list, create a linked <code>plotly</code> of the global data-
and attribution- spaces. Typically consumed directly by shiny app.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>global_view(
  cheem_ls,
  primary_obs = NULL,
  comparison_obs = NULL,
  color = c("default", "residual", "log_maha.data", "cor_attr_proj.y"),
  height_px = 480,
  width_px = 1440,
  as_ggplot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="global_view_+3A_cheem_ls">cheem_ls</code></td>
<td>
<p>A return from <code>cheem_ls()</code>, a list of data frames.</p>
</td></tr>
<tr><td><code id="global_view_+3A_primary_obs">primary_obs</code></td>
<td>
<p>The rownumber of the primary observation. Its local
attribution becomes the 1d projection basis, and the point it highlighted
as a dashed line. Defaults to NULL, no highlighting applied.</p>
</td></tr>
<tr><td><code id="global_view_+3A_comparison_obs">comparison_obs</code></td>
<td>
<p>The rownumber of the comparison observation. Point
is highlighted as a dotted line. Defaults to NULL, no highlighting applied.</p>
</td></tr>
<tr><td><code id="global_view_+3A_color">color</code></td>
<td>
<p>The name of the column in cheem_ls$global_view_df to map to
color. Expects c(&quot;default&quot;, &quot;residual&quot;, &quot;log_maha.data&quot;, &quot;cor_attr_proj.y&quot;).
Defaults to &quot;default&quot;; predicted_class for classification, dummy class
for regression.</p>
</td></tr>
<tr><td><code id="global_view_+3A_height_px">height_px</code></td>
<td>
<p>The height in pixels of the returned <code>plotly</code> plot.
Defaults to 480, does nothing when <code>as_ggplot</code> is TRUE.</p>
</td></tr>
<tr><td><code id="global_view_+3A_width_px">width_px</code></td>
<td>
<p>The width in pixels of the returned <code>plotly</code> plot.
Defaults to 1440, does nothing when <code>as_ggplot</code> is TRUE.</p>
</td></tr>
<tr><td><code id="global_view_+3A_as_ggplot">as_ggplot</code></td>
<td>
<p>Logical, if TRUE returns the plots before being passed to
<code>plotly</code> functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>plotly</code> plot, an interactive html widget of the global view,
first two components of the basis of the data- and attribution- spaces.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_app">run_app()</a></code>
</p>
<p>Other cheem consumers: 
<code><a href="#topic+global_view_legwork">global_view_legwork</a>()</code>,
<code><a href="#topic+radial_cheem_tour">radial_cheem_tour</a>()</code>,
<code><a href="#topic+run_app">run_app</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

## Regression setup:
dat  &lt;- amesHousing2018_NorthAmes
X    &lt;- dat[, 1:9]
Y    &lt;- dat$SalePrice
clas &lt;- dat$SubclassMS

## global_view()
ames_rf_chm &lt;- cheem_ls(X, Y, ames_rf_shap, ames_rf_pred, clas,
                        label = "North Ames, RF, SHAP")
if(interactive()){
  global_view(ames_rf_chm, as_ggplot = TRUE) ## early return of ggplot
  global_view(ames_rf_chm) ## uses ggplot facets %&gt;% plotly

  ## Different color mappings, especially for regression
  global_view(ames_rf_chm, color = "residual")
  global_view(ames_rf_chm, color = "log_maha.data")
  global_view(ames_rf_chm, color = "cor_attr_proj.y")
}
## Also consumed by: ?run_app()
</code></pre>

<hr>
<h2 id='global_view_df_1layer'>Create the plot data.frame for the global linked plotly display.</h2><span id='topic+global_view_df_1layer'></span>

<h3>Description</h3>

<p>Internal function consumed in the cheem workflow.
Produces the plot data.frame of 1 layer. consumed downstream in cheem_ls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>global_view_df_1layer(x, class = NULL, label = "label")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="global_view_df_1layer_+3A_x">x</code></td>
<td>
<p>The explanatory variables of the model.</p>
</td></tr>
<tr><td><code id="global_view_df_1layer_+3A_class">class</code></td>
<td>
<p>Optional, (n, 1) vector, a variable to group points by.
This can be the same as or different from <code>y</code>, the target variable.</p>
</td></tr>
<tr><td><code id="global_view_df_1layer_+3A_label">label</code></td>
<td>
<p>Optionally provide a character label to store reminder
text for the type of model and local explanation used.
Defaults to &quot;label&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame, for the global linked <strong>plotly</strong> display.
</p>

<hr>
<h2 id='global_view_legwork'>The legwork behind the scenes for the global view</h2><span id='topic+global_view_legwork'></span>

<h3>Description</h3>

<p>Not meant for end user. This is an internal legwork function to
keep from repeating global_view code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>global_view_legwork(
  cheem_ls,
  primary_obs = NULL,
  comparison_obs = NULL,
  color = c("default", "residual", "log_maha.data", "cor_attr_proj.y")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="global_view_legwork_+3A_cheem_ls">cheem_ls</code></td>
<td>
<p>A return from <code>cheem_ls()</code>, a list of data frames.</p>
</td></tr>
<tr><td><code id="global_view_legwork_+3A_primary_obs">primary_obs</code></td>
<td>
<p>The rownumber of the primary observation. Its local
attribution becomes the 1d projection basis, and the point it highlighted
as a dashed line. Defaults to NULL, no highlighting applied.</p>
</td></tr>
<tr><td><code id="global_view_legwork_+3A_comparison_obs">comparison_obs</code></td>
<td>
<p>The rownumber of the comparison observation. Point
is highlighted as a dotted line. Defaults to NULL, no highlighting applied.</p>
</td></tr>
<tr><td><code id="global_view_legwork_+3A_color">color</code></td>
<td>
<p>The name of the column in cheem_ls$global_view_df to map to
color. Expects c(&quot;default&quot;, &quot;residual&quot;, &quot;log_maha.data&quot;, &quot;cor_attr_proj.y&quot;).
Defaults to &quot;default&quot;; predicted_class for classification, dummy class
for regression.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot2</code> object, waiting to be rendered with <code>global_view</code> or
<code>global_view_subplots</code>.
</p>


<h3>See Also</h3>

<p>Other cheem consumers: 
<code><a href="#topic+global_view">global_view</a>()</code>,
<code><a href="#topic+radial_cheem_tour">radial_cheem_tour</a>()</code>,
<code><a href="#topic+run_app">run_app</a>()</code>
</p>

<hr>
<h2 id='ifDev'>Evaluate if development</h2><span id='topic+ifDev'></span>

<h3>Description</h3>

<p>Evaluate the expression if the 4th chunk of the package version is 9000.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ifDev(expr)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ifDev_+3A_expr">expr</code></td>
<td>
<p>A character string to message() if package version is 9000.</p>
</td></tr>
</table>

<hr>
<h2 id='is_discrete'>Check if a vector is discrete</h2><span id='topic+is_discrete'></span>

<h3>Description</h3>

<p>Whether or not a vector is a discrete variable, returns a logical.
Typically used on the Y variable of a model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_discrete(x, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_discrete_+3A_x">x</code></td>
<td>
<p>A vector to check the discreteness of.</p>
</td></tr>
<tr><td><code id="is_discrete_+3A_na.rm">na.rm</code></td>
<td>
<p>Whether or not to remove NA values before testing discreteness.
Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical, whether or not <code>x</code> is a discrete variable.
</p>


<h3>See Also</h3>

<p>Other cheem utility: 
<code><a href="#topic+as_logical_index">as_logical_index</a>()</code>,
<code><a href="#topic+color_scale_of">color_scale_of</a>()</code>,
<code><a href="#topic+contains_nonnumeric">contains_nonnumeric</a>()</code>,
<code><a href="#topic+is_diverging">is_diverging</a>()</code>,
<code><a href="#topic+linear_tform">linear_tform</a>()</code>,
<code><a href="#topic+logistic_tform">logistic_tform</a>()</code>,
<code><a href="#topic+problem_type">problem_type</a>()</code>,
<code><a href="#topic+rnorm_from">rnorm_from</a>()</code>,
<code><a href="#topic+sug_basis">sug_basis</a>()</code>,
<code><a href="#topic+sug_manip_var">sug_manip_var</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

is_discrete(mtcars$mpg) ## Numeric column, with more than 25 unique values.
is_discrete(mtcars$cyl) ## Numeric column, labeled as discrete, because less than 25 unique values
is_discrete(letters)    ## Characters and factors labeled discrete.
</code></pre>

<hr>
<h2 id='is_diverging'>Check if a vector diverges a value</h2><span id='topic+is_diverging'></span>

<h3>Description</h3>

<p>Whether or not a vector is a diverges a value, returns a logical.
Used to help default a scale_color for ggplot2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_diverging(x, mid_pt = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_diverging_+3A_x">x</code></td>
<td>
<p>A vector to check the divergence of.</p>
</td></tr>
<tr><td><code id="is_diverging_+3A_mid_pt">mid_pt</code></td>
<td>
<p>A single number checking divergence from. Defaults to 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical, whether or not <code>x</code> is a diverges <code>mid_pt</code>.
</p>


<h3>See Also</h3>

<p>Other cheem utility: 
<code><a href="#topic+as_logical_index">as_logical_index</a>()</code>,
<code><a href="#topic+color_scale_of">color_scale_of</a>()</code>,
<code><a href="#topic+contains_nonnumeric">contains_nonnumeric</a>()</code>,
<code><a href="#topic+is_discrete">is_discrete</a>()</code>,
<code><a href="#topic+linear_tform">linear_tform</a>()</code>,
<code><a href="#topic+logistic_tform">logistic_tform</a>()</code>,
<code><a href="#topic+problem_type">problem_type</a>()</code>,
<code><a href="#topic+rnorm_from">rnorm_from</a>()</code>,
<code><a href="#topic+sug_basis">sug_basis</a>()</code>,
<code><a href="#topic+sug_manip_var">sug_manip_var</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

is_diverging(-10:10)
is_diverging(-10:-5)
is_diverging(mtcars$mpg, 25)
is_diverging(mtcars$mpg, 40)
</code></pre>

<hr>
<h2 id='linear_tform'>Linear function to help set alpha opacity</h2><span id='topic+linear_tform'></span>

<h3>Description</h3>

<p>Suggests a alpha opacity to plot with as a function of the number of
observation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linear_tform(n, appox_max_n = 5000, ceiling = 1, floor = 0.3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="linear_tform_+3A_n">n</code></td>
<td>
<p>Number of observations to plot.</p>
</td></tr>
<tr><td><code id="linear_tform_+3A_appox_max_n">appox_max_n</code></td>
<td>
<p>The number of observation to reach floor opacity.</p>
</td></tr>
<tr><td><code id="linear_tform_+3A_ceiling">ceiling</code></td>
<td>
<p>The highest number returned. Defaults to 1.</p>
</td></tr>
<tr><td><code id="linear_tform_+3A_floor">floor</code></td>
<td>
<p>The lowest number returned. Defaults to 0.3.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A scalar numeric, suggested value to set alpha opacity.
</p>


<h3>See Also</h3>

<p>Other cheem utility: 
<code><a href="#topic+as_logical_index">as_logical_index</a>()</code>,
<code><a href="#topic+color_scale_of">color_scale_of</a>()</code>,
<code><a href="#topic+contains_nonnumeric">contains_nonnumeric</a>()</code>,
<code><a href="#topic+is_discrete">is_discrete</a>()</code>,
<code><a href="#topic+is_diverging">is_diverging</a>()</code>,
<code><a href="#topic+logistic_tform">logistic_tform</a>()</code>,
<code><a href="#topic+problem_type">problem_type</a>()</code>,
<code><a href="#topic+rnorm_from">rnorm_from</a>()</code>,
<code><a href="#topic+sug_basis">sug_basis</a>()</code>,
<code><a href="#topic+sug_manip_var">sug_manip_var</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

## Suggest an opacity to use in plotting:
(my_alpha &lt;- linear_tform(nrow(spinifex::penguins_na.rm)))

## Visualize
x &lt;- 1:2000
plot(x, sapply(x, linear_tform), col = "blue")
</code></pre>

<hr>
<h2 id='logistic_tform'>Logistic function to help set alpha opacity</h2><span id='topic+logistic_tform'></span>

<h3>Description</h3>

<p>Suggests a alpha opacity to plot with as a function of the number of
observation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logistic_tform(n, mid_pt = 600, k_attenuation = 5, ceiling = 1, floor = 0.3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logistic_tform_+3A_n">n</code></td>
<td>
<p>Number of observations to plot.</p>
</td></tr>
<tr><td><code id="logistic_tform_+3A_mid_pt">mid_pt</code></td>
<td>
<p>Inflection point that the logistic curve. Defaults to 600.</p>
</td></tr>
<tr><td><code id="logistic_tform_+3A_k_attenuation">k_attenuation</code></td>
<td>
<p>The steepness of the transition, larger is a sharper
transition. Quite sensitive and defaults to 5.</p>
</td></tr>
<tr><td><code id="logistic_tform_+3A_ceiling">ceiling</code></td>
<td>
<p>The highest number returned. Defaults to 1.</p>
</td></tr>
<tr><td><code id="logistic_tform_+3A_floor">floor</code></td>
<td>
<p>The lowest number returned. Defaults to 0.3.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A scalar numeric, suggested value to set alpha opacity.
</p>


<h3>See Also</h3>

<p>Other cheem utility: 
<code><a href="#topic+as_logical_index">as_logical_index</a>()</code>,
<code><a href="#topic+color_scale_of">color_scale_of</a>()</code>,
<code><a href="#topic+contains_nonnumeric">contains_nonnumeric</a>()</code>,
<code><a href="#topic+is_discrete">is_discrete</a>()</code>,
<code><a href="#topic+is_diverging">is_diverging</a>()</code>,
<code><a href="#topic+linear_tform">linear_tform</a>()</code>,
<code><a href="#topic+problem_type">problem_type</a>()</code>,
<code><a href="#topic+rnorm_from">rnorm_from</a>()</code>,
<code><a href="#topic+sug_basis">sug_basis</a>()</code>,
<code><a href="#topic+sug_manip_var">sug_manip_var</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

## Suggest an opacity to use in plotting:
(my_alpha &lt;- logistic_tform(nrow(spinifex::penguins_na.rm)))

## Visualize
x &lt;- 1:2000
plot(x, logistic_tform(x), col = "blue")
</code></pre>

<hr>
<h2 id='model_performance'>Extract higher level model performance statistics</h2><span id='topic+model_performance'></span>

<h3>Description</h3>

<p>Internal function, used downstream in cheem_ls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_performance(y, pred, label = "label")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="model_performance_+3A_y">y</code></td>
<td>
<p>Observed response, required by ranger models.</p>
</td></tr>
<tr><td><code id="model_performance_+3A_pred">pred</code></td>
<td>
<p>A (n, 1) vector of the predicted values for each observation.
Typically obtainable with <code>stats::predict()</code>. Exact syntax and arguments
may change across model types.</p>
</td></tr>
<tr><td><code id="model_performance_+3A_label">label</code></td>
<td>
<p>Optionally provide a character label to store reminder
text for the type of model and local explanation used.
Defaults to &quot;label&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame of model performance statistics.
</p>

<hr>
<h2 id='penguin_xgb_pred'>Penguins xgb model predictions and shap values</h2><span id='topic+penguin_xgb_pred'></span><span id='topic+penguin_xgb_shap'></span>

<h3>Description</h3>

<p>Predictions and shapviz attribution of an xgb model of Penguin data
classifying penguin species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>penguin_xgb_pred

penguin_xgb_shap
</code></pre>


<h3>Format</h3>

<p><code>penguin_xgb_pred</code> is a n=333 length vector of the prediction of an
xgb model predicting the number of the factor level of the species of penguin.
<code>penguin_xgb_shap</code> is a (333 x 4) data frame of the shapviz SHAP attribution of
the xgb model for each observation.
</p>
<p><strong>Replicating</strong>
</p>
<div class="sourceCode"><pre>library(cheem)
library(xgboost)
library(shapviz)
set.seed(135)

## Classification setup
X    &lt;- spinifex::penguins_na.rm[, 1:4]
Y    &lt;- spinifex::penguins_na.rm$species
clas &lt;- spinifex::penguins_na.rm$species

## Model and predict
peng_train    &lt;- data.matrix(X) %&gt;%
  xgb.DMatrix(label = Y)
peng_xgb_fit  &lt;- xgboost(data = peng_train, max.depth = 3, nrounds = 5)
penguin_xgb_pred &lt;- predict(peng_xgb_fit, newdata = peng_train)

## shapviz
penguin_xgb_shap &lt;- shapviz(peng_xgb_fit, X_pred = peng_train, X = X)
penguin_xgb_shap &lt;- penguin_xgb_shap$S

if(F){ ## Don't accidentally save
  save(penguin_xgb_pred, file = "./data/penguin_xgb_pred.rda")
  save(penguin_xgb_shap, file = "./data/penguin_xgb_shap.rda")
  #usethis::use_data(penguin_xgb_pred)
  #usethis::use_data(penguin_xgb_shap)
}
</pre></div>
<p>An object of class <code>matrix</code> (inherits from <code>array</code>) with 333 rows and 4 columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

## Classification setup
X    &lt;- spinifex::penguins_na.rm[, 1:4]
Y    &lt;- spinifex::penguins_na.rm$species
clas &lt;- spinifex::penguins_na.rm$species

## Precomputed predictions and shap attribtion
str(penguin_xgb_pred)
str(penguin_xgb_shap)

## Cheem
peng_chm &lt;- cheem_ls(X, Y, penguin_xgb_shap, penguin_xgb_pred, clas,
                     label = "Penguins, xgb, shapviz")

## Save for use with shiny app (expects an rds file)
if(FALSE){ ## Don't accidentally save.
  saveRDS(peng_chm, "./chm_peng_xgb_shapviz.rds")
  run_app() ## Select the saved rds file from the data dropdown.
}

## Cheem visuals
if(interactive()){
  prim &lt;- 1
  comp &lt;- 2
  global_view(peng_chm, primary_obs = prim, comparison_obs = comp)
  bas &lt;- sug_basis(penguin_xgb_shap, prim, comp)
  mv  &lt;- sug_manip_var(penguin_xgb_shap, primary_obs = prim, comp)
  ggt &lt;- radial_cheem_tour(peng_chm, basis = bas, manip_var = mv)
  animate_plotly(ggt)
}
</code></pre>

<hr>
<h2 id='problem_type'>The type of model for a given Y variable</h2><span id='topic+problem_type'></span>

<h3>Description</h3>

<p>Whether the Y is a &quot;classification&quot;, &quot;regression&quot; or ill-defined problem.
Returns a character: &quot;classification&quot;, &quot;regression&quot;, or an error for strange
classes. Minor redundancy with is_discrete, though explicit. Could be useful
for <code>DALEX::explain(type)</code> as it also expects &quot;classification&quot; or
&quot;regression&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>problem_type(y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="problem_type_+3A_y">y</code></td>
<td>
<p>Response variable to be modeled</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character either c(&quot;classification&quot;, &quot;regression&quot;) specifying the
assumed model task based on the discreteness of y.
</p>


<h3>See Also</h3>

<p>Other cheem utility: 
<code><a href="#topic+as_logical_index">as_logical_index</a>()</code>,
<code><a href="#topic+color_scale_of">color_scale_of</a>()</code>,
<code><a href="#topic+contains_nonnumeric">contains_nonnumeric</a>()</code>,
<code><a href="#topic+is_discrete">is_discrete</a>()</code>,
<code><a href="#topic+is_diverging">is_diverging</a>()</code>,
<code><a href="#topic+linear_tform">linear_tform</a>()</code>,
<code><a href="#topic+logistic_tform">logistic_tform</a>()</code>,
<code><a href="#topic+rnorm_from">rnorm_from</a>()</code>,
<code><a href="#topic+sug_basis">sug_basis</a>()</code>,
<code><a href="#topic+sug_manip_var">sug_manip_var</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

problem_type(mtcars$mpg) ## Numeric, many values
problem_type(mtcars$cyl) ## Numeric column, labeled as discrete, because less than 25 unique values
problem_type(letters) ## Character to classification
problem_type(factor(letters)) ## Factor to classification
</code></pre>

<hr>
<h2 id='proto_basis1d_distribution'>Adds the distribution of the row local attributions to a ggtour</h2><span id='topic+proto_basis1d_distribution'></span>

<h3>Description</h3>

<p>A <code>spinifex</code> proto_*-like function, that adds the distribution of
orthonormalized row values of the specified local explanation <code>attr_df</code>.
Does not draw the basis bars; use in conjunction with <code>proto_basis1d()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>proto_basis1d_distribution(
  attr_df,
  primary_obs = NULL,
  comparison_obs = NULL,
  position = c("top1d", "floor1d", "bottom1d", "off"),
  group_by = as.factor(FALSE),
  pcp_shape = c(3, 142, 124),
  do_add_pcp_segments = TRUE,
  inc_var_nms = NULL,
  row_index = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="proto_basis1d_distribution_+3A_attr_df">attr_df</code></td>
<td>
<p>An data frame, the attributions of a local explanation.</p>
</td></tr>
<tr><td><code id="proto_basis1d_distribution_+3A_primary_obs">primary_obs</code></td>
<td>
<p>The rownumber of the primary observation. Its local
attribution becomes the 1d projection basis, and the point it highlighted
as a dashed line. Defaults to NULL, no highlighting.</p>
</td></tr>
<tr><td><code id="proto_basis1d_distribution_+3A_comparison_obs">comparison_obs</code></td>
<td>
<p>The rownumber of the comparison observation. Point
is highlighted as a dotted line. Defaults to NULL, no highlighting.</p>
</td></tr>
<tr><td><code id="proto_basis1d_distribution_+3A_position">position</code></td>
<td>
<p>The position for the basis, one of: c(&quot;top1d&quot;, &quot;floor1d&quot;,
&quot;bottom1d&quot;, &quot;off&quot;).
Defaults to &quot;top1d&quot;; basis above the density curves.</p>
</td></tr>
<tr><td><code id="proto_basis1d_distribution_+3A_group_by">group_by</code></td>
<td>
<p>Vector to group densities by. Originally <em>predicted</em> class.</p>
</td></tr>
<tr><td><code id="proto_basis1d_distribution_+3A_pcp_shape">pcp_shape</code></td>
<td>
<p>The number of the shape character to add. Expects
3, 142, or 124, '+', '|' in <code>plotly</code>, and '|' in <code>gganimate</code>, respectively.
Defaults to 3, '+' in either output.</p>
</td></tr>
<tr><td><code id="proto_basis1d_distribution_+3A_do_add_pcp_segments">do_add_pcp_segments</code></td>
<td>
<p>Logical, whether or not to add to add faint
parallel coordinate lines on the 1D basis. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="proto_basis1d_distribution_+3A_inc_var_nms">inc_var_nms</code></td>
<td>
<p>A character vector, the names of the variables to keep.
Defaults to NULL, all variables kept.</p>
</td></tr>
<tr><td><code id="proto_basis1d_distribution_+3A_row_index">row_index</code></td>
<td>
<p>A numeric or logical vector, the index of the rows to keep.
Defaults to NULL, all rows kept.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object of the the distribution of the local explanation's
attributions.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+radial_cheem_tour">radial_cheem_tour()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)
library(spinifex)

## Regression setup
dat  &lt;- amesHousing2018_NorthAmes
X    &lt;- dat[, 1:9]
Y    &lt;- dat$SalePrice
clas &lt;- dat$SubclassMS

## Basis, manipulation var, manual tour path, &amp; predictions to fix to y-axis
bas     &lt;- sug_basis(ames_rf_shap, 1)
mv      &lt;- sug_manip_var(ames_rf_shap, 1, 2)
mt_path &lt;- manual_tour(bas, mv)
## Also consumed by: ?radial_cheem_tour()

## Compose and animate the tour
ggt &lt;- ggtour(mt_path, scale_sd(X), angle = .3) +
  append_fixed_y(fixed_y = scale_sd(Y)) +
  proto_point(list(color = clas, shape = clas)) +
  proto_basis1d_distribution(
    attr_df = ames_rf_shap,
    primary_obs = 1, comparison_obs = 2,
    position = "top1d", group_by = clas) +
  proto_basis1d(position = "bottom1d") +
  proto_origin()

if(interactive()){
  animate_plotly(ggt)
}
</code></pre>

<hr>
<h2 id='radial_cheem_tour'>Cheem tour; 1D manual tour on the selected attribution</h2><span id='topic+radial_cheem_tour'></span>

<h3>Description</h3>

<p>Create a linked <code>plotly</code>of the global data-
and attribution- spaces. Typically consumed directly by shiny app.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>radial_cheem_tour(
  cheem_ls,
  basis,
  manip_var,
  primary_obs = NULL,
  comparison_obs = NULL,
  do_add_pcp_segments = TRUE,
  pcp_shape = c(3, 142, 124),
  angle = 0.15,
  row_index = NULL,
  inc_var_nms = NULL,
  do_center_frame = TRUE,
  do_add_residual = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="radial_cheem_tour_+3A_cheem_ls">cheem_ls</code></td>
<td>
<p>A return from <code>cheem_ls()</code>, a list of data frames.</p>
</td></tr>
<tr><td><code id="radial_cheem_tour_+3A_basis">basis</code></td>
<td>
<p>A 1D projection basis, typically a return of
<code>sug_basis()</code>.</p>
</td></tr>
<tr><td><code id="radial_cheem_tour_+3A_manip_var">manip_var</code></td>
<td>
<p>The , <em>number</em> of the manipulation variable.</p>
</td></tr>
<tr><td><code id="radial_cheem_tour_+3A_primary_obs">primary_obs</code></td>
<td>
<p>The rownumber of the primary observation. Its local
attribution becomes the 1d projection basis, and the point it highlighted
as a dashed line. Defaults to NULL, no primary observation highlighted.</p>
</td></tr>
<tr><td><code id="radial_cheem_tour_+3A_comparison_obs">comparison_obs</code></td>
<td>
<p>The rownumber of the comparison observation. Point
is highlighted as a dotted line. Defaults to NULL,
no comparison observation highlighted.</p>
</td></tr>
<tr><td><code id="radial_cheem_tour_+3A_do_add_pcp_segments">do_add_pcp_segments</code></td>
<td>
<p>Logical, whether or not to add parallel coordinate
line segments to the basis display.</p>
</td></tr>
<tr><td><code id="radial_cheem_tour_+3A_pcp_shape">pcp_shape</code></td>
<td>
<p>The number of the shape character to add. Expects
3, 142, or 124, '+', '|' in <code>plotly</code>, and '|' in <code>gganimate</code>, respectively.
Defaults to 3, '+' in either output.</p>
</td></tr>
<tr><td><code id="radial_cheem_tour_+3A_angle">angle</code></td>
<td>
<p>The step size between interpolated frames, in radians.
Defaults to .15.</p>
</td></tr>
<tr><td><code id="radial_cheem_tour_+3A_row_index">row_index</code></td>
<td>
<p>Numeric index of selected observations.
Defaults to TRUE; 1:n.</p>
</td></tr>
<tr><td><code id="radial_cheem_tour_+3A_inc_var_nms">inc_var_nms</code></td>
<td>
<p>A vector of the names of the variables to include in the
projection.</p>
</td></tr>
<tr><td><code id="radial_cheem_tour_+3A_do_center_frame">do_center_frame</code></td>
<td>
<p>Whether or not to scale by standard deviations away
from the mean within each frame or not.
Defaults to TRUE, helping to keep the animation centered.</p>
</td></tr>
<tr><td><code id="radial_cheem_tour_+3A_do_add_residual">do_add_residual</code></td>
<td>
<p>Whether of not to add a facet with a fixed y on
residual. Doing so may cause issues with animation. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggtour (<code>ggplot2</code> object with frame info) animation frames of a
radial tour manipulating the contribution of a selected tour. Animated with
<code style="white-space: pre;">&#8288;spinifex::animate_*&#8288;</code> functions.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_app">run_app()</a></code>
</p>
<p>Other cheem consumers: 
<code><a href="#topic+global_view_legwork">global_view_legwork</a>()</code>,
<code><a href="#topic+global_view">global_view</a>()</code>,
<code><a href="#topic+run_app">run_app</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

## Regression setup:
dat  &lt;- amesHousing2018_NorthAmes
X    &lt;- dat[, 1:9]
Y    &lt;- dat$SalePrice
clas &lt;- dat$SubclassMS

## radial_cheem_tour()
ames_rf_chm &lt;- cheem_ls(X, Y, ames_rf_shap, ames_rf_pred, clas,
                        label = "North Ames, RF, SHAP")
bas &lt;- sug_basis(ames_rf_shap, 1)
mv  &lt;- sug_manip_var(ames_rf_shap, 1, 2)
ggt &lt;- radial_cheem_tour(ames_rf_chm, basis = bas, manip_var = mv)
if(interactive()){
  ## As a plotly html widget
  spinifex::animate_plotly(ggt)
  
  ## As a gganimation
  spinifex::animate_gganimate(ggt, render = gganimate::av_renderer())
}
## Also used in: ?run_app()
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>magrittr</dt><dd><p><code><a href="magrittr.html#topic+pipe">%&gt;%</a></code></p>
</dd>
</dl>

<hr>
<h2 id='rnorm_from'>Draw new samples from the supplied data given its mean and covariances.</h2><span id='topic+rnorm_from'></span>

<h3>Description</h3>

<p>Creates new observation of the data given its specific means and shapes.
typically applied to a cluster subset of data. <em>ie</em> draw from cluster 'a',
then assign to cluster 'b'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rnorm_from(
  data,
  n_obs = 1,
  var_coeff = 1,
  method = c("pearson", "kendall", "spearman")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rnorm_from_+3A_data">data</code></td>
<td>
<p>A data.frame or matrix to sample from.</p>
</td></tr>
<tr><td><code id="rnorm_from_+3A_n_obs">n_obs</code></td>
<td>
<p>Number of new observations to draw. Defaults to 1.</p>
</td></tr>
<tr><td><code id="rnorm_from_+3A_var_coeff">var_coeff</code></td>
<td>
<p>Variance coefficient, closer to 0 make points near the
median, above 1 makes more points further away from the median.
Defaults to 1.</p>
</td></tr>
<tr><td><code id="rnorm_from_+3A_method">method</code></td>
<td>
<p>The method of the covariance matrix. Expects &quot;person&quot;
(continuous numeric), &quot;kendall&quot; or &quot;spearman&quot;
(latter two are ranked based ordinal).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame, sampled observations given the means and covariance of
the data based on with column names kept.
</p>


<h3>See Also</h3>

<p>Other cheem utility: 
<code><a href="#topic+as_logical_index">as_logical_index</a>()</code>,
<code><a href="#topic+color_scale_of">color_scale_of</a>()</code>,
<code><a href="#topic+contains_nonnumeric">contains_nonnumeric</a>()</code>,
<code><a href="#topic+is_discrete">is_discrete</a>()</code>,
<code><a href="#topic+is_diverging">is_diverging</a>()</code>,
<code><a href="#topic+linear_tform">linear_tform</a>()</code>,
<code><a href="#topic+logistic_tform">logistic_tform</a>()</code>,
<code><a href="#topic+problem_type">problem_type</a>()</code>,
<code><a href="#topic+sug_basis">sug_basis</a>()</code>,
<code><a href="#topic+sug_manip_var">sug_manip_var</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

sub &lt;- mtcars[mtcars$cyl == 6, ]
## Draw 3 new observations in the shape of 6 cylinder vehicles, with reduced variance.
rnorm_from(data = sub, n_obs = 3, var_coeff = .5)
</code></pre>

<hr>
<h2 id='run_app'>Runs a shiny app demonstrating manual tours</h2><span id='topic+run_app'></span>

<h3>Description</h3>

<p>Runs a local shiny app that demonstrates manual tour and comparable
traditional techniques for static projections of multivariate data sets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_app(app_nm = "cheem", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_app_+3A_app_nm">app_nm</code></td>
<td>
<p>Name of the shiny app to run. Expects &quot;cheem_initial&quot;.</p>
</td></tr>
<tr><td><code id="run_app_+3A_...">...</code></td>
<td>
<p>Other arguments passed into <code>shiny::runApp()</code>.
Such as display.mode = &quot;showcase&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Runs a locally hosted shiny app.
</p>


<h3>See Also</h3>

<p>Other cheem consumers: 
<code><a href="#topic+global_view_legwork">global_view_legwork</a>()</code>,
<code><a href="#topic+global_view">global_view</a>()</code>,
<code><a href="#topic+radial_cheem_tour">radial_cheem_tour</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Only run this example in interactive R sessions
if(interactive()){
  ## Runs the app
  run_app("cheem")
  
  ## Run with app code displayed
  run_app(app_nm = "cheem", display.mode = "showcase")
}
</code></pre>

<hr>
<h2 id='subset_cheem'>Subset a cheem list</h2><span id='topic+subset_cheem'></span>

<h3>Description</h3>

<p>Given a numerical index of rownumbers of the original data, subset the
correct elements of a cheem list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subset_cheem(cheem_ls, rownumbers = 1:500)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="subset_cheem_+3A_cheem_ls">cheem_ls</code></td>
<td>
<p>The return of a <code>cheem_ls()</code> call.</p>
</td></tr>
<tr><td><code id="subset_cheem_+3A_rownumbers">rownumbers</code></td>
<td>
<p>A vector of the numeric index of rownumbers to keep.
To use a logical index, pass it to <code>which()</code>,
eg. <code>idx &lt;- which(mtcars$mpg &gt; 30)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A subset of the supplied cheem_ls.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cheem_ls">cheem_ls()</a></code>
</p>
<p>Other cheem preprocessing: 
<code><a href="#topic+cheem_ls">cheem_ls</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

## Classification setup
X    &lt;- spinifex::penguins_na.rm[, 1:4]
Y    &lt;- spinifex::penguins_na.rm$species
clas &lt;- spinifex::penguins_na.rm$species

## Cheem
peng_chm &lt;- cheem_ls(X, Y, penguin_xgb_shap, penguin_xgb_pred, clas,
                     label = "Penguins, xgb, shapviz")
lapply(peng_chm, NROW)

## subset a cheem list
num_idx &lt;- which(spinifex::penguins_na.rm$flipper_length_mm &gt; 185)
peng_chm_sub &lt;- subset_cheem(peng_chm, num_idx)
lapply(peng_chm_sub, NROW)
## Notice that $global_view_df and $decode_df have fewer rows.
</code></pre>

<hr>
<h2 id='sug_basis'>Suggest a 1D Basis</h2><span id='topic+sug_basis'></span>

<h3>Description</h3>

<p>Extract and formats the 1D attribution basis from
the provided local explanation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sug_basis(attr_df, rownum)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sug_basis_+3A_attr_df">attr_df</code></td>
<td>
<p>A data frame of local explanation attributions.</p>
</td></tr>
<tr><td><code id="sug_basis_+3A_rownum">rownum</code></td>
<td>
<p>The rownumber of the observation.
Typically primary or comparison observations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of the 1D basis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+radial_cheem_tour">radial_cheem_tour()</a></code>
</p>
<p>Other cheem utility: 
<code><a href="#topic+as_logical_index">as_logical_index</a>()</code>,
<code><a href="#topic+color_scale_of">color_scale_of</a>()</code>,
<code><a href="#topic+contains_nonnumeric">contains_nonnumeric</a>()</code>,
<code><a href="#topic+is_discrete">is_discrete</a>()</code>,
<code><a href="#topic+is_diverging">is_diverging</a>()</code>,
<code><a href="#topic+linear_tform">linear_tform</a>()</code>,
<code><a href="#topic+logistic_tform">logistic_tform</a>()</code>,
<code><a href="#topic+problem_type">problem_type</a>()</code>,
<code><a href="#topic+rnorm_from">rnorm_from</a>()</code>,
<code><a href="#topic+sug_manip_var">sug_manip_var</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

## Attribution basis of the primary instance
sug_basis(ames_rf_shap, rownum = 1)


## This can be used to find a basis to start the radial tour.
# ?radial_cheem_tour

## Regression setup:
dat  &lt;- amesHousing2018_NorthAmes
X    &lt;- dat[, 1:9]
Y    &lt;- dat$SalePrice
clas &lt;- dat$SubclassMS

## radial_cheem_tour()
ames_rf_chm &lt;- cheem_ls(X, Y, ames_rf_shap, ames_rf_pred, clas,
                        label = "North Ames, RF, SHAP")
bas &lt;- sug_basis(ames_rf_shap, 1)
mv  &lt;- sug_manip_var(ames_rf_shap, 1, 2)
ggt &lt;- radial_cheem_tour(ames_rf_chm, basis = bas, manip_var = mv)
if(interactive()){
  ## As a plotly html widget
  spinifex::animate_plotly(ggt)
  
  ## As a gganimation
  spinifex::animate_gganimate(ggt, render = gganimate::av_renderer())
}
## radial_cheem_tour is also used in: ?run_app()
</code></pre>

<hr>
<h2 id='sug_manip_var'>Suggest a manipulation variable</h2><span id='topic+sug_manip_var'></span>

<h3>Description</h3>

<p>Suggest the number of the variable with the largest difference in attribution
between the primary and comparison observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sug_manip_var(attr_df, primary_obs, comparison_obs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sug_manip_var_+3A_attr_df">attr_df</code></td>
<td>
<p>A data frame of local explanation attributions.</p>
</td></tr>
<tr><td><code id="sug_manip_var_+3A_primary_obs">primary_obs</code></td>
<td>
<p>The rownumber of the primary observation. Its local
attribution becomes the 1d projection basis, and the point it highlighted
as a dashed line.</p>
</td></tr>
<tr><td><code id="sug_manip_var_+3A_comparison_obs">comparison_obs</code></td>
<td>
<p>The rownumber of the comparison observation. Point
is highlighted as a dotted line.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single number of the variable with the largest difference of
attribution (basis) variables.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+radial_cheem_tour">radial_cheem_tour()</a></code>
</p>
<p>Other cheem utility: 
<code><a href="#topic+as_logical_index">as_logical_index</a>()</code>,
<code><a href="#topic+color_scale_of">color_scale_of</a>()</code>,
<code><a href="#topic+contains_nonnumeric">contains_nonnumeric</a>()</code>,
<code><a href="#topic+is_discrete">is_discrete</a>()</code>,
<code><a href="#topic+is_diverging">is_diverging</a>()</code>,
<code><a href="#topic+linear_tform">linear_tform</a>()</code>,
<code><a href="#topic+logistic_tform">logistic_tform</a>()</code>,
<code><a href="#topic+problem_type">problem_type</a>()</code>,
<code><a href="#topic+rnorm_from">rnorm_from</a>()</code>,
<code><a href="#topic+sug_basis">sug_basis</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cheem)

## Regression setup
dat  &lt;- amesHousing2018_NorthAmes
X    &lt;- dat[, 1:9]
Y    &lt;- dat$SalePrice
clas &lt;- dat$SubclassMS

## Suggest the number of a variable to manipulate
sug_manip_var(ames_rf_shap, primary_obs = 1, comparison_obs = 2)
## This can be used to find a basis to start the radial tour.
# ?radial_cheem_tour
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
