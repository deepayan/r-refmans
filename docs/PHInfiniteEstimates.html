<!DOCTYPE html><html><head><title>Help for package PHInfiniteEstimates</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PHInfiniteEstimates}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aalenjohansen'><p>Calculate the Aalen-Johansen (1978) estimate in the Competing risk context.  See Aalen, Odd O., and Søren Johansen. &quot;An Empirical Transition Matrix for Non-Homogeneous Markov Chains Based on Censored Observations.&quot; Scandinavian Journal of Statistics 5, no. 3 (1978): 141-50. Accessed January 15, 2021. http://www.jstor.org/stable/4615704.</p></a></li>
<li><a href='#andersenplot'><p>Plot hazards for two strata for each time.  At times with an event in one but not the other group, the fitted hazard remains constant, and so the plot is a step function.  If hazards are proportional between strata, then the plot should be close to a straight line.</p></a></li>
<li><a href='#arjasplot'><p>Examine the potential role of treatment in treatment in</p>
a model already including sex.
Straight lines that are not 45 degrees
indicate the appropriateness of new variable as a linear
effect.</a></li>
<li><a href='#bestbeta'><p>Newton Raphson Fitter for partial likelihood</p></a></li>
<li><a href='#checkcensor'><p>Check how censoring impacts sampling properties of KM fit and log rank test.</p></a></li>
<li><a href='#checkresults'><p>Produce a graphical assessment of Monte Carlo experiment on fidelity of proportional hazards regression to the uniform ideal.</p></a></li>
<li><a href='#compareplot'><p>Plot resuts of simcode</p></a></li>
<li><a href='#compete.simulation'><p>Simulate from a competing risk model with correlated log normal errors, and plot various estimates.</p></a></li>
<li><a href='#convertbaselineltolr'><p>Convert a baseline logit model data set, formatted in the long form as described in the documentation for mlogit.data from mlogit package, to a conditional logistic regression.</p></a></li>
<li><a href='#convertmtol'><p>Convert a polytomous regression to a conditional logistic regression.</p></a></li>
<li><a href='#convertstoml'><p>Convert a proportional hazards regression to a multinomial regression.</p></a></li>
<li><a href='#drawdiagram'><p>Draw diagram for toy PH example.</p></a></li>
<li><a href='#fixcoxph'><p>Remove observations from a proportional hazards regression, and return the fit of the reduced model.</p></a></li>
<li><a href='#gehan.wilcoxon.test'><p>Perform Gehan's application to the Wilcoxon test for multiple samples, testing for equivalance of survival curve.  See Klein and Moeschberger (1997) Survival Analysis (7.3.3) and pp. 193-194.</p></a></li>
<li><a href='#heinzeschemper'><p>Simulate operating characteristics of repaired Cox regression and competitors.</p></a></li>
<li><a href='#inference'><p>Perform inference on conditional sample space.</p></a></li>
<li><a href='#lrapproximations'><p>Assess the accuracy of the log rank statistic approximation to the true value, in the case without censoring.  Provides plots of statistics, and empirical test level.</p></a></li>
<li><a href='#network'><p>This function enumerates conditional sample spaces associated with logistic regression,</p></a></li>
<li><a href='#newllk'><p>Proportional hazards partial likelihood, using Breslow method for ties, excluding some observations.</p></a></li>
<li><a href='#PHInfiniteEstimates'><p>PHInfiniteEstimates: Tools for Proportional Hazards Estimation, and Inference on the Associate Parameters, when Other Parameters are Estimated at Infinity.</p></a></li>
<li><a href='#pllk'><p>Partial likelihood for proportional hazards</p></a></li>
<li><a href='#reduceLR'><p>Reduce a logistic regression with monotone likelihood to a conditional regression with</p>
double descending likelihood.</a></li>
<li><a href='#simcode'><p>Simulate Weibull survival data from a model, perform reduction to remove infinite estimates, and calculate p values.</p></a></li>
<li><a href='#simultaneouscoverage'><p>Calculate simultaneous coverage of pointwise confidence intervals.</p></a></li>
<li><a href='#summarizefits'><p>Summarize proportional hazards fits</p></a></li>
<li><a href='#summarizetable'><p>Summarize the results of simulations investigating operating conditions for the data reduction method to avoid monotone likelihood.  Files are of form &quot;hsxxx&quot;, for xxx numerals.</p></a></li>
<li><a href='#survregpredict'><p>Fit survival probabilties from a survreg object.</p></a></li>
<li><a href='#testcox'><p>Test size of asymptotic Cox tests.</p></a></li>
<li><a href='#voter.ml'><p>Subset of British elections data used in (Kolassa 2016).</p>
Data are from (Sanders et al. 2007).</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Inference in the Presence of a Monotone Likelihood</td>
</tr>
<tr>
<td>Version:</td>
<td>2.9.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-23</td>
</tr>
<tr>
<td>Author:</td>
<td>John E. Kolassa and Juan Zhang</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>John E. Kolassa &lt;kolassa@stat.rutgers.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Proportional hazards estimation in the presence of a partially monotone likelihood has difficulties, in that finite estimators do not exist.  These difficulties are related to those arising from logistic and multinomial regression.  References for methods are given in the separate function documents.  Supported by grant NSF DMS 1712839.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>survival, lpSolve, coxphf, nph</td>
</tr>
<tr>
<td>Suggests:</td>
<td>KMsurv</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rdpack (&ge; 0.7)</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-24 01:01:47 UTC; kolassa</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-24 04:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='aalenjohansen'>Calculate the Aalen-Johansen (1978) estimate in the Competing risk context.  See Aalen, Odd O., and Søren Johansen. &quot;An Empirical Transition Matrix for Non-Homogeneous Markov Chains Based on Censored Observations.&quot; Scandinavian Journal of Statistics 5, no. 3 (1978): 141-50. Accessed January 15, 2021. http://www.jstor.org/stable/4615704.</h2><span id='topic+aalenjohansen'></span>

<h3>Description</h3>

<p>Calculate the Aalen-Johansen (1978) estimate in the Competing risk context.  See Aalen, Odd O., and Søren Johansen. &quot;An Empirical Transition Matrix for Non-Homogeneous Markov Chains Based on Censored Observations.&quot; Scandinavian Journal of Statistics 5, no. 3 (1978): 141-50. Accessed January 15, 2021. http://www.jstor.org/stable/4615704.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aalenjohansen(times, causes)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aalenjohansen_+3A_times">times</code></td>
<td>
<p>Event times.</p>
</td></tr>
<tr><td><code id="aalenjohansen_+3A_causes">causes</code></td>
<td>
<p>Causes, with 0 coded as censored, 1 as cause of interest, other for competing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with components
</p>

<ul>
<li><p> times Unique times
</p>
</li>
<li><p> surv Aalen-Johansen estimator for cause 1.
</p>
</li></ul>


<hr>
<h2 id='andersenplot'>Plot hazards for two strata for each time.  At times with an event in one but not the other group, the fitted hazard remains constant, and so the plot is a step function.  If hazards are proportional between strata, then the plot should be close to a straight line.</h2><span id='topic+andersenplot'></span>

<h3>Description</h3>

<p>Plot hazards for two strata for each time.  At times with an event in one but not the other group, the fitted hazard remains constant, and so the plot is a step function.  If hazards are proportional between strata, then the plot should be close to a straight line.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>andersenplot(fit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="andersenplot_+3A_fit">fit</code></td>
<td>
<p>A coxph fit with a stratification term.</p>
</td></tr>
</table>

<hr>
<h2 id='arjasplot'>Examine the potential role of treatment in treatment in 
a model already including sex.
Straight lines that are not 45 degrees
indicate the appropriateness of new variable as a linear
effect.</h2><span id='topic+arjasplot'></span>

<h3>Description</h3>

<p>Examine the potential role of treatment in treatment in 
a model already including sex.
Straight lines that are not 45 degrees
indicate the appropriateness of new variable as a linear
effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arjasplot(formulastring, time, stratifier, status, mydata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="arjasplot_+3A_formulastring">formulastring</code></td>
<td>
<p>A formula for a coxph fit.</p>
</td></tr>
<tr><td><code id="arjasplot_+3A_time">time</code></td>
<td>
<p>The name of the time variable</p>
</td></tr>
<tr><td><code id="arjasplot_+3A_stratifier">stratifier</code></td>
<td>
<p>The name of the stratifier variable</p>
</td></tr>
<tr><td><code id="arjasplot_+3A_status">status</code></td>
<td>
<p>The name of the status variable</p>
</td></tr>
<tr><td><code id="arjasplot_+3A_mydata">mydata</code></td>
<td>
<p>The data frame.</p>
</td></tr>
</table>

<hr>
<h2 id='bestbeta'>Newton Raphson Fitter for partial likelihood</h2><span id='topic+bestbeta'></span>

<h3>Description</h3>

<p>This function implements the approximate conditional inferential approach of Kolassa and Zhang (2019) to proportional hazards regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bestbeta(fit, exclude = NULL, start = NULL, touse = NA, usecc = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bestbeta_+3A_fit">fit</code></td>
<td>
<p>Output from a Cox PH regression, with x=TRUE and y=TRUE</p>
</td></tr>
<tr><td><code id="bestbeta_+3A_exclude">exclude</code></td>
<td>
<p>data set with stratum and patient number to exclude.</p>
</td></tr>
<tr><td><code id="bestbeta_+3A_start">start</code></td>
<td>
<p>Starting value</p>
</td></tr>
<tr><td><code id="bestbeta_+3A_touse">touse</code></td>
<td>
<p>columns of the design matrix to use.</p>
</td></tr>
<tr><td><code id="bestbeta_+3A_usecc">usecc</code></td>
<td>
<p>Logical variable indicating whether to use a continuity correction, or nuerical variable representing teh continuity correction.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fitted survival analysis regression parameter of class coxph
</p>


<h3>References</h3>

<p>Kolassa JE, Zhang J (2019).
<a href="https://higherlogicdownload.s3.amazonaws.com/AMSTAT/fa4dd52c-8429-41d0-abdf-0011047bfa19/UploadedImages/NCB_Conference/Presentations/2019/kolassa_toxslides.pdf">https://higherlogicdownload.s3.amazonaws.com/AMSTAT/fa4dd52c-8429-41d0-abdf-0011047bfa19/UploadedImages/NCB_Conference/Presentations/2019/kolassa_toxslides.pdf</a>.
Accessed: 2019-07-14.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bfit&lt;-coxph(Surv(TIME,CENS)~T+N+CD,data=breast,x=TRUE)
noccfit&lt;-bestbeta(bfit)
bestbeta(bfit,usecc=TRUE,start=noccfit$start)
</code></pre>

<hr>
<h2 id='checkcensor'>Check how censoring impacts sampling properties of KM fit and log rank test.</h2><span id='topic+checkcensor'></span>

<h3>Description</h3>

<p>Check how censoring impacts sampling properties of KM fit and log rank test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkcensor(nsamp = 1000, nobs = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkcensor_+3A_nsamp">nsamp</code></td>
<td>
<p>Number of MC samples</p>
</td></tr>
<tr><td><code id="checkcensor_+3A_nobs">nobs</code></td>
<td>
<p>Number of observations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>biases of fits.
</p>

<hr>
<h2 id='checkresults'>Produce a graphical assessment of Monte Carlo experiment on fidelity of proportional hazards regression to the uniform ideal.</h2><span id='topic+checkresults'></span>

<h3>Description</h3>

<p>This function draws a quantile plot for Monte Carlo assessments of fit to the corrected proportional hazards fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkresults(regnsimulation, frac = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkresults_+3A_regnsimulation">regnsimulation</code></td>
<td>
<p>A structure with a component out, matrix with columns representing definitions of p-values and as many rows as there MC samples.</p>
</td></tr>
<tr><td><code id="checkresults_+3A_frac">frac</code></td>
<td>
<p>Proportion for bottom of distribution to be assessed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components of consisting of simulated Wald p-values, likelihood ratio p-values, and corrected likelihood ratio p-values.
</p>

<hr>
<h2 id='compareplot'>Plot resuts of simcode</h2><span id='topic+compareplot'></span>

<h3>Description</h3>

<p>Plot resuts of simcode
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compareplot(simresults)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compareplot_+3A_simresults">simresults</code></td>
<td>
<p>the result of simcode</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nothing.
</p>

<hr>
<h2 id='compete.simulation'>Simulate from a competing risk model with correlated log normal errors, and plot various estimates.</h2><span id='topic+compete.simulation'></span>

<h3>Description</h3>

<p>Simulate from a competing risk model with correlated log normal errors, and plot various estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compete.simulation(ncr = 4, sig = 0.8, ns = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compete.simulation_+3A_ncr">ncr</code></td>
<td>
<p>Number of competing risks.</p>
</td></tr>
<tr><td><code id="compete.simulation_+3A_sig">sig</code></td>
<td>
<p>correlation among competing risks.</p>
</td></tr>
<tr><td><code id="compete.simulation_+3A_ns">ns</code></td>
<td>
<p>number of observations.</p>
</td></tr>
</table>

<hr>
<h2 id='convertbaselineltolr'>Convert a baseline logit model data set, formatted in the long form as described in the documentation for mlogit.data from mlogit package, to a conditional logistic regression.</h2><span id='topic+convertbaselineltolr'></span>

<h3>Description</h3>

<p>Convert a baseline logit model data set, formatted in the long form as described in the documentation for mlogit.data from mlogit package, to a conditional logistic regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convertbaselineltolr(dataset, choice, covs, strs = "chid", alt = "alt")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convertbaselineltolr_+3A_dataset">dataset</code></td>
<td>
<p>in formatted as in the output from mlogit.data of the mlogit packages</p>
</td></tr>
<tr><td><code id="convertbaselineltolr_+3A_choice">choice</code></td>
<td>
<p>name of variable in dataset representing choice, a logical variable indicating whether this choice is actually chosen.</p>
</td></tr>
<tr><td><code id="convertbaselineltolr_+3A_covs">covs</code></td>
<td>
<p>vector of names of covariates</p>
</td></tr>
<tr><td><code id="convertbaselineltolr_+3A_strs">strs</code></td>
<td>
<p>name of variable in data set indicating independent subject</p>
</td></tr>
<tr><td><code id="convertbaselineltolr_+3A_alt">alt</code></td>
<td>
<p>name of variable in data set indicating potential choice.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements version of (Kolassa 2016).
The multinomial regression is converted to a conditional logistic regression, and methods of (Kolassa 1997) may be applied.  
This function differs from <code>convertmtol</code> of this package in that <code>convertmtol</code> treats a less-rich data structure, and this function treats the richer data structure that is an output of <code>mlogit.data</code> from package <code>mlogit</code>.
Data in the example is from Sanders et al. (2007).
</p>


<h3>Value</h3>

<p>a data set on which to apply conditional logistic regression, corresponding to the baseline logit model.
</p>


<h3>References</h3>

<p>Sanders DJ, Whiteley PF, Clarke HD, Stewart M, Winters K (2007).
&ldquo;The British Election Study.&rdquo;
<a href="https://www.britishelectionstudy.com">https://www.britishelectionstudy.com</a>.
</p>
<p>Kolassa JE (1997).
&ldquo;Infinite Parameter Estimates in Logistic Regression.&rdquo;
<em>Scandinavian Journal of Statistics</em>, <b>24</b>, 523&ndash;530.
<a href="https://doi.org/10.1111/1467-9469.00078">doi:10.1111/1467-9469.00078</a>.
</p>
<p>Kolassa JE (2016).
&ldquo;Inference in the Presence of Likelihood Monotonicity for Polytomous and Logistic Regression.&rdquo;
<em>Advances in Pure Mathematics</em>, <b>6</b>, 331-341.
<a href="https://doi.org/10.4236/apm.2016.65024">doi:10.4236/apm.2016.65024</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(voter.ml)
covs&lt;-c("Labor","Liberal.Democrat","education")
#Fit the multinomial regression model, for comparison purposes.
## Lines beginning ## give mlogit syntax that has been made obsolete.
#Add the index attribute to the data set, giving the index of choice made and the index of the 
#alternative, and a boolean variable giving choice.
##attributes(voter.ml)$index&lt;-voter.ml[,c("chid","alt")]
##attributes(voter.ml)$choice&lt;-"voter"
##mlogit(voter~1|Labor+Liberal.Democrat+education,data=voter.ml)
# The package mlogit is scheduled for archiving.  If it is available, the
# next two lines fit the model using mlogit.
# mlogit(voter~1|Labor+Liberal.Democrat+education,data=voter.ml, 
#    chid.var = "chid", alt.var = "alt")
#Convert to a data set allowing treatment as the equivalent conditional logistic regression.  
#This result will be processed using reduceLR of this package to give an equivalent conditional
# regression model avoiding infinite estimates.
out&lt;-convertbaselineltolr(voter.ml,"voter",c("Labor","Liberal.Democrat","education"))
#Fit the associated unconditional logistic regression for comparison purposes.
glm(out[,"y"]~out[,1:75],family=binomial)
</code></pre>

<hr>
<h2 id='convertmtol'>Convert a polytomous regression to a conditional logistic regression.</h2><span id='topic+convertmtol'></span>

<h3>Description</h3>

<p>Convert a polytomous regression to a conditional logistic regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convertmtol(xmat, str, yvec, subjects)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convertmtol_+3A_xmat">xmat</code></td>
<td>
<p>regression matrix</p>
</td></tr>
<tr><td><code id="convertmtol_+3A_str">str</code></td>
<td>
<p>stratum label</p>
</td></tr>
<tr><td><code id="convertmtol_+3A_yvec">yvec</code></td>
<td>
<p>vector of responses</p>
</td></tr>
<tr><td><code id="convertmtol_+3A_subjects">subjects</code></td>
<td>
<p>vector of subject labels passed directly to the output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements version of (Kolassa 2016).  
The multinomial regression is converted to a conditional logistic regression, and methods of (Kolassa 1997) may be applied.
This function differs from <code>convertbaselineltolr</code> of this package in that the former treats the richer data structure of package <code>mlogit</code>, and this function treats a less complicated structure.
Data in the example is the breast cancer data set <code>breast</code> of package <code>coxphf</code>.
</p>


<h3>Value</h3>

<p>a data set on which to apply conditional logistic regression, corresponding to the multinomial regression model.
</p>


<h3>References</h3>

<p>Kolassa JE (1997).
&ldquo;Infinite Parameter Estimates in Logistic Regression.&rdquo;
<em>Scandinavian Journal of Statistics</em>, <b>24</b>, 523&ndash;530.
<a href="https://doi.org/10.1111/1467-9469.00078">doi:10.1111/1467-9469.00078</a>.
</p>
<p>Kolassa JE (2016).
&ldquo;Inference in the Presence of Likelihood Monotonicity for Polytomous and Logistic Regression.&rdquo;
<em>Advances in Pure Mathematics</em>, <b>6</b>, 331-341.
<a href="https://doi.org/10.4236/apm.2016.65024">doi:10.4236/apm.2016.65024</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Uses data set breast from package coxphf.
data(breast)
out&lt;-convertstoml(Surv(breast$TIME,breast$CENS),breast[,c("T","N","G","CD")])
out1&lt;-convertmtol(out[,c("T","N","G","CD")],out[,"chid"],out[,"choice"],
   out[,"patients"])
glmout&lt;-glm.fit(out1$xmat,out1$y,family=binomial())
#In many practice examples, the following line shows which observations to retain
#in the logistic regression example.
moderate&lt;-(fitted(glmout)&lt;1-1.0e-8)&amp;(fitted(glmout)&gt;1.0e-8)
# Proportional hazards fit illustrating infinite estimates.
coxph(Surv(TIME,CENS)~ T+ N+ G+ CD,data=breast)
# Wrong analysis naively removing covariate with infinite estimate
coxph(Surv(TIME,CENS)~ T+ N+ CD,data=breast)
summary(glm((CENS&gt;22)~T+N+G+CD,family=binomial,data=breast))

out2&lt;-reduceLR(out1$xmat,yvec=out1$y,keep="CD")
bestcoxout&lt;-coxph(Surv(TIME,CENS)~ T+ N+ G+ CD,data=breast,
   subset=as.numeric(unique(out1$subjects[out2$moderate])))

</code></pre>

<hr>
<h2 id='convertstoml'>Convert a proportional hazards regression to a multinomial regression.</h2><span id='topic+convertstoml'></span>

<h3>Description</h3>

<p>Convert a proportional hazards regression to a multinomial regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convertstoml(survobj, covmat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convertstoml_+3A_survobj">survobj</code></td>
<td>
<p>A survival object, with potentially right censoring.</p>
</td></tr>
<tr><td><code id="convertstoml_+3A_covmat">covmat</code></td>
<td>
<p>a matrix of covariates.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements version of (Kolassa and Zhang 2019).  
The proportional hazards regression is converted to a multinomial regression logistic regression, and methods of (Kolassa 2016) may be applied.
This function is intended to produce intermediate results to be passed to <code>convertmtol</code>, and then to <code>reduceLR</code> of (Kolassa 1997).  See examples in the <code>convertmtol</code> documentation.
</p>


<h3>Value</h3>

<p>a data set on which to apply conditional multinomial regression, corresponding to the proportional hazards regression analysis.
In order to run the line commented out below, you would need this:
# @importFrom mlogit mlogit.data
</p>


<h3>References</h3>

<p>Kolassa JE (1997).
&ldquo;Infinite Parameter Estimates in Logistic Regression.&rdquo;
<em>Scandinavian Journal of Statistics</em>, <b>24</b>, 523&ndash;530.
<a href="https://doi.org/10.1111/1467-9469.00078">doi:10.1111/1467-9469.00078</a>.
</p>
<p>Kolassa JE (2016).
&ldquo;Inference in the Presence of Likelihood Monotonicity for Polytomous and Logistic Regression.&rdquo;
<em>Advances in Pure Mathematics</em>, <b>6</b>, 331-341.
<a href="https://doi.org/10.4236/apm.2016.65024">doi:10.4236/apm.2016.65024</a>.
</p>
<p>Kolassa JE, Zhang J (2019).
<a href="https://higherlogicdownload.s3.amazonaws.com/AMSTAT/fa4dd52c-8429-41d0-abdf-0011047bfa19/UploadedImages/NCB_Conference/Presentations/2019/kolassa_toxslides.pdf">https://higherlogicdownload.s3.amazonaws.com/AMSTAT/fa4dd52c-8429-41d0-abdf-0011047bfa19/UploadedImages/NCB_Conference/Presentations/2019/kolassa_toxslides.pdf</a>.
Accessed: 2019-07-14.
</p>

<hr>
<h2 id='drawdiagram'>Draw diagram for toy PH example.</h2><span id='topic+drawdiagram'></span>

<h3>Description</h3>

<p>Draw diagram for toy PH example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drawdiagram()
</code></pre>


<h3>Value</h3>

<p>nothing.
</p>

<hr>
<h2 id='fixcoxph'>Remove observations from a proportional hazards regression, and return the fit of the reduced model.</h2><span id='topic+fixcoxph'></span>

<h3>Description</h3>

<p>This function implements the approximate conditional inferential approach of Kolassa and Zhang (2019) to proportional hazards regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fixcoxph(randdat, xxx, iv, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fixcoxph_+3A_randdat">randdat</code></td>
<td>
<p>A list with at least the component y, representing the Surv() object.  I expect that this will be output from an initial non-convergent regression.</p>
</td></tr>
<tr><td><code id="fixcoxph_+3A_xxx">xxx</code></td>
<td>
<p>a design matrix for the regression.  I expect that this will be the $x component of the output from an initial non-convergent regression, run with x=TRUE .</p>
</td></tr>
<tr><td><code id="fixcoxph_+3A_iv">iv</code></td>
<td>
<p>name of the variable of interest, as a character string</p>
</td></tr>
<tr><td><code id="fixcoxph_+3A_verbose">verbose</code></td>
<td>
<p>logical flag governing printing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fitted survival analysis regression parameter of class coxph, fitted form data set with observations forcing infinite estimation removed.
</p>


<h3>References</h3>

<p>Kolassa JE, Zhang J (2019).
<a href="https://higherlogicdownload.s3.amazonaws.com/AMSTAT/fa4dd52c-8429-41d0-abdf-0011047bfa19/UploadedImages/NCB_Conference/Presentations/2019/kolassa_toxslides.pdf">https://higherlogicdownload.s3.amazonaws.com/AMSTAT/fa4dd52c-8429-41d0-abdf-0011047bfa19/UploadedImages/NCB_Conference/Presentations/2019/kolassa_toxslides.pdf</a>.
Accessed: 2019-07-14.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(breast) # From library coxphf
bcfit&lt;-coxph(Surv(TIME,CENS)~ T+ N+ G+ CD,data=breast,x=TRUE)

fixcoxph(bcfit,bcfit$x,"T",Surv(TIME,CENS)~ T+ N+ G+ CD)

testdat2 &lt;- data.frame(Time=c(4,3,1,1,2,2,3),
  Cen=c(1,1,1,0,0,0,0), Primary=c(0,2,1,1,1,0,0), Sex=c(0,0,0,0,1,1,1))
(bcfit&lt;-coxph(Surv(Time,Cen)~Primary + Sex, testdat2, x=TRUE, ties="breslow"))
fixcoxph(bcfit,bcfit$x,"Primary")
</code></pre>

<hr>
<h2 id='gehan.wilcoxon.test'>Perform Gehan's application to the Wilcoxon test for multiple samples, testing for equivalance of survival curve.  See Klein and Moeschberger (1997) Survival Analysis (7.3.3) and pp. 193-194.</h2><span id='topic+gehan.wilcoxon.test'></span>

<h3>Description</h3>

<p>Perform Gehan's application to the Wilcoxon test for multiple samples, testing for equivalance of survival curve.  See Klein and Moeschberger (1997) Survival Analysis (7.3.3) and pp. 193-194.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gehan.wilcoxon.test(
  myformula,
  data,
  gehan = TRUE,
  plot = FALSE,
  alpha = 0.05,
  subset = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gehan.wilcoxon.test_+3A_myformula">myformula</code></td>
<td>
<p>Proportional hazards formula appropriate for survfit</p>
</td></tr>
<tr><td><code id="gehan.wilcoxon.test_+3A_data">data</code></td>
<td>
<p>the data set</p>
</td></tr>
<tr><td><code id="gehan.wilcoxon.test_+3A_gehan">gehan</code></td>
<td>
<p>logical flag triggering the Wilcoxon test (gehan=TRUE), with weights equal to total at risk, or the log rank test (gehan=FALSE) with weights all 1.</p>
</td></tr>
<tr><td><code id="gehan.wilcoxon.test_+3A_plot">plot</code></td>
<td>
<p>logical flag triggering plotting.</p>
</td></tr>
<tr><td><code id="gehan.wilcoxon.test_+3A_alpha">alpha</code></td>
<td>
<p>Nominal test level for plotting on graph</p>
</td></tr>
<tr><td><code id="gehan.wilcoxon.test_+3A_subset">subset</code></td>
<td>
<p>Apply to a subset of the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An htest-like object with the chi-square version of the test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(breast)#From package coxphf
gehan.wilcoxon.test(Surv(TIME,CENS)~G,data=breast)
</code></pre>

<hr>
<h2 id='heinzeschemper'>Simulate operating characteristics of repaired Cox regression and competitors.</h2><span id='topic+heinzeschemper'></span>

<h3>Description</h3>

<p>This function is intended to verify the operating characteristics of the approximate conditional inferential approach of Kolassa and Zhang (2019) to proportional hazards regression.  An exponential regression model, corresponding to the proportional hazards regression model, is fit to the data, and new data sets are simulated from this model.  P-values are calculated for these new data sets, and their empirical distribution is compared to the theoretical uniform distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heinzeschemper(
  nobs = 50,
  k = 5,
  B = 1,
  c = 0,
  nsamp = 1000,
  beta = NULL,
  add = NULL,
  half = NULL,
  verbose = FALSE,
  smoothfirst = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heinzeschemper_+3A_nobs">nobs</code></td>
<td>
<p>number of observations in simulated data set.</p>
</td></tr>
<tr><td><code id="heinzeschemper_+3A_k">k</code></td>
<td>
<p>number of covariates in simulated data set.  Each covariate is dochotomous.</p>
</td></tr>
<tr><td><code id="heinzeschemper_+3A_b">B</code></td>
<td>
<p>odds of 1 vs. 0 in dichotomous variables.</p>
</td></tr>
<tr><td><code id="heinzeschemper_+3A_c">c</code></td>
<td>
<p>censoring proportion.</p>
</td></tr>
<tr><td><code id="heinzeschemper_+3A_nsamp">nsamp</code></td>
<td>
<p>number of samples.</p>
</td></tr>
<tr><td><code id="heinzeschemper_+3A_beta">beta</code></td>
<td>
<p>regression parameters, all zeros if null, and all the same value if a scalar.</p>
</td></tr>
<tr><td><code id="heinzeschemper_+3A_add">add</code></td>
<td>
<p>partial simulation results to be added to, or NULL if de novo.</p>
</td></tr>
<tr><td><code id="heinzeschemper_+3A_half">half</code></td>
<td>
<p>does nothing; provided for compatabilitity with simcode.</p>
</td></tr>
<tr><td><code id="heinzeschemper_+3A_verbose">verbose</code></td>
<td>
<p>Triggers verbose messages.</p>
</td></tr>
<tr><td><code id="heinzeschemper_+3A_smoothfirst">smoothfirst</code></td>
<td>
<p>Triggers normal rather than dichotomous interest covariate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with components
</p>

<ul>
<li><p> out matrix with columns corresponding to p-values.
</p>
</li></ul>


<hr>
<h2 id='inference'>Perform inference on conditional sample space.</h2><span id='topic+inference'></span>

<h3>Description</h3>

<p>This function performs classical frequentist statistical inference to a discrete multivariate canonical exponential family.  
It produces the maximum likelihood estimator, one- and two-sided p-values for the test that model parameters are zero, and providing confidence intervals for the parameters.  The discrete probability model is given by a set of possible values of the random vectors, and null weights for these vectors.  
Such a discrete probability model arises in logistic regression, and this function is envisioned to be applied to the results of a network algorithm for conditional logistic regression.  
Examples apply this to data from Hirji et al. (1987), 
citing Goorin et al. (1987).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inference(
  netout,
  alpha = 0.05,
  rng = c(-5, 5),
  alternative = c("two.sided", "less", "greater")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inference_+3A_netout">netout</code></td>
<td>
<p>List of the sort provided by network.</p>
</td></tr>
<tr><td><code id="inference_+3A_alpha">alpha</code></td>
<td>
<p>Test level, or 1- confidence level.</p>
</td></tr>
<tr><td><code id="inference_+3A_rng">rng</code></td>
<td>
<p>Range of possible parameter values.</p>
</td></tr>
<tr><td><code id="inference_+3A_alternative">alternative</code></td>
<td>
<p>String indicating two- or one-sided alternative, and, if one-sided, direction.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of outputs, including
</p>

<ul>
<li><p> ospv Observed one-sided p values
</p>
</li>
<li><p> tspv Observed two-sided p value.
</p>
</li>
<li><p> ci confidence interval.
</p>
</li>
<li><p> estimate Maximum conditional likelihood estimator.
</p>
</li>
<li><p> null.value Value of parameter under null hypothesis.
</p>
</li>
<li><p> data.name Name of data set
</p>
</li>
<li><p> method Method used to generate test.
</p>
</li>
<li><p> statistic sufficient statistic value for inference variable.
</p>
</li>
<li><p> p.value p.value
</p>
</li>
<li><p> conf.int confidence interval.
</p>
</li>
<li><p> alternative String indicating two- or one-sided alternative, and, if one-sided, direction.
</p>
</li></ul>

<p>and including standard stats:::orint.htest components, and of class htest.
</p>


<h3>References</h3>

<p>Hirji KF, Mehta CR, Patel NR (1987).
&ldquo;Computing Distributions for Exact Logistic Regression.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>82</b>(400), pp. 1110-1117.
ISSN 01621459, <a href="https://doi.org/10.2307/2289388">doi:10.2307/2289388</a>.
</p>
<p>Goorin AM, Perez&ndash;Atayde A, Gebhardt M, Andersen J (1987).
&ldquo;Weekly High&ndash;Dose Methotrexate and Doxorubicin for Osteosarcoma: The Dana&ndash;Farber Cancer Institute/The Children's Hospital &ndash; Study III.&rdquo;
<em>Journal of Clinical Oncology</em>.
<a href="https://doi.org/10.1200/JCO.1987.5.8.1178">doi:10.1200/JCO.1987.5.8.1178</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Columns in table are:
# Lymphocytic Infiltration (1=low, 0=high)
# Sex (1=male, 0=female)
# Any Ostioid Pathology (1=yes, 0=no)
# Number in LI-Sex-AOP group
# Number in LI-Sex-AOP group with disease free interval greater than 3 y
goorin&lt;-data.frame(LI=c(0,0,0,0,1,1,1,1),Sex=c(0,0,1,1,0,0,1,1),
   AOP=c(0,1,0,1,0,1,0,1),N=c(3,2,4,1,5,5,9,17),Y=c(3,2,4,1,5,3,5,6))

netout&lt;-network(goorin[,1:3],goorin[,4],conditionon=1:3,resp=goorin[,5])
inference(netout)

</code></pre>

<hr>
<h2 id='lrapproximations'>Assess the accuracy of the log rank statistic approximation to the true value, in the case without censoring.  Provides plots of statistics, and empirical test level.</h2><span id='topic+lrapproximations'></span>

<h3>Description</h3>

<p>Assess the accuracy of the log rank statistic approximation to the true value, in the case without censoring.  Provides plots of statistics, and empirical test level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrapproximations(nobs = 10, ratio = 1, nsamp = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrapproximations_+3A_nobs">nobs</code></td>
<td>
<p>number of observations in each group.  This currently supports only equal group size data sets.</p>
</td></tr>
<tr><td><code id="lrapproximations_+3A_ratio">ratio</code></td>
<td>
<p>Ratio of group means; use 1 for null.</p>
</td></tr>
<tr><td><code id="lrapproximations_+3A_nsamp">nsamp</code></td>
<td>
<p>Monte Carlo sample size.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of empirical test sizes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lrapproximations(nsamp=100)
</code></pre>

<hr>
<h2 id='network'>This function enumerates conditional sample spaces associated with logistic regression,</h2><span id='topic+network'></span>

<h3>Description</h3>

<p>This function uses a network algorithm to enumerate conditional sample spaces associated with logistic regression,
using a minimal version of the algorithm of Hirji et al. (1987).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>network(
  dm,
  n = NULL,
  resp = NULL,
  conditionon = NULL,
  sst = NULL,
  addint = TRUE,
  verbose = FALSE,
  data.name = "Test data"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="network_+3A_dm">dm</code></td>
<td>
<p>matrix of covariates</p>
</td></tr>
<tr><td><code id="network_+3A_n">n</code></td>
<td>
<p>Vector of number of trials.  If null, make them all ones.</p>
</td></tr>
<tr><td><code id="network_+3A_resp">resp</code></td>
<td>
<p>vector of successes.  Used only to calculate the sufficient statistics, unless
sufficient statistics are entered directly.  Either resp or sst must be provided.</p>
</td></tr>
<tr><td><code id="network_+3A_conditionon">conditionon</code></td>
<td>
<p>indices of covariate matrix indicating sufficient statistics to be conditioned on.</p>
</td></tr>
<tr><td><code id="network_+3A_sst">sst</code></td>
<td>
<p>sufficient statistic vector, if input directly.  Otherwise, recomputed from resp.</p>
</td></tr>
<tr><td><code id="network_+3A_addint">addint</code></td>
<td>
<p>logical, true if a column of 1s must be added to the covariate matrix.</p>
</td></tr>
<tr><td><code id="network_+3A_verbose">verbose</code></td>
<td>
<p>logical; if true, print intermediate results.</p>
</td></tr>
<tr><td><code id="network_+3A_data.name">data.name</code></td>
<td>
<p>Name of the data set.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Examples apply this to data from Hirji et al. (1987), 
citing Goorin et al. (1987).
</p>


<h3>Value</h3>

<p>For a successful run, a list with components:
</p>

<ul>
<li><p> possible   matrix with vectors of possible unconditioned values of the sufficient statistic.
</p>
</li>
<li><p> count   count of entries in the conditional distribution.
</p>
</li>
<li><p> obsd   Observed value of unconditioned sufficient statistics.
</p>
</li></ul>

<p>For an unsuccessful run (because of input inconsistencies) NA
</p>


<h3>References</h3>

<p>Hirji KF, Mehta CR, Patel NR (1987).
&ldquo;Computing Distributions for Exact Logistic Regression.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>82</b>(400), pp. 1110-1117.
ISSN 01621459, <a href="https://doi.org/10.2307/2289388">doi:10.2307/2289388</a>.
</p>
<p>Goorin AM, Perez&ndash;Atayde A, Gebhardt M, Andersen J (1987).
&ldquo;Weekly High&ndash;Dose Methotrexate and Doxorubicin for Osteosarcoma: The Dana&ndash;Farber Cancer Institute/The Children's Hospital &ndash; Study III.&rdquo;
<em>Journal of Clinical Oncology</em>.
<a href="https://doi.org/10.1200/JCO.1987.5.8.1178">doi:10.1200/JCO.1987.5.8.1178</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Columns in table are:
# Lymphocytic Infiltration (1=low, 0=high)
# Sex (1=male, 0=female)
# Any Ostioid Pathology (1=yes, 0=no)
# Number in LI-Sex-AOP group
# Number in LI-Sex-AOP group with disease free interval greater than 3 y
goorin&lt;-data.frame(LI=c(0,0,0,0,1,1,1,1),Sex=c(0,0,1,1,0,0,1,1),
   AOP=c(0,1,0,1,0,1,0,1),N=c(3,2,4,1,5,5,9,17),Y=c(3,2,4,1,5,3,5,6))

out&lt;-network(goorin[,1:3],goorin[,4],conditionon=1:3,resp=goorin[,5])
inference(out)

</code></pre>

<hr>
<h2 id='newllk'>Proportional hazards partial likelihood, using Breslow method for ties, excluding some observations.</h2><span id='topic+newllk'></span>

<h3>Description</h3>

<p>This function implements the approximate conditional inferential approach of Kolassa and Zhang (2019) to proportional hazards regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>newllk(
  beta,
  fit,
  exclude = NULL,
  minus = FALSE,
  keeponly = NULL,
  justd0 = FALSE,
  cc1 = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="newllk_+3A_beta">beta</code></td>
<td>
<p>parameter vector.</p>
</td></tr>
<tr><td><code id="newllk_+3A_fit">fit</code></td>
<td>
<p>Output from a Cox PH regression, with x=TRUE and y=TRUE</p>
</td></tr>
<tr><td><code id="newllk_+3A_exclude">exclude</code></td>
<td>
<p>data set with stratum and patient number to exclude.</p>
</td></tr>
<tr><td><code id="newllk_+3A_minus">minus</code></td>
<td>
<p>logical flag to change sign of partial likelyhood</p>
</td></tr>
<tr><td><code id="newllk_+3A_keeponly">keeponly</code></td>
<td>
<p>variables to retain.  Keep all if this is null or NA.</p>
</td></tr>
<tr><td><code id="newllk_+3A_justd0">justd0</code></td>
<td>
<p>logical variable, indicating whether to calculate only the function value and skip derivatives.</p>
</td></tr>
<tr><td><code id="newllk_+3A_cc1">cc1</code></td>
<td>
<p>Continuity correction for first component of the score.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with components
</p>

<ul>
<li><p> d0 partial likelihood
</p>
</li>
<li><p> d1 first derivative vector
</p>
</li>
<li><p> d2 second derivative matrix
</p>
</li></ul>



<h3>References</h3>

<p>Kolassa JE, Zhang J (2019).
<a href="https://higherlogicdownload.s3.amazonaws.com/AMSTAT/fa4dd52c-8429-41d0-abdf-0011047bfa19/UploadedImages/NCB_Conference/Presentations/2019/kolassa_toxslides.pdf">https://higherlogicdownload.s3.amazonaws.com/AMSTAT/fa4dd52c-8429-41d0-abdf-0011047bfa19/UploadedImages/NCB_Conference/Presentations/2019/kolassa_toxslides.pdf</a>.
Accessed: 2019-07-14.
</p>

<hr>
<h2 id='PHInfiniteEstimates'>PHInfiniteEstimates: Tools for Proportional Hazards Estimation, and Inference on the Associate Parameters, when Other Parameters are Estimated at Infinity.</h2><span id='topic+PHInfiniteEstimates'></span>

<h3>Description</h3>

<p>The PHInfiniteEstimates package 
Proportional hazards estimation in the presence of partial likelihood monitonicity has difficulties, in that finite estimators do not exist.  These difficulties are related to those arising from logistic regression, addressed by (Kolassa 1997), 
and multinomial regression, addressed by (Kolassa 2016).  Algorithms to provide conditionally similar problems in these contexts are provided.
</p>


<h3>References</h3>

<p>Kolassa JE (1997).
&ldquo;Infinite Parameter Estimates in Logistic Regression.&rdquo;
<em>Scandinavian Journal of Statistics</em>, <b>24</b>, 523&ndash;530.
<a href="https://doi.org/10.1111/1467-9469.00078">doi:10.1111/1467-9469.00078</a>.
</p>
<p>Kolassa JE (2016).
&ldquo;Inference in the Presence of Likelihood Monotonicity for Polytomous and Logistic Regression.&rdquo;
<em>Advances in Pure Mathematics</em>, <b>6</b>, 331-341.
<a href="https://doi.org/10.4236/apm.2016.65024">doi:10.4236/apm.2016.65024</a>.
</p>

<hr>
<h2 id='pllk'>Partial likelihood for proportional hazards</h2><span id='topic+pllk'></span>

<h3>Description</h3>

<p>Partial likelihood for proportional hazards
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pllk(beta, xmat, ind, cc = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pllk_+3A_beta">beta</code></td>
<td>
<p>parameter vector</p>
</td></tr>
<tr><td><code id="pllk_+3A_xmat">xmat</code></td>
<td>
<p>regression matrix</p>
</td></tr>
<tr><td><code id="pllk_+3A_ind">ind</code></td>
<td>
<p>censoring indicator, 1 for event and any other value otherwise.</p>
</td></tr>
<tr><td><code id="pllk_+3A_cc">cc</code></td>
<td>
<p>Continuity correction for sum of x vectors with multiple occurrences in risk set.  For binary covariates is half.  Default a vector of zeros.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with components
</p>

<ul>
<li><p> d0 partial likelihood
</p>
</li>
<li><p> d1 first derivative vector
</p>
</li>
<li><p> d2 second derivative matrix
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>#Uses data set breast from package coxphf.
data(breast)
 xmat&lt;-as.matrix(breast)[order(breast$TIME),c("T","N")]
 ind&lt;-breast$CENS[order(breast$TIME)]
 short&lt;-coxph(Surv(TIME,CENS)~ T+ N,data=breast)
 pllk(as.vector(coef(short)),xmat,ind)
</code></pre>

<hr>
<h2 id='reduceLR'>Reduce a logistic regression with monotone likelihood to a conditional regression with
double descending likelihood.</h2><span id='topic+reduceLR'></span>

<h3>Description</h3>

<p>Reduce a logistic regression with monotone likelihood to a conditional regression with
double descending likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reduceLR(Z, nvec = NULL, yvec = NULL, keep, sst = NULL, verybig = 1e+07)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reduceLR_+3A_z">Z</code></td>
<td>
<p>regression matrix</p>
</td></tr>
<tr><td><code id="reduceLR_+3A_nvec">nvec</code></td>
<td>
<p>vector of sample sizes</p>
</td></tr>
<tr><td><code id="reduceLR_+3A_yvec">yvec</code></td>
<td>
<p>vector of responses</p>
</td></tr>
<tr><td><code id="reduceLR_+3A_keep">keep</code></td>
<td>
<p>vector of variable names to block from consideration for removal.</p>
</td></tr>
<tr><td><code id="reduceLR_+3A_sst">sst</code></td>
<td>
<p>vector of sufficient statistics</p>
</td></tr>
<tr><td><code id="reduceLR_+3A_verybig">verybig</code></td>
<td>
<p>threshold for condition number to declare colinearity.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements version of Kolassa (1997).  
It is intended for use with extensions to multinomial regression as in Kolassa (1997) and to survival analysis as in Kolassa and Zhang (2019).
The method involves linear optimization that is potentially repeated.  Initial calculations were done using a proprietary coding of the simplex, in a way that allowed for later iterations to be restarted from earlier iterations; this computational advantage is not employed here, in favor of computational tools in the public domain and included in the R package lpSolve.  
Furthermore, Kolassa (1997) removed regressors that became linearly dependent using orthogonalization, but on further reflection this computation is unnecessary.
Data in the examples are from Hirji et al. (1987), 
citing Goorin et al. (1987).
</p>


<h3>Value</h3>

<p>a list with components
</p>

<ul>
<li><p> keepme indicators of which variables are retained in the reduced data set
</p>
</li>
<li><p> moderate indicatiors of which observations are retained in the reduced data set
</p>
</li>
<li><p> extreme indicators of which observations are removed in the reduced data set
</p>
</li>
<li><p> toosmall indicator of whether resulting data set is too small to fit the proportional hazards regression
</p>
</li></ul>



<h3>References</h3>

<p>Hirji KF, Mehta CR, Patel NR (1987).
&ldquo;Computing Distributions for Exact Logistic Regression.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>82</b>(400), pp. 1110-1117.
ISSN 01621459, <a href="https://doi.org/10.2307/2289388">doi:10.2307/2289388</a>.
</p>
<p>Goorin AM, Perez&ndash;Atayde A, Gebhardt M, Andersen J (1987).
&ldquo;Weekly High&ndash;Dose Methotrexate and Doxorubicin for Osteosarcoma: The Dana&ndash;Farber Cancer Institute/The Children's Hospital &ndash; Study III.&rdquo;
<em>Journal of Clinical Oncology</em>.
<a href="https://doi.org/10.1200/JCO.1987.5.8.1178">doi:10.1200/JCO.1987.5.8.1178</a>.
</p>
<p>Kolassa JE (1997).
&ldquo;Infinite Parameter Estimates in Logistic Regression.&rdquo;
<em>Scandinavian Journal of Statistics</em>, <b>24</b>, 523&ndash;530.
<a href="https://doi.org/10.1111/1467-9469.00078">doi:10.1111/1467-9469.00078</a>.
</p>
<p>Kolassa JE (2016).
&ldquo;Inference in the Presence of Likelihood Monotonicity for Polytomous and Logistic Regression.&rdquo;
<em>Advances in Pure Mathematics</em>, <b>6</b>, 331-341.
<a href="https://doi.org/10.4236/apm.2016.65024">doi:10.4236/apm.2016.65024</a>.
</p>
<p>Kolassa JE, Zhang J (2019).
<a href="https://higherlogicdownload.s3.amazonaws.com/AMSTAT/fa4dd52c-8429-41d0-abdf-0011047bfa19/UploadedImages/NCB_Conference/Presentations/2019/kolassa_toxslides.pdf">https://higherlogicdownload.s3.amazonaws.com/AMSTAT/fa4dd52c-8429-41d0-abdf-0011047bfa19/UploadedImages/NCB_Conference/Presentations/2019/kolassa_toxslides.pdf</a>.
Accessed: 2019-07-14.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Cancer Data
Z&lt;-cbind(rep(1,8),c(rep(0,4),rep(1,4)),rep(c(0,0,1,1),2),rep(c(0,1),4))
dimnames(Z)&lt;-list(NULL,c("1","LI","SEX","AOP"))
nvec&lt;-c(3,2,4,1,5,5,9,17); yvec&lt;-c(3,2,4,1,5,3,5,6)
reduceLR(Z,nvec,yvec,c("SEX","AOP"))
#CD4, CD8 data
Z&lt;-cbind(1,c(0,0,1,1,0,0,1,0),c(0,0,0,0,1,1,0,1),c(0,0,0,0,0,1,1,0),c(0,1,0,1,0,0,0,1))
dimnames(Z)&lt;-list(NULL,c("1","CD41","CD42","CD81","CD82"))
nvec&lt;-c(7,1,7,2,2,13,12,3); yvec&lt;-c(4,1,2,2,0,0,4,1)
reduceLR(Z,nvec,yvec,"CD41")
</code></pre>

<hr>
<h2 id='simcode'>Simulate Weibull survival data from a model, perform reduction to remove infinite estimates, and calculate p values.</h2><span id='topic+simcode'></span>

<h3>Description</h3>

<p>Operating characteristics for the approximate conditional inferential approach to proportional hazards.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simcode(
  dataset,
  myformula,
  iv,
  ctime,
  nsamp = 10000,
  add = NULL,
  nobs = NA,
  half = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simcode_+3A_dataset">dataset</code></td>
<td>
<p>the data set to use</p>
</td></tr>
<tr><td><code id="simcode_+3A_myformula">myformula</code></td>
<td>
<p>the formula for the Cox regression</p>
</td></tr>
<tr><td><code id="simcode_+3A_iv">iv</code></td>
<td>
<p>name of the variable of interest, as a character string</p>
</td></tr>
<tr><td><code id="simcode_+3A_ctime">ctime</code></td>
<td>
<p>fixed censoring time</p>
</td></tr>
<tr><td><code id="simcode_+3A_nsamp">nsamp</code></td>
<td>
<p>number of samples.</p>
</td></tr>
<tr><td><code id="simcode_+3A_add">add</code></td>
<td>
<p>preliminary results, if any.</p>
</td></tr>
<tr><td><code id="simcode_+3A_nobs">nobs</code></td>
<td>
<p>number of observations in target models, if different from that of dataset.</p>
</td></tr>
<tr><td><code id="simcode_+3A_half">half</code></td>
<td>
<p>logical flag triggering a less extreme simulation by dividing the Weibull regression parameters in half.</p>
</td></tr>
<tr><td><code id="simcode_+3A_verbose">verbose</code></td>
<td>
<p>logical flag triggering intermediate messaging.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is intended to verify the operating characteristics of the approximate conditional inferential approach of Kolassa and Zhang (2019) to proportional hazards regression.  A Weibull regression model, corresponding to the proportional hazards regression model, is fit to the data, and new data sets are simulated from this model.  P-values are calculated for these new data sets, and their empirical distribution is compared to the theoretical uniform distribution.
</p>


<h3>Value</h3>

<p>a list with components
</p>

<ul>
<li><p> out matrix with columns corresponding to p-values.
</p>
</li>
<li><p> seed random seed
</p>
</li>
<li><p> bad unused.
</p>
</li>
<li><p> srreg parametric lifetime regression
</p>
</li></ul>



<h3>References</h3>

<p>Kolassa JE, Zhang J (2019).
<a href="https://higherlogicdownload.s3.amazonaws.com/AMSTAT/fa4dd52c-8429-41d0-abdf-0011047bfa19/UploadedImages/NCB_Conference/Presentations/2019/kolassa_toxslides.pdf">https://higherlogicdownload.s3.amazonaws.com/AMSTAT/fa4dd52c-8429-41d0-abdf-0011047bfa19/UploadedImages/NCB_Conference/Presentations/2019/kolassa_toxslides.pdf</a>.
Accessed: 2019-07-14.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(breast)

breasttestp&lt;-simcode(breast,Surv(TIME,CENS)~ T+ N+ G+ CD,"T",72,nsamp=100,verbose=TRUE)

</code></pre>

<hr>
<h2 id='simultaneouscoverage'>Calculate simultaneous coverage of pointwise confidence intervals.</h2><span id='topic+simultaneouscoverage'></span>

<h3>Description</h3>

<p>Simulate exponential event times with expecation 1.  Simulate censoring times with expectation 2.  Calculate confidence intervals and check simultaneous coverage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simultaneouscoverage(nsamp, nobs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simultaneouscoverage_+3A_nsamp">nsamp</code></td>
<td>
<p>Number of Monte Carlo samples.</p>
</td></tr>
<tr><td><code id="simultaneouscoverage_+3A_nobs">nobs</code></td>
<td>
<p>Number of observations per sample.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Simultaneous coverage proportion.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>simultaneouscoverage(1000,20)
</code></pre>

<hr>
<h2 id='summarizefits'>Summarize proportional hazards fits</h2><span id='topic+summarizefits'></span>

<h3>Description</h3>

<p>Summarize proportional hazards fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarizefits(
  repairedfit,
  penalizedout,
  penalizedoutsmaller,
  iv,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarizefits_+3A_repairedfit">repairedfit</code></td>
<td>
<p>coxph fit</p>
</td></tr>
<tr><td><code id="summarizefits_+3A_penalizedout">penalizedout</code></td>
<td>
<p>coxphf fit</p>
</td></tr>
<tr><td><code id="summarizefits_+3A_penalizedoutsmaller">penalizedoutsmaller</code></td>
<td>
<p>smaller coxphf fit</p>
</td></tr>
<tr><td><code id="summarizefits_+3A_iv">iv</code></td>
<td>
<p>name of the variable of interest, as a character string</p>
</td></tr>
<tr><td><code id="summarizefits_+3A_verbose">verbose</code></td>
<td>
<p>logical flag triggering intermediate messaging.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector with components
</p>

<ul>
<li><p> Wald p-value from the Cox regression fit.
</p>
</li>
<li><p> partial likelihood ratio p-value from Cox regression fit.
</p>
</li>
<li><p> parameter estimate from the Cox regression fit.
</p>
</li>
<li><p> standard error from the Cox regression fit.
</p>
</li>
<li><p> Conditional Skovgaard standard error from the Cox regression fit.
</p>
</li>
<li><p> Signed root of the partial likelihood ratio statistic from Cox regression fit.
</p>
</li>
<li><p> partial likelihood ratio statistic p-value from coxphf
</p>
</li>
<li><p> Wald p-value from coxphf
</p>
</li>
<li><p> parameter estimate from coxphf
</p>
</li>
<li><p> standard error from coxphf
</p>
</li>
<li><p> number of parameters in reduced fit.
</p>
</li></ul>



<h3>References</h3>

<p>Kolassa JE, Zhang J (2019).
<a href="https://higherlogicdownload.s3.amazonaws.com/AMSTAT/fa4dd52c-8429-41d0-abdf-0011047bfa19/UploadedImages/NCB_Conference/Presentations/2019/kolassa_toxslides.pdf">https://higherlogicdownload.s3.amazonaws.com/AMSTAT/fa4dd52c-8429-41d0-abdf-0011047bfa19/UploadedImages/NCB_Conference/Presentations/2019/kolassa_toxslides.pdf</a>.
Accessed: 2019-07-14.
</p>

<hr>
<h2 id='summarizetable'>Summarize the results of simulations investigating operating conditions for the data reduction method to avoid monotone likelihood.  Files are of form &quot;hsxxx&quot;, for xxx numerals.</h2><span id='topic+summarizetable'></span>

<h3>Description</h3>

<p>Summarize the results of simulations investigating operating conditions for the data reduction method to avoid monotone likelihood.  Files are of form &quot;hsxxx&quot;, for xxx numerals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarizetable()
</code></pre>

<hr>
<h2 id='survregpredict'>Fit survival probabilties from a survreg object.</h2><span id='topic+survregpredict'></span>

<h3>Description</h3>

<p>Fit survival probabilties from a survreg object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survregpredict(fit, newdata, time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="survregpredict_+3A_fit">fit</code></td>
<td>
<p>a survreg object.  This should not contain strata().  It also must use the log transformation.</p>
</td></tr>
<tr><td><code id="survregpredict_+3A_newdata">newdata</code></td>
<td>
<p>a new data set with covariates from the fit.</p>
</td></tr>
<tr><td><code id="survregpredict_+3A_time">time</code></td>
<td>
<p>a time value (on the original, and not log, scale).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Fit the survival probability for an individual with extent 1 and
#differentiation 2 at 700 days from a Weibull regression using the 
#colon cancer data set distributed as part of the survival package.
fit&lt;-survreg(Surv(time,status)~factor(extent)+differ,data=colon)
survregpredict(fit,data.frame(extent=1,differ=2),700)
</code></pre>

<hr>
<h2 id='testcox'>Test size of asymptotic Cox tests.</h2><span id='topic+testcox'></span>

<h3>Description</h3>

<p>Test size of asymptotic Cox tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testcox(nsamp = 1000, nobs = 50, ncov = 5, randomcov = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testcox_+3A_nsamp">nsamp</code></td>
<td>
<p>Number of MC samples</p>
</td></tr>
<tr><td><code id="testcox_+3A_nobs">nobs</code></td>
<td>
<p>Number of observations</p>
</td></tr>
<tr><td><code id="testcox_+3A_ncov">ncov</code></td>
<td>
<p>Number of covariates</p>
</td></tr>
<tr><td><code id="testcox_+3A_randomcov">randomcov</code></td>
<td>
<p>Indicator of whether to draw random covariates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>level of two-sided test of nominal size 0.05.
</p>

<hr>
<h2 id='voter.ml'>Subset of British elections data used in (Kolassa 2016).  
Data are from (Sanders et al. 2007).</h2><span id='topic+voter.ml'></span>

<h3>Description</h3>

<p>Subset of British elections data used in (Kolassa 2016).  
Data are from (Sanders et al. 2007).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(voter.ml)
</code></pre>


<h3>References</h3>

<p>Sanders DJ, Whiteley PF, Clarke HD, Stewart M, Winters K (2007).
&ldquo;The British Election Study.&rdquo;
<a href="https://www.britishelectionstudy.com">https://www.britishelectionstudy.com</a>.
</p>
<p>Kolassa JE (2016).
&ldquo;Inference in the Presence of Likelihood Monotonicity for Polytomous and Logistic Regression.&rdquo;
<em>Advances in Pure Mathematics</em>, <b>6</b>, 331-341.
<a href="https://doi.org/10.4236/apm.2016.65024">doi:10.4236/apm.2016.65024</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(voter.ml)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
