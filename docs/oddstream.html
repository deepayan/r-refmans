<!DOCTYPE html><html><head><title>Help for package oddstream</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {oddstream}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#oddstream'><p>oddstream: A package for Outlier Detection in Data Streams</p></a></li>
<li><a href='#anomalous_stream'><p>Multivariate timeseries dataset with an anomalous event.</p></a></li>
<li><a href='#extract_tsfeatures'><p>Extract features from a collection of time series</p></a></li>
<li><a href='#find_odd_streams'><p>Detect outlying series within a collection of  sreaming time series</p></a></li>
<li><a href='#get_pc_space'><p>Define a feature space using the PCA components of the feature matrix</p></a></li>
<li><a href='#gg_featurespace'><p>Produces a ggplot object of two dimensional feature space.</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#set_outlier_threshold'><p>Set a threshold for outlier detection</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Outlier Detection in Data Streams</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Priyanga Dilini Talagala &lt;pritalagala@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>We proposes a framework that provides real time support for early detection of
    anomalous series within a large collection of streaming time series data. By definition, anomalies
    are rare in comparison to a system's typical behaviour. We define an anomaly as an observation that
    is very unlikely given the forecast distribution. The algorithm first forecasts a boundary for the
    system's typical behaviour using a representative sample of the typical behaviour of the system. An
    approach based on extreme value theory is used for this boundary prediction process. Then a sliding
    window is used to test for anomalous series within the newly arrived collection of series. Feature
    based representation of time series is used as the input to the model. To cope with concept drift,
    the forecast boundary for the system's typical behaviour is updated periodically.  More details
    regarding the algorithm can be found in Talagala, P. D., Hyndman, R. J., Smith-Miles, K., et al.
    (2019) &lt;<a href="https://doi.org/10.1080%2F10618600.2019.1617160">doi:10.1080/10618600.2019.1617160</a>&gt;.</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/pridiltal/oddstream/issues">https://github.com/pridiltal/oddstream/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>pcaPP, stats, ggplot2, ks, MASS, RcppRoll, mgcv, moments ,
RColorBrewer, mvtsplot, tibble, reshape, dplyr, graphics,
tidyr, kernlab, magrittr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, tidyverse</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-12-12 01:12:53 UTC; priyangatalagala</td>
</tr>
<tr>
<td>Author:</td>
<td>Priyanga Dilini Talagala [aut, cre],
  Rob J. Hyndman [ths],
  Kate Smith-Miles [ths]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-12-16 22:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='oddstream'>oddstream: A package for Outlier Detection in Data Streams</h2><span id='topic+oddstream'></span><span id='topic+oddstream-package'></span>

<h3>Description</h3>

<p>Rapid advances in hardware technology have enabled a wide range of physical objects, living  beings
and environments to be monitored using sensors attached to them. Over time these sensors generate
streams of time series data. Finding anomalous events in streaming time series data has become an
interesting research topic due to its wide range of possible applications such as: intrusion detection,
water contamination monitoring, machine health monitoring, etc. This package proposes a framework that
provides real time support for early detection of anomalous series within a large collection of streaming
time series data. By definition, anomalies are rare in comparison to a system's typical behaviour.
We define an anomaly as an observation that is very unlikely given the forecast distribution. The proposed
framework first forecasts a boundary for the system's typical behaviour using a representative sample of
the typical behaviour of the system. An approach based on extreme value theory is used for this boundary
prediction process. Then a sliding window is used to test for anomalous series within the newly arrived
collection of series. Feature based representation of time series is used as the input to the model. To
cope with concept drift, the forecast boundary for the system's typical behaviour is updated periodically.
More details regarding the algorithm can be found in Talagala, P. D., Hyndman, R. J., Smith-Miles, K., et al.
(2019) DOI:10.1080/10618600.2019.1617160.
</p>


<h3>Note</h3>

<p>The name <code>oddstream</code> comes from <code>Outlier Detection in Data STREAMs</code>
</p>


<h3>References</h3>

<p>Clifton, D. A., Hugueny, S., &amp; Tarassenko, L. (2011). Novelty detection with multivariate extreme value statistics.
Journal of signal processing systems, 65 (3),371-389.
</p>
<p>Talagala, P. D., Hyndman, R. J., Smith-Miles, K., et al. (2019). Anomaly detection in streaming nonstationary temporal data.
Journal of Computational and Graphical Statistics, 1-28. DOI:10.1080/10618600.2019.1617160.
</p>


<h3>See Also</h3>

<p>The core functions in this package: <code><a href="#topic+find_odd_streams">find_odd_streams</a></code>,  <code><a href="#topic+extract_tsfeatures">extract_tsfeatures</a></code>, <code><a href="#topic+get_pc_space">get_pc_space</a></code>,
<code><a href="#topic+set_outlier_threshold">set_outlier_threshold</a></code>, <code><a href="#topic+gg_featurespace">gg_featurespace</a></code>
</p>

<hr>
<h2 id='anomalous_stream'>Multivariate timeseries dataset with an anomalous event.</h2><span id='topic+anomalous_stream'></span>

<h3>Description</h3>

<p>A mutivariate time series dataset with some anomalous series. These time series are with noisy signals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anomalous_stream
</code></pre>


<h3>Format</h3>

<p>A data frame with  640 series each with 1459 time points.</p>

<hr>
<h2 id='extract_tsfeatures'>Extract features from a collection of time series</h2><span id='topic+extract_tsfeatures'></span>

<h3>Description</h3>

<p>This function extract time series features from a collection of time series.
This is a modification oftsmeasures function of anomalous package
package .
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_tsfeatures(y, normalise = TRUE, width = ifelse(frequency(y) &gt;
  1, frequency(y), 10), window = width)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_tsfeatures_+3A_y">y</code></td>
<td>
<p>A multivariate time serie</p>
</td></tr>
<tr><td><code id="extract_tsfeatures_+3A_normalise">normalise</code></td>
<td>
<p>If TRUE, each time series is scaled to be normally distributed with mean 0 and sd 1</p>
</td></tr>
<tr><td><code id="extract_tsfeatures_+3A_width">width</code></td>
<td>
<p>A window size for variance change, level shift and lumpiness</p>
</td></tr>
<tr><td><code id="extract_tsfeatures_+3A_window">window</code></td>
<td>
<p>A window size for KLscore</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class features with the following components:
</p>
<table>
<tr><td><code>mean</code></td>
<td>
<p>Mean</p>
</td></tr>
<tr><td><code>variance</code></td>
<td>
<p>Variance</p>
</td></tr>
<tr><td><code>lumpiness</code></td>
<td>
<p>Variance of annual variances of remainder</p>
</td></tr>
<tr><td><code>lshift</code></td>
<td>
<p>Level shift using rolling window</p>
</td></tr>
<tr><td><code>vchange</code></td>
<td>
<p>Variance change</p>
</td></tr>
<tr><td><code>linearity</code></td>
<td>
<p>Strength of linearity</p>
</td></tr>
<tr><td><code>curvature</code></td>
<td>
<p>Strength of curvature</p>
</td></tr>
<tr><td><code>spikiness</code></td>
<td>
<p>Strength of spikiness</p>
</td></tr>
<tr><td><code>season</code></td>
<td>
<p>Strength of seasonality</p>
</td></tr>
<tr><td><code>peak</code></td>
<td>
<p>Strength of peaks</p>
</td></tr>
<tr><td><code>trough</code></td>
<td>
<p>Strength of trough</p>
</td></tr>
<tr><td><code>BurstinessFF</code></td>
<td>
<p>Burstiness of time series using Fano Factor</p>
</td></tr>
<tr><td><code>minimum</code></td>
<td>
<p>Minimum value</p>
</td></tr>
<tr><td><code>maximum</code></td>
<td>
<p>Maximum value</p>
</td></tr>
<tr><td><code>rmeaniqmean</code></td>
<td>
<p>Ratio between interquartile mean and the arithmetic mean </p>
</td></tr>
<tr><td><code>moment3</code></td>
<td>
<p>Third moment</p>
</td></tr>
<tr><td><code>highlowmu</code></td>
<td>
<p>Ratio between the means of data that is below and upper the global mean</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hyndman, R. J., Wang, E., &amp; Laptev, N. (2015). Large-scale unusual time series detection.
In 2015 IEEE International Conference on Data Mining Workshop (ICDMW), (pp. 1616-1619). IEEE.<br />
</p>
<p>Fulcher, B. D. (2012). Highly comparative time-series analysis. PhD thesis, University of Oxford.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+find_odd_streams">find_odd_streams</a></code>, <code><a href="#topic+get_pc_space">get_pc_space</a></code>,
<code><a href="#topic+set_outlier_threshold">set_outlier_threshold</a></code>, <code><a href="#topic+gg_featurespace">gg_featurespace</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mvtsplot::mvtsplot(anomalous_stream, levels=8, gcol=2, norm="global")
features &lt;- extract_tsfeatures(anomalous_stream[500:550, ])
plot.ts(features[, 1:10])


</code></pre>

<hr>
<h2 id='find_odd_streams'>Detect outlying series within a collection of  sreaming time series</h2><span id='topic+find_odd_streams'></span>

<h3>Description</h3>

<p>This function detect outlying series within a collection of streaming time series. A sliding window
is used to handle straming data. In the precence of concept drift, the forecast boundary for the system's typical
behaviour can be updated periodically.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_odd_streams(train_data, test_stream, update_threshold = TRUE,
  window_length = nrow(train_data), window_skip = window_length,
  concept_drift = FALSE, trials = 500, p_rate = 0.001,
  cd_alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_odd_streams_+3A_train_data">train_data</code></td>
<td>
<p>A multivariate time series data set that represents the typical behaviour of the system.</p>
</td></tr>
<tr><td><code id="find_odd_streams_+3A_test_stream">test_stream</code></td>
<td>
<p>A multivariate streaming time series data set to be tested for outliers</p>
</td></tr>
<tr><td><code id="find_odd_streams_+3A_update_threshold">update_threshold</code></td>
<td>
<p>If TRUE, the threshold value to determine outlying series is updated.
The default value is set to TRUE</p>
</td></tr>
<tr><td><code id="find_odd_streams_+3A_window_length">window_length</code></td>
<td>
<p>Sliding window size (Ideally this window length should be equal to the length of the
training multivariate time series data set that is used to define the outlying threshold)</p>
</td></tr>
<tr><td><code id="find_odd_streams_+3A_window_skip">window_skip</code></td>
<td>
<p>The number of steps the window should slide forward. The default is set to window_length</p>
</td></tr>
<tr><td><code id="find_odd_streams_+3A_concept_drift">concept_drift</code></td>
<td>
<p>If TRUE, The outlying threshold will be updated after each window. The default is set
to FALSE</p>
</td></tr>
<tr><td><code id="find_odd_streams_+3A_trials">trials</code></td>
<td>
<p>Input for <code>set_outlier_threshold</code> function. Default value is set to 500.</p>
</td></tr>
<tr><td><code id="find_odd_streams_+3A_p_rate">p_rate</code></td>
<td>
<p>False positive rate. Default value is set to 0.001.</p>
</td></tr>
<tr><td><code id="find_odd_streams_+3A_cd_alpha">cd_alpha</code></td>
<td>
<p>Singnificance level for the test of non-stationarity.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with components
</p>
<table>
<tr><td><code>out_marix</code></td>
<td>
<p>The indices of the outlying series in each window</p>
</td></tr>
<tr><td><code>p_value</code></td>
<td>
<p>p-value for the two sample comparison test for concept drift detection</p>
</td></tr>
<tr><td><code>anom_threshold</code></td>
<td>
<p>anomalous threshold</p>
</td></tr>
</table>
<p>For each window a plot is also produced on the current
graphic device
</p>


<h3>References</h3>

<p>Clifton, D. A., Hugueny, S., &amp; Tarassenko, L. (2011). Novelty detection with multivariate
extreme value statistics. Journal of signal processing systems, 65 (3),371-389.
</p>
<p>Duong, T., Goud, B. &amp; Schauer, K. (2012) Closed-form density-based framework for automatic detection
of cellular morphology changes. PNAS, 109, 8382-8387.
</p>
<p>Talagala, P., Hyndman, R., Smith-Miles, K., Kandanaarachchi, S., &amp; Munoz, M. (2018).
Anomaly detection in streaming nonstationary temporal data (No. 4/18).
Monash University, Department of Econometrics and Business Statistics.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+extract_tsfeatures">extract_tsfeatures</a></code>, <code><a href="#topic+get_pc_space">get_pc_space</a></code>, <code><a href="#topic+set_outlier_threshold">set_outlier_threshold</a></code>,
<code><a href="#topic+gg_featurespace">gg_featurespace</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Generate training dataset
set.seed(890)
nobs = 250
nts = 100
train_data &lt;- ts(apply(matrix(ncol = nts, nrow = nobs), 2, function(nobs){10 + rnorm(nobs, 0, 3)}))
# Generate test stream with some outliying series
nobs = 15000
test_stream &lt;- ts(apply(matrix(ncol = nts, nrow = nobs), 2, function(nobs){10 + rnorm(nobs, 0, 3)}))
test_stream[360:1060, 20:25] = test_stream[360:1060, 20:25] * 1.75
test_stream[2550:3550, 20:25] =  test_stream[2550:3550, 20:25] * 2
find_odd_streams(train_data, test_stream , trials = 100)


# Considers the first window  of the data set as the training set and the remaining as
# the test stream

train_1data &lt;- anomalous_stream[1:100,]
test_stream &lt;-anomalous_stream[101:1456,]
find_odd_streams(train_data, test_stream , trials = 100)


</code></pre>

<hr>
<h2 id='get_pc_space'>Define a feature space using the PCA components of the feature matrix</h2><span id='topic+get_pc_space'></span>

<h3>Description</h3>

<p>Define a two dimensional feature space using the first two principal components generated from
the fetures matrix returned by <code>extract_tsfeatures</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_pc_space(features, robust = TRUE, kpc = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_pc_space_+3A_features">features</code></td>
<td>
<p>Feature matrix returned by <code><a href="#topic+extract_tsfeatures">extract_tsfeatures</a></code></p>
</td></tr>
<tr><td><code id="get_pc_space_+3A_robust">robust</code></td>
<td>
<p>If TRUE, a robust PCA will be used on the feature matrix.</p>
</td></tr>
<tr><td><code id="get_pc_space_+3A_kpc">kpc</code></td>
<td>
<p>Desired number of components to return.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns a list with class 'pcattributes' containing the following components:
</p>
<table>
<tr><td><code>pcnorm</code></td>
<td>
<p>The scores of the firt kpc pricipal components</p>
</td></tr>
<tr><td><code>center</code>, <code>scale</code></td>
<td>
<p>The centering and scaling used</p>
</td></tr>
<tr><td><code>rotation</code></td>
<td>
<p>the matrix of variable loadings (i.e., a matrix whose columns contain the eigenvectors).
The function <code>princomp</code> returns this in the element loadings.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="pcaPP.html#topic+PCAproj">PCAproj</a></code>, <code><a href="stats.html#topic+prcomp">prcomp</a></code>, <code><a href="#topic+find_odd_streams">find_odd_streams</a></code>,
<code><a href="#topic+extract_tsfeatures">extract_tsfeatures</a></code>, <code><a href="#topic+set_outlier_threshold">set_outlier_threshold</a></code>, <code><a href="#topic+gg_featurespace">gg_featurespace</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>features &lt;- extract_tsfeatures(anomalous_stream[1:100, 1:100])
pc &lt;- get_pc_space(features)

</code></pre>

<hr>
<h2 id='gg_featurespace'>Produces a ggplot object of two dimensional feature space.</h2><span id='topic+gg_featurespace'></span>

<h3>Description</h3>

<p>Create a ggplot object of two dimensional feature space  using the first two
pricipal component returned by <code><a href="#topic+get_pc_space">get_pc_space</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gg_featurespace(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gg_featurespace_+3A_object">object</code></td>
<td>
<p>Object of class &ldquo;<code>pcoddstream</code>&rdquo;.</p>
</td></tr>
<tr><td><code id="gg_featurespace_+3A_...">...</code></td>
<td>
<p>Other plotting parameters to affect the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object of two dimensional feature space.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+find_odd_streams">find_odd_streams</a></code>, <code><a href="#topic+extract_tsfeatures">extract_tsfeatures</a></code>, <code><a href="#topic+get_pc_space">get_pc_space</a></code>,
<code><a href="#topic+set_outlier_threshold">set_outlier_threshold</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>features &lt;- extract_tsfeatures(anomalous_stream[1:100, 1:100])
pc &lt;- get_pc_space(features)
p &lt;- gg_featurespace(pc)
p + ggplot2::geom_density_2d()
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>magrittr</dt><dd><p><code><a href="magrittr.html#topic++25+3E+25">%&gt;%</a></code></p>
</dd>
</dl>

<hr>
<h2 id='set_outlier_threshold'>Set a threshold for outlier detection</h2><span id='topic+set_outlier_threshold'></span>

<h3>Description</h3>

<p>This function forecasts a boundary for the typical behaviour using a representative sample
of the typical behaviour of a given system. An approach based on extreme value theory is used for this boundary
prediction process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_outlier_threshold(pc_pcnorm, p_rate = 0.001, trials = 500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_outlier_threshold_+3A_pc_pcnorm">pc_pcnorm</code></td>
<td>
<p>The scores of the first two pricipal components returned by <code><a href="#topic+get_pc_space">get_pc_space</a></code></p>
</td></tr>
<tr><td><code id="set_outlier_threshold_+3A_p_rate">p_rate</code></td>
<td>
<p>False positive rate. Default value is set to 0.001</p>
</td></tr>
<tr><td><code id="set_outlier_threshold_+3A_trials">trials</code></td>
<td>
<p>Number of trials to generate the extreme value distirbution. Default value is set to 500.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a threshold to determine outlying series in the next window  consists with a collection of
time series.
</p>


<h3>References</h3>

<p>Clifton, D. A., Hugueny, S., &amp; Tarassenko, L. (2011). Novelty detection with multivariate extreme value statistics.
Journal of signal processing systems, 65 (3),371-389.
</p>
<p>Talagala, P., Hyndman, R., Smith-Miles, K., Kandanaarachchi, S., &amp; Munoz, M. (2018).
Anomaly detection in streaming nonstationary temporal data (No. 4/18).
Monash University, Department of Econometrics and Business Statistics.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+find_odd_streams">find_odd_streams</a></code>,  <code><a href="#topic+extract_tsfeatures">extract_tsfeatures</a></code>, <code><a href="#topic+get_pc_space">get_pc_space</a></code>,
<code><a href="#topic+gg_featurespace">gg_featurespace</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate training dataset
set.seed(123)
nobs &lt;- 500
nts &lt;- 50
train_data &lt;- ts(apply(matrix(ncol = nts, nrow = nobs), 2, function(nobs){10 + rnorm(nobs, 0, 3)}))
features &lt;- extract_tsfeatures(train_data)
pc &lt;- get_pc_space(features)
threshold &lt;- set_outlier_threshold(pc$pcnorm)
threshold$threshold_fnx


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
