<!DOCTYPE html><html><head><title>Help for package REEMtree</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {REEMtree}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AutoCorrelationLRtest'><p>Test for autocorrelation in the residuals of a RE-EM tree</p></a></li>
<li><a href='#fitted.REEMtree'><p>Extract the fitted values from a RE-EM tree</p></a></li>
<li><a href='#is.REEMtree'><p>Is a RE-EM tree object</p></a></li>
<li><a href='#logLik'><p>Log-likelihood of a RE-EM tree</p></a></li>
<li><a href='#plot'><p>Plot the RE-EM tree</p></a></li>
<li><a href='#predict'><p>Predictions from a regression tree with individual-specific effects</p></a></li>
<li><a href='#print'><p>Print a RE-EM Tree object</p></a></li>
<li><a href='#ranef.REEMtree'><p>Extract the estimated random effects from a RE-EM tree</p></a></li>
<li><a href='#REEMtree'><p>Create a RE-EM tree</p></a></li>
<li><a href='#REEMtree-package'>
<p>Regression Trees with Random Effects for Longitudinal (Panel) Data</p></a></li>
<li><a href='#REEMtree.object'><p>Random Effects/Expectation Maximization (RE-EM) Tree Object</p></a></li>
<li><a href='#residuals.REEMtree'><p>Extract the residuals from a RE-EM tree</p></a></li>
<li><a href='#simpleREEMdata'><p>Sample Data for RE-EM trees</p></a></li>
<li><a href='#tree'><p>Extract the regression tree associated with a RE-EM tree</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Regression Trees with Random Effects for Longitudinal (Panel)
Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.90.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-24</td>
</tr>
<tr>
<td>Author:</td>
<td>Rebecca Sela, Jeffrey Simonoff and Wenbo Jing</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wenbo Jing &lt;wj2093@stern.nyu.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>nlme, rpart, methods, graphics, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>AER</td>
</tr>
<tr>
<td>Description:</td>
<td>A data mining approach for longitudinal and clustered data, 
        which combines the structure of mixed effects model with tree-based 
        estimation methods. See Sela, R.J. and Simonoff, J.S. (2012) RE-EM 
        trees: a data mining approach for longitudinal and clustered data 
        &lt;<a href="https://doi.org/10.1007%2Fs10994-011-5258-3">doi:10.1007/s10994-011-5258-3</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://pages.stern.nyu.edu/~jsimonof/REEMtree/">http://pages.stern.nyu.edu/~jsimonof/REEMtree/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-24 20:10:07 UTC; 92865</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-24 20:30:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='AutoCorrelationLRtest'>Test for autocorrelation in the residuals of a RE-EM tree</h2><span id='topic+AutoCorrelationLRtest'></span>

<h3>Description</h3>

<p>This function tests for autocorrelation in the residuals of a RE-EM tree using a likelihood ratio test.  The test keeps the tree structure of the RE-EM tree object fixed and uses a standard likelihood ratio test on the linear random effects model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AutoCorrelationLRtest(object, newdata=NULL, correlation=corAR1())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AutoCorrelationLRtest_+3A_object">object</code></td>
<td>
<p>A RE-EM tree</p>
</td></tr>
<tr><td><code id="AutoCorrelationLRtest_+3A_newdata">newdata</code></td>
<td>
<p>Dataset on which the test is to be performed; if none is given, the original dataset is used</p>
</td></tr>
<tr><td><code id="AutoCorrelationLRtest_+3A_correlation">correlation</code></td>
<td>
<p>Type of correlation to be tested for in the residuals.  The correlation can be any of type <code><a href="nlme.html#topic+corClasses">corClasses</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In general, <code>newdata</code> is likely to be the data used to estimate <code>object</code>.  The RE-EM tree can be estimated with or without allowing for autocorrelation.  Because the estimated tree may differ depending on whether autocorrelation is allowed in the RE-EM tree estimation process, but we recommend testing based on the tree estimated with autocorrelation allowed and the tree estimated without autocorrelation allowed.
</p>


<h3>Value</h3>

<table>
<tr><td><code>correlation</code></td>
<td>
<p>Type of correlation used in testing</p>
</td></tr>
<tr><td><code>loglik0</code></td>
<td>
<p>Likelihood of the random effects model if there is no autocorrelation</p>
</td></tr>
<tr><td><code>loglikAR</code></td>
<td>
<p>Likelihood of the random effects model if autocorrelation (of type AR(1)) is estimated</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>P-value of the likelihood ratio test</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Sela <a href="mailto:rsela@stern.nyu.edu">rsela@stern.nyu.edu</a></p>


<h3>References</h3>

<p>Sela, Rebecca J., and Simonoff, Jeffrey S., &ldquo;RE-EM Trees: A Data Mining Approach for Longitudinal and Clustered Data&rdquo;, <em>Machine Learning</em> (2011).</p>


<h3>See Also</h3>

<p><code><a href="nlme.html#topic+corClasses">corClasses</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simpleREEMdata)

# Estimation without autocorrelation
simpleEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID)
# Estimation with autocorrelation
simpleEMresult2&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID, correlation=corAR1())

# Autocorrelation test based on the first tree
AutoCorrelationLRtest(simpleEMresult, simpleREEMdata)
# Autocorrelation test based on the second tree
AutoCorrelationLRtest(simpleEMresult2, simpleREEMdata)
# Autocorrelation test with an alternative correlation structure
AutoCorrelationLRtest(simpleEMresult, simpleREEMdata, correlation=corCAR1())

</code></pre>

<hr>
<h2 id='fitted.REEMtree'>Extract the fitted values from a RE-EM tree</h2><span id='topic+fitted.REEMtree'></span>

<h3>Description</h3>

<p>This function extracts the fitted values from the LME object underlying the RE-EM tree.  The fitted values are the fixed effects (from the tree) plus the estimated contributions of the random effects to the fitted values at grouping levels less or equal to the level given.</p>


<h3>Usage</h3>

<pre><code class='language-R'> ## S3 method for class 'REEMtree'
fitted(object, level, asList, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.REEMtree_+3A_object">object</code></td>
<td>
<p>an object of class <code>REEMtree</code></p>
</td></tr>
<tr><td><code id="fitted.REEMtree_+3A_level">level</code></td>
<td>
<p>the level of random effects used in creating fitted values.  Level 0 is fixed effects; levels increase with the grouping of random effects.  Default is the highest level.</p>
</td></tr>
<tr><td><code id="fitted.REEMtree_+3A_aslist">asList</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code> and a single value is given in level, the returned object is a list with the fitted values split by groups; otherwise the returned value is either a vector or a data frame, according to the length of level. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitted.REEMtree_+3A_...">...</code></td>
<td>
<p>some methods for this generic require additional arguments; none are used here.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the level is a single value, the result is a vector or list (depending on <code>asList</code>) with the fitted values.  Otherwise, the result is a data frame with columns given by the fitted values at different levels.
</p>


<h3>Author(s)</h3>

<p>Rebecca Sela <a href="mailto:rsela@stern.nyu.edu">rsela@stern.nyu.edu</a></p>


<h3>References</h3>

<p>Sela, Rebecca J., and Simonoff, Jeffrey S., &ldquo;RE-EM Trees: A Data Mining Approach for Longitudinal and Clustered Data&rdquo;, <em>Machine Learning</em> (2011).</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+fitted">fitted</a></code>, <code><a href="#topic+REEMtree.object">REEMtree.object</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simpleREEMdata)
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID)
fitted(REEMresult)
</code></pre>

<hr>
<h2 id='is.REEMtree'>Is a RE-EM tree object</h2><span id='topic+is.REEMtree'></span>

<h3>Description</h3>

<p>This function tests whether an object is of the <code>REEMtree</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   is.REEMtree(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.REEMtree_+3A_object">object</code></td>
<td>
<p>any R object</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> if the object is of the <code>REEMtree</code> type
</p>


<h3>Author(s)</h3>

<p>Rebecca Sela <a href="mailto:rsela@stern.nyu.edu">rsela@stern.nyu.edu</a></p>


<h3>References</h3>

<p>Sela, Rebecca J., and Simonoff, Jeffrey S., &ldquo;RE-EM Trees: A Data Mining Approach for Longitudinal and Clustered Data&rdquo;, <em>Machine Learning</em> (2011).</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simpleREEMdata)
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID)
is.REEMtree(REEMresult)
</code></pre>

<hr>
<h2 id='logLik'>Log-likelihood of a RE-EM tree</h2><span id='topic+logLik.REEMtree'></span>

<h3>Description</h3>

<p>This returns the log-likelihood of the effects model of a RE-EM tree. This is the log-likelihood of the random effects model estimated in the RE-EM tree.  (The regression tree is not associated with a log-likelihood.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'REEMtree'
logLik(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik_+3A_object">object</code></td>
<td>
<p>an object of class <code>REEMtree</code></p>
</td></tr>
<tr><td><code id="logLik_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the log-likelihood of the fitted effects model associated with <code>x</code></p>


<h3>Author(s)</h3>

<p>Rebecca Sela <a href="mailto:rsela@stern.nyu.edu">rsela@stern.nyu.edu</a></p>


<h3>References</h3>

<p>Sela, Rebecca J., and Simonoff, Jeffrey S., &ldquo;RE-EM Trees: A Data Mining Approach for Longitudinal and Clustered Data&rdquo;, <em>Machine Learning</em> (2011).</p>


<h3>See Also</h3>

<p><code><a href="#topic+REEMtree.object">REEMtree.object</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simpleREEMdata)
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID)
logLik(REEMresult)
</code></pre>

<hr>
<h2 id='plot'>Plot the RE-EM tree</h2><span id='topic+plot.REEMtree'></span>

<h3>Description</h3>

<p>Plots the regression tree associated with a RE-EM tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'REEMtree'
plot(x, text = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>a fitted object of class <code>REEMtree</code></p>
</td></tr>
<tr><td><code id="plot_+3A_text">text</code></td>
<td>
<p>if <code>TRUE</code>, the text of the tree will be plotted on the tree automatically.</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the coordinates of the nodes are returned as a list, with components <code>x</code> and <code>y</code>.
</p>


<h3>Author(s)</h3>

<p>Rebecca Sela <a href="mailto:rsela@stern.nyu.edu">rsela@stern.nyu.edu</a></p>


<h3>References</h3>

<p>Sela, Rebecca J., and Simonoff, Jeffrey S., &ldquo;RE-EM Trees: A Data Mining Approach for Longitudinal and Clustered Data&rdquo;, <em>Machine Learning</em> (2011).</p>


<h3>See Also</h3>

<p><code><a href="#topic+REEMtree">REEMtree</a></code>, <code><a href="rpart.html#topic+plot.rpart">plot.rpart</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simpleREEMdata)
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID)
plot(REEMresult)
</code></pre>

<hr>
<h2 id='predict'>Predictions from a regression tree with individual-specific effects</h2><span id='topic+predict.REEMtree'></span>

<h3>Description</h3>

<p>Returns a vector of predictions from a fitted RE-EM Tree.  Predictions are based on the node of the tree in which the new observation would fall and (optionally) an estimated random effect for the observation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'REEMtree'
predict(object, newdata, id = NULL,
	EstimateRandomEffects = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_+3A_object">object</code></td>
<td>
<p>a fitted <code>REEMtree</code></p>
</td></tr>
<tr><td><code id="predict_+3A_newdata">newdata</code></td>
<td>
<p>an data frame to be used for obtaining the predictions. All variables used in the fixed and random effects models, including the group identifier, must be present in the data frame.  New values of the group identifier are allowed.  Unlike in <code>predict.lme</code> and <code>predict.rpart</code>, the data frame is required</p>
</td></tr>
<tr><td><code id="predict_+3A_id">id</code></td>
<td>
<p>a string containing the name of the variable that is used to identify the groups.  This is required if <code>EstimateRandomEffects=TRUE</code> and  <code>newdata</code> does not match the data used to estimate the random effects model that created <code>object</code>.</p>
</td></tr>
<tr><td><code id="predict_+3A_estimaterandomeffects">EstimateRandomEffects</code></td>
<td>
<p>if <code>TRUE</code>, the fitted effects will be included in the estimates and effects for new groups will be estimated wherever the target variable is not missing.  If <code>FALSE</code> or if the random effect cannot be estimated, random effects are set to 0, so that only the fixed effects based on the regression tree are used.</p>
</td></tr>
<tr><td><code id="predict_+3A_...">...</code></td>
<td>
<p>additional arguments that will be passed through to <code>rpart</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>EstimateRandomEffects=TRUE</code> and a group was not used in the original estimation, its random effect must be estimated.  If there are no non-missing values of the target variable for this group, then the new effect is set to 0.
</p>
<p>If there are non-missing values of the target variable, then the random effect is estimated based on the estimated variance of the errors and variance of the random effects in the fitted model.  See Equation 3.2 of Laird and Ware (1982) for the precise relationship.
</p>
<p>Important note: In this implementation, estimation of group effects for new groups can be used only with group-specific intercepts are estimated with only one grouping variable.
</p>


<h3>Value</h3>

<p>a vector containing the predicted values
</p>


<h3>Author(s)</h3>

<p>Rebecca Sela <a href="mailto:rsela@stern.nyu.edu">rsela@stern.nyu.edu</a></p>


<h3>References</h3>

<p>Sela, Rebecca J., and Simonoff, Jeffrey S., &ldquo;RE-EM Trees: A Data Mining Approach for Longitudinal Data&rdquo;, <em>Machine Learning</em>, 2011; Laird, N. M., and J. H. Ware (1982), &ldquo;Random-effects models for longitudinal data&rdquo;, <em>Biometrics</em> 38: 963-974</p>


<h3>See Also</h3>

<p><code><a href="nlme.html#topic+predict.nlme">predict.nlme</a></code>, <code><a href="rpart.html#topic+predict.rpart">predict.rpart</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simpleREEMdata)
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID)
predict(REEMresult, simpleREEMdata, EstimateRandomEffects=FALSE)
predict(REEMresult, simpleREEMdata, id=simpleREEMdata$ID, EstimateRandomEffects=TRUE)

# Estimation based on a subset that excludes the last two time series,
# with predictions for all observations
sub &lt;- rep(c(rep(TRUE, 10), rep(FALSE, 2)), 50)
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID,
	subset=sub)
pred1 &lt;- predict(REEMresult, simpleREEMdata, EstimateRandomEffects=FALSE)
pred2 &lt;- predict(REEMresult, simpleREEMdata, id=simpleREEMdata$ID, EstimateRandomEffects=TRUE)

# Estimation based on a subset that excludes the last five individuals,
# with predictions for all observations
sub &lt;- c(rep(TRUE, 540), rep(FALSE, 60))
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID,
	subset=sub)
pred3 &lt;- predict(REEMresult, simpleREEMdata, EstimateRandomEffects=FALSE)
pred4 &lt;- predict(REEMresult, simpleREEMdata, id=simpleREEMdata$ID, EstimateRandomEffects=TRUE)

</code></pre>

<hr>
<h2 id='print'>Print a RE-EM Tree object</h2><span id='topic+print.REEMtree'></span>

<h3>Description</h3>

<p>This function prints a description of a fitted RE-EM tree object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> ## S3 method for class 'REEMtree'
print(x,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_+3A_x">x</code></td>
<td>
<p>fitted model of class <code>REEMtree</code></p>
</td></tr>
<tr><td><code id="print_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a method for the generic function print for class <code>REEMtree</code>. It can be invoked by calling print for an object of class <code>REEMtree</code>, or by calling <code>print.REEMtree</code> directly for an object of the corresponding type. </p>


<h3>Side Effects</h3>

<p>Prints representations of the regression tree and the random effects model that comprise a RE-EM tree.
</p>


<h3>Author(s)</h3>

<p>Rebecca Sela <a href="mailto:rsela@stern.nyu.edu">rsela@stern.nyu.edu</a></p>


<h3>References</h3>

<p>Sela, Rebecca J., and Simonoff, Jeffrey S., &ldquo;RE-EM Trees: A Data Mining Approach for Longitudinal and Clustered Data&rdquo;, <em>Machine Learning</em> (2011).</p>


<h3>See Also</h3>

<p><code><a href="rpart.html#topic+print.rpart">print.rpart</a></code>, <code><a href="#topic+REEMtree.object">REEMtree.object</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simpleREEMdata)
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID)
print(REEMresult)
</code></pre>

<hr>
<h2 id='ranef.REEMtree'>Extract the estimated random effects from a RE-EM tree</h2><span id='topic+ranef.REEMtree'></span>

<h3>Description</h3>

<p>This function extracts the estimated random effects from a fitted RE-EM tree.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'REEMtree'
ranef(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ranef.REEMtree_+3A_object">object</code></td>
<td>
<p>an object of class <code>REEMtree</code></p>
</td></tr>
<tr><td><code id="ranef.REEMtree_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector containing the estimated random effects
</p>


<h3>Author(s)</h3>

<p>Rebecca Sela <a href="mailto:rsela@stern.nyu.edu">rsela@stern.nyu.edu</a></p>


<h3>References</h3>

<p>Sela, Rebecca J., and Simonoff, Jeffrey S., &ldquo;RE-EM Trees: A Data Mining Approach for Longitudinal and Clustered Data&rdquo;, <em>Machine Learning</em> (2011).</p>


<h3>See Also</h3>

<p><code><a href="nlme.html#topic+random.effects">random.effects</a></code>, <code><a href="#topic+REEMtree.object">REEMtree.object</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simpleREEMdata)
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID)
ranef(REEMresult)
</code></pre>

<hr>
<h2 id='REEMtree'>Create a RE-EM tree</h2><span id='topic+REEMtree'></span>

<h3>Description</h3>

<p>Fit a RE-EM tree to data.  This estimates a regression tree combined with a linear random effects model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>REEMtree(formula, data, random, subset=NULL,
         initialRandomEffects=rep(0,TotalObs),
         ErrorTolerance=0.001, MaxIterations=1000,
         verbose=FALSE, tree.control=rpart.control(cp=0.001),
         cv=TRUE, no.SE =1,
         lme.control=lmeControl(returnObject=TRUE),
         method="REML", correlation=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="REEMtree_+3A_formula">formula</code></td>
<td>
<p>a formula, as in the <code>lm</code> or <code>rpart</code> function</p>
</td></tr>
<tr><td><code id="REEMtree_+3A_data">data</code></td>
<td>
<p>a data frame in which to interpret the variables named in the formula (unlike in <code>lm</code> or <code>rpart</code>, this is not optional)</p>
</td></tr>
<tr><td><code id="REEMtree_+3A_random">random</code></td>
<td>
<p>a description of the random effects, as a formula of the form <code>~1|g</code>, where <code>g</code> is the grouping variable</p>
</td></tr>
<tr><td><code id="REEMtree_+3A_subset">subset</code></td>
<td>
<p>an optional logical vector indicating the subset of the rows of data that should be used in the fit. All observations are included by default.</p>
</td></tr>
<tr><td><code id="REEMtree_+3A_initialrandomeffects">initialRandomEffects</code></td>
<td>
<p>an optional vector giving initial values for the random effects to use in estimation</p>
</td></tr>
<tr><td><code id="REEMtree_+3A_errortolerance">ErrorTolerance</code></td>
<td>
<p>when the difference in the likelihoods of the linear models of two consecutive iterations is less than this value, the RE-EM tree has converged</p>
</td></tr>
<tr><td><code id="REEMtree_+3A_maxiterations">MaxIterations</code></td>
<td>
<p>maximum number of iterations allowed in estimation</p>
</td></tr>
<tr><td><code id="REEMtree_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code>, the current estimate of the RE-EM tree will be printed after each iteration</p>
</td></tr>
<tr><td><code id="REEMtree_+3A_tree.control">tree.control</code></td>
<td>
<p>a list of control values for the estimation algorithm to replace the default values used to control the <code>rpart</code> algorithm. Defaults to an empty list.</p>
</td></tr>
<tr><td><code id="REEMtree_+3A_cv">cv</code></td>
<td>
<p>if <code>TRUE</code> then cross-validation will be used for estimating the tree at each iteration.  Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="REEMtree_+3A_no.se">no.SE</code></td>
<td>
<p>number of standard errors used in pruning (0 if unused)</p>
</td></tr>
<tr><td><code id="REEMtree_+3A_lme.control">lme.control</code></td>
<td>
<p>a list of control values for the estimation algorithm to replace the default values returned by the function <code>lmeControl</code>. Defaults to an empty list.</p>
</td></tr>
<tr><td><code id="REEMtree_+3A_method">method</code></td>
<td>
<p>whether the linear model should be estimated with <code>ML</code> or <code>REML</code> </p>
</td></tr>
<tr><td><code id="REEMtree_+3A_correlation">correlation</code></td>
<td>
<p>an optional <code>corStruct</code> object describing the within-group correlation structure; the available classes are given in <code><a href="nlme.html#topic+corClasses">corClasses</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>REEMtree</code>
</p>


<h3>Author(s)</h3>

<p>Rebecca Sela <a href="mailto:rsela@stern.nyu.edu">rsela@stern.nyu.edu</a></p>


<h3>References</h3>

<p>Sela, Rebecca J., and Simonoff, Jeffrey S., &ldquo;RE-EM Trees: A Data Mining Approach for Longitudinal and Clustered Data&rdquo;, <em>Machine Learning</em> (2011).</p>


<h3>See Also</h3>

<p><code><a href="rpart.html#topic+rpart">rpart</a></code>, <code><a href="nlme.html#topic+nlme">nlme</a></code>, <code><a href="#topic+REEMtree.object">REEMtree.object</a></code>, <code><a href="nlme.html#topic+corClasses">corClasses</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simpleREEMdata)
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID)

# Estimation allowing for autocorrelation
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID,
	correlation=corAR1())

# Random parameters model for the random effects
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1+X|ID)

# Estimation with a subset
sub &lt;- rep(c(rep(TRUE, 10), rep(FALSE, 2)), 50)
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID,
	subset=sub)

# Dataset from the R library "AER"
data("Grunfeld", package = "AER")
REEMtree(invest ~ value + capital, data=Grunfeld, random=~1|firm)
REEMtree(invest ~ value + capital, data=Grunfeld, random=~1|firm, correlation=corAR1())
REEMtree(invest ~ value + capital, data=Grunfeld, random=~1+year|firm)
REEMtree(invest ~ value + capital, data=Grunfeld, random=~1|firm/year)

</code></pre>

<hr>
<h2 id='REEMtree-package'>
Regression Trees with Random Effects for Longitudinal (Panel) Data
</h2><span id='topic+REEMtree-package'></span>

<h3>Description</h3>

<p>This package estimates regression trees with random effects as a way to use data mining techniques to describe longitudinal or panel data.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> REEMtree</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2009-05-07</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Rebecca Sela <a href="mailto:rsela@stern.nyu.edu">rsela@stern.nyu.edu</a></p>


<h3>References</h3>

<p>Sela, Rebecca J., and Simonoff, Jeffrey S., &ldquo;RE-EM Trees: A Data Mining Approach for Longitudinal and Clustered Data&rdquo;, <em>Machine Learning</em> (2011).</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simpleREEMdata)
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID)
print(REEMresult)
</code></pre>

<hr>
<h2 id='REEMtree.object'>Random Effects/Expectation Maximization (RE-EM) Tree Object</h2><span id='topic+REEMtree.object'></span>

<h3>Description</h3>

<p>Object representing a fitted <code>REEMtree</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Tree</code></td>
<td>
<p>Fitted <code>rpart</code> tree associated with the fitted RE-EM tree</p>
</td></tr>
<tr><td><code>EffectModel</code></td>
<td>
<p>fitted <code>lme</code> object associated with the fitted RE-EM tree</p>
</td></tr>
<tr><td><code>RandomEffects</code></td>
<td>
<p>vector of estimated random effects</p>
</td></tr>
<tr><td><code>BetweenMatrix</code></td>
<td>
<p>estimated variance of the random effects</p>
</td></tr>
<tr><td><code>ErrorVariance</code></td>
<td>
<p>estimated variance of the errors</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the data frame used to estimate the RE-EM tree</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p>log likelihood of the linear model for the random effects</p>
</td></tr>
<tr><td><code>IterationsUsed</code></td>
<td>
<p>number of iterations required to fit the <code>REEMtree</code></p>
</td></tr>
<tr><td><code>Formula</code></td>
<td>
<p>formula used in fitting the <code>REEMtree</code></p>
</td></tr>
<tr><td><code>Random</code></td>
<td>
<p>description of the random effects used in fitting the <code>REEMtree</code></p>
</td></tr>
<tr><td><code>Groups</code></td>
<td>
<p>the vector of group identifiers used in estimation</p>
</td></tr>
<tr><td><code>Subset</code></td>
<td>
<p>the logical vector indicating the subset of the rows of data used in the fit</p>
</td></tr>
<tr><td><code>ErrorTolerance</code></td>
<td>
<p>the error tolerance used in estimation</p>
</td></tr>
<tr><td><code>correlation</code></td>
<td>
<p>the correlation structure used in fitting the linear model</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>estimated residuals</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>method (<code>ML</code> or <code>REML</code>) used in estimating the linear random effects model</p>
</td></tr>
<tr><td><code>lme.control</code></td>
<td>
<p>parameters used to control fitting the linear random effects mdoel</p>
</td></tr>
<tr><td><code>tree.control</code></td>
<td>
<p>parameters used to control fitting the regression tree</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Sela <a href="mailto:rsela@stern.nyu.edu">rsela@stern.nyu.edu</a></p>


<h3>References</h3>

<p>Sela, Rebecca J., and Simonoff, Jeffrey S., &ldquo;RE-EM Trees: A Data Mining Approach for Longitudinal and Clustered Data&rdquo;, <em>Machine Learning</em> (2011).</p>


<h3>See Also</h3>

<p><code><a href="rpart.html#topic+rpart">rpart</a></code>, <code><a href="nlme.html#topic+nlme">nlme</a></code>, <code><a href="#topic+REEMtree">REEMtree</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simpleREEMdata)
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID)
</code></pre>

<hr>
<h2 id='residuals.REEMtree'>Extract the residuals from a RE-EM tree</h2><span id='topic+residuals.REEMtree'></span>

<h3>Description</h3>

<p>This function extracts the residuals from the LME object underlying the RE-EM tree.  The residuals depend on the fixed effects (from the tree) plus the estimated contributions of the random effects to the fitted values at grouping levels less or equal to the level given. </p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'REEMtree'
residuals(object, level, type, asList, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.REEMtree_+3A_object">object</code></td>
<td>
<p>an object of class <code>REEMtree</code></p>
</td></tr>
<tr><td><code id="residuals.REEMtree_+3A_level">level</code></td>
<td>
<p>the level of random effects used in creating residuals.  Level 0 is fixed effects only; levels increase with the grouping of random effects.  Default is the highest level.</p>
</td></tr>
<tr><td><code id="residuals.REEMtree_+3A_type">type</code></td>
<td>
<p>optional character string specifying the type of residuals to be used. If <code>"response"</code>, the &quot;raw&quot; residuals (observed - fitted) are used. If <code>"pearson"</code>, the standardized residuals (raw residuals divided by the corresponding standard errors) are used. If <code>"normalized"</code>, the normalized residuals (standardized residuals pre-multiplied by the inverse square-root factor of the estimated error correlation matrix) are used. Only the first character needs to be provided. Defaults to <code>"pearson"</code>.</p>
</td></tr>
<tr><td><code id="residuals.REEMtree_+3A_aslist">asList</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code> and a single value is given in level, the returned object is a list with the residuals split by groups; otherwise the returned value is either a vector or a data frame, according to the length of level. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="residuals.REEMtree_+3A_...">...</code></td>
<td>
<p>some methods for this generic require additional arguments; none are used here.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the level is a single value, the result is a vector or list (depending on <code>asList</code>) with the residuals.  Otherwise, the result is a data frame with columns given by the residuals at different levels.
</p>


<h3>Author(s)</h3>

<p>Rebecca Sela <a href="mailto:rsela@stern.nyu.edu">rsela@stern.nyu.edu</a></p>


<h3>References</h3>

<p>Sela, Rebecca J., and Simonoff, Jeffrey S., &ldquo;RE-EM Trees: A Data Mining Approach for Longitudinal and Clustered Data&rdquo;, <em>Machine Learning</em> (2011).</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+residuals">residuals</a></code>, <code><a href="#topic+REEMtree.object">REEMtree.object</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simpleREEMdata)
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID)
residuals(REEMresult)
</code></pre>

<hr>
<h2 id='simpleREEMdata'>Sample Data for RE-EM trees</h2><span id='topic+simpleREEMdata'></span>

<h3>Description</h3>

<p>This data set is consists of a panel of 50 individuals with 12 observations per individual.  The data is based on a regression tree with an initial split based on a dummy variable (<code>D</code>) and a second split based on time in the branch where <code>D=1</code>.  The observations include both randomly generated individual-specific effects and observation-specific errors.
</p>


<h3>Format</h3>

<p>The data has 600 rows and 5 columns.  The columns are: 
</p>

<ul>
<li> <p><code>Y</code> - the target variable
</p>
</li>
<li> <p><code>t</code> - a numeric predictor (&quot;time&quot;)
</p>
</li>
<li> <p><code>D</code> - a catergorical predictor with two levels, 0 and 1
</p>
</li>
<li> <p><code>ID</code> - the identifier for each individual
</p>
</li>
<li> <p><code>X</code> - another covariate (which is intentionally unrelated to the target variable)
</p>
</li></ul>



<h3>References</h3>

<p>Sela, Rebecca J., and Simonoff, Jeffrey S., &ldquo;RE-EM Trees: A Data Mining Approach for Longitudinal and Clustered Data&rdquo;, <em>Machine Learning</em> (2011).</p>

<hr>
<h2 id='tree'>Extract the regression tree associated with a RE-EM tree</h2><span id='topic+tree'></span><span id='topic+tree.REEMtree'></span>

<h3>Description</h3>

<p>Returns the fitted <code>rpart</code> object associated with a <code>REEMtree</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tree(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tree_+3A_object">object</code></td>
<td>
<p>an object of class <code>REEMtree</code></p>
</td></tr>
<tr><td><code id="tree_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the fitted regression tree associated with the <code>REEMtree</code> object
</p>


<h3>Author(s)</h3>

<p>Rebecca Sela <a href="mailto:rsela@stern.nyu.edu">rsela@stern.nyu.edu</a></p>


<h3>References</h3>

<p>Sela, Rebecca J., and Simonoff, Jeffrey S., &ldquo;RE-EM Trees: A Data Mining Approach for Longitudinal and Clustered Data&rdquo;, <em>Machine Learning</em> (2011).</p>


<h3>See Also</h3>

<p><code><a href="rpart.html#topic+rpart.object">rpart.object</a></code>, <code><a href="#topic+REEMtree.object">REEMtree.object</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simpleREEMdata)
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID)
tree.REEMtree(REEMresult)
tree(REEMresult)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
