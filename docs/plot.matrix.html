<!DOCTYPE html><html><head><title>Help for package plot.matrix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {plot.matrix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#air.pvalue'><p>New York Air Quality Measurements</p></a></li>
<li><a href='#as.cor'><p>as.XXX conversion functions</p></a></li>
<li><a href='#assignColors'><p>assignColors</p></a></li>
<li><a href='#bfi.2'><p>25 Personality items representing 5 factors</p></a></li>
<li><a href='#fmt'><p>fmt</p></a></li>
<li><a href='#plot.assoc'><p>plot.assoc</p></a></li>
<li><a href='#plot.cor'><p>plot.cor</p></a></li>
<li><a href='#plot.loadings'><p>plot.loadings</p></a></li>
<li><a href='#plot.matrix'><p>plot.matrix</p></a></li>
<li><a href='#plot.pvalue'><p>plot.pvalue</p></a></li>
<li><a href='#Titanic.cramer'><p>Survival of passengers on the Titanic</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Visualizes a Matrix as Heatmap</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-03-16</td>
</tr>
<tr>
<td>Description:</td>
<td>Visualizes a matrix object plainly as heatmap. It provides S3 functions to plot simple matrices and loading matrices.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/sigbertklinke/plot.matrix">https://github.com/sigbertklinke/plot.matrix</a> (development version)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>devtools, knitr, rmarkdown, psych, png</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-16 10:32:02 UTC; sk</td>
</tr>
<tr>
<td>Author:</td>
<td>Sigbert Klinke [aut, cre],
  Frédéric Chevalier [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sigbert Klinke &lt;sigbert@hu-berlin.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-16 11:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='air.pvalue'>New York Air Quality Measurements</h2><span id='topic+air.pvalue'></span>

<h3>Description</h3>

<p>p-values of pairwise correlation test of the complete-cases of 
daily air quality measurements in New York, May to September 1973.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(air.pvalue)
</code></pre>


<h3>Format</h3>

<p>A 4x4 matrix with p values of pairwise correlation tests (<code><a href="stats.html#topic+cor.test">cor.test</a></code>).
</p>

<dl>
<dt><code>Ozone</code></dt><dd><p>Ozone (ppb)</p>
</dd>
<dt><code>Solar.R</code></dt><dd><p>Solar R (lang)</p>
</dd>
<dt><code>Wind</code></dt><dd><p>Wind (mph)</p>
</dd>
<dt><code>Temp</code></dt><dd><p>Temperature (degrees F)</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data are derived from the <a href="datasets.html#topic+airquality">New York Air Quality Measurements</a> data set.
</p>


<h3>References</h3>

<p>Chambers, J. M., Cleveland, W. S., Kleiner, B. and Tukey, P. A. (1983) Graphical Methods for Data Analysis. Belmont, CA: Wadsworth.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(air.pvalue)
plot(as.pvalue(air.pvalue))
</code></pre>

<hr>
<h2 id='as.cor'>as.XXX conversion functions</h2><span id='topic+as.cor'></span><span id='topic+as.assoc'></span><span id='topic+as.pvalue'></span>

<h3>Description</h3>

<p>as.XXX conversion functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.cor(x)

as.assoc(x)

as.pvalue(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.cor_+3A_x">x</code></td>
<td>
<p>numeric matrix: matrix to convert</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with an appropriate class
</p>


<h3>Examples</h3>

<pre><code class='language-R'># as.cor
c &lt;- cor(airquality, use="complete.obs")
# as.assoc
# as.pvalue
data(air.pvalue)
plot(as.pvalue(air.pvalue))
</code></pre>

<hr>
<h2 id='assignColors'>assignColors</h2><span id='topic+assignColors'></span>

<h3>Description</h3>

<p>Assign to each value in <code>x</code> a color according to the choices of <code>breaks</code> and <code>col</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assignColors(x, breaks = NULL, col = heat.colors, na.col = "white")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="assignColors_+3A_x">x</code></td>
<td>
<p>numeric or non-numeric vector</p>
</td></tr>
<tr><td><code id="assignColors_+3A_breaks">breaks</code></td>
<td>
<p>vector with breaks</p>
</td></tr>
<tr><td><code id="assignColors_+3A_col">col</code></td>
<td>
<p>vector with colors or color function</p>
</td></tr>
<tr><td><code id="assignColors_+3A_na.col">na.col</code></td>
<td>
<p>color for NA or out-of-range values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Depending if <code>x</code> is a numeric or non-numeric vector colors 
are assigned to each value. 
</p>
<p>In case of a numeric vector <code>breaks</code> can be 
</p>

<ul>
<li><p> a number, giving the number of intervals covering the range of <code>x</code>,
</p>
</li>
<li><p> a vector of two numbers, given the range to cover with 10 intervals, or
</p>
</li>
<li><p> a vector with more than two numbers, specify the interval borders
</p>
</li></ul>

<p>In case of a non-numeric vector <code>breaks</code> must contain all values which are
will get a color.
If <code>breaks</code> is not given then a sensible default is choosen: 
in case of a numeric vector derived from <code><a href="base.html#topic+pretty">pretty</a></code> and 
otherwise all unique values/levels are used.
</p>
<p><code>col</code> can be either be a vector of colors or a function which generates
via <code>col(n)</code> a set of <code>n</code> colors. The default is to use 
<code><a href="grDevices.html#topic+heat.colors">heat.colors</a></code>.
</p>
<p>Possible color functions in R packages can be found by <code>vignette('plot.matrix')</code>.
</p>


<h3>Value</h3>

<p>vector of color with the same length as <code>x</code> with the attributes
<code>breaks</code> the breaks used, <code>col</code> the color coding and <code>na.col</code> 
the color for <code>NA</code> and out-of-range entries
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## numeric vector
x &lt;- runif(10)
assignColors(x)
# set breaks
assignColors(x, breaks=15)
assignColors(x, breaks=c(0,1))
# set colors
assignColors(x, col=c("red", "green", "blue"))
assignColors(x, col=topo.colors)
# NA and out-of-range
x[5] &lt;- NA
assignColors(x, breaks=seq(0.5, 1, by=0.1), na.col="red")
## logical vector
l &lt;- sample(c(NA, TRUE, FALSE), size=10, replace=TRUE)
assignColors(l)
assignColors(l, breaks=c("FALSE", "TRUE"), col=c("red", "blue"))
## character vector
t &lt;- sample(letters, size=10, replace=TRUE)
assignColors(t)
assignColors(t, col=rainbow(5))
</code></pre>

<hr>
<h2 id='bfi.2'>25 Personality items representing 5 factors</h2><span id='topic+bfi.2'></span>

<h3>Description</h3>

<p>25 personality self report items taken from the International Personality Item Pool (ipip.ori.org) were included as 
part of the Synthetic Aperture Personality Assessment (SAPA) web based personality assessment project.  
In contrast to the original data <code>bfi</code> from the library <code>psych</code> (version 1.8.12) 
it contains only the 25 personality self report items and the 2436 complete observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bfi.2)
</code></pre>


<h3>Format</h3>

<p>A data frame with 2436 observations on the following 25 variables (the q numbers are the SAPA item numbers).
</p>

<dl>
<dt><code>A1</code></dt><dd><p>Am indifferent to the feelings of others. (q_146)</p>
</dd>
<dt><code>A2</code></dt><dd><p>Inquire about others' well-being. (q_1162)</p>
</dd>
<dt><code>A3</code></dt><dd><p>Know how to comfort others. (q_1206) </p>
</dd>
<dt><code>A4</code></dt><dd><p>Love children. (q_1364)</p>
</dd>
<dt><code>A5</code></dt><dd><p>Make people feel at ease. (q_1419)</p>
</dd>
<dt><code>C1</code></dt><dd><p>Am exacting in my work. (q_124)</p>
</dd>
<dt><code>C2</code></dt><dd><p>Continue until everything is perfect. (q_530)</p>
</dd>
<dt><code>C3</code></dt><dd><p>Do things according to a plan. (q_619)</p>
</dd>
<dt><code>C4</code></dt><dd><p>Do things in a half-way manner. (q_626)</p>
</dd>
<dt><code>C5</code></dt><dd><p>Waste my time. (q_1949)</p>
</dd>
<dt><code>E1</code></dt><dd><p>Don't talk a lot. (q_712)</p>
</dd>
<dt><code>E2</code></dt><dd><p>Find it difficult to approach others. (q_901)</p>
</dd>
<dt><code>E3</code></dt><dd><p>Know how to captivate people. (q_1205)</p>
</dd>
<dt><code>E4</code></dt><dd><p>Make friends easily. (q_1410)</p>
</dd>
<dt><code>E5</code></dt><dd><p>Take charge. (q_1768)</p>
</dd>
<dt><code>N1</code></dt><dd><p>Get angry easily. (q_952)</p>
</dd>
<dt><code>N2</code></dt><dd><p>Get irritated easily. (q_974)</p>
</dd>
<dt><code>N3</code></dt><dd><p>Have frequent mood swings. (q_1099</p>
</dd>
<dt><code>N4</code></dt><dd><p>Often feel blue. (q_1479)</p>
</dd>
<dt><code>N5</code></dt><dd><p>Panic easily. (q_1505)</p>
</dd>
<dt><code>O1</code></dt><dd><p>Am full of ideas. (q_128)</p>
</dd>
<dt><code>O2</code></dt><dd><p>Avoid difficult reading material.(q_316)</p>
</dd>
<dt><code>O3</code></dt><dd><p>Carry the conversation to a higher level. (q_492)</p>
</dd>
<dt><code>O4</code></dt><dd><p>Spend time reflecting on things. (q_1738)</p>
</dd>
<dt><code>O5</code></dt><dd><p>Will not probe deeply into a subject. (q_1964)</p>
</dd>
</dl>

<p>The 25 items are organized by five putative factors: Agreeableness, Conscientiousness, Extraversion, Neuroticism, and Opennness.
</p>
<p>The item data were collected using a 6 point response scale: 
</p>

<dl>
<dt>1</dt><dd><p>Very Inaccurate</p>
</dd>
<dt>2</dt><dd><p>Moderately Inaccurate</p>
</dd>
<dt>3</dt><dd><p>Slightly Inaccurate</p>
</dd>
<dt>4</dt><dd><p>Slightly Accurate</p>
</dd>
<dt>5</dt><dd><p>Moderately Accurate</p>
</dd>
<dt>6</dt><dd><p>Very Accurate</p>
</dd>
</dl>

<p>as part of the Synthetic Apeture Personality Assessment (SAPA <a href="https://www.sapa-project.org/">https://www.sapa-project.org/</a>) project.  
To see an example of the data collection technique, visit <a href="https://www.sapa-project.org/">https://www.sapa-project.org/</a> or 
the International Cognitive Ability Resource at <code>https://icar-project.com/</code>. The items given were sampled 
from the International Personality Item Pool of Lewis Goldberg using the sampling technique of SAPA.  
This is a sample data set taken from the much larger SAPA data bank.
</p>


<h3>Note</h3>

<p>The bfi.2 data set and items should not be confused with the BFI (Big Five Inventory) of Oliver John and colleagues (John, O. P., Donahue, E. M., &amp; Kentle, R. L. (1991). The Big Five Inventory&ndash;Versions 4a and 54. Berkeley, CA: University of California,Berkeley, Institute of Personality and Social Research.)
</p>


<h3>Source</h3>

<p>The items are from the ipip (Goldberg, 1999). The data are from the SAPA project 
(Revelle, Wilt and Rosenthal, 2010), collected Spring, 2010 ( <a href="https://www.sapa-project.org/">https://www.sapa-project.org/</a>).
</p>


<h3>References</h3>

<p>Goldberg, L.R. (1999) A broad-bandwidth, public domain, personality inventory measuring the lower-level facets of several five-factor models. In Mervielde, I. and Deary, I. and De Fruyt, F. and Ostendorf, F. (eds) Personality psychology in Europe. 7. Tilburg University Press. Tilburg, The Netherlands.
</p>
<p>Revelle, W., Wilt, J.,  and Rosenthal, A. (2010)  Individual Differences in Cognition: New Methods for examining the Personality-Cognition Link In Gruszka, A.  and Matthews, G. and Szymura, B. (Eds.) Handbook of Individual Differences in Cognition: Attention, Memory and Executive Control, Springer.
</p>
<p>Revelle, W,  Condon, D.M.,  Wilt, J.,  French, J.A., Brown, A.,  and  Elleman, L.G. (2016) Web and phone based data collection using planned missing designs. In  Fielding, N.G.,  Lee, R.M. and  Blank, G. (Eds). SAGE Handbook of Online Research Methods (2nd Ed), Sage Publcations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bfi.2)
library("psych")
fa &lt;- fa(bfi.2, 5, rotate="varimax")
par(mar=c(5.1, 4.1, 4.1, 4.1)) # adapt margins
plot(loadings(fa), cex=0.5)
</code></pre>

<hr>
<h2 id='fmt'>fmt</h2><span id='topic+fmt'></span>

<h3>Description</h3>

<p>Rounds and adds trailing zeros (by default if digits is lower than 4).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fmt(x, digits = 2L, zeros = digits &lt; 4L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fmt_+3A_x">x</code></td>
<td>
<p>numeric: vector.</p>
</td></tr>
<tr><td><code id="fmt_+3A_digits">digits</code></td>
<td>
<p>integer: Digits that should be used for rounding.</p>
</td></tr>
<tr><td><code id="fmt_+3A_zeros">zeros</code></td>
<td>
<p>logical: Should trailing zeros be added?</p>
</td></tr>
<tr><td><code id="fmt_+3A_...">...</code></td>
<td>
<p>passed to format for <code>fmt</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>formatted <code>x</code> as text.
</p>


<h3>Source</h3>

<p>Similar to function <code>fmt</code> from the package <a href="https://CRAN.R-project.org/package=exams">exams</a>.
In the function <code>round2</code> has been replaced by <code>round</code>.
</p>


<h3>See Also</h3>

<p><a href="exams.html#topic+fmt">exams::fmt</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## this is also employed internally in the fmt() formatting function
fmt(c(0.005, 0.015))

## the main purpose of fmt() is that some numeric result can be displayed
## both at high accuracy and then at the rounding that students should do
## (e.g., with 2 or 3 digits)
sol &lt;- runif(1)
fmt(sol, 6)
fmt(sol, 2)

## but fmt() also assures showing a very high number of significant digits
## (up to 12)
sol &lt;- 123456 + sol
sol
fmt(sol, 6)
fmt(sol, 2)

## and fmt() also takes care of adding trailing zeros (if digits &lt; 4)
fmt(1)
fmt(1, digits = 3)
fmt(1, digits = 6)
</code></pre>

<hr>
<h2 id='plot.assoc'>plot.assoc</h2><span id='topic+plot.assoc'></span>

<h3>Description</h3>

<p>Visualizes a association matrix with a colored or gray heatmap. As a rule of thumb the breaks are determined 
by the <a href="https://en.wikipedia.org/wiki/Effect_size#Pearson_r_or_correlation_coefficient">effect sizes</a> given by 
Cohen (<code>c(-1, -0.4, -0.2, -0.05, 0, +0.05, +0.2, +0.4, +1)</code>. 
You may need to modify <code>mar</code> with the <code><a href="graphics.html#topic+par">par</a></code> command from its default 
<code>c(5.1,4.1,4.1,2.1)</code>.
See
</p>

<ul>
<li> <p><code>vignette('plot.matrix')</code> for detailed examples, and
</p>
</li>
<li> <p><code><a href="#topic+plot.matrix">plot.matrix</a></code> for further parameters.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'assoc'
plot(x, reorder = TRUE, gray = FALSE, grey = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.assoc_+3A_x">x</code></td>
<td>
<p>matrix: association within [0,+1]</p>
</td></tr>
<tr><td><code id="plot.assoc_+3A_reorder">reorder</code></td>
<td>
<p>logical: if the rows (variables) of the loading matrix should be reordered (default: <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="plot.assoc_+3A_gray">gray</code></td>
<td>
<p>logical: should be a gray scale color palette used or not (default: <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="plot.assoc_+3A_grey">grey</code></td>
<td>
<p>logical: should be a gray scale color palette used or not (default: <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="plot.assoc_+3A_...">...</code></td>
<td>
<p>further parameter given to the <code><a href="#topic+plot.matrix">plot.matrix</a></code> command</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If either the parameter <code>grey</code> or <code>gray</code> is <code>TRUE</code> then a gray color palette is used.
</p>


<h3>Value</h3>

<p>a plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>par(mar=c(5.1, 4.1, 4.1, 4.1))
# association matrix
data(Titanic.cramer)
plot(as.assoc(Titanic.cramer))
plot(as.assoc(Titanic.cramer), gray=TRUE)
plot(as.assoc(Titanic.cramer[,1:3]), reorder=FALSE)
</code></pre>

<hr>
<h2 id='plot.cor'>plot.cor</h2><span id='topic+plot.cor'></span>

<h3>Description</h3>

<p>Visualizes a correlation matrix with a colored or gray heatmap. As a rule of thumb the breaks are determined 
by the <a href="https://en.wikipedia.org/wiki/Effect_size#Pearson_r_or_correlation_coefficient">effect sizes</a> given by 
Cohen (<code>c(-1, -0.4, -0.2, -0.05, 0, +0.05, +0.2, +0.4, +1)</code>. 
You may need to modify <code>mar</code> with the <code><a href="graphics.html#topic+par">par</a></code> command from its default 
<code>c(5.1,4.1,4.1,2.1)</code>.
See
</p>

<ul>
<li> <p><code>vignette('plot.matrix')</code> for detailed examples, and
</p>
</li>
<li> <p><code><a href="#topic+plot.matrix">plot.matrix</a></code> for further parameters.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cor'
plot(x, reorder = TRUE, gray = FALSE, grey = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.cor_+3A_x">x</code></td>
<td>
<p>matrix: correlation within [-1,+1]</p>
</td></tr>
<tr><td><code id="plot.cor_+3A_reorder">reorder</code></td>
<td>
<p>logical: if the rows (variables) of the loading matrix should be reordered (default: <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="plot.cor_+3A_gray">gray</code></td>
<td>
<p>logical: should be a gray scale color palette used or not (default: <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="plot.cor_+3A_grey">grey</code></td>
<td>
<p>logical: should be a gray scale color palette used or not (default: <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="plot.cor_+3A_...">...</code></td>
<td>
<p>further parameter given to the <code><a href="#topic+plot.matrix">plot.matrix</a></code> command</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If either the parameter <code>grey</code> or <code>gray</code> is <code>TRUE</code> then a gray color palette is used.
</p>


<h3>Value</h3>

<p>a plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>par(mar=c(5.1, 4.1, 4.1, 4.1))
# correlation matrix
c &lt;- cor(airquality[,1:4], use="pairwise")
plot(as.cor(c))
plot(as.cor(c), gray=TRUE)
plot(as.cor(c[,1:3]), reorder=FALSE)
</code></pre>

<hr>
<h2 id='plot.loadings'>plot.loadings</h2><span id='topic+plot.loadings'></span>

<h3>Description</h3>

<p>Visualizes the loadings matrix from a Factor Analysis or a Principal Component Analysis matrix 
with a gray or colored heatmap. As a rule of thumb the breaks are determined by 
<code>c(-1, -0.866, -0.707, -0.5, -0.4, 0, +0.4, +0.5, +0.707, +0.866, +1)</code> is used.
You may need to modify <code>mar</code> with the <code><a href="graphics.html#topic+par">par</a></code> command from its default 
<code>c(5.1,4.1,4.1,2.1)</code>.
See
</p>

<ul>
<li> <p><code>vignette('plot.matrix')</code> for detailed examples, and
</p>
</li>
<li> <p><code><a href="#topic+plot.matrix">plot.matrix</a></code> for further parameters.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'loadings'
plot(x, reorder = TRUE, gray = FALSE, grey = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.loadings_+3A_x">x</code></td>
<td>
<p>matrix: loadings</p>
</td></tr>
<tr><td><code id="plot.loadings_+3A_reorder">reorder</code></td>
<td>
<p>logical: if the rows (variables) of the loading matrix should be reordered (default: <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="plot.loadings_+3A_gray">gray</code></td>
<td>
<p>logical: should be a gray scale color palette used or not (default: <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="plot.loadings_+3A_grey">grey</code></td>
<td>
<p>logical: should be a gray scale color palette used or not (default: <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="plot.loadings_+3A_...">...</code></td>
<td>
<p>further parameter given to the <code><a href="#topic+plot.matrix">plot.matrix</a></code> command</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If either the parameter <code>grey</code> or <code>gray</code> is <code>TRUE</code> then a gray color palette is used.
</p>


<h3>Value</h3>

<p>a plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bfi.2)
library("psych")
par(mar=c(5.1, 4.1, 4.1, 4.1))
# Factor analysis
fa &lt;- factanal(bfi.2, 5)
plot(loadings(fa))
plot(loadings(fa), grey=TRUE)
# Principal Component Analysis I
pa &lt;- princomp(bfi.2)
plot(loadings(pa), digits=NA)
# Principal Component Analysis II
pa &lt;- prcomp(bfi.2)
ld &lt;- structure(pa$rotation, class="loadings") 
plot(ld, digits=NA)
</code></pre>

<hr>
<h2 id='plot.matrix'>plot.matrix</h2><span id='topic+plot.matrix'></span><span id='topic+plot'></span>

<h3>Description</h3>

<p>Visualizes a matrix with a colored heatmap and optionally a color key. It distinguishes between numeric and non-numeric matrices.
You may need to modify <code>mar</code> with the <code><a href="graphics.html#topic+par">graphics::par()</a></code> command from its default <code>c(5.1,4.1,4.1,2.1)</code>.
For further see the vignette <code>vignette('plot.matrix')</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'matrix'
plot(
  x,
  y = NULL,
  breaks = NULL,
  col = heat.colors,
  na.col = "white",
  na.cell = TRUE,
  na.print = TRUE,
  digits = NA,
  fmt.cell = NULL,
  fmt.key = NULL,
  spacing.key = c(1, 0.5, 0),
  polygon.cell = NULL,
  polygon.key = NULL,
  text.cell = NULL,
  key = list(side = 4, las = 1),
  axis.col = list(side = 1),
  axis.row = list(side = 2),
  axis.key = NULL,
  max.col = 70,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.matrix_+3A_x">x</code></td>
<td>
<p>matrix</p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_y">y</code></td>
<td>
<p>unused</p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_breaks">breaks</code></td>
<td>
<p>breaks for numeric values or values for <code>col</code></p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_col">col</code></td>
<td>
<p>a vector of colors or a function, e.g. grDevices::heat.colors()] with one parameter <code>n</code></p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_na.col">na.col</code></td>
<td>
<p>color for missing value (default: white)</p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_na.cell">na.cell</code></td>
<td>
<p>to draw cells with missing values (default: <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_na.print">na.print</code></td>
<td>
<p>print NA (or any given characters) when values are missing. If <code>FALSE</code>, nothing is printed. If <code>na.cell</code> is <code>FALSE</code>, this will have no effect.</p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_digits">digits</code></td>
<td>
<p>number of digits for numeric data or length of string for non-numeric data</p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_fmt.cell">fmt.cell</code></td>
<td>
<p>format string for writing matrix entries, overwrites <code>digits</code>, defaults to <code>NULL</code></p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_fmt.key">fmt.key</code></td>
<td>
<p>format string for writing key entries, overwrites <code>digits</code>, defaults to <code>fmt</code></p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_spacing.key">spacing.key</code></td>
<td>
<p>spacing between plot and legend, key width, spacing between key and axis  (default: <code>c(1,0.5,0)</code>)</p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_polygon.cell">polygon.cell</code></td>
<td>
<p>list of parameters used for <code><a href="graphics.html#topic+polygon">graphics::polygon()</a></code> for heatmap</p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_polygon.key">polygon.key</code></td>
<td>
<p>list of parameters used for <code><a href="graphics.html#topic+polygon">graphics::polygon()</a></code> for key</p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_text.cell">text.cell</code></td>
<td>
<p>list of parameters used for <code><a href="graphics.html#topic+text">graphics::text()</a></code> for matrix entries</p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_key">key</code></td>
<td>
<p>list of parameters used for [graphics::axis(). If set to <code>NULL</code> then no information will be plotted. Instead of <code>key=list(side=4)</code> you may use <code>key=4</code> or <code>key="right"</code>.</p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_axis.col">axis.col</code></td>
<td>
<p>list of parameters used for <code><a href="graphics.html#topic+axis">graphics::axis()</a></code> for axis of matrix columns. Instead of <code>axis.col=list(side=1)</code> you may use <code>axis.col=1</code> or <code>axis.col="bottom"</code>.</p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_axis.row">axis.row</code></td>
<td>
<p>list of parameters used for <code><a href="graphics.html#topic+axis">graphics::axis()</a></code> for axis of matrix rows. Instead of <code>axis.row=list(side=2)</code> you may use <code>axis.row=2</code> or <code>axis.col="left"</code>.</p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_axis.key">axis.key</code></td>
<td>
<p>as <code>key</code></p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_max.col">max.col</code></td>
<td>
<p>numeric: if the distance between the text color and the cell color is smaller then <code>max.col</code> then either <code>white</code> or <code>black</code> will be used as text color, defaults to <code>70</code></p>
</td></tr>
<tr><td><code id="plot.matrix_+3A_...">...</code></td>
<td>
<p>further parameter given to the <code><a href="graphics.html#topic+plot.default">graphics::plot()</a></code> command</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A color key is drawn if either <code>key</code> (defaults to <code>list(cex=1)</code>) or <code>fmt.key</code>
(defaults to <code>NULL</code>) is not <code>NULL</code>.
</p>
<p>If you want to plot the matrix entries you must set either <code>digits</code> or <code>fmt</code>.
For a non-numeric matrix <code>digits</code> gives the length of the string printed, a negative value
results in right-justified string. For a numeric matrix <code>digits</code> determines the number of
decimal places,  a negative value uses a &quot;exponential&quot; decimal notation. You may set format
strings <code>fmt</code> and <code>fmt.key</code> directly. Settings <code>digits</code> leads to the following
format strings (<code>n</code> the absolute value of <code>digits</code>):
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>x</code> numeric and <code>digits&gt;0</code>:</td><td style="text-align: left;"> <code>"%+.nf"</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>x</code> numeric and <code>digits&lt;0</code>:</td><td style="text-align: left;"> <code>"%+.ne"</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>x</code> non-numeric and <code>digits&gt;0</code>:</td><td style="text-align: left;"> <code>"%+ns"</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>x</code> non-numeric and <code>digits&lt;0</code>:</td><td style="text-align: left;"> <code>"%-ns"</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>If no colors are given then the <code><a href="grDevices.html#topic+palettes">grDevices::heat.colors()</a></code> will be used. Alternatively you may specify your own color function
that delivers a vector with <code>n</code> colors if called by <code>col(n)</code>. The final colors and breaks used
depend if <code>plot.matrix</code> gets a numeric or non-numeric matrix.
</p>
<p><strong>Numeric matrix:</strong> In general it must hold <code>length(col)+1==length(breaks)</code>.
</p>

<dl>
<dt>1. <code>breaks==NULL</code> and <code>col==NULL</code></dt><dd><p>The colors are taken from <code>heat.colors(10)</code> and the eleven breaks are calculated as an equidistant grid
between <code>min(x)</code> and <code>max(x)</code>.</p>
</dd>
<dt>2. <code>breaks==NULL</code> and <code>col</code> is a color function</dt><dd><p>Ten colors are taken from the color function and eleven breaks are calculated as an equidistant grid
between <code>min(x)</code> and <code>max(x)</code>.</p>
</dd>
<dt>3. <code>breaks==NULL</code> and <code>col</code> is a vector of colors</dt><dd><p>The <code>length(col)+1</code> breaks are calculated as an equidistant grid
between <code>min(x)</code> and <code>max(x)</code>.</p>
</dd>
<dt>4. <code>breaks</code> are given and <code>col==NULL</code></dt><dd><p>The colors are taken from <code>heat.colors(length(breaks)-1)</code>.</p>
</dd>
<dt>5. <code>breaks</code> are given and <code>col</code> is a color function</dt><dd><p>The <code>length(breaks)-1</code> colors are taken from the color function.</p>
</dd>
<dt>6. <code>breaks</code> are given and <code>col</code> is a vector of colors</dt><dd><p>If not <code>length(col)+1==length(breaks)</code> holds then
the <code>length(col)+1</code> breaks are calculated as an equidistant grid between <code>min(breaks)</code> and <code>max(breaks)</code>.</p>
</dd>
</dl>

<p><strong>Non-numeric matrix:</strong> In general it must hold <code>length(col)==length(breaks)</code>. At first the number of unique elements in <code>x</code> is determined: <code>nu</code>.
</p>

<dl>
<dt>1. <code>breaks==NULL</code> and <code>col==NULL</code></dt><dd><p>The colors are taken from <code>heat.colors(nu)</code> and the breaks are set to the unique elements of <code>x</code>.</p>
</dd>
<dt>2. <code>breaks==NULL</code> and <code>col</code> is a color function</dt><dd><p>The <code>nu</code> colors are taken from color function and the breaks are set to the unique elements of <code>x</code>.</p>
</dd>
<dt>3. <code>breaks==NULL</code> and <code>col</code> is a vector of colors</dt><dd><p>The <code>length(col)</code> breaks are calculated as an equidistant grid
between <code>min(x)</code> and <code>max(x)</code>.</p>
</dd>
<dt>4. <code>breaks</code> are given and <code>color==NULL</code></dt><dd><p>The colors are taken from <code>heat.colors(length(breaks))</code>.</p>
</dd>
<dt>5. <code>breaks</code> are given and <code>color</code> is a color function</dt><dd><p>The <code>length(breaks)</code> colors are taken from color function.</p>
</dd>
<dt>6. <code>breaks</code> are given and <code>color</code> is a vector of colors</dt><dd><p>If not <code>length(colors)==length(breaks)</code> holds then
either <code>breaks</code> or <code>color</code> is shorten to the shorter of both.</p>
</dd>
</dl>

<p>If the difference between polygon color and the text color is smaller <code>max.col</code> then as text color is
either <code>white</code> or <code>black</code> (depending which one is further away from the polygon color).
The distance is computed as <code class="reqn">\Delta C/3</code> as in <a href="https://en.wikipedia.org/wiki/Color_difference#Euclidean">https://en.wikipedia.org/wiki/Color_difference#Euclidean</a> given.
</p>


<h3>Value</h3>

<p>invisibly a list with elements
</p>

<dl>
<dt><code>cell.polygon[[i,j]]</code></dt><dd><p>the <code>polygon</code> parameters used to draw the elements of the matrix</p>
</dd>
<dt><code>cell.text[[i,j]]</code></dt><dd><p>the <code>text</code> parameters used to draw the elements of the matrix</p>
</dd>
<dt><code>plot</code></dt><dd><p>the <code>plot</code> parameters used to draw the basic plot</p>
</dd>
<dt><code>axis.col</code></dt><dd><p>the <code>axis</code> parameters used to draw column axis</p>
</dd>
<dt><code>axis.row</code></dt><dd><p>the <code>axis</code> parameters used to draw row axis</p>
</dd>
<dt><code>key.polygon[[i]]</code></dt><dd><p>the <code>polygon</code> parameters used to draw the elements of the key</p>
</dd>
<dt><code>key.axis</code></dt><dd><p>the <code>axis</code> parameters used to draw key axis</p>
</dd>
</dl>

<p>A <code>NULL</code> means the elements has not been drawn.
</p>


<h3>Note</h3>

<p>The use of <code>fmt</code> or <code>fmt.key</code> have the same restrictions as the use of <code>fmt</code> in <code><a href="base.html#topic+sprintf">base::sprintf()</a></code>:
</p>
<p><em>The format string is passed down the OS's sprintf function, and incorrect formats can cause the latter to crash the R process.
R does perform sanity checks on the format, but not all possible user errors on all platforms have been tested, and some might
be terminal.</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>par(mar=c(5.1, 4.1, 4.1, 4.1))
# numeric matrix
x &lt;- matrix(runif(50), nrow=10)
plot(x)
plot(x, key=NULL)
plot(x, key=list(cex.axis=0.5, tick=FALSE))
plot(x, digits=3)
plot(x, breaks=range(x), digits=3, cex=0.6)
# logical matrix
m &lt;- matrix(runif(50)&lt;0.5, nrow=10)
plot(m)
plot(m, col=c("red", "blue"))
plot(m, key=NULL, digits=1)
# character matrix
s &lt;- matrix(sample(letters[1:10], 50, replace=TRUE), nrow=10)
plot(s)
plot(s, col=topo.colors)
plot(s, digits=10)
plot(s, digits=1, col=heat.colors(5), breaks=letters[1:5])
plot(s, digits=1, col=heat.colors(5), breaks=c('a', 'c', 'e', 'g', 'i'))
# contingency table
tab &lt;- table(round(rnorm(100)), round(rnorm(100)))
plot(unclass(tab))
# chisquare test residuals
cst &lt;- chisq.test(apply(HairEyeColor, 1:2, sum))
col &lt;- colorRampPalette(c("blue", "white", "red"))
plot(cst$residuals, col=col, breaks=c(-7.5,7.5))
# triangular matrix
x[upper.tri(x)] &lt;- NA
plot(x, digit=2)
plot(x, na.print=FALSE)
plot(x, na.cell=FALSE)
# use the standard plot instead of plot.matrix
x &lt;- matrix(runif(50), nrow=2)
plot(as.data.frame(x))
plot.default(x)
## Not run: 
# unload the package permanently with devtools
library("devtools")
unload('plot.matrix')

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.pvalue'>plot.pvalue</h2><span id='topic+plot.pvalue'></span>

<h3>Description</h3>

<p>Visualizes a matrix of p-values with a colored or gray heatmap. As a rule of thumb the breaks are determined 
by <code>c(0, 0.001, 0.01, 0.05, 0.1, 1)</code>
You may need to modify <code>mar</code> with the <code><a href="graphics.html#topic+par">par</a></code> command from its default 
<code>c(5.1,4.1,4.1,2.1)</code>.
See
</p>

<ul>
<li> <p><code>vignette('plot.matrix')</code> for detailed examples, and
</p>
</li>
<li> <p><code><a href="#topic+plot.matrix">plot.matrix</a></code> for further parameters.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pvalue'
plot(x, reorder = TRUE, gray = FALSE, grey = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.pvalue_+3A_x">x</code></td>
<td>
<p>matrix: p-values within [0,1]</p>
</td></tr>
<tr><td><code id="plot.pvalue_+3A_reorder">reorder</code></td>
<td>
<p>logical: if the rows (variables) of the loading matrix should be reordered (default: <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="plot.pvalue_+3A_gray">gray</code></td>
<td>
<p>logical: should be a gray scale color palette used or not (default: <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="plot.pvalue_+3A_grey">grey</code></td>
<td>
<p>logical: should be a gray scale color palette used or not (default: <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="plot.pvalue_+3A_...">...</code></td>
<td>
<p>further parameter given to the <code><a href="#topic+plot.matrix">plot.matrix</a></code> command</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If either the parameter <code>grey</code> or <code>gray</code> is <code>TRUE</code> then a gray color palette is used.
</p>


<h3>Value</h3>

<p>a plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>par(mar=c(5.1, 4.1, 4.1, 4.1))
# correlation matrix
data(air.pvalue)
plot(as.pvalue(air.pvalue))
plot(as.pvalue(air.pvalue), gray=TRUE)
plot(as.pvalue(air.pvalue[,1:3]), reorder=FALSE)
</code></pre>

<hr>
<h2 id='Titanic.cramer'>Survival of passengers on the Titanic</h2><span id='topic+Titanic.cramer'></span>

<h3>Description</h3>

<p>Matrix of Cramer's V computed on the variables economic status (class), sex, age and survival of the 
fate of passengers on the fatal maiden voyage of the ocean liner 'Titanic'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Titanic.cramer)
</code></pre>


<h3>Format</h3>

<p>A 4x4 matrix with Cramer's V computed on
</p>

<dl>
<dt><code>Class</code></dt><dd><p>1st, 2nd, 3rd, Crew</p>
</dd>
<dt><code>Sex</code></dt><dd><p>Male, Female</p>
</dd>
<dt><code>Age</code></dt><dd><p>Child, Adult</p>
</dd>
<dt><code>Survived</code></dt><dd><p>No, Yes</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data are derived from the <a href="datasets.html#topic+Titanic">Survival of passengers on the Titanic</a> data set.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Titanic.cramer)
plot(as.assoc(Titanic.cramer))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
