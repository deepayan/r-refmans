<!DOCTYPE html><html><head><title>Help for package binomialRF</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {binomialRF}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.cv_binomialRF'><p>random forest feature selection based on binomial exact test</p></a></li>
<li><a href='#binomialRF'><p>random forest feature selection based on binomial exact test</p></a></li>
<li><a href='#calculateBinomialP'><p>calculate the probability, p, to conduct a binomial exact test</p></a></li>
<li><a href='#calculateBinomialP_Interaction'><p>calculate the probability, p, to conduct a binomial exact test</p></a></li>
<li><a href='#geneset_binomialRF'><p>random forest feature selection based on binomial exact test</p></a></li>
<li><a href='#k_binomialRF'><p>random forest feature selection based on binomial exact test</p></a></li>
<li><a href='#pmf_list'><p>A prebuilt distribution for correlated binary data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Binomial Random Forest Feature Selection</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.biorxiv.org/content/10.1101/681973v1.abstract">https://www.biorxiv.org/content/10.1101/681973v1.abstract</a></td>
</tr>
<tr>
<td>Description:</td>
<td>The 'binomialRF' is a new feature selection technique for decision trees that aims at providing an alternative approach to identify significant feature subsets using binomial distributional assumptions (Rachid Zaim, S., et al. (2019)) &lt;<a href="https://doi.org/10.1101%2F681973">doi:10.1101/681973</a>&gt;. Treating each splitting variable selection as a set of exchangeable correlated Bernoulli trials, 'binomialRF' then tests whether a feature is selected more often than by random chance. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>biocViews:</td>
<td>Software, GenePrediction, StatisticalMethod, DecisionTree,
DimensionReduction, ExperimentalDesign</td>
</tr>
<tr>
<td>Imports:</td>
<td>randomForest, data.table, stats, rlist</td>
</tr>
<tr>
<td>Suggests:</td>
<td>foreach, knitr, rmarkdown, correlbinom</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-26 16:11:02 UTC; samirrachidzaim-admin</td>
</tr>
<tr>
<td>Author:</td>
<td>Samir Rachid Zaim [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Samir Rachid Zaim &lt;samirrachidzaim@math.arizona.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-26 17:00:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='.cv_binomialRF'>random forest feature selection based on binomial exact test</h2><span id='topic+.cv_binomialRF'></span>

<h3>Description</h3>

<p><code>cv.binomialRF</code> is the cross-validated form of the <code>binomialRF</code>, where K-fold crossvalidation is conducted to assess the feature's significance. Using the <code>cvFolds</code>=K parameter, will result in a K-fold cross-validation where the data is 'chunked' into K-equally sized groups and then the averaged result is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.cv_binomialRF(X, y, cvFolds = 5, fdr.threshold = 0.05,
  fdr.method = "BY", ntrees = 2000, keep.both = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".cv_binomialRF_+3A_x">X</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id=".cv_binomialRF_+3A_y">y</code></td>
<td>
<p>class label</p>
</td></tr>
<tr><td><code id=".cv_binomialRF_+3A_cvfolds">cvFolds</code></td>
<td>
<p>how many times should we perform cross-validation</p>
</td></tr>
<tr><td><code id=".cv_binomialRF_+3A_fdr.threshold">fdr.threshold</code></td>
<td>
<p>fdr.threshold for determining which set of features are significant</p>
</td></tr>
<tr><td><code id=".cv_binomialRF_+3A_fdr.method">fdr.method</code></td>
<td>
<p>how should we adjust for multiple comparisons (i.e., <code>p.adjust.methods</code> =c(&quot;holm&quot;, &quot;hochberg&quot;, &quot;hommel&quot;, &quot;bonferroni&quot;, &quot;BH&quot;, &quot;BY&quot;,&quot;fdr&quot;, &quot;none&quot;))</p>
</td></tr>
<tr><td><code id=".cv_binomialRF_+3A_ntrees">ntrees</code></td>
<td>
<p>how many trees should be used to grow the <code>randomForest</code>? (Defaults to 5000)</p>
</td></tr>
<tr><td><code id=".cv_binomialRF_+3A_keep.both">keep.both</code></td>
<td>
<p>should we keep the naive binomialRF as well as the correlated adjustment</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with 4 columns: Feature Name, cross-validated average for Frequency Selected, CV Median (Probability of Selecting it randomly), CV Median(Adjusted P-value based on <code>fdr.method</code>), and averaged number of times selected as signficant.
</p>


<h3>References</h3>

<p>Zaim, SZ; Kenost, C.; Lussier, YA; Zhang, HH. binomialRF: Scalable Feature Selection and Screening for Random Forests to Identify Biomarkers and Their Interactions, bioRxiv, 2019.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(324)

###############################
### Generate simulation data
###############################

X = matrix(rnorm(1000), ncol=10)
trueBeta= c(rep(10,5), rep(0,5))
z = 1 + X %*% trueBeta
pr = 1/(1+exp(-z))
y = as.factor(rbinom(100,1,pr))

###############################
### Run cross-validation
###############################

</code></pre>

<hr>
<h2 id='binomialRF'>random forest feature selection based on binomial exact test</h2><span id='topic+binomialRF'></span>

<h3>Description</h3>

<p><code>binomialRF</code> is the R implementation of the feature selection algorithm by (Zaim 2019)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binomialRF(X,y, fdr.threshold = .05,fdr.method = 'BY',
                      ntrees = 2000, percent_features = .5,
                      keep.both=FALSE, user_cbinom_dist=NULL,
                      sampsize=round(nrow(X)*.63))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binomialRF_+3A_x">X</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id="binomialRF_+3A_y">y</code></td>
<td>
<p>class label</p>
</td></tr>
<tr><td><code id="binomialRF_+3A_fdr.threshold">fdr.threshold</code></td>
<td>
<p>fdr.threshold for determining which set of features are significant</p>
</td></tr>
<tr><td><code id="binomialRF_+3A_fdr.method">fdr.method</code></td>
<td>
<p>how should we adjust for multiple comparisons (i.e., <code>p.adjust.methods</code> =c(&quot;holm&quot;, &quot;hochberg&quot;, &quot;hommel&quot;, &quot;bonferroni&quot;, &quot;BH&quot;, &quot;BY&quot;,&quot;fdr&quot;, &quot;none&quot;))</p>
</td></tr>
<tr><td><code id="binomialRF_+3A_ntrees">ntrees</code></td>
<td>
<p>how many trees should be used to grow the <code>randomForest</code>?</p>
</td></tr>
<tr><td><code id="binomialRF_+3A_percent_features">percent_features</code></td>
<td>
<p>what percentage of L do we subsample at each tree? Should be a proportion between (0,1)</p>
</td></tr>
<tr><td><code id="binomialRF_+3A_keep.both">keep.both</code></td>
<td>
<p>should we keep the naive binomialRF as well as the correlated adjustment</p>
</td></tr>
<tr><td><code id="binomialRF_+3A_user_cbinom_dist">user_cbinom_dist</code></td>
<td>
<p>insert either a pre-specified correlated binomial distribution or calculate one via the R package <code>correlbinom</code>.</p>
</td></tr>
<tr><td><code id="binomialRF_+3A_sampsize">sampsize</code></td>
<td>
<p>how many samples should be included in each tree in the randomForest</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with 4 columns: Feature Name, Frequency Selected, Probability of Selecting it randomly, Adjusted P-value based on <code>fdr.method</code>
</p>


<h3>References</h3>

<p>Zaim, SZ; Kenost, C.; Lussier, YA; Zhang, HH. binomialRF: Scalable Feature Selection and Screening for Random Forests to Identify Biomarkers and Their Interactions, bioRxiv, 2019.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(324)

###############################
### Generate simulation data
###############################

X = matrix(rnorm(1000), ncol=10)
trueBeta= c(rep(10,5), rep(0,5))
z = 1 + X %*% trueBeta
pr = 1/(1+exp(-z))
y = as.factor(rbinom(100,1,pr))

###############################
### Run binomialRF
###############################
require(correlbinom)

rho = 0.33
ntrees = 250
cbinom = correlbinom(rho, successprob =  calculateBinomialP(10, .5), trials = ntrees, 
                               precision = 1024, model = 'kuk')

binom.rf &lt;-binomialRF(X,y, fdr.threshold = .05,fdr.method = 'BY',
                      ntrees = ntrees,percent_features = .5,
                      keep.both=FALSE, user_cbinom_dist=cbinom,
                      sampsize=round(nrow(X)*rho))

print(binom.rf)
</code></pre>

<hr>
<h2 id='calculateBinomialP'>calculate the probability, p, to conduct a binomial exact test</h2><span id='topic+calculateBinomialP'></span>

<h3>Description</h3>

<p><code>calculateBinomialP</code> returns a probability of randomly selecting a feature as the root node in a decision tree. This is a generic function that is called internally in <code>binomialRF</code> but that may also be called directly if needed. The arguments <code>...</code>
should be, L= Total number of features in X, and percent_features= what percent of L is subsampled in the <code>randomForest</code> call.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateBinomialP(L, percent_features)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculateBinomialP_+3A_l">L</code></td>
<td>
<p>the total number of features in X. Should be a positive integer &gt;1</p>
</td></tr>
<tr><td><code id="calculateBinomialP_+3A_percent_features">percent_features</code></td>
<td>
<p>what percentage of L do we subsample at each tree? Should be a proportion between (0,1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If L is an integeter returns a probability value for selecting predictor Xj randomly
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calculateBinomialP(110, .4)
calculateBinomialP(13200, .5)
</code></pre>

<hr>
<h2 id='calculateBinomialP_Interaction'>calculate the probability, p, to conduct a binomial exact test</h2><span id='topic+calculateBinomialP_Interaction'></span>

<h3>Description</h3>

<p><code>calculateBinomialP_Interaction</code> returns a probability of randomly selecting a feature as the root node in a decision tree. This is a generic function that is called internally in <code>binomialRF</code> but that may also be called directly if needed. The arguments <code>...</code>
should be, L= Total number of features in X, and percent_features= what percent of L is subsampled in the <code>randomForest</code> call.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateBinomialP_Interaction(L, percent_features, K = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculateBinomialP_Interaction_+3A_l">L</code></td>
<td>
<p>the total number of features in X. Should be a positive integer &gt;1</p>
</td></tr>
<tr><td><code id="calculateBinomialP_Interaction_+3A_percent_features">percent_features</code></td>
<td>
<p>what percentage of L do we subsample at each tree? Should be a proportion between (0,1)</p>
</td></tr>
<tr><td><code id="calculateBinomialP_Interaction_+3A_k">K</code></td>
<td>
<p>interaction level</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If L is an integeter returns a probability value for selecting predictor Xj randomly
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calculateBinomialP_Interaction(110, .4,2 )
</code></pre>

<hr>
<h2 id='geneset_binomialRF'>random forest feature selection based on binomial exact test</h2><span id='topic+geneset_binomialRF'></span>

<h3>Description</h3>

<p><code>binomialRF</code> is the R implementation of the feature selection algorithm by (Zaim 2019)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geneset_binomialRF(binomialRF_object, gene_ontology, cutoff = 0.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geneset_binomialRF_+3A_binomialrf_object">binomialRF_object</code></td>
<td>
<p>the binomialRF object output</p>
</td></tr>
<tr><td><code id="geneset_binomialRF_+3A_gene_ontology">gene_ontology</code></td>
<td>
<p>a two- or three-column representation of a gene ontology with gene and geneset names</p>
</td></tr>
<tr><td><code id="geneset_binomialRF_+3A_cutoff">cutoff</code></td>
<td>
<p>a real-valued number between 0 and 1, used as a p-value threshold</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with 4 columns: Geneset Name, P-value, Adjusted P-value based on <code>fdr.method</code>
</p>


<h3>References</h3>

<p>Zaim, SZ; Kenost, C.; Lussier, YA; Zhang, HH. binomialRF: Scalable Feature Selection and Screening for Random Forests to Identify Biomarkers and Their Interactions, bioRxiv, 2019.
</p>

<hr>
<h2 id='k_binomialRF'>random forest feature selection based on binomial exact test</h2><span id='topic+k_binomialRF'></span>

<h3>Description</h3>

<p><code>k_binomialRF</code> is the R implementation of the interaction feature selection algorithm by (Zaim 2019). <code>k_binomialRF</code> extends the <code>binomialRF</code> algorithm by searching for k-way interactions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>k_binomialRF(X, y, fdr.threshold = 0.05, fdr.method = "BY",
  ntrees = 2000, percent_features = 0.3, K = 2, cbinom_dist = NULL,
  sampsize = nrow(X) * 0.4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="k_binomialRF_+3A_x">X</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id="k_binomialRF_+3A_y">y</code></td>
<td>
<p>class label</p>
</td></tr>
<tr><td><code id="k_binomialRF_+3A_fdr.threshold">fdr.threshold</code></td>
<td>
<p>fdr.threshold for determining which set of features are significant</p>
</td></tr>
<tr><td><code id="k_binomialRF_+3A_fdr.method">fdr.method</code></td>
<td>
<p>how should we adjust for multiple comparisons (i.e., <code>p.adjust.methods</code> =c(&quot;holm&quot;, &quot;hochberg&quot;, &quot;hommel&quot;, &quot;bonferroni&quot;, &quot;BH&quot;, &quot;BY&quot;,&quot;fdr&quot;, &quot;none&quot;))</p>
</td></tr>
<tr><td><code id="k_binomialRF_+3A_ntrees">ntrees</code></td>
<td>
<p>how many trees should be used to grow the <code>randomForest</code>? (Defaults to 5000)</p>
</td></tr>
<tr><td><code id="k_binomialRF_+3A_percent_features">percent_features</code></td>
<td>
<p>what percentage of L do we subsample at each tree? Should be a proportion between (0,1)</p>
</td></tr>
<tr><td><code id="k_binomialRF_+3A_k">K</code></td>
<td>
<p>for multi-way interactions, how deep should the interactions be?</p>
</td></tr>
<tr><td><code id="k_binomialRF_+3A_cbinom_dist">cbinom_dist</code></td>
<td>
<p>user-supplied correlated binomial distribution</p>
</td></tr>
<tr><td><code id="k_binomialRF_+3A_sampsize">sampsize</code></td>
<td>
<p>user-supplied sample size for random forest</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with 4 columns: Feature Name, Frequency Selected, Probability of Selecting it randomly, Adjusted P-value based on <code>fdr.method</code>
</p>


<h3>References</h3>

<p>Zaim, SZ; Kenost, C.; Lussier, YA; Zhang, HH. binomialRF: Scalable Feature Selection and Screening for Random Forests to Identify Biomarkers and Their Interactions, bioRxiv, 2019.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(324)

###############################
### Generate simulation data
###############################

X = matrix(rnorm(1000), ncol=10)
trueBeta= c(rep(10,5), rep(0,5))
z = 1 + X %*% trueBeta
pr = 1/(1+exp(-z))
y = rbinom(100,1,pr)

###############################
### Run interaction model
###############################

require(correlbinom)

rho = 0.33
ntrees = 250
cbinom = correlbinom(rho, successprob =  calculateBinomialP_Interaction(10, .5,2), 
                               trials = ntrees, precision = 1024, model = 'kuk')

k.binom.rf &lt;-k_binomialRF(X,y, fdr.threshold = .05,fdr.method = 'BY',
                      ntrees = ntrees,percent_features = .5,
                      cbinom_dist=cbinom,
                      sampsize=round(nrow(X)*rho))




</code></pre>

<hr>
<h2 id='pmf_list'>A prebuilt distribution for correlated binary data
</h2><span id='topic+pmf_list'></span>

<h3>Description</h3>

<p>This data contains probability mass functions (pmf's) for correlated binary data for various parameters. The sum of correlated exchangeable binary data is a generalization of the binomial distribution that deals with correlated trials. The correlation in decision trees occurs as the subsampling and bootstrapping step in random forests touch the same data, creating a co-dependency. This data contains some pre-calculated distributions for random forests with 500, 1000, and 2000 trees with 10, 100, and 1000 features. For more distributions, they can be calculated via the correlbinom R package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmf_list
</code></pre>


<h3>Format</h3>

<p>A list of lists</p>


<h3>References</h3>

<p>Witt, Gary. &quot;A Simple Distribution for the Sum of Correlated, Exchangeable Binary Data.&quot; Communications in Statistics-Theory and Methods 43, no. 20 (2014): 4265-4280.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
