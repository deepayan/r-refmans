<!DOCTYPE html><html><head><title>Help for package AGD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AGD}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ageGrid'><p>Creates an age grid according to a specified format.</p></a></li>
<li><a href='#boys7482'><p>Growth of Dutch boys</p></a></li>
<li><a href='#extractLMS'><p>Extracts LMS values from a gamlss object.</p></a></li>
<li><a href='#References+20CDC'><p>Reference tables from CDC 2000</p></a></li>
<li><a href='#References+20NL3'><p>Reference tables from Third Dutch Growth Study 1980</p></a></li>
<li><a href='#References+20NL4'><p>Reference tables from Fourth Dutch Growth Study 1997</p></a></li>
<li><a href='#References+20WHO'><p>References WHO</p></a></li>
<li><a href='#wp.twin'><p>Superposes two worm plots</p></a></li>
<li><a href='#y2z'><p>Converts measurements to standard deviation scores (SDS)</p></a></li>
<li><a href='#z2y'><p>Convert standard deviation scores (SDS) to measurements</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>0.39</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Growth Data</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-05-30</td>
</tr>
<tr>
<td>Author:</td>
<td>Stef van Buuren &lt;stef.vanbuuren@tno.nl&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stef van Buuren &lt;stef.vanbuuren@tno.nl&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>gamlss, gamlss.dist</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for the analysis of growth data: to extract an 
    LMS table from a gamlss object, to calculate the standard 
    deviation scores and its inverse, and to superpose two wormplots 
    from different models. The package contains a some varieties of 
    reference tables, especially for The Netherlands.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/stefvanbuuren/AGD">https://github.com/stefvanbuuren/AGD</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/stefvanbuuren/AGD/issues">https://github.com/stefvanbuuren/AGD/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-05-29 16:50:32 UTC; buurensv</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-05-29 17:18:28 UTC</td>
</tr>
</table>
<hr>
<h2 id='ageGrid'>Creates an age grid according to a specified format.</h2><span id='topic+ageGrid'></span>

<h3>Description</h3>

<p>Creates an age grid according to a specified format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ageGrid(grid = "compact")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ageGrid_+3A_grid">grid</code></td>
<td>
<p>A character string specifying one of the following:
<code>"compact"</code>, <code>"classic"</code>, <code>"extensive"</code>, <code>"0-104w"</code>,
<code>"0-24m"</code>, <code>"0-21y"</code>, <code>"0-21yd"</code> or <code>"0-21yc"</code>.  The
default is <code>"compact"</code>, which produces an age grid between 0 and 21
years with 95 points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with five components: <code>format</code>, <code>year</code>,
<code>month</code>, <code>week</code> and <code>day</code> containing the age grid in different
units.
</p>


<h3>Author(s)</h3>

<p>Stef van Buuren, 2010
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

age &lt;- ageGrid("classic")$year

</code></pre>

<hr>
<h2 id='boys7482'>Growth of Dutch boys</h2><span id='topic+boys7482'></span>

<h3>Description</h3>

<p>Height, weight, head circumference and puberty of 7482 Dutch boys.
</p>


<h3>Format</h3>

<p>A data frame with 7482 rows on the following 9 variables: 
</p>

<dl>
<dt>age</dt><dd><p>Decimal age (0-21 years)</p>
</dd> 
<dt>hgt</dt><dd><p>Height (cm)</p>
</dd>
<dt>wgt</dt><dd><p>Weight (kg)</p>
</dd> 
<dt>bmi</dt><dd><p>Body mass index</p>
</dd>
<dt>hc</dt><dd><p>Head circumference (cm)</p>
</dd> 
<dt>gen</dt><dd><p>Genital Tanner stage (G1-G5)</p>
</dd> 
<dt>phb</dt><dd><p>Pubic hair (Tanner P1-P6)</p>
</dd>
<dt>tv</dt><dd><p>Testicular volume (ml)</p>
</dd> 
<dt>reg</dt><dd><p>Region (north, east, west, south, city)</p>
</dd> 
</dl>


<h3>Details</h3>

<p>The complete sample of cross-sectional data from boys 0-21 years used to
construct the Dutch growth references 1997. Variables <code>gen</code> and
<code>phb</code> are ordered factors. <code>reg</code> is a factor. Note: A 10% sample
from this data is available in data set <code>boys</code> in the <code>mice</code>
package.
</p>


<h3>Author(s)</h3>

<p>Stef van Buuren, 2012
</p>


<h3>Source</h3>

<p>Fredriks, A.M,, van Buuren, S., Burgmeijer, R.J., Meulmeester JF,
Beuker, R.J., Brugman, E., Roede, M.J., Verloove-Vanhorick, S.P., Wit, J.M.
(2000) Continuing positive secular growth change in The Netherlands
1955-1997.  <em>Pediatric Research</em>, <b>47</b>, 316-323. 
</p>
<p>Fredriks, A.M., van Buuren, S., Wit, J.M., Verloove-Vanhorick, S.P. (2000).
Body index measurements in 1996-7 compared with 1980.  <em>Archives of
Disease in Childhood</em>, <b>82</b>, 107-112.
</p>

<hr>
<h2 id='extractLMS'>Extracts LMS values from a gamlss object.</h2><span id='topic+extractLMS'></span>

<h3>Description</h3>

<p>Extract LMS values from a gamlss object for solutions that transform the age
axis according to the M-curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractLMS(fit, data, sex = "M", grid = "classic", decimals = c(4, 4, 4),
  flatAge = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractLMS_+3A_fit">fit</code></td>
<td>
<p>A gamlss object containing the final fit on transformed age,
<code>t.age</code>.</p>
</td></tr>
<tr><td><code id="extractLMS_+3A_data">data</code></td>
<td>
<p>A data frame containing the original data, with both <code>age</code>
and <code>t.age</code></p>
</td></tr>
<tr><td><code id="extractLMS_+3A_sex">sex</code></td>
<td>
<p>A character vector indicating whether the fit applied to males
<code>sex="M"</code> or females <code>sex="F"</code>. The default is <code>sex="M"</code>.</p>
</td></tr>
<tr><td><code id="extractLMS_+3A_grid">grid</code></td>
<td>
<p>A character vector indicating the desired age grid. See
<code>ageGrid()</code> for possible options. The default is a
<code>grid="classic"</code>, a grid of 59 age points.</p>
</td></tr>
<tr><td><code id="extractLMS_+3A_decimals">decimals</code></td>
<td>
<p>A numerical vector of length 3 indicating the number of
significant digits for rounding of the L, M and S curves, respectively.</p>
</td></tr>
<tr><td><code id="extractLMS_+3A_flatage">flatAge</code></td>
<td>
<p>A scalar indicating the age beyond which the L, M and S values
should be constant. The default (NULL) is not to flatten the curves.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is crucial that <code>t.age</code> in <code>data</code> correspond to exactly the same
age transformation as used to fit the <code>gamlss</code> object. Age grid values
beyond the range of <code>data$age</code> produce <code>NA</code> in the L, M and S
values. Parameter <code>flatAge</code> should be one of the values of the age grid.
</p>


<h3>Value</h3>

<p>A data frame with rows corresponding to time points, and with the
following columns: <code>sex</code>,<code>x</code>,<code>L</code>,<code>M</code>,<code>S</code>.
</p>


<h3>Author(s)</h3>

<p>Stef van Buuren, 2010
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
#
library(gamlss)
boys &lt;- boys7482

# calculate initial M curve
data &lt;- na.omit(boys[,1:2])
f0154  &lt;- gamlss(hgt~cs(age,df=15,c.spar=c(-1.5,2.5)),
                sigma.formula=~cs(age,df=4,c.spar=c(-1.5,2.5)),
                data=data,family=NO,
                control=gamlss.control(n.cyc=3))                      

# calculate transformed age
t.age &lt;- fitted(lm(data$age~fitted(f0154)))
t.age &lt;- t.age - min(t.age)
data.t &lt;- data.frame(data,t.age=t.age)

# calculate final solution
f0106r &lt;- gamlss(hgt~cs(t.age,df=10,c.spar=c(-1.5,2.5)),
                sigma.formula=~cs(t.age,df=6,c.spar=c(-1.5,2.5)),
                data=data.t,family=NO,
                control=gamlss.control(n.cyc=3))

# extract the LMS reference table in the 'classic' age grid
nl4.hgt.boys &lt;- extractLMS(fit = f0106r, data=data.t, grid="compact", 
               dec = c(0,2,5))
nl4.hgt.boys


# flatten the reference beyond age 20Y (not very useful in this data)
nl4.hgt.boys.flat &lt;- extractLMS(fit = f0106r, data=data.t, flatAge=20)
nl4.hgt.boys.flat

# use log age transformation
data.t &lt;- data.frame(data, t.age = log(data$age))
f0106rlog &lt;- gamlss(hgt~cs(t.age,df=10,c.spar=c(-1.5,2.5)),
                sigma.formula=~cs(t.age,df=6,c.spar=c(-1.5,2.5)),
                data=data.t,family=NO,
                control=gamlss.control(n.cyc=1))

nl4.hgt.boys.log &lt;- extractLMS(fit = f0106rlog, data=data.t)
nl4.hgt.boys.log

## End(Not run)
</code></pre>

<hr>
<h2 id='References+20CDC'>Reference tables from CDC 2000</h2><span id='topic+References+20CDC'></span><span id='topic+cdc.hgt'></span><span id='topic+cdc.wgt'></span><span id='topic+cdc.bmi'></span>

<h3>Description</h3>

<p>Reference tables from CDC 2000
</p>


<h3>Format</h3>

<p>A data frame with seven variables: </p>

<dl>
<dt>list(&quot;pop&quot;)</dt><dd><p>Study Population</p>
</dd> <dt>list(&quot;sub&quot;)</dt><dd><p>Subpopulation</p>
</dd>
<dt>list(&quot;sex&quot;)</dt><dd><p>Sex (M,F)</p>
</dd> <dt>list(&quot;x&quot;)</dt><dd><p>Decimal age (0-5 years)</p>
</dd>
<dt>list(&quot;L&quot;)</dt><dd><p>Lambda (skewness) curve</p>
</dd> <dt>list(&quot;M&quot;)</dt><dd><p>Median curve</p>
</dd>
<dt>list(&quot;S&quot;)</dt><dd><p>Coefficient of Variation curve</p>
</dd> </dl>


<h3>Details</h3>

<p>The models were fitted by the LMS model. Parameters are stored as type
<code>LMS</code>. Tabulated values are point ages.
</p>
<p>The naming conventions are as follows: </p>

<dl>
<dt>list(&quot;cdc.hgt&quot;)</dt><dd><p>Combined length/height (cm) for Age, 0-20 years.
Measures &lt;2 years apply to length (lying), while ages &gt;= 2 years apply to
height, or stature (standing).</p>
</dd> 
<dt>list(&quot;cdc.wgt&quot;)</dt><dd><p>Weight (kg) for Age, 0-20 years.</p>
</dd> 
<dt>list(&quot;cdc.bmi&quot;)</dt><dd><p>Body Mass Index (kg/m2) for Age, 2-20 years.</p>
</dd></dl>



<h3>Source</h3>

<p>Kuczmarski RJ, Ogden CL, Guo SS, Grummer-Strawn LM, Flegal KM, Mei Z,
Wei R, Curtin LR, Roche AF, Johnson CL.  2000 CDC growth charts for the
United States: methods and development.  <em>Vital Health Stat</em>, 2002,
<b>11</b>, 246, 1-190.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nl4.wgt">nl4.wgt</a></code>, <code><a href="#topic+nl4.hgt">nl4.hgt</a></code>, <code><a href="#topic+nl4.bmi">nl4.bmi</a></code>,
<code><a href="#topic+who.wgt">who.wgt</a></code>
</p>

<hr>
<h2 id='References+20NL3'>Reference tables from Third Dutch Growth Study 1980</h2><span id='topic+References+20NL3'></span><span id='topic+nl3.bmi'></span>

<h3>Description</h3>

<p>Reference table from the Third Dutch Growth Study 1980
</p>


<h3>Format</h3>

<p>A data frame with seven variables: </p>

<dl>
<dt>list(&quot;pop&quot;)</dt><dd><p>Study Population</p>
</dd> <dt>list(&quot;sub&quot;)</dt><dd><p>Subpopulation, e.g.
ethnicity or age group (for <code>nl4.wfh</code>)</p>
</dd> <dt>list(&quot;sex&quot;)</dt><dd><p>Sex (M,F)</p>
</dd>
<dt>list(&quot;x&quot;)</dt><dd><p>Decimal age (0-21 years) or Height (for <code>nl4.wfh</code>)</p>
</dd>
<dt>list(&quot;L&quot;)</dt><dd><p>Lambda (skewness) curve</p>
</dd> <dt>list(&quot;M&quot;)</dt><dd><p>Median curve</p>
</dd>
<dt>list(&quot;S&quot;)</dt><dd><p>Coefficient of Variation curve</p>
</dd> </dl>


<h3>Details</h3>

<p>The model was fitted by the LMS model. Parameters are stored as type
<code>LMS</code>. Tabulated values are point ages.
</p>
<p>Height follows a normal distribution, with all lambda parameters set equal to
1. The standard deviation (in cm) is obtained as <code>S*M</code>.
</p>
<p>The naming conventions are as follows: </p>

<dl>
<dt>list(&quot;nl4.hgt&quot;)</dt><dd><p>Length/Height (cm) for Age</p>
</dd>
<dt>list(&quot;nl4.wgt&quot;)</dt><dd><p>Weight (kg) for Age</p>
</dd> <dt>list(&quot;nl4.wfh&quot;)</dt><dd><p>Weight
(kg) for Height (cm)</p>
</dd> <dt>list(&quot;nl4.bmi&quot;)</dt><dd><p>Head circumference (cm) for Age</p>
</dd>
<dt>list(&quot;nl4.lgl&quot;)</dt><dd><p>Leg Length (cm) for Age</p>
</dd> <dt>list(&quot;nl4.hip&quot;)</dt><dd><p>Hip
circumference (cm) for Age</p>
</dd> <dt>list(&quot;nl4.wst&quot;)</dt><dd><p>Waist circumference (cm)
for Age</p>
</dd> <dt>list(&quot;nl4.whr&quot;)</dt><dd><p>Waist/Hip ratio for Age</p>
</dd>
<dt>list(&quot;nl4.sit&quot;)</dt><dd><p>Sitting Height for Age</p>
</dd> <dt>list(&quot;nl4.shh&quot;)</dt><dd><p>Sitting
Height/Height ratio for Age</p>
</dd> </dl>



<h3>Source</h3>

<p>Fredriks, A.M,, van Buuren, S., Burgmeijer, R.J., Meulmeester JF,
Beuker, R.J., Brugman, E., Roede, M.J., Verloove-Vanhorick, S.P., Wit, J.M.
(2000) Continuing positive secular growth change in The Netherlands
1955-1997.  <em>Pediatric Research</em>, <b>47</b>, 316-323. 
</p>
<p>Fredriks, A.M., van Buuren, S., Wit, J.M., Verloove-Vanhorick, S.P. (2000).
Body index measurements in 1996-7 compared with 1980.  <em>Archives of
Disease in Childhood</em>, <b>82</b>, 107-112.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cdc.wgt">cdc.wgt</a></code>, <code><a href="#topic+who.wgt">who.wgt</a></code>
</p>

<hr>
<h2 id='References+20NL4'>Reference tables from Fourth Dutch Growth Study 1997</h2><span id='topic+References+20NL4'></span><span id='topic+nl4.hgt'></span><span id='topic+nl4.wgt'></span><span id='topic+nl4.wfh'></span><span id='topic+nl4.bmi'></span><span id='topic+nl4.hdc'></span><span id='topic+nl4.lgl'></span><span id='topic+nl4.hip'></span><span id='topic+nl4.wst'></span><span id='topic+nl4.whr'></span><span id='topic+nl4.sit'></span><span id='topic+nl4.shh'></span>

<h3>Description</h3>

<p>Reference table from the Fourth Dutch Growth Study 1997
</p>


<h3>Format</h3>

<p>A data frame with seven variables: </p>

<dl>
<dt>list(&quot;pop&quot;)</dt><dd><p>Study Population</p>
</dd> <dt>list(&quot;sub&quot;)</dt><dd><p>Subpopulation, e.g.
ethnicity or age group (for <code>nl4.wfh</code>)</p>
</dd> <dt>list(&quot;sex&quot;)</dt><dd><p>Sex (M,F)</p>
</dd>
<dt>list(&quot;x&quot;)</dt><dd><p>Decimal age (0-21 years) or Height (for <code>nl4.wfh</code>)</p>
</dd>
<dt>list(&quot;L&quot;)</dt><dd><p>Lambda (skewness) curve</p>
</dd> <dt>list(&quot;M&quot;)</dt><dd><p>Median curve</p>
</dd>
<dt>list(&quot;S&quot;)</dt><dd><p>Coefficient of Variation curve</p>
</dd> </dl>


<h3>Details</h3>

<p>The model was fitted by the LMS model. Parameters are stored as type
<code>LMS</code>. Tabulated values are point ages.
</p>
<p>Height follows a normal distribution, with all lambda parameters set equal to
1. The standard deviation (in cm) is obtained as <code>S*M</code>.
</p>
<p>The naming conventions are as follows: </p>

<dl>
<dt>list(&quot;nl4.hgt&quot;)</dt><dd><p>Length/Height (cm) for Age</p>
</dd>
<dt>list(&quot;nl4.wgt&quot;)</dt><dd><p>Weight (kg) for Age</p>
</dd> <dt>list(&quot;nl4.wfh&quot;)</dt><dd><p>Weight
(kg) for Height (cm)</p>
</dd> <dt>list(&quot;nl4.bmi&quot;)</dt><dd><p>Head circumference (cm) for Age</p>
</dd>
<dt>list(&quot;nl4.lgl&quot;)</dt><dd><p>Leg Length (cm) for Age</p>
</dd> <dt>list(&quot;nl4.hip&quot;)</dt><dd><p>Hip
circumference (cm) for Age</p>
</dd> <dt>list(&quot;nl4.wst&quot;)</dt><dd><p>Waist circumference (cm)
for Age</p>
</dd> <dt>list(&quot;nl4.whr&quot;)</dt><dd><p>Waist/Hip ratio for Age</p>
</dd>
<dt>list(&quot;nl4.sit&quot;)</dt><dd><p>Sitting Height for Age</p>
</dd> <dt>list(&quot;nl4.shh&quot;)</dt><dd><p>Sitting
Height/Height ratio for Age</p>
</dd> </dl>



<h3>Source</h3>

<p>Fredriks, A.M,, van Buuren, S., Burgmeijer, R.J., Meulmeester JF,
Beuker, R.J., Brugman, E., Roede, M.J., Verloove-Vanhorick, S.P., Wit, J.M.
(2000) Continuing positive secular growth change in The Netherlands
1955-1997.  <em>Pediatric Research</em>, <b>47</b>, 316-323. 
</p>
<p>Fredriks, A.M., van Buuren, S., Wit, J.M., Verloove-Vanhorick, S.P. (2000).
Body index measurements in 1996-7 compared with 1980.  <em>Archives of
Disease in Childhood</em>, <b>82</b>, 107-112.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cdc.wgt">cdc.wgt</a></code>, <code><a href="#topic+who.wgt">who.wgt</a></code>
</p>

<hr>
<h2 id='References+20WHO'>References WHO</h2><span id='topic+References+20WHO'></span><span id='topic+who.wgt'></span><span id='topic+who.hgt'></span><span id='topic+who.bmi'></span><span id='topic+who.wfh'></span><span id='topic+who.wfl'></span><span id='topic+who.hdc'></span>

<h3>Description</h3>

<p>Reference tables, combined from the WHO Multicentre Growth Reference 
Study (MGRS) (ages 0-5 years) and the WHO 2007 reference (5-19 years).
</p>


<h3>Format</h3>

<p>A data frame with seven variables: 
</p>

<dl>
<dt>pop</dt><dd><p>Study Population (always <code>"who"</code>)</p>
</dd> 
<dt>sub</dt><dd><p>Subpopulation (always <code>"N"</code>)</p>
</dd>
<dt>sex</dt><dd><p>Sex (M, F)</p>
</dd>
<dt>x</dt><dd><p>Decimal age, height (cm) or length(cm)</p>
</dd>
<dt>L</dt><dd><p>Lambda (skewness) curve</p>
</dd>
<dt>M</dt><dd><p>Median curve</p>
</dd>
<dt>S</dt><dd><p>Coefficient of variation</p>
</dd>
</dl>


<h3>Details</h3>

<p>The data were fitted by the LMS model. Parameters are stored as type
<code>LMS</code>. Tabulated values are point ages.
</p>
<p>The naming conventions are as follows: 
</p>

<dl>
<dt>who.hgt</dt><dd><p>Length (cm, 0-2 Yrs) or height (cm, 2-19 years)</p>
</dd> 
<dt>who.wgt</dt><dd><p>Weight (kg) for age (0-10 years)</p>
</dd>
<dt>who.bmi</dt><dd><p>BMI (kg/m^2) for age (0-19 years)</p>
</dd>
<dt>who.hdc</dt><dd><p>Head circumference (cm) for age (0-5 years)</p>
</dd>
<dt>who.wfh</dt><dd><p>Weight (kg) for height (65-120 cm)</p>
</dd>
<dt>who.wfl</dt><dd><p>Weight (kg) for length (45-110 cm)</p>
</dd>
</dl>



<h3>Source</h3>

<p>WHO Multicentre Growth Reference Study Group.  WHO Child Growth
Standards based on length/height, weight and age.  <em>Acta Paediatr</em>,
Suppl. 2006, 450, 76-85.
</p>
<p>de Onis M, Onyango AW, Borghi E, Siyam A, Nishida C, Siekmann J.
Development of a WHO growth reference for school-aged children and adolescents
<em>Bulletin of the World Health Organization</em>, 2007;85:660-7.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nl4.wgt">nl4.wgt</a></code>, <code><a href="#topic+cdc.wgt">cdc.wgt</a></code>, 
<a href="http://www.who.int/childgrowth/mgrs/en/">http://www.who.int/childgrowth/mgrs/en/</a>,
<a href="http://www.who.int/growthref/en/">http://www.who.int/growthref/en/</a>
</p>

<hr>
<h2 id='wp.twin'>Superposes two worm plots</h2><span id='topic+wp.twin'></span>

<h3>Description</h3>

<p>Superposes two worm plots from GAMLSS fitted objects. This is a diagnostic
tool for comparing two solutions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wp.twin(obj1, obj2 = NULL, xvar = NULL, xvar.column = 2, n.inter = 16,
  show.given = FALSE, ylim.worm = 0.5, line = FALSE, cex = 1,
  col1 = "black", col2 = "orange", warnings = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wp.twin_+3A_obj1">obj1</code></td>
<td>
<p>a GAMLSS fitted object</p>
</td></tr>
<tr><td><code id="wp.twin_+3A_obj2">obj2</code></td>
<td>
<p>an optional second GAMLSS fitted object</p>
</td></tr>
<tr><td><code id="wp.twin_+3A_xvar">xvar</code></td>
<td>
<p>the explanatory variable against which the worm plots will be
plotted</p>
</td></tr>
<tr><td><code id="wp.twin_+3A_xvar.column">xvar.column</code></td>
<td>
<p>the number referring to the column of <code>obj1$mu.x</code> and
<code>obj2$mu.x</code>.  If <code>xvar=NULL</code> then the explanatory variable is set
to <code>xvar=obj1$mu.x[,xvar.column]</code> respectively
<code>xvar=obj2$mu.x[,xvar.column]</code>.  The default is <code>xvar.column=2</code>,
which selects the variable following the intercept (which is typically age in
most applications).</p>
</td></tr>
<tr><td><code id="wp.twin_+3A_n.inter">n.inter</code></td>
<td>
<p>the number of intervals in which the explanatory variable
<code>xvar</code> will be cut. The default is 16.</p>
</td></tr>
<tr><td><code id="wp.twin_+3A_show.given">show.given</code></td>
<td>
<p>whether to show the x-variable intervals in the top of the
graph, default is <code>show.given=FALSE</code></p>
</td></tr>
<tr><td><code id="wp.twin_+3A_ylim.worm">ylim.worm</code></td>
<td>
<p>for multiple plots, this values is the y-variable limit,
default value is <code>ylim.worm=0.5</code></p>
</td></tr>
<tr><td><code id="wp.twin_+3A_line">line</code></td>
<td>
<p>whether to plot the polynomial line in the worm plot, default
value is <code>line=FALSE</code></p>
</td></tr>
<tr><td><code id="wp.twin_+3A_cex">cex</code></td>
<td>
<p>the cex plotting parameter with default <code>cex=1</code></p>
</td></tr>
<tr><td><code id="wp.twin_+3A_col1">col1</code></td>
<td>
<p>the color for the points of <code>obj1</code>. The default
<code>col="black"</code></p>
</td></tr>
<tr><td><code id="wp.twin_+3A_col2">col2</code></td>
<td>
<p>the color for the points of <code>obj2</code>. The default
<code>col="orange"</code></p>
</td></tr>
<tr><td><code id="wp.twin_+3A_warnings">warnings</code></td>
<td>
<p>a logical indicating whether warnings should be produced. The
default <code>warnings=FALSE</code></p>
</td></tr>
<tr><td><code id="wp.twin_+3A_...">...</code></td>
<td>
<p>for extra arguments, <code>overlap</code>, <code>xlim.worm</code> or
<code>pch</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a customized version of the <code>wp()</code> function found in
the <code>gamlss</code> package. Function <code>wp.twin()</code> allows overplotting of
two worm plots, each in its own color.  The points of <code>obj1</code> are plotted
first, the points of <code>obj2</code> are superposed.  This twin worm plot provide
a visual assessment of the differences between the solutions.  Extra
arguments can be specified (e.g. <code>xvar</code>) that are passed down to the
<code>wp()</code> function of <code>gamlss</code> if specified.  The worm plot is a
detrended normal QQ-plot that highlight departures from normality.
</p>
<p>Argument <code>xvar</code> takes priority over <code>xvar.column</code>. The <code>xvar</code>
variable is cut into <code>n.iter</code> intervals with an equal number
observations and detrended normal QQ (i.e. worm) plots for each interval are
plotted.  This is a way of highlighting failures of the model within
different ranges of the explanatory variable.
</p>
<p>If <code>line=TRUE</code> and <code>n.inter&gt;1</code>, the fitted coefficients from
fitting cubic polynomials to the residuals (within each x-variable interval)
can be obtain by e.g.  <code>coeffs&lt;-wp.twin(model1,xvar=x,n.iner=9)</code>.  van
Buuren <em>et al.</em> (2001) used these residuals to identify regions
(intervals) of the explanatory variable within which the model does not fit
adequately the data (called &quot;model violation&quot;)
</p>


<h3>Value</h3>

<p>For multiple plots the <code>xvar</code> intervals and the coefficients of
the fitted cubic polynomials to the residuals (within each <code>xvar</code>
interval) are returned.
</p>


<h3>Author(s)</h3>

<p>Stef van Buuren, using R code of Mikis Stasinopoulos and Bob Rigby
</p>


<h3>References</h3>

<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models
for location scale and shape (GAMLSS) in R. <em>Journal of Statistical
Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007,
<a href="http://www.jstatsoft.org/v23/i07">http://www.jstatsoft.org/v23/i07</a>.
</p>
<p>van Buuren and Fredriks M. (2001) Worm plot: simple diagnostic device for
modelling growth reference curves.  <em>Statistics in Medicine</em>, <b>20</b>,
1259&ndash;1277. 
</p>
<p>van Buuren and Fredriks M. (2007) Worm plot to diagnose fit in quantile
regression.  <em>Statistical Modelling</em>, <b>7</b>, 4, 363&ndash;376.
</p>


<h3>See Also</h3>

<p><code><a href="gamlss.html#topic+wp">wp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(gamlss)
data(abdom)
a &lt;- gamlss(y~cs(x,df=1),sigma.fo=~cs(x,0),family=LO,data=abdom)
b &lt;- gamlss(y~cs(x,df=3),sigma.fo=~cs(x,1),family=LO,data=abdom)
coeff1 &lt;- wp.twin(a,b,line=TRUE)
coeff1
rm(a,b,coeff1)
</code></pre>

<hr>
<h2 id='y2z'>Converts measurements to standard deviation scores (SDS)</h2><span id='topic+y2z'></span>

<h3>Description</h3>

<p>Converts measurements into age- and sex-conditional standard deviation score
(SDS) using an external reference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>y2z(y = c(75, 80, 85), x = 1, sex = "M", sub = "N",
  ref = get("nl4.hgt"), dist = "LMS", dec = 3, sex.fallback = NA,
  sub.fallback = NA, tail.adjust = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="y2z_+3A_y">y</code></td>
<td>
<p>A numerical vector containing the outcome measurements.  The length
<code>length(y)</code> determines the size of the output vector.</p>
</td></tr>
<tr><td><code id="y2z_+3A_x">x</code></td>
<td>
<p>A vector containing the values of the numerical covariate (typically
decimal age or height) at which conversion is desired.  Values are replicated
to match <code>length(y)</code>.</p>
</td></tr>
<tr><td><code id="y2z_+3A_sex">sex</code></td>
<td>
<p>A character vector indicating whether the male (<code>"M"</code>) of
female (<code>"F"</code>)reference should be used.  Values are replicated to match
<code>length(y)</code>.</p>
</td></tr>
<tr><td><code id="y2z_+3A_sub">sub</code></td>
<td>
<p>A character vector indicating the level of the <code>sub</code> field of
the reference standard defined in <code>ref</code></p>
</td></tr>
<tr><td><code id="y2z_+3A_ref">ref</code></td>
<td>
<p>A data frame containing a factor <code>sex</code>, a numerical variable
<code>age</code> containing the tabulated decimal point ages, and two or more
numerical variables with reference values. See details.</p>
</td></tr>
<tr><td><code id="y2z_+3A_dist">dist</code></td>
<td>
<p>A string identifying the type of distribution. Values values are:
<code>"NO"</code>, <code>"BCCG"</code>, <code>"LMS"</code>, <code>"BCPE"</code> and <code>"BCT"</code>.
The default is <code>"LMS"</code>.</p>
</td></tr>
<tr><td><code id="y2z_+3A_dec">dec</code></td>
<td>
<p>A scalar value indicating the number of decimals used to round the
value.</p>
</td></tr>
<tr><td><code id="y2z_+3A_sex.fallback">sex.fallback</code></td>
<td>
<p>The level of the <code>sex</code> field used when no match is
found.  The default <code>sex.fallback=NA</code> specifies that 
unmatched entries should receive a <code>NA</code> value.</p>
</td></tr>
<tr><td><code id="y2z_+3A_sub.fallback">sub.fallback</code></td>
<td>
<p>The level of the <code>sub</code> field used when no match is
found.  The default <code>sub.fallback=NA</code> specifies that 
unmatched entries should receive a <code>NA</code> value.</p>
</td></tr>
<tr><td><code id="y2z_+3A_tail.adjust">tail.adjust</code></td>
<td>
<p>Logical. If <code>TRUE</code> then the WHO method for 
tail adjustment is applied. The default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Functions <code>z2y()</code> and <code>y2z()</code> are the inverse of each other.
</p>
<p>The argument <code>dist</code> determines the statistical distribution.  The
possibilities are as follows: </p>
 <dl>
<dt>list(&quot;\&quot;NO\&quot;&quot;)</dt><dd><p><code>ref</code>
should contain columns <code>mean</code> and <code>sd</code>, containing the mean and the
standard deviation in the external reference population.</p>
</dd>
<dt>list(&quot;\&quot;LMS\&quot;&quot;)</dt><dd><p><code>ref</code> should contain columns <code>L</code>, <code>S</code>
and <code>M</code> containing the LMS parameters.</p>
</dd>
<dt>list(&quot;\&quot;BCCG\&quot;&quot;)</dt><dd><p><code>ref</code> should contain columns <code>mu</code>,
<code>sigma</code> and <code>nu</code> containing the Box-Cox Cole-Green parameters.</p>
</dd>
<dt>list(&quot;\&quot;BCPE\&quot;&quot;)</dt><dd><p><code>ref</code> should contain columns <code>mu</code>,
<code>sigma</code>, <code>nu</code> and <code>tau</code> containing the Box-Cox Power
Exponential parameters.</p>
</dd> <dt>list(&quot;\&quot;BCT\&quot;&quot;)</dt><dd><p><code>ref</code> should contain
columns <code>mu</code>, <code>sigma</code>, <code>nu</code> and <code>tau</code> containing the
Box-Cox T distribution parameters.</p>
</dd> </dl>



<h3>Value</h3>

<p>For <code>y2z()</code>: A vector with <code>length(y)</code> elements containing
the standard deviation score.  For <code>z2y()</code>: A vector with
<code>length(z)</code> elements containing quantiles.
</p>


<h3>Author(s)</h3>

<p>Stef van Buuren, 2010
</p>


<h3>See Also</h3>

<p><code><a href="#topic+z2y">z2y</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

boys &lt;- boys7482

# SDS of height 115 cm at age 5 years, 
# relative to Dutch boys reference
y2z(y=115, x=5)

# same relative to Dutch girls
y2z(y=115, x=5, sex="F")

# SDS of IOTF BMI cut-off value for overweight (boys 2-18) 
# relative to Dutch boys reference
cutoff &lt;- c(
18.41, 18.15, 17.89, 17.72, 17.55, 17.49, 17.42, 17.49, 17.55, 17.74,
17.92, 18.18, 18.44, 18.77, 19.10, 19.47, 19.84, 20.20, 20.55, 20.89, 
21.22, 21.57, 21.91, 22.27, 22.62, 22.96, 23.29, 23.60, 23.90, 24.18, 
24.46, 24.73, 25.00)
age &lt;- seq(2, 18, by=0.5)
(z &lt;- y2z(y=cutoff, x=age, sex="M", ref=nl4.bmi))

# apply inverse transformation to check calculations
round(z2y(z, age, ref=nl4.bmi), 2)
cutoff

# calculate percentiles of weight 12 kg at 2 years (boys, girls)
100*round(pnorm(y2z(y=c(12,12), x=2, sex=c("M","F"), ref=nl4.wgt)),2)

# # percentage of children lighter than 15kg at ages 2-5
e &lt;- expand.grid(age=2:5, sex=c("M","F"))
z &lt;- y2z(y=rep(15,nrow(e)), x=e$age, sex=e$sex, ref=nl4.wgt)
w &lt;- matrix(100*round(pnorm(z),2), nrow=2, byrow=TRUE)
dimnames(w) &lt;- list(c("boys","girls"),2:5)
w

# analysis in Z scale
hgt.z &lt;- y2z(y=boys$hgt, x=boys$age, sex="M", ref=nl4.hgt)
wgt.z &lt;- y2z(y=boys$wgt, x=boys$age, sex="M", ref=nl4.wgt)
plot(hgt.z, wgt.z, col="blue")


# z2y

# quantile at SD=0 of age 2 years, 
# height Dutch boys
z2y(z=0, x=2)

# same for Dutch girls
z2y(z=0, x=2, sex="F")

# quantile at SD=c(-1,0,1) of age 2 years, BMI Dutch boys
z2y(z=c(-1,0,+1), x=2, ref=nl4.bmi)

# 0SD line (P50) in kg of weight for age in 5-10 year, Dutch boys
z2y(z=rep(0,6), x=5:10, ref=nl4.wgt)

# 95th percentile (P95), age 10 years, wfa, Dutch boys
z2y(z=qnorm(0.95), x=10, ref=nl4.wgt)

# table of P3, P10, P50, P90, P97 of weight for 5-10 year old dutch boys
# age per year
age &lt;- 5:10
p &lt;- c(0.03,0.1,0.5,0.9,0.97)
z &lt;- rep(qnorm(p), length(age))
x &lt;- rep(age, each=length(p))
w &lt;- matrix(z2y(z, x=x, sex="M", ref=nl4.wgt), ncol=length(p),
 byrow=TRUE)
dimnames(w) &lt;- list(age, p)
round(w,1)

# standard set of Z-scores of weight for all tabulated ages, boys &amp; girls
# and three etnicities
sds &lt;- c(-2.5, -2, -1, 0, 1, 2, 2.5)
age &lt;- nl4.wgt$x
z &lt;- rep(sds, times=length(age))
x &lt;- rep(age, each=length(sds))
sex &lt;- rep(c("M","F"), each=length(z)/2)
w &lt;- z2y(z=z, x=x, sex=sex, ref=nl4.wgt)
w &lt;- matrix(w, ncol=length(sds), byrow=TRUE)
dimnames(w) &lt;- list(age, sds)
data.frame(sub=nl4.wgt$sub,sex=nl4.wgt$sex,round(w,2), row.names=NULL)

# P85 of BMI in 5-8 year old Dutch boys and girls
e &lt;- expand.grid(age=5:8, sex=c("M","F"))
w &lt;- z2y(z=rep(qnorm(0.85),nrow(e)), x=e$age, sex=e$sex, ref=nl4.bmi)
w &lt;- matrix(w, nrow=2, byrow=TRUE)
dimnames(w) &lt;- list(c("boys","girls"),5:8)
w

# data transformation of height z-scores to cm-scale
z &lt;- c(-1.83, 0.09, 2.33, 0.81, -1.20)
x &lt;- c(8.33,  0.23, 19.2, 24.3, 10)
sex &lt;- c("M", "M", "F", "M", "F")
round(z2y(z=z, x=x, sex=sex, ref=nl4.hgt), 1)

# interpolate published height standard 
# to daily values, days 0-31, boys
# on centiles -2SD, 0SD and +2SD 
days &lt;- 0:31
sds  &lt;- c(-2, 0, +2)
z    &lt;- rep(sds, length(days))
x    &lt;- rep(round(days/365.25,4), each=length(sds))
w    &lt;- z2y(z, x, sex="M", ref=nl4.hgt)
w    &lt;- matrix(w, ncol=length(sds), byrow=TRUE)
dimnames(w) &lt;- list(days, sds)
w

</code></pre>

<hr>
<h2 id='z2y'>Convert standard deviation scores (SDS) to measurements</h2><span id='topic+z2y'></span>

<h3>Description</h3>

<p>Converts standard deviation score (SDS) into measurements using 
an age- and sex-conditional external reference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>z2y(z = c(-2, 0, 2), x = 1, sex = "M", sub = "N",
  ref = get("nl4.hgt"), dist = "LMS", dec = 3, sex.fallback = NA,
  sub.fallback = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="z2y_+3A_z">z</code></td>
<td>
<p>A numerical vector containing standard deviation scores that are to
be converted. The length <code>length(z)</code> determines the size of the output
vector.</p>
</td></tr>
<tr><td><code id="z2y_+3A_x">x</code></td>
<td>
<p>A vector containing the values of the numerical covariate (typically
decimal age or height) at which conversion is desired.  Values are replicated
to match <code>length(y)</code>.</p>
</td></tr>
<tr><td><code id="z2y_+3A_sex">sex</code></td>
<td>
<p>A character vector indicating whether the male (<code>"M"</code>) of
female (<code>"F"</code>)reference should be used.  Values are replicated to match
<code>length(y)</code>.</p>
</td></tr>
<tr><td><code id="z2y_+3A_sub">sub</code></td>
<td>
<p>A character vector indicating the level of the <code>sub</code> field of
the reference standard defined in <code>ref</code></p>
</td></tr>
<tr><td><code id="z2y_+3A_ref">ref</code></td>
<td>
<p>A data frame containing a factor <code>sex</code>, a numerical variable
<code>age</code> containing the tabulated decimal point ages, and two or more
numerical variables with reference values. See details.</p>
</td></tr>
<tr><td><code id="z2y_+3A_dist">dist</code></td>
<td>
<p>A string identifying the type of distribution. Values values are:
<code>"NO"</code>, <code>"BCCG"</code>, <code>"LMS"</code>, <code>"BCPE"</code> and <code>"BCT"</code>.
The default is <code>"LMS"</code>.</p>
</td></tr>
<tr><td><code id="z2y_+3A_dec">dec</code></td>
<td>
<p>A scalar value indicating the number of decimals used to round the
value.</p>
</td></tr>
<tr><td><code id="z2y_+3A_sex.fallback">sex.fallback</code></td>
<td>
<p>The level of the <code>sex</code> field used when no match is
found.  The default <code>sex.fallback=NA</code> specifies that 
unmatched entries should receive a <code>NA</code> value.</p>
</td></tr>
<tr><td><code id="z2y_+3A_sub.fallback">sub.fallback</code></td>
<td>
<p>The level of the <code>sub</code> field used when no match is
found.  The default <code>sub.fallback=NA</code> specifies that 
unmatched entries should receive a <code>NA</code> value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Functions <code>z2y()</code> and <code>y2z()</code> are the inverse of each other.
</p>
<p>The argument <code>dist</code> determines the statistical distribution.  The
possibilities are as follows: </p>
 <dl>
<dt>list(&quot;\&quot;NO\&quot;&quot;)</dt><dd><p><code>ref</code>
should contain columns <code>mean</code> and <code>sd</code>, containing the mean and the
standard deviation in the external reference population.</p>
</dd>
<dt>list(&quot;\&quot;LMS\&quot;&quot;)</dt><dd><p><code>ref</code> should contain columns <code>L</code>, <code>S</code>
and <code>M</code> containing the LMS parameters.</p>
</dd>
<dt>list(&quot;\&quot;BCCG\&quot;&quot;)</dt><dd><p><code>ref</code> should contain columns <code>mu</code>,
<code>sigma</code> and <code>nu</code> containing the Box-Cox Cole-Green parameters.</p>
</dd>
<dt>list(&quot;\&quot;BCPE\&quot;&quot;)</dt><dd><p><code>ref</code> should contain columns <code>mu</code>,
<code>sigma</code>, <code>nu</code> and <code>tau</code> containing the Box-Cox Power
Exponential parameters.</p>
</dd> <dt>list(&quot;\&quot;BCT\&quot;&quot;)</dt><dd><p><code>ref</code> should contain
columns <code>mu</code>, <code>sigma</code>, <code>nu</code> and <code>tau</code> containing the
Box-Cox T distribution parameters.</p>
</dd> </dl>



<h3>Value</h3>

<p>For <code>y2z()</code>: A vector with <code>length(y)</code> elements containing
the standard deviation score.  For <code>z2y()</code>: A vector with
<code>length(z)</code> elements containing quantiles.
</p>


<h3>Author(s)</h3>

<p>Stef van Buuren, 2010
</p>


<h3>See Also</h3>

<p><code><a href="#topic+y2z">y2z</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

boys &lt;- boys7482

# quantile at SD=0 of age 2 years, 
# height Dutch boys
z2y(z=0, x=2)

# same for Dutch girls
z2y(z=0, x=2, sex="F")

# quantile at SD=c(-1,0,1) of age 2 years, BMI Dutch boys
z2y(z=c(-1,0,+1), x=2, ref=nl4.bmi)

# 0SD line (P50) in kg of weight for age in 5-10 year, Dutch boys
z2y(z=rep(0,6), x=5:10, ref=nl4.wgt)

# 95th percentile (P95), age 10 years, wfa, Dutch boys
z2y(z=qnorm(0.95), x=10, ref=nl4.wgt)

# table of P3, P10, P50, P90, P97 of weight for 5-10 year old dutch boys
# age per year
age &lt;- 5:10
p &lt;- c(0.03,0.1,0.5,0.9,0.97)
z &lt;- rep(qnorm(p), length(age))
x &lt;- rep(age, each=length(p))
w &lt;- matrix(z2y(z, x=x, sex="M", ref=nl4.wgt), ncol=length(p),
 byrow=TRUE)
dimnames(w) &lt;- list(age, p)
round(w,1)

# standard set of Z-scores of weight for all tabulated ages, boys &amp; girls
# and three etnicities
sds &lt;- c(-2.5, -2, -1, 0, 1, 2, 2.5)
age &lt;- nl4.wgt$x
z &lt;- rep(sds, times=length(age))
x &lt;- rep(age, each=length(sds))
sex &lt;- rep(c("M","F"), each=length(z)/2)
w &lt;- z2y(z=z, x=x, sex=sex, ref=nl4.wgt)
w &lt;- matrix(w, ncol=length(sds), byrow=TRUE)
dimnames(w) &lt;- list(age, sds)
data.frame(sub=nl4.wgt$sub,sex=nl4.wgt$sex,round(w,2), row.names=NULL)

# P85 of BMI in 5-8 year old Dutch boys and girls
e &lt;- expand.grid(age=5:8, sex=c("M","F"))
w &lt;- z2y(z=rep(qnorm(0.85),nrow(e)), x=e$age, sex=e$sex, ref=nl4.bmi)
w &lt;- matrix(w, nrow=2, byrow=TRUE)
dimnames(w) &lt;- list(c("boys","girls"),5:8)
w

# data transformation of height z-scores to cm-scale
z &lt;- c(-1.83, 0.09, 2.33, 0.81, -1.20)
x &lt;- c(8.33,  0.23, 19.2, 24.3, 10)
sex &lt;- c("M", "M", "F", "M", "F")
round(z2y(z=z, x=x, sex=sex, ref=nl4.hgt), 1)

# interpolate published height standard 
# to daily values, days 0-31, boys
# on centiles -2SD, 0SD and +2SD 
days &lt;- 0:31
sds  &lt;- c(-2, 0, +2)
z    &lt;- rep(sds, length(days))
x    &lt;- rep(round(days/365.25,4), each=length(sds))
w    &lt;- z2y(z, x, sex="M", ref=nl4.hgt)
w    &lt;- matrix(w, ncol=length(sds), byrow=TRUE)
dimnames(w) &lt;- list(days, sds)
w

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
