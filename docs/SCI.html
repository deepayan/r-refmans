<!DOCTYPE html><html><head><title>Help for package SCI</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SCI}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SCI-package'>
<p>Standardized Climate Indices Such as SPI, SRI or SPEI</p></a></li>
<li><a href='#dist.start'>
<p>Rough estimates for parameters of selected distributions</p></a></li>
<li><a href='#fitSCI'>
<p>Standardized Climate Index (SCI)</p></a></li>
<li><a href='#genlog'>
<p>Generalized Logistic Distribution</p></a></li>
<li><a href='#pe3'>
<p>Pearson Type III distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Standardized Climate Indices Such as SPI, SRI or SPEI</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-2</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-05-02</td>
</tr>
<tr>
<td>Author:</td>
<td>Lukas Gudmundsson &amp; James H. Stagge</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lukas Gudmundsson &lt;lukas.gudmundsson@env.ethz.ch&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>fitdistrplus, lmomco</td>
</tr>
<tr>
<td>Suggests:</td>
<td>evd</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for generating Standardized Climate Indices (SCI). 
		SCI is a transformation of (smoothed) climate (or environmental)
		time series that  removes seasonality and forces the data to
		take values of the standard normal distribution. SCI was 
		originally developed for precipitation. In this case it is 
		known as the Standardized Precipitation Index (SPI).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-05-03 07:53:01 UTC; lukasgu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-05-03 11:03:16</td>
</tr>
</table>
<hr>
<h2 id='SCI-package'>
Standardized Climate Indices Such as SPI, SRI or SPEI
</h2><span id='topic+SCI-package'></span><span id='topic+SCI'></span>

<h3>Description</h3>

<p>Functions for generating Standardized Climate Indices (SCI). SCI is a
transformation of (smoothed) climate (or environmental) time series
that  removes seasonality and forces the data to take values of the
standard normal distribution. SCI was originally developed for
precipitation. In this case it is known as the Standardized
Precipitation Index (SPI).
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
  Package: </td><td style="text-align: left;"> SCI</td>
</tr>
<tr>
 <td style="text-align: left;">
  Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
  Version: </td><td style="text-align: left;"> 1.0-2</td>
</tr>
<tr>
 <td style="text-align: left;">
  Date: </td><td style="text-align: left;"> 2016-05-02</td>
</tr>
<tr>
 <td style="text-align: left;">
  License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Lukas Gudmundsson &amp; James Stagge
</p>
<p>Maintainer: Lukas Gudmundsson &lt;lukas.gudmundsson@env.ethz.ch&gt;
</p>


<h3>References</h3>

<p>Stagee, J.H. ; Tallaksen, L.M.; Gudmundsson, L.; van Loon, A.;
Stahl, K.: Candidate Distributions for Climatological Drought Indices  (SPI and SPEI),
2015, International Journal of Climatology, 35, 4027-4040, doi:10.1002/joc.4267.
</p>
<p>Stagee, J.H. ; Tallaksen, L.M.; Gudmundsson, L.; van Loon, A.;
Stahl, K.: Response to comment on &quot;Candidate Distributions for Climatological
Drought Indices (SPI and SPEI)&quot;, 2016, International Journal of
Climatology, 36, 2132-2138, doi:10.1002/joc.4564.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## create artificial data, resembling precipitation
set.seed(101)
n.years &lt;- 60
date &lt;- rep(1:n.years,each=12) + 1950 + rep((0:11)/12,times=n.years)
PRECIP &lt;- (0.25*sin( 2 * pi * date) + 0.3)*rgamma(n.years*12, shape = 3, scale = 1)
PRECIP[PRECIP&lt;0.1] &lt;- 0

## apply SCI transformation
spi.para &lt;- fitSCI(PRECIP,first.mon=1,time.scale=6,distr="gamma",p0=TRUE)
spi &lt;- transformSCI(PRECIP,first.mon=1,obj=spi.para)
plot(date,spi,t="l")
</code></pre>

<hr>
<h2 id='dist.start'>
Rough estimates for parameters of selected distributions
</h2><span id='topic+dist.start'></span><span id='topic+lmom.start'></span><span id='topic+mom.start'></span>

<h3>Description</h3>

<p>Produces rough parameter estimates for specific distributions
(<code>distr</code>) that are useful as starting values for maximum
likelihood estimation. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist.start(x, distr,...)
lmom.start(x, distr = c("gamma","genlog","gev","gumbel",
          "lnorm","norm","pe3","weibull"),...)
mom.start(x, distr = c("gamma","gumbel","logis","lnorm","norm",
          "weibull"),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist.start_+3A_x">x</code></td>
<td>

<p><code>numeric</code> vector
</p>
</td></tr>
<tr><td><code id="dist.start_+3A_distr">distr</code></td>
<td>

<p>A character string <code>"name"</code> naming a distribution for which the
corresponding density function (<code>dname</code>), the corresponding
distribution function (<code>pname</code>) and the quantile function
(<code>qname</code>) must be defined (see for example
<code><a href="stats.html#topic+GammaDist">GammaDist</a></code>)
</p>
</td></tr>
<tr><td><code id="dist.start_+3A_...">...</code></td>
<td>

<p>arguments passed to other functions, currently not used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>lmom.start</code> uses L-moments for parameter estimation. In most
cases it relies on functionality of the <span class="pkg">lmomco</span>
package. Currently available distributions are: <code>"<a href="base.html#topic+gamma">gamma</a>"</code>,
<code>"<a href="#topic+genlog">genlog</a>"</code>, <code>"<a href="evd.html#topic+dgev">gev</a>"</code>,
<code>"<a href="evd.html#topic+dgumbel">gumbel</a>"</code>, <code>"<a href="stats.html#topic+Logistic">logis</a>"</code>, 
<code>"<a href="stats.html#topic+Lognormal">lnorm</a>"</code>, <code>"<a href="base.html#topic+norm">norm</a>"</code>,
<code>"<a href="#topic+pe3">pe3</a>"</code>, <code>"<a href="stats.html#topic+Weibull">weibull</a>"</code>.   
</p>
<p><code>mom.start</code> uses moments (e.g. mean, standard deviation) for
parameter estimation. Some estimates are precise, others only
approximations that provide reasonable starting values. Currently
available distributions are: <code>"<a href="base.html#topic+gamma">gamma</a>"</code>,
<code>"<a href="evd.html#topic+dgumbel">gumbel</a>"</code>, <code>"<a href="stats.html#topic+Logistic">logis</a>"</code>,
<code>"<a href="stats.html#topic+Lognormal">lnorm</a>"</code>, <code>"<a href="base.html#topic+norm">norm</a>"</code>, <code>"<a href="stats.html#topic+Weibull">weibull</a>"</code>. 
</p>
<p><code>dist.start</code> calls first <code>lmom.start</code> to estimate
parameters. In case of failure <code>mom.start</code> is called, hopefully
producing reasonable parameter estimates.
</p>


<h3>Value</h3>

<p>named list, names correspond to distribution parameters. In case of
failure, the same list with <code>NA</code> values is returned.
</p>


<h3>Author(s)</h3>

<p>Lukas Gudmundsson &amp; James Stagge 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmom.start(rgamma(100,shape=0.5,rate=1),"gamma")

mom.start(rgamma(100,shape=0.5,rate=1),"gamma")

dist.start(rgamma(100,shape=0.5,rate=1),"gamma")
</code></pre>

<hr>
<h2 id='fitSCI'>
Standardized Climate Index (SCI)
</h2><span id='topic+fitSCI'></span><span id='topic+fitSCI.default'></span><span id='topic+transformSCI'></span><span id='topic+transformSCI.default'></span>

<h3>Description</h3>

<p><code>fitSCI</code> identifies parameters for the Standardized Climate Index
(SCI) transformation. <code>transformSCI</code> applies the transformation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitSCI(x, ...)
## Default S3 method:
fitSCI(x, first.mon, time.scale, distr, p0, 
       p0.center.mass=FALSE, scaling=c("no","max","sd"),mledist.par =  list(),
       start.fun = dist.start, start.fun.fix = FALSE, warn = TRUE, ...)

transformSCI(x, ...)
## Default S3 method:
transformSCI(x, first.mon, obj, sci.limit = Inf, warn=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitSCI_+3A_x">x</code></td>
<td>

<p><code>numeric</code> vector, representing a monthly univariate time series.
</p>
</td></tr>
<tr><td><code id="fitSCI_+3A_first.mon">first.mon</code></td>
<td>

<p>value in 1:12 indicating the month of the first element of x
</p>
</td></tr>
<tr><td><code id="fitSCI_+3A_time.scale">time.scale</code></td>
<td>

<p>The time scale (<code>integer</code>) of  the SCI calculation. The time
scale is the window length of an backward looking running mean.
</p>
</td></tr>
<tr><td><code id="fitSCI_+3A_distr">distr</code></td>
<td>

<p>A character string <code>"name"</code> naming a distribution for which the
corresponding density function (<code>dname</code>), the corresponding
distribution function (<code>pname</code>) and the quantile function
(<code>qname</code>) must be defined (see for example
<code><a href="stats.html#topic+GammaDist">GammaDist</a></code>)
</p>
</td></tr>
<tr><td><code id="fitSCI_+3A_p0">p0</code></td>
<td>

<p>if TRUE, model Probability of zero (precipitation) months is
modeled with a mixed distribution as <code class="reqn">D(x) = p_0 +
    (1-p_0)G(x)</code>, 
where  <code class="reqn">G(x) &gt; 0</code> is the reference distribution (e.g. Gamma)
<code class="reqn">p0</code> is the probability of a zero (precipitation) month. 
</p>
</td></tr>
<tr><td><code id="fitSCI_+3A_p0.center.mass">p0.center.mass</code></td>
<td>

<p>If TRUE, the Probability of zero (precipitation) is estimated using
a &quot;center of mass&quot; estimate based on the Weibull plotting position
function (see details). Only applies if <code>p0=TRUE</code>. 
</p>
</td></tr>  
<tr><td><code id="fitSCI_+3A_scaling">scaling</code></td>
<td>

<p>Indicates whether to do some scaling of <code>x</code> prior to parameter
identification. <code>"no"</code> (the default) indicates no scaling.
<code>"max"</code> indicates scaling by the maximum of <code>x</code>, such that
<code>x &lt;- x/max(x,na.rm=TRUE)</code>. <code>"sd"</code> stands for scaling by
the standard deviation. Scaling can stabilize parameter estimation.
</p>
</td></tr>  
<tr><td><code id="fitSCI_+3A_mledist.par">mledist.par</code></td>
<td>

<p>named <code>list</code> that can be used to pass parameters to
<code><a href="fitdistrplus.html#topic+mledist">mledist</a></code> in package <span class="pkg"><a href="fitdistrplus.html#topic+fitdistrplus">fitdistrplus</a></span>.
</p>
</td></tr>  
<tr><td><code id="fitSCI_+3A_start.fun">start.fun</code></td>
<td>

<p>Function with arguments <code>x</code> and <code>distr</code> estimating initial
parameters of the function <code>distr</code> for each month. The function
should return a named list corresponding to the parameters of
<code>distr</code>. (See also <code><a href="#topic+dist.start">dist.start</a></code>)
</p>
</td></tr>
<tr><td><code id="fitSCI_+3A_start.fun.fix">start.fun.fix</code></td>
<td>

<p><code>logical</code> argument, indicating if parameter estimates of
<code>start.fun</code> should be used if maximum likelihood estimation
breaks down. This stabilizes the implementation but can introduce
biases in the resulting SCI.
</p>
</td></tr>  
<tr><td><code id="fitSCI_+3A_obj">obj</code></td>
<td>

<p>an object of class <code>fitSCI</code>, output from <code><a href="#topic+fitSCI">fitSCI</a></code>.
</p>
</td></tr>  
<tr><td><code id="fitSCI_+3A_sci.limit">sci.limit</code></td>
<td>

<p>Truncate absolute values of SCI that are lage than
<code>sci.limit</code>. See details.
</p>
</td></tr>  
<tr><td><code id="fitSCI_+3A_warn">warn</code></td>
<td>

<p>Issue warnings if problems in parameter estimation occur.
</p>
</td></tr>     
<tr><td><code id="fitSCI_+3A_...">...</code></td>
<td>

<p>further arguments passed to methods
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>fitSCI</code> estimates the parameters for transforming a
meteorological and environmental time series to a Standardized
Climate Index (SCI). <code>transformSCI</code> applies the
standardisation. Typical SCI are the Standardized Precipitation
Index (SPI), the Standardized Runoff Index (SRI) or the Standardized
Precipitation Evapotranspiration Index (SPEI). 
</p>
<p>To reduce biases in the presence of many zero (precipitation) events,
the probability of these events (<code class="reqn">p_0</code>) can be estimated using
a &quot;center of mass&quot; estimate based on the Weibull plotting position
function (<code>p0.center.mass=TRUE</code>). Following Stagge et al. (2014)
the probability of zero events is then estimated as <code class="reqn">p_0 =
  \frac{n_p}{n + 1}</code>, where <code class="reqn">n_p</code> refers to
the number of zero events and <code class="reqn">n</code> is the sample size. The
resulting mixed distribution used fro SCI transformation is then   

</p>
<p style="text-align: center;"><code class="reqn">D(x) = \left\{
    \begin{array}{l l}
    p_0 + (1-p_0) G(x) &amp; \quad \mbox{if } x &gt; 0 \\
    \frac{n_p + 1}{2(n+1)} &amp; \quad \mbox{if } x = 0    
    \end{array} \right.
  </code>
</p>


<p>where <code class="reqn">G(x)&gt;0</code> is a model (e.g. gamma) distribution.
</p>
<p>Uncertainty in distribution parameters can cause unrealistically large
(small) SCI values if values in <code>x</code> exceed the values used for
parameter estimation (see <code>fitSCI</code>). Therefore
<code>transformSCI</code> allows for a truncation of the SCI series such
that <code>abs(sci)&lt;=sci.limit</code>. The truncation can be disabled by
setting <code>sci.limit=Inf</code>.
</p>


<h3>Value</h3>

<p><code>fitSCI</code> returns an object of class <code>"fitSCI"</code> with the
following components:
</p>
<table>
<tr><td><code>dist.para</code></td>
<td>

<p>A column <code>matrix</code> containing the parameters of distribution
<code>distr</code> for each month. Row names correspond to the distribution
parameters. If <code>p0=TUE</code> an additional row named <code>P0</code> is
introduced, indicating the probability of zero (precipitation)
events. 
</p>
</td></tr>
<tr><td><code>dist.para.flag</code></td>
<td>

<p>an vector indicating possible issues occurring throughout parameter
estimation. Possible values are: 0. no problems occurred;
1. starting values could not be estimated; 2. <code><a href="fitdistrplus.html#topic+mledist">mledist</a></code>
crashed with unknown error; 3. <code><a href="fitdistrplus.html#topic+mledist">mledist</a></code> did not
converge; 4. all values in this month are <code>NA</code>; 5. all values
in this month are constant, distribution not defined.
</p>
</td></tr>
<tr><td><code>time.scale</code></td>
<td>

<p>The time scale (<code>integer</code>) of  the SCI calculation. 
</p>
</td></tr>
<tr><td><code>distr</code></td>
<td>

<p>A character string <code>"name"</code> naming a distribution used
</p>
</td></tr>
<tr><td><code>p0</code></td>
<td>

<p><code>logical</code> indicating whether probability of zero
(precipitation) events is estimated separately.
</p>
</td></tr>
<tr><td><code>p0.center.mass</code></td>
<td>

<p><code>logical</code> indicating whether probability of zero
(precipitation) events is estimated using the &quot;centre of mass&quot;
estimator (see Stagge et al. (2014) for details).
</p>
</td></tr>
<tr><td><code>scaling</code></td>
<td>

<p><code>numeric</code> value that has been used to scale <code>x</code> (see
argument <code>scaling</code>). A value of 1 results from
<code>scaling="no"</code>, other values are the maximum value or the
standard deviation of <code>x</code>, depending on the choice of the
parameter <code>scaling</code>.
</p>
</td></tr>   
<tr><td><code>call</code></td>
<td>

<p>the function call
</p>
</td></tr>  
</table>
<p><code>transformSCI</code> returns a <code>numeric</code> vector
containing the SCI, having values of the standard normal
distribution. 
</p>


<h3>Note</h3>

<p>This function is intended to be used together with
<code><a href="#topic+transformSCI">transformSCI</a></code>. 
</p>


<h3>Author(s)</h3>

<p>Lukas Gudmundsson &amp; James Stagge
</p>


<h3>References</h3>

<p>Stagee, J.H. ; Tallaksen, L.M.; Gudmundsson, L.; van Loon, A.;
Stahl, K.: Candidate Distributions for Climatological Drought Indices  (SPI and SPEI),
2015, International Journal of Climatology, 35, 4027-4040, doi:10.1002/joc.4267.
</p>
<p>Stagee, J.H. ; Tallaksen, L.M.; Gudmundsson, L.; van Loon, A.;
Stahl, K.: Response to comment on &quot;Candidate Distributions for Climatological
Drought Indices (SPI and SPEI)&quot;, 2016, International Journal of
Climatology, 36, 2132-2138, doi:10.1002/joc.4564.
</p>
<p>McKee, T.; Doesken, N. &amp; Kleist, J.: The relationship of drought
frequency and duration to time scales Preprints, 8th Conference on
Applied Climatology, 1993, 179-184.
</p>
<p>Shukla, S. &amp; Wood, A. W.: Use of a standardized runoff index for
characterizing hydrologic drought Geophysical Research Letters, 2008,
35, L02405.
</p>
<p>Vicente-Serrano, S. M.; Begueria, S. &amp; Lopez-Moreno, J. I.: A Multiscalar
Drought Index Sensitive to Global Warming: The Standardized
Precipitation Evapotranspiration Index J. Climate, Journal of Climate,
American Meteorological Society, 2009, 23, 1696-1718.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dist.start">dist.start</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## generate artificial data
##
set.seed(101)
n.years &lt;- 60
date &lt;- rep(1:n.years,each=12) + 1950 + rep((0:11)/12,times=n.years)
## Precipitation
PRECIP &lt;- (0.25*sin( 2 * pi * date) + 0.3)*rgamma(n.years*12, shape = 3, scale = 1)
PRECIP[PRECIP&lt;0.1] &lt;- 0
## Potential Evapotranspiration
PET &lt;- 0.5*sin( 2 * pi * date)+1.2+rnorm(n.years*12,0,0.2)
## display test data
matplot(date,cbind(PRECIP,PET),t=c("h","l"),col=c("blue","red"),lty=1)
legend("topright",legend=c("PRECIPitation","temperature"),fill=c("blue","red"))

##
## example SPI
##
spi.para &lt;- fitSCI(PRECIP,first.mon=1,distr="gamma",time.scale=6,p0=TRUE)
spi.para
spi &lt;- transformSCI(PRECIP,first.mon=1,obj=spi.para)
plot(date,spi,t="l")

##
## effect of time.scale on SPI
##
spi.1.para &lt;- fitSCI(PRECIP,first.mon=1,time.scale=1,distr="gamma",p0=TRUE)
spi.12.para &lt;- fitSCI(PRECIP,first.mon=1,time.scale=12,distr="gamma",p0=TRUE)
spi.1 &lt;- transformSCI(PRECIP,first.mon=1,obj=spi.1.para)
spi.12 &lt;- transformSCI(PRECIP,first.mon=1,obj=spi.12.para)
matplot(date,cbind(spi.1,spi.12),t="l",lty=1,col=c("red","blue"),lwd=c(1,2))
legend("topright",legend=c("time.scale=1","time.scale=12"),fill=c("red","blue"))

##
## example SPEI
##
if(require(evd)){
    spei.para &lt;- fitSCI(PRECIP-PET,first.mon=1,time.scale=6,distr="gev",p0=FALSE)
    spei &lt;- transformSCI(PRECIP-PET,first.mon=1,obj=spei.para)
    plot(date,spei,t="l")
}

##
## effect of changing different distribution for SPEI computation
##
spei.genlog.para &lt;- fitSCI(PRECIP-PET,first.mon=1,time.scale=6,distr="genlog",p0=FALSE)
spei.genlog &lt;- transformSCI(PRECIP-PET,first.mon=1,obj=spei.genlog.para)
if(require(evd)){lines(date,spei.genlog, col="red")} else {plot(date,spei.genlog,t="l")}
## in this case: only limited effect.
## generally: optimal choice of distribution: user responsibility.

##
## use a 30 year reference period for SPI parameter estimation
##
sel.date &lt;- date&gt;=1970 &amp; date&lt;2000
spi.ref.para &lt;- fitSCI(PRECIP[sel.date],first.mon=1,distr="gamma",time.scale=6,p0=TRUE)
## apply the the parameters of the reference period to all data
## also outside the reference period
spi.ref &lt;- transformSCI(PRECIP,first.mon=1,obj=spi.ref.para)
plot(date,spi.ref,t="l",col="blue",ylim=c(-5,5),lwd=2)
lines(date[sel.date],spi.ref[sel.date],col="red",lwd=3)
legend("bottom",legend=c("reference period","extrapolation period"),fill=c("red","blue"),
       horiz=TRUE)

##
## use "start.fun.fix" in instances where maximum likelyhood estimation fails
##
## force failure of maximum likelyhood estimation by adding "strange" value
## a warning should be issued
xx &lt;- PRECIP-PET; xx[300] &lt;- 1000
spei.para &lt;- fitSCI(xx,first.mon=2,time.scale=1,p0=FALSE,distr="gev")
spei.para$dist.para
## use start.fun, usually ment for estimating inital values for
## parameter optimisation if maximum likelihood estimation fails
spei.para &lt;- fitSCI(xx,first.mon=2,time.scale=1,p0=FALSE,distr="gev",
                    start.fun.fix=TRUE)
spei.para$dist.para

##
## usage of sci.limit to truncate unrealistic SCI values
## 
PRECIP.mod &lt;- PRECIP
PRECIP.mod[300] &lt;- 100 ## introduce spuriously large value
spi.mod.para &lt;- fitSCI(PRECIP.mod,first.mon=1,time.scale=3,p0=TRUE,distr="gamma")
plot(transformSCI(PRECIP.mod,first.mon=1,obj=spi.mod.para,sci.limit=Inf),
     t="l",col="blue",lwd=2)
lines(transformSCI(PRECIP.mod,first.mon=1,obj=spi.mod.para,sci.limit=4),col="red")

##
## how to modify settings of function "mledist" used for parameter identification
## 
## identify parameters with standard settings
spi.para &lt;- fitSCI(PRECIP,first.mon=1,distr="gamma",time.scale=6,p0=TRUE)
## add lower and upper limits for parameter identification
lower.lim &lt;- apply(spi.para$dist.para,1,min) - 0.5*apply(spi.para$dist.para,1,sd)
upper.lim &lt;- apply(spi.para$dist.para,1,max) + 0.5*apply(spi.para$dist.para,1,sd)
spi.para.limit &lt;- fitSCI(PRECIP,first.mon=1,distr="gamma",time.scale=6,p0=TRUE,
                         mledist.par=list(lower=lower.lim, upper=upper.lim))

##
## how to write an own start.fun
## (required if distributions not mentioned in "dist.start" are used)
##
## function with same arguments as "dist.start" 
my.start &lt;- function(x,distr="gamma"){
### code based on "mmedist" in package "fitdistrplus"
    ppar &lt;- try({
        n &lt;- length(x)
        m &lt;- mean(x)
        v &lt;- (n - 1)/n * var(x)
        shape &lt;- m^2/v
        rate &lt;- m/v
        list(shape = shape, rate = rate)},TRUE)
    if (class(ppar) == "try-error") ## function has to be able to return NA parameters
        ppar &lt;- list(shape = NA, rate = NA)
    return(ppar)
}
my.start(PRECIP)
spi.para &lt;- fitSCI(PRECIP,first.mon=1,time.scale=6,p0=TRUE,
                   distr="gamma",start.fun=my.start)
</code></pre>

<hr>
<h2 id='genlog'>
Generalized Logistic Distribution
</h2><span id='topic+genlog'></span><span id='topic+dgenlog'></span><span id='topic+pgenlog'></span><span id='topic+qgenlog'></span>

<h3>Description</h3>

<p>Density, distribution and quantile function of the generalized
logistic distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pgenlog(q, shape, scale, location)
dgenlog(x, shape, scale, location)
qgenlog(p, shape, scale, location)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genlog_+3A_x">x</code>, <code id="genlog_+3A_q">q</code></td>
<td>

<p>vector of quantiles.
</p>
</td></tr>
<tr><td><code id="genlog_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="genlog_+3A_shape">shape</code></td>
<td>

<p>shape parameter
</p>
</td></tr>
<tr><td><code id="genlog_+3A_scale">scale</code></td>
<td>

<p>scale parameter
</p>
</td></tr>
<tr><td><code id="genlog_+3A_location">location</code></td>
<td>

<p>location parameter
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions of the <code>genlog</code> family are a reimplementation of
the Generalized Logistic Distribution in the <span class="pkg">lmomco</span>
package, making the code compatible with the standard nomenclature for
distribution in <span class="rlang"><b>R</b></span>. The original functions in <span class="pkg">lmomco</span> are 
<code><a href="lmomco.html#topic+pdfglo">pdfglo</a></code> (density function), <code><a href="lmomco.html#topic+quaglo">quaglo</a></code>
(quantile function) and <code><a href="lmomco.html#topic+cdfglo">cdfglo</a></code> (distribution function).  
</p>


<h3>Value</h3>

<p><code>dgenlog</code> gives the density (pdf), <code>pgenlog</code> gives
the distribution function (cdf), and <code>qgenlog</code> gives the
quantile function (inverse cdf).
</p>


<h3>Author(s)</h3>

<p>James Stagge &amp; Lukas Gudmundsson
</p>


<h3>References</h3>

<p>Asquith, W.H., 2013: lmomco &ndash; L-moments, trimmed L-moments,                                                                      
L-comoments, censored L-moments, and many distributions. R package                                                               
version 1.7.8 , Tech University, Lubbock, Texas.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dgenlog(1, shape=1, scale=2, location=3)
</code></pre>

<hr>
<h2 id='pe3'>
Pearson Type III distribution
</h2><span id='topic+pe3'></span><span id='topic+dpe3'></span><span id='topic+ppe3'></span><span id='topic+qpe3'></span>

<h3>Description</h3>

<p>Density, distribution and quantile function of the Pearson Type III
distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpe3(x, shape, scale, location)
ppe3(q, shape, scale, location)
qpe3(p, shape, scale, location)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pe3_+3A_x">x</code>, <code id="pe3_+3A_q">q</code></td>
<td>

<p>vector of quantiles.
</p>
</td></tr>
<tr><td><code id="pe3_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="pe3_+3A_shape">shape</code></td>
<td>

<p>shape parameter
</p>
</td></tr>
<tr><td><code id="pe3_+3A_scale">scale</code></td>
<td>

<p>scale parameter
</p>
</td></tr>
<tr><td><code id="pe3_+3A_location">location</code></td>
<td>

<p>location parameter
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions of the <code>pe3</code> family are a reimplementation of
the Pearson Type III Distribution in the <span class="pkg">lmomco</span>
package, making the code compatible with the standard nomenclature for
distributions in <span class="rlang"><b>R</b></span>. The original functions in <span class="pkg">lmomco</span> are 
<code><a href="lmomco.html#topic+pdfpe3">pdfpe3</a></code> (density function), <code><a href="lmomco.html#topic+quape3">quape3</a></code>
(quantile function) and <code><a href="lmomco.html#topic+cdfpe3">cdfpe3</a></code> (distribution function).  
</p>


<h3>Value</h3>

<p><code>dpe3</code> gives the density (pdf), <code>ppe3</code> gives
the distribution function (cdf), and <code>qpe3</code> gives the
quantile function (inverse cdf).
</p>


<h3>Author(s)</h3>

<p>James Stagge &amp; Lukas Gudmundsson
</p>


<h3>References</h3>

<p>Asquith, W.H., 2013: lmomco &ndash; L-moments, trimmed L-moments,                                                                      
L-comoments, censored L-moments, and many distributions. R package                                                               
version 1.7.8 , Tech University, Lubbock, Texas.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dpe3(1, shape=1, scale=2, location=3)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
