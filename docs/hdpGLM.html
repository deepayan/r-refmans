<!DOCTYPE html><html><head><title>Help for package hdpGLM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {hdpGLM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#classify'><p>Classify data points</p></a></li>
<li><a href='#coef.dpGLM'><p>Extract dpGLM fitted coefficients</p></a></li>
<li><a href='#coef.hdpGLM'><p>Extract hdpGLM fitted coefficients</p></a></li>
<li><a href='#hdpGLM'><p>Fit Hierarchical Dirichlet Process GLM</p></a></li>
<li><a href='#hdpGLM_classify'><p>Deprecated</p></a></li>
<li><a href='#hdpGLM_package'><p>hdpGLM: A package for computating Hierarchical Dirichlet Process Generalized</p>
Linear Models</a></li>
<li><a href='#hdpGLM_simParameters'><p>Simulate the parameters of the model</p></a></li>
<li><a href='#hdpGLM_simulateData'><p>Simulate a Data Set from hdpGLM</p></a></li>
<li><a href='#mcmc_info.dpGLM'><p>mcmc</p></a></li>
<li><a href='#mcmc_info.hdpGLM'><p>mcmc</p></a></li>
<li><a href='#nclusters'><p>nclusters</p></a></li>
<li><a href='#plot_beta'><p>Plot beta posterior distribution</p></a></li>
<li><a href='#plot_beta_sim'><p>Plot simulated data</p></a></li>
<li><a href='#plot_hdpglm'><p>Plot posterior distributions</p></a></li>
<li><a href='#plot_pexp_beta'><p>Plot beta posterior expectation</p></a></li>
<li><a href='#plot_tau'><p>Plot tau</p></a></li>
<li><a href='#plot.dpGLM'><p>Default plot for class dpGLM</p></a></li>
<li><a href='#plot.hdpGLM'><p>Plot</p></a></li>
<li><a href='#predict.dpGLM'><p>dpGLM Predicted values</p></a></li>
<li><a href='#predict.hdpGLM'><p>hdpGLM Predicted values</p></a></li>
<li><a href='#print.dpGLM'><p>Print</p></a></li>
<li><a href='#print.dpGLM_data'><p>Print</p></a></li>
<li><a href='#print.hdpGLM'><p>Print</p></a></li>
<li><a href='#print.hdpGLM_data'><p>Print</p></a></li>
<li><a href='#summary_tidy'><p>Tidy summary</p></a></li>
<li><a href='#summary.dpGLM'><p>Summary for dpGLM class</p></a></li>
<li><a href='#summary.dpGLM_data'><p>Summary dpGLM data</p></a></li>
<li><a href='#summary.hdpGLM'><p>Summary for hdpGLM class</p></a></li>
<li><a href='#summary.hdpGLM_data'><p>Summary</p></a></li>
<li><a href='#welfare'><p>Fake data set with 2000 observations</p></a></li>
<li><a href='#welfare2'><p>Fake data set with 2000 observations</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Hierarchical Dirichlet Process Generalized Linear Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of MCMC algorithms to estimate the Hierarchical Dirichlet Process Generalized Linear Model (hdpGLM) presented in the paper Ferrari (2020) Modeling Context-Dependent Latent Heterogeneity, Political Analysis &lt;<a href="https://doi.org/10.1017%2Fpan.2019.13">doi:10.1017/pan.2019.13</a>&gt; and &lt;<a href="https://doi.org/10.18637%2Fjss.v107.i10">doi:10.18637/jss.v107.i10</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.3)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/DiogoFerrari/hdpGLM">https://github.com/DiogoFerrari/hdpGLM</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/DiogoFerrari/hdpGLM/issues">https://github.com/DiogoFerrari/hdpGLM/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Imports:</td>
<td>coda, data.table, dplyr, formula.tools, ggjoy, ggplot2,
stringr, ggridges, ggpubr, Hmisc, isotone, questionr,
LaplacesDemon, magrittr, methods, MASS, MCMCpack, mvtnorm,
Rcpp, rprojroot, png, purrr, tibble, tidyr, tidyverse</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-12 21:08:47 UTC; diogo</td>
</tr>
<tr>
<td>Author:</td>
<td>Diogo Ferrari [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Diogo Ferrari &lt;diogoferrari@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-12 22:20:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='classify'>Classify data points</h2><span id='topic+classify'></span>

<h3>Description</h3>

<p>This function returns a data frame with the data points classified according to the estimation of cluster probabilities generated by the output of the function <code><a href="#topic+hdpGLM">hdpGLM</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>classify(data, samples)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="classify_+3A_data">data</code></td>
<td>
<p>a data frame with the data set used to estimate the <code><a href="#topic+hdpGLM">hdpGLM</a></code> model</p>
</td></tr>
<tr><td><code id="classify_+3A_samples">samples</code></td>
<td>
<p>the output of <code><a href="#topic+hdpGLM">hdpGLM</a></code></p>
</td></tr>
</table>

<hr>
<h2 id='coef.dpGLM'>Extract dpGLM fitted coefficients</h2><span id='topic+coef.dpGLM'></span>

<h3>Description</h3>

<p>This function gives the posterior mean of the coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dpGLM'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.dpGLM_+3A_object">object</code></td>
<td>
<p>a <code>dpGLM</code> object returned by the function <code>hdpGLM</code></p>
</td></tr>
<tr><td><code id="coef.dpGLM_+3A_...">...</code></td>
<td>
<p>The additional parameters accepted are:</p>
</td></tr>
</table>

<hr>
<h2 id='coef.hdpGLM'>Extract hdpGLM fitted coefficients</h2><span id='topic+coef.hdpGLM'></span>

<h3>Description</h3>

<p>This function gives the posterior mean of the coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hdpGLM'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.hdpGLM_+3A_object">object</code></td>
<td>
<p>a <code>dpGLM</code> object returned by the function <code>hdpGLM</code></p>
</td></tr>
<tr><td><code id="coef.hdpGLM_+3A_...">...</code></td>
<td>
<p>The additional parameters accepted are:</p>
</td></tr>
</table>

<hr>
<h2 id='hdpGLM'>Fit Hierarchical Dirichlet Process GLM</h2><span id='topic+hdpGLM'></span>

<h3>Description</h3>

<p>The function estimates a semi-parametric mixture of Generalized
Linear Models. It uses a (hierarchical) Dependent Dirichlet Process
Prior for the mixture probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hdpGLM(
  formula1,
  formula2 = NULL,
  data,
  mcmc,
  family = "gaussian",
  K = 100,
  context.id = NULL,
  constants = NULL,
  weights = NULL,
  n.display = 1000,
  na.action = "exclude",
  imp.bin = "R"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hdpGLM_+3A_formula1">formula1</code></td>
<td>
<p>a single symbolic description of the linear model of the
mixture GLM components to be fitted. The syntax is the same
as used in the <code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="hdpGLM_+3A_formula2">formula2</code></td>
<td>
<p>eihter NULL (default) or a single symbolic description of the
linear model of the hierarchical component of the model.
It specifies how the average parameter of the base measure
of the Dirichlet Process Prior varies linearly as a function
of group level covariates. If <code>NULL</code>, it will use
a single base measure to the DPP mixture model.</p>
</td></tr>
<tr><td><code id="hdpGLM_+3A_data">data</code></td>
<td>
<p>a data.frame with all the variables specified in <code>formula1</code> and <code>formula2</code>. Note: it is advisable to scale the variables before the estimation</p>
</td></tr>
<tr><td><code id="hdpGLM_+3A_mcmc">mcmc</code></td>
<td>
<p>a named list with the following elements
</p>
<p>- <code>burn.in</code> (required): an integer greater or equal to 0
indicating the number iterations used in the
burn-in period of the MCMC.
</p>
<p>- <code>n.iter</code>  (required): an integer greater or equal to 1
indicating the number of iterations to record
after the burn-in period for the MCMC.
</p>
<p>- <code>epsilon</code> (optional): a positive number. Default is 0.01.
Used when <code>family='binomial'</code> or
<code>family='multinomial'</code>. It is used in the
Stormer-Verlet Integrator (a.k.a leapfrog
integrator) to solve the Hamiltonian Monte
Carlo in the estimation of the model.
</p>
<p>- <code>leapFrog</code> (optional) an integer. Default is 40. Used when
<code>family='binomial'</code> or <code>family='multinomial'</code>.
It indicates the number of steps taken at each
iteration of the Hamiltonian Monte Carlo for
the Stormer-Verlet Integrator.
</p>
<p>- <code>hmc_iter</code> (optional) an integer. Default is 1. Used when 
<code>family='binomial'</code> or <code>family='multinomial'</code>.
It indicates the number of HMC iteration(s)
for each Gibbs iteration.</p>
</td></tr>
<tr><td><code id="hdpGLM_+3A_family">family</code></td>
<td>
<p>a character with either 'gaussian', 'binomial', or 'multinomial'.
It indicates the family of the GLM components of the mixture model.</p>
</td></tr>
<tr><td><code id="hdpGLM_+3A_k">K</code></td>
<td>
<p>an integer indicating the maximum number of clusters to truncate the
Dirichlet Process Prior in order to use the blocked Gibbs sampler.</p>
</td></tr>
<tr><td><code id="hdpGLM_+3A_context.id">context.id</code></td>
<td>
<p>string with the name of the column in the data that uniquely identifies the contexts. If <code>NULL</code> (default) contexts will be identified by numerical indexes and unique context-level variables. The user is advised to pre-process the data to provide meaningful labels for the contexts to facilitate later visualization and analysis of the results.</p>
</td></tr>
<tr><td><code id="hdpGLM_+3A_constants">constants</code></td>
<td>
<p>either NULL or a list with the constants of the model. If not NULL,
it must contain a vector named <code>mu_beta</code>, whose size must be
equal to the number of covariates specified in <code>formula1</code>
plus one for the constant term; <code>Sigma_beta</code>, which must be a squared
matrix, and each dimension must be equal to the size of the vector <code>mu_beta</code>; 
and <code>alpha</code>, which must be a single number. If @param family is 'gaussian',
then it must also contain <code>s2_sigma</code> and <code>df_sigma</code>, both
single numbers. If NULL, the defaults are <code>mu_beta=0</code>,
<code>Sigma_beta=diag(10)</code>, <code>alpha=1</code>, <code>df_sigma=10</code>,
<code>s2_sigma=10</code> (all with the dimension automatically set to the
correct values).</p>
</td></tr>
<tr><td><code id="hdpGLM_+3A_weights">weights</code></td>
<td>
<p>numeric vector with the same size as the number of rows of the data. It must contain the weights of the observations in the data set. NOTE: FEATURE NOT IMPLEMENTED YET</p>
</td></tr>
<tr><td><code id="hdpGLM_+3A_n.display">n.display</code></td>
<td>
<p>an integer indicating the number of iterations to wait before printing information
about the estimation process. If zero, it does not display any information.
Note: displaying informaiton at every iteration (n.display=1) may increase
the time to estimate the model slightly.</p>
</td></tr>
<tr><td><code id="hdpGLM_+3A_na.action">na.action</code></td>
<td>
<p>string with action to be taken for the <code>NA</code> values. (currently, only <code>exclude</code> is available)</p>
</td></tr>
<tr><td><code id="hdpGLM_+3A_imp.bin">imp.bin</code></td>
<td>
<p>string, either &quot;R&quot; or &quot;Cpp&quot; indicating the language of the implementation of the binomial model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates a Hierarchical Dirichlet Process generalized
linear model, which is a semi-parametric Bayesian approach to regression
estimation with clustering. The estimation is conducted using Blocked Gibbs Sampler if the output
variable is gaussian distributed. It uses Metropolis-Hastings inside Gibbs if
the output variable is binomial or multinomial distributed.
This is specified using the parameter <code>family</code>. See:
</p>
<p>Ferrari, D. (2020). Modeling Context-Dependent Latent Effect Heterogeneity,
Political Analysis, 28(1), 20–46. doi:10.1017/pan.2019.13.
</p>
<p>Ferrari, D. (2023). &quot;hdpGLM: An R Package to Estimate Heterogeneous Effects
in Generalized Linear Models Using Hierarchical Dirichlet Process.&quot;
Journal of Statistical Software, 107(10), 1-37. doi:10.18637/jss.v107.i10.
</p>
<p>Ishwaran, H., &amp; James, L. F., Gibbs sampling methods for stick-breaking priors,
Journal of the American Statistical Association, 96(453), 161–173 (2001). 
</p>
<p>Neal, R. M., Markov chain sampling methods for dirichlet process mixture models,
Journal of computational and graphical statistics, 9(2), 249–265 (2000).
</p>


<h3>Value</h3>

<p>The function returns a list with elements <code>samples</code>, <code>pik</code>, <code>max_active</code>,
<code>n.iter</code>, <code>burn.in</code>, and <code>time.elapsed</code>. The <code>samples</code> element
contains a MCMC object (from <span class="pkg">coda</span> package) with the samples from the posterior
distribution. The <code>pik</code> is a <code>n x K</code> matrix with the estimated
probabilities that the observation $i$ belongs to the cluster $k$
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Note: this example is for illustration. You can run the example
## manually with increased number of iterations to see the actual
## results, as well as the data size (n)

set.seed(10)
n = 300
data = tibble::tibble(x1 = rnorm(n, -3),
                      x2 = rnorm(n,  3),
                      z  = sample(1:3, n, replace=TRUE),
                      y  =I(z==1) * (3 + 4*x1 - x2 + rnorm(n)) +
                          I(z==2) * (3 + 2*x1 + x2 + rnorm(n)) +
                          I(z==3) * (3 - 4*x1 - x2 + rnorm(n)) 
                      ) 


mcmc    = list(burn.in = 0,  n.iter = 20)
samples = hdpGLM(y~ x1 + x2, data=data, mcmc=mcmc, family='gaussian',
                 n.display=30, K=50)

summary(samples)
plot(samples)
plot(samples, separate=TRUE)

## compare with GLM
## lm(y~ x1 + x2, data=data,  family='gaussian')

 
</code></pre>

<hr>
<h2 id='hdpGLM_classify'>Deprecated</h2><span id='topic+hdpGLM_classify'></span>

<h3>Description</h3>

<p>Deprecated
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hdpGLM_classify(data, samples)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hdpGLM_classify_+3A_data">data</code></td>
<td>
<p>a data frame with the data set used to estimate the <code><a href="#topic+hdpGLM">hdpGLM</a></code> model</p>
</td></tr>
<tr><td><code id="hdpGLM_classify_+3A_samples">samples</code></td>
<td>
<p>the output of <code><a href="#topic+hdpGLM">hdpGLM</a></code></p>
</td></tr>
</table>

<hr>
<h2 id='hdpGLM_package'>hdpGLM: A package for computating Hierarchical Dirichlet Process Generalized
Linear Models</h2><span id='topic+hdpGLM_package'></span>

<h3>Description</h3>

<p>Further information is available at:
http://www.diogoferrari.com/hdpGLM/index.html
</p>
<p>References:
</p>
<p>- Ferrari, D. (2020). Modeling Context-Dependent Latent Effect Heterogeneity.
Political Analysis, 28(1), 20–46.
</p>
<p>- Mukhopadhyay, S., &amp; Gelfand, A. E. (1997). Dirichlet Process Mixed Generali-
zed Linear Models. Journal of the American Statistical Association, 92(438),
633–639.
</p>
<p>- Hannah, L. A., Blei, D. M., &amp; Powell, W. B. (2011). Dirichlet Process Mix-
tures of Generalized Linear Models. Journal of Machine Learning Research,
12(Jun), 1923–1953.
</p>
<p>- Heckman, J. J., &amp; Vytlacil, E. J. (2007). Econometric Evaluation of Social
Programs, Part I: Causal Models, Structural Models and Econometric Policy
Evaluation. Handbook of Econometrics, 6(), 4779–4874.
</p>


<h3>Details</h3>

<p>The package implements a hierarchical Dirichlet process Generalized Linear
Model as proposed in Ferrari (2020) Modeling Context-Dependent Latent Effect
Heterogeneity, which expands the non-parametric Bayesian models proposed in
Mukhopadhyay and Gelfand (1997), Hannah (2011), and Heckman and
Vytlacil (2007) to deal with context-dependent cases. The package can be used
to estimate latent heterogeneity in the marginal effect of GLM linear coeffi-
cients, to cluster data points based on that latent heterogeneity, and to
investigate the occurrence of Simpson’s Paradox due to latent or omitted fea-
tures.
</p>

<hr>
<h2 id='hdpGLM_simParameters'>Simulate the parameters of the model</h2><span id='topic+hdpGLM_simParameters'></span>

<h3>Description</h3>

<p>This function generates parameters that can be used to simulate data sets from the Hierarchical Dirichlet Process of Generalized Linear Model (hdpGLM) or dpGLM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hdpGLM_simParameters(
  K,
  nCov = 2,
  nCovj = 0,
  J = 1,
  pi = NULL,
  same.K = FALSE,
  seed = NULL,
  context.effect = NULL,
  same.clusters.across.contexts = NULL,
  context.dependent.cluster = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hdpGLM_simParameters_+3A_k">K</code></td>
<td>
<p>integer, the number of clusters. If there are multiple contexts, K is the average number of clusters across contexts, and each context gets a number of clusters sampled from a Poisson distribution, except if <code>same.K</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="hdpGLM_simParameters_+3A_ncov">nCov</code></td>
<td>
<p>integer, the number of covariates of the
GLM components</p>
</td></tr>
<tr><td><code id="hdpGLM_simParameters_+3A_ncovj">nCovj</code></td>
<td>
<p>an integer indicating the number of covariates determining the average parameter of the base measure of the Dirichlet process prior</p>
</td></tr>
<tr><td><code id="hdpGLM_simParameters_+3A_j">J</code></td>
<td>
<p>an integer representing the number of contexts  @param parameters either NULL or a list with the parameters  to generate the model. If not NULL, it must  contain a sublist name beta, a vector named tau,  and a vector named pi. The sublist beta must be  a list of vectors, each one with size nCov+1  to be the coefficients of the GLM mixtures  components that will generate the data.  For the vector tau, if nCovj=0 (single-context case)  then it must be a 1x1 matrix containing 1.  If ncovj&gt;0, it must be a (nCov+1)x(nCovj+1) matrix.  The vector pi must add up to 1 and have length K.</p>
</td></tr>
<tr><td><code id="hdpGLM_simParameters_+3A_pi">pi</code></td>
<td>
<p>either NULL or a vector with length K that add up to 1. If not NULL, it determines the mixture probabilities</p>
</td></tr>
<tr><td><code id="hdpGLM_simParameters_+3A_same.k">same.K</code></td>
<td>
<p>boolean, used when data is sampled from more than one context. If <code>TRUE</code> all contexts get the same number of clusters. If <code>FALSE</code>, each context gets a number of clusters sampled from a Poisson distribution with expectation equals to <code>K</code> (current not implemented)</p>
</td></tr>
<tr><td><code id="hdpGLM_simParameters_+3A_seed">seed</code></td>
<td>
<p>a seed for <code>set.seed</code></p>
</td></tr>
<tr><td><code id="hdpGLM_simParameters_+3A_context.effect">context.effect</code></td>
<td>
<p>either <code>NULL</code> or a two dimensional integer vector. If it is <code>NULL</code>, all the coefficients (<code>beta</code>) of the individual level covariates are functions of context-level features (<code>tau</code>). If it is not <code>NULL</code>, the first component of the vector indicates the index of the lower level covariate (<code>X</code>) whose linear effect <code>beta</code> depends on context (<code>tau</code>) (0 is the intercept). The second component indicates the index context-level covariate (<code>W</code>) whose linear coefficient (<code>tau</code>) is non-zero.</p>
</td></tr>
<tr><td><code id="hdpGLM_simParameters_+3A_same.clusters.across.contexts">same.clusters.across.contexts</code></td>
<td>
<p>boolean, if <code>TRUE</code> all the contexts will have the same number of clusters AND each cluster will have the same coefficient <code>beta</code>.</p>
</td></tr>
<tr><td><code id="hdpGLM_simParameters_+3A_context.dependent.cluster">context.dependent.cluster</code></td>
<td>
<p>integer, indicates which cluster will be context-dependent. If <code>zero</code>, all clusters will be context-dependent</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the parameters used to generate data sets from the hdpGLM model. This list can be used in the function <code>hdpGLM_simulateData</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pars = hdpGLM_simParameters(nCov=2, K=2, nCovj=3, J=20,
          same.clusters.across.contexts=FALSE, context.dependent.cluster=0) 

</code></pre>

<hr>
<h2 id='hdpGLM_simulateData'>Simulate a Data Set from hdpGLM</h2><span id='topic+hdpGLM_simulateData'></span>

<h3>Description</h3>

<p>Simulate a Data Set from hdpGLM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hdpGLM_simulateData(
  n,
  K,
  nCov = 2,
  nCovj = 0,
  J = 1,
  family = "gaussian",
  parameters = NULL,
  pi = NULL,
  same.K = FALSE,
  seed = NULL,
  context.effect = NULL,
  same.clusters.across.contexts = NULL,
  context.dependent.cluster = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hdpGLM_simulateData_+3A_n">n</code></td>
<td>
<p>integer, the sample size of the data. If there are multiple contexts, each context will have n cases.</p>
</td></tr>
<tr><td><code id="hdpGLM_simulateData_+3A_k">K</code></td>
<td>
<p>integer, the number of clusters. If there are multiple contexts, K is the average number of clusters across contexts, and each context gets a number of clusters sampled from a Poisson distribution, except if <code>same.K</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="hdpGLM_simulateData_+3A_ncov">nCov</code></td>
<td>
<p>integer, the number of covariates of the GLM components.</p>
</td></tr>
<tr><td><code id="hdpGLM_simulateData_+3A_ncovj">nCovj</code></td>
<td>
<p>an integer indicating the number of covariates determining the average parameter of the base measure of the Dirichlet process prior</p>
</td></tr>
<tr><td><code id="hdpGLM_simulateData_+3A_j">J</code></td>
<td>
<p>an integer representing the number of contexts  @param parameters either NULL or a list with the parameters  to generate the model. If not NULL, it must  contain a sublist name beta, a vector named tau,  and a vector named pi. The sublist beta must be  a list of vectors, each one with size nCov+1  to be the coefficients of the GLM mixtures  components that will generate the data.  For the vector tau, if nCovj=0 (single-context case)  then it must be a 1x1 matrix containing 1.  If nCovj&gt;0, it must be a (nCov+1)x(nCovj+1) matrix.  The vector pi must add up to 1 and have length K.</p>
</td></tr>
<tr><td><code id="hdpGLM_simulateData_+3A_family">family</code></td>
<td>
<p>a character with either 'gaussian', 'binomial', or 'multinomial'. It indicates the family of the GLM components of the mixture model.</p>
</td></tr>
<tr><td><code id="hdpGLM_simulateData_+3A_parameters">parameters</code></td>
<td>
<p>a list with the parameter values of the model. Format should be the same of the output of the function hdpGLM_simulateParameters()</p>
</td></tr>
<tr><td><code id="hdpGLM_simulateData_+3A_pi">pi</code></td>
<td>
<p>either NULL or a vector with length K that add up to 1. If not NULL, it determines the mixture probabilities</p>
</td></tr>
<tr><td><code id="hdpGLM_simulateData_+3A_same.k">same.K</code></td>
<td>
<p>boolean, used when data is sampled from more than one context. If <code>TRUE</code> all contexts get the same number of clusters. If <code>FALSE</code>, each context gets a number of clusters sampled from a Poisson distribution with expectation equals to <code>K</code> (current not implemented)</p>
</td></tr>
<tr><td><code id="hdpGLM_simulateData_+3A_seed">seed</code></td>
<td>
<p>a seed for <code>set.seed</code></p>
</td></tr>
<tr><td><code id="hdpGLM_simulateData_+3A_context.effect">context.effect</code></td>
<td>
<p>either <code>NULL</code> or a two dimensional integer vector. If it is <code>NULL</code>, all the coefficients (<code>beta</code>) of the individual level covariates are functions of context-level features (<code>tau</code>). If it is not <code>NULL</code>, the first component of the vector indicates the index of the lower level covariate (<code>X</code>) whose linear effect <code>beta</code> depends on context (<code>tau</code>) (0 is the intercept). The second component indicates the index context-level covariate (<code>W</code>) whose linear coefficient (<code>tau</code>) is non-zero.</p>
</td></tr>
<tr><td><code id="hdpGLM_simulateData_+3A_same.clusters.across.contexts">same.clusters.across.contexts</code></td>
<td>
<p>boolean, if <code>TRUE</code> all the contexts will have the same number of clusters AND each cluster will have the same coefficient <code>beta</code>.</p>
</td></tr>
<tr><td><code id="hdpGLM_simulateData_+3A_context.dependent.cluster">context.dependent.cluster</code></td>
<td>
<p>integer, indicates which cluster will be context-dependent. If <code>zero</code>, all clusters will be context-dependent</p>
</td></tr>
</table>

<hr>
<h2 id='mcmc_info.dpGLM'>mcmc</h2><span id='topic+mcmc_info.dpGLM'></span>

<h3>Description</h3>

<p>Generic method to return the MCMC information
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcmc_info.dpGLM(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcmc_info.dpGLM_+3A_x">x</code></td>
<td>
<p>a <code>dpGLM</code> object returned by the function
<code>hdpGLM</code></p>
</td></tr>
<tr><td><code id="mcmc_info.dpGLM_+3A_...">...</code></td>
<td>
<p>ignore</p>
</td></tr>
</table>

<hr>
<h2 id='mcmc_info.hdpGLM'>mcmc</h2><span id='topic+mcmc_info.hdpGLM'></span>

<h3>Description</h3>

<p>Generic method to return the MCMC information
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcmc_info.hdpGLM(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcmc_info.hdpGLM_+3A_x">x</code></td>
<td>
<p>a <code>hdpGLM</code> object returned by the function
<code>hdpGLM</code></p>
</td></tr>
<tr><td><code id="mcmc_info.hdpGLM_+3A_...">...</code></td>
<td>
<p>ignore</p>
</td></tr>
</table>

<hr>
<h2 id='nclusters'>nclusters</h2><span id='topic+nclusters'></span>

<h3>Description</h3>

<p>This function returns the number of clusters found in the estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nclusters(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nclusters_+3A_object">object</code></td>
<td>
<p>a <code>dpGLM</code> object returned by the function <code>hdpGLM</code></p>
</td></tr>
</table>

<hr>
<h2 id='plot_beta'>Plot beta posterior distribution</h2><span id='topic+plot_beta'></span>

<h3>Description</h3>

<p>Plot the posterior distribution of the linear parameters beta for each context
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_beta(
  samples,
  X = NULL,
  context.id = NULL,
  true.beta = NULL,
  title = NULL,
  subtitle = NULL,
  plot.mean = FALSE,
  plot.grid = FALSE,
  showKhat = FALSE,
  col = NULL,
  xlab.size = NULL,
  ylab.size = NULL,
  title.size = NULL,
  legend.size = NULL,
  xtick.distance = NULL,
  left.margin = 0,
  ytick.distance = NULL,
  col.border = "white"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_beta_+3A_samples">samples</code></td>
<td>
<p>an output of the function <code><a href="#topic+hdpGLM">hdpGLM</a></code></p>
</td></tr>
<tr><td><code id="plot_beta_+3A_x">X</code></td>
<td>
<p>a string vector with the name of the first-level covariates whose associated tau should be displayed</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_context.id">context.id</code></td>
<td>
<p>string with the name of the column containing the labels identifying the contexts. This variable should have been specified when the estimation was conducted using the function <code><a href="#topic+hdpGLM">hdpGLM</a></code>.</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_true.beta">true.beta</code></td>
<td>
<p>a <code>data.frame</code> with the true values of the linear coefficients <code>beta</code> if they are known. The <code>data.frame</code> must contain a column named <code>j</code> with the index of the context associated with that particular linear coefficient <code>beta</code>. It must match the indexes used in the data set for each context. Another column named <code>k</code> must be provided, indicating the cluster of <code>beta</code>, and a column named <code>Parameter</code> with the name of the linear coefficients (<code>beta1</code>, <code>beta2</code>, ..., <code>beta_dx</code>, where <code>dx</code> is the number of covariates at the individual level, and beta1 is the coefficient of the intercept term). It must contain a column named <code>True</code> with the true value of the <code>betas</code>. Finally, the <code>data.frame</code> must contain columns with the context-level covariates as used in the estimation of the <a href="#topic+hdpGLM">hdpGLM</a> function (see Details below).</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_title">title</code></td>
<td>
<p>string, title of the plot</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_subtitle">subtitle</code></td>
<td>
<p>string, the subtitle of the plot</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_plot.mean">plot.mean</code></td>
<td>
<p>boolean, if <code>TRUE</code> the posterior mean of every cluster is displayed</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_plot.grid">plot.grid</code></td>
<td>
<p>boolean, if <code>TRUE</code> a grid is displayed in the background</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_showkhat">showKhat</code></td>
<td>
<p>boolean, if <code>TRUE</code> a message with the number of estimated clusters by context is displayed</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_col">col</code></td>
<td>
<p>string, color of the densities</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_xlab.size">xlab.size</code></td>
<td>
<p>numeric, size of the breaks in the x-axis</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_ylab.size">ylab.size</code></td>
<td>
<p>numeric, size of the breaks in the y-axis</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_title.size">title.size</code></td>
<td>
<p>numeric, size of the title</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_legend.size">legend.size</code></td>
<td>
<p>numeric, size of the legend</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_xtick.distance">xtick.distance</code></td>
<td>
<p>numeric, distance between x-axis marks and bottom of the figure</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_left.margin">left.margin</code></td>
<td>
<p>numeric, distance between left margin and left side of the figure</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_ytick.distance">ytick.distance</code></td>
<td>
<p>numeric, distance between y-axis marks and bottom of the figure</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_col.border">col.border</code></td>
<td>
<p>string, color of the border of the densities</p>
</td></tr>
</table>

<hr>
<h2 id='plot_beta_sim'>Plot simulated data</h2><span id='topic+plot_beta_sim'></span>

<h3>Description</h3>

<p>Create a plot with the beta sampled from its distribution, as a function of context-level feature $W$. Only works for the hierarchical model (hdpGLM), not the dpGLM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_beta_sim(data, w.idx, ncol = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_beta_sim_+3A_data">data</code></td>
<td>
<p>the output of the function <code>hdpGLM_simulateData</code></p>
</td></tr>
<tr><td><code id="plot_beta_sim_+3A_w.idx">w.idx</code></td>
<td>
<p>integer, the index of the context level covariate the plot</p>
</td></tr>
<tr><td><code id="plot_beta_sim_+3A_ncol">ncol</code></td>
<td>
<p>integer, the number of columns in the grid of the plot</p>
</td></tr>
</table>

<hr>
<h2 id='plot_hdpglm'>Plot posterior distributions</h2><span id='topic+plot_hdpglm'></span>

<h3>Description</h3>

<p>this function creates a plot with two grids. One is the grid with posterior
expectation of betas as function of context-level covariates. The other is
the posterior distribution of tau
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_hdpglm(
  samples,
  X = NULL,
  W = NULL,
  ncol.taus = 1,
  ncol.betas = NULL,
  ncol.w = NULL,
  nrow.w = NULL,
  smooth.line = FALSE,
  pred.pexp.beta = FALSE,
  title.tau = NULL,
  true.tau = NULL,
  title.beta = NULL,
  tau.x.axis.size = 1.1,
  tau.y.axis.size = 1.1,
  tau.title.size = 1.2,
  tau.panel.title.size = 1.4,
  tau.legend.size = 1,
  beta.x.axis.size = 1.1,
  beta.y.axis.size = 1.1,
  beta.title.size = 1.2,
  beta.panel.title.size = 1.4,
  beta.legend.size = 1,
  tau.xlab = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_hdpglm_+3A_samples">samples</code></td>
<td>
<p>an output of the function <code><a href="#topic+hdpGLM">hdpGLM</a></code></p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_x">X</code></td>
<td>
<p>a string vector with the name of the first-level covariates whose associated tau should be displayed</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_w">W</code></td>
<td>
<p>a string vector with the name of the context-level covariate(s) whose linear effect will be displayed. If <code>NULL</code>, the linear effect tau of all context-level covariates are displayed. Note: the context-level covariate must have been included in the estimation of the model.</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_ncol.taus">ncol.taus</code></td>
<td>
<p>integer with the number of columns of the grid containing the posterior distribution of tau</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_ncol.betas">ncol.betas</code></td>
<td>
<p>integer with the number of columns of the posterior expectation of betas as function of context-level features</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_ncol.w">ncol.w</code></td>
<td>
<p>integer with the number of columns to use to display the different context-level covariates</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_nrow.w">nrow.w</code></td>
<td>
<p>integer with the number of rows to use to display the different context-level covariates</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_smooth.line">smooth.line</code></td>
<td>
<p>boolean, if <code>TRUE</code> the plot will display a regression line representing the regression of the posterior expectation of the linear coefficients betas on the context-level covariates. Default <code>FALSE</code></p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_pred.pexp.beta">pred.pexp.beta</code></td>
<td>
<p>boolean, if <code>TRUE</code> the plots will display a line with the predicted posterior expectation of betas obtained using the posterior expectation of taus, the linear coefficients of the expectation of beta</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_title.tau">title.tau</code></td>
<td>
<p>string, the title for the posterior distribution of the context effects</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_true.tau">true.tau</code></td>
<td>
<p>a <code>data.frame</code> with four columns. The first must be named <code>w</code> and it indicates the index of each context-level covariate, starting with 0 for the intercept term. The second column named <code>beta</code> must contain the indexes of the betas of individual-level covariates, starting with 0 for the intercept term. The third column named <code>Parameter</code> must be named <code>tau&lt;w&gt;&lt;beta&gt;</code>, where <code>w</code> and <code>beta</code> must be the actual values displayed in the columns <code>w</code> and <code>beta</code>. Finally, it must have a column named <code>True</code> with the true value of the parameter.</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_title.beta">title.beta</code></td>
<td>
<p>string, the title for the posterior expectation of beta as function of context-level covariate</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_tau.x.axis.size">tau.x.axis.size</code></td>
<td>
<p>numeric, relative size of the x-axis of the plot with tau</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_tau.y.axis.size">tau.y.axis.size</code></td>
<td>
<p>numeric, relative size of the y-axis of the plot with tau</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_tau.title.size">tau.title.size</code></td>
<td>
<p>numeric, relative size of the title of the plot with tau</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_tau.panel.title.size">tau.panel.title.size</code></td>
<td>
<p>numeric, relative size of the title of the panels of the plot with tau</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_tau.legend.size">tau.legend.size</code></td>
<td>
<p>numeric, relative size of the legend of the plot with tau</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_beta.x.axis.size">beta.x.axis.size</code></td>
<td>
<p>numeric, relative size of the x-axis of the plot with beta</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_beta.y.axis.size">beta.y.axis.size</code></td>
<td>
<p>numeric, relative size of the y-axis of the plot with beta</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_beta.title.size">beta.title.size</code></td>
<td>
<p>numeric, relative size of the title of the plot with beta</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_beta.panel.title.size">beta.panel.title.size</code></td>
<td>
<p>numeric, relative size of the title of the panels of the plot with beta</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_beta.legend.size">beta.legend.size</code></td>
<td>
<p>numeric, relative size of the legend of the plot with beta</p>
</td></tr>
<tr><td><code id="plot_hdpglm_+3A_tau.xlab">tau.xlab</code></td>
<td>
<p>string, the label of the x-axis for the plot with tau</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
library(magrittr)
# Note: this example is just for illustration. MCMC iterations are very reduced
set.seed(10)
n = 20
data.context1 = tibble::tibble(x1 = rnorm(n, -3),
                                   x2 = rnorm(n,  3),
                                   z  = sample(1:3, n, replace=TRUE),
                                   y  =I(z==1) * (3 + 4*x1 - x2 + rnorm(n)) +
                                       I(z==2) * (3 + 2*x1 + x2 + rnorm(n)) +
                                       I(z==3) * (3 - 4*x1 - x2 + rnorm(n)) ,
                                   w = 20
                                   ) 
data.context2 = tibble::tibble(x1 = rnorm(n, -3),
                                   x2 = rnorm(n,  3),
                                   z  = sample(1:2, n, replace=TRUE),
                                   y  =I(z==1) * (1 + 3*x1 - 2*x2 + rnorm(n)) +
                                       I(z==2) * (1 - 2*x1 +   x2 + rnorm(n)),
                                   w = 10
                                   ) 
data = data.context1 %&gt;%
    dplyr::bind_rows(data.context2)

## estimation
mcmc    = list(burn.in=1, n.iter=50)
samples = hdpGLM(y ~ x1 + x2, y ~ w, data=data, mcmc=mcmc, n.display=1)

plot_hdpglm(samples)
plot_hdpglm(samples, ncol.taus=2, ncol.betas=2, X='x1')
plot_hdpglm(samples, ncol.taus=2, ncol.betas=2, X='x1', ncol.w=2, nrow.w=1,
            pred.pexp.beta=TRUE,smooth.line=TRUE )


</code></pre>

<hr>
<h2 id='plot_pexp_beta'>Plot beta posterior expectation</h2><span id='topic+plot_pexp_beta'></span>

<h3>Description</h3>

<p>This function plots the posterior expectation of beta, the linear effect of the individual level covariates, as function of the context-level covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_pexp_beta(
  samples,
  X = NULL,
  W = NULL,
  pred.pexp.beta = FALSE,
  ncol.beta = NULL,
  ylab = NULL,
  nrow.w = NULL,
  ncol.w = NULL,
  smooth.line = FALSE,
  title = NULL,
  legend.position = "top",
  col.pred.line = "red",
  x.axis.size = 1.1,
  y.axis.size = 1.1,
  title.size = 12,
  panel.title.size = 1.4,
  legend.size = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_pexp_beta_+3A_samples">samples</code></td>
<td>
<p>an output of the function <code><a href="#topic+hdpGLM">hdpGLM</a></code></p>
</td></tr>
<tr><td><code id="plot_pexp_beta_+3A_x">X</code></td>
<td>
<p>a string vector with the name of the first-level covariates whose associated tau should be displayed</p>
</td></tr>
<tr><td><code id="plot_pexp_beta_+3A_w">W</code></td>
<td>
<p>a string vector with the name of the context-level covariate(s) whose linear effect will be displayed. If <code>NULL</code>, the linear effect tau of all context-level covariates are displayed. Note: the context-level covariate must have been included in the estimation of the model.</p>
</td></tr>
<tr><td><code id="plot_pexp_beta_+3A_pred.pexp.beta">pred.pexp.beta</code></td>
<td>
<p>boolean, if <code>TRUE</code> the plots will display a line with the predicted posterior expectation of betas obtained using the posterior expectation of taus, the linear coefficients of the expectation of beta</p>
</td></tr>
<tr><td><code id="plot_pexp_beta_+3A_ncol.beta">ncol.beta</code></td>
<td>
<p>integer with number of columns of the grid used for each group of context-level covariates</p>
</td></tr>
<tr><td><code id="plot_pexp_beta_+3A_ylab">ylab</code></td>
<td>
<p>string, the label of the y-axis</p>
</td></tr>
<tr><td><code id="plot_pexp_beta_+3A_nrow.w">nrow.w</code></td>
<td>
<p>integer with the number of rows of the grid</p>
</td></tr>
<tr><td><code id="plot_pexp_beta_+3A_ncol.w">ncol.w</code></td>
<td>
<p>integer with the number of columns of the grid</p>
</td></tr>
<tr><td><code id="plot_pexp_beta_+3A_smooth.line">smooth.line</code></td>
<td>
<p>boolean, if <code>TRUE</code> the plot will display a regression line representing the regression of the posterior expectation of the linear coefficients betas on the context-level covariates. Default <code>FALSE</code></p>
</td></tr>
<tr><td><code id="plot_pexp_beta_+3A_title">title</code></td>
<td>
<p>string, title of the plot</p>
</td></tr>
<tr><td><code id="plot_pexp_beta_+3A_legend.position">legend.position</code></td>
<td>
<p>one of four options: &quot;bottom&quot; (default), &quot;top&quot;, &quot;left&quot;, or &quot;right&quot;. It indicates the position of the legend</p>
</td></tr>
<tr><td><code id="plot_pexp_beta_+3A_col.pred.line">col.pred.line</code></td>
<td>
<p>string with color of fitted line. Only works if <code>pred.pexp.beta=TRUE</code></p>
</td></tr>
<tr><td><code id="plot_pexp_beta_+3A_x.axis.size">x.axis.size</code></td>
<td>
<p>numeric, the relative size of the label in the x-axis</p>
</td></tr>
<tr><td><code id="plot_pexp_beta_+3A_y.axis.size">y.axis.size</code></td>
<td>
<p>numeric, the relative size of the label in the y-axis</p>
</td></tr>
<tr><td><code id="plot_pexp_beta_+3A_title.size">title.size</code></td>
<td>
<p>numeric, absolute size of the title</p>
</td></tr>
<tr><td><code id="plot_pexp_beta_+3A_panel.title.size">panel.title.size</code></td>
<td>
<p>numeric, the relative size of the titles in the panel of the plot</p>
</td></tr>
<tr><td><code id="plot_pexp_beta_+3A_legend.size">legend.size</code></td>
<td>
<p>numeric, the relative size of the legend</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
library(magrittr)
set.seed(66)

# Note: this example is just for illustration. MCMC iterations are very reduced
set.seed(10)
n = 20
data.context1 = tibble::tibble(x1 = rnorm(n, -3),
                                   x2 = rnorm(n,  3),
                                   z  = sample(1:3, n, replace=TRUE),
                                   y  =I(z==1) * (3 + 4*x1 - x2 + rnorm(n)) +
                                       I(z==2) * (3 + 2*x1 + x2 + rnorm(n)) +
                                       I(z==3) * (3 - 4*x1 - x2 + rnorm(n)) ,
                                   w = 20
                                   ) 
data.context2 = tibble::tibble(x1 = rnorm(n, -3),
                                   x2 = rnorm(n,  3),
                                   z  = sample(1:2, n, replace=TRUE),
                                   y  =I(z==1) * (1 + 3*x1 - 2*x2 + rnorm(n)) +
                                       I(z==2) * (1 - 2*x1 +   x2 + rnorm(n)),
                                   w = 10
                                   ) 
data = data.context1 %&gt;%
    dplyr::bind_rows(data.context2)

## estimation
mcmc    = list(burn.in=1, n.iter=50)
samples = hdpGLM(y ~ x1 + x2, y ~ w, data=data, mcmc=mcmc, n.display=1)

plot_pexp_beta(samples)
plot_pexp_beta(samples, X='x1', ncol.w=2, nrow.w=1)
plot_pexp_beta(samples, X='x1', ncol.beta=2)
plot_pexp_beta(samples, pred.pexp.beta=TRUE, W="w", X=c("x1", "x2"))
plot_pexp_beta(samples, W='w', smooth.line=TRUE, pred.pexp.beta=TRUE, ncol.beta=2)

</code></pre>

<hr>
<h2 id='plot_tau'>Plot tau</h2><span id='topic+plot_tau'></span>

<h3>Description</h3>

<p>Function to plot posterior distribution of tau
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_tau(
  samples,
  X = NULL,
  W = NULL,
  title = NULL,
  true.tau = NULL,
  show.all.taus = FALSE,
  show.all.betas = FALSE,
  ncol = NULL,
  legend.position = "top",
  x.axis.size = 1.1,
  y.axis.size = 1.1,
  title.size = 1.2,
  panel.title.size = 1.4,
  legend.size = 1,
  xlab = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_tau_+3A_samples">samples</code></td>
<td>
<p>an output of the function <code><a href="#topic+hdpGLM">hdpGLM</a></code></p>
</td></tr>
<tr><td><code id="plot_tau_+3A_x">X</code></td>
<td>
<p>a string vector with the name of the first-level covariates whose associated tau should be displayed</p>
</td></tr>
<tr><td><code id="plot_tau_+3A_w">W</code></td>
<td>
<p>a string vector with the name of the context-level covariate(s) whose linear effect will be displayed. If <code>NULL</code>, the linear effect tau of all context-level covariates are displayed. Note: the context-level covariate must have been included in the estimation of the model.</p>
</td></tr>
<tr><td><code id="plot_tau_+3A_title">title</code></td>
<td>
<p>string, title of the plot</p>
</td></tr>
<tr><td><code id="plot_tau_+3A_true.tau">true.tau</code></td>
<td>
<p>a <code>data.frame</code> with four columns. The first must be named <code>w</code> and it indicates the index of each context-level covariate, starting with 0 for the intercept term. The second column named <code>beta</code> must contain the indexes of the betas of individual-level covariates, starting with 0 for the intercept term. The third column named <code>Parameter</code> must be named <code>tau&lt;w&gt;&lt;beta&gt;</code>, where <code>w</code> and <code>beta</code> must be the actual values displayed in the columns <code>w</code> and <code>beta</code>. Finally, it must have a column named <code>True</code> with the true value of the parameter.</p>
</td></tr>
<tr><td><code id="plot_tau_+3A_show.all.taus">show.all.taus</code></td>
<td>
<p>boolean, if <code>FALSE</code> (default) the posterior distribution of taus representing the intercept of the expectation of beta are omitted</p>
</td></tr>
<tr><td><code id="plot_tau_+3A_show.all.betas">show.all.betas</code></td>
<td>
<p>boolean, if <code>FALSE</code> (default) the taus affecting only the intercept terms of the outcome variable are omitted</p>
</td></tr>
<tr><td><code id="plot_tau_+3A_ncol">ncol</code></td>
<td>
<p>number of columns of the grid. If <code>NULL</code>, one column is used</p>
</td></tr>
<tr><td><code id="plot_tau_+3A_legend.position">legend.position</code></td>
<td>
<p>one of four options: &quot;bottom&quot; (default), &quot;top&quot;, &quot;left&quot;, or &quot;right&quot;. It indicates the position of the legend</p>
</td></tr>
<tr><td><code id="plot_tau_+3A_x.axis.size">x.axis.size</code></td>
<td>
<p>numeric, the relative size of the label in the x-axis</p>
</td></tr>
<tr><td><code id="plot_tau_+3A_y.axis.size">y.axis.size</code></td>
<td>
<p>numeric, the relative size of the label in the y-axis</p>
</td></tr>
<tr><td><code id="plot_tau_+3A_title.size">title.size</code></td>
<td>
<p>numeric, the relative size of the title of the plot</p>
</td></tr>
<tr><td><code id="plot_tau_+3A_panel.title.size">panel.title.size</code></td>
<td>
<p>numeric, the relative size of the titles in the panel of the plot</p>
</td></tr>
<tr><td><code id="plot_tau_+3A_legend.size">legend.size</code></td>
<td>
<p>numeric, the relative size of the legend</p>
</td></tr>
<tr><td><code id="plot_tau_+3A_xlab">xlab</code></td>
<td>
<p>string, the label of the x-axis</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
library(magrittr)
set.seed(66)

# Note: this example is just for illustration. MCMC iterations are very reduced
set.seed(10)
n = 20
data.context1 = tibble::tibble(x1 = rnorm(n, -3),
                                   x2 = rnorm(n,  3),
                                   z  = sample(1:3, n, replace=TRUE),
                                   y  =I(z==1) * (3 + 4*x1 - x2 + rnorm(n)) +
                                       I(z==2) * (3 + 2*x1 + x2 + rnorm(n)) +
                                       I(z==3) * (3 - 4*x1 - x2 + rnorm(n)) ,
                                   w = 20
                                   ) 
data.context2 = tibble::tibble(x1 = rnorm(n, -3),
                                   x2 = rnorm(n,  3),
                                   z  = sample(1:2, n, replace=TRUE),
                                   y  =I(z==1) * (1 + 3*x1 - 2*x2 + rnorm(n)) +
                                       I(z==2) * (1 - 2*x1 +   x2 + rnorm(n)),
                                   w = 10
                                   ) 
data = data.context1 %&gt;%
    dplyr::bind_rows(data.context2)

## estimation
mcmc    = list(burn.in=1, n.iter=50)
samples = hdpGLM(y ~ x1 + x2, y ~ w, data=data, mcmc=mcmc, n.display=1)


plot_tau(samples)
plot_tau(samples, ncol=2)
plot_tau(samples, X='x1', W='w')
plot_tau(samples, show.all.taus=TRUE, show.all.betas=TRUE, ncol=2)

</code></pre>

<hr>
<h2 id='plot.dpGLM'>Default plot for class dpGLM</h2><span id='topic+plot.dpGLM'></span>

<h3>Description</h3>

<p>This function generates desity plots with the posterior distribution generated by the function <code><a href="#topic+hdpGLM">hdpGLM</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dpGLM'
plot(
  x,
  terms = NULL,
  separate = FALSE,
  hpd = TRUE,
  true.beta = NULL,
  title = NULL,
  subtitle = NULL,
  adjust = 1,
  ncols = NULL,
  only.occupied.clusters = TRUE,
  focus.hpd = FALSE,
  legend.position = "top",
  colour = "grey",
  alpha = 0.4,
  display.terms = TRUE,
  plot.mean = TRUE,
  legend.label.true.value = "True",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.dpGLM_+3A_x">x</code></td>
<td>
<p>a dpGLM object with the samples from generated by <code><a href="#topic+hdpGLM">hdpGLM</a></code></p>
</td></tr>
<tr><td><code id="plot.dpGLM_+3A_terms">terms</code></td>
<td>
<p>string vector with the name of covariates to plot. If <code>NULL</code> (default), all covariates are plotted.</p>
</td></tr>
<tr><td><code id="plot.dpGLM_+3A_separate">separate</code></td>
<td>
<p>boolean, if <code>TRUE</code> the linear coefficients <code>beta</code> will be displayed in their separate clusters.</p>
</td></tr>
<tr><td><code id="plot.dpGLM_+3A_hpd">hpd</code></td>
<td>
<p>boolean, if <code>TRUE</code> and <code>separate=T</code>, the 95% HPDI lines will be displayed.</p>
</td></tr>
<tr><td><code id="plot.dpGLM_+3A_true.beta">true.beta</code></td>
<td>
<p>either <code>NULL</code> (default) or a <code>data.frame</code> with the true values of the linear coefficients <code>beta</code> if they are known. The <code>data.frame</code> must contain a column named <code>k</code> indicating the cluster of <code>beta</code>, and a column named <code>Parameter</code> with the name of the linear coefficients (<code>beta1</code>, <code>beta2</code>, ..., <code>beta_dx</code>, where <code>dx</code> is the number of covariates at the individual level, and beta1 is the coefficient of the intercept term). It must contain a column named <code>True</code> with the true value of the <code>betas</code>.</p>
</td></tr>
<tr><td><code id="plot.dpGLM_+3A_title">title</code></td>
<td>
<p>string, the title of the plot</p>
</td></tr>
<tr><td><code id="plot.dpGLM_+3A_subtitle">subtitle</code></td>
<td>
<p>string, the subtitle of the plot</p>
</td></tr>
<tr><td><code id="plot.dpGLM_+3A_adjust">adjust</code></td>
<td>
<p>the bandwidth used is actually <code>adjust*bw</code>.
This makes it easy to specify values like &lsquo;half the default&rsquo;
bandwidth.</p>
</td></tr>
<tr><td><code id="plot.dpGLM_+3A_ncols">ncols</code></td>
<td>
<p>integer, the number of columns in the plot</p>
</td></tr>
<tr><td><code id="plot.dpGLM_+3A_only.occupied.clusters">only.occupied.clusters</code></td>
<td>
<p>boolean, if <code>TRUE</code> it shows only the densities of the clusters that actually have data points assigned to it with high probability</p>
</td></tr>
<tr><td><code id="plot.dpGLM_+3A_focus.hpd">focus.hpd</code></td>
<td>
<p>boolean, if <code>TRUE</code> and separate is also <code>TRUE</code> it will display only the 95% HPDI of the posterior density of the linear coefficients <code>beta</code></p>
</td></tr>
<tr><td><code id="plot.dpGLM_+3A_legend.position">legend.position</code></td>
<td>
<p>one of four options: &quot;bottom&quot; (default), &quot;top&quot;, &quot;left&quot;, or &quot;right&quot;. It indicates the position of the legend</p>
</td></tr>
<tr><td><code id="plot.dpGLM_+3A_colour">colour</code></td>
<td>
<p>= string with color to fill the density plot</p>
</td></tr>
<tr><td><code id="plot.dpGLM_+3A_alpha">alpha</code></td>
<td>
<p>number between 0 and 1 indicating the degree of transparency of the density</p>
</td></tr>
<tr><td><code id="plot.dpGLM_+3A_display.terms">display.terms</code></td>
<td>
<p>boolean, if <code>TRUE</code> (default), the covariate name is displayed in the plot</p>
</td></tr>
<tr><td><code id="plot.dpGLM_+3A_plot.mean">plot.mean</code></td>
<td>
<p>boolean, if <code>TRUE</code> the posterior mean of every cluster is displayed</p>
</td></tr>
<tr><td><code id="plot.dpGLM_+3A_legend.label.true.value">legend.label.true.value</code></td>
<td>
<p>a string with the value to display in the legend when the <code>true.beta</code> is used</p>
</td></tr>
<tr><td><code id="plot.dpGLM_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Note: this example is just for illustration. MCMC iterations are very reduced
set.seed(10)
n = 20
data = tibble::tibble(x1 = rnorm(n, -3),
                                   x2 = rnorm(n,  3),
                                   z  = sample(1:3, n, replace=TRUE),
                                   y  =I(z==1) * (3 + 4*x1 - x2 + rnorm(n)) +
                                       I(z==2) * (3 + 2*x1 + x2 + rnorm(n)) +
                                       I(z==3) * (3 - 4*x1 - x2 + rnorm(n)) ,
                                   ) 

## estimation
mcmc    = list(burn.in=1, n.iter=50)
samples = hdpGLM(y ~ x1 + x2,  data=data, mcmc=mcmc, n.display=1)

plot(samples)


</code></pre>

<hr>
<h2 id='plot.hdpGLM'>Plot</h2><span id='topic+plot.hdpGLM'></span>

<h3>Description</h3>

<p>Generic function to plot the posterior density estimation produced by the function <code>hdpGLM</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hdpGLM'
plot(
  x,
  terms = NULL,
  j.label = NULL,
  j.idx = NULL,
  title = NULL,
  subtitle = NULL,
  true.beta = NULL,
  ncol = NULL,
  legend.position = "bottom",
  display.terms = TRUE,
  context.id = NULL,
  ylab = NULL,
  xlab = NULL,
  x.axis.size = 1.1,
  y.axis.size = 1.1,
  title.size = 1.2,
  panel.title.size = 1.5,
  legend.size = 1.1,
  rel.height = 0.01,
  fill.col = "#00000044",
  border.col = "white",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.hdpGLM_+3A_x">x</code></td>
<td>
<p>an object of the class <code>hdpGLM</code> generted by the function <a href="#topic+hdpGLM">hdpGLM</a></p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_terms">terms</code></td>
<td>
<p>string vector with the name of the individual-level covariates to plot. If <code>NULL</code> (default), all covariates are plotted.</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_j.label">j.label</code></td>
<td>
<p>string vector with the names of the contexts to plot. An alternative is to use the context indexes with the parameter <code>j.idx</code> instead of the context labels. If <code>NULL</code> (default) and j.idx is also <code>NULL</code>, the posterior distribution of all contexts are plotted. Note: if contexts to plot are selected using <code>j.label</code>, the parameter <code>context.id</code> must also be provided.</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_j.idx">j.idx</code></td>
<td>
<p>integer vector with the index of the contexts to plot. An alternative is to use the context labels with the parameter <code>j.label</code> instead of the indexes. If <code>NULL</code> (default) and j.label is also <code>NULL</code>, the posterior distribution of all contexts are plotted</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_title">title</code></td>
<td>
<p>string, the title of the plot</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_subtitle">subtitle</code></td>
<td>
<p>string, the subtitle of the plot</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_true.beta">true.beta</code></td>
<td>
<p>a <code>data.frame</code> with the true values of the linear coefficients <code>beta</code> if they are known. The <code>data.frame</code> must contain a column named <code>j</code> with the index of the context associated with that particular linear coefficient <code>beta</code>. It must match the indexes used in the data set for each context. Another column named <code>k</code> must be provided, indicating the cluster of <code>beta</code>, and a column named <code>Parameter</code> with the name of the linear coefficients (<code>beta1</code>, <code>beta2</code>, ..., <code>beta_dx</code>, where <code>dx</code> is the number of covariates at the individual level, and beta1 is the coefficient of the intercept term). It must contain a column named <code>True</code> with the true value of the <code>betas</code>. Finally, the <code>data.frame</code> must contain columns with the context-level covariates as used in the estimation of the <a href="#topic+hdpGLM">hdpGLM</a> function (see Details below).</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_ncol">ncol</code></td>
<td>
<p>interger, the number of columns in the plot</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_legend.position">legend.position</code></td>
<td>
<p>one of four options: &quot;bottom&quot; (default), &quot;top&quot;, &quot;left&quot;, or &quot;right&quot;. It indicates the position of the legend</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_display.terms">display.terms</code></td>
<td>
<p>boolean, if <code>TRUE</code> (default), the covariate name is displayed in the plot</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_context.id">context.id</code></td>
<td>
<p>string with the name of the column containing the labels identifying the contexts. This variable should have been specified when the estimation was conducted using the function <code><a href="#topic+hdpGLM">hdpGLM</a></code>.</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_ylab">ylab</code></td>
<td>
<p>string, the label of the y-axis</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_xlab">xlab</code></td>
<td>
<p>string, the label of the x-axis</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_x.axis.size">x.axis.size</code></td>
<td>
<p>numeric, the relative size of the label in the x-axis</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_y.axis.size">y.axis.size</code></td>
<td>
<p>numeric, the relative size of the label in the y-axis</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_title.size">title.size</code></td>
<td>
<p>numeric, the relative size of the title of the plot</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_panel.title.size">panel.title.size</code></td>
<td>
<p>numeric, the relative size of the titles in the panel of the plot</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_legend.size">legend.size</code></td>
<td>
<p>numeric, the relative size of the legend</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_rel.height">rel.height</code></td>
<td>
<p>see ggridges::geom_density_ridges</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_fill.col">fill.col</code></td>
<td>
<p>string with the color of the densities</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_border.col">border.col</code></td>
<td>
<p>string with the color of the border of the densities</p>
</td></tr>
<tr><td><code id="plot.hdpGLM_+3A_...">...</code></td>
<td>
<p>Additional arguments accepted are:
</p>
<p><code>true.beta</code>: a <code>data.frame</code> with the true values of the linear coefficients <code>beta</code> if they are known. The <code>data.frame</code> must contain a column named <code>j</code> with the index of the context associated with that particular linear coefficient <code>beta</code>. It must match the indexes used in the data set for each context. Another column named <code>k</code> must be provided, indicating the cluster of <code>beta</code>, and a column named <code>Parameter</code> with the name of the linear coefficients (<code>beta1</code>, <code>beta2</code>, ..., <code>beta_dx</code>, where <code>dx</code> is the number of covariates at the individual level, and beta1 is the coefficient of the intercept term). It must contain a column named <code>True</code> with the true value of the <code>betas</code>. Finally, the <code>data.frame</code> must contain columns with the context-level covariates as used in the estimation of the <a href="#topic+hdpGLM">hdpGLM</a> function (see Details below).
</p>
<p><code>true.tau</code>: a <code>data.frame</code> with four columns. The first must be named <code>w</code> and it indicates the index of each context-level covariate, starting with 0 for the intercept term. The second column named <code>beta</code> must contain the indexes of the betas of individual-level covariates, starting with 0 for the intercept term. The third column named <code>Parameter</code> must be named <code>tau&lt;w&gt;&lt;beta&gt;</code>, where <code>w</code> and <code>beta</code> must be the actual values displayed in the columns <code>w</code> and <code>beta</code>. Finally, it must have a column named <code>True</code> with the true value of the parameter.</p>
</td></tr>
</table>

<hr>
<h2 id='predict.dpGLM'>dpGLM Predicted values</h2><span id='topic+predict.dpGLM'></span>

<h3>Description</h3>

<p>Function returns the predicted (fitted) values of the outcome variable using
the estimated posterior expectation of the linear covariate betas produced by
the <code>hdpGLM</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dpGLM'
predict(object, new_data = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.dpGLM_+3A_object">object</code></td>
<td>
<p>outcome of the function hdpLGM</p>
</td></tr>
<tr><td><code id="predict.dpGLM_+3A_new_data">new_data</code></td>
<td>
<p>data frame with the values of the covariates that are going
to be used to generate the predicted/fitted values. The posterior mean is
used to create the predicted values</p>
</td></tr>
<tr><td><code id="predict.dpGLM_+3A_...">...</code></td>
<td>
<p><code>family</code> : a string with the family of the output variable:
<code>gaussian</code> (default), <code>binomial</code>, etc...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns a data.frame with the fitted values for the outcome
variable, which are produced using the estimated posterior expectation of the
linear coefficients <code>beta</code>.
</p>

<hr>
<h2 id='predict.hdpGLM'>hdpGLM Predicted values</h2><span id='topic+predict.hdpGLM'></span>

<h3>Description</h3>

<p>Function returns the predicted (fitted) values of the outcome variable using
the estimated posterior expectation of the linear covariate betas produced by
the <code>hdpGLM</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hdpGLM'
predict(object, new_data = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.hdpGLM_+3A_object">object</code></td>
<td>
<p>outcome of the function hdpLGM</p>
</td></tr>
<tr><td><code id="predict.hdpGLM_+3A_new_data">new_data</code></td>
<td>
<p>data frame with the values of the covariates that are going
to be used to generate the predicted/fitted values. The posterior mean is
used to create the predicted values</p>
</td></tr>
<tr><td><code id="predict.hdpGLM_+3A_...">...</code></td>
<td>
<p><code>family</code> : a string with the family of the output variable:
<code>gaussian</code> (default), <code>binomial</code>, etc...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns a data.frame with the fitted values for the outcome
variable, which are produced using the estimated posterior expectation of the
linear coefficients <code>beta</code>.
</p>

<hr>
<h2 id='print.dpGLM'>Print</h2><span id='topic+print.dpGLM'></span>

<h3>Description</h3>

<p>Generic method to print the output of the <code>dpGLM</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dpGLM'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.dpGLM_+3A_x">x</code></td>
<td>
<p>a <code>dpGLM</code> object returned by the function <code>hdpGLM</code></p>
</td></tr>
<tr><td><code id="print.dpGLM_+3A_...">...</code></td>
<td>
<p>ignore</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns a summary of the posterior distribution of the parameters
</p>

<hr>
<h2 id='print.dpGLM_data'>Print</h2><span id='topic+print.dpGLM_data'></span>

<h3>Description</h3>

<p>Generic method to print the output of the <code>hdpGLM_simulateData</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dpGLM_data'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.dpGLM_data_+3A_x">x</code></td>
<td>
<p>a <code>dpGLM_data</code> object returned by the function
<code>hdpGLM_simulateData</code></p>
</td></tr>
<tr><td><code id="print.dpGLM_data_+3A_...">...</code></td>
<td>
<p>ignore</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns a summary of the simulated data
</p>

<hr>
<h2 id='print.hdpGLM'>Print</h2><span id='topic+print.hdpGLM'></span>

<h3>Description</h3>

<p>Generic method to print the output of the <code>hdpGLM</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hdpGLM'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.hdpGLM_+3A_x">x</code></td>
<td>
<p>a <code>hdpGLM</code> object returned by the function <code>hdpGLM</code></p>
</td></tr>
<tr><td><code id="print.hdpGLM_+3A_...">...</code></td>
<td>
<p>ignore</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns a summary of the posterior distribution of the parameters
</p>

<hr>
<h2 id='print.hdpGLM_data'>Print</h2><span id='topic+print.hdpGLM_data'></span>

<h3>Description</h3>

<p>Generic method to print the output of the <code>hdpGLM_simulateData</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hdpGLM_data'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.hdpGLM_data_+3A_x">x</code></td>
<td>
<p>a <code>hdpGLM_data</code> object returned by the function
<code>hdpGLM_simulateData</code></p>
</td></tr>
<tr><td><code id="print.hdpGLM_data_+3A_...">...</code></td>
<td>
<p>ignore</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns a summary of the simulated data
</p>

<hr>
<h2 id='summary_tidy'>Tidy summary</h2><span id='topic+summary_tidy'></span>

<h3>Description</h3>

<p>This function provides a summary of the MCMC samples from the dpGLM model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary_tidy(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_tidy_+3A_object">object</code></td>
<td>
<p>a <code>dpGLM</code> object returned by the function <code>hdpGLM</code></p>
</td></tr>
<tr><td><code id="summary_tidy_+3A_...">...</code></td>
<td>
<p>The additional parameters accepted are:
</p>
<p>true.beta: (see <a href="#topic+plot.dpGLM">plot.dpGLM</a>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data points are assigned to clusters according to the highest estimated probability of belonging to that cluster
</p>

<hr>
<h2 id='summary.dpGLM'>Summary for dpGLM class</h2><span id='topic+summary.dpGLM'></span>

<h3>Description</h3>

<p>This function provides a summary of the MCMC samples from the dpGLM model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dpGLM'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.dpGLM_+3A_object">object</code></td>
<td>
<p>a <code>dpGLM</code> object returned by the function <code>hdpGLM</code></p>
</td></tr>
<tr><td><code id="summary.dpGLM_+3A_...">...</code></td>
<td>
<p>The additional parameters accepted are:
</p>
<p>true.beta: (see <a href="#topic+plot.dpGLM">plot.dpGLM</a>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data points are assigned to clusters according to the highest estimated probability of belonging to that cluster
</p>

<hr>
<h2 id='summary.dpGLM_data'>Summary dpGLM data</h2><span id='topic+summary.dpGLM_data'></span>

<h3>Description</h3>

<p>This function summarizes the data and parameters used to generate the data using the function hdpLGM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dpGLM_data'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.dpGLM_data_+3A_object">object</code></td>
<td>
<p>an object of the class dpGLM_data</p>
</td></tr>
<tr><td><code id="summary.dpGLM_data_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the summary of the data produced by the standard summary function and a <code>data.frame</code> with the true values of beta for each cluster.
</p>

<hr>
<h2 id='summary.hdpGLM'>Summary for hdpGLM class</h2><span id='topic+summary.hdpGLM'></span>

<h3>Description</h3>

<p>This is a generic summary function that describes the output of the function <a href="#topic+hdpGLM">hdpGLM</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hdpGLM'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.hdpGLM_+3A_object">object</code></td>
<td>
<p>an object of the class <code>hdpGLM</code> generted by the function <a href="#topic+hdpGLM">hdpGLM</a></p>
</td></tr>
<tr><td><code id="summary.hdpGLM_+3A_...">...</code></td>
<td>
<p>Additional arguments accepted are:
</p>
<p><code>true.beta</code>: a <code>data.frame</code> with the true values of the linear coefficients <code>beta</code> if they are known. The <code>data.frame</code> must contain a column named <code>j</code> with the index of the context associated with that particular linear coefficient <code>beta</code>. It must match the indexes used in the data set for each context. Another column named <code>k</code> must be provided, indicating the cluster of <code>beta</code>, and a column named <code>Parameter</code> with the name of the linear coefficients (<code>beta1</code>, <code>beta2</code>, ..., <code>beta_dx</code>, where <code>dx</code> is the number of covariates at the individual level, and beta1 is the coefficient of the intercept term). It must contain a column named <code>True</code> with the true value of the <code>betas</code>. Finally, the <code>data.frame</code> must contain columns with the context-level covariates as used in the estimation of the <a href="#topic+hdpGLM">hdpGLM</a> function (see Details below).
</p>
<p><code>true.tau</code>: a <code>data.frame</code> with four columns. The first must be named <code>w</code> and it indicates the index of each context-level covariate, starting with 0 for the intercept term. The second column named <code>beta</code> must contain the indexes of the betas of individual-level covariates, starting with 0 for the intercept term. The third column named <code>Parameter</code> must be named <code>tau&lt;w&gt;&lt;beta&gt;</code>, where <code>w</code> and <code>beta</code> must be the actual values displayed in the columns <code>w</code> and <code>beta</code>. Finally, it must have a column named <code>True</code> with the true value of the parameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function hdpGLM returns a list with the samples from the posterior distribution along with other elements. That list contains an element named <code>context.cov</code> that connects the indexed &quot;C&quot; created during the estimation and the context-level covariates. So each unique context-level covariate gets an index during the estimation. The algorithm only requires the context-level covariates, but it creates such index C to help the estimation. If true.beta is provided, it must contain indexes for the context as well, which indicates the context of each specific linear coefficient <code>beta</code>. Such index will probably be different from the one created by the algorithm. Therefore, when the <code>true.beta</code> is provided, we need to connect the context index C generated by the algorithm and the column j in the true.beta data.frame in order to compare the true values and the estimated value for each context. That is why we need the values of the context-level covariates as well. The summary uses them as key to merge the true and the estimated values for each context. The true and estimated clusters are matched based on the shortest distance between the estimated posterior average and the true value in each context because the labels of the clusters in the estimation can vary, even thought the same data points are classified in the same clusters.
</p>


<h3>Value</h3>

<p>The function returns a list with two data.frames. The first summarizes the posterior distribution of the linear coefficients <code>beta</code>. The mean, median, and the 95% HPD interval are provided. The second data.frame contains the summary of the posterior distribution of the parameter <code>tau</code>.
</p>

<hr>
<h2 id='summary.hdpGLM_data'>Summary</h2><span id='topic+summary.hdpGLM_data'></span>

<h3>Description</h3>

<p>This functions summarizes the data simulated by the function <code>hdpGLM_simulateData</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hdpGLM_data'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.hdpGLM_data_+3A_object">object</code></td>
<td>
<p>an object of the class <code>hdpGLM_data</code>, which is produced by the function <code>hdpGLM_simulateData</code></p>
</td></tr>
<tr><td><code id="summary.hdpGLM_data_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns a list with three elements. The first is a summary of the data, the second a tibble with the linear coefficients <code>beta</code> and their values used to generate the data, and the third element is also a tibble with the true values of <code>tau</code> used to generate the <code>betas</code>.
</p>

<hr>
<h2 id='welfare'>Fake data set with 2000 observations</h2><span id='topic+welfare'></span>

<h3>Description</h3>

<p>A dataset containing simulated data about public opinion
</p>


<h3>Usage</h3>

<pre><code class='language-R'>welfare
</code></pre>


<h3>Format</h3>

<p>A data frame with 2000 rows and 4 variables:
</p>

<dl>
<dt>support</dt><dd><p>support for welfare policies</p>
</dd>
<dt>inequality</dt><dd><p>levels of inequality in the neighborhood</p>
</dd>
<dt>income</dt><dd><p>individual-level income</p>
</dd>
<dt>ideology</dt><dd><p>individual-level ideology</p>
</dd>
</dl>



<h3>Source</h3>

<p>Simulated data
</p>

<hr>
<h2 id='welfare2'>Fake data set with 2000 observations</h2><span id='topic+welfare2'></span>

<h3>Description</h3>

<p>A dataset containing simulated data about public opinion in different
countries
</p>


<h3>Usage</h3>

<pre><code class='language-R'>welfare2
</code></pre>


<h3>Format</h3>

<p>A data frame with 2000 rows and 6 variables:
</p>

<dl>
<dt>support</dt><dd><p>support for welfare policies</p>
</dd>
<dt>inequality</dt><dd><p>levels of inequality in the neighborhood</p>
</dd>
<dt>income</dt><dd><p>individual-level income</p>
</dd>
<dt>ideology</dt><dd><p>individual-level ideology</p>
</dd>
<dt>country</dt><dd><p>country label or index</p>
</dd>
<dt>gap</dt><dd><p>country-level gender gap in country's provision of public good</p>
</dd>
</dl>



<h3>Source</h3>

<p>Simulated data
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
