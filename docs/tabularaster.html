<!DOCTYPE html><html><head><title>Help for package tabularaster</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tabularaster}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#as_tibble'><p>Convert a Raster to a data frame.</p></a></li>
<li><a href='#cellnumbers'><p>Extract cell numbers from a Raster object.</p></a></li>
<li><a href='#decimate'><p>Decimate swiftly and ruthlessly</p></a></li>
<li><a href='#ghrsst'><p>Sea surface temperature data.</p></a></li>
<li><a href='#index_extent'><p>Index extent</p></a></li>
<li><a href='#oisst'><p>Optimally interpolated SST in near-native form.</p></a></li>
<li><a href='#polycano'><p>The raster volcano as polygons.</p></a></li>
<li><a href='#rastercano'><p>The raster volcano.</p></a></li>
<li><a href='#sharkcano'><p>Sharkcano, the shark and the volcano.</p></a></li>
<li><a href='#tabularaster'><p>Tabular tools for raster</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tidy Tools for 'Raster' Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.7.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Facilities to work with vector and raster data in efficient 
 repeatable and systematic work flow. Missing functionality in existing packages 
 is included here to allow extraction from raster data with 'simple features' and 
 'Spatial' types and to make extraction consistent and straightforward. Extract cell 
 numbers from raster data and  return the cells as a data frame 
 rather than as lists of matrices or vectors. The functions here allow spatial data 
 to be used without special handling for the format currently in use. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, fasterize, magrittr, raster, silicate, spatstat.geom,
tibble</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, knitr, rmarkdown, testthat (&ge; 2.1.0), spelling</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/hypertidy/tabularaster">https://github.com/hypertidy/tabularaster</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/hypertidy/tabularaster/issues">https://github.com/hypertidy/tabularaster/issues</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-01 05:14:23 UTC; mdsumner</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael D. Sumner [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael D. Sumner &lt;mdsumner@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-01 06:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">pipe</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>

<hr>
<h2 id='as_tibble'>Convert a Raster to a data frame.</h2><span id='topic+as_tibble'></span><span id='topic+as_tibble.BasicRaster'></span>

<h3>Description</h3>

<p>Generate a data frame version of any raster object. Use the arguments
'cell', 'dim', 'split_date' and 'value' to control the columns that
are included in the output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BasicRaster'
as_tibble(
  x,
  cell = TRUE,
  dim = nlayers(x) &gt; 1L,
  value = TRUE,
  split_date = FALSE,
  xy = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_tibble_+3A_x">x</code></td>
<td>
<p>a RasterLayer, RasterStack or RasterBrick</p>
</td></tr>
<tr><td><code id="as_tibble_+3A_cell">cell</code></td>
<td>
<p>logical to include explicit cell number</p>
</td></tr>
<tr><td><code id="as_tibble_+3A_dim">dim</code></td>
<td>
<p>logical to include slice index</p>
</td></tr>
<tr><td><code id="as_tibble_+3A_value">value</code></td>
<td>
<p>logical to return the values as a column or not</p>
</td></tr>
<tr><td><code id="as_tibble_+3A_split_date">split_date</code></td>
<td>
<p>logical to split date into components</p>
</td></tr>
<tr><td><code id="as_tibble_+3A_xy">xy</code></td>
<td>
<p>logical to include the x and y centre coordinate of each cell</p>
</td></tr>
<tr><td><code id="as_tibble_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the raster has only one layer, the slice index is not added. Use 'dim = FALSE' to not include
the slice index value.
</p>


<h3>Value</h3>

<p>a data frame (tibble) with columns:
</p>

<ul>
<li> <p><code>cellvalue</code> the actual value of the raster cell
</p>
</li>
<li> <p><code>cellindex</code> the index of the cell (numbered from 1 to <code>ncell()</code> in the raster way).
</p>
</li></ul>

<p>Columns <code>cellindex</code> or <code>cellvalue</code> may be omitted if either or both of <code>cell</code> and/or <code>value</code> are <code>FALSE</code>, respectively
</p>
<p>Other columns might be included depending on the properties of the raster and
the arguments to the function:
</p>

<ul>
<li> <p><code>year</code>,<code>month</code>,<code>day</code> if <code>split_date</code> is <code>TRUE</code>
</p>
</li>
<li> <p><code>x</code>,<code>y</code> if <code>xy</code> is <code>TRUE</code>
</p>
</li>
<li> <p><code>dimindex</code> if the input has more than 1 layer and <code>dim</code> is <code>TRUE</code>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## basic data frame version of a basic raster
as_tibble(raster::raster(volcano))

## data frame with time column since raster has that set
r &lt;- raster::raster(volcano)
br &lt;- raster::brick(r, r)
as_tibble(raster::setZ(br, Sys.Date() + 1:2), cell = TRUE)
</code></pre>

<hr>
<h2 id='cellnumbers'>Extract cell numbers from a Raster object.</h2><span id='topic+cellnumbers'></span><span id='topic+cellnumbers.default'></span><span id='topic+cellnumbers.SpatialLines'></span><span id='topic+cellnumbers.sfc'></span><span id='topic+cellnumbers.sf'></span>

<h3>Description</h3>

<p>Provide the 'cellnumbers' capability of <a href="raster.html#topic+extract">raster::extract</a> and friends
directly, returning a data frame of query-object identifiers 'object_'
and the cell number.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cellnumbers(x, query, ...)

## Default S3 method:
cellnumbers(x, query, ...)

## S3 method for class 'SpatialLines'
cellnumbers(x, query, ...)

## S3 method for class 'sfc'
cellnumbers(x, query, ...)

## S3 method for class 'sf'
cellnumbers(x, query, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cellnumbers_+3A_x">x</code></td>
<td>
<p>Raster object</p>
</td></tr>
<tr><td><code id="cellnumbers_+3A_query">query</code></td>
<td>
<p>Spatial object or matrix of coordinates</p>
</td></tr>
<tr><td><code id="cellnumbers_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Raster data is inherently 2-dimensional, with a time or 'level' dimension
treated like a layers of these 2D forms. The 'raster' package cell number
is counted from 1 at the top-left, across the rows and down. This corresponds
the the standard &quot;raster graphics&quot; convention used by 'GDAL' and the 'sp'
package, and many other implementations. Note that this is different to the
convention used by the <a href="graphics.html#topic+image">graphics::image</a> function.
</p>
<p>Currently this function only operates as if the input is a single layer objects, it's not clear if adding
an extra level of grouping for layers would be sensible.
</p>


<h3>Value</h3>

<p>a data frame (tibble) with columns
</p>

<ul>
<li> <p><code>object_</code> - the object ID (what row is it from the spatial object)
</p>
</li>
<li> <p><code>cell_</code>   - the cell number of the raster
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
library(dplyr)
r &lt;- raster(volcano) %&gt;% aggregate(fact = 4)
cellnumbers(r, rasterToContour(r, level = 120))
library(dplyr)

cr &lt;- cut(r,  pretty(values(r)))

suppressWarnings(tt &lt;- cellnumbers(cr, polycano))
library(dplyr)
tt %&gt;% mutate(v = extract(r, cell_)) %&gt;% 
group_by(object_) %&gt;% 
summarize(mean(v)) 
head(pretty(values(r)), -1)
</code></pre>

<hr>
<h2 id='decimate'>Decimate swiftly and ruthlessly</h2><span id='topic+decimate'></span>

<h3>Description</h3>

<p>Reduce the resolution of a <code><a href="raster.html#topic+raster">raster</a></code> by ruthless decimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decimate(x, dec = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decimate_+3A_x">x</code></td>
<td>
<p>raster object (single layer).</p>
</td></tr>
<tr><td><code id="decimate_+3A_dec">dec</code></td>
<td>
<p>decimation factor, raw multiplier for the resolution of the output</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is fast, it's just fast extraction with no care taken for utility purposes when you need
to reduce the detail.
</p>


<h3>Value</h3>

<p>raster layer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
plot(decimate(raster(volcano)))
contour(raster(volcano), add = TRUE)
</code></pre>

<hr>
<h2 id='ghrsst'>Sea surface temperature data.</h2><span id='topic+ghrsst'></span><span id='topic+sst_regions'></span>

<h3>Description</h3>

<p>A smoothed subset of GHRSST.
</p>


<h3>Format</h3>

<p>A raster created GHRSST data and raster smoothing.
</p>


<h3>Details</h3>

<p>See &quot;data-raw/ghrsst.R&quot; and &quot;data-raw/ghrsst-readme.txt&quot; for
details.
</p>
<p><code>sst_regions</code> is a simple polygon region layer to sit over the SST data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(raster)
plot(ghrsst, col = hcl.colors(12, "YlOrRd", rev = TRUE))
plot(sst_regions, add = TRUE, col = NA)
cellnumbers(ghrsst, sst_regions) 

</code></pre>

<hr>
<h2 id='index_extent'>Index extent</h2><span id='topic+index_extent'></span>

<h3>Description</h3>

<p>Extent in index space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>index_extent(x, ex)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="index_extent_+3A_x">x</code></td>
<td>
<p>raster layer</p>
</td></tr>
<tr><td><code id="index_extent_+3A_ex">ex</code></td>
<td>
<p>extent</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Convert a geographic extent into purely index space.
</p>


<h3>Value</h3>

<p>extent object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## the index extent is the rows/cols
index_extent(raster::raster(volcano), raster::extent(0, 1, 0, 1))

index_extent(raster::raster(volcano), raster::extent(0, 1, 0, .5))

</code></pre>

<hr>
<h2 id='oisst'>Optimally interpolated SST in near-native form.</h2><span id='topic+oisst'></span>

<h3>Description</h3>

<p>See data-raw/oisst.R in the source repository.  The file was
avhrr-only-v2.20170729.nc, its extent -180, 180, -90, 90 with
dimensions 1440x720 in the usual raster configuration.
</p>


<h3>Format</h3>

<p>A data frame of sst values created from OISST data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>oisst
</code></pre>

<hr>
<h2 id='polycano'>The raster volcano as polygons.</h2><span id='topic+polycano'></span>

<h3>Description</h3>

<p>See data-raw/rastercano.r in the source repository.
</p>


<h3>Format</h3>

<p>A <code>sp::SpatialPolygonsDataFrame</code> with variables: <code>volcano_elevation</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exists("polycano")
</code></pre>

<hr>
<h2 id='rastercano'>The raster volcano.</h2><span id='topic+rastercano'></span>

<h3>Description</h3>

<p>See data-raw/rastercano.r in the source repository.
</p>


<h3>Format</h3>

<p>A raster created from the <code><a href="datasets.html#topic+volcano">volcano</a></code> data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
plot(rastercano)
</code></pre>

<hr>
<h2 id='sharkcano'>Sharkcano, the shark and the volcano.</h2><span id='topic+sharkcano'></span>

<h3>Description</h3>

<p>This is just a free image off the internet.
The image was read in and all non-essential items dropped. The dimensions in <code>raster::raster</code> terms is stored in
<code>attr(sharkcano, "rasterdim")</code>.
</p>


<h3>Format</h3>

<p>A data frame with 117843 rows and 2 variables:
</p>

<dl>
<dt><code>cell_</code></dt><dd><p>integer, cell index</p>
</dd>
<dt><code>byte</code></dt><dd><p>integer, byte value of shark image pixels</p>
</dd>
</dl>

<p>These are cell values on a grid that is 648x958.
</p>


<h3>References</h3>

<p>This is the small version from here, see script in data-raw/sharkcano.r
http://www.freestockphotos.biz/stockphoto/16214
Thanks to @jennybc for pointers on finding free stuff: https://github.com/jennybc/free-photos
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
rd &lt;- attr(sharkcano, "rasterdim")
rastershark &lt;- raster(matrix(NA_integer_, rd[1], rd[2]))
rastershark[sharkcano$cell_] &lt;- sharkcano$byte  ## byte, heh
## I present to you, Sharkcano!  (Just wait for the 3D version, Quadshark).
plot(rastercano)
contour(rastershark, add = TRUE, labels = FALSE)
plot(rastershark, col = "black")
## another way
plot(rastercano)
points(xyFromCell(rastershark, sharkcano$cell_), pch = ".")
</code></pre>

<hr>
<h2 id='tabularaster'>Tabular tools for raster</h2><span id='topic+tabularaster'></span>

<h3>Description</h3>

<p>Extract and index with raster tidy tools for raster.
</p>


<h3>Details</h3>

<p>Tabularaster includes these main functions.
</p>

<table>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+as_tibble">as_tibble</a></code> </td><td style="text-align: left;"> convert raster data to data frame form, with control over output and form of dimension/coordinate columns </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+cellnumbers">cellnumbers</a></code> </td><td style="text-align: left;"> extract a data frame of query identifiers and cell,pixel index numbers </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+decimate">decimate</a></code> </td><td style="text-align: left;"> fast and loose resizing of a raster to coarser resolution </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+index_extent">index_extent</a></code> </td><td style="text-align: left;"> build an extent in row column form, as opposed to coordinate value form </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
