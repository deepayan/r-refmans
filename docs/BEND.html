<!DOCTYPE html><html><head><title>Help for package BEND</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BEND}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Bayes_BPREM'><p>Bayesian Bivariate Piecewise Random Effects Model (BPREM)</p></a></li>
<li><a href='#Bayes_CREM'><p>Bayesian Crossed Random Effects Model (CREM)</p></a></li>
<li><a href='#Bayes_PREM'><p>Bayesian Piecewise Random Effects Model (PREM) + Extensions</p></a></li>
<li><a href='#plot_BEND'><p>Plot a BEND Model (PREM, CREM, BPREM)</p></a></li>
<li><a href='#results_bprem'><p>Fitted results for a BPREM</p></a></li>
<li><a href='#results_pcrem'><p>Fitted results for a PCREM</p></a></li>
<li><a href='#results_prem'><p>Fitted results for a PREM</p></a></li>
<li><a href='#SimData_BPREM'><p>Simulated data for a BPREM</p></a></li>
<li><a href='#SimData_PCREM'><p>Simulated data for a PCREM</p></a></li>
<li><a href='#SimData_PREM'><p>Simulated data for a PREM + Extensions</p></a></li>
<li><a href='#summary.BPREM'><p>Summarize the results of a bivariate piecewise random effects model (BPREM)</p></a></li>
<li><a href='#summary.CREM'><p>Summarize the results of a crossed random effects model (CREM)</p></a></li>
<li><a href='#summary.PREM'><p>Summarize the results of a piecewise random effects model (PREM)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Bayesian Estimation of Nonlinear Data (BEND)</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a set of models to estimate nonlinear longitudinal data using Bayesian estimation methods. These models include the: 1) Bayesian Piecewise Random Effects Model (Bayes_PREM()) which estimates a piecewise random effects (mixture) model for a given number of latent classes and a latent number of possible changepoints in each class, and can incorporate class and outcome predictive covariates (see Lamm (2022) <a href="https://hdl.handle.net/11299/252533">https://hdl.handle.net/11299/252533</a> and Lock et al., (2018) &lt;<a href="https://doi.org/10.1007%2Fs11336-017-9594-5">doi:10.1007/s11336-017-9594-5</a>&gt;), 2) Bayesian Crossed Random Effects Model (Bayes_CREM()) which estimates a linear, quadratic, exponential, or piecewise crossed random effects models where individuals are changing groups over time (e.g., students and schools; see Rohloff et al., (2024) &lt;<a href="https://doi.org/10.1111%2Fbmsp.12334">doi:10.1111/bmsp.12334</a>&gt;), and 3) Bayesian Bivariate Piecewise Random Effects Model (Bayes_BPREM()) which estimates a bivariate piecewise random effects model to jointly model two related outcomes (e.g., reading and math achievement; see Peralta et al., (2022) &lt;<a href="https://doi.org/10.1037%2Fmet0000358">doi:10.1037/met0000358</a>&gt;). </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/crohlo/BEND">https://github.com/crohlo/BEND</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/crohlo/BEND/issues">https://github.com/crohlo/BEND/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>coda (&ge; 0.19.4), label.switching (&ge; 1.8), rjags (&ge; 4.14)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-22 21:31:23 UTC; CorissaW</td>
</tr>
<tr>
<td>Author:</td>
<td>Corissa T. Rohloff
    <a href="https://orcid.org/0000-0003-3228-4653"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Rik Lamm <a href="https://orcid.org/0000-0002-3317-6243"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Yadira Peralta <a href="https://orcid.org/0000-0003-4823-6939"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Nidhi Kohli <a href="https://orcid.org/0000-0003-4690-2854"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Eric F. Lock <a href="https://orcid.org/0000-0003-4663-2356"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Corissa T. Rohloff &lt;corissa.wurth@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-23 11:42:42 UTC</td>
</tr>
</table>
<hr>
<h2 id='Bayes_BPREM'>Bayesian Bivariate Piecewise Random Effects Model (BPREM)</h2><span id='topic+Bayes_BPREM'></span>

<h3>Description</h3>

<p>Estimates a Bayesian bivariate piecewise random effects models (BPREM) for longitudinal data with two interrelated outcomes. See Peralta et al. (2022) for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bayes_BPREM(
  data,
  id_var,
  time_var,
  y1_var,
  y2_var,
  iters_adapt = 5000,
  iters_burn_in = 1e+05,
  iters_sampling = 50000,
  thin = 15,
  save_full_chains = FALSE,
  save_conv_chains = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bayes_BPREM_+3A_data">data</code></td>
<td>
<p>Data frame in long format, where each row describes a measurement occasion for a given individual. It is assumed that each individual has the same number of assigned timepoints (a.k.a., rows). There can be missingness in the outcomes (<code>y1_var</code> and <code> y2_var</code>), but there cannot be missingness in time (<code>time_var</code>).</p>
</td></tr>
<tr><td><code id="Bayes_BPREM_+3A_id_var">id_var</code></td>
<td>
<p>Name of column that contains ids for individuals with repeated measures in a longitudinal dataset.</p>
</td></tr>
<tr><td><code id="Bayes_BPREM_+3A_time_var">time_var</code></td>
<td>
<p>Name of column that contains the time variable. This column cannot contain any missing values.</p>
</td></tr>
<tr><td><code id="Bayes_BPREM_+3A_y1_var">y1_var</code></td>
<td>
<p>Name of column that contains the first outcome variable. Missing values should be denoted by NA.</p>
</td></tr>
<tr><td><code id="Bayes_BPREM_+3A_y2_var">y2_var</code></td>
<td>
<p>Name of column that contains the second outcome variable. Missing values should be denoted by NA.</p>
</td></tr>
<tr><td><code id="Bayes_BPREM_+3A_iters_adapt">iters_adapt</code></td>
<td>
<p>(optional) Number of iterations for adaptation of jags model (default = 5000).</p>
</td></tr>
<tr><td><code id="Bayes_BPREM_+3A_iters_burn_in">iters_burn_in</code></td>
<td>
<p>(optional) Number of iterations for burn-in (default = 100000).</p>
</td></tr>
<tr><td><code id="Bayes_BPREM_+3A_iters_sampling">iters_sampling</code></td>
<td>
<p>(optional) Number of iterations for posterior sampling (default = 50000).</p>
</td></tr>
<tr><td><code id="Bayes_BPREM_+3A_thin">thin</code></td>
<td>
<p>(optional) Thinning interval for posterior sampling (default = 15).</p>
</td></tr>
<tr><td><code id="Bayes_BPREM_+3A_save_full_chains">save_full_chains</code></td>
<td>
<p>Logical indicating whether the MCMC chains from rjags should be saved (default = FALSE). Note, this should not be used regularly as it will result in an object with a large file size.</p>
</td></tr>
<tr><td><code id="Bayes_BPREM_+3A_save_conv_chains">save_conv_chains</code></td>
<td>
<p>Logical indicating whether the MCMC chains from rjags should be saved but only for the parameters monitored for convergence (default = FALSE). This would be useful for plotting traceplots for relevant model parameters to evaluate convergence behavior. Note, this should not be used regularly as it will result in an object with a large file size.</p>
</td></tr>
<tr><td><code id="Bayes_BPREM_+3A_verbose">verbose</code></td>
<td>
<p>Logical controlling whether progress messages/bars are generated (default = TRUE).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more information on the model equation and priors implemented in this function, see Peralta et al. (2022).
</p>


<h3>Value</h3>

<p>A list (an object of class <code>BPREM</code>) with elements:
</p>
<table>
<tr><td><code>Convergence</code></td>
<td>
<p>Potential scale reduction factor (PSRF) for each parameter (<code>parameter_psrf</code>), Gelman multivariate scale reduction factor (<code>multivariate_psrf</code>), and mean PSRF (<code>mean_psrf</code>) to assess model convergence.</p>
</td></tr>
<tr><td><code>Model_Fit</code></td>
<td>
<p>Deviance (<code>deviance</code>), effective number of parameters (<code>pD</code>), and Deviance information criterion (<code>dic</code>) to assess model fit.</p>
</td></tr>
<tr><td><code>Fitted_Values</code></td>
<td>
<p>Vector giving the fitted value at each timepoint for each individual (same length as long data).</p>
</td></tr>
<tr><td><code>Parameter_Estimates</code></td>
<td>
<p>Data frame with posterior mean and 95% credible intervals for each model parameter.</p>
</td></tr>
<tr><td><code>Run_Time</code></td>
<td>
<p>Total run time for model fitting.</p>
</td></tr>
<tr><td><code>Full_MCMC_Chains</code></td>
<td>
<p>If save_full_chains=TRUE, raw MCMC chains from rjags.</p>
</td></tr>
<tr><td><code>Convergence_MCMC_Chains</code></td>
<td>
<p>If save_conv_chains=TRUE, raw MCMC chains from rjags but only for the parameters monitored for convergence.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Corissa T. Rohloff, Yadira Peralta
</p>


<h3>References</h3>

<p>Peralta, Y., Kohli, N., Lock, E. F., &amp; Davison, M. L. (2022). Bayesian modeling of associations in bivariate piecewise linear mixed-effects models. Psychological Methods, 27(1), 44–64. https://doi.org/10.1037/met0000358
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load simulated data
data(SimData_BPREM)
# plot observed data
plot_BEND(data = SimData_BPREM,
          id_var = "id",
          time_var = "time",
          y_var = "y1",
          y2_var = "y2")
# fit Bayes_BPREM()
results_bprem &lt;- Bayes_BPREM(data = SimData_BPREM,
                             id_var = "id",
                             time_var = "time",
                             y1_var = "y1",
                             y2_var = "y2")
# result summary
summary(results_bprem)
# plot fitted results
plot_BEND(data = SimData_BPREM,
          id_var = "id",
          time_var = "time",
          y_var = "y1",
          y2_var = "y2",
          results = results_bprem)


</code></pre>

<hr>
<h2 id='Bayes_CREM'>Bayesian Crossed Random Effects Model (CREM)</h2><span id='topic+Bayes_CREM'></span>

<h3>Description</h3>

<p>Estimates a Bayesian crossed random effects models (CREM) for longitudinal data with dynamic group membership. Four different choices for functional forms are provided: linear, quadratic, exponential, and piecewise. See Rohloff et al. (2024) for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bayes_CREM(
  data,
  ind_id_var,
  cross_id_var,
  time_var,
  y_var,
  form = "linear",
  fixed_effects = NULL,
  iters_adapt = 5000,
  iters_burn_in = 50000,
  iters_sampling = 50000,
  thin = 15,
  save_full_chains = FALSE,
  save_conv_chains = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bayes_CREM_+3A_data">data</code></td>
<td>
<p>Data frame in long format, where each row describes a measurement occasion for a given individual. It is assumed that each individual has the same number of assigned timepoints (a.k.a., rows). There can be missingness in the outcome (<code>y_var</code>), but there cannot be missingness in time (<code>time_var</code>).</p>
</td></tr>
<tr><td><code id="Bayes_CREM_+3A_ind_id_var">ind_id_var</code></td>
<td>
<p>Name of column that contains ids for individuals with repeated measures in a longitudinal dataset (e.g., students).</p>
</td></tr>
<tr><td><code id="Bayes_CREM_+3A_cross_id_var">cross_id_var</code></td>
<td>
<p>Name of column that contains ids for the crossed factor (e.g., teachers).</p>
</td></tr>
<tr><td><code id="Bayes_CREM_+3A_time_var">time_var</code></td>
<td>
<p>Name of column that contains the time variable. This column cannot contain any missing values.</p>
</td></tr>
<tr><td><code id="Bayes_CREM_+3A_y_var">y_var</code></td>
<td>
<p>Name of column that contains the outcome variable. Missing values should be denoted by NA.</p>
</td></tr>
<tr><td><code id="Bayes_CREM_+3A_form">form</code></td>
<td>
<p>Name of the functional form. Options include: ‘linear’ (default), ‘quadratic’, ‘exponential’, ‘piecewise’.</p>
</td></tr>
<tr><td><code id="Bayes_CREM_+3A_fixed_effects">fixed_effects</code></td>
<td>
<p>(optional) Starting values for the fixed effects parameters.</p>
</td></tr>
<tr><td><code id="Bayes_CREM_+3A_iters_adapt">iters_adapt</code></td>
<td>
<p>(optional) Number of iterations for adaptation of jags model (default = 5000).</p>
</td></tr>
<tr><td><code id="Bayes_CREM_+3A_iters_burn_in">iters_burn_in</code></td>
<td>
<p>(optional) Number of iterations for burn-in (default = 50000).</p>
</td></tr>
<tr><td><code id="Bayes_CREM_+3A_iters_sampling">iters_sampling</code></td>
<td>
<p>(optional) Number of iterations for posterior sampling (default = 50000).</p>
</td></tr>
<tr><td><code id="Bayes_CREM_+3A_thin">thin</code></td>
<td>
<p>(optional) Thinning interval for posterior sampling (default = 15).</p>
</td></tr>
<tr><td><code id="Bayes_CREM_+3A_save_full_chains">save_full_chains</code></td>
<td>
<p>Logical indicating whether the MCMC chains from rjags should be saved (default = FALSE). Note, this should not be used regularly as it will result in an object with a large file size.</p>
</td></tr>
<tr><td><code id="Bayes_CREM_+3A_save_conv_chains">save_conv_chains</code></td>
<td>
<p>Logical indicating whether the MCMC chains from rjags should be saved but only for the parameters monitored for convergence (default = FALSE). This would be useful for plotting traceplots for relevant model parameters to evaluate convergence behavior. Note, this should not be used regularly as it will result in an object with a large file size.</p>
</td></tr>
<tr><td><code id="Bayes_CREM_+3A_verbose">verbose</code></td>
<td>
<p>Logical controlling whether progress messages/bars are generated (default = TRUE).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more information on the model equation and priors implemented in this function, see Rohloff et al. (2024).
</p>
<p>Note, this function differs from the above reference by estimating the covariances between the random effects parameters. The variance-covariance matrices of the individual and group random effects have a scaled inverse-Wishart prior (see Peralta et al., 2022).
</p>


<h3>Value</h3>

<p>A list (an object of class <code>CREM</code>) with elements:
</p>
<table>
<tr><td><code>Convergence</code></td>
<td>
<p>Potential scale reduction factor (PSRF) for each parameter (<code>parameter_psrf</code>), Gelman multivariate scale reduction factor (<code>multivariate_psrf</code>), and mean PSRF (<code>mean_psrf</code>) to assess model convergence.</p>
</td></tr>
<tr><td><code>Model_Fit</code></td>
<td>
<p>Deviance (<code>deviance</code>), effective number of parameters (<code>pD</code>), and Deviance information criterion (<code>dic</code>) to assess model fit.</p>
</td></tr>
<tr><td><code>Fitted_Values</code></td>
<td>
<p>Vector giving the fitted value at each timepoint for each individual (same length as long data).</p>
</td></tr>
<tr><td><code>Functional_Form</code></td>
<td>
<p>Functional form fitted.</p>
</td></tr>
<tr><td><code>Parameter_Estimates</code></td>
<td>
<p>Data frame with posterior mean and 95% credible intervals for each model parameter.</p>
</td></tr>
<tr><td><code>Run_Time</code></td>
<td>
<p>Total run time for model fitting.</p>
</td></tr>
<tr><td><code>Full_MCMC_Chains</code></td>
<td>
<p>If save_full_chains=TRUE, raw MCMC chains from rjags.</p>
</td></tr>
<tr><td><code>Convergence_MCMC_Chains</code></td>
<td>
<p>If save_conv_chains=TRUE, raw MCMC chains from rjags but only for the parameters monitored for convergence.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Corissa T. Rohloff
</p>


<h3>References</h3>

<p>Peralta, Y., Kohli, N., Lock, E. F., &amp; Davison, M. L. (2022). Bayesian modeling of associations in bivariate piecewise linear mixed-effects models. Psychological Methods, 27(1), 44–64. https://doi.org/10.1037/met0000358
</p>
<p>Rohloff, C. T., Kohli, N., &amp; Lock, E. F. (2024). Identifiability and estimability of Bayesian linear and nonlinear crossed random effects models. British Journal of Mathematical and Statistical Psychology. https://doi.org/10.1111/bmsp.12334
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load simulated data
data(SimData_PCREM)
# plot observed data
plot_BEND(data = SimData_PCREM,
          id_var = "id",
          time_var = "time",
          y_var = "y")
# fit Bayes_CREM()
results_pcrem &lt;- Bayes_CREM(data = SimData_PCREM,
                            ind_id_var = "id",
                            cross_id_var = "teacherid",
                            time_var = "time",
                            y_var = "y",
                            form="piecewise")
# result summary
summary(results_pcrem)
# plot fitted results
plot_BEND(data = SimData_PCREM,
          id_var = "id",
          time_var = "time",
          y_var = "y",
          results = results_pcrem)


</code></pre>

<hr>
<h2 id='Bayes_PREM'>Bayesian Piecewise Random Effects Model (PREM) + Extensions</h2><span id='topic+Bayes_PREM'></span>

<h3>Description</h3>

<p>Estimates a Bayesian piecewise random effects model (PREM), with some useful extensions. There are three model options included in this function:
</p>

<ul>
<li> <p><code>PREM</code> estimates a Bayesian piecewise random effects model with a latent number of changepoints (default). Allows the inclusion of outcome-predictive covariates (<code>CI-PREM</code>).
</p>
</li>
<li> <p><code>PREMM</code> estimates a piecewise random effects mixture model for a given number of latent classes and a latent number of possible changepoints in each class.
</p>
</li>
<li> <p><code>CI-PREMM</code> estimates a covariate influenced piecewise random effects mixture model for a given number of latent classes and a latent number of possible changepoints in each class. Allows the inclusion of outcome- and/or class-predictive covariates.
See Lock et al. (2018) and Lamm (2022) for more details.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>Bayes_PREM(
  data,
  id_var,
  time_var,
  y_var,
  n_class = 1,
  max_cp = 2,
  class_predictive_vars = NULL,
  outcome_predictive_vars = NULL,
  scale_prior = "uniform",
  alpha = 1,
  cp_prior = "binomial",
  binom_prob = 0.5,
  iters_adapt = 1000,
  iters_burn_in = 20000,
  iters_sampling = 30000,
  thin = 15,
  save_full_chains = FALSE,
  save_conv_chains = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bayes_PREM_+3A_data">data</code></td>
<td>
<p>Data frame in long format, where each row describes a measurement occasion for a given individual. It is assumed that each individual has the same number of assigned timepoints (a.k.a., rows). There can be missingness in the outcome (<code>y_var</code>), but there cannot be missingness in time (<code>time_var</code>).</p>
</td></tr>
<tr><td><code id="Bayes_PREM_+3A_id_var">id_var</code></td>
<td>
<p>Name of column that contains ids for individuals with repeated measures in a longitudinal dataset.</p>
</td></tr>
<tr><td><code id="Bayes_PREM_+3A_time_var">time_var</code></td>
<td>
<p>Name of column that contains the time variable. This column cannot contain any missing values.</p>
</td></tr>
<tr><td><code id="Bayes_PREM_+3A_y_var">y_var</code></td>
<td>
<p>Name of column that contains the outcome variable. Missing values should be denoted by NA.</p>
</td></tr>
<tr><td><code id="Bayes_PREM_+3A_n_class">n_class</code></td>
<td>
<p>Number of latent classes (default = 1). Note, CI-PREMM only allows for two classes.</p>
</td></tr>
<tr><td><code id="Bayes_PREM_+3A_max_cp">max_cp</code></td>
<td>
<p>Maximum number of changepoints in each latent class (default = 2).</p>
</td></tr>
<tr><td><code id="Bayes_PREM_+3A_class_predictive_vars">class_predictive_vars</code></td>
<td>
<p>Name(s) of column(s) that contain class-predictive covariates (time-invariant only). Give a vector of names if multiple covariates. Note, there cannot be any missingness in the covariates.</p>
</td></tr>
<tr><td><code id="Bayes_PREM_+3A_outcome_predictive_vars">outcome_predictive_vars</code></td>
<td>
<p>Name(s) of column(s) that contain outcome-predictive covariates (time-varying or -invariant). Give a vector of names if multiple covariates. Note, there cannot be any missingness in the covariates.</p>
</td></tr>
<tr><td><code id="Bayes_PREM_+3A_scale_prior">scale_prior</code></td>
<td>
<p>Prior for the scale parameter for the hierarchical random effects. Options include: ‘uniform’ (scaled uniform prior; default) or ‘hc’ (scaled half-cauchy prior).</p>
</td></tr>
<tr><td><code id="Bayes_PREM_+3A_alpha">alpha</code></td>
<td>
<p>Concentration parameter for Dirichlet prior for latent classes (default = 1). This can be a vector of values corresponding to the number of classes (specified by n_class). Note, this is not used for CI-PGMM.</p>
</td></tr>
<tr><td><code id="Bayes_PREM_+3A_cp_prior">cp_prior</code></td>
<td>
<p>Prior for the number of changepoints in each class. Options include: 'binomial' (default) or 'uniform'.</p>
</td></tr>
<tr><td><code id="Bayes_PREM_+3A_binom_prob">binom_prob</code></td>
<td>
<p>Probability for binomial prior, if specified (default = 0.5).</p>
</td></tr>
<tr><td><code id="Bayes_PREM_+3A_iters_adapt">iters_adapt</code></td>
<td>
<p>(optional) Number of iterations for adaptation of jags model (default = 1000).</p>
</td></tr>
<tr><td><code id="Bayes_PREM_+3A_iters_burn_in">iters_burn_in</code></td>
<td>
<p>(optional) Number of iterations for burn-in (default = 20000).</p>
</td></tr>
<tr><td><code id="Bayes_PREM_+3A_iters_sampling">iters_sampling</code></td>
<td>
<p>(optional) Number of iterations for posterior sampling (default = 30000).</p>
</td></tr>
<tr><td><code id="Bayes_PREM_+3A_thin">thin</code></td>
<td>
<p>(optional) Thinning interval for posterior sampling (default = 15).</p>
</td></tr>
<tr><td><code id="Bayes_PREM_+3A_save_full_chains">save_full_chains</code></td>
<td>
<p>Logical indicating whether the MCMC chains from rjags should be saved (default = FALSE). Note, this should not be used regularly as it will result in an object with a large file size.</p>
</td></tr>
<tr><td><code id="Bayes_PREM_+3A_save_conv_chains">save_conv_chains</code></td>
<td>
<p>Logical indicating whether the MCMC chains from rjags should be saved but only for the parameters monitored for convergence (default = FALSE). This would be useful for plotting traceplots for relevant model parameters to evaluate convergence behavior. Note, this should not be used regularly as it will result in an object with a large file size.</p>
</td></tr>
<tr><td><code id="Bayes_PREM_+3A_verbose">verbose</code></td>
<td>
<p>Logical controlling whether progress messages/bars are generated (default = TRUE).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more information on the model equation and priors implemented in this function, see Lamm et al. (2022; CI-PREMM) and Lock et al. (2018; PREMM).
</p>


<h3>Value</h3>

<p>A list (an object of class <code>PREM</code>) with elements:
</p>
<table>
<tr><td><code>Convergence</code></td>
<td>
<p>Potential scale reduction factor (PSRF) for each parameter (<code>parameter_psrf</code>), Gelman multivariate scale reduction factor (<code>multivariate_psrf</code>), and mean PSRF (<code>mean_psrf</code>) to assess model convergence.</p>
</td></tr>
<tr><td><code>Model_Fit</code></td>
<td>
<p>Deviance (<code>deviance</code>), effective number of parameters (<code>pD</code>), and Deviance information criterion (<code>dic</code>) to assess model fit.</p>
</td></tr>
<tr><td><code>Fitted_Values</code></td>
<td>
<p>Vector giving the fitted value at each timepoint for each individual (same length as long data).</p>
</td></tr>
<tr><td><code>Parameter_Estimates</code></td>
<td>
<p>Data frame with posterior mean and 95% credible intervals for each model parameter.</p>
</td></tr>
<tr><td><code>Run_Time</code></td>
<td>
<p>Total run time for model fitting.</p>
</td></tr>
<tr><td><code>Full_MCMC_Chains</code></td>
<td>
<p>If save_full_chains=TRUE, raw MCMC chains from rjags.</p>
</td></tr>
<tr><td><code>Convergence_MCMC_Chains</code></td>
<td>
<p>If save_conv_chains=TRUE, raw MCMC chains from rjags but only for the parameters monitored for convergence.</p>
</td></tr>
</table>
<p><code>Class_Information</code> contains a list with elements:
</p>
<table>
<tr><td><code>class_membership</code></td>
<td>
<p>Vector of length n with class membership assignments for each individual.</p>
</td></tr>
<tr><td><code>individ_class_probability</code></td>
<td>
<p>nxC matrix with each individual’s probabilities of belonging to each class conditional on their class-predictive covariates (when applicable) and growth curve.</p>
</td></tr>
<tr><td><code>unconditional_class_probability</code></td>
<td>
<p>This output will differ based on which model was fit. For a PREM or CI-PREM, this will equal 1 as there is only one class. For a PREMM or CI-PREMM with only outcome-predictive covariates, this will be a vector of length C denoting the population probability of belonging to each class. For a CI-PREMM with class-predictive covariates, this will be a vector of length n denoting the probability of each individual belonging to the non-reference class (Class 2) based on their class-predictive covariates only.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Corissa T. Rohloff, Rik Lamm, Eric F. Lock
</p>


<h3>References</h3>

<p>Lamm, R. (2022). Incorporation of covariates in Bayesian piecewise growth mixture models. https://hdl.handle.net/11299/252533
</p>
<p>Lock, E. F., Kohli, N., &amp; Bose, M. (2018). Detecting multiple random changepoints in Bayesian piecewise growth mixture models. Psychometrika, 83(3), 733–750. https://doi.org/10.1007/s11336-017-9594-5
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load simulated data
data(SimData_PREM)
# plot observed data
plot_BEND(data = SimData_PREM,
          id_var = "id",
          time_var = "time",
          y_var = "y")

# PREM ---------------------------------------------------------------------------------
# fit Bayes_PREM()
results_prem &lt;- Bayes_PREM(data = SimData_PREM,
                           id_var = "id",
                           time_var = "time",
                           y_var = "y")
# result summary
summary(results_prem)
# plot fitted results
plot_BEND(data = SimData_PREM,
          id_var = "id",
          time_var = "time",
          y_var = "y",
          results = results_prem)

# CI-PREM ---------------------------------------------------------------------------------
# fit Bayes_PREM()
results_ciprem &lt;- Bayes_PREM(data = SimData_PREM,
                             id_var = "id",
                             time_var = "time",
                             y_var = "y",
                             outcome_predictive_vars = "outcome_pred_1")
# result summary
summary(results_ciprem)
# plot fitted results
plot_BEND(data = SimData_PREM,
          id_var = "id",
          time_var = "time",
          y_var = "y",
          results = results_ciprem)

# PREMM ---------------------------------------------------------------------------------
# fit Bayes_PREM()
results_premm &lt;- Bayes_PREM(data = SimData_PREM,
                            id_var = "id",
                            time_var = "time",
                            y_var = "y",
                            n_class = 2)
# result summary
summary(results_premm)
# plot fitted results
plot_BEND(data = SimData_PREM,
          id_var = "id",
          time_var = "time",
          y_var = "y",
          results = results_premm)


# CI-PREMM ---------------------------------------------------------------------------------
# fit Bayes_PREM()
results_cipremm &lt;- Bayes_PREM(data = SimData_PREM,
                              id_var = "id",
                              time_var = "time",
                              y_var = "y",
                              n_class = 2,
                              class_predictive_vars = c("class_pred_1", "class_pred_2"),
                              outcome_predictive_vars = "outcome_pred_1")
# result summary
summary(results_cipremm)
# plot fitted results
plot_BEND(data = SimData_PREM,
          id_var = "id",
          time_var = "time",
          y_var = "y",
          results = results_cipremm)


</code></pre>

<hr>
<h2 id='plot_BEND'>Plot a BEND Model (PREM, CREM, BPREM)</h2><span id='topic+plot_BEND'></span>

<h3>Description</h3>

<p>Generates a &quot;spaghetti plot&quot; of observed longitudinal trajectories for each individual. If the results from a <code>BEND</code> function are supplied, the trajectory defined by the mean parameters is shown in bold. If fitting a mixture (<code>PREMM</code> or <code>CI-PREMM</code>) or bivariate model (<code>BPREM</code>), the mean trajectories for classes or outcomes will be distinguished by color.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_BEND(
  data,
  id_var,
  time_var,
  y_var,
  y2_var = NULL,
  results = NULL,
  xlab = "X",
  ylab = "Y",
  colors = NULL,
  mean_colors = NULL,
  legend_pos = "topright",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_BEND_+3A_data">data</code></td>
<td>
<p>Data frame in long format, where each row describes a measurement occasion for a given individual. It is assumed that each individual has the same number of assigned timepoints (a.k.a., rows).</p>
</td></tr>
<tr><td><code id="plot_BEND_+3A_id_var">id_var</code></td>
<td>
<p>Name of column that contains ids for individuals with repeated measures in a longitudinal dataset.</p>
</td></tr>
<tr><td><code id="plot_BEND_+3A_time_var">time_var</code></td>
<td>
<p>Name of column that contains the time variable.</p>
</td></tr>
<tr><td><code id="plot_BEND_+3A_y_var">y_var</code></td>
<td>
<p>Name of column that contains the outcome variable.</p>
</td></tr>
<tr><td><code id="plot_BEND_+3A_y2_var">y2_var</code></td>
<td>
<p>(for <code>BPREM</code> only) Name of column that contains the second outcome variable.</p>
</td></tr>
<tr><td><code id="plot_BEND_+3A_results">results</code></td>
<td>
<p>The output of <code>BEND</code> model to the data. If results=NULL, only a spaghetti plot of the data will be generated.</p>
</td></tr>
<tr><td><code id="plot_BEND_+3A_xlab">xlab</code></td>
<td>
<p>X-axis label for the generated plot.</p>
</td></tr>
<tr><td><code id="plot_BEND_+3A_ylab">ylab</code></td>
<td>
<p>Y-axis label for the generated plot.</p>
</td></tr>
<tr><td><code id="plot_BEND_+3A_colors">colors</code></td>
<td>
<p>Colors for each class (<code>PREMM</code> or <code>CI-PREMM</code>) or outcome (<code>BPREM</code>). By default, up to 5 colors are provided in the following order: “blue” (class 1 and outcome 1), “red” (class 2 and outcome 2), “green” (class 3), “gold” (class 4), “gray” (class 5).</p>
</td></tr>
<tr><td><code id="plot_BEND_+3A_mean_colors">mean_colors</code></td>
<td>
<p>Colors for the trajectory defined by the mean parameters for each class (<code>PREMM</code> or <code>CI-PREMM</code>) or outcome (<code>BPREM</code>). By default, up to 5 colors are provided in the following order: “darkblue” (class 1 and outcome 1), “darkred” (class 2 and outcome 2), “darkgreen” (class 3), “gold4” (class 4), “darkgray” (class 5).</p>
</td></tr>
<tr><td><code id="plot_BEND_+3A_legend_pos">legend_pos</code></td>
<td>
<p>(optional) Option to change legend position (default = &quot;topright&quot;).</p>
</td></tr>
<tr><td><code id="plot_BEND_+3A_...">...</code></td>
<td>
<p>(optional) Other parameters to pass to the <code>plot()</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called to generate plot.
</p>


<h3>Author(s)</h3>

<p>Corissa T. Rohloff
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load simulated data
data(SimData_PREM)
# plot observed data
plot_BEND(data = SimData_PREM,
          id_var = "id",
          time_var = "time",
          y_var = "y")
# load fitted model results
data(results_prem)
# plot fitted results
plot_BEND(data = SimData_PREM,
          id_var = "id",
          time_var = "time",
          y_var = "y",
          results = results_prem)

</code></pre>

<hr>
<h2 id='results_bprem'>Fitted results for a BPREM</h2><span id='topic+results_bprem'></span>

<h3>Description</h3>

<p>Simulated data for a bivariate piecewise random effects model (BPREM) using <code>SimData_BPREM</code>. Included to demonstrate the use of <code>summary.BPREM()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(results_bprem)
</code></pre>


<h3>Format</h3>

<p>A list (an object of class <code>BPREM</code>) with fitted model results.
</p>

<hr>
<h2 id='results_pcrem'>Fitted results for a PCREM</h2><span id='topic+results_pcrem'></span>

<h3>Description</h3>

<p>Simulated data for a piecewise crossed random effects model (PCREM) using <code>SimData_CREM</code>. Included to demonstrate the use of <code>summary.CREM()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(results_pcrem)
</code></pre>


<h3>Format</h3>

<p>A list (an object of class <code>CREM</code>) with fitted model results.
</p>

<hr>
<h2 id='results_prem'>Fitted results for a PREM</h2><span id='topic+results_prem'></span>

<h3>Description</h3>

<p>Fitted results for a piecewise random effects model (PREM) using <code>SimData_PREM</code>. Included to demonstrate the use of <code>plot_BEND()</code> and <code>summary.PREM()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(results_prem)
</code></pre>


<h3>Format</h3>

<p>A list (an object of class <code>PREM</code>) with fitted model results.
</p>

<hr>
<h2 id='SimData_BPREM'>Simulated data for a BPREM</h2><span id='topic+SimData_BPREM'></span>

<h3>Description</h3>

<p>Simulated data for a bivariate piecewise random effects model (BPREM) with 7 timepoints collected on 30 individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SimData_BPREM)
</code></pre>


<h3>Format</h3>

<p>A data frame with 210 rows and 4 variables.
</p>


<h3>Details</h3>


<ul>
<li> <p><code>id</code> ID for each individual.
</p>
</li>
<li> <p><code>time</code> Timepoints for each individual.
</p>
</li>
<li> <p><code>y1</code> Outcome 1.
</p>
</li>
<li> <p><code>y2</code> Outcome 2.
</p>
</li></ul>


<hr>
<h2 id='SimData_PCREM'>Simulated data for a PCREM</h2><span id='topic+SimData_PCREM'></span>

<h3>Description</h3>

<p>Simulated data for a piecewise crossed random effects model (PCREM) with 7 timepoints collected on 30 individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SimData_PCREM)
</code></pre>


<h3>Format</h3>

<p>A data frame with 210 rows and 4 variables.
</p>


<h3>Details</h3>


<ul>
<li> <p><code>id</code> ID for each individual.
</p>
</li>
<li> <p><code>teacherid</code> ID for each teacher.
</p>
</li>
<li> <p><code>time</code> Timepoints for each individual.
</p>
</li>
<li> <p><code>y</code> Outcome.
</p>
</li></ul>


<hr>
<h2 id='SimData_PREM'>Simulated data for a PREM + Extensions</h2><span id='topic+SimData_PREM'></span>

<h3>Description</h3>

<p>Simulated data for a piecewise random effects model (PREM) and useful extensions (CI-PREM, PREMM, CI-PREMM) with 18 timepoints collected on 30 individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SimData_PREM)
</code></pre>


<h3>Format</h3>

<p>A data frame with 540 rows and 6 variables.
</p>


<h3>Details</h3>


<ul>
<li> <p><code>id</code> ID for each individual.
</p>
</li>
<li> <p><code>time</code> Timepoints for each individual.
</p>
</li>
<li> <p><code>y</code> Outcome.
</p>
</li>
<li> <p><code>class_pred_1</code> First class predictive covariate (time-invariant).
</p>
</li>
<li> <p><code>class_pred_2</code> Second class predictive covariate (time-invariant).
</p>
</li>
<li> <p><code>outcome_pred_1</code> Outcome predictive covariate (time-varying).
</p>
</li></ul>


<hr>
<h2 id='summary.BPREM'>Summarize the results of a bivariate piecewise random effects model (BPREM)</h2><span id='topic+summary.BPREM'></span>

<h3>Description</h3>

<p>Provides a summary of a BPREM model, as returned by <code>Bayes_BPREM()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BPREM'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.BPREM_+3A_object">object</code></td>
<td>
<p>An object of class &quot;BPREM&quot; (returned by <code>Bayes_BPREM(...)</code>).</p>
</td></tr>
<tr><td><code id="summary.BPREM_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints estimates for key parameters in the BPREM. Also returns a list of these values.
</p>


<h3>Author(s)</h3>

<p>Corissa T. Rohloff
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load fitted model results
data(results_bprem)
# result summary
summary(results_bprem)

</code></pre>

<hr>
<h2 id='summary.CREM'>Summarize the results of a crossed random effects model (CREM)</h2><span id='topic+summary.CREM'></span>

<h3>Description</h3>

<p>Provides a summary of a CREM model, as returned by <code>Bayes_CREM()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CREM'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.CREM_+3A_object">object</code></td>
<td>
<p>An object of class &quot;CREM&quot; (returned by <code>Bayes_CREM(...)</code>).</p>
</td></tr>
<tr><td><code id="summary.CREM_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints estimates for key parameters in the CREM. Also returns a list of these values.
</p>


<h3>Author(s)</h3>

<p>Corissa T. Rohloff
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load fitted model results
data(results_pcrem)
# result summary
summary(results_pcrem)

</code></pre>

<hr>
<h2 id='summary.PREM'>Summarize the results of a piecewise random effects model (PREM)</h2><span id='topic+summary.PREM'></span>

<h3>Description</h3>

<p>Provides a summary of a PREM model, as returned by <code>Bayes_PREM()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PREM'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.PREM_+3A_object">object</code></td>
<td>
<p>An object of class &quot;PREM&quot; (returned by <code>Bayes_PREM(...)</code>).</p>
</td></tr>
<tr><td><code id="summary.PREM_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints estimates for key parameters in the PREM. Also returns a list of these values.
</p>


<h3>Author(s)</h3>

<p>Corissa T. Rohloff
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load fitted model results
data(results_prem)
# result summary
summary(results_prem)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
