<!DOCTYPE html><html><head><title>Help for package biogrowth</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {biogrowth}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#biogrowth-package'><p>biogrowth: Modelling of Population Growth</p></a></li>
<li><a href='#approx_env'><p>Generates functions for linear interpolation of environmental conditions</p></a></li>
<li><a href='#arabian_tractors'><p>Number of tractors in the Arab World according to the World Bank</p></a></li>
<li><a href='#calculate_gammas'><p>Calculates every gamma factor</p></a></li>
<li><a href='#calculate_gammas_secondary'><p>Gamma factors for fitting secondary models</p></a></li>
<li><a href='#check_growth_guess'><p>Visual check of an initial guess of the model parameters</p></a></li>
<li><a href='#check_primary_pars'><p>Basic check of parameters for primary models</p></a></li>
<li><a href='#check_secondary_pars'><p>Basic checks of secondary parameters</p></a></li>
<li><a href='#check_stochastic_pars'><p>Model definition checks for predict_stochastic_growth</p></a></li>
<li><a href='#compare_growth_fits'><p>Model comparison and selection for growth models</p></a></li>
<li><a href='#compare_secondary_fits'><p>Model comparison and selection for secondary growth models</p></a></li>
<li><a href='#conditions_pH_temperature'><p>Conditions during a dynamic growth experiment</p></a></li>
<li><a href='#CPM_model'><p>Secondary Cardinal Parameter (CPM) model</p></a></li>
<li><a href='#dBaranyi'><p>Baranyi growth model</p></a></li>
<li><a href='#distribution_to_logcount'><p>Distribution of times to reach a certain microbial count</p></a></li>
<li><a href='#DynamicGrowth'><p>DynamicGrowth class</p></a></li>
<li><a href='#example_cardinal'><p>Growth rates obtained for several growth experiments</p></a></li>
<li><a href='#example_dynamic_growth'><p>Microbial growth under dynamic conditions</p></a></li>
<li><a href='#example_env_conditions'><p>Environmental conditions during a dynamic experiment</p></a></li>
<li><a href='#extract_primary_pars'><p>A helper to build the primary models</p></a></li>
<li><a href='#extract_secondary_pars'><p>A helper to build the secondary models</p></a></li>
<li><a href='#fit_dynamic_growth'><p>Fit dynamic growth models</p></a></li>
<li><a href='#fit_growth'><p>Fitting microbial growth</p></a></li>
<li><a href='#fit_isothermal_growth'><p>Fit primary growth models</p></a></li>
<li><a href='#fit_MCMC_growth'><p>Fit growth models using MCMC</p></a></li>
<li><a href='#fit_multiple_growth'><p>Fitting growth models to multiple dynamic experiments</p></a></li>
<li><a href='#fit_multiple_growth_MCMC'><p>Fitting growth models to multiple dynamic experiments using MCMC</p></a></li>
<li><a href='#fit_secondary_growth'><p>Fit secondary growth models</p></a></li>
<li><a href='#FitDynamicGrowth'><p>FitDynamicGrowth class</p></a></li>
<li><a href='#FitDynamicGrowthMCMC'><p>FitDynamicGrowthMCMC class</p></a></li>
<li><a href='#FitIsoGrowth'><p>FitIsoGrowth class</p></a></li>
<li><a href='#FitMultipleDynamicGrowth'><p>FitMultipleDynamicGrowth class</p></a></li>
<li><a href='#FitMultipleGrowthMCMC'><p>FitMultipleGrowthMCMC class</p></a></li>
<li><a href='#FitSecondaryGrowth'><p>FitSecondaryGrowth class</p></a></li>
<li><a href='#full_Ratkowski'><p>Full Ratkowsky model</p></a></li>
<li><a href='#get_all_predictions'><p>A helper for making the plots</p></a></li>
<li><a href='#get_dyna_residuals'><p>Residuals of dynamic prediction</p></a></li>
<li><a href='#get_iso_residuals'><p>Residuals of isothermal prediction</p></a></li>
<li><a href='#get_multi_dyna_residuals'><p>Residuals of multiple dynamic predictions</p></a></li>
<li><a href='#get_secondary_residuals'><p>Residuals of secondary models</p></a></li>
<li><a href='#GlobalGrowthComparison'><p>GlobalGrowthComparison class</p></a></li>
<li><a href='#GlobalGrowthFit'><p>GlobalGrowthFit class</p></a></li>
<li><a href='#greek_tractors'><p>Number of tractors in Greece according to the World Bank</p></a></li>
<li><a href='#growth_pH_temperature'><p>Example of dynamic growth</p></a></li>
<li><a href='#growth_salmonella'><p>Growth of Salmonella spp in broth</p></a></li>
<li><a href='#GrowthComparison'><p>GrowthComparison class</p></a></li>
<li><a href='#GrowthFit'><p>GrowthFit class</p></a></li>
<li><a href='#GrowthPrediction'><p>GrowthPrediction class</p></a></li>
<li><a href='#GrowthUncertainty'><p>GrowthUncertainty class</p></a></li>
<li><a href='#is.DynamicGrowth'><p>Test of DynamicGrowth object</p></a></li>
<li><a href='#is.FitDynamicGrowth'><p>Test of FitDynamicGrowth object</p></a></li>
<li><a href='#is.FitDynamicGrowthMCMC'><p>Test of FitDynamicGrowthMCMC object</p></a></li>
<li><a href='#is.FitIsoGrowth'><p>Test of FitIsoGrowth object</p></a></li>
<li><a href='#is.FitMultipleDynamicGrowth'><p>Test of FitMultipleDynamicGrowth object</p></a></li>
<li><a href='#is.FitMultipleDynamicGrowthMCMC'><p>Test of FitMultipleDynamicGrowthMCMC object</p></a></li>
<li><a href='#is.FitSecondaryGrowth'><p>Test of FitSecondaryGrowth object</p></a></li>
<li><a href='#is.GlobalGrowthFit'><p>Test of GlobalGrowthFit object</p></a></li>
<li><a href='#is.GrowthFit'><p>Test of GrowthFit object</p></a></li>
<li><a href='#is.GrowthPrediction'><p>Test of GrowthPrediction object</p></a></li>
<li><a href='#is.GrowthUncertainty'><p>Test of GrowthUncertainty object</p></a></li>
<li><a href='#is.IsothermalGrowth'><p>Test of IsothermalGrowth object</p></a></li>
<li><a href='#is.MCMCgrowth'><p>Test of MCMCgrowth object</p></a></li>
<li><a href='#is.StochasticGrowth'><p>Test of StochasticGrowth object</p></a></li>
<li><a href='#iso_Baranyi'><p>Isothermal Baranyi model</p></a></li>
<li><a href='#iso_repGompertz'><p>Reparameterized Gompertz model</p></a></li>
<li><a href='#IsothermalGrowth'><p>IsothermalGrowth class</p></a></li>
<li><a href='#lambda_to_Q0'><p>Q0 from lag phase duration</p></a></li>
<li><a href='#logistic_model'><p>Logistic growth model</p></a></li>
<li><a href='#make_guess_factor'><p>Initial guesses for the secondary model of one factor</p></a></li>
<li><a href='#make_guess_primary'><p>Initial guesses for fitting primary growth models</p></a></li>
<li><a href='#make_guess_secondary'><p>Initial guesses for the parameters of a secondary model</p></a></li>
<li><a href='#MCMCgrowth'><p>MCMCgrowth class</p></a></li>
<li><a href='#multiple_conditions'><p>Environmental conditions during several dynamic experiments</p></a></li>
<li><a href='#multiple_counts'><p>Population growth observed in several dynamic experiments</p></a></li>
<li><a href='#multiple_experiments'><p>A set of growth experiments under dynamic conditions</p></a></li>
<li><a href='#predict_dynamic_growth'><p>Growth under dynamic conditions</p></a></li>
<li><a href='#predict_growth'><p>Prediction of microbial growth</p></a></li>
<li><a href='#predict_growth_uncertainty'><p>Isothermal growth with parameter uncertainty</p></a></li>
<li><a href='#predict_isothermal_growth'><p>Isothermal microbial growth</p></a></li>
<li><a href='#predict_MCMC_growth'><p>Stochastic growth of MCMC fit</p></a></li>
<li><a href='#predict_stochastic_growth'><p>Deprecated isothermal growth with parameter uncertainty</p></a></li>
<li><a href='#predictMCMC'><p>Generic for calculating predictions with uncertainty from fits</p></a></li>
<li><a href='#primary_model_data'><p>Metainformation of primary growth models</p></a></li>
<li><a href='#Q0_to_lambda'><p>Lag phase duration from Q0</p></a></li>
<li><a href='#refrigeratorSpain'><p>Temperature recorded in refrigerators</p></a></li>
<li><a href='#richards_model'><p>Richards growth model</p></a></li>
<li><a href='#secondary_model_data'><p>Metainformation of secondary growth models</p></a></li>
<li><a href='#SecondaryComparison'><p>SecondaryComparison class</p></a></li>
<li><a href='#show_guess_dynamic'><p>Plot of the initial guess for growth under dynamic environmental conditions</p></a></li>
<li><a href='#show_guess_primary'><p>Plot of the initial guess for growth under constant environmental conditions</p></a></li>
<li><a href='#StochasticGrowth'><p>StochasticGrowth class</p></a></li>
<li><a href='#time_to_logcount'><p>Time to reach a given microbial count</p></a></li>
<li><a href='#time_to_size'><p>Time for the population to reach a given size</p></a></li>
<li><a href='#TimeDistribution'><p>TimeDistribution class</p></a></li>
<li><a href='#trilinear_model'><p>Trilinear growth model</p></a></li>
<li><a href='#zwietering_gamma'><p>Zwietering gamma model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Modelling of Population Growth</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Modelling of population growth under static and dynamic environmental conditions. 
    Includes functions for model fitting and making prediction under isothermal and 
    dynamic conditions. The methods (algorithms &amp; models) are based on
    predictive microbiology (See Perez-Rodriguez and Valero (2012, ISBN:978-1-4614-5519-6)).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>deSolve (&ge; 1.28), tibble (&ge; 3.0.3), dplyr (&ge; 0.8.5), FME
(&ge; 1.3.6), MASS (&ge; 7.3), rlang (&ge; 0.4.7), purrr (&ge; 0.3.4),
ggplot2 (&ge; 3.3.2), cowplot (&ge; 1.0.0), lamW (&ge; 1.3.0), tidyr
(&ge; 1.0.2), formula.tools (&ge; 1.7.1), lifecycle</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, tidyverse (&ge; 1.3.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-29 10:03:57 UTC; alber</td>
</tr>
<tr>
<td>Author:</td>
<td>Alberto Garre <a href="https://orcid.org/0000-0002-4404-3550"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Jeroen Koomen [aut],
  Heidy den Besten [aut],
  Marcel Zwietering [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alberto Garre &lt;garre.alberto@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-29 12:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='biogrowth-package'>biogrowth: Modelling of Population Growth</h2><span id='topic+biogrowth'></span><span id='topic+biogrowth-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Modelling of population growth under static and dynamic environmental conditions. Includes functions for model fitting and making prediction under isothermal and dynamic conditions. The methods (algorithms &amp; models) are based on predictive microbiology (See Perez-Rodriguez and Valero (2012, ISBN:978-1-4614-5519-6)).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Alberto Garre <a href="mailto:garre.alberto@gmail.com">garre.alberto@gmail.com</a> (<a href="https://orcid.org/0000-0002-4404-3550">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Jeroen Koomen <a href="mailto:jeroen.koomen@wur.nl">jeroen.koomen@wur.nl</a>
</p>
</li>
<li><p> Heidy den Besten <a href="mailto:heidy.denbesten@wur.nl">heidy.denbesten@wur.nl</a>
</p>
</li>
<li><p> Marcel Zwietering <a href="mailto:marcel.zwietering@wur.nl">marcel.zwietering@wur.nl</a>
</p>
</li></ul>


<hr>
<h2 id='approx_env'>Generates functions for linear interpolation of environmental conditions</h2><span id='topic+approx_env'></span>

<h3>Description</h3>

<p>Generates functions for linear interpolation of environmental conditions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>approx_env(env_conditions)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="approx_env_+3A_env_conditions">env_conditions</code></td>
<td>
<p>A tibble describing the variation of the environmental
conditions through the storage time. Must contain a column named <code>time</code>
and as many additional columns as environmental factors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of functions that return the value of each environmental
condition for some storage time
</p>

<hr>
<h2 id='arabian_tractors'>Number of tractors in the Arab World according to the World Bank</h2><span id='topic+arabian_tractors'></span>

<h3>Description</h3>

<p>A dataset showing the increase in tractors in the Arab World. It was retrieved
from https://data.worldbank.org/indicator/AG.AGR.TRAC.NO?end=2009&amp;start=1961&amp;view=chart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arabian_tractors
</code></pre>


<h3>Format</h3>

<p>A tibble with 40 rows (each corresponding to one year) and 7 columns:
</p>

<dl>
<dt>year</dt><dd><p>Year for the recording</p>
</dd>
<dt>tractors</dt><dd><p>Number of tractors</p>
</dd>
</dl>


<hr>
<h2 id='calculate_gammas'>Calculates every gamma factor</h2><span id='topic+calculate_gammas'></span>

<h3>Description</h3>

<p>A helper function for <code><a href="#topic+predict_dynamic_growth">predict_dynamic_growth()</a></code> that
calculates the value of every gamma factor corresponding to some
storage time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_gammas(this_t, env_func, sec_models)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_gammas_+3A_this_t">this_t</code></td>
<td>
<p>Storage time</p>
</td></tr>
<tr><td><code id="calculate_gammas_+3A_env_func">env_func</code></td>
<td>
<p>A list of functions (generated using <code>approxfun</code>) that
give the value of each environmental function for some storage time.</p>
</td></tr>
<tr><td><code id="calculate_gammas_+3A_sec_models">sec_models</code></td>
<td>
<p>A nested list describing the secondary models.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of gamma factors (one per environmental factor).
</p>

<hr>
<h2 id='calculate_gammas_secondary'>Gamma factors for fitting secondary models</h2><span id='topic+calculate_gammas_secondary'></span>

<h3>Description</h3>

<p>A helper for fitting the secondary gamma models.
Calculates the gamma factors corresponding to the models defined
and the experimental conditions. In order for it to work, the environmental
factors must be named identically in the 3 arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_gammas_secondary(sec_model_names, my_data, secondary_models)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_gammas_secondary_+3A_sec_model_names">sec_model_names</code></td>
<td>
<p>named character vector defining the type of secondary
model. Its names correspond to the environmental conditions and its values
define the corresponding type of secondary model.</p>
</td></tr>
<tr><td><code id="calculate_gammas_secondary_+3A_my_data">my_data</code></td>
<td>
<p>Tibble of experimental conditions.</p>
</td></tr>
<tr><td><code id="calculate_gammas_secondary_+3A_secondary_models">secondary_models</code></td>
<td>
<p>A list defining the parameters of the secondary models.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric vector of length <code>nrow(my_data)</code> with the gamma factor
for each experimental condition.
</p>

<hr>
<h2 id='check_growth_guess'>Visual check of an initial guess of the model parameters</h2><span id='topic+check_growth_guess'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Generates a plot comparing a set of data points against the model prediction
corresponding to an initial guess of the model parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_growth_guess(
  fit_data,
  model_keys,
  guess,
  environment = "constant",
  env_conditions = NULL,
  approach = "single",
  logbase_mu = 10,
  formula = logN ~ time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_growth_guess_+3A_fit_data">fit_data</code></td>
<td>
<p>Tibble (or data.frame) of data for the fit. It must have two columns, one with
the elapsed time (<code>time</code> by default) and another one with the decimal logarithm
of the populatoin size (<code>logN</code> by default). Different column names can be
defined using the <code>formula</code> argument.</p>
</td></tr>
<tr><td><code id="check_growth_guess_+3A_model_keys">model_keys</code></td>
<td>
<p>Named the equations of the secondary model as in <code><a href="#topic+fit_growth">fit_growth()</a></code></p>
</td></tr>
<tr><td><code id="check_growth_guess_+3A_guess">guess</code></td>
<td>
<p>Named vector with the initial guess of the model parameters as in <code><a href="#topic+fit_growth">fit_growth()</a></code></p>
</td></tr>
<tr><td><code id="check_growth_guess_+3A_environment">environment</code></td>
<td>
<p>type of environment. Either &quot;constant&quot; (default) or &quot;dynamic&quot; (see below for details
on the calculations for each condition)</p>
</td></tr>
<tr><td><code id="check_growth_guess_+3A_env_conditions">env_conditions</code></td>
<td>
<p>Tibble describing the variation of the environmental
conditions for dynamic experiments. See <code><a href="#topic+fit_growth">fit_growth()</a></code>. Ignored when <code>environment = "constant"</code></p>
</td></tr>
<tr><td><code id="check_growth_guess_+3A_approach">approach</code></td>
<td>
<p>whether &quot;single&quot; (default) or &quot;global&quot;. Please see <code><a href="#topic+fit_growth">fit_growth()</a></code> for details.&ldquo;</p>
</td></tr>
<tr><td><code id="check_growth_guess_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, 10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
<tr><td><code id="check_growth_guess_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot; describing the x and y variables.
<code>logN ~ time</code> as a default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code> comparing the model prediction against the data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Examples under constant environmental conditions -------------------------

## We need some data

my_data &lt;- data.frame(time = 0:9,
                      logN = c(2, 2.1, 1.8, 2.5, 3.1, 3.4, 4, 4.5, 4.8, 4.7)
                      )
                      
## We can directly plot the comparison for some values

check_growth_guess(my_data, list(primary = "modGompertz"),
                   c(logN0 = 1.5, mu = .8, lambda = 4, C = 3)
                   )
                   
## Ot it can be combined with the automatic initial guess

check_growth_guess(my_data, list(primary = "modGompertz"),
                   make_guess_primary(my_data, "modGompertz")
                   )
                   
## Examples under dynamic environmental conditions --------------------------

## We will use the datasets included in the package

data("example_dynamic_growth")
data("example_env_conditions")

## Model equations are assigned as in fit_growth

sec_models &lt;- list(temperature = "CPM", aw = "CPM")

## Guesses of model parameters are also defined as in fit_growth

guess &lt;- list(Nmax = 1e4, 
              N0 = 1e0, Q0 = 1e-3,
              mu_opt = 4, 
              temperature_n = 1,
              aw_xmax = 1, aw_xmin = .9, aw_n = 1,
              temperature_xmin = 25, temperature_xopt = 35,
              temperature_xmax = 40, aw_xopt = .95
              )
              
## We can now check our initial guess

check_growth_guess(example_dynamic_growth, sec_models, guess,
                   "dynamic",
                   example_env_conditions)

</code></pre>

<hr>
<h2 id='check_primary_pars'>Basic check of parameters for primary models</h2><span id='topic+check_primary_pars'></span>

<h3>Description</h3>

<p>Checks that: the model name is correct, the right number of model
parameters have been defined and that the parameters have the right names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_primary_pars(model_name, pars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_primary_pars_+3A_model_name">model_name</code></td>
<td>
<p>Model identifier</p>
</td></tr>
<tr><td><code id="check_primary_pars_+3A_pars">pars</code></td>
<td>
<p>A named list of model parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If there is no error, the model function.
</p>

<hr>
<h2 id='check_secondary_pars'>Basic checks of secondary parameters</h2><span id='topic+check_secondary_pars'></span>

<h3>Description</h3>

<p>Checks that the model names are correct, that no parameter is defined twice,
that every parameter is defined and that no unknown parameter has been defined.
Raises an error if any of these conditions is not met.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_secondary_pars(
  starting_point,
  known_pars,
  sec_model_names,
  primary_pars = "mu_opt"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_secondary_pars_+3A_starting_point">starting_point</code></td>
<td>
<p>Named vector with initial values for the model parameters
to estimate from the data. The growth rate under optimum conditions must be named
<code>mu_opt</code>. The rest must be called 'env_factor'+'_'+'parameter'. For instance,
the minimum pH for growth is 'pH_xmin'.</p>
</td></tr>
<tr><td><code id="check_secondary_pars_+3A_known_pars">known_pars</code></td>
<td>
<p>Named vector of fixed model parameters. Must be named using the
same convention as <code>starting_point</code>.</p>
</td></tr>
<tr><td><code id="check_secondary_pars_+3A_sec_model_names">sec_model_names</code></td>
<td>
<p>Named character vector defining the secondary model
for each environmental factor.</p>
</td></tr>
<tr><td><code id="check_secondary_pars_+3A_primary_pars">primary_pars</code></td>
<td>
<p>Character vector with the parameter names of the primary model.</p>
</td></tr>
</table>

<hr>
<h2 id='check_stochastic_pars'>Model definition checks for predict_stochastic_growth</h2><span id='topic+check_stochastic_pars'></span>

<h3>Description</h3>

<p>Does several checks of the model parameters. Besides those by
check_primary_pars, it checks that corr_matrix is square, that pars and
corr_matrix have compatible dimensions, and that pars has the correct names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_stochastic_pars(model_name, pars, corr_matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_stochastic_pars_+3A_model_name">model_name</code></td>
<td>
<p>Character describing the primary growth model.</p>
</td></tr>
<tr><td><code id="check_stochastic_pars_+3A_pars">pars</code></td>
<td>
<p>A tibble describing the parameter uncertainty (see details).</p>
</td></tr>
<tr><td><code id="check_stochastic_pars_+3A_corr_matrix">corr_matrix</code></td>
<td>
<p>Correlation matrix of the model parameters. Defined in the
same order as in <code>pars</code>. An identity matrix by default
(uncorrelated parameters).</p>
</td></tr>
</table>

<hr>
<h2 id='compare_growth_fits'>Model comparison and selection for growth models</h2><span id='topic+compare_growth_fits'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>This function is a constructor for <a href="#topic+GrowthComparison">GrowthComparison</a> or <a href="#topic+GlobalGrowthComparison">GlobalGrowthComparison</a>,
a class that provides several functions for model comparison and model selection
for growth models fitted using <code><a href="#topic+fit_growth">fit_growth()</a></code>. Please see the help pages for
<a href="#topic+GrowthComparison">GrowthComparison</a> or <a href="#topic+GlobalGrowthComparison">GlobalGrowthComparison</a> for further details.
</p>
<p>Although it is not necessary, we recommend passing the models as a named list,
as these names will later be kept in plots and tables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_growth_fits(models)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_growth_fits_+3A_models">models</code></td>
<td>
<p>a (we recommend named) list of models fitted using <code><a href="#topic+fit_growth">fit_growth()</a></code>.
Every model should be of the same class. Otherwise, some functions may give unexpected results.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1 - Fitting under static environmental conditions ----------------

## We will use the data on growth of Salmonella included in the package

data("growth_salmonella")

## We will fit 3 different models to the data

fit1 &lt;- fit_growth(growth_salmonella, 
                   list(primary = "Baranyi"),
                   start = c(lambda = 0, logNmax = 8, mu = .1, logN0 = 2),
                   known = c(),
                   environment = "constant",
                   )
                   
fit2 &lt;- fit_growth(growth_salmonella,
                   list(primary = "Baranyi"),
                   start = c(logNmax = 8, mu = .1, logN0 = 2),
                   known = c(lambda = 0),
                   environment = "constant",
                   )
                   
fit3 &lt;- fit_growth(growth_salmonella,
                   list(primary = "modGompertz"),
                   start = c(C = 8, mu = .1, logN0 = 2),
                   known = c(lambda = 0),
                   environment = "constant",
                   )
                   
## We can now put them in a (preferably named) list

my_models &lt;- list(`Baranyi` = fit1, 
                  `Baranyi no lag` = fit2, 
                  `Gompertz no lag` = fit3)
                  
## And pass them to compare_growth_fits
                   
model_comparison &lt;- compare_growth_fits(my_models)

##  The instance of GrowthComparison has useful S3 methods

print(model_comparison)
plot(model_comparison)
plot(model_comparison, type = 2)
plot(model_comparison, type = 3)

## The statistical indexes can be accessed through summary and coef

summary(model_comparison)
coef(model_comparison)

## Example 2 - Fitting under dynamic environmental conditions ---------------


## We will use one of the example datasets

data("example_dynamic_growth")
data("example_env_conditions")

## First model fitted

sec_models &lt;- list(temperature = "CPM", aw = "CPM")

known_pars &lt;- list(Nmax = 1e4, 
                   N0 = 1e0, Q0 = 1e-3, 
                   mu_opt = 4,
                   temperature_n = 1,
                   aw_xmax = 1, aw_xmin = .9, aw_n = 1 
                   )
                   
my_start &lt;- list(temperature_xmin = 25, temperature_xopt = 35,
                 temperature_xmax = 40, aw_xopt = .95)
                 
dynamic_fit &lt;- fit_growth(example_dynamic_growth,
                          sec_models,
                          my_start, known_pars,
                          environment = "dynamic",
                          env_conditions = example_env_conditions
                          )
                          
## Second model (different secondary model for temperature)

sec_models &lt;- list(temperature = "Zwietering", aw = "CPM")

known_pars &lt;- list(Nmax = 1e4, 
                   N0 = 1e0, Q0 = 1e-3,
                   mu_opt = 4,
                   temperature_n = 1,
                   aw_xmax = 1, aw_xmin = .9, aw_n = 1 
                   )
                   
my_start &lt;- list(temperature_xmin = 25, temperature_xopt = 35,
                 aw_xopt = .95)
                 
dynamic_fit2 &lt;- fit_growth(example_dynamic_growth,
                           sec_models,
                           my_start, known_pars,
                           environment = "dynamic",
                           env_conditions = example_env_conditions
                           )
                           
## Once both models have been fitted, we can call the function               

dynamic_comparison &lt;- compare_growth_fits(list(m1 = dynamic_fit, m2 = dynamic_fit2))

## Which also returns an instance of GrowthComparison with the same S3 methods

print(dynamic_comparison)
plot(dynamic_comparison)
plot(dynamic_comparison, type = 2)
plot(dynamic_comparison, type = 3)

## The statistical indexes can be accessed through summary and coef

summary(dynamic_comparison)
coef(dynamic_comparison)


## Example 3 - Global fitting -----------------------------------------------


## We use the example data

data("multiple_counts")
data("multiple_conditions")

## We need to fit (at least) two models

sec_models &lt;- list(temperature = "CPM", pH = "CPM")

known_pars &lt;- list(Nmax = 1e8, N0 = 1e0, Q0 = 1e-3,
                   temperature_n = 2, temperature_xmin = 20, 
                   temperature_xmax = 35,
                   pH_n = 2, pH_xmin = 5.5, pH_xmax = 7.5, pH_xopt = 6.5)
                   
my_start &lt;- list(mu_opt = .8, temperature_xopt = 30)

global_fit &lt;- fit_growth(multiple_counts, 
                         sec_models, 
                         my_start, 
                         known_pars,
                         environment = "dynamic",
                         algorithm = "regression",
                         approach = "global",
                         env_conditions = multiple_conditions
                         ) 
                         
sec_models &lt;- list(temperature = "CPM", pH = "CPM")

known_pars &lt;- list(Nmax = 1e8, N0 = 1e0, Q0 = 1e-3,
                   temperature_n = 1, temperature_xmin = 20, 
                   temperature_xmax = 35,
                   pH_n = 2, pH_xmin = 5.5, pH_xmax = 7.5, pH_xopt = 6.5)
                   
my_start &lt;- list(mu_opt = .8, temperature_xopt = 30)

global_fit2 &lt;- fit_growth(multiple_counts, 
                          sec_models, 
                          my_start, 
                          known_pars,
                          environment = "dynamic",
                          algorithm = "regression",
                          approach = "global",
                          env_conditions = multiple_conditions
                          ) 
                          
## We can now pass both models to the function as a (named) list

global_comparison &lt;- compare_growth_fits(list(`n=2` = global_fit, 
                                              `n=1` = global_fit2)
                                              )
                                              
## The residuals and model fits plots are divided by experiments

plot(global_comparison)
plot(global_comparison, type = 3)

## The remaining S3 methods are the same as before

print(global_comparison)
plot(global_comparison, type = 2)
summary(global_comparison)
coef(global_comparison)



</code></pre>

<hr>
<h2 id='compare_secondary_fits'>Model comparison and selection for secondary growth models</h2><span id='topic+compare_secondary_fits'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>This function is a constructor for <a href="#topic+SecondaryComparison">SecondaryComparison</a>
a class that provides several functions for model comparison and model selection
for growth models fitted using <code><a href="#topic+fit_secondary_growth">fit_secondary_growth()</a></code>. Please see the help pages for
<a href="#topic+SecondaryComparison">SecondaryComparison</a> for further details.
</p>
<p>Although it is not necessary, we recommend passing the models as a named list,
as these names will later be kept in plots and tables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_secondary_fits(models)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_secondary_fits_+3A_models">models</code></td>
<td>
<p>a (we recommend named) list of models fitted using <code><a href="#topic+fit_secondary_growth">fit_secondary_growth()</a></code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## We first need to fit some models

data("example_cardinal")

sec_model_names &lt;- c(temperature = "Zwietering", pH = "CPM")

known_pars &lt;- list(mu_opt = 1.2, temperature_n = 1,
                   pH_n = 2, pH_xmax = 6.8, pH_xmin = 5.2)
                   
my_start &lt;- list(temperature_xmin = 5, temperature_xopt = 35,
                 pH_xopt = 6.5)
                 
fit1 &lt;- fit_secondary_growth(example_cardinal, my_start, known_pars, sec_model_names)

known_pars &lt;- list(mu_opt = 1.2, temperature_n = 2,
                   pH_n = 2, pH_xmax = 6.8, pH_xmin = 5.2)
                   
 fit2 &lt;- fit_secondary_growth(example_cardinal, my_start, known_pars, sec_model_names)
 
 ## We can now pass the models to the constructor

 comparison &lt;- compare_secondary_fits(list(`n=1` = fit1, 
                                           `n=2` = fit2))
                                           
 ## The function includes several S3 methods for model selection and comparison
 
 print(comparison)
 
 plot(comparison)
 plot(comparison, type = 2)
 
 ## The numerical indexes can be accessed using coef and summary
 
 coef(comparison)
 summary(comparison)

</code></pre>

<hr>
<h2 id='conditions_pH_temperature'>Conditions during a dynamic growth experiment</h2><span id='topic+conditions_pH_temperature'></span>

<h3>Description</h3>

<p>A dataset to demonstrate the use of fit_dynamic_growth. The observations
environmental conditions are described in conditions_pH_temperature.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conditions_pH_temperature
</code></pre>


<h3>Format</h3>

<p>A tibble with 4 rows and 3 columns:
</p>

<dl>
<dt>time</dt><dd><p>elapsed time</p>
</dd>
<dt>temperature</dt><dd><p>temperature</p>
</dd>
<dt>pH</dt><dd><p>pH</p>
</dd>
</dl>


<hr>
<h2 id='CPM_model'>Secondary Cardinal Parameter (CPM) model</h2><span id='topic+CPM_model'></span>

<h3>Description</h3>

<p>Secondary cardinal parameter model as defined by Rosso et al. (1995).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CPM_model(x, xmin, xopt, xmax, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CPM_model_+3A_x">x</code></td>
<td>
<p>Value of the environmental factor.</p>
</td></tr>
<tr><td><code id="CPM_model_+3A_xmin">xmin</code></td>
<td>
<p>Minimum value for growth.</p>
</td></tr>
<tr><td><code id="CPM_model_+3A_xopt">xopt</code></td>
<td>
<p>Optimum value for growth.</p>
</td></tr>
<tr><td><code id="CPM_model_+3A_xmax">xmax</code></td>
<td>
<p>Maximum value for growth.</p>
</td></tr>
<tr><td><code id="CPM_model_+3A_n">n</code></td>
<td>
<p>Order of the CPM model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The corresponding gamma factor.
</p>

<hr>
<h2 id='dBaranyi'>Baranyi growth model</h2><span id='topic+dBaranyi'></span>

<h3>Description</h3>

<p>Microbial growth model as defined in Baranyi and Roberts (1994). It has
been implemented according to the requirements of
<code><a href="deSolve.html#topic+ode">ode()</a></code>. For consistency in the function for isothermal growth,
calculations are done assuming the user input for mu is in log10 scale. In other words,
the input is multiplied by ln(10).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dBaranyi(time, state, pars, env_func, sec_models)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dBaranyi_+3A_time">time</code></td>
<td>
<p>numeric vector (length 1) of storage time</p>
</td></tr>
<tr><td><code id="dBaranyi_+3A_state">state</code></td>
<td>
<p>named numeric vector with two components: Q and N</p>
</td></tr>
<tr><td><code id="dBaranyi_+3A_pars">pars</code></td>
<td>
<p>named numeric vector of model parameters (Nmax and mu_opt)</p>
</td></tr>
<tr><td><code id="dBaranyi_+3A_env_func">env_func</code></td>
<td>
<p>named list of functions returning the values of
the environmental conditions for time (t)</p>
</td></tr>
<tr><td><code id="dBaranyi_+3A_sec_models">sec_models</code></td>
<td>
<p>named list of parameters of the secondary model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of two components according to the requirements of
<code><a href="deSolve.html#topic+ode">ode()</a></code>.
</p>

<hr>
<h2 id='distribution_to_logcount'>Distribution of times to reach a certain microbial count</h2><span id='topic+distribution_to_logcount'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>The function <code><a href="#topic+distribution_to_logcount">distribution_to_logcount()</a></code> has been superseded by
function <code><a href="#topic+time_to_size">time_to_size()</a></code>, which provides more general interface.
</p>
<p>Returns the probability distribution of the storage time required for
the microbial count to reach <code>log_count</code> according to the predictions of
a stochastic <code>model</code>.
Calculations are done using linear interpolation of the individual
model predictions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distribution_to_logcount(model, log_count)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distribution_to_logcount_+3A_model">model</code></td>
<td>
<p>An instance of <code>StochasticGrowth</code> or <code>MCMCgrowth</code>.</p>
</td></tr>
<tr><td><code id="distribution_to_logcount_+3A_log_count">log_count</code></td>
<td>
<p>The target microbial count.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of <code><a href="#topic+TimeDistribution">TimeDistribution()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## We need an instance of StochasticGrowth

my_model &lt;- "modGompertz"
my_times &lt;- seq(0, 30, length = 100)
n_sims &lt;- 3000

library(tibble)

pars &lt;- tribble(
    ~par, ~mean, ~sd, ~scale,
    "logN0", 0, .2, "original",
    "mu", 2, .3, "sqrt",
    "lambda", 4, .4, "sqrt",
    "C", 6, .5, "original"
)

stoc_growth &lt;- predict_stochastic_growth(my_model, my_times, n_sims, pars)



</code></pre>

<hr>
<h2 id='DynamicGrowth'>DynamicGrowth class</h2><span id='topic+DynamicGrowth'></span><span id='topic+print.DynamicGrowth'></span><span id='topic+plot.DynamicGrowth'></span><span id='topic+coef.DynamicGrowth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>The class <a href="#topic+DynamicGrowth">DynamicGrowth</a> has been superseded by the top-level
class <a href="#topic+GrowthPrediction">GrowthPrediction</a>, which provides a unified approach for growth modelling.
</p>
<p>Still, it is returned if the superseded <code><a href="#topic+predict_dynamic_growth">predict_dynamic_growth()</a></code> is called.
</p>
<p>A subclass of list with items:
</p>

<ul>
<li><p> simulation: A tibble with the model prediction
</p>
</li>
<li><p> gammas: A tibble with the value of each gamma factor for each
value of <code>times</code>.
</p>
</li>
<li><p> env_conditions: A list of functions interpolating the environmental
conditions.
</p>
</li>
<li><p> primary_pars: A list with the model parameters of the primary model.
</p>
</li>
<li><p> sec_models: A nested list defining the secondary models.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'DynamicGrowth'
print(x, ...)

## S3 method for class 'DynamicGrowth'
plot(
  x,
  y = NULL,
  ...,
  add_factor = NULL,
  ylims = NULL,
  label_y1 = "logN",
  label_y2 = add_factor,
  line_col = "black",
  line_size = 1,
  line_type = "solid",
  line_col2 = "black",
  line_size2 = 1,
  line_type2 = "dashed",
  label_x = "time"
)

## S3 method for class 'DynamicGrowth'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DynamicGrowth_+3A_x">x</code></td>
<td>
<p>The object of class <code>DynamicGrowth</code> to plot.</p>
</td></tr>
<tr><td><code id="DynamicGrowth_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="DynamicGrowth_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="DynamicGrowth_+3A_add_factor">add_factor</code></td>
<td>
<p>whether to plot also one environmental factor.
If <code>NULL</code> (default), no environmental factor is plotted. If set
to one character string that matches one entry of x$env_conditions,
that condition is plotted in the secondary axis</p>
</td></tr>
<tr><td><code id="DynamicGrowth_+3A_ylims">ylims</code></td>
<td>
<p>A two dimensional vector with the limits of the primary y-axis.</p>
</td></tr>
<tr><td><code id="DynamicGrowth_+3A_label_y1">label_y1</code></td>
<td>
<p>Label of the primary y-axis.</p>
</td></tr>
<tr><td><code id="DynamicGrowth_+3A_label_y2">label_y2</code></td>
<td>
<p>Label of the secondary y-axis.</p>
</td></tr>
<tr><td><code id="DynamicGrowth_+3A_line_col">line_col</code></td>
<td>
<p>Aesthetic parameter to change the colour of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="DynamicGrowth_+3A_line_size">line_size</code></td>
<td>
<p>Aesthetic parameter to change the thickness of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="DynamicGrowth_+3A_line_type">line_type</code></td>
<td>
<p>Aesthetic parameter to change the type of the line geom in the plot, takes numbers (1-6) or strings (&quot;solid&quot;) see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="DynamicGrowth_+3A_line_col2">line_col2</code></td>
<td>
<p>Same as lin_col, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="DynamicGrowth_+3A_line_size2">line_size2</code></td>
<td>
<p>Same as line_size, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="DynamicGrowth_+3A_line_type2">line_type2</code></td>
<td>
<p>Same as lin_type, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="DynamicGrowth_+3A_label_x">label_x</code></td>
<td>
<p>Label of the x-axis.</p>
</td></tr>
<tr><td><code id="DynamicGrowth_+3A_object">object</code></td>
<td>
<p>an instance of <a href="#topic+DynamicGrowth">DynamicGrowth</a></p>
</td></tr>
</table>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>print(DynamicGrowth)</code>: print of the model
</p>
</li>
<li> <p><code>plot(DynamicGrowth)</code>: predicted growth curve under dynamic conditions.
</p>
</li>
<li> <p><code>coef(DynamicGrowth)</code>: coefficients of the model
</p>
</li></ul>

<hr>
<h2 id='example_cardinal'>Growth rates obtained for several growth experiments</h2><span id='topic+example_cardinal'></span>

<h3>Description</h3>

<p>An example dataset illustrating the requirements of the
<code><a href="#topic+fit_secondary_growth">fit_secondary_growth()</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_cardinal
</code></pre>


<h3>Format</h3>

<p>A data frame with 64 rows and 3 variables:
</p>

<dl>
<dt>temperature</dt><dd><p>storage temperature (ºC)</p>
</dd>
<dt>pH</dt><dd><p>pH of the media</p>
</dd>
<dt>mu</dt><dd><p>specific growth rate (log10 CFU/h)</p>
</dd>
</dl>


<hr>
<h2 id='example_dynamic_growth'>Microbial growth under dynamic conditions</h2><span id='topic+example_dynamic_growth'></span>

<h3>Description</h3>

<p>An example dataset illustrating the requirements of the
<code><a href="#topic+fit_dynamic_growth">fit_dynamic_growth()</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_dynamic_growth
</code></pre>


<h3>Format</h3>

<p>A data frame with 30 rows and 2 variables:
</p>

<dl>
<dt>time</dt><dd><p>elapsed time (h)</p>
</dd>
<dt>logN</dt><dd><p>log population size (log10 CFU)</p>
</dd>
</dl>


<hr>
<h2 id='example_env_conditions'>Environmental conditions during a dynamic experiment</h2><span id='topic+example_env_conditions'></span>

<h3>Description</h3>

<p>An example dataset illustrating the requirements of the
<code><a href="#topic+fit_dynamic_growth">fit_dynamic_growth()</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_env_conditions
</code></pre>


<h3>Format</h3>

<p>A data frame with 3 rows and 3 variables:
</p>

<dl>
<dt>time</dt><dd><p>elapsed time (h)</p>
</dd>
<dt>temperature</dt><dd><p>storage temperature (ºC)</p>
</dd>
<dt>aw</dt><dd><p>water activity</p>
</dd>
</dl>


<hr>
<h2 id='extract_primary_pars'>A helper to build the primary models</h2><span id='topic+extract_primary_pars'></span>

<h3>Description</h3>

<p>Most of the functions for fitting mix in the vectors parameters for
the primary and secondary models, but the functions for making predictions
need that they are separated. This one extracts the parameters of the primary
model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_primary_pars(this_p, known_pars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_primary_pars_+3A_this_p">this_p</code></td>
<td>
<p>A named vector of model parameters (usually, the ones fitted).</p>
</td></tr>
<tr><td><code id="extract_primary_pars_+3A_known_pars">known_pars</code></td>
<td>
<p>Another named vector of model parameters (usually the
known ones).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the parameters of the primary model
</p>

<hr>
<h2 id='extract_secondary_pars'>A helper to build the secondary models</h2><span id='topic+extract_secondary_pars'></span>

<h3>Description</h3>

<p>Most of the functions for fitting mix in the vectors parameters for
the primary and secondary models, but the functions for making predictions
need that they are separated. This one extracts the parameters of the secondary
model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_secondary_pars(this_p, known_pars, sec_model_names)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_secondary_pars_+3A_this_p">this_p</code></td>
<td>
<p>A named vector of model parameters (usually, the ones fitted).</p>
</td></tr>
<tr><td><code id="extract_secondary_pars_+3A_known_pars">known_pars</code></td>
<td>
<p>Another named vector of model parameters (usually the
known ones).</p>
</td></tr>
<tr><td><code id="extract_secondary_pars_+3A_sec_model_names">sec_model_names</code></td>
<td>
<p>A named character vector defining for each environmental
factor (vector names) the type of secondary model (vector values).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A nested list defining the secondary models.
</p>

<hr>
<h2 id='fit_dynamic_growth'>Fit dynamic growth models</h2><span id='topic+fit_dynamic_growth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>The function <code><a href="#topic+fit_dynamic_growth">fit_dynamic_growth()</a></code> has been superseded by the top-level
function <code><a href="#topic+fit_growth">fit_growth()</a></code>, which provides a unified approach for growth modelling.
</p>
<p>Nonetheless, it can still fit a growth model to data obtained under dynamic conditions
using the one-step approach (non-linear regression).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_dynamic_growth(
  fit_data,
  env_conditions,
  starting_point,
  known_pars,
  sec_model_names,
  ...,
  check = TRUE,
  logbase_mu = logbase_logN,
  logbase_logN = 10,
  formula = logN ~ time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_dynamic_growth_+3A_fit_data">fit_data</code></td>
<td>
<p>Tibble with the data to use for model fit. It must
contain a column with the elapsed time (named &quot;time&quot; by default) and another one
with the decimal logarithm of the observed population size (named &quot;logN&quot; by default).
Different column names can be specified using the &quot;formula&quot; argument.</p>
</td></tr>
<tr><td><code id="fit_dynamic_growth_+3A_env_conditions">env_conditions</code></td>
<td>
<p>Tibble with the (dynamic) environmental conditions
during the experiment. It must have one column with the
elapsed time (named &quot;time&quot; by default) and as many columns as required with the
environmental conditions. A different column name can be specified using the
&quot;formula&quot; argument, although it must be the same one as in &quot;fit_data&quot;.
Note that only those defined in &quot;sec_model_names&quot; will be considered for
the model fit.</p>
</td></tr>
<tr><td><code id="fit_dynamic_growth_+3A_starting_point">starting_point</code></td>
<td>
<p>A named vector of starting values for the model parameters.
Parameters for the primary model must be named in the usual way. Parameters for the
secondary model are named as <code>env_factor</code>+'_'+<code>parameter</code>. For instance,
the maximum growth temperature shall be named 'temperature_xmax'.</p>
</td></tr>
<tr><td><code id="fit_dynamic_growth_+3A_known_pars">known_pars</code></td>
<td>
<p>A named vector of known model parameters (i.e. not fitted). They
must be named using the same convention as for <code>starting_point</code>.</p>
</td></tr>
<tr><td><code id="fit_dynamic_growth_+3A_sec_model_names">sec_model_names</code></td>
<td>
<p>A named character vector defining the secondary model for each
environmental factor. The names define the factor and the value the type of model.
Names must match columns in <code>fit_data</code> and <code>env_conditions</code>.</p>
</td></tr>
<tr><td><code id="fit_dynamic_growth_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to modFit.</p>
</td></tr>
<tr><td><code id="fit_dynamic_growth_+3A_check">check</code></td>
<td>
<p>Whether to check model parameters (TRUE by default).</p>
</td></tr>
<tr><td><code id="fit_dynamic_growth_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, the same as logbase_logN. See vignette about units for details.</p>
</td></tr>
<tr><td><code id="fit_dynamic_growth_+3A_logbase_logn">logbase_logN</code></td>
<td>
<p>Base of the logarithm for the population size. By default,
10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
<tr><td><code id="fit_dynamic_growth_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot; describing the x and y variables.
<code>logN ~ time</code> as a default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of <code><a href="#topic+FitDynamicGrowth">FitDynamicGrowth()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## We use the datasets included in the package

data("example_dynamic_growth")
data("example_env_conditions")

## Define the secondary models

sec_model_names &lt;- c(temperature = "CPM", aw= "CPM")

## Any model parameter can be fixed

known_pars &lt;- list(Nmax = 1e4,  # Primary model
    N0 = 1e0, Q0 = 1e-3,  # Initial values of the primary model
    mu_opt = 4, # mu_opt of the gamma model
    temperature_n = 1,  # Secondary model for temperature
    aw_xmax = 1, aw_xmin = .9, aw_n = 1  # Secondary model for water activity
    )

## The remaining parameters need initial values

my_start &lt;- list(temperature_xmin = 25, temperature_xopt = 35,
    temperature_xmax = 40, aw_xopt = .95)

## We can now call the fitting function

my_dyna_fit &lt;- fit_dynamic_growth(example_dynamic_growth, example_env_conditions,
    my_start, known_pars, sec_model_names)

summary(my_dyna_fit)

## We can compare the data and the fitted curve

plot(my_dyna_fit)

## We can plot any environmental condition using add_factor

plot(my_dyna_fit, add_factor = "aw",
    label_y1 = "Log count (log CFU/ml)",
    label_y2 = "Water activity")


</code></pre>

<hr>
<h2 id='fit_growth'>Fitting microbial growth</h2><span id='topic+fit_growth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>This function provides a top-level interface for fitting growth models to data describing
the variation of the population size through time, either under constant or dynamic
environment conditions.
See below for details on the calculations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_growth(
  fit_data,
  model_keys,
  start,
  known,
  environment = "constant",
  algorithm = "regression",
  approach = "single",
  env_conditions = NULL,
  niter = NULL,
  ...,
  check = TRUE,
  logbase_mu = logbase_logN,
  logbase_logN = 10,
  formula = logN ~ time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_growth_+3A_fit_data">fit_data</code></td>
<td>
<p>observed microbial growth. The format varies depending on the type
of model fit. See the relevant sections (and examples) below for details.</p>
</td></tr>
<tr><td><code id="fit_growth_+3A_model_keys">model_keys</code></td>
<td>
<p>a named list assigning equations for the primary and secondary
models. See the relevant sections (and examples) below for details.</p>
</td></tr>
<tr><td><code id="fit_growth_+3A_start">start</code></td>
<td>
<p>a named numeric vector assigning initial guesses to the model parameters
to estimate from the data. See relevant section (and examples) below for details.</p>
</td></tr>
<tr><td><code id="fit_growth_+3A_known">known</code></td>
<td>
<p>named numeric vector of fixed model parameters, using the same conventions
as for &quot;start&quot;.</p>
</td></tr>
<tr><td><code id="fit_growth_+3A_environment">environment</code></td>
<td>
<p>type of environment. Either &quot;constant&quot; (default) or &quot;dynamic&quot; (see below for details
on the calculations for each condition)</p>
</td></tr>
<tr><td><code id="fit_growth_+3A_algorithm">algorithm</code></td>
<td>
<p>either &quot;regression&quot; (default; Levenberg-Marquard algorithm) or &quot;MCMC&quot;
(Adaptive Monte Carlo algorithm).</p>
</td></tr>
<tr><td><code id="fit_growth_+3A_approach">approach</code></td>
<td>
<p>approach for model fitting. Either &quot;single&quot; (the model is fitted to
a unique experiment) or &quot;global&quot; (the model is fitted to several dynamic experiments).</p>
</td></tr>
<tr><td><code id="fit_growth_+3A_env_conditions">env_conditions</code></td>
<td>
<p>Tibble describing the variation of the environmental
conditions for dynamic experiments. See the relevant sections (and examples) below
for details. Ignored for environment=&quot;constant&quot;.</p>
</td></tr>
<tr><td><code id="fit_growth_+3A_niter">niter</code></td>
<td>
<p>number of iterations of the MCMC algorithm. Ignored when algorithm!=&quot;MCMC&quot;.</p>
</td></tr>
<tr><td><code id="fit_growth_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code><a href="FME.html#topic+modFit">modFit()</a></code>.</p>
</td></tr>
<tr><td><code id="fit_growth_+3A_check">check</code></td>
<td>
<p>Whether to check the validity of the models. TRUE by default.</p>
</td></tr>
<tr><td><code id="fit_growth_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, the same as logbase_logN. See vignette about units for details.</p>
</td></tr>
<tr><td><code id="fit_growth_+3A_logbase_logn">logbase_logN</code></td>
<td>
<p>Base of the logarithm for the population size. By default,
10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
<tr><td><code id="fit_growth_+3A_formula">formula</code></td>
<td>
<p>An object of class &quot;formula&quot; defining the names of the x and y variables in
the data. <code>logN ~ time</code> as a default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code style="white-space: pre;">&#8288;approach="single&#8288;</code>, an instance of <a href="#topic+GrowthFit">GrowthFit</a>. If <code>approach="multiple"</code>,
an instance of <a href="#topic+GlobalGrowthFit">GlobalGrowthFit</a>
</p>
<p>Please check the help pages of each class for additional information.
</p>


<h3>Fitting under constant conditions</h3>

<p>When environment=&quot;constant&quot;, the functions fits a primary growth model to the
population size observed during an experiment. In this case, the data has to be
a tibble (or data.frame) with two columns:
</p>

<ul>
<li><p> time: the elapsed time
</p>
</li>
<li><p> logN: the logarithm of the observed population size
Nonetheless, the names of the columns can be modified with the formula argument.
</p>
</li></ul>

<p>The model equation is defined through the model_keys argument. It must include
an entry named &quot;primary&quot; assigned to a model. Valid model keys can be retrieved
calling <code><a href="#topic+primary_model_data">primary_model_data()</a></code>.
</p>
<p>The model is fitted by non-linear regression (using <code><a href="FME.html#topic+modFit">modFit()</a></code>). This algorithm
needs initial guesses for every model parameter. This are defined as a named numeric
vector. The names must be valid model keys, which can be retrieved using <code><a href="#topic+primary_model_data">primary_model_data()</a></code>
(see example below). Apart from that, any model parameter can be fixed using the
&quot;known&quot; argument. This is a named numeric vector, with the same convenctions as &quot;start&quot;.
</p>


<h3>Fitting under dynamic conditions to a single experiment</h3>

<p>When environment=&quot;constant&quot; and approach=&quot;single&quot;, a dynamic growth model combining
the Baranyi primary growth model with the gamma approach for the effect of the environmental
conditions on the growth rate is fitted to an experiment gathered under dynamic conditions.
In this case, the data is similar to fitting under constant conditions: a
tibble (or data.frame) with two columns:
</p>

<ul>
<li><p> time: the elapsed time
</p>
</li>
<li><p> logN: the logarithm of the observed population size
Note that these default names can be changed using the formula argument.
</p>
</li></ul>

<p>The values of the experimental conditions during the experiment are defined using
the &quot;env_conditions&quot; argument. It is a tibble (or data.frame) with one column named (&quot;time&quot;)
defining the elapsed time. Note that this default name can be modified using the
formula argument of the function. The tibble needs to have as many additional
columns as environmental conditions included in the model, providing the values
of the environmental conditions.
</p>
<p>The model equations are defined through the model_keys argument. It must be a named
list where the names match the column names of &quot;env_conditions&quot; and the values
are model keys. These can be retrieved using <code><a href="#topic+secondary_model_data">secondary_model_data()</a></code>.
</p>
<p>The model can be fitted using regression (<code><a href="FME.html#topic+modFit">modFit()</a></code>) or an adaptive Monte Carlo
algorithm (<code><a href="FME.html#topic+modMCMC">modMCMC()</a></code>). Both algorithms require initial guesses for every model
parameter to fit. These are defined through the named numeric vector &quot;start&quot;. Each
parameter must be named as <em>factor</em>+&quot;_&quot;+<em>parameter</em>, where <em>factor</em> is the name of the
environmental factor defined in &quot;model_keys&quot;. The <em>parameter</em> is a valid key
that can be retrieved from <code><a href="#topic+secondary_model_data">secondary_model_data()</a></code>. For instance, parameter Xmin for
the factor temperature would be defined as &quot;temperature_xmin&quot;.
</p>
<p>Note that the argument ... allows passing additional arguments to the fitting functions.
</p>


<h3>Fitting under dynamic conditions to multiple experiments (global fitting)</h3>

<p>When environment=&quot;constant&quot; and approach=&quot;global&quot;, fit_growth tries to find the vector of model
parameters that best describe the observations of several growth experiments.
</p>
<p>The input requirements are very similar to the case when approach=&quot;single&quot;. The
models (equations, initial guesses, known parameters, algorithms...) are identical.
The only difference is that &quot;fit_data&quot; must be a list, where each element describes
the results of an experiment (using the same conventions as when approach=&quot;single&quot;).
In a similar fashion, &quot;env_conditions&quot; must be a list describing the values of the
environmental factors during each experiment. Although it is not mandatory, it
is recommended that the elements of both lists are named. Otherwise, the function
assigns automatically-generated names, and matches them by order.#'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1 - Fitting a primary model --------------------------------------

## A dummy dataset describing the variation of the population size 

my_data &lt;- data.frame(time = c(0, 25, 50, 75, 100), 
                      logN = c(2, 2.5, 7, 8, 8))
                      
## A list of model keys can be gathered from 

primary_model_data()
                      
## The primary model is defined as a list

models &lt;- list(primary = "Baranyi")

## The keys of the model parameters can also be gathered from primary_model_data

primary_model_data("Baranyi")$pars

## Any model parameter can be fixed

known &lt;- c(mu = .2)

## The remaining parameters need initial guesses 

start &lt;- c(logNmax = 8, lambda = 25, logN0 = 2)

primary_fit &lt;- fit_growth(my_data, models, start, known,
                          environment = "constant",
                          )
                          
## The instance of FitIsoGrowth includes several useful methods

print(primary_fit)
plot(primary_fit)
coef(primary_fit)
summary(primary_fit)

## time_to_size can be used to calculate the time for some concentration

time_to_size(primary_fit, 4)

## Example 2 - Fitting under dynamic conditions------------------------------

## We will use the example data included in the package

data("example_dynamic_growth")

## And the example environmental conditoins (temperature &amp; aw)

data("example_env_conditions")

## Valid keys for secondary models can be retrived from

secondary_model_data()

## We need to assign a model equation (secondary model) to each environmental factor

sec_models &lt;- list(temperature = "CPM", aw = "CPM")

## The keys of the model parameters can be gathered from the same function

secondary_model_data("CPM")$pars

## Any model parameter (of the primary or secondary models) can be fixed

known_pars &lt;- list(Nmax = 1e4,  # Primary model
                   N0 = 1e0, Q0 = 1e-3,  # Initial values of the primary model
                   mu_opt = 4, # mu_opt of the gamma model
                   temperature_n = 1,  # Secondary model for temperature
                   aw_xmax = 1, aw_xmin = .9, aw_n = 1  # Secondary model for water activity
                   )
                   
## The rest, need initial guesses (you know, regression)

my_start &lt;- list(temperature_xmin = 25, temperature_xopt = 35,
                 temperature_xmax = 40, aw_xopt = .95)
                 
## We can now fit the model


dynamic_fit &lt;- fit_growth(example_dynamic_growth, 
                          sec_models, 
                          my_start, known_pars,
                          environment = "dynamic",
                          env_conditions = example_env_conditions
                          ) 
                          
## The instance of FitDynamicGrowth has several S3 methods

plot(dynamic_fit, add_factor = "temperature")
summary(dynamic_fit)

## We can use time_to_size to calculate the time required to reach a given size

time_to_size(dynamic_fit, 3)



## Example 3- Fitting under dynamic conditions using MCMC -------------------

## We can reuse most of the arguments from the previous example
## We just need to define the algorithm and the number of iterations


set.seed(12421)
MCMC_fit &lt;- fit_growth(example_dynamic_growth, 
                       sec_models, 
                       my_start, known_pars,
                       environment = "dynamic",
                       env_conditions = example_env_conditions,
                       algorithm = "MCMC",
                       niter = 1000
                       ) 
                       
## The instance of FitDynamicGrowthMCMC has several S3 methods

plot(MCMC_fit, add_factor = "aw")
summary(MCMC_fit)

## We can use time_to_size to calculate the time required to reach a given size

time_to_size(MCMC_fit, 3)

## It can also make growth predictions including uncertainty

uncertain_growth &lt;- predictMCMC(MCMC_fit, 
                                seq(0, 10, length = 1000),  
                                example_env_conditions, 
                                niter = 1000)

## The instance of MCMCgrowth includes several nice S3 methods

plot(uncertain_growth)
print(uncertain_growth)

## time_to_size can calculate the time to reach some count

time_to_size(uncertain_growth, 2)
time_to_size(uncertain_growth, 2, type = "distribution")



## Example 4 - Fitting a unique model to several dynamic experiments --------

## We will use the data included in the package

data("multiple_counts")
data("multiple_conditions")

## We need to assign a model equation for each environmental factor

sec_models &lt;- list(temperature = "CPM", pH = "CPM")

## Any model parameter (of the primary or secondary models) can be fixed

known_pars &lt;- list(Nmax = 1e8, N0 = 1e0, Q0 = 1e-3,
                   temperature_n = 2, temperature_xmin = 20, 
                   temperature_xmax = 35,
                   pH_n = 2, pH_xmin = 5.5, pH_xmax = 7.5, pH_xopt = 6.5)
                   
## The rest, need initial guesses

my_start &lt;- list(mu_opt = .8, temperature_xopt = 30)

## We can now fit the model


global_fit &lt;- fit_growth(multiple_counts, 
                         sec_models, 
                         my_start, 
                         known_pars,
                         environment = "dynamic",
                         algorithm = "regression",
                         approach = "global",
                         env_conditions = multiple_conditions
                         ) 
                         
## The instance of FitMultipleDynamicGrowth has nice S3 methods

plot(global_fit)
summary(global_fit)
print(global_fit)

## We can use time_to_size to calculate the time to reach a given size

time_to_size(global_fit, 4.5)



## Example 5 - MCMC fitting a unique model to several dynamic experiments ---

## Again, we can re-use all the arguments from the previous example
## We just need to define the right algorithm and the number of iterations
## On top of that, we will also pass upper and lower bounds to modMCMC


set.seed(12421)
global_MCMC &lt;- fit_growth(multiple_counts, 
                         sec_models, 
                         my_start, 
                         known_pars,
                         environment = "dynamic",
                         algorithm = "MCMC",
                         approach = "global",
                         env_conditions = multiple_conditions,
                         niter = 1000,
                         lower = c(.2, 29),  # lower limits of the model parameters
                         upper = c(.8, 34)  # upper limits of the model parameters
                         ) 
                         
## The instance of FitMultipleDynamicGrowthMCMC has nice S3 methods

plot(global_MCMC)
summary(global_MCMC)
print(global_MCMC)

## We can use time_to_size to calculate the time to reach a given size

time_to_size(global_MCMC, 3)

## It can also be used to make model predictions with parameter uncertainty

uncertain_prediction &lt;- predictMCMC(global_MCMC,
                                    seq(0, 50, length = 1000), 
                                    multiple_conditions[[1]], 
                                    niter = 100
                                    )

## The instance of MCMCgrowth includes several nice S3 methods

plot(uncertain_growth)
print(uncertain_growth)

## time_to_size can calculate the time to reach some count

time_to_size(uncertain_growth, 2)
time_to_size(uncertain_growth, 2, type = "distribution")



</code></pre>

<hr>
<h2 id='fit_isothermal_growth'>Fit primary growth models</h2><span id='topic+fit_isothermal_growth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>The function <code><a href="#topic+fit_isothermal_growth">fit_isothermal_growth()</a></code> has been superseded by the top-level
function <code><a href="#topic+fit_growth">fit_growth()</a></code>, which provides a unified approach for growth modelling.
</p>
<p>Nonetheless, it can still fit a primary growth model to data obtained under static
environmental conditions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_isothermal_growth(
  fit_data,
  model_name,
  starting_point,
  known_pars,
  ...,
  check = TRUE,
  formula = logN ~ time,
  logbase_mu = logbase_logN,
  logbase_logN = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_isothermal_growth_+3A_fit_data">fit_data</code></td>
<td>
<p>Tibble of data for the fit. It must have two columns, one with
the elapsed time (<code>time</code> by default) and another one with the decimal logarithm
of the populatoin size (<code>logN</code> by default). Different column names can be
defined using the <code>formula</code> argument.</p>
</td></tr>
<tr><td><code id="fit_isothermal_growth_+3A_model_name">model_name</code></td>
<td>
<p>Character defining the primary growth model</p>
</td></tr>
<tr><td><code id="fit_isothermal_growth_+3A_starting_point">starting_point</code></td>
<td>
<p>Named vector of initial values for the model parameters.</p>
</td></tr>
<tr><td><code id="fit_isothermal_growth_+3A_known_pars">known_pars</code></td>
<td>
<p>Named vector of known model parameters (not fitted).</p>
</td></tr>
<tr><td><code id="fit_isothermal_growth_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="FME.html#topic+modFit">modFit()</a></code>.</p>
</td></tr>
<tr><td><code id="fit_isothermal_growth_+3A_check">check</code></td>
<td>
<p>Whether to do some basic checks (TRUE by default).</p>
</td></tr>
<tr><td><code id="fit_isothermal_growth_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot; describing the x and y variables.
<code>logN ~ time</code> as a default.</p>
</td></tr>
<tr><td><code id="fit_isothermal_growth_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, the same as logbase_logN. See vignette about units for details.</p>
</td></tr>
<tr><td><code id="fit_isothermal_growth_+3A_logbase_logn">logbase_logN</code></td>
<td>
<p>Base of the logarithm for the population size. By default,
10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of <code><a href="#topic+FitIsoGrowth">FitIsoGrowth()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Some dummy data

library(tibble)

my_data &lt;- tibble(time = c(0, 25, 50, 75, 100),
    logN = c(2, 2.5, 7, 8, 8))

## Choose the model

my_model &lt;- "Baranyi"

## Initial values for the model parameters

start = c(logNmax = 8, lambda = 25, logN0 = 2)

## Any model parameter can be fixed

known &lt;- c(mu = .2)

## Now, we can call the function

static_fit &lt;- fit_isothermal_growth(my_data, my_model, start, known)

summary(static_fit)

## We can plot the fitted model against the observations

plot(static_fit)

</code></pre>

<hr>
<h2 id='fit_MCMC_growth'>Fit growth models using MCMC</h2><span id='topic+fit_MCMC_growth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>The function <code><a href="#topic+fit_MCMC_growth">fit_MCMC_growth()</a></code> has been superseded by the top-level
function <code><a href="#topic+fit_growth">fit_growth()</a></code>, which provides a unified approach for growth modelling.
</p>
<p>But, it can still fit a growth model to a data obtained under dynamic conditions
using the one-step approach (MCMC algorithm).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_MCMC_growth(
  fit_data,
  env_conditions,
  starting_point,
  known_pars,
  sec_model_names,
  niter,
  ...,
  check = TRUE,
  formula = logN ~ time,
  logbase_mu = logbase_logN,
  logbase_logN = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_MCMC_growth_+3A_fit_data">fit_data</code></td>
<td>
<p>Tibble with the data to use for model fit. It must
contain a column with the elapsed time (named &quot;time&quot; by default) and another one
with the decimal logarithm of the observed population size (named &quot;logN&quot; by default).
Different column names can be specified using the &quot;formula&quot; argument.</p>
</td></tr>
<tr><td><code id="fit_MCMC_growth_+3A_env_conditions">env_conditions</code></td>
<td>
<p>Tibble with the (dynamic) environmental conditions
during the experiment. It must have one column with the
elapsed time (named &quot;time&quot; by default) and as many columns as required with the
environmental conditions. A different column name can be specified using the
&quot;formula&quot; argument, although it must be the same one as in &quot;fit_data&quot;.
Note that only those defined in &quot;sec_model_names&quot; will be considered for
the model fit.</p>
</td></tr>
<tr><td><code id="fit_MCMC_growth_+3A_starting_point">starting_point</code></td>
<td>
<p>A named vector of starting values for the model parameters.
Parameters for the primary model must be named in the usual way. Parameters for the
secondary model are named as <code>env_factor</code>+'_'+<code>parameter</code>. For instance,
the maximum growth temperature shall be named 'temperature_xmax'.</p>
</td></tr>
<tr><td><code id="fit_MCMC_growth_+3A_known_pars">known_pars</code></td>
<td>
<p>A named vector of known model parameters (i.e. not fitted). They
must be named using the same convention as for <code>starting_point</code>.</p>
</td></tr>
<tr><td><code id="fit_MCMC_growth_+3A_sec_model_names">sec_model_names</code></td>
<td>
<p>A named character vector defining the secondary model for each
environmental factor. The names define the factor and the value the type of model.
Names must match columns in <code>fit_data</code> and <code>env_conditions</code>.</p>
</td></tr>
<tr><td><code id="fit_MCMC_growth_+3A_niter">niter</code></td>
<td>
<p>number of iterations of the MCMC algorithm.</p>
</td></tr>
<tr><td><code id="fit_MCMC_growth_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to modFit.</p>
</td></tr>
<tr><td><code id="fit_MCMC_growth_+3A_check">check</code></td>
<td>
<p>Whether to check model parameters (TRUE by default).</p>
</td></tr>
<tr><td><code id="fit_MCMC_growth_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot; describing the x and y variables.
<code>logN ~ time</code> as a default.</p>
</td></tr>
<tr><td><code id="fit_MCMC_growth_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, the same as logbase_logN. See vignette about units for details.</p>
</td></tr>
<tr><td><code id="fit_MCMC_growth_+3A_logbase_logn">logbase_logN</code></td>
<td>
<p>Base of the logarithm for the population size. By default,
10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of <code><a href="#topic+FitDynamicGrowthMCMC">FitDynamicGrowthMCMC()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## We use the example data included in the package

data("example_dynamic_growth")
data("example_env_conditions")

## Definition of the secondary models
sec_model_names &lt;- c(temperature = "CPM", aw= "CPM")

## Any model parameter can be fixed
known_pars &lt;- list(Nmax = 1e4,  # Primary model
    N0 = 1e0, Q0 = 1e-3,  # Initial values of the primary model
    mu_opt = 4, # mu_opt of the gamma model
    temperature_n = 1,  # Secondary model for temperature
    aw_xmax = 1, aw_xmin = .9, aw_n = 1  # Secondary model for water activity
    )

## We need starting values for the remaining parameters

my_start &lt;- list(temperature_xmin = 25, temperature_xopt = 35,
    temperature_xmax = 40,
    aw_xopt = .95)

## We can now call the fitting function

set.seed(12124) # Setting seed for repeatability

my_MCMC_fit &lt;- fit_MCMC_growth(example_dynamic_growth, example_env_conditions,
    my_start, known_pars, sec_model_names, niter = 3000)

## Always check the MCMC chain!!

plot(my_MCMC_fit$fit_results)

## We can compare data against fitted curve

plot(my_MCMC_fit)

## Any environmental factor can be included using add_factor

plot(my_MCMC_fit, add_factor = "temperature",
    label_y1 = "Count (log CFU/ml)", label_y2 = "Temperature (C)")



</code></pre>

<hr>
<h2 id='fit_multiple_growth'>Fitting growth models to multiple dynamic experiments</h2><span id='topic+fit_multiple_growth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>The function <code><a href="#topic+fit_multiple_growth">fit_multiple_growth()</a></code> has been superseded by the top-level
function <code><a href="#topic+fit_growth">fit_growth()</a></code>, which provides a unified approach for growth modelling.
</p>
<p>But, if you so wish, this function still enables fitting a growth model using a dataset comprised of
several experiments with potentially different dynamic experimental conditions.
Note that the definition of secondary models must comply with the
<code>secondary_model_data</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_multiple_growth(
  starting_point,
  experiment_data,
  known_pars,
  sec_model_names,
  ...,
  check = TRUE,
  formula = logN ~ time,
  logbase_mu = logbase_logN,
  logbase_logN = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_multiple_growth_+3A_starting_point">starting_point</code></td>
<td>
<p>a named vector of starting values for the model parameters.</p>
</td></tr>
<tr><td><code id="fit_multiple_growth_+3A_experiment_data">experiment_data</code></td>
<td>
<p>a nested list with the experimental data. Each entry describes
one experiment as a list with two elements: data and conditions. <code>data</code> is a tibble
with a column giving the elapsed time (named &quot;time&quot; by default) and another one
with the decimal logarithm of the population size (named &quot;logN&quot; by default).
<code>conditions</code> is a tibble with one column giving the elapsed time (using the
same name as <code>data</code>) and as many additional columns as environmental factors.
The default column names can be changed with the formula argument.</p>
</td></tr>
<tr><td><code id="fit_multiple_growth_+3A_known_pars">known_pars</code></td>
<td>
<p>named vector of known model parameters</p>
</td></tr>
<tr><td><code id="fit_multiple_growth_+3A_sec_model_names">sec_model_names</code></td>
<td>
<p>named character vector with names of the
environmental conditions and values of the secondary model (see secondary_model_data).</p>
</td></tr>
<tr><td><code id="fit_multiple_growth_+3A_...">...</code></td>
<td>
<p>additional arguments for <code><a href="FME.html#topic+modFit">modFit()</a></code>.</p>
</td></tr>
<tr><td><code id="fit_multiple_growth_+3A_check">check</code></td>
<td>
<p>Whether to check the validity of the models. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="fit_multiple_growth_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot; describing the x and y variables.
<code>logN ~ time</code> as a default.</p>
</td></tr>
<tr><td><code id="fit_multiple_growth_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, the same as logbase_logN. See vignette about units for details.</p>
</td></tr>
<tr><td><code id="fit_multiple_growth_+3A_logbase_logn">logbase_logN</code></td>
<td>
<p>Base of the logarithm for the population size. By default,
10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of <code><a href="#topic+FitMultipleDynamicGrowth">FitMultipleDynamicGrowth()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## We will use the multiple_experiments data set

data("multiple_experiments")

## For each environmental factor, we need to defined a model

sec_names &lt;- c(temperature = "CPM", pH = "CPM")

## Any model parameter can be fixed

known &lt;- list(Nmax = 1e8, N0 = 1e0, Q0 = 1e-3,
    temperature_n = 2, temperature_xmin = 20, temperature_xmax = 35,
    pH_n = 2, pH_xmin = 5.5, pH_xmax = 7.5, pH_xopt = 6.5)

## The rest require starting values for model fitting

start &lt;- list(mu_opt = .8, temperature_xopt = 30)

## We can now call the fitting function

global_fit &lt;- fit_multiple_growth(start, multiple_experiments, known, sec_names)

## Parameter estimates can be retrieved with summary

summary(global_fit)

## We can compare fitted model against observations

plot(global_fit)

## Any single environmental factor can be added to the plot using add_factor

plot(global_fit, add_factor = "temperature")


</code></pre>

<hr>
<h2 id='fit_multiple_growth_MCMC'>Fitting growth models to multiple dynamic experiments using MCMC</h2><span id='topic+fit_multiple_growth_MCMC'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>The function <code><a href="#topic+fit_multiple_growth_MCMC">fit_multiple_growth_MCMC()</a></code> has been superseded by the top-level
function <code><a href="#topic+fit_growth">fit_growth()</a></code>, which provides a unified approach for growth modelling.
</p>
<p>However, this functions can still be used to fit a growth model using a dataset comprised of
several experiments with potentially different dynamic experimental conditions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_multiple_growth_MCMC(
  starting_point,
  experiment_data,
  known_pars,
  sec_model_names,
  niter,
  ...,
  check = TRUE,
  formula = logN ~ time,
  logbase_mu = logbase_logN,
  logbase_logN = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_multiple_growth_MCMC_+3A_starting_point">starting_point</code></td>
<td>
<p>a named vector of starting values for the model parameters.</p>
</td></tr>
<tr><td><code id="fit_multiple_growth_MCMC_+3A_experiment_data">experiment_data</code></td>
<td>
<p>a nested list with the experimental data. Each entry describes
one experiment as a list with two elements: data and conditions. <code>data</code> is a tibble
with a column giving the elapsed time (named &quot;time&quot; by default) and another one
with the decimal logarithm of the population size (named &quot;logN&quot; by default).
<code>conditions</code> is a tibble with one column giving the elapsed time (using the
same name as <code>data</code>) and as many additional columns as environmental factors.
The default column names can be changed with the formula argument.</p>
</td></tr>
<tr><td><code id="fit_multiple_growth_MCMC_+3A_known_pars">known_pars</code></td>
<td>
<p>named vector of known model parameters</p>
</td></tr>
<tr><td><code id="fit_multiple_growth_MCMC_+3A_sec_model_names">sec_model_names</code></td>
<td>
<p>named character vector with names of the
environmental conditions and values of the secondary model (see secondary_model_data).</p>
</td></tr>
<tr><td><code id="fit_multiple_growth_MCMC_+3A_niter">niter</code></td>
<td>
<p>number of samples of the MCMC algorithm.</p>
</td></tr>
<tr><td><code id="fit_multiple_growth_MCMC_+3A_...">...</code></td>
<td>
<p>additional arguments for <a href="FME.html#topic+modMCMC">modMCMC</a> (e.g. upper and lower bounds).</p>
</td></tr>
<tr><td><code id="fit_multiple_growth_MCMC_+3A_check">check</code></td>
<td>
<p>Whether to check the validity of the models. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="fit_multiple_growth_MCMC_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot; describing the x and y variables.
<code>logN ~ time</code> as a default.</p>
</td></tr>
<tr><td><code id="fit_multiple_growth_MCMC_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, the same as logbase_logN. See vignette about units for details.</p>
</td></tr>
<tr><td><code id="fit_multiple_growth_MCMC_+3A_logbase_logn">logbase_logN</code></td>
<td>
<p>Base of the logarithm for the population size. By default,
10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of <code><a href="#topic+FitMultipleGrowthMCMC">FitMultipleGrowthMCMC()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## We will use the multiple_experiments data set

data("multiple_experiments")

## For each environmental factor, we need to defined a model

sec_names &lt;- c(temperature = "CPM", pH = "CPM")

## Any model parameter can be fixed

known &lt;- list(Nmax = 1e8, N0 = 1e0, Q0 = 1e-3,
    temperature_n = 2, temperature_xmin = 20, temperature_xmax = 35,
    pH_n = 2, pH_xmin = 5.5, pH_xmax = 7.5, pH_xopt = 6.5)

## The rest require starting values for model fitting

start &lt;- list(mu_opt = .8, temperature_xopt = 30)

## We can now call the fitting function

set.seed(12412)
global_MCMC &lt;- fit_multiple_growth_MCMC(start, multiple_experiments, known, sec_names, niter = 1000,
   lower = c(.2, 29),  # lower limits of the model parameters
   upper = c(.8, 34))  # upper limits of the model parameters

## Parameter estimates can be retrieved with summary

summary(global_MCMC)

## We can compare fitted model against observations

plot(global_MCMC)

## Any single environmental factor can be added to the plot using add_factor

plot(global_MCMC, add_factor = "temperature")


</code></pre>

<hr>
<h2 id='fit_secondary_growth'>Fit secondary growth models</h2><span id='topic+fit_secondary_growth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Fits a secondary growth model to a set of growth rates obtained experimentally.
Modelling is done according to the gamma concept proposed by Zwietering (1992)
and cardinal parameter models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_secondary_growth(
  fit_data,
  starting_point,
  known_pars,
  sec_model_names,
  transformation = "sq",
  ...,
  check = TRUE,
  formula = mu ~ .
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_secondary_growth_+3A_fit_data">fit_data</code></td>
<td>
<p>Tibble with the data used for the fit. It must have
one column with the observed growth rate (named <code>mu</code> by default; can be
changed using the &quot;formula&quot; argument) and as many columns
as needed with the environmental factors.</p>
</td></tr>
<tr><td><code id="fit_secondary_growth_+3A_starting_point">starting_point</code></td>
<td>
<p>Named vector with initial values for the model parameters
to estimate from the data. The growth rate under optimum conditions must be named
<code>mu_opt</code>. The rest must be called 'env_factor'+'_'+'parameter'. For instance,
the minimum pH for growth is 'pH_xmin'.</p>
</td></tr>
<tr><td><code id="fit_secondary_growth_+3A_known_pars">known_pars</code></td>
<td>
<p>Named vector of fixed model parameters. Must be named using the
same convention as <code>starting_point</code>.</p>
</td></tr>
<tr><td><code id="fit_secondary_growth_+3A_sec_model_names">sec_model_names</code></td>
<td>
<p>Named character vector defining the secondary model
for each environmental factor.</p>
</td></tr>
<tr><td><code id="fit_secondary_growth_+3A_transformation">transformation</code></td>
<td>
<p>Character defining the transformation of <code>mu</code> for
model fitting. One of <code>sq</code> (square root; default), <code>log</code> (log-transform) or
<code>none</code> (no transformation).</p>
</td></tr>
<tr><td><code id="fit_secondary_growth_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="FME.html#topic+modFit">modFit()</a></code>.</p>
</td></tr>
<tr><td><code id="fit_secondary_growth_+3A_check">check</code></td>
<td>
<p>Whether to do some basic checks (TRUE by default).</p>
</td></tr>
<tr><td><code id="fit_secondary_growth_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot; describing the y variable. The
right hand side must be &quot;.&quot;. By default <code>mu ~ .</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of <code><a href="#topic+FitSecondaryGrowth">FitSecondaryGrowth()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## We use the data included in the package

data("example_cardinal")

## Define the models to fit

sec_model_names &lt;- c(temperature = "Zwietering", pH = "CPM")

## Any model parameter can be fixed

known_pars &lt;- list(mu_opt = 1.2, temperature_n = 1,
    pH_n = 2, pH_xmax = 6.8, pH_xmin = 5.2)

## Initial values must be given for every other parameter

my_start &lt;- list(temperature_xmin = 5, temperature_xopt = 35,
    pH_xopt = 6.5)

## We can now call the fitting function

fit_cardinal &lt;- fit_secondary_growth(example_cardinal, my_start, known_pars, sec_model_names)

## With summary, we can look at the parameter estimates

summary(fit_cardinal)

## The plot function compares predictions against observations

plot(fit_cardinal)

## Passing which = 2, generates a different kind of plot

plot(fit_cardinal, which = 2)
plot(fit_cardinal, which = 2, add_trend = TRUE)
plot(fit_cardinal, which = 2, add_segment = TRUE)

</code></pre>

<hr>
<h2 id='FitDynamicGrowth'>FitDynamicGrowth class</h2><span id='topic+FitDynamicGrowth'></span><span id='topic+print.FitDynamicGrowth'></span><span id='topic+plot.FitDynamicGrowth'></span><span id='topic+summary.FitDynamicGrowth'></span><span id='topic+residuals.FitDynamicGrowth'></span><span id='topic+coef.FitDynamicGrowth'></span><span id='topic+vcov.FitDynamicGrowth'></span><span id='topic+deviance.FitDynamicGrowth'></span><span id='topic+fitted.FitDynamicGrowth'></span><span id='topic+predict.FitDynamicGrowth'></span><span id='topic+logLik.FitDynamicGrowth'></span><span id='topic+AIC.FitDynamicGrowth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>The class <a href="#topic+FitDynamicGrowth">FitDynamicGrowth</a> has been superseded by the top-level
class <a href="#topic+GrowthFit">GrowthFit</a>, which provides a unified approach for growth modelling.
</p>
<p>Still, it is still returned if the superseded <code><a href="#topic+fit_dynamic_growth">fit_dynamic_growth()</a></code> is called.
</p>
<p>It is a subclass of list with the items:
</p>

<ul>
<li><p> fit_results: the object returned by <code>modFit</code>.
</p>
</li>
<li><p> best_prediction: the model prediction for the fitted parameters.
</p>
</li>
<li><p> env_conditions: environmental conditions for the fit.
</p>
</li>
<li><p> data: data used for the fit.
</p>
</li>
<li><p> starting: starting values for model fitting
</p>
</li>
<li><p> known: parameter values set as known.
</p>
</li>
<li><p> sec_models: a named vector with the secondary model
for each environmental factor
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FitDynamicGrowth'
print(x, ...)

## S3 method for class 'FitDynamicGrowth'
plot(
  x,
  y = NULL,
  ...,
  add_factor = NULL,
  ylims = NULL,
  label_y1 = "logN",
  label_y2 = add_factor,
  line_col = "black",
  line_size = 1,
  line_type = 1,
  point_col = "black",
  point_size = 3,
  point_shape = 16,
  line_col2 = "black",
  line_size2 = 1,
  line_type2 = "dashed"
)

## S3 method for class 'FitDynamicGrowth'
summary(object, ...)

## S3 method for class 'FitDynamicGrowth'
residuals(object, ...)

## S3 method for class 'FitDynamicGrowth'
coef(object, ...)

## S3 method for class 'FitDynamicGrowth'
vcov(object, ...)

## S3 method for class 'FitDynamicGrowth'
deviance(object, ...)

## S3 method for class 'FitDynamicGrowth'
fitted(object, ...)

## S3 method for class 'FitDynamicGrowth'
predict(object, times = NULL, newdata = NULL, ...)

## S3 method for class 'FitDynamicGrowth'
logLik(object, ...)

## S3 method for class 'FitDynamicGrowth'
AIC(object, ..., k = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FitDynamicGrowth_+3A_x">x</code></td>
<td>
<p>The object of class <code>FitDynamicGrowth</code> to plot.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_add_factor">add_factor</code></td>
<td>
<p>whether to plot also one environmental factor.
If <code>NULL</code> (default), no environmental factor is plotted. If set
to one character string that matches one entry of x$env_conditions,
that condition is plotted in the secondary axis</p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_ylims">ylims</code></td>
<td>
<p>A two dimensional vector with the limits of the primary y-axis.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_label_y1">label_y1</code></td>
<td>
<p>Label of the primary y-axis.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_label_y2">label_y2</code></td>
<td>
<p>Label of the secondary y-axis.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_line_col">line_col</code></td>
<td>
<p>Aesthetic parameter to change the colour of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_line_size">line_size</code></td>
<td>
<p>Aesthetic parameter to change the thickness of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_line_type">line_type</code></td>
<td>
<p>Aesthetic parameter to change the type of the line geom in the plot, takes numbers (1-6) or strings (&quot;solid&quot;) see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_point_col">point_col</code></td>
<td>
<p>Aesthetic parameter to change the colour of the point geom, see: <code><a href="ggplot2.html#topic+geom_point">geom_point()</a></code></p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_point_size">point_size</code></td>
<td>
<p>Aesthetic parameter to change the size of the point geom, see: <code><a href="ggplot2.html#topic+geom_point">geom_point()</a></code></p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_point_shape">point_shape</code></td>
<td>
<p>Aesthetic parameter to change the shape of the point geom, see: <code><a href="ggplot2.html#topic+geom_point">geom_point()</a></code></p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_line_col2">line_col2</code></td>
<td>
<p>Same as lin_col, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_line_size2">line_size2</code></td>
<td>
<p>Same as line_size, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_line_type2">line_type2</code></td>
<td>
<p>Same as lin_type, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_object">object</code></td>
<td>
<p>an instance of FitDynamicGrowth</p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_times">times</code></td>
<td>
<p>A numeric vector with the time points for the simulations. <code>NULL</code>
by default (using the same time points as those for the simulation).</p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_newdata">newdata</code></td>
<td>
<p>a tibble describing the environmental conditions (as <code>env_conditions</code>)
in <code><a href="#topic+predict_dynamic_growth">predict_dynamic_growth()</a></code>.
If <code>NULL</code> (default), uses the same conditions as those for fitting.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowth_+3A_k">k</code></td>
<td>
<p>penalty for the parameters (k=2 by default)</p>
</td></tr>
</table>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>print(FitDynamicGrowth)</code>: comparison between the fitted model and the data.
</p>
</li>
<li> <p><code>plot(FitDynamicGrowth)</code>: comparison between the fitted model and the data.
</p>
</li>
<li> <p><code>summary(FitDynamicGrowth)</code>: statistical summary of the fit.
</p>
</li>
<li> <p><code>residuals(FitDynamicGrowth)</code>: residuals of the model.
</p>
</li>
<li> <p><code>coef(FitDynamicGrowth)</code>: vector of fitted parameters.
</p>
</li>
<li> <p><code>vcov(FitDynamicGrowth)</code>: (unscaled) variance-covariance matrix of the model,
calculated as 1/(0.5*Hessian)
</p>
</li>
<li> <p><code>deviance(FitDynamicGrowth)</code>: deviance of the model.
</p>
</li>
<li> <p><code>fitted(FitDynamicGrowth)</code>: fitted values.
</p>
</li>
<li> <p><code>predict(FitDynamicGrowth)</code>: model predictions.
</p>
</li>
<li> <p><code>logLik(FitDynamicGrowth)</code>: loglikelihood of the model
</p>
</li>
<li> <p><code>AIC(FitDynamicGrowth)</code>: Akaike Information Criterion
</p>
</li></ul>

<hr>
<h2 id='FitDynamicGrowthMCMC'>FitDynamicGrowthMCMC class</h2><span id='topic+FitDynamicGrowthMCMC'></span><span id='topic+print.FitDynamicGrowthMCMC'></span><span id='topic+plot.FitDynamicGrowthMCMC'></span><span id='topic+summary.FitDynamicGrowthMCMC'></span><span id='topic+residuals.FitDynamicGrowthMCMC'></span><span id='topic+coef.FitDynamicGrowthMCMC'></span><span id='topic+vcov.FitDynamicGrowthMCMC'></span><span id='topic+deviance.FitDynamicGrowthMCMC'></span><span id='topic+fitted.FitDynamicGrowthMCMC'></span><span id='topic+predict.FitDynamicGrowthMCMC'></span><span id='topic+logLik.FitDynamicGrowthMCMC'></span><span id='topic+AIC.FitDynamicGrowthMCMC'></span><span id='topic+predictMCMC.FitDynamicGrowthMCMC'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>The class <a href="#topic+FitDynamicGrowthMCMC">FitDynamicGrowthMCMC</a> has been superseded by the top-level
class <a href="#topic+GrowthFit">GrowthFit</a>, which provides a unified approach for growth modelling.
</p>
<p>Still, it is returned if the superseded <code><a href="#topic+fit_MCMC_growth">fit_MCMC_growth()</a></code> is called.
</p>
<p>It is a subclass of list with the items:
</p>

<ul>
<li><p> fit_results: the object returned by <code>modMCMC</code>.
</p>
</li>
<li><p> best_prediction: the model prediction for the fitted parameters.
</p>
</li>
<li><p> env_conditions: environmental conditions for the fit.
</p>
</li>
<li><p> data: data used for the fit.
</p>
</li>
<li><p> starting: starting values for model fitting
</p>
</li>
<li><p> known: parameter values set as known.
</p>
</li>
<li><p> sec_models: a named vector with the secondary model
for each environmental factor
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FitDynamicGrowthMCMC'
print(x, ...)

## S3 method for class 'FitDynamicGrowthMCMC'
plot(
  x,
  y = NULL,
  ...,
  add_factor = NULL,
  ylims = NULL,
  label_y1 = "logN",
  label_y2 = add_factor,
  line_col = "black",
  line_size = 1,
  line_type = 1,
  point_col = "black",
  point_size = 3,
  point_shape = 16,
  line_col2 = "black",
  line_size2 = 1,
  line_type2 = "dashed"
)

## S3 method for class 'FitDynamicGrowthMCMC'
summary(object, ...)

## S3 method for class 'FitDynamicGrowthMCMC'
residuals(object, ...)

## S3 method for class 'FitDynamicGrowthMCMC'
coef(object, ...)

## S3 method for class 'FitDynamicGrowthMCMC'
vcov(object, ...)

## S3 method for class 'FitDynamicGrowthMCMC'
deviance(object, ...)

## S3 method for class 'FitDynamicGrowthMCMC'
fitted(object, ...)

## S3 method for class 'FitDynamicGrowthMCMC'
predict(object, times = NULL, newdata = NULL, ...)

## S3 method for class 'FitDynamicGrowthMCMC'
logLik(object, ...)

## S3 method for class 'FitDynamicGrowthMCMC'
AIC(object, ..., k = 2)

## S3 method for class 'FitDynamicGrowthMCMC'
predictMCMC(
  model,
  times,
  env_conditions,
  niter,
  newpars = NULL,
  formula = . ~ time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_x">x</code></td>
<td>
<p>The object of class <code>FitDynamicGrowthMCMC</code> to plot.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_add_factor">add_factor</code></td>
<td>
<p>whether to plot also one environmental factor.
If <code>NULL</code> (default), no environmenta factor is plotted. If set
to one character string that matches one entry of x$env_conditions,
that condition is plotted in the secondary axis</p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_ylims">ylims</code></td>
<td>
<p>A two dimensional vector with the limits of the primary y-axis.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_label_y1">label_y1</code></td>
<td>
<p>Label of the primary y-axis.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_label_y2">label_y2</code></td>
<td>
<p>Label of the secondary y-axis.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_line_col">line_col</code></td>
<td>
<p>Aesthetic parameter to change the colour of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_line_size">line_size</code></td>
<td>
<p>Aesthetic parameter to change the thickness of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_line_type">line_type</code></td>
<td>
<p>Aesthetic parameter to change the type of the line geom in the plot, takes numbers (1-6) or strings (&quot;solid&quot;) see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_point_col">point_col</code></td>
<td>
<p>Aesthetic parameter to change the colour of the point geom, see: <code><a href="ggplot2.html#topic+geom_point">geom_point()</a></code></p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_point_size">point_size</code></td>
<td>
<p>Aesthetic parameter to change the size of the point geom, see: <code><a href="ggplot2.html#topic+geom_point">geom_point()</a></code></p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_point_shape">point_shape</code></td>
<td>
<p>Aesthetic parameter to change the shape of the point geom, see: <code><a href="ggplot2.html#topic+geom_point">geom_point()</a></code></p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_line_col2">line_col2</code></td>
<td>
<p>Same as lin_col, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_line_size2">line_size2</code></td>
<td>
<p>Same as line_size, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_line_type2">line_type2</code></td>
<td>
<p>Same as lin_type, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_object">object</code></td>
<td>
<p>an instance of FitDynamicGrowthMCMC</p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_times">times</code></td>
<td>
<p>Numeric vector of storage times for the predictions.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_newdata">newdata</code></td>
<td>
<p>a tibble describing the environmental conditions (as <code>env_conditions</code>)
in <code><a href="#topic+predict_dynamic_growth">predict_dynamic_growth()</a></code>.
If <code>NULL</code> (default), uses the same conditions as those for fitting.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_k">k</code></td>
<td>
<p>penalty for the parameters (k=2 by default)</p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_model">model</code></td>
<td>
<p>An instance of <a href="#topic+FitDynamicGrowthMCMC">FitDynamicGrowthMCMC</a></p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_env_conditions">env_conditions</code></td>
<td>
<p>Tibble with the (dynamic) environmental conditions
during the experiment. It must have one column named 'time' with the
storage time and as many columns as required with the environmental conditions.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_niter">niter</code></td>
<td>
<p>Number of iterations.</p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_newpars">newpars</code></td>
<td>
<p>A named list defining new values for the some model parameters.
The name must be the identifier of a model already included in the model.
These parameters do not include variation, so defining a new value for a fitted
parameters &quot;fixes&quot; it. <code>NULL</code> by default (no new parameters).</p>
</td></tr>
<tr><td><code id="FitDynamicGrowthMCMC_+3A_formula">formula</code></td>
<td>
<p>A formula stating the column named defining the elapsed time in
<code>env_conditions</code>. By default, . ~ time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of <code><a href="#topic+MCMCgrowth">MCMCgrowth()</a></code>.
</p>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>print(FitDynamicGrowthMCMC)</code>: print of the model
</p>
</li>
<li> <p><code>plot(FitDynamicGrowthMCMC)</code>: compares the model fitted against the data.
</p>
</li>
<li> <p><code>summary(FitDynamicGrowthMCMC)</code>: statistical summary of the fit.
</p>
</li>
<li> <p><code>residuals(FitDynamicGrowthMCMC)</code>: model residuals.
</p>
</li>
<li> <p><code>coef(FitDynamicGrowthMCMC)</code>: vector of fitted model parameters.
</p>
</li>
<li> <p><code>vcov(FitDynamicGrowthMCMC)</code>: variance-covariance matrix of the model,
estimated as the variance of the samples from the Markov chain.
</p>
</li>
<li> <p><code>deviance(FitDynamicGrowthMCMC)</code>: deviance of the model, calculated as the sum
of squared residuals for the parameter values resulting in the best fit.
</p>
</li>
<li> <p><code>fitted(FitDynamicGrowthMCMC)</code>: vector of fitted values.
</p>
</li>
<li> <p><code>predict(FitDynamicGrowthMCMC)</code>: vector of model predictions.
</p>
</li>
<li> <p><code>logLik(FitDynamicGrowthMCMC)</code>: loglikelihood of the model
</p>
</li>
<li> <p><code>AIC(FitDynamicGrowthMCMC)</code>: Akaike Information Criterion
</p>
</li>
<li> <p><code>predictMCMC(FitDynamicGrowthMCMC)</code>: prediction including parameter uncertainty
</p>
</li></ul>

<hr>
<h2 id='FitIsoGrowth'>FitIsoGrowth class</h2><span id='topic+FitIsoGrowth'></span><span id='topic+print.FitIsoGrowth'></span><span id='topic+plot.FitIsoGrowth'></span><span id='topic+summary.FitIsoGrowth'></span><span id='topic+residuals.FitIsoGrowth'></span><span id='topic+coef.FitIsoGrowth'></span><span id='topic+vcov.FitIsoGrowth'></span><span id='topic+deviance.FitIsoGrowth'></span><span id='topic+fitted.FitIsoGrowth'></span><span id='topic+predict.FitIsoGrowth'></span><span id='topic+logLik.FitIsoGrowth'></span><span id='topic+AIC.FitIsoGrowth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>The class <a href="#topic+FitIsoGrowth">FitIsoGrowth</a> has been superseded by the top-level
class <a href="#topic+GrowthFit">GrowthFit</a>, which provides a unified approach for growth modelling.
</p>
<p>Still, it is still returned if the superseded <code><a href="#topic+fit_isothermal_growth">fit_isothermal_growth()</a></code> is called.
</p>
<p>It is a subclass of list with the items:
</p>

<ul>
<li><p> data: data used for model fitting
</p>
</li>
<li><p> model: name of the primary inactivation model
</p>
</li>
<li><p> starting_point: initial value of the model parameters
</p>
</li>
<li><p> known: fixed model parameters
</p>
</li>
<li><p> fit: object returned by <code><a href="FME.html#topic+modFit">modFit()</a></code>
</p>
</li>
<li><p> best_prediction: model prediction for the model fitted.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FitIsoGrowth'
print(x, ...)

## S3 method for class 'FitIsoGrowth'
plot(
  x,
  y = NULL,
  ...,
  line_col = "black",
  line_size = 1,
  line_type = 1,
  point_col = "black",
  point_size = 3,
  point_shape = 16
)

## S3 method for class 'FitIsoGrowth'
summary(object, ...)

## S3 method for class 'FitIsoGrowth'
residuals(object, ...)

## S3 method for class 'FitIsoGrowth'
coef(object, ...)

## S3 method for class 'FitIsoGrowth'
vcov(object, ...)

## S3 method for class 'FitIsoGrowth'
deviance(object, ...)

## S3 method for class 'FitIsoGrowth'
fitted(object, ...)

## S3 method for class 'FitIsoGrowth'
predict(object, times = NULL, ...)

## S3 method for class 'FitIsoGrowth'
logLik(object, ...)

## S3 method for class 'FitIsoGrowth'
AIC(object, ..., k = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FitIsoGrowth_+3A_x">x</code></td>
<td>
<p>The object of class <code>FitIsoGrowth</code> to plot.</p>
</td></tr>
<tr><td><code id="FitIsoGrowth_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="FitIsoGrowth_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="FitIsoGrowth_+3A_line_col">line_col</code></td>
<td>
<p>Aesthetic parameter to change the colour of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="FitIsoGrowth_+3A_line_size">line_size</code></td>
<td>
<p>Aesthetic parameter to change the thickness of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="FitIsoGrowth_+3A_line_type">line_type</code></td>
<td>
<p>Aesthetic parameter to change the type of the line geom in the plot, takes numbers (1-6) or strings (&quot;solid&quot;) see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="FitIsoGrowth_+3A_point_col">point_col</code></td>
<td>
<p>Aesthetic parameter to change the colour of the point geom, see: <code><a href="ggplot2.html#topic+geom_point">geom_point()</a></code></p>
</td></tr>
<tr><td><code id="FitIsoGrowth_+3A_point_size">point_size</code></td>
<td>
<p>Aesthetic parameter to change the size of the point geom, see: <code><a href="ggplot2.html#topic+geom_point">geom_point()</a></code></p>
</td></tr>
<tr><td><code id="FitIsoGrowth_+3A_point_shape">point_shape</code></td>
<td>
<p>Aesthetic parameter to change the shape of the point geom, see: <code><a href="ggplot2.html#topic+geom_point">geom_point()</a></code></p>
</td></tr>
<tr><td><code id="FitIsoGrowth_+3A_object">object</code></td>
<td>
<p>an instance of FitIsoGrowth</p>
</td></tr>
<tr><td><code id="FitIsoGrowth_+3A_times">times</code></td>
<td>
<p>numeric vector describing the time points for the prediction.
If <code>NULL</code> (default), uses the same points as those used for fitting.</p>
</td></tr>
<tr><td><code id="FitIsoGrowth_+3A_k">k</code></td>
<td>
<p>penalty for the parameters (k=2 by default)</p>
</td></tr>
</table>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>print(FitIsoGrowth)</code>: print of the model
</p>
</li>
<li> <p><code>plot(FitIsoGrowth)</code>: compares the fitted model against the data.
</p>
</li>
<li> <p><code>summary(FitIsoGrowth)</code>: statistical summary of the fit.
</p>
</li>
<li> <p><code>residuals(FitIsoGrowth)</code>: vector of model residuals.
</p>
</li>
<li> <p><code>coef(FitIsoGrowth)</code>: vector of fitted model parameters.
</p>
</li>
<li> <p><code>vcov(FitIsoGrowth)</code>: variance-covariance matrix of the model, estimated
as 1/(0.5*Hessian)
</p>
</li>
<li> <p><code>deviance(FitIsoGrowth)</code>: deviance of the model.
</p>
</li>
<li> <p><code>fitted(FitIsoGrowth)</code>: vector of fitted values.
</p>
</li>
<li> <p><code>predict(FitIsoGrowth)</code>: vector of model predictions.
</p>
</li>
<li> <p><code>logLik(FitIsoGrowth)</code>: loglikelihood of the model
</p>
</li>
<li> <p><code>AIC(FitIsoGrowth)</code>: Akaike Information Criterion
</p>
</li></ul>

<hr>
<h2 id='FitMultipleDynamicGrowth'>FitMultipleDynamicGrowth class</h2><span id='topic+FitMultipleDynamicGrowth'></span><span id='topic+print.FitMultipleDynamicGrowth'></span><span id='topic+plot.FitMultipleDynamicGrowth'></span><span id='topic+summary.FitMultipleDynamicGrowth'></span><span id='topic+residuals.FitMultipleDynamicGrowth'></span><span id='topic+coef.FitMultipleDynamicGrowth'></span><span id='topic+vcov.FitMultipleDynamicGrowth'></span><span id='topic+deviance.FitMultipleDynamicGrowth'></span><span id='topic+fitted.FitMultipleDynamicGrowth'></span><span id='topic+predict.FitMultipleDynamicGrowth'></span><span id='topic+logLik.FitMultipleDynamicGrowth'></span><span id='topic+AIC.FitMultipleDynamicGrowth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>The class <a href="#topic+FitMultipleDynamicGrowth">FitMultipleDynamicGrowth</a> has been superseded by the top-level
class <a href="#topic+GlobalGrowthFit">GlobalGrowthFit</a>, which provides a unified approach for growth modelling.
</p>
<p>Still, it is still returned if the superseded <code><a href="#topic+fit_multiple_growth">fit_multiple_growth()</a></code> is called.
</p>
<p>It is a subclass of list with the items:
</p>

<ul>
<li><p> fit_results: the object returned by <code>modFit</code>.
</p>
</li>
<li><p> best_prediction: a list with the models predictions for each condition.
</p>
</li>
<li><p> data: a list with the data used for the fit.
</p>
</li>
<li><p> starting: starting values for model fitting
</p>
</li>
<li><p> known: parameter values set as known.
</p>
</li>
<li><p> sec_models: a named vector with the secondary model
for each environmental factor.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FitMultipleDynamicGrowth'
print(x, ...)

## S3 method for class 'FitMultipleDynamicGrowth'
plot(
  x,
  y = NULL,
  ...,
  add_factor = NULL,
  ylims = NULL,
  label_x = "time",
  label_y1 = "logN",
  label_y2 = add_factor,
  line_col = "black",
  line_size = 1,
  line_type = "solid",
  line_col2 = "black",
  line_size2 = 1,
  line_type2 = "dashed",
  point_size = 3,
  point_shape = 16,
  subplot_labels = "AUTO"
)

## S3 method for class 'FitMultipleDynamicGrowth'
summary(object, ...)

## S3 method for class 'FitMultipleDynamicGrowth'
residuals(object, ...)

## S3 method for class 'FitMultipleDynamicGrowth'
coef(object, ...)

## S3 method for class 'FitMultipleDynamicGrowth'
vcov(object, ...)

## S3 method for class 'FitMultipleDynamicGrowth'
deviance(object, ...)

## S3 method for class 'FitMultipleDynamicGrowth'
fitted(object, ...)

## S3 method for class 'FitMultipleDynamicGrowth'
predict(object, env_conditions, times = NULL, ...)

## S3 method for class 'FitMultipleDynamicGrowth'
logLik(object, ...)

## S3 method for class 'FitMultipleDynamicGrowth'
AIC(object, ..., k = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_x">x</code></td>
<td>
<p>an instance of FitMultipleDynamicGrowth.</p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_add_factor">add_factor</code></td>
<td>
<p>whether to plot also one environmental factor.
If <code>NULL</code> (default), no environmental factor is plotted. If set
to one character string that matches one entry of x$env_conditions,
that condition is plotted in the secondary axis</p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_ylims">ylims</code></td>
<td>
<p>A two dimensional vector with the limits of the primary y-axis.</p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_label_x">label_x</code></td>
<td>
<p>label of the x-axis</p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_label_y1">label_y1</code></td>
<td>
<p>Label of the primary y-axis.</p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_label_y2">label_y2</code></td>
<td>
<p>Label of the secondary y-axis.</p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_line_col">line_col</code></td>
<td>
<p>Aesthetic parameter to change the colour of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_line_size">line_size</code></td>
<td>
<p>Aesthetic parameter to change the thickness of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_line_type">line_type</code></td>
<td>
<p>Aesthetic parameter to change the type of the line geom in the plot, takes numbers (1-6) or strings (&quot;solid&quot;) see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_line_col2">line_col2</code></td>
<td>
<p>Same as lin_col, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_line_size2">line_size2</code></td>
<td>
<p>Same as line_size, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_line_type2">line_type2</code></td>
<td>
<p>Same as lin_type, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_point_size">point_size</code></td>
<td>
<p>Size of the data points</p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_point_shape">point_shape</code></td>
<td>
<p>shape of the data points</p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_subplot_labels">subplot_labels</code></td>
<td>
<p>labels of the subplots according to <code>plot_grid</code>.</p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_object">object</code></td>
<td>
<p>an instance of FitMultipleDynamicGrowth</p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_env_conditions">env_conditions</code></td>
<td>
<p>a tibble describing the environmental conditions (as
in <code><a href="#topic+fit_multiple_growth">fit_multiple_growth()</a></code>.</p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_times">times</code></td>
<td>
<p>A numeric vector with the time points for the simulations. <code>NULL</code>
by default (using the same time points as the ones defined in <code>env_conditions</code>).</p>
</td></tr>
<tr><td><code id="FitMultipleDynamicGrowth_+3A_k">k</code></td>
<td>
<p>penalty for the parameters (k=2 by default)</p>
</td></tr>
</table>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>print(FitMultipleDynamicGrowth)</code>: print of the model
</p>
</li>
<li> <p><code>plot(FitMultipleDynamicGrowth)</code>: comparison between the fitted model and
the experimental data.
</p>
</li>
<li> <p><code>summary(FitMultipleDynamicGrowth)</code>: statistical summary of the fit.
</p>
</li>
<li> <p><code>residuals(FitMultipleDynamicGrowth)</code>: calculates the model residuals. Returns a
tibble with 4 columns: time (storage time), logN (observed count),
exp (name of the experiment) and res (residual).
</p>
</li>
<li> <p><code>coef(FitMultipleDynamicGrowth)</code>: vector of fitted parameters.
</p>
</li>
<li> <p><code>vcov(FitMultipleDynamicGrowth)</code>: (unscaled) variance-covariance matrix,
estimated as 1/(0.5*Hessian).
</p>
</li>
<li> <p><code>deviance(FitMultipleDynamicGrowth)</code>: deviance of the model.
</p>
</li>
<li> <p><code>fitted(FitMultipleDynamicGrowth)</code>: fitted values. They are returned as a
tibble with 3 columns: time (storage time), exp (experiment
identifier) and fitted (fitted value).
</p>
</li>
<li> <p><code>predict(FitMultipleDynamicGrowth)</code>: vector of model predictions
</p>
</li>
<li> <p><code>logLik(FitMultipleDynamicGrowth)</code>: loglikelihood of the model
</p>
</li>
<li> <p><code>AIC(FitMultipleDynamicGrowth)</code>: Akaike Information Criterion
</p>
</li></ul>

<hr>
<h2 id='FitMultipleGrowthMCMC'>FitMultipleGrowthMCMC class</h2><span id='topic+FitMultipleGrowthMCMC'></span><span id='topic+print.FitMultipleGrowthMCMC'></span><span id='topic+plot.FitMultipleGrowthMCMC'></span><span id='topic+summary.FitMultipleGrowthMCMC'></span><span id='topic+residuals.FitMultipleGrowthMCMC'></span><span id='topic+coef.FitMultipleGrowthMCMC'></span><span id='topic+vcov.FitMultipleGrowthMCMC'></span><span id='topic+deviance.FitMultipleGrowthMCMC'></span><span id='topic+fitted.FitMultipleGrowthMCMC'></span><span id='topic+predict.FitMultipleGrowthMCMC'></span><span id='topic+logLik.FitMultipleGrowthMCMC'></span><span id='topic+AIC.FitMultipleGrowthMCMC'></span><span id='topic+predictMCMC.FitMultipleGrowthMCMC'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>The class <a href="#topic+FitMultipleGrowthMCMC">FitMultipleGrowthMCMC</a> has been superseded by the top-level
class <a href="#topic+GlobalGrowthFit">GlobalGrowthFit</a>, which provides a unified approach for growth modelling.
</p>
<p>Still, it is still returned if the superseded <code><a href="#topic+fit_multiple_growth_MCMC">fit_multiple_growth_MCMC()</a></code> is called.
</p>
<p>It is a subclass of list with the items:
</p>

<ul>
<li><p> fit_results: the object returned by <code>modFit</code>.
</p>
</li>
<li><p> best_prediction: a list with the models predictions for each condition.
</p>
</li>
<li><p> data: a list with the data used for the fit.
</p>
</li>
<li><p> starting: starting values for model fitting
</p>
</li>
<li><p> known: parameter values set as known.
</p>
</li>
<li><p> sec_models: a named vector with the secondary model
for each environmental factor.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FitMultipleGrowthMCMC'
print(x, ...)

## S3 method for class 'FitMultipleGrowthMCMC'
plot(
  x,
  y = NULL,
  ...,
  add_factor = NULL,
  ylims = NULL,
  label_x = "time",
  label_y1 = "logN",
  label_y2 = add_factor,
  line_col = "black",
  line_size = 1,
  line_type = "solid",
  line_col2 = "black",
  line_size2 = 1,
  line_type2 = "dashed",
  point_size = 3,
  point_shape = 16,
  subplot_labels = "AUTO"
)

## S3 method for class 'FitMultipleGrowthMCMC'
summary(object, ...)

## S3 method for class 'FitMultipleGrowthMCMC'
residuals(object, ...)

## S3 method for class 'FitMultipleGrowthMCMC'
coef(object, ...)

## S3 method for class 'FitMultipleGrowthMCMC'
vcov(object, ...)

## S3 method for class 'FitMultipleGrowthMCMC'
deviance(object, ...)

## S3 method for class 'FitMultipleGrowthMCMC'
fitted(object, ...)

## S3 method for class 'FitMultipleGrowthMCMC'
predict(object, env_conditions, times = NULL, ...)

## S3 method for class 'FitMultipleGrowthMCMC'
logLik(object, ...)

## S3 method for class 'FitMultipleGrowthMCMC'
AIC(object, ..., k = 2)

## S3 method for class 'FitMultipleGrowthMCMC'
predictMCMC(
  model,
  times,
  env_conditions,
  niter,
  newpars = NULL,
  formula = . ~ time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_x">x</code></td>
<td>
<p>an instance of FitMultipleGrowthMCMC.</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_add_factor">add_factor</code></td>
<td>
<p>whether to plot also one environmental factor.
If <code>NULL</code> (default), no environmental factor is plotted. If set
to one character string that matches one entry of x$env_conditions,
that condition is plotted in the secondary axis</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_ylims">ylims</code></td>
<td>
<p>A two dimensional vector with the limits of the primary y-axis.</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_label_x">label_x</code></td>
<td>
<p>label of the x-axis</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_label_y1">label_y1</code></td>
<td>
<p>Label of the primary y-axis.</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_label_y2">label_y2</code></td>
<td>
<p>Label of the secondary y-axis.</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_line_col">line_col</code></td>
<td>
<p>Aesthetic parameter to change the colour of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_line_size">line_size</code></td>
<td>
<p>Aesthetic parameter to change the thickness of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_line_type">line_type</code></td>
<td>
<p>Aesthetic parameter to change the type of the line geom in the plot, takes numbers (1-6) or strings (&quot;solid&quot;) see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_line_col2">line_col2</code></td>
<td>
<p>Same as lin_col, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_line_size2">line_size2</code></td>
<td>
<p>Same as line_size, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_line_type2">line_type2</code></td>
<td>
<p>Same as lin_type, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_point_size">point_size</code></td>
<td>
<p>Size of the data points</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_point_shape">point_shape</code></td>
<td>
<p>shape of the data points</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_subplot_labels">subplot_labels</code></td>
<td>
<p>labels of the subplots according to <code>plot_grid</code>.</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_object">object</code></td>
<td>
<p>an instance of FitMultipleGrowthMCMC</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_env_conditions">env_conditions</code></td>
<td>
<p>Tibble with the (dynamic) environmental conditions
during the experiment. It must have one column named 'time' with the
storage time and as many columns as required with the environmental conditions.</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_times">times</code></td>
<td>
<p>Numeric vector of storage times for the predictions.</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_k">k</code></td>
<td>
<p>penalty for the parameters (k=2 by default)</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_model">model</code></td>
<td>
<p>An instance of <a href="#topic+FitMultipleGrowthMCMC">FitMultipleGrowthMCMC</a></p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_niter">niter</code></td>
<td>
<p>Number of iterations.</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_newpars">newpars</code></td>
<td>
<p>A named list defining new values for the some model parameters.
The name must be the identifier of a model already included in the model.
These parameters do not include variation, so defining a new value for a fitted
parameters &quot;fixes&quot; it. <code>NULL</code> by default (no new parameters).</p>
</td></tr>
<tr><td><code id="FitMultipleGrowthMCMC_+3A_formula">formula</code></td>
<td>
<p>A formula stating the column named defining the elapsed time in
<code>env_conditions</code>. By default, . ~ time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of <code><a href="#topic+MCMCgrowth">MCMCgrowth()</a></code>.
</p>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>print(FitMultipleGrowthMCMC)</code>: print of the model
</p>
</li>
<li> <p><code>plot(FitMultipleGrowthMCMC)</code>: comparison between the model fitted and the
data.
</p>
</li>
<li> <p><code>summary(FitMultipleGrowthMCMC)</code>: statistical summary of the fit.
</p>
</li>
<li> <p><code>residuals(FitMultipleGrowthMCMC)</code>: model residuals. They are returned as a tibble
with 4 columns: time (storage time), logN (observed count),
exp (name of the experiment) and res (residual).
</p>
</li>
<li> <p><code>coef(FitMultipleGrowthMCMC)</code>: vector of fitted model parameters.
</p>
</li>
<li> <p><code>vcov(FitMultipleGrowthMCMC)</code>: variance-covariance matrix of the model,
estimated as the variance of the samples from the Markov chain.
</p>
</li>
<li> <p><code>deviance(FitMultipleGrowthMCMC)</code>: deviance of the model, calculated as the sum of
squared residuals of the prediction with the lowest standard error.
</p>
</li>
<li> <p><code>fitted(FitMultipleGrowthMCMC)</code>: fitted values of the model. They are returned
as a tibble with 3 columns: time (storage time), exp (experiment
identifier) and fitted (fitted value).
</p>
</li>
<li> <p><code>predict(FitMultipleGrowthMCMC)</code>: model predictions. They are returned as a tibble
with 3 columns: time (storage time), logN (observed count),
and exp (name of the experiment).
</p>
</li>
<li> <p><code>logLik(FitMultipleGrowthMCMC)</code>: loglikelihood of the model
</p>
</li>
<li> <p><code>AIC(FitMultipleGrowthMCMC)</code>: Akaike Information Criterion
</p>
</li>
<li> <p><code>predictMCMC(FitMultipleGrowthMCMC)</code>: prediction including parameter uncertainty
</p>
</li></ul>

<hr>
<h2 id='FitSecondaryGrowth'>FitSecondaryGrowth class</h2><span id='topic+FitSecondaryGrowth'></span><span id='topic+print.FitSecondaryGrowth'></span><span id='topic+plot.FitSecondaryGrowth'></span><span id='topic+summary.FitSecondaryGrowth'></span><span id='topic+residuals.FitSecondaryGrowth'></span><span id='topic+coef.FitSecondaryGrowth'></span><span id='topic+vcov.FitSecondaryGrowth'></span><span id='topic+deviance.FitSecondaryGrowth'></span><span id='topic+fitted.FitSecondaryGrowth'></span><span id='topic+predict.FitSecondaryGrowth'></span><span id='topic+logLik.FitSecondaryGrowth'></span><span id='topic+AIC.FitSecondaryGrowth'></span>

<h3>Description</h3>

<p>The <code>FitSecondaryGrowth</code> class contains a model fitted to a set of growth rates
gathered under a variety of static conditions.
Its constructor is <code><a href="#topic+fit_secondary_growth">fit_secondary_growth()</a></code>.
</p>
<p>It is a subclass of list with the items:
</p>

<ul>
<li><p> fit_results: object returned by <code><a href="FME.html#topic+modFit">modFit()</a></code>.
</p>
</li>
<li><p> secondary_model: secondary model fitted to the data.
</p>
</li>
<li><p> mu_opt_fit: estimated growth rate under optimum conditions.
</p>
</li>
<li><p> data: data used for the fit.
</p>
</li>
<li><p> transformation: type of transformation of <code>mu</code> for the fit.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FitSecondaryGrowth'
print(x, ...)

## S3 method for class 'FitSecondaryGrowth'
plot(x, y = NULL, ..., which = 1, add_trend = FALSE, add_segment = FALSE)

## S3 method for class 'FitSecondaryGrowth'
summary(object, ...)

## S3 method for class 'FitSecondaryGrowth'
residuals(object, ...)

## S3 method for class 'FitSecondaryGrowth'
coef(object, ...)

## S3 method for class 'FitSecondaryGrowth'
vcov(object, ...)

## S3 method for class 'FitSecondaryGrowth'
deviance(object, ...)

## S3 method for class 'FitSecondaryGrowth'
fitted(object, ...)

## S3 method for class 'FitSecondaryGrowth'
predict(object, newdata = NULL, ...)

## S3 method for class 'FitSecondaryGrowth'
logLik(object, ...)

## S3 method for class 'FitSecondaryGrowth'
AIC(object, ..., k = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FitSecondaryGrowth_+3A_x">x</code></td>
<td>
<p>An instance of FitSecondaryGrowth.</p>
</td></tr>
<tr><td><code id="FitSecondaryGrowth_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="FitSecondaryGrowth_+3A_y">y</code></td>
<td>
<p>ignored.</p>
</td></tr>
<tr><td><code id="FitSecondaryGrowth_+3A_which">which</code></td>
<td>
<p>A numeric with the type of plot. 1 for obs versus predicted (default),
2 for gamma curve</p>
</td></tr>
<tr><td><code id="FitSecondaryGrowth_+3A_add_trend">add_trend</code></td>
<td>
<p>Whether to add a trend line (only for which=2)</p>
</td></tr>
<tr><td><code id="FitSecondaryGrowth_+3A_add_segment">add_segment</code></td>
<td>
<p>Whether to join the observed and fitted points (only for which=2)</p>
</td></tr>
<tr><td><code id="FitSecondaryGrowth_+3A_object">object</code></td>
<td>
<p>an instance of FitSecondaryGrowth</p>
</td></tr>
<tr><td><code id="FitSecondaryGrowth_+3A_newdata">newdata</code></td>
<td>
<p>A tibble describing the environmental conditions as in
<code><a href="#topic+fit_secondary_growth">fit_secondary_growth()</a></code>. If <code>NULL</code>, it uses the same
conditions as for model fitting (default).</p>
</td></tr>
<tr><td><code id="FitSecondaryGrowth_+3A_k">k</code></td>
<td>
<p>penalty for the parameters (k=2 by default)</p>
</td></tr>
</table>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>print(FitSecondaryGrowth)</code>: print of the model
</p>
</li>
<li> <p><code>plot(FitSecondaryGrowth)</code>: plots to evaluate the goodness of the fit.
</p>
</li>
<li> <p><code>summary(FitSecondaryGrowth)</code>: statistical summary of the fit.
</p>
</li>
<li> <p><code>residuals(FitSecondaryGrowth)</code>: vector of model residuals.
</p>
</li>
<li> <p><code>coef(FitSecondaryGrowth)</code>: vector of fitted model parameters.
</p>
</li>
<li> <p><code>vcov(FitSecondaryGrowth)</code>: variance-covariance matrix of the model, estimated
as 1/(0.5*Hessian)
</p>
</li>
<li> <p><code>deviance(FitSecondaryGrowth)</code>: deviance of the model.
</p>
</li>
<li> <p><code>fitted(FitSecondaryGrowth)</code>: vector of fitted values.
</p>
<p>The fitted values are returned in the same scale as the one
used for the fitting (sqrt, log or none).
</p>
</li>
<li> <p><code>predict(FitSecondaryGrowth)</code>: vector of model predictions.
</p>
</li>
<li> <p><code>logLik(FitSecondaryGrowth)</code>: loglikelihood of the model
</p>
</li>
<li> <p><code>AIC(FitSecondaryGrowth)</code>: Akaike Information Criterion
</p>
</li></ul>

<hr>
<h2 id='full_Ratkowski'>Full Ratkowsky model</h2><span id='topic+full_Ratkowski'></span>

<h3>Description</h3>

<p>Gamma model adapted from the one by Ratkowsky et al. (1983).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>full_Ratkowski(x, xmin, xmax, c)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="full_Ratkowski_+3A_x">x</code></td>
<td>
<p>Value of the environmental factor.</p>
</td></tr>
<tr><td><code id="full_Ratkowski_+3A_xmin">xmin</code></td>
<td>
<p>Minimum value for growth</p>
</td></tr>
<tr><td><code id="full_Ratkowski_+3A_xmax">xmax</code></td>
<td>
<p>Maximum value for growth</p>
</td></tr>
<tr><td><code id="full_Ratkowski_+3A_c">c</code></td>
<td>
<p>Parameter defining the speed of the decline</p>
</td></tr>
</table>

<hr>
<h2 id='get_all_predictions'>A helper for making the plots</h2><span id='topic+get_all_predictions'></span>

<h3>Description</h3>

<p>A helper for making the plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_all_predictions(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_all_predictions_+3A_model">model</code></td>
<td>
<p>An instance of FitMultipleDynamicGrowth</p>
</td></tr>
</table>

<hr>
<h2 id='get_dyna_residuals'>Residuals of dynamic prediction</h2><span id='topic+get_dyna_residuals'></span>

<h3>Description</h3>

<p>Function for calculating residuals of a dynamic prediction according
to the requirements of <code><a href="FME.html#topic+modFit">modFit()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_dyna_residuals(
  this_p,
  fit_data,
  env_conditions,
  known_pars,
  sec_model_names,
  cost = NULL,
  logbase_mu = logbase_logN,
  logbase_logN = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_dyna_residuals_+3A_this_p">this_p</code></td>
<td>
<p>named vector of model parameters</p>
</td></tr>
<tr><td><code id="get_dyna_residuals_+3A_fit_data">fit_data</code></td>
<td>
<p>tibble with the data for the fit</p>
</td></tr>
<tr><td><code id="get_dyna_residuals_+3A_env_conditions">env_conditions</code></td>
<td>
<p>tibble with the environmental conditions</p>
</td></tr>
<tr><td><code id="get_dyna_residuals_+3A_known_pars">known_pars</code></td>
<td>
<p>named vector of known model parameters</p>
</td></tr>
<tr><td><code id="get_dyna_residuals_+3A_sec_model_names">sec_model_names</code></td>
<td>
<p>named character vector with names the
environmental conditions and values the secondary model (e.g. 'CPM').</p>
</td></tr>
<tr><td><code id="get_dyna_residuals_+3A_cost">cost</code></td>
<td>
<p>an instance of modCost to be combined (to fit multiple models).</p>
</td></tr>
<tr><td><code id="get_dyna_residuals_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm of the growthrate.
By default, the same as logbase_logN. See vignette about units for details.</p>
</td></tr>
<tr><td><code id="get_dyna_residuals_+3A_logbase_logn">logbase_logN</code></td>
<td>
<p>Base of the logarithm for the population size. By default,
10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of <code><a href="FME.html#topic+modCost">modCost()</a></code>.
</p>

<hr>
<h2 id='get_iso_residuals'>Residuals of isothermal prediction</h2><span id='topic+get_iso_residuals'></span>

<h3>Description</h3>

<p>Residuals of isothermal prediction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_iso_residuals(
  this_p,
  fit_data,
  model_name,
  known_pars,
  logbase_mu = logbase_logN,
  logbase_logN = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_iso_residuals_+3A_this_p">this_p</code></td>
<td>
<p>named vector of model parameters to fit</p>
</td></tr>
<tr><td><code id="get_iso_residuals_+3A_fit_data">fit_data</code></td>
<td>
<p>tibble with the data for the fit</p>
</td></tr>
<tr><td><code id="get_iso_residuals_+3A_model_name">model_name</code></td>
<td>
<p>character defining the primary growth model</p>
</td></tr>
<tr><td><code id="get_iso_residuals_+3A_known_pars">known_pars</code></td>
<td>
<p>named vector of fixed model parameters</p>
</td></tr>
<tr><td><code id="get_iso_residuals_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, the same as logbase_logN. See vignette about units for details.</p>
</td></tr>
<tr><td><code id="get_iso_residuals_+3A_logbase_logn">logbase_logN</code></td>
<td>
<p>Base of the logarithm for the population size. By default,
10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of <code>modCost</code>.
</p>

<hr>
<h2 id='get_multi_dyna_residuals'>Residuals of multiple dynamic predictions</h2><span id='topic+get_multi_dyna_residuals'></span>

<h3>Description</h3>

<p>Function for calculating residuals of dynamic predictions under
different conditions for the same model parameters according
to the requirements of <code><a href="FME.html#topic+modFit">modFit()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_multi_dyna_residuals(
  this_p,
  experiment_data,
  known_pars,
  sec_model_names,
  logbase_mu = logbase_logN,
  logbase_logN = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_multi_dyna_residuals_+3A_this_p">this_p</code></td>
<td>
<p>named vector of model parameters</p>
</td></tr>
<tr><td><code id="get_multi_dyna_residuals_+3A_experiment_data">experiment_data</code></td>
<td>
<p>a nested list with the experimental data. Each entry describes
one experiment as a list with two elements: data and conditions. <code>data</code> is a tibble
with two columns: time and logN. <code>conditions</code> is a tibble with one column named time
and as many additional columns as environmental factors.</p>
</td></tr>
<tr><td><code id="get_multi_dyna_residuals_+3A_known_pars">known_pars</code></td>
<td>
<p>named vector of known model parameters</p>
</td></tr>
<tr><td><code id="get_multi_dyna_residuals_+3A_sec_model_names">sec_model_names</code></td>
<td>
<p>named character vector with names of the
environmental conditions and values of the secondary model (see secondary_model_data).</p>
</td></tr>
<tr><td><code id="get_multi_dyna_residuals_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, the same as logbase_logN. See vignette about units for details.</p>
</td></tr>
<tr><td><code id="get_multi_dyna_residuals_+3A_logbase_logn">logbase_logN</code></td>
<td>
<p>Base of the logarithm for the population size. By default,
10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an instance of <code>modCost</code>.
</p>

<hr>
<h2 id='get_secondary_residuals'>Residuals of secondary models</h2><span id='topic+get_secondary_residuals'></span>

<h3>Description</h3>

<p>Residual function for <code><a href="#topic+fit_secondary_growth">fit_secondary_growth()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_secondary_residuals(
  this_p,
  my_data,
  known_pars,
  sec_model_names,
  transformation
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_secondary_residuals_+3A_this_p">this_p</code></td>
<td>
<p>Named vector of model parameter values.</p>
</td></tr>
<tr><td><code id="get_secondary_residuals_+3A_my_data">my_data</code></td>
<td>
<p>Tibble with the data used for the fit.</p>
</td></tr>
<tr><td><code id="get_secondary_residuals_+3A_known_pars">known_pars</code></td>
<td>
<p>Named vector of fixed model paramaters.</p>
</td></tr>
<tr><td><code id="get_secondary_residuals_+3A_sec_model_names">sec_model_names</code></td>
<td>
<p>Named character vector defining the secondary model
for each environmental factor.</p>
</td></tr>
<tr><td><code id="get_secondary_residuals_+3A_transformation">transformation</code></td>
<td>
<p>Character defining the tranformation of <code>mu</code> for
model fitting. One of <code>sq</code> (square root), <code>log</code> (log-transform) or
<code>none</code> (no transformation).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of residuals.
</p>

<hr>
<h2 id='GlobalGrowthComparison'>GlobalGrowthComparison class</h2><span id='topic+GlobalGrowthComparison'></span><span id='topic+coef.GlobalGrowthComparison'></span><span id='topic+summary.GlobalGrowthComparison'></span><span id='topic+print.GlobalGrowthComparison'></span><span id='topic+plot.GlobalGrowthComparison'></span>

<h3>Description</h3>

<p>The <code>GlobalGrowthComparison</code> class contains several functions for model comparison
and model selection of growth models. It should not be instanced directly. Instead,
it should be constructed using <code><a href="#topic+compare_growth_fits">compare_growth_fits()</a></code>. It is similar to
<a href="#topic+GrowthComparison">GrowthComparison</a>, although with specific tools to deal with several experiments.
</p>
<p>It includes two type of tools for model selection and comparison: statistical indexes
and visual analyses. Please check the sections below for details.
</p>
<p>Note that all these tools use the names defined in <code><a href="#topic+compare_growth_fits">compare_growth_fits()</a></code>, so
we recommend passing a named list to that function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GlobalGrowthComparison'
coef(object, ...)

## S3 method for class 'GlobalGrowthComparison'
summary(object, ...)

## S3 method for class 'GlobalGrowthComparison'
print(x, ...)

## S3 method for class 'GlobalGrowthComparison'
plot(x, y, ..., type = 1, add_trend = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GlobalGrowthComparison_+3A_object">object</code></td>
<td>
<p>an instance of GlobalGrowthComparison</p>
</td></tr>
<tr><td><code id="GlobalGrowthComparison_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="GlobalGrowthComparison_+3A_x">x</code></td>
<td>
<p>an instance of GlobalGrowthComparison</p>
</td></tr>
<tr><td><code id="GlobalGrowthComparison_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="GlobalGrowthComparison_+3A_type">type</code></td>
<td>
<p>if type==1, the plot compares the model predictions. If type ==2,
the plot compares the parameter estimates. If type==3, the plot shows the residuals</p>
</td></tr>
<tr><td><code id="GlobalGrowthComparison_+3A_add_trend">add_trend</code></td>
<td>
<p>should a trend line of the residuals be added for type==3? <code>TRUE</code>
by default</p>
</td></tr>
</table>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>coef(GlobalGrowthComparison)</code>: table of parameter estimates
</p>
</li>
<li> <p><code>summary(GlobalGrowthComparison)</code>: summary table for the comparison
</p>
</li>
<li> <p><code>print(GlobalGrowthComparison)</code>: print of the model comparison
</p>
</li>
<li> <p><code>plot(GlobalGrowthComparison)</code>: illustrations comparing the fitted models
</p>
</li></ul>


<h3>Statistical indexes</h3>

<p><code>GlobalGrowthComparison</code> implements two S3 methods to obtain numerical values to facilitate
model comparison and selection.
</p>

<ul>
<li><p> the <code>coef</code> method returns a tibble with the values of the parameter estimates
and their corresponding standard errors for each model.
</p>
</li>
<li><p> the <code>summary</code> returns a tibble with the AIC, number of degrees of freedom,
mean error and root mean squared error for each model.
</p>
</li></ul>



<h3>Visual analyses</h3>

<p>The S3 plot method can generate three types of plots:
</p>

<ul>
<li><p> when <code>type = 1</code>, the plot compares the fitted growth curves against the
experimental data used to fit the model.
</p>
</li>
<li><p> when <code>type = 2</code>, the plot compares the parameter estimates using error bars, where
the limits of the error bars are the expected value +/- one standard error. In case
one model does not has some model parameter (i.e. either because it is not defined
or because it was fixed), the parameter is not included in the plot.
</p>
</li>
<li><p> when <code>type=3</code>, the plot shows the tendency of the residuals for each model. This
plot can be used to detect deviations from independence.
</p>
</li></ul>

<p>These plots are divided by facets for each experiment.
</p>

<hr>
<h2 id='GlobalGrowthFit'>GlobalGrowthFit class</h2><span id='topic+GlobalGrowthFit'></span><span id='topic+print.GlobalGrowthFit'></span><span id='topic+coef.GlobalGrowthFit'></span><span id='topic+summary.GlobalGrowthFit'></span><span id='topic+predict.GlobalGrowthFit'></span><span id='topic+residuals.GlobalGrowthFit'></span><span id='topic+vcov.GlobalGrowthFit'></span><span id='topic+deviance.GlobalGrowthFit'></span><span id='topic+fitted.GlobalGrowthFit'></span><span id='topic+logLik.GlobalGrowthFit'></span><span id='topic+AIC.GlobalGrowthFit'></span><span id='topic+plot.GlobalGrowthFit'></span><span id='topic+predictMCMC.GlobalGrowthFit'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>The <code>GlobalGrowthFit</code> class contains a growth model fitted to data
using a global approach. Its constructor is <code><a href="#topic+fit_growth">fit_growth()</a></code>.
</p>
<p>It is a subclass of list with the items:
</p>

<ul>
<li><p> algorithm: type of algorithm as in <code><a href="#topic+fit_growth">fit_growth()</a></code>
</p>
</li>
<li><p> data: data used for model fitting
</p>
</li>
<li><p> start: initial guess of the model parameters
</p>
</li>
<li><p> known: fixed model parameters
</p>
</li>
<li><p> primary_model: a character describing the primary model
</p>
</li>
<li><p> fit_results: an instance of modFit or modMCMC with the results of the fit
</p>
</li>
<li><p> best_prediction: Instance of <a href="#topic+GrowthPrediction">GrowthPrediction</a> with the best growth fit
</p>
</li>
<li><p> sec_models: a named vector with the secondary models assigned for each
environmental factor. <code>NULL</code> for <code>environment="constant"</code>
</p>
</li>
<li><p> env_conditions: a list with the environmental conditions used for model
fitting. <code>NULL</code> for <code>environment="constant"</code>
</p>
</li>
<li><p> niter: number of iterations of the Markov chain. <code>NULL</code> if <code>algorithm != "MCMC"</code>
</p>
</li>
<li><p> logbase_mu: base of the logarithm for the definition of parameter mu
(check the relevant vignette)
</p>
</li>
<li><p> logbase_logN: base of the logarithm for the definition of the population size
(check the relevant vignette)
</p>
</li>
<li><p> environment: &quot;dynamic&quot;. Always
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GlobalGrowthFit'
print(x, ...)

## S3 method for class 'GlobalGrowthFit'
coef(object, ...)

## S3 method for class 'GlobalGrowthFit'
summary(object, ...)

## S3 method for class 'GlobalGrowthFit'
predict(object, env_conditions, times = NULL, ...)

## S3 method for class 'GlobalGrowthFit'
residuals(object, ...)

## S3 method for class 'GlobalGrowthFit'
vcov(object, ...)

## S3 method for class 'GlobalGrowthFit'
deviance(object, ...)

## S3 method for class 'GlobalGrowthFit'
fitted(object, ...)

## S3 method for class 'GlobalGrowthFit'
logLik(object, ...)

## S3 method for class 'GlobalGrowthFit'
AIC(object, ..., k = 2)

## S3 method for class 'GlobalGrowthFit'
plot(
  x,
  y = NULL,
  ...,
  add_factor = NULL,
  ylims = NULL,
  label_x = "time",
  label_y1 = NULL,
  label_y2 = add_factor,
  line_col = "black",
  line_size = 1,
  line_type = "solid",
  line_col2 = "black",
  line_size2 = 1,
  line_type2 = "dashed",
  point_size = 3,
  point_shape = 16,
  subplot_labels = "AUTO"
)

## S3 method for class 'GlobalGrowthFit'
predictMCMC(
  model,
  times,
  env_conditions,
  niter,
  newpars = NULL,
  formula = . ~ time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GlobalGrowthFit_+3A_x">x</code></td>
<td>
<p>an instance of GlobalGrowthFit</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_object">object</code></td>
<td>
<p>an instance of <a href="#topic+GlobalGrowthFit">GlobalGrowthFit</a></p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_env_conditions">env_conditions</code></td>
<td>
<p>Tibble with the (dynamic) environmental conditions
during the experiment. It must have one column named 'time' with the
storage time and as many columns as required with the environmental conditions.</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_times">times</code></td>
<td>
<p>Numeric vector of storage times for the predictions.</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_k">k</code></td>
<td>
<p>penalty for the parameters (k=2 by default)</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_add_factor">add_factor</code></td>
<td>
<p>whether to plot also one environmental factor.
If <code>NULL</code> (default), no environmental factor is plotted. If set
to one character string that matches one entry of x$env_conditions,
that condition is plotted in the secondary axis</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_ylims">ylims</code></td>
<td>
<p>A two dimensional vector with the limits of the primary y-axis.</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_label_x">label_x</code></td>
<td>
<p>label of the x-axis</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_label_y1">label_y1</code></td>
<td>
<p>Label of the primary y-axis.</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_label_y2">label_y2</code></td>
<td>
<p>Label of the secondary y-axis.</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_line_col">line_col</code></td>
<td>
<p>Aesthetic parameter to change the colour of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_line_size">line_size</code></td>
<td>
<p>Aesthetic parameter to change the thickness of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_line_type">line_type</code></td>
<td>
<p>Aesthetic parameter to change the type of the line geom in the plot, takes numbers (1-6) or strings (&quot;solid&quot;) see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_line_col2">line_col2</code></td>
<td>
<p>Same as lin_col, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_line_size2">line_size2</code></td>
<td>
<p>Same as line_size, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_line_type2">line_type2</code></td>
<td>
<p>Same as lin_type, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_point_size">point_size</code></td>
<td>
<p>Size of the data points</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_point_shape">point_shape</code></td>
<td>
<p>shape of the data points</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_subplot_labels">subplot_labels</code></td>
<td>
<p>labels of the subplots according to <code>plot_grid</code>.</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_model">model</code></td>
<td>
<p>An instance of <a href="#topic+GlobalGrowthFit">GlobalGrowthFit</a></p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_niter">niter</code></td>
<td>
<p>Number of iterations.</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_newpars">newpars</code></td>
<td>
<p>A named list defining new values for the some model parameters.
The name must be the identifier of a model already included in the model.
These parameters do not include variation, so defining a new value for a fitted
parameters &quot;fixes&quot; it. <code>NULL</code> by default (no new parameters).</p>
</td></tr>
<tr><td><code id="GlobalGrowthFit_+3A_formula">formula</code></td>
<td>
<p>A formula stating the column named defining the elapsed time in
<code>env_conditions</code>. By default, . ~ time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of <a href="#topic+MCMCgrowth">MCMCgrowth</a>.
</p>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>print(GlobalGrowthFit)</code>: print of the model
</p>
</li>
<li> <p><code>coef(GlobalGrowthFit)</code>: vector of fitted model parameters.
</p>
</li>
<li> <p><code>summary(GlobalGrowthFit)</code>: statistical summary of the fit.
</p>
</li>
<li> <p><code>predict(GlobalGrowthFit)</code>: vector of model predictions
</p>
</li>
<li> <p><code>residuals(GlobalGrowthFit)</code>: model residuals. They are returned as a tibble
with 4 columns: time (storage time), logN (observed count),
exp (name of the experiment) and res (residual).
</p>
</li>
<li> <p><code>vcov(GlobalGrowthFit)</code>: variance-covariance matrix of the model, estimated
as 1/(0.5*Hessian) for regression and as the variance-covariance of the draws
for MCMC
</p>
</li>
<li> <p><code>deviance(GlobalGrowthFit)</code>: deviance of the model.
</p>
</li>
<li> <p><code>fitted(GlobalGrowthFit)</code>: fitted values. They are returned as a
tibble with 3 columns: time (storage time), exp (experiment
identifier) and fitted (fitted value).
</p>
</li>
<li> <p><code>logLik(GlobalGrowthFit)</code>: loglikelihood of the model
</p>
</li>
<li> <p><code>AIC(GlobalGrowthFit)</code>: Akaike Information Criterion
</p>
</li>
<li> <p><code>plot(GlobalGrowthFit)</code>: comparison between the fitted model and
the experimental data.
</p>
</li>
<li> <p><code>predictMCMC(GlobalGrowthFit)</code>: prediction including parameter uncertainty
</p>
</li></ul>

<hr>
<h2 id='greek_tractors'>Number of tractors in Greece according to the World Bank</h2><span id='topic+greek_tractors'></span>

<h3>Description</h3>

<p>A dataset showing the increase in tractors in Greece. It was retrieved
from https://data.worldbank.org/indicator/AG.AGR.TRAC.NO?end=2009&amp;start=1961&amp;view=chart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>greek_tractors
</code></pre>


<h3>Format</h3>

<p>A tibble with 46 rows (each corresponding to one year) and 7 columns:
</p>

<dl>
<dt>year</dt><dd><p>Year for the recording</p>
</dd>
<dt>tractors</dt><dd><p>Number of tractors</p>
</dd>
</dl>


<hr>
<h2 id='growth_pH_temperature'>Example of dynamic growth</h2><span id='topic+growth_pH_temperature'></span>

<h3>Description</h3>

<p>A dataset to demonstrate the use of fit_dynamic_growth. The values of the
environmental conditions are described in conditions_pH_temperature.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>growth_pH_temperature
</code></pre>


<h3>Format</h3>

<p>A tibble with 20 rows and 2 columns:
</p>

<dl>
<dt>time</dt><dd><p>elapsed time</p>
</dd>
<dt>logN</dt><dd><p>decimal logarithm of the population size</p>
</dd>
</dl>


<hr>
<h2 id='growth_salmonella'>Growth of Salmonella spp in broth</h2><span id='topic+growth_salmonella'></span>

<h3>Description</h3>

<p>An example dataset to illustrate <code><a href="#topic+fit_isothermal_growth">fit_isothermal_growth()</a></code>. It
describes the growth of Salmonella spp. in broth. It was retrieved from
ComBase (ID: B092_10).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>growth_salmonella
</code></pre>


<h3>Format</h3>

<p>A tibble with 21 rows and 2 columns:
</p>

<dl>
<dt>time</dt><dd><p>elapsed time in hours.</p>
</dd>
<dt>logN</dt><dd><p>observed population size (log CFU/g).</p>
</dd>
</dl>


<hr>
<h2 id='GrowthComparison'>GrowthComparison class</h2><span id='topic+GrowthComparison'></span><span id='topic+plot.GrowthComparison'></span><span id='topic+coef.GrowthComparison'></span><span id='topic+print.GrowthComparison'></span><span id='topic+summary.GrowthComparison'></span>

<h3>Description</h3>

<p>The <code>GrowthComparison</code> class contains several functions for model comparison
and model selection of growth models. It should not be instanced directly. Instead,
it should be constructed using <code><a href="#topic+compare_growth_fits">compare_growth_fits()</a></code>.
</p>
<p>It includes two type of tools for model selection and comparison: statistical indexes
and visual analyses. Please check the sections below for details.
</p>
<p>Note that all these tools use the names defined in <code><a href="#topic+compare_growth_fits">compare_growth_fits()</a></code>, so
we recommend passing a named list to that function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GrowthComparison'
plot(x, y, ..., type = 1, add_trend = TRUE)

## S3 method for class 'GrowthComparison'
coef(object, ...)

## S3 method for class 'GrowthComparison'
print(x, ...)

## S3 method for class 'GrowthComparison'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GrowthComparison_+3A_x">x</code></td>
<td>
<p>an instance of <a href="#topic+GrowthComparison">GrowthComparison</a></p>
</td></tr>
<tr><td><code id="GrowthComparison_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="GrowthComparison_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="GrowthComparison_+3A_type">type</code></td>
<td>
<p>if type==1, the plot compares the model predictions. If type ==2,
the plot compares the parameter estimates. If type==3, the plot shows the residuals</p>
</td></tr>
<tr><td><code id="GrowthComparison_+3A_add_trend">add_trend</code></td>
<td>
<p>should a trend line of the residuals be added for type==3? <code>TRUE</code>
by default</p>
</td></tr>
<tr><td><code id="GrowthComparison_+3A_object">object</code></td>
<td>
<p>an instance of <a href="#topic+GrowthComparison">GrowthComparison</a></p>
</td></tr>
</table>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>plot(GrowthComparison)</code>: illustrations comparing the fitted models
</p>
</li>
<li> <p><code>coef(GrowthComparison)</code>: table of parameter estimates
</p>
</li>
<li> <p><code>print(GrowthComparison)</code>: print of the model comparison
</p>
</li>
<li> <p><code>summary(GrowthComparison)</code>: summary table for the comparison
</p>
</li></ul>


<h3>Statistical indexes</h3>

<p><code>GrowthComparison</code> implements two S3 methods to obtain numerical values to facilitate
model comparison and selection.
</p>

<ul>
<li><p> the <code>coef</code> method returns a tibble with the values of the parameter estimates
and their corresponding standard errors for each model.
</p>
</li>
<li><p> the <code>summary</code> returns a tibble with the AIC, number of degrees of freedom,
mean error and root mean squared error for each model.
</p>
</li></ul>



<h3>Visual analyses</h3>

<p>The S3 plot method can generate three types of plots:
</p>

<ul>
<li><p> when <code>type = 1</code>, the plot compares the fitted growth curves against the
experimental data used to fit the model.
</p>
</li>
<li><p> when <code>type = 2</code>, the plot compares the parameter estimates using error bars, where
the limits of the error bars are the expected value +/- one standard error. In case
one model does not have some model parameter (i.e. either because it is not defined
or because it was fixed), the parameter is not included in the plot.
</p>
</li>
<li><p> when <code>type=3</code>, the plot shows the tendency of the residuals for each model. This
plot can be used to detect deviations from independence.
</p>
</li></ul>


<hr>
<h2 id='GrowthFit'>GrowthFit class</h2><span id='topic+GrowthFit'></span><span id='topic+print.GrowthFit'></span><span id='topic+coef.GrowthFit'></span><span id='topic+summary.GrowthFit'></span><span id='topic+predict.GrowthFit'></span><span id='topic+residuals.GrowthFit'></span><span id='topic+vcov.GrowthFit'></span><span id='topic+deviance.GrowthFit'></span><span id='topic+fitted.GrowthFit'></span><span id='topic+logLik.GrowthFit'></span><span id='topic+AIC.GrowthFit'></span><span id='topic+plot.GrowthFit'></span><span id='topic+predictMCMC.GrowthFit'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>The <code>GrowthFit</code> class contains a growth model fitted to data under
static or dynamic conditions. Its constructor is <code><a href="#topic+fit_growth">fit_growth()</a></code>.
</p>
<p>It is a subclass of list with the items:
</p>

<ul>
<li><p> environment: type of environment as in <code><a href="#topic+fit_growth">fit_growth()</a></code>
</p>
</li>
<li><p> algorithm: type of algorithm as in <code><a href="#topic+fit_growth">fit_growth()</a></code>
</p>
</li>
<li><p> data: data used for model fitting
</p>
</li>
<li><p> start: initial guess of the model parameters
</p>
</li>
<li><p> known: fixed model parameters
</p>
</li>
<li><p> primary_model: a character describing the primary model
</p>
</li>
<li><p> fit_results: an instance of modFit or modMCMC with the results of the fit
</p>
</li>
<li><p> best_prediction: Instance of <a href="#topic+GrowthPrediction">GrowthPrediction</a> with the best growth fit
</p>
</li>
<li><p> sec_models: a named vector with the secondary models assigned for each
environmental factor. <code>NULL</code> for <code>environment="constant"</code>
</p>
</li>
<li><p> env_conditions: a tibble with the environmental conditions used for model
fitting. <code>NULL</code> for <code>environment="constant"</code>
</p>
</li>
<li><p> niter: number of iterations of the Markov chain. <code>NULL</code> if <code>algorithm != "MCMC"</code>
</p>
</li>
<li><p> logbase_mu: base of the logarithm for the definition of parameter mu
(check the relevant vignette)
</p>
</li>
<li><p> logbase_logN: base of the logarithm for the definition of the population size
(check the relevant vignette)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GrowthFit'
print(x, ...)

## S3 method for class 'GrowthFit'
coef(object, ...)

## S3 method for class 'GrowthFit'
summary(object, ...)

## S3 method for class 'GrowthFit'
predict(object, times = NULL, env_conditions = NULL, ...)

## S3 method for class 'GrowthFit'
residuals(object, ...)

## S3 method for class 'GrowthFit'
vcov(object, ...)

## S3 method for class 'GrowthFit'
deviance(object, ...)

## S3 method for class 'GrowthFit'
fitted(object, ...)

## S3 method for class 'GrowthFit'
logLik(object, ...)

## S3 method for class 'GrowthFit'
AIC(object, ..., k = 2)

## S3 method for class 'GrowthFit'
plot(
  x,
  y = NULL,
  ...,
  add_factor = NULL,
  line_col = "black",
  line_size = 1,
  line_type = 1,
  point_col = "black",
  point_size = 3,
  point_shape = 16,
  ylims = NULL,
  label_y1 = NULL,
  label_y2 = add_factor,
  label_x = "time",
  line_col2 = "black",
  line_size2 = 1,
  line_type2 = "dashed"
)

## S3 method for class 'GrowthFit'
predictMCMC(
  model,
  times,
  env_conditions,
  niter,
  newpars = NULL,
  formula = . ~ time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GrowthFit_+3A_x">x</code></td>
<td>
<p>The object of class <a href="#topic+GrowthFit">GrowthFit</a> to plot.</p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_...">...</code></td>
<td>
<p>ignored.</p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_object">object</code></td>
<td>
<p>an instance of GrowthFit</p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_times">times</code></td>
<td>
<p>Numeric vector of storage times for the predictions.</p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_env_conditions">env_conditions</code></td>
<td>
<p>Tibble with the (dynamic) environmental conditions
during the experiment. It must have one column named 'time' with the
storage time and as many columns as required with the environmental conditions.</p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_k">k</code></td>
<td>
<p>penalty for the parameters (k=2 by default)</p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_add_factor">add_factor</code></td>
<td>
<p>whether to plot also one environmental factor.
If <code>NULL</code> (default), no environmental factor is plotted. If set
to one character string that matches one entry of x$env_conditions,
that condition is plotted in the secondary axis. Ignored if <code>environment="constant"</code></p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_line_col">line_col</code></td>
<td>
<p>Aesthetic parameter to change the colour of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_line_size">line_size</code></td>
<td>
<p>Aesthetic parameter to change the thickness of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_line_type">line_type</code></td>
<td>
<p>Aesthetic parameter to change the type of the line geom in the plot, takes numbers (1-6) or strings (&quot;solid&quot;) see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_point_col">point_col</code></td>
<td>
<p>Aesthetic parameter to change the colour of the point geom, see: <code><a href="ggplot2.html#topic+geom_point">geom_point()</a></code></p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_point_size">point_size</code></td>
<td>
<p>Aesthetic parameter to change the size of the point geom, see: <code><a href="ggplot2.html#topic+geom_point">geom_point()</a></code></p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_point_shape">point_shape</code></td>
<td>
<p>Aesthetic parameter to change the shape of the point geom, see: <code><a href="ggplot2.html#topic+geom_point">geom_point()</a></code></p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_ylims">ylims</code></td>
<td>
<p>A two dimensional vector with the limits of the primary y-axis.
<code>NULL</code> by default</p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_label_y1">label_y1</code></td>
<td>
<p>Label of the primary y-axis.</p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_label_y2">label_y2</code></td>
<td>
<p>Label of the secondary y-axis. Ignored if <code>environment="constant"</code></p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_label_x">label_x</code></td>
<td>
<p>Label of the x-axis</p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_line_col2">line_col2</code></td>
<td>
<p>Same as lin_col, but for the environmental factor. Ignored if <code>environment="constant"</code></p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_line_size2">line_size2</code></td>
<td>
<p>Same as line_size, but for the environmental factor. Ignored if <code>environment="constant"</code></p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_line_type2">line_type2</code></td>
<td>
<p>Same as lin_type, but for the environmental factor. Ignored if <code>environment="constant"</code></p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_model">model</code></td>
<td>
<p>An instance of <a href="#topic+GrowthFit">GrowthFit</a></p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_niter">niter</code></td>
<td>
<p>Number of iterations.</p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_newpars">newpars</code></td>
<td>
<p>A named list defining new values for the some model parameters.
The name must be the identifier of a model already included in the model.
These parameters do not include variation, so defining a new value for a fitted
parameters &quot;fixes&quot; it. <code>NULL</code> by default (no new parameters).</p>
</td></tr>
<tr><td><code id="GrowthFit_+3A_formula">formula</code></td>
<td>
<p>A formula stating the column named defining the elapsed time in
<code>env_conditions</code>. By default, . ~ time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of <a href="#topic+MCMCgrowth">MCMCgrowth</a>.
</p>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>print(GrowthFit)</code>: print of the model
</p>
</li>
<li> <p><code>coef(GrowthFit)</code>: vector of fitted model parameters.
</p>
</li>
<li> <p><code>summary(GrowthFit)</code>: statistical summary of the fit.
</p>
</li>
<li> <p><code>predict(GrowthFit)</code>: vector of model predictions.
</p>
</li>
<li> <p><code>residuals(GrowthFit)</code>: vector of model residuals.
</p>
</li>
<li> <p><code>vcov(GrowthFit)</code>: variance-covariance matrix of the model, estimated
as 1/(0.5*Hessian) for regression and as the variance-covariance of the draws
for MCMC
</p>
</li>
<li> <p><code>deviance(GrowthFit)</code>: deviance of the model.
</p>
</li>
<li> <p><code>fitted(GrowthFit)</code>: vector of fitted values.
</p>
</li>
<li> <p><code>logLik(GrowthFit)</code>: loglikelihood of the model
</p>
</li>
<li> <p><code>AIC(GrowthFit)</code>: Akaike Information Criterion
</p>
</li>
<li> <p><code>plot(GrowthFit)</code>: compares the fitted model against the data.
</p>
</li>
<li> <p><code>predictMCMC(GrowthFit)</code>: prediction including parameter uncertainty
</p>
</li></ul>

<hr>
<h2 id='GrowthPrediction'>GrowthPrediction class</h2><span id='topic+GrowthPrediction'></span><span id='topic+print.GrowthPrediction'></span><span id='topic+summary.GrowthPrediction'></span><span id='topic+plot.GrowthPrediction'></span><span id='topic+coef.GrowthPrediction'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>The <code>GrowthPrediction</code> class contains the results of a growth prediction.
Its constructor is <code><a href="#topic+predict_growth">predict_growth()</a></code>.
</p>
<p>It is a subclass of list with the items:
</p>

<ul>
<li><p> simulation: a tibble with the model simulation
</p>
</li>
<li><p> primary model: a list describing the primary model as in <code><a href="#topic+predict_growth">predict_growth()</a></code>
</p>
</li>
<li><p> environment: a character describing the type of environmental conditions
as in <code><a href="#topic+predict_growth">predict_growth()</a></code>
</p>
</li>
<li><p> env_conditions: a named list with the functions used to approximate the (dynamic)
environmental conditions. <code>NULL</code> if <code>environment="constant"</code>.
</p>
</li>
<li><p> sec_models: a named list describing the secondary models as in <code><a href="#topic+predict_growth">predict_growth()</a></code>.
<code>NULL</code> if <code>environment="constant"</code>.
</p>
</li>
<li><p> gammas: a tibble describing the variation of the gamma factors through the experiment.
<code>NUll</code> if <code>environment="constant"</code>.
</p>
</li>
<li><p> logbase_mu: the log-base for the definition of parameter mu (see the relevant vignette)
</p>
</li>
<li><p> logbase_logN: the log-base for the definition of the logarithm of the population size
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GrowthPrediction'
print(x, ...)

## S3 method for class 'GrowthPrediction'
summary(object, ...)

## S3 method for class 'GrowthPrediction'
plot(
  x,
  y = NULL,
  ...,
  add_factor = NULL,
  ylims = NULL,
  label_y1 = NULL,
  label_y2 = add_factor,
  line_col = "black",
  line_size = 1,
  line_type = "solid",
  line_col2 = "black",
  line_size2 = 1,
  line_type2 = "dashed",
  label_x = "time"
)

## S3 method for class 'GrowthPrediction'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GrowthPrediction_+3A_x">x</code></td>
<td>
<p>The object of class <code>GrowthPrediction</code> to plot.</p>
</td></tr>
<tr><td><code id="GrowthPrediction_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="GrowthPrediction_+3A_object">object</code></td>
<td>
<p>an instance of <a href="#topic+GrowthPrediction">GrowthPrediction</a></p>
</td></tr>
<tr><td><code id="GrowthPrediction_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="GrowthPrediction_+3A_add_factor">add_factor</code></td>
<td>
<p>whether to plot also one environmental factor.
If <code>NULL</code> (default), no environmental factor is plotted. If set
to one character string that matches one entry of x$env_conditions,
that condition is plotted in the secondary axis. Ignored for <code>environment="constant"</code>.</p>
</td></tr>
<tr><td><code id="GrowthPrediction_+3A_ylims">ylims</code></td>
<td>
<p>A two dimensional vector with the limits of the primary y-axis.</p>
</td></tr>
<tr><td><code id="GrowthPrediction_+3A_label_y1">label_y1</code></td>
<td>
<p>Label of the primary y-axis.</p>
</td></tr>
<tr><td><code id="GrowthPrediction_+3A_label_y2">label_y2</code></td>
<td>
<p>Label of the secondary y-axis.</p>
</td></tr>
<tr><td><code id="GrowthPrediction_+3A_line_col">line_col</code></td>
<td>
<p>Aesthetic parameter to change the colour of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="GrowthPrediction_+3A_line_size">line_size</code></td>
<td>
<p>Aesthetic parameter to change the thickness of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="GrowthPrediction_+3A_line_type">line_type</code></td>
<td>
<p>Aesthetic parameter to change the type of the line geom in the plot, takes numbers (1-6) or strings (&quot;solid&quot;) see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="GrowthPrediction_+3A_line_col2">line_col2</code></td>
<td>
<p>Same as lin_col, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="GrowthPrediction_+3A_line_size2">line_size2</code></td>
<td>
<p>Same as line_size, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="GrowthPrediction_+3A_line_type2">line_type2</code></td>
<td>
<p>Same as lin_type, but for the environmental factor.</p>
</td></tr>
<tr><td><code id="GrowthPrediction_+3A_label_x">label_x</code></td>
<td>
<p>Label of the x-axis.</p>
</td></tr>
</table>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>print(GrowthPrediction)</code>: print of the model
</p>
</li>
<li> <p><code>summary(GrowthPrediction)</code>: summary of the model
</p>
</li>
<li> <p><code>plot(GrowthPrediction)</code>: predicted growth curve.
</p>
</li>
<li> <p><code>coef(GrowthPrediction)</code>: coefficients of the model
</p>
</li></ul>

<hr>
<h2 id='GrowthUncertainty'>GrowthUncertainty class</h2><span id='topic+GrowthUncertainty'></span><span id='topic+print.GrowthUncertainty'></span><span id='topic+plot.GrowthUncertainty'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>The <code>GrowthUncertainty</code> class contains the results of a growth prediction
under isothermal conditions considering parameter uncertainty. Its constructor
is <code><a href="#topic+predict_growth_uncertainty">predict_growth_uncertainty()</a></code>.
</p>
<p>It is a subclass of list with the items:
</p>

<ul>
<li><p> sample: parameter sample used for the calculations.
</p>
</li>
<li><p> simulations: growth curves predicted for each parameter.
</p>
</li>
<li><p> quantiles: limits of the credible intervals (5%, 10%, 50%, 90%, 95%) for
each time point.
</p>
</li>
<li><p> model: Model used for the calculations.
</p>
</li>
<li><p> mus: Mean parameter values used for the simulations.
</p>
</li>
<li><p> sigma: Variance-covariance matrix used for the simulations.
</p>
</li>
<li><p> logbase_mu: base of the logarithm for the definition of parameter mu
(check the relevant vignette)
</p>
</li>
<li><p> logbase_logN: base of the logarithm for the definition of the population size
(check the relevant vignette)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GrowthUncertainty'
print(x, ...)

## S3 method for class 'GrowthUncertainty'
plot(
  x,
  y = NULL,
  ...,
  line_col = "black",
  line_size = 0.5,
  line_type = "solid",
  ribbon80_fill = "grey",
  ribbon90_fill = "grey",
  alpha80 = 0.5,
  alpha90 = 0.4
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GrowthUncertainty_+3A_x">x</code></td>
<td>
<p>The object of class <code>GrowthUncertainty</code> to plot.</p>
</td></tr>
<tr><td><code id="GrowthUncertainty_+3A_...">...</code></td>
<td>
<p>ignored.</p>
</td></tr>
<tr><td><code id="GrowthUncertainty_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="GrowthUncertainty_+3A_line_col">line_col</code></td>
<td>
<p>Aesthetic parameter to change the colour of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="GrowthUncertainty_+3A_line_size">line_size</code></td>
<td>
<p>Aesthetic parameter to change the thickness of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="GrowthUncertainty_+3A_line_type">line_type</code></td>
<td>
<p>Aesthetic parameter to change the type of the line geom in the plot, takes numbers (1-6) or strings (&quot;solid&quot;) see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="GrowthUncertainty_+3A_ribbon80_fill">ribbon80_fill</code></td>
<td>
<p>fill colour for the space between the 10th and 90th quantile, see: <code><a href="ggplot2.html#topic+geom_ribbon">geom_ribbon()</a></code></p>
</td></tr>
<tr><td><code id="GrowthUncertainty_+3A_ribbon90_fill">ribbon90_fill</code></td>
<td>
<p>fill colour for the space between the 5th and 95th quantile, see: <code><a href="ggplot2.html#topic+geom_ribbon">geom_ribbon()</a></code></p>
</td></tr>
<tr><td><code id="GrowthUncertainty_+3A_alpha80">alpha80</code></td>
<td>
<p>transparency of the ribbon aesthetic for the space between the 10th and 90th quantile. Takes a value between 0 (fully transparant) and 1 (fully opaque)</p>
</td></tr>
<tr><td><code id="GrowthUncertainty_+3A_alpha90">alpha90</code></td>
<td>
<p>transparency of the ribbon aesthetic for the space between the 5th and 95th quantile. Takes a value between 0 (fully transparant) and 1 (fully opaque).</p>
</td></tr>
</table>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>print(GrowthUncertainty)</code>: print of the model
</p>
</li>
<li> <p><code>plot(GrowthUncertainty)</code>: Growth prediction (prediction band) considering
parameter uncertainty.
</p>
</li></ul>

<hr>
<h2 id='is.DynamicGrowth'>Test of DynamicGrowth object</h2><span id='topic+is.DynamicGrowth'></span>

<h3>Description</h3>

<p>Tests if an object is of class <code>DynamicGrowth</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.DynamicGrowth(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.DynamicGrowth_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A boolean specifying whether <code>x</code> is of class
<code>DynamicGrowth</code>
</p>

<hr>
<h2 id='is.FitDynamicGrowth'>Test of FitDynamicGrowth object</h2><span id='topic+is.FitDynamicGrowth'></span>

<h3>Description</h3>

<p>Tests if an object is of class <code>FitDynamicGrowth</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.FitDynamicGrowth(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.FitDynamicGrowth_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A boolean specifying whether <code>x</code> is of class
<code>FitDynamicGrowth</code>
</p>

<hr>
<h2 id='is.FitDynamicGrowthMCMC'>Test of FitDynamicGrowthMCMC object</h2><span id='topic+is.FitDynamicGrowthMCMC'></span>

<h3>Description</h3>

<p>Tests if an object is of class <code>FitDynamicGrowthMCMC</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.FitDynamicGrowthMCMC(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.FitDynamicGrowthMCMC_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A boolean specifying whether <code>x</code> is of class
<code>FitDynamicGrowthMCMC</code>
</p>

<hr>
<h2 id='is.FitIsoGrowth'>Test of FitIsoGrowth object</h2><span id='topic+is.FitIsoGrowth'></span>

<h3>Description</h3>

<p>Tests if an object is of class <code>FitIsoGrowth</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.FitIsoGrowth(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.FitIsoGrowth_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A boolean specifying whether <code>x</code> is of class
<code>FitIsoGrowth</code>
</p>

<hr>
<h2 id='is.FitMultipleDynamicGrowth'>Test of FitMultipleDynamicGrowth object</h2><span id='topic+is.FitMultipleDynamicGrowth'></span>

<h3>Description</h3>

<p>Tests if an object is of class <code>FitMultipleDynamicGrowth</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.FitMultipleDynamicGrowth(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.FitMultipleDynamicGrowth_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A boolean specifying whether <code>x</code> is of class
<code>FitMultipleDynamicGrowth</code>
</p>

<hr>
<h2 id='is.FitMultipleDynamicGrowthMCMC'>Test of FitMultipleDynamicGrowthMCMC object</h2><span id='topic+is.FitMultipleDynamicGrowthMCMC'></span>

<h3>Description</h3>

<p>Tests if an object is of class <code>FitMultipleDynamicGrowthMCMC</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.FitMultipleDynamicGrowthMCMC(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.FitMultipleDynamicGrowthMCMC_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A boolean specifying whether <code>x</code> is of class
<code>FitMultipleDynamicGrowthMCMC</code>
</p>

<hr>
<h2 id='is.FitSecondaryGrowth'>Test of FitSecondaryGrowth object</h2><span id='topic+is.FitSecondaryGrowth'></span>

<h3>Description</h3>

<p>Tests if an object is of class <code>FitSecondaryGrowth</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.FitSecondaryGrowth(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.FitSecondaryGrowth_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A boolean specifying whether <code>x</code> is of class
<code>FitSecondaryGrowth</code>
</p>

<hr>
<h2 id='is.GlobalGrowthFit'>Test of GlobalGrowthFit object</h2><span id='topic+is.GlobalGrowthFit'></span>

<h3>Description</h3>

<p>Tests if an object is of class <a href="#topic+GlobalGrowthFit">GlobalGrowthFit</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.GlobalGrowthFit(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.GlobalGrowthFit_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A boolean specifying whether <code>x</code> is of class GlobalGrowthFit
</p>

<hr>
<h2 id='is.GrowthFit'>Test of GrowthFit object</h2><span id='topic+is.GrowthFit'></span>

<h3>Description</h3>

<p>Tests if an object is of class <a href="#topic+GrowthFit">GrowthFit</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.GrowthFit(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.GrowthFit_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A boolean specifying whether <code>x</code> is of class GrowthFit
</p>

<hr>
<h2 id='is.GrowthPrediction'>Test of GrowthPrediction object</h2><span id='topic+is.GrowthPrediction'></span>

<h3>Description</h3>

<p>Tests if an object is of class <a href="#topic+GrowthPrediction">GrowthPrediction</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.GrowthPrediction(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.GrowthPrediction_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A boolean specifying whether <code>x</code> is of class GrowthPrediction
</p>

<hr>
<h2 id='is.GrowthUncertainty'>Test of GrowthUncertainty object</h2><span id='topic+is.GrowthUncertainty'></span>

<h3>Description</h3>

<p>Tests if an object is of class <a href="#topic+GrowthUncertainty">GrowthUncertainty</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.GrowthUncertainty(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.GrowthUncertainty_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A boolean specifying whether <code>x</code> is of class GrowthUncertainty
</p>

<hr>
<h2 id='is.IsothermalGrowth'>Test of IsothermalGrowth object</h2><span id='topic+is.IsothermalGrowth'></span>

<h3>Description</h3>

<p>Tests if an object is of class <code>IsothermalGrowth</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.IsothermalGrowth(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.IsothermalGrowth_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A boolean specifying whether <code>x</code> is of class
<code>IsothermalGrowth</code>
</p>

<hr>
<h2 id='is.MCMCgrowth'>Test of MCMCgrowth object</h2><span id='topic+is.MCMCgrowth'></span>

<h3>Description</h3>

<p>Tests if an object is of class <code>MCMCgrowth</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.MCMCgrowth(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.MCMCgrowth_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A boolean specifying whether <code>x</code> is of class
<code>MCMCgrowth</code>
</p>

<hr>
<h2 id='is.StochasticGrowth'>Test of StochasticGrowth object</h2><span id='topic+is.StochasticGrowth'></span>

<h3>Description</h3>

<p>Tests if an object is of class <code>StochasticGrowth</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.StochasticGrowth(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.StochasticGrowth_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A boolean specifying whether <code>x</code> is of class
<code>StochasticGrowth</code>
</p>

<hr>
<h2 id='iso_Baranyi'>Isothermal Baranyi model</h2><span id='topic+iso_Baranyi'></span>

<h3>Description</h3>

<p>Baranyi growth model as defined by Baranyi and Roberts (1994). We use the solution
calculated by Poschet et al. (2005, doi: https://doi.org/10.1016/j.ijfoodmicro.2004.10.008)
after log-transformation according to MONTE CARLO ANALYSIS FOR MICROBIAL GROWTH CURVES,
by Oksuz and Buzrul.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iso_Baranyi(times, logN0, mu, lambda, logNmax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iso_Baranyi_+3A_times">times</code></td>
<td>
<p>Numeric vector of storage times</p>
</td></tr>
<tr><td><code id="iso_Baranyi_+3A_logn0">logN0</code></td>
<td>
<p>Initial log microbial count</p>
</td></tr>
<tr><td><code id="iso_Baranyi_+3A_mu">mu</code></td>
<td>
<p>Maximum specific growth rate (in ln CFU/<a href="base.html#topic+t">t</a>)</p>
</td></tr>
<tr><td><code id="iso_Baranyi_+3A_lambda">lambda</code></td>
<td>
<p>Lag phase duration</p>
</td></tr>
<tr><td><code id="iso_Baranyi_+3A_lognmax">logNmax</code></td>
<td>
<p>Maximum log microbial count</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector with the predicted microbial count.
</p>

<hr>
<h2 id='iso_repGompertz'>Reparameterized Gompertz model</h2><span id='topic+iso_repGompertz'></span><span id='topic+modGompertz'></span><span id='topic+gompertz'></span>

<h3>Description</h3>

<p>Reparameterized Gompertz growth model defined by Zwietering et al. (1990).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iso_repGompertz(times, logN0, C, mu, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iso_repGompertz_+3A_times">times</code></td>
<td>
<p>Numeric vector of storage times</p>
</td></tr>
<tr><td><code id="iso_repGompertz_+3A_logn0">logN0</code></td>
<td>
<p>Initial log microbial count</p>
</td></tr>
<tr><td><code id="iso_repGompertz_+3A_c">C</code></td>
<td>
<p>Difference between <code>logN0</code> and the maximum log-count.</p>
</td></tr>
<tr><td><code id="iso_repGompertz_+3A_mu">mu</code></td>
<td>
<p>Maximum specific growth rate (in ln CFU/<a href="base.html#topic+t">t</a>)</p>
</td></tr>
<tr><td><code id="iso_repGompertz_+3A_lambda">lambda</code></td>
<td>
<p>Lag phase duration</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector with the predicted microbial count.
</p>

<hr>
<h2 id='IsothermalGrowth'>IsothermalGrowth class</h2><span id='topic+IsothermalGrowth'></span><span id='topic+print.IsothermalGrowth'></span><span id='topic+plot.IsothermalGrowth'></span><span id='topic+coef.IsothermalGrowth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>The class <a href="#topic+IsothermalGrowth">IsothermalGrowth</a> has been superseded by the top-level
class <a href="#topic+GrowthPrediction">GrowthPrediction</a>, which provides a unified approach for growth modelling.
</p>
<p>Still, it is still returned if the superseded <code><a href="#topic+predict_isothermal_growth">predict_isothermal_growth()</a></code> is called.
</p>
<p>It is a subclass of list with the items:
</p>

<ul>
<li><p> simulation: A tibble with the model simulation.
</p>
</li>
<li><p> model: The name of the model used for the predictions.
</p>
</li>
<li><p> pars: A list with the values of the model parameters.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'IsothermalGrowth'
print(x, ...)

## S3 method for class 'IsothermalGrowth'
plot(
  x,
  y = NULL,
  ...,
  line_col = "black",
  line_size = 1,
  line_type = "solid",
  ylims = NULL,
  label_y = NULL,
  label_x = "time"
)

## S3 method for class 'IsothermalGrowth'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IsothermalGrowth_+3A_x">x</code></td>
<td>
<p>The object of class <a href="#topic+IsothermalGrowth">IsothermalGrowth</a> to plot.</p>
</td></tr>
<tr><td><code id="IsothermalGrowth_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="IsothermalGrowth_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="IsothermalGrowth_+3A_line_col">line_col</code></td>
<td>
<p>Aesthetic parameter to change the colour of the line,
see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="IsothermalGrowth_+3A_line_size">line_size</code></td>
<td>
<p>Aesthetic parameter to change the thickness of the line,
see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="IsothermalGrowth_+3A_line_type">line_type</code></td>
<td>
<p>Aesthetic parameter to change the type of the line,
takes numbers (1-6) or strings (&quot;solid&quot;) see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="IsothermalGrowth_+3A_ylims">ylims</code></td>
<td>
<p>Two-dimensional numeric vector with the limits of the y-axis
(or <code>NULL</code>, which is the default)</p>
</td></tr>
<tr><td><code id="IsothermalGrowth_+3A_label_y">label_y</code></td>
<td>
<p>Title of the y-axis</p>
</td></tr>
<tr><td><code id="IsothermalGrowth_+3A_label_x">label_x</code></td>
<td>
<p>Title of the x-axis</p>
</td></tr>
<tr><td><code id="IsothermalGrowth_+3A_object">object</code></td>
<td>
<p>an instance of <a href="#topic+IsothermalGrowth">IsothermalGrowth</a></p>
</td></tr>
</table>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>print(IsothermalGrowth)</code>: print of the model
</p>
</li>
<li> <p><code>plot(IsothermalGrowth)</code>: plot of the predicted growth curve.
</p>
</li>
<li> <p><code>coef(IsothermalGrowth)</code>: coefficients of the model
</p>
</li></ul>

<hr>
<h2 id='lambda_to_Q0'>Q0 from lag phase duration</h2><span id='topic+lambda_to_Q0'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Convenience function to calculate the value of Q0 for the Baranyi model from
the duration of the lag phase
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambda_to_Q0(lambda, mu, logbase_mu = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambda_to_Q0_+3A_lambda">lambda</code></td>
<td>
<p>Duration of the lag phase.</p>
</td></tr>
<tr><td><code id="lambda_to_Q0_+3A_mu">mu</code></td>
<td>
<p>Specific growth rate in the exponential phase.</p>
</td></tr>
<tr><td><code id="lambda_to_Q0_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, 10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
</table>

<hr>
<h2 id='logistic_model'>Logistic growth model</h2><span id='topic+logistic_model'></span>

<h3>Description</h3>

<p>Logistic growth model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logistic_model(times, logN0, mu, lambda, C)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logistic_model_+3A_times">times</code></td>
<td>
<p>Numeric vector of storage times</p>
</td></tr>
<tr><td><code id="logistic_model_+3A_logn0">logN0</code></td>
<td>
<p>Initial log microbial count</p>
</td></tr>
<tr><td><code id="logistic_model_+3A_mu">mu</code></td>
<td>
<p>Maximum specific growth rate (in ln CFU/<a href="base.html#topic+t">t</a>)</p>
</td></tr>
<tr><td><code id="logistic_model_+3A_lambda">lambda</code></td>
<td>
<p>Lag phase duration</p>
</td></tr>
<tr><td><code id="logistic_model_+3A_c">C</code></td>
<td>
<p>Difference between <code>logN0</code> and the maximum log-count.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector with the predicted microbial count
</p>

<hr>
<h2 id='make_guess_factor'>Initial guesses for the secondary model of one factor</h2><span id='topic+make_guess_factor'></span>

<h3>Description</h3>

<p>Initial guesses for the secondary model of one factor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_guess_factor(fit_data, sec_model, factor)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_guess_factor_+3A_fit_data">fit_data</code></td>
<td>
<p>Tibble with the data used for the fit. It must have
one column with the observed growth rate (named <code>mu</code> by default; can be
changed using the &quot;formula&quot; argument) and as many columns
as needed with the environmental factors.</p>
</td></tr>
<tr><td><code id="make_guess_factor_+3A_sec_model">sec_model</code></td>
<td>
<p>character defining the secondary model equation according
to <code><a href="#topic+secondary_model_data">secondary_model_data()</a></code></p>
</td></tr>
<tr><td><code id="make_guess_factor_+3A_factor">factor</code></td>
<td>
<p>character defining the environmental factor</p>
</td></tr>
</table>

<hr>
<h2 id='make_guess_primary'>Initial guesses for fitting primary growth models</h2><span id='topic+make_guess_primary'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>The function uses some heuristics to provide initial guesses for the parameters
of the growth model selected that can be used with <code><a href="#topic+fit_growth">fit_growth()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_guess_primary(
  fit_data,
  primary_model,
  logbase_mu = 10,
  formula = logN ~ time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_guess_primary_+3A_fit_data">fit_data</code></td>
<td>
<p>the experimental data. A tibble (or data.frame) with a column
named <code>time</code> with the elapsed time and one called <code>logN</code> with the logarithm
of the population size</p>
</td></tr>
<tr><td><code id="make_guess_primary_+3A_primary_model">primary_model</code></td>
<td>
<p>a string defining the equation of the primary model,
as defined in <code><a href="#topic+primary_model_data">primary_model_data()</a></code></p>
</td></tr>
<tr><td><code id="make_guess_primary_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, 10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
<tr><td><code id="make_guess_primary_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot; describing the x and y variables.
<code>logN ~ time</code> as a default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named numeric vector of initial guesses for the model parameters
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## An example of experimental data

my_data &lt;- data.frame(time = 0:9, 
                      logN = c(2, 2.1, 1.8, 2.5, 3.1, 3.4, 4, 4.5, 4.8, 4.7))
                      
## We just need to pass the data and the model equation

make_guess_primary(my_data, "Logistic")

## We can use this together with fit_growth()

fit_growth(my_data,
           list(primary = "Logistic"),
           make_guess_primary(my_data, "Logistic"),
           c()
           )

## The parameters returned by the function are adapted to the model

make_guess_primary(my_data, "Baranyi")

## It can express mu in other logbases 

make_guess_primary(my_data, "Baranyi", logbase_mu = exp(1))  # natural
make_guess_primary(my_data, "Baranyi", logbase_mu = 2)  # base2

</code></pre>

<hr>
<h2 id='make_guess_secondary'>Initial guesses for the parameters of a secondary model</h2><span id='topic+make_guess_secondary'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Uses some heuristic rules to generate an initial guess of the model parameters
of secondary growth models that can be used for model fitting with
<code><a href="#topic+fit_secondary_growth">fit_secondary_growth()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_guess_secondary(fit_data, sec_model_names)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_guess_secondary_+3A_fit_data">fit_data</code></td>
<td>
<p>Tibble with the data used for the fit. It must have
one column with the observed growth rate (named <code>mu</code> by default; can be
changed using the &quot;formula&quot; argument) and as many columns
as needed with the environmental factors.</p>
</td></tr>
<tr><td><code id="make_guess_secondary_+3A_sec_model_names">sec_model_names</code></td>
<td>
<p>Named character vector defining the secondary model
for each environmental factor.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## We can use the example dataset included in the package

data("example_cardinal")

## We assign model equations to factors as usual

sec_model_names &lt;- c(temperature = "Zwietering", pH = "fullRatkowsky")

## We can then calculate the initial guesses

make_guess_secondary(example_cardinal, sec_model_names)

## We can pass these parameters directly to fit_secondary_growth

fit_secondary_growth(example_cardinal, 
                     make_guess_secondary(example_cardinal, sec_model_names), 
                     c(), 
                     sec_model_names)

</code></pre>

<hr>
<h2 id='MCMCgrowth'>MCMCgrowth class</h2><span id='topic+MCMCgrowth'></span><span id='topic+print.MCMCgrowth'></span><span id='topic+plot.MCMCgrowth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>The <code>MCMCgrowth</code> class contains the results of a growth prediction
consider parameter variability based on a model
fitted using an MCMC algorithm.
</p>
<p>It is a subclass of list with items:
</p>

<ul>
<li><p> sample: Parameter sample used for the calculations.
</p>
</li>
<li><p> simulations: Individual growth curves calculated based on the parameter
sample.
</p>
</li>
<li><p> quantiles: Tibble with the limits of the credible intervals
(5%, 10%, 50%, 90% and 95%) for each time point.
</p>
</li>
<li><p> model: Instance of <code>FitDynamicGrowthMCMC</code> used for predictions.
</p>
</li>
<li><p> env_conditions: A tibble with the environmental conditions of the simulation.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MCMCgrowth'
print(x, ...)

## S3 method for class 'MCMCgrowth'
plot(
  x,
  y = NULL,
  ...,
  add_factor = NULL,
  alpha_80 = 0.5,
  fill_80 = "grey",
  alpha_90 = 0.5,
  fill_90 = "grey",
  label_y1 = "logN",
  label_y2 = add_factor,
  line_col = "black",
  line_type = 1,
  line_size = 1,
  line_type2 = 2,
  line_col2 = "black",
  line_size2 = 1,
  ylims = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCMCgrowth_+3A_x">x</code></td>
<td>
<p>The object of class <code>MCMCgrowth</code> to plot.</p>
</td></tr>
<tr><td><code id="MCMCgrowth_+3A_...">...</code></td>
<td>
<p>ignored.</p>
</td></tr>
<tr><td><code id="MCMCgrowth_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="MCMCgrowth_+3A_add_factor">add_factor</code></td>
<td>
<p>Includes the variation of one environmental factor in the plot.
It must be one of the column names in x$env_conditions.</p>
</td></tr>
<tr><td><code id="MCMCgrowth_+3A_alpha_80">alpha_80</code></td>
<td>
<p>transparency of the ribbon for the 80th posterior. .5 by default.</p>
</td></tr>
<tr><td><code id="MCMCgrowth_+3A_fill_80">fill_80</code></td>
<td>
<p>fill colour of the ribbon for the 80th posterior. &quot;grey&quot; by default.</p>
</td></tr>
<tr><td><code id="MCMCgrowth_+3A_alpha_90">alpha_90</code></td>
<td>
<p>transparency of the ribbon for the 90th posterior. .5 by default.</p>
</td></tr>
<tr><td><code id="MCMCgrowth_+3A_fill_90">fill_90</code></td>
<td>
<p>fill colour of the ribbon for the 90th posterior. &quot;grey&quot; by default.</p>
</td></tr>
<tr><td><code id="MCMCgrowth_+3A_label_y1">label_y1</code></td>
<td>
<p>label of the primary y axis. &quot;logN&quot; by default.</p>
</td></tr>
<tr><td><code id="MCMCgrowth_+3A_label_y2">label_y2</code></td>
<td>
<p>label of the secondary y axis. The name of the environmental factor
by default.</p>
</td></tr>
<tr><td><code id="MCMCgrowth_+3A_line_col">line_col</code></td>
<td>
<p>colour of the line representing the median. &quot;black&quot; by default.</p>
</td></tr>
<tr><td><code id="MCMCgrowth_+3A_line_type">line_type</code></td>
<td>
<p>linetype for the line representing the median. solid by default.</p>
</td></tr>
<tr><td><code id="MCMCgrowth_+3A_line_size">line_size</code></td>
<td>
<p>size of the line representing the median. 1 by default.</p>
</td></tr>
<tr><td><code id="MCMCgrowth_+3A_line_type2">line_type2</code></td>
<td>
<p>linetype for the line representing the environmental condition.
Dashed by default.</p>
</td></tr>
<tr><td><code id="MCMCgrowth_+3A_line_col2">line_col2</code></td>
<td>
<p>colour of the line representing the environmental condition. &quot;black&quot;
by default.</p>
</td></tr>
<tr><td><code id="MCMCgrowth_+3A_line_size2">line_size2</code></td>
<td>
<p>size of the line representing the environmental condition. 1 by default.</p>
</td></tr>
<tr><td><code id="MCMCgrowth_+3A_ylims">ylims</code></td>
<td>
<p>limits of the primary y-axis. <code>NULL</code> by default (let ggplot choose).</p>
</td></tr>
</table>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>print(MCMCgrowth)</code>: print of the model
</p>
</li>
<li> <p><code>plot(MCMCgrowth)</code>: plot of predicted growth (prediction band).
</p>
</li></ul>

<hr>
<h2 id='multiple_conditions'>Environmental conditions during several dynamic experiments</h2><span id='topic+multiple_conditions'></span>

<h3>Description</h3>

<p>This dataset is paired with <a href="#topic+multiple_counts">multiple_counts</a> to illustrate the global
fitting of <code><a href="#topic+fit_growth">fit_growth()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiple_conditions
</code></pre>


<h3>Format</h3>

<p>A nested list with two elements, each one corresponding to one experiment.
Each element is a data.frame with three columns:
</p>

<ul>
<li><p> time: elapsed time
</p>
</li>
<li><p> temperature: observed temperature
</p>
</li>
<li><p> pH: observed pH
</p>
</li></ul>


<hr>
<h2 id='multiple_counts'>Population growth observed in several dynamic experiments</h2><span id='topic+multiple_counts'></span>

<h3>Description</h3>

<p>This dataset is paired with <a href="#topic+multiple_conditions">multiple_conditions</a> to illustrate the global
fitting of <code><a href="#topic+fit_growth">fit_growth()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiple_counts
</code></pre>


<h3>Format</h3>

<p>A nested list with two elements, each one corresponding to one experiment.
Each element is a data.frame with two columns:
</p>

<ul>
<li><p> time: elapsed time
</p>
</li>
<li><p> logN: log10 of the microbial concentration
</p>
</li></ul>


<hr>
<h2 id='multiple_experiments'>A set of growth experiments under dynamic conditions</h2><span id='topic+multiple_experiments'></span>

<h3>Description</h3>

<p>An example dataset illustrating the requirements of
<code><a href="#topic+fit_multiple_growth">fit_multiple_growth()</a></code> and
<code><a href="#topic+fit_multiple_growth_MCMC">fit_multiple_growth_MCMC()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiple_experiments
</code></pre>


<h3>Format</h3>

<p>A nested list with two elements. Each element
corresponds to one experiment and is described by a list
with two data frames:
</p>

<dl>
<dt>data</dt><dd><p>a tibble describing the microbial counts. It has 2 columns:
time (elapsed time) and logN (logarithm of the microbial count)</p>
</dd></dl>
<p>.
</p>
<dl>
<dt>conditions</dt><dd><p>a tibble describing the environmental conditions. It has
3 columns: time (elapsed time), temperature (storage temperature) and pH (pH of the media).</p>
</dd>
</dl>


<hr>
<h2 id='predict_dynamic_growth'>Growth under dynamic conditions</h2><span id='topic+predict_dynamic_growth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>The function <code><a href="#topic+predict_dynamic_growth">predict_dynamic_growth()</a></code> has been superseded by the top-level
function <code><a href="#topic+predict_growth">predict_growth()</a></code>, which provides a unified approach for growth modelling.
</p>
<p>Regardless on that, it can still predict population growth under dynamic conditions based on the
Baranyi model (Baranyi and Roberts, 1994) and secondary models
based on the gamma concept (Zwietering et al. 1992).
</p>
<p>Model predictions are done by linear interpolation of the environmental
conditions defined in <code>env_conditions</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_dynamic_growth(
  times,
  env_conditions,
  primary_pars,
  secondary_models,
  ...,
  check = TRUE,
  logbase_logN = 10,
  logbase_mu = logbase_logN,
  formula = . ~ time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_dynamic_growth_+3A_times">times</code></td>
<td>
<p>Numeric vector of storage times to make the predictions</p>
</td></tr>
<tr><td><code id="predict_dynamic_growth_+3A_env_conditions">env_conditions</code></td>
<td>
<p>Tibble (or data.frame) describing the variation of the environmental
conditions during storage. It must have with the elapsed time (named <code>time</code>
by default; can be changed with the &quot;formula&quot; argument),
and as many additional columns as environmental factors.</p>
</td></tr>
<tr><td><code id="predict_dynamic_growth_+3A_primary_pars">primary_pars</code></td>
<td>
<p>A named list defining the parameters of the primary model
and the initial values of the model variables. That is, with names <code>mu_opt</code>,
<code>Nmax</code>, <code>N0</code>, <code>Q0</code>.</p>
</td></tr>
<tr><td><code id="predict_dynamic_growth_+3A_secondary_models">secondary_models</code></td>
<td>
<p>A nested list describing the secondary models.</p>
</td></tr>
<tr><td><code id="predict_dynamic_growth_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code><a href="deSolve.html#topic+ode">ode()</a></code>.</p>
</td></tr>
<tr><td><code id="predict_dynamic_growth_+3A_check">check</code></td>
<td>
<p>Whether to check the validity of the models. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="predict_dynamic_growth_+3A_logbase_logn">logbase_logN</code></td>
<td>
<p>Base of the logarithm for the population size. By default,
10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
<tr><td><code id="predict_dynamic_growth_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, the same as logbase_logN. See vignette about units for details.</p>
</td></tr>
<tr><td><code id="predict_dynamic_growth_+3A_formula">formula</code></td>
<td>
<p>An object of class &quot;formula&quot; describing the x variable.
<code>. ~ time</code> as a default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of <code><a href="#topic+DynamicGrowth">DynamicGrowth()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Definition of the environmental conditions

library(tibble)

my_conditions &lt;- tibble(time = c(0, 5, 40),
    temperature = c(20, 30, 35),
    pH = c(7, 6.5, 5)
    )

## Definition of the model parameters

my_primary &lt;- list(mu_opt = 2,
    Nmax = 1e8,N0 = 1e0,
    Q0 = 1e-3)

sec_temperature &lt;- list(model = "Zwietering",
    xmin = 25, xopt = 35, n = 1)

sec_pH = list(model = "CPM",
    xmin = 5.5, xopt = 6.5,
    xmax = 7.5, n = 2)

my_secondary &lt;- list(
    temperature = sec_temperature,
    pH = sec_pH
    )

my_times &lt;- seq(0, 50, length = 1000)

## Do the simulation

dynamic_prediction &lt;- predict_dynamic_growth(my_times,
    my_conditions, my_primary,
    my_secondary)

## Plot the results

plot(dynamic_prediction)

## We can plot some environmental factor with add_factor

plot(dynamic_prediction, add_factor = "temperature", ylims= c(0, 8),
    label_y1 = "Microbial count (log CFU/ml)",
    label_y2 = "Storage temperature (C)")

</code></pre>

<hr>
<h2 id='predict_growth'>Prediction of microbial growth</h2><span id='topic+predict_growth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>This function provides a top-level interface for predicting population growth.
Predictions can be made either under constant or dynamic environmental conditions.
See below for details on the calculations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_growth(
  times,
  primary_model,
  environment = "constant",
  secondary_models = NULL,
  env_conditions = NULL,
  ...,
  check = TRUE,
  logbase_mu = logbase_logN,
  logbase_logN = 10,
  formula = . ~ time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_growth_+3A_times">times</code></td>
<td>
<p>numeric vector of time points for making the predictions</p>
</td></tr>
<tr><td><code id="predict_growth_+3A_primary_model">primary_model</code></td>
<td>
<p>named list defining the values of the parameters of the primary growth model</p>
</td></tr>
<tr><td><code id="predict_growth_+3A_environment">environment</code></td>
<td>
<p>type of environment. Either &quot;constant&quot; (default) or &quot;dynamic&quot; (see below for details
on the calculations for each condition)</p>
</td></tr>
<tr><td><code id="predict_growth_+3A_secondary_models">secondary_models</code></td>
<td>
<p>a nested list describing the secondary models. See below for details</p>
</td></tr>
<tr><td><code id="predict_growth_+3A_env_conditions">env_conditions</code></td>
<td>
<p>Tibble describing the variation of the environmental
conditions for dynamic experiments. It must have with the elapsed time (named <code>time</code>
by default; can be changed with the &quot;formula&quot; argument),
and as many additional columns as environmental factors. Ignored for &quot;constant&quot; environments.</p>
</td></tr>
<tr><td><code id="predict_growth_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code><a href="deSolve.html#topic+ode">ode()</a></code>.</p>
</td></tr>
<tr><td><code id="predict_growth_+3A_check">check</code></td>
<td>
<p>Whether to check the validity of the models. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="predict_growth_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, the same as logbase_logN. See vignette about units for details.</p>
</td></tr>
<tr><td><code id="predict_growth_+3A_logbase_logn">logbase_logN</code></td>
<td>
<p>Base of the logarithm for the population size. By default,
10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
<tr><td><code id="predict_growth_+3A_formula">formula</code></td>
<td>
<p>An object of class &quot;formula&quot; describing the x variable for predictions
under dynamic conditions. <code>. ~ time</code> as a default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To ease data input, the functions can convert between parameters defined in different
scales. Namely, for predictions in constant environments (environment=&quot;constant&quot;):
</p>

<ul>
<li><p> &quot;logN0&quot; can be defined as &quot;N0&quot;. The function automatically calculates the log-transformation.
</p>
</li>
<li><p> &quot;logNmax&quot; can be defined as &quot;Nmax&quot;. The function automatically calculates the log-transformation.
</p>
</li>
<li><p> &quot;mu&quot; can be defined as &quot;mu_opt&quot;. The function assumes the prediction is under optimal growth conditions.
</p>
</li>
<li><p> &quot;lambda&quot; can be defined by &quot;Q0&quot;. The duration of the lag phase is calculated using <code><a href="#topic+Q0_to_lambda">Q0_to_lambda()</a></code>.
</p>
</li></ul>

<p>And, for predictions in dynamic environments (environment=&quot;dynamic&quot;):
</p>

<ul>
<li><p> &quot;N0&quot; can be defined as &quot;N0&quot;. The function automatically calculates the antilog-transformation.
</p>
</li>
<li><p> &quot;Nmax&quot; can be defined as &quot;logNmax&quot;. The function automatically calculates the antilog-transformation.
</p>
</li>
<li><p> &quot;mu&quot; can be defined as &quot;mu_opt&quot;. The function assumes mu was calculated under optimal growth conditions.
</p>
</li>
<li><p> &quot;Q0&quot; can be defined by the value of &quot;lambda&quot; under dynamic conditions. Then, the
value of Q0 is calculated using <code><a href="#topic+lambda_to_Q0">lambda_to_Q0()</a></code>.
</p>
</li></ul>



<h3>Value</h3>

<p>An instance of <a href="#topic+GrowthPrediction">GrowthPrediction</a>.
</p>


<h3>Predictions in constant environments</h3>

<p>Predictions under constant environments are calculated using only primary models.
Consequently, the arguments &quot;secondary_models&quot; and &quot;env_conditions&quot; are ignored.
If these were passed, the function would return a warning. In this case,
predictions are calculated using the algebraic form of the primary model (see
vignette for details).
</p>
<p>The growth model is defined through the &quot;primary_model&quot; argument using a named list.
One of the list elements must be named &quot;model&quot; and must take take one of the valid
keys returned by <code><a href="#topic+primary_model_data">primary_model_data()</a></code>. The remaining entries of the list define the
values of the parameters of the selected model. A list of valid keys can be retrieved
using <code><a href="#topic+primary_model_data">primary_model_data()</a></code> (see example below). Note that the functions can do
some operations to facilitate the compatibility between constant and dynamic environments
(see Details).
</p>


<h3>Predictions in dynamic environments</h3>

<p>Predictions under dynamic environments are calculated by solving numerically
the differential equation of the Baranyi growth model. The effect of
changes in the environmental conditions in the growth rate are calculated
according to the gamma approach. Therefore, one must define both primary
and secondary models.
</p>
<p>The dynamic environmental conditions are defined using a tibble (or data.frame)
through the &quot;env_conditions&quot; argument. It must include one column named &quot;time&quot; stating the elapsed
time and as many additional columns as environmental conditions included in the prediction.
For values of time not included in the tibble, the values of the environmental conditions
are calculated by linear interpolation.
</p>
<p>Primary models are defined as a named list through the &quot;primary_model&quot; argument. It
must include the following elements:
</p>

<ul>
<li><p> N0: initial population size
</p>
</li>
<li><p> Nmax: maximum population size in the stationary growth phase
</p>
</li>
<li><p> mu_opt: growth rate under optimal growth conditions
</p>
</li>
<li><p> Q0: value defining the duration of the lag phase
Additional details on these parameters can be found in the package vignettes.
</p>
</li></ul>

<p>Secondary models are defined as a nested list through the &quot;secondary_models&quot; argument.
The list must have one entry per environmental condition, whose name must match
those used in the &quot;env_conditions&quot; argument. Each of these entries must be a named list
defining the secondary model for each environmental condition. The model equation is defined
in an entry named &quot;model&quot; (valid keys can be retrieved from <code><a href="#topic+secondary_model_data">secondary_model_data()</a></code>). Then,
additional entries defined the values of each model parameters (valid keys can be retrieved from <code><a href="#topic+secondary_model_data">secondary_model_data()</a></code>)
</p>
<p>For additional details on how to define the secondary models, please see the package vignettes (and examples below).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1 - Growth under constant conditions -----------------------------

## Valid model keys can be retrieved calling primary_model_data()

primary_model_data()

my_model &lt;- "modGompertz"  # we will use the modified-Gompertz

## The keys of the model parameters can also be obtained from primary_model_data()

primary_model_data(my_model)$pars

## We define the primary model as a list

my_model &lt;- list(model = "modGompertz", logN0 = 0, C = 6, mu = .2, lambda = 20)

## We can now make the predictions

my_time &lt;- seq(0, 100, length = 1000)  # Vector of time points for the calculations

my_prediction &lt;- predict_growth(my_time, my_model, environment = "constant")

## The instance of IsothermalGrowth includes several S3 methods 

print(my_prediction)
plot(my_prediction)
coef(my_prediction)

## Example 2 - Growth under dynamic conditions ------------------------------

## We will consider the effect of two factors: temperature and pH

my_conditions &lt;- data.frame(time = c(0, 5, 40),
                            temperature = c(20, 30, 35),
                            pH = c(7, 6.5, 5)
                            )
                            
## The primary model is defined as a named list
                            
my_primary &lt;- list(mu = 2, Nmax = 1e7, N0 = 1, Q0 = 1e-3)

## The secondary model is defined independently for each factor

sec_temperature &lt;- list(model = "Zwietering",
    xmin = 25, xopt = 35, n = 1)

sec_pH = list(model = "CPM",
    xmin = 5.5, xopt = 6.5,
    xmax = 7.5, n = 2)
    
## Then, they are assigned to each factor using a named list

my_secondary &lt;- list(
    temperature = sec_temperature,
    pH = sec_pH
    )
    
## We can call the function now

my_times &lt;- seq(0, 50, length = 1000)  # Where the output is calculated

dynamic_prediction &lt;- predict_growth(environment = "dynamic", 
                                     my_times, my_primary, my_secondary,
                                     my_conditions
                                     )
                                     
## The instance of DynamicGrowth includes several useful S3 methods

print(dynamic_prediction)
plot(dynamic_prediction)
plot(dynamic_prediction, add_factor = "pH")
coef(dynamic_prediction)

## The time_to_size function can predict the time to reach a population size

time_to_size(my_prediction, 3)


</code></pre>

<hr>
<h2 id='predict_growth_uncertainty'>Isothermal growth with parameter uncertainty</h2><span id='topic+predict_growth_uncertainty'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Simulation of microbial growth considering uncertianty in the model parameters.
Calculations are based on
Monte Carlo simulations, considering the parameters follow a multivariate normal
distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_growth_uncertainty(
  model_name,
  times,
  n_sims,
  pars,
  corr_matrix = diag(nrow(pars)),
  check = TRUE,
  logbase_mu = logbase_logN,
  logbase_logN = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_growth_uncertainty_+3A_model_name">model_name</code></td>
<td>
<p>Character describing the primary growth model.</p>
</td></tr>
<tr><td><code id="predict_growth_uncertainty_+3A_times">times</code></td>
<td>
<p>Numeric vector of storage times for the simulations.</p>
</td></tr>
<tr><td><code id="predict_growth_uncertainty_+3A_n_sims">n_sims</code></td>
<td>
<p>Number of simulations.</p>
</td></tr>
<tr><td><code id="predict_growth_uncertainty_+3A_pars">pars</code></td>
<td>
<p>A tibble describing the parameter uncertainty (see details).</p>
</td></tr>
<tr><td><code id="predict_growth_uncertainty_+3A_corr_matrix">corr_matrix</code></td>
<td>
<p>Correlation matrix of the model parameters. Defined in the
same order as in <code>pars</code>. An identity matrix by default
(uncorrelated parameters).</p>
</td></tr>
<tr><td><code id="predict_growth_uncertainty_+3A_check">check</code></td>
<td>
<p>Whether to do some tests. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="predict_growth_uncertainty_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, the same as logbase_logN. See vignette about units for details.</p>
</td></tr>
<tr><td><code id="predict_growth_uncertainty_+3A_logbase_logn">logbase_logN</code></td>
<td>
<p>Base of the logarithm for the population size. By default,
10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The distributions of the model parameters are
defined in the <code>pars</code> argument using a tibble with 4 columns:
</p>

<ul>
<li><p>par: identifier of the model parameter (according to <code><a href="#topic+primary_model_data">primary_model_data()</a></code>),
</p>
</li>
<li><p>mean: mean value of the model parameter.,
</p>
</li>
<li><p>sd: standard deviation of the model parameter.,
</p>
</li>
<li><p>scale: scale at which the model parameter is defined. Valid values are
'original' (no transformation), 'sqrt' square root or 'log' log-scale. The
parameter sample is generated considering the parameter follows a marginal
normal distribution at this scale, and is later converted to the original scale
for calculations.
</p>
</li></ul>



<h3>Value</h3>

<p>An instance of <code><a href="#topic+GrowthUncertainty">GrowthUncertainty()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Definition of the simulation settings

my_model &lt;- "Baranyi"
my_times &lt;- seq(0, 30, length = 100)
n_sims &lt;- 3000

library(tibble)

pars &lt;- tribble(
    ~par, ~mean, ~sd, ~scale,
    "logN0", 0, .2, "original",
    "mu", 2, .3, "sqrt",
    "lambda", 4, .4, "sqrt",
    "logNmax", 6, .5, "original"
)

## Calling the function

stoc_growth &lt;- predict_growth_uncertainty(my_model, my_times, n_sims, pars)

## We can plot the results

plot(stoc_growth)

## Adding parameter correlation

my_cor &lt;- matrix(c(1,   0,   0, 0,
    0,   1, 0.7, 0,
    0, 0.7,   1, 0,
    0,   0,   0, 1),
    nrow = 4)

stoc_growth2 &lt;- predict_growth_uncertainty(my_model, my_times, n_sims, pars, my_cor)

plot(stoc_growth2)

## The time_to_size function can calculate the median growth curve to reach a size

time_to_size(stoc_growth, 4)

## Or the distribution of times

dist &lt;- time_to_size(stoc_growth, 4, type = "distribution")
plot(dist)




</code></pre>

<hr>
<h2 id='predict_isothermal_growth'>Isothermal microbial growth</h2><span id='topic+predict_isothermal_growth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>The function <code><a href="#topic+predict_isothermal_growth">predict_isothermal_growth()</a></code> has been superseded by the top-level
function <code><a href="#topic+predict_growth">predict_growth()</a></code>, which provides a unified approach for growth modelling.
</p>
<p>Regardless of that, it can still be used to predict population growth under static
environmental conditions (i.e. using primary models).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_isothermal_growth(
  model_name,
  times,
  model_pars,
  check = TRUE,
  logbase_mu = 10,
  logbase_logN = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_isothermal_growth_+3A_model_name">model_name</code></td>
<td>
<p>Character defining the growth model.</p>
</td></tr>
<tr><td><code id="predict_isothermal_growth_+3A_times">times</code></td>
<td>
<p>Numeric vector of storage times for the predictions.</p>
</td></tr>
<tr><td><code id="predict_isothermal_growth_+3A_model_pars">model_pars</code></td>
<td>
<p>Named vector or list defining the values of the model parameters.</p>
</td></tr>
<tr><td><code id="predict_isothermal_growth_+3A_check">check</code></td>
<td>
<p>Whether to do basic checks (TRUE by default).</p>
</td></tr>
<tr><td><code id="predict_isothermal_growth_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, the same as logbase_logN. See vignette about units for details.</p>
</td></tr>
<tr><td><code id="predict_isothermal_growth_+3A_logbase_logn">logbase_logN</code></td>
<td>
<p>Base of the logarithm for the population size. By default,
10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of <code><a href="#topic+IsothermalGrowth">IsothermalGrowth()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Define the simulations parameters

my_model &lt;- "modGompertz"
my_pars &lt;- list(logN0 = 2, C = 6, mu = .2, lambda = 25)
my_time &lt;- seq(0, 100, length = 1000)

## Do the simulation

static_prediction &lt;- predict_isothermal_growth(my_model, my_time, my_pars)

## Plot the results

plot(static_prediction)


</code></pre>

<hr>
<h2 id='predict_MCMC_growth'>Stochastic growth of MCMC fit</h2><span id='topic+predict_MCMC_growth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>The function <code><a href="#topic+predict_MCMC_growth">predict_MCMC_growth()</a></code> has been superseded by <code><a href="#topic+predictMCMC">predictMCMC()</a></code>
S3 methods of the relevant classes.
</p>
<p>Nonetheless, it can still make a prediction of microbial growth including
parameter uncertainty based on a growth model
fitted using <code><a href="#topic+fit_MCMC_growth">fit_MCMC_growth()</a></code> or <code><a href="#topic+fit_multiple_growth_MCMC">fit_multiple_growth_MCMC()</a></code>.
This function predicts growth curves for <code>niter</code> samples (with replacement)
of the samples of the MCMC algorithm. Then, credible intervals are calculated based on the
quantiles of the model predictions at each time point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_MCMC_growth(
  MCMCfit,
  times,
  env_conditions,
  niter,
  newpars = NULL,
  formula = . ~ time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_MCMC_growth_+3A_mcmcfit">MCMCfit</code></td>
<td>
<p>An instance of <code>FitDynamicGrowthMCMC</code> or
<code>FitMultipleGrowthMCMC</code>.</p>
</td></tr>
<tr><td><code id="predict_MCMC_growth_+3A_times">times</code></td>
<td>
<p>Numeric vector of storage times for the predictions.</p>
</td></tr>
<tr><td><code id="predict_MCMC_growth_+3A_env_conditions">env_conditions</code></td>
<td>
<p>Tibble with the (dynamic) environmental conditions
during the experiment. It must have one column named 'time' with the
storage time and as many columns as required with the environmental conditions.</p>
</td></tr>
<tr><td><code id="predict_MCMC_growth_+3A_niter">niter</code></td>
<td>
<p>Number of iterations.</p>
</td></tr>
<tr><td><code id="predict_MCMC_growth_+3A_newpars">newpars</code></td>
<td>
<p>A named list defining new values for the some model parameters.
The name must be the identifier of a model already included in the model.
These parameters do not include variation, so defining a new value for a fitted
parameters &quot;fixes&quot; it. <code>NULL</code> by default (no new parameters).</p>
</td></tr>
<tr><td><code id="predict_MCMC_growth_+3A_formula">formula</code></td>
<td>
<p>A formula stating the column named defining the elapsed time in
<code>env_conditions</code>. By default, . ~ time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of <code><a href="#topic+MCMCgrowth">MCMCgrowth()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## We need a FitDynamicGrowthMCMC object

data("example_dynamic_growth")
data("example_env_conditions")

sec_model_names &lt;- c(temperature = "CPM", aw= "CPM")

known_pars &lt;- list(Nmax = 1e4,  # Primary model
    N0 = 1e0, Q0 = 1e-3,  # Initial values of the primary model
    mu_opt = 4, # mu_opt of the gamma model
    temperature_n = 1,  # Secondary model for temperature
    aw_xmax = 1, aw_xmin = .9, aw_n = 1  # Secondary model for water activity
    )

my_start &lt;- list(temperature_xmin = 25, temperature_xopt = 35,
    temperature_xmax = 40,
    aw_xopt = .95)

set.seed(12124) # Setting seed for repeatability

my_MCMC_fit &lt;- fit_MCMC_growth(example_dynamic_growth, example_env_conditions,
    my_start, known_pars, sec_model_names, niter = 3000)

## Define the conditions for the simulation

my_times &lt;- seq(0, 15, length = 50)
niter &lt;- 2000

newpars &lt;- list(N0 = 1e-1,  # A parameter that was fixed
                temperature_xmax = 120  # A parameter that was fitted
                )


## Make the simulations

my_MCMC_prediction &lt;- predict_MCMC_growth(my_MCMC_fit,
    my_times,
    example_env_conditions, # It could be different from the one used for fitting
    niter,
    newpars)
    
## We can plot the prediction interval

plot(my_MCMC_prediction)

## We can also get the quantiles at each time point

print(my_MCMC_prediction$quantiles)


</code></pre>

<hr>
<h2 id='predict_stochastic_growth'>Deprecated isothermal growth with parameter uncertainty</h2><span id='topic+predict_stochastic_growth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p><code><a href="#topic+predict_stochastic_growth">predict_stochastic_growth()</a></code> was renamed <code><a href="#topic+predict_growth_uncertainty">predict_growth_uncertainty()</a></code> because
the original function name may be misleading, as this is not a stochastic
differential equation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_stochastic_growth(
  model_name,
  times,
  n_sims,
  pars,
  corr_matrix = diag(nrow(pars)),
  check = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_stochastic_growth_+3A_model_name">model_name</code></td>
<td>
<p>Character describing the primary growth model.</p>
</td></tr>
<tr><td><code id="predict_stochastic_growth_+3A_times">times</code></td>
<td>
<p>Numeric vector of storage times for the simulations.</p>
</td></tr>
<tr><td><code id="predict_stochastic_growth_+3A_n_sims">n_sims</code></td>
<td>
<p>Number of simulations.</p>
</td></tr>
<tr><td><code id="predict_stochastic_growth_+3A_pars">pars</code></td>
<td>
<p>A tibble describing the parameter uncertainty (see details).</p>
</td></tr>
<tr><td><code id="predict_stochastic_growth_+3A_corr_matrix">corr_matrix</code></td>
<td>
<p>Correlation matrix of the model parameters. Defined in the
same order as in <code>pars</code>. An identity matrix by default
(uncorrelated parameters).</p>
</td></tr>
<tr><td><code id="predict_stochastic_growth_+3A_check">check</code></td>
<td>
<p>Whether to do some tests. <code>FALSE</code> by default.</p>
</td></tr>
</table>

<hr>
<h2 id='predictMCMC'>Generic for calculating predictions with uncertainty from fits</h2><span id='topic+predictMCMC'></span>

<h3>Description</h3>

<p>Generic for calculating predictions with uncertainty from fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictMCMC(
  model,
  times,
  env_conditions,
  niter,
  newpars = NULL,
  formula = . ~ time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predictMCMC_+3A_model">model</code></td>
<td>
<p>Fit object</p>
</td></tr>
<tr><td><code id="predictMCMC_+3A_times">times</code></td>
<td>
<p>see specific methods for each class</p>
</td></tr>
<tr><td><code id="predictMCMC_+3A_env_conditions">env_conditions</code></td>
<td>
<p>see specific methods for each class</p>
</td></tr>
<tr><td><code id="predictMCMC_+3A_niter">niter</code></td>
<td>
<p>see specific methods for each class</p>
</td></tr>
<tr><td><code id="predictMCMC_+3A_newpars">newpars</code></td>
<td>
<p>see specific methods for each class</p>
</td></tr>
<tr><td><code id="predictMCMC_+3A_formula">formula</code></td>
<td>
<p>A formula stating the column named defining the elapsed time in
<code>env_conditions</code>. By default, . ~ time.</p>
</td></tr>
</table>

<hr>
<h2 id='primary_model_data'>Metainformation of primary growth models</h2><span id='topic+primary_model_data'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Provides different types of meta-data about the primary growth models included
in biogrowth. This information is the basis of the automatic checks, and can also
help in the definition of models for <code><a href="#topic+predict_growth">predict_growth()</a></code> and <code><a href="#topic+fit_growth">fit_growth()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>primary_model_data(model_name = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="primary_model_data_+3A_model_name">model_name</code></td>
<td>
<p>The name of the model or <code>NULL</code> (default).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If model_name is <code>NULL</code>, returns a character string with the available models.
If is a valid identifier, it returns a list with metainformation about the model.
If model_name name is not a valid identifier, raises an error.
</p>

<hr>
<h2 id='Q0_to_lambda'>Lag phase duration from Q0</h2><span id='topic+Q0_to_lambda'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Convenience function to calculate the lag phase duration (lambda) of the
Baranyi model from the
maximum specific growth rate and the initial value of the variable Q.
</p>
<p>Note that this function uses the unit system of biogrowth (i.e. log10). Care must
be taken when using parameters obtained from other sources.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Q0_to_lambda(q0, mu, logbase_mu = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Q0_to_lambda_+3A_q0">q0</code></td>
<td>
<p>Initial value of the variable Q.</p>
</td></tr>
<tr><td><code id="Q0_to_lambda_+3A_mu">mu</code></td>
<td>
<p>Specific growth rate in the exponential phase.</p>
</td></tr>
<tr><td><code id="Q0_to_lambda_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, 10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
</table>

<hr>
<h2 id='refrigeratorSpain'>Temperature recorded in refrigerators</h2><span id='topic+refrigeratorSpain'></span>

<h3>Description</h3>

<p>This dataset includes the temperature recorded in refrigerators in households
of the Catalonia region. The data was published as part of Jofre et al. (2019)
Domestic refrigerator temperatures in Spain: Assessment of its impact on the
safety and shelf-life of cooked meat products. Food Research International,
126, 108578. And was kindly provided by the original authors of the study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>refrigeratorSpain
</code></pre>


<h3>Format</h3>

<p>A tibble with three columns:
</p>

<ul>
<li><p> time: elapsed time in hours
</p>
</li>
<li><p> A1: temperature observed in refrigerator &quot;1&quot;
</p>
</li>
<li><p> A2: temperature observed in refrigerator &quot;2&quot;
</p>
</li></ul>


<hr>
<h2 id='richards_model'>Richards growth model</h2><span id='topic+richards_model'></span>

<h3>Description</h3>

<p>Richards growth model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>richards_model(times, logN0, mu, lambda, C, nu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="richards_model_+3A_times">times</code></td>
<td>
<p>Numeric vector of storage times</p>
</td></tr>
<tr><td><code id="richards_model_+3A_logn0">logN0</code></td>
<td>
<p>Initial log microbial count</p>
</td></tr>
<tr><td><code id="richards_model_+3A_mu">mu</code></td>
<td>
<p>Maximum specific growth rate (in ln CFU/<a href="base.html#topic+t">t</a>)</p>
</td></tr>
<tr><td><code id="richards_model_+3A_lambda">lambda</code></td>
<td>
<p>Lag phase duration</p>
</td></tr>
<tr><td><code id="richards_model_+3A_c">C</code></td>
<td>
<p>Difference between <code>logN0</code> and the maximum log-count.</p>
</td></tr>
<tr><td><code id="richards_model_+3A_nu">nu</code></td>
<td>
<p>Parameter describing the transition between growth phases</p>
</td></tr>
</table>

<hr>
<h2 id='secondary_model_data'>Metainformation of secondary growth models</h2><span id='topic+secondary_model_data'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Provides different types of meta-data about the secondary growth models included
in biogrowth. This information is the basis of the automatic checks, and can also
help in the definition of models for <code><a href="#topic+predict_growth">predict_growth()</a></code> and <code><a href="#topic+fit_growth">fit_growth()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>secondary_model_data(model_name = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="secondary_model_data_+3A_model_name">model_name</code></td>
<td>
<p>The name of the model or <code>NULL</code> (default).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If model_name is <code>NULL</code>, returns a character string with the available models.
If is a valid identifier, it returns a list with metainformation about the model.
If model_name name is not a valid identifier, raises an error.
</p>

<hr>
<h2 id='SecondaryComparison'>SecondaryComparison class</h2><span id='topic+SecondaryComparison'></span><span id='topic+coef.SecondaryComparison'></span><span id='topic+summary.SecondaryComparison'></span><span id='topic+print.SecondaryComparison'></span><span id='topic+plot.SecondaryComparison'></span>

<h3>Description</h3>

<p>The <code>SecondaryComparison</code> class contains several functions for model comparison
and model selection of growth models. It should not be instanced directly. Instead,
it should be constructed using <code><a href="#topic+compare_secondary_fits">compare_secondary_fits()</a></code>.
</p>
<p>It includes two type of tools for model selection and comparison: statistical indexes
and visual analyses. Please check the sections below for details.
</p>
<p>Note that all these tools use the names defined in <code><a href="#topic+compare_secondary_fits">compare_secondary_fits()</a></code>, so
we recommend passing a named list to that function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SecondaryComparison'
coef(object, ...)

## S3 method for class 'SecondaryComparison'
summary(object, ...)

## S3 method for class 'SecondaryComparison'
print(x, ...)

## S3 method for class 'SecondaryComparison'
plot(x, y, ..., type = 1, add_trend = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SecondaryComparison_+3A_object">object</code></td>
<td>
<p>an instance of SecondaryComparison</p>
</td></tr>
<tr><td><code id="SecondaryComparison_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="SecondaryComparison_+3A_x">x</code></td>
<td>
<p>an instance of SecondaryComparison</p>
</td></tr>
<tr><td><code id="SecondaryComparison_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="SecondaryComparison_+3A_type">type</code></td>
<td>
<p>if type==1, the plot compares the model predictions. If type ==2,
the plot compares the parameter estimates.</p>
</td></tr>
<tr><td><code id="SecondaryComparison_+3A_add_trend">add_trend</code></td>
<td>
<p>should a trend line of the residuals be added for type==3? <code>TRUE</code>
by default</p>
</td></tr>
</table>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>coef(SecondaryComparison)</code>: table of parameter estimates
</p>
</li>
<li> <p><code>summary(SecondaryComparison)</code>: summary table for the comparison
</p>
</li>
<li> <p><code>print(SecondaryComparison)</code>: print of the model comparison
</p>
</li>
<li> <p><code>plot(SecondaryComparison)</code>: illustrations comparing the fitted models
</p>
</li></ul>


<h3>Statistical indexes</h3>

<p><code>SecondaryComparison</code> implements two S3 methods to obtain numerical values to facilitate
model comparison and selection.
</p>

<ul>
<li><p> the <code>coef</code> method returns a tibble with the values of the parameter estimates
and their corresponding standard errors for each model.
</p>
</li>
<li><p> the <code>summary</code> returns a tibble with the AIC, number of degrees of freedom,
mean error and root mean squared error for each model.
</p>
</li></ul>



<h3>Visual analyses</h3>

<p>The S3 plot method can generate three types of plots:
</p>

<ul>
<li><p> when <code>type = 1</code>, the plot compares the observations against the model predictions
for each model. The plot includes a linear model fitted to the residuals. In the case
of a perfect fit, the line would have slope=1 and intercept=0 (shown as a black, dashed line).
</p>
</li>
<li><p> when <code>type = 2</code>, the plot compares the parameter estimates using error bars, where
the limits of the error bars are the expected value +/- one standard error. In case
one model does not has some model parameter (i.e. either because it is not defined
or because it was fixed), the parameter is not included in the plot.
</p>
</li></ul>


<hr>
<h2 id='show_guess_dynamic'>Plot of the initial guess for growth under dynamic environmental conditions</h2><span id='topic+show_guess_dynamic'></span>

<h3>Description</h3>

<p>Compares the prediction corresponding to a guess of the parameters of the
model against experimental data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_guess_dynamic(
  fit_data,
  model_keys,
  guess,
  env_conditions,
  logbase_mu = 10,
  formula = logN ~ time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_guess_dynamic_+3A_fit_data">fit_data</code></td>
<td>
<p>Tibble (or data.frame) of data for the fit. It must have two columns, one with
the elapsed time (<code>time</code> by default) and another one with the decimal logarithm
of the populatoin size (<code>logN</code> by default). Different column names can be
defined using the <code>formula</code> argument.</p>
</td></tr>
<tr><td><code id="show_guess_dynamic_+3A_model_keys">model_keys</code></td>
<td>
<p>Named the equations of the secondary model as in <code><a href="#topic+fit_growth">fit_growth()</a></code></p>
</td></tr>
<tr><td><code id="show_guess_dynamic_+3A_guess">guess</code></td>
<td>
<p>Named vector with the initial guess of the model parameters as in <code><a href="#topic+fit_growth">fit_growth()</a></code></p>
</td></tr>
<tr><td><code id="show_guess_dynamic_+3A_env_conditions">env_conditions</code></td>
<td>
<p>Tibble describing the variation of the environmental
conditions for dynamic experiments. See <code><a href="#topic+fit_growth">fit_growth()</a></code>.</p>
</td></tr>
<tr><td><code id="show_guess_dynamic_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, 10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
<tr><td><code id="show_guess_dynamic_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot; describing the x and y variables.
<code>logN ~ time</code> as a default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code> comparing the model prediction against the data
</p>

<hr>
<h2 id='show_guess_primary'>Plot of the initial guess for growth under constant environmental conditions</h2><span id='topic+show_guess_primary'></span>

<h3>Description</h3>

<p>Compares the prediction corresponding to a guess of the parameters of the primary
model against experimental data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_guess_primary(
  fit_data,
  model_name,
  guess,
  logbase_mu = 10,
  formula = logN ~ time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_guess_primary_+3A_fit_data">fit_data</code></td>
<td>
<p>Tibble (or data.frame) of data for the fit. It must have two columns, one with
the elapsed time (<code>time</code> by default) and another one with the decimal logarithm
of the populatoin size (<code>logN</code> by default). Different column names can be
defined using the <code>formula</code> argument.</p>
</td></tr>
<tr><td><code id="show_guess_primary_+3A_model_name">model_name</code></td>
<td>
<p>Character defining the primary growth model as per <code><a href="#topic+primary_model_data">primary_model_data()</a></code></p>
</td></tr>
<tr><td><code id="show_guess_primary_+3A_guess">guess</code></td>
<td>
<p>Named vector with the initial guess of the model parameters</p>
</td></tr>
<tr><td><code id="show_guess_primary_+3A_logbase_mu">logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, 10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
<tr><td><code id="show_guess_primary_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot; describing the x and y variables.
<code>logN ~ time</code> as a default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code> comparing the model prediction against the data
</p>

<hr>
<h2 id='StochasticGrowth'>StochasticGrowth class</h2><span id='topic+StochasticGrowth'></span><span id='topic+print.StochasticGrowth'></span><span id='topic+plot.StochasticGrowth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p>The class <a href="#topic+StochasticGrowth">StochasticGrowth</a> has been deprecated by
class <a href="#topic+GrowthUncertainty">GrowthUncertainty</a>, which provides less misleading name.
</p>
<p>Still, it is still returned if the deprecated <code><a href="#topic+predict_stochastic_growth">predict_stochastic_growth()</a></code> is called.
</p>
<p>The <code>StochasticGrowth</code> class contains the results of a growth prediction
under isothermal conditions considering parameter unceratinty. Its constructor
is <code><a href="#topic+predict_stochastic_growth">predict_stochastic_growth()</a></code>.
</p>
<p>It is a subclass of list with the items:
</p>

<ul>
<li><p> sample: parameter sample used for the calculations.
</p>
</li>
<li><p> simulations: growth curves predicted for each parameter.
</p>
</li>
<li><p> quantiles: limits of the credible intervals (5%, 10%, 50%, 90%, 95%) for
each time point.
</p>
</li>
<li><p> model: Model used for the calculations.
</p>
</li>
<li><p> mus: Mean parameter values used for the simulations.
</p>
</li>
<li><p> sigma: Variance-covariance matrix used for the simulations.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'StochasticGrowth'
print(x, ...)

## S3 method for class 'StochasticGrowth'
plot(
  x,
  y = NULL,
  ...,
  line_col = "black",
  line_size = 0.5,
  line_type = "solid",
  ribbon80_fill = "grey",
  ribbon90_fill = "grey",
  alpha80 = 0.5,
  alpha90 = 0.4
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="StochasticGrowth_+3A_x">x</code></td>
<td>
<p>The object of class <code>StochasticGrowth</code> to plot.</p>
</td></tr>
<tr><td><code id="StochasticGrowth_+3A_...">...</code></td>
<td>
<p>ignored.</p>
</td></tr>
<tr><td><code id="StochasticGrowth_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="StochasticGrowth_+3A_line_col">line_col</code></td>
<td>
<p>Aesthetic parameter to change the colour of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="StochasticGrowth_+3A_line_size">line_size</code></td>
<td>
<p>Aesthetic parameter to change the thickness of the line geom in the plot, see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="StochasticGrowth_+3A_line_type">line_type</code></td>
<td>
<p>Aesthetic parameter to change the type of the line geom in the plot, takes numbers (1-6) or strings (&quot;solid&quot;) see: <code><a href="ggplot2.html#topic+geom_line">geom_line()</a></code></p>
</td></tr>
<tr><td><code id="StochasticGrowth_+3A_ribbon80_fill">ribbon80_fill</code></td>
<td>
<p>fill colour for the space between the 10th and 90th quantile, see: <code><a href="ggplot2.html#topic+geom_ribbon">geom_ribbon()</a></code></p>
</td></tr>
<tr><td><code id="StochasticGrowth_+3A_ribbon90_fill">ribbon90_fill</code></td>
<td>
<p>fill colour for the space between the 5th and 95th quantile, see: <code><a href="ggplot2.html#topic+geom_ribbon">geom_ribbon()</a></code></p>
</td></tr>
<tr><td><code id="StochasticGrowth_+3A_alpha80">alpha80</code></td>
<td>
<p>transparency of the ribbon aesthetic for the space between the 10th and 90th quantile. Takes a value between 0 (fully transparant) and 1 (fully opaque)</p>
</td></tr>
<tr><td><code id="StochasticGrowth_+3A_alpha90">alpha90</code></td>
<td>
<p>transparency of the ribbon aesthetic for the space between the 5th and 95th quantile. Takes a value between 0 (fully transparant) and 1 (fully opaque).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>FitIsoGrowth class
</p>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>print(StochasticGrowth)</code>: print of the model
</p>
</li>
<li> <p><code>plot(StochasticGrowth)</code>: Growth prediction (prediction band) considering
parameter uncertainty.
</p>
</li></ul>

<hr>
<h2 id='time_to_logcount'>Time to reach a given microbial count</h2><span id='topic+time_to_logcount'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>The function <code><a href="#topic+time_to_logcount">time_to_logcount()</a></code> has been superseded by
function <code><a href="#topic+time_to_size">time_to_size()</a></code>, which provides a more general interface.
</p>
<p>But it still returns the storage time required for the microbial count to
reach <code>log_count</code> according to the predictions of <code>model</code>.
Calculations are done using linear interpolation of the model predictions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time_to_logcount(model, log_count)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="time_to_logcount_+3A_model">model</code></td>
<td>
<p>An instance of <code>IsothermalGrowth</code> or <code>DynamicGrowth</code>.</p>
</td></tr>
<tr><td><code id="time_to_logcount_+3A_log_count">log_count</code></td>
<td>
<p>The target log microbial count.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The predicted time to reach <code>log_count</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## First of all, we will get an IsothermalGrowth object

my_model &lt;- "modGompertz"
my_pars &lt;- list(logN0 = 2, C = 6, mu = .2, lambda = 25)
my_time &lt;- seq(0, 100, length = 1000)

static_prediction &lt;- predict_isothermal_growth(my_model, my_time, my_pars)
plot(static_prediction)

## And now we calculate the time to reach a microbial count

time_to_logcount(static_prediction, 2.5)

## If log_count is outside the range of the predicted values, NA is returned

time_to_logcount(static_prediction, 20)



</code></pre>

<hr>
<h2 id='time_to_size'>Time for the population to reach a given size</h2><span id='topic+time_to_size'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Calculates the elapsed time required for the population to reach a given size
(in log scale)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time_to_size(model, size, type = "discrete", logbase_logN = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="time_to_size_+3A_model">model</code></td>
<td>
<p>An instance of <a href="#topic+GrowthPrediction">GrowthPrediction</a>, <a href="#topic+GrowthFit">GrowthFit</a>, <a href="#topic+GlobalGrowthFit">GlobalGrowthFit</a>,
<a href="#topic+GrowthUncertainty">GrowthUncertainty</a> or <a href="#topic+MCMCgrowth">MCMCgrowth</a>.</p>
</td></tr>
<tr><td><code id="time_to_size_+3A_size">size</code></td>
<td>
<p>Target population size (in log scale)</p>
</td></tr>
<tr><td><code id="time_to_size_+3A_type">type</code></td>
<td>
<p>Tye of calculation, either &quot;discrete&quot; (default) or &quot;distribution&quot;</p>
</td></tr>
<tr><td><code id="time_to_size_+3A_logbase_logn">logbase_logN</code></td>
<td>
<p>Base of the logarithm for the population size. By default,
10 (i.e. log10). See vignette about units for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calculation method differs depending on the value of <code>type</code>. If <code>type="discrete"</code>
(default), the function calculates by linear interpolation a discrete time to
reach the target population size. If <code>type="distribution"</code>, this calculation
is repeated several times, generating a distribution of the time. Note that this
is only possible for instances of <a href="#topic+GrowthUncertainty">GrowthUncertainty</a> or <a href="#topic+MCMCgrowth">MCMCgrowth</a>.
</p>


<h3>Value</h3>

<p>If  <code>type="discrete"</code>, a number. If <code>type="distribution"</code>, an instance of
<a href="#topic+TimeDistribution">TimeDistribution</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1 - Growth predictions -------------------------------------------

## The model is defined as usual with predict_growth

my_model &lt;- list(model = "modGompertz", logN0 = 0, C = 6, mu = .2, lambda = 20)

my_time &lt;- seq(0, 100, length = 1000)  # Vector of time points for the calculations

my_prediction &lt;- predict_growth(my_time, my_model, environment = "constant")

plot(my_prediction)

## We just have to pass the model and the size (in log10)

time_to_size(my_prediction, 3)

## If the size is not reached, it returns NA

time_to_size(my_prediction, 8)

## By default, it considers the population size is defined in the same log-base
## as the prediction. But that can be changed using logbase_logN

time_to_size(my_prediction, 3)
time_to_size(my_prediction, 3, logbase_logN = 10)
time_to_size(my_prediction, log(100), logbase_logN = exp(1))

## Example 2 - Model fit ----------------------------------------------------

my_data &lt;- data.frame(time = c(0, 25, 50, 75, 100), 
                      logN = c(2, 2.5, 7, 8, 8))
                      
models &lt;- list(primary = "Baranyi")

known &lt;- c(mu = .2)

start &lt;- c(logNmax = 8, lambda = 25, logN0 = 2)

primary_fit &lt;- fit_growth(my_data, models, start, known,
                          environment = "constant",
                          )
                          
plot(primary_fit)

time_to_size(primary_fit, 4)

## Example 3 - Global fitting -----------------------------------------------

## We need a model first

data("multiple_counts")
data("multiple_conditions")

sec_models &lt;- list(temperature = "CPM", pH = "CPM")

known_pars &lt;- list(Nmax = 1e8, N0 = 1e0, Q0 = 1e-3,
                   temperature_n = 2, temperature_xmin = 20, 
                   temperature_xmax = 35,
                   temperature_xopt = 30,
                   pH_n = 2, pH_xmin = 5.5, pH_xmax = 7.5, pH_xopt = 6.5)
                   
my_start &lt;- list(mu_opt = .8)

global_fit &lt;- fit_growth(multiple_counts, 
                         sec_models, 
                         my_start, 
                         known_pars,
                         environment = "dynamic",
                         algorithm = "regression",
                         approach = "global",
                         env_conditions = multiple_conditions
                         ) 
                         
plot(global_fit)

## The function calculates the time for each experiment

time_to_size(global_fit, 3)

## It returns NA for the particular experiment if the size is not reached

time_to_size(global_fit, 4.5)

</code></pre>

<hr>
<h2 id='TimeDistribution'>TimeDistribution class</h2><span id='topic+TimeDistribution'></span><span id='topic+print.TimeDistribution'></span><span id='topic+summary.TimeDistribution'></span><span id='topic+plot.TimeDistribution'></span>

<h3>Description</h3>

<p>The <code>TimeDistribution</code> class contains an estimate of the probability
distribution of the time to reach a given microbial count.
Its constructor is <code><a href="#topic+distribution_to_logcount">distribution_to_logcount()</a></code>.
</p>
<p>It is a subclass of list with the items:
</p>

<ul>
<li><p> distribution Sample of the distribution of times to reach <code>log_count</code>.
</p>
</li>
<li><p> summary Summary statistics of distribution (mean, sd, median, q10 and q90).
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TimeDistribution'
print(x, ...)

## S3 method for class 'TimeDistribution'
summary(object, ...)

## S3 method for class 'TimeDistribution'
plot(x, y = NULL, ..., bin_width = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TimeDistribution_+3A_x">x</code></td>
<td>
<p>The object of class <code>TimeDistribution</code> to plot.</p>
</td></tr>
<tr><td><code id="TimeDistribution_+3A_...">...</code></td>
<td>
<p>ignored.</p>
</td></tr>
<tr><td><code id="TimeDistribution_+3A_object">object</code></td>
<td>
<p>An instance of <code>TimeDistribution</code>.</p>
</td></tr>
<tr><td><code id="TimeDistribution_+3A_y">y</code></td>
<td>
<p>ignored.</p>
</td></tr>
<tr><td><code id="TimeDistribution_+3A_bin_width">bin_width</code></td>
<td>
<p>A number that specifies the width of a bin in the histogram,
see: <code><a href="ggplot2.html#topic+geom_histogram">geom_histogram()</a></code>. <code>NULL</code> by default.</p>
</td></tr>
</table>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>print(TimeDistribution)</code>: print of the model
</p>
</li>
<li> <p><code>summary(TimeDistribution)</code>: summary of the model
</p>
</li>
<li> <p><code>plot(TimeDistribution)</code>: plot of the distribution of the time to reach a
microbial count.
</p>
</li></ul>

<hr>
<h2 id='trilinear_model'>Trilinear growth model</h2><span id='topic+trilinear_model'></span>

<h3>Description</h3>

<p>Trilinear growth model defined by Buchanan et al. (1997).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trilinear_model(times, logN0, mu, lambda, logNmax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trilinear_model_+3A_times">times</code></td>
<td>
<p>Numeric vector of storage times</p>
</td></tr>
<tr><td><code id="trilinear_model_+3A_logn0">logN0</code></td>
<td>
<p>Initial log microbial count</p>
</td></tr>
<tr><td><code id="trilinear_model_+3A_mu">mu</code></td>
<td>
<p>Maximum specific growth rate (in ln CFU/<a href="base.html#topic+t">t</a>)</p>
</td></tr>
<tr><td><code id="trilinear_model_+3A_lambda">lambda</code></td>
<td>
<p>Lag phase duration</p>
</td></tr>
<tr><td><code id="trilinear_model_+3A_lognmax">logNmax</code></td>
<td>
<p>Maximum log microbial count</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector with the predicted microbial count.
</p>

<hr>
<h2 id='zwietering_gamma'>Zwietering gamma model</h2><span id='topic+zwietering_gamma'></span>

<h3>Description</h3>

<p>Gamma model as defined by Zwietering et al. (1992). To avoid unreasonable predictions,
it has been modified setting gamma=0 for values of x outside (xmin, xopt)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zwietering_gamma(x, xmin, xopt, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zwietering_gamma_+3A_x">x</code></td>
<td>
<p>Value of the environmental factor.</p>
</td></tr>
<tr><td><code id="zwietering_gamma_+3A_xmin">xmin</code></td>
<td>
<p>Minimum value of the environmental factor for growth.</p>
</td></tr>
<tr><td><code id="zwietering_gamma_+3A_xopt">xopt</code></td>
<td>
<p>Maximum value for growth</p>
</td></tr>
<tr><td><code id="zwietering_gamma_+3A_n">n</code></td>
<td>
<p>Exponent of the secondary model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The corresponding gamma factor.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
