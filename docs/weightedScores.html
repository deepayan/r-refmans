<!DOCTYPE html><html lang="en"><head><title>Help for package weightedScores</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {weightedScores}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#weightedScores-package'><p>Weighted Scores Method for Regression Models with Dependent Data</p></a></li>
<li><a href='#approxbvncdf'><p>APPROXIMATION OF BIVARIATE STANDARD NORMAL DISTRIBUTION</p></a></li>
<li><a href='#arthritis'>
<p>Rheumatoid Arthritis Clinical Trial</p></a></li>
<li><a href='#bcl'><p>BIVARIATE COMPOSITE LIKELIHOOD FOR MULTIVARIATE NORMAL COPULA WITH CATEGORICAL AND COUNT REGRESSION</p></a></li>
<li><a href='#childvisit'><p>Hospital Visit Data</p></a></li>
<li><a href='#cl1'><p>OPTIMIZATION ROUTINE FOR BIVARIATE COMPOSITE LIKELIHOOD FOR MVN COPULA</p></a></li>
<li><a href='#clic'><p>CL1 INFORMATION CRITERIA</p></a></li>
<li><a href='#godambe'><p>INVERSE GODAMBE MATRIX</p></a></li>
<li><a href='#iee'><p>INDEPENDENT ESTIMATING EQUATIONS FOR BINARY AND COUNT REGRESSION</p></a></li>
<li><a href='#iee.ord'>
<p>Maximum Likelihood for Ordinal Model</p></a></li>
<li><a href='#marglik'><p>NEGATIVE LOG-LIKELIHOOD ASSUMING INDEPEDENCE WITHIN CLUSTERS</p></a></li>
<li><a href='#margmodel'><p>DENSITY AND CDF OF THE UNIVARIATE MARGINAL DISTRIBUTION</p></a></li>
<li><a href='#mvn.deriv'>
<p>Derivatives of Multivariate Normal Rectangle Probabilities</p></a></li>
<li><a href='#mvnapp'>
<p>MVN Rectangle Probabilities</p></a></li>
<li><a href='#scoreCov'><p>COVARIANCE MATRIX OF THE UNIVARIATE SCORES</p></a></li>
<li><a href='#solvewtsc'><p>SOLVING THE WEIGHTED SCORES EQUATIONS WITH INPUTS OF THE WEIGHT MATRICES AND THE DATA</p></a></li>
<li><a href='#toenail'><p>The toenail infection data</p></a></li>
<li><a href='#weightMat'><p>WEIGHT MATRICES FOR THE ESTIMATING EQUATIONS</p></a></li>
<li><a href='#wtsc'><p>THE WEIGHTED SCORES EQUATIONS WITH INPUTS OF THE WEIGHT MATRICES AND THE DATA</p></a></li>
<li><a href='#wtsc.wrapper'><p>THE WEIGHTED SCORES METHOD  WITH INPUTS OF THE DATA</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.9.5.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-03-20</td>
</tr>
<tr>
<td>Title:</td>
<td>Weighted Scores Method for Regression Models with Dependent Data</td>
</tr>
<tr>
<td>Author:</td>
<td>Aristidis K. Nikoloulopoulos [aut, cre],
  Harry Joe [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aristidis K. Nikoloulopoulos &lt;a.nikoloulopoulos@uea.ac.uk&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.0.0), mvtnorm, rootSolve</td>
</tr>
<tr>
<td>Description:</td>
<td>The weighted scores method and composite likelihood information criteria as an intermediate step for variable/correlation selection for longitudinal ordinal and count data in Nikoloulopoulos, Joe and Chaganty (2011)  &lt;<a href="https://doi.org/10.1093%2Fbiostatistics%2Fkxr005">doi:10.1093/biostatistics/kxr005</a>&gt;, Nikoloulopoulos (2016) &lt;<a href="https://doi.org/10.1002%2Fsim.6871">doi:10.1002/sim.6871</a>&gt; and Nikoloulopoulos (2017) &lt;<a href="https://doi.org/10.48550/arXiv.1510.07376">doi:10.48550/arXiv.1510.07376</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-20 21:04:41 UTC; xry09vgu</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-23 17:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='weightedScores-package'>Weighted Scores Method for Regression Models with Dependent Data</h2><span id='topic+weightedScores-package'></span>

<h3>Description</h3>

<p>The weighted scores method and CL1 information criteria as an intermediate step for variable/correlation selection for longitudinal ordinal and count data in Nikoloulopoulos, Joe and Chaganty (2011)  and Nikoloulopoulos (2016, 2017).
</p>


<h3>Details</h3>

<p>This package contains <span class="rlang"><b>R</b></span> functions to implement: 
</p>

<ul>
<li><p> The weighted scores method for regression models with dependent data and negative binomial  (Nikoloulopoulos, Joe and Chaganty, 2011), GLM (Nikoloulopoulos, 2016) and ordinal probit/logistic (Nikoloulopoulos, 2017) margins.
</p>
</li>
<li><p> The composite likelihood information criteria for regression models with dependent data and ordinal probit/logistic  margins (Nikoloulopoulos, 2016, 2017). 
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos.
</p>


<h3>References</h3>

<p>Nikoloulopoulos, A.K., Joe, H. and Chaganty, N.R. (2011)
Weighted scores method for regression models with dependent data.
<em>Biostatistics</em>, <b>12</b>, 653&ndash;665. doi: <a href="https://doi.org/10.1093/biostatistics/kxr005">10.1093/biostatistics/kxr005</a>.
</p>
<p>Nikoloulopoulos, A.K. (2016)
Correlation structure and variable selection in generalized estimating equations via composite likelihood information criteria.
<em>Statistics in Medicine</em>, <b>35</b>, 2377&ndash;2390. doi: <a href="https://doi.org/10.1002/sim.6871">10.1002/sim.6871</a>.
</p>
<p>Nikoloulopoulos, A.K. (2017)
Weighted scores method for longitudinal  ordinal data.
<em>Arxiv e-prints</em>, &lt;arXiv:1510.07376&gt;. <a href="https://arxiv.org/abs/1510.07376">https://arxiv.org/abs/1510.07376</a>.
</p>

<hr>
<h2 id='approxbvncdf'>APPROXIMATION OF BIVARIATE STANDARD NORMAL DISTRIBUTION</h2><span id='topic+approxbvncdf'></span>

<h3>Description</h3>

<p>Approximation of bivariate standard normal cumulative distribution function
(Johnson and Kotz, 1972).</p>


<h3>Usage</h3>

<pre><code class='language-R'>approxbvncdf(r,x1,x2,x1s,x2s,x1c,x2c,x1f,x2f,t1,t2)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="approxbvncdf_+3A_r">r</code></td>
<td>
<p>The correlation parameter of bivariate standard normal distribution.</p>
</td></tr>
<tr><td><code id="approxbvncdf_+3A_x1">x1</code></td>
<td>
<p><code class="reqn">x_1,</code> see details.</p>
</td></tr>
<tr><td><code id="approxbvncdf_+3A_x2">x2</code></td>
<td>
<p><code class="reqn">x_2,</code> see details.</p>
</td></tr>
<tr><td><code id="approxbvncdf_+3A_x1s">x1s</code></td>
<td>
<p><code class="reqn">x_1^2.</code></p>
</td></tr>
<tr><td><code id="approxbvncdf_+3A_x2s">x2s</code></td>
<td>
<p><code class="reqn">x_2^2.</code></p>
</td></tr>
<tr><td><code id="approxbvncdf_+3A_x1c">x1c</code></td>
<td>
<p><code class="reqn">x_1^3.</code></p>
</td></tr>
<tr><td><code id="approxbvncdf_+3A_x2c">x2c</code></td>
<td>
<p><code class="reqn">x_2^3.</code></p>
</td></tr>
<tr><td><code id="approxbvncdf_+3A_x1f">x1f</code></td>
<td>
<p><code class="reqn">x_1^4.</code></p>
</td></tr>
<tr><td><code id="approxbvncdf_+3A_x2f">x2f</code></td>
<td>
<p><code class="reqn">x_2^4.</code></p>
</td></tr>
<tr><td><code id="approxbvncdf_+3A_t1">t1</code></td>
<td>
<p><code class="reqn">\Phi(x_1)\Phi(x_2),</code> where <code class="reqn">\Phi(\cdot)</code> is the cdf of univariate
standard normal distribution.</p>
</td></tr>
<tr><td><code id="approxbvncdf_+3A_t2">t2</code></td>
<td>
<p><code class="reqn">\phi(x_1)\phi(x_2),</code> where <code class="reqn">\phi(\cdot)</code> is the density of
univariate stamdard normal distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The approximation for the bivariate normal cdf is from Johnson and Kotz (1972),
page 118.
Let <code class="reqn">\Phi_2(x_1,x_2;\rho)=Pr(Z_1\le x_1,\,Z_2\le x_2)</code>,
where <code class="reqn">(Z_1,Z_2)</code> is bivariate normal with means 0, variances 1 and
correlation <code class="reqn">\rho</code>.
An expansion, due to Pearson (1901), is
</p>
<p style="text-align: center;"><code class="reqn">
  \Phi_2(x_1,x_2;\rho) =\Phi(x_1)\Phi(x_2)
  +\phi(x_1)\phi(x_2) \sum_{j=1}^\infty \rho^j \psi_j(x_1) \psi_j(x_2)/j!</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\psi_j(z) = (-1)^{j-1} d^{j-1} \phi(z)/dz^{j-1}.</code>
</p>

<p>Since
</p>
<p style="text-align: center;"><code class="reqn">\phi'(z) =  -z\phi(z),
  \phi''(z) = (z^2-1)\phi(z) ,
  \phi'''(z) = [2z-z(z^2-1)]\phi(z) = (3z-z^3)\phi(z) ,</code>
</p>

<p style="text-align: center;"><code class="reqn">\phi^{(4)}(z) = [3-3z^2-z(3z-z^3)]\phi(z) = (3-6z^2+z^4)\phi(z)</code>
</p>

<p>we have
</p>
<p style="text-align: center;"><code class="reqn">
  \Phi_2(x_1,x_2;\rho) = \Phi(x_1)\Phi(x_2)+\phi(x_1)\phi(x_2)
   [\rho+ \rho^2x_1x_2/2 + \rho^3 (x_1^2-1)(x_2^2-1)/6 
     +\rho^4 (x_1^3-3x_1)(x_2^3-3x_2)/24</code>
</p>

<p style="text-align: center;"><code class="reqn">+\rho^5 (x_1^4-6x_1^2+3)(x_2^4-6x_2^2+3)/120+\cdots ] </code>
</p>

<p>A good approximation is obtained truncating the series
at <code class="reqn">\rho^3</code> term for  <code class="reqn">|\rho| \le 0.4</code>, and at <code class="reqn">\rho^5</code> term for <code class="reqn">0.4 &lt; |\rho|\le 0.7</code>.
Higher order terms may  be required for <code class="reqn">|\rho| &gt; 0.7</code>.
</p>


<h3>Value</h3>

<p>An approximation of bivariate normal cumulative distribution function.</p>


<h3>References</h3>

<p>Johnson, N. L. and Kotz, S. (1972)
<em>Continuous Multivariate Distributions.</em>
Wiley, New York.
</p>
<p>Pearson, K. (1901)
Mathematical contributions to the theory of evolution-VII. On the
correlation of characters not quantitatively measureable.
<em>Philosophical Transactions
of the Royal Society of London, Series A,</em> <b>195</b>, 1&ndash;47.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scoreCov">scoreCov</a></code>
</p>

<hr>
<h2 id='arthritis'>
Rheumatoid Arthritis Clinical Trial
</h2><span id='topic+arthritis'></span>

<h3>Description</h3>

<p>Rheumatoid self-assessment scores for 302 patients, measured on a five-level ordinal response scale at three follow-up times. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(arthritis)</code></pre>


<h3>Format</h3>

<p>A data frame with 888 observations on the following 7 variables:
</p>

<dl>
<dt><code>id</code></dt><dd><p>Patient identifier variable.</p>
</dd>
<dt><code>y</code></dt><dd><p>Self-assessment score of rheumatoid arthritis measured on a five-level ordinal response scale.</p>
</dd>
<dt><code>sex</code></dt><dd><p>Coded as (1) for female and (2) for male.</p>
</dd>
<dt><code>age</code></dt><dd><p>Recorded at the baseline.</p>
</dd>
<dt><code>trt</code></dt><dd><p>Treatment group variable, coded as (1) for the placebo group and (2) for the drug group.</p>
</dd>
<dt><code>baseline</code></dt><dd><p>Self-assessment score of rheumatoid arthritis at the baseline.</p>
</dd>
<dt><code>time</code></dt><dd><p>Follow-up time recorded in months.</p>
</dd>
</dl>
 


<h3>Source</h3>

<p>Lipsitz, S.R. and Kim, K. and Zhao, L. (1994). Analysis of repeated categorical data using generalized estimating equations. <em>Statistics in Medicine</em>, <b>13</b>, 1149&ndash;1163.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arthritis)
</code></pre>

<hr>
<h2 id='bcl'>BIVARIATE COMPOSITE LIKELIHOOD FOR MULTIVARIATE NORMAL COPULA WITH CATEGORICAL AND COUNT REGRESSION</h2><span id='topic+bcl'></span><span id='topic+bcl.ord'></span>

<h3>Description</h3>

<p>Bivariate composite likelihood for multivariate normal copula with categorical and count regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcl(r,b,gam,xdat,ydat,id,tvec,margmodel,corstr,link)
bcl.ord(r,b,gam,xdat,ydat,id,tvec,corstr,link)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcl_+3A_r">r</code></td>
<td>
<p>The vector of normal copula parameters.</p>
</td></tr>
<tr><td><code id="bcl_+3A_b">b</code></td>
<td>
<p>The regression coefficients.</p>
</td></tr>
<tr><td><code id="bcl_+3A_gam">gam</code></td>
<td>
<p>The uinivariate parameters that are not regression coefficients. That is the parameter <code class="reqn">\gamma</code> of negative binomial distribution or  the <code class="reqn">q</code>-dimensional vector of the univariate cutpoints of ordinal model. <code class="reqn">\gamma</code> is NULL for Poisson and binary regression.</p>
</td></tr>
<tr><td><code id="bcl_+3A_xdat">xdat</code></td>
<td>
<p><code class="reqn">(\mathbf{x}_1 , \mathbf{x}_2 , \ldots , \mathbf{x}_n )^\top</code>, where 
the matrix <code class="reqn">\mathbf{x}_i,\,i=1,\ldots,n</code> for a given unit will
depend on the  times of observation for that unit (<code class="reqn">j_i</code>) and will have
number of rows <code class="reqn">j_i</code>, each row corresponding to one of the <code class="reqn">j_i</code> elements
of <code class="reqn">y_i</code> and <code class="reqn">p</code> columns where <code class="reqn">p</code> is the number of covariates including
the unit first column  to account for the intercept (except for ordinal regression where there is no intercept). This xdat matrix is
of dimension <code class="reqn">(N\times p),</code> where <code class="reqn">N =\sum_{i=1}^n j_i</code> is the total
number of observations from all units.</p>
</td></tr>
<tr><td><code id="bcl_+3A_ydat">ydat</code></td>
<td>
<p><code class="reqn">(y_1 , y_2 , \ldots , y_n  )^\top</code>, where
the response data vectors <code class="reqn">y_i,\,i=1,\ldots,n</code>
are of possibly different lengths for different units.  In particular,
we now have that <code class="reqn">y_i</code> is (<code class="reqn">j_i \times 1</code>), where <code class="reqn">j_i</code> is the   number of
observations on unit <code class="reqn">i</code>. The total number of observations   from all units
is <code class="reqn">N =\sum_{i=1}^n j_i</code>. The ydat are the collection of data   vectors
<code class="reqn">y_i, i = 1,\ldots,n</code> one from each unit which summarize all the data
together in a single, long vector of length <code class="reqn">N</code>.</p>
</td></tr>
<tr><td><code id="bcl_+3A_id">id</code></td>
<td>
<p>An index for individuals or clusters.</p>
</td></tr>
<tr><td><code id="bcl_+3A_tvec">tvec</code></td>
<td>
<p>A vector with the time indicator of individuals or clusters.</p>
</td></tr>
<tr><td><code id="bcl_+3A_margmodel">margmodel</code></td>
<td>

<p>Indicates the marginal model. 
Choices are &ldquo;poisson&rdquo; for Poisson, &ldquo;bernoulli&rdquo; for Bernoulli, 
and  &ldquo;nb1&rdquo; , &ldquo;nb2&rdquo; for the NB1 and NB2 parametrization 
of negative binomial in Cameron and Trivedi (1998).</p>
</td></tr>
<tr><td><code id="bcl_+3A_corstr">corstr</code></td>
<td>
<p>Indicates the latent correlation structure of normal copula.
Choices are &ldquo;exch&rdquo;, &ldquo;ar&rdquo;, and &ldquo;unstr&rdquo; for exchangeable, ar(1)
and unstructured correlation structure, respectively.</p>
</td></tr>
<tr><td><code id="bcl_+3A_link">link</code></td>
<td>
<p>The link function. 
Choices are &ldquo;log&rdquo; for the log link function, &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The
CL1 composite likelihood in Zhao and Joe (2005). That is the sum of bivariate marginal log-likelihoods.
</p>
<p><code>bcl.ord</code> is a variant of the code for ordinal (probit and logistic) regression.</p>


<h3>Value</h3>

<p>The negative bivariate composite likelihood for multivariate normal copula with Poisson or binary or negative
binomial or ordinal regression.
</p>


<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos <a href="mailto:A.Nikoloulopoulos@uea.ac.uk">A.Nikoloulopoulos@uea.ac.uk</a><br />
Harry Joe <a href="mailto:harry.joe@ubc.ca">harry.joe@ubc.ca</a>
</p>


<h3>References</h3>

<p>Zhao, Y. and Joe, H. (2005)
Composite likelihood estimation in multivariate data analysis.
<em>The Canadian Journal of Statistics</em>,  <b>33</b>, 335&ndash;356.
</p>
<p>Cameron, A. C. and Trivedi, P. K. (1998)
<em>Regression Analysis of Count Data.</em>
Cambridge: Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cl1">cl1</a></code>,
<code><a href="#topic+iee">iee</a></code>
</p>

<hr>
<h2 id='childvisit'>Hospital Visit Data</h2><span id='topic+childvisit'></span>

<h3>Description</h3>

<p>The response vector  consists of quarterly numbers of hospital visits over a
one year period for a child age at four or younger, and three baseline covariates
are age, sex, and maternal smoking status.  The sample size of this study is <code class="reqn">n=73</code>
children.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(childvisit)</code></pre>


<h3>Format</h3>

<p>A data frame with 292 observations on the following 6 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>The child ID.</p>
</dd>
<dt><code>age</code></dt><dd><p>The age in months.</p>
</dd>
<dt><code>sex</code></dt><dd><p>The sex indicator.</p>
</dd>
<dt><code>matsmst</code></dt><dd><p>The maternal smoking status.</p>
</dd>
<dt><code>quarter</code></dt><dd><p>The time indicator.</p>
</dd>
<dt><code>hospvis</code></dt><dd><p>The response vector  of quarterly numbers of hospital visits.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Song P.X.K. (2007). Correlated Data Analysis: Modeling, Analytics, and Application. 
<em>Correlated Data Analysis: Modeling, Analytics, and Application.</em> Book Webpage/Supplementary Material. Springer,
NY. 
</p>

<hr>
<h2 id='cl1'>OPTIMIZATION ROUTINE FOR BIVARIATE COMPOSITE LIKELIHOOD FOR MVN COPULA</h2><span id='topic+cl1'></span><span id='topic+cl1.ord'></span>

<h3>Description</h3>

<p>Optimization routine for bivariate composite likelihood for MVN copula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cl1(b,gam,xdat,ydat,id,tvec,margmodel,corstr,link)
cl1.ord(b,gam,xdat,ydat,id,tvec,corstr,link)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cl1_+3A_b">b</code></td>
<td>
<p>The regression coefficients.</p>
</td></tr>
<tr><td><code id="cl1_+3A_gam">gam</code></td>
<td>
<p>The uinivariate parameters that are not regression coefficients. That is the parameter <code class="reqn">\gamma</code> of negative binomial distribution or  the <code class="reqn">q</code>-dimensional vector of the univariate cutpoints of ordinal model. <code class="reqn">\gamma</code> is NULL for Poisson and binary regression.</p>
</td></tr>
<tr><td><code id="cl1_+3A_xdat">xdat</code></td>
<td>
<p><code class="reqn">(\mathbf{x}_1 , \mathbf{x}_2 , \ldots , \mathbf{x}_n )^\top</code>, 
where the matrix <code class="reqn">\mathbf{x}_i,\,i=1,\ldots,n</code> for a given unit will
depend on the  times of observation for that unit (<code class="reqn">j_i</code>) and will have
number of rows <code class="reqn">j_i</code>, each row corresponding to one of the <code class="reqn">j_i</code> elements
of <code class="reqn">y_i</code> and <code class="reqn">p</code> columns where <code class="reqn">p</code> is the number of covariates including
the unit first column  to account for the intercept (except for ordinal regression where there is no intercept). This xdat matrix is
of dimension <code class="reqn">(N\times p),</code> where <code class="reqn">N =\sum_{i=1}^n j_i</code> is the total
number of observations from all units.</p>
</td></tr>
<tr><td><code id="cl1_+3A_ydat">ydat</code></td>
<td>
<p><code class="reqn">(y_1 , y_2 , \ldots , y_n )^\top</code>, where
the response data vectors <code class="reqn">y_i,\,i=1,\ldots,n</code>
are of possibly different lengths for different units.  In particular,
we now have that <code class="reqn">y_i</code> is (<code class="reqn">j_i \times 1</code>), where <code class="reqn">j_i</code> is the   number of
observations on unit <code class="reqn">i</code>. The total number of observations   from all units
is <code class="reqn">N =\sum_{i=1}^n j_i</code>. The ydat are the collection of data   vectors
<code class="reqn">y_i, i = 1,\ldots,n</code> one from each unit which summarize all the data
together in a single, long vector of length <code class="reqn">N</code>.</p>
</td></tr>
<tr><td><code id="cl1_+3A_id">id</code></td>
<td>
<p>An index for individuals or clusters.</p>
</td></tr>
<tr><td><code id="cl1_+3A_tvec">tvec</code></td>
<td>
<p>A vector with the time indicator of individuals or clusters.</p>
</td></tr>
<tr><td><code id="cl1_+3A_margmodel">margmodel</code></td>
<td>

<p>Indicates the marginal model.
Choices are &ldquo;poisson&rdquo; for Poisson, &ldquo;bernoulli&rdquo; for Bernoulli, 
and  &ldquo;nb1&rdquo; , &ldquo;nb2&rdquo; for the NB1 and NB2 parametrization 
of negative binomial in Cameron and Trivedi (1998).</p>
</td></tr>
<tr><td><code id="cl1_+3A_corstr">corstr</code></td>
<td>
<p>Indicates the latent correlation structure of normal copula.
Choices are &ldquo;exch&rdquo;, &ldquo;ar&rdquo;, and &ldquo;unstr&rdquo; for exchangeable, ar(1)
and unstructured correlation structure, respectively.</p>
</td></tr>
<tr><td><code id="cl1_+3A_link">link</code></td>
<td>
<p>The link function. 
Choices are &ldquo;log&rdquo; for the log link function, &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The
CL1 composite likelihood method in Zhao and Joe (2005). The
univariate parameters  are estimated
from the sum of univariate marginal log-likelihoods and then the dependence
parameters are estimated from the sum of bivariate marginal log-likelihoods
with the univariate parameters fixed from the first step. 
</p>
<p>Note that <code>bcl.ord</code> is a variant of the code for ordinal (probit and logistic) regression.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>minimum</code></td>
<td>
<p>The negative value of the sum of bivariate marginal log-likelihoods at
CL1 estimates.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>The CL1 estimates.</p>
</td></tr>
<tr><td><code>gradient</code></td>
<td>
<p>The gradient at the estimated minimum of CL1.</p>
</td></tr>
<tr><td><code>code</code></td>
<td>
<p>An integer indicating why the optimization process terminated,
same as in <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos <a href="mailto:A.Nikoloulopoulos@uea.ac.uk">A.Nikoloulopoulos@uea.ac.uk</a><br />
Harry Joe <a href="mailto:harry.joe@ubc.ca">harry.joe@ubc.ca</a>
</p>


<h3>References</h3>

<p>Zhao, Y. and Joe, H. (2005)
Composite likelihood estimation in multivariate data analysis.
<em>The Canadian Journal of Statistics</em>,  <b>33</b>, 335&ndash;356.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcl">bcl</a></code>
<code><a href="#topic+iee">iee</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>################################################################################
#                      NB1 regression for count data
################################################################################
################################################################################
#                      read and set up data set
################################################################################
data(childvisit)
# covariates
season1&lt;-childvisit$q
season1[season1&gt;1]&lt;-0
xdat&lt;-cbind(1,childvisit$sex,childvisit$age,childvisit$m,season1)
# response
ydat&lt;-childvisit$hosp
#id
id&lt;-childvisit$id
#time
tvec&lt;-childvisit$q
################################################################################
#                      select the marginal model
################################################################################
margmodel="nb1"
################################################################################
#                      select the  correlation structure
################################################################################
corstr="exch"
################################################################################
#                      perform CL1 estimation
################################################################################
i.est&lt;-iee(xdat,ydat,margmodel)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
est.rho&lt;-cl1(b=i.est$reg,gam=i.est$gam,xdat,ydat,id,tvec,margmodel,corstr)
cat("\nest.rho: CL1 estimates\n")
print(est.rho$e)
################################################################################
#                         Ordinal regression 
################################################################################
################################################################################
#                      read and set up data set
################################################################################

data(arthritis)
nn=nrow(arthritis)
bas2&lt;-bas3&lt;-bas4&lt;-bas5&lt;-rep(0,nn)
bas2[arthritis$b==2]&lt;-1
bas3[arthritis$b==3]&lt;-1
bas4[arthritis$b==4]&lt;-1
bas5[arthritis$b==5]&lt;-1
t2&lt;-t3&lt;-rep(0,nn)
t2[arthritis$ti==3]&lt;-1
t3[arthritis$ti==5]&lt;-1
xdat=cbind(t2,t3,arthritis$trt,bas2,bas3,bas4,bas5,arthritis$age) 
ydat=arthritis$y
id&lt;-arthritis$id
#time
tvec&lt;-arthritis$time
################################################################################
#                      select the link
################################################################################
link="logit"
################################################################################
#                      select the  correlation structure
################################################################################
corstr="exch"
################################################################################
#                      perform CL1 estimation
################################################################################
i.est&lt;-iee.ord(xdat,ydat,link)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
est.rho&lt;-cl1.ord(b=i.est$reg,gam=i.est$gam,xdat,ydat,id,tvec,corstr,link)
cat("\nest.rho: CL1 estimates\n")
print(est.rho$e)

</code></pre>

<hr>
<h2 id='clic'>CL1 INFORMATION CRITERIA</h2><span id='topic+clic'></span><span id='topic+clic1dePar'></span>

<h3>Description</h3>

<p>Composite likelihood (CL1) information criteria. </p>


<h3>Usage</h3>

<pre><code class='language-R'>clic1dePar(nbcl,r,b,gam,xdat,id,tvec,corstr,WtScMat,link,mvncmp)
clic(nbcl,r,b,gam,xdat,id,tvec,corstr,WtScMat,link,mvncmp)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clic_+3A_nbcl">nbcl</code></td>
<td>
<p>The negative value of the sum of bivariate marginal log-likelihoods at
CL1 estimates.</p>
</td></tr>
<tr><td><code id="clic_+3A_r">r</code></td>
<td>
<p>The CL1 estimates of the latent correlations.</p>
</td></tr>
<tr><td><code id="clic_+3A_b">b</code></td>
<td>
<p>The CL1 estimates of the regression coefficients.</p>
</td></tr>
<tr><td><code id="clic_+3A_gam">gam</code></td>
<td>
<p>The CL1 estimates of the cutpoints.</p>
</td></tr>
<tr><td><code id="clic_+3A_xdat">xdat</code></td>
<td>
<p><code class="reqn">(\mathbf{x}_1 , \mathbf{x}_2 , \ldots ,
  \mathbf{x}_n )^\top</code>, where the matrix <code class="reqn">\mathbf{x}_i,\,i=1,\ldots,n</code> for a given unit will
depend on the  times of observation for that unit (<code class="reqn">j_i</code>) and will have
number of rows <code class="reqn">j_i</code>, each row corresponding to one of the <code class="reqn">j_i</code> elements
of <code class="reqn">y_i</code> and <code class="reqn">p</code> columns where <code class="reqn">p</code> is the number of covariates. This xdat matrix is
of dimension <code class="reqn">(N\times p),</code> where <code class="reqn">N =\sum_{i=1}^n j_i</code> is the total
number of observations from all units.</p>
</td></tr>
<tr><td><code id="clic_+3A_id">id</code></td>
<td>
<p>An index for individuals or clusters.</p>
</td></tr>
<tr><td><code id="clic_+3A_tvec">tvec</code></td>
<td>
<p>A vector with the time indicator of individuals or clusters.</p>
</td></tr>
<tr><td><code id="clic_+3A_wtscmat">WtScMat</code></td>
<td>
<p>A list containing the following components.
omega: The array with the <code class="reqn">\Omega_i,\,i=1,\ldots,n</code> matrices;
delta: The array with the <code class="reqn">\Delta_i,\,i=1,\ldots,n</code> matrices;
X: The array with the <code class="reqn">X_i,\,i=1,\ldots,n</code> matrices.</p>
</td></tr>
<tr><td><code id="clic_+3A_corstr">corstr</code></td>
<td>
<p>Indicates the latent correlation structure of normal copula.
Choices are &ldquo;exch&rdquo;, &ldquo;ar&rdquo;, and &ldquo;unstr&rdquo; for exchangeable, ar(1)
and unstructured correlation structure, respectively.</p>
</td></tr>
<tr><td><code id="clic_+3A_link">link</code></td>
<td>
<p>The link function. 
Choices are  &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function.</p>
</td></tr>
<tr><td><code id="clic_+3A_mvncmp">mvncmp</code></td>
<td>
<p>The method of computation of the MVN rectangle probabilities. 
Choices are  1 for <code>mvnapp</code> (faster), and 2 for 
<code>pmvnorm</code> (more accurate).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>First, consider the sum of univariate log-likelihoods 
</p>
<p style="text-align: center;"><code class="reqn">L_1= \sum_{i=1}^n\sum_{j=1}^d\, \log f_1(y_{ij};\nu_{ij},\boldsymbol{\gamma})=\sum_{i=1}^n\sum_{j=1}^d\,
 \ell_1(\nu_{ij},\boldsymbol{\gamma},\, y_{ij}),
</code>
</p>

<p>and then the sum of bivariate log-likelihoods
</p>
<p style="text-align: center;"><code class="reqn">L_2=\sum_{i=1}^{n}\sum_{j&lt;k}
\log{f_2(y_{ij},y_{ik};\nu_{ij},\nu_{ik},\boldsymbol{\gamma},\rho_{jk})}=\sum_{i=1}^{n}\sum_{j&lt;k}\ell_2(\nu_{ij},\nu_{ik},\boldsymbol{\gamma},\rho_{jk};y_{ij},y_{ik}),</code>
</p>

<p>where <code class="reqn">\ell_2(\cdot)=\log f_2(\cdot)</code> and
</p>
<p style="text-align: center;"><code class="reqn">
f_2(y_{ij},y_{ik};\nu_{ij},\nu_{ik},\boldsymbol{\gamma},\rho_{jk})=\int_{\Phi^{-1}[F_1(y_{ij}-1;\nu_{ij},\boldsymbol{\gamma})]}^{\Phi^{-1}[F_1(y_{ij};\nu_{ij},\boldsymbol{\gamma})]}
\int_{\Phi^{-1}[F_1(y_{ik}-1;\nu_{ik}),\boldsymbol{\gamma}]}^{\Phi^{-1}[F_1(y_{ik};\nu_{ik},\boldsymbol{\gamma})]}  \phi_2(z_j,z_d;\rho_{jk}) dz_j dz_k;
</code>
</p>
 
<p><code class="reqn">\phi_2(\cdot;\rho)</code> denotes the standard bivariate normal density  with correlation
<code class="reqn">\rho</code>.
</p>
<p>Let <code class="reqn">\mathbf{a}^\top=(\boldsymbol{\beta}^\top,\boldsymbol{\gamma}^\top)</code> be the
column vector of all  <code class="reqn">r=p+q</code> univariate parameters. Differentiating <code class="reqn">L_1</code> with respect to <code class="reqn">\mathbf{a}</code> leads to the independent estimating equations or univariate composite score functions:
</p>
<p style="text-align: center;"><code class="reqn">
\mathbf{g}_1=\mathbf{g}_1(\mathbf{a})=
\frac{\partial L_1}{\partial \mathbf{a}}=  
\sum_{i=1}^n\mathbf{X}_i^\top\mathbf{s}_i^{(1)}(\mathbf{a})=\bf 0,
</code>
</p>

<p>Differentiating <code class="reqn">L_2</code> with respect to <code class="reqn">\mathbf{R}=\bigl(\rho_{jk},1\leq j&lt;k\leq d\bigr)</code> 
leads to the bivariate composite score functions (Zhao and Joe, 2005):
</p>
<p style="text-align: center;"><code class="reqn">
\mathbf{g}_2=\frac{\partial L_2}{\partial \mathbf{R}}= \sum_{i=1}^{n}\mathbf{s}_i^{(2)}(\mathbf{a},\mathbf{R})= \sum_{i=1}^n\Bigl(\mathbf{s}_{i,jk}^{(2)}(\mathbf{a},\rho_{jk}),1\leq j&lt;k\leq d\Bigr)=\mathbf{0},
</code>
</p>

<p>where <code class="reqn">\mathbf{s}_i^{(2)}(\mathbf{a},\mathbf{R})=\frac{\partial\sum_{j&lt;k}\ell_2(\nu_{ij},\nu_{ik},\boldsymbol{\gamma},\rho_{jk};y_{ij},y_{ik})}{\partial \mathbf{R}}</code> and  <code class="reqn">\mathbf{s}_{i,jk}^{(2)}(\boldsymbol{\gamma},\rho_{jk})=\frac{\partial \ell_2(\nu_{ij},\nu_{ik},\boldsymbol{\gamma},\rho_{jk};y_{ij},y_{ik})}{\partial \rho_{jk}}</code>.
The CL1 estimates <code class="reqn">\widetilde{\mathbf{a}}</code> and <code class="reqn">\widetilde{\mathbf{R}}</code>  of the discretized MVN model are obtained
by solving the above CL1 estimating functions.
</p>
<p>The asymptotic covariance matrix for the estimator that solves them, also known as the inverse Godambe (Godambe, 1991) information matrix, is
</p>
<p style="text-align: center;"><code class="reqn">
\mathbf{V}=(-\mathbf{H}_\mathbf{g})^{-1}\mathbf{J}_\mathbf{g}(-\mathbf{H}_\mathbf{g}^\top)^{-1},
</code>
</p>

<p>where <code class="reqn">\mathbf{g}=(\mathbf{g}_1,\mathbf{g}_2)^\top</code>. First set <code class="reqn">\boldsymbol{\theta}=(\mathbf{a},\mathbf{R})^\top</code>,  then
</p>
<p style="text-align: center;"><code class="reqn">
-\mathbf{H}_\mathbf{g}=E\Bigl(\frac{\partial \mathbf{g}}{\partial\boldsymbol{\theta}}\Bigr)=
\left[\begin{array}{cc}
E\Bigl(\frac{\partial \mathbf{g}_1}{\partial\mathbf{a}}\Bigr)
&amp; E\Bigl(\frac{\partial \mathbf{g}_1}{\partial\mathbf{R}}\Bigr)\\
E\Bigl(\frac{\partial \mathbf{g}_2}{\partial\mathbf{a}}\Bigr) &amp;
E\Bigl(\frac{\partial \mathbf{g}_2}{\partial\mathbf{R}}\Bigr)
\end{array}\right]=
\left[\begin{array}{cc}
-\mathbf{H}_{\mathbf{g}_1}&amp;\mathbf{0}\\
-\mathbf{H}_{\mathbf{g}_{2,1}}&amp;-\mathbf{H}_{\mathbf{g}_2}
\end{array}\right],
</code>
</p>

<p>where <code class="reqn">-\mathbf{H}_{\mathbf{g}_1}=\sum_i^n\mathbf{X}_i^\top\boldsymbol{\Delta}_i^{(1)}
\mathbf{X}_i</code>,
<code class="reqn">-\mathbf{H}_{\mathbf{g}_{2,1}}=\sum_i^n\boldsymbol{\Delta}_i^{(2,1)}\mathbf{X}_i</code>,
and
<code class="reqn">-\mathbf{H}_{\mathbf{g}_2}=\sum_i^n\boldsymbol{\Delta}_i^{(2,2)}</code>.
</p>
<p>The covariance matrix <code class="reqn">\mathbf{J}_\mathbf{g}</code> of the composite score functions <code class="reqn">\mathbf{g}</code> is given as below
</p>
<p style="text-align: center;"><code class="reqn">
\mathbf{J}_\mathbf{g}=\mbox{Cov}(\mathbf{g})=
\left[\begin{array}{cc}
\mbox{Cov}(\mathbf{g}_1) &amp; \mbox{Cov}(\mathbf{g}_1,\mathbf{g}_2)\\
\mbox{Cov}(\mathbf{g}_2,\mathbf{g}_1) &amp; \mbox{Cov}(\mathbf{g}_2)
\end{array}\right]=
\left[\begin{array}{cc}\mathbf{J}_\mathbf{g}^{(1)}&amp; \mathbf{J}_\mathbf{g}^{(1,2)}\\
\mathbf{J}_\mathbf{g}^{(2,1)}&amp; \mathbf{J}_\mathbf{g}^{(2)}\end{array}\right]=
\sum_i\left[\begin{array}{cc}
\mathbf{X}_i^\top\boldsymbol{\Omega}_i^{(1)}
\mathbf{X}_i &amp; \mathbf{X}_i^\top\boldsymbol{\Omega}_i^{(1,2)}\\
\boldsymbol{\Omega}_i^{(2,1)}\mathbf{X}_i&amp; \boldsymbol{\Omega}_i^{(2)}\end{array}\right],
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\left[\begin{array}{cc}
\boldsymbol{\Omega}_i^{(1)}&amp; \boldsymbol{\Omega}_i^{(1,2)}\\
\boldsymbol{\Omega}_i^{(2,1)}&amp; \boldsymbol{\Omega}_i^{(2)}
\end{array}\right]=
\left[\begin{array}{cc}
\mbox{Cov}\Bigl(\mathbf{s}_i^{(1)}(\mathbf{a})\Bigr) &amp; 
\mbox{Cov}\Bigl(\mathbf{s}_i^{(1)}(\mathbf{a}),
\mathbf{s}_i^{(2)}(\mathbf{a},\mathbf{R})\Bigr)\\
\mbox{Cov}\Bigl(\mathbf{s}_i^{(2)}(\mathbf{a},\mathbf{R}),
\mathbf{s}_i^{(1)}(\mathbf{a})\Bigr) &amp; \mbox{Cov}\Bigl(\mathbf{s}_i^{(2)}(\mathbf{a},\mathbf{R})\Bigr)
\end{array}\right].
</code>
</p>

<p>To this end, the composite AIC (Varin and Vidoni, 2005) and  BIC (Gao and Song, 2011)  criteria have the forms:
</p>
<p style="text-align: center;"><code class="reqn">
\mbox{CL1AIC} =  -2L_2 + 2\mbox{tr}\Bigl(\mathbf{J}_\mathbf{g}\mathbf{H}_\mathbf{g}^{-1}\Bigr),
</code>
</p>

<p style="text-align: center;"><code class="reqn">
\mbox{CL1BIC} =-2L_2+\log(n)\mbox{tr}\Bigl(\mathbf{J}_\mathbf{g}\mathbf{H}_\mathbf{g}^{-1}\Bigr).
</code>
</p>



<h3>Value</h3>

<p>A list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>AIC</code></td>
<td>
<p>The CL1AIC.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>The CL1BIC.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos <a href="mailto:A.Nikoloulopoulos@uea.ac.uk">A.Nikoloulopoulos@uea.ac.uk</a><br />
</p>


<h3>References</h3>

<p>Gao, X. and Song, P.X.K. (2011).
Composite likelihood EM algorithm with applications to
multivariate hidden Markov model.
<em>Statistica Sinica</em> <b>21</b>, 165&ndash;185.
</p>
<p>Godambe, V. P. (1991)
<em>Estimating Functions</em>.
Oxford: Oxford University Press
</p>
<p>Nikoloulopoulos, A.K., Joe, H. and Chaganty, N.R. (2011)
Weighted scores method for regression models with dependent data.
<em>Biostatistics</em>, <b>12</b>, 653&ndash;665. doi: <a href="https://doi.org/10.1093/biostatistics/kxr005">10.1093/biostatistics/kxr005</a>.
</p>
<p>Nikoloulopoulos, A.K. (2016)
Correlation structure and variable selection in generalized estimating equations via composite likelihood information criteria.
<em>Statistics in Medicine</em>, <b>35</b>, 2377&ndash;2390. doi: <a href="https://doi.org/10.1002/sim.6871">10.1002/sim.6871</a>.
</p>
<p>Nikoloulopoulos, A.K. (2017)
Weighted scores method for longitudinal  ordinal data.
<em>Arxiv e-prints</em>, &lt;arXiv:1510.07376&gt;. <a href="https://arxiv.org/abs/1510.07376">https://arxiv.org/abs/1510.07376</a>.
</p>
<p>Varin, C. and Vidoni, P. (2005).
A note on composite likelihood inference and model selection.
<em>Biometrika</em> <b>92</b>, 519&ndash;528.
</p>
<p>Zhao, Y. and Joe, H. (2005)
Composite likelihood estimation in multivariate data analysis.
<em>The Canadian Journal of Statistics</em>,  <b>33</b>, 335&ndash;356.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+solvewtsc">solvewtsc</a></code>,
<code><a href="#topic+wtsc.wrapper">wtsc.wrapper</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  ################################################################################
  #                           Binary regression 
  ################################################################################
  ################################################################################
  #                      read and set up the data set
  ################################################################################
  data(childvisit)
  # covariates
  season1&lt;-childvisit$q
  season1[season1&gt;1]&lt;-0
  xdat&lt;-cbind(childvisit$sex,childvisit$age,childvisit$m,season1)
  # response
  ydat&lt;-childvisit$hosp
  ydat[ydat&gt;0]=1
  ydat=2-ydat
  #id
  id&lt;-childvisit$id
  #time
  tvec&lt;-childvisit$q
  ################################################################################
  #                      select the link
  ################################################################################
  link="logit"
  ################################################################################
  #                      select the  correlation structure
  ################################################################################
  corstr="exch"
  ################################################################################
  #                      perform CL1 estimation
  ################################################################################
  i.est&lt;-iee.ord(xdat,ydat,link)
  cat("\niest: IEE estimates\n")
  print(c(i.est$reg,i.est$gam))
  est.rho&lt;-cl1.ord(b=i.est$reg,gam=i.est$gam,xdat,ydat,id,tvec,corstr,link)
  cat("\nest.rho: CL1 estimates\n")
  print(est.rho$e)
  cat("\nest.rho: negative CL1 log-likelhood\n")
  print(est.rho$m)
  ################################################################################
  #                      obtain the fixed weight matrices
  ################################################################################
  WtScMat&lt;-weightMat.ord(b=i.est$reg,gam=i.est$gam,rh=0.1961,xdat,ydat,id,
                         tvec,corstr,link)
  ################################################################################
  #                      obtain the CL1 information criteria
  ################################################################################
  out&lt;-clic1dePar(nbcl=est.rho$m,r=est.rho$e,i.est$r,i.est$g,xdat,id,tvec,corstr,WtScMat,link,1)

</code></pre>

<hr>
<h2 id='godambe'>INVERSE GODAMBE MATRIX</h2><span id='topic+godambe'></span><span id='topic+godambe.ord'></span>

<h3>Description</h3>

<p>Inverse Godambe matrix.</p>


<h3>Usage</h3>

<pre><code class='language-R'>godambe(param,WtScMat,xdat,ydat,id,tvec,margmodel,link)
godambe.ord(param,WtScMat,xdat,ydat,id,tvec,link)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="godambe_+3A_param">param</code></td>
<td>
<p>The weighted scores estimates of regression and not regression parameters.</p>
</td></tr>
<tr><td><code id="godambe_+3A_wtscmat">WtScMat</code></td>
<td>
<p>A list containing the following components.
omega: The array with the <code class="reqn">\Omega_i,\,i=1,\ldots,n</code> matrices;
delta: The array with the <code class="reqn">\Delta_i,\,i=1,\ldots,n</code> matrices;
X: The array with the <code class="reqn">X_i,\,i=1,\ldots,n</code> matrices.</p>
</td></tr>
<tr><td><code id="godambe_+3A_xdat">xdat</code></td>
<td>
<p><code class="reqn">(\mathbf{x}_1 ,  \mathbf{x}_2 , \ldots ,
  \mathbf{x}_n )^\top</code>, where the matrix <code class="reqn">\mathbf{x}_i,\,i=1,\ldots,n</code> for a given unit will
depend on the  times of observation for that unit (<code class="reqn">j_i</code>) and will have
number of rows <code class="reqn">j_i</code>, each row corresponding to one of the <code class="reqn">j_i</code> elements
of <code class="reqn">y_i</code> and <code class="reqn">p</code> columns where <code class="reqn">p</code> is the number of covariates including
the unit first column  to account for the intercept  (except for ordinal regression where there is no intercept). This xdat matrix is
of dimension <code class="reqn">(N\times p),</code> where <code class="reqn">N =\sum_{i=1}^n j_i</code> is the total
number of observations from all units.</p>
</td></tr>
<tr><td><code id="godambe_+3A_ydat">ydat</code></td>
<td>
<p><code class="reqn">(y_1 , y_2 , \ldots , y_n  )^\top</code>, where
the response data vectors <code class="reqn">y_i,\,i=1,\ldots,n</code>
are of possibly different lengths for different units.  In particular,
we now have that <code class="reqn">y_i</code> is (<code class="reqn">j_i \times 1</code>), where <code class="reqn">j_i</code> is the   number of
observations on unit <code class="reqn">i</code>. The total number of observations   from all units
is <code class="reqn">N =\sum_{i=1}^n j_i</code>. The ydat are the collection of data   vectors
<code class="reqn">y_i, i = 1,\ldots,n</code> one from each unit which summarize all the data
together in a single, long vector of length <code class="reqn">N</code>.</p>
</td></tr>
<tr><td><code id="godambe_+3A_id">id</code></td>
<td>
<p>An index for individuals or clusters.</p>
</td></tr>
<tr><td><code id="godambe_+3A_tvec">tvec</code></td>
<td>
<p>A vector with the time indicator of individuals or clusters.</p>
</td></tr>
<tr><td><code id="godambe_+3A_margmodel">margmodel</code></td>
<td>

<p>Indicates the marginal model.
Choices are &ldquo;poisson&rdquo; for Poisson, &ldquo;bernoulli&rdquo; for Bernoulli, 
and  &ldquo;nb1&rdquo; , &ldquo;nb2&rdquo; for the NB1 and NB2 parametrization 
of negative binomial in Cameron and Trivedi (1998).</p>
</td></tr>
<tr><td><code id="godambe_+3A_link">link</code></td>
<td>
<p>The link function. 
Choices are &ldquo;log&rdquo; for the log link function, &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the <code class="reqn">W_{i,\rm working}</code> are assumed fixed for the
second stage of solving the weighted scores equations 
</p>
<p style="text-align: center;"><code class="reqn">
 g_1= g_1(a)=\sum_{i=1}^n X_i^T\, W_{i,\rm working}^{-1}\, s_i( a)=0,
</code>
</p>
<p> the asymptotic covariance matrix of the
solution <code class="reqn">\widehat a_1</code> is
</p>
<p style="text-align: center;"><code class="reqn">
  V_1=(-D_{g_1})^{-1}M_{g_1}(-D^T_{g_1})^{-1}
</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">
  -D_{g_1} =\sum_{i=1}^n X_i^T W_{i,\rm working}^{-1}\Delta_i X_i,
</code>
</p>

<p style="text-align: center;"><code class="reqn">
  M_{ g_1} = \sum_{i=1}^n X_i^T W_{i,\rm working}^{-1}
  \Omega_{i,\rm true}( W_{i,\rm working}^{-1})^T X_i,
</code>
</p>

<p>where <code class="reqn">\Omega_{i,\rm true}</code> is the true covariance matrix of <code class="reqn">s_i(a)</code>.
The inverse of <code class="reqn">V_1</code> is known as
Godambe information matrix (Godambe, 1991).
</p>
<p>Note that <code>godambe.ord</code> is a variant of the code for ordinal (probit and logistic) regression.
</p>


<h3>Value</h3>

<p>The inverse Godambe matrix.</p>


<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos <a href="mailto:A.Nikoloulopoulos@uea.ac.uk">A.Nikoloulopoulos@uea.ac.uk</a><br />
Harry Joe <a href="mailto:harry.joe@ubc.ca">harry.joe@ubc.ca</a>
</p>


<h3>References</h3>

<p>Godambe, V. P. (1991)
<em>Estimating Functions</em>.
Oxford: Oxford University Press
</p>
<p>Nikoloulopoulos, A.K., Joe, H. and Chaganty, N.R. (2011)
Weighted scores method for regression models with dependent data.
<em>Biostatistics</em>, <b>12</b>, 653&ndash;665. doi: <a href="https://doi.org/10.1093/biostatistics/kxr005">10.1093/biostatistics/kxr005</a>.
</p>
<p>Nikoloulopoulos, A.K. (2016)
Correlation structure and variable selection in generalized estimating equations via composite likelihood information criteria.
<em>Statistics in Medicine</em>, <b>35</b>, 2377&ndash;2390. doi: <a href="https://doi.org/10.1002/sim.6871">10.1002/sim.6871</a>.
</p>
<p>Nikoloulopoulos, A.K. (2017)
Weighted scores method for longitudinal  ordinal data.
<em>Arxiv e-prints</em>, &lt;arXiv:1510.07376&gt;. <a href="https://arxiv.org/abs/1510.07376">https://arxiv.org/abs/1510.07376</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wtsc">wtsc</a></code>,
<code><a href="#topic+solvewtsc">solvewtsc</a></code>,
<code><a href="#topic+weightMat">weightMat</a></code>,
<code><a href="#topic+wtsc.wrapper">wtsc.wrapper</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>################################################################################
#                           Poisson regression 
################################################################################
################################################################################
#                      read and set up the data set
################################################################################
data(childvisit)
# covariates
season1&lt;-childvisit$q
season1[season1&gt;1]&lt;-0
xdat&lt;-cbind(1,childvisit$sex,childvisit$age,childvisit$m,season1)
# response
ydat&lt;-childvisit$hosp
#id
id&lt;-childvisit$id
#time
tvec&lt;-childvisit$q
################################################################################
#                      select the marginal model
################################################################################
margmodel="poisson"
################################################################################
#                      select the  correlation structure
################################################################################
corstr="exch"
################################################################################
#                      perform CL1 estimation
################################################################################
i.est&lt;-iee(xdat,ydat,margmodel)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
est.rho&lt;-cl1(b=i.est$reg,gam=i.est$gam,xdat,ydat,id,tvec,margmodel,corstr)
cat("\nest.rho: CL1 estimates\n")
print(est.rho$e)
################################################################################
#                      obtain the fixed weight matrices
################################################################################
WtScMat&lt;-weightMat(b=i.est$reg,gam=i.est$gam,rh=est.rho$e,
xdat,ydat,id,tvec,margmodel,corstr)
################################################################################
#                      obtain the weighted scores estimates
################################################################################
# solve the nonlinear system of equations
ws&lt;-solvewtsc(start=c(i.est$reg,i.est$gam),WtScMat,xdat,ydat,id,
tvec,margmodel,link)
cat("ws=parameter estimates\n")
print(ws$r)
################################################################################
#                      obtain the inverse Godambe matrix
################################################################################
acov&lt;-godambe(ws$r,WtScMat,xdat,ydat,id,tvec,margmodel)
cat("\nacov: inverse Godambe matrix with W based on first-stage wt
matrices\n")
print(acov)
################################################################################
#                         Ordinal regression 
################################################################################
################################################################################
#                      read and set up data set
################################################################################

data(arthritis)
nn=nrow(arthritis)
bas2&lt;-bas3&lt;-bas4&lt;-bas5&lt;-rep(0,nn)
bas2[arthritis$b==2]&lt;-1
bas3[arthritis$b==3]&lt;-1
bas4[arthritis$b==4]&lt;-1
bas5[arthritis$b==5]&lt;-1
t2&lt;-t3&lt;-rep(0,nn)
t2[arthritis$ti==3]&lt;-1
t3[arthritis$ti==5]&lt;-1
xdat=cbind(t2,t3,arthritis$trt,bas2,bas3,bas4,bas5,arthritis$age) 
ydat=arthritis$y
id&lt;-arthritis$id
#time
tvec&lt;-arthritis$time
################################################################################
#                      select the link
################################################################################
link="probit"
################################################################################
#                      select the  correlation structure
################################################################################
corstr="exch"
################################################################################
#                      perform CL1 estimation
################################################################################
i.est&lt;-iee.ord(xdat,ydat,link)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
est.rho&lt;-cl1.ord(b=i.est$reg,gam=i.est$gam,xdat,ydat,id,tvec,corstr,link)
cat("\nest.rho: CL1 estimates\n")
print(est.rho$e)
################################################################################
#                      obtain the fixed weight matrices
################################################################################
WtScMat&lt;-weightMat.ord(b=i.est$reg,gam=i.est$gam,rh=est.rho$e,xdat,ydat,id,
tvec,corstr,link)
################################################################################
#                      obtain the weighted scores estimates
################################################################################
# solve the nonlinear system of equations
ws&lt;-solvewtsc.ord(start=c(i.est$reg,i.est$gam),WtScMat,xdat,ydat,id,
tvec,link)
cat("ws=parameter estimates\n")
print(ws$r)
################################################################################
#                      obtain the inverse Godambe matrix
################################################################################
acov&lt;-godambe.ord(ws$r,WtScMat,xdat,ydat,id,tvec,link)
cat("\nacov: inverse Godambe matrix with W based on first-stage wt
matrices\n")
print(acov)

</code></pre>

<hr>
<h2 id='iee'>INDEPENDENT ESTIMATING EQUATIONS FOR BINARY AND COUNT REGRESSION</h2><span id='topic+iee'></span>

<h3>Description</h3>

<p>Independent estimating equations for binary and count regression.</p>


<h3>Usage</h3>

<pre><code class='language-R'>iee(xdat,ydat,margmodel,link) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="iee_+3A_xdat">xdat</code></td>
<td>
<p><code class="reqn">(\mathbf{x}_1 ,  \mathbf{x}_2 , \ldots ,
  \mathbf{x}_n )^\top</code>, where the matrix <code class="reqn">\mathbf{x}_i,\,i=1,\ldots,n</code> for a given unit will
depend on the  times of observation for that unit (<code class="reqn">j_i</code>) and will have
number of rows <code class="reqn">j_i</code>, each row corresponding to one of the <code class="reqn">j_i</code> elements
of <code class="reqn">y_i</code> and <code class="reqn">p</code> columns where <code class="reqn">p</code> is the number of covariates including
the unit first column  to account for the intercept. This xdat matrix is
of dimension <code class="reqn">(N\times p),</code> where <code class="reqn">N =\sum_{i=1}^n j_i</code> is the total
number of observations from all units.</p>
</td></tr>
<tr><td><code id="iee_+3A_ydat">ydat</code></td>
<td>
<p><code class="reqn">(y_1 , y_2 , \ldots , y_n )^\top</code>, where the response 
data vectors <code class="reqn">y_i,\,i=1,\ldots,n</code>
are of possibly different lengths for different units.  In particular,
we now have that <code class="reqn">y_i</code> is (<code class="reqn">j_i \times 1</code>), where <code class="reqn">j_i</code> is the   number of
observations on unit <code class="reqn">i</code>. The total number of observations   from all units
is <code class="reqn">N =\sum_{i=1}^n j_i</code>. The ydat are the collection of data   vectors
<code class="reqn">y_i, i = 1,\ldots,n</code> one from each unit which summarize all the data
together in a single, long vector of length <code class="reqn">N</code>.</p>
</td></tr>
<tr><td><code id="iee_+3A_margmodel">margmodel</code></td>
<td>

<p>Indicates the marginal model.
Choices are &ldquo;poisson&rdquo; for Poisson, &ldquo;bernoulli&rdquo; for Bernoulli, 
and  &ldquo;nb1&rdquo; , &ldquo;nb2&rdquo; for the NB1 and NB2 parametrization 
of negative binomial in Cameron and Trivedi (1998).</p>
</td></tr>
<tr><td><code id="iee_+3A_link">link</code></td>
<td>
<p>The link function.
Choices are &ldquo;log&rdquo; for the log link function, &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The univariate parameters  are
estimated from the sum of univariate marginal log-likelihoods.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>coef</code></td>
<td>
<p>The vector with the estimated regression parameters.</p>
</td></tr>
<tr><td><code>gam</code></td>
<td>
<p>The vector with the estimated parameters that  are not regression parameters. This is NULL for Poisson and binary regression.</p>
</td></tr> </table>


<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos <a href="mailto:A.Nikoloulopoulos@uea.ac.uk">A.Nikoloulopoulos@uea.ac.uk</a><br />
Harry Joe <a href="mailto:harry.joe@ubc.ca">harry.joe@ubc.ca</a>
</p>


<h3>References</h3>

<p>Cameron, A. C. and Trivedi, P. K. (1998)
<em>Regression Analysis of Count Data.</em>
Cambridge: Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+marglik">marglik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
################################################################################
#                      read and set up data set
################################################################################
data(toenail)
# covariates
xdat&lt;-cbind(1,toenail$treat,toenail$time,toenail$treat*toenail$time)
# response
ydat&lt;-toenail$y
#id
id&lt;-toenail$id
#time
tvec&lt;-toenail$time
################################################################################
#                      select the marginal model
################################################################################
margmodel="bernoulli"
################################################################################
#                      perform the IEE method
################################################################################
i.est&lt;-iee(xdat,ydat,margmodel)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
</code></pre>

<hr>
<h2 id='iee.ord'>
Maximum Likelihood for Ordinal Model 
</h2><span id='topic+iee.ord'></span>

<h3>Description</h3>

<p>Maximum Likelihood for Ordinal Probit and Logit: 
Newton-Raphson minimization of negative log-likelihood. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iee.ord(x,y,link,iprint=0,maxiter=20,toler=1.e-6)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="iee.ord_+3A_x">x</code></td>
<td>

<p>vector or matrix of explanatory variables. Each row corresponds
to an observation and each column to a variable.  The number of rows of x
should equal the number of data values in y, and there should be fewer 
columns than rows.  Missing values are not allowed.
</p>
</td></tr>
<tr><td><code id="iee.ord_+3A_y">y</code></td>
<td>

<p>numeric vector containing the ordinal response. 
The values must be in the range 1,2,..., number of categories.
Missing values are not allowed. 
</p>
</td></tr>
<tr><td><code id="iee.ord_+3A_link">link</code></td>
<td>
<p>The link function.Choices are  &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function.</p>
</td></tr>
<tr><td><code id="iee.ord_+3A_iprint">iprint</code></td>
<td>

<p>logical indicator, default is FALSE, for whether the iterations for 
numerical maximum likelihood should be printed.
</p>
</td></tr>
<tr><td><code id="iee.ord_+3A_maxiter">maxiter</code></td>
<td>

<p>maximum number of Newton-Raphson iterations, default = 20.
</p>
</td></tr>
<tr><td><code id="iee.ord_+3A_toler">toler</code></td>
<td>

<p>tolerance for convergence in Newton-Raphson iterations, default = 1.e-6.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ordinal probit model is similar to the ordinal logit model.
The parameter estimate of ordinal logit are roughly 1.8 to 2 times
those of ordinal probit. 
</p>


<h3>Value</h3>

<p>list of MLE of parameters and their associated standard 
errors, in the order cutpt1,...,cutpt(number of categ-1),b1,...b(number of covariates).
</p>
<table role = "presentation">
<tr><td><code>negloglik</code></td>
<td>

<p>value of negative log-likelihood, evaluated at MLE
</p>
</td></tr>
<tr><td><code>gam</code></td>
<td>

<p>MLE of ordered cutpoint parameters
</p>
</td></tr>
<tr><td><code>reg</code></td>
<td>

<p>MLE of regression parameters
</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>

<p>estimated covariance matrix of the parameters
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos <a href="mailto:A.Nikoloulopoulos@uea.ac.uk">A.Nikoloulopoulos@uea.ac.uk</a><br />
Harry Joe <a href="mailto:harry.joe@ubc.ca">harry.joe@ubc.ca</a>
</p>


<h3>References</h3>

<p>Anderson, J.A. and Pemberton, J.D. (1985). The grouped continuous model for
multivariate ordered categorical variables and covariate adjustment.  
<em>Biometrics</em>,  <b>41</b>, 875&ndash;885.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ################################################################################
  #                         Ordinal regression 
  ################################################################################
  ################################################################################
  #                      read and set up data set
  ################################################################################
  data(arthritis)
  nn=nrow(arthritis)
  bas2&lt;-bas3&lt;-bas4&lt;-bas5&lt;-rep(0,nn)
  bas2[arthritis$b==2]&lt;-1
  bas3[arthritis$b==3]&lt;-1
  bas4[arthritis$b==4]&lt;-1
  bas5[arthritis$b==5]&lt;-1
  t2&lt;-t3&lt;-rep(0,nn)
  t2[arthritis$ti==3]&lt;-1
  t3[arthritis$ti==5]&lt;-1
  xdat=cbind(t2,t3,arthritis$trt,bas2,bas3,bas4,bas5,arthritis$age) 
  ydat=arthritis$y
  ################################################################################
  #                      select the link
  ################################################################################
  link="probit"
  ################################################################################
  i.est&lt;- iee.ord(xdat,ydat,link)
  print(i.est)
</code></pre>

<hr>
<h2 id='marglik'>NEGATIVE LOG-LIKELIHOOD ASSUMING INDEPEDENCE WITHIN CLUSTERS</h2><span id='topic+marglik'></span>

<h3>Description</h3>

<p>Negative log-likelihood assuming independence within clusters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>marglik(param,xdat,ydat,margmodel,link)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="marglik_+3A_param">param</code></td>
<td>
<p>The vector of regression and not regression parameters.</p>
</td></tr>
<tr><td><code id="marglik_+3A_xdat">xdat</code></td>
<td>
<p><code class="reqn">(\mathbf{x}_1 ,  \mathbf{x}_2 , \ldots ,
  \mathbf{x}_n )^\top</code>, where the matrix <code class="reqn">\mathbf{x}_i,\,i=1,\ldots,n</code> for a given unit will
depend on the  times of observation for that unit (<code class="reqn">j_i</code>) and will have
number of rows <code class="reqn">j_i</code>, each row corresponding to one of the <code class="reqn">j_i</code> elements
of <code class="reqn">y_i</code> and <code class="reqn">p</code> columns where <code class="reqn">p</code> is the number of covariates including
the unit first column  to account for the intercept. This xdat matrix is
of dimension <code class="reqn">(N\times p),</code> where <code class="reqn">N =\sum_{i=1}^n j_i</code> is the total
number of observations from all units.</p>
</td></tr>
<tr><td><code id="marglik_+3A_ydat">ydat</code></td>
<td>
<p><code class="reqn">(y_1 , y_2 , \ldots , y_n  )^\top</code>,
where the response data vectors <code class="reqn">y_i,\,i=1,\ldots,n</code>
are of possibly different lengths for different units.  In particular,
we now have that <code class="reqn">y_i</code> is (<code class="reqn">j_i \times 1</code>), where <code class="reqn">j_i</code> is the   number of
observations on unit <code class="reqn">i</code>. The total number of observations   from all units
is <code class="reqn">N =\sum_{i=1}^n j_i</code>. The ydat are the collection of data   vectors
<code class="reqn">y_i, i = 1,\ldots,n</code> one from each unit which summarize all the data
together in a single, long vector of length <code class="reqn">N</code>.</p>
</td></tr>
<tr><td><code id="marglik_+3A_margmodel">margmodel</code></td>
<td>

<p>Indicates the marginal model.
Choices are &ldquo;poisson&rdquo; for Poisson, &ldquo;bernoulli&rdquo; for Bernoulli, 
and  &ldquo;nb1&rdquo; , &ldquo;nb2&rdquo; for the NB1 and NB2 parametrization 
of negative binomial in Cameron and Trivedi (1998).</p>
</td></tr>
<tr><td><code id="marglik_+3A_link">link</code></td>
<td>
<p>The link function.
Choices are &ldquo;log&rdquo; for the log link function, &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The negative sum of univariate marginal log-likelihoods.</p>


<h3>Value</h3>

<p>Minus log-likelihood assuming independence.</p>


<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos <a href="mailto:A.Nikoloulopoulos@uea.ac.uk">A.Nikoloulopoulos@uea.ac.uk</a><br />
Harry Joe <a href="mailto:harry.joe@ubc.ca">harry.joe@ubc.ca</a>
</p>


<h3>References</h3>

<p>Cameron, A. C. and Trivedi, P. K. (1998)
<em>Regression Analysis of Count Data.</em>
Cambridge: Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+iee">iee</a></code>
</p>

<hr>
<h2 id='margmodel'>DENSITY AND CDF OF THE UNIVARIATE MARGINAL DISTRIBUTION</h2><span id='topic+margmodel.ord'></span><span id='topic+dmargmodel'></span><span id='topic+pmargmodel'></span><span id='topic+dmargmodel.ord'></span><span id='topic+pmargmodel.ord'></span>

<h3>Description</h3>

<p>Density and cdf of the univariate marginal distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmargmodel(y,mu,gam,invgam,margmodel)
pmargmodel(y,mu,gam,invgam,margmodel)
dmargmodel.ord(y,mu,gam,link)
pmargmodel.ord(y,mu,gam,link)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="margmodel_+3A_y">y</code></td>
<td>
<p>Vector of (non-negative integer) quantiles.</p>
</td></tr>
<tr><td><code id="margmodel_+3A_mu">mu</code></td>
<td>
<p>The parameter <code class="reqn">\mu</code> of the univariate distribution.</p>
</td></tr>
<tr><td><code id="margmodel_+3A_gam">gam</code></td>
<td>
<p>The parameter(s) <code class="reqn">\gamma</code> that are not regression parameters. <code class="reqn">\gamma</code> is NULL for Poisson and Bernoulli distribution.</p>
</td></tr>
<tr><td><code id="margmodel_+3A_invgam">invgam</code></td>
<td>
<p>The  inverse of parameter <code class="reqn">\gamma</code> of negative binomial
distribution.</p>
</td></tr>
<tr><td><code id="margmodel_+3A_margmodel">margmodel</code></td>
<td>

<p>Indicates the marginal model.
Choices are &ldquo;poisson&rdquo; for Poisson, &ldquo;bernoulli&rdquo; for Bernoulli, 
and  &ldquo;nb1&rdquo; , &ldquo;nb2&rdquo; for the NB1 and NB2 parametrization 
of negative binomial in Cameron and Trivedi (1998). See details.</p>
</td></tr>
<tr><td><code id="margmodel_+3A_link">link</code></td>
<td>
<p>The link function. 
Choices are  &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Negative binomial distribution
NB<code class="reqn">(\tau,\xi)</code> allows for overdispersion
and its probability mass function (pmf) is  given by
</p>
<p style="text-align: center;"><code class="reqn"> f(y;\tau,\xi)=\frac{\Gamma(\tau+y)}{\Gamma(\tau)\; y!}
  \frac{\xi^y}{(1+\xi)^{\tau + y}},\quad \begin{matrix} y=0,1,2,\ldots, \\
                                          \tau&gt;0,\; \xi&gt;0,\end{matrix}  </code>
</p>

<p>with mean <code class="reqn">\mu=\tau\,\xi=\exp(\beta^T x)</code> and variance <code class="reqn">\tau\,\xi\,(1+\xi)</code>.
</p>
<p>Cameron and Trivedi (1998) present the NBk parametrization where
<code class="reqn">\tau=\mu^{2-k}\gamma^{-1}</code> and <code class="reqn">\xi=\mu^{k-1}\gamma</code>, <code class="reqn">1\le k\le 2</code>.
In this function we use the NB1 parametrization
<code class="reqn">(\tau=\mu\gamma^{-1},\; \xi=\gamma)</code>, and the NB2 parametrization
<code class="reqn">(\tau=\gamma^{-1},\; \xi=\mu\gamma)</code>; the latter
is the same as in Lawless (1987).
</p>
<p><code>margmodel.ord</code> is a variant of the code for ordinal (probit and logistic) model. In this case, the response <code class="reqn">Y</code> is assumed to have density
</p>
<p style="text-align: center;"><code class="reqn">f_1(y;\nu,\gamma)=F(\alpha_{y}+\nu)-F(\alpha_{y-1}+\nu),</code>
</p>

<p>where <code class="reqn">\nu=x\beta</code> is a function of <code class="reqn">x</code>
and the <code class="reqn">p</code>-dimensional regression vector <code class="reqn">\beta</code>, and <code class="reqn">\gamma=(\alpha_1,\ldots,\alpha_{K-1})</code> is the $q$-dimensional vector of the univariate cutpoints (<code class="reqn">q=K-1</code>). Note that <code class="reqn">F</code> normal leads to the probit model and <code class="reqn">F</code> logistic
leads to the cumulative logit model for ordinal response.
</p>


<h3>Value</h3>

<p>The density and cdf of the univariate distribution.</p>


<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos <a href="mailto:A.Nikoloulopoulos@uea.ac.uk">A.Nikoloulopoulos@uea.ac.uk</a><br />
Harry Joe <a href="mailto:harry.joe@ubc.ca">harry.joe@ubc.ca</a>
</p>


<h3>References</h3>

<p>Cameron, A. C. and Trivedi, P. K. (1998)
<em>Regression Analysis of Count Data.</em>
Cambridge: Cambridge University Press.
</p>
<p>Lawless, J. F. (1987)
Negative binomial and mixed Poisson regression.
<em>The Canadian Journal
of Statistics</em>, <b>15</b>, 209&ndash;225.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>y&lt;-3
gam&lt;-2.5
invgam&lt;-1/2.5
mu&lt;-0.5
margmodel&lt;-"nb2"
dmargmodel(y,mu,gam,invgam,margmodel)
pmargmodel(y,mu,gam,invgam,margmodel)
link="probit"
dmargmodel.ord(y,mu,gam,link)
pmargmodel.ord(y,mu,gam,link)

</code></pre>

<hr>
<h2 id='mvn.deriv'>
Derivatives of Multivariate Normal Rectangle Probabilities
</h2><span id='topic+mvn.deriv'></span><span id='topic+mvn.deriv.margin'></span><span id='topic+mvn.deriv.rho'></span>

<h3>Description</h3>

<p>Derivatives of Multivariate Normal Rectangle Probabilities based on
Approximations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvn.deriv.margin(lb,ub,mu,sigma,k,ksign,type=1,eps=1.e-05,nsim=0)
mvn.deriv.rho(lb,ub,mu,sigma,j1,k1,type=1,eps=1.e-05,nsim=0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mvn.deriv_+3A_lb">lb</code></td>
<td>

<p>vector of lower limits of integral/probability 
</p>
</td></tr>
<tr><td><code id="mvn.deriv_+3A_ub">ub</code></td>
<td>

<p>vector of upper limits of integral/probability
</p>
</td></tr>
<tr><td><code id="mvn.deriv_+3A_mu">mu</code></td>
<td>

<p>mean vector 
</p>
</td></tr>
<tr><td><code id="mvn.deriv_+3A_sigma">sigma</code></td>
<td>

<p>covariance matrix, it is assumed to be positive-definite
</p>
</td></tr>
<tr><td><code id="mvn.deriv_+3A_type">type</code></td>
<td>

<p>indicator, type=1 refers to the first order approximation, 
type=2 is the second order approximation. 
</p>
</td></tr>
<tr><td><code id="mvn.deriv_+3A_eps">eps</code></td>
<td>

<p>accuracy/tolerance for bivariate marginal rectangle probabilities
</p>
</td></tr> 
<tr><td><code id="mvn.deriv_+3A_nsim">nsim</code></td>
<td>

<p>an optional integer if random permutations are used in the approximation
for dimension &gt;=6; nsim=2000 recommended for dim&gt;=6
</p>
</td></tr> 
<tr><td><code id="mvn.deriv_+3A_k">k</code></td>
<td>

<p>margin for which derivative is to be taken, that is,
deriv of mvnapp(lb,ub,mu,sigma) with respect to lb[k] or ub[k];
</p>
</td></tr>
<tr><td><code id="mvn.deriv_+3A_ksign">ksign</code></td>
<td>

<p>=-1 for deriv of mvnapp(lb,ub,mu,sigma) with respect to lb[k]
=+1 for deriv of mvnapp(lb,ub,mu,sigma) with respect to ub[k]
</p>
</td></tr>
<tr><td><code id="mvn.deriv_+3A_j1">j1</code></td>
<td>

<p>correlation for which derivative is to be taken, that is,
deriv of mvnapp(lb,ub,mu,sigma) with respect to rho[j1,k1],
where rho is a correlation corresponding to sigma
</p>
</td></tr>
<tr><td><code id="mvn.deriv_+3A_k1">k1</code></td>
<td>

<p>See above explanation with j1
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>derivative with respect to margin lb[k], ub[k], or correlation rho[j1][k1]
corresponding to sigmamatrix
</p>


<h3>Author(s)</h3>

<p>Harry Joe <a href="mailto:harry.joe@ubc.ca">harry.joe@ubc.ca</a>
</p>


<h3>References</h3>

<p>Joe, H (1995). Approximations to multivariate  normal rectangle
probabilities based on conditional expectations.  <em>Journal of American Statistical
Association</em>, <b>90</b>, 957&ndash;964.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mvnapp">mvnapp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># step size for numerical derivatives (accuracy of mvnapp etc may be about 1.e-4 to 1.e-5)
heps = 1.e-3

cat("compare numerical and analytical derivatives based on mvnapp\n")

cat("\ncase 1: dim=3\n");
m=3
mu=rep(0,m)
a=c(0,0,0)
b=c(1,1.5,2)
rr=matrix(c(1,.3,.3,.3,1,.4,.3,.4,1),m,m)
pr=mvnapp(a,b,mu,rr)$pr
# not checking ifail returned from mvnapp
cat("pr=mvnapp(avec,bvec,mu=0,sigma=corrmat)=",pr,"\n")

cat("derivative wrt a_k,b_k, k=1,...,",m,"\n")
for(k in 1:m)
{ cat("  k=", k, " lower\n")
  a2=a
  a2[k]=a[k]+heps
  pr2=mvnapp(a2,b,mu,rr)$pr
  da.numerical = (pr2-pr)/heps 
  da.analytic= mvn.deriv.margin(a,b,mu,rr,k,-1)$deriv
  cat("   numerical: ", da.numerical, ", analytic: ", da.analytic,"\n")
  cat("  k=", k, " upper\n")
  b2=b
  b2[k]=b[k]+heps
  pr2=mvnapp(a,b2,mu,rr)$pr
  db.numerical = (pr2-pr)/heps 
  db.analytic= mvn.deriv.margin(a,b,mu,rr,k,1)$deriv
  cat("   numerical: ", db.numerical, ", analytic: ", db.analytic,"\n")
}

cat("derivative wrt rho(j,k)\n")
for(j in 1:(m-1))
{ for(k in (j+1):m)
  { cat("  (j,k)=", j,k,"\n")
    rr2=rr
    rr2[j,k]=rr[j,k]+heps
    rr2[k,j]=rr[k,j]+heps
    pr2=mvnapp(a,b,mu,rr2)$pr
    drh.numerical = (pr2-pr)/heps 
    drh.analytic= mvn.deriv.rho(a,b,mu,rr2,j,k)$deriv
    cat("   numerical: ", drh.numerical, ", analytic: ", drh.analytic,"\n")
  }
}

#=============================================

cat("\ncase 2: dim=5\n");
m=5
mu=rep(0,m)
a=c(0,0,0,-1,-1)
b=c(1,1.5,2,2,2)
rr=matrix(c(1,.3,.3,.3,.4, .3,1,.4,.4,.4,  .3,.4,1,.4,.4,
  .3,.4,.4,1,.4, .4,.4,.4,.4,1),m,m)
pr=mvnapp(a,b,mu,rr)$pr
# not checking ifail returned from mvnapp
cat("pr=mvnapp(avec,bvec,mu=0,sigma=corrmat)=",pr,"\n")

cat("derivative wrt a_k,b_k, k=1,...,",m,"\n")
for(k in 1:m)
{ cat("  k=", k, " lower\n")
  a2=a
  a2[k]=a[k]+heps
  pr2=mvnapp(a2,b,mu,rr)$pr
  da.numerical = (pr2-pr)/heps 
  da.analytic= mvn.deriv.margin(a,b,mu,rr,k,-1)$deriv
  cat("   numerical: ", da.numerical, ", analytic: ", da.analytic,"\n")
  cat("  k=", k, " upper\n")
  b2=b
  b2[k]=b[k]+heps
  pr2=mvnapp(a,b2,mu,rr)$pr
  db.numerical = (pr2-pr)/heps 
  db.analytic= mvn.deriv.margin(a,b,mu,rr,k,1)$deriv
  cat("   numerical: ", db.numerical, ", analytic: ", db.analytic,"\n")
}


cat("derivative wrt rho(j,k): first order approx\n")
for(j in 1:(m-1))
{ for(k in (j+1):m)
  { cat("  (j,k)=", j,k,"\n")
    rr2=rr
    rr2[j,k]=rr[j,k]+heps
    rr2[k,j]=rr[k,j]+heps
    pr2=mvnapp(a,b,mu,rr2)$pr
    drh.numerical = (pr2-pr)/heps 
    drh.analytic= mvn.deriv.rho(a,b,mu,rr2,j,k)$deriv
    cat("   numerical: ", drh.numerical, ", analytic: ", drh.analytic,"\n")
  }
}

cat("\nsecond order approx\n")
pr=mvnapp(a,b,mu,rr,type=2)$pr
cat("pr=mvnapp(avec,bvec,mu=0,sigma=corrmat,type=2)=",pr,"\n")

cat("derivative wrt a_k,b_k, k=1,...,",m,"\n")
for(k in 1:m)
{ cat("  k=", k, " lower\n")
  a2=a
  a2[k]=a[k]+heps
  pr2=mvnapp(a2,b,mu,rr,type=2)$pr
  da.numerical = (pr2-pr)/heps 
  da.analytic= mvn.deriv.margin(a,b,mu,rr,k,-1,type=2)$deriv
  cat("   numerical: ", da.numerical, ", analytic: ", da.analytic,"\n")
  cat("  k=", k, " upper\n")
  b2=b
  b2[k]=b[k]+heps
  pr2=mvnapp(a,b2,mu,rr,type=2)$pr
  db.numerical = (pr2-pr)/heps 
  db.analytic= mvn.deriv.margin(a,b,mu,rr,k,1,type=2)$deriv
  cat("   numerical: ", db.numerical, ", analytic: ", db.analytic,"\n")
}

cat("derivative wrt rho(j,k): second order approx\n")
for(j in 1:(m-1))
{ for(k in (j+1):m)
  { cat("  (j,k)=", j,k,"\n")
    rr2=rr
    rr2[j,k]=rr[j,k]+heps
    rr2[k,j]=rr[k,j]+heps
    pr2=mvnapp(a,b,mu,rr2,type=2)$pr
    drh.numerical = (pr2-pr)/heps 
    drh.analytic= mvn.deriv.rho(a,b,mu,rr2,j,k,type=2)$deriv
    cat("   numerical: ", drh.numerical, ", analytic: ", drh.analytic,"\n")
  }
}
</code></pre>

<hr>
<h2 id='mvnapp'>
MVN Rectangle Probabilities
</h2><span id='topic+mvnapp'></span>

<h3>Description</h3>

<p>Approximation to multivariate normal rectangle probabilities using methods in Joe
(1995, JASA)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvnapp(lb,ub,mu,sigma,type=1,eps=1.e-05,nsim=0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mvnapp_+3A_lb">lb</code></td>
<td>

<p>vector of lower limits of integral/probability
</p>
</td></tr>
<tr><td><code id="mvnapp_+3A_ub">ub</code></td>
<td>

<p>vector of upper limits of integral/probability
</p>
</td></tr>
<tr><td><code id="mvnapp_+3A_mu">mu</code></td>
<td>

<p>mean vector
</p>
</td></tr>
<tr><td><code id="mvnapp_+3A_sigma">sigma</code></td>
<td>

<p>covariance matrix, it is assumed to be positive-definite
</p>
</td></tr>
<tr><td><code id="mvnapp_+3A_type">type</code></td>
<td>

<p>indicator, type=1 refers to the first order approximation, 
type=2 is the second order approximation.
</p>
</td></tr>
<tr><td><code id="mvnapp_+3A_eps">eps</code></td>
<td>

<p>accuracy/tolerance for bivariate marginal rectangle probabilities
</p>
</td></tr> 
<tr><td><code id="mvnapp_+3A_nsim">nsim</code></td>
<td>

<p>an optional integer if random permutations are used in the approximation
for dimension &gt;=6; nsim=2000 recommended for dim&gt;=6
</p>
</td></tr> 
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>prob</code></td>
<td>

<p>rectangle probability with approximation
</p>
</td></tr>
<tr><td><code>esterr</code></td>
<td>

<p>indicator of accuracy in the approximation
</p>
</td></tr>
<tr><td><code>ifail</code></td>
<td>

<p>= 0 if no problems
</p>
<p>&gt;= 1 if problems from using Schervish's code in dimensions 2 to 4.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Harry Joe <a href="mailto:harry.joe@ubc.ca">harry.joe@ubc.ca</a>
</p>


<h3>References</h3>

<p>Joe, H (1995). Approximations to multivariate  normal rectangle
probabilities based on conditional expectations.  <em>Journal of American Statistical
Association</em>, <b>90</b>, 957&ndash;964.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-2
rh&lt;-0.5
a&lt;-c(-1,-1)
b&lt;-c(1,1)
mu&lt;-rep(0,m)
s&lt;-matrix(c(1,rh,rh,1),2,2)
print(mvnapp(a,b,mu,s))
print(mvnapp(a,b,mu,s,type=2))
print(mvnapp(a,b,mu,s,type=2,nsim=3))

m&lt;-3
rh&lt;-0.3
a&lt;-c(-1,-1,-2)
b&lt;-c(1,1,.5)
mu&lt;-rep(0,m)
s&lt;-matrix(c(1,.5,.6,.5,1,.7,.6,.7,1),3,3)
print(mvnapp(a,b,mu,s))
print(mvnapp(a,b,mu,s,type=2))
print(mvnapp(a,b,mu,s,type=2,nsim=3))

m&lt;-4
rh&lt;- -0.1
a&lt;-c(-1,-2.5,-2,-1.5)
b&lt;-c(1.68,1.11,.5,.25)
mu&lt;-rep(0,m)
s&lt;-matrix(c(1,.5,.3,.4,.5,1,.5,.4,.3,.5,1,.4,.4,.4,.4,1),m,m)
print(mvnapp(a,b,mu,s))
print(mvnapp(a,b,mu,s,type=2))
print(mvnapp(a,b,mu,s,type=2,nsim=3))

m&lt;-5
rh&lt;-.4
a&lt;-rep(-1,m)
b&lt;-rep(2,m)
mu&lt;-rep(0,m)
s&lt;-matrix(c(1,rh,rh,rh,rh,rh,1,rh,rh,rh,rh,rh,1,rh,rh,rh,rh,rh,1,
       rh,rh,rh,rh,rh,1),m,m)
print(mvnapp(a,b,mu,s))
print(mvnapp(a,b,mu,s,type=2))
print(mvnapp(a,b,mu,s,type=2,nsim=3))

m&lt;-6
a&lt;-c(-1,-1,-1,-1.5,-1,-2)
b&lt;-rep(7,m)
mu&lt;-rep(0,m)
s&lt;-matrix(c(1,rh,rh,rh,rh,rh,rh,1,rh,rh,rh,rh,rh,rh,1,rh,rh,rh,rh,rh,rh,1,
       rh,rh,rh,rh,rh,rh,1,rh,rh,rh,rh,rh,rh,1),m,m)
print(mvnapp(a,b,mu,s))
print(mvnapp(a,b,mu,s,type=2))
print(mvnapp(a,b,mu,s,type=2,nsim=3))
</code></pre>

<hr>
<h2 id='scoreCov'>COVARIANCE MATRIX OF THE UNIVARIATE SCORES</h2><span id='topic+scoreCov'></span><span id='topic+scoreCov.ord'></span>

<h3>Description</h3>

<p>Covariance matrix of the univariates scores.</p>


<h3>Usage</h3>

<pre><code class='language-R'>scoreCov(scnu,scgam,pmf,index,margmodel)
scoreCov.ord(scgam,pmf,index)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scoreCov_+3A_scnu">scnu</code></td>
<td>
<p>The matrix of the score functions with respect to <code class="reqn">\nu</code>.</p>
</td></tr>
<tr><td><code id="scoreCov_+3A_scgam">scgam</code></td>
<td>
<p>The matrix of the score functions with respect to <code class="reqn">\gamma</code>.</p>
</td></tr>
<tr><td><code id="scoreCov_+3A_pmf">pmf</code></td>
<td>
<p>The matrix of rectangle probabilities.</p>
</td></tr>
<tr><td><code id="scoreCov_+3A_index">index</code></td>
<td>
<p>The bivariate pair.</p>
</td></tr>
<tr><td><code id="scoreCov_+3A_margmodel">margmodel</code></td>
<td>

<p>Indicates the marginal model.
Choices are &ldquo;poisson&rdquo; for Poisson, &ldquo;bernoulli&rdquo; for Bernoulli, 
and  &ldquo;nb1&rdquo; , &ldquo;nb2&rdquo; for the NB1 and NB2 parametrization 
of negative binomial in Cameron and Trivedi (1998).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The covariance matrix <code class="reqn">\Omega_i</code> of <code class="reqn"> s_i(a)</code> computed from the
fitted discretized MVN model with estimated parameters <code class="reqn">{\tilde a},
{\tilde R}</code>.
</p>
<p>Note that <code>scoreCov.ord</code> is a variant of the code for ordinal (probit and logistic) regression.
</p>


<h3>Value</h3>

<p>Covariance matrix of the univariates scores <code class="reqn">\Omega_i</code>.</p>


<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos <a href="mailto:A.Nikoloulopoulos@uea.ac.uk">A.Nikoloulopoulos@uea.ac.uk</a><br />
Harry Joe <a href="mailto:harry.joe@ubc.ca">harry.joe@ubc.ca</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+approxbvncdf">approxbvncdf</a></code>
</p>

<hr>
<h2 id='solvewtsc'>SOLVING THE WEIGHTED SCORES EQUATIONS WITH INPUTS OF THE WEIGHT MATRICES AND THE DATA</h2><span id='topic+solvewtsc'></span><span id='topic+solvewtsc.ord'></span>

<h3>Description</h3>

<p>Solving the weighted scores equations with inputs of the weight matrices
and the data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>solvewtsc(start,WtScMat,xdat,ydat,id,tvec,margmodel,link)
solvewtsc.ord(start,WtScMat,xdat,ydat,id,tvec,link)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="solvewtsc_+3A_start">start</code></td>
<td>
<p>A starting value of the vector of regression
and not regression parameters. The CL1 estimates of regression and not regression parameters 
is a good starting value.</p>
</td></tr>
<tr><td><code id="solvewtsc_+3A_wtscmat">WtScMat</code></td>
<td>
<p>A list containing the following components.
omega: The array with the <code class="reqn">\Omega_i,\,i=1,\ldots,n</code> matrices;
delta: The array with the <code class="reqn">\Delta_i,\,i=1,\ldots,n</code> matrices;
X: The array with the <code class="reqn">X_i,\,i=1,\ldots,n</code> matrices.</p>
</td></tr>
<tr><td><code id="solvewtsc_+3A_xdat">xdat</code></td>
<td>
<p><code class="reqn">(\mathbf{x}_1 ,  \mathbf{x}_2 , \ldots ,
  \mathbf{x}_n )^\top</code>, where the matrix <code class="reqn">\mathbf{x}_i,\,i=1,\ldots,n</code> for a given unit will
depend on the  times of observation for that unit (<code class="reqn">j_i</code>) and will have
number of rows <code class="reqn">j_i</code>, each row corresponding to one of the <code class="reqn">j_i</code> elements
of <code class="reqn">y_i</code> and <code class="reqn">p</code> columns where <code class="reqn">p</code> is the number of covariates including
the unit first column  to account for the intercept (except for ordinal regression where there is no intercept). This xdat matrix is
of dimension <code class="reqn">(N\times p),</code> where <code class="reqn">N =\sum_{i=1}^n j_i</code> is the total
number of observations from all units.</p>
</td></tr>
<tr><td><code id="solvewtsc_+3A_ydat">ydat</code></td>
<td>
<p><code class="reqn">(y_1 , y_2 , \ldots , y_n  )^\top</code>, where
the response data vectors <code class="reqn">y_i,\,i=1,\ldots,n</code>
are of possibly different lengths for different units.  In particular,
we now have that <code class="reqn">y_i</code> is (<code class="reqn">j_i \times 1</code>), where <code class="reqn">j_i</code> is the   number of
observations on unit <code class="reqn">i</code>. The total number of observations   from all units
is <code class="reqn">N =\sum_{i=1}^n j_i</code>. The ydat are the collection of data   vectors
<code class="reqn">y_i, i = 1,\ldots,n</code> one from each unit which summarize all the data
together in a single, long vector of length <code class="reqn">N</code>.</p>
</td></tr>
<tr><td><code id="solvewtsc_+3A_id">id</code></td>
<td>
<p>An index for individuals or clusters.</p>
</td></tr>
<tr><td><code id="solvewtsc_+3A_tvec">tvec</code></td>
<td>
<p>A vector with the time indicator of individuals or clusters.</p>
</td></tr>
<tr><td><code id="solvewtsc_+3A_margmodel">margmodel</code></td>
<td>

<p>Indicates the marginal model.
Choices are &ldquo;poisson&rdquo; for Poisson, &ldquo;bernoulli&rdquo; for Bernoulli, 
and  &ldquo;nb1&rdquo; , &ldquo;nb2&rdquo; for the NB1 and NB2 parametrization 
of negative binomial in Cameron and Trivedi (1998).</p>
</td></tr>
<tr><td><code id="solvewtsc_+3A_link">link</code></td>
<td>
<p>The link function. 
Choices are &ldquo;log&rdquo; for the log link function, &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Obtain robust estimates <code class="reqn">{\hat a}</code> of the univariate parameters
solving the weighted scores equation,
<code class="reqn">
  g_1= g_1(a)=\sum_{i=1}^n X_i^T\, W_{i,\rm working}^{-1}\, s_i( a)=0,
</code>
where <code class="reqn"> W_{i,\rm working}^{-1}=\Delta_i\Omega_{i,\rm working}^{-1}=
\Delta_i({\tilde a})\Omega_i({\tilde a},{\tilde R})^{-1}</code> is based on
the covariance matrix of <code class="reqn">s_i(a)</code> computed from the
fitted discretized MVN model with estimated parameters <code class="reqn">{\tilde a}, {\tilde
R}</code>.  A reliable non-linear system solver is used.
</p>
<p>Note that <code>solvewtsc.ord</code> is a variant of the code for ordinal (probit and logistic) regression.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>root</code></td>
<td>
<p>The weighted scores estimates.</p>
</td></tr>
<tr><td><code>f.root</code></td>
<td>
<p>The value of the wtsc function evaluated at the root.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>The number of iterations used.</p>
</td></tr>
<tr><td><code>estim.precis</code></td>
<td>
<p>The estimated precision for root.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos <a href="mailto:A.Nikoloulopoulos@uea.ac.uk">A.Nikoloulopoulos@uea.ac.uk</a><br />
Harry Joe <a href="mailto:harry.joe@ubc.ca">harry.joe@ubc.ca</a>
</p>


<h3>References</h3>

<p>Nikoloulopoulos, A.K., Joe, H. and Chaganty, N.R. (2011)
Weighted scores method for regression models with dependent data.
<em>Biostatistics</em>, <b>12</b>, 653&ndash;665. doi: <a href="https://doi.org/10.1093/biostatistics/kxr005">10.1093/biostatistics/kxr005</a>.
</p>
<p>Nikoloulopoulos, A.K. (2016)
Correlation structure and variable selection in generalized estimating equations via composite likelihood information criteria.
<em>Statistics in Medicine</em>, <b>35</b>, 2377&ndash;2390. doi: <a href="https://doi.org/10.1002/sim.6871">10.1002/sim.6871</a>.
</p>
<p>Nikoloulopoulos, A.K. (2017)
Weighted scores method for longitudinal  ordinal data.
<em>Arxiv e-prints</em>, &lt;arXiv:1510.07376&gt;. <a href="https://arxiv.org/abs/1510.07376">https://arxiv.org/abs/1510.07376</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wtsc">wtsc</a></code>,
<code><a href="#topic+weightMat">weightMat</a></code>,
<code><a href="#topic+godambe">godambe</a></code>,
<code><a href="#topic+wtsc.wrapper">wtsc.wrapper</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>################################################################################
#                           NB2 regression 
################################################################################
################################################################################
#                      read and set up the data set
################################################################################
data(childvisit)
# covariates
season1&lt;-childvisit$q
season1[season1&gt;1]&lt;-0
xdat&lt;-cbind(1,childvisit$sex,childvisit$age,childvisit$m,season1)
# response
ydat&lt;-childvisit$hosp
#id
id&lt;-childvisit$id
#time
tvec&lt;-childvisit$q
################################################################################
#                      select the marginal model
################################################################################
margmodel="nb2"
################################################################################
#                      select the  correlation structure
################################################################################
corstr="exch"
################################################################################
#                      perform CL1 estimation
################################################################################
i.est&lt;-iee(xdat,ydat,margmodel)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
est.rho&lt;-cl1(b=i.est$reg,gam=i.est$gam,xdat,ydat,id,tvec,margmodel,corstr,link)
cat("\nest.rho: CL1 estimates\n")
print(est.rho$e)
################################################################################
#                      obtain the fixed weight matrices
################################################################################
WtScMat&lt;-weightMat(b=i.est$reg,gam=i.est$gam,rh=est.rho$e,
xdat,ydat,id,tvec,margmodel,corstr)
################################################################################
#                      obtain the weighted scores estimates
################################################################################
# solve the nonlinear system of equations
ws&lt;-solvewtsc(start=c(i.est$reg,i.est$gam),WtScMat,xdat,ydat,id,
tvec,margmodel,link)
cat("ws=parameter estimates\n")
print(ws$r)
################################################################################
#                         Ordinal regression 
################################################################################
################################################################################
#                      read and set up data set
################################################################################

data(arthritis)
nn=nrow(arthritis)
bas2&lt;-bas3&lt;-bas4&lt;-bas5&lt;-rep(0,nn)
bas2[arthritis$b==2]&lt;-1
bas3[arthritis$b==3]&lt;-1
bas4[arthritis$b==4]&lt;-1
bas5[arthritis$b==5]&lt;-1
t2&lt;-t3&lt;-rep(0,nn)
t2[arthritis$ti==3]&lt;-1
t3[arthritis$ti==5]&lt;-1
xdat=cbind(t2,t3,arthritis$trt,bas2,bas3,bas4,bas5,arthritis$age) 
ydat=arthritis$y
id&lt;-arthritis$id
#time
tvec&lt;-arthritis$time
################################################################################
#                      select the link
################################################################################
link="probit"
################################################################################
#                      select the  correlation structure
################################################################################
corstr="exch"
################################################################################
#                      perform CL1 estimation
################################################################################
i.est&lt;-iee.ord(xdat,ydat,link)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
est.rho&lt;-cl1.ord(b=i.est$reg,gam=i.est$gam,xdat,ydat,id,tvec,corstr,link)
cat("\nest.rho: CL1 estimates\n")
print(est.rho$e)
################################################################################
#                      obtain the fixed weight matrices
################################################################################
WtScMat&lt;-weightMat.ord(b=i.est$reg,gam=i.est$gam,rh=est.rho$e,xdat,ydat,id,
tvec,corstr,link)
################################################################################
#                      obtain the weighted scores estimates
################################################################################
# solve the nonlinear system of equations
ws&lt;-solvewtsc.ord(start=c(i.est$reg,i.est$gam),WtScMat,xdat,ydat,id,
tvec,link)
cat("ws=parameter estimates\n")
print(ws$r)

</code></pre>

<hr>
<h2 id='toenail'>The toenail infection data</h2><span id='topic+toenail'></span>

<h3>Description</h3>

<p>The data consist of up to seven binary observations
on each of 294 subjects who had been randomly
assigned to one of two treatment groups. The observations,
taken at regularly scheduled time points, are coded as 1 if
the subject's infection was severe and 0 otherwise. The interest is
to investigate if the two treatments differ
and if the percentage of severe infections decreased over time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(toenail)</code></pre>


<h3>Format</h3>

<p>A data frame with 1568 observations on the following 4 variables.
</p>

<dl>
<dt><code>idnum</code></dt><dd><p>The index for individuals.</p>
</dd>
<dt><code>treatn</code></dt><dd><p>The treatment binary covariate.</p>
</dd>
<dt><code>y</code></dt><dd><p>The subject's infection binary response.</p>
</dd>
<dt><code>time</code></dt><dd><p>The time indicator.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Molenberghs, G., Verbeke, G., 2005. <em>Models for Discrete Longitudinal Data</em>. 
Springer, NY.
</p>

<hr>
<h2 id='weightMat'>WEIGHT MATRICES FOR THE ESTIMATING EQUATIONS</h2><span id='topic+weightMat'></span><span id='topic+weightMat.ord'></span>

<h3>Description</h3>

<p>Weight matrices for the estimating equations.</p>


<h3>Usage</h3>

<pre><code class='language-R'>weightMat(b,gam,rh,xdat,ydat,id,tvec,margmodel,corstr,link)
weightMat.ord(b,gam,rh,xdat,ydat,id,tvec,corstr,link)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weightMat_+3A_b">b</code></td>
<td>
<p>The regression coefficients.</p>
</td></tr>
<tr><td><code id="weightMat_+3A_gam">gam</code></td>
<td>
<p>The uinivariate parameters that are not regression coefficients. That is the parameter <code class="reqn">\gamma</code> of negative binomial distribution or  the <code class="reqn">q</code>-dimensional vector of the univariate cutpoints of ordinal model. <code class="reqn">\gamma</code> is NULL for Poisson and binary regression.</p>
</td></tr>
<tr><td><code id="weightMat_+3A_rh">rh</code></td>
<td>
<p>The vector of normal copula parameters.</p>
</td></tr>
<tr><td><code id="weightMat_+3A_xdat">xdat</code></td>
<td>
<p><code class="reqn">(\mathbf{x}_1 , \mathbf{x}_2 , \ldots ,
  \mathbf{x}_n )^\top</code>, where the matrix <code class="reqn">\mathbf{x}_i,\,i=1,\ldots,n</code> for a given unit will
depend on the  times of observation for that unit (<code class="reqn">j_i</code>) and will have
number of rows <code class="reqn">j_i</code>, each row corresponding to one of the <code class="reqn">j_i</code> elements
of <code class="reqn">y_i</code> and <code class="reqn">p</code> columns where <code class="reqn">p</code> is the number of covariates including
the unit first column  to account for the intercept (except for ordinal regression where there is no intercept). This xdat matrix is
of dimension <code class="reqn">(N\times p),</code> where <code class="reqn">N =\sum_{i=1}^n j_i</code> is the total
number of observations from all units.</p>
</td></tr>
<tr><td><code id="weightMat_+3A_ydat">ydat</code></td>
<td>
<p><code class="reqn">(y_1 , y_2 , \ldots , y_n )^\top</code>, 
where the reponse data vectors <code class="reqn">y_i, i=1,\ldots,n</code>
are of possibly different lengths for different units.  In particular,
we now have that <code class="reqn">y_i</code> is (<code class="reqn">j_i \times 1</code>), where <code class="reqn">j_i</code> is the   number of
observations on unit <code class="reqn">i</code>. The total number of observations   from all units
is <code class="reqn">N =\sum_{i=1}^n j_i</code>. The ydat are the collection of data   vectors
<code class="reqn">y_i, i = 1,\ldots,n</code> one from each unit which summarize all the data
together in a single, long vector of length <code class="reqn">N</code>.</p>
</td></tr>
<tr><td><code id="weightMat_+3A_id">id</code></td>
<td>
<p>An index for individuals or clusters.</p>
</td></tr>
<tr><td><code id="weightMat_+3A_tvec">tvec</code></td>
<td>
<p>A vector with the time indicator of individuals or clusters.</p>
</td></tr>
<tr><td><code id="weightMat_+3A_margmodel">margmodel</code></td>
<td>

<p>Indicates the marginal model.
Choices are &ldquo;poisson&rdquo; for Poisson, &ldquo;bernoulli&rdquo; for Bernoulli, 
and  &ldquo;nb1&rdquo; , &ldquo;nb2&rdquo; for the NB1 and NB2 parametrization 
of negative binomial in Cameron and Trivedi (1998).</p>
</td></tr>
<tr><td><code id="weightMat_+3A_corstr">corstr</code></td>
<td>
<p>Indicates the latent correlation structure of normal copula.
Choices are &ldquo;exch&rdquo;, &ldquo;ar&rdquo;, and &ldquo;unstr&rdquo; for exchangeable, ar(1)
and unstrucutred correlation structure, respectively.</p>
</td></tr>
<tr><td><code id="weightMat_+3A_link">link</code></td>
<td>
<p>The link function. 
Choices are &ldquo;log&rdquo; for the log link function, &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The fixed weight matrices <code class="reqn">W_{i,\rm working}</code> based on a working
discretized MVN, of the weighted scores equations in Nikoloulopoulos et al. (2011)
</p>
<p style="text-align: center;"><code class="reqn">
 g_1= g_1(a)=\sum_{i=1}^n X_i^T\,W_{i,\rm working}^{-1}\, s_i(a)=0,
</code>
</p>

<p>where <code class="reqn">W_{i,\rm working}^{-1}=\Delta_i\Omega_{i,\rm working}^{-1}=
\Delta_i({\tilde a})\Omega_i({\tilde a},{\tilde R})^{-1}</code> is based on
the covariance matrix of <code class="reqn">s_i(a)</code> computed from the
fitted discretized MVN model with estimated parameters <code class="reqn">{\tilde a},
{\tilde R}</code>.
</p>
<p>Note that <code>weightMat.ord</code> is a variant of the code for ordinal (probit and logistic) regression.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>omega</code></td>
<td>
<p>The array with the <code class="reqn">\Omega_i,\ i=1,\ldots,n</code> matrices.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>The array with the <code class="reqn">\Delta_i,\ i=1,\ldots,n</code> matrices.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>The array with the <code class="reqn">X_i,\ i=1,\ldots,n</code> matrices.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos <a href="mailto:A.Nikoloulopoulos@uea.ac.uk">A.Nikoloulopoulos@uea.ac.uk</a><br />
Harry Joe <a href="mailto:harry.joe@ubc.ca">harry.joe@ubc.ca</a>
</p>


<h3>References</h3>

<p>Nikoloulopoulos, A.K., Joe, H. and Chaganty, N.R. (2011)
Weighted scores method for regression models with dependent data.
<em>Biostatistics</em>, <b>12</b>, 653&ndash;665. doi: <a href="https://doi.org/10.1093/biostatistics/kxr005">10.1093/biostatistics/kxr005</a>.
</p>
<p>Nikoloulopoulos, A.K. (2016)
Correlation structure and variable selection in generalized estimating equations via composite likelihood information criteria.
<em>Statistics in Medicine</em>, <b>35</b>, 2377&ndash;2390. doi: <a href="https://doi.org/10.1002/sim.6871">10.1002/sim.6871</a>.
</p>
<p>Nikoloulopoulos, A.K. (2017)
Weighted scores method for longitudinal  ordinal data.
<em>Arxiv e-prints</em>, &lt;arXiv:1510.07376&gt;. <a href="https://arxiv.org/abs/1510.07376">https://arxiv.org/abs/1510.07376</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wtsc">wtsc</a></code>,
<code><a href="#topic+solvewtsc">solvewtsc</a></code>,
<code><a href="#topic+godambe">godambe</a></code>,
<code><a href="#topic+wtsc.wrapper">wtsc.wrapper</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>################################################################################
#                            binary regression
################################################################################
################################################################################
#                      read and set up the data set
################################################################################
data(toenail)
xdat&lt;-cbind(1,toenail$treat,toenail$time,toenail$treat*toenail$time)
# response
ydat&lt;-toenail$y
#id
id&lt;-toenail$id
#time
tvec&lt;-toenail$time
################################################################################
#                      select the marginal model
################################################################################
margmodel="bernoulli"
link="probit"
################################################################################
#                      select the  correlation structure
################################################################################
corstr="ar"
################################################################################
#                      perform CL1 estimation
################################################################################
i.est&lt;-iee(xdat,ydat,margmodel,link)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
# est.rho&lt;-cl1(b=i.est$reg,gam=i.est$gam,xdat,ydat,id,tvec,margmodel,corstr,link)
# cat("\nest.rho: CL1 estimates\n")
# print(est.rho$e)
# [1] 0.8941659
################################################################################
#                      obtain the fixed weight matrices
################################################################################
WtScMat&lt;-weightMat(b=i.est$reg,gam=i.est$gam,rh=0.8941659,
xdat,ydat,id,tvec,margmodel,corstr,link)
################################################################################
#                         Ordinal regression 
################################################################################
################################################################################
#                      read and set up data set
################################################################################

data(arthritis)
nn=nrow(arthritis)
bas2&lt;-bas3&lt;-bas4&lt;-bas5&lt;-rep(0,nn)
bas2[arthritis$b==2]&lt;-1
bas3[arthritis$b==3]&lt;-1
bas4[arthritis$b==4]&lt;-1
bas5[arthritis$b==5]&lt;-1
t2&lt;-t3&lt;-rep(0,nn)
t2[arthritis$ti==3]&lt;-1
t3[arthritis$ti==5]&lt;-1
xdat=cbind(t2,t3,arthritis$trt,bas2,bas3,bas4,bas5,arthritis$age) 
ydat=arthritis$y
id&lt;-arthritis$id
#time
tvec&lt;-arthritis$time
################################################################################
#                      select the link
################################################################################
link="probit"
################################################################################
#                      select the  correlation structure
################################################################################
corstr="exch"
################################################################################
#                      perform CL1 estimation
################################################################################
i.est&lt;-iee.ord(xdat,ydat,link)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
est.rho&lt;-cl1.ord(b=i.est$reg,gam=i.est$gam,xdat,ydat,id,tvec,corstr,link)
WtScMat&lt;-weightMat.ord(b=i.est$reg,gam=i.est$gam,rh=est.rho$e,xdat,ydat,id,tvec,corstr,link)

</code></pre>

<hr>
<h2 id='wtsc'>THE WEIGHTED SCORES EQUATIONS WITH INPUTS OF THE WEIGHT MATRICES AND THE DATA</h2><span id='topic+wtsc'></span><span id='topic+wtsc.ord'></span>

<h3>Description</h3>

<p>The weighted scores equations with inputs of the weight matrices and
the data. </p>


<h3>Usage</h3>

<pre><code class='language-R'>wtsc(param,WtScMat,xdat,ydat,id,tvec,margmodel,link)
wtsc.ord(param,WtScMat,xdat,ydat,id,tvec,link)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wtsc_+3A_param">param</code></td>
<td>
<p>The vector of regression and not regression parameters.</p>
</td></tr>
<tr><td><code id="wtsc_+3A_wtscmat">WtScMat</code></td>
<td>
<p>A list containing the following components.
omega: The array with the <code class="reqn">\Omega_i,\,i=1,\ldots,n</code> matrices;
delta: The array with the <code class="reqn">\Delta_i,\,i=1,\ldots,n</code> matrices;
X: The array with the <code class="reqn">X_i,\,i=1,\ldots,n</code> matrices.</p>
</td></tr>
<tr><td><code id="wtsc_+3A_xdat">xdat</code></td>
<td>
<p><code class="reqn">(\mathbf{x}_1 ,  \mathbf{x}_2 , \ldots ,
  \mathbf{x}_n )^\top</code>, where the matrix <code class="reqn">\mathbf{x}_i,\,i=1,\ldots,n</code> for a given unit will
depend on the  times of observation for that unit (<code class="reqn">j_i</code>) and will have
number of rows <code class="reqn">j_i</code>, each row corresponding to one of the <code class="reqn">j_i</code> elements
of <code class="reqn">y_i</code> and <code class="reqn">p</code> columns where <code class="reqn">p</code> is the number of covariates including
the unit first column  to account for the intercept (except for ordinal regression where there is no intercept). This xdat matrix is
of dimension <code class="reqn">(N\times p),</code> where <code class="reqn">N =\sum_{i=1}^n j_i</code> is the total
number of observations from all units.</p>
</td></tr>
<tr><td><code id="wtsc_+3A_ydat">ydat</code></td>
<td>
<p><code class="reqn">(y_1 , y_2 , \ldots , y_n  )^\top</code>, where
the response data vectors <code class="reqn">y_i,\,i=1,\ldots,n</code>
are of possibly different lengths for different units.  In particular,
we now have that <code class="reqn">y_i</code> is (<code class="reqn">j_i \times 1</code>), where <code class="reqn">j_i</code> is the   number of
observations on unit <code class="reqn">i</code>. The total number of observations   from all units
is <code class="reqn">N =\sum_{i=1}^n j_i</code>. The ydat are the collection of data   vectors
<code class="reqn">y_i, i = 1,\ldots,n</code> one from each unit which summarize all the data
together in a single, long vector of length <code class="reqn">N</code>.</p>
</td></tr>
<tr><td><code id="wtsc_+3A_id">id</code></td>
<td>
<p>An index for individuals or clusters.</p>
</td></tr>
<tr><td><code id="wtsc_+3A_tvec">tvec</code></td>
<td>
<p>A vector with the time indicator of individuals or clusters.</p>
</td></tr>
<tr><td><code id="wtsc_+3A_margmodel">margmodel</code></td>
<td>

<p>Indicates the marginal model.
Choices are &ldquo;poisson&rdquo; for Poisson, &ldquo;bernoulli&rdquo; for Bernoulli, 
and  &ldquo;nb1&rdquo; , &ldquo;nb2&rdquo; for the NB1 and NB2 parametrization 
of negative binomial in Cameron and Trivedi (1998).</p>
</td></tr>
<tr><td><code id="wtsc_+3A_link">link</code></td>
<td>
<p>The link function. 
Choices are &ldquo;log&rdquo; for the log link function, &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The weighted scores estimating equations, with
<code class="reqn">W_{i,\rm working}</code> based on a working discretized MVN, have the form:
</p>
<p style="text-align: center;"><code class="reqn">
  g_1= g_1( a)=\sum_{i=1}^n X_i^T\, W_{i,{\rm working}}^{-1}\, s_i( a)=0,
</code>
</p>

<p>where <code class="reqn"> W_{i,\rm working}^{-1}=\Delta_i\Omega_{i,\rm working}^{-1}=
\Delta_i({\tilde a})\Omega_i({\tilde a},{\tilde R})^{-1}</code> is based on
the covariance matrix of <code class="reqn"> s_i( a)</code> computed from the
fitted discretized MVN model with estimated parameters <code class="reqn">{\tilde a},
{\tilde R}</code>.
</p>
<p>Note that <code>wtsc.ord</code> is a variant of the code for ordinal (probit and logistic) regression.
</p>


<h3>Value</h3>

<p>The weighted scores equations.</p>


<h3>References</h3>

<p>Nikoloulopoulos, A.K., Joe, H. and Chaganty, N.R. (2011)
Weighted scores method for regression models with dependent data.
<em>Biostatistics</em>, <b>12</b>, 653&ndash;665. doi: <a href="https://doi.org/10.1093/biostatistics/kxr005">10.1093/biostatistics/kxr005</a>.
</p>
<p>Nikoloulopoulos, A.K. (2016)
Correlation structure and variable selection in generalized estimating equations via composite likelihood information criteria.
<em>Statistics in Medicine</em>, <b>35</b>, 2377&ndash;2390. doi: <a href="https://doi.org/10.1002/sim.6871">10.1002/sim.6871</a>.
</p>
<p>Nikoloulopoulos, A.K. (2017)
Weighted scores method for longitudinal  ordinal data.
<em>Arxiv e-prints</em>, &lt;arXiv:1510.07376&gt;. <a href="https://arxiv.org/abs/1510.07376">https://arxiv.org/abs/1510.07376</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+solvewtsc">solvewtsc</a></code>,
<code><a href="#topic+weightMat">weightMat</a></code>,
<code><a href="#topic+godambe">godambe</a></code>,
<code><a href="#topic+wtsc.wrapper">wtsc.wrapper</a></code>
</p>

<hr>
<h2 id='wtsc.wrapper'>THE WEIGHTED SCORES METHOD  WITH INPUTS OF THE DATA</h2><span id='topic+wtsc.wrapper'></span><span id='topic+wtsc.ord.wrapper'></span>

<h3>Description</h3>

<p>The weighted scores method with inputs of the data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>wtsc.wrapper(xdat,ydat,id,tvec,margmodel,corstr,link,iprint=FALSE)
wtsc.ord.wrapper(xdat,ydat,id,tvec,corstr,link,iprint=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wtsc.wrapper_+3A_xdat">xdat</code></td>
<td>
<p><code class="reqn">(\mathbf{x}_1 ,  \mathbf{x}_2 , \ldots ,
  \mathbf{x}_n )^\top</code>, where the matrix <code class="reqn">\mathbf{x}_i,\,i=1,\ldots,n</code> for a given unit will
depend on the  times of observation for that unit (<code class="reqn">j_i</code>) and will have
number of rows <code class="reqn">j_i</code>, each row corresponding to one of the <code class="reqn">j_i</code> elements
of <code class="reqn">y_i</code> and <code class="reqn">p</code> columns where <code class="reqn">p</code> is the number of covariates including
the unit first column  to account for the intercept (except for ordinal regression where there is no intercept). This xdat matrix is
of dimension <code class="reqn">(N\times p),</code> where <code class="reqn">N =\sum_{i=1}^n j_i</code> is the total
number of observations from all units.</p>
</td></tr>
<tr><td><code id="wtsc.wrapper_+3A_ydat">ydat</code></td>
<td>
<p><code class="reqn">(y_1 , y_2 , \ldots , y_n  )^\top</code>,
where the response data vectors <code class="reqn">y_i,\,i=1,\ldots,n</code>
are of possibly different lengths for different units.  In particular,
we now have that <code class="reqn">y_i</code> is (<code class="reqn">j_i \times 1</code>), where <code class="reqn">j_i</code> is the   number of
observations on unit <code class="reqn">i</code>. The total number of observations   from all units
is <code class="reqn">N =\sum_{i=1}^n j_i</code>. The ydat are the collection of data   vectors
<code class="reqn">y_i, i = 1,\ldots,n</code> one from each unit which summarize all the data
together in a single, long vector of length <code class="reqn">N</code>.</p>
</td></tr>
<tr><td><code id="wtsc.wrapper_+3A_id">id</code></td>
<td>
<p>An index for individuals or clusters.</p>
</td></tr>
<tr><td><code id="wtsc.wrapper_+3A_tvec">tvec</code></td>
<td>
<p>A vector with the time indicator of individuals or clusters.</p>
</td></tr>
<tr><td><code id="wtsc.wrapper_+3A_margmodel">margmodel</code></td>
<td>

<p>Indicates the marginal model.
Choices are &ldquo;poisson&rdquo; for Poisson, &ldquo;bernoulli&rdquo; for Bernoulli, 
and  &ldquo;nb1&rdquo; , &ldquo;nb2&rdquo; for the NB1 and NB2 parametrization 
of negative binomial in Cameron and Trivedi (1998).</p>
</td></tr>
<tr><td><code id="wtsc.wrapper_+3A_corstr">corstr</code></td>
<td>
<p>Indicates the latent correlation structure of normal copula.
Choices are &ldquo;exch&rdquo;, &ldquo;ar&rdquo;, and &ldquo;unstr&rdquo; for exchangeable, ar(1)
and unstructured correlation structure, respectively.</p>
</td></tr>
<tr><td><code id="wtsc.wrapper_+3A_link">link</code></td>
<td>
<p>The link function. 
Choices are &ldquo;log&rdquo; for the log link function, &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function.</p>
</td></tr>
<tr><td><code id="wtsc.wrapper_+3A_iprint">iprint</code></td>
<td>
<p>Indicates printing of some intermediate results, default FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This wrapper functions handles all the steps to obtain the weighted
scores estimates and standard errors.</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>IEEest</code></td>
<td>
<p>The estimates of the regression and not regression
parameters ignoring dependence.</p>
</td></tr>
<tr><td><code>CL1est</code></td>
<td>
<p>The vector with the CL1 estimated dependence parameters (latent
correlations).</p>
</td></tr>
<tr><td><code>CL1lik</code></td>
<td>
<p>The  value of the sum of bivariate marginal log-likelihoods at
CL1 estimates.</p>
</td></tr>
<tr><td><code>WSest</code></td>
<td>
<p>The weighted score estimates of the regression and not regression
parameters.</p>
</td></tr>
<tr><td><code>asympcov</code></td>
<td>
<p>The estimated weighted scores asymptotic covariance matrix.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos <a href="mailto:A.Nikoloulopoulos@uea.ac.uk">A.Nikoloulopoulos@uea.ac.uk</a><br />
Harry Joe <a href="mailto:harry.joe@ubc.ca">harry.joe@ubc.ca</a>
</p>


<h3>References</h3>

<p>Nikoloulopoulos, A.K., Joe, H. and Chaganty, N.R. (2011)
Weighted scores method for regression models with dependent data.
<em>Biostatistics</em>, <b>12</b>, 653&ndash;665. doi: <a href="https://doi.org/10.1093/biostatistics/kxr005">10.1093/biostatistics/kxr005</a>.
</p>
<p>Nikoloulopoulos, A.K. (2016)
Correlation structure and variable selection in generalized estimating equations via composite likelihood information criteria.
<em>Statistics in Medicine</em>, <b>35</b>, 2377&ndash;2390. doi: <a href="https://doi.org/10.1002/sim.6871">10.1002/sim.6871</a>.
</p>
<p>Nikoloulopoulos, A.K. (2017)
Weighted scores method for longitudinal  ordinal data.
<em>Arxiv e-prints</em>, &lt;arXiv:1510.07376&gt;. <a href="https://arxiv.org/abs/1510.07376">https://arxiv.org/abs/1510.07376</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wtsc">wtsc</a></code>,
<code><a href="#topic+solvewtsc">solvewtsc</a></code>,
<code><a href="#topic+weightMat">weightMat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
################################################################################
#                      read and set up the data set
################################################################################
data(childvisit)
# covariates
season1&lt;-childvisit$q
season1[season1&gt;1]&lt;-0
xdat&lt;-cbind(1,childvisit$sex,childvisit$age,childvisit$m,season1)
# response
ydat&lt;-childvisit$hosp
#id
id&lt;-childvisit$id
#time
tvec&lt;-childvisit$q
################################################################################
out&lt;-wtsc.wrapper(xdat,ydat,id,tvec,margmodel="nb1",corstr="ar",iprint=TRUE)

################################################################################
#                        transform to binary responses                         #
################################################################################
y2&lt;-ydat
y2[ydat&gt;0]&lt;-1
################################################################################
out&lt;-wtsc.wrapper(xdat,y2,id,tvec,margmodel="bernoulli",link="probit",
corstr="exch",iprint=TRUE)
################################################################################
#                        via the code for ordinal                             #
################################################################################
out&lt;-wtsc.ord.wrapper(xdat[,-1],2-y2,id,tvec,link="probit",
corstr="exch",iprint=TRUE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
