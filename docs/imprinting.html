<!DOCTYPE html><html><head><title>Help for package imprinting</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {imprinting}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#get_country_cocirculation_data'><p>Get data on the relative circulation of each influenza A subtype</p></a></li>
<li><a href='#get_country_inputs_1997_to_present'><p>Return raw flu surveillance data for a specific country</p></a></li>
<li><a href='#get_country_intensity_data'><p>Get the relative intensity of influenza A circulation</p></a></li>
<li><a href='#get_imprinting_probabilities'><p>Calculate imprinting probabilities</p></a></li>
<li><a href='#get_p_infection_year'><p>Calculate the probability imprinting occurs n years after birth</p></a></li>
<li><a href='#get_regional_inputs_1997_to_present'><p>Return raw flu surveillance data for a specific WHO region</p></a></li>
<li><a href='#get_template_data'><p>Get country-independent flu circulation data for 1918-1996</p></a></li>
<li><a href='#get_WHO_region'><p>Look up a country's WHO region</p></a></li>
<li><a href='#plot_many_country_years'><p>Plot imprinting probabilities for up to five country-years</p></a></li>
<li><a href='#plot_one_country_year'><p>Plot imprinting probabilities for a single country and year</p></a></li>
<li><a href='#show_available_countries'><p>Show a list of all available countries</p></a></li>
<li><a href='#show_available_regions'><p>Show all WHO regions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Calculate Birth Year-Specific Probabilities of Immune Imprinting
to Influenza</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Reconstruct birth-year specific probabilities of immune imprinting to influenza A, using the methods of Gostic et al. (2016) &lt;<a href="https://doi.org/10.1126%2Fscience.aag1322">doi:10.1126/science.aag1322</a>&gt;. Plot, save, or export the calculated probabilities for use in your own research. By default, the package calculates subtype-specific imprinting probabilities, but with user-provided frequency data, it is possible to calculate probabilities for arbitrary kinds of primary exposure to influenza A, including primary vaccination and exposure to specific clades, strains, etc.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr (&ge; 1.0.9), tidyr (&ge; 1.2.0), cowplot (&ge; 1.0.0),
ggplot2, tidyselect</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0), devtools</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://cobeylab.github.io/imprinting/">https://cobeylab.github.io/imprinting/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/cobeylab/imprinting/issues">https://github.com/cobeylab/imprinting/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-12-16 22:31:25 UTC; alex</td>
</tr>
<tr>
<td>Author:</td>
<td>Katelyn Gostic [aut],
  Alex Byrnes [ctb, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alex Byrnes &lt;abyrnes@uchicago.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-12-16 22:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='get_country_cocirculation_data'>Get data on the relative circulation of each influenza A subtype</h2><span id='topic+get_country_cocirculation_data'></span>

<h3>Description</h3>

<p><code>get_country_cocirculation_data()</code> imports data on the fraction of influenza A cases in a specific country and year that were caused by each influenza A subtype (H1N1, H2N2, or H3N2), or group (group 1 or group 2). Group 1 contains H1N1 and H2N2, and group 2 contains H2N2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_country_cocirculation_data(
  country,
  max_year,
  min_samples = 30,
  output_format = "tibble"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_country_cocirculation_data_+3A_country">country</code></td>
<td>
<p>country of interest. Run <code>show_available_countries()</code> for a list of valid inputs.</p>
</td></tr>
<tr><td><code id="get_country_cocirculation_data_+3A_max_year">max_year</code></td>
<td>
<p>last year of interest. Results will be generated from 1918:max_year.</p>
</td></tr>
<tr><td><code id="get_country_cocirculation_data_+3A_min_samples">min_samples</code></td>
<td>
<p>if fewer than <code>min_samples</code> (default 30) are reported in the country and year of interest, the function will substitute data from the corresponding WHO region.</p>
</td></tr>
<tr><td><code id="get_country_cocirculation_data_+3A_output_format">output_format</code></td>
<td>
<p>can be 'tibble' (the default) or 'matrix' (used mainly for convenience within other functions)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data come from three sources:
</p>

<ul>
<li><p> Historical assumptions: From 1918-1956, we assume only H1N1 circulated. From 1957-1967, we assume only H2N2 circulated. From 1968-1976, we assume only H3N2 circulated.
</p>
</li>
<li> <p><a href="https://jamanetwork.com/journals/jama/fullarticle/195750">Thompson et al. JAMA, 2003</a>: From 1977-1996 we pull data on the relative dominance of H1N1 and H3N2 from Table 1 of Thompson et al. 2003, which reports surveillance data collected in the United States.
</p>
</li>
<li><p> From 1997-present, we pull in country or region-specific data from <a href="https://apps.who.int/flumart/Default?ReportNo=12">WHO Flu Mart</a> on the fraction of specimens collected in routine influenza surveillance that test positive for each subtype. Country-specific data are the default. Regional data, then global data are used if the number of country or region-specific specimens is insufficient. <code><a href="#topic+get_template_data">get_template_data()</a></code> imports the data for 1918-1996. <code><a href="#topic+get_country_inputs_1997_to_present">get_country_inputs_1997_to_present()</a></code> and <code><a href="#topic+get_regional_inputs_1997_to_present">get_regional_inputs_1997_to_present()</a></code> import the data for 1997 on.
</p>
</li></ul>



<h3>Value</h3>

<p>A matrix with rows showing the calendar year, the fraction of influenza A-positive specimens of each subtype (rows <code>A/H1N1</code>, <code>A/H2N2</code>, and <code>A/H3N2</code>), and of each HA group (rows <code style="white-space: pre;">&#8288;group 1&#8288;</code>, and <code style="white-space: pre;">&#8288;group 2&#8288;</code>). Row <code>A</code> should always be 1, as it shows the sum of subtype-specific fractions. Row <code>B</code> is a placeholder whose values are all <code>NA</code>.
</p>


<h3>See Also</h3>

<p><a href="https://doi.org/10.1126/science.aag1322">doi:10.1126/science.aag1322</a>Gostic et al. Science, (2016) for detailed methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_country_cocirculation_data("United States", "2019")
get_country_cocirculation_data("Laos", "2022", min_samples = 40)

</code></pre>

<hr>
<h2 id='get_country_inputs_1997_to_present'>Return raw flu surveillance data for a specific country</h2><span id='topic+get_country_inputs_1997_to_present'></span>

<h3>Description</h3>

<p>Load and return a tibble containing raw influenza surveillance data for the country of interest. Data are from <a href="https://apps.who.int/flumart/Default?ReportNo=12">WHO Flu Mart</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_country_inputs_1997_to_present(country, max_year)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_country_inputs_1997_to_present_+3A_country">country</code></td>
<td>
<p>name of country. Run <code>show_available_countries()</code> for a list of options.</p>
</td></tr>
<tr><td><code id="get_country_inputs_1997_to_present_+3A_max_year">max_year</code></td>
<td>
<p>results will be output for all available years up to <code>max_year</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with the following columns:
</p>

<ul>
<li> <p><code>Country</code>: name of WHO region
</p>
</li>
<li> <p><code>Year</code>: calendar year of surveillance
</p>
</li>
<li> <p><code>n_processed</code>: total specimens processed
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>get_country_inputs_1997_to_present("Aruba", 1998)
get_country_inputs_1997_to_present("Honduras", 2022)

</code></pre>

<hr>
<h2 id='get_country_intensity_data'>Get the relative intensity of influenza A circulation</h2><span id='topic+get_country_intensity_data'></span>

<h3>Description</h3>

<p><code style="white-space: pre;">&#8288;get_country_intensity data()&#8288;</code> returns data on the annual intensity of influenza circulation in each calendar year. Following <a href="https://doi.org/10.1126/science.aag1322">doi:10.1126/science.aag1322</a>Gostic et al. Science, (2016), we define 1 as the average intensity. Seasons with intensities greater than 1 have more flu A circulation than average, and seasons with intensities less than 1 are mild.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_country_intensity_data(country, max_year, min_specimens = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_country_intensity_data_+3A_country">country</code></td>
<td>
<p>country of interest. Run <code>show_available_countries()</code> for valid inputs.</p>
</td></tr>
<tr><td><code id="get_country_intensity_data_+3A_max_year">max_year</code></td>
<td>
<p>last year of interest. Results will be generated from 1918:max_year.</p>
</td></tr>
<tr><td><code id="get_country_intensity_data_+3A_min_specimens">min_specimens</code></td>
<td>
<p>if fewer than <code>min_specimens</code> (default 50) were tested in the country and year of interest, the function will substitute data from the corresponding WHO region.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For 1918-1996, we use annual intensities from Gostic et al., Science, (2016). For 1997-present, we calculate country or region-specific intensities using surveillance data from <a href="https://apps.who.int/flumart/Default?ReportNo=12">WHO Flu Mart</a>. Intensity is calculated as:
[fraction of processed samples positive for flu A]/[mean fraction of processed samples positive for flu A].
Country-specific data are used by default. Regional or global data are substituted when country-specific data contain too few observations or fail quality checks. Global data are only used in years when regional data are insufficient.
</p>


<h3>Value</h3>

<p>A tibble showing the year and intensity score.
</p>

<hr>
<h2 id='get_imprinting_probabilities'>Calculate imprinting probabilities</h2><span id='topic+get_imprinting_probabilities'></span>

<h3>Description</h3>

<p>For each country and year of observation, calculate the probability that cohorts born in each year from 1918 through the year of observation imprinted to a specific influenza A virus subtype (H1N1, H2N2, or H3N2), or group (group 1 contains H1N1 and H2N2; group 2 contains H3N2).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_imprinting_probabilities(
  observation_years,
  countries,
  annual_frequencies = NULL,
  df_format = "long"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_imprinting_probabilities_+3A_observation_years">observation_years</code></td>
<td>
<p>year(s) of observation in which to output imprinting probabilities. The observation year, together with the birth year, determines the birth cohort's age when calculating imprinting probabilities. Cohorts &lt;=12 years old at the time of observation have some probability of being naive to influenza.</p>
</td></tr>
<tr><td><code id="get_imprinting_probabilities_+3A_countries">countries</code></td>
<td>
<p>a vector of countries for which to calculate imprinting probabilities. Run <code>show_available_countries()</code> for a list of valid inputs, and proper spellings.</p>
</td></tr>
<tr><td><code id="get_imprinting_probabilities_+3A_annual_frequencies">annual_frequencies</code></td>
<td>
<p>an optional input allowing users to specify custom circulation frequencies for arbitrary types of imprinting in order to study, e.g. imprinting to specific strains, clades, or imprinting by vaccination. If nothing is input, the default is to calculate subtype-specific probabilities (possible imprinting types are A/H1N1, A/H2N2, A/H3N2, or naive). See Details.</p>
</td></tr>
<tr><td><code id="get_imprinting_probabilities_+3A_df_format">df_format</code></td>
<td>
<p>must be either 'long' (default) or 'wide'. Controls whether the output data frame is in long format (with a single column for calculated probabilities and a second column for imprinting subtype), or wide format (with four columns, H1N1, H2N2, H3N2, and naive) showing the probability of each imprinting status.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Imprinting probabilities are calculated following <a href="https://doi.org/10.1126/science.aag1322">doi:10.1126/science.aag1322</a>Gostic et al. Science, (2016). Briefly, the model first calculates the probability that an individual's first influenza infection occurs 0, 1, 2, ... 12 years after birth using a modified geometric waiting time model. The annual circulation intensities output by <code><a href="#topic+get_country_intensity_data">get_country_intensity_data()</a></code> scale the probability of primary infection in each calendar year.
</p>
<p>Then, after calculating the probability of imprinting 0, 1, 2, ... calendar years after birth, the model uses data on which subtypes circulated in each calendar year (from <code><a href="#topic+get_country_cocirculation_data">get_country_cocirculation_data()</a></code>) to estimate that probability that a first infection was caused by each subtype. See <code><a href="#topic+get_country_cocirculation_data">get_country_cocirculation_data()</a></code> for details about the underlying data sources.
</p>
<p>To calculate other kinds of imprinting probabilities (e.g. for specific clades, strains, or to include pediatric vaccination), users can specify custom circulation frequencies as a list, <code>annual_frequencies</code>. This list must contain one named element for each country in the <code>countries</code> input vector. Each list element must be a data frame or tibble whose first column is named &quot;year&quot; and contains numeric years from 1918:max(<code>observation_years</code>). Columns 2:N of the data frame must contain circulation frequencies that sum to 1 across each row, and each column must have a unique name indicating the exposure kind. E.g. column names could be &quot;year&quot;, &quot;H1N1&quot;, &quot;H2N2&quot;, &quot;H3N2&quot;, &quot;vaccinated&quot; to include probabilities of imprinting by vaccine, or &quot;year&quot;, &quot;3C.3A&quot;, &quot;not_3C.3A&quot; to calculate clade-specific probabilities.  Do not include a naive column. Any number of imprinting types is allowed, but the code is not optimized to run efficiently when the number of categories is very large. Frequencies within the column must be supplied by the user. See <a href="https://www.nature.com/articles/s41467-021-24566-y">Vieira et al. 2021</a> for methods to estimate circulation frequencies from sequence databases like <a href="https://gisaid.org/">GISAID</a> or the <a href="https://www.ncbi.nlm.nih.gov/genomes/FLU/Database/nph-select.cgi?go=database">NCBI Sequence Database</a>.
</p>
<p>See <code>vignette("custom-imprinting-types")</code> for use of a custom <code>annual_frequencies</code> input.
</p>


<h3>Value</h3>


<ul>
<li><p> If <code>format=long</code> (the default), a long tibble with columns showing the imprinting subtype (H1N1, H2N2, H3N2, or naive), the year of observation, the country, the birth year, and the imprinting probability.
</p>
</li>
<li><p> If <code>format=wide</code>, a wide tibble with each row representing a country, observation year, and birth year, and with a column for each influenza A subtype (H1N1, H2N2, and H3N2), or the probability that someone born in that year remains naive to influenza and has not yet imprinted.
For cohorts &gt;12 years old in the year of observation, the probability of remaining naive is 0, and the subtype-specific probabilities are normalized to sum to 1. For cohorts &lt;=12 years old in the year of observation, the probability of remaining naive is non-zero. For cohorts not yet born at the time of observation, all output probabilities are 0.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># ===========================================================
# Get imprinting probabilities for one country and year
get_imprinting_probabilities(2022, "United States")
# ===========================================================
# Return the same outputs in wide format
get_imprinting_probabilities(2022,
  "United States",
  df_format = "wide"
)

</code></pre>

<hr>
<h2 id='get_p_infection_year'>Calculate the probability imprinting occurs n years after birth</h2><span id='topic+get_p_infection_year'></span>

<h3>Description</h3>

<p>Given an individual's birth year, the year of observation, and pre-calculated influenza circulation intensities, calculate the probability that the first influenza infection occurs exactly 0, 1, 2, ... 12 years after birth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_p_infection_year(
  birth_year,
  observation_year,
  intensity_df,
  max_year,
  baseline_annual_p_infection = 0.28
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_p_infection_year_+3A_birth_year">birth_year</code></td>
<td>
<p>year of birth (numeric). Must be between 1918 and the current calendar year.</p>
</td></tr>
<tr><td><code id="get_p_infection_year_+3A_observation_year">observation_year</code></td>
<td>
<p>year of observation, which affects the birth cohort's age.</p>
</td></tr>
<tr><td><code id="get_p_infection_year_+3A_intensity_df">intensity_df</code></td>
<td>
<p>data frame of annual intensities, output by <code><a href="#topic+get_country_intensity_data">get_country_intensity_data()</a></code>.</p>
</td></tr>
<tr><td><code id="get_p_infection_year_+3A_max_year">max_year</code></td>
<td>
<p>maximum year for which to output probabilities. Must be greater than or equal to observation_year. (If in doubt, set equal to observation year.)</p>
</td></tr>
<tr><td><code id="get_p_infection_year_+3A_baseline_annual_p_infection">baseline_annual_p_infection</code></td>
<td>
<p>average annual probability of primary infection. The default, 0.28, was estimated using age-seroprevalence data in <a href="https://doi.org/10.1126/science.aag1322">doi:10.1126/science.aag1322</a>Gostic et al. Science, (2016).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probability of primary influenza infection n years after birth is calculated based on a modified <a href="https://en.wikipedia.org/wiki/Geometric_distribution">geometric distribution</a>: let p be the average annual probability of a primary influenza infection. Then the probability that primary infection occurs n=0,1,2,... years after birth is <code class="reqn">p*(1-p)^{n}</code>.
</p>
<p>This function modifies the geometric model above to account for changes in annual circulation intensity, so that annual probabilities of primary infection <code class="reqn">p_i</code> are scaled by the intensity in calendar year i. Details are given in <a href="https://doi.org/10.1126/science.aag1322">doi:10.1126/science.aag1322</a>Gostic et al. Science, (2016).
</p>


<h3>Value</h3>

<p>a vector whose entries show the probability that a person born
in year 0 was first infected by influenza in year 0, 1, 2, 3, ...12
We only consider the first 13 probabilities (i.e. we assume everyone
imprints before age 13. These outputs are not normalized, so the
vector sum asymptotically approaches one, but is not exactly equal
to one. For cohorts born &lt;13 years prior to the year of observation,
the output vector will have less than 13 entries.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For a cohort under 12 years old and born in 2000, return the
# probabilities of primary infection in 2000, 2001, ... 2012:
get_p_infection_year(
  birth_year = 2000,
  observation_year = 2022,
  intensity_df = get_country_intensity_data("Canada", 2022),
  max_year = 2022
)

# If the cohort is still under age 12 at the time of observation, return
# a truncated vector of probabilities:
get_p_infection_year(
  birth_year = 2020,
  observation_year = 2022,
  intensity_df = get_country_intensity_data("Mexico", 2022),
  max_year = 2022
)

</code></pre>

<hr>
<h2 id='get_regional_inputs_1997_to_present'>Return raw flu surveillance data for a specific WHO region</h2><span id='topic+get_regional_inputs_1997_to_present'></span>

<h3>Description</h3>

<p>Load and return a tibble containing raw influenza surveillance data, aggregated across all countries in the WHO region of interest. Data are from <a href="https://apps.who.int/flumart/Default?ReportNo=12">WHO Flu Mart</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_regional_inputs_1997_to_present(region, max_year)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_regional_inputs_1997_to_present_+3A_region">region</code></td>
<td>
<p>name of WHO region. Run <code>show_available_regions()</code> for a list of options.</p>
</td></tr>
<tr><td><code id="get_regional_inputs_1997_to_present_+3A_max_year">max_year</code></td>
<td>
<p>results will be output for all available years up to <code>max_year</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with the following columns:
</p>

<ul>
<li> <p><code>WHOREGION</code>: name of WHO region.
</p>
</li>
<li> <p><code>Year</code>: calendar year .
</p>
</li>
<li> <p><code>n_H1N1</code>, <code>n_H2N2</code>, <code>n_H3N2</code>: number of influenza specimens that tested positive for each influenza A subtype.
</p>
</li>
<li> <p><code>n_A</code>: total specimens positive for influenza A (= <code>n_H1N1</code> + <code>n_H2N2</code> + <code>n_H3N2</code>).
</p>
</li>
<li> <p><code>n_BYam</code>, <code>n_BVic</code>: number of specimens positive for each lineage of influenza B: Victoria or Yamagata.
</p>
</li>
<li> <p><code>n_B</code>: total specimens positive for influenza B.
</p>
</li>
<li> <p><code>n_processed</code>: total specimens processed.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>get_regional_inputs_1997_to_present("americas", 2017)

</code></pre>

<hr>
<h2 id='get_template_data'>Get country-independent flu circulation data for 1918-1996</h2><span id='topic+get_template_data'></span>

<h3>Description</h3>

<p><code>get_template_data()</code> returns a tibble showing the fraction of influenza A cases caused by subtype H1N1, H2N2, or H3N2 in each year from 1918-1996. These data are country-independent. Country-specific data are only available from 1997 on.
</p>

<ul>
<li><p> For years 1918-1976 only one influenza A subtype circulated, so all fractions are 0 or 1.
</p>
</li>
<li><p> From 1977-1996 H1N1 and H3N2 both circulated. <code>get_template_data()</code> reports the fraction of influenza A-positive specimens of each subtype observed in US flu surveillance. See <a href="https://jamanetwork.com/journals/jama/fullarticle/195750">Thompson et al. JAMA, 2003</a>, Table 1.
</p>
</li>
<li><p> Country-specific data from <a href="https://apps.who.int/flumart/Default?ReportNo=12">WHO Flu Mart</a> will be appended to this template in later steps.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>get_template_data()
</code></pre>


<h3>Value</h3>

<p>A tibble with the following columns:
</p>

<ul>
<li><p> year
</p>
</li>
<li> <p><code>A/H1N1</code>, <code>A/H2N2</code>, and <code>A/H3N2</code> show the fraction of influenza cases caused by each subtype.
</p>
</li>
<li> <p><code>A</code> = <code>A/H1N1</code> + <code>A/H2N2</code> + <code>A/H3N2</code>
</p>
</li>
<li> <p><code>B</code> is a placeholder for future calculate of influenza B imprinting probabilities, which currently contains <code>NA</code>.
</p>
</li>
<li> <p><code>group1</code> and <code>group2</code> show the fraction of cases caused by group 1 subtypes (H1N1 and H2N2), or group 2 (H3N2).
</p>
</li>
<li> <p><code>data_from</code> notes the data source.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="https://doi.org/10.1126/science.aag1322">doi:10.1126/science.aag1322</a>Gostic et al. Science, (2016) for detailed methods.
</p>

<hr>
<h2 id='get_WHO_region'>Look up a country's WHO region</h2><span id='topic+get_WHO_region'></span>

<h3>Description</h3>

<p>Look up a country's WHO region
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_WHO_region(this.country)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_WHO_region_+3A_this.country">this.country</code></td>
<td>
<p>name of the input country (a string)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Name of the corresponding WHO region
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_WHO_region("Germany")
get_WHO_region("China")
</code></pre>

<hr>
<h2 id='plot_many_country_years'>Plot imprinting probabilities for up to five country-years</h2><span id='topic+plot_many_country_years'></span>

<h3>Description</h3>

<p>For each country and year, generate two plots:
</p>

<ul>
<li><p> A stacked barplot, where each bar represents a birth cohort, and
the colors within the bar show the probabilities that someone born
in that cohort has a particular imprinting status, for the first
observation year.
</p>
</li>
<li><p> A lineplot showing the age-specific probability of imprinting to
H3N2 in the first and last observation year. When the data contain
more than one observation year, this plot shows how cohorts age over
time.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>plot_many_country_years(imprinting_df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_many_country_years_+3A_imprinting_df">imprinting_df</code></td>
<td>
<p>A long data frame of imprinted probabilities output by <code><a href="#topic+get_imprinting_probabilities">get_imprinting_probabilities()</a></code>. Up to five countries and an arbitrary span of years can be plotted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. Opens a plot of the data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>imprinting_df &lt;- get_imprinting_probabilities(
  observation_years = c(1920, 1921),
  countries = c("Oman", "Indonesia")
)
plot_many_country_years(imprinting_df)
</code></pre>

<hr>
<h2 id='plot_one_country_year'>Plot imprinting probabilities for a single country and year</h2><span id='topic+plot_one_country_year'></span>

<h3>Description</h3>

<p>Generate a stacked barplot, where each bar represents a birth cohort, and the colors within the bar show the probabilities that someone born in that cohort has a particular imprinting status. If the data frame contains more than one country or observation year, the first country-year is plotted by default. Specify other countries and years using the country and year options.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_one_country_year(imprinting_df, country = NULL, year = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_one_country_year_+3A_imprinting_df">imprinting_df</code></td>
<td>
<p>A long data frame of imprinted probabilities output by <code><a href="#topic+get_imprinting_probabilities">get_imprinting_probabilities()</a></code>. If the data frame contains more than one country and year, on the first will be plotted.</p>
</td></tr>
<tr><td><code id="plot_one_country_year_+3A_country">country</code></td>
<td>
<p>An optional country name to plot. The input country name must exist in the imprinting_df.</p>
</td></tr>
<tr><td><code id="plot_one_country_year_+3A_year">year</code></td>
<td>
<p>Similar to country, and optional input specifying the year for which to plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. Opens a plot of the data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate imprinting probabilities for one country and year
imprinting_df &lt;- get_imprinting_probabilities(
  observation_years = 1920,
  countries = "Aruba"
)
plot_one_country_year(imprinting_df)

# If we generate probabilities for more than one country and year,
imprinting_df &lt;- get_imprinting_probabilities(
  observation_years = c(1922, 1925),
  countries = c(
    "Algeria",
    "South Africa"
  )
)

# The default is to plot the first country year in the outputs
plot_one_country_year(imprinting_df)

# Or, specify a country and year of interest (both must exist in the
# imprinting_df).
plot_one_country_year(imprinting_df,
  country = "South Africa",
  year = 1925
)

</code></pre>

<hr>
<h2 id='show_available_countries'>Show a list of all available countries</h2><span id='topic+show_available_countries'></span>

<h3>Description</h3>

<p>Lists all available countries, with valid spelling and formatting. Each country in the list matches or can be mapped to a country with data in <a href="https://apps.who.int/flumart/Default?ReportNo=12">WHO Flu Mart</a>. (Note: for convenience, this package sometimes uses different country names or spellings than Flu Mart.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_available_countries()
</code></pre>


<h3>Value</h3>

<p>A data frame of valid country names.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>show_available_countries()
</code></pre>

<hr>
<h2 id='show_available_regions'>Show all WHO regions</h2><span id='topic+show_available_regions'></span>

<h3>Description</h3>

<p>Lists all WHO regions, with valid spelling and formatting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_available_regions()
</code></pre>


<h3>Value</h3>

<p>A data frame of valid region names.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>show_available_regions()
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
