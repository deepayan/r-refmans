<!DOCTYPE html><html><head><title>Help for package AirMonitor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AirMonitor}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AirMonitor'><p>Air Quality Data Analysis</p></a></li>
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#addAQILegend'><p>Add an AQI legend to a map</p></a></li>
<li><a href='#addAQILines'><p>Add AQI lines to a plot</p></a></li>
<li><a href='#addAQIStackedBar'><p>Create stacked AQI bar</p></a></li>
<li><a href='#addShadedNight'><p>Add nighttime shading to a timeseries plot</p></a></li>
<li><a href='#AirFire_S3_archiveBaseUrl'><p>USFS maintained archive base URL</p></a></li>
<li><a href='#airnow_loadAnnual'><p>Load annual AirNow monitoring data</p></a></li>
<li><a href='#airnow_loadDaily'><p>Load daily AirNow monitoring data</p></a></li>
<li><a href='#airnow_loadLatest'><p>Load most recent AirNow monitoring data</p></a></li>
<li><a href='#airnow_loadMonthly'><p>Load monthly AirNow monitoring data</p></a></li>
<li><a href='#airsis_loadAnnual'><p>Load annual AIRSIS monitoring data</p></a></li>
<li><a href='#airsis_loadDaily'><p>Load daily AIRSIS monitoring data</p></a></li>
<li><a href='#airsis_loadLatest'><p>Load most recent AIRSIS monitoring data</p></a></li>
<li><a href='#aqiCategories'><p>Generate AQI categories</p></a></li>
<li><a href='#aqiColors'><p>Generate AQI colors</p></a></li>
<li><a href='#Camp_Fire'><p>Camp Fire example dataset</p></a></li>
<li><a href='#Carmel_Valley'><p>Carmel Valley example dataset</p></a></li>
<li><a href='#CONUS'><p>CONUS state codes</p></a></li>
<li><a href='#coreMetadataNames'><p>Names of standard metadata columns</p></a></li>
<li><a href='#epa_aqs_loadAnnual'><p>Load annual AirNow monitoring data</p></a></li>
<li><a href='#monitor_aqi'><p>Calculate hourly NowCast-based AQI values</p></a></li>
<li><a href='#monitor_arrange'><p>Order <em>mts_monitor</em> time series by metadata values</p></a></li>
<li><a href='#monitor_bestTimezone'><p>Return the most common timezone</p></a></li>
<li><a href='#monitor_check'><p>Check an <em>mts_monitor</em> object for validity.</p></a></li>
<li><a href='#monitor_collapse'><p>Collapse an <code>mts_monitor</code> object into a single time series</p></a></li>
<li><a href='#monitor_combine'><p>Combine multiple <code>mts_monitor</code> objects</p></a></li>
<li><a href='#monitor_dailyBarplot'><p>Create daily barplot</p></a></li>
<li><a href='#monitor_dailyStatistic'><p>Create daily statistics for each monitor in an <em>mts_monitor</em> object</p></a></li>
<li><a href='#monitor_dailyThreshold'><p>Daily counts of values at or above a threshold</p></a></li>
<li><a href='#monitor_distinct'><p>Retain only distinct data records in monitor$data</p></a></li>
<li><a href='#monitor_dropEmpty'><p>Drop device deployments with all missing data</p></a></li>
<li><a href='#monitor_dygraph'><p>Create Interactive Time Series Plot</p></a></li>
<li><a href='#monitor_filterByDistance'><p>Filter by distance from a target location</p></a></li>
<li><a href='#monitor_filterDate'><p>Date filtering for <em>mts_monitor</em> objects</p></a></li>
<li><a href='#monitor_filterDatetime'><p>Datetime filtering for <code>mts_monitor</code> objects</p></a></li>
<li><a href='#monitor_filterMeta'><p>General purpose metadata filtering for <em>mts_monitor</em> objects</p></a></li>
<li><a href='#monitor_fromPWFSLSmoke'><p>Convert a ws_monitor object from the PWFSLSmoke package</p></a></li>
<li><a href='#monitor_getCurrentStatus'><p>Get current status of monitors</p></a></li>
<li><a href='#monitor_getDataFrame'><p>Extract dataframes from <em>mts_monitor</em> objects</p></a></li>
<li><a href='#monitor_getDistance'><p>Calculate distances from <em>mts_monitor</em> locations to a location of interest</p></a></li>
<li><a href='#monitor_isEmpty'><p>Test for an empty <em>mts_monitor</em> object</p></a></li>
<li><a href='#monitor_isValid'><p>Test <em>mts_monitor</em> object for correct structure</p></a></li>
<li><a href='#monitor_leaflet'><p>Leaflet interactive map of monitor locations</p></a></li>
<li><a href='#monitor_load'><p>Load monitoring data from all sources</p></a></li>
<li><a href='#monitor_loadAnnual'><p>Load annual monitoring data from all sources</p></a></li>
<li><a href='#monitor_loadDaily'><p>Load daily monitoring data from all sources</p></a></li>
<li><a href='#monitor_loadLatest'><p>Load most recent monitoring data from all sources</p></a></li>
<li><a href='#monitor_mutate'><p>Apply a function to <em>mts_monitor</em> time series</p></a></li>
<li><a href='#monitor_nowcast'><p>Apply NowCast algorithm to <em>mts_monitor</em> data</p></a></li>
<li><a href='#monitor_pull'><p>Extract a column of metadata or data</p></a></li>
<li><a href='#monitor_replaceValues'><p>Replace <em>mts_monitor</em> data with another value</p></a></li>
<li><a href='#monitor_select'><p>Subset and reorder time series within an <em>mts_monitor</em> object</p></a></li>
<li><a href='#monitor_selectWhere'><p>Data-based subsetting of time series within an <em>mts_monitor</em> object.</p></a></li>
<li><a href='#monitor_setTimeAxis'><p>Extend/contract <em>mts_monitor</em> time series to new start and end times</p></a></li>
<li><a href='#monitor_slice_head'><p>Subset time series based on their position within an <em>mts_monitor</em> object</p></a></li>
<li><a href='#monitor_timeInfo'><p>Get time related information for a monitor</p></a></li>
<li><a href='#monitor_timeRange'><p>Get the time range for a monitor</p></a></li>
<li><a href='#monitor_timeseriesPlot'><p>Create timeseries plot</p></a></li>
<li><a href='#monitor_toAQCTable'><p>Convert monitor data into an AQI category table</p></a></li>
<li><a href='#monitor_toCSV'><p>Convert monitor data as CSV</p></a></li>
<li><a href='#monitor_toPWFSLSmoke'><p>Convert a mts_monitor object to a ws_monitor object for the PWFSLSmoke package</p></a></li>
<li><a href='#monitor_trimDate'><p>Trim a <em>mts_monitor</em> object to full days</p></a></li>
<li><a href='#NW_Megafires'><p>NW_Megafires example dataset</p></a></li>
<li><a href='#pollutantNames'><p>Names of standard pollutants</p></a></li>
<li><a href='#QC_invalidateConsecutiveSuspectValues'><p>Invalidate consecutive suspect values.</p></a></li>
<li><a href='#US_52'><p>US state codes</p></a></li>
<li><a href='#US_AQI'><p>US EPA AQI Index levels, names, colors and action text</p></a></li>
<li><a href='#wrcc_loadAnnual'><p>Load annual WRCC monitoring data</p></a></li>
<li><a href='#wrcc_loadDaily'><p>Load daily WRCC monitoring data</p></a></li>
<li><a href='#wrcc_loadLatest'><p>Load most recent WRCC monitoring data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.0</td>
</tr>
<tr>
<td>Title:</td>
<td>Air Quality Data Analysis</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jonathan Callahan &lt;jonathan.s.callahan@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Utilities for working with hourly air quality monitoring data
    with a focus on small particulates (PM2.5). A compact data model is 
    structured as a list with two dataframes. A 'meta' dataframe contains 
    spatial and measuring device metadata associated with deployments at known 
    locations. A 'data' dataframe contains a 'datetime' column followed by 
    columns of measurements associated with each "device-deployment".
    Algorithms to calculate NowCast and the associated Air Quality Index (AQI)
    are defined at the US Environmental Projection Agency AirNow program:
    <a href="https://www.airnow.gov/sites/default/files/2020-05/aqi-technical-assistance-document-sept2018.pdf">https://www.airnow.gov/sites/default/files/2020-05/aqi-technical-assistance-document-sept2018.pdf</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/MazamaScience/AirMonitor">https://github.com/MazamaScience/AirMonitor</a>,
<a href="https://mazamascience.github.io/AirMonitor/">https://mazamascience.github.io/AirMonitor/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/MazamaScience/AirMonitor/issues">https://github.com/MazamaScience/AirMonitor/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, dygraphs, leaflet, lubridate, magrittr, MazamaCoreUtils
(&ge; 0.5.2), MazamaRollUtils (&ge; 0.1.3), MazamaTimeSeries (&ge;
0.2.16), readr, rlang (&ge; 1.0.0), stringr, tidyselect, xts</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, markdown, testthat, rmarkdown, roxygen2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-10 06:26:57 UTC; jonathancallahan</td>
</tr>
<tr>
<td>Author:</td>
<td>Jonathan Callahan [aut, cre],
  Spencer Pease [ctb],
  Hans Martin [ctb],
  Rex Thompson [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-11 03:20:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='AirMonitor'>Air Quality Data Analysis</h2><span id='topic+AirMonitor'></span><span id='topic+AirMonitor-package'></span>

<h3>Description</h3>

<p><code>
Utilities for working with hourly air quality monitoring data
with a focus on small particulates (PM2.5). A compact data model is
structured as a list with two dataframes. A 'meta' dataframe contains
spatial and measuring device metadata associated with deployments at known
locations. A 'data' dataframe contains a 'datetime' column followed by
columns of measurements associated with each "device-deployment".
</code>
</p>

<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling 'rhs(lhs)'.
</p>

<hr>
<h2 id='addAQILegend'>Add an AQI legend to a map</h2><span id='topic+addAQILegend'></span>

<h3>Description</h3>

<p>This function is a convenience wrapper around
<code>graphics::legend()</code>. It will show the AQI colors and
names by default if <code>col</code> and <code>legend</code> are not specified.
</p>
<p>AQI categories are arranged with lower levels at the bottom of the legend
to match the arrangement in the plot. This is different from the default
&quot;reading order&quot; so you may wish to reverse the order of user supplied
arguments with <code>rev()</code> .
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addAQILegend(
  x = "topright",
  y = NULL,
  pollutant = c("PM2.5", "CO", "OZONE", "PM10", "AQI"),
  palette = c("EPA", "subdued", "deuteranopia"),
  languageCode = c("eng", "spa"),
  NAAQS = c("PM2.5", "PM2.5_2024"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addAQILegend_+3A_x">x</code></td>
<td>
<p>x Coordinate passed on to the <code>legend()</code> command.</p>
</td></tr>
<tr><td><code id="addAQILegend_+3A_y">y</code></td>
<td>
<p>y Coordinate passed on to the <code>legend()</code> command.</p>
</td></tr>
<tr><td><code id="addAQILegend_+3A_pollutant">pollutant</code></td>
<td>
<p>EPA AQS criteria pollutant.</p>
</td></tr>
<tr><td><code id="addAQILegend_+3A_palette">palette</code></td>
<td>
<p>Named color palette to use for AQI categories.</p>
</td></tr>
<tr><td><code id="addAQILegend_+3A_languagecode">languageCode</code></td>
<td>
<p>ISO 639-2 alpha-3 language code.</p>
</td></tr>
<tr><td><code id="addAQILegend_+3A_naaqs">NAAQS</code></td>
<td>
<p>Version of NAAQS levels to use. See Note.</p>
</td></tr>
<tr><td><code id="addAQILegend_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>legend()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components <code>rect</code> and <code>text</code> is returned
invisbly. (See <a href="graphics.html#topic+legend">legend</a>.)
</p>


<h3>Note</h3>

<p>On February 7, 2024, EPA strengthened the National Ambient Air Quality
Standards for Particulate Matter (PM NAAQS) to protect millions of Americans
from harmful and costly health impacts, such as heart attacks and premature
death. Particle or soot pollution is one of the most dangerous forms of air
pollution, and an extensive body of science links it to a range of serious
and sometimes deadly illnesses. EPA is setting the level of the primary
(health-based) annual PM2.5 standard at 9.0 micrograms per cubic meter to
provide increased public health protection, consistent with the available
health science.
See <a href="https://www.epa.gov/pm-pollution/final-reconsideration-national-ambient-air-quality-standards-particulate-matter-pm">PM NAAQS update</a>.
</p>

<hr>
<h2 id='addAQILines'>Add AQI lines to a plot</h2><span id='topic+addAQILines'></span>

<h3>Description</h3>

<p>Draws AQI lines across a plot at the levels appropriate for
The <a href="#topic+monitor_timeseriesPlot">monitor_timeseriesPlot</a> function uses this function internally when
specifying <code>addAQI = TRUE</code>.
<code>pollutant</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addAQILines(
  pollutant = c("PM2.5", "CO", "OZONE", "PM10", "AQI"),
  palette = c("EPA", "subdued", "deuteranopia"),
  NAAQS = c("PM2.5", "PM2.5_2024"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addAQILines_+3A_pollutant">pollutant</code></td>
<td>
<p>EPA AQS criteria pollutant.</p>
</td></tr>
<tr><td><code id="addAQILines_+3A_palette">palette</code></td>
<td>
<p>Named color palette to use for AQI categories.</p>
</td></tr>
<tr><td><code id="addAQILines_+3A_naaqs">NAAQS</code></td>
<td>
<p>Version of NAAQS levels to use. See Note.</p>
</td></tr>
<tr><td><code id="addAQILines_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code>abline()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called to add lines to a time series plot.
</p>


<h3>Note</h3>

<p>On February 7, 2024, EPA strengthened the National Ambient Air Quality
Standards for Particulate Matter (PM NAAQS) to protect millions of Americans
from harmful and costly health impacts, such as heart attacks and premature
death. Particle or soot pollution is one of the most dangerous forms of air
pollution, and an extensive body of science links it to a range of serious
and sometimes deadly illnesses. EPA is setting the level of the primary
(health-based) annual PM2.5 standard at 9.0 micrograms per cubic meter to
provide increased public health protection, consistent with the available
health science.
See <a href="https://www.epa.gov/pm-pollution/final-reconsideration-national-ambient-air-quality-standards-particulate-matter-pm">PM NAAQS update</a>.
</p>

<hr>
<h2 id='addAQIStackedBar'>Create stacked AQI bar</h2><span id='topic+addAQIStackedBar'></span>

<h3>Description</h3>

<p>Draws a stacked bar indicating AQI levels on one side of a plot
The <a href="#topic+monitor_timeseriesPlot">monitor_timeseriesPlot</a> function uses this function internally when
specifying <code>addAQI = TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addAQIStackedBar(
  pollutant = c("PM2.5", "CO", "OZONE", "PM10", "AQI"),
  palette = c("EPA", "subdued", "deuteranopia"),
  width = 0.01,
  height = 1,
  pos = c("left", "right"),
  NAAQS = c("PM2.5", "PM2.5_2024")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addAQIStackedBar_+3A_pollutant">pollutant</code></td>
<td>
<p>EPA AQS criteria pollutant.</p>
</td></tr>
<tr><td><code id="addAQIStackedBar_+3A_palette">palette</code></td>
<td>
<p>Named color palette to use for AQI categories.</p>
</td></tr>
<tr><td><code id="addAQIStackedBar_+3A_width">width</code></td>
<td>
<p>Width of the bar as a fraction of the width of the plot area.</p>
</td></tr>
<tr><td><code id="addAQIStackedBar_+3A_height">height</code></td>
<td>
<p>Height of the bar as a fraction of the height of the plot area.</p>
</td></tr>
<tr><td><code id="addAQIStackedBar_+3A_pos">pos</code></td>
<td>
<p>Position of the stacked bar relative to the plot.</p>
</td></tr>
<tr><td><code id="addAQIStackedBar_+3A_naaqs">NAAQS</code></td>
<td>
<p>Version of NAAQS levels to use. See Note.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called to add color bars to a time series plot.
</p>


<h3>Note</h3>

<p>On February 7, 2024, EPA strengthened the National Ambient Air Quality
Standards for Particulate Matter (PM NAAQS) to protect millions of Americans
from harmful and costly health impacts, such as heart attacks and premature
death. Particle or soot pollution is one of the most dangerous forms of air
pollution, and an extensive body of science links it to a range of serious
and sometimes deadly illnesses. EPA is setting the level of the primary
(health-based) annual PM2.5 standard at 9.0 micrograms per cubic meter to
provide increased public health protection, consistent with the available
health science.
See <a href="https://www.epa.gov/pm-pollution/final-reconsideration-national-ambient-air-quality-standards-particulate-matter-pm">PM NAAQS update</a>.
</p>

<hr>
<h2 id='addShadedNight'>Add nighttime shading to a timeseries plot</h2><span id='topic+addShadedNight'></span>

<h3>Description</h3>

<p>Draw shading rectangles on a plot to indicate nighttime hours.
The <a href="#topic+monitor_timeseriesPlot">monitor_timeseriesPlot</a> function uses this function internally when
specifying <code>shadedNight = TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addShadedNight(timeInfo, col = adjustcolor("black", 0.1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addShadedNight_+3A_timeinfo">timeInfo</code></td>
<td>
<p>dataframe as returned by <code>MazamaTimeSeries::monitor_timeInfo()</code></p>
</td></tr>
<tr><td><code id="addShadedNight_+3A_col">col</code></td>
<td>
<p>Color used to shade nights.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called to add day/night shading to a timeseries plot.
</p>

<hr>
<h2 id='AirFire_S3_archiveBaseUrl'>USFS maintained archive base URL</h2><span id='topic+AirFire_S3_archiveBaseUrl'></span>

<h3>Description</h3>

<p>The US Forest Service AirFire group maintains an archive of
processed monitoring data. The base URL for this archive is used as the
default in all <code>~_load()</code> functions.
</p>
<pre>
"https://airfire-data-exports.s3.us-west-2.amazonaws.com/monitoring/v2"
</pre>


<h3>Usage</h3>

<pre><code class='language-R'>AirFire_S3_archiveBaseUrl
</code></pre>


<h3>Format</h3>

<p>A url
</p>


<h3>Details</h3>

<p>AirFire_S3_archiveBaseUrl
</p>

<hr>
<h2 id='airnow_loadAnnual'>Load annual AirNow monitoring data</h2><span id='topic+airnow_loadAnnual'></span>

<h3>Description</h3>

<p>Loads pre-generated .rda files containing hourly AirNow data.
</p>
<p>If <code>archiveDataDir</code> is defined, data will be loaded from this local
archive. Otherwise, data will be loaded from the monitoring data repository
maintained by the USFS AirFire team.
</p>
<p>The files loaded by this function contain a single year's worth of data
</p>
<p>For the most recent data in the last 10 days, use <code>airnow_loadLatest()</code>.
</p>
<p>For daily updates covering the most recent 45 days, use <code>airnow_loadDaily()</code>.
</p>
<p>For archival data for a specific month, use <code>airnow_loadMonthly()</code>.
</p>
<p>Pre-processed AirNow exists for the following parameters:
</p>

<ol>
<li><p>PM2.5
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>airnow_loadAnnual(
  year = NULL,
  archiveBaseUrl = paste0("https://airfire-data-exports.s3.us-west-2.amazonaws.com/",
    "monitoring/v2"),
  archiveBaseDir = NULL,
  QC_negativeValues = c("zero", "na", "ignore"),
  parameterName = "PM2.5"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="airnow_loadAnnual_+3A_year">year</code></td>
<td>
<p>Year [YYYY].</p>
</td></tr>
<tr><td><code id="airnow_loadAnnual_+3A_archivebaseurl">archiveBaseUrl</code></td>
<td>
<p>Base URL for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="airnow_loadAnnual_+3A_archivebasedir">archiveBaseDir</code></td>
<td>
<p>Local base directory for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="airnow_loadAnnual_+3A_qc_negativevalues">QC_negativeValues</code></td>
<td>
<p>Type of QC to apply to negative values.</p>
</td></tr>
<tr><td><code id="airnow_loadAnnual_+3A_parametername">parameterName</code></td>
<td>
<p>One of the EPA AQS criteria parameter names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object with AirNow data. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+airnow_loadDaily">airnow_loadDaily</a></code>
</p>
<p><code><a href="#topic+airnow_loadLatest">airnow_loadLatest</a></code>
</p>
<p><code><a href="#topic+airnow_loadMonthly">airnow_loadMonthly</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AirMonitor)

# Fail gracefully if any resources are not available
try({

# See https://en.wikipedia.org/wiki/2017_Montana_wildfires

# Daily Barplot of Montana wildfires
airnow_loadAnnual(2017) \
  monitor_filter(stateCode == "MT") \
  monitor_filterDate(20170701, 20170930, timezone = "America/Denver") \
  monitor_dailyStatistic() \
  monitor_timeseriesPlot(
    ylim = c(0, 300),
    xpd = NA,
    addAQI = TRUE,
    main = "Montana 2017 -- AirNow Daily Average PM2.5"
  )

}, silent = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='airnow_loadDaily'>Load daily AirNow monitoring data</h2><span id='topic+airnow_loadDaily'></span>

<h3>Description</h3>

<p>Loads pre-generated .rda files containing hourly
AirNow data.
</p>
<p>If <code>archiveDataDir</code> is defined, data will be loaded from this local
archive. Otherwise, data will be loaded from the monitoring data repository
maintained by the USFS AirFire team.
</p>
<p>The files loaded by this function are updated once per day and
contain data for the previous 45 days.
</p>
<p>For the most recent data in the last 10 days, use <code>airnow_loadLatest()</code>.
</p>
<p>For data extended more than 45 days into the past, use <code>airnow_loadAnnual()</code>.
</p>
<p>Pre-processed AirNow exists for the following parameters:
</p>

<ol>
<li><p>PM2.5
</p>
</li>
<li><p>PM2.5_nowcast
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>airnow_loadDaily(
  archiveBaseUrl = paste0("https://airfire-data-exports.s3.us-west-2.amazonaws.com/",
    "monitoring/v2"),
  archiveBaseDir = NULL,
  QC_negativeValues = c("zero", "na", "ignore"),
  parameterName = "PM2.5"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="airnow_loadDaily_+3A_archivebaseurl">archiveBaseUrl</code></td>
<td>
<p>Base URL for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="airnow_loadDaily_+3A_archivebasedir">archiveBaseDir</code></td>
<td>
<p>Local base directory for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="airnow_loadDaily_+3A_qc_negativevalues">QC_negativeValues</code></td>
<td>
<p>Type of QC to apply to negative values.</p>
</td></tr>
<tr><td><code id="airnow_loadDaily_+3A_parametername">parameterName</code></td>
<td>
<p>One of the EPA AQS criteria parameter names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object with AirNow data. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+airnow_loadAnnual">airnow_loadAnnual</a></code>
</p>
<p><code><a href="#topic+airnow_loadLatest">airnow_loadLatest</a></code>
</p>
<p><code><a href="#topic+airnow_loadMonthly">airnow_loadMonthly</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AirMonitor)

# Fail gracefully if any resources are not available
try({

airnow_loadDaily() \
  monitor_filter(stateCode == "WA") \
  monitor_leaflet()

}, silent = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='airnow_loadLatest'>Load most recent AirNow monitoring data</h2><span id='topic+airnow_loadLatest'></span>

<h3>Description</h3>

<p>Loads pre-generated .rda files containing the most recent
AirNow data.
</p>
<p>If <code>archiveDataDir</code> is defined, data will be loaded from this local
archive. Otherwise, data will be loaded from the monitoring data repository
maintained by the USFS AirFire team.
</p>
<p>The files loaded by this function are updated multiple times an hour and
contain data for the previous 10 days.
</p>
<p>For daily updates covering the most recent 45 days, use <code>airnow_loadDaily()</code>.
</p>
<p>For data extended more than 45 days into the past, use <code>airnow_loadAnnual()</code>.
</p>
<p>Pre-processed AirNow exists for the following parameters:
</p>

<ol>
<li><p>PM2.5
</p>
</li>
<li><p>PM2.5_nowcast
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>airnow_loadLatest(
  archiveBaseUrl = paste0("https://airfire-data-exports.s3.us-west-2.amazonaws.com/",
    "monitoring/v2"),
  archiveBaseDir = NULL,
  QC_negativeValues = c("zero", "na", "ignore"),
  parameterName = "PM2.5"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="airnow_loadLatest_+3A_archivebaseurl">archiveBaseUrl</code></td>
<td>
<p>Base URL for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="airnow_loadLatest_+3A_archivebasedir">archiveBaseDir</code></td>
<td>
<p>Local base directory for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="airnow_loadLatest_+3A_qc_negativevalues">QC_negativeValues</code></td>
<td>
<p>Type of QC to apply to negative values.</p>
</td></tr>
<tr><td><code id="airnow_loadLatest_+3A_parametername">parameterName</code></td>
<td>
<p>One of the EPA AQS criteria parameter names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object with AirNow data. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+airnow_loadAnnual">airnow_loadAnnual</a></code>
</p>
<p><code><a href="#topic+airnow_loadDaily">airnow_loadDaily</a></code>
</p>
<p><code><a href="#topic+airnow_loadMonthly">airnow_loadMonthly</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AirMonitor)

# Fail gracefully if any resources are not available
try({

airnow_loadLatest() \
  monitor_filter(stateCode == "WA") \
  monitor_leaflet()

}, silent = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='airnow_loadMonthly'>Load monthly AirNow monitoring data</h2><span id='topic+airnow_loadMonthly'></span>

<h3>Description</h3>

<p>Loads pre-generated .rda files containing hourly AirNow data.
</p>
<p>If <code>archiveDataDir</code> is defined, data will be loaded from this local
archive. Otherwise, data will be loaded from the monitoring data repository
maintained by the USFS AirFire team.
</p>
<p>The files loaded by this function contain a single month's worth of data
</p>
<p>For the most recent data in the last 10 days, use <code>airnow_loadLatest()</code>.
</p>
<p>For daily updates covering the most recent 45 days, use <code>airnow_loadDaily()</code>.
</p>
<p>For data extended more than 45 days into the past, use <code>airnow_loadAnnual()</code>.
</p>
<p>Pre-processed AirNow exists for the following parameters:
</p>

<ol>
<li><p>PM2.5
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>airnow_loadMonthly(
  monthStamp = NULL,
  archiveBaseUrl = paste0("https://airfire-data-exports.s3.us-west-2.amazonaws.com/",
    "monitoring/v2"),
  archiveBaseDir = NULL,
  QC_negativeValues = c("zero", "na", "ignore"),
  parameterName = "PM2.5"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="airnow_loadMonthly_+3A_monthstamp">monthStamp</code></td>
<td>
<p>Year-month [YYYYmm].</p>
</td></tr>
<tr><td><code id="airnow_loadMonthly_+3A_archivebaseurl">archiveBaseUrl</code></td>
<td>
<p>Base URL for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="airnow_loadMonthly_+3A_archivebasedir">archiveBaseDir</code></td>
<td>
<p>Local base directory for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="airnow_loadMonthly_+3A_qc_negativevalues">QC_negativeValues</code></td>
<td>
<p>Type of QC to apply to negative values.</p>
</td></tr>
<tr><td><code id="airnow_loadMonthly_+3A_parametername">parameterName</code></td>
<td>
<p>One of the EPA AQS criteria parameter names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object with AirNow data. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>

<hr>
<h2 id='airsis_loadAnnual'>Load annual AIRSIS monitoring data</h2><span id='topic+airsis_loadAnnual'></span>

<h3>Description</h3>

<p>Loads pre-generated .rda files containing annual
AIRSIS data.
</p>
<p>If <code>archiveDataDir</code> is defined, data will be loaded from this local
archive. Otherwise, data will be loaded from the monitoring data repository
maintained by the USFS AirFire team.
</p>
<p>Current year files loaded by this function are updated once per week.
</p>
<p>For the most recent data in the last 10 days, use <code>airsis_loadLatest()</code>.
</p>
<p>For daily updates covering the most recent 45 days, use <code>airsis_loadDaily()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>airsis_loadAnnual(
  year = NULL,
  archiveBaseUrl = paste0("https://airfire-data-exports.s3.us-west-2.amazonaws.com/",
    "monitoring/v2"),
  archiveBaseDir = NULL,
  QC_negativeValues = c("zero", "na", "ignore"),
  QC_removeSuspectData = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="airsis_loadAnnual_+3A_year">year</code></td>
<td>
<p>Year [YYYY].</p>
</td></tr>
<tr><td><code id="airsis_loadAnnual_+3A_archivebaseurl">archiveBaseUrl</code></td>
<td>
<p>Base URL for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="airsis_loadAnnual_+3A_archivebasedir">archiveBaseDir</code></td>
<td>
<p>Local base directory for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="airsis_loadAnnual_+3A_qc_negativevalues">QC_negativeValues</code></td>
<td>
<p>Type of QC to apply to negative values.</p>
</td></tr>
<tr><td><code id="airsis_loadAnnual_+3A_qc_removesuspectdata">QC_removeSuspectData</code></td>
<td>
<p>Removes monitors determined to be misbehaving.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object with AIRSIS data. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>Some older AIRSIS timeseries contain only values of 0, 1000, 2000, 3000, ... ug/m3.
Data from these deployments pass instrument-level QC checks but these
timeseries generally do not represent valid data and should be removed.
With <code>QC_removeSuspectData = TRUE</code> (the default), data is checked and
periods reporting only values of 0:10 * 1000 ug/m3 are invalidated.
</p>
<p>Only those personally familiar with the individual instrument deployments
should work with the &quot;suspect&quot; data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+airsis_loadDaily">airsis_loadDaily</a></code>
</p>
<p><code><a href="#topic+airsis_loadLatest">airsis_loadLatest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AirMonitor)

# Fail gracefully if any resources are not available
try({

# See https://en.wikipedia.org/wiki/Camp_Fire_(2018)

# AIRSIS monitors during the Camp Fire
airsis_loadAnnual(2018) \
  monitor_filter(stateCode == "CA") \
  monitor_filterDate(20181101, 20181201) \
  monitor_dropEmpty() \
  monitor_leaflet()

}, silent = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='airsis_loadDaily'>Load daily AIRSIS monitoring data</h2><span id='topic+airsis_loadDaily'></span>

<h3>Description</h3>

<p>Loads pre-generated .rda files containing daily
AIRSIS data.
</p>
<p>If <code>archiveDataDir</code> is defined, data will be loaded from this local
archive. Otherwise, data will be loaded from the monitoring data repository
maintained by the USFS AirFire team.
</p>
<p>The files loaded by this function are updated once per day and
contain data for the previous 45 days.
</p>
<p>For the most recent data in the last 10 days, use <code>airsis_loadLatest()</code>.
</p>
<p>For data extended more than 45 days into the past, use <code>airsis_loadAnnual()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>airsis_loadDaily(
  archiveBaseUrl = paste0("https://airfire-data-exports.s3.us-west-2.amazonaws.com/",
    "monitoring/v2"),
  archiveBaseDir = NULL,
  QC_negativeValues = c("zero", "na", "ignore"),
  QC_removeSuspectData = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="airsis_loadDaily_+3A_archivebaseurl">archiveBaseUrl</code></td>
<td>
<p>Base URL for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="airsis_loadDaily_+3A_archivebasedir">archiveBaseDir</code></td>
<td>
<p>Local base directory for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="airsis_loadDaily_+3A_qc_negativevalues">QC_negativeValues</code></td>
<td>
<p>Type of QC to apply to negative values.</p>
</td></tr>
<tr><td><code id="airsis_loadDaily_+3A_qc_removesuspectdata">QC_removeSuspectData</code></td>
<td>
<p>Removes monitors determined to be misbehaving.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object with AIRSIS data. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>Some older AIRSIS timeseries contain only values of 0, 1000, 2000, 3000, ... ug/m3.
Data from these deployments pass instrument-level QC checks but these
timeseries generally do not represent valid data and should be removed.
With <code>QC_removeSuspectData = TRUE</code> (the default), data is checked and
periods reporting only values of 0:10 * 1000 ug/m3 are invalidated.
</p>
<p>Only those personally familiar with the individual instrument deployments
should work with the &quot;suspect&quot; data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+airsis_loadAnnual">airsis_loadAnnual</a></code>
</p>
<p><code><a href="#topic+airsis_loadLatest">airsis_loadLatest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AirMonitor)

# Fail gracefully if any resources are not available
try({

airsis_loadDaily()\ %&gt;\
  monitor_filter(stateCode == "CA") \
  monitor_leaflet()

}, silent = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='airsis_loadLatest'>Load most recent AIRSIS monitoring data</h2><span id='topic+airsis_loadLatest'></span>

<h3>Description</h3>

<p>Loads pre-generated .rda files containing the most recent
AIRSIS data.
</p>
<p>If <code>archiveDataDir</code> is defined, data will be loaded from this local
archive. Otherwise, data will be loaded from the monitoring data repository
maintained by the USFS AirFire team.
</p>
<p>The files loaded by this function are updated multiple times an hour and
contain data for the previous 10 days.
</p>
<p>For daily updates covering the most recent 45 days, use <code>airsis_loadDaily()</code>.
</p>
<p>For data extended more than 45 days into the past, use <code>airsis_loadAnnual()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>airsis_loadLatest(
  archiveBaseUrl = paste0("https://airfire-data-exports.s3.us-west-2.amazonaws.com/",
    "monitoring/v2"),
  archiveBaseDir = NULL,
  QC_negativeValues = c("zero", "na", "ignore"),
  QC_removeSuspectData = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="airsis_loadLatest_+3A_archivebaseurl">archiveBaseUrl</code></td>
<td>
<p>Base URL for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="airsis_loadLatest_+3A_archivebasedir">archiveBaseDir</code></td>
<td>
<p>Local base directory for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="airsis_loadLatest_+3A_qc_negativevalues">QC_negativeValues</code></td>
<td>
<p>Type of QC to apply to negative values.</p>
</td></tr>
<tr><td><code id="airsis_loadLatest_+3A_qc_removesuspectdata">QC_removeSuspectData</code></td>
<td>
<p>Removes monitors determined to be misbehaving.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object with AIRSIS data. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>Some older AIRSIS timeseries contain only values of 0, 1000, 2000, 3000, ... ug/m3.
Data from these deployments pass instrument-level QC checks but these
timeseries generally do not represent valid data and should be removed.
With <code>QC_removeSuspectData = TRUE</code> (the default), data is checked and
periods reporting only values of 0:10 * 1000 ug/m3 are invalidated.
</p>
<p>Only those personally familiar with the individual instrument deployments
should work with the &quot;suspect&quot; data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+airsis_loadAnnual">airsis_loadAnnual</a></code>
</p>
<p><code><a href="#topic+airsis_loadDaily">airsis_loadDaily</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AirMonitor)

# Fail gracefully if any resources are not available
try({

airsis_loadLatest()\ %&gt;\
  monitor_filter(stateCode == "CA") \
  monitor_leaflet()

}, silent = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='aqiCategories'>Generate AQI categories</h2><span id='topic+aqiCategories'></span>

<h3>Description</h3>

<p>This function converts hourly PM2.5 measurements into AQI category levels.
These levels can then be converted to colors or names using the arrays found
in <code><a href="#topic+US_AQI">US_AQI</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aqiCategories(
  x,
  pollutant = c("PM2.5", "AQI", "CO", "NO", "OZONE", "PM10", "SO2"),
  NAAQS = c("PM2.5", "PM2.5_2024"),
  conversionArray = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aqiCategories_+3A_x">x</code></td>
<td>
<p>Vector or matrix of PM2.5 values or an <em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="aqiCategories_+3A_pollutant">pollutant</code></td>
<td>
<p>EPA AQS criteria pollutant.</p>
</td></tr>
<tr><td><code id="aqiCategories_+3A_naaqs">NAAQS</code></td>
<td>
<p>Version of NAAQS levels to use. See Note.</p>
</td></tr>
<tr><td><code id="aqiCategories_+3A_conversionarray">conversionArray</code></td>
<td>
<p>Array of six text or other values to return instead of integers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, return values will be integers in the range 1:6 or <code>NA</code>. The
<code>conversionArray</code> parameter can be used to convert these integers into
whatever is specified in the first six elements of <code>conversionArray</code>. A
typical usage would be: <code>conversionArray = US_AQI$names_eng</code>.
</p>


<h3>Value</h3>

<p>A vector or matrix of AQI category indices in the range 1:6.
</p>


<h3>Note</h3>

<p>On February 7, 2024, EPA strengthened the National Ambient Air Quality
Standards for Particulate Matter (PM NAAQS) to protect millions of Americans
from harmful and costly health impacts, such as heart attacks and premature
death. Particle or soot pollution is one of the most dangerous forms of air
pollution, and an extensive body of science links it to a range of serious
and sometimes deadly illnesses. EPA is setting the level of the primary
(health-based) annual PM2.5 standard at 9.0 micrograms per cubic meter to
provide increased public health protection, consistent with the available
health science.
See <a href="https://www.epa.gov/pm-pollution/final-reconsideration-national-ambient-air-quality-standards-particulate-matter-pm">PM NAAQS update</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aqiColors">aqiColors</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

# Lane County, Oregon AQSIDs all begin with "41039"
LaneCounty &lt;-
  NW_Megafires %&gt;%
  monitor_filter(stringr::str_detect(AQSID, '^41039')) %&gt;%
  monitor_filterDate(20150822, 20150823)

LaneCounty %&gt;%
  aqiCategories()

LaneCounty %&gt;%
  aqiCategories(conversionArray = US_AQI$names_eng)
</code></pre>

<hr>
<h2 id='aqiColors'>Generate AQI colors</h2><span id='topic+aqiColors'></span>

<h3>Description</h3>

<p>This function uses the <code>leaflet::colorBin()</code> function to return a
vector or matrix of colors derived from data values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aqiColors(
  x,
  pollutant = c("PM2.5", "AQI", "CO", "NO", "OZONE", "PM10", "SO2"),
  palette = c("EPA", "subdued", "deuteranopia"),
  na.color = NA,
  NAAQS = c("PM2.5", "PM2.5_2024")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aqiColors_+3A_x">x</code></td>
<td>
<p>Vector or matrix of PM2.5 values or an <em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="aqiColors_+3A_pollutant">pollutant</code></td>
<td>
<p>EPA AQS criteria pollutant.</p>
</td></tr>
<tr><td><code id="aqiColors_+3A_palette">palette</code></td>
<td>
<p>Named color palette to use for AQI categories.</p>
</td></tr>
<tr><td><code id="aqiColors_+3A_na.color">na.color</code></td>
<td>
<p>Color assigned to missing values.</p>
</td></tr>
<tr><td><code id="aqiColors_+3A_naaqs">NAAQS</code></td>
<td>
<p>Version of NAAQS levels to use. See Note.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector or matrix of AQI colors to be used in maps and plots.
</p>


<h3>Note</h3>

<p>On February 7, 2024, EPA strengthened the National Ambient Air Quality
Standards for Particulate Matter (PM NAAQS) to protect millions of Americans
from harmful and costly health impacts, such as heart attacks and premature
death. Particle or soot pollution is one of the most dangerous forms of air
pollution, and an extensive body of science links it to a range of serious
and sometimes deadly illnesses. EPA is setting the level of the primary
(health-based) annual PM2.5 standard at 9.0 micrograms per cubic meter to
provide increased public health protection, consistent with the available
health science.
See <a href="https://www.epa.gov/pm-pollution/final-reconsideration-national-ambient-air-quality-standards-particulate-matter-pm">PM NAAQS update</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aqiCategories">aqiCategories</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

# Fancy plot based on pm2.5 values
pm2.5 &lt;- Carmel_Valley$data[,2]
Carmel_Valley %&gt;%
  monitor_timeseriesPlot(
    shadedNight = TRUE,
    pch = 16,
    cex = pmax(pm2.5 / 100, 0.5),
    col = aqiColors(pm2.5),
    opacity = 0.8
  )
</code></pre>

<hr>
<h2 id='Camp_Fire'>Camp Fire example dataset</h2><span id='topic+Camp_Fire'></span>

<h3>Description</h3>

<p>The <code>Camp_Fire</code> dataset provides a quickly loadable
version of a <em>mts_monitor</em> object for practicing and code examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Camp_Fire
</code></pre>


<h3>Format</h3>

<p>A <em>mts_monitor</em> object with 360 rows and 134 columns of data.
</p>


<h3>Details</h3>

<p>The 2018 Camp Fire was the deadliest and most destructive wildfire in California's
history, and the most expensive natural disaster in the world in 2018 in
terms of insured losses. The fire caused at least 85 civilian fatalities and
injured 12 civilians and five firefighters. It covered an area of 153,336
acres and destroyed more than 18,000 structures, most with the first 4 hours.
Smoke from the fire resulted in the worst air pollution ever for the
San Francisco Bay Area and Sacramento Valley.
</p>
<p>This dataset was was generated on 2022-10-12 by running:
</p>
<pre>
library(AirMonitor)

Camp_Fire &lt;-
  monitor_loadAnnual(2018) %&gt;%
  monitor_filter(stateCode == 'CA') %&gt;%
  monitor_filterDate(
    startdate = 20181108,
    enddate = 20181123,
    timezone = "America/Los_Angeles"
 ) %&gt;%
 monitor_dropEmpty()

save(Camp_Fire, file = "data/Camp_Fire.rda")
</pre>

<hr>
<h2 id='Carmel_Valley'>Carmel Valley example dataset</h2><span id='topic+Carmel_Valley'></span>

<h3>Description</h3>

<p>The <code>Carmel_Valley</code> dataset provides a quickly loadable
version of a <em>mts_monitor</em> object for practicing and code examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Carmel_Valley
</code></pre>


<h3>Format</h3>

<p>A <em>mts_monitor</em> object with 576 rows and 2 columns of data.
</p>


<h3>Details</h3>

<p>In August of 2016, the Soberanes fire in California burned along the Big Sur
coast. At the time, it was the most expensive wildfire in US history. This
dataset contains PM2.5 monitoring data for the monitor in Carmel Valley which
shows heavy smoke as well as strong diurnal cycles associated with sea
breezes. Data are stored as a <em>mts_monitor</em> object and are used in some
examples in the package documentation.
</p>
<p>This dataset was generated on 2022-10-12 by running:
</p>
<pre>
library(AirMonitor)

Carmel_Valley &lt;-
  airnow_loadAnnual(2016) %&gt;%
  monitor_filterMeta(deviceDeploymentID == "a9572a904a4ed46d_840060530002") %&gt;%
  monitor_filterDate(20160722, 20160815)

save(Carmel_Valley, file = "data/Carmel_Valley.rda")
</pre>

<hr>
<h2 id='CONUS'>CONUS state codes</h2><span id='topic+CONUS'></span>

<h3>Description</h3>

<p>State codes for the 48 contiguous states +DC that make up the CONtinental US.
</p>
<p><code>
CONUS &lt;- c(
  "AL","AZ","AR","CA","CO","CT","DE","FL","GA",
  "ID","IL","IN","IA","KS","KY","LA","ME","MD",
  "MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ",
  "NM","NY","NC","ND","OH","OK","OR","PA","RI","SC",
  "SD","TN","TX","UT","VT","VA","WA","WV","WI","WY",
  "DC"
)
</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CONUS
</code></pre>


<h3>Format</h3>

<p>A vector with 49 elements
</p>


<h3>Details</h3>

<p>CONUS state codes
</p>

<hr>
<h2 id='coreMetadataNames'>Names of standard metadata columns</h2><span id='topic+coreMetadataNames'></span>

<h3>Description</h3>

<p>Vector of names of the required <code>monitor$meta</code> columns.
These represent metadata columns that must exist in every valid
<em>mts_monitor</em> object. Any number of additional columns may also be present.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coreMetadataNames
</code></pre>


<h3>Format</h3>

<p>A vector of character strings
</p>


<h3>Details</h3>

<p>coreMetadataNames
</p>


<h3>Examples</h3>

<pre><code class='language-R'> print(coreMetadataNames, width = 80)
</code></pre>

<hr>
<h2 id='epa_aqs_loadAnnual'>Load annual AirNow monitoring data</h2><span id='topic+epa_aqs_loadAnnual'></span>

<h3>Description</h3>

<p>Loads pre-generated .rda files containing hourly AirNow data.
</p>
<p>If <code>archiveDataDir</code> is defined, data will be loaded from this local
archive. Otherwise, data will be loaded from the monitoring data repository
maintained by the USFS AirFire team.
</p>
<p>The files loaded by this function contain a single year's worth of data.
</p>
<p>Pre-processed AirNow exists for the following parameter codes:
</p>

<ol>
<li><p>88101 &ndash; PM2.5 FRM/FEM Mass
</p>
</li>
<li><p>88502 &ndash; PM2.5 non FRM/FEM Mass
</p>
</li></ol>

<p>Specifying <code>parameterCode = "PM2.5"</code> will merge records from both
sources.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epa_aqs_loadAnnual(
  year = NULL,
  archiveBaseUrl = paste0("https://airfire-data-exports.s3.us-west-2.amazonaws.com/",
    "monitoring/v2"),
  archiveBaseDir = NULL,
  QC_negativeValues = c("zero", "na", "ignore"),
  parameterCode = c("PM2.5", "88101", "88502")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="epa_aqs_loadAnnual_+3A_year">year</code></td>
<td>
<p>Year [YYYY].</p>
</td></tr>
<tr><td><code id="epa_aqs_loadAnnual_+3A_archivebaseurl">archiveBaseUrl</code></td>
<td>
<p>Base URL for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="epa_aqs_loadAnnual_+3A_archivebasedir">archiveBaseDir</code></td>
<td>
<p>Local base directory for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="epa_aqs_loadAnnual_+3A_qc_negativevalues">QC_negativeValues</code></td>
<td>
<p>Type of QC to apply to negative values.</p>
</td></tr>
<tr><td><code id="epa_aqs_loadAnnual_+3A_parametercode">parameterCode</code></td>
<td>
<p>One of the EPA AQS criteria parameter codes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object with EPA AQS data. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AirMonitor)

# Fail gracefully if any resources are not available
try({

# See https://en.wikipedia.org/wiki/2017_Montana_wildfires

# Daily Barplot of Montana wildfires
epa_aqs_loadAnnual(2015) \
  monitor_filter(stateCode == "WA") \
  monitor_filterDate(20150724, 20150907) \
  monitor_dailyStatistic() \
  monitor_timeseriesPlot(
    main = "Washington 2015 -- AirNow Daily Average PM2.5"
  )

}, silent = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='monitor_aqi'>Calculate hourly NowCast-based AQI values</h2><span id='topic+monitor_aqi'></span>

<h3>Description</h3>

<p>Nowcast and AQI algorithms are applied to the data in the
monitor object. A modified <code>mts_monitor</code> object is returned whre values
have been replaced with their Air Quality Index equivalents. See <a href="#topic+monitor_nowcast">monitor_nowcast</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_aqi(
  monitor,
  version = c("pm", "pmAsian", "ozone"),
  includeShortTerm = FALSE,
  NAAQS = c("PM2.5", "PM2.5_2024")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_aqi_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_aqi_+3A_version">version</code></td>
<td>
<p>Name of the type of nowcast algorithm to be used.</p>
</td></tr>
<tr><td><code id="monitor_aqi_+3A_includeshortterm">includeShortTerm</code></td>
<td>
<p>Logical specifying whether to alcluate preliminary
NowCast values starting with the 2nd hour.</p>
</td></tr>
<tr><td><code id="monitor_aqi_+3A_naaqs">NAAQS</code></td>
<td>
<p>Version of NAAQS levels to use. See Note.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified <code>mts_monitor</code> object containing AQI values. (A list
with <code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>On February 7, 2024, EPA strengthened the National Ambient Air Quality
Standards for Particulate Matter (PM NAAQS) to protect millions of Americans
from harmful and costly health impacts, such as heart attacks and premature
death. Particle or soot pollution is one of the most dangerous forms of air
pollution, and an extensive body of science links it to a range of serious
and sometimes deadly illnesses. EPA is setting the level of the primary
(health-based) annual PM2.5 standard at 9.0 micrograms per cubic meter to
provide increased public health protection, consistent with the available
health science.
See <a href="https://www.epa.gov/pm-pollution/final-reconsideration-national-ambient-air-quality-standards-particulate-matter-pm">PM NAAQS update</a>.
</p>


<h3>References</h3>

<p><a href="https://en.wikipedia.org/wiki/Nowcast_(Air_Quality_Index)">https://en.wikipedia.org/wiki/Nowcast_(Air_Quality_Index)</a>
</p>
<p><a href="https://www.airnow.gov/aqi/aqi-basics/">https://www.airnow.gov/aqi/aqi-basics/</a>
</p>

<hr>
<h2 id='monitor_arrange'>Order <em>mts_monitor</em> time series by metadata values</h2><span id='topic+monitor_arrange'></span>

<h3>Description</h3>

<p>The variable(s) in <code>...</code> are used to specify columns of
<code>monitor$meta</code> to use for ordering. Under the hood, this
function uses <code><a href="dplyr.html#topic+arrange">arrange</a></code> on <code>monitor$meta</code> and then
reorders <code>monitor$data</code> to match.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_arrange(monitor, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_arrange_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_arrange_+3A_...">...</code></td>
<td>
<p>variables in <code>mts$meta</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A reorderd version of the incoming <em>mts</em> time series object.
(A list with <code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>See Also</h3>

<p><a href="#topic+monitor_select">monitor_select</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

Camp_Fire$meta$elevation[1:10]

byElevation &lt;-
  Camp_Fire %&gt;%
  monitor_arrange(elevation)

byElevation$meta$elevation[1:10]

</code></pre>

<hr>
<h2 id='monitor_bestTimezone'>Return the most common timezone</h2><span id='topic+monitor_bestTimezone'></span>

<h3>Description</h3>

<p>Evaluates all timezones in <code>monitor</code> and returns the
most common one. In the case of a tie, the alphabetically first one is
returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_bestTimezone(monitor = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_bestTimezone_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A valid <code>base::OlsonNames()</code> timezone.
</p>

<hr>
<h2 id='monitor_check'>Check an <em>mts_monitor</em> object for validity.</h2><span id='topic+monitor_check'></span>

<h3>Description</h3>

<p>Checks on the validity of an <em>mts_monitor</em> object. If any test
fails, this function will stop with a warning message.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_check(monitor)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_check_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns <code>TRUE</code> if <code>mts_monitor</code> has the correct
structure. Stops with an error message otherwise.
</p>

<hr>
<h2 id='monitor_collapse'>Collapse an <code>mts_monitor</code> object into a single time series</h2><span id='topic+monitor_collapse'></span>

<h3>Description</h3>

<p>Collapses data from all time series in a <code>mts_monitor</code> into a
single-time series <em>mts_monitor</em> object using the function provided in the
<code>FUN</code> argument. The single-time series result will be located at the mean
longitude and latitude unless <code>longitude</code> and <code>latitude</code>
parameters are specified.
</p>
<p>Any columns of <code>monitor$meta</code> that are constant across all records will
be retained in the returned <em>mts_monitor</em> <code>meta</code> dataframe.
</p>
<p>The core metadata associated with this location (<em>e.g.</em>
<code>countryCode, stateCode, timezone, ...</code>) will be determined from
the most common (or average) value found in <code>monitor$meta</code>. This will be
a reasonable assumption for the vast majority of intended use cases where
data from multiple instruments in close proximity are averaged together.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_collapse(
  monitor,
  longitude = NULL,
  latitude = NULL,
  deviceID = "generatedID",
  FUN = mean,
  na.rm = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_collapse_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_collapse_+3A_longitude">longitude</code></td>
<td>
<p>Longitude of the collapsed time series.</p>
</td></tr>
<tr><td><code id="monitor_collapse_+3A_latitude">latitude</code></td>
<td>
<p>Latitude of the collapsed time series.</p>
</td></tr>
<tr><td><code id="monitor_collapse_+3A_deviceid">deviceID</code></td>
<td>
<p>Device identifier for the collapsed time series.</p>
</td></tr>
<tr><td><code id="monitor_collapse_+3A_fun">FUN</code></td>
<td>
<p>Function used to collapse multiple time series.</p>
</td></tr>
<tr><td><code id="monitor_collapse_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical specifying whether NA values should be ignored when FUN
is applied.</p>
</td></tr>
<tr><td><code id="monitor_collapse_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed on to the <code>apply()</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object representing a single time series. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>After <code>FUN</code> is applied, values of <code>+/-Inf</code> and <code>NaN</code> are
converted to <code>NA</code>. This is a convenience for the common case where
<code>FUN = min/max</code> or <code>FUN = mean</code> and some of the time steps have all
missing values. See the R documentation for <code>min</code> for an explanation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

# Lane County, Oregon AQSIDs all begin with "41039"
LaneCounty &lt;-
  NW_Megafires %&gt;%
  monitor_filter(stringr::str_detect(AQSID, '^41039')) %&gt;%
  monitor_filterDate(20150821, 20150828)

# Get min/max for all monitors
LaneCounty_min &lt;- monitor_collapse(LaneCounty, deviceID = 'LaneCounty_min', FUN = min)
LaneCounty_max &lt;- monitor_collapse(LaneCounty, deviceID = 'LaneCounty_max', FUN = max)

# Create plot
monitor_timeseriesPlot(
  LaneCounty,
  shadedNight = TRUE,
  main = "Lane County Range of PM2.5 Values"
)

# Add min/max lines
monitor_timeseriesPlot(LaneCounty_max, col = 'red', type = 's', add = TRUE)
monitor_timeseriesPlot(LaneCounty_min, col = 'blue', type = 's', add = TRUE)
</code></pre>

<hr>
<h2 id='monitor_combine'>Combine multiple <code>mts_monitor</code> objects</h2><span id='topic+monitor_combine'></span>

<h3>Description</h3>

<p>Create a combined <em>mts_monitor</em> from any number of <em>mts_monitor</em>
objects or from a list of <em>mts_monitor</em> objects. The resulting <em>mts_monitor</em>
object with contain all <code>deviceDeploymentIDs</code> found in any incoming
<em>mts_monitor</em> and will have a regular time axis covering the the entire range
of incoming data.
</p>
<p>If incoming time ranges are tempporally non-contiguous, the resulting
<em>mts_monitor</em> will have gaps filled with <code>NA</code> values.
</p>
<p>An error is generated if the incoming <em>mts_monitor</em> objects have
non-identical metadata for the same <code>deviceDeploymentID</code> unless
<code>replaceMeta = TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_combine(
  ...,
  replaceMeta = FALSE,
  overlapStrategy = c("replace all", "replace na")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_combine_+3A_...">...</code></td>
<td>
<p>Any number of valid <em>mts_monitor</em> objects or a list of objects.</p>
</td></tr>
<tr><td><code id="monitor_combine_+3A_replacemeta">replaceMeta</code></td>
<td>
<p>Logical specifying whether to allow replacement of metadata
associated when duplicate <code>deviceDeploymentIDs</code> are encountered.</p>
</td></tr>
<tr><td><code id="monitor_combine_+3A_overlapstrategy">overlapStrategy</code></td>
<td>
<p>Strategy to use when data found in time series
overlaps.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A combined <code>mts_monitor</code> object. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>Data are combined with a &quot;later is better&quot; sensibility where any
data overlaps exist. Incoming <em>mts_monitor</em> objects are ordered based on the
time stamp of their last record. Any data records found in a &quot;later&quot; <em>mts_monitor</em>
will overwrite data associated with an &quot;earlier&quot; <em>mts_monitor</em>.
</p>
<p>With <code>overlapStrategy = "replace all"</code>, any data records found
in &quot;later&quot; <em>mts_monitor</em> objects are preferentially retained before the &quot;shared&quot;
data are finally reordered by ascending <code>datetime</code>.
</p>
<p>With <code>overlapStrategy = "replace missing"</code>, only missing values in &quot;earlier&quot;
<em>mts_monitor</em> objects are replaced with data records from &quot;later&quot; time series.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

# Two monitors near Pendelton, Oregon
#
# Use the interactive map to get the deviceDeploymentIDs
#   NW_Megafires %&gt;% monitor_leaflet()

Pendleton_West &lt;-
  NW_Megafires %&gt;%
  monitor_select("f187226671d1109a_410590121_03") %&gt;%
  monitor_filterDatetime(2015082300, 2015082305)

Pendleton_East &lt;-
  NW_Megafires %&gt;%
  monitor_select("6c906c6d1cf46b53_410597002_02") %&gt;%
  monitor_filterDatetime(2015082300, 2015082305)

monitor_combine(Pendleton_West, Pendleton_East) %&gt;%
  monitor_getData()

</code></pre>

<hr>
<h2 id='monitor_dailyBarplot'>Create daily barplot</h2><span id='topic+monitor_dailyBarplot'></span>

<h3>Description</h3>

<p>Creates a daily barplot of data from a <em>mts_monitor</em> object.
</p>
<p>Reasonable defaults are chosen for annotations and plot characteristics.
Users can override any defaults by passing in parameters accepted by
<code>graphics::barplot</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_dailyBarplot(
  monitor = NULL,
  id = NULL,
  add = FALSE,
  addAQI = FALSE,
  palette = c("EPA", "subdued", "deuteranopia"),
  opacity = NULL,
  minHours = 18,
  dayBoundary = c("clock", "LST"),
  NAAQS = c("PM2.5", "PM2.5_2024"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_dailyBarplot_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_dailyBarplot_+3A_id">id</code></td>
<td>
<p><code>deviceDeploymentID</code> for a single time series found in <code>monitor</code>.
(Optional if <code>monitor</code> contains only a single time series.)</p>
</td></tr>
<tr><td><code id="monitor_dailyBarplot_+3A_add">add</code></td>
<td>
<p>Logical specifying whether to add to the current plot.</p>
</td></tr>
<tr><td><code id="monitor_dailyBarplot_+3A_addaqi">addAQI</code></td>
<td>
<p>Logical specifying whether to add visual AQI decorations.</p>
</td></tr>
<tr><td><code id="monitor_dailyBarplot_+3A_palette">palette</code></td>
<td>
<p>Named color palette to use when adding AQI decorations.</p>
</td></tr>
<tr><td><code id="monitor_dailyBarplot_+3A_opacity">opacity</code></td>
<td>
<p>Opacity to use for bars.</p>
</td></tr>
<tr><td><code id="monitor_dailyBarplot_+3A_minhours">minHours</code></td>
<td>
<p>Minimum number of valid hourly records per day required to
calculate statistics. Days with fewer valid records will be assigned <code>NA</code>.</p>
</td></tr>
<tr><td><code id="monitor_dailyBarplot_+3A_dayboundary">dayBoundary</code></td>
<td>
<p>Treatment of daylight savings time:  &quot;clock&quot; uses daylight
savings time as defined in the local timezone, &quot;LST&quot; uses &quot;local standard time&quot;
all year round.</p>
</td></tr>
<tr><td><code id="monitor_dailyBarplot_+3A_naaqs">NAAQS</code></td>
<td>
<p>Version of NAAQS levels to use. See Note.</p>
</td></tr>
<tr><td><code id="monitor_dailyBarplot_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>graphics::barplot()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. This function is called to draw an air quality
daily average plot on the active graphics device.
</p>


<h3>Note</h3>

<p>The underlying axis for this plot is not a time axis so you cannot use this
function to &quot;add&quot; bars on top of a <code>monitor_timeseriesPlot()</code>. See
the <span class="pkg">AirMonitorPlots</span> package for more flexibility in plotting.
</p>
<p>On February 7, 2024, EPA strengthened the National Ambient Air Quality
Standards for Particulate Matter (PM NAAQS) to protect millions of Americans
from harmful and costly health impacts, such as heart attacks and premature
death. Particle or soot pollution is one of the most dangerous forms of air
pollution, and an extensive body of science links it to a range of serious
and sometimes deadly illnesses. EPA is setting the level of the primary
(health-based) annual PM2.5 standard at 9.0 micrograms per cubic meter to
provide increased public health protection, consistent with the available
health science.
See <a href="https://www.epa.gov/pm-pollution/final-reconsideration-national-ambient-air-quality-standards-particulate-matter-pm">PM NAAQS update</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

layout(matrix(seq(2)))

Carmel_Valley %&gt;% monitor_dailyBarplot()
title("(pre-2024 PM NAAQS)", line = 0)

Carmel_Valley %&gt;% monitor_dailyBarplot(NAAQS = "PM2.5_2024")
title("(updated PM NAAQS)", line = 0)

layout(1)

</code></pre>

<hr>
<h2 id='monitor_dailyStatistic'>Create daily statistics for each monitor in an <em>mts_monitor</em> object</h2><span id='topic+monitor_dailyStatistic'></span>

<h3>Description</h3>

<p>Daily statstics are calculated for each time series in <code>monitor$data</code>
using <code>FUN</code> and any arguments passed in <code>...</code>.
</p>
<p>Because the returned <em>mts_monitor</em> object is defined on a daily axis in a
specific time zone, it is important that the incoming <code>monitor</code> contain
timeseries associated with a single time zone.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_dailyStatistic(
  monitor = NULL,
  FUN = mean,
  na.rm = TRUE,
  minHours = 18,
  dayBoundary = c("clock", "LST"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_dailyStatistic_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_dailyStatistic_+3A_fun">FUN</code></td>
<td>
<p>Function used to create daily statistics.</p>
</td></tr>
<tr><td><code id="monitor_dailyStatistic_+3A_na.rm">na.rm</code></td>
<td>
<p>Value passed on to <code>FUN</code>. If <code>FUN</code> does not use
<code>na.rm</code>, this should be set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="monitor_dailyStatistic_+3A_minhours">minHours</code></td>
<td>
<p>Minimum number of valid hourly records per day required to
calculate statistics. Days with fewer valid records will be assigned <code>NA</code>.</p>
</td></tr>
<tr><td><code id="monitor_dailyStatistic_+3A_dayboundary">dayBoundary</code></td>
<td>
<p>Treatment of daylight savings time:  &quot;clock&quot; uses daylight
savings time as defined in the local timezone, &quot;LST&quot; uses &quot;local standard time&quot;
all year round.</p>
</td></tr>
<tr><td><code id="monitor_dailyStatistic_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object containing daily statistical summaries. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>When <code>dayBoundary = "clock"</code>, the returned <code>monitor$data$datetime</code>
time axis will be defined in the local timezone (not &quot;UTC&quot;) with days defined
by midnight as it appears on a clock in that timezone. The transition from
DST to standard time will result in a 23 hour day and standard to DST in a
25 hour day.
</p>
<p>When <code>dayBoundary = "LST"</code>, the returned <code>monitor$data$datetime</code>
time axis will be defined in &quot;UTC&quot; with times as they <em>appear</em> in standard
time in the local timezone. These days will be one hour off from clock
time during DST but every day will consist of 24 hours.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

Carmel_Valley %&gt;%
  monitor_dailyStatistic(max) %&gt;%
  monitor_getData()

Carmel_Valley %&gt;%
  monitor_dailyStatistic(min) %&gt;%
  monitor_getData()
</code></pre>

<hr>
<h2 id='monitor_dailyThreshold'>Daily counts of values at or above a threshold</h2><span id='topic+monitor_dailyThreshold'></span>

<h3>Description</h3>

<p>Calculates the number of hours per day each time series in <code>monitor</code> was
at or above a given threshold.
</p>
<p>Because the returned <em>mts_monitor</em> object is defined on a daily axis in a
specific time zone, it is important that the incoming <code>monitor</code> contain
only timeseries within a single time zone.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_dailyThreshold(
  monitor = NULL,
  threshold = NULL,
  na.rm = TRUE,
  minHours = 18,
  dayBoundary = c("clock", "LST"),
  NAAQS = c("PM2.5", "PM2.5_2024")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_dailyThreshold_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_dailyThreshold_+3A_threshold">threshold</code></td>
<td>
<p>AQI level name (e.g. <code>"unhealthy"</code>) or numerical
threshold at and above which a measurement is counted.</p>
</td></tr>
<tr><td><code id="monitor_dailyThreshold_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical value indicating whether NA values should be ignored.</p>
</td></tr>
<tr><td><code id="monitor_dailyThreshold_+3A_minhours">minHours</code></td>
<td>
<p>Minimum number of valid hourly records per day required to
calculate statistics. Days with fewer valid records will be assigned <code>NA</code>.</p>
</td></tr>
<tr><td><code id="monitor_dailyThreshold_+3A_dayboundary">dayBoundary</code></td>
<td>
<p>Treatment of daylight savings time:  &quot;clock&quot; uses daylight
savings time as defined in the local timezone, &quot;LST&quot; uses &quot;local standard time&quot;
all year round.</p>
</td></tr>
<tr><td><code id="monitor_dailyThreshold_+3A_naaqs">NAAQS</code></td>
<td>
<p>Version of NAAQS levels to use. See Note.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object containing daily counts of hours at or above
a threshold value. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>When <code>dayBoundary = "clock"</code>, the returned <code>monitor$data$datetime</code>
time axis will be defined in the local timezone (not &quot;UTC&quot;) with days defined
by midnight as it appears on a clock in that timezone. The transition from
DST to standard time will result in a 23 hour day and standard to DST in a
25 hour day.
</p>
<p>When <code>dayBoundary = "LST"</code>, the returned <code>monitor$data$datetime</code>
time axis will be defined in &quot;UTC&quot; with times as they <em>appear</em> in standard
time in the local timezone. These days will be one hour off from clock
time during DST but every day will consist of 24 hours.
</p>
<p>On February 7, 2024, EPA strengthened the National Ambient Air Quality
Standards for Particulate Matter (PM NAAQS) to protect millions of Americans
from harmful and costly health impacts, such as heart attacks and premature
death. Particle or soot pollution is one of the most dangerous forms of air
pollution, and an extensive body of science links it to a range of serious
and sometimes deadly illnesses. EPA is setting the level of the primary
(health-based) annual PM2.5 standard at 9.0 micrograms per cubic meter to
provide increased public health protection, consistent with the available
health science.
See <a href="https://www.epa.gov/pm-pollution/final-reconsideration-national-ambient-air-quality-standards-particulate-matter-pm">PM NAAQS update</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

# Hours at MODERATE or above
Carmel_Valley %&gt;%
  monitor_dailyThreshold("Moderate") %&gt;%
  monitor_getData()

# Hours at MODERATE or above with the 2024 updated NAAQS
Carmel_Valley %&gt;%
  monitor_dailyThreshold("Moderate", NAAQS = "PM2.5_2024") %&gt;%
  monitor_getData()

# Hours at UNHEALTHY or above
Carmel_Valley %&gt;%
  monitor_dailyThreshold("Unhealthy") %&gt;%
  monitor_getData()

</code></pre>

<hr>
<h2 id='monitor_distinct'>Retain only distinct data records in monitor$data</h2><span id='topic+monitor_distinct'></span>

<h3>Description</h3>

<p>Two successive steps are used to guarantee that the
<code>datetime</code> axis contains no repeated values:
</p>

<ol>
<li><p>remove any duplicate records
</p>
</li>
<li><p>guarantee that rows are in <code>datetime</code> order
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>monitor_distinct(monitor)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_distinct_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object with no duplicated data records. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>This function is primarily for package-internal use.
</p>

<hr>
<h2 id='monitor_dropEmpty'>Drop device deployments with all missing data</h2><span id='topic+monitor_dropEmpty'></span>

<h3>Description</h3>

<p>The incoming <em>mts_monitor</em> object is subset to retain
only time series with valid data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_dropEmpty(monitor)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_dropEmpty_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object. (A list with
<code>meta</code> and <code>data</code> dataframes.)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A subset of the incoming <code>mts_monitor</code>. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>

<hr>
<h2 id='monitor_dygraph'>Create Interactive Time Series Plot</h2><span id='topic+monitor_dygraph'></span>

<h3>Description</h3>

<p>This function creates interactive graphs that will be displayed
in RStudio's 'Viewer' tab.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_dygraph(
  monitor,
  title = "title",
  ylab = "PM2.5 Concentration",
  rollPeriod = 1,
  showLegend = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_dygraph_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_dygraph_+3A_title">title</code></td>
<td>
<p>Title text.</p>
</td></tr>
<tr><td><code id="monitor_dygraph_+3A_ylab">ylab</code></td>
<td>
<p>Title for the y axis</p>
</td></tr>
<tr><td><code id="monitor_dygraph_+3A_rollperiod">rollPeriod</code></td>
<td>
<p>Rolling mean to be applied to the data.</p>
</td></tr>
<tr><td><code id="monitor_dygraph_+3A_showlegend">showLegend</code></td>
<td>
<p>Logical to toggle display of the legend.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Initiates the interactive dygraph plot in RStudio's 'Viewer' tab.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AirMonitor)

# Multiple monitors
Camp_Fire %&gt;%
  monitor_filter(countyName == "Alameda") %&gt;%
  monitor_dygraph()

## End(Not run)
</code></pre>

<hr>
<h2 id='monitor_filterByDistance'>Filter by distance from a target location</h2><span id='topic+monitor_filterByDistance'></span>

<h3>Description</h3>

<p>Filters the <code>monitor</code> argument to include only those time series
located within a certain radius of a target location. If no time series fall
within the specified <code>radius</code>, an empty <em>mts_monitor</em> object will
be returned.
</p>
<p>When <code>count</code> is used, a <em>mts_monitor</em> object is
created containing <strong>up to</strong> <code>count</code> time series, ordered by
increasing distance from the target location. Note that the number
of monitors returned may be less than the specified <code>count</code> value if
fewer than <code>count</code> time series are found within the target area.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_filterByDistance(
  monitor,
  longitude = NULL,
  latitude = NULL,
  radius = 50,
  count = NULL,
  addToMeta = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_filterByDistance_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_filterByDistance_+3A_longitude">longitude</code></td>
<td>
<p>Target longitude.</p>
</td></tr>
<tr><td><code id="monitor_filterByDistance_+3A_latitude">latitude</code></td>
<td>
<p>Target.</p>
</td></tr>
<tr><td><code id="monitor_filterByDistance_+3A_radius">radius</code></td>
<td>
<p>Distance (m) of radius defining a target area.</p>
</td></tr>
<tr><td><code id="monitor_filterByDistance_+3A_count">count</code></td>
<td>
<p>Number of time series to return.</p>
</td></tr>
<tr><td><code id="monitor_filterByDistance_+3A_addtometa">addToMeta</code></td>
<td>
<p>Logical specifying whether to add <code>distanceFromTarget</code>
as a field in <code>monitor$meta</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object with monitors near a location.
</p>


<h3>Note</h3>

<p>The returned <em>mts_monitor</em> will have an extra <code>distance</code>.  (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

# Walla Walla
longitude &lt;- -118.330278
latitude &lt;- 46.065

Walla_Walla_monitors &lt;-
  NW_Megafires %&gt;%
  monitor_filterByDistance(
    longitude = -118.330,
    latitude = 46.065,
    radius = 50000,     # 50 km
    addToMeta = TRUE
  )

Walla_Walla_monitors %&gt;%
  monitor_getMeta() %&gt;%
  dplyr::select(c("locationName", "distanceFromTarget"))

</code></pre>

<hr>
<h2 id='monitor_filterDate'>Date filtering for <em>mts_monitor</em> objects</h2><span id='topic+monitor_filterDate'></span>

<h3>Description</h3>

<p>Subsets a <em>mts_monitor</em> object by date. This function
always filters to day-boundaries. For sub-day filtering, use
<code>monitor_filterDatetime()</code>.
</p>
<p>Dates can be anything that is understood by <code>MazamaCoreUtils::parseDatetime()</code>
including either of the following recommended formats:
</p>

<ul>
<li><p><code>"YYYYmmdd"</code>
</p>
</li>
<li><p><code>"YYYY-mm-dd"</code>
</p>
</li></ul>

<p>If either <code>startdate</code> or <code>enddate</code> is not provided, the start/end of
the <em>mts_monitor</em> time axis will be used.
</p>
<p>Timezone determination precedence assumes that if you are passing in
<code>POSIXct</code> values then you know what you are doing.
</p>

<ol>
<li><p>get timezone from <code>startdate</code> if it is <code>POSIXct</code>
</p>
</li>
<li><p>use passed in <code>timezone</code>
</p>
</li>
<li><p>get timezone from <code>mts_monitor</code>
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>monitor_filterDate(
  monitor = NULL,
  startdate = NULL,
  enddate = NULL,
  timezone = NULL,
  unit = "sec",
  ceilingStart = FALSE,
  ceilingEnd = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_filterDate_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_filterDate_+3A_startdate">startdate</code></td>
<td>
<p>Desired start datetime (ISO 8601).</p>
</td></tr>
<tr><td><code id="monitor_filterDate_+3A_enddate">enddate</code></td>
<td>
<p>Desired end datetime (ISO 8601).</p>
</td></tr>
<tr><td><code id="monitor_filterDate_+3A_timezone">timezone</code></td>
<td>
<p>Olson timezone used to interpret dates.</p>
</td></tr>
<tr><td><code id="monitor_filterDate_+3A_unit">unit</code></td>
<td>
<p>Units used to determine time at end-of-day.</p>
</td></tr>
<tr><td><code id="monitor_filterDate_+3A_ceilingstart">ceilingStart</code></td>
<td>
<p>Logical instruction to apply
<code><a href="lubridate.html#topic+ceiling_date">ceiling_date</a></code> to the <code>startdate</code> rather than
<code><a href="lubridate.html#topic+floor_date">floor_date</a></code></p>
</td></tr>
<tr><td><code id="monitor_filterDate_+3A_ceilingend">ceilingEnd</code></td>
<td>
<p>Logical instruction to apply
<code><a href="lubridate.html#topic+ceiling_date">ceiling_date</a></code> to the <code>enddate</code> rather than
<code><a href="lubridate.html#topic+floor_date">floor_date</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A subset of the given <em>mts_monitor</em> object. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>The returned data will run from the beginning of <code>startdate</code> until
the <strong>beginning</strong> of <code>enddate</code> &ndash; <em>i.e.</em> no values associated
with <code>enddate</code> will be returned. The exception being when
<code>enddate</code> is less than 24 hours after <code>startdate</code>. In that case, a
single day is returned.
</p>


<h3>See Also</h3>

<p><a href="#topic+monitor_filterDatetime">monitor_filterDatetime</a>
</p>
<p><a href="#topic+monitor_filterMeta">monitor_filterMeta</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

Camp_Fire %&gt;%
  monitor_timeRange()

# Day boundaries returned in "UTC"
Camp_Fire %&gt;%
  monitor_filterDate(
    "2018-11-15",
    "2018-11-22",
    timezone = "America/Los_Angeles"
  ) %&gt;%
  monitor_timeRange()

# Day boundaries returned in "America/Los_Angeles"
Camp_Fire %&gt;%
  monitor_filterDatetime(
    "20181115",
    "20181122",
    timezone = "America/Los_Angeles"
  ) %&gt;%
  monitor_timeRange(
    timezone = "America/Los_Angeles"
  )

</code></pre>

<hr>
<h2 id='monitor_filterDatetime'>Datetime filtering for <code>mts_monitor</code> objects</h2><span id='topic+monitor_filterDatetime'></span>

<h3>Description</h3>

<p>Subsets a <em>mts_monitor</em> object by datetime. This function
allows for sub-day filtering as opposed to <code>monitor_filterDate()</code> which
always filters to day-boundaries.
</p>
<p>Datetimes can be anything that is understood by
<code>MazamaCoreUtils::parseDatetime()</code>. For non-<code>POSIXct</code> values,
the recommended format is <code>"YYYY-mm-dd HH:MM:SS"</code>.
</p>
<p>If either <code>startdate</code> or <code>enddate</code> is not provided, the start/end of
the <em>mts_monitor</em> time axis will be used.
</p>
<p>Timezone determination precedence assumes that if you are passing in
<code>POSIXct</code> values then you know what you are doing.
</p>

<ol>
<li><p>get timezone from <code>startdate</code> if it is <code>POSIXct</code>
</p>
</li>
<li><p>use passed in <code>timezone</code>
</p>
</li>
<li><p>get timezone from <code>mts_monitor</code>
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>monitor_filterDatetime(
  monitor = NULL,
  startdate = NULL,
  enddate = NULL,
  timezone = NULL,
  unit = "sec",
  ceilingStart = FALSE,
  ceilingEnd = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_filterDatetime_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_filterDatetime_+3A_startdate">startdate</code></td>
<td>
<p>Desired start datetime (ISO 8601).</p>
</td></tr>
<tr><td><code id="monitor_filterDatetime_+3A_enddate">enddate</code></td>
<td>
<p>Desired end datetime (ISO 8601).</p>
</td></tr>
<tr><td><code id="monitor_filterDatetime_+3A_timezone">timezone</code></td>
<td>
<p>Olson timezone used to interpret <code>startdate</code> and <code>enddate</code>.</p>
</td></tr>
<tr><td><code id="monitor_filterDatetime_+3A_unit">unit</code></td>
<td>
<p>Units used to determine time at end-of-day.</p>
</td></tr>
<tr><td><code id="monitor_filterDatetime_+3A_ceilingstart">ceilingStart</code></td>
<td>
<p>Logical specifying application of
<code><a href="lubridate.html#topic+ceiling_date">ceiling_date</a></code> to the <code>startdate</code> rather than
<code><a href="lubridate.html#topic+floor_date">floor_date</a></code></p>
</td></tr>
<tr><td><code id="monitor_filterDatetime_+3A_ceilingend">ceilingEnd</code></td>
<td>
<p>Logical specifying application of
<code><a href="lubridate.html#topic+ceiling_date">ceiling_date</a></code> to the <code>enddate</code> rather than
<code><a href="lubridate.html#topic+floor_date">floor_date</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A subset of the given <em>mts_monitor</em> object. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>See Also</h3>

<p><a href="#topic+monitor_filterDate">monitor_filterDate</a>
</p>
<p><a href="#topic+monitor_filterMeta">monitor_filterMeta</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

Camp_Fire %&gt;%
  monitor_timeRange()

# Reduced time range returned in "UTC"
Camp_Fire %&gt;%
  monitor_filterDatetime(
    "2018-11-15 02:00:00",
    "2018-11-22 06:00:00",
    timezone = "America/Los_Angeles"
  ) %&gt;%
  monitor_timeRange()

# Reduced time range returned in "America/Los_Angeles"
Camp_Fire %&gt;%
  monitor_filterDatetime(
    "2018111502",
    "2018112206",
    timezone = "America/Los_Angeles"
  ) %&gt;%
  monitor_timeRange(
    timezone = "America/Los_Angeles"
  )

</code></pre>

<hr>
<h2 id='monitor_filterMeta'>General purpose metadata filtering for <em>mts_monitor</em> objects</h2><span id='topic+monitor_filterMeta'></span><span id='topic+monitor_filter'></span>

<h3>Description</h3>

<p>A generalized metadata filter for <em>mts_monitor</em> objects to
choose cases where conditions are true.  Multiple conditions are
combined with <code>&amp;</code> or separated by a comma. Only rows where the condition
evaluates to TRUE are kept. Rows of <code>monitor$meta</code> where the condition
evaluates to <code>NA</code> are dropped. Associated olumns of <code>monitor$data</code>
are also dropped for internal consistency in the returned <em>mts_monitor</em>
object.
</p>
<p><code>monitor_filter()</code> is an alias for <code>monitor_filterMeta()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_filterMeta(monitor, ...)

monitor_filter(monitor, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_filterMeta_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_filterMeta_+3A_...">...</code></td>
<td>
<p>Logical predicates defined in terms of the variables in
<code>monitor$meta</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A subset of the incoming <code>mts_monitor</code>. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>Filtering is done on variables in <code>monitor$meta</code>.
</p>


<h3>See Also</h3>

<p><a href="#topic+monitor_filterDate">monitor_filterDate</a>
</p>
<p><a href="#topic+monitor_filterDatetime">monitor_filterDatetime</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

# Filter based on countyName field
Camp_Fire %&gt;%
  monitor_filter(countyName == "Alameda") %&gt;%
  monitor_timeseriesPlot(main = "All Alameda County Monitors")

# Filter combining two fields
Camp_Fire %&gt;%
  monitor_filter(latitude &gt; 39.5, longitude &gt; -121.5) %&gt;%
  monitor_pull("locationName")

# Filter using string matching
Camp_Fire %&gt;%
  monitor_filter(stringr::str_detect(locationName, "^San")) %&gt;%
  monitor_pull("locationName")

</code></pre>

<hr>
<h2 id='monitor_fromPWFSLSmoke'>Convert a ws_monitor object from the PWFSLSmoke package</h2><span id='topic+monitor_fromPWFSLSmoke'></span>

<h3>Description</h3>

<p>A <span class="pkg">PWFSLSmoke</span> package <em>ws_monitor</em> object is enhanced
and modified so that it becomes a valid <em>mts_monitor</em> object. This is
a lossless operation and can be reversed with <code>monitor_toPWFSLSmoke()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_fromPWFSLSmoke(ws_monitor = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_fromPWFSLSmoke_+3A_ws_monitor">ws_monitor</code></td>
<td>
<p><em>ws_monitor</em> object. (A list with
<code>meta</code> and <code>data</code> dataframes.)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object.
</p>

<hr>
<h2 id='monitor_getCurrentStatus'>Get current status of monitors</h2><span id='topic+monitor_getCurrentStatus'></span>

<h3>Description</h3>

<p>This function augments <code>monitor$meta</code> with summary information derived
from <code>monitor$data</code> reflecting recent measurements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_getCurrentStatus(
  monitor,
  enddate = NULL,
  minHours = 18,
  dayBoundary = c("clock", "LST")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_getCurrentStatus_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_getCurrentStatus_+3A_enddate">enddate</code></td>
<td>
<p>Time relative to which current status is calculated. By
default, it is the latest time in <code>monitor$data$datetime</code>. This time can
be given as a POSIXct time, or a string/numeric value in ymd format (<em>e.g.</em>
20190301). This time converted to UTC.</p>
</td></tr>
<tr><td><code id="monitor_getCurrentStatus_+3A_minhours">minHours</code></td>
<td>
<p>Minimum number of valid hourly records required to calculate
<code>yesterday_PM2.5_avg</code>. Days with fewer valid records will be assigned <code>NA</code>.</p>
</td></tr>
<tr><td><code id="monitor_getCurrentStatus_+3A_dayboundary">dayBoundary</code></td>
<td>
<p>Treatment of daylight savings time:  &quot;clock&quot; uses daylight
savings time as defined in the local timezone, &quot;LST&quot; uses &quot;local standard time&quot;
all year round. (See <code>monitor_dailyStatistic()</code> for more details.)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>monitor$meta</code> table augmented with current status
information for each time series.
</p>


<h3>&quot;Last&quot; and &quot;Previous&quot;</h3>

<p>The goal of this function is to provide useful information about what
happened recently with each time series in the provided <em>mts_monitor</em> object.
Devices don't always consistently report data, however, and it is not alwlays
useful to have <code>NA</code>'s reported when there is recent valid data at earlier
times. To address this, <code>monitor_getCurrentStatus()</code> uses <em>last</em> and
<em>previous</em> valid times. These are the time when a monitor most recently
reported data, and the most recent time of valid data before that,
respectively. By reporting on these times, this function ensures that valid
data is returned and provides information on how outdated this information
is. This information can be used in maps to show AQI colored dots when data
is only a few hours old but gray dots when data is older than some threshold.
</p>


<h3>Calculating latency</h3>

<p>According to https://docs.airnowapi.org/docs/HourlyDataFactSheet.pdf
a datum assigned to 2pm represents the average of data between 2pm and 3pm.
So, if we check at 3:15pm and see that we have a value for 2pm but not 3pm
then the data are completely up-to-date with zero latency.
</p>
<p><code>monitor_getCurrentStatus()</code> defines latency as the difference between
a time index and the next most recent time index associated with a
valid value. If there is no more recent time index, then the difference is
measured to the given <code>enddate</code> parameter. Because <em>mts_monitor</em>
objects are defined on an hourly axis, these differences have units of hours.
</p>
<p>For example, if the recorded values for a monitor are
<code>[16.2, 15.8, 16.4, NA, 14.0, 12.5, NA, NA, 13.3, NA]</code>, then the <em>last</em>
valid value is 13.3 with an index is 9, and the <em>previous</em> valid value is 12.4
with an index of 6. The <em>last</em> latency is then 1 (hour before the end), and the
<em>previous</em> latency is 3 (hours before the last valid value).
</p>


<h3>Summary data</h3>

<p>The table created by <code>monitor_getCurrentStatus()</code> includes per-time series
summary information calculated from <code>monitor$data</code>.
The additional data fields added to <code>monitor$meta</code> are listed below:
</p>

<dl>
<dt>currentStatus_processingTime</dt><dd><p>Time at which this function was run</p>
</dd>
<dt>currentStatus_enddate</dt><dd><p>Time relative to which &quot;currency&quot; is calculated</p>
</dd>
<dt>last_validIndex</dt><dd><p>Row index of the last valid mesurement in <code>monitor$data</code></p>
</dd>
<dt>previous_validIndex</dt><dd><p>Row index of the previous valid measurement in <code>monitor$data</code></p>
</dd>
<dt>last_validTime</dt><dd><p>UTC time associated with <code>last_validIndex</code></p>
</dd>
<dt>previous_validTime</dt><dd><p>UTC time associated with <code>previous_validIndex</code></p>
</dd>
<dt>last_latency</dt><dd><p>Hours between <code>last_validTime</code> and <code>endtime</code></p>
</dd>
<dt>previous_latency</dt><dd><p>Hours between <code>previous_validTime</code> and<code>last_validTime</code></p>
</dd>
<dt>last_validLocalTimestamp</dt><dd><p>Local time representation of <code>last_validTime</code></p>
</dd>
<dt>previous_validLocalTimestamp</dt><dd><p>Local time representation of <code>previous_validTime</code></p>
</dd>
<dt>last_PM2.5</dt><dd><p>Last valid PM2.5 measurement</p>
</dd>
<dt>previous_PM2.5</dt><dd><p>Previous valid PM2.5 measurement</p>
</dd>
<dt>last_nowcast</dt><dd><p>Last valid PM2.5 NowCast value</p>
</dd>
<dt>previous_nowcast</dt><dd><p>Previous valid PM2.5 NowCast value</p>
</dd>
<dt>yesterday_PM2.5_avg</dt><dd><p>Daily average PM2.5 for the day prior to <code>enddate</code></p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# Fail gracefully if any resources are not available
try({

library(AirMonitor)

monitor &lt;- airnow_loadLatest()
# TODO:  Needed before rebuilding of v2 database with fullAQSID
monitor$meta$fullAQSID &lt;- paste0("840", monitor$meta$AQSID)

currentStatus &lt;-
  monitor %&gt;%
  monitor_filter(stateCode == "WA") %&gt;%
  monitor_getCurrentStatus()

}, silent = FALSE)

</code></pre>

<hr>
<h2 id='monitor_getDataFrame'>Extract dataframes from <em>mts_monitor</em> objects</h2><span id='topic+monitor_getDataFrame'></span><span id='topic+monitor_getData'></span><span id='topic+monitor_getMeta'></span>

<h3>Description</h3>

<p>These functions are convenient wrappers for extracting the dataframes that
comprise a <em>mts_monitor</em> object. These functions are designed to be
useful when manipulating data in a pipeline using <code>%&gt;%</code>.
</p>
<p>Below is a table showing equivalent operations for each function.
</p>

<table>
<tr>
 <td style="text-align: left;">
  <strong>Function</strong> </td><td style="text-align: left;"> <strong>Equivalent Operation</strong></td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>monitor_getData(monitor)</code> </td><td style="text-align: left;"> <code>monitor$data</code></td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>monitor_getMeta(monitor)</code> </td><td style="text-align: left;"> <code>monitor$meta</code>
</td>
</tr>

</table>



<h3>Usage</h3>

<pre><code class='language-R'>monitor_getData(monitor)

monitor_getMeta(monitor)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_getDataFrame_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object to extract dataframe from.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe from the given <em>mts_monitor</em> object.
</p>

<hr>
<h2 id='monitor_getDistance'>Calculate distances from <em>mts_monitor</em> locations to a location of interest</h2><span id='topic+monitor_getDistance'></span>

<h3>Description</h3>

<p>This function returns the distances (meters) between <code>monitor</code> locations
and a location of interest. These distances can be used to create a
mask identifying monitors within a certain radius of the location of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_getDistance(
  monitor = NULL,
  longitude = NULL,
  latitude = NULL,
  measure = c("geodesic", "haversine", "vincenty", "cheap")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_getDistance_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_getDistance_+3A_longitude">longitude</code></td>
<td>
<p>Longitude of the location of interest.</p>
</td></tr>
<tr><td><code id="monitor_getDistance_+3A_latitude">latitude</code></td>
<td>
<p>Latitude of the location of interest.</p>
</td></tr>
<tr><td><code id="monitor_getDistance_+3A_measure">measure</code></td>
<td>
<p>One of &quot;geodesic&quot;, &quot;haversine&quot; &quot;vincenty&quot;, or &quot;cheap&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named vector of distances (meters) with each distance identified
by <code>deviceDeploymentID</code>.
</p>


<h3>Note</h3>

<p>The measure <code>"cheap"</code> may be used to speed things up depending on
the spatial scale being considered. Distances calculated with
<code>measure = "cheap"</code> will vary by a few meters compared with those
calculated using <code>measure = "geodesic"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

# Walla Walla
longitude &lt;- -118.3302
latitude &lt;- 46.065

distance &lt;- monitor_getDistance(NW_Megafires, longitude, latitude)
closestIndex &lt;- which(distance == min(distance))

# Distance in meters
distance[closestIndex]

# Monitor core metadata
str(NW_Megafires$meta[closestIndex, AirMonitor::coreMetadataNames])

</code></pre>

<hr>
<h2 id='monitor_isEmpty'>Test for an empty <em>mts_monitor</em> object</h2><span id='topic+monitor_isEmpty'></span>

<h3>Description</h3>

<p>This function returns true under the following conditions:
</p>

<ul>
<li><p>no time series: <code>ncol(monitor$data) == 1</code>
</p>
</li>
<li><p>no time series records: <code>nrow(monitor$data) == 0</code>
</p>
</li>
<li><p>all timeseries values are <code>NA</code>
</p>
</li></ul>

<p>This makes for more readable code in functions that need to test for this.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_isEmpty(monitor)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_isEmpty_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns <code>TRUE</code> if no data exist in <code>mts_monitor</code>, <code>FALSE</code> otherwise.
</p>

<hr>
<h2 id='monitor_isValid'>Test <em>mts_monitor</em> object for correct structure</h2><span id='topic+monitor_isValid'></span>

<h3>Description</h3>

<p>The <code>mts_monitor</code> is checked for the presence of core
<code>meta</code> and <code>data</code> columns.
</p>
<p>Core <code>meta</code> columns include: (TODO:  complete this list)
</p>

<ul>
<li><p><code>deviceDeploymentID</code> &ndash; unique identifier (see <span class="pkg">MazmaLocationUtils</span>)
</p>
</li>
<li><p><code>deviceID</code> &ndash; device identifier
</p>
</li>
<li><p><code>locationID</code> &ndash; location identifier (see <span class="pkg">MazmaLocationUtils</span>)
</p>
</li>
<li><p><code>locationName</code> &ndash; English language name
</p>
</li>
<li><p><code>longitude</code> &ndash; decimal degrees E
</p>
</li>
<li><p><code>latitude</code> &ndash; decimal degrees N
</p>
</li>
<li><p><code>elevation</code> &ndash; elevation of station in m
</p>
</li>
<li><p><code>countryCode</code> &ndash; ISO 3166-1 alpha-2
</p>
</li>
<li><p><code>stateCode</code> &ndash; ISO 3166-2 alpha-2
</p>
</li>
<li><p><code>timezone</code> &ndash; Olson time zone
</p>
</li></ul>

<p>Core <code>data</code> columns include:
</p>

<ul>
<li><p><code>datetime</code> &ndash; measurement time (UTC)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>monitor_isValid(monitor = NULL, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_isValid_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object</p>
</td></tr>
<tr><td><code id="monitor_isValid_+3A_verbose">verbose</code></td>
<td>
<p>Logical specifying whether to produce detailed warning messages.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns <code>TRUE</code> if <code>mts_monitor</code> has the correct
structure, <code>FALSE</code> otherwise.
</p>

<hr>
<h2 id='monitor_leaflet'>Leaflet interactive map of monitor locations</h2><span id='topic+monitor_leaflet'></span>

<h3>Description</h3>

<p>This function creates interactive maps that will be displayed in RStudio's
'Viewer' tab. The <code>slice</code> argument is used to collapse a
<em>mts_monitor</em> timeseries into a single value. If <code>slice</code> is an
integer, that row index will be selected from the <code>monitor$data</code>
dataframe. If <code>slice</code> is a function (unquoted), that function will be
applied to the timeseries with the argument <code>na.rm=TRUE</code> (e.g.
<code>max(..., na.rm=TRUE)</code>).
</p>
<p>If <code>slice</code> is a user defined function, it will be used with argument
<code>na.rm=TRUE</code> to collapse the time dimension. Thus, user defined
functions must accept <code>na.rm</code> as an argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_leaflet(
  monitor,
  slice = "max",
  radius = 10,
  opacity = 0.7,
  maptype = "terrain",
  extraVars = NULL,
  jitter = 5e-04,
  NAAQS = c("PM2.5", "PM2.5_2024"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_leaflet_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_leaflet_+3A_slice">slice</code></td>
<td>
<p>Either a formatted time string, a time index, the name of a
(potentially user defined) function used to collapse the time axis.</p>
</td></tr>
<tr><td><code id="monitor_leaflet_+3A_radius">radius</code></td>
<td>
<p>radius of monitor circles</p>
</td></tr>
<tr><td><code id="monitor_leaflet_+3A_opacity">opacity</code></td>
<td>
<p>opacity of monitor circles</p>
</td></tr>
<tr><td><code id="monitor_leaflet_+3A_maptype">maptype</code></td>
<td>
<p>optional name of leaflet ProviderTiles to use, e.g. &quot;terrain&quot;</p>
</td></tr>
<tr><td><code id="monitor_leaflet_+3A_extravars">extraVars</code></td>
<td>
<p>Character vector of additional column names from <code>monitor$meta</code>
to be shown in leaflet popups.</p>
</td></tr>
<tr><td><code id="monitor_leaflet_+3A_jitter">jitter</code></td>
<td>
<p>Amount to use to slightly adjust locations so that multiple
monitors at the same location can be seen. Use zero or <code>NA</code> to see
precise locations.</p>
</td></tr>
<tr><td><code id="monitor_leaflet_+3A_naaqs">NAAQS</code></td>
<td>
<p>Version of NAAQS levels to use. See Note.</p>
</td></tr>
<tr><td><code id="monitor_leaflet_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>leaflet::addCircleMarker()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>maptype</code> argument is mapped onto leaflet &quot;ProviderTile&quot; names.
Current map types include:
</p>

<dl>
<dt>&quot;roadmap&quot;</dt><dd><p> &ndash; &quot;OpenStreetMap&quot;</p>
</dd>
<dt>&quot;satellite&quot;</dt><dd><p> &ndash; &quot;Esri.WorldImagery&quot;</p>
</dd>
<dt>&quot;terrain&quot;</dt><dd><p> &ndash; &quot;Esri.WorldTopoMap&quot;</p>
</dd>
<dt>&quot;toner&quot;</dt><dd><p> &ndash; &quot;Stamen.Toner&quot;</p>
</dd>
</dl>

<p>If a character string not listed above is provided, it will be used as the
underlying map tile if available. See
<a href="https://leaflet-extras.github.io/leaflet-providers/">https://leaflet-extras.github.io/leaflet-providers/</a> for a list of
&quot;provider tiles&quot; to use as the background map.
</p>


<h3>Value</h3>

<p>Invisibly returns a leaflet map of class &quot;leaflet&quot;.
</p>


<h3>Note</h3>

<p>On February 7, 2024, EPA strengthened the National Ambient Air Quality
Standards for Particulate Matter (PM NAAQS) to protect millions of Americans
from harmful and costly health impacts, such as heart attacks and premature
death. Particle or soot pollution is one of the most dangerous forms of air
pollution, and an extensive body of science links it to a range of serious
and sometimes deadly illnesses. EPA is setting the level of the primary
(health-based) annual PM2.5 standard at 9.0 micrograms per cubic meter to
provide increased public health protection, consistent with the available
health science.
See <a href="https://www.epa.gov/pm-pollution/final-reconsideration-national-ambient-air-quality-standards-particulate-matter-pm">PM NAAQS update</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AirMonitor)
# Fail gracefully if any resources are not available
try({

# Maximum AQI category at each site
monitor_loadLatest() %&gt;%
  monitor_filter(stateCode %in% CONUS) %&gt;%
  monitor_leaflet()

# Mean AQI category at each site
monitor_loadLatest() %&gt;%
  monitor_filter(stateCode %in% CONUS) %&gt;%
  monitor_leaflet(
    slice = "mean"
  )

# Mean AQI category at each site using the updated NAAQS
monitor_loadLatest() %&gt;%
  monitor_filter(stateCode %in% CONUS) %&gt;%
  monitor_leaflet(
    slice = "mean",
    NAAQS = "PM2.5_2024"
  )

}, silent = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='monitor_load'>Load monitoring data from all sources</h2><span id='topic+monitor_load'></span>

<h3>Description</h3>

<p>Loads monitoring data for a given time range. Data from AirNow,
AIRSIS and WRCC are combined into a single <em>mts_monitor</em> object.
</p>
<p>Archival datasets are combined with 'daily' and 'latest' datasets as needed to
satisfy the requested date range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_load(
  startdate = NULL,
  enddate = NULL,
  timezone = NULL,
  archiveBaseUrl = paste0("https://airfire-data-exports.s3.us-west-2.amazonaws.com/",
    "monitoring/v2"),
  archiveBaseDir = NULL,
  QC_negativeValues = c("zero", "na", "ignore"),
  epaPreference = c("airnow", "epa_aqs")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_load_+3A_startdate">startdate</code></td>
<td>
<p>Desired start datetime (ISO 8601).</p>
</td></tr>
<tr><td><code id="monitor_load_+3A_enddate">enddate</code></td>
<td>
<p>Desired end datetime (ISO 8601).</p>
</td></tr>
<tr><td><code id="monitor_load_+3A_timezone">timezone</code></td>
<td>
<p>Olson timezone used to interpret dates.</p>
</td></tr>
<tr><td><code id="monitor_load_+3A_archivebaseurl">archiveBaseUrl</code></td>
<td>
<p>Base URL for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="monitor_load_+3A_archivebasedir">archiveBaseDir</code></td>
<td>
<p>Local base directory for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="monitor_load_+3A_qc_negativevalues">QC_negativeValues</code></td>
<td>
<p>Type of QC to apply to negative values.
files are available from both 'epa' and 'airnow'.</p>
</td></tr>
<tr><td><code id="monitor_load_+3A_epapreference">epaPreference</code></td>
<td>
<p>Preferred data source for EPA data when annual data
files are available from both 'epa_aqs' and 'airnow'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object with PM2.5 monitoring data. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+monitor_loadAnnual">monitor_loadAnnual</a></code>
</p>
<p><code><a href="#topic+monitor_loadDaily">monitor_loadDaily</a></code>
</p>
<p><code><a href="#topic+monitor_loadLatest">monitor_loadLatest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AirMonitor)

# Fail gracefully if any resources are not available
try({

wa &lt;-
  monitor_load(20210601, 20211001) %&gt;%
  monitor_filter(stateCode == "WA")

monitor_timeseriesPlot(wa)

}, silent = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='monitor_loadAnnual'>Load annual monitoring data from all sources</h2><span id='topic+monitor_loadAnnual'></span>

<h3>Description</h3>

<p>Combine annual data from AirNow, AIRSIS and WRCC:
</p>
<p>If <code>archiveDataDir</code> is defined, data will be loaded from this local
archive. Otherwise, data will be loaded from the monitoring data repository
maintained by the USFS AirFire team.
</p>
<p>Current year files loaded by this function are updated once per week.
</p>
<p>For the most recent data in the last 10 days, use <code>monitor_loadLatest()</code>.
</p>
<p>For daily updates covering the most recent 45 days, use <code>monitor_loadDaily()</code>.
</p>
<p>For data extended more than 45 days into the past, use <code>monitor_load()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_loadAnnual(
  year = NULL,
  archiveBaseUrl = paste0("https://airfire-data-exports.s3.us-west-2.amazonaws.com/",
    "monitoring/v2"),
  archiveBaseDir = NULL,
  QC_negativeValues = c("zero", "na", "ignore"),
  epaPreference = c("airnow", "epa_aqs")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_loadAnnual_+3A_year">year</code></td>
<td>
<p>Year [YYYY].</p>
</td></tr>
<tr><td><code id="monitor_loadAnnual_+3A_archivebaseurl">archiveBaseUrl</code></td>
<td>
<p>Base URL for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="monitor_loadAnnual_+3A_archivebasedir">archiveBaseDir</code></td>
<td>
<p>Local base directory for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="monitor_loadAnnual_+3A_qc_negativevalues">QC_negativeValues</code></td>
<td>
<p>Type of QC to apply to negative values.</p>
</td></tr>
<tr><td><code id="monitor_loadAnnual_+3A_epapreference">epaPreference</code></td>
<td>
<p>Preferred data source for EPA data when annual data
files are available from both 'epa_aqs' and 'airnow'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object with PM2.5 monitoring data. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>This function guarantees that only a single time series will be
associated with each <code>locationID</code> using the following logic:
</p>

<ol>
<li><p>AirNow data takes precedence over data from AIRSIS or WRCC
</p>
</li>
<li><p>more recent data takes precedence over older data
</p>
</li></ol>

<p>This relevant mostly for &quot;temporary&quot; monitors which may be replaced after they
are initially deployed. If you want access to all device deployments associated
with a specific <code>locationID</code>, you can use the provider specific functions:
<code><a href="#topic+airnow_loadAnnual">airnow_loadAnnual</a></code>,
<code><a href="#topic+airsis_loadAnnual">airsis_loadAnnual</a></code> and
<code><a href="#topic+wrcc_loadAnnual">wrcc_loadAnnual</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+monitor_loadDaily">monitor_loadDaily</a></code>
</p>
<p><code><a href="#topic+monitor_loadLatest">monitor_loadLatest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AirMonitor)
# Fail gracefully if any resources are not available
try({

monitor_loadAnnual() %&gt;%
  monitor_filter(stateCode %in% CONUS) %&gt;%
  monitor_leaflet()

}, silent = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='monitor_loadDaily'>Load daily monitoring data from all sources</h2><span id='topic+monitor_loadDaily'></span>

<h3>Description</h3>

<p>Combine daily data from AirNow, AIRSIS and WRCC:
</p>
<p>If <code>archiveDataDir</code> is defined, data will be loaded from this local
archive. Otherwise, data will be loaded from the monitoring data repository
maintained by the USFS AirFire team.
</p>
<p>The files loaded by this function are updated once per day and
contain data for the previous 45 days.
</p>
<p>For the most recent data in the last 10 days, use <code>monitor_loadLatest()</code>.
</p>
<p>For data extended more than 45 days into the past, use <code>monitor_load()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_loadDaily(
  archiveBaseUrl = paste0("https://airfire-data-exports.s3.us-west-2.amazonaws.com/",
    "monitoring/v2"),
  archiveBaseDir = NULL,
  QC_negativeValues = c("zero", "na", "ignore")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_loadDaily_+3A_archivebaseurl">archiveBaseUrl</code></td>
<td>
<p>Base URL for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="monitor_loadDaily_+3A_archivebasedir">archiveBaseDir</code></td>
<td>
<p>Local base directory for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="monitor_loadDaily_+3A_qc_negativevalues">QC_negativeValues</code></td>
<td>
<p>Type of QC to apply to negative values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object with PM2.5 monitoring data. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>This function guarantees that only a single time series will be
associated with each <code>locationID</code> using the following logic:
</p>

<ol>
<li><p>AirNow data takes precedence over data from AIRSIS or WRCC
</p>
</li>
<li><p>more recent data takes precedence over older data
</p>
</li></ol>

<p>This relevant mostly for &quot;temporary&quot; monitors which may be replaced after they
are initially deployed. If you want access to all device deployments associated
with a specific <code>locationID</code>, you can use the provider specific functions:
<code><a href="#topic+airnow_loadDaily">airnow_loadDaily</a></code>,
<code><a href="#topic+airsis_loadDaily">airsis_loadDaily</a></code> and
<code><a href="#topic+wrcc_loadDaily">wrcc_loadDaily</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+monitor_loadAnnual">monitor_loadAnnual</a></code>
</p>
<p><code><a href="#topic+monitor_loadLatest">monitor_loadLatest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AirMonitor)
# Fail gracefully if any resources are not available
try({

monitor_loadDaily() %&gt;%
  monitor_filter(stateCode %in% CONUS) %&gt;%
  monitor_leaflet()

}, silent = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='monitor_loadLatest'>Load most recent monitoring data from all sources</h2><span id='topic+monitor_loadLatest'></span>

<h3>Description</h3>

<p>Combine recent data from AirNow, AIRSIS and WRCC:
</p>
<p>If <code>archiveDataDir</code> is defined, data will be loaded from this local
archive. Otherwise, data will be loaded from the monitoring data repository
maintained by the USFS AirFire team.
</p>
<p>The files loaded by this function are updated multiple times an hour and
contain data for the previous 10 days.
</p>
<p>For daily updates covering the most recent 45 days, use <code>monitor_loadDaily()</code>.
</p>
<p>For data extended more than 45 days into the past, use <code>monitor_load()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_loadLatest(
  archiveBaseUrl = paste0("https://airfire-data-exports.s3.us-west-2.amazonaws.com/",
    "monitoring/v2"),
  archiveBaseDir = NULL,
  QC_negativeValues = c("zero", "na", "ignore")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_loadLatest_+3A_archivebaseurl">archiveBaseUrl</code></td>
<td>
<p>Base URL for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="monitor_loadLatest_+3A_archivebasedir">archiveBaseDir</code></td>
<td>
<p>Local base directory for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="monitor_loadLatest_+3A_qc_negativevalues">QC_negativeValues</code></td>
<td>
<p>Type of QC to apply to negative values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object with PM2.5 monitoring data. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>This function guarantees that only a single time series will be
associated with each <code>locationID</code> using the following logic:
</p>

<ol>
<li><p>AirNow data takes precedence over data from AIRSIS or WRCC
</p>
</li>
<li><p>more recent data takes precedence over older data
</p>
</li></ol>

<p>This relevant mostly for &quot;temporary&quot; monitors which may be replaced after they
are initially deployed. If you want access to all device deployments associated
with a specific <code>locationID</code>, you can use the provider specific functions:
<code><a href="#topic+airnow_loadLatest">airnow_loadLatest</a></code>,
<code><a href="#topic+airsis_loadLatest">airsis_loadLatest</a></code> and
<code><a href="#topic+wrcc_loadLatest">wrcc_loadLatest</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+monitor_loadAnnual">monitor_loadAnnual</a></code>
</p>
<p><code><a href="#topic+monitor_loadDaily">monitor_loadDaily</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AirMonitor)
# Fail gracefully if any resources are not available
try({

monitor_loadLatest() %&gt;%
  monitor_filter(stateCode %in% CONUS) %&gt;%
  monitor_leaflet()

}, silent = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='monitor_mutate'>Apply a function to <em>mts_monitor</em> time series</h2><span id='topic+monitor_mutate'></span>

<h3>Description</h3>

<p>This function works similarly to <code>dplyr::mutate()</code> and applies
<code>FUN</code> to each time series found in <code>monitor$data</code>. <code>FUN</code> must
be a function that accepts a numeric vector as its first argument and returns
a vector of the same length.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_mutate(monitor = NULL, FUN = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_mutate_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_mutate_+3A_fun">FUN</code></td>
<td>
<p>Function used to modify time series.</p>
</td></tr>
<tr><td><code id="monitor_mutate_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified <code>mts_monitor</code> object. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

Carmel_Valley %&gt;%
  monitor_filterDatetime(2016080207, 2016080212) %&gt;%
  monitor_toCSV(includeMeta = FALSE) %&gt;%
  cat()

Carmel_Valley %&gt;%
  monitor_filterDatetime(2016080207, 2016080212) %&gt;%
  monitor_mutate(function(x) { return(x / 2) }) %&gt;%
  monitor_toCSV(includeMeta = FALSE) %&gt;%
  cat()

</code></pre>

<hr>
<h2 id='monitor_nowcast'>Apply NowCast algorithm to <em>mts_monitor</em> data</h2><span id='topic+monitor_nowcast'></span>

<h3>Description</h3>

<p>A NowCast algorithm is applied to the data in in the
<code>monitor</code> object. The <code>version</code> argument specifies the minimum
weight factor and number of hours to be used in the calculation.
</p>
<p>Available versions include:
</p>

<ol>
<li><p><code>pm</code>: hours = 12, weight = 0.5
</p>
</li>
<li><p><code>pmAsian</code>: hours = 3, weight = 0.1
</p>
</li>
<li><p><code>ozone</code>: hours = 8, weight = NA
</p>
</li></ol>

<p>The default, <code>version = "pm"</code>, is appropriate for typical usage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_nowcast(
  monitor,
  version = c("pm", "pmAsian", "ozone"),
  includeShortTerm = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_nowcast_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_nowcast_+3A_version">version</code></td>
<td>
<p>Name of the type of nowcast algorithm to be used.</p>
</td></tr>
<tr><td><code id="monitor_nowcast_+3A_includeshortterm">includeShortTerm</code></td>
<td>
<p>Logical specifying whether to alcluate preliminary
NowCast values starting with the 2nd hour.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates each hour's NowCast value based on the value
for the given hour and the previous N-1 hours, where N is the number
of hours appropriate for the <code>version</code> argument. For example, if
<code>version = "pm"</code>, the NowCast value for Hour 12 is based on the data
from hours 1-12.
</p>
<p>The function returns values when at least two of the previous three hours
have data. NA's are returned for hours where this condition is not met.
</p>
<p>By default, the funtion will not return a valid value until the Nth hour.
If <code>includeShortTerm = TRUE</code>, the function will return a valid value
after only the 2nd hour (provided, of course, that both hours are valid).
</p>
<p>Calculated Nowcast values are truncated to the nearest .1 ug/m3 for 'pm' and
nearest .001 ppm for 'ozone' regardless of the precision of the data in the
incoming <em>mts_monitor</em> object.
</p>


<h3>Value</h3>

<p>A modified <code>mts_monitor</code> object. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>References</h3>

<p><a href="https://en.wikipedia.org/wiki/Nowcast_(Air_Quality_Index)">https://en.wikipedia.org/wiki/Nowcast_(Air_Quality_Index)</a>
</p>
<p><a href="https://www.airnow.gov/sites/default/files/2020-05/aqi-technical-assistance-document-sept2018.pdf">AQI Technical Assistance Document</a>
</p>

<hr>
<h2 id='monitor_pull'>Extract a column of metadata or data</h2><span id='topic+monitor_pull'></span>

<h3>Description</h3>

<p>This function acts similarly to <code><a href="dplyr.html#topic+pull">pull</a></code> working on
<code>monitor$meta</code> or <code>monitor$data</code>. Data are returned as a simple array.
Data are pulled from whichever dataframe contains <code>var</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_pull(monitor = NULL, var = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_pull_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_pull_+3A_var">var</code></td>
<td>
<p>A variable name found in the <code>meta</code> or <code>data</code>
dataframe of the incoming <em>mts_monitor</em> time series object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An array of values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

# Metadata
Camp_Fire %&gt;%
  monitor_pull("deploymentType") %&gt;%
  table()

# Data for a specific ID
Camp_Fire %&gt;%
  monitor_dailyStatistic(mean) %&gt;%
  monitor_pull("6bbab08e3786ef66_840060450006") %&gt;%
  round(0)

# Associated dates
Camp_Fire %&gt;%
  monitor_dailyStatistic(mean) %&gt;%
  monitor_pull("datetime")

</code></pre>

<hr>
<h2 id='monitor_replaceValues'>Replace <em>mts_monitor</em> data with another value</h2><span id='topic+monitor_replaceValues'></span>

<h3>Description</h3>

<p>Use an R expression to identify values for replacement.
</p>
<p>The R expression given in <code>filter</code> is used to identify elements
in <code>monitor$data</code> that should be replaced.  The <code>datetime</code> column
will be retained unmodified. Typical usage would include
</p>

<ol>
<li><p>replacing negative values with 0
</p>
</li>
<li><p>replacing unreasonably high values with <code>NA</code>
</p>
</li></ol>

<p>Expressions should use <code>data</code> for the left hand side of the comparison.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_replaceValues(monitor = NULL, filter = NULL, value = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_replaceValues_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_replaceValues_+3A_filter">filter</code></td>
<td>
<p>R expression used to identify values for replacement.</p>
</td></tr>
<tr><td><code id="monitor_replaceValues_+3A_value">value</code></td>
<td>
<p>Numeric replacement value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified <code>mts_monitor</code> object. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

wa &lt;- monitor_filterMeta(NW_Megafires, stateCode == 'WA')
any(wa$data &lt; 5, na.rm = TRUE)

wa_zero &lt;- monitor_replaceValues(wa, data &lt; 5, 5)
any(wa_zero$data &lt; 5, na.rm = TRUE)
</code></pre>

<hr>
<h2 id='monitor_select'>Subset and reorder time series within an <em>mts_monitor</em> object</h2><span id='topic+monitor_select'></span><span id='topic+monitor_reorder'></span>

<h3>Description</h3>

<p>This function acts similarly to <code>dplyr::select()</code> working on
<code>monitor$data</code>. The returned <em>mts_monitor</em> object will contain only
those time series identified by <code>id</code> in the order specified.
</p>
<p>This can be helpful when using faceted plot functions based on <span class="pkg">ggplot</span>
such as those found in the <span class="pkg">AirMonitorPlots</span> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_select(monitor, id)

monitor_reorder(monitor, id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_select_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_select_+3A_id">id</code></td>
<td>
<p>Vector of <code>deviceDeploymentIDs</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A reordered (subset) of the incoming <em>mts_monitor</em> object. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>See Also</h3>

<p><a href="#topic+monitor_filterMeta">monitor_filterMeta</a>
</p>

<hr>
<h2 id='monitor_selectWhere'>Data-based subsetting of time series within an <em>mts_monitor</em> object.</h2><span id='topic+monitor_selectWhere'></span>

<h3>Description</h3>

<p>Subsetting of <code>monitor</code> acts similarly to <code>tidyselect::where()</code> working on
<code>monitor$data</code>. The returned <em>mts_monitor</em> object will contain only
those time series where <code>FUN</code> applied to the time series data returns <code>TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_selectWhere(monitor, FUN)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_selectWhere_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_selectWhere_+3A_fun">FUN</code></td>
<td>
<p>A function applied to time series data that returns TRUE or FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A subset of the incoming <em>mts_monitor</em> object. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>See Also</h3>

<p><a href="#topic+monitor_select">monitor_select</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

# Show all Camp_Fire locations
Camp_Fire$meta$locationName

# Use package US_AQI data for HAZARDOUS
name &lt;- US_AQI$names_eng[6]
threshold &lt;- US_AQI$breaks_PM2.5[6]

# Find HAZARDOUS locations
worst_sites &lt;-
  Camp_Fire %&gt;%
  monitor_selectWhere(
    function(x) { any(x &gt;= threshold, na.rm = TRUE) }
  )

# Show the worst locations
worst_sites$meta$locationName

</code></pre>

<hr>
<h2 id='monitor_setTimeAxis'>Extend/contract <em>mts_monitor</em> time series to new start and end times</h2><span id='topic+monitor_setTimeAxis'></span>

<h3>Description</h3>

<p>Extends or contracts the time range of an <em>mts_monitor</em> object by
adding/removing time steps at the start and end and filling any new time
steps with missing values. The resulting time axis is guaranteed to be
a regular, hourly axis with no gaps using the same timezone as the incoming
<em>mts_monitor</em> object. This is useful when you want to place separate <em>mts_monitor</em>
objects on the same time axis for plotting.
</p>
<p>If either <code>startdate</code> or <code>enddate</code> is missing, the start or end of
the timeseries in <code>monitor</code> will be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_setTimeAxis(
  monitor = NULL,
  startdate = NULL,
  enddate = NULL,
  timezone = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_setTimeAxis_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_setTimeAxis_+3A_startdate">startdate</code></td>
<td>
<p>Desired start date (ISO 8601).</p>
</td></tr>
<tr><td><code id="monitor_setTimeAxis_+3A_enddate">enddate</code></td>
<td>
<p>Desired end date (ISO 8601).</p>
</td></tr>
<tr><td><code id="monitor_setTimeAxis_+3A_timezone">timezone</code></td>
<td>
<p>Olson timezone used to interpret <code>startdate</code> and <code>enddate</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The incoming <em>mts_monitor</em> time series object defined on a new time axis.
(A list with <code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>If <code>startdate</code> or <code>enddate</code> is a <code>POSIXct</code> value, then
<code>timezone</code> will be set to the timezone associated with <code>startdate</code>
or <code>enddate</code>.
In this common case, you don't need to specify <code>timezone</code> explicitly.
</p>
<p>If neither <code>startdate</code> nor <code>enddate</code> is a <code>POSIXct</code> value
AND no <code>timezone</code> is supplied, the timezone will be inferred from
the most common timezone found in <code>monitor</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

# Default range
Carmel_Valley %&gt;%
  monitor_timeRange()

# One-sided extend with user specified timezone
Carmel_Valley %&gt;%
  monitor_setTimeAxis(enddate = 20160820, timezone = "UTC") %&gt;%
  monitor_timeRange()

# Two-sided extend with user specified timezone
Carmel_Valley %&gt;%
  monitor_setTimeAxis(20190720, 20190820, timezone = "UTC") %&gt;%
  monitor_timeRange()

# Two-sided extend without timezone (uses monitor$meta$timezone)
Carmel_Valley %&gt;%
  monitor_setTimeAxis(20190720, 20190820) %&gt;%
  monitor_timeRange()

</code></pre>

<hr>
<h2 id='monitor_slice_head'>Subset time series based on their position within an <em>mts_monitor</em> object</h2><span id='topic+monitor_slice_head'></span><span id='topic+monitor_slice_tail'></span>

<h3>Description</h3>

<p>An <em>mts_monitor</em> object is reduced so as to contain only
the first or last <code>n</code> timeseries. These functions work similarly to
<code><a href="dplyr.html#topic+slice_head">dplyr::slice_head</a></code> and
<code><a href="dplyr.html#topic+slice_tail">dplyr::slice_tail</a></code>
but apply to both dataframes in the <em>mts_monitor</em> object.
</p>
<p>This is primarily useful when the <em>mts_monitor</em> object has been ordered
by a previous call to <code><a href="#topic+monitor_arrange">monitor_arrange</a></code> or by some other means.
</p>
<p><code>monitor_slice_head()</code> selects the first and <code>monitor_slice_tail()</code>
the last timeseries in the object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_slice_head(monitor, n = 5)

monitor_slice_tail(monitor, n = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_slice_head_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_slice_head_+3A_n">n</code></td>
<td>
<p>Number of rows of <code>monitor$meta</code> to select.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A subset of the incoming <em>mts_monitor</em> time series object.
(A list with <code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

# Find lowest elevation sites
Camp_Fire %&gt;%
  monitor_filter(!is.na(elevation)) %&gt;%
  monitor_arrange(elevation) %&gt;%
  monitor_slice_head(n = 5) %&gt;%
  monitor_getMeta() %&gt;%
  dplyr::select(elevation, locationName)

# Find highest elevation sites
Camp_Fire %&gt;%
  monitor_filterMeta(!is.na(elevation)) %&gt;%
  monitor_arrange(elevation) %&gt;%
  monitor_slice_tail(n = 5) %&gt;%
  monitor_getMeta() %&gt;%
  dplyr::select(elevation, locationName)

</code></pre>

<hr>
<h2 id='monitor_timeInfo'>Get time related information for a monitor</h2><span id='topic+monitor_timeInfo'></span>

<h3>Description</h3>

<p>Calculate the local time for a monitor, as well as
sunrise, sunset and solar noon times, and create several temporal masks.
</p>
<p>The returned dataframe will have as many rows as the length of the incoming
UTC <code>time</code> vector and will contain the following columns:
</p>

<ul>
<li><p><code>localStdTime_UTC</code> &ndash; UTC representation of local <strong>standard</strong> time
</p>
</li>
<li><p><code>daylightSavings</code> &ndash; logical mask = TRUE if daylight savings is in effect
</p>
</li>
<li><p><code>localTime</code> &ndash; local clock time
</p>
</li>
<li><p><code>sunrise</code> &ndash; time of sunrise on each localTime day
</p>
</li>
<li><p><code>sunset</code> &ndash; time of sunset on each localTime day
</p>
</li>
<li><p><code>solarnoon</code> &ndash; time of solar noon on each localTime day
</p>
</li>
<li><p><code>day</code> &ndash; logical mask = TRUE between sunrise and sunset
</p>
</li>
<li><p><code>morning</code> &ndash; logical mask = TRUE between sunrise and solarnoon
</p>
</li>
<li><p><code>afternoon</code> &ndash; logical mask = TRUE between solarnoon and sunset
</p>
</li>
<li><p><code>night</code> &ndash; logical mask = opposite of day
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>monitor_timeInfo(monitor = NULL, id = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_timeInfo_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_timeInfo_+3A_id">id</code></td>
<td>
<p><code>deviceDeploymentID</code> used to select a single time
series found in <code>monitor</code>. &ndash; optional if <code>monitor</code> only has one
time series.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>While the <span class="pkg">lubridate</span> package makes it easy to work in local timezones,
there is no easy way in R to work in &quot;Local Standard Time&quot; (LST) (<em>i.e.
never shifting to daylight savings</em>) as is often required when working with
air quality data. US EPA regulations mandate that daily averages be calculated
based on LST.
</p>
<p>The <code>localStdTime_UTC</code> is primarily for use internally and provides
an important tool for creating LST daily averages and LST axis labeling.
</p>


<h3>Value</h3>

<p>A dataframe with times and masks.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

carmel &lt;-
  Carmel_Valley %&gt;%
  monitor_filterDate(20160801, 20160810)

# Create timeInfo object for this monitor
ti &lt;- monitor_timeInfo(carmel)

# Subset the data based on day/night masks
data_day &lt;- carmel$data[ti$day,]
data_night &lt;- carmel$data[ti$night,]

# Build two monitor objects
carmel_day &lt;- list(meta = carmel$meta, data = data_day)
carmel_night &lt;- list(meta = carmel$meta, data = data_night)

# Plot them
carmel_day %&gt;%
  monitor_timeseriesPlot(
    pch = 8,
    col = "goldenrod",
    shadedNight = TRUE
  )

carmel_night %&gt;%
  monitor_timeseriesPlot(
    add = TRUE,
    pch = 16,
    col = "darkblue"
  )
</code></pre>

<hr>
<h2 id='monitor_timeRange'>Get the time range for a monitor</h2><span id='topic+monitor_timeRange'></span>

<h3>Description</h3>

<p>This function is a wrapper for <code>range(monitor$data$datetime)</code>
and is convenient for use in data pipelines.
</p>
<p>Dates will be returned in the timezone associated with
<code>monitor$data$datetime</code> which is typically &quot;UTC&quot; unless
<code>timezone</code> is specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_timeRange(monitor = NULL, timezone = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_timeRange_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_timeRange_+3A_timezone">timezone</code></td>
<td>
<p>Olson timezone for the returned dates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the minimum and maximum times of a
<em>mts_monitor</em> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Carmel_Valley %&gt;%
  monitor_timeRange(timezone = "America/Los_Angeles")
</code></pre>

<hr>
<h2 id='monitor_timeseriesPlot'>Create timeseries plot</h2><span id='topic+monitor_timeseriesPlot'></span>

<h3>Description</h3>

<p>Creates a time series plot of data from a <em>mts_monitor</em> object.
By default, points are plotted as semi-transparent squares. All data values
are plotted from all monitors found in the <em>mts_monitor</em> object.
</p>
<p>Reasonable defaults are chosen for annotations and plot characteristics.
Users can override any defaults by passing in parameters accepted by
<code>graphics::plot.default</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_timeseriesPlot(
  monitor = NULL,
  id = NULL,
  shadedNight = FALSE,
  add = FALSE,
  addAQI = FALSE,
  palette = c("EPA", "subdued", "deuteranopia"),
  opacity = NULL,
  NAAQS = c("PM2.5", "PM2.5_2024"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_timeseriesPlot_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_timeseriesPlot_+3A_id">id</code></td>
<td>
<p><code>deviceDeploymentID</code> used to limit plotting to a single time
series found in <code>monitor</code>.</p>
</td></tr>
<tr><td><code id="monitor_timeseriesPlot_+3A_shadednight">shadedNight</code></td>
<td>
<p>Logical specifying whether to add nighttime shading.</p>
</td></tr>
<tr><td><code id="monitor_timeseriesPlot_+3A_add">add</code></td>
<td>
<p>Logical specifying whether to add to the current plot.</p>
</td></tr>
<tr><td><code id="monitor_timeseriesPlot_+3A_addaqi">addAQI</code></td>
<td>
<p>Logical specifying whether to add visual AQI decorations.</p>
</td></tr>
<tr><td><code id="monitor_timeseriesPlot_+3A_palette">palette</code></td>
<td>
<p>Named color palette to use when adding AQI decorations.</p>
</td></tr>
<tr><td><code id="monitor_timeseriesPlot_+3A_opacity">opacity</code></td>
<td>
<p>Opacity to use for points. By default, an opacity is chosen based
on the number of points so that trends are highlighted while outliers diminish
in visual importance as the number of points increases.</p>
</td></tr>
<tr><td><code id="monitor_timeseriesPlot_+3A_naaqs">NAAQS</code></td>
<td>
<p>Version of NAAQS levels to use. See Note.</p>
</td></tr>
<tr><td><code id="monitor_timeseriesPlot_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>graphics::plot.default()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. This function is called to draw an air quality
time series plot on the active graphics device.
</p>


<h3>Note</h3>

<p>On February 7, 2024, EPA strengthened the National Ambient Air Quality
Standards for Particulate Matter (PM NAAQS) to protect millions of Americans
from harmful and costly health impacts, such as heart attacks and premature
death. Particle or soot pollution is one of the most dangerous forms of air
pollution, and an extensive body of science links it to a range of serious
and sometimes deadly illnesses. EPA is setting the level of the primary
(health-based) annual PM2.5 standard at 9.0 micrograms per cubic meter to
provide increased public health protection, consistent with the available
health science.
See <a href="https://www.epa.gov/pm-pollution/final-reconsideration-national-ambient-air-quality-standards-particulate-matter-pm">PM NAAQS update</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

# Single monitor
Carmel_Valley %&gt;%
  monitor_timeseriesPlot()

# Multiple monitors
Camp_Fire %&gt;%
  monitor_filter(countyName == "Alameda") %&gt;%
  monitor_timeseriesPlot(main = "All Alameda County Monitors")

# Standard extras
Carmel_Valley %&gt;%
  monitor_timeseriesPlot(
    shadedNight = TRUE,
    addAQI = TRUE
  )
addAQILegend()

# Standard extras using the updated PM NAAQS
Carmel_Valley %&gt;%
  monitor_timeseriesPlot(
    shadedNight = TRUE,
    addAQI = TRUE,
    NAAQS = "PM2.5_2024"
  )
addAQILegend(NAAQS = "PM2.5_2024")

# Fancy plot based on pm2.5 values
pm2.5 &lt;- Carmel_Valley$data[,2]
Carmel_Valley %&gt;%
  monitor_timeseriesPlot(
    shadedNight = TRUE,
    pch = 16,
    cex = pmax(pm2.5 / 100, 0.5),
    col = aqiColors(pm2.5),
    opacity = 0.8
  )
addAQILegend(pch = 16, cex = 0.6, bg = "white")
</code></pre>

<hr>
<h2 id='monitor_toAQCTable'>Convert monitor data into an AQI category table</h2><span id='topic+monitor_toAQCTable'></span>

<h3>Description</h3>

<p>Creates a table of AQI category vs monitoring site with a count
of the number of times each AQI category was experienced at each site. The
count will be a count of hours or days depending on averaging period of
the incoming <code>monitor</code> object.
</p>
<p>When <code>siteIdentifier</code> is used, the identifiers must be in the same
order as <code>monitor$meta</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_toAQCTable(
  monitor,
  NAAQS = c("PM2.5", "PM2.5_2024"),
  siteIdentifier = "locationName"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_toAQCTable_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_toAQCTable_+3A_naaqs">NAAQS</code></td>
<td>
<p>Version of NAAQS levels to use. See Note.</p>
</td></tr>
<tr><td><code id="monitor_toAQCTable_+3A_siteidentifier">siteIdentifier</code></td>
<td>
<p>Metadata column used to identify sites or a character
vector with site identifiers.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Table of AQI category counts.
</p>


<h3>Note</h3>

<p>On February 7, 2024, EPA strengthened the National Ambient Air Quality
Standards for Particulate Matter (PM NAAQS) to protect millions of Americans
from harmful and costly health impacts, such as heart attacks and premature
death. Particle or soot pollution is one of the most dangerous forms of air
pollution, and an extensive body of science links it to a range of serious
and sometimes deadly illnesses. EPA is setting the level of the primary
(health-based) annual PM2.5 standard at 9.0 micrograms per cubic meter to
provide increased public health protection, consistent with the available
health science.
See <a href="https://www.epa.gov/pm-pollution/final-reconsideration-national-ambient-air-quality-standards-particulate-matter-pm">PM NAAQS update</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

# Lane County, Oregon AQSIDs all begin with "41039"
LaneCounty &lt;-
  NW_Megafires %&gt;%
  monitor_filter(stringr::str_detect(AQSID, '^41039')) %&gt;%
  monitor_filterDate(20150801, 20150901)

# Count of hours each site spent in each AQ category in August
LaneCounty %&gt;%
  monitor_toAQCTable()

# Count of days each site spent in each AQ
LaneCounty %&gt;%
  monitor_dailyStatistic(mean) %&gt;%
  monitor_toAQCTable()

# Count of days each site spent in each AQ (simplified names)
siteNames &lt;- c(
  "Eugene 1", "Eugene 2", "Eugene 3",
  "Springfield", "Oakridge", "Cottage Grove"
)
LaneCounty %&gt;%
  monitor_dailyStatistic(mean) %&gt;%
  monitor_toAQCTable(siteIdentifier = siteNames)

# Count of days at each AQ level with the new, 2024 NAAQS
LaneCounty %&gt;%
  monitor_dailyStatistic(mean) %&gt;%
  monitor_toAQCTable(NAAQS = "PM2.5_2024")


</code></pre>

<hr>
<h2 id='monitor_toCSV'>Convert monitor data as CSV</h2><span id='topic+monitor_toCSV'></span>

<h3>Description</h3>

<p>Converts the contents of the <code>monitor</code> argument to CSV.
By default, the output is a text string with &quot;human readable&quot; CSV that
includes both <code>meta</code> and <code>data</code>. When saved as a file, this format
is useful for point-and-click spreadsheet users who want to have everything
on a single sheet.
</p>
<p>To obtain a machine parseable CSV string for just the data, you can use
<code>includeMeta = FALSE</code>. To obtain machine parseable metadata, use
<code>includeData = FALSE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_toCSV(monitor, includeMeta = TRUE, includeData = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_toCSV_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_toCSV_+3A_includemeta">includeMeta</code></td>
<td>
<p>Logical specifying whether to include <code>monitor$meta</code>.</p>
</td></tr>
<tr><td><code id="monitor_toCSV_+3A_includedata">includeData</code></td>
<td>
<p>Logical specifying whether to include <code>monitor$data</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>CSV formatted text.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

monitor &lt;-
  Carmel_Valley %&gt;%
  monitor_filterDate(20160802, 20160803)

monitor_toCSV(monitor) %&gt;% cat()
monitor_toCSV(monitor, includeData = FALSE) %&gt;% cat()
monitor_toCSV(monitor, includeMeta = FALSE) %&gt;% cat()

</code></pre>

<hr>
<h2 id='monitor_toPWFSLSmoke'>Convert a mts_monitor object to a ws_monitor object for the PWFSLSmoke package</h2><span id='topic+monitor_toPWFSLSmoke'></span>

<h3>Description</h3>

<p>A <em>mts_monitor</em> object is modified so that it becomes
a <span class="pkg">PWFSLSmoke</span> package <em>ws_monitor</em> object. While some information
will be lost, this operation can be reversed with <code>monitor_fromPWFSLSmoke()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_toPWFSLSmoke(monitor = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_toPWFSLSmoke_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <span class="pkg">PWFSLSmoke</span> <em>ws_monitor</em> object. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>In order to avoid duplicated <code>monitorID</code> values in the returned
<em>ws_monitor</em> object, the full <code>deviceDeploymentID</code> will be used
as the <code>monitorID</code>.
</p>

<hr>
<h2 id='monitor_trimDate'>Trim a <em>mts_monitor</em> object to full days</h2><span id='topic+monitor_trimDate'></span>

<h3>Description</h3>

<p>Trims the date range of a <em>mts_monitor</em> object to local time date
boundaries which are <em>within</em> the range of data. This has the effect
of removing partial-day data records at the start and end of the timeseries
and is useful when calculating full-day statistics.
</p>
<p>By default, multi-day periods of all-missing data at the beginning and end
of the timeseries are removed before trimming to date boundaries. If
<code>trimEmptyDays = FALSE</code> all records are retained except for partial days
beyond the first and after the last date boundary.
</p>
<p>Day boundaries are calculated using the specified <code>timezone</code> or, if
<code>NULL</code>, from <code>monitor$meta$timezone</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_trimDate(monitor = NULL, timezone = NULL, trimEmptyDays = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_trimDate_+3A_monitor">monitor</code></td>
<td>
<p><em>mts_monitor</em> object.</p>
</td></tr>
<tr><td><code id="monitor_trimDate_+3A_timezone">timezone</code></td>
<td>
<p>Olson timezone used to interpret dates.</p>
</td></tr>
<tr><td><code id="monitor_trimDate_+3A_trimemptydays">trimEmptyDays</code></td>
<td>
<p>Logical specifying whether to remove days with no data
at the beginning and end of the time range.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A subset of the given <em>mts_monitor</em> object. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AirMonitor)

# Non-day boundaries
monitor &lt;-
  Camp_Fire %&gt;%
  monitor_filterDatetime(
    "2018111502",
    "2018112206",
    timezone = "America/Los_Angeles"
  )

monitor %&gt;%
  monitor_timeRange(timezone = "America/Los_Angeles")

# Trim to full days only
monitor %&gt;%
  monitor_trimDate() %&gt;%
  monitor_timeRange(timezone = "America/Los_Angeles")

</code></pre>

<hr>
<h2 id='NW_Megafires'>NW_Megafires example dataset</h2><span id='topic+NW_Megafires'></span>

<h3>Description</h3>

<p>The <code>NW_Megafires</code> dataset provides a quickly loadable
version of a <em>mts_monitor</em> object for practicing and code examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NW_Megafires
</code></pre>


<h3>Format</h3>

<p>A <em>mts_monitor</em> object with 1080 rows and 143 columns of data.
</p>


<h3>Details</h3>

<p>In the summer of 2015, Washington state had several catastrophic wildfires
that led to many days of heavy smoke in eastern Washington, Oregon and
northern Idaho. The NW_Megafires dataset contains monitoring data for the
Pacific Northwest from July 24 through September 06, 2015.
</p>
<p>This dataset was generated on 2022-10-28 by running:
</p>
<pre>
library(AirMonitor)

NW_Megafires &lt;-
  monitor_loadAnnual(2015, epaPreference = "epa_aqs") 
  monitor_filterMeta(stateCode 
  monitor_filterDate(20150724, 20150907, timezone = "America/Los_Angeles") 
  monitor_dropEmpty()

save(NW_Megafires, file = "data/NW_Megafires.rda")
</pre>

<hr>
<h2 id='pollutantNames'>Names of standard pollutants</h2><span id='topic+pollutantNames'></span>

<h3>Description</h3>

<p>Character string identifiers of recognized pollutant names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pollutantNames
</code></pre>


<h3>Format</h3>

<p>A vector of character strings
</p>


<h3>Details</h3>

<p>pollutantNames
</p>


<h3>Examples</h3>

<pre><code class='language-R'> print(coreMetadataNames, width = 80)
</code></pre>

<hr>
<h2 id='QC_invalidateConsecutiveSuspectValues'>Invalidate consecutive suspect values.</h2><span id='topic+QC_invalidateConsecutiveSuspectValues'></span>

<h3>Description</h3>

<p>Invalidates values within a timeseries that appear &quot;sticky&quot;.
Some temporary monitoring data has stretches of consecutive values, sometimes
well outside the range of reasonable. This QC function identifies these
&quot;sticky&quot; stretches and returns the original timeseries data with &quot;sticky&quot;
stretches replaced with <code>NA</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QC_invalidateConsecutiveSuspectValues(
  x = NULL,
  suspectValues = c(0:10 * 1000, NA),
  consecutiveCount = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QC_invalidateConsecutiveSuspectValues_+3A_x">x</code></td>
<td>
<p>Timeseries data.</p>
</td></tr>
<tr><td><code id="QC_invalidateConsecutiveSuspectValues_+3A_suspectvalues">suspectValues</code></td>
<td>
<p>Vector of numeric values considered suspect.</p>
</td></tr>
<tr><td><code id="QC_invalidateConsecutiveSuspectValues_+3A_consecutivecount">consecutiveCount</code></td>
<td>
<p>How many <code>suspectValues</code> must appear in a row
before they are invalidated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns <code>x</code> with some values potentially replaced with <code>NA</code>.
</p>

<hr>
<h2 id='US_52'>US state codes</h2><span id='topic+US_52'></span>

<h3>Description</h3>

<p>State codes for the 50 states +DC +PR (Puerto Rico).
</p>
<p><code>
US_52 &lt;- c(
  "AK","AL","AZ","AR","CA","CO","CT","DE","FL","GA",
  "HI","ID","IL","IN","IA","KS","KY","LA","ME","MD",
  "MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ",
  "NM","NY","NC","ND","OH","OK","OR","PA","RI","SC",
  "SD","TN","TX","UT","VT","VA","WA","WV","WI","WY",
  "DC","PR"
)
</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>US_52
</code></pre>


<h3>Format</h3>

<p>A vector with 52 elements
</p>


<h3>Details</h3>

<p>US state codes
</p>

<hr>
<h2 id='US_AQI'>US EPA AQI Index levels, names, colors and action text</h2><span id='topic+US_AQI'></span>

<h3>Description</h3>

<p>Official, US EPA AQI levels, names, colors and action text are provided in a
list for easy coloring and labeling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>US_AQI
</code></pre>


<h3>Format</h3>

<p>A list with named elements
</p>


<h3>Details</h3>

<p>AQI breaks and associated names and colors
</p>


<h3>Breaks</h3>

<p>Breakpoints are given in units reported for each parameter and include:
</p>

<ul>
<li><p><code>breaks_AQI</code>
</p>
</li>
<li><p><code>breaks_CO</code>
</p>
</li>
<li><p><code>breaks_NO2</code>
</p>
</li>
<li><p><code>breaks_OZONE_1hr</code>
</p>
</li>
<li><p><code>breaks_OZONE_8hr</code>
</p>
</li>
<li><p><code>breaks_PM2.5</code>
</p>
</li>
<li><p><code>breaks_PM10</code>
</p>
</li></ul>



<h3>Colors</h3>

<p>Several different color palettes are provided:
</p>

<ul>
<li><p><code>colors_EPA</code> &ndash; official EPA AQI colors
</p>
</li>
<li><p><code>colors_subdued</code> &ndash; subdued colors fo use with leaflet maps
</p>
</li>
<li><p><code>colors_deuteranopia</code> &ndash; color vision impaired colors
</p>
</li></ul>



<h3>Names</h3>

<p>Names of AQI categories are provided in several languages identified by the
ISO 639-2 alpha-3 code:
</p>

<ul>
<li><p><code>names_eng</code>
</p>
</li>
<li><p><code>names_spa</code>
</p>
</li></ul>



<h3>Actions</h3>

<p>Text for &quot;actions to protect yourself&quot; are provided for each
category in several languages identified by the
ISO 639-2 alpha-3 code:
</p>

<ul>
<li><p><code>actions_eng</code>
</p>
</li>
<li><p><code>actions_spa</code>
</p>
</li></ul>

<p>Currently supported languages include English (eng) and Spanish (spa).
</p>
<p>AQI breaks are defined at
<a href="https://www.airnow.gov/sites/default/files/2020-05/aqi-technical-assistance-document-sept2018.pdf">https://www.airnow.gov/sites/default/files/2020-05/aqi-technical-assistance-document-sept2018.pdf</a>
and are given in units appropriate for each pollutant.
</p>
<p>AQI colors are defined at <a href="https://docs.airnowapi.org/aq101">https://docs.airnowapi.org/aq101</a>
</p>


<h3>Note</h3>

<p>The low end of each break category is used as the breakpoint.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print(US_AQI$breaks_AQI)
print(US_AQI$colors_EPA)
print(US_AQI$names_eng)
print(US_AQI$names_spa)
</code></pre>

<hr>
<h2 id='wrcc_loadAnnual'>Load annual WRCC monitoring data</h2><span id='topic+wrcc_loadAnnual'></span>

<h3>Description</h3>

<p>Loads pre-generated .rda files containing annual
WRCC data.
</p>
<p>If <code>archiveDataDir</code> is defined, data will be loaded from this local
archive. Otherwise, data will be loaded from the monitoring data repository
maintained by the USFS AirFire team.
</p>
<p>Current year files loaded by this function are updated once per week.
</p>
<p>For the most recent data in the last 10 days, use <code>wrcc_loadLatest()</code>.
</p>
<p>For daily updates covering the most recent 45 days, use <code>wrcc_loadDaily()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrcc_loadAnnual(
  year = NULL,
  archiveBaseUrl = paste0("https://airfire-data-exports.s3.us-west-2.amazonaws.com/",
    "monitoring/v2"),
  archiveBaseDir = NULL,
  QC_negativeValues = c("zero", "na", "ignore"),
  QC_removeSuspectData = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wrcc_loadAnnual_+3A_year">year</code></td>
<td>
<p>Year [YYYY].</p>
</td></tr>
<tr><td><code id="wrcc_loadAnnual_+3A_archivebaseurl">archiveBaseUrl</code></td>
<td>
<p>Base URL for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="wrcc_loadAnnual_+3A_archivebasedir">archiveBaseDir</code></td>
<td>
<p>Local base directory for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="wrcc_loadAnnual_+3A_qc_negativevalues">QC_negativeValues</code></td>
<td>
<p>Type of QC to apply to negative values.</p>
</td></tr>
<tr><td><code id="wrcc_loadAnnual_+3A_qc_removesuspectdata">QC_removeSuspectData</code></td>
<td>
<p>Removes monitors determined to be misbehaving.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object with WRCC data. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>Some older WRCC timeseries contain only values of 0, 1000, 2000, 3000, ... ug/m3.
Data from these deployments pass instrument-level QC checks but these
timeseries generally do not represent valid data and should be removed.
With <code>QC_removeSuspectData = TRUE</code> (the default), data is checked and
periods reporting only values of 0:10 * 1000 ug/m3 are invalidated.
</p>
<p>Only those personally familiar with the individual instrument deployments
should work with the &quot;suspect&quot; data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wrcc_loadDaily">wrcc_loadDaily</a></code>
</p>
<p><code><a href="#topic+wrcc_loadLatest">wrcc_loadLatest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AirMonitor)

# Fail gracefully if any resources are not available
try({

# See https://en.wikipedia.org/wiki/Snake_River_Complex_Fire

# WRCC monitors during the Snake River Complex Fire
wrcc_loadAnnual(2021) \
  monitor_filter(stateCode \
  monitor_filterDate(20210707, 20210820, timezone = "America/Denver") \
  monitor_timeseriesPlot(
    ylim = c(0, 300),
    xpd = NA,
    addAQI = TRUE,
    main = "WRCC monitors during Snake River Complex Fire"
  )

}, silent = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='wrcc_loadDaily'>Load daily WRCC monitoring data</h2><span id='topic+wrcc_loadDaily'></span>

<h3>Description</h3>

<p>Loads pre-generated .rda files containing daily
WRCC data.
</p>
<p>If <code>archiveDataDir</code> is defined, data will be loaded from this local
archive. Otherwise, data will be loaded from the monitoring data repository
maintained by the USFS AirFire team.
</p>
<p>The files loaded by this function are updated once per day and
contain data for the previous 45 days.
</p>
<p>For the most recent data in the last 10 days, use <code>wrcc_loadLatest()</code>.
</p>
<p>For data extended more than 45 days into the past, use <code>wrcc_loadAnnual()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrcc_loadDaily(
  archiveBaseUrl = paste0("https://airfire-data-exports.s3.us-west-2.amazonaws.com/",
    "monitoring/v2"),
  archiveBaseDir = NULL,
  QC_negativeValues = c("zero", "na", "ignore"),
  QC_removeSuspectData = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wrcc_loadDaily_+3A_archivebaseurl">archiveBaseUrl</code></td>
<td>
<p>Base URL for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="wrcc_loadDaily_+3A_archivebasedir">archiveBaseDir</code></td>
<td>
<p>Local base directory for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="wrcc_loadDaily_+3A_qc_negativevalues">QC_negativeValues</code></td>
<td>
<p>Type of QC to apply to negative values.</p>
</td></tr>
<tr><td><code id="wrcc_loadDaily_+3A_qc_removesuspectdata">QC_removeSuspectData</code></td>
<td>
<p>Removes monitors determined to be misbehaving.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object with WRCC data. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>Some older WRCC timeseries contain only values of 0, 1000, 2000, 3000, ... ug/m3.
Data from these deployments pass instrument-level QC checks but these
timeseries generally do not represent valid data and should be removed.
With <code>QC_removeSuspectData = TRUE</code> (the default), data is checked and
periods reporting only values of 0:10 * 1000 ug/m3 are invalidated.
</p>
<p>Only those personally familiar with the individual instrument deployments
should work with the &quot;suspect&quot; data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wrcc_loadAnnual">wrcc_loadAnnual</a></code>
</p>
<p><code><a href="#topic+wrcc_loadDaily">wrcc_loadDaily</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AirMonitor)

# Fail gracefully if any resources are not available
try({

wrcc_loadDaily() \
  monitor_leaflet()

}, silent = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='wrcc_loadLatest'>Load most recent WRCC monitoring data</h2><span id='topic+wrcc_loadLatest'></span>

<h3>Description</h3>

<p>Loads pre-generated .rda files containing the most recent
WRCC data.
</p>
<p>If <code>archiveDataDir</code> is defined, data will be loaded from this local
archive. Otherwise, data will be loaded from the monitoring data repository
maintained by the USFS AirFire team.
</p>
<p>The files loaded by this function are updated multiple times an hour and
contain data for the previous 10 days.
</p>
<p>For daily updates covering the most recent 45 days, use <code>wrcc_loadDaily()</code>.
</p>
<p>For data extended more than 45 days into the past, use <code>wrcc_loadAnnual()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrcc_loadLatest(
  archiveBaseUrl = paste0("https://airfire-data-exports.s3.us-west-2.amazonaws.com/",
    "monitoring/v2"),
  archiveBaseDir = NULL,
  QC_negativeValues = c("zero", "na", "ignore"),
  QC_removeSuspectData = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wrcc_loadLatest_+3A_archivebaseurl">archiveBaseUrl</code></td>
<td>
<p>Base URL for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="wrcc_loadLatest_+3A_archivebasedir">archiveBaseDir</code></td>
<td>
<p>Local base directory for monitoring v2 data files.</p>
</td></tr>
<tr><td><code id="wrcc_loadLatest_+3A_qc_negativevalues">QC_negativeValues</code></td>
<td>
<p>Type of QC to apply to negative values.</p>
</td></tr>
<tr><td><code id="wrcc_loadLatest_+3A_qc_removesuspectdata">QC_removeSuspectData</code></td>
<td>
<p>Removes monitors determined to be misbehaving.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>mts_monitor</em> object with WRCC data. (A list with
<code>meta</code> and <code>data</code> dataframes.)
</p>


<h3>Note</h3>

<p>Some older WRCC timeseries contain only values of 0, 1000, 2000, 3000, ... ug/m3.
Data from these deployments pass instrument-level QC checks but these
timeseries generally do not represent valid data and should be removed.
With <code>QC_removeSuspectData = TRUE</code> (the default), data is checked and
periods reporting only values of 0:10 * 1000 ug/m3 are invalidated.
</p>
<p>Only those personally familiar with the individual instrument deployments
should work with the &quot;suspect&quot; data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wrcc_loadAnnual">wrcc_loadAnnual</a></code>
</p>
<p><code><a href="#topic+wrcc_loadDaily">wrcc_loadDaily</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AirMonitor)

# Fail gracefully if any resources are not available
try({

wrcc_loadLatest() \
  monitor_leaflet()

}, silent = FALSE)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
