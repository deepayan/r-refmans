<!DOCTYPE html><html><head><title>Help for package ui</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ui}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gridrho.f'><p>Support function for <code>ui.causal</code></p></a></li>
<li><a href='#grr'><p>Gradient for the loglikelihood used by ui.probit</p></a></li>
<li><a href='#hess'><p>Hessian for the loglikelihood used by ui.probit</p></a></li>
<li><a href='#interv.p'><p>Print interval in parantesis</p></a></li>
<li><a href='#lambda0'><p>Inverse Mills rato</p></a></li>
<li><a href='#lambda1'><p>Inverse Mills rato</p></a></li>
<li><a href='#LogL.probit'><p>Loglikelihood used by ui.probit</p></a></li>
<li><a href='#Logl.sandACT'><p>Loglikelohood used in sandwich estimator of average causal effect on the treated for DR</p></a></li>
<li><a href='#ML.probit'><p>Fit maximum likelihood for fixed values of rho</p></a></li>
<li><a href='#plot.uicausal'><p>Plot of UI and CI</p></a></li>
<li><a href='#plot.uiols'><p>Plot of UI and CI</p></a></li>
<li><a href='#plot.uiprobit'><p>Plot of UI and CI</p></a></li>
<li><a href='#print.uicausal'><p>Print function for object of class uicausal</p></a></li>
<li><a href='#print.uiols'><p>Prints objects of class uiols</p></a></li>
<li><a href='#print.uiprobit'><p>Prints objects of class uiprobit</p></a></li>
<li><a href='#profile.uicausal'><p>Plot of UI and CI</p></a></li>
<li><a href='#profile.uiols'><p>Plot of UI and CI</p></a></li>
<li><a href='#profile.uiprobit'><p>Plot of UI and CI</p></a></li>
<li><a href='#sandACT'><p>Calculates standard error of Average causal effect on the treated</p></a></li>
<li><a href='#sandImpACE'><p>Calculates standard error of Average causal effect</p></a></li>
<li><a href='#sandImpACT'><p>Calculates standard error of Average causal effect on the treated</p></a></li>
<li><a href='#se.ols'><p>Calculation of se for OLS</p></a></li>
<li><a href='#sigmaOLScor0'><p>Correction of OLS sigma for causal effects</p></a></li>
<li><a href='#sigmaOLScor1'><p>Correction of OLS sigma</p></a></li>
<li><a href='#ui.causal'><p>Uncertainty intervals for Average Causal Effects</p></a></li>
<li><a href='#ui.ols'><p>Uncertainty intervals for OLS regression</p></a></li>
<li><a href='#ui.probit'><p>Uncertainty intervals for probit regression</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Uncertainty Intervals and Sensitivity Analysis for Missing Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Minna Genbaeck [aut, cre],</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Minna Genbaeck &lt;minna.genback@umu.se&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements functions to derive uncertainty intervals for (i) regression (linear and probit) parameters when outcome is missing not at random (non-ignorable missingness) introduced in Genbaeck, M., Stanghellini, E., de Luna, X. (2015) &lt;<a href="https://doi.org/10.1007%2Fs00362-014-0610-x">doi:10.1007/s00362-014-0610-x</a>&gt; and Genbaeck, M., Ng, N., Stanghellini, E., de Luna, X. (2018) &lt;<a href="https://doi.org/10.1007%2Fs10433-017-0448-x">doi:10.1007/s10433-017-0448-x</a>&gt;; and (ii) double robust and outcome regression estimators of average causal effects (on the treated) with possibly unobserved confounding introduced in Genbaeck, M., de Luna, X. (2018) &lt;<a href="https://doi.org/10.1111%2Fbiom.13001">doi:10.1111/biom.13001</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Matrix, maxLik, mvtnorm, numDeriv, graphics, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-11-11 12:21:42 UTC; miahjr04</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-11-11 13:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='gridrho.f'>Support function for <code><a href="#topic+ui.causal">ui.causal</a></code></h2><span id='topic+gridrho.f'></span>

<h3>Description</h3>

<p>Divides the <code>rho</code> interval into a grid
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gridrho.f(rho, gridn, rho.plotrange, plot)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gridrho.f_+3A_rho">rho</code></td>
<td>
<p>interval that should be divided</p>
</td></tr>
<tr><td><code id="gridrho.f_+3A_gridn">gridn</code></td>
<td>
<p>number of gridpoints</p>
</td></tr>
<tr><td><code id="gridrho.f_+3A_rho.plotrange">rho.plotrange</code></td>
<td>
<p>a larger interval of grids to be used in a plot</p>
</td></tr>
<tr><td><code id="gridrho.f_+3A_plot">plot</code></td>
<td>
<p>whether or not the larger interval of grids should be created</p>
</td></tr>
</table>

<hr>
<h2 id='grr'>Gradient for the loglikelihood used by ui.probit</h2><span id='topic+grr'></span>

<h3>Description</h3>

<p>This function derives the gradient in order for <code><a href="#topic+ui.probit">ui.probit</a></code> to run faster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grr(par, rho, X.z = X.z, X.y = X.y, y = y, z = z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grr_+3A_par">par</code></td>
<td>
<p>Coefficients.</p>
</td></tr>
<tr><td><code id="grr_+3A_rho">rho</code></td>
<td>
<p>Rho.</p>
</td></tr>
<tr><td><code id="grr_+3A_x.z">X.z</code></td>
<td>
<p>Covariate matrix for missingness.</p>
</td></tr>
<tr><td><code id="grr_+3A_x.y">X.y</code></td>
<td>
<p>Covariate matrix for outcome.</p>
</td></tr>
<tr><td><code id="grr_+3A_y">y</code></td>
<td>
<p>Outcome.</p>
</td></tr>
<tr><td><code id="grr_+3A_z">z</code></td>
<td>
<p>Missing or not.</p>
</td></tr>
</table>

<hr>
<h2 id='hess'>Hessian for the loglikelihood used by ui.probit</h2><span id='topic+hess'></span>

<h3>Description</h3>

<p>This function derives the hessian in order for <code><a href="#topic+ui.probit">ui.probit</a></code> to run faster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hess(par, rho, X.z = X.z, X.y = X.y, y = y, z = z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hess_+3A_par">par</code></td>
<td>
<p>Coefficients.</p>
</td></tr>
<tr><td><code id="hess_+3A_rho">rho</code></td>
<td>
<p>Rho.</p>
</td></tr>
<tr><td><code id="hess_+3A_x.z">X.z</code></td>
<td>
<p>Covariate matrix for missingness.</p>
</td></tr>
<tr><td><code id="hess_+3A_x.y">X.y</code></td>
<td>
<p>Covariate matrix for outcome.</p>
</td></tr>
<tr><td><code id="hess_+3A_y">y</code></td>
<td>
<p>Outcome.</p>
</td></tr>
<tr><td><code id="hess_+3A_z">z</code></td>
<td>
<p>Missing or not.</p>
</td></tr>
</table>

<hr>
<h2 id='interv.p'>Print interval in parantesis</h2><span id='topic+interv.p'></span>

<h3>Description</h3>

<p>This function allows you to print an interval (vector of two elements) in a parantesis single element.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interv.p(v, digits = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interv.p_+3A_v">v</code></td>
<td>
<p>Lower and upper bounds.</p>
</td></tr>
<tr><td><code id="interv.p_+3A_digits">digits</code></td>
<td>
<p>Number of decimals.</p>
</td></tr>
</table>

<hr>
<h2 id='lambda0'>Inverse Mills rato</h2><span id='topic+lambda0'></span>

<h3>Description</h3>

<p>This function allows you to calculate the inverse Mills ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambda0(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambda0_+3A_x">x</code></td>
<td>
<p>Vector</p>
</td></tr>
</table>

<hr>
<h2 id='lambda1'>Inverse Mills rato</h2><span id='topic+lambda1'></span>

<h3>Description</h3>

<p>This function allows you to calculate the inverse Mills ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambda1(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambda1_+3A_x">x</code></td>
<td>
<p>Vector</p>
</td></tr>
</table>

<hr>
<h2 id='LogL.probit'>Loglikelihood used by ui.probit</h2><span id='topic+LogL.probit'></span>

<h3>Description</h3>

<p>This function derives the Loglikelihood for <code><a href="#topic+ui.probit">ui.probit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LogL.probit(par, rho, X.z = X.z, X.y = X.y, y = y, z = z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LogL.probit_+3A_par">par</code></td>
<td>
<p>Coeficient values the logliklihood should be drived at.</p>
</td></tr>
<tr><td><code id="LogL.probit_+3A_rho">rho</code></td>
<td>
<p>The value of the sensitivity parameter.</p>
</td></tr>
<tr><td><code id="LogL.probit_+3A_x.z">X.z</code></td>
<td>
<p>covariate matrix for missingness mechanism</p>
</td></tr>
<tr><td><code id="LogL.probit_+3A_x.y">X.y</code></td>
<td>
<p>covariate matrix for the outcome regression</p>
</td></tr>
<tr><td><code id="LogL.probit_+3A_y">y</code></td>
<td>
<p>outcome vector</p>
</td></tr>
<tr><td><code id="LogL.probit_+3A_z">z</code></td>
<td>
<p>indicator of wether y is missing or not</p>
</td></tr>
</table>

<hr>
<h2 id='Logl.sandACT'>Loglikelohood used in sandwich estimator of average causal effect on the treated for DR</h2><span id='topic+Logl.sandACT'></span>

<h3>Description</h3>

<p>Loglikelohood used in sandwich estimator of average causal effect on the treated for DR, support function for <code><a href="#topic+ui.causal">ui.causal</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Logl.sandACT(x, X, z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Logl.sandACT_+3A_x">x</code></td>
<td>
<p>coefficents.</p>
</td></tr>
<tr><td><code id="Logl.sandACT_+3A_x">X</code></td>
<td>
<p>Covariate matrix.</p>
</td></tr>
<tr><td><code id="Logl.sandACT_+3A_z">z</code></td>
<td>
<p>Missing or not.</p>
</td></tr>
</table>

<hr>
<h2 id='ML.probit'>Fit maximum likelihood for fixed values of rho</h2><span id='topic+ML.probit'></span>

<h3>Description</h3>

<p>This is a support function for <code><a href="#topic+ui.probit">ui.probit</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ML.probit(out.formula, mis.formula = NULL, data, rho = c(-0.5, 0.5),
  progress = TRUE, method = "NR")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ML.probit_+3A_out.formula">out.formula</code></td>
<td>
<p>Formula for outcome regression.</p>
</td></tr>
<tr><td><code id="ML.probit_+3A_mis.formula">mis.formula</code></td>
<td>
<p>Formula for regression model for the missingness mechanism.</p>
</td></tr>
<tr><td><code id="ML.probit_+3A_data">data</code></td>
<td>
<p>Data frame containing the variables in the formulas</p>
</td></tr>
<tr><td><code id="ML.probit_+3A_rho">rho</code></td>
<td>
<p>Vector containing the values of rho for which we want to fit the likelihood.</p>
</td></tr>
<tr><td><code id="ML.probit_+3A_progress">progress</code></td>
<td>
<p>If TRUE prints out process time for each maximazation of the likelihood.</p>
</td></tr>
<tr><td><code id="ML.probit_+3A_method">method</code></td>
<td>
<p>Maximazation method to be passed through <code>maxLik</code></p>
</td></tr>
</table>

<hr>
<h2 id='plot.uicausal'>Plot of UI and CI</h2><span id='topic+plot.uicausal'></span>

<h3>Description</h3>

<p>Plot function for objects returned from <code><a href="#topic+ui.causal">ui.causal</a></code>.
Plots confidence intervals for different values of rho and the uncertainty interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'uicausal'
plot(x, DR = TRUE, main = "", xlab = NULL,
  ylab = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.uicausal_+3A_x">x</code></td>
<td>
<p>An object of class uicausal</p>
</td></tr>
<tr><td><code id="plot.uicausal_+3A_dr">DR</code></td>
<td>
<p>If TRUE the doubly robust estimator is plotted, otherwise the outcome regression estimator is plotted.</p>
</td></tr>
<tr><td><code id="plot.uicausal_+3A_main">main</code></td>
<td>
<p>Main title, default is no title.</p>
</td></tr>
<tr><td><code id="plot.uicausal_+3A_xlab">xlab</code></td>
<td>
<p>Title for xaxis, default is <code>expression(rho)</code>.</p>
</td></tr>
<tr><td><code id="plot.uicausal_+3A_ylab">ylab</code></td>
<td>
<p>Title for y axis, default is no title.</p>
</td></tr>
<tr><td><code id="plot.uicausal_+3A_...">...</code></td>
<td>
<p>Additional arguments, use is discouraged.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.uiols'>Plot of UI and CI</h2><span id='topic+plot.uiols'></span>

<h3>Description</h3>

<p>Plot function for objects returned from <code><a href="#topic+ui.ols">ui.ols</a></code>. Plots confidence intervals,
coefficients and significans assuming ignorability and the uncertainty interval under non-ignorability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'uiols'
plot(x, plot.all = TRUE, which = NA,
  intercept = FALSE, ylab = NULL, col = c("black", "red"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.uiols_+3A_x">x</code></td>
<td>
<p>An object of class uiols</p>
</td></tr>
<tr><td><code id="plot.uiols_+3A_plot.all">plot.all</code></td>
<td>
<p>If TRUE, plots all covariates.</p>
</td></tr>
<tr><td><code id="plot.uiols_+3A_which">which</code></td>
<td>
<p>Specify which variables should be plotted by either sending in their names in a vector or a vector with their numbers (1 intercept, 2 for the first covariate etc.).</p>
</td></tr>
<tr><td><code id="plot.uiols_+3A_intercept">intercept</code></td>
<td>
<p>If TRUE, also plots the intercept.</p>
</td></tr>
<tr><td><code id="plot.uiols_+3A_ylab">ylab</code></td>
<td>
<p>Vector of names for the y-axis, default is the variable names.</p>
</td></tr>
<tr><td><code id="plot.uiols_+3A_col">col</code></td>
<td>
<p>Vector containing the color of confidence intervals (default black) and uncertainty intervals (default red).</p>
</td></tr>
<tr><td><code id="plot.uiols_+3A_...">...</code></td>
<td>
<p>Additional arguments, use is discouraged.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.uiprobit'>Plot of UI and CI</h2><span id='topic+plot.uiprobit'></span>

<h3>Description</h3>

<p>Plot function for objects returned from <code><a href="#topic+ui.probit">ui.probit</a></code>.
Plots confidence intervals, coefficients and significans assuming ignorability and the uncertainty interval under non-ignorability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'uiprobit'
plot(x, plot.all = TRUE, which = NA,
  intercept = FALSE, ylab = NULL, col = c("black", "red"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.uiprobit_+3A_x">x</code></td>
<td>
<p>An object of class uiprobit</p>
</td></tr>
<tr><td><code id="plot.uiprobit_+3A_plot.all">plot.all</code></td>
<td>
<p>If TRUE, plots all covariates.</p>
</td></tr>
<tr><td><code id="plot.uiprobit_+3A_which">which</code></td>
<td>
<p>Specify which variables should be plotted by either sending in their names in a vector or a vector with their numbers (1 for the first covariate, 2 for the second etc.).To plot the intercept, set intercept as TRUE.</p>
</td></tr>
<tr><td><code id="plot.uiprobit_+3A_intercept">intercept</code></td>
<td>
<p>If TRUE, also plots the intercept.</p>
</td></tr>
<tr><td><code id="plot.uiprobit_+3A_ylab">ylab</code></td>
<td>
<p>Vector of names for the y-axis, default is the variable names.</p>
</td></tr>
<tr><td><code id="plot.uiprobit_+3A_col">col</code></td>
<td>
<p>Vector containing the color of confidence intervals (default black) and uncertainty intervals (default red).</p>
</td></tr>
<tr><td><code id="plot.uiprobit_+3A_...">...</code></td>
<td>
<p>Additional arguments, use is discouraged.</p>
</td></tr>
</table>

<hr>
<h2 id='print.uicausal'>Print function for object of class uicausal</h2><span id='topic+print.uicausal'></span>

<h3>Description</h3>

<p>Print function for object of class uicausal
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'uicausal'
print(x, digits = 3, digitsci = digits,
  digitsui = digits, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.uicausal_+3A_x">x</code></td>
<td>
<p>An object of returned from <code><a href="#topic+ui.causal">ui.causal</a></code></p>
</td></tr>
<tr><td><code id="print.uicausal_+3A_digits">digits</code></td>
<td>
<p>number of digits to be printed.</p>
</td></tr>
<tr><td><code id="print.uicausal_+3A_digitsci">digitsci</code></td>
<td>
<p>number of digits to be printed in the confidence interval.</p>
</td></tr>
<tr><td><code id="print.uicausal_+3A_digitsui">digitsui</code></td>
<td>
<p>number of digits to be printed in the uncertainty interval.</p>
</td></tr>
<tr><td><code id="print.uicausal_+3A_...">...</code></td>
<td>
<p>Additional arguments, use is discouraged.</p>
</td></tr>
</table>

<hr>
<h2 id='print.uiols'>Prints objects of class uiols</h2><span id='topic+print.uiols'></span>

<h3>Description</h3>

<p>Prints objects of class uiols
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'uiols'
print(x, digits = 3, digitsci = digits,
  digitsui = digits, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.uiols_+3A_x">x</code></td>
<td>
<p>an objects returned from <code><a href="#topic+ui.ols">ui.ols</a></code></p>
</td></tr>
<tr><td><code id="print.uiols_+3A_digits">digits</code></td>
<td>
<p>number of digits to be printed.</p>
</td></tr>
<tr><td><code id="print.uiols_+3A_digitsci">digitsci</code></td>
<td>
<p>number of digits to be printed in the confidence interval.</p>
</td></tr>
<tr><td><code id="print.uiols_+3A_digitsui">digitsui</code></td>
<td>
<p>number of digits to be printed in the uncertainty interval.</p>
</td></tr>
<tr><td><code id="print.uiols_+3A_...">...</code></td>
<td>
<p>Additional arguments, use is discouraged.</p>
</td></tr>
</table>

<hr>
<h2 id='print.uiprobit'>Prints objects of class uiprobit</h2><span id='topic+print.uiprobit'></span>

<h3>Description</h3>

<p>Prints objects of class uiprobit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'uiprobit'
print(x, digits = 3, digitsci = digits,
  digitsui = digits, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.uiprobit_+3A_x">x</code></td>
<td>
<p>an objects returned from <code><a href="#topic+ui.probit">ui.probit</a></code></p>
</td></tr>
<tr><td><code id="print.uiprobit_+3A_digits">digits</code></td>
<td>
<p>number of digits to be printed.</p>
</td></tr>
<tr><td><code id="print.uiprobit_+3A_digitsci">digitsci</code></td>
<td>
<p>number of digits to be printed in the confidence interval.</p>
</td></tr>
<tr><td><code id="print.uiprobit_+3A_digitsui">digitsui</code></td>
<td>
<p>number of digits to be printed in the uncertainty interval.</p>
</td></tr>
<tr><td><code id="print.uiprobit_+3A_...">...</code></td>
<td>
<p>Additional arguments, use is discouraged.</p>
</td></tr>
</table>

<hr>
<h2 id='profile.uicausal'>Plot of UI and CI</h2><span id='topic+profile.uicausal'></span>

<h3>Description</h3>

<p>Plot function for objects returned from <code><a href="#topic+ui.causal">ui.causal</a></code>.
Plots confidence intervals for different values of rho0=rho1=rho.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'uicausal'
profile(fitted, DR = TRUE, main = "", xlab = NULL,
  ylab = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="profile.uicausal_+3A_fitted">fitted</code></td>
<td>
<p>An object of class uicausal</p>
</td></tr>
<tr><td><code id="profile.uicausal_+3A_dr">DR</code></td>
<td>
<p>If TRUE, plots both DR if FALSE OR.</p>
</td></tr>
<tr><td><code id="profile.uicausal_+3A_main">main</code></td>
<td>
<p>Main title, default is no title.</p>
</td></tr>
<tr><td><code id="profile.uicausal_+3A_xlab">xlab</code></td>
<td>
<p>Title for x-axis, default is <code>expression(rho)</code>.</p>
</td></tr>
<tr><td><code id="profile.uicausal_+3A_ylab">ylab</code></td>
<td>
<p>Title for y-axis, default is the variable names.</p>
</td></tr>
<tr><td><code id="profile.uicausal_+3A_...">...</code></td>
<td>
<p>Additional arguments, use is discouraged.</p>
</td></tr>
</table>

<hr>
<h2 id='profile.uiols'>Plot of UI and CI</h2><span id='topic+profile.uiols'></span>

<h3>Description</h3>

<p>Plot function for objects returned from <code><a href="#topic+ui.ols">ui.ols</a></code>.
Plots confidence intervals for different values of rho and the uncertainty interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'uiols'
profile(fitted, plot.all = TRUE, which = NA,
  intercept = FALSE, xlab = NULL, ylab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="profile.uiols_+3A_fitted">fitted</code></td>
<td>
<p>An object of class uiols</p>
</td></tr>
<tr><td><code id="profile.uiols_+3A_plot.all">plot.all</code></td>
<td>
<p>If TRUE, plots all covariates.</p>
</td></tr>
<tr><td><code id="profile.uiols_+3A_which">which</code></td>
<td>
<p>Specify which variables should be plotted by either sending in their names in a vector or a vector with their numbers (1 intercept, 2 for the first covariate etc.).</p>
</td></tr>
<tr><td><code id="profile.uiols_+3A_intercept">intercept</code></td>
<td>
<p>If TRUE, also plots the intercept.</p>
</td></tr>
<tr><td><code id="profile.uiols_+3A_xlab">xlab</code></td>
<td>
<p>Title for x-axis, default is <code>expression(rho)</code>.</p>
</td></tr>
<tr><td><code id="profile.uiols_+3A_ylab">ylab</code></td>
<td>
<p>Title for y-axis, default is the variable names.</p>
</td></tr>
<tr><td><code id="profile.uiols_+3A_...">...</code></td>
<td>
<p>Additional arguments, for instance margins.</p>
</td></tr>
</table>

<hr>
<h2 id='profile.uiprobit'>Plot of UI and CI</h2><span id='topic+profile.uiprobit'></span>

<h3>Description</h3>

<p>Plot function for objects returned from <code><a href="#topic+ui.probit">ui.probit</a></code>.
Plots confidence intervals for different values of rho and the uncertainty interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'uiprobit'
profile(fitted, plot.all = TRUE, which = NA,
  intercept = FALSE, xlab = NULL, ylab = NULL, cex.lab = 2,
  mar = c(6, 6, 2, 2), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="profile.uiprobit_+3A_fitted">fitted</code></td>
<td>
<p>An object of class uiprobit</p>
</td></tr>
<tr><td><code id="profile.uiprobit_+3A_plot.all">plot.all</code></td>
<td>
<p>If TRUE, plots all covariates.</p>
</td></tr>
<tr><td><code id="profile.uiprobit_+3A_which">which</code></td>
<td>
<p>Specify which variables should be plotted by either sending in their names in a vector or a vector with their numbers (1 intercept, 2 for the first covariate etc.).</p>
</td></tr>
<tr><td><code id="profile.uiprobit_+3A_intercept">intercept</code></td>
<td>
<p>If TRUE, also plots the intercept.</p>
</td></tr>
<tr><td><code id="profile.uiprobit_+3A_xlab">xlab</code></td>
<td>
<p>Title for x-axis, default is <code>expression(rho)</code>.</p>
</td></tr>
<tr><td><code id="profile.uiprobit_+3A_ylab">ylab</code></td>
<td>
<p>Title for y-axis, default is the variable names.</p>
</td></tr>
<tr><td><code id="profile.uiprobit_+3A_cex.lab">cex.lab</code></td>
<td>
<p>Size of lables.</p>
</td></tr>
<tr><td><code id="profile.uiprobit_+3A_mar">mar</code></td>
<td>
<p>Margin around panels in plot.</p>
</td></tr>
<tr><td><code id="profile.uiprobit_+3A_...">...</code></td>
<td>
<p>Additional arguments, use is discouraged.</p>
</td></tr>
</table>

<hr>
<h2 id='sandACT'>Calculates standard error of Average causal effect on the treated</h2><span id='topic+sandACT'></span>

<h3>Description</h3>

<p>This is a support function for <code><a href="#topic+ui.causal">ui.causal</a></code> and calculates standard error of Average causal effect on the treated for the doubly robust estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sandACT(deltasigma1, X, Xz, y, z, u, BetaOLSy0, phat, NaivEst, n1, n0, N,
  p, pz)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sandACT_+3A_deltasigma1">deltasigma1</code></td>
<td>
<p>Coefficients.</p>
</td></tr>
<tr><td><code id="sandACT_+3A_x">X</code></td>
<td>
<p>Covariate matrix outcome.</p>
</td></tr>
<tr><td><code id="sandACT_+3A_xz">Xz</code></td>
<td>
<p>Covariate matrix treatment.</p>
</td></tr>
<tr><td><code id="sandACT_+3A_y">y</code></td>
<td>
<p>Outcome vector.</p>
</td></tr>
<tr><td><code id="sandACT_+3A_z">z</code></td>
<td>
<p>Missingness indicator.</p>
</td></tr>
<tr><td><code id="sandACT_+3A_u">u</code></td>
<td>
<p>Fitted values from propensity score regression.</p>
</td></tr>
<tr><td><code id="sandACT_+3A_betaolsy0">BetaOLSy0</code></td>
<td>
<p>Coefficients from non-treated regression</p>
</td></tr>
<tr><td><code id="sandACT_+3A_phat">phat</code></td>
<td>
<p>Fitted propensity scores.</p>
</td></tr>
<tr><td><code id="sandACT_+3A_naivest">NaivEst</code></td>
<td>
<p>Naiv estimates.</p>
</td></tr>
<tr><td><code id="sandACT_+3A_n1">n1</code></td>
<td>
<p>Number of treated.</p>
</td></tr>
<tr><td><code id="sandACT_+3A_n0">n0</code></td>
<td>
<p>Number of non-treated.</p>
</td></tr>
<tr><td><code id="sandACT_+3A_n">N</code></td>
<td>
<p>Total number.</p>
</td></tr>
<tr><td><code id="sandACT_+3A_p">p</code></td>
<td>
<p>Number of covariates outcome regression.</p>
</td></tr>
<tr><td><code id="sandACT_+3A_pz">pz</code></td>
<td>
<p>Number of covariates treatment regression.</p>
</td></tr>
</table>

<hr>
<h2 id='sandImpACE'>Calculates standard error of Average causal effect</h2><span id='topic+sandImpACE'></span>

<h3>Description</h3>

<p>This is a support function for <code><a href="#topic+ui.causal">ui.causal</a></code> and calculates standard error of Average causal effect for the regression imputation estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sandImpACE(X, y, z, BetaOLSy0, BetaOLSy1, NaivEst, N, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sandImpACE_+3A_x">X</code></td>
<td>
<p>Covariate matrix.</p>
</td></tr>
<tr><td><code id="sandImpACE_+3A_y">y</code></td>
<td>
<p>Outcome vector.</p>
</td></tr>
<tr><td><code id="sandImpACE_+3A_z">z</code></td>
<td>
<p>missingness indicator.</p>
</td></tr>
<tr><td><code id="sandImpACE_+3A_betaolsy0">BetaOLSy0</code></td>
<td>
<p>Coefficients from non-treated regression.</p>
</td></tr>
<tr><td><code id="sandImpACE_+3A_betaolsy1">BetaOLSy1</code></td>
<td>
<p>Coefficients from treated regression.</p>
</td></tr>
<tr><td><code id="sandImpACE_+3A_naivest">NaivEst</code></td>
<td>
<p>Naiv estimates.</p>
</td></tr>
<tr><td><code id="sandImpACE_+3A_n">N</code></td>
<td>
<p>Total number.</p>
</td></tr>
<tr><td><code id="sandImpACE_+3A_p">p</code></td>
<td>
<p>Number of covariates outcome regression.</p>
</td></tr>
</table>

<hr>
<h2 id='sandImpACT'>Calculates standard error of Average causal effect on the treated</h2><span id='topic+sandImpACT'></span>

<h3>Description</h3>

<p>This is a support function for <code><a href="#topic+ui.causal">ui.causal</a></code> and calculates standard error of Average causal effect on the treated for the regression imputation estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sandImpACT(X, y, z, BetaOLSy0, NaivEst, n1, N, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sandImpACT_+3A_x">X</code></td>
<td>
<p>Covariate matrix.</p>
</td></tr>
<tr><td><code id="sandImpACT_+3A_y">y</code></td>
<td>
<p>Outcome vector.</p>
</td></tr>
<tr><td><code id="sandImpACT_+3A_z">z</code></td>
<td>
<p>missingness indicator</p>
</td></tr>
<tr><td><code id="sandImpACT_+3A_betaolsy0">BetaOLSy0</code></td>
<td>
<p>Coefficients from non-treated regression</p>
</td></tr>
<tr><td><code id="sandImpACT_+3A_naivest">NaivEst</code></td>
<td>
<p>Naiv estimates.</p>
</td></tr>
<tr><td><code id="sandImpACT_+3A_n1">n1</code></td>
<td>
<p>Number of treated.</p>
</td></tr>
<tr><td><code id="sandImpACT_+3A_n">N</code></td>
<td>
<p>Total number.</p>
</td></tr>
<tr><td><code id="sandImpACT_+3A_p">p</code></td>
<td>
<p>Number of covariates outcome regression.</p>
</td></tr>
</table>

<hr>
<h2 id='se.ols'>Calculation of se for OLS</h2><span id='topic+se.ols'></span>

<h3>Description</h3>

<p>This function calculates the se for UI based on OLS when we have MNAR data, for <code><a href="#topic+ui.ols">ui.ols</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>se.ols(X, sigmaOLScor, u, gridrho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="se.ols_+3A_x">X</code></td>
<td>
<p>Covariate matrix.</p>
</td></tr>
<tr><td><code id="se.ols_+3A_sigmaolscor">sigmaOLScor</code></td>
<td>
<p>Output from sigmaOLScor1</p>
</td></tr>
<tr><td><code id="se.ols_+3A_u">u</code></td>
<td>
<p>Fitted values from mis.model.</p>
</td></tr>
<tr><td><code id="se.ols_+3A_gridrho">gridrho</code></td>
<td>
<p>Values of rho.</p>
</td></tr>
</table>

<hr>
<h2 id='sigmaOLScor0'>Correction of OLS sigma for causal effects</h2><span id='topic+sigmaOLScor0'></span>

<h3>Description</h3>

<p>This function is a bias correction of the residual standard deviation under MNAR, for <code><a href="#topic+ui.causal">ui.causal</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigmaOLScor0(X, sigmaOLS, n, p, u, gridrho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sigmaOLScor0_+3A_x">X</code></td>
<td>
<p>Covariate matrix outcome.</p>
</td></tr>
<tr><td><code id="sigmaOLScor0_+3A_sigmaols">sigmaOLS</code></td>
<td>
<p>Residual sd from outcome regression.</p>
</td></tr>
<tr><td><code id="sigmaOLScor0_+3A_n">n</code></td>
<td>
<p>Number of complete cases.</p>
</td></tr>
<tr><td><code id="sigmaOLScor0_+3A_p">p</code></td>
<td>
<p>Number of covariates outcome regression.</p>
</td></tr>
<tr><td><code id="sigmaOLScor0_+3A_u">u</code></td>
<td>
<p>Fitted values from propensity score regression.</p>
</td></tr>
<tr><td><code id="sigmaOLScor0_+3A_gridrho">gridrho</code></td>
<td>
<p>Values of rho.</p>
</td></tr>
</table>

<hr>
<h2 id='sigmaOLScor1'>Correction of OLS sigma</h2><span id='topic+sigmaOLScor1'></span>

<h3>Description</h3>

<p>This function is a bias correction of the residual standard deviation under MNAR, used by <code><a href="#topic+ui.causal">ui.causal</a></code> and <code><a href="#topic+ui.ols">ui.ols</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigmaOLScor1(X, sigmaOLS, n, p, u, gridrho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sigmaOLScor1_+3A_x">X</code></td>
<td>
<p>Covariate matrix outcome.</p>
</td></tr>
<tr><td><code id="sigmaOLScor1_+3A_sigmaols">sigmaOLS</code></td>
<td>
<p>Residual sd from outcome regression.</p>
</td></tr>
<tr><td><code id="sigmaOLScor1_+3A_n">n</code></td>
<td>
<p>Number of complete cases.</p>
</td></tr>
<tr><td><code id="sigmaOLScor1_+3A_p">p</code></td>
<td>
<p>Number of covariates outcome regression.</p>
</td></tr>
<tr><td><code id="sigmaOLScor1_+3A_u">u</code></td>
<td>
<p>Fitted values from propensity score regression.</p>
</td></tr>
<tr><td><code id="sigmaOLScor1_+3A_gridrho">gridrho</code></td>
<td>
<p>Values of rho.</p>
</td></tr>
</table>

<hr>
<h2 id='ui.causal'>Uncertainty intervals for Average Causal Effects</h2><span id='topic+ui.causal'></span>

<h3>Description</h3>

<p>This function allows you to derive uncertainty intervals for the average causal effect (ACE) or the average causal effect on the treated (ACT). The function uses a regression imputation estimator and a doubly robust estimator. The uncertainty intervals can be used as a sensitivity analysis to unconfoundedness. Note that <code>rho</code>=0 render the same results as assuming no unobserved confounding.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ui.causal(out.formula, treat.formula, data, rho = c(-0.3, 0.3),
  rho0 = NULL, rho1 = NULL, ACT = FALSE, sand = TRUE, gridn = 21,
  plot = TRUE, rho.plotrange = c(-0.5, 0.5), alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ui.causal_+3A_out.formula">out.formula</code></td>
<td>
<p>Formula for the outcome regression models</p>
</td></tr>
<tr><td><code id="ui.causal_+3A_treat.formula">treat.formula</code></td>
<td>
<p>Formula for the propensity score model (regression model for treatment assignment).</p>
</td></tr>
<tr><td><code id="ui.causal_+3A_data">data</code></td>
<td>
<p>data.frame containing the variables in the formula.</p>
</td></tr>
<tr><td><code id="ui.causal_+3A_rho">rho</code></td>
<td>
<p>Pre-specified interval for <code>rho0</code> and <code>rho1</code>.</p>
</td></tr>
<tr><td><code id="ui.causal_+3A_rho0">rho0</code></td>
<td>
<p>Pre-specified value of <code>rho0</code>, if an interval it has to be the same as <code>rho1</code>.</p>
</td></tr>
<tr><td><code id="ui.causal_+3A_rho1">rho1</code></td>
<td>
<p>Pre-specified value of <code>rho1</code>, if an interval it has to be the same as <code>rho0</code>.</p>
</td></tr>
<tr><td><code id="ui.causal_+3A_act">ACT</code></td>
<td>
<p>If TRUE Average Causal effect of the Treated is calculated, if FALSE Average Causal effect is calculated. Default is FALSE.</p>
</td></tr>
<tr><td><code id="ui.causal_+3A_sand">sand</code></td>
<td>
<p>Specifies which estimator of the standard errors should be used for OR, see details.</p>
</td></tr>
<tr><td><code id="ui.causal_+3A_gridn">gridn</code></td>
<td>
<p>Number of fixed points within the <code>rho</code> interval for which sigma0 and sigma1 should be estimated.</p>
</td></tr>
<tr><td><code id="ui.causal_+3A_plot">plot</code></td>
<td>
<p>If TRUE the function runs slightly slower but you will be able to plot your results using <code><a href="#topic+plot.uicausal">plot.uicausal</a></code>.</p>
</td></tr>
<tr><td><code id="ui.causal_+3A_rho.plotrange">rho.plotrange</code></td>
<td>
<p>an interval larger than <code>rho</code> for the plot using <code><a href="#topic+plot.uicausal">plot.uicausal</a></code>.</p>
</td></tr>
<tr><td><code id="ui.causal_+3A_alpha">alpha</code></td>
<td>
<p>Default 0.05 corresponding to a confidence level of 95 for CI and UI.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In order to visualize the results, you can use <code><a href="#topic+plot.uicausal">plot.uicausal</a></code>. Details about estimators can be found in Genbäck and de Luna (2018)
</p>
<p>The standard errors are calculated with the following estimators:
</p>
<p>DR ACE - simplified sandwich estimator
</p>
<p>DR ACT - sandwich estimator
</p>
<p>OR ACE - if sand=TRUE sandwich estimator (default and recommended), if sand=FALSE large sample variance
</p>
<p>OR ACT - if sand=TRUE sandwich estimator (default and recommended), if sand=FALSE large sample variance
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The matched call</p>
</td></tr>
<tr><td><code>rho0</code></td>
<td>
<p>The rage of <code>rho0</code> from which the ui is calculated</p>
</td></tr>
<tr><td><code>rho1</code></td>
<td>
<p>If ACT==FALSE,range of <code>rho1</code> from which the ui is calculated</p>
</td></tr>
<tr><td><code>out.model0</code></td>
<td>
<p>Outcome regression model for non-treated.</p>
</td></tr>
<tr><td><code>out.model1</code></td>
<td>
<p>Outcome regression model for treated.</p>
</td></tr>
<tr><td><code>treat.model</code></td>
<td>
<p>Regression model for treatment mechanism (propensity score).</p>
</td></tr>
<tr><td><code>sigma0</code></td>
<td>
<p>Consistent estimate of sigma0 for different values of rho0</p>
</td></tr>
<tr><td><code>sigma1</code></td>
<td>
<p>Consistent estimate of sigma1 for different values of rho1</p>
</td></tr>
<tr><td><code>DR</code></td>
<td>
<p>DR inference, confidence intervals for different pre-specified values of <code>rho</code> for the OR estimator, uncertainty interval, coefficient estimates, confounding bias, indentification interval, standard error etc.</p>
</td></tr>
<tr><td><code>OR</code></td>
<td>
<p>OR inference, confidence intervals for different pre-specified values of <code>rho</code> for the OR estimator, uncertainty interval, coefficient estimates, confounding bias, indentification interval, standard error etc.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Minna Genbäck
</p>


<h3>References</h3>

<p>Genbäck, M., de Luna, X. (2018). Causal Inference Accounting for Unobserved Confounding after Outcome Regression and Doubly Robust Estimation. <em>Biometrics</em>. DOI: 10.1111/biom.13001
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
n&lt;-500
delta&lt;-c(-0.3,0.65)
rho&lt;-0.3
X&lt;-cbind(rep(1,n),rnorm(n))
x&lt;-X[,-1]
s0&lt;-2
s1&lt;-3
error&lt;-mvrnorm(n, c(0,0,0), matrix(c(1,0.6,0.9,0.6,4,0.54,0.9,0.54,9), ncol=3))
zstar&lt;-X%*%delta+error[,1]
z&lt;- zstar&gt;0
y1&lt;-ifelse(x&lt; (-1),0.2*x-0.1*x^2, ifelse(x&lt; 1,0.3*x, ifelse(x&lt;3,0.4-0.1*x^2,-0.2-0.1*x)))+error[,3]
y0&lt;-ifelse(x&lt;1.5, x-0.4*x^2, ifelse(x&lt;2, -0.15-0.25*x+0.5*x^2, 1.85-0.25*x))+error[,2]
y&lt;-y0
y[z==1]&lt;-y1[z==1]
data&lt;-data.frame(y,z,x)


ui&lt;-ui.causal(y~x, z~x, data=data, rho=c(0,0.3), ACT=FALSE)
ui
plot(ui)
profile(ui)
mean(y1-y0)

ui&lt;-ui.causal(y~x, z~x, data=data, rho=c(0,0.3), ACT=TRUE)
ui
plot(ui)
mean(y1[z==1]-y0[z==1])

</code></pre>

<hr>
<h2 id='ui.ols'>Uncertainty intervals for OLS regression</h2><span id='topic+ui.ols'></span>

<h3>Description</h3>

<p>This function allows you to derive uncertainty intervals for OLS regression when there is missing data in the continuous outcome. The uncertainty intervals can be used as a sensitivity analysis to ignorability (missing at random). Note that rho=0 render the same results as a complete case analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ui.ols(out.formula, mis.formula = NULL, data, rho = c(-0.3, 0.3),
  alpha = 0.05, gridn = 101)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ui.ols_+3A_out.formula">out.formula</code></td>
<td>
<p>Formula for outcome regression.</p>
</td></tr>
<tr><td><code id="ui.ols_+3A_mis.formula">mis.formula</code></td>
<td>
<p>Formula for missingness mechanism. If NULL the same covariates as in the outcome regression will be used.</p>
</td></tr>
<tr><td><code id="ui.ols_+3A_data">data</code></td>
<td>
<p>data.frame containing the variables in the formula.</p>
</td></tr>
<tr><td><code id="ui.ols_+3A_rho">rho</code></td>
<td>
<p>The limits of rho for which the uncertainty interval should be constructed.</p>
</td></tr>
<tr><td><code id="ui.ols_+3A_alpha">alpha</code></td>
<td>
<p>Default 0.05 corresponding to a confidence level of 95 for CI and UI.</p>
</td></tr>
<tr><td><code id="ui.ols_+3A_gridn">gridn</code></td>
<td>
<p>The number of distinct points within the interval <code>rho</code> at which confidence intervals should be constructed. Default is 101.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In order to visualize the results, you can use <code><a href="#topic+plot.uiols">plot.uiols</a></code>, 
or <code><a href="#topic+profile.uiols">profile.uiols</a></code>.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The matched call</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>Confidence intervals for different values of <code>rho</code></p>
</td></tr>
<tr><td><code>ui</code></td>
<td>
<p>Uncertainty intervals</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>Estimated coefficients (outcome regression) for different values of <code>rho</code></p>
</td></tr>
<tr><td><code>out.model</code></td>
<td>
<p>Outcome regression model when rho=0.</p>
</td></tr>
<tr><td><code>mis.model</code></td>
<td>
<p>Regression model for missingness mechanism (selection).</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>The range of <code>rho</code> for which we want to construct an uncertainty interval</p>
</td></tr>
<tr><td><code>gridrho</code></td>
<td>
<p>The values of <code>rho</code> for which bias and standard errors are derived</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Consistant estimate of sigma</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>Standard error for different values of <code>rho</code></p>
</td></tr>
<tr><td><code>ciols</code></td>
<td>
<p>Confidence intervals from a complete case analysis</p>
</td></tr>
<tr><td><code>ident.bound</code></td>
<td>
<p>Bounds for the coefficient estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Minna Genbäck
</p>


<h3>References</h3>

<p>Genbäck, M., Stanghellini, E., de Luna, X. (2015). Uncertainty Intervals for Regression Parameters with Non-ignorable Missingness in the Outcome. <em>Statistical Papers</em>, 56(3), 829-847.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
n&lt;-500
delta&lt;-c(0.5,0.3,0.1)
beta&lt;-c(0.8,-0.2,0.3)
X&lt;-cbind(rep(1,n),rnorm(n),rbinom(n,1,0.5))
x&lt;-X[,-1]
rho=0.4
error&lt;-mvrnorm(n,c(0,0),matrix(c(1,rho*2,rho*2,4),2))
zstar&lt;-X%*%delta+error[,1]
z&lt;-as.numeric(zstar&gt;0)
y&lt;-X%*%beta+error[,2]
y[z==0]&lt;-NA
data&lt;-data.frame(y,x,z)
ui&lt;-ui.ols(y~X1+X2,data=data,rho=c(-0.5,0.5))
ui
plot(ui)

</code></pre>

<hr>
<h2 id='ui.probit'>Uncertainty intervals for probit regression</h2><span id='topic+ui.probit'></span>

<h3>Description</h3>

<p>This function allows you to derive uncertainty intervals for probit regression
when there is missing data in the binary outcome. The uncertainty intervals
can be used as a sensitivity analysis to ignorability (missing at random), and
are derived by maximum likelihood. Note that <code>rho</code>=0 render the same results as
a complete case analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ui.probit(out.formula, mis.formula = NULL, data, rho = c(-0.3, 0.3),
  progress = TRUE, max.grid = 0.1, alpha = 0.05, method = "NR")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ui.probit_+3A_out.formula">out.formula</code></td>
<td>
<p>Formula for outcome regression.</p>
</td></tr>
<tr><td><code id="ui.probit_+3A_mis.formula">mis.formula</code></td>
<td>
<p>Formula for missingness mechanism. If NULL the same covariates as in the outcome regression will be used.</p>
</td></tr>
<tr><td><code id="ui.probit_+3A_data">data</code></td>
<td>
<p>data.frame containing the variables in the formula.</p>
</td></tr>
<tr><td><code id="ui.probit_+3A_rho">rho</code></td>
<td>
<p>Vector containing the values of <code>rho</code> for which we want to fit the
likelihood.</p>
</td></tr>
<tr><td><code id="ui.probit_+3A_progress">progress</code></td>
<td>
<p>If TRUE prints out process time for each maximization of the likelihood.</p>
</td></tr>
<tr><td><code id="ui.probit_+3A_max.grid">max.grid</code></td>
<td>
<p>Maximum distance between two elements in <code>rho</code>, if two wide there can 
difficulties with convergence of the maximum likelihood.</p>
</td></tr>
<tr><td><code id="ui.probit_+3A_alpha">alpha</code></td>
<td>
<p>Default 0.05 corresponding to a confidence level of 95 for CI and UI.</p>
</td></tr>
<tr><td><code id="ui.probit_+3A_method">method</code></td>
<td>
<p>Maximization method to be passed through <code>maxLik</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>In order to visualize the results, you can use <code><a href="#topic+plot.uiprobit">plot.uiprobit</a></code> 
or <code><a href="#topic+profile.uiprobit">profile.uiprobit</a></code>.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>coef</code></td>
<td>
<p>Estimated coefficients (outcome regression) for different values of <code>rho</code>.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>The values of <code>rho</code> for which the likelihood is maximized.</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>Covariance matrix.</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>Confidence intervals for different values of <code>rho</code>.</p>
</td></tr>
<tr><td><code>ui</code></td>
<td>
<p>Uncertainty intervals.</p>
</td></tr>
<tr><td><code>out.model</code></td>
<td>
<p>Outcome regression model when rho=0.</p>
</td></tr>
<tr><td><code>mis.model</code></td>
<td>
<p>Regression model for missingness mechanism (selection).</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>Standard errors from outcome regression.</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>Value of maximum likelihood for different values of <code>rho</code>.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Outcome vector.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Indicator variable of observed outcome.</p>
</td></tr>
<tr><td><code>X.y</code></td>
<td>
<p>Covariate matrix for outcome regression.</p>
</td></tr>
<tr><td><code>X.z</code></td>
<td>
<p>Covariate matrix for missingness mechanism (selection regression model).</p>
</td></tr>
<tr><td><code>max.info</code></td>
<td>
<p>Information about the maximization procedure. Includes whether it <code>converged</code>, <code>message</code>, <code>method</code> and <code>number of iterations</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Minna Genbäck
</p>


<h3>References</h3>

<p>Genbäck, M., Ng, N., Stanghellini, E., de Luna, X. (2018). Predictors of Decline in Self-reported Health: Addressing Non-ignorable Dropout in Longitudinal Studies of Aging. <em>European journal of ageing</em>, 15(2), 211-220.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
n&lt;-500

delta&lt;-c(0.5,0.6,0.1,-1,1)
beta&lt;-c(-0.3,-0.5,0,-0.4,-0.3)

X&lt;-cbind(rep(1,n),rnorm(n),runif(n),rbinom(n,2,0.5),rbinom(n,1,0.5))
x&lt;-X[,-1]
rho=0.4
error&lt;-mvrnorm(n,c(0,0),matrix(c(1,rho,rho,1),2))

zstar&lt;-X%*%delta+error[,1]
z&lt;-as.numeric(zstar&gt;0)

ystar&lt;-X%*%beta+error[,2]
y&lt;-as.integer(ystar&gt;0)
y[z==0]&lt;-NA
data=data.frame(y=y,x1=x[,1],x2=x[,2],x3=x[,3],x4=x[,4])

m&lt;-ui.probit(y~x1+x2+x3+x4,data=data,rho=c(0,0.5))
m
plot(m)
profile(m)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
