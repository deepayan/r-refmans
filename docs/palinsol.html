<!DOCTYPE html><html><head><title>Help for package palinsol</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {palinsol}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AnnualMean'><p>Annual Mean insolation</p></a></li>
<li><a href='#astro'><p>Compute astronomical parameters in the past or in the future</p></a></li>
<li><a href='#BER78'><p>Tables supplied by BER78 and BER90</p></a></li>
<li><a href='#calins'><p>Caloric insolation</p></a></li>
<li><a href='#day2l'><p>Converts calendar day into true solar longitude and vice-versa</p></a></li>
<li><a href='#Insol'><p>Computes incoming solar radiation (insolation)</p></a></li>
<li><a href='#Insol_l1l2'><p>Time-integrated insolation</p></a></li>
<li><a href='#LA04'><p>Astronomical elements supplied by Laskar et al. 2004</p></a></li>
<li><a href='#Milankovitch'><p>Milankovitch graph for a given astronomical configuration</p></a></li>
<li><a href='#plot.Milankovitch'><p>plot Milankovitch graph</p></a></li>
<li><a href='#polar_night'><p>Begin and end of the polar night</p></a></li>
<li><a href='#thrins'><p>Integrated insolation for all days exceeding a threshold</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-14</td>
</tr>
<tr>
<td>Title:</td>
<td>Insolation for Palaeoclimate Studies</td>
</tr>
<tr>
<td>Author:</td>
<td>Michel Crucifix <a href="https://orcid.org/0000-0002-3437-4911"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michel Crucifix &lt;michel.crucifix@uclouvain.be&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), stats, graphics</td>
</tr>
<tr>
<td>Suggests:</td>
<td>gsl</td>
</tr>
<tr>
<td>Description:</td>
<td>R package to compute Incoming Solar Radiation (insolation) for palaeoclimate studies. Features three solutions: Berger (1978), Berger and Loutre (1991) and Laskar et al. (2004). Computes daily-mean, season-averaged and annual means and for all latitudes, and polar night dates.</td>
</tr>
<tr>
<td>License:</td>
<td>file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>KeepSource:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mcrucifix/palinsol">https://github.com/mcrucifix/palinsol</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mcrucifix/palinsol/issues">https://github.com/mcrucifix/palinsol/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-19 10:08:00 UTC; mcrucifix</td>
</tr>
<tr>
<td>License_is_FOSS:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-21 23:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AnnualMean'>Annual Mean insolation</h2><span id='topic+AnnualMean'></span>

<h3>Description</h3>

<p>Compute annual mean insolation for a given orbit and solar constant
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AnnualMean(orbit, S0 = 1365, lats = seq(-90, 90, 1), degree = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AnnualMean_+3A_orbit">orbit</code></td>
<td>
<p>Output from a solution, such as <code>ber78</code>, <code>ber90</code> or 
<code>la04</code></p>
</td></tr>
<tr><td><code id="AnnualMean_+3A_s0">S0</code></td>
<td>
<p>Total solar irradiance</p>
</td></tr>
<tr><td><code id="AnnualMean_+3A_lats">lats</code></td>
<td>
<p>list of latitudes at which annual mean is computed</p>
</td></tr>
<tr><td><code id="AnnualMean_+3A_degree">degree</code></td>
<td>
<p>true if latitudes are provided in degrees</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class &quot;AnnualMean&quot; with annual mean insolations
</p>

<hr>
<h2 id='astro'>Compute astronomical parameters in the past or in the future</h2><span id='topic+astro'></span><span id='topic+ber78'></span><span id='topic+ber90'></span><span id='topic+la04'></span><span id='topic+precession'></span><span id='topic+coprecession'></span><span id='topic+obliquity'></span>

<h3>Description</h3>

<p>&ndash;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>astro(t, solution = ber78, degree = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="astro_+3A_t">t</code></td>
<td>
<p>Time, years after 1950</p>
</td></tr>
<tr><td><code id="astro_+3A_solution">solution</code></td>
<td>
<p>solution used. One of <code>ber78</code>, <code>ber90</code> or
<code>la04</code></p>
</td></tr>
<tr><td><code id="astro_+3A_degree">degree</code></td>
<td>
<p>returns angles in degrees if <code>TRUE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both <code>ber78</code> and <code>ber90</code> compute astronomical elements based on a
spectral decomposition (sum of sines and cosines) of obliquity and planetary
precession parameters.  <code>ber78</code> uses the Berger (1978) algorithm and is
accurate for +/- 1e6 years about the present. <code>ber90</code> uses the Berger
and Loutre (1991) algorithm and is accurate for +/- 3e6 years about the
present (but with a tiny accuracy over the last 50 kyr, usually negligible
for any palaeo application, see example below).
</p>
<p><code>la04</code> interpolates tables provided by Laskar (2004), obtained by a
simplectic numerical integration of the planetary system, in which the Moon
is considered as a planet.  This solution is valid for about 50 Myr around
the present.
</p>
<p><code>precession</code>, <code>coprecession</code> and <code>obliquity</code> do as
<code>astro</code>, but only return precession (e sin varpi), coprecession (e cos
varpi) and obliquity, respectively.
</p>


<h3>Value</h3>

<p>A vector of 3 (la04) or 4 (<code>ber78</code> and <code>ber90</code>)
astronomical elements </p>

<table>
<tr>
 <td style="text-align: left;"> <code>eps</code> </td><td style="text-align: left;"> obliquity, </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>ecc</code></td><td style="text-align: left;"> eccentricity and </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>varpi</code> true solar longitude of the
perihelion. </td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>
 <p><code>ber78</code> and <code>ber90</code> also return <code>epsp</code>, the
Hilbert transform of obliquity (sines changed in cosines in the spectral
decomposition).
</p>
<p>Angles are returned in radians unless <code>degree=TRUE</code>
</p>


<h3>Author(s)</h3>

<p>Michel Crucifix, U. catholique de Louvain, Belgium.
</p>


<h3>References</h3>

<p>Berger, A. L. (1978).  Long-term variations of daily insolation
and Quaternary climatic changes, J. Atmos. Sci., 35, 2362-2367,
doi:10.1175/1520-0469(1978)035&lt;2362:LTVODI&gt;2.0.CO;2
</p>
<p>Berger and M.F. Loutre (1991), Insolation values for the climate of the last
10 million years, Quaternary Science Reviews, 10, 297 - 317,
doi:10.1016/0277-3791(91)90033-Q
</p>
<p>J. Laskar et al. (2004), A long-term numerical solution for the insolation
quantities of the Earth, Astron. Astroph., 428, 261-285,
doi:10.1051/0004-6361:20041335
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## compare the obliquity over the last 2 Myr with the
## three solutions

times &lt;- seq(-2e6,0,1e3)
Obl &lt;- function(t) {c(time=t,ber78=ber78(t)['eps'],
       ber90=ber90(t)['eps'], la04=la04(t)['eps'])}

Obls &lt;- data.frame(t(sapply(times,Obl)))
## may take about 10 seconds to run
with(Obls, {
  plot(times/1e3, ber78.eps, type='l', xlab='time (kyr)',
                                       ylab='Obliquity (radians)')
  lines(times/1e3, ber90.eps, type='l', col='red')
  lines(times/1e3, la04.eps, type='l', col='green')
  })

legend('topright', c('ber78','ber90','la04'), col=c('black','red','green'),
       lty=1)

## same but with a zoom over the last 300 000 years:

T &lt;- which (times &gt; -3e5)
with(Obls, {
  plot(times[T]/1e3, ber78.eps[T], type='l', xlab='time (kyr)',
                                       ylab='Obliquity (radians)')
  lines(times[T]/1e3, ber90.eps[T], type='l', col='red')
  lines(times[T]/1e3, la04.eps[T], type='l', col='green')
  })

legend('topright', c('ber78','ber90','la04'), col=c('black','red','green'), 
       lty=1)

</code></pre>

<hr>
<h2 id='BER78'>Tables supplied by BER78 and BER90</h2><span id='topic+BER78'></span><span id='topic+BER90'></span>

<h3>Description</h3>

<p>Tables necessary for computation of astronomical solutions by
Berger (1978)  or Berger and Loutre (1990). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'> data(BER78) 
 data(BER90) 
 </code></pre>


<h3>Format</h3>

<p>text files reproducing the published tables with original units.</p>


<h3>Note</h3>

<p>Table 2 is reconstructed based on the electronic files supplied 
by the authors, based on the method  provided by Berger and Loutre (1990)
below. </p>


<h3>Author(s)</h3>

<p>Michel Crucifix, UCLouvain, Belgium.</p>


<h3>Source</h3>

<p>dx.doi.org/10.5281/zenodo.7198111 and 10.5281/zenodo.7198109</p>


<h3>References</h3>

<p>Berger, A. L. (1978).  Long-term variations of daily
insolation and Quaternary climatic changes, J. Atmos. Sci., 35,
2362-2367, doi:10.1175/1520-0469(1978)035&lt;2362:LTVODI&gt;2.0.CO;2
</p>
<p>A. Berger and M. F. Loutre (1990), Origine des fr\'equences des \'el\'ements astronomiques intervenant dans l'insolation,  Bull. Classe des Sciences, 1-3, 45-106 
</p>
<p>Berger and M.F. Loutre (1991), Insolation values for the climate of the last 10 million years,  Quaternary Science Reviews, 10, 297 - 317, doi:10.1016/0277-3791(91)90033-Q
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
data(BER78)
data(BER90)
</code></pre>

<hr>
<h2 id='calins'>Caloric insolation</h2><span id='topic+calins'></span>

<h3>Description</h3>

<p>Computes caloric summer insolation for a given astronomical configuration
and latitude.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calins(orbit, lat = 65 * pi/180, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calins_+3A_orbit">orbit</code></td>
<td>
<p>Output from a solution, such as <code>ber78</code>, <code>ber90</code> or
<code>la04</code></p>
</td></tr>
<tr><td><code id="calins_+3A_lat">lat</code></td>
<td>
<p>latitude</p>
</td></tr>
<tr><td><code id="calins_+3A_...">...</code></td>
<td>
<p>Other arguments passed to Insol</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The caloric summer is a notion introduced by M. Milankovitch. It is defined
as the halve of the tropical year during for which daily mean insolation are
greater than all days of the other halves. The algorithm is an original
algorithm by M. Crucifix, but consistent with earlier definitions and
algorithms by A. Berger (see examples). Do not confuse this Berger (1978)
reference with the Berger (1978), J. Atm. Sci. of the astronomical solution.
</p>


<h3>Value</h3>

<p>Time-integrated insolation in kJ/m2 during the caloric summer.
</p>


<h3>Author(s)</h3>

<p>Michel Crucifix, U. catholique de Louvain, Belgium.
</p>


<h3>References</h3>

<p>Berger (1978) Long-term variations of caloric insolation
resulting from the earth's orbital elements, Quaternary Research, 9, 139 -
167.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## reproduces Table 2 of Berger 1978
lat &lt;- seq(90, 0, -10) * pi/180. ## angles in radians. 
orbit_1 = ber78(0)
orbit_2 = orbit_1
orbit_2 ['eps'] = orbit_2['eps'] + 1*pi/180.

T &lt;-  sapply(lat, function(x) c(lat = x * 180/pi, 
                          calins(orbit_2, lat=x, S0=1365) / (4.18 * 1e1)
                        - calins(orbit_1, lat=x, S0=1365) / (4.18 * 1e1) ) )
data.frame(t(T))
# there are still some differences, of the order of 0.3 %, that are probably related to
# the slightly different methods. 
# 41.8 is the factor from cal/cm2 to  kJ/m2

</code></pre>

<hr>
<h2 id='day2l'>Converts calendar day into true solar longitude and vice-versa</h2><span id='topic+day2l'></span><span id='topic+l2day'></span><span id='topic+date_of_perihelion'></span>

<h3>Description</h3>

<p>Converts calendar day into true solar longitude for a given astronomical
configuration and vice-versa
</p>


<h3>Usage</h3>

<pre><code class='language-R'>day2l(orbit, day)

l2day(orbit, l)

date_of_perihelion(orbit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="day2l_+3A_orbit">orbit</code></td>
<td>
<p>Output from a solution, such as <code>ber78</code>, <code>ber90</code> or
<code>la04</code></p>
</td></tr>
<tr><td><code id="day2l_+3A_day">day</code></td>
<td>
<p>calendar day, in a 360-d year</p>
</td></tr>
<tr><td><code id="day2l_+3A_l">l</code></td>
<td>
<p>true solar longitude, in radians</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 360-d calendar is a conventional calendar, for which day 80 is the day
of NH spring equinoxe. The tropic year, which in reality is 365.24219876 *
86400 seconds was the practical reference to define the Gregorian Calendar
since this is the time needed to go through all the seasons. More discussion
of calendars and conversions in Berger et al. (2010) appendix D.
</p>
<p>The <code>day2l</code> and <code>l2day</code> is based on algoritms given in Berger
(1978), but which can be traced back to expansions of the mean and true
anomaly by Brouwer and Clemente (1961), pp. 65 and 77 (see code for further
details).
</p>


<h3>Value</h3>

<p>day of year (360-d cal.) or true solar longitude (in radians).
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>l2day()</code>: Converts true solar longitude into calendar day
</p>
</li>
<li> <p><code>date_of_perihelion()</code>: Returns date of perihelion
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Michel Crucifix, U. catholique de Louvain, Belgium.
</p>


<h3>References</h3>

<p>Brouwer D. and G. M. Clemence, (1961), Methods of celestial
mechanics, Academic Press, New York.
</p>
<p>Berger, (1978) Long-term variations of daily insolation and Quaternary
climatic changes, J. Atmos. Sci., 35, 2362-2367 1978,
doi:10.1175/1520-0469(1978)035&lt;2362:LTVODI&gt;2.0.CO;2
</p>
<p>Berger, A. Loutre, M.F. and Yin Q. (2010), Total irradiation during any time
interval of the year using elliptic integrals, Quaternary Science Reviews,
29, 1968 - 1982, doi:10.1016/j.quascirev.2010.05.007
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## date of perihelion throughout today
orbit=c(eps=0.409214, ecc=0.01672393, varpi=4.92251)
date_of_perihelion(orbit)
## date of winter solstice)
l2day(orbit, 270*pi/180.)

</code></pre>

<hr>
<h2 id='Insol'>Computes incoming solar radiation (insolation)</h2><span id='topic+Insol'></span>

<h3>Description</h3>

<p>Computes incoming solar radiation (insolation) for a given astronomical
configuration, true solar longitude and latitude
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Insol(orbit, long = pi/2, lat = 65 * pi/180, S0 = 1365, H = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Insol_+3A_orbit">orbit</code></td>
<td>
<p>Output from a solution, such as <code>ber78</code>, <code>ber90</code> or
<code>la04</code></p>
</td></tr>
<tr><td><code id="Insol_+3A_long">long</code></td>
<td>
<p>true solar longitude</p>
</td></tr>
<tr><td><code id="Insol_+3A_lat">lat</code></td>
<td>
<p>latitude</p>
</td></tr>
<tr><td><code id="Insol_+3A_s0">S0</code></td>
<td>
<p>Total solar irradiance</p>
</td></tr>
<tr><td><code id="Insol_+3A_h">H</code></td>
<td>
<p>Sun hour angle, in radians</p>
</td></tr>
</table>


<h3>Details</h3>

<p>True solar longitude is measured in radians: </p>

<table>
<tr>
 <td style="text-align: left;"> pi/2 </td><td style="text-align: left;"> for
June solstice</td>
</tr>
<tr>
 <td style="text-align: left;"> pi </td><td style="text-align: left;"> for September equinox</td>
</tr>
<tr>
 <td style="text-align: left;"> 3 * pi/2 </td><td style="text-align: left;"> for December
solstice</td>
</tr>
<tr>
 <td style="text-align: left;"> 0 </td><td style="text-align: left;"> for Spring equinox</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>
<p> It may be obtained for a given
day in the year using the function <code>day2l</code>.
</p>


<h3>Value</h3>

<p>Daily-mean insolation (assuming fixed astronomical parameters during
a true solar day) if 'H' is null.  Otherwise, insolation at specified hour
angle (H = 0 at noon, H = pi at midnight).
</p>


<h3>Author(s)</h3>

<p>Michel Crucifix, U. catholique de Louvain, Belgium.
</p>


<h3>References</h3>

<p>Berger, A. L. (1978).  Long-term variations of daily insolation
and Quaternary climatic changes, J. Atmos. Sci., 35, 2362-2367.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## make a little wrapper, with all default values

insolation &lt;- function(times, astrosol=ber78,...)
  sapply(times, function(tt) Insol(orbit=astrosol(tt)))

tts &lt;- seq(from = -400e3, to = 0, by = 1e3)
isl &lt;- insolation(tts, ber78)
plot(tts, isl, typ='l')


</code></pre>

<hr>
<h2 id='Insol_l1l2'>Time-integrated insolation</h2><span id='topic+Insol_l1l2'></span><span id='topic+Insol_d1d2'></span>

<h3>Description</h3>

<p>Computes time-integrated incoming solar radiation (Insol) either between
given true solar longitudes (<code>Insol_l1l2</code>) or days of year
(<code>Insol_d1d2</code>) for a given orbit and latitude
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Insol_l1l2(
  orbit,
  l1 = 0,
  l2 = 2 * pi,
  lat = 65 * pi/180,
  avg = FALSE,
  ell = TRUE,
  ...
)

Insol_d1d2(orbit, d1, d2, lat = 65 * pi/180, avg = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Insol_l1l2_+3A_orbit">orbit</code></td>
<td>
<p>Output from a solution, such as <code>ber78</code>, <code>ber90</code> or
<code>la04</code></p>
</td></tr>
<tr><td><code id="Insol_l1l2_+3A_l1">l1</code></td>
<td>
<p>lower true solar longitude bound of the time-integral</p>
</td></tr>
<tr><td><code id="Insol_l1l2_+3A_l2">l2</code></td>
<td>
<p>upper true solar longitude bound of the time-integral</p>
</td></tr>
<tr><td><code id="Insol_l1l2_+3A_lat">lat</code></td>
<td>
<p>latitude</p>
</td></tr>
<tr><td><code id="Insol_l1l2_+3A_avg">avg</code></td>
<td>
<p>performs a time-average.</p>
</td></tr>
<tr><td><code id="Insol_l1l2_+3A_ell">ell</code></td>
<td>
<p>uses elliptic integrals for the calculation (much faster)</p>
</td></tr>
<tr><td><code id="Insol_l1l2_+3A_...">...</code></td>
<td>
<p>other arguments to be passed to <code>Insol</code></p>
</td></tr>
<tr><td><code id="Insol_l1l2_+3A_d1">d1</code></td>
<td>
<p>lower calendar day (360-day year) of the time-integral</p>
</td></tr>
<tr><td><code id="Insol_l1l2_+3A_d2">d2</code></td>
<td>
<p>upper calendar day (360-day year) of the time-integral</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All angles input measured in radians.
</p>
<p>Note that in contrast to Berger (2010) we consider the tropic year as the
reference, rather than the sideral year, which partly explains some of the
small differences with the original publication
</p>


<h3>Value</h3>

<p>Time-integrated insolation in kJ/m2 if <code>avg=TRUE</code>, else
time-average in W/m2
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>Insol_d1d2()</code>: Mean and integrated insolation over an interval bounded by calendar days
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Michel Crucifix, U. catholique de Louvain, Belgium.
</p>


<h3>References</h3>

<p>Berger, A., Loutre, M.F. and Yin Q. (2010), Total irradiation
during any time interval of the year using elliptic integrals, Quaternary
Science Reviews, 29, 1968 - 1982, doi:10.1016/j.quascirev.2010.05.007
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## reproduces Table 1a of Berger et al. 2010:
lat &lt;- seq(85, -85, -10) * pi/180. ## angles in radians. 
orbit=c(eps=  23.446 * pi/180., ecc= 0.016724, varpi= (102.04 - 180)* pi/180. )
T &lt;-  sapply(lat, function(x) c(lat = x * 180/pi, 
        m1 =  Insol_l1l2(orbit, 0, 70 * pi/180, lat=x, ell= TRUE, S0=1368) / 1e3,
        m2 =  Insol_l1l2(orbit, 0, 70 * pi/180, lat=x, ell=FALSE, S0=1368) / 1e3) ) 
data.frame(t(T))
 ## reproduces Table 1b of Berger et al. 2010:
lat &lt;- c(85, 55, 0, -55, -85) * pi/180. ## angles in radians. 
T &lt;-  sapply(lat, function(x) c(lat = x * 180/pi, 
         m1 =  Insol_l1l2(orbit, 30 * pi/180. , 75 * pi/180, 
               lat=x, ell= TRUE, S0=1368) / 1e3,
         m2 =  Insol_l1l2(orbit, 30 * pi/180. , 75 * pi/180, 
               lat=x, ell=FALSE, S0=1368) / 1e3) ) 
 ## reproduces Table 2a of Berger et al. 2010:
lat &lt;- seq(85, -85, -10) * pi/180. ## angles in radians. 

## 21 march in a 360-d year. By definition : day 80 = 21 march at 12u
d1 = 79.5 
d2 = 79.5 + (10 + 30 + 30 ) * 360/365.2425 ## 30th May in a 360-d year

T &lt;-  sapply(lat, function(x) c(lat = x * 180/pi, 
        m1 =  Insol_d1d2(orbit, d1,d2, lat=x, ell= TRUE, S0=1368) / 1e3,
        m2 =  Insol_d1d2(orbit, d1,d2, lat=x, ell= FALSE, S0=1368) / 1e3))
                          
## I did not quite get the same results as on the table 
## on this one; probably a matter of calendar
## note : the authors in fact used S0=1368 (pers. comm.) 
## 1366 in the paper is a misprint

data.frame(t(T))

## annual mean insolation at 65N North, as a function of the longitude of the perihelion
## (expected to be invariant)

varpis &lt;- seq(0,360,10)*pi/180.  
sapply(varpis, function(varpi)
   {   orbit=c(eps=  23.446 * pi/180., ecc= 0.016724, varpi= varpi )
       amean &lt;- Insol_l1l2 (orbit, lat=65*pi/180., avg=TRUE)
       return(amean)
   })
</code></pre>

<hr>
<h2 id='LA04'>Astronomical elements supplied by Laskar et al. 2004</h2><span id='topic+LA04'></span>

<h3>Description</h3>

<p>Astronomical elements (longitude of perihelion, 
obliquity and eccentricity) supplied by Laskar et al. 2004
by stey of 1ka, from -51Ma to present (la04past) and from present to
+ 21Ma.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> data(LA04) </code></pre>


<h3>Format</h3>

<p>text files</p>


<h3>Author(s)</h3>

<p>Michel Crucifix, U. catholique de Louvain, Belgium.</p>


<h3>Source</h3>

<p>http://www.imcce.fr/Equipes/ASD/insola/earth/earth.html</p>


<h3>References</h3>

<p>J. Laskar et al., A long-term numerical solution for the insolation quantities of the Earth,  Astron. Astroph., 428, 261-285  200 </p>


<h3>Examples</h3>

<pre><code class='language-R'> 
data(LA04)
</code></pre>

<hr>
<h2 id='Milankovitch'>Milankovitch graph for a given astronomical configuration</h2><span id='topic+Milankovitch'></span>

<h3>Description</h3>

<p>Computes the distrubition in latitude and longitude of incoming solar
radiation, known as a Milankovitch graph, with possibility of plotting with
a dedicated plot function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Milankovitch(
  orbit,
  S0 = 1365,
  lat = seq(-pi/2, pi/2, l = 73),
  long = seq(0, 2 * pi, l = 145),
  deg = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Milankovitch_+3A_orbit">orbit</code></td>
<td>
<p>Output from a solution, such as <code>ber78</code>, <code>ber90</code> or
<code>la04</code></p>
</td></tr>
<tr><td><code id="Milankovitch_+3A_s0">S0</code></td>
<td>
<p>Total solar irradiance</p>
</td></tr>
<tr><td><code id="Milankovitch_+3A_lat">lat</code></td>
<td>
<p>latitudes, passed as an array</p>
</td></tr>
<tr><td><code id="Milankovitch_+3A_long">long</code></td>
<td>
<p>true solar longitudes, passed as an array</p>
</td></tr>
<tr><td><code id="Milankovitch_+3A_deg">deg</code></td>
<td>
<p>If true : the axes of the Milankovitch object are expressed in
degrees.  Inputs are always in radians</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A object of Milankovitch class, which may be plotted using the
regular plot function
</p>


<h3>Note</h3>

<p>The polar night option may not be bullet-proof for exotic obliquities
</p>


<h3>Author(s)</h3>

<p>Michel Crucifix, U. catholique de Louvain, Belgium.
</p>


<h3>References</h3>

<p>Berger, A. L. (1978).  Long-term variations of daily insolation
and Quaternary climatic changes, J. Atmos. Sci., 35, 2362-2367.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
orbit &lt;- c(eps=0.409214, ecc=0.01672393, varpi=4.92251)
M &lt;- Milankovitch(orbit)
plot(M, plot=contour)
plot(M, plot=contour, month=FALSE)

</code></pre>

<hr>
<h2 id='plot.Milankovitch'>plot Milankovitch graph</h2><span id='topic+plot.Milankovitch'></span>

<h3>Description</h3>

<p>plot Milankovitch object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Milankovitch'
plot(
  x,
  months = TRUE,
  polar_night = TRUE,
  plot_function = contour,
  col = "black",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.Milankovitch_+3A_x">x</code></td>
<td>
<p>Milankovitch object</p>
</td></tr>
<tr><td><code id="plot.Milankovitch_+3A_months">months</code></td>
<td>
<p>if true : x-axis of the plot indicates months conventionnally
defined with the true solar longitude; x-axis is simply the true solar
longitude otherwise</p>
</td></tr>
<tr><td><code id="plot.Milankovitch_+3A_polar_night">polar_night</code></td>
<td>
<p>if true : the polar night zone will be hashed</p>
</td></tr>
<tr><td><code id="plot.Milankovitch_+3A_plot_function">plot_function</code></td>
<td>
<p>function used to plot the matrix. Typically
<code>contour</code> or <code>image</code> but may also be <code>image.plot</code> if using
the <code>fields</code> package.</p>
</td></tr>
<tr><td><code id="plot.Milankovitch_+3A_col">col</code></td>
<td>
<p>main color for positive contours (negative contours are in red)</p>
</td></tr>
<tr><td><code id="plot.Milankovitch_+3A_...">...</code></td>
<td>
<p>Other arguments passed to plotting function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michel Crucifix, U. catholique de Louvain, Belgium.
</p>

<hr>
<h2 id='polar_night'>Begin and end of the polar night</h2><span id='topic+polar_night'></span>

<h3>Description</h3>

<p>Provides the true solar longitude (in degrees) of the beginning and end of
the polar night for a given latitude and orbit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polar_night(lat, orbit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="polar_night_+3A_lat">lat</code></td>
<td>
<p>latitude</p>
</td></tr>
<tr><td><code id="polar_night_+3A_orbit">orbit</code></td>
<td>
<p>Output from a solution, such as <code>ber78</code>, <code>ber90</code> or
<code>la04</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Either a message about the absence of polar night (for specified
reasons), or the true solar longitude, in degrees, of the beginning and end
of the polar night.
</p>


<h3>Author(s)</h3>

<p>Michel Crucifix, U. catholique de Louvain, Belgium.
</p>


<h3>References</h3>

<p>any standard text book of spherical astronomy
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

current_orbit &lt;- la04(0)

# polar night at the equator ? 
polar_night (0, current_orbit)

# polar night at 80 N ? 
polar_night (80*pi/180, current_orbit)

# polar nights expressed as day of year 
l2day(current_orbit, polar_night (80*pi/180, current_orbit))


</code></pre>

<hr>
<h2 id='thrins'>Integrated insolation for all days exceeding a threshold</h2><span id='topic+thrins'></span>

<h3>Description</h3>

<p>Integrated insolation over the part during which daily-mean insolation
exceeds a threshold, expressed in W/m2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thrins(lat = 65 * pi/180, orbit, threshold = 400, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="thrins_+3A_lat">lat</code></td>
<td>
<p>latitude</p>
</td></tr>
<tr><td><code id="thrins_+3A_orbit">orbit</code></td>
<td>
<p>Output from a solution, such as <code>ber78</code>, <code>ber90</code> or
<code>la04</code></p>
</td></tr>
<tr><td><code id="thrins_+3A_threshold">threshold</code></td>
<td>
<p>threshold insolation ,in W/m2</p>
</td></tr>
<tr><td><code id="thrins_+3A_...">...</code></td>
<td>
<p>other arguments to be passed to Insol</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Algorithm is by M. Crucifix, but the idea of thresholded insolation is due
to Huybers and Tziperman (2008), reference below.
</p>


<h3>Value</h3>

<p>Time-integrated insolation in kJ/m2 . The quantity is calculated by
brute-force integration with a 1-degree time-step in true solar longitude
and this can be quite slow if long series are to be calculated.
</p>


<h3>Author(s)</h3>

<p>Michel Crucifix, U. catholique de Louvain, Belgium.
</p>


<h3>References</h3>

<p>P. Huybers and E. Tziperman (2008), Integrated summer insolation
forcing and 40,000-year glacial cycles: The perspective from an
ice-sheet/energy-balance model, Paleoceanography, 23.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
