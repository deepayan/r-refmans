<!DOCTYPE html><html lang="en-GB"><head><title>Help for package coffee</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {coffee}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coffee'><p>coffee</p></a></li>
<li><a href='#ages.undated'><p>Model ages between two dated levels</p></a></li>
<li><a href='#draw.MCMCrings'><p>plot the dates and model of a MCMC wiggle-match dated tree</p></a></li>
<li><a href='#draw.rings'><p>plot the dates and model of a wiggle-match dated tree</p></a></li>
<li><a href='#draw.strat'><p>plot the dates and model of chronologically ordered dated depths</p></a></li>
<li><a href='#IAT'><p>calculate the Integrated Autocorrelation Time</p></a></li>
<li><a href='#MCMCrings'><p>MCMC wiggle-match C-14 dating of a tree</p></a></li>
<li><a href='#rings'><p>wiggle-match C-14 dating of a tree</p></a></li>
<li><a href='#scissors'><p>Remove the first n iterations.</p></a></li>
<li><a href='#sim.rings'><p>Simulate the radiocarbon dating of tree-rings</p></a></li>
<li><a href='#sim.strat'><p>Simulate the radiocarbon dating of random depths of a sediment which has accumulated over time.</p></a></li>
<li><a href='#strat'><p>Model chronologically ordered dates</p></a></li>
<li><a href='#strat.cleanup'><p>Remove .out files from a run</p></a></li>
<li><a href='#thinner'><p>Thin iterations.</p></a></li>
<li><a href='#withinhpd'><p>Calculate the fit of a modelled age with the corresponding date</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Chronological Ordering for Fossils and Environmental Events</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.3</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maarten Blaauw &lt;maarten.blaauw@qub.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>While individual calibrated radiocarbon dates can span several centuries, combining multiple dates together with any chronological constraints can make a chronology much more robust and precise. This package uses Bayesian methods to enforce the chronological ordering of radiocarbon and other dates, for example for trees with multiple radiocarbon dates spaced at exactly known intervals (e.g., 10 annual rings). For methods see Christen 2003 &lt;<a href="https://doi.org/10.11141%2Fia.13.2">doi:10.11141/ia.13.2</a>&gt;. Another example is sites where the relative chronological position of the dates is taken into account - the ages of dates further down a site must be older than those of dates further up (Buck, Kenworthy, Litton and Smith 1991 &lt;<a href="https://doi.org/10.1017%2FS0003598X00080534">doi:10.1017/S0003598X00080534</a>&gt;; Nicholls and Jones 2001 &lt;<a href="https://doi.org/10.1111%2F1467-9876.00250">doi:10.1111/1467-9876.00250</a>&gt;). The paper accompanying this R package is Blaauw et al. 2024 &lt;<a href="https://doi.org/10.1017%2FRDC.2024.56">doi:10.1017/RDC.2024.56</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Maarten14C/coffee">https://github.com/Maarten14C/coffee</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, utf8</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table, rintcal (&ge; 1.1.0), rice (&ge; 0.4.0)</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-06 14:19:12 UTC; maarten</td>
</tr>
<tr>
<td>Author:</td>
<td>Maarten Blaauw <a href="https://orcid.org/0000-0002-5680-1515"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Marco A. Aquino Lopez
    <a href="https://orcid.org/0000-0002-5076-7205"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, ctb],
  J. Andres Christen
    <a href="https://orcid.org/0000-0002-5795-4345"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, ctb,
    cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-06 15:10:19 UTC</td>
</tr>
</table>
<hr>
<h2 id='coffee'>coffee</h2><span id='topic+coffee-package'></span><span id='topic+coffee'></span>

<h3>Description</h3>

<p>While individual calibrated radiocarbon dates can span several centuries, combining multiple dates together with any chronological constraints can make a chronology much more robust and precise. This package, an acronym of Chronological Ordering For Fossils and Environmental Events, uses Bayesian methods to enforce the chronological ordering of radiocarbon and other dates, for example for trees with multiple radiocarbon dates spaced at exactly known intervals (e.g., every 10 annual rings; Christen 2003). Another example is sites where the relative chronological position of the dates is taken into account - the ages of dates further down a site must be older than those of dates further up (e.g., Buck et al. 1991). MCMC runs are done using the t-walk (Christen and Fox 2010).
</p>
<p>Note that several R packages exist to run and/or extract results from OxCal (see OxcAAR and https://github.com/gavinsimpson/roxcal).
However, coffee is meant as a stand-alone package that doesn't rely on having OxCal installed. Additionally, the data files of coffee are meant to be more easily readable and writeable by humans.
</p>
<p>References
</p>
<p>Buck CE, Kenworthy JB, Litton CD, Smith AFM, 1991. Combining archaeological and radiocarbon information: a Bayesian approach to calibration. Antiquity 65, 808-821.
</p>
<p>Christen JA, 2003. Bwigg: An Internet facility for Bayesian radiocarbon wiggle-matching. Internet Archaeology 13. <a href="https://doi.org/10.11141/ia.13.2">doi:10.11141/ia.13.2</a>
</p>
<p>Christen JA, Fox C 2010. A General Purpose Sampling Algorithm for Continuous Distributions (the t-walk). Bayesian Analysis 5, 263-282
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw &lt;maarten.blaauw@qub.ac.uk&gt; J. Andres Christen &lt;jac@cimat.mx&gt;
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/Maarten14C/coffee">https://github.com/Maarten14C/coffee</a>
</p>
</li></ul>


<hr>
<h2 id='ages.undated'>Model ages between two dated levels</h2><span id='topic+ages.undated'></span>

<h3>Description</h3>

<p>Model ages of undated levels, by for each MCMC iteration finding the age of the layer above and of the layer below, and sampling a random age from a uniform distribution between the age estimates of the two ages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ages.undated(position, set = get("info"), draw = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ages.undated_+3A_position">position</code></td>
<td>
<p>Position of the to-be-estimated undated layer. Should be larger than the layer above but smaller than the layer below it.</p>
</td></tr>
<tr><td><code id="ages.undated_+3A_set">set</code></td>
<td>
<p>This option reads the 'info' variable, which contains the data and the model output.</p>
</td></tr>
<tr><td><code id="ages.undated_+3A_draw">draw</code></td>
<td>
<p>Whether or not to draw the age distribution.</p>
</td></tr>
</table>

<hr>
<h2 id='draw.MCMCrings'>plot the dates and model of a MCMC wiggle-match dated tree</h2><span id='topic+draw.MCMCrings'></span>

<h3>Description</h3>

<p>A plot with three panels. The top panels show the MCMC run (left) and the prior (gren) and posterior (grey) distributions for deltaR, the age offset (assumed to be constant among all C14 ages). The main panel shows the age distribution of the inner ring, and also the placements of the radiocarbon dates on the calibration curve taking the best (mode) calendar age. Grey dots show the placements of the dates with the modelled age offset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.MCMCrings(
  yrs,
  dR,
  dat,
  cc,
  Us,
  delta.R,
  delta.STD,
  BCAD,
  cal.lim = c(),
  cal.lab = c(),
  C14.lim = c(),
  C14.lab = c(),
  mar = c(3, 3, 1, 1),
  mgp = c(1.7, 0.7, 0),
  main.height = 0.55,
  dist.height = 0.5,
  name = c(),
  name.loc = "topleft",
  MCMC.col = grey(0.3),
  prior.col = "green",
  prior.lab = "delta.R",
  text.col = "red",
  post.col = rgb(0, 0, 0, 0.3),
  cc.col = rgb(0, 0, 1, 0.5),
  dets.col = "black",
  adj.col = grey(0.5)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.MCMCrings_+3A_yrs">yrs</code></td>
<td>
<p>The modelled years.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_dr">dR</code></td>
<td>
<p>The modelled delta.R values.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_dat">dat</code></td>
<td>
<p>The data, extracted from the .csv file.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_cc">cc</code></td>
<td>
<p>Calibration curve to be used. Could be 1 (IntCal20; default), 2 (Marine20), 3 (SHCal20) or 4 (custom curve).</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_us">Us</code></td>
<td>
<p>Energy of the MCMC run (for the topleft graph).</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_delta.r">delta.R</code></td>
<td>
<p>Prior for the mean delta.R.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_delta.std">delta.STD</code></td>
<td>
<p>Prior for the standard deviation of delta.R.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_cal.lim">cal.lim</code></td>
<td>
<p>The limits for the bottom calendar axis. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_cal.lab">cal.lab</code></td>
<td>
<p>The labels for the bottom calendar axis (default <code>age.lab="cal BP"</code> or <code>"BC/AD"</code>.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_c14.lim">C14.lim</code></td>
<td>
<p>The limits for the bottom C14 axis. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_c14.lab">C14.lab</code></td>
<td>
<p>The labels for the bottom y-axis. Defaults to 14C BP with superscript 14, so <code>expression(""^14*C~BP)</code>.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_mar">mar</code></td>
<td>
<p>Axis margins. Defaults to <code>mar=c(3, 3, 1, 1)</code>.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_mgp">mgp</code></td>
<td>
<p>Axis text margins (where should titles, labels and tick marks be plotted). Defaults to <code>mgp=c(1.7, .7, .0)</code>.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_main.height">main.height</code></td>
<td>
<p>Height of the main panel, relative to the top panels. Defaults to 0.55.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_dist.height">dist.height</code></td>
<td>
<p>Height of the age distribution, relative to the vertical axis extent. Defaults to 0.5.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_name">name</code></td>
<td>
<p>Name to plot in the main panel.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_name.loc">name.loc</code></td>
<td>
<p>Location of the name, defaults to <code>name.loc="topleft"</code>.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_mcmc.col">MCMC.col</code></td>
<td>
<p>Colour of the MCMC run. Defaults to dark grey, <code>MCMC.col=grey(0.3)</code>.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_prior.col">prior.col</code></td>
<td>
<p>Colour of the prior for the delta.R distribution, default green.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_prior.lab">prior.lab</code></td>
<td>
<p>Label of the prior. Defaults to &quot;delta.R&quot;.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_text.col">text.col</code></td>
<td>
<p>Colour of the text describing the delta.R prior. Defaults to red.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_post.col">post.col</code></td>
<td>
<p>Colour of the posterior distributions. Defaults to semi-transparent dark grey.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_cc.col">cc.col</code></td>
<td>
<p>Colour of the calibration curve. Defaults to semi-transparent blue, <code>dist.col=rgb(0,0,1,0.5)</code>.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_dets.col">dets.col</code></td>
<td>
<p>Colour of the radiocarbon determinations ranges. Defaults to <code>"black"</code> but could also give colours for each individual, date, e.g., <code>dets.col=1:10</code>.</p>
</td></tr>
<tr><td><code id="draw.MCMCrings_+3A_adj.col">adj.col</code></td>
<td>
<p>Colour of the adjusted C14 dates. Defaults to grey.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot with the MCMC run, the prior and posterior for deltaR, and the posterior age estimate together with the placements of the radiocarbon dates.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, Marco Aquino Lopez
</p>

<hr>
<h2 id='draw.rings'>plot the dates and model of a wiggle-match dated tree</h2><span id='topic+draw.rings'></span>

<h3>Description</h3>

<p>A plot with two panels. The top panel shows the calibrated distributions (in blue) and the wiggle-match age-modelled age estimates for each dated ring (grey). The bottom panel shows the fit of the uncalibrated radiocarbon dates (steelblue dots and lab error bars) to the calibration curve (green), as well as the age estimate of the oldest/starting ring (grey) and its hpd range (black).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.rings(
  name = "mytree",
  tree.dir = "trees",
  sep = ",",
  normal = TRUE,
  dat = c(),
  out = c(),
  cc = 1,
  postbomb = FALSE,
  BCAD = FALSE,
  t.a = 3,
  t.b = 4,
  x.lim = c(),
  x1.axis = TRUE,
  x1.labels = FALSE,
  x1.lab = c(),
  rev.x = FALSE,
  y1.lab = c(),
  y1.lim = c(),
  y2.lim = c(),
  x2.lab = c(),
  y2.lab = c(),
  ex = 0.05,
  plot.cc = TRUE,
  plot.dists = TRUE,
  mar.1 = c(1, 3, 1, 1),
  mar.2 = c(3, 3, 0, 1),
  mgp = c(1.7, 0.7, 0),
  dist.res = 500,
  date.col = "steelblue",
  cc.col = rgb(0, 0.5, 0, 0.5),
  dist.col = rgb(0, 0, 0, 0.5),
  calib.col = rgb(0, 0, 1, 0.25),
  range.col = "black",
  set.layout = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.rings_+3A_name">name</code></td>
<td>
<p>The name of the tree. The .csv file should be saved under a folder named exactly the same as <code>name</code>, and the folder should live under the <code>tree.dir</code> folder. Default names include Ulandryk4 and mytree.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_tree.dir">tree.dir</code></td>
<td>
<p>The directory where the folders of the individual trees live. Defaults to <code>treedir="trees"</code>.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_sep">sep</code></td>
<td>
<p>Separator for the fields in the .csv file. Defaults to a comma.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_normal">normal</code></td>
<td>
<p>Calculations can be done assuming that the measurements are normally distributed. By default this is set to FALSE and a student-t distribution is used (Christen and Perez 2009).</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_dat">dat</code></td>
<td>
<p>If <code>plot.rings</code> is called from within <code>rings()</code>, both dat and out are provided. If an existing run has to be plotted again, dat and out are read from the files in the folder named <code>name</code>.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_out">out</code></td>
<td>
<p>If <code>plot.rings</code> is called from within <code>rings()</code>, both dat and out are provided. If an existing run has to be plotted again, dat and out are read from the files in the folder named <code>name</code>.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_cc">cc</code></td>
<td>
<p>Calibration curve to be used. Could be 1 (IntCal20; default), 2 (Marine20), 3 (SHCal20) or 4 (custom curve).</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_postbomb">postbomb</code></td>
<td>
<p>Negative C-14 ages should be calibrated using a postbomb curve. This could be 1 (northern-hemisphere region 1), 2 (NH region 2), 3 (NH region 3), 4 (southern hemisphere regions 1-2), or 5 (SH region 3).</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_t.a">t.a</code></td>
<td>
<p>First parameter for the student-t distribution (defaults to 3; higher numbers make the distribution approximate the normal distribution more).</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_t.b">t.b</code></td>
<td>
<p>Second parameter for the student-t distribution (defaults to 4; higher numbers make the distribution approximate the normal distribution more).</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_x.lim">x.lim</code></td>
<td>
<p>Limits of the x-axes. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_x1.axis">x1.axis</code></td>
<td>
<p>Whether or not to plot the upper x-axis (slightly redundant since the bottom axis shows the values already). Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_x1.labels">x1.labels</code></td>
<td>
<p>Whether or not to plot the labels of the upper x-axis. (slightly redundant since the bottom axis shows the values already). Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_x1.lab">x1.lab</code></td>
<td>
<p>The labels for the calendar axis of the upper panel. Defaults to empty.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_rev.x">rev.x</code></td>
<td>
<p>Whether or not to reverse the x-axis. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_y1.lab">y1.lab</code></td>
<td>
<p>The labels for the y-axis. Defaults to <code>"rings"</code>.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_y1.lim">y1.lim</code></td>
<td>
<p>Limits of the top y-axis. Calculated automatically if left empty.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_y2.lim">y2.lim</code></td>
<td>
<p>Limits of the bottom y-axis. Calculated automatically if left empty.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_x2.lab">x2.lab</code></td>
<td>
<p>The labels for the bottom calendar axis (default <code>age.lab="cal BP"</code> or <code>"BC/AD"</code> if <code>BCAD=TRUE</code>).</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_y2.lab">y2.lab</code></td>
<td>
<p>The labels for the bottom y-axis. Defaults to 14C BP with superscript 14, so <code>expression(""^14*C~BP)</code>.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_ex">ex</code></td>
<td>
<p>Exaggeration of the heights of the calibrated distributions. Defaults to 0.05 so there is plenty space to plot many distributions.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_plot.cc">plot.cc</code></td>
<td>
<p>Whether or not to plot a panel with the calibration curve.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_plot.dists">plot.dists</code></td>
<td>
<p>Whether or not to plot a panel with the distributions.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_mar.1">mar.1</code></td>
<td>
<p>Margins around the first/top plot.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_mar.2">mar.2</code></td>
<td>
<p>Margins around the first/bottom plot.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_mgp">mgp</code></td>
<td>
<p>Axis text margins (where should titles, labels and tick marks be plotted). Defaults to <code>mgp=c(1.7, .7, .0)</code>.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_dist.res">dist.res</code></td>
<td>
<p>Resolution of the plot of the distribution. The default is <code>500</code>, which results in smooth plots.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_date.col">date.col</code></td>
<td>
<p>Colour of the uncalibrated dates when plotted on top of the calibration curve. Defaults to <code>"steelblue"</code>.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_cc.col">cc.col</code></td>
<td>
<p>Colour of the calibration curve. Defaults to semi-transparent darkgreen, <code>cc.col=rgb(0 0.5, 0, 0.5)</code>.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_dist.col">dist.col</code></td>
<td>
<p>Colour of the age-modelled distribution. Defaults to semi-transparent grey, <code>dist.col=rgb(0,0,0,0.5)</code>.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_calib.col">calib.col</code></td>
<td>
<p>Colour of the calibrated distributions. Defaults to semi-transparent blue, <code>dist.col=rgb(0,0,1,0.5)</code>.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_range.col">range.col</code></td>
<td>
<p>Colour of the hpd ranges. Defaults to <code>"black"</code>.</p>
</td></tr>
<tr><td><code id="draw.rings_+3A_set.layout">set.layout</code></td>
<td>
<p>By default, the layout of the two plots is set automatically (2 plots in one column).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot with the calibrated distributions of the individual dates and the wiggle-match distributions (top), and the dates on the calibration curve together with the age distribution for the earliest ring, 0.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  treedir &lt;- tempdir()
  rings("Ulandryk", tree.dir=treedir, draw=FALSE)
  draw.rings("Ulandryk", tree.dir=treedir)
</code></pre>

<hr>
<h2 id='draw.strat'>plot the dates and model of chronologically ordered dated depths</h2><span id='topic+draw.strat'></span>

<h3>Description</h3>

<p>A plot with two panels. The top panel shows the MCMC output. The bottom panel shows the individually calibrated dates (in downward light gray) as well as the modelled ages constrained by chronological ordering (upward dark-grey) and lines with the hpd ranges (black). Any similarity with swimming elephants or island chains is coincidental.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.strat(
  name = "mystrat",
  set = get("info"),
  structure = set$struc,
  y.scale = "positions",
  strat.dir = "strats",
  cc.dir = c(),
  sep = ",",
  postbomb = 1,
  prob = 0.95,
  roundby = 1,
  calibrated.ex = 0.5,
  calibrated.mirror = FALSE,
  calibrated.up = TRUE,
  modelled.ex = 0.9,
  modelled.mirror = FALSE,
  modelled.up = FALSE,
  BCAD = FALSE,
  threshold = 0.001,
  xtop.lab = c(),
  ytop.lab = c(),
  xbottom.lab = c(),
  ybottom.lab = "position",
  calibrated.col = rgb(0, 0, 0, 0.2),
  calibrated.border = NA,
  calBP.col = rgb(0, 0, 0, 0.2),
  calBP.border = NA,
  modelled.col = rgb(0, 0, 0, 0.5),
  modelled.border = rgb(0, 0, 0, 0.5),
  range.col = "black",
  block.col = rgb(0, 0, 1, 0.05),
  gap.col = "blue",
  gap.pos = 1,
  simulation = FALSE,
  simulation.col = grey(0.5),
  pos.lim = c(),
  age.lim = c(),
  mgp = c(2, 0.7, 0),
  mar.top = c(3, 3, 1, 1),
  mar.bottom = c(3, 3, 0.5, 1),
  heights = c(0.3, 0.7),
  iterations.warning = TRUE,
  min.its = 1000,
  warning.loc = "bottomleft",
  warning.col = "red",
  labels = FALSE,
  label.loc = c(),
  label.size = 0.5,
  label.col = "black"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.strat_+3A_name">name</code></td>
<td>
<p>Name of the stratigraphy dataset. Defaults to <code>"mystrat"</code>.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_set">set</code></td>
<td>
<p>This option reads the 'info' variable, which contains the data and the model output.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_structure">structure</code></td>
<td>
<p>Information about the structure (e.g., blocks, gaps, dates, undated levels) of the dataset. Filled automatically.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_y.scale">y.scale</code></td>
<td>
<p>The scale of the vertical axis of the main plot. This can be the positions of the dated levels ('positions') or their position order ('dates').</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_strat.dir">strat.dir</code></td>
<td>
<p>The directory where the folders of the individual stratigraphies live. Defaults to <code>start.dir="strats"</code>.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of calibration curve. Keep empty for the default value.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_sep">sep</code></td>
<td>
<p>Separator for the fields in the .csv file. Defaults to a comma.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_postbomb">postbomb</code></td>
<td>
<p>Negative C-14 ages should be calibrated using a postbomb curve. This could be 1 (northern-hemisphere region 1), 2 (NH region 2), 3 (NH region 3), 4 (southern hemisphere regions 1-2), or 5 (SH region 3).</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_prob">prob</code></td>
<td>
<p>Probability Probability ranges for the age estimates (and any gap length estimates) which will be saved in files in the site's folder. Defaults to 95% (<code>prob=0.95</code>).</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_roundby">roundby</code></td>
<td>
<p>Rounding in numbers of decimals for reported age estimates (which will be saved in files in the site's folder). Defaults to <code>roundby=1</code>.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_calibrated.ex">calibrated.ex</code></td>
<td>
<p>Exaggeration of the heights of the calibrated distributions. Set at <code>calibrated.ex=0.5</code> by default, designed to approach but not overlap with neighbouring dates. Note that more precise dates peak higher than dates with lower precision.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_calibrated.mirror">calibrated.mirror</code></td>
<td>
<p>Whether or not the individually calibrated (but not the modelled) distributions should be drawn both up and down, quite a bit like fish or swans. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_calibrated.up">calibrated.up</code></td>
<td>
<p>Whether the calibrated distributions should be drawn upward or downward (the default, resembling the reflections of islands in the sea, or swimming animals if you wish)</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_modelled.ex">modelled.ex</code></td>
<td>
<p>Exaggeration of the heights of the age-modelled distributions. Set at <code>modelled.ex=0.9</code> by default, designed to approach but not overlap with neighbouring dates. Note that more precise ages peak higher than ages with lower precision.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_modelled.mirror">modelled.mirror</code></td>
<td>
<p>Whether or not the age-modelled distributions should be drawn both up and down, quite a bit like fish or swans. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_modelled.up">modelled.up</code></td>
<td>
<p>Whether the age-modelled distributions should be drawn downward or upward (the default, resembling islands in the sea)</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_threshold">threshold</code></td>
<td>
<p>Value below which probabilities should not be drawn any more. Defaults to 0.001 of the distribution's peak.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_xtop.lab">xtop.lab</code></td>
<td>
<p>The label for the x-axis of the top panel showing the MCMC run. Defaults to <code>"iterations"</code>.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_ytop.lab">ytop.lab</code></td>
<td>
<p>The label for the y-axis of the top panel showing the MCMC run. Defaults to <code>"energy"</code>.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_xbottom.lab">xbottom.lab</code></td>
<td>
<p>The label for the x-axis of the bottom panel showing the age-model output. Defaults to <code>"cal BP"</code> or <code>"BC/AD"</code>.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_ybottom.lab">ybottom.lab</code></td>
<td>
<p>The label for the y-axis of the bottom panel showing the age-model output. Defaults to <code>"position"</code>.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_calibrated.col">calibrated.col</code></td>
<td>
<p>Colour of the inside of the unmodelled, calibrated ages. Defaults to semi-transparent light grey, <code>rgb(0,0,0,0.5</code>.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_calibrated.border">calibrated.border</code></td>
<td>
<p>Colour of the border of the unmodelled non-14C ages. Defaults to nothing, NA.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_calbp.col">calBP.col</code></td>
<td>
<p>Colour of the inside of the unmodelled non-14C ages. Defaults to semi-transparent light grey, <code>rgb(0,0,0,0.5</code>.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_calbp.border">calBP.border</code></td>
<td>
<p>Colour of the border of the unmodelled, calibrated ages. Defaults to nothing, NA.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_modelled.col">modelled.col</code></td>
<td>
<p>Colour of the inside of the modelled ages. Defaults to semi-transparent dark grey, <code>rgb(0,0,0,0.5</code>.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_modelled.border">modelled.border</code></td>
<td>
<p>Colour of the border of the modelled ages. Defaults to semi-transparent dark grey, <code>rgb(0,0,0,0.5</code>.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_range.col">range.col</code></td>
<td>
<p>Colour of the hpd ranges. Defaults to <code>"black"</code>.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_block.col">block.col</code></td>
<td>
<p>Colour of the field indicating unordered dates within a 'block'. Defaults to light-blue, <code>rgb(0,0,1,.05)</code>.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_gap.col">gap.col</code></td>
<td>
<p>Colour of the diagonal lines and parameters of any gaps.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_gap.pos">gap.pos</code></td>
<td>
<p>Plotting position of the gap information.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_simulation">simulation</code></td>
<td>
<p>Whether or not the data are part of a simulated stratigraphy.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_simulation.col">simulation.col</code></td>
<td>
<p>If the data are part of a simulated stratigraphy, the 'true' ages can also be plotted.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_pos.lim">pos.lim</code></td>
<td>
<p>Limit of the main y-axis.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_age.lim">age.lim</code></td>
<td>
<p>Limit of the main x-axis.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_mgp">mgp</code></td>
<td>
<p>Axis text margins (where should titles, labels and tick marks be plotted). Defaults to <code>mgp=c(1.7, .7, .0)</code>.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_mar.top">mar.top</code></td>
<td>
<p>Margins around the top panel. Defaults to <code>mar.top=c(3,3,1,1)</code>.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_mar.bottom">mar.bottom</code></td>
<td>
<p>Margins around the bottom panel. Defaults to <code>mar.bottom=c(3,3,0.5,1)</code>.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_heights">heights</code></td>
<td>
<p>Relative heights of the two panels in the plot. Defaults to 0.3 for the top and 0.7 for the bottom panel.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_iterations.warning">iterations.warning</code></td>
<td>
<p>Whether or not to plot a warning if there are &lt; 3000 iterations, too few for a reliable MCMC run.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_min.its">min.its</code></td>
<td>
<p>The minimum amount of iterations, below which a warning is printed (if <code>iterations.warning=TRUE</code>). Defaults to 1,000.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_warning.loc">warning.loc</code></td>
<td>
<p>Location of the warning</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_warning.col">warning.col</code></td>
<td>
<p>Colour of the warning - defaults to red.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_labels">labels</code></td>
<td>
<p>Whether or not to draw any labels of the dates.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_label.loc">label.loc</code></td>
<td>
<p>Location of the labels. Defaults to the lefthand side of the graph.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_label.size">label.size</code></td>
<td>
<p>Size of the font of the labels. Defaults to <code>label.size=0.5</code>.</p>
</td></tr>
<tr><td><code id="draw.strat_+3A_label.col">label.col</code></td>
<td>
<p>Colour(s) of the labels, e.g., <code>label.col=1:10</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot with two panels showing the MCMC run and the calibrated and modelled ages.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>

<hr>
<h2 id='IAT'>calculate the Integrated Autocorrelation Time</h2><span id='topic+IAT'></span>

<h3>Description</h3>

<p>Calculate the Integrated Autocorrelation Time, which gives the proposed value for thinning. E.g., if the IAT is 80, it is good to thin the MCMC run by storing only every 80 iterations. This method is slower than GetAutoCov, but much better.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IAT(set, par = 0, from = 1, to)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IAT_+3A_set">set</code></td>
<td>
<p>This option reads the 'info' variable, which contains the data and the model output.</p>
</td></tr>
<tr><td><code id="IAT_+3A_par">par</code></td>
<td>
<p>The parameter to test. Defaults to 0.</p>
</td></tr>
<tr><td><code id="IAT_+3A_from">from</code></td>
<td>
<p>The first of the iterations of the MCMC run to check. Defaults to the first one.</p>
</td></tr>
<tr><td><code id="IAT_+3A_to">to</code></td>
<td>
<p>The last of the iterations of the MCMC run to check. Defaults to the last one.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The IAT value
</p>


<h3>Author(s)</h3>

<p>Andres Christen
</p>

<hr>
<h2 id='MCMCrings'>MCMC wiggle-match C-14 dating of a tree</h2><span id='topic+MCMCrings'></span>

<h3>Description</h3>

<p>Produce a Bayesian wiggle-match date of a tree dated with multiple C-14 dates at exactly known spacing (e.g., every 10 tree-ring years), assuming a constant reservoir effect that affects all dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCMCrings(
  name = "Ulandryk",
  tree.dir = "trees",
  delta.R = 0,
  delta.STD = 10,
  between = c(0, 15000),
  its = 50000,
  x0 = c(),
  xp0 = c(),
  burnin = 1000,
  internal.thinning = 1,
  thinning = c(),
  sep = ",",
  normal = FALSE,
  t.a = 3,
  t.b = 4,
  ask = TRUE,
  prob = 0.95,
  roundby = 1,
  cc = 1,
  postbomb = FALSE,
  BCAD = FALSE,
  talk = TRUE,
  draw = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MCMCrings_+3A_name">name</code></td>
<td>
<p>Name of the tree. The .csv file should be saved under a folder named exactly the same as <code>name</code>, and the folder should live under the <code>treedir</code> folder. The default is Ulandryk.</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_tree.dir">tree.dir</code></td>
<td>
<p>The directory where the folders of the individual trees live. Defaults to <code>tree.dir="trees"</code>.</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_delta.r">delta.R</code></td>
<td>
<p>The prior for the mean reservoir age, assuming a normal distribution. Defaults to 0.</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_delta.std">delta.STD</code></td>
<td>
<p>The prior standard deviation error of the offset, assuming a normal distribution. Set to 10 by default. Changing this value will have impacts on the calculations.</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_between">between</code></td>
<td>
<p>The range between which the initial ring is assumed to have accumulated. Should contain two values, which the form the limits of the uniform prior distribution for the calendar age. Set to c. Holocene ages by default.</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_its">its</code></td>
<td>
<p>Amount of MCMC iterations to be run. Defaults to 50000 as a compromise between speed and stability.</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_x0">x0</code></td>
<td>
<p>First set of initial values for calendar age and reservoir effect. Taken from the prior distributions by default.</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_xp0">xp0</code></td>
<td>
<p>Second set of initial values for calendar age and reservoir effect. Taken from the prior distributions by default.</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_burnin">burnin</code></td>
<td>
<p>Amount of iterations to remove after the run. Defaults to 1000.</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_internal.thinning">internal.thinning</code></td>
<td>
<p>Amount of iterations to thin after the run. Defaults to 1.</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_thinning">thinning</code></td>
<td>
<p>Amount of iterations to thin after the run. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_sep">sep</code></td>
<td>
<p>Separator for the fields in the .csv file. Defaults to a comma.</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_normal">normal</code></td>
<td>
<p>Calculations can be done assuming that the measurements are normally distributed. By default this is set to FALSE and a student-t distribution is used (Christen and Perez 2009)</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_t.a">t.a</code></td>
<td>
<p>First parameter for the student-t distribution (defaults to 3; higher numbers make the distribution approximate the normal distribution more).</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_t.b">t.b</code></td>
<td>
<p>Second parameter for the student-t distribution (defaults to 4; higher numbers make the distribution approximate the normal distribution more).</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_ask">ask</code></td>
<td>
<p>Whether or not to ask if new folders should be written (if required)</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_prob">prob</code></td>
<td>
<p>Probability range for the hpd calculations. Defaults to 95%, <code>prob=0.95</code>.</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_roundby">roundby</code></td>
<td>
<p>Rounding of the reported values, defaults to 1 decimal value.</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_cc">cc</code></td>
<td>
<p>Calibration curve to be used, for glueing to a postbomb curve. Could be 1 (IntCal20; default), 2 (Marine20), 3 (SHCal20) or 4 (custom curve). Normally not used, except in the case where there are postbomb dates (requiring the 'gluing' of pre- and postbomb curves).</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_postbomb">postbomb</code></td>
<td>
<p>Negative C-14 ages should be calibrated using a postbomb curve. This could be 1 (northern-hemisphere region 1), 2 (NH region 2), 3 (NH region 3), 4 (southern hemisphere regions 1-2), or 5 (SH region 3).</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_talk">talk</code></td>
<td>
<p>Whether or not to provide feedback.</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_draw">draw</code></td>
<td>
<p>Whether or not to draw the graphs.</p>
</td></tr>
<tr><td><code id="MCMCrings_+3A_...">...</code></td>
<td>
<p>Any additional plotting parameters. See draw.MCMCrings.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calculations are based on Bwigg (Christen and Litton 1995; Christen 2003). 
</p>
<p>Since two parameters have to be estimated (the age of the earliest, innermost ring and the reservoir effect delta.R), a MCMC approach is used.
</p>
<p>The tree files should be in plain-text and fields separated by commas, and the file's extension should be &quot;.csv&quot;.
The files should start with a line contain the following headers: &quot;lab ID&quot;, &quot;C-14 age&quot;, &quot;error&quot;, &quot;ring&quot;, &quot;cc&quot;, separated by commas. Then each row should have the corresponding values, also separated by commas.
Rings are counted from the inner ring (0 year old) outwards, so, forward in time. The file should start with the youngest rings, then work downward until reaching the oldest, bottommost dated rings. 
cc should either be 1 (IntCal20; northern hemisphere terrestrial, 2 (Marine20, though we've never heard of marine trees), 3 (SHCal20; southern hemisphere) or 4 (custom curve). 
</p>
<p>The default tree is called Ulandryk (Kuzman et al. 2004). As an alternative, a tree can be simulated (see <code>sim.tree()</code>).
</p>

<hr>
<h2 id='rings'>wiggle-match C-14 dating of a tree</h2><span id='topic+rings'></span>

<h3>Description</h3>

<p>Produce a Bayesian wiggle-match date of a tree dated with multiple C-14 dates at exactly known spacing (e.g., every 10 tree-ring years).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rings(
  name = "Ulandryk",
  tree.dir = "trees",
  sep = ",",
  normal = FALSE,
  delta.R = 0,
  delta.STD = 0,
  t.a = 3,
  t.b = 4,
  ask = TRUE,
  age.steps = 1,
  cutoff = 1e-06,
  prob = 0.95,
  cc = 1,
  postbomb = FALSE,
  BCAD = FALSE,
  times = 3,
  talk = TRUE,
  draw = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rings_+3A_name">name</code></td>
<td>
<p>Name of the tree. The .csv file should be saved under a folder named exactly the same as <code>name</code>, and the folder should live under the <code>treedir</code> folder. The default is Ulandryk.</p>
</td></tr>
<tr><td><code id="rings_+3A_tree.dir">tree.dir</code></td>
<td>
<p>The directory where the folders of the individual trees live. Defaults to <code>tree.dir="trees"</code>.</p>
</td></tr>
<tr><td><code id="rings_+3A_sep">sep</code></td>
<td>
<p>Separator for the fields in the .csv file. Defaults to a comma.</p>
</td></tr>
<tr><td><code id="rings_+3A_normal">normal</code></td>
<td>
<p>Calculations can be done assuming that the measurements are normally distributed. By default this is set to FALSE and a student-t distribution is used (Christen and Perez 2009)</p>
</td></tr>
<tr><td><code id="rings_+3A_delta.r">delta.R</code></td>
<td>
<p>The ages can be modelled to have an offset. The mean is 0 by default.</p>
</td></tr>
<tr><td><code id="rings_+3A_delta.std">delta.STD</code></td>
<td>
<p>The error of the offset. Set to 0 by default.</p>
</td></tr>
<tr><td><code id="rings_+3A_t.a">t.a</code></td>
<td>
<p>First parameter for the student-t distribution (defaults to 3; higher numbers make the distribution approximate the normal distribution more).</p>
</td></tr>
<tr><td><code id="rings_+3A_t.b">t.b</code></td>
<td>
<p>Second parameter for the student-t distribution (defaults to 4; higher numbers make the distribution approximate the normal distribution more).</p>
</td></tr>
<tr><td><code id="rings_+3A_ask">ask</code></td>
<td>
<p>Whether or not to ask if new folders should be written (if required)</p>
</td></tr>
<tr><td><code id="rings_+3A_age.steps">age.steps</code></td>
<td>
<p>Steps in years for the calculations. Defaults to 1, every year.</p>
</td></tr>
<tr><td><code id="rings_+3A_cutoff">cutoff</code></td>
<td>
<p>Value below which probabilities are no longer taken into account. Defaults to 0.000001.</p>
</td></tr>
<tr><td><code id="rings_+3A_prob">prob</code></td>
<td>
<p>After the run, a fit of the model with the dates is calculated, as the ratio of model iterations that fit the hpd ranges of the dates. Defaults to the <code>prob=0.95</code> hpd ranges.</p>
</td></tr>
<tr><td><code id="rings_+3A_cc">cc</code></td>
<td>
<p>Calibration curve to be used, for glueing to a postbomb curve. Could be 1 (IntCal20; default), 2 (Marine20), 3 (SHCal20) or 4 (custom curve). Normally not used, except in the case where there are postbomb dates (requiring the 'gluing' of pre- and postbomb curves).</p>
</td></tr>
<tr><td><code id="rings_+3A_postbomb">postbomb</code></td>
<td>
<p>Negative C-14 ages should be calibrated using a postbomb curve. This could be 1 (northern-hemisphere region 1), 2 (NH region 2), 3 (NH region 3), 4 (southern hemisphere regions 1-2), or 5 (SH region 3).</p>
</td></tr>
<tr><td><code id="rings_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="rings_+3A_times">times</code></td>
<td>
<p>The range of years to be calculated, as multiples of the uncertainties of the data points. E.g. if the lab error of the oldest date is 20 years, and times is set to 5, the calculation range will be extended by 20*5 years.</p>
</td></tr>
<tr><td><code id="rings_+3A_talk">talk</code></td>
<td>
<p>Whether or not to provide feedback on folders written into.</p>
</td></tr>
<tr><td><code id="rings_+3A_draw">draw</code></td>
<td>
<p>Whether or not to draw plots.</p>
</td></tr>
<tr><td><code id="rings_+3A_...">...</code></td>
<td>
<p>Options for the plot. See <code>draw.rings</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calculations are based on Bwigg (Christen and Litton 1995; Christen 2003). 
In OxCal, this is called a D_Sequence (Bronk Ramsey et al. 2001).
</p>
<p>Since only one parameter has to be estimated (the age of the earliest, innermost ring),
a MCMC approach is not necessary nor recommended, and results are calculated analytically.
</p>
<p>The tree files should be in plain-text and fields separated by commas, and the file's extension should be &quot;.csv&quot;.
The files should start with a line contain the following headers: &quot;lab ID&quot;, &quot;C-14 age&quot;, &quot;error&quot;, &quot;ring&quot;, &quot;cc&quot;, separated by commas. Then each row should have the corresponding values, also separated by commas.
Rings are counted from the inner ring (0 year old) outwards, so, forward in time. The file should start with the youngest rings, then work downward until reaching the oldest, bottommost dated rings. 
cc should either be 1 (IntCal20; northern hemisphere terrestrial, 2 (Marine20, though we've never heard of marine trees), 3 (SHCal20; southern hemisphere) or 4 (custom curve). 
</p>
<p>The default tree is called Ulandryk (Kuzman et al. 2004). As an alternative, a tree can be simulated (see <code>sim.tree()</code>).
</p>
<p>By default, the data are calibrated assuming a student-t distribution, which has wider tails than the normal distribution and deals well with scatter and outliers.
</p>


<h3>Value</h3>

<p>the probabilities for the relevant calendar years.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>References</h3>

<p>Bronk Ramsey C, van der Plicht J, Weninger B, 2001. 'Wiggle matching' radiocarbon dates. Radiocarbon 43, 381–389.
</p>
<p>Christen JA, Litton CD, 1995. A Bayesian approach to wiggle-matching. Journal of Archaeological Science 22, 719-725 <a href="https://doi.org/10.1016/0305-4403%2895%2990002-0">doi:10.1016/0305-4403(95)90002-0</a>
</p>
<p>Christen JA, 2003. Bwigg: An Internet facility for Bayesian radiocarbon wiggle-matching. Internet Archaeology 13. <a href="https://doi.org/10.11141/ia.13.2">doi:10.11141/ia.13.2</a>
</p>
<p>Christen JA, Perez S, 2009. A new robust statistical model for radiocarbon data. Radiocarbon 51, 1047-1059
</p>
<p>Kuzmin Y, Slusarenko I, Hajdas I, Bonani G, Christen JA. 2004. The comparison of 14C wiggle-matching results for the 'floating' tree-ring chronology of the Ulandryk-4 Burial Ground (Altai Mountains, Siberia). Radiocarbon 46, 943–948.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  rings("Ulandryk", tree.dir=tempdir())
</code></pre>

<hr>
<h2 id='scissors'>Remove the first n iterations.</h2><span id='topic+scissors'></span>

<h3>Description</h3>

<p>Removes iterations of the MCMC time series, and then updates the output files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scissors(burnin, set = get("info"), write = TRUE, save.info = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scissors_+3A_burnin">burnin</code></td>
<td>
<p>Number of iterations to remove of the iterative time series. If this value is higher than the amount of remaining iterations,
a warning is given and the iterations are not removed. If the provided number is negative, the iterations will be removed from the end of the run, not from the start. If a range is given, this range of iterations is removed.</p>
</td></tr>
<tr><td><code id="scissors_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
<tr><td><code id="scissors_+3A_write">write</code></td>
<td>
<p>Whether or not to write the changes to the output file. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="scissors_+3A_save.info">save.info</code></td>
<td>
<p>Whether or not to store a variable &lsquo;info&rsquo; in the session which contains the run input, output and settings. Defaults to <code>save.info=TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The strat function will perform thousands millions of MCMC iterations, although usually only a fraction of these will be stored. 
The remaining MCMC iterations should be well mixed (the upper panel
of the fit of the iterations should show no undesirable features such as trends or sudden systematic drops or rises).
If the run has a visible remaining burn-in, scissors can be used to remove them.
To remove, e.g., the first 300 iterations, type <code>scissors(300)</code>. To remove the last 300 iterations, type <code>scissors(-300)</code>. To remove iterations 300 to 600, type <code>scissors(300:600)</code>.
</p>


<h3>Value</h3>

<p>NA
</p>

<hr>
<h2 id='sim.rings'>Simulate the radiocarbon dating of tree-rings</h2><span id='topic+sim.rings'></span>

<h3>Description</h3>

<p>Simulate the dense radiocarbon dating of a tree or other deposit with exactly known yearly rings, and thus with gaps of exactly known age. The radiocarbon dates are assumed to have a degree of lab error and scatter. A (constant) offset can also be modelled.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.rings(
  name = "mytree",
  age.start = 1000,
  length = 400,
  gaps = 20,
  offset = 0,
  scatter = 1.05,
  error = 0.03,
  min.error = 15,
  tree.dir = "trees",
  sep = ",",
  cc = 1,
  postbomb = FALSE,
  ask = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim.rings_+3A_name">name</code></td>
<td>
<p>Name of the simulated tree-ring set. Defaults to <code>"mytree"</code>.</p>
</td></tr>
<tr><td><code id="sim.rings_+3A_age.start">age.start</code></td>
<td>
<p>Starting age of the simulated tree.</p>
</td></tr>
<tr><td><code id="sim.rings_+3A_length">length</code></td>
<td>
<p>Length of the sequence (if gaps are given as constant). Could be set at e.g 400 for an oak, but many trees will not live as long so shorter sequences could also make sense.</p>
</td></tr>
<tr><td><code id="sim.rings_+3A_gaps">gaps</code></td>
<td>
<p>How many calendar years there are between the dated rings. Can be set constant (one value, e.g. 20), or alternatively the gaps can be provided as a list of values.</p>
</td></tr>
<tr><td><code id="sim.rings_+3A_offset">offset</code></td>
<td>
<p>The ages could be offset by some constant value. Defaults to 0.</p>
</td></tr>
<tr><td><code id="sim.rings_+3A_scatter">scatter</code></td>
<td>
<p>There is always a degree of scatter between measurements, and the amount of scatter can be modelled using, e.g., <code>scatter=2*error</code>. Set at 0 to model radiocarbon dates that are 100% faithful to the calibration curve (very unlikely!).</p>
</td></tr>
<tr><td><code id="sim.rings_+3A_error">error</code></td>
<td>
<p>Laboratory error of the radiocarbon dates as percentage of the mean. Defaults to 0.02.</p>
</td></tr>
<tr><td><code id="sim.rings_+3A_min.error">min.error</code></td>
<td>
<p>Minimum laboratory to be reported. Defaults to 10 (C-14 year).</p>
</td></tr>
<tr><td><code id="sim.rings_+3A_tree.dir">tree.dir</code></td>
<td>
<p>The directory where the folders of the individual trees live. Defaults to <code>tree.dir="trees"</code>.</p>
</td></tr>
<tr><td><code id="sim.rings_+3A_sep">sep</code></td>
<td>
<p>Separator for the fields in the .csv file. Defaults to a comma.</p>
</td></tr>
<tr><td><code id="sim.rings_+3A_cc">cc</code></td>
<td>
<p>Calibration curve to be used. Could be 1 (IntCal20; default), 2 (Marine20), 3 (SHCal20) or 4 (custom curve).</p>
</td></tr>
<tr><td><code id="sim.rings_+3A_postbomb">postbomb</code></td>
<td>
<p>Negative C-14 ages (younger than 0 cal BP or AD 1950) should be modelled using a postbomb curve. This could be 1 (northern-hemisphere region 1), 2 (NH region 2), 3 (NH region 3), 4 (southern hemisphere regions 1-2), or 5 (SH region 3).</p>
</td></tr>
<tr><td><code id="sim.rings_+3A_ask">ask</code></td>
<td>
<p>Ask if a folder may be made and files written into it</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A file containing 5 columns: the simulated calendar ages, the radiocarbon ages, their errors, the rings (starting with the youngest year and working backward in time), and the calibration curve to be used.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  treedir &lt;- tempdir()
  sim.rings("manyrings", age.start=1000, length=400, gaps=10, tree.dir=treedir)
  rings("manyrings", tree.dir=treedir)
</code></pre>

<hr>
<h2 id='sim.strat'>Simulate the radiocarbon dating of random depths of a sediment which has accumulated over time.</h2><span id='topic+sim.strat'></span>

<h3>Description</h3>

<p>Simulate the radiocarbon dating (or with dates that are already on the cal BP scale) of a deposit that is known to have accumulated over time, and for which therefore the dated depths can be safely assumed to be in chronological order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.strat(
  name = "mystrat",
  age.min = 4321,
  length = 800,
  n = 5,
  offset = 0,
  scatter = 2 * error,
  error = 0.02,
  min.error = 10,
  rounded = 0,
  strat.dir = "strats",
  sep = ",",
  cc = 1,
  postbomb = FALSE,
  ask = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim.strat_+3A_name">name</code></td>
<td>
<p>Name of the simulated stratigraphy. Defaults to <code>"mystrat"</code>.</p>
</td></tr>
<tr><td><code id="sim.strat_+3A_age.min">age.min</code></td>
<td>
<p>Minimum age of the simulation.</p>
</td></tr>
<tr><td><code id="sim.strat_+3A_length">length</code></td>
<td>
<p>Length of the sequence.</p>
</td></tr>
<tr><td><code id="sim.strat_+3A_n">n</code></td>
<td>
<p>The amount of dated depths.</p>
</td></tr>
<tr><td><code id="sim.strat_+3A_offset">offset</code></td>
<td>
<p>The ages could be offset by some constant value. Defaults to 0.</p>
</td></tr>
<tr><td><code id="sim.strat_+3A_scatter">scatter</code></td>
<td>
<p>There is always a degree of scatter between measurements, and the amount of scatter can be modelled using, e.g., <code>scatter=2*error</code>. Set at 0 to model radiocarbon dates that are 100% faithful to the calibration curve (very unlikely!).</p>
</td></tr>
<tr><td><code id="sim.strat_+3A_error">error</code></td>
<td>
<p>Laboratory error of the radiocarbon dates as percentage of the mean. Defaults to 0.02.</p>
</td></tr>
<tr><td><code id="sim.strat_+3A_min.error">min.error</code></td>
<td>
<p>Minimum laboratory to be reported. Defaults to 10 (C-14 year).</p>
</td></tr>
<tr><td><code id="sim.strat_+3A_rounded">rounded</code></td>
<td>
<p>Rounding of the simulated calendar years. Rounds to single years (0 decimals) by default.</p>
</td></tr>
<tr><td><code id="sim.strat_+3A_strat.dir">strat.dir</code></td>
<td>
<p>The directory where the folders of the individual trees live. Defaults to <code>tree.dir="trees"</code>.</p>
</td></tr>
<tr><td><code id="sim.strat_+3A_sep">sep</code></td>
<td>
<p>Separator for the fields in the .csv file. Defaults to a comma.</p>
</td></tr>
<tr><td><code id="sim.strat_+3A_cc">cc</code></td>
<td>
<p>Calibration curve to be used. Could be 1 (IntCal20; default), 2 (Marine20), 3 (SHCal20) or 4 (custom curve).</p>
</td></tr>
<tr><td><code id="sim.strat_+3A_postbomb">postbomb</code></td>
<td>
<p>Negative C-14 ages (younger than 0 cal BP or AD 1950) should be modelled using a postbomb curve. This could be 1 (northern-hemisphere region 1), 2 (NH region 2), 3 (NH region 3), 4 (southern hemisphere regions 1-2), or 5 (SH region 3).</p>
</td></tr>
<tr><td><code id="sim.strat_+3A_ask">ask</code></td>
<td>
<p>Ask if a folder may be made and files written into it</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Dates further down the sequence should have older ages than dates further up, even though owing to scatter, the dates themselves might not be in exact chronological order. The modelling is performed in a Bayesian framework (see <code>strat</code>). The amount of scatter, the laboratory error and an offset can also be modelled.
</p>


<h3>Value</h3>

<p>A file containing 5 columns: the simulated calendar ages, the radiocarbon ages, their errors, their relative positions (starting with the youngest one at top, and counting upward going down the sequence), and the calibration curve to be used.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  stratdir &lt;- tempdir()
  sim.strat("ordered.mud", age.min=1000, length=5000, n=10, strat.dir=stratdir)
</code></pre>

<hr>
<h2 id='strat'>Model chronologically ordered dates</h2><span id='topic+strat'></span>

<h3>Description</h3>

<p>Model radiocarbon dates (or dates that are already on the cal BP scale) of a deposit that is known to have accumulated over time, and for which therefore the dated positions can be safely assumed to are in chronological order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strat(
  name = "mystrat",
  strat.dir = "strats",
  run = TRUE,
  its = 50000,
  burnin = 100,
  thinning = c(),
  internal.thinning = c(),
  min.its = 1000,
  write.MCMC = FALSE,
  MCMC.dir = tempdir(),
  remove.tmp = TRUE,
  init.ages = c(),
  ballpark.method = 2,
  y.scale = "dates",
  showrun = FALSE,
  sep = ",",
  normal = FALSE,
  delta.R = 0,
  delta.STD = 0,
  t.a = 3,
  t.b = 4,
  cc = 1,
  cc.dir = c(),
  prob = 0.95,
  postbomb = FALSE,
  BCAD = FALSE,
  ask = FALSE,
  talk = TRUE,
  show.progress = TRUE,
  clean.garbage = TRUE,
  save.info = TRUE,
  roundby = 1,
  age.span = c(),
  pdf = TRUE,
  png = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="strat_+3A_name">name</code></td>
<td>
<p>Name of the stratigraphy dataset. Defaults to <code>"mystrat"</code>.</p>
</td></tr>
<tr><td><code id="strat_+3A_strat.dir">strat.dir</code></td>
<td>
<p>The directory where the folders of the individual stratigraphies live. Defaults to <code>strat.dir="strats"</code>.</p>
</td></tr>
<tr><td><code id="strat_+3A_run">run</code></td>
<td>
<p>Whether or not to run the data. If set to FALSE, will try to load existing run data.</p>
</td></tr>
<tr><td><code id="strat_+3A_its">its</code></td>
<td>
<p>Amount of iterations to be run. Setting this to low numbers (e.g., 1000) will result in fast but less stable and less reliable runs. Higher values will take longer but result in more stable and robust runs. Defaults to <code>50000</code>. Aim to set this to such values that at least 3000 iterations remain after removing the burnin and thinning.</p>
</td></tr>
<tr><td><code id="strat_+3A_burnin">burnin</code></td>
<td>
<p>Amount of iterations to remove at the start of the run. Defaults to <code>100</code>.</p>
</td></tr>
<tr><td><code id="strat_+3A_thinning">thinning</code></td>
<td>
<p>After running all iterations, only some will be stored. For example, if thinning is set at the default <code>50</code>, only every 50th MCMC iteration will be stored, and the others will be discarded. This is to remove the dependence between neighbouring MCMC iterations. Defaults to a value calculated from the MCMC run itself.</p>
</td></tr>
<tr><td><code id="strat_+3A_internal.thinning">internal.thinning</code></td>
<td>
<p>Does internal thinning during the MCMC process, storing only every 'internal.thinning' MCMC iterations.</p>
</td></tr>
<tr><td><code id="strat_+3A_min.its">min.its</code></td>
<td>
<p>Minimum number of (remaining) iterations, below which a warning is given. Defaults for now to 1,000 iterations.</p>
</td></tr>
<tr><td><code id="strat_+3A_write.mcmc">write.MCMC</code></td>
<td>
<p>Especially longer runs or sites with many dates can take up lots of memory. For such cases, MCMC iterations are stored in temporary files (and in the session's tempdir() folder) rather than in memory - however this could impact your computer as the files have to be written to repeatedly and they can become huge. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="strat_+3A_mcmc.dir">MCMC.dir</code></td>
<td>
<p>Directory where temporary MCMC files will be saved. If left empty, defaults to <code>tempdir()</code>.</p>
</td></tr>
<tr><td><code id="strat_+3A_remove.tmp">remove.tmp</code></td>
<td>
<p>If <code>write.MCMC=TRUE</code>, then by default the (often huge) temporary files are deleted after the run. Set to <code>remove.tmp=FALSE</code> to keep these temporary files. The files will be placed in the temporary folder of this R session - where this is can be checked by providing the command <code>tempdir()</code>.</p>
</td></tr>
<tr><td><code id="strat_+3A_init.ages">init.ages</code></td>
<td>
<p>By default, the ballpark age estimates to feed the MCMC are calculated automatically, however they can also be provided manually, as two rows of values (for x0 and xp0) which have to obey the assumptions (e.g., chronological ordering).</p>
</td></tr>
<tr><td><code id="strat_+3A_ballpark.method">ballpark.method</code></td>
<td>
<p>Initial, ballpark values for the initial ages (if not provided by the option 'init.ages'). Can be 1 (based on a linear model) or 2 (based on sorted random draws).</p>
</td></tr>
<tr><td><code id="strat_+3A_y.scale">y.scale</code></td>
<td>
<p>The scale of the vertical axis of the main plot. This can be the positions of the dated levels ('positions') or their position order ('dates').</p>
</td></tr>
<tr><td><code id="strat_+3A_showrun">showrun</code></td>
<td>
<p>Whether or not to show how the MCMC process is progressing during the run. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="strat_+3A_sep">sep</code></td>
<td>
<p>Separator for the fields in the .csv file. Defaults to a comma.</p>
</td></tr>
<tr><td><code id="strat_+3A_normal">normal</code></td>
<td>
<p>Calculations can be done assuming that the measurements are normally distributed. By default this is set to FALSE and a student-t distribution is used (Christen and Perez 2009)</p>
</td></tr>
<tr><td><code id="strat_+3A_delta.r">delta.R</code></td>
<td>
<p>The ages can be modelled to have an offset. The mean is 0 by default.</p>
</td></tr>
<tr><td><code id="strat_+3A_delta.std">delta.STD</code></td>
<td>
<p>The error of the offset. Set to 0 by default.</p>
</td></tr>
<tr><td><code id="strat_+3A_t.a">t.a</code></td>
<td>
<p>First parameter for the student-t distribution (defaults to 3; higher numbers make the distribution approximate the normal distribution more).</p>
</td></tr>
<tr><td><code id="strat_+3A_t.b">t.b</code></td>
<td>
<p>Second parameter for the student-t distribution (defaults to 4; higher numbers make the distribution approximate the normal distribution more).</p>
</td></tr>
<tr><td><code id="strat_+3A_cc">cc</code></td>
<td>
<p>Calibration curve to be used, for glueing to a postbomb curve. Could be 1 (IntCal20; default), 2 (Marine20), 3 (SHCal20) or 4 (custom curve). Normally not used (since this information is best provided within the .csv files), except in the case where there are postbomb dates (requiring the 'gluing' of pre- and postbomb curves).</p>
</td></tr>
<tr><td><code id="strat_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of calibration curve(s). Keep empty for the default value.</p>
</td></tr>
<tr><td><code id="strat_+3A_prob">prob</code></td>
<td>
<p>After the run, a fit of the model with the dates is calculated, as the ratio of model iterations that fit the hpd ranges of the dates. Defaults to the <code>prob=0.95</code> hpd ranges.</p>
</td></tr>
<tr><td><code id="strat_+3A_postbomb">postbomb</code></td>
<td>
<p>Negative C-14 ages should be calibrated using a postbomb curve. This could be 1 (northern-hemisphere region 1), 2 (NH region 2), 3 (NH region 3), 4 (southern hemisphere regions 1-2), or 5 (SH region 3). Defaults to no postbomb curve (<code>postbomb=FALSE</code>).</p>
</td></tr>
<tr><td><code id="strat_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>. Needs more work probably.</p>
</td></tr>
<tr><td><code id="strat_+3A_ask">ask</code></td>
<td>
<p>Whether or not to ask if a folder should be made (if required).</p>
</td></tr>
<tr><td><code id="strat_+3A_talk">talk</code></td>
<td>
<p>Whether or not to provide feedback on folders written into and on what is happening.</p>
</td></tr>
<tr><td><code id="strat_+3A_show.progress">show.progress</code></td>
<td>
<p>Whether or not to provide feedback on progress made with the run.</p>
</td></tr>
<tr><td><code id="strat_+3A_clean.garbage">clean.garbage</code></td>
<td>
<p>Whether or not to clean up the memory 'garbage collection' after a run. Recommendable if you have many dates or long runs.</p>
</td></tr>
<tr><td><code id="strat_+3A_save.info">save.info</code></td>
<td>
<p>Whether or not to store a variable &lsquo;info&rsquo; in the session which contains the run input, output and settings. Defaults to <code>save.info=TRUE</code>.</p>
</td></tr>
<tr><td><code id="strat_+3A_roundby">roundby</code></td>
<td>
<p>Number of decimals to round age (and any gap) estimates by, as reported in files in the site's folder.</p>
</td></tr>
<tr><td><code id="strat_+3A_age.span">age.span</code></td>
<td>
<p>Expected age span. Defaults to run from the current year in AD to 55e3 which is the current cal BP limit for C-14 dates. If older, non-14C dates are present, age.span is set to the larger of the radiocarbon limit or twice the age of the oldest non-radiocarbon age.</p>
</td></tr>
<tr><td><code id="strat_+3A_pdf">pdf</code></td>
<td>
<p>Make a pdf copy of the plot and save it in the site's folder. Defaults to <code>pdf=TRUE</code>.</p>
</td></tr>
<tr><td><code id="strat_+3A_png">png</code></td>
<td>
<p>Make a png copy of the plot and save it in the site's folder. Defaults to <code>png=TRUE</code>.</p>
</td></tr>
<tr><td><code id="strat_+3A_...">...</code></td>
<td>
<p>Options for the plot. See <code>draw.strat</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Dates further down the sequence should have older ages than dates further up, even though owing to scatter, the dates themselves might not be in exact chronological order. The amount of scatter, the laboratory error and an offset can also be modelled.
The function reads in a comma-separated-values (.csv) file of a specific format. The first column contains the names of the dates/information, the second column has the age(s) (uncalibrated for radiocarbon dates, as they will be calibrated during the modelling), the third column their errors, the fourth column their position (see below), and the fifth column cc, the calibration curve information. Additional columns for the reservoir effect (delta.R and delta.STD) and the student-t model (t.a and t.b) can be added, much like rbacon .csv files.
The file should contain a header as the first row, named &quot;lab ID&quot;, &quot;age&quot;, &quot;error&quot;, &quot;position&quot;, and &quot;cc&quot; (with additional fields as per below if required). The extension of the file should be &quot;.csv&quot;. 
The positions of the dates (column 4) should be entered with the topmost, youngest levels first, and then working downward toward the oldest levels. The topmost position gets the lowest number (e.g., 0), and each subsequent entry should have a higher position number to ensure that the levels are ordered in time. Dates in 'blocks' where there is no known age ordering between the dates in the block (but where that block is known to be older than the level above it and younger than the level below it) should all get the same position in column 4.  
The function does not only deal with dates (radiocarbon or otherwise), but can also model undated levels and a range of gaps between the dated levels. This is done mostly through column 5 in the .csv files, where a 0 is for dates on the cal BP scale, 1 for radiocarbon dates that require calibration with IntCal20, 2 with Marine20, 3 with SHCal20, 4 a custom calibration curve; additional information can be provided by adding entries for undated levels (cc=10), gaps of exactly known length (cc=11), normally distributed gap lengths (cc=12), or gamma distributed gap lengths (cc=13).
The age estimates are obtained through a t-walk MCMC run (Christen and Fox 2010). In this process, initial ball-park point estimates for the ages of each dated depth are given, checked for their chronological ordering (and for the sizes of any gaps) and then modified through many iterations. For each iteration, a random dated depth is chosen and its age changed by just a little nudge, a check is performed to ensure that all age estimates remain in chronological order (and that gap sizes remain obeyed), and the 'energy' or likelihood of the age estimates is calculated (iterations where all ages fit well within the calibrated distributions receive a higher energy; see <code>l.calib</code>). 
Then this iteration with the updated group of age estimates is either accepted or rejected. The acceptance probability depends on the iteration's energy; if its energy is higher than that of the previous iteration it is accepted, but if it is lower, it is accepted with a probability proportional to its relative energy. Therefore, over many iterations the process will 'learn' from the data and find high-energy combinations of parameter values that fit with the prior constraints that the ages should be ordered chronologically.
Because the iterations are based on a process of modifying values of one parameter each iteration, and because some iterations will not be accepted, the MCMC output will often have a large degree of dependence between neighbouring iterations. Therefore, some thinning will have to be done, by storing only one every few iterations (default 20). Also, since the initial ball-park estimates could be quite wrong, the first 100 or so iterations should also be discarded (burnin). 
It is thus important to check the time-series of the energy after the run. We don't want to see a remaining burn-in at the start, and we don't want to see a noticeable 'structure' where iterations remain in approximately or entirely the same spot for a long time. Instead, an ideal run will look like white noise.
By default, the model output and the settings are stored in a list called &lsquo;info&rsquo; which is placed into R's session as a list. For example, to retrieve the model output, type info$output. This has a column for each date, and a row for each stored MCMC iteration. The MCMC's energy can be found in info$Us. The model's &lsquo;structure&rsquo; such as blocks or gaps can be found in info$struc. To check which dates were used, type info$dets or info$dat (the latter will include all information, including any gaps).
</p>


<h3>Value</h3>

<p>a variable 'info' which contains the dating and modelling information to produce a plot (see details). Also calls the function <code>draw.strat</code> to produce a plot of the results, and saves file(s) with summaries of the age estimates and any gaps.
</p>


<h3>References</h3>

<p>Bronk Ramsey C, 1995. Radiocarbon calibration and analysis of stratigraphy: The OxCal program. Radiocarbon 37, 425 – 430.
</p>
<p>Buck CE, Kenworthy JB, Litton CD, Smith AFM, 1991. Combining archaeological and radiocarbon information: a Bayesian approach to calibration. Antiquity 65, 808-821.
</p>
<p>Buck et al. 1999. BCal: an on-line Bayesian radiocarbon calibration tool. Internet Archaeology 7. 
</p>
<p>Christen JA, Fox C 2010. A general purpose sampling algorithm for continuous distributions (the t-walk). Bayesian Analysis 5, 263-282. 
</p>
<p>Nicholls G, Jones M 2001. Radiocarbon dating with temporal order constraints. Journal of the Royal Statistical Society: Series C (Applied Statistics) 50, 503-521.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
tmp &lt;- tempdir()
strat(, strat.dir=tmp, its=1000, thinning=1, internal.thinning=1)

## End(Not run)
</code></pre>

<hr>
<h2 id='strat.cleanup'>Remove .out files from a run</h2><span id='topic+strat.cleanup'></span>

<h3>Description</h3>

<p>Remove all .out files in the folder of a strat file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strat.cleanup(set = get("info"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="strat.cleanup_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NA
</p>

<hr>
<h2 id='thinner'>Thin iterations.</h2><span id='topic+thinner'></span>

<h3>Description</h3>

<p>Randomly thin iterations by a given proportion, for example if autocorrelation is visible within the MCMC series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thinner(proportion = 0.1, set = get("info"), write = TRUE, save.info = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="thinner_+3A_proportion">proportion</code></td>
<td>
<p>Proportion of iterations to remove. Should be between 0 and 1. Default <code>proportion=0.1</code>.</p>
</td></tr>
<tr><td><code id="thinner_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
<tr><td><code id="thinner_+3A_write">write</code></td>
<td>
<p>Whether or not to write the changes to the output file. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="thinner_+3A_save.info">save.info</code></td>
<td>
<p>Whether or not to store a variable &lsquo;info&rsquo; in the session which contains the run input, output and settings. Defaults to <code>save.info=TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From all iterations, a proportion is removed with to-be-removed iterations sampled randomly among all iterations.
</p>


<h3>Value</h3>

<p>NA
</p>

<hr>
<h2 id='withinhpd'>Calculate the fit of a modelled age with the corresponding date</h2><span id='topic+withinhpd'></span>

<h3>Description</h3>

<p>This is a measure of the fit of the modelled age to that of the date. If many of the modelled age iterations fall within any of the highest posterior density (hpd) range of a date, the model fits the date well. The values can range from 0
</p>


<h3>Usage</h3>

<pre><code class='language-R'>withinhpd(calibs, probs, modelled, prob = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="withinhpd_+3A_calibs">calibs</code></td>
<td>
<p>The calibrated ages of the distributions (dates)</p>
</td></tr>
<tr><td><code id="withinhpd_+3A_probs">probs</code></td>
<td>
<p>The probabilities associated with the calibrated ages (dates)</p>
</td></tr>
<tr><td><code id="withinhpd_+3A_modelled">modelled</code></td>
<td>
<p>The modelled ages</p>
</td></tr>
<tr><td><code id="withinhpd_+3A_prob">prob</code></td>
<td>
<p>Probability range for the hpd ranges</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of fits (values between 0 and 100
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
