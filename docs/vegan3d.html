<!DOCTYPE html><html lang="en"><head><title>Help for package vegan3d</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {vegan3d}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#vegan3d-package'>
<p>Dynamic and Static 3D and Interactive 2D Plots for Ordination</p></a></li>
<li><a href='#ordilattice3d'><p> 3D Trellis (Lattice) Plots for Ordination</p></a></li>
<li><a href='#ordiplot3d'><p>Three-Dimensional Ordination Graphics</p></a></li>
<li><a href='#ordirgl'><p>Three-Dimensional Dynamic Ordination Graphics</p></a></li>
<li><a href='#orditkplot'><p> Ordination Plot with Movable Labels</p></a></li>
<li><a href='#orditree3d'>
<p>Draw Cluster Tree over a Plane</p></a></li>
<li><a href='#rgl.isomap'>
<p>Dynamic 3D plot of isomap ordination.</p></a></li>
<li><a href='#rgl.renyiaccum'>
<p>Dynamic Perspective Plot of Renyi Diversity Accumulation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Static and Dynamic 3D and Editable Interactive Plots for the
'vegan' Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4-0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0), vegan (&ge; 2.3-0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>tcltk</td>
</tr>
<tr>
<td>Imports:</td>
<td>cluster, lattice, rgl, scatterplot3d (&ge; 0.3-40)</td>
</tr>
<tr>
<td>Description:</td>
<td>Static and dynamic 3D plots to be used with ordination
    results and in diversity analysis, especially with the vegan package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/vegandevs/vegan3d/issues">https://github.com/vegandevs/vegan3d/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://cran.r-project.org/">https://cran.r-project.org/</a>, <a href="https://github.com/vegandevs/vegan3d">https://github.com/vegandevs/vegan3d</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-20 08:57:34 UTC; jarioksa</td>
</tr>
<tr>
<td>Author:</td>
<td>Jari Oksanen [aut, cre],
  Roeland Kindt [aut],
  Gavin L. Simpson [aut],
  Duncan Murdoch [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jari Oksanen &lt;jhoksane@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-20 10:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='vegan3d-package'>
Dynamic and Static 3D and Interactive 2D Plots for Ordination
</h2><span id='topic+vegan3d-package'></span><span id='topic+vegan3d'></span>

<h3>Description</h3>

<p>The <span class="pkg">vegan3d</span> package provides 3D plotting for all <a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a>
ordination methods or any other ordination method that <a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a>
<code><a href="vegan.html#topic+scores">scores</a></code> function can handle. It can also display
<code><a href="stats.html#topic+hclust">hclust</a></code> results in 3D over a 2D plane. Dynamic 3D plots
are based on the <a href="https://CRAN.R-project.org/package=rgl"><span class="pkg">rgl</span></a> package and static plots are drawn with
<a href="https://CRAN.R-project.org/package=scatterplot3d"><span class="pkg">scatterplot3d</span></a> and <a href="https://CRAN.R-project.org/package=lattice"><span class="pkg">lattice</span></a> packages. The package
also provides 2D editable interactive plots for ordination. The points
are fixed at their ordination scores, but labels can be moved to
better position, and the result can be saved in various graphics
formats or saved in <span class="rlang"><b>R</b></span> session and re-created with <span class="rlang"><b>R</b></span> plot
commands.
</p>

<p>Index of help topics:
</p>
<pre>
ordilattice3d           3D Trellis (Lattice) Plots for Ordination
ordiplot3d              Three-Dimensional Ordination Graphics
ordirgl                 Three-Dimensional Dynamic Ordination Graphics
orditkplot              Ordination Plot with Movable Labels
orditree3d              Draw Cluster Tree over a Plane
rgl.isomap              Dynamic 3D plot of isomap ordination.
rgl.renyiaccum          Dynamic Perspective Plot of Renyi Diversity
                        Accumulation
vegan3d-package         Dynamic and Static 3D and Interactive 2D Plots
                        for Ordination
</pre>


<h3>Drawing with rgl Functions</h3>

<p>The <a href="https://CRAN.R-project.org/package=rgl"><span class="pkg">rgl</span></a> graphics are dynamic 3D plots that can be spinned and
zoomed with mouse. The <span class="pkg">vegan3d</span> package provides interface to
ordination and clustering objects. The functions use <a href="https://CRAN.R-project.org/package=rgl"><span class="pkg">rgl</span></a> setting
and conventions and do not change the user settings. For general
configuration of the plots, users should check <span class="pkg">rgl</span>
documentation. For instance, general look and feel of drawn items can
be configured with <code><a href="rgl.html#topic+material3d">material3d</a></code>.
</p>
<p>The <a href="https://CRAN.R-project.org/package=rgl"><span class="pkg">rgl</span></a> package may not be available on all platforms, and
the package is not automatically loaded. If you want to use
<a href="https://CRAN.R-project.org/package=rgl"><span class="pkg">rgl</span></a> functions, you must either prefix commands with
<code>rgl::</code> or call <code>library(rgl)</code> in your session. If you
cannot launch <code>rgl</code> window (or widget) on your platform, check
the instructions on the <a href="https://CRAN.R-project.org/package=rgl"><span class="pkg">rgl</span></a>. In most cases, it should be
possible to use <span class="pkg">rgl</span> at least on a compatible browser.
</p>
<p>Function <code><a href="#topic+ordirgl">ordirgl</a></code> is similar to
<code><a href="vegan.html#topic+ordiplot">ordiplot</a></code> in <a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a>, and any ordination
result can be drawn with similar conventions. Functions with
<code>orgl</code> prefix add items to existing plots, for instance,
<code><a href="#topic+orglellipse">orglellipse</a></code> is analogous to
<code><a href="vegan.html#topic+ordiellipse">ordiellipse</a></code>.
</p>
<p>Function <code><a href="#topic+ordirgltree">ordirgltree</a></code> draws an <code><a href="stats.html#topic+hclust">hclust</a></code>
dendrogram over a plane. It was originally developed for 2D ordination
planes, but any other plane can be used, for instance a projected map.
</p>
<p>Functions <code><a href="#topic+rgl.isomap">rgl.isomap</a></code> and <code><a href="#topic+rgl.renyiaccum">rgl.renyiaccum</a></code>
provide alternative dynamic 3D plots for <a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a>
<code><a href="vegan.html#topic+isomap">isomap</a></code> and <code><a href="vegan.html#topic+renyiaccum">renyiaccum</a></code>
functions.
</p>


<h3>Drawing with scatterplot3d and lattice Functions</h3>

<p>The <a href="https://CRAN.R-project.org/package=scatterplot3d"><span class="pkg">scatterplot3d</span></a> package draws static 3D graphics, and
<span class="pkg">vegan3d</span> provides an interface for ordination and clustering
objects. You must consult the
<code><a href="scatterplot3d.html#topic+scatterplot3d">scatterplot3d</a></code> documentation for
configuring your plots. <span class="pkg">vegan3d</span> function
<code><a href="#topic+ordilattice3d">ordilattice3d</a></code> is similar, but is based on the
<a href="https://CRAN.R-project.org/package=lattice"><span class="pkg">lattice</span></a> package, and can be modified using <span class="pkg">lattice</span>
commands and arguments.
</p>
<p>Function <code><a href="#topic+ordiplot3d">ordiplot3d</a></code> is similar to <code><a href="#topic+ordirgl">ordirgl</a></code>
or <code><a href="vegan.html#topic+ordiplot">ordiplot</a></code> and draws a static 3D plot in the
standard graphical device. It returns invisibly a plotting object
which contains the projected points, and <a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a> <code>ordi*</code>
prefix functions can use this object. For instance,
<code><a href="vegan.html#topic+ordiellipse">ordiellipse</a></code> will add ellipses on the projected
points.
</p>
<p>Function <code><a href="#topic+ordilattice3d">ordilattice3d</a></code> is a similar to
<code><a href="#topic+ordiplot3d">ordiplot3d</a></code> in <span class="pkg">lattice</span> graphics, but currently more
limited than <code>ordiplot3d</code>. The <span class="pkg">lattice</span> package is not
loaded and you need to use <code>library(lattice)</code> or prefix your
<span class="pkg">lattice</span> commands with <code>lattice::</code>. There are obvious ways
of improving the function. Contributions are welcome.
</p>
<p>Function <code><a href="#topic+orditree3d">orditree3d</a></code> will draw an <code><a href="stats.html#topic+hclust">hclust</a></code>
dendrogram over a plane similarly as <code><a href="#topic+ordirgltree">ordirgltree</a></code>.
</p>


<h3>Editable Graphics with Tcl/Tk based orditkplot</h3>

<p>Function draws ordination scores in a new Tcl/Tk window with fixed
points and their editable labels. The labels can be moved to better
positions which helps with crowded plots. It is also possible to zoom
into graph to display only a part of the complete graph. The edited
result can be saved in various graphical formats or saved as an <span class="rlang"><b>R</b></span>
object in the session for further manipulation or re-creating the graph
with standard <span class="rlang"><b>R</b></span> plotting tools.
</p>
<p>Tcl/Tk is not available on all platforms or <span class="rlang"><b>R</b></span> installations. Use
command <code>capabilities("tcltk")</code> to see if you have it in your
system.
</p>
<p>There are obvious ways of improving the function. Contributions are
welcome.
</p>

<hr>
<h2 id='ordilattice3d'> 3D Trellis (Lattice) Plots for Ordination </h2><span id='topic+ordilattice3d'></span><span id='topic+panel.ordi3d'></span><span id='topic+prepanel.ordi3d'></span>

<h3>Description</h3>

<p>Function <code>ordicloud</code> provides an interface for 3D ordination
graphics using Trellis function <code><a href="lattice.html#topic+cloud">cloud</a></code> in package
<span class="pkg">lattice</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ordilattice3d(x, data = NULL, formula, display = "sites", choices = 1:3,
    panel = "panel.ordi3d", prepanel = "prepanel.ordi3d",  ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ordilattice3d_+3A_x">x</code></td>
<td>
<p> An ordination result that <span class="pkg">vegan</span> function
<code><a href="vegan.html#topic+scores">scores</a></code> knows: any ordination result in
<span class="pkg">vegan</span> and many others. </p>
</td></tr>
<tr><td><code id="ordilattice3d_+3A_data">data</code></td>
<td>
<p> Optional data to amend ordination results. The ordination
results are found from <code>x</code>, but you may give here data for other
variables needed in plots. Typically these are environmental data.</p>
</td></tr>
<tr><td><code id="ordilattice3d_+3A_formula">formula</code></td>
<td>
<p> Formula to define the plots. A default formula will be
used if this is omitted. The
ordination axes must be called by the same names as in the
ordination results (and these names vary among methods).</p>
</td></tr>
<tr><td><code id="ordilattice3d_+3A_display">display</code></td>
<td>
<p> The kind of scores: an argument passed to
<code><a href="vegan.html#topic+scores">scores</a></code>. </p>
</td></tr>
<tr><td><code id="ordilattice3d_+3A_choices">choices</code></td>
<td>
<p> The axes selected: an argument passed to
<code><a href="vegan.html#topic+scores">scores</a></code>. </p>
</td></tr>
<tr><td><code id="ordilattice3d_+3A_panel">panel</code>, <code id="ordilattice3d_+3A_prepanel">prepanel</code></td>
<td>
<p> The names of the panel and prepanel
functions. </p>
</td></tr>
<tr><td><code id="ordilattice3d_+3A_...">...</code></td>
<td>
<p> Arguments passed to <code><a href="vegan.html#topic+scores">scores</a></code> methods or
<span class="pkg">lattice</span> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions provide an interface to the <span class="pkg">lattice</span>
function <code><a href="lattice.html#topic+cloud">cloud</a></code>.
All graphical parameters are passed to the <span class="pkg">lattice</span>
functions so that the graphs are configurable.
</p>
<p>The argument <code>x</code> must always be an ordination result. The
scores are extracted with <span class="pkg">vegan</span> function
<code><a href="vegan.html#topic+scores">scores</a></code> so that these functions work with all
<span class="pkg">vegan</span> ordinations and many others.
</p>
<p>The <code>formula</code> is used to define the models. Function has a
default formula which is used if <code>formula</code> is missing. The
formula must use the names of ordination scores and names of
<code>data</code>.
</p>
<p>The ordination scores are found from <code>x</code>, and <code>data</code> is
optional. The <code>data</code> should contain other variables than
ordination scores to be used in plots. Typically, they are
environmental variables (typically factors) to define panels or plot
symbols (<span class="pkg">lattice</span> argument <code>groups</code>).
</p>
<p>The proper work is done by the panel function. The layout can be
changed by defining own panel functions. See
<code><a href="lattice.html#topic+panel.cloud">panel.cloud</a></code> for details and survey of
possibilities.
</p>


<h3>Value</h3>

<p>The function return <code><a href="lattice.html#topic+Lattice">Lattice</a></code> objects of class
<code>"trellis"</code>.   
</p>


<h3>Note</h3>

<p>Function is still rudimentary. For instance, it cannot display
biplot arrows or factor centroids from constrained ordination or
<code><a href="vegan.html#topic+envfit">envfit</a></code>.
</p>


<h3>Author(s)</h3>

<p>Jari Oksanen </p>


<h3>See Also</h3>

<p>For functions used in <code>ordilattice3d</code> see
<code><a href="lattice.html#topic+Lattice">Lattice</a></code>, <code><a href="lattice.html#topic+cloud">cloud</a></code>,
<code><a href="lattice.html#topic+panel.cloud">panel.cloud</a></code>.  Function
<code><a href="#topic+ordiplot3d">ordiplot3d</a></code> provides a more mature and flexible
alternative which can also handle biplot arrows and factor centroids
and adding new graphical elements to the plots.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dune, dune.env)
ord &lt;- cca(dune)

ordilattice3d(ord, form = CA2 ~ CA3*CA1, groups = Manure, data = dune.env,
   scaling="sites")
ordilattice3d(ord, form = CA2 ~ CA3*CA1 | Management, groups = Manure,
   data = dune.env, auto.key = TRUE, type = c("p","h"), scaling = "sites")
</code></pre>

<hr>
<h2 id='ordiplot3d'>Three-Dimensional Ordination Graphics </h2><span id='topic+ordiplot3d'></span><span id='topic+scores.ordiplot3d'></span>

<h3>Description</h3>

<p>Function <code>ordiplot3d</code> displays three-dimensional ordination
graphics using <code><a href="scatterplot3d.html#topic+scatterplot3d">scatterplot3d</a></code>. Function
works with all ordination results form <a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a> and all ordination 
results known by <code><a href="vegan.html#topic+scores">scores</a></code> function. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ordiplot3d(object, display = "sites", choices = c(1,3,2), col = "black",
    ax.col = "red", arr.len = 0.1, arr.col = "blue", envfit,
    xlab, ylab, zlab, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ordiplot3d_+3A_object">object</code></td>
<td>
<p>An ordination result or any object known by 
<code><a href="vegan.html#topic+scores">scores</a></code>. </p>
</td></tr>
<tr><td><code id="ordiplot3d_+3A_display">display</code></td>
<td>
<p>Display <code>"sites"</code> or <code>"species"</code> or other
ordination object recognized by <code><a href="vegan.html#topic+scores">scores</a></code>. </p>
</td></tr>
<tr><td><code id="ordiplot3d_+3A_choices">choices</code></td>
<td>
<p>Selected three axes. First axis is horizontal, second
vertical and third is &ldquo;depth&rdquo;. The default will use axes 1
and 2 as front panel.</p>
</td></tr>
<tr><td><code id="ordiplot3d_+3A_col">col</code></td>
<td>
<p>Colours of points. Can be a vector, and factors are
interpreted as their internal numerical codes.</p>
</td></tr>
<tr><td><code id="ordiplot3d_+3A_ax.col">ax.col</code></td>
<td>
<p>Axis colour (concerns only the crossed axes through the
origin).</p>
</td></tr>
<tr><td><code id="ordiplot3d_+3A_arr.len">arr.len</code></td>
<td>
<p>'Length' (width) of arrow head passed to
<code><a href="graphics.html#topic+arrows">arrows</a></code> function. </p>
</td></tr>
<tr><td><code id="ordiplot3d_+3A_arr.col">arr.col</code></td>
<td>
<p>Colour of biplot <code><a href="graphics.html#topic+arrows">arrows</a></code> and centroids of
environmental variables. </p>
</td></tr>
<tr><td><code id="ordiplot3d_+3A_envfit">envfit</code></td>
<td>
<p>Fitted environmental variables from
<code><a href="vegan.html#topic+envfit">envfit</a></code> displayed in the graph.</p>
</td></tr>
<tr><td><code id="ordiplot3d_+3A_xlab">xlab</code>, <code id="ordiplot3d_+3A_ylab">ylab</code>, <code id="ordiplot3d_+3A_zlab">zlab</code></td>
<td>
<p>Axis labels passed to
<code><a href="scatterplot3d.html#topic+scatterplot3d">scatterplot3d</a></code>. If missing, labels  are
taken from the
ordination result. Set to <code>NA</code> to suppress labels. </p>
</td></tr>
<tr><td><code id="ordiplot3d_+3A_...">...</code></td>
<td>
<p>Other parameters passed to graphical functions. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>ordiplot3d</code> plots static three-dimensional scatter
diagrams using <code><a href="scatterplot3d.html#topic+scatterplot3d">scatterplot3d</a></code>.  Function
uses most default settings of underlying graphical functions, and
you must consult their help pages to change graphics to suit your
taste (see <code><a href="scatterplot3d.html#topic+scatterplot3d">scatterplot3d</a></code>).
</p>
<p>Function returns invisibly an object of class <code>ordiplot3d</code>
which inherits from <code><a href="vegan.html#topic+ordiplot">ordiplot</a></code>. The result object
contains the projected coordinates of plotted items and functions to
convert 3D data to 2D (see
<code><a href="scatterplot3d.html#topic+scatterplot3d">scatterplot3d</a></code>). Function will display
only one selected set of <code><a href="vegan.html#topic+scores">scores</a></code>, typically
either <code>"sites"</code> or <code>"species"</code>. Examples show how to use
the invisible return object to add another set of points to the
projected plot.
</p>
<p>In constrained ordination (<code><a href="vegan.html#topic+cca">cca</a></code>,
<code><a href="vegan.html#topic+rda">rda</a></code>, <code><a href="vegan.html#topic+capscale">capscale</a></code>), biplot
arrows and centroids are always displayed similarly as in
two-dimensional plotting function <code><a href="vegan.html#topic+plot.cca">plot.cca</a></code>.
Alternatively, it is possible to display fitted environmental
vectors or class centroids from <code><a href="vegan.html#topic+envfit">envfit</a></code>.  These
are displayed similarly as the results of constrained ordination,
and they can be shown only for non-constrained ordination. The user
must remember to specify at least three axes in
<code><a href="vegan.html#topic+envfit">envfit</a></code> if the results are used with these
functions.
</p>
<p>The function has a <code>scores</code> method to extract the projected
coordinates from the invisible return object. Standard <a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a>
functions can be used with the returned object.  You can use any
function from the <code><a href="vegan.html#topic+ordihull">ordihull</a></code> and
<code><a href="vegan.html#topic+ordiarrows">ordiarrows</a></code> families (see Examples).
</p>


<h3>Value</h3>

<p>Function <code>ordiplot3d</code> returns invisibly an object of class
<code>"ordiplot3d"</code> inheriting from <code><a href="vegan.html#topic+ordiplot">ordiplot</a></code>.
The return object will contain the coordinates projected onto two
dimensions for <code>points</code>, and the projected coordinates of
<code>origin</code>, and possibly the projected coordinates of the heads
of <code>arrows</code> and <code>centroids</code> of environmental variables.
The result will also contain the object returned by
<code><a href="scatterplot3d.html#topic+scatterplot3d">scatterplot3d</a></code>, including function
<code>xyz.convert</code> which projects three-dimensional coordinates onto
the plane used in the current plot (see Examples). In addition,
there is a function <code>envfit.convert</code> that projects a
three-dimensional <code><a href="vegan.html#topic+envfit">envfit</a></code> object to the current plot.
</p>


<h3>Warning</h3>

<p>Please note that <code><a href="scatterplot3d.html#topic+scatterplot3d">scatterplot3d</a></code> sets
internally some graphical parameters (such as <code>mar</code> for margins)
and does not honour default settings.  It is advisable to study
carefully the documentation and examples of
<code><a href="scatterplot3d.html#topic+scatterplot3d">scatterplot3d</a></code>.
</p>


<h3>Author(s)</h3>

<p>Jari Oksanen </p>


<h3>See Also</h3>

 <p><code><a href="scatterplot3d.html#topic+scatterplot3d">scatterplot3d</a></code>,
<code><a href="vegan.html#topic+ordiplot">ordiplot</a></code>, <code><a href="vegan.html#topic+ordiarrows">ordiarrows</a></code>,
<code><a href="vegan.html#topic+ordihull">ordihull</a></code>. Function <code><a href="#topic+ordilattice3d">ordilattice3d</a></code>
provides an alternative based on <span class="pkg">lattice</span> package. However, it
not yet quite matured and cannot display biplot (or fitted) arrows
and factor centroids. Currently, its main advantage is that it can
split plots in different panels by external variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Default 'ordiplot3d'
data(dune, dune.env)
ord &lt;- cca(dune ~ A1 + Moisture, dune.env)
ordiplot3d(ord, scaling = "sites")
### A boxed 'pin' version
ordiplot3d(ord, scaling = "sites", type = "h")
### More user control
pl &lt;- ordiplot3d(ord, scaling = "symmetric", angle=15, type="n")
points(pl, "points", pch=16, col="red", cex = 0.7)
### identify(pl, "arrows", col="blue") would put labels in better positions
text(pl, "arrows", col="blue", pos=3)
text(pl, "centroids", col="blue", pos=1, cex = 1)
### Add species using xyz.convert function returned by ordiplot3d
sp &lt;- scores(ord, choices=1:3, display="species", scaling="symmetric")
text(pl$xyz.convert(sp), rownames(sp), cex=0.7, xpd=TRUE)
### Two ways of adding fitted variables to ordination plots
ord &lt;- cca(dune)
ef &lt;- envfit(ord ~ Moisture + A1, dune.env, choices = 1:3)
### 1. use argument 'envfit'
ordiplot3d(ord, envfit = ef)
### 2. use returned envfit.convert function for better user control
pl3 &lt;- ordiplot3d(ord, scaling = "sites")
plot(pl3$envfit.convert(ef), at = pl3$origin)
### envfit.convert() also handles different 'choices' of axes
pl3 &lt;- ordiplot3d(ord, choices = c(1,3,2))
plot(pl3$envfit.convert(ef), at = pl3$origin)
### vegan::ordiXXXX functions can add items to the plot
ord &lt;- cca(dune)
pl4 &lt;- with(dune.env, ordiplot3d(ord, scaling = "sites", col = Management, pch=16))
with(dune.env, ordiellipse(pl4, Management, draw = "poly", col = 1:4,
  alpha = 60))
with(dune.env, ordispider(pl4, Management, col = 1:4, label = TRUE))
</code></pre>

<hr>
<h2 id='ordirgl'>Three-Dimensional Dynamic Ordination Graphics </h2><span id='topic+ordirgl'></span><span id='topic+orglellipse'></span><span id='topic+orglpoints'></span><span id='topic+orgltext'></span><span id='topic+orglsegments'></span><span id='topic+orglspider'></span><span id='topic+orglspantree'></span><span id='topic+orglcluster'></span>

<h3>Description</h3>

<p>Function <code>ordirgl</code> displays three-dimensional dynamic
ordination graphs which can be rotated and zoomed. This function
works with all ordination results from <code>vegan</code> and all
ordination results known by the <code><a href="vegan.html#topic+scores">scores</a></code> function. The
<code>orgl</code>-prefixed functions add elements to the <code>ordirgl</code>
graph similarly as <code>ordi</code>-prefixed functions in <a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ordirgl(object, display = "sites", choices = 1:3, type = "p", col = "black",
    ax.col = "red", arr.col = "yellow", radius, text, envfit, ...)
orglpoints(object, display = "sites", choices = 1:3, radius, col = "black", ...)
orgltext(object, text, display = "sites", choices = 1:3, adj = 0.5,
    col = "black", ...)
orglsegments(object, groups, order.by, display = "sites", choices = 1:3,
    col = "black", ...)
orglspider(object, groups, display = "sites", w = weights(object, display),
    choices = 1:3, col = "black", ...)
orglellipse(object, groups, display = "sites", w = weights(object, display),
    kind = c("sd", "se", "ehull"), conf, choices = 1:3, alpha = 0.3,
    col = "red", ...)
orglspantree(object, spantree, display = "sites", choices = 1:3,
    col = "black", ...)
orglcluster(object, cluster, prune = 0, display = "sites", choices = 1:3,
    col = "black", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ordirgl_+3A_object">object</code></td>
<td>
<p>An ordination result or any object known by
<code><a href="vegan.html#topic+scores">scores</a></code>. </p>
</td></tr>
<tr><td><code id="ordirgl_+3A_display">display</code></td>
<td>
<p>Display <code>"sites"</code> or <code>"species"</code> or other
ordination object recognized by <code><a href="vegan.html#topic+scores">scores</a></code>. </p>
</td></tr>
<tr><td><code id="ordirgl_+3A_choices">choices</code></td>
<td>
<p>Selected three axes. </p>
</td></tr>
<tr><td><code id="ordirgl_+3A_type">type</code></td>
<td>
<p>The type of plots: <code>"p"</code> for points or <code>"t"</code> for
text labels.</p>
</td></tr>
<tr><td><code id="ordirgl_+3A_ax.col">ax.col</code></td>
<td>
<p>Axis colour (concerns only the crossed axes through the
origin).</p>
</td></tr>
<tr><td><code id="ordirgl_+3A_arr.col">arr.col</code></td>
<td>
<p>Colour of biplot <code><a href="graphics.html#topic+arrows">arrows</a></code> and centroids of
environmental variables. </p>
</td></tr>
<tr><td><code id="ordirgl_+3A_radius">radius</code></td>
<td>
<p>Size of points in the units of ordination scores.</p>
</td></tr>
<tr><td><code id="ordirgl_+3A_text">text</code></td>
<td>
<p>Text to override the default with <code>type = "t"</code>.</p>
</td></tr>
<tr><td><code id="ordirgl_+3A_envfit">envfit</code></td>
<td>
<p>Fitted environmental variables from <code><a href="vegan.html#topic+envfit">envfit</a></code>
displayed in the graph. Use <code>envfit = NA</code> to suppress display
of environmental variables in constrained ordination.</p>
</td></tr>
<tr><td><code id="ordirgl_+3A_adj">adj</code></td>
<td>
<p>Text justification passed to <code><a href="rgl.html#topic+text3d">text3d</a></code>.</p>
</td></tr>
<tr><td><code id="ordirgl_+3A_groups">groups</code></td>
<td>
<p>Factor giving the groups for which the graphical item is
drawn.</p>
</td></tr>
<tr><td><code id="ordirgl_+3A_order.by">order.by</code></td>
<td>
<p>Order points by this variable within <code>groups</code>.</p>
</td></tr>
<tr><td><code id="ordirgl_+3A_w">w</code></td>
<td>
<p>Weights used to find the average within group. Weights are
used automatically for <code><a href="vegan.html#topic+cca">cca</a></code>,
and <code><a href="vegan.html#topic+decorana">decorana</a></code> results, unless undone by the
user. <code>w=NULL</code> sets equal weights to all points. </p>
</td></tr>
<tr><td><code id="ordirgl_+3A_kind">kind</code></td>
<td>
<p>Draw ellipse for standard deviations of points
(<code>"sd"</code>) or standard deviations of their averages
(<code>"se"</code>) or an ellipsoid hull enclosing all points in the
group (<code>"ehull"</code>.</p>
</td></tr>
<tr><td><code id="ordirgl_+3A_conf">conf</code></td>
<td>
<p>Confidence limit for ellipses, e.g., 0.95. If not given,
sd or se ellipses are drawn.</p>
</td></tr>
<tr><td><code id="ordirgl_+3A_col">col</code></td>
<td>
<p>Colour of items. This can be a vector and factors are
interpreted as their internal numerical values. If the function
has a <code>groups</code> argument, vector <code>col</code> is used for each
of these, and for other functions it is matched to points in
<code>ordirgl</code> (see Details below).</p>
</td></tr>
<tr><td><code id="ordirgl_+3A_alpha">alpha</code></td>
<td>
<p>Transparency of colour between 0.0 (fully transparent)
and 1.0 (non-transparent).</p>
</td></tr>
<tr><td><code id="ordirgl_+3A_spantree">spantree</code></td>
<td>
<p>A minimum spanning tree object from <a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a>
<code><a href="vegan.html#topic+spantree">spantree</a></code>.</p>
</td></tr>
<tr><td><code id="ordirgl_+3A_cluster">cluster</code></td>
<td>
<p>Result of hierarchic cluster analysis, such as
<code><a href="stats.html#topic+hclust">hclust</a></code> or <code><a href="cluster.html#topic+agnes">agnes</a></code>.</p>
</td></tr>
<tr><td><code id="ordirgl_+3A_prune">prune</code></td>
<td>
<p>Number of upper levels hierarchies removed from the
tree. If <code>prune</code> &gt; 0, tree will be cut into <code>prune + 1</code>
disconnected trees.</p>
</td></tr>
<tr><td><code id="ordirgl_+3A_...">...</code></td>
<td>
<p>Other parameters passed to graphical functions. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>ordirgl</code> plots dynamic graphics using OpenGL with the
<code><a href="rgl.html#topic+rgl">rgl</a></code> package. It clears the graphics device and
starts a new plot. The function was designed for ordination methods
in the <a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a> package, but it can handle any method known to
<a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a> <code><a href="vegan.html#topic+scores">scores</a></code> function, or to any three
column matrix. The <code>orgl</code>-prefixed functions add items to the
opened <a href="https://CRAN.R-project.org/package=rgl"><span class="pkg">rgl</span></a> graphics device.
</p>
<p>Function <code>ordirgl</code> uses most default settings of underlying
graphical functions in <code>rgl</code>. It plots only one set of points,
but functions <code>orglpoints</code> and <code>orgltext</code> can add new
items to an existing plot. The points are plotted using
<code><a href="rgl.html#topic+spheres3d">spheres3d</a></code> and the text using
<code><a href="rgl.html#topic+texts3d">texts3d</a></code> which both have their own configuration
switches and their general look and feel can be modified with
<code><a href="rgl.html#topic+material3d">material3d</a></code>. The point size is directly defined
by <code>radius</code> argument in the units of ordination scores in
<code><a href="rgl.html#topic+spheres3d">spheres3d</a></code>, but <code>ordirgl</code> uses a default
size of 1% of the length of the longest axis, and this can be
further modified by the <code>cex</code> multiplier.
</p>
<p>In constrained ordination (<code><a href="vegan.html#topic+cca">cca</a></code>,
<code><a href="vegan.html#topic+rda">rda</a></code>, <code><a href="vegan.html#topic+capscale">capscale</a></code>), biplot
arrows and centroids are always displayed similarly as in
two-dimensional plotting function <code><a href="vegan.html#topic+plot.cca">plot.cca</a></code>.
Alternatively, it is possible to display fitted environmental
vectors or class centroids from <code><a href="vegan.html#topic+envfit">envfit</a></code> in both
graphs.  These are displayed similarly as the results of constrained
ordination, and they can be shown only for non-constrained
ordination. The user must remember to specify at least three axes in
<code><a href="vegan.html#topic+envfit">envfit</a></code> if the results are used with these
functions.
</p>
<p>Function <code>orglsegments</code> is similar to <a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a>
<code><a href="vegan.html#topic+ordisegments">ordisegments</a></code> and connects points by line
segments. This can be useful for regular transects. The colour of
segments can be a vector which corresponds to the <code>groups</code> and
will be recycled.
</p>
<p>Function <code>orglspider</code> is similar as <a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a>
<code><a href="vegan.html#topic+ordispider">ordispider</a></code>: it connects points to their
weighted centroid within <code>"groups"</code>, and in constrained
ordination it can connect <code>"wa"</code> or weighted averages scores to
corresponding <code>"lc"</code> or linear combination scores if
<code>"groups"</code> is missing.  Function <code>orglellipse</code> is similar
as <a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a> <code><a href="vegan.html#topic+ordiellipse">ordiellipse</a></code> and draws ellipsoids
of standard deviance, standard error or confidence regions for
<code>groups</code>. At least four points are needed to define an
ellipsoid in 3D, and even these will fail if all points are strictly
on 2D. The <code>col</code> argument for both of these functions can be a
vector corresponding to the <code>groups</code>.
</p>
<p>Function <code>orglspantree</code> adds a minimum spanning tree from
<a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a> <code><a href="vegan.html#topic+spantree">spantree</a></code>. This a 3D equivalent of
<code><a href="vegan.html#topic+lines.spantree">lines.spantree</a></code>.  Function <code>orglcluster</code>
adds a hierarchic cluster tree from <code><a href="stats.html#topic+hclust">hclust</a></code> or related
functions. This is a 3D equivalent of
<code><a href="vegan.html#topic+ordicluster">ordicluster</a></code>. The <code>col</code> argument for both
of these functions can be a vector corresponding to the connected
points. In <code>orglspantree</code> the line colour is a mixture of
colours of joined points, and in <code>orglcluster</code> it is a mixture
of all points in the cluster.
</p>


<h3>Value</h3>

<p>Function <code>ordirgl</code> returns nothing.
</p>


<h3>Warning</h3>

<p>Function <code>ordirgl</code> uses OpenGL package <code><a href="rgl.html#topic+rgl">rgl</a></code>
which may not be functional in all platforms.
</p>


<h3>Author(s)</h3>

<p>Jari Oksanen </p>


<h3>See Also</h3>

<p><code><a href="rgl.html#topic+rgl">rgl</a></code>, <code><a href="rgl.html#topic+spheres3d">spheres3d</a></code>,
<code><a href="rgl.html#topic+text3d">text3d</a></code>, <code><a href="rgl.html#topic+rgl.viewpoint">rgl.viewpoint</a></code>,
<code><a href="vegan.html#topic+envfit">envfit</a></code>. These are 3D dynamic variants of
<a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a> functions <code><a href="vegan.html#topic+ordiplot">ordiplot</a></code>,
<code><a href="vegan.html#topic+ordisegments">ordisegments</a></code>, <code><a href="vegan.html#topic+ordispider">ordispider</a></code>
and <code><a href="vegan.html#topic+ordiellipse">ordiellipse</a></code>,
<code><a href="vegan.html#topic+ordicluster">ordicluster</a></code> and
<code><a href="vegan.html#topic+lines.spantree">lines.spantree</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (interactive() &amp;&amp; require(rgl, quietly = TRUE)) {
data(mite, mite.env)
ord &lt;- rda(decostand(mite, "hellinger"))
ordirgl(ord, size=4, col = "yellow")
orgltext(ord, display = "species")
## show groups of Shrub abundance
## ordirgl: col by points
with(mite.env, ordirgl(ord, col = as.numeric(Shrub), scaling = "sites"))
## orglspider &amp; orglellipse: col by groups
with(mite.env, orglspider(ord, Shrub, col = 1:3, scaling = "sites"))
with(mite.env, orglellipse(ord, Shrub, col = 1:3, kind = "se", conf = 0.95,
    scaling = "sites"))
}
</code></pre>

<hr>
<h2 id='orditkplot'> Ordination Plot with Movable Labels </h2><span id='topic+orditkplot'></span><span id='topic+plot.orditkplot'></span><span id='topic+scores.orditkplot'></span><span id='topic+points.orditkplot'></span><span id='topic+text.orditkplot'></span>

<h3>Description</h3>

<p>Function <code>orditkplot</code> produces an editable ordination plot with
points and labels. The labels can be moved with mouse, and the edited
plot can be saved as an encapsulated postscript file or exported via <span class="rlang"><b>R</b></span> 
<code>plot</code> function to other graphical formats, or saved in the <span class="rlang"><b>R</b></span> session 
for further processing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orditkplot(x, display = "species", choices = 1:2, width, xlim, ylim, 
   tcex = 0.8, tcol, pch = 1,  pcol, pbg, pcex = 0.7, labels,  ...)
## S3 method for class 'orditkplot'
plot(x, ...)
## S3 method for class 'orditkplot'
points(x, pch = x$args$pch, cex = x$args$pcex,
       col = x$args$pcol, bg = x$args$pbg, ...)
## S3 method for class 'orditkplot'
text(x, cex = x$args$tcex, col = x$args$tcol,
     font = attr(x$labels, "font"), ...)
## S3 method for class 'orditkplot'
scores(x, display, ...)
</code></pre>


<h3>Arguments</h3>

 
<table role = "presentation">
<tr><td><code id="orditkplot_+3A_x">x</code></td>
<td>
<p>An ordination result or any other object that
<code>scores</code> can handle, or for the <code>plot</code> function the
object dumped from the interactive <code>orditkplot</code> session.</p>
</td></tr>
<tr><td><code id="orditkplot_+3A_display">display</code></td>
<td>
<p>Type of <code>scores</code> displayed. For ordination
scores this typically is either <code>"species"</code> or <code>"sites"</code>,
and for <code>orditkplot</code> result it is either <code>"points"</code> or
<code>"labels"</code>.</p>
</td></tr>
<tr><td><code id="orditkplot_+3A_choices">choices</code></td>
<td>
<p>Axes displayed.</p>
</td></tr>
<tr><td><code id="orditkplot_+3A_width">width</code></td>
<td>
<p>Width of the plot in inches; defaults to the current
width of the graphical device. </p>
</td></tr>
<tr><td><code id="orditkplot_+3A_xlim">xlim</code>, <code id="orditkplot_+3A_ylim">ylim</code></td>
<td>
<p>x and y limits for plots: points outside these
limits will be completely removed.</p>
</td></tr>
<tr><td><code id="orditkplot_+3A_tcex">tcex</code></td>
<td>
<p>Character expansion for text labels.</p>
</td></tr>
<tr><td><code id="orditkplot_+3A_tcol">tcol</code></td>
<td>
<p>Colour of text labels.</p>
</td></tr>
<tr><td><code id="orditkplot_+3A_pch">pch</code>, <code id="orditkplot_+3A_pcol">pcol</code>, <code id="orditkplot_+3A_pbg">pbg</code></td>
<td>
<p>Point type and outline and fill colours. 
Defaults <code>pcol="black"</code>  and <code>pbg="transparent"</code>. 
Argument <code>pbg</code> has an effect only in filled plotting characters
<code>pch = 21</code> to <code>25</code>.</p>
</td></tr> 
<tr><td><code id="orditkplot_+3A_pcex">pcex</code></td>
<td>
<p>Expansion factor for point size.</p>
</td></tr>  
<tr><td><code id="orditkplot_+3A_labels">labels</code></td>
<td>
<p>Labels used instead of row names.</p>
</td></tr>
<tr><td><code id="orditkplot_+3A_cex">cex</code>, <code id="orditkplot_+3A_col">col</code>, <code id="orditkplot_+3A_bg">bg</code>, <code id="orditkplot_+3A_font">font</code></td>
<td>
<p>graphical parameters used in the
<code>points</code> and <code>text</code> methods. See <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="orditkplot_+3A_...">...</code></td>
<td>
<p>Other arguments passed to the function. These can be
graphical parameters (see <code><a href="graphics.html#topic+par">par</a></code>) used in the plot, or
extra arguments to <code>scores</code>. These arguments are
ignored in <code>plot</code>, but honoured in <code>text</code> and <code>points</code>. </p>
</td></tr>  
</table>


<h3>Details</h3>

<p> Function <code>orditkplot</code> uses <span class="pkg">tcltk</span> package to draw
Tcl/Tk based ordination graphics with points and labels. The function
opens an editable canvas with fixed points, but the labels can be
dragged with mouse to better positions or edited. In addition, it is
possible to zoom to a part of the graph.
</p>
<p>The function knows the following mouse operations:
</p>

<ul>
<li> <p><strong>Left mouse button</strong> can be used to move labels to better
positions. A line will connect a label to the corresponding point.
</p>
</li>
<li> <p><strong>Double clicking left mouse button</strong> opens a window where the
label can be edited. After editing the label, hit the Return key.
</p>
</li>
<li> <p><strong>Right mouse button</strong> (or alternatively, Shift-Mouse button with
one-button mouse) can be used for zooming to a part of the
graph. Keeping the mouse button down and dragging will draw a box
of the zoomed area, and after releasing the button, a new plot window
will be created (this is still preliminary: all arguments are not
passed to the new plot).
</p>
</li></ul>

<p>In addition there are buttons for the following tasks: <strong>Copy
to EPS</strong> copies the current plot to an encapsulated postscript (eps)
file using standard Tcl/Tk utilities. The faithfulness of this copy
is system dependent. Button <strong>Export plot</strong> uses
<code>plot.orditkplot</code> function to redraw the plot into graphical
file formats. Depending on the system, the following graphical
formats may be available: eps, pdf, svg, png, jpeg, tiff, bmp or
xfig. Some of the output formats may be edited with external
software: svg files with Illustrator or Inkscape, and xfig with the
legacy program XFig. Button <strong>Save to R</strong> writes the edited
coordinates of labels and points to the <span class="rlang"><b>R</b></span> session for further
processing, and the <code>plot.orditkplot</code> function can be used to
display the results. For faithful replication of the plot, the graph
must have similar dimensions as the <code>orditkplot</code> canvas had
originally. The <code>plot</code> function cannot be configured, but it
uses the same settings as the original Tcl/Tk plot. However,
<code>points</code> and <code>text</code> functions are fully configurable, but
use the stored defaults for consistency with <code>plot.orditkplot</code>
if none are supplied. Finally, button <strong>Close</strong> closes the
window.
</p>
<p>The produced plot will have equal aspect ratio. The width of the
horizontal axis is fixed, but vertical axes will be scaled to needed
height, and you can use scrollbar to move vertically if the whole
canvas does not fit the window. If you use dumped labels in ordinary
<span class="rlang"><b>R</b></span> plots, your plot must have the same dimensions as the
<code>orditkplot</code> canvas to have identical location of the labels.
</p>
<p>The function only displays one set of scores. However, you can use
<code><a href="vegan.html#topic+ordipointlabel">ordipointlabel</a></code> (<a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a>) to produce a
result object that has different points and text types for several
sets of scores and this can be further edited with
<code>orditkplot</code>. For a good starting solution you need to scale
the <code><a href="vegan.html#topic+ordipointlabel">ordipointlabel</a></code> result so that the points
span over the whole horizontal axis. The function cannot show
environmental variables or constraints, but it is limited to
unconstrained ordination.
</p>
<p>The plot is a Tcl/Tk canvas, but the function tries to replicate
standard graphical device of the platform, and it honours several
graphical parameters (see <code><a href="graphics.html#topic+par">par</a></code>).  Many of the graphical
parameters can be given on the command line, and they will be passed
to the function without influencing other graphical devices in <span class="rlang"><b>R</b></span>.
At the moment, the
following graphical parameters are honoured: 
<code>pch</code> <code>bg</code>,  <code>cex</code>,
<code>cex.axis</code>, <code>cex.lab</code>, <code>col</code> (for labels),
<code>col.axis</code>, <code>col.lab</code>, <code>family</code> (for font faces),
<code>fg</code>, <code>font</code>, <code>font.axis</code>, <code>font.lab</code>,
<code>lheight</code>, <code>lwd</code> (for the box), <code>mar</code>, <code>mex</code>,
<code>mgp</code>, <code>ps</code>, <code>tcl</code>. These can be set with
<code><a href="graphics.html#topic+par">par</a></code>, and they also will influence other plots similarly.
</p>
<p>The <code><a href="tcltk.html#topic+tkcanvas">tkcanvas</a></code> text cannot be rotated, and
therefore vertical axis is not labelled, and <code>las</code>
<code><a href="graphics.html#topic+par">par</a></code>ameter will not be honoured in the Tcl/Tk plot, but
it will be honoured in the exported <span class="rlang"><b>R</b></span> plots and in
<code>plot.orditkplot</code>.  </p>


<h3>Value</h3>

<p> Function returns nothing useful directly, but you can save the
edited graph to a file or save the edited positions to an <span class="rlang"><b>R</b></span> session
for further processing and plotting.  
</p>


<h3>Note</h3>

<p>You need <span class="pkg">tcltk</span> package and <span class="rlang"><b>R</b></span> must have been configured with
<code><a href="base.html#topic+capabilities">capabilities</a></code> for <code>tcltk</code>.
Depending on your OS, you may need to start X11 and set the display
before loading <span class="pkg">tcltk</span> and starting the function (for instance,
with <code>Sys.setenv("DISPLAY"=":0")</code>). See
<code><a href="tcltk.html#topic+tcltk-package">tcltk-package</a></code>. 
</p>


<h3>Author(s)</h3>

<p> Jari Oksanen </p>


<h3>See Also</h3>

<p> Function <code><a href="vegan.html#topic+ordipointlabel">ordipointlabel</a></code> is an automatic
procedure with similar goals of avoiding overplotting, and its
output can be edited with <code>orditkplot</code>.  See
<code><a href="vegan.html#topic+ordiplot">ordiplot</a></code>, <code><a href="vegan.html#topic+plot.cca">plot.cca</a></code>,
and <code><a href="vegan.html#topic+orditorp">orditorp</a></code> for
alternative ordination plots. </p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive() &amp;&amp; capabilities("tcltk")) {
data(varespec)
ord &lt;- cca(varespec)
## Do something with the graph and end by clicking "Dismiss"
orditkplot(ord, mar = c(4,4,1,1)+.1, font=3)
## Use ordipointlabel to produce a plot that has both species and site
## scores in different colors and plotting symbols
pl &lt;- ordipointlabel(ord)
orditkplot(pl)
}
</code></pre>

<hr>
<h2 id='orditree3d'>
Draw Cluster Tree over a Plane
</h2><span id='topic+orditree3d'></span><span id='topic+ordirgltree'></span>

<h3>Description</h3>

<p>Function draws a 3D plot where ordination result is at the bottom
plane and a <code><a href="stats.html#topic+hclust">hclust</a></code> dendrogram is drawn above the
plane.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orditree3d(ord, cluster, prune = 0, display = "sites", choices = c(1, 2),
    col = "blue", text, type = "p", ...)
ordirgltree(ord, cluster, prune = 0, display = "sites", choices = c(1, 2),
    col = "blue", text, type = "p", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orditree3d_+3A_ord">ord</code></td>
<td>
<p>An ordination object or an <code><a href="vegan.html#topic+ordiplot">ordiplot</a></code>
object or any other structure defining a 2D plane.</p>
</td></tr>
<tr><td><code id="orditree3d_+3A_cluster">cluster</code></td>
<td>
<p>Result of hierarchic cluster analysis, such as
<code><a href="stats.html#topic+hclust">hclust</a></code> or <code><a href="cluster.html#topic+agnes">agnes</a></code> or any other
clutering that can be coerced to a compliant format by
<code><a href="stats.html#topic+as.hclust">as.hclust</a></code>.</p>
</td></tr>
<tr><td><code id="orditree3d_+3A_prune">prune</code></td>
<td>
<p>Number of upper levels hierarchies removed from the
tree. If <code>prune</code> &gt; 0, tree will be cut into <code>prune + 1</code>
disconnected trees.</p>
</td></tr>
<tr><td><code id="orditree3d_+3A_choices">choices</code></td>
<td>

<p>Choice of ordination axes.</p>
</td></tr>
<tr><td><code id="orditree3d_+3A_display">display</code></td>
<td>

<p>Ordination scores displayed.</p>
</td></tr>
<tr><td><code id="orditree3d_+3A_col">col</code></td>
<td>
<p>Colour of tree. The colour can be a vector and it is used
for the points, text and terminal branches. The colour of internal
branches is a mixture of connected leaves.</p>
</td></tr>
<tr><td><code id="orditree3d_+3A_text">text</code></td>
<td>
<p>Text to replace the default of item labels when
<code>type = "t"</code>. </p>
</td></tr>
<tr><td><code id="orditree3d_+3A_type">type</code></td>
<td>
<p>Display of leaves: <code>"p"</code> for points, <code>"t"</code> for
text, and <code>"n"</code> for no display.</p>
</td></tr>
<tr><td><code id="orditree3d_+3A_...">...</code></td>
<td>
<p> Arguments passed to <code><a href="vegan.html#topic+scores">scores</a></code> and
graphical functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>orditree3d</code> uses <a href="https://CRAN.R-project.org/package=scatterplot3d"><span class="pkg">scatterplot3d</span></a> package to draw a static
3D plot of the dendrogram over the ordination, and
<code>ordirgltree</code> uses <a href="https://CRAN.R-project.org/package=rgl"><span class="pkg">rgl</span></a> to make a dynamic, spinnable plot.
The functions were developed to plot a cluster dendrogram over a 2D
ordination plane, but any other plane can be used, for instance, a
map.
</p>


<h3>Value</h3>

<p>Function <code>orditree3d</code> returns invisibly a
<code><a href="scatterplot3d.html#topic+scatterplot3d">scatterplot3d</a></code> result object amended
with items <code>points</code> and <code>internal</code> that give the projected
coordinates of ordination scores and internal nodes, and
<code>col.points</code> and <code>col.internal</code> that give their
colours. All matrix-like objects can be accessed with
<code>scores</code>.
</p>
<p>Function <code>ordirgltree</code> returns nothing.
</p>


<h3>Author(s)</h3>

<p>Jari Oksanen.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+orglcluster">orglcluster</a></code> and <code><a href="vegan.html#topic+ordicluster">ordicluster</a></code> (in
<a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(dune, dune.env)
  d &lt;- vegdist(dune)
  m &lt;- metaMDS(d, trace = FALSE)
  cl &lt;- hclust(d, "aver")
  orditree3d(m, cl, pch=16, col=cutree(cl, 3))
  ## ordirgltree makes ordinary rgl graphics. It accepts
  ## material3d() settings, and you can add elements to the
  ## open graph (for instance, bbox3d()).
  if (interactive() &amp;&amp; require(rgl, quietly = TRUE)) {
  with(dune.env, ordirgltree(m, cl, col = as.numeric(Management), size = 6,
     lwd = 2, alpha = 0.6))
  }
</code></pre>

<hr>
<h2 id='rgl.isomap'>
Dynamic 3D plot of isomap ordination.
</h2><span id='topic+rgl.isomap'></span>

<h3>Description</h3>

<p>Function displays a dynamic 3D plot from <code><a href="vegan.html#topic+isomap">isomap</a></code>
ordination. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rgl.isomap(x, web = "white", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rgl.isomap_+3A_x">x</code></td>
<td>
<p>Result from <code><a href="vegan.html#topic+isomap">isomap</a></code>.</p>
</td></tr>
<tr><td><code id="rgl.isomap_+3A_web">web</code></td>
<td>
<p>Colour of the web. If this is a vector matching the
number of points, the colour of links is a mixture of joined
points. <code>NA</code> skips drawing the web.</p>
</td></tr>
<tr><td><code id="rgl.isomap_+3A_...">...</code></td>
<td>
<p> Other parameters passed to <code><a href="#topic+ordirgl">ordirgl</a></code> and
<code><a href="vegan.html#topic+scores">scores</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>rgl.isomap</code> displays dynamic 3D plots that can be
rotated on the screen. The functions is based on
<code><a href="#topic+ordirgl">ordirgl</a></code>, but it adds the connecting lines. The
function passes extra arguments to <code><a href="vegan.html#topic+scores">scores</a></code> or
<code><a href="#topic+ordirgl">ordirgl</a></code> functions so that you can select axes, or
define colours and sizes of points.
</p>


<h3>Value</h3>

<p>Function returns nothing.
</p>


<h3>Note</h3>

<p>This is a support function for <code><a href="vegan.html#topic+isomap">isomap</a></code> ordination
in the <a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a> package. 
</p>


<h3>Author(s)</h3>

<p>Jari Oksanen.
</p>


<h3>See Also</h3>

<p><code><a href="vegan.html#topic+isomap">isomap</a></code>, <code><a href="#topic+ordirgl">ordirgl</a></code>, 
<code><a href="vegan.html#topic+scores">scores</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive() &amp;&amp; require(rgl, quietly = TRUE)) {
data(BCI)
dis &lt;- vegdist(BCI)
## colour points and links by the dominant species
dom &lt;- factor(make.cepnames(names(BCI))[apply(BCI, 1, which.max)])
ord &lt;- isomap(dis, k=3)
rgl.isomap(ord, col = as.numeric(dom), web = as.numeric(dom), lwd=2)
}
</code></pre>

<hr>
<h2 id='rgl.renyiaccum'>
Dynamic Perspective Plot of Renyi Diversity Accumulation
</h2><span id='topic+rgl.renyiaccum'></span>

<h3>Description</h3>

<p>Function <code>rgl.renyiaccum</code> displays a dynamic 3D plot of the result
of <code><a href="vegan.html#topic+renyiaccum">renyiaccum</a></code> function in the <a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a> 
package. Function <code><a href="vegan.html#topic+persp.renyiaccum">persp.renyiaccum</a></code> (in 
<a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a>) produces similar static plots. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rgl.renyiaccum(x, rgl.height = 0.2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rgl.renyiaccum_+3A_x">x</code></td>
<td>

<p>A <code><a href="vegan.html#topic+renyiaccum">renyiaccum</a></code> result.
</p>
</td></tr>
<tr><td><code id="rgl.renyiaccum_+3A_rgl.height">rgl.height</code></td>
<td>

<p>Vertical scaling of the plot.
</p>
</td></tr>
<tr><td><code id="rgl.renyiaccum_+3A_...">...</code></td>
<td>

<p>Other arguments passed to the function (ignored).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a graphical support function to <code><a href="vegan.html#topic+renyiaccum">renyiaccum</a></code>
in <a href="https://CRAN.R-project.org/package=vegan"><span class="pkg">vegan</span></a>. Similar static plots can be produced by 
<code><a href="vegan.html#topic+persp.renyiaccum">persp.renyiaccum</a></code>.
</p>


<h3>Value</h3>

<p>Function returns nothing.
</p>


<h3>Author(s)</h3>

<p>Roeland Kindt.
</p>


<h3>See Also</h3>

<p><code><a href="vegan.html#topic+renyiaccum">renyiaccum</a></code>, <code><a href="vegan.html#topic+persp.renyiaccum">persp.renyiaccum</a></code>,
<code><a href="rgl.html#topic+rgl">rgl</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive() &amp;&amp; require(rgl, quietly = TRUE)){
data(BCI)
mod &lt;- renyiaccum(BCI[1:12,])
persp(mod)
rgl.renyiaccum(mod)
}
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
