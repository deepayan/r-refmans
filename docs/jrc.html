<!DOCTYPE html><html><head><title>Help for package jrc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {jrc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#allowDirectories'><p>Allow server to access files in a directory</p></a></li>
<li><a href='#allowFunctions'><p>Allow function calls without authorization</p></a></li>
<li><a href='#allowVariables'><p>Allow variable assignment without authorization</p></a></li>
<li><a href='#App'><p>App class</p></a></li>
<li><a href='#authorize'><p>Authorize further message processing</p></a></li>
<li><a href='#callFunction'><p>Trigger a function call</p></a></li>
<li><a href='#closePage'><p>Stop server</p></a></li>
<li><a href='#closeSession'><p>Close one or several client sessions</p></a></li>
<li><a href='#getMessageIds'><p>Get IDs of all stored messages</p></a></li>
<li><a href='#getPage'><p>Get the currently running app</p></a></li>
<li><a href='#getPort'><p>Get number of the port on which the local server is running</p></a></li>
<li><a href='#getSession'><p>Get a session</p></a></li>
<li><a href='#getSessionIds'><p>Get IDs of all active sessions</p></a></li>
<li><a href='#getSessionVariable'><p>Get a variable from a client session environment</p></a></li>
<li><a href='#listen'><p>Listen to the server</p></a></li>
<li><a href='#openPage'><p>Create a server</p></a></li>
<li><a href='#removeMessage'><p>Removes a stored message</p></a></li>
<li><a href='#removeSessionVariables'><p>Remove variables from a client session environment</p></a></li>
<li><a href='#sendCommand'><p>Send a command to a web page</p></a></li>
<li><a href='#sendData'><p>Send data to a web page</p></a></li>
<li><a href='#sendHTML'><p>Send HTML to a web page</p></a></li>
<li><a href='#Session'><p>Session class</p></a></li>
<li><a href='#setEnvironment'><p>Set Environment</p></a></li>
<li><a href='#setLimits'><p>Set security limits</p></a></li>
<li><a href='#setSessionVariables'><p>Adds variables to a session environment</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Exchange Commands Between R and 'JavaScript'</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-22</td>
</tr>
<tr>
<td>Description:</td>
<td>An 'httpuv' based bridge between R and 'JavaScript'. Provides an easy way to exchange commands and data between a web page and a currently running R session. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>httpuv, jsonlite, utils, stringr, stringi, mime, R6, R.utils</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/anders-biostat/jrc">https://github.com/anders-biostat/jrc</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/anders-biostat/jrc/issues">https://github.com/anders-biostat/jrc/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-22 16:36:25 UTC; tyranchick</td>
</tr>
<tr>
<td>Author:</td>
<td>Svetlana Ovchinnikova [aut, cre],
  Simon Anders [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Svetlana Ovchinnikova &lt;s.ovchinnikova@zmbh.uni-heidelberg.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-23 13:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='allowDirectories'>Allow server to access files in a directory</h2><span id='topic+allowDirectories'></span>

<h3>Description</h3>

<p>This function adds paths to existing directories to the list of allowed directories,
which can be accessed from the server. To any request for files from outside
of the allowed directories the server will response with <code>403 Forbidden</code> error.
<code>rootDirectory</code> (see <code><a href="#topic+openPage">openPage</a></code>) can always be accessed. By default,
when the app is initialized, current working directory  
is added to the list of allowed directories. Further changes
of the working directory will not have any affect on this list or files accessibility.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>allowDirectories(dirs = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="allowDirectories_+3A_dirs">dirs</code></td>
<td>
<p>Vector of paths to existing directories. Can be absolute paths, or paths relative to 
the current working directory. If the specified directory doesn't exist, it will be ignored and a
warning will be produced. If <code>NULL</code>, returns absolute paths to all currently allowed directories.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a wrapper around <code>allowDirectories</code> method of class <code><a href="#topic+App">App</a></code>.
</p>


<h3>Value</h3>

<p>Absolute paths to all currently allowed directories, if <code>dirs = NULL</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+openPage">openPage</a></code> (check arguments <code>rootDirectory</code> and <code>allowedDirectories</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# to run this example an installed web browser is required
openPage()
# The directories must exist
allowDirectories(c("~/directory1", "../anotherDirectory"))
dirs &lt;- allowDirectories()
closePage()
## End(Not run)

</code></pre>

<hr>
<h2 id='allowFunctions'>Allow function calls without authorization</h2><span id='topic+allowFunctions'></span>

<h3>Description</h3>

<p>Adds R function names to the list of functions, that
can be called from a web page without manual confirmation on the R side.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>allowFunctions(funs = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="allowFunctions_+3A_funs">funs</code></td>
<td>
<p>Vector of function names to be added to the list. If <code>NULL</code>,
returns names of all currently allowed R functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a wrapper around <code>allowFunctions</code> method of class <code><a href="#topic+App">App</a></code>.
</p>


<h3>Value</h3>

<p>Names of all currently allowed functions if <code>funs = NULL</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+allowVariables">allowVariables</a></code>, <code><a href="#topic+authorize">authorize</a></code>, <code><a href="#topic+openPage">openPage</a></code> (check argument
<code>allowedFunctions</code>), <code><a href="#topic+callFunction">callFunction</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# to run this example an installed web browser is required
openPage()
allowFunctions(c("myFunction1", "print", "someObject$method"))
funs &lt;- allowFunctions()
closePage()
## End(Not run)

</code></pre>

<hr>
<h2 id='allowVariables'>Allow variable assignment without authorization</h2><span id='topic+allowVariables'></span>

<h3>Description</h3>

<p>This function adds variable names to the list of variables, that
can be modified from a web page without manual confirmation on the R side.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>allowVariables(vars = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="allowVariables_+3A_vars">vars</code></td>
<td>
<p>Vector of variable names to be added to the list. If <code>NULL</code>,
returns names of all currently allowed variables.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a wrapper around <code>allowVariables</code> method of class <code><a href="#topic+App">App</a></code>.
</p>


<h3>Value</h3>

<p>Names of all currently allowed variables if <code>vars = NULL</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+allowFunctions">allowFunctions</a></code>, <code><a href="#topic+authorize">authorize</a></code>, <code><a href="#topic+openPage">openPage</a></code> (check argument
<code>allowedVariables</code>), <code><a href="#topic+sendData">sendData</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# to run this example an installed web browser is required
openPage()
allowVariables(c("myVariable", "anotherOne"))
vars &lt;- allowVariables()
closePage()
## End(Not run)

</code></pre>

<hr>
<h2 id='App'>App class</h2><span id='topic+App'></span>

<h3>Description</h3>

<p>Object of this class represents the entire jrc-based app. It stores all the active connections,
client-specific variables and all the global app settings.
</p>
<p>You can create interactive apps by initializing
new instances of this class and manage the apps with the methods that are described below. There are no limitations
on the number of apps that can run simultaneously in one R session.
</p>
<p>A wrapper function is also exported for almost each method (see links in the Methods section). This functions allow
you to gain full control over the app without ever dealing with this class. However, in this case only a single app
can run per R session. Attempt to create a new app (with <code><a href="#topic+openPage">openPage</a></code> function) will force the existing one (if any)
to stop. You can always get the <code>App</code> object for the currently running app with <code><a href="#topic+getPage">getPage</a></code> function.
</p>


<h3>Methods</h3>


<dl>
<dt><code>new(rootDirectory = NULL, startPage = NULL, onStart = NULL, onClose = NULL,  
   connectionNumber = Inf, allowedFunctions = c(), allowedVariables = c(), sessionVars = NULL)</code></dt><dd>
<p>Creates a new instance of class <code>App</code>. Check <code><a href="#topic+openPage">openPage</a></code> man page for information about
arguments.
</p>
</dd>
<dt><code>startServer(port = NULL)</code></dt><dd>
<p>Starts a local server that listens to a given port. If <code>port = NULL</code>, picks a random available port.
See also <code><a href="#topic+openPage">openPage</a></code>.
</p>
</dd>
<dt><code>stopServer()</code></dt><dd>
<p>Closes all active sessions and stops a running server. See also <code><a href="#topic+closePage">closePage</a></code>.
</p>
</dd>
<dt><code>openPage(useViewer = TRUE, browser = NULL)</code></dt><dd>
<p>Opens a new web page either in a browser, or in the R Studio viewer. If <code>useViewer = FALSE</code> and browser is not selected,
a default installed browser is used. If browser is specified, <code>useViewer</code> is ignored. This method returns
a new <code><a href="#topic+Session">Session</a></code> object, which should correspond to the page that has been just opened. However, if someone would start
a new connection at the moment when <code>openPage</code> method is called, it may return a wrong session. See also <code><a href="#topic+openPage">openPage</a></code>.
</p>
</dd>
<dt><code>getSession(sessionId = NULL)</code></dt><dd>
<p>Returns a session with the given ID or <code>NULL</code> if session with this ID doesn't exist. If <code>sessionId = NULL</code>
and there is only one active session, returns it. See also <code><a href="#topic+getSession">getSession</a></code>.
</p>
</dd>
<dt><code>closeSession(sessionId = NULL, inactive = NULL, old = NULL)</code></dt><dd>
<p>Closes WebSocket connection of one or multiple sessions and removes all the related data from the app. For more information on 
the arguments, please, check <code><a href="#topic+closeSession">closeSession</a></code> man page.
</p>
</dd>
<dt><code>getSessionIds()</code></dt><dd>
<p>Returns IDs of all currently active sessions. See also <code><a href="#topic+getSessionIds">getSessionIds</a></code>.
</p>
</dd>
<dt><code>setEnvironment(envir)</code></dt><dd>
<p>Specifies the outer environment of the app, in which all the messages from the web pages will be evaluated. For more information,
please, check <code><a href="#topic+setEnvironment">setEnvironment</a></code>.
</p>
</dd>
<dt><code>allowFunctions(funs = NULL)</code></dt><dd>
<p>Adds function names to a list of allowed R functions. These functions can be called from a web page without authorization
on the R side. If <code>funs = NULL</code>, returns a list of all currently allowed functions. For more information,
please, check <code><a href="#topic+allowFunctions">allowFunctions</a></code>.
</p>
</dd>
<dt><code>allowVariables(vars = NULL)</code></dt><dd>
<p>Adds variable names to  the list of allowed variables. These variables can be changed from a web page without 
authorization on the R side. If <code>vars = NULL</code>, then returns a vector of names of all currently allowed variables.
For more information, please, check <code><a href="#topic+allowVariables">allowVariables</a></code>.
</p>
</dd>
<dt><code>allowDirectories(dir = NULL)</code></dt><dd>
<p>Allows app to serve files from an existing directory. Files from the <code>rootDirectory</code> can always be accessed
by the app. By default, the current working directory is
added to the list of the allowed directories, when the app is initialized. All the subdirectories of the allowed 
directories can also be accessed. Attempt to request file from outside allowed directory will produce 
<code>403 Forbidden</code> error. If <code>dirs = NULL</code>, then returns a vector of names of all currently allowed directories.
Also see <code><a href="#topic+allowDirectories">allowDirectories</a></code>.
</p>
</dd>
<dt><code>startPage(path = NULL)</code></dt><dd>
<p>Sets path to a starting web page of the app. Path can be full, relative to the app's root directory or relative
to the current R working directory. If 
<code>path = NULL</code>, returns current path to the starting page.
</p>
</dd>
<dt><code>rootDirectory(path = NULL)</code></dt><dd>
<p>Sets path to the root directory for the server. Any file, requested by the server, will be looked for in this directory.
Can be a full path or a path relative to the current R working directory. If <code>path = NULL</code>, returns path to the
current root directory.
</p>
</dd>
<dt><code>setLimits(...)</code></dt><dd>
<p>Sets limits for memory usage, number of simultaneously active connections and amount of messages processed per second. 
These settings will apply for each new connection. To change memory usage for an existing session use method <code>setLimits</code>
of class <code><a href="#topic+Session">Session</a></code>. For information about possible arguments, please, check <code><a href="#topic+setLimits">setLimits</a></code>.
</p>
</dd>
<dt><code>getPort()</code></dt><dd>
<p>Returns number of the port which the running server listens to. After the app has been initialized, the port number cannot be changed.
</p>
</dd>
</dl>


<hr>
<h2 id='authorize'>Authorize further message processing</h2><span id='topic+authorize'></span>

<h3>Description</h3>

<p><code>jrc</code> library allows one to get full control over the currently running R session from 
a web page. Therefore for security reasons one should manually authorize function calls,
variable assignments or expression evaluations. All the received messages that are not
processed automatically are given an ID and stored. This function allows a message with the 
given ID to be evaluated. It can also show a short description of the message and give user
a choice between running it or discarding.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>authorize(sessionId = NULL, messageId = NULL, show = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="authorize_+3A_sessionid">sessionId</code></td>
<td>
<p>ID of the session that received the message. If there is only one active session, this 
argument becomes optional.</p>
</td></tr>
<tr><td><code id="authorize_+3A_messageid">messageId</code></td>
<td>
<p>ID of the message to be processed. If the session has only one stored message, this argument becomes
optional.</p>
</td></tr>
<tr><td><code id="authorize_+3A_show">show</code></td>
<td>
<p>If <code>TRUE</code> information about the message will be shown first. After that user gets
a choice to go on with evaluation, to ignore the message (meaning it will be removed from memory) or to
do nothing.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Expressions has to be always authorized before evaluation. One can specify a list of
variables that can be changed automatically and functions that can be called without
authorization.
</p>
<p>This function is a wrapper around <code>authorize</code> method of class <code><a href="#topic+Session">Session</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+allowFunctions">allowFunctions</a></code>, <code><a href="#topic+allowVariables">allowVariables</a></code>, <code><a href="#topic+setLimits">setLimits</a></code>, <code><a href="#topic+getSessionIds">getSessionIds</a></code>,
<code><a href="#topic+getMessageIds">getMessageIds</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# to run this example an installed web browser is required
openPage()

callFunction("jrc.sendCommand", list("k &lt;&lt;- 10"), wait = 1)
allowVariables("x")
callFunction("jrc.sendData", list("x", 15), wait = 1)
callFunction("jrc.sendData", list("y", 20), wait = 1)
msgId &lt;- getMessageIds()
authorize(messageId = msgId[1])
#run that to first see some information about the message
#authorize(messageId = msgId[2], show = TRUE)

closePage()
## End(Not run)
</code></pre>

<hr>
<h2 id='callFunction'>Trigger a function call</h2><span id='topic+callFunction'></span>

<h3>Description</h3>

<p>Calls a function in a web page by its name. It can also pass a list of arguments for the function and 
save the returned result to a variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>callFunction(
  name,
  arguments = NULL,
  assignTo = NULL,
  wait = 0,
  sessionId = NULL,
  thisArg = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="callFunction_+3A_name">name</code></td>
<td>
<p>Name of the function. If the function is a method of some object
its name must contain the full chain of calls (e.g. <code>myArray.sort</code> or 
<code>Math.rand</code>).</p>
</td></tr>
<tr><td><code id="callFunction_+3A_arguments">arguments</code></td>
<td>
<p>List of arguments for the function. Note that in JavaScript 
arguments must be given in a fixed order, naming is not necessary and will 
be ignored.</p>
</td></tr>
<tr><td><code id="callFunction_+3A_assignto">assignTo</code></td>
<td>
<p>Name of a variable to which will be assigned the returned value
of the called function.</p>
</td></tr>
<tr><td><code id="callFunction_+3A_wait">wait</code></td>
<td>
<p>If <code>wait &gt; 0</code>, after sending the message, R will wait for a reply for a given number of seconds. 
For this time (or until the reply is received), execution of other commands will be halted. Any incoming message 
from the session will be considered as a reply.</p>
</td></tr>
<tr><td><code id="callFunction_+3A_sessionid">sessionId</code></td>
<td>
<p>An ID of the session to which the function call should be sent. Can also be a vector of multiple
session IDs. If <code>NULL</code>, the function call will be sent to all currently active sessions.</p>
</td></tr>
<tr><td><code id="callFunction_+3A_thisarg">thisArg</code></td>
<td>
<p>JavaScript functions (methods) can belong to some object, which 
is referred to as <code>this</code> inside the function (e.g. in
<code>someObject.myFunction()</code> function <code>myFunction</code> is a method of <code>someObject</code>).
<code>thisArg</code> specifies object that will be known as <code>this</code> inside the function. If <code>NULL</code>,
the function will use its parent as <code>this</code> object (as it happens in JavaScript by default).</p>
</td></tr>
<tr><td><code id="callFunction_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="#topic+sendData">sendData</a></code>. It is used to send
<code>arguments</code> to the web page.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>JavaScript counterpart is <code>jrc.callFunction(name, arguments, assignTo, package, internal)</code>.
Its arguments are:
</p>

<dl>
<dt><code>name</code></dt><dd>
<p>Name of an R function. If function name hasn't been previously added to the list
of allowed functions (see <code><a href="#topic+allowFunctions">allowFunctions</a></code> or <code>allowedFunctions</code> argument of <code><a href="#topic+openPage">openPage</a></code>),
attempt to call it from a web page will require manual authorization on the R side.
</p>
</dd>
<dt><code>arguments</code> (optional)</dt><dd>
<p>arguments for the function. This should be an Array (for unnamed arguments) or an Object with argument names as keys
(for named arguments).
</p>
</dd>
<dt><code>assignTo</code> (optional)</dt><dd>
<p>Name of the variable to which the returned value of the function will be assigned in the R session. 
If the variable name hasn't been previously added to the list
of allowed variables (see <code><a href="#topic+allowVariables">allowVariables</a></code> or <code>allowedVariables</code> argument of <code><a href="#topic+openPage">openPage</a></code>),
attempt to assign it from a web page will require manual authorization on the R side.
</p>
</dd>
<dt><code>package</code> (optional)</dt><dd>
<p>If the function needs to be imported from an installed package, name of this package.
</p>
</dd>
<dt><code>internal</code> (optional)</dt><dd>
<p>Whether assignment of the function returned value should happen internally or not. If <code>true</code>, result will be stored
in the session environment and can be accessed from the outside with <code><a href="#topic+getSessionVariable">getSessionVariable</a></code>
function. If <code>false</code>, result will be saved to the outer environment of the app (see <code><a href="#topic+setEnvironment">setEnvironment</a></code>).
By default, uses <code>true</code> for variables that already exist in the session environment 
(see <code><a href="#topic+setSessionVariables">setSessionVariables</a></code> or <code>sessionVariables</code> argument of the <code><a href="#topic+openPage">openPage</a></code> function)
and <code>false</code> otherwise.
</p>
</dd>
</dl>

<p>This function is a wrapper
around <code>callFunction</code> method of class <code><a href="#topic+Session">Session</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+authorize">authorize</a></code>, <code><a href="#topic+allowFunctions">allowFunctions</a></code>, <code><a href="#topic+allowVariables">allowVariables</a></code>,
<code><a href="#topic+setEnvironment">setEnvironment</a></code>, <code><a href="#topic+getSessionIds">getSessionIds</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# to run this example an installed web browser is required
openPage()
callFunction("alert", list("Some alertText"))
callFunction("Math.random", assignTo = "randomNumber")
sendCommand("alert(randomNumber)")
closePage()

## End(Not run)

</code></pre>

<hr>
<h2 id='closePage'>Stop server</h2><span id='topic+closePage'></span>

<h3>Description</h3>

<p>Stops the server and closes all currently opened pages (if any). This function is a 
wrapper of <code>stopServer</code> method of class <code><a href="#topic+App">App</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>closePage()
</code></pre>


<h3>See Also</h3>

<p><code><a href="#topic+openPage">openPage</a></code>
</p>

<hr>
<h2 id='closeSession'>Close one or several client sessions</h2><span id='topic+closeSession'></span>

<h3>Description</h3>

<p>Closes WebSocket connections for the selected client sessions and removes all the related
information from memory. If no arguments are provided and there is only one active session,
closes it. This function is a wrapper around method <code>closeSession</code> of 
class <code><a href="#topic+App">App</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>closeSession(sessionId = NULL, inactive = NULL, old = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="closeSession_+3A_sessionid">sessionId</code></td>
<td>
<p>IDs of the sessions to close. Can be a vector of multiple IDs.</p>
</td></tr>
<tr><td><code id="closeSession_+3A_inactive">inactive</code></td>
<td>
<p>All sessions that were inactive (didn't receive any messages) for the
specified amount of time (in seconds) will be closed.</p>
</td></tr>
<tr><td><code id="closeSession_+3A_old">old</code></td>
<td>
<p>All sessions that were opened for at least specified amount of time (in seconds)
will be closed.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# to run this example an installed web browser is required
start &lt;- Sys.time()
openPage()

app &lt;- getPage()
time &lt;- Sys.time()

app$openPage(FALSE)
app$openPage(FALSE)

print(getSessionIds())

# No sessions will be closed
closeSession(old = Sys.time() - start)
print(getSessionIds())

# One session (the one that has been opened first) will be closed
closeSession(old = Sys.time() - time)
print(getSessionIds())

time &lt;- Sys.time()
sendCommand("jrc.sendCommand('print(\"Hi!\")')", sessionId = getSessionIds()[1],  wait = 3)

# this will close all sessions except for the one, that has just send a command to R session
closeSession(inactive = Sys.time() - time)

# if there is only one active session, sessionId becomes an optional argument
closeSession()

closePage()
## End(Not run)

</code></pre>

<hr>
<h2 id='getMessageIds'>Get IDs of all stored messages</h2><span id='topic+getMessageIds'></span>

<h3>Description</h3>

<p>Returns IDs of all currently stored messages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMessageIds(sessionId = NULL, simplify = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getMessageIds_+3A_sessionid">sessionId</code></td>
<td>
<p>ID of the session for which to return message IDs. Can also be a vector of multiple session IDs.
If <code>NULL</code>, returns message IDs for all currently active sessions.</p>
</td></tr>
<tr><td><code id="getMessageIds_+3A_simplify">simplify</code></td>
<td>
<p>If <code>TRUE</code> and only one session ID is provided (or there is only one active session), returns
a vector of message IDs. Otherwise returns a named list with one vector for each requested session.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For security reasons, most of the messages that are received
from web pages require manual authorization in the R session with <code><a href="#topic+authorize">authorize</a></code> function. Until that happens,
messages are given randomly generated IDs and are stored in memory. 
</p>
<p>This function is a wrapper around method <code>getMessageIds</code> of class <code><a href="#topic+Session">Session</a></code>.
</p>


<h3>Value</h3>

<p>Either a named list or a vector with message IDs.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+authorize">authorize</a></code>, <code><a href="#topic+getSessionIds">getSessionIds</a></code>.
</p>

<hr>
<h2 id='getPage'>Get the currently running app</h2><span id='topic+getPage'></span>

<h3>Description</h3>

<p><code>jrc</code> offers two ways to control an interactive app. One is by using methods of classes
<code><a href="#topic+App">App</a></code> and <code><a href="#topic+Session">Session</a></code>. This allows one to have any number of apps within one
R session, but requires some understanding of object oriented programming. Another way is to use
provided wrapper functions that are exported by the package. These functions internally work with 
the <code><a href="#topic+App">App</a></code> object, which is stored in the package namespace upon initialization with 
<code><a href="#topic+openPage">openPage</a></code> function. <code>getPage</code> returns this object if any.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPage()
</code></pre>


<h3>Value</h3>

<p>Object of class <code><a href="#topic+App">App</a></code> or <code>NULL</code> if there is no active app.
</p>

<hr>
<h2 id='getPort'>Get number of the port on which the local server is running</h2><span id='topic+getPort'></span>

<h3>Description</h3>

<p>This function returns port number for the running server. By default, a random available port is used. One can also
set a port number as an argument of the <code><a href="#topic+openPage">openPage</a></code> function. The port number can't be changed after the app
was initialized.This function
is a wrapper around method <code>getPort</code> of the class <code><a href="#topic+App">App</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPort()
</code></pre>


<h3>See Also</h3>

<p><code><a href="#topic+openPage">openPage</a></code>
</p>

<hr>
<h2 id='getSession'>Get a session</h2><span id='topic+getSession'></span>

<h3>Description</h3>

<p>Returns <code><a href="#topic+Session">Session</a></code> by its ID. This function is a wrapper around method
<code>getSession</code> of class <code><a href="#topic+App">App</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSession(sessionId = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSession_+3A_sessionid">sessionId</code></td>
<td>
<p>ID of the session. If there is only one active session, this argument becomes optional.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code><a href="#topic+Session">Session</a></code>.
</p>

<hr>
<h2 id='getSessionIds'>Get IDs of all active sessions</h2><span id='topic+getSessionIds'></span>

<h3>Description</h3>

<p>Returns IDs of all currently active sessions. An ID is a randomly generated combination of 6 letters and
numbers that is assigned to each session upon opening. This function is a wrapper around method <code>getSessionIds</code>
of class <code><a href="#topic+App">App</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSessionIds()
</code></pre>


<h3>Value</h3>

<p>Vector of session IDs.
</p>

<hr>
<h2 id='getSessionVariable'>Get a variable from a client session environment</h2><span id='topic+getSessionVariable'></span>

<h3>Description</h3>

<p>This function returns a variable, how it is seen from a session, e.g. for all the received function calls and
commands. It searches for the variable in the session environment first, and then, if variable is not found, checks enclosing 
frames of the environment, starting from the outer environment of the app (see <code><a href="#topic+setEnvironment">setEnvironment</a></code>). If the variable
doesn't exist, throws an error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSessionVariable(varName, sessionId = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSessionVariable_+3A_varname">varName</code></td>
<td>
<p>Name of the variable to search for. Must be a character.</p>
</td></tr>
<tr><td><code id="getSessionVariable_+3A_sessionid">sessionId</code></td>
<td>
<p>ID of the session. If there is only one active session, this argument becomes optional.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function
is a wrapper around method <code>sessionVariables</code> of the class <code><a href="#topic+Session">Session</a></code>.
</p>


<h3>Value</h3>

<p>Requested variable
</p>


<h3>See Also</h3>

<p><code><a href="#topic+setSessionVariables">setSessionVariables</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# to run this example an installed web browser is required
f &lt;- function(x) {x * 3}
openPage(allowedFunctions = "f", allowedVariables = "k", sessionVars = list(k = 0))
k &lt;- getSessionVariable("k")
getPage()$openPage(FALSE)
id1 &lt;- getSessionIds()[1]
id2 &lt;- getSessionIds()[2]
sendCommand("jrc.callFunction('f', [10], 'k')", sessionId = id1, wait = 3)
sendCommand("jrc.callFunction('f', [20], 'k')", sessionId = id2, wait = 3)
k1 &lt;- getSessionVariable("k", id1)
k2 &lt;- getSessionVariable("k", id2)

closePage()
## End(Not run)

</code></pre>

<hr>
<h2 id='listen'>Listen to the server</h2><span id='topic+listen'></span>

<h3>Description</h3>

<p>When R session is not interactive, messages from the server are not processed automatically. In this case, one needs to 
keep this function running.
This function, is a wrapper around <code><a href="later.html#topic+run_now">run_now</a></code> or <code><a href="httpuv.html#topic+service">service</a></code>. It runs 
the <code><a href="httpuv.html#topic+service">service</a></code> in a loop with a specified condition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>listen(time = Inf, activeSessions = NULL, condition = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="listen_+3A_time">time</code></td>
<td>
<p>Time (in seconds), during which the R session should listen to the server. By default, the function runs until
it is not interrupted (<code>time = Inf</code>).</p>
</td></tr>
<tr><td><code id="listen_+3A_activesessions">activeSessions</code></td>
<td>
<p>The function runs, until there is at least one active session in the provided app. If there is only
one active app, this argument can be set to <code>TRUE</code> for the same effect.</p>
</td></tr>
<tr><td><code id="listen_+3A_condition">condition</code></td>
<td>
<p>Custom condition. This argument must be a function that returns <code>TRUE</code> or <code>FALSE</code>. R session will 
listen to the server, while the condition function returns <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# to run this example an installed web browser is required
openPage()
listen(time = 3)
## End(Not run)

</code></pre>

<hr>
<h2 id='openPage'>Create a server</h2><span id='topic+openPage'></span>

<h3>Description</h3>

<p><code>openPage</code> starts a server and opens a new page with a WebSocket connection between it and the current
R session. After that, messages can be exchanged between R session and the web page to generate content on the
web page and to trigger calculations in R as a response to user activity on the page.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>openPage(
  useViewer = TRUE,
  rootDirectory = NULL,
  startPage = NULL,
  port = NULL,
  browser = NULL,
  allowedFunctions = NULL,
  allowedVariables = NULL,
  allowedDirectories = getwd(),
  connectionNumber = Inf,
  sessionVars = NULL,
  onStart = NULL,
  onClose = NULL,
  onlyServer = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="openPage_+3A_useviewer">useViewer</code></td>
<td>
<p>If <code>TRUE</code>, the new web page will be opened in the RStudio Viewer. If <code>FALSE</code>,
a default web browser will be used (if other is not specified with the <code>browser</code> argument).</p>
</td></tr>
<tr><td><code id="openPage_+3A_rootdirectory">rootDirectory</code></td>
<td>
<p>A path to the root directory for the server. Any file, requested by the server
will be searched for in this directory. If <code>rootDirectory</code> is not 
defined, the <code>http_root</code> in the package directory will be used as a root directory.</p>
</td></tr>
<tr><td><code id="openPage_+3A_startpage">startPage</code></td>
<td>
<p>A path to an HTML file that should be used as a starting page of the app.
It can be an absolute path to a local file, or it can be relative to the <code>rootDirectory</code>
or to the current R working directory. If <code>startPage</code> is not defined, an empty page will be used.
The file must have <em>.html</em> extension.</p>
</td></tr>
<tr><td><code id="openPage_+3A_port">port</code></td>
<td>
<p>Defines which TCP port the server will listen to. If not defined, random available port
will be used (see <code><a href="httpuv.html#topic+randomPort">randomPort</a></code>).</p>
</td></tr>
<tr><td><code id="openPage_+3A_browser">browser</code></td>
<td>
<p>A browser in which to open a new web page.
If not defined, default browser will be used. For more information check <code><a href="utils.html#topic+browseURL">browseURL</a></code>.
If this argument is specified, <code>useViewer</code> will be ignored.</p>
</td></tr>
<tr><td><code id="openPage_+3A_allowedfunctions">allowedFunctions</code></td>
<td>
<p>List of functions that can be called from a web page without any additional actions 
on the R side. All other functions will require authorization in the current R session before they are called. 
This argument should be a vector of R function names. Check <code><a href="#topic+authorize">authorize</a></code> and <code><a href="#topic+allowFunctions">allowFunctions</a></code>
for more information.</p>
</td></tr>
<tr><td><code id="openPage_+3A_allowedvariables">allowedVariables</code></td>
<td>
<p>List of variables that can be modified from a web page without any additional actions 
on the R side. All other variable reassignments must be confirmed in the current R session. 
This argument should be a vector of variable names. Check <code><a href="#topic+authorize">authorize</a></code> and <code><a href="#topic+allowVariables">allowVariables</a></code>
for more information.</p>
</td></tr>
<tr><td><code id="openPage_+3A_alloweddirectories">allowedDirectories</code></td>
<td>
<p>List of directories that can be accessed by the server. This argument should be a vector of
paths (absolute or relative to the current working directory) to existing directories. Check <code><a href="#topic+allowDirectories">allowDirectories</a></code>
for more information.</p>
</td></tr>
<tr><td><code id="openPage_+3A_connectionnumber">connectionNumber</code></td>
<td>
<p>Maximum number of connections that is allowed to be active simultaneously.</p>
</td></tr>
<tr><td><code id="openPage_+3A_sessionvars">sessionVars</code></td>
<td>
<p>Named list of variables, that will be declared for each session, when a new connection is opened.
Any changes to these variables will affect only a certain session. Thus they can be used, for instance, to 
store a state of each session. For more information, please, check <code><a href="#topic+setSessionVariables">setSessionVariables</a></code>.</p>
</td></tr>
<tr><td><code id="openPage_+3A_onstart">onStart</code></td>
<td>
<p>A callback function that will be executed, when a new connection is opened. This function gets a single 
argument, which is an object of class <code><a href="#topic+Session">Session</a></code>. General purpose of the function is to populate each 
new web page with some default content.</p>
</td></tr>
<tr><td><code id="openPage_+3A_onclose">onClose</code></td>
<td>
<p>A callback function that will be executed, when a connection is closed. This function gets a single
argument, which is an object of class <code><a href="#topic+Session">Session</a></code>. General purpose of the function is to store session 
variables if needed or in any other form to finalize user's interaction with the app.</p>
</td></tr>
<tr><td><code id="openPage_+3A_onlyserver">onlyServer</code></td>
<td>
<p>If <code>TRUE</code>, then an app will initialise without trying to open a new page in a browser.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>jrc</code> supports four types of messages:
</p>

<ul>
<li><p>Commands are pieces of R or JavaScript code that will be evaluated on the receiving side. Note, 
that any command from a web page must be authorized in the R session for security reasons. A message 
with information about how to do that is printed in the console each time a command is received. For more
information, please, check <code><a href="#topic+sendCommand">sendCommand</a></code>.
</p>
</li>
<li><p>Data is any variable that is sent to or from the R session. It must always come with a 
name of the variable to which it should be assigned on the receiving side. For more information, please,
check <code><a href="#topic+sendData">sendData</a></code>.
</p>
</li>
<li><p>Function calls can be triggered on each side of the WebSocket connection. Alongside the function name,
one can also send a list of arguments and name of a variable to which the returned value of the function will
be assigned. For more information, please, check <code><a href="#topic+callFunction">callFunction</a></code>.
</p>
</li>
<li><p>Unlike other types of messages, HTML code can be sent only from the R session to a web page. This code will
be added to the body of the page.
</p>
</li></ul>

<p><code>openPage</code> function is a wrapper around several methods of class <code><a href="#topic+App">App</a></code>. First, it creates an
instance of this class. Then it starts a server that listens to the given port. And finally, it attempts
to open a new web page. It also stores a new app object in the package namespace, which allows other
wrapper functions to access it.
</p>


<h3>Value</h3>

<p>Object of class <code><a href="#topic+App">App</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+closePage">closePage</a></code>, <code><a href="#topic+setEnvironment">setEnvironment</a></code>, <code><a href="#topic+setLimits">setLimits</a></code>, <code><a href="#topic+allowVariables">allowVariables</a></code>,
<code><a href="#topic+allowFunctions">allowFunctions</a></code>, <code><a href="#topic+setSessionVariables">setSessionVariables</a></code>.
</p>

<hr>
<h2 id='removeMessage'>Removes a stored message</h2><span id='topic+removeMessage'></span>

<h3>Description</h3>

<p>Removes a message from the storage of a session. This function is a wrapper around
method <code>removeMessage</code> of class <code><a href="#topic+Session">Session</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeMessage(sessionId = NULL, messageId = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="removeMessage_+3A_sessionid">sessionId</code></td>
<td>
<p>ID of the session from where to remove a message. If there is only one active session, this argument
becomes optional.</p>
</td></tr>
<tr><td><code id="removeMessage_+3A_messageid">messageId</code></td>
<td>
<p>ID of the message to remove. If there is only one stored message, this argument becomes optional.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+authorize">authorize</a></code>, <code><a href="#topic+getMessageIds">getMessageIds</a></code>.
</p>

<hr>
<h2 id='removeSessionVariables'>Remove variables from a client session environment</h2><span id='topic+removeSessionVariables'></span>

<h3>Description</h3>

<p>This function removes variables from the environment of a client session. It allows, for instance, to unmask
a variable with the same name from the outer app environment (see <code><a href="#topic+setEnvironment">setEnvironment</a></code>) for the session 
(check the example below). This function
is a wrapper around method <code>sessionVariables</code> of the class <code><a href="#topic+Session">Session</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeSessionVariables(varNames, sessionId = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="removeSessionVariables_+3A_varnames">varNames</code></td>
<td>
<p>Names of variables to remove.</p>
</td></tr>
<tr><td><code id="removeSessionVariables_+3A_sessionid">sessionId</code></td>
<td>
<p>ID of the session. If there is only one active session, this argument becomes optional.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+setSessionVariables">setSessionVariables</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# to run this example an installed web browser is required
openPage(allowedVariables = "k", sessionVars = list(k = 10))

k &lt;- -1
getPage()$openPage(FALSE)
id1 &lt;- getSessionIds()[1]
id2 &lt;- getSessionIds()[2]
removeSessionVariables("k", id1)
#this changes global 'k', since the variable is no longer masked
sendCommand("jrc.sendData('k', 1)", sessionId = id1, wait = 3)
#this doesn't affect global 'k'
sendCommand("jrc.sendData('k', 5)", sessionId = id2, wait = 3)
local_k &lt;- getSessionVariable("k", id2)

closePage()
## End(Not run)

</code></pre>

<hr>
<h2 id='sendCommand'>Send a command to a web page</h2><span id='topic+sendCommand'></span>

<h3>Description</h3>

<p><code>sendCommand</code> sends JavaScript code through the selected WebSocket connection and evaluates it on the specified
web page. Use JavaScript function <code>jrc.sendCommand</code> to send R code from the web page
and evaluate it in the current R session. All commands send to R from the server will be evaluated
only after authorization in the currently running R session (see <code><a href="#topic+authorize">authorize</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sendCommand(command, sessionId = NULL, wait = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sendCommand_+3A_command">command</code></td>
<td>
<p>A line (or several lines separated by <code>\n</code>) of JavaScript code. This code
will be directly evaluated on the web page. No R-side syntax check is performed.</p>
</td></tr>
<tr><td><code id="sendCommand_+3A_sessionid">sessionId</code></td>
<td>
<p>An ID of the session to which the command should be sent. Can also be a vector of multiple session IDs.
If <code>NULL</code>, the command will be sent to all currently active sessions.</p>
</td></tr>
<tr><td><code id="sendCommand_+3A_wait">wait</code></td>
<td>
<p>If <code>wait &gt; 0</code>, after sending the message, R will wait for a reply for a given number of seconds. 
For this time (or until the reply is received), execution of other commands will be halted. Any incoming message 
from the session will be considered as a reply.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each opened page gets its own environment, where all the commands are evaluated. Any changes
made with the usual assignment operator <code>&lt;-</code> will be limited to this page-specific environment. The changes
are still saved, but can be accessed only with <code><a href="#topic+getSessionVariable">getSessionVariable</a></code> function. To make changes outside
of the page-specific environment use <code>&lt;&lt;-</code> instead.
</p>
<p>In JavaScript one should use <code>windows.varibleName = "SomeValue"</code>
instead of <code>varibleName = "SomeValue"</code>, in order to make the variable accessible outside of the
current <code>sendCommand</code> call.
</p>
<p>This function is a wrapper around <code>sendCommand</code> method of class <code><a href="#topic+Session">Session</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+authorize">authorize</a></code>, <code><a href="#topic+sendData">sendData</a></code>, <code><a href="#topic+sendHTML">sendHTML</a></code>, <code><a href="#topic+callFunction">callFunction</a></code>,
<code><a href="#topic+openPage">openPage</a></code>, <code><a href="#topic+getSessionIds">getSessionIds</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
## Not run: 
# to run this example an installed web browser is required
k &lt;- 0
openPage()
sendCommand(paste0("button = document.createElement('input');",
              "button.type = 'button';",
              "button.addEventListener('click', function() {jrc.sendCommand('k &lt;&lt;- k + 1')});", 
              "button.value = '+1';",
              "document.body.appendChild(button);", collapse = "\n"))
closePage()
## End(Not run)

</code></pre>

<hr>
<h2 id='sendData'>Send data to a web page</h2><span id='topic+sendData'></span>

<h3>Description</h3>

<p>Sends a variable to a web page, where it is saved under a specified name. This function
is a wrapper around <code>sendData</code> method of class <code><a href="#topic+Session">Session</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sendData(
  variableName,
  variable,
  keepAsVector = FALSE,
  rowwise = TRUE,
  sessionId = NULL,
  wait = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sendData_+3A_variablename">variableName</code></td>
<td>
<p>Name that the variable will have on the web page.</p>
</td></tr>
<tr><td><code id="sendData_+3A_variable">variable</code></td>
<td>
<p>Variable to send.</p>
</td></tr>
<tr><td><code id="sendData_+3A_keepasvector">keepAsVector</code></td>
<td>
<p>If <code>TRUE</code>, variables with length 1 will be saved as arrays on the web page, otherwise they 
will be converted to atomic types.</p>
</td></tr>
<tr><td><code id="sendData_+3A_rowwise">rowwise</code></td>
<td>
<p>If <code>TRUE</code>, matrices and data.frames will be transformed into JavaScript objects or arrays
row wise (e.g. a matrix will become an Array of its rows).</p>
</td></tr>
<tr><td><code id="sendData_+3A_sessionid">sessionId</code></td>
<td>
<p>An ID of the session to which the data should be sent. Can also be a vector of multiple session IDs.
If <code>NULL</code>, the data will be sent to all currently active sessions.</p>
</td></tr>
<tr><td><code id="sendData_+3A_wait">wait</code></td>
<td>
<p>If <code>wait &gt; 0</code>, after sending the message, R will wait for a reply for a given number of seconds. 
For this time (or until the reply is received), execution of other commands will be halted. Any incoming message 
from the session will be considered as a reply.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To send data back from the web page to the current R session one should use<code>jrc.sendData(variableName, variable, internal)</code>.
Its arguments are:
</p>

<dl>
<dt><code>variableName</code></dt><dd>
<p>Name that the variable will have in the R session. If variable name hasn't been previously added to the list
of allowed variables (see <code><a href="#topic+allowVariables">allowVariables</a></code> or <code>allowedVariables</code> argument of the <code><a href="#topic+openPage">openPage</a></code>
function), attempt to assign it from a web page will require manual authorization on the R side.
</p>
</dd>
<dt><code>variable</code></dt><dd>
<p>Variable to send.
</p>
</dd>
<dt><code>internal</code> (optional)</dt><dd>
<p>Whether this variable should be used only by the session that sent it. If <code>true</code>, variable will be stored
in the session-specific environment and can be accessed from the outside with <code><a href="#topic+getSessionVariable">getSessionVariable</a></code>
function. If <code>false</code>, variable will be saved to the outer environment of the app (see <code><a href="#topic+setEnvironment">setEnvironment</a></code>).
By default, uses <code>true</code> for variables that already exist in the session specific environment 
(see <code><a href="#topic+setSessionVariables">setSessionVariables</a></code> or <code>sessionVariables</code> argument of the <code><a href="#topic+openPage">openPage</a></code> function.)
and <code>false</code> otherwise.
</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+authorize">authorize</a></code>, <code><a href="#topic+allowVariables">allowVariables</a></code>, <code><a href="#topic+sendCommand">sendCommand</a></code>,
<code><a href="#topic+callFunction">callFunction</a></code>, <code><a href="#topic+sendHTML">sendHTML</a></code>, <code><a href="#topic+openPage">openPage</a></code>, <code><a href="#topic+getSessionIds">getSessionIds</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# to run this example an installed web browser is required
openPage()
x &lt;- 1:100
sendData("x", x)
sendCommand("console.log(x);")
sendCommand("jrc.sendData('x', x.filter(function(e) {return e % 2 == 0}))")
closePage()
## End(Not run)

</code></pre>

<hr>
<h2 id='sendHTML'>Send HTML to a web page</h2><span id='topic+sendHTML'></span>

<h3>Description</h3>

<p>Sends a piece of HTML code to a web page and adds it at the end
or the <code>body</code> element. This function is a wrapper around <code>sendHTML</code> method of 
class <code><a href="#topic+Session">Session</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sendHTML(html = "", sessionId = NULL, wait = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sendHTML_+3A_html">html</code></td>
<td>
<p>HTML code that will be added to the web page.</p>
</td></tr>
<tr><td><code id="sendHTML_+3A_sessionid">sessionId</code></td>
<td>
<p>An ID of the session to which the HTML should be sent. Can also be a vector of multiple session IDs.
If <code>NULL</code>, the HTML will be sent to all currently active sessions.</p>
</td></tr>
<tr><td><code id="sendHTML_+3A_wait">wait</code></td>
<td>
<p>If <code>wait &gt; 0</code>, after sending the message, R will wait for a reply for a given number of seconds. 
For this time (or until the reply is received), execution of other commands will be halted. Any incoming message 
from the session will be considered as a reply.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+sendData">sendData</a></code>, <code><a href="#topic+sendCommand">sendCommand</a></code>, <code><a href="#topic+callFunction">callFunction</a></code>,
<code><a href="#topic+openPage">openPage</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# to run this example an installed web browser is required
openPage(FALSE)

sendHTML("Test...")
sendHTML("This is &lt;b&gt;bold&lt;/b&gt;")
sendHTML("&lt;table&gt;&lt;tr&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;3&lt;/td&gt;&lt;td&gt;4&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;")
## End(Not run)

</code></pre>

<hr>
<h2 id='Session'>Session class</h2><span id='topic+Session'></span>

<h3>Description</h3>

<p>Objects of this class handle all the incoming and outgoing messages for one active connection. 
Please, avoid creating instances of this class manually. Each <code>Session</code> object is created when
a WebSocket is opened and serves as a wrapper around it. A manually created object will not have
a WebSocket connection and thus are not functional.
</p>
<p>All sessions are stored within an object of class <code><a href="#topic+App">App</a></code> and cannot exist and function without it.
One can manipulate a session directly, using its methods described below, via methods of the corresponding 
<code><a href="#topic+App">App</a></code> object or the provided wrapper function (links to them can be found in the Methods section).
</p>


<h3>Fields</h3>


<dl>
<dt><code>id</code></dt><dd>
<p>Automatically generated ID for this session. ID is a random combination of 6 letters or numbers.
Please, do not change the value of this field.
</p>
</dd>
<dt><code>lastActive</code></dt><dd>
<p>Time of the last received message from the session's WebSocket. The timestamp is generated by the
<code><a href="base.html#topic+Sys.time">Sys.time</a></code> function.
</p>
</dd>
<dt><code>startTime</code></dt><dd>
<p>Time when this session has been started (generated by the <code><a href="base.html#topic+Sys.time">Sys.time</a></code> function).
</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt><code>getMessageIds()</code></dt><dd>
<p>Returns IDs of all currently stored messages. ID is a combination of 6 random letters and numbers
generated when the message is stored. See also <code><a href="#topic+getMessageIds">getMessageIds</a></code>.
</p>
</dd>
<dt><code>authorize(messageId = NULL, show = FALSE)</code></dt><dd> 
<p>Authorizes evaluation of a message. Check <code><a href="#topic+authorize">authorize</a></code> for more information.
</p>
</dd>
<dt><code>removeMessage(messageId = NULL)</code></dt><dd>
<p>Removes a stored message. This can also be done with the <code><a href="#topic+authorize">authorize</a></code> function (set
<code>show = TRUE</code> and then select the &ldquo;Ignore message&rdquo; option). See also <code><a href="#topic+removeMessage">removeMessage</a></code>.
</p>
</dd>
<dt><code>sendCommand(command, wait = 0)</code></dt><dd>
<p>Sends a JavaScript command to be evaluated on the web page. Check 
<code><a href="#topic+sendCommand">sendCommand</a></code> for more information.
</p>
</dd>
<dt><code>callFunction(name, arguments = NULL, assignTo = NULL, wait = 0, thisArg = NULL,  ...)</code></dt><dd>
<p>Calls an existing JavaScript
function on the web page. Check <code><a href="#topic+callFunction">callFunction</a></code> for more information.
</p>
</dd>
<dt><code>sendData(variableName, variable, wait = 0, keepAsVector = FALSE, rowwise = TRUE)</code></dt><dd>
<p>Sends data and assigns it to 
a variable on the web page. Check <code><a href="#topic+sendData">sendData</a></code> for more information.
</p>
</dd>
<dt><code>sendHTML(html, wait = 0)</code></dt><dd>
<p>Sends HTML code that will be appended to the web page. Check <code><a href="#topic+sendHTML">sendHTML</a></code> for 
more information.
</p>
</dd>
<dt><code>sessionVariables(vars = NULL, varName = NULL, remove = NULL)</code></dt><dd>
<p>Sets or returns variables that are used (read or modified) only by this session. If both arguments are
<code>NULL</code>, returns environment for this session. If <code>vars</code> is a named list, adds this variables to the
session environment. If <code>varName</code> is a character, returns a variable with this name how it is seen from
the session. If the variable doesn't exist, throws an error. If <code>remove</code> is a vector of characters, removes
variables with these names from the session environment. One can add variables to the session environment,
get one back and remove variables with a single function call. Check <code><a href="#topic+setSessionVariables">setSessionVariables</a></code>,
<code><a href="#topic+getSessionVariable">getSessionVariable</a></code>, <code><a href="#topic+removeSessionVariables">removeSessionVariables</a></code> for more information.
</p>
</dd>
<dt><code>setLimits(limits)</code></dt><dd>
<p>Sets limits for memory usage, number of simultaneously active connections and amount of messages processed per second. 
For information about possible arguments, please, check <code><a href="#topic+setLimits">setLimits</a></code>. This method accepts all the same arguments,
but they should be supplied in a form of list.
</p>
</dd>
</dl>

<p>Note, that <code>Session</code> class has some other public methods that are not mentioned in this list. These methods are
intended to be used only by other functions of <code>jrc</code> package and therefore are not documented.
</p>

<hr>
<h2 id='setEnvironment'>Set Environment</h2><span id='topic+setEnvironment'></span>

<h3>Description</h3>

<p>Defines the outer environment of the app. Outer environment is a parent for all session environments.
It is used to store variables that are common for all the client sessions. The only way to make changes outside of
the outer environment is to use the global assignment operator <code>&lt;&lt;-</code> if and only if changes are 
made to the variable that does not exist in the outer environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setEnvironment(envir)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setEnvironment_+3A_envir">envir</code></td>
<td>
<p>Environment to be used as outer environment.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, an environment where app was initialized (via <code><a href="#topic+openPage">openPage</a></code> function or with <code>App$new()</code> call)
is used.
</p>
<p>This function is a wrapper around <code>setEnvironment</code> method of class <code><a href="#topic+App">App</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# to run this example an installed web browser is required
openPage()
e &lt;- new.env()
setEnvironment(e)

sendCommand("jrc.sendData('x', 10)", wait = 3)
print(e$x)
closePage()

## End(Not run)

</code></pre>

<hr>
<h2 id='setLimits'>Set security limits</h2><span id='topic+setLimits'></span>

<h3>Description</h3>

<p>This function allows to control memory usage and limit number of messages processed per
second or simultaneously active connections to the app. 
</p>
<p>If an app is deployed on a server and is publicly available, it may be useful to limit
resources that are available to each user. There are various things that can be
controlled by this function: storage size and number of stored messages, 
maximal variable size, number of messages processed per second and bytes received
per second.
</p>
<p>Messages are all the communication received via web socket from an opened web page.
Each message contains a command that is to be evaluated in the R session, name
of a function to call or variable to store. If number or size of messages exceeds
the preset limit, they are completely ignored by the app.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setLimits(
  maxCon = NULL,
  storageSize = NULL,
  storedMsg = NULL,
  varSize = NULL,
  msgPerSec = NULL,
  msgSize = NULL,
  bytesPerSec = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setLimits_+3A_maxcon">maxCon</code></td>
<td>
<p>Maximal allowed number of web socket connections simultaneously. A new
connection is established whenever someone requests an HTML page from the server
or when the <code>openPage</code> method of class <code><a href="#topic+App">App</a></code> is used. If number of
the allowed connections is reached the newly opened web socked will be immediately
closed and the user will see a warning.</p>
</td></tr>
<tr><td><code id="setLimits_+3A_storagesize">storageSize</code></td>
<td>
<p>Maximal total size of all stored messages in bytes.</p>
</td></tr>
<tr><td><code id="setLimits_+3A_storedmsg">storedMsg</code></td>
<td>
<p>Maximal number of messages that can be stored simultaneously.</p>
</td></tr>
<tr><td><code id="setLimits_+3A_varsize">varSize</code></td>
<td>
<p>Maximal size of a variable that can be received from a web page. 
Attempt to assign data of larger size to a variable will be ignored.</p>
</td></tr>
<tr><td><code id="setLimits_+3A_msgpersec">msgPerSec</code></td>
<td>
<p>Maximal number of messages that can be received per second. 
All extra messages will be disposed of immediately without any attempt to 
process their content.</p>
</td></tr>
<tr><td><code id="setLimits_+3A_msgsize">msgSize</code></td>
<td>
<p>Maximal allowed size of a message in bytes. Note, that here a
size of character string that contains all the received information is estimated.
All larger messages will be ignored.</p>
</td></tr>
<tr><td><code id="setLimits_+3A_bytespersec">bytesPerSec</code></td>
<td>
<p>Number of bytes that can be received per second. After the 
limit is reached, all the incoming messages will be ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For security reasons, some messages has to be first authorized by the 
<code><a href="#topic+authorize">authorize</a></code> function, before they can be processed. Such messages
are saved until they are manually removed or authorized. If number or total 
size of the stored messages exceeds the limits, new messages are still saved, 
but the older ones are removed from the memory. If storage size is set to zero
no messages can be stored and every message that requires authorization will 
be automatically discarded.
</p>
<p>Size of variables or messages is estimated in <code><a href="utils.html#topic+object.size">object.size</a></code>
and is always measured in byte.
</p>
<p>The limits are set for the entire app and are applied for each new connection.
One can also change security limits for any connection separately by using
method <code>setLimits</code> of a corresponding object of class <code><a href="#topic+Session">Session</a></code>.
</p>
<p>This function is a wrapper for method <code>setLimits</code> of class <code><a href="#topic+App">App</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+authorize">authorize</a></code>, <code><a href="#topic+allowFunctions">allowFunctions</a></code>, <code><a href="#topic+allowVariables">allowVariables</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# to run this example an installed web browser is required
openPage()
setLimits(maxCon = 10)
setLimits(varSize = 10 * 1024^2)
closePage()
## End(Not run)

</code></pre>

<hr>
<h2 id='setSessionVariables'>Adds variables to a session environment</h2><span id='topic+setSessionVariables'></span>

<h3>Description</h3>

<p>Each client session in <code>jrc</code>, gets its own environment that can be accessed only by this
session (or from the outside with the <code><a href="#topic+getSessionVariable">getSessionVariable</a></code> function). General purpose
of these environments is to store some session-specific information such as state of the app for
each user. It can also be used to mask variables from the user: if there are two variables with the
same name in the session environment and outside of it, user will not be able to see the latter one.
This function adds new variables to a session environment or changes values of some existing ones.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setSessionVariables(vars, sessionId = NULL, makeDefault = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setSessionVariables_+3A_vars">vars</code></td>
<td>
<p>Named list of variables to be added to a session environment. Names are required and 
will be used as variable names.</p>
</td></tr>
<tr><td><code id="setSessionVariables_+3A_sessionid">sessionId</code></td>
<td>
<p>ID of the session to which variables should be added. Can also be a vector of
multiple session IDs. If <code>NULL</code>, then variables will be added to all currently active sessions.</p>
</td></tr>
<tr><td><code id="setSessionVariables_+3A_makedefault">makeDefault</code></td>
<td>
<p>If <code>TRUE</code> then, in addition, the specified variables will be added to each
new opened session as default ones.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a wrapper around method <code>sessionVariables</code> of class <code><a href="#topic+Session">Session</a></code>.
If <code>makeDefault = TRUE</code>, it is also a wrapper around method <code>sessionVariables</code> of class
<code><a href="#topic+App">App</a></code>. The first one changes the current state of the session environment, while the
second specifies default variables for each new session.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getSessionVariable">getSessionVariable</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# to run this example an installed web browser is required
openPage(allowedFunctions = "f", allowedVariables = "res")

m &lt;- 1
f &lt;- function() {v * m}
setSessionVariables(list(v = 1:10, m = 2))

sendCommand("jrc.callFunction('f', [], 'res')", wait = 1)
print(res)

closePage()
## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
