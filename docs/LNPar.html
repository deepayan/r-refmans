<!DOCTYPE html><html><head><title>Help for package LNPar</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LNPar}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dLnormParMix'><p>density of a mixture of a lognormal and a Pareto r.v.</p></a></li>
<li><a href='#dpareto'><p>density of a Pareto r.v.</p></a></li>
<li><a href='#LPfit'><p>Estimating a lognormal-Pareto mixture by maximizing the profile log-likelihood</p></a></li>
<li><a href='#LPtest'><p>Testing for a Pareto tail</p></a></li>
<li><a href='#MLEBoot'><p>Bootstrap standard errors for the estimators of a lognormal-Pareto mixture</p></a></li>
<li><a href='#par_logn_mix_known'><p>Estimate the parameters of a lognormal-Pareto density, assuming a known threshold</p></a></li>
<li><a href='#ParallelTest'><p>Testing for a Pareto tail</p></a></li>
<li><a href='#rLnormParMix'><p>Random number simulation for a mixture of a lognormal and a Pareto r.v.</p></a></li>
<li><a href='#rpareto'><p>Random number generation for a Pareto r.v.</p></a></li>
<li><a href='#TN2016'><p>Number of employees in year 2016 in all the firms of the Trento district</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Estimation and Testing for a Lognormal-Pareto Mixture</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates a lognormal-Pareto mixture by maximizing the profile likelihood function. A likelihood ratio test for discriminating between lognormal and Pareto tail is also implemented. See Bee, M. (2022) &lt;<a href="https://doi.org/10.1007%2Fs11634-022-00497-4">doi:10.1007/s11634-022-00497-4</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rdpack, parallel, stats</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-28 06:56:59 UTC; marco.bee</td>
</tr>
<tr>
<td>Author:</td>
<td>Marco Bee <a href="https://orcid.org/0000-0002-9579-3650"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marco Bee &lt;marco.bee@unitn.it&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-30 11:00:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='dLnormParMix'>density of a mixture of a lognormal and a Pareto r.v.</h2><span id='topic+dLnormParMix'></span>

<h3>Description</h3>

<p>This function computes the density of a mixture of a lognormal and a Pareto r.v.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dLnormParMix(x, pi, mu, sigma, xmin, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dLnormParMix_+3A_x">x</code></td>
<td>
<p>non-negative numerical vector: values where the density has to be evaluated.</p>
</td></tr>
<tr><td><code id="dLnormParMix_+3A_pi">pi</code></td>
<td>
<p>scalar, 0 &lt; p &lt; 1: mixing weight.</p>
</td></tr>
<tr><td><code id="dLnormParMix_+3A_mu">mu</code></td>
<td>
<p>scalar: expected value of the lognormal distribution on the log scale.</p>
</td></tr>
<tr><td><code id="dLnormParMix_+3A_sigma">sigma</code></td>
<td>
<p>positive scalar: standard deviation of the lognormal distribution on the log scale.</p>
</td></tr>
<tr><td><code id="dLnormParMix_+3A_xmin">xmin</code></td>
<td>
<p>positive scalar: threshold.</p>
</td></tr>
<tr><td><code id="dLnormParMix_+3A_alpha">alpha</code></td>
<td>
<p>positive scalar: Pareto shape parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Density of the lognormal-Pareto distribution evaluated at x.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mixDens &lt;- dLnormParMix(5,.5,0,1,4,1.5)
</code></pre>

<hr>
<h2 id='dpareto'>density of a Pareto r.v.</h2><span id='topic+dpareto'></span>

<h3>Description</h3>

<p>This function evaluates the density of a Pareto r.v.s
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpareto(x, xmin, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dpareto_+3A_x">x</code></td>
<td>
<p>numerical vector (&gt;xmin): values where the density has to be evaluated.</p>
</td></tr>
<tr><td><code id="dpareto_+3A_xmin">xmin</code></td>
<td>
<p>positive scalar: Pareto scale parameter.</p>
</td></tr>
<tr><td><code id="dpareto_+3A_alpha">alpha</code></td>
<td>
<p>positive scalar: Pareto shape parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Density of the Pareto distribution evaluated at x.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>parDens &lt;- dpareto(5,4,1.5)
</code></pre>

<hr>
<h2 id='LPfit'>Estimating a lognormal-Pareto mixture by maximizing the profile log-likelihood</h2><span id='topic+LPfit'></span>

<h3>Description</h3>

<p>This function fits a lognormal-Pareto mixture by maximizing the profile log-likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LPfit(y, minRank, nboot)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LPfit_+3A_y">y</code></td>
<td>
<p>numerical vector: random sample from the mixture.</p>
</td></tr>
<tr><td><code id="LPfit_+3A_minrank">minRank</code></td>
<td>
<p>integer: minimum possible rank of the threshold.</p>
</td></tr>
<tr><td><code id="LPfit_+3A_nboot">nboot</code></td>
<td>
<p>number of bootstrap replications used for estimating the standard errors. If omitted, no standard errors are computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimation is implemented as in Bee (2022). As of standard errors, at each bootstrap replication the mixture is estimated with thresholds equal to ys(minRank), ys(minRank+1),..., ys(n),
where n is the sample size and ys is the sample sorted in ascending order. The latter procedure is implemented via parallel computing.
If the algorithm does not converge in 1000 iterations, a message is displayed.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<p>xmin: estimated threshold.
</p>
<p>prior: estimated mixing weight.
</p>
<p>postProb: matrix of posterior probabilities.
</p>
<p>alpha: estimated Pareto shape parameter.
</p>
<p>mu: estimated expectation of the lognormal distribution on the lognormal scale.
</p>
<p>sigma: estimated standard deviation of the lognormal distribution on the lognormal scale.
</p>
<p>loglik: maximized log-likelihood.
</p>
<p>nit: number of iterations.
</p>
<p>npareto: estimated number of Pareto observations.
</p>
<p>bootstd: bootstrap standard errors of the estimators.
</p>


<h3>References</h3>


<p>Bee M (2022).
&ldquo;On discriminating between lognormal and Pareto tail: an unsupervised mixture-based approach.&rdquo;
<em>Advances in Data Analysis and Classification</em>.
<a href="https://doi.org/10.1007/s11634-022-00497-4">doi:10.1007/s11634-022-00497-4</a>.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>mixFit &lt;- LPfit(TN2016,90,0)
</code></pre>

<hr>
<h2 id='LPtest'>Testing for a Pareto tail</h2><span id='topic+LPtest'></span>

<h3>Description</h3>

<p>This function draws a bootstrap sample from the null (lognormal) distribution and computes the test for the null hypothesis of
a pure lognormal distribution versus the alternative of a lognormal-Pareto
mixture. To be only called from ParallelTest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LPtest(x, n, muNull, sigmaNull, minRank)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LPtest_+3A_x">x</code></td>
<td>
<p>list: sequence of integers 1,...,K, where K is the mumber of datasets. Set x = 1 in case
of a single dataset.</p>
</td></tr>
<tr><td><code id="LPtest_+3A_n">n</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code id="LPtest_+3A_munull">muNull</code></td>
<td>
<p>lognormal expected value under the null hypothesis.</p>
</td></tr>
<tr><td><code id="LPtest_+3A_sigmanull">sigmaNull</code></td>
<td>
<p>lognormal standard deviation under the null hypothesis.</p>
</td></tr>
<tr><td><code id="LPtest_+3A_minrank">minRank</code></td>
<td>
<p>minimum possible rank of the threshold.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<p>LR: observed value of the llr test.
</p>


<h3>References</h3>


<p>Bee M (2022).
&ldquo;On discriminating between lognormal and Pareto tail: an unsupervised mixture-based approach.&rdquo;
<em>Advances in Data Analysis and Classification</em>.
<a href="https://doi.org/10.1007/s11634-022-00497-4">doi:10.1007/s11634-022-00497-4</a>.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 100
muNull = mean(log(TN2016))
sigmaNull = sd(log(TN2016))
minRank = 90
res = LPtest(1,n,muNull,sigmaNull,minRank)
</code></pre>

<hr>
<h2 id='MLEBoot'>Bootstrap standard errors for the estimators of a lognormal-Pareto mixture</h2><span id='topic+MLEBoot'></span>

<h3>Description</h3>

<p>This function draws a bootstrap sample and uses it to estimate the parameters of a lognormal-Pareto mixture distribution. Since this is typically called by LPfit, see the help of LPfit for examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLEBoot(x, y, minRank, p0, alpha0, mu0, Psi0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MLEBoot_+3A_x">x</code></td>
<td>
<p>list: sequence of integers 1,...,K, where K is the mumber of datasets. Set x = 1 in case
of a single dataset.</p>
</td></tr>
<tr><td><code id="MLEBoot_+3A_y">y</code></td>
<td>
<p>numerical vector: observed sample.</p>
</td></tr>
<tr><td><code id="MLEBoot_+3A_minrank">minRank</code></td>
<td>
<p>positive integer: minimum possible rank of the threshold.</p>
</td></tr>
<tr><td><code id="MLEBoot_+3A_p0">p0</code></td>
<td>
<p>(0&lt;p0&lt;1): starting value of the mixing weight.</p>
</td></tr>
<tr><td><code id="MLEBoot_+3A_alpha0">alpha0</code></td>
<td>
<p>non-negative scalar: starting value of the Pareto shape parameter.</p>
</td></tr>
<tr><td><code id="MLEBoot_+3A_mu0">mu0</code></td>
<td>
<p>scalar: starting value of the log-expectation of the lognormal distribution on the log scale.</p>
</td></tr>
<tr><td><code id="MLEBoot_+3A_psi0">Psi0</code></td>
<td>
<p>non-negative scalar: starting value of the log-variance of the lognormal distribution on the log scale.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>At each bootstrap replication, the mixture is estimated with thresholds equal to ys(minRank), ys(minRank+1),..., ys(n),
where n is the sample size and ys is the sample in ascending order. The function is typically called by LPfit (see the example below).
</p>


<h3>Value</h3>

<p>Estimated parameters obtained from a bootstrap sample.
</p>


<h3>References</h3>

<p>Bee, M. (2022), “On discriminating between lognormal and Pareto tail: a mixture-based approach”,
Advances in Data Analysis and Classification, https://doi.org/10.1007/s11634-022-00497-4
</p>

<hr>
<h2 id='par_logn_mix_known'>Estimate the parameters of a lognormal-Pareto density, assuming a known threshold</h2><span id='topic+par_logn_mix_known'></span>

<h3>Description</h3>

<p>This function estimates the parameters of a Pareto and a lognormal density, assuming a known threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>par_logn_mix_known(y, prior1, th, alpha, mu, sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="par_logn_mix_known_+3A_y">y</code></td>
<td>
<p>non-negative numerical vector: random sample from the mixture.</p>
</td></tr>
<tr><td><code id="par_logn_mix_known_+3A_prior1">prior1</code></td>
<td>
<p>scalar (0&lt;prior1&lt;1): starting value of the prior probability.</p>
</td></tr>
<tr><td><code id="par_logn_mix_known_+3A_th">th</code></td>
<td>
<p>positive scalar: threshold.</p>
</td></tr>
<tr><td><code id="par_logn_mix_known_+3A_alpha">alpha</code></td>
<td>
<p>non-negative scalar: starting value of the Pareto shape parameter.</p>
</td></tr>
<tr><td><code id="par_logn_mix_known_+3A_mu">mu</code></td>
<td>
<p>scalar: starting value of the lognormal parameter mu.</p>
</td></tr>
<tr><td><code id="par_logn_mix_known_+3A_sigma">sigma</code></td>
<td>
<p>positive scalar: starting value of the lognormal parameter sigma.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<p>xmin: estimated threshold.
</p>
<p>prior: estimated mixing weight.
</p>
<p>post: matrix of posterior probabilities.
</p>
<p>alpha: estimated Pareto shape parameter.
</p>
<p>mu: estimated expectation of the lognormal distribution on the lognormal scale.
</p>
<p>sigma: estimated standard deviation of the lognormal distribution on the lognormal scale.
</p>
<p>loglik: maximized log-likelihood.
</p>
<p>nit: number of iterations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mixFit &lt;- par_logn_mix_known(TN2016, .5, 4700, 3, 7, 1.2)
</code></pre>

<hr>
<h2 id='ParallelTest'>Testing for a Pareto tail</h2><span id='topic+ParallelTest'></span>

<h3>Description</h3>

<p>This function computes the bootstrap test for the null hypothesis of
a pure lognormal distribution versus the alternative of a lognormal-Pareto
mixture. Implemented via parallel computing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ParallelTest(nboot, y, obsTest, minRank)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ParallelTest_+3A_nboot">nboot</code></td>
<td>
<p>number of bootstrap replications.</p>
</td></tr>
<tr><td><code id="ParallelTest_+3A_y">y</code></td>
<td>
<p>observed data.</p>
</td></tr>
<tr><td><code id="ParallelTest_+3A_obstest">obsTest</code></td>
<td>
<p>value of the test statistics computed with the data under analysis.</p>
</td></tr>
<tr><td><code id="ParallelTest_+3A_minrank">minRank</code></td>
<td>
<p>minimum possible rank of the threshold.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<p>LR: nboot simulated values of the llr test under the null hypothesis.
</p>
<p>pval: p-value of the test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>minRank = 90
mixFit &lt;- LPfit(TN2016,minRank,0)
ell1 &lt;- mixFit$loglik
estNull &lt;- c(mean(log(TN2016)),sd(log(TN2016)))
ellNull &lt;- sum(log(dlnorm(TN2016,estNull[1],estNull[2])))
obsTest &lt;- 2*(ell1-ellNull)
nboot = 2
TestRes = ParallelTest(nboot,TN2016,obsTest,minRank)
</code></pre>

<hr>
<h2 id='rLnormParMix'>Random number simulation for a mixture of a lognormal and a Pareto r.v.</h2><span id='topic+rLnormParMix'></span>

<h3>Description</h3>

<p>This function simulates random numbers for a mixture of a lognormal and a Pareto r.v.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rLnormParMix(n, pi, mu, sigma, xmin, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rLnormParMix_+3A_n">n</code></td>
<td>
<p>positive integer: number of simulated random numbers.</p>
</td></tr>
<tr><td><code id="rLnormParMix_+3A_pi">pi</code></td>
<td>
<p>scalar, 0 &lt; pi &lt; 1: mixing weight.</p>
</td></tr>
<tr><td><code id="rLnormParMix_+3A_mu">mu</code></td>
<td>
<p>scalar: expected value of the lognormal distribution on the log scale.</p>
</td></tr>
<tr><td><code id="rLnormParMix_+3A_sigma">sigma</code></td>
<td>
<p>positive scalar: standard deviation of the lognormal distribution on the log scale.</p>
</td></tr>
<tr><td><code id="rLnormParMix_+3A_xmin">xmin</code></td>
<td>
<p>positive scalar: threshold.</p>
</td></tr>
<tr><td><code id="rLnormParMix_+3A_alpha">alpha</code></td>
<td>
<p>non-negative scalar: Pareto shape parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>n iid random numbers from the lognormal-Pareto distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ySim &lt;- rLnormParMix(100,.5,0,1,4,1.5)
</code></pre>

<hr>
<h2 id='rpareto'>Random number generation for a Pareto r.v.</h2><span id='topic+rpareto'></span>

<h3>Description</h3>

<p>This function simulates random numbers for a Pareto r.v.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpareto(n, xmin, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpareto_+3A_n">n</code></td>
<td>
<p>positive integer: number of simulated random numbers.</p>
</td></tr>
<tr><td><code id="rpareto_+3A_xmin">xmin</code></td>
<td>
<p>positive scalar: Pareto scale parameter.</p>
</td></tr>
<tr><td><code id="rpareto_+3A_alpha">alpha</code></td>
<td>
<p>non-negative scalar: Pareto shape parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>n iid random numbers from the Pareto distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ySim &lt;- rpareto(5,4,1.5)
</code></pre>

<hr>
<h2 id='TN2016'>Number of employees in year 2016 in all the firms of the Trento district</h2><span id='topic+TN2016'></span>

<h3>Description</h3>

<p>A dataset containing the number of employees in year 2016 in all the firms
of the Trento district in Northern Italy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TN2016
</code></pre>


<h3>Format</h3>

<p>A numerical vector with 183 rows and 1 column.
</p>


<h3>Source</h3>

<p><a href="https://dati.trentino.it/">https://dati.trentino.it/</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
