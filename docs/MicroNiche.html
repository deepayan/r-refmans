<!DOCTYPE html><html><head><title>Help for package MicroNiche</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MicroNiche}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#df'>
<p>Data frame for package MicroNiche</p></a></li>
<li><a href='#feinsingers.PS'>
<p>Feinsinger's proportional similarity index</p></a></li>
<li><a href='#hurlberts.Bn'>
<p>Hurlbert's niche breadth index</p></a></li>
<li><a href='#levins.Bn'>
<p>Levins' niche breadth index</p></a></li>
<li><a href='#levins.overlap'>
<p>Levin's niche overlap index</p></a></li>
<li><a href='#MicroNiche-package'>
<p>Microbial Niche Measurements</p></a></li>
<li><a href='#proportional.overlap'>
<p>Proportional similarity overlap index</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Microbial Niche Measurements</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>ggplot2, reshape2, stats</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-01-19</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Damien Finn &lt;damien.finn@uqconnect.edu.au&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Measures niche breadth and overlap of microbial taxa from large matrices.
			Niche breadth measurements include Levins' niche breadth (Bn) index, Hurlbert's Bn 
			and Feinsinger's proportional similarity (PS) index. (Feinsinger, P., Spears, E.E.,
			Poole, R.W. (1981) &lt;<a href="https://doi.org/10.2307%2F1936664">doi:10.2307/1936664</a>&gt;). Niche overlap measurements include 
			Levin's Overlap (Ludwig, J.A. and Reynolds, J.F. (1988, ISBN:0471832359)) and a Jaccard 
			similarity index of Feinsinger's PS values between taxa pairs, as Proportional Overlap. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-01-19 01:15:03 UTC; damienfinn</td>
</tr>
<tr>
<td>Author:</td>
<td>Damien Finn [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-01-30 09:40:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='df'>
Data frame for package MicroNiche
</h2><span id='topic+df'></span>

<h3>Description</h3>

<p>This data frame consists of taxa (rows) by samples (columns). Taxa are separated into six
distributions (D1 - 6) with 10 'species' per distribution. Samples are separated into four
'environments' (R1 - 4) with 10 samples per environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("df")</code></pre>


<h3>Format</h3>

<p>A data frame with 60 observations on the following 41 variables.
</p>

<dl>
<dt><code>Taxon</code></dt><dd><p>a factor with levels <code>D1S1</code> <code>D1S10</code> <code>D1S2</code> <code>D1S3</code> <code>D1S4</code> <code>D1S5</code> <code>D1S6</code> <code>D1S7</code> <code>D1S8</code> <code>D1S9</code> <code>D2S1</code> <code>D2S10</code> <code>D2S2</code> <code>D2S3</code> <code>D2S4</code> <code>D2S5</code> <code>D2S6</code> <code>D2S7</code> <code>D2S8</code> <code>D2S9</code> <code>D3S1</code> <code>D3S10</code> <code>D3S2</code> <code>D3S3</code> <code>D3S4</code> <code>D3S5</code> <code>D3S6</code> <code>D3S7</code> <code>D3S8</code> <code>D3S9</code> <code>D4S1</code> <code>D4S10</code> <code>D4S2</code> <code>D4S3</code> <code>D4S4</code> <code>D4S5</code> <code>D4S6</code> <code>D4S7</code> <code>D4S8</code> <code>D4S9</code> <code>D5S1</code> <code>D5S10</code> <code>D5S2</code> <code>D5S3</code> <code>D5S4</code> <code>D5S5</code> <code>D5S6</code> <code>D5S7</code> <code>D5S8</code> <code>D5S9</code> <code>D6S1</code> <code>D6S10</code> <code>D6S2</code> <code>D6S3</code> <code>D6S4</code> <code>D6S5</code> <code>D6S6</code> <code>D6S7</code> <code>D6S8</code> <code>D6S9</code></p>
</dd>
<dt><code>R1S1</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R1S2</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R1S3</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R1S4</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R1S5</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R1S6</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R1S7</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R1S8</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R1S9</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R1S10</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R2S1</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R2S2</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R2S3</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R2S4</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R2S5</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R2S6</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R2S7</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R2S8</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R2S9</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R2S10</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R3S1</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R3S2</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R3S3</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R3S4</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R3S5</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R3S6</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R3S7</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R3S8</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R3S9</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R3S10</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R4S1</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R4S2</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R4S3</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R4S4</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R4S5</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R4S6</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R4S7</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R4S8</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R4S9</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>R4S10</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>An object of class &quot;data.frame&quot; of 60 rows x 40 columns, representing taxa and samples,
respectively.
</p>


<h3>Source</h3>

<p>Generated in silico to compare taxa of known distributions: D1 are generalists roughly
in equal abundance across the four environments. D2 decrease linearly across the four 
environments. D3 are specialists that decrease exponentially across the four environments.
D4 are specialists unique to one of the four environments. D5 are specialists in environments
two and four, with no relationship with an environmental gradient supplied in the vignette. 
Finally, D6 represent low, spurious counts haphazardly distributed across all samples often 
present in microbial count tables. 
</p>


<h3>References</h3>

<p>NA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(df)
</code></pre>

<hr>
<h2 id='feinsingers.PS'>
Feinsinger's proportional similarity index
</h2><span id='topic+feinsingers.PS'></span>

<h3>Description</h3>

<p>This index is a measurement of proportional similarity (PS) of a taxon in relation to an 
environmental parameter, such as pH or temperature. A value of 0 indicates an inverse 
relationship between taxon abundance and the environmental parameter, whilst 1 indicates a 
positive relationship between taxon abundance and the environmental parameter. A value of 
0.5 indicates no relationship.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>feinsingers.PS(df, R, sampleInfo, envInfo, q = 1.65)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="feinsingers.PS_+3A_df">df</code></td>
<td>

<p>A matrix of taxa (rows) by samples (columns) as discrete counts per sample. Col 1 must be
a taxon identifier. 
</p>
</td></tr>
<tr><td><code id="feinsingers.PS_+3A_r">R</code></td>
<td>

<p>The number of different environments being compared.
</p>
</td></tr>
<tr><td><code id="feinsingers.PS_+3A_sampleinfo">sampleInfo</code></td>
<td>

<p>A categorical variable identifying which samples correspond to which environment.
</p>
</td></tr>
<tr><td><code id="feinsingers.PS_+3A_envinfo">envInfo</code></td>
<td>

<p>A quantitative variable of some environmental parameter measured per sample.
</p>
</td></tr>
<tr><td><code id="feinsingers.PS_+3A_q">q</code></td>
<td>

<p>A coefficient for the LOQ, set to 1.65. Decreasing or increasing q will affect which taxa
are flagged as being below the LOQ.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Taxon inputs must be as discrete counts across samples, with a taxon identifier in column 1. 
This function also performs null model testing against a distribution of PS generated from 
R random proportions permuted 999 times. This allows the user to perform significance testing 
and to determine a probability that the taxa PS differs from the null PS. The output includes 
each taxon's PS, a P value of significance testing against the null model distribution, and 
a Benjamin-Hochberg adjusted P value to account for false discovery rate. 
</p>
<p>A plot of the null distribution with 0.05 and 0.95 quantiles highlighted as red dotted lines 
is also provided. 
</p>
<p>Finally, this function also calculates the limit of quantification (LOQ) to identify taxa 
whose niche cannot be confidently measured. A plot of log abundance x taxon rank is provided
to visualise the distribution of the data, a fitted lognormal taxa rank model, and the 
LOQ determined based on the standard deviation of the lognormal model.  
</p>
<p>Feinsinger's PS is calculated as follows:
PS[j] = 1 - 0.5*sum(|p[i] - r[i]|)
whereby p[i] is the proportion of taxon j in environment i and r[i] is the proportion of the
environmental parameter in i.
</p>
<p>This function depends on ggplot2 to generate a plot of the null distribution and reshape2
to identify the taxa below the LOQ.
</p>


<h3>Value</h3>

<p>An object of class &quot;data.frame&quot; that gives the PS, P value and adjusted P value for each taxon.
A column noting taxa that fall below the LOQ are identified as T.
</p>


<h3>Note</h3>

<p>The null model testing becomes increasingly robust with increasing R. If R == 2 the results
should be interpreted with caution.
</p>


<h3>Author(s)</h3>

<p>Damien Finn
</p>


<h3>References</h3>

<p>Feinsinger et al. 1981. A simple measure of niche breadth. Ecology 62(1):27-32
</p>


<h3>See Also</h3>

<p>proportional.overlap
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(df)
sampleInfo &lt;- c(rep("R1",10), rep("R2",10), rep("R3",10), rep("R4",10))
pH.grad &lt;- c(2.1, 2.2, 2, 1.9, 2.1, 1.8, 1.9, 2, 2.1, 1.9, 3.5, 3.6, 3.5, 
             3.4, 3.6, 3.5, 3.5, 3.4, 3.7, 3.4, 6.6, 6.5, 6.4, 6.8, 7, 6.6, 
             6.8, 6.9, 7, 7.1, 8, 8.2, 7.9, 8.1, 7.8, 7.9, 8.3, 8.2, 8.1, 7.9) 
res &lt;- feinsingers.PS(df, 4, sampleInfo, pH.grad)
</code></pre>

<hr>
<h2 id='hurlberts.Bn'>
Hurlbert's niche breadth index
</h2><span id='topic+hurlberts.Bn'></span>

<h3>Description</h3>

<p>This index is a measurement of niche breadth (Bn) of a taxon in relation to an environmental parameter,
such as pH or temperature. A value of 0 indicates an inverse relationship between taxon 
abundance and the environmental parameter, whilst 1 indicates a positive relationship between
taxon abundance and the environmental parameter. A value of 0.5 indicates no relationship.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hurlberts.Bn(df, R, sampleInfo, envInfo, q = 1.65)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hurlberts.Bn_+3A_df">df</code></td>
<td>

<p>A matrix of taxa (rows) by samples (columns) as discrete counts per sample. Col 1 must be
a taxon identifier. 
</p>
</td></tr>
<tr><td><code id="hurlberts.Bn_+3A_r">R</code></td>
<td>

<p>The number of different environments being compared.
</p>
</td></tr>
<tr><td><code id="hurlberts.Bn_+3A_sampleinfo">sampleInfo</code></td>
<td>

<p>A categorical variable identifying which samples correspond to which environment.
</p>
</td></tr>
<tr><td><code id="hurlberts.Bn_+3A_envinfo">envInfo</code></td>
<td>

<p>A quantitative variable of some environmental parameter measured per sample.
</p>
</td></tr>
<tr><td><code id="hurlberts.Bn_+3A_q">q</code></td>
<td>

<p>A coefficient for the LOQ, set to 1.65. Decreasing or increasing q will affect which taxa
are flagged as being below the LOQ.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Taxon inputs must be as discrete counts across samples, with a taxon identifier in column 1. 
This function also performs null model testing against a distribution of Bn generated from 
R random proportions permuted 999 times. This allows the user to perform significance testing 
and to determine a probability that the taxa Bn differs from the null Bn. The output includes 
each taxon's Bn, a P value of significance testing against the null model distribution, and a 
Benjamin-Hochberg adjusted P value to account for false discovery rate. 
</p>
<p>A plot of the null distribution with 0.05 and 0.95 quantiles highlighted as red dotted lines 
is also provided. 
</p>
<p>Finally, this function also calculates the limit of quantification (LOQ) to identify taxa 
whose niche cannot be confidently measured. A plot of log abundance x taxon rank is provided
to visualise the distribution of the data, a fitted lognormal taxa rank model, and the 
LOQ determined based on the standard deviation of the lognormal model. 
</p>
<p>Hurlbert's niche breadth is calculated as follows:
Bn[j] = 1/sum(p[i]^2/r[i]) 
whereby p[i] is the proportion of taxon j in environment i and r[i] is the proportion of the
environmental parameter in i.
</p>
<p>This function depends on ggplot2 to generate a plot of the null distribution and reshape2
to identify the taxa below the LOQ.
</p>


<h3>Value</h3>

<p>An object of class &quot;data.frame&quot; that gives the Bn, P value and adjusted P value for each taxon.
A column noting taxa that fall below the LOQ are identified as T.
</p>


<h3>Note</h3>

<p>The null model testing becomes increasingly robust with increasing R. If R == 2 the results
should be interpreted with caution. 
</p>


<h3>Author(s)</h3>

<p>Damien Finn
</p>


<h3>References</h3>

<p>Feinsinger et al. 1981. A simple measure of niche breadth. Ecology 62(1):27-32
</p>


<h3>See Also</h3>

<p>feinsingers.PS
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(df)
sampleInfo &lt;- c(rep("R1",10), rep("R2",10), rep("R3",10), rep("R4",10))
pH.grad &lt;- c(2.1, 2.2, 2, 1.9, 2.1, 1.8, 1.9, 2, 2.1, 1.9, 3.5, 3.6, 3.5, 
             3.4, 3.6, 3.5, 3.5, 3.4, 3.7, 3.4, 6.6, 6.5, 6.4, 6.8, 7, 6.6, 
             6.8, 6.9, 7, 7.1, 8, 8.2, 7.9, 8.1, 7.8, 7.9, 8.3, 8.2, 8.1, 7.9) 
res &lt;- hurlberts.Bn(df, 4, sampleInfo, pH.grad)
</code></pre>

<hr>
<h2 id='levins.Bn'>
Levins' niche breadth index
</h2><span id='topic+levins.Bn'></span>

<h3>Description</h3>

<p>This index is a measurement of niche breadth (Bn) of a taxon weighted by the number of differing
environments (R), whereby a value of 1 indicates generalist taxa that are equally abundant
across environments, and 0 indicates specialist taxa that favour specific environments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>levins.Bn(df, R, sampleInfo, q = 1.65)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="levins.Bn_+3A_df">df</code></td>
<td>

<p>A matrix of taxa (rows) by samples (columns) as discrete counts per sample. Col 1 must be
a taxon identifier.
</p>
</td></tr>
<tr><td><code id="levins.Bn_+3A_r">R</code></td>
<td>

<p>The number of different environments being compared.
</p>
</td></tr>
<tr><td><code id="levins.Bn_+3A_sampleinfo">sampleInfo</code></td>
<td>

<p>A categorical variable identifying which samples correspond to which environment.
</p>
</td></tr>
<tr><td><code id="levins.Bn_+3A_q">q</code></td>
<td>

<p>A coefficient for the LOQ, set to 1.65. Decreasing or increasing q will affect which taxa
are flagged as being below the LOQ.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Taxon inputs must be as discrete counts across samples, with a taxon identifier in column 1.  
This function also performs null model testing against a distribution of Bn generated from 
R random proportions permuted 999 times. This allows the user to perform significance testing 
and to determine a probability that the taxa Bn differs from the null Bn. The output includes 
each taxon's Bn, a P value of significance testing against the null model distribution, and a 
Benjamin-Hochberg adjusted P value to account for false discovery rate. 
</p>
<p>A plot of the null distribution with 0.05 and 0.95 quantiles highlighted as red dotted lines 
is also provided. 
</p>
<p>Finally, this function also calculates the limit of quantification (LOQ) to identify taxa 
whose niche cannot be confidently measured. A plot of log abundance x taxon rank is provided
to visualise the distribution of the data, a fitted lognormal taxa rank model, and the 
LOQ determined based on the standard deviation of the lognormal model. 
</p>
<p>Levin's niche breadth is calculated as follows:
Bn[j] = (1/R)/sum(p[i]^2) 
whereby R is the number of differing environments and p[i] is the proportion of taxon j in
environment i. 
</p>
<p>This function depends on ggplot2 to generate a plot of the null distribution and reshape2
to identify the taxa below the LOQ.
</p>


<h3>Value</h3>

<p>An object of class &quot;data.frame&quot; that gives the Bn, P value and adjusted P value for each taxon.
A column noting taxa that fall below the LOQ are identified as T.
</p>


<h3>Note</h3>

<p>The null model testing becomes increasingly robust with increasing R. If R == 2 the results
should be interpreted with caution. 
</p>


<h3>Author(s)</h3>

<p>Damien Finn
</p>


<h3>References</h3>

<p>Feinsinger et al. 1981. A simple measure of niche breadth. Ecology 62(1):27-32
</p>


<h3>See Also</h3>

<p>levins.overlap
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(df)
sampleInfo &lt;- c(rep("R1",10), rep("R2",10), rep("R3",10), rep("R4",10))
res &lt;- levins.Bn(df, 4, sampleInfo)
</code></pre>

<hr>
<h2 id='levins.overlap'>
Levin's niche overlap index
</h2><span id='topic+levins.overlap'></span>

<h3>Description</h3>

<p>This index is a measurement of the overlap between pairs of taxa across samples. A value 
of 1 indicates perfect overlap, and 0 indicates no overlap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>levins.overlap(df, q = 1.65)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="levins.overlap_+3A_df">df</code></td>
<td>

<p>A matrix of taxa (rows) by samples (columns) as discrete counts per sample. Col 1 must be
a taxon identifier.
</p>
</td></tr>
<tr><td><code id="levins.overlap_+3A_q">q</code></td>
<td>

<p>A coefficient for the LOQ, set to 1.65. Decreasing or increasing q will affect which taxa
are flagged as being below the LOQ.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Taxon inputs must be as discrete counts across samples, with a taxon identifier in column 1.  
The output is a matrix of paired taxon overlap indices. Specifically, Levin's Overlap (LO) 
indices of LO[1,2] are rows and LO[2,1] are columns, for taxa 1 and 2. 
</p>
<p>Levin's overlap is calculated as follows:
LO[i,j] = sum(p[i]*p[j])/sum(p[i]^2)
whereby p[i] is the proportion of taxon i per sample and p[j] is the proportion of taxon j
per sample. 
</p>
<p>Taxa below the LOQ are flagged with an asterisk.
</p>
<p>This function depends on reshape2 to produce a matrix of overlap comparisons.
</p>


<h3>Value</h3>

<p>An object of class &quot;data.frame&quot; that gives LO[1,2] as rows and LO[2,1] as columns.
</p>


<h3>Note</h3>

<p>NA
</p>


<h3>Author(s)</h3>

<p>Damien Finn
</p>


<h3>References</h3>

<p>Ludwig and Reynolds. 1988 Statistical Ecology. Wiley and Sons, Milton Australia
</p>


<h3>See Also</h3>

<p>levins.Bn
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(df)
overlapdf &lt;- df[48:53,]
res &lt;- levins.overlap(overlapdf)

</code></pre>

<hr>
<h2 id='MicroNiche-package'>
Microbial Niche Measurements
</h2><span id='topic+MicroNiche-package'></span><span id='topic+MicroNiche'></span>

<h3>Description</h3>

<p>Measures niche breadth and overlap of microbial taxa from large matrices.
Niche breadth measurements include Levins' niche breadth (Bn) index, Hurlbert's Bn 
and Feinsinger's proportional similarity (PS) index. (Feinsinger, P., Spears, E.E.,
Poole, R.W. (1981) &lt;doi:10.2307/1936664&gt;). Niche overlap measurements include 
Levin's Overlap (Ludwig, J.A. and Reynolds, J.F. (1988, ISBN:0471832359)) and a Jaccard 
similarity index of Feinsinger's PS values between taxa pairs, as Proportional Overlap. 
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> MicroNiche</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Microbial Niche Measurements</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> ggplot2, reshape2, stats</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-01-19</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> person("Damien",
           "Finn",
           role = c("aut", "cre"),
           email = "damien.finn@uqconnect.edu.au")</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Damien Finn &lt;damien.finn@uqconnect.edu.au&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Measures niche breadth and overlap of microbial taxa from large matrices.
			Niche breadth measurements include Levins' niche breadth (Bn) index, Hurlbert's Bn 
			and Feinsinger's proportional similarity (PS) index. (Feinsinger, P., Spears, E.E.,
			Poole, R.W. (1981) &lt;doi:10.2307/1936664&gt;). Niche overlap measurements include 
			Levin's Overlap (Ludwig, J.A. and Reynolds, J.F. (1988, ISBN:0471832359)) and a Jaccard 
			similarity index of Feinsinger's PS values between taxa pairs, as Proportional Overlap. </td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Damien Finn [aut, cre]</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index of help topics:
</p>
<pre>
MicroNiche-package      Microbial Niche Measurements
df                      Data frame for package MicroNiche
feinsingers.PS          Feinsinger's proportional similarity index
hurlberts.Bn            Hurlbert's niche breadth index
levins.Bn               Levins' niche breadth index
levins.overlap          Levin's niche overlap index
proportional.overlap    Proportional similarity overlap index
</pre>


<h3>Author(s)</h3>

<p>NA
</p>
<p>Maintainer: Damien Finn &lt;damien.finn@uqconnect.edu.au&gt;
</p>


<h3>References</h3>

<p>Feinsinger et al. 1981. A simple measure of niche breadth. Ecology 62(1):27-32
</p>
<p>Ludwig and Reynolds. 1988. Statistical Ecology. Wiley and Sons, Milton Australia
</p>


<h3>See Also</h3>

<p>levins.Bn
hurlberts.Bn
feinsingers.PS
levins.overlap
proportional.overlap
</p>


<h3>Examples</h3>

<pre><code class='language-R'>NA
</code></pre>

<hr>
<h2 id='proportional.overlap'>
Proportional similarity overlap index
</h2><span id='topic+proportional.overlap'></span>

<h3>Description</h3>

<p>This index is a measurement of the overlap of proportional similarity (PS) indices between 
pairs of taxa across samples. As the PS is a niche breadth index that measures the similarity
between a taxon's distribution and an environmental parameter, the PS overlap also considers
environmental information. A value of 1 indicates perfect overlap, and 0 indicates no overlap. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>proportional.overlap(df, sampleInfo, envInfo, q = 1.65)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="proportional.overlap_+3A_df">df</code></td>
<td>

<p>A matrix of taxa (rows) by samples (columns) as discrete counts per sample. Col 1 must be
a taxon identifier.
</p>
</td></tr>
<tr><td><code id="proportional.overlap_+3A_sampleinfo">sampleInfo</code></td>
<td>

<p>A categorical variable identifying which samples correspond to which environment.
</p>
</td></tr>
<tr><td><code id="proportional.overlap_+3A_envinfo">envInfo</code></td>
<td>

<p>A quantitative variable of some environmental parameter measured per sample.
</p>
</td></tr>
<tr><td><code id="proportional.overlap_+3A_q">q</code></td>
<td>

<p>A coefficient for the LOQ, set to 1.65. Decreasing or increasing q will affect which taxa
are flagged as being below the LOQ.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Taxon inputs must be as discrete counts across samples, with a taxon identifier in column 1. 
The output is a matrix of paired taxon overlap indices. Specifically, Proportional Overlap 
(PO) indices of PO[1,2] are rows and PO[2,1] are columns, for taxa 1 and 2, however these 
values are identical. Feinsinger's PS is calculated as per feinsingers.PS. 
</p>
<p>Proportional overlap is calculated as follows:
PO[i,j] = 1 - (|PS[i] - PS[j]|)/(PS[i] + PS[j])
whereby PS[i] is the PS of taxon i and PS[j] is the PS of taxon j. 
</p>
<p>Taxa below the LOQ are flagged with an asterisk.
</p>
<p>This function depends on reshape2 to produce a matrix of overlap comparisons.
</p>


<h3>Value</h3>

<p>An object of class &quot;data.frame&quot; that gives PO[1,2] as rows and PO[2,1] as columns.
</p>


<h3>Note</h3>

<p>NA
</p>


<h3>Author(s)</h3>

<p>Damien Finn
</p>


<h3>References</h3>

<p>Feinsinger et al. 1981. A simple measure of niche breadth. Ecology 62(1):27-32
</p>


<h3>See Also</h3>

<p>feinsingers.PS
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(df)
overlapdf &lt;- df[48:53,]
sampleInfo &lt;- c(rep("R1",10), rep("R2",10), rep("R3",10), rep("R4",10))
pH.grad &lt;- c(2.1, 2.2, 2, 1.9, 2.1, 1.8, 1.9, 2, 2.1, 1.9, 3.5, 3.6, 3.5, 
             3.4, 3.6, 3.5, 3.5, 3.4, 3.7, 3.4, 6.6, 6.5, 6.4, 6.8, 7, 6.6, 
             6.8, 6.9, 7, 7.1, 8, 8.2, 7.9, 8.1, 7.8, 7.9, 8.3, 8.2, 8.1, 7.9) 
res &lt;- proportional.overlap(overlapdf, sampleInfo, pH.grad)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
