<!DOCTYPE html><html><head><title>Help for package RMediation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RMediation}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ci'><p>CI for a nonlinear function of coefficients estimates</p></a></li>
<li><a href='#mbco'><p>Model-based Constrained Optimization (MBCO) Chi-squared Test</p></a></li>
<li><a href='#medci'><p>Confidence Interval for the Mediated Effect</p></a></li>
<li><a href='#memory_exp'><p>Memory Experiment Data Description from MacKinnon et al., 2018</p></a></li>
<li><a href='#pMC'><p>Probability (percentile) for the Monte Carlo Sampling Distribution of a nonlinear function of coefficients estimates</p></a></li>
<li><a href='#pprodnormal'><p>Percentile for the Distribution of Product of Two Normal Variables</p></a></li>
<li><a href='#qMC'><p>Quantile for the Monte Carlo Sampling Distribution of a nonlinear function of coefficients estimates</p></a></li>
<li><a href='#qprodnormal'><p>Quantile for the Distribution of Product of Two Normal Variables</p></a></li>
<li><a href='#RMediation-package'><p>RMediation: Mediation Analysis Confidence Intervals</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Mediation Analysis Confidence Intervals</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-04-28</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), base (&ge; 3.5.0), stats (&ge; 3.5.0), graphics (&ge;
3.5.0), methods (&ge; 3.5.0), lavaan (&ge; 0.5-20), e1071 (&ge;
1.6-7), OpenMx (&ge; 2.13), MASS (&ge; 7.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>modelr (&ge; 0.1.4), doParallel (&ge; 1.0.0), foreach (&ge; 1.5.0),
iterators (&ge; 1.0.0), stringr(&ge; 1.4.0), grDevices (&ge; 3.5)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Description:</td>
<td>We provide functions to compute confidence intervals for a well-defined nonlinear function of the model parameters (e.g., product of k coefficients) in single&ndash;level and
    multilevel structural equation models. It also computes a chi-square test statistic for a function of indirect effects. 
    'Tofighi', D. and 'MacKinnon', D. P. (2011). 'RMediation' An R package for mediation analysis confidence intervals. Behavior Research Methods, 43, 692&ndash;700. &lt;<a href="https://doi.org/10.3758%2Fs13428-011-0076-x">doi:10.3758/s13428-011-0076-x</a>&gt;.
    'Tofighi', D. (2020). Bootstrap Model-Based Constrained Optimization Tests of Indirect Effects. Frontiers in Psychology, 10, 2989. &lt;<a href="https://doi.org/10.3389%2Ffpsyg.2019.02989">doi:10.3389/fpsyg.2019.02989</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-12 02:41:54 UTC; davoodtofighi</td>
</tr>
<tr>
<td>Author:</td>
<td>Davood Tofighi <a href="https://orcid.org/0000-0001-8523-7776"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Davood Tofighi &lt;dtofighi@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-12 04:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='ci'>CI for a nonlinear function of coefficients estimates</h2><span id='topic+ci'></span>

<h3>Description</h3>

<p>This function returns a (<code class="reqn">1-\alpha</code>)% confidence interval (CI) for a
well&ndash;defined nonlinear function of the coefficients in single&ndash;level and
multilevel structural equation models. The <code>ci</code> function uses the Monte
Carlo (<code>type="MC"</code>) and the asymptotic normal theory
(<code>type="asymp"</code>) with the multivariate delta standard error
(Asymptotic&ndash;Delta) method (Sobel, 1982) to compute a CI. In addition, for
each of the methods, when a user specifies <code>plot=TRUE</code> and
<code>plotCI=TRUE</code>, a plot of the sampling distribution of the quantity of
interest in the <code>quant</code> argument and an overlaid plot of the CI will be
produced. When <code>type="all"</code> and <code>plot=TRUE</code>, two overlaid plots of
the sampling distributions corresponding to each method will be produced;
when <code>plotCI=TRUE</code>, then the overlaid plots of the CIs for both methods
will be displayed as well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ci(
  mu,
  Sigma,
  quant,
  alpha = 0.05,
  type = "MC",
  plot = FALSE,
  plotCI = FALSE,
  n.mc = 1e+06,
  H0 = FALSE,
  mu0 = NULL,
  Sigma0 = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ci_+3A_mu">mu</code></td>
<td>
<p>(1) a <a href="base.html#topic+vector">vector</a> of means (e.g., coefficient estimates) for the
normal random variables. A user can assign a name to each mean value, e.g.,
<code>mu=c(b1=.1,b2=3)</code>; otherwise, the coefficient names are assigned
automatically as follows: <code>b1,b2,...</code>. Or, (2) a lavaan object.</p>
</td></tr>
<tr><td><code id="ci_+3A_sigma">Sigma</code></td>
<td>
<p>either a covariance matrix or a <a href="base.html#topic+vector">vector</a> that stacks all
the columns of the lower triangle variance&ndash;covariance matrix one
underneath the other.</p>
</td></tr>
<tr><td><code id="ci_+3A_quant">quant</code></td>
<td>
<p>quantity of interest, which is a nonlinear/linear function of
the model parameters. Argument <code>quant</code> is a <a href="stats.html#topic+formula">formula</a> that
<strong>must</strong> start with the symbol &quot;tilde&quot; (<code>~</code>): e.g.,
<code>~b1*b2*b3*b4</code>. The names of coefficients must conform to the names
provided in the argument <code>mu</code> or to the default names, i.e.,
<code>b1,b2,...</code>.</p>
</td></tr>
<tr><td><code id="ci_+3A_alpha">alpha</code></td>
<td>
<p>significance level for the CI. The default value is .05.</p>
</td></tr>
<tr><td><code id="ci_+3A_type">type</code></td>
<td>
<p>method used to compute a CI. It takes on the values <code>"MC"</code>
(default) for Monte Carlo, <code>"asymp"</code> for Asymptotic&ndash;Delta, or
<code>"all"</code> that produces CIs using both methods.</p>
</td></tr>
<tr><td><code id="ci_+3A_plot">plot</code></td>
<td>
<p>when <code>TRUE</code>, plot the approximate sampling distribution of
the quantity of interest using the specified method(s) in the argument
<code>type</code>. The default value is <code>FALSE</code>. When <code>type="all"</code>,
superimposed density plots generated by both methods are displayed.</p>
</td></tr>
<tr><td><code id="ci_+3A_plotci">plotCI</code></td>
<td>
<p>when <code>TRUE</code>, overlays a CI plot with error bars on the
density plot of the sampling distribution of <code>quant</code>. When
<code>type="all"</code>, the superimposed CI plots generated by both methods are
added to the density plots. Note that to obtain a CI plot, one must also
specify <code>plot="TRUE"</code>. The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="ci_+3A_n.mc">n.mc</code></td>
<td>
<p>Monte Carlo sample size. The default sample size is 1e+6.</p>
</td></tr>
<tr><td><code id="ci_+3A_h0">H0</code></td>
<td>
<p>False. If <code>TRUE</code>, it will estimate the sampling distribution
of <code class="reqn">H_{0}:f(\bm b)=0</code>. See the arguments <code>mu0</code> and <code>Sigma0</code>.</p>
</td></tr>
<tr><td><code id="ci_+3A_mu0">mu0</code></td>
<td>
<p>a <a href="base.html#topic+vector">vector</a> of means (e.g., coefficient estimates) for the
normal random variables that satisfy the null hypothesis <code class="reqn">H_{0}:f(\bm
  b)=0</code>. If it is not provided, smallest z value of <code>mu</code> is zet to zero.</p>
</td></tr>
<tr><td><code id="ci_+3A_sigma0">Sigma0</code></td>
<td>
<p>either a covariance matrix or a <a href="base.html#topic+vector">vector</a> that stacks all
the columns of the lower triangle variance&ndash;covariance matrix one
underneath the other. If it is not provided, then <code>Sigma</code> is used
instead.</p>
</td></tr>
<tr><td><code id="ci_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>type</code> is <code>"MC"</code> or <code>"asymp"</code>, <code>ci</code> returns
a <a href="base.html#topic+list">list</a> that contains: </p>
<table>
<tr><td><code>(\eqn{1-\alpha})% CI</code></td>
<td>
<p>a vector of lower
and upper confidence limits,</p>
</td></tr> <tr><td><code>Estimate</code></td>
<td>
<p>a point estimate of the
quantity of interest,</p>
</td></tr> <tr><td><code>SE</code></td>
<td>
<p>standard error of the quantity of
interest,</p>
</td></tr> <tr><td><code>MC Error</code></td>
<td>
<p>When <code>type="MC"</code>, error of the Monte Carlo
estimate.</p>
</td></tr></table>
<p> When <code>type="all"</code>, <code>ci</code> returns a <a href="base.html#topic+list">list</a> of two
objects, each of which a <a href="base.html#topic+list">list</a> that contains the results produced by
each method as described above.
</p>


<h3>Note</h3>

<p>A shiny web application for  Monte Carlo method of this function is available at <a href="https://amplab.shinyapps.io/MEDMC/">https://amplab.shinyapps.io/MEDMC/</a>
</p>


<h3>Author(s)</h3>

<p>Davood Tofighi <a href="mailto:dtofighi@gmail.com">dtofighi@gmail.com</a>
</p>


<h3>References</h3>

<p>Tofighi, D. and MacKinnon, D. P. (2011). RMediation: An R
package for mediation analysis confidence intervals. <em>Behavior
Research Methods</em>, <b>43</b>, 692&ndash;700. <a href="https://doi.org/10.3758/s13428-011-0076-x">doi:10.3758/s13428-011-0076-x</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+medci">medci</a></code> <code><a href="#topic+RMediation-package">RMediation-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ci(mu=c(b1=1,b2=.7,b3=.6, b4= .45), Sigma=c(.05,0,0,0,.05,0,0,.03,0,.03),
quant=~b1*b2*b3*b4, type="all", plot=TRUE, plotCI=TRUE)
#An Example of Conservative Null Sampling Distribution
ci(c(b1=.3,b2=.4,b3=.3), c(.01,0,0,.01,0,.02),
quant=~b1*b2*b3, type="mc", plot=TRUE, plotCI=TRUE, H0=TRUE, mu0=c(b1=.3,b2=.4,b3=0)  )
#An Example of Less Conservative Null Sampling Distribution
ci(c(b1=.3,b2=.4,b3=.3), c(.01,0,0,.01,0,.02),
quant=~b1*b2*b3, type="mc", plot=TRUE, plotCI=TRUE, H0=TRUE, mu0=c(b1=0,b2=.4,b3=0.1)  )
</code></pre>

<hr>
<h2 id='mbco'>Model-based Constrained Optimization (MBCO) Chi-squared Test</h2><span id='topic+mbco'></span>

<h3>Description</h3>

<p>This function computes asymptotic MBCO chi-squared test for a smooth function of model parameters including a function of indirect effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mbco(
  h0 = NULL,
  h1 = NULL,
  R = 10L,
  type = "asymp",
  alpha = 0.05,
  checkHess = "No",
  checkSE = "No",
  optim = "SLSQP",
  precision = 1e-09
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mbco_+3A_h0">h0</code></td>
<td>
<p>An <code>OpenMx</code> model estimated under a null hypothesis, which is a more constrained model</p>
</td></tr>
<tr><td><code id="mbco_+3A_h1">h1</code></td>
<td>
<p>An <code>OpenMx</code> model estimated under an alternative hypothesis, which is a less constrained model. This is usually a model hypothesized by a researcher.</p>
</td></tr>
<tr><td><code id="mbco_+3A_r">R</code></td>
<td>
<p>The number of bootstrap draws.</p>
</td></tr>
<tr><td><code id="mbco_+3A_type">type</code></td>
<td>
<p>If 'asymp' (default), the asymptotic MBCO chi-squares test comparing fit of h0 and h1. If 'parametric', the parametric bootstrap MBCO chi-squared test is computed. If 'semi', the semi-parametric MBCO chi-squared is computed.</p>
</td></tr>
<tr><td><code id="mbco_+3A_alpha">alpha</code></td>
<td>
<p>Significance level with the default value of .05</p>
</td></tr>
<tr><td><code id="mbco_+3A_checkhess">checkHess</code></td>
<td>
<p>If 'No' (default), the Hessian matrix would not be calculated.</p>
</td></tr>
<tr><td><code id="mbco_+3A_checkse">checkSE</code></td>
<td>
<p>if 'No' (default), the standard errors would not be calculated.</p>
</td></tr>
<tr><td><code id="mbco_+3A_optim">optim</code></td>
<td>
<p>Choose optimizer available in OpenMx. The default optimizer is &quot;SLSQP&quot;. Other optimizer choices are available. See mxOption for more details.</p>
</td></tr>
<tr><td><code id="mbco_+3A_precision">precision</code></td>
<td>
<p>Functional precision. The default value is set to 1e-9. See mxOption for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="base.html#topic+list">list</a> that contains </p>
<table>
<tr><td><code>chisq</code></td>
<td>
<p>asymptotic chi-squared test statistic value</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>chi-squared df</p>
</td></tr> <tr><td><code>p</code></td>
<td>
<p>chi-squared p-value computed based on the method specified by the argument <code>type</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Davood Tofighi <a href="mailto:dtofighi@gmail.com">dtofighi@gmail.com</a>
</p>


<h3>References</h3>

<p>Tofighi, D., &amp; Kelley, K. (2020). Indirect effects in sequential mediation models: Evaluating methods for hypothesis testing and confidence interval formation. <em>Multivariate Behavioral Research</em>, <b>55</b>, 188–210. <a href="https://doi.org/10.1080/00273171.2019.1618545">doi:10.1080/00273171.2019.1618545</a>
</p>
<p>Tofighi, D. (2020). Bootstrap Model-Based Constrained Optimization Tests of Indirect Effects. <em>Frontiers in Psychology</em>, <b>10</b>, 2989. <a href="https://doi.org/10.3389/fpsyg.2019.02989">doi:10.3389/fpsyg.2019.02989</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(memory_exp)
memory_exp$x &lt;- as.numeric(memory_exp$x)-1 # manually creating dummy codes
endVar &lt;- c('x', 'repetition', 'imagery', 'recall')
manifests &lt;- c('x', 'repetition', 'imagery', 'recall')
full_model &lt;- mxModel(
 "memory_example",
 type = "RAM",
 manifestVars = manifests,
 mxPath(
   from = "x",
   to = endVar,
   arrows = 1,
   free = TRUE,
   values = .2,
   labels = c("a1", "a2", "cp")
 ),
 mxPath(
   from = 'repetition',
  to = 'recall',
  arrows = 1,
   free = TRUE,
   values = .2,
   labels = 'b1'
 ),
 mxPath(
   from = 'imagery',
 to = 'recall',
 arrows = 1,
 free = TRUE,
 values = .2,
 labels = "b2"
),
mxPath(
 from = manifests,
 arrows = 2,
 free = TRUE,
 values = .8
),
mxPath(
 from = "one",
 to = endVar,
 arrows = 1,
 free = TRUE,
 values = .1
),
mxAlgebra(a1 * b1, name = "ind1"),
mxAlgebra(a2 * b2, name = "ind2"),
mxCI("ind1", type = "both"),
mxCI("ind2", type = "both"),
mxData(observed = memory_exp, type = "raw")
)
## Reduced  Model for indirect effect: a1*b1
null_model1 &lt;- mxModel(
model= full_model,
name = "Null Model 1",
mxConstraint(ind1 == 0, name = "ind1_eq0_constr")
)
full_model &lt;- mxTryHard(full_model, checkHess=FALSE, silent = TRUE )
null_model1 &lt;- mxTryHard(null_model1, checkHess=FALSE, silent = TRUE )
mbco(null_model1,full_model)
</code></pre>

<hr>
<h2 id='medci'>Confidence Interval for the Mediated Effect</h2><span id='topic+medci'></span>

<h3>Description</h3>

<p>Produces confidence intervals for the mediated effect and the product of two
normal random variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>medci(
  mu.x,
  mu.y,
  se.x,
  se.y,
  rho = 0,
  alpha = 0.05,
  type = "dop",
  plot = FALSE,
  plotCI = FALSE,
  n.mc = 1e+05,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="medci_+3A_mu.x">mu.x</code></td>
<td>
<p>mean of <code class="reqn">x</code></p>
</td></tr>
<tr><td><code id="medci_+3A_mu.y">mu.y</code></td>
<td>
<p>mean of <code class="reqn">y</code></p>
</td></tr>
<tr><td><code id="medci_+3A_se.x">se.x</code></td>
<td>
<p>standard error (deviation) of <code class="reqn">x</code></p>
</td></tr>
<tr><td><code id="medci_+3A_se.y">se.y</code></td>
<td>
<p>standard error (deviation) of <code class="reqn">y</code></p>
</td></tr>
<tr><td><code id="medci_+3A_rho">rho</code></td>
<td>
<p>correlation between <code class="reqn">x</code> and <code class="reqn">y</code>, where -1 &lt;<code>rho</code> &lt; 1.
The default value is 0.</p>
</td></tr>
<tr><td><code id="medci_+3A_alpha">alpha</code></td>
<td>
<p>significance level for the confidence interval. The default
value is .05.</p>
</td></tr>
<tr><td><code id="medci_+3A_type">type</code></td>
<td>
<p>method used to compute confidence interval. It takes on the
values <code>"dop"</code> (default), <code>"MC"</code>, <code>"asymp"</code> or <code>"all"</code></p>
</td></tr>
<tr><td><code id="medci_+3A_plot">plot</code></td>
<td>
<p>when <code>TRUE</code>, plots the distribution of <code>n.mc</code> data
points from the distribution of product of two normal random variables
using the density estimates provided by the function <code><a href="stats.html#topic+density">density</a></code>.
The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="medci_+3A_plotci">plotCI</code></td>
<td>
<p>when <code>TRUE</code>, overlays a confidence interval with error
bars on the plot for the mediated effect. Note that to obtain the CI plot,
one must also specify <code>plot="TRUE"</code>. The default value is
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="medci_+3A_n.mc">n.mc</code></td>
<td>
<p>when <code>type="MC"</code>, <code>n.mc</code> determines the sample size for
the Monte Carlo method. The default sample size is 1E5.</p>
</td></tr>
<tr><td><code id="medci_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed on to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns a (<code class="reqn">1-\alpha</code>)% confidence interval for
the mediated effect (product of two normal random variables). To obtain a
confidence interval using a specific method, the argument <code>type</code>
should be specified. The default is <code>type="dop"</code>, which uses the code
we wrote in <span class="rlang"><b>R</b></span> to implement the distribution of product of the coefficients
method described by Meeker and Escobar (1994) to evaluate the CDF of the
distribution of product. <code>type="MC"</code> uses the Monte Carlo approach to
compute the confidence interval (Tofighi &amp; MacKinnon, 2011).
<code>type="asymp"</code> produces the asymptotic normal confidence interval.
Note that except for the Monte Carlo method, the standard error for the
indirect effect is based on the analytical results by Craig (1936):
</p>
<p style="text-align: center;"><code class="reqn">\sqrt(se.y^2 \mu.x^2+se.x^2 \mu.y^2+2 \mu.x \mu.y \rho se.x se.y+
  se.x^2 se.y^2+se.x^2 se.y^2 \rho^2) </code>
</p>
<p>. In addition, the estimate of
indirect effect is <code class="reqn">\mu.x \mu.y +\sigma.xy </code>; <code>type="all"</code> prints
confidence intervals using all four options.
</p>


<h3>Value</h3>

<p>A vector of lower confidence limit and upper confidence limit. When
<code>type</code> is <code>"prodclin"</code> (default), <code>"DOP"</code>, <code>"MC"</code> or
<code>"asymp"</code>, <code>medci</code> returns a <a href="base.html#topic+list">list</a> that contains:
</p>
<table>
<tr><td><code>(\eqn{1-\alpha})% CI</code></td>
<td>
<p>a vector of lower and upper confidence
limits,</p>
</td></tr> <tr><td><code>Estimate</code></td>
<td>
<p>a point estimate of the quantity of interest,</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>standard error of the quantity of interest,</p>
</td></tr> <tr><td><code>MC Error</code></td>
<td>
<p>When
<code>type="MC"</code>, error of the Monte Carlo estimate.</p>
</td></tr></table>
<p> Note that when
<code>type="all"</code>, <code>medci</code> returns a <a href="base.html#topic+list">list</a> of <em>four</em>
objects, each of which a <a href="base.html#topic+list">list</a> that contains the results produced by
each method as described above.
</p>


<h3>Author(s)</h3>

<p>Davood Tofighi <a href="mailto:dtofighi@gmail.com">dtofighi@gmail.com</a>
</p>


<h3>References</h3>

<p>Craig, C. C. (1936). On the frequency function of <code class="reqn">xy</code>.
<em>The Annals of Mathematical Statistics</em>, <b>7</b>, 1&ndash;15.
</p>
<p>MacKinnon, D. P., Fritz, M. S., Williams, J., and Lockwood, C. M. (2007).
Distribution of the product confidence limits for the indirect effect:
Program PRODCLIN. <em>Behavior Research Methods</em>, <b>39</b>, 384&ndash;389.
</p>
<p>Meeker, W. and Escobar, L. (1994). An algorithm to compute the CDF of the
product of two normal random variables. <em>Communications in Statistics:
Simulation and Computation</em>, <b>23</b>, 271&ndash;280.
</p>
<p>Tofighi, D. and MacKinnon, D. P. (2011). RMediation: An R package for mediation analysis
confidence intervals. <em>Behavior Research Methods</em>, <b>43</b>,
692&ndash;700. <a href="https://doi.org/10.3758/s13428-011-0076-x">doi:10.3758/s13428-011-0076-x</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qprodnormal">qprodnormal</a></code> <code><a href="#topic+pprodnormal">pprodnormal</a></code> <code><a href="#topic+ci">ci</a></code>
<code><a href="#topic+RMediation-package">RMediation-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1
 res &lt;- medci(mu.x=.2, mu.y=.4, se.x=1, se.y=1, rho=0, alpha=.05,
 type="dop", plot=TRUE, plotCI=TRUE)
 ## Example 2
res &lt;- medci(mu.x=.2, mu.y=.4, se.x=1, se.y=1, rho=0, alpha=.05, type="all", plot=TRUE, plotCI=TRUE)
</code></pre>

<hr>
<h2 id='memory_exp'>Memory Experiment Data Description from MacKinnon et al., 2018</h2><span id='topic+memory_exp'></span>

<h3>Description</h3>

<p>Data were obtained from eight replicated experiments. The data were collected on the first day of class as part of the first Dr. MacKinnon's (2018) classroom teaching. The pedagogical value of the experiment was that students would have first-hand knowledge of the experiment thereby increasing their understanding of course concepts. Permission to use the data was obtained from the university Institutional Review Board.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(memory_exp)
</code></pre>


<h3>Format</h3>

<p>A data frame with 369 rows and 5 variables:
</p>

<dl>
<dt>study</dt><dd><p>Replication ID, ranges from 1 to 8</p>
</dd>
<dt>repetition</dt><dd><p>Use of repetition rehearsal technique on a 1 to 9 scale</p>
</dd>
<dt>recall</dt><dd><p>Total words recalled out of 20 words</p>
</dd>
<dt>imagery</dt><dd><p>Use of imagery rehearsal technique on a 1 to 9 scale</p>
</dd>
<dt>x</dt><dd><p>A <a href="base.html#topic+factor">factor</a> with two levels: repetition or primary rehearsal = 0, imagery or secondary rehearsal = 1</p>
</dd>
</dl>



<h3>Note</h3>

<p>If you use the data set, please cite the original article by MacKinnon et al. (2018) cited below.
</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.1037/met0000174.supp">doi:10.1037/met0000174.supp</a>
</p>


<h3>References</h3>

<p>MacKinnon, D. P., Valente, M. J., &amp; Wurpts, I. C. (2018). Benchmark validation of statistical models: Application to mediation analysis of imagery and memory. Psychological Methods, 23, 654–671. <a href="https://doi.org/10.1037/met0000174">doi:10.1037/met0000174</a>
</p>

<hr>
<h2 id='pMC'>Probability (percentile) for the Monte Carlo Sampling Distribution of a nonlinear function of coefficients estimates</h2><span id='topic+pMC'></span>

<h3>Description</h3>

<p>This function returns a probability corresponding to the quantile <code>q</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pMC(q, mu, Sigma, quant, lower.tail = TRUE, n.mc = 1e+06, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pMC_+3A_q">q</code></td>
<td>
<p>quantile</p>
</td></tr>
<tr><td><code id="pMC_+3A_mu">mu</code></td>
<td>
<p>a <a href="base.html#topic+vector">vector</a> of means (e.g., coefficient estimates) for the normal random variables. A user can assign a name to each mean value, e.g., <code>mu=c(b1=.1,b2=3)</code>; otherwise, the coefficient names are assigned automatically as follows: <code>b1,b2,...</code>.</p>
</td></tr>
<tr><td><code id="pMC_+3A_sigma">Sigma</code></td>
<td>
<p>either a covariance matrix or a <a href="base.html#topic+vector">vector</a> that stacks all the columns of the lower triangle variance&ndash;covariance matrix one underneath the other.</p>
</td></tr>
<tr><td><code id="pMC_+3A_quant">quant</code></td>
<td>
<p>quantity of interest, which is a nonlinear/linear function of the model parameters. Argument <code>quant</code> is a <a href="stats.html#topic+formula">formula</a> that <strong>must</strong> start with the symbol &quot;tilde&quot; (<code>~</code>): e.g., <code>~b1*b2*b3*b4</code>. The names of coefficients must conform to the names provided in the argument <code>mu</code> or to the default names, i.e., <code>b1,b2,...</code>.</p>
</td></tr>
<tr><td><code id="pMC_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), the probability is <code class="reqn">P[quant &lt; q]</code>; otherwise, <code class="reqn">P[quant &gt; q]</code></p>
</td></tr>
<tr><td><code id="pMC_+3A_n.mc">n.mc</code></td>
<td>
<p>Monte Carlo sample size. The default sample size is 1e+6.</p>
</td></tr>
<tr><td><code id="pMC_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>scalar probability value.
</p>


<h3>Author(s)</h3>

<p>Davood Tofighi <a href="mailto:dtofighi@gmail.com">dtofighi@gmail.com</a>
</p>


<h3>References</h3>

<p>Tofighi, D. and MacKinnon, D. P. (2011). RMediation: An R package for mediation analysis confidence intervals. <em>Behavior Research Methods</em>, <b>43</b>, 692&ndash;700. doi:10.3758/s13428-011-0076-x
</p>


<h3>See Also</h3>

<p><code><a href="#topic+medci">medci</a></code> <code><a href="#topic+RMediation-package">RMediation-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pMC(.2,mu=c(b1=1,b2=.7,b3=.6, b4= .45), Sigma=c(.05,0,0,0,.05,0,0,.03,0,.03),
quant=~b1*b2*b3*b4)
</code></pre>

<hr>
<h2 id='pprodnormal'>Percentile for the Distribution of Product of Two Normal Variables</h2><span id='topic+pprodnormal'></span>

<h3>Description</h3>

<p>Generates percentiles (100 based quantiles) for the distribution of product
of two normal random variables and the mediated effect
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pprodnormal(
  q,
  mu.x,
  mu.y,
  se.x = 1,
  se.y = 1,
  rho = 0,
  lower.tail = TRUE,
  type = "dop",
  n.mc = 1e+05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pprodnormal_+3A_q">q</code></td>
<td>
<p>quantile or value of the product</p>
</td></tr>
<tr><td><code id="pprodnormal_+3A_mu.x">mu.x</code></td>
<td>
<p>mean of <code class="reqn">x</code></p>
</td></tr>
<tr><td><code id="pprodnormal_+3A_mu.y">mu.y</code></td>
<td>
<p>mean of <code class="reqn">y</code></p>
</td></tr>
<tr><td><code id="pprodnormal_+3A_se.x">se.x</code></td>
<td>
<p>standard error (deviation) of <code class="reqn">x</code></p>
</td></tr>
<tr><td><code id="pprodnormal_+3A_se.y">se.y</code></td>
<td>
<p>standard error (deviation) of <code class="reqn">y</code></p>
</td></tr>
<tr><td><code id="pprodnormal_+3A_rho">rho</code></td>
<td>
<p>correlation between <code class="reqn">x</code> and <code class="reqn">y</code>, where -1 &lt;<code>rho</code> &lt; 1.
The default value is 0.</p>
</td></tr>
<tr><td><code id="pprodnormal_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), the probability is
<code class="reqn">P[X*Y &lt; q]</code>; otherwise, <code class="reqn">P[X*Y &gt; q]</code></p>
</td></tr>
<tr><td><code id="pprodnormal_+3A_type">type</code></td>
<td>
<p>method used to compute confidence interval. It takes on the
values <code>"dop"</code> (default), <code>"MC"</code>, <code>"asymp"</code> or <code>"all"</code></p>
</td></tr>
<tr><td><code id="pprodnormal_+3A_n.mc">n.mc</code></td>
<td>
<p>when <code>type="MC"</code>, <code>n.mc</code> determines the sample size for
the Monte Carlo method. The default sample size is 1E5.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns the percentile (probability) and the
associated error for the distribution of product of mediated effect (two
normal random variables). To obtain a percentile using a specific method,
the argument <code>type</code> should be specified. The default method is
<code>type="dop"</code>, which is based on the method described by Meeker and
Escobar (1994) to evaluate the CDF of the distribution of product of two
normal random variables. <code>type="MC"</code> uses the Monte Carlo approach
(Tofighi &amp; MacKinnon, 2011). <code>type="all"</code> prints percentiles using all
three options. For the method <code>type="dop"</code>, the error is the modulus
of absolute error for the numerical integration (for more information see
Meeker and Escobar, 1994). For <code>type="MC"</code>, the error refers to the
Monte Carlo error.
</p>


<h3>Value</h3>

<p>An object of the type <code><a href="base.html#topic+list">list</a></code> that contains the
following values: </p>
<table>
<tr><td><code>p</code></td>
<td>
<p>probability (percentile) corresponding to
quantile <code>q</code></p>
</td></tr> <tr><td><code>error</code></td>
<td>
<p>estimate of the absolute error</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Davood Tofighi <a href="mailto:dtofighi@gmail.com">dtofighi@gmail.com</a>
</p>


<h3>References</h3>

<p>Tofighi, D. and MacKinnon, D. P. (2011). RMediation: An R
package for mediation analysis confidence intervals. <em>Behavior
Research Methods</em>, <b>43</b>, 692&ndash;700. doi:10.3758/s13428-011-0076-x
</p>


<h3>See Also</h3>

<p><code><a href="#topic+medci">medci</a></code> <code><a href="#topic+RMediation-package">RMediation-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pprodnormal(q=0, mu.x=.5, mu.y=.3, se.x=1, se.y=1, rho= 0, type="all")
</code></pre>

<hr>
<h2 id='qMC'>Quantile for the Monte Carlo Sampling Distribution of a nonlinear function of coefficients estimates</h2><span id='topic+qMC'></span>

<h3>Description</h3>

<p>This function returns a quantile corresponding to the probability <code>p</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qMC(p, mu, Sigma, quant, n.mc = 1e+06, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qMC_+3A_p">p</code></td>
<td>
<p>probability.</p>
</td></tr>
<tr><td><code id="qMC_+3A_mu">mu</code></td>
<td>
<p>a <a href="base.html#topic+vector">vector</a> of means (e.g., coefficient estimates) for the normal random variables. A user can assign a name to each mean value, e.g., <code>mu=c(b1=.1,b2=3)</code>; otherwise, the coefficient names are assigned automatically as follows: <code>b1,b2,...</code>.</p>
</td></tr>
<tr><td><code id="qMC_+3A_sigma">Sigma</code></td>
<td>
<p>either a covariance matrix or a <a href="base.html#topic+vector">vector</a> that stacks all the columns of the lower triangle variance&ndash;covariance matrix one underneath the other.</p>
</td></tr>
<tr><td><code id="qMC_+3A_quant">quant</code></td>
<td>
<p>quantity of interest, which is a nonlinear/linear function of the model parameters. Argument <code>quant</code> is a <a href="stats.html#topic+formula">formula</a> that <strong>must</strong> start with the symbol &quot;tilde&quot; (<code>~</code>): e.g., <code>~b1*b2*b3*b4</code>. The names of coefficients must conform to the names provided in the argument <code>mu</code> or to the default names, i.e., <code>b1,b2,...</code>.</p>
</td></tr>
<tr><td><code id="qMC_+3A_n.mc">n.mc</code></td>
<td>
<p>Monte Carlo sample size. The default sample size is 1e+6.</p>
</td></tr>
<tr><td><code id="qMC_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>scalar quantile value.
</p>


<h3>Author(s)</h3>

<p>Davood Tofighi <a href="mailto:dtofighi@gmail.com">dtofighi@gmail.com</a>
</p>


<h3>References</h3>

<p>Tofighi, D. and MacKinnon, D. P. (2011). RMediation: An R package for mediation analysis confidence intervals. <em>Behavior Research Methods</em>, <b>43</b>, 692&ndash;700. doi:10.3758/s13428-011-0076-x
</p>


<h3>See Also</h3>

<p><code><a href="#topic+medci">medci</a></code> <code><a href="#topic+RMediation-package">RMediation-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>qMC(.05,mu=c(b1=1,b2=.7,b3=.6, b4= .45), Sigma=c(.05,0,0,0,.05,0,0,.03,0,.03),
quant=~b1*b2*b3*b4)
</code></pre>

<hr>
<h2 id='qprodnormal'>Quantile for the Distribution of Product of Two Normal Variables</h2><span id='topic+qprodnormal'></span>

<h3>Description</h3>

<p>Generates quantiles for the distribution of product of two normal random
variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qprodnormal(
  p,
  mu.x,
  mu.y,
  se.x,
  se.y,
  rho = 0,
  lower.tail = TRUE,
  type = "dop",
  n.mc = 1e+05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qprodnormal_+3A_p">p</code></td>
<td>
<p>probability</p>
</td></tr>
<tr><td><code id="qprodnormal_+3A_mu.x">mu.x</code></td>
<td>
<p>mean of <code class="reqn">x</code></p>
</td></tr>
<tr><td><code id="qprodnormal_+3A_mu.y">mu.y</code></td>
<td>
<p>mean of <code class="reqn">y</code></p>
</td></tr>
<tr><td><code id="qprodnormal_+3A_se.x">se.x</code></td>
<td>
<p>standard error (deviation) of <code class="reqn">x</code></p>
</td></tr>
<tr><td><code id="qprodnormal_+3A_se.y">se.y</code></td>
<td>
<p>standard error (deviation) of <code class="reqn">y</code></p>
</td></tr>
<tr><td><code id="qprodnormal_+3A_rho">rho</code></td>
<td>
<p>correlation between <code class="reqn">x</code> and <code class="reqn">y</code>, where -1 &lt;<code>rho</code> &lt; 1.
The default value is 0.</p>
</td></tr>
<tr><td><code id="qprodnormal_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), the probability is
<code class="reqn">P[X*Y &lt; q]</code>; otherwise, <code class="reqn">P[X*Y &gt; q]</code></p>
</td></tr>
<tr><td><code id="qprodnormal_+3A_type">type</code></td>
<td>
<p>method used to compute confidence interval. It takes on the
values <code>"dop"</code> (default), <code>"MC"</code>, <code>"asymp"</code> or <code>"all"</code></p>
</td></tr>
<tr><td><code id="qprodnormal_+3A_n.mc">n.mc</code></td>
<td>
<p>when <code>type="MC"</code>, <code>n.mc</code> determines the sample size for
the Monte Carlo method. The default sample size is 1E5.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns a quantile and the associated error
(accuracy) corresponding the requested percentile (probability) <code>p</code> of
the distribution of product of mediated effect (product of two normal
random variables). To obtain a quantile using a specific method, the
argument <code>type</code> should be specified. The default method is
<code>type="dop"</code>, which uses the method described by Meeker and Escobar
(1994) to evaluate the CDF of the distribution of product of two normal
variables. <code>type="MC"</code> uses the Monte Carlo approach (Tofighi &amp;
MacKinnon, 2011). <code>type="all"</code> prints quantiles using all three
options. For the method <code>type="dop"</code>, the error is the modulus of
absolute error for the numerical integration (for more information see
Meeker and Escobar, 1994). For <code>type="MC"</code>, the error refers to the
Monte Carlo error.
</p>


<h3>Value</h3>

<p>An object of the type <code><a href="base.html#topic+list">list</a></code> that contains the
following values: </p>
<table>
<tr><td><code>q</code></td>
<td>
<p>quantile corresponding to probability <code>p</code></p>
</td></tr>
<tr><td><code>error</code></td>
<td>
<p>estimate of the absolute error</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Davood Tofighi <a href="mailto:dtofighi@gmail.com">dtofighi@gmail.com</a>
</p>


<h3>References</h3>

<p>Tofighi, D. and MacKinnon, D. P. (2011). RMediation: An R
package for mediation analysis confidence intervals. <em>Behavior
Research Methods</em>, <b>43</b>, 692&ndash;700. doi:10.3758/s13428-011-0076-x
</p>


<h3>See Also</h3>

<p><code><a href="#topic+medci">medci</a></code> <code><a href="#topic+RMediation-package">RMediation-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##lower tail
qprodnormal(p=.1, mu.x=.5, mu.y=.3, se.x=1, se.y=1, rho=0,
lower.tail = TRUE, type="all")
##upper tail
qprodnormal(p=.1, mu.x=.5, mu.y=.3, se.x=1, se.y=1, rho=0,
lower.tail = FALSE, type="all")
</code></pre>

<hr>
<h2 id='RMediation-package'>RMediation: Mediation Analysis Confidence Intervals</h2><span id='topic+RMediation'></span><span id='topic+RMediation-package'></span>

<h3>Description</h3>

<p>We provide functions to compute confidence intervals for a well-defined nonlinear function of the model parameters (e.g., product of k coefficients) in single&ndash;level and multilevel structural equation models. It also computes a chi-square test statistic for a function of indirect effects. 'Tofighi', D. and 'MacKinnon', D. P. (2011). 'RMediation' An R package for mediation analysis confidence intervals. Behavior Research Methods, 43, 692&ndash;700. <a href="https://doi.org/10.3758/s13428-011-0076-x">doi:10.3758/s13428-011-0076-x</a>. 'Tofighi', D. (2020). Bootstrap Model-Based Constrained Optimization Tests of Indirect Effects. Frontiers in Psychology, 10, 2989. <a href="https://doi.org/10.3389/fpsyg.2019.02989">doi:10.3389/fpsyg.2019.02989</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Davood Tofighi <a href="mailto:dtofighi@gmail.com">dtofighi@gmail.com</a> (<a href="https://orcid.org/0000-0001-8523-7776">ORCID</a>)
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
