<!DOCTYPE html><html><head><title>Help for package MTAFT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MTAFT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MTAFT_CV'><p>MTAFT_CV: Cross-Validation for Multiple Thresholds Accelerated Failure Time Model</p></a></li>
<li><a href='#MTAFT_IC'><p>MTAFT_IC: Multiple Thresholds Accelerated Failure Time Model with Information Criteria</p></a></li>
<li><a href='#MTAFT_simdata'><p>Generate simulated data for MTAFT analysis.</p></a></li>
<li><a href='#MTAFT_test'><p>Perform score-type test for the presence of threshold effect in multi-threshold situations.</p></a></li>
<li><a href='#MTAFT-package'><p>MTAFT: Data-Driven Estimation for Multi-Threshold Accelerate Failure Time Model</p></a></li>
<li><a href='#TSMCP'><p>TSMCP: Two stage multiple change points detection for AFT model.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Data-Driven Estimation for Multi-Threshold Accelerate Failure
Time Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-10</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chuang WAN &lt;wanchuang@nankai.edu.cn&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Developed a data-driven estimation framework for the multi-threshold accelerate failure time (MTAFT) model. The MTAFT model features different linear forms in different subdomains, and one of the major challenges is determining the number of threshold effects. The package introduces a data-driven approach that utilizes a Schwarz' information criterion, which demonstrates consistency under mild conditions. Additionally, a cross-validation (CV) criterion with an order-preserved sample-splitting scheme is proposed to achieve consistent estimation, without the need for additional parameters. The package establishes the asymptotic properties of the parameter estimates and includes an efficient score-type test to examine the existence of threshold effects. The methodologies are supported by numerical experiments and theoretical results, showcasing their reliable performance in finite-sample cases.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS, knitr, rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, methods, stats, grpreg</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-12 09:23:42 UTC; zenghao</td>
</tr>
<tr>
<td>Author:</td>
<td>Chuang WAN [aut, cre],
  Hao ZENG [aut],
  Wei ZHONG [aut],
  Changliang ZOU [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-13 17:43:21 UTC</td>
</tr>
</table>
<hr>
<h2 id='MTAFT_CV'>MTAFT_CV: Cross-Validation for Multiple Thresholds Accelerated Failure Time Model</h2><span id='topic+MTAFT_CV'></span>

<h3>Description</h3>

<p>This function implements a cross-validation method for the multiple thresholds accelerated
failure time (AFT) model using either the &quot;WBS&quot; (Wild Binary Segmentation) or &quot;DP&quot;
(Dynamic Programming) algorithm. It determines the optimal number of thresholds by
evaluating the cross-validation (CV) values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MTAFT_CV(
  Y,
  X,
  delta,
  Tq,
  algorithm,
  dist_min = 50,
  ncps_max = 4,
  wbs_nintervals = 200
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MTAFT_CV_+3A_y">Y</code></td>
<td>
<p>the censored logarithm of the failure time.</p>
</td></tr>
<tr><td><code id="MTAFT_CV_+3A_x">X</code></td>
<td>
<p>the design matrix without the intercept.</p>
</td></tr>
<tr><td><code id="MTAFT_CV_+3A_delta">delta</code></td>
<td>
<p>the censoring indicator.</p>
</td></tr>
<tr><td><code id="MTAFT_CV_+3A_tq">Tq</code></td>
<td>
<p>the threshold values.</p>
</td></tr>
<tr><td><code id="MTAFT_CV_+3A_algorithm">algorithm</code></td>
<td>
<p>the threshold detection algorithm, either &quot;WBS&quot; or &quot;DP&quot;.</p>
</td></tr>
<tr><td><code id="MTAFT_CV_+3A_dist_min">dist_min</code></td>
<td>
<p>the pre-specified minimal number of observations within each subgroup. Default is 50.</p>
</td></tr>
<tr><td><code id="MTAFT_CV_+3A_ncps_max">ncps_max</code></td>
<td>
<p>the pre-specified maximum number of thresholds. Default is 4.</p>
</td></tr>
<tr><td><code id="MTAFT_CV_+3A_wbs_nintervals">wbs_nintervals</code></td>
<td>
<p>the number of random intervals in the WBS algorithm. Default is 200.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<dl>
<dt>params</dt><dd><p>the subgroup-specific slope estimates and variance estimates.</p>
</dd>
<dt>thres</dt><dd><p>the threshold estimates.</p>
</dd>
<dt>CV_vals</dt><dd><p>the CV values for all candidate number of thresholds.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'># Generate simulated data with 500 samples and normal error distribution
dataset &lt;- MTAFT_simdata(n = 500, err = "normal")

Y &lt;- dataset[, 1]
delta &lt;- dataset[, 2]
Tq &lt;- dataset[, 3]
X &lt;- dataset[, -c(1:3)]

# Run mAFT_CV with WBS algorithm
maft_cv_result &lt;- MTAFT_CV(Y, X, delta, Tq, algorithm = "WBS")
maft_cv_result$params
maft_cv_result$thres
maft_cv_result$CV_vals

</code></pre>

<hr>
<h2 id='MTAFT_IC'>MTAFT_IC: Multiple Thresholds Accelerated Failure Time Model with Information Criteria</h2><span id='topic+MTAFT_IC'></span>

<h3>Description</h3>

<p>This function implements a method for multiple thresholds accelerated failure time (AFT) model
with information criteria. It estimates the subgroup-specific slope coefficients and variance
estimates, as well as the threshold estimates using either the &quot;WBS&quot; (Wild Binary Segmentation)
or &quot;DP&quot; (Dynamic Programming) algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MTAFT_IC(
  Y,
  X,
  delta,
  Tq,
  c0 = 0.299,
  delta0 = 2.01,
  algorithm = c("WBS", "DP"),
  dist_min = 50,
  ncps_max = 4,
  wbs_nintervals = 200
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MTAFT_IC_+3A_y">Y</code></td>
<td>
<p>the censored logarithm of the failure time.</p>
</td></tr>
<tr><td><code id="MTAFT_IC_+3A_x">X</code></td>
<td>
<p>the design matrix without the intercept.</p>
</td></tr>
<tr><td><code id="MTAFT_IC_+3A_delta">delta</code></td>
<td>
<p>the censoring indicator.</p>
</td></tr>
<tr><td><code id="MTAFT_IC_+3A_tq">Tq</code></td>
<td>
<p>the threshold values.</p>
</td></tr>
<tr><td><code id="MTAFT_IC_+3A_c0">c0</code></td>
<td>
<p>the penalty factor c0 in the information criteria (IC), default is 0.299.</p>
</td></tr>
<tr><td><code id="MTAFT_IC_+3A_delta0">delta0</code></td>
<td>
<p>the penalty factor delta0 in the information criteria (IC), default is 2.01.</p>
</td></tr>
<tr><td><code id="MTAFT_IC_+3A_algorithm">algorithm</code></td>
<td>
<p>the threshold detection algorithm, either &quot;WBS&quot; or &quot;DP&quot;. Default is &quot;WBS&quot;.</p>
</td></tr>
<tr><td><code id="MTAFT_IC_+3A_dist_min">dist_min</code></td>
<td>
<p>the pre-specified minimal number of observations within each subgroup. Default is 50.</p>
</td></tr>
<tr><td><code id="MTAFT_IC_+3A_ncps_max">ncps_max</code></td>
<td>
<p>the pre-specified maximum number of thresholds. Default is 4.</p>
</td></tr>
<tr><td><code id="MTAFT_IC_+3A_wbs_nintervals">wbs_nintervals</code></td>
<td>
<p>the number of random intervals in the WBS algorithm. Default is 200.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<dl>
<dt>params</dt><dd><p>the subgroup-specific slope estimates and variance estimates.</p>
</dd>
<dt>thres</dt><dd><p>the threshold estimates.</p>
</dd>
<dt>IC_val</dt><dd><p>the IC values for all candidate number of thresholds.</p>
</dd>
</dl>



<h3>References</h3>

<p>(Add relevant references here)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate simulated data with 500 samples and normal error distribution
dataset &lt;- MTAFT_simdata(n = 500, err = "normal")
Y &lt;- dataset[, 1]
delta &lt;- dataset[, 2]
Tq &lt;- dataset[, 3]
X &lt;- dataset[, -c(1:3)]

# Run MTAFT_IC with WBS algorithm
mtaft_ic_result &lt;- MTAFT_IC(Y, X, delta, Tq, algorithm = 'WBS')
mtaft_ic_result$params
mtaft_ic_result$thres
mtaft_ic_result$IC_val

</code></pre>

<hr>
<h2 id='MTAFT_simdata'>Generate simulated data for MTAFT analysis.</h2><span id='topic+MTAFT_simdata'></span>

<h3>Description</h3>

<p>This function generates simulated data for the MTAFT (Multi-Threshold Accelerated Failure Time) analysis based on a simple simulation procedure described in the article.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MTAFT_simdata(n, err = c("normal", "t3"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MTAFT_simdata_+3A_n">n</code></td>
<td>
<p>The number of sample size.</p>
</td></tr>
<tr><td><code id="MTAFT_simdata_+3A_err">err</code></td>
<td>
<p>The error distribution type, either &quot;normal&quot; or &quot;t3&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataset containing the simulated data for MTAFT analysis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate simulated data with 500 samples and normal error distribution
dataset &lt;- MTAFT_simdata(n = 500, err = "normal")
Y &lt;- dataset[, 1]
delta &lt;- dataset[, 2]
Tq &lt;- dataset[, 3]
X &lt;- dataset[, -c(1:3)]

# Generate simulated data with 200 samples and t3 error distribution
dataset &lt;- MTAFT_simdata(n = 200, err = "t3")
Y &lt;- dataset[, 1]
delta &lt;- dataset[, 2]
Tq &lt;- dataset[, 3]
X &lt;- dataset[, -c(1:3)]
</code></pre>

<hr>
<h2 id='MTAFT_test'>Perform score-type test for the presence of threshold effect in multi-threshold situations.</h2><span id='topic+MTAFT_test'></span>

<h3>Description</h3>

<p>This function performs a score-type test statistics for the presence of threshold effect in multi-threshold situations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MTAFT_test(Y, X, Tq, delta, nboots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MTAFT_test_+3A_y">Y</code></td>
<td>
<p>Response variable.</p>
</td></tr>
<tr><td><code id="MTAFT_test_+3A_x">X</code></td>
<td>
<p>Covariates.</p>
</td></tr>
<tr><td><code id="MTAFT_test_+3A_tq">Tq</code></td>
<td>
<p>Threshold variable.</p>
</td></tr>
<tr><td><code id="MTAFT_test_+3A_delta">delta</code></td>
<td>
<p>Indicator vector for censoring.</p>
</td></tr>
<tr><td><code id="MTAFT_test_+3A_nboots">nboots</code></td>
<td>
<p>Number of bootstrap iterations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>p-value result indicating the presence of threshold effect.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate simulated data with 500 samples and normal error distribution
dataset &lt;- MTAFT_simdata(n = 500, err = "normal")
Y &lt;- dataset[, 1]
delta &lt;- dataset[, 2]
Tq &lt;- dataset[, 3]
X &lt;- dataset[, -c(1:3)]

# Perform score-type test with 500 bootstraps
pval &lt;- MTAFT_test(Y, X, Tq, delta, nboots = 500)

# Perform score-type test with 1000 bootstraps
pval &lt;- MTAFT_test(Y, X, Tq, delta, nboots = 1000)

</code></pre>

<hr>
<h2 id='MTAFT-package'>MTAFT: Data-Driven Estimation for Multi-Threshold Accelerate Failure Time Model</h2><span id='topic+MTAFT'></span><span id='topic+MTAFT-package'></span>

<h3>Description</h3>

<p>Developed a data-driven estimation framework for the multi-threshold accelerate failure time (MTAFT) model. The MTAFT model features different linear forms in different subdomains, and one of the major challenges is determining the number of threshold effects. The package introduces a data-driven approach that utilizes a Schwarz' information criterion, which demonstrates consistency under mild conditions. Additionally, a cross-validation (CV) criterion with an order-preserved sample-splitting scheme is proposed to achieve consistent estimation, without the need for additional parameters. The package establishes the asymptotic properties of the parameter estimates and includes an efficient score-type test to examine the existence of threshold effects. The methodologies are supported by numerical experiments and theoretical results, showcasing their reliable performance in finite-sample cases.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Chuang WAN <a href="mailto:wanchuang@nankai.edu.cn">wanchuang@nankai.edu.cn</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Hao ZENG <a href="mailto:zenghao@stu.xmu.edu.cn">zenghao@stu.xmu.edu.cn</a>
</p>
</li>
<li><p> Wei ZHONG <a href="mailto:wzhong@xmu.edu.cn">wzhong@xmu.edu.cn</a>
</p>
</li>
<li><p> Changliang ZOU <a href="mailto:nk.chlzou@gmail.com">nk.chlzou@gmail.com</a>
</p>
</li></ul>


<hr>
<h2 id='TSMCP'>TSMCP: Two stage multiple change points detection for AFT model.</h2><span id='topic+TSMCP'></span>

<h3>Description</h3>

<p>This function first formulates the threshold problem as a group model selection problem
so that a concave 2-norm group selection method can be applied using the 'grpreg'
package in R, and then finalizes it via a refining method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TSMCP(Y, X, delta, c, penalty = "scad")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TSMCP_+3A_y">Y</code></td>
<td>
<p>the censored logarithm of the failure time.</p>
</td></tr>
<tr><td><code id="TSMCP_+3A_x">X</code></td>
<td>
<p>the design matrix without the intercept.</p>
</td></tr>
<tr><td><code id="TSMCP_+3A_delta">delta</code></td>
<td>
<p>the censoring indicator.</p>
</td></tr>
<tr><td><code id="TSMCP_+3A_c">c</code></td>
<td>
<p>the length of each segment in the splitting stage, defined as
<code>ceiling(c * sqrt(length(Y)))</code>.</p>
</td></tr>
<tr><td><code id="TSMCP_+3A_penalty">penalty</code></td>
<td>
<p>Penalty type (default is &quot;scad&quot;).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object with the following components:
</p>

<dl>
<dt>cp</dt><dd><p>the change points.</p>
</dd>
<dt>coef</dt><dd><p>the estimated coefficients.</p>
</dd>
<dt>sigma</dt><dd><p>the variance of the error.</p>
</dd>
<dt>residuals</dt><dd><p>the residuals.</p>
</dd>
<dt>Yn</dt><dd><p>weighted Y by Kaplan-Meier weight.</p>
</dd>
<dt>Xn</dt><dd><p>weighted Xn by Kaplan-Meier weight.</p>
</dd>
</dl>



<h3>References</h3>

<p>Li, Jialiang, and Baisuo Jin. 2018. “Multi-Threshold Accelerated Failure Time Model.”
The Annals of Statistics 46 (6A): 2657–82.
</p>


<h3>See Also</h3>

<p><code>grpreg</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(grpreg)
# Generate simulated data with 500 samples and normal error distribution
dataset &lt;- MTAFT_simdata(n = 500, err = "normal")
Y &lt;- dataset[, 1]
delta &lt;- dataset[, 2]
Tq &lt;- dataset[, 3]
X &lt;- dataset[, -c(1:3)]
n1 = sum(delta)
c=seq(0.5,1.5,0.1)
m=ceiling(c*sqrt(n1))
bicy= rep(NA,length(c))
tsmc=NULL
p = ncol(X)
for(i in 1:length(c)){
    tsm=try(TSMCP(Y,X,delta,c[i],penalty = "scad"),silent=TRUE)
    if(is(tsm,"try-error")) next()
    bicy[i]=log(n)*((length(tsm[[1]])+1)*(p+1))+n*log(tsm[[3]])
    tsmc[[i]]=tsm
}

if((any(!is.na(bicy)))){
    tsmcp=tsmc[[which(bicy==min(bicy))[1]]]
    thre.LJ = Tq[tsmcp[[1]]]
    thre.num.Lj = length(thre.LJ)
    thre.LJ
    thre.num.Lj
}

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
