<!DOCTYPE html><html lang="en"><head><title>Help for package mixedbiastest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mixedbiastest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mixedbiastest-package'><p>mixedbiastest: Bias Diagnostics for Linear Mixed Models</p></a></li>
<li><a href='#example_data'><p>Example Dataset for the mixedbiastest Package</p></a></li>
<li><a href='#list_fixed_effects'><p>List Fixed Effects from an lmerMod Object</p></a></li>
<li><a href='#mixedbiastest'><p>Bias Diagnostic for Linear Mixed Models</p></a></li>
<li><a href='#plot.mixedbiastest'><p>Plot Method for Bias Diagnostic Results</p></a></li>
<li><a href='#print.mixedbiastest'><p>Print Method for Bias Diagnostic Results</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bias Diagnostic for Linear Mixed Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-12-13</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew T. Karl &lt;akarl@asu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a function to perform bias diagnostics on linear mixed models fitted with lmer() from the 'lme4' package. Implements permutation tests for assessing the bias of fixed effects, as described in Karl and Zimmerman (2021) &lt;<a href="https://doi.org/10.1016%2Fj.jspi.2020.06.004">doi:10.1016/j.jspi.2020.06.004</a>&gt;. Karl and Zimmerman (2020) &lt;<a href="https://doi.org/10.17632%2Ftmynggddfm.1">doi:10.17632/tmynggddfm.1</a>&gt; provide R code for implementing the test using 'mvglmmRank' output. Development of this package was assisted by 'GPT o1-preview' for code structure and documentation.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>lme4, Matrix, ggplot2, rlang</td>
</tr>
<tr>
<td>Suggests:</td>
<td>plm</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-13 06:38:28 UTC; andre</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrew T. Karl <a href="https://orcid.org/0000-0002-5933-8706"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-13 06:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mixedbiastest-package'>mixedbiastest: Bias Diagnostics for Linear Mixed Models</h2><span id='topic+mixedbiastest-package'></span>

<h3>Description</h3>

<p>The 'mixedbiastest' package provides a function to perform bias diagnostics on linear mixed models fitted with 'lmer' from the 'lme4' package. It implements permutation tests for assessing the bias of fixed effects, as described in Karl and Zimmerman (2021).
</p>


<h3>Functions</h3>


<dl>
<dt><code><a href="#topic+mixedbiastest">mixedbiastest</a></code></dt><dd><p>Performs the bias diagnostic test.</p>
</dd>
<dt><code><a href="#topic+print.mixedbiastest">print.mixedbiastest</a></code></dt><dd><p>Prints the results of the bias diagnostic.</p>
</dd>
<dt><code><a href="#topic+plot.mixedbiastest">plot.mixedbiastest</a></code></dt><dd><p>Plots the permutation distributions and observed test statistics for each fixed effect.</p>
</dd>
<dt><code><a href="#topic+list_fixed_effects">list_fixed_effects</a></code></dt><dd><p> List Fixed Effects from an lmerMod Object.</p>
</dd>
</dl>



<h3>Acknowledgments</h3>

<p>Development of this package was assisted by GPT o1-preview, which helped in constructing the structure of much of the code and the roxygen documentation. The code is based on the R code provided by Karl and Zimmerman (2020).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Andrew T. Karl <a href="mailto:akarl@asu.edu">akarl@asu.edu</a> (<a href="https://orcid.org/0000-0002-5933-8706">ORCID</a>)
</p>


<h3>References</h3>

<p>Karl, A. T., &amp; Zimmerman, D. L. (2021). A diagnostic for bias in linear mixed model estimators induced by dependence between the random effects and the corresponding model matrix. <em>Journal of Statistical Planning and Inference</em>, <em>212</em>, 70–80. <a href="https://doi.org/10.1016/j.jspi.2020.06.004">doi:10.1016/j.jspi.2020.06.004</a>
</p>
<p>Karl, A., &amp; Zimmerman, D. (2020). Data and Code Supplement for 'A Diagnostic for Bias in Linear Mixed Model Estimators Induced by Dependence Between the Random Effects and the Corresponding Model Matrix'. Mendeley Data, V1. <a href="https://doi.org/10.17632/tmynggddfm.1">doi:10.17632/tmynggddfm.1</a>
</p>

<hr>
<h2 id='example_data'>Example Dataset for the mixedbiastest Package</h2><span id='topic+example_data'></span>

<h3>Description</h3>

<p>A dataset containing 97 observations of three variables: <code>y</code>, <code>x</code>, and <code>group</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 97 rows and 3 variables:
</p>

<dl>
<dt>y</dt><dd><p>Numeric response variable.</p>
</dd>
<dt>x</dt><dd><p>Numeric predictor variable.</p>
</dd>
<dt>group</dt><dd><p>Integer indicating group membership.</p>
</dd>
</dl>


<hr>
<h2 id='list_fixed_effects'>List Fixed Effects from an lmerMod Object</h2><span id='topic+list_fixed_effects'></span>

<h3>Description</h3>

<p>This function lists the fixed effects coefficients from an 'lmerMod' object, providing the index and name of each coefficient. This can help users construct contrast vectors ('k_list') for use with the 'mixedbiastest' function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_fixed_effects(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="list_fixed_effects_+3A_model">model</code></td>
<td>
<p>An object of class 'lmerMod' fitted using 'lmer' from the 'lme4' package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with two columns:
</p>

<dl>
<dt><code>Index</code></dt><dd><p>The index of each fixed effect coefficient.</p>
</dd>
<dt><code>Coefficient</code></dt><dd><p>The name of each fixed effect coefficient.</p>
</dd>
</dl>



<h3>Acknowledgments</h3>

<p>Development of this package was assisted by GPT o1-preview, which helped in constructing the structure of much of the code and the roxygen documentation. The code is based on the R code provided by Karl and Zimmerman (2020).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace("plm", quietly = TRUE) &amp;&amp; requireNamespace("lme4", quietly = TRUE)) {
  library(lme4)
  data("Gasoline", package = "plm")
  # Fit a random effects model using lme4
  mixed_model &lt;- lmer(lgaspcar ~ lincomep + lrpmg + lcarpcap + (1 | country),
                      data = Gasoline, REML = FALSE)

  # List fixed effects
  fixed_effects &lt;- list_fixed_effects(mixed_model)
  print(fixed_effects)

  # Suppose we want to test the contrast: lincomep - lcarpcap
  p &lt;- nrow(fixed_effects)
  k &lt;- rep(0, p)
  k[fixed_effects$Index[fixed_effects$Coefficient == "lincomep"]] &lt;- 1
  k[fixed_effects$Index[fixed_effects$Coefficient == "lcarpcap"]] &lt;- -1

  # Run the bias test with the custom contrast
  result &lt;- mixedbiastest(mixed_model, k_list = list(k))
  print(result)
  plot(result)
} else {
  message("Please install 'plm' and 'lme4' packages to run this example.")
}
</code></pre>

<hr>
<h2 id='mixedbiastest'>Bias Diagnostic for Linear Mixed Models</h2><span id='topic+mixedbiastest'></span>

<h3>Description</h3>

<p>Performs a permutation test to assess the bias of fixed effects in a linear mixed model fitted with 'lmer'.
This function computes the test statistic and performs the permutation test, returning an object of class '&quot;mixedbiastest&quot;'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixedbiastest(model, n_permutations = 10000, k_list = NULL, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mixedbiastest_+3A_model">model</code></td>
<td>
<p>An object of class 'lmerMod' fitted using 'lmer' from the 'lme4' package.</p>
</td></tr>
<tr><td><code id="mixedbiastest_+3A_n_permutations">n_permutations</code></td>
<td>
<p>Integer. Number of permutations to perform (default is 10000).</p>
</td></tr>
<tr><td><code id="mixedbiastest_+3A_k_list">k_list</code></td>
<td>
<p>Optional list of numeric vectors. Each vector specifies a linear combination of fixed effects to test. If 'NULL', each fixed effect is tested individually.</p>
</td></tr>
<tr><td><code id="mixedbiastest_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If 'TRUE', prints detailed messages during execution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>**Note:** This function currently supports only models with diagonal random effects covariance matrices (i.e., the G matrix is diagonal). The methodology for non-diagonal G matrices is described in Karl and Zimmerman (2021), but is not implemented in this version of the package.
</p>
<p>See the <code><a href="#topic+list_fixed_effects">list_fixed_effects</a></code> function if you would like to estimate the bias of a contrast of fixed effects.
</p>


<h3>Value</h3>

<p>An object of class <code>"mixedbiastest"</code> containing:
</p>

<dl>
<dt><code>results_table</code></dt><dd><p>A data frame with the test results for each fixed effect or contrast, including bias estimates and p-values.</p>
</dd>
<dt><code>permutation_values</code></dt><dd><p>A list of numeric vectors containing permutation values for each fixed effect or contrast.</p>
</dd>
<dt><code>model</code></dt><dd><p>The original <code>lmerMod</code> model object provided as input.</p>
</dd>
</dl>



<h3>Acknowledgments</h3>

<p>Development of this package was assisted by GPT o1-preview, which helped in constructing the structure of much of the code and the roxygen documentation. The code is based on the R code provided by Karl and Zimmerman (2020).
</p>


<h3>References</h3>

<p>Karl, A. T., &amp; Zimmerman, D. L. (2021). A diagnostic for bias in linear mixed model estimators induced by dependence between the random effects and the corresponding model matrix. <em>Journal of Statistical Planning and Inference</em>, <em>212</em>, 70–80. <a href="https://doi.org/10.1016/j.jspi.2020.06.004">doi:10.1016/j.jspi.2020.06.004</a>
</p>
<p>Karl, A., &amp; Zimmerman, D. (2020). Data and Code Supplement for 'A Diagnostic for Bias in Linear Mixed Model Estimators Induced by Dependence Between the Random Effects and the Corresponding Model Matrix'. Mendeley Data, V1. <a href="https://doi.org/10.17632/tmynggddfm.1">doi:10.17632/tmynggddfm.1</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace("plm", quietly = TRUE) &amp;&amp; requireNamespace("lme4", quietly = TRUE)) {
library(lme4)
data("Gasoline", package = "plm")
# Fit a random effects model using lme4
mixed_model &lt;- lmer(lgaspcar ~ lincomep + lrpmg + lcarpcap + (1 | country),
                    data = Gasoline)
result &lt;- mixedbiastest(mixed_model)
print(result)
plot(result)
}
if (requireNamespace("lme4", quietly = TRUE)) {
library(lme4)
example_model &lt;- lmer(y ~ x + (1| group), data = example_data)
result2 &lt;- mixedbiastest(example_model)
print(result2)
plot(result2)


#Simulate data
set.seed(123)
n_groups &lt;- 30
n_obs_per_group &lt;- 10
group &lt;- rep(1:n_groups, each = n_obs_per_group)
x &lt;- runif(n_groups * n_obs_per_group)
beta0 &lt;- 2
beta1 &lt;- 5
sigma_u &lt;- 1
sigma_e &lt;- 0.5
u &lt;- rnorm(n_groups, 0, sigma_u)
e &lt;- rnorm(n_groups * n_obs_per_group, 0, sigma_e)
y &lt;- beta0 + beta1 * x + u[group] + e
data_sim &lt;- data.frame(y = y, x = x, group = factor(group))
model3 &lt;- lmer(y ~ x + (1 | group), data = data_sim)
result3 &lt;- mixedbiastest(model3, verbose = TRUE)
plot(result3)
}
</code></pre>

<hr>
<h2 id='plot.mixedbiastest'>Plot Method for Bias Diagnostic Results</h2><span id='topic+plot.mixedbiastest'></span>

<h3>Description</h3>

<p>Plots the permutation distributions and observed test statistics for each fixed effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixedbiastest'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.mixedbiastest_+3A_x">x</code></td>
<td>
<p>An object of class '&quot;mixedbiastest&quot;'.</p>
</td></tr>
<tr><td><code id="plot.mixedbiastest_+3A_...">...</code></td>
<td>
<p>Additional arguments (currently not used).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object showing permutation distributions for all fixed effects.
</p>

<hr>
<h2 id='print.mixedbiastest'>Print Method for Bias Diagnostic Results</h2><span id='topic+print.mixedbiastest'></span>

<h3>Description</h3>

<p>Prints the results of the bias diagnostic in a formatted table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixedbiastest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.mixedbiastest_+3A_x">x</code></td>
<td>
<p>An object of class '&quot;mixedbiastest&quot;'.</p>
</td></tr>
<tr><td><code id="print.mixedbiastest_+3A_...">...</code></td>
<td>
<p>Additional arguments (currently not used).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. This function is called for its side effects (printing the results).
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
