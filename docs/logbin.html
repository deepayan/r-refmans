<!DOCTYPE html><html><head><title>Help for package logbin</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {logbin}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anova.logbin'>
<p>Analysis of Deviance for logbin Fits</p></a></li>
<li><a href='#B.Iso'>
<p>Defining Smooths in logbin.smooth Formulae</p></a></li>
<li><a href='#confint.logbin'>
<p>Confidence Intervals for logbin Model Parameters</p></a></li>
<li><a href='#contr.isotonic.rev'>
<p>Contrast Matrix for Reversed Isotonic Covariate</p></a></li>
<li><a href='#interpret.logbin.smooth'>
<p>Interpret a logbin.smooth Formula</p></a></li>
<li><a href='#logbin'>
<p>Log-Binomial Regression</p></a></li>
<li><a href='#logbin-package'>
<p>Relative Risk Regression Using the Log-Binomial Model</p></a></li>
<li><a href='#logbin.control'>
<p>Auxiliary for Controlling logbin Fitting</p></a></li>
<li><a href='#logbin.smooth'>
<p>Smooth Log-Binomial Regression</p></a></li>
<li><a href='#nplbin'>
<p>Non-Positive Log-Binomial Regression</p></a></li>
<li><a href='#plot.logbin.smooth'>
<p>Default logbin.smooth Plotting</p></a></li>
<li><a href='#predict.logbin'>
<p>Predict Method for logbin Fits</p></a></li>
<li><a href='#predict.logbin.smooth'>
<p>Predict Method for logbin.smooth Fits</p></a></li>
<li><a href='#summary.logbin'>
<p>Summarising logbin Model Fits</p></a></li>
<li><a href='#vcov.logbin'>
<p>Calculate Variance-Covariance Matrix for a Fitted logbin Model Object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Relative Risk Regression Using the Log-Binomial Model</td>
</tr>
<tr>
<td>Description:</td>
<td>Methods for fitting log-link GLMs and GAMs to binomial data,
    including EM-type algorithms with more stable convergence properties than standard methods.</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.5</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>splines, glm2, turboEM (&ge; 2021.1), Matrix, itertools2,
iterators</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mdonoghoe/logbin">https://github.com/mdonoghoe/logbin</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-08-09 20:49:56 UTC; Mark</td>
</tr>
<tr>
<td>Author:</td>
<td>Mark W. Donoghoe <a href="https://orcid.org/0000-0003-0212-6443"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Ian C. Marschner <a href="https://orcid.org/0000-0002-6225-1572"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ths],
  Alexandra C. Gillett
    <a href="https://orcid.org/0000-0002-5069-3197"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb] (wrote
    an initial version of the nplbin function)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mark W. Donoghoe &lt;markdonoghoe@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-08-09 21:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='anova.logbin'>
Analysis of Deviance for logbin Fits
</h2><span id='topic+anova.logbin'></span><span id='topic+anova.logbinlist'></span>

<h3>Description</h3>

<p>Compute an analysis of deviance table for more than one GLM
fitted using <code><a href="#topic+logbin">logbin</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'logbin'
anova(object, ..., test = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anova.logbin_+3A_object">object</code>, <code id="anova.logbin_+3A_...">...</code></td>
<td>

<p>objects of class <code>"logbin"</code>,
typically the result of a call to <code><a href="#topic+logbin">logbin</a></code>,
or a <code><a href="base.html#topic+list">list</a></code> of <code>objects</code> for the &quot;<code>logbinlist</code>&quot;
method.
</p>
</td></tr>
<tr><td><code id="anova.logbin_+3A_test">test</code></td>
<td>

<p>a character string, (partially) matching one
of <code>"Chisq"</code>, <code>"LRT"</code>, <code>"Rao"</code>, <code>"F"</code>
or <code>"Cp"</code>. See <code><a href="stats.html#topic+stat.anova">stat.anova</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Unlike <code><a href="stats.html#topic+anova.glm">anova.glm</a></code>, specifying a single object
is not allowed.
</p>
<p>The table has a row for the residual degrees of freedom and
deviance for each model. For all but the first model, the
change in degrees of freedom and deviance is also given.
(This only makes statistical sense if the models are
nested.) It is conventional to list the models from
smallest to largest, but this is up to the user.
</p>
<p>Models where the MLE lies on the boundary of the parameter
space will be automatically removed from the list (with a
warning), because asymptotic results to not apply to such
models.
</p>
<p>The table will optionally contain test statistics (and p-values) 
comparing the reduction in deviance for the row to
the residuals. Mallows' <em>Cp</em> statistic is the residual
deviance plus twice the estimate of <code class="reqn">\sigma^2</code> times
the residual degrees of freedom, which is closely related
to AIC. You can also choose <code>"LRT"</code> and <code>"Rao"</code>
for likelihood ratio tests and Rao's efficient score test.
The former is synonymous with <code>"Chisq"</code> (although both
have an asymptotic chi-square distribution).
</p>


<h3>Value</h3>

<p>An object of class <code>"anova"</code> inheriting from class
<code>"data.frame"</code>.
</p>


<h3>Author(s)</h3>

<p>Mark W. Donoghoe <a href="mailto:markdonoghoe@gmail.com">markdonoghoe@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logbin">logbin</a></code>, <code><a href="stats.html#topic+anova.glm">anova.glm</a></code>,
<code><a href="stats.html#topic+anova">anova</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## For an example, see example(logbin)
</code></pre>

<hr>
<h2 id='B.Iso'>
Defining Smooths in logbin.smooth Formulae
</h2><span id='topic+B'></span><span id='topic+Iso'></span>

<h3>Description</h3>

<p>Function used in the definition of smooth terms within <code><a href="#topic+logbin.smooth">logbin.smooth</a></code>
model formulae. The function does not evaluate a smooth &mdash; it exists purely to help
set up a model using smooths.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>B(..., knots = NULL, knot.range = 0:5)

Iso(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="B.Iso_+3A_...">...</code></td>
<td>

<p>variable that this smooth is a function of. Note that unlike <code><a href="mgcv.html#topic+gam">gam</a></code>,
smooths that are functions of more than one variable are not supported.
</p>
</td></tr>
<tr><td><code id="B.Iso_+3A_knots">knots</code></td>
<td>

<p><em>unique</em> positions of <em>interior</em> knots of a B-spline basis. Boundary
knots are created automatically.
</p>
</td></tr>
<tr><td><code id="B.Iso_+3A_knot.range">knot.range</code></td>
<td>

<p>if <code>knots</code> is not specified, a vector containing a series of non-negative
integers denoting the number of <em>interior</em> knots for which the model will be fit.
These are placed at evenly-spaced quantiles of the observed covariate values.
</p>
<p>At least one of <code>knots</code> or <code>knot.range</code> must be non-missing.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function does not evaluate the variable arguments; the
output from this function is used when producing the model
matrix, at which point the actual basis functions are constructed.
</p>
<p><code>B</code> is used to specify an order-3 B-spline basis (which can be
restricted to be monotonically non-decreasing via the
<code>mono</code> argument in <code><a href="#topic+logbin.smooth">logbin.smooth</a></code>). If
<code>length(knot.range) &gt; 1</code>, models with each of the
specified number of interior knots will be fit, and the model
with the best (smallest) <code>aic.c</code> will be returned.
</p>
<p><code>Iso</code> is used to specify an isotonic basis, designed
such that the resulting function has non-negative
increments at each observed covariate value. When
<code>Iso</code> is used, the resulting function will always be
monotonically non-decreasing, regardless of the value of
<code>mono</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"B.smooth"</code> (for <code>B</code>) or
<code>"Iso.smooth"</code> (for <code>Iso</code>), which is a list with
the following elements: </p>
<table>
<tr><td><code>term</code></td>
<td>
<p>name of the term
provided in the <code>...</code> argument.</p>
</td></tr>
<tr><td><code>termlabel</code></td>
<td>
<p>label for the term in the model; e.g. for
term <code>"x"</code> it will be <code>"B(x)"</code> or
<code>"Iso(x)"</code>.</p>
</td></tr> <tr><td><code>knots</code></td>
<td>
<p>vector of interior knots (if
specified). <code>NA</code> for <code>Iso</code>.</p>
</td></tr>
<tr><td><code>knot.range</code></td>
<td>
<p>vector of number of interior knots.
<code>NA</code> for <code>Iso</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mark W. Donoghoe <a href="mailto:markdonoghoe@gmail.com">markdonoghoe@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logbin.smooth">logbin.smooth</a></code>
</p>
<p><code><a href="mgcv.html#topic+s">s</a></code> performs a similar function in the <code><a href="mgcv.html#topic+mgcv-package">mgcv</a></code> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example(logbin.smooth) for an example of specifying smooths in model
##  formulae.
</code></pre>

<hr>
<h2 id='confint.logbin'>
Confidence Intervals for logbin Model Parameters
</h2><span id='topic+confint.logbin'></span>

<h3>Description</h3>

<p>Computes confidence intervals for one or more parameters in
a fitted <code><a href="#topic+logbin">logbin</a></code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'logbin'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.logbin_+3A_object">object</code></td>
<td>

<p>a fitted model object, resulting from a
call to <code><a href="#topic+logbin">logbin</a></code>.
</p>
</td></tr>
<tr><td><code id="confint.logbin_+3A_parm">parm</code></td>
<td>

<p>a specification of which parameters are to be
given confidence intervals, either a vector of numbers or
a vector of names. If missing, all parameters are
considered.
</p>
</td></tr>
<tr><td><code id="confint.logbin_+3A_level">level</code></td>
<td>

<p>the confidence level required.
</p>
</td></tr>
<tr><td><code id="confint.logbin_+3A_...">...</code></td>
<td>

<p>additional argument(s) passed to <code><a href="stats.html#topic+confint.default">confint.default</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates confidence intervals for model parameters assuming 
asymptotic normality and using the result from <code><a href="#topic+vcov.logbin">vcov.logbin</a>(object)</code>. 
As such, if the MLE is on the boundary of the parameter space,
(as per <code>object$boundary</code>) the normality assumption 
is invalid and <code>NA</code> is returned.
</p>


<h3>Value</h3>

<p>A matrix (or vector) with columns giving lower and upper
confidence limits for each parameter. These will be
labelled as (1-level)/2 and 1-(1-level)/2 in % (by default
2.5% and 97.5%).
</p>


<h3>Author(s)</h3>

<p>Mark W. Donoghoe <a href="mailto:markdonoghoe@gmail.com">markdonoghoe@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+confint.default">confint.default</a></code>, <code><a href="#topic+vcov.logbin">vcov.logbin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## For an example, see example(logbin)
</code></pre>

<hr>
<h2 id='contr.isotonic.rev'>
Contrast Matrix for Reversed Isotonic Covariate
</h2><span id='topic+contr.isotonic.rev'></span>

<h3>Description</h3>

<p>Return something similar to a contrast matrix for a categorical
covariate that we wish to be monotonically non-decreasing
in a specified order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contr.isotonic.rev(n, perm, contrasts = TRUE, sparse = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="contr.isotonic.rev_+3A_n">n</code></td>
<td>

<p>a vector of levels for a factor, or the number
of levels.
</p>
</td></tr>
<tr><td><code id="contr.isotonic.rev_+3A_perm">perm</code></td>
<td>

<p>a permutation of the levels of <code>n</code> (or
of the numbers <code>1:n</code>), which define the order in
which the coefficients must be monotonically
non-decreasing.
</p>
</td></tr>
<tr><td><code id="contr.isotonic.rev_+3A_contrasts">contrasts</code></td>
<td>

<p>a logical indicating whether constrasts
should be computed.
</p>
</td></tr>
<tr><td><code id="contr.isotonic.rev_+3A_sparse">sparse</code></td>
<td>

<p>included for compatibility reasons. Has no
effect.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used in creating the design matrix
for categorical covariates with a specified order under a
particular parameterisation. This is required
if a categorical covariate is defined as monotonic.
</p>
<p>In the order specified by <code>perm</code>, the coefficient
associated with each level is the sum of increments between
the following levels. That is, if there are a total of <code class="reqn">k</code>
levels, the first level is defined as <code class="reqn">d_2 + d_3 + d_4 + \cdots + d_k</code>, 
the second as <code class="reqn">d_3 + d_4 + \cdots + d_k</code>, 
the third as <code class="reqn">d_4 + \cdots + d_k</code>, and so on.  In fitting the model, 
these increments are constrained to be non-positive.
</p>
<p>Note that these are not &lsquo;contrasts&rsquo; as defined in the
theory for linear models, rather this is used to define the
<code>contrasts</code> attribute of each variable so that
<code><a href="stats.html#topic+model.matrix">model.matrix</a></code> produces the desired design
matrix.
</p>


<h3>Value</h3>

<p>A matrix with <code>n</code> rows and <code class="reqn">k</code> columns, with
<code class="reqn">k=n-1</code> if <code>contrasts</code> is <code>TRUE</code> and
<code class="reqn">k=n</code> if <code>contrasts</code> is <code>FALSE</code>.
</p>


<h3>Author(s)</h3>

<p>Mark W. Donoghoe <a href="mailto:markdonoghoe@gmail.com">markdonoghoe@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+model.matrix">model.matrix</a></code>, which uses
<code>contr.isotonic.rev</code> to create the design matrix.
</p>
<p><code><a href="stats.html#topic+contr.treatment">contr.treatment</a></code>, <code><a href="stats.html#topic+contrasts">contrasts</a></code> for
their usual use in regression models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>contr.isotonic.rev(4,1:4)
contr.isotonic.rev(4,c(1,3,2,4))

# Show how contr.isotonic.rev applies within model.matrix
x &lt;- factor(round(runif(20,0,2)))
mf &lt;- model.frame(~x)
contrasts(x) &lt;- contr.isotonic.rev(levels(x), levels(x))
model.matrix(mf)
</code></pre>

<hr>
<h2 id='interpret.logbin.smooth'>
Interpret a logbin.smooth Formula
</h2><span id='topic+interpret.logbin.smooth'></span>

<h3>Description</h3>

<p>This is an internal function of package <code><a href="#topic+logbin-package">logbin</a></code>.
It is a service routine for <code><a href="#topic+logbin.smooth">logbin.smooth</a></code> which interprets the
smooth parts of the model formula and returns modified formulas to be used
in the fitting functions.
</p>
<p>Not normally called directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interpret.logbin.smooth(formula)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interpret.logbin.smooth_+3A_formula">formula</code></td>
<td>

<p>A formula as supplied to <code><a href="#topic+logbin.smooth">logbin.smooth</a></code>, which includes
at least one <code><a href="#topic+B">B</a></code> or <code><a href="#topic+Iso">Iso</a></code> term.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>full.formula</code></td>
<td>
<p>a <code><a href="stats.html#topic+formula">formula</a></code> object which is the same as
the <code>formula</code> supplied, but with additional arguments removed from
the smooth terms. E.g. <code>B(x, knot.range = 0:2)</code> would appear as
<code>B(x)</code> in this formula.</p>
</td></tr>
<tr><td><code>fake.formula</code></td>
<td>
<p>a <code><a href="stats.html#topic+formula">formula</a></code> object which is the same as
the <code>formula</code> supplied, but with smooth terms replaced by their
covariates alone. E.g. <code>B(x, knot.range = 0:2)</code> would appear as 
<code>x</code> in this formula. Used to construct the model matrix.</p>
</td></tr>
<tr><td><code>smooth.spec</code></td>
<td>
<p>a named list containing the results of <code><a href="base.html#topic+eval">eval</a></code>uating
the smooth terms. See <code><a href="#topic+B">B</a></code> and <code><a href="#topic+Iso">Iso</a></code> for details.</p>
</td></tr>
<tr><td><code>smooth.ind</code></td>
<td>
<p>a vector containing the indices of the smooth components in
the <code>formula</code>.</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>the result of running <code><a href="stats.html#topic+terms.formula">terms.formula</a>(formula, specials = c("B", "Iso"))</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mark W. Donoghoe <a href="mailto:markdonoghoe@gmail.com">markdonoghoe@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logbin.smooth">logbin.smooth</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Specify a smooth model with knot.range
res &lt;- interpret.logbin.smooth(y ~ B(x, knot.range = 0:2) + x2)
# The knot.range is removed from the full.formula...
print(res$full.formula)
# ...but is stored in the $smooth.spec component of the result:
print(res$smooth.spec$x$knot.range)
</code></pre>

<hr>
<h2 id='logbin'>
Log-Binomial Regression
</h2><span id='topic+logbin'></span>

<h3>Description</h3>

<p><code>logbin</code> fits relative risk (log-link) binomial
regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logbin(formula, mono = NULL, data, subset, na.action, start = NULL,
       offset, control = list(...), model = TRUE, 
       method = c("cem", "em", "glm", "glm2", "ab"),
       accelerate = c("em", "squarem", "pem", "qn"), 
       control.method = list(), warn = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logbin_+3A_formula">formula</code></td>
<td>

<p>an object of class <code>"<a href="stats.html#topic+formula">formula</a>"</code>
(or one that can be coerced into that class): a symbolic
description of the model to be fitted. The details of
model specification are given under &quot;Details&quot;.  Note that
the model must contain an intercept, and 2nd-order terms
(such as interactions) or above are currently not supported
by the <code>"cem"</code> and <code>"em"</code> methods &mdash; see &quot;Note&quot;.
</p>
</td></tr>
<tr><td><code id="logbin_+3A_mono">mono</code></td>
<td>

<p>a vector indicating which terms in
<code>formula</code> should be restricted to have a
monotonically non-decreasing relationship with the
outcome. May be specified as names or indices of the
terms.
</p>
<p><code>method = "glm"</code> and <code>"glm2"</code> cannot impose
monotonicity constraints, and they are not currently
supported for <code>method = "ab"</code>.
</p>
</td></tr>
<tr><td><code id="logbin_+3A_data">data</code></td>
<td>

<p>an optional data frame, list or environment
(or object coercible by <code><a href="base.html#topic+as.data.frame">as.data.frame</a></code> to a
data frame) containing the variables in the model. If not
found in <code>data</code>, the variables are taken from
<code><a href="base.html#topic+environment">environment</a>(formula)</code>, typically the environment
from which <code>logbin</code> is called.
</p>
</td></tr>
<tr><td><code id="logbin_+3A_subset">subset</code></td>
<td>

<p>an optional vector specifying a subset of
observations to be used in the fitting process.
</p>
</td></tr>
<tr><td><code id="logbin_+3A_na.action">na.action</code></td>
<td>

<p>a function which indicates what should happen when the data
contain <code>NA</code>s. The default is set be the <code>na.action</code>
setting of <code><a href="base.html#topic+options">options</a></code>, and is <code><a href="stats.html#topic+na.fail">na.fail</a></code>
if that is unset. The &lsquo;factory-fresh&rsquo; default is <code><a href="stats.html#topic+na.omit">na.omit</a></code>.
Another possible value is <code>NULL</code>, no action. Value
<code><a href="stats.html#topic+na.exclude">na.exclude</a></code> can be useful.
</p>
</td></tr>
<tr><td><code id="logbin_+3A_start">start</code></td>
<td>

<p>starting values for the parameters in the
linear predictor.
</p>
</td></tr>
<tr><td><code id="logbin_+3A_offset">offset</code></td>
<td>

<p>this can be used to specify an <em>a
priori</em> known component to be included in the linear
predictor during fitting. This should be <code>NULL</code> or a
<em>non-positive</em> numeric vector of length equal to the number of cases.
One or more <code><a href="stats.html#topic+offset">offset</a></code> terms can be included in
the formula instead or as well, and if more than one is
specified their sum is used. See
<code><a href="stats.html#topic+model.offset">model.offset</a></code>.
</p>
</td></tr>
<tr><td><code id="logbin_+3A_control">control</code></td>
<td>

<p>a list of parameters for controlling the
fitting process, passed to
<code><a href="#topic+logbin.control">logbin.control</a></code>.
</p>
<p>With <code>method = "cem"</code>, <code>epsilon</code>
should be smaller than <code>bound.tol</code>.
</p>
</td></tr>
<tr><td><code id="logbin_+3A_model">model</code></td>
<td>

<p>a logical value indicating whether the <em>model frame</em> 
should be included as a component of the returned value.
</p>
</td></tr>
<tr><td><code id="logbin_+3A_method">method</code></td>
<td>

<p>a character string that determines which algorithm to use
to find the MLE. The main purpose of <code>logbin</code> is the
implementation of stable EM-type algorithms: <code>"cem"</code> for 
the combinatorial EM algorithm, which cycles through a sequence 
of constrained parameter spaces, or <code>"em"</code> for a single EM 
algorithm based on an overparameterised model.
</p>
<p><code>"ab"</code> implements an adaptive barrier method, using the
<code><a href="stats.html#topic+constrOptim">constrOptim</a></code> function.
</p>
<p><code>"<a href="stats.html#topic+glm">glm</a>"</code> or <code>"<a href="glm2.html#topic+glm2">glm2</a>"</code> may be used
to compare the results from the usual IWLS algorithms on the same model.
</p>
</td></tr>
<tr><td><code id="logbin_+3A_accelerate">accelerate</code></td>
<td>

<p>for the <code>"cem"</code> and <code>"em"</code> methods, a character string that determines the acceleration
algorithm to be used, (partially) matching one of <code>"em"</code> (no acceleration &mdash; the default), 
<code>"squarem"</code>, <code>"pem"</code> or <code>"qn"</code>. See <code><a href="turboEM.html#topic+turboem">turboem</a></code>
for further details. Note that <code>"decme"</code> is not permitted.
</p>
</td></tr>
<tr><td><code id="logbin_+3A_control.method">control.method</code></td>
<td>

<p>a list of control parameters for the fitting algorithm.
</p>
<p>This is passed to the <code>control.method</code> argument of <code><a href="turboEM.html#topic+turboem">turboem</a></code>
if <code>method = "cem"</code> or <code>"em"</code>.
</p>
<p>If <code>method = "ab"</code>, this is passed to the <code>control</code> argument of
<code><a href="stats.html#topic+constrOptim">constrOptim</a></code> (and hence to <code><a href="stats.html#topic+optim">optim</a></code> &mdash; see this documentation
for full details). Note that the <code>trace</code> and <code>maxit</code> elements are 
ignored and the equivalent items from the supplied <code>logbin.control</code> argument
are used instead. May also contain element <code>method</code> (default <code>"BFGS"</code>), 
which is passed to the <code>method</code> argument of <code><a href="stats.html#topic+constrOptim">constrOptim</a></code>.
</p>
<p>If any items are not specified, the defaults are used.
</p>
</td></tr>
<tr><td><code id="logbin_+3A_warn">warn</code></td>
<td>

<p>a logical indicating whether or not warnings should be
provided for non-convergence or boundary values.
</p>
</td></tr>
<tr><td><code id="logbin_+3A_...">...</code></td>
<td>

<p>arguments to be used to form the default
<code>control</code> argument if it is not supplied directly.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>logbin</code> fits a generalised linear model (GLM) with a
binomial error distribution and log link
function. Predictors are assumed to be continuous, unless
they are of class <code><a href="base.html#topic+factor">factor</a></code>, or are character or
logical (in which case they are converted to
<code>factor</code>s). Specifying a predictor as monotonic using
the <code>mono</code> argument means that for continuous terms,
the associated coefficient will be restricted to be
non-negative, and for categorical terms, the coefficients
will be non-decreasing in the order of the factor
<code><a href="base.html#topic+levels">levels</a></code>. This allows semi-parametric monotonic regression
functions, in the form of unsmoothed step-functions. For 
smooth regression functions see <code><a href="#topic+logbin.smooth">logbin.smooth</a></code>.
</p>
<p>As well as allowing monotonicity constraints, the function 
is useful when a standard GLM routine, such as
<code><a href="stats.html#topic+glm">glm</a></code>, fails to converge with a log-link
binomial model. For convenience in comparing convergence on
the same model, <code>logbin</code> can be used
as a wrapper function to <code><a href="stats.html#topic+glm">glm</a></code> and <code><a href="glm2.html#topic+glm2">glm2</a></code>
through the <code>method</code> argument. 
</p>
<p>If <code><a href="stats.html#topic+glm">glm</a></code> does achieve successful convergence,
and <code>logbin</code> converges to an interior point, then the two
results will be identical. However, as illustrated in one of 
the examples below, <code><a href="stats.html#topic+glm">glm</a></code> may still experience convergence 
problems even when <code>logbin</code> converges to an interior point. 
Note that if <code>logbin</code> converges to a boundary point, then it 
may differ slightly from <code><a href="stats.html#topic+glm">glm</a></code> even if <code><a href="stats.html#topic+glm">glm</a></code> successfully 
converges, because of differences in the definition of the parameter 
space. <code>logbin</code> produces valid fitted values for covariate 
values within the Cartesian product of the observed range of covariate 
values, whereas <code><a href="stats.html#topic+glm">glm</a></code> produces valid fitted values just 
for the observed covariate combinations (assuming it successfully 
converges). This issue is only relevant when <code>logbin</code> 
converges to a boundary point. The adaptive barrier approach defines 
the parameter space in the same way as <code><a href="stats.html#topic+glm">glm</a></code>, so the
same comments apply when comparing its results to those from
<code>method = "cem"</code> or <code>"em"</code>.
</p>
<p>The main computational method is an EM-type algorithm which accommodates 
the parameter contraints in the model and is more stable than iteratively
reweighted least squares. This is done in one of two ways,
depending on the choice of the <code>method</code> argument.
</p>
<p><code>method = "cem"</code> implements a CEM algorithm (Marschner, 2014),
in which a collection of restricted parameter spaces is defined 
that covers the full parameter space, and an EM algorithm is applied within each
restricted parameter space in order to find a collection of
restricted maxima of the log-likelihood function, from
which can be obtained the global maximum over the full
parameter space. See Marschner and Gillett (2012) for further
details.
</p>
<p><code>method = "em"</code> implements a single EM algorithm
on an overparameterised model, and the MLE of this model
is transformed back to the original parameter space.
</p>
<p>Acceleration of the EM algorithm in either case can be
achieved through the methods of the <code><a href="turboEM.html#topic+turboem">turboem</a></code>
package, specified through the <code>accelerate</code> argument. However,
note that these methods do not have the guaranteed convergence of
the standard EM algorithm, particularly when the MLE is on the
boundary of its (possibly constrained) parameter space.
</p>
<p>Alternatively, an adaptive barrier method can be used by specifying
<code>method = "ab"</code>, which maximises the likelihood subject to
constraints on the fitted values.
</p>


<h3>Value</h3>

<p><code>logbin</code> returns an object of class <code>"logbin"</code>,
which inherits from classes <code>"glm"</code> and <code>"lm"</code>.
The function <code><a href="#topic+summary.logbin">summary.logbin</a></code> can be used 
to obtain or print a summary of the results.
</p>
<p>The generic accessor functions <code><a href="stats.html#topic+coefficients">coefficients</a></code>,
<code><a href="stats.html#topic+fitted.values">fitted.values</a></code> and <code><a href="stats.html#topic+residuals">residuals</a></code> can be used to
extract various useful features of the value returned by
<code>logbin</code>. Note that <code><a href="stats.html#topic+effects">effects</a></code> will not work.
</p>
<p>An object of class <code>"logbin"</code> is a list containing the
same components as an object of class <code>"glm"</code> (see the
&quot;Value&quot; section of <code><a href="stats.html#topic+glm">glm</a></code>). It also includes: 
</p>
<table>
<tr><td><code>loglik</code></td>
<td>
<p>the maximised log-likelihood.</p>
</td></tr>
<tr><td><code>aic.c</code></td>
<td>
<p>a small-sample corrected
version of Akaike's <em>An Information Criterion</em>
(Hurvich, Simonoff and Tsai, 1998). This is used by
<code><a href="#topic+logbin.smooth">logbin.smooth</a></code> to choose the optimal number of
knots for smooth terms.</p>
</td></tr> 
<tr><td><code>xminmax</code></td>
<td>
<p>the minimum and maximum observed values
for each of the continuous covariates, to help define
the covariate space of the model.</p>
</td></tr>
</table>
<p>As well as:
</p>
<table>
<tr><td><code>np.coefficients</code></td>
<td>
<p>estimated coefficients associated
with the non-positive parameterisation corresponding to the
MLE.</p>
</td></tr> 
<tr><td><code>nn.x</code></td>
<td>
<p>non-negative model matrix associated with
<code>np.coefficients</code>.</p>
</td></tr>
<tr><td><code>coefhist</code></td>
<td>
<p>(if <code>control$coeftrace = TRUE</code>), a matrix or
list of matrices containing the coefficient estimates after each
EM iteration.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Due to the way in which the covariate space is defined in the CEM algorithm,
models that include terms that are functionally dependent on one another
&mdash; such as interactions and polynomials &mdash; may give unexpected
results. Categorical covariates should always be entered directly
as factors rather than dummy variables. 2-way interactions between 
factors can be included by calculating a new factor term that 
has levels corresponding to all possible combinations of the factor
levels (see the Example). Non-linear relationships can be included
by using <code><a href="#topic+logbin.smooth">logbin.smooth</a></code>.
</p>


<h3>Author(s)</h3>

<p>Mark W. Donoghoe <a href="mailto:markdonoghoe@gmail.com">markdonoghoe@gmail.com</a>
</p>


<h3>References</h3>

<p>Hurvich, C. M., J. S. Simonoff and C.-L. Tsai (1998). Smoothing parameter 
selection in non-parametric regression using an improved Akaike 
information criterion. <em>Journal of the Royal Statistical Society: Series B 
(Statistical Methodology)</em> 60(2): 271&ndash;293.
</p>
<p>Donoghoe, M. W. and I. C. Marschner (2018). logbin: An R package for relative risk
regression using the log-binomial model. <em>Journal of Statistical Software</em> 
86(9): 1&ndash;22.
</p>
<p>Marschner, I. C. (2014). Combinatorial EM algorithms.
<em>Statistics and Computing</em> 24(6): 921&ndash;940.
</p>
<p>Marschner, I. C. and A. C. Gillett (2012). Relative risk regression: reliable
and flexible methods for log-binomial models. <em>Biostatistics</em> 13(1): 179&ndash;192.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logbin.smooth">logbin.smooth</a></code> for semi-parametric models
</p>
<p><code><a href="turboEM.html#topic+turboem">turboem</a></code> for acceleration methods
</p>
<p><code><a href="stats.html#topic+constrOptim">constrOptim</a></code> for the adaptive barrier approach.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(glm2)
data(heart)

#======================================================
#  Model with periodic non-convergence when glm is used
#======================================================

start.p &lt;- sum(heart$Deaths) / sum(heart$Patients)

fit.glm &lt;- glm(cbind(Deaths, Patients-Deaths) ~ factor(AgeGroup) + factor(Severity) +
  factor(Delay) + factor(Region), family = binomial(log), 
  start = c(log(start.p), rep(c(0.2, 0.4), 4)), data = heart,
  trace = TRUE, maxit = 100)

fit.logbin &lt;- logbin(formula(fit.glm), data = heart, 
                     start = c(log(start.p), rep(c(0.2, 0.4), 4)),
                     trace = 1)
summary(fit.logbin)

# Speed up convergence by using single EM algorithm
fit.logbin.em &lt;- update(fit.logbin, method = "em")

# Speed up convergence by using acceleration methods
fit.logbin.acc &lt;- update(fit.logbin, accelerate = "squarem")
fit.logbin.em.acc &lt;- update(fit.logbin.em, accelerate = "squarem")


#=============================
#  Model with interaction term
#=============================

heart$AgeSev &lt;- 10 * heart$AgeGroup + heart$Severity

fit.logbin.int &lt;- logbin(cbind(Deaths, Patients-Deaths) ~ factor(AgeSev) +
  factor(Delay) + factor(Region), data = heart, trace = 1, maxit = 100000)
  
summary(fit.logbin.int)
vcov(fit.logbin.int)
confint(fit.logbin.int)
summary(predict(fit.logbin.int, type = "response"))
anova(fit.logbin, fit.logbin.int, test = "Chisq")

</code></pre>

<hr>
<h2 id='logbin-package'>
Relative Risk Regression Using the Log-Binomial Model
</h2><span id='topic+logbin-package'></span>

<h3>Description</h3>

<p>Methods for fitting log-link GLMs and GAMs to binomial data, including EM-type
algorithms with more stable convergence properties than standard methods.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> logbin</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.0.5</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>This package provides methods to fit generalised linear models (GLMs) and generalised additive
models (GAMs) with log link functions to binomial data, which can be used to
estimate adjusted relative risks. It has two primary functions: <code><a href="#topic+logbin">logbin</a></code> 
and <code><a href="#topic+logbin.smooth">logbin.smooth</a></code>, together with various supporting functions.
</p>
<p>Standard GLM routines such as base R's <code><a href="stats.html#topic+glm">glm</a></code> typically use a modified Fisher
scoring algorithm, but this can experience numerical problems and fail to converge to the
maximum likelihood estimate (MLE). The <span class="pkg">glm2</span>
package improves on this but can still have difficulties, particularly when the MLE
is on or near the boundary of the parameter space (Marschner, 2015).
</p>
<p>Alternative methods for finding the MLE are provided in this package. For both GLMs and GAMs,
two approaches based on the EM algorithm can be used: a combinatorial EM (CEM) algorithm 
(Marschner, 2014) or an expanded EM algorithm. These accomodate the parameter constraints
and are more stable than iteratively reweighted least squares.
</p>
<p>In a CEM algorithm, a collection of restricted parameter spaces is defined
which covers the full parameter space, and an EM algorithm is applied within each
restricted parameter space in order to find a collection of restricted maxima of
the log-likelihood function, from which can be obtained the global maximum over the
full parameter space. The methodology implemented for this algorithm is presented in 
Marschner and Gillett (2012) and Donoghoe and Marschner (2015).
</p>
<p>In the expanded EM approach, additional parameters are added to the model,
and an EM algorithm finds the MLE of this overparameterised model by imposing
constraints on each individual parameter. This requires a single application of
the EM algorithm.
</p>
<p>In each case, the EM algorithm may be accelerated by using the capabilities of the
<span class="pkg"><a href="turboEM.html#topic+turboem">turboEM</a></span> package.
</p>
<p>For GLMs, an adaptive barrier approach, which uses a constrained optimisation
algorithm, is also provided.
</p>


<h3>Author(s)</h3>

<p>Mark W. Donoghoe <a href="mailto:markdonoghoe@gmail.com">markdonoghoe@gmail.com</a>
</p>
<p>Maintainer: Mark W. Donoghoe <a href="mailto:markdonoghoe@gmail.com">markdonoghoe@gmail.com</a>
</p>


<h3>References</h3>

<p>Donoghoe, M. W. and I. C. Marschner (2015). Flexible regression models for rate 
differences, risk differences and relative risks. <em>International Journal of 
Biostatistics</em> 11(1): 91&ndash;108.
</p>
<p>Donoghoe, M. W. and I. C. Marschner (2018). logbin: An R package for relative risk
regression using the log-binomial model. <em>Journal of Statistical Software</em> 
86(9): 1&ndash;22.
</p>
<p>Marschner, I. C. (2014). Combinatorial EM algorithms.
<em>Statistics and Computing</em> 24(6): 921&ndash;940.
</p>
<p>Marschner, I. C. (2015). Relative risk regression for binary outcomes: Methods
and recommendations. <em>Australian &amp; New Zealand Journal of Statistics</em>. In press.
</p>
<p>Marschner, I. C. and A. C. Gillett (2012). Relative risk regression: Reliable
and flexible methods for log-binomial models. <em>Biostatistics</em> 13(1): 179&ndash;192.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <span class="pkg">glm2</span>, <span class="pkg"><a href="turboEM.html#topic+turboem">turboEM</a></span>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## For examples, see example(logbin) and example(logbin.smooth)
</code></pre>

<hr>
<h2 id='logbin.control'>
Auxiliary for Controlling logbin Fitting
</h2><span id='topic+logbin.control'></span>

<h3>Description</h3>

<p>Auxiliary function for <code><a href="#topic+logbin">logbin</a></code> fitting.
Typically only used internally by <code><a href="#topic+nplbin">nplbin</a></code>, 
but may be used to construct a
<code>control</code> argument to that function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logbin.control(bound.tol = 1e-06, epsilon = 1e-08, maxit = 10000, trace = 0,
               coeftrace = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logbin.control_+3A_bound.tol">bound.tol</code></td>
<td>

<p>positive tolerance specifying the
interior of the parameter space. If the fitted model is
more than <code>bound.tol</code> away from the boundary of the
parameter space then it is assumed to be in the interior.
This can allow the computational method to terminate
early if an interior maximum is found.  No early
termination is attempted if <code>bound.tol = Inf</code>.
</p>
</td></tr>
<tr><td><code id="logbin.control_+3A_epsilon">epsilon</code></td>
<td>

<p>positive convergence tolerance
<code class="reqn">\epsilon</code>; the estimates are considered to have 
converged when <code class="reqn">\sqrt{
  \sum (\theta_{old} - \theta_{new})^2} / \sqrt {\sum
  \theta_{old}^2} &lt; \epsilon</code>, where <code class="reqn">\theta</code> is the
vector of parameter estimates.
</p>
<p>This should be smaller than <code>bound.tol</code>.
</p>
</td></tr>
<tr><td><code id="logbin.control_+3A_maxit">maxit</code></td>
<td>

<p>integer giving the maximum number of iterations 
(for a given parameterisation in the case of the
CEM algorithm).
</p>
</td></tr>
<tr><td><code id="logbin.control_+3A_trace">trace</code></td>
<td>

<p>number indicating level of output that
should be produced. &gt;= 1 gives output for each
parameterisation, &gt;= 2 gives output at each iteration.
</p>
</td></tr>
<tr><td><code id="logbin.control_+3A_coeftrace">coeftrace</code></td>
<td>

<p>logical indicating whether the coefficient history
should be included as a component of the returned
value (for <code>method = "em"</code> and <code>method = "cem"</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is used similarly to <code><a href="stats.html#topic+glm.control">glm.control</a></code>. The
<code>control</code> argument of <code><a href="#topic+logbin">logbin</a></code> is by
default passed to the <code>control</code> argument of
<code><a href="#topic+nplbin">nplbin</a></code>.
</p>
<p>When <code>trace</code> is greater than zero, calls to
<code><a href="base.html#topic+cat">cat</a></code> produce the output. Hence,
<code><a href="base.html#topic+options">options</a>(digits = *)</code> can be used to increase
the precision.
</p>


<h3>Value</h3>

<p>A list with components named as the arguments.
</p>


<h3>Author(s)</h3>

<p>Mark W. Donoghoe <a href="mailto:markdonoghoe@gmail.com">markdonoghoe@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm.control">glm.control</a></code>, the equivalent function for
<code><a href="stats.html#topic+glm">glm</a></code> fitting.
</p>
<p><code><a href="#topic+nplbin">nplbin</a></code>, the
function used to fit <code><a href="#topic+logbin">logbin</a></code> models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Variation on example(glm.control) :

evts &lt;- c(18,17,15,20,10,20,25,13,12)
obs &lt;- rep(30,9)
outcome &lt;- gl(3,1,9)
treatment &lt;- gl(3,3)
oo &lt;- options(digits = 12)
logbin.D93X &lt;- logbin(cbind(evts,obs-evts) ~ outcome + treatment, trace = 2, epsilon = 1e-2)
options(oo)
coef(logbin.D93X)
</code></pre>

<hr>
<h2 id='logbin.smooth'>
Smooth Log-Binomial Regression
</h2><span id='topic+logbin.smooth'></span>

<h3>Description</h3>

<p><code>logbin.smooth</code> fits log-link binomial
regression models using a stable CEM algorithm. It provides additional
flexibility over <code><a href="#topic+logbin">logbin</a></code> by allowing for smooth 
semi-parametric terms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logbin.smooth(formula, mono = NULL, data, subset, na.action, offset, 
              control = list(...), model = TRUE, model.logbin = FALSE, 
              method = c("cem", "em"), accelerate = c("em", "squarem", "pem", "qn"),
              control.accelerate = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logbin.smooth_+3A_formula">formula</code></td>
<td>

<p>an object of class <code>"<a href="stats.html#topic+formula">formula</a>"</code>
(or one that can be coerced into that class): a symbolic
description of the model to be fitted. The details of
model specification are given under &quot;Details&quot;.  The model must contain an intercept
and at least one semi-parametric term, included by using the
<code><a href="#topic+B">B</a></code> or <code><a href="#topic+Iso">Iso</a></code> functions. Note that 2nd-order terms
(such as interactions) or above are not currently supported
(see <code><a href="#topic+logbin">logbin</a></code>).
</p>
</td></tr>
<tr><td><code id="logbin.smooth_+3A_mono">mono</code></td>
<td>

<p>a vector indicating which terms in
<code>formula</code> should be restricted to have a
monotonically non-decreasing relationship with the
outcome. May be specified as names or indices of the
terms.
</p>
<p><code><a href="#topic+Iso">Iso</a>()</code> terms are always monotonic.
</p>
</td></tr>
<tr><td><code id="logbin.smooth_+3A_data">data</code></td>
<td>

<p>an optional data frame, list or environment
(or object coercible by <code><a href="base.html#topic+as.data.frame">as.data.frame</a></code> to a
data frame) containing the variables in the model. If not
found in <code>data</code>, the variables are taken from
<code><a href="base.html#topic+environment">environment</a>(formula)</code>, typically the environment
from which <code>logbin.smooth</code> is called.
</p>
</td></tr>
<tr><td><code id="logbin.smooth_+3A_subset">subset</code></td>
<td>

<p>an optional vector specifying a subset of
observations to be used in the fitting process.
</p>
</td></tr>
<tr><td><code id="logbin.smooth_+3A_na.action">na.action</code></td>
<td>

<p>a function which indicates what should happen when the data
contain <code>NA</code>s. The default is set be the <code>na.action</code>
setting of <code><a href="base.html#topic+options">options</a></code>, and is <code><a href="stats.html#topic+na.fail">na.fail</a></code>
if that is unset. The &lsquo;factory-fresh&rsquo; default is <code><a href="stats.html#topic+na.omit">na.omit</a></code>.
Another possible value is <code>NULL</code>, no action. Value
<code><a href="stats.html#topic+na.exclude">na.exclude</a></code> can be useful.
</p>
</td></tr>
<tr><td><code id="logbin.smooth_+3A_offset">offset</code></td>
<td>

<p>this can be used to specify an <em>a
priori</em> known component to be included in the linear
predictor during fitting. This should be <code>NULL</code> or a
<em>non-positive</em> numeric vector of length equal to the number of cases.
One or more <code><a href="stats.html#topic+offset">offset</a></code> terms can be included in
the formula instead or as well, and if more than one is
specified their sum is used. See
<code><a href="stats.html#topic+model.offset">model.offset</a></code>.
</p>
</td></tr>
<tr><td><code id="logbin.smooth_+3A_control">control</code></td>
<td>

<p>a list of parameters for controlling the
fitting process, passed to
<code><a href="#topic+logbin.control">logbin.control</a></code>.
</p>
</td></tr>
<tr><td><code id="logbin.smooth_+3A_model">model</code></td>
<td>

<p>a logical value indicating whether the <em>model frame</em> 
should be included as a component of the returned value.
</p>
</td></tr>
<tr><td><code id="logbin.smooth_+3A_model.logbin">model.logbin</code></td>
<td>

<p>a logical value indicating whether the fitted <code>logbin</code>
object should be included as a component of the returned value.
</p>
</td></tr>
<tr><td><code id="logbin.smooth_+3A_method">method</code></td>
<td>

<p>a character string that determines which EM-type algorithm to use
to find the MLE: <code>"cem"</code> for the combinatorial EM algorithm,
which cycles through a sequence of constrained parameter spaces, or
<code>"em"</code> for a single EM algorithm based on an overparameterised
model.
</p>
<p>Unlike <code><a href="#topic+logbin">logbin</a></code>, methods <code>"glm"</code> and <code>"ab"</code> are
not available because they do not support the necessary monotonicity constraints.
</p>
</td></tr>
<tr><td><code id="logbin.smooth_+3A_accelerate">accelerate</code></td>
<td>

<p>a character string that determines the acceleration
algorithm to be used, (partially) matching one of <code>"em"</code> (no acceleration &ndash; the default), 
<code>"squarem"</code>, <code>"pem"</code> or <code>"qn"</code>. See <code><a href="turboEM.html#topic+turboem">turboem</a></code>
for further details. Note that <code>"decme"</code> is not permitted.
</p>
</td></tr>
<tr><td><code id="logbin.smooth_+3A_control.accelerate">control.accelerate</code></td>
<td>

<p>a list of control parameters for the acceleration algorithm. See <code><a href="turboEM.html#topic+turboem">turboem</a></code>
for details of the parameters that apply to each algorithm. If not specified, the defaults are used.
</p>
</td></tr>
<tr><td><code id="logbin.smooth_+3A_...">...</code></td>
<td>

<p>arguments to be used to form the default
<code>control</code> argument if it is not supplied directly.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>logbin.smooth</code> performs the same fitting process as <code><a href="#topic+logbin">logbin</a></code>,
providing a stable maximum likelihood estimation procedure for log-link
binomial GLMs, with the added flexibility of allowing semi-parametric
<code><a href="#topic+B">B</a></code> and <code><a href="#topic+Iso">Iso</a></code> terms (note that <code>logbin.smooth</code> will stop with an 
error if no semi-parametric terms are specified in the right-hand side of the <code>formula</code>; 
<code><a href="#topic+logbin">logbin</a></code> should be used instead).
</p>
<p>The method partitions the parameter space associated with the semi-parametric part of the
model into a sequence of constrained parameter spaces, and defines a fully parametric 
<code>logbin</code> model for each. The model with the highest log-likelihood is the MLE for 
the semi-parametric model (see Donoghoe and Marschner, 2015).
</p>


<h3>Value</h3>

<p>An object of class <code>"logbin.smooth"</code>, which contains the same objects as class
<code>"logbin"</code> (the same as <code>"<a href="stats.html#topic+glm">glm</a>"</code>), as well as:
</p>
<table>
<tr><td><code>model.logbin</code></td>
<td>
<p>if <code>model.logbin</code> is <code>TRUE</code>; the <code>logbin</code> object
for the fully parametric model corresponding to the fitted model.</p>
</td></tr>
<tr><td><code>xminmax.smooth</code></td>
<td>
<p>the minimum and maximum observed values for
each of the smooth terms in the model, to help define the 
covariate space.</p>
</td></tr>
<tr><td><code>full.formula</code></td>
<td>
<p>the component from <code><a href="#topic+interpret.logbin.smooth">interpret.logbin.smooth</a>(formula)</code>
that contains the <code>formula</code> term with any additional arguments to the <code><a href="#topic+B">B</a></code>
function removed.</p>
</td></tr>
<tr><td><code>knots</code></td>
<td>
<p>a named list containing the knot vectors for each of the smooth
terms in the model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mark W. Donoghoe <a href="mailto:markdonoghoe@gmail.com">markdonoghoe@gmail.com</a>
</p>


<h3>References</h3>

<p>Donoghoe, M. W. and I. C. Marschner (2015). Flexible regression models for rate 
differences, risk differences and relative risks. <em>International Journal of 
Biostatistics</em> 11(1): 91&ndash;108.
</p>
<p>Donoghoe, M. W. and I. C. Marschner (2018). logbin: An R package for relative risk
regression using the log-binomial model. <em>Journal of Statistical Software</em> 
86(9): 1&ndash;22.
</p>
<p>Marschner, I. C. (2014). Combinatorial EM algorithms.
<em>Statistics and Computing</em> 24(6): 921&ndash;940.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logbin">logbin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simple example
x &lt;- c(0.3, 0.2, 0.0, 0.1, 0.2, 0.1, 0.7, 0.2, 1.0, 0.9)
y &lt;- c(5, 4, 6, 4, 7, 3, 6, 5, 9, 8)
system.time(m1 &lt;- logbin.smooth(cbind(y, 10-y) ~ B(x, knot.range = 0:2), mono = 1, trace = 1))
## Compare with accelerated version
system.time(m1.acc &lt;- update(m1, accelerate = "squarem"))
## Isotonic relationship
m2 &lt;- logbin.smooth(cbind(y, 10-y) ~ Iso(x))

plot(m1)
plot(m2)

summary(predict(m1, type = "response"))
summary(predict(m2, type = "response"))
</code></pre>

<hr>
<h2 id='nplbin'>
Non-Positive Log-Binomial Regression
</h2><span id='topic+nplbin'></span>

<h3>Description</h3>

<p>Finds the maximum likelihood estimate of a log-link binomial GLM
using an EM algorithm, where each of the coefficients in the linear 
predictor is restricted to be non-positive.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nplbin(y, x, offset, start, Amat = diag(ncol(x)), control = logbin.control(),
       accelerate = c("em", "squarem", "pem", "qn"),
       control.accelerate = list(list()))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nplbin_+3A_y">y</code></td>
<td>

<p>binomial response. May be a single column of 0/1
or two columns, giving the number of successes and
failures.
</p>
</td></tr>
<tr><td><code id="nplbin_+3A_x">x</code></td>
<td>

<p>non-negative covariate matrix.
</p>
</td></tr>
<tr><td><code id="nplbin_+3A_offset">offset</code></td>
<td>

<p>non-positive additive offset vector. The default is a vector of zeros.
</p>
</td></tr>
<tr><td><code id="nplbin_+3A_start">start</code></td>
<td>

<p>starting values for the parameter estimates. All elements must be less than
or equal to <code>-control$bound.tol</code>.
</p>
</td></tr>
<tr><td><code id="nplbin_+3A_amat">Amat</code></td>
<td>

<p>matrix that parameter estimates are left-multiplied by before testing for
convergence (e.g. to check reduced version of expanded parameter vector).
</p>
</td></tr>
<tr><td><code id="nplbin_+3A_control">control</code></td>
<td>

<p>a <code><a href="#topic+logbin.control">logbin.control</a></code> object, which controls the fitting process.
</p>
</td></tr>
<tr><td><code id="nplbin_+3A_accelerate">accelerate</code></td>
<td>

<p>a character string that determines the acceleration
algorithm to be used, (partially) matching one of <code>"em"</code> (no acceleration &ndash; the default), 
<code>"squarem"</code>, <code>"pem"</code> or <code>"qn"</code>. See <code><a href="turboEM.html#topic+turboem">turboem</a></code>
for further details. Note that <code>"decme"</code> is not permitted.
</p>
</td></tr>
<tr><td><code id="nplbin_+3A_control.accelerate">control.accelerate</code></td>
<td>

<p>a list of control parameters for the acceleration algorithm. See <code><a href="turboEM.html#topic+turboem">turboem</a></code>
for details of the parameters that apply to each algorithm. If not specified, the defaults are used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a workhorse function for <code><a href="#topic+logbin">logbin</a></code>, and runs the EM algorithm to find the 
constrained non-positive MLE associated with a log-link binomial GLM. See Marschner
and Gillett (2012) for full details.
</p>


<h3>Value</h3>

<p>A list containing the following components
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>the constrained non-positive maximum likelihood estimate of the parameters.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the residuals at the MLE, that is <code>y - fitted.values</code></p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the fitted mean values.</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>the number of parameters in the model (named &quot;<code>rank</code>&quot; for compatibility &mdash;
we assume that models have full rank)</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>included for compatibility &mdash; will always be <code><a href="stats.html#topic+binomial">binomial</a>(log)</code>.</p>
</td></tr>
<tr><td><code>linear.predictors</code></td>
<td>
<p>the linear fit on link scale.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>up to a constant, minus twice the maximised log-likelihood.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>a version of Akaike's <em>An Information Criterion</em>,
minus twice the maximised log-likelihood plus twice the 
number of parameters.</p>
</td></tr>
<tr><td><code>aic.c</code></td>
<td>
<p>a small-sample corrected
version of Akaike's <em>An Information Criterion</em>
(Hurvich, Simonoff and Tsai, 1998).</p>
</td></tr>
<tr><td><code>null.deviance</code></td>
<td>
<p>the deviance for the null model, comparable with <code>deviance</code>.
The null model will include the offset and an intercept.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>the number of iterations of the EM algorithm used.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>included for compatibility &mdash; a vector of ones.</p>
</td></tr>
<tr><td><code>prior.weights</code></td>
<td>
<p>the number of trials associated with each binomial response.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>the residual degrees of freedom.</p>
</td></tr>
<tr><td><code>df.null</code></td>
<td>
<p>the residual degrees of freedom for the null model.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the <code>y</code> vector used.</p>
</td></tr>
<tr><td><code>converged</code></td>
<td>
<p>logical. Did the EM algorithm converge?</p>
</td></tr>
<tr><td><code>boundary</code></td>
<td>
<p>logical. Is the MLE on the boundary of the parameter
space &mdash; i.e. are any of the <code>coefficients &lt; control$bound.tol</code>?</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>the maximised log-likelihood.</p>
</td></tr>
<tr><td><code>nn.design</code></td>
<td>
<p>the non-negative <code>x</code> matrix used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mark W. Donoghoe <a href="mailto:markdonoghoe@gmail.com">markdonoghoe@gmail.com</a>.
</p>
<p>This function is based on code from Marschner and Gillett (2012) written by Alexandra Gillett.
</p>


<h3>References</h3>

<p>Hurvich, C. M., J. S. Simonoff and C.-L. Tsai (1998). Smoothing parameter 
selection in non-parametric regression using an improved Akaike 
information criterion. <em>Journal of the Royal Statistical Society: Series B 
(Statistical Methodology)</em> 60(2): 271&ndash;293.
</p>
<p>Marschner, I. C. and A. C. Gillett (2012). Relative risk regression: reliable
and flexible methods for log-binomial models. <em>Biostatistics</em> 13(1): 179&ndash;192.
</p>

<hr>
<h2 id='plot.logbin.smooth'>
Default logbin.smooth Plotting
</h2><span id='topic+plot.logbin.smooth'></span>

<h3>Description</h3>

<p>The main use is to take a fitted <code>logbin.smooth</code> object produced by 
<code><a href="#topic+logbin.smooth">logbin.smooth</a></code> and plot the component smooth functions that make it up,
for specified values of the other covariates.
</p>
<p>Alternatively, plots the model diagnostics usually provided by <code><a href="stats.html#topic+plot.lm">plot.lm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'logbin.smooth'
plot(x, type = c("response", "link", "diagnostics"), at = data.frame(), 
     knotlines = TRUE, nobs = 1000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.logbin.smooth_+3A_x">x</code></td>
<td>

<p>a fitted <code>logbin.smooth</code> object as produced by <code><a href="#topic+logbin.smooth">logbin.smooth</a></code>.
</p>
</td></tr>
<tr><td><code id="plot.logbin.smooth_+3A_type">type</code></td>
<td>

<p>for <code>"response"</code> and <code>"link"</code>, the type of prediction required. 
Note that, unlike <code><a href="#topic+predict.logbin.smooth">predict.logbin.smooth</a></code>, <code>"terms"</code> is not a valid option.
</p>
<p>for <code>"diagnostics"</code>, <code><a href="stats.html#topic+plot.lm">plot.lm</a></code> is called.
</p>
</td></tr>
<tr><td><code id="plot.logbin.smooth_+3A_at">at</code></td>
<td>

<p>a data frame containing the values at which the prediction should be evaluated. The columns
must contain the covariates in the model, and several rows may be provided (in which case, multiple
lines are drawn on the same plot). Cannot be missing or <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="plot.logbin.smooth_+3A_knotlines">knotlines</code></td>
<td>

<p>logical; if vertical lines should be drawn on the plot to indicate the locations
of the knots for B-spline terms.
</p>
</td></tr>
<tr><td><code id="plot.logbin.smooth_+3A_nobs">nobs</code></td>
<td>

<p>the number of points which should be used to create the curve. These are placed evenly along
the range of the observed covariate values from the original model.
</p>
</td></tr>
<tr><td><code id="plot.logbin.smooth_+3A_...">...</code></td>
<td>

<p>other graphics parameters to pass on to plotting commands, in particular any arguments to
<code><a href="stats.html#topic+plot.lm">plot.lm</a></code> (e.g. <code>which</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each smooth covariate in the model of <code>x</code>, <code><a href="#topic+predict.logbin.smooth">predict.logbin.smooth</a></code>
is used to obtain predicted values for the range of that covariate, with the other
covariates remaining fixed at their values given in <code>at</code>. Several rows may be provided
in <code>at</code>, in which case, one curve is drawn for each, and they are coloured using
<code><a href="grDevices.html#topic+rainbow">rainbow</a>(nrow(at))</code>. If the model contains a single smooth covariate and no other
covariates, <code>at</code> may be provided as an empty data frame, <code>data.frame()</code>.
</p>


<h3>Value</h3>

<p>The function simply generates plots.
</p>


<h3>Note</h3>

<p>If this function is too restrictive, it may be easier to use <code><a href="#topic+predict.logbin.smooth">predict.logbin.smooth</a></code>
to get predictions for the dataset of your choice, and do the plotting manually.
</p>


<h3>Author(s)</h3>

<p>Mark W. Donoghoe <a href="mailto:markdonoghoe@gmail.com">markdonoghoe@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logbin.smooth">logbin.smooth</a></code>, <code><a href="#topic+predict.logbin.smooth">predict.logbin.smooth</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## For an example, see example(logbin.smooth)
</code></pre>

<hr>
<h2 id='predict.logbin'>
Predict Method for logbin Fits
</h2><span id='topic+predict.logbin'></span>

<h3>Description</h3>

<p>Obtains predictions from a fitted <code><a href="#topic+logbin">logbin</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'logbin'
predict(object, newdata = NULL, type = c("link", "response", "terms"), 
        terms = NULL, na.action = na.pass, checkminmax = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.logbin_+3A_object">object</code></td>
<td>

<p>a fitted object of class inheriting from <code>"logbin"</code>.
</p>
</td></tr>
<tr><td><code id="predict.logbin_+3A_newdata">newdata</code></td>
<td>

<p>optionally, a data frame in which to look for variables with which to predict.
If omitted, the fitted linear predictors are used.
</p>
</td></tr>
<tr><td><code id="predict.logbin_+3A_type">type</code></td>
<td>

<p>the type of prediction required. The default is on the scale of the linear predictors; 
the alternative <code>"response"</code> is on the scale of the response variable. 
The <code>"terms"</code> option returns a matrix giving the fitted values of each term in the 
model formula on the linear predictor scale.
</p>
<p>The value of this argument can be abbreviated.
</p>
</td></tr>
<tr><td><code id="predict.logbin_+3A_terms">terms</code></td>
<td>

<p>with <code>type = "terms"</code> by default all terms are returned. 
A character vector specifies which terms are to be returned.
</p>
</td></tr>
<tr><td><code id="predict.logbin_+3A_na.action">na.action</code></td>
<td>

<p>function determining what should be done with missing values in <code>newdata</code>. 
The default is to predict <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="predict.logbin_+3A_checkminmax">checkminmax</code></td>
<td>

<p>logical indicating whether or not values of continuous covariates in <code>newdata</code> 
should be checked to ensure they lie within the covariate space associated with the 
fitted model. Otherwise predicted values could lie outside the 
parameter space.
</p>
</td></tr>
<tr><td><code id="predict.logbin_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>newdata</code> is omitted the predictions are based on the data used for the fit. 
In that case how cases with missing values in the original fit are treated is determined by the 
<code>na.action</code> argument of that fit. If <code>na.action = na.omit</code>, omitted cases 
will not appear in the residuals. If <code>na.action = na.exclude</code> they will 
appear, with residual value <code>NA</code>. See also <code><a href="stats.html#topic+napredict">napredict</a></code>.
</p>


<h3>Value</h3>

<p>A vector or matrix of predictions. For <code>type = "terms"</code>, this is a matrix with
a column per term, and may have an attribute <code>"constant"</code>.
</p>


<h3>Note</h3>

<p>Variables are first looked for in <code>newdata</code> and then searched for in the usual 
way (which will include the environment of the formula used in the fit). A warning 
will be given if the variables found are not of the same length as those in 
<code>newdata</code> if it was supplied.
</p>


<h3>Author(s)</h3>

<p>Mark W. Donoghoe <a href="mailto:markdonoghoe@gmail.com">markdonoghoe@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logbin">logbin</a></code>
</p>
<p><code><a href="stats.html#topic+predict.glm">predict.glm</a></code> for the equivalent method for models fit using <code><a href="stats.html#topic+glm">glm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## For an example, see example(logbin)
</code></pre>

<hr>
<h2 id='predict.logbin.smooth'>
Predict Method for logbin.smooth Fits
</h2><span id='topic+predict.logbin.smooth'></span>

<h3>Description</h3>

<p>Obtains predictions from a fitted <code><a href="#topic+logbin.smooth">logbin.smooth</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'logbin.smooth'
predict(object, newdata = NULL, type = c("link", "response", "terms"), 
        terms = NULL, na.action = na.pass, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.logbin.smooth_+3A_object">object</code></td>
<td>

<p>a fitted object of class inheriting from <code>"logbin.smooth"</code>.
</p>
</td></tr>
<tr><td><code id="predict.logbin.smooth_+3A_newdata">newdata</code></td>
<td>

<p>optionally, a data frame in which to look for variables with which to
predict. If omitted, the fitted linear predictors are used.
</p>
</td></tr>
<tr><td><code id="predict.logbin.smooth_+3A_type">type</code></td>
<td>

<p>the type of prediction required. The default is on the scale of the linear predictors; 
the alternative <code>"response"</code> is on the scale of the response variable. 
The <code>"terms"</code> option returns a matrix giving the fitted values of each term in the 
model formula on the linear predictor scale.
</p>
<p>The value of this argument can be abbreviated.
</p>
</td></tr>
<tr><td><code id="predict.logbin.smooth_+3A_terms">terms</code></td>
<td>

<p>with <code>type = "terms"</code> by default all terms are returned. 
A character vector specifies which terms are to be returned.
</p>
</td></tr>
<tr><td><code id="predict.logbin.smooth_+3A_na.action">na.action</code></td>
<td>

<p>function determining what should be done with missing values in <code>newdata</code>. 
The default is to predict <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="predict.logbin.smooth_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>predict.logbin.smooth</code> constructs the underlying basis functions for smooth variables
in <code>newdata</code> and runs <code><a href="#topic+predict.logbin">predict.logbin</a></code> to obtain predictions. Note that
if values of smooth covariates in <code>newdata</code> are outside the covariate space of 
<code>object</code>, an error will be returned.
</p>
<p>If <code>newdata</code> is omitted, the predictions are based on the data used for the fit. 
In that case how cases with missing values in the original fit are treated is determined by the 
<code>na.action</code> argument of that fit. If <code>na.action = na.omit</code>, omitted cases 
will not appear in the residuals, whereas if <code>na.action = na.exclude</code> they will 
appear, with residual value <code>NA</code>. See also <code><a href="stats.html#topic+napredict">napredict</a></code>.
</p>


<h3>Value</h3>

<p>A vector or matrix of predictions. For <code>type = "terms"</code>, this is a matrix with
a column per term, and may have an attribute <code>"constant"</code>.
</p>


<h3>Note</h3>

<p>Variables are first looked for in <code>newdata</code> and then searched for in the usual 
way (which will include the environment of the formula used in the fit). A warning 
will be given if the variables found are not of the same length as those in 
<code>newdata</code> if it was supplied.
</p>


<h3>Author(s)</h3>

<p>Mark W. Donoghoe <a href="mailto:markdonoghoe@gmail.com">markdonoghoe@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logbin.smooth">logbin.smooth</a></code>, <code><a href="#topic+predict.logbin">predict.logbin</a></code>
</p>
<p><code><a href="stats.html#topic+predict.glm">predict.glm</a></code> for the equivalent method for models fit using <code><a href="stats.html#topic+glm">glm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## For an example, see example(logbin.smooth)
</code></pre>

<hr>
<h2 id='summary.logbin'>
Summarising logbin Model Fits
</h2><span id='topic+summary.logbin'></span><span id='topic+print.summary.logbin'></span>

<h3>Description</h3>

<p>These functions are all <code><a href="utils.html#topic+methods">methods</a></code> for class <code>logbin</code>
or <code>summary.logbin</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'logbin'
summary(object, correlation = FALSE, ...)

## S3 method for class 'summary.logbin'
print(x, digits = max(3L, getOption("digits") - 3L), 
      signif.stars = getOption("show.signif.stars"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.logbin_+3A_object">object</code></td>
<td>

<p>an object of class <code>"logbin"</code>, usually from a call to <code><a href="#topic+logbin">logbin</a></code>
or <code><a href="#topic+logbin.smooth">logbin.smooth</a></code>.
</p>
</td></tr>
<tr><td><code id="summary.logbin_+3A_x">x</code></td>
<td>

<p>an object of class <code>"summary.logbin"</code>, usually from a call to
<code>summary.logbin</code>.
</p>
</td></tr>
<tr><td><code id="summary.logbin_+3A_correlation">correlation</code></td>
<td>

<p>logical; if <code>TRUE</code>, the correlation matrix of the estimated parameters is
returned and printed.
</p>
</td></tr>
<tr><td><code id="summary.logbin_+3A_digits">digits</code></td>
<td>

<p>the number of significant digits to use when printing.
</p>
</td></tr>
<tr><td><code id="summary.logbin_+3A_signif.stars">signif.stars</code></td>
<td>

<p>logical; if <code>TRUE</code>, &lsquo;significance stars&rsquo; are printed for each coefficient.
</p>
</td></tr>
<tr><td><code id="summary.logbin_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These perform the same function as <code><a href="stats.html#topic+summary.glm">summary.glm</a></code> and <code><a href="stats.html#topic+print.summary.glm">print.summary.glm</a></code>,
producing similar results for <code>logbin</code> models. <code>print.summary.logbin</code> additionally prints 
the small-sample corrected AIC (<code>aic.c</code>), and the number of EM iterations for the parameterisation 
corresponding to the MLE.
</p>
<p>The dispersion used in calculating standard errors is fixed as <code>1</code>.
</p>


<h3>Value</h3>

<p><code>summary.logbin</code> returns an object of class <code>"summary.logbin"</code>, a list with components
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the component from <code>object</code>.</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>the component from <code>object</code>.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>the component from <code>object</code>.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>the component from <code>object</code>.</p>
</td></tr>
<tr><td><code>aic.c</code></td>
<td>
<p>the component from <code>object</code>.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>the component from <code>object</code>.</p>
</td></tr>
<tr><td><code>null.deviance</code></td>
<td>
<p>the component from <code>object</code>.</p>
</td></tr>
<tr><td><code>df.null</code></td>
<td>
<p>the component from <code>object</code>.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>the component from <code>object</code>.</p>
</td></tr>
<tr><td><code>deviance.resid</code></td>
<td>
<p>the deviance residuals: see <code><a href="stats.html#topic+residuals.glm">residuals.glm</a></code>.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>the matrix of coefficients, standard errors, z-values and p-values.</p>
</td></tr>
<tr><td><code>aliased</code></td>
<td>
<p>included for compatibility &mdash; always <code>FALSE</code>.</p>
</td></tr>
<tr><td><code>dispersion</code></td>
<td>
<p>the inferred/estimated dispersion.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>included for compatibility &mdash; a 3-vector of the number of coefficients,
the number of residual degrees of freedom, and the number of coefficients (again).</p>
</td></tr>
<tr><td><code>cov.unscaled</code></td>
<td>
<p>the unscaled (<code>dispersion = 1</code>) estimated covariance
matrix of the estimated coefficients. <code>NaN</code> if <code>object$boundary == TRUE</code>.</p>
</td></tr>
<tr><td><code>cov.scaled</code></td>
<td>
<p>ditto, scaled by <code>dispersion</code>.</p>
</td></tr>
<tr><td><code>correlation</code></td>
<td>
<p>if <code>correlation</code> is <code>TRUE</code>, the estimated correlations
of the estimated coefficients. <code>NaN</code> if <code>object$boundary == TRUE</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If <code>object$boundary == TRUE</code>, the standard errors of the coefficients
are not valid, and a matrix of <code>NaN</code>s is returned by <code><a href="#topic+vcov.logbin">vcov.logbin</a></code>. If
the MLE is not on the boundary but the model contains parameters with monotonicity 
constraints, the standard errors do not take this into account and should be used
with caution.
</p>


<h3>Author(s)</h3>

<p>Mark W. Donoghoe <a href="mailto:markdonoghoe@gmail.com">markdonoghoe@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logbin">logbin</a></code>, <code><a href="stats.html#topic+summary.glm">summary.glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## For examples see example(logbin)
</code></pre>

<hr>
<h2 id='vcov.logbin'>
Calculate Variance-Covariance Matrix for a Fitted logbin Model Object
</h2><span id='topic+vcov.logbin'></span>

<h3>Description</h3>

<p>Returns the variance-covariance matrix of the main parameters of a fitted <code>logbin</code> model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'logbin'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.logbin_+3A_object">object</code></td>
<td>

<p>an object of class <code>"logbin"</code>, usually from a call to <code><a href="#topic+logbin">logbin</a></code>
or <code><a href="#topic+logbin.smooth">logbin.smooth</a></code>.
</p>
</td></tr>
<tr><td><code id="vcov.logbin_+3A_...">...</code></td>
<td>

<p>additional arguments for method functions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An equivalent method to <code><a href="stats.html#topic+vcov">vcov</a></code>, to use with <code><a href="#topic+logbin">logbin</a></code> models.
</p>


<h3>Value</h3>

<p>A matrix of the estimated covariances between the parameter estimates in the linear or 
non-linear predictor of the model. This should have row and column names corresponding 
to the parameter names given by the <code><a href="stats.html#topic+coef">coef</a></code> method.
</p>


<h3>Note</h3>

<p>If <code>object$boundary == TRUE</code>, the standard errors of the coefficients
are not valid, and a matrix of <code>NaN</code>s is returned.
</p>


<h3>Author(s)</h3>

<p>Mark W. Donoghoe <a href="mailto:markdonoghoe@gmail.com">markdonoghoe@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.logbin">summary.logbin</a></code>, <code><a href="stats.html#topic+vcov.glm">vcov.glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## For an example see example(logbin)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
