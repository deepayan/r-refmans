<!DOCTYPE html><html lang="en"><head><title>Help for package ArArRedux</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ArArRedux}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#average'><p>Calculate the arithmetic mean</p></a></li>
<li><a href='#averagebyday'><p>Average all the data collected on the same day.</p></a></li>
<li><a href='#blankcorr'><p>Apply a blank correction</p></a></li>
<li><a href='#blankcorrected'><p>The <code>blankcorrected</code> class</p></a></li>
<li><a href='#calibration'><p>Detector calibration</p></a></li>
<li><a href='#clcorrection'><p>Cl-interference correction</p></a></li>
<li><a href='#concat'><p>Merge a list of logratio data</p></a></li>
<li><a href='#decaycorrection'><p>Correct for radioactive decay occurred since irradiation</p></a></li>
<li><a href='#fitlogratios'><p>Extrapolation to 'time zero'</p></a></li>
<li><a href='#fractionation'><p>Compute the mass fractionation correction</p></a></li>
<li><a href='#get4039'><p>Calculate the 40Ar*/39ArK-ratios</p></a></li>
<li><a href='#getages'><p>Calculate 40Ar/39Ar ages</p></a></li>
<li><a href='#getJfactors'><p>Calculate the irradiation parameter ('J factor')</p></a></li>
<li><a href='#getmasses'><p>Select a subset of isotopes from a dataset</p></a></li>
<li><a href='#interference'><p>define the interference corrections</p></a></li>
<li><a href='#loaddata'><p>Load mass spectrometer data</p></a></li>
<li><a href='#loadirradiations'><p>Load the irradiation schedule</p></a></li>
<li><a href='#logratios'><p>The <code>logratios</code> class</p></a></li>
<li><a href='#massfractionation'><p>Apply the mass fractionation correction</p></a></li>
<li><a href='#Melbourne'><p>An example dataset</p></a></li>
<li><a href='#newredux'><p>Create a new <code>redux</code> object</p></a></li>
<li><a href='#param'><p>Set or get Ar-Ar_Redux parameters</p></a></li>
<li><a href='#PHdata'><p>The <code>PHdata</code> class</p></a></li>
<li><a href='#plot.timeresolved'><p>Plot a time resolved mass spectrometry signal</p></a></li>
<li><a href='#plotcorr'><p>Plot a matrix with correlation coefficients</p></a></li>
<li><a href='#process'><p>Process logratio data and calculate 40Ar/39Ar ages</p></a></li>
<li><a href='#read'><p>Read mass spectrometer data</p></a></li>
<li><a href='#redux'><p>The <code>redux</code> class</p></a></li>
<li><a href='#redux2isoplotr'><p>Export <code>ArArRedux</code> data to <code>IsoplotR</code></p></a></li>
<li><a href='#results'><p>The <code>results</code> class</p></a></li>
<li><a href='#subset.timeresolved'><p>Select a subset of some data</p></a></li>
<li><a href='#summary.results'><p>Summary table</p></a></li>
<li><a href='#timeresolved'><p>The <code>timeresolved</code> class</p></a></li>
<li><a href='#weightedmean'><p>Calculate the weighted mean age</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Rigorous Data Reduction and Error Propagation of Ar40 / Ar39
Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-08-13</td>
</tr>
<tr>
<td>Description:</td>
<td>Processes noble gas mass spectrometer data to determine the isotopic composition of argon (comprised of Ar36, Ar37, Ar38, Ar39 and Ar40) released from neutron-irradiated potassium-bearing minerals. Then uses these compositions to calculate precise and accurate geochronological ages for multiple samples as well as the covariances between them. Error propagation is done in matrix form, which jointly treats all samples and all isotopes simultaneously at every step of the data reduction process. Includes methods for regression of the time-resolved mass spectrometer signals to t=0 ('time zero') for both single- and multi-collector instruments, blank correction, mass fractionation correction, detector intercalibration, decay corrections, interference corrections, interpolation of the irradiation parameter between neutron fluence monitors, and (weighted mean) age calculation. All operations are performed on the logs of the ratios between the different argon isotopes so as to properly treat them as 'compositional data', sensu Aitchison [1986, The Statistics of Compositional Data, Chapman and Hall].</td>
</tr>
<tr>
<td>Author:</td>
<td>Pieter Vermeesch [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pieter Vermeesch &lt;p.vermeesch@ucl.ac.uk&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, stats, methods, graphics, grDevices</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-10-03 20:40:49 UTC; pvermees</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-10-03 21:52:31 UTC</td>
</tr>
</table>
<hr>
<h2 id='average'>Calculate the arithmetic mean</h2><span id='topic+average'></span>

<h3>Description</h3>

<p>Calculate the arithmetic mean of some logratio data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>average(x, i = NULL, newlabel = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="average_+3A_x">x</code></td>
<td>
<p>an object of class <code>redux</code> or <code>logratios</code></p>
</td></tr>
<tr><td><code id="average_+3A_i">i</code></td>
<td>
<p>(optional) vector of sample indices</p>
</td></tr>
<tr><td><code id="average_+3A_newlabel">newlabel</code></td>
<td>
<p>(optional) string with the new label to be assigned
to the averaged values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of the same class as <code>x</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Melbourne)
K &lt;- average(Melbourne$X,grep("K:",Melbourne$X$labels),newlabel="K-glass")
plotcorr(K)
</code></pre>

<hr>
<h2 id='averagebyday'>Average all the data collected on the same day.</h2><span id='topic+averagebyday'></span>

<h3>Description</h3>

<p>This function is useful for grouping a number of replicate air
shots or calibration experiments
</p>


<h3>Usage</h3>

<pre><code class='language-R'>averagebyday(x, newlabel)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="averagebyday_+3A_x">x</code></td>
<td>
<p>an object of class <code>timeresolved</code>, <code>logratios</code>,
<code>PHdata</code> or <code>redux</code></p>
</td></tr>
<tr><td><code id="averagebyday_+3A_newlabel">newlabel</code></td>
<td>
<p>a string with the new label that should be given to
the average</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of the same class as x
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dfile &lt;- system.file("Calibration.csv",package="ArArRedux")
dlabels &lt;- c("H1","AX","L1","L2")
md &lt;- loaddata(dfile,dlabels,PH=TRUE)
ld &lt;- fitlogratios(blankcorr(md))
d &lt;- averagebyday(ld,"DCAL")
plotcorr(d)
</code></pre>

<hr>
<h2 id='blankcorr'>Apply a blank correction</h2><span id='topic+blankcorr'></span><span id='topic+blankcorr.default'></span><span id='topic+blankcorr.timeresolved'></span><span id='topic+blankcorr.PHdata'></span>

<h3>Description</h3>

<p>Applies a blank correction to some time-resolved mass spectrometer data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blankcorr(x, ...)

## Default S3 method:
blankcorr(x, ...)

## S3 method for class 'timeresolved'
blankcorr(x, blanklabel = NULL, prefix = "", ...)

## S3 method for class 'PHdata'
blankcorr(x, blanklabel = NULL, prefix = "", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="blankcorr_+3A_x">x</code></td>
<td>
<p>an object of class <code><a href="#topic+timeresolved">timeresolved</a></code> or
<code><a href="#topic+PHdata">PHdata</a></code></p>
</td></tr>
<tr><td><code id="blankcorr_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
<tr><td><code id="blankcorr_+3A_blanklabel">blanklabel</code></td>
<td>
<p>as string denoting the prefix of the blanks</p>
</td></tr>
<tr><td><code id="blankcorr_+3A_prefix">prefix</code></td>
<td>
<p>a string to be prepended to the non-blanks</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code><a href="#topic+blankcorrected">blankcorrected</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>samplefile &lt;- system.file("Samples.csv",package="ArArRedux")
masses &lt;- c("Ar37","Ar38","Ar39","Ar40","Ar36")
m &lt;- loaddata(samplefile,masses) # samples and J-standards
blanklabel &lt;- "EXB#"
l &lt;- fitlogratios(blankcorr(m,blanklabel),"Ar40")
plotcorr(l)
</code></pre>

<hr>
<h2 id='blankcorrected'>The <code>blankcorrected</code> class</h2><span id='topic+blankcorrected'></span>

<h3>Description</h3>

<p>An object class containing blank-corrected mass spectrometry data
</p>


<h3>Details</h3>

<p>Extends the class classes <code><a href="#topic+timeresolved">timeresolved</a></code> and
<code><a href="#topic+PHdata">PHdata</a></code> by adding an additional list item
<code>blankindices</code> containg the index of the nearest
blank. <code><a href="#topic+fitlogratios">fitlogratios</a></code> uses this information to group
the samples during regression to 'time zero'.
</p>

<hr>
<h2 id='calibration'>Detector calibration</h2><span id='topic+calibration'></span>

<h3>Description</h3>

<p>Apply the detector calibration for multicollector data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibration(X, clabel)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calibration_+3A_x">X</code></td>
<td>
<p>an object of class <code>redux</code></p>
</td></tr>
<tr><td><code id="calibration_+3A_clabel">clabel</code></td>
<td>
<p>the label of the detector calibration data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>redux</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Melbourne)
C &lt;- calibration(Melbourne$X,"DCAL")
plotcorr(C)
</code></pre>

<hr>
<h2 id='clcorrection'>Cl-interference correction</h2><span id='topic+clcorrection'></span>

<h3>Description</h3>

<p>Apply the interference correction for the Cl-decay products
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clcorrection(X, irr)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clcorrection_+3A_x">X</code></td>
<td>
<p>an object of class <code>redux</code></p>
</td></tr>
<tr><td><code id="clcorrection_+3A_irr">irr</code></td>
<td>
<p>the irradiation schedule</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>redux</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Melbourne)
Cl &lt;- clcorrection(Melbourne$X,Melbourne$irr)
plotcorr(Cl)
</code></pre>

<hr>
<h2 id='concat'>Merge a list of logratio data</h2><span id='topic+concat'></span>

<h3>Description</h3>

<p>Recursively concatenates a list of logratio data into one big dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>concat(lrlist)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="concat_+3A_lrlist">lrlist</code></td>
<td>
<p>a list containing items of class
<code><a href="#topic+logratios">logratios</a></code> or <code><a href="#topic+redux">redux</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of the same class as <code>x</code> containing the
merged dataset
</p>


<h3>Examples</h3>

<pre><code class='language-R'>samplefile &lt;-  system.file("Samples.csv",package="ArArRedux")
kfile &lt;- system.file("K-glass.csv",package="ArArRedux")
cafile &lt;- system.file("Ca-salt.csv",package="ArArRedux")
dfile &lt;- system.file("Calibration.csv",package="ArArRedux")
masses &lt;- c("Ar37","Ar38","Ar39","Ar40","Ar36")
blanklabel &lt;- "EXB#"
Jpos &lt;- c(3,15)
dlabels &lt;- c("H1","AX","L1","L2")
 
m &lt;- loaddata(samplefile,masses) # samples and J-standards
mk &lt;- loaddata(kfile,masses) # K-interference data
mca &lt;- loaddata(cafile,masses) # Ca interference data
md &lt;- loaddata(dfile,dlabels,PH=TRUE) # detector intercalibrations
 
# form and fit logratios
l &lt;- fitlogratios(blankcorr(m,blanklabel),"Ar40")
lk &lt;- fitlogratios(blankcorr(mk,blanklabel,"K:"),"Ar40")
k &lt;- getmasses(lk,"Ar39","Ar40") # subset on the relevant isotopes
lca &lt;- fitlogratios(blankcorr(mca,blanklabel,"Ca:"),"Ar37")
ca &lt;- getmasses(lca,c("Ar36","Ar39"),c("Ar37","Ar37")) # subset
ld &lt;- fitlogratios(blankcorr(md))
d &lt;- averagebyday(ld,"DCAL")

# merge all data (except air shots) into one big logratio structure
X &lt;- newredux(concat(list(l,k,ca,d)),Jpos)
data(Melbourne)
if (isTRUE(all.equal(Melbourne$X,X))) {
   print("We just reconstructed the built-in dataset Melbourne$X")}
</code></pre>

<hr>
<h2 id='decaycorrection'>Correct for radioactive decay occurred since irradiation</h2><span id='topic+decaycorrection'></span>

<h3>Description</h3>

<p>Correct for radioactive decay of neutron-induced 37Ar and 39Ar
occurred since irradiation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decaycorrection(X, irr, isotope)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="decaycorrection_+3A_x">X</code></td>
<td>
<p>an objects of class <code>redux</code></p>
</td></tr>
<tr><td><code id="decaycorrection_+3A_irr">irr</code></td>
<td>
<p>the irradiation schedule</p>
</td></tr>
<tr><td><code id="decaycorrection_+3A_isotope">isotope</code></td>
<td>
<p>a string denoting the isotope that needs correcting</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>redux</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Melbourne)
C &lt;- calibration(Melbourne$X,"DCAL")
A &lt;- massfractionation(C,Melbourne$fract)
D9 &lt;- decaycorrection(A,Melbourne$irr,"Ar39")
plotcorr(D9)
</code></pre>

<hr>
<h2 id='fitlogratios'>Extrapolation to 'time zero'</h2><span id='topic+fitlogratios'></span><span id='topic+fitlogratios.default'></span><span id='topic+fitlogratios.timeresolved'></span><span id='topic+fitlogratios.PHdata'></span>

<h3>Description</h3>

<p>This function extrapolates time resolved mass spectrometer data to
t=0. When fed with multicollector data, it forms the ratios of the
raw signals, forms their logs and performs linear regression to t=0
When fed with single collector data, the function first takes their
logs and extrapolates them to t=0 before taking ratios, unless
<code>denmass</code>=NULL, in which case the logs of the raw signals are
extrapolated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitlogratios(x, ...)

## Default S3 method:
fitlogratios(x, ...)

## S3 method for class 'timeresolved'
fitlogratios(x, denmass, ...)

## S3 method for class 'PHdata'
fitlogratios(x, denmass = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitlogratios_+3A_x">x</code></td>
<td>
<p>an object of class <code>timeresolved</code> or <code>PHdata</code></p>
</td></tr>
<tr><td><code id="fitlogratios_+3A_...">...</code></td>
<td>
<p>further arguments (see below)</p>
</td></tr>
<tr><td><code id="fitlogratios_+3A_denmass">denmass</code></td>
<td>
<p>a string denoting the denominator isotope</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>logratios</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>samplefile &lt;- system.file("Samples.csv",package="ArArRedux")
masses &lt;- c("Ar37","Ar38","Ar39","Ar40","Ar36")
m &lt;- loaddata(samplefile,masses) # samples and J-standards
blanklabel &lt;- "EXB#"
l &lt;- fitlogratios(blankcorr(m,blanklabel),"Ar40")
plotcorr(l)
</code></pre>

<hr>
<h2 id='fractionation'>Compute the mass fractionation correction</h2><span id='topic+fractionation'></span>

<h3>Description</h3>

<p>Compares the measured 40Ar/36Ar ratio of an air shot on a given
detector with the atmospheric ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fractionation(fname, detector, MS = "ARGUS-VI", PH = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fractionation_+3A_fname">fname</code></td>
<td>
<p>a .csv file with the air shot data</p>
</td></tr>
<tr><td><code id="fractionation_+3A_detector">detector</code></td>
<td>
<p>the name of the ion detector</p>
</td></tr>
<tr><td><code id="fractionation_+3A_ms">MS</code></td>
<td>
<p>the type of mass spectrometer</p>
</td></tr>
<tr><td><code id="fractionation_+3A_ph">PH</code></td>
<td>
<p>TRUE if the data were recorded in 'peak hopping' mode,
FALSE if recorded in multicollector mode.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code><a href="#topic+logratios">logratios</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Melbourne)
fd37file &lt;- system.file("AirL2.csv",package="ArArRedux")
fd40file &lt;- system.file("AirH1.csv",package="ArArRedux")
fract &lt;- list(fractionation(fd37file,"L2",PH=TRUE),
              fractionation(fd40file,"H1",PH=FALSE))
if (isTRUE(all.equal(Melbourne$fract,fract))){
  print("We just re-created the fractionation correction for the Melbourne dataset")
}
</code></pre>

<hr>
<h2 id='get4039'>Calculate the 40Ar*/39ArK-ratios</h2><span id='topic+get4039'></span>

<h3>Description</h3>

<p>Calculate the 40Ar*/39ArK-ratios of interference corrected logratio
intercept data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get4039(X, irr)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get4039_+3A_x">X</code></td>
<td>
<p>an object of class <code>redux</code> containing some
interference corrected logratio intercept data</p>
</td></tr>
<tr><td><code id="get4039_+3A_irr">irr</code></td>
<td>
<p>the irradiation schedule</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>link{redux}</code> containing the
40Ar*/39ArK-ratios as <code>intercepts</code> and its covariance matrix
as <code>covmat</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Melbourne)
R &lt;- get4039(Melbourne$X,Melbourne$irr)
plotcorr(R)
</code></pre>

<hr>
<h2 id='getages'>Calculate 40Ar/39Ar ages</h2><span id='topic+getages'></span>

<h3>Description</h3>

<p>Calculate 40Ar/39Ar ages from a vector of 40Ar/39Ar-ratios and
J-factors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getages(RJ)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getages_+3A_rj">RJ</code></td>
<td>
<p>an object of class <code>Redux</code>
containing the amalgamated $^40$Ar$^*$/$^39$Ar$_K$-ratios and
J-factors with their covariance matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>results</code> containing the
ages and their covariance matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Melbourne)
R &lt;- get4039(Melbourne$X,Melbourne$irr)
J &lt;- getJfactors(R)
ages &lt;- getages(J)
plotcorr(ages)
</code></pre>

<hr>
<h2 id='getJfactors'>Calculate the irradiation parameter ('J factor')</h2><span id='topic+getJfactors'></span>

<h3>Description</h3>

<p>Interpolate the irradiation parameters for the samples
given the 40Ar*/39ArK ratios of the samples and fluence monitors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getJfactors(R)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getJfactors_+3A_r">R</code></td>
<td>
<p>a vector of 40Ar*/39ArK ratios</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>redux</code> containing, as
<code>intercepts</code>, the 40Ar*/39ArK ratios of the samples, the
interpolated J-factors, and the 40K decay constant; and as
<code>covmat</code>: the covariance matrix. All other class properties
are inherited from <code>R</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Melbourne)
R &lt;- get4039(Melbourne$X,Melbourne$irr)
J &lt;- getJfactors(R)
plotcorr(J)
</code></pre>

<hr>
<h2 id='getmasses'>Select a subset of isotopes from a dataset</h2><span id='topic+getmasses'></span><span id='topic+getmasses.default'></span><span id='topic+getmasses.timeresolved'></span><span id='topic+getmasses.logratios'></span><span id='topic+getmasses.redux'></span>

<h3>Description</h3>

<p>Extracts the intercepts, covariance matrix, etc. of a selection of
isotopes from a larger dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getmasses(x, ...)

## Default S3 method:
getmasses(x, ...)

## S3 method for class 'timeresolved'
getmasses(x, mass, invert = FALSE, ...)

## S3 method for class 'logratios'
getmasses(x, num, den, invert = FALSE, ...)

## S3 method for class 'redux'
getmasses(x, num, den, invert = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getmasses_+3A_x">x</code></td>
<td>
<p>an object of class <code><a href="#topic+logratios">logratios</a></code>,
<code><a href="#topic+timeresolved">timeresolved</a></code>, <code><a href="#topic+PHdata">PHdata</a></code> or
<code><a href="#topic+redux">redux</a></code>.</p>
</td></tr>
<tr><td><code id="getmasses_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
<tr><td><code id="getmasses_+3A_mass">mass</code></td>
<td>
<p>a vector of strings denoting the masses of interest</p>
</td></tr>
<tr><td><code id="getmasses_+3A_invert">invert</code></td>
<td>
<p>boolean parameter indicating whether the selection
should be inverted (default = FALSE)</p>
</td></tr>
<tr><td><code id="getmasses_+3A_num">num</code></td>
<td>
<p>vector of strings indicating the numerator isotopes</p>
</td></tr>
<tr><td><code id="getmasses_+3A_den">den</code></td>
<td>
<p>vector of string indicating the denominator isotopes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of the same class as x
</p>


<h3>Examples</h3>

<pre><code class='language-R'>kfile &lt;- system.file("K-glass.csv",package="ArArRedux")
masses &lt;- c("Ar37","Ar38","Ar39","Ar40","Ar36")
mk &lt;- loaddata(kfile,masses)
lk &lt;- fitlogratios(blankcorr(mk,"EXB#","K:"),"Ar40")
k &lt;- getmasses(lk,"Ar39","Ar40") # subset of the relevant isotopes
plotcorr(k)
</code></pre>

<hr>
<h2 id='interference'>define the interference corrections</h2><span id='topic+interference'></span>

<h3>Description</h3>

<p>create a new object of class <code>logratios</code> containing
the interferences from neutron reactions on Ca and K
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interference(intercepts, covmat, num, den, irr, label)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="interference_+3A_intercepts">intercepts</code></td>
<td>
<p>a vector with logratios</p>
</td></tr>
<tr><td><code id="interference_+3A_covmat">covmat</code></td>
<td>
<p>the covariance matrix of the logratios</p>
</td></tr>
<tr><td><code id="interference_+3A_num">num</code></td>
<td>
<p>a vector of strings marking the numerator isotopes of
<code>intercepts</code></p>
</td></tr>
<tr><td><code id="interference_+3A_den">den</code></td>
<td>
<p>a vector of strings marking the denominator isotopes of
<code>intercepts</code></p>
</td></tr>
<tr><td><code id="interference_+3A_irr">irr</code></td>
<td>
<p>an object of class <code>irradiations</code></p>
</td></tr>
<tr><td><code id="interference_+3A_label">label</code></td>
<td>
<p>a string with a name which can be used to identify the
interference data in subsequent calculations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>logratios</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>samplefile &lt;- system.file("Samples.csv",package="ArArRedux")
irrfile &lt;- system.file("irradiations.csv",package="ArArRedux")
masses &lt;- c("Ar37","Ar38","Ar39","Ar40","Ar36")
X &lt;- read(samplefile,masses,blabel="EXB#",Jpos=c(3,15))
irr &lt;- loadirradiations(irrfile)
# assume log(36Ar/37Ar) = log(39Ar/37Ar) = 1 in co-irradiate Ca-salt
# with variances of 0.0001 and zero covariances
ca &lt;- interference(intercepts=c(1,1),
                   covmat=matrix(c(0.001,0,0,0.001),nrow=2),
                   num=c("Ar39","Ar36"),den=c("Ar37","Ar37"),
                   irr=X$irr[1],label="Ca-salt")
# assume log(39Ar/40Ar) = 4.637788 in co-irradiate K-glass
# with variance 7.9817e-4
k &lt;- interference(intercepts=4.637788,covmat=7.9817e-4,
                  num="Ar39",den="Ar40",irr=X$irr[1],
                  label="K-glass")
ages &lt;- process(X,irr,ca=ca,k=k)
summary(ages)
</code></pre>

<hr>
<h2 id='loaddata'>Load mass spectrometer data</h2><span id='topic+loaddata'></span>

<h3>Description</h3>

<p>Loads a .csv file with raw mass spectrometer data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loaddata(fname, masses, MS = "ARGUS-VI", PH = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loaddata_+3A_fname">fname</code></td>
<td>
<p>the file name, must end with .csv</p>
</td></tr>
<tr><td><code id="loaddata_+3A_masses">masses</code></td>
<td>
<p>a vector of strings denoting the order of the
isotopes listed in the table</p>
</td></tr>
<tr><td><code id="loaddata_+3A_ms">MS</code></td>
<td>
<p>the type of mass spectrometer</p>
</td></tr>
<tr><td><code id="loaddata_+3A_ph">PH</code></td>
<td>
<p>a boolean indicating whether the data are to be treated
as multicollector (PH=FALSE) or 'peak hopping' (PH=TRUE) data. The
default is PH=FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>if PH=FALSE: an object of class <code>timeresolved</code><br />
if PH=TRUE: an object of class <code>PHdata</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>samplefile &lt;- system.file("Samples.csv",package="ArArRedux")
masses &lt;- c("Ar37","Ar38","Ar39","Ar40","Ar36")
m &lt;- loaddata(samplefile,masses) # samples and J-standards
plot(m,"MD2-1a","Ar40")
</code></pre>

<hr>
<h2 id='loadirradiations'>Load the irradiation schedule</h2><span id='topic+loadirradiations'></span>

<h3>Description</h3>

<p>Loads a .csv file with the schedule of a multi-stage neutron
irradiation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadirradiations(fname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loadirradiations_+3A_fname">fname</code></td>
<td>
<p>file name (in .csv format)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of irradiations, where each irradiation is a named
list containing:
</p>
<p><code>tin</code>: vector with the start times of irradiations <br />
<code>tout</code>: vector with the end times of irradiations <br />
<code>P</code>: vector with the power of the irradiations
</p>


<h3>Examples</h3>

<pre><code class='language-R'>irrfile &lt;- system.file("irradiations.csv",package="ArArRedux")
irr &lt;- loadirradiations(irrfile)
str(irr)
</code></pre>

<hr>
<h2 id='logratios'>The <code>logratios</code> class</h2><span id='topic+logratios'></span>

<h3>Description</h3>

<p>An object class containing logratio intercepts
</p>


<h3>Details</h3>

<p>A list with the following items:
</p>
<p><code>labels</code>: a vector of strings denoting the names of the runs<br />
<code>num</code>: a vector of strings denoting the numerator isotopes<br />
<code>den</code>: a vector of strings denoting the denominator isotopes<br />
<code>intercepts</code>: a vector of logratio intercepts or values<br />
<code>covmat</code>: the covariance matrix of <code>intercepts</code><br />
<code>irr</code>: a vector of strings denoting the irradiation runs<br />
<code>pos</code>: a vector of integers with the positions in the
irradiation stack <br />
<code>thedate</code>: a vector containing the acquisition dates and times<br />
<code>nlr</code>: a vector with the number of logratios per run<br />
</p>

<hr>
<h2 id='massfractionation'>Apply the mass fractionation correction</h2><span id='topic+massfractionation'></span>

<h3>Description</h3>

<p>Applies the fractionation obtained from air shot data by
<code><a href="#topic+fractionation">fractionation</a></code> to the denominator detector in order to
correct it for the mass difference between the numerator and
denominator isotopes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>massfractionation(X, fract)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="massfractionation_+3A_x">X</code></td>
<td>
<p>an object of class <code>redux</code></p>
</td></tr>
<tr><td><code id="massfractionation_+3A_fract">fract</code></td>
<td>
<p>a list with fractionation data for Ar37, Ar39 and Ar40</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>redux</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Melbourne)
C &lt;- calibration(Melbourne$X,"DCAL")
A &lt;- massfractionation(C,Melbourne$fract)
plotcorr(A)
</code></pre>

<hr>
<h2 id='Melbourne'>An example dataset</h2><span id='topic+Melbourne'></span>

<h3>Description</h3>

<p>Contains all the relevant information needed for the data reduction
some ARGUS-IV data from the University of Melbourne
</p>


<h3>Author(s)</h3>

<p>David Philips <a href="mailto:dphillip@unimelb.edu.au">dphillip@unimelb.edu.au</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Melbourne)
plotcorr(Melbourne$X)
</code></pre>

<hr>
<h2 id='newredux'>Create a new <code><a href="#topic+redux">redux</a></code> object</h2><span id='topic+newredux'></span>

<h3>Description</h3>

<p>Initialises a new <code><a href="#topic+redux">redux</a></code> object by packing a
<code><a href="#topic+logratios">logratios</a></code> dataset together with all the parameters
needed for age calculation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>newredux(X, Jpos, detectors = list(Ar36 = "H1", Ar37 = "L2", Ar38 = "L1", Ar39
  = "AX", Ar40 = "H1"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="newredux_+3A_x">X</code></td>
<td>
<p>an object of class <code><a href="#topic+logratios">logratios</a></code></p>
</td></tr>
<tr><td><code id="newredux_+3A_jpos">Jpos</code></td>
<td>
<p>a vector of integers denoting the positions of the
fluence monitors in the irradiation stack</p>
</td></tr>
<tr><td><code id="newredux_+3A_detectors">detectors</code></td>
<td>
<p>a list of strings denoting the detectors for each
argon isotope</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code><a href="#topic+redux">redux</a></code>
</p>

<hr>
<h2 id='param'>Set or get Ar-Ar_Redux parameters</h2><span id='topic+param'></span>

<h3>Description</h3>

<p>This function is used to query and modify the half lives, standard
ages etc. associated with an object of class <code><a href="#topic+redux">redux</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>param(X, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="param_+3A_x">X</code></td>
<td>
<p>an object of class <code><a href="#topic+redux">redux</a></code></p>
</td></tr>
<tr><td><code id="param_+3A_...">...</code></td>
<td>
<p>any combination of the parameters given below</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+param">param</a></code> grants access to the following parameters:
</p>
<p><code>l0</code>: 40K decay constant (default value = 5.5492e-4 Ma-1,
Renne et al. [2010])<br />
<code>sl0</code>: standard error of the 40K decay constant (default value
= 0.0047e-4 Ma-1)<br />
<code>l7</code>: 37Ar decay constant (default value = 7.2438 yr-1, Renne
and Norman [2001])<br />
<code>sl7</code>: standard error of the 37Ar decay constant (default
value = 0.0083 yr-1)<br />
<code>l9</code>: 39Ar decay constant (0.002577 yr-1 Stoenner et
al. [1965])<br />
<code>sl9</code>: standard error of the 39Ar decay constant (0.000014
yr-1)<br />
<code>l6</code>: 36Cl decay constant (default value = 2301.3e-9 yr-1)<br />
<code>sl6</code>: standard error of the 36Cl decay constant (default
value = 7.6e-9 yr-1<br />
<code>pcl</code>: (36Cl/38Cl)-production rate (default value = 252.7 for
OSTR reactor, Renne et al. [2008])<br />
<code>spcl</code>: standard error of the (36Cl/38Cl)-production rate
(default value = 1.8)<br />
<code>ts</code>: age of the fluence monitor (default = 28.201 Myr for the
Fish Canyon Tuff, Kuiper et al. [2008])<br />
<code>sts</code>: standard error of the fluence monitor age (default
value = 0.023 Myr)<br />
<code>air</code>: atmospheric 40Ar/36Ar ratio (default value = 298.56,
Lee et al. [2006])<br />
<code>sair</code>: standard error of the atmospheric 40Ar/36Ar ratio
(default value = 0.155)
</p>


<h3>Value</h3>

<p>returns the modified <code><a href="#topic+redux">redux</a></code> object OR the
current parameter values if no optional arguments are supplied.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Melbourne)
param(Melbourne$X)$air
Y &lt;- param(Melbourne$X,air=295.5)
param(Y)$air
</code></pre>

<hr>
<h2 id='PHdata'>The <code>PHdata</code> class</h2><span id='topic+PHdata'></span>

<h3>Description</h3>

<p>An object class containing time resolved 'peak-hopping' mass
spectrometry data
</p>


<h3>Details</h3>

<p>A list with the following items:
</p>
<p><code>masses</code>: a vector of strings denoting the isotopes monitored in each run<br />
<code>signals</code>: a list with objects of class <code><a href="#topic+timeresolved">timeresolved</a></code>, each corresponding
to a detector (i.e. length(<code>signals</code>)==1 for single collector instruments).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+loaddata">loaddata</a></code>
</p>

<hr>
<h2 id='plot.timeresolved'>Plot a time resolved mass spectrometry signal</h2><span id='topic+plot.timeresolved'></span><span id='topic+plot.PHdata'></span>

<h3>Description</h3>

<p>Plots the raw signal of a given isotope against time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'timeresolved'
plot(x, label, mass, ...)

## S3 method for class 'PHdata'
plot(x, label, mass, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.timeresolved_+3A_x">x</code></td>
<td>
<p>an object of class <code><a href="#topic+timeresolved">timeresolved</a></code> or
<code><a href="#topic+PHdata">PHdata</a></code></p>
</td></tr>
<tr><td><code id="plot.timeresolved_+3A_label">label</code></td>
<td>
<p>a string with the name of the run</p>
</td></tr>
<tr><td><code id="plot.timeresolved_+3A_mass">mass</code></td>
<td>
<p>a string indicating the isotope of interest</p>
</td></tr>
<tr><td><code id="plot.timeresolved_+3A_...">...</code></td>
<td>
<p>optional parameters</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>samplefile &lt;- system.file("Samples.csv",package="ArArRedux")
masses &lt;- c("Ar37","Ar38","Ar39","Ar40","Ar36")
mMC &lt;- loaddata(samplefile,masses)
plot(mMC,"MD2-1a","Ar40")
mPH &lt;- loaddata(samplefile,masses,PH=TRUE)
plot(mPH,"MD2-1a","Ar40")
</code></pre>

<hr>
<h2 id='plotcorr'>Plot a matrix with correlation coefficients</h2><span id='topic+plotcorr'></span>

<h3>Description</h3>

<p>Converts the covariance matrix to a correlation matrix and plots
this is a coloured image for visual inspection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotcorr(X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotcorr_+3A_x">X</code></td>
<td>
<p>a data structure (list) containing an item called &lsquo;covmat&rsquo; (covariance matrix)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(Melbourne)
plotcorr(Melbourne$X)
</code></pre>

<hr>
<h2 id='process'>Process logratio data and calculate 40Ar/39Ar ages</h2><span id='topic+process'></span>

<h3>Description</h3>

<p>Performs detector calibration, mass fractionation correction, decay
corrections, interference corrections, interpolates J-factors and
calculates ages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process(X, irr, fract = NULL, ca = NULL, k = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_+3A_x">X</code></td>
<td>
<p>an object of class <code><a href="#topic+redux">redux</a></code></p>
</td></tr>
<tr><td><code id="process_+3A_irr">irr</code></td>
<td>
<p>the irradiation schedule</p>
</td></tr>
<tr><td><code id="process_+3A_fract">fract</code></td>
<td>
<p>list with air shot data (one item per denominator isotope)</p>
</td></tr>
<tr><td><code id="process_+3A_ca">ca</code></td>
<td>
<p>an object of class <code><a href="#topic+logratios">logratios</a></code> with
Ca-interference data (not necessary if interferences are included in X)</p>
</td></tr>
<tr><td><code id="process_+3A_k">k</code></td>
<td>
<p>an object of class <code><a href="#topic+logratios">logratios</a></code> with
K-interference data (not necessary if interferences are included in X)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(Melbourne)
ages &lt;- process(Melbourne$X,Melbourne$irr,Melbourne$fract)
summary(ages)
</code></pre>

<hr>
<h2 id='read'>Read mass spectrometer data</h2><span id='topic+read'></span>

<h3>Description</h3>

<p>Reads raw mass spectrometer data and parses it into a
<code><a href="#topic+redux">redux</a></code> format for further processing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read(xfile, masses, blabel, Jpos, kfile = NULL, cafile = NULL,
  dfile = NULL, dlabels = NULL, MS = "ARGUS-VI")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_+3A_xfile">xfile</code></td>
<td>
<p>a .csv file with samples and fluence monitor data</p>
</td></tr>
<tr><td><code id="read_+3A_masses">masses</code></td>
<td>
<p>a list which specifies the order in which the isotopes
are recorded by the mass spectrometer</p>
</td></tr>
<tr><td><code id="read_+3A_blabel">blabel</code></td>
<td>
<p>a prefix string denoting the blanks</p>
</td></tr>
<tr><td><code id="read_+3A_jpos">Jpos</code></td>
<td>
<p>a vector of integers denoting the positions of the
fluence monitors in the irradiation stack</p>
</td></tr>
<tr><td><code id="read_+3A_kfile">kfile</code></td>
<td>
<p>a .csv file with the K-interference monitor data
(optional)</p>
</td></tr>
<tr><td><code id="read_+3A_cafile">cafile</code></td>
<td>
<p>a .csv file with the Ca-interference monitor data
(optional)</p>
</td></tr>
<tr><td><code id="read_+3A_dfile">dfile</code></td>
<td>
<p>a .csv file with the detector calibration data
(optional)</p>
</td></tr>
<tr><td><code id="read_+3A_dlabels">dlabels</code></td>
<td>
<p>a list which specifies the names of the detectors
and the order in which they were recorded by the mass spectrometer</p>
</td></tr>
<tr><td><code id="read_+3A_ms">MS</code></td>
<td>
<p>a string denoting the type of mass spectrometer. At the
moment only the ARGUS-IV is listed. Please contact the author to
add other file formats to Ar-Ar_Redux.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code><a href="#topic+redux">redux</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>samplefile &lt;-  system.file("Samples.csv",package="ArArRedux")
kfile &lt;- system.file("K-glass.csv",package="ArArRedux")
cafile &lt;- system.file("Ca-salt.csv",package="ArArRedux")
dfile &lt;- system.file("Calibration.csv",package="ArArRedux")
masses &lt;- c("Ar37","Ar38","Ar39","Ar40","Ar36")
dlabels &lt;- c("H1","AX","L1","L2")
X &lt;- read(samplefile,masses,blabel="EXB#",Jpos=c(3,15),
          kfile,cafile,dfile,dlabels)
plotcorr(X)
</code></pre>

<hr>
<h2 id='redux'>The <code>redux</code> class</h2><span id='topic+redux'></span>

<h3>Description</h3>

<p>An object class that is used throughout Ar-Ar_Redux
</p>


<h3>Details</h3>

<p>A list with the following items:
</p>
<p><code>labels</code>: a vector of strings denoting the names of the runs<br />
<code>num</code>: a vector of strings denoting the numerator isotopes<br />
<code>den</code>: a vector of strings denoting the denominator isotopes<br />
<code>intercepts</code>: a vector of logratio intercepts or values<br />
<code>covmat</code>: the covariance matrix of <code>intercepts</code><br />
<code>irr</code>: a vector of strings denoting the irradiation runs<br />
<code>pos</code>: a vector of integers with the positions in the
irradiation stack <br />
<code>thedate</code>: a vector containing the acquisition dates and times<br />
<code>nlr</code>: a vector with the number of logratios per run<br />
<code>param</code>: a list of global parameters
</p>


<h3>See Also</h3>

<p>param
</p>

<hr>
<h2 id='redux2isoplotr'>Export <code>ArArRedux</code> data to <code>IsoplotR</code></h2><span id='topic+redux2isoplotr'></span>

<h3>Description</h3>

<p>Creates a data object compatible with the <code>IsoplotR</code> package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redux2isoplotr(x, irr, fract = NULL, ca = NULL, k = NULL, format = 1,
  file = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="redux2isoplotr_+3A_x">x</code></td>
<td>
<p>an object of class <code><a href="#topic+redux">redux</a></code></p>
</td></tr>
<tr><td><code id="redux2isoplotr_+3A_irr">irr</code></td>
<td>
<p>the irradiation schedule</p>
</td></tr>
<tr><td><code id="redux2isoplotr_+3A_fract">fract</code></td>
<td>
<p>list with air shot data (one item per denominator
isotope)</p>
</td></tr>
<tr><td><code id="redux2isoplotr_+3A_ca">ca</code></td>
<td>
<p>an object of class <code><a href="#topic+logratios">logratios</a></code> with
Ca-interference data (not necessary if interferences are
included in X)</p>
</td></tr>
<tr><td><code id="redux2isoplotr_+3A_k">k</code></td>
<td>
<p>an object of class <code><a href="#topic+logratios">logratios</a></code> with
K-interference data (not necessary if interferences are
included in X)</p>
</td></tr>
<tr><td><code id="redux2isoplotr_+3A_format">format</code></td>
<td>
<p>input format for <code>IsoplotR</code>. I.e. one of
</p>
<p><code>1</code>: 39/40, s[39/40], 36/40, s[36/40], 39/36, s[39/36]
</p>
<p>(other formats will be added later)</p>
</td></tr>
<tr><td><code id="redux2isoplotr_+3A_file">file</code></td>
<td>
<p>optional (<code>.csv</code>) file name to write the output
to.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>ArAr</code>, i.e. a table with the
following columns: <code>'Ar4036'</code>, <code>'errAr4036'</code>,
<code>'Ar3936'</code>, <code>'errAr3936'</code>, <code>'Ar4039'</code>, and
<code>'errAr4039'</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Melbourne)
print(redux2isoplotr(Melbourne$X,Melbourne$irr))
</code></pre>

<hr>
<h2 id='results'>The <code>results</code> class</h2><span id='topic+results'></span>

<h3>Description</h3>

<p>A list with the following items:
</p>


<h3>Details</h3>

<p><code>labels</code>: a vector of strings denoting the names of the runs<br />
<code>intercepts</code>: a vector of ages<br />
<code>covmat</code>: the covariance matrix of <code>intercepts</code><br />
<code>thedate</code>: a vector containing the acquisition dates and times<br />
</p>

<hr>
<h2 id='subset.timeresolved'>Select a subset of some data</h2><span id='topic+subset.timeresolved'></span><span id='topic+subset.logratios'></span><span id='topic+subset.redux'></span><span id='topic+subset.results'></span>

<h3>Description</h3>

<p>Extracts those intercepts, covariances etc. that match a given list
of indices or labels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'timeresolved'
subset(x, i = NULL, labels = NULL, invert = FALSE,
  include.J = FALSE, ...)

## S3 method for class 'logratios'
subset(x, i = NULL, labels = NULL, invert = FALSE,
  include.J = FALSE, ...)

## S3 method for class 'redux'
subset(x, i = NULL, labels = NULL, invert = FALSE,
  include.J = FALSE, ...)

## S3 method for class 'results'
subset(x, i = NULL, labels = NULL, invert = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="subset.timeresolved_+3A_x">x</code></td>
<td>
<p>an object of class <code><a href="#topic+timeresolved">timeresolved</a></code>,
<code><a href="#topic+logratios">logratios</a></code>, <code><a href="#topic+redux">redux</a></code> or
<code><a href="#topic+results">results</a></code></p>
</td></tr>
<tr><td><code id="subset.timeresolved_+3A_i">i</code></td>
<td>
<p>a vector with indices of the selected runs</p>
</td></tr>
<tr><td><code id="subset.timeresolved_+3A_labels">labels</code></td>
<td>
<p>a string or a vector of strings with sample names</p>
</td></tr>
<tr><td><code id="subset.timeresolved_+3A_invert">invert</code></td>
<td>
<p>boolean flag indicating whether the selection should
be inverted, i.e. whether the selected indices or labels should
be removed rather than retained</p>
</td></tr>
<tr><td><code id="subset.timeresolved_+3A_include.j">include.J</code></td>
<td>
<p>if <code>TRUE</code>, automatically adds the irradiation
monitors to the selection</p>
</td></tr>
<tr><td><code id="subset.timeresolved_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of the same class as <code>x</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Melbourne)
ages &lt;- process(Melbourne$X,Melbourne$irr,Melbourne$fract)
MD &lt;- subset(ages,labels=c("MD2-1","MD2-2","MD2-3","MD2-4","MD2-5"))
plotcorr(MD)
</code></pre>

<hr>
<h2 id='summary.results'>Summary table</h2><span id='topic+summary.results'></span>

<h3>Description</h3>

<p>Plots the ages and their standard errors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'results'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.results_+3A_object">object</code></td>
<td>
<p>an objct of class <code><a href="#topic+results">results</a></code></p>
</td></tr>
<tr><td><code id="summary.results_+3A_...">...</code></td>
<td>
<p>no other arguments</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(Melbourne)
ages &lt;- process(Melbourne$X,Melbourne$irr,Melbourne$fract)
summary(ages)[1:5,]
</code></pre>

<hr>
<h2 id='timeresolved'>The <code>timeresolved</code> class</h2><span id='topic+timeresolved'></span>

<h3>Description</h3>

<p>An object class containing time resolved multi-collector mass spectrometry data
</p>


<h3>Details</h3>

<p>A list with the following items:
</p>
<p><code>masses</code>: a vector of strings denoting the isotopes monitored in each run<br />
<code>irr</code>: a vector of strings denoting the irradiation runs<br />
<code>pos</code>: a vector of integers with the positions in the
irradiation stack <br />
<code>thedate</code>: a vector containing the acquisition dates and times<br />
<code>d</code>: a data table<br />
<code>thetime</code>: a matrix with the measurement times
</p>


<h3>See Also</h3>

<p><code><a href="#topic+loaddata">loaddata</a></code>
</p>

<hr>
<h2 id='weightedmean'>Calculate the weighted mean age</h2><span id='topic+weightedmean'></span>

<h3>Description</h3>

<p>Computes the error weighted mean and MSWD of some samples taking
into covariances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weightedmean(ages, prefix = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weightedmean_+3A_ages">ages</code></td>
<td>
<p>an object of class <code>results</code></p>
</td></tr>
<tr><td><code id="weightedmean_+3A_prefix">prefix</code></td>
<td>
<p>is either a string with the prefix of the
samples that need to be averaged, or a vector of sample names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with items:
</p>
<p><code>avgt</code>: the weighted mean age<br />
<code>err</code>: the standard error of <code>avgt</code><br />
<code>MSWD</code>: the Mean Square of the Weighted Deviates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Melbourne)
ages &lt;- process(Melbourne$X,Melbourne$irr,Melbourne$fract)
weightedmean(ages,"MD2-")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
