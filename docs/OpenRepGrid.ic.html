<!DOCTYPE html><html><head><title>Help for package OpenRepGrid.ic</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {OpenRepGrid.ic}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_image_border'><p>Add a border around an image</p></a></li>
<li><a href='#align_positive_poles'><p>Align all preferred poles on right side</p></a></li>
<li><a href='#calculate_similarity'><p>Calculate similarity matrix</p></a></li>
<li><a href='#cell_text_split'><p>String splitter for comma separated values in Excel cell</p></a></li>
<li><a href='#check_excel_input'><p>Check if Excel input file contains valid data</p></a></li>
<li><a href='#check_excel_input_test'><p>Check if Excel input file contains valid data</p></a></li>
<li><a href='#clique_color_pals'><p>Generate colors for cliques</p></a></li>
<li><a href='#count_matches'><p>Count number of matches / non-matches for two constructs</p></a></li>
<li><a href='#create_excel_output'><p>Create output Excel file</p></a></li>
<li><a href='#dt_default'><p>Default datatable output when loading</p></a></li>
<li><a href='#emptify_object'><p>Create empty dataframe while keeping columns names</p></a></li>
<li><a href='#fnum'><p>Format as x digit number</p></a></li>
<li><a href='#ic'><p>Launch app in browser</p></a></li>
<li><a href='#make_names_vec'><p>standardized variable names</p></a></li>
<li><a href='#network_graph_images'><p>Build network graph plots</p></a></li>
<li><a href='#OpenRepGrid.ic'><p><span class="pkg">OpenRepGrid.ic</span> -  Interpretive Clustering for Repertory Grids</p></a></li>
<li><a href='#replace_one'><p>Replace left or right pole of constructs with blanks</p></a></li>
<li><a href='#valence_pole_prefix'><p>Prefix the pole label with +/- for indicate pole valence</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Title:</td>
<td>Interpretive Clustering for Repertory Grids</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Description:</td>
<td>Shiny UI to identify cliques of related constructs in repertory grid data. 
    See Burr, King, &amp; Heckmann (2020) &lt;<a href="https://doi.org/10.1080%2F14780887.2020.1794088">doi:10.1080/14780887.2020.1794088</a>&gt; for a description 
    of the interpretive clustering (IC) method.</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-18</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, utils, shiny, shinyjs, shinyBS,
shinythemes, shinyWidgets, shinydashboard, shinydashboardPlus
(&ge; 2.0.0), shinycssloaders, shinyFeedback, rintrojs,
formattable, openxlsx, DT, magrittr, dplyr, stringr, reshape2,
scales, splines, igraph, tidyr, withr, RColorBrewer, tidyverse</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, covr, testthat</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/markheckmann/OpenRepGrid.ic">https://github.com/markheckmann/OpenRepGrid.ic</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/markheckmann/OpenRepGrid.ic/issues">https://github.com/markheckmann/OpenRepGrid.ic/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-19 08:28:31 UTC; markheckmann</td>
</tr>
<tr>
<td>Author:</td>
<td>Mark Heckmann <a href="https://orcid.org/0000-0002-0736-7417"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Viv Burr [aut],
  Nigel King [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mark Heckmann &lt;heckmann.mark@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-19 08:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_image_border'>Add a border around an image</h2><span id='topic+add_image_border'></span>

<h3>Description</h3>

<p>Creates border if a color is supplied.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_image_border(color = NA)
</code></pre>

<hr>
<h2 id='align_positive_poles'>Align all preferred poles on right side</h2><span id='topic+align_positive_poles'></span>

<h3>Description</h3>

<p>Align all preferred poles on right side
</p>


<h3>Usage</h3>

<pre><code class='language-R'>align_positive_poles(x)
</code></pre>

<hr>
<h2 id='calculate_similarity'>Calculate similarity matrix</h2><span id='topic+calculate_similarity'></span>

<h3>Description</h3>

<p>Calculate similarity matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_similarity(x, min_matches = 6, align_poles = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_similarity_+3A_x">x</code></td>
<td>
<p>Grid data.</p>
</td></tr>
<tr><td><code id="calculate_similarity_+3A_min_matches">min_matches</code></td>
<td>
<p>Minimal number of matches to considers constructs as related.</p>
</td></tr>
<tr><td><code id="calculate_similarity_+3A_align_poles">align_poles</code></td>
<td>
<p>Align positive poles on the right and negative poles on the left.</p>
</td></tr>
</table>

<hr>
<h2 id='cell_text_split'>String splitter for comma separated values in Excel cell</h2><span id='topic+cell_text_split'></span>

<h3>Description</h3>

<p>String splitter for comma separated values in Excel cell
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cell_text_split(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cell_text_split_+3A_x">x</code></td>
<td>
<p>String to be split</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
cell_text_split("10, 20,30")
cell_text_split("; ,  10  ,,,  20;30,,") # very robust

</code></pre>

<hr>
<h2 id='check_excel_input'>Check if Excel input file contains valid data</h2><span id='topic+check_excel_input'></span>

<h3>Description</h3>

<p>Check if Excel input file contains valid data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_excel_input(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_excel_input_+3A_x">x</code></td>
<td>
<p>Data from Excel input file.</p>
</td></tr>
</table>

<hr>
<h2 id='check_excel_input_test'>Check if Excel input file contains valid data</h2><span id='topic+check_excel_input_test'></span>

<h3>Description</h3>

<p>Check if Excel input file contains valid data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_excel_input_test(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_excel_input_test_+3A_x">x</code></td>
<td>
<p>Data from Excel input file.</p>
</td></tr>
</table>

<hr>
<h2 id='clique_color_pals'>Generate colors for cliques</h2><span id='topic+clique_color_pals'></span>

<h3>Description</h3>

<p>Generate colors for cliques
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clique_color_pals(n, name = "Dark2", alpha = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clique_color_pals_+3A_n">n</code></td>
<td>
<p>Number of colors.</p>
</td></tr>
<tr><td><code id="clique_color_pals_+3A_name">name</code></td>
<td>
<p>Name of RColorBrewer qualitative palette.</p>
</td></tr>
<tr><td><code id="clique_color_pals_+3A_alpha">alpha</code></td>
<td>
<p>Alpha color value for fill colors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with a vector of border and fill colors.
</p>

<hr>
<h2 id='count_matches'>Count number of matches / non-matches for two constructs</h2><span id='topic+count_matches'></span>

<h3>Description</h3>

<p>Missing values lead to neither a match nor non-match
</p>


<h3>Usage</h3>

<pre><code class='language-R'>count_matches(ci, cj, inverse = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="count_matches_+3A_ci">ci</code>, <code id="count_matches_+3A_cj">cj</code></td>
<td>
<p>Two ratings scores to be compared.</p>
</td></tr>
<tr><td><code id="count_matches_+3A_inverse">inverse</code></td>
<td>
<p>Whether to count matches ('FALSE') or inverse matches ('TRUE').</p>
</td></tr>
</table>

<hr>
<h2 id='create_excel_output'>Create output Excel file</h2><span id='topic+create_excel_output'></span>

<h3>Description</h3>

<p>Loads the supplied workbook and adds calculations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_excel_output(file, data = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_excel_output_+3A_file">file</code></td>
<td>
<p>Path to workbook.</p>
</td></tr>
<tr><td><code id="create_excel_output_+3A_data">data</code></td>
<td>
<p>Named list of data objects to add to Excel file.
The following contents are expected: TODO</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Path to saved file.
</p>

<hr>
<h2 id='dt_default'>Default datatable output when loading</h2><span id='topic+dt_default'></span>

<h3>Description</h3>

<p>Default datatable output when loading
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dt_default(text = "Waiting for data ...", header = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dt_default_+3A_text">text</code></td>
<td>
<p>Text to be shown</p>
</td></tr>
<tr><td><code id="dt_default_+3A_header">header</code></td>
<td>
<p>Table header, defaults to an  empty string.</p>
</td></tr>
</table>

<hr>
<h2 id='emptify_object'>Create empty dataframe while keeping columns names</h2><span id='topic+emptify_object'></span>

<h3>Description</h3>

<p>Also works on lists if dataframes are contained as list elements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emptify_object(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emptify_object_+3A_x">x</code></td>
<td>
<p>Dataframe or list.</p>
</td></tr>
</table>

<hr>
<h2 id='fnum'>Format as x digit number</h2><span id='topic+fnum'></span>

<h3>Description</h3>

<p>Format as x digit number
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fnum(x, digits = 2)
</code></pre>

<hr>
<h2 id='ic'>Launch app in browser</h2><span id='topic+ic'></span>

<h3>Description</h3>

<p>Launch app in browser
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ic(display.mode = "auto", launch.browser = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ic_+3A_display.mode">display.mode</code></td>
<td>
<p><code>auto</code> by default, can also be <code>showcase</code>. See
<a href="shiny.html#topic+runApp">runApp</a>.</p>
</td></tr>
<tr><td><code id="ic_+3A_launch.browser">launch.browser</code></td>
<td>
<p>Boolean, set <code>TRUE</code> (default) to open the app in
the browser. See <a href="shiny.html#topic+runApp">runApp</a>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
  ic()
}
</code></pre>

<hr>
<h2 id='make_names_vec'>standardized variable names</h2><span id='topic+make_names_vec'></span><span id='topic+make_names'></span>

<h3>Description</h3>

<p>standardized variable names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_names_vec(x)

make_names(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_names_vec_+3A_x">x</code></td>
<td>
<p>Dataframe or vector</p>
</td></tr>
</table>

<hr>
<h2 id='network_graph_images'>Build network graph plots</h2><span id='topic+network_graph_images'></span>

<h3>Description</h3>

<p>Detects maximal cliques and saves images of network graphs into tempfile.
Tempfile paths and info on cliques are returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>network_graph_images(
  x,
  min_clique_size = 3,
  show_edges = TRUE,
  min_matches = 6,
  label_wrap_width = 15,
  label_max_length = -1,
  indicate_direction = show_edges,
  colorize_direction = TRUE,
  colorize_cliques = TRUE,
  colorize_poles = TRUE,
  align_poles = TRUE,
  alpha = 0.1,
  valence_prefix = FALSE,
  border_default = "#987824",
  fill_default = "#00000008",
  image_border_color = grey(0.6),
  seed = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="network_graph_images_+3A_x">x</code></td>
<td>
<p>A dataframe with a grid.</p>
</td></tr>
<tr><td><code id="network_graph_images_+3A_min_clique_size">min_clique_size</code></td>
<td>
<p>Minimal size of cliques to be considered.</p>
</td></tr>
<tr><td><code id="network_graph_images_+3A_show_edges">show_edges</code></td>
<td>
<p>Whether to show edges in plot.</p>
</td></tr>
<tr><td><code id="network_graph_images_+3A_min_matches">min_matches</code></td>
<td>
<p>Minimal number of matching scores between constructs to be
marked as related.</p>
</td></tr>
<tr><td><code id="network_graph_images_+3A_label_wrap_width">label_wrap_width</code></td>
<td>
<p>Width of wrapped element label text.</p>
</td></tr>
<tr><td><code id="network_graph_images_+3A_label_max_length">label_max_length</code></td>
<td>
<p>Trim element label at max length characters.</p>
</td></tr>
<tr><td><code id="network_graph_images_+3A_indicate_direction">indicate_direction</code>, <code id="network_graph_images_+3A_colorize_direction">colorize_direction</code></td>
<td>
<p>Indicate direction of
relatedness by edge label <code>+/-</code> and edge color (red, green). Only
applied if <code>show_edges = TRUE</code>.</p>
</td></tr>
<tr><td><code id="network_graph_images_+3A_colorize_cliques">colorize_cliques</code></td>
<td>
<p>Draw cliques in different colors? (default <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="network_graph_images_+3A_colorize_poles">colorize_poles</code></td>
<td>
<p>Colorize positive/negative/neutral poles as red, green,
and gray respectively (default <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="network_graph_images_+3A_align_poles">align_poles</code></td>
<td>
<p>Align preferred poles on the same side.</p>
</td></tr>
<tr><td><code id="network_graph_images_+3A_alpha">alpha</code></td>
<td>
<p>Alpha color value for cliques fillings (default <code>.1</code>).</p>
</td></tr>
<tr><td><code id="network_graph_images_+3A_valence_prefix">valence_prefix</code></td>
<td>
<p>Add (+/-) pole prefix to indicate preference. Empty
means no preference.</p>
</td></tr>
<tr><td><code id="network_graph_images_+3A_border_default">border_default</code>, <code id="network_graph_images_+3A_fill_default">fill_default</code></td>
<td>
<p>Default border and fill color of polygon
encircling clique constructs. Used when <code>colorize_cliques</code> is <code>FALSE</code>. Use
<code>NA</code> for no color.</p>
</td></tr>
<tr><td><code id="network_graph_images_+3A_image_border_color">image_border_color</code></td>
<td>
<p>Color of border around generated graph images. If
<code>NULL</code> or <code>NA</code> no border is drawn.</p>
</td></tr>
<tr><td><code id="network_graph_images_+3A_seed">seed</code></td>
<td>
<p>Seed number passed to <code>set.seed</code>. Will determine the
orientation of the graph.</p>
</td></tr>
</table>

<hr>
<h2 id='OpenRepGrid.ic'><span class="pkg">OpenRepGrid.ic</span> -  Interpretive Clustering for Repertory Grids</h2><span id='topic+OpenRepGrid.ic-package'></span><span id='topic+OpenRepGrid.ic'></span>

<h3>Description</h3>

<p>The <span class="pkg">OpenRepGrid.ic</span> package implements <em>Interpretive Clustering (IC)</em>
as outlined in Burr, King, and Heckmann (2020). The authors describe
a variant of construct clustering which uses a procedure from graph theory
called <a href="https://en.wikipedia.org/wiki/Clique_problem#Listing_all_maximal_cliques">maximal cliques enumeration</a>.
Given a similarity measure, in our case the number of matching scores between
two constructs, a network graph of relatedness between constructs is
construed. A clique is a group of constructs which are all mutually related,
given some cut-off criterion for relatedness (e.g. 6 matching scores in a
grid with 7 elements). While the paper also describes an offline approach to identify
the construct cliques, this software automates the process. Under the hood,
the package uses the <code>igraph</code> package for clique identification.
</p>
<p>The package also contains a shiny based UI you can start via the function
<code>ic()</code>. Visit <a href="http://ic.openrepgrid.org">http://ic.openrepgrid.org</a> for an online version.
An introduction to the software is also available on <a href="https://youtu.be/f9oINYA22Rc">YouTube</a>.
Below you find an example of how to process a repgrid in an Excel
file using code only.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Mark Heckmann <a href="mailto:heckmann.mark@gmail.com">heckmann.mark@gmail.com</a> (<a href="https://orcid.org/0000-0002-0736-7417">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Viv Burr
</p>
</li>
<li><p> Nigel King
</p>
</li></ul>



<h3>References</h3>

<p>Burr, V. King, N. &amp; Heckmann, M. (2020) The qualitative analysis of repertory grid data: Interpretive Clustering,
Qualitative Research in Psychology, <a href="https://doi.org/10.1080/14780887.2020.1794088">doi:10.1080/14780887.2020.1794088</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/markheckmann/OpenRepGrid.ic">https://github.com/markheckmann/OpenRepGrid.ic</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/markheckmann/OpenRepGrid.ic/issues">https://github.com/markheckmann/OpenRepGrid.ic/issues</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># The shiny package is just a small UI wrapper around the 
# the workhorse core functions. Here is how to call them.

library(tidyverse)
library(openxlsx)
library(igraph)
library(OpenRepGrid.ic)

file &lt;- system.file("extdata", "sylvia.xlsx", package = "OpenRepGrid.ic")
file_out &lt;- str_replace(file, ".xlsx$", " CLIQUES.xlsx") %&gt;% basename

x &lt;- read.xlsx(file)            # read grid
tests &lt;- check_excel_input(x)   # check if input format is correct
l &lt;- network_graph_images(x, min_clique_size = 3, 
                          show_edges = TRUE, 
                          min_matches = 6)    # produce images
file_tmp &lt;- create_excel_output(file, l)      # create Excel file
# file.show(file_tmp)  # not run during tests

# open images saved as temp files (as shown in output Excel file)
file.show(l$img_all_constructs)
file.show(l$img_all_constructs_full_labels)
file.show(l$img_all_constructs_separate_poles)

file.show(l$img_cliques_only)
file.show(l$img_cliques_only_full_labels)
file.show(l$img_cliques_only_separate_poles)

# calculation results used in network_graph_images
# some of them are also contained in Excel file
s &lt;- calculate_similarity(x)
s


</code></pre>

<hr>
<h2 id='replace_one'>Replace left or right pole of constructs with blanks</h2><span id='topic+replace_one'></span><span id='topic+replace_all'></span>

<h3>Description</h3>

<p>To display the two poles of the constructs as vertex labels with different
colors, the poles have to be printed twice. The helper function replaces all letters
from one of the poles with blanks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replace_one(x, first = TRUE)

replace_all(x, first = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="replace_one_+3A_x">x</code></td>
<td>
<p>Character vector of constructs with '@' sign used to separate construct poles.</p>
</td></tr>
<tr><td><code id="replace_one_+3A_first">first</code></td>
<td>
<p>Replace first pole ('TRUE') or second pole ('FALSE')</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>OpenRepGrid.ic:::replace_all("left pole @ right pole", first = TRUE)
</code></pre>

<hr>
<h2 id='valence_pole_prefix'>Prefix the pole label with +/- for indicate pole valence</h2><span id='topic+valence_pole_prefix'></span>

<h3>Description</h3>

<p>Prefix the pole label with +/- for indicate pole valence
</p>


<h3>Usage</h3>

<pre><code class='language-R'>valence_pole_prefix(x, valence, prefix = "(", postfix = ")")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
