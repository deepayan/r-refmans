<!DOCTYPE html><html><head><title>Help for package binomCI</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {binomCI}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#binomCI-package'>
<p>Confidence Intervals for a Binomial Proportion.</p></a></li>
<li><a href='#binomCI'>
<p>Confidence Intervals for a Binomial Proportion.</p></a></li>
<li><a href='#binomCIs'>
<p>Confidence Intervals for many Binomial Proportions.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Confidence Intervals for a Binomial Proportion</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-02</td>
</tr>
<tr>
<td>Author:</td>
<td>Michail Tsagris [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michail Tsagris &lt;mtsagris@uoc.gr&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Twelve confidence intervals for one binomial proportion or a vector of binomial proportions are computed. The confidence intervals are: Jeffreys,  Wald, Wald corrected, Wald, Blyth and Still,  Agresti and Coull, Wilson, Score, Score corrected, Wald logit, Wald logit corrected, Arcsine and Exact binomial. References include, among others: Vollset, S. E. (1993). "Confidence intervals for a binomial proportion". Statistics in Medicine, 12(9): 809-824. &lt;<a href="https://doi.org/10.1002%2Fsim.4780120902">doi:10.1002/sim.4780120902</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-02 05:30:20 UTC; mtsag</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-02 05:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='binomCI-package'>
Confidence Intervals for a Binomial Proportion.
</h2><span id='topic+binomCI-package'></span>

<h3>Description</h3>

<p>Functions to compute 12 confidence intervals for a binomial proportion.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> binomCI</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-10-02</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Maintainers</h3>

<p>Michail Tsagris <a href="mailto:mtsagris@uoc.gr">mtsagris@uoc.gr</a>.
</p>


<h3>Note</h3>

<p>I would like to express my acknowledgements to Marc Girondot for spotting an error in the &quot;Wilson&quot; method in two extreme cases, when <code class="reqn">x=1</code> and when <code class="reqn">n-x=1</code>. He also proposed a modification that exists in the package &quot;Hmisc&quot; and the relevant paper to cite is Agresti &amp; Coull (1998).
</p>


<h3>Author(s)</h3>

<p>Michail Tsagris <a href="mailto:mtsagris@uoc.gr">mtsagris@uoc.gr</a>.
</p>


<h3>References</h3>

<p>Agresti, A. &amp; Caffo, B. (2000). Simple and effective confidence intervals for proportions and differences of proportions result from adding two successes and two failures. The American Statistician, 54(4), 280&ndash;288.
</p>
<p>Agresti, A. &amp; Coull, B. A. (1998). Approximate is better than &quot;exact&quot; for interval estimation of binomial proportions. The American Statistician, 52(2): 119&ndash;126.
</p>
<p>Brown, L. D., Cai, T. T. &amp; DasGupta, A. (2001). Interval estimation for a binomial proportion. Statistical Science, 16(2): 101-133.
</p>
<p>Brown, L. D., Cai, T. T. &amp; DasGupta, A. (2002). Confidence intervals for a binomial proportion and asymptotic expansions. The Annals of Statistics, 30(1): 160-201.
</p>
<p>Cameron, E. (2011). On the estimation of confidence intervals for binomial population proportions in astronomy: the simplicity and superiority of the Bayesian approach. Publications of the Astronomical Society of Australia, 28(2): 128&ndash;139.
</p>
<p>Newcombe, R. G. (1998). Two-sided confidence intervals for the single proportion: comparison of seven methods. Statistics in Medicine, 17(8): 857&ndash;872.
</p>
<p>Pan, W. (2002). Approximate confidence intervals for one proportion and difference of two proportions. Computational statistics &amp; Data Analysis, 40(1): 143-157.
</p>
<p>Pires, A. M. &amp; Amado, C. (2008). Interval estimators for a binomial proportion: Comparison of twenty methods. REVSTAT-Statistical Journal, 6(2): 165-197.
</p>
<p>Ranucci, G. (2009). Binomial and ratio-of-Poisson-means frequentist confidence intervals applied to the error evaluation of cut efficiencies. arXiv preprint arXiv:0901.4845.
</p>
<p>Sauro, J. &amp; Lewis, J. R. (2005, September). Estimating completion rates from small samples using binomial confidence intervals: comparisons and recommendations. In Proceedings of the Human Factors and Ergonomics Society Annual Meeting (Vol. 49, No. 24, pp. 2100-2103). Sage CA: Los Angeles, CA: SAGE Publications.
</p>
<p>Somerville, M. C. &amp; Brown, R. S. (2013). Exact likelihood ratio and score confidence intervals for the binomial proportion. Pharmaceutical Statistics, 12(3): 120-128.
</p>
<p>Thulin, Mans. The cost of using exact confidence intervals for a binomial proportion. (2014): 817-840.  Electronic Journal of Statistics 8(1): 817-840.
</p>
<p>Vollset, S. E. (1993). Confidence intervals for a binomial proportion. Statistics in Medicine, 12(9): 809-824.
</p>

<hr>
<h2 id='binomCI'>
Confidence Intervals for a Binomial Proportion.
</h2><span id='topic+binomCI'></span>

<h3>Description</h3>

<p>Confidence Intervals for a Binomial Proportion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binomCI(x, n, a = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binomCI_+3A_x">x</code></td>
<td>

<p>The number of successes.
</p>
</td></tr>
<tr><td><code id="binomCI_+3A_n">n</code></td>
<td>

<p>The number of trials.
</p>
</td></tr>
<tr><td><code id="binomCI_+3A_a">a</code></td>
<td>

<p>The significance level to compute the <code class="reqn">(1-\alpha)\%</code> confidence intervals.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The confidence intervals are:
</p>
<p><em>Jeffreys</em>:
</p>
<p style="text-align: center;"><code class="reqn">
\left[ F(\alpha/2; x+0.5, n-x+0.5), F(1-\alpha/2; x+0.5, n-x+0.5) \right],
</code>
</p>

<p>where <code class="reqn">F(\alpha, a, b)</code> denotes the <code class="reqn">\alpha</code> quantile of the Beta distribution with parameters <code class="reqn">a</code> and <code class="reqn">b</code>, <code class="reqn">Be(a, b)</code>.
</p>
<p><em>Wald</em>:
</p>
<p style="text-align: center;"><code class="reqn">
\left[ \hat{p} - Z_{1-\alpha/2} \times \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}, \hat{p} - Z_{1-\alpha/2} \times \sqrt{\frac{\hat{p}(1-\hat{p})}{n}} \right],
</code>
</p>

<p>where <code class="reqn">\hat{p}=\frac{x}{n}</code> and <code class="reqn">Z_{1-\alpha/2}</code> denotes the <code class="reqn">1-\alpha/2</code> quantile of the standard normal distribution. If <code class="reqn">\hat{p}=0</code> the interval becomes <code class="reqn">(0 , 1 - e^{\frac{1}{n}\log({\alpha}{2})})</code> and if <code class="reqn">\hat{p}=1</code> the interval becomes <code class="reqn">(e^{\frac{1}{n}\log({\alpha}{2})}, 1)</code>.
</p>
<p><em>Wald corrected</em>:
</p>
<p style="text-align: center;"><code class="reqn">
\left[ \hat{p} - Z_{1-\alpha/2} \times \sqrt{\frac{\hat{p}(1-\hat{p})}{n}} - \frac{0.5}{n}, \hat{p} - Z_{1-\alpha/2} \times \sqrt{\frac{\hat{p}(1-\hat{p})}{n}} + \frac{0.5}{n} \right],
</code>
</p>

<p>and if <code class="reqn">\hat{p}=0</code> or <code class="reqn">\hat{p}=1</code> the previous (Wald) adjustment applies.
</p>
<p><em>Wald BS</em>:
</p>
<p style="text-align: center;"><code class="reqn">
\left[ \hat{p} - Z_{1-\alpha/2} \times \sqrt{\frac{\hat{p}(1-\hat{p})}{n-Z_{1-\alpha/2}-2Z_{1-\alpha/2}/n-1/n}} - \frac{0.5}{n}, \hat{p} - Z_{1-\alpha/2} \times \sqrt{\frac{\hat{p}(1-\hat{p})}{n-Z_{1-\alpha/2}-2Z_{1-\alpha/2}/n-1/n}} + \frac{0.5}{n} \right],
</code>
</p>

<p>and if <code class="reqn">\hat{p}=0</code> or <code class="reqn">\hat{p}=1</code> the previous (Wald) adjustment applies.
</p>
<p><em>Agresti and Coull</em>:
</p>
<p style="text-align: center;"><code class="reqn">
\left[ \hat{\theta} - Z_{1-\alpha/2} \times \sqrt{\frac{\hat{\theta}(1-\hat{\theta})}{n+4}}, \hat{p} - Z_{1-\alpha/2} \times \sqrt{\frac{\hat{\theta}(1-\hat{\theta})}{n+4}} \right],
</code>
</p>

<p>where <code class="reqn">\hat{\theta}=\frac{x+2}{n+4}</code>.
</p>
<p><em>Wilson</em>:
</p>
<p style="text-align: center;"><code class="reqn">
\left[ \frac{x_b}{n_b} - \frac{Z_{1-\alpha/2}\sqrt{n}}{n_b} \times \sqrt{\hat{p}(1-\hat{p})+Z_{1-\alpha/2}/4}, \frac{x_b}{n_b} + \frac{Z_{1-\alpha/2}\sqrt{n}}{n_b} \times \sqrt{\hat{p}(1-\hat{p})+Z_{1-\alpha/2}/4} \right],
</code>
</p>

<p>where <code class="reqn">x_b=x+Z_{1-\alpha/2}^2/2</code> and <code class="reqn">n_b=n+Z_{1-\alpha/2}^2</code>.
</p>
<p><em>Score</em>:
</p>
<p style="text-align: center;"><code class="reqn">
\left[ \frac{x+Z_{1-\alpha/2}^2-c}{n+Z_{1-\alpha/2}^2} , \frac{x+Z_{1-\alpha/2}^2+c}{n+Z_{1-\alpha/2}^2} \right],
</code>
</p>

<p>where <code class="reqn">c=Z_{1-\alpha/2}\sqrt{x-x^2/n+Z_{1-\alpha/2}^2/4}</code>.
</p>
<p><em>Score corrected</em>:
</p>
<p style="text-align: center;"><code class="reqn">
\left[ \frac{\ell_1}{n+Z_{1-\alpha/2}} , \frac{\ell_2}{n+Z_{1-\alpha/2}} \right],
</code>
</p>

<p>where <code class="reqn">\ell_1=b_1+0.5Z_{1-\alpha/2}^2-Z_{1-\alpha/2}\sqrt{b_1-b_1^2/n+0.25Z_{1-\alpha/2}^2}</code>, <code class="reqn">\ell_2=b_2+0.5Z_{1-\alpha/2}^2+Z_{1-\alpha/2}\sqrt{b_2-b_2^2/n+0.25Z_{1-\alpha/2}^2}</code> and <code class="reqn">b_1=x-0.5</code>, <code class="reqn">b_2=x+0.5</code>.
</p>
<p><em>Wald-logit</em>:
</p>
<p style="text-align: center;"><code class="reqn">
\left[ 1-(1+e^{b-c})^{-1}, 1-(1+e^{b+c})^{-1} \right],
</code>
</p>

<p>where <code class="reqn">b=\log(\frac{x}{n-x})</code> and <code class="reqn">c=\frac{Z_{1-\alpha/2}}{\sqrt{n\hat{p}(1-\hat{p})}}</code>. If <code class="reqn">\hat{p}=0</code> or <code class="reqn">\hat{p}=1</code> the previous (Wald) adjustment applies.
</p>
<p><em>Wald-logit corrected</em>:
</p>
<p style="text-align: center;"><code class="reqn">
\left[ 1-(1+e^{b-c})^{-1}, 1-(1+e^{b+c})^{-1} \right],
</code>
</p>

<p>where <code class="reqn">b=\log(\frac{\hat{p}_b}{\hat{q}_b})</code>, <code class="reqn">\hat{p}_b=x+0.5</code>, <code class="reqn">\hat{q}_b=n-x+0.5</code> and <code class="reqn">c=\frac{Z_{1-\alpha/2}}{\sqrt{(n+1)\frac{\hat{p}_b}{n+1}(1-\frac{\hat{p}_b}{n+1})}}</code>.
</p>
<p><em>Arcsine</em>:
</p>
<p style="text-align: center;"><code class="reqn">
\left\lbrace \sin^2\left[sin^{-1}(\sqrt{\hat{p}})-0.5\frac{Z_{1-\alpha/2}}{\sqrt{n}}\right], \sin^2\left[sin^{-1}(\sqrt{\hat{p}})+0.5\frac{Z_{1-\alpha/2}}{\sqrt{n}}\right] \right\rbrace.
</code>
</p>

<p>If <code class="reqn">\hat{p}=0</code> or <code class="reqn">\hat{p}=1</code> the previous (Wald) adjustment applies.
</p>
<p><em>Exact binomial</em>:
</p>
<p style="text-align: center;"><code class="reqn">
\left[ (1+\frac{a_1}{d_1})^{-1}, (1+\frac{a_2}{d_2})^{-1} \right],
</code>
</p>

<p>where <code class="reqn">a_1=n-x+1</code>, <code class="reqn">a_2=a_1-1</code>, <code class="reqn">d_1=x-F(\alpha/2,2x,2a_1)</code>, <code class="reqn">d_2=(x+1)F(1-\alpha/2,2(x+1),2a_2)</code> and <code class="reqn">F(\alpha,a,b)</code> denotes the <code class="reqn">\alpha</code> quantile of the F distribution with degrees of freedom <code class="reqn">a</code> and <code class="reqn">b</code>, <code class="reqn">F(a, b)</code>.
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr><td><code>prop</code></td>
<td>
<p>The proportion.
</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>

<p>A matrix with 12 rows containing the 12 different <code class="reqn">(1-\alpha)\%</code> confidence intervals.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michail Tsagris.
</p>
<p>R implementation and documentation: Michail Tsagris <a href="mailto:mtsagris@uoc.gr">mtsagris@uoc.gr</a>.
</p>


<h3>See Also</h3>

<p><code> <a href="#topic+binomCIs">binomCIs</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>binomCI(45, 100)
</code></pre>

<hr>
<h2 id='binomCIs'>
Confidence Intervals for many Binomial Proportions.
</h2><span id='topic+binomCIs'></span>

<h3>Description</h3>

<p>Confidence Intervals for many Binomial Proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binomCIs(x, n, a = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binomCIs_+3A_x">x</code></td>
<td>

<p>A vector with the number of successes.
</p>
</td></tr>
<tr><td><code id="binomCIs_+3A_n">n</code></td>
<td>

<p>A vector with the number of trials.
</p>
</td></tr>
<tr><td><code id="binomCIs_+3A_a">a</code></td>
<td>

<p>The significance level to compute the <code class="reqn">(1-\alpha)\%</code> confidence intervals.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the the first element being the vector with the proportions and the rest 12 items
contain the <code class="reqn">(1-\alpha)\%</code> confidence intervals.
</p>


<h3>Author(s)</h3>

<p>Michail Tsagris.
</p>
<p>R implementation and documentation: Michail Tsagris <a href="mailto:mtsagris@uoc.gr">mtsagris@uoc.gr</a>.
</p>


<h3>See Also</h3>

<p><code> <a href="#topic+binomCI">binomCI</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- sample(40, 10)
n &lt;- rep(40, 10)
binomCIs(x, n)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
