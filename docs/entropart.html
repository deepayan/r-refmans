<!DOCTYPE html><html><head><title>Help for package entropart</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {entropart}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AbdFreqCount'>
<p>Abundance Frequency Count of a Community</p></a></li>
<li><a href='#Accumulation'>
<p>Diversity accumulation.</p></a></li>
<li><a href='#AllenH'>
<p>Phylogenetic Entropy of a Community</p></a></li>
<li><a href='#AlphaDiversity'>
<p>Reduced-bias alpha diversity of a metacommunity</p></a></li>
<li><a href='#AlphaEntropy'>
<p>Reduced-bias alpha entropy of a metacommunity</p></a></li>
<li><a href='#ArgumentOriginalName'>
<p>Finds the original value (name of expression) of the argument of a function even in the case of embedded calls.</p></a></li>
<li><a href='#BetaDiversity'>
<p>Reduced-bias beta diversity of a metacommunity</p></a></li>
<li><a href='#BetaEntropy'>
<p>Reduced-bias beta entropy of a metacommunity</p></a></li>
<li><a href='#ChaoPD'>
<p>Phylogenetic Diversity of a Community</p></a></li>
<li><a href='#CheckentropartArguments'>
<p>Checks the arguments of a function of the package entropart</p></a></li>
<li><a href='#CommunityProfile'>
<p>Diversity or Entropy Profile of a community</p></a></li>
<li><a href='#Coverage'>
<p>Sample coverage of a community</p></a></li>
<li><a href='#Diversity'>
<p>Hill number of a community</p></a></li>
<li><a href='#DivEst'>
<p>Diversity Estimation of a metacommunity</p></a></li>
<li><a href='#DivPart'>
<p>Diversity Partition of a metacommunity</p></a></li>
<li><a href='#DivProfile'>
<p>Diversity Profile of a metacommunity</p></a></li>
<li><a href='#Dqz'>
<p>Similarity-based diversity of a community</p></a></li>
<li><a href='#EightSpAbundance'>
<p>Abundances of 8 species to run examples.</p></a></li>
<li><a href='#EightSpTree'>
<p>Functional tree with 8 species.</p></a></li>
<li><a href='#Enq'>
<p>Grassberger's expectation of n^q</p></a></li>
<li><a href='#entropart-package'>
<p>Entropy Partitioning to Measure Diversity</p></a></li>
<li><a href='#EntropyCI'>
<p>Entropy of Monte-Carlo simulated communities</p></a></li>
<li><a href='#expq'>
<p>Exponential of order q</p></a></li>
<li><a href='#GammaDiversity'>
<p>Reduced-bias gamma diversity of a metacommunity</p></a></li>
<li><a href='#GammaEntropy'>
<p>Reduced-bias gamma entropy of a metacommunity</p></a></li>
<li><a href='#GenSimpson'>
<p>Generalized Simpson's Entropy and Diversity</p></a></li>
<li><a href='#Hqz'>
<p>Similarity-based entropy of a community</p></a></li>
<li><a href='#HqzBeta'>
<p>Similarity-based beta entropy of a community</p></a></li>
<li><a href='#Hurlbert'>
<p>Hurlbert's Index and Explicit Diversity</p></a></li>
<li><a href='#KLq'>
<p>Generalized Kullback-Leibler divergence</p></a></li>
<li><a href='#lnq'>
<p>Logarithm of order q</p></a></li>
<li><a href='#MC Utilities'>
<p>Manipulation of meta-communities</p></a></li>
<li><a href='#MCdiversity'>
<p>Meta-Community diversity class.</p></a></li>
<li><a href='#MCentropy'>
<p>Meta-Community entropy class.</p></a></li>
<li><a href='#mergeandlabel'>
<p>Merge community data</p></a></li>
<li><a href='#MetaCommunity'>
<p>Metacommunity class</p></a></li>
<li><a href='#Optimal.Similarity'>
<p>Optimal scale parameter to transform a distance matrix into a similarity matrix</p></a></li>
<li><a href='#Paracou618.dist'>
<p>Functional distances between pairs of species of Paracou field station plots 6 and 18, two 1-ha plots inventoried by the Bridge project.</p></a></li>
<li><a href='#Paracou618.Functional'>
<p>Functional tree of species of Paracou field station plots 6 and 18, two 1-ha plots inventoried by the Bridge project.</p></a></li>
<li><a href='#Paracou618.MC'>
<p>Paracou field station plots 6 and 18, two 1-ha plots inventoried by the Bridge project.</p></a></li>
<li><a href='#Paracou618.Taxonomy'>
<p>Taxonomy (Family - Genus - Species) of Paracou field station plots 6 and 18, two 1-ha plots inventoried by the Bridge project.</p></a></li>
<li><a href='#PDFD'>
<p>Phylogenetic Diversity / Functional Diversity of a Community</p></a></li>
<li><a href='#PhyloApply'>
<p>Apply a Function over a Phylogenetic Tree</p></a></li>
<li><a href='#PhyloBetaEntropy'>
<p>Phylogenetic Beta Entropy of a community</p></a></li>
<li><a href='#PhyloDiversity'>
<p>Phylogenetic Diversity of a Community</p></a></li>
<li><a href='#PhyloEntropy'>
<p>Phylogenetic Entropy of a community</p></a></li>
<li><a href='#PhyloValue'>
<p>Phylogenetic entropy or diversity.</p></a></li>
<li><a href='#PPtree'>
<p>Preprocessed Trees.</p></a></li>
<li><a href='#Preprocess.MC'>
<p>Preprocessing of metacommunity data</p></a></li>
<li><a href='#Preprocess.Tree'>
<p>Preprocessing of a phylogenetic tree</p></a></li>
<li><a href='#RAC'>
<p>Fit Distributions to Well-Known Rank Abundance Curves.</p></a></li>
<li><a href='#Rao'>
<p>Rao Quadratic Entropy of a Community</p></a></li>
<li><a href='#rCommunity'>
<p>Random Communities</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#Richness'>
<p>Number of species of a community</p></a></li>
<li><a href='#Shannon'>
<p>Shannon entropy of a community</p></a></li>
<li><a href='#ShannonBeta'>
<p>Shannon beta entropy of a community</p></a></li>
<li><a href='#Simpson'>
<p>Simpson entropy of a community</p></a></li>
<li><a href='#SimpsonBeta'>
<p>Simpson beta entropy of a community</p></a></li>
<li><a href='#SimTest'>
<p>SimTest class</p></a></li>
<li><a href='#SpeciesDistribution'>
<p>Species Distributions</p></a></li>
<li><a href='#Tsallis'>
<p>Tsallis (HCDT) Entropy of a community</p></a></li>
<li><a href='#TsallisBeta'>
<p>Tsallis beta entropy of a community</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Entropy Partitioning to Measure Diversity</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6-13</td>
</tr>
<tr>
<td>Description:</td>
<td>Measurement and partitioning of diversity, based on Tsallis entropy, following Marcon and Herault (2015) &lt;<a href="https://doi.org/10.18637%2Fjss.v067.i08">doi:10.18637/jss.v067.i08</a>&gt;.
  'entropart' provides functions to calculate alpha, beta and gamma diversity of communities, including phylogenetic and functional diversity.
  Estimation-bias corrections are available.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/EricMarcon/entropart">https://github.com/EricMarcon/entropart</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/EricMarcon/entropart/issues">https://github.com/EricMarcon/entropart/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GNU General Public License]</td>
</tr>
<tr>
<td>Imports:</td>
<td>ape, EntropyEstimation, ggplot2, ggpubr, graphics, grDevices,
parallel, reshape2, rlang, stats, tibble, utils, vegan</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ade4, knitr, pkgdown, rmarkdown, testthat</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>pandoc</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-26 13:22:30 UTC; emarc</td>
</tr>
<tr>
<td>Author:</td>
<td>Eric Marcon <a href="https://orcid.org/0000-0002-5249-321X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Bruno Herault <a href="https://orcid.org/0000-0002-6950-7286"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Eric Marcon &lt;eric.marcon@agroparistech.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-26 14:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AbdFreqCount'>
Abundance Frequency Count of a Community
</h2><span id='topic+AbdFreqCount'></span>

<h3>Description</h3>

<p>Counts the number of species observed the same number of times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AbdFreqCount(Ns, Level = NULL, PCorrection="Chao2015", Unveiling="geom", 
  RCorrection="Rarefy", CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AbdFreqCount_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td></tr>
<tr><td><code id="AbdFreqCount_+3A_level">Level</code></td>
<td>

<p>The level of interpolation or extrapolation. It may be an an arbitrary sample size (an integer) or a sample coverage (a number between 0 and 1).
</p>
</td></tr>
<tr><td><code id="AbdFreqCount_+3A_pcorrection">PCorrection</code></td>
<td>

<p>A string containing one of the possible corrections to estimate a probability distribution in <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>: <code>"Chao2015"</code> is the default value. Used only for extrapolation.
</p>
</td></tr>
<tr><td><code id="AbdFreqCount_+3A_unveiling">Unveiling</code></td>
<td>

<p>A string containing one of the possible unveiling methods to estimate the probabilities of the unobserved species in <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>: <code>"geom"</code> (geometric: the unobserved species distribution is geometric) is the default value. Used only for extrapolation.
</p>
</td></tr>
<tr><td><code id="AbdFreqCount_+3A_rcorrection">RCorrection</code></td>
<td>

<p>A string containing a correction recognized by <code><a href="#topic+Richness">Richness</a></code> to evaluate the total number of species in <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>. <code>"Rarefy"</code> is the default value to estimate the number of species such that the richness of the asymptotic distribution rarefied to the observed sample size equals the observed number of species in the data. Used only for extrapolation.
</p>
</td></tr>
<tr><td><code id="AbdFreqCount_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Abundance Frequency Count (Chao <em>et al.</em>, 2015) is the number of species observed each number of times.
</p>
<p>It is a way to summarize the species distribution.
</p>
<p>It can be estimated at a specified level of interpolation or extrapolation.
Extrapolation relies on the estimation of the estimation of the asymptotic distribution of the community by <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code> and eq. (5) of Chao et al. (2014).
</p>


<h3>Value</h3>

<p>A two-column matrix. The first column contains the number of observations, the second one the number of species observed this number of times.
</p>


<h3>References</h3>

<p>Chao, A., Gotelli, N. J., Hsieh, T. C., Sander, E. L., Ma, K. H., Colwell, R. K., Ellison, A. M (2014). Rarefaction and extrapolation with Hill numbers: A framework for sampling and estimation in species diversity studies.  <em>Ecological Monographs</em>, 84(1): 45-67.
</p>
<p>Chao, A., Hsieh, T. C., Chazdon, R. L., Colwell, R. K., Gotelli, N. J. (2015) Unveiling the Species-Rank Abundance Distribution by Generalizing Good-Turing Sample Coverage Theory. <em>Ecology</em> 96(5): 1189-1201.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PhyloEntropy">PhyloEntropy</a></code>, <code><a href="#topic+ChaoPD">ChaoPD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Ns is the vector of abundances of the first plot
Ns &lt;- Paracou618.MC$Nsi[, 1]

# Return the abundance frequency count
(AbdFreqCount(Ns) -&gt; afc)
plot(afc, xlab="Number of observations", ylab="Number of species")
lines(afc)
</code></pre>

<hr>
<h2 id='Accumulation'>
Diversity accumulation.
</h2><span id='topic+DivAC'></span><span id='topic+EntAC'></span><span id='topic+as.AccumCurve'></span><span id='topic+is.AccumCurve'></span><span id='topic+autoplot.AccumCurve'></span><span id='topic+plot.AccumCurve'></span>

<h3>Description</h3>

<p>Diversity and Entropy Accumulation Curves represent the accumulation of entropy with respect to the sample size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.AccumCurve(x, y, low = NULL, high = NULL)
is.AccumCurve(x)
EntAC(Ns, q = 0, n.seq = seq_len(sum(Ns)), PCorrection="Chao2015", Unveiling="geom",
  RCorrection="Rarefy", NumberOfSimulations = 0, Alpha = 0.05, 
  ShowProgressBar = TRUE, CheckArguments = TRUE)
DivAC(Ns, q = 0, n.seq = seq_len(sum(Ns)), PCorrection="Chao2015", Unveiling="geom",
  RCorrection="Rarefy", NumberOfSimulations = 0, Alpha = 0.05, 
  ShowProgressBar = TRUE, CheckArguments = TRUE)
## S3 method for class 'AccumCurve'
plot(x, ..., main = NULL, 
         xlab = "Sample Size", ylab = NULL, ylim = NULL,
         LineWidth = 2, ShadeColor = "grey75", BorderColor = "red")
## S3 method for class 'AccumCurve'
autoplot(object, ..., main = NULL, 
         xlab = "Sample Size", ylab = NULL, 
         ShadeColor = "grey75", alpha = 0.3, BorderColor = "red",
         col = ggplot2::GeomLine$default_aes$colour,
         lty = ggplot2::GeomLine$default_aes$linetype,
         lwd = ggplot2::GeomLine$default_aes$size)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Accumulation_+3A_x">x</code></td>
<td>

<p>An object. A numeric vector in <code>as.AccumCurve</code>.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_object">object</code></td>
<td>

<p>An object.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_y">y</code></td>
<td>

<p>A numeric vector.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_low">low</code></td>
<td>

<p>A numeric vector.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_high">high</code></td>
<td>

<p>A numeric vector.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_q">q</code></td>
<td>

<p>A number: the order of diversity. Default is 1.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_n.seq">n.seq</code></td>
<td>

<p>A sequence of numbers. Accumulation will be calculated at each value.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_pcorrection">PCorrection</code></td>
<td>

<p>A string containing one of the possible corrections to estimate a probability distribution in <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>: <code>"Chao2015"</code> is the default value. Used only for extrapolation and <code>q</code> different from 0, 1, 2.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_unveiling">Unveiling</code></td>
<td>

<p>A string containing one of the possible unveiling methods to estimate the probabilities of the unobserved species in <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>: <code>"geom"</code> (geometric: the unobserved species distribution is geometric) is the default value. Used only for extrapolation and <code>q</code> different from 0, 1, 2.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_rcorrection">RCorrection</code></td>
<td>

<p>A string containing a correction recognized by <code><a href="#topic+Richness">Richness</a></code> to evaluate the total number of species in <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>. <code>"Rarefy"</code> is the default value to estimate the number of species such that the entropy of the asymptotic distribution rarefied to the observed sample size equals the observed entropy of the data. Used only for extrapolation and <code>q</code> different from 0, 1, 2. If <code>q</code> is 0 (extrapolation of richness), <code>"Rarefy"</code> is taken for <code>"Jackknife"</code>.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_numberofsimulations">NumberOfSimulations</code></td>
<td>

<p>The number of Simulations to build confidence intervals.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_alpha">Alpha</code></td>
<td>

<p>The risk level, 5% by default.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_...">...</code></td>
<td>

<p>Additional arguments to be passed to <code><a href="#topic+plot">plot</a></code>. Unused elsewhere.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_main">main</code></td>
<td>

<p>The main title of the plot. if <code>NULL</code> (by default), there is no title.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_xlab">xlab</code></td>
<td>

<p>The X axis label, &quot;Rank&quot; by default.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_ylab">ylab</code></td>
<td>

<p>The Y axis label. if <code>NULL</code> (by default), &quot;Probability&quot; or &quot;Abundance&quot; is chosen according to the object class.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_ylim">ylim</code></td>
<td>

<p>The interval of y values plotted.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_linewidth">LineWidth</code></td>
<td>

<p>The width of the line that represents the actual profile.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_shadecolor">ShadeColor</code></td>
<td>

<p>The color of the shaded confidence envelope.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_bordercolor">BorderColor</code></td>
<td>

<p>The color of the bounds of the confidence envelope.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_alpha">alpha</code></td>
<td>

<p>Opacity of the confidence enveloppe, between 0 and 1.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_col">col</code></td>
<td>

<p>The color of the geom objects. See &quot;Color Specification&quot; in <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_lty">lty</code></td>
<td>

<p>The type of the lines. See <code><a href="graphics.html#topic+lines">lines</a></code>.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_lwd">lwd</code></td>
<td>

<p>The width of the lines. See <code><a href="graphics.html#topic+lines">lines</a></code>.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_showprogressbar">ShowProgressBar</code></td>
<td>

<p>If <code>TRUE</code> (default), a progress bar is shown.
</p>
</td></tr>
<tr><td><code id="Accumulation_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>DivAC</code> or <code>EntAC</code> estimate the diversity or entropy accumulation curve of a distribution.
See <code><a href="#topic+Tsallis">Tsallis</a></code> for details about the computation of entropy at each level of interpolation and extrapolation.
In accumulation curves, extrapolation if done by estimating the asymptotic distribution of the community and estimating entropy at different levels by interpolation. The asymptotic richess is adjusted so that the extrapolated part of the accumulation joins the observed value at the sample size.
</p>
<p><code>AccumCurve</code> objects include <code>EntAC</code> and <code>DivAC</code> objects for entropy and diversity accumulation.
They generalize the classical Species Accumulation Curves (SAC) which are diversity accumulation of order $q=0$.
</p>
<p><code>as.AccumCurve</code> transforms two vectors (where <code>x</code> is the sammple size and <code>y</code> the accumulation) into an object of class <code>AccumCurve</code>.
</p>
<p><code>AccumCurve</code> objects can be plotted with either <code>plot</code> or <code>autoplot methods</code>.
</p>


<h3>Value</h3>

<p>A <code>DivAC</code> or an <code>EntAC</code> object. Both are <code>AccumCurve</code> objects, which are a list:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The value of entropy or diversity.</p>
</td></tr>
<tr><td><code>low</code></td>
<td>
<p>The lower bound of the confidence envelope of the estimation.</p>
</td></tr>
<tr><td><code>high</code></td>
<td>
<p>The upper bound of the confidence envelope of the estimation.</p>
</td></tr>
</table>
<p>Attibutes <code>"Size"</code> and <code>"Value"</code> contain the actual sample size and the corresponding diversity or entropy.
</p>
<p><code>AccumCurve</code> objects can be summarized and plotted.
</p>


<h3>References</h3>

<p>Chao, A., Gotelli, N. J., Hsieh, T. C., Sander, E. L., Ma, K. H., Colwell, R. K., Ellison, A. M (2014). Rarefaction and extrapolation with Hill numbers: A framework for sampling and estimation in species diversity studies.  <em>Ecological Monographs</em>, 84(1): 45-67.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Tsallis">Tsallis</a></code>, <code><a href="#topic+Diversity">Diversity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Accumulation curve of Simpson's diversity
autoplot(DivAC(Ns, q=2))
</code></pre>

<hr>
<h2 id='AllenH'>
Phylogenetic Entropy of a Community
</h2><span id='topic+AllenH'></span>

<h3>Description</h3>

<p>Calculates the phylogenetic diversity of order <code class="reqn">q</code> of a probability vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AllenH(Ps, q = 1, PhyloTree, Normalize = TRUE, Prune = FALSE, CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AllenH_+3A_ps">Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td></tr>
<tr><td><code id="AllenH_+3A_q">q</code></td>
<td>

<p>A number: the order of entropy. Default is 1.
</p>
</td></tr>
<tr><td><code id="AllenH_+3A_phylotree">PhyloTree</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="ape.html#topic+phylo">phylo</a></code>, <code><a href="ade4.html#topic+phylog">phylog</a></code> or <code><a href="#topic+PPtree">PPtree</a></code>. The tree is not necessarily ultrametric.
</p>
</td></tr>
<tr><td><code id="AllenH_+3A_normalize">Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), diversity is not affected by the height of the tree.<br />
If <code>FALSE</code>, it is proportional to the height of the tree.
</p>
</td></tr>
<tr><td><code id="AllenH_+3A_prune">Prune</code></td>
<td>

<p>What to do when somes species are in the tree but not in <code>Ps</code>?<br />
If <code>TRUE</code>, the tree is pruned to keep species of <code>Ps</code> only. The height of the tree may be changed if a pruned branch is related to the root.<br />
If <code>FALSE</code> (default), species with probability 0 are added in <code>Ps</code>.
</p>
</td></tr>
<tr><td><code id="AllenH_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The phylogenetic entropy is calculated following Allen <em>et al.</em> (2009) for order <code class="reqn">q=1</code> and Leinster and Cobold (2011) for other orders.The result is identical to the total entropy calculated by <code><a href="#topic+PhyloEntropy">PhyloEntropy</a></code> but it is much faster. A single value is returned instead of a <code><a href="#topic+PhyloEntropy">PhyloEntropy</a></code> object, and no bias correction is available.
</p>
<p>The <code>Normalize</code> argument allows normalizing entropy by the height of the tree, similarly to <code><a href="#topic+ChaoPD">ChaoPD</a></code>.
</p>
<p>Diversity can be calculated for non ultrametric trees following Leinster and Cobold (2011) even though the meaning of the result is not so clear.
</p>


<h3>Value</h3>

<p>A named number equal the entropy of the community. The name is &quot;None&quot; to recall that no bias correction is available.
</p>


<h3>References</h3>

<p>Allen, B., Kon, M. and Bar-Yam, Y. (2009). A New Phylogenetic Diversity Measure Generalizing the Shannon Index and Its Application to Phyllostomid Bats. <em>American Naturalist</em> 174(2): 236-243.
</p>
<p>Leinster, T. and Cobbold, C. (2011). Measuring diversity: the importance of species similarity. <em>Ecology</em> 93(3): 477-489.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PhyloEntropy">PhyloEntropy</a></code>, <code><a href="#topic+ChaoPD">ChaoPD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ns)

# Calculate the phylogenetic Shannon diversity of the plot
AllenH(Ps, 1, Paracou618.Taxonomy, Normalize=TRUE)

# Calculate it using PhyloEntropy: more powerful but much slower is the tree has many periods
PhyloEntropy(Ps, 1, Paracou618.Taxonomy, Normalize=TRUE) -&gt; phyE
summary(phyE)
</code></pre>

<hr>
<h2 id='AlphaDiversity'>
Reduced-bias alpha diversity of a metacommunity
</h2><span id='topic+AlphaDiversity'></span>

<h3>Description</h3>

<p>Calculates the eeduced-bias total alpha diversity of order <code class="reqn">q</code> of communities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AlphaDiversity(MC, q = 1, Correction = "Best", Tree = NULL, Normalize = TRUE, 
  Z = NULL, CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AlphaDiversity_+3A_mc">MC</code></td>
<td>

<p>A <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> object.
</p>
</td></tr>
<tr><td><code id="AlphaDiversity_+3A_q">q</code></td>
<td>

<p>A number: the order of diversity. Default is 1 for Shannon diversity.
</p>
</td></tr>
<tr><td><code id="AlphaDiversity_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections accepted by <code><a href="#topic+AlphaEntropy">AlphaEntropy</a></code> or <code>"None"</code> or <code>"Best"</code>, the default value.
</p>
</td></tr>
<tr><td><code id="AlphaDiversity_+3A_tree">Tree</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="ape.html#topic+phylo">phylo</a></code>, <code><a href="ade4.html#topic+phylog">phylog</a></code> or <code><a href="#topic+PPtree">PPtree</a></code>. The tree must be ultrametric.
</p>
</td></tr>
<tr><td><code id="AlphaDiversity_+3A_normalize">Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), diversity is not affected by the height of the tree.<br />
If <code>FALSE</code>, diversity is proportional to the height of the tree.
</p>
</td></tr>
<tr><td><code id="AlphaDiversity_+3A_z">Z</code></td>
<td>

<p>A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</p>
</td></tr>
<tr><td><code id="AlphaDiversity_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Entropy is calculated by <code><a href="#topic+AlphaEntropy">AlphaEntropy</a></code> and transformed into diversity.
</p>


<h3>Value</h3>

<p>An <code><a href="#topic+MCdiversity">MCdiversity</a></code> object containing diversity values of each community and of the metacommunity.
</p>


<h3>References</h3>

<p>Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p>Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AlphaEntropy">AlphaEntropy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Calculate Simpson alpha diversity
summary(AlphaDiversity(Paracou618.MC, 2))
# Compare without correction
summary(AlphaDiversity(Paracou618.MC, 2, Correction = "None"))
# Estimate phylogenetic Simpson alpha diversity
summary(AlphaDiversity(Paracou618.MC, 2, Tree = Paracou618.Taxonomy) -&gt; e)
plot(e)  
</code></pre>

<hr>
<h2 id='AlphaEntropy'>
Reduced-bias alpha entropy of a metacommunity
</h2><span id='topic+AlphaEntropy'></span>

<h3>Description</h3>

<p>Calculates the reduced-bias total alpha entropy of order <code class="reqn">q</code> of communities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AlphaEntropy(MC, q = 1, Correction = "Best", Tree = NULL, Normalize = TRUE,
  Z = NULL, CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AlphaEntropy_+3A_mc">MC</code></td>
<td>

<p>A <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> object.
</p>
</td></tr>
<tr><td><code id="AlphaEntropy_+3A_q">q</code></td>
<td>

<p>A number: the order of diversity. Default is 1 for Shannon entropy.
</p>
</td></tr>
<tr><td><code id="AlphaEntropy_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections accepted by the bias-corrected entropy function (see details) or <code>"None"</code> or <code>"Best"</code>, the default value.
</p>
</td></tr>
<tr><td><code id="AlphaEntropy_+3A_tree">Tree</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="ape.html#topic+phylo">phylo</a></code>, <code><a href="ade4.html#topic+phylog">phylog</a></code> or <code><a href="#topic+PPtree">PPtree</a></code>. The tree must be ultrametric.
</p>
</td></tr>
<tr><td><code id="AlphaEntropy_+3A_normalize">Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), the entropy returned by the function is normalized by the height of the tree (it is the weighted average value of the entropy in each slice).<br />
If <code>FALSE</code>, it is the unnormalized weighted sum of the results.
</p>
</td></tr>
<tr><td><code id="AlphaEntropy_+3A_z">Z</code></td>
<td>

<p>A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</p>
</td></tr>
<tr><td><code id="AlphaEntropy_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>Tree</code> is not <code>NULL</code>, then phylogenetic entropy is calculated by <code><a href="#topic+bcPhyloEntropy">bcPhyloEntropy</a></code>; else, if <code>Z</code> is not <code>NULL</code>, then similarity-based entropy is calculated by <code><a href="#topic+bcHqz">bcHqz</a></code>; else, neutral entropy is calculated by <code><a href="#topic+bcTsallis">bcTsallis</a></code>.
</p>
<p>The alpha entropy of each community is calculated and summed according to community weights.
</p>
<p>The possible corrections are detailed in <code><a href="#topic+Tsallis">Tsallis</a></code>.
</p>


<h3>Value</h3>

<p>An <code><a href="#topic+MCentropy">MCentropy</a></code> object containing entropy values of each community and of the metacommunity.
</p>


<h3>References</h3>

<p>Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p>Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcTsallis">bcTsallis</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Calculate Simpson alpha entropy
summary(AlphaEntropy(Paracou618.MC, 2))
# Compare without correction
summary(AlphaEntropy(Paracou618.MC, 2, Correction = "None"))
# Estimate phylogenetic Simpson alpha entropy
summary(AlphaEntropy(Paracou618.MC, 2, Tree = Paracou618.Taxonomy) -&gt; e)
plot(e)
</code></pre>

<hr>
<h2 id='ArgumentOriginalName'>
Finds the original value (name of expression) of the argument of a function even in the case of embedded calls.
</h2><span id='topic+ArgumentOriginalName'></span>

<h3>Description</h3>

<p>This function is used internally to find the name of arguments passed to entropart functions such as <code><a href="#topic+PhyloDiversity">PhyloDiversity</a></code> that store them in their results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ArgumentOriginalName(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ArgumentOriginalName_+3A_x">x</code></td>
<td>

<p>Any argument.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function searches the name of the argument in the parent frame of the function and stops at the top.
</p>


<h3>Value</h3>

<p>The name of the argument.
</p>


<h3>Author(s)</h3>

<p>BrodieG, &lt;https://stackoverflow.com/users/2725969/brodieg&gt;
</p>
<p>Eric Marcon &lt;Eric.Marcon@agroparistech.fr&gt;
</p>

<hr>
<h2 id='BetaDiversity'>
Reduced-bias beta diversity of a metacommunity
</h2><span id='topic+BetaDiversity'></span>

<h3>Description</h3>

<p>Calculates the reduced-bias beta diversity of order <code class="reqn">q</code> between communities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BetaDiversity(MC, q = 1, Correction = "Best", Tree = NULL, Normalize = TRUE, 
  Z = NULL, CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BetaDiversity_+3A_mc">MC</code></td>
<td>

<p>A <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> object.
</p>
</td></tr>
<tr><td><code id="BetaDiversity_+3A_q">q</code></td>
<td>

<p>A number: the order of diversity. Default is 1 for Shannon diversity.
</p>
</td></tr>
<tr><td><code id="BetaDiversity_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections accepted by <code><a href="#topic+bcTsallisBeta">bcTsallisBeta</a></code> or <code>"None"</code> or <code>"Best"</code>, the default value.
</p>
</td></tr>
<tr><td><code id="BetaDiversity_+3A_tree">Tree</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="ape.html#topic+phylo">phylo</a></code>, <code><a href="ade4.html#topic+phylog">phylog</a></code> or <code><a href="#topic+PPtree">PPtree</a></code>. The tree must be ultrametric.
</p>
</td></tr>
<tr><td><code id="BetaDiversity_+3A_normalize">Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), diversity is not affected by the height of the tree.<br />
If <code>FALSE</code>, diversity is proportional to the height of the tree.
</p>
</td></tr>
<tr><td><code id="BetaDiversity_+3A_z">Z</code></td>
<td>

<p>A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</p>
</td></tr>
<tr><td><code id="BetaDiversity_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Entropy is calculated by <code><a href="#topic+BetaEntropy">BetaEntropy</a></code> and transformed into diversity.
</p>
<p>Diversity values of communities are not defined: community entropies are averaged to obtain the metacommunity entropy wich is transformed into diversity (Marcon et al., 2014).
</p>


<h3>Value</h3>

<p>An <code><a href="#topic+MCdiversity">MCdiversity</a></code> object containing diversity value of the metacommunity.
</p>


<h3>References</h3>

<p>Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p>Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BetaEntropy">BetaEntropy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Estimate Shannon beta diversity
summary(BetaDiversity(Paracou618.MC, 1))
# Compare without correction
summary(BetaDiversity(Paracou618.MC, 1, Correction = "None"))
# Estimate phylogenetic Shannon beta diversity
summary(BetaDiversity(Paracou618.MC, 1, Tree = Paracou618.Taxonomy) -&gt; e)
</code></pre>

<hr>
<h2 id='BetaEntropy'>
Reduced-bias beta entropy of a metacommunity
</h2><span id='topic+BetaEntropy'></span>

<h3>Description</h3>

<p>Calculates the reduced-bias beta entropy of order <code class="reqn">q</code> between communities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BetaEntropy(MC, q = 1, Correction = "Best", Tree = NULL, Normalize = TRUE, 
  Z = NULL, CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BetaEntropy_+3A_mc">MC</code></td>
<td>

<p>A <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> object.
</p>
</td></tr>
<tr><td><code id="BetaEntropy_+3A_q">q</code></td>
<td>

<p>A number: the order of diversity. Default is 1 for Shannon entropy.
</p>
</td></tr>
<tr><td><code id="BetaEntropy_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections accepted by the bias-corrected entropy function (see details) or <code>"None"</code> or <code>"Best"</code>, the default value.
</p>
</td></tr>
<tr><td><code id="BetaEntropy_+3A_tree">Tree</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="ape.html#topic+phylo">phylo</a></code>, <code><a href="ade4.html#topic+phylog">phylog</a></code> or <code><a href="#topic+PPtree">PPtree</a></code>. The tree must be ultrametric.
</p>
</td></tr>
<tr><td><code id="BetaEntropy_+3A_normalize">Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), the entropy returned by the function is normalized by the height of the tree (it is the weighted average value of the entropy in each slice).<br />
If <code>FALSE</code>, it is the unnormalized weighted sum of the results.
</p>
</td></tr>
<tr><td><code id="BetaEntropy_+3A_z">Z</code></td>
<td>

<p>A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</p>
</td></tr>
<tr><td><code id="BetaEntropy_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>Tree</code> is not <code>NULL</code>, then phylogenetic entropy is calculated by <code><a href="#topic+bcPhyloBetaEntropy">bcPhyloBetaEntropy</a></code>; else, if <code>Z</code> is not <code>NULL</code>, then similarity-based entropy is calculated by <code><a href="#topic+bcHqzBeta">bcHqzBeta</a></code>; else, neutral entropy is calculated by <code><a href="#topic+bcTsallisBeta">bcTsallisBeta</a></code>.
</p>
<p>The reduced-bias beta entropy of each community is calculated and summed according to community weights.
</p>
<p>Note that beta entropy is related to alpha entropy (if <code class="reqn">q</code> is not 1) and cannot be compared accross communities (Jost, 2007). Do rather calculate the <code><a href="#topic+BetaDiversity">BetaDiversity</a></code> of the metacommunity.
</p>


<h3>Value</h3>

<p>An <code><a href="#topic+MCentropy">MCentropy</a></code> object containing entropy values of each community and of the metacommunity.
</p>


<h3>References</h3>

<p>Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p>Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcTsallisBeta">bcTsallisBeta</a></code>, <code><a href="#topic+BetaDiversity">BetaDiversity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Estimate Shannon beta entropy
summary(BetaEntropy(Paracou618.MC, 1))
# Compare without correction
summary(BetaEntropy(Paracou618.MC, 1, Correction = "None"))
# Estimate phylogenetic Shannon beta entropy
summary(BetaEntropy(Paracou618.MC, 1, Tree = Paracou618.Taxonomy) -&gt; e)
plot(e)  
</code></pre>

<hr>
<h2 id='ChaoPD'>
Phylogenetic Diversity of a Community
</h2><span id='topic+ChaoPD'></span>

<h3>Description</h3>

<p>Calculates the phylogenetic diversity of order <code class="reqn">q</code> of a probability vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ChaoPD(Ps, q = 1, PhyloTree, Normalize = TRUE, Prune = FALSE, CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ChaoPD_+3A_ps">Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td></tr>
<tr><td><code id="ChaoPD_+3A_q">q</code></td>
<td>

<p>A number: the order of diversity. Default is 1.
</p>
</td></tr>
<tr><td><code id="ChaoPD_+3A_phylotree">PhyloTree</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="ape.html#topic+phylo">phylo</a></code>, <code><a href="ade4.html#topic+phylog">phylog</a></code> or <code><a href="#topic+PPtree">PPtree</a></code>. The tree is not necessarily ultrametric.
</p>
</td></tr>
<tr><td><code id="ChaoPD_+3A_normalize">Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), diversity is not affected by the height of the tree.<br />
If <code>FALSE</code>, it is proportional to the height of the tree.
</p>
</td></tr>
<tr><td><code id="ChaoPD_+3A_prune">Prune</code></td>
<td>

<p>What to do when somes species are in the tree but not in <code>Ps</code>?<br />
If <code>TRUE</code>, the tree is pruned to keep species of <code>Ps</code> only. The height of the tree may be changed if a pruned branch is related to the root.<br />
If <code>FALSE</code> (default), species with probability 0 are added in <code>Ps</code>.
</p>
</td></tr>
<tr><td><code id="ChaoPD_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The phylogenetic diversity is calculated following Chao <em>et al.</em> (2010). The result is identical to the total diversity calculated by <code><a href="#topic+PhyloDiversity">PhyloDiversity</a></code> but it is much faster. A single value is returned instead of a <code><a href="#topic+PhyloDiversity">PhyloDiversity</a></code> object, and no bias correction is available.
</p>
<p>The <code>Normalize</code> arguments allows calculating either <code class="reqn">^{q}\bar{D}(T)</code> (if <code>TRUE</code>) or <code class="reqn">^{q}PD(T)</code> if <code>FALSE</code>.
</p>
<p>Diversity can be calculated for non ultrametric trees following Chao <em>et al.</em> (2010) even though the meaning of the result is not so clear (Leinster and Cobold, 2011).
</p>


<h3>Value</h3>

<p>A named number equal the diversity of the community. The name is &quot;None&quot; to recall that no bias correction is available.
</p>


<h3>References</h3>

<p>Chao, A., Chiu, C.-H. and Jost, L. (2010). Phylogenetic diversity measures based on Hill numbers. <em>Philosophical Transactions of the Royal Society B</em> 365(1558): 3599-609.
</p>
<p>Leinster, T. and Cobbold, C. (2011). Measuring diversity: the importance of species similarity. <em>Ecology</em> 93(3): 477-489.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PhyloDiversity">PhyloDiversity</a></code>, <code><a href="#topic+AllenH">AllenH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- Paracou618.MC$Ps

# Calculate the phylogenetic Simpson diversity of the plot
(ChaoPD(Paracou618.MC$Ps, 2, Paracou618.Taxonomy, Normalize=TRUE))

# Calculate it using PhyloDiversity
# (more powerful but much slower if the tree has many periods)
PhyloDiversity(Paracou618.MC$Ps, 2, Paracou618.Taxonomy, Normalize=TRUE) -&gt; phyD
summary(phyD)
</code></pre>

<hr>
<h2 id='CheckentropartArguments'>
Checks the arguments of a function of the package entropart
</h2><span id='topic+CheckentropartArguments'></span>

<h3>Description</h3>

<p>This function is used internally to verify that arguments passed to entropart functions such as <code><a href="#topic+PhyloDiversity">PhyloDiversity</a></code> are correct.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CheckentropartArguments()
</code></pre>


<h3>Details</h3>

<p>The function compares the arguments passed to its parent function to the type they should be and performs some extra tests (<em>e.g.</em> probabilities must be positive and sum to 1). It stops if an argument is not correct.
</p>


<h3>Value</h3>

<p>Returns <code>TRUE</code> or stops if a problem is detected.
</p>

<hr>
<h2 id='CommunityProfile'>
Diversity or Entropy Profile of a community
</h2><span id='topic+CommunityProfile'></span><span id='topic+as.CommunityProfile'></span><span id='topic+is.CommunityProfile'></span><span id='topic+plot.CommunityProfile'></span><span id='topic+autoplot.CommunityProfile'></span><span id='topic+CEnvelope'></span>

<h3>Description</h3>

<p>Calculates the diversity or entropy profile of a community, applying a community function to a vector of orders.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CommunityProfile(FUN, NorP, q.seq = seq(0, 2, 0.1), 
    NumberOfSimulations = 0, Alpha = 0.05, BootstrapMethod = "Chao2015", 
    size = 1, ..., ShowProgressBar = TRUE, CheckArguments = TRUE)
as.CommunityProfile(x, y, low = NULL, high = NULL, mid = NULL)
is.CommunityProfile(x)
## S3 method for class 'CommunityProfile'
plot(x, ..., main = NULL, 
          xlab = "Order of Diversity", ylab = "Diversity", ylim = NULL,
          LineWidth = 2, ShadeColor = "grey75", BorderColor = "red")
## S3 method for class 'CommunityProfile'
autoplot(object, ..., main = NULL, 
          xlab = "Order of Diversity", ylab = "Diversity",
          ShadeColor = "grey75", alpha = 0.3, BorderColor = "red",
          col = ggplot2::GeomLine$default_aes$colour,
          lty = ggplot2::GeomLine$default_aes$linetype,
          lwd = ggplot2::GeomLine$default_aes$size)
CEnvelope(Profile, LineWidth = 2, ShadeColor = "grey75", BorderColor = "red", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CommunityProfile_+3A_fun">FUN</code></td>
<td>

<p>The function to be applied to each value of <code class="reqn">q.seq</code>. Any function accepting a numeric vector (or a two-column matrix) and a number as first two arguments and an argument named <code>CheckArguments</code> is acceptable (other arguments of the functions are passed by <code>...</code>). See *Details* for useful entropy and diversity functions and *Examples* for an ad-hoc one.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector. Contains either abundances or probabilities.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_q.seq">q.seq</code></td>
<td>

<p>A numeric vector: the sequence of diversity orders to address. Default is from 0 to 2.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_numberofsimulations">NumberOfSimulations</code></td>
<td>

<p>The number of simulations to run, 0 by default.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_alpha">Alpha</code></td>
<td>

<p>The risk level, 5% by default.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_bootstrapmethod">BootstrapMethod</code></td>
<td>

<p>The method used to obtain the probabilities to generate bootstrapped communities from observed abundances. See <code><a href="#topic+rCommunity">rCommunity</a></code>.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_size">size</code></td>
<td>

<p>The size of simulated communities used to compute the bootstrap confidence envelope. 1 (default) means that the actual size must be used.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_object">object</code></td>
<td>

<p>An object.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_x">x</code></td>
<td>

<p>An object to be tested or plotted or the vector of orders of community profiles in <code>as.CommunityProfile</code>.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_y">y</code></td>
<td>

<p>Entropy or diversity values of each order, corresponding to <code>x</code> values.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_low">low</code></td>
<td>

<p>Entropy or diversity lower bound of the confidence envelope, corresponding to <code>x</code> values.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_high">high</code></td>
<td>

<p>Entropy or diversity higher bound of the confidence envelope, corresponding to <code>x</code> values.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_mid">mid</code></td>
<td>

<p>Entropy or diversity center value (usually the mean) of the confidence envelope, corresponding to <code>x</code> values.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_profile">Profile</code></td>
<td>

<p>An <code>CommunityProfile</code> to be plotted.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_...">...</code></td>
<td>

<p>Additional arguments to be passed to <code>FUN</code> in <code>CommunityProfile</code>, to <code>plot</code> in <code>plot.CommunityProfile</code> or to <code>lines</code> in <code>CEnvelope</code>.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_main">main</code></td>
<td>

<p>The main title of the plot.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_xlab">xlab</code></td>
<td>

<p>The x axis label of the plots.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_ylab">ylab</code></td>
<td>

<p>The y axis label of the plot.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_ylim">ylim</code></td>
<td>

<p>The interval of y values plotted.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_linewidth">LineWidth</code></td>
<td>

<p>The width of the line that represents the actual profile.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_shadecolor">ShadeColor</code></td>
<td>

<p>The color of the shaded confidence envelope.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_bordercolor">BorderColor</code></td>
<td>

<p>The color of the bounds of the confidence envelope.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_alpha">alpha</code></td>
<td>

<p>Opacity of the confidence enveloppe, between 0 and 1.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_col">col</code></td>
<td>

<p>The color of the geom objects. See &quot;Color Specification&quot; in <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_lty">lty</code></td>
<td>

<p>The type of the lines. See <code><a href="graphics.html#topic+lines">lines</a></code>.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_lwd">lwd</code></td>
<td>

<p>The width of the lines. See <code><a href="graphics.html#topic+lines">lines</a></code>.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_showprogressbar">ShowProgressBar</code></td>
<td>

<p>If <code>TRUE</code> (default), a progress bar is shown.
</p>
</td></tr>
<tr><td><code id="CommunityProfile_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>CommunityProfile</code> is used to calculate diversity or entropy profiles based on community functions such as <code><a href="#topic+Tsallis">Tsallis</a></code> or <code><a href="#topic+ChaoPD">ChaoPD</a></code>. 
The first two arguments of the function must be a probability or abundance vector and a number (<code class="reqn">q</code>).
Additional arguments cannot be checked. 
Unexpected results may be returned if <code>FUN</code> is not used properly.
</p>
<p>If <code>NumberOfSimulations</code> is greater than 0, a bootstrap confidence interval is produced by simulating communities with <code><a href="#topic+rCommunity">rCommunity</a></code> and calculating their profiles. 
The size of those communities may be that of the actual community or specified by <code>size</code>.
Simulating communities implies a downward bias in the estimation: rare species of the actual community may have abundance zero in simulated communities.
Simulated diversity values are recentered if 'size = 1' so that their mean is that of the actual community.
Else, it is assumed that the bias is of interest and must not be corrected.
</p>
<p><code>CommunityProfile</code> objects can be plotted. 
They can also be added to the current plot by <code>CEnvelope</code>.
</p>


<h3>Value</h3>

<p>A <code>CommunityProfile</code>, which is a list:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>The order <code class="reqn">q</code> values</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The entropy or diversity values returned by <code>FUN</code></p>
</td></tr>
<tr><td><code>low</code></td>
<td>
<p>The lower bound of the confidence interval</p>
</td></tr>
<tr><td><code>high</code></td>
<td>
<p>The upper bound of the confidence interval</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Eric Marcon &lt;Eric.Marcon@agroparistech.fr&gt;, Bruno Herault &lt;Bruno.Herault@cirad.fr&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Plot diversity estimated without bias correction
plot(CommunityProfile(Diversity, Paracou618.MC$Ps, seq(0, 2, 0.2)), 
lty=3, ylim=c(50, 350))
# Estimate diversity, with a condidence envelope 
# (only 10 simulations to save time, should be 1000)
Profile &lt;- CommunityProfile(Diversity, as.AbdVector(Paracou618.MC$Ns), 
		  seq(0, 2, 0.2), Correction="UnveilJ", NumberOfSimulations=10)
# Complete the plot, and add the legend
CEnvelope(Profile, main="Paracou Plots Diversity")
legend("topright", c("Bias Corrected", "Biased"), lty=c(1,3), inset=0.01)

# Advanced use with beta-diversity functions :
# Profile of the beta entropy of the first community of Paracou618.
# Observed and expected probabilities are bound into a 2-column matrix
# An intermediate function is necessary to separate them before calling TsallisBeta
# The CheckArguments is mandatory but does not need to be set: CommunityProfile() sets it to FALSE
CommunityProfile(function(PandPexp, q, CheckArguments) 
  {TsallisBeta(PandPexp[, 1], PandPexp[, 2], q)}, 
  NorP=cbind(Paracou618.MC$Psi[, 1], Paracou618.MC$Ps), q.seq=seq(0, 2, 0.2))
</code></pre>

<hr>
<h2 id='Coverage'>
Sample coverage of a community
</h2><span id='topic+Coverage'></span><span id='topic+Coverage2Size'></span>

<h3>Description</h3>

<p><code>"Coverage"</code> calculates an estimator of the sample coverage of a community described by its abundance vector.
<code>"Coverage2Size"</code> estimates the sample size corresponding to the chosen sample coverage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Coverage(Ns, Estimator = "Best", Level = NULL, CheckArguments = TRUE)
Coverage2Size(Ns, SampleCoverage, CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Coverage_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td></tr>
<tr><td><code id="Coverage_+3A_estimator">Estimator</code></td>
<td>

<p>A string containing one of the possible estimators: <code>"ZhangHuang"</code>, <code>"Chao"</code>, <code>"Turing"</code>, <code>"Good"</code>. <code>"Best"</code> is for <code>"ZhangHuang"</code>.
</p>
</td></tr>
<tr><td><code id="Coverage_+3A_level">Level</code></td>
<td>

<p>The level of interpolation or extrapolation, i.e. an abundance.
</p>
</td></tr>
<tr><td><code id="Coverage_+3A_samplecoverage">SampleCoverage</code></td>
<td>

<p>The target sample coverage. 
</p>
</td></tr>
<tr><td><code id="Coverage_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sample coverage <code class="reqn">C</code> of a community is the total probability of occurence of the species observed in the sample. <code class="reqn">1-C</code> is the probability for an individual of the whole community to belong to a species that has not been sampled.
</p>
<p>The historical estimator is due to Turing (Good, 1953). It only relies on singletons (species observed only once). Chao's (Chao and Shen, 2010) estimator uses doubletons too and Zhang-Huang's (Chao et al., 1988; Zhang and Huang, 2007) uses the whole distribution.
</p>
<p>If <code>Level</code> is not null, the sample coverage is interpolated or extrapolated. Interpolation by the Good estimator relies on the equality between sampling deficit and the generalized Simpson entropy (Good, 1953). The Chao (2014) estimator allows extrapolation, reliable up a level equal to the double size of the sample.
</p>


<h3>Value</h3>

<p><code>"Coverage"</code> returns a named number equal to the calculated sample coverage. The name is that of the estimator used.
<code>"Coverage2Size"</code> returns a number equal to the sample size corresponding to the chosen sample coverage.
</p>


<h3>References</h3>

<p>Chao, A., Lee, S.-M. and Chen, T.-C. (1988). A generalized Good's nonparametric coverage estimator. <em>Chinese Journal of Mathematics</em> 16: 189-199.
</p>
<p>Chao, A. and Shen, T.-J. (2010). <em>Program SPADE: Species Prediction And Diversity Estimation. Program and user's guide</em>. CARE, Hsin-Chu, Taiwan.
</p>
<p>Chao, A., Gotelli, N. J., Hsieh, T. C., Sander, E. L., Ma, K. H., Colwell, R. K., Ellison, A. M (2014). Rarefaction and extrapolation with Hill numbers: A framework for sampling and estimation in species diversity studies.  <em>Ecological Monographs</em>, 84(1): 45-67.
</p>
<p>Good, I. J. (1953). On the Population Frequency of Species and the Estimation of Population Parameters. <em>Biometrika</em> 40(3/4): 237-264.
</p>
<p>Zhang, Z. and Huang, H. (2007). Turing's formula revisited. <em>Journal of Quantitative Linguistics</em> 14(2-3): 222-241.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the vector of abundances of the metacommunity
Ns &lt;- Paracou618.MC$Ns
# Calculate the sample coverage of the metacommunity
Coverage(Ns)    # Stored in Paracou618.SampleCoverage
</code></pre>

<hr>
<h2 id='Diversity'>
Hill number of a community
</h2><span id='topic+Diversity'></span><span id='topic+bcDiversity'></span><span id='topic+Diversity.ProbaVector'></span><span id='topic+Diversity.AbdVector'></span><span id='topic+Diversity.integer'></span><span id='topic+Diversity.numeric'></span>

<h3>Description</h3>

<p>Calculates the HCDT (generalized) diversity of order <code class="reqn">q</code> of a probability vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Diversity(NorP, q = 1, ...)
bcDiversity(Ns, q = 1, Correction = "Best", CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
Diversity(NorP, q = 1, ..., 
  CheckArguments = TRUE, Ps = NULL)
## S3 method for class 'AbdVector'
Diversity(NorP, q = 1, Correction = "Best", Level = NULL,
  PCorrection="Chao2015", Unveiling="geom", RCorrection="Rarefy", ...,
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'integer'
Diversity(NorP, q = 1, Correction = "Best", Level = NULL,
  PCorrection="Chao2015", Unveiling="geom", RCorrection="Rarefy", ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'numeric'
Diversity(NorP, q = 1, Correction = "Best", Level = NULL,
  PCorrection="Chao2015", Unveiling="geom", RCorrection="Rarefy", ..., 
  CheckArguments = TRUE, Ps = NULL, Ns = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Diversity_+3A_ps">Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td></tr>
<tr><td><code id="Diversity_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td></tr>
<tr><td><code id="Diversity_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities.
</p>
</td></tr>
<tr><td><code id="Diversity_+3A_q">q</code></td>
<td>

<p>A number: the order of diversity. Default is 1.
</p>
</td></tr>
<tr><td><code id="Diversity_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible asymptotic estimators: <code>"None"</code> (no correction), <code>"ChaoShen"</code>, <code>"GenCov"</code>, <code>"Grassberger"</code>, <code>"Holste"</code>, <code>"Bonachela"</code>, <code>"ZhangGrabchak"</code>, or <code>"ChaoJost"</code>, <code>"Marcon"</code>, <code>"UnveilC"</code>, <code>"UnveiliC"</code>, <code>"UnveilJ"</code> or <code>"Best"</code>, the default value. Currently, <code>"Best"</code> is <code>"UnveilJ"</code>.
</p>
</td></tr>
<tr><td><code id="Diversity_+3A_level">Level</code></td>
<td>

<p>The level of interpolation or extrapolation. It may be an a chosen sample size (an integer) or a sample coverage (a number between 0 and 1).
</p>
</td></tr>
<tr><td><code id="Diversity_+3A_pcorrection">PCorrection</code></td>
<td>

<p>A string containing one of the possible corrections to estimate a probability distribution in <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>: <code>"Chao2015"</code> is the default value. Used only for extrapolation.
</p>
</td></tr>
<tr><td><code id="Diversity_+3A_unveiling">Unveiling</code></td>
<td>

<p>A string containing one of the possible unveiling methods to estimate the probabilities of the unobserved species in <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>: <code>"geom"</code> (the unobserved species distribution is geometric) is the default value. Used only for extrapolation.
</p>
</td></tr>
<tr><td><code id="Diversity_+3A_rcorrection">RCorrection</code></td>
<td>

<p>A string containing a correction recognized by <code><a href="#topic+Richness">Richness</a></code> to evaluate the total number of species in <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>. <code>"Rarefy"</code> is the default value to estimate the number of species such that the diversity of the asymptotic distribution rarefied to the observed sample size equals the observed diversity of the data. Used only for extrapolation.
</p>
</td></tr>
<tr><td><code id="Diversity_+3A_...">...</code></td>
<td>

<p>Additional arguments. Unused.
</p>
</td></tr>
<tr><td><code id="Diversity_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Diversity</code> calls <code><a href="#topic+Tsallis">Tsallis</a></code> to calculate entropy and transforms it into diversity by calculating its deformed exponential.
</p>
<p>Bias correction requires the number of individuals to estimate sample <code><a href="#topic+Coverage">Coverage</a></code>. 
See <code><a href="#topic+Tsallis">Tsallis</a></code> for details.
</p>
<p>The functions are designed to be used as simply as possible. 
<code>Diversity</code> is a generic method. 
If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcDiversity</code> is called.
</p>
<p>Diversity can be estimated at a specified level of interpolation or extrapolation, either a chosen sample size or sample coverage (Chao et al., 2014), rather than its asymptotic value.
See <code><a href="#topic+Tsallis">Tsallis</a></code> for details.
</p>


<h3>Value</h3>

<p>A named number equal to the calculated diversity. The name is that of the bias correction used.
</p>


<h3>References</h3>

<p>Chao, A., Gotelli, N. J., Hsieh, T. C., Sander, E. L., Ma, K. H., Colwell, R. K., Ellison, A. M (2014). Rarefaction and extrapolation with Hill numbers: A framework for sampling and estimation in species diversity studies.  <em>Ecological Monographs</em>, 84(1): 45-67.
</p>
<p>Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Tsallis">Tsallis</a></code>, <code><a href="#topic+expq">expq</a></code>, <code><a href="#topic+AbdVector">AbdVector</a></code>, <code><a href="#topic+ProbaVector">ProbaVector</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Species probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ns)
# Whittaker plot
plot(Ns)
# Calculate diversity of order 1, i.e. Shannon's diversity
Diversity(Ps, q=1)
# Calculate it with estimation bias correction (asymptotic estimator)
Diversity(Ns, q=1)
# Extrapolate it up to 99.9% sample coverage (close to the asymptotic estimator)
Diversity(Ns, q=1, Level=0.999)
# Rarefy it to half the sample size
Diversity(Ns, q=1, Level=sum(Ns)/2)
</code></pre>

<hr>
<h2 id='DivEst'>
Diversity Estimation of a metacommunity
</h2><span id='topic+DivEst'></span><span id='topic+is.DivEst'></span><span id='topic+plot.DivEst'></span><span id='topic+autoplot.DivEst'></span><span id='topic+summary.DivEst'></span>

<h3>Description</h3>

<p>Estimates diversity of a metacommunity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DivEst(q = 0, MC, Biased = TRUE, Correction = "Best", Tree = NULL, 
  Normalize = TRUE, Z = NULL, Simulations = 100, 
  ShowProgressBar = TRUE, CheckArguments = TRUE)
is.DivEst(x)
## S3 method for class 'DivEst'
plot(x, ..., main = NULL, Which = "All",
  Quantiles = c(0.025, 0.975), colValue = "red", lwdValue = 2, ltyValue = 2,
  colQuantiles = "black", lwdQuantiles = 1, ltyQuantiles = 2)
## S3 method for class 'DivEst'
autoplot(object, ..., main = NULL, Which = "All",
  labels = NULL, font.label = list(size=11, face="plain"),
          Quantiles = c(0.025, 0.975), colValue = "red", 
          colQuantiles = "black", ltyQuantiles = 2)
## S3 method for class 'DivEst'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DivEst_+3A_q">q</code></td>
<td>

<p>A number: the order of diversity.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_mc">MC</code></td>
<td>

<p>A <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> object.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_biased">Biased</code></td>
<td>

<p>Logical; if <code>FALSE</code>, a bias correction is appplied.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections. The correction must be accepted by <code><a href="#topic+DivPart">DivPart</a></code>. <code>"Best"</code> is the default value.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_tree">Tree</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="ape.html#topic+phylo">phylo</a></code>, <code><a href="ade4.html#topic+phylog">phylog</a></code> or <code><a href="#topic+PPtree">PPtree</a></code>. The tree must be ultrametric.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_normalize">Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), diversity is not affected by the height of the tree..<br />
If <code>FALSE</code>, diversity is proportional to the height of the tree.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_z">Z</code></td>
<td>

<p>A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_simulations">Simulations</code></td>
<td>

<p>The number of simulations to build confidence intervals.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_showprogressbar">ShowProgressBar</code></td>
<td>

<p>If <code>TRUE</code> (default), a progress bar is shown.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_x">x</code></td>
<td>

<p>An object to be tested or plotted.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_main">main</code></td>
<td>

<p>The title of the plot.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_which">Which</code></td>
<td>

<p>May be <code>"Alpha"</code>, <code>"Beta"</code> or <code>"Gamma"</code> to respectively plot the metacommunity's alpha, beta or gamma diversity. If <code>"All"</code> (default), all three plots are shown.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_labels">labels</code></td>
<td>

<p>Vector of labels to be added to multiple plots. <code>"auto"</code> is the same as <code>c("a", "b", "c", "d)"</code>.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_font.label">font.label</code></td>
<td>

<p>A list of arguments to customize labels. See <code><a href="ggpubr.html#topic+ggarrange">ggarrange</a></code>.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_object">object</code></td>
<td>

<p>A <code>MCdiversity</code> object to be summarized or plotted.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_quantiles">Quantiles</code></td>
<td>

<p>A vector containing the quantiles of interest.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_colvalue">colValue</code></td>
<td>

<p>The color of the line representing the real value on the plot.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_lwdvalue">lwdValue</code></td>
<td>

<p>The width of the line representing the real value on the plot.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_ltyvalue">ltyValue</code></td>
<td>

<p>The line type of the line representing the real value on the plot.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_colquantiles">colQuantiles</code></td>
<td>

<p>The color of the lines representing the quantiles on the plot.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_lwdquantiles">lwdQuantiles</code></td>
<td>

<p>The width of the lines representing the quantiles on the plot.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_ltyquantiles">ltyQuantiles</code></td>
<td>

<p>The line type of the lines representing the quantiles on the plot.
</p>
</td></tr>
<tr><td><code id="DivEst_+3A_...">...</code></td>
<td>

<p>Additional arguments to be passed to the generic methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Divest</code> estimates the diversity of the metacommunity and partitions it into alpha and beta components.
</p>
<p>If <code>Tree</code> is provided, the phylogenetic diversity is calculated else if <code>Z</code> is not <code>NULL</code>, then similarity-based entropy is calculated.
</p>
<p>Bootstrap confidence intervals are calculated by drawing simulated communities from a multinomial distribution following the observed frequencies (Marcon et al, 2012; 2014).
</p>


<h3>Value</h3>

<p>A <code>Divest</code> object which is a <code><a href="#topic+DivPart">DivPart</a></code> object with an additional item in its list:
</p>
<table>
<tr><td><code>SimulatedDiversity</code></td>
<td>
<p>A matrix containing the simulated values of alpha, beta and gamma diversity.</p>
</td></tr>
</table>
<p><code>Divest</code> objects can be summarized and plotted.
</p>


<h3>Author(s)</h3>

<p>Eric Marcon &lt;Eric.Marcon@agroparistech.fr&gt;, Bruno Herault &lt;Bruno.Herault@cirad.fr&gt;
</p>


<h3>References</h3>

<p>Marcon, E., Herault, B., Baraloto, C. and Lang, G. (2012). The Decomposition of Shannon's Entropy and a Confidence Interval for Beta Diversity. <em>Oikos</em> 121(4): 516-522.
</p>
<p>Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DivPart">DivPart</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Estimate Shannon diversity.
Estimation &lt;- DivEst(q = 1, Paracou618.MC, Biased = FALSE, Correction = "UnveilJ", 
Simulations = 20)
plot(Estimation)
summary(Estimation)
</code></pre>

<hr>
<h2 id='DivPart'>
Diversity Partition of a metacommunity
</h2><span id='topic+DivPart'></span><span id='topic+is.DivPart'></span><span id='topic+plot.DivPart'></span><span id='topic+autoplot.DivPart'></span><span id='topic+summary.DivPart'></span>

<h3>Description</h3>

<p>Partitions the diversity of a metacommunity into alpha and beta components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DivPart(q = 1, MC, Biased = TRUE, Correction = "Best", Tree = NULL,
  Normalize = TRUE, Z = NULL, CheckArguments = TRUE)
is.DivPart(x)
## S3 method for class 'DivPart'
plot(x, ...)
## S3 method for class 'DivPart'
autoplot(object, col = ggplot2::GeomRect$default_aes$fill, 
  border = ggplot2::GeomRect$default_aes$colour, ...)
## S3 method for class 'DivPart'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DivPart_+3A_q">q</code></td>
<td>

<p>A number: the order of diversity. Default is 1.
</p>
</td></tr>
<tr><td><code id="DivPart_+3A_mc">MC</code></td>
<td>

<p>A <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> object.
</p>
</td></tr>
<tr><td><code id="DivPart_+3A_biased">Biased</code></td>
<td>

<p>Logical; if <code>FALSE</code>, a bias correction is appplied.
</p>
</td></tr>
<tr><td><code id="DivPart_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections.
</p>
<p>The correction must be accepted by <code><a href="#topic+AlphaEntropy">AlphaEntropy</a></code>, <code><a href="#topic+BetaEntropy">BetaEntropy</a></code> and <code><a href="#topic+GammaEntropy">GammaEntropy</a></code>. <code>"Best"</code> is the default value.
</p>
</td></tr>
<tr><td><code id="DivPart_+3A_tree">Tree</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="ape.html#topic+phylo">phylo</a></code>, <code><a href="ade4.html#topic+phylog">phylog</a></code> or <code><a href="#topic+PPtree">PPtree</a></code>. The tree must be ultrametric.
</p>
</td></tr>
<tr><td><code id="DivPart_+3A_normalize">Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), diversity is not affected by the height of the tree.<br />
If <code>FALSE</code>, diversity is proportional to the height of the tree.
</p>
</td></tr>
<tr><td><code id="DivPart_+3A_z">Z</code></td>
<td>

<p>A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</p>
</td></tr>
<tr><td><code id="DivPart_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
<tr><td><code id="DivPart_+3A_x">x</code></td>
<td>

<p>An object to be tested or plotted.
</p>
</td></tr>
<tr><td><code id="DivPart_+3A_object">object</code></td>
<td>

<p>A <code>MCdiversity</code> object to be summarized or plotted.
</p>
</td></tr>
<tr><td><code id="DivPart_+3A_col">col</code></td>
<td>

<p>The color used to fill the bars. See &quot;Color Specification&quot; in <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
<tr><td><code id="DivPart_+3A_border">border</code></td>
<td>

<p>The color of the borders around the bars. See <code><a href="graphics.html#topic+rect">rect</a></code>.
</p>
</td></tr>
<tr><td><code id="DivPart_+3A_...">...</code></td>
<td>

<p>Additional arguments to be passed to the generic methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>DivPart</code> partitions the diversity of the metacommunity into alpha and beta components. It supports estimation-bias correction.
</p>
<p>If <code>Tree</code> is provided, the phylogenetic diversity is calculated else if <code>Z</code> is not <code>NULL</code>, then similarity-based entropy is calculated.
</p>
<p>Beta diversity/entropy is calculated from Gamma and Alpha when bias correction is required, so community values are not available.
</p>


<h3>Value</h3>

<p>A <code>DivPart</code> object. It is a list:
</p>
<table>
<tr><td><code>MetaCommunity</code></td>
<td>
<p>The name of the <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> object containing inventory data.</p>
</td></tr>
<tr><td><code>Order</code></td>
<td>
<p>The value of <code>q</code>.</p>
</td></tr>
<tr><td><code>Biased</code></td>
<td>
<p>Logical. If <code>FALSE</code>, bias corrected values of diversity have been computed.</p>
</td></tr>
<tr><td><code>Correction</code></td>
<td>
<p>The estimation bias correction used to calculate diversity.</p>
</td></tr>
<tr><td><code>Method</code></td>
<td>
<p>The method used to calculate entropy (&quot;HCDT&quot;, &quot;Similarity-based&quot;).</p>
</td></tr>
<tr><td><code>Tree</code></td>
<td>
<p>The phylogenetic or functional tree used to calculate phylodiversity.</p>
</td></tr>
<tr><td><code>Normalized</code></td>
<td>
<p>Logical. Indicates whether phylodiversity is normalized or proportional to the height of the tree.</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p>The matrix used to calculate similarity-based entropy.</p>
</td></tr>
<tr><td><code>TotalAlphaDiversity</code></td>
<td>
<p>The alpha diversity of communities.</p>
</td></tr>
<tr><td><code>TotalBetaDiversity</code></td>
<td>
<p>The beta diversity of communities.</p>
</td></tr>
<tr><td><code>GammaDiversity</code></td>
<td>
<p>The gamma diversity of the metacommunity.</p>
</td></tr>
<tr><td><code>CommunityAlphaDiversities</code></td>
<td>
<p>A vector containing the alpha diversity of each community.</p>
</td></tr>
<tr><td><code>TotalAlphaEntropy</code></td>
<td>
<p>The alpha entropy of communities.</p>
</td></tr>
<tr><td><code>TotalBetaEntropy</code></td>
<td>
<p>The beta entropy of communities.</p>
</td></tr>
<tr><td><code>GammaEntropy</code></td>
<td>
<p>The gamma entropy of the metacommunity.</p>
</td></tr>
<tr><td><code>CommunityAlphaEntropies</code></td>
<td>
<p>A vector containing the alpha entropy of each community.</p>
</td></tr>
</table>
<p><code>DivPart</code> objects can be summarized and plotted.
</p>


<h3>Author(s)</h3>

<p>Eric Marcon &lt;Eric.Marcon@agroparistech.fr&gt;, Bruno Herault &lt;Bruno.Herault@cirad.fr&gt;
</p>


<h3>References</h3>

<p>Marcon, E., Herault, B., Baraloto, C. and Lang, G. (2012). The Decomposition of Shannon's Entropy and a Confidence Interval for Beta Diversity. <em>Oikos</em> 121(4): 516-522.
</p>
<p>Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p>Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DivProfile">DivProfile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Estimate Shannon diversity.
summary(DivPart(q = 1, Paracou618.MC, Biased = FALSE) -&gt; dp)
plot(dp)
</code></pre>

<hr>
<h2 id='DivProfile'>
Diversity Profile of a metacommunity
</h2><span id='topic+DivProfile'></span><span id='topic+is.DivProfile'></span><span id='topic+plot.DivProfile'></span><span id='topic+autoplot.DivProfile'></span><span id='topic+summary.DivProfile'></span>

<h3>Description</h3>

<p>Calculate the diversity profiles (alpha, beta, gamma) of a metacommunity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DivProfile(q.seq = seq(0, 2, 0.1), MC, Biased = TRUE, Correction = "Best", 
  Tree = NULL, Normalize = TRUE, Z = NULL, 
  NumberOfSimulations = 0, Alpha = 0.05, 
  ShowProgressBar = TRUE, CheckArguments = TRUE)
is.DivProfile(x)
## S3 method for class 'DivProfile'
plot(x, ..., main = NULL, xlab = "Order of Diversity",
  ylab = NULL, Which = "All", 
  LineWidth = 2, ShadeColor = "grey75", BorderColor = "red")
## S3 method for class 'DivProfile'
autoplot(object, ..., main = NULL, xlab = "Order of Diversity",
  ylab = NULL, Which = "All", ShadeColor = "grey75", alpha = 0.3, BorderColor = "red", 
  labels = NULL, font.label = list(size=11, face="plain"),
  col = ggplot2::GeomLine$default_aes$colour,
  lty = ggplot2::GeomLine$default_aes$linetype,
  lwd = ggplot2::GeomLine$default_aes$size)
## S3 method for class 'DivProfile'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DivProfile_+3A_q.seq">q.seq</code></td>
<td>

<p>A numeric vector.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_mc">MC</code></td>
<td>

<p>A <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> object.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_biased">Biased</code></td>
<td>

<p>Logical; if <code>FALSE</code>, a bias correction is appplied.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections.
</p>
<p>The correction must be accepted by <code><a href="#topic+AlphaEntropy">AlphaEntropy</a></code>, <code><a href="#topic+BetaEntropy">BetaEntropy</a></code> and <code><a href="#topic+GammaEntropy">GammaEntropy</a></code>. <code>"Best"</code> is the default value.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_tree">Tree</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="ape.html#topic+phylo">phylo</a></code>, <code><a href="ade4.html#topic+phylog">phylog</a></code> or <code><a href="#topic+PPtree">PPtree</a></code>. The tree must be ultrametric.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_normalize">Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), diversity is not affected by the height of the tree.<br />
If <code>FALSE</code>, diversity is proportional to the height of the tree.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_z">Z</code></td>
<td>

<p>A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_numberofsimulations">NumberOfSimulations</code></td>
<td>

<p>The number of simulations to run, 0 by default.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_alpha">Alpha</code></td>
<td>

<p>The risk level, 5% by default.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_showprogressbar">ShowProgressBar</code></td>
<td>

<p>If <code>TRUE</code> (default), a progress bar is shown.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_x">x</code></td>
<td>

<p>An object to be tested or plotted.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_main">main</code></td>
<td>

<p>The main title of the plot. Ignored if <code>Which = "All"</code>.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_xlab">xlab</code></td>
<td>

<p>The x axis label of the plots.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_ylab">ylab</code></td>
<td>

<p>The y axis label of the plot. Ignored if <code>Which = "All"</code>.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_which">Which</code></td>
<td>

<p>May be <code>"Communities"</code>, <code>"Alpha"</code>, <code>"Beta"</code> or <code>"Gamma"</code> to respectively plot the alpha diversity of communities or the metacommunity's alpha, beta or gamma diversity. If <code>"All"</code> (default), all four plots are shown.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_linewidth">LineWidth</code></td>
<td>

<p>The width of the line that represents the actual profile.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_shadecolor">ShadeColor</code></td>
<td>

<p>The color of the shaded confidence envelope.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_bordercolor">BorderColor</code></td>
<td>

<p>The color of the bounds of the confidence envelope.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_alpha">alpha</code></td>
<td>

<p>Opacity of the confidence enveloppe, between 0 and 1.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_labels">labels</code></td>
<td>

<p>Vector of labels to be added to multiple plots. <code>"auto"</code> is the same as <code>c("a", "b", "c", "d)"</code>.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_font.label">font.label</code></td>
<td>

<p>A list of arguments to customize labels. See <code><a href="ggpubr.html#topic+ggarrange">ggarrange</a></code>.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_col">col</code></td>
<td>

<p>The color of the geom objects. See &quot;Color Specification&quot; in <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_lty">lty</code></td>
<td>

<p>The type of the lines. See <code><a href="graphics.html#topic+lines">lines</a></code>.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_lwd">lwd</code></td>
<td>

<p>The width of the lines. See <code><a href="graphics.html#topic+lines">lines</a></code>.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_object">object</code></td>
<td>

<p>A <code>MCdiversity</code> object to be summarized or plotted.
</p>
</td></tr>
<tr><td><code id="DivProfile_+3A_...">...</code></td>
<td>

<p>Additional arguments to be passed to the generic methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>Tree</code> is provided, the phylogenetic diversity is calculated.
</p>
<p><code>DivPart</code> partitions the diversity of the metacommunity into alpha and beta components. It supports estimation-bias correction.
</p>
<p>If <code>Tree</code> is provided, the phylogenetic diversity is calculated else if <code>Z</code> is not <code>NULL</code>, then similarity-based entropy is calculated.
</p>
<p>Beta diversity/entropy is calculated from Gamma and Alpha when bias correction is required, so community values are not available.
</p>
<p>If <code>NumberOfSimulations</code> is greater than 0, a bootstrap confidence interval is produced by simulating communities from a multinomial distribution following the observed frequencies (Marcon et al, 2012; 2014) and calculating their profiles.
</p>


<h3>Value</h3>

<p>A <code>DivProfile</code> object. It is a list:
</p>
<table>
<tr><td><code>MetaCommunity</code></td>
<td>
<p>The name of the <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> object containing inventory data.</p>
</td></tr>
<tr><td><code>Order</code></td>
<td>
<p>A vector containing the values of <code>q</code>.</p>
</td></tr>
<tr><td><code>Biased</code></td>
<td>
<p>Logical. If <code>FALSE</code>, bias corrected values of diversity have been computed.</p>
</td></tr>
<tr><td><code>Correction</code></td>
<td>
<p>The estimation bias correction used to calculate diversity. Usually a string, but it may be a list if different corrections have been used in the estimation of phylodiversity.</p>
</td></tr>
<tr><td><code>Method</code></td>
<td>
<p>The method used to calculate entropy (&quot;HCDT&quot;, &quot;Similarity-based&quot;).</p>
</td></tr>
<tr><td><code>Tree</code></td>
<td>
<p>The phylogenetic or functional tree used to calculate phylodiversity.</p>
</td></tr>
<tr><td><code>Normalized</code></td>
<td>
<p>Logical. Indicates whether phylodiversity is normalized or proportional to the height of the tree.</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p>The matrix used to calculate similarity-based entropy.</p>
</td></tr>
<tr><td><code>CommunityAlphaDiversities</code></td>
<td>
<p>A matrix containing the alpha diversity of each community.</p>
</td></tr>
<tr><td><code>TotalAlphaDiversity</code></td>
<td>
<p>A vector containing the alpha diversity of communities for each order.</p>
</td></tr>
<tr><td><code>BetaDiversity</code></td>
<td>
<p>A vector containing the beta diversity of communities for each order.</p>
</td></tr>
<tr><td><code>GammaDiversity</code></td>
<td>
<p>A vector containing the gamma diversity of the metacommunity for each order.</p>
</td></tr>
<tr><td><code>CommunityAlphaEntropies</code></td>
<td>
<p>A matrix containing the alpha entropy of each community.</p>
</td></tr>
<tr><td><code>TotalAlphaEntropy</code></td>
<td>
<p>A vector containing the alpha entropy of communities for each order.</p>
</td></tr>
<tr><td><code>BetaEntropy</code></td>
<td>
<p>A vector containing the beta entropy of communities for each order.</p>
</td></tr>
<tr><td><code>GammaEntropy</code></td>
<td>
<p>A vector containing the gamma entropy of the metacommunity for each order.</p>
</td></tr>
<tr><td><code>Confidence envelopes</code></td>
<td>
<p>Total Alpha, Beta and Gamma Entropy and Diversity may come with a confidence envelope whose value is stored in twelve more vectors named suffixed Low or High, such as <code>GammaEntropyLow</code></p>
</td></tr>
</table>
<p><code>DivProfile</code> objects can be summarized and plotted.
</p>


<h3>Author(s)</h3>

<p>Eric Marcon &lt;Eric.Marcon@agroparistech.fr&gt;, Bruno Herault &lt;Bruno.Herault@cirad.fr&gt;
</p>


<h3>References</h3>

<p>Marcon, E., Herault, B., Baraloto, C. and Lang, G. (2012). The Decomposition of Shannon's Entropy and a Confidence Interval for Beta Diversity. <em>Oikos</em> 121(4): 516-522.
</p>
<p>Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DivPart">DivPart</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Estimate diversity.
Profile &lt;- DivProfile(q.seq = seq(0, 2, 0.1), Paracou618.MC, Biased = FALSE)
plot(Profile)
autoplot(Profile)
summary(Profile)
</code></pre>

<hr>
<h2 id='Dqz'>
Similarity-based diversity of a community
</h2><span id='topic+Dqz'></span><span id='topic+bcDqz'></span><span id='topic+Dqz.ProbaVector'></span><span id='topic+Dqz.AbdVector'></span><span id='topic+Dqz.integer'></span><span id='topic+Dqz.numeric'></span>

<h3>Description</h3>

<p>Calculates the diversity of order <code class="reqn">q</code> of a probability vector according to a similarity matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Dqz(NorP, q = 1, Z = diag(length(NorP)), ...)
bcDqz(Ns, q = 1, Z = diag(length(Ns)), Correction = "Best", CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
Dqz(NorP, q = 1, Z = diag(length(NorP)), ..., 
  CheckArguments = TRUE, Ps = NULL)
## S3 method for class 'AbdVector'
Dqz(NorP, q = 1, Z = diag(length(NorP)), Correction = "Best", ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'integer'
Dqz(NorP, q = 1, Z = diag(length(NorP)), Correction = "Best", ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'numeric'
Dqz(NorP, q = 1, Z = diag(length(NorP)), Correction = "Best", ..., 
  CheckArguments = TRUE, Ps = NULL, Ns = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Dqz_+3A_ps">Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td></tr>
<tr><td><code id="Dqz_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td></tr>
<tr><td><code id="Dqz_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities.
</p>
</td></tr>
<tr><td><code id="Dqz_+3A_q">q</code></td>
<td>

<p>A number: the order of diversity. Default is 1.
</p>
</td></tr>
<tr><td><code id="Dqz_+3A_z">Z</code></td>
<td>

<p>A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1. Default is the identity matrix to calculate neutral diversity.
</p>
</td></tr>
<tr><td><code id="Dqz_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections: <code>"None"</code> (no correction), <code>"HorvitzThomson"</code>, <code>"MarconZhang"</code> or <code>"Best"</code>, the default value. The <code>"MarconZhang"</code> correction assumes a similarity matrix.
</p>
</td></tr>
<tr><td><code id="Dqz_+3A_...">...</code></td>
<td>

<p>Additional arguments. Unused.
</p>
</td></tr>
<tr><td><code id="Dqz_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Diversity is calculated following Leinster and Cobbold (2012): it is the reciprocal of the (generalized) average (of order <code>q</code>) of the community species ordinariness.
</p>
<p>A similarity matrix is used (as for <code><a href="#topic+Dqz">Dqz</a></code>), not a distance matrix as in Ricotta and Szeidl (2006). See the example.
</p>
<p>Bias correction requires the number of individuals. Use <code>bcHqz</code> and choose the <code>Correction</code>.
Correction techniques are from Marcon <em>et al.</em> (2014).
</p>
<p>Currently, the <code>"Best"</code> correction is the max value of <code>"HorvitzThomson"</code> and <code>"MarconZhang"</code>.
</p>
<p>The functions are designed to be used as simply as possible. <code>Dqz</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcDqz</code> is called. Explicit calls to <code>bcDqz</code> (with bias correction) or to <code>Dqz.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>


<h3>Value</h3>

<p>A named number equal to the calculated diversity. The name is that of the bias correction used.
</p>


<h3>References</h3>

<p>Leinster, T. and Cobbold, C. (2012). Measuring diversity: the importance of species similarity. <em>Ecology</em> 93(3): 477-489.
</p>
<p>Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Hqz">Hqz</a></code>, <code><a href="#topic+PhyloDiversity">PhyloDiversity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Prepare the similarity matrix
DistanceMatrix &lt;- as.matrix(Paracou618.dist)
# Similarity can be 1 minus normalized distances between species
Z &lt;- 1 - DistanceMatrix/max(DistanceMatrix)
# Calculate diversity of order 2
Dqz(Paracou618.MC$Ns, 2, Z)
</code></pre>

<hr>
<h2 id='EightSpAbundance'>
Abundances of 8 species to run examples.
</h2><span id='topic+EightSpAbundance'></span>

<h3>Description</h3>

<p>This dataset is a light-weight example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Paracou618)
</code></pre>


<h3>Format</h3>

<p>A named vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paracou618)
EightSpAbundance
</code></pre>

<hr>
<h2 id='EightSpTree'>
Functional tree with 8 species.
</h2><span id='topic+EightSpTree'></span>

<h3>Description</h3>

<p>This dataset is a leight-weight example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Paracou618)
</code></pre>


<h3>Format</h3>

<p>An object of class <code><a href="ade4.html#topic+phylog">phylog</a></code> containing a functional tree.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paracou618)
# Preprocess the tree to be able to plot it 
# without loading ade4 package
plot(Preprocess.Tree(EightSpTree), hang=-0.01)
</code></pre>

<hr>
<h2 id='Enq'>  
Grassberger's expectation of n^q
</h2><span id='topic+Enq'></span>

<h3>Description</h3>

<p>Expected value of <code class="reqn">n^q</code> when <code class="reqn">n</code> follows a Poisson law.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Enq(n, q)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Enq_+3A_n">n</code></td>
<td>

<p>A positive integer vector.
</p>
</td></tr>
<tr><td><code id="Enq_+3A_q">q</code></td>
<td>

<p>A positive number.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The expectation of <code class="reqn">n^q</code> when <code class="reqn">n</code> follows a Poisson ditribution has been derived by Grassberger (1988).
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>n</code> containing the transformed values.
</p>


<h3>Note</h3>

<p>The function is computed using the <code><a href="base.html#topic+beta">beta</a></code>.function.
</p>
<p>Its value is 0 for <code class="reqn">n-q+1&lt;0</code>.
</p>


<h3>References</h3>

<p>Grassberger, P. (1988). Finite sample corrections to entropy and dimension estimates. Physics Letters A 128(6-7): 369-373.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compare
n &lt;- c(2,3)
Enq(n, q=2)
# with
n^2

# Result is 1
Enq(n, q=0)
# Result is 0
Enq(n, q=5)
</code></pre>

<hr>
<h2 id='entropart-package'>
Entropy Partitioning to Measure Diversity
</h2><span id='topic+entropart-package'></span><span id='topic+entropart'></span>

<h3>Description</h3>

<p>Functions to calculate alpha, beta and gamma diversity of communities, including phylogenetic and functional diversity.
</p>
<p>Estimation-bias corrections are available.
</p>


<h3>Details</h3>

<p>In the entropart package, individuals of different &quot;species&quot; are counted in several &quot;communities&quot; which may (or not) be agregated to define a &quot;metacommunity&quot;. In the metacommunity, the probability to find a species in the weighted average of probabilities in communities. This is a naming convention, which may correspond to plots in a forest inventory or any data organized the same way.
</p>
<p>Basic functions allow computing diversity of a community. Data is simply a vector of probabilities (summing up to 1) or of abundances (integer values that are numbers of individuals). Calculate entropy with functions such as <code><a href="#topic+Tsallis">Tsallis</a></code>, <code><a href="#topic+Shannon">Shannon</a></code>, <code><a href="#topic+Simpson">Simpson</a></code>, <code><a href="#topic+Hurlbert">Hurlbert</a></code> or <code><a href="#topic+GenSimpson">GenSimpson</a></code> and explicit diversity (i.e. effective number of species) with <code><a href="#topic+Diversity">Diversity</a></code> and others. By default, the best available estimator of diversity will be used, according to the data.
</p>
<p>Communities can be simulated by <code><a href="#topic+rCommunity">rCommunity</a></code>, explicitely declared as a species distribution (<code><a href="#topic+as.AbdVector">as.AbdVector</a></code> or <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>), and plotted.
</p>
<p>Phylogenetic entropy and diversity can be calculated if a phylogenetic (or functional), ultrametric tree is provided. See <code><a href="#topic+PhyloEntropy">PhyloEntropy</a></code>, <code><a href="#topic+Rao">Rao</a></code> for examples of entropy and <code><a href="#topic+PhyloDiversity">PhyloDiversity</a></code> to calculate phylodiversity, with the state-of-the-art estimation-bias correction. Similarity-based diversity is calculated with <code><a href="#topic+Dqz">Dqz</a></code>, based on a similarity matrix.
</p>
<p>The simplest way to import data is to organize it into two text files. The first file should contain abundance data: the first column named <code>Species</code> for species names, and a column for each community.
</p>
<p>The second file should contain the community weights in two columns. The first one, named <code>Communities</code> should contain their names and the second one, named <code>Weights</code>, their weights.
</p>
<p>Files can be read and data imported by code such as:
</p>
<pre>
Abundances &lt;- read.csv(file="Abundances.csv", row.names = 1)
Weights &lt;- read.csv(file="Weights.csv")
MC &lt;- MetaCommunity(Abundances, Weights)
</pre>
<p>The last line of the code calls the <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> function to create an object that will be used by all metacommunity functions, such as <code><a href="#topic+DivPart">DivPart</a></code> (to partition diversity), <code><a href="#topic+DivEst">DivEst</a></code> (to partition diversity and calculate confidence interval of its estimation) or <code><a href="#topic+DivProfile">DivProfile</a></code> (to compute diversity profiles).
</p>
<p>A full documentation is available in the vignette. Type: <code>vignette("entropart")</code>. A quick introuction is in <code>vignette("introduction", "entropart")</code>.
</p>


<h3>Author(s)</h3>

<p>Eric Marcon,
Bruno Herault
</p>


<h3>References</h3>

<p>Grabchak, M., Marcon, E., Lang, G., and Zhang, Z. (2017). The Generalized Simpson's Entropy is a Measure of Biodiversity. <em>Plos One</em>, 12(3): e0173305.
</p>
<p>Marcon, E. (2015) Practical Estimation of Diversity from Abundance Data. <em>HAL</em> 01212435: 1-27.
</p>
<p>Marcon, E. and Herault, B. (2015). entropart: An R Package to Measure and Partition Diversity. <em>Journal of Statistical Software</em>, 67(8): 1-26.
</p>
<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p>Marcon, E., Herault, B., Baraloto, C. and Lang, G. (2012). The Decomposition of Shannon's Entropy and a Confidence Interval for Beta Diversity. <em>Oikos</em> 121(4): 516-522.
</p>
<p>Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p>Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>

<hr>
<h2 id='EntropyCI'>
Entropy of Monte-Carlo simulated communities
</h2><span id='topic+EntropyCI'></span>

<h3>Description</h3>

<p>Resamples a community by Monte-Carlo simulations of a multinomial distribution and returns a vector of entropy values to calculate confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EntropyCI(FUN, Simulations = 100, Ns, BootstrapMethod = "Chao2015", 
    ShowProgressBar = TRUE, ..., CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EntropyCI_+3A_fun">FUN</code></td>
<td>

<p>The entropy function to be applied to each simulated community. May be any entropy function accepting a vector of species abundances, such as <code><a href="#topic+bcTsallis">bcTsallis</a></code>, <code><a href="#topic+bcShannon">bcShannon</a></code>, <code><a href="#topic+bcSimpson">bcSimpson</a></code> or <code><a href="#topic+bcPhyloEntropy">bcPhyloEntropy</a></code>.
</p>
</td></tr>
<tr><td><code id="EntropyCI_+3A_simulations">Simulations</code></td>
<td>

<p>The number of simulations to build confidence intervals.
</p>
</td></tr>
<tr><td><code id="EntropyCI_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td></tr>
<tr><td><code id="EntropyCI_+3A_bootstrapmethod">BootstrapMethod</code></td>
<td>

<p>The method used to obtain the probabilities to generate bootstrapped communities from observed abundances. See <code><a href="#topic+rCommunity">rCommunity</a></code>.
</p>
</td></tr>
<tr><td><code id="EntropyCI_+3A_...">...</code></td>
<td>

<p>Additional arguments to be passed to <code>FUN</code>.
</p>
</td></tr>
<tr><td><code id="EntropyCI_+3A_showprogressbar">ShowProgressBar</code></td>
<td>

<p>If <code>TRUE</code> (default), a progress bar is shown.
</p>
</td></tr>
<tr><td><code id="EntropyCI_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used to obtain the distribution of entropy and eventually calculate confidence intervals. It draws simulated communities according to a multinomial distribution with the same number of individuals and probabilities as the actual community. It calculates the entropy of each simulated community. Last, it recenters the distribution of entropy values arounf the actual value of entropy according to Marcon <em>et al.</em> (2012): the estimation bias of simulated communities entropy can not be corrected analytically, but it does not affect the distribution shape.
</p>
<p>Diversity can not be recentered this way so diversity function should not be used. Unexpected results will be obtained if inappropriate functions are used.
</p>


<h3>Value</h3>

<p>A numeric vector containing the entropy value of each simulated community.
</p>


<h3>References</h3>

<p>Marcon, E., Herault, B., Baraloto, C. and Lang, G. (2012). The Decomposition of Shannon's Entropy and a Confidence Interval for Beta Diversity. <em>Oikos</em> 121(4): 516-522.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Abundance (all estimators will include bias corrrection)
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
q &lt;- 1
# Estimate entropy and transform it into diversity
RealEst &lt;- expq(Tsallis(Ns, q), q)
# Transform the distribution of Tsallis entropy into diversity
SimulatedDiversity &lt;- expq(EntropyCI(Tsallis, Simulations=50, Ns, q=q), q)
# Figure
plot(density(SimulatedDiversity), col="black", lwd=2, main="", xlab ="Diversity")
abline(v=RealEst, col="red", lwd=2, lty=2)
abline(v=quantile(SimulatedDiversity, probs = 0.025), col="black", lwd=1, lty=3)
abline(v=quantile(SimulatedDiversity, probs = 0.975), col="black", lwd=1, lty=3)
legend("topright", c("Real value", "Confidence interval"), lty=c(2,3),
col=c("red", "black"), inset=0.01)
# Print results
cat("Estimated Diversity:", RealEst)
quantile(SimulatedDiversity, probs = c(0.025, 0.975))
</code></pre>

<hr>
<h2 id='expq'>
Exponential of order q
</h2><span id='topic+expq'></span><span id='topic+expq.CommunityProfile'></span>

<h3>Description</h3>

<p>Calculates the deformed exponential of order <code class="reqn">q</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expq(x, q)
expq.CommunityProfile(Profile)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expq_+3A_x">x</code></td>
<td>

<p>A numeric vector.
</p>
</td></tr>
<tr><td><code id="expq_+3A_profile">Profile</code></td>
<td>

<p>A <code><a href="#topic+CommunityProfile">CommunityProfile</a></code>.
</p>
</td></tr>
<tr><td><code id="expq_+3A_q">q</code></td>
<td>

<p>A number.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The deformed exponential is defined as <code class="reqn">(x(1-q)+1)^{\frac{1}{(1-q)}}</code>.
</p>
<p>For <code class="reqn">q&gt;1</code>, <code class="reqn">\ln_q{(+\infty)}=\frac{1}{(q-1)}</code> so <code class="reqn">\exp_q{(x)}</code> is not defined for <code class="reqn">x&gt;\frac{1}{(q-1)}</code>.
</p>
<p><code>expq.CommunityProfile</code> calculates the deformed exponential of a <code><a href="#topic+CommunityProfile">CommunityProfile</a></code>. Its <code>$x</code> item (the order of diversity) is kept unchanged whilst other items are set to their exponential of order <code>$x</code>. Thus, an entropy profile is transformed into a diversity profile.
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>x</code> containing the transformed values or a <code><a href="#topic+CommunityProfile">CommunityProfile</a></code>.
</p>


<h3>References</h3>

<p>Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p>Tsallis, C. (1994). What are the numbers that experiments provide? <em>Quimica Nova</em> 17(6): 468-471.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expq">expq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>curve(exp(x), -5, 0, lty=3)  
curve(expq(x, 2), -5, 0, lty=2, add=TRUE)
curve(expq(x, 3), -5, 0, lty=1, add=TRUE)
legend("topleft", legend = c("exp(x)", "exp2(x)", "exp3(x)"), lty = c(1, 2, 3), inset=0.02)
</code></pre>

<hr>
<h2 id='GammaDiversity'>
Reduced-bias gamma diversity of a metacommunity
</h2><span id='topic+GammaDiversity'></span>

<h3>Description</h3>

<p>Calculates the reduced-bias diversity of order <code class="reqn">q</code> of a metacommunity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GammaDiversity(MC, q = 1, Correction = "Best", Tree = NULL, Normalize = TRUE, 
  Z = NULL, CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GammaDiversity_+3A_mc">MC</code></td>
<td>

<p>A <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> object.
</p>
</td></tr>
<tr><td><code id="GammaDiversity_+3A_q">q</code></td>
<td>

<p>A number: the order of diversity. Default is 1.
</p>
</td></tr>
<tr><td><code id="GammaDiversity_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections accepted by <code><a href="#topic+AlphaEntropy">AlphaEntropy</a></code> or <code>"None"</code> or <code>"Best"</code>, the default value.
</p>
</td></tr>
<tr><td><code id="GammaDiversity_+3A_tree">Tree</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="ape.html#topic+phylo">phylo</a></code>, <code><a href="ade4.html#topic+phylog">phylog</a></code> or <code><a href="#topic+PPtree">PPtree</a></code>. The tree must be ultrametric.
</p>
</td></tr>
<tr><td><code id="GammaDiversity_+3A_normalize">Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), diversity is not affected by the height of the tree.<br />
If <code>FALSE</code>, diversity is proportional to the height of the tree.
</p>
</td></tr>
<tr><td><code id="GammaDiversity_+3A_z">Z</code></td>
<td>

<p>A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</p>
</td></tr>
<tr><td><code id="GammaDiversity_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Entropy is calculated by <code><a href="#topic+GammaEntropy">GammaEntropy</a></code> and transformed into diversity.
</p>


<h3>Value</h3>

<p>The metacommunity's gamma entropy.
</p>


<h3>References</h3>

<p>Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p>Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GammaEntropy">GammaEntropy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Calculate Simpson gamma diversity
GammaDiversity(Paracou618.MC, 2)
# Compare without correction
GammaDiversity(Paracou618.MC, 2, Correction = "None")
# Estimate phylogenetic Simpson gamma diversity
GammaDiversity(Paracou618.MC, 2, Tree = Paracou618.Taxonomy)   
</code></pre>

<hr>
<h2 id='GammaEntropy'>
Reduced-bias gamma entropy of a metacommunity
</h2><span id='topic+GammaEntropy'></span>

<h3>Description</h3>

<p>Calculates the reduced-bias Tsallis entropy of order <code class="reqn">q</code> of a metacommunity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GammaEntropy(MC, q = 1, Correction = "Best", Tree = NULL, Normalize = TRUE, 
  Z = NULL, PhyloDetails = FALSE, CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GammaEntropy_+3A_mc">MC</code></td>
<td>

<p>A <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> object.
</p>
</td></tr>
<tr><td><code id="GammaEntropy_+3A_q">q</code></td>
<td>

<p>A number: the order of entropy. Default is 1.
</p>
</td></tr>
<tr><td><code id="GammaEntropy_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections accepted by the bias-corrected entropy function (see details) or <code>"None"</code> or <code>"Best"</code>, the default value.
</p>
</td></tr>
<tr><td><code id="GammaEntropy_+3A_tree">Tree</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="ape.html#topic+phylo">phylo</a></code>, <code><a href="ade4.html#topic+phylog">phylog</a></code> or <code><a href="#topic+PPtree">PPtree</a></code>. The tree must be ultrametric.
</p>
</td></tr>
<tr><td><code id="GammaEntropy_+3A_normalize">Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), the entropy returned by the function is normalized by the height of the tree (it is the weighted average value of the entropy in each slice).<br />
If <code>FALSE</code>, it is the unnormalized weighted sum of the results.
</p>
</td></tr>
<tr><td><code id="GammaEntropy_+3A_z">Z</code></td>
<td>

<p>A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</p>
</td></tr>
<tr><td><code id="GammaEntropy_+3A_phylodetails">PhyloDetails</code></td>
<td>

<p>If <code>FALSE</code> (default), the function always returns a number. If <code>TRUE</code> and <code>Tree</code> is not Tree is not <code>NULL</code> then a <code><a href="#topic+PhyloValue">PhyloValue</a></code> object is returned with all details. That is used internally by <code><a href="#topic+DivPart">DivPart</a></code> to obtain the corrections used to estimate gamma entropy along the tree and apply them to the estimation of alpha diversity.
</p>
</td></tr>
<tr><td><code id="GammaEntropy_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>Tree</code> is not <code>NULL</code>, then phylogenetic entropy is calculated by <code><a href="#topic+bcPhyloEntropy">bcPhyloEntropy</a></code>.
</p>
<p>Else, if <code>Z</code> is not <code>NULL</code>, then similarity-based entropy is calculated by <code><a href="#topic+bcHqz">bcHqz</a></code>.
</p>
<p>Else, neutral entropy is calculated by <code><a href="#topic+bcTsallis">bcTsallis</a></code>.
</p>


<h3>Value</h3>

<p>A number equal to the calculated entropy.
</p>


<h3>References</h3>

<p>Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p>Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcTsallis">bcTsallis</a></code>, <code><a href="#topic+bcPhyloEntropy">bcPhyloEntropy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Calculate Simpson gamma entropy
GammaEntropy(Paracou618.MC, 2)
# Compare without correction
GammaEntropy(Paracou618.MC, 2, Correction = "None")
# Estimate phylogenetic Simpson gamma entropy
GammaEntropy(Paracou618.MC, 2, Tree = Paracou618.Taxonomy)   
</code></pre>

<hr>
<h2 id='GenSimpson'>
Generalized Simpson's Entropy and Diversity
</h2><span id='topic+GenSimpson'></span><span id='topic+bcGenSimpson'></span><span id='topic+GenSimpson.ProbaVector'></span><span id='topic+GenSimpson.AbdVector'></span><span id='topic+GenSimpson.integer'></span><span id='topic+GenSimpson.numeric'></span><span id='topic+GenSimpsonD'></span><span id='topic+bcGenSimpsonD'></span><span id='topic+GenSimpsonD.ProbaVector'></span><span id='topic+GenSimpsonD.AbdVector'></span><span id='topic+GenSimpsonD.integer'></span><span id='topic+GenSimpsonD.numeric'></span>

<h3>Description</h3>

<p>Calculates the Generalized Simpson's entropy of order <code class="reqn">r</code> of a probability or abundance vector, and its effective number of species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GenSimpson(NorP, r = 1, ...)
bcGenSimpson(Ns, r = 1, CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
GenSimpson(NorP, r = 1, ..., 
  CheckArguments = TRUE, Ps = NULL)
## S3 method for class 'AbdVector'
GenSimpson(NorP, r = 1, ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'integer'
GenSimpson(NorP, r = 1, ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'numeric'
GenSimpson(NorP, r = 1, ..., 
  CheckArguments = TRUE, Ps = NULL, Ns = NULL) 
GenSimpsonD(NorP, r = 1, ...)
bcGenSimpsonD(Ns, r = 1, CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
GenSimpsonD(NorP, r = 1, ...,
  CheckArguments = TRUE, Ps = NULL)
## S3 method for class 'AbdVector'
GenSimpsonD(NorP, r = 1, ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'integer'
GenSimpsonD(NorP, r = 1, ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'numeric'
GenSimpsonD(NorP, r = 1, ..., 
  CheckArguments = TRUE, Ps = NULL, Ns = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GenSimpson_+3A_ps">Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td></tr>
<tr><td><code id="GenSimpson_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td></tr>
<tr><td><code id="GenSimpson_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities.
</p>
</td></tr>
<tr><td><code id="GenSimpson_+3A_r">r</code></td>
<td>

<p>A number: the order of diversity. Default is 1 for Simpson's diversity.
</p>
</td></tr>
<tr><td><code id="GenSimpson_+3A_...">...</code></td>
<td>

<p>Additional arguments. Unused.
</p>
</td></tr>
<tr><td><code id="GenSimpson_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Generalized Simpson's Entropy (Zhang and Zhou, 2010) of order <code class="reqn">r</code> is, in the species accumulation curve, the probability for the individual sampled in rank <code class="reqn">r+1</code> to belong to a new species. It is a measure of diversity so long as <code class="reqn">r</code> is lower than the number of species (Grabchak <em>et al.</em>, 2016). 
</p>
<p>Bias correction requires the number of individuals. Use <code>bcGenSimpson</code>. It is limited to orders <code class="reqn">r</code> less than or equal to the number of individuals in the community.
</p>
<p>The effective number of species <code>GenSimpsonD</code> (explicit diversity) has been derived by Grabchak <em>et al.</em> (2016).
</p>
<p>The functions are designed to be used as simply as possible. <code>GenSimpson</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcGenSimpson</code> is called. Explicit calls to <code>bcGenSimpson</code> (with bias correction) or to <code>GenSimpson.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>


<h3>Value</h3>

<p>A named number equal to the calculated index or diversity. The name is either &quot;Biased&quot; or &quot;Unbiased&quot;, depending on the estimator used.
</p>


<h3>Note</h3>

<p>The unbiased estimator is calculated by the <code>GenSimp.z</code> function of the <code>EntropyEstimation</code> package. 
</p>


<h3>References</h3>

<p>Grabchak, M., Marcon, E., Lang, G., and Zhang, Z. (2017). The Generalized Simpson's Entropy is a Measure of Biodiversity. <em>Plos One</em>, 12(3): e0173305.
</p>
<p>Zhang Z. and Zhou J. (2010). Re-parameterization of multinomial distributions and diversity indices. <em>Journal of Statistical Planning and Inference</em> 140(7): 1731-1738.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Species probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ns)
# Whittaker plot
plot(Ns)

# Calculate GenSimpson entropy of order 1, equal to Simpson's index of diversity
GenSimpson(Ps, 1) 
# Calculate an unbiased estimator of GenSimpson diversity of order 100
GenSimpsonD(Ns, 100)
</code></pre>

<hr>
<h2 id='Hqz'>
Similarity-based entropy of a community
</h2><span id='topic+Hqz'></span><span id='topic+bcHqz'></span><span id='topic+Hqz.ProbaVector'></span><span id='topic+Hqz.AbdVector'></span><span id='topic+Hqz.integer'></span><span id='topic+Hqz.numeric'></span>

<h3>Description</h3>

<p>Calculates the entropy of order <code class="reqn">q</code> of a probability vector according to a similarity matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Hqz(NorP, q = 1, Z = diag(length(NorP)),  ...)
bcHqz(Ns, q = 1, Z = diag(length(Ns)), Correction = "Best", SampleCoverage = NULL, 
  CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
Hqz(NorP, q = 1, Z = diag(length(NorP)), 
  ..., CheckArguments = TRUE, Ps = NULL)
## S3 method for class 'AbdVector'
Hqz(NorP, q = 1, Z = diag(length(NorP)), Correction = "Best",
  ..., CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'integer'
Hqz(NorP, q = 1, Z = diag(length(NorP)), Correction = "Best", 
  ..., CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'numeric'
Hqz(NorP, q = 1, Z = diag(length(NorP)), Correction = "Best", 
  ..., CheckArguments = TRUE, Ps = NULL, Ns = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Hqz_+3A_ps">Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td></tr>
<tr><td><code id="Hqz_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td></tr>
<tr><td><code id="Hqz_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities.
</p>
</td></tr>
<tr><td><code id="Hqz_+3A_q">q</code></td>
<td>

<p>A number: the order of entropy. Default is 1.
</p>
</td></tr>
<tr><td><code id="Hqz_+3A_z">Z</code></td>
<td>

<p>A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1. Default is the identity matrix to calculate neutral entropy.
</p>
</td></tr>
<tr><td><code id="Hqz_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections: <code>"None"</code> (no correction), <code>"ChaoShen"</code>, <code>"MarconZhang"</code> or <code>"Best"</code>, the default value. The <code>"MarconZhang"</code> correction assumes a similarity matrix.
</p>
</td></tr>
<tr><td><code id="Hqz_+3A_samplecoverage">SampleCoverage</code></td>
<td>

<p>The sample coverage of <code>Ns</code> calculated elsewhere. Used to calculate the gamma diversity of meta-communities, see details. 
</p>
</td></tr>
<tr><td><code id="Hqz_+3A_...">...</code></td>
<td>

<p>Additional arguments. Unused.
</p>
</td></tr>
<tr><td><code id="Hqz_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Entropy is calculated following Leinster and Cobbold (2012) after Ricotta and Szeidl (2006): it is the entropy of order <code>q</code> of the community, using species ordinariness as the information function.
</p>
<p>A similarity matrix is used (as for <code><a href="#topic+Dqz">Dqz</a></code>), not a distance matrix as in Ricotta and Szeidl (2006). See the example.
</p>
<p>Bias correction requires the number of individuals. Use <code>bcHqz</code> and choose the <code>Correction</code>.
Correction techniques are from Marcon <em>et al.</em> (2014).
</p>
<p>Currently, the <code>"Best"</code> correction is the max value of <code>"ChaoShen"</code> and <code>"MarconZhang"</code>.
</p>
<p>The functions are designed to be used as simply as possible. <code>Hqz</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcHqz</code> is called. Explicit calls to <code>bcHqz</code> (with bias correction) or to <code>Hqz.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<p>The size of a metacommunity (see <code><a href="#topic+MetaCommunity">MetaCommunity</a></code>) is unknown so it has to be set according to a rule which does not ensure that its abundances are integer values. Then, classical bias-correction methods do not apply. Providing the <code>SampleCoverage</code> argument allows applying the <code>"ChaoShen"</code> correction to estimate quite well the entropy. <code><a href="#topic+DivPart">DivPart</a></code> and <code><a href="#topic+GammaEntropy">GammaEntropy</a></code> functions use this tweak.
</p>


<h3>Value</h3>

<p>A named number equal to the calculated entropy. The name is that of the bias correction used.
</p>


<h3>References</h3>

<p>Leinster, T. and Cobbold, C. (2012). Measuring diversity: the importance of species similarity. <em>Ecology</em> 93(3): 477-489.
</p>
<p>Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>
<p>Ricotta, C. and Szeidl, L. (2006). Towards a unifying approach to diversity measures: Bridging the gap between the Shannon entropy and Rao's quadratic index. <em>Theoretical Population Biology</em> 70(3): 237-243.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Dqz">Dqz</a></code>, <code><a href="#topic+PhyloEntropy">PhyloEntropy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Prepare the similarity matrix
DistanceMatrix &lt;- as.matrix(EightSpTree$Wdist^2/2)
# Similarity can be 1 minus normalized distances between species
Z &lt;- 1 - DistanceMatrix/max(DistanceMatrix)
# Calculate diversity of order 2
Ps &lt;- EightSpAbundance/sum(EightSpAbundance)
Hqz(Ps, 2, Z)
# Equal to normalized Rao quadratic entropy when q=2
Rao(Ps, EightSpTree)/max(DistanceMatrix)
# But different from PhyloEntropy for all other q, e.g. 1
Hqz(Ps, 1, Z)
summary(PhyloEntropy(Ps, 1, EightSpTree))
</code></pre>

<hr>
<h2 id='HqzBeta'>
Similarity-based beta entropy of a community
</h2><span id='topic+HqzBeta'></span><span id='topic+bcHqzBeta'></span><span id='topic+HqzBeta.ProbaVector'></span><span id='topic+HqzBeta.AbdVector'></span><span id='topic+HqzBeta.integer'></span><span id='topic+HqzBeta.numeric'></span>

<h3>Description</h3>

<p>Calculates the similarity-based beta entropy of order <code class="reqn">q</code> of a community belonging to a metacommunity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HqzBeta(NorP, NorPexp = NULL, q = 1, Z = diag(length(NorP)), ...)
bcHqzBeta(Ns, Nexp = NULL, q = 1, Z = diag(length(Ns)), Correction = "Best",
          CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
HqzBeta(NorP, NorPexp = NULL, q = 1, Z = diag(length(NorP)),
  ..., CheckArguments = TRUE, Ps = NULL, Pexp = NULL)
## S3 method for class 'AbdVector'
HqzBeta(NorP, NorPexp = NULL, q = 1, Z = diag(length(NorP)), Correction = "Best", 
  ..., CheckArguments = TRUE, Ns = NULL, Nexp = NULL)
## S3 method for class 'integer'
HqzBeta(NorP, NorPexp = NULL, q = 1, Z = diag(length(NorP)), Correction = "Best", 
  ..., CheckArguments = TRUE, Ns = NULL, Nexp = NULL)
## S3 method for class 'numeric'
HqzBeta(NorP, NorPexp = NULL, q = 1, Z = diag(length(NorP)), Correction = "Best", 
  ..., CheckArguments = TRUE, Ps = NULL, Ns = NULL, Pexp = NULL, Nexp = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HqzBeta_+3A_ps">Ps</code></td>
<td>

<p>The probability vector of species of the community.
</p>
</td></tr>
<tr><td><code id="HqzBeta_+3A_pexp">Pexp</code></td>
<td>

<p>The probability vector of species of the metacommunity.
</p>
</td></tr>
<tr><td><code id="HqzBeta_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances of the community.
</p>
</td></tr>
<tr><td><code id="HqzBeta_+3A_nexp">Nexp</code></td>
<td>

<p>A numeric vector containing species abundances of the metacommunity.
</p>
</td></tr>
<tr><td><code id="HqzBeta_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities of the community.
</p>
</td></tr>
<tr><td><code id="HqzBeta_+3A_norpexp">NorPexp</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities of the metacommunity.
</p>
</td></tr>
<tr><td><code id="HqzBeta_+3A_q">q</code></td>
<td>

<p>A number, the order of diversity. Default is 1.
</p>
</td></tr>
<tr><td><code id="HqzBeta_+3A_z">Z</code></td>
<td>

<p>A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1. Default is the identity matrix to calculate neutral entropy.
</p>
</td></tr>
<tr><td><code id="HqzBeta_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections: currently, no correction is available so <code>"Best"</code>,  the default value, is equivalent to <code>"None"</code>.
</p>
</td></tr>
<tr><td><code id="HqzBeta_+3A_...">...</code></td>
<td>

<p>Additional arguments. Unused.
</p>
</td></tr>
<tr><td><code id="HqzBeta_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The derivation of similarity-based beta entropy can be found in Marcon <em>et al.</em> (2014).
</p>
<p>Bias correction requires the number of individuals.
</p>
<p>Note that beta entropy value is related to alpha entropy (if <code class="reqn">q</code> is not 1) and cannot be compared accross communities (Jost, 2007). Beta entropy of a community is not meaningful in general, do rather calculate the <code><a href="#topic+BetaDiversity">BetaDiversity</a></code> of the metacommunity.
</p>
<p>The functions are designed to be used as simply as possible. <code>HqzBeta</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcHqzBeta</code> is called. Explicit calls to <code>bcHqzBeta</code> (with bias correction) or to <code>HqzBeta.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>


<h3>Value</h3>

<p>A named number equal to the calculated entropy. The name is that of the bias correction used.
</p>


<h3>References</h3>

<p>Jost (2007), Partitioning diversity into independent alpha and beta components. <em>Ecology</em> 88(10): 2427-2439.
</p>
<p>Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ps)
# Probability distribution of the first plot
Ps1 &lt;- as.ProbaVector(Paracou618.MC$Psi[, 1])
# Prepare the similarity matrix
DistanceMatrix &lt;- as.matrix(Paracou618.dist)
# Similarity can be 1 minus normalized distances between species
Z &lt;- 1 - DistanceMatrix/max(DistanceMatrix)
# Divergence of order 2 between plot 1 and the whole forest
HqzBeta(Ps1, Ps, q=2, Z)
</code></pre>

<hr>
<h2 id='Hurlbert'>
Hurlbert's Index and Explicit Diversity
</h2><span id='topic+Hurlbert'></span><span id='topic+bcHurlbert'></span><span id='topic+Hurlbert.ProbaVector'></span><span id='topic+Hurlbert.AbdVector'></span><span id='topic+Hurlbert.integer'></span><span id='topic+Hurlbert.numeric'></span><span id='topic+HurlbertD'></span><span id='topic+bcHurlbertD'></span><span id='topic+HurlbertD.ProbaVector'></span><span id='topic+HurlbertD.AbdVector'></span><span id='topic+HurlbertD.integer'></span><span id='topic+HurlbertD.numeric'></span>

<h3>Description</h3>

<p>Calculates the Hurlbert entropy of order <code class="reqn">k</code> of a probability or abundance vector, and its effective number of species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Hurlbert(NorP, k = 2, ...)
bcHurlbert(Ns, k = 2, CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
Hurlbert(NorP, k = 2, ..., 
  CheckArguments = TRUE, Ps = NULL)
## S3 method for class 'AbdVector'
Hurlbert(NorP, k = 2, ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'integer'
Hurlbert(NorP, k = 2, ...,
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'numeric'
Hurlbert(NorP, k = 2, ...,
  CheckArguments = TRUE, Ps = NULL, Ns = NULL) 
HurlbertD(NorP, k = 2, ...)
bcHurlbertD(Ns, k = 2, CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
HurlbertD(NorP, k = 2, ...,
  CheckArguments = TRUE, Ps = NULL)
## S3 method for class 'AbdVector'
HurlbertD(NorP, k = 2, ...,
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'integer'
HurlbertD(NorP, k = 2, ...,
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'numeric'
HurlbertD(NorP, k = 2, ...,
  CheckArguments = TRUE, Ps = NULL, Ns = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Hurlbert_+3A_ps">Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td></tr>
<tr><td><code id="Hurlbert_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td></tr>
<tr><td><code id="Hurlbert_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities.
</p>
</td></tr>
<tr><td><code id="Hurlbert_+3A_k">k</code></td>
<td>

<p>A number: the order of diversity. Default is 2 for Simpson's diversity.
</p>
</td></tr>
<tr><td><code id="Hurlbert_+3A_...">...</code></td>
<td>

<p>Additional arguments. Unused.
</p>
</td></tr>
<tr><td><code id="Hurlbert_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Hurlbert's index of diversity (1971) of order <code class="reqn">k</code> is the expected number of species in a sample of size <code class="reqn">k</code>.
</p>
<p>Bias correction requires the number of individuals. Use <code>bcHurlbert</code>. It is limited to orders <code class="reqn">k</code> less than or equal to the number of individuals in the community.
</p>
<p>The effective number of species <code>HurlbertD</code> (explicit diversity) has been derived by Dauby &amp; Hardy (2012). It is calculated numerically. <code>bcHurlbertD</code> calculates it from the bias-corrected index <code>bcHurlbert</code>.
</p>
<p>The functions are designed to be used as simply as possible. <code>Hurlbert</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcHurlbert</code> is called. Explicit calls to <code>bcHurlbert</code> (with bias correction) or to <code>Hurlbert.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>


<h3>Value</h3>

<p>A named number equal to the calculated index or diversity. The name is either &quot;Biased&quot; or &quot;Unbiased&quot;, depending on the estimator used.
</p>


<h3>References</h3>

<p>Dauby G. &amp; Hardy O.J. (2012) Sampled-based estimation of diversity sensu stricto by transforming Hurlbert diversities into effective number of species. <em>Ecography</em> 35(7): 661-672.
</p>
<p>Hurlbert (1971) The Nonconcept of Species Diversity: A Critique and Alternative Parameters. <em>Ecology</em> 52(4): 577-586.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Species probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ns)
# Whittaker plot
plot(Ns)

# Calculate Hurlbert entropy of order 2, equal to Simpson's index of diversity
Hurlbert(Ps, 2) 
# Calculate an unbiased estimator of Hurlbert entropy of order 2
Hurlbert(Ns, 2)
</code></pre>

<hr>
<h2 id='KLq'>
Generalized Kullback-Leibler divergence
</h2><span id='topic+KLq'></span>

<h3>Description</h3>

<p>Calculates the generalized Kullback-Leibler divergence between an observed and an expected probability distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KLq(Ps, Pexp, q = 1, CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KLq_+3A_ps">Ps</code></td>
<td>

<p>The observed probability vector.
</p>
</td></tr>
<tr><td><code id="KLq_+3A_pexp">Pexp</code></td>
<td>

<p>The expected probability vector.
</p>
</td></tr>
<tr><td><code id="KLq_+3A_q">q</code></td>
<td>

<p>A number: the order of entropy. Default is 1.
</p>
</td></tr>
<tr><td><code id="KLq_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generalized Kullback-Leibler divergence (Borland et al., 1998) converges to the Kullback-Leibler divergence (Kullback and Leibler, 1951) when <code class="reqn">q</code> tends to 1.
It is used to calculate the generalized beta entropy (Marcon et al., 2014).
</p>


<h3>Value</h3>

<p>A number equal to the generalized Kullback-Leibler divergence between the probability distributions.
</p>


<h3>References</h3>

<p>Borland, L., Plastino, A. R. and Tsallis, C. (1998). Information gain within nonextensive thermostatistics. <em>Journal of Mathematical Physics</em> 39(12): 6490-6501.
</p>
<p>Kullback, S. and Leibler, R. A. (1951). On Information and Sufficiency. The Annals of Mathematical <em>Statistics</em> 22(1): 79-86.
</p>
<p>Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TsallisBeta">TsallisBeta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- Paracou618.MC$Ps
# Probability distribution of the first plot
Ps1 &lt;- Paracou618.MC$Psi[, 1]
# Divergence of order 2 between the first plot and the whole forest
KLq(Ps1, Ps, 2)
</code></pre>

<hr>
<h2 id='lnq'>
Logarithm of order q
</h2><span id='topic+lnq'></span><span id='topic+lnq.CommunityProfile'></span>

<h3>Description</h3>

<p>Calculates the deformed logarithm of order <code class="reqn">q</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lnq(x, q)
lnq.CommunityProfile(Profile)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lnq_+3A_x">x</code></td>
<td>

<p>A numeric vector.
</p>
</td></tr>
<tr><td><code id="lnq_+3A_profile">Profile</code></td>
<td>

<p>A <code><a href="#topic+CommunityProfile">CommunityProfile</a></code>.
</p>
</td></tr>
<tr><td><code id="lnq_+3A_q">q</code></td>
<td>

<p>A number.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The deformed logarithm is defined as <code class="reqn">\ln_q{x}=\frac{(x^{(1-q)}-1)}{(1-q)}</code>.
</p>
<p>The shape of the deformed logarithm is similar to that of the regular one. <code class="reqn">\ln_1{x}=\log{x}</code>.
</p>
<p>For <code class="reqn">q&gt;1</code>, <code class="reqn">\ln_q{(+\infty)}=\frac{1}{(q-1)}</code>.
</p>
<p><code>lnq.CommunityProfile</code> calculates the deformed logarithm of a <code><a href="#topic+CommunityProfile">CommunityProfile</a></code>. Its <code>$x</code> item (the order of diversity) is kept unchanged whilst other items are set to their logarithm of order <code>$x</code>. Thus, a diversity profile is transformed into an entropy profile.
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>x</code> containing the transformed values or a <code><a href="#topic+CommunityProfile">CommunityProfile</a></code>.  
</p>


<h3>References</h3>

<p>Tsallis, C. (1994). What are the numbers that experiments provide? <em>Quimica Nova</em> 17(6): 468-471.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expq">expq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>curve(log(x), 0, 1, lty=1)
curve(lnq(x, 2), 0, 1, lty=2, add=TRUE)
curve(lnq(x, 3), 0, 1, lty=3, add=TRUE)  
legend("topleft", legend = c("log(x)", "ln2(x)", "ln3(x)"), lty = c(1, 2, 3), inset=0.02)
</code></pre>

<hr>
<h2 id='MC+20Utilities'>
Manipulation of meta-communities
</h2><span id='topic+MergeMC'></span><span id='topic+MergeC'></span><span id='topic+ShuffleMC'></span>

<h3>Description</h3>

<p>Tools to manipulate meta-communities. From a list of meta-communities, <code>MergeMC</code> creates a metacommunity whose communities are each original metacommunity. <code>MergeC</code> creates a metacommunity whose communities are each original community. <code>ShuffleMC</code> randomly assigns original communities to a metacommunity, keeping original weights, and returns a list of meta-communities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MergeMC(MClist, Weights = rep(1, length(MClist)), CheckArguments = TRUE)
MergeC(MClist, Weights = rep(1, length(MClist)), CheckArguments = TRUE)
ShuffleMC(MClist, Weights = rep(1, length(MClist)), CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MC+2B20Utilities_+3A_mclist">MClist</code></td>
<td>

<p>A list of <code>MetaCommunity</code> objects.
</p>
</td></tr>
<tr><td><code id="MC+2B20Utilities_+3A_weights">Weights</code></td>
<td>

<p>A vector of numbers containing the weight of each metacommunity of the list. It does not have to be normalized to sum to 1.
</p>
</td></tr>
<tr><td><code id="MC+2B20Utilities_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>MergeMC</code> is used for hierarchical partitioning of diversity. The gamma diversity of communities of the list becomes alpha diversity of the merged meta-community.
</p>
<p><code>MergeC</code> creates a new meta-community by mixing original ones. Original communities are kept, their new weight is the product of their original weight and the weight of their original meta-community.
</p>
<p><code>ShuffleMC</code> is used for simulations of the null hypothesis that all metacommunities of the list are identical.
</p>


<h3>Value</h3>

<p><code>MergeMC</code> and <code>MergeC</code> return a <code><a href="#topic+MetaCommunity">MetaCommunity</a></code>.
</p>
<p><code>ShuffleMC</code> returns a <code><a href="base.html#topic+list">list</a></code> of <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> objects.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MetaCommunity">MetaCommunity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># First meta-community
(df &lt;- data.frame(C1 = c(10, 10, 10, 10), C2 = c(0, 20, 35, 5),
  C3 = c(25, 15, 0, 2), row.names = c("sp1", "sp2", "sp3", "sp4")))
w &lt;- c(1, 2, 1)
MC1 &lt;- MetaCommunity(Abundances = df, Weights = w)
# Second meta-community
(df &lt;- data.frame(C1 = c(10, 4), C2 = c(3, 4), row.names = c("sp1", "sp5")))
w &lt;- c(3, 2)
MC2 &lt;- MetaCommunity(Abundances = df, Weights = w)

# Merge communities
plot(MergeC(list(MC1, MC2)), main="Merged communities")
# Merge metacommunities
plot(MergeMC(list(MC1, MC2)), main="Merged meta-communities")
smc &lt;- ShuffleMC(list(MC1, MC2))
plot(MergeMC(smc), main="Shuffled, then Merged meta-communities")
</code></pre>

<hr>
<h2 id='MCdiversity'>
Meta-Community diversity class.
</h2><span id='topic+MCdiversity'></span><span id='topic+is.MCdiversity'></span><span id='topic+plot.MCdiversity'></span><span id='topic+autoplot.MCdiversity'></span><span id='topic+summary.MCdiversity'></span>

<h3>Description</h3>

<p>Methods for objects of type &quot;<code>MCdiversity</code>&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.MCdiversity(x)
## S3 method for class 'MCdiversity'
plot(x, ...)
## S3 method for class 'MCdiversity'
autoplot(object, col = ggplot2::GeomCol$default_aes$fill,
          border = ggplot2::GeomCol$default_aes$colour, ...)
## S3 method for class 'MCdiversity'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCdiversity_+3A_x">x</code></td>
<td>

<p>An object to be tested or plotted.
</p>
</td></tr>
<tr><td><code id="MCdiversity_+3A_object">object</code></td>
<td>

<p>A <code>MCdiversity</code> object to be summarized or plotted.
</p>
</td></tr>
<tr><td><code id="MCdiversity_+3A_col">col</code></td>
<td>

<p>The color used to fill the bars. See &quot;Color Specification&quot; in <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
<tr><td><code id="MCdiversity_+3A_border">border</code></td>
<td>

<p>The color of the borders around the bars. See <code><a href="graphics.html#topic+hist">hist</a></code>.
</p>
</td></tr>
<tr><td><code id="MCdiversity_+3A_...">...</code></td>
<td>

<p>Additional arguments to be passed to the generic methods.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Meta-community diversity objects are lists containing:
</p>
<table>
<tr><td><code>MetaCommunity</code></td>
<td>
<p>The name of the <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> object containing inventory data.</p>
</td></tr>
<tr><td><code>Type</code></td>
<td>
<p>The type of diversity (&quot;alpha&quot;, &quot;beta&quot; or &quot;gamma&quot;).</p>
</td></tr>
<tr><td><code>Order</code></td>
<td>
<p>The order of diversity <code class="reqn">q</code>.</p>
</td></tr>
<tr><td><code>Correction</code></td>
<td>
<p>The estimation bias correction used to calculate diversity.</p>
</td></tr>
<tr><td><code>Tree</code></td>
<td>
<p>The phylogenetic or functional tree used to calculate phylodiversity.</p>
</td></tr>
<tr><td><code>Normalized</code></td>
<td>
<p>Logical. Indicates whether phylodiversity is normalized or proportional to the height of the tree.</p>
</td></tr>
<tr><td><code>Weights</code></td>
<td>
<p>A vector containing the weights of communities.</p>
</td></tr>
<tr><td><code>Communities</code></td>
<td>
<p>A vector containing the diversity of communities.</p>
</td></tr>
<tr><td><code>Total</code></td>
<td>
<p>The total diversity.</p>
</td></tr>
</table>
<p><code>is.MCdiversity</code> returns <code>TRUE</code> if the object is of class <code>MCdiversity</code>.
</p>
<p><code>summary.MCdiversity</code> returns a summary of the object's value.
</p>

<hr>
<h2 id='MCentropy'>
Meta-Community entropy class.
</h2><span id='topic+MCentropy'></span><span id='topic+is.MCentropy'></span><span id='topic+plot.MCentropy'></span><span id='topic+autoplot.MCentropy'></span><span id='topic+summary.MCentropy'></span>

<h3>Description</h3>

<p>Methods for objects of type &quot;<code>MCentropy</code>&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.MCentropy(x)
## S3 method for class 'MCentropy'
plot(x, ...)
## S3 method for class 'MCentropy'
autoplot(object, col = ggplot2::GeomCol$default_aes$fill,
          border = ggplot2::GeomCol$default_aes$colour, ...)
## S3 method for class 'MCentropy'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCentropy_+3A_x">x</code></td>
<td>

<p>An object to be tested or plotted.
</p>
</td></tr>
<tr><td><code id="MCentropy_+3A_object">object</code></td>
<td>

<p>A <code>MCentropy</code> object to be summarized or plotted.
</p>
</td></tr>
<tr><td><code id="MCentropy_+3A_col">col</code></td>
<td>

<p>The color used to fill the bars. See &quot;Color Specification&quot; in <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
<tr><td><code id="MCentropy_+3A_border">border</code></td>
<td>

<p>The color of the borders around the bars. See <code><a href="graphics.html#topic+hist">hist</a></code>.
</p>
</td></tr>
<tr><td><code id="MCentropy_+3A_...">...</code></td>
<td>

<p>Additional arguments to be passed to the generic methods.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Meta-community entropy objects are lists containing:
</p>
<table>
<tr><td><code>MetaCommunity</code></td>
<td>
<p>The name of the <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> object containing inventory data.</p>
</td></tr>
<tr><td><code>Method</code></td>
<td>
<p>The method used to calculate entropy (&quot;HCDT&quot;, &quot;Similarity-based&quot;).</p>
</td></tr>
<tr><td><code>Type</code></td>
<td>
<p>The type of entropy (&quot;alpha&quot;, &quot;beta&quot; or &quot;gamma&quot;).</p>
</td></tr>
<tr><td><code>Order</code></td>
<td>
<p>The order of entropy <code class="reqn">q</code>.</p>
</td></tr>
<tr><td><code>Correction</code></td>
<td>
<p>The estimation bias correction used to calculate entropy.</p>
</td></tr>
<tr><td><code>Tree</code></td>
<td>
<p>The phylogenetic or functional tree used to calculate phyloentropy.</p>
</td></tr>
<tr><td><code>Normalized</code></td>
<td>
<p>Logical. Indicates whether phyloentropy is normalized or proportional to the height of the tree.</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p>The matrix used to calculate similarity-based entropy.</p>
</td></tr>
<tr><td><code>Weights</code></td>
<td>
<p>A vector containing the weights of communities.</p>
</td></tr>
<tr><td><code>Communities</code></td>
<td>
<p>A vector containing the entropy of communities.</p>
</td></tr>
<tr><td><code>Total</code></td>
<td>
<p>The total entropy.</p>
</td></tr>
</table>
<p><code>is.MCentropy</code> returns <code>TRUE</code> if the object is of class <code>MCentropy</code>.
</p>
<p><code>summary.MCentropy</code> returns a summary of the object's value.
</p>

<hr>
<h2 id='mergeandlabel'>
Merge community data
</h2><span id='topic+mergeandlabel'></span>

<h3>Description</h3>

<p>Merge two dataframes containing species abundances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mergeandlabel(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mergeandlabel_+3A_x">x</code></td>
<td>

<p>A dataframe containing species abundances
</p>
</td></tr>
<tr><td><code id="mergeandlabel_+3A_y">y</code></td>
<td>

<p>A dataframe containing species abundances
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Row names must contain species. The new dataframe keeps all species with abundance zero for species that were not found in original communities.
</p>


<h3>Value</h3>

<p>A dataframe containing all lines and columns of the merged dataframes.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MergeC">MergeC</a></code>, <code><a href="#topic+MergeMC">MergeMC</a></code>, <code><a href="#topic+ShuffleMC">ShuffleMC</a></code>
</p>

<hr>
<h2 id='MetaCommunity'>
Metacommunity class
</h2><span id='topic+MetaCommunity'></span><span id='topic+is.MetaCommunity'></span><span id='topic+plot.MetaCommunity'></span><span id='topic+summary.MetaCommunity'></span>

<h3>Description</h3>

<p>Methods for objects of type &quot;<code>MetaCommunity</code>&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MetaCommunity(Abundances, Weights = rep(1, ncol(Abundances)))
is.MetaCommunity(x)
## S3 method for class 'MetaCommunity'
summary(object, ...)
## S3 method for class 'MetaCommunity'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MetaCommunity_+3A_abundances">Abundances</code></td>
<td>

<p>A dataframe containing the number of observations (lines are species, columns are communities). The first column of the dataframe may contain the species names.
</p>
</td></tr>
<tr><td><code id="MetaCommunity_+3A_weights">Weights</code></td>
<td>

<p>A vector of positive numbers equal to community weights or a dataframe containing a vector named <code>Weights</code>. It does not have to be normalized. Weights are equal by default.
</p>
</td></tr>
<tr><td><code id="MetaCommunity_+3A_x">x</code></td>
<td>

<p>An object to be tested or plotted.
</p>
</td></tr>
<tr><td><code id="MetaCommunity_+3A_object">object</code></td>
<td>

<p>A <code>MetaCommunity</code> object to be summarized.
</p>
</td></tr>
<tr><td><code id="MetaCommunity_+3A_...">...</code></td>
<td>

<p>Additional arguments to be passed to the generic methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the entropart package, individuals of different &quot;species&quot; are counted in several &quot;communities&quot; which are agregated to define a &quot;metacommunity&quot;.
</p>
<p>This is a naming convention, which may correspond to plots in a forest inventory or any data organized the same way.
</p>
<p>Alpha and beta entropies of communities are summed according to <code>Weights</code> and the probability to find a species in the metacommunity is the weighted average of probabilities in communities.
</p>
<p>The simplest way to import data is to organize it into two text files. The first file should contain abundance data: the first column named <code>Species</code> for species names, and a column for each community.
</p>
<p>The second file should contain the community weights in two columns. The first one, named <code>Communities</code> should contain their names and the second one, named <code>Weights</code>, their weights.
</p>
<p>Files can be read and data imported by code such as:
</p>
<pre>
Abundances &lt;- read.csv(file="Abundances.csv", row.names = 1)
Weights &lt;- read.csv(file="Weights.csv")
MC &lt;- MetaCommunity(Abundances, Weights)
</pre>


<h3>Value</h3>

<p>An object of class <strong>MetaCommunity</strong> is a list:
</p>
<table>
<tr><td><code>Nsi</code></td>
<td>
<p>A matrix containing abundance data, species in line, communities in column.</p>
</td></tr>
<tr><td><code>Ns</code></td>
<td>
<p>A vector containing the number of individuals of each species.</p>
</td></tr>
<tr><td><code>Ni</code></td>
<td>
<p>A vector containing the number of individuals of each community.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>The total number of individuals.</p>
</td></tr>
<tr><td><code>Psi</code></td>
<td>
<p>A matrix whose columns are the probability vectors of communities (each of them sums to 1).</p>
</td></tr>
<tr><td><code>Wi</code></td>
<td>
<p>A vector containing the normalized community weights (sum to 1).</p>
</td></tr>
<tr><td><code>Ps</code></td>
<td>
<p>A vector containing the probability vector of the metacommunity.</p>
</td></tr>
<tr><td><code>Nspecies</code></td>
<td>
<p>The number of species.</p>
</td></tr>
<tr><td><code>Ncommunities</code></td>
<td>
<p>The number of communities.</p>
</td></tr>
<tr><td><code>SampleCoverage</code></td>
<td>
<p>The sample coverage of the metacommunity.</p>
</td></tr>
<tr><td><code>SampleCoverage.communities</code></td>
<td>
<p>A vector containing the sample coverages of each community.</p>
</td></tr>
</table>
<p><code>is.MetaCommunity</code> returns <code>TRUE</code> if the object is of class <code>MetaCommunity</code>.
</p>
<p><code>summary.MetaCommunity</code> returns a summary of the object's value.
</p>
<p><code>plot.MetaCommunity</code> plots it.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Use BCI data from vegan package
if (require(vegan, quietly = TRUE)) {
  # Load BCI data (number of trees per species in each 1-ha plot of a tropical forest)
  data(BCI)
  # BCI dataframe must be transposed (its lines are plots, not species)
  BCI.df &lt;- as.data.frame(t(BCI))
  # Create a metacommunity object from a matrix of abundances and a vector of weights
  # (here, all plots have a weight equal to 1)
  MC &lt;- MetaCommunity(BCI.df)
}
</code></pre>

<hr>
<h2 id='Optimal.Similarity'>
Optimal scale parameter to transform a distance matrix into a similarity matrix
</h2><span id='topic+Optimal.Similarity'></span>

<h3>Description</h3>

<p>Calculates the scale parameter <code class="reqn">u</code> that maximizes the variance of the similarity matrix <code class="reqn">exp(-u*DistanceMatrix)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Optimal.Similarity(Distance, CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Optimal.Similarity_+3A_distance">Distance</code></td>
<td>

<p>A distance matrix, <em>i.e.</em> a square matrix with zeros on its diagonal or a <code><a href="stats.html#topic+dist">dist</a></code> object.
</p>
</td></tr>
<tr><td><code id="Optimal.Similarity_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The similarity matrix used by <code><a href="#topic+Dqz">Dqz</a></code>) can be optimized following Marcon <em>et al.</em> (2014) such that the variance of similarities between pairs of species is maximized. See the example.
</p>


<h3>Value</h3>

<p>A list:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>The optimal scale <code class="reqn">u</code>.</p>
</td></tr>
<tr><td><code>Matrix</code></td>
<td>
<p>The optimal similarity matrix <code>Z</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Dqz">Dqz</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Prepare the similarity matrix. The square root of Paracou618.dist is euclidean.
optimal &lt;- Optimal.Similarity(sqrt(Paracou618.dist))
# Optimal scale
optimal$u
# Calculate diversity of order 2
bcDqz(Paracou618.MC$Ns, 2, optimal$Matrix)
</code></pre>

<hr>
<h2 id='Paracou618.dist'>
Functional distances between pairs of species of Paracou field station plots 6 and 18, two 1-ha plots inventoried by the Bridge project.
</h2><span id='topic+Paracou618.dist'></span>

<h3>Description</h3>

<p>This dataset is from Paracou field station, French Guiana, managed by <a href="https://www.cirad.fr">Cirad</a>. Traits are detailed in Marcon and Herault (2014), the distance matrix was built following Paine et al. (2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Paracou618)
</code></pre>


<h3>Format</h3>

<p>An object of class <code><a href="stats.html#topic+dist">dist</a></code>.
</p>


<h3>Source</h3>

<p>Permanent data census of Paracou.
</p>


<h3>References</h3>

<p>Gourlet-Fleury, S., Guehl, J. M. and Laroussinie, O., Eds. (2004). <em>Ecology &amp; management of a neotropical rainforest. Lessons drawn from Paracou, a long-term experimental research site in French Guiana</em>. Paris, Elsevier.
</p>
<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p>Paine, C. E. T., Baraloto, C., Chave, J., and Herault, B. (2011). Functional traits of individual trees reveal ecological constraints on community assembly in tropical rain forests. <em>Oikos</em>, 120(5), 720-727.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paracou618)
plot(density(Paracou618.dist, from=0), main="Distances between species")
</code></pre>

<hr>
<h2 id='Paracou618.Functional'>
Functional tree of species of Paracou field station plots 6 and 18, two 1-ha plots inventoried by the Bridge project.
</h2><span id='topic+Paracou618.Functional'></span>

<h3>Description</h3>

<p>This dataset is from Paracou field station, French Guiana, managed by <a href="https://www.cirad.fr">Cirad</a>. Traits are detailed in Marcon and Herault (2014), the tree was built following Paine et al. (2011), based on <code><a href="#topic+Paracou618.dist">Paracou618.dist</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Paracou618)
</code></pre>


<h3>Format</h3>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>.
</p>


<h3>Source</h3>

<p>Permanent data census of Paracou.
</p>


<h3>References</h3>

<p>Gourlet-Fleury, S., Guehl, J. M. and Laroussinie, O., Eds. (2004). <em>Ecology &amp; management of a neotropical rainforest. Lessons drawn from Paracou, a long-term experimental research site in French Guiana</em>. Paris, Elsevier.
</p>
<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p>Paine, C. E. T., Baraloto, C., Chave, J., and Herault, B. (2011). Functional traits of individual trees reveal ecological constraints on community assembly in tropical rain forests. <em>Oikos</em>, 120(5), 720-727.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paracou618)
plot(Paracou618.Functional)
</code></pre>

<hr>
<h2 id='Paracou618.MC'>
Paracou field station plots 6 and 18, two 1-ha plots inventoried by the Bridge project.
</h2><span id='topic+Paracou618.MC'></span>

<h3>Description</h3>

<p>This dataset is from Paracou field station, French Guiana, managed by <a href="https://www.cirad.fr">Cirad</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Paracou618)
</code></pre>


<h3>Format</h3>

<p>An object of class <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> made of two communities and 425 species.
</p>


<h3>Source</h3>

<p>Permanent data census of Paracou and Marcon et al. (2012).
</p>


<h3>References</h3>

<p>Gourlet-Fleury, S., Guehl, J. M. and Laroussinie, O., Eds. (2004). <em>Ecology &amp; management of a neotropical rainforest. Lessons drawn from Paracou, a long-term experimental research site in French Guiana</em>. Paris, Elsevier.
</p>
<p>Marcon, E., F. Puech, et al. (2012). Characterizing the relative spatial structure of point patterns. <em>International Journal of Ecology</em> 2012(Article ID 619281): 11.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Paracou618)
summary(Paracou618.MC)

</code></pre>

<hr>
<h2 id='Paracou618.Taxonomy'>
Taxonomy (Family - Genus - Species) of Paracou field station plots 6 and 18, two 1-ha plots inventoried by the Bridge project.
</h2><span id='topic+Paracou618.Taxonomy'></span>

<h3>Description</h3>

<p>This dataset is from Paracou field station, French Guiana, managed by <a href="https://www.cirad.fr">Cirad</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Paracou618)
</code></pre>


<h3>Format</h3>

<p>An object of class <code><a href="ape.html#topic+phylo">phylo</a></code> containing a taxonomy.
</p>


<h3>Source</h3>

<p>Permanent data census of Paracou.
</p>


<h3>References</h3>

<p>Gourlet-Fleury, S., Guehl, J. M. and Laroussinie, O., Eds. (2004). <em>Ecology &amp; management of a neotropical rainforest. Lessons drawn from Paracou, a long-term experimental research site in French Guiana</em>. Paris, Elsevier.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paracou618)
plot(Paracou618.Taxonomy, type="fan", show.tip.label=FALSE)
</code></pre>

<hr>
<h2 id='PDFD'>
Phylogenetic Diversity / Functional Diversity of a Community
</h2><span id='topic+PDFD'></span>

<h3>Description</h3>

<p>Calculates Faith's PD / Petchey and Gaston' FD of a community described by a probability vector and a phylogenetic / functional tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PDFD(Ps, Tree, CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PDFD_+3A_ps">Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td></tr>
<tr><td><code id="PDFD_+3A_tree">Tree</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="ape.html#topic+phylo">phylo</a></code>, <code><a href="ade4.html#topic+phylog">phylog</a></code> or <code><a href="#topic+PPtree">PPtree</a></code>. The tree must be ultrametric.
</p>
</td></tr>
<tr><td><code id="PDFD_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>PD and FD are defined as the total legth of the branches of the tree.
</p>
<p>The probability vector is used to select branches: branches with probability 0 are eliminated.
</p>
<p>Bias correction requires the number of individuals to estimate sample <code><a href="#topic+Coverage">Coverage</a></code>.
</p>
<p>Use <code><a href="#topic+bcPhyloDiversity">bcPhyloDiversity</a></code><code>(Ps, 0, Tree)</code> and choose the <code>Correction</code>.
</p>


<h3>Value</h3>

<p>A named number equal to the calculated diversity. The name is that of the bias correction used.
</p>


<h3>References</h3>

<p>Faith, D. P. (1992). Conservation evaluation and phylogenetic diversity. <em>Biological Conservation</em> 61(1): 1-10.
</p>
<p>Petchey, O. L. and Gaston, K. J. (2002). Functional diversity (FD), species richness and community composition. <em>Ecology Letters</em> 5: 402-411.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcPhyloDiversity">bcPhyloDiversity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- Paracou618.MC$Ps
# Calculate the phylogenetic Shannon diversity of the plot
PDFD(Ps, Paracou618.Taxonomy)
</code></pre>

<hr>
<h2 id='PhyloApply'>
Apply a Function over a Phylogenetic Tree
</h2><span id='topic+PhyloApply'></span>

<h3>Description</h3>

<p>Cuts the tree into slices separated by nodes, applies the function to each slice and returns the weighted (by slice lengths) sum of the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PhyloApply(Tree, FUN, NorP, Normalize = TRUE, dfArgs = NULL,
           ..., CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PhyloApply_+3A_tree">Tree</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="ape.html#topic+phylo">phylo</a></code>, <code><a href="ade4.html#topic+phylog">phylog</a></code> or <code><a href="#topic+PPtree">PPtree</a></code>. The tree must be ultrametric.
</p>
</td></tr>
<tr><td><code id="PhyloApply_+3A_fun">FUN</code></td>
<td>

<p>The function to be applied to each interval of the tree. 
</p>
</td></tr>
<tr><td><code id="PhyloApply_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector or a two-column matrix. Contains either abundances or probabilities. Two-column matrices should contain the observed abundances (or probabilities) in the first column and the expected ones in the second column, to allow using beta diversity functions.
</p>
</td></tr>
<tr><td><code id="PhyloApply_+3A_normalize">Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), the <code>Total</code> value returned by <code>Function</code> is normalized by the height of the tree (it is the weighted average value of the result in each slice).<br />
If <code>FALSE</code>, it is the unnormalized weighted sum of the results.
</p>
</td></tr>
<tr><td><code id="PhyloApply_+3A_dfargs">dfArgs</code></td>
<td>

<p>A dataframe. Columns are arguments for <code>FUN</code>: their names are those of valid arguments. Values will be passed to <code>FUN</code> in each slice of the tree, starting from the tips. The number of lines must equal the number of slices.
</p>
</td></tr>
<tr><td><code id="PhyloApply_+3A_...">...</code></td>
<td>

<p>Further arguments to pass to <code>Function</code>.
</p>
</td></tr>
<tr><td><code id="PhyloApply_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This funtion is generally not used directly. It is a tool to calculate <code><a href="#topic+PhyloEntropy">PhyloEntropy</a></code> and <code><a href="#topic+PhyloDiversity">PhyloDiversity</a></code>.
</p>
<p>Intervals (slices) separate two cuts (nodes) in a tree: no node is found at heights contained in an interval.
</p>
<p>Objects of class <strong>PPtree</strong> are returned by <code><a href="#topic+Preprocess.Tree">Preprocess.Tree</a></code>.
</p>
<p>... allow passing arguments to the function but they can't change along the tree. If necessary, <code>dfArgs</code> allow passing a different value for each slice of the tree.
</p>


<h3>Value</h3>

<p>An object of class <code>PhyloValue</code>. It is a list:
</p>
<table>
<tr><td><code>Distribution</code></td>
<td>
<p>The distribution used to calculate the value</p>
</td></tr>
<tr><td><code>Function</code></td>
<td>
<p>The function used to calculate the value</p>
</td></tr>
<tr><td><code>Tree</code></td>
<td>
<p>The functional or phylogenetic tree used to calculate the value</p>
</td></tr>
<tr><td><code>Normalized</code></td>
<td>
<p>Logical. Indicates whether phylovalue is normalized or proportional to the height of the tree.</p>
</td></tr>
<tr><td><code>Cuts</code></td>
<td>
<p>A named vector containing values along the tree. Names are cut ends, <em>i.e.</em> the ends of intervals (the first interval starts at 0 for leaves, the max value is the height of the tree).</p>
</td></tr>
<tr><td><code>Corrections</code></td>
<td>
<p>A named vector containing the correction used by FUN to obtain each value of <code>Cuts</code>. Names are those of <code>Cuts</code>.</p>
</td></tr>
<tr><td><code>Total</code></td>
<td>
<p>The total value, multiplied by the tree height if <code>Normalize</code> is FALSE.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Preprocess.Tree">Preprocess.Tree</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Plot the taxonomy
plot(Paracou618.Taxonomy, type="fan", show.tip.label=FALSE)
# Calculate the mean number of trees (individuals) per species 
# (Cuts are 1=species, 2=genus, 3=family)
summary(PhyloApply(Paracou618.Taxonomy, mean, Paracou618.MC$Ns, TRUE))
</code></pre>

<hr>
<h2 id='PhyloBetaEntropy'>
Phylogenetic Beta Entropy of a community
</h2><span id='topic+PhyloBetaEntropy'></span><span id='topic+bcPhyloBetaEntropy'></span><span id='topic+PhyloBetaEntropy.ProbaVector'></span><span id='topic+PhyloBetaEntropy.AbdVector'></span><span id='topic+PhyloBetaEntropy.integer'></span><span id='topic+PhyloBetaEntropy.numeric'></span>

<h3>Description</h3>

<p>Calculates the phylogenetic beta entropy of order <code class="reqn">q</code> of a a community belonging to a metacommunity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PhyloBetaEntropy(NorP, NorPexp = NULL, q = 1, Tree, Normalize = TRUE, ...)
bcPhyloBetaEntropy(Ns, Nexp, q = 1, Tree, Normalize = TRUE, 
  Correction = "Best", CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
PhyloBetaEntropy(NorP, NorPexp = NULL, q = 1, Tree, Normalize = TRUE, 
  ..., CheckArguments = TRUE, Ps = NULL, Pexp = NULL)
## S3 method for class 'AbdVector'
PhyloBetaEntropy(NorP, NorPexp = NULL, q = 1, Tree, Normalize = TRUE, 
  Correction = "Best", ..., CheckArguments = TRUE, Ns = NULL, Nexp = NULL)
## S3 method for class 'integer'
PhyloBetaEntropy(NorP, NorPexp = NULL, q = 1, Tree, Normalize = TRUE, 
  Correction = "Best", ..., CheckArguments = TRUE, Ns = NULL, Nexp = NULL)
## S3 method for class 'numeric'
PhyloBetaEntropy(NorP, NorPexp = NULL, q = 1, Tree, Normalize = TRUE, 
  Correction = "Best", ..., CheckArguments = TRUE, Ps = NULL, Ns = NULL, 
  Pexp = NULL, Nexp = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PhyloBetaEntropy_+3A_ps">Ps</code></td>
<td>

<p>The probability vector of species of the community.
</p>
</td></tr>
<tr><td><code id="PhyloBetaEntropy_+3A_pexp">Pexp</code></td>
<td>

<p>The probability vector of species of the metacommunity.
</p>
</td></tr>
<tr><td><code id="PhyloBetaEntropy_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances of the community.
</p>
</td></tr>
<tr><td><code id="PhyloBetaEntropy_+3A_nexp">Nexp</code></td>
<td>

<p>A numeric vector containing species abundances of the metacommunity.
</p>
</td></tr>
<tr><td><code id="PhyloBetaEntropy_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities of the community.
</p>
</td></tr>
<tr><td><code id="PhyloBetaEntropy_+3A_norpexp">NorPexp</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities of the metacommunity.
</p>
</td></tr>
<tr><td><code id="PhyloBetaEntropy_+3A_q">q</code></td>
<td>

<p>A number: the order of entropy. Default is 1.
</p>
</td></tr>
<tr><td><code id="PhyloBetaEntropy_+3A_tree">Tree</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="ape.html#topic+phylo">phylo</a></code>, <code><a href="ade4.html#topic+phylog">phylog</a></code> or <code><a href="#topic+PPtree">PPtree</a></code>. The tree must be ultrametric.
</p>
</td></tr>
<tr><td><code id="PhyloBetaEntropy_+3A_normalize">Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), the entropy returned by the function is normalized by the height of the tree (it is the weighted average value of the entropy in each slice).<br />
If <code>FALSE</code>, it is the unnormalized weighted sum of the results.
</p>
</td></tr>
<tr><td><code id="PhyloBetaEntropy_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections: currently, only <code>"ChaoShen"</code>. <code>"Best"</code> is the default value, it is equivalent to <code>"ChaoShen"</code>.
</p>
</td></tr>
<tr><td><code id="PhyloBetaEntropy_+3A_...">...</code></td>
<td>

<p>Additional arguments. Unused.
</p>
</td></tr>
<tr><td><code id="PhyloBetaEntropy_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The phylogenetic entropy is the generalization of HCDT entropy to unequal species distances (Pavoine et al., 2009).
</p>
<p>Calculation relies on <code><a href="#topic+TsallisBeta">TsallisBeta</a></code> and <code><a href="#topic+PhyloApply">PhyloApply</a></code>.
</p>
<p>Bias correction requires the number of individuals to estimate sample <code><a href="#topic+Coverage">Coverage</a></code>. Use <code>bcPhyloBetaEntropy</code> and choose the <code>Correction</code>.
</p>
<p>Note that beta entropy value is related to alpha entropy (if <code class="reqn">q</code> is not 1) and cannot be compared accross communities (Jost, 2007). Beta entropy of a community is not meaningful in general, do rather calculate the <code><a href="#topic+PhyloDiversity">PhyloDiversity</a></code> of the metacommunity.
</p>
<p>The functions are designed to be used as simply as possible. <code>PhyloBetaEntropy</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcPhyloBetaEntropy</code> is called. Explicit calls to <code>bcPhyloBetaEntropy</code> (with bias correction) or to <code>PhyloBetaEntropy.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>


<h3>Value</h3>

<p>A <code><a href="#topic+PhyloEntropy">PhyloEntropy</a></code> object containing entropy values at each cut of the tree.
</p>


<h3>References</h3>

<p>Jost (2007), Partitioning diversity into independent alpha and beta components. <em>Ecology</em> 88(10): 2427-2439.
</p>
<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p>Pavoine, S., Love, M. S. and Bonsall, M. B. (2009). Hierarchical partitioning of evolutionary and ecological patterns in the organization of phylogenetically-structured species assemblages: Application to rockfish (genus: Sebastes) in the Southern California Bight. <em>Ecology Letters</em> 12(9): 898-908.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TsallisBeta">TsallisBeta</a></code>, <code><a href="#topic+bcPhyloBetaEntropy">bcPhyloBetaEntropy</a></code>, <code><a href="#topic+PhyloDiversity">PhyloDiversity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ps)
# Probability distribution of the first plot
Ps1 &lt;- as.ProbaVector(Paracou618.MC$Psi[, 1])
# Calculate the phylogenetic Shannon beta entropy of the plot
summary(PhyloBetaEntropy(Ps1, Ps, 1, Paracou618.Taxonomy) -&gt; e)
plot(e)

# Ns is the vector of abundances of the metacommunity
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Abundances in the first plot
Ns1 &lt;- as.AbdVector(Paracou618.MC$Nsi[, 1])
# Calculate the phylogenetic Shannon beta entropy of the plot
summary(bcPhyloBetaEntropy(Ns1, Ns, 1, Paracou618.Taxonomy, Correction = "Best") -&gt; e)
plot(e)
</code></pre>

<hr>
<h2 id='PhyloDiversity'>
Phylogenetic Diversity of a Community
</h2><span id='topic+PhyloDiversity'></span><span id='topic+bcPhyloDiversity'></span><span id='topic+PhyloDiversity.ProbaVector'></span><span id='topic+PhyloDiversity.AbdVector'></span><span id='topic+PhyloDiversity.integer'></span><span id='topic+PhyloDiversity.numeric'></span><span id='topic+is.PhyloDiversity'></span><span id='topic+summary.PhyloDiversity'></span>

<h3>Description</h3>

<p>Calculates the phylogenetic diversity of order <code class="reqn">q</code> of a probability vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PhyloDiversity(NorP, q = 1, Tree, Normalize = TRUE, ...)
bcPhyloDiversity(Ns, q = 1, Tree, Normalize = TRUE, Correction = "Best",
  CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
PhyloDiversity(NorP, q = 1, Tree, Normalize = TRUE,  
  ..., CheckArguments = TRUE, Ps = NULL)
## S3 method for class 'AbdVector'
PhyloDiversity(NorP, q = 1, Tree, Normalize = TRUE, 
  Correction = "Best", ..., CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'integer'
PhyloDiversity(NorP, q = 1, Tree, Normalize = TRUE, 
  Correction = "Best", ..., CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'numeric'
PhyloDiversity(NorP, q = 1, Tree, Normalize = TRUE, 
  Correction = "Best", ..., CheckArguments = TRUE, Ps = NULL, Ns = NULL) 
is.PhyloDiversity(x)
## S3 method for class 'PhyloDiversity'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PhyloDiversity_+3A_ps">Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td></tr>
<tr><td><code id="PhyloDiversity_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td></tr>
<tr><td><code id="PhyloDiversity_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities.
</p>
</td></tr>
<tr><td><code id="PhyloDiversity_+3A_q">q</code></td>
<td>

<p>A number: the order of diversity. Default is 1.
</p>
</td></tr>
<tr><td><code id="PhyloDiversity_+3A_tree">Tree</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="ape.html#topic+phylo">phylo</a></code>, <code><a href="ade4.html#topic+phylog">phylog</a></code> or <code><a href="#topic+PPtree">PPtree</a></code>. The tree must be ultrametric.
</p>
</td></tr>
<tr><td><code id="PhyloDiversity_+3A_normalize">Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), the <code>Total</code> diversity is not affected by the height of the tree.<br />
If <code>FALSE</code>, it is proportional to the height of the tree.<br />
</p>
</td></tr>
<tr><td><code id="PhyloDiversity_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections: <code>"None"</code> (no correction), <code>"ChaoShen"</code>, <code>"Grassberger"</code>, <code>"Holste"</code>, <code>"Bonachela"</code> or <code>"Best"</code>, the default value.
</p>
</td></tr>
<tr><td><code id="PhyloDiversity_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
<tr><td><code id="PhyloDiversity_+3A_x">x</code></td>
<td>

<p>An object to be tested or plotted
</p>
</td></tr>
<tr><td><code id="PhyloDiversity_+3A_object">object</code></td>
<td>

<p>A <code>PhyloDiversity</code> object to be summarized.
</p>
</td></tr>
<tr><td><code id="PhyloDiversity_+3A_...">...</code></td>
<td>

<p>Additional arguments to be passed to the generic methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The phylogenetic entropy is its generalization of HCDT entropy to unequal species distances (Pavoine et al., 2009).
</p>
<p>Diversity is obtained by transforming generalized entropy.
</p>
<p>Bias correction requires the number of individuals to estimate sample <code><a href="#topic+Coverage">Coverage</a></code>. Use <code>bcPhyloDiversity</code> and choose the <code>Correction</code>.
</p>
<p>The functions are designed to be used as simply as possible. <code>PhyloDiversity</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcPhyloDiversity</code> is called. Explicit calls to <code>bcPhyloDiversity</code> (with bias correction) or to <code>PhyloDiversity.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>


<h3>Value</h3>

<p>An object of class <code>PhyloDiversity</code> is a list:
</p>
<table>
<tr><td><code>Distribution</code></td>
<td>
<p>The distribution used to calculate diversity</p>
</td></tr>
<tr><td><code>Function</code></td>
<td>
<p>The function used to calculate diversity</p>
</td></tr>
<tr><td><code>Tree</code></td>
<td>
<p>The functional or phylogenetic tree used to calculate diversity</p>
</td></tr>
<tr><td><code>Normalized</code></td>
<td>
<p>Logical. Indicates whether phylodiversity is normalized or proportional to the height of the tree.</p>
</td></tr>
<tr><td><code>Type</code></td>
<td>
<p>The type of diversity (&quot;alpha&quot;, &quot;beta&quot; or &quot;gamma&quot;).</p>
</td></tr>
<tr><td><code>Order</code></td>
<td>
<p>The order of diversity <code class="reqn">q</code>.</p>
</td></tr>
<tr><td><code>Cuts</code></td>
<td>
<p>A named vector containing values of neutral diversity along the tree. Names are cut ends, <em>i.e.</em> the ends of intervals (the first interval starts at 0 for leaves, the max value is the height of the tree).</p>
</td></tr>
<tr><td><code>Total</code></td>
<td>
<p>A value equal the total diversity (obtained by transforming the total normalized entropy), multiplied by the tree height if <code>Normalize</code> is FALSE.</p>
</td></tr>
</table>
<p><code>is.PhyloDiversity</code> returns <code>TRUE</code> if the object is of class <code>PhyloDiversity</code>.
</p>
<p><code>summary.PhyloDiversity</code> returns a summary of the object's value.
</p>
<p><code>PhyloDiversity</code> objects can be plotted by <code><a href="#topic+plot.PhyloValue">plot.PhyloValue</a></code> because <code>PhyloDiversity</code> objects are also of class <code>PhyloValue</code>.
</p>


<h3>Note</h3>

<p>The tree must contain all species of the probability vector. If it contains extra species, computation time will just be increased.
</p>


<h3>References</h3>

<p>Chao, A., Chiu, C.-H. and Jost, L. (2010). Phylogenetic diversity measures based on Hill numbers. <em>Philosophical Transactions of the Royal Society B</em> 365(1558): 3599-609.
</p>
<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p>Pavoine, S., Love, M. S. and Bonsall, M. B. (2009). Hierarchical partitioning of evolutionary and ecological patterns in the organization of phylogenetically-structured species assemblages: Application to rockfish (genus: Sebastes) in the Southern California Bight. <em>Ecology Letters</em> 12(9): 898-908.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PhyloEntropy">PhyloEntropy</a></code>, <code><a href="#topic+Diversity">Diversity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ps)
# Calculate the phylogenetic Shannon diversity of the plot
summary(PhyloDiversity(Ps, 1, Paracou618.Taxonomy) -&gt; d)
plot(d)

# Ns is the vector of abundances of the metacommunity
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Calculate the phylogenetic Shannon diversity of the plot
summary(bcPhyloDiversity(Ns, 1, Paracou618.Taxonomy, Correction = "Best") -&gt; d)
plot(d)
</code></pre>

<hr>
<h2 id='PhyloEntropy'>
Phylogenetic Entropy of a community
</h2><span id='topic+PhyloEntropy'></span><span id='topic+bcPhyloEntropy'></span><span id='topic+PhyloEntropy.ProbaVector'></span><span id='topic+PhyloEntropy.AbdVector'></span><span id='topic+PhyloEntropy.integer'></span><span id='topic+PhyloEntropy.numeric'></span><span id='topic+is.PhyloEntropy'></span><span id='topic+summary.PhyloEntropy'></span>

<h3>Description</h3>

<p>Calculates the phylogenetic entropy of order <code class="reqn">q</code> of a probability vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PhyloEntropy(NorP, q = 1, Tree, Normalize = TRUE, ...)
bcPhyloEntropy(Ns, q = 1, Tree, Normalize = TRUE, Correction = "Best", 
  SampleCoverage = NULL, CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
PhyloEntropy(NorP, q = 1, Tree, Normalize = TRUE, 
  ..., CheckArguments = TRUE, Ps = NULL)
## S3 method for class 'AbdVector'
PhyloEntropy(NorP, q = 1, Tree, Normalize = TRUE, Correction = "Best", 
  ..., CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'integer'
PhyloEntropy(NorP, q = 1, Tree, Normalize = TRUE, Correction = "Best", 
  ..., CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'numeric'
PhyloEntropy(NorP, q = 1, Tree, Normalize = TRUE, Correction = "Best", 
  ..., CheckArguments = TRUE, Ps = NULL, Ns = NULL) 
is.PhyloEntropy(x)
## S3 method for class 'PhyloEntropy'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PhyloEntropy_+3A_ps">Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td></tr>
<tr><td><code id="PhyloEntropy_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td></tr>
<tr><td><code id="PhyloEntropy_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities.
</p>
</td></tr>
<tr><td><code id="PhyloEntropy_+3A_q">q</code></td>
<td>

<p>A number: the order of entropy. Default is 1.
</p>
</td></tr>
<tr><td><code id="PhyloEntropy_+3A_tree">Tree</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="ape.html#topic+phylo">phylo</a></code>, <code><a href="ade4.html#topic+phylog">phylog</a></code> or <code><a href="#topic+PPtree">PPtree</a></code>. The tree must be ultrametric.
</p>
</td></tr>
<tr><td><code id="PhyloEntropy_+3A_normalize">Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), the <code>Total</code> entropy returned by the function is normalized by the height of the tree (it is the weighted average value of the entropy in each slice).<br />
If <code>FALSE</code>, it is the unnormalized weighted sum of the results.
</p>
</td></tr>
<tr><td><code id="PhyloEntropy_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections supported by <code><a href="#topic+Tsallis">Tsallis</a></code>.
</p>
</td></tr>
<tr><td><code id="PhyloEntropy_+3A_samplecoverage">SampleCoverage</code></td>
<td>

<p>The sample coverage of <code>Ns</code> calculated elsewhere. Used to calculate the gamma diversity of meta-communities, see details. 
</p>
</td></tr>
<tr><td><code id="PhyloEntropy_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
<tr><td><code id="PhyloEntropy_+3A_x">x</code></td>
<td>

<p>An object to be tested or plotted
</p>
</td></tr>
<tr><td><code id="PhyloEntropy_+3A_object">object</code></td>
<td>

<p>A <code>PhyloEntropy</code> object to be summarized.
</p>
</td></tr>
<tr><td><code id="PhyloEntropy_+3A_...">...</code></td>
<td>

<p>Additional arguments to be passed to the generic methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The phylogenetic entropy is its generalization of HCDT entropy to unequal species distances (Pavoine et al., 2009).
</p>
<p>Calculation relies on <code><a href="#topic+Tsallis">Tsallis</a></code> and <code><a href="#topic+PhyloApply">PhyloApply</a></code>.
</p>
<p>Intervals separate two cuts in a tree: no node is found at heights contained in an interval.
</p>
<p>Bias correction requires the number of individuals to estimate sample <code><a href="#topic+Coverage">Coverage</a></code>. Use <code>bcPhyloEntropy</code> and choose the <code>Correction</code>.
</p>
<p>The functions are designed to be used as simply as possible. <code>PhyloEntropy</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcPhyloEntropy</code> is called. Explicit calls to <code>bcPhyloEntropy</code> (with bias correction) or to <code>PhyloEntropy.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<p>The size of a metacommunity (see <code><a href="#topic+MetaCommunity">MetaCommunity</a></code>) is unknown so it has to be set according to a rule which does not ensure that its abundances are integer values. Then, classical bias-correction methods do not apply. Providing the <code>SampleCoverage</code> argument allows applying the <code>"ChaoShen"</code> and <code>"Grassberger"</code> corrections to estimate quite well the entropy. <code><a href="#topic+DivPart">DivPart</a></code> and <code><a href="#topic+GammaEntropy">GammaEntropy</a></code> functions use this tweak.
</p>


<h3>Value</h3>

<p>An object of class <code>PhyloEntropy</code> is a list:
</p>
<table>
<tr><td><code>Distribution</code></td>
<td>
<p>The distribution used to calculate entropy</p>
</td></tr>
<tr><td><code>Function</code></td>
<td>
<p>The function used to calculate entropy</p>
</td></tr>
<tr><td><code>Tree</code></td>
<td>
<p>The functional or phylogenetic tree used to calculate entropy</p>
</td></tr>
<tr><td><code>Normalized</code></td>
<td>
<p>Logical. Indicates whether phyloentropy is normalized or proportional to the height of the tree.</p>
</td></tr>
<tr><td><code>Type</code></td>
<td>
<p>The type of entropy (&quot;alpha&quot;, &quot;beta&quot; or &quot;gamma&quot;).</p>
</td></tr>
<tr><td><code>Order</code></td>
<td>
<p>The order of entropy <code class="reqn">q</code>.</p>
</td></tr>
<tr><td><code>Cuts</code></td>
<td>
<p>A named vector containing values of neutral entropy along the tree. Names are cut ends, <em>i.e.</em> the ends of intervals (the first interval starts at 0 for leaves, the max value is the height of the tree).</p>
</td></tr>
<tr><td><code>Total</code></td>
<td>
<p>A value equal the total entropy multiplied by the tree height if <code>Normalize</code> is FALSE.</p>
</td></tr>
</table>
<p><code>is.PhyloEntropy</code> returns <code>TRUE</code> if the object is of class <code>PhyloEntropy</code>.
</p>
<p><code>summary.PhyloEntropy</code> returns a summary of the object's value.
</p>
<p><code>PhyloEntropy</code> objects can be plotted by <code><a href="#topic+plot.PhyloValue">plot.PhyloValue</a></code> because <code>PhyloEntropy</code> objects are also of class <code>PhyloValue</code>.
</p>


<h3>Note</h3>

<p>The tree must contain all species of the probability vector. If it contains extra species, computation time will just be increased.
</p>


<h3>References</h3>

<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p>Pavoine, S., Love, M. S. and Bonsall, M. B. (2009). Hierarchical partitioning of evolutionary and ecological patterns in the organization of phylogenetically-structured species assemblages: Application to rockfish (genus: Sebastes) in the Southern California Bight. <em>Ecology Letters</em> 12(9): 898-908.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Tsallis">Tsallis</a></code>, <code><a href="#topic+PhyloDiversity">PhyloDiversity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ps)
# Calculate the phylogenetic Shannon entropy of the plot
summary(PhyloEntropy(Ps, 1, Paracou618.Taxonomy) -&gt; e)
plot(e)

# Ns is the vector of abundances of the metacommunity
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Calculate the phylogenetic Shannon entropy of the plot
summary(bcPhyloEntropy(Ns, 1, Paracou618.Taxonomy, Correction = "Best") -&gt; e)
plot(e)
</code></pre>

<hr>
<h2 id='PhyloValue'>
Phylogenetic entropy or diversity.
</h2><span id='topic+PhyloValue'></span><span id='topic+is.PhyloValue'></span><span id='topic+autoplot.PhyloValue'></span><span id='topic+plot.PhyloValue'></span><span id='topic+summary.PhyloValue'></span>

<h3>Description</h3>

<p>Entropy or diversity against the height of the phylogenetic or functional tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.PhyloValue(x)
## S3 method for class 'PhyloValue'
autoplot(object, xlab = expression(italic("T")), ylab = NULL, main = NULL,
          col = ggplot2::GeomLine$default_aes$colour,
          lty = ggplot2::GeomLine$default_aes$linetype,
          lwd = ggplot2::GeomLine$default_aes$size,
          ...)
## S3 method for class 'PhyloValue'
plot(x, xlab = expression(italic("T")), ylab = NULL, main = NULL, ...)
## S3 method for class 'PhyloValue'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PhyloValue_+3A_x">x</code></td>
<td>

<p>An object of class <code>PhyloValue</code>, including <code><a href="#topic+PhyloDiversity">PhyloDiversity</a></code> and <code><a href="#topic+PhyloEntropy">PhyloEntropy</a></code> objects.
</p>
</td></tr>
<tr><td><code id="PhyloValue_+3A_xlab">xlab</code></td>
<td>

<p>The X axis label, &quot;T&quot; by default for Time.
</p>
</td></tr>
<tr><td><code id="PhyloValue_+3A_ylab">ylab</code></td>
<td>

<p>The Y axis label. if <code>NULL</code> (by default), &quot;Entropy&quot; or &quot;Diversity&quot; or nothing is chosen according to the object class.
</p>
</td></tr>
<tr><td><code id="PhyloValue_+3A_main">main</code></td>
<td>

<p>The main title of the plot. if <code>NULL</code> (by default), a default value is used.
</p>
</td></tr>
<tr><td><code id="PhyloValue_+3A_object">object</code></td>
<td>

<p>A <code>PhyloValue</code> object to be summarized.
</p>
</td></tr>
<tr><td><code id="PhyloValue_+3A_col">col</code></td>
<td>

<p>The color of the geom objects. See &quot;Color Specification&quot; in <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
<tr><td><code id="PhyloValue_+3A_lty">lty</code></td>
<td>

<p>The type of the lines. See <code><a href="graphics.html#topic+lines">lines</a></code>.
</p>
</td></tr>
<tr><td><code id="PhyloValue_+3A_lwd">lwd</code></td>
<td>

<p>The width of the lines. See <code><a href="graphics.html#topic+lines">lines</a></code>.
</p>
</td></tr>
<tr><td><code id="PhyloValue_+3A_...">...</code></td>
<td>

<p>Additional arguments to be passed to <code><a href="#topic+plot">plot</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>PhyloValue</code> objects are the result of <code><a href="#topic+PhyloApply">PhyloApply</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Calculate richness along the tree
# (Cuts are 1=species, 2=genus, 3=family)
summary(r &lt;- PhyloApply(Paracou618.Taxonomy, FUN=Richness,
  NorP=Paracou618.MC$Ns, Normalize=TRUE))
autoplot(r)
</code></pre>

<hr>
<h2 id='PPtree'>
Preprocessed Trees.
</h2><span id='topic+PPtree'></span><span id='topic+is.PPtree'></span><span id='topic+plot.PPtree'></span>

<h3>Description</h3>

<p>Methods for objects of type &quot;<code>PPtree</code>&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.PPtree(x)
## S3 method for class 'PPtree'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PPtree_+3A_x">x</code></td>
<td>

<p>An object to be tested or plotted
</p>
</td></tr>
<tr><td><code id="PPtree_+3A_...">...</code></td>
<td>

<p>Additional arguments to be passed to the generic methods.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <strong>PPtree</strong> is a list:
</p>
<table>
<tr><td><code>phyTree</code></td>
<td>
<p>A <code><a href="ape.html#topic+phylo">phylo</a></code> tree</p>
</td></tr>
<tr><td><code>hTree</code></td>
<td>
<p>A <code><a href="stats.html#topic+hclust">hclust</a></code> tree</p>
</td></tr>
<tr><td><code>Height</code></td>
<td>
<p>The height of the tree, that is to say the distance between root and leaves</p>
</td></tr>
<tr><td><code>Cuts</code></td>
<td>
<p>A vector. Cut times of the tree (the distance from nodes to leaves)</p>
</td></tr>
<tr><td><code>Intervals</code></td>
<td>
<p>A vector. The lengths of intervals between cuts</p>
</td></tr>
</table>
<p><code>is.PPtree</code> returns <code>TRUE</code> if the object is of class <code>PPtree</code>.
</p>
<p><code>plot.PPtree</code> plots it.
</p>


<h3>Note</h3>

<p>Versions up to 1.3 contained a <code><a href="ade4.html#topic+phylog">phylog</a></code> tree, now deprecated in <code>ade4</code>. A <code><a href="ape.html#topic+phylo">phylo</a></code> tree is now used.
</p>
<p>See the dedicated vignette (<code>vignette("Phylogenies", package="entropart")</code>) for more details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paracou618)
# Preprocess a phylog object
ppt &lt;- Preprocess.Tree(EightSpTree)
# Is it a preprocessed tree?
is.PPtree(ppt)
# Plot it
plot(ppt, hang=-1)
# Alternative plot
ade4::radial.phylog(EightSpTree)
</code></pre>

<hr>
<h2 id='Preprocess.MC'>
Preprocessing of metacommunity data
</h2><span id='topic+Preprocess.MC'></span>

<h3>Description</h3>

<p>Calculates summary statistics of a metacommunity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Preprocess.MC(Nsi, Wi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Preprocess.MC_+3A_nsi">Nsi</code></td>
<td>

<p>A matrix containing abundance data, species in line, communities in column.
</p>
</td></tr>
<tr><td><code id="Preprocess.MC_+3A_wi">Wi</code></td>
<td>

<p>Normalized community weights (sum to 1).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an internal function. It is used by <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> for real data and <code><a href="#topic+DivEst">DivEst</a></code> for simulations.
</p>


<h3>Value</h3>

<p>An object of class <strong>MetaCommunity</strong>. It is a list:
</p>
<table>
<tr><td><code>Nsi</code></td>
<td>
<p>A matrix containing abundance data, species in line, communities in column</p>
</td></tr>
<tr><td><code>Nspecies</code></td>
<td>
<p>The number of species</p>
</td></tr>
<tr><td><code>Ncommunities</code></td>
<td>
<p>The number of communities</p>
</td></tr>
<tr><td><code>Wi</code></td>
<td>
<p>Normalized community weights (sum to 1)</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>The total number of individuals</p>
</td></tr>
<tr><td><code>Ni</code></td>
<td>
<p>A vector containing the number of individuals of each community</p>
</td></tr>
<tr><td><code>Ns</code></td>
<td>
<p>A vector containing the number of individuals of each species</p>
</td></tr>
<tr><td><code>Psi</code></td>
<td>
<p>A matrix whose columns are the probability vectors of communities (each of them sums to 1)</p>
</td></tr>
<tr><td><code>Ps</code></td>
<td>
<p>A vector containing the probability vector of the metacommunity</p>
</td></tr>
<tr><td><code>SampleCoverage</code></td>
<td>
<p>The sample coverage of the metacommunity</p>
</td></tr>
<tr><td><code>SampleCoverage.communities</code></td>
<td>
<p>A vector containing the sample coverages of each community</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Eric Marcon &lt;Eric.Marcon@ecofog.gf&gt;
</p>

<hr>
<h2 id='Preprocess.Tree'>
Preprocessing of a phylogenetic tree
</h2><span id='topic+Preprocess.Tree'></span>

<h3>Description</h3>

<p>Calculates cuts and intervals of a phylogenetic tree and make it available both in <code><a href="stats.html#topic+hclust">hclust</a></code> and <code><a href="ape.html#topic+phylo">phylo</a></code> formats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Preprocess.Tree(Tree)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Preprocess.Tree_+3A_tree">Tree</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="ape.html#topic+phylo">phylo</a></code> or <code><a href="ade4.html#topic+phylog">phylog</a></code>. The tree must be ultrametric.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an internal function. It is used by <code><a href="#topic+PhyloApply">PhyloApply</a></code> to obtain values of intervals.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+PPtree">PPtree</a></code>.
</p>

<hr>
<h2 id='RAC'>
Fit Distributions to Well-Known Rank Abundance Curves.
</h2><span id='topic+RAClnorm'></span><span id='topic+RACgeom'></span><span id='topic+RAClseries'></span><span id='topic+RACbstick'></span>

<h3>Description</h3>

<p>Observed distributions are fitted to classical RAC's.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RAClnorm(Ns, CheckArguments = TRUE)
RACgeom(Ns, CheckArguments = TRUE)
RAClseries(Ns, CheckArguments = TRUE)
RACbstick(Ns, CheckArguments = TRUE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RAC_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td></tr>
<tr><td><code id="RAC_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>SpeciesDistribution</code> or integer vectors can be used to fit classical rank-abundance curves (RAC) of classical distributions: <code>"RAClnorm"</code> for log-normal (Preston, 1948), <code>"RAClseries"</code> for log-series (Fisher <em>et al.</em>, 1943), <code>"RACgeom"</code> for geometric (Motomura, 1932) or <code>"RACbstick"</code> for broken stick (MacArthur, 1957). 
method returns the estimated parameters of the fitted distribution. The broken stick has no parameter, so the maximum abundance is returned.
</p>


<h3>Value</h3>

<p>A list (the parameters of distributions are returned only if the distribution has been fit):
</p>
<table>
<tr><td><code>Rank</code></td>
<td>
<p>A numeric vector. The ranks of species in the fitted RAC.</p>
</td></tr>
<tr><td><code>Abundance</code></td>
<td>
<p>The abundance of species in the fitted RAC.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>The expectation of the log-normal distribution</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>The standard deviation of the log-normal distribution</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Fisher's alpha in the log-series distribution</p>
</td></tr>
<tr><td><code>prob</code></td>
<td>
<p>The proportion of ressources taken by successive species in the geometric distribution</p>
</td></tr>
<tr><td><code>max</code></td>
<td>
<p>The maximum abundance in the broken-stick distribution</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Fisher's alpha is estimated to fit the log-series distribution. The estimation is done by the <code><a href="vegan.html#topic+fisher.alpha">fisher.alpha</a></code> function of package <code>vegan</code>. It may differ substantially from the estimation returned by <code>optimal.theta</code> from package <code>untb</code>.
</p>


<h3>Author(s)</h3>

<p>Eric Marcon &lt;Eric.Marcon@agroparistech.fr&gt;, Bruno Herault &lt;Bruno.Herault@cirad.fr&gt;
</p>


<h3>References</h3>

<p>Fisher R.A., Corbet A.S., Williams C.B. (1943) The Relation Between the Number of Species and the Number of Individuals in a Random Sample of an Animal Population. <em>Journal of Animal Ecology</em> 12: 42-58.
</p>
<p>MacArthur R.H. (1957) On the Relative Abundance of Bird Species. <em>PNAS</em> 43(3): 293-295.
</p>
<p>Motomura I. (1932) On the statistical treatment of communities. <em>Zoological Magazine</em> 44: 379-383.
</p>
<p>Preston, F.W. (1948). The commonness, and rarity, of species. <em>Ecology</em> 29(3): 254-283.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rgeom">rgeom</a></code>, <code><a href="stats.html#topic+rlnorm">rlnorm</a></code>, <code><a href="#topic+rCommunity">rCommunity</a></code>, <code><a href="#topic+plot.SpeciesDistribution">plot.SpeciesDistribution</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Fitted parameters
RACln &lt;- RAClnorm(Ns)
RACln$mu
RACln$sigma
RACgeom(Ns)$prob
RAClseries(Ns)$alpha
RACbstick(Ns)$max
</code></pre>

<hr>
<h2 id='Rao'>
Rao Quadratic Entropy of a Community
</h2><span id='topic+Rao'></span><span id='topic+bcRao'></span><span id='topic+Rao.ProbaVector'></span><span id='topic+Rao.AbdVector'></span><span id='topic+Rao.integer'></span><span id='topic+Rao.numeric'></span>

<h3>Description</h3>

<p>Calculates Rao's quadratic entropy of a community described by a probability vector and a phylogenetic / functional tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rao(NorP, Tree, ...)
bcRao(Ns, Tree, Correction="Lande", CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
Rao(NorP, Tree, ..., CheckArguments = TRUE, Ps = NULL)
## S3 method for class 'AbdVector'
Rao(NorP, Tree, Correction = "Lande", ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'integer'
Rao(NorP, Tree, Correction = "Lande", ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'numeric'
Rao(NorP, Tree, Correction = "Lande", ..., 
  CheckArguments = TRUE, Ps = NULL, Ns = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rao_+3A_ps">Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td></tr>
<tr><td><code id="Rao_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td></tr>
<tr><td><code id="Rao_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities.
</p>
</td></tr>
<tr><td><code id="Rao_+3A_tree">Tree</code></td>
<td>

<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="ape.html#topic+phylo">phylo</a></code>, <code><a href="ade4.html#topic+phylog">phylog</a></code> or <code><a href="#topic+PPtree">PPtree</a></code>. The tree must be ultrametric.
</p>
</td></tr>
<tr><td><code id="Rao_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections accepted by <code><a href="#topic+bcTsallis">bcTsallis</a></code> or <code>"Lande"</code>, the default value (equivalent to <code>"Best"</code>).
</p>
</td></tr>
<tr><td><code id="Rao_+3A_...">...</code></td>
<td>

<p>Additional arguments. Unused.
</p>
</td></tr>
<tr><td><code id="Rao_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bias correction requires the number of individuals. Use <code>bcRao</code> and choose the <code>Correction</code>.
</p>
<p>The unbiased estimator of Rao's entropy is identical to that of Simpson's entropy because Rao's entropy is a linear sum of Simson entropies, all of them calculated from the same number of individuals (Marcon and Herault, 2014). It equals the plug-in etimator multiplied by n/(n-1) where n is the total number of individuals.
</p>
<p>The functions are designed to be used as simply as possible. <code>Tsallis</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcTsallis</code> is called. Explicit calls to <code>bcTsallis</code> (with bias correction) or to <code>Tsallis.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>


<h3>Value</h3>

<p>A named number equal to the calculated entropy. The name is that of the bias correction used.
</p>


<h3>References</h3>

<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p>Rao, C. R. (1982). Diversity and dissimilarity coefficients: a unified approach. <em>Theoretical Population Biology</em> 21: 24-43.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcPhyloDiversity">bcPhyloDiversity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Species probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ns)
# Calculate Rao's quadratic entropy of the plot
Rao(Ps, Paracou618.Taxonomy)
</code></pre>

<hr>
<h2 id='rCommunity'>
Random Communities
</h2><span id='topic+rCommunity'></span>

<h3>Description</h3>

<p>Draws random communities according to a probability distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rCommunity(n, size = sum(NorP), NorP = 1, BootstrapMethod = "Chao2015", S = 300, 
    Distribution = "lnorm",  sd = 1, prob = 0.1, alpha = 40,
    CheckArguments = TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rCommunity_+3A_n">n</code></td>
<td>

<p>The number of communities to draw.
</p>
</td></tr>
<tr><td><code id="rCommunity_+3A_size">size</code></td>
<td>

<p>The number of individuals to draw in each community.
</p>
</td></tr>
<tr><td><code id="rCommunity_+3A_bootstrapmethod">BootstrapMethod</code></td>
<td>

<p>The method used to obtain the probabilities to generate bootstrapped communities from observed abundances. If <code>"Marcon"</code>, the probabilities are simply the abundances divided by the total number of individuals (Marcon <em>et al.</em>, 2012). If <code>"Chao2013"</code> or <code>"Chao2015"</code> (by default), a more sophisticated approach is used (see <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>) following Chao <em>et al.</em> (2013) or Chao <em>et al.</em> (2015).
</p>
</td></tr>
<tr><td><code id="rCommunity_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector. Contains either abundances or probabilities.
</p>
</td></tr>
<tr><td><code id="rCommunity_+3A_s">S</code></td>
<td>

<p>The number of species.
</p>
</td></tr>
<tr><td><code id="rCommunity_+3A_distribution">Distribution</code></td>
<td>

<p>The distribution of species frequencies. May be <code>"lnorm"</code> (log-normal), <code>"lseries"</code> (log-series), <code>"geom"</code> (geometric) or <code>"bstick"</code> (broken stick).
</p>
</td></tr>
<tr><td><code id="rCommunity_+3A_sd">sd</code></td>
<td>

<p>The simulated distribution standard deviation. For the log-normal distribution, this is the standard deviation on the log scale.
</p>
</td></tr>
<tr><td><code id="rCommunity_+3A_prob">prob</code></td>
<td>

<p>The proportion of ressources taken by successive species.
</p>
</td></tr>
<tr><td><code id="rCommunity_+3A_alpha">alpha</code></td>
<td>

<p>Fisher's alpha.
</p>
</td></tr>
<tr><td><code id="rCommunity_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Communities of fixed <code>size</code> are drawn in a multinomial distribution according to the distribution of probabilities provided by <code>NorP</code>.
</p>
<p>An abundance vector may be used instead of probabilities, then <code>size</code> is by default the total number of individuals in the vector. Random communities are built by drawing in a multinomial law following Marcon <em>et al.</em> (2012), or trying to estimate the distribution of the actual community with <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>. If <code>BootstrapMethod =  "Chao2013"</code>, the distribution is estimated by a single parameter model and unobserved species are given equal probabilities. If <code>BootstrapMethod =  "Chao2015"</code>, a two-parameter model is used and unobserved species follow a geometric distribution.
</p>
<p>Alternatively, the probabilities may be drawn following a classical distribution: either a lognormal (<code>"lnorm"</code>) one (Preston, 1948) with given standard deviation (<code>sd</code>; note that the mean is actually a normalizing constant. Its values is set equal to 0 for the simulation of the normal distribution of unnormalized log-abundances), a log-series (<code>"lseries"</code>) one (Fisher <em>et al.</em>, 1943) with parameter <code>alpha</code>, a geometric (<code>"geom"</code>) one (Motomura, 1932) with parameter <code>prob</code>, or a broken stick (<code>"bstick"</code>) one (MacArthur, 1957). The number of simulated species is fixed by <code>S</code>, except for <code>"lseries"</code> where it is obtained from <code>alpha</code> and <code>size</code>: <code class="reqn">S=\alpha \ln(1 + \frac{size}{\alpha})</code>.
</p>
<p>Log-normal, log-series and broken-stick distributions are stochastic. The geometric distribution is completely determined by its parameters.
</p>


<h3>Value</h3>

<p>A vector of species abundances (<code><a href="#topic+AbdVector">AbdVector</a></code>) if a single community has been drawn, or a <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> containing simulated communities.
</p>


<h3>References</h3>

<p>Chao, A., Wang, Y. T. and Jost, L. (2013). Entropy and the species accumulation curve: a novel entropy estimator via discovery rates of new species. <em>Methods in Ecology and Evolution</em> 4(11): 1091-1100.
</p>
<p>Chao, A., Hsieh, T. C., Chazdon, R. L., Colwell, R. K., Gotelli, N. J. (2015) Unveiling the Species-Rank Abundance Distribution by Generalizing Good-Turing Sample Coverage Theory. <em>Ecology</em> 96(5): 1189-1201.
</p>
<p>Fisher R.A., Corbet A.S., Williams C.B. (1943) The Relation Between the Number of Species and the Number of Individuals in a Random Sample of an Animal Population. <em>Journal of Animal Ecology</em> 12: 42-58.
</p>
<p>MacArthur R.H. (1957) On the Relative Abundance of Bird Species. <em>PNAS</em> 43(3): 293-295.
</p>
<p>Marcon, E., Herault, B., Baraloto, C. and Lang, G. (2012). The Decomposition of Shannon's Entropy and a Confidence Interval for Beta Diversity. <em>Oikos</em> 121(4): 516-522.
</p>
<p>Motomura I. (1932) On the statistical treatment of communities. <em>Zoological Magazine</em> 44: 379-383.
</p>
<p>Preston, F.W. (1948). The commonness, and rarity, of species. <em>Ecology</em> 29(3): 254-283.
</p>
<p>Reese G. C., Wilson K. R., Flather C. H. (2013) Program SimAssem: Software for simulating species assemblages and estimating species richness. <em>Methods in Ecology and  Evolution</em> 4: 891-896.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SpeciesDistribution">SpeciesDistribution</a></code> and the program <code>SimAssem</code> (Reese <em>et al.</em>, 2013; not an R package) for more distributions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate communities made of 100000 individuals among 300 species and fit them
par(mfrow = c(2,2))
for (d in c("lnorm", "lseries", "geom", "bstick")) {  
rCommunity(n = 1, size = 1E5, S = 300, Distribution = d) -&gt; AbdVec
plot(AbdVec, Distribution = d, main = d)
}
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+autoplot'></span><span id='topic+plot'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>ggplot2</dt><dd><p><code><a href="ggplot2.html#topic+autoplot">autoplot</a></code></p>
</dd>
<dt>graphics</dt><dd><p><code><a href="graphics.html#topic+plot.default">plot</a></code></p>
</dd>
</dl>

<hr>
<h2 id='Richness'>
Number of species of a community
</h2><span id='topic+bcRichness'></span><span id='topic+Richness'></span><span id='topic+Richness.ProbaVector'></span><span id='topic+Richness.AbdVector'></span><span id='topic+Richness.integer'></span><span id='topic+Richness.numeric'></span>

<h3>Description</h3>

<p>Calculates the number of species from probability vector.  The name is that of the estimator (the bias correction) used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Richness(NorP, ...)
bcRichness(Ns, Correction = "Best", Alpha = 0.05, JackOver = FALSE, JackMax = 10, 
              CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
Richness(NorP, ..., CheckArguments = TRUE, Ps = NULL)
## S3 method for class 'AbdVector'
Richness(NorP, Correction = "Best", Alpha = 0.05, 
  JackOver = FALSE, JackMax = 10, 
  Level = NULL, PCorrection = "Chao2015", Unveiling = "geom", RCorrection = "Rarefy",
  ..., CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'integer'
Richness(NorP, Correction = "Best", Alpha = 0.05, 
  JackOver = FALSE, JackMax = 10, 
  Level = NULL, PCorrection = "Chao2015", Unveiling = "geom", RCorrection = "Rarefy",
  ..., CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'numeric'
Richness(NorP, Correction = "Best", Alpha = 0.05, 
  JackOver = FALSE, JackMax = 10, 
  Level = NULL, PCorrection = "Chao2015", Unveiling = "geom", RCorrection = "Rarefy",
  ..., CheckArguments = TRUE, Ps = NULL, Ns = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Richness_+3A_ps">Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td></tr>
<tr><td><code id="Richness_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td></tr>
<tr><td><code id="Richness_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities.
</p>
</td></tr>
<tr><td><code id="Richness_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections: <code>"None"</code> (no correction), <code>"Jackknife"</code>, <code>"iChao1"</code>, or <code>"Chao1"</code>. <code>"Best"</code>, the default value, is currently <code>"Jackknife"</code>. Ignored by richness interpolation, and by extrapolation if <code>PCorrection</code> is not &quot;None&quot;.
</p>
</td></tr>
<tr><td><code id="Richness_+3A_alpha">Alpha</code></td>
<td>

<p>The risk level, 5% by default, used to optimize the jackknife order.
</p>
</td></tr>
<tr><td><code id="Richness_+3A_jackover">JackOver</code></td>
<td>

<p>If <code>TRUE</code>, retain the jackknife order immediately superior to the optimal one, usually resulting in the overestimation of the number of species. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Richness_+3A_jackmax">JackMax</code></td>
<td>

<p>The highest jackknife order allowed. Default is 10. Allowed values are between 1 and 10.
</p>
</td></tr>
<tr><td><code id="Richness_+3A_level">Level</code></td>
<td>

<p>The level of interpolation or extrapolation. It may be an a chosen sample size (an integer) or a sample coverage (a number between 0 and 1). Richness extrapolation require its asymptotic estimation depending on the choice of <code>Correction</code>.
</p>
</td></tr>
<tr><td><code id="Richness_+3A_pcorrection">PCorrection</code></td>
<td>

<p>A string containing one of the possible corrections to estimate a probability distribution in <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>: <code>"Chao2015"</code> is the default value. If &quot;None&quot;, the asymptotic distribution is not estimated and extrapolation relies only on the asymptotic estimator of richness. Used only for extrapolation.
</p>
</td></tr>
<tr><td><code id="Richness_+3A_unveiling">Unveiling</code></td>
<td>

<p>A string containing one of the possible unveiling methods to estimate the probabilities of the unobserved species in <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>: <code>"geom"</code> (the unobserved species distribution is geometric) is the default value. Used only for extrapolation.
</p>
</td></tr>
<tr><td><code id="Richness_+3A_rcorrection">RCorrection</code></td>
<td>

<p>A string containing a correction recognized by <code><a href="#topic+Richness">Richness</a></code> to evaluate the total number of species in <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>. <code>"Rarefy"</code> is the default value to estimate the number of species such that the entropy of the asymptotic distribution rarefied to the observed sample size equals the observed entropy of the data. Used only for extrapolation.
</p>
</td></tr>
<tr><td><code id="Richness_+3A_...">...</code></td>
<td>

<p>Additional arguments. Unused.
</p>
</td></tr>
<tr><td><code id="Richness_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bias correction requires the number of individuals. Use <code>bcRichness</code> and choose the <code>Correction</code>.
</p>
<p>Chao correction techniques are from Chao (1984) and Chiu <em>et al.</em> (2015). The Jackknife estimator is calculated by a straight adaptation of the code by Ji-Ping Wang (<code>jackknife</code> in CRAN-archived package <code>SPECIES</code>). The optimal order is selected according to Burnham and Overton (1978; 1979). The argument <code>JackOver</code> allows selecting one order over the optimal one.
Many other estimators are available elsewhere, the ones implemented here are necessary for other entropy estimations.
</p>
<p>The functions are designed to be used as simply as possible. <code>Richness</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcRichness</code> is called.
</p>
<p>Richness can be estimated at a specified level of interpolation or extrapolation, either a chosen sample size or sample coverage (Chao et al., 2014), rather than its asymptotic value.
Extrapolation relies on the estimation of the asymptotic richness. If <code>PCorrection</code> is &quot;None&quot;, then the asymptotic estimation of richness is made using the chosen <code>Correction</code>, else the asymtpotic distribution of the community is derived and its estimated richness adjusted so that the entropy of a sample of this distribution of the size of the actual sample has the entropy of the actual sample.
</p>


<h3>Value</h3>

<p>A named number equal to the estimated number of species.
The name is the <code>Correction</code>, except for &quot;SAC&quot; (Species Accumulation Curve) for interpolation.
</p>


<h3>References</h3>

<p>Burnham, K. P., and Overton,W. S. (1978), Estimation of the Size of a Closed Population When Capture Probabilities Vary Among Animals. <em>Biometrika</em>, 65: 625-633.
</p>
<p>Burnham, K. P., and Overton,W. S. (1979), Robust Estimation of Population Size When Capture Probabilities Vary Among Animals. <em>Ecology</em> 60:927-936.
</p>
<p>Chao, A. (1984) Nonparametric estimation of the number of classes in a population. <em>Scandinavian Journal of Statistics</em> 11: 265-270.
</p>
<p>Chao, A., Gotelli, N. J., Hsieh, T. C., Sander, E. L., Ma, K. H., Colwell, R. K., Ellison, A. M (2014). Rarefaction and extrapolation with Hill numbers: A framework for sampling and estimation in species diversity studies.  <em>Ecological Monographs</em>, 84(1): 45-67.
</p>
<p>Chiu, C.-H., Wang, Y.-T., Walther, B. A., Chao, A. (2014) An Improved Nonparametric Lower Bound of Species Richness via a Modified Good-Turing Frequency Formula. <em>Biometrics</em> 70(3): 671-682.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Species probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ns)
# Whittaker plot
plot(Ns)

# Number of observed species
Richness(Ps)
# Estimate the actual number of species
bcRichness(Ns, Correction = "Chao1")
bcRichness(Ns, Correction = "iChao1")
bcRichness(Ns, Correction = "Jackknife")
bcRichness(Ns, Correction = "Jackknife", JackOver=TRUE)
</code></pre>

<hr>
<h2 id='Shannon'>
Shannon entropy of a community
</h2><span id='topic+bcShannon'></span><span id='topic+Shannon'></span><span id='topic+Shannon.ProbaVector'></span><span id='topic+Shannon.AbdVector'></span><span id='topic+Shannon.integer'></span><span id='topic+Shannon.numeric'></span>

<h3>Description</h3>

<p>Calculates the Shannon entropy of a probability vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Shannon(NorP, ...)
bcShannon(Ns, Correction = "Best", CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
Shannon(NorP, ..., CheckArguments = TRUE, Ps = NULL)
## S3 method for class 'AbdVector'
Shannon(NorP, Correction = "Best", Level = NULL,
  PCorrection = "Chao2015", Unveiling = "geom", RCorrection = "Rarefy", ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'integer'
Shannon(NorP, Correction = "Best", Level = NULL,
  PCorrection = "Chao2015", Unveiling = "geom", RCorrection = "Rarefy", ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'numeric'
Shannon(NorP, Correction = "Best", Level = NULL, 
  PCorrection = "Chao2015", Unveiling = "geom", RCorrection = "Rarefy", ..., 
  CheckArguments = TRUE, Ps = NULL, Ns = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Shannon_+3A_ps">Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td></tr>
<tr><td><code id="Shannon_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td></tr>
<tr><td><code id="Shannon_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities.
</p>
</td></tr>
<tr><td><code id="Shannon_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible asymptotic estimators: <code>"None"</code> (no correction), <code>"ChaoShen"</code>, <code>"GenCov"</code>, <code>"Grassberger"</code>, <code>"Grassberger2003"</code>, <code>"Schurmann"</code>, <code>"Holste"</code>, <code>"Bonachela"</code>, <code>"Miller"</code>, <code>"ZhangHz"</code>, <code>"ChaoJost"</code>, <code>"Marcon"</code>, <code>"UnveilC"</code>, <code>"UnveiliC"</code>, <code>"UnveilJ"</code> or <code>"Best"</code>, the default value. Currently, <code>"Best"</code> is <code>"UnveilJ"</code>.
</p>
</td></tr>
<tr><td><code id="Shannon_+3A_level">Level</code></td>
<td>

<p>The level of interpolation or extrapolation. It may be an a chosen sample size (an integer) or a sample coverage (a number between 0 and 1). Entropy extrapolation require its asymptotic estimation depending on the choice of <code>Correction</code>. Entropy interpolation relies on the estimation of Abundance Frequence Counts: then, <code>Correction</code> is passed to <code><a href="#topic+AbdFreqCount">AbdFreqCount</a></code> as its <code>Estimator</code> argument.
</p>
</td></tr>
<tr><td><code id="Shannon_+3A_pcorrection">PCorrection</code></td>
<td>

<p>A string containing one of the possible corrections to estimate a probability distribution in <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>: <code>"Chao2015"</code> is the default value. Used only for extrapolation.
</p>
</td></tr>
<tr><td><code id="Shannon_+3A_unveiling">Unveiling</code></td>
<td>

<p>A string containing one of the possible unveiling methods to estimate the probabilities of the unobserved species in <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>: <code>"geom"</code> (the unobserved species distribution is geometric) is the default value. If <code>"None"</code>, the asymptotic distribution is not unveiled and only the asymptotic estimator is used. Used only for extrapolation.
</p>
</td></tr>
<tr><td><code id="Shannon_+3A_rcorrection">RCorrection</code></td>
<td>

<p>A string containing a correction recognized by <code><a href="#topic+Richness">Richness</a></code> to evaluate the total number of species in <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>. <code>"Rarefy"</code> is the default value to estimate the number of species such that the entropy of the asymptotic distribution rarefied to the observed sample size equals the observed entropy of the data. Used only for extrapolation.
</p>
</td></tr>
<tr><td><code id="Shannon_+3A_...">...</code></td>
<td>

<p>Additional arguments. Unused.
</p>
</td></tr>
<tr><td><code id="Shannon_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bias correction requires the number of individuals to estimate sample <code><a href="#topic+Coverage">Coverage</a></code>.
</p>
<p>Correction techniques are from Miller (1955), Chao and Shen (2003), Grassberger (1988), Grassberger (2003), Schurmann (2003), Holste <em>et al.</em> (1998), Bonachela <em>et al.</em> (2008), Zhang (2012), Chao, Wang  and Jost (2013). 
More estimators can be found in the <code>entropy</code> package.
</p>
<p>Using <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> mutual information, Chao, Wang and Jost (2013) calculate reduced-bias Shannon beta entropy (see the last example below) with better results than the Chao and Shen estimator, but community weights cannot be arbitrary: they must be proportional to the number of individuals.
</p>
<p>The functions are designed to be used as simply as possible. <code>Shannon</code> is a generic method. 
If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcShannon</code> is called.
</p>
<p>Entropy can be estimated at a specified level of interpolation or extrapolation, either a chosen sample size or sample coverage (Chao et al., 2014), rather than its asymptotic value.
Extrapolation relies on the estimation of the asymptotic entropy. If <code>Unveiling</code> is &quot;None&quot;, then the asymptotic estimation of entropy is made using the chosen <code>Correction</code>, else the asymtpotic distribution of the community is derived and its estimated richness adjusted so that the entropy of a sample of this distribution of the size of the actual sample has the entropy of the actual sample.
</p>


<h3>Value</h3>

<p>A named number equal to the calculated entropy. The name is that of the bias correction used.
</p>


<h3>References</h3>

<p>Bonachela, J. A., Hinrichsen, H. and Munoz, M. A. (2008). Entropy estimates of small data sets. <em>Journal of Physics A: Mathematical and Theoretical</em> 41(202001): 1-9.
</p>
<p>Chao, A. and Shen, T. J. (2003). Nonparametric estimation of Shannon's index of diversity when there are unseen species in sample. <em>Environmental and Ecological Statistics</em> 10(4): 429-443.
</p>
<p>Chao, A., Wang, Y. T. and Jost, L. (2013). Entropy and the species accumulation curve: a novel entropy estimator via discovery rates of new species. <em>Methods in Ecology and Evolution</em> 4(11):1091-1100.
</p>
<p>Chao, A., Gotelli, N. J., Hsieh, T. C., Sander, E. L., Ma, K. H., Colwell, R. K., Ellison, A. M (2014). Rarefaction and extrapolation with Hill numbers: A framework for sampling and estimation in species diversity studies.  <em>Ecological Monographs</em>, 84(1): 45-67.
</p>
<p>Grassberger, P. (1988). Finite sample corrections to entropy and dimension estimates. <em>Physics Letters A</em> 128(6-7): 369-373.
</p>
<p>Grassberger, P. (2003). Entropy Estimates from Insufficient Samplings. <em>ArXiv Physics e-prints</em> 0307138.
</p>
<p>Holste, D., Grosse, I. and Herzel, H. (1998). Bayes' estimators of generalized entropies. <em>Journal of Physics A: Mathematical and General</em> 31(11): 2551-2566.
</p>
<p>Miller, G. (1955) Note on the bias of information estimates. In: Quastler, H., editor. <em>Information Theory in Psychology: Problems and Methods</em>: 95-100.
</p>
<p>Shannon, C. E. (1948). A Mathematical Theory of Communication. <em>The Bell System Technical Journal</em> 27: 379-423, 623-656.
</p>
<p>Schurmann, T. (2004). Bias analysis in entropy estimation. <em>Journal of Physics A: Mathematical and Theoretical</em> 37(27): L295-L301.
</p>
<p>Tsallis, C. (1988). Possible generalization of Boltzmann-Gibbs statistics. <em>Journal of Statistical Physics</em> 52(1): 479-487.
</p>
<p>Zhang, Z. (2012). Entropy Estimation in Turing's Perspective. <em>Neural Computation</em> 24(5): 1368-1389.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcShannon">bcShannon</a></code>, <code><a href="#topic+Tsallis">Tsallis</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Species probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ns)
# Whittaker plot
plot(Ns)

# Calculate Shannon entropy
Shannon(Ps)

# Calculate the best estimator of Shannon entropy
Shannon(Ns)

# Use metacommunity data to calculate reduced-bias Shannon beta as mutual information
(bcShannon(Paracou618.MC$Ns) + bcShannon(colSums(Paracou618.MC$Nsi))
- bcShannon(Paracou618.MC$Nsi))
</code></pre>

<hr>
<h2 id='ShannonBeta'>
Shannon beta entropy of a community
</h2><span id='topic+ShannonBeta'></span><span id='topic+bcShannonBeta'></span><span id='topic+ShannonBeta.ProbaVector'></span><span id='topic+ShannonBeta.AbdVector'></span><span id='topic+ShannonBeta.integer'></span><span id='topic+ShannonBeta.numeric'></span>

<h3>Description</h3>

<p>Calculates the Shannon beta entropy of a community belonging to a metacommunity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ShannonBeta(NorP, NorPexp = NULL, ...)
bcShannonBeta(Ns, Nexp, Correction = "Best", CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
ShannonBeta(NorP, NorPexp = NULL, ..., 
  CheckArguments = TRUE, Ps = NULL, Pexp = NULL)
## S3 method for class 'AbdVector'
ShannonBeta(NorP, NorPexp = NULL, Correction = "Best", ...,
  CheckArguments = TRUE, Ns = NULL, Nexp = NULL)
## S3 method for class 'integer'
ShannonBeta(NorP, NorPexp = NULL, Correction = "Best", ...,
  CheckArguments = TRUE, Ns = NULL, Nexp = NULL)
## S3 method for class 'numeric'
ShannonBeta(NorP, NorPexp = NULL, Correction = "Best", ...,
  CheckArguments = TRUE, Ps = NULL, Ns = NULL, Pexp = NULL, Nexp = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ShannonBeta_+3A_ps">Ps</code></td>
<td>

<p>The probability vector of species of the community.
</p>
</td></tr>
<tr><td><code id="ShannonBeta_+3A_pexp">Pexp</code></td>
<td>

<p>The probability vector of species of the metacommunity.
</p>
</td></tr>
<tr><td><code id="ShannonBeta_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances of the community.
</p>
</td></tr>
<tr><td><code id="ShannonBeta_+3A_nexp">Nexp</code></td>
<td>

<p>A numeric vector containing species abundances of the metacommunity.
</p>
</td></tr>
<tr><td><code id="ShannonBeta_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities of the community.
</p>
</td></tr>
<tr><td><code id="ShannonBeta_+3A_norpexp">NorPexp</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities of the metacommunity.
</p>
</td></tr>
<tr><td><code id="ShannonBeta_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections: currently, <code>"ChaoShen"</code> (Marcon <em>et al.</em>, 2012) equivalent to <code>"Best"</code>, and <code>"ZhangGrabchak"</code> (Zhang and Grabchak, 2014).
</p>
</td></tr>
<tr><td><code id="ShannonBeta_+3A_...">...</code></td>
<td>

<p>Additional arguments. Unused.
</p>
</td></tr>
<tr><td><code id="ShannonBeta_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The derivation of Shannon beta entropy can be found in Marcon <em>et al.</em> (2012).
</p>
<p>Bias correction requires the number of individuals to estimate sample <code><a href="#topic+Coverage">Coverage</a></code>. Use <code>bcShannonBeta</code> and choose the <code>Correction</code>.
</p>
<p>The functions are designed to be used as simply as possible. <code>ShannonBeta</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcShannonBeta</code> is called. Explicit calls to <code>bcShannonBeta</code> (with bias correction) or to <code>ShannonBeta.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>


<h3>Value</h3>

<p>A number equal to the calculated entropy.
</p>


<h3>References</h3>

<p>Marcon, E., Herault, B., Baraloto, C. and Lang, G. (2012). The Decomposition of Shannon's Entropy and a Confidence Interval for Beta Diversity. <em>Oikos</em> 121(4): 516-522.
</p>
<p>Zhang, Z. and Grabchak M. (2014). Nonparametric Estimation of Kullback-Leibler Divergence. <em>Neural computation</em> 26(11): 2570-2593.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcShannonBeta">bcShannonBeta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ps)
# Probability distribution of the first plot
Ps1 &lt;- as.ProbaVector(Paracou618.MC$Psi[, 1])
# Shannon beta entropy of the plot
ShannonBeta(Ps1, Ps)

# Ns is the vector of abundances of the metacommunity
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Abundances in the first plot
Ns1 &lt;- as.AbdVector(Paracou618.MC$Nsi[, 1])
# Reduced-bias estimator of Shannon beta entropy of the plot
bcShannonBeta(Ns1, Ns)
</code></pre>

<hr>
<h2 id='Simpson'>
Simpson entropy of a community
</h2><span id='topic+Simpson'></span><span id='topic+bcSimpson'></span><span id='topic+Simpson.ProbaVector'></span><span id='topic+Simpson.AbdVector'></span><span id='topic+Simpson.integer'></span><span id='topic+Simpson.numeric'></span>

<h3>Description</h3>

<p>Calculates the Simpson entropy of a probability vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Simpson(NorP, ...)
bcSimpson(Ns, Correction = "Best", CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
Simpson(NorP, ..., CheckArguments = TRUE, 
  Ps = NULL)
## S3 method for class 'AbdVector'
Simpson(NorP, Correction="Best", Level = NULL, ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'integer'
Simpson(NorP, Correction="Best", Level = NULL, ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'numeric'
Simpson(NorP, Correction="Best", Level = NULL, ..., 
  CheckArguments = TRUE, Ps = NULL, Ns = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Simpson_+3A_ps">Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td></tr>
<tr><td><code id="Simpson_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td></tr>
<tr><td><code id="Simpson_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities.
</p>
</td></tr>
<tr><td><code id="Simpson_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections accepted by <code><a href="#topic+bcTsallis">bcTsallis</a></code> or <code>"Lande"</code>. <code>"Best"</code>, the default value, is currently <code>"Jackknife"</code>. Ignored by interpolation and extrapolation.
</p>
</td></tr>
<tr><td><code id="Simpson_+3A_level">Level</code></td>
<td>

<p>The level of interpolation or extrapolation. It may be an a chosen sample size (an integer) or a sample coverage (a number between 0 and 1).
</p>
</td></tr>
<tr><td><code id="Simpson_+3A_...">...</code></td>
<td>

<p>Additional arguments. Unused.
</p>
</td></tr>
<tr><td><code id="Simpson_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Lande's correction has been derived (Lande, 1996; Good, 1953) especially for Simpson entropy, while other corrections are for generalized Tsallis entropy. It is identical to the unbiased estimator proposed by Simpson, although arguments were different. It equals the plug-in etimator multiplied by n/(n-1) where n is the total number of individuals.
</p>
<p>Bias correction requires the number of individuals to estimate sample <code><a href="#topic+Coverage">Coverage</a></code>.
</p>
<p>The functions are designed to be used as simply as possible. <code>Simpson</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcSimpson</code> is called.
</p>
<p>Entropy can be estimated at a specified level of interpolation or extrapolation, either a chosen sample size or sample coverage (Chao et al., 2014), rather than its asymptotic value. Simpson's extrapolated entropy estimator does not rely on the estimation of the asymptotic distribution.
</p>


<h3>Value</h3>

<p>A named number equal to the calculated entropy. The name is that of the bias correction used.
</p>


<h3>References</h3>

<p>Chao, A., Gotelli, N. J., Hsieh, T. C., Sander, E. L., Ma, K. H., Colwell, R. K., Ellison, A. M (2014). Rarefaction and extrapolation with Hill numbers: A framework for sampling and estimation in species diversity studies.  <em>Ecological Monographs</em>, 84(1): 45-67.
</p>
<p>Good, I. J. (1953). On the Population Frequency of Species and the Estimation of Population Parameters. <em>Biometrika</em> 40(3/4): 237-264.
</p>
<p>Lande, R. (1996). Statistics and partitioning of species diversity, and similarity among multiple communities. <em>Oikos</em> 76: 5-13.
</p>
<p>Simpson, E. H. (1949). Measurement of diversity. <em>Nature</em> 163(4148): 688.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Tsallis">Tsallis</a></code>, <code><a href="#topic+bcSimpson">bcSimpson</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Whittaker plot
plot(Ns)

# Calculate an unbiased estimator of Simpson's index of diversity
Simpson(Ns)
</code></pre>

<hr>
<h2 id='SimpsonBeta'>
Simpson beta entropy of a community
</h2><span id='topic+SimpsonBeta'></span><span id='topic+bcSimpsonBeta'></span><span id='topic+SimpsonBeta.ProbaVector'></span><span id='topic+SimpsonBeta.AbdVector'></span><span id='topic+SimpsonBeta.integer'></span><span id='topic+SimpsonBeta.numeric'></span>

<h3>Description</h3>

<p>Calculates the Simpson beta entropy of a community belonging to a metacommunity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimpsonBeta(NorP, NorPexp = NULL, ...)
bcSimpsonBeta(Ns, Nexp, Correction = "Best", CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
SimpsonBeta(NorP, NorPexp = NULL, ..., 
  CheckArguments = TRUE, Ps = NULL, Pexp = NULL)
## S3 method for class 'AbdVector'
SimpsonBeta(NorP, NorPexp = NULL, Correction = "Best", ..., 
  CheckArguments = TRUE, Ns = NULL, Nexp = NULL)
## S3 method for class 'integer'
SimpsonBeta(NorP, NorPexp = NULL, Correction = "Best", ..., 
  CheckArguments = TRUE, Ns = NULL, Nexp = NULL)
## S3 method for class 'numeric'
SimpsonBeta(NorP, NorPexp = NULL, Correction = "Best", ..., 
  CheckArguments = TRUE, Ps = NULL, Ns = NULL, Pexp = NULL, Nexp = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimpsonBeta_+3A_ps">Ps</code></td>
<td>

<p>The probability vector of species of the community.
</p>
</td></tr>
<tr><td><code id="SimpsonBeta_+3A_pexp">Pexp</code></td>
<td>

<p>The probability vector of species of the metacommunity.
</p>
</td></tr>
<tr><td><code id="SimpsonBeta_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances of the community.
</p>
</td></tr>
<tr><td><code id="SimpsonBeta_+3A_nexp">Nexp</code></td>
<td>

<p>A numeric vector containing species abundances of the metacommunity.
</p>
</td></tr>
<tr><td><code id="SimpsonBeta_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities of the community.
</p>
</td></tr>
<tr><td><code id="SimpsonBeta_+3A_norpexp">NorPexp</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities of the metacommunity.
</p>
</td></tr>
<tr><td><code id="SimpsonBeta_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections: currently, only <code>"ChaoShen"</code>, identical to <code>"Best"</code>.
</p>
</td></tr>
<tr><td><code id="SimpsonBeta_+3A_...">...</code></td>
<td>

<p>Additional arguments. Unused.
</p>
</td></tr>
<tr><td><code id="SimpsonBeta_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The derivation of Tsallis beta entropy (Simpson is Tsallis of order 2) can be found in Marcon et al. (2014).
</p>
<p>Bias correction requires the number of individuals to estimate sample <code><a href="#topic+Coverage">Coverage</a></code>. Use <code>bcSimpsonBeta</code> and choose the <code>Correction</code>.
</p>
<p>Note that Simpson beta entropy value is related to Simpson alpha entropy value and cannot be compared accross communities (Jost, 2007). Beta entropy of a community is not meaningful in general, do rather calculate the <code><a href="#topic+BetaDiversity">BetaDiversity</a></code> of order 2 of the metacommunity.
</p>
<p>The functions are designed to be used as simply as possible. <code>SimpsonBeta</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcSimpsonBeta</code> is called. Explicit calls to <code>bcSimpsonBeta</code> (with bias correction) or to <code>SimpsonBeta.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>


<h3>Value</h3>

<p>A named number equal to the calculated entropy. The name is that of the bias correction used.
</p>


<h3>References</h3>

<p>Jost (2007), Partitioning diversity into independent alpha and beta components. <em>Ecology</em> 88(10): 2427-2439.
</p>
<p>Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Simpson">Simpson</a></code>, <code><a href="#topic+bcSimpsonBeta">bcSimpsonBeta</a></code>, <code><a href="#topic+BetaDiversity">BetaDiversity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ps)
# Probability distribution of the first plot
Ps1 &lt;- as.ProbaVector(Paracou618.MC$Psi[, 1])

# Simpson beta entropy of the plot
SimpsonBeta(Ps1, Ps)
# Transform into diversity
expq(SimpsonBeta(Ps1, Ps)/(1-Simpson(Ps1)), 2)

# Ns is the vector of abundances of the metacommunity
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Abundances in the first plot
Ns1 &lt;- as.AbdVector(Paracou618.MC$Nsi[, 1])
# Reduced-bias Shannon beta entropy of the plot
bcSimpsonBeta(Ns1, Ns)
</code></pre>

<hr>
<h2 id='SimTest'>
SimTest class
</h2><span id='topic+SimTest'></span><span id='topic+as.SimTest'></span><span id='topic+is.SimTest'></span><span id='topic+autoplot.SimTest'></span><span id='topic+plot.SimTest'></span><span id='topic+summary.SimTest'></span>

<h3>Description</h3>

<p>Methods for objects of type &quot;<code>SimTest</code>&quot;, used to test a value against its distribution under a simulated null hypothesis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.SimTest(RealValue, SimulatedValues)
is.SimTest(x)
## S3 method for class 'SimTest'
autoplot(object, Quantiles = c(0.025, 0.975), ...,
  colValue = "red", colQuantiles = "black", ltyQuantiles = 2,
  main = NULL, xlab = "Simulated Values", ylab = "Density")
## S3 method for class 'SimTest'
plot(x, Quantiles = c(0.025, 0.975), ...,
  colValue = "red", lwdValue = 2, ltyValue = 2,
  colQuantiles = "black", lwdQuantiles = 1, ltyQuantiles = 2,
  main = NULL, xlab = "Simulated Values", ylab = "Density")
## S3 method for class 'SimTest'
summary(object, Quantiles = c(0.025, 0.975), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimTest_+3A_x">x</code></td>
<td>

<p>An object to be tested or plotted.
</p>
</td></tr>
<tr><td><code id="SimTest_+3A_object">object</code></td>
<td>

<p>An object.
</p>
</td></tr>
<tr><td><code id="SimTest_+3A_realvalue">RealValue</code></td>
<td>

<p>A numeric Value (the actual one).
</p>
</td></tr>
<tr><td><code id="SimTest_+3A_simulatedvalues">SimulatedValues</code></td>
<td>

<p>A numeric vector containing the simulated values.
</p>
</td></tr>
<tr><td><code id="SimTest_+3A_quantiles">Quantiles</code></td>
<td>

<p>A vector containing the quantiles of interest.
</p>
</td></tr>
<tr><td><code id="SimTest_+3A_colvalue">colValue</code></td>
<td>

<p>The color of the line representing the real value on the plot.
</p>
</td></tr>
<tr><td><code id="SimTest_+3A_lwdvalue">lwdValue</code></td>
<td>

<p>The width of the line representing the real value on the plot.
</p>
</td></tr>
<tr><td><code id="SimTest_+3A_ltyvalue">ltyValue</code></td>
<td>

<p>The line type of the line representing the real value on the plot.
</p>
</td></tr>
<tr><td><code id="SimTest_+3A_colquantiles">colQuantiles</code></td>
<td>

<p>The color of the lines representing the quantiles on the plot.
</p>
</td></tr>
<tr><td><code id="SimTest_+3A_lwdquantiles">lwdQuantiles</code></td>
<td>

<p>The width of the lines representing the quantiles on the plot.
</p>
</td></tr>
<tr><td><code id="SimTest_+3A_ltyquantiles">ltyQuantiles</code></td>
<td>

<p>The line type of the lines representing the quantiles on the plot.
</p>
</td></tr>
<tr><td><code id="SimTest_+3A_main">main</code></td>
<td>

<p>The main title of the plot. if <code>NULL</code> (by default), there is no title.
</p>
</td></tr>
<tr><td><code id="SimTest_+3A_xlab">xlab</code></td>
<td>

<p>The X axis label.
</p>
</td></tr>
<tr><td><code id="SimTest_+3A_ylab">ylab</code></td>
<td>

<p>The Y axis label. 
</p>
</td></tr>
<tr><td><code id="SimTest_+3A_...">...</code></td>
<td>

<p>Additional arguments to be passed to the generic methods.   
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simulated values should be obtained by simulation. The actual value is compared to simulated quantiles. <code>SimTest</code> objects can be plotted and summarized.
</p>


<h3>Value</h3>

<p><code>SimTest</code> objects are lists containing:
</p>
<table>
<tr><td><code>RealValue</code></td>
<td>
<p>The value to test.</p>
</td></tr>
<tr><td><code>SimulatedValues</code></td>
<td>
<p>A vector of simulated values, whose quantiles will be used for the test.</p>
</td></tr>
</table>
<p><code>is.SimTest</code> returns <code>TRUE</code> if the object is of class <code>SimTest</code>.
</p>
<p><code>summary.SimTest</code> returns a summary of the object, including the empirical quantile of the real value in the simulated distributon.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the value to test
Real &lt;- 0.8
# Is it a realization of a Gaussian distribution?
Sims &lt;- rnorm(1000)
# Make a Simtest object
st &lt;- as.SimTest(Real, Sims)
summary(st)
# Plot
plot(st)
# ggplot
autoplot(st)

</code></pre>

<hr>
<h2 id='SpeciesDistribution'>
Species Distributions
</h2><span id='topic+SpeciesDistribution'></span><span id='topic+as.SpeciesDistribution'></span><span id='topic+as.SpeciesDistribution.data.frame'></span><span id='topic+as.SpeciesDistribution.integer'></span><span id='topic+as.SpeciesDistribution.numeric'></span><span id='topic+is.SpeciesDistribution'></span><span id='topic+autoplot.SpeciesDistribution'></span><span id='topic+plot.SpeciesDistribution'></span><span id='topic+AbdVector'></span><span id='topic+as.AbdVector'></span><span id='topic+as.AbdVector.data.frame'></span><span id='topic+as.AbdVector.integer'></span><span id='topic+as.AbdVector.numeric'></span><span id='topic+is.AbdVector'></span><span id='topic+ProbaVector'></span><span id='topic+as.ProbaVector'></span><span id='topic+as.ProbaVector.data.frame'></span><span id='topic+as.ProbaVector.integer'></span><span id='topic+as.ProbaVector.numeric'></span><span id='topic+is.ProbaVector'></span>

<h3>Description</h3>

<p>A Species Distribution is a (preferably named) vector containing species abundances or probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.SpeciesDistribution(x, ...)
## S3 method for class 'data.frame'
as.SpeciesDistribution(x, ...)
## S3 method for class 'integer'
as.SpeciesDistribution(x, ...)
## S3 method for class 'numeric'
as.SpeciesDistribution(x, ...)
## S3 method for class 'SpeciesDistribution'
autoplot(object, ..., Distribution = NULL, 
         ylog = TRUE, main = NULL, xlab = "Rank", ylab = NULL, 
         pch = ggplot2::GeomPoint$default_aes$shape,
         col = ggplot2::GeomPoint$default_aes$colour,
         cex = ggplot2::GeomPoint$default_aes$size) 
## S3 method for class 'SpeciesDistribution'
plot(x, ..., Distribution = NULL, 
         type = "b", log = "y", main = NULL, xlab = "Rank", ylab = NULL)
is.SpeciesDistribution(x)
as.ProbaVector(x, ...)
## S3 method for class 'data.frame'
as.ProbaVector(x, ...)
## S3 method for class 'integer'
as.ProbaVector(x, Correction = "None", Unveiling = "None", 
          RCorrection = "Jackknife", JackOver = FALSE, JackMax = 10, 
          CEstimator = "ZhangHuang", q = 0, ..., CheckArguments = TRUE)
## S3 method for class 'numeric'
as.ProbaVector(x, Correction = "None", Unveiling = "None", 
          RCorrection = "Jackknife", JackOver = FALSE, JackMax = 10, 
          CEstimator = "ZhangHuang", q = 0, ..., CheckArguments = TRUE)
is.ProbaVector(x)
as.AbdVector(x, ...)
## S3 method for class 'data.frame'
as.AbdVector(x, Round = TRUE, ...)
## S3 method for class 'integer'
as.AbdVector(x, ...)
## S3 method for class 'numeric'
as.AbdVector(x, Round = TRUE, ...)
is.AbdVector(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SpeciesDistribution_+3A_x">x</code></td>
<td>

<p>An object.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_object">object</code></td>
<td>

<p>An object.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_distribution">Distribution</code></td>
<td>

<p>The distribution to fit on the plot. May be <code>"lnorm"</code> (log-normal), <code>"lseries"</code> (log-series), <code>"geom"</code> (geometric) or <code>"bstick"</code> (broken stick). If <code>NULL</code>, no distribution is fitted. See <code><a href="#topic+rCommunity">rCommunity</a></code> for the description of these distributions.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_round">Round</code></td>
<td>

<p>If <code>TRUE</code> (by default), values of <code>x</code> are set to integer to create an <code>AbdVector</code>. This is useful if original abundances are not integers (this is often the case for <code><a href="#topic+MetaCommunity">MetaCommunity</a></code> abundances which are the product of probabilities by the number of individuals) and integer values are required (for example to calculate the bootstrap confidence interval of a community profile).
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections to estimate a probability distribution: <code>"None"</code> (no correction, the default value), or <code>"Chao2013"</code>, <code>"Chao2015"</code>, <code>"ChaoShen"</code> to estimate the probability of the observed species in the asymptotic distribution.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_unveiling">Unveiling</code></td>
<td>

<p>A string containing one of the possible unveiling methods to estimate the probabilities of the unobserved species: <code>"None"</code> (default, no species is added), <code>"unif"</code> (uniform: all unobserved species have the same probability) or <code>"geom"</code> (geometric: the unobserved species distribution is geometric).
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_rcorrection">RCorrection</code></td>
<td>

<p>A string containing a correction recognized by <code><a href="#topic+Richness">Richness</a></code> to evaluate the total number of species. <code>"Jackknife"</code> is the default value. An alternative is <code>"Rarefy"</code> to estimate the number of species such that the entropy of order <code>q</code> of the asymptotic distribution rarefied to the observed sample size equals the actual entropy of the data.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_jackover">JackOver</code></td>
<td>

<p>If <code>TRUE</code>, retain the jackknife order immediately superior to the optimal one, usually resulting in the overestimation of the number of species. Default is <code>FALSE</code>. Ignored if <code>RCorrection</code> is not <code>"Jackknife"</code>.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_jackmax">JackMax</code></td>
<td>

<p>The highest jackknife order allowed. Default is 10. Allowed values are between 1 and 10.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_cestimator">CEstimator</code></td>
<td>

<p>A string containing an estimator recognized by <code><a href="#topic+Coverage">Coverage</a></code> to evaluate the sample coverage. <code>"ZhangHuang"</code> is the default value.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_q">q</code></td>
<td>

<p>A number: the order of entropy. Default is 0 for richness. Used only to estimate asymptotic probability distributions with <code>RCorrection</code> equal to <code>"Rarefy"</code>. Then, the number of unobserved species is fitted so that the entropy of order <code>q</code> of the asymptotic probability distribution at the observed sample size equals the actual entropy of the data.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_type">type</code></td>
<td>

<p>The plot type, see <code><a href="#topic+plot">plot</a></code>.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_log">log</code></td>
<td>

<p>The axis to plot in log scale, <em>e.g.</em> <code>"xy"</code> for both axes. Default is <code>"y"</code>.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_main">main</code></td>
<td>

<p>The main title of the plot. if <code>NULL</code> (by default), there is no title.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_xlab">xlab</code></td>
<td>

<p>The X axis label, &quot;Rank&quot; by default.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_ylab">ylab</code></td>
<td>

<p>The Y axis label. if <code>NULL</code> (by default), &quot;Probability&quot; or &quot;Abundance&quot; is chosen according to the object class.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_ylog">ylog</code></td>
<td>

<p>Logical; if <code>TRUE</code> (by default), the Y-axis of the plot is log scaled.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_pch">pch</code></td>
<td>

<p>The plotting characters. See <code><a href="graphics.html#topic+points">points</a></code>.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_col">col</code></td>
<td>

<p>The color of the geom objects. See &quot;Color Specification&quot; in <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_cex">cex</code></td>
<td>

<p>The character expansion (size) of the points. See <code><a href="graphics.html#topic+points">points</a></code>.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_...">...</code></td>
<td>

<p>Additional arguments to be passed to <code><a href="#topic+plot">plot</a></code>. Unused elsewhere.
</p>
</td></tr>
<tr><td><code id="SpeciesDistribution_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>SpeciesDistribution</code> objects include <code>AbdVector</code> and <code>ProbaVector</code> objects.
</p>
<p><code>as.AbdVector</code> just sets the class of the numeric or integer <code>x</code> so that appropriate versions of community functions (generic methods such as <code><a href="#topic+Diversity">Diversity</a></code>) are applied. Abundance values are rounded (by default) to the nearest integer.
</p>
<p><code>as.ProbaVector</code> normalizes the vector so that it sums to 1. If <code>Correction</code> is not <code>"None"</code>, the observed abundance distribution is used to estimate the actual species distribution. The list of species will be changed: zero-abundance species will be cleared, and some unobserved species will be added. First, observed species probabilities are estimated folllowing Chao and Shen (2003), <em>i.e.</em> input probabilities are multiplied by the sample coverage, or according to more sophisticated models: Chao <em>et al.</em> (2013, single-parameter model), or Chao <em>et al.</em> (2015, two-parameter model). The total probability of observed species equals the sample coverage. Then, the distribution of unobserved species can be unveiled: their number is estimated according to <code>RCorrection</code> (if the Jackknife estimator is chosen, the <code>JackOver</code> argument allows using the order immediately over the optimal one). The coverage deficit (1 minus the sample coverage) is shared by the unobserved species equally (<code>Unveiling = "unif"</code>, Chao <em>et al.</em>, 2013) or according to a geometric distribution (<code>Unveiling = "geom"</code>, Chao <em>et al.</em>, 2015).
</p>
<p>These functions can be applied to data frames to calculate the joint diversity (Gregorius, 2010).
</p>
<p><code>SpeciesDistribution</code> objects can be plotted. The <code>plot</code> method returns the estimated parameters of the fitted distribution. The broken stick has no parameter, so the maximum abundance is returned.
</p>


<h3>Note</h3>

<p>Fisher's alpha (Fisher <em>et al.</em>, 1943) is estimated to fit the log-series distribution. The estimation is done by the <code><a href="vegan.html#topic+fisher.alpha">fisher.alpha</a></code> function of package <code>vegan</code>. It may differ substantially from the estimation returned by <code>optimal.theta</code> from package <code>untb</code>.
</p>


<h3>Author(s)</h3>

<p>Eric Marcon &lt;Eric.Marcon@agroparistech.fr&gt;, Bruno Herault &lt;Bruno.Herault@cirad.fr&gt;
</p>


<h3>References</h3>

<p>Chao, A. and Shen, T. J. (2003). Nonparametric estimation of Shannon's index of diversity when there are unseen species in sample. <em>Environmental and Ecological Statistics</em> 10(4): 429-443.
</p>
<p>Chao, A., Wang, Y. T. and Jost, L. (2013). Entropy and the species accumulation curve: a novel entropy estimator via discovery rates of new species. <em>Methods in Ecology and Evolution</em> 4(11):1091-1100.
</p>
<p>Chao, A., Hsieh, T. C., Chazdon, R. L., Colwell, R. K., Gotelli, N. J. (2015) Unveiling the Species-Rank Abundance Distribution by Generalizing Good-Turing Sample Coverage Theory. <em>Ecology</em> 96(5): 1189-1201.
</p>
<p>Fisher R.A., Corbet A.S., Williams C.B. (1943) The Relation Between the Number of Species and the Number of Individuals in a Random Sample of an Animal Population. <em>Journal of Animal Ecology</em> 12: 42-58.
</p>
<p>Gregorius H.-R. (2010) Linking Diversity and Differentiation. <em>Diversity</em> 2(3): 370-394.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rgeom">rgeom</a></code>, <code><a href="stats.html#topic+rlnorm">rlnorm</a></code>, <code><a href="#topic+rCommunity">rCommunity</a></code>, <code><a href="#topic+RAClnorm">RAClnorm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Whittaker plot, poorly fitted by a log-normal distribution
plot(Ns, Distribution = "lnorm")
# ggplot version
autoplot(Ns, Distribution = "lnorm")
</code></pre>

<hr>
<h2 id='Tsallis'>
Tsallis (HCDT) Entropy of a community
</h2><span id='topic+Tsallis'></span><span id='topic+bcTsallis'></span><span id='topic+Tsallis.ProbaVector'></span><span id='topic+Tsallis.AbdVector'></span><span id='topic+Tsallis.integer'></span><span id='topic+Tsallis.numeric'></span>

<h3>Description</h3>

<p>Calculates the HCDT, also known as Tsallis entropy of order <code class="reqn">q</code> of a probability vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Tsallis(NorP, q = 1, ...)
bcTsallis(Ns, q = 1, Correction = "Best", SampleCoverage = NULL,
  CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
Tsallis(NorP, q = 1, ..., 
  CheckArguments = TRUE, Ps = NULL)
## S3 method for class 'AbdVector'
Tsallis(NorP, q = 1, Correction = "Best", Level = NULL,
  PCorrection="Chao2015", Unveiling="geom", RCorrection="Rarefy", ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'integer'
Tsallis(NorP, q = 1, Correction = "Best", Level = NULL,
  PCorrection="Chao2015", Unveiling="geom", RCorrection="Rarefy", ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'numeric'
Tsallis(NorP, q = 1, Correction = "Best", Level = NULL,
  PCorrection="Chao2015", Unveiling="geom", RCorrection="Rarefy", ..., 
  CheckArguments = TRUE, Ps = NULL, Ns = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Tsallis_+3A_ps">Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td></tr>
<tr><td><code id="Tsallis_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td></tr>
<tr><td><code id="Tsallis_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities.
</p>
</td></tr>
<tr><td><code id="Tsallis_+3A_q">q</code></td>
<td>

<p>A number: the order of entropy. Some corrections allow only a positive number. Default is 1 for Shannon entropy.
</p>
</td></tr>
<tr><td><code id="Tsallis_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible asymptotic estimators: <code>"None"</code> (no correction), <code>"ChaoShen"</code>, <code>"GenCov"</code>, <code>"Grassberger"</code>, <code>"Holste"</code>, <code>"Bonachela"</code>, <code>"ZhangGrabchak"</code>, or <code>"ChaoJost"</code>, <code>"Marcon"</code>, <code>"UnveilC"</code>, <code>"UnveiliC"</code>, <code>"UnveilJ"</code> or <code>"Best"</code>, the default value.  Currently, <code>"Best"</code> is <code>"UnveilJ"</code>.
</p>
</td></tr>
<tr><td><code id="Tsallis_+3A_level">Level</code></td>
<td>

<p>The level of interpolation or extrapolation. It may be an a chosen sample size (an integer) or a sample coverage (a number between 0 and 1).
</p>
</td></tr>
<tr><td><code id="Tsallis_+3A_pcorrection">PCorrection</code></td>
<td>

<p>A string containing one of the possible corrections to estimate a probability distribution in <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>: <code>"Chao2015"</code> is the default value. Used only for extrapolation.
</p>
</td></tr>
<tr><td><code id="Tsallis_+3A_unveiling">Unveiling</code></td>
<td>

<p>A string containing one of the possible unveiling methods to estimate the probabilities of the unobserved species in <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>: <code>"geom"</code> (the unobserved species distribution is geometric) is the default value. Used only for extrapolation.
</p>
</td></tr>
<tr><td><code id="Tsallis_+3A_rcorrection">RCorrection</code></td>
<td>

<p>A string containing a correction recognized by <code><a href="#topic+Richness">Richness</a></code> to evaluate the total number of species in <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>. <code>"Rarefy"</code> is the default value to estimate the number of species such that the entropy of the asymptotic distribution rarefied to the observed sample size equals the observed entropy of the data. Used only for extrapolation.
</p>
</td></tr>
<tr><td><code id="Tsallis_+3A_samplecoverage">SampleCoverage</code></td>
<td>

<p>The sample coverage of <code>Ns</code> calculated elsewhere. Used to calculate the gamma diversity of meta-communities, see details. 
</p>
</td></tr>
<tr><td><code id="Tsallis_+3A_...">...</code></td>
<td>

<p>Additional arguments. Unused.
</p>
</td></tr>
<tr><td><code id="Tsallis_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tsallis (Havrda and Charvat, 1967; Daroczy, 1970; Tsallis, 1988) generalized entropy is a generalized measure of diversity (Jost, 2006).
</p>
<p>Bias correction requires the number of individuals to estimate sample <code><a href="#topic+Coverage">Coverage</a></code>.
</p>
<p>Correction techniques are from Chao and Shen (2003), Grassberger (1988), Holste <em>et al.</em> (1998), Bonachela <em>et al.</em> (2008), (Marcon <em>et al.</em>, 2014), which is actually the max value of <code>"ChaoShen"</code> and <code>"Grassberger"</code>, Zhang and Grabchak (2014), Chao and Jost (2015) and Marcon (2015).
</p>
<p>The <code>"ChaoJost"</code> (Chao, Wang and Jost, 2013 for <code class="reqn">q=1</code>; Chao and Jost, 2015) estimator contains an unbiased part concerning observed species, equal to that of Zhang and Grabchak (2014), and a (biased) estimator of the remaining bias based on the estimation of the species-accumulation curve. 
It is very efficient but very slow if the number of individuals is more than a few hundreds. 
This estimator was named &quot;ChaoWangJost&quot; in previous versions of the package; its old name is still supported for backward compatibility.
</p>
<p>The unveiled estimators rely on Chao <em>et al.</em> (2015), completed by Marcon (2015). 
The actual probabilities of observed species are estimated and completed by a geometric distribution of the probabilities of unobserved species. 
The number of unobserved species is estimated by the Chao1 estimator (<code>"UnveilC"</code>), following Chao <em>et al.</em> (2015), or by the iChao1 (<code>"UnveiliC"</code>) or the jacknife (<code>"UnveilJ"</code>). 
The <code>"UnveilJ"</code> correction often has a lower bias but a greater variance (Marcon, 2015). 
It is a good first choice thanks to the versatility of the jacknife estimator of richness.
</p>
<p>The functions are designed to be used as simply as possible. 
<code>Tsallis</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcTsallis</code> is called.
</p>
<p>The size of a metacommunity (see <code><a href="#topic+MetaCommunity">MetaCommunity</a></code>) is unknown so it has to be set according to a rule which does not ensure that its abundances are integer values. 
Then, classical bias-correction methods do not apply. 
Providing the <code>SampleCoverage</code> argument allows applying the <code>"ChaoShen"</code> and <code>"Grassberger"</code> corrections to estimate quite well the entropy. 
<code><a href="#topic+DivPart">DivPart</a></code> and <code><a href="#topic+GammaEntropy">GammaEntropy</a></code> functions use this tweak.
</p>
<p>Entropy can be estimated at a specified level of interpolation or extrapolation, either a chosen sample size or sample coverage (Chao et al., 2014), rather than its asymptotic value.
Special cases $q$ equals 0, 1 or 2 are treated by <code><a href="#topic+Richness">Richness</a></code>, <code><a href="#topic+Shannon">Shannon</a></code> and <code><a href="#topic+Simpson">Simpson</a></code> functions.
For extrapolation of entropy of other values of $q$, the asymptotic distribution of the community must be estimated by <code><a href="#topic+as.ProbaVector">as.ProbaVector</a></code>.
The default arguments allow joining smoothly the extrapolated entropy and the observed entropy by estimating the number of unobserved species so that the entropy of the observed distribution equals the entropy of the asymptotic distribution rarefied to the actual sample size.
</p>


<h3>Value</h3>

<p>A named number equal to the calculated entropy. The name is that of the bias correction used.
</p>


<h3>References</h3>

<p>Chao, A., Gotelli, N. J., Hsieh, T. C., Sander, E. L., Ma, K. H., Colwell, R. K., Ellison, A. M (2014). Rarefaction and extrapolation with Hill numbers: A framework for sampling and estimation in species diversity studies.  <em>Ecological Monographs</em>, 84(1): 45-67.
</p>
<p>Chao, A. and Jost, L. (2015) Estimating diversity and entropy profiles via discovery rates of new species. <em>Methods in Ecology and Evolution</em> 6(8): 873-882.
</p>
<p>Chao, A., Hsieh, T. C., Chazdon, R. L., Colwell, R. K., Gotelli, N. J. (2015) Unveiling the Species-Rank Abundance Distribution by Generalizing Good-Turing Sample Coverage Theory. <em>Ecology</em> 96(5): 1189-1201.
</p>
<p>Chao, A., Wang, Y. T. and Jost, L. (2013). Entropy and the species accumulation curve: a novel entropy estimator via discovery rates of new species. <em>Methods in Ecology and Evolution</em> 4(11):1091-1100.
</p>
<p>Havrda, J. and Charvat, F. (1967). Quantification method of classification processes. Concept of structural a-entropy. <em>Kybernetika</em> 3(1): 30-35.
</p>
<p>Daroczy, Z. (1970). Generalized information functions. <em>Information and Control</em> 16(1): 36-51.
</p>
<p>Jost, L. (2006). Entropy and diversity. <em>Oikos</em> 113(2): 363-375.
</p>
<p>Marcon, E. (2015) Practical Estimation of Diversity from Abundance Data. <em>HAL</em> 01212435: 1-27.
</p>
<p>Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p>Tsallis, C. (1988). Possible generalization of Boltzmann-Gibbs statistics. <em>Journal of Statistical Physics</em> 52(1): 479-487.
</p>
<p>Zhang, Z., and Grabchak, M. (2016). Entropic Representation and Estimation of Diversity Indices. <em>Journal of Nonparametric Statistics</em>, 28(3): 563-575.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Species probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ns)
# Whittaker plot
plot(Ns)

# Calculate entropy of order 1, i.e. Shannon's entropy
Tsallis(Ps, 1)
# Calculate it with estimation bias correction
Tsallis(Ns, 1)
</code></pre>

<hr>
<h2 id='TsallisBeta'>
Tsallis beta entropy of a community
</h2><span id='topic+TsallisBeta'></span><span id='topic+bcTsallisBeta'></span><span id='topic+TsallisBeta.ProbaVector'></span><span id='topic+TsallisBeta.AbdVector'></span><span id='topic+TsallisBeta.integer'></span><span id='topic+TsallisBeta.numeric'></span>

<h3>Description</h3>

<p>Calculates the Tsallis beta entropy of order <code class="reqn">q</code> of a community belonging to a metacommunity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TsallisBeta(NorP, NorPexp = NULL, q = 1, ...)
bcTsallisBeta(Ns, Nexp = NULL, q, Correction = "Best", CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
TsallisBeta(NorP, NorPexp = NULL, q = 1, ..., 
  CheckArguments = TRUE, Ps = NULL, Pexp = NULL)
## S3 method for class 'AbdVector'
TsallisBeta(NorP, NorPexp = NULL, q = 1, Correction = "Best", ..., 
  CheckArguments = TRUE, Ns = NULL, Nexp = NULL)
## S3 method for class 'integer'
TsallisBeta(NorP, NorPexp = NULL, q = 1, Correction = "Best", ..., 
  CheckArguments = TRUE, Ns = NULL, Nexp = NULL)
## S3 method for class 'numeric'
TsallisBeta(NorP, NorPexp = NULL, q = 1, Correction = "Best", ..., 
  CheckArguments = TRUE, Ps = NULL, Ns = NULL, Pexp = NULL, Nexp = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TsallisBeta_+3A_ps">Ps</code></td>
<td>

<p>The probability vector of species of the community.
</p>
</td></tr>
<tr><td><code id="TsallisBeta_+3A_pexp">Pexp</code></td>
<td>

<p>The probability vector of species of the metacommunity.
</p>
</td></tr>
<tr><td><code id="TsallisBeta_+3A_ns">Ns</code></td>
<td>

<p>A numeric vector containing species abundances of the community.
</p>
</td></tr>
<tr><td><code id="TsallisBeta_+3A_nexp">Nexp</code></td>
<td>

<p>A numeric vector containing species abundances of the metacommunity.
</p>
</td></tr>
<tr><td><code id="TsallisBeta_+3A_norp">NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities of the community.
</p>
</td></tr>
<tr><td><code id="TsallisBeta_+3A_norpexp">NorPexp</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code><a href="#topic+AbdVector">AbdVector</a></code>) or a probability vector (<code><a href="#topic+ProbaVector">ProbaVector</a></code>). Contains either abundances or probabilities of the metacommunity.
</p>
</td></tr>
<tr><td><code id="TsallisBeta_+3A_q">q</code></td>
<td>

<p>A number: the order of entropy. Default is 1 for Shannon entropy.
</p>
</td></tr>
<tr><td><code id="TsallisBeta_+3A_correction">Correction</code></td>
<td>

<p>A string containing one of the possible corrections: currently, only <code>"ChaoShen"</code> or <code>"None"</code>. <code>"Best"</code> is the default value, it is equivalent to <code>"ChaoShen"</code>.
</p>
</td></tr>
<tr><td><code id="TsallisBeta_+3A_...">...</code></td>
<td>

<p>Additional arguments. Unused.
</p>
</td></tr>
<tr><td><code id="TsallisBeta_+3A_checkarguments">CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The derivation of Tsallis beta entropy can be found in Marcon et al. (2014).
</p>
<p>Bias correction requires the number of individuals to estimate sample <code><a href="#topic+Coverage">Coverage</a></code>. Use <code>bcTsallisBeta</code> and choose the <code>Correction</code>.
</p>
<p>Note that beta entropy value is related to alpha entropy (if <code class="reqn">q</code> is not 1) and cannot be compared accross communities (Jost, 2007). Beta entropy of a community is not meaningful in general, do rather calculate the <code><a href="#topic+BetaDiversity">BetaDiversity</a></code> of the metacommunity.
</p>
<p>The functions are designed to be used as simply as possible. <code>TsallisBeta</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcTsallisBeta</code> is called. Explicit calls to <code>bcTsallisBeta</code> (with bias correction) or to <code>TsallisBeta.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>


<h3>Value</h3>

<p>A named number equal to the calculated entropy. The name is that of the bias correction used.
</p>


<h3>References</h3>

<p>Jost (2007), Partitioning diversity into independent alpha and beta components. <em>Ecology</em> 88(10): 2427-2439.
</p>
<p>Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- Paracou618.MC$Ps
# Probability distribution of the first plot
Ps1 &lt;- Paracou618.MC$Psi[, 1]
# Divergence of order 2 between plot 1 and the whole forest
TsallisBeta(Ps1, Ps, 2)

# Ns is the vector of abundances of the metacommunity
Ns &lt;- Paracou618.MC$Ns
# Abundances in the first plot
Ns1 &lt;- Paracou618.MC$Nsi[, 1]
# Divergence of order 2 between plot 1 and the whole forest, with bias correction
bcTsallisBeta(Ns1, Ns, 2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
