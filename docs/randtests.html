<!DOCTYPE html><html><head><title>Help for package randtests</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {randtests}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#randtests-package'>
<p>Testing randomness in R</p></a></li>
<li><a href='#bartels.rank.test'>
<p>Bartels Rank Test</p></a></li>
<li><a href='#BartelsRank'>
<p>Distribution of the Bartels Rank Test Statistic NM</p></a></li>
<li><a href='#cox.stuart.test'><p>Cox Stuart Trend Test</p></a></li>
<li><a href='#difference.sign.test'><p>Difference Sign Test</p></a></li>
<li><a href='#permut'>
<p>Generate all permutations of <code class="reqn">m</code> elements of a vector</p></a></li>
<li><a href='#randtests.aux'>
<p>Auxiliar function</p></a></li>
<li><a href='#rank.test'>
<p>Mann-Kendall Rank Test</p></a></li>
<li><a href='#Runs'>
<p>Distribution of the Wald Wolfowitz Runs Statistic</p></a></li>
<li><a href='#runs.test'>
<p>Wald-Wolfowitz Runs Test</p></a></li>
<li><a href='#sweetpotato'>
<p>Sweet potato production</p></a></li>
<li><a href='#turning.point.test'>
<p>Turning Point Test</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Testing Randomness in R</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-04-22</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Frederico Caeiro &lt;fac@fct.unl.pt&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides several non parametric randomness tests for numeric sequences.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-23 14:54:39 UTC; fac</td>
</tr>
<tr>
<td>Author:</td>
<td>Frederico Caeiro <a href="https://orcid.org/0000-0001-8628-7281"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Ayana Mateus <a href="https://orcid.org/0000-0002-5630-3321"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-23 15:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='randtests-package'>
Testing randomness in R
</h2><span id='topic+randtests-package'></span>

<h3>Description</h3>

<p>The package <code>randtests</code> implements several nonparametric randomness tests of hypothesis. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> randomtests</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-04-22</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Randomness is a common assumption in many statistical methods. When such assumption is not fulfilled, we may draw wrong conclusions. Although in many datasets a simple graphical analysis is enough to check such assumption, in others a test of hypothesis is required.
</p>


<h3>Author(s)</h3>

<p>Frederico Caeiro and Ayana Mateus
</p>
<p>Maintainer: Frederico Caeiro &lt;fac@fct.unl.pt&gt;
</p>


<h3>References</h3>

<p>Mateus A. and Caeiro F. (2014). An R implementation of several Randomness Tests. In T. E. Simos, Z. Kalogiratou and T. Monovasilis (eds.), <em>AIP Conf. Proc.</em> <b>1618</b>, 531&ndash;534.
</p>

<hr>
<h2 id='bartels.rank.test'>
Bartels Rank Test
</h2><span id='topic+bartels.rank.test'></span>

<h3>Description</h3>

<p>Performs the Bartels rank test of randomness.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bartels.rank.test(x, alternative, pvalue="normal")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bartels.rank.test_+3A_x">x</code></td>
<td>
<p>a numeric vector containing the observations</p>
</td></tr>
<tr><td><code id="bartels.rank.test_+3A_alternative">alternative</code></td>
<td>
<p>a character string with the alternative hypothesis. Must be one of &quot;<code>two.sided</code>&quot; (default), &quot;<code>left.sided</code>&quot; or &quot;<code>right.sided</code>&quot;. You can specify just the initial letter.</p>
</td></tr>
<tr><td><code id="bartels.rank.test_+3A_pvalue">pvalue</code></td>
<td>
<p>a character string specifying the method used to compute the p-value. Must be one of <code>normal</code> (default), <code>beta</code>, <code>exact</code> or <code>auto</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Missing values are removed.
</p>
<p>This is the rank version of von Neumann's Ratio Test for Randomness (von Neumann, 1941).
</p>
<p>The test statistic RVN is 
</p>
<p style="text-align: center;"><code class="reqn">RVN=\frac{\sum_{i=1}^{n-1}(R_i-R_{i+1})^2}{\sum_{i=1}^{n}\left(R_i-(n+1)/2\right)^2}</code>
</p>

<p>where <code class="reqn">R_i=rank(X_i), i=1,\dots, n</code>. It is known that <code class="reqn">(RVN-2)/\sigma</code> is asymptotically standard normal, where <code class="reqn">\sigma^2=\frac{4(n-2)(5n^2-2n-9)}{5n(n+1)(n-1)^2}</code>. 
</p>
<p>The possible <code>alternative</code> are &quot;<code>two.sided</code>&quot;, &quot;<code>left.sided</code>&quot; and &quot;<code>right.sided</code>&quot;. By using the alternative &quot;two.sided&quot; the null hypothesis of randomness is tested against nonrandomness. By using the alternative &quot;<code>left.sided</code>&quot; the null hypothesis of randomness is tested against a trend. By using the alternative &quot;<code>right.sided</code>&quot; the null hypothesis of randomness is tested against a systematic oscillation.
</p>
<p>By default (if <code>pvalue</code> is not specified), a normal approximation is used to compute the p-value. With <code>beta</code>, the p-value is computed using an approximation given by the Beta distribution. With <code>exact</code>, the exact p-value is computed. The option <code>exact</code> requires the computation of the exact distribution of the statistic test under the null hypothesis and should only be used for small sample sizes (<code class="reqn">n \le 10</code>).
</p>


<h3>Value</h3>

<p>A list with class &quot;htest&quot; containing the components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the normalized statistic test.</p>
</td></tr>
<tr><td><code>parameter</code>, <code>n</code></td>
<td>
<p>the size of the data, after the remotion of consecutive duplicate values.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the test performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data.</p>
</td></tr>
<tr><td><code>rvn</code></td>
<td>
<p>the value of the RVN statistic (not shown on screen).</p>
</td></tr>
<tr><td><code>nm</code></td>
<td>
<p>the value of the NM statistic, the numerator of RVN (not shown on screen).</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>the mean value of the RVN statistic (not shown on screen).</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>the variance of the RVN statistic (not shown on screen).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Frederico Caeiro</p>


<h3>References</h3>

<p>Bartels, R. (1982). The Rank Version of von Neumann's Ratio Test for Randomness, <em>Journal of the American Statistical Association</em>, <b>77</b>(377), 40&ndash;46.
</p>
<p>Gibbons, J.D. and Chakraborti, S. (2003). <em>Nonparametric Statistical Inference</em>, 4th ed. (pp. 97&ndash;98).<br /> 
URL: <a href="http://books.google.pt/books?id=dPhtioXwI9cC&amp;lpg=PA97&amp;ots=ZGaQCmuEUq">http://books.google.pt/books?id=dPhtioXwI9cC&amp;lpg=PA97&amp;ots=ZGaQCmuEUq</a>
</p>
<p>von Neumann, J. (1941). Distribution of the Ratio of the Mean Square Successive Difference to the Variance. <em>The Annals of Mathematical Statistics</em> <b>12</b>(4), 367&ndash;395. doi:10.1214/aoms/1177731677. <a href="https://projecteuclid.org/journals/annals-of-mathematical-statistics/volume-12/issue-4/Distribution-of-the-Ratio-of-the-Mean-Square-Successive-Difference/10.1214/aoms/1177731677.full">https://projecteuclid.org/journals/annals-of-mathematical-statistics/volume-12/issue-4/Distribution-of-the-Ratio-of-the-Mean-Square-Successive-Difference/10.1214/aoms/1177731677.full</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dbartelsrank">dbartelsrank</a></code>, <code><a href="#topic+pbartelsrank">pbartelsrank</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Example 5.1 in Gibbons and Chakraborti (2003), p.98.
## Annual data on total number of tourists to the United States for 1970-1982.
##
years &lt;- 1970:1982
tourists &lt;- c(12362, 12739, 13057, 13955, 14123,  15698, 17523, 18610, 19842, 
      20310, 22500, 23080, 21916)
plot(years, tourists, pch=20)
bartels.rank.test(tourists, alternative="left.sided", pvalue="beta")
# output
#
#  Bartels Ratio Test
#
#data:  tourists 
#statistic = -3.6453, n = 13, p-value = 1.21e-08
#alternative hypothesis: trend 


##
## Example in Bartels (1982).
## Changes in stock levels for 1968-1969 to 1977-1978 (in $A million), deflated by the 
## Australian gross domestic product (GDP) price index (base 1966-1967).
x &lt;- c(528, 348, 264, -20, -167, 575, 410, -4, 430, -122)
bartels.rank.test(x, pvalue="beta")
</code></pre>

<hr>
<h2 id='BartelsRank'>
Distribution of the Bartels Rank Test Statistic NM
</h2><span id='topic+dbartelsrank'></span><span id='topic+pbartelsrank'></span>

<h3>Description</h3>

<p>Probability function, distribution function
for the distribution of the Bartels Rank statistic NM, for a sample of size <code class="reqn">n</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbartelsrank(x, n, log = FALSE)
pbartelsrank(q, n, lower.tail = TRUE, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BartelsRank_+3A_x">x</code>, <code id="BartelsRank_+3A_q">q</code></td>
<td>
<p>a numeric vector of quantiles.</p>
</td></tr>

<tr><td><code id="BartelsRank_+3A_n">n</code></td>
<td>
<p>number of observations to return.</p>
</td></tr>
<tr><td><code id="BartelsRank_+3A_log">log</code>, <code id="BartelsRank_+3A_log.p">log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td></tr>
<tr><td><code id="BartelsRank_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are P[X <code class="reqn">\le</code> x] otherwise, P[X &gt; x].</p>
</td></tr>  
</table>


<h3>Value</h3>

<p><code>dbartelsrank</code> gives the probability function and <code>pbartelsrank</code> gives the distribution function.
</p>


<h3>Warning</h3>

<p>This function can use large amounts of memory and stack (and even crash R if the stack limit is exceeded) if the sample size <code class="reqn">n</code> is large.
</p>


<h3>Author(s)</h3>

<p>Frederico Caeiro</p>


<h3>References</h3>

<p>Bartels, R. (1982). The Rank Version of von Neumann's Ratio Test for Randomness, <em>Journal of the American Statistical Association</em>, <b>77</b>(377), 40&ndash;46.
</p>
<p>Gibbons, J.D. and Chakraborti, S. (2003). <em>Nonparametric Statistical Inference</em>, 4th ed. (pp. 97&ndash;98).<br /> 
URL: <a href="http://books.google.pt/books?id=dPhtioXwI9cC&amp;lpg=PA97&amp;ots=ZGaQCmuEUq">http://books.google.pt/books?id=dPhtioXwI9cC&amp;lpg=PA97&amp;ots=ZGaQCmuEUq</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bartels.rank.test">bartels.rank.test</a></code> to calculate the value of the statistic NM from data.
</p>

<hr>
<h2 id='cox.stuart.test'>Cox Stuart Trend Test</h2><span id='topic+cox.stuart.test'></span>

<h3>Description</h3>

<p>Performs the Cox Stuart test of randomness.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cox.stuart.test(x, alternative)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cox.stuart.test_+3A_x">x</code></td>
<td>
<p>a numeric vector containing the data</p>
</td></tr>
<tr><td><code id="cox.stuart.test_+3A_alternative">alternative</code></td>
<td>
<p>a character string with the alternative hypothesis. Must be one of &quot;<code>two.sided</code>&quot; (default), &quot;<code>left.sided</code>&quot; or &quot;<code>right.sided</code>&quot;. You can specify just the initial letter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Missing values are removed.
</p>
<p>Data is grouped in pairs with the ith observation of the first half paired with the ith observation of the second half of the time-ordered data. If the length of vector X is odd the middle observation is eliminated. The cox stuart test is then simply a sign test applied to these paired data.
</p>
<p>The possible values &quot;<code>two.sided</code>&quot;, &quot;<code>left.sided</code>&quot; and &quot;<code>right.sided</code>&quot; define the alternative hypothesis.
By using the alternative &quot;<code>two.sided</code>&quot; the null hypothesis of randomness is tested against either an upward trend or an downward trend.  By using the alternative &quot;<code>left.sided</code>&quot; the null hypothesis of randomness is tested against an upward trend. By using the alternative &quot;<code>right.sided</code>&quot; the null hypothesis of randomness is tested against a downward trend. 
</p>


<h3>Value</h3>

<p>A list with class &quot;htest&quot; containing the components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>The number of pairs with a signal &quot;+&quot;</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>The number of pairs, after eliminanting ties.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the test performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ayana Mateus
</p>


<h3>References</h3>

<p>Conover, W.J. (1999). <em>Practical Nonparametric Statistics</em>, 3rd edition, John Wiley &amp; Sons (p. 166).
</p>
<p>Cox, D. R. and Stuart, A. (1955). Some quick sign test for trend
in location and dispersion, <em>Biometrika</em>, <b>42</b>, 80-95.
</p>
<p>Sprent, P. and Smeeton, N.C. (2007). <em>Applied Nonparametric Statistical Methods</em>, 4th ed., Chapman and Hall/CRC Texts in Statistical Science (p. 108).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Example 1
## Conover (1999)
## The total annual precipitation recorded each year, for 19 years.
##
precipitation &lt;- c(45.25, 45.83, 41.77, 36.26, 45.37, 52.25, 35.37, 57.16, 35.37, 58.32, 
41.05, 33.72, 45.73, 37.90, 41.72, 36.07, 49.83, 36.24, 39.90)
cox.stuart.test(precipitation)

##
## Example 2
## Sweet potato production, harvested in the United States, between 1868 and 1937.
##
data(sweetpotato)
cox.stuart.test(sweetpotato$production)
</code></pre>

<hr>
<h2 id='difference.sign.test'>Difference Sign Test</h2><span id='topic+difference.sign.test'></span>

<h3>Description</h3>

<p>Performs the nonparametric Difference-sign test of randomness.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>difference.sign.test(x, alternative)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="difference.sign.test_+3A_x">x</code></td>
<td>
<p>a numeric vector containing the data</p>
</td></tr>
<tr><td><code id="difference.sign.test_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis. Must be one of &quot;<code>two.sided</code>&quot; (default), &quot;<code>left.sided</code>&quot; or &quot;<code>right.sided</code>&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Consecutive equal values are eliminated.
</p>
<p>The possible values &quot;<code>two.sided</code>&quot;, &quot;<code>left.sided</code>&quot; and &quot;<code>right.sided</code>&quot; define the alternative hypothesis.
By using the alternative &quot;<code>two.sided</code>&quot; the null hypothesis of randomness is tested against either an increasing or decreasing trend. By using the alternative &quot;<code>left.sided</code>&quot; the null hypothesis of randomness is tested against an decreasing trend. By using the alternative &quot;<code>right.sided</code>&quot; the null hypothesis of randomness is tested against an increasing trend 
</p>


<h3>Value</h3>

<p>A list with class &quot;htest&quot; containing the components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the (normalized) value of the statistic test.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>the size of the data, after the remotion of consecutive duplicate values.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the test performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data.</p>
</td></tr>
<tr><td><code>ds</code></td>
<td>
<p>the total number of positive diferences (not shown on screen).</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>the mean value of the statistic DS (not shown on screen).</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>the variance of the statistic DS (not shown on screen).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ayana Mateus and Frederico Caeiro
</p>


<h3>References</h3>

<p>Brockwell, P.J. and Davis, R.A. (2002). <em>Introduction to Time Series and Forecasting</em>, 2nd edition, Springer (p. 37).
</p>
<p>Mateus, A. and Caeiro, F. (2013). Comparing several tests of randomness based on the difference of observations. In T. Simos, G. Psihoyios and Ch. Tsitouras (eds.), <em>AIP Conf. Proc.</em> <b>1558</b>, 809&ndash;812.
</p>
<p>Moore, G. H. and Wallis, W. A. (1943). Time Series Significance
Tests Based on Signs of Differences, <em>Journal of the
American Statistical Association</em>, <b>38</b>, 153&ndash;154.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Example 1
## Annual Canadian Lynx trappings 1821-1934 in Canada.
## Available in datasets package
##
## Not run: plot(lynx)
difference.sign.test(lynx)

##
## Example 2
## Sweet potato production, harvested in the United States, between 1868 and 1937.
## Available in this package.
##
data(sweetpotato)
difference.sign.test(sweetpotato$production)
</code></pre>

<hr>
<h2 id='permut'>
Generate all permutations of <code class="reqn">m</code> elements of a vector
</h2><span id='topic+permut'></span>

<h3>Description</h3>

<p>Generate all permutations of <code>x</code> taken <code class="reqn">m</code> at a time. If argument FUN is not NULL, applies a function given by the argument to each permutation. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permut(x, m=length(x), FUN=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permut_+3A_x">x</code></td>
<td>
<p>vector source for permutations.</p>
</td></tr>
<tr><td><code id="permut_+3A_m">m</code></td>
<td>
<p>number of elements to choose. Default is <code>m=length(x)</code>.</p>
</td></tr>
<tr><td><code id="permut_+3A_fun">FUN</code></td>
<td>
<p>function to be applied to each permutation; default NULL means the identity, i.e., to return the permutation.</p>
</td></tr>
<tr><td><code id="permut_+3A_...">...</code></td>
<td>
<p>optionally, further arguments to FUN.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on function <code>permutations</code> from package <code>gtools</code>. This function is required for the computation of the exact p-value of some randomness tests.
</p>


<h3>Value</h3>

<p>A matrix with one permutation, or the value returned by FUN, in each line.
</p>

<hr>
<h2 id='randtests.aux'>
Auxiliar function
</h2><span id='topic+randtests.aux'></span>

<h3>Description</h3>

<p>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randtests.aux(x, method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="randtests.aux_+3A_x">x</code></td>
<td>
<p>data vector.</p>
</td></tr>
<tr><td><code id="randtests.aux_+3A_method">method</code></td>
<td>
<p>number of elements to choose. Default is <code>m=length(n)</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='rank.test'>
Mann-Kendall Rank Test
</h2><span id='topic+rank.test'></span>

<h3>Description</h3>

<p>Performs the Mann-Kendall rank test of randomness.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rank.test(x, alternative)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rank.test_+3A_x">x</code></td>
<td>
<p>a numeric vector containing the observations</p>
</td></tr>
<tr><td><code id="rank.test_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis. Must be one of &quot;<code>two.sided</code>&quot; (default), &quot;<code>left.sided</code>&quot; or &quot;<code>right.sided</code>&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Missing values are removed.
</p>
<p>The possible <code>alternative</code> values are &quot;<code>two.sided</code>&quot;, &quot;<code>left.sided</code>&quot; and &quot;<code>right.sided</code>&quot; define the alternative hypothesis. By using the alternative &quot;<code>left.sided</code>&quot; the null of randomness is tested against a downward trend. By using the alternative &quot;<code>right.sided</code>&quot; the null hypothesis of randomness is tested against a upward trend.
</p>


<h3>Value</h3>

<p>A list with class &quot;htest&quot; containing the components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the normalized statistic test.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>The size n of the data.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the test performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>the value of the (non normalized) P statistic.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>the mean value of the P statistic.</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>the variance of the P statistic.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ayana Mateus and Frederico Caeiro</p>


<h3>References</h3>

<p>Brockwell, P.J. and Davis, R.A. (2002). <em>Introduction to Time Series and Forecasting</em>, 2nd edition, Springer (p. 37).
</p>
<p>Mann, H.B. (1945). Nonparametric test against trend. <em>Econometrica</em>, <b>13</b>, 245&ndash;259.
</p>
<p>Kendall, M. (1990). <em>Rank correlation methods</em>, 5th edition. Oxford University Press, USA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Example 1
## Sweet potato yield per acre, 1868-1937 in the United States.
## Available in this package.
##
data(sweetpotato)
rank.test(sweetpotato$yield)

##
## Example 2
## Old Faithful Geyser Data on Eruption time in mins.
## Available in R package datasets.
##
rank.test(faithful$eruptions)
</code></pre>

<hr>
<h2 id='Runs'>
Distribution of the Wald Wolfowitz Runs Statistic
</h2><span id='topic+druns'></span><span id='topic+pruns'></span><span id='topic+qruns'></span><span id='topic+rruns'></span>

<h3>Description</h3>

<p>Probability function, distribution function, quantile function and random generation for the distribution of the Runs statistic obtained from samples with <code class="reqn">n_1</code> and <code class="reqn">n_2</code> elements of each type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>druns(x, n1, n2, log = FALSE)
pruns(q, n1, n2, lower.tail = TRUE, log.p = FALSE)
qruns(p, n1, n2, lower.tail = TRUE, log.p = FALSE)
rruns(n, n1, n2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Runs_+3A_x">x</code>, <code id="Runs_+3A_q">q</code></td>
<td>
<p>a numeric vector of quantiles.</p>
</td></tr>
<tr><td><code id="Runs_+3A_p">p</code></td>
<td>
<p>a numeric vector of probabilities.</p>
</td></tr>
<tr><td><code id="Runs_+3A_n">n</code></td>
<td>
<p>number of observations to return.</p>
</td></tr>
<tr><td><code id="Runs_+3A_n1">n1</code>, <code id="Runs_+3A_n2">n2</code></td>
<td>
<p>the number of elements of first and second type, respectively.</p>
</td></tr>
<tr><td><code id="Runs_+3A_log">log</code>, <code id="Runs_+3A_log.p">log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td></tr>
<tr><td><code id="Runs_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are P[X <code class="reqn">\le</code> x] otherwise, P[X &gt; x].</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The Runs distribution has probability function
</p>
<p style="text-align: center;"><code class="reqn">
P(R=r)=
\left\{
\begin{array}{cc}
\frac{2{n_1-1 \choose r/2-1}{n_2-1 \choose r/2-1}}{{n_1+n_2 \choose n_1}}, &amp;  \mbox{if } r \mbox{ is even}\\
\frac{{n_1-1 \choose (r-1)/2}{n_2-1 \choose (r-3)/2}\,+\,{n_1-1 \choose (r-3)/2}{n_2-1 \choose (r-1)/2}}{{n_1+n_2 \choose n_1}},  &amp;  \mbox{if } r \mbox{ is odd}\\
\end{array}
\right.
%\qquad r=2,3,\ldots, n_1+n_2.
</code>
</p>

<p>for <code class="reqn">r=2,3,\ldots, 2\min(n_1+n_2)+c</code> with <code class="reqn">c=0</code> if <code class="reqn">n_1=n_2</code> or <code class="reqn">c=1</code> if <code class="reqn">n_1 \neq n_2</code>.
</p>
<p>If an element of <code>x</code> is not integer, the result of <code>druns</code> is zero.
</p>
<p>The quantile is defined as the smallest value <code class="reqn">x</code> such that <code class="reqn">F(x) \ge p</code>, where <code class="reqn">F</code> is the distribution function.
</p>


<h3>Value</h3>

<p><code>druns</code> gives the probability function, <code>pruns</code> gives the distribution function and <code>qruns</code> gives the quantile function.
</p>


<h3>References</h3>

<p>Swed, F.S. and Eisenhart, C. (1943). 
Tables for Testing Randomness of Grouping in a Sequence of Alternatives, <em>Ann. Math Statist.</em> <b>14</b>(1), 66-87.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Example: Distribution Function
## Creates Table I in Swed and Eisenhart (1943), p. 70,
## with n1 = 2 and n1 &lt;= n2 &lt;= 20
##
m &lt;- NULL
for (i in 2:20){
  m &lt;- rbind(m, pruns(2:5,2,i))  
}
rownames(m)=2:20
colnames(m)=2:5
#
#              2         3         4 5
# 2  0.333333333 0.6666667 1.0000000 1
# 3  0.200000000 0.5000000 0.9000000 1
# 4  0.133333333 0.4000000 0.8000000 1
# 5  0.095238095 0.3333333 0.7142857 1
# 6  0.071428571 0.2857143 0.6428571 1
# 7  0.055555556 0.2500000 0.5833333 1
# 8  0.044444444 0.2222222 0.5333333 1
# 9  0.036363636 0.2000000 0.4909091 1
# 10 0.030303030 0.1818182 0.4545455 1
# 11 0.025641026 0.1666667 0.4230769 1
# 12 0.021978022 0.1538462 0.3956044 1
# 13 0.019047619 0.1428571 0.3714286 1
# 14 0.016666667 0.1333333 0.3500000 1
# 15 0.014705882 0.1250000 0.3308824 1
# 16 0.013071895 0.1176471 0.3137255 1
# 17 0.011695906 0.1111111 0.2982456 1
# 18 0.010526316 0.1052632 0.2842105 1
# 19 0.009523810 0.1000000 0.2714286 1
# 20 0.008658009 0.0952381 0.2597403 1
# 
</code></pre>

<hr>
<h2 id='runs.test'>
Wald-Wolfowitz Runs Test
</h2><span id='topic+runs.test'></span>

<h3>Description</h3>

<p>Performs the Wald-Wolfowitz runs test of randomness for continuous data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runs.test(x, alternative, threshold, pvalue, plot)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runs.test_+3A_x">x</code></td>
<td>
<p>a numeric vector containing the observations</p>
</td></tr>
<tr><td><code id="runs.test_+3A_alternative">alternative</code></td>
<td>
<p>a character string with the alternative hypothesis. Must be one of &quot;<code>two.sided</code>&quot; (default), &quot;<code>left.sided</code>&quot; or &quot;<code>right.sided</code>&quot;. You can specify just the initial letter.</p>
</td></tr>
<tr><td><code id="runs.test_+3A_threshold">threshold</code></td>
<td>
<p>the cut-point to transform the data into a dichotomous vector</p>
</td></tr>
<tr><td><code id="runs.test_+3A_pvalue">pvalue</code></td>
<td>
<p>a character string specifying the method used to compute the p-value. Must be one of normal (default), or exact.</p>
</td></tr> 
<tr><td><code id="runs.test_+3A_plot">plot</code></td>
<td>
<p>a logic value to select whether a plot should be created. If 'TRUE', then the graph will be plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data is transformed into a dichotomous vector according as each values is above or below a given <code>threshold</code>. Values equal to the level are removed from the sample. 
</p>
<p>The default <code>threshold</code> value used in applications is the sample median which give us the special case of this test with <code class="reqn">n_1=n_2</code>, the runs test above and below the median.
</p>
<p>The possible <code>alternative</code> values are &quot;<code>two.sided</code>&quot;, &quot;<code>left.sided</code>&quot; and &quot;<code>right.sided</code>&quot; define the alternative hypothesis. By using the alternative &quot;<code>left.sided</code>&quot; the null of randomness is tested against a trend. By using the alternative &quot;<code>right.sided</code>&quot; the null hypothesis of randomness is tested against a first order negative serial correlation.
</p>


<h3>Value</h3>

<p>A list with class &quot;htest&quot; containing the components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the normalized statistic test.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>a vector with the sample size, and the values of <code class="reqn">n_1</code> and <code class="reqn">n_2</code>.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the test performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data.</p>
</td></tr>
<tr><td><code>runs</code></td>
<td>
<p>the total number of runs (not shown on screen).</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>the mean value of the statistic test (not shown on screen).</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>the variance of the statistic test (not shown on screen).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Frederico Caeiro</p>


<h3>References</h3>

<p>Brownlee, K. A. (1965). <em>Statistical Theory and Methodology in Science and Engineering</em>, 2nd ed. New York: Wiley.
</p>
<p>Gibbons, J.D. and Chakraborti, S. (2003). <em>Nonparametric Statistical Inference</em>, 4th ed. (pp. 78&ndash;86).
URL: <a href="http://books.google.pt/books?id=dPhtioXwI9cC&amp;lpg=PA97&amp;ots=ZGaQCmuEUq">http://books.google.pt/books?id=dPhtioXwI9cC&amp;lpg=PA97&amp;ots=ZGaQCmuEUq</a>
</p>
<p>Wald, A. and Wolfowitz, J. (1940). On a test whether two samples are from the same population, <em>The Annals of Mathematical Statistics</em> <b>11</b>, 147&ndash;162. doi:10.1214/aoms/1177731909. <a href="https://projecteuclid.org/journals/annals-of-mathematical-statistics/volume-11/issue-2/On-a-Test-Whether-Two-Samples-are-from-the-Same/10.1214/aoms/1177731909.full">https://projecteuclid.org/journals/annals-of-mathematical-statistics/volume-11/issue-2/On-a-Test-Whether-Two-Samples-are-from-the-Same/10.1214/aoms/1177731909.full</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Example 1
## Data from example in Brownlee (1965), p. 223.
## Results of 23 determinations, ordered in time, of the density of the earth.
##
earthden &lt;- c(5.36, 5.29, 5.58, 5.65, 5.57, 5.53, 5.62, 5.29, 5.44, 5.34, 5.79, 
5.10, 5.27, 5.39, 5.42, 5.47, 5.63, 5.34, 5.46, 5.30, 5.75, 5.68, 5.85)
runs.test(earthden)


##
## Example 2
## Sweet potato yield per acre, harvested in the United States, between 1868 and 1937.
## Data available in this package.
##
data(sweetpotato)
runs.test(sweetpotato$yield)
</code></pre>

<hr>
<h2 id='sweetpotato'>
Sweet potato production
</h2><span id='topic+sweetpotato'></span>

<h3>Description</h3>

<p>Sweetpotato Production, Yield per Acre and Acreage harvested in the United States, between 1868 and 1937. This data was already studied in Moore and Wallis (1941).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sweetpotato)
</code></pre>


<h3>Format</h3>

<p>A list with 70 observations on 4 vectors: <code>year</code>, <code>production</code>, <code>yield</code> and <code>acreage</code>. 
</p>


<h3>Source</h3>

<p>Agricultural Statistics 1939, p. 243.<br />
URL: <a href="http://archive.org/stream/agriculturalsat00unit#page/243/mode/1up">http://archive.org/stream/agriculturalsat00unit#page/243/mode/1up</a>
</p>
<p>Moore, G.H. and  Wallis, W.A. (1941). A Significance Test for Time Series and Other Ordered Observations. Technical paper. <em>NBER</em>.
URL: <a href="http://papers.nber.org/books/wall41-1">http://papers.nber.org/books/wall41-1</a>
</p>

<hr>
<h2 id='turning.point.test'>
Turning Point Test
</h2><span id='topic+turning.point.test'></span>

<h3>Description</h3>

<p>Performs the nonparametric Turning Point test of randomness.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>turning.point.test(x, alternative)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="turning.point.test_+3A_x">x</code></td>
<td>
<p>a numeric vector containing the data</p>
</td></tr>
<tr><td><code id="turning.point.test_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis. Must be one of &quot;<code>two.sided</code>&quot; (default), &quot;<code>left.sided</code>&quot; or &quot;<code>right.sided</code>&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Repeated consecutive observations are removed from data.
</p>
<p>The possible values &quot;<code>two.sided</code>&quot;, &quot;<code>left.sided</code>&quot; and &quot;<code>right.sided</code>&quot; define the alternative hypothesis.
By using the alternative &quot;<code>two.sided</code>&quot; the null hypothesis of randomness is tested against either a positive or negative serial correlation between neighbouring observations. </p>


<h3>Value</h3>

<p>A list with class &quot;htest&quot; containing the components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the (normalized) value of the statistic test.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>the size of the data, after the remotion of consecutive duplicate values.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the test performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data.</p>
</td></tr>
<tr><td><code>tp</code></td>
<td>
<p>the value of the TP statistic (not shown on screen).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ayana Mateus and Frederico Caeiro
</p>


<h3>References</h3>

<p>Brockwell, P.J. and Davis, R.A. (2002). <em>Introduction to Time Series and Forecasting</em>, 2nd edition, Springer (p. 36).
</p>
<p>Mateus, A. and Caeiro, F. (2013). Comparing several tests of randomness based on the difference of observations. In T. Simos, G. Psihoyios and Ch. Tsitouras (eds.), <em>AIP Conf. Proc.</em> <b>1558</b>, 809&ndash;812.
</p>
<p>Moore, G.H. and  Wallis, W.A. (1943). Time Series Significance Tests Based on Signs of Differences. <em>Journal of the
American Statistical Association</em>, <b>38</b>, 153&ndash;154.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Example 1
##
data(sweetpotato)
turning.point.test(sweetpotato$yield)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
