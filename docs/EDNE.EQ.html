<!DOCTYPE html><html><head><title>Help for package EDNE.EQ</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EDNE.EQ}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#EDNE.EQ'>
<p>The EDNE-test for equivalence</p></a></li>
<li><a href='#EDNE.EQ-package'>
<p>Implements the EDNE-Test for Equivalence</p></a></li>
<li><a href='#EDNE.EQ.dissolution.profiles'>
<p>The EDNE-test for equivalence for dissolution profile data</p></a></li>
<li><a href='#ex_data_JoBS'>
<p>Example dataset from Hoffelder et al. (2015)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Implements the EDNE-Test for Equivalence</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-09-24</td>
</tr>
<tr>
<td>Author:</td>
<td>Thomas Hoffelder</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Hoffelder &lt;thomas.hoffelder@boehringer-ingelheim.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Package implements the EDNE-test for equivalence
    according to Hoffelder et al. (2015) &lt;<a href="https://doi.org/10.1080%2F10543406.2014.920344">doi:10.1080/10543406.2014.920344</a>&gt;.
    "EDNE" abbreviates "Euclidean Distance between the 
    Non-standardized Expected values".
    The EDNE-test for equivalence is a multivariate two-sample equivalence test. 
    Distance measure of the test is the Euclidean distance.
    The test is an asymptotically valid test for the family of distributions 
    fulfilling the assumptions of the multivariate central limit theorem 
    (see Hoffelder et al.,2015).
    The function EDNE.EQ() implements the EDNE-test for equivalence 
    according to Hoffelder et al. (2015).
    The function EDNE.EQ.dissolution.profiles() implements a variant 
    of the EDNE-test for equivalence analyses of dissolution profiles
    (see Suarez-Sharp et al.,2020 &lt;<a href="https://doi.org/10.1208%2Fs12248-020-00458-9">doi:10.1208/s12248-020-00458-9</a>&gt;).
    EDNE.EQ.dissolution.profiles() checks whether the quadratic mean of the 
    differences of the expected values of both dissolution profile populations 
    is statistically significantly smaller than 10 [\% of label claim]. 
    The current regulatory standard approach for equivalence analyses of 
    dissolution profiles is the similarity factor f2.
    The statistical hypotheses underlying EDNE.EQ.dissolution.profiles()
    coincide with the hypotheses for f2 (see Hoffelder et al.,2015, 
    Suarez-Sharp et al., 2020).</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-09-24 12:44:19 UTC; hoffelde</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-09-28 09:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='EDNE.EQ'>
The EDNE-test for equivalence
</h2><span id='topic+EDNE.EQ'></span>

<h3>Description</h3>

<p>The function <code>EDNE.EQ()</code> implements the EDNE-test for equivalence according to Hoffelder et al. (2015). It is a multivariate two-sample equivalence procedure. Distance measure of the test is the Euclidean distance.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EDNE.EQ(X, Y, eq_margin, alpha = 0.05, print.results = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EDNE.EQ_+3A_x">X</code></td>
<td>

<p>numeric data matrix of the first sample (REF). The rows of <code>X</code> contain the individual observations of the REF sample, the columns contain the variables/components of the multivariate sample. 
</p>
</td></tr>
<tr><td><code id="EDNE.EQ_+3A_y">Y</code></td>
<td>

<p>numeric data matrix of the second sample (TEST). The rows of <code>Y</code> contain the individual observations of the TEST sample, the columns contain the variables/components of the multivariate sample. 
</p>
</td></tr>
<tr><td><code id="EDNE.EQ_+3A_eq_margin">eq_margin</code></td>
<td>

<p>numeric (&gt;0). The equivalence margin of the test. 
</p>
</td></tr>
<tr><td><code id="EDNE.EQ_+3A_alpha">alpha</code></td>
<td>

<p>numeric (0&lt;<code>alpha</code>&lt;1). The significance level of the EDNE-test for equivalence. Usually set to 0.05 which is the default.
</p>
</td></tr>
<tr><td><code id="EDNE.EQ_+3A_print.results">print.results</code></td>
<td>

<p>logical; if TRUE (default) summary statistics and test results are printed in the output. If NO no output is created 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements the EDNE-test for equivalence. Distance measure of the test is the Euclidean distance. The test is an asymptotically valid test for the family of distributions fulfilling the assumptions of the multivariate central limit theorem (for further details see Hoffelder et al.,2015).   
</p>


<h3>Value</h3>

<p>a data frame; three columns containing the results of the test
</p>
<table>
<tr><td><code>p.value</code></td>
<td>
<p>numeric; the p-value of the equivalence test according to Hoffelder et al. (2015)</p>
</td></tr>
<tr><td><code>testresult.num</code></td>
<td>
<p>numeric; 0 (null hypothesis of nonequivalence not rejected) or 1 (null hypothesis of nonequivalence rejected, decision in favor of equivalence)</p>
</td></tr>
<tr><td><code>testresult.text</code></td>
<td>
<p>character; test result of the test in text mode</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thomas Hoffelder &lt;thomas.hoffelder at boehringer-ingelheim.com&gt;
</p>


<h3>References</h3>

<p>Hoffelder, T., Goessl, R., Wellek, S. (2015). Multivariate Equivalence Tests for Use in Pharmaceutical Development. <em>Journal of Biopharmaceutical Statistics</em>, 25:3, 417-437.
URL: <a href="http://dx.doi.org/10.1080/10543406.2014.920344">http://dx.doi.org/10.1080/10543406.2014.920344</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A recalculation of the three-dimensional EDNE example evaluation 
# in Hoffelder et al. (2015) can be done with the following code:

data(ex_data_JoBS)
REF_JoBS &lt;- cbind(ex_data_JoBS[ which(ex_data_JoBS$Group=='REF'), ]
            [c("Diss_15_min","Diss_20_min","Diss_25_min")])
TEST_JoBS &lt;- cbind(ex_data_JoBS[ which(ex_data_JoBS$Group=='TEST'), ]
            [c("Diss_15_min","Diss_20_min","Diss_25_min")])
equivalence_margin_JoBS &lt;- 297
test_EDNE_JoBS &lt;- EDNE.EQ(X=REF_JoBS
                          , Y=TEST_JoBS
                          , eq_margin=equivalence_margin_JoBS
                          , print.results = TRUE)
</code></pre>

<hr>
<h2 id='EDNE.EQ-package'>
Implements the EDNE-Test for Equivalence
</h2><span id='topic+EDNE.EQ-package'></span>

<h3>Description</h3>

<p>Package implements the EDNE-test for equivalence
    according to Hoffelder et al. (2015) &lt;DOI:10.1080/10543406.2014.920344&gt;.
    &quot;EDNE&quot; abbreviates &quot;Euclidean Distance between the 
    Non-standardized Expected values&quot;.
    The EDNE-test for equivalence is a multivariate two-sample equivalence test. 
    Distance measure of the test is the Euclidean distance.
    The test is an asymptotically valid test for the family of distributions 
    fulfilling the assumptions of the multivariate central limit theorem 
    (see Hoffelder et al.,2015).
    The function EDNE.EQ() implements the EDNE-test for equivalence 
    according to Hoffelder et al. (2015).
    The function EDNE.EQ.dissolution.profiles() implements a variant 
    of the EDNE-test for equivalence analyses of dissolution profiles
    (see Suarez-Sharp et al.,2020 &lt;DOI:10.1208/s12248-020-00458-9&gt;).
    EDNE.EQ.dissolution.profiles() checks whether the quadratic mean of the 
    differences of the expected values of both dissolution profile populations 
    is statistically significantly smaller than 10 [% of label claim]. 
    The current regulatory standard approach for equivalence analyses of 
    dissolution profiles is the similarity factor f2.
    The statistical hypotheses underlying EDNE.EQ.dissolution.profiles()
    coincide with the hypotheses for f2 (see Hoffelder et al.,2015, 
    Suarez-Sharp et al., 2020).
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> EDNE.EQ</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Implements the EDNE-Test for Equivalence</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-09-24</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Thomas Hoffelder</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Thomas Hoffelder &lt;thomas.hoffelder@boehringer-ingelheim.com&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Package implements the EDNE-test for equivalence
    according to Hoffelder et al. (2015) &lt;DOI:10.1080/10543406.2014.920344&gt;.
    "EDNE" abbreviates "Euclidean Distance between the 
    Non-standardized Expected values".
    The EDNE-test for equivalence is a multivariate two-sample equivalence test. 
    Distance measure of the test is the Euclidean distance.
    The test is an asymptotically valid test for the family of distributions 
    fulfilling the assumptions of the multivariate central limit theorem 
    (see Hoffelder et al.,2015).
    The function EDNE.EQ() implements the EDNE-test for equivalence 
    according to Hoffelder et al. (2015).
    The function EDNE.EQ.dissolution.profiles() implements a variant 
    of the EDNE-test for equivalence analyses of dissolution profiles
    (see Suarez-Sharp et al.,2020 &lt;DOI:10.1208/s12248-020-00458-9&gt;).
    EDNE.EQ.dissolution.profiles() checks whether the quadratic mean of the 
    differences of the expected values of both dissolution profile populations 
    is statistically significantly smaller than 10 [% of label claim]. 
    The current regulatory standard approach for equivalence analyses of 
    dissolution profiles is the similarity factor f2.
    The statistical hypotheses underlying EDNE.EQ.dissolution.profiles()
    coincide with the hypotheses for f2 (see Hoffelder et al.,2015, 
    Suarez-Sharp et al., 2020).</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> MASS</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
EDNE.EQ                 The EDNE-test for equivalence
EDNE.EQ-package         Implements the EDNE-Test for Equivalence
EDNE.EQ.dissolution.profiles
                        The EDNE-test for equivalence for dissolution
                        profile data
ex_data_JoBS            Example dataset from Hoffelder et al. (2015)
</pre>


<h3>Author(s)</h3>

<p>Thomas Hoffelder
</p>
<p>Maintainer: Thomas Hoffelder &lt;thomas.hoffelder@boehringer-ingelheim.com&gt;
</p>


<h3>References</h3>

<p>EMA (2010). Guidance on the Investigation of Bioequivalence.
European Medicines Agency, CHMP, London. Doc. Ref.: CPMP/EWP/QWP/1401/98 Rev. 1/ Corr **. 
URL: <a href="https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf">https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf</a>
</p>
<p>FDA (1997). Guidance for Industry: Dissolution Testing of Immediate Release Solid Oral Dosage Forms. 
Food and Drug Administration FDA, CDER, Rockville.
URL: <a href="https://www.fda.gov/media/70936/download">https://www.fda.gov/media/70936/download</a>
</p>
<p>Hoffelder, T., Goessl, R., Wellek, S. (2015). Multivariate Equivalence Tests for Use in Pharmaceutical Development. <em>Journal of Biopharmaceutical Statistics</em>, 25:3, 417-437.
URL: <a href="http://dx.doi.org/10.1080/10543406.2014.920344">http://dx.doi.org/10.1080/10543406.2014.920344</a>
</p>
<p>Suarez-Sharp, S., Abend, A., Hoffelder, T., Leblond, D., Delvadia, P., Kovacs, E., Diaz, D.A. (2020). In Vitro Dissolution Profiles Similarity Assessment in Support of Drug Product Quality: What, How, When - Workshop Summary Report. <em>The AAPS Journal</em>, 22:74.
URL: <a href="http://dx.doi.org/10.1208/s12248-020-00458-9">http://dx.doi.org/10.1208/s12248-020-00458-9</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A recalculation of the three-dimensional EDNE example evaluation 
# in Hoffelder et al. (2015) can be done with the following code:

data(ex_data_JoBS)
REF_JoBS &lt;- cbind(ex_data_JoBS[ which(ex_data_JoBS$Group=='REF'), ]
                  [c("Diss_15_min","Diss_20_min","Diss_25_min")])
TEST_JoBS &lt;- cbind(ex_data_JoBS[ which(ex_data_JoBS$Group=='TEST'), ]
                   [c("Diss_15_min","Diss_20_min","Diss_25_min")])
equivalence_margin_EDNE_JoBS &lt;- 297
test_EDNE_JoBS &lt;- EDNE.EQ(X=REF_JoBS
                          , Y=TEST_JoBS
                          , eq_margin=equivalence_margin_EDNE_JoBS
                          , print.results = TRUE)


# Apart from simulation errors, a recalculation of the EDNE results 
# of some parts (normal distribution only) of the simulation study in 
# Hoffelder et al. (2015) can be done with the following code. Please note that
# the simulation takes approximately 7 minutes for 50.000 simulation 
# runs (number_of_simu_runs &lt;- 50000). To shorten calculation time for 
# test users, number_of_simu_runs is set to 100 here and can/should be adapted.

library(MASS)
number_of_simu_runs &lt;- 100
set.seed(2020)

mu1 &lt;- c(41,76,97)
mu2 &lt;- mu1 - c(10,10,10)
SIGMA_1 &lt;- matrix(data = c(537.4 , 323.8 , 91.8 ,
                           323.8 , 207.5 , 61.7 ,
                           91.8  , 61.7  , 26.1) ,ncol = 3)
SIGMA_2 &lt;- matrix(data = c(324.1 , 233.6 , 24.5 ,
                           233.6 , 263.5 , 61.4 ,
                           24.5  , 61.4  , 32.5) ,ncol = 3)
SIGMA   &lt;- matrix(data = c(430.7 , 278.7 , 58.1 ,
                           278.7 , 235.5 , 61.6 ,
                           58.1  , 61.6  , 29.3) ,ncol = 3)


SIMULATION_SIZE_EDNE &lt;- function(disttype , Hom , Var , mu_1 , mu_2 
                                  ,  n_per_group , n_simus ) {
  
  n_success_EDNE &lt;- 0
  if 	( Hom == "Yes" ) 	{
    COVMAT_1 &lt;- SIGMA
    COVMAT_2 &lt;- SIGMA
  }
  else 	   {
    COVMAT_1 &lt;- SIGMA_1
    COVMAT_2 &lt;- SIGMA_2
  } 
  if 	( Var == "Low" ) 	{
    COVMAT_1 &lt;- COVMAT_1 / 4
    COVMAT_2 &lt;- COVMAT_2 / 4
  }
  
  d &lt;- ncol(COVMAT_1)
  Mean_diff &lt;- mu_1 - mu_2          # Difference of both exp. values
  dist_edne &lt;- crossprod(Mean_diff) # true EDNE distance and equivalence margin
  
  if 	( n_per_group == 10 ) 	{
    cat("Expected value sample 1:",mu_1,"\n",
        "Expected value sample 2:",mu_2,"\n",
        "Covariance matrix sample 1:",COVMAT_1,"\n",
        "Covariance matrix sample 2:",COVMAT_2,"\n",
        "EM_EDNE:",dist_edne,"\n")
  }  
  
  for (i in 1:n_simus)  {
    if 	( disttype == "Normal" ) 	{
      REF &lt;- mvrnorm(n = n_per_group, mu=mu_1, Sigma=COVMAT_1)
      TEST&lt;- mvrnorm(n = n_per_group, mu=mu_2, Sigma=COVMAT_2)
    }
    n_success_EDNE  &lt;- n_success_EDNE + EDNE.EQ.dissolution.profiles(X=REF
                                      , Y=TEST
                                      , print.results = FALSE)$testresult.num
  }
  empirical_succ_prob_EDNE  &lt;- n_success_EDNE / n_simus  
  simuresults  &lt;- data.frame(dist = disttype , Hom = Hom , Var = Var 
                            , dimension = d , em_edne = dist_edne   
                            , sample.size = n_per_group 
                            , empirical.size.edne = empirical_succ_prob_EDNE)
}

SIMULATION_LOOP_SAMPLE_SIZE &lt;- function(disttype , Hom , Var , mu_1 , mu_2 
                                        ,  n_simus ) {
  
  run_10  &lt;- SIMULATION_SIZE_EDNE(disttype = disttype , Hom = Hom , Var = Var 
                                  , mu_1 = mu_1 , mu_2 = mu_2 
                                  , n_per_group = 10 , n_simus = n_simus) 
  run_30  &lt;- SIMULATION_SIZE_EDNE(disttype = disttype , Hom = Hom , Var = Var 
                                  , mu_1 = mu_1 , mu_2 = mu_2 
                                  , n_per_group = 30 , n_simus = n_simus) 
  run_50  &lt;- SIMULATION_SIZE_EDNE(disttype = disttype , Hom = Hom , Var = Var 
                                  , mu_1 = mu_1 , mu_2 = mu_2 
                                  , n_per_group = 50 , n_simus = n_simus) 
  run_100 &lt;- SIMULATION_SIZE_EDNE(disttype = disttype , Hom = Hom , Var = Var 
                                  , mu_1 = mu_1 , mu_2 = mu_2 
                                  , n_per_group = 100 , n_simus = n_simus) 
  RESULT_MATRIX &lt;- rbind(run_10 , run_30 , run_50 , run_100)
  RESULT_MATRIX                               
}

simu_1 &lt;- SIMULATION_LOOP_SAMPLE_SIZE(disttype = "Normal", Hom = "Yes" 
                                      , Var = "High" 
                                      , mu_1 = mu1  
                                      , mu_2 = mu2 
                                      , n_simus = number_of_simu_runs)
simu_2 &lt;- SIMULATION_LOOP_SAMPLE_SIZE(disttype = "Normal", Hom = "Yes" 
                                      , Var = "Low" 
                                      , mu_1 = mu1  
                                      , mu_2 = mu2 
                                      , n_simus = number_of_simu_runs)
simu_3 &lt;- SIMULATION_LOOP_SAMPLE_SIZE(disttype = "Normal", Hom = "No" 
                                      , Var = "High" 
                                      , mu_1 = mu1  
                                      , mu_2 = mu2 
                                      , n_simus = number_of_simu_runs)
simu_4 &lt;- SIMULATION_LOOP_SAMPLE_SIZE(disttype = "Normal", Hom = "No" 
                                      , Var = "Low" 
                                      , mu_1 = mu1  
                                      , mu_2 = mu2 
                                      , n_simus = number_of_simu_runs)

FINAL_RESULT &lt;- rbind(simu_1 , simu_2 , simu_3 , simu_4)

cat("****  Simu results n_simu_runs: ",number_of_simu_runs,"   **** \n")
FINAL_RESULT

</code></pre>

<hr>
<h2 id='EDNE.EQ.dissolution.profiles'>
The EDNE-test for equivalence for dissolution profile data
</h2><span id='topic+EDNE.EQ.dissolution.profiles'></span>

<h3>Description</h3>

<p>The function <code>EDNE.EQ.dissolution.profiles()</code> implements a variant of the EDNE-test for equivalence with a concrete equivalence margin for analyses of dissolution profiles. It is a multivariate two-sample equivalence procedure. Distance measure of the test is the Euclidean distance. The equivalence margin is compliant with current regulatory requirements. (see Hoffelder et al.,2015). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EDNE.EQ.dissolution.profiles(X, Y, alpha = 0.05, print.results = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EDNE.EQ.dissolution.profiles_+3A_x">X</code></td>
<td>

<p>numeric data matrix of the first sample (REF). The rows of <code>X</code> contain the individual observations of the REF sample, the columns contain the variables/components of the multivariate sample. More precisely, the variables are the measured dissolution time points and the rows contain the individual dissolution profiles.
</p>
</td></tr>
<tr><td><code id="EDNE.EQ.dissolution.profiles_+3A_y">Y</code></td>
<td>

<p>numeric data matrix of the second sample (TEST). The rows of <code>Y</code> contain the individual observations of the TEST sample, the columns contain the variables/components of the multivariate sample. More precisely, the variables are the measured dissolution time points and the rows contain the individual dissolution profiles.
</p>
</td></tr>
<tr><td><code id="EDNE.EQ.dissolution.profiles_+3A_alpha">alpha</code></td>
<td>

<p>numeric (0&lt;<code>alpha</code>&lt;1). The significance level of the test. Usually set to 0.05 which is the default.
</p>
</td></tr>
<tr><td><code id="EDNE.EQ.dissolution.profiles_+3A_print.results">print.results</code></td>
<td>

<p>logical; if TRUE (default) summary statistics and test results are printed in the output. If NO no output is created 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements a variant of the EDNE-test for equivalence with a concrete equivalence margin for analyses of dissolution profiles. The current regulatory standard approach for comparing dissolution profiles is the similarity factor f2 (see FDA, 1997, EMA, 2010, among others). Analogous to f2 the equivalence margin implemented in this function is defined by a shift of 10 [% of label claim] at all dissolution time points. Thus, the statistical hypotheses of f2 and <code>EDNE.EQ.dissolution.profiles()</code> coincide (see Hoffelder et al.,2015, Suarez-Sharp et al., 2020). The test checks whether the quadratic mean of the differences between REF and TEST mean profiles is statistically significantly smaller than 10%. 
</p>
<p>With f2, the current regulatory standard approach for comparing dissolution 
profiles, the type I error cannot be controlled. According to EMA (2010)
&quot;similarity acceptance limits should be pre-defined and justified and not be 
greater than a 10% difference&quot;. The functions
</p>

<ul>
<li> <p><code>EDNE.EQ.dissolution.profiles</code>
</p>
</li>
<li> <p><code><a href="T2EQ.html#topic+T2EQ.dissolution.profiles.hoffelder">T2EQ.dissolution.profiles.hoffelder</a></code>
</p>
</li></ul>

<p>and f2 have in common that they all check wether a kind of average difference 
between the expected values is smaller than 10 [% of label claim]
(see Suarez-Sharp et al., 2020). Thus, the methods 
</p>

<ul>
<li> <p><code>EDNE.EQ.dissolution.profiles</code>
</p>
</li>
<li> <p><code><a href="T2EQ.html#topic+T2EQ.dissolution.profiles.hoffelder">T2EQ.dissolution.profiles.hoffelder</a></code>
</p>
</li></ul>

<p>are compliant with current regulatory requirements. In contrast to the 
standard approach f2 they 
allow (at least approximate) type I error control.
</p>


<h3>Value</h3>

<p>a data frame; three columns containing the results of the test
</p>
<table>
<tr><td><code>p.value</code></td>
<td>
<p>numeric; the p-value of the equivalence test according to Hoffelder et al. (2015)</p>
</td></tr>
<tr><td><code>testresult.num</code></td>
<td>
<p>numeric; 0 (null hypothesis of nonequivalence not rejected) or 1 (null hypothesis of nonequivalence rejected, decision in favor of equivalence)</p>
</td></tr>
<tr><td><code>testresult.text</code></td>
<td>
<p>character; test result of the test in text mode</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thomas Hoffelder &lt;thomas.hoffelder at boehringer-ingelheim.com&gt;
</p>


<h3>References</h3>

<p>EMA (2010). Guidance on the Investigation of Bioequivalence.
European Medicines Agency, CHMP, London. Doc. Ref.: CPMP/EWP/QWP/1401/98 Rev. 1/ Corr **. 
URL: <a href="https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf">https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf</a>
</p>
<p>FDA (1997). Guidance for Industry: Dissolution Testing of Immediate Release Solid Oral Dosage Forms. 
Food and Drug Administration FDA, CDER, Rockville.
URL: <a href="https://www.fda.gov/media/70936/download">https://www.fda.gov/media/70936/download</a>
</p>
<p>Hoffelder, T., Goessl, R., Wellek, S. (2015). Multivariate Equivalence Tests for Use in Pharmaceutical Development. <em>Journal of Biopharmaceutical Statistics</em>, 25:3, 417-437.
URL: <a href="http://dx.doi.org/10.1080/10543406.2014.920344">http://dx.doi.org/10.1080/10543406.2014.920344</a>
</p>
<p>Suarez-Sharp, S., Abend, A., Hoffelder, T., Leblond, D., Delvadia, P., Kovacs, E., Diaz, D.A. (2020). In Vitro Dissolution Profiles Similarity Assessment in Support of Drug Product Quality: What, How, When - Workshop Summary Report. <em>The AAPS Journal</em>, 22:74.
URL: <a href="http://dx.doi.org/10.1208/s12248-020-00458-9">http://dx.doi.org/10.1208/s12248-020-00458-9</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Apart from simulation errors, a recalculation of the EDNE results 
# of some parts (normal distribution only) of the simulation study in 
# Hoffelder et al. (2015) can be done with the following code. Please note that
# the simulation takes approximately 7 minutes for 50.000 simulation 
# runs (number_of_simu_runs &lt;- 50000). To shorten calculation time for 
# test users, number_of_simu_runs is set to 100 here and can/should be adapted.

library(MASS)
number_of_simu_runs &lt;- 100
set.seed(2020)

mu1 &lt;- c(41,76,97)
mu2 &lt;- mu1 - c(10,10,10)
SIGMA_1 &lt;- matrix(data = c(537.4 , 323.8 , 91.8 ,
                           323.8 , 207.5 , 61.7 ,
                           91.8  , 61.7  , 26.1) ,ncol = 3)
SIGMA_2 &lt;- matrix(data = c(324.1 , 233.6 , 24.5 ,
                           233.6 , 263.5 , 61.4 ,
                           24.5  , 61.4  , 32.5) ,ncol = 3)
SIGMA   &lt;- matrix(data = c(430.7 , 278.7 , 58.1 ,
                           278.7 , 235.5 , 61.6 ,
                           58.1  , 61.6  , 29.3) ,ncol = 3)


SIMULATION_SIZE_EDNE &lt;- function(disttype , Hom , Var , mu_1 , mu_2 
                                  ,  n_per_group , n_simus ) {
  
  n_success_EDNE &lt;- 0
  if 	( Hom == "Yes" ) 	{
    COVMAT_1 &lt;- SIGMA
    COVMAT_2 &lt;- SIGMA
  }
  else 	   {
    COVMAT_1 &lt;- SIGMA_1
    COVMAT_2 &lt;- SIGMA_2
  } 
  if 	( Var == "Low" ) 	{
    COVMAT_1 &lt;- COVMAT_1 / 4
    COVMAT_2 &lt;- COVMAT_2 / 4
  }
  
  d &lt;- ncol(COVMAT_1)
  Mean_diff &lt;- mu_1 - mu_2          # Difference of both exp. values
  dist_edne &lt;- crossprod(Mean_diff) # true EDNE distance and equivalence margin
  
  if 	( n_per_group == 10 ) 	{
    cat("Expected value sample 1:",mu_1,"\n",
        "Expected value sample 2:",mu_2,"\n",
        "Covariance matrix sample 1:",COVMAT_1,"\n",
        "Covariance matrix sample 2:",COVMAT_2,"\n",
        "EM_EDNE:",dist_edne,"\n")
  }  
  
  for (i in 1:n_simus)  {
    if 	( disttype == "Normal" ) 	{
      REF &lt;- mvrnorm(n = n_per_group, mu=mu_1, Sigma=COVMAT_1)
      TEST&lt;- mvrnorm(n = n_per_group, mu=mu_2, Sigma=COVMAT_2)
    }
    n_success_EDNE  &lt;- n_success_EDNE + EDNE.EQ.dissolution.profiles(X=REF
                                      , Y=TEST
                                      , print.results = FALSE)$testresult.num
  }
  empirical_succ_prob_EDNE  &lt;- n_success_EDNE / n_simus  
  simuresults  &lt;- data.frame(dist = disttype , Hom = Hom , Var = Var 
                            , dimension = d , em_edne = dist_edne   
                            , sample.size = n_per_group 
                            , empirical.size.edne = empirical_succ_prob_EDNE)
}

SIMULATION_LOOP_SAMPLE_SIZE &lt;- function(disttype , Hom , Var , mu_1 , mu_2 
                                        ,  n_simus ) {
  
  run_10  &lt;- SIMULATION_SIZE_EDNE(disttype = disttype , Hom = Hom , Var = Var 
                                  , mu_1 = mu_1 , mu_2 = mu_2 
                                  , n_per_group = 10 , n_simus = n_simus) 
  run_30  &lt;- SIMULATION_SIZE_EDNE(disttype = disttype , Hom = Hom , Var = Var 
                                  , mu_1 = mu_1 , mu_2 = mu_2 
                                  , n_per_group = 30 , n_simus = n_simus) 
  run_50  &lt;- SIMULATION_SIZE_EDNE(disttype = disttype , Hom = Hom , Var = Var 
                                  , mu_1 = mu_1 , mu_2 = mu_2 
                                  , n_per_group = 50 , n_simus = n_simus) 
  run_100 &lt;- SIMULATION_SIZE_EDNE(disttype = disttype , Hom = Hom , Var = Var 
                                  , mu_1 = mu_1 , mu_2 = mu_2 
                                  , n_per_group = 100 , n_simus = n_simus) 
  RESULT_MATRIX &lt;- rbind(run_10 , run_30 , run_50 , run_100)
  RESULT_MATRIX                               
}

simu_1 &lt;- SIMULATION_LOOP_SAMPLE_SIZE(disttype = "Normal", Hom = "Yes" 
                                      , Var = "High" 
                                      , mu_1 = mu1  
                                      , mu_2 = mu2 
                                      , n_simus = number_of_simu_runs)
simu_2 &lt;- SIMULATION_LOOP_SAMPLE_SIZE(disttype = "Normal", Hom = "Yes" 
                                      , Var = "Low" 
                                      , mu_1 = mu1  
                                      , mu_2 = mu2 
                                      , n_simus = number_of_simu_runs)
simu_3 &lt;- SIMULATION_LOOP_SAMPLE_SIZE(disttype = "Normal", Hom = "No" 
                                      , Var = "High" 
                                      , mu_1 = mu1  
                                      , mu_2 = mu2 
                                      , n_simus = number_of_simu_runs)
simu_4 &lt;- SIMULATION_LOOP_SAMPLE_SIZE(disttype = "Normal", Hom = "No" 
                                      , Var = "Low" 
                                      , mu_1 = mu1  
                                      , mu_2 = mu2 
                                      , n_simus = number_of_simu_runs)

FINAL_RESULT &lt;- rbind(simu_1 , simu_2 , simu_3 , simu_4)

cat("****  Simu results n_simu_runs: ",number_of_simu_runs,"   **** \n")
FINAL_RESULT
</code></pre>

<hr>
<h2 id='ex_data_JoBS'>
Example dataset from Hoffelder et al. (2015)
</h2><span id='topic+ex_data_JoBS'></span>

<h3>Description</h3>

<p>Multivariate example dataset of dissolution profiles. Dataset consists of two three-dimensional samples. The names of the three variables are &quot;Diss_15_min&quot;,&quot;Diss_20_min&quot; and &quot;Diss_25_min&quot;. Variable &quot;Group&quot; discriminates between first sample (<code>Group == "REF"</code>) and second sample (<code>Group == "Test"</code>). Sample size is 12 per group.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ex_data_JoBS")</code></pre>


<h3>Format</h3>

<p>A data frame with 24 observations on the following 4 variables.
</p>

<dl>
<dt><code>Group</code></dt><dd><p>a factor with levels <code>REF</code> <code>TEST</code></p>
</dd>
<dt><code>Diss_15_min</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Diss_20_min</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Diss_25_min</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>Example dataset from Hoffelder et al. (2015).
</p>


<h3>Source</h3>

<p>Hoffelder, T., Goessl, R., Wellek, S. (2015), &quot;Multivariate Equivalence Tests for Use in Pharmaceutical Development&quot;, <em>Journal of Biopharmaceutical Statistics</em>, 25:3, 417-437.
</p>


<h3>References</h3>

<p>URL: <a href="http://dx.doi.org/10.1080/10543406.2014.920344">http://dx.doi.org/10.1080/10543406.2014.920344</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ex_data_JoBS)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
