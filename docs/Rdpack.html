<!DOCTYPE html><html><head><title>Help for package Rdpack</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rdpack}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.asym_compare'><p>Tensor comparison and asymmetric comparison between two vectors</p></a></li>
<li><a href='#.bsdup'><p>Escape backslashes and percent in Rd code</p></a></li>
<li><a href='#.capture_promptAny'><p>Internal functions used by reprompt</p></a></li>
<li><a href='#append_to_Rd_list'>
<p>Add content to the element of an Rd object or fragment at a given</p>
position</a></li>
<li><a href='#c_Rd'><p>Concatenate Rd objects or pieces</p></a></li>
<li><a href='#char2Rdpiece'>
<p>Convert a character vector to Rd piece</p></a></li>
<li><a href='#compare_usage1'>
<p>Compare usage entries for a function to its actual arguments</p></a></li>
<li><a href='#deparse_usage'><p>Convert f_usage objects to text appropriate for usage sections in</p>
Rd files
</a></li>
<li><a href='#ereprompt'><p>Update an Rd file and open it in an editor</p></a></li>
<li><a href='#format_funusage'><p>Format the usage text of functions</p></a></li>
<li><a href='#get_bibentries'><p>Get all references from a Bibtex file</p></a></li>
<li><a href='#get_sig_text'>
<p>Produce the textual form of the  signatures of available methods for</p>
an S4 generic function
</a></li>
<li><a href='#get_usage_text'>
<p>Get the text of the usage section of Rd documentation</p></a></li>
<li><a href='#insert_all_ref'><p>Insert references cited in packages</p></a></li>
<li><a href='#insert_citeOnly'><p>Generate citations from bibtex keys</p></a></li>
<li><a href='#insert_ref'><p>Insert bibtex references in Rd and roxygen2 documentation</p></a></li>
<li><a href='#inspect_args'>
<p>Inspect the argument section of an Rd object</p></a></li>
<li><a href='#inspect_Rd'>
<p>Inspect and update an Rd object or file</p></a></li>
<li><a href='#inspect_signatures'>
<p>Inspect signatures of S4 methods</p></a></li>
<li><a href='#inspect_slots'>
<p>Inspect the slots of an S4 class</p></a></li>
<li><a href='#inspect_usage'>
<p>Inspect the usage section in an Rd object</p></a></li>
<li><a href='#list_Rd'><p>Combine Rd fragments</p></a></li>
<li><a href='#makeVignetteReference'><p>Make bibtex references for vignettes</p></a></li>
<li><a href='#parse_pairlist'>
<p>Parse formal arguments of functions</p>
</a></li>
<li><a href='#parse_Rdname'>
<p>Parse the name section of an Rd object</p></a></li>
<li><a href='#parse_Rdpiece'>
<p>Parse a piece of Rd source text</p></a></li>
<li><a href='#parse_Rdtext'>
<p>Parse Rd source text as the contents of a section</p></a></li>
<li><a href='#parse_text'><p>Parse expressions residing in character vectors</p></a></li>
<li><a href='#parse_usage_text'>
<p>Parse usage text</p></a></li>
<li><a href='#predefined'>
<p>Tables of predefined sections and types of pieces of Rd objects</p></a></li>
<li><a href='#promptPackageSexpr'><p>Generates a shell of documentation for an installed package</p></a></li>
<li><a href='#promptUsage'>
<p>Generate usage text for functions and methods</p>
</a></li>
<li><a href='#Rd_combo'><p>Manipulate a number of Rd files</p></a></li>
<li><a href='#Rdapply'><p>Apply a function over an Rd object</p></a></li>
<li><a href='#Rdo_append_argument'>
<p>Append an item for a new argument to an Rd object</p></a></li>
<li><a href='#Rdo_collect_aliases'><p>Collect aliases or other metadata from an Rd object</p></a></li>
<li><a href='#Rdo_empty_sections'><p>Find or remove empty sections in Rd objects</p></a></li>
<li><a href='#Rdo_fetch'><p>Get help pages as Rd objects</p></a></li>
<li><a href='#Rdo_flatinsert'><p>Insert or remove content in an Rd fragment</p></a></li>
<li><a href='#Rdo_get_argument_names'><p>Get the names of arguments in usage sections of Rd objects</p></a></li>
<li><a href='#Rdo_get_insert_pos'>
<p>Find the position of an &quot;Rd_tag&quot;</p></a></li>
<li><a href='#Rdo_get_item_labels'><p>Get the labels of items in an Rd object</p></a></li>
<li><a href='#Rdo_insert'>
<p>Insert a new element in an Rd object possibly surrounding it with new</p>
lines</a></li>
<li><a href='#Rdo_insert_element'>
<p>Insert a new element in an Rd object</p></a></li>
<li><a href='#Rdo_is_newline'>
<p>Check if an Rd fragment represents a newline character</p></a></li>
<li><a href='#Rdo_locate'><p>Find positions of elements in an Rd object</p></a></li>
<li><a href='#Rdo_locate_leaves'><p>Find leaves of an Rd object using a predicate</p></a></li>
<li><a href='#Rdo_macro'>
<p>Format Rd fragments as macros (todo: a baffling title!)</p></a></li>
<li><a href='#Rdo_modify'>
<p>Replace or modify parts of Rd objects</p></a></li>
<li><a href='#Rdo_modify_simple'><p>Simple modification of Rd objects</p></a></li>
<li><a href='#Rdo_piecetag'>
<p>Give information about Rd elements</p></a></li>
<li><a href='#Rdo_remove_srcref'><p>Remove srcref attributes from Rd objects</p></a></li>
<li><a href='#Rdo_reparse'><p>Reparse an Rd object</p></a></li>
<li><a href='#Rdo_sections'><p>Locate the sections in Rd objects</p></a></li>
<li><a href='#Rdo_set_section'>
<p>Replace a section in an Rd file</p></a></li>
<li><a href='#Rdo_show'><p>Convert an Rd object to text and show it</p></a></li>
<li><a href='#Rdo_tag'>
<p>Set the Rd_tag of an object</p></a></li>
<li><a href='#Rdo_tags'><p>Give the Rd tags at the top level of an Rd object</p></a></li>
<li><a href='#rdo_text_restore'><p>Ensure exported fragments of Rd are as the original</p></a></li>
<li><a href='#Rdo_which'><p>Find elements of Rd objects for which a condition is true</p></a></li>
<li><a href='#Rdo2Rdf'>
<p>Convert an Rd object to Rd file format</p></a></li>
<li><a href='#Rdpack_bibstyles'><p>Set up a custom style for references in help pages</p></a></li>
<li><a href='#Rdpack-package'>



<p>Update and Manipulate Rd Documentation Objects</p></a></li>
<li><a href='#Rdreplace_section'><p> Replace the contents of a section in one or more Rd files</p></a></li>
<li><a href='#rebib'><p>Work with bibtex references in Rd documentation</p></a></li>
<li><a href='#reprompt'><p>Update the documentation of a topic</p></a></li>
<li><a href='#RStudio_reprompt'><p>Call reprompt based on RStudio editor contents</p></a></li>
<li><a href='#S4formals'><p>Give the formal arguments of an S4 method</p></a></li>
<li><a href='#set_Rdpack_bibstyle'><p>Set up a bibstyle defined in Rdpack</p></a></li>
<li><a href='#update_aliases_tmp'><p>Update aliases for methods in Rd objects</p></a></li>
<li><a href='#viewRd'><p>View Rd files in a source package</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Update and Manipulate Rd Documentation Objects</td>
</tr>
<tr>
<td>Version:</td>
<td>2.6</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for manipulation of R documentation objects,
    including functions reprompt() and ereprompt() for updating 'Rd'
    documentation for functions, methods and classes; 'Rd' macros for
    citations and import of references from 'bibtex' files for use in
    'Rd' files and 'roxygen2' comments; 'Rd' macros for evaluating and
    inserting snippets of 'R' code and the results of its evaluation or
    creating graphics on the fly; and many functions for manipulation of
    references and Rd files.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://geobosh.github.io/Rdpack/">https://geobosh.github.io/Rdpack/</a> (doc),
<a href="https://github.com/GeoBosh/Rdpack">https://github.com/GeoBosh/Rdpack</a> (devel)</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/GeoBosh/Rdpack/issues">https://github.com/GeoBosh/Rdpack/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15.0), methods</td>
</tr>
<tr>
<td>Imports:</td>
<td>tools, utils, rbibutils (&ge; 1.3)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>grDevices, testthat, rstudioapi, rprojroot, gbRd</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-08 11:27:46 UTC; georgi</td>
</tr>
<tr>
<td>Author:</td>
<td>Georgi N. Boshnakov [aut, cre],
  Duncan Murdoch [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Georgi N. Boshnakov &lt;georgi.boshnakov@manchester.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-08 14:40:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='.asym_compare'>Tensor comparison and asymmetric comparison between two vectors</h2><span id='topic+.asym_compare'></span><span id='topic+.ocompare'></span>

<h3>Description</h3>

<p>Tensor comparison and asymmetric comparison between two
vectors.</p>


<h3>Usage</h3>

<pre><code class='language-R'>.ocompare(x, y)

.asym_compare(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".asym_compare_+3A_x">x</code></td>
<td>


</td></tr>
<tr><td><code id=".asym_compare_+3A_y">y</code></td>
<td>


</td></tr>
</table>


<h3>Details</h3>

<p><code>.ocompare</code> (for &quot;outer compare&quot;) returns a matrix whose (i,j)th
element is TRUE if x[i] is identical to y[j], and FALSE otherwise.
</p>
<p><code>.asym_compare</code> calls <code>.ocompare</code> and iterprets its result
asymmetrically. Elements of <code>x</code> that are not in <code>y</code> ae
considered &quot;new&quot;. Similarly, Elements of <code>y</code> that are not in
<code>x</code> ae considered &quot;removed&quot;. Elements that are in both are
&quot;common&quot;.
</p>
<p>Todo: check if the above is correct or the other way round! !!!
</p>


<h3>Value</h3>

<p>For <code>.ocompare</code>, a matrix as described in Details.
</p>
<p>For <code>.asym_compare</code> a list with indices as follows.
</p>
<table>
<tr><td><code>i_new</code></td>
<td>
<p>new elements, indices in <code>x</code> of elements that are not
in <code>y</code>.</p>
</td></tr>
<tr><td><code>i_removed</code></td>
<td>
<p>removed elements, indices in <code>y</code> of elements that are not
in <code>x</code>.</p>
</td></tr>
<tr><td><code>i_common</code></td>
<td>
<p>common elements, indices in <code>x</code> of elements that
are in both, <code>x</code> and <code>y</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class='language-R'>##---- Should be DIRECTLY executable !! ----
</code></pre>

<hr>
<h2 id='.bsdup'>Escape backslashes and percent in Rd code</h2><span id='topic+.bsdup'></span><span id='topic+.bspercent'></span><span id='topic+.anypercent'></span>

<h3>Description</h3>

<p>Escape backslashes and percent in Rd code.</p>


<h3>Usage</h3>

<pre><code class='language-R'>
.bspercent(x)

.anypercent(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".bsdup_+3A_x">x</code></td>
<td>
<p>a character string</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>.bsdup(x)</code> duplicates backslashes.
</p>
<p><code>.bspercent(x)</code> escapes  percent signs.
</p>
<p><code>.anypercent(x)</code> also escapes percent signs but but only if the
<code>Rd_tag</code> attribute of <code>x</code> is not COMMENT.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class='language-R'>##---- Should be DIRECTLY executable !! ----
</code></pre>

<hr>
<h2 id='.capture_promptAny'>Internal functions used by reprompt</h2><span id='topic+.capture_promptAny'></span><span id='topic+.capture_installed_help'></span>

<h3>Description</h3>

<p>Internal functions used by reprompt.</p>


<h3>Usage</h3>

<pre><code class='language-R'>.capture_promptAny(fnam, type, package, final, ..., methods)

.capture_installed_help(fnam, type = NULL, package = NULL,
                        suffix = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".capture_promptAny_+3A_fnam">fnam</code></td>
<td>
<p>extended name of the object, such as &quot;fun&quot;, &quot;gen-methods&quot;,
&quot;S4cl-class&quot; or &quot;pkname-package&quot;, see details.</p>
</td></tr>
<tr><td><code id=".capture_promptAny_+3A_final">final</code></td>
<td>
<p>if TRUE,  put dummy title and description to make the
file immediately usable.</p>
</td></tr>
<tr><td><code id=".capture_promptAny_+3A_...">...</code></td>
<td>
<p>further arguments to pass on to the prompt function(s).</p>
</td></tr>
<tr><td><code id=".capture_promptAny_+3A_methods">methods</code></td>
<td>
<p>methods to consider, used only when describing S4 methods.</p>
</td></tr>
<tr><td><code id=".capture_promptAny_+3A_type">type</code></td>
<td>
<p>type of documentation, such as &quot;methods&quot; and  &quot;class&quot;, see
Details.</p>
</td></tr>
<tr><td><code id=".capture_promptAny_+3A_package">package</code></td>
<td>
<p>the package where to look for objects or documentation,
useful if more objects of the same name exist.</p>
</td></tr>
<tr><td><code id=".capture_promptAny_+3A_suffix">suffix</code></td>
<td>
<p>a character string to be appended to <code>fnam</code> to
obtain the complete name of the help topic, e.g. &quot;-class&quot;,
&quot;-method&quot;.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are used internally by <code>reprompt</code>. It falls back
to them when only when the user has not supplied an Rd file in the
call.
</p>
<p>Note that for editing it is preferable to use the source Rd files
(when available), since some hard coded information in the installed
help may have been produced by more elaborated code in the Rd sources,
most notably Sweave expressions.
</p>
<p><code>.capture_promptAny</code> is used to generate documentation when none
has been supplied by the user or loaded in the session.
<code>.capture_promptAny</code> parses <code>fnam</code> to obtain the name of the
object and the type of the required documentation (function, methods,
class), then generates it. Currently this is done with the built in
functions of the <code>promptXXX</code> family.
</p>
<p><code>.capture_installed_help</code> does exactly that &mdash; it captures the
currently installed requested help topic. This function needs clean
up. It was originally written at a time when both the old and new help
formats where co-existing.
</p>


<h3>Value</h3>

<p>an Rd object on success or a <code>try-error</code> object otherwise
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class='language-R'>##---- Should be DIRECTLY executable !! ----
</code></pre>

<hr>
<h2 id='append_to_Rd_list'>
Add content to the element of an Rd object or fragment at a given
position
</h2><span id='topic+append_to_Rd_list'></span>

<h3>Description</h3>

<p>Add content to the element of an Rd object or fragment at a given
position.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>append_to_Rd_list(rdo, x, pos)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="append_to_Rd_list_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object</p>
</td></tr>
<tr><td><code id="append_to_Rd_list_+3A_x">x</code></td>
<td>
<p>the content to append, an Rd object or a list of Rd objects.</p>
</td></tr>
<tr><td><code id="append_to_Rd_list_+3A_pos">pos</code></td>
<td>
<p>position at which to append <code>x</code>, typically an integer
but may be anything accepted by the operator &quot;[[&quot;.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The element  of <code>rdo</code> at position <code>pos</code> is replaced by its
concatenation with <code>x</code>. The result keeps the &quot;Rd_tag&quot; of
<code>rdo[[pos]]</code>.
</p>
<p>Argument <code>pos</code> may specify a position at any depth of the Rd
object.
</p>
<p>This function is relatively low level and is mainly for use by other
functions.
</p>


<h3>Value</h3>

<p>the modified <code>rdo</code> object
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class='language-R'>#rdoseq &lt;- utils:::.getHelpFile(help("seq"))
rdoseq &lt;- Rdo_fetch("seq", "base")
iusage &lt;- which(tools:::RdTags(rdoseq) == "\\usage")
iusage
attr(rdoseq[[iusage]], "Rd_tag")

## append a new line after the last usage line
rdoseq2 &lt;- append_to_Rd_list(rdoseq, list(Rdo_newline()), iusage)

## Suppose that we wish to describe the function 'sequence' in the same Rd file.
## We append an usage statement for 'sequence()', without worrying about its
## actual signature.
rdoseq2 &lt;- append_to_Rd_list(rdoseq2, list(Rdo_Rcode("sequence()")), iusage)
Rdo_show(rdoseq2)

## the two operations can be done in one step
rdoseq3 &lt;- append_to_Rd_list(rdoseq, list(Rdo_newline(), Rdo_Rcode("sequence()")), iusage)
Rdo_show(rdoseq3)

## now run reprompt() to update rdoseq3, namely:
##    (1) it corrects the signature of 'sequence' in section \usage.
##    (2) reports new argument "nvec"
##    (3) inserts \item for the new argument(s) in section \arguments.
reprompt(rdoseq3, filename=NA)
</code></pre>

<hr>
<h2 id='c_Rd'>Concatenate Rd objects or pieces</h2><span id='topic+c_Rd'></span>

<h3>Description</h3>

<p>Concatenates Rd objects or pieces</p>


<h3>Usage</h3>

<pre><code class='language-R'>c_Rd(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="c_Rd_+3A_...">...</code></td>
<td>
<p>objects to be concatenated, Rd objects or character
strings, see &lsquo;Details&rsquo;.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The arguments may be a mixture of lists and character strings. The
lists are typically &quot;Rd&quot; objects or pieces. The character strings may
also be elements of &quot;Rd&quot; objects carrying &quot;Rd_tag&quot; attributes. The
&quot;Rd_tag&quot; attribute of character strings for which it is missing is set
to &quot;TEXT&quot;. Finally, each character element of <code>"\dots"</code> is
enclosed in <code>list</code>.
</p>
<p>Eventually all arguments become lists and they are concatenated using
<code>c()</code>. If any of the arguments is of class &quot;Rd&quot;, the class of the
result is set to &quot;Rd&quot;. Otherwise, the &quot;Rd_tag&quot; of the result is set to
the first (if any) non-null &quot;Rd_tag&quot; in the arguments.
</p>
<p>The structure of &quot;Rd&quot; objects is described by
Murdoch (2010).
</p>


<h3>Value</h3>

<p>An Rd object or a list whose attribute &quot;Rd_tag&quot; is set as descibed in
&lsquo;Details&rsquo; 
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>References</h3>

<p>Duncan Murdoch (2010).
&ldquo;Parsing Rd files.&rdquo;
<a href="https://developer.r-project.org/parseRd.pdf">https://developer.r-project.org/parseRd.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+list_Rd">list_Rd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a1 &lt;- char2Rdpiece("Dummyname", "name")
a2 &lt;- char2Rdpiece("Dummyallias1", "alias")
a3 &lt;- char2Rdpiece("Dummy title", "title")
a4 &lt;- char2Rdpiece("Dummy description", "description")

## The following are equivalent
## (gbRd::Rdo_empty() creates an empty list of class 'Rd')
if(requireNamespace("gbRd")){
b1 &lt;- c_Rd(gbRd::Rdo_empty(), list(a1), list(a2), list(a3), list(a4))
c1 &lt;- c_Rd(gbRd::Rdo_empty(), list(a1, a2, a3, a4))
d1 &lt;- c_Rd(gbRd::Rdo_empty(), list(a1, a2), list(a3, a4))
identical(c1, b1)
identical(c1, d1)
Rdo_show(b1)

## insert a newline
d1n &lt;- c_Rd(gbRd::Rdo_empty(), list(a1, a2), Rdo_newline(), list(a3, a4))
str(d1n)
}

## When most of the arguments are character strings
## the function 'list_Rd' may be more convenient.
u1 &lt;- list_Rd(name = "Dummyname", alias = "Dummyallias1",
              title = "Dummy title", description = "Dummy description",
              Rd_class = TRUE )
Rdo_show(u1)
</code></pre>

<hr>
<h2 id='char2Rdpiece'>
Convert a character vector to Rd piece
</h2><span id='topic+char2Rdpiece'></span>

<h3>Description</h3>

<p>Convert a character vector to Rd piece.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>char2Rdpiece(content, name, force.sec = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="char2Rdpiece_+3A_content">content</code></td>
<td>
<p>a character vector.</p>
</td></tr>
<tr><td><code id="char2Rdpiece_+3A_name">name</code></td>
<td>
<p>name of an Rd macro, a string.</p>
</td></tr>
<tr><td><code id="char2Rdpiece_+3A_force.sec">force.sec</code></td>
<td>
<p>TRUE or FALSE, see &lsquo;Details&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Argument <code>content</code> is converted to an Rd piece using
<code>name</code> to determine the format of the result.
</p>
<p>The <code style="white-space: pre;">&#8288;Rd tag&#8288;</code> of <code>content</code> is set as appropriate for <code>name</code>.
More specifically, if <code>name</code> is the name of a macro (without the
leading '<code style="white-space: pre;">&#8288;\&#8288;</code>') whose content has a known &quot;Rdtag&quot;, that tag is
used. Otherwise the tag is set to &quot;TEXT&quot;.
</p>
<p>If <code>force.sec</code> is TRUE, <code>name</code> is treated as the name of a
top level section of an Rd object. A top level section is exported as
one argument macro if it is a standard section (detected with
<code><a href="#topic+is_Rdsecname">is_Rdsecname</a></code>) and as the two argument macro
&quot;<code style="white-space: pre;">&#8288;\section&#8288;</code>&quot; otherwise.
</p>
<p>If <code>force.sec</code> is FALSE, the content is exported as one argument
macro without further checks.
</p>


<h3>Note</h3>

<p>This function does not attempt to escape special symbols like &lsquo;%&rsquo;.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class='language-R'>## add a keyword section
a1 &lt;- char2Rdpiece("graphics", "keyword")
a1
## "keyword" is a standard Rd top level section, so 'force.sec' is irrelevant
a2 &lt;- char2Rdpiece("graphics", "keyword", force.sec = TRUE)
identical(a1, a2)

## an element suitable to be put in a "usage" section
char2Rdpiece("log(x, base = exp(1))", "usage")

## a user defined section "Todo"
char2Rdpiece("Give more examples for this function.", "Todo", force.sec = TRUE)
</code></pre>

<hr>
<h2 id='compare_usage1'>
Compare usage entries for a function to its actual arguments
</h2><span id='topic+compare_usage1'></span>

<h3>Description</h3>

<p>Compare usage entries for a function to its actual arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_usage1(urdo, ucur)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_usage1_+3A_urdo">urdo</code></td>
<td>

<p>usage text for a function or S3 method from an Rd object or file.
</p>
</td></tr>
<tr><td><code id="compare_usage1_+3A_ucur">ucur</code></td>
<td>
<p>usage generated from the actual object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compares the usage statements for functions in the Rd object or file
<code>urdo</code> to the usage inferred from the actual definitions of the
functions. The comparison is symmetric but the interpretation assumes
that <code>ucur</code> may be more recent.
</p>
<p>Note: do not compare the return value to TRUE with <code>identical</code> or
<code>isTRUE</code>. The attribute makes the returned value not identical to
TRUE in any case.
</p>


<h3>Value</h3>

<p>TRUE if the usages are identical, FALSE otherwise.
The return value has attribute &quot;details&quot;, which is a list providing
details of the comparison. The elements of this list should be
referred by name, since if one of <code>urdo</code> or <code>ucur</code> is NULL
or NA, the list contains only the fields &quot;obj_removed&quot;, &quot;obj_added&quot;,
&quot;rdo_usage&quot;, &quot;cur_usage&quot;, and &quot;alias&quot;.
</p>
<table>
<tr><td><code>identical_names</code></td>
<td>
<p>a logical value, TRUE if the &lsquo;name&rsquo;  is the same in both objects.</p>
</td></tr>
<tr><td><code>obj_removed</code></td>
<td>
<p>names present in <code>urdo</code> but not in <code>ucur</code></p>
</td></tr>
<tr><td><code>obj_added</code></td>
<td>
<p>names present in <code>ucur</code> but not in <code>urdo</code></p>
</td></tr>
<tr><td><code>identical_argnames</code></td>
<td>
<p>a logical value,
TRUE if the argument names in both objects are the same.</p>
</td></tr>
<tr><td><code>identical_defaults</code></td>
<td>
<p>a logical value,
TRUE if the defaults for the arguments in both objects are the same.</p>
</td></tr>
<tr><td><code>identical_formals</code></td>
<td>
<p>a logical value, TRUE if the formals
are the same, i.e. fields <code>identical_argnames</code> and
<code>identical_defaults</code> are both TRUE.</p>
</td></tr>
<tr><td><code>added_argnames</code></td>
<td>
<p>names of arguments in <code>ucur</code> but not in <code>urdo</code>.</p>
</td></tr>
<tr><td><code>removed_argnames</code></td>
<td>
<p>names of arguments in <code>urdo</code> but not in <code>ucur</code>.</p>
</td></tr>
<tr><td><code>names_unchanged_defaults</code></td>
<td>
<p>names of arguments whose defaults are the same.</p>
</td></tr>
<tr><td><code>rdo_usage</code></td>
<td>
<p>a copy of <code>urdo</code>.</p>
</td></tr>
<tr><td><code>cur_usage</code></td>
<td>
<p>a copy of <code>ucur</code>.</p>
</td></tr>
<tr><td><code>alias</code></td>
<td>
<p>alias of the name of the object, see &lsquo;Details&rsquo;.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+inspect_usage">inspect_usage</a></code>
</p>

<hr>
<h2 id='deparse_usage'>Convert f_usage objects to text appropriate for usage sections in
Rd files

</h2><span id='topic+deparse_usage'></span><span id='topic+deparse_usage1'></span><span id='topic+as.character.f_usage'></span>

<h3>Description</h3>

<p>Converts f_usage objects to text appropriate for usage sections in
Rd files. Handles S3 methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deparse_usage(x)
deparse_usage1(x, width = 72)
## S3 method for class 'f_usage'
as.character(x, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deparse_usage_+3A_x">x</code></td>
<td>

<p>an object from class <code>"f_usage"</code>. For <code>deparse_usage</code>,
<code>x</code> can also be a list of <code>"f_usage"</code> objects.
</p>
</td></tr>
<tr><td><code id="deparse_usage_+3A_width">width</code></td>
<td>
<p>maximal width of text on a line.</p>
</td></tr>
<tr><td><code id="deparse_usage_+3A_...">...</code></td>
<td>
<p>ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both, <code>deparse_usage1</code> and the <code>as.character</code> method for
class <code>"f_usage"</code>, convert an <code>"f_usage"</code> object to a
character string suitable for Rd documentation. The
<code>as.character</code> method is the user level function (it just calls
<code>deparse_usage1</code>), <code>deparse_usage1</code> is internal function for
programming. In the example below the first command creates an
<code>"f_usage"</code> object, then the second converts it to character string.
</p>
<pre>(a &lt;- pairlist2f_usage1(formals(cor), "cor"))
##: name      = cor 
##: S3class   =  
##: S4sig     =  
##: infix     = FALSE 
##: fu        = TRUE 
##: argnames  = x y use method 
##: defaults  : y = NULL 
##:             use = "everything" 
##:             method = c("pearson", "kendall", "spearman") 

cat(as.character(a))
##: cor(x, y = NULL, use = "everything", 
##:     method = c("pearson", "kendall", "spearman"))
</pre>
  
<p>Each usage entriy is formatted and, if necessary, split over several
lines. The width (number of characters) on a line can be changed with
argument <code>width</code>.
</p>
<p><code>deparse_usage</code> can be used when <code>x</code> is a list of
<code>"f_usage"</code> objects. It calls <code>deparse_usage1</code> with each of
them and returns a character vector with one element for each
component of <code>x</code>.  When <code>x</code> is an object from class
<code>"f_usage"</code>, <code>deparse_usage</code> is equivalent to
<code>deparse_usage1</code>.
</p>


<h3>Value</h3>

<p>For <code>deparse_usage1</code> and <code>as.character.f_usage</code>, a named
character vector of length one (the name is the function name).
</p>
<p>For <code>deparse_usage</code>, a named character vector with one entry for
the usage text for each function.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+pairlist2f_usage1">pairlist2f_usage1</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cur_wd &lt;- getwd()
tmpdir &lt;- tempdir()
setwd(tmpdir)

## prepare a list of "f_usage" objects
fnseq &lt;- reprompt(seq)            # get and save the help page of "seq"
rdoseq &lt;- tools::parse_Rd(fnseq)  # parse the Rd file
ut &lt;- get_usage_text(rdoseq)      # get the contents of the usage section
cat(ut, "\n")                     #     of seq() (a character string)
utp &lt;- parse_usage_text(ut)       # parse to a list of "f_usage" objects

## deparse the "f_usage" list - each statement gets a separate string
cat(deparse_usage(utp), sep = "\n")

## explore some of the usage entries individually;
## the generic seq() has a boring signature
utp[[1]]
as.character(utp[[1]])
deparse_usage1(utp[[1]])  # same

## the default S3 method is more interesting
utp[[2]]
cat(deparse_usage1(utp[[2]]))
cat(as.character(utp[[2]]))   # same

unlink(fnseq)
setwd(cur_wd)
unlink(tmpdir)
</code></pre>

<hr>
<h2 id='ereprompt'>Update an Rd file and open it in an editor</h2><span id='topic+ereprompt'></span>

<h3>Description</h3>

<p>Update an Rd file and open it in an editor. This is a wrapper for
reprompt with different defaults for some parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ereprompt(..., edit = TRUE, filename = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ereprompt_+3A_...">...</code></td>
<td>

<p>passed on to <code><a href="#topic+reprompt">reprompt</a></code>, see its documentation for
details.</p>
</td></tr>
<tr><td><code id="ereprompt_+3A_edit">edit</code></td>
<td>
<p>if <code>TRUE</code>, the default, open an editor when finished.</p>
</td></tr>
<tr><td><code id="ereprompt_+3A_filename">filename</code></td>
<td>
<p>if <code>TRUE</code>, the default, replace and/or edit the
original Rd file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ereprompt</code> calls <code>reprompt</code> to do the actual job but has
different defaults for the arguments described on this page. By
default, it replaces the original Rd file with the updated
documentation and opens it in an editor. 
</p>


<h3>Value</h3>

<p>called for the side effect of updating Rd documentation file and
opening it in an editor
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+reprompt">reprompt</a></code> which does the actual work
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## this assumes that the current working directory is
## in any subdirectory of the development directory of  Rdpack 
## Not run: 
ereprompt(infile = "reprompt.Rd")

## End(Not run)
</code></pre>

<hr>
<h2 id='format_funusage'>Format the usage text of functions</h2><span id='topic+format_funusage'></span>

<h3>Description</h3>

<p>Formats the usage text of a function so that each line
contains no more than a given number of characters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_funusage(x, name = "", width = 72, realname)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="format_funusage_+3A_x">x</code></td>
<td>
<p>a character vector containing one element for each argument
of the function, see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="format_funusage_+3A_name">name</code></td>
<td>
<p>the name of the function whose usage is described, a
string.</p>
</td></tr>
<tr><td><code id="format_funusage_+3A_width">width</code></td>
<td>
<p>maximal width of each line of output.</p>
</td></tr>
<tr><td><code id="format_funusage_+3A_realname">realname</code></td>
<td>
<p>the printed form of <code>name</code>, see &lsquo;Details&rsquo;, a
string.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>format_funusage</code> formats the usage text of a function for
inclusion in Rd documentation files.  If necessary, it splits the text
into more lines in order to fit it within the requested width.
</p>
<p>Each element of argument <code>x</code> contains the text for one argument
of function <code>name</code> in the form <code>arg</code> or <code>arg = default</code>.
<code>format_funusage</code> does not look into the content of
<code>x</code>, it does the necessary pasting to form the complete usage
text, inserting new lines and indentation to stay within the specified
width.  Elements of <code>x</code> are never split. If an argument (i.e.,
element of <code>x</code>) would cause the width to be exceeded, the entire
argument is moved to the following line.
</p>
<p>The text on the second and subsequent lines of each usage item starts
in the column just after the opening parenthesis which follows the
name of the function on the first line.
</p>
<p>In descriptions of S3 methods and S4 methods, argument <code>name</code> may
be a TeX macro like <code style="white-space: pre;">&#8288;\method{print}{ts}&#8288;</code>. In that case the number
of characters in <code>name</code> has little bearing on the actual number
printed. In this case argument <code>realname</code> is used for counting
both the number of characters on the first line of the usage message
and the indentation for the subsequent lines.
</p>


<h3>Value</h3>

<p>The formatted text as a length one character vector.
</p>


<h3>Note</h3>

<p>Only the width of <code>realname</code> is used (for counting). The
formatted text contains <code>name</code>.
</p>
<p>The width of strings is determined by calling <code>nchar</code> with
argument <code>type</code> set to &quot;width&quot;.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+deparse_usage1">deparse_usage1</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># this function is essentially internal,
# see deparse_usage1 and as.character.f_usage which use it.
</code></pre>

<hr>
<h2 id='get_bibentries'>Get all references from a Bibtex file</h2><span id='topic+get_bibentries'></span>

<h3>Description</h3>

<p>Get all references from a Bibtex file.</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_bibentries(..., package = NULL, bibfile = "REFERENCES.bib", 
               url_only = FALSE, stop_on_error = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_bibentries_+3A_...">...</code></td>
<td>
<p>arguments to be passed on to the file getting functions,
character strings, see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="get_bibentries_+3A_package">package</code></td>
<td>
<p>name of a package, a character string or NULL.</p>
</td></tr>
<tr><td><code id="get_bibentries_+3A_bibfile">bibfile</code></td>
<td>
<p>name of a Bibtex file, a character string.</p>
</td></tr>
<tr><td><code id="get_bibentries_+3A_url_only">url_only</code></td>
<td>

<p>if TRUE, restrict percent escaping to BibTeX field <code>"URL"</code>.</p>
</td></tr> 
<tr><td><code id="get_bibentries_+3A_stop_on_error">stop_on_error</code></td>
<td>

<p>if <code>TRUE</code> stop on error, otherwise issue a warning and return
an empty <code>bibentryRd</code> object.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>get_bibentries</code> parses the specified file.


and sets its
<code>names</code> attribute to the keys of the bib elements
(<code>read.bib()</code> does this since version version 0.4.0 of
<span class="pkg">bibtex</span>, as well). Here is what
<code>get_bibentries</code> does on top of <code>read.bib</code> (the details are
further below): 
</p>

<ul>
<li> <p><code>get_bibentries</code> deals with percent signs in URL's.
</p>
</li>
<li><p> if the current working directory is in the development
directory of <code>package</code>, <code>get_bibentries</code> will first
search for the bib file under that directory.
</p>
</li></ul>

<p><code>bibfile</code> should normally be the base name of the Bibtex file.
Calling <code>get_bibentries</code> without any <code>"\dots"</code> arguments
results in looking for the Bibtex file in the current directory if
package is NULL or missing, and in the installation directory of the
specified package, otherwise.
Argument &quot;...&quot; may be used to specify directories.
If <code>package</code> is missing or NULL, the complete path is obtained
with <code>file.path(..., bibfile)</code>. Otherwise <code>package</code> must be
a package name and the file is taken from the installation directory
of the package. Again, argument &quot;...&quot; can specify subdirectory
as in <code>system.file</code>.
</p>
<p>If the current working directory is in the development directory of
<code>package</code>, the bib file is first sought there before resorting to
the installation directory.
</p>
<p>Although the base <span class="rlang"><b>R</b></span> packages do not have files REFERENCES.bib,
argument <code>package</code> can be set to one of them,
e.g. <code>"base"</code>. This works since package <span class="pkg">bibtex</span> provides bib
files for the core packages.
</p>
<p>By default, <code>get_bibentries</code> escapes unescaped percent signs in
all fields of bibtex objects. To restrict this only to field &quot;url&quot;,
set argument <code>url_only</code> to <code>FALSE</code>.
</p>
<p><code>get_bibentries</code> returns an object from class
<code>"bibentryRd"</code>, which inherits from bibentry. The printing method
for <code>"bibentryRd"</code> unescapes percent signs in URLs for some
styles where the escapes are undesirable. 
</p>


<h3>Value</h3>

<p>a bibentryRd object inheriting from bibentry
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>References</h3>

<p>There are no references for Rd macro <code style="white-space: pre;">&#8288;\insertAllCites&#8288;</code> on this help page.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>r &lt;- get_bibentries(package = "Rdpack")
r
print(r, style = "html")

## Bib from base R packages are disabled in Rdpack v2 (notify the
## maintainer of Rdpack or raise an issue on github if you wish this back).
##
## b &lt;- get_bibentries(package = "stats")
## print(b[[1]], style = "R")
## print(b[[1]], style = "citation")

## here the url field contains percent encoding
fn_url &lt;- system.file("examples", "url_with_percents.bib", package = "Rdpack") 
u &lt;- get_bibentries(bibfile = fn_url)

## the links produced by all of the following are valid
## and can be put in a browser
print(u, style = "html")
print(u, style = "bibtex")
print(u, style = "R")
print(u, style = "text")
print(u, style = "citation")

## The link here contains escapes but when put in a LaTeX document
## which uses the JSS style it generates correct clickable link,
## (see Details section) 
print(u, style = "latex")

## here the journal field contains percent encoding
fn_other &lt;- system.file("examples", "journal_with_percents.bib", package = "Rdpack") 
j &lt;- get_bibentries(bibfile = fn_url)
print(j, style = "html")
print(j, style = "bibtex")
print(j, style = "R")
print(j, style = "text")
print(j, style = "citation")
      
print(j, style = "latex")
</code></pre>

<hr>
<h2 id='get_sig_text'>
Produce the textual form of the  signatures of available methods for
an S4 generic function

</h2><span id='topic+get_sig_text'></span>

<h3>Description</h3>

<p>Produce the textual form of the  signatures of available methods for
an S4 generic function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_sig_text(rdo, package = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_sig_text_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object.</p>
</td></tr>
<tr><td><code id="get_sig_text_+3A_package">package</code></td>
<td>
<p>if of class &quot;character&quot;, give only  methods defined by
<code>package</code>, otherwise give all methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Signatures are found using function <code>findMethodSignatures</code> from
package &quot;methods&quot;.
</p>
<p>Here we find all methods for <code>show()</code> defined in package
<code>"methods"</code> and print the first few of them: 
</p>
<pre>fn &lt;- utils::help("show-methods", package = "methods")
rdo &lt;- utils:::.getHelpFile(fn)
head(get_sig_text(rdo))
##: [1] "signature(object = \"ANY\")"                      
##: [2] "signature(object = \"MethodDefinition\")"         
##: [3] "signature(object = \"MethodDefinitionWithTrace\")"
##: [4] "signature(object = \"MethodSelectionReport\")"    
##: [5] "signature(object = \"MethodWithNext\")"           
##: [6] "signature(object = \"MethodWithNextWithTrace\")"  
</pre>



<h3>Value</h3>

<p>A character vector with one element for each method.
</p>


<h3>Note</h3>

<p>todo: It would be better to call promptMethods() to get the signatures
but in version R-2.13.x I had trouble with argument &lsquo;where&rsquo; (could not
figure out how to use it to restrict to functions from a package; also,
promptMethods() seemed to call the deprecated function
getMethods()). Check how these things stand in current versions of <span class="rlang"><b>R</b></span>,
there may be no problem any more (checked, in 2.14-0 it is the same).
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load another package with some S4 methods ("methods" is already loaded)
require("stats4") 

rdo &lt;- Rdo_fetch("show", package = "methods")
## alternatively:
#fn &lt;- help("show-methods", package = "methods")
#rdo &lt;- utils:::.getHelpFile(fn)

## this will find all methods for "show" in currently loaded packages
## (print only some of them)
head(get_sig_text(rdo))

## this will select only the ones from package "stats4"
get_sig_text(rdo, package = "stats4")

## this is also fine (interactively) but need to choose
## the appropriate element of "fn" if length(fn) &gt; 1
#fn &lt;- help("show-methods")

## this finds nothing
#fn &lt;- help("logLik-methods", package = "methods")
#fn
Rdo_fetch("logLik-methods", package = "methods")

## this does
#fn &lt;- help("logLik-methods", package = "stats4")
#rdo &lt;- utils:::.getHelpFile(fn)
rdo2 &lt;- Rdo_fetch("logLik-methods", package = "stats4")

get_sig_text(rdo2)
get_sig_text(rdo2, package = "stats4")

## only default method defined
## using this:
setGeneric("f1", function(x, y){NULL})
## since the following gives error in pkgdown:
#f1 &lt;- function(x, y){NULL}
#setGeneric("f1")

fn &lt;- tempfile()

reprompt("f1", filename = fn)
rdo &lt;- tools::parse_Rd(fn)
get_sig_text(rdo)

setClass("aRdpack")
setClass("bRdpack")

## several methods defined
setGeneric("f4", function(x, y){NULL})
setMethod("f4", c("numeric", "numeric"), function(x, y){NULL})
setMethod("f4", c("aRdpack", "numeric"), function(x, y){NULL})
setMethod("f4", c("bRdpack", "numeric"), function(x, y){NULL})
setMethod("f4", c("aRdpack", "bRdpack"), function(x, y){NULL})

reprompt("f4", filename = fn)
rdo &lt;- tools::parse_Rd(fn)
get_sig_text(rdo)

unlink(fn)
</code></pre>

<hr>
<h2 id='get_usage_text'>
Get the text of the usage section of Rd documentation
</h2><span id='topic+get_usage_text'></span>

<h3>Description</h3>

<p>Get the text of the usage section of Rd documentation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_usage_text(rdo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_usage_text_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object or a character string</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>rdo</code> is a string, it is parsed to obtain an Rd object.
</p>
<p>The content of section &quot;<code style="white-space: pre;">&#8288;\usage&#8288;</code>&quot; is extracted and converted to string.
</p>


<h3>Value</h3>

<p>a string
</p>


<h3>Note</h3>

<p>todo: <code>get_usage_text</code> can be generalised to any Rd section but it is
better to use a different approach since <code>print.Rd()</code> does not
take care for some details (escaping %, for example). Also, the
functions that use this one assume that it returns <span class="rlang"><b>R</b></span> code, which
may not be the case if the usage section contains Rd comments.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class='language-R'>## get the Rd object documenting Rdo_macro
#h &lt;- utils::help("Rdo_macro", lib.loc = .libPaths())
#rdo &lt;- utils:::.getHelpFile(h)
rdo &lt;- Rdo_fetch("Rdo_macro", "Rdpack")
# extract the usage section and print it:
ut &lt;- get_usage_text(rdo)
cat(ut, sep = "\n")
</code></pre>

<hr>
<h2 id='insert_all_ref'>Insert references cited in packages</h2><span id='topic+insert_all_ref'></span>

<h3>Description</h3>

<p>Insert references cited in packages. </p>


<h3>Usage</h3>

<pre><code class='language-R'>insert_all_ref(refs, style = "", empty_cited = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="insert_all_ref_+3A_refs">refs</code></td>
<td>


<p>a matrix specifying key-package pairs of the references to insert.
Can also be a cached environment, see Details.
</p>
</td></tr>
<tr><td><code id="insert_all_ref_+3A_style">style</code></td>
<td>
<p>a bibstyle, see Details.</p>
</td></tr>
<tr><td><code id="insert_all_ref_+3A_empty_cited">empty_cited</code></td>
<td>

<p>if <code>TRUE</code>, empty the list of currently cited items.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>insert_all_ref</code> is the workhorse behind several Rd macros for
inclusion of references in Rd documentation.
</p>
<p>Argument <code>refs</code> is a two-column character matrix.  The first
column specifies bibtex keys.  To specify more than one key in a
single element, separate them by commas. The second column specifies the
package in which to look for the keys.
</p>
<p>A key equal to &quot;*&quot; requests all keys in the corresponding package. 
</p>
<p><code>insert_all_ref</code> drops duplicated keys, collects the references,
and converts them to Rd textual representation for inclusion in Rd
documentation files.
</p>
<p><code>refs</code> can be a cached environment. This is for internal use and
not documented.
</p>


<h3>Value</h3>

<p>a character string containing a textual representation of the
references, suitable for inclusion in an Rd file
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>References</h3>

<p>Currently there are no citations on this help page. Nevetheless, I
have put <code style="white-space: pre;">&#8288;\insertAllCited{}&#8288;</code> just after this paragraph to show
the message that it prints when there are no citations. This seems
better than printing nothing but it may be argued also that there
should be a warning as well.
</p>
<p>There are no references for Rd macro <code style="white-space: pre;">&#8288;\insertAllCites&#8288;</code> on this help page.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## a reference from package Rdpack
cat(insert_all_ref(matrix(c("Rpack:bibtex", "Rdpack"), ncol = 2)), "\n")

## more than one reference from package Rdpack, separate the keys with commas
cat(insert_all_ref(matrix(c("parseRd,Rpack:bibtex", "Rdpack"), ncol = 2)), "\n")

## all references from package Rdpack
cat(insert_all_ref(matrix(c("*", "Rdpack"), ncol = 2)), "\n")

## all references from package Rdpack and rbibutils
m &lt;- matrix(c("*", "Rdpack",  "*", "rbibutils"), ncol = 2, byrow = TRUE)
cat(insert_all_ref(m), "\n")
</code></pre>

<hr>
<h2 id='insert_citeOnly'>Generate citations from bibtex keys</h2><span id='topic+insert_citeOnly'></span>

<h3>Description</h3>

<p>Generate citations from bibtex keys.</p>


<h3>Usage</h3>

<pre><code class='language-R'>insert_citeOnly(keys, package = NULL, before = NULL, after = NULL,
                bibpunct = NULL, ..., cached_env = NULL,
                cite_only = FALSE, dont_cite = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="insert_citeOnly_+3A_keys">keys</code></td>
<td>

<p>a character string containing bibtex key(s) prefixed with the symbol
<code>@</code>, intermixed with free text. The format is the same as for
Rd macro <code style="white-space: pre;">&#8288;\insertCite&#8288;</code>. Put <code style="white-space: pre;">&#8288;;textual&#8288;</code> at the end of the
string to get a textual citation. Similarly, <code style="white-space: pre;">&#8288;;nobrackets&#8288;</code>
requests parenthesised citation without the enclosing parentheses.
Alternatively, <code>keys</code> can contain one or more keys, separated
by commas.
</p>
</td></tr>
<tr><td><code id="insert_citeOnly_+3A_package">package</code></td>
<td>
<p>name of an R package.</p>
</td></tr>
<tr><td><code id="insert_citeOnly_+3A_before">before</code></td>
<td>
<p>see <code><a href="utils.html#topic+citeNatbib">citeNatbib</a></code>.</p>
</td></tr>
<tr><td><code id="insert_citeOnly_+3A_after">after</code></td>
<td>
<p>see <code><a href="utils.html#topic+citeNatbib">citeNatbib</a></code>.</p>
</td></tr>
<tr><td><code id="insert_citeOnly_+3A_bibpunct">bibpunct</code></td>
<td>
<p>see <code><a href="utils.html#topic+citeNatbib">citeNatbib</a></code>.</p>
</td></tr>
<tr><td><code id="insert_citeOnly_+3A_...">...</code></td>
<td>
<p>further arguments; for internal use.</p>
</td></tr>
<tr><td><code id="insert_citeOnly_+3A_cached_env">cached_env</code></td>
<td>
<p>for internal use.</p>
</td></tr>
<tr><td><code id="insert_citeOnly_+3A_cite_only">cite_only</code></td>
<td>
<p>for internal use.</p>
</td></tr>
<tr><td><code id="insert_citeOnly_+3A_dont_cite">dont_cite</code></td>
<td>
<p>for internal use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the function behind <code style="white-space: pre;">&#8288;\insertCite&#8288;</code> and related macros.
Argument <code>"keys"</code> has the syntax of the first argument of
<code style="white-space: pre;">&#8288;\insertCite&#8288;</code>, see <code><a href="#topic+insertRef">insertRef</a></code> for full details.
</p>


<h3>Value</h3>

<p>a character vector containing the references with Rd markup
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+insert_ref">insert_ref</a></code> for description of all available Rd macros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>insert_citeOnly("@see also @Rpackage:rbibutils and @parseRd", package = "Rdpack")
## (see also Boshnakov and Putman 2020 and Murdoch 2010)

insert_citeOnly("@see also @Rpackage:rbibutils and @parseRd;nobrackets",
  package = "Rdpack")
## see also Boshnakov and Putman 2020 and Murdoch 2010

insert_citeOnly("@see also @Rpackage:rbibutils and @parseRd;textual",
  package = "Rdpack")
## see also Boshnakov and Putman (2020) and Murdoch (2010)
</code></pre>

<hr>
<h2 id='insert_ref'>Insert bibtex references in Rd and roxygen2 documentation</h2><span id='topic+insert_ref'></span><span id='topic+insertRef'></span>

<h3>Description</h3>

<p>Package Rdpack provides Rd macros for inserting references and
citations from bibtex files into R documentation.  Function
<code>insert_ref()</code> is the workhorse behind this mechanism. The
description given on this page should be sufficient, for more details
see the vignette.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insert_ref(key, package = NULL, ..., cached_env = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="insert_ref_+3A_key">key</code></td>
<td>
<p>the bibtex key of the reference, a character string.</p>
</td></tr>
<tr><td><code id="insert_ref_+3A_package">package</code></td>
<td>
<p>the package in which to look for the bibtex file.</p>
</td></tr>
<tr><td><code id="insert_ref_+3A_...">...</code></td>
<td>

<p>further arguments to pass on to <code>get_bibentries()</code>. The only
one of interest to users is <code>bibfile</code>, whose default is
&quot;REFERENCES.bib&quot;, see <code><a href="#topic+get_bibentries">get_bibentries</a></code>.
</p>
</td></tr>
<tr><td><code id="insert_ref_+3A_cached_env">cached_env</code></td>
<td>

<p>environment, used to avoid repeatedly passing the bib
file from scratch, mainly used by the Rd macros.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>insert_ref</code> extracts a bibliograhic reference from a bibtex
file, converts it to Rd format and returns a single string with
embedded newline characters. It is the workhorse in the provided
mechanism but most users do not even need to know about
<code>insert_ref</code>.
</p>
<p>Package <span class="pkg">Rdpack</span> provides several Rd macros for inserting
references and citations in the documentation of a package. All macros
work in both, manually written Rd files and in <span class="pkg">roxygen2</span>
documentation chunks. The macros look for references in file
<code>"REFERENCES.bib"</code> in the root of the installation directory of
the package. When a package is in development mode under
<span class="pkg">devtools</span>, <code>"inst/REFERENCES.bib"</code> in the development
directory of the package is checked first. See also
<code><a href="#topic+get_bibentries">get_bibentries</a></code> but note that while direct calls to
<code>insert_ref()</code> can specify a different file, the filename and the
places where it is looked for are fixed for the Rd macros.
</p>
<p>The description below assumes that <span class="pkg">Rdpack</span> has been added to file
DESCRIPTION, as described in <code><a href="#topic+Rdpack-package">Rdpack-package</a></code> and vignette
<code>"Inserting_bibtex_references"</code>. The Rd macros are put in the
text of documentation sources (&lsquo;Rd&rsquo; files or &lsquo;roxygen2&rsquo;
chunks).
</p>


<h4>Rd macro insertRef</h4>

<p><code style="white-space: pre;">&#8288;\insertRef{key}{package}&#8288;</code> inserts the reference with bibtex key
<code style="white-space: pre;">&#8288;key&#8288;</code> from file <code>"REFERENCES.bib"</code> in package
<code style="white-space: pre;">&#8288;package&#8288;</code>. Argument &lsquo;package&rsquo; can be any installed <span class="rlang"><b>R</b></span>
package, not necessarily the one of the documentation object, as long
as it contains file <code>"REFERENCES.bib"</code> in the root of its
installation directory.  The references are partially processed when
the package is built.
</p>
<p>References inserted with <code style="white-space: pre;">&#8288;\insertRef&#8288;</code> appear in the place where
the macro is put, usually in a dedicated references section
(<code style="white-space: pre;">&#8288;\references&#8288;</code> in Rd files, <code style="white-space: pre;">&#8288;@references&#8288;</code> in roxygen
chunks).
</p>
<p>For example, section &lsquo;References&rsquo; of this help page shows
(among other things)) the rendered results of the following lines in
the Rd source file:
</p>
<pre>
        \insertRef{Rpackage:rbibutils}{Rdpack}
    
        \insertRef{parseRd}{Rdpack}
        
        \insertRef{bibutils6.10}{rbibutils}
    </pre>
<p>A roxygen2 documentation chunk might look like this:
</p>
<pre>
        #' @references
        #' \insertRef{Rpackage:rbibutils}{Rdpack}
        #' 
        #' \insertRef{parseRd}{Rdpack}
        #' 
        #' \insertRef{bibutils6.10}{rbibutils}
    </pre>
<p>The first reference has label <code style="white-space: pre;">&#8288;Rpackage:rbibutils&#8288;</code> and is taken
from file <code>"REFERENCES.bib"</code> in package <span class="pkg">Rdpack</span>. The third
reference is from the file <code>"REFERENCES.bib"</code> in package
<span class="pkg">rbibutils</span>.
</p>
<p>For more details see vignette <code>"Inserting_bibtex_references"</code>.
</p>



<h4>Rd macro insertCite</h4>

<p><code>\insertCite{key}{package}</code> cites the key and records it for use
by <code>\insertAllCited</code>, see below. <code>key</code> can contain more
keys separated by commas.
</p>

<table>
<tr>
 <td style="text-align: left;">
       <code>\insertCite{parseRd,Rpackage:rbibutils}{Rdpack}</code> </td><td style="text-align: left;"> (Murdoch 2010; Boshnakov and Putman 2020) </td>
</tr>
<tr>
 <td style="text-align: left;">
       <code>\insertCite{Rpackage:rbibutils}{Rdpack}</code>   </td><td style="text-align: left;"> (Boshnakov and Putman 2020) </td>
</tr>
<tr>
 <td style="text-align: left;">
       <code>\insertCite{bibutils6.10}{rbibutils}</code> </td><td style="text-align: left;"> (Putnam 2020)
    </td>
</tr>

</table>

<p>By default the citations are parenthesised
(Murdoch 2010).  To get textual citations, like
Murdoch (2010), put the string <code>;textual</code>
at the end of the key. The references in the last two sentences were
produced with <code>\insertCite{parseRd}{Rdpack}</code> and
<code>\insertCite{parseRd;textual}{Rdpack}</code>, respectively.  This
also works with several citations, e.g.
<br />
<code>\insertCite{parseRd,Rpackage:rbibutils;textual}{Rdpack}</code>
produces: Murdoch (2010); Boshnakov and Putman (2020).
</p>
<p>To mix the citations with other text, such as &lsquo;see also&rsquo; and
&lsquo;chapter 3&rsquo;, write the list of keys as free text, starting it
with the symbol <code>@</code> and prefixing each key with it.  The
<code>@</code> symbol will not appear in the output. For example, the
following code
</p>
<pre>
        \insertCite{@see also @parseRd and @Rpackage:rbibutils}{Rdpack},
    
        \insertCite{@see also @parseRd; @Rpackage:rbibutils}{Rdpack},
    
        \insertCite{@see also @parseRd and @Rpackage:rbibutils;textual}{Rdpack}.
    </pre>
<p>produces:
</p>

<table>
<tr>
 <td style="text-align: left;">
      (see also Murdoch 2010 and Boshnakov and Putman 2020), </td>
</tr>
<tr>
 <td style="text-align: left;">
      (see also Murdoch 2010; Boshnakov and Putman 2020), </td>
</tr>
<tr>
 <td style="text-align: left;">
      see also Murdoch (2010) and Boshnakov and Putman (2020).
    </td>
</tr>

</table>

<p>In the parenthesised form, adding <code style="white-space: pre;">&#8288;;nobrackets&#8288;</code> at the end of the
list of keys causes the enclosing parentheses to be dropped. This is
useful if you wish to use markup for the text surrounding the
references. For example,
</p>
<pre>
        (\emph{see also}  \insertCite{@@parseRd; @Rpackage:rbibutils;nobrackets}{Rdpack}).
      </pre>
<p>gives: (<em>see also</em>  Murdoch 2010; Boshnakov and Putman 2020).
Without &lsquo;<code style="white-space: pre;">&#8288;;nobrackets&#8288;</code>&rsquo; the result would be
(<em>see also</em>  (Murdoch 2010; Boshnakov and Putman 2020)).
</p>



<h4>Rd macro insertNoCite</h4>

<p>The macro <code>\insertNoCite{key}{package}</code> records one or more
references for <code>\insertAllCited</code> but does not cite it. Setting
<code>key</code> to <code>*</code> will include all references from the specified
package. For example, <code>\insertNoCite{parseRd}{Rdpack}</code> and
<code>\insertNoCite{*}{rbibutils}</code> record the specified references
for inclusion by <code>\insertAllCited</code>.
</p>



<h4>Rd macro insertAllCited</h4>

<p><code>\insertAllCited</code> inserts all references cited with
<code>\insertCite</code> and <code>\insertNoCite</code>. Putting this macro
in the references section will keep the references up to date automatically. 
The Rd section may look something like:
</p>
<pre>
       \references{    
         \insertAllCited{}
       }
    </pre>
<p>or in roxygen2, the references chunk might look like this:
</p>
<pre>
       #' @references
       #'   \insertAllCited{}
    </pre>



<h4>Rd macro insertNoCite</h4>

<p><code>\insertCiteOnly{key}{package}</code> is as <code>\insertCite</code> but
does not include the key in the list of references for
<code>\insertAllCited</code>.
</p>



<h3>Value</h3>

<p>for <code>insert_ref</code>, a character string
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>References</h3>

<p>For illustrative purposes there are two sets of citations below
The first set of references is obtained with <code>\insertRef</code> for
each reference: 
</p>
<p>Duncan Murdoch (2010).
&ldquo;Parsing Rd files.&rdquo;
<a href="https://developer.r-project.org/parseRd.pdf">https://developer.r-project.org/parseRd.pdf</a>.
</p>
<p>Georgi
N. Boshnakov, Chris Putman (2020).
<em>rbibutils: Convert Between Bibliography Formats</em>.
<a href="https://CRAN.R-project.org/package=rbibutils">https://CRAN.R-project.org/package=rbibutils</a>.
</p>
<p>Putnam C (2020).
&ldquo;Library bibutils, version 6.10.&rdquo;
<a href="https://sourceforge.net/projects/bibutils/">https://sourceforge.net/projects/bibutils/</a>.
</p>
<p>&mdash;- 
</p>
<p>The following references are obtained with a single <code>\insertAllCited{}</code>. 
The references are sorted automatically by the surnames of the authors:
</p>
<p>Georgi
N. Boshnakov, Chris Putman (2020).
<em>rbibutils: Convert Between Bibliography Formats</em>.
<a href="https://CRAN.R-project.org/package=rbibutils">https://CRAN.R-project.org/package=rbibutils</a>.<br /><br /> Duncan Murdoch (2010).
&ldquo;Parsing Rd files.&rdquo;
<a href="https://developer.r-project.org/parseRd.pdf">https://developer.r-project.org/parseRd.pdf</a>.<br /><br /> Chris Putnam (2020).
&ldquo;Library bibutils, version 6.10.&rdquo;
<a href="https://sourceforge.net/projects/bibutils/">https://sourceforge.net/projects/bibutils/</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Rdpack-package">Rdpack-package</a></code> for overview,
</p>
<p><code>vignette("Inserting_bibtex_references", package = "Rdpack")</code> for
further details on the citation macros
</p>
<p><code><a href="#topic+insert_citeOnly">insert_citeOnly</a></code> for the function generating citations
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cat(insert_ref("Rpackage:rbibutils", "Rdpack"), "\n")
</code></pre>

<hr>
<h2 id='inspect_args'>
Inspect the argument section of an Rd object
</h2><span id='topic+inspect_args'></span>

<h3>Description</h3>

<p>Inspect the argument section of an Rd object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inspect_args(rdo, i_usage)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inspect_args_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object describing functions.</p>
</td></tr>
<tr><td><code id="inspect_args_+3A_i_usage">i_usage</code></td>
<td>
<p>see Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>inspect_args</code> checks if the arguments in the documentation
object <code>rdo</code> match the (union of) the actual arguments of the
functions it describes.
</p>
<p>If <code>i_usage</code> is missing, it is computed by inspecting the current
definitions of the functions described in <code>rdo</code>, see
<code>inspect_usage</code>. This argument is likely to be supplied if the
function calling <code>inspect_args</code> has already computed it for other
purposes.
</p>


<h3>Value</h3>

<p>TRUE if the arguments in the documentation match the (union of) the
actual arguments of the described functions, FALSE otherwise.
</p>
<p>The returned logical value has attribute &lsquo;details&rsquo; which is a list
with the following components.
</p>
<table>
<tr><td><code>rdo_argnames</code></td>
<td>
<p>arguments described in the documentation object, <code>rdo</code>.</p>
</td></tr>
<tr><td><code>cur_argnames</code></td>
<td>
<p>arguments in the current definitions of the
described functions.</p>
</td></tr>
<tr><td><code>added_argnames</code></td>
<td>
<p>new arguments</p>
</td></tr>
<tr><td><code>removed_argnames</code></td>
<td>
<p>removed (dropped) arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>

<hr>
<h2 id='inspect_Rd'>
Inspect and update an Rd object or file
</h2><span id='topic+inspect_Rd'></span><span id='topic+inspect_Rdfun'></span><span id='topic+inspect_Rdmethods'></span><span id='topic+inspect_Rdclass'></span>

<h3>Description</h3>

<p>Inspect and update an Rd object or file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inspect_Rd(rdo, package = NULL)

inspect_Rdfun(rdo, alias_update = TRUE)

inspect_Rdmethods(rdo, package = NULL)

inspect_Rdclass(rdo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inspect_Rd_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object or file name</p>
</td></tr>
<tr><td><code id="inspect_Rd_+3A_package">package</code></td>
<td>
<p>name of a package</p>
</td></tr>
<tr><td><code id="inspect_Rd_+3A_alias_update">alias_update</code></td>
<td>
<p>if <code>TRUE</code>, add missing alias entries for
functions with usage statements.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions check if the descriptions of the objects in <code>rdo</code>
are consistent with their current definitions and update them, if
necessary. The details depend on the type of the documented topic.
In general, the functions update entries that can be produced
programmatically, possibly accompanied with a suggestion to the author
to write some additional text.
</p>
<p><code>inspect_Rd</code> checks the <code style="white-space: pre;">&#8288;\name&#8288;</code> section of <code>rdo</code> and
dispatches to one of the other <code>inspect_XXX</code> functions depening
on the type of the topic.
</p>
<p><code>inspect_Rdfun</code> processes documentation of functions.  It checks
the usage entries of all functions documented in <code>rdo</code> and
updates them if necessary. It appends &quot;<code style="white-space: pre;">&#8288;\alias&#8288;</code>&quot; entries for
functions that do not have them. Entries are created for any arguments
that are missing from the &quot;<code style="white-space: pre;">&#8288;\arguments&#8288;</code>&quot; section. Warning is
given for arguments in the &quot;<code style="white-space: pre;">&#8288;\arguments&#8288;</code>&quot; section that are not
present in at least one usage entry. <code>inspect_Rdfun</code> understands
the syntax for S3 methods and S4 methods used in &quot;usage&quot; sections, as
well. The S4 methods may also be in a section as produced by
<code>promptMethods</code>. 
</p>
<p><code>inspect_Rdmethods</code> checks and updates documentation of an S4
generic function.
</p>
<p><code>inspect_Rdclass</code> checks and updates documentation of an S4
class.
</p>
<p>Since method signatures and descriptions  may be present in
documentation of a class, as well as in that of methods, the question
arises where to put &quot;<code style="white-space: pre;">&#8288;\alias&#8288;</code>&quot; entries to avoid duplication.
Currently, alias entries are put in method descriptions.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>

<hr>
<h2 id='inspect_signatures'>
Inspect signatures of S4 methods
</h2><span id='topic+inspect_signatures'></span><span id='topic+inspect_clmethods'></span>

<h3>Description</h3>

<p>Inspect signatures of S4 methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inspect_clmethods(rdo, final = TRUE)

inspect_signatures(rdo, package = NULL, sec = "Methods")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inspect_signatures_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object.</p>
</td></tr>
<tr><td><code id="inspect_signatures_+3A_package">package</code></td>
<td>
<p>the name of a package, a character string or NULL.</p>
</td></tr>
<tr><td><code id="inspect_signatures_+3A_sec">sec</code></td>
<td>
<p>the name of a section to look into, a character string.</p>
</td></tr>
<tr><td><code id="inspect_signatures_+3A_final">final</code></td>
<td>
<p>If not TRUE insert text with suggestions, otherwise
comment the suggestions out.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Signatures in documentation of S4 classes and methods are stored
somewhat differently. <code>inspect_signatures</code> inspects signatures in
documentation of methods of a function.  <code>inspect_clmethods</code>
inspects signatures in documentation of a class.
</p>
<p><code>inspect_signatures</code> was written before
<code>inspect_clmethods()</code> and was geared towards using existing code
for ordinary functions (mainly <code>parse_usage_text()</code>.
</p>
<p>If new methods are found, the functions add entries for them in the Rd
object <code>rdo</code>.
</p>
<p>If <code>rdo</code> documents methods that do not exist, a message inviting
the user to remove them manually is printed but the offending entries
remain in the object.
At the time of writing, <code style="white-space: pre;">&#8288;R CMD check&#8288;</code> does not warn about this.
</p>


<h3>Value</h3>

<p>an Rd object
</p>


<h3>Note</h3>

<p>todo: need consolidation.</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>

<hr>
<h2 id='inspect_slots'>
Inspect the slots of an S4 class
</h2><span id='topic+inspect_slots'></span>

<h3>Description</h3>

<p>Inspect the slots of an S4 class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inspect_slots(rdo, final = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inspect_slots_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object.</p>
</td></tr>
<tr><td><code id="inspect_slots_+3A_final">final</code></td>
<td>
<p>if not TRUE insert text with suggestions, otherwise
comment the suggestions out.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>

<hr>
<h2 id='inspect_usage'>
Inspect the usage section in an Rd object
</h2><span id='topic+inspect_usage'></span>

<h3>Description</h3>

<p>Inspect the usage section in an Rd object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inspect_usage(rdo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inspect_usage_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The usage section in the Rd object, <code>rdo</code>, is extracted and
parsed. The usage of each function described in <code>rdo</code> is
obtained also from the actual installed function and compared to the
one from <code>rdo</code>.
</p>
<p>The return value is a list, with one element for each function usage
as returned by <code>compare_usage1</code>.
</p>
<p>One of the consequences of this is that an easy way to add a usage
description of a function, say <code>fu</code> to an existing Rd file is to
simply add a line <code>fu()</code> to the usage section of that file and
run <code>reprompt</code> on it.
</p>


<h3>Value</h3>

<p>a list of comparison results as described in &lsquo;Details&rsquo;
(todo: give more details here)
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+inspect_args">inspect_args</a></code>
</p>

<hr>
<h2 id='list_Rd'>Combine Rd fragments</h2><span id='topic+list_Rd'></span>

<h3>Description</h3>

<p>Combine Rd fragments and strings into one object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_Rd(..., Rd_tag = NULL, Rd_class = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="list_Rd_+3A_...">...</code></td>
<td>
<p>named list of objects to combine, see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="list_Rd_+3A_rd_tag">Rd_tag</code></td>
<td>
<p>if non-null, a value for the <code style="white-space: pre;">&#8288;Rd_tag&#8288;</code> of the result.</p>
</td></tr>
<tr><td><code id="list_Rd_+3A_rd_class">Rd_class</code></td>
<td>
<p>logical; if TRUE, the result will be of class &quot;Rd&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The names of named arguments specify tags for the corresponding
elements (not arbitrary tags, ones that are converted to macro names
by prepending backslash to them). This is a convenient way to specify
sections, items, etc, in cases when the arguments have not being
tagged by previous processing. Character string arguments are
converted to the appropriate Rd pieces.
</p>
<p>Argument <code>...</code> may contain a mixture of character vactors and Rd
pieces.
</p>


<h3>Value</h3>

<p>an Rd object or list with <code style="white-space: pre;">&#8288;Rd_tag&#8288;</code> attribute, as specified by the
arguments.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+c_Rd">c_Rd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## see also the examples for c_Rd

dummyfun &lt;- function(x, ...) x

u1 &lt;- list_Rd(name = "Dummyname", alias = "dummyfun",
              title = "Dummy title", description = "Dummy description",
              usage = "dummyfun(x)",
              value = "numeric vector",
              author = "A. Author",
              Rd_class=TRUE )
Rdo_show(u1)

# call reprompt to fill the arguments section (and correct the usage)
fn &lt;- tempfile("dummyfun", fileext = "Rd")
reprompt(dummyfun, filename = fn)

# check that the result can be parsed and show it.
Rdo_show(tools::parse_Rd(fn))

unlink(fn)
</code></pre>

<hr>
<h2 id='makeVignetteReference'>Make bibtex references for vignettes</h2><span id='topic+makeVignetteReference'></span><span id='topic+vigbib'></span>

<h3>Description</h3>

<p>Make bibtex references for vignettes</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeVignetteReference(package, vig = 1, verbose = TRUE, title, author, 
                      type = "pdf", bibtype = "Article", key = NULL)

vigbib(package, verbose = TRUE, ..., vig = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makeVignetteReference_+3A_package">package</code></td>
<td>

<p>a character string, the name of an installed package.
</p>
</td></tr> 
<tr><td><code id="makeVignetteReference_+3A_vig">vig</code></td>
<td>

<p>an integer number or a character string identifying a vignette.
</p>
</td></tr>
<tr><td><code id="makeVignetteReference_+3A_verbose">verbose</code></td>
<td>

<p>if <code>TRUE</code>, print the references in Bibtex format.
</p>
</td></tr>
<tr><td><code id="makeVignetteReference_+3A_title">title</code></td>
<td>
<p>a character string, title of the vignette, see Details.</p>
</td></tr>
<tr><td><code id="makeVignetteReference_+3A_author">author</code></td>
<td>
<p>a character string, title of the vignette, see Details.</p>
</td></tr>
<tr><td><code id="makeVignetteReference_+3A_type">type</code></td>
<td>
<p>a character string, type of the vignette, such as
<code>"pdf"</code> or <code>"html"</code>. Currently ignored.
</p>
</td></tr>
<tr><td><code id="makeVignetteReference_+3A_bibtype">bibtype</code></td>
<td>
<p>a character string, Bibtex type for the reference,
defaults to <code>"Article"</code>.
</p>
</td></tr>
<tr><td><code id="makeVignetteReference_+3A_key">key</code></td>
<td>
<p>a character string specifying a key for the Bibtex entry.
If missing, suitable key is generated automatically.
</p>
</td></tr>
<tr><td><code id="makeVignetteReference_+3A_...">...</code></td>
<td>

<p>arguments passed by <code>vigbib()</code> to <code>makeVignetteReference()</code>. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>vigbib()</code> generates Bibtex references for all vignettes in a
package. <code>makeVignetteReference()</code> produces a Bibtex entry for a
particular vignette.
</p>
<p>There seems to be no standard way to cite vignettes in R packages.
For vignettes that are complete journal papers (most notably in the
Journal of Statistical Software), the authors would usually
prefer the papers to be cited, rather than the vignette. In any case,
consulting the output of <code>citation("a_package")</code> is the best
starting point. If the vignette has been extended substantially after
the paper was published, cite both.
</p>
<p>In many cases it is sufficient to give the command that opens the
vignette, e.g.:
</p>
<p><code>vignette("Inserting_bibtex_references", package = "Rdpack")</code>.
</p>
<p><code>makeVignetteReference()</code> makes a Bibtex entry for one
vignette. It looks for the available vignettes using
<code>vignette(package=package)</code>. Argument <code>vig</code> can be a
character string identifying the vignette by the name that would be
used in a call to <code>vignette()</code>. It can also be an integer,
identifying the vignette by the index (in the order in which the
vignettes are returned by <code>vignette()</code>). By default the first
vignette is returned. If <code>vig</code> is not suitable, a suitable list
of alternatives is printed.
</p>
<p>For <code>vigbib()</code> it is sufficient to give the name of a package. It
accepts all arguments of <code>makeVignetteReference()</code> except
<code>vig</code> (actually, supplying <code>vig</code> is equivallent to calling
<code>makeVignetteReference()</code> directly). 
</p>
<p>The remaining arguments can be used to overwrite some automatically
generated entries. For example, the vignette authors may not be the
same as the package authors.
</p>


<h3>Value</h3>

<p>a bibentry object containing the generated references
(the Bibtex entries are also printed, so that they can be copied to a
bib file)
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE (2020-01-21): the following examples work fine, but are not
##   rendered correctly by pkgdown::build_site(), so there may be errors
##   on the site produced by it, https://geobosh.github.io/Rdpack/.

vigbib("Rdpack")
makeVignetteReference("Rdpack", vig = 1)
makeVignetteReference("Rdpack", vig = "Inserting_bibtex_references")
## the first few characters of the name suffice:
makeVignetteReference("Rdpack", vig = "Inserting_bib")

## this gives an error but also prints the available vignettes:
## makeVignetteReference("Matrix", vig = "NoSuchVignette")

vigbib("utils")
makeVignetteReference("utils", vig = 1)
## commented out since can be slow:
## high &lt;- installed.packages(priority = "high")
## highbib &lt;- lapply(rownames(high), function(x) try(Rdpack:::vigbib(x, verbose = FALSE)))
</code></pre>

<hr>
<h2 id='parse_pairlist'>
Parse formal arguments of functions

</h2><span id='topic+parse_pairlist'></span><span id='topic+pairlist2f_usage1'></span>

<h3>Description</h3>

<p>Parse formal arguments of functions and convert them to
f_usage objects.</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_pairlist(x)

pairlist2f_usage1(x, name, S3class = "", S4sig = "", infix = FALSE,
                  fu = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse_pairlist_+3A_x">x</code></td>
<td>
<p>a pairlist representing the arguments of a function.</p>
</td></tr>
<tr><td><code id="parse_pairlist_+3A_name">name</code></td>
<td>
<p>function name.</p>
</td></tr>
<tr><td><code id="parse_pairlist_+3A_s3class">S3class</code></td>
<td>
<p>S3 class, see &lsquo;Details&rsquo;</p>
</td></tr>
<tr><td><code id="parse_pairlist_+3A_s4sig">S4sig</code></td>
<td>
<p>S4 signature, see Details.</p>
</td></tr>
<tr><td><code id="parse_pairlist_+3A_infix">infix</code></td>
<td>
<p>if <code>TRUE</code> the function usage is in infix form, see
Details.</p>
</td></tr>
<tr><td><code id="parse_pairlist_+3A_fu">fu</code></td>
<td>
<p>if TRUE the object is a function, otherwise it is something
else (e.g. a variable or a constant like <code>pi</code> and <code>Inf</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are mostly internal.
</p>




<p><code>parse_pairlist</code> parses the pairlist object, <code>x</code>, into a
list with two components. The first component contains the names of
the arguments. The second component is a named list containing the
default values, converted to strings. Only arguments with default
values have entries in the second component (so, it may be of length
zero).  If <code>x</code> is empty or <code>NULL</code>, both components have
length zero. An example:
</p>
<pre>parse_pairlist(formals(system.file))
##: $argnames
##: [1] "..."      "package"  "lib.loc"  "mustWork"

##: $defaults
##:    package    lib.loc   mustWork 
##: "\"base\""     "NULL"    "FALSE" 

</pre>

<p><code>pairlist2f_usage1()</code> creates an object of S3 class
<code>"f_usage"</code>. The object contains the result of parsing <code>x</code>
with <code>parse_pairlist(x)</code> and a number of additional components
which are copies of the remaining arguments to the function (without
any processing). The components are listed in section Values.
<code>S3class</code> is set to an S3 class for for S3 methods, <code>S4sig</code>
is the signature of an S4 method (as used in Rd macro
<code style="white-space: pre;">&#8288;\S4method&#8288;</code>). <code>infix</code> is <code>TRUE</code> for the rare occations
when the function is primarily used in infix form. 
</p>
<p>Class <code>"f_usage"</code> has a method for <code>as.character()</code> which
generates a text suitable for inclusion in Rd documentation.
</p>
<pre>pairlist2f_usage1(formals(summary.lm), "summary", S3class = "lm")
##: name      = summary 
##: S3class   = lm 
##: S4sig     =  
##: infix     = FALSE 
##: fu        = TRUE 
##: argnames  = object correlation symbolic.cor ... 
##: defaults  : correlation = FALSE 
##:             symbolic.cor = FALSE 

</pre>



<h3>Value</h3>

<p>For <code>parse_pairlist</code>, a list with the following components:
</p>
<table>
<tr><td><code>argnames</code></td>
<td>
<p>the names of all arguments, a character vector</p>
</td></tr>
<tr><td><code>defaults</code></td>
<td>

<p>a named character vector containing the default values, converted to
character strings. Only arguments with defaults have entries in this
vector. 
</p>
</td></tr>
</table>
<p>For <code>pairlist2f_usage1</code>, an object with S3 class
<code>"f_usage"</code>. This is a list as for <code>parse_pairlist</code> and
the following additional components:
</p>
<table>
<tr><td><code>name</code></td>
<td>
<p>function name, a character string.</p>
</td></tr>
<tr><td><code>S3class</code></td>
<td>

<p>S3 class, a character string; <code>""</code> if not an S3 method.
</p>
</td></tr> 
<tr><td><code>S4sig</code></td>
<td>
<p>S4 signature; <code>""</code> if not an S4 method.</p>
</td></tr> 
<tr><td><code>infix</code></td>
<td>
<p>a logical value, <code>TRUE</code> for infix operators.</p>
</td></tr>
<tr><td><code>fu</code></td>
<td>

<p>indicates the type of the object, usually <code>TRUE</code>, see Details.
</p>
</td></tr>

</table>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+promptUsage">promptUsage</a></code> accepts <code>f_usage</code> objects,
<code><a href="#topic+get_usage">get_usage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>parse_pairlist(formals(lm))
parse_pairlist(formals(system.file))
s_lm &lt;- pairlist2f_usage1(formals(summary.lm), "summary", S3class = "lm")
s_lm
as.character(s_lm)
</code></pre>

<hr>
<h2 id='parse_Rdname'>
Parse the name section of an Rd object
</h2><span id='topic+parse_Rdname'></span>

<h3>Description</h3>

<p>Parse the name section of an Rd object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_Rdname(rdo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse_Rdname_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The content of section &quot;<code style="white-space: pre;">&#8288;\name&#8288;</code>&quot; is extracted. If it contains a
hyphen, &lsquo;-&rsquo;, the part before the hyphen is taken to be the topic
(usually a function name), while the part after the hyphen is the
type. If the name does not contain hyphens, the type is set to the
empty string.  </p>


<h3>Value</h3>

<p>a list with two components:
</p>
<table>
<tr><td><code>fname</code></td>
<td>
<p>name of the topic, usually a function</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>type of the topic, such as <code style="white-space: pre;">&#8288;"method"&#8288;</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class='language-R'>u1 &lt;- list_Rd(name = "Dummyname", alias = "Dummyallias1",
              title = "Dummy title", description = "Dummy description",
              Rd_class=TRUE )

parse_Rdname(u1)

u2 &lt;- list_Rd(name = "dummyclass-class", alias = "Dummyclass",
              title = "Class dummyclass",
              description = "Objects and methods for something.",
              Rd_class=TRUE )

parse_Rdname(u2)
</code></pre>

<hr>
<h2 id='parse_Rdpiece'>
Parse a piece of Rd source text
</h2><span id='topic+parse_Rdpiece'></span>

<h3>Description</h3>

<p>Parse a piece of Rd source text.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_Rdpiece(x, result = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse_Rdpiece_+3A_x">x</code></td>
<td>
<p>the piece of Rd text, a character vector.</p>
</td></tr>
<tr><td><code id="parse_Rdpiece_+3A_result">result</code></td>
<td>
<p>if &quot;text&quot;, converts the result to printable text
(e.g. to be shown to the user), otherwise returns an Rd object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>parse_Rdpiece</code> parses a piece of source Rd text. The text may be
an almost arbitrary piece that may be inserted in an Rd source file,
except that it should not be a top level section (use
<code><a href="#topic+parse_Rdtext">parse_Rdtext</a></code> for sections). Todo: it probably can be
also a parsed piece, check!
</p>
<p>This is somewhat tricky since <code>parse_Rd</code> does not accept
arbitrary piece of Rd text. It handles either a complete Rd source or
a fragment, defined (as I understand it) as a top level section.  To
circumvent this limitation, this function constructs a minimal
complete Rd source putting argument <code>x</code> in a section (currently
&quot;Note&quot;) which does not have special formatting on its own. After
parsing, it extracts only the part corresponding to <code>x</code>.
</p>
<p><code>parse_Rdpiece</code> by default returns the parsed Rd piece. However,
if <code>result="text"</code>, then the text is formatted as the help system
would do when presenting help pages in text format.
</p>
<p><strong>TODO:</strong> add an argument for macros?
</p>


<h3>Value</h3>

<p>a parsed Rd piece or its textual representation as described in Details
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class='language-R'># the following creates Rd object rdo
dummyfun &lt;- function(x) x
u1 &lt;- list_Rd(name = "Dummyname", alias = "dummyfun",
              title = "Dummy title", description = "Dummy description",
              usage = "dummyfun(x,y)",
              value = "numeric vector",
              author = "A. Author",
              Rd_class = TRUE )
fn &lt;- tempfile("dummyfun", fileext = "Rd")
reprompt(dummyfun, filename = fn)
rdo &lt;- tools::parse_Rd(fn)

# let's prepare a new item
rd &lt;- "\\item{...}{further arguments to be passed on.}"
newarg &lt;- parse_Rdtext(rd, section = "\\arguments")

# now append 'newarg' to the arguments section of rdo
iarg &lt;- which(tools:::RdTags(rdo) == "\\arguments")
rdoa &lt;- append_to_Rd_list(rdo, newarg, iarg)

Rdo_show(rdoa)

# for arguments and other frequent tasks, there are specialised functions
dots &lt;- paste0("\\", "dots")
rdob &lt;- Rdo_append_argument(rdo, dots, "further arguments to be passed on.")

Rdo_show(reprompt(rdob, filename = fn))

unlink(fn)
</code></pre>

<hr>
<h2 id='parse_Rdtext'>
Parse Rd source text as the contents of a section
</h2><span id='topic+parse_Rdtext'></span>

<h3>Description</h3>

<p>Parse Rd source text as the contents of a given section.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_Rdtext(text, section = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse_Rdtext_+3A_text">text</code></td>
<td>
<p>Rd source text, a character vector.</p>
</td></tr>
<tr><td><code id="parse_Rdtext_+3A_section">section</code></td>
<td>
<p>the section name, a string.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>section</code> is given, then <code>parse_Rdtext</code> parses
<code>text</code> as appropriate for the content of section <code>section</code>.
This is achieved by inserting <code>text</code> as an argument to the TeX
macro <code>section</code>. For example, if <code>section</code> is
&quot;<code style="white-space: pre;">&#8288;\usage&#8288;</code>&quot;, then a line &quot;<code style="white-space: pre;">&#8288;\usage{&#8288;</code>&quot; is inserted at the
begiinning of <code>text</code> and a closing &quot;<code style="white-space: pre;">&#8288;}&#8288;</code>&quot; at its end.
</p>
<p>If <code>section</code> is NA then <code>parse_Rdtext</code> parses it without
preprocessing. In this case <code>text</code> itself will normally be
a complete section fragment.
</p>


<h3>Value</h3>

<p>an Rd fragment
</p>


<h3>Note</h3>

<p>The text is saved to a temporary file and parsed using
<code>parse_Rd</code>. This is done for at least two reasons. Firstly,
<code>parse_Rd</code> works most reliably (at the time of writing this)
from a file. Secondly, the saved file may be slightly different
(escaped backslashes being the primary example).
It would be a nightmare to ensure that all concerned functions know
if some Rd text is read from a file or not.
</p>
<p>The (currently internal) function <code>.parse_Rdlines</code> takes a
character vector, writes it to a file (using <code>cat</code>) and calls
<code>parse_Rd</code> to parse it.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+parse_Rdpiece">parse_Rdpiece</a></code>
</p>

<hr>
<h2 id='parse_text'>Parse expressions residing in character vectors</h2><span id='topic+parse_text'></span>

<h3>Description</h3>

<p>Parse expressions residing in character vectors.</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_text(text, ..., keep = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse_text_+3A_text">text</code></td>
<td>
<p>the text to parse, normally a character vector but can be
anything that <code>parse</code> accepts for this artgument.</p>
</td></tr>
<tr><td><code id="parse_text_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed on to <code>parse</code>.</p>
</td></tr>
<tr><td><code id="parse_text_+3A_keep">keep</code></td>
<td>
<p>required setting for option <code style="white-space: pre;">&#8288;keep.source&#8288;</code>, see
details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is like <code>parse(text=text,...)</code> with the additional feature
that if the setting of option &quot;keep.source&quot; is not as requested by
argument <code>keep</code>, it is set to <code>keep</code> before calling
<code>parse</code> and restored afterwards.
</p>
<p>This function is no longer exported by <span class="pkg">Rdpack</span> since it is here
for historical reasons and to avoid unnecessary dependence on
<span class="pkg">gbutils</span>. Use the equivalent <code>gbutils::parse_text</code> instead.
</p>


<h3>Value</h3>

<p>an expression representing the parsed text, see <code>link{parse}</code> for
details
</p>


<h3>Note</h3>

<p>The usual setting of option &quot;keep.source&quot; in interactive sessions is
TRUE. However, in &lsquo;R CMD check&rsquo; it is FALSE.
</p>
<p>As a consequence, examples from the documentation may run fine when
copied and pasted in an R session but (rightly) fail &lsquo;R CMD check&rsquo;,
when they depend on  option &quot;keep.source&quot; being <code>TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+parse">parse</a></code>,
<code>parse_text</code> in package gbutils
</p>

<hr>
<h2 id='parse_usage_text'>
Parse usage text
</h2><span id='topic+parse_usage_text'></span><span id='topic+parse_1usage_text'></span>

<h3>Description</h3>

<p>Parse usage text.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_1usage_text(text)
parse_usage_text(text)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse_usage_text_+3A_text">text</code></td>
<td>

<p>conceptually, the content of the usage section of one or more Rd objects, a
character vector, see Details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code>parse_usage_text</code>, <code>text</code> is a character vector
representing the contents of the usage section of an Rdo object.
<code>parse_usage_text</code> does some preprocessing of <code>text</code> then
calls <code>parse_1usage_text</code> for each usage statement.
</p>
<p>The preprocessing changes &quot;<code style="white-space: pre;">&#8288;\&#8288;</code><code style="white-space: pre;">&#8288;dots&#8288;</code>&quot; to &quot;<code style="white-space: pre;">&#8288;...&#8288;</code>&quot; and
converts S3- and S4-method descriptions to a form suitable for
<code>parse()</code>. The text is then parsed (with <code>parse</code>) and
&quot;<code style="white-space: pre;">&#8288;srcref&#8288;</code>&quot; attribute removed from the parsed object.
</p>
<p>todo: currently no checks is made for Rd comments in <code>text</code>.
</p>
<p><code>parse_1usage_text</code> processes the usage statement of one object
and calls <code><a href="#topic+pairlist2f_usage1">pairlist2f_usage1</a></code> to convert it to an object
from S3 class <code>"f_usage"</code>.
</p>


<h3>Value</h3>

<p>for <code>parse_1usage_text</code>, an object from S3 class
<code>"f_usage"</code>, see <code><a href="#topic+pairlist2f_usage1">pairlist2f_usage1</a></code> for its
structure.
</p>
<p>for <code>parse_usage_text</code>, a list containing one element for each
usage entry, as prepared by <code>parse_1usage_text</code>
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>

<hr>
<h2 id='predefined'>
Tables of predefined sections and types of pieces of Rd objects
</h2><span id='topic+Rdo_predefined_sections'></span><span id='topic+Rdo_piece_types'></span><span id='topic+rdo_top_tags'></span>

<h3>Description</h3>

<p>Tables of predefined sections and types of pieces of Rd objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_predefined_sections

Rdo_piece_types

rdo_top_tags
</code></pre>


<h3>Details</h3>

<p>The Rd syntax defines several tables
(Murdoch 2010). <span class="pkg">Rdpack</span> stores them in the
variables described here.
</p>
<p><code>Rdo_predefined_sections</code> is a named character vector providing
the types of the top level sections in an Rd object.
</p>
<p><code>Rdo_piece_types</code> is a named character vector giving the types of
the core (all possible?)  Rd macros.
</p>
<p><strong>NOTE:</strong> These objects are hard coded and need to be updated if
the specifications of the Rd format are updated.
</p>
<p>todo: write functions that go through existing Rd documentation to
discover missing or wrong items.
</p>


<h3>Value</h3>

<p>for <code>Rdo_predefined_sections</code>, the name-value pairs are given in
the following table. For example, <code>Rdo_predefined_sections["examples"]</code> results
in RCODE.
</p>
 
<table>
<tr>
 <td style="text-align: left;"> name </td><td style="text-align: left;"> VERB </td><td style="text-align: left;">  |  </td><td style="text-align: left;"> description </td><td style="text-align: left;"> TEXT</td>
</tr>
<tr>
 <td style="text-align: left;">
alias </td><td style="text-align: left;"> VERB </td><td style="text-align: left;">  |  </td><td style="text-align: left;"> examples </td><td style="text-align: left;"> RCODE</td>
</tr>
<tr>
 <td style="text-align: left;">
concept </td><td style="text-align: left;"> TEXT </td><td style="text-align: left;">  |  </td><td style="text-align: left;"> usage </td><td style="text-align: left;"> RCODE</td>
</tr>
<tr>
 <td style="text-align: left;">
docType </td><td style="text-align: left;"> TEXT </td><td style="text-align: left;">  |  </td><td style="text-align: left;"> Rdversion </td><td style="text-align: left;"> VERB</td>
</tr>
<tr>
 <td style="text-align: left;">
title </td><td style="text-align: left;"> TEXT </td><td style="text-align: left;">  |  </td><td style="text-align: left;"> synopsis </td><td style="text-align: left;"> VERB</td>
</tr>
<tr>
 <td style="text-align: left;">
name </td><td style="text-align: left;"> VERB </td><td style="text-align: left;">  |  </td><td style="text-align: left;"> section </td><td style="text-align: left;"> TEXT</td>
</tr>
<tr>
 <td style="text-align: left;">
alias </td><td style="text-align: left;"> VERB </td><td style="text-align: left;">  |  </td><td style="text-align: left;"> arguments </td><td style="text-align: left;"> TEXT</td>
</tr>
<tr>
 <td style="text-align: left;">
concept </td><td style="text-align: left;"> TEXT </td><td style="text-align: left;">  |  </td><td style="text-align: left;"> keyword </td><td style="text-align: left;"> TEXT</td>
</tr>
<tr>
 <td style="text-align: left;">
docType </td><td style="text-align: left;"> TEXT </td><td style="text-align: left;">  |  </td><td style="text-align: left;"> note </td><td style="text-align: left;"> TEXT</td>
</tr>
<tr>
 <td style="text-align: left;">
title </td><td style="text-align: left;"> TEXT </td><td style="text-align: left;">  |  </td><td style="text-align: left;"> format </td><td style="text-align: left;"> TEXT</td>
</tr>
<tr>
 <td style="text-align: left;">
name </td><td style="text-align: left;"> VERB </td><td style="text-align: left;">  |  </td><td style="text-align: left;"> source </td><td style="text-align: left;"> TEXT</td>
</tr>
<tr>
 <td style="text-align: left;">
alias </td><td style="text-align: left;"> VERB </td><td style="text-align: left;">  |  </td><td style="text-align: left;"> details </td><td style="text-align: left;"> TEXT</td>
</tr>
<tr>
 <td style="text-align: left;">
concept </td><td style="text-align: left;"> TEXT </td><td style="text-align: left;">  |  </td><td style="text-align: left;"> value </td><td style="text-align: left;"> TEXT</td>
</tr>
<tr>
 <td style="text-align: left;">
docType </td><td style="text-align: left;"> TEXT </td><td style="text-align: left;">  |  </td><td style="text-align: left;"> references </td><td style="text-align: left;"> TEXT</td>
</tr>
<tr>
 <td style="text-align: left;">
title </td><td style="text-align: left;"> TEXT </td><td style="text-align: left;">  |  </td><td style="text-align: left;"> author </td><td style="text-align: left;"> TEXT</td>
</tr>
<tr>
 <td style="text-align: left;">
name </td><td style="text-align: left;"> VERB </td><td style="text-align: left;">  |  </td><td style="text-align: left;"> seealso </td><td style="text-align: left;"> TEXT </td>
</tr>

</table>
 
<p>for <code>Rdo_piece_types</code>, the name-value pairs are:
</p>
 
<table>
<tr>
 <td style="text-align: left;"> name</td><td style="text-align: left;"> VERB</td><td style="text-align: left;"> |
alias</td><td style="text-align: left;"> VERB</td><td style="text-align: left;"> |
concept</td><td style="text-align: left;"> TEXT</td>
</tr>
<tr>
 <td style="text-align: left;">
docType</td><td style="text-align: left;"> TEXT</td><td style="text-align: left;"> |
title</td><td style="text-align: left;"> TEXT</td><td style="text-align: left;"> |
description</td><td style="text-align: left;"> TEXT</td>
</tr>
<tr>
 <td style="text-align: left;">
examples</td><td style="text-align: left;"> RCODE</td><td style="text-align: left;"> |
usage</td><td style="text-align: left;"> RCODE</td><td style="text-align: left;"> |
Rdversion</td><td style="text-align: left;"> VERB</td>
</tr>
<tr>
 <td style="text-align: left;">
synopsis</td><td style="text-align: left;"> VERB</td><td style="text-align: left;"> |
Sexpr</td><td style="text-align: left;"> RCODE</td><td style="text-align: left;"> |
RdOpts</td><td style="text-align: left;"> VERB</td>
</tr>
<tr>
 <td style="text-align: left;">
code</td><td style="text-align: left;"> RCODE</td><td style="text-align: left;"> |
dontshow</td><td style="text-align: left;"> RCODE</td><td style="text-align: left;"> |
donttest</td><td style="text-align: left;"> RCODE</td>
</tr>
<tr>
 <td style="text-align: left;">
testonly</td><td style="text-align: left;"> RCODE</td><td style="text-align: left;"> |
dontrun</td><td style="text-align: left;"> VERB</td><td style="text-align: left;"> |
env</td><td style="text-align: left;"> VERB</td>
</tr>
<tr>
 <td style="text-align: left;">
kbd</td><td style="text-align: left;"> VERB</td><td style="text-align: left;"> |
option</td><td style="text-align: left;"> VERB</td><td style="text-align: left;"> |
out</td><td style="text-align: left;"> VERB</td>
</tr>
<tr>
 <td style="text-align: left;">
preformatted</td><td style="text-align: left;"> VERB</td><td style="text-align: left;"> |
samp</td><td style="text-align: left;"> VERB</td><td style="text-align: left;"> |
special</td><td style="text-align: left;"> VERB</td>
</tr>
<tr>
 <td style="text-align: left;">
url</td><td style="text-align: left;"> VERB</td><td style="text-align: left;"> |
verb</td><td style="text-align: left;"> VERB</td><td style="text-align: left;"> |
deqn</td><td style="text-align: left;"> VERB</td>
</tr>
<tr>
 <td style="text-align: left;">
eqn</td><td style="text-align: left;"> VERB</td><td style="text-align: left;"> |
renewcommand</td><td style="text-align: left;"> VERB</td><td style="text-align: left;"> |
newcommand</td><td style="text-align: left;"> VERB</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>
 
<p>for <code>rdo_top_tags</code>, the values are:
</p>

<table>
<tr>
 <td style="text-align: left;"> \name</td><td style="text-align: left;"> 
\Rdversion</td><td style="text-align: left;"> 
\docType</td><td style="text-align: left;"> 
\alias</td><td style="text-align: left;"> 
\encoding</td>
</tr>
<tr>
 <td style="text-align: left;">
\concept</td><td style="text-align: left;"> 
\title</td><td style="text-align: left;"> 
\description</td><td style="text-align: left;"> 
\usage</td><td style="text-align: left;"> 
\format</td>
</tr>
<tr>
 <td style="text-align: left;">
\source</td><td style="text-align: left;"> 
\arguments</td><td style="text-align: left;"> 
\details</td><td style="text-align: left;"> 
\value</td><td style="text-align: left;"> 
\references</td>
</tr>
<tr>
 <td style="text-align: left;">
\section</td><td style="text-align: left;"> 
\note</td><td style="text-align: left;"> 
\author</td><td style="text-align: left;"> 
\seealso</td><td style="text-align: left;"> 
\examples</td>
</tr>
<tr>
 <td style="text-align: left;">
\keyword</td><td style="text-align: left;"> 
<code style="white-space: pre;">&#8288;#&#8288;</code>ifdef</td><td style="text-align: left;"> 
<code style="white-space: pre;">&#8288;#&#8288;</code>ifndef</td><td style="text-align: left;"> 
\newcommand</td><td style="text-align: left;"> 
\renewcommand</td>
</tr>
<tr>
 <td style="text-align: left;">
COMMENT</td><td style="text-align: left;"> 
TEXT</td><td style="text-align: left;">  </td>
</tr>

</table>

<p>Note that most, but not all,  are prefixed with a backslash.
</p>


<h3>References</h3>

<p>Duncan Murdoch (2010).
&ldquo;Parsing Rd files.&rdquo;
<a href="https://developer.r-project.org/parseRd.pdf">https://developer.r-project.org/parseRd.pdf</a>.
</p>

<hr>
<h2 id='promptPackageSexpr'>Generates a shell of documentation for an installed package</h2><span id='topic+promptPackageSexpr'></span>

<h3>Description</h3>

<p>Generates a shell of documentation for an installed package. The
content is similar to &lsquo;promptPackage&rsquo; but information that can be
computed is produced with Sexpr's so that it is always up to date.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>promptPackageSexpr(package, filename = NULL, final = TRUE,
                   overview = FALSE, bib = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="promptPackageSexpr_+3A_package">package</code></td>
<td>
<p>name of a package, a string</p>
</td></tr>
<tr><td><code id="promptPackageSexpr_+3A_filename">filename</code></td>
<td>
<p>name of a file where to write the generated Rd
content, a string. The default should be sufficient in most cases.</p>
</td></tr>
<tr><td><code id="promptPackageSexpr_+3A_final">final</code></td>
<td>
<p>logical; if <code>TRUE</code> the content should be usable
without manual editing.</p>
</td></tr>
<tr><td><code id="promptPackageSexpr_+3A_overview">overview</code></td>
<td>
<p>logical; if <code>TRUE</code> creates sections with hints
what to put in them, otherwise such sections are written to the file
but are commented out.</p>
</td></tr>
<tr><td><code id="promptPackageSexpr_+3A_bib">bib</code></td>
<td>
<p>If TRUE, create a comment line in the references section
that will cause <code><a href="#topic+rebib">rebib</a></code> to import all references from
the default bib file.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generated skeleton is functionally (almost) equivalent to that
produced by <code>promptPackage</code>. The difference is that while
<code>promptPackage</code> computes some information and inserts it verbatim
in the skeleton, <code>promptPackageSexpr</code> inserts Sexpr's for the
computation of the same information at package build time.
</p>
<p>In this way there is no need to manually update information like the
version of the package. The index of functions (which contains
their descriptions) does not need manual updating, as well.
</p>
<p><code>promptPackageSexpr</code> needs to be called only once to create the
initial skeleton. Then the Rd file can be edited as needed.
</p>
<p>If the Rd file is generated with the option <code>bib = TRUE</code> (or the
appropriate lines are added to the refernces section manually) the
references can be updated at any time by a call of <code>rebib</code>.
</p>
<p>todo: At the moment <code>final=FALSE</code> has the effect
described for <code>overview</code>. At the time of writing this
(2011-11-18) I do not remember if this is intentional or the
corresponding &lsquo;if&rsquo; clause contains <code>|</code> by mistake.
</p>


<h3>Value</h3>

<p>the name of the file (invisibly)
</p>


<h3>Note</h3>

<p>The automatically generated information is that of the installed (or
at least built) package. Usually this is not a problem (and this is
the idea of the function) but it means that if a developer is adding
documentation for previously undocumented functions, they will appear
in the 'Index' section only after the package is installed
again. Similarly, if the description file of the package is changed,
the package needs to be installed again for the changes to appear in
the overview. Since the documentation is installed together with the
package this is no surprise, of course. This may only cause a problem
if documentation is produced with <code>R CMD Rd2pdf</code> before the
updated version is installed.
</p>
<p>This function is not called <code>repromptXXX</code> since the idea is that
it is called only once and then the Rd file can be edited freely, see
also &lsquo;Details&rsquo;.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>

<hr>
<h2 id='promptUsage'>
Generate usage text for functions and methods

</h2><span id='topic+promptUsage'></span><span id='topic+get_usage'></span>

<h3>Description</h3>

<p>Generates usage text for a function, S3 method or S4 method.  The text
is suitably formatted for inclusion in the usage section of Rd
documentation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_usage(object, name = NULL, force.function = FALSE, ...,
          S3class = "", S4sig = "", infix = FALSE, fu = TRUE,
          out.format = "text")

promptUsage(..., usage)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="promptUsage_+3A_object">object</code></td>
<td>
<p>a function object or a character name of one, can be
anonymous function.</p>
</td></tr>
<tr><td><code id="promptUsage_+3A_name">name</code></td>
<td>
<p>the name of a function, a string.</p>
</td></tr>
<tr><td><code id="promptUsage_+3A_force.function">force.function</code></td>
<td>
<p>enforce looking for a function.</p>
</td></tr>
<tr><td><code id="promptUsage_+3A_s3class">S3class</code></td>
<td>
<p>the S3 class of the function, a character vector.</p>
</td></tr>
<tr><td><code id="promptUsage_+3A_out.format">out.format</code></td>
<td>
<p>if &quot;<code style="white-space: pre;">&#8288;text&#8288;</code>&quot;, return the result as a character
vector.</p>
</td></tr>
<tr><td><code id="promptUsage_+3A_s4sig">S4sig</code></td>
<td>
<p>(the signature of an S4 method, as used in Rd macro
<code style="white-space: pre;">&#8288;\S4method&#8288;</code>).</p>
</td></tr>
<tr><td><code id="promptUsage_+3A_infix">infix</code></td>
<td>
<p>if TRUE the function is an infix operator.</p>
</td></tr>
<tr><td><code id="promptUsage_+3A_fu">fu</code></td>
<td>
<p>if TRUE the object is a function, otherwise it is something
else (e.g. a variable or a constant like <code>pi</code> and <code>Inf</code>).
</p>
</td></tr>
<tr><td><code id="promptUsage_+3A_usage">usage</code></td>
<td>
<p>an usage object, see Details.</p>
</td></tr>
<tr><td><code id="promptUsage_+3A_...">...</code></td>
<td>

<p>for <code>promptUsage</code>, arguments to be passed on to
<code>get_usage</code>; for <code>get_usage</code>, currently not used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>get_usage()</code> takes a function object, or the name of one, and
creates text suitable for inclusion in the usage section of Rd
documentation.  The usage is generated from the function object.  When
in interactive <span class="rlang"><b>R</b></span> session, use <code>cat()</code> to print the result for
copying and pasting into Rd documentation or saving to a file
(otherwise, if the usage text contains backslashes, they may appear
duplicated).  Long text is wrapped on two or more lines. For example,
</p>
<pre>cat(get_usage(lm))
##: lm(formula, data, subset, weights, na.action, method = "qr", 
##:    model = TRUE, x = FALSE, y = FALSE, qr = TRUE, singular.ok = TRUE, 
##:    contrasts = NULL, offset, \dots)
</pre>

<p>Argument <code>"name"</code> can be used to specify a print name for the function.
This is most often needed for S3 methods. Compare
</p>
<pre>cat(get_usage(summary.lm))
##: summary.lm(object, correlation = FALSE, symbolic.cor = FALSE, \dots)
</pre>

<p>and
</p>
<pre>cat(get_usage(summary.lm, name = "summary"))
##: summary(object, correlation = FALSE, symbolic.cor = FALSE, \dots)
</pre>

<p>The call is just <code>summary()</code> in the latter. This fairly reflects
the fact that S3 methods are normally called via the generic, but
adding some explanatory text around the command is usually a good
idea. For programmatically generated usage sections in help pages,
argument <code>S3class</code> can be used to get the standard Rd markup for
S3 methods.
</p>
<pre>cat(get_usage(summary.lm, "summary", S3class = "lm"))
##: \method{summary}{lm}(object, correlation = FALSE, symbolic.cor = FALSE, \dots)
</pre>

<p>(Note that <code style="white-space: pre;">&#8288;\method&#8288;</code> can only be used in Usage sections.)
</p>
<p>When <code>object</code> is an anonymous function, argument <code>name</code> is compulsory.
For example,


<code>cat( get_usage(function(x = 3, y = "a"){}, "f") )</code>
</p>



<p><code>get_usage()</code> can also be used to insert dynamically signatures
of functions located in other objects, such as environments and lists,
see the examples.
</p>
<p>If a function is used as an infix operator, set <code>infix = TRUE</code>.
</p>
<pre>get_usage("+", infix = TRUE)
##: [1] "e1 + e2"
get_usage("%in%", infix = TRUE)
##: [1] "x %in% table"
</pre>

<p>The name of the operator may be in a variable:
</p>
<pre>op &lt;- "+"
get_usage(op, infix = TRUE)
##: [1] "e1 + e2"
</pre>

<p>Backticks are ok, as well,
</p>
<pre>get_usage(`+`, infix = TRUE)
##: [1] "e1 + e2"
</pre>

<p>But if a backticked operator is in a variable, surprise springs: 
</p>
<pre>op &lt;- `+`
get_usage(op, infix = TRUE)
##: [1] "e1 op e2"
</pre>

<p>In this case, don't use backticks  or, if you must, evaluate the argument:
</p>
<pre>op &lt;- `+`
get_usage(eval(op), name = "+", infix = TRUE)
##: [1] "e1 + e2"
</pre>











<p><code>promptUsage()</code> is mostly for internal use. It is like
<code>get_usage()</code> with an additional argument, <code>usage</code>, used to
pass a specially parsed argument list of class <code style="white-space: pre;">&#8288;"f_usage"&#8288;</code>,
produced by other functions in <span class="pkg">Rdpack</span>. In particular it could
have been generated by a previous call to <code>get_usage()</code>.
</p>


<h3>Value</h3>

<p>a character string or an object of S3 class &quot;<code style="white-space: pre;">&#8288;f_usage&#8288;</code>&quot;,
see <code><a href="#topic+pairlist2f_usage1">pairlist2f_usage1</a></code> for its format.
</p>


<h3>Note</h3>

<p>For an S3 or S4 generic, use the name of the function, not the object,
see the examples.
</p>
<p>These functions are for usage descriptions as they appear in the &quot;usage&quot;
section of Rd files. Descriptions of S4 methods for &quot;Methods&quot; sections
are dealt with by other functions.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+parse_pairlist">parse_pairlist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>u &lt;- get_usage(lm)    # a long usage text
cat(u)

# if there are additional arguments in S3 methods,
# use names of the functions, not the objects, e.g.
get_usage("droplevels", S3class = "data.frame")
get_usage(name = "droplevels", S3class = "data.frame")
# (both give "\method{droplevels}{data.frame}(x, except = NULL, \dots)")

# but this gives the args of the generic:  "\method{droplevels}{data.frame}(x, \dots)"
get_usage(droplevels, S3class = "data.frame")

## a list containing some functions
summaries &lt;- list(xbar = function(x) mean(x), rho = function(x, y) cor(x,y))
get_usage(summaries$xbar, name = "xbar")
get_usage(summaries$rho, name = "rho")

## functions in an environment
esummaries &lt;- list2env(summaries)
get_usage(esummaries$xbar, name = "xbar")
get_usage(esummaries$rho, name = "rho")
</code></pre>

<hr>
<h2 id='Rd_combo'>Manipulate a number of Rd files</h2><span id='topic+Rd_combo'></span>

<h3>Description</h3>

<p>Manipulate a number of Rd files.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rd_combo(rd, f, ..., .MORE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rd_combo_+3A_rd">rd</code></td>
<td>
<p>names of Rd files, a character vector.</p>
</td></tr>
<tr><td><code id="Rd_combo_+3A_f">f</code></td>
<td>
<p>function to apply, see Details.</p>
</td></tr>
<tr><td><code id="Rd_combo_+3A_...">...</code></td>
<td>
<p>further arguments to pass on to <code>f</code>.</p>
</td></tr>
<tr><td><code id="Rd_combo_+3A_.more">.MORE</code></td>
<td>
<p>another function to be applied for each file to the
result of <code>f</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Rd_combo</code> parses each file in <code>rd</code>, applies <code>f</code> to the
Rd object, and applies the function <code>.MORE</code> (if supplied) on the
results of <code>f</code>.
</p>
<p>A typical value for <code>.MORE</code> is <code>reprompt</code> or another
function that saves the resulting Rd object.
</p>
<p>todo: <code>Rd_combo</code> is already useful but needs further work.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
rdnames &lt;- dir(path = "./man", pattern=".*[.]Rd$", full.names=TRUE)

## which Rd files don't have a value section?
counts &lt;- unlist(Rd_combo(rdnames, function(x) length(Rdo_locate_core_section(x, "\value"))))
rdnames[counts == 0]

## reprompt all files
Rd_combo(rdnames, reprompt)
for(nam in rdnames) try(reprompt(nam))
for(nam in rdnames) try(reprompt(nam, sec_copy=FALSE))

## End(Not run)
</code></pre>

<hr>
<h2 id='Rdapply'>Apply a function over an Rd object</h2><span id='topic+Rdapply'></span><span id='topic+rattr'></span><span id='topic+Rdtagapply'></span>

<h3>Description</h3>

<p>Apply a function recursively over an Rd object, similarly
to rapply but keeping attributes.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdapply(x, ...)

Rdtagapply(object, FUN, rdtag, classes = "character", how = "replace",
           ...)

rattr(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdapply_+3A_x">x</code></td>
<td>
<p>the Rd object on which to apply a function.</p>
</td></tr>
<tr><td><code id="Rdapply_+3A_object">object</code></td>
<td>
<p>the Rd object on which to apply a function.</p>
</td></tr>
<tr><td><code id="Rdapply_+3A_fun">FUN</code></td>
<td>
<p>The function to apply, see details</p>
</td></tr>
<tr><td><code id="Rdapply_+3A_rdtag">rdtag</code></td>
<td>
<p>apply FUN only to elements whose <code>Rd_tag</code> attribute
is <code>rdtag</code>.</p>
</td></tr>
<tr><td><code id="Rdapply_+3A_y">y</code></td>
<td>
<p>an Rd object with the same structure as <code>x</code>, see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="Rdapply_+3A_...">...</code></td>
<td>
<p>arguments to pass to <code>rapply</code>, see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="Rdapply_+3A_classes">classes</code></td>
<td>
<p>a character vector, passed on to <code><a href="base.html#topic+rapply">rapply</a></code>,
see &lsquo;Details&rsquo;.
</p>
</td></tr>
<tr><td><code id="Rdapply_+3A_how">how</code></td>
<td>
<p>a character string, passed on to <code><a href="base.html#topic+rapply">rapply</a></code>,
see &lsquo;Details&rsquo;.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Rdapply</code> works like <code>rapply</code> but preserves the attributes
of <code>x</code> and (recursively) any sublists of it.  <code>Rdapply</code>
first calls <code>rapply</code>, passing all arguments to it. Then it
restores recursively the attributes by calling <code>rattr</code>.
</p>
<p>Note that the object returned by <code>rapply</code> is assumed to have
identical structure to the original object. This means that argument
<code>how</code> of <code>rapply</code> must not be &quot;unlist&quot; and normally will be
&quot;replace&quot;.  <code>Rdtagapply</code> gives sensible default values for
<code>classes</code> and <code>how</code>.  See the documentation of
<code><a href="base.html#topic+rapply">rapply</a></code> for details and the possible choices for
<code>classes</code>, <code>how</code> or other arguments passed to it via
<code>"\dots"</code>.
</p>
<p><code>Rdtagapply</code> is a convenience variant of <code>Rdapply</code> for the
common task of modifying or examining only elements with a given
<code>Rd_tag</code> attribute. Since the Rd equation macros <code style="white-space: pre;">&#8288;\eqn&#8288;</code> and
<code style="white-space: pre;">&#8288;\deqn&#8288;</code> are assigned Rd tag &quot;VERB&quot; but are processed differently
from other &quot;VERB&quot; pieces,  pseudo-tags
&quot;mathVERB&quot; and &quot;nonmathVERB&quot; are provided, such that &quot;mathVERB&quot; is for
actions on the first argument of the mathematical macros <code style="white-space: pre;">&#8288;\eqn&#8288;</code> and
<code style="white-space: pre;">&#8288;\deqn&#8288;</code>, while &quot;nonmathVERB&quot; is for actions on &quot;VERB&quot; macros in
all other contexts. There is also a pseudo-tag &quot;nonmath&quot; for anything
that is not math.
</p>
<p><code>rattr</code> is an auxilliary function which takes two Rd objects
(with identical structure) and recursively examines them. It makes the
attributes of any lists in the first argument identical to the
corresponding attributes in the second.
</p>


<h3>Value</h3>

<p>For <code>Rdapply</code> and <code>Rdtagapply</code>, an Rd object with some of
its leaves replaced as specified above.
</p>
<p>For <code>rattr</code>, the object <code>x</code> with attributes of any list
elements of it set to the corresponding attributes of <code>y</code>.
</p>


<h3>Note</h3>

<p>todo: may be it is better to rename the argument FUN of <code>Rdtagapply</code> to
<code>f</code>, which is its name in <code>rapply</code>.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+rapply">rapply</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create an Rd object for the sake of example
u1 &lt;- list_Rd(name = "Dummyname", alias = "dummyfun",
              title = "Dummy title", description = "Dummy description",
              usage = "dummyfun(x)",
              value = "numeric vector",
              author = "A. Author",
              examples = "\na &lt;- matrix(1:6,nrow=2)\na %*% t(a)\nt(a) %*% a",
              Rd_class=TRUE )

# correct R code for examples but wrong for saving in Rd files
Rdo_show(u1)

# escape percents everywhere except in comments
#  (actually, .anypercent escapes only unescaped percents)
rdo &lt;- Rdapply(u1, Rdpack:::.anypercent, classes = "character", how = "replace")

# syntactically wrong R code for examples but ok for saving in Rd files
Rdo_show(rdo)


# Rdo2Rdf does this by default for examples and other R code,
#   so code can be kept syntactically correct while processing.
#   (reprompt() takes care of this too as it uses Rdo2Rdf for saving)

fn &lt;- tempfile("u1", fileext="Rd")
Rdo2Rdf(u1, file = fn)

# the saved file contains escaped percents but they disappear in parsing:
file.show(fn)
Rdo_show(tools::parse_Rd(fn))

# if you think that sections should start on new lines,
# the following makes the file a little more human-friendly
#   (by inserting new lines).

u2 &lt;- Rdpack:::.Rd_tidy(u1)
Rdo2Rdf(u2, file = fn)
file.show(fn)

unlink(fn)
</code></pre>

<hr>
<h2 id='Rdo_append_argument'>
Append an item for a new argument to an Rd object
</h2><span id='topic+Rdo_append_argument'></span>

<h3>Description</h3>

<p>Append an item for a new argument to an Rd object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_append_argument(rdo, argname, description = NA, indent = "  ", create = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_append_argument_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object.</p>
</td></tr>
<tr><td><code id="Rdo_append_argument_+3A_argname">argname</code></td>
<td>
<p>name of the argument, a character vector.</p>
</td></tr>
<tr><td><code id="Rdo_append_argument_+3A_description">description</code></td>
<td>
<p>description of the argument, a character vector.</p>
</td></tr>
<tr><td><code id="Rdo_append_argument_+3A_indent">indent</code></td>
<td>
<p>a string, typically whitespace.</p>
</td></tr>
<tr><td><code id="Rdo_append_argument_+3A_create">create</code></td>
<td>
<p>not used (todo: remove?)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Appends one or more items to the section describing arguments of
functions in an Rd object. The section is created if not present.
</p>
<p>If <code>description</code> is missing or NA, a &quot;todo&quot; text is inserted.
</p>
<p>The inserted text is indented using the string <code>indent</code>.
</p>
<p>The lengths of <code>argname</code> and <code>description</code> should normally
be equal but if <code>description</code> is of length one, it is repeated to
achieve this when needed.
</p>


<h3>Value</h3>

<p>an Rd object
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class='language-R'>## the following creates Rd object rdo
dummyfun &lt;- function(x) x
fn &lt;- tempfile("dummyfun", fileext = ".Rd")
reprompt(dummyfun, filename = fn)
rdo &lt;- tools::parse_Rd(fn)

## add documentation for arguments
## that are not in the signature of 'dummyfun()'
dottext &lt;- "further arguments to be passed on."
dots &lt;- paste0("\\", "dots")
rdo2 &lt;- Rdo_append_argument(rdo, dots, dottext, create = TRUE)
rdo2 &lt;- Rdo_append_argument(rdo2, "z", "a numeric vector")

## reprompt() warns to remove documentation for non-existing arguments:
Rdo_show(reprompt(rdo2, filename = fn))

unlink(fn)
</code></pre>

<hr>
<h2 id='Rdo_collect_aliases'>Collect aliases or other metadata from an Rd object</h2><span id='topic+Rdo_collect_aliases'></span><span id='topic+Rdo_collect_metadata'></span>

<h3>Description</h3>

<p>Collect aliases or other metadata from an Rd object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_collect_aliases(rdo)

Rdo_collect_metadata(rdo, sec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_collect_aliases_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object</p>
</td></tr>
<tr><td><code id="Rdo_collect_aliases_+3A_sec">sec</code></td>
<td>
<p>the kind of metadata to collect, a character string, such
as &quot;alias&quot; and &quot;keyword&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Rdo_collect_aliases</code> finds all aliases in <code>rdo</code> and returns
them as a named character vector. The name of an alias  is usually the
empty string, <code>""</code>, but it may also be  &quot;windows&quot; or &quot;unix&quot; if
the alias is wrapped in a <code style="white-space: pre;">&#8288;#ifdef&#8288;</code> directive with the
corresponding first argument.
</p>
<p><code>Rdo_collect_metadata</code> is a generalisation of the above. It
collects the metadata from section(s) <code>sec</code>, where <code>sec</code> is
the name of a section without the leading backslash.
<code>sec</code> is assumed to be a section containing a single word, such
as &quot;keyword&quot;, &quot;alias&quot;, &quot;name&quot;.
</p>
<p>Currently <code>Rdo_collect_metadata</code> is not exported.
</p>


<h3>Value</h3>

<p>a named character vector, as described in Details.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code>tools:::.Rd_get_metadata</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## this example originally (circa 2012) was:
##     infile &lt;- file.path(R.home(), "src/library/base/man/timezones.Rd")
## but the OS conditional alias in that file has been removed.
## So, create an artificial example:
infile &lt;- system.file("examples", "tz.Rd", package = "Rdpack")

## file.show(infile)
rd &lt;- tools::parse_Rd(infile)

## The functions described here handle "ifdef" and similar directives.
## This detects OS specific aliases (windows = "onlywin" and unix = "onlyunix"):
Rdo_collect_aliases(rd)
Rdpack:::Rdo_collect_metadata(rd, "alias") # same

## In contrast, the following do not find "onlywin" and "onlyunix":
sapply(rd[which(tools:::RdTags(rd)=="\alias")], as.character)
tools:::.Rd_get_metadata(rd, "alias")

Rdpack:::Rdo_collect_metadata(rd, "name")
Rdpack:::Rdo_collect_metadata(rd, "keyword")
</code></pre>

<hr>
<h2 id='Rdo_empty_sections'>Find or remove empty sections in Rd objects</h2><span id='topic+Rdo_empty_sections'></span><span id='topic+Rdo_drop_empty'></span>

<h3>Description</h3>

<p>Find or remove empty sections in Rd objects</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_empty_sections(rdo, with_bs = FALSE)

Rdo_drop_empty(rdo, sec = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_empty_sections_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object or Rd source text.</p>
</td></tr>
<tr><td><code id="Rdo_empty_sections_+3A_with_bs">with_bs</code></td>
<td>
<p>if <code>TRUE</code> return the section names with the
leading backslash.</p>
</td></tr>
<tr><td><code id="Rdo_empty_sections_+3A_sec">sec</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>checkRd</code> is used to determine which sections are
empty.
</p>


<h3>Value</h3>

<p>For <code>Rdo_empty_sections</code>, the names of the empty sections as a
character vector.
</p>
<p>For <code>Rdo_drop_empty</code>, the Rd object stripped from empty
sections.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class='language-R'>dummyfun &lt;- function(x) x
rdo8 &lt;- list_Rd(name = "Dummyname", alias = "dummyfun",
              title = "Dummy title", description = "Dummy description",
              usage = "dummyfun(x,y)",
              value = "numeric vector",
              author = "",
              details = "",
              note = "",
              Rd_class=TRUE )

Rdo_empty_sections(rdo8)        # "details" "note"    "author"

rdo8a &lt;- Rdo_drop_empty(rdo8)
Rdo_empty_sections(rdo8a)       # character(0)
</code></pre>

<hr>
<h2 id='Rdo_fetch'>Get help pages as Rd objects</h2><span id='topic+Rdo_fetch'></span>

<h3>Description</h3>

<p>Get a help page as an Rd object from an installed or source package. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_fetch(Rd_name = character(0), package, dir = ".", installed = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_fetch_+3A_rd_name">Rd_name</code></td>
<td>

<p>names of one or more Rd help pages. <code>name</code> here is the name of
an Rd file stripped from the extension.
</p>
</td></tr>
<tr><td><code id="Rdo_fetch_+3A_package">package</code></td>
<td>

<p>the package from which to get the Rd object, a character string. 
</p>
</td></tr>
<tr><td><code id="Rdo_fetch_+3A_dir">dir</code></td>
<td>

<p>a character string giving the root directory of a source package.
Used only if <code>package</code> is missing.
</p>
</td></tr>
<tr><td><code id="Rdo_fetch_+3A_installed">installed</code></td>
<td>

<p>if <code>TRUE</code>, the default, the Rd object is taken unconditionally
from the installed <code>package</code>. 
If <code>FALSE</code>, the help page may be taken from a source tree, if
appropriate (typically if <code>package</code> is in &lsquo;developer&rsquo;s mode
under devtools, see Details). 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>Rd_name</code> is a character string (typical use case), the
corresponding help page is returned as an object from class
<code>"Rd"</code>.  If the length of <code>Rd_name</code> is greater than one, the
result is a Rd_named list containing the corresponding <code>"Rd"</code>
objects.  The default <code>Rd_name = character(0)</code> requests all Rd
pages in the package.
</p>
<p>Note that <code>Rd_name</code> does not contain the extention <code>".Rd"</code>
but the names in the returned list do.
</p>
<p>Argument <code>package</code> names the package from which to fetch the
documentation object. With the default <code>installed = TRUE</code> the
object is taken unconditionally from the installed package. To get it
from the source tree of a package, use argument <code>"dir"</code> instead.
The default, <code>""</code>, for <code>dir</code> is suitable for workflows where
the working directory is the root of the desired package.
</p>
<p>Argument <code>installed</code> concerns primarily development under package
<code>"devtools"</code>. <code>"devtools"</code> intercepts and modifies several
base <span class="rlang"><b>R</b></span> commands, concerning access to system files and getting help,
with the aim of rerouting them to the source trees of packages under
developer's mode.  If argument <code>installed</code> is <code>TRUE</code>, the
default, the requested pages are taken from the installed package,
even if it is in development mode. If argument <code>installed</code> is
<code>FALSE</code>, the Rd objects are taken from the corresponding source
tree, if the specified package is under developer's mode, and from the
installed package otherwise.
</p>
<p>Argument <code>Rd_name</code> is the name used in the <code>\name</code> section
of Rd files.
</p>
<p>When working off the source tree of a package, <code>Rdo_fetch</code>
processes the Rd files, so <code>roxygen2</code> users need to update
them if necessary.
</p>


<h3>Value</h3>

<p>if <code>length(Rd_name) = 1</code>, an object of class <code>"Rd"</code>,
otherwise a list of <code>"Rd"</code> objects.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class='language-R'>## get a single help page
rdo &lt;- Rdo_fetch("viewRd", package = "Rdpack")
Rdo_show(rdo)

## get a list of help pages
rdo &lt;- Rdo_fetch(c("viewRd", "reprompt"), package = "Rdpack")
names(rdo)
</code></pre>

<hr>
<h2 id='Rdo_flatinsert'>Insert or remove content in an Rd fragment</h2><span id='topic+Rdo_flatinsert'></span><span id='topic+Rdo_flatremove'></span>

<h3>Description</h3>

<p>Insert or remove content in an Rd fragment.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_flatinsert(rdo, val, pos, before = TRUE)

Rdo_flatremove(rdo, from, to)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_flatinsert_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object.</p>
</td></tr>
<tr><td><code id="Rdo_flatinsert_+3A_val">val</code></td>
<td>
<p>the value to insert.</p>
</td></tr>
<tr><td><code id="Rdo_flatinsert_+3A_pos">pos</code></td>
<td>
<p>position.</p>
</td></tr>
<tr><td><code id="Rdo_flatinsert_+3A_before">before</code></td>
<td>
<p>if TRUE, insert the new content at pos, pushing the
element at pos forward.
</p>
</td></tr>
<tr><td><code id="Rdo_flatinsert_+3A_from">from</code></td>
<td>
<p>beginning of the region to remove.</p>
</td></tr>
<tr><td><code id="Rdo_flatinsert_+3A_to">to</code></td>
<td>
<p>end  of the region to remove.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Rdo_flatinsert</code> inserts <code>val</code> at position <code>pos</code>,
effectively by concatenation.
</p>
<p><code>Rdo_flatremove</code> removes elements from <code>from</code> to <code>to</code>.
</p>


<h3>Value</h3>

<p>the modified <code>rdo</code>
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>

<hr>
<h2 id='Rdo_get_argument_names'>Get the names of arguments in usage sections of Rd objects</h2><span id='topic+Rdo_get_argument_names'></span>

<h3>Description</h3>

<p>Get the names of arguments in usage sections of Rd objects.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_get_argument_names(rdo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_get_argument_names_+3A_rdo">rdo</code></td>
<td>
<p>an Rdo object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All arguments names in the &quot;arguments&quot; section of <code>rdo</code> are
extracted. If there is no such section, the results is a character
vector of length zero.
</p>
<p>Arguments which have different descriptions for different OS'es
are included and not duplicated.
</p>
<p>Arguments which have descriptions for a particular OS are included,
irrespectively of the OS of the running R process.
(<strong>todo:</strong> introduce argument to control this?)
</p>


<h3>Value</h3>

<p>a character vector
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+Rdo_get_item_labels">Rdo_get_item_labels</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##---- Should be DIRECTLY executable !! ----
</code></pre>

<hr>
<h2 id='Rdo_get_insert_pos'>
Find the position of an &quot;Rd_tag&quot;
</h2><span id='topic+Rdo_get_insert_pos'></span>

<h3>Description</h3>

<p>Find the position of an &quot;Rd_tag&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_get_insert_pos(rdo, tag)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_get_insert_pos_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object</p>
</td></tr>
<tr><td><code id="Rdo_get_insert_pos_+3A_tag">tag</code></td>
<td>
<p>the &quot;Rd_tag&quot; to search for, a string</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns a position in <code>rdo</code>, where the next element
carrying &quot;Rd_tag&quot; <code>tag</code> should be inserted. The position is
determined as follows.
</p>
<p>If one or more elements of <code>rdo</code> have &quot;Rd_tag&quot; <code>tag</code>, then
the position is one plus the position of the last such element.
</p>
<p>If there are no elements with &quot;Rd_tag&quot; <code>tag</code>, the position is one
plus the length of <code>rdo</code>, unless <code>tag</code> is a known top level
Rd section. In that case, the position is such that the standard
ordering of sections in an Rd object is followed. This is set in the
internal variable <code>.rd_sections</code>.
</p>


<h3>Value</h3>

<p>an integer
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class='language-R'>#h &lt;- help("Rdo_macro")
#rdo &lt;- utils:::.getHelpFile(h)
rdo &lt;- Rdo_fetch("Rdo_macro", "Rdpack")

ialias &lt;- which(tools:::RdTags(rdo) == "\\alias")
ialias
next_pos &lt;- Rdo_get_insert_pos(rdo, "\\alias") # 1 + max(ialias)
next_pos
stopifnot(next_pos == max(ialias) + 1)

ikeyword &lt;- which(tools:::RdTags(rdo) == "\\keyword")
ikeyword
next_pos &lt;- Rdo_get_insert_pos(rdo, "\\keyword") # 1 + max(ikeyword)
next_pos
stopifnot(next_pos == max(ikeyword) + 1)
</code></pre>

<hr>
<h2 id='Rdo_get_item_labels'>Get the labels of items in an Rd object</h2><span id='topic+Rdo_get_item_labels'></span>

<h3>Description</h3>

<p>Get the labels of items in an Rd object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_get_item_labels(rdo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_get_item_labels_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Rdo_get_item_labels(rdo)</code> gives the labels of all
<code>"\item"</code>s in <code>rdo</code>. Argument <code>rdo</code> is often a section
or other Rd object fragment, see the examples.
</p>


<h3>Value</h3>

<p>a character vector
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class='language-R'>infile &lt;- system.file("examples", "tz.Rd", package = "Rdpack")
rd &lt;- tools::parse_Rd(infile)

## get item labels found anywhere in the Rd object
(items &lt;- Rdo_get_item_labels(rd))

## search only in section "arguments" (i.e., get argument names)
## (note [[1]] - there is only one arguments section)
pos.args &lt;- Rdo_locate_core_section(rd, "\\arguments")[[1]]
(args &lt;- Rdo_get_item_labels(rd[[pos.args$pos]]))

## search only in section "value"
pos.val &lt;- Rdo_locate_core_section(rd, "\\value")[[1]]
(vals &lt;- Rdo_get_item_labels(rd[[pos.val$pos]]))

## There are no other items in 'rd', so this gives TRUE:
all.equal(items, c(args, vals)) # TRUE
</code></pre>

<hr>
<h2 id='Rdo_insert'>
Insert a new element in an Rd object possibly surrounding it with new
lines
</h2><span id='topic+Rdo_insert'></span>

<h3>Description</h3>

<p>Insert a new element in an Rd object possibly surrounding it with new
lines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_insert(rdo, val, newline = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_insert_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object</p>
</td></tr>
<tr><td><code id="Rdo_insert_+3A_val">val</code></td>
<td>
<p>the content to insert, an Rd object.</p>
</td></tr>
<tr><td><code id="Rdo_insert_+3A_newline">newline</code></td>
<td>
<p>a logical value, controls the insertion of new lines
before and after <code>val</code>, see &lsquo;Details&rsquo;.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Argument <code>val</code> is inserted in <code>rdo</code> at an appropriate
position, see <code><a href="#topic+Rdo_get_insert_pos">Rdo_get_insert_pos</a></code> for detailed
explanation.
</p>
<p>If <code>newline</code> is TRUE, newline elements are inserted before and
after <code>val</code> but only if they are not already there.
</p>
<p>Typically, <code>val</code> is a section of an Rd object and <code>rdo</code> is
an Rd object which is being constructed or modified.
</p>


<h3>Value</h3>

<p>an Rd object
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>

<hr>
<h2 id='Rdo_insert_element'>
Insert a new element in an Rd object
</h2><span id='topic+Rdo_insert_element'></span>

<h3>Description</h3>

<p>Insert a new element at a given position in an Rd object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_insert_element(rdo, val, pos)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_insert_element_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object</p>
</td></tr>
<tr><td><code id="Rdo_insert_element_+3A_val">val</code></td>
<td>
<p>the content to insert.</p>
</td></tr>
<tr><td><code id="Rdo_insert_element_+3A_pos">pos</code></td>
<td>
<p>position at which to insert <code>val</code>, typically an integer
but may be anything accepted by the operator &quot;[[&quot;.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>val</code> is inserted at position <code>pos</code>, between the elements at
positions <code>pos-1</code> and <code>pos</code>. If <code>pos</code> is equal to 1,
<code>val</code> is prepended to <code>rdo</code>. If <code>pos</code> is missing or
equal to the length of <code>rdo</code>, <code>val</code> is appended to
<code>rdo</code>.
</p>
<p>todo: allow vector <code>pos</code> to insert deeper into the object.
</p>
<p>todo: character <code>pos</code> to insert at a position specified by &quot;tag&quot; for example?
</p>
<p>todo: more guarded copying of attributes?
</p>


<h3>Value</h3>

<p>an Rd object
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>

<hr>
<h2 id='Rdo_is_newline'>
Check if an Rd fragment represents a newline character
</h2><span id='topic+Rdo_is_newline'></span>

<h3>Description</h3>

<p>Check if an Rd fragment represents a newline character
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_is_newline(rdo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_is_newline_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a utility function that may be used to tidy up Rd objects.
</p>
<p>It returns TRUE if the Rd object represents a newline
character, i.e. it is a character vector of length one containing the
string <code style="white-space: pre;">&#8288;"\n"&#8288;</code>. Attributes are ignored.
</p>
<p>Otherwise it returns FALSE.
</p>


<h3>Value</h3>

<p>TRUE or FALSE
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>

<hr>
<h2 id='Rdo_locate'>Find positions of elements in an Rd object</h2><span id='topic+Rdo_locate'></span>

<h3>Description</h3>

<p>Find positions of elements for which a function returns
TRUE. Optionally, apply another function to the selected elements and
return the results along with the positions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_locate(object, f = function(x) TRUE, pos_only = TRUE,
           lists = FALSE, fpos = NULL, nested = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_locate_+3A_object">object</code></td>
<td>
<p>an Rd object</p>
</td></tr>
<tr><td><code id="Rdo_locate_+3A_f">f</code></td>
<td>
<p>a function returning TRUE if an element is desired and FALSE
otherwise.</p>
</td></tr>
<tr><td><code id="Rdo_locate_+3A_pos_only">pos_only</code></td>
<td>
<p>if TRUE, return only the positions; if this argument
is a function, return also the result of applying the function to
the selected element, see Details.</p>
</td></tr>
<tr><td><code id="Rdo_locate_+3A_lists">lists</code></td>
<td>
<p>if FALSE, examine only leaves, if TRUE, examine also
lists, see Details.</p>
</td></tr>
<tr><td><code id="Rdo_locate_+3A_fpos">fpos</code></td>
<td>
<p>a function with two arguments, <code>object</code>
and position,  it is called and the value is returned along with the
position, see Details.</p>
</td></tr>
<tr><td><code id="Rdo_locate_+3A_nested">nested</code></td>
<td>
<p>a logical value, it has effect only when <code>lists</code> is
TRUE, see &lsquo;Details&rsquo;.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With the default setting of <code>lists = FALSE</code>, the function
<code>f</code> is applied to each leave (a character string) of the Rd
object. If <code>lists = TRUE</code> the function <code>f</code> is applied also
to each branch (a list). In this case, argument <code>nested</code> controls
what happens when <code>f</code> returns TRUE. If <code>nested</code> is TRUE,
each element of the list is also inspected recursively, otherwise this
is not done and, effectively, the list is considered a leaf. If
<code>f</code> does not return TRUE, the value of <code>nested</code> has no
effect and the elements of the list are inspected.
</p>
<p>The position of each object for which <code>f</code> returns TRUE is
recorded as a numeric vector.
</p>
<p><code>fpos</code> and <code>pos_only</code> provide two ways to do something with
the selected elements.  Argument <code>fpos</code> is more powerful than
<code>pos_only</code> but the latter should be sufficient and simpler to use
in most cases.
</p>
<p>If <code>fpos</code> is a function, it is applied to each selected element
with two arguments, <code>object</code> and the position, and the result
returned along with the position. In this case argument
<code>pos_only</code> is ignored. If <code>fpos</code> is NULL the action depends
on <code>pos_only</code>.
</p>
<p>If <code>pos_only = TRUE</code>, <code>Rdo_locate</code> returns a list of such
vectors (not a matrix since the positions of the leaves are, in
general, at different depths).
</p>
<p>If <code>pos_only</code> is a function, it is applied to each selected
element and the result returned along with the position.
</p>


<h3>Value</h3>

<p>a list with one entry for each selected element. Each entry is a
numeric vector or a list with two elements:
</p>
<table>
<tr><td><code>pos</code></td>
<td>
<p>the position, a vector of positive integers,</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>the result of applying the function to the element at
<code>pos</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The following needs additional thought.
</p>
<p>In some circumstances an empty list, tagged with <code>Rd_tag</code> may
turn up, e.g. <code>list()</code> with <code style="white-space: pre;">&#8288;Rd_tag="\dots"&#8288;</code> in an
<code style="white-space: pre;">&#8288;\arguments&#8288;</code> section.
</p>
<p>On the one hand this is a list. On the other hand it may be considered
a leaf. It is not clear if any attempt to recurse into such a list
should be made at all.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+Rdo_sections">Rdo_sections</a></code> and
<code><a href="#topic+Rdo_locate_core_section">Rdo_locate_core_section</a></code>
which locate top level sections
</p>


<h3>Examples</h3>

<pre><code class='language-R'># todo: put examples here!
</code></pre>

<hr>
<h2 id='Rdo_locate_leaves'>Find leaves of an Rd object using a predicate</h2><span id='topic+Rdo_locate_leaves'></span>

<h3>Description</h3>

<p>Apply a function to the character leaves of an Rd object
and return the indices of those for which the result is TRUE.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_locate_leaves(object, f = function(x) TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_locate_leaves_+3A_object">object</code></td>
<td>
<p>the object to be examined, usually a list.</p>
</td></tr>
<tr><td><code id="Rdo_locate_leaves_+3A_f">f</code></td>
<td>
<p>a function (predicate) returning TRUE for elements with the
desired property.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>object</code> can be any list whose elements are character strings or
lists. The structure is examined recursively. If <code>object</code> is a
character vector, it is enclosed in a list.
</p>
<p>This function provides a convenient way to locate leaves of an Rd
object with a particular content. The function is not limited to Rd
objects but it assumes that the elements of <code>object</code> are either
lists or charater vectors and currently does not check if this is the
case.
</p>
<p><strong>todo:</strong> describe the case of <code>list()</code> (<code>Rd_tag</code>'ed.)
</p>


<h3>Value</h3>

<p>a list of the positions of the leaves for which the predicate gives
<code>TRUE</code>. Each position is an integer vector suitable for the
<code>"[["</code> operator.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class='language-R'>dummyfun &lt;- function(x) x

fn &lt;- tempfile("dummyfun", fileext = "Rd")
reprompt(dummyfun, filename = fn)
rdo &lt;- tools::parse_Rd(fn)

f &lt;-  function(x) Rdo_is_newline(x)

nl &lt;- Rdo_locate_leaves(rdo, f )

length(nl)  # there are quite a few newline leaves!

unlink(fn)
</code></pre>

<hr>
<h2 id='Rdo_macro'>
Format Rd fragments as macros (todo: a baffling title!)
</h2><span id='topic+Rdo_macro'></span><span id='topic+Rdo_macro1'></span><span id='topic+Rdo_macro2'></span><span id='topic+Rdo_item'></span><span id='topic+Rdo_sigitem'></span>

<h3>Description</h3>

<p>Format Rd fragments as macros, generally by putting them in a list and
setting the &quot;Rd_tag&quot; as needed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_macro(x, name)

Rdo_macro1(x, name)

Rdo_macro2(x, y, name)

Rdo_item(x, y)

Rdo_sigitem(x, y, newline = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_macro_+3A_x">x</code></td>
<td>
<p>an object.</p>
</td></tr>
<tr><td><code id="Rdo_macro_+3A_y">y</code></td>
<td>
<p>an object.</p>
</td></tr>
<tr><td><code id="Rdo_macro_+3A_name">name</code></td>
<td>
<p>the &quot;<code style="white-space: pre;">&#8288;Rd_tag&#8288;</code>&quot;, a string.</p>
</td></tr>
<tr><td><code id="Rdo_macro_+3A_newline">newline</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Rdo_macro1</code> wraps <code>x</code> in a list with &quot;<code style="white-space: pre;">&#8288;Rd_tag&#8288;</code>&quot;
<code>name</code>. This is the representation of Rd macros with one argument.
</p>
<p><code>Rdo_macro2</code> basically wraps a possibly transformed <code>x</code> and
<code>y</code> in a list with &quot;<code style="white-space: pre;">&#8288;Rd_tag&#8288;</code>&quot; <code>name</code>. More specifically,
if <code>x</code> has a non-NULL &quot;<code style="white-space: pre;">&#8288;Rd_tag&#8288;</code>&quot;, <code>x</code> is wrapped in
<code>list</code>. Otherwise <code>x</code> is left as is, unless <code>x</code> is a
character string, when it is converted to a text Rd element and
wrapped in <code>list</code>. <code>y</code> is processed in the same way.
This is the representation of Rd macros with two arguments.
</p>
<p><code>Rdo_macro</code> returns an object with &quot;<code style="white-space: pre;">&#8288;Rd_tag&#8288;</code>&quot; <code>name</code>,
constructed as follows. If <code>x</code> is not of class &quot;character&quot;, its
attribute &quot;<code style="white-space: pre;">&#8288;Rd_tag&#8288;</code>&quot; is set to <code>name</code> and the result
returned without further processing. Otherwise, if it is of class
&quot;character&quot;, <code>x</code> is tagged as an Rd &quot;TEXT&quot; element. It is then
wrapped in a list but only if <code>name</code> is one of &quot;<code style="white-space: pre;">&#8288;\eqn&#8288;</code>&quot; or
&quot;<code style="white-space: pre;">&#8288;\deqn&#8288;</code>&quot;. Finally, <code>Rdo_macro1</code> is called on the
transformed object.
</p>
<p><code>Rdo_item</code> is equivalent to <code>Rdo_macro2</code> with <code>name</code>
set to &quot;<code style="white-space: pre;">&#8288;\item&#8288;</code>&quot;.
</p>
<p><code>Rdo_sigitem</code> is for items which have the syntax used in
description of signatures. In that case the first argument of
&quot;<code style="white-space: pre;">&#8288;\item&#8288;</code>&quot; is wrapped in &quot;<code style="white-space: pre;">&#8288;\code&#8288;</code>&quot;. If <code>y</code> is missing,
a text inviting the author to provide a description of the function
for this signature is inserted.
</p>


<h3>Value</h3>

<p>An Rd element with appropriately set <code style="white-space: pre;">&#8288;Rd_tag&#8288;</code>, as described in
&lsquo;Details&rsquo;.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>

<hr>
<h2 id='Rdo_modify'>
Replace or modify parts of Rd objects
</h2><span id='topic+Rdo_replace_section'></span><span id='topic+Rdo_modify'></span>

<h3>Description</h3>

<p>Replace or modify parts of Rd objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_modify(rdo, val, create = FALSE, replace = FALSE, top = TRUE)

Rdo_replace_section(rdo, val, create = FALSE, replace = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_modify_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object.</p>
</td></tr>
<tr><td><code id="Rdo_modify_+3A_val">val</code></td>
<td>
<p>an Rd fragment.</p>
</td></tr>
<tr><td><code id="Rdo_modify_+3A_create">create</code></td>
<td>
<p>if TRUE, create a new section, see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="Rdo_modify_+3A_replace">replace</code></td>
<td>
<p>a logical, if TRUE <code>val</code> replaces the old content,
otherwise <code>val</code> is concatenated with it, see &lsquo;Details&rsquo;.
</p>
</td></tr>
<tr><td><code id="Rdo_modify_+3A_top">top</code></td>
<td>
<p>a logical, if TRUE examine also the &quot;Rd_tag&quot; of <code>rdo</code>,
see &lsquo;Details&rsquo;.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Argument <code>rdo</code> is an Rd object (complete or a fragment) to be
modified. <code>val</code> is an Rd fragment to use for modification.
</p>
<p>Basically, <code>val</code> is appended to (if <code>replace</code> is FALSE) or
replaces (if <code>replace</code> is TRUE) the content of an element of
<code>rdo</code> which has the same &quot;Rd_tag&quot; as <code>val</code>.
</p>
<p>Argument <code>top</code> specifies whether to check the &quot;Rd_tag&quot; of
<code>rdo</code> itself, see below.
</p>
<p>Here are the details.
</p>
<p>If <code>top</code> is TRUE and <code>rdo</code> and <code>val</code> have the same
(non-NULL) &quot;Rd_tag&quot;, then the action depends on <code>replace</code>
(argument <code>create</code> is ignored in this case).
If <code>replace</code> is TRUE, <code>val</code> is returned. Otherwise
<code>rdo</code> and <code>val</code> are, effectively, concatenated. For example,
<code>rdo</code> may be the &quot;arguments&quot; section of an Rd object and
<code>val</code> may also be an &quot;arguments&quot; section containing new
arguments.
</p>
<p>Otherwise, an element with the &quot;Rd_tag&quot; of <code>val</code> is searched in
<code>rdo</code> using <code>tools:::RdTags()</code>. If such elements are found,
the action again depends on <code>replace</code>.
</p>

<ol>
<li>
<p>If <code>replace</code> is a character string, then the first element of
<code>rdo</code> that is a list whose only element is identical to the
value of <code>replace</code> is replaced by <code>val</code>. If such an
element is not present and <code>create</code> is TRUE, <code>val</code> is
inserted in <code>rdo</code>. If <code>create</code> is FALSE, <code>rdo</code> is not
changed.
</p>
</li>
<li>
<p>If <code>replace</code> is TRUE, the first element found is replaced with
<code>val</code>.
</p>
</li>
<li>
<p>If <code>replace</code> is FALSE, <code>val</code> is appended to the first
element found.
</p>
</li></ol>

<p>If no element with the &quot;Rd_tag&quot; of <code>val</code> is found the action
depends on <code>create</code>.  If <code>create</code> is TRUE, then <code>val</code>
is inserted in <code>rdo</code>, effectively creating a new section. If
<code>create</code> is FALSE, an error is thrown.
</p>
<p><code>Rdo_replace_section</code> is like <code>Rdo_modify</code> with argument
<code>top</code> fixed to TRUE and the default for argument <code>replace</code>
set to TRUE. It hardly makes sense to call <code>Rdo_replace_section</code>
with <code>replace = FALSE</code>  but a character value for it may be
handy in some cases, see the examples.
</p>


<h3>Value</h3>

<p>an Rd object or fragment, as described in &lsquo;Details&rsquo;
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class='language-R'># a &lt;- tools::parse_Rd("./man/promptUsage.Rd")
# char2Rdpiece("documentation", "keyword")

# this changes a keyword from Rd to documentation
# Rdo_replace_section(a, char2Rdpiece("documentation", "keyword"), replace = "Rd")
</code></pre>

<hr>
<h2 id='Rdo_modify_simple'>Simple modification of Rd objects</h2><span id='topic+Rdo_modify_simple'></span>

<h3>Description</h3>

<p>Simple modification of Rd objects.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_modify_simple(rdo, text, section, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_modify_simple_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object.</p>
</td></tr>
<tr><td><code id="Rdo_modify_simple_+3A_text">text</code></td>
<td>
<p>a character vector</p>
</td></tr>
<tr><td><code id="Rdo_modify_simple_+3A_section">section</code></td>
<td>
<p>name of an Rd section, a string.</p>
</td></tr>
<tr><td><code id="Rdo_modify_simple_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code>Rdo_modify</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Argument <code>text</code> is used to modify (as a replacement of or
addition to) the content of section <code>section</code> of <code>rdo</code>.
</p>
<p>This function can be used for simple modifications of an Rd object
using character content without converting it separately to Rd.
</p>
<p><code>text</code> is converted to Rd with <code>char2Rdpiece(text, section)</code>.
The result is passed to <code>Rdo_modify</code>, together with
the remaining arguments.
</p>


<h3>Value</h3>

<p>an Rd object
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+Rdo_modify">Rdo_modify</a></code>
</p>

<hr>
<h2 id='Rdo_piecetag'>
Give information about Rd elements
</h2><span id='topic+Rdo_piecetag'></span><span id='topic+Rdo_sectype'></span><span id='topic+is_Rdsecname'></span>

<h3>Description</h3>

<p>Give information about Rd elements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_piecetag(name)

Rdo_sectype(x)

is_Rdsecname(name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_piecetag_+3A_name">name</code></td>
<td>
<p>the name of an Rd macro, a string.</p>
</td></tr>
<tr><td><code id="Rdo_piecetag_+3A_x">x</code></td>
<td>
<p>the name of an Rd macro, a string.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Rdo_piecetag</code> gives the &quot;Rd_tag&quot; of the Rd macro <code>name</code>.
</p>
<p><code>Rdo_sectype</code> gives the &quot;Rd_tag&quot; of the Rd section <code>x</code>.
</p>
<p><code>is_Rdsecname(name)</code> returns TRUE if <code>name</code> is the name of a
top level Rd section.
</p>
<p>The information returned by these functions is obtained from the
charater vectors <code>Rdo_piece_types</code> and
<code>Rdo_predefined_sections</code>.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+Rdo_piece_types">Rdo_piece_types</a></code> and
<code><a href="#topic+Rdo_predefined_sections">Rdo_predefined_sections</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Rdo_piecetag("eqn")  # ==&gt; "VERB"
Rdo_piecetag("code") # ==&gt; "RCODE"

Rdo_sectype("usage") # ==&gt; "RCODE"
Rdo_sectype("title") # ==&gt; "TEXT"

Rdo_sectype("arguments")
</code></pre>

<hr>
<h2 id='Rdo_remove_srcref'>Remove srcref attributes from Rd objects</h2><span id='topic+Rdo_remove_srcref'></span>

<h3>Description</h3>

<p>Removes srcref attributes from Rd objects.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_remove_srcref(rdo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_remove_srcref_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>srcref</code> attrbutes (set by <code>parse_Rd</code>) may be getting in the
way during manipulation of Rd objects, such as comparisons, addition
and replacement of elements. This function traverses the
argument and removes the <code>srcref</code> attribute from all of its elements.
</p>


<h3>Value</h3>

<p>an Rd object with no srcref attributes.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>

<hr>
<h2 id='Rdo_reparse'>Reparse an Rd object</h2><span id='topic+Rdo_reparse'></span>

<h3>Description</h3>

<p>Reparse an Rd object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_reparse(rdo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_reparse_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Rdo_reparse</code> saves <code>rdo</code> to a temporary file and parses it
with <code>parse_Rd</code>. This ensures that the Rd object is a &quot;canonical&quot;
one, since one and the same Rd file can be produced by different (but
equivalent) Rd objects.
</p>
<p>Also, the functions in this package do not attend to attribute
&quot;srcref&quot; (and do not use it) and reparsing takes care of this.
(todo: check if there is a problem if the tempfile disappears.)
</p>

<p>(Murdoch 2010; Francois 2014)  
</p>


<h3>References</h3>

<p>Romain Francois (2014).
<em>bibtex: bibtex parser</em>.
R package version 0.4.0.<br /><br /> Duncan Murdoch (2010).
&ldquo;Parsing Rd files.&rdquo;
<a href="https://developer.r-project.org/parseRd.pdf">https://developer.r-project.org/parseRd.pdf</a>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># the following creates Rd object rdo
dummyfun &lt;- function(x) x
fn &lt;- tempfile("dummyfun", fileext = "Rd")

reprompt(dummyfun, filename = fn)
rdo &lt;- tools::parse_Rd(fn)

dottext &lt;- "further arguments to be passed on."

dots &lt;- paste0("\\", "dots")
rdo2 &lt;- Rdo_append_argument(rdo, dots, dottext, create = TRUE)
rdo2 &lt;- Rdo_append_argument(rdo2, "z", "a numeric vector")

Rdo_show(Rdo_reparse(rdo2))

# the following does ot show the arguments. (todo: why?)
#    (see also examples in Rdo_append_argument)
Rdo_show(rdo2)

unlink(fn)
</code></pre>

<hr>
<h2 id='Rdo_sections'>Locate the sections in Rd objects</h2><span id='topic+Rdo_sections'></span><span id='topic+Rdo_locate_core_section'></span>

<h3>Description</h3>

<p>Locate the Rd sections in an Rd object and return a list of
their positions and names.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_sections(rdo)

Rdo_locate_core_section(rdo, sec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_sections_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object.</p>
</td></tr>
<tr><td><code id="Rdo_sections_+3A_sec">sec</code></td>
<td>
<p>the name of a section, a character string. For builtin
sections the leading backslash should be included.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Rdo_sections</code> locates all sections at the top level in an Rd
object. This includes the predefined sections and the user defined
sections. Sections wrapped in <code style="white-space: pre;">&#8288;#ifdef&#8288;</code> directives are also found.
</p>
<p><code>Rdo_sections</code> returns a list with one entry for each section in
<code>rdo</code>. This entry is a list with components <code>"pos"</code> and
<code>"title"</code> giving the position (suitable for use in <code style="white-space: pre;">&#8288;"[["&#8288;</code>)
and the title of the section.  For user defined sections the actual
name is returned, not &quot;section&quot;.
</p>
<p>The names of the sections are returned as single strings without
attributes. The titles of predefined sections are single words but
user defined sections may have longer titles and sometimes contain
basic markup.
</p>
<p><code>Rdo_locate_core_section</code> works similarly but returns only the
results for section <code>sec</code>. Currently it simply calls
<code>Rdo_sections</code> and returns only the results for <code>sec</code>.
</p>
<p>Note that for consistency <code>Rdo_locate_core_section</code> does not
attempt to simplify the result in the common case when there is only
one instance of the requested section&mdash;it is put in a list of length
one. 
</p>
<p>(Murdoch 2010)  
(Francois 2014)  
</p>


<h3>Value</h3>

<p>A list giving the positions and titles of the sections in <code>rdo</code>
as described in 'Details'. The format is essentially that of
<code><a href="#topic+Rdo_locate">Rdo_locate</a></code>, the difference being that field  &quot;value&quot;
from that function is renamed to &quot;title&quot; here.
</p>
<table>
<tr><td><code>pos</code></td>
<td>
<p>the position, a vector of positive integers,</p>
</td></tr>
<tr><td><code>title</code></td>
<td>
<p>a standard section name, such as <code style="white-space: pre;">&#8288;"\name"&#8288;</code> or, in
the case of &quot;\section&quot;, the actual title of the section.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>I wrote <code>Rdo_sections</code> and <code>Rdo_locate_core_section</code> after
most of the core functionality was tested. Currently these functions
are underused&mdash;they can replace a number of internal and exported
functions.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>References</h3>

<p>Romain Francois (2014).
<em>bibtex: bibtex parser</em>.
R package version 0.4.0.<br /><br /> Duncan Murdoch (2010).
&ldquo;Parsing Rd files.&rdquo;
<a href="https://developer.r-project.org/parseRd.pdf">https://developer.r-project.org/parseRd.pdf</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Rdo_locate">Rdo_locate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>infile &lt;- system.file("examples", "tz.Rd", package = "Rdpack")
rd &lt;- tools::parse_Rd(infile)

## Locate all top level sections in rd
sections &lt;- Rdo_sections(rd)
## How many sections there are in rd?
length(sections)
## What are their titles?
sapply(sections, function(x) x$title)

## The names of builtin sections include the backslash
Rdo_locate_core_section(rd, "\\title")

## Locate a user defined secion
Rdo_locate_core_section(rd, "Further information")

## The names of builtin sections include the backslash
Rdo_locate_core_section(rd, "\\details")

## All appearances of the requested section are returned
Rdo_locate_core_section(rd, "\\alias")
Rdo_locate_core_section(rd, "\\keyword")
</code></pre>

<hr>
<h2 id='Rdo_set_section'>
Replace a section in an Rd file
</h2><span id='topic+Rdo_set_section'></span>

<h3>Description</h3>

<p>Replace a section in an Rd file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_set_section(text, sec, file, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_set_section_+3A_text">text</code></td>
<td>
<p>the new text of the section, a character vector.</p>
</td></tr>
<tr><td><code id="Rdo_set_section_+3A_sec">sec</code></td>
<td>
<p>name of the section.</p>
</td></tr>
<tr><td><code id="Rdo_set_section_+3A_file">file</code></td>
<td>
<p>name of the file.</p>
</td></tr>
<tr><td><code id="Rdo_set_section_+3A_...">...</code></td>
<td>
<p>arguments to be passed on to <code>Rdo_modify</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parses the file, replaces the specified section with the new content
and writes the file back. The text is processed as appropriate for the
particular section (<code>sec</code>).
</p>
<p>For example:
</p>
<p><code>Rdo_set_section("Georgi N. Boshnakov", "author", "./man/Rdo2Rdf.Rd")</code>
</p>
<p>(Some care is needed with the author field for &quot;xxx-package.Rd&quot; files, such
as  &quot;Rdpack-package.Rd&quot;,  where the <code style="white-space: pre;">&#8288;Author(s)&#8288;</code> field has
somewhat different layout.)
</p>
<p>By default <code>Rdo_set_section</code> does not create the section if it
does not exist, since this may not be desirable for some Rd files.  The
&quot;...&quot;  arguments can be used to change this, they are passed on to
<code><a href="#topic+Rdo_modify">Rdo_modify</a></code>, see its documentation for details.
</p>


<h3>Value</h3>

<p>This function is used mainly for the side effect of changing <code>file</code>.
It returns the Rd formatted text as a character vector.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+Rdo_modify">Rdo_modify</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fnA &lt;- tempfile("dummyfun", fileext = "Rd")
dummyfun &lt;- function(x) x
reprompt(dummyfun, filename = fnA)
Rdo_show(tools::parse_Rd(fnA))

## set the author section, create it if necessary.
Rdo_set_section("A.A. Author", "author", fnA, create = TRUE)
Rdo_show(tools::parse_Rd(fnA))

## replace the author section
Rdo_set_section("Georgi N. Boshnakov", "author", fnA)
Rdo_show(tools::parse_Rd(fnA))

unlink(fnA)
</code></pre>

<hr>
<h2 id='Rdo_show'>Convert an Rd object to text and show it</h2><span id='topic+Rdo_show'></span>

<h3>Description</h3>

<p>Render an Rd object as text and show it.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_show(rdo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_show_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Rdo_show</code> renders the help page represented by <code>rdo</code> as
text and shows it with <code>file.show()</code>.
</p>
<p><code>Rdo_show</code> is a simplified front end to <code>utils::Rd2txt</code>.
See <code><a href="#topic+viewRd">viewRd</a></code> for more complete rendering, including of
references and citations.
</p>


<h3>Value</h3>

<p>Invisible <code>NULL</code>.
The function is used for the side effect of showing the text
representation of <code>rdo</code>.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+viewRd">viewRd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## create a minimal Rd object
u1 &lt;- list_Rd(name = "Dummyname", alias = "Dummyallias1",
              title = "Dummy title", description = "Dummy description",
              Rd_class = TRUE )
## Not run: 
## run this interactively:    
Rdo_show(u1)

## End(Not run)
</code></pre>

<hr>
<h2 id='Rdo_tag'>
Set the Rd_tag of an object
</h2><span id='topic+Rdo_comment'></span><span id='topic+Rdo_verb'></span><span id='topic+Rdo_Rcode'></span><span id='topic+Rdo_text'></span><span id='topic+Rdo_tag'></span><span id='topic+Rdo_newline'></span>

<h3>Description</h3>

<p>Set the Rd_tag of an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_comment(x = "%%")

Rdo_tag(x, name)

Rdo_verb(x)

Rdo_Rcode(x)

Rdo_text(x)

Rdo_newline()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_tag_+3A_x">x</code></td>
<td>
<p>an object, appropriate for the requested Rd_tag.</p>
</td></tr>
<tr><td><code id="Rdo_tag_+3A_name">name</code></td>
<td>
<p>the tag name, a string.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions simply set attribute &quot;<code style="white-space: pre;">&#8288;Rd_tag&#8288;</code>&quot; of <code>x</code>, effectively
assuming that the caller has prepared it as needed.
</p>
<p><code>Rdo_tag</code> sets the &quot;<code style="white-space: pre;">&#8288;Rd_tag&#8288;</code>&quot; attribute of <code>x</code> to <code>name</code>.
The other functions are shorthands with a fixed name and no second
argument.
</p>
<p><code>Rdo_comment</code> tags an Rd element as comment.
</p>
<p><code>Rdo_newline</code> gives an Rd element representing an empty line.
</p>


<h3>Value</h3>

<p><code>x</code> with its &quot;<code style="white-space: pre;">&#8288;Rd_tag&#8288;</code>&quot; set to
<code>name</code> (<code>Rdo_tag</code>),
&quot;TEXT&quot; (<code>Rdo_text</code>),
&quot;VERB&quot;  (<code>Rdo_verb</code>) or
&quot;RCODE&quot;  (<code>Rdo_Rcode</code>).
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>

<hr>
<h2 id='Rdo_tags'>Give the Rd tags at the top level of an Rd object</h2><span id='topic+Rdo_tags'></span>

<h3>Description</h3>

<p>Give the Rd tags at the top level of an Rd object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_tags(rdo, nulltag = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_tags_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object.</p>
</td></tr>
<tr><td><code id="Rdo_tags_+3A_nulltag">nulltag</code></td>
<td>
<p>a value to use when <code>Rd_tag</code> is missing or NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code style="white-space: pre;">&#8288;"Rd_tag"&#8288;</code> attributes of the top level elements of <code>rdo</code> are
collected in a character vector. Argument <code>nulltag</code> is used for
elements without that attribute. This guarantees that the result is a
character vector.
</p>
<p><code>Rdo_tags</code> is similar to the internal function
<code>tools:::RdTags</code>. Note that <code>tools:::RdTags</code> may return a
list in the rare cases when attribute <code>Rd_tags</code> is not present in
all elements of <code>rdo</code>.
</p>



<h3>Value</h3>

<p>a character vector
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+Rdo_which">Rdo_which</a></code>,
<code><a href="#topic+Rdo_which_tag_eq">Rdo_which_tag_eq</a></code>,
<code><a href="#topic+Rdo_which_tag_in">Rdo_which_tag_in</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>##---- Should be DIRECTLY executable !! ----
</code></pre>

<hr>
<h2 id='rdo_text_restore'>Ensure exported fragments of Rd are as the original</h2><span id='topic+rdo_text_restore'></span>

<h3>Description</h3>

<p>For an Rd object imported from a file, this function ensures that
fragments that were not not changed during the editing of the object
remain unchanged in the exported file. This function is used by
reprompt() to ensure exactly that. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdo_text_restore(cur, orig, pos_list, file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rdo_text_restore_+3A_cur">cur</code></td>
<td>
<p>an Rd object</p>
</td></tr>
<tr><td><code id="rdo_text_restore_+3A_orig">orig</code></td>
<td>
<p>an Rd object</p>
</td></tr>
<tr><td><code id="rdo_text_restore_+3A_pos_list">pos_list</code></td>
<td>
<p>a list of srcref objects specifying portions of files
to replace, see 'Details'.</p>
</td></tr>
<tr><td><code id="rdo_text_restore_+3A_file">file</code></td>
<td>
<p>a file name, essentially a text representation of
<code style="white-space: pre;">&#8288;cur&#8288;</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is essentially internal function. It exists because, in general,
it is not possible to restore the original Rd file from the Rd object
due to the specifications of the Rd format.  The file exported from
the parsed Rd file is functionally equivalent to the original but
equivalent things for the computer are not necessarily equally
pleasant for humans.
</p>
<p>This function is used by <code>reprompt</code> when the source is from a
file and the option to keep the source of unchanged sections as in the
original.
</p>
<p><strong>todo:</strong> needs clean up, there are unnecessary arguments in
particular.
</p>


<h3>Value</h3>

<p>the main result is the side effect of replacing sections in
<code>file</code> not changed by <code>reprompt</code> with the original ones.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov
</p>


<h3>See Also</h3>

<p><code><a href="#topic+reprompt">reprompt</a></code>
</p>

<hr>
<h2 id='Rdo_which'>Find elements of Rd objects for which a condition is true</h2><span id='topic+Rdo_which'></span><span id='topic+Rdo_which_tag_eq'></span><span id='topic+Rdo_which_tag_in'></span>

<h3>Description</h3>

<p>Find elements of Rd objects for which a condition is true.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo_which(rdo, fun)

Rdo_which_tag_eq(rdo, tag)

Rdo_which_tag_in(rdo, tags)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo_which_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object.</p>
</td></tr>
<tr><td><code id="Rdo_which_+3A_fun">fun</code></td>
<td>
<p>a function to evaluate with each element of <code>rdo</code>.</p>
</td></tr>
<tr><td><code id="Rdo_which_+3A_tag">tag</code></td>
<td>
<p>a character string.</p>
</td></tr>
<tr><td><code id="Rdo_which_+3A_tags">tags</code></td>
<td>
<p>a character vector.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions return the indices of the (top level) elements of
<code>rdo</code> which satisfy a condition.
</p>
<p><code>Rdo_which</code> finds elements of <code>rdo</code> for which
the function <code>fun</code> gives TRUE.
</p>
<p><code>Rdo_which_tag_eq</code> finds elements with a specific <code>Rd_tag</code>.
</p>
<p><code>Rdo_which_tag_in</code> finds elements whose <code>Rd_tag</code>'s are among
the ones specified by <code>tags</code>.
</p>



<h3>Value</h3>

<p>a vector of positive integers
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+Rdo_locate">Rdo_locate</a></code> which searches recursively the Rd object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## get the help page for topoc seq()
rdo_seq &lt;- tools::Rd_db("base")[["seq.Rd"]]
## find location of aliases in the topic
( ind &lt;- Rdo_which_tag_eq(rdo_seq, "\alias") )
## extract the first alias
rdo_seq[[ ind[1] ]]
## Not run: 
## extract all aliases
rdo_seq[ind]

## End(Not run)

## db_bibtex &lt;- tools::Rd_db("bibtex")
## names(db_bibtex)
## ## Rdo object for read.bib()
## rdo_read.bib &lt;- db_bibtex[["read.bib.Rd"]]
## Rdo_tags(rdo_read.bib)
## 
## ## which elements of read.bib are aliases?
## Rdo_which_tag_eq(rdo_read.bib, "\alias")
## rdo_read.bib[[3]]
## 
## ## which elements of read.bib contain R code?
## Rdo_which(rdo_read.bib, function(x) any(Rdo_tags(x) == "RCODE") )
## rdo_read.bib[[5]]
## ## which contain prose?
## Rdo_which(rdo_read.bib, function(x) any(Rdo_tags(x) == "TEXT") )
</code></pre>

<hr>
<h2 id='Rdo2Rdf'>
Convert an Rd object to Rd file format
</h2><span id='topic+Rdo2Rdf'></span>

<h3>Description</h3>

<p>Converts an Rd object to Rd format and saves it to a file or returns
it as a character vector. It escapes percents where necessary and
(optionally) backslashes in the examples section.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdo2Rdf(rdo, deparse = FALSE, ex_restore = FALSE, file = NULL,
        rcode = TRUE, srcfile = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdo2Rdf_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object or a character vector, see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="Rdo2Rdf_+3A_deparse">deparse</code></td>
<td>
<p>logical, passed to the print method for Rd objects,
see &lsquo;Details&rsquo;.
</p>
</td></tr>
<tr><td><code id="Rdo2Rdf_+3A_ex_restore">ex_restore</code></td>
<td>
<p>logical, if <code>TRUE</code> escapes backslashes where
necessary.
</p>
</td></tr>
<tr><td><code id="Rdo2Rdf_+3A_file">file</code></td>
<td>
<p>a filename where to store the result. If <code>NULL</code> or
&quot;missing&quot;, the result is returned as a character vector.
</p>
</td></tr>
<tr><td><code id="Rdo2Rdf_+3A_rcode">rcode</code></td>
<td>
<p>if TRUE, duplicate backslahes in RCODE elements, see
Details.
</p>
</td></tr>
<tr><td><code id="Rdo2Rdf_+3A_srcfile">srcfile</code></td>
<td>
<p>NULL or a file name, see 'Details'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The description here is rather technical and incomplete. In any case
it concerns almost exclusively Rd files which use escape sequences
containing multiple consecutive backslashes or escaped curly braces
(such things appear in regular expressions, for example).
</p>
<p>In principle, this function should be redundant, since the
<code>print</code> and <code>as.character</code> methods for objects of class &quot;Rd&quot;
would be expected to do the job. I was not able to get the desired
result that way (the <code>deparse</code> option to <code>print</code> did not
work completely for me either).
</p>
<p>Arguments <code>ex_restore</code> and <code>rcode</code> were added on an ad-hoc
basis. <code>rcode</code> is more recent and causes <code>Rdo2Rdf</code> to
duplicate backslashes found in any element <code>Rd_tag</code>-ed with
&quot;RCODE&quot;. <code>ex_restore</code> does the same but only for the examples
section. In effect, if <code>rcode</code> is TRUE, <code>ex_restore</code> is
ignored.
</p>
<p>The initial intent of this function (and the package Rdpack as a whole
was not to refer to the Rd source file. However, there is some
flexibility in the Rd syntax that does not allow the source file to be
restored identically from the parsed object. This concerns mainly
backslahes (and to some extent curly braces) which in certain contexts
may or may not be escaped and the parsed object is the same. Although
this does not affect functionality, it may be annoying if the escapes
in sections not examined by <code>reprompt</code> were changed.
</p>
<p>If <code>srcfile</code> is the name of a file, the file is parsed and the Rd
text of sections of <code>rdo</code> that are identical to sections from
<code>srcfile</code> is taken directly from <code>srcfile</code>, ensuring that
they will be identical to the original.
</p>


<h3>Value</h3>

<p><code>NULL</code>, if <code>file</code> is not <code>NULL</code>. Otherwise the Rd
formatted text as a character vector.
</p>


<h3>Note</h3>

<p>Here is an example when the author's Rd source cannot be restored
exactly from the parsed object.
</p>
<p>In the Rd source &quot;author&quot; has two backslashes here: <code style="white-space: pre;">&#8288;\author&#8288;</code>.
</p>
<p>In the Rd source &quot;author&quot; has one backslash here: <code style="white-space: pre;">&#8288;\author&#8288;</code>.
</p>
<p>Both sentences are correct and the parsed file contains only one
backslash in both cases. If <code>reprompt</code> looks only at the parsed
object it will export one backslash in both cases. So, further
reprompt()-ing will not change them again. This is if <code>reprompt</code>
is called with <code>sec_copy = FALSE</code>.  With the default
<code>sec_copy = TRUE</code>, <code>reprompt</code> calls <code>Rdo2Rdf</code> with
argument <code>srcfile</code> set to the name of the Rd file and since
<code>reprompt</code> does not modify section &quot;Note&quot;, its text is copied
from the file and the author's original preserved.
</p>
<p>However, the arguments of <code style="white-space: pre;">&#8288;\eqn&#8288;</code> are parse_Rd-ed differently (or
so it seems) even though they are also in verbatim.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class='language-R'># # this keeps the backslashes in "author" (see Note above)
# reprompt(infile="./man/Rdo2Rdf.Rd")

# # this outputs "author" preceded by one backslash only.
# reprompt(infile="./man/Rdo2Rdf.Rd", sec_copy = FALSE)
</code></pre>

<hr>
<h2 id='Rdpack_bibstyles'>Set up a custom style for references in help pages</h2><span id='topic+Rdpack_bibstyles'></span>

<h3>Description</h3>

<p>Set up a custom style for references in help pages.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdpack_bibstyles(package, authors)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdpack_bibstyles_+3A_package">package</code></td>
<td>
<p>the name of a package, a character string.</p>
</td></tr>
<tr><td><code id="Rdpack_bibstyles_+3A_authors">authors</code></td>
<td>
<p>if equal to &quot;LongNames&quot;, use full names of authors in
reference lists, see Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the initial implementation of support for styles for lists of
bibliography references.
</p>
<p>Currently setting <code>authors</code> to <code>"LongNames"</code> will cause the
references to appear with full names, eg John Smith rather than in the
default Smith J style.
</p>
<p>Package authors can request this feature by adding the following line
to their <code>.onLoad</code> function (if their package has one):
</p>
<pre>
    Rdpack::Rdpack_bibstyles(package = pkg, authors = "LongNames")
</pre>
<p>of just copy the following definition in a package that does not have
<code>.onLoad</code>  : 
</p>
<pre>
    .onLoad &lt;- function(lib, pkg){
        Rdpack::Rdpack_bibstyles(package = pkg, authors = "LongNames")
        invisible(NULL)
    }
</pre>
<p>After building and installing the package the references should be
using long names. 
</p>


<h3>Value</h3>

<p>in .onLoad(), the function is used purely to set up a bibstyle as
discussed in Details.
</p>
<p>Internally, <span class="pkg">Rdpack</span> uses it to extract styles set up by packages: 
</p>
<p>- if called with argument <code>package</code> only, the style requested
by that package;
</p>
<p>- if called with no arguments, a list of all styles.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>

<hr>
<h2 id='Rdpack-package'>



Update and Manipulate Rd Documentation Objects
</h2><span id='topic+Rdpack-package'></span><span id='topic+Rdpack'></span>

<h3>Description</h3>

<p>Functions for manipulation of R documentation objects,
    including functions reprompt() and ereprompt() for updating 'Rd'
    documentation for functions, methods and classes; 'Rd' macros for
    citations and import of references from 'bibtex' files for use in
    'Rd' files and 'roxygen2' comments; 'Rd' macros for evaluating and
    inserting snippets of 'R' code and the results of its evaluation or
    creating graphics on the fly; and many functions for manipulation of
    references and Rd files.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
    Package:  </td><td style="text-align: left;"> Rdpack</td>
</tr>
<tr>
 <td style="text-align: left;">
    Type:     </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
    Version:  </td><td style="text-align: left;"> 2.6 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Date:     </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
    License:  </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
    LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
    Built:    </td><td style="text-align: left;"> R 4.3.2; ; 2023-11-08 11:27:38 UTC; unix
  </td>
</tr>

</table>








<p>Package <code>Rdpack</code> provides a number of functions for maintenance
of documentation in <span class="rlang"><b>R</b></span> packages.  Although base <span class="rlang"><b>R</b></span> and
package <code>methods</code> have functions for creation of skeleton
documentation, if a function gets a new argument or a generic gets a
new method, then updating existing documentation is somewhat
inconvenient. This package provides functions that update parts of the
Rd documentation that can be dealt with automatically and leave manual
changes untouched. For example, usage sections for functions are
updated and if there are undescribed arguments, additional items are
put in the &lsquo;arguments&rsquo; section. 
</p>
<p>A set of functions and macros support inclusion of references and
citations from BibTeX files in <span class="rlang"><b>R</b></span> documentation (Rd and
roxygen2). These tools use only facilities provided by base <span class="rlang"><b>R</b></span> and
package <span class="pkg">rbibutils</span> (Boshnakov and Putman 2020).
</p>
<p>There are also convenience  macros for inclusion of evaluated examples
and graphs, which hide some of the hassle of doing this directly with
the underlying <code style="white-space: pre;">&#8288;\Sexpr&#8288;</code>'s.
</p>
<p>The subsections below give additional details, see also the vignettes.
</p>


<h4>Creating and updating Rd files</h4>

<p>The main function provided by this package is <code><a href="#topic+reprompt">reprompt</a></code>.
There is also a function <code><a href="#topic+promptPackageSexpr">promptPackageSexpr</a></code> for creating
initial skeleton for overall package description such as this help
page.
</p>
<p><code><a href="#topic+reprompt">reprompt</a></code> produces a skeleton documentation for the
requested object, similarly to functions like <code>prompt</code>,
<code>promptMethods</code>, and <code>promptClass</code>.  Unlike those functions,
<code><a href="#topic+reprompt">reprompt</a></code> updates existing documentation (installed or in
an Rd object or file) and produces a skeleton from scratch as a last
resort only. If the documentation object describes more than one
function, all descriptions are updated.  Basically,
<code><a href="#topic+reprompt">reprompt</a></code> updates things that are generated
automatically, leaving manual editing untouched.
</p>
<p>The typical use of <code>reprompt</code> is with one argument, as in
</p>
<pre>
    reprompt(infile = "./Rdpack/man/reprompt.Rd")
    reprompt(reprompt)
    reprompt("reprompt")
</pre>
<p><code>reprompt</code> updates the documentation of all objects described in
the Rd object or file, and writes the updated Rd file in the current
working directory, see <code><a href="#topic+reprompt">reprompt</a></code> for details. To describe
a new function in an existing Rd file, just add something like
<code>myfun()</code> and run reprompt to insert the correct signature,
alias, etc. This works also for replacement functions, see
<code><a href="#topic+reprompt">reprompt</a></code> for details.
</p>
<p><code><a href="#topic+ereprompt">ereprompt</a></code> updates the Rd documentation in a file,
overwrites it and opens it in an editor. It calls <code>reprompt</code> to
do the actual job but has different defaults. Which editor is opened,
is system dependent, see the <code><a href="utils.html#topic+edit">edit</a></code> and
<code><a href="#topic+ereprompt">ereprompt</a></code> for futher details. 
</p>
<p>Users who work on Rd files in RStudio can use add-in &ldquo;Reprompt&rdquo;
to invoke <code>reprompt</code> conveniently on an Rd file or on a selected
object in an <span class="rlang"><b>R</b></span> source code file, see
<code><a href="#topic+RStudio_reprompt">RStudio_reprompt</a></code>. This add-in was contributed by Duncan
Murdoch.
</p>
<p>Users of Emacs/ESS have various options, depending on their workflow.
One approach is to define a key to call <code><a href="#topic+ereprompt">ereprompt</a></code> on the
file being edited, see
<a href="https://github.com/GeoBosh/georgisemacs">georgisemacs</a> for an
example setup. 
</p>
<p><code><a href="#topic+promptPackageSexpr">promptPackageSexpr</a></code> creates a skeleton for a
package overview in file <code style="white-space: pre;">&#8288;name-package.Rd&#8288;</code>. Then the file can be
edited as needed. This function needs to be called only once for a
package since automatic generation of information in
<code style="white-space: pre;">&#8288;name-package.Rd&#8288;</code> is achieved with Sexpr's at build time, not
with verbatim strings (<code>promptPackage</code> used to insert verbatim
strings but in recent versions of <span class="rlang"><b>R</b></span> it also uses macros.).
</p>
<p>For example, the source of this help page is file
&lsquo;Rdpack-package.Rd&rsquo;. It was initially produced using
</p>
<pre>
    promptPackageSexpr("Rdpack")
</pre>
<p>The factual information at the beginning of this help topic (the index
above, the version and other stuff that can be determined
automatically) is kept automatically up to date.
</p>



<h4>References and Citations</h4>

<p>Another set of functions is for management of bibliographic references
in Rd files.  The old approach based on function <code><a href="#topic+rebib">rebib</a></code>
is fully functional, see below, but the recommended way to insert
references and citations is based on Rd macros.
</p>
<p>The provided Rd macros are fully portable and, in particular, work in
Rd files and roxygen2 comments, see <code><a href="#topic+insertRef">insertRef</a></code> and
vignette <code>vignette("Inserting_bibtex_references", "Rdpack")</code>
for details and examples.
</p>
<p>The Bibtex source for the references and citations produced by the Rd
macros is file &quot;REFERENCES.bib&quot;, which should be located in the root
of the package installation directory. <span class="pkg">Rdpack</span> needs also to be
mentioned in two places in file &lsquo;DESCRIPTION&rsquo;. These one-off
preparation steps are enumerated below:
</p>

<ol>
<li>
<p>Put  the following line in file &lsquo;DESCRIPTION&rsquo;: <br />
</p>
<p><code style="white-space: pre;">&#8288;RdMacros: Rdpack&#8288;</code> <br />
</p>
<p>(If there is already a line starting with 'RdMacros:', add
<span class="pkg">Rdpack</span> to the list on that line.)

</p>
</li>
<li>
<p>Add <span class="pkg">Rdpack</span> to the list of imports (<code style="white-space: pre;">&#8288;Imports:&#8288;</code>
field) in file &lsquo;DESCRIPTION&rsquo;.

</p>
</li>
<li>
<p>Add the following line to file &lsquo;NAMESPACE&rsquo;:
</p>
<pre>  
    importFrom(Rdpack,reprompt)
</pre>
<p>Alternatively, if <span class="pkg">devtools</span> is managing your NAMESPACE file,
the equivalent <span class="pkg">roxygen2</span> line is:
</p>
<pre>  
    #' @importFrom Rdpack reprompt</pre>

</li>
<li>
<p>Create file <code>"REFERENCES.bib"</code> in subdirectory
<code>"inst/"</code> of the package and put the BibTeX references in
that file.

</p>
</li></ol>

<p>The Rd macro <code>\insertRef</code> takes two arguments: a BibTeX key and
the name of a package. Thus, <code>\insertRef{key}{package}</code> inserts
the reference whose key is <code>key</code> from &quot;REFERENCES.bib&quot; of the
specified package (almost always the one being documented).
</p>

<p>Citations can be done with Rd
macro <code>\insertCite</code>, which inserts citation(s) for one or more
BibTeX keys and records the keys.  <code>\insertCiteOnly</code> is similar
to <code>\insertCite</code> but does not record the
keys. <code>\insertNoCite</code> records the keys but does not produce
citations.
</p>
<p><code>\insertAllCited</code> creates a bibliography including
all references recorded by <code>\insertCite</code> and
<code>\insertNoCite</code>. It is usually put in section
&ldquo;References&rdquo;, something like:
</p>
<pre>  
    \references{
      \insertAllCited{}
    }
</pre>
<p>in an Rd file. Don't align the backslash with the second 'e' of
<code>@references</code>, since roxygen2 may interpret it as verbatim text, 
not macro.
</p>
<p>The analogous documentation chunk in roxygen2 might look like this:
</p>
<pre>  
    #' @references
    #'     \insertAllCited{}
</pre>  
<p>Bibliography styles for lists of references are supported as
well. Currently the only alternative offered is to use long names
(Georgi N. Boshnakov) in place of the default style (Boshnakov
GN). More comprehensive alternatives can be included if needed or
requested.
</p>
<p>Convenience functions <code><a href="#topic+makeVignetteReference">makeVignetteReference</a></code> and
<code><a href="#topic+vigbib">vigbib</a></code> generate Bibtex entries for vignettes.
</p>



<h4>Previewing documentation pages</h4>

<p>It is convenient during development to be able to view the
rendered version of the document page being edited. 
The function <code><a href="#topic+viewRd">viewRd</a></code> renders a documentation file in a
source package and displays it as text or in a browser. It renders
references properly in any workflow, including <span class="pkg">devtools</span> development
mode (Wickham et al. 2018) in Emacs/ESS, Rstudio, Rgui.
This function is a good candidate to be assigned to a key in editors
which support this.
</p>
<p>I created this function (in 2017) since the functions provided by
<span class="pkg">devtools</span> and Emacs/ESS are giving errors when processing pages
containing Rd macros.
</p>



<h4>Static Management of References</h4>

<p>In the alternative approach, the function <code><a href="#topic+rebib">rebib</a></code> updates
the bibliographic references in an Rd file. Rdpack uses a simple
scheme for inclusion of bibliographic references. The key for each
reference is in a TeX comment line, as in:
</p>
<pre>
    \references{
      ...
      % bibentry: key1
      % bibentry: key2
      ...
    }
</pre>
<p><code>rebib</code> puts each reference after the line containing its
key. It does nothing if the reference has been put by a previous call
of <code>rebib</code>. If the Bibtex entry for some references changes, it
may be necessary to update them in the Rd file, as well. Call
<code>rebib</code> with <code>force = TRUE</code> to get this effect. There is
also a facility to include all references from the Bibtex file, see
the documentation of <code><a href="#topic+rebib">rebib</a></code> for details.
</p>



<h4>Inserting evaluated examples</h4>

<p>Sometimes the documentation of an object becomes more clear if accompanied by snippets of R
code and their results. 
The standard Rd macro <code style="white-space: pre;">&#8288;\Sexpr&#8288;</code> caters for a number of possibilities to evaluate <span class="rlang"><b>R</b></span> code and
insert the results and the code in the documentation. 
The Rd macro <code style="white-space: pre;">&#8288;\printExample&#8288;</code> provided by package
<span class="pkg">Rdpack</span> builds on it to print a snippet of <span class="rlang"><b>R</b></span> code and the results of its evaluation, similarly to
console output but the code is not prefixed and the results are prefixed with comment
symbols.
For example, <code style="white-space: pre;">&#8288;\printExample{2+2; a &lt;- 2*3; a}&#8288;</code> produces the
following in the rendered documentation:
</p>
<pre>2 + 2
##: [1] 4
a &lt;- 2 * 3
a
##: [1] 6
</pre>

<p>The help page of <code><a href="#topic+promptUsage">promptUsage</a></code> contains a number of examples created with
<code>\printExample</code>. The corresponding Rd file can be obtained from the package tarball or from
<a href="https://github.com/GeoBosh/Rdpack/blob/master/man/promptUsage.Rd">https://github.com/GeoBosh/Rdpack/blob/master/man/promptUsage.Rd</a>.
</p>
<p>The argument of <code style="white-space: pre;">&#8288;\printExample&#8288;</code> must be on a single line with versions of R before
R 3.6.0.
</p>
<p><code style="white-space: pre;">&#8288;\printExample&#8288;</code> is typically placed in section Details of an
object's documentation, see section Details of <code><a href="#topic+get_usage">get_usage</a></code>
for a number of examples produced mostly with <code style="white-space: pre;">&#8288;\printExample&#8288;</code>.
</p>
<p>The macro <code style="white-space: pre;">&#8288;\runExamples&#8288;</code> can be used as a replacement
of section <code style="white-space: pre;">&#8288;Examples&#8288;</code>.
For example, if the following code is put at the top level in an Rd file (i.e. not in a
section):
</p>
<pre>
    \runExamples{2+2; a &lt;- 2*3; a}
</pre>
<p>then it will be evaluated and replaced by a normal section examples:
</p>
<pre>
    \examples{
    2 + 2
    ##: 4
    a &lt;- 2 * 3
    a
    ##: 6
    }
</pre>
<p>This generated examples section is processed by the standard <span class="rlang"><b>R</b></span> tools (almost) as if it was
there from the outset. In particular, the examples are run by the R's quality control tools
and tangled along with examples in other documentation files.
</p>
<p>In <span class="rlang"><b>R</b></span> versions before 3.6.0 <code style="white-space: pre;">&#8288;R CMD check&#8288;</code> used to give a warning about
unknown <code style="white-space: pre;">&#8288;\Sexpr&#8288;</code> section at top level.
</p>






<h4>Creating and including graphs</h4>

<p>Figures can be inserted with the help of the standard Rd markup command
<code style="white-space: pre;">&#8288;\figure&#8288;</code>.  The Rd macro <code style="white-space: pre;">&#8288;\insertFig&#8288;</code> provided by package
<span class="pkg">Rdpack</span> takes a snipped of <span class="rlang"><b>R</b></span> code, evaluates it and inserts the
plot produced by it (using <code style="white-space: pre;">&#8288;\figure&#8288;</code>).  <code style="white-space: pre;">&#8288;\insertFig&#8288;</code> takes
three arguments: a filename, the package name and the code to evaluate
to produce the figure.  For example,
</p>
<pre>
    \insertFig{cars.png}{mypackage}{x &lt;- cars$speed; y &lt;- cars$dist; plot(x,y)}
</pre>
<p>will evaluate the code, save the graph in file <code>"man/figures/cars.png"</code> subdirectory of
package <code>"mypackage"</code>, and include the figure using <code style="white-space: pre;">&#8288;\figure&#8288;</code>. 
Subdirectory <code>"figures"</code> is created if it doesn't exist. 
Currently the graphs are saved in <code>"png"</code> format only.
In older versions of <span class="rlang"><b>R</b></span> the code should be on a single line for the reasons explained in the
discussion of <code style="white-space: pre;">&#8288;\printExample&#8288;</code>. 
</p>
<p>The sister macro <code style="white-space: pre;">&#8288;\makeFig&#8288;</code> creates the graph in exactly the same
way as <code style="white-space: pre;">&#8288;\insertFig&#8288;</code> but does not insert it. This can be done with a
separate <code style="white-space: pre;">&#8288;\figure&#8288;</code> command. This can be used if additional options are
desired for different output formats, see the description of <code style="white-space: pre;">&#8288;\figure&#8288;</code>
in &quot;Writing R extensions&quot;.
</p>

<p>Other functions that may be useful are <code>Rdo2Rdf</code>, <code>Rdapply</code>
and <code>Rd_combo</code>. Here is also brief information about some more
technical functions that may be helpful in certain circumstances.
</p>
<p><code><a href="#topic+get_usage">get_usage</a></code> generates usage text for functions and
methods. The functions can be located in environments or other
objects. This may be useful for description of function elements of
compound objects. 
</p>
<p><code><a href="#topic+c_Rd">c_Rd</a></code> concatenates Rd pieces, character strings and lists
to create a larger Rd piece or a complete Rd object.
<code><a href="#topic+list_Rd">list_Rd</a></code> is similar to <code><a href="#topic+c_Rd">c_Rd</a></code> but provides
additional features for convenient assembling of Rd objects.
</p>
<p><code><a href="#topic+parse_Rdpiece">parse_Rdpiece</a></code> is a technical function for parsing pieces
of Rd source text but it has an argument to return formatted help text
which may be useful when one wishes to show it to the user.
</p>
<p><code>Rdo_set_section</code> can be used to set a section, such as
&quot;<code style="white-space: pre;">&#8288;\author&#8288;</code>&quot;.
</p>
<p>The remaining functions in the package are for programming with Rd
objects.
</p>


<h3>Note</h3>

<p>All processing is done on the parsed Rd objects, i.e. objects of class
&quot;Rd&quot; or pieces of such objects (Murdoch 2010).
</p>
<p>The following terminology is used (todo: probably not yet
consistently) throughout the documentation.
</p>
<p>&quot;Rd object&quot; - an object of class Rd, or part of such object.
</p>
<p>&quot;Rd piece&quot; - part of an object of class Rd. Fragment is also used but
note that <code>parse_Rd</code> defines fragment more restrictively.
</p>
<p>&quot;Rd text&quot;, &quot;Rd source text&quot;, &quot;Rd format&quot; - these refer to the text of
the Rd files.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov [aut, cre],
  Duncan Murdoch [ctb]
</p>
<p>Maintainer: Georgi N. Boshnakov &lt;georgi.boshnakov@manchester.ac.uk&gt;
</p>


<h3>References</h3>

<p><strong>Note:</strong> Reference ZZZ (2018)
does not exist. It is a test that simple math in BibTeX entries works.
</p>
<p>&mdash;
</p>
<p>Georgi
N. Boshnakov, Chris Putman (2020).
<em>rbibutils: Convert Between Bibliography Formats</em>.
<a href="https://CRAN.R-project.org/package=rbibutils">https://CRAN.R-project.org/package=rbibutils</a>.<br /><br /> Duncan Murdoch (2010).
&ldquo;Parsing Rd files.&rdquo;
<a href="https://developer.r-project.org/parseRd.pdf">https://developer.r-project.org/parseRd.pdf</a>.<br /><br /> Hadley Wickham, Jim Hester, Winston Chang (2018).
<em>devtools: Tools to Make Developing R Packages Easier</em>.
R package version 1.13.5, <a href="https://CRAN.R-project.org/package=devtools">https://CRAN.R-project.org/package=devtools</a>.<br /><br /> A. ZZZ (2018).
&ldquo;A relation between several fundamental constants: <code class="reqn">e^{i\pi}=-1</code>.&rdquo;
<em>A non-existent journal with the formula <code class="reqn">L_2</code> in its name &amp; an ampersand which is preceded by a backslash in the bib file.</em>.
This reference does not exist. It is a test/demo that simple formulas in BibTeX files are OK. A formula in field 'note': <code class="reqn">c^2 = a^2 + b^2</code>. .
</p>


<h3>See Also</h3>


<p><code><a href="#topic+ereprompt">ereprompt</a></code>,
<code><a href="#topic+reprompt">reprompt</a></code>,
<code><a href="#topic+promptPackageSexpr">promptPackageSexpr</a></code>,
<code><a href="#topic+rebib">rebib</a></code>,
</p>
<p><code><a href="#topic+get_usage">get_usage</a></code>,
</p>
<p><code><a href="#topic+viewRd">viewRd</a></code>,
<code><a href="#topic+vigbib">vigbib</a></code>,
<code><a href="#topic+makeVignetteReference">makeVignetteReference</a></code>,
</p>
<p><code>vignette("Inserting_bibtex_references", package = "Rdpack")</code>,
</p>
<p><code>vignette("Inserting_figures_and_evaluated_examples", package = "Rdpack")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The examples below show typical use but are not executable.
## For executable examples see the help pages of 
## reprompt, promptPackageSexpr, and rebib.

## To make the examples executable, replace "myfun" with a real
## function, and similarly for classes and paths to files.

## Not run: 
## update the doc. from the Rd source and save myfun.Rd
##     in the current directory (like prompt)
reprompt(infile="path/to/mypackage/man/myfun.Rd")

## update doc of myfun() from the installed doc (if any);
##     if none is found, create it like prompt
reprompt("myfun")
reprompt(myfun)      # same

## update doc. for S4 methods from Rd source
reprompt(infile="path/to/mypackage/man/myfun-methods.Rd")

## update doc. for S4 methods from installed doc (if any);
##     if none is found, create it like promptMethods
reprompt("myfun", type = "methods")
reprompt("myfun-methods")  # same


## update doc. for S4 class from Rd source
reprompt(infile="path/to/mypackage/man/myclass-class.Rd")

## update doc. of S4 class from installed doc.
##     if none is found, create it like promptClass
reprompt("myclass-class")
reprompt("myclass", type = "class")  # same


## create a skeleton "mypackage-package.Rd"
promptPackageSexpr("mypackage")

## update the references in "mypackage-package.Rd"
rebib(infile="path/to/mypackage/man/mypackage-package.Rd", force=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='Rdreplace_section'> Replace the contents of a section in one or more Rd files</h2><span id='topic+Rdreplace_section'></span>

<h3>Description</h3>

<p>Replace the contents of a section in one or more Rd files.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rdreplace_section(text, sec, pattern, path = "./man", exclude = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rdreplace_section_+3A_text">text</code></td>
<td>
<p>the replacement text, a character string.</p>
</td></tr>
<tr><td><code id="Rdreplace_section_+3A_sec">sec</code></td>
<td>
<p>the name of the section without the leading backslash, as
for <code>Rdo_set_section</code>.</p>
</td></tr>
<tr><td><code id="Rdreplace_section_+3A_pattern">pattern</code></td>
<td>
<p>regular expression for R files to process, see
Details.</p>
</td></tr>
<tr><td><code id="Rdreplace_section_+3A_path">path</code></td>
<td>
<p>the directory were to look for the Rd files.</p>
</td></tr>
<tr><td><code id="Rdreplace_section_+3A_exclude">exclude</code></td>
<td>
<p>regular expression for R files to exclude, see
Details.</p>
</td></tr>
<tr><td><code id="Rdreplace_section_+3A_...">...</code></td>
<td>
<p>not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Rdreplace_section</code> looks in the directory specified by
<code>path</code> for files whose names match <code>pat</code> and drops those
whose names match <code>exclude</code>. Then it replaces section <code>sec</code>
in the files selected in this way.
</p>
<p><code>Rdreplace_section</code> is a convenience function to replace a
section (such as a keyword or author) in several files in one go.
It calls <code><a href="#topic+Rdo_set_section">Rdo_set_section</a></code> to do the work.
</p>


<h3>Value</h3>

<p>A vector giving the full names of the processed Rd files, but the
function is used for the side effect of modifying them as described in
section Details.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Rdo_set_section">Rdo_set_section</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# replace the author in all Rd files except pkgname-package
Rdreplace_section("A. Author", "author", ".*[.]Rd$", exclude = "-package[.]Rd$")

## End(Not run)
</code></pre>

<hr>
<h2 id='rebib'>Work with bibtex references in Rd documentation</h2><span id='topic+rebib'></span><span id='topic+inspect_Rdbib'></span>

<h3>Description</h3>

<p>Work with bibtex references in Rd documentation.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rebib(infile, outfile, ...)

inspect_Rdbib(rdo, force = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rebib_+3A_infile">infile</code></td>
<td>
<p>name of the Rd file to update, a character string.</p>
</td></tr>
<tr><td><code id="rebib_+3A_outfile">outfile</code></td>
<td>
<p>a filename for the updated Rd object.</p>
</td></tr>
<tr><td><code id="rebib_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to
<code><a href="#topic+get_bibentries">get_bibentries</a></code>, see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="rebib_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object.</p>
</td></tr>
<tr><td><code id="rebib_+3A_force">force</code></td>
<td>
<p>if TRUE, re-insert previously imported
references. Otherwise do not change such references.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>inspect_Rdbib</code> takes an Rd object and processes the references
as specified below.
</p>
<p>The user level function is <code>rebib</code>. It parses the Rd file
<code>infile</code>, calls <code>inspect_Rdbib</code> to process the references,
and writes the modified Rd object to file <code>outfile</code>.
If   <code>outfile</code> is missing it is set to the basename of
<code>infile</code>.  If <code>outfile</code> is the empty string, <code>""</code>, then
<code>outfile</code> is set to <code>infile</code>.
</p>
<p>The default Bibtex file is &quot;REFERENCES.bib&quot; in the current working
directory. Arguments &quot;...&quot; can be used to change the name of the bib
file and its location.  Argument <code>bibfile</code> can be used to
overwrite the default name of the bib file.  Argument <code>package</code>
can be used to specify that the bib file should be taken from the root
of the installation directory of package <code>package</code>, see
<code><a href="#topic+get_bibentries">get_bibentries</a></code> for details.
</p>
<p>The following scheme can be used for incorporation of bibliographic
references from BibTeX files. Note however, that usually it is more
convenient to use the approach based on Rd macros like
<code>\insertRef</code>, see <code><a href="#topic+insert_ref">insert_ref</a></code> and the vignette(s).
</p>
<p>The Bibtex key for each reference is put in a comment line in the
references section, as in
</p>
<pre>
    \references{
        % bibentry: key1

        % bibentry: key2

        ...
    }
</pre>
<p>At least one space after the colon, ':', is required, spaces before
&quot;bibentry:&quot; are ignored.
</p>
<p>Then run <code>rebib()</code> on the file, see the example section for a way
to run <code>rebib()</code> on all files in one go.
</p>
<p>Each reference is inserted immediately after the comment line
specifying it and a matching comment line marking its end is
inserted.
</p>
<p>Before inserting a reference, a check for the matching ending line is
made, and if such a line is found, the reference is not inserted.
This means that to add new references it is sufficient to give their
keys, as described above and run the function again. References that
are already there will not be duplicated.
</p>
<p>The inserted reference may also be edited, if necessary. As long as
the two comment lines enclosing it are not removed, the reference will
not be overwritten by subsequent calls of the functions described
here.  Any text outside the markers delineating references inserted by
this mechanism is left unchanged, including references inserted by
other means.
</p>
<p>To include all references from the bib file, the following line can be
used:
</p>
<pre>
    % bibentry:all
</pre>
<p>Notice that there is no space after the colon in this case.
In this case a marker is put after the last reference and the whole
thing is considered one block.  So, if the end marker is present and
<code>force</code> is FALSE, none will will be changed. Otherwise, if
<code>force</code> is TRUE, the whole block of references will be removed
and all references currently in the bib file will be inserted.
</p>
<p>The main purpose of <code style="white-space: pre;">&#8288;bibentry:all&#8288;</code> is for use in a package
overview file. The reference section in the file &quot;package-package&quot;
generated by <code><a href="#topic+promptPackageSexpr">promptPackageSexpr</a></code> uses this feature (but
the user still needs to call <code>rebib</code> to insert the references).
</p>


<h3>Value</h3>

<p>for <code>inspect_Rdbib</code>, the modified Rd object.
</p>
<p><code>rebib</code> is used mainly for the side effect of creating a file
with the references updated. It returns the Rd object created by
parsing and modifying the Rd file.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+insert_ref">insert_ref</a></code> and the vignette(s) for the recommended way
to import BibTeX references and citations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# update references in all Rd files in the package's 'man' directory
#
rdnames &lt;- dir(path = "./man", pattern=".*[.]Rd$", full.names=TRUE)
lapply(rdnames, function(x) rebib(x, package="Rdpack"))

## End(Not run)
</code></pre>

<hr>
<h2 id='reprompt'>Update the documentation of a topic</h2><span id='topic+reprompt'></span>

<h3>Description</h3>

<p>Examine the documentation of functions, methods or classes and
update it with additional arguments, aliases, methods or slots, as
appropriate. This is an extention of the promptXXX() family of functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reprompt(object, infile = NULL, Rdtext = NULL, final = TRUE, 
         type = NULL, package = NULL, methods = NULL, verbose = TRUE, 
         filename = NULL, sec_copy = TRUE, edit = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reprompt_+3A_object">object</code></td>
<td>
<p>the object whose documentation is to be updated, such as
a string, a function, a help topic, a parsed Rd object, see
&lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="reprompt_+3A_infile">infile</code></td>
<td>
<p>a file name containing Rd documentation, see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="reprompt_+3A_rdtext">Rdtext</code></td>
<td>
<p>a character string with Rd formatted text, see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="reprompt_+3A_final">final</code></td>
<td>
<p>logical, if <code>TRUE</code> modifies the output of
<code>prompt</code> so that the package can be built.</p>
</td></tr>
<tr><td><code id="reprompt_+3A_type">type</code></td>
<td>
<p>type of topic, such as <code>"methods"</code> or
<code>"class"</code>, see &lsquo;Details&rsquo;.</p>
</td></tr> 
<tr><td><code id="reprompt_+3A_package">package</code></td>
<td>
<p>package name; document only objects defined in this
package, especially useful for methods, see &lsquo;Details&rsquo;.</p>
</td></tr> 
<tr><td><code id="reprompt_+3A_methods">methods</code></td>
<td>

<p>used for documentation of S4 methods only, rarely needed even for
them.  This argument is passed on to
<code><a href="methods.html#topic+promptMethods">promptMethods</a></code>, see its documentation for
details.
</p>
</td></tr>
<tr><td><code id="reprompt_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code> print messages on the screen.</p>
</td></tr>
<tr><td><code id="reprompt_+3A_filename">filename</code></td>
<td>
<p>name of the file for the generated Rd content; if
<code>NULL</code>, a suitable file name is generated, if <code>TRUE</code> it
will be set to <code>infile</code>,   
if <code>FALSE</code> the Rd text is returned, see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="reprompt_+3A_...">...</code></td>
<td>
<p>currently not used.</p>
</td></tr>
<tr><td><code id="reprompt_+3A_sec_copy">sec_copy</code></td>
<td>
<p>if <code>TRUE</code> copy Rd contents of unchanged sections
in the result, see Details.</p>
</td></tr>
<tr><td><code id="reprompt_+3A_edit">edit</code></td>
<td>
<p>if <code>TRUE</code> call <code>file.edit</code> just before
returning. This argument is ignored if <code>filename</code> is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The typical use of <code>reprompt</code> is with one argument, as in
</p>
<pre>
    reprompt(infile = "./Rdpack/man/reprompt.Rd")
    reprompt(reprompt)
    reprompt("reprompt")
  </pre>
<p><code>reprompt</code> updates the requested documentation and writes the new
Rd file in the current working directory. When argument <code>infile</code>
is used, the descriptions of all objects described in the input file
are updated. When an object or its name is given, <code>reprompt</code>
looks first for installed documentation and processes it in the same
way as in the case of <code>infile</code>. If there is no documentation for
the object, <code>reprompt</code> creates a skeleton Rd file similar to the
one produced by the base R functions from the <code>prompt</code> family (if
<code>final = TRUE</code>, the default, it modifies the output of
<code>prompt()</code>, so that the package can be built).
</p>
<p>To document a function, say <code>myfun</code>, in an existing Rd file, just
add <code>myfun()</code> to the usage section in the file and call
<code>reprompt()</code> on that file. Put quotes around the function name if
it is non-syntactic.  For replacement functions (functions with names
ending in <code>&lt;-</code>) <code>reprompt()</code> will insert the proper usage
statement. For example, if the signature of <code>xxx&lt;-</code> is <code>(x,
  ..., value)</code> then both, <code>"xxx&lt;-"()</code> and <code>xxx() &lt;- value</code>
will be replaced by <code>xxx(x, ...) &lt;- value</code>.
</p>
<p>For S4 methods and classes the argument &quot;package&quot; is often needed to
restrict the output to methods defined in the package of interest.
</p>
<pre>
    reprompt("myfun-methods")

    reprompt("[&lt;--methods", package = "mypackage")             
    reprompt("[&lt;-", type = "methods", package = "mypackage") # same

    reprompt("myclass", type = "class", package = "mypackage") 
    reprompt("myclass-class", package = "mypackage")         # same
  </pre>
<p>Without the &quot;package&quot; argument the reprompt for <code>"[&lt;-"</code> would give
all methods defined by loaded packages at the time of the call. 
</p>
<p>Currently <code>reprompt</code> functionality is not implemented for topic
&quot;package&quot; but if <code>object</code> has the form &quot;name-package&quot; (or the
equivalent with argument <code>topic</code>) and there is no documentation
for <code>package?name</code>, <code>reprompt</code> calls
<code><a href="#topic+promptPackageSexpr">promptPackageSexpr</a></code> to create the required shell.
Note that the shell produced by <code>promptPackageSexpr</code> does not
need &lsquo;reprompting&rsquo; since the automatically generated information is
included by <code style="white-space: pre;">&#8288;\Sexpr&#8288;</code>'s, not literal strings.
</p>
<p>Below are the details.
</p>
<p>Typically, only one of <code>object</code>, <code>infile</code>, and <code>Rdtext</code>
is supplied. Warning messages are issued if this is not the case.
</p>
<p>The object must have been made available by the time when
<code>reprompt()</code> is issued. If the object is in a package this is
typically achieved by a <code>library()</code> command.
</p>
<p><code>object</code> may be a function or a name, as accepted by the <code>?</code>
operator. If it has the form &quot;name-class&quot; and &quot;name-methods&quot; a
documentation shell for class &quot;name&quot; or the methods for generic function
&quot;name&quot; will be examined/created. Alternatively, argument <code>type</code>
may be set to &quot;class&quot; or &quot;methods&quot; to achieve the same effect.
</p>
<p><code>infile</code> specifies a documentation file to be updated. If it
contains the documentation for one or more functions, <code>reprompt</code>
examines their usage statements and updates them if they have
changed. It also adds arguments to the &quot;arguments&quot; section if not all
arguments in the usage statements have entries there. If <code>infile</code>
describes the methods of a function or a class, the checks made are as
appropriate for them. For example, new methods and/or slots are added
to the corresponding sections.
</p>
<p>It is all too easy in interactive use to forget to name the
<code>infile</code> argument, compare<br />
<code>reprompt("./man/reprompt.Rd")</code> vs.
<code>reprompt(infile = "./man/reprompt.Rd")</code>).<br />
A convenience feature is that if <code>infile</code> is missing
and <code>object</code> is a character string ending in &quot;.Rd&quot; and containing
a forward slash (i.e. it looks like Rd file in a directory), then it
is taken to be <code>infile</code>. 
</p>
<p><code>Rdtext</code> is similar to <code>infile</code> but the Rd content is taken
from a character vector.
</p>
<p>If Rd content is supplied by <code>infile</code> or <code>Rdtext</code>,
<code>reprompt</code> uses it as a basis for comparison. Otherwise it tries
to find installed documentation for the object or topic requested.
If that fails, it resorts to one of the <code>promptXXX</code> functions to
generate a documentation shell. If that also fails, the requested
object or topic does not exist.
</p>
<p>If the above succeeds, the function examines the current definition of
the requested object(s), methods, or class and amends the
documentation with any additional items it finds.
</p>
<p>For Rd objects describing one or more functions, the usage expressions
are checked and replaced, if they have changed. Arguments appearing in
one or more usage expressions and missing from section &quot;Arguments&quot; are
amended to it with content &quot;Describe ...&quot;  and a message is
printed. Arguments no longer in the usage statements are NOT removed
but a message is issued to alert the user. Alias sections are inserted
for any functions with &quot;usage&quot; but without &quot;alias&quot; section.
</p>
<p>If <code>filename</code> is a character string, it is used as is, so any
path should be included in the string.  Argument <code>filename</code>
usuallly is omitted since the automatically generated file name is
suitable in most cases. Exceptions are functions with non-standard
names (such as replacement functions whose names end in <code>"&lt;-"</code>)
for which the generated file names may not be acceptable on some
operating systems.
</p>
<p>If <code>filename</code> is missing or <code>NULL</code>, a suitable name is
generated as follows. If <code>infile</code> is supplied, <code>filename</code> is
set to a file with the same name in the current working directory
(i.e. any path information in <code>infile</code> is dropped). Otherwise,
<code>filename</code> is obtained by appending the name tag of the Rd object
with <code>".Rd"</code>. 
</p>
<p>If <code>filename</code> is <code>TRUE</code>, it is set to <code>infile</code> or, if
<code>infile</code> is missing or <code>NULL</code>, a suitable name is generated
as above. This can be used to change <code>infile</code> in place.
</p>
<p>If <code>filename</code> is <code>FALSE</code>, the Rd text is returned as a
character vector and not written to a file. 
</p>
<p>If <code>edit</code> is <code>TRUE</code>, the reprompted file is opened in an
editor, see also <code><a href="#topic+ereprompt">ereprompt</a></code> (&lsquo;e&rsquo; for &lsquo;edit&rsquo;) which is
like <code>reprompt</code> but has as default <code>edit = TRUE</code> and some
other related settings.
</p>
<p><code>file.edit()</code> is used to call the editor.  Which editor is opened
depends on the OS and on the user configuration. RStudio users will
probably prefer the 'Reprompt' add-in or the underlying function
<code><a href="#topic+RStudio_reprompt">RStudio_reprompt</a></code>.  Emacs users would normally have set
up <code>emacsclient</code> as their editor and this is automatically done
by EMACS/ESS (even on Windows).
</p>
<p>If argument <code>sec_copy</code> is <code>TRUE</code> (the default),
<code>reprompt</code> will, effectively, copy the contents of (some)
unchanged sections, thus ensuring that they are exactly the same as in
the original.  This needs additional work, since parsing an Rd file
and then exporting the created Rd object to an Rd file does not
necessarilly produce an identical Rd file (some escape sequences may
be changed in the process, for example).  Even though the new version
should be functionally equivalent to the original, such changes are
usually not desirable. For example, if such changes creep into the
Details section (which <code>reprompt</code> never changes) the user may be
annoyed or worried.
</p>


<h3>Value</h3>

<p>if <code>filename</code> is a character string or <code>NULL</code>, the name of
the file to which the updated shell was written.
</p>
<p>Otherwise, the Rd text is returned as a character vector.
</p>


<h3>Note</h3>

<p>The arguments of <code>reprompt</code> are similar to prompt, with some
additions. As in <code>prompt</code>, <code>filename</code> specifies the output
file. In <code>reprompt</code> a new argument, <code>infile</code>, specifies the
input file containing the Rd source.
</p>
<p>When <code>reprompt</code> is used to update sources of Rd documentation for
a package, it is best to supply the original Rd file in argument
<code>infile</code>. Otherwise, if the original Rd file contains
<code style="white-space: pre;">&#8288;\Sexpr&#8288;</code> commands, <code>reprompt</code> may not be able to recover the
original Rd content from the installed documentation. Also, the fields
(e.g. the keywords) in the installed documentation may not be were you
expect them to be. (This may be addressed in a future revision.)
</p>
<p>While <code>reprompt</code> adds new items to the documentation, it never
removes existing content. It only issues a suggestion to remove an
item, if it does not seem necessary any more (e.g. a removed argument
from a function definition).
</p>
<p><code>reprompt</code> handles usage statements for S3 and S4 methods
introduced with any of the macros <code style="white-space: pre;">&#8288;\method&#8288;</code>, <code style="white-space: pre;">&#8288;\S3method&#8288;</code> and
<code style="white-space: pre;">&#8288;\S4method&#8288;</code>, as in
<code style="white-space: pre;">&#8288;\method{fun}{class}(args...)&#8288;</code>. <code>reprompt</code> understands also
subsetting ans subassignment operators.  For example, suppose that the
<code>\arguments</code> section of file &quot;bracket.Rd&quot; contains these
directives (or any other wrong signatures):
</p>
<pre>
    \method{[}{ts}()
    \method{[[}{Date}()
</pre>
<p>Then <code>reprompt("./bracket.Rd")</code> will change them to
</p>
<pre>
    \method{[}{ts}(x, i, j, drop = TRUE)
    \method{[[}{Date}(x, \dots, drop = TRUE)
</pre>
<p>This works for the assignment operators and functions, as well. For
example, any of these
</p>
<pre>
    \method{`[&lt;-`}{POSIXlt}()
    \method{[}{POSIXlt}(x, j) &lt;- value
</pre>
<p>will be converted by <code>reprompt</code> to the standard form
</p>
<pre>
    \method{[}{POSIXlt}(x, i, j) &lt;- value
</pre>    
<p>Note that the quotes in <code>`[&lt;-`</code> above. 
</p>
<p>Usage statements for functions are split over two or more lines if
necessary. The user may edit them afterwards if the automatic
splitting is not appropriate, see below.
</p>
<p>The usage section of Rd objects describing functions is left intact if
the usage has not changed. To force <code>reprompt</code> to recreate the
usage section (e.g. to reformat long lines), invalidate the usage of
one of the described functions by removing an argument from its usage
expression.  Currently the usage section is recreated completely if
the usage of any of the described functions has changed. Manual
formatting may be lost in such cases.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code><a href="#topic+ereprompt">ereprompt</a></code> which by default calls the editor on the
original file
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## note: usage of reprompt() is simple.  the examples below are bulky
##       because they simulate various usage scenarios with commands,
##       while in normal usage they would be due to editing.

## change to a temporary directory to avoid clogging up user's
cur_wd &lt;- getwd()
tmpdir &lt;- tempdir()
setwd(tmpdir)

## as for prompt() the default is to save in current dir as "seq.Rd".
## the argument here is a function, reprompt finds its doc and
## updates all objects described along with `seq'.
## (In this case there is nothing to update, we have not changed `seq'.)

fnseq &lt;- reprompt(seq)

## let's parse the saved Rd file (the filename is returned by reprompt)
rdoseq &lt;- tools::parse_Rd(fnseq)   # parse fnseq to see the result.
Rdo_show(rdoseq)

## we replace usage statements with wrong ones for illustration.
## (note there is an S3 method along with the functions)
dummy_usage &lt;- char2Rdpiece(paste("seq()", "\\method{seq}{default}()",
                   "seq.int()", "seq_along()", "seq_len()", sep="\n"),
                   "usage")
rdoseq_dummy &lt;- Rdo_replace_section(rdoseq, dummy_usage)
Rdo_show(rdoseq_dummy)  # usage statements are wrong

reprompt(rdoseq_dummy, file = "seqA.Rd")
Rdo_show(tools::parse_Rd("seqA.Rd"))  # usage ok after reprompt

## define function myseq() 
myseq &lt;- function(from, to, x){
    if(to &lt; 0) {
        seq(from = from, to = length(x) + to)
    } else seq(from, to)
}

## we wish to describe  myseq() along with seq();
##    it is sufficient to put myseq() in the usage section
##    and let reprompt() do the rest
rdo2 &lt;- Rdo_modify_simple(rdoseq, "myseq()", "usage")
reprompt(rdo2, file = "seqB.Rd")  # updates usage of myseq

## show the rendered result:
Rdo_show(tools::parse_Rd("seqB.Rd"))

## Run this if you wish to see the Rd file:
##   file.show("seqB.Rd")

reprompt(infile = "seq.Rd", filename = "seq2.Rd")
reprompt(infile = "seq2.Rd", filename = "seq3.Rd")

## Rd objects for installed help may need some tidying for human editing.
#hseq_inst &lt;- help("seq")
#rdo &lt;- utils:::.getHelpFile(hseq_inst)
rdo &lt;- Rdo_fetch("seq", "base")
rdo
rdo &lt;- Rdpack:::.Rd_tidy(rdo)          # tidy up (e.g. insert new lines
                                       #          for human readers)
reprompt(rdo) # rdo and rdoseq are equivalent
all.equal(reprompt(rdo), reprompt(rdoseq)) # TRUE

## clean up 
unlink("seq.Rd")         # remove temporary files
unlink("seq2.Rd")
unlink("seq3.Rd")
unlink("seqA.Rd")
unlink("seqB.Rd")

setwd(cur_wd)            # restore user's working directory
unlink(tmpdir)
</code></pre>

<hr>
<h2 id='RStudio_reprompt'>Call reprompt based on RStudio editor contents</h2><span id='topic+RStudio_reprompt'></span>

<h3>Description</h3>

<p>This function uses the RStudio API to call <code><a href="#topic+reprompt">reprompt</a></code> on either the current help file in the editor, or if a name
is highlighted in a &lsquo;<span class="file">.R</span>&rsquo; file, on that object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>RStudio_reprompt(verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

  
<table>
<tr><td><code id="RStudio_reprompt_+3A_verbose">verbose</code></td>
<td>

<p>If <code>TRUE</code> print progress to console.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function depends on being run in RStudio; it will generate
an error if run in other contexts.
</p>
<p>It depends on code being in a package that has already been
built, installed, and attached.  In RStudio, this means you
should run &ldquo;Install and Restart&rdquo; before running this
function.
</p>
<p>It is automatically installed into RStudio as an add-in called 
&ldquo;Reprompt&rdquo;.  Whether invoked directly or through the 
add-in, it looks at the file currently being edited in the 
code editor.  If it is an &lsquo;<span class="file">.Rd</span>&rsquo; file, it will run 
<code><a href="#topic+reprompt">reprompt</a></code> on that file.  
</p>
<p>If it is an <span class="rlang"><b>R</b></span> source file, it will look for a selected object
name.  It queries the help system to find if there is already
a help page for that name, and if so, works on that.  If not,
it will try to create one.
</p>


<h3>Value</h3>

<p><code>NULL</code>, invisibly.
</p>


<h3>Author(s)</h3>

<p>Duncan Murdoch
</p>


<h3>See Also</h3>

<p><code><a href="#topic+reprompt">reprompt</a></code>, <code><a href="utils.html#topic+prompt">prompt</a></code>
</p>

<hr>
<h2 id='S4formals'>Give the formal arguments of an S4 method</h2><span id='topic+S4formals'></span>

<h3>Description</h3>

<p>Give the formal arguments of an S4 method.</p>


<h3>Usage</h3>

<pre><code class='language-R'>S4formals(fun, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="S4formals_+3A_fun">fun</code></td>
<td>
<p>name of an S4 generic, a string, or the method, see Details.</p>
</td></tr>
<tr><td><code id="S4formals_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code>getMethod</code>, see
Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>S4formals</code> gives the formal arguments of the requested method.
If <code>fun</code> is not of class <code>methodDefinition</code>, it calls
<code>getMethods</code>, passing on all arguments.
</p>
<p>Typically, <code>fun</code> is the name of a generic function and the
second argument is the signature of the method as a character
vector. Alternatively, <code>fun</code> may be the method itself (e.g. obtained
previously from <code>getMethod</code>) and in that case the <code style="white-space: pre;">&#8288;"\dots"&#8288;</code>
arguments are ignored. See <code><a href="methods.html#topic+getMethod">getMethod</a></code> for full details
and other acceptable arguments.
</p>


<h3>Value</h3>

<p>a pairlist, like <code><a href="base.html#topic+formals">formals</a></code>
</p>


<h3>Note</h3>

<p>Arguments of a method after those used for dispatch may be different from
the arguments of the generic. The latter  may simply have a <code style="white-space: pre;">&#8288;"\dots"&#8288;</code>
argument there.
</p>
<p>todo: there should be a similar function in the &quot;methods&quot; package, or
at least use a documented feature to extract it.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats4) # makes plot() S4 generic

S4formals("plot", c(x = "profile.mle", y = "missing"))

m1 &lt;- getMethod("plot", c(x = "profile.mle", y = "missing"))
S4formals(m1)
</code></pre>

<hr>
<h2 id='set_Rdpack_bibstyle'>Set up a bibstyle defined in Rdpack</h2><span id='topic+set_Rdpack_bibstyle'></span>

<h3>Description</h3>

<p>Set up a bibstyle defined in Rdpack</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_Rdpack_bibstyle(bibstyle = "JSSRd")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_Rdpack_bibstyle_+3A_bibstyle">bibstyle</code></td>
<td>
<p>a character string</p>
</td></tr>
</table>

<hr>
<h2 id='update_aliases_tmp'>Update aliases for methods in Rd objects</h2><span id='topic+update_aliases_tmp'></span>

<h3>Description</h3>

<p>Update aliases for methods in Rd objects</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_aliases_tmp(rdo, package = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_aliases_tmp_+3A_rdo">rdo</code></td>
<td>
<p>an Rd object</p>
</td></tr>
<tr><td><code id="update_aliases_tmp_+3A_package">package</code></td>
<td>
<p>the name of a package, a character string.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a quick fix. todo: complete it!
</p>


<h3>Value</h3>

<p>the updated Rd object
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>

<hr>
<h2 id='viewRd'>View Rd files in a source package</h2><span id='topic+viewRd'></span>

<h3>Description</h3>

<p>View Rd files in a source package.</p>


<h3>Usage</h3>

<pre><code class='language-R'>viewRd(infile, type = getOption("help_type"), stages = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="viewRd_+3A_infile">infile</code></td>
<td>
<p>name of an Rd file, a character string.</p>
</td></tr>
<tr><td><code id="viewRd_+3A_type">type</code></td>
<td>
<p>one of <code>"text"</code> or <code>"html"</code></p>
</td></tr>
<tr><td><code id="viewRd_+3A_stages">stages</code></td>
<td>

<p>a character vector specifying which stages of the R installation
process to immitate. The default,
<code>c("build", "install", "render")</code>, should be fine in most cases.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be used to view Rd files from the source directory
of a package. The page is presented in text format or in html browser,
according to the setting of argument <code>type</code>. The default is
<code>getOption("help_type")</code>.
</p>


<h3>Value</h3>

<p>the function is used for the side effect of showing the help page in a
text help window or a web browser.
</p>


<h3>Note</h3>

<p>Developers with <code>"devtools"</code> can use <code>viewRd()</code> instead of
<code>help()</code> for documentation objects that contain Rd macros, such
as <code>insertRef</code>, see vignette:
</p>
<p><code>vignette("Inserting_bibtex_references", package = "Rdpack")</code>.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
