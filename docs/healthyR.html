<!DOCTYPE html><html><head><title>Help for package healthyR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {healthyR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#category_counts_tbl'><p>Counts by Category</p></a></li>
<li><a href='#color_blind'><p>Provide Colorblind Compliant Colors</p></a></li>
<li><a href='#diverging_bar_plt'><p>Diverging Bar Chart</p></a></li>
<li><a href='#diverging_lollipop_plt'><p>Diverging Lollipop Chart</p></a></li>
<li><a href='#dx_cc_mapping'><p>Diagnosis to Condition Code Mapping file</p></a></li>
<li><a href='#gartner_magic_chart_plt'><p>Gartner Magic Chart - Plotting of two continuous variables</p></a></li>
<li><a href='#hr_scale_color_colorblind'><p>Provide Colorblind Compliant Colors</p></a></li>
<li><a href='#hr_scale_fill_colorblind'><p>Provide Colorblind Compliant Colors</p></a></li>
<li><a href='#los_ra_index_plt'><p>Plot LOS and Readmit Index with Variance</p></a></li>
<li><a href='#los_ra_index_summary_tbl'><p>Make LOS and Readmit Index Summary Tibble</p></a></li>
<li><a href='#named_item_list'><p>Tibble to named list</p></a></li>
<li><a href='#opt_bin'><p>Get the optimal binwidth for a histogram</p></a></li>
<li><a href='#px_cc_mapping'><p>Procedure to Condition Code Mapping file</p></a></li>
<li><a href='#save_to_excel'><p>Save a file to Excel</p></a></li>
<li><a href='#service_line_augment'><p>Service Line Grouper Augment Function</p></a></li>
<li><a href='#service_line_vec'><p>Service Line Grouper Vectorized Function</p></a></li>
<li><a href='#sql_left'><p>Use SQL LEFT type function</p></a></li>
<li><a href='#sql_mid'><p>Use SQL MID type function</p></a></li>
<li><a href='#sql_right'><p>Use SQL RIGHT type functions</p></a></li>
<li><a href='#tidyeval'><p>Tidy eval helpers</p></a></li>
<li><a href='#top_n_tbl'><p>Top N tibble</p></a></li>
<li><a href='#ts_alos_plt'><p>Plot ALOS - Average Length of Stay</p></a></li>
<li><a href='#ts_census_los_daily_tbl'><p>Time Series - Census and LOS by Day</p></a></li>
<li><a href='#ts_median_excess_plt'><p>Create a plot showing the excess of the median value</p></a></li>
<li><a href='#ts_plt'><p>Time Series Plot</p></a></li>
<li><a href='#ts_readmit_rate_plt'><p>Plot Readmit Rate</p></a></li>
<li><a href='#ts_signature_tbl'><p>Make a Time Enhanced Tibble</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Hospital Data Analysis Workflow Tools</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Hospital data analysis workflow tools, modeling, and automations. This library
    provides many useful tools to review common administrative hospital data. Some 
    of these include average length of stay, readmission rates, average net pay
    amounts by service lines just to name a few. The aim is to provide a simple
    and consistent verb framework that takes the guesswork out of everything.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/spsanderson/healthyR">https://github.com/spsanderson/healthyR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/spsanderson/healthyR/issues">https://github.com/spsanderson/healthyR/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>magrittr, rlang (&ge; 0.1.2), tibble, timetk, ggplot2, dplyr,
lubridate, graphics, purrr, stringr, writexl, cowplot, scales,
sqldf, plotly</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, roxygen2, pacman, healthyR.data, broom,
tidyselect</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-31 12:48:37 UTC; steve</td>
</tr>
<tr>
<td>Author:</td>
<td>Steven Sanderson [aut, cre],
  Steven Sanderson [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Steven Sanderson &lt;spsanderson@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-06 22:20:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>

<hr>
<h2 id='category_counts_tbl'>Counts by Category</h2><span id='topic+category_counts_tbl'></span>

<h3>Description</h3>

<p>Get the counts of a column by a particular grouping if supplied, otherwise just
get counts of a column.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>category_counts_tbl(.data, .count_col, .arrange_value = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="category_counts_tbl_+3A_.data">.data</code></td>
<td>
<p>The data.frame/tibble supplied.</p>
</td></tr>
<tr><td><code id="category_counts_tbl_+3A_.count_col">.count_col</code></td>
<td>
<p>The column that has the values you want to count.</p>
</td></tr>
<tr><td><code id="category_counts_tbl_+3A_.arrange_value">.arrange_value</code></td>
<td>
<p>Defaults to true, this will arrange the resulting tibble
in descending order by .count_col</p>
</td></tr>
<tr><td><code id="category_counts_tbl_+3A_...">...</code></td>
<td>
<p>Place the values you want to pass in for grouping here.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Requires a data.frame/tibble.
</p>
</li>
<li><p> Requires a value column, a column that is going to counted.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Steven P. Sanderson II, MPH
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(healthyR.data)
library(dplyr)

healthyR_data %&gt;%
  category_counts_tbl(
    .count_col = payer_grouping
    , .arrange = TRUE
    , ip_op_flag
  )

healthyR_data %&gt;%
  category_counts_tbl(
    .count_col = ip_op_flag
    , .arrange_value = TRUE
    , service_line
  )

</code></pre>

<hr>
<h2 id='color_blind'>Provide Colorblind Compliant Colors</h2><span id='topic+color_blind'></span>

<h3>Description</h3>

<p>8 Hex RGB color definitions suitable for charts for colorblind people.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>color_blind()
</code></pre>


<h3>Details</h3>

<p>This function is used in others in order to help render plots for those that
are color blind.
</p>


<h3>Value</h3>

<p>A vector of 8 Hex RGB definitions.
</p>


<h3>Author(s)</h3>

<p>Steven P. Sanderson II, MPH
</p>


<h3>Examples</h3>

<pre><code class='language-R'>color_blind()

</code></pre>

<hr>
<h2 id='diverging_bar_plt'>Diverging Bar Chart</h2><span id='topic+diverging_bar_plt'></span>

<h3>Description</h3>

<p>Diverging Bars is a bar chart that can handle both negative and positive
values. This can be implemented by a smart tweak with <code>geom_bar()</code>. But the
usage of <code>geom_bar()</code> can be quite confusing. That's because, it can be used to
make a bar chart as well as a histogram. Let me explain.
</p>
<p>By default, <code>geom_bar()</code> has the stat set to count. That means, when you
provide just a continuous X variable (and no Y variable), it tries to make
a histogram out of the data.
</p>
<p>In order to make a bar chart create bars instead of histogram,
you need to do two things. Set <code>stat = identity</code> and provide both <code>x</code> and <code>y</code>
inside <code>aes()</code> where, <code>x</code> is either character or factor and <code>y</code> is numeric.
In order to make sure you get diverging bars instead of just bars, make sure,
your categorical variable has 2 categories that changes values at a certain
threshold of the continuous variable. In below example, the mpg from mtcars
data set is normalized by computing the z score. Those vehicles with mpg
above zero are marked green and those below are marked red.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diverging_bar_plt(
  .data,
  .x_axis,
  .y_axis,
  .fill_col,
  .plot_title = NULL,
  .plot_subtitle = NULL,
  .plot_caption = NULL,
  .interactive = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diverging_bar_plt_+3A_.data">.data</code></td>
<td>
<p>The data to pass to the function, must be a tibble/data.frame.</p>
</td></tr>
<tr><td><code id="diverging_bar_plt_+3A_.x_axis">.x_axis</code></td>
<td>
<p>The data that is passed to the x-axis.</p>
</td></tr>
<tr><td><code id="diverging_bar_plt_+3A_.y_axis">.y_axis</code></td>
<td>
<p>The data that is passed to the y-axis. This will also equal the
parameter <code>label</code></p>
</td></tr>
<tr><td><code id="diverging_bar_plt_+3A_.fill_col">.fill_col</code></td>
<td>
<p>The column that will be used to fill the color of the bars.</p>
</td></tr>
<tr><td><code id="diverging_bar_plt_+3A_.plot_title">.plot_title</code></td>
<td>
<p>Default is NULL</p>
</td></tr>
<tr><td><code id="diverging_bar_plt_+3A_.plot_subtitle">.plot_subtitle</code></td>
<td>
<p>Default is NULL</p>
</td></tr>
<tr><td><code id="diverging_bar_plt_+3A_.plot_caption">.plot_caption</code></td>
<td>
<p>Default is NULL</p>
</td></tr>
<tr><td><code id="diverging_bar_plt_+3A_.interactive">.interactive</code></td>
<td>
<p>Default is FALSE. TRUE returns a plotly plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes only a few arguments and returns a ggplot2 object.
</p>


<h3>Value</h3>

<p>A <code>plotly</code> plot or a <code>ggplot2</code> static plot
</p>


<h3>Author(s)</h3>

<p>Steven P. Sanderson II, MPH
</p>


<h3>Examples</h3>

<pre><code class='language-R'>suppressPackageStartupMessages(library(ggplot2))

data("mtcars")
mtcars$car_name &lt;- rownames(mtcars)
mtcars$mpg_z &lt;- round((mtcars$mpg - mean(mtcars$mpg))/sd(mtcars$mpg), 2)
mtcars$mpg_type &lt;- ifelse(mtcars$mpg_z &lt; 0, "below", "above")
mtcars &lt;- mtcars[order(mtcars$mpg_z), ]  # sort
mtcars$car_name &lt;- factor(mtcars$car_name, levels = mtcars$car_name)

diverging_bar_plt(
  .data          = mtcars
  , .x_axis      = car_name
  , .y_axis      = mpg_z
  , .fill_col    = mpg_type
  , .interactive = FALSE
)

</code></pre>

<hr>
<h2 id='diverging_lollipop_plt'>Diverging Lollipop Chart</h2><span id='topic+diverging_lollipop_plt'></span>

<h3>Description</h3>

<p>This is a diverging lollipop function. Lollipop chart conveys the same
information as bar chart and diverging bar. Except that it looks more modern.
Instead of geom_bar, I use geom_point and geom_segment to get the lollipops
right. Let’s draw a lollipop using the same data I prepared in the previous
example of diverging bars.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diverging_lollipop_plt(
  .data,
  .x_axis,
  .y_axis,
  .plot_title = NULL,
  .plot_subtitle = NULL,
  .plot_caption = NULL,
  .interactive = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diverging_lollipop_plt_+3A_.data">.data</code></td>
<td>
<p>The data to pass to the function, must be a tibble/data.frame.</p>
</td></tr>
<tr><td><code id="diverging_lollipop_plt_+3A_.x_axis">.x_axis</code></td>
<td>
<p>The data that is passed to the x-axis. This will also be the
<code>x</code> and <code>xend</code> parameters of the <code>geom_segment</code></p>
</td></tr>
<tr><td><code id="diverging_lollipop_plt_+3A_.y_axis">.y_axis</code></td>
<td>
<p>The data that is passed to the y-axis. This will also equal the
parameters of <code>yend</code> and <code>label</code></p>
</td></tr>
<tr><td><code id="diverging_lollipop_plt_+3A_.plot_title">.plot_title</code></td>
<td>
<p>Default is NULL</p>
</td></tr>
<tr><td><code id="diverging_lollipop_plt_+3A_.plot_subtitle">.plot_subtitle</code></td>
<td>
<p>Default is NULL</p>
</td></tr>
<tr><td><code id="diverging_lollipop_plt_+3A_.plot_caption">.plot_caption</code></td>
<td>
<p>Default is NULL</p>
</td></tr>
<tr><td><code id="diverging_lollipop_plt_+3A_.interactive">.interactive</code></td>
<td>
<p>Default is FALSE. TRUE returns a plotly plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes only a few arguments and returns a ggplot2 object.
</p>


<h3>Value</h3>

<p>A <code>plotly</code> plot or a <code>ggplot2</code> static plot
</p>


<h3>Author(s)</h3>

<p>Steven P. Sanderson II, MPH
</p>


<h3>Examples</h3>

<pre><code class='language-R'>suppressPackageStartupMessages(library(ggplot2))

data("mtcars")
mtcars$car_name &lt;- rownames(mtcars)
mtcars$mpg_z &lt;- round((mtcars$mpg - mean(mtcars$mpg))/sd(mtcars$mpg), 2)
mtcars$mpg_type &lt;- ifelse(mtcars$mpg_z &lt; 0, "below", "above")
mtcars &lt;- mtcars[order(mtcars$mpg_z), ]  # sort
mtcars$car_name &lt;- factor(mtcars$car_name, levels = mtcars$car_name)

diverging_lollipop_plt(.data = mtcars, .x_axis = car_name
, .y_axis = mpg_z)

</code></pre>

<hr>
<h2 id='dx_cc_mapping'>Diagnosis to Condition Code Mapping file</h2><span id='topic+dx_cc_mapping'></span>

<h3>Description</h3>

<p>A dataset containing the Diagnosis Code to AHRQ Condition Code Mapping
that is used in helping to define service lines for inpatient discharges.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dx_cc_mapping)
</code></pre>


<h3>Format</h3>

<p>A data frame with 86852 rows and 5 variables
</p>


<h3>Details</h3>


<ul>
<li><p> CC_Code. DX_1, DX_2, ..., DX_n
</p>
</li>
<li><p> CC_Desc. DX_1 = Conduction disorders, DX_n = description
</p>
</li>
<li><p> ICD_Ver_Flag. ICD Version 10 or 9
</p>
</li>
<li><p> ICDCode. ICD-9 ro ICD-10 Code
</p>
</li>
<li><p> Diagnosis. Long QT Syndrome
</p>
</li></ul>


<hr>
<h2 id='gartner_magic_chart_plt'>Gartner Magic Chart - Plotting of two continuous variables</h2><span id='topic+gartner_magic_chart_plt'></span>

<h3>Description</h3>

<p>Plot a Gartner Magic Chart of two continuous variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gartner_magic_chart_plt(
  .data,
  .x_col,
  .y_col,
  .point_size_col = NULL,
  .y_lab,
  .x_lab,
  .plt_title,
  .tl_lbl,
  .tr_lbl,
  .br_lbl,
  .bl_lbl
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gartner_magic_chart_plt_+3A_.data">.data</code></td>
<td>
<p>The data set you want to plot</p>
</td></tr>
<tr><td><code id="gartner_magic_chart_plt_+3A_.x_col">.x_col</code></td>
<td>
<p>The x-axis for the plot</p>
</td></tr>
<tr><td><code id="gartner_magic_chart_plt_+3A_.y_col">.y_col</code></td>
<td>
<p>The y-axis for the plot</p>
</td></tr>
<tr><td><code id="gartner_magic_chart_plt_+3A_.point_size_col">.point_size_col</code></td>
<td>
<p>The default is NULL, if you want to size the dots by
a column in the data.frame/tibble then enter the column name here.</p>
</td></tr>
<tr><td><code id="gartner_magic_chart_plt_+3A_.y_lab">.y_lab</code></td>
<td>
<p>The y-axis label</p>
</td></tr>
<tr><td><code id="gartner_magic_chart_plt_+3A_.x_lab">.x_lab</code></td>
<td>
<p>The x-axis label</p>
</td></tr>
<tr><td><code id="gartner_magic_chart_plt_+3A_.plt_title">.plt_title</code></td>
<td>
<p>The title of the plot</p>
</td></tr>
<tr><td><code id="gartner_magic_chart_plt_+3A_.tl_lbl">.tl_lbl</code></td>
<td>
<p>The top left label</p>
</td></tr>
<tr><td><code id="gartner_magic_chart_plt_+3A_.tr_lbl">.tr_lbl</code></td>
<td>
<p>The top right label</p>
</td></tr>
<tr><td><code id="gartner_magic_chart_plt_+3A_.br_lbl">.br_lbl</code></td>
<td>
<p>The bottom right label</p>
</td></tr>
<tr><td><code id="gartner_magic_chart_plt_+3A_.bl_lbl">.bl_lbl</code></td>
<td>
<p>The bottom left label</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Supply a data frame with at least two continuous variables to plot against
each other
</p>
</li></ul>



<h3>Value</h3>

<p>A <code>ggplot</code> plot
</p>


<h3>Author(s)</h3>

<p>Steven P. Sanderson II, MPH
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

data_tbl &lt;- tibble(
    x = rnorm(100, 0, 1),
    y = rnorm(100, 0, 1),
    z = abs(x) + abs(y)
 )

gartner_magic_chart_plt(
  .data = data_tbl,
  .x_col = x,
  .y_col = y,
  .point_size = z,
  .x_lab = "los",
  .y_lab = "ra",
  .plt_title = "tst",
  .tr_lbl = "High RA-LOS",
  .tl_lbl = "High RA",
  .bl_lbl = "Leader",
  .br_lbl = "High LOS"
)

gartner_magic_chart_plt(
  .data = data_tbl,
  .x_col = x,
  .y_col = y,
  .point_size = NULL,
  .x_lab = "los",
  .y_lab = "ra",
  .plt_title = "tst",
  .tr_lbl = "High RA-LOS",
  .tl_lbl = "High RA",
  .bl_lbl = "Leader",
  .br_lbl = "High LOS"
)

</code></pre>

<hr>
<h2 id='hr_scale_color_colorblind'>Provide Colorblind Compliant Colors</h2><span id='topic+hr_scale_color_colorblind'></span>

<h3>Description</h3>

<p>8 Hex RGB color definitions suitable for charts for colorblind people.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hr_scale_color_colorblind(..., theme = "hr")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hr_scale_color_colorblind_+3A_...">...</code></td>
<td>
<p>Data passed in from a <code>ggplot</code> object</p>
</td></tr>
<tr><td><code id="hr_scale_color_colorblind_+3A_theme">theme</code></td>
<td>
<p>Right now this is <code>hr</code> only. Anything else will render an error.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used in others in order to help render plots for those that
are color blind.
</p>


<h3>Value</h3>

<p>A <code>gggplot</code> layer
</p>


<h3>Author(s)</h3>

<p>Steven P. Sanderson II, MPH
</p>

<hr>
<h2 id='hr_scale_fill_colorblind'>Provide Colorblind Compliant Colors</h2><span id='topic+hr_scale_fill_colorblind'></span>

<h3>Description</h3>

<p>8 Hex RGB color definitions suitable for charts for colorblind people.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hr_scale_fill_colorblind(..., theme = "hr")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hr_scale_fill_colorblind_+3A_...">...</code></td>
<td>
<p>Data passed in from a <code>ggplot</code> object</p>
</td></tr>
<tr><td><code id="hr_scale_fill_colorblind_+3A_theme">theme</code></td>
<td>
<p>Right now this is <code>hr</code> only. Anything else will render an error.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used in others in order to help render plots for those that
are color blind.
</p>


<h3>Value</h3>

<p>A <code>gggplot</code> layer
</p>


<h3>Author(s)</h3>

<p>Steven P. Sanderson II, MPH
</p>

<hr>
<h2 id='los_ra_index_plt'>Plot LOS and Readmit Index with Variance</h2><span id='topic+los_ra_index_plt'></span>

<h3>Description</h3>

<p>Plot the index of the length of stay and readmit rate against each other along
with the variance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>los_ra_index_plt(.data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="los_ra_index_plt_+3A_.data">.data</code></td>
<td>
<p>The data supplied from <code><a href="#topic+los_ra_index_summary_tbl">los_ra_index_summary_tbl()</a></code></p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Expects a tibble
</p>
</li>
<li><p> Expects a Length of Stay and Readmit column, must be numeric
</p>
</li>
<li><p> Uses <code>cowplot</code> to stack plots
</p>
</li></ul>



<h3>Value</h3>

<p>A <code>patchwork</code> <code>ggplot2</code> plot
</p>


<h3>Author(s)</h3>

<p>Steven P. Sanderson II, MPH
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
suppressPackageStartupMessages(library(dplyr))

data_tbl &lt;- tibble(
  "alos"                 = runif(186, 1, 20)
  , "elos"               = runif(186, 1, 17)
  , "readmit_rate"       = runif(186, 0, .25)
  , "readmit_rate_bench" = runif(186, 0, .2)
)

los_ra_index_summary_tbl(
  .data = data_tbl
  , .max_los       = 15
  , .alos_col      = alos
  , .elos_col      = elos
  , .readmit_rate  = readmit_rate
  , .readmit_bench = readmit_rate_bench
) %&gt;%
  los_ra_index_plt()

los_ra_index_summary_tbl(
  .data = data_tbl
  , .max_los       = 10
  , .alos_col      = alos
  , .elos_col      = elos
  , .readmit_rate  = readmit_rate
  , .readmit_bench = readmit_rate_bench
) %&gt;%
  los_ra_index_plt()

</code></pre>

<hr>
<h2 id='los_ra_index_summary_tbl'>Make LOS and Readmit Index Summary Tibble</h2><span id='topic+los_ra_index_summary_tbl'></span>

<h3>Description</h3>

<p>Create the length of stay and readmit index summary tibble
</p>


<h3>Usage</h3>

<pre><code class='language-R'>los_ra_index_summary_tbl(
  .data,
  .max_los = 15,
  .alos_col,
  .elos_col,
  .readmit_rate,
  .readmit_bench
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="los_ra_index_summary_tbl_+3A_.data">.data</code></td>
<td>
<p>The data you are going to analyze.</p>
</td></tr>
<tr><td><code id="los_ra_index_summary_tbl_+3A_.max_los">.max_los</code></td>
<td>
<p>You can give a maximum LOS value. Lets say you typically do
not see los over 15 days, you would then set .max_los to 15 and all values greater
than .max_los will be grouped to .max_los</p>
</td></tr>
<tr><td><code id="los_ra_index_summary_tbl_+3A_.alos_col">.alos_col</code></td>
<td>
<p>The Average Length of Stay column</p>
</td></tr>
<tr><td><code id="los_ra_index_summary_tbl_+3A_.elos_col">.elos_col</code></td>
<td>
<p>The Expected Length of Stay column</p>
</td></tr>
<tr><td><code id="los_ra_index_summary_tbl_+3A_.readmit_rate">.readmit_rate</code></td>
<td>
<p>The Actual Readmit Rate column</p>
</td></tr>
<tr><td><code id="los_ra_index_summary_tbl_+3A_.readmit_bench">.readmit_bench</code></td>
<td>
<p>The Expected Readmit Rate column</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Expects a tibble
</p>
</li>
<li><p> Expects the following columns and there should only be these 4
</p>

<ul>
<li><p> Length Of Stay Actual - Should be an integer
</p>
</li>
<li><p> Length Of Stacy Benchmark - Should be an integer
</p>
</li>
<li><p> Readmit Rate Actual - Should be 0/1 for each record, 1 = readmitted, 0 did not.
</p>
</li>
<li><p> Readmit Rate Benchmark - Should be a percentage from the benchmark file.
</p>
</li></ul>

</li>
<li><p> This will add a column called visits that will be the count of records per
length of stay from 1 to .max_los
</p>
</li>
<li><p> The .max_los param can be left blank and the function will default to 15. If
this is not a good default and you don't know what it should be then set it to
75 percentile from the <code><a href="stats.html#topic+quantile">stats::quantile()</a></code> function using the defaults, like so
.max_los = <code>stats::quantile(data_tbl$alos)[[4]]</code>
</p>
</li>
<li><p> Uses all data to compute variance, if you want it for a particular time frame
you will have to filter the data that goes into the .data argument. It is
suggested to use <code><a href="timetk.html#topic+filter_by_time">timetk::filter_by_time()</a></code>
</p>
</li>
<li><p> The index is computed as the excess of the length of stay or readmit rates
over their respective expectations.
</p>
</li></ul>



<h3>Value</h3>

<p>A tibble
</p>


<h3>Author(s)</h3>

<p>Steven P. Sanderson II, MPH
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
suppressPackageStartupMessages(library(dplyr))

data_tbl &lt;- tibble(
  "alos"            = runif(186, 1, 20)
  , "elos"          = runif(186, 1, 17)
  , "readmit_rate"  = runif(186, 0, .25)
  , "readmit_bench" = runif(186, 0, .2)
)

los_ra_index_summary_tbl(
  .data = data_tbl
  , .max_los       = 15
  , .alos_col      = alos
  , .elos_col      = elos
  , .readmit_rate  = readmit_rate
  , .readmit_bench = readmit_bench
)

los_ra_index_summary_tbl(
  .data = data_tbl
  , .max_los       = 10
  , .alos_col      = alos
  , .elos_col      = elos
  , .readmit_rate  = readmit_rate
  , .readmit_bench = readmit_bench
)

</code></pre>

<hr>
<h2 id='named_item_list'>Tibble to named list</h2><span id='topic+named_item_list'></span>

<h3>Description</h3>

<p>Takes in a data.frame/tibble and creates a named list from a supplied grouping
variable. Can be used in conjunction with <code><a href="#topic+save_to_excel">save_to_excel()</a></code> to create a new
sheet for each group of data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>named_item_list(.data, .group_col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="named_item_list_+3A_.data">.data</code></td>
<td>
<p>The data.frame/tibble.</p>
</td></tr>
<tr><td><code id="named_item_list_+3A_.group_col">.group_col</code></td>
<td>
<p>The column that contains the groupings.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Requires a data.frame/tibble and a grouping column.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Steven P. Sanderson II, MPH
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(healthyR.data)

df &lt;- healthyR_data
df_list &lt;- named_item_list(.data = df, .group_col = service_line)
df_list

</code></pre>

<hr>
<h2 id='opt_bin'>Get the optimal binwidth for a histogram</h2><span id='topic+opt_bin'></span>

<h3>Description</h3>

<p>Gives the optimal binwidth for a histogram given a data set, it's value and
the desired amount of bins
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opt_bin(.data, .value_col, .iters = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="opt_bin_+3A_.data">.data</code></td>
<td>
<p>The data set in question</p>
</td></tr>
<tr><td><code id="opt_bin_+3A_.value_col">.value_col</code></td>
<td>
<p>The column that holds the values</p>
</td></tr>
<tr><td><code id="opt_bin_+3A_.iters">.iters</code></td>
<td>
<p>How many times the cost function loop should run</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Modified from Hideaki Shimazaki
Department of Physics, Kyoto University
shimazaki at ton.scphys.kyoto-u.ac.jp
Feel free to modify/distribute this program.
</p>

<ul>
<li><p> Supply a data.frame/tibble with a value column. from this an optimal binwidth
will be computed for the amount of binds desired
</p>
</li></ul>



<h3>Value</h3>

<p>A tibble of histogram breakpoints
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
suppressPackageStartupMessages(library(purrr))
suppressPackageStartupMessages(library(dplyr))

df_tbl &lt;- rnorm(n = 1000, mean = 0, sd = 1)
df_tbl &lt;- df_tbl %&gt;%
  as_tibble() %&gt;%
  set_names("value")

df_tbl %&gt;%
  opt_bin(
    .value_col = value
    , .iters = 100
  )

</code></pre>

<hr>
<h2 id='px_cc_mapping'>Procedure to Condition Code Mapping file</h2><span id='topic+px_cc_mapping'></span>

<h3>Description</h3>

<p>A dataset containing the Procedure Code to AHRQ Condition Code Mapping
that is used in helping to define servce lines for inpatient discharges.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(px_cc_mapping)
</code></pre>


<h3>Format</h3>

<p>A data frame with 79721 rows and 5 variables
</p>


<h3>Details</h3>


<ul>
<li><p> CC_Code. PX_1, PX_2, ..., PX_n
</p>
</li>
<li><p> CC_Desc. PX_1 = Genitourinary incontinence procedures
</p>
</li>
<li><p> ICD_Ver_Flag. 10 or 9
</p>
</li>
<li><p> ICDCode. ICD-9 or ICD-10 Code
</p>
</li>
<li><p> Procedure. Inject Implant Urethra
</p>
</li></ul>


<hr>
<h2 id='save_to_excel'>Save a file to Excel</h2><span id='topic+save_to_excel'></span>

<h3>Description</h3>

<p>Save a tibble/data.frame to an excel <code>.xlsx</code> file. The file will automatically
with a save_dtime in the format of 20201109_132416 for November 11th, 2020
at 1:24:16PM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_to_excel(.data, .file_name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="save_to_excel_+3A_.data">.data</code></td>
<td>
<p>The tibble/data.frame that you want to save as an <code>.xlsx</code> file.</p>
</td></tr>
<tr><td><code id="save_to_excel_+3A_.file_name">.file_name</code></td>
<td>
<p>the name you want to give to the file.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Requires a tibble/data.frame to be passed to it.
</p>
</li></ul>



<h3>Value</h3>

<p>A saved excel file
</p>


<h3>Author(s)</h3>

<p>Steven P. Sanderson II, MPH
</p>

<hr>
<h2 id='service_line_augment'>Service Line Grouper Augment Function</h2><span id='topic+service_line_augment'></span>

<h3>Description</h3>

<p>Takes a few arguments from a data.frame/tibble and returns a service line
augmented to a data.frame/tibble for a set of patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>service_line_augment(.data, .dx_col, .px_col, .drg_col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="service_line_augment_+3A_.data">.data</code></td>
<td>
<p>The data being passed that will be augmented by the function.</p>
</td></tr>
<tr><td><code id="service_line_augment_+3A_.dx_col">.dx_col</code></td>
<td>
<p>The column containing the Principal Diagnosis for the discharge.</p>
</td></tr>
<tr><td><code id="service_line_augment_+3A_.px_col">.px_col</code></td>
<td>
<p>The column containing the Principal Coded Procedure for the discharge.
It is possible that this could be blank.</p>
</td></tr>
<tr><td><code id="service_line_augment_+3A_.drg_col">.drg_col</code></td>
<td>
<p>The DRG Number coded to the inpatient discharge.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an augment function in that appends a vector to an data.frame/tibble
that is passed to the <code>.data</code> parameter. A data.frame/tibble
is required, along with a principal diagnosis column, a principal procedure column,
and a column for the DRG number. These are needed so that the function can
join the dx_cc_mapping and px_cc_mapping columns to provide the service line.
This function only works on visits that are coded using ICD Version 10 only.
</p>
<p>Lets take an example discharge, the DRG is 896 and the Principal Diagnosis code
maps to DX_660, then this visit would get grouped to <code>alcohol_abuse</code>
</p>
<p>DRG 896: ALCOHOL, DRUG ABUSE OR DEPENDENCE WITHOUT REHABILITATION THERAPY WITH
MAJOR COMPLICATION OR COMORBIDITY (MCC)
</p>
<p>DX_660 Maps to the following ICD-10 Codes ie F1010 Alcohol abuse, uncomplicated:
</p>
<div class="sourceCode"><pre>library(healthyR)
dx_cc_mapping %&gt;%
  filter(CC_Code == "DX_660", ICD_Ver_Flag == "10")
</pre></div>


<h3>Value</h3>

<p>An augmented data.frame/tibble with the service line appended as a new column.
</p>


<h3>Author(s)</h3>

<p>Steven P. Sanderson II, MPH
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(
  dx_col = "F10.10",
  px_col = NA,
  drg_col = "896"
)

service_line_augment(
  .data = df,
  .dx_col = dx_col,
  .px_col = px_col,
  .drg_col = drg_col
)

</code></pre>

<hr>
<h2 id='service_line_vec'>Service Line Grouper Vectorized Function</h2><span id='topic+service_line_vec'></span>

<h3>Description</h3>

<p>Takes a few arguments from a data.frame/tibble and returns a service line
vector for a set of patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>service_line_vec(.data, .dx_col, .px_col, .drg_col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="service_line_vec_+3A_.data">.data</code></td>
<td>
<p>The data being passed that will be augmented by the function.</p>
</td></tr>
<tr><td><code id="service_line_vec_+3A_.dx_col">.dx_col</code></td>
<td>
<p>The column containing the Principal Diagnosis for the discharge.</p>
</td></tr>
<tr><td><code id="service_line_vec_+3A_.px_col">.px_col</code></td>
<td>
<p>The column containing the Principal Coded Procedure for the discharge.
It is possible that this could be blank.</p>
</td></tr>
<tr><td><code id="service_line_vec_+3A_.drg_col">.drg_col</code></td>
<td>
<p>The DRG Number coded to the inpatient discharge.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a vectorized function in that it returns a vector. It can be applied
inside of a <code>mutate</code> statement when using <code>dplyr</code> if desired. A data.frame/tibble
is required, along with a principal diagnosis column, a principal procedure column,
and a column for the DRG number. These are needed so that the function can
join the dx_cc_mapping and px_cc_mapping columns to provide the service line.
This function only works on visits that are coded using ICD Version 10 only.
</p>
<p>Lets take an example discharge, the DRG is 896 and the Principal Diagnosis code
maps to DX_660, then this visit would get grouped to <code>alcohol_abuse</code>
</p>
<p>DRG 896: ALCOHOL, DRUG ABUSE OR DEPENDENCE WITHOUT REHABILITATION THERAPY WITH
MAJOR COMPLICATION OR COMORBIDITY (MCC)
</p>
<p>DX_660 Maps to the following ICD-10 Codes ie F1010 Alcohol abuse, uncomplicated:
</p>
<div class="sourceCode"><pre>library(healthyR)
dx_cc_mapping %&gt;%
  filter(CC_Code == "DX_660", ICD_Ver_Flag == "10")
</pre></div>


<h3>Value</h3>

<p>A vector of service line assignments.
</p>


<h3>Author(s)</h3>

<p>Steven P. Sanderson II, MPH
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(
  dx_col = "F10.10",
  px_col = NA,
  drg_col = "896"
)

service_line_vec(
  .data = df,
  .dx_col = dx_col,
  .px_col = px_col,
  .drg_col = drg_col
)

</code></pre>

<hr>
<h2 id='sql_left'>Use SQL LEFT type function</h2><span id='topic+sql_left'></span>

<h3>Description</h3>

<p>Perform an SQL LEFT() type function on a piece of text
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sql_left(.text, .num_char)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sql_left_+3A_.text">.text</code></td>
<td>
<p>A piece of text/string to be manipulated</p>
</td></tr>
<tr><td><code id="sql_left_+3A_.num_char">.num_char</code></td>
<td>
<p>How many characters do you want to grab</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> You must supply data that you want to manipulate.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
sql_left("text", 3)

</code></pre>

<hr>
<h2 id='sql_mid'>Use SQL MID type function</h2><span id='topic+sql_mid'></span>

<h3>Description</h3>

<p>Perform an SQL SUBSTRING type function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sql_mid(.text, .start_num, .num_char)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sql_mid_+3A_.text">.text</code></td>
<td>
<p>A piece of text/string to be manipulated</p>
</td></tr>
<tr><td><code id="sql_mid_+3A_.start_num">.start_num</code></td>
<td>
<p>What place to start at</p>
</td></tr>
<tr><td><code id="sql_mid_+3A_.num_char">.num_char</code></td>
<td>
<p>How many characters do you want to grab</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> You must supply data that you want to manipulate.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
sql_mid("this is some text", 6, 2)

</code></pre>

<hr>
<h2 id='sql_right'>Use SQL RIGHT type functions</h2><span id='topic+sql_right'></span>

<h3>Description</h3>

<p>Perform an SQL RIGHT type function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sql_right(.text, .num_char)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sql_right_+3A_.text">.text</code></td>
<td>
<p>A piece of text/string to be manipulated</p>
</td></tr>
<tr><td><code id="sql_right_+3A_.num_char">.num_char</code></td>
<td>
<p>How many characters do you want to grab</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> You must supply data that you want to manipulate.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
sql_right("this is some more text", 3)

</code></pre>

<hr>
<h2 id='tidyeval'>Tidy eval helpers</h2><span id='topic+tidyeval'></span><span id='topic+expr'></span><span id='topic+enquo'></span><span id='topic+enquos'></span><span id='topic+sym'></span><span id='topic+syms'></span><span id='topic+.data'></span><span id='topic++3A+3D'></span><span id='topic+as_name'></span><span id='topic+as_label'></span>

<h3>Description</h3>


<ul>
<li> <p><code><a href="rlang.html#topic+sym">sym</a>()</code> creates a symbol from a string and
<code><a href="rlang.html#topic+sym">syms</a>()</code> creates a list of symbols from a
character vector.
</p>
</li>
<li> <p><code><a href="rlang.html#topic+nse-defuse">enquo</a>()</code> and
<code><a href="rlang.html#topic+nse-defuse">enquos</a>()</code> delay the execution of one or
several function arguments. <code>enquo()</code> returns a single quoted
expression, which is like a blueprint for the delayed computation.
<code>enquos()</code> returns a list of such quoted expressions.
</p>
</li>
<li> <p><code><a href="rlang.html#topic+nse-defuse">expr</a>()</code> quotes a new expression <em>locally</em>. It
is mostly useful to build new expressions around arguments
captured with <code><a href="#topic+enquo">enquo()</a></code> or <code><a href="#topic+enquos">enquos()</a></code>:
<code>expr(mean(!!enquo(arg), na.rm = TRUE))</code>.
</p>
</li>
<li> <p><code><a href="rlang.html#topic+as_name">as_name</a>()</code> transforms a quoted variable name
into a string. Supplying something else than a quoted variable
name is an error.
</p>
<p>That's unlike <code><a href="rlang.html#topic+as_label">as_label</a>()</code> which also returns
a single string but supports any kind of R object as input,
including quoted function calls and vectors. Its purpose is to
summarise that object into a single label. That label is often
suitable as a default name.
</p>
<p>If you don't know what a quoted expression contains (for instance
expressions captured with <code>enquo()</code> could be a variable
name, a call to a function, or an unquoted constant), then use
<code>as_label()</code>. If you know you have quoted a simple variable
name, or would like to enforce this, use <code>as_name()</code>.
</p>
</li></ul>

<p>To learn more about tidy eval and how to use these tools, visit
<a href="https://adv-r.hadley.nz/metaprogramming.html">Metaprogramming
section</a> of <a href="https://adv-r.hadley.nz">Advanced R</a>.
</p>

<hr>
<h2 id='top_n_tbl'>Top N tibble</h2><span id='topic+top_n_tbl'></span>

<h3>Description</h3>

<p>Get a tibble returned with n records sorted either by descending order (default) or
ascending order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>top_n_tbl(.data, .n_records, .arrange_value = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="top_n_tbl_+3A_.data">.data</code></td>
<td>
<p>The data you want to pass to the function</p>
</td></tr>
<tr><td><code id="top_n_tbl_+3A_.n_records">.n_records</code></td>
<td>
<p>How many records you want returned</p>
</td></tr>
<tr><td><code id="top_n_tbl_+3A_.arrange_value">.arrange_value</code></td>
<td>
<p>A boolean with TRUE as the default. TRUE sorts data in
descending order</p>
</td></tr>
<tr><td><code id="top_n_tbl_+3A_...">...</code></td>
<td>
<p>The columns you want to pass to the function.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Requires a data.frame/tibble
</p>
</li>
<li><p> Requires at least one column to be chosen inside of the ...
</p>
</li>
<li><p> Will return the tibble in sorted order that is chosen with descending as
the default
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Steven P. Sanderson II, MPH
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(healthyR.data)

df &lt;- healthyR_data

df_tbl &lt;- top_n_tbl(
  .data = df
  , .n_records = 3
  , .arrange_value = TRUE
  , service_line
  , payer_grouping
)

print(df_tbl)

</code></pre>

<hr>
<h2 id='ts_alos_plt'>Plot ALOS - Average Length of Stay</h2><span id='topic+ts_alos_plt'></span>

<h3>Description</h3>

<p>Plot ALOS - Average Length of Stay
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ts_alos_plt(.data, .date_col, .value_col, .by_grouping, .interactive)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ts_alos_plt_+3A_.data">.data</code></td>
<td>
<p>The time series data you need to pass</p>
</td></tr>
<tr><td><code id="ts_alos_plt_+3A_.date_col">.date_col</code></td>
<td>
<p>The date column</p>
</td></tr>
<tr><td><code id="ts_alos_plt_+3A_.value_col">.value_col</code></td>
<td>
<p>The value column</p>
</td></tr>
<tr><td><code id="ts_alos_plt_+3A_.by_grouping">.by_grouping</code></td>
<td>
<p>How you want the data summarized - &quot;sec&quot;, &quot;min&quot;, &quot;hour&quot;,
&quot;day&quot;, &quot;week&quot;, &quot;month&quot;, &quot;quarter&quot; or &quot;year&quot;</p>
</td></tr>
<tr><td><code id="ts_alos_plt_+3A_.interactive">.interactive</code></td>
<td>
<p>TRUE or FALSE. TRUE returns a <code>plotly</code> plot and FALSE
returns a static <code>ggplot2</code> plot</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Expects a tibble with a date time column and a value column
</p>
</li>
<li><p> Uses <code>timetk</code> for underlying sumarization and plot
</p>
</li>
<li><p> If .by_grouping is missing it will default to &quot;day&quot;
</p>
</li>
<li><p> A static ggplot2 object is return if the .interactive function is FALSE
otherwise a <code>plotly</code> plot is returned.
</p>
</li></ul>



<h3>Value</h3>

<p>A timetk time series plot
</p>


<h3>Author(s)</h3>

<p>Steven P. Sanderson II, MPH
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(healthyR)
library(healthyR.data)
library(timetk)
library(dplyr)
library(purrr)

# Make A Series of Dates ----
data_tbl &lt;- healthyR_data

df_tbl &lt;- data_tbl %&gt;%
    filter(ip_op_flag == "I") %&gt;%
    select(visit_end_date_time, length_of_stay) %&gt;%
    summarise_by_time(
        .date_var = visit_end_date_time
        , .by     = "day"
        , visits  = mean(length_of_stay, na.rm = TRUE)
    ) %&gt;%
    filter_by_time(
        .date_var     = visit_end_date_time
        , .start_date = "2012"
        , .end_date   = "2019"
    ) %&gt;%
    set_names("Date","Values")

ts_alos_plt(
  .data = df_tbl
  , .date_col = Date
  , .value_col = Values
  , .by = "month"
  , .interactive = FALSE
)

</code></pre>

<hr>
<h2 id='ts_census_los_daily_tbl'>Time Series - Census and LOS by Day</h2><span id='topic+ts_census_los_daily_tbl'></span>

<h3>Description</h3>

<p>Sometimes it is important to know what the census was on any given day, or what
the average length of stay is on given day, including for those patients that
are not yet discharged. This can be easily achieved. This will return one
record for every account so the data will still need to be summarized. If there
are multiple entries per day then those records will show up and you will
therefore have multiple entries in the column <code>date</code> in the resulting <code>tibble</code>.
If you want to aggregate from there you should be able to do so easily.
</p>
<p>If you have a record where the <code>.start_date_col</code> is filled in but the corresponding
<code>end_date</code> is null then the end date will be set equal to <code>Sys.Date()</code>
</p>
<p>If a record has a <code>start_date</code> that is <code>NA</code> then it will be discarded.
</p>
<p><strong>This function can take a little bit of time to run while the join comparison runs.</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ts_census_los_daily_tbl(
  .data,
  .keep_nulls_only = FALSE,
  .start_date_col,
  .end_date_col,
  .by_time = "day"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ts_census_los_daily_tbl_+3A_.data">.data</code></td>
<td>
<p>The data you want to pass to the function</p>
</td></tr>
<tr><td><code id="ts_census_los_daily_tbl_+3A_.keep_nulls_only">.keep_nulls_only</code></td>
<td>
<p>A boolean that will keep only those records that have
a NULL end date, meaning the patient is still admitted. The default is FALSE which
brings back all records.</p>
</td></tr>
<tr><td><code id="ts_census_los_daily_tbl_+3A_.start_date_col">.start_date_col</code></td>
<td>
<p>The column containing the start date for the record</p>
</td></tr>
<tr><td><code id="ts_census_los_daily_tbl_+3A_.end_date_col">.end_date_col</code></td>
<td>
<p>The column containing the end date for the record.</p>
</td></tr>
<tr><td><code id="ts_census_los_daily_tbl_+3A_.by_time">.by_time</code></td>
<td>
<p>How you want the data presented, defaults to day and should remain
that way unless you need more granular data.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Requires a dataset that has at least a start date column and an end date
column
</p>
</li>
<li><p> Takes a single boolean parameter
</p>
</li></ul>



<h3>Value</h3>

<p>A tibble object
</p>


<h3>Author(s)</h3>

<p>Steven P. Sanderson II, MPH
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(healthyR)
library(healthyR.data)
library(dplyr)

df &lt;- healthyR_data

df_tbl &lt;- df %&gt;%
  filter(ip_op_flag == "I") %&gt;%
  select(visit_start_date_time, visit_end_date_time) %&gt;%
  timetk::filter_by_time(.date_var = visit_start_date_time, .start_date = "2020")

ts_census_los_daily_tbl(
   .data              = df_tbl
   , .keep_nulls_only = FALSE
   , .start_date_col  = visit_start_date_time
   , .end_date_col    = visit_end_date_time
)

</code></pre>

<hr>
<h2 id='ts_median_excess_plt'>Create a plot showing the excess of the median value</h2><span id='topic+ts_median_excess_plt'></span>

<h3>Description</h3>

<p>Plot out the excess +/- of the median value grouped by certain time parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ts_median_excess_plt(
  .data,
  .date_col,
  .value_col,
  .x_axis,
  .ggplot_group_var,
  .years_back
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ts_median_excess_plt_+3A_.data">.data</code></td>
<td>
<p>The data that is being analyzed, data must be a tibble/data.frame.</p>
</td></tr>
<tr><td><code id="ts_median_excess_plt_+3A_.date_col">.date_col</code></td>
<td>
<p>The column of the tibble that holds the date.</p>
</td></tr>
<tr><td><code id="ts_median_excess_plt_+3A_.value_col">.value_col</code></td>
<td>
<p>The column that holds the value of interest.</p>
</td></tr>
<tr><td><code id="ts_median_excess_plt_+3A_.x_axis">.x_axis</code></td>
<td>
<p>What is the be the x-axis, day, week, etc.</p>
</td></tr>
<tr><td><code id="ts_median_excess_plt_+3A_.ggplot_group_var">.ggplot_group_var</code></td>
<td>
<p>The variable to group the ggplot on.</p>
</td></tr>
<tr><td><code id="ts_median_excess_plt_+3A_.years_back">.years_back</code></td>
<td>
<p>How many yeas back do you want to go in order to compute
the median value.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Supply data that you want to view and you will see the excess +/- of the median values
over a specified time series tibble.
</p>
</li></ul>



<h3>Value</h3>

<p>A <code>ggplot2</code> plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
suppressPackageStartupMessages(library(timetk))

ts_signature_tbl(
  .data       = m4_daily
  , .date_col = date
) %&gt;%
ts_median_excess_plt(
  .date_col           = date
  , .value_col        = value
  , .x_axis           = month
  , .ggplot_group_var = year
  , .years_back       = 1
)

</code></pre>

<hr>
<h2 id='ts_plt'>Time Series Plot</h2><span id='topic+ts_plt'></span>

<h3>Description</h3>

<p>This is a warpper function to the <code><a href="timetk.html#topic+plot_time_series">timetk::plot_time_series()</a></code> function with
a limited functionality parameter set. To see the full reference please visit
the <code>timetk</code> package site.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ts_plt(
  .data,
  .date_col,
  .value_col,
  .color_col = NULL,
  .facet_col = NULL,
  .facet_ncol = NULL,
  .interactive = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ts_plt_+3A_.data">.data</code></td>
<td>
<p>The data to pass to the function, must be a tibble/data.frame.</p>
</td></tr>
<tr><td><code id="ts_plt_+3A_.date_col">.date_col</code></td>
<td>
<p>The column holding the date.</p>
</td></tr>
<tr><td><code id="ts_plt_+3A_.value_col">.value_col</code></td>
<td>
<p>The column holding the value.</p>
</td></tr>
<tr><td><code id="ts_plt_+3A_.color_col">.color_col</code></td>
<td>
<p>The column holding the variable for color.</p>
</td></tr>
<tr><td><code id="ts_plt_+3A_.facet_col">.facet_col</code></td>
<td>
<p>The column holding the variable for faceting.</p>
</td></tr>
<tr><td><code id="ts_plt_+3A_.facet_ncol">.facet_ncol</code></td>
<td>
<p>How many columns do you want.</p>
</td></tr>
<tr><td><code id="ts_plt_+3A_.interactive">.interactive</code></td>
<td>
<p>Return a <code>plotly</code> plot if set to TRUE and a static <code>ggplot2</code>
plot if set to FALSE. The default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes only a few of the arguments in the function and
presets others while choosing the defaults on others. The smoother functionality
is turned off.
</p>


<h3>Value</h3>

<p>A <code>plotly</code> plot or a <code>ggplot2</code> static plot
</p>


<h3>Author(s)</h3>

<p>Steven P. Sanderson II, MPH
</p>


<h3>See Also</h3>

<p><a href="https://business-science.github.io/timetk/reference/plot_time_series.html">https://business-science.github.io/timetk/reference/plot_time_series.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>suppressPackageStartupMessages(library(dplyr))
library(timetk)
library(healthyR.data)

healthyR.data::healthyR_data %&gt;%
  filter(ip_op_flag == "I") %&gt;%
  select(visit_end_date_time, service_line) %&gt;%
  filter_by_time(
    .date_var = visit_end_date_time
    , .start_date = "2020"
    ) %&gt;%
  group_by(service_line) %&gt;%
  summarize_by_time(
    .date_var = visit_end_date_time
    , .by = "month"
    , visits = n()
  ) %&gt;%
 ungroup() %&gt;%
 ts_plt(
   .date_col = visit_end_date_time
   , .value_col = visits
   , .color_col = service_line
 )

</code></pre>

<hr>
<h2 id='ts_readmit_rate_plt'>Plot Readmit Rate</h2><span id='topic+ts_readmit_rate_plt'></span>

<h3>Description</h3>

<p>Plot Readmit Rate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ts_readmit_rate_plt(.data, .date_col, .value_col, .by_grouping, .interactive)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ts_readmit_rate_plt_+3A_.data">.data</code></td>
<td>
<p>The data you need to pass.</p>
</td></tr>
<tr><td><code id="ts_readmit_rate_plt_+3A_.date_col">.date_col</code></td>
<td>
<p>The date column.</p>
</td></tr>
<tr><td><code id="ts_readmit_rate_plt_+3A_.value_col">.value_col</code></td>
<td>
<p>The value column.</p>
</td></tr>
<tr><td><code id="ts_readmit_rate_plt_+3A_.by_grouping">.by_grouping</code></td>
<td>
<p>How you want the data summarized - &quot;sec&quot;, &quot;min&quot;, &quot;hour&quot;,
&quot;day&quot;, &quot;week&quot;, &quot;month&quot;, &quot;quarter&quot; or &quot;year&quot;.</p>
</td></tr>
<tr><td><code id="ts_readmit_rate_plt_+3A_.interactive">.interactive</code></td>
<td>
<p>TRUE or FALSE. TRUE returns a <code>plotly</code> plot and FALSE
returns a static <code>ggplot2</code> plot.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Expects a tibble with a date time column and a value column
</p>
</li>
<li><p> Uses <code>timetk</code> for underlying sumarization and plot
</p>
</li>
<li><p> If .by_grouping is missing it will default to &quot;day&quot;
</p>
</li></ul>



<h3>Value</h3>

<p>A <code>timetk</code> time series plot that is interactive
</p>


<h3>Author(s)</h3>

<p>Steven P. Sanderson II, MPH
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)

suppressPackageStartupMessages(library(timetk))
suppressPackageStartupMessages(library(purrr))
suppressPackageStartupMessages(library(dplyr))

ts_tbl &lt;- tk_make_timeseries(
  start = "2019-01-01"
  , by = "day"
  , length_out = "1 year 6 months"
)
values &lt;- arima.sim(
  model = list(
    order = c(0, 1, 0))
    , n = 547
    , mean = 1
    , sd = 5
)

df_tbl &lt;- tibble(
  x = ts_tbl
  , y = values
  ) %&gt;%
  set_names("Date","Values")

ts_readmit_rate_plt(
  .data = df_tbl
  , .date_col = Date
  , .value_col = Values
  , .by = "month"
  , .interactive = FALSE
)

</code></pre>

<hr>
<h2 id='ts_signature_tbl'>Make a Time Enhanced Tibble</h2><span id='topic+ts_signature_tbl'></span>

<h3>Description</h3>

<p>Returns a tibble that adds the time series signature from the
<code><a href="timetk.html#topic+tk_augment_timeseries">timetk::tk_augment_timeseries_signature()</a></code> function. All added from a chosen
date column defined by the <code>.date_col</code> parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ts_signature_tbl(.data, .date_col, .pad_time = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ts_signature_tbl_+3A_.data">.data</code></td>
<td>
<p>The data that is being analyzed.</p>
</td></tr>
<tr><td><code id="ts_signature_tbl_+3A_.date_col">.date_col</code></td>
<td>
<p>The column that holds the date.</p>
</td></tr>
<tr><td><code id="ts_signature_tbl_+3A_.pad_time">.pad_time</code></td>
<td>
<p>Boolean TRUE/FALSE. If TRUE then the <code><a href="timetk.html#topic+pad_by_time">timetk::pad_by_time()</a></code>
function is called and used on the data.frame before the modification. The
default is TRUE.</p>
</td></tr>
<tr><td><code id="ts_signature_tbl_+3A_...">...</code></td>
<td>
<p>Grouping variables to be used by <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code> before using
<code><a href="timetk.html#topic+pad_by_time">timetk::pad_by_time()</a></code></p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Supply data with a date column and this will add the year, month, week, week day and hour
to the tibble. The original date column is kept.
</p>
</li>
<li><p> Returns a time-series signature tibble.
</p>
</li>
<li><p> You must know the data going into the function and if certain columns
should be dropped or kept when using further functions
</p>
</li></ul>



<h3>Value</h3>

<p>A tibble
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(timetk)

ts_signature_tbl(
  .data       = m4_daily
  , .date_col = date
  , .pad_time = TRUE
  , id
)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
