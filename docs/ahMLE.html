<!DOCTYPE html><html><head><title>Help for package ahMLE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ahMLE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ah'><p>ah</p></a></li>
<li><a href='#Calc_Cbeta'><p>Calc_Cbeta</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Methods for the Additive Hazard Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.20.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-3-8</td>
</tr>
<tr>
<td>Author:</td>
<td>Chengyuan Lu</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chengyuan Lu &lt;c.lu@lumc.nl&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Methods for fitting additive hazards model.
             Perform the maximum likelihood method as well as the traditional Aalen's method for estimating the additive hazards model. 
             For details see Chengyuan Lu(2021) &lt;<a href="https://doi.org/10.48550/arXiv.2004.06156">doi:10.48550/arXiv.2004.06156</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0), survival</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.1), Matrix, invGauss</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, Matrix</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-09 22:47:11 UTC; Chengyuan Lu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-09 23:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ah'>ah</h2><span id='topic+ah'></span>

<h3>Description</h3>

<p>This function offers the methods to fit the additive hazards model, including Aalen's method and Maximum likelihood method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ah(
  formula = formula(data),
  data = sys.parent(),
  matrix_domain = NULL,
  progbar = FALSE,
  method = "ml_opt",
  scale = TRUE,
  startedge = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ah_+3A_formula">formula</code></td>
<td>
<p>A formula, the dependent variable must be of type Surv in the survival package..</p>
</td></tr>
<tr><td><code id="ah_+3A_data">data</code></td>
<td>
<p>A data frame with the covariates mentioned in the formula stored.</p>
</td></tr>
<tr><td><code id="ah_+3A_matrix_domain">matrix_domain</code></td>
<td>
<p>A matrix describing the domain to find the maximum likelihood. The default constraint matrix guarantees the hazards to be positive for all possible covariates.</p>
</td></tr>
<tr><td><code id="ah_+3A_progbar">progbar</code></td>
<td>
<p>A logical value, shows the progress bar if it is TRUE, hide the progress bar if FALSE, default value is FALSE.</p>
</td></tr>
<tr><td><code id="ah_+3A_method">method</code></td>
<td>
<p>A string with values &quot;aalen&quot;, &quot;ml_opt&quot;, &quot;ml_enum&quot;, &quot;ml_asc&quot; and &quot;ml_desc&quot;. Default value is &quot;ml_opt&quot;.  &quot;aalen&quot; represents the Aalen's method.  &quot;ml_opt&quot; is the default method with respect to the default constraint matrix. &quot;ml_enum&quot;,&quot;ml_asc&quot; and &quot;ml_desc&quot; represents to the naive method, ascending method and descending method. Please check the referee for details.</p>
</td></tr>
<tr><td><code id="ah_+3A_scale">scale</code></td>
<td>
<p>A logical value, scales the input data in the interval [0,1] if it is TRUE. Default value is TRUE.</p>
</td></tr>
<tr><td><code id="ah_+3A_startedge">startedge</code></td>
<td>
<p>a vector which satisfies the domain condition. Only used for the ascending method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame, containing the coefficients (beta) at each time point and the cumulative beta at each time point.
</p>


<h3>References</h3>

<p>Chengyuan Lu, Jelle Goeman, Hein Putter 
Maximum likelihood estimation in the additive hazards model
arXiv:2004.06156
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1 = rnorm(100); X2 = rnorm(100)
Survival_Time = rep(0,100)
U = runif(100,min =0, max =1)
for (i in 1:100){Survival_Time[i] = sqrt((-2*log(U[i]))/(0.3*X1[i] + 0.7*X2[i]))}
tcens = runif(100, 2.5, 7.5)
time =  pmin(Survival_Time, tcens)
event = as.numeric(Survival_Time&lt;=tcens)
Data = data.frame(time = time, X1 = X1, X2 = X2, event = event)

Result = ah(Surv(time = time, event = event)~ X1 + X2, Data)

</code></pre>

<hr>
<h2 id='Calc_Cbeta'>Calc_Cbeta</h2><span id='topic+Calc_Cbeta'></span>

<h3>Description</h3>

<p>Computing cumulative beta from beta (the magnitude of the jumps of the coefficient function)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Calc_Cbeta(beta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Calc_Cbeta_+3A_beta">beta</code></td>
<td>
<p>The dataframe storing the magnitude of the jumps beta of the coefficients of the additive hazard.  The first column should be the survival time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return the cumulative beta by the giving beta.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>beta  = data.frame(time = c(1,2,3,4), beta = c(5,6,7,8))
cbeta = Calc_Cbeta(beta)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
