<!DOCTYPE html><html lang="en-US"><head><title>Help for package gellipsoid</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gellipsoid}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gellipsoid-package'><p>Generalized ellipsoids</p></a></li>
<li><a href='#basis3d'><p>Draw Basis Vectors in an rgl Scene</p></a></li>
<li><a href='#bbox3d'><p>Find the bounding box of a <code>rgl::mesh3d</code> or <code>rgl::qmesh3d</code> object</p></a></li>
<li><a href='#dual'><p>Dual or 'Inverse' of an ellipsoid</p></a></li>
<li><a href='#ell3d'><p>Plot Generalized Ellipsoids in 3D using rgl</p></a></li>
<li><a href='#ellipsoid'><p>Calculate an ellipsoid in 3D</p></a></li>
<li><a href='#gell'><p>(U, D) Representation of an Ellipsoid in R^p.</p></a></li>
<li><a href='#gmult'><p>Linear Transformation of a Generalized Ellipsoid</p></a></li>
<li><a href='#isBounded'><p>Tests for Classes of Generalized Ellipsoids</p></a></li>
<li><a href='#par3d.save'><p>Save and Restore the par3d Parameters for an rgl Scene</p></a></li>
<li><a href='#signature'><p>Signature of a Generalized Ellipsoid</p></a></li>
<li><a href='#UD'><p>SVD, modified to return U, and D extended with 0's</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generalized Ellipsoids</td>
</tr>
<tr>
<td>Version:</td>
<td>0.7.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-19</td>
</tr>
<tr>
<td>Author:</td>
<td>Georges Monette [aut],
        Michael Friendly [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Friendly &lt;friendly@yorku.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Represents generalized geometric ellipsoids with the "(U,D)" representation. It allows degenerate
	and/or unbounded ellipsoids, together with methods for linear and duality transformations, and for plotting.
	Thus ellipsoids are naturally extended to include lines, hyperplanes, points, cylinders, etc.
	This permits exploration of a variety to statistical issues that can be visualized using ellipsoids
	as discussed by Friendly, Fox &amp; Monette (2013), Elliptical Insights: Understanding Statistical Methods 
	Through Elliptical Geometry &lt;<a href="https://doi.org/10.1214%2F12-STS402">doi:10.1214/12-STS402</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>rgl</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/friendly/gellipsoid">https://github.com/friendly/gellipsoid</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-20 15:36:45 UTC; friendly</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-20 22:52:38 UTC</td>
</tr>
</table>
<hr>
<h2 id='gellipsoid-package'>Generalized ellipsoids</h2><span id='topic+gellipsoid-package'></span><span id='topic+gellipsoid'></span>

<h3>Description</h3>

<p>Represents generalized ellipsoids with the &quot;(U,D)&quot; representation, allowing
both degenerate and unbounded ellipsoids, together with methods for linear
and duality transformations, and for plotting.
This permits exploration of a variety to statistical issues that can be visualized using ellipsoids
as discussed by Friendly, Fox &amp; Monette (2013), &quot;Elliptical Insights: Understanding Statistical Methods 
and duality transformations, and for plotting. 
The ideas are described in Friendly, Monette &amp; Fox (2013) <a href="https://doi.org/10.1214/12-STS402">doi:10.1214/12-STS402</a>.
</p>


<h3>Details</h3>

<p>It uses the (U, D) representation of generalized ellipsoids in <code class="reqn">R^d</code>,
where
<code class="reqn">U</code> is square orthogonal and <code class="reqn">D</code> is diagonal with extended non-negative real
numbers, i.e. 0, Inf or a positive real). These are roughly analogous to the
corresponding terms in the singular-value decomposition of a matrix,
<code class="reqn">X = U D V'</code>.
</p>
<p>The resulting class of ellipsoids includes degenerate ellipsoids that are
flat and/or unbounded. Thus ellipsoids are naturally extended to include
lines, hyperplanes, points, cylinders, etc.
</p>
<p>The class is closed under linear and affine transformations (including those
between spaces of different dimensions) and under duality ('inverse')
transformations.
</p>
<p><b>Unbounded</b> ellipsoids, e.g. cylinders with elliptical cross-sections,
correspond to singular inner products, i.e. inner products defined by a
singular inner product matrix.
</p>
<p><b>Flat</b> ellipsoids correspond to singular variances. The corresponding inner
product is defined only on the supporting subspace.
</p>
<p>Ellipsoids that are both flat and unbounded correspond to lines, points,
subspaces, hyperplanes, etc.
</p>
<p><code><a href="#topic+gell">gell</a></code> can currently generate the U-D representation from 5 ways
of specifying an ellipsoid:
</p>
 
<ol>
<li><p> From the non-negative definite dispersion (variance)
matrix, Sigma: <code class="reqn">U D^2 U' = \Sigma</code>, 
where some elements of the diagonal matrix
D can be 0. This can only generate bounded ellipsoids, possibly flat.
</p>
</li>
<li><p> From the non-negative definite inner product matrix 'ip': <code class="reqn">U W^2 U = C</code>
where some elements of the diagonal matrix W can be 0. Then set D = W^-1
where 0^-1 = Inf. This can only generate fat (non-empty interior)
ellipsoids, possibly unbounded.
</p>
</li>
<li><p> From a subspace spanned by 'span' Let U_1 be an orthonormal basis of
Span('span'), let U_2 be an orthonormal basis of the orthogonal complement,
the U = [ U_1 U_2 ] and D = diag( c(Inf,...,Inf, 0,..,0)) where the number
of Inf's is equal to the number of columns of U_1.
</p>
</li>
<li><p> From a transformation of the unit sphere given by A(Unit sphere) where
<code class="reqn">A = U D V'</code>, i.e. the SVD.
</p>
</li>
<li><p> (Generalization of 4): (A, d) where A is any matrix and d is a vector of
factors corresponding to columns of A. These factors can be 0, positive or
Inf. In this case U and D are such that U D(Unit sphere) = A diag(d)(Unit
sphere). This is the only representation that can be used for all forms of
ellipsoids and in which any ellipsoid can be represented. 
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Georges Monette and Michael Friendly
</p>
<p>Maintainer: Michael Friendly &lt;friendly@yorku.ca&gt;
</p>


<h3>References</h3>

<p>Friendly, M., Monette, G. and Fox, J. (2013). Elliptical
Insights: Understanding Statistical Methods through Elliptical Geometry.
<em>Statistical Science</em>, <b>28</b>(1), 1-39. 
Online: <a href="https://www.datavis.ca/papers/ellipses-STS402.pdf">https://www.datavis.ca/papers/ellipses-STS402.pdf</a>,
DOI: <a href="https://doi.org/10.1214/12-STS402">doi:10.1214/12-STS402</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dual">dual</a></code>, <code><a href="#topic+ellipsoid">ellipsoid</a></code>, <code><a href="#topic+gell">gell</a></code>,  <code><a href="#topic+UD">UD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(zsph &lt;- gell(Sigma = diag(3)))  # unit sphere in R^3

(zplane &lt;- gell(span = diag(3)[, 1:2]))  # a plane

dual(zplane)  # line orthogonal to that plane

(zhplane &lt;- gell(center = c(0, 0, 2), span = diag(3)[, 1:2]))  # a hyperplane

dual(zhplane)  # orthogonal line through same center (note that the 'gell'
# object with a center contains more information than the geometric plane)

zorigin &lt;- gell(span = cbind(c(0, 0, 0)))
dual(zorigin)

# signatures of these ellipsoids
signature(zsph)
signature(zhplane)
signature(dual(zhplane))

</code></pre>

<hr>
<h2 id='basis3d'>Draw Basis Vectors in an rgl Scene</h2><span id='topic+basis3d'></span>

<h3>Description</h3>

<p>The function calculates and optionally draws basis vectors to be used as
coordinate axes in an rgl 3D display.  For geometric diagrams and some data
displays, this can be more useful than using <code><a href="rgl.html#topic+axis3d">axis3d</a></code> or
<code><a href="rgl.html#topic+box3d">box3d</a></code> to provide guides or axes.  The <code>origin</code>
argument permits multiple diagrams or graphs in the same display, each with
their own coordinate axes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>basis3d(
  matrix = diag(3),
  origin = c(0, 0, 0),
  scale = 1,
  draw = TRUE,
  label = draw,
  texts = colnames(basis),
  lwd = 3,
  cex = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="basis3d_+3A_matrix">matrix</code></td>
<td>
<p>A 3 x 3 matrix, whose <em>columns</em> are the basis vectors,
typically of unit length.</p>
</td></tr>
<tr><td><code id="basis3d_+3A_origin">origin</code></td>
<td>
<p>Origin in the rgl scene of the basis vectors</p>
</td></tr>
<tr><td><code id="basis3d_+3A_scale">scale</code></td>
<td>
<p>Scaling factor for the basis vectors</p>
</td></tr>
<tr><td><code id="basis3d_+3A_draw">draw</code></td>
<td>
<p>If <code>TRUE</code>, the vectors are plotted</p>
</td></tr>
<tr><td><code id="basis3d_+3A_label">label</code></td>
<td>
<p>If <code>TRUE</code>, the vectors are labeled at their tips</p>
</td></tr>
<tr><td><code id="basis3d_+3A_texts">texts</code></td>
<td>
<p>A character vector of length 3 used for labels. Defaults to
<code>c("x", "y", "z")</code>.</p>
</td></tr>
<tr><td><code id="basis3d_+3A_lwd">lwd</code></td>
<td>
<p>Line width for vectors</p>
</td></tr>
<tr><td><code id="basis3d_+3A_cex">cex</code></td>
<td>
<p>Character size for labels</p>
</td></tr>
<tr><td><code id="basis3d_+3A_...">...</code></td>
<td>
<p>Other arguments, passed to <code><a href="rgl.html#topic+segments3d">segments3d</a></code> and
<code><a href="rgl.html#topic+text3d">text3d</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns invisibly a 6 x 3 matrix, whose columns are the coordinate
axes, <code>c("x", "y", "z")</code>.  Odd numbered rows give the coordinates of
the <code>origin</code>, while even numbered rows give the locations of the tips
of the vectors.
</p>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>See Also</h3>

<p><code><a href="rgl.html#topic+axis3d">axis3d</a></code>, <code><a href="rgl.html#topic+box3d">box3d</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# show two different sets of basis vectors
open3d()
basis3d()
A &lt;- matrix(c(1,2,0.1,
              2,1,0.1,
              0.1,0.1,0.5), 3,3)
basis3d(t(A), col="red")

# scene with two different displays
open3d()
basis3d()
basis3d(origin=c(2,0,0))


</code></pre>

<hr>
<h2 id='bbox3d'>Find the bounding box of a <code>rgl::mesh3d</code> or <code>rgl::qmesh3d</code> object</h2><span id='topic+bbox3d'></span>

<h3>Description</h3>

<p>Ellipsoids are created by <span class="pkg">rgl</span> functions as meshes of points, segments, ... from coordinates
in various forms. This function calculates the bounding box, defined as the range of the
x, y, and z coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bbox3d(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bbox3d_+3A_x">x</code></td>
<td>
<p>A mesh3d object</p>
</td></tr>
<tr><td><code id="bbox3d_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 2 x 3 matrix, giving the minimum and maximum values in the rows and x, y, z coordinates
in the columns.
</p>

<hr>
<h2 id='dual'>Dual or 'Inverse' of an ellipsoid</h2><span id='topic+dual'></span><span id='topic+dual.gell'></span>

<h3>Description</h3>

<p><code>dual</code> produces the orthogonal complement for subspaces or for
ellipsoids. This is equivalent to inverting <code class="reqn">\Sigma</code> or an inner product
<code>ip</code> when these are non-singular.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dual(x, ...)

## S3 method for class 'gell'
dual(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dual_+3A_x">x</code></td>
<td>
<p>An object, of class <code>"gell"</code></p>
</td></tr>
<tr><td><code id="dual_+3A_...">...</code></td>
<td>
<p>Other arguments, unused for now.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>At present, <code>dual</code> is only defined for objects of class <code>"gell"</code>.
</p>
<p>In the (U,D) representation, the dual simply has the columns of U in the
reverse order, and the reciprocals of the diagonal elements of D, also in
reverse order.
</p>


<h3>Value</h3>

<p>A (U, D) representation of the dual, with components 
LIST, use </p>
<table role = "presentation">
<tr><td><code>u</code></td>
<td>
<p>Right singular vectors</p>
</td></tr> <tr><td><code>d</code></td>
<td>
<p>Singular values</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Georges Monette
</p>


<h3>References</h3>

<p>Dempster, A. (1969). <em>Elements of Continuous Multivariate
Analysis</em> Reading, MA: Addison-Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gell">gell</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(zplane &lt;- gell(span = diag(3)[,1:2]))  # a plane

dual(zplane)  # line orthogonal to that plane

(zhplane &lt;- gell(center = c(0,0,2), span = diag(3)[,1:2]))  # a hyperplane

dual(zhplane) # orthogonal line through same center (note that the 'gell'
              # object with a center contains more information than the geometric plane)

zorigin &lt;- gell(span = cbind(c(0,0,0)))
dual( zorigin )

</code></pre>

<hr>
<h2 id='ell3d'>Plot Generalized Ellipsoids in 3D using rgl</h2><span id='topic+ell3d'></span><span id='topic+ell3d.default'></span><span id='topic+ell3d.gell'></span>

<h3>Description</h3>

<p><code>ell3d</code> is a convenience wrapper for <code><a href="#topic+ellipsoid">ellipsoid</a></code>
specialized for class <code>"gell"</code> objects. It plots an
ellipsoid in the current rgl window.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ell3d(x, ...)

## Default S3 method:
ell3d(x, shape, radius = 1, segments = 40, shade = TRUE, wire = FALSE, ...)

## S3 method for class 'gell'
ell3d(
  x,
  length = 10,
  sides = 30,
  segments = 40,
  shade = TRUE,
  wire = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ell3d_+3A_x">x</code></td>
<td>
<p>A vector of length 3 giving the center of the ellipsoid for the
default method, or a class <code>"gell"</code> object for the gell method.</p>
</td></tr>
<tr><td><code id="ell3d_+3A_...">...</code></td>
<td>
<p>Other arguments, passed to <code><a href="#topic+ellipsoid">ellipsoid</a></code></p>
</td></tr>
<tr><td><code id="ell3d_+3A_shape">shape</code></td>
<td>
<p>A 3 x 3 symmetric matrix giving the shape of the ellipsoid.</p>
</td></tr>
<tr><td><code id="ell3d_+3A_radius">radius</code></td>
<td>
<p>radius of the ellipsoid</p>
</td></tr>
<tr><td><code id="ell3d_+3A_segments">segments</code></td>
<td>
<p>number of segments in each direction in calculating the
<code>mesh3d</code> object</p>
</td></tr>
<tr><td><code id="ell3d_+3A_shade">shade</code></td>
<td>
<p>Logical. Whether the 3D ellipsoid should be shaded</p>
</td></tr>
<tr><td><code id="ell3d_+3A_wire">wire</code></td>
<td>
<p>Logical. Whether the 3D ellipsoid should be rendered with its
wire frame</p>
</td></tr>
<tr><td><code id="ell3d_+3A_length">length</code></td>
<td>
<p>For unbounded, (infinite) ellipsoids, the length to display
for infinite dimensions</p>
</td></tr>
<tr><td><code id="ell3d_+3A_sides">sides</code></td>
<td>
<p>For unbounded, cylindrical ellipsoids, the number of sides for
the elliptical cross sections</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the result of the call to <code><a href="#topic+ellipsoid">ellipsoid</a></code>
</p>


<h3>Note</h3>

<p>This implementation is subject to change.
</p>


<h3>Author(s)</h3>

<p>Georges Monette
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ellipsoid">ellipsoid</a></code>, <code><a href="#topic+gell">gell</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# a proper ellipsoid, and its inverse
c1 &lt;- c(0,0,0)
C1 &lt;- matrix(c(6, 2, 1,
               2, 3, 2,
               1, 2, 2), 3,3)

open3d()
zell1 &lt;- gell(center=c1, Sigma=C1)
E1 &lt;- ell3d(zell1, col="blue", alpha=0.1)
# inverse of C1
E1I &lt;- ell3d(dual(zell1), col="blue", alpha=0.1, wire=TRUE)

#open3d()  ## to see this in a new window
# a singular ellipsoid and its inverse
c2 &lt;- c1
C2 &lt;- matrix(c(6, 2, 0,
               2, 3, 0,
               0, 0, 0), 3,3)

E2 &lt;- ell3d( zell2 &lt;-gell( center = c2, Sigma = C2), 
             col = 'red', alpha = 0.25, wire = TRUE)
E2I &lt;- ell3d( dual(gell( center = c2, Sigma = C2)), 
             length=3, col = 'red', alpha = 0.25, wire = TRUE )

# signatures
signature(zell1)
signature(zell2)


</code></pre>

<hr>
<h2 id='ellipsoid'>Calculate an ellipsoid in 3D</h2><span id='topic+ellipsoid'></span>

<h3>Description</h3>

<p>Calculates a <code><a href="rgl.html#topic+qmesh3d">qmesh3d</a></code> object representing a 3D ellipsoid
with given <code>center</code> and <code>shape</code> matrix.  The function allows for
degenerate ellipsoids where the <code>shape</code> matrix has rank &lt; 3 and plots
as an ellipse or a line.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ellipsoid(center, shape, radius = 1, segments = 60, warn.rank = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ellipsoid_+3A_center">center</code></td>
<td>
<p>A vector of length 3 giving the center of the 3D ellipsoid,
typically the mean vector of a data matrix.</p>
</td></tr>
<tr><td><code id="ellipsoid_+3A_shape">shape</code></td>
<td>
<p>A 3 x 3 matrix giving the shape of the 3D ellipsoid, typical a
covariance matrix of a data matrix.</p>
</td></tr>
<tr><td><code id="ellipsoid_+3A_radius">radius</code></td>
<td>
<p>radius of the ellipsoid, with default <code>radius=1</code>, giving
a standard ellipsoid. For a multivariate sample with <code>dfe</code> degrees of
freedom associated with <code>shape</code>, an ellipsoid of <code>level</code> coverage
can be calculated using <code>radius=sqrt(3 * qf(level, 3, dfe))</code>.</p>
</td></tr>
<tr><td><code id="ellipsoid_+3A_segments">segments</code></td>
<td>
<p>number of line segments to use in each direction in the
wire-frame representation of the ellipsoid</p>
</td></tr>
<tr><td><code id="ellipsoid_+3A_warn.rank">warn.rank</code></td>
<td>
<p>warn if the <code>shape</code> matrix is of rank &lt; 3?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ellipsoid is calculated by transforming a unit sphere by the Cholesky
square root of the <code>shape</code> matrix, and translating to the
<code>center</code>.
</p>
<p>The ellipsoid can be plotted with <code>plot3d</code>
</p>


<h3>Value</h3>

<p>A qmesh3d object
</p>


<h3>Author(s)</h3>

<p>Michael Friendly and John Fox, extending Duncan Murdoch
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## none yet


</code></pre>

<hr>
<h2 id='gell'>(U, D) Representation of an Ellipsoid in R^p.</h2><span id='topic+gell'></span><span id='topic+gell.default'></span><span id='topic+gell.gell'></span>

<h3>Description</h3>

<p><code>gell</code> provides a set of ways to specify a generalized ellipsoid in
<code class="reqn">R^p</code>, using the (U, D) representation to include all special cases,
where U is a square orthogonal matrix, and D is diagonal with extended
non-negative real numbers, i.e. 0, Inf or a positive real.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gell(x, ...)

## Default S3 method:
gell(x, center = 0, Sigma, ip, span, A, u, d = 1, epsfac = 2, ...)

## S3 method for class 'gell'
gell(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gell_+3A_x">x</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="gell_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
<tr><td><code id="gell_+3A_center">center</code></td>
<td>
<p>A vector specifying the center of the ellipsoid</p>
</td></tr>
<tr><td><code id="gell_+3A_sigma">Sigma</code></td>
<td>
<p>A square, symmetric, non-negative definite dispersion
(variance) matrix</p>
</td></tr>
<tr><td><code id="gell_+3A_ip">ip</code></td>
<td>
<p>A square, symmetric, non-negative definite inner product matrix.
See Details.</p>
</td></tr>
<tr><td><code id="gell_+3A_span">span</code></td>
<td>
<p>A subspace with a given span.  See Details.</p>
</td></tr>
<tr><td><code id="gell_+3A_a">A</code></td>
<td>
<p>A matrix giving a linear transformation of the unit sphere.</p>
</td></tr>
<tr><td><code id="gell_+3A_u">u</code></td>
<td>
<p>A U matrix</p>
</td></tr>
<tr><td><code id="gell_+3A_d">d</code></td>
<td>
<p>Diagonal elements of a D matrix</p>
</td></tr>
<tr><td><code id="gell_+3A_epsfac">epsfac</code></td>
<td>
<p>Factor of <code>.Machine$double.eps</code> used to distinguish zero
vs. positive singular values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The resulting class of ellipsoids includes degenerate ellipsoids that are
flat and/or unbounded. Thus ellipsoids are naturally defined to include
lines, hyperplanes, points, cylinders, etc.
</p>
<p><code>gell</code> can currently generate the (U, D) representation from 5 ways of
specifying an ellipsoid:
</p>
 
<ol>
<li><p> From the non-negative definite dispersion (variance)
matrix, <code class="reqn">Sigma: U D^2 U' = Sigma</code>, where some elements of the diagonal matrix
D can be 0. This can only generate bounded ellipsoids, possibly flat.
</p>
</li>
<li><p> From the non-negative definite inner product matrix <code class="reqn">'ip': U W^2 U = C</code>
where some elements of the diagonal matrix W can be 0. Then set D = W^-1
where 0^-1 = Inf. This can only generate fat (non-empty interior)
ellipsoids, possibly unbounded.
</p>
</li>
<li><p> From a subspace spanned by 'span' Let U_1 be an orthonormal basis of
Span('span'), let U_2 be an orthonormal basis of the orthogonal complement,
the <code class="reqn">U = [ U_1 U_2 ]</code> and <code class="reqn">D = diag( c(Inf,...,Inf, 0,..,0))</code> where the number
of Inf's is equal to the number of columns of U_1.
</p>
</li>
<li><p> From a transformation of the unit sphere given by A(Unit sphere) where
A = UDV', i.e. the SVD.
</p>
</li>
<li><p> (Generalization of 4): A, d where A is any matrix and d is a vector of
factors corresponding to columns of A. These factors can be 0, positive or
Inf. In this case U and D are such that U D(Unit sphere) = A diag(d)(Unit
sphere). This is the only representation that can be used for all forms of
ellipsoids and in which any ellipsoid can be represented. </p>
</li></ol>



<h3>Value</h3>

<p>A     (U, D) representation of the ellipsoid, with components 
</p>
<table role = "presentation">
<tr><td><code>center</code></td>
<td>
<p>center</p>
</td></tr> 
<tr><td><code>u</code></td>
<td>
<p>Right singular vectors</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>Singular values</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Georges Monette
</p>


<h3>References</h3>

<p>Friendly, M., Monette, G. and Fox, J. (2013). Elliptical
Insights: Understanding Statistical Methods through Elliptical Geometry.
<em>Statistical Science</em>, <b>28</b>(1), 1-39.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dual">dual</a></code>, <code><a href="#topic+gmult">gmult</a></code>, <code><a href="#topic+signature">signature</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
gell(Sigma = diag(3))    # the unit sphere

(zplane &lt;- gell(span = diag(3)[,1:2]))    # a plane

</code></pre>

<hr>
<h2 id='gmult'>Linear Transformation of a Generalized Ellipsoid</h2><span id='topic+gmult'></span>

<h3>Description</h3>

<p>Linear transformation of a generalized ellipsoid, including projections to
subspaces.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gmult(A, G, epsfac = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gmult_+3A_a">A</code></td>
<td>
<p>A matrix describing a linear transformation, conforming to the U
component of <code>G</code> for matrix multiplication.</p>
</td></tr>
<tr><td><code id="gmult_+3A_g">G</code></td>
<td>
<p>A <code>gell</code> object</p>
</td></tr>
<tr><td><code id="gmult_+3A_epsfac">epsfac</code></td>
<td>
<p>Factor of <code>.Machine$double.eps</code> used to distinguish zero
vs. positive singular values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The matrix <code>A</code> can be non-singular, for a standard linear
transformation, or singular, for a projection to a subspace.
</p>


<h3>Value</h3>

<p><code>gell</code> object
</p>


<h3>Note</h3>

<p>This implementation should be changed so that it provides an S3 method
for class <code>"gell"</code> objects for which it was intended.
</p>


<h3>Author(s)</h3>

<p>Georges Monette
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gell">gell</a></code>, <code><a href="#topic+dual">dual</a></code>, <code><a href="#topic+signature">signature</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(zplane &lt;- gell(span = diag(3)[,1:2]))  # a plane

dual(zplane)  # orthogonal line
(zplane2 &lt;- gmult( cbind( c(1,1,1), c(1,-1,0), c(1,0,-1)), zplane))

# correctly wipes out one dimension
(zplane3 &lt;- gmult( cbind( c(1,0,0), c(1,0,0), c(0,0,1)), zplane)) 


</code></pre>

<hr>
<h2 id='isBounded'>Tests for Classes of Generalized Ellipsoids</h2><span id='topic+isBounded'></span><span id='topic+isBounded.gell'></span><span id='topic+isFat'></span><span id='topic+isFat.gell'></span><span id='topic+isFlat'></span><span id='topic+isFlat.gell'></span><span id='topic+isUnbounded'></span><span id='topic+isUnbounded.gell'></span>

<h3>Description</h3>

<p>These functions provide tests for classes of generalized ellipsoids in the
(U, D) representation, based on the numbers of positive, zero and infinite
singular values in D.
</p>
<p>They are included here mainly as computational definitions of the terms
&lsquo;bounded&rsquo; for an ellipsoid with finite extent, 
&lsquo;fat&rsquo;, for a bounded ellipsoid with non-empty interior, 
&lsquo;flat&rsquo;, for degenerate (singular) ellipsoids 
in <code class="reqn">R^p</code> with empty interior.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isBounded(x, ...)

## S3 method for class 'gell'
isBounded(x, ...)

isFat(x, ...)

## S3 method for class 'gell'
isFat(x, ...)

isFlat(x, ...)

## S3 method for class 'gell'
isFlat(x, ...)

isUnbounded(x, ...)

## S3 method for class 'gell'
isUnbounded(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isBounded_+3A_x">x</code></td>
<td>
<p>A class <code>"gell"</code> object</p>
</td></tr>
<tr><td><code id="isBounded_+3A_...">...</code></td>
<td>
<p>Other arguments, not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE or FALSE
</p>


<h3>Author(s)</h3>

<p>Georges Monette
</p>


<h3>References</h3>

<p>Friendly, M., Monette, G. and Fox, J. (2013). Elliptical
Insights: Understanding Statistical Methods through Elliptical Geometry.
<em>Statistical Science</em>, <b>28</b>(1), 1-39.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+signature">signature</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# None yet

</code></pre>

<hr>
<h2 id='par3d.save'>Save and Restore the par3d Parameters for an rgl Scene</h2><span id='topic+par3d.save'></span><span id='topic+par3d.restore'></span>

<h3>Description</h3>

<p>Use this function to make a manually manipulated rgl view reproducible, within sessions or
across sessions. Within an R session, simply use <code>par3d.save</code> to record
the <code>par3d</code> parameters for the view(s) to named objects. Across
sessions, use the <code>filename</code> argument to save these to .rds files
</p>


<h3>Usage</h3>

<pre><code class='language-R'>par3d.save(
  params = c("userMatrix", "scale", "zoom", "FOV"),
  filename,
  dev = rgl.cur()
)

par3d.restore(parms, filename)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="par3d.save_+3A_params">params</code></td>
<td>
<p>A list of <code>par3d</code> parameters to save</p>
</td></tr>
<tr><td><code id="par3d.save_+3A_filename">filename</code></td>
<td>
<p>Name of a <code>.rds</code> file to save to or restore from</p>
</td></tr>
<tr><td><code id="par3d.save_+3A_dev">dev</code></td>
<td>
<p>The rgl device.  Currently unused</p>
</td></tr>
<tr><td><code id="par3d.save_+3A_parms">parms</code></td>
<td>
<p>A list of <code>par3d</code> parameters to restore</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>par3d.save</code> returns a list with the current values of the
<code>par3d</code> parameters named in <code>params</code>.
</p>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>See Also</h3>

<p><code><a href="rgl.html#topic+par3d">par3d</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
	library(rgl)
	open3d()
	# ...
	parms &lt;- par3d.save()
	# ....
	par3d.restore(parms)
	

## End(Not run)


</code></pre>

<hr>
<h2 id='signature'>Signature of a Generalized Ellipsoid</h2><span id='topic+signature'></span>

<h3>Description</h3>

<p>Calculates the signature of a generalized ellipsoid, a vector of length 3
giving the number of positive, zero and infinite singular values in the (U,
D) representation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signature(G)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="signature_+3A_g">G</code></td>
<td>
<p>A class <code>"gell"</code> objects</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length 3, with named components <code>pos</code>, <code>zero</code>
and <code>inf</code>
</p>


<h3>Author(s)</h3>

<p>Georges Monette
</p>


<h3>References</h3>

<p>Friendly, M., Monette, G. and Fox, J. (2013). Elliptical
Insights: Understanding Statistical Methods through Elliptical Geometry.
<em>Statistical Science</em>, <b>28</b>(1), 1-39.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+isBounded">isBounded</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(zsph &lt;- gell(Sigma = diag(3)))  # unit sphere in R^3

(zplane &lt;- gell(span = diag(3)[,1:2]))  # a plane

dual(zplane)  # line orthogonal to that plane

(zhplane &lt;- gell(center = c(0,0,2), span = diag(3)[,1:2]))  # a hyperplane

dual(zhplane) # orthogonal line through same center (note that the 'gell'
              # object with a center contains more information than the geometric plane)

zorigin &lt;- gell(span = cbind(c(0,0,0)))
dual( zorigin )

# signatures of these ellipsoids
signature(zsph)
signature(zhplane)
signature(dual(zhplane))

</code></pre>

<hr>
<h2 id='UD'>SVD, modified to return U, and D extended with 0's</h2><span id='topic+UD'></span>

<h3>Description</h3>

<p>Calculates U and D in the (U, D) representation of a generalized ellipsoid.
This uses the SVD, modified to return U, and D extended with 0's for
singular matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UD(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UD_+3A_x">x</code></td>
<td>
<p>A matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components: 
</p>
<table role = "presentation">
<tr><td><code>u</code></td>
<td>
<p>Right singular vectors</p>
</td></tr> 
<tr><td><code>d</code></td>
<td>
<p>Singular values</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Georges Monette
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+svd">svd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# None yet

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
