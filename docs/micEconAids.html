<!DOCTYPE html><html><head><title>Help for package micEconAids</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {micEconAids}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aidsBestA0'><p>Find 'best' Value for alpha 0 in the AIDS</p></a></li>
<li><a href='#aidsCalc'><p> Shares and Quantities of the Almost Ideal Demand System</p></a></li>
<li><a href='#aidsConcav'><p>Concavity of the AIDS</p></a></li>
<li><a href='#aidsConsist'><p>Check Consistency of the AIDS</p></a></li>
<li><a href='#aidsElas'><p> Elasticities of the AIDS model</p></a></li>
<li><a href='#aidsEst'><p>Estimating the Almost Ideal Demand System (AIDS)</p></a></li>
<li><a href='#aidsMono'><p>Monotonicity of the AIDS</p></a></li>
<li><a href='#aidsPx'><p> Price Index for the AIDS</p></a></li>
<li><a href='#aidsUtility'><p>Indirect Utility Function of the Almost Ideal Demand System</p></a></li>
<li><a href='#Blanciforti86'><p>U.S. consumption data</p></a></li>
<li><a href='#coef.aidsEst'><p>Coefficients of an Almost Ideal Demand System</p></a></li>
<li><a href='#df.residual.aidsEst'><p>Covariance matrix of an Almost Ideal Demand System</p></a></li>
<li><a href='#fitted.aidsEst'><p>Fitted values of an Almost Ideal Demand System</p></a></li>
<li><a href='#logLik.aidsEst'><p>Log-Likelihood value of an object of class aidsEst</p></a></li>
<li><a href='#lrtest.aidsEst'><p>Likelihood Ratio test for Almost Ideal Demand Systems</p></a></li>
<li><a href='#summary.aidsElas'><p>Summarizing the Elasticities of an Almost Ideal Demand System</p></a></li>
<li><a href='#summary.aidsEst'><p>Summarizing the Estimation of an Almost Ideal Demand System</p></a></li>
<li><a href='#USMeatConsump'><p>U.S. Meat Consumption Data</p></a></li>
<li><a href='#vcov.aidsEst'><p>Covariance matrix of an Almost Ideal Demand System</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.6-20</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-20</td>
</tr>
<tr>
<td>Title:</td>
<td>Demand Analysis with the Almost Ideal Demand System (AIDS)</td>
</tr>
<tr>
<td>Author:</td>
<td>Arne Henningsen</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Arne Henningsen &lt;arne.henningsen@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.14.0), lmtest, micEcon (&ge; 0.6-0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, systemfit (&ge; 1.1-12), miscTools (&ge; 0.6-0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions and tools
   for analysing consumer demand
   with the Almost Ideal Demand System (AIDS)
   suggested by Deaton and Muellbauer (1980).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.micEcon.org">http://www.micEcon.org</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-20 11:14:57 UTC; gsl324</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-20 12:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='aidsBestA0'>Find 'best' Value for alpha 0 in the AIDS</h2><span id='topic+aidsBestA0'></span>

<h3>Description</h3>

<p>Search for the intercept of the translog price index
(<code class="reqn">\alpha_0</code>) that gives the best fit to the
Almost Ideal Demand System (see Michalek and Keyzer, 1992)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   aidsBestA0( priceNames, shareNames, totExpName,
      a0min = -50, a0max = 50, stoprange = 3, stopiter = 10,
      verbose = FALSE, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aidsBestA0_+3A_pricenames">priceNames</code></td>
<td>
<p>a vector of strings containing the names of the prices.</p>
</td></tr>
<tr><td><code id="aidsBestA0_+3A_sharenames">shareNames</code></td>
<td>
<p>a vector of strings containing the names of the expenditure
shares.</p>
</td></tr>
<tr><td><code id="aidsBestA0_+3A_totexpname">totExpName</code></td>
<td>
<p>a string containing the variable name of total expenditure.</p>
</td></tr>
<tr><td><code id="aidsBestA0_+3A_a0min">a0min</code></td>
<td>
<p>lower limit of the range for searching for <code class="reqn">\alpha_0</code>.</p>
</td></tr>
<tr><td><code id="aidsBestA0_+3A_a0max">a0max</code></td>
<td>
<p>upper limit of the range for searching for <code class="reqn">\alpha_0</code>.</p>
</td></tr>
<tr><td><code id="aidsBestA0_+3A_stoprange">stoprange</code></td>
<td>
<p>stop searching when the search interval is smaller than
or equal to <code>stoprange</code>.</p>
</td></tr>
<tr><td><code id="aidsBestA0_+3A_stopiter">stopiter</code></td>
<td>
<p>maximal number of iterations.</p>
</td></tr>
<tr><td><code id="aidsBestA0_+3A_verbose">verbose</code></td>
<td>
<p>print each determinant of the residual covariance matrix
immediately after its calculation.</p>
</td></tr>
<tr><td><code id="aidsBestA0_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="#topic+aidsEst">aidsEst</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The demand system is estimated using the Iterative Linear Least Squares
Estimator (ILLE) suggested by Blundell and Robin (1999).
This iterative procedure is equivalent to the method proposed by
Michalek and Keyzer (1992). However, the latter do not correct
the coefficient covariance matrix.
</p>
<p>The fit of the model is measured in terms of the likelihood value.
Since the determinant of the residual covariance matrix is monotonically
decreasing with the likelihood value, we search for the smallest
determinant of the residual covariance matrix.
</p>
<p>Since each call of <code><a href="#topic+aidsEst">aidsEst</a></code> generally takes a long time,
the search algorithm is constructed to minimize the
calls of the function <code><a href="#topic+aidsEst">aidsEst</a></code>.
</p>


<h3>Value</h3>

<p>a list containing following objects:
</p>
<table>
<tr><td><code>alpha0</code></td>
<td>
<p><code class="reqn">\alpha_0</code> that gives the best fit.</p>
</td></tr>
<tr><td><code>allValues</code></td>
<td>
<p>all <code class="reqn">\alpha_0</code> values that have been tested and
the determinants of the corresponding residual covariance matrices.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>number of iterations.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arne Henningsen</p>


<h3>References</h3>

<p>Blundell, R. and J.M. Robin (1999)
Estimationin Large and Disaggregated Demand Systems:
An Estimator for Conditionally Linear Systems.
<em>Journal of Applied Econometrics</em>, 14, p. 209-232.
</p>
<p>Deaton, A.S. and J. Muellbauer (1980)
An Almost Ideal Demand System.
<em>American Economic Review</em>, 70, p. 312-326.
</p>
<p>Michalek, J. and M. A. Keyzer (1992)
Estimation of a two-stage LES-AIDS consumer demand system
for eight EC countries.
<em>European Review of Agricultural Economics</em>, 19 (2), p. 137-163.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+aidsEst">aidsEst</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>   data( Blanciforti86 )
   # Data on food consumption are available only for the first 32 years
   Blanciforti86 &lt;- Blanciforti86[ 1:32, ]

   bestA0 &lt;- aidsBestA0( c( "pFood1", "pFood2", "pFood3", "pFood4" ),
      c( "wFood1", "wFood2", "wFood3", "wFood4" ), "xFood",
      data = Blanciforti86, useMatrix = FALSE )
   # may take some time (argument 'useMatrix = FALSE' decreases
   # the computation time only if the model and data set are small)
   print( bestA0$alpha0 )
   plot( bestA0$allValues ) # this should be convex
</code></pre>

<hr>
<h2 id='aidsCalc'> Shares and Quantities of the Almost Ideal Demand System </h2><span id='topic+aidsCalc'></span><span id='topic+predict.aidsEst'></span>

<h3>Description</h3>

<p>Given prices, total expenditure and coefficients this function
calculates the demanded quantities and expenditure shares based
on the Almost Ideal Demand System.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aidsCalc( priceNames, totExpName, coef, data, priceIndex = "TL",
   basePrices = NULL, baseShares = NULL, shifterNames = NULL )

## S3 method for class 'aidsEst'
predict( object, newdata = NULL,
   observedShares = FALSE, ... )

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aidsCalc_+3A_pricenames">priceNames</code></td>
<td>
<p>a vector of strings containing the names of the prices.</p>
</td></tr>
<tr><td><code id="aidsCalc_+3A_totexpname">totExpName</code></td>
<td>
<p>a string containing the variable name of total expenditure.</p>
</td></tr>
<tr><td><code id="aidsCalc_+3A_coef">coef</code></td>
<td>
<p>a list containing the coefficients alpha, beta, gamma,
and (only for the translog price index) alpha0.</p>
</td></tr>
<tr><td><code id="aidsCalc_+3A_data">data</code></td>
<td>
<p>a data frame containing the data.</p>
</td></tr>
<tr><td><code id="aidsCalc_+3A_priceindex">priceIndex</code></td>
<td>
<p>a character string specifying the price index
(see <code><a href="#topic+aidsPx">aidsPx</a></code>)
or a numeric vector providing the log values of the price index.</p>
</td></tr>
<tr><td><code id="aidsCalc_+3A_baseprices">basePrices</code></td>
<td>
<p>a vector specifying the base prices for the
Paasche, Laspeyres, and Tornqvist price index.</p>
</td></tr>
<tr><td><code id="aidsCalc_+3A_baseshares">baseShares</code></td>
<td>
<p>a vector specifying the base expenditure shares for the
Laspeyres, simplified Laspeyres, and Tornqvist index.</p>
</td></tr>
<tr><td><code id="aidsCalc_+3A_shifternames">shifterNames</code></td>
<td>
<p>a vector of strings containing the names 
of the demand shifters.</p>
</td></tr>
<tr><td><code id="aidsCalc_+3A_object">object</code></td>
<td>
<p>an object of class <code>aidsEst</code>.</p>
</td></tr>
<tr><td><code id="aidsCalc_+3A_newdata">newdata</code></td>
<td>
<p>an optional data frame which should contain the variables
for the prediction.
If omitted, the data frame used for the estimation is used
also for the prediction.</p>
</td></tr>
<tr><td><code id="aidsCalc_+3A_observedshares">observedShares</code></td>
<td>
<p>logical. Using observed shares? (see details).</p>
</td></tr>
<tr><td><code id="aidsCalc_+3A_...">...</code></td>
<td>
<p>currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>predict</code> method for objects of class <code>aidsEst</code>
extracts all relevant elements from an object returned by <code>aidsEst</code>
and passes them as arguments to <code>aidsCalc</code>.
The optional argument <code>observedShares</code> determines
whether fitted (default) or observed expenditure shares are
used in the price index of the LA-AIDS.
</p>


<h3>Value</h3>

<p><code>aidsCalc</code> and
the <code>predict</code> method for objects of class <code>aidsEst</code>
return a list with following elements:
</p>
<table>
<tr><td><code>shares</code></td>
<td>
<p>a data frame containing the calculated expenditure shares.</p>
</td></tr>
<tr><td><code>quantities</code></td>
<td>
<p>a data frame containing the calculated quantites.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arne Henningsen</p>


<h3>References</h3>

<p>Deaton, A.S. and J. Muellbauer (1980)
An Almost Ideal Demand System.
<em>American Economic Review</em>, 70, p. 312-326.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+aidsEst">aidsEst</a></code>, <code><a href="#topic+aidsPx">aidsPx</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>   data( Blanciforti86 )
   # Data on food consumption are available only for the first 32 years
   Blanciforti86 &lt;- Blanciforti86[ 1:32, ]

   priceNames &lt;- c( "pFood1", "pFood2", "pFood3", "pFood4" )
   shareNames &lt;- c( "wFood1", "wFood2", "wFood3", "wFood4" )

   ## LA-AIDS
   estResult &lt;- aidsEst( priceNames, shareNames, "xFood",
      data = Blanciforti86, priceIndex = "S" )

   # using observed shares in the Stone index
   lnp &lt;- aidsPx( "S", priceNames, Blanciforti86, shareNames )
   fitted &lt;- aidsCalc( priceNames, "xFood", coef = coef( estResult ),
      data = Blanciforti86, priceIndex = lnp )
   fitted$shares  # equal to estResult$wFitted
   fitted$quant   # equal to estResult$qFitted
   # now the same with the predict method
   fitted2 &lt;- predict( estResult, observedShares = TRUE )
   all.equal( fitted, fitted2 ) 

   # using fitted shares in the Stone index
   fitted &lt;- aidsCalc( priceNames, "xFood", coef = estResult$coef,
      data = Blanciforti86, priceIndex = "S" )
   # now the same with the predict method
   fitted2 &lt;- predict( estResult )
   all.equal( fitted, fitted2 ) 

   ## AIDS
   estResult &lt;- aidsEst( priceNames, shareNames, "xFood",
      data = Blanciforti86, method = "IL" )

   fitted &lt;- aidsCalc( priceNames, "xFood", coef = coef( estResult ),
      data = Blanciforti86 )

   fitted$shares  # equal to estResult$wFitted
   fitted$quant   # equal to estResult$qFitted

   fitted2 &lt;- predict( estResult )
   all.equal( fitted, fitted2 ) 
</code></pre>

<hr>
<h2 id='aidsConcav'>Concavity of the AIDS</h2><span id='topic+aidsConcav'></span><span id='topic+print.aidsConcav'></span>

<h3>Description</h3>

<p>Check whether the expenditure function of the AIDS is concave
in prices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aidsConcav( priceNames, totExpName, coef, data, shareNames = NULL )

## S3 method for class 'aidsConcav'
print( x, header = TRUE, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aidsConcav_+3A_pricenames">priceNames</code></td>
<td>
<p>a vector of strings containing the names of the prices.</p>
</td></tr>
<tr><td><code id="aidsConcav_+3A_totexpname">totExpName</code></td>
<td>
<p>a string containing the variable name of total expenditure.</p>
</td></tr>
<tr><td><code id="aidsConcav_+3A_coef">coef</code></td>
<td>
<p>a list containing the coefficients alpha, beta, gamma,
and (only for the translog price index) alpha0.</p>
</td></tr>
<tr><td><code id="aidsConcav_+3A_data">data</code></td>
<td>
<p>a data frame containing the data.</p>
</td></tr>
<tr><td><code id="aidsConcav_+3A_sharenames">shareNames</code></td>
<td>
<p>a vector of strings containing the names of the expenditure
shares.</p>
</td></tr>
<tr><td><code id="aidsConcav_+3A_x">x</code></td>
<td>
<p>an object of class <code>aidsConcav</code>.</p>
</td></tr>
<tr><td><code id="aidsConcav_+3A_header">header</code></td>
<td>
<p>logical. Print a header?</p>
</td></tr>
<tr><td><code id="aidsConcav_+3A_...">...</code></td>
<td>
<p>currently unused.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If argument <code>shareNames</code> is specified,
observed shares are used for the calculation of the 'C' matrices
to check for concavity;
if argument <code>shareNames</code> is <code>NULL</code> (e.g., not specified),
fitted shares are used for the calculation of the 'C' matrices.
</p>
<p>Please note that checking concavity of the expenditure function requires
that the expenditure function of the model exists.
Therefore, the concavity condition can be checked,
only if the symmetry condition is fulfilled and
the translog price index is used.
</p>


<h3>Value</h3>

<p><code>aidsConcav</code> returns a list of class <code>aidsConcav</code>
that contains following elements:
</p>
<table>
<tr><td><code>concavity</code></td>
<td>
<p>a logical vector indicating whether the concavity
condition is fulfilled at each observation.</p>
</td></tr>
<tr><td><code>nValidObs</code></td>
<td>
<p>number of (valid) observation at which concavity
could be checked.</p>
</td></tr>
<tr><td><code>nConcavObs</code></td>
<td>
<p>number of observation at which the concavity codition
is fulfilled.</p>
</td></tr>
<tr><td><code>concavPercent</code></td>
<td>
<p>percent of observations where the concavity condition is
fulfilled.</p>
</td></tr>
<tr><td><code>cMatrices</code></td>
<td>
<p>a list of the 'C' matrices for each observation to check
for concavity (see Deaton and Muellbauer, 1980b, p.76 ).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arne Henningsen</p>


<h3>References</h3>

<p>Deaton, A.S. and J. Muellbauer (1980a)
An Almost Ideal Demand System.
<em>American Economic Review</em>, 70, p. 312-326.
</p>
<p>Deaton, A.S. and J. Muellbauer (1980b)
<em>Economics and Consumer Behavior</em>,
Cambridge University Press, Cambridge.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aidsEst">aidsEst</a></code>, <code><a href="#topic+aidsElas">aidsElas</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>   data( Blanciforti86 )
   # Data on food consumption are available only for the first 32 years
   Blanciforti86 &lt;- Blanciforti86[ 1:32, ]

   priceNames &lt;- c( "pFood1", "pFood2", "pFood3", "pFood4" )
   shareNames &lt;- c( "wFood1", "wFood2", "wFood3", "wFood4" )

   # estimate the AIDS
   estResult &lt;- aidsEst( priceNames, shareNames, "xFood",
      data = Blanciforti86, method = "IL" )

   # check concavity with fitted shares
   aidsConcav( priceNames, "xFood", coef = estResult$coef,
      data = Blanciforti86 )

   # check concavity with observed shares
   aidsConcav( priceNames, "xFood", coef = estResult$coef,
      data = Blanciforti86, shareNames = shareNames )
</code></pre>

<hr>
<h2 id='aidsConsist'>Check Consistency of the AIDS</h2><span id='topic+aidsConsist'></span><span id='topic+print.aidsConsist'></span><span id='topic+checkConsist.aidsEst'></span>

<h3>Description</h3>

<p>Check whether the specification of the AIDS is consistent
with microeconomic demand theory (i.e. utility maximisation).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aidsConsist( priceNames, totExpName, coef, data,
   priceIndex = "TL", basePrices = NULL, baseShares = NULL,
   shareNames = NULL )

## S3 method for class 'aidsConsist'
print( x, ... )

## S3 method for class 'aidsEst'
checkConsist( object, observedShares = FALSE, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aidsConsist_+3A_pricenames">priceNames</code></td>
<td>
<p>a vector of strings containing the names of the prices.</p>
</td></tr>
<tr><td><code id="aidsConsist_+3A_totexpname">totExpName</code></td>
<td>
<p>a string containing the variable name of total expenditure.</p>
</td></tr>
<tr><td><code id="aidsConsist_+3A_coef">coef</code></td>
<td>
<p>a list containing the coefficients alpha, beta, gamma,
and (only for the translog price index) alpha0.</p>
</td></tr>
<tr><td><code id="aidsConsist_+3A_data">data</code></td>
<td>
<p>a data frame containing the data.</p>
</td></tr>
<tr><td><code id="aidsConsist_+3A_priceindex">priceIndex</code></td>
<td>
<p>a character string specifying the price index
(see <code><a href="#topic+aidsPx">aidsPx</a></code>)
or a numeric vector providing the log values of the price index
(passed to <code><a href="#topic+aidsMono">aidsMono</a></code>.</p>
</td></tr>
<tr><td><code id="aidsConsist_+3A_baseprices">basePrices</code></td>
<td>
<p>a vector specifying the base prices for the
Paasche, Laspeyres, and Tornqvist price index
(passed to <code><a href="#topic+aidsMono">aidsMono</a></code>.</p>
</td></tr>
<tr><td><code id="aidsConsist_+3A_baseshares">baseShares</code></td>
<td>
<p>a vector specifying the base expenditure shares for the
Laspeyres, simplified Laspeyres, and Tornqvist index
(passed to <code><a href="#topic+aidsMono">aidsMono</a></code>.</p>
</td></tr>
<tr><td><code id="aidsConsist_+3A_sharenames">shareNames</code></td>
<td>
<p>a vector of strings containing the names of the expenditure
shares (passed to <code><a href="#topic+aidsConcav">aidsConcav</a></code>.</p>
</td></tr>
<tr><td><code id="aidsConsist_+3A_x">x</code></td>
<td>
<p>an object of class <code>aidsConsist</code>.</p>
</td></tr>
<tr><td><code id="aidsConsist_+3A_object">object</code></td>
<td>
<p>an object of class <code>aidsEst</code>.</p>
</td></tr>
<tr><td><code id="aidsConsist_+3A_observedshares">observedShares</code></td>
<td>
<p>logical. Using observed shares? (see details).</p>
</td></tr>
<tr><td><code id="aidsConsist_+3A_...">...</code></td>
<td>
<p>currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>checkConsist</code> method for objects of class <code>aidsEst</code>
extracts all relevant elements from an object returned by <code>aidsEst</code>
and passes them as arguments to <code>aidsConsist</code>.
The optional argument <code>observedShares</code> determines
whether fitted (default) or observed expenditure shares are
used in the price index of the LA-AIDS to check monotonicity
and in the calculation of the subsitution matrix to check concavity.
</p>


<h3>Value</h3>

<p><code>aidsConsist</code> and the <code>checkConsist</code> method
return a list of class <code>aidsConsist</code>
that contains following elements:
</p>
<table>
<tr><td><code>addingUp</code></td>
<td>
<p>logical. Is the addinp-up condition fulfilled?</p>
</td></tr>
<tr><td><code>homogeneity</code></td>
<td>
<p>logical. Is the homogeneity condition fulfilled?</p>
</td></tr>
<tr><td><code>symmetry</code></td>
<td>
<p>logical. Is the symmetry condition fulfilled?</p>
</td></tr>
<tr><td><code>mono</code></td>
<td>
<p>an object returned by <code><a href="#topic+aidsMono">aidsMono</a></code>.</p>
</td></tr>
<tr><td><code>concav</code></td>
<td>
<p>an object returned by <code><a href="#topic+aidsMono">aidsMono</a></code>
(only if the symmetry condition is fulfilled and
the translog price index is used,
i.e. argument <code>priceIndex</code> is <code>"TL"</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arne Henningsen</p>


<h3>References</h3>

<p>Deaton, A.S. and J. Muellbauer (1980a)
An Almost Ideal Demand System.
<em>American Economic Review</em>, 70, p. 312-326.
</p>
<p>Deaton, A.S. and J. Muellbauer (1980b)
<em>Economics and Consumer Behavior</em>,
Cambridge University Press, Cambridge.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aidsEst">aidsEst</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>   data( Blanciforti86 )
   # Data on food consumption are available only for the first 32 years
   Blanciforti86 &lt;- Blanciforti86[ 1:32, ]

   priceNames &lt;- c( "pFood1", "pFood2", "pFood3", "pFood4" )
   shareNames &lt;- c( "wFood1", "wFood2", "wFood3", "wFood4" )

   estResult &lt;- aidsEst( priceNames, shareNames, "xFood",
      data = Blanciforti86, method = "IL" )
   aidsConsist( priceNames, "xFood", data = Blanciforti86,
      coef = estResult$coef )

   # the same can be obtained in an easier way
   checkConsist( estResult )
</code></pre>

<hr>
<h2 id='aidsElas'> Elasticities of the AIDS model </h2><span id='topic+aidsElas'></span><span id='topic+elas.aidsEst'></span><span id='topic+print.aidsElas'></span>

<h3>Description</h3>

<p>These functions calculate and print
the demand elasticities of an AIDS model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   aidsElas( coef, prices = NULL, shares = NULL, totExp = NULL,
      method = "AIDS", priceIndex = "TL", basePrices = NULL, baseShares = NULL,
      quantNames = NULL, priceNames = NULL, shifterValues = NULL, 
      coefCov = NULL, df = NULL )

   ## S3 method for class 'aidsEst'
elas( object, method = NULL, observedShares = FALSE, ... )

   ## S3 method for class 'aidsElas'
print( x, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aidsElas_+3A_coef">coef</code></td>
<td>
<p>a list containing the coefficients alpha, beta and gamma.</p>
</td></tr>
<tr><td><code id="aidsElas_+3A_prices">prices</code></td>
<td>
<p>a vector of the prices at which the elasticities should be calculated.</p>
</td></tr>
<tr><td><code id="aidsElas_+3A_shares">shares</code></td>
<td>
<p>a vector of the shares at which the elasticities should be calculated.</p>
</td></tr>
<tr><td><code id="aidsElas_+3A_totexp">totExp</code></td>
<td>
<p>total expenditure at which the elasticities should be calculated.</p>
</td></tr>
<tr><td><code id="aidsElas_+3A_method">method</code></td>
<td>
<p>the elasticity formula to be used (see details).</p>
</td></tr>
<tr><td><code id="aidsElas_+3A_priceindex">priceIndex</code></td>
<td>
<p>the price index (see details).</p>
</td></tr>
<tr><td><code id="aidsElas_+3A_baseprices">basePrices</code></td>
<td>
<p>a vector specifying the base prices for the
Paasche, Laspeyres, and Tornqvist price index.</p>
</td></tr>
<tr><td><code id="aidsElas_+3A_baseshares">baseShares</code></td>
<td>
<p>a vector specifying the base expenditure shares for the
Laspeyres, simplified Laspeyres, and Tornqvist index.</p>
</td></tr>
<tr><td><code id="aidsElas_+3A_quantnames">quantNames</code></td>
<td>
<p>an optional vector of strings containing the names of
the quantities to label elasticities.</p>
</td></tr>
<tr><td><code id="aidsElas_+3A_pricenames">priceNames</code></td>
<td>
<p>an optional vector of strings containing the names of
the prices to label elasticities.</p>
</td></tr>
<tr><td><code id="aidsElas_+3A_shiftervalues">shifterValues</code></td>
<td>
<p>a vector of values of the shifter variables,
at which the elasticities should be calculated.</p>
</td></tr>
<tr><td><code id="aidsElas_+3A_coefcov">coefCov</code></td>
<td>
<p>variance covariance matrix of the coefficients (optional).</p>
</td></tr>
<tr><td><code id="aidsElas_+3A_df">df</code></td>
<td>
<p>degrees of freedom to calculate P-values of the elasticities 
(optional).</p>
</td></tr>
<tr><td><code id="aidsElas_+3A_object">object</code></td>
<td>
<p>an object of class <code>aidsEst</code>.</p>
</td></tr>
<tr><td><code id="aidsElas_+3A_observedshares">observedShares</code></td>
<td>
<p>logical. Using observed shares for calculating the
demand elasticities?</p>
</td></tr>
<tr><td><code id="aidsElas_+3A_x">x</code></td>
<td>
<p>an object of class <code>aidsElas</code>.</p>
</td></tr>
<tr><td><code id="aidsElas_+3A_...">...</code></td>
<td>
<p>additional arguments of <code>elas.aidsEst</code>
are passed to <code>aidsEla</code>;
additional arguments of <code>print.aidsElas</code>
are currently ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Argument <code>priceIndex</code> has two effects:
first it determines the price index that is used
for calculating (fitted) expenditure shares,
if argument <code>shares</code> is not provided (see <code><a href="#topic+aidsCalc">aidsCalc</a></code>);
second it determines which version of the formulas for calculating
demand elasticities of the LA-AIDS are used,
because formulas <code>B1</code>/<code>LA</code>, <code>B2</code>, and <code>Go</code>/<code>Ch</code>
have different versions depending on the price index.
</p>
<p><code>elas.aidsEst</code> is a wrapper function to <code>aidsElas</code>
that extracts the
estimated coefficients (<code>coef</code>),
mean expenditure shares (<code>wMeans</code>),
mean prices (<code>pMeans</code>),
names of the prices (<code>priceNames</code>),
estimated coefficient variance covariance matrix (<code>coef$allcov</code>), and
degrees of freedom (<code>est$df</code>)
from the object of class <code>aidsEst</code>
and passes them to <code>aidsElas</code>.
If argument <code>method</code> in <code>elas.aidsEst</code> is not specified,
the default value depends on the estimation method.
If the demand system was estimated by the linear approximation (LA),
the default method is 'Ch'.
If the demand system was estimated by the iterative linear least squares
estimator (ILLE),
the default method is 'AIDS'.
</p>
<p>At the moment the elasticity formulas of the orginal AIDS (<code>AIDS</code>),
the formula of Goddard (1983) or Chalfant (1987) (<code>Go</code> or <code>Ch</code>),
the formula of Eales and Unnevehr (1988) (<code>EU</code>),
the formula of Green and Alston (1990) or the first of Buse (1994)
(<code>GA</code> or <code>B1</code>) and
the second formula of Buse (1994) (<code>B2</code>)
are implemented.
</p>
<p>The variance covariance matrices of the elasticities are calculated using
the formula of Klein (1953, p. 258) (also known as the delta method).
At the moment this is implemented only for the elasticity formulas of the 
orginal AIDS.
</p>


<h3>Value</h3>

<p>a list of class <code>aidsElas</code> containing following elements:
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>the elasticity formula used to calculate these elasticities.</p>
</td></tr>
<tr><td><code>priceIndex</code></td>
<td>
<p>the price index used (see details).</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom to calculate P-values of the elasticities
(only if argument <code>df</code> is provided).</p>
</td></tr>
<tr><td><code>exp</code></td>
<td>
<p>vector of expenditure elasticities.</p>
</td></tr>
<tr><td><code>hicks</code></td>
<td>
<p>matrix of Hicksian (compensated) price elasticities.</p>
</td></tr>
<tr><td><code>marshall</code></td>
<td>
<p>matrix of Marshallian (uncompensated) price elasticities.</p>
</td></tr>
<tr><td><code>allVcov</code></td>
<td>
<p>variance covariance matrix of all elasticities.</p>
</td></tr>
<tr><td><code>expVcov</code></td>
<td>
<p>variance covariance matrix of the expenditure elasticities.</p>
</td></tr>
<tr><td><code>hicksVcov</code></td>
<td>
<p>variance covariance matrix of the Hicksian (compensated) 
price elasticities.</p>
</td></tr>
<tr><td><code>marshallVcov</code></td>
<td>
<p>variance covariance matrix of the Marshallian 
(uncompensated) price elasticities.</p>
</td></tr>
<tr><td><code>expStEr</code></td>
<td>
<p>standard errors of the expenditure elasticities.</p>
</td></tr>
<tr><td><code>hicksStEr</code></td>
<td>
<p>standard errors of the Hicksian (compensated) price 
elasticities.</p>
</td></tr>
<tr><td><code>marshallStEr</code></td>
<td>
<p>standard errors of the Marshallian (uncompensated) 
price elasticities.</p>
</td></tr>
<tr><td><code>expTval</code></td>
<td>
<p>t-values of the expenditure elasticities.</p>
</td></tr>
<tr><td><code>hicksTval</code></td>
<td>
<p>t-values of the Hicksian (compensated) price elasticities.</p>
</td></tr>
<tr><td><code>marshallTval</code></td>
<td>
<p>t-values of the Marshallian (uncompensated) price 
elasticities.</p>
</td></tr>
<tr><td><code>expPval</code></td>
<td>
<p>P-values of the expenditure elasticities.</p>
</td></tr>
<tr><td><code>hicksPval</code></td>
<td>
<p>P-values of the Hicksian (compensated) price elasticities.</p>
</td></tr>
<tr><td><code>marshallPval</code></td>
<td>
<p>P-values of the Marshallian (uncompensated) price 
elasticities.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arne Henningsen</p>


<h3>References</h3>

<p>Chalfant, J.A. (1987)
A Globally Flexible, Almost Ideal Demand System.
<em>Journal of Business and Economic Statistics</em>, 5, p. 233-242.
</p>
<p>Deaton, A.S. and J. Muellbauer (1980)
An Almost Ideal Demand System.
<em>American Economic Review</em>, 70, p. 312-326.
</p>
<p>Eales J.S. and L.J. Unnevehr (1988)
Demand for beef and chicken products: separability and structural change.
<em>American Journal of Agricultural Economics</em>, 70, p. 521-532.
</p>
<p>Klein L.R. (1953)
<em>A Textbook of Econometrics</em>. Row, Petersen and Co., New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aidsEst">aidsEst</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>   data( Blanciforti86 )
   # Data on food consumption are available only for the first 32 years
   Blanciforti86 &lt;- Blanciforti86[ 1:32, ]

   estResult &lt;- aidsEst( c( "pFood1", "pFood2", "pFood3", "pFood4" ),
      c( "wFood1", "wFood2", "wFood3", "wFood4" ), "xFood",
      data = Blanciforti86 )
   wMeans &lt;- colMeans( Blanciforti86[ , c( "wFood1", "wFood2",
      "wFood3", "wFood4" ) ] )
   aidsElas( estResult$coef, shares = wMeans, method = "Ch",
      priceIndex = "S" )

   ## Repeating the evaluation of different elasticity formulas of
   ## Green &amp; Alston (1990)
   priceNames &lt;- c( "pFood1", "pFood2", "pFood3", "pFood4" )
   shareNames &lt;- c( "wFood1", "wFood2", "wFood3", "wFood4" )

   # AIDS estimation and elasticities
   estResultA &lt;- aidsEst( priceNames, shareNames, "xFood",
      data = Blanciforti86[ -1, ],
      method = "IL", maxiter = 100 )
   diag( elas( estResultA, method = "AIDS" )$marshall )
   summary( elas( estResultA, method = "AIDS" ) )

   # LA-AIDS estimation
   estResultLA &lt;- aidsEst( priceNames, shareNames, "xFood",
      data = Blanciforti86, priceIndex = "SL", maxiter = 100 )

   # LA-AIDS + formula of AIDS
   diag( elas( estResultLA, method = "AIDS" )$marshall )

   # LA-AIDS + formula of Eales + Unnevehr
   diag( elas( estResultLA, method = "EU" )$marshall )

   # LA-AIDS + formula of Goddard or Chalfant:
   diag( elas( estResultLA, method = "Go" )$marshall )
   diag( elas( estResultLA, method = "Ch" )$marshall )

   # LA-AIDS + formula of Green + Alston (= 1st of Buse):
   diag( elas( estResultLA, method = "GA" )$marshall )
</code></pre>

<hr>
<h2 id='aidsEst'>Estimating the Almost Ideal Demand System (AIDS) </h2><span id='topic+aidsEst'></span><span id='topic+print.aidsEst'></span>

<h3>Description</h3>

<p><code>aidsEst</code> does an econometric estimation
of the Almost Ideal Demand System (AIDS)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aidsEst( priceNames, shareNames, totExpName, data,
      method = "LA", priceIndex = "Ls", pxBase = 1,
      hom = TRUE, sym = TRUE,
      shifterNames = NULL, instNames = NULL,
      estMethod = ifelse( is.null( instNames ), "SUR", "3SLS" ),
      ILmaxiter = 50, ILtol = 1e-5, alpha0 = 0, restrict.regMat = FALSE, ... )

## S3 method for class 'aidsEst'
print( x, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aidsEst_+3A_pricenames">priceNames</code></td>
<td>
<p>a vector of strings containing the names of the prices.</p>
</td></tr>
<tr><td><code id="aidsEst_+3A_sharenames">shareNames</code></td>
<td>
<p>a vector of strings containing the names of the expenditure
shares.</p>
</td></tr>
<tr><td><code id="aidsEst_+3A_totexpname">totExpName</code></td>
<td>
<p>a string containing the variable name of total expenditure.</p>
</td></tr>
<tr><td><code id="aidsEst_+3A_data">data</code></td>
<td>
<p>a data frame containing all required variables.</p>
</td></tr>
<tr><td><code id="aidsEst_+3A_method">method</code></td>
<td>
<p>character string specifying the method to estimate the AIDS:
either 'LA' or 'IL' (see deatils).</p>
</td></tr>
<tr><td><code id="aidsEst_+3A_priceindex">priceIndex</code></td>
<td>
<p>character string specifying the price index
for the 'Linear Approximation':
either 'S', 'SL', 'P', 'L', 'Ls', or 'T' (see details).</p>
</td></tr>
<tr><td><code id="aidsEst_+3A_pxbase">pxBase</code></td>
<td>
<p>The base to calculate the LA-AIDS price indices
(see <code><a href="#topic+aidsPx">aidsPx</a></code>).</p>
</td></tr>
<tr><td><code id="aidsEst_+3A_hom">hom</code></td>
<td>
<p>logical. Should the homogeneity condition be imposed?</p>
</td></tr>
<tr><td><code id="aidsEst_+3A_sym">sym</code></td>
<td>
<p>logical. Should the symmetry condition be imposed?</p>
</td></tr>
<tr><td><code id="aidsEst_+3A_shifternames">shifterNames</code></td>
<td>
<p>an optional vector of strings containing the names of
the demand shifters.</p>
</td></tr>
<tr><td><code id="aidsEst_+3A_instnames">instNames</code></td>
<td>
<p>a vector of strings containing the names of instrumental
variables.</p>
</td></tr>
<tr><td><code id="aidsEst_+3A_estmethod">estMethod</code></td>
<td>
<p>estimation method (e.g. 'SUR' or '3SLS',
see <code><a href="systemfit.html#topic+systemfit">systemfit</a></code>).</p>
</td></tr>
<tr><td><code id="aidsEst_+3A_ilmaxiter">ILmaxiter</code></td>
<td>
<p>maximum number of iterations of the
'Iterated Linear Least Squares Estimation'.</p>
</td></tr>
<tr><td><code id="aidsEst_+3A_iltol">ILtol</code></td>
<td>
<p>tolerance level of the 'Iterated Linear Least Squares
Estimation'.</p>
</td></tr>
<tr><td><code id="aidsEst_+3A_alpha0">alpha0</code></td>
<td>
<p>the intercept of the translog price index (<code class="reqn">\alpha_0</code>).</p>
</td></tr>
<tr><td><code id="aidsEst_+3A_restrict.regmat">restrict.regMat</code></td>
<td>
<p>logical. Method to impose homogeneity and symmetry restrictions:
either via restrict.matrix (default) or via restrict.regMat
(see <code><a href="systemfit.html#topic+systemfit">systemfit</a></code>).</p>
</td></tr>
<tr><td><code id="aidsEst_+3A_x">x</code></td>
<td>
<p>An object of class <code>aidsEst</code>.</p>
</td></tr>
<tr><td><code id="aidsEst_+3A_...">...</code></td>
<td>
<p>additional arguments of <code>aidsEst</code> are passed to
<code><a href="systemfit.html#topic+systemfit">systemfit</a></code>;
additional arguments of <code>print.aidsEst</code> are currently ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Argument <code>method</code> can specify two different estimation methods:
The 'Linear Approximate AIDS' (LA) and the 'Iterative Linear Least Squares
Estimator' (IL) proposed by Blundell and Robin (1999).<br />
Argument <code>priceIndex</code> can specify six different price indices
for the LA-AIDS:
</p>

<ul>
<li><p> Stone price index ('S'),
</p>
</li>
<li><p> Stone price index with lagged shares ('SL'),
</p>
</li>
<li><p> loglinear analogue to the Paasche price index ('P'),
</p>
</li>
<li><p> loglinear analogue of the Laspeyres price index ('L'),
</p>
</li>
<li><p> simplified loglinear analogue of the Laspeyres price index ('Ls'), and
</p>
</li>
<li><p> Tornqvist price index ('T').
</p>
</li></ul>

<p>The 'Iterative Linear Least Squares Estimator' (IL) needs starting
values for the (translog) price index.
Starting values are taken from an initial estimation
of the 'Linear Approximate AIDS' (LA) with the price index
specified by argument <code>priceIndex</code>.
</p>


<h3>Value</h3>

<p>a list of class <code>aidsEst</code> containing following objects:
</p>
<table>
<tr><td><code>coef</code></td>
<td>
<p>a list containing the vectors/matrix of the estimated
coefficients (alpha, beta, and gamma).</p>
</td></tr>
<tr><td><code>r2</code></td>
<td>
<p><code class="reqn">R^2</code>-values of all share equations.</p>
</td></tr>
<tr><td><code>r2q</code></td>
<td>
<p><code class="reqn">R^2</code>-values of the estimated quantities.</p>
</td></tr>
<tr><td><code>wFitted</code></td>
<td>
<p>fitted expenditure shares.</p>
</td></tr>
<tr><td><code>wResid</code></td>
<td>
<p>residuals of the expenditure shares.</p>
</td></tr>
<tr><td><code>qObs</code></td>
<td>
<p>observed quantities / quantitiy indices.</p>
</td></tr>
<tr><td><code>qFitted</code></td>
<td>
<p>fitted quantities / quantitiy indices.</p>
</td></tr>
<tr><td><code>qResid</code></td>
<td>
<p>residuals of the estimated quantities.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>estimation result, i.e. the object returned
by <code><a href="systemfit.html#topic+systemfit">systemfit</a></code>.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>iterations of SUR/3SLS estimation(s).
If the AIDS is estimated by the 'Iterated Linear Least Squares
Estimator' (ILLE):
a vector containing the SUR/3SLS iterations at each iteration.</p>
</td></tr>
<tr><td><code>ILiter</code></td>
<td>
<p>number of iterations of the 'Iterated Linear Least Squares
Estimation'.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the method used to estimate the aids (see details).</p>
</td></tr>
<tr><td><code>priceIndex</code></td>
<td>
<p>the name of the price index (see details).</p>
</td></tr>
<tr><td><code>lnp</code></td>
<td>
<p>log of the price index used for estimation.</p>
</td></tr>
<tr><td><code>pMeans</code></td>
<td>
<p>means of the prices.</p>
</td></tr>
<tr><td><code>wMeans</code></td>
<td>
<p>means of the expenditure shares.</p>
</td></tr>
<tr><td><code>xtMean</code></td>
<td>
<p>mean of total expenditure.</p>
</td></tr>
<tr><td><code>sMeans</code></td>
<td>
<p>means of shifter variables (only if shifter variables are used).</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the call of <code>aidsEst</code>.</p>
</td></tr>
<tr><td><code>priceNames</code></td>
<td>
<p>names of the prices.</p>
</td></tr>
<tr><td><code>shareNames</code></td>
<td>
<p>names of the expenditure shares.</p>
</td></tr>
<tr><td><code>totExpName</code></td>
<td>
<p>name of the variable for total expenditure.</p>
</td></tr>
<tr><td><code>basePrices</code></td>
<td>
<p>the base prices of the Paasche, Laspeyres,
or Tornqvist price index.</p>
</td></tr>
<tr><td><code>baseShares</code></td>
<td>
<p>the base shares of the Laspeyres, simplified Laspeyres,
or Tornqvist price index.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arne Henningsen</p>


<h3>References</h3>

<p>Deaton, A.S. and J. Muellbauer (1980)
An Almost Ideal Demand System.
<em>American Economic Review</em>, 70, p. 312-326.
</p>
<p>Blundell, R. and J.M. Robin (1999)
Estimationin Large and Disaggregated Demand Systems:
An Estimator for Conditionally Linear Systems.
<em>Journal of Applied Econometrics</em>, 14, p. 209-232.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.aidsEst">summary.aidsEst</a></code>, <code><a href="#topic+aidsElas">aidsElas</a></code>,
<code><a href="#topic+aidsCalc">aidsCalc</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>   # Using data published in Blanciforti, Green &amp; King (1986)
   data( Blanciforti86 )
   # Data on food consumption are available only for the first 32 years
   Blanciforti86 &lt;- Blanciforti86[ 1:32, ]

   ## Repeating the demand analysis of Blanciforti, Green &amp; King (1986)
   ## Note: Blanciforti, Green &amp; King (1986) use scaled data,
   ##       which leads to slightly different results
   estResult &lt;- aidsEst( c( "pFood1", "pFood2", "pFood3", "pFood4" ),
      c( "wFood1", "wFood2", "wFood3", "wFood4" ), "xFood",
      data = Blanciforti86, priceIndex = "SL", maxiter = 100 )
   print( estResult )
   elas( estResult )

   ## Estimations with a demand shifter: linear trend
   priceNames &lt;- c( "pFood1", "pFood2", "pFood3", "pFood4" )
   shareNames &lt;- c( "wFood1", "wFood2", "wFood3", "wFood4" )
   Blanciforti86$trend &lt;- c( 0:( nrow( Blanciforti86 ) - 1 ) )
   estResult &lt;- aidsEst( priceNames, shareNames, "xFood",
      data = Blanciforti86, shifterNames = "trend" )
   print( estResult )

   # Estimations with two demand shifters: linear + quadratic trend
   Blanciforti86$trend2 &lt;- c( 0:( nrow( Blanciforti86 ) - 1 ) )^2
   estResult &lt;- aidsEst( priceNames, shareNames, "xFood",
      data = Blanciforti86, shifterNames = c( "trend", "trend2" ) )
   print( estResult )
</code></pre>

<hr>
<h2 id='aidsMono'>Monotonicity of the AIDS</h2><span id='topic+aidsMono'></span><span id='topic+print.aidsMono'></span>

<h3>Description</h3>

<p><code>aidsMono</code> checks whether the expenditure function
of an estimated Almost Ideal Demand System (AIDS)
is monotonic increasing in prices,
which implies that all demanded quantities and expenditure shares
are non-negative.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aidsMono( priceNames, totExpName, coef, data,
   priceIndex = "TL", basePrices = NULL, baseShares = NULL )

## S3 method for class 'aidsMono'
print( x, header = TRUE, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aidsMono_+3A_pricenames">priceNames</code></td>
<td>
<p>a vector of strings containing the names of the prices.</p>
</td></tr>
<tr><td><code id="aidsMono_+3A_totexpname">totExpName</code></td>
<td>
<p>a string containing the variable name of total expenditure.</p>
</td></tr>
<tr><td><code id="aidsMono_+3A_coef">coef</code></td>
<td>
<p>a list containing the coefficients alpha, beta, gamma,
and (only for the translog price index) alpha0.</p>
</td></tr>
<tr><td><code id="aidsMono_+3A_data">data</code></td>
<td>
<p>a data frame containing the data.</p>
</td></tr>
<tr><td><code id="aidsMono_+3A_priceindex">priceIndex</code></td>
<td>
<p>a character string specifying the price index
(see <code><a href="#topic+aidsPx">aidsPx</a></code>)
or a numeric vector providing the log values of the price index.</p>
</td></tr>
<tr><td><code id="aidsMono_+3A_baseprices">basePrices</code></td>
<td>
<p>a vector specifying the base prices for the
Paasche, Laspeyres, and Tornqvist price index.</p>
</td></tr>
<tr><td><code id="aidsMono_+3A_baseshares">baseShares</code></td>
<td>
<p>a vector specifying the base expenditure shares for the
Laspeyres, simplified Laspeyres, and Tornqvist index.</p>
</td></tr>
<tr><td><code id="aidsMono_+3A_x">x</code></td>
<td>
<p>an object of class <code>aidsMono</code>.</p>
</td></tr>
<tr><td><code id="aidsMono_+3A_header">header</code></td>
<td>
<p>logical. Print a header?</p>
</td></tr>
<tr><td><code id="aidsMono_+3A_...">...</code></td>
<td>
<p>currently unused.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Internally, <code>aidsMono</code> passes its arguments to <code>aidsCalc</code>
and then checks for each observation, wether all expenditure shares
are non-negative.
</p>
<p>If argument <code>priceIndex</code> specifies a price index of the LA-AIDS,
'fitted' values are used for current and lagged expenditure shares
in these price indices
(see <code><a href="#topic+aidsCalc">aidsCalc</a></code>).
However, if argument <code>priceIndex</code> is a numeric vector
containing the log values of a price index
(e.g.\ the price index used in the estimation),
this price index is used for the calculations.
</p>


<h3>Value</h3>

<p><code>aidsMono</code> returns a list of class <code>aidsMono</code>
that contains following elements:
</p>
<table>
<tr><td><code>monotony</code></td>
<td>
<p>a logical vector indicating whether the monotony
condition is fulfilled at each observation.</p>
</td></tr>
<tr><td><code>nValidObs</code></td>
<td>
<p>number of (valid) observation at which monotonicity
could be checked.</p>
</td></tr>
<tr><td><code>nMonoObs</code></td>
<td>
<p>number of observation at which the monotonicity codition
is fulfilled.</p>
</td></tr>
<tr><td><code>monoPercent</code></td>
<td>
<p>percent of observations where the monotony condition is
fulfilled.</p>
</td></tr>
<tr><td><code>priceIndex</code></td>
<td>
<p>a chacter string indicating the price index
specified by argument <code>priceIndex</code>
(<code>"numeric"</code> if the price index is specified numerically).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arne Henningsen</p>


<h3>References</h3>

<p>Deaton, A.S. and J. Muellbauer (1980a)
An Almost Ideal Demand System.
<em>American Economic Review</em>, 70, p. 312-326.
</p>
<p>Deaton, A.S. and J. Muellbauer (1980b)
<em>Economics and Consumer Behavior</em>,
Cambridge University Press, Cambridge.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aidsEst">aidsEst</a></code>, <code><a href="#topic+aidsCalc">aidsCalc</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>   data( Blanciforti86 )
   # Data on food consumption are available only for the first 32 years
   Blanciforti86 &lt;- Blanciforti86[ 1:32, ]

   priceNames &lt;- c( "pFood1", "pFood2", "pFood3", "pFood4" )
   shareNames &lt;- c( "wFood1", "wFood2", "wFood3", "wFood4" )

   ## AIDS
   estResult &lt;- aidsEst( priceNames, shareNames, "xFood",
      data = Blanciforti86, method = "IL" )
   aidsMono( priceNames, "xFood", coef = coef( estResult ),
      data = Blanciforti86 )

   ## LA-AIDS with Tornqvist price index
   estResultLaT &lt;- aidsEst( priceNames, shareNames, "xFood",
      data = Blanciforti86, priceIndex = "T" )
   # with fitted expenditure shares in the price index
   aidsMono( priceNames, "xFood", coef = coef( estResultLaT ),
      data = Blanciforti86, priceIndex = "T",
      basePrices = estResultLaT$basePrices,
      baseShares = estResultLaT$baseShares )
   # with observed expenditure shares in the price index
   aidsMono( priceNames, "xFood", coef = coef( estResultLaT ),
      data = Blanciforti86, priceIndex = estResultLaT$lnp )
</code></pre>

<hr>
<h2 id='aidsPx'> Price Index for the AIDS </h2><span id='topic+aidsPx'></span>

<h3>Description</h3>

<p>Calculate log price indices for the AIDS and LA-AIDS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   aidsPx( priceIndex, priceNames, data, shareNames = NULL, base = 1, coef = NULL,
      shifterNames = NULL )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aidsPx_+3A_priceindex">priceIndex</code></td>
<td>
<p>the price index to be used (see details).</p>
</td></tr>
<tr><td><code id="aidsPx_+3A_pricenames">priceNames</code></td>
<td>
<p>a vector of strings containing the names of the prices.</p>
</td></tr>
<tr><td><code id="aidsPx_+3A_data">data</code></td>
<td>
<p>a data frame containing the required variables.</p>
</td></tr>
<tr><td><code id="aidsPx_+3A_sharenames">shareNames</code></td>
<td>
<p>a vector of strings containing the names of the expenditure
shares.</p>
</td></tr>
<tr><td><code id="aidsPx_+3A_base">base</code></td>
<td>
<p>the base to calculate the indices (see details).</p>
</td></tr>
<tr><td><code id="aidsPx_+3A_coef">coef</code></td>
<td>
<p>a list containing the coefficients alpha0, alpha, beta, and gamma
(only needed for the translog price index).</p>
</td></tr>
<tr><td><code id="aidsPx_+3A_shifternames">shifterNames</code></td>
<td>
<p>an optional vector of strings containing the names of
the demand shifters
that modify the alphas of the Translog price index.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently 7 different price indices are implemented:
</p>

<ul>
<li><p> translog price index ('TL'),
</p>
</li>
<li><p> Stone price index ('S'),
</p>
</li>
<li><p> Stone price index with lagged shares ('SL'),
</p>
</li>
<li><p> loglinear analogue to the Paasche price index ('P'),
</p>
</li>
<li><p> loglinear analogue of the Laspeyres price index ('L'),
</p>
</li>
<li><p> simplified loglinear analogue of the Laspeyres price index ('Ls'), and
</p>
</li>
<li><p> Tornqvist price index ('T').
</p>
</li></ul>

<p>The argument <code>base</code> can be either
</p>

<ul>
<li><p> a single number: the row number of the base prices and quantities,
</p>
</li>
<li><p> a vector indicating several observations: The means of these
observations are used as base prices and quantities, or
</p>
</li>
<li><p> a logical vector with the same length as the <code>data</code>: The
means of the observations indicated as 'TRUE' are used as base prices
and quantities.
</p>
</li>
<li><p> a list with elements <code>prices</code> and/or <code>shares</code>
that are numeric vectors specifying the values of the base prices
and/or base expenditure shares.
</p>
</li></ul>



<h3>Value</h3>

<p>A vector containing the log price index.
If argument <code>priceIndex</code> is <code>"P"</code>, <code>"Ls"</code>, or <code>"T"</code>,
the returned vector has the attribute(s)
<code>basePrices</code> and/or <code>baseShares</code>
that are numeric vectors of the base prices and/or base expenditure shares
for calculating the price indices.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen</p>


<h3>References</h3>

<p>Deaton, A.S. and J. Muellbauer (1980)
An Almost Ideal Demand System.
<em>American Economic Review</em>, 70, p. 312-326.
</p>
<p>Moschini, G. (1995)
Units of Measurement and the Stone Index in Demand System Estimation.
<em>American Journal of Agricultural Economics</em>, 77, p. 63-68.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+aidsEst">aidsEst</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>   data( Blanciforti86 )

   # Stone price index
   aidsPx( "S", c( "pFood1", "pFood2", "pFood3", "pFood4" ),
      Blanciforti86, c( "wFood1", "wFood2", "wFood3", "wFood4" ) )

   # (log-linear analogue of the) Paasche price index
   aidsPx( "P", c( "pFood1", "pFood2", "pFood3", "pFood4" ),
      Blanciforti86, c( "wFood1", "wFood2", "wFood3", "wFood4" ),
      base = row.names(Blanciforti86) == "1970" )

   # Tornqvist price index
   aidsPx( "T", c( "pFood1", "pFood2", "pFood3", "pFood4" ),
      Blanciforti86, c( "wFood1", "wFood2", "wFood3", "wFood4" ),
      base = list( prices = rep( 100, 4 ), shares = rep( 0.25, 4 ) ) )
</code></pre>

<hr>
<h2 id='aidsUtility'>Indirect Utility Function of the Almost Ideal Demand System</h2><span id='topic+aidsUtility'></span><span id='topic+aidsUtilityDeriv'></span>

<h3>Description</h3>

<p>These functions calculate the utility level
given prices and total expenditure
using the indirect utility function
of the Almost Ideal Demand System
and the partial derivatives of this indirect utility function
with repect to prices and total expenditure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aidsUtility( priceNames, totExpName, coef, data )

aidsUtilityDeriv( priceNames, totExpName, coef, data, rel = FALSE )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aidsUtility_+3A_pricenames">priceNames</code></td>
<td>
<p>a vector of strings containing the names of the prices.</p>
</td></tr>
<tr><td><code id="aidsUtility_+3A_totexpname">totExpName</code></td>
<td>
<p>a string containing the variable name of total expenditure.</p>
</td></tr>
<tr><td><code id="aidsUtility_+3A_coef">coef</code></td>
<td>
<p>a list containing the coefficients in elements
alpha0 (scalar), alpha (vector), beta (vector), gamma (matrix),
and possibly beta0 (scalar, if not given, it is assumed to be 1).</p>
</td></tr>
<tr><td><code id="aidsUtility_+3A_data">data</code></td>
<td>
<p>a data frame containing the data.</p>
</td></tr>
<tr><td><code id="aidsUtility_+3A_rel">rel</code></td>
<td>
<p>logical. If <code>TRUE</code> the returned partial derivatives are
given in relative terms (like elasticities),
i.e.\ they indicate the percentage change in the utility level
when a price or total expenditure is increased by 1%.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>aidsUtility</code> returns a numeric vector
that contains the utility levels;
<code>aidsUtilityDeriv</code> returns a data.frame
that contains the partial derivatives
of the indirect utility function
with repect to prices and total expenditure.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen</p>


<h3>References</h3>

<p>Deaton, A.S. and J. Muellbauer (1980)
An Almost Ideal Demand System.
<em>American Economic Review</em>, 70, p. 312-326.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aidsEst">aidsEst</a></code>, <code><a href="#topic+aidsCalc">aidsCalc</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>   data( Blanciforti86 )
   # Data on food consumption are available only for the first 32 years
   Blanciforti86 &lt;- Blanciforti86[ 1:32, ]

   priceNames &lt;- c( "pFood1", "pFood2", "pFood3", "pFood4" )
   shareNames &lt;- c( "wFood1", "wFood2", "wFood3", "wFood4" )

   ## estimate the (non-linear) AIDS
   estResult &lt;- aidsEst( priceNames, shareNames, "xFood",
      data = Blanciforti86, method = "IL" )

   # calculate the utility levels of each year
   utility &lt;- aidsUtility( priceNames, "xFood", coef = coef( estResult ),
      data = Blanciforti86 )

   utilityDeriv &lt;- aidsUtilityDeriv( priceNames, "xFood",
      coef = coef( estResult ), data = Blanciforti86 )

   utilityEla &lt;- aidsUtilityDeriv( priceNames, "xFood",
      coef = coef( estResult ), data = Blanciforti86, rel = TRUE )
</code></pre>

<hr>
<h2 id='Blanciforti86'>U.S. consumption data</h2><span id='topic+Blanciforti86'></span>

<h3>Description</h3>

<p>The <code>Blanciforti86</code> data frame contains annual U.S. consumption data
from 1947 to 1978 or 1981.
These data include eleven aggregate commodity groups:
(1) food, (2) alcohol plus tobacco, (3) clothing, (4) housing,
(5) utilities, (6) transportation, (7) medical care, (8) durable goods,
(9) other nondurable goods, (10) other services, and
(11) other miscellaneous goods;
four food groups:
(1) meats, (2) fruits and vegetables, (3) cereal and bakery products, and
(4) miscellaneous foods;
and four meat groups:
(1) beef and veal, (2) pork, (3) fish, and (4) poultry.
For each of these groups the consumption expenditures, price indices,
and expenditure shares are available.
</p>
<p>This data frame contains the following variables / columns:
</p>

<dl>
<dt>year</dt><dd><p>The year.</p>
</dd>
<dt>xAggX</dt><dd><p>Expenditure on the aggregate commodity group X
(in Millions of US-Dollars).</p>
</dd>
<dt>xAgg</dt><dd><p>Total expenditure on all eleven aggregate commodity groups
(in Millions of US-Dollars).</p>
</dd>
<dt>xcAggX</dt><dd><p>Deflated expenditure on the aggregate commodity group X
(in Million of 1972 US-Dollars).</p>
</dd>
<dt>xcAgg</dt><dd><p>Total deflated expenditure on all eleven aggregate commodity
groups (in Million of 1972 US-Dollars).</p>
</dd>
<dt>pAggX</dt><dd><p>Price index for the aggregate commodity group X (1972 = 100).</p>
</dd>
<dt>wAggX</dt><dd><p>Expenditure share of the aggregate commodity group X.</p>
</dd>
<dt>xFoodX</dt><dd><p>Per capita expenditure for food group X (in US-Dollars).</p>
</dd>
<dt>xFood</dt><dd><p>Total per capita expenditure for all four food groups
(in US-Dollars).</p>
</dd>
<dt>xcFoodX</dt><dd><p>Deflated per capita expenditure for food group X
(in 1972 US-Dollars).</p>
</dd>
<dt>xcFood</dt><dd><p>Total deflated per capita expenditure for all four food
groups (in 1972 US-Dollars).</p>
</dd>
<dt>pFoodX</dt><dd><p>Price index for food group X (1972 = 100).</p>
</dd>
<dt>wFoodX</dt><dd><p>Expenditure share of food group X.</p>
</dd>
<dt>xFoodUsdoc</dt><dd><p>Expenditure on food published by the US Department of
Commerce (USDOC) (in Millions of US-Dollars).</p>
</dd>
<dt>xFoodUsda</dt><dd><p>Expenditure on food published by the US Department of
Agriculture (USDA) (in Millions of US-Dollars).</p>
</dd>
<dt>xFoodNew</dt><dd><p>Expenditure on food (new estimates)
(in Millions of US-Dollars).</p>
</dd>
<dt>xMeatX</dt><dd><p>Per capita expenditure for meat group X (in US-Dollars).</p>
</dd>
<dt>xMeat</dt><dd><p>Total per capita expenditure for all four meat groups
(in US-Dollars).</p>
</dd>
<dt>pMeatX</dt><dd><p>Price index for meat group X (1972 = 100).</p>
</dd>
<dt>cMeatX</dt><dd><p>Per capita consumption of meat group X (in pounds).</p>
</dd>
<dt>pMeat</dt><dd><p>Price index for the meat group (1972 = 100).</p>
</dd>
<dt>pMeatNew</dt><dd><p>Price index for the meat group (new estimate)
(1972 = 100).</p>
</dd>
<dt>population3</dt><dd><p>Population as presented in Table 5.A.3 (in  Millions).</p>
</dd>
<dt>population12</dt><dd><p>Population as presented in Table 5.A.12 (in  Millions).</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>data(Blanciforti86)</code></pre>


<h3>Source</h3>

<p>Blanciforti, Laura. A., Richard D. Green and Gordon A. King (1986)
U.S. Consumer Behavior Over the Postwar Period:
An Almost Ideal Demand System Analysis.
Giannini Foundation Monograph Number 40, August 1986.
</p>

<hr>
<h2 id='coef.aidsEst'>Coefficients of an Almost Ideal Demand System</h2><span id='topic+coef.aidsEst'></span><span id='topic+print.coef.aidsEst'></span>

<h3>Description</h3>

<p>These methods return and print the coefficients from
an Almost Ideal Demand System.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'aidsEst'
coef( object, ... )

   ## S3 method for class 'coef.aidsEst'
print( x, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.aidsEst_+3A_object">object</code></td>
<td>
<p>an object of class <code>aidsEst</code>.</p>
</td></tr>
<tr><td><code id="coef.aidsEst_+3A_x">x</code></td>
<td>
<p>an object of class <code>coef.aidsEst</code>.</p>
</td></tr>
<tr><td><code id="coef.aidsEst_+3A_...">...</code></td>
<td>
<p>further arguments for methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>coef</code> method returns an object of class <code>coef.aidsEst</code>
containing following objects:
</p>
<table>
<tr><td><code>alpha0</code></td>
<td>
<p>a scalar, coefficient alpha0
(only for the AIDS with translog price index).</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>a vector of the alpha coefficients.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>a vector of the beta coefficients.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>a matrix of the gamma coefficients.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>a matrix of the delta coefficients
(only if the model was estimated with demand shifters).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arne Henningsen</p>


<h3>See Also</h3>

<p><code><a href="#topic+aidsEst">aidsEst</a></code></p>

<hr>
<h2 id='df.residual.aidsEst'>Covariance matrix of an Almost Ideal Demand System</h2><span id='topic+df.residual.aidsEst'></span>

<h3>Description</h3>

<p>These method returns the covariance matrix of the coefficients from
an Almost Ideal Demand System (AIDS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'aidsEst'
df.residual( object, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df.residual.aidsEst_+3A_object">object</code></td>
<td>
<p>an object of class <code>aidsEst</code>.</p>
</td></tr>
<tr><td><code id="df.residual.aidsEst_+3A_...">...</code></td>
<td>
<p>currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>df.residual</code> method for objects of class <code>aidsEst</code>
returns a symmetric matrix: the covariance matrix of the coefficients.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen</p>


<h3>See Also</h3>

<p><code><a href="#topic+aidsEst">aidsEst</a></code>, <code><a href="#topic+coef.aidsEst">coef.aidsEst</a></code></p>

<hr>
<h2 id='fitted.aidsEst'>Fitted values of an Almost Ideal Demand System</h2><span id='topic+fitted.aidsEst'></span>

<h3>Description</h3>

<p>This method extracts the fitted demanded quantities and expenditure shares
from an estimated Almost Ideal Demand System.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'aidsEst'
fitted( object, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.aidsEst_+3A_object">object</code></td>
<td>
<p>an object of class <code>aidsEst</code>.</p>
</td></tr>
<tr><td><code id="fitted.aidsEst_+3A_...">...</code></td>
<td>
<p>currently unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>fitted</code> method returns a list
containing following objects:
</p>
<table>
<tr><td><code>shares</code></td>
<td>
<p>a data frame for the fitted expenditure shares.</p>
</td></tr>
<tr><td><code>quant</code></td>
<td>
<p>a data frame for the fitted demanded quantities.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arne Henningsen</p>


<h3>See Also</h3>

<p><code><a href="#topic+aidsEst">aidsEst</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>   # Using data published in Blanciforti, Green &amp; King (1986)
   data( Blanciforti86 )
   # Data on food consumption are available only for the first 32 years
   Blanciforti86 &lt;- Blanciforti86[ 1:32, ]

   estResult &lt;- aidsEst( c( "pFood1", "pFood2", "pFood3", "pFood4" ),
      c( "wFood1", "wFood2", "wFood3", "wFood4" ), "xFood",
      data = Blanciforti86 )
   fitted( estResult )
</code></pre>

<hr>
<h2 id='logLik.aidsEst'>Log-Likelihood value of an object of class aidsEst</h2><span id='topic+logLik.aidsEst'></span>

<h3>Description</h3>

<p>This method extracts the log-likelihood value
of a fitted Almost Ideal Demand System (AIDS)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aidsEst'
logLik( object, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.aidsEst_+3A_object">object</code></td>
<td>
<p>an object of class <code>aidsEst</code>.</p>
</td></tr>
<tr><td><code id="logLik.aidsEst_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric scalar (the log-likelihood value) with 2 attributes:
<code>nobs</code> (total number of observations in all equations) and
<code>df</code> (number of free parameters, i.e. coefficients
+ elements of the residual covariance matrix).
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen</p>


<h3>See Also</h3>

<p><code><a href="#topic+aidsEst">aidsEst</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>   # Using data published in Blanciforti, Green &amp; King (1986)
   data( Blanciforti86 )
   # Data on food consumption are available only for the first 32 years
   Blanciforti86 &lt;- Blanciforti86[ 1:32, ]

   ## Repeating the demand analysis of Blanciforti, Green &amp; King (1986)
   estResult &lt;- aidsEst( c( "pFood1", "pFood2", "pFood3", "pFood4" ),
      c( "wFood1", "wFood2", "wFood3", "wFood4" ), "xFood",
      data = Blanciforti86, priceIndex = "SL" )
   logLik( estResult )
</code></pre>

<hr>
<h2 id='lrtest.aidsEst'>Likelihood Ratio test for Almost Ideal Demand Systems</h2><span id='topic+lrtest.aidsEst'></span>

<h3>Description</h3>

<p>Testing hypothesis in Almost Ideal Demand Systems
by a Likelihood Ratio test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'aidsEst'
lrtest( object, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrtest.aidsEst_+3A_object">object</code></td>
<td>
<p>a fitted model object of class <code>aidsEst</code>.</p>
</td></tr>
<tr><td><code id="lrtest.aidsEst_+3A_...">...</code></td>
<td>
<p>further fitted model objects of class <code>aidsEst</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>lrtest.aidsEst</code> consecutively compares
the fitted model object <code>object</code>
with the models passed in <code>...</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>anova</code>,
which contains the log-likelihood value,
degrees of freedom, the difference in degrees of freedom,
likelihood ratio Chi-squared statistic and corresponding p value.
See documentation of <code><a href="lmtest.html#topic+lrtest">lrtest</a></code>
in package &quot;lmtest&quot;.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen</p>


<h3>See Also</h3>

<p><code><a href="#topic+aidsEst">aidsEst</a></code>, <code><a href="lmtest.html#topic+lrtest">lrtest</a></code>
(package &quot;lmtest&quot;),
<code><a href="#topic+logLik.aidsEst">logLik.aidsEst</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>   # Using data published in Blanciforti, Green &amp; King (1986)
   data( Blanciforti86 )
   # Data on food consumption are available only for the first 32 years
   Blanciforti86 &lt;- Blanciforti86[ 1:32, ]

   # names of prices and expenditure shares
   priceNames &lt;- c( "pFood1", "pFood2", "pFood3", "pFood4" )
   shareNames &lt;- c( "wFood1", "wFood2", "wFood3", "wFood4" )

   # estimation with symmetry and homogeneity imposed
   estResult &lt;- aidsEst( c( "pFood1", "pFood2", "pFood3", "pFood4" ),
      c( "wFood1", "wFood2", "wFood3", "wFood4" ), "xFood",
      data = Blanciforti86 )

   # estimation with only homogeneity imposed
   estResultHom &lt;- aidsEst( c( "pFood1", "pFood2", "pFood3", "pFood4" ),
      c( "wFood1", "wFood2", "wFood3", "wFood4" ), "xFood",
      data = Blanciforti86, sym = FALSE )

   # unrestricted estimation
   estResultUnr &lt;- aidsEst( c( "pFood1", "pFood2", "pFood3", "pFood4" ),
      c( "wFood1", "wFood2", "wFood3", "wFood4" ), "xFood",
      data = Blanciforti86, sym = FALSE, hom = FALSE )

   # LR tests
   lrtest( estResult, estResultHom, estResultUnr, estResult )

   ## Estimation with a demand shifter: linear trend
   Blanciforti86$trend &lt;- c( 0:( nrow( Blanciforti86 ) - 1 ) )
   estResultTrend &lt;- aidsEst( priceNames, shareNames, "xFood",
      data = Blanciforti86, shifterNames = "trend" )

   # LR tests
   lrtest( estResult, estResultTrend )
</code></pre>

<hr>
<h2 id='summary.aidsElas'>Summarizing the Elasticities of an Almost Ideal Demand System</h2><span id='topic+summary.aidsElas'></span><span id='topic+print.summary.aidsElas'></span>

<h3>Description</h3>

<p>These functions summarize and print the estimated elasticities
of an Almost Ideal Demand System (AIDS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aidsElas'
summary( object, ... )

## S3 method for class 'summary.aidsElas'
print( x, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.aidsElas_+3A_object">object</code></td>
<td>
<p>an object of class <code>aidsElas</code>.</p>
</td></tr>
<tr><td><code id="summary.aidsElas_+3A_x">x</code></td>
<td>
<p>an object of class <code>summary.aidsElas</code>.</p>
</td></tr>
<tr><td><code id="summary.aidsElas_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.aidsEst</code> returns a list of class <code>summary.aidsElas</code>.
It is identical to the provided <code>object</code> (except for its class),
but it contains following additional element:
</p>
<table>
<tr><td><code>table</code></td>
<td>
<p>a matrix with 4 columns: all elasticities,
their standard errors (if available), their t-values (if available),
and their P-values (if available).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arne Henningsen</p>


<h3>See Also</h3>

<p><code><a href="#topic+aidsElas">aidsElas</a></code>, <code><a href="#topic+aidsEst">aidsEst</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>   # Using data published in Blanciforti, Green &amp; King (1986)
   data( Blanciforti86 )
   # Data on food consumption are available only for the first 32 years
   Blanciforti86 &lt;- Blanciforti86[ 1:32, ]

   ## Repeating the demand analysis of Blanciforti, Green &amp; King (1986)
   estResult &lt;- aidsEst( c( "pFood1", "pFood2", "pFood3", "pFood4" ),
      c( "wFood1", "wFood2", "wFood3", "wFood4" ), "xFood",
      data = Blanciforti86, method = "IL" )
   summary( elas( estResult ) )
</code></pre>

<hr>
<h2 id='summary.aidsEst'>Summarizing the Estimation of an Almost Ideal Demand System</h2><span id='topic+summary.aidsEst'></span><span id='topic+print.summary.aidsEst'></span>

<h3>Description</h3>

<p><code>summary.aidsEst</code> summarizes the estimation results
of an Almost Ideal Demand System (AIDS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aidsEst'
summary( object, ... )

## S3 method for class 'summary.aidsEst'
print( x, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.aidsEst_+3A_object">object</code></td>
<td>
<p>an object of class <code>aidsEst</code>.</p>
</td></tr>
<tr><td><code id="summary.aidsEst_+3A_x">x</code></td>
<td>
<p>an object of class <code>summary.aidsEst</code>.</p>
</td></tr>
<tr><td><code id="summary.aidsEst_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.aidsEst</code> returns a list of class <code>summary.aidsEst</code>
that is currently identical to the provided <code>object</code>
(except for its class).
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen</p>


<h3>See Also</h3>

<p><code><a href="#topic+aidsEst">aidsEst</a></code>, <code><a href="#topic+aidsElas">aidsElas</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>   # Using data published in Blanciforti, Green &amp; King (1986)
   data( Blanciforti86 )
   # Data on food consumption are available only for the first 32 years
   Blanciforti86 &lt;- Blanciforti86[ 1:32, ]

   ## Repeating the demand analysis of Blanciforti, Green &amp; King (1986)
   estResult &lt;- aidsEst( c( "pFood1", "pFood2", "pFood3", "pFood4" ),
      c( "wFood1", "wFood2", "wFood3", "wFood4" ), "xFood",
      data = Blanciforti86, priceIndex = "SL" )
   print( summary( estResult ) )
</code></pre>

<hr>
<h2 id='USMeatConsump'>U.S. Meat Consumption Data</h2><span id='topic+USMeatConsump'></span>

<h3>Description</h3>

<p>The <code>USMeatConsump</code> data set contains quarterly retail prices
and consumption quantities for four meat product categories:
beef, pork, chicken, and turkey.
The data period ranges from the first quarter of 1975
to the third quarter of 1999.
Hence, there are 99 observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(USMeatConsump)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>year</dt><dd><p>Year.</p>
</dd>
<dt>qtr</dt><dd><p>Quarter of the year.</p>
</dd>
<dt>t</dt><dd><p>Time trend.</p>
</dd>
<dt>pop</dt><dd><p>Population [million].</p>
</dd>
<dt>cpi</dt><dd><p>Consumer price index.</p>
</dd>
<dt>total_exp</dt><dd><p>Total per capita expenditure.</p>
</dd>
<dt>meat_exp</dt><dd><p>Per capita expenditure on meat.</p>
</dd>
<dt>beef_q</dt><dd><p>Per capita consumption of beef [pound].</p>
</dd>
<dt>pork_q</dt><dd><p>Per capita consumption of pork[pound].</p>
</dd>
<dt>chick_q</dt><dd><p>Per capita consumption of chicken [pound].</p>
</dd>
<dt>turkey_q</dt><dd><p>Per capita consumption of turkey [pound].</p>
</dd>
<dt>beef_p</dt><dd><p>Retail price of beef [cents / pound].</p>
</dd>
<dt>pork_p</dt><dd><p>Retail price of pork [cents / pound].</p>
</dd>
<dt>chick_p</dt><dd><p>Retail price of chicken [cents / pound].</p>
</dd>
<dt>turkey_p</dt><dd><p>Retail price of turkey [cents / pound].</p>
</dd>
<dt>beef_w</dt><dd><p>Expenditure share of beef (in meat).</p>
</dd>
<dt>pork_w</dt><dd><p>Expenditure share of pork (in meat).</p>
</dd>
<dt>chick_w</dt><dd><p>Expenditure share of chicken (in meat).</p>
</dd>
<dt>turkey_w</dt><dd><p>Expenditure share of turkey (in meat).</p>
</dd>
</dl>



<h3>Source</h3>

<p>SAS,
<em>SAS/ETS Examples: Estimating an Almost Ideal Demand System Model</em>,
<a href="https://support.sas.com/rnd/app/ets/examples/aids/index.htm">https://support.sas.com/rnd/app/ets/examples/aids/index.htm</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   ## replicating the LA-AIDS estimation of the SAS example
   # loading data set
   data( USMeatConsump )

   # adding shifter variables for modeling seasonal effects
   USMeatConsump$co1 &lt;- cos( 1 / 2 * 3.14159 * USMeatConsump$t )
   USMeatConsump$si1 &lt;- sin( 1 / 2 * 3.14159 * USMeatConsump$t )

   # Scaling prices by their means
   USMeatConsump$beef_pm &lt;- USMeatConsump$beef_p / mean( USMeatConsump$beef_p )
   USMeatConsump$pork_pm &lt;- USMeatConsump$pork_p / mean( USMeatConsump$pork_p )
   USMeatConsump$chick_pm &lt;- USMeatConsump$chick_p / mean( USMeatConsump$chick_p )
   USMeatConsump$turkey_pm &lt;- USMeatConsump$turkey_p / mean( USMeatConsump$turkey_p )

   # Estimation of the model
   meatModel &lt;- aidsEst( c( "beef_pm", "pork_pm", "chick_pm", "turkey_pm" ),
      c( "beef_w", "pork_w", "chick_w", "turkey_w" ),
      "meat_exp", shifterNames = c( "co1", "si1", "t" ),
      priceIndex ="S", data = USMeatConsump, maxiter=1000 )
   summary( meatModel )
</code></pre>

<hr>
<h2 id='vcov.aidsEst'>Covariance matrix of an Almost Ideal Demand System</h2><span id='topic+vcov.aidsEst'></span>

<h3>Description</h3>

<p>These method returns the covariance matrix of the coefficients from
an Almost Ideal Demand System (AIDS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'aidsEst'
vcov( object, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.aidsEst_+3A_object">object</code></td>
<td>
<p>an object of class <code>aidsEst</code>.</p>
</td></tr>
<tr><td><code id="vcov.aidsEst_+3A_...">...</code></td>
<td>
<p>currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>vcov</code> method for objects of class <code>aidsEst</code>
returns a symmetric matrix: the covariance matrix of the coefficients.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen</p>


<h3>See Also</h3>

<p><code><a href="#topic+aidsEst">aidsEst</a></code>, <code><a href="#topic+coef.aidsEst">coef.aidsEst</a></code></p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
