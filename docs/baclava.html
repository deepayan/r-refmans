<!DOCTYPE html><html lang="en"><head><title>Help for package baclava</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {baclava}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#all_cause_rates'><p>All Cause Mortality Rates</p></a></li>
<li><a href='#aloocv'><p>Approximate Leave-One-Out Cross-Validation</p></a></li>
<li><a href='#cohortODX'><p>Cohort-specific Overdiagnosis</p></a></li>
<li><a href='#fit_baclava'><p>Bayesian Analysis of Cancer Latency with Auxiliary Variable Augmentation</p></a></li>
<li><a href='#plot.baclava'><p>Plot Posterior Distribution Parameters</p></a></li>
<li><a href='#predictODX'><p>Estimate the Overall and Per Screen Overdiagnosis Rates</p></a></li>
<li><a href='#screen_data'><p>Toy Dataset</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Analysis of Cancer Latency with Auxiliary Variable
Augmentation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-09-24</td>
</tr>
<tr>
<td>Description:</td>
<td>A novel data-augmentation Markov chain Monte Carlo sampling algorithm to fit a progressive compartmental model of disease in a Bayesian framework 
             Morsomme, R.N., Holloway, S.T., Ryser, M.D. and Xu J. (2024) &lt;<a href="https://doi.org/10.48550%2FarXiv.2408.14625">doi:10.48550/arXiv.2408.14625</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, RcppNumerical, ggplot2, coda, dplyr, stats, tibble,
tidyr, foreach, doParallel</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen, RcppNumerical</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Shannon T. Holloway &lt;shannon.t.holloway@gmail.com&gt;</td>
</tr>
<tr>
<td>Author:</td>
<td>Raphael N. Morsomme [aut],
  Shannon T. Holloway [aut, cre],
  Jason Xu [ctb],
  Marc D. Ryser [ctb]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Collate:</td>
<td>'RcppExports.R' 'aloocv.R' 'utilities.R' 'cohortODX.R'
'computeEndpoints.R' 'fit_baclava.R' 'predictODX_helpers.R'
'predictODX.R' 's3_methods.R' 'screen_data.R'</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-24 20:45:52 UTC; sth45</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-25 10:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='all_cause_rates'>All Cause Mortality Rates</h2><span id='topic+all_cause_rates'></span>

<h3>Description</h3>

<p>All-cause mortality rates for both male and female, male only, and female
only for the 1974 birth cohort. Data were taken from the CDC Life Tables.
Vital Statistics of the United States, 1974 Life Tables, Vol. II, Section 5. 1976.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(all_cause_rates)
</code></pre>


<h3>Format</h3>

<p><code>all_cause_rates</code> is a data.frame containing
the following
</p>

<ul>
<li><p>Age: An integer.
</p>
</li>
<li><p>both: A numeric. All-cause mortality rate for combined male and female.
</p>
</li>
<li><p>male: A numeric. Male only all-cause mortality rate.
</p>
</li>
<li><p>female: A numeric. Female only all-cause mortality rate.
</p>
</li></ul>


<hr>
<h2 id='aloocv'>Approximate Leave-One-Out Cross-Validation</h2><span id='topic+aloocv'></span>

<h3>Description</h3>

<p>Approximate leave-one-out cross-validation computed from the posterior
draws of the Markov chain Monte Carlo sampler as implemented in
<a href="#topic+fit_baclava">fit_baclava</a>().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aloocv(
  object,
  data.clinical,
  data.assess,
  J.increment = 75L,
  J.max = 225L,
  ess.target = 50L,
  n.core = 1L,
  verbose = TRUE,
  lib = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aloocv_+3A_object">object</code></td>
<td>
<p>The value object returned by <a href="#topic+fit_baclava">fit_baclava</a>().</p>
</td></tr>
<tr><td><code id="aloocv_+3A_data.clinical">data.clinical</code></td>
<td>
<p>A data.frame object. The clinical data on which the
model is assessed. The data must be structured as for <code>fit_baclava()</code>;
specifically, it must contain
</p>

<ul>
<li><p>id: A character, numeric, or integer object. The unique participant
id to which the record pertains. Note these must include those provided in
<code>data.assess</code>. Must be only 1 record for each participant.
</p>
</li>
<li><p>age_entry: A numeric object. The age at time of entry into the study.
Note that this data is used to calculate the normalization; to expedite
numerical integration, it is recommended that the ages be rounded to
minimize repeated calculations. Optional input 'round.age.entry' can be
set to FALSE if this approximation is not desired; however, the
computation time will significantly increase.
</p>
</li>
<li><p>endpoint_type: A character object. Must be one of {&quot;clinical&quot;,
&quot;censored&quot;, &quot;preclinical&quot;}. Type &quot;clinical&quot; indicates that disease
was diagnosed in the clinical compartment (i.e., symptomatic). Type
&quot;preclinical&quot; indicates that disease was diagnosed in the pre-clinical
compartment (i.e., during an assessment). Type
&quot;censored&quot; indicates participant was censored.
</p>
</li>
<li><p>age_endpoint: A numeric object. The participant's age at the
time the endpoint was evaluated.
</p>
</li></ul>

<p>If the sensitivity parameter (beta) is arm-specific, an additional
column <code>arm</code> is required indicating the study arm to which each
participant is assigned. Similarly, if the preclinical Weibull distribution is
group-specific, an additional column <code>grp.rateP</code> is required. See Details
for further information.</p>
</td></tr>
<tr><td><code id="aloocv_+3A_data.assess">data.assess</code></td>
<td>
<p>A data.frame object. The disease status assessment data
on which the model is assessed. The data must be structured as for
<code>fit_baclava()</code>; specifically, the data must contain
</p>

<ul>
<li><p>id: A character, numeric, or integer object. The unique participant
id to which the record pertains.
</p>
</li>
<li><p>age_assess: A numeric object. The participant's age at time of
assessment.
</p>
</li>
<li><p>disease_detected: An integer object. Must be binary 0/1, where
1 indicates that disease was detected at the assessment; 0 otherwise.
</p>
</li></ul>

<p>If the sensitivity parameter (beta) is screen-type specific, an additional
column <code>screen_type</code> is required indicating the type of each
screen.</p>
</td></tr>
<tr><td><code id="aloocv_+3A_j.increment">J.increment</code></td>
<td>
<p>An integer object. The number of replicates of each
participant to generate in each iteration of the importance sampling procedure
to attain desired effective sample size.</p>
</td></tr>
<tr><td><code id="aloocv_+3A_j.max">J.max</code></td>
<td>
<p>An integer object. The maximum number of samples to be
drawn.</p>
</td></tr>
<tr><td><code id="aloocv_+3A_ess.target">ess.target</code></td>
<td>
<p>An integer object. The target effective sample size in the
importance sampling procedure.</p>
</td></tr>
<tr><td><code id="aloocv_+3A_n.core">n.core</code></td>
<td>
<p>An integer object. The function allows for the outer loop
across participants to be run in parallel using foreach().</p>
</td></tr>
<tr><td><code id="aloocv_+3A_verbose">verbose</code></td>
<td>
<p>A logical object. If TRUE, progress information will be
printed. This input will be ignored if n.core &gt; 1.</p>
</td></tr>
<tr><td><code id="aloocv_+3A_lib">lib</code></td>
<td>
<p>An optional character vector allowing for library path
to be provided to cluster.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes the predictive fit of a model.
For each individual and each MCMC draw, the function approximates the
marginal likelihood via importance sampling. It samples J.increment values
of the individual's latent variables using the Metropolis-Hastings proposal
distributions and computes the effective sample size (ESS) of the
importance sampling procedure. If the target ESS is not met, J.increment
additional samples are taken, and the ESS is re-evaluated.
This is repeated until either the ESS is
satisfied or J.max samples have been drawn.
</p>


<h3>Value</h3>

<p>A list object. Element <code>summary</code> contains the min, mean, and
the 1
likelihood; and the individual-level and estimated predictive fit.
Element <code>result</code> contains the likelihood, ESS, and J for each
MCMC sample for each participant.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(screen_data)

theta_0 &lt;- list("rate_H" = 7e-4, "shape_H" = 2.0,
                "rate_P" = 0.5  , "shape_P" = 1.0,
                "beta" = 0.9, psi = 0.4)
prior &lt;- list("rate_H" = 0.01, "shape_H" = 1,
              "rate_P" = 0.01, "shape_P" = 1,
              "a_psi" = 1/2 , "b_psi" = 1/2,
              "a_beta" = 38.5, "b_beta" = 5.8)

# This is for illustration only -- the number of MCMC samples should be
# significantly larger and the epsilon values should be tuned.
example &lt;- fit_baclava(data.assess = data.screen,
                       data.clinical = data.clinical,
                       t0 = 30.0,
                       theta_0 = theta_0,
                       prior = prior,
                       thin = 10L)

res &lt;- aloocv(example, data.clinical, data.screen)

</code></pre>

<hr>
<h2 id='cohortODX'>Cohort-specific Overdiagnosis</h2><span id='topic+cohortODX'></span>

<h3>Description</h3>

<p>Estimates the overall and screening specific overdiagnosis probability
for the cohort of the original analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cohortODX(
  object,
  data.clinical,
  data.assess,
  other.cause.rates = NULL,
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cohortODX_+3A_object">object</code></td>
<td>
<p>A 'baclava' object. The value object returned by <a href="#topic+fit_baclava">fit_baclava</a>().</p>
</td></tr>
<tr><td><code id="cohortODX_+3A_data.clinical">data.clinical</code></td>
<td>
<p>A data.frame object. The clinical data. The data must
be structured as
</p>

<ul>
<li> <p><code>id</code>: A character, numeric, or integer object. The unique participant
id to which the record pertains. Note these must include those provided in
<code>data.assess</code>. Must be only 1 record for each participant.
</p>
</li>
<li> <p><code>age_entry</code>: A numeric object. The age at time of entry into the study.
Note that this data is used to calculate a normalization; to expedite
numerical integration, it is recommended that the ages be rounded.
Optional input <code>round.age.entry</code> can be
set to FALSE if this approximation is not desired; however, the
computation time will significantly increase.
</p>
</li>
<li> <p><code>endpoint_type</code>: A character object. Must be one of {&quot;clinical&quot;,
&quot;censored&quot;, &quot;preclinical&quot;}. Type &quot;clinical&quot; indicates that disease
was diagnosed in the clinical compartment (i.e., symptomatic). Type
&quot;preclinical&quot; indicates that disease was diagnosed in the preclinical
compartment (i.e., during an assessment). Type
&quot;censored&quot; indicates disease was not diagnosed prior to end of study.
</p>
</li>
<li> <p><code>age_endpoint</code>: A numeric object. The participant's age at the
time the endpoint was evaluated.
</p>
</li></ul>

<p>If the sensitivity parameter (beta) is arm-specific, an additional
column <code>arm</code> is required indicating the study arm to which each
participant is assigned. Similarly, if the preclinical Weibull distribution is
group-specific, an additional column <code>grp.rateP</code> is required. See Details
for further information.
This input should be identical to that provided to obtain <code>object</code>.</p>
</td></tr>
<tr><td><code id="cohortODX_+3A_data.assess">data.assess</code></td>
<td>
<p>A data.frame object. Disease status assessments recorded
during healthy or preclinical compartment, e.g., screenings for disease.
The data must be structured as
</p>

<ul>
<li> <p><code>id</code>: A character, numeric, or integer object. The unique participant
id to which the record pertains. Multiple records for each id are allowed.
</p>
</li>
<li> <p><code>age_assess</code>: A numeric object. The participant's age at time of
assessment.
</p>
</li>
<li> <p><code>disease_detected</code>: An integer object. Must be binary 0/1, where
1 indicates that disease was detected at the assessment; 0 otherwise.
</p>
</li></ul>

<p>If the sensitivity parameter (beta) is screen-specific, an additional
column <code>screen_type</code> is required indicating the type of each
screen.
This input should be identical to that provided to obtain <code>object</code>.</p>
</td></tr>
<tr><td><code id="cohortODX_+3A_other.cause.rates">other.cause.rates</code></td>
<td>
<p>A data.frame object. Age specific incidence rates
that do not include the disease of interest. Must contain columns &quot;Rate&quot;
and &quot;Age&quot;.</p>
</td></tr>
<tr><td><code id="cohortODX_+3A_plot">plot</code></td>
<td>
<p>A logical object. If TRUE, generates a boxplot of the overdiagnosis
probability for each individual as a function of the screen at which
disease was detected. Includes only the consecutive screens for which more
than 1% of the screen detected cases were detected.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object. 
</p>

<ul>
<li> <p><code>all</code> An n x S matrix containing the estimated overdiagnosis
probability for each individual (n) and each posterior parameter set (S).
</p>
</li>
<li> <p><code>mean.individual</code> A vector containing the mean across S of
the estimated overdiagnosis for each individual, i.e., <code>rowMeans(all)</code>.
</p>
</li>
<li> <p><code>mean.overall</code> A numeric, the mean overdiagnosis
probability across all posterior parameter sets and screen-detected cases, 
i.e., <code>mean(all)</code>. 
</p>
</li>
<li> <p><code>summary.by.screen</code> A matrix containing the summary statistics of 
<code>mean.individual</code> for the individuals detected positive at
each screen, i.e., <code>summary(mean.individual[diagnosis_screen_id == i])</code>. 
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
data(screen_data)

theta_0 &lt;- list("rate_H" = 7e-4, "shape_H" = 2.0,
                "rate_P" = 0.5  , "shape_P" = 1.0,
                "beta" = 0.9, psi = 0.4)
prior &lt;- list("rate_H" = 0.01, "shape_H" = 1,
              "rate_P" = 0.01, "shape_P" = 1,
              "a_psi" = 1/2 , "b_psi" = 1/2,
              "a_beta" = 38.5, "b_beta" = 5.8)

# This is for illustration only -- the number of Gibbs samples should be
# significantly larger and the epsilon values should be tuned.
example &lt;- fit_baclava(data.assess = data.screen,
                       data.clinical = data.clinical,
                       t0 = 30.0,
                       theta_0 = theta_0,
                       prior = prior,
                       save.latent = TRUE)

# if rates are not available, an all cause dataset is provided in the package
# NOTE: these predictions will be over-estimated

data(all_cause_rates)
all_cause_rates &lt;- all_cause_rates[, c("Age", "both")]
colnames(all_cause_rates) &lt;- c("Age", "Rate")

cohort_odx &lt;- cohortODX(object = example,
                        data.clinical = data.clinical,
                        data.assess = data.screen,
                        other.cause.rates = all_cause_rates,
                        plot = FALSE)

</code></pre>

<hr>
<h2 id='fit_baclava'>Bayesian Analysis of Cancer Latency with Auxiliary Variable Augmentation</h2><span id='topic+fit_baclava'></span><span id='topic+summary.baclava'></span><span id='topic+print.baclava'></span>

<h3>Description</h3>

<p>Markov chain Monte Carlo sampler to fit a three-state mixture compartmental
model of cancer natural history to individual-level screening and cancer
diagnosis histories in a Bayesian framework.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_baclava(
  data.assess,
  data.clinical,
  baclava.object = NULL,
  M = 100L,
  thin = 1L,
  t0 = 0,
  theta_0 = list(),
  prior = list(),
  epsilon_rate_H = 0.001,
  epsilon_rate_P = 0.001,
  epsilon_psi = 0.001,
  indolent = TRUE,
  adaptive = NULL,
  round.age.entry = TRUE,
  verbose = TRUE,
  save.latent = FALSE
)

## S3 method for class 'baclava'
summary(object, ...)

## S3 method for class 'baclava'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_baclava_+3A_data.assess">data.assess</code></td>
<td>
<p>A data.frame. Disease status assessments recorded
during healthy or preclinical compartment, e.g., screenings for disease.
The data must be structured as
</p>

<ul>
<li> <p><code>id</code>: A character, numeric, or integer object. The unique participant
id to which the record pertains. Multiple records for each id are allowed.
</p>
</li>
<li> <p><code>age_assess</code>: A numeric object. The participant's age at time of
assessment.
</p>
</li>
<li> <p><code>disease_detected</code>: An integer object. Must be binary 0/1, where
1 indicates that disease was detected at the assessment; 0 otherwise.
</p>
</li></ul>

<p>If the sensitivity parameter (beta) is screen-specific, an additional
column <code>screen_type</code> is required indicating the type of each
screen.</p>
</td></tr>
<tr><td><code id="fit_baclava_+3A_data.clinical">data.clinical</code></td>
<td>
<p>A data.frame. The clinical data. The data must
be structured as
</p>

<ul>
<li> <p><code>id</code>: A character, numeric, or integer object. The unique participant
id to which the record pertains. Note these must include those provided in
<code>data.assess</code>. Must be only 1 record for each participant.
</p>
</li>
<li> <p><code>age_entry</code>: A numeric object. The age at time of entry into the study.
Note that this data is used to calculate a normalization; to expedite
numerical integration, it is recommended that the ages be rounded.
Optional input <code>round.age.entry</code> can be
set to FALSE if this approximation is not desired; however, the
computation time will significantly increase.
</p>
</li>
<li> <p><code>endpoint_type</code>: A character object. Must be one of {&quot;clinical&quot;,
&quot;censored&quot;, &quot;preclinical&quot;}. Type &quot;clinical&quot; indicates that disease
was diagnosed in the clinical compartment (i.e., symptomatic). Type
&quot;preclinical&quot; indicates that disease was diagnosed in the preclinical
compartment (i.e., during an assessment). Type
&quot;censored&quot; indicates disease was not diagnosed prior to end of study.
</p>
</li>
<li> <p><code>age_endpoint</code>: A numeric object. The participant's age at the
time the endpoint was evaluated.
</p>
</li></ul>

<p>If the sensitivity parameter (beta) is arm-specific, an additional
column <code>arm</code> is required indicating the study arm to which each
participant is assigned. Similarly, if the preclinical Weibull distribution is
group-specific, an additional column <code>grp.rateP</code> is required. See Details
for further information.</p>
</td></tr>
<tr><td><code id="fit_baclava_+3A_baclava.object">baclava.object</code></td>
<td>
<p>NULL or a 'baclava' object. To continue a calculation,
provide the object returned by a previous call.</p>
</td></tr>
<tr><td><code id="fit_baclava_+3A_m">M</code></td>
<td>
<p>A positive integer object. The number of Monte Carlo samples. This
is the total, i.e., M = adaptive$warmup + n_MCMC.</p>
</td></tr>
<tr><td><code id="fit_baclava_+3A_thin">thin</code></td>
<td>
<p>A positive integer object. Keep each thin-th step of the sampler
after the warmup period, if any, is complete.</p>
</td></tr>
<tr><td><code id="fit_baclava_+3A_t0">t0</code></td>
<td>
<p>A non-negative scalar numeric object. The risk onset age. Must be
less than the earliest assessment age, entry age, and endpoint age.
If <code>baclava.object</code> is a 'baclava' object, this input is ignored.</p>
</td></tr>
<tr><td><code id="fit_baclava_+3A_theta_0">theta_0</code></td>
<td>
<p>A list object. The initial values for all distribution
parameters. If <code>baclava.object</code> is a 'baclava' object, this input is ignored.
See Details for further information.</p>
</td></tr>
<tr><td><code id="fit_baclava_+3A_prior">prior</code></td>
<td>
<p>A list object. The prior parameters. If <code>baclava.object</code> is
a 'baclava' object, this input is ignored. See Details for further
information.</p>
</td></tr>
<tr><td><code id="fit_baclava_+3A_epsilon_rate_h">epsilon_rate_H</code></td>
<td>
<p>A small scalar numeric. The Monte Carlo step size
for rate_H (the rate parameter of the Weibull of the healthy compartment).
If <code>baclava.object</code> is a 'baclava' object, this input is ignored.</p>
</td></tr>
<tr><td><code id="fit_baclava_+3A_epsilon_rate_p">epsilon_rate_P</code></td>
<td>
<p>A small scalar numeric or named numeric vector.
The Monte Carlo step size for rate_P (the rate parameter of the Weibull of
the preclinical compartment). If group-specific Weibull distributions
are used, this must be a vector; see Details for further information.
If <code>baclava.object</code> is a 'baclava' object, this input is ignored.</p>
</td></tr>
<tr><td><code id="fit_baclava_+3A_epsilon_psi">epsilon_psi</code></td>
<td>
<p>A small scalar numeric. The Monte Carlo step size for
parameter psi (the probability of indolence). If disease under
analysis does not have an indolent state, set to 0 and ensure that
the initial value for psi in theta_0 is also 0.
If <code>baclava.object</code> is a 'baclava' object, this input is ignored.</p>
</td></tr>
<tr><td><code id="fit_baclava_+3A_indolent">indolent</code></td>
<td>
<p>A logical object. If <code>FALSE</code>, disease under analysis
does not have an indolent state, i.e., it is always progressive.
This input is provided for convenience; if FALSE, <code>epislon_psi</code> and
<code>theta_0$psi</code> will be set to 0.
If <code>baclava.object</code> is a 'baclava' object, this input is ignored.</p>
</td></tr>
<tr><td><code id="fit_baclava_+3A_adaptive">adaptive</code></td>
<td>
<p>NULL or named list. If NULL, the step sizes are
not modified in the MCMC. If a list, the parameters for the
adaptive MCMC.
The provided list must contain elements &quot;delta&quot;, the target acceptance
rate; &quot;warmup&quot;, the number of iterations to apply step size correction;
and parameters &quot;m0&quot;, &quot;kappa&quot;, and &quot;gamma&quot;. See Details for further
information.
If <code>baclava.object</code> is a 'baclava' object, this input is ignored.</p>
</td></tr>
<tr><td><code id="fit_baclava_+3A_round.age.entry">round.age.entry</code></td>
<td>
<p>A logical object. If TRUE, the age at time of entry
will be rounded to the nearest integer prior to performing the MCMC.
This data is used to estimate the probability of experiencing clinical
disease prior to entering the study, which is estimated using a
time consuming numerical integration procedure. It is expected that
rounding the ages at time of entry introduces minimal bias. If FALSE,
and ages cannot be grouped, these integrals significantly increase
computation time.
If <code>baclava.object</code> is a 'baclava' object, this input is ignored.</p>
</td></tr>
<tr><td><code id="fit_baclava_+3A_verbose">verbose</code></td>
<td>
<p>A logical object. If <code>TRUE</code>, a progress bar will be shown
during the MCMC.</p>
</td></tr>
<tr><td><code id="fit_baclava_+3A_save.latent">save.latent</code></td>
<td>
<p>A logical object. If <code>TRUE</code>, latent variable tau_HP
and indolence will be returned. These can be very large matrices. To
estimate the cohort overdiagnosis probability using <a href="#topic+cohortODX">cohortODX</a>(),
this must be set to TRUE.</p>
</td></tr>
<tr><td><code id="fit_baclava_+3A_object">object</code></td>
<td>
<p>An object of class <code>baclava</code>.</p>
</td></tr>
<tr><td><code id="fit_baclava_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
<tr><td><code id="fit_baclava_+3A_x">x</code></td>
<td>
<p>An object of class <code>baclava</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input <code>theta_0</code> contains the initial values for all distribution
parameters. The list must include
</p>

<ul>
<li> <p><code>rate_H</code>: A scalar numeric. The rate for the Weibull
distribution of the healthy compartment.
</p>
</li>
<li> <p><code>shape_H</code>: A scalar numeric. The shape parameter for the
Weibull distribution of the healthy compartment.
</p>
</li>
<li> <p><code>rate_P</code>: A numeric scalar or named numeric vector. The rate
parameter for each Weibull distribution of the preclinical compartment.
If all participants follow the same Weibull distribution, provide a scalar.
If multiple preclinical Weibull distributions are used, see note below.
</p>
</li>
<li> <p><code>shape_P</code>: A scalar numeric. The shape parameter for all
Weibull distributions of the preclinical compartment.
</p>
</li>
<li> <p><code>beta</code>: A  scalar numeric or named numeric vector. The assessment
sensitivity. If the sensitivity is the same for all participants, provide
a scalar. If the sensitivity is arm- or screen-type-specific, see note below.
Each element must be in [0, 1].
</p>
</li>
<li> <p><code>psi</code>: A scalar numeric. The probability of being indolent.
Must be in [0,1]. If disease is always progressive, this element is
required, but its value must be set to 0.
</p>
</li></ul>

<p>Input <code>prior</code> contains all distribution parameters for the priors.
The list must include
</p>

<ul>
<li> <p><code>rate_P</code>: A scalar numeric or named vector object. The rate
for the Gamma(shape_P, rate_P) prior on the rate of the Weibull of the
preclinical compartment. If group-specific distributions are used, see
note below.
</p>
</li>
<li> <p><code>shape_P</code>: A scalar numeric or named vector object. The shape
for the Gamma(shape_P, rate_P) prior on the rate of the Weibull of the
preclinical compartment. If group-specific distributions are used, see
note below.
</p>
</li>
<li> <p><code>rate_H</code>: A scalar numeric. The rate for the
Gamma(shape_H, rate_H) prior on the rate of the Weibull of the healthy
compartment.
</p>
</li>
<li> <p><code>shape_H</code>: A scalar numeric. The shape for the
Gamma(shape_H, rate_H) prior on the rate of the Weibull of the healthy
compartment.
</p>
</li>
<li> <p><code>a_beta</code>: A positive scalar numeric or named numeric vector.
The first parameter of the Beta(a, b) prior on the assessment sensitivity.
If arm- or screen-type-specific distributions are used, see note below.
If beta is not allowed to change, specify 0.0.
</p>
</li>
<li> <p><code>b_beta</code>: A positive scalar numeric or named numeric vector.
The second parameter of the Beta(a, b) prior on the assessment sensitivity.
If arm- or screen-type-specific distributions are used, see note below.
If beta is not allowed to change, specify 0.0.
</p>
</li>
<li> <p><code>a_psi</code>: A positive scalar numeric. The first parameter of the
Beta(a, b) prior on the indolence probability. If disease under analysis
does not have an indolent state, this element must be included, but it
will be ignored.
</p>
</li>
<li> <p><code>b_psi</code>: A positive scalar numeric. The second parameter of the
Beta(a, b) prior on the indolence probability. If disease under analysis
does not have an indolent state, this element must be included, but it
will be ignored.
</p>
</li></ul>

<p>It is possible to assign participants to study arms such that each arm has
its own screening sensitivities and/or rate_P distributions, or to
assign screen-type specific sensitivities.
</p>
<p>To designate study arms, each of which will have its own screening
sensitivities:
</p>

<ul>
<li><p> Provide an additional column in <code>data.clinical</code> named
&quot;arm&quot;, which gives the study arm to which each participant is
assigned. For example,
<code>data.clinical$arm = c("Control", "Tx", "Tx", ...)</code>.
</p>
</li>
<li><p> Define all beta related prior parameters as named vectors.
For example, <code>prior$a_beta = c("Control" = 1, "Tx" = 38.5)</code>,
and <code>prior$b_beta = c("Control" = 1, "Tx" = 5.8)</code>
</p>
</li>
<li><p> Define the initial beta values of theta as a named vector.
For example,  <code>theta_0$beta = c("Control" = 0.75, "Tx" = 0.8)</code>.
</p>
</li></ul>

<p>Similarly, if using multiple preclinical Weibull distributions
(distributions will have the same shape_P),
</p>

<ul>
<li><p> Provide an additional column in <code>data.clinical</code> named
&quot;grp.rateP&quot;, which assigns each participant to one of the preclinical
Weibull distributions.
For example, <code>data.clinical$grp.rateP = c("rateP1", "rateP2", "rateP2", ... )</code>.
</p>
</li>
<li><p> Define the rate_P prior parameter as a named vector.
For example, <code>prior$rate_P &lt;- c("rateP1" = 0.01, "rateP2" = 0.02)</code>.
</p>
</li>
<li><p> Define the shape_P prior parameter as a named vector.
For example, <code>prior$shape_P &lt;- c("rateP1" = 1, "rateP2" = 2)</code>.
</p>
</li>
<li><p> Define the initial rate_P values of theta as a named vector.
For example,  <code>theta_0$rate_P &lt;- c("rateP1" = 1e-5, "rateP2" = 0.01)</code>.
</p>
</li>
<li><p> Define step size of rate_P as a named vector. For example,
<code>epsilon_rate_P &lt;- c("rateP1" = 0.001, "rateP2" = 0.002)</code>.
</p>
</li></ul>

<p>To assign screen-specific sensitivities,
</p>

<ul>
<li><p> Provide an additional column in <code>data.assess</code> named
&quot;screen_type&quot;, which gives the screening type for each screen. For example,
<code>data.assess$screen_type = c("film", "2D", "2D", ...)</code>.
</p>
</li>
<li><p> Define all beta related prior parameters as named vectors.
For example, <code>prior$a_beta = c("film" = 1, "2D" = 38.5)</code>,
and <code>prior$b_beta = c("film" = 1, "2D" = 5.8)</code>
</p>
</li>
<li><p> Define the initial beta values of theta as a named vector.
For example,  <code>theta_0$beta = c("film" = 0.75, "2D" = 0.8)</code>.
</p>
</li></ul>

<p>NOTE: If using integers to indicate group membership, vector names
still must be provided. For example, if group membership is binary 0/1,
vector elements of the prior, initial theta, and step size must be named
as &quot;0&quot; and &quot;1&quot;.
</p>
<p>The adaptive MCMC tuning expression at step m + 1 is defined as
</p>
<p style="text-align: center;"><code class="reqn">\epsilon_{m+1} = (1 - m^{\kappa}) \epsilon_{m} + m^{\kappa}
  \xi_{m+1},</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\xi_{m+1} = \frac{\sqrt{m}}{\gamma}\frac{1}{m+m_0}
  \sum_{i=1}^{m} (\alpha_m - \delta).</code>
</p>

<p>To initiate the adaptive selection procedure, input <code>adaptive</code>
must specify the parameters of the above expressions.
Specifically, the provided list must contain elements &quot;delta&quot;, the
target acceptance rate; &quot;warmup&quot;, the number of iterations to apply step
size correction; and parameters &quot;m0&quot;, &quot;kappa&quot;, and &quot;gamma&quot;.
</p>


<h3>Value</h3>

<p>An object of S3 class <code>baclava</code>, which extends a list object.
</p>

<ul>
<li><p> theta: A list of the posterior distribution parameters at the thinned samples.
</p>

<ul>
<li><p> rate_H: A numeric vector. The rates for the Weibull of the
the healthy compartment.
</p>
</li>
<li><p> shape_H: A scalar numeric. The input shape_H parameter.
</p>
</li>
<li><p> rate_P: A numeric matrix. The rates for the Weibull of the
preclinical compartment.
</p>
</li>
<li><p> shape_P: A scalar numeric. The input shape_P parameter.
</p>
</li>
<li><p> beta: A numeric matrix. The assessment sensitivities.
</p>
</li>
<li><p> psi: A numeric vector. The probabilities of indolence. Will be
NA if disease is always progressive.
</p>
</li></ul>

</li>
<li><p> tau_hp: If <code>save.latent = TRUE</code>, a matrix.
The age at time of transition from
healthy to preclinical compartment for each participant at the
thinned samples.
</p>
</li>
<li><p> indolent: If <code>save.latent = TRUE</code>, a matrix.
The indolent status for each participant at the
thinned samples. Will be <code>NA</code> if disease is always progressive.
</p>
</li>
<li><p> accept: A list of the accept indicator at the thinned samples.
</p>

<ul>
<li><p> rate_H: A numeric vector.
</p>
</li>
<li><p> rate_P: A numeric matrix.
</p>
</li>
<li><p> tau_hp: If <code>save.latent = TRUE</code>, a matrix. Will be NA if
current and new transition ages are Inf.
</p>
</li>
<li><p> psi: A numeric vector. The probability of indolence. Will be
<code>NA</code> if disease is always progressive.
</p>
</li></ul>

</li>
<li><p> epsilon: A list. The step sizes for each parameter.
</p>
</li>
<li><p> adaptive: A list. Settings for the adaptive procedure. Will be NA
if adaptive procedure not requested.
</p>
</li>
<li><p> last_theta: A list. The theta parameters of the last MCMC iteration.
</p>
</li>
<li><p> prior: A list. The provided parameters of the prior distributions.
</p>
</li>
<li><p> setup: A list of inputs provided to the call.
</p>

<ul>
<li><p> t0: The input age of risk onset.
</p>
</li>
<li><p> indolent: TRUE if disease is not progressive.
</p>
</li>
<li><p> round.age.entry: TRUE if age at entry was rounded to the nearest
whole number.
</p>
</li>
<li><p> groups.beta: A vector of the beta grouping values.
</p>
</li>
<li><p> groups.rateP: A vector of the rate_P grouping values.
</p>
</li>
<li><p> thin: The number of samples dropped between kept MCMC iterations.
</p>
</li>
<li><p> initial.theta: theta_0 as provided by user.
</p>
</li>
<li><p> initial.prior: prior as provided by user.
</p>
</li></ul>

</li>
<li><p> clinical.groupings: A data.frame of the original data's arm/rateP grouping.
</p>
</li>
<li><p> screen_types: A data.frame of the original data's screen type grouping.
</p>
</li>
<li><p> call: The matched call.
</p>
</li></ul>



<h3>Functions</h3>


<ul>
<li> <p><code>summary(baclava)</code>: Summary statistics of posterior distribution parameters
</p>
</li>
<li> <p><code>print(baclava)</code>: Print summary statistics of posterior distribution parameters
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>
data(screen_data)

theta_0 &lt;- list("rate_H" = 7e-4, "shape_H" = 2.0,
                "rate_P" = 0.5  , "shape_P" = 1.0,
                "beta" = 0.9, psi = 0.4)
prior &lt;- list("rate_H" = 0.01, "shape_H" = 1,
              "rate_P" = 0.01, "shape_P" = 1,
              "a_psi" = 1/2 , "b_psi" = 1/2,
              "a_beta" = 38.5, "b_beta" = 5.8)

# This is for illustration only -- the number of Gibbs samples should be
# significantly larger and the epsilon values should be tuned.
example &lt;- fit_baclava(data.assess = data.screen,
                       data.clinical = data.clinical,
                       t0 = 30.0,
                       theta_0 = theta_0,
                       prior = prior)

summary(example)
print(example)

# To continue this calculation
example_continued &lt;- fit_baclava(data.assess = data.screen,
                                 data.clinical = data.clinical,
                                 baclava.object = example)
</code></pre>

<hr>
<h2 id='plot.baclava'>Plot Posterior Distribution Parameters</h2><span id='topic+plot.baclava'></span>

<h3>Description</h3>

<p>Convenience function to facilitate exploration of posterior distributions through
trace plots, autocorrelations, and densities, as well as plotting the 
estimated hazard for transitioning to the preclinical compartment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'baclava'
plot(
  x,
  y,
  ...,
  type = c("density", "trace", "acf", "hazard"),
  burnin = 0L,
  max_age = 90L,
  trace_var = c("psi", "rate_H", "rate_P", "beta")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.baclava_+3A_x">x</code></td>
<td>
<p>An object of class <code>baclava</code>.</p>
</td></tr>
<tr><td><code id="plot.baclava_+3A_y">y</code></td>
<td>
<p>Ignored</p>
</td></tr>
<tr><td><code id="plot.baclava_+3A_...">...</code></td>
<td>
<p>Ignored</p>
</td></tr>
<tr><td><code id="plot.baclava_+3A_type">type</code></td>
<td>
<p>A character object. One of {&quot;density&quot;, &quot;trace&quot;, &quot;acf&quot;, &quot;hazard&quot;}. The
type of plot to generate</p>
</td></tr>
<tr><td><code id="plot.baclava_+3A_burnin">burnin</code></td>
<td>
<p>An integer object. Optional. The number of burn-in samples.
Used only for <code>type = "trace"</code>. One trace plot is generated for
the burnin iterations; a second for the post-burnin iterations. Note, this
refers to the number of kept (thinned) samples.</p>
</td></tr>
<tr><td><code id="plot.baclava_+3A_max_age">max_age</code></td>
<td>
<p>A numeric object. For <code>type = "hazard"</code>, the maximum
age at which to evaluate the hazard.</p>
</td></tr>
<tr><td><code id="plot.baclava_+3A_trace_var">trace_var</code></td>
<td>
<p>A character object. The parameter for which trace plots
are to be generated. Must be one of {&quot;psi&quot;, &quot;rate_H&quot;, &quot;rate_P&quot;, &quot;beta&quot;}</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A gg object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(screen_data)

theta_0 &lt;- list("rate_H" = 7e-4, "shape_H" = 2.0,
                "rate_P" = 0.5  , "shape_P" = 1.0,
                "beta" = 0.9, psi = 0.4)
prior &lt;- list("rate_H" = 0.01, "shape_H" = 1,
              "rate_P" = 0.01, "shape_P" = 1,
              "a_psi" = 1/2 , "b_psi" = 1/2,
              "a_beta" = 38.5, "b_beta" = 5.8)

# This is for illustration only -- the number of Gibbs samples should be
# significantly larger and the epsilon values should be tuned.
example &lt;- fit_baclava(data.assess = data.screen,
                       data.clinical = data.clinical,
                       t0 = 30.0,
                       theta_0 = theta_0,
                       prior = prior)
                       
plot(example)
plot(example, type = "trace", trace_var = "psi", burnin = 0L) 
plot(example, type = "trace", trace_var = "rate_H", burnin = 0L) 
plot(example, type = "trace", trace_var = "rate_P", burnin = 0L) 
plot(example, type = "trace", trace_var = "beta", burnin = 0L) 
plot(example, type = "acf")
plot(example, type = "hazard", max_age = 70)

</code></pre>

<hr>
<h2 id='predictODX'>Estimate the Overall and Per Screen Overdiagnosis Rates</h2><span id='topic+predictODX'></span><span id='topic+plot.baclava.ODX.pred'></span>

<h3>Description</h3>

<p>Using the posterior parameter distributions, calculates the infinite
population estimates of the probability of overdiagnosis at 
each screening episode due to indolence and/or death by other causes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictODX(
  object,
  screening.schedule,
  other.cause.rates,
  groups.rateP = NULL,
  screen.type = NULL,
  burnin = 1000L,
  verbose = TRUE
)

## S3 method for class 'baclava.ODX.pred'
plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predictODX_+3A_object">object</code></td>
<td>
<p>An object of S3 class 'baclava'. The value object returned
by <code>fit_baclava()</code>.</p>
</td></tr>
<tr><td><code id="predictODX_+3A_screening.schedule">screening.schedule</code></td>
<td>
<p>A numeric vector object. A vector of ages at
which screenings occur.</p>
</td></tr>
<tr><td><code id="predictODX_+3A_other.cause.rates">other.cause.rates</code></td>
<td>
<p>A data.frame object. Must contain columns &quot;Rate&quot;
and &quot;Age&quot;.</p>
</td></tr>
<tr><td><code id="predictODX_+3A_groups.ratep">groups.rateP</code></td>
<td>
<p>An integer scalar object. If model included groups with
different sojourn parameters, the group for which overdiagnosis is to
be estimated. Must be one of <code>object$setup$groups.rateP</code></p>
</td></tr>
<tr><td><code id="predictODX_+3A_screen.type">screen.type</code></td>
<td>
<p>An integer scalar object. If model included screen-type,
specific sensitivity parameters, the screen-type for which
overdiagnosis is to be estimated. Must be one of <code>object$setup$groups.beta</code></p>
</td></tr>
<tr><td><code id="predictODX_+3A_burnin">burnin</code></td>
<td>
<p>An integer object. Optional. The number of burn-in samples.
Used only for <code>type = "trace"</code>. One trace plot is generated for
the burnin iterations; a second for the post-burnin iterations. Note, this
refers to the kept (thinned) samples.</p>
</td></tr>
<tr><td><code id="predictODX_+3A_verbose">verbose</code></td>
<td>
<p>A logical object. If TRUE, progress bars will be displayed.</p>
</td></tr>
<tr><td><code id="predictODX_+3A_x">x</code></td>
<td>
<p>A an object of S3 class 'baclava.PDX.pred' as returned by <code>predictODX()</code>.</p>
</td></tr>
<tr><td><code id="predictODX_+3A_y">y</code></td>
<td>
<p>Ignored.</p>
</td></tr>
<tr><td><code id="predictODX_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provided birth cohort life table is an all cause tables obtained from the 
CDC Life Tables. Vital Statistics of the United States, 1974 Life Tables, 
Vol. II, Section 5. 1976. Estimated &quot;other cause&quot; mortality will thus be 
overestimated when using these tables. It is recommended that user provide 
data that has been corrected to exclude death due to the disease under analysis.
</p>


<h3>Value</h3>

<p>A list object. For each screen in <code>screening.schedule</code>,
a matrix providing the mean total overdiagnosis and the mean overdiagnosis
due to indolent/progressive tumors, as well as their 95
Similarly, element <code>overall</code> provides these estimates for the full
screening schedule.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>plot(baclava.ODX.pred)</code>: Generate column plot of predicted overdiagnosis for each screen.
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>
data(screen_data)

theta_0 &lt;- list("rate_H" = 7e-4, "shape_H" = 2.0,
                "rate_P" = 0.5  , "shape_P" = 1.0,
                "beta" = 0.9, psi = 0.4)
prior &lt;- list("rate_H" = 0.01, "shape_H" = 1,
              "rate_P" = 0.01, "shape_P" = 1,
              "a_psi" = 1/2 , "b_psi" = 1/2,
              "a_beta" = 38.5, "b_beta" = 5.8)

# This is for illustration only -- the number of MCMC samples should be
# significantly larger and the epsilon values should be tuned.
example &lt;- fit_baclava(data.assess = data.screen,
                       data.clinical = data.clinical,
                       t0 = 30.0,
                       theta_0 = theta_0,
                       prior = prior)
                       
# if rates are not available, an all cause dataset is provided in the package
# NOTE: these predictions will be over-estimated
           
data(all_cause_rates)
all_cause_rates &lt;- all_cause_rates[, c("Age", "both")]
colnames(all_cause_rates) &lt;- c("Age", "Rate")

# using single screen for example speed
predicted_odx &lt;- predictODX(object = example, 
                            other.cause.rates = all_cause_rates,
                            screening.schedule = 40, 
                            burnin = 10)

plot(predicted_odx)

</code></pre>

<hr>
<h2 id='screen_data'>Toy Dataset</h2><span id='topic+screen_data'></span><span id='topic+data.clinical'></span><span id='topic+data.screen'></span>

<h3>Description</h3>

<p>This toy dataset is provided to facilitate examples and provide an
example of the required input format. Though the data were simulated
under a scenario similar to a real-world breast cancer screening trial,
they should not be interpreted as representing true trial data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(screen_data)
</code></pre>


<h3>Format</h3>

<p>Two datasets are provided. 
</p>
<p><code>data.screen</code> is a data.frame containing
the following screening information for 89 participants (287 assessments)
</p>

<ul>
<li><p>id: A character. Participant ids.
</p>
</li>
<li><p>age_assess: A numeric. The participant age as time of assessment.
</p>
</li>
<li><p>disease_detected: An integer. 1 = disease detected at assessment; 
0 otherwise
</p>
</li></ul>

<p><code>data.clinical</code> is a data.frame containing the following information for 89 
participants.
</p>

<ul>
<li><p>id: A character. Participant ids.
</p>
</li>
<li><p>age_entry: A numeric. The participant age as time of study entry.
</p>
</li>
<li><p>endpoint_type: A character. One of {&quot;clinical&quot;, &quot;preclinical&quot;, &quot;censored&quot;},
indicating if participant was diagnosed with the disease in the clinical
compartment, was diagnosed in the pre-clinical compartment, or was
censored.
</p>
</li>
<li><p>age_endpoint: A numeric. The participant's age at time the endpoint
was ascertained.
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
