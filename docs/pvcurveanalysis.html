<!DOCTYPE html><html><head><title>Help for package pvcurveanalysis</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pvcurveanalysis}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ApplyCombMod'><p>Apply a combined exponential and linear model</p></a></li>
<li><a href='#ExtractFitParam'><p>Extracts the fitting parameters from results list</p></a></li>
<li><a href='#ExtractParam'><p>Extracts parameters from result list</p></a></li>
<li><a href='#FMSaturated'><p>Saturated fresh mass estimation</p></a></li>
<li><a href='#MergeDf'><p>Merges data to data frames</p></a></li>
<li><a href='#ModElasticity'><p>Modulus of elasticity</p></a></li>
<li><a href='#OrderCheck'><p>Order Check</p></a></li>
<li><a href='#OsmoticPot'><p>Pressure Volume Curve Analysis</p></a></li>
<li><a href='#PlotOutput'><p>Plot Output</p></a></li>
<li><a href='#pressure_volume_data'><p>Pressure volume curve data</p></a></li>
<li><a href='#RelativeWaterContent'><p>Relative Water Content (RWC)</p></a></li>
<li><a href='#RelativeWaterDeficit'><p>Relative Water Deficit (RWD)</p></a></li>
<li><a href='#TurgorLossPoint'><p>Turgor Loss Point</p></a></li>
<li><a href='#ValidityCheck'><p>Ensures the validity of the input data</p></a></li>
<li><a href='#ValidityCheckDetail'><p>Checks if column exists in data, is numeric and has the same lenghts as the others existence</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Pressure Volume Curves</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>ggplot2, R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Description:</td>
<td>Enables the manufacturing, analysis and display of pressure volume curves. From the progression of the curves, turgor loss point, osmotic potential and apoplastic fraction can be derived. Methods adapted from Bartlett, Scoffoni and Sack (2012) &lt;<a href="https://doi.org/10.1111%2Fj.1461-0248.2012.01751.x">doi:10.1111/j.1461-0248.2012.01751.x</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-12 16:17:09 UTC; anna.raesch</td>
</tr>
<tr>
<td>Author:</td>
<td>Anna Raesch [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Anna Raesch &lt;annaraesch@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-10-13 10:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ApplyCombMod'>Apply a combined exponential and linear model</h2><span id='topic+ApplyCombMod'></span>

<h3>Description</h3>

<p>a non linear model combining an exponential and a linear fit is applied to the data using the Gauss-Newton algorithm of nls.
starting values are calculated
based on the data. Weights are applied to the model based on the estimated insecurity of the data quality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ApplyCombMod(data, y = "y", x = "x")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ApplyCombMod_+3A_data">data</code></td>
<td>
<p>data frame containg x and y data to which the model is ought to be applied to</p>
</td></tr>
<tr><td><code id="ApplyCombMod_+3A_y">y</code></td>
<td>
<p>name of column in data containing y data</p>
</td></tr>
<tr><td><code id="ApplyCombMod_+3A_x">x</code></td>
<td>
<p>name of column in data containing x data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>model parameters
</p>

<hr>
<h2 id='ExtractFitParam'>Extracts the fitting parameters from results list</h2><span id='topic+ExtractFitParam'></span>

<h3>Description</h3>

<p>Extracts the coefficients and confidence intervals from the fitting results of the functions analysing the pressure volume curve
(TurgorLossPoint, OsmoticPot and ModElasticity)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExtractFitParam(result_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ExtractFitParam_+3A_result_list">result_list</code></td>
<td>
<p>output list from the functions TurgorLossPoint, OsmoticPot or ModElasticity</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame containing the coefficients and the 0.95 confidence interval of the coefficients from the fit
</p>

<hr>
<h2 id='ExtractParam'>Extracts parameters from result list</h2><span id='topic+ExtractParam'></span>

<h3>Description</h3>

<p>Extracts the curve parameters from the result lists of the functions analysing the pressure volume curve
(TurgorLossPoint, OsmoticPot and ModElasticity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExtractParam(result_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ExtractParam_+3A_result_list">result_list</code></td>
<td>
<p>output list from the functions TurgorLossPoint, OsmoticPot or ModElasticity</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame containing the results from the curve analysis only, depending on the function used, relative water deficit at
turgor loss point (rwd.tlp), water potential at turgor loss point (water.pot.tlp), apoplastic fraction (apo.fract),
osmotic potential at full saturation (osmotic.pot.full.sat), modulus of elasticity (modulus.elasticity)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># use pressure volume data provided by package
pv_data &lt;- pressure_volume_data

# do pressure volume curve analysis
pv_data &lt;- RelativeWaterDeficit(pv_data)
results &lt;- OsmoticPot(pv_data, graph = FALSE)

# extract curve values
ExtractParam(results)


</code></pre>

<hr>
<h2 id='FMSaturated'>Saturated fresh mass estimation</h2><span id='topic+FMSaturated'></span>

<h3>Description</h3>

<p>Calculates saturated fresh mass by fitting fresh mass values above the turgor loss point linearly to water potential values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FMSaturated(
  data,
  sample = "sample",
  water.potential = "water.potential",
  fresh.mass = "fresh.mass",
  dry.mass = "dry.mass"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FMSaturated_+3A_data">data</code></td>
<td>
<p>data frame, at least with a column containing numeric water potential (MPa), fresh.mass (g) and dry.mass (g) values,
ordered by sample by descending water potential.
A column containing the sample IDs is optionally required if several samples were measured.</p>
</td></tr>
<tr><td><code id="FMSaturated_+3A_sample">sample</code></td>
<td>
<p>optional name of the column in data containing the sample IDs, default: &quot;sample&quot;</p>
</td></tr>
<tr><td><code id="FMSaturated_+3A_water.potential">water.potential</code></td>
<td>
<p>optional name of the column in data containing the water potential values (MPa), default = &quot;water.potential&quot;</p>
</td></tr>
<tr><td><code id="FMSaturated_+3A_fresh.mass">fresh.mass</code></td>
<td>
<p>optional name of the column in data containing the fresh mass values (g), default: &quot;fresh mass&quot;</p>
</td></tr>
<tr><td><code id="FMSaturated_+3A_dry.mass">dry.mass</code></td>
<td>
<p>optional name of the column containing the dry mass values (g), default: &quot;dry.mass&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Above the turgor loss point, a linear relationship between water content and water potential exists. Based on this premise,
saturated water content is found where water potential is zero. First, turgor loss point is calculated based on the relative leaf water
loss (fresh mass minus dry mass relativized by the maximum
leaf water content value). Then, data above the turgor loss point is extracted and fresh mass is fitted linearly to water potential.
The point where water potential of the linear regression line is zero is the saturated water content. <br /> <br /> Before using this function,
check the data for an initial plateau. Data points in the initial part of the water potential
versus RWD plot with a stronger then expected decline need to be omitted.
</p>


<h3>Value</h3>

<p>the original data frame (data) extended by a numeric column containing the saturated fresh mass values (&quot;fresh.mass.saturated&quot;)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data
df &lt;- pressure_volume_data
# extend the data frame by saturated fresh mass
df &lt;- FMSaturated(df)

</code></pre>

<hr>
<h2 id='MergeDf'>Merges data to data frames</h2><span id='topic+MergeDf'></span>

<h3>Description</h3>

<p>merges data frames containing all neccessary informations for plotting with PlotOutput()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MergeDf(
  x,
  y,
  y2 = FALSE,
  y3 = FALSE,
  legend,
  legend.y2 = FALSE,
  legend.y3 = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MergeDf_+3A_x">x</code></td>
<td>
<p>vector containing the x values</p>
</td></tr>
<tr><td><code id="MergeDf_+3A_y">y</code></td>
<td>
<p>vector containing the y values</p>
</td></tr>
<tr><td><code id="MergeDf_+3A_y2">y2</code></td>
<td>
<p>optional vector containing the values for the second y coordinates</p>
</td></tr>
<tr><td><code id="MergeDf_+3A_y3">y3</code></td>
<td>
<p>optional vector containing the values for the third y coordinates</p>
</td></tr>
<tr><td><code id="MergeDf_+3A_legend">legend</code></td>
<td>
<p>name of the y values in the legend</p>
</td></tr>
<tr><td><code id="MergeDf_+3A_legend.y2">legend.y2</code></td>
<td>
<p>optional name of the second y values in the legend</p>
</td></tr>
<tr><td><code id="MergeDf_+3A_legend.y3">legend.y3</code></td>
<td>
<p>optional name of the third y values in the legend</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns containing all above information in equalized length as requested by gglot
</p>

<hr>
<h2 id='ModElasticity'>Modulus of elasticity</h2><span id='topic+ModElasticity'></span>

<h3>Description</h3>

<p>Determines pressure potential and the modulus of elasticity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ModElasticity(
  data,
  sample = "sample",
  water.potential = "water.potential",
  RWD = "RWD",
  graph = TRUE,
  show.legend = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ModElasticity_+3A_data">data</code></td>
<td>
<p>data frame containing columns of equal lengths giving the numerical
coordinates of the curve: water potential (MPa) and RWD (%), ordered by sample by descending water potential. A
column containing the sample IDs is optionally required if several samples were measured</p>
</td></tr>
<tr><td><code id="ModElasticity_+3A_sample">sample</code></td>
<td>
<p>optional column name in data containing the sample ID, default: &quot;sample&quot;</p>
</td></tr>
<tr><td><code id="ModElasticity_+3A_water.potential">water.potential</code></td>
<td>
<p>optional column name in data containing the water potential values of the leaf
(MPa), default: &quot;water.potential&quot;</p>
</td></tr>
<tr><td><code id="ModElasticity_+3A_rwd">RWD</code></td>
<td>
<p>optional column name in data containing the relative water deficit values (%), default: &quot;RWD&quot;</p>
</td></tr>
<tr><td><code id="ModElasticity_+3A_graph">graph</code></td>
<td>
<p>set FALSE if no plots are to be returned</p>
</td></tr>
<tr><td><code id="ModElasticity_+3A_show.legend">show.legend</code></td>
<td>
<p>set FALSE if no legend is to be shown in the plots</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Relative water deficit at turgor loss point is determined via the function TurgorLossPoint() and
osmotic potential is calculated via the function OsmoticPot(). <br /> <br /> Pressure potential is derived by
subtracting osmotic potential from water potential. The part of the pressure potential prior the turgor loss
point is then fitted linearly and after transformation of RWD (
slope of the fitted line. <br /> <br />
Before using this function, check the data for an initial plateau. Data points in the initial part of the water potential
versus RWD plot with a stronger then expected decline need to be omitted.
</p>


<h3>Value</h3>

<p>List splitted by sample consisting of
</p>
<table>
<tr><td><code>modulus.elasticity</code></td>
<td>
<p>modulus of elasticity (MPa)</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>formula of the transformed linear osmotic potential fit (1/-MPa) and the pressure potential (MPa) fit</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>coefficients of the osmotic (1/-MPa) and pressure potential (MPa) fit</p>
</td></tr>
<tr><td><code>conf_int</code></td>
<td>
<p>upper (97.5 %) and lower (2.5 %) border of 95 % confidence interval of model parameters</p>
</td></tr>
</table>
<p>If graph = TRUE, the original data is displayed with the x- and y-axis intercepts of the turgor loss
point, the osmotic potential fit and
the linear regression line of the pressure potential.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#get example data, calculate Relative Water Deficit
data &lt;- RelativeWaterDeficit(pressure_volume_data)[pressure_volume_data$sample == 10, ]

# determine modulus of elasticity and the fitting parameters. Do not plot results.
m_elasticity &lt;- ModElasticity(data, graph = FALSE)

</code></pre>

<hr>
<h2 id='OrderCheck'>Order Check</h2><span id='topic+OrderCheck'></span>

<h3>Description</h3>

<p>Checks for the correct ordering of the data: increasing for date.and.time and time.since start, decreasing for fresh.mass and
water.potential. Done separatly for each sample. An individualized warning is printed if not ordered correctly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OrderCheck(data, sample = FALSE, fresh.mass = FALSE, water.potential = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OrderCheck_+3A_data">data</code></td>
<td>
<p>data frame containing the data to be checked</p>
</td></tr>
<tr><td><code id="OrderCheck_+3A_sample">sample</code></td>
<td>
<p>name of the column containing the sample IDs, if present in data</p>
</td></tr>
<tr><td><code id="OrderCheck_+3A_fresh.mass">fresh.mass</code></td>
<td>
<p>name of the column containing the numeric fresh mass values, if present in data</p>
</td></tr>
<tr><td><code id="OrderCheck_+3A_water.potential">water.potential</code></td>
<td>
<p>name of the column containing the numeric water potential values, if present in data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value
</p>

<hr>
<h2 id='OsmoticPot'>Pressure Volume Curve Analysis</h2><span id='topic+OsmoticPot'></span>

<h3>Description</h3>

<p>Determines the coordinates of the turgor loss point, osmotic potential at full hydration
and apoplastic fraction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OsmoticPot(
  data,
  sample = "sample",
  water.potential = "water.potential",
  RWD = "RWD",
  graph = TRUE,
  show.legend = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OsmoticPot_+3A_data">data</code></td>
<td>
<p>data frame containing columns of equal lengths giving the numerical
coordinates of the curve: water potential (MPa) and RWD (%), ordered by sample by descending water potential. A
column containing the sample IDs is optionally required if several samples were measured.</p>
</td></tr>
<tr><td><code id="OsmoticPot_+3A_sample">sample</code></td>
<td>
<p>optional column name in data containing the sample ID, default: &quot;sample&quot;</p>
</td></tr>
<tr><td><code id="OsmoticPot_+3A_water.potential">water.potential</code></td>
<td>
<p>optional column name in data containing the numeric water potential values
(MPa), default: &quot;water.potential&quot;</p>
</td></tr>
<tr><td><code id="OsmoticPot_+3A_rwd">RWD</code></td>
<td>
<p>optional column name in data containing the relative water deficit values (%), default: &quot;RWD&quot;</p>
</td></tr>
<tr><td><code id="OsmoticPot_+3A_graph">graph</code></td>
<td>
<p>set FALSE if no plots are to be returned</p>
</td></tr>
<tr><td><code id="OsmoticPot_+3A_show.legend">show.legend</code></td>
<td>
<p>set FALSE if no legend is to be shown in the plots</p>
</td></tr>
</table>


<h3>Details</h3>

<p>RWD at turgor loss point is derived by the function TurgorLossPoint(). <br /> <br />
The pressure-volume curve data is converted to -1/MPa. The osmotic potential is then derived by fitting a linear
regression line with the Gauss-Newton algorithm of nls() to the water potential data following the turgor loss point. The y- and
x-axis intercept of the regression line gives the osmotic potential at full hydration (op.full.sat) and the RWD at zero 1/-Psi,
respectively. RWD at zero1/-Psi is then transferred to RWC at zero 1/-Psi to derive apoplastic fraction
(apo.fract). The turgor loss point equals the value of the osmotic potential fit at the relative
water deficit at turgor loss point. <br /> <br /> Before using this function, check the data for an initial plateau. Data points in the initial part of the water potential
versus RWD plot with a stronger then expected decline need to be omitted.
</p>


<h3>Value</h3>

<p>List splitted by sample consisting of
</p>
<table>
<tr><td><code>turgor.loss.point</code></td>
<td>
<p>x and y coordinates of the turgor loss point (RWD (%) and water.potential (MPa), respectively)</p>
</td></tr>
<tr><td><code>osmotic.potential</code></td>
<td>
<p>x and y intercepts of the osmotic potential fit (apoplasic fraction (apo.fract) (%) and op.full.sat (MPa), respectively)</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>formula of the linear osmotic potential fit</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>coefficients of the linear model</p>
</td></tr>
<tr><td><code>conf_int</code></td>
<td>
<p>upper (97.5 %) and lower (2.5 %) border of 95 % confidence interval of model parameters</p>
</td></tr>
</table>
<p>If graph = TRUE, the plotted tranformed data is displayed with the x- and y-axis
intercepts of the turgor loss point and the
linear regression line of the osmotic potential showing the point of y-intercept (op.full.sat) and x-intercept (apo.fract). <br />
Before using this function, check the raw data for an initial plateau. If the exponential decline does not onset directly,
fitting might not succeed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data, calculate Relative Water Deficit
data &lt;- RelativeWaterDeficit(pressure_volume_data)[pressure_volume_data$sample == 10, ]

# calculate pressure volume curve characteristics and plot graphs
pv_analysis &lt;- OsmoticPot(data)

</code></pre>

<hr>
<h2 id='PlotOutput'>Plot Output</h2><span id='topic+PlotOutput'></span>

<h3>Description</h3>

<p>plots the data as specified
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotOutput(
  sub.sample,
  x,
  y,
  y2 = FALSE,
  y3 = FALSE,
  legend.y,
  legend.y2 = FALSE,
  legend.y3 = FALSE,
  x.axis,
  y.axis,
  x.intercept = FALSE,
  y.intercept = FALSE,
  legend.x.intercept = FALSE,
  line.x,
  line.y,
  line.y2 = FALSE,
  line.y3 = FALSE,
  legend.line.y,
  legend.line.y2 = FALSE,
  legend.line.y3 = FALSE,
  show.legend = show.legend
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PlotOutput_+3A_sub.sample">sub.sample</code></td>
<td>
<p>sample ID</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_x">x</code></td>
<td>
<p>vector containing the x coordinates of the data to be plotted as points</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_y">y</code></td>
<td>
<p>vector containing the y coodinates of the data to be plotted as points</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_y2">y2</code></td>
<td>
<p>optional vector containing the second y coordinates of the data to be plotted as points</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_y3">y3</code></td>
<td>
<p>optional vector containing the third y coordinates of the data to be plotted as points</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_legend.y">legend.y</code></td>
<td>
<p>string, name of data points to be printed in the legend</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_legend.y2">legend.y2</code></td>
<td>
<p>string, optional name of second set of data points to be printed in the legend</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_legend.y3">legend.y3</code></td>
<td>
<p>string, optional name of third set of data points to be printed in the legend</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_x.axis">x.axis</code></td>
<td>
<p>string, label of x axis</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_y.axis">y.axis</code></td>
<td>
<p>sring, label of y axis</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_x.intercept">x.intercept</code></td>
<td>
<p>vector containg the x coordinate of the intercept</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_y.intercept">y.intercept</code></td>
<td>
<p>optional vector containg the y coordinate of the intercept</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_legend.x.intercept">legend.x.intercept</code></td>
<td>
<p>string, name of x.intercept to be printed in the legend</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_line.x">line.x</code></td>
<td>
<p>vector containing the x coordinate for the lines</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_line.y">line.y</code></td>
<td>
<p>vector containing the y coordinates for the line</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_line.y2">line.y2</code></td>
<td>
<p>vector containing the y coordinates for the second line</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_line.y3">line.y3</code></td>
<td>
<p>vector containing the y coordinates for the second line</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_legend.line.y">legend.line.y</code></td>
<td>
<p>string, name of line to be printed in the legend</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_legend.line.y2">legend.line.y2</code></td>
<td>
<p>string, name of second line to be printed in the legend</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_legend.line.y3">legend.line.y3</code></td>
<td>
<p>string, name of third line to be printed in the legend</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_show.legend">show.legend</code></td>
<td>
<p>boolean, specifies whether a legend is to be printed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>graphic
</p>

<hr>
<h2 id='pressure_volume_data'>Pressure volume curve data</h2><span id='topic+pressure_volume_data'></span>

<h3>Description</h3>

<p>A dataset containing water potential and fresh mass measurements of repeatedly measured drying kohlrabi leaves subjected to
different soil moisture conditions during their growth (n = 6) and their saturated fresh mass and dry mass.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pressure_volume_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 160 rows and 8 variables
</p>


<h3>Details</h3>


<ul>
<li><p> date: Date of measurement
</p>
</li>
<li><p> treatment: Soil moisture conditions during the last 6 days of Kohlrabi growth (10-30 
</p>
</li>
<li><p> sample: Sample ID (1 - 12)
</p>
</li>
<li><p> fresh.mass.harvest: Fresh mass measured at harvest (12 h prior measurement of fresh.mass.saturated) (2.9813 - 7.1557)
</p>
</li>
<li><p> fresh.mass.saturated: Saturated fresh mass of the leaf in gramms (4.1276 - 7.0867)
</p>
</li>
<li><p> fresh.mass: Fresh mass of the leaf in gramms (2.7215 - 6.8246)
</p>
</li>
<li><p> dry.mass: Dry mass of the leaf in gramms (0.2937 - 0.7267)
</p>
</li>
<li><p> water.potential: Water potential of the leaf in MPa (-1.62 - -0.24)
</p>
</li></ul>


<hr>
<h2 id='RelativeWaterContent'>Relative Water Content (RWC)</h2><span id='topic+RelativeWaterContent'></span>

<h3>Description</h3>

<p>Calculates relative water content (RWC, %)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RelativeWaterContent(
  data,
  fresh.mass = "fresh.mass",
  dry.mass = "dry.mass",
  fresh.mass.saturated = "fresh.mass.saturated"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RelativeWaterContent_+3A_data">data</code></td>
<td>
<p>data frame with columns of equal length containing at least columns with the fresh mass (g),
the dry mass (g) and the saturated fresh mass (g)</p>
</td></tr>
<tr><td><code id="RelativeWaterContent_+3A_fresh.mass">fresh.mass</code></td>
<td>
<p>optional name of the column in data containing
the numeric fresh mass values (g); default: &quot;fresh.mass&quot;</p>
</td></tr>
<tr><td><code id="RelativeWaterContent_+3A_dry.mass">dry.mass</code></td>
<td>
<p>optional name of the column in data containing
the numeric dry mass values (g); default: &quot;dry.mass&quot;</p>
</td></tr>
<tr><td><code id="RelativeWaterContent_+3A_fresh.mass.saturated">fresh.mass.saturated</code></td>
<td>
<p>optional name of the column in data containing
the numeric saturated fresh mass values (g); default: &quot;fresh.mass.saturated&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Relative water content (%) is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">RWC = 100 * ((FM - DM) (FMs - DM)^-1)</code>
</p>

<p>whereas FM = fresh mass, DM = dry mass and FMs = fresh mass at water saturation.
</p>


<h3>Value</h3>

<p>the original data frame extended by a numeric column with the relative water content (RWC) (%).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data
df &lt;- pressure_volume_data

# extend df by RWC
df_with_RWC &lt;- RelativeWaterContent(df)

</code></pre>

<hr>
<h2 id='RelativeWaterDeficit'>Relative Water Deficit (RWD)</h2><span id='topic+RelativeWaterDeficit'></span>

<h3>Description</h3>

<p>Calculates relative water deficit (%)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RelativeWaterDeficit(
  data,
  fresh.mass = "fresh.mass",
  dry.mass = "dry.mass",
  fresh.mass.saturated = "fresh.mass.saturated"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RelativeWaterDeficit_+3A_data">data</code></td>
<td>
<p>data frame with columns of equal length containing at least columns with the fresh mass (g),
the dry mass (g) and the saturated fresh mass (g)</p>
</td></tr>
<tr><td><code id="RelativeWaterDeficit_+3A_fresh.mass">fresh.mass</code></td>
<td>
<p>optional name of the column in data containing
the numeric fresh mass values (g); default: fresh.mass</p>
</td></tr>
<tr><td><code id="RelativeWaterDeficit_+3A_dry.mass">dry.mass</code></td>
<td>
<p>optional name of the column in data containing
the numeric dry mass values (g); default: dry.mass</p>
</td></tr>
<tr><td><code id="RelativeWaterDeficit_+3A_fresh.mass.saturated">fresh.mass.saturated</code></td>
<td>
<p>optional name of the column in data containing
the numeric saturated fresh mass values (g); default: fresh.mass.saturated</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Relative water deficit (%) is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">RWD = 100 - 100 * ((FM - DM) (FMs - DM)^-1)</code>
</p>

<p>whereas FM = fresh mass, DM = dry mass and FMs = fresh mass at water saturation.
</p>


<h3>Value</h3>

<p>the original data frame extended by a numeric column with the relative water deficit (RWD) (%).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data
df &lt;- pressure_volume_data

# extend df by RWD
df_with_RWD &lt;- RelativeWaterDeficit(df)

</code></pre>

<hr>
<h2 id='TurgorLossPoint'>Turgor Loss Point</h2><span id='topic+TurgorLossPoint'></span>

<h3>Description</h3>

<p>Determines the x coordinate (RWD) of the turgor loss point in a set of experimentally obtained
pressure volume curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TurgorLossPoint(
  data,
  sample = "sample",
  water.potential = "water.potential",
  RWD = "RWD",
  graph = TRUE,
  show.legend = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TurgorLossPoint_+3A_data">data</code></td>
<td>
<p>data frame containing columns of equal lengths giving at least the numerical
coordinates of the curve: water potential (MPa) and RWD (%), ordered by sample by descending water potential. A
column containing the sample IDs is optionally required if several samples were measured.</p>
</td></tr>
<tr><td><code id="TurgorLossPoint_+3A_sample">sample</code></td>
<td>
<p>optional name of the column in data containing the sample ID, default: &quot;sample&quot;</p>
</td></tr>
<tr><td><code id="TurgorLossPoint_+3A_water.potential">water.potential</code></td>
<td>
<p>optional name of the column in data containing the numeric water potential values (MPa), default: &quot;water.potential&quot;</p>
</td></tr>
<tr><td><code id="TurgorLossPoint_+3A_rwd">RWD</code></td>
<td>
<p>optional name of the column in data containing numeric relative water deficit values (%), default: &quot;RWD&quot;</p>
</td></tr>
<tr><td><code id="TurgorLossPoint_+3A_graph">graph</code></td>
<td>
<p>set FALSE if no plots are to be returned</p>
</td></tr>
<tr><td><code id="TurgorLossPoint_+3A_show.legend">show.legend</code></td>
<td>
<p>set FALSE if no legend is to be shown in the plots</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Before using this function, check the data for an initial plateau. Data points in the initial part of the water potential
versus RWD plot with a stronger then expected decline need to be omitted. <br /> <br />
The data is fitted using the Gauss-Newton algorithm of nls() to a combined exponential and linear
model. The exponential and linear parts are extracted and RWD at turgor loss point is localized at their point of minimum distance.
</p>


<h3>Value</h3>

<p>List splitted by sample consisting of
</p>
<table>
<tr><td><code>turgor.loss.point</code></td>
<td>
<p>coordinates of the turgor loss point (RWD)</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>formula of the exponential and linear part of the combined fits</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>coefficients of combined model</p>
</td></tr>
<tr><td><code>conf_int</code></td>
<td>
<p>upper (97.5 %) and lower (2.5 %) border of 95 % confidence interval of model parameters</p>
</td></tr>
</table>
<p>If graph = TRUE, the plotted original data is displayed with the exponential and
linear fit of the combined model as well as the x-coordinate (RWD) of the turgor loss point.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get sample data
data &lt;- RelativeWaterDeficit(pressure_volume_data)[pressure_volume_data$sample == 10, ]

# identify turgor loss point in curve
turgor_loss_point &lt;- TurgorLossPoint(data)

</code></pre>

<hr>
<h2 id='ValidityCheck'>Ensures the validity of the input data</h2><span id='topic+ValidityCheck'></span>

<h3>Description</h3>

<p>Ensures the validity of the input data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ValidityCheck(
  data,
  sample = FALSE,
  dry.mass = FALSE,
  fresh.mass.saturated = FALSE,
  fresh.mass = FALSE,
  water.potential = FALSE,
  RWD = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ValidityCheck_+3A_data">data</code></td>
<td>
<p>data frame containing the data to be checked</p>
</td></tr>
<tr><td><code id="ValidityCheck_+3A_sample">sample</code></td>
<td>
<p>name of column containing the sample ID (default: sample)</p>
</td></tr>
<tr><td><code id="ValidityCheck_+3A_dry.mass">dry.mass</code></td>
<td>
<p>name of column containing the dry mass (g) (default: dry mass)</p>
</td></tr>
<tr><td><code id="ValidityCheck_+3A_fresh.mass.saturated">fresh.mass.saturated</code></td>
<td>
<p>name of column containing the saturated fresh mass (g) (default: fresh.mass.saturated)</p>
</td></tr>
<tr><td><code id="ValidityCheck_+3A_fresh.mass">fresh.mass</code></td>
<td>
<p>name of column containing the fresh mass (g) (default: fresh.mass)</p>
</td></tr>
<tr><td><code id="ValidityCheck_+3A_water.potential">water.potential</code></td>
<td>
<p>name of column containing the water potential (MPa) (default: water.potential)</p>
</td></tr>
<tr><td><code id="ValidityCheck_+3A_rwd">RWD</code></td>
<td>
<p>name of column containing the relative water deficit (default: RWD)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value
</p>

<hr>
<h2 id='ValidityCheckDetail'>Checks if column exists in data, is numeric and has the same lenghts as the others existence</h2><span id='topic+ValidityCheckDetail'></span>

<h3>Description</h3>

<p>Checks if column exists in data, is numeric and has the same lenghts as the others existence
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ValidityCheckDetail(data_in, value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ValidityCheckDetail_+3A_data_in">data_in</code></td>
<td>
<p>data frame to be checked</p>
</td></tr>
<tr><td><code id="ValidityCheckDetail_+3A_value">value</code></td>
<td>
<p>column in data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
