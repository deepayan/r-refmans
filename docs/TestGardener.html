<!DOCTYPE html><html><head><title>Help for package TestGardener</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TestGardener}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Analyze'>
<p>Analyze test or rating scale data defined in <code>dataList</code>.</p></a></li>
<li><a href='#chcemat_simulate'>
<p>Simulate a test or scale data matrix.</p></a></li>
<li><a href='#dataSimulation'><p>Simulation Based Estimates of Error Variation of Score Index Estimates</p></a></li>
<li><a href='#density_plot'>
<p>Plot the probability density function for a set of test scores</p></a></li>
<li><a href='#DFfun'><p>Compute the first and second derivatives of the negative log likelihoods</p></a></li>
<li><a href='#entropies'>
<p>Entropy measures of inter-item dependency</p></a></li>
<li><a href='#Entropy_plot'>
<p>Plot item entropy curves for selected items or questions.</p></a></li>
<li><a href='#eval.surp'><p>Values of a Functional Data Object Defining Surprisal Curves.</p></a></li>
<li><a href='#Fcurve'>
<p>Construct grid of 101 values of the fitting function</p></a></li>
<li><a href='#Ffun'><p>Compute the negative log likelihoods associated with a vector of score index values.</p></a></li>
<li><a href='#Ffuns_plot'>
<p>Plot a selection of fit criterion F functions and their first two derivatives.</p></a></li>
<li><a href='#ICC'><p>Plotting probability and surprisal curves for an item</p></a></li>
<li><a href='#ICC_plot'><p>Plot probability and surprisal curves for test or scale items.</p></a></li>
<li><a href='#index_distn'><p>Compute score density</p></a></li>
<li><a href='#index_fun'><p>Compute optimal scores</p></a></li>
<li><a href='#index_search'>
<p>Ensure that estimated score index is global</p></a></li>
<li><a href='#index2info'>
<p>Compute results using arc length or information as the abscissa.</p></a></li>
<li><a href='#make_dataList'>
<p>Make a list object containing information required for analysis of choice</p>
data.</a></li>
<li><a href='#mu'><p>Compute the expected test score by substituting probability of choices</p>
for indicator variable 0-1 values.
Binary items assumed coded as two choice items.</a></li>
<li><a href='#mu_plot'>
<p>Plot expected test score as a function of score index</p></a></li>
<li><a href='#Power_plot'><p>Plot item power curves for selected items or questions.</p></a></li>
<li><a href='#Quant_13B_problem_chcemat'><p>Test data for 24 math calculation questions from the SweSAT data.</p></a></li>
<li><a href='#Quant_13B_problem_dataList'>
<p>List of objects essential for an analysis of the abbreviated SweSAT</p>
Quantitative multiple choice test.</a></li>
<li><a href='#Quant_13B_problem_infoList'>
<p>Arclength or information parameter list for 24 items from the quantitative</p>
SweSAT subtest.</a></li>
<li><a href='#Quant_13B_problem_key'>
<p>Option information for the short form of the SweSAT Quantitative test.</p></a></li>
<li><a href='#Quant_13B_problem_parmList'>
<p>Parameter list for 24 items from the quantitative SweSAT subtest.</p></a></li>
<li><a href='#Sbinsmth'><p>Estimate the option probability and surprisal curves.</p></a></li>
<li><a href='#Sbinsmth_nom'>
<p>List vector containing numbers of options and boundaries.</p></a></li>
<li><a href='#Scope_plot'>
<p>Plot the score index <code>index</code> as a function of arc length.</p></a></li>
<li><a href='#scoreDensity'>
<p>Compute and plot a score density histogram and and curve.</p></a></li>
<li><a href='#scorePerformance'>
<p>Calculate mean squared error and bias for a set of score index values from</p>
simulated data.</a></li>
<li><a href='#Sensitivity_plot'>
<p>Plots all the sensitivity curves for selected items or questions.</p></a></li>
<li><a href='#SimulateData'>
<p>Simulate Choice Data from a Previous Analysis</p></a></li>
<li><a href='#smooth.ICC'>
<p>Smooth binned probability and surprisal values to make an <code>ICC</code> object.</p></a></li>
<li><a href='#smooth.surp'>
<p>Fit data with surprisal smoothing.</p></a></li>
<li><a href='#Spca'>
<p>Functional principal components analysis of information curve</p></a></li>
<li><a href='#Spca_plot'>
<p>Plot the test information or scale curve in either two or three dimensions.</p></a></li>
<li><a href='#TestGardener'><p>Analyses of Tests and Rating Scales using Information or Surprisal</p></a></li>
<li><a href='#TestInfo_svd'>
<p>Image of the Test Tnformation Curve in 2 or 3 Dimensions</p></a></li>
<li><a href='#TG_analysis'><p>Statistics for Multiple choice Tests, Rating Scales and Other Choice Data)</p></a></li>
<li><a href='#TG_density.fd'>
<p>Compute a Probability Density Function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>3.3.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-20</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Information Analysis for Test and Rating Scale Data</td>
</tr>
<tr>
<td>Author:</td>
<td>James Ramsay [aut, cre],
  Juan Li [ctb],
  Marie Wiberg [ctb],
  Joakim Wallmark [ctb],
  Spencer Graves [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>James Ramsay &lt;james.ramsay@mcgill.ca&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5), fda, rgl, ggplot2, plotly</td>
</tr>
<tr>
<td>Description:</td>
<td>Develop, evaluate, and score multiple choice examinations, 
 psychological scales, questionnaires, and similar types of data involving
 sequences of choices among one or more sets of answers.
 This version of the package should be considered as brand new.  Almost all
 of the functions have been changed, including their argument list.
 See the file NEWS.Rd in the Inst folder for more information.
 Using the package does not require any formal statistical knowledge 
 beyond what would be provided by a first course in statistics in a 
 social science department.  There the user would encounter the concept 
 of probability and how it is used to model data and make decisions, 
 and would become familiar with basic mathematical and statistical notation.
 Most of the output is in graphical form. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggpubr, stringr, tidyr, pracma, utf8, knitr, rmarkdown,</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-20 13:11:45 UTC; jimramsay</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-20 13:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Analyze'>
Analyze test or rating scale data defined in <code>dataList</code>.
</h2><span id='topic+Analyze'></span>

<h3>Description</h3>

<p>The test or rating scale data have already been processed by function <code>make_dataList</code> or
or other code to produce the list object <code>dataList</code>.  The user defines a list vector
<code>ParameterList</code> which stores results from a set of cycles of estimating surprisal curves
followed by estimating optimal score index values for each examinee or respondent.  These
score index values are within the interval [0,100].  The number of analysis cycles is the
length of the <code>parmList</code> list vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  Analyze(index, indexQnt, dataList, NumDensBasis=7, ncycle=10, itdisp=FALSE, 
          verbose=FALSE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Analyze_+3A_index">index</code></td>
<td>
<p>A vector of <code>N</code> score index values for the examinees or respondents.
These values are in the percent interval [0,100].</p>
</td></tr>
<tr><td><code id="Analyze_+3A_indexqnt">indexQnt</code></td>
<td>
<p>A vector of length <code>2*nbin + 1</code> where <code>nbin</code> is the 
number of bins containing score index values.  The vector begins with the lower
boundary 0 and ends with the upper boundary 100.  In between it alternates 
between the bin center value and the boundary separating the next bin.</p>
</td></tr>
<tr><td><code id="Analyze_+3A_datalist">dataList</code></td>
<td>
<p>A list that contains the objects needed to analyse the test or rating scale
with the following fields:
</p>

<dl>
<dt>chce:</dt><dd><p>A matrix of response data with N rows and n columns where
N is the number of examinees or respondents and
n is the number of items.
Entries in the matrices are the indices of the options chosen.
Column i of chce is expected to contain only the integers 1,...,noption.</p>
</dd>  
<dt>optList:</dt><dd><p>A list vector containing the numerical score values assigned to the
options for this question.</p>
</dd>
<dt>key:</dt><dd><p>If the data are from a test of the multiple choices type
where the right answer is scored 1 and the wrong answers 0, this is a numeric vector 
of length n containing the indices the right answers.  Otherwise, it is NULL.</p>
</dd>
<dt>Sfd:</dt><dd><p>An fd object for the defining the surprisal curves.</p>
</dd>
<dt>noption:</dt><dd><p>A numeric vector of length n containing the numbers of options for 
each item.</p>
</dd>
<dt>nbin:</dt><dd><p>The number of bins for binning the data.</p>
</dd>
<dt>scrrng:</dt><dd><p>A vector of length 2 containing the limits of observed sum scores.</p>
</dd>
<dt>scrfine:</dt><dd><p>A fine mesh of test score values for plotting.</p>
</dd>
<dt>scrvec:</dt><dd><p>A vector of length N containing the examinee or respondent sum scores.</p>
</dd>
<dt>itemvec:</dt><dd><p>A vector of length n containing the question or item sum scores.</p>
</dd>
<dt>percntrnk:</dt><dd><p>A vector length N containing the sum score percentile ranks.</p>
</dd>
<dt>indexQnt:</dt><dd><p>A numeric vector of length 2*nbin + 1 containing the bin boundaries
alternating with the bin centers. These are initially defined as 
seq(0,100,len=2*nbin+1).</p>
</dd>
<dt>Sdim:</dt><dd><p>The total dimension of the surprisal scores.</p>
</dd>
<dt>PcntMarkers:</dt><dd><p>The marker percentages for plotting: 5, 25, 50, 75 and 95.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="Analyze_+3A_numdensbasis">NumDensBasis</code></td>
<td>
<p>The number of basis functions for representing the score density.</p>
</td></tr>
<tr><td><code id="Analyze_+3A_ncycle">ncycle</code></td>
<td>
<p>The number of cycles executed by function <code>Analyze()</code>.</p>
</td></tr>
<tr><td><code id="Analyze_+3A_itdisp">itdisp</code></td>
<td>
<p>If TRUE, the progress of the iterations within each cycle for estimating
index are reported.</p>
</td></tr>
<tr><td><code id="Analyze_+3A_verbose">verbose</code></td>
<td>
<p>If TRUE, the stages of analysis within each cycle for estimating
index are reported.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The cycling process is described in detail in the references, and displayed in R code 
in the vignette <code>SweSATQuantitativeAnalysis</code>.
</p>


<h3>Value</h3>

<p>The list vector <code>parmList</code> where each member is a named list object containing 
the results of an analysis cycle.  These results are:
</p>
<table>
<tr><td><code>index:</code></td>
<td>
<p>The optimal estimates of the score index values for the 
examinees/respondents.  This is a vector of length <code>N</code>.</p>
</td></tr>
<tr><td><code>indexQnt:</code></td>
<td>
<p>A vector of length 2*nbin+1 containing bin boundaries alternating
with bin edges.</p>
</td></tr>
<tr><td><code>SfdList:</code></td>
<td>
<p>A list vector containing results from the estimation of surprisal 
curves. The list vector is of length <code>n</code>, the number of questions or items in 
the test of rating scale.  For details concerning these results, see function 
<code>Sbinsmth()</code>.</p>
</td></tr>
<tr><td><code>meanF:</code></td>
<td>
<p>For each person, the mean of the optimal fitting function values.</p>
</td></tr>
<tr><td><code>binctr:</code></td>
<td>
<p>A vector of length <code>nbin</code> containing the bin centers within 
the interval [0,100].</p>
</td></tr>
<tr><td><code>bdry:</code></td>
<td>
<p>A vector of length <code>nbin+1</code> containing the bin boundaries.</p>
</td></tr>
<tr><td><code>freq:</code></td>
<td>
<p>A vector of length <code>nbin</code> containing the number of score 
index values in the bins.  An score index value is within a bin if it is less than 
or equal to the upper boundary and greater than the lower boundary.  The first 
boundary also contains zero values.</p>
</td></tr>
<tr><td><code>pdf_fd</code></td>
<td>
<p>Functional probability curves</p>
</td></tr>
<tr><td><code>logdensfd:</code></td>
<td>
<p>A functional data object defining the estimate of the log of the 
probability density function for the distribution of the score index values.</p>
</td></tr>
<tr><td><code>C:</code></td>
<td>
<p>The normalizing value for probability density functions.  
A density value is computed by dividing the exponential of the log density value 
by this constant.</p>
</td></tr>
<tr><td><code>denscdf:</code></td>
<td>
<p>The values over a fine mesh of the cumulative probability 
distribution function. These values start at 0 and end with 1 and are increasing.  
Ties are often found at the upper boundary, so that using these values for 
interpolation purposes may require using the vector <code>unique(denscdf)</code>.</p>
</td></tr>
<tr><td><code>indcdf</code></td>
<td>
<p>Equally spaced index values to match the number in denscdf.</p>
</td></tr>
<tr><td><code>Qvec</code></td>
<td>
<p>Locations of the marker percents.</p>
</td></tr>
<tr><td><code>index</code></td>
<td>
<p>The positions of each test taker on the score index continuum.</p>
</td></tr>
<tr><td><code>Fval:</code></td>
<td>
<p>A vector of length N containing the values of the negative log 
likelihood fitting criterion.</p>
</td></tr>
<tr><td><code>DFval:</code></td>
<td>
<p>A vector of length N containing the values of the first
derivative of the negative log likelihood fitting criterion.</p>
</td></tr>
<tr><td><code>D2Fval:</code></td>
<td>
<p>A vector of length N containing the values of the second
derivative of the negative log likelihood fitting criterion.</p>
</td></tr>
<tr><td><code>active:</code></td>
<td>
<p>A vector of length N of the activity status of the 
values of index.  If convergence was not achieved, the value is TRUE,
otherwise FALSE.</p>
</td></tr>  
<tr><td><code>infoSurp:</code></td>
<td>
<p>The length of the space curve defined by the surprisal curves.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make_dataList">make_dataList</a>,
        <a href="#topic+TG_analysis">TG_analysis</a>,
        <a href="#topic+index_distn">index_distn</a>,
        <a href="#topic+index2info">index2info</a>,
        <a href="#topic+index_fun">index_fun</a>,
        <a href="#topic+Sbinsmth">Sbinsmth</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  #  Example 1:  Input choice data and key for the short version of the 
  #  SweSAT quantitative multiple choice test with 24 items and 1000 examinees
  #  input the choice data as 1000 strings of length 24
  #  setup the input data list object
  dataList &lt;- Quant_13B_problem_dataList
  #  define the initial examinee indices and bin locations
  index    &lt;- dataList$percntrnk
  indexQnt &lt;- dataList$indexQnt
  #  Set the number of cycles (default 10 but here 5)
  ncycle &lt;- 5
  parmListvec &lt;- Analyze(index, indexQnt, ncycle=ncycle, dataList, 
                         verbose=TRUE) 
  #  two column matrix containing the mean fit and arclength values
  #  for each cycle
  HALsave &lt;- matrix(0,ncycle,2)
  for (icycle in 1:ncycle) {
    HALsave[icycle,1] &lt;- parmListvec[[icycle]]$meanF
    HALsave[icycle,2] &lt;- parmListvec[[icycle]]$infoSurp
  }
  #  plot the progress over the cycles of mean fit and arc length
  par(mfrow=c(2,1))
  plot(1:ncycle, HALsave[,1], type="b", lwd=2, 
       xlab="Cycle Number",ylab="Mean H")
  plot(1:ncycle, HALsave[,2], type="b", lwd=2, 
       xlab="Cycle Number", ylab="Arc Length")
## End(Not run)
</code></pre>

<hr>
<h2 id='chcemat_simulate'>
Simulate a test or scale data matrix.
</h2><span id='topic+chcemat_simulate'></span>

<h3>Description</h3>

<p>Used in <code>dataSimulation</code>, this function sets up an N by n matrix of 
index values that specify the index of the option chosen by an examinee or
respondent for a specific question.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  chcemat_simulate(index.pop, SfdList)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chcemat_simulate_+3A_index.pop">index.pop</code></td>
<td>
<p>A vector containing population score index values at which data
are to be simulated.</p>
</td></tr>
<tr><td><code id="chcemat_simulate_+3A_sfdlist">SfdList</code></td>
<td>

<p>A numbered list object produced by a TestGardener analysis of a test.  Its length
is equal to the number of items in the test or questions in the scale.  
Each member of <code>SfdList</code> is a named list containing information computed during the analysis.
These named lists contain these objects:
</p>

<dl>
<dt>Sfd:</dt><dd><p>A functional data object containing the <code>M</code> surprisal curves
f. or a question.</p>
</dd>
<dt>M:</dt><dd><p>The number of options.</p>
</dd>
<dt>Pbin:</dt><dd><p>A matrix containing proportions at each bin.</p>
</dd>
<dt>Sbin:</dt><dd><p>A matrix containing surprisal values at each bin.</p>
</dd>
<dt>Pmatfine:</dt><dd><p>A matrix of probabilities over a fine mesh.</p>
</dd>
<dt>Smatfine:</dt><dd><p>A matrix of surprisal values over a fine mesh.</p>
</dd>
<dt>DSmatfine:</dt><dd><p>A matrix of the values of the first derivative of 
surprisal curves over fine mesh.</p>
</dd>
<dt>D2Smatfine:</dt><dd><p>A matrix of the values of the second derivative of 
surprisal curves over fine mesh.</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Details</h3>

<p>For each question and each examinee a vector of random multinomial 
integer values is generated using the probability transforms of the surprisal 
curves and the examinee's score index value.</p>


<h3>Value</h3>

<p>An N by n matrix of integer index values.</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.          s
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>

<hr>
<h2 id='dataSimulation'>Simulation Based Estimates of Error Variation of Score Index Estimates</h2><span id='topic+dataSimulation'></span>

<h3>Description</h3>

<p>Estimate sum score,s score index values index and test information 
values bias and mean squared errors using simulated data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  dataSimulation(dataList, parmList, nsample = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dataSimulation_+3A_datalist">dataList</code></td>
<td>
<p>The list object set up by function <code>make_dataList</code>.</p>
</td></tr>
<tr><td><code id="dataSimulation_+3A_parmlist">parmList</code></td>
<td>
<p>The list object containing objects computed by function
<code>Analyze</code>.</p>
</td></tr>
<tr><td><code id="dataSimulation_+3A_nsample">nsample</code></td>
<td>
<p>The number of simulated samples.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list object containing objects produced from analyzing the simulations,
one set for each simulation:
</p>
<table>
<tr><td><code>sumscr:</code></td>
<td>
<p>Sum score estimates</p>
</td></tr>
<tr><td><code>index:</code></td>
<td>
<p>Score index estimates</p>
</td></tr>
<tr><td><code>mu:</code></td>
<td>
<p>Expected sum score estimates</p>
</td></tr>
<tr><td><code>info:</code></td>
<td>
<p>Total arc length estimates</p>
</td></tr>
<tr><td><code>index.pop:</code></td>
<td>
<p>True or population score index values</p>
</td></tr>
<tr><td><code>mu.pop:</code></td>
<td>
<p>Expected sum score population values</p>
</td></tr>
<tr><td><code>info.pop:</code></td>
<td>
<p>Total test length population values</p>
</td></tr>
<tr><td><code>n:</code></td>
<td>
<p>Number of items</p>
</td></tr>
<tr><td><code>nindex:</code></td>
<td>
<p>Number of index values</p>
</td></tr>
<tr><td><code>indfine:</code></td>
<td>
<p>Fine mesh over score index range</p>
</td></tr> 
<tr><td><code>Qvec:</code></td>
<td>
<p>Five marker percentages: 5, 25, 50, 75 and 95</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scorePerformance">scorePerformance</a></code>
</p>

<hr>
<h2 id='density_plot'>
Plot the probability density function for a set of test scores 
</h2><span id='topic+density_plot'></span>

<h3>Description</h3>

<p>Plots the probability density function of a set of 
score values that are not at the score boundaries as a smooth
curve, and also plots the proportions of score values at both
boundaries as points.  
The score values are typically either the values of the score index 
values index or the infoSurp or information score values.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>density_plot(scrvec, scrrng, Qvec, xlabstr=NULL, titlestr=NULL, 
                         scrnbasis=15, nfine=101)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="density_plot_+3A_scrvec">scrvec</code></td>
<td>
<p>A vector of N score values</p>
</td></tr>
<tr><td><code id="density_plot_+3A_scrrng">scrrng</code></td>
<td>
<p>A vector of length 2 containing boundary values</p>
</td></tr>
<tr><td><code id="density_plot_+3A_qvec">Qvec</code></td>
<td>
<p>A vector of length 5 containing the score values 
corresponding to the marker percentages 5, 25, 50, 75 and 95.</p>
</td></tr>
<tr><td><code id="density_plot_+3A_xlabstr">xlabstr</code></td>
<td>
<p>Label for abscissa</p>
</td></tr>
<tr><td><code id="density_plot_+3A_titlestr">titlestr</code></td>
<td>
<p>Label for plot</p>
</td></tr>
<tr><td><code id="density_plot_+3A_scrnbasis">scrnbasis</code></td>
<td>
<p>The number of spline basis functions used 
for representing the smooth density function</p>
</td></tr>
<tr><td><code id="density_plot_+3A_nfine">nfine</code></td>
<td>
<p>Number of plotting points</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the density function and a list vector <code>densfine</code> containing:
</p>
<table>
<tr><td><code>densfine:</code></td>
<td>
<p>Density values over a mesh of equally-spaced values 
of length 101.</p>
</td></tr>
<tr><td><code>N_min:</code></td>
<td>
<p>The number of examinees estimated to have zero information.</p>
</td></tr>
<tr><td><code>N_max:</code></td>
<td>
<p>The number of examinees estimated to have full information.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay
</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics. Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scoreDensity">scoreDensity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#  Example 1.  Display probability density curve for the 
#  score index values for the short SweSAT multiple choice test with 
#  24 items and 1000 examinees
index &lt;- Quant_13B_problem_parmList$index
Qvec  &lt;- Quant_13B_problem_parmList$Qvec
#  plot the density for the score indices within interval c(0,100)
oldpar &lt;- par(no.readonly=TRUE)
on.exit(oldpar)
par(mfrow=c(2,1))
density_plot(index, c(0,100), Qvec, xlabstr="Score index", 
             titlestr="SweSAT 13B Theta Density",  
             scrnbasis=11, nfine=101)
#  arc length or information values
scopevec &lt;- Quant_13B_problem_infoList$scopevec
Qinfovec &lt;- Quant_13B_problem_infoList$Qinfovec
infoSurp &lt;- Quant_13B_problem_infoList$infoSurp
#  plot the density for the score indices within interval c(0,infoSurp)
density_plot(scopevec, c(0,infoSurp), Qinfovec, xlabstr="Score index", 
             titlestr="SweSAT 13B Theta Density",  
             scrnbasis=11, nfine=101)
</code></pre>

<hr>
<h2 id='DFfun'>Compute the first and second derivatives of the negative log likelihoods</h2><span id='topic+DFfun'></span>

<h3>Description</h3>

<p>DFfun computes the first and second derivatives of the negative log likelihoods for 
a set of examinees.
Items can be either binary or multi-option.
The analysis is within the closed interval [0,100].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  DFfun(index, SfdList, chcemat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DFfun_+3A_index">index</code></td>
<td>
<p>Initial values for score indices in [0,n]/[0,100]. 
Vector of size N.</p>
</td></tr>
<tr><td><code id="DFfun_+3A_sfdlist">SfdList</code></td>
<td>
<p>A numbered list object produced by a TestGardener analysis of 
a test.  Its length is equal to the number of items in the test or questions 
in the scale. Each member of <code>SfdList</code> is a named list containing 
information computed during the analysis.</p>
</td></tr>
<tr><td><code id="DFfun_+3A_chcemat">chcemat</code></td>
<td>
<p>An <code>N</code> by <code>n</code> matrix of responses.  If <code>N</code> = 1, it 
can be a vector of length <code>n</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list for results <code>DF</code> and <code>D2F</code>:
</p>
<table>
<tr><td><code>DF:</code></td>
<td>
<p> First derivatives of the negative log likelihood values, 
vector of size N</p>
</td></tr>
<tr><td><code>D2F:</code></td>
<td>
<p>Second derivatives of the negative log likelihood values, 
vector of size N</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make_dataList">make_dataList</a>,
        <a href="#topic+index_fun">index_fun</a>,
        <a href="#topic+Ffun">Ffun</a>,
        <a href="#topic+Ffuns_plot">Ffuns_plot</a>
  </code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  #  Example 1:
  #  Compute the first and second derivative values of the objective function  
  #  for locating each examinee for the 24-item short form of the  
  #  SweSAT quantitative test on the percentile score index continuum.
  #  Use only the first five examinees.
  chcemat &lt;- Quant_13B_problem_dataList$chcemat
  SfdList &lt;- Quant_13B_problem_parmList$SfdList
  index   &lt;- Quant_13B_problem_parmList$index
  DFfunResult &lt;- DFfun(index[1:5], SfdList, chcemat[1:5,])
  DFval  &lt;- DFfunResult$DF
  D2Fval &lt;- DFfunResult$D2F
</code></pre>

<hr>
<h2 id='entropies'>
Entropy measures of inter-item dependency
</h2><span id='topic+entropies'></span>

<h3>Description</h3>

<p>Entropy <code class="reqn">I_1</code> is a scalar measure of how much information is required to predict 
the outcome of a choice number 1 exactly, and consequently is a measure of item effectiveness suitable for multiple choice tests and rating scales.  
Joint entropy <code class="reqn">J_{1,2}</code> is a scalar measure of the cross-product of multinomial 
vectors 1 and 2. Mutual entropy <code class="reqn">I_{1,2} = I_1 + I_2 - J_{1,2}</code> is a measure 
of the co-dependency of items 1 and 2, and thus the analogue of the negative
log of a squared correlation <code class="reqn">R^2</code>.  this function computes all four types
of entropies for two specificed items.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>entropies(index, m, n, chcemat, noption)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="entropies_+3A_index">index</code></td>
<td>
<p>A vector of length N containing score index values for each
test taker.</p>
</td></tr>
<tr><td><code id="entropies_+3A_m">m</code></td>
<td>
<p>The index of the first choice.</p>
</td></tr>
<tr><td><code id="entropies_+3A_n">n</code></td>
<td>
<p>The index of the second choice.</p>
</td></tr>
<tr><td><code id="entropies_+3A_chcemat">chcemat</code></td>
<td>
<p>The data matrix containing the indices of choisen options for
each test taker.</p>
</td></tr>
<tr><td><code id="entropies_+3A_noption">noption</code></td>
<td>
<p>A vector containing the number of options for all items.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list object containing objects produced from analyzing the simulations,
one set for each simulation:
</p>
<table>
<tr><td><code>I_m:</code></td>
<td>
<p>The entropy of item m.</p>
</td></tr>
<tr><td><code>I_n:</code></td>
<td>
<p>The entropy of item n.</p>
</td></tr>
<tr><td><code>J_nm:</code></td>
<td>
<p>The joint entropy of items m and n.</p>
</td></tr>
<tr><td><code>I_nm:</code></td>
<td>
<p>The mutual entropy of items m and n.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Entropy_plot">Entropy_plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#  Load needed objects
chcemat &lt;- Quant_13B_problem_dataList$chcemat
index   &lt;- Quant_13B_problem_parmList$index
noption &lt;- matrix(5,24,1)
#  compute mutual entropies for all pairs of the first 6 items
Mvec    &lt;- 1:6
Mlen    &lt;- length(Mvec)
Hmutual &lt;- matrix(0,Mlen,Mlen)
for (i1 in 1:Mlen) {
  for (i2 in 1:i1) {
    Result &lt;- entropies(index, Mvec[i1], Mvec[i2], chcemat, noption)
    Hmutual[i1,i2] = Result$Hmutual
    Hmutual[i2,i1] = Result$Hmutual
  }
}
print("Matrix of mutual entries (off-digagonal) and self-entropies (diagonal)")
print(round(Hmutual,3))
</code></pre>

<hr>
<h2 id='Entropy_plot'>
Plot item entropy curves for selected items or questions.
</h2><span id='topic+Entropy_plot'></span>

<h3>Description</h3>

<p>Item the value of the entropy curve at a point <code>theta</code> is the expected 
value of the surprisal curve values.  Entropy is a measure of the randomness 
of the surprisal value, which is maximized when all the surprisal curves 
have the same value and has a minimum of zero if all but a single curve has 
probability zero.  This is unattainable in the calculation, but can be
arbitrarily close to this state.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  Entropy_plot(scrfine, SfdList, Qvec, dataList, plotindex=1:n, 
               plotrange=c(min(scrfine),max(scrfine)), height=1.0, value=0,  
               ttlsz=NULL, axisttl=NULL, axistxt=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Entropy_plot_+3A_scrfine">scrfine</code></td>
<td>
<p>A vector of length nfine (usually 101) containing equally spaced
points spanning the plotrange.  Used for plotting.</p>
</td></tr>
<tr><td><code id="Entropy_plot_+3A_sfdlist">SfdList</code></td>
<td>
<p>A numbered list object produced by a TestGardener analysis of  
a test.  Its length is equal to the number of items in the test or questions 
in the scale.  Each member of <code>SfdList</code> is a named list containing 
information computed during the analysis.</p>
</td></tr>
<tr><td><code id="Entropy_plot_+3A_qvec">Qvec</code></td>
<td>
<p>The five marker percentile values.</p>
</td></tr>
<tr><td><code id="Entropy_plot_+3A_datalist">dataList</code></td>
<td>
<p>A list vector containing objects essential to an analysis.</p>
</td></tr>
<tr><td><code id="Entropy_plot_+3A_plotindex">plotindex</code></td>
<td>
<p>A set of integers specifying the numbers of the items or 
questions to be displayed.</p>
</td></tr>
<tr><td><code id="Entropy_plot_+3A_plotrange">plotrange</code></td>
<td>
<p>A vector of length 2 containing the plot boundaries within or
over the score index interval c(0,100).</p>
</td></tr>
<tr><td><code id="Entropy_plot_+3A_height">height</code></td>
<td>
<p>A positive real number defining the upper limit on the ordinate 
for the plots.</p>
</td></tr>
<tr><td><code id="Entropy_plot_+3A_value">value</code></td>
<td>
<p>Number required by ggplot2.  Defaults to 0.</p>
</td></tr>
<tr><td><code id="Entropy_plot_+3A_ttlsz">ttlsz</code></td>
<td>
<p>Title font size.</p>
</td></tr>
<tr><td><code id="Entropy_plot_+3A_axisttl">axisttl</code></td>
<td>
<p>Axis title font size.</p>
</td></tr>
<tr><td><code id="Entropy_plot_+3A_axistxt">axistxt</code></td>
<td>
<p>Axis text(tick label) font size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An entropy curve for each question indexed in the <code>index</code> argument.  
A request for a keystroke is made for each question.  The answer to question
strongly defines the optimal position of an estimated score index value where
the curve is high value.  Values of entropy curves typically range over [0,1].
</p>


<h3>Value</h3>

<p>The plots of the entropy curves specified in <code>plotindex</code> are produced as a side
effect.
If <code>saveplot</code> is TRUE, the plots of item entropy curves specified in 
<code>plotindex</code> are bundled into    a single postscript or .pdf file and the file name 
is defined by <code>paste(dataList$titlestr,i,'-entropy.pdf',sep="")</code>.  
The file is then output as a returned value.
</p>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sensitivity_plot">Sensitivity_plot</a></code>,
<code><a href="#topic+Power_plot">Power_plot</a></code>,
<code><a href="#topic+Ffuns_plot">Ffuns_plot</a></code>,
<code><a href="#topic+ICC_plot">ICC_plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  #  Example 1.  Display the item entropy curves for the 
  #  short SweSAT multiple choice test with 24 items and 1000 examinees
  #  plot the entropy curve for the first item
  dataList &lt;- Quant_13B_problem_dataList
  SfdList  &lt;- Quant_13B_problem_parmList$SfdList
  Qvec     &lt;- Quant_13B_problem_parmList$Qvec
  scrfine  &lt;- seq(0,100,len=101)
  oldpar   &lt;- par(no.readonly=TRUE)
  Entropy_plot(scrfine, SfdList, Qvec, dataList, plotindex=1)
  par(oldpar)
</code></pre>

<hr>
<h2 id='eval.surp'>Values of a Functional Data Object Defining Surprisal Curves.</h2><span id='topic+eval.surp'></span>

<h3>Description</h3>

<p>A surprisal vector of length <code>M</code> is minus the log to a positive integer 
base <code>M</code> of a set of <code>M</code> multinomial probabilities.  Surprisal
curves are functions of a one-dimensional index set, such that at any
value of the index set the values of the curves are a surprisal vector.
See Details below for further explanations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eval.surp(evalarg, Sfdobj, Zmat, nderiv = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eval.surp_+3A_evalarg">evalarg</code></td>
<td>
<p>a vector or matrix of argument values at which the functional 
data object is to be evaluated.</p>
</td></tr>
<tr><td><code id="eval.surp_+3A_sfdobj">Sfdobj</code></td>
<td>
<p>a functional data object of dimension <code>M-1</code> to be 
evaluated.</p>
</td></tr>
<tr><td><code id="eval.surp_+3A_zmat">Zmat</code></td>
<td>
<p>An <code>M by M-1</code> matrix satisfying <code>Zmat'Zmat = I} and 
  \code{Zmat'1 = 0</code>.</p>
</td></tr>
<tr><td><code id="eval.surp_+3A_nderiv">nderiv</code></td>
<td>
<p>An integer defining a derivatve of <code>Sfdobj</code> in
the set <code>c(0,1,2)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A surprisal <code>M</code>-vector is information measured in <code>M</code>-bits.
Since a multinomial probability vector must sum to one, it follows that the
surprisal vector <code>S</code> must satisfy the constraint 
<code>log_M(sum(M^(-S)) = 0.</code> That is, surprisal vectors lie within a
curved <code>M-1</code>-dimensional manifold.
</p>
<p>Surprisal curves are defined by a set of unconstrained <code>M-1</code> B-spline 
functional data objects defined over an index set that are transformed into 
surprisal curves defined over the index set.  
</p>
<p>Let <code>C</code> be a <code>K</code> by <code>M-1</code> coefficient matrix defining the 
B-spline curves, where <code>K</code> is the number of B-spline basis functions.  
</p>
<p>Let a <code>M</code> by <code>M-1</code> matrix <code>Z</code> have orthonormal columns.
Matrices satisfying these constraints are generated by function 
<code>zerobasis()</code>.  
</p>
<p>Let <code>N</code> by <code>K</code> matrix be a matrix of B-spline basis values
evaluated at <code>N</code> evaluation points using function 
<code>eval.basis()</code>.
</p>
<p>Let <code>N</code> by <code>M</code> matrix <code>X</code> = <code>B * C * t(Z)</code>. 
</p>
<p>Then the <code>N</code> by <code>M</code> matrix <code>S</code> of surprisal values is
<code>S</code> = <code>-X + outer(log(rowSums(M^X))/log(M),rep(1,M))</code>.
</p>


<h3>Value</h3>

<p>A  <code>N</code> by <code>M</code> matrix <code>S</code> of surprisal values at points
<code>evalarg</code>, or their first or second derivatives.</p>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with information-based 
psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smooth.surp">smooth.surp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#  see example in man/smooth.surp.Rd
</code></pre>

<hr>
<h2 id='Fcurve'>
Construct grid of 101 values of the fitting function
</h2><span id='topic+Fcurve'></span>

<h3>Description</h3>

<p>A fast grid of values of the fitting function or one of its first two 
derivatives is constructed for use in function <code>indexsearch</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  Fcurve(SfdList, chcevec, nderiv=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Fcurve_+3A_sfdlist">SfdList</code></td>
<td>
<p>A list vector containing specifications of surprisal
curves for each item.</p>
</td></tr>
<tr><td><code id="Fcurve_+3A_chcevec">chcevec</code></td>
<td>
<p>A N by n matrix containing indices of chosen items for each
test taker.</p>
</td></tr>
<tr><td><code id="Fcurve_+3A_nderiv">nderiv</code></td>
<td>
<p>Integer 0, 1 or 2 to indicate which level of derivative to use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length 101 containing grid values of a derivative of the fitting
function</p>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+index_search">index_search</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#  Compute a grid of values of the objective function for locating each  
#  examinee or respondent for the 24-item short form of the SweSAT   
#  quantitative test on the percentile score index continuum [0,100].
chcemat &lt;- Quant_13B_problem_dataList$chcemat
SfdList &lt;- Quant_13B_problem_parmList$SfdList
index   &lt;- Quant_13B_problem_parmList$index
n       &lt;- ncol(chcemat)
#  Fitting function for the first examinee
j &lt;- 1
chcevec   &lt;- as.numeric(chcemat[j,])
Fcurve1   &lt;- Fcurve(SfdList, chcevec, 0)
#  First derivative of the fitting function for the first examinee
DFcurve1  &lt;- Fcurve(SfdList, chcevec, 1)
#  Second derivative of the fitting function for the first examinee
D2Fcurve1 &lt;- Fcurve(SfdList, chcevec, 2)
oldpar  &lt;- par(no.readonly=TRUE)
par(mfrow=c(3,1))
indfine &lt;- seq(0,100,len=101)
plot(indfine, Fcurve1,   type="l", xlab="", ylab="Fitting curve",
     main="Examinee 1")
plot(indfine, DFcurve1,  type="l", xlab="", ylab="First derivative")
points(index[1], 0, pch="o")
abline(0,0,lty=2)
plot(indfine, D2Fcurve1, type="l", 
     xlab="Score index", ylab="Second derivative")
abline(0,0,lty=2)
points(index[1], 0, pch="o")
par(oldpar)
</code></pre>

<hr>
<h2 id='Ffun'>Compute the negative log likelihoods associated with a vector of score index values.</h2><span id='topic+Ffun'></span>

<h3>Description</h3>

<p>Ffun computes the negative log likelihoods for a set of examinees, each 
at a single value index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  Ffun(index, SfdList, chcemat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ffun_+3A_index">index</code></td>
<td>
<p>A vector of size <code>N</code> containing values for score indices in 
the interval [0,100].</p>
</td></tr>
<tr><td><code id="Ffun_+3A_sfdlist">SfdList</code></td>
<td>
<p>A numbered list object produced by a TestGardener analysis of 
a test.  Its length is equal to the number of items in the test or questions 
in the scale.  Each member of <code>SfdList</code> is a named list containing 
information computed during the analysis.</p>
</td></tr>
<tr><td><code id="Ffun_+3A_chcemat">chcemat</code></td>
<td>
<p>An <code>N</code> by <code>n</code> matrix of responses or, for a single examinee,
a vector of length <code>n</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length <code>N</code> of negative log likelihood values.
</p>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make_dataList">make_dataList</a>,
        <a href="#topic+index_fun">index_fun</a>,
        <a href="#topic+Ffun">Ffun</a>,
        <a href="#topic+Ffuns_plot">Ffuns_plot</a>
  </code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  #  Example 1:  Compute the values of the objective function for locating each  
  #  examinee or respondent for the 24-item short form of the SweSAT quantitative  
  #  test on the percentile score index continuum [0,100].
  #  Use only the first five examinees
  chcemat &lt;- Quant_13B_problem_dataList$chcemat
  SfdList &lt;- Quant_13B_problem_parmList$SfdList
  index   &lt;- Quant_13B_problem_parmList$index
  Fval    &lt;- Ffun(index[1:5], SfdList, chcemat[1:5,])
</code></pre>

<hr>
<h2 id='Ffuns_plot'>
Plot a selection of fit criterion F functions and their first two derivatives.
</h2><span id='topic+Ffuns_plot'></span>

<h3>Description</h3>

<p>These plots indicate whether an appropriate minimum of the fitting criterion was found.
The value of index should be at the function minimum, the first derivative be close to
zero there, and the second derivative should be positive.  If these conditions are not
met, it may be worthwhile to use function <code>indexfun</code> initialized with an approximate  
minimum value of score index index to re-estimate the value of index.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  Ffuns_plot(evalarg, index, SfdList, chcemat, plotindex=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ffuns_plot_+3A_evalarg">evalarg</code></td>
<td>
<p>A vector containingg the sore index values to be evaluated.</p>
</td></tr>
<tr><td><code id="Ffuns_plot_+3A_index">index</code></td>
<td>
<p>The vector of of length <code>N</code> of score index values.</p>
</td></tr>
<tr><td><code id="Ffuns_plot_+3A_sfdlist">SfdList</code></td>
<td>
<p>The list vector of length <code>n</code> containing the 
estimated surprisal curves.</p>
</td></tr>
<tr><td><code id="Ffuns_plot_+3A_chcemat">chcemat</code></td>
<td>
<p>The entire <code>N</code> by <code>n</code> matrix of choice indices.</p>
</td></tr>
<tr><td><code id="Ffuns_plot_+3A_plotindex">plotindex</code></td>
<td>
<p>A subset of the integers <code>1:N</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The curves are displayed in three vertically organized panels along with 
values of index and the values and first two derivative values of the 
fit criterion.  If more than one index value is used, a press of the Enter 
or Return key moves to the next index value.
</p>


<h3>Value</h3>

<p>A list vector is returned which is of the length of argument <code>plotindex</code>.  Each
member of the vector is a <code>gg</code> or <code>ggplot</code> object for the associated
<code>plotindex value</code>.  Each plot can be displayed using the <code>print</code> command.
The plots of item power are produced as a side value even if no output object is
specified in the call to the function.
</p>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+index_fun">index_fun</a></code>,
<code><a href="#topic+Ffun">Ffun</a></code>,
<code><a href="#topic+DFfun">DFfun</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#  Example 1.  Display fit criterion values and derivatives for the 
#  short SweSAT multiple choice test with 24 items and 1000 examinees
chcemat   &lt;- Quant_13B_problem_dataList$chcemat
index     &lt;- Quant_13B_problem_parmList$index
SfdList   &lt;- Quant_13B_problem_parmList$SfdList
plotindex &lt;- 1:3
indfine   &lt;- seq(0,100,len=101)
Ffuns_plot(indfine, index, SfdList, chcemat, plotindex)
</code></pre>

<hr>
<h2 id='ICC'>Plotting probability and surprisal curves for an item</h2><span id='topic+ICC'></span>

<h3>Description</h3>

<p>This is an S3 object that contains information essential plotting 
probability and surprisal curves for a single multiple choice or rating
question.  Bin probabilities and surprisal values can also be plotted.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ICC(x, M, Sfd, Zmat, Pbin, Sbin, Pmatfine, Smatfine, DSmatfine, D2Smatfine,
                PStdErr, SStdErr, ItemArcLen, itemStr=NULL, optStr=NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ICC_+3A_x">x</code></td>
<td>
<p>An item number.</p>
</td></tr>
<tr><td><code id="ICC_+3A_m">M</code></td>
<td>
<p>The number of options for this item, including an option for missing or 
illegal values if required.</p>
</td></tr>
<tr><td><code id="ICC_+3A_sfd">Sfd</code></td>
<td>
<p>A functional surprisal curve object defined by <code>K</code> B-spline 
basis functions and a <code>K</code> by <code>M-1</code> matrix of coefficients.</p>
</td></tr>
<tr><td><code id="ICC_+3A_zmat">Zmat</code></td>
<td>
<p>An <code>M</code> by <code>M-1</code> matrix satisfying the conditions
<code>t(Zmat) Zmat</code> = <code>I</code> and columns sum to zero.</p>
</td></tr>
<tr><td><code id="ICC_+3A_pbin">Pbin</code></td>
<td>
<p>A <code>nbin</code> by <code>M</code> matrix of probabilities that a given
bin is chosen by a test taker.</p>
</td></tr>
<tr><td><code id="ICC_+3A_sbin">Sbin</code></td>
<td>
<p>A <code>nbin</code> by <code>M</code> matrix of surprisal values for the 
probabilities in <code>Pbin.</code></p>
</td></tr>
<tr><td><code id="ICC_+3A_pmatfine">Pmatfine</code></td>
<td>
<p>A 101 by <code>M</code> matrix of probability curve values over
equally-spaced score index values spanning the interval [0,100].</p>
</td></tr>
<tr><td><code id="ICC_+3A_smatfine">Smatfine</code></td>
<td>
<p>A 101 by <code>M</code> matrix of surprisal curve values 
corresponding to the probability values in <code>Pmatfine</code>.</p>
</td></tr>
<tr><td><code id="ICC_+3A_dsmatfine">DSmatfine</code></td>
<td>
<p>A 101 by <code>M</code> matrix of first derivative values
with respect to score index values for the surprisal values.</p>
</td></tr>
<tr><td><code id="ICC_+3A_d2smatfine">D2Smatfine</code></td>
<td>
<p>A 101 by <code>M</code> matrix of second derivative values.</p>
</td></tr>
<tr><td><code id="ICC_+3A_pstderr">PStdErr</code></td>
<td>
<p>A 101 by <code>M</code> matrix of standard error estimates for the 
probability curve values.</p>
</td></tr>
<tr><td><code id="ICC_+3A_sstderr">SStdErr</code></td>
<td>
<p>A 101 by <code>M</code> matrix of standard error estimates for the 
surprisal curve values.</p>
</td></tr>
<tr><td><code id="ICC_+3A_itemarclen">ItemArcLen</code></td>
<td>
<p>The scope or arc length of the item curve.</p>
</td></tr>
<tr><td><code id="ICC_+3A_itemstr">itemStr</code></td>
<td>
<p>A string that is the name of the item.</p>
</td></tr>
<tr><td><code id="ICC_+3A_optstr">optStr</code></td>
<td>
<p>A character vector containing labels for the item options.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The name ICC for this object is an acronym for the term
&quot;item characteristic curve&quot; widely used in the psychometric commuunity.
</p>
<p>Function ICC is set up after the initialization process in function 
<code>make_dataList()</code> has created the members of <code>dataList</code>.  
Within this list is object <code>SfdList</code>, which cintains a functional data
object <code>Sfd</code> for each item.  Both the intial coefficient matrices and
the subsequent estimates of them are available from <code>Sfd$coefs</code>, and
therefore are available in the ICC object.  These coefficient matrices are
<code>K</code> by <code>M-1</code> where <code>K</code> is the number of basis functions and 
<code>M</code> is the number of options for asn item.</p>


<h3>Value</h3>

<p>The values returned are simply those in the argument list. The S3 
ICC object checks each of these and makes available the S3 commands or methods
<code>str</code>, <code>print</code> and <code>plot</code> that apply the corresponding 
<code>ICC</code> versions of these opterations.</p>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>

<hr>
<h2 id='ICC_plot'>Plot probability and surprisal curves for test or scale items.</h2><span id='topic+ICC_plot'></span>

<h3>Description</h3>

<p>ICC_plot plots each item in argument <code>plotindex</code> in turn after 
function<code>Sbinsmth()</code> has used spline smoothing to estimate item and 
option characteristic curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ICC_plot(scrfine, SfdList, dataList, Qvec, 
           binctr=NULL, data_point = FALSE, ci = FALSE, 
           plotType="S", Srng=c(0,5), DSrng=c(-0.2, 0.2), plotindex=1:n, 
           titlestr = NULL, itemscopevec = rep(0, length(plotindex)),  
           plotTitle = TRUE,autoplot = FALSE, plotMissing = TRUE, 
           plotrange=c(min(scrfine),max(scrfine)), shaderange = NULL,  
           ttlsz = NULL, axisttl = NULL, axistxt = NULL, 
           lgdlab = NULL, lgdpos = "bottom")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ICC_plot_+3A_scrfine">scrfine</code></td>
<td>
<p>A vector of 101 plotting points.</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_sfdlist">SfdList</code></td>
<td>
<p>A numbered list object produced by a TestGardener analysis of 
a test.  Its length is equal to the number of items in the test or 
questions in the scale.  Each member of <code>SfdList</code> is a named list 
containing information computed during the analysis.</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_datalist">dataList</code></td>
<td>
<p>A list that contains the objects needed to analyse the test or 
rating scale.</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_qvec">Qvec</code></td>
<td>
<p>A vector of five marker percentile values.  For
plotting over information, this is replaced by Qinfovec returned
as parmList$Qinfovec.</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_binctr">binctr</code></td>
<td>
<p>A vector of bin center values.  If the plot is over
arc length or information, <code>binctr</code> is modified before calling
<code>Sbinsth_plot</code> by the command
<code>binctrinfo = pracma::interp1(indfine, alfine, binctr)</code>, and
argument <code>binctr</code> is replaced by <code>binctrinfo</code>.</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_data_point">data_point</code></td>
<td>
<p>A logical value indicating whether to plot the data points.</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_ci">ci</code></td>
<td>
<p>A logical value indicating whether to plot the confidence limits.</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_plottype">plotType</code></td>
<td>
<p>Type(s) of plot, default as &quot;P&quot; for probability, 
can also be &quot;S&quot; for surprisal, 
&quot;DS&quot; for sensitivity, and any combination of the three</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_srng">Srng</code></td>
<td>
<p>A vector of length 2 specifing the plotting range for surprisal 
values.</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_dsrng">DSrng</code></td>
<td>
<p>A vector of length 2 specifing the plotting range for 
sensitivity values.</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_plotindex">plotindex</code></td>
<td>
<p>A vector of indices of items to be plotted.</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_titlestr">titlestr</code></td>
<td>
<p>plot title</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_itemscopevec">itemscopevec</code></td>
<td>
<p>A numeric vector containing item scope values.</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_plottitle">plotTitle</code></td>
<td>
<p>indicator of showing the plot title, default as TRUE</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_autoplot">autoplot</code></td>
<td>
<p>indicator for plotting all items in a batch</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_plotmissing">plotMissing</code></td>
<td>
<p>Determine if plot the extra option for missing/spoiled responses.</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_plotrange">plotrange</code></td>
<td>
<p>A vector of length 2 containing the plot boundaries of
the score index interval.</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_shaderange">shaderange</code></td>
<td>
<p>a list of length 2 vector(s); set if users want to gray 
out specific score range(s)</p>
</td></tr>      
<tr><td><code id="ICC_plot_+3A_ttlsz">ttlsz</code></td>
<td>
<p>Title font size.</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_axisttl">axisttl</code></td>
<td>
<p>Axis title font size.</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_axistxt">axistxt</code></td>
<td>
<p>Axis text(tick label) font size.</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_lgdlab">lgdlab</code></td>
<td>
<p>Legend label font size.</p>
</td></tr>
<tr><td><code id="ICC_plot_+3A_lgdpos">lgdpos</code></td>
<td>
<p>legend position, could be set as &quot;None&quot; to remove the legend.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list vector is returned which is of the length of argument <code>plotindex</code>.  
Each member of the vector is a <code>gg</code> or <code>ggplot</code> object for the 
associated <code>plotindex value</code>.  Each plot can be displayed using the 
<code>print</code> command.
The plots of item power are produced as a side value even if no output object 
is specified in the call to the function.
</p>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICC">ICC</a></code>,
<code><a href="#topic+Sensitivity_plot">Sensitivity_plot</a></code>,
<code><a href="#topic+Power_plot">Power_plot</a></code>,
<code><a href="#topic+Entropy_plot">Entropy_plot</a></code>,
<code><a href="#topic+Sbinsmth">Sbinsmth</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#  Example 1.  Display the item surprisal curves for the 
#  short SweSAT multiple choice test with 24 items and 1000 examinees
dataList &lt;- Quant_13B_problem_dataList
SfdList  &lt;- Quant_13B_problem_parmList$SfdList
Qvec     &lt;- Quant_13B_problem_parmList$Qvec
binctr   &lt;- Quant_13B_problem_parmList$binctr
infoSurpvec  &lt;- Quant_13B_problem_infoList$infoSurpvec
Qinfovec     &lt;- Quant_13B_problem_infoList$Qinfovec
bininfoctr   &lt;- Quant_13B_problem_infoList$bininfoctr
titlestr &lt;- "Quant_13B_problem"
#  plot the curves for the first question over the score index
oldpar  &lt;- par(no.readonly=TRUE)
indfine &lt;- seq(0,100,len=101)
ICC_plot(indfine, SfdList, dataList, Qvec, binctr, 
         data_point = TRUE, plotType = c("S", "P"), 
         Srng=c(0,4), plotindex=1)
#  plot the curves for the first question over test information
ICC_plot(infoSurpvec, SfdList, dataList, Qinfovec, bininfoctr,
          data_point = TRUE, plotType = c("S", "P"), 
          Srng=c(0,4), plotindex=1)
par(oldpar)
</code></pre>

<hr>
<h2 id='index_distn'>Compute score density</h2><span id='topic+index_distn'></span>

<h3>Description</h3>

<p>Computes the cumulated density for distribution function,
the probability density function, and the log probability density function
as fd objects by spline smoothing of the score values <code>indexdens</code> using 
the basis object <code>logdensbasis</code>.  The norming constant <code>C</code> is also 
output.
</p>
<p>The score values may score index values <code>index</code>, expected test score 
values <code>mu</code>, or arc length locations on the test information or scale 
curve.  The argument functional data object <code>logdensfd</code> should have a 
range that is appropriate for the score values being represented:
For score indices, [0,100], for expected test scores, the range of observed or 
expected scores; and for test information curve locations in the interval 
[0,<code>infoSurp</code>].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  index_distn(indexdens, logdensbasis,  
                pvec=c(0.05, 0.25, 0.50, 0.75, 0.95), nfine = 101)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="index_distn_+3A_indexdens">indexdens</code></td>
<td>
<p>A vector of score index, test score, or arc length values.  
In the score index case, these are usually only the values in the interior of 
the interval [0,100].</p>
</td></tr>
<tr><td><code id="index_distn_+3A_logdensbasis">logdensbasis</code></td>
<td>
<p>A functional basis object for representing the log density 
function.  The argument may also be a functional data object 
(<code>fd</code>) or a functional basis object (<code>Sbasis</code>).</p>
</td></tr>
<tr><td><code id="index_distn_+3A_pvec">pvec</code></td>
<td>
<p>A vector length NL containing the marker percentages.</p>
</td></tr>
<tr><td><code id="index_distn_+3A_nfine">nfine</code></td>
<td>
<p>The number of values in a fine grid, default as 101.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list containing:
</p>
<table>
<tr><td><code>pdf_fd:</code></td>
<td>
<p>An fd object for the probability density function
values over the fine mesh.</p>
</td></tr> 
<tr><td><code>cdffine:</code></td>
<td>
<p>A vector of cumulative probability values beginning
with zero and ending with 1. It must not have ties.</p>
</td></tr>
<tr><td><code>pdffine:</code></td>
<td>
<p>A vector of probability values.</p>
</td></tr>
<tr><td><code>logdensfd:</code></td>
<td>
<p>A functional data object (<code>fd</code>) representing 
the log of the probability function for input <code>index</code>.</p>
</td></tr> 
<tr><td><code>C:</code></td>
<td>
<p>The normalization constant for computing the probability 
density function with the command <code>densityfd = exp(logdensfd)/C.</code></p>
</td></tr> 
<tr><td><code>denscdf:</code></td>
<td>
<p>A set of unique values of the cumulative probability
function defined over an equally spaced mesh of score index values
of the same length as <code>denscdf</code>.</p>
</td></tr>
<tr><td><code>indcdf:</code></td>
<td>
<p>A vector of values within [0,100] corresponding to the 
values in <code>denscdf</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+index_fun">index_fun</a></code>,
<code><a href="#topic+index2info">index2info</a></code>,
<code><a href="#topic+mu">mu</a></code>,
<code><a href="#topic+scoreDensity">scoreDensity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#  Example 1.  Display the item power curves for the 
#  short SweSAT multiple choice test with 24 items and 1000 examinees
#  Assemble information for estimating index density
indfine   &lt;- seq(0,100,len=101)
SfdList   &lt;- Quant_13B_problem_parmList$SfdList
index     &lt;- Quant_13B_problem_parmList$index
N         &lt;- length(index)
#  Define the density for only interior index values
inside    &lt;- index &gt; 0 &amp; index &lt; 100
indexdens &lt;- index[inside]
logdensbasis &lt;- fda::create.bspline.basis(c(0,100), 15)
index_distnList &lt;- index_distn(index[inside], logdensbasis)
denscdf         &lt;- as.numeric(index_distnList$denscdf)
indcdf          &lt;- as.numeric(index_distnList$indcdf)
# adjusted marker score index values are computed by interpolation
markers &lt;- c(.05, .25, .50, .75, .95)
Qvec    &lt;- pracma::interp1(denscdf, indcdf, markers)
result  &lt;- density_plot(indexdens, c(0,100), Qvec)
</code></pre>

<hr>
<h2 id='index_fun'>Compute optimal scores</h2><span id='topic+index_fun'></span>

<h3>Description</h3>

<p>The percentile score index values are estimated for each person.  The estimates
minimize the negative log likelihoods, which are a type of surprisal.  The
main optimization method is a safe-guarded Newton-Raphson method.  
</p>
<p>For any iteration the method uses only those scores that are within the interior  
of the interval [0,100] or at a boundary with a first derivative that would
take a step into the interior, and have second derivative values exceeding the 
value of argument <code>crit</code>.  Consequently the number of values being 
optimized decrease on each iteration, and iterations cease when either 
all values meet the convergence criterion or are optimized on a 
boundary, or when the number of iterations reaches <code>itermax</code>.
At that point, if there are any interior scores still associated with 
either non-positive second derivatives or values that exceed 
<code>crit</code>, the minimizing value along a fine mesh is used.
</p>
<p>If <code>itdisp</code> is positive, the number of values to be estimated
are printed for each iteration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  index_fun(index, SfdList, chcemat, itermax = 20, crit = 0.001, 
              itdisp = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="index_fun_+3A_index">index</code></td>
<td>
<p>A vector of size <code>N</code> containing initial values for score 
indices in the interval [0,100].</p>
</td></tr>
<tr><td><code id="index_fun_+3A_sfdlist">SfdList</code></td>
<td>
<p>A list vector of length equal to the number of questions.  
Each member contains eight results for the surprisal curves 
associated with a question.</p>
</td></tr>
<tr><td><code id="index_fun_+3A_chcemat">chcemat</code></td>
<td>
<p>A matrix number of rows equal to the number of examinees or 
respondents, and number of columns equal to number of items.  The 
values in the matrix are indices of choices made by each respondent
to each question.</p>
</td></tr>
<tr><td><code id="index_fun_+3A_itermax">itermax</code></td>
<td>
<p>Maximum number of iterations for computing the optimal
index values.  Default is 20.</p>
</td></tr>
<tr><td><code id="index_fun_+3A_crit">crit</code></td>
<td>
<p>Criterion for convergence of optimization.  Default is 1e-8.</p>
</td></tr>
<tr><td><code id="index_fun_+3A_itdisp">itdisp</code></td>
<td>
<p>If TRchcematE, results are displayed for each iteration.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list with these members:
</p>
<table>
<tr><td><code>index_out:</code></td>
<td>
<p>A vector of optimized score index value.</p>
</td></tr> 
<tr><td><code>Fval:</code></td>
<td>
<p>The negative log likelihood criterion.</p>
</td></tr>
<tr><td><code>DFval:</code></td>
<td>
<p>The first derivative of the negative likelihood.</p>
</td></tr> 
<tr><td><code>D2Fval:</code></td>
<td>
<p>The second derivative of the negative likelihood.</p>
</td></tr> 
<tr><td><code>iter:</code></td>
<td>
<p>The number iterations used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+index_distn">index_distn</a></code>,
<code><a href="#topic+Ffun">Ffun</a></code>,
<code><a href="#topic+DFfun">DFfun</a></code>,
<code><a href="#topic+index2info">index2info</a></code>,
<code><a href="#topic+scoreDensity">scoreDensity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  #  Optimize the indices defining the data fits for the first five examinees
  #  input the choice indices in the 1000 by 24 choice index matrix
  chcemat   &lt;- Quant_13B_problem_chcemat
  #  First set up the list object for surprisal curves computed from 
  #  initial index estimates.
  SfdList   &lt;- Quant_13B_problem_dataList$SfdList
  #  Their initial values are the percent rank values ranging over [0,100]
  index_in  &lt;- Quant_13B_problem_dataList$percntrnk[1:5]
  #  set up choice indices for first five examinees
  chcemat_in &lt;- chcemat[1:5,]
  #  optimize the initial indices
  indexfunList &lt;- index_fun(index_in, SfdList, chcemat_in)
  #  optimal index values
  index_out    &lt;- indexfunList$index_out
  #  The surprisal data fit values
  Fval_out     &lt;- indexfunList$Fval
  #  The surprisal data fit first derivative values
  DFval_out    &lt;- indexfunList$DFval
  #  The surprisal data fit second derivative values
  D2Fval_out   &lt;- indexfunList$D2Fval
  #  The number of index values that have not reached the convergence criterion
  active_out   &lt;- indexfunList$active
</code></pre>

<hr>
<h2 id='index_search'>
Ensure that estimated score index is global
</h2><span id='topic+index_search'></span>

<h3>Description</h3>

<p>Multiple minima are found quite often in the data fitting function that is 
minimized using function <code>indexfun</code>, and in roughly 10 percent of 
the estimates there is a minimum that it lower than that detected.  The
function searches a mesh of 101 points for minima, computes the fitting
function at the minima, and assigns the location of the global minimum as
the replacement index if the location differs by more than 0.5 from 
the value identified by <code>index_fun</code>.  The function values and their
first two derivatives are also replaced.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  index_search(SfdList, chcemat, index, Fval, DFval, D2Fval, indexind=1:N)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="index_search_+3A_sfdlist">SfdList</code></td>
<td>
<p>A list vector containing specifications of surprisal
curves for each item.</p>
</td></tr>
<tr><td><code id="index_search_+3A_chcemat">chcemat</code></td>
<td>
<p>An <code>N</code> by <code>n</code> matrix containing indices of chosen 
items for each test taker.</p>
</td></tr>
<tr><td><code id="index_search_+3A_index">index</code></td>
<td>
<p>A vector containing all the score index values.</p>
</td></tr>
<tr><td><code id="index_search_+3A_fval">Fval</code></td>
<td>
<p>A vector containing the <code>N</code> function values.</p>
</td></tr>
<tr><td><code id="index_search_+3A_dfval">DFval</code></td>
<td>
<p>A vector containing the <code>N</code> first derivative values.</p>
</td></tr>
<tr><td><code id="index_search_+3A_d2fval">D2Fval</code></td>
<td>
<p>A vector containing the <code>N</code> second derivative values.</p>
</td></tr>
<tr><td><code id="index_search_+3A_indexind">indexind</code></td>
<td>
<p>A vector containing indices of values to be processed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list object containing objects produced from analyzing the simulations,
one set for each simulation:
</p>
<table>
<tr><td><code>index:</code></td>
<td>
<p>A vector containing all the score index values
including those that are altered.</p>
</td></tr>
<tr><td><code>Fval:</code></td>
<td>
<p>A vector containing the N function values
included those that are altered.</p>
</td></tr>
<tr><td><code>DFval:</code></td>
<td>
<p>A vector containing the N first derivative values
included those that are altered.</p>
</td></tr>
<tr><td><code>D2Fval:</code></td>
<td>
<p>A vector containing the N second derivative values
included those that are altered.</p>
</td></tr>
<tr><td><code>changeindex:</code></td>
<td>
<p>Indices of the index values that are altered</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+index_fun">index_fun</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#  Search for values of index that are not at the global minimum of the
#  fitting function and replace them as well as their function and
#  derivative values associated with the fine grid value nearest the 
#  the global minimum.
chcemat &lt;- Quant_13B_problem_chcemat
key     &lt;- Quant_13B_problem_key
SfdList &lt;- Quant_13B_problem_parmList$SfdList
index   &lt;- Quant_13B_problem_parmList$index
Fval    &lt;- Quant_13B_problem_parmList$Fval
DFval   &lt;- Quant_13B_problem_parmList$DFval
D2Fval  &lt;- Quant_13B_problem_parmList$D2Fval
Result  &lt;- index_search(SfdList, chcemat, index, Fval, DFval, D2Fval)
changeindex &lt;- Result$changeindex
print(paste("Number changed =",length(changeindex)))
change  &lt;- index[changeindex] - Result$index[changeindex]
</code></pre>

<hr>
<h2 id='index2info'>
Compute results using arc length or information as the abscissa.
</h2><span id='topic+index2info'></span>

<h3>Description</h3>

<p>The one-dimensional psychometric model defines a space curve within 
the vector space defined by the total collection of option surprisal curves.  
This curve is a valuable resource since positions along the curve are defined 
in bits and positions on the curve are subject to the same strict properties 
that apply to physical measurements.
</p>
<p>Function <code>index2info</code> is required to convert
objects defined over the score index continuum <code>c(0,100)</code> to
the same objects over the arc length continuum <code>c(0,infoSurp)</code>, and also
vice versa.  Since the arc length or information continuum is along
a space curve that is invariant under strictly monotone transformations
of the score index <code>index</code>, and is also a metric, it is an ideal 
choice for the abscissa in all plots.</p>


<h3>Usage</h3>

<pre><code class='language-R'>   index2info(index, Qvec, SfdList, binctr, itemindex=1:n, plotrng=c(0,100), 
                shortwrd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="index2info_+3A_index">index</code></td>
<td>
<p>A vector of score index, test score, or arc length values, one 
for each examinee or respondent.</p>
</td></tr>
<tr><td><code id="index2info_+3A_qvec">Qvec</code></td>
<td>
<p>A vector of locations of the five marker percentages.</p>
</td></tr>
<tr><td><code id="index2info_+3A_sfdlist">SfdList</code></td>
<td>
<p>A numbered list object produced by a TestGardener analysis of 
a test.  Its length is equal to the number of items in the test or questions
in the scale.  Each member of <code>SfdList</code> is a named list containing 
information computed during the analysis.</p>
</td></tr>
<tr><td><code id="index2info_+3A_binctr">binctr</code></td>
<td>
<p>A vector of locations of the bin centers.</p>
</td></tr>
<tr><td><code id="index2info_+3A_itemindex">itemindex</code></td>
<td>
<p>A vector containing the indices of the items to be used.</p>
</td></tr>
<tr><td><code id="index2info_+3A_plotrng">plotrng</code></td>
<td>
<p>A vector of length 2 containing the starting score index
and end score index values of the range to be plotted.</p>
</td></tr>
<tr><td><code id="index2info_+3A_shortwrd">shortwrd</code></td>
<td>
<p>If TRUE only vectors infoSurp and infoSurpvec are returned in 
order to speed up the computation within cycles in function <code>Analyze()</code> 
where only these objects are required.  The default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list object containing these results of the analysis:
</p>
<table>
<tr><td><code>infoSurp</code></td>
<td>
<p>The length of the test information or scale curve.</p>
</td></tr>
<tr><td><code>infoSurpvec</code></td>
<td>
<p>Positions on the test information or scale curve 
corresponding to a fine mesh of score index values (typically 101 values 
between 0 and 100).</p>
</td></tr> 
<tr><td><code>infoSurpfd</code></td>
<td>
<p>Functional data object representing the relation between
the score index abscissa and the infoSurp or information ordinate.</p>
</td></tr>
<tr><td><code>scopevec</code></td>
<td>
<p>A vector of positions on the test information or scale curve
corresponding to the input score index values in argument <code>index</code>.</p>
</td></tr> 
<tr><td><code>Qvec_al</code></td>
<td>
<p>Values in arc length of the five marker percentages.</p>
</td></tr>
<tr><td><code>binctr_al</code></td>
<td>
<p>Values in arc length of the bin centers.</p>
</td></tr>
<tr><td><code>Sfd.info</code></td>
<td>
<p>A functional data object representing the relation between
the infoSurp or information abscissa and the score index ordinate.</p>
</td></tr>
<tr><td><code>Sdim.index</code></td>
<td>
<p>The dimension of the overspace, which equal to sum of the 
number of options in the items specified in <code>itemindex</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Analyze">Analyze</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  #  Example 1.  Display the scope or information curve for the 
  #  short SweSAT multiple choice test with 24 items and 1000 examinees.
  #  The scope curve is constructed using the complete analysis cycles.
  #  Set up the required arguments using the converged parmList object.
  indfine     &lt;- seq(0,100,len=101)
  index       &lt;- Quant_13B_problem_parmList$index
  Qvec        &lt;- Quant_13B_problem_parmList$Qvec
  SfdList     &lt;- Quant_13B_problem_parmList$SfdList
  binctr      &lt;- Quant_13B_problem_parmList$binctr
  #  Carry out the construction of the information results.
  infoList    &lt;- index2info(index, Qvec, SfdList, binctr)
  # Plot the shape of the information curve
  oldpar &lt;- par(no.readonly=TRUE)
  Scope_plot(infoList$infoSurp, infoList$infoSurpvec)
  par(oldpar)
</code></pre>

<hr>
<h2 id='make_dataList'>
Make a list object containing information required for analysis of choice 
data.
</h2><span id='topic+make_dataList'></span>

<h3>Description</h3>

<p>The list object <code>dataList</code> contains 22 objects that supply all of the 
information required to analyze the data.  
Initial values of the score indices in object <code>theta</code> and the bin 
boundaries and centres in object <code>thetaQnt</code>.
The returned named list object contains 22 named members, which are described 
in the value section below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  make_dataList(chcemat, scoreList, noption, sumscr_rng=NULL, 
                titlestr=NULL, itemlabvec=NULL, optlabList=NULL,
                nbin=nbinDefault(N), NumBasis=7, jitterwrd=TRUE, 
                PcntMarkers=c( 5, 25, 50, 75, 95), verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_dataList_+3A_chcemat">chcemat</code></td>
<td>
<p>An N by n matrix.  Column <code>i</code> must contain the integers 
from 1 to <code>M_i</code>, where <code>M_i</code> is the number of options
for item <code>i</code>.  If missing or illegitimate responses exist
for item <code>i</code>,  the column must also contain an integer
greater than <code>M_i</code> that is used to identify such responoses. 
Alternatively, the column use <code>NA</code> for this purpose.
Because missing and illegible responses are normally
rare, they are given a different and simpler estimation
procedure for their surprisal values.</p>
</td></tr>
<tr><td><code id="make_dataList_+3A_scorelist">scoreList</code></td>
<td>
<p>Either a list of length n, each containing a vector of 
length <code>M_i</code> that assigns numeric weights to the options
for that item.  
In the special case of multiple choice items where the 
correct option has weight 1 and all others weight 0, 
a single integer can identify the correct answer.
If all the items are of the multiple 
type, scoreList may be a numeric vector of length n
containing the right answer indices.  List object
scoreList is mandatory because these weights define the
person scores for the surprisal curve estimation process.</p>
</td></tr>
<tr><td><code id="make_dataList_+3A_noption">noption</code></td>
<td>
<p>A numeric vector of length <code>n</code>containing the number of 
choices for each item.  These should not count missing or illegal choices.
Although this object might seem redundant, it is needed
for checking the consistencies among other objects and
as an aid for detecting missing and illegal choices.</p>
</td></tr>
<tr><td><code id="make_dataList_+3A_sumscr_rng">sumscr_rng</code></td>
<td>
<p>A numeric vector of length two containing the initial and   
final values for the interval over which test scores are to be plotted.   
Default is minimum and maximum sum score.</p>
</td></tr>
<tr><td><code id="make_dataList_+3A_titlestr">titlestr</code></td>
<td>
<p>A title string for the data and their analyses.
Default is NULL.</p>
</td></tr>
<tr><td><code id="make_dataList_+3A_itemlabvec">itemlabvec</code></td>
<td>
<p>A character value containing labels for the items.
Default is NULL and item position numbers are used.</p>
</td></tr>
<tr><td><code id="make_dataList_+3A_optlablist">optlabList</code></td>
<td>
<p>A list vector of length <code>n</code>, each element <code>i</code> of 
which is a character vector of length <code>M_i</code>.
Default is NULL, and option numbers are used.</p>
</td></tr>
<tr><td><code id="make_dataList_+3A_nbin">nbin</code></td>
<td>
<p>The number of bins for containing proportions of examinees 
choosing options.  The default is computed by a function that uses the 
number of examinees.</p>
</td></tr>
<tr><td><code id="make_dataList_+3A_numbasis">NumBasis</code></td>
<td>
<p>The number of spline basis functions used to represent 
surprisal curves. The default is computed by a function that uses the 
number of examinees.  
</p>
</td></tr>
<tr><td><code id="make_dataList_+3A_jitterwrd">jitterwrd</code></td>
<td>
<p>A boolian constant: TRUE implies adding a small random value 
to each sum score value prior to computing percent rank values.</p>
</td></tr>
<tr><td><code id="make_dataList_+3A_pcntmarkers">PcntMarkers</code></td>
<td>
<p>Used in plots of curves to display marker or reference 
percentage points for abscissa values in plots.</p>
</td></tr>
<tr><td><code id="make_dataList_+3A_verbose">verbose</code></td>
<td>
<p>If TRUE details of calculations are displayed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The score range defined <code>scrrng</code> should contain all of the sum score 
values, but can go beyond their boundaries if desired.  For example, 
it may be that no examinee gets a zero sum score, but for reporting and 
display purposes using zero as the lower limit seems desirable.
</p>
<p>The number of bins is chosen so that a minimum of at least about 25 initial 
percentage ranks fall within a bin.  For larger samples, the number per bin 
is also larger, making the proportions of choice more accurate.  The number 
bins can be set by the user, or by a simple algorithm used to adjust the 
number of bins to the number <code>N</code> or examinees.
</p>
<p>The number of spline basis functions used to represent a surprisal curve 
should be small for small sample sizes, but can be larger when larger samples 
are involved.  
</p>
<p>There must be at least two basis functions, corresponding to two 
straight lines.  The norder of this simple spline would
not exceed 1, corresponding to taking only a single derivative of 
the resulting spline.  But this rule is bent here to allow higher
higher derivatives, which will autmatically have values of zero, in 
order to allow these simple linear basis functions to be used.  This 
permits direct comparisons of TestGardener models with the many classic 
item response models that use two or less parameters per item response 
curve.
</p>
<p>Adding a small value to discrete values before computing ranks is considered 
a useful way of avoiding any biasses that might arise from the way the data 
are stored.  The small values used leave the rounded jittered values fixed, 
but break up ties for sum scores.
</p>
<p>It can be helpful to see in a plot where special marker percentages 
5, 25, 50, 75 and 95 percent of the interval [0,100] 
are located.  The median abscissa value is at 50 per cent for initial 
percent rank values, for example, but may not be located at the center of   
the interval after iterations of the analysis cycle.
</p>


<h3>Value</h3>

<p>A named list with named members as follows:
</p>
<table>
<tr><td><code>chcemat:</code></td>
<td>
<p>A matrix of response data with N rows and n columns where
N is number of examinees or respondents and n is number of items.
Entries in the matrices are the indices of the options chosen.
Column i of chcemat is expected to contain only the integers 
<code>1,...,noption</code>.</p>
</td></tr>  
<tr><td><code>optList:</code></td>
<td>
<p>A list vector containing the numerical score values 
assigned to the options for this question.</p>
</td></tr>
<tr><td><code>key:</code></td>
<td>
<p>If the data are from a test of the multiple choices type
where the right answer is scored 1 and the wrong answers 0, this is 
a numeric vector of length n containing the indices the right answers.  
Otherwise, it is NULL.</p>
</td></tr>
<tr><td><code>Sfd:</code></td>
<td>
<p>A fd object for the defining the surprisal curves.</p>
</td></tr>
<tr><td><code>noption:</code></td>
<td>
<p>A numeric vector of length n containing the numbers of 
options for each item.</p>
</td></tr>
<tr><td><code>nbin:</code></td>
<td>
<p>The number of bins for binning the data.</p>
</td></tr>
<tr><td><code>scrrng:</code></td>
<td>
<p>A vector of length 2 containing the limits of observed 
sum scores.</p>
</td></tr>
<tr><td><code>scrfine:</code></td>
<td>
<p>A fine mesh of test score values for plotting.</p>
</td></tr>
<tr><td><code>scrvec:</code></td>
<td>
<p>A vector of length N containing the examinee or 
respondent sum scores.</p>
</td></tr>
<tr><td><code>itemvec:</code></td>
<td>
<p>A vector of length n containing the question or item 
sum scores.</p>
</td></tr>
<tr><td><code>percntrnk:</code></td>
<td>
<p>A vector length N containing the sum score 
percentile ranks.</p>
</td></tr>
<tr><td><code>thetaQnt:</code></td>
<td>
<p>A numeric vector of length 2*nbin + 1 containing 
the bin boundaries alternating with the bin centers. These are initially 
defined as <code>seq(0,100,len=2*nbin+1)</code>.</p>
</td></tr>
<tr><td><code>Sdim:</code></td>
<td>
<p>The total dimension of the surprisal scores.</p>
</td></tr>
<tr><td><code>PcntMarkers:</code></td>
<td>
<p>The marker percentages for plotting: 
5, 25, 50, 75 and 95.</p>
</td></tr>
<tr><td><code>grbg:</code></td>
<td>
<p>A logical vector of length number of questions. 
TRUE for an item indicates that a garbage option must be added to the  
score values, and FALSE indicates that there are no illegal or missing 
responses and the number of options is equal to number of score values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TG_analysis">TG_analysis</a>,
        <a href="#topic+Analyze">Analyze</a>,
        <a href="#topic+index_distn">index_distn</a>,
        <a href="#topic+index2info">index2info</a>,
        <a href="#topic+index_fun">index_fun</a>,
        <a href="#topic+Sbinsmth">Sbinsmth</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  #  Example 1:  Input choice data and key for the short version of the 
  #  SweSAT quantitative multiple choice test with 24 items and 1000 examinees
  #  input the choice data as 1000 strings of length 24
  #  set up index and key data
  chcemat &lt;- Quant_13B_problem_chcemat
  key     &lt;- Quant_13B_problem_key
  # number of examinees and of items
  N &lt;- nrow(chcemat)
  n &lt;- ncol(chcemat)
  # number of options per item and option weights
  noption &lt;- rep(0,n)
  for (i in 1:n) noption[i]  &lt;- 4
  scoreList &lt;- list() # option scores
  for (item in 1:n){
    scorei &lt;- rep(0,noption[item])
    scorei[Quant_13B_problem_key[item]] &lt;- 1
    scoreList[[item]] &lt;- scorei
  }
  # Use the input information to define the 
  # big three list object containing info about the input data
  dataList &lt;- make_dataList(chcemat, scoreList, noption)
  </code></pre>

<hr>
<h2 id='mu'>Compute the expected test score by substituting probability of choices
for indicator variable 0-1 values.
Binary items assumed coded as two choice items.</h2><span id='topic+mu'></span>

<h3>Description</h3>

<p>Compute the expected test score by substituting probability of choices
for indicator variable 0-1 values.
Binary items assumed coded as two choice items.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mu(index, SfdList, scoreList)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mu_+3A_index">index</code></td>
<td>
<p>Initial values for score indices in the interval [0,100]. 
A vector of size <code>N</code>.</p>
</td></tr>
<tr><td><code id="mu_+3A_sfdlist">SfdList</code></td>
<td>

<p>A numbered list object produced by a TestGardener analysis of a test.  Its length
is equal to the number of items in the test or questions in the scale.  
Each member of <code>SfdList</code> is a named list containing information computed 
during the analysis.</p>
</td></tr>
<tr><td><code id="mu_+3A_scorelist">scoreList</code></td>
<td>
<p>A numbered list of length n.  Each member contains the weights
assigned to each option for that item or question.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of test score values.</p>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Siberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Siberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scoreDensity">scoreDensity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#  Example 1.  Compute expected sum score values for the 
#  short SweSAT multiple choice test with 24 items and 1000 examinees
scoreList &lt;- Quant_13B_problem_dataList$scoreList
SfdList   &lt;- Quant_13B_problem_parmList$SfdList
index     &lt;- Quant_13B_problem_parmList$index
muvec     &lt;- mu(index, SfdList, scoreList)
par(c(1,1))
hist(muvec,11)
</code></pre>

<hr>
<h2 id='mu_plot'>
Plot expected test score as a function of score index
</h2><span id='topic+mu_plot'></span>

<h3>Description</h3>

<p>The expected score <code>mu(index)</code> is a function of the score index index.  A diagonal
dashed line is displayed to show the linear relationship to the score range interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mu_plot(mufine, scrrng, titlestr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mu_plot_+3A_mufine">mufine</code></td>
<td>
<p>A mesh of 101 equally spaced values of mu as a function of index.</p>
</td></tr>
<tr><td><code id="mu_plot_+3A_scrrng">scrrng</code></td>
<td>
<p>A vector of length 2 containing the score range.</p>
</td></tr>
<tr><td><code id="mu_plot_+3A_titlestr">titlestr</code></td>
<td>
<p>A string containing the title of the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>gg</code> or <code>ggplot</code> object defining the plot of the expected test score 
<code>mu</code> as a function of   the score index <code>index</code>.  This is displayed by 
the <code>print</code> command. 
The plot is automatically displayed as a side value even if no return object is 
specified in the calling statement.
</p>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scoreDensity">scoreDensity</a>,
        <a href="#topic+mu">mu</a>
  </code>
</p>

<hr>
<h2 id='Power_plot'>Plot item power curves for selected items or questions.</h2><span id='topic+Power_plot'></span>

<h3>Description</h3>

<p>Item surprisal power curves are the square root of the sum over options of 
the squared surprisal sensitivity curves.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  Power_plot(scrfine, SfdList, Qvec, dataList, plotindex=1:n, 
             plotrange=c(min(scrfine),max(scrfine)), height=0.5,  
             value=0, ttlsz=NULL, axisttl=NULL, axistxt=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Power_plot_+3A_scrfine">scrfine</code></td>
<td>
<p>A vector of length nfine (usually 101) containing equally spaced
points spanning the plotrange.  Used for plotting.</p>
</td></tr>
<tr><td><code id="Power_plot_+3A_sfdlist">SfdList</code></td>
<td>

<p>A numbered list object produced by a TestGardener analysis of a test.  
Its length is equal to the number of items in the test or questions in 
the scale.  Each member of <code>SfdList</code> is a named list containing 
information computed during the analysis.</p>
</td></tr>
<tr><td><code id="Power_plot_+3A_qvec">Qvec</code></td>
<td>
<p>The five marker percentile values.</p>
</td></tr>
<tr><td><code id="Power_plot_+3A_datalist">dataList</code></td>
<td>
<p>A list vector containing objects essential to an analysis.</p>
</td></tr>
<tr><td><code id="Power_plot_+3A_plotindex">plotindex</code></td>
<td>
<p>A set of integers specifying the numbers of the items or 
questions to be displayed.</p>
</td></tr>
<tr><td><code id="Power_plot_+3A_plotrange">plotrange</code></td>
<td>
<p>A vector of length 2 containing the plot boundaries within or
over the score index interval c(0,100).</p>
</td></tr>
<tr><td><code id="Power_plot_+3A_height">height</code></td>
<td>
<p>A positive real number defining the upper limit on the ordinate 
for the plots.</p>
</td></tr>
<tr><td><code id="Power_plot_+3A_value">value</code></td>
<td>
<p>Number required by ggplot2.  Defaults to 0.</p>
</td></tr>
<tr><td><code id="Power_plot_+3A_ttlsz">ttlsz</code></td>
<td>
<p>Title font size.</p>
</td></tr>
<tr><td><code id="Power_plot_+3A_axisttl">axisttl</code></td>
<td>
<p>Axis title font size.</p>
</td></tr>
<tr><td><code id="Power_plot_+3A_axistxt">axistxt</code></td>
<td>
<p>Axis text(tick label) font size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A surprisal power curve for each question indexed in the <code>index</code> argument.  
A request for a keystroke is made for each question.  The answer to question
strongly defines the optimal position of an estimated score index value where
the curve is high value.  Values of power curves typically range over [0,0.5].
</p>


<h3>Value</h3>

<p>The plots of the power curves specified in <code>plotindex</code> are produced as 
a side effect.
If <code>saveplot</code> is TRUE, the plots of item power curves specified in 
<code>plotindex</code> are bundled into a single postscript or .pdf file and the 
file name is defined by <code>paste(dataList$titlestr,i,'-power.pdf',sep="")</code>.  
The file is then outputas a returned value.
</p>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sensitivity_plot">Sensitivity_plot</a></code>,
<code><a href="#topic+Entropy_plot">Entropy_plot</a></code>,
<code><a href="#topic+Ffuns_plot">Ffuns_plot</a></code>,
<code><a href="#topic+ICC_plot">ICC_plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#  Example 1.  Display the item power curves for the 
#  short SweSAT multiple choice test with 24 items and 1000 examinees
#  plot the power curve for the first item
dataList &lt;- Quant_13B_problem_dataList
SfdList  &lt;- Quant_13B_problem_parmList$SfdList
Qvec     &lt;- Quant_13B_problem_parmList$Qvec
scrfine &lt;- seq(0,100,len=101)
oldpar &lt;- par(no.readonly=TRUE)
Power_plot(scrfine, SfdList, Qvec, dataList, plotindex=1)
par(oldpar)
</code></pre>

<hr>
<h2 id='Quant_13B_problem_chcemat'>Test data for 24 math calculation questions from the SweSAT data.</h2><span id='topic+Quant_13B_problem_chcemat'></span>

<h3>Description</h3>

<p>These data are for a randomly selected subset of 1000 examinees.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Quant_13B_problem_chcemat</code></pre>


<h3>Format</h3>

<p>A matrix object with 1000 rows and 24 columns.  The integers indicate which 
answer was chosen for each question by the examinee associated with the row.
</p>

<hr>
<h2 id='Quant_13B_problem_dataList'>
List of objects essential for an analysis of the abbreviated SweSAT 
Quantitative multiple choice test.
</h2><span id='topic+Quant_13B_problem_dataList'></span>

<h3>Description</h3>

<p>The data are for 1000 randomly selected examinees taking 24 math analysis 
multiple choice questions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Quant_13B_problem_dataList</code></pre>


<h3>Format</h3>

<p>A named list.</p>


<h3>Details</h3>

<p>A named list with 19 members:
</p>

<dl>
<dt>chcemat:</dt><dd><p>A matrix of response data with N rows and n columns where
N is the number of examinees or respondents and n is the number of items.
Entries in the matrices are the indices of the options chosen.
Column i of chcemat is expected to contain only the integers  
<code>1,...,noption</code>.</p>
</dd>  
<dt>key:</dt><dd><p>If the data are from a test of the multiple choices type
where the right answer is scored 1 and the wrong answers 0, this is 
a numeric vector of length n containing the indices the right answers.  
Otherwise, it is NULL.</p>
</dd>
<dt>titlestr:</dt><dd><p>A string containing a title for the analysis.</p>
</dd>
<dt>N:</dt><dd><p>The number of persons tested</p>
</dd>
<dt>n:</dt><dd><p>The number of questons or items</p>
</dd>
<dt>noption:</dt><dd><p>A numeric vector of length n containing the numbers of 
options for each item.</p>
</dd>
<dt>Sdim:</dt><dd><p>The total dimension of the surprisal scores.</p>
</dd>
<dt>grbgvec:</dt><dd><p>A vector of length indicating which option for each item 
contains missing or illegal choice values.  If 0, there is no such 
option.</p>
</dd>
<dt>ScoreList:</dt><dd><p>A list vector or length n with each object a numeric 
vector of weights assigned to each option for each item.</p>
</dd>
<dt>nbin:</dt><dd><p>The number of bins for binning the data.</p>
</dd>
<dt>NumBasis:</dt><dd><p>The number of spline basis functions.</p>
</dd>
<dt>Sbasis:</dt><dd><p>An basisfd object for the defining the surprisal curves.</p>
</dd>
<dt>itemlabvec:</dt><dd><p>A character vector with a title string for each item.</p>
</dd>
<dt>optlabList:</dt><dd><p>A list vector of length n with a character vector of 
labels for each object within each item.</p>
</dd>
<dt>scrvec:</dt><dd><p>A vector of length N containing the examinee or 
respondent sum scores.</p>
</dd>
<dt>itmvec:</dt><dd><p>A vector of length n containing the item sum scores.</p>
</dd>
<dt>scrjit:</dt><dd><p>A numeric vector of length N containing small jitters to
each sum score to break up ties,</p>
</dd>
<dt>sumscr_rng:</dt><dd><p>A vector of length 2 containing the limits of observed 
sum scores.</p>
</dd>
<dt>SfdList:</dt><dd><p>A list vector containing essential objects for each item.</p>
</dd>
<dt>scrfine:</dt><dd><p>A fine mesh of test score values for plotting.</p>
</dd>
<dt>indexQnt:</dt><dd><p>A numeric vector of length 2*nbin + 1 containing 
the bin boundaries alternating with the bin centers. These are initially 
defined as <code>seq(0,100,len=2*nbin+1)</code>.</p>
</dd>
<dt>percntrnk:</dt><dd><p>A vector length N containing the sum score 
percentile ranks.</p>
</dd>
<dt>PcntMarkers:</dt><dd><p>The marker percentages for plotting: 
5, 25, 50, 75 and 95.</p>
</dd>
</dl>


<hr>
<h2 id='Quant_13B_problem_infoList'>
Arclength or information parameter list for 24 items from the quantitative 
SweSAT subtest.
</h2><span id='topic+Quant_13B_problem_infoList'></span>

<h3>Description</h3>

<p>The data are for 1000 examinees randomly selected from those who took the 2013 
quantitative subtest of the SweSAT university entrance exam. 
The questions are only the 24 math analysis questions, and each question has 
four options.
The analysis results are after 10 cycles of alternating between estimating 
surprisal curves and estimating percentile score index values.
The objects in list object <code>Quant_13B_problem_infoList</code> are required for plotting
results over the arc length or information domain rather the score index domain.
This domain is preferred because such plots are invariant with respect to changes 
in the score index domain. It also has a metric structure so that differences 
are comparable no matter where they fall within the information domain.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Quant_13B_problem_infoList</code></pre>


<h3>Format</h3>

<p>A named list containing eight objects.</p>


<h3>Value</h3>

<p>The object <code>Quant_13B_problem_parmList</code> is a named list with these members:
</p>

<dl>
<dt>infoSurp:</dt><dd><p>The total length of the information domain measured in 
M-bits, where <code>M </code> is the number of options for a question.</p>
</dd>
<dt>Sfd:</dt><dd><p>The log derivative functional data object defining 
a strictly increasing set of arc length values
corresponding to set of score index values.</p>
</dd>
<dt>infoSurpvec:</dt><dd><p>A mesh of equally-spaced values of 
indefinite integrals of sum of norms of surprisal derivatives.</p>
</dd>
<dt>scopevec</dt><dd><p>The N arc length values corresponding to the N
estimated score index values assigned to N examinees.</p>
</dd>
<dt>Qinfovec:</dt><dd><p>The arc length positions corresponding to the marker 
percentages 5, 25, 50, 75 and 95.</p>
</dd>      
<dt>index:</dt><dd><p>A vector of score index values resulting from using 
function <code>monfd</code> with equally spaced arc length values and 
<code>Sfd.info</code>.</p>
</dd>
<dt>Sdim:</dt><dd><p>The dimension of the over space containing the  surprisal 
pcurves.</p>
</dd>
</dl>


<hr>
<h2 id='Quant_13B_problem_key'>
Option information for the short form of the SweSAT Quantitative test.
</h2><span id='topic+Quant_13B_problem_key'></span>

<h3>Description</h3>

<p>A vector that contains the indices of the right answers among the options
for the 24 questions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  Quant_13B_problem_key
</code></pre>

<hr>
<h2 id='Quant_13B_problem_parmList'>
Parameter list for 24 items from the quantitative SweSAT subtest.
</h2><span id='topic+Quant_13B_problem_parmList'></span>

<h3>Description</h3>

<p>The data are for 1000 examinees randomly selected from those who took the 2013 
quantitative subtest of the SweSAT university entrance exam. 
The questions are only the 24 math analysis questions, and each question has 
four options.
The analysis results are after 10 cycles of alternating between estimating 
surprisal curves and estimating percentile score index values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Quant_13B_problem_parmList</code></pre>


<h3>Format</h3>

<p>A named list.</p>


<h3>Value</h3>

<p>The object <code>Quant_13B_problem_parmList</code> is a named list with these members:
</p>
<table>
<tr><td><code>index:</code></td>
<td>
<p>A vector of length <code>N</code> of estimated values of the percentile 
rank score index.</p>
</td></tr>
<tr><td><code>indexQnt:</code></td>
<td>
<p>A vector of length 2*nbin + 1 containing bin boundaries 
alternating with bin centres.</p>
</td></tr>
<tr><td><code>SfdList:</code></td>
<td>
<p>A list vector of length equal to the number of questions.  
Each member contains eight results for the surprisal curves 
associated with a question.</p>
</td></tr>
<tr><td><code>logdensfd:</code></td>
<td>
<p>A functional data object representing the logarithm of the 
density of the percentile rank score index values.</p>
</td></tr>
<tr><td><code>C:</code></td>
<td>
<p>The norming constant: the density function is <code>exp(logdensfd)/C</code>.</p>
</td></tr>
<tr><td><code>densfine:</code></td>
<td>
<p>A fine mesh of probability density values of the percentile 
rank score index.</p>
</td></tr>
<tr><td><code>denscdf:</code></td>
<td>
<p>A fine mesh of cumulative probability distribution values 
used for interpolating values.</p>
</td></tr>
<tr><td><code>Qvec:</code></td>
<td>
<p>The score index values associated with the five marker percentages 
5, 25, 50, 75 and 95.</p>
</td></tr>      
<tr><td><code>binctr:</code></td>
<td>
<p>A vector of length nbin containing the centres of the bins.</p>
</td></tr>
<tr><td><code>bdry:</code></td>
<td>
<p>A vector of length nbin+1 containing the boundaries of the bins.</p>
</td></tr>
<tr><td><code>freq:</code></td>
<td>
<p>An nbin by M matrix of frequencies with which options are chosen.</p>
</td></tr>
<tr><td><code>Smax:</code></td>
<td>
<p>A maximum surprisal value used for plotting purposes.</p>
</td></tr>
<tr><td><code>Hval:</code></td>
<td>
<p>The value of the fitting criterion <code>H</code> for a single 
examinee or respondent.</p>
</td></tr>
<tr><td><code>DHval:</code></td>
<td>
<p>The value of the first derivative of the fitting criterion 
<code>H</code> for a single examinee or respondent.</p>
</td></tr>
<tr><td><code>D2Hval:</code></td>
<td>
<p>The value of the second derivative of the fitting criterion 
<code>H</code> for a single examinee or respondent.</p>
</td></tr>
<tr><td><code>active:</code></td>
<td>
<p>A logical vector of length N indicating which estimates of 
index are converged (FALSE) or not converged (TRUE).</p>
</td></tr>
<tr><td><code>infoSurp:</code></td>
<td>
<p>The length in bits of the test information curve.</p>
</td></tr>
<tr><td><code>infofine:</code></td>
<td>
<p>A mesh of 101 equally spaced positions along the test 
information curve.</p>
</td></tr>
<tr><td><code>Qinfovec:</code></td>
<td>
<p>The positions of the five marker percentages on the test 
information curve.</p>
</td></tr>
<tr><td><code>scopevec:</code></td>
<td>
<p>A vector of length N containing the positions of each 
examinee or respondent on the test information curve.</p>
</td></tr>
</table>

<hr>
<h2 id='Sbinsmth'>Estimate the option probability and surprisal curves.</h2><span id='topic+Sbinsmth'></span>

<h3>Description</h3>

<p>The surprisal curves for each item are fit to the surprisal 
transforms of choice probabilities for each of a set of bins of current
performance values <code>index</code>.  The error sums of squares are minimized
by the surprisal optimization <code>smooth.surp</code> in the <code>fda</code>
package.  The output is a list vector of length <code>n</code> containing the
functional data objects defining the curves.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  Sbinsmth(index, dataList, indexQnt=seq(0,100, len=2*nbin+1), 
           wtvec=matrix(1,n,1), iterlim=20, conv=1e-4, dbglev=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sbinsmth_+3A_index">index</code></td>
<td>
<p>A vector of length N containing current values of score index 
percentile values.</p>
</td></tr>  
<tr><td><code id="Sbinsmth_+3A_datalist">dataList</code></td>
<td>
<p>A list that contains the objects needed to analyse the test or 
rating scale.</p>
</td></tr>
<tr><td><code id="Sbinsmth_+3A_indexqnt">indexQnt</code></td>
<td>
<p>A vector of length 2*n+1 containing the sequence of bin boundary and 
bin centre values.</p>
</td></tr>
<tr><td><code id="Sbinsmth_+3A_wtvec">wtvec</code></td>
<td>
<p>A vector of length <code>n</code> of weights on observations.  Defaults to
all ones.</p>
</td></tr>
<tr><td><code id="Sbinsmth_+3A_iterlim">iterlim</code></td>
<td>
<p>The maximum number of iterations used in optimizing surprisal
curves.  Defaults to 20.</p>
</td></tr>
<tr><td><code id="Sbinsmth_+3A_conv">conv</code></td>
<td>
<p>Convergence tolerance.  Defaults to 0.0001.</p>
</td></tr>
<tr><td><code id="Sbinsmth_+3A_dbglev">dbglev</code></td>
<td>
<p>Level of output within <code>Sbinsmth</code>.  If 0, no output,
if 1 the error sum of squares and slope on each iterations, and if 2
or higher, results for each line search iteration with function <code>lnsrch</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function first bins the data in order to achieve rapid estimation of the 
option surprisal curves. The argument <code>indexQnt</code> contains the sequence 
of bin boundaries separated by the bin centers, so that it is of length 
<code>2*nbin + 1</code> where <code>nbin</code>
is the number of bins.  
These bin values are distributed over the percentile interval
[0,100] so that the lowest boundary is 0 and highest 100.  
Prior to the call to <code>Sbinsmth</code> these boundaries are computed so that 
the numbers of values of <code>index</code> falling in the bins are roughly equal.  
It is important that the number of bins be chosen so that the bins contain 
at least about 25 values.  
</p>
<p>After the values of <code>index</code> are binned, the proportions that the bins 
are chosen for each question and each option are computed.  Proportions of 
zero are given NA values.
</p>
<p>The positive proportions are then converted to surprisal values where 
surprisal = -log_M (proportion) where log_M is the logarithm with base M, 
the number of options associated with a question.  
Bins with zero proportions are assigned a surprisal that is appropriately 
large in the sense of being in the range of the larger surprisal values 
associated with small but positive proportions. This surprisal value
is usually about 4.
</p>
<p>The next step is to fit the surprisal values for each question by a 
functional data object that is smooth, passes as closely as possible to an
option's surprisal values, and has values consistent with being a surprisal 
value.  The function <code>smooth.surp()</code> is used for this purpose.  The
arc length of thme item information curve is also computed.
</p>
<p>Finally the curves and other results for each question are saved in object
<code>SfdList</code>, a list vector of length n, and the list vector is returned.
</p>


<h3>Value</h3>

<p>The optimized numbered list object <code>SfdList</code> with length <code>n</code> 
that provides data on the probability and surprisal data and curves.  
The 12 objects for each item are as follows:
</p>
<table>
<tr><td><code>Sfd:</code></td>
<td>
<p>A surprisal functional data object that is used for plotting.
It also contains the coefficient matrix and functional data basis 
that define the object.</p>
</td></tr>
<tr><td><code>M:</code></td>
<td>
<p>The number of options, including if needed a final
option which is for the missing and illegitimate responses.</p>
</td></tr>
<tr><td><code>Pbin:</code></td>
<td>
<p>A <code>nbin</code> by <code>M</code> matrix of proportions of 
choice for each option.</p>
</td></tr>
<tr><td><code>Sbin:</code></td>
<td>
<p>A <code>nbin</code> by <code>M</code> matrix of surprisal values
for each option..</p>
</td></tr>
<tr><td><code>indfine:</code></td>
<td>
<p>A fine mesh of 101 equally spaced score index values
over the interval [0,1].</p>
</td></tr>
<tr><td><code>Pmatfine:</code></td>
<td>
<p>A 101 by <code>M</code> matrix of probability values
at each of the fine mesh points <code>indfine</code>.</p>
</td></tr>
<tr><td><code>Smatfine:</code></td>
<td>
<p>A 101 by <code>M</code> matrix of surprisal values
at each of the fine mesh points <code>indfine</code>.</p>
</td></tr>
<tr><td><code>DSmatfine:</code></td>
<td>
<p>A 101 by <code>M</code> matrix of surprisal 
first derivative values at each of the fine mesh points 
<code>indfine</code>.</p>
</td></tr>
<tr><td><code>D2Smatfine:</code></td>
<td>
<p>A 101 by <code>M</code> matrix of surprisal 
second derivative values at each of the fine mesh points 
<code>indfine</code>.</p>
</td></tr>
<tr><td><code>PSrsErr:</code></td>
<td>
<p>The standard error for probability over
the fine mesh.</p>
</td></tr>
<tr><td><code>PSrsErr:</code></td>
<td>
<p>The standard error for surprisal over
the fine mesh.</p>
</td></tr>
<tr><td><code>itemScope:</code></td>
<td>
<p>The length of the item info curve.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics. Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICC_plot">ICC_plot</a></code>,
<code><a href="#topic+Sbinsmth">Sbinsmth</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#  Example 1.  Display the initial probability and surprisal curves for the 
#  first item in the short SweSAT multiple choice test with 24 items and 
#  1000 examinees.
#  Note: The scope is 0 at this point because it is computed later 
#  in the analysis.
dataList &lt;- Quant_13B_problem_dataList
index    &lt;- dataList$percntrnk
#  Carry out the surprisal smoothing operation
SfdResult   &lt;- Sbinsmth(index, dataList)
  ## Not run: 
  #  Set up the list object for the estimated surprisal curves
  SfdList     &lt;- SfdResult$SfdList
  #  The five marker percentage locations for (5, 25, 50, 75, 95)
  binctr      &lt;- dataList$binctr
  Qvec        &lt;- dataList$PcntMarkers
  #  plot the curves for the first question
  scrfine   &lt;- seq(0,100,len=101)
  ICC_plot(scrfine, SfdList, dataList, Qvec, binctr,
            data_point = TRUE, plotType = c("S", "P"), 
            Srng=c(0,3), plotindex=1)
  
## End(Not run)
</code></pre>

<hr>
<h2 id='Sbinsmth_nom'>
List vector containing numbers of options and boundaries.
</h2><span id='topic+Sbinsmth_nom'></span>

<h3>Description</h3>

<p>Set up objects needed for analyses of nominal data.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sbinsmth_nom(bdry_nom, SfdList_nom)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sbinsmth_nom_+3A_bdry_nom">bdry_nom</code></td>
<td>
<p>Vector of length two containing the initial and final 
values of the scofre index.
</p>
</td></tr>
<tr><td><code id="Sbinsmth_nom_+3A_sfdlist_nom">SfdList_nom</code></td>
<td>
<p>A list vector of length equal to number of items.
Each object is a list object containing the containing number of options
and the nominal parameter matrix estimated by the mirt package.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Called twice.  
</p>

<hr>
<h2 id='Scope_plot'>
Plot the score index <code>index</code> as a function of arc length.
</h2><span id='topic+Scope_plot'></span>

<h3>Description</h3>

<p>Arc length or scope is the distance along the space curved traced 
out as score index <code>index</code> increases from 0 to 100.  
It is measured in bits and is remains 
unchanged if the score index continuum is modified.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  Scope_plot(infoSurp, infoSurpvec, titlestr=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Scope_plot_+3A_infosurp">infoSurp</code></td>
<td>
<p>This is a positive real number indicating the total length of the 
space curve.  It is expressed in terms of numbers of bits.</p>
</td></tr>
<tr><td><code id="Scope_plot_+3A_infosurpvec">infoSurpvec</code></td>
<td>
<p>A vector of length 101 containing equally-spaced arc-length distances  
along the test information curve.</p>
</td></tr>
<tr><td><code id="Scope_plot_+3A_titlestr">titlestr</code></td>
<td>
<p>A string for the title of the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>gg</code> or <code>ggplot</code> object defining the plot of infoSurp along the test information 
curve as a function of the score index <code>index</code>.  This is displayed by the <code>print</code> command. 
The plot is automatically displayed as a side value even if no return object is specified in 
the calling statement.
</p>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+index2info">index2info</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
#  Example 1.  Display the arc length curve for the 
#  SweSAT multiple choice test with 24 items and 1000  examinees
#
infoSurpvec &lt;- Quant_13B_problem_infoList$infoSurpvec
infoSurp    &lt;- Quant_13B_problem_infoList$infoSurp
oldpar &lt;- par(no.readonly=TRUE)
Scope_plot(infoSurp, infoSurpvec)
on.exit(oldpar)
</code></pre>

<hr>
<h2 id='scoreDensity'>
Compute and plot a score density histogram and and curve.
</h2><span id='topic+scoreDensity'></span>

<h3>Description</h3>

<p>The tasks of function <code>index.density()</code> and plotting the density are combined.  
The score density is plotted both as a histogram and as a smooth curve.  
All the score types may be plotted: sum scores, expected test scores, 
percentile score index values, and locations on the test information or 
scale curve.  The plot is output as a ggplot2 plot object, which is actually 
plotted using the <code>print</code>
command.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  scoreDensity(scrvec, scrrng=c(0,100), ndensbasis=15, ttlstr=NULL, pltmax=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scoreDensity_+3A_scrvec">scrvec</code></td>
<td>
<p>A vector of strictly increasing bin boundary values, with the 
first at the lowest plotting value and the last at the upper boundary.  
The number of bins in the histogram is one less than the number of bndry 
values.</p>
</td></tr>
<tr><td><code id="scoreDensity_+3A_scrrng">scrrng</code></td>
<td>
<p>A vector of length 2 containing lower and upper boundaries on 
scores, which defaults to c(0,100).</p>
</td></tr>
<tr><td><code id="scoreDensity_+3A_ndensbasis">ndensbasis</code></td>
<td>
<p>The number of spline basis functions to be used to 
represent the smooth density curve.</p>
</td></tr>
<tr><td><code id="scoreDensity_+3A_ttlstr">ttlstr</code></td>
<td>
<p>A string object used as a title for the plot.  
Defaults to none.</p>
</td></tr>
<tr><td><code id="scoreDensity_+3A_pltmax">pltmax</code></td>
<td>
<p>An upper limit on the vertical axis for plotting.  
Defaults to the maximum curve value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 plot object <code>dens.plot</code> that can be displayed using command
<code>print(dens.plot)</code>.
</p>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics. Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+index_fun">index_fun</a></code>,
<code><a href="#topic+index2info">index2info</a></code>,
<code><a href="#topic+mu">mu</a></code>,
<code><a href="#topic+index_distn">index_distn</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#  Example 1.  Display probability density curves for the 
#  short SweSAT multiple choice test with 24 items and 1000 examinees
SfdList &lt;- Quant_13B_problem_parmList$SfdList
index   &lt;- Quant_13B_problem_parmList$index
Qvec    &lt;- Quant_13B_problem_parmList$Qvec
#  plot the density for the score indices within interval c(0,100)
index_int &lt;- index[0 &lt; index &amp; index &lt; 100]
oldpar &lt;- par(no.readonly=TRUE)
scoreDensity(index_int)
par(oldpar)
</code></pre>

<hr>
<h2 id='scorePerformance'>
Calculate mean squared error and bias for a set of score index values from 
simulated data.
</h2><span id='topic+scorePerformance'></span>

<h3>Description</h3>

<p>After the simulated data matrices have been 
analyzed, prepare the objects necessary for the 
performance plots produced by functions <code>RMSEbias1.plot</code> and 
<code>RMSEbias2.plot</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  scorePerformance(dataList, simList)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scorePerformance_+3A_datalist">dataList</code></td>
<td>
<p>A list that contains the objects needed to analyse the test 
or rating scale with the following fields:
</p>

<dl>
<dt>chcemat:</dt><dd><p>A matrix of response data with N rows and n columns where
N is the number of examinees or respondents and n is the number of items.
Entries in the matrices are the indices of the options chosen.
Column i of chcemat is expected to contain only the integers 
<code>1,...,noption</code>.</p>
</dd>  
<dt>optList:</dt><dd><p>A list vector containing the numerical score values 
assigned to the options for this question.</p>
</dd>
<dt>key:</dt><dd><p>If the data are from a test of the multiple choices type
where the right answer is scored 1 and the wrong answers 0, this is 
a numeric vector of length n containing the indices the right answers.  
Otherwise, it is NULL.</p>
</dd>
<dt>Sfd:</dt><dd><p>An fd object for the defining the surprisal curves.</p>
</dd>
<dt>noption:</dt><dd><p>A numeric vector of length n containing the numbers of 
options for each item.</p>
</dd>
<dt>nbin:</dt><dd><p>The number of bins for binning the data.</p>
</dd>
<dt>scrrng:</dt><dd><p>A vector of length 2 containing the limits of observed 
sum scores.</p>
</dd>
<dt>scrfine:</dt><dd><p>A fine mesh of test score values for plotting.</p>
</dd>
<dt>scrvec:</dt><dd><p>A vector of length N containing the examinee or 
respondent sum scores.</p>
</dd>
<dt>itemvec:</dt><dd><p>A vector of length n containing the question or item 
sum scores.</p>
</dd>
<dt>percntrnk:</dt><dd><p>A vector length N containing the sum score 
percentile ranks.</p>
</dd>
<dt>chcematQnt:</dt><dd><p>A numeric vector of length 2*nbin + 1 containing the 
bin boundaries alternating with the bin centers. These are initially 
defined as <code>seq(0,100,len=2*nbin+1)</code>.</p>
</dd>
<dt>Sdim:</dt><dd><p>The total dimension of the surprisal scores.</p>
</dd>
<dt>PcntMarkers:</dt><dd><p>The marker percentages for plotting: 
5, 25, 50, 75 and 95.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="scorePerformance_+3A_simlist">simList</code></td>
<td>
<p>A named list containing these objects:
</p>

<dl>
<dt>sumscr:</dt><dd><p>A matrix with row dimension <code>nchcemat</code>, the number of 
population score index values and column dimension <code>nsample</code>, the 
number of simulated samples.</p>
</dd>
<dt>chcemat:</dt><dd><p>An <code>nchcemat</code> by <code>nsample</code> of estimated score 
index values.</p>
</dd>
<dt>mu:</dt><dd><p>An <code>nchcemat</code> by <code>nsample</code> of estimated expected 
score values.</p>
</dd>
<dt>al:</dt><dd><p>An <code>nchcemat</code> by <code>nsample</code> of estimated test 
information curve values.</p>
</dd>
<dt>thepop:</dt><dd><p>A vector of population score index values.</p>
</dd>
<dt>mupop:</dt><dd><p>A vector of expected scores computed from the population 
score index values.</p>
</dd>
<dt>alpop:</dt><dd><p>A vector of test information values computed from the 
population score index values.</p>
</dd>
<dt>n:</dt><dd><p>The number of questions.</p>
</dd>
<dt>Qvec:</dt><dd><p>The five marker percentile values.</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Value</h3>

<p>A named list containing these objects:
</p>

<dl>
<dt>sumscr:</dt><dd><p>A matrix with row dimension <code>nchcemat</code>, the number of 
population score index values and column dimension <code>nsample</code>, the 
number of simulated samples.</p>
</dd>
<dt>chcemat:</dt><dd><p>An <code>nchcemat</code> by <code>nsample</code> matrix of estimated score 
index values.</p>
</dd>
<dt>mu:</dt><dd><p>An <code>nchcemat</code> by <code>nsample</code> matrix of estimated expected 
score values.</p>
</dd>
<dt>al:</dt><dd><p>An <code>nchcemat</code> by <code>nsample</code> matrix of estimated test 
information curve values.</p>
</dd>
<dt>chcepop:</dt><dd><p>A vector of population score index values.</p>
</dd>
<dt>mupop:</dt><dd><p>A vector of expected scores computed from the population 
score index values.</p>
</dd>
<dt>infopop:</dt><dd><p>A vector of test information values computed from the 
population score index values.</p>
</dd>
<dt>n:</dt><dd><p>The number of questions.</p>
</dd>
<dt>Qvec:</dt><dd><p>The five marker percentile values.</p>
</dd>
</dl>



<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dataSimulation">dataSimulation</a></code>
</p>

<hr>
<h2 id='Sensitivity_plot'>
Plots all the sensitivity curves for selected items or questions.</h2><span id='topic+Sensitivity_plot'></span>

<h3>Description</h3>

<p>A sensitivity curve for an option is the first derivative of the corresponding
surprisal curve.  Its values can be positive or negative, and the size of the departure
from zero at any point on the curve is the amount information contributed by that curve 
to locating the value of an examinee or respondent on the score index continuum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sensitivity_plot(scrfine, SfdList, Qvec, dataList, plotindex=1:n, 
                 plotrange=c(min(scrfine),max(scrfine)),   
                 key=NULL, titlestr=NULL, saveplot=FALSE, width=c(-0.2,0.2), 
                 ttlsz=NULL, axisttl=NULL, axistxt=NULL, lgdlab=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sensitivity_plot_+3A_scrfine">scrfine</code></td>
<td>
<p>A vector of length nfine (usually 101) containing equally spaced
points spanning the plotrange.  Used for plotting.</p>
</td></tr>
<tr><td><code id="Sensitivity_plot_+3A_sfdlist">SfdList</code></td>
<td>

<p>A numbered list object produced by a TestGardener analysis of a test.  
Its length is equal to the number of items in the test or questions in 
the scale.  Each member of <code>SfdList</code> is a named list containing 
information computed during the analysis.</p>
</td></tr>
<tr><td><code id="Sensitivity_plot_+3A_qvec">Qvec</code></td>
<td>
<p>The values of the five marker percentiles.</p>
</td></tr>
<tr><td><code id="Sensitivity_plot_+3A_datalist">dataList</code></td>
<td>
<p>A list that contains the objects needed to analyse the test 
or rating scale.</p>
</td></tr>
<tr><td><code id="Sensitivity_plot_+3A_plotindex">plotindex</code></td>
<td>
<p>A set of integers specifying the numbers of the items or 
questions to be displayed.</p>
</td></tr>
<tr><td><code id="Sensitivity_plot_+3A_plotrange">plotrange</code></td>
<td>
<p>A vector of length 2 containing the plot boundaries within or
over the score index interval c(0,100).</p>
</td></tr>
<tr><td><code id="Sensitivity_plot_+3A_key">key</code></td>
<td>
<p>A integer vector of indices of right answers.  
If the data are rating scales, this can be NULL.</p>
</td></tr>
<tr><td><code id="Sensitivity_plot_+3A_titlestr">titlestr</code></td>
<td>
<p>A title string for plots.</p>
</td></tr>
<tr><td><code id="Sensitivity_plot_+3A_saveplot">saveplot</code></td>
<td>
<p>A logical value indicating whether the plot should be saved to a pdf file.</p>
</td></tr>
<tr><td><code id="Sensitivity_plot_+3A_width">width</code></td>
<td>
<p>A vector of length 2 defining the lower and upper limits on the ordinate 
for the plots.</p>
</td></tr>
<tr><td><code id="Sensitivity_plot_+3A_ttlsz">ttlsz</code></td>
<td>
<p>Title font size.</p>
</td></tr>
<tr><td><code id="Sensitivity_plot_+3A_axisttl">axisttl</code></td>
<td>
<p>Axis title font size.</p>
</td></tr>
<tr><td><code id="Sensitivity_plot_+3A_axistxt">axistxt</code></td>
<td>
<p>Axis text(tick label) font size.</p>
</td></tr>
<tr><td><code id="Sensitivity_plot_+3A_lgdlab">lgdlab</code></td>
<td>
<p>Legend label font size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sensitivity curves for each question indexed in the <code>index</code> argument.  
A request for a keystroke is made for each question.
</p>


<h3>Value</h3>

<p>A list vector is returned which is of the length of argument <code>plotindex</code>.  
Each member of the vector is a <code>gg</code> or <code>ggplot</code> object for the associated
<code>plotindex value</code>.  Each plot can be displayed using the <code>print</code> command.
The plots of item power are produced as a side value even if no output object is
specified in the call to the function.
</p>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Power_plot">Power_plot</a></code>,
<code><a href="#topic+Entropy_plot">Entropy_plot</a></code>,
<code><a href="#topic+ICC_plot">ICC_plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#  Example 1.  Display the option sensitivity curves for the 
#  short SweSAT multiple choice test with 24 items and 1000 examinees.
dataList &lt;- Quant_13B_problem_dataList
SfdList  &lt;- Quant_13B_problem_parmList$SfdList
Qvec     &lt;- Quant_13B_problem_parmList$Qvec
scrfine  &lt;- seq(0,100,len=101)
oldpar   &lt;- par(no.readonly=TRUE)
Sensitivity_plot(scrfine, SfdList, Qvec, dataList, plotindex=1)
par(oldpar)
</code></pre>

<hr>
<h2 id='SimulateData'>
Simulate Choice Data from a Previous Analysis
</h2><span id='topic+SimulateData'></span>

<h3>Description</h3>

<p>Simulation of data using a previous analysis requires only an ICC vector and two objects computed by function <code>theta.distn</code> along with a specification of the number of simulated the simulated persons.</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimulateData(nsim, indfine, denscdf, SfdList)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimulateData_+3A_nsim">nsim</code></td>
<td>
<p>Number of persons having simulated choices.</p>
</td></tr>
<tr><td><code id="SimulateData_+3A_indfine">indfine</code></td>
<td>
<p>The score index values within [0,100] that are
associated with the cumulative probability values in 
<code>denscdf</code>.</p>
</td></tr>
<tr><td><code id="SimulateData_+3A_denscdf">denscdf</code></td>
<td>
<p>The cumulative probability values within [0,1].
The values have to be discrete, begin with 0 and end with 1.</p>
</td></tr>
<tr><td><code id="SimulateData_+3A_sfdlist">SfdList</code></td>
<td>
<p>List vector of length n of list vectors for
item objects.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Arguments <code>indfine</code> and <code>denscdf</code> can be obtained from
the original analysis, but also can be specified to describe
a different distribution of score index values.</p>


<h3>Value</h3>

<p>An nsim by n matrix of integers including 1 and 2 that specify
each person's option choice for each item.</p>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dataSimulation">dataSimulation</a></code>,
<code><a href="#topic+chcemat_simulate">chcemat_simulate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example code to be set up 
</code></pre>

<hr>
<h2 id='smooth.ICC'>
Smooth binned probability and surprisal values to make an <code>ICC</code> object.
</h2><span id='topic+smooth.ICC'></span>

<h3>Description</h3>

<p>An N by n matrix of positive integer choice index values is transformed to
an nbin by M matrix of probability values by iteravely minimizing the sum 
of squared errors for bin values.</p>


<h3>Usage</h3>

<pre><code class='language-R'>smooth.ICC(x, item, index, dataList, indexQnt=seq(0,100, len=2*nbin+1), 
                       wtvec=matrix(1,n,1), iterlim=20, conv=1e-4, dbglev=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smooth.ICC_+3A_x">x</code></td>
<td>
<p>An ICC object</p>
</td></tr>
<tr><td><code id="smooth.ICC_+3A_item">item</code></td>
<td>
<p>Index of item being set up.</p>
</td></tr>
<tr><td><code id="smooth.ICC_+3A_index">index</code></td>
<td>
<p>A vector of length N containing score index values for each
person.</p>
</td></tr>
<tr><td><code id="smooth.ICC_+3A_datalist">dataList</code></td>
<td>
<p>A list object set up by function <code>make.dataList</code>
containing objects set up prior to an analysis of the data.</p>
</td></tr>
<tr><td><code id="smooth.ICC_+3A_indexqnt">indexQnt</code></td>
<td>
<p>A vector of length 2*nbin + 1 containing, in sequence,
the lower boundary of a bin, its midpoint, and the upper boundary.</p>
</td></tr>
<tr><td><code id="smooth.ICC_+3A_wtvec">wtvec</code></td>
<td>
<p>A vector of length n containing wseights for items.</p>
</td></tr>
<tr><td><code id="smooth.ICC_+3A_iterlim">iterlim</code></td>
<td>
<p>An integer specifying the maximum number of optimizations.</p>
</td></tr>
<tr><td><code id="smooth.ICC_+3A_conv">conv</code></td>
<td>
<p>A convergence criterion a little larger than 0.</p>
</td></tr>
<tr><td><code id="smooth.ICC_+3A_dbglev">dbglev</code></td>
<td>
<p>One of integers 0 (no optimization information),
1 (one line per optimization) or 2 (complete optimization display).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class ICC object for a single item.</p>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example code to be set up
</code></pre>

<hr>
<h2 id='smooth.surp'>
Fit data with surprisal smoothing.
</h2><span id='topic+smooth.surp'></span>

<h3>Description</h3>

<p>Surprisal is -log(probability) where the logarithm is to the base being the 
dimension <code>M</code> of the multinomial observation vector.  The surprisal 
curves for each question are estimated by fitting the surprisal values of 
binned data using curves whose values are within the <code>M-1</code>-dimensional 
surprisal subspace that is within the space of non-negative M-dimensional 
vectors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smooth.surp(argvals, y, Bmat0, Sfd, Zmat, wtvec=NULL, conv=1e-4,
            iterlim=50, dbglev=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smooth.surp_+3A_argvals">argvals</code></td>
<td>

<p>Argument value array of length N, where N is the number of observed
curve values for each curve.  It is assumed that that these argument
values are common to all observed curves.  If this is not the case,
you will need to run this function inside one or more loops,
smoothing each curve separately.
</p>
</td></tr>
<tr><td><code id="smooth.surp_+3A_y">y</code></td>
<td>

<p>A <code>nbin</code> by <code>M_i</code> matrix of surprisal values to be fit.  
</p>
</td></tr>
<tr><td><code id="smooth.surp_+3A_bmat0">Bmat0</code></td>
<td>
<p>A <code>Snbasis</code> by <code>M_i - 1</code> matrix containing starting
values for the iterative optimization of the least squares fit of the 
surprisal curves to the surprisal data.
</p>
</td></tr>
<tr><td><code id="smooth.surp_+3A_sfd">Sfd</code></td>
<td>

<p>A functional data object used toinitialize the optimization process.  
</p>
</td></tr>
<tr><td><code id="smooth.surp_+3A_zmat">Zmat</code></td>
<td>
<p>An <code>M by M-1</code> matrix satisfying <code>Zmat'Zmat &lt;- I} and 
    \code{Zmat'1 &lt;- 0</code>.</p>
</td></tr>
<tr><td><code id="smooth.surp_+3A_wtvec">wtvec</code></td>
<td>

<p>A vector of weights to be used in the smoothing.
</p>
</td></tr>
<tr><td><code id="smooth.surp_+3A_conv">conv</code></td>
<td>

<p>A convergence criterion.
</p>
</td></tr>
<tr><td><code id="smooth.surp_+3A_iterlim">iterlim</code></td>
<td>

<p>the maximum number of iterations allowed in the minimization of
error sum of squares.
</p>
</td></tr>
<tr><td><code id="smooth.surp_+3A_dbglev">dbglev</code></td>
<td>

<p>Either 0, 1, or 2.  This controls the amount information printed out
on each iteration, with 0 implying no output, 1 intermediate output
level, and 2 full output.  If either level 1 or 2 is specified, it
can be helpful to turn off the output buffering feature of S-PLUS.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of class <code>surpFd</code> with these members:
</p>
<table>
<tr><td><code>PENSSE</code></td>
<td>
<p>The final value of the penalized fitting criterion.</p>
</td></tr>
<tr><td><code>DPENSSE</code></td>
<td>
<p>The final gradient of the penalized fitting criterion.</p>
</td></tr>
<tr><td><code>D2PENSSE</code></td>
<td>
<p>The final hessian of the fitting criterion.</p>
</td></tr>
<tr><td><code>SSE</code></td>
<td>
<p>The final value of the error sum of squares.</p>
</td></tr>
<tr><td><code>DSSE</code></td>
<td>
<p>The final gradient of the error sum of squares.</p>
</td></tr>
<tr><td><code>D2SSE</code></td>
<td>
<p>The final hessian of the error sum of squares.</p>
</td></tr>
<tr><td><code>DvecSmatDvecB</code></td>
<td>
<p>The final cross derivative DvecSmatDvecX times 
DvecXmatDvecB of the surprisal curve and the basis coordinates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eval.surp">eval.surp</a></code>,
<code><a href="#topic+ICC_plot">ICC_plot</a></code>,
<code><a href="#topic+Sbinsmth">Sbinsmth</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  oldpar &lt;- par(no.readonly=TRUE)
  #  evaluation points
  x &lt;- seq(-2,2,len=11)
  #  evaluate a standard normal distribution function
  p &lt;- pnorm(x)
  #  combine with 1-p
  mnormp &lt;- cbind(p,1-p)
  M &lt;- 2
  #  convert to surprisal values
  mnorms &lt;- -log2(mnormp)
  #  plot the surprisal values
  matplot(x, mnorms, type="l", lty=c(1,1), col=c(1,1), 
          ylab="Surprisal (2-bits)")
  # add some log-normal error
  mnormdata &lt;- exp(log(mnorms) + rnorm(11)*0.1)
  #  set up a b-spline basis object
  nbasis &lt;- 7
  sbasis &lt;- create.bspline.basis(c(-2,2),nbasis)
  #  define an initial coefficient matrix
  cmat &lt;- matrix(0,7,1)
  #  set up a fd object for suprisal smoothing
  Sfd &lt;- fd(cmat, sbasis)
  Zmat &lt;- matrix(c(1,-1),2,1)
  #  smooth the noisy data
  result &lt;- smooth.surp(x, mnormdata, cmat, Sfd, Zmat)
  #  plot the data and the fits of the two surprisal curves
  xfine &lt;- seq(-2,2,len=51)
  sfine &lt;- eval.surp(xfine, result$Sfd, Zmat)
  matplot(xfine, sfine, type="l", lty=c(1,1), col=c(1,1))
  points(x, mnormdata[,1])
  points(x, mnormdata[,2])
  #  convert the surprisal fit values to probabilities
  pfine &lt;- 2^(-sfine)
  #  check that they sum to one
  apply(pfine,1,sum)
  par(oldpar)
</code></pre>

<hr>
<h2 id='Spca'>
Functional principal components analysis of information curve
</h2><span id='topic+Spca'></span>

<h3>Description</h3>

<p>A test or scale analysis produces a space curve that varies with in the space of 
possible option curves of dimension <code>Sdim</code>.  Fortunately, it is usual that most
of the shape variation in the curve is within only two or three dimensions, and these
can be fixed by using functional principal components analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  Spca(SfdList, nharm=2, Sdim=NULL, rotate=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Spca_+3A_sfdlist">SfdList</code></td>
<td>
<p>A numbered list object produced by a TestGardener analysis 
of a test.  Its length is equal to the number of items in the test or 
questions in the scale.  Each member of <code>SfdList</code> is a named list 
containing information computed during the analysis.</p>
</td></tr>
<tr><td><code id="Spca_+3A_sdim">Sdim</code></td>
<td>
<p>Interval over which curve is plotted. All if Sdim == NULL.</p>
</td></tr>
<tr><td><code id="Spca_+3A_nharm">nharm</code></td>
<td>
<p>The number of principal components of the test information or scale 
curve to be used to display the curve.  Must be either 2 or 3.</p>
</td></tr>
<tr><td><code id="Spca_+3A_rotate">rotate</code></td>
<td>
<p>If true, rotate principal components of the test information or 
scale curve to be used to display the curve to VARIMAX orientation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list with these members:
</p>
<table>
<tr><td><code>harmvarmxfd</code></td>
<td>
<p>Functional data objects for the principal
components of the curve shape.</p>
</td></tr> 
<tr><td><code>varpropvarmx</code></td>
<td>
<p>Proportions of variance accounted for by the principal 
components</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics. Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Spca_plot">Spca_plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#  Example 1.  Display the test information curve for the 
#  short SweSAT multiple choice test with 24 items and 1000 examinees
#  plot a two-dimension version of manifold curve
Sdim     &lt;- Quant_13B_problem_dataList$Sdim
SfdList  &lt;- Quant_13B_problem_parmList$SfdList
index    &lt;- Quant_13B_problem_parmList$index
infoSurp &lt;- Quant_13B_problem_parmList$infoSurp 
#      &lt;- Quant_13B_problem_dataList$Sdim
oldpar &lt;- par(no.readonly=TRUE)
on.exit(oldpar)
Results &lt;- Spca(SfdList, nharm=2, rotate=FALSE)
varprop &lt;- Results$varpropvarmx
print("Proportions of variance accounted for and their sum:")
print(round(100*c(varprop,sum(varprop)),1))
#  plot a three-dimension version of manifold curve
SfdList   &lt;- Quant_13B_problem_parmList$SfdList
index     &lt;- Quant_13B_problem_parmList$index
infoSurp  &lt;- Quant_13B_problem_parmList$infoSurp 
Results   &lt;- Spca(SfdList, nharm=3, rotate=FALSE)
varprop   &lt;- Results$varpropvarmx
print("Proportions of variance accounted for and their sum:")
print(round(100*c(varprop,sum(varprop)),1))
</code></pre>

<hr>
<h2 id='Spca_plot'>
Plot the test information or scale curve in either two or three dimensions.
</h2><span id='topic+Spca_plot'></span>

<h3>Description</h3>

<p>A test or scale analysis produces a space curve that varies with in the space of 
possible option curves of dimension <code>Sdim</code>.  Fortunately, it is usual that most
of the shape variation in the curve is within only two or three dimensions, and these
can be fixed by using functional principal components analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  Spca_plot(harmvarmxfd, nharm=2, titlestr=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Spca_plot_+3A_harmvarmxfd">harmvarmxfd</code></td>
<td>
<p>Functional data objects for the principal
components of the curve shape.</p>
</td></tr> 
<tr><td><code id="Spca_plot_+3A_nharm">nharm</code></td>
<td>
<p>Number of principal components.</p>
</td></tr> 
<tr><td><code id="Spca_plot_+3A_titlestr">titlestr</code></td>
<td>
<p>A string for the title of the plot.  Defaults to NULL. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Side effect is a two or three-dimensional plot of the principal component
approximation of the information curve using the plotly package.  Function
<code>plot_ly</code> does not return a value, but does render the graphic.
</p>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics. Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Spca">Spca</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#  Example 1.  Display the test information curve for the 
#  short SweSAT multiple choice test with 24 items and 1000 examinees
#  plot a two-dimension version of manifold curve
SfdList    &lt;- Quant_13B_problem_parmList$SfdList
index    &lt;- Quant_13B_problem_parmList$index
arclength  &lt;- Quant_13B_problem_parmList$arclength 
Results    &lt;- Spca(SfdList,  nharm=2, rotate=TRUE)
varprop    &lt;- Results$varpropvarmx
titlestr   &lt;- "SweSAT problem items"
oldpar &lt;- par(no.readonly=TRUE)
on.exit(oldpar)
Spca_plot(Results$harmvarmxfd, nharm=2, titlestr)
print("Proportions of variance accounted for and their sum:")
print(round(100*c(varprop,sum(varprop)),1))
#  plot a three-dimension version of manifold curve
SfdList    &lt;- Quant_13B_problem_parmList$SfdList
index    &lt;- Quant_13B_problem_parmList$index
arclength  &lt;- Quant_13B_problem_parmList$arclength 
Results    &lt;- Spca(SfdList,  nharm=3, rotate=TRUE)
varprop    &lt;- Results$varpropvarmx
Spca_plot(Results$harmvarmxfd, nharm=3, titlestr)
print("Proportions of variance accounted for and their sum:")
print(round(100*c(varprop,sum(varprop)),1))
</code></pre>

<hr>
<h2 id='TestGardener'>Analyses of Tests and Rating Scales using Information or Surprisal</h2><span id='topic+TestGardener'></span>

<h3>Description</h3>

<p>TestGardener is designed to permit the analysis of choice data from multiple choice tests and rating scales using information as an alternative to the usual models based on probability of choice. 
</p>
<p>Probabability and information are related by the simple transformation &quot;information = -log probability&quot;.  Another term for information is &quot;surprisal.&quot;
</p>
<p>The advantage of information methodology, often used in the engineering and physical sciences, is that measurabe, and therefore is on what is called a &quot;ratio scale&quot; in the social sciences.  That is, information or rurprisal has a lower limit of zero, is unbounded above, and can be added, subtracted and rescaled with a positive multiplier. 
</p>
<p>The disadvantage of probability as a basis for representing choice is that differences near its two boundaries are on very different scales than those near 0.5, and our visual and other sensory systems, which are adapted to mangitudes, have many problems in assessing the nonlinear probability continuum.
</p>
<p>TestGardener uses highly adaptable and computationally efficient spline basis functions to represent item characteristic curves for both probability and surprisal.  Splines bases permit as much flexibility as the task requires, and also can control the smoothness and the order of differentiation.  
</p>
<p>The higher variability revealed by information or surprisal curves reveals many more insights into choice behavior than the usual simple curve employed in standard probability-based item response theory.
</p>
<p>The use of information as a measure also implies a measure of inter-item covariation called mutual entropy.  Entropy a function whose value at any point is the average across surprisal curves produced by summing over curves for a given item of the product of probability and surprisal.
</p>
<p>Graphical display is a large part of the TestGardener capacity, with extensive use of the ggplot2 and plotly packages.
</p>

<hr>
<h2 id='TestInfo_svd'>
Image of the Test Tnformation Curve in 2 or 3 Dimensions
</h2><span id='topic+TestInfo_svd'></span>

<h3>Description</h3>

<p>The test information curve is the trajectory of joint variation of all 
the surprisal curves within the ambient space of dimension the total number 
of curves.  But usually a very high percent of the shape variation in the 
curve can be represented in either two or three dimensions using the singular
value decomposition of a matrix of total curve values over a fine mesh.  
The resulting approximation is converted to a set of surprisal curve values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  TestInfo_svd(scrfine, SfdList, itemindex=1:n, nharm=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TestInfo_svd_+3A_scrfine">scrfine</code></td>
<td>
<p>A fine mesh of values over which the image is plotted.  This 
is usually either the score index theta or the test arc length.</p>
</td></tr>
<tr><td><code id="TestInfo_svd_+3A_sfdlist">SfdList</code></td>
<td>
<p>A list vector of length n, the number of test items.  
Each list in the vector contains values of the surprisal curves for that
item.</p>
</td></tr>
<tr><td><code id="TestInfo_svd_+3A_itemindex">itemindex</code></td>
<td>
<p>A vector of item indices to be used in the approximation.</p>
</td></tr>
<tr><td><code id="TestInfo_svd_+3A_nharm">nharm</code></td>
<td>
<p>The number of dimension in the approximation, usually either 
two or three.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The approximation is returned as a surprisal functional data object, and so
are the percentages of the total variation fit by each dimension in the
approximation.
</p>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics. Psych, 2, 347-360.
</p>

<hr>
<h2 id='TG_analysis'>Statistics for Multiple choice Tests, Rating Scales and Other Choice Data)
</h2><span id='topic+TG_analysis'></span>

<h3>Description</h3>

<p>Given an choice ingter-valued index matrix and a vector of numbers 
of item options, the function cycles through a set of iterations 
involving surprisal curve estimation followed by test taker index 
values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  TG_analysis(chcemat, scoreList, noption, sumscr_rng=NULL, 
              titlestr=NULL, itemlabvec=NULL, optlabList=NULL,
              nbin=nbinDefault(N), NumBasis=7, NumDensBasis=7,
              jitterwrd=TRUE, PcntMarkers=c( 5, 25, 50, 75, 95),
              ncycle=10, itdisp=FALSE, verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TG_analysis_+3A_chcemat">chcemat</code></td>
<td>
<p>An N by n matrix.  Column i must contain the integers 
from 1 to M_i, where M_i is the number of options
for item i.  If missing or illegitimate responses exist
for item i,  the column must also contain an integer
greater than M_i that is used to identify such responoses. 
Alternatively, the column use NA for this purpose.
Because missing and illegible responses are normally
rare, they are given a different and simpler estimation
procedure for their surprisal values.
U is mandatory.</p>
</td></tr>
<tr><td><code id="TG_analysis_+3A_scorelist">scoreList</code></td>
<td>
<p>Either a list of length n, each containing a vector of 
length M_i that assigns numeric weights to the options
for that item.  
In the special case of multiple choice items where the 
correct option has weight 1 and all others weight 0, 
a single integer can identify the correct answer.
If all the items are of the multiple 
type, scoreList may be a numeric vector of length n
containing the right answer indices.  List object
scoreList is mandatory because these weights define the
person scores for the surprisal curve estimation process.</p>
</td></tr>
<tr><td><code id="TG_analysis_+3A_noption">noption</code></td>
<td>
<p>A numeric vector of length <code>n</code> containing the 
number of options for each item.</p>
</td></tr>
<tr><td><code id="TG_analysis_+3A_sumscr_rng">sumscr_rng</code></td>
<td>
<p>A vector of length 2 indicating the initial and final
sum score values.  Default is NULL the whole sum score
is used.</p>
</td></tr>
<tr><td><code id="TG_analysis_+3A_titlestr">titlestr</code></td>
<td>
<p>A title string for the data and their analyses.
Default is NULL.</p>
</td></tr>
<tr><td><code id="TG_analysis_+3A_itemlabvec">itemlabvec</code></td>
<td>
<p>A character value containing labels for the items.
Default is NULL and item position numbers are used.</p>
</td></tr>
<tr><td><code id="TG_analysis_+3A_optlablist">optlabList</code></td>
<td>
<p>A list vector of length n, each element i of which is a
character vector of length M_i.
Default is NULL, and option numbers are used.</p>
</td></tr>
<tr><td><code id="TG_analysis_+3A_nbin">nbin</code></td>
<td>
<p>The number of bins containing proportions of choices.</p>
</td></tr>
<tr><td><code id="TG_analysis_+3A_numbasis">NumBasis</code></td>
<td>
<p>The number of spline basis functions to use for 
surprisal values.  Defaults to 7.</p>
</td></tr>
<tr><td><code id="TG_analysis_+3A_numdensbasis">NumDensBasis</code></td>
<td>
<p>The number of spline basis functions to use for 
score probability density function.  Defaults to 7.</p>
</td></tr>
<tr><td><code id="TG_analysis_+3A_jitterwrd">jitterwrd</code></td>
<td>
<p>A logical object indicating whether a small jittering
perturbation should be used to break up ties.  
Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="TG_analysis_+3A_pcntmarkers">PcntMarkers</code></td>
<td>
<p>A vector of percentages inside of [0,100] that appear
in plots.  Defaults to c(5, 25, 50, 75, 95).
Extra displays are provided.  Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="TG_analysis_+3A_ncycle">ncycle</code></td>
<td>
<p>The number of cycles in the analysis.  Defaults to 10.</p>
</td></tr>
<tr><td><code id="TG_analysis_+3A_itdisp">itdisp</code></td>
<td>
<p>Display results for function <code>theta_fun</code>.</p>
</td></tr>
<tr><td><code id="TG_analysis_+3A_verbose">verbose</code></td>
<td>
<p>Extra displays are provided.  Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function in package TestGardener processes at a mininum two objects:  
(1) A matrix <code>chcemat</code> that contains indices of choices made in a 
sequence of choice situations (its number columns <code>n</code>) by a set of 
persons making the choices (its number of rows <code>N</code>); and
(2) A list vector <code>scoreList</code> of length <code>n</code> containing numerical 
weights or scores for each choice available with in each of <code>n</code> choice
situations (referred to as <code>items</code>).
</p>
<p>The function returns three large lists containing objects that can be used
to assess:
(1) the probability that a choice will be made, and
(2) the quantity of information, called <code>surprisal</code>, that the choice 
made reveals about the performance or experience of the person making the 
choice.
</p>


<h3>Value</h3>

<p>Four list objects, each containing objects that are required for various
displays, tables and other results:
</p>
<table>
<tr><td><code>parmList</code></td>
<td>
<p>A list object containing objects useful for displaying
results that involve the score index cotninuum:</p>
</td></tr>
</table>

<ul>
<li><p>SfdList: A list object of length n, each containing  
objects for an item for displaying that item's surprisal curves
as defined by the score index values after the analysis.
See the help page for function <code>Analyze</code> for a
description of these objects.
</p>
</li>
<li><p>Qvec: A vector containing the positions on the score index
continuum of the marker percentages defined in the arguments of
function <code>make_dataList()</code>.
</p>
</li>
<li><p>binctr: A vector of length <code>nbin</code> containing the positions 
on the score index continuum of the bin centres.
</p>
</li>
<li><p>indexScore: A vector of length <code>N</code> containing 
the positions on the score index contiuum of each person.
</p>
</li>
<li><p>infoSurp: The length of the test or scale information 
continuum in M-bits.
</p>
</li></ul>

<table>
<tr><td><code>infoList</code></td>
<td>
<p>A list object containing objects useful for displaying
results that involve the scale information cotninuum:</p>
</td></tr>
</table>

<ul>
<li><p>infofine: A fine mesh of 101 values that is used to plot
the scale information comntinuum.
</p>
</li>
<li><p>scopevec: A vector of length <code>N</code> containing 
the positions on the scale information contiuum of each person.
</p>
</li>
<li><p>Qinfovec: A vector containing the positions on the scale
information continuum of the marker percentages defined in the 
arguments of function <code>make_dataList()</code>.
</p>
</li>
<li><p>infobinctr: A vector of length <code>nbin</code> containing the positions 
on the scale information continuum of the bin centres.
</p>
</li></ul>

<table>
<tr><td><code>HALsave</code></td>
<td>
<p>A <code>ncycle</code> by 2 matrix containing in the first column
the data fit values and in the second column the infoSurp or arclength
values.</p>
</td></tr>
<tr><td><code>analysisListvec</code></td>
<td>
<p>A list of length <code>ncycle</code> containing the 
<code>parmList</code> object for each cycle.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make_dataList">make_dataList</a>,
        <a href="#topic+Analyze">Analyze</a>,
        <a href="#topic+index_distn">index_distn</a>,
        <a href="#topic+index2info">index2info</a>,
        <a href="#topic+index_fun">index_fun</a>,
        <a href="#topic+Sbinsmth">Sbinsmth</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  #  Example 1:  Input choice data and key for the short version of the 
  #  SweSAT quantitative multiple choice test with 24 items and 1000 examinees
  #  input the choice indices in the 1000 by 24 choice index matrix
  chcemat &lt;- Quant_13B_problem_chcemat
  #  set up the key data
  key     &lt;- Quant_13B_problem_key
  # number of examinees and of items
  N &lt;- nrow(chcemat)
  n &lt;- ncol(chcemat)
  # number of options per item and option weights
  noption &lt;- rep(0,n)
  for (i in 1:n) noption[i]  &lt;- 4
  scoreList &lt;- list() # option scores
  for (item in 1:n){
    scorei &lt;- rep(0,noption[item])
    scorei[key[item]] &lt;- 1
    scoreList[[item]] &lt;- scorei
  }
  #  Analyze the data and return the big three list objects:
  #  dataList (input info), parmList (score index info) and
  #  infoList (information or scope info)
  TGresult &lt;- TG_analysis(chcemat, scoreList, noption, 
                          NumBasis=4, ncycle=10, verbose=TRUE)
## End(Not run)
</code></pre>

<hr>
<h2 id='TG_density.fd'>
Compute a Probability Density Function
</h2><span id='topic+TG_density.fd'></span>

<h3>Description</h3>

<p>Like the regular S-PLUS function <code>density</code>, this function
computes a probability density function for a sample of values of a
random variable.  However, in this case the density function is
defined by a functional parameter object <code>logdensfdPar</code> along with a
normalizing constant <code>C</code>.
</p>
<p>The density function $p(indexdens)$ has the form 
<code>p(indexdens) = C exp[W(indexdens)]</code>
where function $W(indexdens)$ is defined by the functional data object
<code>logdensfdPar</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fd'
TG_density(indexdens, logdensfd, conv=0.0001, iterlim=20,
           active=1:nbasis, dbglev=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TG_density.fd_+3A_indexdens">indexdens</code></td>
<td>

<p>a set observations, which may be one of two forms:
</p>

<ol>
<li><p> a vector of observations $indexdens_i$
</p>
</li>
<li><p> a two-column matrix, with the observations $indexdens_i$ in the
first column, and frequencies $f_i$ in the second.
</p>
</li></ol>

<p>The first option corresponds to all $f_i = 1$.
</p>
</td></tr>
<tr><td><code id="TG_density.fd_+3A_logdensfd">logdensfd</code></td>
<td>

<p>a functional data object specifying the initial
value, basis object, roughness penalty and smoothing
parameter defining function $W(t).$
</p>
</td></tr>
<tr><td><code id="TG_density.fd_+3A_conv">conv</code></td>
<td>

<p>a positive constant defining the convergence criterion.
</p>
</td></tr>
<tr><td><code id="TG_density.fd_+3A_iterlim">iterlim</code></td>
<td>

<p>the maximum number of iterations allowed.
</p>
</td></tr>
<tr><td><code id="TG_density.fd_+3A_active">active</code></td>
<td>

<p>a logical vector of length equal to the number of coefficients
defining <code>Wfdobj</code>. If an entry is TRUE, the corresponding
coefficient is estimated, and if FALSE, it is held at the value defining the
argument <code>Wfdobj</code>.  Normally the first coefficient is set to 0
and not estimated, since it is assumed that $W(0) = 0$.
</p>
</td></tr>
<tr><td><code id="TG_density.fd_+3A_dbglev">dbglev</code></td>
<td>

<p>either 0, 1, or 2.  This controls the amount information printed out on
each iteration, with 0 implying no output, 1 intermediate output level,
and 2 full output.  If levels 1 and 2 are used, it is helpful to
turn off the output buffering option in S-PLUS.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The goal of the function is provide a smooth density function
estimate that approaches some target density by an amount that is
controlled by the linear differential operator <code>Lfdobj</code> and
the penalty parameter. For example, if the second derivative of
$W(t)$ is penalized heavily, this will force the function to
approach a straight line, which in turn will force the density function
itself to be nearly normal or Gaussian.  Similarly, to each textbook
density function there corresponds a $W(t)$, and to each of these
in turn their corresponds a linear differential operator that will, when
apply to $W(t)$, produce zero as a result.
To plot the density function or to evaluate it, evaluate <code>Wfdobj</code>,
exponentiate the resulting vector, and then divide by the normalizing
constant <code>C</code>.
</p>


<h3>Value</h3>

<p>a named list of length 4 containing:
</p>
<table>
<tr><td><code>Wfdobj</code></td>
<td>

<p>a functional data object defining function $W(indexdens)$ that that
optimizes the fit to the data of the monotone function that it defines.
</p>
</td></tr>
<tr><td><code>C</code></td>
<td>

<p>the normalizing constant.
</p>
</td></tr>
<tr><td><code>Flist</code></td>
<td>

<p>a named list containing three results for the final converged solution:
(1)
<b>f</b>: the optimal function value being minimized,
(2)
<b>grad</b>: the gradient vector at the optimal solution,   and
(3)
<b>norm</b>: the norm of the gradient vector at the optimal solution.
</p>
</td></tr>
<tr><td><code>iternum</code></td>
<td>

<p>the number of iterations.
</p>
</td></tr>
<tr><td><code>iterhist</code></td>
<td>

<p>a <code>iternum+1</code> by 5 matrix containing the iteration
history.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Full information optimal scoring. 
Journal of Educational and Behavioral Statistics, 45, 297-315.
</p>
<p>Ramsay, J. O., Li J. and Wiberg, M. (2020) Better rating scale scores with 
information-based psychometrics.  Psych, 2, 347-360.
</p>


<h3>See Also</h3>

<p><code><a href="fda.html#topic+intensity.fd">intensity.fd</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
