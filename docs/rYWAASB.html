<!DOCTYPE html><html lang="en-US"><head><title>Help for package rYWAASB</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rYWAASB}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rYWAASB-package'><p>Simultaneous Selection by Trait and WAASB Index</p></a></li>
<li><a href='#bar_plot1'><p>The first barplot of the ranks of genotypes</p></a></li>
<li><a href='#bar_plot2'><p>The second barplot of the ranks of genotypes</p></a></li>
<li><a href='#data_ge'><p>Dataset2: a tibble containing ENV, GEN, REP factors and</p>
GY(grain yield) and HM agronomic traits from the <code>metan</code> package.</a></li>
<li><a href='#maize'><p>Dataset1: a tibble containing GEN, Trait, <code>WAASB</code> and <code>WAASBY</code> indexes.</p></a></li>
<li><a href='#nbclust'><p>Data read and estimate the cluster number</p></a></li>
<li><a href='#PCA_biplot'><p>The PCA biplot with loadings</p></a></li>
<li><a href='#ranki'><p>The values and ranks of genotypes</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simultaneous Selection by Trait and WAASB Index</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-09-23.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ali Arminian &lt;abeyran@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>This tool proposes a new ranking algorithm that utilizes a "Y*WAASB" biplot generated by the 'metan'. The aim of the current package is to effectively distinguish the top-ranked genotypes in MET (Multi-Environmental Trials). For a detailed explanation of the process of obtaining "WAASB", "WAASBY" indices, and a "Y*WAASB" biplot, refer to the manual included in this package as well as the study by Olivoto &amp; Lúcio (2020) &lt;<a href="https://doi.org/10.1111%2F2041-210X.13384">doi:10.1111/2041-210X.13384</a>&gt;. In this context, "WAASB" refers to the "Weighted Average of Absolute Scores" provided by Olivoto et al. (2019) &lt;<a href="https://doi.org/10.2134%2Fagronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>&gt;, which quantifies the stability of genotypes across different environments using linear mixed-effect models. To run the package, you need to extract the "WAASB" and "WAASBY" coefficients using the 'metan' and apply them. This tool utilizes PCA (Principal Component Analysis) and differentiates the entries which may be genotypes, hybrids, varieties, etc using "WAASB", "WAASBY", and a combination of the specified trait and WAASB index.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/abeyran/rYWAASB">https://github.com/abeyran/rYWAASB</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/abeyran/rYWAASB/issues">https://github.com/abeyran/rYWAASB/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, graphics, factoextra, FactoMineR, lifecycle, mathjaxr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>car, metan, devtools, usethis, testthat, knitr, rmarkdown,
roxygen2, spelling</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>mathjaxr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Copyright:</td>
<td>Ali Arminian</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Author:</td>
<td>Ali Arminian <a href="https://orcid.org/0000-0003-4749-6085"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-29 19:12:39 UTC; Administrator</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-30 07:10:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='rYWAASB-package'>Simultaneous Selection by Trait and WAASB Index</h2><span id='topic+rYWAASB'></span><span id='topic+rYWAASB-package'></span>

<h3>Description</h3>

<p><span class="pkg">rYWAASB</span> performs a new ranking algorithm based on a
&quot;Y*WAASB&quot; biplot generated by the 'metan' package which is
used in MET(Multi-Environmental Trials).
This package effectively distinguishes the top-ranked genotypes
based on a given trait (e.g. grain yield or any other trait
in agricultural experiments) and the &quot;WAASB&quot; index in the
Genotype-by-environment interaction effect studies.
Note: Fortunately, this package can impute missing
observations and computes them, eliminating any concerns
about their presence in the data set. A complete guide
may be found at: <a href="https://github.com/abeyran/rYWAASB/issues">https://github.com/abeyran/rYWAASB/issues</a>
</p>


<h3>Author(s)</h3>


<p>Ali Arminian <a href="mailto:abeyran@gmail.com">abeyran@gmail.com</a>

</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/abeyran/rYWAASB">https://github.com/abeyran/rYWAASB</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/abeyran/rYWAASB/issues">https://github.com/abeyran/rYWAASB/issues</a>
</p>
</li></ul>


<hr>
<h2 id='bar_plot1'>The first barplot of the ranks of genotypes</h2><span id='topic+bar_plot1'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>

<ul>
<li> <p><code>bar_plot1()</code> creates a bar plot for the new index (rYWAASB
for individuals) for simultaneous selection of genotypes by
trait and WAASB index using ggplot2.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>bar_plot1(datap)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bar_plot1_+3A_datap">datap</code></td>
<td>
<p>The data set</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code style="white-space: pre;">&#8288;gg, ggmatrix&#8288;</code>.
</p>


<h3>Author(s)</h3>


<p>Ali Arminian <a href="mailto:abeyran@gmail.com">abeyran@gmail.com</a>

</p>


<h3>References</h3>

<p>H. Wickham. ggplot2: Elegant Graphics for Data Analysis.
Springer-Verlag New York, 2016.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(maize)
bar_plot1(maize)

</code></pre>

<hr>
<h2 id='bar_plot2'>The second barplot of the ranks of genotypes</h2><span id='topic+bar_plot2'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>

<ul>
<li> <p><code>bar_plot2()</code> creates the 2nd barplot of the ranks of genotypes
using the <code>graphics</code> package.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>bar_plot2(datap, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bar_plot2_+3A_datap">datap</code></td>
<td>
<p>The data set</p>
</td></tr>
<tr><td><code id="bar_plot2_+3A_verbose">verbose</code></td>
<td>
<p>If <code>verbose = TRUE</code> then some results are printed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code style="white-space: pre;">&#8288;gg, graphics&#8288;</code>
</p>


<h3>Author(s)</h3>


<p>Ali Arminian <a href="mailto:abeyran@gmail.com">abeyran@gmail.com</a>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(maize)
bar_plot2(maize, verbose = FALSE)

</code></pre>

<hr>
<h2 id='data_ge'>Dataset2: a tibble containing ENV, GEN, REP factors and
GY(grain yield) and HM agronomic traits from the <code>metan</code> package.</h2><span id='topic+data_ge'></span>

<h3>Description</h3>

<p>Dataset2: a tibble containing ENV, GEN, REP factors and
GY(grain yield) and HM agronomic traits from the <code>metan</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data_ge)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 420 rows in 5 columns.
</p>

<dl>
<dt><code>ENV</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>GEN</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>REP</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>GY</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>HM</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>References</h3>

<p>Olivoto, T., &amp; Lúcio, A.D.C.2020. metan: An R package for
multi‐environment trial analysis. Methods in Ecology and Evolution
, 11(6), 783-789.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(rYWAASB)
data(data_ge)

</code></pre>

<hr>
<h2 id='maize'>Dataset1: a tibble containing GEN, Trait, <code>WAASB</code> and <code>WAASBY</code> indexes.</h2><span id='topic+maize'></span>

<h3>Description</h3>

<p>Dataset1: a tibble containing GEN, Trait, <code>WAASB</code> and <code>WAASBY</code> indexes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(maize)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 20 observations (genotypes)
within rows and columns including the trait (named as <code>Y</code>),
<code>WAASB</code> and <code>WAASBY</code> indexes values.
</p>

<dl>
<dt><code>GEN</code></dt><dd><p>a character vector saved as factor</p>
</dd>
<dt><code>Y</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>WAASB</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>WAASBY</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>

<p>The input format of table of data(NA free), here <em>maize</em> data,
should be as follows:
</p>

<table>
<tr>
 <td style="text-align: right;">
<strong>GEN</strong> </td><td style="text-align: right;"> <strong>Y</strong> </td><td style="text-align: right;"> <strong>WAASB</strong> </td><td style="text-align: right;"> <strong>WAASBY</strong></td>
</tr>
<tr>
 <td style="text-align: right;">
Dracma </td><td style="text-align: right;"> 262.22 </td><td style="text-align: right;"> 0.81 </td><td style="text-align: right;"> 81.6</td>
</tr>
<tr>
 <td style="text-align: right;">
DKC6630 </td><td style="text-align: right;"> 284.04 </td><td style="text-align: right;"> 2.20 </td><td style="text-align: right;"> 88.5</td>
</tr>
<tr>
 <td style="text-align: right;">
NS770 </td><td style="text-align: right;"> 243.48 </td><td style="text-align: right;"> 0.33 </td><td style="text-align: right;"> 71.4</td>
</tr>
<tr>
 <td style="text-align: right;">
...
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>
library(rYWAASB)
data(maize)
ranki(maize)
bar_plot1(maize)
bar_plot2(maize)
PCA_biplot(maize)

</code></pre>

<hr>
<h2 id='nbclust'>Data read and estimate the cluster number</h2><span id='topic+nbclust'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p><code>nbclust()</code> Reads and prepares the data, and
determine the optimum number of clusters using Average
Silhouette Method by <code>factoextra</code> package.
The average silhouette approach assesses the quality of
clustering by evaluating how well each object fits within
its cluster. A high average silhouette width signifies
effective clustering. This method calculates the average
silhouette for different values of k, and the optimal
number of clusters (k) is the one that maximizes the
average silhouette across a range of potential k values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nbclust(datap, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nbclust_+3A_datap">datap</code></td>
<td>
<p>The data set</p>
</td></tr>
<tr><td><code id="nbclust_+3A_verbose">verbose</code></td>
<td>
<p>If <code>verbose = TRUE</code> then some results are</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>silhouette</code> coefficient (SC) refers to a criterion
to decide number of clusters.It is defined as follows.
Though there are numerous methods determining number
of clusters such as <code style="white-space: pre;">&#8288;the gap statistic&#8288;</code> etc.
</p>
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[SC = maxK{\bar{S}K}\]<p>.
</p>
<p>In other words, for each observation \(i\), the
<code style="white-space: pre;">&#8288;silhouette width&#8288;</code> \(s(i)\) is defined as follows:
Put \(a(i)\) = average dissimilarity between i and all
other points of the cluster to which i belongs (if i is the only
observation in its cluster, \(s(i):= 0\) without further
calculations). For all other clusters C, put \(d(i, C)\)
= average dissimilarity of i to all observations of C.
The smallest of these \(d(i, C)\) is
\(b(i)=min\it(C) d(i, C)\), and can be seen as the
dissimilarity between i and its “neighbor” cluster, i.e.,
the nearest one to which it does not belong. Finally,
\[s(i)=:=\frac{b(i)-a(i)}{max(a(i), b(i))}\]
</p>

<ul>
<li><p> Note: The clustering methods can be: &quot;average&quot;, &quot;centroid&quot;,
&quot;complete&quot;, &quot;mcquitty&quot;, &quot;median&quot;, &quot;single&quot;, &quot;ward.D&quot;, &quot;ward.D2&quot;
and, Distance methods can be as: &quot;binary&quot;, &quot;canberra&quot;, &quot;euclidean&quot;,
&quot;manhattan&quot;, &quot;minkowski&quot;, &quot;maximum&quot;, &quot;pearson&quot;, &quot;spearman&quot;, &quot;kendall&quot;
which may be used in <code>shipunov</code> or <code>factoextra</code> packages.
In this package we just applied <code>average=UPGMA</code> and <code>ward</code> algorithms.
</p>
</li></ul>



<h3>Value</h3>

<p>Returns a data frame
</p>


<h3>Author(s)</h3>


<p>Ali Arminian <a href="mailto:abeyran@gmail.com">abeyran@gmail.com</a>

</p>


<h3>References</h3>

<p>Lletı, R., Ortiz, M.C., Sarabia, L.A., Sánchez, M.S. 2004.
Selecting variables for k-means cluster analysis by using
a genetic algorithm that optimizes the silhouettes,
Analytica Chimica Acta, 515(1): 87-100.
</p>
<p>Rousseeuw, P.J. (1987) Silhouettes: A graphical aid to the
interpretation and validation of cluster analysis.
J. Comput. Appl. Math., 20, 53-65.
</p>
<p>https://uc-r.github.io/
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(factoextra)

data(maize)
maize &lt;- as.data.frame(maize)
row.names(maize) &lt;- maize[, 1]
maize[, 1] = NULL
GEN &lt;- row.names(maize)
maize &lt;- scale(maize)
nbclust(maize, verbose = FALSE)

# Performing bootstrap or jackknife clustering
# by shipunov package. The examples should be run in the
# console manually due to problems occurs in the ORPHANED
# package `shipunov`.
#
# 1- Bootstrap clustering:
# data.jb &lt;- Jclust(maize,
#   method.d = "euclidean",
#    method.c = "average", n.cl = 2,
#     bootstrap = TRUE)
#
# plot.Jclust(data.jb, top=TRUE, lab.pos=1,
#  lab.offset=1, lab.col=2, lab.font=2)
# Fence(data.jb$hclust, GEN)
#
# data.jb &lt;- Jclust(maize,
#  method.d = "euclidean",
#    method.c = "ward.D", n.cl = 2,
#     bootstrap = TRUE)
#
# plot.Jclust(data.jb, top=TRUE, lab.pos=1,
#            lab.offset=1, lab.col=2, lab.font=2)
# Fence(data.jb$hclust, GEN)
#
# if(verbose = TRUE):
# cat("\nnumber of iterations:\n", data.jb$iter, "\n")
#
# for "bootstrap":
# data.jb$mat &lt;- as.matrix((data.jb$mat))
# data.jb$mat
# cat("\nmatrix of results:\n", data.jb$mat, "\n")
# cat("clustering info, by eucledean distance measure:\n")
# print(data.jb$hclust)
# cat("groups:\n", data.jb$gr, "\n")
# cat("\nsupport values:\n", data.jb$supp, "\n")
# cat("\nnumber of clusters used:\n", data.jb$n.cl, "\n")

# 2- Jackknife clustering:
# data.jb &lt;- Bclust(maize,
#   method.d = "euclidean", method.c = "average",
#    bootstrap = FALSE)
# plot(data.jb)
#
# data.jb &lt;- Bclust(maize,
#   method.d = "euclidean", method.c = "ward.D",
#    bootstrap = FALSE)
# plot(data.jb)
#
# if(verbose = TRUE):
# For"jackknife":
# cat("Consensus:\n", data.jb$consensus, "\n")
# cat("Vlaues:\n", data.jb$values, "\n")

</code></pre>

<hr>
<h2 id='PCA_biplot'>The PCA biplot with loadings</h2><span id='topic+PCA_biplot'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>

<ul>
<li> <p><code>PCA_biplot()</code> creates the PCA (Principal Component
Analysis) biplot with loadings for the new index <code>rYWAASB</code>
for simultaneous selection of genotypes by trait and WAASB index.
It shows <code>rYWAASB</code>, <code>rWAASB</code> and <code>rWAASBY</code> indices (r: ranked) in a
biplot, simultaneously for a better differentiation of genotypes.
In PCA biplots controlling the color of variable using their
contrib i.e. contributions and cos2 takes place.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>PCA_biplot(datap)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PCA_biplot_+3A_datap">datap</code></td>
<td>
<p>The data set</p>
</td></tr>
</table>


<h3>Details</h3>

<p><em>PCA</em> is a machine learning method and dimension
reduction technique.
It is utilized to simplify large data sets by extracting
a smaller set that preserves significant patterns and
trends(1).
According to Johnson and Wichern (2007), a PCA explains
the var-covar structure of a set of variables
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\(X_1, X_2, ..., X_p\) with a less <code>linear</code>
combinations of such variables. Moreover the common
objective of PCA is 1) data reduction and 2) interpretation.
</p>
<p><em>Biplot and PCA</em>:
The biplot is a method used to visually represent
both the rows and columns of a data table. It involves
approximating the table using a two-dimensional matrix
product, with the aim of creating a plane that represents
the rows and columns.
The techniques used in a biplot typically involve an eigen
decomposition, similar to the one used in PCA. It is common
for the biplot to be conducted using mean-centered and scaled
data(2).
</p>
<p><em>Algebra of PCA:</em>
As Johnson and Wichern (2007) stated(3), if the random vector
\(\mathbf{X'} = {X_1, X_2,...,X_p }\) have the
covariance matrix \(\sum\) with eigenvalues
\(
\lambda_1 \ge \lambda_2 \ge ... \ge \lambda_p \ge 0\).
</p>
<p>Regarding the linear combinations:
\[Y_1 = a'_1X = a_{11}X_1 + a_{12}X_2 + ... + a_{1P}X_p \]
\[Y_2 = a'_2X = a_{21}X_1 + a_{22}X_2 + ... + a_{2p}X_p\]
\[...\]
\[Y_p = a'_pX = a_{p1}X_1 + a_{p2}X_2 + ... + a_{pp}X_p\]
</p>
<p>where \(Var(Y_i) = \mathbf{a'_i\sum{a_i}}\) ,
i = 1, 2, ..., p
\(Cov(Y_i, Y_k) = \mathbf{a'_i\sum{a_k}}\) ,
i, k = 1, 2, ..., p
</p>
<p>The principal components refer to the uncorrelated
linear combinations
\(Y_1, Y_2, ..., Y_p\) which aim to have the
largest possible variances.
</p>
<p>For the random vector \(\mathbf{X'}=\left [ X_1, X_2, ...,
X_p \right ]\),
if \(\mathbf{\sum}\) be the associated covariance matrix, then
\(\mathbf{\sum}\) have the eigenvalue-eigenvector pairs
\((\lambda_1, e_1), (\lambda_2, e_2), ..., (\lambda_p, e_p)\),
and as said \(\lambda_1 \ge \lambda_2 \ge ... \ge \lambda_p \ge 0\).
</p>
<p>Then the \(\it{i}\)th principal component is as follows:
\[Y_i = \mathbf{e'_iX} = e_{i1}X_1 + e_{i2}X_2 + ... + e_{ip}X_p,
i = 1, 2, ..., p\], where \(Var(Y_i) =\mathbf(e'_i\sum{e_i}) = \lambda_i,
i = 1, 2, ..., p\)
\(Cov(Y_i, Y_k) = \mathbf{e'_i\sum e_i = 0, i \not\equiv k}\), and:
\(\sigma_{11} + \sigma_{22} + ... + \sigma_{pp} =
\sum_{i=1}^p{Var(X_i)} = \lambda_1 +
\lambda_2 + ... + \lambda_p = \sum_{i=1}^p{Var(Y_i)}\).
</p>
<p>Interestingly, Total population variance = \(\sigma_{11} + \sigma_{22}
+ ... + \sigma_{pp} = \lambda_1 + \lambda_2 + ... + \lambda_{p}\).
</p>
<p>Another issues that are significant in PCA analysis are:
</p>

<ol>
<li><p> The proportion of total variance due to (explained by)
the \(\mathit{k}\)th principal component:
\[\frac{\lambda_k}{(\lambda_1 + \lambda_2 + ... +
\lambda_p)},  k=1, 2, ..., p\]
</p>
</li>
<li><p> The correlation coefficients between the components \(Y_i\)
and the variables \(X_k\) is as follows:
\(\rho_{Y_i, X_k} = \frac{e_{ik}\sqrt{\lambda_i}}{\sqrt{\sigma_{kk}}}\),
i,k = 1, 2, ..., p
</p>
</li></ol>

<p>Please note that PCA can be performed on <code>Covariance</code> or
<code style="white-space: pre;">&#8288;correlation matrices&#8288;</code>.
And before PCA the data should be centered, generally.
</p>


<h3>Value</h3>

<p>Returns a a list of dataframes
</p>


<h3>Author(s)</h3>


<p>Ali Arminian <a href="mailto:abeyran@gmail.com">abeyran@gmail.com</a>

</p>


<h3>References</h3>

<p>(1) <a href="https://builtin.com">https://builtin.com</a>
</p>
<p>(2) <a href="https://pca4ds.github.io/biplot-and-pca.html">https://pca4ds.github.io/biplot-and-pca.html</a>.
</p>
<p>(3) Johnson, R.A. and Wichern, D.W. 2007. Applied
Multivariate Statistical Analysis. Pearson Prentice
Hall. 773 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(maize)
PCA_biplot(maize)

</code></pre>

<hr>
<h2 id='ranki'>The values and ranks of genotypes</h2><span id='topic+ranki'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p><code>ranki()</code> function ranks the genotypes (or entries) based on
a new index utilizing the given trait and &quot;WAASB&quot; index to
simultaneous select the top-ranked ones. This can be compared
with WAASBY index of Olivoto (2019). We suggest users handle
the missing data in inputs before considering analyses,
due rank codes dose not implement a widespread algorithm
to do this task.
WAASB(Weighted Average of Absolute Scores), Computes
the Weighted Average of Absolute Scores (Olivoto et al.,
2019) for quantifying the stability of <em>g</em> genotypes
conducted in <em>e</em> environments using linear mixed-effect models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ranki(datap)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ranki_+3A_datap">datap</code></td>
<td>
<p>The data set</p>
</td></tr>
</table>


<h3>Details</h3>

<p>According to Olivoto et al. (2019a), WAASB(The weighted average of
absolute scores) is computed considering all Interaction Principal
Component Axis (IPCA) from the Singular Value Decomposition (SVD)
of the matrix of genotype-environment interaction (GEI) effects
generated by a linear mixed-effect model, as follows:
</p>
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[
WAASB_i = \sum_{k = 1}^{p} |IPCA_{ik} \times EP_k|/
\sum_{k = 1}^{p}EP_k\]
<p>where \(WAASB_i\) is the weighted average of absolute scores
of the <em>i</em>th genotype; \(IPCA_{ik}\) is the score of the <em>i</em>th
genotype in the <em>k</em>th Interaction Principal Component Axis (IPCA);
and \(EP_k\) is the explained variance of the <em>k</em>th IPCA for
<em>k = 1,2,..,p</em>, considering \(p=min(g-1; e-1)\).
</p>
<p>Further, \(WAASBY_i\) is a superiority or simultaneous
selection index allowing weighting between mean performance
and stability
\[
WAASBY_i=\frac{\left({rY}_i\times\theta_Y\right)+
\left({rW}_i\times\theta_s\right)}{\theta_Y+\theta_s}
\]
, where \(WAASBY_i\) is the superiority index for genotype
\(\it{i}\) that weights between mean performance and stability;
\(\theta_Y\) and \(\theta_s\) are the weights for
mean performance and stability, respectively; \({rY_i}\) and
\({rW}_i\) are the rescaled values for mean performance
\(\bar{Y_i}\) and stability \(W_i\), respectively of
the genotype <em>i</em>. For the details of calculations, rescalling
and mathematics notations see (Olivoto et al., 2019).
</p>
<p>Finally, \(rYWAASB_i\) index is the sum of the ranks of the trait
(\(rY_i\)) and WAASB index (\(rWAASB_i\)) for each
individual:
</p>
\[
rYWAASB_i = {rY_i} + {rWAASB_i}\]<p>.
</p>
<p>The input format of table of data(NA free), here <em>maize</em> data,
should be as follows:
</p>

<table>
<tr>
 <td style="text-align: right;">
<strong>GEN</strong> </td><td style="text-align: right;"> <strong>Y</strong> </td><td style="text-align: right;"> <strong>WAASB</strong> </td><td style="text-align: right;"> <strong>WAASBY</strong></td>
</tr>
<tr>
 <td style="text-align: right;">
Dracma </td><td style="text-align: right;"> 262.22 </td><td style="text-align: right;"> 0.81 </td><td style="text-align: right;"> 81.6</td>
</tr>
<tr>
 <td style="text-align: right;">
DKC6630 </td><td style="text-align: right;"> 284.04 </td><td style="text-align: right;"> 2.20 </td><td style="text-align: right;"> 88.5</td>
</tr>
<tr>
 <td style="text-align: right;">
NS770 </td><td style="text-align: right;"> 243.48 </td><td style="text-align: right;"> 0.33 </td><td style="text-align: right;"> 71.4</td>
</tr>
<tr>
 <td style="text-align: right;">
...
</td>
</tr>

</table>



<h3>Value</h3>

<p>Returns a data frame showing numerical rankings
</p>


<h3>Author(s)</h3>


<p>Ali Arminian <a href="mailto:abeyran@gmail.com">abeyran@gmail.com</a>

</p>


<h3>References</h3>

<p>Olivoto, T., Lúcio, A., DC, da Silva, J.A.G., Sari, B.G.
and Diel, M. 2019. Mean performance and stability in
multi-environment trials II: Selection based on multiple
traits. Agronomy Journal, 111(6):2961-2969.
</p>
<p>Olivoto, T., &amp; Lúcio, A.D.C.2020. metan: An R package for
multi‐environment trial analysis. Methods in Ecology and
Evolution, 11(6), 783-789.
</p>
<p>Kang, M.S. 1988. “A Rank-Sum Method for Selecting High-Yielding,
Stable Corn Genotypes.” Cereal Research Communications 16: 113–15.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(maize)
ranki(maize)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
