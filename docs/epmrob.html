<!DOCTYPE html><html lang="en"><head><title>Help for package epmrob</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {epmrob}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#epmrob-package'>
<p>Robust estimation of probit models with endogeneity</p></a></li>
<li><a href='#coef.epmrob'>
<p>Extract Coefficients from the Robust Endogenous Probit Model Fit</p></a></li>
<li><a href='#epmrob'>
<p>Robust Fit of Probit Model with Endogeneity</p></a></li>
<li><a href='#epmrob.vcov'>
<p>Extract Asymptotic Variance Covariance Matrix</p></a></li>
<li><a href='#IVProbitRob'>
<p>Robust Probit Model with Endogeneity</p></a></li>
<li><a href='#print.epmrob'>
<p>Print a <code>epmrob</code> object</p></a></li>
<li><a href='#print.summary.epmrob'>
<p>Print Function for <code>summary.epmrob</code></p></a></li>
<li><a href='#rob.control'>
<p>Auxiliary for Controlling Robust Fitting</p></a></li>
<li><a href='#summary.epmrob'>
<p>Summarizing Robust Fits of Endogenous Probit Models</p></a></li>
<li><a href='#xweights'>
<p>Robustness Weights</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Estimation of Probit Models with Endogeneity</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-06-14</td>
</tr>
<tr>
<td>Author:</td>
<td>Mikhail Zhelonkin <a href="https://orcid.org/0000-0002-6912-4074"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Andre Bik [aut],
  Andrea Naghi [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mikhail Zhelonkin &lt;Mikhail.Zhelonkin@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Package provides a set of tools for robust estimation and inference for probit model with endogenous covariates. The current version contains a robust two-step estimator. For technical details, see Naghi, Varadi and Zhelonkin (2022), &lt;<a href="https://doi.org/10.1016%2Fj.ecosta.2022.05.001">doi:10.1016/j.ecosta.2022.05.001</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>robustbase, MASS</td>
</tr>
<tr>
<td>Suggests:</td>
<td>mvtnorm</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-15 13:37:29 UTC; M.Zhelonkin</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-16 09:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='epmrob-package'>
Robust estimation of probit models with endogeneity
</h2><span id='topic+epmrob-package'></span>

<h3>Description</h3>

<p>Package provides a set of tools for robust estimation of probit models with endogeneity.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> epmrob </td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package </td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0 </td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-06-14 </td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Andre Bik, Andrea Naghi
</p>
<p>Maintainer: Mikhail Zhelonkin &lt;Mikhail.Zhelonkin@gmail.com&gt;
</p>


<h3>References</h3>

<p>Naghi, A. A., Varadi, M., &amp; Zhelonkin, M. (2022). Robust Estimation of Probit Models with Endogeneity. <em>Econometrics and Statistics</em>. <a href="https://doi.org/10.1016/j.ecosta.2022.05.001">doi:10.1016/j.ecosta.2022.05.001</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+epmrob">epmrob</a></code>, <code><a href="#topic+IVProbitRob">IVProbitRob</a></code>
</p>

<hr>
<h2 id='coef.epmrob'>
Extract Coefficients from the Robust Endogenous Probit Model Fit
</h2><span id='topic+coef.epmrob'></span>

<h3>Description</h3>

<p>Returns the coefficients of the robust two-stage estimator for endogenous probit model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'epmrob'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.epmrob_+3A_object">object</code></td>
<td>

<p>object of class &quot;<code><a href="#topic+epmrob">epmrob</a></code>&quot;.
</p>
</td></tr>
<tr><td><code id="coef.epmrob_+3A_...">...</code></td>
<td>

<p>currently not used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of two vectors of parameters of two stages.
</p>
<table role = "presentation">
<tr><td><code>R</code></td>
<td>
<p>coefficients of the reduced equation.</p>
</td></tr>
<tr><td><code>O</code></td>
<td>
<p>coefficients of the outcome equation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Andre Bik, Andrea Naghi
</p>

<hr>
<h2 id='epmrob'>
Robust Fit of Probit Model with Endogeneity
</h2><span id='topic+epmrob'></span>

<h3>Description</h3>

<p>Fits the endogenous probit model using a robust two-stage estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epmrob(reduced, outcome, data, control = rob.control())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="epmrob_+3A_reduced">reduced</code></td>
<td>

<p>formula, the reduced equation.
</p>
</td></tr>
<tr><td><code id="epmrob_+3A_outcome">outcome</code></td>
<td>

<p>formula, the outcome equation.
</p>
</td></tr>
<tr><td><code id="epmrob_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the variables in the model. If not found in data, the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>epmrob</code> is called.
</p>
</td></tr>
<tr><td><code id="epmrob_+3A_control">control</code></td>
<td>

<p>a list of parameterse for controlling the fitting process.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compute robust two-step estimates of the endogenous probit model. The robust linear regression is fitted in the first stage. In the second stage a Mallows-type M-estimator is used instead of the probit MLE. 
The values of the tuning constants and the robustness weights can be modified in <code><a href="#topic+rob.control">rob.control</a></code>.
</p>


<h3>Value</h3>

<p>Object of class &quot;epmrob&quot;.
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients</p>
</td></tr>
<tr><td><code>stage1</code></td>
<td>
<p>object of class <code>rlm</code> that contains first stage robust fit</p>
</td></tr>
<tr><td><code>stage2</code></td>
<td>
<p>object of class <code>glmrob</code> that contains second stage robust probit fit. Note that the standard errors in this object are biased, since they are not corrected for the uncertainty in the first estimation step. Use <code>vcov</code> below</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>variance matrix of the second stage</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Andre Bik, Andrea Naghi
</p>


<h3>References</h3>

<p>Naghi, A. A., Varadi, M., and Zhelonkin, M. (2022). Robust Estimation of Probit Models with Endogeneity. <em>Econometrics and Statistics</em>. <a href="https://doi.org/10.1016/j.ecosta.2022.05.001">doi:10.1016/j.ecosta.2022.05.001</a>
</p>


<h3>See Also</h3>

<p><code><a href="MASS.html#topic+rlm">rlm</a></code>, <code><a href="#topic+rob.control">rob.control</a></code>
</p>

<hr>
<h2 id='epmrob.vcov'>
Extract Asymptotic Variance Covariance Matrix
</h2><span id='topic+epmrob.vcov'></span>

<h3>Description</h3>

<p>Extracts the variance covariance matrix of the robust endogenous probit model fit by applying a bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epmrob.vcov(object, B = 200, control = rob.control())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="epmrob.vcov_+3A_object">object</code></td>
<td>

<p>object of class &quot;<code><a href="#topic+epmrob">epmrob</a></code>&quot;.
</p>
</td></tr>
<tr><td><code id="epmrob.vcov_+3A_b">B</code></td>
<td>

<p>the number of samples used in the bootstrapping process used to calculate the variance covariance matrix.
</p>
</td></tr>
<tr><td><code id="epmrob.vcov_+3A_control">control</code></td>
<td>

<p>a list of parameters for controlling the fitting process.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The variance covariance matrix is estimated by applying a bootstrap
</p>


<h3>Value</h3>

<p>Variance covariance matrix of the entire estimation procedure. Variance covariance matrix of the reduced stage or outcome stage can be extracted using the <code>vcov</code> function for the corresponding stage estimator, e.g. <code>vcov(epmrob.object$stage1)</code> or <code>vcov(epmrob.object$stage2)</code>.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Andre Bik, Andrea Naghi
</p>

<hr>
<h2 id='IVProbitRob'>
Robust Probit Model with Endogeneity
</h2><span id='topic+IVProbitRob'></span>

<h3>Description</h3>

<p>Compute robust two-stage estimates of probit model with endogeneity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IVProbitRob(reduced, outcome, data, control = rob.control())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IVProbitRob_+3A_reduced">reduced</code></td>
<td>

<p>formula, the reduced function.
</p>
</td></tr>
<tr><td><code id="IVProbitRob_+3A_outcome">outcome</code></td>
<td>

<p>formula, the outcome function.
</p>
</td></tr>
<tr><td><code id="IVProbitRob_+3A_data">data</code></td>
<td>

<p>an optional data fram containing the varaibles in the model. If not found in data, the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>IVProbitRob</code> is called.
</p>
</td></tr>
<tr><td><code id="IVProbitRob_+3A_control">control</code></td>
<td>

<p>a list of parameters for controlling the fitting process.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compute robust two-step estimates of the endogenous probit model.
</p>


<h3>Value</h3>

<p>Object of class &quot;epmrob&quot;.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Andre Bik, Andrea Naghi
</p>


<h3>References</h3>

<p>Naghi, A. A., Varadi, M., &amp; Zhelonkin, M. (2022). Robust Estimation of Probit Models with Endogeneity. <em>Econometrics and Statistics</em>. <a href="https://doi.org/10.1016/j.ecosta.2022.05.001">doi:10.1016/j.ecosta.2022.05.001</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+epmrob">epmrob</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(mvtnorm)
N &lt;- 2000
M &lt;- 500
cont.frac = 0.01
rho = 0.5
sigma = matrix(c(1, rho, rho, 1), 2, 2)
gamma1 = 1
gamma2 = c(0.6, 0.4) 
alpha1 = c(0.5)
beta1 = 0.5

set.seed(123)
X1 = rnorm(N,0,1)
X2 = rnorm(N,0,1)
X3 = rnorm(N,0,1)
eps = rmvnorm(N, mean =rep(0,2), sigma = sigma)
Y1 = X1*gamma1 + X2*gamma2[1] + X3*gamma2[2]  + eps[,1]
Y2 = ifelse(X1*beta1 + Y1*alpha1 + eps[,2] &gt; 0, 1, 0)

dat.exmpl &lt;- data.frame(Y2, Y1, X1, X2, X3)
names(dat.exmpl) &lt;- c("int", "endo", "exo", "ivrbl", "ivrbl2")
ivp.fit &lt;- IVProbitRob(endo ~ exo + ivrbl + ivrbl2, int ~ endo + exo, data = dat.exmpl, 
                       control = rob.control(weights.x1 = "hat", weights.x2 = "hat"))
ivp.fit
</code></pre>

<hr>
<h2 id='print.epmrob'>
Print a <code>epmrob</code> object
</h2><span id='topic+print.epmrob'></span>

<h3>Description</h3>

<p>Print an object generated by <code><a href="#topic+epmrob">epmrob</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'epmrob'
print(x, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.epmrob_+3A_x">x</code></td>
<td>

<p>object of <code>epmrob</code> class.
</p>
</td></tr>
<tr><td><code id="print.epmrob_+3A_digits">digits</code></td>
<td>

<p>number of significant digits to be printed.
</p>
</td></tr>
<tr><td><code id="print.epmrob_+3A_...">...</code></td>
<td>

<p>currently not used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Andre Bik, Andrea Naghi
</p>


<h3>See Also</h3>

<p><code><a href="#topic+epmrob">epmrob</a></code>
</p>

<hr>
<h2 id='print.summary.epmrob'>
Print Function for <code>summary.epmrob</code>
</h2><span id='topic+print.summary.epmrob'></span>

<h3>Description</h3>

<p>Print a <code><a href="#topic+summary.epmrob">summary.epmrob</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.epmrob'
print(x, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.epmrob_+3A_x">x</code></td>
<td>

<p>object of class <code>summary.epmrob</code> returned by a summary function.
</p>
</td></tr>
<tr><td><code id="print.summary.epmrob_+3A_digits">digits</code></td>
<td>

<p>number of nonzero digits after comma.
</p>
</td></tr>
<tr><td><code id="print.summary.epmrob_+3A_...">...</code></td>
<td>

<p>currently not used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Andre Bik, Andrea Naghi
</p>

<hr>
<h2 id='rob.control'>
Auxiliary for Controlling Robust Fitting
</h2><span id='topic+rob.control'></span>

<h3>Description</h3>

<p>Auxiliary function used for fitting the endogenous probit models. Contains control sequences, tuning constants and robustness weight functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rob.control(acc = 1e-04, maxit = 50, weights.x1 = c("none", "hat", "robCov", "covMcd"),
        weights.x2 = c("none", "hat", "robCov", "covMcd"), clevel1 = 0.95, tcc = 1.345)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rob.control_+3A_acc">acc</code></td>
<td>

<p>positive convergence level.
</p>
</td></tr>
<tr><td><code id="rob.control_+3A_maxit">maxit</code></td>
<td>

<p>integer giving the maximum number of iterations.
</p>
</td></tr>
<tr><td><code id="rob.control_+3A_weights.x1">weights.x1</code></td>
<td>

<p>vector of robustness weights controlling for the leverage effect in the reduced equation.
</p>
</td></tr>
<tr><td><code id="rob.control_+3A_weights.x2">weights.x2</code></td>
<td>

<p>vector of robustness weights controlling for the leverage effect in the outcome equation.
</p>
</td></tr>
<tr><td><code id="rob.control_+3A_clevel1">clevel1</code></td>
<td>

<p>value for the critical level for the first stage.
</p>
</td></tr>
<tr><td><code id="rob.control_+3A_tcc">tcc</code></td>
<td>

<p>tuning constant c for Huber's psi-function for the first, reduced, stage.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the arguments as components.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Andre Bik, Andrea Naghi
</p>

<hr>
<h2 id='summary.epmrob'>
Summarizing Robust Fits of Endogenous Probit Models
</h2><span id='topic+summary.epmrob'></span>

<h3>Description</h3>

<p>Summarizes robust fit of endogenous probit models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'epmrob'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.epmrob_+3A_object">object</code></td>
<td>

<p>object of class &quot;<code><a href="#topic+epmrob">epmrob</a></code>&quot;.
</p>
</td></tr>
<tr><td><code id="summary.epmrob_+3A_...">...</code></td>
<td>

<p>currently not used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class &quot;<code>summary.epmrob</code>&quot;.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Andre Bik, Andrea Naghi
</p>


<h3>See Also</h3>

<p><code><a href="#topic+epmrob">epmrob</a></code>
</p>

<hr>
<h2 id='xweights'>
Robustness Weights
</h2><span id='topic+xweights'></span>

<h3>Description</h3>

<p>Auxiliary function. Computation of the leverage weights based on robust Mahalanobis distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xweights(X, weight, clevel1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xweights_+3A_x">X</code></td>
<td>

<p>matrix of explanatory variables.
</p>
</td></tr>
<tr><td><code id="xweights_+3A_weight">weight</code></td>
<td>

<p>method used to calculated the weighting.
</p>
</td></tr>
<tr><td><code id="xweights_+3A_clevel1">clevel1</code></td>
<td>

<p>the critical level used for calculating the Mahalanobis distance.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of weights.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Andre Bik, Andrea Naghi
</p>


<h3>See Also</h3>

<p><code><a href="MASS.html#topic+cov.rob">cov.rob</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
