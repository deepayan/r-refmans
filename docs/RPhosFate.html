<!DOCTYPE html><html lang="en-GB"><head><title>Help for package RPhosFate</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RPhosFate}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#autoCalibrate+2CRPhosFate-method'><p>One dimensional automatic model calibration</p></a></li>
<li><a href='#autoCalibrate2+2CRPhosFate-method'><p>Two dimensional automatic model calibration</p></a></li>
<li><a href='#calibrationQuality+2CRPhosFate-method'><p>Calibration quality</p></a></li>
<li><a href='#demoProject'><p>Demonstration project</p></a></li>
<li><a href='#DEMrelatedInput'><p>DEM related input</p></a></li>
<li><a href='#emission+2CRPhosFate-method'><p>Emission</p></a></li>
<li><a href='#erosion+2CRPhosFate-method'><p>Erosion</p></a></li>
<li><a href='#erosionPrerequisites+2CRPhosFate-method'><p>Erosion prerequisites</p></a></li>
<li><a href='#firstRun+2CRPhosFate-method'><p>First run</p></a></li>
<li><a href='#getLayer+2CRPhosFate-method'><p>Get layer</p></a></li>
<li><a href='#getParameter+2CRPhosFate-method'><p>Get parameter(s)</p></a></li>
<li><a href='#RPhosFate'><p>Initialise project</p></a></li>
<li><a href='#RPhosFate-class'><p>RPhosFate class</p></a></li>
<li><a href='#saveState+2CRPhosFate-method'><p>Save state</p></a></li>
<li><a href='#setParameter+2CRPhosFate-method'><p>Set parameter(s)</p></a></li>
<li><a href='#snapGauges+2CRPhosFate-method'><p>Snap gauge(s)</p></a></li>
<li><a href='#subsequentRun+2CRPhosFate-method'><p>Subsequent run</p></a></li>
<li><a href='#transport+2CRPhosFate-method'><p>Transport</p></a></li>
<li><a href='#transportCalcOrder+2CRPhosFate-method'><p>Transport calculation order</p></a></li>
<li><a href='#transportPrerequisites+2CRPhosFate-method'><p>Transport prerequisites</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Soil and Chemical Substance Emission and Transport Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Description:</td>
<td>An enhanced version of the semi-empirical, spatially distributed
    emission and transport model PhosFate implemented in 'R' and 'C++'. It
    currently supports suspended solids (SS) and particulate phosphorus (PP). A
    major feature is the allocation of substance loads entering surface waters
    to their sources of origin, which is a basic requirement for the
    identification of critical source areas and in consequence a cost-effective
    implementation of mitigation measures. References: Hepp et al. (2022)
    &lt;<a href="https://doi.org/10.1016%2Fj.jenvman.2022.114514">doi:10.1016/j.jenvman.2022.114514</a>&gt;; Hepp and Zessner (2019)
    &lt;<a href="https://doi.org/10.3390%2Fw11102161">doi:10.3390/w11102161</a>&gt;; Kovacs (2013)
    <a href="http://hdl.handle.net/20.500.12708/9468">http://hdl.handle.net/20.500.12708/9468</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/AGPL-3">AGPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gisler.github.io/RPhosFate/">https://gisler.github.io/RPhosFate/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/gisler/RPhosFate/issues">https://github.com/gisler/RPhosFate/issues</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate, graphics, methods, raster (&ge; 3.6.3), Rcpp,
spatstat.geom, stats, utils, yaml</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, sp, tinytest, whitebox (&ge; 2.0.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Collate:</td>
<td>'GOFmetrics.R' 'aaa.R' 'RPhosFate.R' 'RcppExports.R'
'assertives.R' 'deprecated.R' 'gettersSetters.R' 'input.R'
'interface.R' 'utils.R' 'zzz.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-07 17:49:29 UTC; ghepp</td>
</tr>
<tr>
<td>Author:</td>
<td>Gerold Hepp [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gerold Hepp &lt;gisler@hepp.cc&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-07 18:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='autoCalibrate+2CRPhosFate-method'>One dimensional automatic model calibration</h2><span id='topic+autoCalibrate+2CRPhosFate-method'></span><span id='topic+autoCalibrate'></span>

<h3>Description</h3>

<p>Automatically calibrates the model with the help of a combination of golden
section search and successive parabolic interpolation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RPhosFate'
autoCalibrate(
  x,
  substance,
  col,
  interval,
  metric,
  tol = min(interval) * 0.1,
  parameter = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="autoCalibrate+2B2CRPhosFate-method_+3A_x">x</code></td>
<td>
<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.</p>
</td></tr>
<tr><td><code id="autoCalibrate+2B2CRPhosFate-method_+3A_substance">substance</code></td>
<td>
<p>A character string specifying the substance to calculate.</p>
</td></tr>
<tr><td><code id="autoCalibrate+2B2CRPhosFate-method_+3A_col">col</code></td>
<td>
<p>A character string specifying the calibration data column with the
respective substance river loads.</p>
</td></tr>
<tr><td><code id="autoCalibrate+2B2CRPhosFate-method_+3A_interval">interval</code></td>
<td>
<p>A numeric vector specifying the end-points of the interval to
be searched.</p>
</td></tr>
<tr><td><code id="autoCalibrate+2B2CRPhosFate-method_+3A_metric">metric</code></td>
<td>
<p>A character string specifying the metric to optimise. See
<code><a href="#topic+calibrationQuality">calibrationQuality</a></code> for available metrics.</p>
</td></tr>
<tr><td><code id="autoCalibrate+2B2CRPhosFate-method_+3A_tol">tol</code></td>
<td>
<p>A numeric scalar specifying the desired accuracy of the parameter
used for optimisation (not the metric).</p>
</td></tr>
<tr><td><code id="autoCalibrate+2B2CRPhosFate-method_+3A_parameter">parameter</code></td>
<td>
<p>By default, SS are calibrated utilising the overland
deposition rate and all other substances are calibrated utilising their
respective enrichment ratio. This argument can be used to specify a
dedicated parameter utilised for calibration via a character string:
<code>"ns_dep_ovl"</code> for overland or <code>"ns_dep_cha"</code> for channel deposition rate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object and side effects in
the form of raster files.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+snapGauges">snapGauges</a></code>, <code><a href="stats.html#topic+optimize">optimize</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# temporary demonstration project copy
cv_dir &lt;- demoProject()
# load temporary demonstration project
x &lt;- RPhosFate(
  cv_dir = cv_dir,
  ls_ini = TRUE
)
# presupposed method calls
x &lt;- firstRun(x, "SS")
x &lt;- snapGauges(x)

x &lt;- autoCalibrate(
  x,
  "SS",
  col = "SS_load",
  interval = c(10e-4, 20e-4),
  metric = "NSE"
)

</code></pre>

<hr>
<h2 id='autoCalibrate2+2CRPhosFate-method'>Two dimensional automatic model calibration</h2><span id='topic+autoCalibrate2+2CRPhosFate-method'></span><span id='topic+autoCalibrate2'></span>

<h3>Description</h3>

<p>Automatically calibrates the model with the help of a general-purpose
optimisation function. In contrast to <code><a href="#topic+autoCalibrate">autoCalibrate</a></code>, this method always
utilises the overland and channel deposition rate at the same time and never
the respective enrichment ratio for calibration. Beware of local optima and
parameters approximately within the convergence tolerance of interval
end-points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RPhosFate'
autoCalibrate2(
  x,
  substance,
  col,
  metric,
  method = "Nelder-Mead",
  lower = 0,
  upper = 0.1,
  control = list(fnscale = if (metric %in% c("NSE", "mNSE", "KGE")) -1 else 1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="autoCalibrate2+2B2CRPhosFate-method_+3A_x">x</code></td>
<td>
<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.</p>
</td></tr>
<tr><td><code id="autoCalibrate2+2B2CRPhosFate-method_+3A_substance">substance</code></td>
<td>
<p>A character string specifying the substance to calculate.</p>
</td></tr>
<tr><td><code id="autoCalibrate2+2B2CRPhosFate-method_+3A_col">col</code></td>
<td>
<p>A character string specifying the calibration data column with the
respective substance river loads.</p>
</td></tr>
<tr><td><code id="autoCalibrate2+2B2CRPhosFate-method_+3A_metric">metric</code></td>
<td>
<p>A character string specifying the metric to optimise. See
<code><a href="#topic+calibrationQuality">calibrationQuality</a></code> for available metrics.</p>
</td></tr>
<tr><td><code id="autoCalibrate2+2B2CRPhosFate-method_+3A_method">method</code></td>
<td>
<p>A character string specifying the utilised optimisation method.
See <code><a href="stats.html#topic+optim">optim</a></code> for further information (use <code><a href="#topic+autoCalibrate">autoCalibrate</a></code> instead of
method <code>"Brent"</code>).</p>
</td></tr>
<tr><td><code id="autoCalibrate2+2B2CRPhosFate-method_+3A_lower">lower</code></td>
<td>
<p>A numeric scalar or vector specifying the lower end-point(s) of
the interval(s) to be searched.</p>
</td></tr>
<tr><td><code id="autoCalibrate2+2B2CRPhosFate-method_+3A_upper">upper</code></td>
<td>
<p>A numeric scalar or vector specifying the upper end-point(s) of
the interval(s) to be searched.</p>
</td></tr>
<tr><td><code id="autoCalibrate2+2B2CRPhosFate-method_+3A_control">control</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code> of control parameters passed on to <code><a href="stats.html#topic+optim">optim</a></code>. See
<code><a href="stats.html#topic+optim">optim</a></code> for further information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object and side effects in
the form of raster files.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+snapGauges">snapGauges</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# temporary demonstration project copy
cv_dir &lt;- demoProject()
# load temporary demonstration project
x &lt;- RPhosFate(
  cv_dir = cv_dir,
  ls_ini = TRUE
)
# presupposed method calls
x &lt;- firstRun(x, "SS")
x &lt;- snapGauges(x)

x &lt;- autoCalibrate2(
  x,
  "SS",
  col = "SS_load",
  metric = "NSE",
  method = "L-BFGS-B",
  lower = c(10e-4, 0),
  upper = c(20e-4, 20e-4),
  control = list(fnscale = -1, parscale = c(1e-3, 1e-3), factr = 1e12)
)

</code></pre>

<hr>
<h2 id='calibrationQuality+2CRPhosFate-method'>Calibration quality</h2><span id='topic+calibrationQuality+2CRPhosFate-method'></span><span id='topic+calibrationQuality'></span>

<h3>Description</h3>

<p>Assesses the model's calibration quality with the help of the pairwise
complete modelled as well as observed loads and the following metrics:
</p>

<ul>
<li> <p><em>NSE:</em> Nash-Sutcliffe Efficiency
</p>
</li>
<li> <p><em>mNSE:</em> Modified Nash-Sutcliffe Efficiency (<code>j = 1</code>)
</p>
</li>
<li> <p><em>KGE:</em> Modified Kling-Gupta Efficiency
</p>
</li>
<li> <p><em>RMSE:</em> Root Mean Square Error
</p>
</li>
<li> <p><em>PBIAS:</em> Percent Bias
</p>
</li>
<li> <p><em>RSR:</em> Ratio of the RMSE to the standard deviation of the observations
</p>
</li>
<li> <p><em>RCV:</em> Ratio of the coefficients of variation
</p>
</li>
<li> <p><em>GMRAE:</em> Geometric Mean Relative Absolute Error
</p>
</li>
<li> <p><em>MdRAE:</em> Median Relative Absolute Error
</p>
</li></ul>

<p>In addition, a scatter plot with the observed river loads on the x- and the
modelled river loads on the y-axis is displayed and provides a visual
impression of the model performance. Other elements of this plot are an
identity line (solid) and plus/minus 30% deviation lines (dashed).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RPhosFate'
calibrationQuality(x, substance, col)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calibrationQuality+2B2CRPhosFate-method_+3A_x">x</code></td>
<td>
<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.</p>
</td></tr>
<tr><td><code id="calibrationQuality+2B2CRPhosFate-method_+3A_substance">substance</code></td>
<td>
<p>A character string specifying the substance to calculate.</p>
</td></tr>
<tr><td><code id="calibrationQuality+2B2CRPhosFate-method_+3A_col">col</code></td>
<td>
<p>A character string specifying the calibration data column with the
respective substance river loads.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named numeric vector containing the assessed metrics along with the
in-channel retention ratio (one minus sum of <em>xxt</em> at catchment outlet(s)
divided by sum of <em>xxt_inp</em>).
</p>


<h3>References</h3>

<p><cite>Nash, J.E., Sutcliffe, J.V., 1970. River flow forecasting through
conceptual models part I – a discussion of principles. Journal of Hydrology
10, 282–290. https://doi.org/10.1016/0022-1694(70)90255-6</cite>
</p>
<p><cite>Legates, D.R., McCabe Jr., G.J., 1999. Evaluating the use of
“goodness-of-fit” measures in hydrologic and hydroclimatic model validation.
Water Resources Research 35, 233–241. https://doi.org/10.1029/1998WR900018</cite>
</p>
<p><cite>Kling, H., Fuchs, M., Paulin, M., 2012. Runoff conditions in the upper
Danube basin under an ensemble of climate change scenarios. Journal of
Hydrology 424–425, 264–277. https://doi.org/10.1016/j.jhydrol.2012.01.011</cite>
</p>
<p><cite>Moriasi, D.N., Arnold, J.G., Van Liew, M.W., Bingner, R.L., Harmel,
R.D., Veith, T.L., 2007. Model evaluation guidelines for systematic
quantification of accuracy in watershed simulations. Transactions of the
ASABE 50, 885–900.</cite>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+snapGauges">snapGauges</a></code>, <code><a href="#topic+autoCalibrate">autoCalibrate</a></code>, <code><a href="#topic+autoCalibrate2">autoCalibrate2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# temporary demonstration project copy
cv_dir &lt;- demoProject()
# load temporary demonstration project
x &lt;- RPhosFate(
  cv_dir = cv_dir,
  ls_ini = TRUE
)
# presupposed method calls
x &lt;- firstRun(x, "SS")
x &lt;- snapGauges(x)

calibrationQuality(x, "SS", "SS_load")

</code></pre>

<hr>
<h2 id='demoProject'>Demonstration project</h2><span id='topic+demoProject'></span>

<h3>Description</h3>

<p>Copies a demonstration project to an existing or a temporary directory.
</p>
<p>The demonstration project data are a derivative of the
</p>

<ul>
<li> <p><em><a href="https://www.data.gv.at/katalog/dataset/d88a1246-9684-480b-a480-ff63286b35b7">Geoland.at</a></em> (digital elevation model),
</p>
</li>
<li> <p><em><a href="https://www.data.gv.at/katalog/dataset/35e36014-ec69-439b-8629-389f52ffaa92">AMA</a></em> (field data),
</p>
</li>
<li> <p><em><a href="https://www.data.gv.at/katalog/dataset/c2287ccb-f44c-48cd-bf7c-ac107b771246">BMLRT</a></em> (channel data) and
</p>
</li>
<li> <p><em><a href="https://www.data.gv.at/katalog/dataset/3fefc838-791d-4dde-975b-a4131a54e7c5">GIP.at</a></em> (road data)
</p>
</li></ul>

<p>data sets, used and licensed under <em><a href="https://creativecommons.org/licenses/by/4.0/">(CC BY 4.0)</a></em> by Gerold Hepp.
</p>
<p>While the data represent a real catchment <em><a href="https://hoal.hydrology.at/">(HOAL)</a>,</em> some of them are fictitious, but plausible. These are, among others, R- and C-factors, soil and related data, existence of subsurface drainage at road embankments as well as substance river loads.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>demoProject(cs_dir = tempdir(TRUE))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="demoProject_+3A_cs_dir">cs_dir</code></td>
<td>
<p>An optional character string specifying an existing directory.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string containing the demonstration project root
directory.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+RPhosFate">RPhosFate</a></code>, <code><a href="#topic+catchment">catchment</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
demoProject()

</code></pre>

<hr>
<h2 id='DEMrelatedInput'>DEM related input</h2><span id='topic+DEMrelatedInput'></span>

<h3>Description</h3>

<p>Clips, pre-processes and calculates or determines all input data related to
the digital elevation model (DEM) in the broader sense: <em>acc, acc_wtd,
cha, dem, dir, rds, slp,</em> and <em>wsh.</em>
</p>
<p>Requires <em><a href="https://hydrology.usu.edu/taudem/taudem5/downloads.html">TauDEM</a></em>
5.3.7 and the
<em><a href="https://www.whiteboxgeo.com/download-whiteboxtools/">WhiteboxTools</a></em> binary
(<code><a href="whitebox.html#topic+install_whitebox">whitebox::install_whitebox</a></code>) to be installed on your computer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DEMrelatedInput(
  cv_dir,
  cs_dem,
  cs_cha,
  sp_msk,
  sp_olp,
  sp_sds,
  cs_rds = NULL,
  cs_wgs = NULL,
  cs_dir = NULL,
  ns_brn = 50,
  is_adj = 1L,
  is_ths = 1L,
  ls_tmp = FALSE,
  cs_fex = c("tif", "img")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DEMrelatedInput_+3A_cv_dir">cv_dir</code></td>
<td>
<p>A character vector specifying the desired project root
directory (first position).</p>
</td></tr>
<tr><td><code id="DEMrelatedInput_+3A_cs_dem">cs_dem</code></td>
<td>
<p>A character string specifying a path to a potentially large
raster digital elevation model.</p>
</td></tr>
<tr><td><code id="DEMrelatedInput_+3A_cs_cha">cs_cha</code></td>
<td>
<p>A character string specifying a path to a potentially large
raster providing channels.</p>
</td></tr>
<tr><td><code id="DEMrelatedInput_+3A_sp_msk">sp_msk</code></td>
<td>
<p>An <code><a href="sp.html#topic+SpatialPolygonsDataFrame-class">sp::SpatialPolygonsDataFrame</a></code> providing a somewhat
oversized catchment mask used to clip the potentially large input rasters
for further processing.</p>
</td></tr>
<tr><td><code id="DEMrelatedInput_+3A_sp_olp">sp_olp</code></td>
<td>
<p>An <code><a href="sp.html#topic+SpatialPointsDataFrame-class">sp::SpatialPointsDataFrame</a></code> providing the desired
catchment outlet(s).</p>
</td></tr>
<tr><td><code id="DEMrelatedInput_+3A_sp_sds">sp_sds</code></td>
<td>
<p>An <code><a href="sp.html#topic+SpatialPointsDataFrame-class">sp::SpatialPointsDataFrame</a></code> providing channel
sources.</p>
</td></tr>
<tr><td><code id="DEMrelatedInput_+3A_cs_rds">cs_rds</code></td>
<td>
<p>An optional character string specifying a path to a potentially
large raster providing roads.</p>
</td></tr>
<tr><td><code id="DEMrelatedInput_+3A_cs_wgs">cs_wgs</code></td>
<td>
<p>An optional character string specifying a path to a potentially
large raster providing flow accumulation weights.</p>
</td></tr>
<tr><td><code id="DEMrelatedInput_+3A_cs_dir">cs_dir</code></td>
<td>
<p>An optional character string specifying a path to a potentially
large raster providing D8 flow directions using <em>ArcGIS</em> codes.</p>
</td></tr>
<tr><td><code id="DEMrelatedInput_+3A_ns_brn">ns_brn</code></td>
<td>
<p>A numeric scalar specifying the stream burning step size in m.</p>
</td></tr>
<tr><td><code id="DEMrelatedInput_+3A_is_adj">is_adj</code></td>
<td>
<p>A numeric scalar specifying how many cells adjacent to channels
shall be burnt.</p>
</td></tr>
<tr><td><code id="DEMrelatedInput_+3A_is_ths">is_ths</code></td>
<td>
<p>An integer scalar specifying the number of threads to use
during computation (no effect in case <em>OpenMP</em> is not supported by the
toolchain and/or platform).</p>
</td></tr>
<tr><td><code id="DEMrelatedInput_+3A_ls_tmp">ls_tmp</code></td>
<td>
<p>A logical scalar specifying if the temporary files created
during computation shall be kept.</p>
</td></tr>
<tr><td><code id="DEMrelatedInput_+3A_cs_fex">cs_fex</code></td>
<td>
<p>A character string specifying the file extension of the created
raster files (either the default <code>"tif"</code> or <code>"img"</code> for backward
compatibility).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function applies the following (pre-processing) steps to ensure
hydrologic consistency of the generated input data:
</p>

<ul>
<li><p> Stream burning and orientation of cells adjacent to channel cells
approximately into the direction of channel cells (no effect with <code>ns_brn = 0</code>).
</p>
</li>
<li><p> Depression breaching.
</p>
</li>
<li><p> Tracing of downslope flowpaths from the provided channel sources.
</p>
</li></ul>

<p>When roads are provided, they are considered as flow obstacles breaking the
continuity of the calculated flow accumulations.
</p>
<p>In case no flow accumulation weights are provided, <em>acc</em> and <em>acc_wtd</em>
are identical.
</p>
<p>Providing existing flow directions prevents calculating them, which, for
example, may be useful in case the effect of tillage directions has been
enforced on topographic flow directions in advance. Please note that doing so
renders stream burning and depression breaching without effect.
</p>
<p><em>dem</em> represents the breached DEM with reversed stream burning if applicable.
This processed DEM also serves as the basis for the calculation of the D8
slopes provided by <em>slp.</em>
</p>


<h3>Value</h3>

<p>A two column numeric <code><a href="base.html#topic+matrix">matrix</a></code> specifying one or more catchment
outlet coordinates and side effects in the form of raster files.
</p>


<h3>References</h3>

<p><cite>Lindsay, J.B., 2016. Efficient hybrid breaching-filling sink removal
methods for flow path enforcement in digital elevation models. Hydrological
Processes 30, 846–857.</cite>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+RPhosFate">RPhosFate</a></code>, <code><a href="#topic+catchment">catchment</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# obtain temporary project root directory
cv_dir &lt;- normalizePath(
  tempfile("cmt"),
  winslash = .Platform$file.sep,
  mustWork = FALSE
)
# obtain directory holding "large" rasters and other required data sets
cs_dir_lrg &lt;- system.file("tinytest", "largeData", package = "RPhosFate")

nm_olc &lt;- DEMrelatedInput(
  cv_dir = cv_dir,
  cs_dem = file.path(cs_dir_lrg, "dem_lrg.tif"),
  cs_cha = file.path(cs_dir_lrg, "cha_lrg.tif"),
  sp_msk = raster::shapefile(file.path(cs_dir_lrg, "msk.shp")),
  sp_olp = raster::shapefile(file.path(cs_dir_lrg, "olp.shp")),
  sp_sds = raster::shapefile(file.path(cs_dir_lrg, "sds.shp")),
  cs_rds = file.path(cs_dir_lrg, "rds_lrg.tif"),
  cs_wgs = file.path(cs_dir_lrg, "wgs_lrg.tif"),
  ls_tmp = TRUE
)
## End(Not run)

</code></pre>

<hr>
<h2 id='emission+2CRPhosFate-method'>Emission</h2><span id='topic+emission+2CRPhosFate-method'></span><span id='topic+emission'></span>

<h3>Description</h3>

<p>Calculates and writes substance emissions to disk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RPhosFate'
emission(x, substance = "PP")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="emission+2B2CRPhosFate-method_+3A_x">x</code></td>
<td>
<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.</p>
</td></tr>
<tr><td><code id="emission+2B2CRPhosFate-method_+3A_substance">substance</code></td>
<td>
<p>A character string specifying the substance to calculate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object and side effects in
the form of raster files.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+firstRun">firstRun</a></code>, <code><a href="#topic+subsequentRun">subsequentRun</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# temporary demonstration project copy
cv_dir &lt;- demoProject()
# load temporary demonstration project
x &lt;- RPhosFate(
  cv_dir = cv_dir,
  ls_ini = TRUE
)
# presupposed method calls
x &lt;- erosionPrerequisites(x)
x &lt;- erosion(x)

x &lt;- emission(x, "PP")

</code></pre>

<hr>
<h2 id='erosion+2CRPhosFate-method'>Erosion</h2><span id='topic+erosion+2CRPhosFate-method'></span><span id='topic+erosion'></span>

<h3>Description</h3>

<p>Calculates and writes (R)USLE erosion to disk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RPhosFate'
erosion(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="erosion+2B2CRPhosFate-method_+3A_x">x</code></td>
<td>
<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object and side effects in
the form of raster files.
</p>


<h3>References</h3>

<p><cite>Renard, K.G., Foster, G.R., Weesies, G.A., McCool, D.K., Yoder, D.C.,
1997. Predicting soil erosion by water: a guide to conservation planning with
the Revised Universal Soil Loss Equation (RUSLE), Agriculture Handbook. U.S.
Government Printing Office, Washington, DC.</cite>
</p>
<p><cite>Wischmeier, W.H., Smith, D.D., 1978. Predicting rainfall erosion
losses. A guide to conservation planning, Agriculture Handbook. U.S.
Government Printing Office, Washington, DC.</cite>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+firstRun">firstRun</a></code>, <code><a href="#topic+subsequentRun">subsequentRun</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# temporary demonstration project copy
cv_dir &lt;- demoProject()
# load temporary demonstration project
x &lt;- RPhosFate(
  cv_dir = cv_dir,
  ls_ini = TRUE
)
# presupposed method call
x &lt;- erosionPrerequisites(x)

x &lt;- erosion(x)

</code></pre>

<hr>
<h2 id='erosionPrerequisites+2CRPhosFate-method'>Erosion prerequisites</h2><span id='topic+erosionPrerequisites+2CRPhosFate-method'></span><span id='topic+erosionPrerequisites'></span>

<h3>Description</h3>

<p>Calculates and writes capped slopes, L- and RUSLE S-factors (equations for
summer conditions and slopes <code class="reqn">\geq</code> 15 ft) to disk. Weighted flow
accumulations less than one are set to one for the calculation of the
L-factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RPhosFate'
erosionPrerequisites(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="erosionPrerequisites+2B2CRPhosFate-method_+3A_x">x</code></td>
<td>
<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object and side effects in
the form of raster files.
</p>


<h3>References</h3>

<p><cite>Renard, K.G., Foster, G.R., Weesies, G.A., McCool, D.K., Yoder, D.C.,
1997. Predicting soil erosion by water: a guide to conservation planning with
the Revised Universal Soil Loss Equation (RUSLE), Agriculture Handbook. U.S.
Government Printing Office, Washington, DC.</cite>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+firstRun">firstRun</a></code>, <code><a href="#topic+subsequentRun">subsequentRun</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# temporary demonstration project copy
cv_dir &lt;- demoProject()
# load temporary demonstration project
x &lt;- RPhosFate(
  cv_dir = cv_dir,
  ls_ini = TRUE
)

x &lt;- erosionPrerequisites(x)

</code></pre>

<hr>
<h2 id='firstRun+2CRPhosFate-method'>First run</h2><span id='topic+firstRun+2CRPhosFate-method'></span><span id='topic+firstRun'></span>

<h3>Description</h3>

<p>Calls <code><a href="#topic+erosionPrerequisites">erosionPrerequisites</a></code>, <code><a href="#topic+erosion">erosion</a></code>, <code><a href="#topic+emission">emission</a></code>,
<code><a href="#topic+transportPrerequisites">transportPrerequisites</a></code>, <code><a href="#topic+transportCalcOrder">transportCalcOrder</a></code> and <code><a href="#topic+transport">transport</a></code> in the
mentioned order. While <code><a href="#topic+transport">transport</a></code> is called for the specified substance
only, <code><a href="#topic+emission">emission</a></code> is called for all substances whose top soil concentrations
have been provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RPhosFate'
firstRun(x, substance = "PP")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="firstRun+2B2CRPhosFate-method_+3A_x">x</code></td>
<td>
<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.</p>
</td></tr>
<tr><td><code id="firstRun+2B2CRPhosFate-method_+3A_substance">substance</code></td>
<td>
<p>A character string specifying the substance to calculate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object and side effects in
the form of raster files.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+subsequentRun">subsequentRun</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# temporary demonstration project copy
cv_dir &lt;- demoProject()
# load temporary demonstration project
x &lt;- RPhosFate(
  cv_dir = cv_dir,
  ls_ini = TRUE
)

x &lt;- firstRun(x, "SS")

</code></pre>

<hr>
<h2 id='getLayer+2CRPhosFate-method'>Get layer</h2><span id='topic+getLayer+2CRPhosFate-method'></span><span id='topic+getLayer'></span><span id='topic++5B+2CRPhosFate+2CANY+2CANY+2CANY-method'></span>

<h3>Description</h3>

<p>Obtains a project raster layer for further analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RPhosFate'
getLayer(x, i, j = NULL)

## S4 method for signature 'RPhosFate,ANY,ANY,ANY'
x[i, j]
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getLayer+2B2CRPhosFate-method_+3A_x">x</code></td>
<td>
<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.</p>
</td></tr>
<tr><td><code id="getLayer+2B2CRPhosFate-method_+3A_i">i</code></td>
<td>
<p>A character string specifying a layer name. Substance related layers
whose names start with <em>xx</em> are treated differently. They have to be
queried by their name (not filename), for example, <code>"xxc"</code> in combination
with <code>"PP"</code> in argument <code>j</code> queries the particulate phosphorus
concentrations in top soils. See subdirectory sections for further
information.</p>
</td></tr>
<tr><td><code id="getLayer+2B2CRPhosFate-method_+3A_j">j</code></td>
<td>
<p>A character string specifying a substance if applicable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="raster.html#topic+Raster-classes">raster::RasterLayer</a></code> object.
</p>


<h3><em>Input</em> subdirectory</h3>

<p>This directory holds all possible user input raster data (flow obstacles like
roads must be considered during generation of the flow accumulation layers
and also be cut out from them in order to be properly respected):
</p>

<ul>
<li> <p><em>acc:</em> Flow accumulations required for <code><a href="#topic+transportCalcOrder">transportCalcOrder</a></code>.
</p>
</li>
<li> <p><em>acc_wtd:</em> Weighted flow accumulations required for everything (can be
equal to <em>acc</em>).
</p>
</li>
<li> <p><em>CFa:</em> (R)USLE C-factors required for <code><a href="#topic+erosion">erosion</a></code>.
</p>
</li>
<li> <p><em>cha:</em> Channel cells required for everything (<code>1</code>: channel cell, <code>NA</code>: no
channel cell).
</p>
</li>
<li> <p><em>clc:</em> Clay contents of top soils in % required for substance
<code><a href="#topic+emission">emission</a></code>s.
</p>
</li>
<li> <p><em>dem:</em> Digital elevation model in m a.s.l. (optional).
</p>
</li>
<li> <p><em>dir:</em> D8 flow directions required for <code><a href="#topic+transportPrerequisites">transportPrerequisites</a></code> and
substance <code><a href="#topic+transport">transport</a></code>.
</p>
</li>
<li> <p><em>fid:</em> Field IDs (optional).
</p>
</li>
<li> <p><em>KFa:</em> (R)USLE K-factors required for <code><a href="#topic+erosion">erosion</a></code>.
</p>
</li>
<li> <p><em>lue:</em> Land use classes (optional).
</p>
</li>
<li> <p><em>man:</em> Manning's roughness coefficients required for substance
<code><a href="#topic+transport">transport</a></code>.
</p>
</li>
<li> <p><em>xxc:</em> Substance contents of top soils in mg/kg required for substance
<code><a href="#topic+emission">emission</a></code>s, for example, <em>ppc</em> for PP top soil contents.
</p>
</li>
<li> <p><em>rds:</em> Road cells required for <code><a href="#topic+transportPrerequisites">transportPrerequisites</a></code> (<code>0</code>: road cell
without subsurface drainage, <code>1</code>: road cell with subsurface drainage, <code>NA</code>:
no road cell).
</p>
</li>
<li> <p><em>RFa:</em> (R)USLE R-factors required for <code><a href="#topic+erosion">erosion</a></code>.
</p>
</li>
<li> <p><em>slp:</em> Slopes in % required for everything.
</p>
</li>
<li> <p><em>wsh:</em> Watershed (optional).
</p>
</li></ul>



<h3><em>Intermediate</em> subdirectory</h3>

<p>This directory holds intermediate calculations:
</p>

<ul>
<li> <p><em>inl:</em> Cells representing inlets at roads (storm drains).
</p>
</li>
<li> <p><em>LFa:</em> L-factors.
</p>
</li>
<li> <p><em>rhy:</em> Hydraulic radii in m.
</p>
</li>
<li> <p><em>rip:</em> Cells representing the riparian zones within channel cells.
</p>
</li>
<li> <p><em>SFa:</em> RUSLE S-factors.
</p>
</li>
<li> <p><em>slp_cap:</em> Capped slopes in %.
</p>
</li></ul>



<h3><em>Result</em> subdirectory</h3>

<p>This directory holds the model results:
</p>

<ul>
<li> <p><em>ero:</em> Erosion in t/cell/yr.
</p>
</li>
<li> <p><em>xxe:</em> Substance emissions in kg/cell/yr, for example, <em>ppe</em> for PP
emissions.
</p>
</li>
<li> <p><em>xxr:</em> Substance retentions in t/cell/yr (SS) or kg/cell/yr, for example,
<em>ppr</em> for PP retentions.
</p>
</li>
<li> <p><em>xxt:</em> Substance transports in t/cell/yr (SS) or kg/cell/yr, for example,
<em>ppt</em> for PP transports.
</p>
</li>
<li> <p><em>xxt_cld:</em> Substance cell loads in t/cell/yr (SS) or kg/cell/yr, for
example, <em>ppt_cld</em> for PP cell loads.
</p>
</li>
<li> <p><em>xxt_ctf:</em> Substance cell transfers in t/cell/yr (SS) or kg/cell/yr,
for example, <em>ppt_ctf</em> for PP transfers.
</p>
</li>
<li> <p><em>xxt_inp:</em> Substance inputs into surface waters in t/cell/yr (SS) or
kg/cell/yr, for example, <em>ppt_inp</em> for PP inputs into surface waters.
</p>
</li>
<li> <p><em>xxt_out:</em> Substance outlet loads of subsurface drainages in t/cell/yr
(SS) or kg/cell/yr, for example, <em>ppt_out</em> for PP outlet loads.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
# temporary demonstration project copy
cv_dir &lt;- demoProject()
# load temporary demonstration project
x &lt;- RPhosFate(
  cv_dir = cv_dir,
  ls_ini = TRUE
)
# presupposed method call
x &lt;- firstRun(x, "SS")

getLayer(x, "dir")
getLayer(x, "xxt", "SS")
getLayer(x, "xxe", "PP")

</code></pre>

<hr>
<h2 id='getParameter+2CRPhosFate-method'>Get parameter(s)</h2><span id='topic+getParameter+2CRPhosFate-method'></span><span id='topic+getParameter'></span>

<h3>Description</h3>

<p>Obtains a single model parameter or all model parameters at once.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RPhosFate'
getParameter(x, parameter = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getParameter+2B2CRPhosFate-method_+3A_x">x</code></td>
<td>
<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.</p>
</td></tr>
<tr><td><code id="getParameter+2B2CRPhosFate-method_+3A_parameter">parameter</code></td>
<td>
<p>A character string specifying a parameter name or <code>NULL</code> for
a <code><a href="base.html#topic+list">list</a></code> of all parameters. See model parameter arguments section for
further information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Depends on the queried parameter or a <code><a href="base.html#topic+list">list</a></code> in case of all
parameters. See model parameter arguments section for further information.
</p>


<h3>Model parameter arguments</h3>


<ul>
<li> <p><code>ns_slp_min</code>: A numeric scalar specifying the minimum bounding slope in %
(defaults to <code>0.001</code>).
</p>
</li>
<li> <p><code>ns_slp_max</code>: A numeric scalar specifying the maximum bounding slope in %
(defaults to <code>999.0</code>).
</p>
</li>
<li> <p><code>ns_rhy_a</code>: A numeric scalar specifying a network constant depending on the
discharge frequency needed for the calculation of the hydraulic radius, which
in turn is a prerequisite for substance transport (defaults to <code>0.09</code>
representing a discharge frequency of approximately six years).
</p>
</li>
<li> <p><code>ns_rhy_b</code>: A numeric scalar specifying a geometry scaling exponent
depending on the discharge frequency needed for the calculation of the
hydraulic radius, which in turn is a prerequisite for substance transport
(defaults to <code>0.50</code> representing a discharge frequency of approximately six
years).
</p>
</li>
<li> <p><code>ns_cha_rto</code>: A numeric scalar specifying the ratio of the channel to the
cell width determining the widths of the riparian zones required for
substance <code><a href="#topic+transport">transport</a></code> (defaults to <code>0.5</code>).
</p>
</li>
<li> <p><code>ns_man_rip</code>: A numeric scalar specifying Manning's roughness coefficient
of the riparian zones within channel cells required for substance
<code><a href="#topic+transport">transport</a></code> (defaults to <code>0.32</code>).
</p>
</li>
<li> <p><code>ns_man_cha</code>: A numeric scalar specifying Manning's roughness coefficient
of the channel within channel cells required for substance <code><a href="#topic+transport">transport</a></code>
(defaults to <code>0.04</code>).
</p>
</li>
<li> <p><code>ns_dep_ovl</code>: A numeric scalar specifying the overland deposition rate per
second required for substance <code><a href="#topic+transport">transport</a></code> (calibration parameter; no
default).
</p>
</li>
<li> <p><code>ns_dep_cha</code>: A numeric scalar specifying the channel deposition rate per
second required for substance <code><a href="#topic+transport">transport</a></code> (calibration parameter; no
default).
</p>
</li>
<li> <p><code>nv_tfc_inl</code>: A named numeric vector specifying the inlet transfer
coefficients required for substance <code><a href="#topic+transport">transport</a></code>, for example, <code>c(SS = 0.6, PP = 0.6)</code> (no default).
</p>
</li>
<li> <p><code>nv_enr_rto</code> A named numeric vector specifying the substance enrichment
ratios required for substance except SS <code><a href="#topic+transport">transport</a></code>, for example, <code>c(PP = 2.0)</code> (calibration parameter; no default).
</p>
</li>
<li> <p><code>iv_fDo</code>: An integer vector specifying the outflow direction vector
required for substance <code><a href="#topic+transport">transport</a></code> (defaults to <em>ArcGIS</em> codes).
</p>
</li>
<li> <p><code>nm_olc</code>: A two column numeric <code><a href="base.html#topic+matrix">matrix</a></code> specifying one or more catchment
outlet coordinates required for the in-channel retention ratio of
<code><a href="#topic+calibrationQuality">calibrationQuality</a></code> (no default).
</p>
</li>
<li> <p><code>df_cdt</code>: A <code><a href="base.html#topic+data.frame">data.frame</a></code> with calibration data, which must have at least
the following three columns and one or more columns with substance river
loads in t/yr (no default):
</p>

<ul>
<li> <p><em>ID:</em> ID(s) of the gauge(s)
</p>
</li>
<li> <p><em>x:</em> x-coordinate(s) of the gauge(s)
</p>
</li>
<li> <p><em>y:</em> y-coordinate(s) of the gauge(s)
</p>
</li></ul>

</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+setParameter">setParameter</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# temporary demonstration project copy
cv_dir &lt;- demoProject()
# load temporary demonstration project
x &lt;- RPhosFate(
  cv_dir = cv_dir,
  ls_ini = TRUE
)

getParameter(x)
getParameter(x, "ns_dep_ovl")

</code></pre>

<hr>
<h2 id='RPhosFate'>Initialise project</h2><span id='topic+RPhosFate'></span><span id='topic+catchment'></span>

<h3>Description</h3>

<p>Initialises a project from scratch or loads the state of an existing one
utilising <em>GeoTIFF</em> (*.tif) raster files from, by convention, the following
three project root subdirectories:
</p>

<ul>
<li> <p><em>Input</em>
</p>
</li>
<li> <p><em>Intermediate</em>
</p>
</li>
<li> <p><em>Result</em>
</p>
</li></ul>

<p>See subdirectory sections for further information.
</p>
<p><code>catchment</code> is an alias for <code>RPhosFate</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RPhosFate(...)

catchment(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RPhosFate_+3A_...">...</code></td>
<td>
<p>Arguments used to initialise the project. See argument sections
for further information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.
</p>


<h3><em>Input</em> subdirectory</h3>

<p>This directory holds all possible user input raster data (flow obstacles like
roads must be considered during generation of the flow accumulation layers
and also be cut out from them in order to be properly respected):
</p>

<ul>
<li> <p><em>acc:</em> Flow accumulations required for <code><a href="#topic+transportCalcOrder">transportCalcOrder</a></code>.
</p>
</li>
<li> <p><em>acc_wtd:</em> Weighted flow accumulations required for everything (can be
equal to <em>acc</em>).
</p>
</li>
<li> <p><em>CFa:</em> (R)USLE C-factors required for <code><a href="#topic+erosion">erosion</a></code>.
</p>
</li>
<li> <p><em>cha:</em> Channel cells required for everything (<code>1</code>: channel cell, <code>NA</code>: no
channel cell).
</p>
</li>
<li> <p><em>clc:</em> Clay contents of top soils in % required for substance
<code><a href="#topic+emission">emission</a></code>s.
</p>
</li>
<li> <p><em>dem:</em> Digital elevation model in m a.s.l. (optional).
</p>
</li>
<li> <p><em>dir:</em> D8 flow directions required for <code><a href="#topic+transportPrerequisites">transportPrerequisites</a></code> and
substance <code><a href="#topic+transport">transport</a></code>.
</p>
</li>
<li> <p><em>fid:</em> Field IDs (optional).
</p>
</li>
<li> <p><em>KFa:</em> (R)USLE K-factors required for <code><a href="#topic+erosion">erosion</a></code>.
</p>
</li>
<li> <p><em>lue:</em> Land use classes (optional).
</p>
</li>
<li> <p><em>man:</em> Manning's roughness coefficients required for substance
<code><a href="#topic+transport">transport</a></code>.
</p>
</li>
<li> <p><em>xxc:</em> Substance contents of top soils in mg/kg required for substance
<code><a href="#topic+emission">emission</a></code>s, for example, <em>ppc</em> for PP top soil contents.
</p>
</li>
<li> <p><em>rds:</em> Road cells required for <code><a href="#topic+transportPrerequisites">transportPrerequisites</a></code> (<code>0</code>: road cell
without subsurface drainage, <code>1</code>: road cell with subsurface drainage, <code>NA</code>:
no road cell).
</p>
</li>
<li> <p><em>RFa:</em> (R)USLE R-factors required for <code><a href="#topic+erosion">erosion</a></code>.
</p>
</li>
<li> <p><em>slp:</em> Slopes in % required for everything.
</p>
</li>
<li> <p><em>wsh:</em> Watershed (optional).
</p>
</li></ul>



<h3><em>Intermediate</em> subdirectory</h3>

<p>This directory holds intermediate calculations:
</p>

<ul>
<li> <p><em>inl:</em> Cells representing inlets at roads (storm drains).
</p>
</li>
<li> <p><em>LFa:</em> L-factors.
</p>
</li>
<li> <p><em>rhy:</em> Hydraulic radii in m.
</p>
</li>
<li> <p><em>rip:</em> Cells representing the riparian zones within channel cells.
</p>
</li>
<li> <p><em>SFa:</em> RUSLE S-factors.
</p>
</li>
<li> <p><em>slp_cap:</em> Capped slopes in %.
</p>
</li></ul>



<h3><em>Result</em> subdirectory</h3>

<p>This directory holds the model results:
</p>

<ul>
<li> <p><em>ero:</em> Erosion in t/cell/yr.
</p>
</li>
<li> <p><em>xxe:</em> Substance emissions in kg/cell/yr, for example, <em>ppe</em> for PP
emissions.
</p>
</li>
<li> <p><em>xxr:</em> Substance retentions in t/cell/yr (SS) or kg/cell/yr, for example,
<em>ppr</em> for PP retentions.
</p>
</li>
<li> <p><em>xxt:</em> Substance transports in t/cell/yr (SS) or kg/cell/yr, for example,
<em>ppt</em> for PP transports.
</p>
</li>
<li> <p><em>xxt_cld:</em> Substance cell loads in t/cell/yr (SS) or kg/cell/yr, for
example, <em>ppt_cld</em> for PP cell loads.
</p>
</li>
<li> <p><em>xxt_ctf:</em> Substance cell transfers in t/cell/yr (SS) or kg/cell/yr,
for example, <em>ppt_ctf</em> for PP transfers.
</p>
</li>
<li> <p><em>xxt_inp:</em> Substance inputs into surface waters in t/cell/yr (SS) or
kg/cell/yr, for example, <em>ppt_inp</em> for PP inputs into surface waters.
</p>
</li>
<li> <p><em>xxt_out:</em> Substance outlet loads of subsurface drainages in t/cell/yr
(SS) or kg/cell/yr, for example, <em>ppt_out</em> for PP outlet loads.
</p>
</li></ul>



<h3>Data management arguments</h3>


<ul>
<li> <p><code>cv_dir</code>: A character vector specifying the project root (first position)
and optionally the Monte Carlo input data directory (second position).
</p>
</li>
<li> <p><code>ls_ini</code>: A logical scalar specifying if the state of an existing project
shall be loaded from disk (defaults to <code>FALSE</code>). Parameters or substance
parameter values specified via the <code>...</code> argument take precedence over loaded
ones.
</p>
</li>
<li> <p><code>is_MCi</code>: An integer scalar specifying the current Monte Carlo iteration if
applicable (defaults to <code>integer()</code>, which means Monte Carlo simulation mode
is disabled).
</p>
</li>
<li> <p><code>cv_MCl</code>: A character vector specifying the names of the layers, which
shall be written to disk with the associated Monte Carlo iteration in their
filenames upon calling the appropriate methods (defaults to <code>"xxt"</code>; no
effect in case Monte Carlo simulation mode is disabled).
</p>
</li></ul>



<h3>Model parameter arguments</h3>


<ul>
<li> <p><code>ns_slp_min</code>: A numeric scalar specifying the minimum bounding slope in %
(defaults to <code>0.001</code>).
</p>
</li>
<li> <p><code>ns_slp_max</code>: A numeric scalar specifying the maximum bounding slope in %
(defaults to <code>999.0</code>).
</p>
</li>
<li> <p><code>ns_rhy_a</code>: A numeric scalar specifying a network constant depending on the
discharge frequency needed for the calculation of the hydraulic radius, which
in turn is a prerequisite for substance transport (defaults to <code>0.09</code>
representing a discharge frequency of approximately six years).
</p>
</li>
<li> <p><code>ns_rhy_b</code>: A numeric scalar specifying a geometry scaling exponent
depending on the discharge frequency needed for the calculation of the
hydraulic radius, which in turn is a prerequisite for substance transport
(defaults to <code>0.50</code> representing a discharge frequency of approximately six
years).
</p>
</li>
<li> <p><code>ns_cha_rto</code>: A numeric scalar specifying the ratio of the channel to the
cell width determining the widths of the riparian zones required for
substance <code><a href="#topic+transport">transport</a></code> (defaults to <code>0.5</code>).
</p>
</li>
<li> <p><code>ns_man_rip</code>: A numeric scalar specifying Manning's roughness coefficient
of the riparian zones within channel cells required for substance
<code><a href="#topic+transport">transport</a></code> (defaults to <code>0.32</code>).
</p>
</li>
<li> <p><code>ns_man_cha</code>: A numeric scalar specifying Manning's roughness coefficient
of the channel within channel cells required for substance <code><a href="#topic+transport">transport</a></code>
(defaults to <code>0.04</code>).
</p>
</li>
<li> <p><code>ns_dep_ovl</code>: A numeric scalar specifying the overland deposition rate per
second required for substance <code><a href="#topic+transport">transport</a></code> (calibration parameter; no
default).
</p>
</li>
<li> <p><code>ns_dep_cha</code>: A numeric scalar specifying the channel deposition rate per
second required for substance <code><a href="#topic+transport">transport</a></code> (calibration parameter; no
default).
</p>
</li>
<li> <p><code>nv_tfc_inl</code>: A named numeric vector specifying the inlet transfer
coefficients required for substance <code><a href="#topic+transport">transport</a></code>, for example, <code>c(SS = 0.6, PP = 0.6)</code> (no default).
</p>
</li>
<li> <p><code>nv_enr_rto</code> A named numeric vector specifying the substance enrichment
ratios required for substance except SS <code><a href="#topic+transport">transport</a></code>, for example, <code>c(PP = 2.0)</code> (calibration parameter; no default).
</p>
</li>
<li> <p><code>iv_fDo</code>: An integer vector specifying the outflow direction vector
required for substance <code><a href="#topic+transport">transport</a></code> (defaults to <em>ArcGIS</em> codes).
</p>
</li>
<li> <p><code>nm_olc</code>: A two column numeric <code><a href="base.html#topic+matrix">matrix</a></code> specifying one or more catchment
outlet coordinates required for the in-channel retention ratio of
<code><a href="#topic+calibrationQuality">calibrationQuality</a></code> (no default).
</p>
</li>
<li> <p><code>df_cdt</code>: A <code><a href="base.html#topic+data.frame">data.frame</a></code> with calibration data, which must have at least
the following three columns and one or more columns with substance river
loads in t/yr (no default):
</p>

<ul>
<li> <p><em>ID:</em> ID(s) of the gauge(s)
</p>
</li>
<li> <p><em>x:</em> x-coordinate(s) of the gauge(s)
</p>
</li>
<li> <p><em>y:</em> y-coordinate(s) of the gauge(s)
</p>
</li></ul>

</li></ul>



<h3>Monte Carlo simulation mode</h3>

<p>This mode can make use of repeated random samples, i.e. raster data, of
distributions of about all input data. The filenames of the Monte Carlo input
raster data must contain the specified iteration, for example, <em>CFa12.tif</em>
for the twelfth iteration of the C-factors input data, and can reside in a
separate directory. In case no Monte Carlo raster file is found for a certain
layer in the designated directory, the respective project root subdirectory
is searched for one and finally the &ldquo;normal&rdquo; project input raster data
is utilised.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+saveState">saveState</a></code>, <code><a href="#topic+demoProject">demoProject</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# temporary demonstration project copy
cv_dir &lt;- demoProject()

# initialise project from scratch
x &lt;- RPhosFate(
  cv_dir = cv_dir,
  ns_dep_ovl = 25e-4,
  ns_dep_cha = 0.0,
  nv_tfc_inl = c(SS = 0.6, PP = 0.6),
  nv_enr_rto = c(PP = 2.0),
  nm_olc = matrix(c(4704255, 2795195), ncol = 2L),
  df_cdt = read.table(
    file.path(cv_dir, "cdt.txt"),
    header = TRUE,
    stringsAsFactors = FALSE
  )
)

# load state of existing project in Monte Carlo simulation mode
x &lt;- RPhosFate(
  cv_dir = c(
    cv_dir,
    system.file("tinytest", "testProject", package = "RPhosFate")
  ),
  ls_ini = TRUE,
  is_MCi = 1L,
  cv_MCl = c("xxt", "xxt_cld")
)

</code></pre>

<hr>
<h2 id='RPhosFate-class'>RPhosFate class</h2><span id='topic+RPhosFate-class'></span>

<h3>Description</h3>

<p>An S4 object representing a river catchment.
</p>


<h3>Slots</h3>


<dl>
<dt><code>cv_dir</code></dt><dd><p>A character vector holding the project root (first position) and
optionally the Monte Carlo input data directory (second position).</p>
</dd>
<dt><code>ls_ini</code></dt><dd><p>A logical scalar specifying if the state of an existing project
was loaded from disk.</p>
</dd>
<dt><code>is_MCi</code></dt><dd><p>An integer scalar holding the current Monte Carlo iteration if
applicable.</p>
</dd>
<dt><code>cv_MCl</code></dt><dd><p>A character vector holding the names of the layers, which shall
be written to disk with the associated Monte Carlo iteration in their
filenames upon calling the appropriate methods.</p>
</dd>
<dt><code>cs_fex</code></dt><dd><p>A character string holding the automatically determined file
extension of the provided raster files (either <code>".tif"</code> or <code>".img"</code> for
backward compatibility).</p>
</dd>
<dt><code>parameters</code></dt><dd><p>An S4 object holding the model parameters.</p>
</dd>
<dt><code>topo</code></dt><dd><p>An S4 object holding the raster layers related to topography in
the broader sense.</p>
</dd>
<dt><code>erosion</code></dt><dd><p>An S4 object holding the raster layers related to erosion.</p>
</dd>
<dt><code>transport</code></dt><dd><p>An S4 object holding raster layers required for modelling
transport.</p>
</dd>
<dt><code>substances</code></dt><dd><p>An S4 object holding the substance raster layer containers.</p>
</dd>
<dt><code>helpers</code></dt><dd><p>An S4 object holding helper data.</p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="#topic+RPhosFate">RPhosFate</a></code>, <code><a href="#topic+catchment">catchment</a></code>
</p>

<hr>
<h2 id='saveState+2CRPhosFate-method'>Save state</h2><span id='topic+saveState+2CRPhosFate-method'></span><span id='topic+saveState'></span>

<h3>Description</h3>

<p>Saves parameters <em>(parameters.yaml)</em> and transport calculation order
<em>(order.rds)</em> to disk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RPhosFate'
saveState(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="saveState+2B2CRPhosFate-method_+3A_x">x</code></td>
<td>
<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code> invisibly and side effects in the form of files.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+RPhosFate">RPhosFate</a></code>, <code><a href="#topic+catchment">catchment</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# temporary demonstration project copy
cv_dir &lt;- demoProject()
# load temporary demonstration project
x &lt;- RPhosFate(
  cv_dir = cv_dir,
  ls_ini = TRUE
)

saveState(x)

</code></pre>

<hr>
<h2 id='setParameter+2CRPhosFate-method'>Set parameter(s)</h2><span id='topic+setParameter+2CRPhosFate-method'></span><span id='topic+setParameter'></span>

<h3>Description</h3>

<p>Sets one or more model parameters or substance parameter values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RPhosFate'
setParameter(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setParameter+2B2CRPhosFate-method_+3A_x">x</code></td>
<td>
<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.</p>
</td></tr>
<tr><td><code id="setParameter+2B2CRPhosFate-method_+3A_...">...</code></td>
<td>
<p>Names and values of the parameters to set. See model parameter
arguments section for further information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.
</p>


<h3>Model parameter arguments</h3>


<ul>
<li> <p><code>ns_slp_min</code>: A numeric scalar specifying the minimum bounding slope in %
(defaults to <code>0.001</code>).
</p>
</li>
<li> <p><code>ns_slp_max</code>: A numeric scalar specifying the maximum bounding slope in %
(defaults to <code>999.0</code>).
</p>
</li>
<li> <p><code>ns_rhy_a</code>: A numeric scalar specifying a network constant depending on the
discharge frequency needed for the calculation of the hydraulic radius, which
in turn is a prerequisite for substance transport (defaults to <code>0.09</code>
representing a discharge frequency of approximately six years).
</p>
</li>
<li> <p><code>ns_rhy_b</code>: A numeric scalar specifying a geometry scaling exponent
depending on the discharge frequency needed for the calculation of the
hydraulic radius, which in turn is a prerequisite for substance transport
(defaults to <code>0.50</code> representing a discharge frequency of approximately six
years).
</p>
</li>
<li> <p><code>ns_cha_rto</code>: A numeric scalar specifying the ratio of the channel to the
cell width determining the widths of the riparian zones required for
substance <code><a href="#topic+transport">transport</a></code> (defaults to <code>0.5</code>).
</p>
</li>
<li> <p><code>ns_man_rip</code>: A numeric scalar specifying Manning's roughness coefficient
of the riparian zones within channel cells required for substance
<code><a href="#topic+transport">transport</a></code> (defaults to <code>0.32</code>).
</p>
</li>
<li> <p><code>ns_man_cha</code>: A numeric scalar specifying Manning's roughness coefficient
of the channel within channel cells required for substance <code><a href="#topic+transport">transport</a></code>
(defaults to <code>0.04</code>).
</p>
</li>
<li> <p><code>ns_dep_ovl</code>: A numeric scalar specifying the overland deposition rate per
second required for substance <code><a href="#topic+transport">transport</a></code> (calibration parameter; no
default).
</p>
</li>
<li> <p><code>ns_dep_cha</code>: A numeric scalar specifying the channel deposition rate per
second required for substance <code><a href="#topic+transport">transport</a></code> (calibration parameter; no
default).
</p>
</li>
<li> <p><code>nv_tfc_inl</code>: A named numeric vector specifying the inlet transfer
coefficients required for substance <code><a href="#topic+transport">transport</a></code>, for example, <code>c(SS = 0.6, PP = 0.6)</code> (no default).
</p>
</li>
<li> <p><code>nv_enr_rto</code> A named numeric vector specifying the substance enrichment
ratios required for substance except SS <code><a href="#topic+transport">transport</a></code>, for example, <code>c(PP = 2.0)</code> (calibration parameter; no default).
</p>
</li>
<li> <p><code>iv_fDo</code>: An integer vector specifying the outflow direction vector
required for substance <code><a href="#topic+transport">transport</a></code> (defaults to <em>ArcGIS</em> codes).
</p>
</li>
<li> <p><code>nm_olc</code>: A two column numeric <code><a href="base.html#topic+matrix">matrix</a></code> specifying one or more catchment
outlet coordinates required for the in-channel retention ratio of
<code><a href="#topic+calibrationQuality">calibrationQuality</a></code> (no default).
</p>
</li>
<li> <p><code>df_cdt</code>: A <code><a href="base.html#topic+data.frame">data.frame</a></code> with calibration data, which must have at least
the following three columns and one or more columns with substance river
loads in t/yr (no default):
</p>

<ul>
<li> <p><em>ID:</em> ID(s) of the gauge(s)
</p>
</li>
<li> <p><em>x:</em> x-coordinate(s) of the gauge(s)
</p>
</li>
<li> <p><em>y:</em> y-coordinate(s) of the gauge(s)
</p>
</li></ul>

</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+getParameter">getParameter</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# temporary demonstration project copy
cv_dir &lt;- demoProject()
# load temporary demonstration project
x &lt;- RPhosFate(
  cv_dir = cv_dir,
  ls_ini = TRUE
)

x &lt;- setParameter(x, ns_dep_ovl = 15e-4)
x &lt;- setParameter(
  x,
  nv_tfc_inl = c(SS = 0.6, PP = 0.6),
  nv_enr_rto = c(PP = 1.4)
)

</code></pre>

<hr>
<h2 id='snapGauges+2CRPhosFate-method'>Snap gauge(s)</h2><span id='topic+snapGauges+2CRPhosFate-method'></span><span id='topic+snapGauges'></span>

<h3>Description</h3>

<p>Snaps the coordinates of the provided calibration gauges to the respective
midpoint of the nearest channel cell.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RPhosFate'
snapGauges(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="snapGauges+2B2CRPhosFate-method_+3A_x">x</code></td>
<td>
<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calibrationQuality">calibrationQuality</a></code>, <code><a href="#topic+autoCalibrate">autoCalibrate</a></code>, <code><a href="#topic+autoCalibrate2">autoCalibrate2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# temporary demonstration project copy
cv_dir &lt;- demoProject()
# load temporary demonstration project
x &lt;- RPhosFate(
  cv_dir = cv_dir,
  ls_ini = TRUE
)

x &lt;- snapGauges(x)

</code></pre>

<hr>
<h2 id='subsequentRun+2CRPhosFate-method'>Subsequent run</h2><span id='topic+subsequentRun+2CRPhosFate-method'></span><span id='topic+subsequentRun'></span>

<h3>Description</h3>

<p>Calls <code><a href="#topic+transport">transport</a></code> for the specified substance and optionally
<code><a href="#topic+erosionPrerequisites">erosionPrerequisites</a></code>, <code><a href="#topic+erosion">erosion</a></code>, <code><a href="#topic+emission">emission</a></code>,
<code><a href="#topic+transportPrerequisites">transportPrerequisites</a></code> and/or <code><a href="#topic+transportCalcOrder">transportCalcOrder</a></code> beforehand.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RPhosFate'
subsequentRun(
  x,
  substance = "PP",
  erosionPrerequisites = FALSE,
  erosion = FALSE,
  emission = FALSE,
  transportPrerequisites = FALSE,
  transportCalcOrder = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="subsequentRun+2B2CRPhosFate-method_+3A_x">x</code></td>
<td>
<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.</p>
</td></tr>
<tr><td><code id="subsequentRun+2B2CRPhosFate-method_+3A_substance">substance</code></td>
<td>
<p>A character string specifying the substance to calculate.</p>
</td></tr>
<tr><td><code id="subsequentRun+2B2CRPhosFate-method_+3A_erosionprerequisites">erosionPrerequisites</code></td>
<td>
<p>A logical scalar specifying if
<code><a href="#topic+erosionPrerequisites">erosionPrerequisites</a></code> is called.</p>
</td></tr>
<tr><td><code id="subsequentRun+2B2CRPhosFate-method_+3A_erosion">erosion</code></td>
<td>
<p>A logical scalar specifying if <code><a href="#topic+erosion">erosion</a></code> is called.</p>
</td></tr>
<tr><td><code id="subsequentRun+2B2CRPhosFate-method_+3A_emission">emission</code></td>
<td>
<p>A logical scalar specifying if <code><a href="#topic+emission">emission</a></code> is called. It is
never called with <code>substance = "SS"</code> though.</p>
</td></tr>
<tr><td><code id="subsequentRun+2B2CRPhosFate-method_+3A_transportprerequisites">transportPrerequisites</code></td>
<td>
<p>A logical scalar specifying if
<code><a href="#topic+transportPrerequisites">transportPrerequisites</a></code> is called.</p>
</td></tr>
<tr><td><code id="subsequentRun+2B2CRPhosFate-method_+3A_transportcalcorder">transportCalcOrder</code></td>
<td>
<p>A logical scalar specifying if
<code><a href="#topic+transportCalcOrder">transportCalcOrder</a></code> is called.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object and side effects in
the form of raster files.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+firstRun">firstRun</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# temporary demonstration project copy
cv_dir &lt;- demoProject()
# load temporary demonstration project
x &lt;- RPhosFate(
  cv_dir = cv_dir,
  ls_ini = TRUE
)
# presupposed method call
x &lt;- firstRun(x, "SS")

x &lt;- subsequentRun(x, "PP")

</code></pre>

<hr>
<h2 id='transport+2CRPhosFate-method'>Transport</h2><span id='topic+transport+2CRPhosFate-method'></span><span id='topic+transport'></span>

<h3>Description</h3>

<p>Calculates and writes substance retentions, transports and cell loads as well
as transfers to disk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RPhosFate'
transport(x, substance = "PP")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transport+2B2CRPhosFate-method_+3A_x">x</code></td>
<td>
<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.</p>
</td></tr>
<tr><td><code id="transport+2B2CRPhosFate-method_+3A_substance">substance</code></td>
<td>
<p>A character string specifying the substance to calculate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object and side effects in
the form of raster files.
</p>


<h3>References</h3>

<p><cite>Engman, E.T., 1986. Roughness coefficients for routing surface runoff.
Journal of Irrigation and Drainage Engineering 112, 39–53.</cite>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+firstRun">firstRun</a></code>, <code><a href="#topic+subsequentRun">subsequentRun</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# temporary demonstration project copy
cv_dir &lt;- demoProject()
# load temporary demonstration project
x &lt;- RPhosFate(
  cv_dir = cv_dir,
  ls_ini = TRUE
)
# presupposed method calls
x &lt;- erosionPrerequisites(x)
x &lt;- erosion(x)
x &lt;- emission(x, "PP")
x &lt;- transportPrerequisites(x)
x &lt;- transportCalcOrder(x)

x &lt;- transport(x, "PP")

</code></pre>

<hr>
<h2 id='transportCalcOrder+2CRPhosFate-method'>Transport calculation order</h2><span id='topic+transportCalcOrder+2CRPhosFate-method'></span><span id='topic+transportCalcOrder'></span>

<h3>Description</h3>

<p>Determines the cell transport calculation order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RPhosFate'
transportCalcOrder(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transportCalcOrder+2B2CRPhosFate-method_+3A_x">x</code></td>
<td>
<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+firstRun">firstRun</a></code>, <code><a href="#topic+subsequentRun">subsequentRun</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# temporary demonstration project copy
cv_dir &lt;- demoProject()
# load temporary demonstration project
x &lt;- RPhosFate(
  cv_dir = cv_dir,
  ls_ini = TRUE
)

x &lt;- transportCalcOrder(x)

</code></pre>

<hr>
<h2 id='transportPrerequisites+2CRPhosFate-method'>Transport prerequisites</h2><span id='topic+transportPrerequisites+2CRPhosFate-method'></span><span id='topic+transportPrerequisites'></span>

<h3>Description</h3>

<p>Calculates hydraulic radii and determines cells representing inlets as well
as riparian zones before writing them to disk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RPhosFate'
transportPrerequisites(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transportPrerequisites+2B2CRPhosFate-method_+3A_x">x</code></td>
<td>
<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 <code><a href="#topic+RPhosFate-class">RPhosFate</a></code> river catchment object and side effects in
the form of raster files.
</p>


<h3>References</h3>

<p><cite>Molnár, P., Ramírez, J.A., 1998. Energy dissipation theories and
optimal channel characteristics of river networks. Water Resources Research
34, 1809–1818.</cite>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+firstRun">firstRun</a></code>, <code><a href="#topic+subsequentRun">subsequentRun</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# temporary demonstration project copy
cv_dir &lt;- demoProject()
# load temporary demonstration project
x &lt;- RPhosFate(
  cv_dir = cv_dir,
  ls_ini = TRUE
)

x &lt;- transportPrerequisites(x)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
