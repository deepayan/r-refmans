<!DOCTYPE html><html lang="en"><head><title>Help for package PBSddesolve</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PBSddesolve}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PBSddesolve'>
<p>Package: Solver for Delay Differential Equations</p></a></li>
<li><a href='#dde'><p>Solve Delay Differential Equations</p></a></li>
<li><a href='#dot-onClosePBSddeExamples'>
<p>On Close Set Old WD</p></a></li>
<li><a href='#dot-PBSddeEnv'><p>PBSddesolve Environment</p></a></li>
<li><a href='#pastvalue'>
<p>Retrieve Past Values (lags) During Gradient Calculation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.13.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-04</td>
</tr>
<tr>
<td>Title:</td>
<td>Solver for Delay Differential Equations</td>
</tr>
<tr>
<td>Author:</td>
<td>Alex Couture-Beil [aut],
  Jon T. Schnute [aut],
  Rowan Haigh [aut, cre],
  Simon N. Wood [aut],
  Benjamin J. Cairns [aut],
  Nicholas Boers [ctb],
  Nick Fisch [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rowan Haigh &lt;rowan.haigh@dfo-mpo.gc.ca&gt;</td>
</tr>
<tr>
<td>Copyright:</td>
<td>2007-2024, Fisheries and Oceans Canada</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>PBSmodelling</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for solving systems of delay differential equations by
   interfacing with numerical routines written by Simon N. Wood, including
   contributions from Benjamin J. Cairns. These numerical routines first
   appeared in Simon Wood's 'solv95' program. This package includes a vignette
   and a complete user's guide. 'PBSddesolve' originally appeared on CRAN under
   the name 'ddesolve'. That version is no longer supported. The current name
   emphasizes a close association with other 'PBS' packages, particularly
   'PBSmodelling'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/pbs-software/pbs-ddesolve">https://github.com/pbs-software/pbs-ddesolve</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-04 22:47:39 UTC; HaighR</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-09 07:00:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='PBSddesolve'>
Package: Solver for Delay Differential Equations
</h2><span id='topic+PBSddesolve-package'></span><span id='topic+PBSddesolve'></span>

<h3>Description</h3>

<p>A solver for systems of delay differential equations based on 
numerical routines from Simon Wood's
<a href="https://www.maths.ed.ac.uk/~swood34/simon/dde.html"><code>solv95</code></a> program. 
This solver is also capable of solving systems of ordinary
differential equations.
</p>


<h3>Details</h3>

<p>Please see the user guide <code>PBSddesolve-UG.pdf</code>, located in R's
library directory <code>./library/PBSddesolve/doc</code>, for a 
comprehensive overview.
</p>


<h3>Author(s)</h3>

<p><a href="mailto:alex@mofo.ca">Alex Couture-Beil</a> &ndash; Software Engineer, Earthly Technologies, Victoria BC<br />
<a href="mailto:schnutej@shaw.ca">Jon T. Schnute</a> &ndash; Scientist Emeritus, DFO, Nanaimo BC<br />
<a href="mailto:nboers@gmail.com">Nicholas M. Boers</a> &ndash; Senior Software Engineer, Jobber, Edmonton AB
</p>
<p>Maintainer: <a href="mailto:rowan.haigh@dfo-mpo.gc.ca">Rowan Haigh</a>, Program Head &ndash; Offshore Rockfish<br />
Pacific Biological Station (PBS), Fisheries &amp; Oceans Canada (DFO), Nanaimo BC<br />
<em>locus opus</em>: Regional Headquarters (RHQ), Vancouver BC<br />
Last modified <code>Rd: 2023-01-30</code>
</p>


<h3>References</h3>

<p>Wood, S.N. (1999) Solv95: a numerical solver for systems of delay 
differential equations with switches. Saint Andrews, UK. 10 pp.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dde">dde</a></code>
</p>

<hr>
<h2 id='dde'>Solve Delay Differential Equations</h2><span id='topic+dde'></span>

<h3>Description</h3>

<p>A solver for systems of delay differential equations based on numerical routines from
C source code <code>solv95</code> by 
<a href="https://www.maths.ed.ac.uk/~swood34/simon/dde.html">Simon Wood</a>.
This solver is also capable of solving systems of ordinary differential equations. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dde(y, times, func, parms=NULL, switchfunc=NULL, mapfunc=NULL, 
   tol=1e-08, dt=0.1, hbsize=10000) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dde_+3A_y">y</code></td>
<td>
<p><code>numeric</code> &ndash; vector of initial values of the DDE system.
The size of the supplied vector determines the number of variables in the system.</p>
</td></tr>
<tr><td><code id="dde_+3A_times">times</code></td>
<td>
<p><code>numeric</code> &ndash; vector of specific times to solve. </p>
</td></tr>
<tr><td><code id="dde_+3A_func">func</code></td>
<td>
<p><code>function</code> &ndash; a user-supplied function that computes the gradients in 
the DDE system at time <code>t</code>.
The function must be defined using the arguments: <code>(t,y)</code> or <code>(t,y,parms)</code>,
where <code>t</code> is the current time in the integration, <code>y</code> is a vector of the 
current estimated variables of the DDE system, and <code>parms</code> is any R object 
representing additional parameters (optional).<br />
The argument <code>func</code> must return one of the two following return types:<br />
1) a vector containing the calculated gradients for each variable; or <br />
2) a list with two elements - the first a vector of calculated gradients, the second 
a vector (possibly named) of values for a variable specified by the user at each 
point in the integration.</p>
</td></tr>
<tr><td><code id="dde_+3A_parms">parms</code></td>
<td>
<p><code>list</code> &ndash; any constant parameters to pass to <code>func</code>,
<code>switchfunc</code>, and <code>mapfunc</code>.</p>
</td></tr>
<tr><td><code id="dde_+3A_switchfunc">switchfunc</code></td>
<td>
<p><code>function</code> &ndash; an optional function that is used to manipulate
state values at given times. 
The switch function takes the arguments <code>(t,y)</code> or <code>(t,y,parms)</code> and must 
return a numeric vector. 
The size of the vector determines the number of switches used by the model. 
As values of <code>switchfunc</code> pass through zero (from positive to negative), a 
corresponding call to <code>mapfunc</code> is made, which can then modify any state value.</p>
</td></tr>
<tr><td><code id="dde_+3A_mapfunc">mapfunc</code></td>
<td>
<p><code>function</code> &ndash; if <code>switchfunc</code> is defined, then a map function
must also be supplied with arguments <code>(t, y, switch_id)</code> or 
<code>t, y, switch_id, parms)</code>, where <code>t</code> is the time, <code>y</code> are the current
state values, <code>switch_id</code> is the index of the triggered switch, and <code>parms</code>
are additional constant parameters.</p>
</td></tr>
<tr><td><code id="dde_+3A_tol">tol</code></td>
<td>
<p><code>numeric</code> &ndash; maximum error tolerated at each time step (as a proportion
of the state variable concerned).</p>
</td></tr>
<tr><td><code id="dde_+3A_dt">dt</code></td>
<td>
<p><code>numeric</code> &ndash; maximum initial time step.</p>
</td></tr>
<tr><td><code id="dde_+3A_hbsize">hbsize</code></td>
<td>
<p><code>numeric</code> &ndash; history buffer size required for solving DDEs.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please see the included demos (<code>'blowflies'</code>, <code>'cooling'</code>, <code>'icecream'</code>,
<code>'lorenz'</code>) for examples of how to use <code>dde</code>.<br /><br />
The demos can be run two ways:
</p>

<ol>
<li><p> Using the package <code>utils</code>, run the command:<br />
<code>demo(icecream, package="PBSddesolve", ask=FALSE)</code>
</p>
</li>
<li><p> Using the package <code>PBSmodelling</code>, run the commands:<br />
<code>require(PBSmodelling); runDemos()</code>
</p>
</li></ol>

<p>The latter produces a GUI that shows all demos available from locally installed packages.
Choose <code>PBSddesolve</code>. 
Note that the examples are run in the temporary working environment <code>.PBSddeEnv</code>.
</p>
<p>The user supplied function <code>func</code> can access past values (lags) of <code>y</code> by
calling the <code><a href="#topic+pastvalue">pastvalue</a></code> function. 
Past gradients are accessible by the <code><a href="#topic+pastgradient">pastgradient</a></code> function.
These functions can only be called from <code>func</code> and can only be passed values of
<code>t</code> greater or equal to the start time, but less than the current time of the 
integration point.
For example, calling <code>pastvalue(t)</code> is not allowed, since these values are the
current values which are passed in as <code>y</code>.
</p>


<h3>Value</h3>

<p>A data frame with one column for <code>t</code>, a column for every variable in the system,
and a column for every additional value that may (or may not) have been returned by
<code>func</code> in the second element of the list.
</p>
<p>If the initial <code>y</code> values parameter was named, then the solved values column will
use the same names. Otherwise <code>y1</code>, <code>y2</code>, ... will be used.
</p>
<p>If <code>func</code> returned a list, with a named vector as the second element, then those
names will be used as the column names. 
If the vector was not named, then <code>extra1</code>, <code>extra2</code>, ... will be used.
</p>


<h3>Author(s)</h3>

<p><a href="mailto:alex@mofo.ca">Alex Couture-Beil</a> &ndash; Software Engineer, Earthly Technologies, Victoria BC<br />
</p>
<p>Maintainer: <a href="mailto:rowan.haigh@dfo-mpo.gc.ca">Rowan Haigh</a>, Program Head &ndash; Offshore Rockfish<br />
Pacific Biological Station (PBS), Fisheries &amp; Oceans Canada (DFO), Nanaimo BC<br />
<em>locus opus</em>: Offsite, Vancouver BC<br />
Last modified <code>Rd: 2024-01-04</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pastvalue">pastvalue</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##################################################
## This is just a single example of using dde.
## For more examples see demo(package="PBSddesolve")
## the demos require the package PBSmodelling
##################################################

require(PBSddesolve)
local(env=.PBSddeEnv, expr={
  #create a func to return dde gradient
  yprime &lt;- function(t,y,parms) {
    if (t &lt; parms$tau)
      lag &lt;- parms$initial
    else
      lag &lt;- pastvalue(t - parms$tau)
    y1 &lt;- parms$a * y[1] - (y[1]^3/3) + parms$m * (lag[1] - y[1])
    y2 &lt;- y[1] - y[2]
    return(c(y1,y2))
  }

  #define initial values and parameters
  yinit &lt;- c(1,1)
  parms &lt;- list(tau=3, a=2, m=-10, initial=yinit)

  # solve the dde system
  yout &lt;- dde(y=yinit,times=seq(0,30,0.1),func=yprime,parms=parms)

  # and display the results
  plot(yout$time, yout$y1, type="l", col="red", xlab="t", ylab="y", 
    ylim=c(min(yout$y1, yout$y2), max(yout$y1, yout$y2)))
  lines(yout$time, yout$y2, col="blue")
  legend("topleft", legend = c("y1", "y2"),lwd=2, lty = 1, 
    xjust = 1, yjust = 1, col = c("red","blue"))
})
</code></pre>

<hr>
<h2 id='dot-onClosePBSddeExamples'>
On Close Set Old WD
</h2><span id='topic+.onClosePBSddeExamples'></span>

<h3>Description</h3>

<p>A trivial function that sets the user's working directory to an old
(previous) location before opening the Windows GUI that is now 
being closed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.onClosePBSddeExamples()
</code></pre>


<h3>Value</h3>

<p><code>setwd(.PBSddeEnv$oldwd)</code>
</p>


<h3>Author(s)</h3>

<p><a href="mailto:alex@mofo.ca">Alex Couture-Beil</a> &ndash; Software Engineer, Earthly Technologies, Victoria BC<br />
</p>
<p>Maintainer: <a href="mailto:rowan.haigh@dfo-mpo.gc.ca">Rowan Haigh</a>, Program Head &ndash; Offshore Rockfish<br />
Pacific Biological Station (PBS), Fisheries &amp; Oceans Canada (DFO), Nanaimo BC<br />
<em>locus opus</em>: Offsite, Vancouver BC<br />
Last modified <code>Rd: 2024-01-04</code>
</p>

<hr>
<h2 id='dot-PBSddeEnv'>PBSddesolve Environment</h2><span id='topic+.PBSddeEnv'></span>

<h3>Description</h3>

<p>An environment set aside for PBSddesolve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.PBSddeEnv</code></pre>


<h3>Format</h3>

<p>A new environment with a <code>.GlobalEnv</code> parent.
</p>


<h3>Details</h3>

<p>The environment is created in <code>'zzz.r'</code> and can be used by
<code>PBSmodelling</code> functions <code>'lisp'</code>, <code>'tget'</code>, 
<code>'tput'</code>, <code>'tprint'</code>, and <code>'tcall'</code>.
</p>


<h3>Source</h3>

<p>Generated by a call to the base function <code>new.env()</code>.
</p>


<h3>See Also</h3>

<p>In <span class="pkg">PBSmodelling</span>:<br />
<code>lisp</code>,
<code>tget</code>
</p>

<hr>
<h2 id='pastvalue'>
Retrieve Past Values (lags) During Gradient Calculation
</h2><span id='topic+pastvalue'></span><span id='topic+pastgradient'></span>

<h3>Description</h3>

<p>These routines provides access to variable history at lagged times.
The lagged time <code class="reqn">t</code> must not be less than <code class="reqn">t_0</code>, nor should it be greater
than the current time of gradient calculation.
The routine cannot be directly called by a user, and will only work during the 
integration process as triggered by the <code>dde</code> routine.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pastvalue(t)
pastgradient(t)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pastvalue_+3A_t">t</code></td>
<td>
<p>Access history at time <code>t</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of variable history at time <code>t</code>.
</p>


<h3>Author(s)</h3>

<p><a href="mailto:alex@mofo.ca">Alex Couture-Beil</a> &ndash; Software Engineer, Earthly Technologies, Victoria BC<br />
</p>
<p>Maintainer: <a href="mailto:rowan.haigh@dfo-mpo.gc.ca">Rowan Haigh</a>, Program Head &ndash; Offshore Rockfish<br />
Pacific Biological Station (PBS), Fisheries &amp; Oceans Canada (DFO), Nanaimo BC<br />
<em>locus opus</em>: Regional Headquarters (RHQ), Vancouver BC<br />
Last modified <code>Rd: 2023-01-30</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dde">dde</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
