<!DOCTYPE html><html lang="en"><head><title>Help for package pdc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pdc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pdc-package'>
<p>Permutation Distribution Clustering</p></a></li>
<li><a href='#codebook'>
<p>Codebook</p></a></li>
<li><a href='#complex.shapes'><p>Shape Signatures of Fish, Glasses, and Bottles</p></a></li>
<li><a href='#distance'>
<p>Codebook Dissimliarities</p></a></li>
<li><a href='#entropyHeuristic'>
<p>Minimum Entropy Heuristic (MinE)</p></a></li>
<li><a href='#loo1nn'>
<p>Leave-one-out One-nearest-neighbor Evaluation</p></a></li>
<li><a href='#mdsPlot'><p>Multidimensional Scaling Plot</p></a></li>
<li><a href='#pdcDist'>
<p>Permutation Distribution Clustering Distance Matrix</p></a></li>
<li><a href='#pdclust'>
<p>Permutation Distribution Clustering</p></a></li>
<li><a href='#rasterPlot'><p>Dendrogram Plot with Images</p></a></li>
<li><a href='#star.shapes'><p>Shape Signatures of Stars</p></a></li>
<li><a href='#traceImage'>
<p>Shape Tracing of an Image</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Permutation Distribution Clustering</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-09-28</td>
</tr>
<tr>
<td>Author:</td>
<td>Andreas M. Brandmaier</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andreas M. Brandmaier &lt;brandmaier@mpib-berlin.mpg.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Permutation Distribution Clustering is a clustering method for time series. Dissimilarity of time series is formalized as the divergence between their permutation distributions. The permutation distribution was proposed as measure of the complexity of a time series.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils, grDevices, graphics</td>
</tr>
<tr>
<td>Suggests:</td>
<td>plotrix, lattice</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-09-28 12:31:31 UTC; brandmaier</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-09-28 17:02:34</td>
</tr>
</table>
<hr>
<h2 id='pdc-package'>
Permutation Distribution Clustering
</h2><span id='topic+pdc-package'></span><span id='topic+pdc'></span>

<h3>Description</h3>

<p>Permutation Distribution Clustering (pdc) represents a complexity-based approach to clustering time series. Clustering comprises methods that recover similarities in a dataset and represent the findings in group structures. Important applications of clustering include the creation of taxonomies, the discovery of anomalies, or the the discovery of reliably different subgroups for differential analysis or treatment.
A crucial parameter in clustering is the choice of the similarity measure between objects. Permutation Distribution Clustering finds similarity in time series based on differences in their permutation distribution as a proxy for differences in their complexity. The permutation distribution is obtained by counting the frequency of distinct order patterns in an m-embedding of the original time series. An embedding of dimension m allows for m! different order patterns. The choice of the embedding dimension crucially influences the clustering result. A small embedding dimension might lead to a permutation distribution with a low representational power, while a large embedding dimension quickly leads to a large permutation distribution that cannot reliably be estimated. With the Minimum Entropy Heuristic (MinE), the embedding dimension can automatically be chosen, thus making the algorithm a parameter-free clustering approach.  
For clustering time-series, the similarity between two time-series is defined as the divergence between two permutation distributions. 
PDC is particularly apt for the analysis of psychophysiological time-series because it is efficient (the time complexity is linear in the time-series length), it is robust to drift, time-series of differing length can be compared, and it is invariant to differences in mean and variance of the time-series (choosing a normalization is not essential).
</p>


<h3>Details</h3>

<p>The main function of the package is <code><a href="#topic+pdclust">pdclust</a></code>, which performs a hierarchical
clustering of a set of time series based on differences in their permutation distributions.
Other clustering or dimensionality-reduction methods can easily be employed by 
directly accessing the distance matrix based on the permutation distribution via <code><a href="#topic+pdcDist">pdcDist</a></code>.
A heuristic for choosing the embedding dimension is provided via <code><a href="#topic+entropyHeuristic">entropyHeuristic</a></code>.
For clustering shapes, shape signatures can be traced from images with <code><a href="#topic+traceImage">traceImage</a></code>. Example data sets for shape clustering are <code><a href="#topic+star.shapes">star.shapes</a></code> and <code><a href="#topic+complex.shapes">complex.shapes</a></code>.
</p>


<h3>Author(s)</h3>

<p>Andreas Brandmaier <a href="mailto:brandmaier@mpib-berlin.mpg.de">brandmaier@mpib-berlin.mpg.de</a>
</p>


<h3>References</h3>

<p>Brandmaier, A. M. (2015). pdc: An R Package for Complexity-Based Clustering
of Time Series. <em>Journal of Statistical Software, 67(5)</em>, 1&ndash;23.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pdc">pdc</a></code>
<code><a href="#topic+pdcDist">pdcDist</a></code>
<code><a href="#topic+codebook">codebook</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# generate 5 ARMA time series for the first group
grp1 &lt;- replicate(5, arima.sim(n = 500, list(ar = c(0.8897, -0.4858), 
		ma = c(-0.2279, 0.2488)),
          	sd = sqrt(0.1796)) )
          
# generate 5 ARMA time series for the second group
grp2 &lt;- replicate(5, arima.sim(n = 500, list(ar = c(-0.71, 0.18), 
		ma = c(0.92, 0.14)),
          	sd = sqrt(0.291)) )
          
# combine groups into a single dataset
X &lt;- cbind(grp1,grp2)

# run clustering and color original groups each in red and blue
clustering &lt;- pdclust(X,3)
plot(clustering, cols=c(rep("red",5),rep("blue",5)))


</code></pre>

<hr>
<h2 id='codebook'>
Codebook
</h2><span id='topic+codebook'></span>

<h3>Description</h3>

<p>A codebook contains the permutation distribution of a time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>codebook(x, m = 3, t = 1, use.fast=T, normalized = T)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="codebook_+3A_x">x</code></td>
<td>

<p>a vector ot a time series
</p>
</td></tr>
<tr><td><code id="codebook_+3A_m">m</code></td>
<td>

<p>The embedding dimension.
</p>
</td></tr>
<tr><td><code id="codebook_+3A_t">t</code></td>
<td>
<p>Time-delay of the embedding.</p>
</td></tr>
<tr><td><code id="codebook_+3A_use.fast">use.fast</code></td>
<td>
<p>Use a fast C-implementation if possible.</p>
</td></tr>
<tr><td><code id="codebook_+3A_normalized">normalized</code></td>
<td>
<p>Normalize codebook such that it is a probability distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The length of a codebook is the factorial of the embedding dimension. The elements of the
codebook represent relative frequencies of codewords of size m.
</p>


<h3>Value</h3>

<p>Returns a vector of relative frequencies.
</p>


<h3>Author(s)</h3>

<p>Andreas Brandmaier <a href="mailto:brandmaier@mpib-berlin.mpg.de">brandmaier@mpib-berlin.mpg.de</a></p>


<h3>References</h3>

<p>Brandmaier, A. M. (2015). pdc: An R Package for Complexity-Based Clustering
of Time Series. <em>Journal of Statistical Software, 67(5)</em>, 1&ndash;23.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pdclust">pdclust</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# calculate codebook from sine-wave
cb &lt;- codebook(c(sin(1:100)),m=3)

# plot the permutation distribution
barplot(cb,xlab="Permutation Distribution")

</code></pre>

<hr>
<h2 id='complex.shapes'>Shape Signatures of Fish, Glasses, and Bottles</h2><span id='topic+complex.shapes'></span><span id='topic+complex.shapes.raw'></span>

<h3>Description</h3>

<p>This data set provides exemplary shape signatures of each five
fish,  bottles, and pairs of glasses. The planar shapes were
derived from original artwork obtained from <a href="openclipart.org">openclipart.org</a>.
Column names encode the type of image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
data(complex.shapes)

data(complex.shapes.raw)
</code></pre>


<h3>Format</h3>

<p><code>complex.shapes</code> is a matrix containing 100 rows and 15 columns obtained from <code>trace.image</code>. 
<code>complex.shapes.raw</code> contains a list containing 15 three-dimensional matrices and an array of corresponding labels.
</p>


<h3>Author(s)</h3>

<p>Andreas Brandmaier <a href="mailto:brandmaier@mpib-berlin.mpg.de">brandmaier@mpib-berlin.mpg.de</a></p>


<h3>References</h3>

<p>Brandmaier, A. M. (2015). pdc: An R Package for Complexity-Based Clustering
of Time Series. <em>Journal of Statistical Software, 67(5)</em>, 1&ndash;23.
</p>

<hr>
<h2 id='distance'>
Codebook Dissimliarities
</h2><span id='topic+hellinger.distance'></span><span id='topic+squared.hellinger.distance'></span><span id='topic+symmetric.alpha.divergence'></span><span id='topic+hellingerDistance'></span><span id='topic+squaredHellingerDistance'></span><span id='topic+symmetricAlphaDivergence'></span>

<h3>Description</h3>

<p>Functions to calculate distances/dissimilarities between codebooks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hellingerDistance(x,y)
squaredHellingerDistance(x,y)
symmetricAlphaDivergence(x,y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distance_+3A_x">x</code></td>
<td>

<p>a codebook
</p>
</td></tr>
<tr><td><code id="distance_+3A_y">y</code></td>
<td>

<p>a codebook
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note: The symmetric alpha-divergence is proportional to the Squared Hellinger distance, and is the default divergence between codebooks.
</p>


<h3>Value</h3>

<p>Returns a numeric dissimilarity between two codebooks.
</p>


<h3>Author(s)</h3>

<p>Andreas Brandmaier <a href="mailto:brandmaier@mpib-berlin.mpg.de">brandmaier@mpib-berlin.mpg.de</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+codebook">codebook</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- codebook(c(sin(1:100)),m=3)
y &lt;- codebook(c(sin(1:100*0.1)),m=3)
hellingerDistance(x,y)

</code></pre>

<hr>
<h2 id='entropyHeuristic'>
Minimum Entropy Heuristic (MinE)
</h2><span id='topic+entropy.heuristic'></span><span id='topic+entropyHeuristic'></span><span id='topic+plot.mine'></span><span id='topic+print.mine'></span><span id='topic+summary.mine'></span>

<h3>Description</h3>

<p>The information content of a permutation distribution depends crucially
on the choice of the embedding dimension. Too small embedding dimensions
narrow the representational power of the distribution, too large embedding
dimensions dilute the estimation of the distribution. The Minimum Entropy
Heuristic (MinE) automatically chooses an embedding dimension with an optimal
representational entropy as proxy for representational power.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>entropyHeuristic(X, m.min=3, m.max=7, t.min = 1, t.max = 1)

## S3 method for class 'mine'
print(x, ...)
## S3 method for class 'mine'
summary(object, ...)
## S3 method for class 'mine'
plot(x, normalize = FALSE, type = "image", mark.optimum = TRUE,
                 col = heat.colors(12), ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="entropyHeuristic_+3A_x">X</code></td>
<td>
<p>A matrix representing a set of time series. Columns are time series and rows represent time points.</p>
</td></tr>
<tr><td><code id="entropyHeuristic_+3A_x">x</code></td>
<td>
<p>An entropy heuristic object of type <code>mine</code>.</p>
</td></tr>
<tr><td><code id="entropyHeuristic_+3A_object">object</code></td>
<td>
<p>An entropy heuristic object of type <code>mine</code>.</p>
</td></tr>
<tr><td><code id="entropyHeuristic_+3A_m.min">m.min</code></td>
<td>
<p>Minimum embedding dimension</p>
</td></tr>
<tr><td><code id="entropyHeuristic_+3A_m.max">m.max</code></td>
<td>
<p>Maximum embedding dimension</p>
</td></tr>
<tr><td><code id="entropyHeuristic_+3A_t.min">t.min</code></td>
<td>
<p>Minimum time-delay</p>
</td></tr>
<tr><td><code id="entropyHeuristic_+3A_t.max">t.max</code></td>
<td>
<p>Maximum time-delay</p>
</td></tr>
<tr><td><code id="entropyHeuristic_+3A_...">...</code></td>
<td>
<p>Further arguments for the generic print, summary, and plot method.</p>
</td></tr>
<tr><td><code id="entropyHeuristic_+3A_normalize">normalize</code></td>
<td>
<p>Normalize values to range [0;1].</p>
</td></tr>
<tr><td><code id="entropyHeuristic_+3A_type">type</code></td>
<td>
<p>Either 'image' or 'contour'. Specifies the plot type.</p>
</td></tr>
<tr><td><code id="entropyHeuristic_+3A_mark.optimum">mark.optimum</code></td>
<td>
<p>Mark the optimal embedding dimension and/or time-delay.</p>
</td></tr>
<tr><td><code id="entropyHeuristic_+3A_col">col</code></td>
<td>
<p>A color map to represent entropy values on.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a range of embedding dimensions, the average entropy of the dataset is calculated. The embedding dimension with
the lowest entropy is chosen.  <code>print</code> and <code>plot</code> is available for result objects.
</p>
<p>The plot of a heuristic object shows the entropy values depending on a range
of embedding dimensions and time-delays. If only embedding dimension or only
time-delay is varied, a line plot is show to indicate the parameter yielding
minimum entropy. Otherwise, an image plot is shown that indicates minimum
entropy depending on both parameters.
</p>


<h3>Value</h3>

<p>A list is returned with the following elements:
</p>
<table role = "presentation">
<tr><td><code>m</code></td>
<td>
<p>The chosen embedding size.</p>
</td></tr>
<tr><td><code>entropy.values</code></td>
<td>
<p>A vector with average entropy values corresponding to each entry in <code>entropy.ms</code></p>
</td></tr>
<tr><td><code>entropy.ms</code></td>
<td>
<p>A vector of the embedding dimensions that were searched for the optimal embedding.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andreas Brandmaier <a href="mailto:brandmaier@mpib-berlin.mpg.de">brandmaier@mpib-berlin.mpg.de</a></p>


<h3>References</h3>

<p>Brandmaier, A. M. (2015). pdc: An R Package for Complexity-Based Clustering
of Time Series. <em>Journal of Statistical Software, 67(5)</em>, 1&ndash;23.
</p>
<p>Brandmaier, A. M. (2012). <em>Permutation Distribution Clustering and Structural Equation Model Trees</em>. Doctoral dissertation. Saarland University, Saarbruecken, Germany.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pdclust">pdclust</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# (1)
#
# create a sine-wave with added noise
# and display a plot showing the average permutation entropy
# depending on varying choices of the embedding size
# (by default time-delay is not searched over)

heuristic &lt;-  entropyHeuristic( sin(1:100)+rnorm(100,0,1) )
plot(heuristic)


# (2)
#
# calculate both optimal embedding dimension and time-delay
#
heuristic &lt;-  entropyHeuristic( sin(1:100)+rnorm(100,0,1), t.min=1, t.max=6 )
plot(heuristic)


</code></pre>

<hr>
<h2 id='loo1nn'>
Leave-one-out One-nearest-neighbor Evaluation
</h2><span id='topic+loo1nn'></span>

<h3>Description</h3>

<p>Evaluates a clustering distance matrix within a supervised learning
scheme: leave-one-out one-neares-neighbor cross-validation.
This yields a rough estimate of the suitabilty of a distance function
for discriminating between classes if ground-truth is known.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loo1nn(x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loo1nn_+3A_x">x</code></td>
<td>
<p>A <code>pdclust</code> object.</p>
</td></tr>
<tr><td><code id="loo1nn_+3A_y">y</code></td>
<td>

<p>A vector of the true class labels.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a percentage-correct estimate.
</p>


<h3>Author(s)</h3>

<p>Andreas Brandmaier <a href="mailto:brandmaier@mpib-berlin.mpg.de">brandmaier@mpib-berlin.mpg.de</a></p>


<h3>References</h3>

<p>Brandmaier, A. M. (2015). pdc: An R Package for Complexity-Based Clustering
of Time Series. <em>Journal of Statistical Software, 67(5)</em>, 1&ndash;23.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pdc.dist">pdc.dist</a></code>
<code><a href="#topic+pdclust">pdclust</a></code>
</p>

<hr>
<h2 id='mdsPlot'>Multidimensional Scaling Plot</h2><span id='topic+mds.plot'></span><span id='topic+mdsPlot'></span>

<h3>Description</h3>

<p>Plots a two-dimensional projection to the principal coordinates of all observations. Clusters are shown as polygonal convex hulls of their members.</p>


<h3>Usage</h3>

<pre><code class='language-R'>	mdsPlot (X, labels = NULL, col = "gray") 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mdsPlot_+3A_x">X</code></td>
<td>
<p>A <code><a href="#topic+pdclust">pdclust</a></code> object.</p>
</td></tr> 
<tr><td><code id="mdsPlot_+3A_labels">labels</code></td>
<td>
<p>Optional. A vector of labels for the observations. If NULL, column names of the dataset are used.</p>
</td></tr>
<tr><td><code id="mdsPlot_+3A_col">col</code></td>
<td>
<p>A vector of colors for polygon shading.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andreas Brandmaier <a href="mailto:brandmaier@mpib-berlin.mpg.de">brandmaier@mpib-berlin.mpg.de</a></p>


<h3>References</h3>

<p>Brandmaier, A. M. (2015). pdc: An R Package for Complexity-Based Clustering
of Time Series. <em>Journal of Statistical Software, 67(5)</em>, 1&ndash;23.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pdclust">pdclust</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("complex.shapes")
truth &lt;- c(rep("fish",5),rep("bottle",4),rep("glasses",5))
clust &lt;- pdclust(complex.shapes, t=5)
mdsPlot(clust, truth, col=c("lightblue","lightgreen","lightgray"))
</code></pre>

<hr>
<h2 id='pdcDist'>
Permutation Distribution Clustering Distance Matrix
</h2><span id='topic+pdc.dist'></span><span id='topic+pdcDist'></span>

<h3>Description</h3>

<p>This function computes and returns the distance matrix computed by the divergence between permutation distributions of time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pdcDist(X, m = NULL, t = NULL, divergence = symmetricAlphaDivergence)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pdcDist_+3A_x">X</code></td>
<td>

<p>A matrix representing a set of time series. Columns are time series and rows represent time points.
</p>
</td></tr>
<tr><td><code id="pdcDist_+3A_m">m</code></td>
<td>

<p>Embedding dimension for calculating the permutation distributions. 
Reasonable values range usually somewhere between 2 and 10. If no embedding dimension is chosen, the MinE heuristic is used to determine the embedding dimension automatically.
</p>
</td></tr>
<tr><td><code id="pdcDist_+3A_t">t</code></td>
<td>
<p>Time-delay of the embedding</p>
</td></tr>
<tr><td><code id="pdcDist_+3A_divergence">divergence</code></td>
<td>

<p>Divergence measure between discrete distributions. Default is the symmetric alpha divergence.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A valid divergence is always non-negative.
</p>


<h3>Value</h3>

<p>Returns the dissimilarity between two codebooks as floating point number (larger or equal than zero).
</p>


<h3>Author(s)</h3>

<p>Andreas Brandmaier <a href="mailto:brandmaier@mpib-berlin.mpg.de">brandmaier@mpib-berlin.mpg.de</a></p>


<h3>References</h3>

<p>Brandmaier, A. M. (2015). pdc: An R Package for Complexity-Based Clustering
of Time Series. <em>Journal of Statistical Software, 67(5)</em>, 1&ndash;23.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pdclust">pdclust</a></code>
</p>
<p><code><a href="stats.html#topic+hclust">hclust</a></code>
<code><a href="stats.html#topic+kmeans">kmeans</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# create a set of time series consisting
# of sine waves with different degrees of added noise
# and two white noise time series
X &lt;- cbind(
sin(1:500)+rnorm(500,0,.1),
sin(1:500)+rnorm(500,0,.2),
sin(1:500)+rnorm(500,0,.3),
sin(1:500)+rnorm(500,0,.4),
rnorm(500,0,1),
rnorm(500,0,1)
)

# calculate the distance matrix
D &lt;- pdcDist(X,3)

# and plot with lattice package, you will
# be able to spot two clusters: a noise cluster
# and a sine wave cluster
require("lattice")
levelplot(as.matrix(D), col.regions=grey.colors(100,start=0.9, end=0.3))


</code></pre>

<hr>
<h2 id='pdclust'>
Permutation Distribution Clustering
</h2><span id='topic+pdclust'></span><span id='topic+plot.pdclust'></span><span id='topic+print.pdclust'></span><span id='topic+str.pdclust'></span>

<h3>Description</h3>

<p>Hierarchical cluster analysis for time series. Similarity of time series is based on the similarity of their permutation distributions. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pdclust(X, m = NULL, t = NULL, divergence =
                 symmetricAlphaDivergence, clustering.method =
                 "complete")


## S3 method for class 'pdclust'
plot(x, labels=NULL, type="rectangle", cols="black",
	timeseries.as.labels = T, p.values=F, ...)


## S3 method for class 'pdclust'
str(object, ...)

## S3 method for class 'pdclust'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pdclust_+3A_x">X</code></td>
<td>

<p>In the univariate case: A matrix representing a set of time series. Columns represent different time series and rows represent time.
In the multivariate case: A three-dimensional matrix with the first dimension representing time, second dimension representing multivariate time series, and the third dimension representing variables.
</p>
</td></tr>
<tr><td><code id="pdclust_+3A_m">m</code></td>
<td>

<p>Embedding dimension for calculating the permutation distributions. Reasonable values range somewhere between 2 and 10. If no embedding dimension is chosen, the MinE heuristic is used to determine the embedding dimension automatically.</p>
</td></tr>
<tr><td><code id="pdclust_+3A_t">t</code></td>
<td>
<p>Time-delay of the embedding.</p>
</td></tr>
<tr><td><code id="pdclust_+3A_divergence">divergence</code></td>
<td>

<p>Divergence measure between discrete distributions. Default is the symmetric alpha divergence.
</p>
</td></tr>
<tr><td><code id="pdclust_+3A_clustering.method">clustering.method</code></td>
<td>

<p>Hierarchical clustering linkage method. One out of c(&quot;complete&quot;,&quot;average&quot;,&quot;single&quot;). 
</p>
</td></tr>
</table>
<p>For plotting:
</p>
<table role = "presentation">
<tr><td><code id="pdclust_+3A_x">x</code></td>
<td>
<p>A <code>pdclust</code> object</p>
</td></tr>
<tr><td><code id="pdclust_+3A_labels">labels</code></td>
<td>

<p>Optionally provide a vector of labels for the time series here.
</p>
</td></tr>
<tr><td><code id="pdclust_+3A_type">type</code></td>
<td>

<p>One of c(&quot;triangle&quot;,&quot;rectangle&quot;) to choose the dendrogram style.
</p>
</td></tr>
<tr><td><code id="pdclust_+3A_cols">cols</code></td>
<td>
<p>Specify line color either as string or as vector of strings</p>
</td></tr>
<tr><td><code id="pdclust_+3A_timeseries.as.labels">timeseries.as.labels</code></td>
<td>
<p> If <code>FALSE</code>, a vertical dendrogram is plotted using hclust. If
<code>TRUE</code>, a horizontal dendrogram is plotted with time series plots as labels.</p>
</td></tr>
<tr><td><code id="pdclust_+3A_p.values">p.values</code></td>
<td>
<p>Annotation of the cluster hierarchy with p values</p>
</td></tr>
<tr><td><code id="pdclust_+3A_...">...</code></td>
<td>
<p>Further graphical arguments.</p>
</td></tr>
</table>
<p>For string representation:
</p>
<table role = "presentation">
<tr><td><code id="pdclust_+3A_object">object</code></td>
<td>
<p>A <code>pdclust</code> object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>pdclust</code> is the central function for clustering time-series in the package <code>pdc</code>.
It allows clustering of univariate and multivariate time-series. 
If time-series have different length, the shorter time-series can be padded
with <code>NA</code>s to bring them to columns of the same length in an array or a
matrix.
Multivariate time-series can also be handled by <code>pdclust</code>. Therefore,
the data must be transformed into a three-dimensional matrix with the
dimenions representing (1) time, (2) entities, and (3) variables/channels. 
</p>


<h3>Value</h3>

<p>Calls to <code>pdclust</code> return a <code>pdclust</code> object. There are
<code><a href="base.html#topic+print">print</a></code>, <code><a href="utils.html#topic+str">str</a></code> and <code><a href="base.html#topic+plot">plot</a></code> methods for <code>pdclust</code> objects.
</p>


<h3>Author(s)</h3>

<p>Andreas Brandmaier <a href="mailto:brandmaier@mpib-berlin.mpg.de">brandmaier@mpib-berlin.mpg.de</a></p>


<h3>References</h3>

<p>Brandmaier, A. M. (2015). pdc: An R Package for Complexity-Based Clustering
of Time Series. <em>Journal of Statistical Software, 67(5)</em>, 1&ndash;23.
<br />
Brandmaier, A. M. (2012). <em>Permutation Distribution Clustering and Structural Equation Model Trees</em>. Doctoral dissertation. Saarland University, Saarbruecken, Germany.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pdcDist">pdcDist</a></code>
<code><a href="#topic+entropyHeuristic">entropyHeuristic</a></code>
<code><a href="#topic+symmetricAlphaDivergence">symmetricAlphaDivergence</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# generate 5 ARMA time series for the first group
grp1 &lt;- replicate(5, arima.sim(n = 500, list(ar = c(0.8897, -0.4858), 
		ma = c(-0.2279, 0.2488)),
          	sd = sqrt(0.1796)) )
          
# generate 5 ARMA time series for the second group
grp2 &lt;- replicate(5, arima.sim(n = 500, list(ar = c(-0.71, 0.18), 
		ma = c(0.92, 0.14)),
          	sd = sqrt(0.291)) )
          
# combine groups into a single dataset
X &lt;- cbind(grp1,grp2)

# run clustering and color original groups each in red and blue
clustering &lt;- pdclust(X)
plot(clustering, cols=c(rep("red",5),rep("blue",5)))

</code></pre>

<hr>
<h2 id='rasterPlot'>Dendrogram Plot with Images</h2><span id='topic+rasterPlot'></span>

<h3>Description</h3>

<p>Plots a horizontal dendrogram with images as leafs</p>


<h3>Usage</h3>

<pre><code class='language-R'>	rasterPlot(cl, raw, monochrome=FALSE, aspect, ...) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rasterPlot_+3A_cl">cl</code></td>
<td>
<p>A <code><a href="#topic+pdclust">pdclust</a></code> object.</p>
</td></tr> 
<tr><td><code id="rasterPlot_+3A_raw">raw</code></td>
<td>
<p>List of RGB images in matrix format.</p>
</td></tr>
<tr><td><code id="rasterPlot_+3A_monochrome">monochrome</code></td>
<td>
<p>Convert image to b/w representation.</p>
</td></tr>
<tr><td><code id="rasterPlot_+3A_aspect">aspect</code></td>
<td>
<p>Aspect ratio.</p>
</td></tr>
<tr><td><code id="rasterPlot_+3A_...">...</code></td>
<td>
<p>Further graphical arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andreas Brandmaier <a href="mailto:brandmaier@mpib-berlin.mpg.de">brandmaier@mpib-berlin.mpg.de</a></p>


<h3>References</h3>

<p>Brandmaier, A. M. (2015). pdc: An R Package for Complexity-Based Clustering
of Time Series. <em>Journal of Statistical Software, 67(5)</em>, 1&ndash;23.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pdclust">pdclust</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("complex.shapes")
data("complex.shapes.raw")
clust &lt;- pdclust(complex.shapes, t=5)
rasterPlot(clust, complex.shapes.raw$images)
</code></pre>

<hr>
<h2 id='star.shapes'>Shape Signatures of Stars</h2><span id='topic+star.shapes'></span><span id='topic+star.shapes.raw'></span>

<h3>Description</h3>

<p>This data set provides exemplary shape signatures of 
Column names are coded 'X-Y-Z' with X indicating the
number of points (4 = 4-point-star or 5 = 5-point-star), Y indicating the
size (0=100%, 1=150%), Z indicating rotation (0=0 degree, 1=45 degree).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(star.shapes)

data(star.shapes.raw)
</code></pre>


<h3>Format</h3>

<p><code>star.shapes</code> is a matrix containing 100 rows and 8 columns obtained from <code>traceImage</code>.
<code>star.shapes.raw</code> contains a list of three-dimensional matrices containing the raw images and an array of corresponding labels.</p>


<h3>Author(s)</h3>

<p>Andreas Brandmaier <a href="mailto:brandmaier@mpib-berlin.mpg.de">brandmaier@mpib-berlin.mpg.de</a></p>


<h3>References</h3>

<p>Brandmaier, A. M. (2015). pdc: An R Package for Complexity-Based Clustering
of Time Series. <em>Journal of Statistical Software, 67(5)</em>, 1&ndash;23.
</p>

<hr>
<h2 id='traceImage'>
Shape Tracing of an Image
</h2><span id='topic+traceImage'></span><span id='topic+trace.image'></span><span id='topic+convertImage'></span><span id='topic+convert.image'></span>

<h3>Description</h3>

<p>Trace the shape of an image to create a shape signature
</p>


<h3>Usage</h3>

<pre><code class='language-R'>traceImage(img, resolution)

convertImage(imgrgb, threshold = 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="traceImage_+3A_img">img</code></td>
<td>

<p>a matrix of size width x height representing a black/white image with 0=white and 1=black.
</p>
</td></tr>
<tr><td><code id="traceImage_+3A_resolution">resolution</code></td>
<td>

<p>The angular resolution of the trace, i.e., the length of the resulting shape signature.
</p>
</td></tr>
<tr><td><code id="traceImage_+3A_imgrgb">imgrgb</code></td>
<td>

<p>a matrix of size width x height x channels representing an RGB image.
</p>
</td></tr>  
<tr><td><code id="traceImage_+3A_threshold">threshold</code></td>
<td>

<p>The average intensity value that serves as boundary to separate black and white pixels.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Shape signatures of objects can be created by unrolling their contour around its centroid across time. The resulting time
series represents distance-to-center of points on the contour versus
radial angle.
</p>
<p>In order to create signatures for RGB images, convert the image with <code>convert.image</code> to a black-and-white image using a <code>threshold</code> between 0 and 1.
</p>
<p>Exemplary datasets containing shape signatures for shape clustering are provided in this package as <code><a href="#topic+star.shapes">star.shapes</a></code> and <code><a href="#topic+complex.shapes">complex.shapes</a></code>.
</p>


<h3>Value</h3>

<p>Returns a list containing <code>angle</code>s and corresponding <code>distance</code>s from center.
</p>


<h3>Author(s)</h3>

<p>Andreas Brandmaier <a href="mailto:brandmaier@mpib-berlin.mpg.de">brandmaier@mpib-berlin.mpg.de</a></p>


<h3>References</h3>

<p>Brandmaier, A. M. (2015). pdc: An R Package for Complexity-Based Clustering
of Time Series. <em>Journal of Statistical Software, 67(5)</em>, 1&ndash;23.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pdclust">pdclust</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create a filled rectangle in a 20x20 image
img &lt;- matrix(0, nrow=20,ncol=20)
img[5:15,5:15] &lt;- 1

# create shape signature
signature &lt;- traceImage(img)

# plot both original image and shape signature
par(mfrow=c(1,3))
#layout(matrix(c(1,2,2), 1, 3, byrow = TRUE))
image(img)
plot(signature$angle, signature$distance,type="l",xlab="angle",ylab="distance")

# reconstruct radial plot
 
require("plotrix")
radial.plot(traceImage(img,resolution=500)$distance,start=0,rp.type="r",radial.lim=c(0,10))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
