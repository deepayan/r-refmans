<!DOCTYPE html><html lang="en"><head><title>Help for package ShapleyOutlier</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ShapleyOutlier}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ShapleyOutlier-package'><p>ShapleyOutlier: Multivariate Outlier Explanations using Shapley Values and Mahalanobis Distances</p></a></li>
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#MOE'><p>Detecting cellwise outliers using Shapley values based on local outlyingness.</p></a></li>
<li><a href='#new_shapley'><p>Class constructor for class <code>shapley</code>.</p></a></li>
<li><a href='#new_shapley_algorithm'><p>Class constructor for class <code>shapley_algorithm</code>.</p></a></li>
<li><a href='#new_shapley_interaction'><p>Class constructor for class <code>shapley_interaction</code>.</p></a></li>
<li><a href='#plot.shapley'><p>Barplot of Shapley values</p></a></li>
<li><a href='#plot.shapley_algorithm'><p>Barplot and tileplot of Shapley values.</p></a></li>
<li><a href='#plot.shapley_interaction'><p>Plot of Shapley interaction indices</p></a></li>
<li><a href='#print.shapley'><p>Print function for class <code>shapley</code>.</p></a></li>
<li><a href='#print.shapley_algorithm'><p>Print function for class <code>shapley_algorithm</code>.</p></a></li>
<li><a href='#print.shapley_interaction'><p>Print function for class <code>shapley_interaction</code>.</p></a></li>
<li><a href='#SCD'><p>Detecting cellwise outliers using Shapley values.</p></a></li>
<li><a href='#shapley'><p>Decomposition of squared Mahalanobis distance using Shapley values.</p></a></li>
<li><a href='#shapley_interaction'><p>Decomposition of squared Mahalanobis distance using Shapley interaction indices.</p></a></li>
<li><a href='#WeatherVienna'><p>Weather data from Vienna</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Outlier Explanations using Shapley Values and
Mahalanobis Distances</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marcus Mayrhofer &lt;marcus.mayrhofer@tuwien.ac.at&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Based on Shapley values to explain multivariate outlyingness and to detect and impute cellwise outliers.
    Includes implementations of methods described in Mayrhofer and Filzmoser (2023) &lt;<a href="https://doi.org/10.1016%2Fj.ecosta.2023.04.003">doi:10.1016/j.ecosta.2023.04.003</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, Rdpack, stats, tibble, tidyr, robustbase, forcats, egg,
ggplot2, gridExtra, RColorBrewer, magrittr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>grDevices, cellWise, robustHD, knitr, MASS, rmarkdown</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-17 11:38:48 UTC; Marcus Mayrhofer</td>
</tr>
<tr>
<td>Author:</td>
<td>Marcus Mayrhofer [aut, cre],
  Peter Filzmoser [aut]</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-17 12:00:34 UTC</td>
</tr>
</table>
<hr>
<h2 id='ShapleyOutlier-package'>ShapleyOutlier: Multivariate Outlier Explanations using Shapley Values and Mahalanobis Distances</h2><span id='topic+ShapleyOutlier'></span><span id='topic+ShapleyOutlier-package'></span>

<h3>Description</h3>

<p>Based on Shapley values to explain multivariate outlyingness and to detect and impute cellwise outliers. Includes implementations of methods described in Mayrhofer and Filzmoser (2023) <a href="https://doi.org/10.1016/j.ecosta.2023.04.003">doi:10.1016/j.ecosta.2023.04.003</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Marcus Mayrhofer <a href="mailto:marcus.mayrhofer@tuwien.ac.at">marcus.mayrhofer@tuwien.ac.at</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Peter Filzmoser
</p>
</li></ul>


<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling 'rhs(lhs)'.
</p>

<hr>
<h2 id='MOE'>Detecting cellwise outliers using Shapley values based on local outlyingness.</h2><span id='topic+MOE'></span>

<h3>Description</h3>

<p>The <code>MOE</code> function indicates outlying cells for
a data vector with <code class="reqn">p</code> entries or data matrix with <code class="reqn">n \times p</code> entries containing only numeric entries <code>x</code>
for a given center <code>mu</code> and covariance matrix <code>Sigma</code> using the Shapley value.
It is a more sophisticated alternative to the <code><a href="#topic+SCD">SCD</a></code> algorithm,
which uses the information of the regular cells to derive an alternative reference point  (Mayrhofer and Filzmoser 2023).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MOE(
  x,
  mu,
  Sigma,
  Sigma_inv = NULL,
  step_size = 0.1,
  min_deviation = 0,
  max_step = NULL,
  local = TRUE,
  max_iter = 1000,
  q = 0.99,
  check_outlyingness = FALSE,
  check = TRUE,
  cells = NULL,
  method = "cellMCD"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MOE_+3A_x">x</code></td>
<td>
<p>Data vector with <code class="reqn">p</code> entries or data matrix with <code class="reqn">n \times p</code> entries containing only numeric entries.</p>
</td></tr>
<tr><td><code id="MOE_+3A_mu">mu</code></td>
<td>
<p>Either <code>NULL</code> (default) or mean vector of <code>x</code>. If NULL, <code>method</code> is used for parameter estimation.</p>
</td></tr>
<tr><td><code id="MOE_+3A_sigma">Sigma</code></td>
<td>
<p>Either <code>NULL</code> (default) or covariance matrix <code class="reqn">p \times p</code> of <code>x</code>. If NULL, <code>method</code> is used for parameter estimation.</p>
</td></tr>
<tr><td><code id="MOE_+3A_sigma_inv">Sigma_inv</code></td>
<td>
<p>Either <code>NULL</code> (default) or Sigma's inverse <code class="reqn">p \times p</code> matrix.
If <code>NULL</code>, the inverse of <code>Sigma</code> is computed using <code>solve(Sigma)</code>.</p>
</td></tr>
<tr><td><code id="MOE_+3A_step_size">step_size</code></td>
<td>
<p>Numeric. Step size for the imputation of outlying cells, with <code>step_size</code> <code class="reqn">\in [0,1]</code>. Defaults to <code class="reqn">0.1</code>.</p>
</td></tr>
<tr><td><code id="MOE_+3A_min_deviation">min_deviation</code></td>
<td>
<p>Numeric. Detection threshold, with <code>min_deviation</code> <code class="reqn">\in [0,1]</code>. Defaults to <code class="reqn">0.2</code></p>
</td></tr>
<tr><td><code id="MOE_+3A_max_step">max_step</code></td>
<td>
<p>Either <code>NULL</code> (default) or an integer. The maximum number of steps in each iteration.
If <code>NULL</code>, <code>max_step</code> <code class="reqn">= p</code>.</p>
</td></tr>
<tr><td><code id="MOE_+3A_local">local</code></td>
<td>
<p>Logical. If TRUE (default), the non-central Chi-Squared distribution is used to determine the cutoff value based on <code>mu_tilde</code>.</p>
</td></tr>
<tr><td><code id="MOE_+3A_max_iter">max_iter</code></td>
<td>
<p>Integer. The maximum number of iterations.</p>
</td></tr>
<tr><td><code id="MOE_+3A_q">q</code></td>
<td>
<p>Numeric. The quantile of the Chi-squared distribution for detection and imputation of outliers. Defaults to <code class="reqn">0.99</code>.</p>
</td></tr>
<tr><td><code id="MOE_+3A_check_outlyingness">check_outlyingness</code></td>
<td>
<p>Logical. If TRUE (default), the outlyingness is rechecked after applying <code>min_deviation</code>.</p>
</td></tr>
<tr><td><code id="MOE_+3A_check">check</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), inputs are checked before running the function
and an error message is returned if one of the inputs is not as expected.</p>
</td></tr>
<tr><td><code id="MOE_+3A_cells">cells</code></td>
<td>
<p>Either <code>NULL</code> (default) or a vector/matrix of the same dimension as <code>x</code>,
indicating the outlying cells. The matrix must contain only zeros and ones, or <code>TRUE</code>/<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="MOE_+3A_method">method</code></td>
<td>
<p>Either &quot;cellMCD&quot; (default) or &quot;MCD&quot;. Specifies the method used for parameter estimation if <code>mu</code> and/or <code>Sigma</code> are not provided.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>shapley_algorithm</code> (<code><a href="#topic+new_shapley_algorithm">new_shapley_algorithm</a></code>) containing the following:
</p>
<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>A <code class="reqn">p</code>-dimensional vector (or a <code class="reqn">n \times p</code> matrix) containing the imputed data.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>A <code class="reqn">p</code>-dimensional vector (or a <code class="reqn">n \times p</code> matrix) containing the Shapley values (outlyingness-scores) of <code>x</code>; see <code><a href="#topic+shapley">shapley</a></code>.</p>
</td></tr>
<tr><td><code>mu_tilde</code></td>
<td>
<p>A <code class="reqn">p</code>-dimensional vector (or a <code class="reqn">n \times p</code> matrix) containing the alternative reference points based on the regular cells of the original observations.</p>
</td></tr>
<tr><td><code>x_original</code></td>
<td>
<p>A <code class="reqn">p</code>-dimensional vector (or a <code class="reqn">n \times p</code> matrix) containing the original data.</p>
</td></tr>
<tr><td><code>x_original</code></td>
<td>
<p>The non-centrality parameters for the Chi-Squared distribution</p>
</td></tr>
<tr><td><code>x_history</code></td>
<td>
<p>A list with <code class="reqn">n</code> elements, each containing the path of how the original data vector was modified.</p>
</td></tr>
<tr><td><code>phi_history</code></td>
<td>
<p>A list with <code class="reqn">n</code> elements, each containing the Shapley values corresponding to <code>x_history</code>.</p>
</td></tr>
<tr><td><code>mu_tilde_history</code></td>
<td>
<p>A list with <code class="reqn">n</code> elements, each containing the alternative reference points corresponding to <code>x_history</code>.</p>
</td></tr>
<tr><td><code>S_history</code></td>
<td>
<p>A list with <code class="reqn">n</code> elements, each containing the indices of the outlying cells in each iteration.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Mayrhofer M, Filzmoser P (2023).
&ldquo;Multivariate outlier explanations using Shapley values and Mahalanobis distances.&rdquo;
<em>Econometrics and Statistics</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p &lt;- 5
mu &lt;- rep(0,p)
Sigma &lt;- matrix(0.9, p, p); diag(Sigma) = 1
Sigma_inv &lt;- solve(Sigma)
x &lt;- c(0,1,2,2.3,2.5)
MOE_x &lt;- MOE(x = x, mu = mu, Sigma = Sigma)
plot(MOE_x)

library(MASS)
set.seed(1)
n &lt;- 100; p &lt;- 10
mu &lt;- rep(0,p)
Sigma &lt;- matrix(0.9, p, p); diag(Sigma) = 1
X &lt;- mvrnorm(n, mu, Sigma)
X[sample(1:(n*p), 100, FALSE)] &lt;- rep(c(-5,5),50)
MOE_X &lt;- MOE(X, mu, Sigma)
plot(MOE_X, subset = 20)
</code></pre>

<hr>
<h2 id='new_shapley'>Class constructor for class <code>shapley</code>.</h2><span id='topic+new_shapley'></span>

<h3>Description</h3>

<p>This function creates an object of class <code>shapley</code> that is returned by the <code><a href="#topic+shapley">shapley</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_shapley(phi = numeric(), mu_tilde = NULL, non_centrality = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="new_shapley_+3A_phi">phi</code></td>
<td>
<p>A <code class="reqn">p</code>-dimensional vector (or a <code class="reqn">n \times p</code> matrix) containing the
Shapley values (outlyingness-scores) of a <code class="reqn">p</code>-dimensional data vector (or a <code class="reqn">n \times p</code> data matrix).</p>
</td></tr>
<tr><td><code id="new_shapley_+3A_mu_tilde">mu_tilde</code></td>
<td>
<p>Optional. A <code class="reqn">p</code>-dimensional vector (or a <code class="reqn">n \times p</code> matrix) containing the
alternative reference points based on the regular cells of the original observations.</p>
</td></tr>
<tr><td><code id="new_shapley_+3A_non_centrality">non_centrality</code></td>
<td>
<p>Optional. The non-centrality parameters for the Chi-Squared distribution,
which are given by <code>mahlanobis(mu_tilde, mu, Sigma)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list of class <code>shapley</code>, containing the input parameters.
</p>

<hr>
<h2 id='new_shapley_algorithm'>Class constructor for class <code>shapley_algorithm</code>.</h2><span id='topic+new_shapley_algorithm'></span>

<h3>Description</h3>

<p>This function creates an object of class <code>shapley_algorithm</code> that is returned
by the <code><a href="#topic+SCD">SCD</a></code> and <code><a href="#topic+MOE">MOE</a></code> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_shapley_algorithm(
  x = numeric(),
  phi = numeric(),
  x_original = numeric(),
  mu_tilde = NULL,
  non_centrality = NULL,
  x_history = NULL,
  phi_history = NULL,
  mu_tilde_history = NULL,
  S_history = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="new_shapley_algorithm_+3A_x">x</code></td>
<td>
<p>A <code class="reqn">p</code>-dimensional vector (or a <code class="reqn">n \times p</code> matrix) containing the imputed data.</p>
</td></tr>
<tr><td><code id="new_shapley_algorithm_+3A_phi">phi</code></td>
<td>
<p>A <code class="reqn">p</code>-dimensional vector (or a <code class="reqn">n \times p</code> matrix) containing the
Shapley values (outlyingness-scores) of a <code class="reqn">p</code>-dimensional data vector (or a <code class="reqn">n \times p</code> data matrix).</p>
</td></tr>
<tr><td><code id="new_shapley_algorithm_+3A_x_original">x_original</code></td>
<td>
<p>A <code class="reqn">p</code>-dimensional vector (or a <code class="reqn">n \times p</code> matrix) containing the original data.</p>
</td></tr>
<tr><td><code id="new_shapley_algorithm_+3A_mu_tilde">mu_tilde</code></td>
<td>
<p>Optional. A <code class="reqn">p</code>-dimensional vector (or a <code class="reqn">n \times p</code> matrix) containing the
alternative reference points based on the regular cells of the original observations.</p>
</td></tr>
<tr><td><code id="new_shapley_algorithm_+3A_non_centrality">non_centrality</code></td>
<td>
<p>Optional. The non-centrality parameters for the Chi-Squared distribution,
which are given by <code>mahlanobis(mu_tilde, mu, Sigma)</code>.</p>
</td></tr>
<tr><td><code id="new_shapley_algorithm_+3A_x_history">x_history</code></td>
<td>
<p>Optional. A list with <code class="reqn">n</code> elements, each containing the path of how the original data vector was modified.</p>
</td></tr>
<tr><td><code id="new_shapley_algorithm_+3A_phi_history">phi_history</code></td>
<td>
<p>Optional. A list with <code class="reqn">n</code> elements, each containing the Shapley values corresponding to <code>x_history</code>.</p>
</td></tr>
<tr><td><code id="new_shapley_algorithm_+3A_mu_tilde_history">mu_tilde_history</code></td>
<td>
<p>Optional. A list with <code class="reqn">n</code> elements, each containing the alternative reference points corresponding to <code>x_history</code>.</p>
</td></tr>
<tr><td><code id="new_shapley_algorithm_+3A_s_history">S_history</code></td>
<td>
<p>Optional. A list with <code class="reqn">n</code> elements, each containing the indices of the outlying cells in each iteration.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list of class <code>shapley_algorithm</code>, containing the input parameters.
</p>

<hr>
<h2 id='new_shapley_interaction'>Class constructor for class <code>shapley_interaction</code>.</h2><span id='topic+new_shapley_interaction'></span>

<h3>Description</h3>

<p>This function creates an object of class <code>shapley_interaction</code> that is returned
by the <code><a href="#topic+shapley_interaction">shapley_interaction</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_shapley_interaction(PHI = numeric())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="new_shapley_interaction_+3A_phi">PHI</code></td>
<td>
<p>A <code class="reqn">p \times p</code> matrix containing the decomposition of the squared Mahalanobis distance
of a <code class="reqn">p</code>-dimensional numeric vector into outlyingness scores for pairs of variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of class <code>shapley_interaction</code>, containing input matrix <code>PHI</code>.
</p>

<hr>
<h2 id='plot.shapley'>Barplot of Shapley values</h2><span id='topic+plot.shapley'></span>

<h3>Description</h3>

<p>Barplot of Shapley values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shapley'
plot(
  x,
  subset = NULL,
  chi2.q = 0.99,
  abbrev.var = 3,
  abbrev.obs = 10,
  sort.var = FALSE,
  sort.obs = FALSE,
  plot_md = TRUE,
  md_squared = TRUE,
  rotate_x = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.shapley_+3A_x">x</code></td>
<td>
<p>A list of class <code>shapley</code>.</p>
</td></tr>
<tr><td><code id="plot.shapley_+3A_subset">subset</code></td>
<td>
<p>Either an integer, <code>"chi2"</code>, or <code>NULL</code> (default) to select which rows of <code>phi</code> should be displayed.
If <code>NULL</code>, all <code class="reqn">n</code> rows are displayed,
for a single integer the <code>subset</code> rows with the highest Mahalanobis distance are displayed,
for an integer vector the <code>subset</code> selected rows are displayed,
and for <code>"chi2"</code> all outlying rows are displayed (Mahalanobis distance greater than <code class="reqn">\sqrt{}</code><code>qchisq(chi2.q,p)</code>).</p>
</td></tr>
<tr><td><code id="plot.shapley_+3A_chi2.q">chi2.q</code></td>
<td>
<p>Quantile, only used if <code>subset == "chi2"</code>.</p>
</td></tr>
<tr><td><code id="plot.shapley_+3A_abbrev.var">abbrev.var</code></td>
<td>
<p>Integer. If <code>abbrev.var</code> <code class="reqn">&gt; 0</code>, column names are abbreviated using abbreviate with <code>minlenght = abrev.var</code>.</p>
</td></tr>
<tr><td><code id="plot.shapley_+3A_abbrev.obs">abbrev.obs</code></td>
<td>
<p>Integer. If <code>abbrev.obs</code> <code class="reqn">&gt; 0</code>, row names are abbreviated using abbreviate with <code>minlenght = abrev.obs</code>.</p>
</td></tr>
<tr><td><code id="plot.shapley_+3A_sort.var">sort.var</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), variables are sorted according to the  distance</p>
</td></tr>
<tr><td><code id="plot.shapley_+3A_sort.obs">sort.obs</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), observations are sorted according to their Mahalanobis distance.</p>
</td></tr>
<tr><td><code id="plot.shapley_+3A_plot_md">plot_md</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), the Mahalanobis distance will be included in the plot.</p>
</td></tr>
<tr><td><code id="plot.shapley_+3A_md_squared">md_squared</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), the squared Mahalanobis distance is plotted otherwise the (not-squared) Mahalanobis distance.</p>
</td></tr>
<tr><td><code id="plot.shapley_+3A_rotate_x">rotate_x</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), the x-axis labels are rotated.</p>
</td></tr>
<tr><td><code id="plot.shapley_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a barplot that displays the Shapley values (<code><a href="#topic+shapley">shapley</a></code>)for each observation and optionally (<code>plot_md = TRUE</code>)
includes the squared Mahalanobis distance (black bar) and the corresponding (non-)central chi-square quantile (dotted line).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
set.seed(1)
n &lt;- 100; p &lt;- 10
mu &lt;- rep(0,p)
Sigma &lt;- matrix(0.9, p, p); diag(Sigma) = 1
X &lt;- mvrnorm(n, mu, Sigma)
X_clean &lt;- X
X[sample(1:(n*p), 100, FALSE)] &lt;- rep(c(-5,5),50)
call_shapley &lt;- shapley(X, mu, Sigma)
plot(call_shapley, subset = 1:20)
plot(call_shapley, subset = 5, rotate_x = FALSE)
plot(call_shapley, subset = 5, md_squared = FALSE, rotate_x = FALSE)
</code></pre>

<hr>
<h2 id='plot.shapley_algorithm'>Barplot and tileplot of Shapley values.</h2><span id='topic+plot.shapley_algorithm'></span>

<h3>Description</h3>

<p>Barplot and tileplot of Shapley values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shapley_algorithm'
plot(
  x,
  type = "both",
  subset = NULL,
  abbrev.var = FALSE,
  abbrev.obs = FALSE,
  sort.var = FALSE,
  sort.obs = FALSE,
  n_digits = 2,
  rotate_x = TRUE,
  continuous_rowname = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.shapley_algorithm_+3A_x">x</code></td>
<td>
<p>A list of class <code>shapley_algorithm</code>.</p>
</td></tr>
<tr><td><code id="plot.shapley_algorithm_+3A_type">type</code></td>
<td>
<p>Either <code>"both"</code> (default), <code>"bar"</code>, or <code>"cell"</code>. If <code>"both"</code> (default) a barplot and a tileplot are created, otherwise only the selected plot is created.</p>
</td></tr>
<tr><td><code id="plot.shapley_algorithm_+3A_subset">subset</code></td>
<td>
<p>Either an integer, <code>"chi2"</code>, or <code>NULL</code> (default) to select which rows of <code>phi</code> should be displayed.
If <code>NULL</code>, all <code class="reqn">n</code> rows are displayed,
for a single integer the <code>subset</code> rows with the highest Mahalanobis distance are displayed,
for an integer vector the <code>subset</code> selected rows are displayed,
and for <code>"chi2"</code> all outlying rows are displayed (Mahalanobis distance greater than <code class="reqn">\sqrt{}</code><code>qchisq(chi2.q,p)</code>).</p>
</td></tr>
<tr><td><code id="plot.shapley_algorithm_+3A_abbrev.var">abbrev.var</code></td>
<td>
<p>Integer. If <code>abbrev.var</code> <code class="reqn">&gt; 0</code>, column names are abbreviated using abbreviate with <code>minlenght = abrev.var</code>.</p>
</td></tr>
<tr><td><code id="plot.shapley_algorithm_+3A_abbrev.obs">abbrev.obs</code></td>
<td>
<p>Integer. If <code>abbrev.obs</code> <code class="reqn">&gt; 0</code>, row names are abbreviated using abbreviate with <code>minlenght = abrev.obs</code>.</p>
</td></tr>
<tr><td><code id="plot.shapley_algorithm_+3A_sort.var">sort.var</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), variables are sorted according to the  distance</p>
</td></tr>
<tr><td><code id="plot.shapley_algorithm_+3A_sort.obs">sort.obs</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), observations are sorted according to their Mahalanobis distance.</p>
</td></tr>
<tr><td><code id="plot.shapley_algorithm_+3A_n_digits">n_digits</code></td>
<td>
<p>Integer. If <code>n_digits</code><code class="reqn"> &gt; 0</code>, the original values of the variables are given in each cell with <code>n_digits</code> decimals places.</p>
</td></tr>
<tr><td><code id="plot.shapley_algorithm_+3A_rotate_x">rotate_x</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), the x-axis labels are rotated.</p>
</td></tr>
<tr><td><code id="plot.shapley_algorithm_+3A_continuous_rowname">continuous_rowname</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the rownames are converted to a numeric vector.</p>
</td></tr>
<tr><td><code id="plot.shapley_algorithm_+3A_...">...</code></td>
<td>
<p>Arguments passed on to <code><a href="#topic+plot.shapley">plot.shapley</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns plots for a list of class <code>shapley_algorithm</code>.
If <code>type</code> is <code>"bar"</code>, a barplot is generated. It displays the Shapley values (<code><a href="#topic+shapley">shapley</a></code>)
for each observation and optionally (<code>plot_md = TRUE</code>) includes the squared Mahalanobis distance (black bar)
and the corresponding (non-)central chi-square quantile (dotted line).
If <code>type</code> is <code>"cell"</code> a tileplot is generated. It displays each cells of the dataset and shows the original value from the observations,
color coding indicates whether those values were higher (red) or lower (blue) than the imputed values,
and the color intensity is based on the magnitude of the Shapley value.
If <code>type</code> is <code>"both"</code>, the barplot and the tileplot are generated.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
set.seed(1)
n &lt;- 100; p &lt;- 10
mu &lt;- rep(0,p)
Sigma &lt;- matrix(0.9, p, p); diag(Sigma) = 1
X &lt;- mvrnorm(n, mu, Sigma)
X[sample(1:(n*p), 100, FALSE)] &lt;- rep(c(-5,5),50)
MOE_X &lt;- MOE(X, mu, Sigma)
plot(MOE_X, subset = 20, n_digits = 0)
</code></pre>

<hr>
<h2 id='plot.shapley_interaction'>Plot of Shapley interaction indices</h2><span id='topic+plot.shapley_interaction'></span>

<h3>Description</h3>

<p>Plot of Shapley interaction indices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shapley_interaction'
plot(
  x,
  abbrev = 4,
  title = "Shapley Interaction",
  legend = TRUE,
  text_size = 22,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.shapley_interaction_+3A_x">x</code></td>
<td>
<p>A <code class="reqn">p \times p</code> matrix containing the Shapley interaction indices (<code><a href="#topic+shapley_interaction">shapley_interaction</a></code>) of a single observation.</p>
</td></tr>
<tr><td><code id="plot.shapley_interaction_+3A_abbrev">abbrev</code></td>
<td>
<p>Integer. If <code>abbrev.var</code> <code class="reqn">&gt; 0</code>, variable names are abbreviated using abbreviate with <code>minlenght = abrev</code>.</p>
</td></tr>
<tr><td><code id="plot.shapley_interaction_+3A_title">title</code></td>
<td>
<p>Character. Title of the plot.</p>
</td></tr>
<tr><td><code id="plot.shapley_interaction_+3A_legend">legend</code></td>
<td>
<p>Logical. If TRUE (default), a legend is plotted.</p>
</td></tr>
<tr><td><code id="plot.shapley_interaction_+3A_text_size">text_size</code></td>
<td>
<p>Integer. Size of the text in the plot</p>
</td></tr>
<tr><td><code id="plot.shapley_interaction_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a figure consisting of two panels. The upper panel shows the Shapley values, and the lower panel the Shapley interaction indices.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p &lt;- 5
mu &lt;- rep(0,p)
Sigma &lt;- matrix(0.9, p, p); diag(Sigma) = 1
Sigma_inv &lt;- solve(Sigma)
x &lt;- c(0,1,2,2.3,2.5)
PHI &lt;- shapley_interaction(x, mu, Sigma)
plot(PHI)
</code></pre>

<hr>
<h2 id='print.shapley'>Print function for class <code>shapley</code>.</h2><span id='topic+print.shapley'></span>

<h3>Description</h3>

<p>Print function for class <code>shapley</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shapley'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.shapley_+3A_x">x</code></td>
<td>
<p>List of class <code>shapley</code>.</p>
</td></tr>
<tr><td><code id="print.shapley_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints the list entries of <code>x</code> that are not <code>NULL</code>.
</p>

<hr>
<h2 id='print.shapley_algorithm'>Print function for class <code>shapley_algorithm</code>.</h2><span id='topic+print.shapley_algorithm'></span>

<h3>Description</h3>

<p>Print function for class <code>shapley_algorithm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shapley_algorithm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.shapley_algorithm_+3A_x">x</code></td>
<td>
<p>List of class <code>shapley_algorithm</code>.</p>
</td></tr>
<tr><td><code id="print.shapley_algorithm_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints the imputed data and the Shapley values.
</p>

<hr>
<h2 id='print.shapley_interaction'>Print function for class <code>shapley_interaction</code>.</h2><span id='topic+print.shapley_interaction'></span>

<h3>Description</h3>

<p>Print function for class <code>shapley_interaction</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shapley_interaction'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.shapley_interaction_+3A_x">x</code></td>
<td>
<p>Matrix of class <code>shapley_interaction</code>.</p>
</td></tr>
<tr><td><code id="print.shapley_interaction_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints the Shapley interaction indices.
</p>

<hr>
<h2 id='SCD'>Detecting cellwise outliers using Shapley values.</h2><span id='topic+SCD'></span>

<h3>Description</h3>

<p>The <code>SCD</code> function indicates outlying cells for
a data vector with <code class="reqn">p</code> entries or data matrix with <code class="reqn">n \times p</code> entries containing only numeric entries <code>x</code>
for a given center <code>mu</code> and covariance matrix <code>Sigma</code> using the Shapley value (Mayrhofer and Filzmoser 2023).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SCD(
  x,
  mu,
  Sigma,
  Sigma_inv = NULL,
  step_size = 0.1,
  min_deviation = 0,
  max_step = NULL,
  max_iter = 1000,
  q = 0.99,
  method = "cellMCD",
  check = TRUE,
  cells = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SCD_+3A_x">x</code></td>
<td>
<p>Data vector with <code class="reqn">p</code> entries or data matrix with <code class="reqn">n \times p</code> entries containing only numeric entries.</p>
</td></tr>
<tr><td><code id="SCD_+3A_mu">mu</code></td>
<td>
<p>Either <code>NULL</code> (default) or mean vector of <code>x</code>. If NULL, <code>method</code> is used for parameter estimation.</p>
</td></tr>
<tr><td><code id="SCD_+3A_sigma">Sigma</code></td>
<td>
<p>Either <code>NULL</code> (default) or covariance matrix <code class="reqn">p \times p</code> of <code>x</code>. If NULL, <code>method</code> is used for parameter estimation.</p>
</td></tr>
<tr><td><code id="SCD_+3A_sigma_inv">Sigma_inv</code></td>
<td>
<p>Either <code>NULL</code> (default) or Sigma's inverse <code class="reqn">p \times p</code> matrix.
If <code>NULL</code>, the inverse of <code>Sigma</code> is computed using <code>solve(Sigma)</code>.</p>
</td></tr>
<tr><td><code id="SCD_+3A_step_size">step_size</code></td>
<td>
<p>Numeric. Step size for the imputation of outlying cells, with <code>step_size</code> <code class="reqn">\in [0,1]</code>. Defaults to <code class="reqn">0.1</code>.</p>
</td></tr>
<tr><td><code id="SCD_+3A_min_deviation">min_deviation</code></td>
<td>
<p>Numeric. Detection threshold, with <code>min_deviation</code> <code class="reqn">\in [0,1]</code>. Defaults to <code class="reqn">0.2</code></p>
</td></tr>
<tr><td><code id="SCD_+3A_max_step">max_step</code></td>
<td>
<p>Either <code>NULL</code> (default) or an integer. The maximum number of steps in each iteration.
If <code>NULL</code>, <code>max_step</code> <code class="reqn">= p</code>.</p>
</td></tr>
<tr><td><code id="SCD_+3A_max_iter">max_iter</code></td>
<td>
<p>Integer. The maximum number of iterations.</p>
</td></tr>
<tr><td><code id="SCD_+3A_q">q</code></td>
<td>
<p>Numeric. The quantile of the Chi-squared distribution for detection and imputation of outliers. Defaults to <code class="reqn">0.99</code>.</p>
</td></tr>
<tr><td><code id="SCD_+3A_method">method</code></td>
<td>
<p>Either &quot;cellMCD&quot; (default) or &quot;MCD&quot;. Specifies the method used for parameter estimation if <code>mu</code> and/or <code>Sigma</code> are not provided.</p>
</td></tr>
<tr><td><code id="SCD_+3A_check">check</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), inputs are checked before running the function
and an error message is returned if one of the inputs is not as expected.</p>
</td></tr>
<tr><td><code id="SCD_+3A_cells">cells</code></td>
<td>
<p>Either <code>NULL</code> (default) or a vector/matrix of the same dimension as <code>x</code>,
indicating the outlying cells. The matrix must contain only zeros and ones, or <code>TRUE</code>/<code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>shapley_algorithm</code> (<code><a href="#topic+new_shapley_algorithm">new_shapley_algorithm</a></code>) containing the following:
</p>
<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>A <code class="reqn">p</code>-dimensional vector (or a <code class="reqn">n \times p</code> matrix) containing the imputed data.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>A <code class="reqn">p</code>-dimensional vector (or a <code class="reqn">n \times p</code> matrix) containing the Shapley values (outlyingness-scores) of <code>x</code>; see <code><a href="#topic+shapley">shapley</a></code>.</p>
</td></tr>
<tr><td><code>x_original</code></td>
<td>
<p>A <code class="reqn">p</code>-dimensional vector (or a <code class="reqn">n \times p</code> matrix) containing the original data.</p>
</td></tr>
<tr><td><code>x_history</code></td>
<td>
<p>The path of how the original data vector was modified.</p>
</td></tr>
<tr><td><code>phi_history</code></td>
<td>
<p>The Shapley values corresponding to <code>x_history</code>.</p>
</td></tr>
<tr><td><code>S_history</code></td>
<td>
<p>The indices of the outlying cells in each iteration.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Mayrhofer M, Filzmoser P (2023).
&ldquo;Multivariate outlier explanations using Shapley values and Mahalanobis distances.&rdquo;
<em>Econometrics and Statistics</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p &lt;- 5
mu &lt;- rep(0,p)
Sigma &lt;- matrix(0.9, p, p); diag(Sigma) = 1
Sigma_inv &lt;- solve(Sigma)
x &lt;- c(0,1,2,2.3,2.5)
SCD_x &lt;- SCD(x = x, mu = mu, Sigma = Sigma)
plot(SCD_x)

library(MASS)
set.seed(1)
n &lt;- 100; p &lt;- 10
mu &lt;- rep(0,p)
Sigma &lt;- matrix(0.9, p, p); diag(Sigma) = 1
X &lt;- mvrnorm(n, mu, Sigma)
X[sample(1:(n*p), 100, FALSE)] &lt;- rep(c(-5,5),50)
SCD_X &lt;- SCD(X, mu, Sigma)
plot(SCD_X, subset = 20)
</code></pre>

<hr>
<h2 id='shapley'>Decomposition of squared Mahalanobis distance using Shapley values.</h2><span id='topic+shapley'></span>

<h3>Description</h3>

<p>The <code>shapley</code> function computes a <code class="reqn">p</code>-dimensional vector containing the decomposition of the
squared Mahalanobis distance of <code>x</code> (with respect to <code>mu</code> and <code>Sigma</code>)
into outlyingness contributions of the individual variables (Mayrhofer and Filzmoser 2023).
The value of the <code class="reqn">j</code>-th coordinate of this vector represents the
average marginal contribution of the <code class="reqn">j</code>-th variable to the squared Mahalanobis distance of
the individual observation <code>x</code>.<br />
If <code>cells</code> is provided, Shapley values of <code>x</code> are computed with respect to a local reference point,
that is based on a cellwise prediction of each coordinate, using the information of the regular cells of <code>x</code>, see (Mayrhofer and Filzmoser 2023).<br />
If <code>x</code> is a <code class="reqn">n \times p</code> matrix, a <code class="reqn">n \times p</code> matrix is returned, containing the decomposition for each row.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shapley(
  x,
  mu = NULL,
  Sigma = NULL,
  inverted = FALSE,
  method = "cellMCD",
  check = TRUE,
  cells = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shapley_+3A_x">x</code></td>
<td>
<p>Data vector with <code class="reqn">p</code> entries or data matrix with <code class="reqn">n \times p</code> entries containing only numeric entries.</p>
</td></tr>
<tr><td><code id="shapley_+3A_mu">mu</code></td>
<td>
<p>Either <code>NULL</code> (default) or mean vector of <code>x</code>. If NULL, <code>method</code> is used for parameter estimation.</p>
</td></tr>
<tr><td><code id="shapley_+3A_sigma">Sigma</code></td>
<td>
<p>Either <code>NULL</code> (default) or covariance matrix <code class="reqn">p \times p</code> of <code>x</code>. If NULL, <code>method</code> is used for parameter estimation.</p>
</td></tr>
<tr><td><code id="shapley_+3A_inverted">inverted</code></td>
<td>
<p>Logical. If <code>TRUE</code>, <code>Sigma</code> is supposed to contain the inverse of the covariance matrix.</p>
</td></tr>
<tr><td><code id="shapley_+3A_method">method</code></td>
<td>
<p>Either &quot;cellMCD&quot; (default) or &quot;MCD&quot;. Specifies the method used for parameter estimation if <code>mu</code> and/or <code>Sigma</code> are not provided.</p>
</td></tr>
<tr><td><code id="shapley_+3A_check">check</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), inputs are checked before running the function
and an error message is returned if one of the inputs is not as expected.</p>
</td></tr>
<tr><td><code id="shapley_+3A_cells">cells</code></td>
<td>
<p>Either <code>NULL</code> (default) or a vector/matrix of the same dimension as <code>x</code>,
indicating the outlying cells. The matrix must contain only zeros and ones, or <code>TRUE</code>/<code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>phi</code></td>
<td>
<p>A <code class="reqn">p</code>-dimensional vector (or a <code class="reqn">n \times p</code> matrix) containing the Shapley values (outlyingness-scores) of <code>x</code>.</p>
</td></tr>
<tr><td><code>mu_tilde</code></td>
<td>
<p>A <code class="reqn">p</code>-dimensional vector (or a <code class="reqn">n \times p</code> matrix) containing the
alternative reference points based on the regular cells of the original observations.</p>
</td></tr>
<tr><td><code>non_centrality</code></td>
<td>
<p>The non-centrality parameters for the Chi-Squared distribution, given by <code>mahlanobis(mu_tilde, mu, Sigma)</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Mayrhofer M, Filzmoser P (2023).
&ldquo;Multivariate outlier explanations using Shapley values and Mahalanobis distances.&rdquo;
<em>Econometrics and Statistics</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Without outlying cells as input in the 'cells' argument#'
# Single observation
p &lt;- 5
mu &lt;- rep(0,p)
Sigma &lt;- matrix(0.9, p, p); diag(Sigma) = 1
Sigma_inv &lt;- solve(Sigma)
x &lt;- c(0,1,2,2.3,2.5)
shapley(x, mu, Sigma)
phi &lt;- shapley(x, mu, Sigma_inv, inverted = TRUE)
plot(phi)

# Multiple observations
library(MASS)
set.seed(1)
n &lt;- 100; p &lt;- 10
mu &lt;- rep(0,p)
Sigma &lt;- matrix(0.9, p, p); diag(Sigma) = 1
X &lt;- mvrnorm(n, mu, Sigma)
X_clean &lt;- X
X[sample(1:(n*p), 100, FALSE)] &lt;- rep(c(-5,5),50)
call_shapley &lt;- shapley(X, mu, Sigma)
plot(call_shapley, subset = 20)


## Giving outlying cells as input in the 'cells' argument
# Single observation
p &lt;- 5
mu &lt;- rep(0,p)
Sigma &lt;- matrix(0.9, p, p); diag(Sigma) = 1
Sigma_inv &lt;- solve(Sigma)
x &lt;- c(0,1,2,2.3,2.5)
call_shapley &lt;- shapley(x, mu, Sigma_inv, inverted = TRUE,
method = "cellMCD", check = TRUE, cells = c(1,1,0,0,0))
plot(call_shapley)

# Multiple observations
library(MASS)
set.seed(1)
n &lt;- 100; p &lt;- 10
mu &lt;- rep(0,p)
Sigma &lt;- matrix(0.9, p, p); diag(Sigma) = 1
X &lt;- mvrnorm(n, mu, Sigma)
X_clean &lt;- X
X[sample(1:(n*p), 100, FALSE)] &lt;- rep(c(-5,5),50)
call_shapley &lt;- shapley(X, mu, Sigma, cells = (X_clean - X)!=0)
plot(call_shapley, subset = 20)
</code></pre>

<hr>
<h2 id='shapley_interaction'>Decomposition of squared Mahalanobis distance using Shapley interaction indices.</h2><span id='topic+shapley_interaction'></span>

<h3>Description</h3>

<p>The <code>shapley_interaction</code> function computes a <code class="reqn">p \times p</code> matrix
containing pairwise outlyingness scores based on Shapley interaction indices.
It decomposes the squared Mahalanobis distance of <code>x</code> (with respect to <code>mu</code> and <code>Sigma</code>)
into outlyingness contributions of pairs of variables (Mayrhofer and Filzmoser 2023).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shapley_interaction(x, mu, Sigma, inverted = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shapley_interaction_+3A_x">x</code></td>
<td>
<p>Data vector with <code class="reqn">p</code> entries containing only numeric entries.</p>
</td></tr>
<tr><td><code id="shapley_interaction_+3A_mu">mu</code></td>
<td>
<p>Either <code>NULL</code> (default) or mean vector of <code>x</code>. If NULL, <code>method</code> is used for parameter estimation.</p>
</td></tr>
<tr><td><code id="shapley_interaction_+3A_sigma">Sigma</code></td>
<td>
<p>Either <code>NULL</code> (default) or covariance matrix <code class="reqn">p \times p</code> of <code>x</code>. If NULL, <code>method</code> is used for parameter estimation.</p>
</td></tr>
<tr><td><code id="shapley_interaction_+3A_inverted">inverted</code></td>
<td>
<p>Logical. If <code>TRUE</code>, <code>Sigma</code> is supposed to contain the inverse of the covariance matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code class="reqn">p \times p</code> matrix containing the decomposition of the squared Mahalanobis distance of <code>x</code>
into outlyingness scores for pairs of variables with respect to <code>mu</code> and <code>Sigma</code>.
</p>


<h3>References</h3>

<p>Mayrhofer M, Filzmoser P (2023).
&ldquo;Multivariate outlier explanations using Shapley values and Mahalanobis distances.&rdquo;
<em>Econometrics and Statistics</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p &lt;- 5
mu &lt;- rep(0,p)
Sigma &lt;- matrix(0.9, p, p); diag(Sigma) = 1
Sigma_inv &lt;- solve(Sigma)
x &lt;- c(0,1,2,2.3,2.5)
shapley_interaction(x, mu, Sigma)
PHI &lt;- shapley_interaction(x, mu, Sigma_inv, inverted = TRUE)
plot(PHI)
</code></pre>

<hr>
<h2 id='WeatherVienna'>Weather data from Vienna</h2><span id='topic+WeatherVienna'></span>

<h3>Description</h3>

<p>Monthly data from the weather station Hohe Warte since April 1872 - Vienna (Stadt Wien 2022).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WeatherVienna
</code></pre>


<h3>Format</h3>

<p>A data frame with 1,804 rows and 25 columns:
</p>

<dl>
<dt><code>year</code></dt><dd><p>Year</p>
</dd>
<dt><code>month</code></dt><dd><p>Month</p>
</dd>
<dt><code>t</code></dt><dd><p>Daily mean air temperature in °C, (t7 mean + t19 mean + tmax mean + tmin mean)/4; before 1971: t7 mean + t14 mean + 2 x t21 mean)</p>
</dd>
<dt><code>t_max</code></dt><dd><p>Absolute maximum air temperature in °C</p>
</dd>
<dt><code>t_min</code></dt><dd><p>Absolute air temperature minimum in °C</p>
</dd>
<dt><code>avg_t_max</code></dt><dd><p>Mean daily maximum air temperature in °C</p>
</dd>
<dt><code>avg_t_min</code></dt><dd><p>Mean daily minimum air temperature in °C</p>
</dd>
<dt><code>num_frost</code></dt><dd><p>Number of frost days (days with a temperature maximum tmin &lt; 0.0 °C)</p>
</dd>
<dt><code>num_ice</code></dt><dd><p>Number of ice days (days with a temperature maximum tmax &lt; 0.0 °C)</p>
</dd>
<dt><code>num_summer</code></dt><dd><p>Number of summer days (days with a temperature maximum tmax &gt;= 25.0 °C)</p>
</dd>
<dt><code>num_heat</code></dt><dd><p>Number of hot days (days with a temperature maximum tmax &gt;= 30.0 °C)</p>
</dd>
<dt><code>p</code></dt><dd><p>Daily mean air pressure in hPa (mean of all measurements at 7 a.m., 2 p.m., 7 p.m. CET; before 1971 9 p.m. instead of 7 p.m.)</p>
</dd>
<dt><code>p_max</code></dt><dd><p>Maximum air pressure in hPa (maximum of all measurements7 am, 2 pm, 7 pm CET; before 1971 9 pm instead of 7 pm)</p>
</dd>
<dt><code>p_min</code></dt><dd><p>Minimum air pressure in hPa (minimum of all measurements7 am, 2 pm, 7 pm CET; before 1971 9 pm instead of 7 pm)</p>
</dd>
<dt><code>sun_h</code></dt><dd><p>Monthly total sunshine duration in hours</p>
</dd>
<dt><code>num_clear</code></dt><dd><p>Number of clear days (daily mean cloudiness &lt; 20/100)</p>
</dd>
<dt><code>num_cloud</code></dt><dd><p>Number of cloudy days (daily mean cloudiness &gt; 80/100)</p>
</dd>
<dt><code>rel_hum</code></dt><dd><p>Daily mean relative humidity in percent (2 x RH7 mean + RH14 mean + RH19 mean)/4; before 1971 9 p.m. instead of 7 p.m.)</p>
</dd>
<dt><code>rel_hum_max</code></dt><dd><p>Relative humidity maximum in percent</p>
</dd>
<dt><code>rel_hum_min</code></dt><dd><p>Relative humidity minimum in percent</p>
</dd>
<dt><code>wind_v</code></dt><dd><p>Monthly average wind speed in km/h</p>
</dd>
<dt><code>num_wind_v60</code></dt><dd><p>Number of days with wind peaks &gt;= 60 km/h</p>
</dd>
<dt><code>wind_v_max</code></dt><dd><p>Maximum wind speed in km/h</p>
</dd>
<dt><code>precp_sum</code></dt><dd><p>Monthly total precipitation in mm</p>
</dd>
<dt><code>num_precp_01</code></dt><dd><p>Number of days with precipitation &gt;= 0.1 mm</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data were downloaded from <code>https://www.data.gv.at/katalog/dataset/wetter-seit-1872-hohe-warte-wien</code> in September 2022.
</p>


<h3>References</h3>

<p>Stadt Wien (2022).
&ldquo;Monthly data from the weather station Hohe Warte since April 1872 - Vienna.&rdquo;
<a href="https://www.data.gv.at/katalog/dataset/wetter-seit-1872-hohe-warte-wien">https://www.data.gv.at/katalog/dataset/wetter-seit-1872-hohe-warte-wien</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("WeatherVienna")
summary(WeatherVienna)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
