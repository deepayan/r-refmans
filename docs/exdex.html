<!DOCTYPE html><html><head><title>Help for package exdex</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {exdex}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#exdex-package'><p>exdex: Estimation of the Extremal Index</p></a></li>
<li><a href='#all_max_rcpp'><p>Sliding and disjoint block maxima</p></a></li>
<li><a href='#cheeseboro'><p>Cheeseboro hourly maximum wind gusts</p></a></li>
<li><a href='#choose_b'><p>Block length diagnostic for the semiparametric maxima estimator</p></a></li>
<li><a href='#choose_ud'><p>Threshold <code class="reqn">u</code> and runs parameter <code class="reqn">D</code> diagnostic for the <code class="reqn">D</code>-gaps</p>
estimator</a></li>
<li><a href='#choose_uk'><p>Threshold <code class="reqn">u</code> and runs parameter <code class="reqn">K</code> diagnostic for the <code class="reqn">K</code>-gaps</p>
estimator</a></li>
<li><a href='#dgaps'><p>Maximum likelihood estimation using left-censored inter-exceedances times</p></a></li>
<li><a href='#dgaps_confint'><p>Confidence intervals for the extremal index <code class="reqn">\theta</code> for <code>"dgaps"</code></p>
objects</a></li>
<li><a href='#dgaps_imt'><p>Information matrix test under the <code class="reqn">D</code>-gaps model</p></a></li>
<li><a href='#dgaps_imt_stat'><p>Statistics for the <code class="reqn">D</code>-gaps information matrix test</p></a></li>
<li><a href='#dgaps_methods'><p>Methods for objects of class <code>"dgaps"</code></p></a></li>
<li><a href='#dgaps_stat'><p>Sufficient statistics for the left-censored inter-exceedances time model</p></a></li>
<li><a href='#exdex-internal'><p>Internal exdex functions</p></a></li>
<li><a href='#iwls'><p>Iterated weighted least squares estimation of the extremal index</p></a></li>
<li><a href='#iwls_methods'><p>Methods for objects of class <code>"iwls"</code></p></a></li>
<li><a href='#kgaps'><p>Maximum likelihood estimation for the <code class="reqn">K</code>-gaps model</p></a></li>
<li><a href='#kgaps_confint'><p>Confidence intervals for the extremal index <code class="reqn">\theta</code> for <code>"kgaps"</code></p>
objects</a></li>
<li><a href='#kgaps_imt'><p>Information matrix test under the <code class="reqn">K</code>-gaps model</p></a></li>
<li><a href='#kgaps_imt_stat'><p>Statistics for the information matrix test</p></a></li>
<li><a href='#kgaps_methods'><p>Methods for objects of class <code>"kgaps"</code></p></a></li>
<li><a href='#kgaps_stat'><p>Sufficient statistics for the <code class="reqn">K</code>-gaps model</p></a></li>
<li><a href='#newlyn'><p>Newlyn sea surges</p></a></li>
<li><a href='#plot.choose_b'><p>Plot block length diagnostic for the semiparametric maxima estimator</p></a></li>
<li><a href='#plot.choose_ud'><p>Plot threshold <code class="reqn">u</code> and runs parameter <code class="reqn">D</code> diagnostic for the</p>
<code class="reqn">D</code>-gaps estimator</a></li>
<li><a href='#plot.choose_uk'><p>Plot threshold <code class="reqn">u</code> and runs parameter <code class="reqn">K</code> diagnostic for the</p>
<code class="reqn">K</code>-gaps estimator</a></li>
<li><a href='#sp500'><p>Daily log returns of the Standard and Poor (S&amp;P) 500 index</p></a></li>
<li><a href='#split_by_NAs'><p>Divides data into parts that contain no missing values</p></a></li>
<li><a href='#spm'><p>Semiparametric maxima estimator of the extremal index</p></a></li>
<li><a href='#spm_confint'><p>Confidence intervals for the extremal index <code class="reqn">\theta</code> for <code>"spm"</code></p>
objects</a></li>
<li><a href='#spm_methods'><p>Methods for objects of class <code>"spm"</code></p></a></li>
<li><a href='#uccle'><p>Uccle maximum daily temperatures</p></a></li>
<li><a href='#uccle720'><p>20th century Uccle maximum daily temperatures in July - data frame</p></a></li>
<li><a href='#uccle720m'><p>20th century Uccle maximum daily temperatures in July - matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation of the Extremal Index</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-02</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs frequentist inference for the extremal index of a 
    stationary time series.  Two types of methodology are used.  One type is
    based on a model that relates the distribution of block maxima to the 
    marginal distribution of series and leads to the semiparametric maxima 
    estimators described in Northrop (2015) &lt;<a href="https://doi.org/10.1007%2Fs10687-015-0221-5">doi:10.1007/s10687-015-0221-5</a>&gt; and 
    Berghaus and Bucher (2018) &lt;<a href="https://doi.org/10.1214%2F17-AOS1621">doi:10.1214/17-AOS1621</a>&gt;.  Sliding block maxima
    are used to increase precision of estimation. A graphical block size 
    diagnostic is provided.  The other type of methodology uses a model for the 
    distribution of threshold inter-exceedance times (Ferro and Segers (2003) 
    &lt;<a href="https://doi.org/10.1111%2F1467-9868.00401">doi:10.1111/1467-9868.00401</a>&gt;). Three versions of this type of approach are 
    provided: the iterated weight least squares approach of Suveges (2007) 
    &lt;<a href="https://doi.org/10.1007%2Fs10687-007-0034-2">doi:10.1007/s10687-007-0034-2</a>&gt;, the K-gaps model of 
    Suveges and Davison (2010) &lt;<a href="https://doi.org/10.1214%2F09-AOAS292">doi:10.1214/09-AOAS292</a>&gt; and a similar approach
    of Holesovsky and Fusek (2020) &lt;<a href="https://doi.org/10.1007%2Fs10687-020-00374-3">doi:10.1007/s10687-020-00374-3</a>&gt; 
    that we refer to as D-gaps. For the K-gaps and D-gaps models this package 
    allows missing values in the data, can accommodate independent subsets of 
    data, such as monthly or seasonal time series from different years, and can 
    incorporate information from right-censored inter-exceedance times.  
    Graphical diagnostics for the threshold level and the respective tuning
    parameters K and D are provided.</td>
</tr>
<tr>
<td>Imports:</td>
<td>chandwich, graphics, methods, Rcpp, RcppRoll, stats</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, revdbayes, rmarkdown, testthat, zoo (&ge; 1.6.4)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/paulnorthrop/exdex">https://github.com/paulnorthrop/exdex</a>,
<a href="https://paulnorthrop.github.io/exdex/">https://paulnorthrop.github.io/exdex/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/paulnorthrop/exdex/issues">https://github.com/paulnorthrop/exdex/issues</a></td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-02 16:17:24 UTC; Paul</td>
</tr>
<tr>
<td>Author:</td>
<td>Paul J. Northrop [aut, cre, cph],
  Constantinos Christodoulides [aut, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paul J. Northrop &lt;p.northrop@ucl.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-02 16:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='exdex-package'>exdex: Estimation of the Extremal Index</h2><span id='topic+exdex'></span><span id='topic+exdex-package'></span>

<h3>Description</h3>

<p>The extremal index <code class="reqn">\theta</code> is a measure of the degree of local
dependence in the extremes of a stationary process.  The <em>exdex</em>
package  performs frequentist inference about <code class="reqn">\theta</code> using the
methodologies proposed in Northrop (2015), Berghaus and Bucher (2018),
Suveges (2007), Suveges and Davison (2010) and Holesovsky and Fusek (2020).
</p>


<h3>Details</h3>

<p>Functions to implement four estimators of the extremal index
are provided, namely
</p>

<ul>
<li> <p><code><a href="#topic+spm">spm</a></code>: semiparametric maxima estimator, using block
maxima: (Northrop, 2015; Berghaus and Bucher, 2018)
</p>
</li>
<li> <p><code><a href="#topic+kgaps">kgaps</a></code>: <code class="reqn">K</code>-gaps estimator, using threshold
inter-exceedance times (Suveges and Davison, 2010)
</p>
</li>
<li> <p><code><a href="#topic+dgaps">dgaps</a></code>: <code class="reqn">D</code>-gaps estimator, using threshold
inter-exceedance times (Holesovsky and Fusek, 2020))
</p>
</li>
<li> <p><code><a href="#topic+iwls">iwls</a></code>: iterated weighted least squares estimator,
using threshold inter-exceedance times: (Suveges, 2007)
</p>
</li></ul>

<p>The functions <code><a href="#topic+choose_b">choose_b</a></code>, <code><a href="#topic+choose_uk">choose_uk</a></code> and
<code><a href="#topic+choose_ud">choose_ud</a></code> provide graphical diagnostics for choosing the
respective tuning parameters of the semiparametric maxima, <code class="reqn">K</code>-gaps and
<code class="reqn">D</code>-gaps estimators.
</p>
<p>For the <code class="reqn">K</code>-gaps and <code class="reqn">D</code>-gaps models the 'exdex' package allows
missing values in the data, can accommodate independent subsets of data,
such as monthly or seasonal time series from different years, and can
incorporate information from censored inter-exceedance times.
</p>
<p>See <code>vignette("exdex-vignette", package = "exdex")</code> for an
overview of the package.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Paul J. Northrop <a href="mailto:p.northrop@ucl.ac.uk">p.northrop@ucl.ac.uk</a> [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Constantinos Christodoulides [copyright holder]
</p>
</li></ul>



<h3>References</h3>

<p>Berghaus, B., Bucher, A. (2018) Weak convergence of a pseudo
maximum likelihood estimator for the extremal index. <em>Ann. Statist.</em>
<strong>46</strong>(5), 2307-2335. <a href="https://doi.org/10.1214/17-AOS1621">doi:10.1214/17-AOS1621</a>
</p>
<p>Holesovsky, J. and Fusek, M. Estimation of the extremal index
using censored distributions. Extremes 23, 197-213 (2020).
<a href="https://doi.org/10.1007/s10687-020-00374-3">doi:10.1007/s10687-020-00374-3</a>
</p>
<p>Northrop, P. J. (2015) An efficient semiparametric maxima
estimator of the extremal index. <em>Extremes</em> <strong>18</strong>(4), 585-603.
<a href="https://doi.org/10.1007/s10687-015-0221-5">doi:10.1007/s10687-015-0221-5</a>
</p>
<p>Suveges, M. (2007) Likelihood estimation of the extremal
index. <em>Extremes</em>, <strong>10</strong>, 41-55.
<a href="https://doi.org/10.1007/s10687-007-0034-2">doi:10.1007/s10687-007-0034-2</a>
</p>
<p>Suveges, M. and Davison, A. C. (2010) Model
misspecification in peaks over threshold analysis, <em>Annals of
Applied Statistics</em>, <strong>4</strong>(1), 203-221.
<a href="https://doi.org/10.1214/09-AOAS292">doi:10.1214/09-AOAS292</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spm">spm</a></code>: semiparametric maxima estimator.
</p>
<p><code><a href="#topic+kgaps">kgaps</a></code>: <code class="reqn">K</code>-gaps estimator.
</p>
<p><code><a href="#topic+dgaps">dgaps</a></code>: <code class="reqn">D</code>-gaps estimator.
</p>
<p><code><a href="#topic+iwls">iwls</a></code>: iterated weighted least squares estimator.
</p>
<p><code><a href="#topic+choose_b">choose_b</a></code>, <code><a href="#topic+choose_ud">choose_ud</a></code> and
<code><a href="#topic+choose_ud">choose_ud</a></code> for choosing tuning parameters.
</p>
<p><code><a href="#topic+newlyn">newlyn</a></code>, <code><a href="#topic+sp500">sp500</a></code> and
<code><a href="#topic+cheeseboro">cheeseboro</a></code> for example datasets.
</p>

<hr>
<h2 id='all_max_rcpp'>Sliding and disjoint block maxima</h2><span id='topic+all_max_rcpp'></span>

<h3>Description</h3>

<p>Calculates the (sliding) maxima of all blocks of <code>b</code> contiguous values
and all sets of the maxima of disjoint blocks of <code>b</code> contiguous values
in the vector <code>x</code>.  This provides the first step of computations in
<code><a href="#topic+spm">spm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>all_max_rcpp(x, b = 1, which_dj = c("all", "first", "last"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="all_max_rcpp_+3A_x">x</code></td>
<td>
<p>A numeric vector of raw observations.</p>
</td></tr>
<tr><td><code id="all_max_rcpp_+3A_b">b</code></td>
<td>
<p>A numeric scalar.  The block size.</p>
</td></tr>
<tr><td><code id="all_max_rcpp_+3A_which_dj">which_dj</code></td>
<td>
<p>A character scalar.  Determines Which sets of disjoint
maxima are calculated: <code>"all"</code>, all sets; <code>"first"</code>, only the
set whose first block starts on the first observation in <code>x</code>;
<code>"last"</code>, only the set whose last block end on the last observation
in <code>x</code>.</p>
</td></tr>
<tr><td><code id="all_max_rcpp_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to
<code><a href="RcppRoll.html#topic+RcppRoll-exports">roll_max</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Sliding maxima.</strong> The function
<code><a href="RcppRoll.html#topic+RcppRoll-exports">roll_max</a></code> in the <code>RcppRoll</code>
package is used.
</p>
<p><strong>Disjoint maxima.</strong>  If <code>n = length(x)</code> is an integer
multiple of <code>b</code>, or if <code>which_dj = "first"</code> or
<code>which_dj = "last"</code> then only one set of <code>n / b</code> disjoint
block maxima are returned.
Otherwise, <code>n - floor(n / b) * b + 1</code> sets of <code>floor(n / b)</code>
disjoint block maxima are returned.  Set <code>i</code> are the disjoint maxima
of <code>x[i:(i + floor(n / b) * b - 1)]</code>.  That is, all possible sets
of contiguous disjoint maxima achieving the maxima length of
<code>floor(n / b)</code> are calculated.
</p>
<p>In both instances <code>na.rm = TRUE</code> is passed to <code><a href="base.html#topic+max">max</a></code> so
that blocks containing missing values produce a non-missing result.
</p>
<p>Also returned are the values in <code>x</code> that contribute to each set
of block maxima.
</p>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr><td><code>ys</code></td>
<td>
<p>a numeric vector containing one set of sliding
block maxima.</p>
</td></tr>
<tr><td><code>xs</code></td>
<td>
<p>a numeric vector containing the values that
contribute to <code>ys</code>, that is, the whole input vector <code>x</code>.</p>
</td></tr>
<tr><td><code>yd</code></td>
<td>
<p>if <code>which_dj = "all"</code> a <code>floor(n / b)</code>
by <code>n - floor(n / b) * b + 1</code> numeric matrix.  Each column
contains a set of disjoint maxima.  Otherwise, a <code>floor(n / b)</code>
by 1 numeric matrix containing one set of block maxima.</p>
</td></tr>
<tr><td><code>xd</code></td>
<td>
<p>if <code>which_dj = "all"</code> a
<code>floor(n / b) * b</code> by <code>n - floor(n / b) * b + 1</code> numeric
matrix.  Each column contains the values in <code>x</code> that contribute
to the corresponding column in <code>yd</code>.  Otherwise, a
<code>floor(n / b)</code> by 1 numeric matrix containing one the one set of
the values in <code>x</code> that contribute to <code>yd</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+spm">spm</a></code> for semiparametric estimation of the
extremal index based on block maxima.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:11
all_max_rcpp(x, 3)
all_max_rcpp(x, 3, which_dj = "first")
all_max_rcpp(x, 3, which_dj = "last")
</code></pre>

<hr>
<h2 id='cheeseboro'>Cheeseboro hourly maximum wind gusts</h2><span id='topic+cheeseboro'></span>

<h3>Description</h3>

<p>The matrix <code>cheeseboro</code> contains hourly maximum wind gusts (in miles
per hour) recorded at the Cheeseboro weather station near Thousand Oaks,
Southern California, USA during the month of January over the period
2000-2009. These data are analysed in Reich and Shaby (2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cheeseboro
</code></pre>


<h3>Format</h3>

<p>A 744 by 10 numeric matrix.  Column <code>i</code> contains the hourly
maximum wind gusts (in miles per hour) from Cheeseboro in the year
2000 + <code>i</code> - 1. The columns are named 2000, 2001, ..., 2009 and the
rows are named day<code>j</code>hour<code>k</code>, where <code>j</code> is the day of the
month and <code>k</code> the hour of the day.
</p>


<h3>Note</h3>

<p>There are 42 missing values, located in 6 of the 10 years, namely
2000-2003 and 2005-2006.
</p>


<h3>Source</h3>

<p>The Remote Automated Weather Stations USA Climate Archive at
<a href="https://raws.dri.edu/">https://raws.dri.edu/</a>, more specifically the Daily Summaries of the
<a href="https://raws.dri.edu/cgi-bin/rawMAIN.pl?caCCHB">Cheeseboro page</a>.
</p>


<h3>References</h3>

<p>Reich, B. J. and Shaby, B. A. (2016). 'Time series of Extremes',
in Dey, D. K. and Yan, J. (eds.) Extreme Value Modeling and Risk Analysis.
New York: Chapman and Hall/CRC, pp. 131-151.
</p>

<hr>
<h2 id='choose_b'>Block length diagnostic for the semiparametric maxima estimator</h2><span id='topic+choose_b'></span>

<h3>Description</h3>

<p>Creates data for a plot to aid the choice of the block length <code>b</code> to
supply to <code><a href="#topic+spm">spm</a></code>.  The general idea is to select the smallest
value of <code>b</code> above which estimates of the extremal index <code class="reqn">\theta</code>
appear to be constant with respect to <code>b</code>, taking into account sampling
variability.  <code><a href="#topic+plot.choose_b">plot.choose_b</a></code> creates the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>choose_b(
  data,
  b,
  bias_adjust = c("BB3", "BB1", "N", "none"),
  constrain = TRUE,
  varN = TRUE,
  level = 0.95,
  interval_type = c("norm", "lik"),
  conf_scale = c("theta", "log"),
  type = c("vertical", "cholesky", "spectral", "none")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="choose_b_+3A_data">data</code></td>
<td>
<p>A numeric vector of raw data.  No missing values are allowed.</p>
</td></tr>
<tr><td><code id="choose_b_+3A_b">b</code></td>
<td>
<p>A numeric scalar.  The block size.</p>
</td></tr>
<tr><td><code id="choose_b_+3A_bias_adjust">bias_adjust</code></td>
<td>
<p>A character scalar.  Is bias-adjustment of the
raw estimate of <code class="reqn">\theta</code> performed using the bias-reduced
estimator (<code>bias_adjust = "BB3"</code>), derived in Section 5 of
Berghaus and Bucher (2018); or a simpler version
(<code>bias_adjust = "BB1"</code>), in which the raw estimate is multiplied by
<code class="reqn">(k-1) / k</code>, where <code class="reqn">k</code> is the number of blocks; or the
bias-adjustment of the empirical distribution function used to calculate
the estimate, as detailed in Section 2 of Northrop (2015).  When disjoint
maxima are used <code>bias_adjust = "BB1"</code> and <code>bias_adjust = "N"</code>
give identical estimates of the Berghaus and Bucher (2018) variant,
as explained at the end of Section 5 of Berghaus and Bucher (2018).
If <code>bias_adjust = "none"</code> then no bias-adjustment is performed.</p>
</td></tr>
<tr><td><code id="choose_b_+3A_constrain">constrain</code></td>
<td>
<p>A logical scalar.  If <code>constrain = TRUE</code> then
any estimates that are greater than 1 are set to 1,
that is, they are constrained to lie in (0, 1].  This is carried out
<em>after</em> any bias-adjustment.  Otherwise,
estimates that are greater than 1 may be obtained.</p>
</td></tr>
<tr><td><code id="choose_b_+3A_varn">varN</code></td>
<td>
<p>A logical scalar.  If <code>varN = TRUE</code> then the estimation
of the sampling variance of the Northrop (2015) estimator is tailored
to that estimator.  Otherwise, the sampling variance derived in
Berghaus and Bucher (2018) is used.
See <strong>Details</strong> for further information.</p>
</td></tr>
<tr><td><code id="choose_b_+3A_level">level</code></td>
<td>
<p>A numeric scalar in (0, 1). The confidence level required.</p>
</td></tr>
<tr><td><code id="choose_b_+3A_interval_type">interval_type</code></td>
<td>
<p>A character scalar: <code>"norm"</code> for intervals of
type (a), <code>"lik"</code> for intervals of type (b).</p>
</td></tr>
<tr><td><code id="choose_b_+3A_conf_scale">conf_scale</code></td>
<td>
<p>A character scalar.  If <code>interval_type = "norm"</code> then
<code>conf_scale</code> determines the scale on which we use approximate
large-sample normality of the estimators to estimate confidence intervals
of type (a).
</p>
<p>If <code>conf_scale = "theta"</code>
then confidence intervals are estimated for <code class="reqn">\theta</code> directly.
If <code>conf_scale = "log"</code> then confidence intervals are first
estimated for <code class="reqn">\log\theta</code> and then transformed back
to the <code class="reqn">\theta</code>-scale.
</p>
<p>Any bias-adjustment requested in the original call to <code><a href="#topic+spm">spm</a></code>,
using it's <code>bias_adjust</code> argument, is automatically applied here.</p>
</td></tr>
<tr><td><code id="choose_b_+3A_type">type</code></td>
<td>
<p>A character scalar.  The argument <code>type</code> to be passed to
<code><a href="chandwich.html#topic+conf_intervals">conf_intervals</a></code> in the
<code><a href="chandwich.html#topic+chandwich">chandwich</a></code> package in order to estimate the
likelihood-based intervals.
Using <code>type = "none"</code> is <em>not</em> advised because then the
intervals are based on naive estimated standard errors.  In particular,
if (the default) <code>sliding = TRUE</code> was used in the call to
<code><a href="#topic+spm">spm</a></code> then the unadjusted likelihood-based confidence
intervals provide <em>vast</em> underestimates of uncertainty.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each block size in <code>b</code> the extremal index <code class="reqn">\theta</code>
is estimated using <code><a href="#topic+spm">spm</a></code>.  The estimates of <code class="reqn">\theta</code>
approximate <code>conf</code>% confidence intervals for <code class="reqn">\theta</code> are
stored for plotting (by <code><a href="#topic+plot.choose_b">plot.choose_b</a></code>)
to produce a simple graphical diagnostic to inform the choice of
block size.  This plot is used to choose a block size above which the
underlying value of <code class="reqn">\theta</code> may be approximately constant.
This is akin to a threshold stability plot: see Chapter 4 of Coles (2001),
for example.
</p>
<p>The nature of the calculation of the sampling variances of the estimates
of <code class="reqn">\theta</code> (see <code><a href="#topic+spm">spm</a></code> for details) means that
<code>choose_b</code> may be a little slow to run if <code>b</code> contains many
values, particularly if some of them are small.
</p>
<p>For very small block sizes it may not be possible to estimate the
confidence intervals.  See <strong>Details</strong> in <code><a href="#topic+spm">spm</a></code>.
For any such block sizes the intervals will be missing from the plot.
</p>


<h3>Value</h3>

<p>An object of class <code>c("choose_b", "exdex")</code> containing
</p>
<table>
<tr><td><code>theta_sl</code>, <code>theta_dj</code></td>
<td>
<p>numeric <code>b</code> by 3 matrices of estimates of
<code class="reqn">\theta</code> using sliding and disjoint blocks.  Columns 1-3 relate to the
estimators <code>N2015</code>, <code>BB2018</code> and <code>BB2018b.</code></p>
</td></tr>
<tr><td><code>lower_sl</code>, <code>lower_dj</code></td>
<td>
<p>Similarly for the lower limits of the confidence
intervals.</p>
</td></tr>
<tr><td><code>upper_sl</code>, <code>upper_dj</code></td>
<td>
<p>Similarly for the upper limits of the confidence
intervals.</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>the input <code>b</code></p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the call to <code>choose_b</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Coles, S. G. (2001) <em>An Introduction to Statistical
Modeling of Extreme Values</em>, Springer-Verlag, London.
<a href="https://doi.org/10.1007/978-1-4471-3675-0_3">doi:10.1007/978-1-4471-3675-0_3</a>
</p>
<p>Northrop, P. J. (2015) An efficient semiparametric maxima
estimator of the extremal index. <em>Extremes</em> <strong>18</strong>(4), 585-603.
<a href="https://doi.org/10.1007/s10687-015-0221-5">doi:10.1007/s10687-015-0221-5</a>
</p>
<p>Berghaus, B., Bucher, A. (2018) Weak convergence of a pseudo
maximum likelihood estimator for the extremal index. <em>Ann. Statist.</em>
<strong>46</strong>(5), 2307-2335. <a href="https://doi.org/10.1214/17-AOS1621">doi:10.1214/17-AOS1621</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.choose_b">plot.choose_b</a></code> to produce the block length diagnostic
plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Newlyn seas surges
# Plot like the top left of Northrop (2015)
# Remove the last 14 values because 2880 has lots of factors
b_vals &lt;- c(2,3,4,5,6,8,9,10,12,15,16,18,20,24,30,32,36,40,45,48,54,60)
res &lt;- choose_b(newlyn[1:2880], b_vals)
# Some b are too small for the sampling variance of the sliding blocks
# estimator to be estimated
plot(res)
plot(res, estimator = "BB2018")
plot(res, maxima = "disjoint")

# S&amp;P 500 index: similar to Berghaus and Bucher (2018), Fig 4 top left
b_vals &lt;- c(10, seq(from = 25, to = 350, by = 25), 357)
res500 &lt;- choose_b(sp500, b_vals)
plot(res500, ylim = c(0, 1))
plot(res500, estimator = "BB2018", ylim = c(0, 1))

</code></pre>

<hr>
<h2 id='choose_ud'>Threshold <code class="reqn">u</code> and runs parameter <code class="reqn">D</code> diagnostic for the <code class="reqn">D</code>-gaps
estimator</h2><span id='topic+choose_ud'></span>

<h3>Description</h3>

<p>Creates data for a plot to aid the choice of the threshold and
run parameter <code class="reqn">D</code> for the <code class="reqn">D</code>-gaps estimator (see
<code><a href="#topic+dgaps">dgaps</a></code>).  <code><a href="#topic+plot.choose_ud">plot.choose_ud</a></code> creates the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>choose_ud(data, u, D = 1, inc_cens = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="choose_ud_+3A_data">data</code></td>
<td>
<p>A numeric vector or numeric matrix of raw data.  If <code>data</code>
is a matrix then the log-likelihood is constructed as the sum of
(independent) contributions from different columns. A common situation is
where each column relates to a different year.
</p>
<p>If <code>data</code> contains missing values then <code><a href="#topic+split_by_NAs">split_by_NAs</a></code> is
used to divide the data into sequences of non-missing values.</p>
</td></tr>
<tr><td><code id="choose_ud_+3A_u">u</code>, <code id="choose_ud_+3A_d">D</code></td>
<td>
<p>Numeric vectors.  <code>u</code> is a vector of
extreme value thresholds applied to data.  <code>D</code> is a vector of values
of the run parameter <code class="reqn">D</code>, as defined in Holesovsky and Fusek (2020).
See <code><a href="#topic+dgaps">dgaps</a></code> for more details.
</p>
<p>Any values in <code>u</code> that are greater than all the observations in
<code>data</code> will be removed without a warning being given.</p>
</td></tr>
<tr><td><code id="choose_ud_+3A_inc_cens">inc_cens</code></td>
<td>
<p>A logical scalar indicating whether or not to include
contributions from right-censored inter-exceedance times, relating to the
first and last observations. It is known that these times are greater
than or equal to the time observed.
If <code>data</code> has multiple columns then there will be right-censored
first and last inter-exceedance times for each column.  See
<strong>Details</strong> in <code><a href="#topic+dgaps">dgaps</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each combination of threshold in <code>u</code> and <code class="reqn">D</code>
in <code>D</code> the functions <code><a href="#topic+dgaps">dgaps</a></code> and <code><a href="#topic+dgaps_imt">dgaps_imt</a></code>
are called in order to estimate <code class="reqn">\theta</code> and to perform the
information matrix test of Holesovsky and Fusek (2020).
</p>


<h3>Value</h3>

<p>An object (a list) of class <code>c("choose_ud", "exdex")</code>
containing
</p>
<table>
<tr><td><code>imt</code></td>
<td>
<p>an object of class <code>c("dgaps_imt", "exdex")</code> returned
from <code><a href="#topic+dgaps_imt">dgaps_imt</a></code>.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>a <code>length(u)</code> by <code>length(D)</code> matrix.
Element (i,j) of <code>theta</code> contains an object (a list) of class
<code>c("dgaps", "exdex")</code>, a result of a call
<code>dgaps(data, u[j], D[i])</code> to <code><a href="#topic+dgaps">dgaps</a></code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Holesovsky, J. and Fusek, M. Estimation of the extremal index
using censored distributions. Extremes 23, 197-213 (2020).
<a href="https://doi.org/10.1007/s10687-020-00374-3">doi:10.1007/s10687-020-00374-3</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dgaps">dgaps</a></code> for maximum likelihood estimation of the
extremal index <code class="reqn">\theta</code> using the <code class="reqn">D</code>-gaps model.
</p>
<p><code><a href="#topic+dgaps_imt">dgaps_imt</a></code> for the information matrix test under the
<code class="reqn">D</code>-gaps model
</p>
<p><code><a href="#topic+plot.choose_ud">plot.choose_ud</a></code> to produce the diagnostic plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### S&amp;P 500 index

# Multiple thresholds and left-censoring parameters
u &lt;- quantile(sp500, probs = seq(0.2, 0.9, by = 0.1))
imt_theta &lt;- choose_ud(sp500, u = u, D = 1:5)
plot(imt_theta)
plot(imt_theta, uprob = TRUE)
plot(imt_theta, y = "theta")

# One left-censoring parameter D, many thresholds u
u &lt;- quantile(sp500, probs = seq(0.2, 0.9, by = 0.1))
imt_theta &lt;- choose_ud(sp500, u = u, D = 1)
plot(imt_theta)
plot(imt_theta, y = "theta")

# One threshold u, many left-censoring parameters D
u &lt;- quantile(sp500, probs = 0.9)
imt_theta &lt;- choose_ud(sp500, u = u, D = 1:5)
plot(imt_theta)
plot(imt_theta, y = "theta")

### Newlyn sea surges

u &lt;- quantile(newlyn, probs = seq(0.1, 0.9, by = 0.1))
imt_theta &lt;- choose_ud(newlyn, u = u, D = 1:5)
plot(imt_theta, uprob = TRUE)

### Cheeseboro wind gusts (a matrix containing some NAs)

probs &lt;- c(seq(0.5, 0.95, by = 0.05), 0.99)
u &lt;- quantile(cheeseboro, probs = probs, na.rm = TRUE)
imt_theta &lt;- choose_ud(cheeseboro, u, D = 1:6)
plot(imt_theta, uprob = FALSE, lwd = 2)

### Uccle July temperatures

probs &lt;- c(seq(0.7, 0.95, by = 0.05), 0.99)
u &lt;- quantile(uccle720m, probs = probs, na.rm = TRUE)
imt_theta &lt;- choose_ud(uccle720m, u, D = 1:5)
plot(imt_theta, uprob = TRUE, lwd = 2)
</code></pre>

<hr>
<h2 id='choose_uk'>Threshold <code class="reqn">u</code> and runs parameter <code class="reqn">K</code> diagnostic for the <code class="reqn">K</code>-gaps
estimator</h2><span id='topic+choose_uk'></span>

<h3>Description</h3>

<p>Creates data for a plot to aid the choice of the threshold and
run parameter <code class="reqn">K</code> for the <code class="reqn">K</code>-gaps estimator (see
<code><a href="#topic+kgaps">kgaps</a></code>).  <code><a href="#topic+plot.choose_uk">plot.choose_uk</a></code> creates the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>choose_uk(data, u, k = 1, inc_cens = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="choose_uk_+3A_data">data</code></td>
<td>
<p>A numeric vector or numeric matrix of raw data.  If <code>data</code>
is a matrix then the log-likelihood is constructed as the sum of
(independent) contributions from different columns. A common situation is
where each column relates to a different year.
</p>
<p>If <code>data</code> contains missing values then <code><a href="#topic+split_by_NAs">split_by_NAs</a></code> is
used to divide the data into sequences of non-missing values.</p>
</td></tr>
<tr><td><code id="choose_uk_+3A_u">u</code>, <code id="choose_uk_+3A_k">k</code></td>
<td>
<p>Numeric vectors.  <code>u</code> is a vector of
extreme value thresholds applied to data.  <code>k</code> is a vector of values
of the run parameter <code class="reqn">K</code>, as defined in Suveges and Davison (2010).
See <code><a href="#topic+kgaps">kgaps</a></code> for more details.
</p>
<p>Any values in <code>u</code> that are greater than all the observations in
<code>data</code> will be removed without a warning being given.</p>
</td></tr>
<tr><td><code id="choose_uk_+3A_inc_cens">inc_cens</code></td>
<td>
<p>A logical scalar indicating whether or not to include
contributions from censored inter-exceedance times, relating to the
first and last observations.  See Attalides (2015) for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each combination of threshold in <code>u</code> and <code class="reqn">K</code>
in <code>k</code> the functions <code><a href="#topic+kgaps">kgaps</a></code> and <code><a href="#topic+kgaps_imt">kgaps_imt</a></code>
are called in order to estimate <code class="reqn">\theta</code> and to perform the
information matrix test of Suveges and Davison (2010).
</p>


<h3>Value</h3>

<p>An object (a list) of class <code>c("choose_uk", "exdex")</code>
containing
</p>
<table>
<tr><td><code>imt</code></td>
<td>
<p>an object of class <code>c("kgaps_imt", "exdex")</code> returned
from <code><a href="#topic+kgaps_imt">kgaps_imt</a></code>.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>a <code>length(u)</code> by <code>length(k)</code> matrix.
Element (i,j) of <code>theta</code> contains an object (a list) of class
<code>c("kgaps", "exdex")</code>, a result of a call
<code>kgaps(data, u[j], k[i])</code> to <code><a href="#topic+kgaps">kgaps</a></code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Suveges, M. and Davison, A. C. (2010) Model
misspecification in peaks over threshold analysis, <em>Annals of
Applied Statistics</em>, <strong>4</strong>(1), 203-221.
<a href="https://doi.org/10.1214/09-AOAS292">doi:10.1214/09-AOAS292</a>
</p>
<p>Attalides, N. (2015) Threshold-based extreme value modelling,
PhD thesis, University College London.
<a href="https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf">https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kgaps">kgaps</a></code> for maximum likelihood estimation of the
extremal index <code class="reqn">\theta</code> using the <code class="reqn">K</code>-gaps model.
</p>
<p><code><a href="#topic+kgaps_imt">kgaps_imt</a></code> for the information matrix test under the
<code class="reqn">K</code>-gaps model
</p>
<p><code><a href="#topic+plot.choose_uk">plot.choose_uk</a></code> to produce the diagnostic plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### S&amp;P 500 index

# Multiple thresholds and run parameters
u &lt;- quantile(sp500, probs = seq(0.1, 0.9, by = 0.1))
imt_theta &lt;- choose_uk(sp500, u = u, k = 1:5)
plot(imt_theta)
plot(imt_theta, uprob = TRUE)
plot(imt_theta, y = "theta")

# One run parameter K, many thresholds u
u &lt;- quantile(sp500, probs = seq(0.1, 0.9, by = 0.1))
imt_theta &lt;- choose_uk(sp500, u = u, k = 1)
plot(imt_theta)
plot(imt_theta, y = "theta")

# One threshold u, many run parameters K
u &lt;- quantile(sp500, probs = 0.9)
imt_theta &lt;- choose_uk(sp500, u = u, k = 1:5)
plot(imt_theta)
plot(imt_theta, y = "theta")

### Newlyn sea surges

u &lt;- quantile(newlyn, probs = seq(0.1, 0.9, by = 0.1))
imt_theta &lt;- choose_uk(newlyn, u = u, k = 1:5)
plot(imt_theta, uprob = TRUE)

### Cheeseboro wind gusts (a matrix containing some NAs)

probs &lt;- c(seq(0.5, 0.95, by = 0.05), 0.99)
u &lt;- quantile(cheeseboro, probs = probs, na.rm = TRUE)
imt_theta &lt;- choose_uk(cheeseboro, u, k = 1:6)
plot(imt_theta, uprob = FALSE, lwd = 2)

### Uccle July temperatures

probs &lt;- c(seq(0.7, 0.95, by = 0.05), 0.99)
u &lt;- quantile(uccle720m, probs = probs, na.rm = TRUE)
imt_theta &lt;- choose_uk(uccle720m, u, k = 1:5)
plot(imt_theta, uprob = TRUE, lwd = 2)
</code></pre>

<hr>
<h2 id='dgaps'>Maximum likelihood estimation using left-censored inter-exceedances times</h2><span id='topic+dgaps'></span>

<h3>Description</h3>

<p>Calculates maximum likelihood estimates of the extremal index <code class="reqn">\theta</code>
based on a model for threshold inter-exceedances times of
Holesovsky and Fusek (2020).  We refer to this as the <code class="reqn">D</code>-gaps model,
because it uses a tuning parameter <code class="reqn">D</code>, whereas the related <code class="reqn">K</code>-gaps
model of Suveges and Davison (2010) has a tuning parameter <code class="reqn">K</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgaps(data, u, D = 1, inc_cens = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dgaps_+3A_data">data</code></td>
<td>
<p>A numeric vector or numeric matrix of raw data.  If <code>data</code>
is a matrix then the log-likelihood is constructed as the sum of
(independent) contributions from different columns. A common situation is
where each column relates to a different year.
</p>
<p>If <code>data</code> contains missing values then <code><a href="#topic+split_by_NAs">split_by_NAs</a></code> is
used to divide the data further into sequences of non-missing values,
stored in different columns in a matrix.  Again, the log-likelihood
is constructed as a sum of contributions from different columns.</p>
</td></tr>
<tr><td><code id="dgaps_+3A_u">u</code></td>
<td>
<p>A numeric scalar.  Extreme value threshold applied to data.</p>
</td></tr>
<tr><td><code id="dgaps_+3A_d">D</code></td>
<td>
<p>A numeric scalar.  The censoring parameter <code class="reqn">D</code>. Threshold
inter-exceedances times that are not larger than <code>D</code> units are
left-censored, occurring with probability
<code class="reqn">\log(1 - \theta e^{-\theta d})</code>,
where <code class="reqn">d = q D</code> and <code class="reqn">q</code> is the probability with which the
threshold <code class="reqn">u</code> is exceeded.</p>
</td></tr>
<tr><td><code id="dgaps_+3A_inc_cens">inc_cens</code></td>
<td>
<p>A logical scalar indicating whether or not to include
contributions from right-censored inter-exceedance times, relating to the
first and last observations. It is known that these times are greater
than or equal to the time observed.
If <code>data</code> has multiple columns then there will be right-censored
first and last inter-exceedance times for each column.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>inc_cens = FALSE</code> then the maximum likelihood estimate of
the extremal index <code class="reqn">\theta</code> under the <code class="reqn">D</code>-gaps model of
Holesovsky and Fusek (2020) is calculated.  Under this model
inter-exceedance times that are less than or equal to <code class="reqn">D</code> are
left-censored, as a strategy to mitigate model mis-specification resulting
from the fact that inter-exceedance times that are equal to 0 are expected
under the model but only positive inter-exceedance times can be observed
in practice.
</p>
<p>If <code>inc_cens = TRUE</code> then information from the right-censored
first and last inter-exceedance times are also included in the likelihood
to be maximized.
For an explanation of the idea see Attalides (2015).  The form of the
log-likelihood is given in the <strong>Details</strong> section of
<code><a href="#topic+dgaps_stat">dgaps_stat</a></code>.
</p>
<p>It is possible that the estimate of <code class="reqn">\theta</code> is equal to 1, and also
possible that it is equal to 0. <code><a href="#topic+dgaps_stat">dgaps_stat</a></code> explains the
respective properties of the data that cause these events to occur.
</p>


<h3>Value</h3>

<p>An object (a list) of class <code>c("dgaps", "exdex")</code> containing
</p>
<table>
<tr><td><code>theta</code></td>
<td>
<p>The maximum likelihood estimate (MLE) of
<code class="reqn">\theta</code>.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>The estimated standard error of the MLE, calculated
using an algebraic expression for the observed information.  If the
estimate of <code class="reqn">\theta</code> is 0 then <code>se</code> is <code>NA</code>.</p>
</td></tr>
<tr><td><code>se_exp</code></td>
<td>
<p>The estimated standard error of the MLE,
calculated using an algebraic expression for the expected information.
If the estimate of <code class="reqn">\theta</code> is 0 then <code>se_exp</code> is <code>NA</code>.
This is provided because cases may be encountered where the observed
information is not positive.</p>
</td></tr>
<tr><td><code>ss</code></td>
<td>
<p>The list of summary statistics returned from
<code><a href="#topic+dgaps_stat">dgaps_stat</a></code>.</p>
</td></tr>
<tr><td><code>D</code>, <code>u</code>, <code>inc_cens</code></td>
<td>
<p>The input values of <code>D</code>,
<code>u</code> and <code>inc_cens</code>.</p>
</td></tr>
<tr><td><code>max_loglik</code></td>
<td>
<p>The value of the log-likelihood at the MLE.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The call to <code>dgaps</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Holesovsky, J. and Fusek, M. Estimation of the extremal index
using censored distributions. Extremes 23, 197-213 (2020).
<a href="https://doi.org/10.1007/s10687-020-00374-3">doi:10.1007/s10687-020-00374-3</a>
</p>
<p>Suveges, M. and Davison, A. C. (2010) Model
misspecification in peaks over threshold analysis, <em>Annals of
Applied Statistics</em>, <strong>4</strong>(1), 203-221.
<a href="https://doi.org/10.1214/09-AOAS292">doi:10.1214/09-AOAS292</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dgaps_confint">dgaps_confint</a></code> to estimate confidence intervals
for <code class="reqn">\theta</code>.
</p>
<p><code><a href="#topic+dgaps_methods">dgaps_methods</a></code> for S3 methods for <code>"dgaps"</code>
objects.
</p>
<p><code><a href="#topic+dgaps_imt">dgaps_imt</a></code> for the information matrix test, which
may be used to inform the choice of the pair (<code>u, D</code>).
</p>
<p><code><a href="#topic+choose_ud">choose_ud</a></code> for a diagnostic plot based on
<code><a href="#topic+dgaps_imt">dgaps_imt</a></code>.
</p>
<p><code><a href="#topic+dgaps_stat">dgaps_stat</a></code> for the calculation of sufficient
statistics for the <code class="reqn">D</code>-gaps model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### S&amp;P 500 index

u &lt;- quantile(sp500, probs = 0.60)
theta &lt;- dgaps(sp500, u = u, D = 1)
theta
summary(theta)
coef(theta)
nobs(theta)
vcov(theta)
logLik(theta)

### Newlyn sea surges

u &lt;- quantile(newlyn, probs = 0.60)
theta &lt;- dgaps(newlyn, u = u, D = 2)
theta
summary(theta)

### Uccle July temperatures

# Using vector input, which merges data from different years
u &lt;- quantile(uccle720$temp, probs = 0.9, na.rm = TRUE)
theta &lt;- dgaps(uccle720$temp, u = u, D = 2)
theta

# Using matrix input to separate data from different years
u &lt;- quantile(uccle720m, probs = 0.9, na.rm = TRUE)
theta &lt;- dgaps(uccle720m, u = u, D = 2)
theta
</code></pre>

<hr>
<h2 id='dgaps_confint'>Confidence intervals for the extremal index <code class="reqn">\theta</code> for <code>"dgaps"</code>
objects</h2><span id='topic+dgaps_confint'></span><span id='topic+confint.dgaps'></span><span id='topic+plot.confint_dgaps'></span><span id='topic+print.confint_dgaps'></span>

<h3>Description</h3>

<p><code>confint</code> method for objects of class <code>c("dgaps", "exdex")</code>.
Computes confidence intervals for <code class="reqn">\theta</code> based on an object returned
from <code><a href="#topic+dgaps">dgaps</a></code>.  Two types of interval may be returned:
(a) intervals based on approximate large-sample normality of the estimator
of <code class="reqn">\theta</code>, which are symmetric about the point estimate,
and (b) likelihood-based intervals. The <code>plot</code> method plots the
log-likelihood for <code class="reqn">\theta</code>, with the required confidence interval
indicated on the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dgaps'
confint(
  object,
  parm = "theta",
  level = 0.95,
  interval_type = c("both", "norm", "lik"),
  conf_scale = c("theta", "log"),
  constrain = TRUE,
  se_type = c("observed", "expected"),
  ...
)

## S3 method for class 'confint_dgaps'
plot(x, ...)

## S3 method for class 'confint_dgaps'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dgaps_confint_+3A_object">object</code></td>
<td>
<p>An object of class <code>c("dgaps", "exdex")</code>, returned by
<code><a href="#topic+dgaps">dgaps</a></code>.</p>
</td></tr>
<tr><td><code id="dgaps_confint_+3A_parm">parm</code></td>
<td>
<p>Specifies which parameter is to be given a confidence interval.
Here there is only one option: the extremal index <code class="reqn">\theta</code>.</p>
</td></tr>
<tr><td><code id="dgaps_confint_+3A_level">level</code></td>
<td>
<p>The confidence level required.  A numeric scalar in (0, 1).</p>
</td></tr>
<tr><td><code id="dgaps_confint_+3A_interval_type">interval_type</code></td>
<td>
<p>A character scalar: <code>"norm"</code> for intervals of
type (a), <code>"lik"</code> for intervals of type (b).</p>
</td></tr>
<tr><td><code id="dgaps_confint_+3A_conf_scale">conf_scale</code></td>
<td>
<p>A character scalar.  If <code>interval_type = "norm"</code> then
<code>conf_scale</code> determines the scale on which we use approximate
large-sample normality of the estimator to estimate confidence intervals.
</p>
<p>If <code>conf_scale = "theta"</code>
then confidence intervals are estimated for <code class="reqn">\theta</code> directly.
If <code>conf_scale = "log"</code> then confidence intervals are first
estimated for <code class="reqn">\log\theta</code> and then transformed back
to the <code class="reqn">\theta</code>-scale.</p>
</td></tr>
<tr><td><code id="dgaps_confint_+3A_constrain">constrain</code></td>
<td>
<p>A logical scalar.  If <code>constrain = TRUE</code> then
any confidence limits that are greater than 1 are set to 1,
that is, they are constrained to lie in (0, 1].  Otherwise,
limits that are greater than 1 may be obtained.
If <code>constrain = TRUE</code> then any lower confidence limits that are
less than 0 are set to 0.</p>
</td></tr>
<tr><td><code id="dgaps_confint_+3A_se_type">se_type</code></td>
<td>
<p>A character scalar. Should the confidence intervals for the
<code>interval_type  = "norm"</code> use the estimated standard error based on
the observed information or based on the expected information?</p>
</td></tr>
<tr><td><code id="dgaps_confint_+3A_...">...</code></td>
<td>
<p><code>plot.confint_dgaps</code>: further arguments passed to
<code><a href="chandwich.html#topic+plot.confint">plot.confint</a></code>.
</p>
<p><code>print.confint_dgaps</code>: further arguments passed to
<code><a href="base.html#topic+print.default">print.default</a></code>.</p>
</td></tr>
<tr><td><code id="dgaps_confint_+3A_x">x</code></td>
<td>
<p>an object of class <code>c("confint_dgaps", "exdex")</code>, a result of
a call to <code><a href="#topic+confint.dgaps">confint.dgaps</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Two type of interval are calculated: (a) an interval based on the
approximate large sample normality of the estimator of <code class="reqn">\theta</code>
(if <code>conf_scale = "theta"</code>) or of <code class="reqn">\log\theta</code>
(if <code>conf_scale = "log"</code>) and (b) a likelihood-based interval,
based on the approximate large sample chi-squared, with 1 degree of
freedom, distribution of the log-likelihood ratio statistic.
</p>
<p><code>print.confint_dgaps</code> prints the matrix of confidence
intervals for <code class="reqn">\theta</code>.
</p>


<h3>Value</h3>

<p>A list of class c(&quot;confint_dgaps&quot;, &quot;exdex&quot;) containing the
following components.
</p>
<table>
<tr><td><code>cis</code></td>
<td>
<p>A matrix with columns giving the lower and upper confidence
limits. These are labelled as (1 - level)/2 and 1 - (1 - level)/2 in
% (by default 2.5% and 97.5%).
The row names indicate the type of interval:
<code>norm</code> for intervals based on large sample normality and <code>lik</code>
for likelihood-based intervals.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The call to <code>spm</code>.</p>
</td></tr>
<tr><td><code>object</code></td>
<td>
<p>The input object <code>object</code>.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>The input <code>level</code>.</p>
</td></tr>
</table>
<p><code>plot.confint_dgaps</code>: nothing is returned.
</p>
<p><code>print.confint_dgaps</code>: the argument <code>x</code>, invisibly.
</p>


<h3>References</h3>

<p>Holesovsky, J. and Fusek, M. Estimation of the extremal index
using censored distributions. Extremes 23, 197-213 (2020).
<a href="https://doi.org/10.1007/s10687-020-00374-3">doi:10.1007/s10687-020-00374-3</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dgaps">dgaps</a></code> for estimation of the extremal index
<code class="reqn">\theta</code> using a semiparametric maxima method.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>u &lt;- quantile(newlyn, probs = 0.90)
theta &lt;- dgaps(newlyn, u)
cis &lt;- confint(theta)
cis
plot(cis)
</code></pre>

<hr>
<h2 id='dgaps_imt'>Information matrix test under the <code class="reqn">D</code>-gaps model</h2><span id='topic+dgaps_imt'></span>

<h3>Description</h3>

<p>Performs an information matrix test (IMT) to diagnose misspecification of
the <code class="reqn">D</code>-gaps model of Holesovsky and Fusek (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgaps_imt(data, u, D = 1, inc_cens = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dgaps_imt_+3A_data">data</code></td>
<td>
<p>A numeric vector or numeric matrix of raw data.  If <code>data</code>
is a matrix then the log-likelihood is constructed as the sum of
(independent) contributions from different columns. A common situation is
where each column relates to a different year.
</p>
<p>If <code>data</code> contains missing values then <code><a href="#topic+split_by_NAs">split_by_NAs</a></code> is
used to divide the data into sequences of non-missing values.</p>
</td></tr>
<tr><td><code id="dgaps_imt_+3A_u">u</code>, <code id="dgaps_imt_+3A_d">D</code></td>
<td>
<p>Numeric vectors.  <code>u</code> is a vector of extreme value
thresholds applied to data.  <code>D</code> is a vector of values of the
left-censoring parameter <code class="reqn">D</code>, as defined in Holesovsky and Fusek
(2020). See <code><a href="#topic+dgaps">dgaps</a></code>.
</p>
<p>Any values in <code>u</code> that are greater than all the observations in
<code>data</code> will be removed without a warning being given.</p>
</td></tr>
<tr><td><code id="dgaps_imt_+3A_inc_cens">inc_cens</code></td>
<td>
<p>A logical scalar indicating whether or not to include
contributions from right-censored inter-exceedance times, relating to the
first and last observations. See <code><a href="#topic+dgaps">dgaps</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The general approach follows Suveges and Davison (2010).
The <code class="reqn">D</code>-gaps IMT is performed a over grid of all
combinations of threshold and <code class="reqn">D</code> in the vectors <code>u</code>
and <code>D</code>.  If the estimate of <code class="reqn">\theta</code> is 0 then the
IMT statistic, and its associated <code class="reqn">p</code>-value is <code>NA</code>.
</p>


<h3>Value</h3>

<p>An object (a list) of class <code>c("dgaps_imt", "exdex")</code>
containing
</p>
<table>
<tr><td><code>imt</code></td>
<td>
<p>A <code>length(u)</code> by <code>length(D)</code> numeric matrix.
Column i contains, for <code class="reqn">D</code> = <code>D[i]</code>, the values of the
information matrix test statistic for the set of thresholds in
<code>u</code>.  The column names are the values in <code>D</code>.
The row names are the approximate empirical percentage quantile levels
of the thresholds in <code>u</code>.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>A <code>length(u)</code> by <code>length(D)</code> numeric matrix
containing the corresponding <code class="reqn">p</code>-values for the test.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>A <code>length(u)</code> by <code>length(D)</code> numeric matrix
containing the corresponding estimates of <code class="reqn">\theta</code>.</p>
</td></tr>
<tr><td><code>u</code>, <code>D</code></td>
<td>
<p>The input <code>u</code> and <code>D</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Holesovsky, J. and Fusek, M. Estimation of the extremal index
using censored distributions. Extremes 23, 197-213 (2020).
<a href="https://doi.org/10.1007/s10687-020-00374-3">doi:10.1007/s10687-020-00374-3</a>
</p>
<p>Suveges, M. and Davison, A. C. (2010) Model
misspecification in peaks over threshold analysis, <em>Annals of
Applied Statistics</em>, <strong>4</strong>(1), 203-221.
<a href="https://doi.org/10.1214/09-AOAS292">doi:10.1214/09-AOAS292</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dgaps">dgaps</a></code> for maximum likelihood estimation of the
extremal index <code class="reqn">\theta</code> using the <code class="reqn">D</code>-gaps model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Newlyn sea surges

u &lt;- quantile(newlyn, probs = seq(0.1, 0.9, by = 0.1))
imt &lt;- dgaps_imt(newlyn, u = u, D = 1:5)

### S&amp;P 500 index

u &lt;- quantile(sp500, probs = seq(0.1, 0.9, by = 0.1))
imt &lt;- dgaps_imt(sp500, u = u, D = 1:5)

### Cheeseboro wind gusts (a matrix containing some NAs)

probs &lt;- c(seq(0.5, 0.98, by = 0.025), 0.99)
u &lt;- quantile(cheeseboro, probs = probs, na.rm = TRUE)
imt &lt;- dgaps_imt(cheeseboro, u = u, D = 1:5)

### Uccle July temperatures

probs &lt;- c(seq(0.7, 0.98, by = 0.025), 0.99)
u &lt;- quantile(uccle720m, probs = probs, na.rm = TRUE)
imt &lt;- dgaps_imt(uccle720m, u = u, D = 1:5)
</code></pre>

<hr>
<h2 id='dgaps_imt_stat'>Statistics for the <code class="reqn">D</code>-gaps information matrix test</h2><span id='topic+dgaps_imt_stat'></span>

<h3>Description</h3>

<p>Calculates the components required to calculate the value of the information
matrix test under the <code class="reqn">D</code>-gaps model, using vector data input.
Called by <code><a href="#topic+dgaps_imt">dgaps_imt</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgaps_imt_stat(data, theta, u, D = 1, inc_cens = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dgaps_imt_stat_+3A_data">data</code></td>
<td>
<p>A numeric vector of raw data.  Missing values are allowed, but
they should not appear between non-missing values, that is, they only be
located at the start and end of the vector.  Missing values are omitted
using <code><a href="stats.html#topic+na.omit">na.omit</a></code>.</p>
</td></tr>
<tr><td><code id="dgaps_imt_stat_+3A_theta">theta</code></td>
<td>
<p>A numeric scalar. An estimate of the extremal index
<code class="reqn">\theta</code>, produced by <code><a href="#topic+dgaps">dgaps</a></code>.</p>
</td></tr>
<tr><td><code id="dgaps_imt_stat_+3A_u">u</code></td>
<td>
<p>A numeric scalar.  Extreme value threshold applied to data.</p>
</td></tr>
<tr><td><code id="dgaps_imt_stat_+3A_d">D</code></td>
<td>
<p>A numeric scalar.  The censoring parameter <code class="reqn">D</code>. Threshold
inter-exceedances times that are not larger than <code>D</code> units are
left-censored, occurring with probability
<code class="reqn">\log(1 - \theta e^{-\theta d})</code>,
where <code class="reqn">d = q D</code> and <code class="reqn">q</code> is the probability with which the
threshold <code class="reqn">u</code> is exceeded.</p>
</td></tr>
<tr><td><code id="dgaps_imt_stat_+3A_inc_cens">inc_cens</code></td>
<td>
<p>A logical scalar indicating whether or not to include
contributions from right-censored inter-exceedance times, relating to the
first and last observations. See <code><a href="#topic+dgaps">dgaps</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list
relating the quantities given on pages 18-19 of
Suveges and Davison (2010).  All but the last component are vectors giving
the contribution to the quantity from each <code class="reqn">D</code>-gap, evaluated at the
input value <code>theta</code> of <code class="reqn">\theta</code>.
</p>
<table>
<tr><td><code>ldj</code></td>
<td>
<p>the derivative of the log-likelihood with respect to
<code class="reqn">\theta</code> (the score)</p>
</td></tr>
<tr><td><code>Ij</code></td>
<td>
<p>the observed information</p>
</td></tr>
<tr><td><code>Jj</code></td>
<td>
<p>the square of the score</p>
</td></tr>
<tr><td><code>dj</code></td>
<td>
<p><code>Jj</code> - <code>Ij</code></p>
</td></tr>
<tr><td><code>Ddj</code></td>
<td>
<p>the derivative of <code>Jj</code> - <code>Ij</code> with respect
to <code class="reqn">\theta</code></p>
</td></tr>
<tr><td><code>n_dgaps</code></td>
<td>
<p>the number of <code class="reqn">D</code>-gaps that contribute to the
log-likelihood.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Holesovsky, J. and Fusek, M. Estimation of the extremal index
using censored distributions. Extremes 23, 197-213 (2020).
<a href="https://doi.org/10.1007/s10687-020-00374-3">doi:10.1007/s10687-020-00374-3</a>
</p>

<hr>
<h2 id='dgaps_methods'>Methods for objects of class <code>"dgaps"</code></h2><span id='topic+dgaps_methods'></span><span id='topic+coef.dgaps'></span><span id='topic+vcov.dgaps'></span><span id='topic+nobs.dgaps'></span><span id='topic+logLik.dgaps'></span><span id='topic+print.dgaps'></span><span id='topic+summary.dgaps'></span><span id='topic+print.summary.dgaps'></span>

<h3>Description</h3>

<p>Methods for objects of class <code>c("dgaps", "exdex")</code> returned from
<code><a href="#topic+dgaps">dgaps</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dgaps'
coef(object, ...)

## S3 method for class 'dgaps'
vcov(object, type = c("observed", "expected"), ...)

## S3 method for class 'dgaps'
nobs(object, ...)

## S3 method for class 'dgaps'
logLik(object, ...)

## S3 method for class 'dgaps'
print(x, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'dgaps'
summary(
  object,
  se_type = c("observed", "expected"),
  digits = max(3, getOption("digits") - 3L),
  ...
)

## S3 method for class 'summary.dgaps'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dgaps_methods_+3A_object">object</code></td>
<td>
<p>and object of class <code>c("dgaps", "exdex")</code> returned from
<code><a href="#topic+dgaps">dgaps</a></code>.</p>
</td></tr>
<tr><td><code id="dgaps_methods_+3A_...">...</code></td>
<td>
<p>For <code>print.summary.dgaps</code>, additional arguments passed to
<code><a href="base.html#topic+print.default">print.default</a></code>.</p>
</td></tr>
<tr><td><code id="dgaps_methods_+3A_type">type</code></td>
<td>
<p>A character scalar. Should the estimate of the variance be based
on the observed information or the expected information?</p>
</td></tr>
<tr><td><code id="dgaps_methods_+3A_x">x</code></td>
<td>
<p><code>print.dgaps</code>. An object of class <code>c("dgaps", "exdex")</code>, a
result of a call to <code><a href="#topic+dgaps">dgaps</a></code>.
</p>
<p><code>print.summary.dgaps</code>. An object of class <code>"summary.dgaps"</code>, a
result of a call to <code><a href="#topic+summary.dgaps">summary.dgaps</a></code>.</p>
</td></tr>
<tr><td><code id="dgaps_methods_+3A_digits">digits</code></td>
<td>
<p><code>print.dgaps</code>. The argument <code>digits</code> to
<code><a href="base.html#topic+print.default">print.default</a></code>.
</p>
<p><code>summary.dgaps</code>. An integer. Used for number formatting with
<code><a href="base.html#topic+Round">signif</a></code>.</p>
</td></tr>
<tr><td><code id="dgaps_methods_+3A_se_type">se_type</code></td>
<td>
<p>A character scalar. Should the estimate of the standard error
be based on the observed information or the expected information?</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>coef.dgaps</code>. A numeric scalar: the estimate of the extremal index
<code class="reqn">\theta</code>.
</p>
<p><code>vcov.dgaps</code>. A <code class="reqn">1 \times 1</code> numeric matrix containing the
estimated variance of the estimator.
</p>
<p><code>nobs.dgaps</code>. A numeric scalar: the number of inter-exceedance times
used in the fit. If <code>x$inc_cens = TRUE</code> then this includes up to 2
censored observations.
</p>
<p><code>logLik.dgaps</code>. An object of class <code>"logLik"</code>: a numeric scalar
with value equal to the maximised log-likelihood.  The returned object
also has attributes <code>nobs</code>, the numbers of <code class="reqn">K</code>-gaps that
contribute to the log-likelihood and <code>"df"</code>, which is equal to the
number of total number of parameters estimated (1).
</p>
<p><code>print.dgaps</code>. The argument <code>x</code>, invisibly.
</p>
<p><code>summary.dgaps</code>. Returns a list containing the list element
<code>object$call</code> and a numeric matrix <code>summary</code> giving the estimate
of the extremal index <code class="reqn">\theta</code> and the estimated standard error
(Std. Error).
</p>
<p><code>print.summary.dgaps</code>. The argument <code>x</code>, invisibly.
</p>


<h3>Examples</h3>

<p>See the examples in <code><a href="#topic+dgaps">dgaps</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dgaps">dgaps</a></code> for maximum likelihood estimation of the
extremal index <code class="reqn">\theta</code> using the <code class="reqn">K</code>-gaps model.
</p>
<p><code><a href="#topic+confint.dgaps">confint.dgaps</a></code> for confidence intervals for
<code class="reqn">\theta</code>.
</p>

<hr>
<h2 id='dgaps_stat'>Sufficient statistics for the left-censored inter-exceedances time model</h2><span id='topic+dgaps_stat'></span>

<h3>Description</h3>

<p>Calculates sufficient statistics for the the left-censored inter-exceedances
time <code class="reqn">D</code>-gaps model for the extremal index <code class="reqn">\theta</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgaps_stat(data, u, q_u, D = 1, inc_cens = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dgaps_stat_+3A_data">data</code></td>
<td>
<p>A numeric vector of raw data.  No missing values are allowed.</p>
</td></tr>
<tr><td><code id="dgaps_stat_+3A_u">u</code></td>
<td>
<p>A numeric scalar.  Extreme value threshold applied to data.</p>
</td></tr>
<tr><td><code id="dgaps_stat_+3A_q_u">q_u</code></td>
<td>
<p>A numeric scalar.  An estimate of the probability with which
the threshold <code>u</code> is exceeded.  If <code>q_u</code> is missing then it is
calculated using <code>mean(data &gt; u, na.rm = TRUE)</code>.</p>
</td></tr>
<tr><td><code id="dgaps_stat_+3A_d">D</code></td>
<td>
<p>A numeric scalar.  Run parameter <code class="reqn">K</code>, as defined in Suveges and
Davison (2010).  Threshold inter-exceedances times that are not larger
than <code>k</code> units are assigned to the same cluster, resulting in a
<code class="reqn">K</code>-gap equal to zero.  Specifically, the <code class="reqn">K</code>-gap <code class="reqn">S</code>
corresponding to an inter-exceedance time of <code class="reqn">T</code> is given by
<code class="reqn">S = \max(T - K, 0)</code>.</p>
</td></tr>
<tr><td><code id="dgaps_stat_+3A_inc_cens">inc_cens</code></td>
<td>
<p>A logical scalar indicating whether or not to include
contributions from right-censored inter-exceedance times relating to the
first and last observation.  It is known that these times are greater
than or equal to the time observed. See Attalides (2015) for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sample inter-exceedance times are
<code class="reqn">T_0, T_1, ..., T_{N-1}, T_N</code>,
where <code class="reqn">T_1, ..., T_{N-1}</code> are uncensored and
<code class="reqn">T_0</code> and <code class="reqn">T_N</code> are right-censored.  Under the assumption that the
inter-exceedance times are independent, the log-likelihood of the
<code class="reqn">D</code>-gaps model is given by
</p>
<p style="text-align: center;"><code class="reqn">l(\theta; T_0, \ldots, T_N) = N_0 \log(1 - \theta e^{-\theta d}) +
    2 N_1 \log \theta - \theta q (I_0 T_0 + \cdots + I_N T_N),</code>
</p>

<p>where
</p>

<ul>
<li> <p><code class="reqn">q</code> is the threshold exceedance probability, estimated by
the proportion of threshold exceedances,
</p>
</li>
<li> <p><code class="reqn">d = q D</code>,
</p>
</li>
<li> <p><code class="reqn">I_j = 1</code> if <code class="reqn">T_j &gt; D</code> and <code class="reqn">I_j = 0</code> otherwise,
</p>
</li>
<li> <p><code class="reqn">N_0</code> is the number of sample inter-exceedance times that
are left-censored, that is, are less than or equal to <code class="reqn">D</code>,
</p>
</li>
<li><p> (apart from an adjustment for the contributions of <code class="reqn">T_0</code> and
<code class="reqn">T_N</code>) <code class="reqn">N_1</code> is the number of inter-exceedance times that
are uncensored, that is, are greater than <code class="reqn">D</code>,
</p>
</li>
<li><p> specifically, if <code>inc_cens = TRUE</code> then <code class="reqn">N_1</code> is equal
to the number of <code class="reqn">T_1, ..., T_{N-1}</code> that are
uncensored plus <code class="reqn">(I_0 + I_N) / 2</code>.
</p>
</li></ul>

<p>The differing treatment of uncensored and censored <code class="reqn">K</code>-gaps reflects
differing contributions to the likelihood. Right-censored
inter-exceedance times whose observed values are less than or equal to
<code class="reqn">D</code> add no information to the likelihood because we do not know to
which part of the likelihood they should contribute.
</p>
<p>If <code class="reqn">N_1 = 0</code> then we are in the degenerate case where there is one
cluster (all inter-exceedance times are left-censored) and the likelihood
is maximized at <code class="reqn">\theta = 0</code>.
</p>
<p>If <code class="reqn">N_0 = 0</code> then all exceedances occur singly (no inter-exceedance
times are left-censored) and the likelihood is maximized at
<code class="reqn">\theta = 1</code>.
</p>


<h3>Value</h3>

<p>A list containing the sufficient statistics, with components
</p>
<table>
<tr><td><code>N0</code></td>
<td>
<p>the number of left-censored inter-exceedance times.</p>
</td></tr>
<tr><td><code>N1</code></td>
<td>
<p>contribution from inter-exceedance times that are not
left-censored (see <strong>Details</strong>).</p>
</td></tr>
<tr><td><code>sum_qtd</code></td>
<td>
<p>the sum of the (scaled) inter-exceedance times
that are not left-censored, that is,
<code class="reqn">q (I_0 T_0 + \cdots + I_N T_N)</code>,
where <code class="reqn">q</code> is estimated by the proportion of threshold
exceedances.</p>
</td></tr>
<tr><td><code>n_dgaps</code></td>
<td>
<p>the number of inter-exceedances that contribute
to the log-likelihood.</p>
</td></tr>
<tr><td><code>q_u</code></td>
<td>
<p>the sample proportion of values that exceed the
threshold.</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>the input value of <code>D</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Holesovsky, J. and Fusek, M. Estimation of the extremal index
using censored distributions. Extremes 23, 197-213 (2020).
<a href="https://doi.org/10.1007/s10687-020-00374-3">doi:10.1007/s10687-020-00374-3</a>
</p>
<p>Attalides, N. (2015) Threshold-based extreme value modelling,
PhD thesis, University College London.
<a href="https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf">https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dgaps">dgaps</a></code> for maximum likelihood estimation of the
extremal index <code class="reqn">\theta</code> using the <code class="reqn">D</code>-gaps model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>u &lt;- quantile(newlyn, probs = 0.90)
dgaps_stat(newlyn, u = u, D = 1)
</code></pre>

<hr>
<h2 id='exdex-internal'>Internal exdex functions</h2><span id='topic+exdex-internal'></span><span id='topic+spm_check'></span><span id='topic+spm_sigmahat_dj'></span><span id='topic+spm_R_quick'></span><span id='topic+ests_sigmahat_dj'></span><span id='topic+log0const_slow'></span><span id='topic+log0const'></span><span id='topic+ecdf3'></span><span id='topic+ecdf2'></span><span id='topic+ecdf1'></span><span id='topic+sliding_maxima'></span><span id='topic+disjoint_maxima'></span><span id='topic+all_disjoint_maxima'></span><span id='topic+all_maxima'></span><span id='topic+kgaps_loglik'></span><span id='topic+kgaps_conf_int'></span><span id='topic+kgaps_quad_solve'></span><span id='topic+kgaps_imt_old'></span><span id='topic+kgaps_exp_info'></span><span id='topic+dgaps_loglik'></span><span id='topic+g_theta'></span><span id='topic+gd_theta'></span><span id='topic+gdd_theta'></span><span id='topic+gddd_theta'></span><span id='topic+dgaps_exp_info'></span><span id='topic+dgaps_conf_int'></span><span id='topic+iwls_fun'></span>

<h3>Description</h3>

<p>Internal exdex functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spm_check(
  data,
  b,
  sliding = TRUE,
  bias_adjust = c("BB3", "BB1", "N", "none"),
  constrain = TRUE,
  varN = TRUE,
  which_dj = c("last", "first")
)

spm_sigmahat_dj(data, b, check = FALSE)

spm_R_quick(
  data,
  b,
  bias_adjust = c("BB3", "BB1", "N", "none"),
  constrain = TRUE,
  varN = TRUE,
  which_dj = c("last", "first")
)

ests_sigmahat_dj(all_max, b, which_dj, bias_adjust)

log0const_slow(x, const)

log0const(x, const)

ecdf3(x, y)

ecdf2(x, y)

ecdf1(x, y, lenx)

sliding_maxima(x, b = 1)

disjoint_maxima(x, b = 1, which_dj = c("first", "last"))

all_disjoint_maxima(x, b = 1, which_dj = c("all", "first", "last"))

all_maxima(x, b = 1, which_dj = c("all", "first", "last"))

kgaps_loglik(theta, N0, N1, sum_qs, n_kgaps)

kgaps_conf_int(theta_mle, ss, conf = 95)

kgaps_quad_solve(N0, N1, sum_qs)

kgaps_imt_old(data, u, k = 1)

kgaps_exp_info(theta, ss, inc_cens)

dgaps_loglik(theta, N0, N1, sum_qtd, n_dgaps, q_u, D)

g_theta(theta, q_u, D)

gd_theta(theta, q_u, D)

gdd_theta(theta, q_u, D)

gddd_theta(theta, q_u, D)

dgaps_exp_info(theta, ss, inc_cens)

dgaps_conf_int(theta_mle, ss, conf = 95)

iwls_fun(n_wls, N, S_1_sort, exp_qs, ws, nx)
</code></pre>


<h3>Details</h3>

<p>These functions are not intended to be called by the user.
</p>

<hr>
<h2 id='iwls'>Iterated weighted least squares estimation of the extremal index</h2><span id='topic+iwls'></span>

<h3>Description</h3>

<p>Estimates the extremal index <code class="reqn">\theta</code> using the iterated weighted least
squares method of Suveges (2007).  At the moment no estimates of
uncertainty are provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iwls(data, u, maxit = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iwls_+3A_data">data</code></td>
<td>
<p>A numeric vector of raw data.  No missing values are allowed.</p>
</td></tr>
<tr><td><code id="iwls_+3A_u">u</code></td>
<td>
<p>A numeric scalar.  Extreme value threshold applied to data.</p>
</td></tr>
<tr><td><code id="iwls_+3A_maxit">maxit</code></td>
<td>
<p>A numeric scalar.  The maximum number of iterations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The iterated weighted least squares algorithm on page 46 of
Suveges (2007) is used to estimate the value of the extremal index.
This approach uses the time <em>gaps</em> between successive exceedances
in the data <code>data</code> of the threshold <code>u</code>.  The <code class="reqn">i</code>th
gap is defined as <code class="reqn">T_i - 1</code>, where <code class="reqn">T_i</code> is the difference in
the occurrence time of exceedance <code class="reqn">i</code> and exceedance <code class="reqn">i + 1</code>.
Therefore, threshold exceedances at adjacent time points produce a gap
of zero.
</p>
<p>The model underlying this approach is an exponential-point mas mixture
for <em>scaled gaps</em>, that is, gaps multiplied by the proportion of
values in  <code>data</code> that exceed <code>u</code>.  Under this model
scaled gaps are zero (&lsquo;within-cluster&rsquo; inter-exceedance times) with
probability <code class="reqn">1 - \theta</code> and otherwise (&lsquo;between-cluster&rsquo;
inter-exceedance times) follow an exponential distribution with mean
<code class="reqn">1 / \theta</code>.
The estimation method is based on fitting the &lsquo;broken stick&rsquo; model of
Ferro (2003) to an exponential quantile-quantile plot of all of the
scaled gaps.  Specifically, the broken stick is a horizontal line
and a line with gradient <code class="reqn">1 / \theta</code> which intersect at
<code class="reqn">(-\log\theta, 0)</code>.  The algorithm on page 46 of
Suveges (2007) uses a weighted least squares minimization applied to
the exponential
part of this model to seek a compromise between the role of <code class="reqn">\theta</code>
as the proportion of inter-exceedance times that are between-cluster
and the reciprocal of the mean of an exponential distribution for these
inter-exceedance times.  The weights (see Ferro (2003)) are based on the
variances of order statistics of a standard exponential sample: larger
order statistics have larger sampling variabilities and therefore
receive smaller weight than smaller order statistics.
</p>
<p>Note that in step (1) of the algorithm on page 46 of Suveges there is a
typo: <code class="reqn">N_c + 1</code> should be <code class="reqn">N</code>, where <code class="reqn">N</code> is the number of
threshold exceedances.  Also, the gaps are scaled as detailed above,
not by their mean.
</p>


<h3>Value</h3>

<p>An object (a list) of class <code>"iwls", "exdex"</code> containing
</p>
<table>
<tr><td><code>theta</code></td>
<td>
<p>The estimate of <code class="reqn">\theta</code>.</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p>A convergence indicator: 0 indicates successful
convergence; 1 indicates that <code>maxit</code> has been reached.</p>
</td></tr>
<tr><td><code>niter</code></td>
<td>
<p>The number of iterations performed.</p>
</td></tr>
<tr><td><code>n_gaps</code></td>
<td>
<p>The number of time gaps between successive
exceedances.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The call to <code>iwls</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Suveges, M. (2007) Likelihood estimation of the extremal
index. <em>Extremes</em>, <strong>10</strong>, 41-55.
<a href="https://doi.org/10.1007/s10687-007-0034-2">doi:10.1007/s10687-007-0034-2</a>
</p>
<p>Ferro, C.A.T. (2003) Statistical methods for clusters of
extreme values. Ph.D. thesis, Lancaster University.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+iwls_methods">iwls_methods</a></code> for S3 methods for <code>"iwls"</code>
objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### S&amp;P 500 index

u &lt;- quantile(sp500, probs = 0.60)
theta &lt;- iwls(sp500, u)
theta
coef(theta)
nobs(theta)

### Newlyn sea surges

u &lt;- quantile(newlyn, probs = 0.90)
theta &lt;- iwls(newlyn, u)
theta
</code></pre>

<hr>
<h2 id='iwls_methods'>Methods for objects of class <code>"iwls"</code></h2><span id='topic+iwls_methods'></span><span id='topic+coef.iwls'></span><span id='topic+nobs.iwls'></span><span id='topic+print.iwls'></span>

<h3>Description</h3>

<p>Methods for objects of class <code>c("iwls", "exdex")</code> returned from
<code><a href="#topic+iwls">iwls</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'iwls'
coef(object, ...)

## S3 method for class 'iwls'
nobs(object, ...)

## S3 method for class 'iwls'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iwls_methods_+3A_object">object</code></td>
<td>
<p>and object of class <code>c("iwls", "exdex")</code> returned from
<code><a href="#topic+iwls">iwls</a></code>.</p>
</td></tr>
<tr><td><code id="iwls_methods_+3A_...">...</code></td>
<td>
<p>Further arguments.  None are used.</p>
</td></tr>
<tr><td><code id="iwls_methods_+3A_x">x</code></td>
<td>
<p>an object of class <code>c("iwls", "exdex")</code>, a result of
a call to <code><a href="#topic+iwls">iwls</a></code>.</p>
</td></tr>
<tr><td><code id="iwls_methods_+3A_digits">digits</code></td>
<td>
<p>The argument <code>digits</code> to <code><a href="base.html#topic+print.default">print.default</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>print.iwls</code> prints the original call to <code><a href="#topic+iwls">iwls</a></code>
and the estimate of the extremal index <code class="reqn">\theta</code>.
</p>


<h3>Value</h3>

<p><code>coef.iwls</code>. A numeric scalar: the estimate of the extremal index
<code class="reqn">\theta</code>.
</p>
<p><code>nobs.iwls</code>. A numeric scalar: the number of inter-exceedance times
used in the fit.
</p>
<p><code>print.iwls</code>. The argument <code>x</code>, invisibly.
</p>


<h3>Examples</h3>

<p>See the examples in <code><a href="#topic+iwls">iwls</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+iwls">iwls</a></code> for maximum likelihood estimation of the
extremal index <code class="reqn">\theta</code> using the <code class="reqn">K</code>-gaps model.
</p>

<hr>
<h2 id='kgaps'>Maximum likelihood estimation for the <code class="reqn">K</code>-gaps model</h2><span id='topic+kgaps'></span>

<h3>Description</h3>

<p>Calculates maximum likelihood estimates of the extremal index <code class="reqn">\theta</code>
based on the <code class="reqn">K</code>-gaps model for threshold inter-exceedances times of
Suveges and Davison (2010).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kgaps(data, u, k = 1, inc_cens = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kgaps_+3A_data">data</code></td>
<td>
<p>A numeric vector or numeric matrix of raw data.  If <code>data</code>
is a matrix then the log-likelihood is constructed as the sum of
(independent) contributions from different columns. A common situation is
where each column relates to a different year.
</p>
<p>If <code>data</code> contains missing values then <code><a href="#topic+split_by_NAs">split_by_NAs</a></code> is
used to divide the data further into sequences of non-missing values,
stored in different columns in a matrix.  Again, the log-likelihood
is constructed as a sum of contributions from different columns.</p>
</td></tr>
<tr><td><code id="kgaps_+3A_u">u</code></td>
<td>
<p>A numeric scalar.  Extreme value threshold applied to data.</p>
</td></tr>
<tr><td><code id="kgaps_+3A_k">k</code></td>
<td>
<p>A non-negative numeric scalar. Run parameter <code class="reqn">K</code>, as defined in
Suveges and Davison (2010).  Threshold inter-exceedances times that are
not larger than <code>k</code> units are assigned to the same cluster, resulting
in a <code class="reqn">K</code>-gap equal to zero. Specifically, the <code class="reqn">K</code>-gap <code class="reqn">S</code>
corresponding to an inter-exceedance time of <code class="reqn">T</code> is given by
<code class="reqn">S = \max(T - K, 0)</code>.  In practice, <code class="reqn">k</code> should
be no smaller than 1, because when <code class="reqn">k</code> is less than 1 the estimate
of <code class="reqn">\theta</code> is always equal to 1.</p>
</td></tr>
<tr><td><code id="kgaps_+3A_inc_cens">inc_cens</code></td>
<td>
<p>A logical scalar indicating whether or not to include
contributions from right-censored inter-exceedance times, relating to the
first and last observations.  It is known that these times are greater
than or equal to the time observed. See Attalides (2015) for details.
If <code>data</code> has multiple columns then there will be right-censored
first and last inter-exceedance times for each column.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>inc_cens = FALSE</code> then the maximum likelihood estimate of
the extremal index <code class="reqn">\theta</code> under the <code class="reqn">K</code>-gaps model of
Suveges and Davison (2010) is calculated.
</p>
<p>If <code>inc_cens = TRUE</code> then information from right-censored
first and last inter-exceedance times is also included in the likelihood
to be maximized, following Attalides (2015).  The form of the
log-likelihood is given in the <strong>Details</strong> section of
<code><a href="#topic+kgaps_stat">kgaps_stat</a></code>.
</p>
<p>It is possible that the estimate of <code class="reqn">\theta</code> is equal to 1, and also
possible that it is equal to 0. <code><a href="#topic+kgaps_stat">kgaps_stat</a></code> explains the
respective properties of the data that cause these events to occur.
</p>


<h3>Value</h3>

<p>An object (a list) of class <code>c("kgaps", "exdex")</code> containing
</p>
<table>
<tr><td><code>theta</code></td>
<td>
<p>The maximum likelihood estimate (MLE) of
<code class="reqn">\theta</code>.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>The estimated standard error of the MLE, calculated
using an algebraic expression for the observed information.
If <code>k = 0</code> then <code>se</code> is returned as <code>0</code>.</p>
</td></tr>
<tr><td><code>se_exp</code></td>
<td>
<p>The estimated standard error of the MLE,
calculated using an algebraic expression for the expected information.
If the estimate of <code class="reqn">\theta</code> is 0 or 1 then <code>se_exp</code> is
<code>NA</code>.</p>
</td></tr>
<tr><td><code>ss</code></td>
<td>
<p>The list of summary statistics returned from
<code><a href="#topic+kgaps_stat">kgaps_stat</a></code>.</p>
</td></tr>
<tr><td><code>k</code>, <code>u</code>, <code>inc_cens</code></td>
<td>
<p>The input values of <code>k</code>,
<code>u</code> and <code>inc_cens</code>.</p>
</td></tr>
<tr><td><code>max_loglik</code></td>
<td>
<p>The value of the log-likelihood at the MLE.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The call to <code>kgaps</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Suveges, M. and Davison, A. C. (2010) Model
misspecification in peaks over threshold analysis, <em>Annals of
Applied Statistics</em>, <strong>4</strong>(1), 203-221.
<a href="https://doi.org/10.1214/09-AOAS292">doi:10.1214/09-AOAS292</a>
</p>
<p>Attalides, N. (2015) Threshold-based extreme value modelling,
PhD thesis, University College London.
<a href="https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf">https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kgaps_confint">kgaps_confint</a></code> to estimate confidence intervals
for <code class="reqn">\theta</code>.
</p>
<p><code><a href="#topic+kgaps_methods">kgaps_methods</a></code> for S3 methods for <code>"kgaps"</code>
objects.
</p>
<p><code><a href="#topic+kgaps_imt">kgaps_imt</a></code> for the information matrix test, which
may be used to inform the choice of the pair (<code>u, k</code>).
</p>
<p><code><a href="#topic+choose_uk">choose_uk</a></code> for a diagnostic plot based on
<code><a href="#topic+kgaps_imt">kgaps_imt</a></code>.
</p>
<p><code><a href="#topic+kgaps_stat">kgaps_stat</a></code> for the calculation of sufficient
statistics for the <code class="reqn">K</code>-gaps model.
</p>
<p><code><a href="revdbayes.html#topic+kgaps_post">kgaps_post</a></code> in the
<code><a href="revdbayes.html#topic+revdbayes">revdbayes</a></code> package for Bayesian inference
about <code class="reqn">\theta</code> using the <code class="reqn">K</code>-gaps model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### S&amp;P 500 index

u &lt;- quantile(sp500, probs = 0.60)
theta &lt;- kgaps(sp500, u)
theta
summary(theta)
coef(theta)
nobs(theta)
vcov(theta)
logLik(theta)

### Newlyn sea surges

u &lt;- quantile(newlyn, probs = 0.60)
theta &lt;- kgaps(newlyn, u, k = 2)
theta
summary(theta)

### Cheeseboro wind gusts

theta &lt;- kgaps(cheeseboro, 45, k = 3)
theta
summary(theta)
</code></pre>

<hr>
<h2 id='kgaps_confint'>Confidence intervals for the extremal index <code class="reqn">\theta</code> for <code>"kgaps"</code>
objects</h2><span id='topic+kgaps_confint'></span><span id='topic+confint.kgaps'></span><span id='topic+plot.confint_kgaps'></span><span id='topic+print.confint_kgaps'></span>

<h3>Description</h3>

<p><code>confint</code> method for objects of class <code>c("kgaps", "exdex")</code>.
Computes confidence intervals for <code class="reqn">\theta</code> based on an object returned
from <code><a href="#topic+kgaps">kgaps</a></code>.  Two types of interval may be returned:
(a) intervals based on approximate large-sample normality of the estimator
of <code class="reqn">\theta</code>, which are symmetric about the point estimate,
and (b) likelihood-based intervals. The <code>plot</code> method plots the
log-likelihood for <code class="reqn">\theta</code>, with the required confidence interval
indicated on the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'kgaps'
confint(
  object,
  parm = "theta",
  level = 0.95,
  interval_type = c("both", "norm", "lik"),
  conf_scale = c("theta", "log"),
  constrain = TRUE,
  se_type = c("observed", "expected"),
  ...
)

## S3 method for class 'confint_kgaps'
plot(x, ...)

## S3 method for class 'confint_kgaps'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kgaps_confint_+3A_object">object</code></td>
<td>
<p>An object of class <code>c("kgaps", "exdex")</code>, returned by
<code><a href="#topic+kgaps">kgaps</a></code>.</p>
</td></tr>
<tr><td><code id="kgaps_confint_+3A_parm">parm</code></td>
<td>
<p>Specifies which parameter is to be given a confidence interval.
Here there is only one option: the extremal index <code class="reqn">\theta</code>.</p>
</td></tr>
<tr><td><code id="kgaps_confint_+3A_level">level</code></td>
<td>
<p>The confidence level required.  A numeric scalar in (0, 1).</p>
</td></tr>
<tr><td><code id="kgaps_confint_+3A_interval_type">interval_type</code></td>
<td>
<p>A character scalar: <code>"norm"</code> for intervals of
type (a), <code>"lik"</code> for intervals of type (b).</p>
</td></tr>
<tr><td><code id="kgaps_confint_+3A_conf_scale">conf_scale</code></td>
<td>
<p>A character scalar.  If <code>interval_type = "norm"</code> then
<code>conf_scale</code> determines the scale on which we use approximate
large-sample normality of the estimator to estimate confidence intervals.
</p>
<p>If <code>conf_scale = "theta"</code>
then confidence intervals are estimated for <code class="reqn">\theta</code> directly.
If <code>conf_scale = "log"</code> then confidence intervals are first
estimated for <code class="reqn">\log\theta</code> and then transformed back
to the <code class="reqn">\theta</code>-scale.</p>
</td></tr>
<tr><td><code id="kgaps_confint_+3A_constrain">constrain</code></td>
<td>
<p>A logical scalar.  If <code>constrain = TRUE</code> then
any confidence limits that are greater than 1 are set to 1,
that is, they are constrained to lie in (0, 1].  Otherwise,
limits that are greater than 1 may be obtained.
If <code>constrain = TRUE</code> then any lower confidence limits that are
less than 0 are set to 0.</p>
</td></tr>
<tr><td><code id="kgaps_confint_+3A_se_type">se_type</code></td>
<td>
<p>A character scalar. Should the confidence intervals for the
<code>interval_type  = "norm"</code> use the estimated standard error based on
the observed information or based on the expected information?</p>
</td></tr>
<tr><td><code id="kgaps_confint_+3A_...">...</code></td>
<td>
<p><code>plot.confint_kgaps</code>: further arguments passed to
<code><a href="chandwich.html#topic+plot.confint">plot.confint</a></code>.
</p>
<p><code>print.confint_kgaps</code>: further arguments passed to
<code><a href="base.html#topic+print.default">print.default</a></code>.</p>
</td></tr>
<tr><td><code id="kgaps_confint_+3A_x">x</code></td>
<td>
<p>an object of class <code>c("confint_kgaps", "exdex")</code>, a result of
a call to <code><a href="#topic+confint.kgaps">confint.kgaps</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Two type of interval are calculated: (a) an interval based on the
approximate large sample normality of the estimator of <code class="reqn">\theta</code>
(if <code>conf_scale = "theta"</code>) or of <code class="reqn">\log\theta</code>
(if <code>conf_scale = "log"</code>) and (b) a likelihood-based interval,
based on the approximate large sample chi-squared, with 1 degree of
freedom, distribution of the log-likelihood ratio statistic.
</p>
<p><code>print.confint_kgaps</code> prints the matrix of confidence
intervals for <code class="reqn">\theta</code>.
</p>


<h3>Value</h3>

<p>A list of class c(&quot;confint_kgaps&quot;, &quot;exdex&quot;) containing the
following components.
</p>
<table>
<tr><td><code>cis</code></td>
<td>
<p>A matrix with columns giving the lower and upper confidence
limits. These are labelled as (1 - level)/2 and 1 - (1 - level)/2 in
% (by default 2.5% and 97.5%).
The row names indicate the type of interval:
<code>norm</code> for intervals based on large sample normality and <code>lik</code>
for likelihood-based intervals.
If <code>object$k = 0</code> then both confidence limits are returned as being
equal to the point estimate of <code class="reqn">\theta</code>.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The call to <code>spm</code>.</p>
</td></tr>
<tr><td><code>object</code></td>
<td>
<p>The input object <code>object</code>.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>The input <code>level</code>.</p>
</td></tr>
</table>
<p><code>plot.confint_kgaps</code>: nothing is returned.  If
<code>x$object$k = 0</code> then no plot is produced.
</p>
<p><code>print.confint_kgaps</code>: the argument <code>x</code>, invisibly.
</p>


<h3>References</h3>

<p>Suveges, M. and Davison, A. C. (2010) Model
misspecification in peaks over threshold analysis, <em>Annals of
Applied Statistics</em>, <strong>4</strong>(1), 203-221.
<a href="https://doi.org/10.1214/09-AOAS292">doi:10.1214/09-AOAS292</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kgaps">kgaps</a></code> for estimation of the extremal index
<code class="reqn">\theta</code> using a semiparametric maxima method.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>u &lt;- quantile(newlyn, probs = 0.90)
theta &lt;- kgaps(newlyn, u)
cis &lt;- confint(theta)
cis
plot(cis)
</code></pre>

<hr>
<h2 id='kgaps_imt'>Information matrix test under the <code class="reqn">K</code>-gaps model</h2><span id='topic+kgaps_imt'></span>

<h3>Description</h3>

<p>Performs the information matrix test (IMT) of Suveges and Davison (2010) to
diagnose misspecification of the <code class="reqn">K</code>-gaps model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kgaps_imt(data, u, k = 1, inc_cens = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kgaps_imt_+3A_data">data</code></td>
<td>
<p>A numeric vector or numeric matrix of raw data.  If <code>data</code>
is a matrix then the log-likelihood is constructed as the sum of
(independent) contributions from different columns. A common situation is
where each column relates to a different year.
</p>
<p>If <code>data</code> contains missing values then <code><a href="#topic+split_by_NAs">split_by_NAs</a></code> is
used to divide the data into sequences of non-missing values.</p>
</td></tr>
<tr><td><code id="kgaps_imt_+3A_u">u</code>, <code id="kgaps_imt_+3A_k">k</code></td>
<td>
<p>Numeric vectors.  <code>u</code> is a vector of extreme value
thresholds applied to data.  <code>k</code> is a vector of values of the run
parameter <code class="reqn">K</code>, as defined in Suveges and Davison (2010).
See <code><a href="#topic+kgaps">kgaps</a></code> for more details.
</p>
<p>Any values in <code>u</code> that are greater than all the observations in
<code>data</code> will be removed without a warning being given.</p>
</td></tr>
<tr><td><code id="kgaps_imt_+3A_inc_cens">inc_cens</code></td>
<td>
<p>A logical scalar indicating whether or not to include
contributions from censored inter-exceedance times, relating to the
first and last observations.  See Attalides (2015) for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code class="reqn">K</code>-gaps IMT is performed a over grid of all
combinations of threshold and <code class="reqn">K</code> in the vectors <code>u</code>
and <code>k</code>.  If the estimate of <code class="reqn">\theta</code> is 0 then the
IMT statistic, and its associated <code class="reqn">p</code>-value is <code>NA</code>.
</p>
<p>For details of the IMT see Suveges and Davison
(2010).  There are some typing errors on pages 18-19 that have been
corrected in producing the code: the penultimate term inside <code>{...}</code>
in the middle equation on page 18 should be <code class="reqn">(c_j(K))^2</code>, as should
the penultimate term in the first equation on page 19; the <code>{...}</code>
bracket should be squared in the 4th equation on page 19; the factor
<code class="reqn">n</code> should be <code class="reqn">N-1</code> in the final equation on page 19.
</p>


<h3>Value</h3>

<p>An object (a list) of class <code>c("kgaps_imt", "exdex")</code>
containing
</p>
<table>
<tr><td><code>imt</code></td>
<td>
<p>A <code>length(u)</code> by <code>length(k)</code> numeric matrix.
Column i contains, for <code class="reqn">K</code> = <code>k[i]</code>, the values of the
information matrix test statistic for the set of thresholds in
<code>u</code>.  The column names are the values in <code>k</code>.
The row names are the approximate empirical percentage quantile levels
of the thresholds in <code>u</code>.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>A <code>length(u)</code> by <code>length(k)</code> numeric matrix
containing the corresponding <code class="reqn">p</code>-values for the test.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>A <code>length(u)</code> by <code>length(k)</code> numeric matrix
containing the corresponding estimates of <code class="reqn">\theta</code>.</p>
</td></tr>
<tr><td><code>u</code>, <code>k</code></td>
<td>
<p>The input <code>u</code> and <code>k</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Suveges, M. and Davison, A. C. (2010) Model
misspecification in peaks over threshold analysis, <em>Annals of
Applied Statistics</em>, <strong>4</strong>(1), 203-221.
<a href="https://doi.org/10.1214/09-AOAS292">doi:10.1214/09-AOAS292</a>
</p>
<p>Attalides, N. (2015) Threshold-based extreme value modelling,
PhD thesis, University College London.
<a href="https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf">https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kgaps">kgaps</a></code> for maximum likelihood estimation of the
extremal index <code class="reqn">\theta</code> using the <code class="reqn">K</code>-gaps model.
</p>
<p><code><a href="#topic+choose_uk">choose_uk</a></code> for graphical diagnostic to aid the choice
of the threshold <code class="reqn">u</code> and the run parameter <code class="reqn">K</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Newlyn sea surges

u &lt;- quantile(newlyn, probs = seq(0.1, 0.9, by = 0.1))
imt &lt;- kgaps_imt(newlyn, u = u, k = 1:5)

### S&amp;P 500 index

u &lt;- quantile(sp500, probs = seq(0.1, 0.9, by = 0.1))
imt &lt;- kgaps_imt(sp500, u = u, k = 1:5)

### Cheeseboro wind gusts (a matrix containing some NAs)

probs &lt;- c(seq(0.5, 0.98, by = 0.025), 0.99)
u &lt;- quantile(cheeseboro, probs = probs, na.rm = TRUE)
imt &lt;- kgaps_imt(cheeseboro, u = u, k = 1:5)
</code></pre>

<hr>
<h2 id='kgaps_imt_stat'>Statistics for the information matrix test</h2><span id='topic+kgaps_imt_stat'></span>

<h3>Description</h3>

<p>Calculates the components required to calculate the value of the information
matrix test under the <code class="reqn">K</code>-gaps model, using vector data input.
Called by <code><a href="#topic+kgaps_imt">kgaps_imt</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kgaps_imt_stat(data, theta, u, k = 1, inc_cens = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kgaps_imt_stat_+3A_data">data</code></td>
<td>
<p>A numeric vector of raw data.  Missing values are allowed, but
they should not appear between non-missing values, that is, they only be
located at the start and end of the vector.  Missing values are omitted
using <code><a href="stats.html#topic+na.omit">na.omit</a></code>.</p>
</td></tr>
<tr><td><code id="kgaps_imt_stat_+3A_theta">theta</code></td>
<td>
<p>A numeric scalar. An estimate of the extremal index
<code class="reqn">\theta</code>, produced by <code><a href="#topic+kgaps">kgaps</a></code>.</p>
</td></tr>
<tr><td><code id="kgaps_imt_stat_+3A_u">u</code></td>
<td>
<p>A numeric scalar.  Extreme value threshold applied to data.</p>
</td></tr>
<tr><td><code id="kgaps_imt_stat_+3A_k">k</code></td>
<td>
<p>A numeric scalar.  Run parameter <code class="reqn">K</code>, as defined in Suveges and
Davison (2010).  Threshold inter-exceedances times that are not larger
than <code>k</code> units are assigned to the same cluster, resulting in a
<code class="reqn">K</code>-gap equal to zero.  Specifically, the <code class="reqn">K</code>-gap <code class="reqn">S</code>
corresponding to an inter-exceedance time of <code class="reqn">T</code> is given by
<code class="reqn">S = \max(T - K, 0)</code>.</p>
</td></tr>
<tr><td><code id="kgaps_imt_stat_+3A_inc_cens">inc_cens</code></td>
<td>
<p>A logical scalar indicating whether or not to include
contributions from censored inter-exceedance times relating to the
first and last observation.  See Attalides (2015) for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list relating the quantities given on pages 18-19 of
Suveges and Davison (2010).  All but the last component are vectors giving
the contribution to the quantity from each <code class="reqn">K</code>-gap, evaluated at the
input value <code>theta</code> of <code class="reqn">\theta</code>.
</p>
<table>
<tr><td><code>ldj</code></td>
<td>
<p>the derivative of the log-likelihood with respect to
<code class="reqn">\theta</code> (the score)</p>
</td></tr>
<tr><td><code>Ij</code></td>
<td>
<p>the observed information</p>
</td></tr>
<tr><td><code>Jj</code></td>
<td>
<p>the square of the score</p>
</td></tr>
<tr><td><code>dj</code></td>
<td>
<p><code>Jj</code> - <code>Ij</code></p>
</td></tr>
<tr><td><code>Ddj</code></td>
<td>
<p>the derivative of <code>Jj</code> - <code>Ij</code> with respect
to <code class="reqn">\theta</code></p>
</td></tr>
<tr><td><code>n_kgaps</code></td>
<td>
<p>the number of <code class="reqn">K</code>-gaps that contribute to the
log-likelihood.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Suveges, M. and Davison, A. C. (2010) Model
misspecification in peaks over threshold analysis, <em>Annals of
Applied Statistics</em>, <strong>4</strong>(1), 203-221.
<a href="https://doi.org/10.1214/09-AOAS292">doi:10.1214/09-AOAS292</a>
</p>
<p>Attalides, N. (2015) Threshold-based extreme value modelling,
PhD thesis, University College London.
<a href="https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf">https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf</a>
</p>

<hr>
<h2 id='kgaps_methods'>Methods for objects of class <code>"kgaps"</code></h2><span id='topic+kgaps_methods'></span><span id='topic+coef.kgaps'></span><span id='topic+vcov.kgaps'></span><span id='topic+nobs.kgaps'></span><span id='topic+logLik.kgaps'></span><span id='topic+print.kgaps'></span><span id='topic+summary.kgaps'></span><span id='topic+print.summary.kgaps'></span>

<h3>Description</h3>

<p>Methods for objects of class <code>c("kgaps", "exdex")</code> returned from
<code><a href="#topic+kgaps">kgaps</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'kgaps'
coef(object, ...)

## S3 method for class 'kgaps'
vcov(object, type = c("observed", "expected"), ...)

## S3 method for class 'kgaps'
nobs(object, ...)

## S3 method for class 'kgaps'
logLik(object, ...)

## S3 method for class 'kgaps'
print(x, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'kgaps'
summary(
  object,
  se_type = c("observed", "expected"),
  digits = max(3, getOption("digits") - 3L),
  ...
)

## S3 method for class 'summary.kgaps'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kgaps_methods_+3A_object">object</code></td>
<td>
<p>and object of class <code>c("kgaps", "exdex")</code> returned from
<code><a href="#topic+kgaps">kgaps</a></code>.</p>
</td></tr>
<tr><td><code id="kgaps_methods_+3A_...">...</code></td>
<td>
<p>For <code>print.summary.kgaps</code>, additional arguments passed to
<code><a href="base.html#topic+print.default">print.default</a></code>.</p>
</td></tr>
<tr><td><code id="kgaps_methods_+3A_type">type</code></td>
<td>
<p>A character scalar. Should the estimate of the variance be based
on the observed information or the expected information?</p>
</td></tr>
<tr><td><code id="kgaps_methods_+3A_x">x</code></td>
<td>
<p><code>print.kgaps</code>. An object of class <code>c("kgaps", "exdex")</code>, a
result of a call to <code><a href="#topic+kgaps">kgaps</a></code>.
</p>
<p><code>print.summary.kgaps</code>. An object of class <code>"summary.kgaps"</code>, a
result of a call to <code><a href="#topic+summary.kgaps">summary.kgaps</a></code>.</p>
</td></tr>
<tr><td><code id="kgaps_methods_+3A_digits">digits</code></td>
<td>
<p><code>print.kgaps</code>. The argument <code>digits</code> to
<code><a href="base.html#topic+print.default">print.default</a></code>.
</p>
<p><code>summary.kgaps</code>. An integer. Used for number formatting with
<code><a href="base.html#topic+Round">signif</a></code>.</p>
</td></tr>
<tr><td><code id="kgaps_methods_+3A_se_type">se_type</code></td>
<td>
<p>A character scalar. Should the estimate of the standard error
be based on the observed information or the expected information?</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>coef.kgaps</code>. A numeric scalar: the estimate of the extremal index
<code class="reqn">\theta</code>.
</p>
<p><code>vcov.kgaps</code>. A <code class="reqn">1 \times 1</code> numeric matrix containing the
estimated variance of the estimator.
</p>
<p><code>nobs.kgaps</code>. A numeric scalar: the number of inter-exceedance times
used in the fit. If <code>x$inc_cens = TRUE</code> then this includes up to 2
censored observations.
</p>
<p><code>logLik.kgaps</code>. An object of class <code>"logLik"</code>: a numeric scalar
with value equal to the maximised log-likelihood.  The returned object
also has attributes <code>nobs</code>, the numbers of <code class="reqn">K</code>-gaps that
contribute to the log-likelihood and <code>"df"</code>, which is equal to the
number of total number of parameters estimated (1).
</p>
<p><code>print.kgaps</code>. The argument <code>x</code>, invisibly.
</p>
<p><code>summary.kgaps</code>. Returns a list containing the list element
<code>object$call</code> and a numeric matrix <code>summary</code> giving the estimate
of the extremal index <code class="reqn">\theta</code> and the estimated standard error
(Std. Error).
</p>
<p><code>print.summary.kgaps</code>. The argument <code>x</code>, invisibly.
</p>


<h3>Examples</h3>

<p>See the examples in <code><a href="#topic+kgaps">kgaps</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kgaps">kgaps</a></code> for maximum likelihood estimation of the
extremal index <code class="reqn">\theta</code> using the <code class="reqn">K</code>-gaps model.
</p>
<p><code><a href="#topic+confint.kgaps">confint.kgaps</a></code> for confidence intervals for
<code class="reqn">\theta</code>.
</p>

<hr>
<h2 id='kgaps_stat'>Sufficient statistics for the <code class="reqn">K</code>-gaps model</h2><span id='topic+kgaps_stat'></span>

<h3>Description</h3>

<p>Calculates sufficient statistics for the <code class="reqn">K</code>-gaps model for the extremal
index <code class="reqn">\theta</code>. Called by <code><a href="#topic+kgaps">kgaps</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kgaps_stat(data, u, q_u, k = 1, inc_cens = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kgaps_stat_+3A_data">data</code></td>
<td>
<p>A numeric vector of raw data.</p>
</td></tr>
<tr><td><code id="kgaps_stat_+3A_u">u</code></td>
<td>
<p>A numeric scalar.  Extreme value threshold applied to data.</p>
</td></tr>
<tr><td><code id="kgaps_stat_+3A_q_u">q_u</code></td>
<td>
<p>A numeric scalar.  An estimate of the probability with which
the threshold <code>u</code> is exceeded.  If <code>q_u</code> is missing then it is
calculated using <code>mean(data &gt; u, na.rm = TRUE)</code>.</p>
</td></tr>
<tr><td><code id="kgaps_stat_+3A_k">k</code></td>
<td>
<p>A numeric scalar.  Run parameter <code class="reqn">K</code>, as defined in Suveges and
Davison (2010).  Threshold inter-exceedances times that are not larger
than <code>k</code> units are assigned to the same cluster, resulting in a
<code class="reqn">K</code>-gap equal to zero.  Specifically, the <code class="reqn">K</code>-gap <code class="reqn">S</code>
corresponding to an inter-exceedance time of <code class="reqn">T</code> is given by
<code class="reqn">S = \max(T - K, 0)</code>.</p>
</td></tr>
<tr><td><code id="kgaps_stat_+3A_inc_cens">inc_cens</code></td>
<td>
<p>A logical scalar indicating whether or not to include
contributions from right-censored inter-exceedance times relating to the
first and last observation.  It is known that these times are greater
than or equal to the time observed. See Attalides (2015) for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sample <code class="reqn">K</code>-gaps are
<code class="reqn">S_0, S_1, ..., S_{N-1}, S_N</code>,
where <code class="reqn">S_1, ..., S_{N-1}</code> are uncensored and
<code class="reqn">S_0</code> and <code class="reqn">S_N</code> are right-censored.  Under the assumption that the
<code class="reqn">K</code>-gaps are independent, the log-likelihood of the <code class="reqn">K</code>-gaps
model is given by
</p>
<p style="text-align: center;"><code class="reqn">l(\theta; S_0, \ldots, S_N) = N_0 \log(1 - \theta) +
    2 N_1 \log \theta - \theta q (S_0 + \cdots + S_N),</code>
</p>

<p>where
</p>

<ul>
<li> <p><code class="reqn">q</code> is the threshold exceedance probability, estimated by
the proportion of threshold exceedances,
</p>
</li>
<li> <p><code class="reqn">N_0</code> is the number of uncensored sample <code class="reqn">K</code>-gaps that
are equal to zero,
</p>
</li>
<li><p> (apart from an adjustment for the contributions of <code class="reqn">S_0</code>
and <code class="reqn">S_N</code>) <code class="reqn">N_1</code> is the number of positive sample
<code class="reqn">K</code>-gaps,
</p>
</li>
<li><p> specifically, if <code>inc_cens = TRUE</code> then <code class="reqn">N_1</code> is equal
to the number of <code class="reqn">S_1, ..., S_{N-1}</code>
that are positive plus <code class="reqn">(I_0 + I_N) / 2</code>, where <code class="reqn">I_0 = 1</code> if
<code class="reqn">S_0</code> is greater than zero and <code class="reqn">I_0 = 0</code> otherwise, and
similarly for <code class="reqn">I_N</code>.
</p>
</li></ul>

<p>The differing treatment of uncensored and right-censored <code class="reqn">K</code>-gaps
reflects differing contributions to the likelihood.  Right-censored
<code class="reqn">K</code>-gaps that are equal to zero add no information to the likelihood.
For full details see Suveges and Davison (2010) and Attalides (2015).
</p>
<p>If <code class="reqn">N_1 = 0</code> then we are in the degenerate case where there is one
cluster (all <code class="reqn">K</code>-gaps are zero) and the likelihood is maximized at
<code class="reqn">\theta = 0</code>.
</p>
<p>If <code class="reqn">N_0 = 0</code> then all exceedances occur singly (all <code class="reqn">K</code>-gaps are
positive) and the likelihood is maximized at <code class="reqn">\theta = 1</code>.
</p>


<h3>Value</h3>

<p>A list containing the sufficient statistics, with components
</p>
<table>
<tr><td><code>N0</code></td>
<td>
<p>the number of zero <code class="reqn">K</code>-gaps.</p>
</td></tr>
<tr><td><code>N1</code></td>
<td>
<p>contribution from non-zero <code class="reqn">K</code>-gaps (see
<strong>Details</strong>).</p>
</td></tr>
<tr><td><code>sum_qs</code></td>
<td>
<p>the sum of the (scaled) <code class="reqn">K</code>-gaps, that is,
<code class="reqn">q (S_0 + \cdots + S_N)</code>, where <code class="reqn">q</code>
is estimated by the proportion of threshold exceedances.</p>
</td></tr>
<tr><td><code>n_kgaps</code></td>
<td>
<p>the number of <code class="reqn">K</code>-gaps that contribute to the
log-likelihood.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Suveges, M. and Davison, A. C. (2010) Model
misspecification in peaks over threshold analysis, <em>Annals of
Applied Statistics</em>, <strong>4</strong>(1), 203-221.
<a href="https://doi.org/10.1214/09-AOAS292">doi:10.1214/09-AOAS292</a>
</p>
<p>Attalides, N. (2015) Threshold-based extreme value modelling,
PhD thesis, University College London.
<a href="https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf">https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kgaps">kgaps</a></code> for maximum likelihood estimation of the
extremal index <code class="reqn">\theta</code> using the <code class="reqn">K</code>-gaps model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>u &lt;- quantile(newlyn, probs = 0.90)
kgaps_stat(newlyn, u)
</code></pre>

<hr>
<h2 id='newlyn'>Newlyn sea surges</h2><span id='topic+newlyn'></span>

<h3>Description</h3>

<p>The vector <code>newlyn</code> contains 2894 maximum sea-surges measured at
Newlyn, Cornwall, UK over the period 1971-1976. The observations are
the maximum hourly sea-surge heights over contiguous 15-hour time
periods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>newlyn
</code></pre>


<h3>Format</h3>

<p>A vector of length 2894.
</p>


<h3>Source</h3>

<p>Coles, S.G. (1991) Modelling extreme multivariate events. PhD thesis,
University of Sheffield, U.K.
</p>


<h3>References</h3>

<p>Fawcett, L. and Walshaw, D. (2012) Estimating return levels from
serially dependent extremes. <em>Environmetrics</em>, <strong>23</strong>(3),
272-283.  <a href="https://doi.org/10.1002/env.2133">doi:10.1002/env.2133</a>
</p>
<p>Northrop, P. J. (2015) An efficient semiparametric maxima
estimator of the extremal index. <em>Extremes</em>, <strong>18</strong>,
585-603.  <a href="https://doi.org/10.1007/s10687-015-0221-5">doi:10.1007/s10687-015-0221-5</a>
</p>

<hr>
<h2 id='plot.choose_b'>Plot block length diagnostic for the semiparametric maxima estimator</h2><span id='topic+plot.choose_b'></span>

<h3>Description</h3>

<p><code>plot</code> method for objects inheriting from class <code>"choose_b"</code>,
returned from <code><a href="#topic+choose_b">choose_b</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'choose_b'
plot(
  x,
  y,
  ...,
  estimator = c("N2015", "BB2018"),
  maxima = c("sliding", "disjoint")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.choose_b_+3A_x">x</code></td>
<td>
<p>an object of class <code>c("choose_b", "exdex")</code>, a result of a
call to <code><a href="#topic+choose_b">choose_b</a></code>.</p>
</td></tr>
<tr><td><code id="plot.choose_b_+3A_y">y</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="plot.choose_b_+3A_...">...</code></td>
<td>
<p>Additional arguments passed on to
<code><a href="graphics.html#topic+matplot">matplot</a></code> and/or <code><a href="graphics.html#topic+axis">axis</a></code>.</p>
</td></tr>
<tr><td><code id="plot.choose_b_+3A_estimator">estimator</code></td>
<td>
<p>Choice of estimator: <code>"N2015"</code> for Northrop (2015),
<code>"BB2018"</code> for Berghaus and Bucher (2018).
See <code><a href="#topic+spm">spm</a></code> for details.</p>
</td></tr>
<tr><td><code id="plot.choose_b_+3A_maxima">maxima</code></td>
<td>
<p>Should the estimator be based on sliding or disjoint maxima?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Produces a simple diagnostic plot to aid the choice of block
length <code class="reqn">b</code> based on the object returned from <code><a href="#topic+choose_b">choose_b</a></code>.
Estimates of <code class="reqn">b</code> and approximate <code>conf</code>% confidence intervals
are plotted against the value of <code class="reqn">b</code> used to produce each estimate.
The type of confidence interval is determined by the arguments
<code>interval_type</code>, <code>conf_scale</code> and <code>type</code> provided in the
call to <code><a href="#topic+choose_b">choose_b</a></code>.
</p>


<h3>Value</h3>

<p>Nothing is returned.
</p>


<h3>Examples</h3>

<p>See the examples in <code><a href="#topic+choose_b">choose_b</a></code>.
</p>


<h3>References</h3>

<p>Northrop, P. J. (2015) An efficient semiparametric maxima
estimator of the extremal index. <em>Extremes</em> <strong>18</strong>(4), 585-603.
<a href="https://doi.org/10.1007/s10687-015-0221-5">doi:10.1007/s10687-015-0221-5</a>
</p>
<p>Berghaus, B., Bucher, A. (2018) Weak convergence of a pseudo
maximum likelihood estimator for the extremal index. <em>Ann. Statist.</em>
<strong>46</strong>(5), 2307-2335. <a href="https://doi.org/10.1214/17-AOS1621">doi:10.1214/17-AOS1621</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+choose_b">choose_b</a></code>.
</p>

<hr>
<h2 id='plot.choose_ud'>Plot threshold <code class="reqn">u</code> and runs parameter <code class="reqn">D</code> diagnostic for the
<code class="reqn">D</code>-gaps estimator</h2><span id='topic+plot.choose_ud'></span>

<h3>Description</h3>

<p><code>plot</code> method for objects inheriting from class <code>"choose_ud"</code>,
returned from <code><a href="#topic+choose_ud">choose_ud</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'choose_ud'
plot(
  x,
  y = c("imts", "theta"),
  level = 0.95,
  interval_type = c("norm", "lik"),
  conf_scale = c("theta", "log"),
  alpha = 0.05,
  constrain = TRUE,
  for_abline = list(lty = 2, lwd = 1, col = 1),
  digits = 3,
  uprob = FALSE,
  leg_pos = if (y == "imts") "topright" else "topleft",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.choose_ud_+3A_x">x</code></td>
<td>
<p>an object of class <code>c("choose_ud", "exdex")</code>, a result of a
call to <code><a href="#topic+choose_ud">choose_ud</a></code>.</p>
</td></tr>
<tr><td><code id="plot.choose_ud_+3A_y">y</code></td>
<td>
<p>A character scalar indicating what should be plotted on the
vertical axes of the plot: information matrix test statistics (IMTS)
if <code>y = "imts"</code> and estimates of <code class="reqn">\theta</code> if <code>y = "theta"</code>.
If <code>y = "theta"</code>, and either <code>x$u</code> or <code>x$D</code> have length
one, then 100<code>level</code>% confidence intervals are added to the plot.</p>
</td></tr>
<tr><td><code id="plot.choose_ud_+3A_level">level</code></td>
<td>
<p>A numeric scalar in (0, 1).  The confidence level used in
calculating confidence intervals for <code class="reqn">\theta</code>.  Only relevant if
<code>y = "theta"</code> and either <code>x$u</code> or <code>x$D</code> have length one.</p>
</td></tr>
<tr><td><code id="plot.choose_ud_+3A_interval_type">interval_type</code></td>
<td>
<p>A character scalar.  The type of confidence interval
to be plotted, if <code>y = "theta"</code>.  See <code><a href="#topic+confint.dgaps">confint.dgaps</a></code>.</p>
</td></tr>
<tr><td><code id="plot.choose_ud_+3A_conf_scale">conf_scale</code></td>
<td>
<p>A character scalar.  If <code>interval_type = "norm"</code> then
<code>conf_scale</code> determines the scale on which we use approximate
large-sample normality of the estimator to estimate confidence intervals.
See <code><a href="#topic+confint.dgaps">confint.dgaps</a></code>.</p>
</td></tr>
<tr><td><code id="plot.choose_ud_+3A_alpha">alpha</code></td>
<td>
<p>A numeric vector with entries in (0, 1). The size of the test
to be performed.</p>
</td></tr>
<tr><td><code id="plot.choose_ud_+3A_constrain">constrain</code></td>
<td>
<p>A logical scalar.  The argument <code>constrain</code> to
<code><a href="#topic+confint.dgaps">confint.dgaps</a></code>.</p>
</td></tr>
<tr><td><code id="plot.choose_ud_+3A_for_abline">for_abline</code></td>
<td>
<p>Only relevant when <code>y = "imts"</code> and at one of
<code>u</code> or <code>D</code> is scalar. A list of graphical parameters to be
passed to <code><a href="graphics.html#topic+abline">abline</a></code> to indicate the critical value of the
information matrix test (IMT) implied by <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="plot.choose_ud_+3A_digits">digits</code></td>
<td>
<p>An integer. Used for formatting the value of the threshold
with <code><a href="base.html#topic+Round">signif</a></code> before adding its value to a plot.</p>
</td></tr>
<tr><td><code id="plot.choose_ud_+3A_uprob">uprob</code></td>
<td>
<p>A logical scalar. Should we plot <code>x$u</code> on the
horizontal axis (<code>uprob = FALSE</code>) or the approximate sample quantile
to which <code>x$u</code> corresponds (<code>uprob = TRUE</code>)?</p>
</td></tr>
<tr><td><code id="plot.choose_ud_+3A_leg_pos">leg_pos</code></td>
<td>
<p>A character scalar.  The position of any legend added to
a plot.  Only relevant when both the arguments <code>u</code> and <code>D</code>
in the call to <code><a href="#topic+choose_ud">choose_ud</a></code> have length greater than one.</p>
</td></tr>
<tr><td><code id="plot.choose_ud_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="graphics.html#topic+matplot">matplot</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The type of plot produced depends mainly on <code>y</code>.
</p>
<p>If <code>y = "imts"</code> then the values of IMTS are plotted against the
thresholds in <code>x$u</code> (or their corresponding approximate sample
quantile levels if <code>uprob = TRUE</code>) for each value of <code class="reqn">D</code>
in <code>x$D</code>.  Horizontal lines are added to indicate the critical
values of the IMT for the significance levels in <code>alpha</code>.
We would not reject at the 100<code>alpha</code>% level combinations of
threshold and <code class="reqn">D</code> corresponding to values of the IMTS that fall
below the line.
</p>
<p>If <code>y = "theta"</code> then estimates of <code class="reqn">\theta</code> are plotted on the
vertical axis.  If both <code>x$u</code> and <code>x$D$</code> have length greater
than one then only these estimates are plotted.  If either <code>x$u</code>
or <code>x$D</code> have length one then approximate 100<code>level</code>%
confidence intervals are added to the plot and the variable,
<code>x$u</code> or <code>x$D</code> that has length greater than one is plotted on
the horizontal axis.
</p>


<h3>Value</h3>

<p>Nothing is returned.
</p>


<h3>Examples</h3>

<p>See the examples in <code><a href="#topic+choose_ud">choose_ud</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+choose_ud">choose_ud</a></code>.
</p>

<hr>
<h2 id='plot.choose_uk'>Plot threshold <code class="reqn">u</code> and runs parameter <code class="reqn">K</code> diagnostic for the
<code class="reqn">K</code>-gaps estimator</h2><span id='topic+plot.choose_uk'></span>

<h3>Description</h3>

<p><code>plot</code> method for objects inheriting from class <code>"choose_uk"</code>,
returned from <code><a href="#topic+choose_uk">choose_uk</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'choose_uk'
plot(
  x,
  y = c("imts", "theta"),
  level = 0.95,
  interval_type = c("norm", "lik"),
  conf_scale = c("theta", "log"),
  alpha = 0.05,
  constrain = TRUE,
  for_abline = list(lty = 2, lwd = 1, col = 1),
  digits = 3,
  uprob = FALSE,
  leg_pos = if (y == "imts") "topright" else "topleft",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.choose_uk_+3A_x">x</code></td>
<td>
<p>an object of class <code>c("choose_uk", "exdex")</code>, a result of a
call to <code><a href="#topic+choose_uk">choose_uk</a></code>.</p>
</td></tr>
<tr><td><code id="plot.choose_uk_+3A_y">y</code></td>
<td>
<p>A character scalar indicating what should be plotted on the
vertical axes of the plot: information matrix test statistics (IMTS)
if <code>y = "imts"</code> and estimates of <code class="reqn">\theta</code> if <code>y = "theta"</code>.
If <code>y = "theta"</code>, and either <code>x$u</code> or <code>x$k</code> have length
one, then 100<code>level</code>% confidence intervals are added to the plot.</p>
</td></tr>
<tr><td><code id="plot.choose_uk_+3A_level">level</code></td>
<td>
<p>A numeric scalar in (0, 1).  The confidence level used in
calculating confidence intervals for <code class="reqn">\theta</code>.  Only relevant if
<code>y = "theta"</code> and either <code>x$u</code> or <code>x$k</code> have length one.</p>
</td></tr>
<tr><td><code id="plot.choose_uk_+3A_interval_type">interval_type</code></td>
<td>
<p>A character scalar.  The type of confidence interval
to be plotted, if <code>y = "theta"</code>.  See <code><a href="#topic+confint.kgaps">confint.kgaps</a></code>.</p>
</td></tr>
<tr><td><code id="plot.choose_uk_+3A_conf_scale">conf_scale</code></td>
<td>
<p>A character scalar.  If <code>interval_type = "norm"</code> then
<code>conf_scale</code> determines the scale on which we use approximate
large-sample normality of the estimator to estimate confidence intervals.
See <code><a href="#topic+confint.kgaps">confint.kgaps</a></code>.</p>
</td></tr>
<tr><td><code id="plot.choose_uk_+3A_alpha">alpha</code></td>
<td>
<p>A numeric vector with entries in (0, 1). The size of the test
to be performed.</p>
</td></tr>
<tr><td><code id="plot.choose_uk_+3A_constrain">constrain</code></td>
<td>
<p>A logical scalar.  The argument <code>constrain</code> to
<code><a href="#topic+confint.kgaps">confint.kgaps</a></code>.</p>
</td></tr>
<tr><td><code id="plot.choose_uk_+3A_for_abline">for_abline</code></td>
<td>
<p>Only relevant when <code>y = "imts"</code> and at one of
<code>u</code> or <code>k</code> is scalar. A list of graphical parameters to be
passed to <code><a href="graphics.html#topic+abline">abline</a></code> to indicate the critical value of the
information matrix test (IMT) implied by <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="plot.choose_uk_+3A_digits">digits</code></td>
<td>
<p>An integer. Used for formatting the value of the threshold
with <code><a href="base.html#topic+Round">signif</a></code> before adding its value to a plot.</p>
</td></tr>
<tr><td><code id="plot.choose_uk_+3A_uprob">uprob</code></td>
<td>
<p>A logical scalar. Should we plot <code>x$u</code> on the
horizontal axis (<code>uprob = FALSE</code>) or the approximate sample quantile
to which <code>x$u</code> corresponds (<code>uprob = TRUE</code>)?</p>
</td></tr>
<tr><td><code id="plot.choose_uk_+3A_leg_pos">leg_pos</code></td>
<td>
<p>A character scalar.  The position of any legend added to
a plot.  Only relevant when both the arguments <code>u</code> and <code>k</code>
in the call to <code><a href="#topic+choose_uk">choose_uk</a></code> have length greater than one.</p>
</td></tr>
<tr><td><code id="plot.choose_uk_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="graphics.html#topic+matplot">matplot</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The type of plot produced depends mainly on <code>y</code>.
</p>
<p>If <code>y = "imts"</code> then the values of IMTS are plotted against the
thresholds in <code>x$u</code> (or their corresponding approximate sample
quantile levels if <code>uprob = TRUE</code>) for each value of <code class="reqn">K</code>
in <code>x$k</code>.  Horizontal lines are added to indicate the critical
values of the IMT for the significance levels in <code>alpha</code>.
We would not reject at the 100<code>alpha</code>% level combinations of
threshold and <code class="reqn">K</code> corresponding to values of the IMTS that fall
below the line.
</p>
<p>If <code>y = "theta"</code> then estimates of <code class="reqn">\theta</code> are plotted on the
vertical axis.  If both <code>x$u</code> and <code>x$k$</code> have length greater
than one then only these estimates are plotted.  If either <code>x$u</code>
or <code>x$k</code> have length one then approximate 100<code>level</code>%
confidence intervals are added to the plot and the variable,
<code>x$u</code> or <code>x$k</code> that has length greater than one is plotted on
the horizontal axis.
</p>


<h3>Value</h3>

<p>Nothing is returned.
</p>


<h3>Examples</h3>

<p>See the examples in <code><a href="#topic+choose_uk">choose_uk</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+choose_uk">choose_uk</a></code>.
</p>

<hr>
<h2 id='sp500'>Daily log returns of the Standard and Poor (S&amp;P) 500 index</h2><span id='topic+sp500'></span>

<h3>Description</h3>

<p>Daily log returns of the S&amp;P 500 index, that is, the log of the ratio of
successive daily closing prices, from 3rd January 1990 to 9th October 2018.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sp500
</code></pre>


<h3>Format</h3>

<p>A vector of length 7250, created using <code><a href="zoo.html#topic+zoo">zoo</a></code>
with an &quot;index&quot; attribute giving the date of the corresponding negated
log return.
</p>


<h3>Source</h3>

<p>Yahoo finance: https://finance.yahoo.com/quote/^SPX/history/
</p>

<hr>
<h2 id='split_by_NAs'>Divides data into parts that contain no missing values</h2><span id='topic+split_by_NAs'></span>

<h3>Description</h3>

<p>Splits the values in a numeric matrix column-wise into sequences of
non-missing values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>split_by_NAs(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="split_by_NAs_+3A_x">x</code></td>
<td>
<p>A vector or matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each column in <code>x</code>, <code>split_by_NAs</code> finds runs of
values that contain no missing values and assigns them to a column in the
matrix that is returned.  Different columns are treated separately.
If there are no missing values in a column then that column appears
unmodified in the output matrix.  Please see the <strong>Examples</strong>
for illustrations.
</p>


<h3>Value</h3>

<p>A matrix containing a column for each run of non-missing values in
<code>x</code>.  The number of rows is equal to the longest run of non-missing
values in <code>x</code> and will therefore be at most <code>nrow{x}</code>.  The
matrix is padded with <code>NA</code> values at the end of each column, where
necessary.
</p>
<p>The returned object has an attribute called <code>split_by_NAs_done</code>
whose value is <code>TRUE</code>, so that in programming one can avoid calling
<code>split_by_NAs</code> more than once.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a simple numeric matrix and insert some NAs
x &lt;- matrix(1:50, 10, 5)
x[c(3, 8), 1] &lt;- NA
x[c(1:2, 5, 10), 3] &lt;- NA
x[1:3, 4] &lt;- NA
x[7:10, 5] &lt;- NA
x

res &lt;- split_by_NAs(x)
res

# An example of a character matrix
x &lt;- matrix(c(letters, letters[1:18]), 11, 4)
x[c(1:2, 5:11), 2] &lt;- NA
x[c(2:4, 6:11), 3] &lt;- NA
x[1:10, 4] &lt;- NA

res &lt;- split_by_NAs(x)
res
</code></pre>

<hr>
<h2 id='spm'>Semiparametric maxima estimator of the extremal index</h2><span id='topic+spm'></span>

<h3>Description</h3>

<p>Estimates the extremal index <code class="reqn">\theta</code> using a semiparametric block
maxima estimator of Northrop (2015) (<code>"N2015"</code>) and a variant of this
estimator studied by Berghaus and Bucher (2018) (<code>"BB2018"</code>), using
both sliding (overlapping) block maxima and disjoint (non-overlapping) block
maxima.  A simple modification (subtraction of <code class="reqn">1 / b</code>, where <code class="reqn">b</code> is
the block size) of the Berghaus and Bucher (2018) estimator
(<code>"BB2018b"</code>) is also calculated.  Estimates of uncertainty are
calculated using the asymptotic theory developed by Berghaus and Bucher
(2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spm(
  data,
  b,
  bias_adjust = c("BB3", "BB1", "N", "none"),
  constrain = TRUE,
  varN = TRUE,
  which_dj = c("last", "first")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spm_+3A_data">data</code></td>
<td>
<p>A numeric vector of raw data.  No missing values are allowed.</p>
</td></tr>
<tr><td><code id="spm_+3A_b">b</code></td>
<td>
<p>A numeric scalar.  The block size.</p>
</td></tr>
<tr><td><code id="spm_+3A_bias_adjust">bias_adjust</code></td>
<td>
<p>A character scalar.  Is bias-adjustment of the
raw estimate of <code class="reqn">\theta</code> performed using the bias-reduced
estimator (<code>bias_adjust = "BB3"</code>), derived in Section 5 of
Berghaus and Bucher (2018); or a simpler version
(<code>bias_adjust = "BB1"</code>), in which the raw estimate is multiplied by
<code class="reqn">(k-1) / k</code>, where <code class="reqn">k</code> is the number of blocks; or the
bias-adjustment of the empirical distribution function used to calculate
the estimate, as detailed in Section 2 of Northrop (2015).  When disjoint
maxima are used <code>bias_adjust = "BB1"</code> and <code>bias_adjust = "N"</code>
give identical estimates of the Berghaus and Bucher (2018) variant,
as explained at the end of Section 5 of Berghaus and Bucher (2018).
If <code>bias_adjust = "none"</code> then no bias-adjustment is performed.</p>
</td></tr>
<tr><td><code id="spm_+3A_constrain">constrain</code></td>
<td>
<p>A logical scalar.  If <code>constrain = TRUE</code> then
any estimates that are greater than 1 are set to 1,
that is, they are constrained to lie in (0, 1].  This is carried out
<em>after</em> any bias-adjustment.  Otherwise,
estimates that are greater than 1 may be obtained.</p>
</td></tr>
<tr><td><code id="spm_+3A_varn">varN</code></td>
<td>
<p>A logical scalar.  If <code>varN = TRUE</code> then the estimation
of the sampling variance of the Northrop (2015) estimator is tailored
to that estimator.  Otherwise, the sampling variance derived in
Berghaus and Bucher (2018) is used.
See <strong>Details</strong> for further information.</p>
</td></tr>
<tr><td><code id="spm_+3A_which_dj">which_dj</code></td>
<td>
<p>A character scalar.  Determines which set of disjoint
maxima are used to calculate an estimate of <code class="reqn">\theta</code>: <code>"first"</code>,
only the set whose first block starts on the first observation in
<code>x</code>; <code>"last"</code>, only the set whose last block ends on the last
observation in <code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The extremal index <code class="reqn">\theta</code> is estimated using the
semiparametric maxima estimator of Northrop (2015) and variant
of this studied by Berghaus and Bucher (2018).  In each case a sample
of 'data' is derived from the input data <code>data</code>, based on the
empirical distribution function of these data evaluated at the
maximum values of  of blocks of <code>b</code> contiguous values in <code>data</code>.
</p>
<p>The estimators are based on an assumption that these 'data' are sampled
approximately from an exponential distribution with mean <code class="reqn">1/\theta</code>.
For details see page 2309 of Berghaus and Bucher (2018), where the
'data' for the Northrop (2015) estimator are denoted <code class="reqn">Y</code> and
those for the Berghaus and Bucher (2018) are denoted <code class="reqn">Z</code>.
For convenience, we will refer to these values as the
<code class="reqn">Y</code>-data and the <code class="reqn">Z</code>-data.
</p>
<p>The approximate nature of the model for the <code class="reqn">Y</code>-data arises from the
estimation of the distribution function <code class="reqn">F</code>.  A further
approximation motivates the use of the <code class="reqn">Z</code>-data.  If <code class="reqn">F</code> is known
then the variable <code class="reqn">Z / b</code> has a beta(1, <code class="reqn">b\theta</code>) distribution,
so that that is, <code class="reqn">Z</code> has mean <code class="reqn">1 / (\theta + 1/b)</code>.
Therefore, an exponential distribution with mean <code class="reqn">1 / (\theta + 1/b)</code>
may provide a better approximate model, which provides the motivation for
subtracting <code class="reqn">1 / b</code> from the Berghaus and Bucher (2018) estimator.
Indeed, the resulting estimates are typically close to those
of the Northrop (2015) estimator.
</p>
<p>If <code>sliding = TRUE</code> then the function uses sliding block maxima,
that is, the largest value observed in <em>all</em>
(<code>length(data) - b + 1</code>) blocks of <code>b</code> observations.
If <code>sliding = FALSE</code> then disjoint block maxima, that is, the
largest values in (<code>floor(n / b)</code>) disjoint blocks of <code>b</code>
observations, are used.
</p>
<p>Estimation of the sampling variances of the estimators is based
on Proposition 4.1 on page 2319 of Berghaus and Bucher (2018).
For the Northrop (2015) variant the user has the choice either to
use the sampling variance based on the Berghaus and Bucher (2018)
estimator, i.e. the <code class="reqn">Z</code>-data (<code>varN = FALSE</code>) or an analogous
version tailored to the Northrop (2015) estimator that uses the
<code class="reqn">Y</code>-data (<code>varN = TRUE</code>).
</p>
<p>The estimates of the sampling variances of the sliding blocks estimators
are inferred from those of the disjoint blocks estimators (see page 2319
of Berhaus and Bucher (2018)).  The calculation of the latter uses a set
of disjoint block maxima.  If <code>length(data)</code> is not an integer
multiple of <code>b</code> then there will be more than one set of these, and
all are equally valid.  In this event we perform the calculation for all
such sets and use the mean of the resulting estimates.  This reduces the
sampling variability of the estimates at the expense of slowing down
the calculation somewhat, particularly if <code>b</code> is small.  This may
become apparent when calling <code>spm</code> repeatedly in
<code><a href="#topic+choose_b">choose_b</a></code>.
</p>
<p>This estimator of the sampling variance of the sliding blocks estimator is
not constrained to be positive: a negative estimate may result if the
block size is small.  In this event
<strong>no warning will be given until the returned object is printed</strong> and,
for the affected estimator (<code>"N2015"</code> or <code>"BB2018/BB2018b"</code>),
</p>

<ul>
<li><p> the corresponding estimated standard errors using sliding
blocks will be missing in <code>se_sl</code> in the returned object,
</p>
</li>
<li><p> if <code>bias_adjust == "BB3"</code> then bias-adjustment
based on <code>bias_adjust == "BB1"</code> will instead be performed
when using sliding blocks, because the former relies on the
estimated variances of the estimators.
</p>
</li></ul>

<p>Similarly, bias adjustment under <code>adjust = "BB3"</code> and/or subtraction
of <code class="reqn">1 / b</code> in the <code>"BB2018b"</code> case may, rare cases, produce a
negative estimate of <code class="reqn">\theta</code>.  In these instances an estimate of
zero is returned, but the values returned in <code>bias_dj</code> and
<code>bias_sl</code> are not changed.
</p>


<h3>Value</h3>

<p>A list of class <code>c("spm", "exdex")</code> containing the
components listed below.  The components that are vectors are
labelled to indicate the estimator to which the constituent values
relate: <code>"N2015"</code> for Northrop (2015), <code>"BB2018"</code> for
Berghaus and Bucher (2018) and <code>"BB2018b"</code> for the modified version.
</p>
<table>
<tr><td><code>theta_sl</code>, <code>theta_dj</code></td>
<td>
<p> Vectors containing the estimates of
<code class="reqn">\theta</code> resulting from sliding maxima and disjoint maxima
respectively.</p>
</td></tr>
<tr><td><code>se_sl</code>, <code>se_dj</code></td>
<td>
<p>The estimated standard errors associated
with the estimates in <code>theta_sl</code> and <code>theta_dj</code>.
The values for <code>"BB2018"</code> and <code>"BB2018b"</code> are identical.</p>
</td></tr>
<tr><td><code>bias_sl</code>, <code>bias_dj</code></td>
<td>
<p>The respective values of the
bias-adjustment applied to the raw estimates, that is, the values
subtracted from the raw estimates.  For estimator
<code>BB2018b</code> this includes a contribution for the subtraction
of <code>1 / b</code>.
If <code>bias_adjust = "N"</code> or <code>"none"</code> then
<code>bias_sl</code> and <code>bias_dj</code> are <code>c(0, 0, 1 / b)</code>.</p>
</td></tr>
<tr><td><code>raw_theta_sl</code>, <code>raw_theta_dj</code></td>
<td>
<p> Vectors containing the raw estimates
of <code class="reqn">\theta</code>, prior to any bias_adjustment.</p>
</td></tr>
<tr><td><code>uncon_theta_sl</code>, <code>uncon_theta_dj</code></td>
<td>
<p>The (bias_adjusted) estimates of
<code class="reqn">\theta</code> before the constraint that they lie in (0, 1] has been
applied.</p>
</td></tr>
<tr><td><code>data_sl</code>, <code>data_dj</code></td>
<td>
<p>Matrices containing the <code class="reqn">Y</code>-data and
<code class="reqn">Z</code>-data for the sliding an disjoint maxima respectively.
The first columns are the <code class="reqn">Y</code>-data, the second columns the
<code class="reqn">Z</code>-data.</p>
</td></tr>
<tr><td><code>sigma2dj</code>, <code>sigma2dj_for_sl</code></td>
<td>
<p>Estimates of the variance
<code class="reqn">\sigma_{{\rm dj}}^2</code>
defined on pages 2314-2315 of Berghaus and Bucher (2018).
The form of the estimates is given on page 2319.
<code>sigma2dj</code> is used in estimating the standard error <code>se_dj</code>,
<code>sigma2dj_for_sl</code> in estimating the standard error <code>se_sl</code>.</p>
</td></tr>
<tr><td><code>sigma2sl</code></td>
<td>
<p>Estimates of the variance
<code class="reqn">\sigma_{{\rm sl}}^2</code>.
defined on pages 2314-2315 of Berghaus and Bucher (2018).
The form of the estimates is given on page 2319.
<code>sigma2dj_for_sl</code> is used to estimate
<code class="reqn">\sigma_{{\rm dj}}^2</code> for this purpose.</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>The input value of <code>b</code>.</p>
</td></tr>
<tr><td><code>bias_adjust</code></td>
<td>
<p>The input value of <code>bias_adjust</code>.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The call to <code>spm</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Northrop, P. J. (2015) An efficient semiparametric maxima
estimator of the extremal index. <em>Extremes</em> <strong>18</strong>(4), 585-603.
<a href="https://doi.org/10.1007/s10687-015-0221-5">doi:10.1007/s10687-015-0221-5</a>
</p>
<p>Berghaus, B., Bucher, A. (2018) Weak convergence of a pseudo
maximum likelihood estimator for the extremal index. <em>Ann. Statist.</em>
<strong>46</strong>(5), 2307-2335. <a href="https://doi.org/10.1214/17-AOS1621">doi:10.1214/17-AOS1621</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spm_confint">spm_confint</a></code> to estimate confidence intervals
for <code class="reqn">\theta</code>.
</p>
<p><code><a href="#topic+spm_methods">spm_methods</a></code> for S3 methods for <code>"spm"</code> objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Newlyn sea surges
theta &lt;- spm(newlyn, 20)
theta
summary(theta)
coef(theta)
nobs(theta)
vcov(theta)

### S&amp;P 500 index
theta &lt;- spm(sp500, 100)
theta
summary(theta)
</code></pre>

<hr>
<h2 id='spm_confint'>Confidence intervals for the extremal index <code class="reqn">\theta</code> for <code>"spm"</code>
objects</h2><span id='topic+spm_confint'></span><span id='topic+confint.spm'></span><span id='topic+plot.confint_spm'></span><span id='topic+print.confint_spm'></span>

<h3>Description</h3>

<p><code>confint</code> method for objects of class <code>c("spm", "exdex")</code>.
Computes confidence intervals for <code class="reqn">\theta</code> based on an object returned
from <code><a href="#topic+spm">spm</a></code>.  Two types of interval may be returned:
(a) intervals that are based on approximate large-sample normality of the
estimators of <code class="reqn">\theta</code> (or of <code class="reqn">\log\theta</code> if
<code>conf_scale = "log"</code>), and which are symmetric about the respective
point estimates, and (b) likelihood-based intervals based on an adjustment
of a naive (pseudo-) loglikelihood, using the
<code><a href="chandwich.html#topic+adjust_loglik">adjust_loglik</a></code> function in the
<code><a href="chandwich.html#topic+chandwich">chandwich</a></code> package. The <code>plot</code> method plots the
log-likelihood for <code class="reqn">\theta</code>, with the required confidence interval(s)
indicated on the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spm'
confint(
  object,
  parm = "theta",
  level = 0.95,
  maxima = c("sliding", "disjoint"),
  interval_type = c("norm", "lik", "both"),
  conf_scale = c("theta", "log"),
  constrain = TRUE,
  bias_adjust = TRUE,
  type = c("vertical", "cholesky", "spectral", "none"),
  ...
)

## S3 method for class 'confint_spm'
plot(x, estimator = "all", ndec = 2, ...)

## S3 method for class 'confint_spm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spm_confint_+3A_object">object</code></td>
<td>
<p>An object of class <code>c("spm", "exdex")</code>, returned by
<code><a href="#topic+spm">spm</a></code>.</p>
</td></tr>
<tr><td><code id="spm_confint_+3A_parm">parm</code></td>
<td>
<p>Specifies which parameter is to be given a confidence interval.
Here there is only one option: the extremal index <code class="reqn">\theta</code>.</p>
</td></tr>
<tr><td><code id="spm_confint_+3A_level">level</code></td>
<td>
<p>A numeric scalar in (0, 1). The confidence level required.</p>
</td></tr>
<tr><td><code id="spm_confint_+3A_maxima">maxima</code></td>
<td>
<p>A character scalar specifying whether to estimate
confidence intervals based on sliding maxima or disjoint maxima.</p>
</td></tr>
<tr><td><code id="spm_confint_+3A_interval_type">interval_type</code></td>
<td>
<p>A character scalar: <code>"norm"</code> for intervals of
type (a), <code>"lik"</code> for intervals of type (b).</p>
</td></tr>
<tr><td><code id="spm_confint_+3A_conf_scale">conf_scale</code></td>
<td>
<p>A character scalar.  If <code>interval_type = "norm"</code> then
<code>conf_scale</code> determines the scale on which we use approximate
large-sample normality of the estimators to estimate confidence intervals
of type (a).
</p>
<p>If <code>conf_scale = "theta"</code>
then confidence intervals are estimated for <code class="reqn">\theta</code> directly.
If <code>conf_scale = "log"</code> then confidence intervals are first
estimated for <code class="reqn">\log\theta</code> and then transformed back
to the <code class="reqn">\theta</code>-scale.
</p>
<p>Any bias-adjustment requested in the original call to <code><a href="#topic+spm">spm</a></code>,
using it's <code>bias_adjust</code> argument, is automatically applied here.</p>
</td></tr>
<tr><td><code id="spm_confint_+3A_constrain">constrain</code></td>
<td>
<p>A logical scalar.  If <code>constrain = TRUE</code> then
any confidence limits that are greater than 1 are set to 1,
that is, they are constrained to lie in (0, 1].  Otherwise,
limits that are greater than 1 may be obtained.
If <code>constrain = TRUE</code> then any lower confidence limits that are
less than 0 are set to 0.</p>
</td></tr>
<tr><td><code id="spm_confint_+3A_bias_adjust">bias_adjust</code></td>
<td>
<p>A logical scalar.  If <code>bias_adjust = TRUE</code> then,
if appropriate, bias-adjustment is also applied to the loglikelihood
before it is adjusted using <code><a href="chandwich.html#topic+adjust_loglik">adjust_loglik</a></code>.
This is performed only if, in the call to
<code><a href="#topic+spm">spm</a></code>, <code>bias_adjust = "BB3"</code> or
<code>"BB1"</code> was specified, that is, we have
<code>object$bias_adjust = "BB3"</code>
or <code>"BB1"</code>.  In these cases the relevant
component of <code>object$bias_sl</code> or <code>object$bias_dj</code>
is used to scale <code class="reqn">\theta</code> so
that the location of the maximum of the loglikelihood lies at the
bias-adjusted estimate of <code class="reqn">\theta</code>.
</p>
<p>If <code>bias_adjust = FALSE</code> or <code>object$bias_adjust = "none"</code>
or <code>"N"</code> then no bias-adjustment of the
intervals is performed.  In the latter case this is because the
bias-adjustment is applied in the creation of the data in
<code>object$N2015_data</code> and <code>object$BB2018_data</code>, on which the
naive likelihood is based.</p>
</td></tr>
<tr><td><code id="spm_confint_+3A_type">type</code></td>
<td>
<p>A character scalar.  The argument <code>type</code> to be passed to
<code><a href="chandwich.html#topic+conf_intervals">conf_intervals</a></code> in the
<code><a href="chandwich.html#topic+chandwich">chandwich</a></code> package in order to estimate the
likelihood-based intervals.
Using <code>type = "none"</code> is <em>not</em> advised because then the
intervals are based on naive estimated standard errors.  In particular,
if (the default) <code>sliding = TRUE</code> was used in the call to
<code><a href="#topic+spm">spm</a></code> then the unadjusted likelihood-based confidence
intervals provide <em>vast</em> underestimates of uncertainty.</p>
</td></tr>
<tr><td><code id="spm_confint_+3A_...">...</code></td>
<td>
<p>Additional optional arguments to be passed to
<code><a href="base.html#topic+print.default">print.default</a></code></p>
</td></tr>
<tr><td><code id="spm_confint_+3A_x">x</code></td>
<td>
<p>an object of class <code>c("confint_spm", "exdex")</code>, a result of
a call to <code><a href="#topic+confint.spm">confint.spm</a></code>.</p>
</td></tr>
<tr><td><code id="spm_confint_+3A_estimator">estimator</code></td>
<td>
<p>A character vector specifying which of the three variants
of the semiparametric maxima estimator to include in the plot:
<code>"N2015", "BB2018"</code> or <code>"BB2018b"</code>.  See <code><a href="#topic+spm">spm</a></code> for
details. If <code>estimator = "all"</code> then all three are included.</p>
</td></tr>
<tr><td><code id="spm_confint_+3A_ndec">ndec</code></td>
<td>
<p>An integer scalar.  The legend (if included on the plot)
contains the confidence limits rounded to <code>ndec</code> decimal places.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The likelihood-based intervals are estimated using the
<code><a href="chandwich.html#topic+adjust_loglik">adjust_loglik</a></code> function in the
<code><a href="chandwich.html#topic+chandwich">chandwich</a></code> package, followed by a call to
<code><a href="chandwich.html#topic+conf_intervals">conf_intervals</a></code>.
This adjusts the naive (pseudo-)loglikelihood so that the curvature of
the adjust loglikelihood agrees with the estimated standard errors of
the estimators.  The option <code>type = "none"</code> should not be used in
practice because the resulting confidence intervals will be wrong.
In particular, in the intervals based on sliding maxima will provide
<em>vast</em> underestimates of uncertainty.
</p>
<p>If <code>object$se</code> contains <code>NA</code>s, because the block size <code>b</code>
was too small or too large in the call to <code><a href="#topic+spm">spm</a></code> then
confidence intervals cannot be estimated.  A matrix of <code>NA</code>s
will be returned.  See the <strong>Details</strong> section of the
<code><a href="#topic+spm">spm</a></code> documentation for more information.
</p>
<p><code>print.confint_spm</code> prints the matrix of confidence
intervals for <code class="reqn">\theta</code>.
</p>


<h3>Value</h3>

<p>A list of class c(&quot;confint_spm&quot;, &quot;exdex&quot;) containing the
following components.
</p>
<table>
<tr><td><code>cis</code></td>
<td>
<p>A matrix with columns giving the lower and upper confidence
limits. These are labelled as (1 - level)/2 and 1 - (1 - level)/2 in
% (by default 2.5% and 97.5%).
The row names are a concatenation of the variant of the estimator
(<code>N2015</code> for Northrop (2015), <code>BB2018</code> for
Berghaus and Bucher (2018)), <code>BB2018b</code> for the modified
(by subtracting <code>1 / b</code>) Berghaus and Bucher (2018)
and the type of interval (<code>norm</code> for symmetric and <code>lik</code> for
likelihood-based).</p>
</td></tr>
<tr><td><code>ciN</code></td>
<td>
<p>The object returned from
<code><a href="chandwich.html#topic+conf_intervals">conf_intervals</a></code> that contains information about
the adjusted loglikelihood for the Northrop (2015) variant of the
estimator.</p>
</td></tr>
<tr><td><code>ciBB</code></td>
<td>
<p>The object returned from
<code><a href="chandwich.html#topic+conf_intervals">conf_intervals</a></code> that contains information about
the adjusted loglikelihood for the Berghaus and Bucher (2018) variant of
the estimator.</p>
</td></tr>
<tr><td><code>ciBBb</code></td>
<td>
<p>The object returned from
<code><a href="chandwich.html#topic+conf_intervals">conf_intervals</a></code> that contains information about
the adjusted loglikelihood for the modified Berghaus and Bucher (2018)
variant of the estimator.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The call to <code>spm</code>.</p>
</td></tr>
<tr><td><code>object</code></td>
<td>
<p>The input <code>object</code>.</p>
</td></tr>
<tr><td><code>maxima</code></td>
<td>
<p>The input <code>maxima</code>.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>The relevant estimates of <code class="reqn">\theta</code> returned from
<code><a href="chandwich.html#topic+adjust_loglik">adjust_loglik</a></code>.  These are equal to
<code>object$theta_sl</code> if <code>maxima = "sliding"</code>,
<code>object$theta_dj</code> if <code>maxima = "disjoint"</code>,
which provides a check that the results are correct.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>The input <code>level</code>.</p>
</td></tr>
</table>
<p><code>plot.confint_spm</code>: nothing is returned.
</p>
<p><code>print.confint_spm</code>: the argument <code>x</code>, invisibly.
</p>


<h3>References</h3>

<p>Northrop, P. J. (2015) An efficient semiparametric maxima
estimator of the extremal index. <em>Extremes</em> <strong>18</strong>(4), 585-603.
<a href="https://doi.org/10.1007/s10687-015-0221-5">doi:10.1007/s10687-015-0221-5</a>
</p>
<p>Berghaus, B., Bucher, A. (2018) Weak convergence of a pseudo
maximum likelihood estimator for the extremal index. <em>Ann. Statist.</em>
<strong>46</strong>(5), 2307-2335. <a href="https://doi.org/10.1214/17-AOS1621">doi:10.1214/17-AOS1621</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spm">spm</a></code> for estimation of the extremal index
<code class="reqn">\theta</code> using a semiparametric maxima method.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Newlyn sea surges
theta &lt;- spm(newlyn, 20)
confint(theta)
cis &lt;- confint(theta, interval_type = "lik")
cis
plot(cis)

# S&amp;P 500 index
theta &lt;- spm(sp500, 100)
confint(theta)
cis &lt;- confint(theta, interval_type = "lik")
cis
plot(cis)
</code></pre>

<hr>
<h2 id='spm_methods'>Methods for objects of class <code>"spm"</code></h2><span id='topic+spm_methods'></span><span id='topic+coef.spm'></span><span id='topic+vcov.spm'></span><span id='topic+nobs.spm'></span><span id='topic+print.spm'></span><span id='topic+summary.spm'></span><span id='topic+print.summary.spm'></span>

<h3>Description</h3>

<p>Methods for objects of class <code>c("spm", "exdex")</code> returned from
<code><a href="#topic+spm">spm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spm'
coef(
  object,
  maxima = c("sliding", "disjoint"),
  estimator = "all",
  constrain = FALSE,
  ...
)

## S3 method for class 'spm'
vcov(object, maxima = c("sliding", "disjoint"), estimator = "all", ...)

## S3 method for class 'spm'
nobs(object, maxima = c("sliding", "disjoint"), ...)

## S3 method for class 'spm'
print(x, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'spm'
summary(object, digits = max(3, getOption("digits") - 3L), ...)

## S3 method for class 'summary.spm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spm_methods_+3A_object">object</code></td>
<td>
<p>an object of class <code>"spm"</code>, a result of a call to
<code><a href="#topic+spm">spm</a></code>.</p>
</td></tr>
<tr><td><code id="spm_methods_+3A_maxima">maxima</code></td>
<td>
<p>A character scalar specifying whether to return the
number of observed sliding maxima or disjoint maxima.</p>
</td></tr>
<tr><td><code id="spm_methods_+3A_estimator">estimator</code></td>
<td>
<p>A character vector specifying which of the three variants
of the semiparametric maxima estimator to use: <code>"N2015", "BB2018"</code>
or <code>"BB2018b"</code>. See <code><a href="#topic+spm">spm</a></code> for details. If
<code>estimator = "all"</code> then the estimated variances of all variants are
returned.</p>
</td></tr>
<tr><td><code id="spm_methods_+3A_constrain">constrain</code></td>
<td>
<p>A logical scalar.  If <code>constrain = TRUE</code> then
any estimates that are greater than 1 are set to 1,
that is, they are constrained to lie in (0, 1].  Otherwise,
estimates that are greater than 1 may be obtained.</p>
</td></tr>
<tr><td><code id="spm_methods_+3A_...">...</code></td>
<td>
<p>For <code>print.summary.spm</code>, additional arguments passed to
<code><a href="base.html#topic+print.default">print.default</a></code>.</p>
</td></tr>
<tr><td><code id="spm_methods_+3A_x">x</code></td>
<td>
<p><code>print.spm</code>. An object of class <code>c("spm", "exdex")</code>, a
result of a call to <code><a href="#topic+spm">spm</a></code>.
</p>
<p><code>print.summary.spm</code>. An object of class <code>"summary.spm"</code>, a
result of a call to <code><a href="#topic+summary.spm">summary.spm</a></code>.</p>
</td></tr>
<tr><td><code id="spm_methods_+3A_digits">digits</code></td>
<td>
<p>An integer. Used for number formatting with
<code><a href="base.html#topic+Round">signif</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>print.spm</code> prints the original call to <code><a href="#topic+spm">spm</a></code>
and the estimates of the extremal index <code class="reqn">\theta</code>, based on all three
variants of the semiparametric maxima estimator and both sliding
and disjoint blocks.
</p>


<h3>Value</h3>

<p><code>coef.spm</code>. A numeric scalar (or a vector of length 3 if
<code>estimator = "all"</code>): the required estimate(s) of the extremal index
<code class="reqn">\theta</code>.
</p>
<p><code>vcov.spm</code>. A <code class="reqn">1 \times 1</code> numeric matrix if
<code>estimator = "N2015"</code> or <code>"BB2018"</code> and a vector of length 3 if
<code>estimator = "all"</code>, containing the estimated variance(s) of the
estimator(s).
</p>
<p><code>nobs.spm</code>. A numeric scalar: the number of observations used in the
fit.
</p>
<p><code>print.spm</code>. The argument <code>x</code>, invisibly.
</p>
<p><code>summary.spm</code>. Returns an object (a list) of class
<code>"summary.spm"</code> containing the list element <code>object$call</code> and a
numeric matrix <code>matrix</code> giving, for all three variants of the
semiparametric estimator and both sliding and disjoint blocks,
the (bias-adjusted) Estimate of the extremal index <code class="reqn">\theta</code>,
the estimated standard error (Std. Error),
and the bias adjustment (Bias adj.) applied to obtain the estimate, i.e.
the value subtracted from the raw estimate.  If any of the
(bias-adjusted) estimates are greater than 1 then a column
containing the unconstrained estimates (Uncon. estimate) is added.
</p>
<p><code>print.summary.spm</code>. The argument <code>x</code>, invisibly.
</p>


<h3>Examples</h3>

<p>See the examples in <code><a href="#topic+spm">spm</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spm">spm</a></code> for semiparametric estimation of the
extremal index based on block maxima.
</p>

<hr>
<h2 id='uccle'>Uccle maximum daily temperatures</h2><span id='topic+uccle'></span>

<h3>Description</h3>

<p>The dataframe <code>uccle</code> contains daily maximum temperatures in degrees C
recorded at the Uccle, Belgium from 1/1/1833 to 23/1/2011.  The Station
identifier in the source file is 17 and the Source identifier is 117882.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uccle
</code></pre>


<h3>Format</h3>

<p>A data frame with 65036 observations on the following and 5 variables.
</p>

<ul>
<li> <p><code>temp:</code> daily maximum temperature in degrees C.
</p>
</li>
<li> <p><code>year:</code> the year.
</p>
</li>
<li> <p><code>month:</code> the month of the year.
</p>
</li>
<li> <p><code>day:</code> day of the month.
</p>
</li>
<li> <p><code>date:</code> date with the <code><a href="base.html#topic+Dates">Date</a></code> class,
in the format YYYY-MM-DD.
</p>
</li></ul>



<h3>Note</h3>

<p>There are 5336 missing values.
</p>


<h3>Source</h3>

<p>Klein Tank, A.M.G. and Coauthors, 2002. Daily dataset of
20th-century surface air temperature and precipitation series for the
European Climate Assessment. <em>Int. J. of Climatol.</em>, <strong>22</strong>,
1441-1453 <a href="https://doi.org/10.1002/joc.773">doi:10.1002/joc.773</a>. Data and metadata available at
<a href="https://www.ecad.eu">https://www.ecad.eu</a>.  The data were downloaded
on 27/3/2022 using a
<a href="https://www.ecad.eu/dailydata/customquery.php">Custom query (ASCII)</a>,
selecting &quot;non-blend&quot; for type of series.
</p>

<hr>
<h2 id='uccle720'>20th century Uccle maximum daily temperatures in July - data frame</h2><span id='topic+uccle720'></span>

<h3>Description</h3>

<p>The dataframe <code>uccle720</code> contains daily maximum temperatures in degrees C
recorded at the Uccle, Belgium during July for the years 1901 to 1999.
The Station identifier in the source file is 17 and the Source identifier is
117882.  These data are analysed in Holesovsky and Fusek (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uccle720
</code></pre>


<h3>Format</h3>

<p>A data frame with 3100 observations on the following and 5 variables.
</p>

<ul>
<li> <p><code>temp:</code> daily maximum temperature in degrees C.
</p>
</li>
<li> <p><code>year:</code> the year.
</p>
</li>
<li> <p><code>month:</code> the month of the year.
</p>
</li>
<li> <p><code>day:</code> day of the month.
</p>
</li>
<li> <p><code>date:</code> date with the <code><a href="base.html#topic+Dates">Date</a></code> class,
in the format YYYY-MM-DD.
</p>
</li></ul>



<h3>Note</h3>

<p>There are 6 missing values, one located in each of the years
1925, 1926, 1956, 1963, 1969 and 1976.
</p>


<h3>Source</h3>

<p>Klein Tank, A.M.G. and Coauthors, 2002. Daily dataset of
20th-century surface air temperature and precipitation series for the
European Climate Assessment. <em>Int. J. of Climatol.</em>, <strong>22</strong>,
1441-1453 <a href="https://doi.org/10.1002/joc.773">doi:10.1002/joc.773</a>. Data and metadata available at
<a href="https://www.ecad.eu">https://www.ecad.eu</a>.  The data were downloaded
on 27/3/2022 using a
<a href="https://www.ecad.eu/dailydata/customquery.php">Custom query (ASCII)</a>,
selecting &quot;non-blend&quot; for type of series.
</p>


<h3>References</h3>

<p>Holesovsky, J. and Fusek, M. Estimation of the extremal index
using censored distributions. <em>Extremes</em>, <strong>23</strong>, 197-213
(2020). <a href="https://doi.org/10.1007/s10687-020-00374-3">doi:10.1007/s10687-020-00374-3</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>uccle720_ts &lt;- ts(uccle720$temp, start = c(1901, 1), frequency = 31)
plot(uccle720_ts, ylab = "daily maximum temperature in July / degrees C",
     xlab = "year")
</code></pre>

<hr>
<h2 id='uccle720m'>20th century Uccle maximum daily temperatures in July - matrix</h2><span id='topic+uccle720m'></span>

<h3>Description</h3>

<p>The matrix <code>uccle720m</code> contains daily maximum temperatures in degrees C
recorded at the Uccle, Belgium during July for the years 1901 to 1999.
The Station identifier in the source file is 17 and the Source identifier is
117882.  These data are analysed in Holesovsky and Fusek (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uccle720m
</code></pre>


<h3>Format</h3>

<p>A 31 by 100 numeric matrix.  Column <code>i</code> contains the maximum
daily temperature in degrees C at Uccle in the year 1900 + <code>i</code> - 1.
The columns are named 1900, 1901, ..., 1999 and the rows are named
after the day of the month: 1, 2, .., 31.
</p>


<h3>Note</h3>

<p>There are 6 missing values, one located in each of the years
1925, 1926, 1956, 1963, 1969 and 1976.
</p>


<h3>Source</h3>

<p>Klein Tank, A.M.G. and Coauthors, 2002. Daily dataset of
20th-century surface air temperature and precipitation series for the
European Climate Assessment. <em>Int. J. of Climatol.</em>, <strong>22</strong>,
1441-1453 <a href="https://doi.org/10.1002/joc.773">doi:10.1002/joc.773</a>. Data and metadata available at
<a href="https://www.ecad.eu">https://www.ecad.eu</a>.  The data were downloaded
on 27/3/2022 using a
<a href="https://www.ecad.eu/dailydata/customquery.php">Custom query (ASCII)</a>,
selecting &quot;non-blend&quot; for type of series.
</p>


<h3>References</h3>

<p>Holesovsky, J. and Fusek, M. Estimation of the extremal index
using censored distributions. <em>Extremes</em>, <strong>23</strong>, 197-213
(2020). <a href="https://doi.org/10.1007/s10687-020-00374-3">doi:10.1007/s10687-020-00374-3</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>uccle720_ts &lt;- ts(uccle720$temp, start = c(1901, 1), frequency = 31)
plot(uccle720_ts, ylab = "daily maximum temperature in July / degrees C",
     xlab = "year")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
