<!DOCTYPE html><html lang="en-US"><head><title>Help for package DDIwR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DDIwR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DDIwR_package'><p>Useful functions for various DDI (Data Documentation Initiative)</p>
related outputs.</a></li>
<li><a href='#convert'><p>Converts a dataset from one statistical software to another</p></a></li>
<li><a href='#DDI-children'><p>Add/remove/change one or more children or attributes from a DDI Codebook</p>
attribute.</a></li>
<li><a href='#DDIwR_internal'><p>DDIwR internal functions</p></a></li>
<li><a href='#exportCodebook'><p>Export a DDI Codebook to an XML file.</p></a></li>
<li><a href='#getCodebook'><p>Extract metadata information</p></a></li>
<li><a href='#makeCategories'><p>Create the <code>catgry</code> elements for a particular variable</p></a></li>
<li><a href='#makeDataNotes'><p>Create a <code>notes</code> element for the dataset.</p></a></li>
<li><a href='#makeElement'><p>Make a DDI Codebook element</p></a></li>
<li><a href='#recodeCharcat'><p>Recode character categorical variables</p></a></li>
<li><a href='#recodeMissings'><p>Consistent recoding of (extended) missing values</p></a></li>
<li><a href='#searchFor'><p>Search for key words</p></a></li>
<li><a href='#setupfile'><p>Create setup files for SPSS, Stata, SAS and R</p></a></li>
<li><a href='#showDetails'><p>Describe what a DDI element is</p></a></li>
<li><a href='#testValid'><p>Validate a DDI element.</p></a></li>
<li><a href='#updateCodebook'><p>Update Codebook.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>DDI with R</td>
</tr>
<tr>
<td>Version:</td>
<td>0.19</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/dusadrian/DDIwR">https://github.com/dusadrian/DDIwR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/dusadrian/DDIwR/issues">https://github.com/dusadrian/DDIwR/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Useful functions for various DDI (Data Documentation Initiative)
    related inputs and outputs. Converts data files to and from DDI, SPSS,
    Stata, SAS, R and Excel, including user declared missing values.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>admisc (&gt; 0.36), base64enc, declared (&gt; 0.24), digest, tools,
xml2, haven, readxl, writexl</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3.9000</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-10 00:00:05 UTC; dusadrian</td>
</tr>
<tr>
<td>Author:</td>
<td>Adrian Dusa <a href="https://orcid.org/0000-0002-3525-9253"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Adrian Dusa &lt;dusa.adrian@unibuc.ro&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-10 07:20:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='DDIwR_package'>Useful functions for various DDI (Data Documentation Initiative)
related outputs.</h2><span id='topic+DDIwR_package'></span><span id='topic+DDIwR-package'></span>

<h3>Description</h3>

<p>This package provides various functions to read DDI based
metadata documentation and write dedicated setup files for R, SPSS, Stata and
SAS to read an associated .csv file containing the raw data, apply labels for
variables and values and also deal with the treatment of missing values.
</p>
<p>It can also generate a DDI metadata file out of an R information object,
which can be used to export directly to the standard statistical packages
files (such as SPSS, Stata and SAS, or even Excel), using the versatile
package <b><span class="pkg">haven</span></b>. For R, the default object to store data and
metadata is a <b><code>data.frame</code></b>, and labelled data are automatically
coerced to class <code>declared</code>.
</p>
<p>The research leading to the initial functions in this package has received
funding from the European Union's Seventh Framework Program (FP7/2007-2013)
under grant agreement no. 262608 (DwB - Data without Boundaries)
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> DDIwR</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.19</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-12-09</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-v3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Adrian Dusa<br />
Department of Sociology<br />
University of Bucharest<br />
<a href="mailto:dusa.adrian@unibuc.ro">dusa.adrian@unibuc.ro</a>
</p>

<hr>
<h2 id='convert'>Converts a dataset from one statistical software to another</h2><span id='topic+convert'></span>

<h3>Description</h3>

<p>This function converts (or transfers) between R, Stata, SPSS, SAS, Excel and
DDI XML files. Unlike the regular import / export functions from packages
<b><span class="pkg">haven</span></b> or <b><span class="pkg">rio</span></b>, this function uses the DDI standard
as an exchange platform and facilitates a consistent conversion of the
missing values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert(
  from,
  to = NULL,
  declared = TRUE,
  chartonum = FALSE,
  recode = TRUE,
  encoding = "UTF-8",
  csv = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert_+3A_from">from</code></td>
<td>
<p>A path to a file, or a data.frame object</p>
</td></tr>
<tr><td><code id="convert_+3A_to">to</code></td>
<td>
<p>Character, the name of a software package or a path to a specific
file</p>
</td></tr>
<tr><td><code id="convert_+3A_declared">declared</code></td>
<td>
<p>Logical, return the resulting dataset as a declared object</p>
</td></tr>
<tr><td><code id="convert_+3A_chartonum">chartonum</code></td>
<td>
<p>Logical, recode character categorical variables to numerical
categorical variables</p>
</td></tr>
<tr><td><code id="convert_+3A_recode">recode</code></td>
<td>
<p>Logical, recode missing values</p>
</td></tr>
<tr><td><code id="convert_+3A_encoding">encoding</code></td>
<td>
<p>The character encoding used to read a file</p>
</td></tr>
<tr><td><code id="convert_+3A_csv">csv</code></td>
<td>
<p>Complex argument, see the Details section</p>
</td></tr>
<tr><td><code id="convert_+3A_...">...</code></td>
<td>
<p>Additional parameters passed to other functions, see the
Details section</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the argument <strong><code>to</code></strong> specifies a certain statistical package
(<code>"R"</code>, <code>"Stata"</code>, <code>"SPSS"</code>, <code>"SAS"</code>, <code>"XPT"</code>) or <code>"Excel"</code>, the name of the
destination file will be identical to the one in the argument <strong><code>from</code></strong>,
with an automatically added software specific extension.
</p>
<p>SPSS portable file (with the extension <code>".por"</code>) can only be read, but not
written.
</p>
<p>The argument <strong><code>to</code></strong> can also be specified as a path to a specific file,
in which case the software package is determined from its file extension.
The following extentions are currently recognized: <code>.xml</code> for DDI,
<code>.rds</code> for R, <code>.dta</code> for Stata, <code>.sav</code> for SPSS, <code>.xpt</code> for SAS, and
<code>.xlsx</code> for Excel.
</p>
<p>Additional parameters can be specified via the three dots argument
<strong><code>...</code></strong>, that are passed to the respective functions from packages
<b><span class="pkg">haven</span></b> and <b><span class="pkg">readxl</span></b>. For instance the function
<b><code><a href="haven.html#topic+write_dta">write_dta</a>()</code></b> has an additional argument called
<strong><code>version</code></strong> when writing a Stata file.
</p>
<p>The most important argument to consider is called <strong><code>user_na</code></strong>, part of
the function <b><code><a href="haven.html#topic+read_sav">read_sav</a>()</code></b>. Defaulted to <code>FALSE</code> in
package <b><span class="pkg">haven</span></b>, in package <b><span class="pkg">DDIwR</span></b> it is used as
having the value of <code>TRUE</code>, and it can be deactivated by explicitly
specifying <code>user_na = FALSE</code> in function <strong><code>convert()</code></strong>.
</p>
<p>The same three dots argument is used to pass additional parameters to other
functions in this package, for instance <strong><code>exportCodebook()</code></strong> when writing
to a DDI file. One of its argument <strong><code>embed</code></strong> (activated by default) can be
used to control embedding the data in the XML file. Deactivating it will
create a CSV file in the same directory, using the same file name as the
XML file.
</p>
<p>When converting from DDI, if the dataset is not embedded in the XML file, the
CSV file is expected to be found in the same directory as the DDI Codebook,
and it should have the same file name as the XML file. The path to the CSV
file can be provided via the <strong><code>csv</code></strong> argument. Additional formal
parameters of the function <b><code><a href="utils.html#topic+read.csv">read.csv</a>()</code></b> can
be passed via the same three dots <strong><code>...</code></strong> argument. Alternatively, the
<strong><code>csv</code></strong> argument can also be an R data frame.
</p>
<p>When converting to DDI, if the argument <strong><code>embed</code></strong> is set to <code>FALSE</code>, users
have the option to save the data in a separate CSV file (the default) or not
to save the data at all, by setting <strong><code>csv</code></strong> to <code>FALSE</code>.
</p>
<p>The DDI .xml file generates unique IDs for all variables, if not already
present in the attributes. These IDs are useful for newer versions of the DDI
Codebook, for referencing purposes.
</p>
<p>The argument <strong><code>chartonum</code></strong> signals recoding character categorical
variables, and employs the function <b><code><a href="#topic+recodeCharcat">recodeCharcat</a>()</code></b>.
This only makes sense when recoding to Stata, which does not allow allocating
labels for anything but integer variables.
</p>
<p>If the argument <strong><code>to</code></strong> is left to <code>NULL</code>, the data is (invisibly) returned
to the R enviroment. Conversion to R, either in the working space or as
a data file, will result (by default) in a data frame containing declared
labelled variables, as defined in package <b><span class="pkg">declared</span></b>.
</p>
<p>The current version reads and creates DDI Codebook version 2.6, with future
versions to extend the functionality for DDI Lifecycle versions 3.x and link
to the future package <b>DDI4R</b> for the UML model based version 4. It
extends the standard DDI Codebook by offering the possibility to embed a
serialized version of the R dataset into the XML file containing the
Codebook, within a <code>notes</code> child of the <code>fileDscr</code> component. This type of
generated codebook is unique to this package and automatically detected when
converting to another statistical software. This will likely be replaced with
a time insensitive text version.
</p>
<p>Converting to SAS is experimental, and it relies on the same package
<b><span class="pkg">haven</span></b> that uses the ReadStat C library. The safest way to
convert, which at the same time consistently converts the missing values, is
to export the data to a CSV file and create a setup file produced by function
<b><code><a href="#topic+setupfile">setupfile</a>()</code></b> and run the commands manually.
</p>
<p>Converting data from SAS is possible, however reading the metadata is also
experimental (the current version of <b>haven</b> only partially imports the
metadata). Either specify the path to the catalog file using the argument
<strong><code>catalog_file</code></strong> from the function <b><code><a href="haven.html#topic+read_sas">read_sas</a>()</code></b>,
or have the catalog file in the same directory as the data set, with the same
file name and the extension <code>.sas7bcat</code>
</p>
<p>The argument <strong><code>recode</code></strong> controls how missing values are treated. If the
input file has SPSS like numeric codes, they will be recoded to extended
(a-z) missing types when converting to Stata or SAS. If the input has Stata
like extended codes, they will be recoded to SPSS like numeric codes.
</p>
<p>The character <strong><code>encoding</code></strong> is usually passed to the corresponding functions
from package <b><span class="pkg">haven</span></b>. It can be set to <code>NULL</code> to reset at the
default in that package.
</p>
<p>Converting to SPSS works with numerical and character labelled vectors, with
or without labels. Date/Time variables are partially supported by package
<strong>haven</strong>: either having such a variable with no labels and missing values,
or if labels and missing values are declared the variable is automatically
coerced to numeric, and users may have to make the proper settings in SPSS.
</p>


<h3>Value</h3>

<p>An invisible R data frame, when the argument <strong><code>to</code></strong> is NULL.
</p>


<h3>Author(s)</h3>

<p>Adrian Dusa
</p>


<h3>References</h3>

<p>DDI - Data Documentation Initiative, see the
<a href="https://ddialliance.org/">DDI Alliance</a> website.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+setupfile">setupfile</a></code>,
<code><a href="#topic+getCodebook">getCodebook</a></code>,
<code><a href="declared.html#topic+declared">declared</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Assuming an SPSS file called test.sav is located in the working directory
# The following command imports the file into the R environment:
test &lt;- convert("test.sav")

# The following command will extract the metadata in a DDI Codebook and
# produce a test.xml file in the same directory
convert("test.sav", to = "DDI")

# The data may be saved separately from the DDI file, using:
convert("test.sav", to = "DDI", embed = FALSE)

# To produce a Stata file:
convert("test.sav", to = "Stata")

# To produce an R file:
convert("test.sav", to = "R")

# To produce an Excel file:
convert("test.sav", to = "Excel")

## End(Not run)

</code></pre>

<hr>
<h2 id='DDI-children'>Add/remove/change one or more children or attributes from a DDI Codebook
attribute.</h2><span id='topic+DDI-children'></span><span id='topic+addChildren'></span><span id='topic+anyChildren'></span><span id='topic+getChildren'></span><span id='topic+hasChildren'></span><span id='topic+indexChildren'></span><span id='topic+removeChildren'></span><span id='topic+addContent'></span><span id='topic+changeContent'></span><span id='topic+removeContent'></span><span id='topic+addAttributes'></span><span id='topic+anyAttributes'></span><span id='topic+changeAttributes'></span><span id='topic+hasAttributes'></span><span id='topic+removeAttributes'></span>

<h3>Description</h3>

<p><code>addChildren()</code> adds one or more children to a standard DDI Codebook element
(see <code><a href="#topic+makeElement">makeElement</a></code>), <code>anyChildren()</code> checks if an element has any
children at all, <code>hasChildren()</code> checks if the element has specific children,
<code>indexChildren()</code> returns the positions of the children among all containing
children, and <code>getChildren()</code> extracts them. For attributes and content,
there are dedicated functions to <code style="white-space: pre;">&#8288;add*()&#8288;</code>, <code style="white-space: pre;">&#8288;remove*()&#8288;</code> and <code style="white-space: pre;">&#8288;change*()&#8288;</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addChildren(children, to, overwrite = TRUE, ...)

anyChildren(element)

getChildren(xpath, from, ...)

hasChildren(element, name)

indexChildren(element, name)

removeChildren(name, from, overwrite = TRUE, ...)

addContent(content, to, overwrite = TRUE)

changeContent(content, to, overwrite = TRUE)

removeContent(from, overwrite = TRUE)

addAttributes(attrs, to, overwrite = TRUE)

anyAttributes(element)

changeAttributes(attrs, from, overwrite = TRUE)

hasAttributes(element, name)

removeAttributes(name, from, overwrite = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DDI-children_+3A_children">children</code></td>
<td>
<p>A standard element of class <code>"DDI"</code>, or a list of such elements.</p>
</td></tr>
<tr><td><code id="DDI-children_+3A_to">to</code></td>
<td>
<p>A standard element of class <code>"DDI"</code>.</p>
</td></tr>
<tr><td><code id="DDI-children_+3A_overwrite">overwrite</code></td>
<td>
<p>Logical, overwrite the original object in the parent frame.</p>
</td></tr>
<tr><td><code id="DDI-children_+3A_...">...</code></td>
<td>
<p>Other arguments, mainly for internal use.</p>
</td></tr>
<tr><td><code id="DDI-children_+3A_element">element</code></td>
<td>
<p>A standard element of class <code>"DDI"</code>.</p>
</td></tr>
<tr><td><code id="DDI-children_+3A_xpath">xpath</code></td>
<td>
<p>Character, a path to a DDI Codebook element.</p>
</td></tr>
<tr><td><code id="DDI-children_+3A_from">from</code></td>
<td>
<p>A standard element of class <code>"DDI"</code>.</p>
</td></tr>
<tr><td><code id="DDI-children_+3A_name">name</code></td>
<td>
<p>Character, name(s) of specific child element / attribute.</p>
</td></tr>
<tr><td><code id="DDI-children_+3A_content">content</code></td>
<td>
<p>Character, the text content of a DDI element.</p>
</td></tr>
<tr><td><code id="DDI-children_+3A_attrs">attrs</code></td>
<td>
<p>A list of specific attribute names and values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Although an XML list generally allows for multiple contents, sometimes spread
between the children elements, it is preferable to maintain a single content
(eventually separated with carriage return characters for separate lines).
</p>
<p>Arguments are unique, and can be changed by simply referring to their names.
</p>
<p>Elements, however, can be repeated. For instance element <code>var</code> to describe
variables, within the <code>dataDscr</code> (data description) sub-element in the
<code>codeBook</code>. There are as many such <code>var</code> elements as the number of variables
in the dataset, in which case it is not possible to change a specific <code>var</code>
element by referring to its name. For this purpose, it is useful to extract
the positions of all <code>var</code> elements to iterate through, which is the purpose
of the function <code>indexChildren()</code>.
</p>
<p>Future versions will allow deep manipulations of child elements using the
<code>xpath</code> argument.
</p>
<p>If more than one children, they should be grouped into a list.
</p>


<h3>Value</h3>

<p>An invisible standard DDI element. Functions <code style="white-space: pre;">&#8288;any*()&#8288;</code> and <code style="white-space: pre;">&#8288;has*()&#8288;</code>
return a logical (vector).
</p>


<h3>Author(s)</h3>

<p>Adrian Dusa
</p>

<hr>
<h2 id='DDIwR_internal'>DDIwR internal functions</h2><span id='topic+DDIwR_internal'></span><span id='topic+ascii'></span><span id='topic+changeXMLang'></span><span id='topic+checkArgument'></span><span id='topic+checkDots'></span><span id='topic+checkElement'></span><span id='topic+checkExisting'></span><span id='topic+checkType'></span><span id='topic+checkXMList'></span><span id='topic+cleanup'></span><span id='topic+coerceDDI'></span><span id='topic+collectMetadata'></span><span id='topic+collectRMetadata'></span><span id='topic+extractData'></span><span id='topic+formatExample'></span><span id='topic+generateID'></span><span id='topic+getDateTime'></span><span id='topic+getDelimiter'></span><span id='topic+getDNS'></span><span id='topic+getEnter'></span><span id='topic+getFiles'></span><span id='topic+getFormat'></span><span id='topic+getHashes'></span><span id='topic+getValues'></span><span id='topic+getXML'></span><span id='topic+hasLabels'></span><span id='topic+hasMissingLabels'></span><span id='topic+makeLabelled'></span><span id='topic+missingValuesSPSS'></span><span id='topic+prespace'></span><span id='topic+removeExtra'></span><span id='topic+repeatSpace'></span><span id='topic+replaceChars'></span><span id='topic+replaceTicks'></span><span id='topic+splitrows'></span><span id='topic+treatPath'></span><span id='topic+writeMetadata'></span><span id='topic+XMLtoRmetadata'></span><span id='topic+makeNotes'></span><span id='topic+getMetadata'></span><span id='topic+exportDDI'></span><span id='topic+writeRlist'></span>

<h3>Description</h3>

<p>Functions to be used internally, only by developers and
contributors.
</p>
<p><code>ascii</code>: Convert accented unicode characters to pure ascii
</p>
<p><code>changeXMLang</code>: Remove the <code>xmlang</code> attribute from all elements.
</p>
<p><code>checkArgument</code>: Check function arguments
</p>
<p><code>checkDots</code>: Check the three dots ... argument.
If the argument is not supplied via dots, returns a default
</p>
<p><code>checkElement</code>: Check if an element is a DDI Codebook element
</p>
<p><code>checkExisting</code>: Check if a certain (sub)element exists in a DDI Codebook.
</p>
<p><code>checkType</code>: Determine the variable type: categorical, numerical or mixed
</p>
<p><code>checkXMList</code>: Determine if an XML list is a DDI Codebook
</p>
<p><code>cleanup</code>: Rectify texts read from a metadata object
</p>
<p><code>coerceDDI</code>: Recursive coerce an element to a DDI class
</p>
<p><code>collectMetadata</code>: Collect metadata from a file or a dataframe object
</p>
<p><code>collectRMetadata</code>: Collect metadata from a dataframe object
</p>
<p><code>extractData</code>: Extract data from an DDI Codebook XML document or
list.
</p>
<p><code>formatExample</code>: Format an example from the DDI Codebook
specification
</p>
<p><code>generateID</code>: Generate simple, custom unique ID codes
</p>
<p><code>getDateTime</code>: Current date and time
</p>
<p><code>getDelimiter</code>: Guess the column delimiter from a text file
</p>
<p><code>getDNS</code>: Extracts the Default Name Space from an XML object
</p>
<p><code>getEnter</code>: Get the carriage return code from the current Operating System
</p>
<p><code>getFiles</code>: Get information about the files in a given directory
</p>
<p><code>getFormat</code>: Determine the SPSS / Stata variable format
</p>
<p><code>getHashes</code>: Compute hashes of XML nodes
</p>
<p><code>getValues</code>: Extract values, labels and missing values from a <code>var</code> element
</p>
<p><code>getXML</code>: Read the DDI XML file, testing if it can be loaded.
</p>
<p><code>hasLabels</code>: Check if a dataset has (declared) labels
</p>
<p><code>hasMissingLabels</code>: Check if variables have missing labels
</p>
<p><code>makeLabelled</code>: Coerce variables to labelled objects
</p>
<p><code>missingValuesSPSS</code>: Prepares the missing values for the SPSS export syntax.
</p>
<p><code>prespace</code>: Prepend a text with a certain number of space characters.
</p>
<p><code>removeExtra</code>: Removes extra information from a DDI Codebook element
</p>
<p><code>repeatSpace</code>: Allows indentation of XML or HTML files
</p>
<p><code>replaceChars</code>: Replace certain characters, in preparation for XML export
</p>
<p><code>replaceTicks</code>: Recode all tick characters with a single quote.
</p>
<p><code>splitrows</code>: Split the written rows in the setup file.
</p>
<p><code>treatPath</code>: Determine which specific type of files are
present in a certain directory.
</p>
<p><code>writeMetadata</code>: Utility function to write the metadata
part in the setup file.
</p>
<p><code>XMLtoRmetadata</code>: Extract metadata from a single XML variable
</p>
<p><code>writeRlist</code>: Write an .R file containing a metadata specific list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ascii(x)

changeXMLang(x, remove = FALSE)

checkArgument(argument, default, length = 1, ...)

checkDots(dotsvalue, default, length = 1)

checkElement(x)

checkExisting(xpath, inside, attribute = NULL)

checkType(x, labels = NULL, na_values = NULL, na_range = NULL)

checkXMList(xmlist)

cleanup(x, cdata = TRUE)

coerceDDI(element, name = NULL)

collectMetadata(from, ...)

collectRMetadata(from, ...)

extractData(xml)

formatExample(xml_node, level = 0, indent = 2, output = NULL, ...)

generateID(x, nchars = 16)

getDateTime()

getDelimiter(x)

getDNS(xml)

getEnter(OS)

getFiles(path = ".", type = "*", currdir)

getFormat(x, type = c("SPSS", "Stata"), ...)

getHashes(nodes)

getValues(variable)

getXML(path, encoding = "UTF-8")

hasLabels(x)

hasMissingLabels(variables)

makeLabelled(x, variables, declared = TRUE)

missingValuesSPSS(variables, range = FALSE, numvars = TRUE)

prespace(text, indent = NULL)

removeExtra(element)

repeatSpace(times, indent)

replaceChars(x)

replaceTicks(x)

splitrows(x, enter, y = 80, spacerep = "")

treatPath(path, type = "*", single = FALSE, check = TRUE)

writeMetadata(variables, OS = "", indent = 4)

XMLtoRmetadata(xmlvar, dns)

makeNotes(data)

getMetadata(...)

exportDDI(...)

writeRlist(variables, OS = "windows", indent = 4, dirpath = "", filename = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DDIwR_internal_+3A_x">x</code></td>
<td>
<p>Number of ID values to return</p>
</td></tr>
<tr><td><code id="DDIwR_internal_+3A_nchars">nchars</code></td>
<td>
<p>Number of characters for each ID</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>changeXMLang</code>: A modified <code>codeBook</code> element.
</p>
<p><code>checkElement</code>: Boolean.
</p>
<p><code>checkExisting</code>: Boolean.
</p>
<p><code>checkType</code>: A character scalar
</p>
<p><code>cleanup</code>: A character vector
</p>
<p><code>coerceDDI</code>: A standard element of class DDI
</p>
<p><code>collectMetadata</code>: a standard DDI Codebook element <code>dataDscr</code>,
containing variable level metadata information
</p>
<p><code>collectRMetadata</code>: an R list containing variable level metadata information
</p>
<p><code>extractData</code>: An R data frame, if existing, or NULL
</p>
<p><code>generateID</code>: Character vector
</p>
<p><code>getDateTime</code>: Character vector
</p>
<p><code>getDelimiter</code>: Character scalar
</p>
<p><code>getDNS</code>: Character scalar
</p>
<p><code>getEnter</code>: Character scalar
</p>
<p><code>getFiles</code>: A list with four components: the complete path, the files, the file names and the file extensions
</p>
<p><code>getFormat</code>: Character scalar
</p>
<p><code>getHashes</code>: Character vector
</p>
<p><code>getValues</code>: A list with two components: <code>labels</code> and <code>na_values</code>
</p>
<p><code>getXML</code>: An XML document
</p>
<p><code>hasLabels</code>: Boolean
</p>
<p><code>hasMissingLabels</code>: Boolean vector
</p>
<p><code>makeLabelled</code>: A modified data frame.
</p>
<p><code>missingValuesSPSS</code>: A vector of missing values representation.
</p>
<p><code>prespace</code>: A modified text.
</p>
<p><code>removeExtra</code>: A modified element.
</p>
<p><code>repeatSpace</code>: Character spaces
</p>
<p><code>replaceChars</code>: Character vector
</p>
<p><code>replaceTicks</code>: A recoded string.
</p>
<p><code>splitrows</code>: A character vector.
</p>
<p><code>treatPath</code>: A list with four components: the complete path, the
files, the file names and the file extensions
</p>
<p><code>XMLtoRmetadata</code>: An R list containing metadata
</p>

<hr>
<h2 id='exportCodebook'>Export a DDI Codebook to an XML file.</h2><span id='topic+exportCodebook'></span>

<h3>Description</h3>

<p>Create a DDI Codebook version 2.6, XML file structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exportCodebook(codeBook, to = "", OS = "", indent = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exportCodebook_+3A_codebook">codeBook</code></td>
<td>
<p>A standard element of class <code>"DDI"</code>.</p>
</td></tr>
<tr><td><code id="exportCodebook_+3A_to">to</code></td>
<td>
<p>either a character string naming a file or a connection open for
writing (&quot;&quot; indicates output to the console)</p>
</td></tr>
<tr><td><code id="exportCodebook_+3A_os">OS</code></td>
<td>
<p>The target operating system, for the eol - end of line character(s)</p>
</td></tr>
<tr><td><code id="exportCodebook_+3A_indent">indent</code></td>
<td>
<p>Indent width, in number of spaces</p>
</td></tr>
<tr><td><code id="exportCodebook_+3A_...">...</code></td>
<td>
<p>Other arguments, mainly for internal use</p>
</td></tr>
</table>


<h3>Details</h3>

<p>#' The information object is a <code>codeBook</code> DDI element having at least two
main children:
</p>

<ul>
<li> <p><strong><code>fileDscr</code></strong>, with the data provided as a sub-component named
<strong><code>datafile</code></strong>
</p>
</li>
<li> <p><strong><code>dataDscr</code></strong>, having as many components as the number of variables in the
(meta)data.
</p>
</li></ul>

<p>For the moment, only DDI codebook version 2.6 is exported, and DDI Lifecycle
is planned for future releases.
</p>
<p>A small number of required DDI specific elements and attributes have generic
default values, if not otherwise specified in the <code>codeBook</code> list object. For
the current version, these are: <code>monolang</code>, <code>xmlang</code>, <code>IDNo</code>, <code>titl</code>,
<code>agency</code>, <code>URI</code> (for the <code>holdings</code> element), <code>distrbtr</code>, <code>abstract</code> and
<code>level</code> (for the <code>otherMat</code> element).
</p>
<p>The <code>codeBook</code> object is exported as provided, and it is the user's
responsibility to test its validity against the XML schema. Most of these
arguments help create the mandatory element <code>stdyDscr</code>, which cannot be
harvested from the dataset. If this element is not already present, providing
any of these arguments via the three dots <code>...</code> gate, signal an automatic
creation and inclusion with the values provided.
</p>
<p>Argument <strong><code>xmlang</code></strong> expects a two letter ISO country coding, for instance
<code>"en"</code> to indicate English, or <code>"ro"</code> to indicate Romanian etc. The original
DDI Codebook attribute is called <strong><code>xml:lang</code></strong>, which for obvious reasons
had to be renamed into this R function.
</p>
<p>A logical argument <code>monolang</code> signal if the document is monolingual, in which
case the attribute <code>xmlang</code> is placed a single time for the entire document
in the <code>codeBook</code> element. For multilingual documents, <code>xmlang</code> should be
placed in the attributes of various other (child) elements, for instance
<code>abstract</code>, or the study title, name of the distributing institution,
variable labels etc.
</p>
<p>The argument <strong><code>OS</code></strong> can be either:<br />
<code>"windows"</code> (default), or <code>"Windows"</code>, <code>"Win"</code>, <code>"win"</code>,<br />
<code>"MacOS"</code>, <code>"Darwin"</code>, <code>"Apple"</code>, <code>"Mac"</code>, <code>"mac"</code>,<br />
<code>"Linux"</code>, <code>"linux"</code>.
</p>
<p>The end of line separator changes only when the target OS is different from
the running OS.
</p>
<p>The argument <strong><code>indent</code></strong> controls how many spaces will be used in the XML
file, to indent the different sub-elements.
</p>


<h3>Value</h3>

<p>An XML file containing a DDI version 2.6 metadata.
</p>


<h3>Author(s)</h3>

<p>Adrian Dusa
</p>


<h3>See Also</h3>

<p><a href="https://ddialliance.org/Specification/DDI-Codebook/2.5/XMLSchema/field_level_documentation.html">https://ddialliance.org/Specification/DDI-Codebook/2.5/XMLSchema/field_level_documentation.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
exportCodebook(codeBook, to = "codebook.xml")

# using a namespace
exportCodebook(codeBook, to = "codebook.xml", xmlns = "ddi")

## End(Not run)

</code></pre>

<hr>
<h2 id='getCodebook'>Extract metadata information</h2><span id='topic+getCodebook'></span>

<h3>Description</h3>

<p>Extract a list containing the variable labels, value labels and any
available information about missing values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getCodebook(from = NULL, encoding = "UTF-8", ignore = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getCodebook_+3A_from">from</code></td>
<td>
<p>A path to a file, or a data frame object</p>
</td></tr>
<tr><td><code id="getCodebook_+3A_encoding">encoding</code></td>
<td>
<p>The character encoding used to read a file</p>
</td></tr>
<tr><td><code id="getCodebook_+3A_ignore">ignore</code></td>
<td>
<p>Character, ignore DDI elements when reading from an XML file</p>
</td></tr>
<tr><td><code id="getCodebook_+3A_...">...</code></td>
<td>
<p>Additional arguments for this function (internal use only)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function extracts the metadata from an R dataset, or alternatively it
can read an XML file containing a DDI codebook version 2.6, or an
SPSS or Stata file and returns a list containing the variable labels, value
labels and information about the missing values.
</p>
<p>If the input is a dataset, it will extract the variable level metadata
(labels, missing values etc.). From a DDI XML file, it will import all
metadata elements, the most expensive being the data description.
</p>
<p>For the moment, only DDI Codebook is supported, but DDI Lifecycle is planned
to be implemented.
</p>


<h3>Value</h3>

<p>An R list roughly equivalent to a DDI Codebook, containing all variables,
their corresponding variable labels and value labels, and (if applicable)
missing values if imported and found.
</p>


<h3>Author(s)</h3>

<p>Adrian Dusa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- data.frame(
    A = declared(
        c(1:5, -92),
        labels = c(Good = 1, Bad = 5, NR = -92),
        na_values = -92
    ),
    C = declared(
        c(1, -91, 3:5, -92),
        labels = c(DK = -91, NR = -92),
        na_values = c(-91, -92)
    )
)

getCodebook(from = x)

</code></pre>

<hr>
<h2 id='makeCategories'>Create the <code>catgry</code> elements for a particular variable</h2><span id='topic+makeCategories'></span>

<h3>Description</h3>

<p>Utility function to create the <code>catgry</code> elements, as well as all
necessary sub-elements (e.g. <code>catValu</code>, <code>labl</code>, <code>varFormat</code>) along with their
associated XML attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeCategories(metadata)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeCategories_+3A_metadata">metadata</code></td>
<td>
<p>A list of two or three components: <code>labels</code>,
<code>na_values</code> and/or <code>na_range</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of standard <code>catgry</code> DDI elements.
</p>


<h3>Author(s)</h3>

<p>Adrian Dusa
</p>

<hr>
<h2 id='makeDataNotes'>Create a <code>notes</code> element for the dataset.</h2><span id='topic+makeDataNotes'></span>

<h3>Description</h3>

<p>Create the <code>notes</code> element to embed a serialized, gzip-ed version of the data
in the <code>fileDscr</code> section of the <code>codeBook</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeDataNotes(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeDataNotes_+3A_data">data</code></td>
<td>
<p>An R dataframe.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A standard <code>notes</code> DDI element.
</p>


<h3>Author(s)</h3>

<p>Adrian Dusa
</p>

<hr>
<h2 id='makeElement'>Make a DDI Codebook element</h2><span id='topic+makeElement'></span>

<h3>Description</h3>

<p>Creates a standard DDI element.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeElement(
  name,
  children = NULL,
  attributes = NULL,
  content = NULL,
  fill = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeElement_+3A_name">name</code></td>
<td>
<p>Character, a DDI Codebook element name.</p>
</td></tr>
<tr><td><code id="makeElement_+3A_children">children</code></td>
<td>
<p>A list of standard DDI codebook elements.</p>
</td></tr>
<tr><td><code id="makeElement_+3A_attributes">attributes</code></td>
<td>
<p>A vector of named values.</p>
</td></tr>
<tr><td><code id="makeElement_+3A_content">content</code></td>
<td>
<p>Character scalar.</p>
</td></tr>
<tr><td><code id="makeElement_+3A_fill">fill</code></td>
<td>
<p>Logical, fill the element with arbitrary values for its
mandatory children and attributes</p>
</td></tr>
<tr><td><code id="makeElement_+3A_...">...</code></td>
<td>
<p>Other arguments, see Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The structure of a DDI element in R follows the usual structure of
an XML node, as returned by the function <code>as_list()</code> from package <strong>xml2</strong>,
with one additional (first) component named &quot;.extra&quot; to accommodate any other
information that is not part of the DDI element.
</p>
<p>In the DDI Codebook, most elements and their attributes are optional, but
some are mandatory. In case of attributes, some become mandatory only if the
element itself is present. The mandatory elements need to be present in the
final version of the Codebook, to pass the validation against the XML schema.
</p>
<p>By activating the argument <code>fill</code>, this function creates DDI elements
containing all mandatory (sub)elements and (their) attributes, filled with
arbitrary values that can be changed later on. Some recommended elements are
also filled, as expected by the CESSDA Data Catalogue profile for DDI
Codebook.
</p>
<p>By default, the Codebook is assumed to have a single language for all
elements. The argument <code>monolang</code> can be deactivated through the &quot;<code>...</code>&quot;
gate, in which situation the appropriate elements will receive a default
argument <code>xmlang = "en"</code>. For other languages, that argument can also be
provided through the &quot;<code>...</code>&quot; gate.
</p>
<p>One such DDI Codebook element is the <code>stdyDscr</code> (Study Description), with the
associated mandatory children, for instance title, ID number, distributor,
citation, abstract etc.
</p>
<p>The complete list of elements for which default values are added is: &quot;IDNo&quot;,
&quot;titl&quot;, &quot;titlStmt&quot;, &quot;distrbtr&quot;, &quot;distStmt&quot;, &quot;holdings&quot;, &quot;citation&quot;,
&quot;abstract&quot;, &quot;stdyInfo&quot;, &quot;stdyDscr&quot;, &quot;prodDate&quot;, &quot;software&quot;, &quot;prodStmt&quot;,
&quot;docDscr&quot; and &quot;otherMat&quot;.
</p>


<h3>Value</h3>

<p>A standard list element of class <code>"DDI"</code> with reserved component names.
</p>


<h3>Author(s)</h3>

<p>Adrian Dusa
</p>


<h3>See Also</h3>

<p><code><a href="#topic+addChildren">addChildren</a></code>
<code><a href="#topic+getChildren">getChildren</a></code>
<code><a href="#topic+showDetails">showDetails</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>stdyDscr &lt;- makeElement("stdyDscr", fill = TRUE)

# easier to extract with:
getChildren("citation/titlStmt/titl", from = stdyDscr)

</code></pre>

<hr>
<h2 id='recodeCharcat'>Recode character categorical variables</h2><span id='topic+recodeCharcat'></span>

<h3>Description</h3>

<p>Recodes a character categorical variables to a numerical categorical
variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recodeCharcat(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="recodeCharcat_+3A_x">x</code></td>
<td>
<p>A character categorical variable</p>
</td></tr>
<tr><td><code id="recodeCharcat_+3A_...">...</code></td>
<td>
<p>Other internal arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For this function, a categorical variable is something else than a base
factor. It should be an object of class <code>"declared"</code>, or an object of class
<code>"haven_labelled_spss"</code>, with a specific attribute called <code>"labels"</code> that
stores the value labels.
</p>


<h3>Value</h3>

<p>A numeric categorical variable of the same class as the input.
</p>


<h3>Author(s)</h3>

<p>Adrian Dusa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- declared(
    c(letters[1:5], -91),
    labels = c(Good = "a", Bad = "e", NR = -91),
    na_values = -91
)

recodeCharcat(x)

</code></pre>

<hr>
<h2 id='recodeMissings'>Consistent recoding of (extended) missing values</h2><span id='topic+recodeMissings'></span>

<h3>Description</h3>

<p>A function to recode all missing values to either SPSS or Stata types,
uniformly (re)using the same codes across all variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recodeMissings(
  dataset,
  to = c("SPSS", "Stata", "SAS"),
  dictionary = NULL,
  start = -91,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="recodeMissings_+3A_dataset">dataset</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="recodeMissings_+3A_to">to</code></td>
<td>
<p>Software to recode missing values for</p>
</td></tr>
<tr><td><code id="recodeMissings_+3A_dictionary">dictionary</code></td>
<td>
<p>A named vector, with corresponding Stata missing codes to SPSS missing values</p>
</td></tr>
<tr><td><code id="recodeMissings_+3A_start">start</code></td>
<td>
<p>A named vector, with corresponding Stata missing codes to SPSS missing values</p>
</td></tr>
<tr><td><code id="recodeMissings_+3A_...">...</code></td>
<td>
<p>Other internal arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When a dictionary is not provided, it is automatically constructed from the
available data and metadata, using negative numbers starting from -91 and up
to 27 letters starting with &quot;a&quot;.
</p>
<p>If the dataset contains mixed variables with SPSS and Stata style missing
values, unless otherwise specified in a dictionary it uses other codes than
the existing ones.
</p>
<p>For the SPSS type of missing values, the resulting variables are coerced to a
declared labelled format.
</p>
<p>Unlike SPSS, Stata does not allow labels for character values. Both cannot be
transported from SPSS to Stata, it is either one or another. If labels are
more important to preserve than original values (especially the information
about the missing values), the argument <code>chartonum</code> replaces all character
values with suitable, non-overlapping numbers and adjusts the labels
accordingly.
</p>
<p>If no labels are found in the metadata, the original values are preserved.
</p>


<h3>Value</h3>

<p>A data frame with all missing values recoded consistently.
</p>


<h3>Author(s)</h3>

<p>Adrian Dusa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- data.frame(
    A = declared(
        c(1:5, -92),
        labels = c(Good = 1, Bad = 5, NR = -92),
        na_values = -92
    ),
    B = labelled(
        c(1:5, haven::tagged_na('a')),
        labels = c(DK = haven::tagged_na('a'))
    ),
    C = declared(
        c(1, -91, 3:5, -92),
        labels = c(DK = -91, NR = -92),
        na_values = c(-91, -92)
    )
)

xrec &lt;- recodeMissings(x, to = "Stata")

attr(xrec, "dictionary")

dictionary &lt;- data.frame(
    old = c(-91, -92, "a"),
    new = c("c", "d", "c")
)
recodeMissings(x, to = "Stata", dictionary = dictionary)

recodeMissings(x, to = "SPSS")

dictionary$new &lt;- c(-97, -98, -97)

recodeMissings(x, to = "SPSS", dictionary = dictionary)

recodeMissings(x, to = "SPSS", start = 991)

recodeMissings(x, to = "SPSS", start = -8)

</code></pre>

<hr>
<h2 id='searchFor'>Search for key words</h2><span id='topic+searchFor'></span>

<h3>Description</h3>

<p>Search function to return elements that contain a certain
word or regular expression pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>searchFor(
  x,
  where = c("everywhere", "title", "description", "attributes", "examples"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="searchFor_+3A_x">x</code></td>
<td>
<p>Character, either word(s) or a regular expression.</p>
</td></tr>
<tr><td><code id="searchFor_+3A_where">where</code></td>
<td>
<p>Character, in which section(s) to search for.</p>
</td></tr>
<tr><td><code id="searchFor_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to the grepl() function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of DDI element names.
</p>


<h3>Author(s)</h3>

<p>Adrian Dusa
</p>

<hr>
<h2 id='setupfile'>Create setup files for SPSS, Stata, SAS and R</h2><span id='topic+setupfile'></span>

<h3>Description</h3>

<p>Creates a setup file, based on a list of variable and value labels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setupfile(
  obj,
  file = "",
  type = "all",
  csv = NULL,
  recode = TRUE,
  OS = "",
  stringnum = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setupfile_+3A_obj">obj</code></td>
<td>
<p>A data frame, or a list object containing the metadata, or a path to a data
file or to a directory where such objects are located, for batch processing</p>
</td></tr>
<tr><td><code id="setupfile_+3A_file">file</code></td>
<td>
<p>Character, the (path to the) setup file to be created</p>
</td></tr>
<tr><td><code id="setupfile_+3A_type">type</code></td>
<td>
<p>The type of setup file, can be: &quot;SPSS&quot;, &quot;Stata&quot;, &quot;SAS&quot;, &quot;R&quot;, or &quot;all&quot;
(default)</p>
</td></tr>
<tr><td><code id="setupfile_+3A_csv">csv</code></td>
<td>
<p>The original dataset, used to create the setup file commands, or a path
to the directory where the .csv files are located, for batch processing</p>
</td></tr>
<tr><td><code id="setupfile_+3A_recode">recode</code></td>
<td>
<p>Logical, recode missing values to extended .a-.z range</p>
</td></tr>
<tr><td><code id="setupfile_+3A_os">OS</code></td>
<td>
<p>The target operating system, for the eol - end of line character(s)</p>
</td></tr>
<tr><td><code id="setupfile_+3A_stringnum">stringnum</code></td>
<td>
<p>Logical, recode string variables to numeric</p>
</td></tr>
<tr><td><code id="setupfile_+3A_...">...</code></td>
<td>
<p>Other arguments, see Details below</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When a path to a metadata directory is specified for the argument <strong><code>obj</code></strong>,
then next argument <strong><code>file</code></strong> is silently ignored and all created setup files
are saved in a directory called &quot;Setup Files&quot; that (if not already found) is
created in the working directory.
</p>
<p>The argument <strong><code>file</code></strong> expects the name of the final setup file being
saved on the disk. If not specified, the name of the object provided for the
<strong><code>obj</code></strong> argument will be used as a filename.
</p>
<p>If <strong><code>file</code></strong> is specified, the argument <strong><code>type</code></strong> is automatically
determined from the file's extension, otherwise when <strong><code>type = "all"</code></strong>, the
function produces one setup file for each supported type.
</p>
<p>If batch processing multiple files, the function will inspect all files in
the provided directory, and retain only those with the extension  <code>.R</code> or
<code>.r</code> or DDI versions with the extension <code>.xml</code> or <code>.XML</code> (it will
subsequently generate an error if the .R files do not contain an object list,
or if the <code>.xml</code> files do not contain a DDI structured metadata file).
</p>
<p>If the metadata directory contains a subdirectory called <code>"data"</code> or
<code>"Data"</code>, it will match the name of the metadata file with the name of the
<code>.csv</code> file (their names have to be <em>exactly</em> the same, regardless of
their extension).
</p>
<p>The <strong><code>csv</code></strong> argument can provide a data frame object produced by reading
the <code>.csv</code> file, or a path to the directory where the <code>.csv</code> files are
located. If the user doesn't provide something for this argument, the
function will check the existence of a subdirectory called <code>data</code> in the
directory where the metadata files are located.
</p>
<p>In batch mode, the code starts with the argument <strong><code>delim = ","</code></strong>, but if
the <code>.csv</code> file is delimited differently it will also try hard to find other
delimiters that will match the variable names in the metadata file. At the
initial version 0.1-0, the automatically detected delimiters include <code>";"</code>
and <code>"\t"</code>.
</p>
<p>The argument <code>OS</code> (case insensitive) can be either:<br />
<code>"Windows"</code> (default), or <code>"Win"</code>,<br />
<code>"MacOS"</code>, <code>"Darwin"</code>, <code>"Apple"</code>, <code>"Mac"</code>,<br />
<code>"Linux"</code>.<br />
</p>
<p>The end of line character(s) changes only when the target OS is different
from the running OS.
</p>


<h3>Value</h3>

<p>A setup file to complement the imported raw dataset.
</p>


<h3>Author(s)</h3>

<p>Adrian Dusa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
# IMPORTANT:
# make sure to set the working directory to a directory with
# read/write permissions
# setwd("/path/to/read/write/directory")


setupfile(codeBook)


# if the csv data file is available
setupfile(codeBook, csv="/path/to/csv/file.csv")


# generating a specific type of setup file
setupfile(codeBook, file = "codeBook.do") # type = "Stata" also works


# other types of possible utilizations, using paths to specific files
# an XML file containing a DDI metadata object

setupfile("/path/to/the/metadata/file.xml", csv="/path/to/csv/file.csv")


# or in batch mode, specifying entire directories
setupfile("/path/to/the/metadata/directory", csv="/path/to/csv/directory")

## End(Not run)

</code></pre>

<hr>
<h2 id='showDetails'>Describe what a DDI element is</h2><span id='topic+showDetails'></span><span id='topic+showDescription'></span><span id='topic+showAttributes'></span><span id='topic+globalAttributes'></span><span id='topic+showExamples'></span><span id='topic+showRelations'></span><span id='topic+showLineages'></span>

<h3>Description</h3>

<p>Describe what a DDI element is
</p>


<h3>Usage</h3>

<pre><code class='language-R'>showDetails(x, ...)

showDescription(x, ...)

showAttributes(x, name = NULL, ...)

globalAttributes()

showExamples(x, ...)

showRelations(x, ...)

showLineages(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="showDetails_+3A_x">x</code></td>
<td>
<p>Character, a DDI Codebook element name.</p>
</td></tr>
<tr><td><code id="showDetails_+3A_...">...</code></td>
<td>
<p>Other arguments, mainly for internal use.</p>
</td></tr>
<tr><td><code id="showDetails_+3A_name">name</code></td>
<td>
<p>Character, print only a specific element (name)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All arguments having predefined values such as &quot;(Y | N) : N&quot; are
mandatory if the element is used
</p>


<h3>Author(s)</h3>

<p>Adrian Dusa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showDetails("codeBook")

showAttributes("catgry")

showExamples("abstract")

showLineages("titl")

</code></pre>

<hr>
<h2 id='testValid'>Validate a DDI element.</h2><span id='topic+testValid'></span>

<h3>Description</h3>

<p>Attempts a minimal validation of a DDI Codebook element, by
searching for mandatory elements and attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testValid(element, monolang = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="testValid_+3A_element">element</code></td>
<td>
<p>A standard element of class <code>"DDI"</code>.</p>
</td></tr>
<tr><td><code id="testValid_+3A_monolang">monolang</code></td>
<td>
<p>Logical, the codebook file is monolingual</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function currently attempts a minimal check for the absolute
most mandatory elements, such as the <code>stdyDscr</code>. An absolute bare version
of this element, filled with arbitrary default values, can be produced with
the function <code>makeElement()</code>, activating its attribute <code>fill</code>.
It also checks for chained expectations, that is element X is mandatory only
if the parent element is present.
</p>
<p>Future versions will implement more functionality for recommended elements
and attributes, with the intention to provide a 1:1 validation as offered by
the &quot;CESSDA Metadata Validator&quot;.
</p>
<p>To ease the validation of the DDI Codebook XML files, the argument <code>monolang</code>
is activated by default. This means a single attribute <code>xmlang</code> in the main
<code>codeBook</code> element. For multi-language codebooks, an error is flagged if this
argument is missing where appropriate.
</p>


<h3>Value</h3>

<p>A character vector of validation problems found.
</p>


<h3>Author(s)</h3>

<p>Adrian Dusa
</p>


<h3>See Also</h3>

<p><code><a href="#topic+makeElement">makeElement</a></code>
</p>

<hr>
<h2 id='updateCodebook'>Update Codebook.</h2><span id='topic+updateCodebook'></span>

<h3>Description</h3>

<p>Update an XML file containing a DDI Codebook.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateCodebook(xmlfile, with, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updateCodebook_+3A_xmlfile">xmlfile</code></td>
<td>
<p>A path to a DDI Codebook XML document.</p>
</td></tr>
<tr><td><code id="updateCodebook_+3A_with">with</code></td>
<td>
<p>An R object containing a root <code>codeBook</code> element.</p>
</td></tr>
<tr><td><code id="updateCodebook_+3A_...">...</code></td>
<td>
<p>Other internal arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function replaces entire Codebook sections. Any such section present in
the R object will replace the corresponding section from the XML document.
</p>


<h3>Author(s)</h3>

<p>Adrian Dusa
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
