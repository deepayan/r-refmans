<!DOCTYPE html><html><head><title>Help for package pseudorank</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pseudorank}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pseudorank-package'>
<p>Pseudo-Ranks</p></a></li>
<li><a href='#hettmansperger_norton_test'><p>Hettmansperger-Norton Trend Test for k-Samples</p></a></li>
<li><a href='#hettmansperger_norton_test_internal'><p>Hettmansperger-Norton Trend Test for k-Samples</p></a></li>
<li><a href='#kepner_robinson_test'><p>Kepner-Robinson Test</p></a></li>
<li><a href='#kepner_robinson_test_internal'><p>Kepner-Robinson Test</p></a></li>
<li><a href='#kruskal_wallis_internal'><p>Hettmansperger-Norton Trend Test for k-Samples</p></a></li>
<li><a href='#kruskal_wallis_test'><p>Kruskal-Wallis Test</p></a></li>
<li><a href='#ParadoxicalRanks'><p>Artifical data of 54 subjects</p></a></li>
<li><a href='#pseudorank'><p>Calculation of Pseudo-Ranks</p></a></li>
<li><a href='#psrank'><p>Calculation of Pseudo-Ranks (Deprecated)</p></a></li>
<li><a href='#recursiveCalculation'><p>Calculation of Pseudo-Ranks</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Pseudo-Ranks</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-10-02</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Martin Happ &lt;martin.happ@aon.at&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Efficient calculation of pseudo-ranks and (pseudo)-rank based test statistics. In case of equal sample sizes, pseudo-ranks and mid-ranks are equal. When used for inference mid-ranks may lead to paradoxical results. Pseudo-ranks are in general not affected by such a problem &lt;<a href="https://doi.org/10.18637%2Fjss.v095.c01">doi:10.18637/jss.v095.c01</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.16), doBy</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/happma/pseudorank/">https://github.com/happma/pseudorank/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/happma/pseudorank/issues/">https://github.com/happma/pseudorank/issues/</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-10-02 07:25:38 UTC; mhapp</td>
</tr>
<tr>
<td>Author:</td>
<td>Martin Happ <a href="https://orcid.org/0000-0003-0009-2665"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Georg Zimmermann [aut],
  Arne C. Bathke [aut],
  Edgar Brunner [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-10-02 08:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='pseudorank-package'>
Pseudo-Ranks
</h2><span id='topic+pseudorank-package'></span>

<h3>Description</h3>

<p>This packge provides functions to calculate pseudo-ranks. Rank based test statistics (e.g. Kruskal-Wallis test) may lead to paradoxical results
as the weighted relative effects (based on ranks) depend on the sample sizes (Brunner, 2018). Pseudo-ranks do not have these problems.
</p>


<h3>Author(s)</h3>

<p>Maintainer: Martin Happ &lt;martin.happ@aon.at&gt;
</p>


<h3>References</h3>

<p>Brunner, E., Konietschke, F., Bathke, A. C., &amp; Pauly, M. (2018). Ranks and Pseudo-Ranks-Paradoxical Results of Rank Tests. arXiv preprint arXiv:1802.05650.
</p>
<p>Brunner, E., Bathke, A.C., and Konietschke, F. (2018a). Rank- and Pseudo-Rank Procedures for Independent Observations in Factorial Designs - Using R and SAS. Springer Series in Statistics, Springer, Heidelberg. ISBN: 978-3-030-02912-8.
</p>
<p>Happ M, Zimmermann G, Brunner E, Bathke AC (2020). Pseudo-Ranks: How to Calculate Them Efficiently in R. Journal of Statistical Software, Code Snippets, *95*(1), 1-22. doi: 10.18637/jss.v095.c01 (URL:https://doi.org/10.18637/jss.v095.c01).
</p>

<hr>
<h2 id='hettmansperger_norton_test'>Hettmansperger-Norton Trend Test for k-Samples</h2><span id='topic+hettmansperger_norton_test'></span><span id='topic+hettmansperger_norton_test.numeric'></span><span id='topic+hettmansperger_norton_test.formula'></span>

<h3>Description</h3>

<p>This function calculates the Hettmansperger-Norton trend test using pseudo-ranks under the null hypothesis H0F: F_1 = ... F_k.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hettmansperger_norton_test(x, ...)

## S3 method for class 'numeric'
hettmansperger_norton_test(
  x,
  y,
  na.rm = FALSE,
  alternative = c("decreasing", "increasing", "custom"),
  trend = NULL,
  pseudoranks = TRUE,
  ...
)

## S3 method for class 'formula'
hettmansperger_norton_test(
  formula,
  data,
  na.rm = FALSE,
  alternative = c("decreasing", "increasing", "custom"),
  trend = NULL,
  pseudoranks = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hettmansperger_norton_test_+3A_x">x</code></td>
<td>
<p>vector containing the observations</p>
</td></tr>
<tr><td><code id="hettmansperger_norton_test_+3A_...">...</code></td>
<td>
<p>further arguments are ignored</p>
</td></tr>
<tr><td><code id="hettmansperger_norton_test_+3A_y">y</code></td>
<td>
<p>vector specifiying the group to which the observations from the x vector belong to</p>
</td></tr>
<tr><td><code id="hettmansperger_norton_test_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating if NA values should be removed</p>
</td></tr>
<tr><td><code id="hettmansperger_norton_test_+3A_alternative">alternative</code></td>
<td>
<p>either decreasing (trend k, k-1, ..., 1) or increasing (1, 2, ..., k) or custom (then argument trend must be specified)</p>
</td></tr>
<tr><td><code id="hettmansperger_norton_test_+3A_trend">trend</code></td>
<td>
<p>custom numeric vector indicating the trend for the custom alternative, only used if alternative = &quot;custom&quot;</p>
</td></tr>
<tr><td><code id="hettmansperger_norton_test_+3A_pseudoranks">pseudoranks</code></td>
<td>
<p>logical value indicating if pseudo-ranks or ranks should be used</p>
</td></tr>
<tr><td><code id="hettmansperger_norton_test_+3A_formula">formula</code></td>
<td>
<p>formula object</p>
</td></tr>
<tr><td><code id="hettmansperger_norton_test_+3A_data">data</code></td>
<td>
<p>data.frame containing the variables in the formula (observations and group)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object.
</p>


<h3>References</h3>

<p>Brunner, E., Bathke, A.C., and Konietschke, F. (2018a). Rank- and Pseudo-Rank Procedures for Independent Observations in Factorial Designs - Using R and SAS. Springer Series in Statistics, Springer, Heidelberg. ISBN: 978-3-030-02912-8.
</p>
<p>Happ M, Zimmermann G, Brunner E, Bathke AC (2020). Pseudo-Ranks: How to Calculate Them Efficiently in R. Journal of Statistical Software, Code Snippets, *95*(1), 1-22. doi: 10.18637/jss.v095.c01 (URL:https://doi.org/10.18637/jss.v095.c01).
</p>
<p>Hettmansperger, T. P., &amp; Norton, R. M. (1987). Tests for patterned alternatives in k-sample problems. Journal of the American Statistical Association, 82(397), 292-299
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create some data, please note that the group factor needs to be ordered
df &lt;- data.frame(data = c(rnorm(40, 3, 1), rnorm(40, 2, 1), rnorm(20, 1, 1)),
  group = c(rep(1,40),rep(2,40),rep(3,20)))
df$group &lt;- factor(df$group, ordered = TRUE)

# you can either test for a decreasing, increasing or custom trend
hettmansperger_norton_test(df$data, df$group, alternative="decreasing")
hettmansperger_norton_test(df$data, df$group, alternative="increasing")
hettmansperger_norton_test(df$data, df$group, alternative="custom", trend = c(1, 3, 2))
</code></pre>

<hr>
<h2 id='hettmansperger_norton_test_internal'>Hettmansperger-Norton Trend Test for k-Samples</h2><span id='topic+hettmansperger_norton_test_internal'></span>

<h3>Description</h3>

<p>This function calculates the Hettmansperger-Norton trend test using pseudo-ranks under the null hypothesis H0F: F_1 = ... F_k.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hettmansperger_norton_test_internal(
  data,
  group,
  na.rm,
  alternative = c("decreasing", "increasing", "custom"),
  formula = NULL,
  trend = NULL,
  pseudoranks = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hettmansperger_norton_test_internal_+3A_data">data</code></td>
<td>
<p>numeric vector containing the data</p>
</td></tr>
<tr><td><code id="hettmansperger_norton_test_internal_+3A_group">group</code></td>
<td>
<p>ordered factor vector for the groups</p>
</td></tr>
<tr><td><code id="hettmansperger_norton_test_internal_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating if NA values should be removed</p>
</td></tr>
<tr><td><code id="hettmansperger_norton_test_internal_+3A_alternative">alternative</code></td>
<td>
<p>either decreasing or increasing</p>
</td></tr>
<tr><td><code id="hettmansperger_norton_test_internal_+3A_formula">formula</code></td>
<td>
<p>formula object</p>
</td></tr>
<tr><td><code id="hettmansperger_norton_test_internal_+3A_trend">trend</code></td>
<td>
<p>custom numeric vector indicating the trend for the custom alternative, only used if alternative = &quot;custom&quot;</p>
</td></tr>
<tr><td><code id="hettmansperger_norton_test_internal_+3A_...">...</code></td>
<td>
<p>further arguments are ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data.frame with the results
</p>


<h3>References</h3>

<p>Brunner, E., Bathke, A.C., and Konietschke, F. (2018a). Rank- and Pseudo-Rank Procedures for Independent Observations in Factorial Designs - Using R and SAS. Springer Series in Statistics, Springer, Heidelberg. ISBN: 978-3-030-02912-8.
</p>
<p>Hettmansperger, T. P., &amp; Norton, R. M. (1987). Tests for patterned alternatives in k-sample problems. Journal of the American Statistical Association, 82(397), 292-299
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create some data, please note that the group factor needs to be ordered
df &lt;- data.frame(data = c(rnorm(40, 3, 1), rnorm(40, 2, 1), rnorm(20, 1, 1)),
  group = c(rep(1,40),rep(2,40),rep(3,20)))
df$group &lt;- factor(df$group, ordered = TRUE)

# you can either test for a decreasing, increasing or custom trend
hettmansperger_norton_test(df$data, df$group, alternative="decreasing")
hettmansperger_norton_test(df$data, df$group, alternative="increasing")
hettmansperger_norton_test(df$data, df$group, alternative="custom", trend = c(1, 3, 2))
</code></pre>

<hr>
<h2 id='kepner_robinson_test'>Kepner-Robinson Test</h2><span id='topic+kepner_robinson_test'></span><span id='topic+kepner_robinson_test.numeric'></span><span id='topic+kepner_robinson_test.formula'></span>

<h3>Description</h3>

<p>This function calculates the Kepner-Robinson test using ranks under the null hypothesis H0F: F_1 = ... F_k where F_i are the marginal distributions. Each subject needs to have k measurements. This test assumes that the covariance matrix of a subject has a compound symmetry structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kepner_robinson_test(x, ...)

## S3 method for class 'numeric'
kepner_robinson_test(
  x,
  time,
  subject,
  na.rm = FALSE,
  distribution = c("Chisq", "F"),
  ...
)

## S3 method for class 'formula'
kepner_robinson_test(
  formula,
  data,
  subject,
  na.rm = FALSE,
  distribution = c("Chisq", "F"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kepner_robinson_test_+3A_x">x</code></td>
<td>
<p>numeric vector containing the data</p>
</td></tr>
<tr><td><code id="kepner_robinson_test_+3A_...">...</code></td>
<td>
<p>further arguments are ignored</p>
</td></tr>
<tr><td><code id="kepner_robinson_test_+3A_time">time</code></td>
<td>
<p>factor specifying the groups</p>
</td></tr>
<tr><td><code id="kepner_robinson_test_+3A_subject">subject</code></td>
<td>
<p>factor specifying the subjects or the name of the subject column if a data.frame is used</p>
</td></tr>
<tr><td><code id="kepner_robinson_test_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating if NA values should be removed</p>
</td></tr>
<tr><td><code id="kepner_robinson_test_+3A_distribution">distribution</code></td>
<td>
<p>either 'Chisq' or 'F' approximation</p>
</td></tr>
<tr><td><code id="kepner_robinson_test_+3A_formula">formula</code></td>
<td>
<p>optional formula object</p>
</td></tr>
<tr><td><code id="kepner_robinson_test_+3A_data">data</code></td>
<td>
<p>optional data.frame of the data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class 'pseudorank'
</p>


<h3>References</h3>

<p>James L. Kepner &amp; David H. Robinson (1988) Nonparametric Methods for Detecting Treatment Effects in Repeated-Measures Designs, Journal of the American Statistical Association, 83:402, 456-461.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = c(1, 1, 1, 1, 2, 3, 4, 5, 6)
grp = as.factor(c('A','A','B','B','B','D','D','D','D'))

# calculate Kruskal-Wallis test using pseudo-ranks
kruskal_wallis_test(x, grp, na.rm = FALSE, pseudoranks = TRUE)
</code></pre>

<hr>
<h2 id='kepner_robinson_test_internal'>Kepner-Robinson Test</h2><span id='topic+kepner_robinson_test_internal'></span>

<h3>Description</h3>

<p>This function calculates the Kepner-Robinsin test under the null hypothesis H0F: F_1 = ... F_k.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kepner_robinson_test_internal(
  data,
  time,
  subject,
  distribution,
  na.rm,
  formula = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kepner_robinson_test_internal_+3A_data">data</code></td>
<td>
<p>numeric vector containing the data</p>
</td></tr>
<tr><td><code id="kepner_robinson_test_internal_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating if NA values should be removed</p>
</td></tr>
<tr><td><code id="kepner_robinson_test_internal_+3A_formula">formula</code></td>
<td>
<p>formula object</p>
</td></tr>
<tr><td><code id="kepner_robinson_test_internal_+3A_...">...</code></td>
<td>
<p>further arguments are ignored</p>
</td></tr>
<tr><td><code id="kepner_robinson_test_internal_+3A_group">group</code></td>
<td>
<p>ordered factor vector for the groups</p>
</td></tr>
<tr><td><code id="kepner_robinson_test_internal_+3A_alternative">alternative</code></td>
<td>
<p>either decreasing or increasing</p>
</td></tr>
<tr><td><code id="kepner_robinson_test_internal_+3A_trend">trend</code></td>
<td>
<p>custom numeric vector indicating the trend for the custom alternative, only used if alternative = &quot;custom&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data.frame with the results
</p>


<h3>References</h3>

<p>Kepner, J. L., &amp; Robinson, D. H. (1988). Nonparametric methods for detecting treatment effects in repeated-measures designs. Journal of the American Statistical Association, 83(402), 456-461.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = c(1, 1, 1, 1, 2, 3, 4, 5, 6)
grp = as.factor(c('A','A','B','B','B','D','D','D','D'))

# calculate Kruskal-Wallis test using pseudo-ranks
kruskal_wallis_test(x, grp, na.rm = FALSE, pseudoranks = TRUE)
</code></pre>

<hr>
<h2 id='kruskal_wallis_internal'>Hettmansperger-Norton Trend Test for k-Samples</h2><span id='topic+kruskal_wallis_internal'></span>

<h3>Description</h3>

<p>This function calculates the Kruskal-Wallis test using pseudo-ranks under the null hypothesis H0F: F_1 = ... F_k.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kruskal_wallis_internal(
  data,
  group,
  na.rm,
  formula = NULL,
  pseudoranks = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kruskal_wallis_internal_+3A_data">data</code></td>
<td>
<p>numeric vector containing the data</p>
</td></tr>
<tr><td><code id="kruskal_wallis_internal_+3A_group">group</code></td>
<td>
<p>factor specifying the groups</p>
</td></tr>
<tr><td><code id="kruskal_wallis_internal_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating if NA values should be removed</p>
</td></tr>
<tr><td><code id="kruskal_wallis_internal_+3A_formula">formula</code></td>
<td>
<p>formula object</p>
</td></tr>
<tr><td><code id="kruskal_wallis_internal_+3A_pseudoranks">pseudoranks</code></td>
<td>
<p>logical value indicating if pseudo-ranks or ranks should be used</p>
</td></tr>
<tr><td><code id="kruskal_wallis_internal_+3A_...">...</code></td>
<td>
<p>further arguments are ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data.frame with the results
</p>


<h3>References</h3>

<p>Brunner, E., Bathke, A.C., and Konietschke, F. (2018a). Rank- and Pseudo-Rank Procedures for Independent Observations in Factorial Designs - Using R and SAS. Springer Series in Statistics, Springer, Heidelberg. ISBN: 978-3-030-02912-8.
</p>
<p>Hettmansperger, T. P., &amp; Norton, R. M. (1987). Tests for patterned alternatives in k-sample problems. Journal of the American Statistical Association, 82(397), 292-299
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = c(1, 1, 1, 1, 2, 3, 4, 5, 6)
grp = as.factor(c('A','A','B','B','B','D','D','D','D'))

# calculate Kruskal-Wallis test using pseudo-ranks
kruskal_wallis_test(x, grp, na.rm = FALSE, pseudoranks = TRUE)
</code></pre>

<hr>
<h2 id='kruskal_wallis_test'>Kruskal-Wallis Test</h2><span id='topic+kruskal_wallis_test'></span><span id='topic+kruskal_wallis_test.numeric'></span><span id='topic+kruskal_wallis_test.formula'></span>

<h3>Description</h3>

<p>This function calculates the Kruskal-Wallis test using pseudo-ranks under the null hypothesis H0F: F_1 = ... F_k.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kruskal_wallis_test(x, ...)

## S3 method for class 'numeric'
kruskal_wallis_test(x, grp, na.rm = FALSE, pseudoranks = TRUE, ...)

## S3 method for class 'formula'
kruskal_wallis_test(formula, data, na.rm = FALSE, pseudoranks = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kruskal_wallis_test_+3A_x">x</code></td>
<td>
<p>numeric vector containing the data</p>
</td></tr>
<tr><td><code id="kruskal_wallis_test_+3A_...">...</code></td>
<td>
<p>further arguments are ignored</p>
</td></tr>
<tr><td><code id="kruskal_wallis_test_+3A_grp">grp</code></td>
<td>
<p>factor specifying the groups</p>
</td></tr>
<tr><td><code id="kruskal_wallis_test_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating if NA values should be removed</p>
</td></tr>
<tr><td><code id="kruskal_wallis_test_+3A_pseudoranks">pseudoranks</code></td>
<td>
<p>logical value indicating if pseudo-ranks or ranks should be used</p>
</td></tr>
<tr><td><code id="kruskal_wallis_test_+3A_formula">formula</code></td>
<td>
<p>optional formula object</p>
</td></tr>
<tr><td><code id="kruskal_wallis_test_+3A_data">data</code></td>
<td>
<p>optional data.frame of the data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class 'pseudorank'
</p>


<h3>References</h3>

<p>Brunner, E., Bathke, A.C., and Konietschke, F. (2018a). Rank- and Pseudo-Rank Procedures for Independent Observations in Factorial Designs - Using R and SAS. Springer Series in Statistics, Springer, Heidelberg. ISBN: 978-3-030-02912-8.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = c(1, 1, 1, 1, 2, 3, 4, 5, 6)
grp = as.factor(c('A','A','B','B','B','D','D','D','D'))

# calculate Kruskal-Wallis test using pseudo-ranks
kruskal_wallis_test(x, grp, na.rm = FALSE, pseudoranks = TRUE)
</code></pre>

<hr>
<h2 id='ParadoxicalRanks'>Artifical data of 54 subjects</h2><span id='topic+ParadoxicalRanks'></span>

<h3>Description</h3>

<p>An artificial dataset containing data of 54 subjects where where a substance was administered in three different concentrations (1,2 and 3).
This data set can be used to show the paradoxical results obtained from rank tests, i.e., the Hettmansperger-Norton test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ParadoxicalRanks)
</code></pre>


<h3>Format</h3>

<p>A data frame with 54 rows and 2 variables.
</p>


<h3>Details</h3>

<p>The columns are as follows:
</p>

<ul>
<li><p> conc. Grouping variable specifying which concentration was used. This factor is ordered, i.e., 1 &lt; 2 &lt; 3.
</p>
</li>
<li><p> score. The response variable.
</p>
</li></ul>



<h3>References</h3>

<p>Happ M, Zimmermann G, Brunner E, Bathke AC (2020). Pseudo-Ranks: How to Calculate Them Efficiently in R. Journal of Statistical Software, Code Snippets, *95*(1), 1-22. doi: 10.18637/jss.v095.c01 (URL:https://doi.org/10.18637/jss.v095.c01).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ParadoxicalRanks")
dat &lt;- ParadoxicalRanks

set.seed(1)
n &lt;- c(60, 360, 120)
x1 &lt;- sample(subset(dat, dat$conc == 1)$score, n[1], replace = TRUE)
x2 &lt;- sample(subset(dat, dat$conc == 2)$score, n[2], replace = TRUE)
x3 &lt;- sample(subset(dat, dat$conc == 3)$score, n[3], replace = TRUE)


dat &lt;- data.frame(score = c(x1, x2, x3),
  conc = factor(c( rep(1,n[1]), rep(2,n[2]), rep(5,n[3]) ), ordered=TRUE) )

# Hettmansperger-Norton test with ranks (pseudorannks = FALSE) returns a small p-value (0.011).
# In contrast, the pseudo-rank test returns a large p-value (0.42). By changing the ratio of
# group sizes, we can also obtain a significant decreasing trend with ranks, e.g.
# n &lt;- c(260,20,260) and the same seed.
hettmansperger_norton_test(score ~ conc, data = dat, pseudoranks = FALSE,
  alternative = "increasing")
hettmansperger_norton_test(score ~ conc, data = dat, pseudoranks = TRUE,
  alternative = "increasing")
</code></pre>

<hr>
<h2 id='pseudorank'>Calculation of Pseudo-Ranks</h2><span id='topic+pseudorank'></span><span id='topic+pseudorank.numeric'></span><span id='topic+pseudorank.formula'></span>

<h3>Description</h3>

<p>Calculation of (mid) pseudo-ranks of a sample. In case of ties (i.e. equal values), the average of min pseudo-ranks and max-pseudo-ranks are taken (similar to rank with ties.method=&quot;average&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseudorank(x, ...)

## S3 method for class 'numeric'
pseudorank(x, y, na.last = NA, ties.method = c("average", "max", "min"), ...)

## S3 method for class 'formula'
pseudorank(
  formula,
  data,
  na.last = NA,
  ties.method = c("average", "max", "min"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pseudorank_+3A_x">x</code></td>
<td>
<p>vector containing the observations</p>
</td></tr>
<tr><td><code id="pseudorank_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
<tr><td><code id="pseudorank_+3A_y">y</code></td>
<td>
<p>vector specifiying the group to which the observations from the x vector belong to</p>
</td></tr>
<tr><td><code id="pseudorank_+3A_na.last">na.last</code></td>
<td>
<p>for controlling the treatment of NAs. If TRUE, missing values in the data are put last; if FALSE, they are put first; if NA, they are removed (recommended).</p>
</td></tr>
<tr><td><code id="pseudorank_+3A_ties.method">ties.method</code></td>
<td>
<p>type of pseudo-ranks: either 'average' (recommended), 'min' or 'max'.</p>
</td></tr>
<tr><td><code id="pseudorank_+3A_formula">formula</code></td>
<td>
<p>formula object</p>
</td></tr>
<tr><td><code id="pseudorank_+3A_data">data</code></td>
<td>
<p>data.frame containing the variables in the formula (observations and group)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numerical vector containing the pseudo-ranks.
</p>


<h3>References</h3>

<p>Brunner, E., Bathke, A.C., and Konietschke, F. (2018a). Rank- and Pseudo-Rank Procedures for Independent Observations in Factorial Designs - Using R and SAS. Springer Series in Statistics, Springer, Heidelberg. ISBN: 978-3-030-02912-8.
</p>
<p>Happ M, Zimmermann G, Brunner E, Bathke AC (2020). Pseudo-Ranks: How to Calculate Them Efficiently in R. Journal of Statistical Software, Code Snippets, *95*(1), 1-22. doi: 10.18637/jss.v095.c01 (URL:https://doi.org/10.18637/jss.v095.c01).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(data = round(rnorm(100)), group = c(rep(1,40),rep(2,40),rep(3,20)))
df$group &lt;- as.factor(df$group)

## two ways to calculate pseudo-ranks

# Variant 1: use a vector for the data and a group vector
pseudorank(df$data,df$group)

# Variant 2: use a formula object, Note that only one group factor can be used
# that is, in data~group*group2 only 'group' will be used
pseudorank(data~group,df)
</code></pre>

<hr>
<h2 id='psrank'>Calculation of Pseudo-Ranks (Deprecated)</h2><span id='topic+psrank'></span>

<h3>Description</h3>

<p>Calculation of (mid) pseudo-ranks of a sample. In case of ties (i.e. equal values), the average of min pseudo-ranks and max-pseudo-ranks are taken (similar to rank with ties.method=&quot;average&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psrank(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psrank_+3A_x">x</code></td>
<td>
<p>vector containing the observations</p>
</td></tr>
<tr><td><code id="psrank_+3A_...">...</code></td>
<td>
<p>further arguments (see help for pseudorank)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numerical vector containing the pseudo-ranks.
</p>


<h3>References</h3>

<p>Happ M, Zimmermann G, Brunner E, Bathke AC (2020). Pseudo-Ranks: How to Calculate Them Efficiently in R. Journal of Statistical Software, Code Snippets, *95*(1), 1-22. doi: 10.18637/jss.v095.c01 (URL:https://doi.org/10.18637/jss.v095.c01).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(data = round(rnorm(100)), group = c(rep(1,40),rep(2,40),rep(3,20)))
df$group &lt;- as.factor(df$group)

## two ways to calculate pseudo-ranks

# Variant 1: use a vector for the data and a group vector
pseudorank(df$data,df$group)

# Variant 2: use a formula object, Note that only one group factor can be used
# that is, in data~group*group2 only 'group' will be used
pseudorank(data~group,df)
</code></pre>

<hr>
<h2 id='recursiveCalculation'>Calculation of Pseudo-Ranks</h2><span id='topic+recursiveCalculation'></span>

<h3>Description</h3>

<p>Calculation of (mid) pseudo-ranks of a sample. In case of ties (i.e. equal values), the average of min pseudo-rank and max-pseudor-rank are taken (similar to rank with ties.method=&quot;average&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recursiveCalculation(data, group, na.last, ties.method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recursiveCalculation_+3A_data">data</code></td>
<td>
<p>numerical vector</p>
</td></tr>
<tr><td><code id="recursiveCalculation_+3A_group">group</code></td>
<td>
<p>vector coding for the groups</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numerical vector containing the pseudo-ranks
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
