<!DOCTYPE html><html><head><title>Help for package fingerPro</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fingerPro}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#boxPlot'><p>Box and whiskers plot</p></a></li>
<li><a href='#catchment'><p>Land use and fingerprinting properties in a Mediterranean catchment</p></a></li>
<li><a href='#correlationPlot'><p>Correlation matrix chart</p></a></li>
<li><a href='#DFATest'><p>Discriminant function analysis test</p></a></li>
<li><a href='#fingerPro-package'>
<p>Sediment Source Fingerprinting</p></a></li>
<li><a href='#ggbiplot'><p>Biplot for Principal Components using ggplot2</p></a></li>
<li><a href='#inputSample'><p>Input sediment mixtures</p></a></li>
<li><a href='#inputSource'><p>Input sediment sources</p></a></li>
<li><a href='#KWTest'><p>Kruskal-Wallis rank sum test</p></a></li>
<li><a href='#LDAPlot'><p>Linear discriminat analysis chart</p></a></li>
<li><a href='#PCAPlot'><p>Principal component analysis chart</p></a></li>
<li><a href='#plotResults'><p>Displays the results in the screen</p></a></li>
<li><a href='#rangeTest'><p>Range test</p></a></li>
<li><a href='#unmix'><p>Unmix sediment mixtures</p></a></li>
<li><a href='#unmix_c'><p>Mixing model</p></a></li>
<li><a href='#writeResults'><p>Save the results</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Sediment Source Fingerprinting</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-08-27</td>
</tr>
<tr>
<td>Description:</td>
<td>Quantifies the provenance of the sediments in a catchment or study area. Based on a comprehensive characterization of the sediment sources and the end sediment mixtures a mixing model algorithm is applied to the sediment mixtures in order to estimate the relative contribution of each potential source. The package includes several statistical methods such as Kruskal-Wallis test, discriminant function analysis ('DFA'), principal component plot ('PCA') to select the optimal subset of tracer properties. The variability within each sediment source is also considered to estimate the statistical distribution of the sources contribution.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/eead-csic-eesa">https://github.com/eead-csic-eesa</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.3), klaR (&ge; 0.6-12), ggplot2(&ge; 2.2.1),
GGally(&ge; 1.3.2), MASS(&ge; 7.3.45), Rcmdr(&ge; 2.4-1), plyr (&ge;
1.8.4), reshape(&ge; 0.8.7), rgl(&ge; 0.99.9), grid(&ge; 3.1.1),
gridExtra(&ge; 2.3), scales(&ge; 0.5.0), car(&ge; 3.0.0),
RcppProgress(&ge; 0.4)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppGSL, RcppProgress</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-08-27 16:43:33 UTC; ilizaga</td>
</tr>
<tr>
<td>Author:</td>
<td>Ivan Lizaga [aut, cre],
  Borja Latorre [aut],
  Leticia Gaspar [aut],
  Ana Navas [aut],
  Vince Q Vu [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ivan Lizaga &lt;lizaga.ivan10@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-08-28 10:04:54 UTC</td>
</tr>
</table>
<hr>
<h2 id='boxPlot'>Box and whiskers plot</h2><span id='topic+boxPlot'></span>

<h3>Description</h3>

<p>The boxplot compactly shows the distribution of a continuous variable. It displays five summary statistics (the median, two hinges and two whiskers), and all &quot;outlying&quot; points individually.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boxPlot(data, columns = 1:ncol(data) - 2, ncol = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxPlot_+3A_data">data</code></td>
<td>
<p>Data frame containing source and mixtures data</p>
</td></tr>
<tr><td><code id="boxPlot_+3A_columns">columns</code></td>
<td>
<p>Numeric vector containing the index of the columns in the chart (the first column refers to the first variable)</p>
</td></tr>
<tr><td><code id="boxPlot_+3A_ncol">ncol</code></td>
<td>
<p>Number of charts per row</p>
</td></tr>
</table>

<hr>
<h2 id='catchment'>Land use and fingerprinting properties in a Mediterranean catchment</h2><span id='topic+catchment'></span>

<h3>Description</h3>

<p>A dataset containing the different tracer properties of the different land uses in a Mediterranean catchment and one mixture sample located at the output of the catchment.
The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>catchment
</code></pre>


<h3>Format</h3>

<p>A data frame with 22 rows and 23 variables:
</p>

<dl>
<dt>id</dt><dd><p>reference number id of each sample analysed</p>
</dd>
<dt>Land_Use</dt><dd><p>grouping variable, in this study refers to the different land uses in the catchment</p>
</dd>
<dt>Pbex, K40, Bi214, Ra226, Th232, U238, Nb, Sr, Rb, Pb, Zn, Fe, Mn, Cr, V, Ti, Ca, K, Al, Si, Mg</dt><dd><p>value of the tracer property for each sample</p>
</dd>
</dl>

<hr>
<h2 id='correlationPlot'>Correlation matrix chart</h2><span id='topic+correlationPlot'></span>

<h3>Description</h3>

<p>The function displays a correlation matrix of each of the properties divided by the different sources to help the user in the decision.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correlationPlot(data, columns = c(1:ncol(data) - 1), mixtures = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="correlationPlot_+3A_data">data</code></td>
<td>
<p>Data frame containing source and mixtures data</p>
</td></tr>
<tr><td><code id="correlationPlot_+3A_columns">columns</code></td>
<td>
<p>Numeric vector containing the index of the columns in the chart (the first column refers to the grouping variable)</p>
</td></tr>
<tr><td><code id="correlationPlot_+3A_mixtures">mixtures</code></td>
<td>
<p>Boolean to include or exclude the mixture samples in the chart</p>
</td></tr>
</table>

<hr>
<h2 id='DFATest'>Discriminant function analysis test</h2><span id='topic+DFATest'></span>

<h3>Description</h3>

<p>Performs a stepwise forward variable selection using the Wilk's Lambda criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DFATest(data, niveau = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DFATest_+3A_data">data</code></td>
<td>
<p>Data frame containing source and mixtures</p>
</td></tr>
<tr><td><code id="DFATest_+3A_niveau">niveau</code></td>
<td>
<p>level for the approximate F-test decision</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame only containing the variables that pass the DFA test
</p>

<hr>
<h2 id='fingerPro-package'>
Sediment Source Fingerprinting
</h2><span id='topic+fingerPro-package'></span><span id='topic+fingerPro'></span>

<h3>Description</h3>

<p>Soil erosion is one of the biggest challenges for food production and reservoirs siltation around the world. Information on sediment, nutrients and pollutant transport is required for effective control strategies. Source estimates are difficult to obtain using traditional monitoring techniques, but sediment source fingerprinting, has been proved to be a valuable tool. Sediment source fingerprinting offers the potential to assess sediment provenance as a basis to develop management plans and prevent erosion.  The procedure focuses on developing methods that enable the apportionment of sediment sources to be identified from a composite sample of sediment mixture material. We developed an R-package as a tool to quantify the provenance of the sediments in a catchment. A mixing model algorithm is applied to the sediment mixture samples in order to estimate the relative contribution of each potential source. The package consists of a set of functions used to:  i) characterise and pre-process the data, select the optimum subset of tracers; ii) unmix sediment samples and quantify the apportionment of each source; iii) assess the effect of the source variability; and iv) visualize and export the results.
</p>


<h3>Author(s)</h3>

<p>Ivan Lizaga, Borja Latorre, Leticia Gaspar, Ana Navas
</p>
<p>Maintainer: Ivan Lizaga &lt;ilizaga@eead.csic.es // lizaga.ivan10@gmail.com&gt;
</p>


<h3>See Also</h3>

<p>https://github.com/eead-csic-eesa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Created on 22/08/2018

#If you want to use your own data
#setwd("the directory that contains your dataset")
#data &lt;- read.table('your dataset', header = T, sep = '\t')
#install.packages("fingerPro")
#library(fingerPro)
#Example of the data included in the fingerPro package
#Load the dataset called "catchment" 

# "Catchment": this dataset has been selected from a Mediterranean catchment for 
#this purpose and contains high-quality radionuclides and geochemistry data.
#AG (cropland)
#PI and PI1 (Pine forest, at first looks different but when you display de LDA plot 
#you will see that the wisher decision in join both pines as the same source)
#SS (subsoil)
data &lt;- catchment
#boxPlot(data, columns = 1:6, ncol = 3)
#correlationPlot(data, columns = 1:5, mixtures = TRUE)
LDAPlot(data, P3D=FALSE)
#variables are collinear
#select the optimum set of tracers by implementing the statistical tests 
data &lt;- rangeTest(data)
data &lt;- KWTest(data)
data &lt;- DFATest(data)
#Check how the selected tracers discriminate between sources
LDAPlot(data, P3D=FALSE)
#change P3D=FALSE to P3D=TRUE to visualize the 3D LDAPlot
#2D and 3D LDAPlots suggest that two of the sources have to be combined
#reload the original dataset "catchment"
data &lt;- catchment
# Combine sources PI1 and PI based on the previous LDAPlot
data$Land_Use[data$Land_Use == 'PI1'] &lt;- 'PI'
#select the optimum set of tracers by implementing the statistical tests 
data &lt;- rangeTest(data)
data &lt;- KWTest(data)
data &lt;- DFATest(data)
LDAPlot(data, P3D=FALSE)
PCAPlot(data)
#Now the optimum tracer properties selected discriminate well, so proceed with the unmix function
result &lt;- unmix(data, samples = 100L, iter =100L)
#Display the results
plotResults(result, y_high = 5, n = 1)
writeResults(result)
</code></pre>

<hr>
<h2 id='ggbiplot'>Biplot for Principal Components using ggplot2</h2><span id='topic+ggbiplot'></span>

<h3>Description</h3>

<p>Biplot for Principal Components using ggplot2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggbiplot(pcobj, choices = 1:2, scale = 1, pc.biplot = TRUE,
  obs.scale = 1 - scale, var.scale = scale, groups = NULL,
  ellipse = FALSE, ellipse.prob = 0.68, labels = NULL, labels.size = 3,
  alpha = 1, var.axes = TRUE, circle = FALSE, circle.prob = 0.69,
  varname.size = 3, varname.adjust = 1.5, varname.abbrev = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggbiplot_+3A_pcobj">pcobj</code></td>
<td>
<p>an object returned by prcomp() or princomp()</p>
</td></tr>
<tr><td><code id="ggbiplot_+3A_choices">choices</code></td>
<td>
<p>which PCs to plot</p>
</td></tr>
<tr><td><code id="ggbiplot_+3A_scale">scale</code></td>
<td>
<p>covariance biplot (scale = 1), form biplot (scale = 0). When scale = 1, the inner product between the variables approximates the covariance and the distance between the points approximates the Mahalanobis distance.</p>
</td></tr>
<tr><td><code id="ggbiplot_+3A_pc.biplot">pc.biplot</code></td>
<td>
<p>for compatibility with biplot.princomp()</p>
</td></tr>
<tr><td><code id="ggbiplot_+3A_obs.scale">obs.scale</code></td>
<td>
<p>scale factor to apply to observations</p>
</td></tr>
<tr><td><code id="ggbiplot_+3A_var.scale">var.scale</code></td>
<td>
<p>scale factor to apply to variables</p>
</td></tr>
<tr><td><code id="ggbiplot_+3A_groups">groups</code></td>
<td>
<p>optional factor variable indicating the groups that the observations belong to. If provided the points will be colored according to groups</p>
</td></tr>
<tr><td><code id="ggbiplot_+3A_ellipse">ellipse</code></td>
<td>
<p>draw a normal data ellipse for each group?</p>
</td></tr>
<tr><td><code id="ggbiplot_+3A_ellipse.prob">ellipse.prob</code></td>
<td>
<p>size of the ellipse in Normal probability</p>
</td></tr>
<tr><td><code id="ggbiplot_+3A_labels">labels</code></td>
<td>
<p>optional vector of labels for the observations</p>
</td></tr>
<tr><td><code id="ggbiplot_+3A_labels.size">labels.size</code></td>
<td>
<p>size of the text used for the labels</p>
</td></tr>
<tr><td><code id="ggbiplot_+3A_alpha">alpha</code></td>
<td>
<p>alpha transparency value for the points (0 = transparent, 1 = opaque)</p>
</td></tr>
<tr><td><code id="ggbiplot_+3A_var.axes">var.axes</code></td>
<td>
<p>draw arrows for the variables?</p>
</td></tr>
<tr><td><code id="ggbiplot_+3A_circle">circle</code></td>
<td>
<p>draw a correlation circle? (only applies when prcomp was called with scale = TRUE and when var.scale = 1)</p>
</td></tr>
<tr><td><code id="ggbiplot_+3A_varname.size">varname.size</code></td>
<td>
<p>size of the text for variable names</p>
</td></tr>
<tr><td><code id="ggbiplot_+3A_varname.adjust">varname.adjust</code></td>
<td>
<p>adjustment factor the placement of the variable names, &gt;= 1 means farther from the arrow</p>
</td></tr>
<tr><td><code id="ggbiplot_+3A_varname.abbrev">varname.abbrev</code></td>
<td>
<p>whether or not to abbreviate the variable names</p>
</td></tr>
<tr><td><code id="ggbiplot_+3A_circle.prob">circle.prob</code></td>
<td>
<p>size of the ellipse in Normal probability</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot2 plot
</p>

<hr>
<h2 id='inputSample'>Input sediment mixtures</h2><span id='topic+inputSample'></span>

<h3>Description</h3>

<p>The function select and extract the sediment mixtures of the dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inputSample(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inputSample_+3A_data">data</code></td>
<td>
<p>Data frame containing source and mixtures data</p>
</td></tr>
</table>

<hr>
<h2 id='inputSource'>Input sediment sources</h2><span id='topic+inputSource'></span>

<h3>Description</h3>

<p>The function select and extract the source samples of the dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inputSource(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inputSource_+3A_data">data</code></td>
<td>
<p>Data frame containing source and mixtures data</p>
</td></tr>
</table>

<hr>
<h2 id='KWTest'>Kruskal-Wallis rank sum test</h2><span id='topic+KWTest'></span>

<h3>Description</h3>

<p>This function excludes from the original data frame the properties which do not show significant differences between sources.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KWTest(data, pvalue = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KWTest_+3A_data">data</code></td>
<td>
<p>Data frame containing source and mixtures</p>
</td></tr>
<tr><td><code id="KWTest_+3A_pvalue">pvalue</code></td>
<td>
<p>p-value threshold</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame only containing the variables that pass the Kruskal-Wallis test
</p>

<hr>
<h2 id='LDAPlot'>Linear discriminat analysis chart</h2><span id='topic+LDAPlot'></span>

<h3>Description</h3>

<p>The function performs a linear discriminant analysis and displays the data in the relevant dimensions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LDAPlot(data, P3D = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LDAPlot_+3A_data">data</code></td>
<td>
<p>Data frame containing source and mixtures data</p>
</td></tr>
<tr><td><code id="LDAPlot_+3A_p3d">P3D</code></td>
<td>
<p>Boolean to switch between 2 to 3 dimensional chart</p>
</td></tr>
</table>

<hr>
<h2 id='PCAPlot'>Principal component analysis chart</h2><span id='topic+PCAPlot'></span>

<h3>Description</h3>

<p>The function performs a principal components analysis on the given data matrix and displays a biplot using vqv.ggbiplot package of the results for each different source to help the user in the decision.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PCAPlot(data, components = c(1:2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PCAPlot_+3A_data">data</code></td>
<td>
<p>Data frame containing source and mixtures data</p>
</td></tr>
<tr><td><code id="PCAPlot_+3A_components">components</code></td>
<td>
<p>Numeric vector containing the index of the two principal components in the chart</p>
</td></tr>
</table>

<hr>
<h2 id='plotResults'>Displays the results in the screen</h2><span id='topic+plotResults'></span>

<h3>Description</h3>

<p>The function performs a density chart of the relative contribution of the potential sediment sources for each sediment mixture in the dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotResults(data, y_high = 6.5, n = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotResults_+3A_data">data</code></td>
<td>
<p>Data frame containing the relative contribution of the potential sediment sources for each sediment mixture in the dataset</p>
</td></tr>
<tr><td><code id="plotResults_+3A_y_high">y_high</code></td>
<td>
<p>Number of the vertical height of the y-axis</p>
</td></tr>
<tr><td><code id="plotResults_+3A_n">n</code></td>
<td>
<p>Number of charts per row</p>
</td></tr>
</table>

<hr>
<h2 id='rangeTest'>Range test</h2><span id='topic+rangeTest'></span>

<h3>Description</h3>

<p>Function that excludes the properties of the sediment mixture/s outside the minimum and maximum values in the sediment sources.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rangeTest(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rangeTest_+3A_data">data</code></td>
<td>
<p>Data frame containing source and mixtures</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing sediment sources and mixtures
</p>

<hr>
<h2 id='unmix'>Unmix sediment mixtures</h2><span id='topic+unmix'></span>

<h3>Description</h3>

<p>Asses the relative contribution of the potential sediment sources for each sediment mixture in the dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unmix(data, samples = 100L, iter = 100L, seed = 123456L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unmix_+3A_data">data</code></td>
<td>
<p>Data frame containing sediment source and mixtures</p>
</td></tr>
<tr><td><code id="unmix_+3A_samples">samples</code></td>
<td>
<p>Number of samples in each hypercube dimension</p>
</td></tr>
<tr><td><code id="unmix_+3A_iter">iter</code></td>
<td>
<p>Iterations in the source variability analysis</p>
</td></tr>
<tr><td><code id="unmix_+3A_seed">seed</code></td>
<td>
<p>Seed for the random number generator</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing the relative contribution of the sediment sources for each sediment mixture and iterations
</p>

<hr>
<h2 id='unmix_c'>Mixing model</h2><span id='topic+unmix_c'></span>

<h3>Description</h3>

<p>Mixing model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unmix_c(sources, samples, trials = 100L, iter = 100L,
  seed = 69512L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unmix_c_+3A_sources">sources</code></td>
<td>
<p>Data frame containing sediment sources data</p>
</td></tr>
<tr><td><code id="unmix_c_+3A_samples">samples</code></td>
<td>
<p>Data frame containing sediment mixtures data</p>
</td></tr>
<tr><td><code id="unmix_c_+3A_trials">trials</code></td>
<td>
<p>Number of samples in each hypercube dimension</p>
</td></tr>
<tr><td><code id="unmix_c_+3A_iter">iter</code></td>
<td>
<p>Iterations in the source variability analysis</p>
</td></tr>
<tr><td><code id="unmix_c_+3A_seed">seed</code></td>
<td>
<p>Seed for the random number generator</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing the relative contribution of the sediment sources for each sediment mixture and iterations
</p>

<hr>
<h2 id='writeResults'>Save the results</h2><span id='topic+writeResults'></span>

<h3>Description</h3>

<p>The function saves the results in the workspace file for all the sediment mixture samples and for each sediment mixture sample separately
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeResults(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="writeResults_+3A_data">data</code></td>
<td>
<p>Data frame containing the relative contribution of the potential sediment sources for each sediment mixture in the dataset</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
