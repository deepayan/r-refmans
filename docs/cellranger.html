<!DOCTYPE html><html lang="en"><head><title>Help for package cellranger</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cellranger}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cellranger'><p>cellranger</p></a></li>
<li><a href='#A1_to_R1C1'><p>Convert cell reference strings from A1 to R1C1 format</p></a></li>
<li><a href='#addr_col'><p>Get column from cell location or reference</p></a></li>
<li><a href='#addr_row'><p>Get row from cell location or reference</p></a></li>
<li><a href='#anchored'><p>Specify cell limits via an anchor cell</p></a></li>
<li><a href='#as.cell_addr'><p>Convert to a cell_addr object</p></a></li>
<li><a href='#as.ra_ref'><p>Convert to a ra_ref object</p></a></li>
<li><a href='#as.range'><p>Convert a cell_limits object to a cell range</p></a></li>
<li><a href='#cell_addr'><p>cell_addr class</p></a></li>
<li><a href='#cell_cols'><p>Specify cell limits only for columns</p></a></li>
<li><a href='#cell_limits'><p>Create a cell_limits object</p></a></li>
<li><a href='#cell_rows'><p>Specify cell limits only for rows</p></a></li>
<li><a href='#guess_fo'><p>Guess cell reference string format</p></a></li>
<li><a href='#is_A1'><p>Test cell reference strings</p></a></li>
<li><a href='#letter-num-conversion'><p>Convert between letter and integer representations of column IDs</p></a></li>
<li><a href='#print.ra_ref'><p>Print ra_ref object</p></a></li>
<li><a href='#R1C1_to_A1'><p>Convert R1C1 positioning notation to A1 notation</p></a></li>
<li><a href='#ra_ref'><p>ra_ref class</p></a></li>
<li><a href='#to_string'><p>Get string representation of cell references</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Translate Spreadsheet Cell Ranges to Rows and Columns</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Helper functions to work with spreadsheets and the "A1:D10" style
    of cell range specification.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/rsheets/cellranger">https://github.com/rsheets/cellranger</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/rsheets/cellranger/issues">https://github.com/rsheets/cellranger/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, testthat (&ge; 1.0.0), knitr, rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1.9000</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Imports:</td>
<td>rematch, tibble</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-07-26 06:50:00 UTC; jenny</td>
</tr>
<tr>
<td>Author:</td>
<td>Jennifer Bryan [cre, aut],
  Hadley Wickham [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jennifer Bryan &lt;jenny@stat.ubc.ca&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-07-27 03:17:48</td>
</tr>
</table>
<hr>
<h2 id='cellranger'>cellranger</h2><span id='topic+cellranger'></span><span id='topic+cellranger-package'></span>

<h3>Description</h3>

<p>Helper functions to work with spreadsheets and the &quot;A1:D10&quot; style of cell
range specification.
</p>

<hr>
<h2 id='A1_to_R1C1'>Convert cell reference strings from A1 to R1C1 format</h2><span id='topic+A1_to_R1C1'></span>

<h3>Description</h3>

<p>Convert cell reference strings from A1 to R1C1 format. Strictly speaking,
this only makes sense for absolute references, such as <code>"$B$4"</code>. Why?
Because otherwise, we'd have to know the host cell of the reference. Set
<code>strict = FALSE</code> to relax and treat pure relative references, like
(<code>"B4"</code>), as if they are absolute. Mixed references, like
(<code>"B$4"</code>), will always return <code>NA</code>, no matter the value of
<code>strict</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>A1_to_R1C1(x, strict = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="A1_to_R1C1_+3A_x">x</code></td>
<td>
<p>character vector of cell references in A1 format</p>
</td></tr>
<tr><td><code id="A1_to_R1C1_+3A_strict">strict</code></td>
<td>
<p>logical, affects reading and writing of A1 formatted cell
references. When <code>strict = TRUE</code>, references must be declared absolute
through the use of dollar signs, e.g., <code>$A$1</code>,  for parsing. When
making a string, <code>strict = TRUE</code> requests dollar signs for absolute
reference. When <code>strict = FALSE</code>, pure relative reference strings will
be interpreted as absolute, i.e. <code>A1</code> and <code>$A$1</code> are treated the
same. When making a string, <code>strict = FALSE</code> will cause dollars signs
to be omitted in the reference string.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character vector of absolute cell references in R1C1 format
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A1_to_R1C1("$A$1")
A1_to_R1C1("A1")                 ## raises a warning, returns NA
A1_to_R1C1("A1", strict = FALSE) ## unless strict = FALSE
A1_to_R1C1(c("A1", "B$4")) ## raises a warning, includes an NA, because
A1_to_R1C1(c("A1", "B$4"), strict = FALSE) ## mixed ref always returns NA
</code></pre>

<hr>
<h2 id='addr_col'>Get column from cell location or reference</h2><span id='topic+addr_col'></span><span id='topic+addr_col.cell_addr'></span>

<h3>Description</h3>

<p>Get column from cell location or reference
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addr_col(x, ...)

## S3 method for class 'cell_addr'
addr_col(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addr_col_+3A_x">x</code></td>
<td>
<p>a suitable representation of cell(s) or a cell area reference</p>
</td></tr>
<tr><td><code id="addr_col_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>integer vector
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>cell_addr</code>: Method for <code><a href="#topic+cell_addr">cell_addr</a></code> objects
(ca &lt;- cell_addr(1:4, 3))
addr_col(ca)
</p>
</li></ul>

<hr>
<h2 id='addr_row'>Get row from cell location or reference</h2><span id='topic+addr_row'></span><span id='topic+addr_row.cell_addr'></span>

<h3>Description</h3>

<p>Get row from cell location or reference
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addr_row(x, ...)

## S3 method for class 'cell_addr'
addr_row(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addr_row_+3A_x">x</code></td>
<td>
<p>a suitable representation of cell(s) or a cell area reference</p>
</td></tr>
<tr><td><code id="addr_row_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>integer vector
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>cell_addr</code>: Method for <code><a href="#topic+cell_addr">cell_addr</a></code> objects
(ca &lt;- cell_addr(1:4, 3))
addr_row(ca)
</p>
</li></ul>

<hr>
<h2 id='anchored'>Specify cell limits via an anchor cell</h2><span id='topic+anchored'></span>

<h3>Description</h3>

<p>Specify the targetted cell rectangle via an upper left anchor cell and the
rectangle's row and column extent. The extent can be specified directly via
<code>dims</code> or indirectly via the <code>input</code> object. Specification via
<code>input</code> anticipates a write operation into the spreadsheet. If
<code>input</code> is one-dimensional, the <code>byrow</code> argument controls whether
the rectangle will extend down from the anchor or to the right. If
<code>input</code> is two-dimensional, the <code>col_names</code> argument controls
whether cells will be reserved for column or variable names. If
<code>col_names</code> is unspecified, default behavior is to set it to <code>TRUE</code>
if <code>input</code> has columns names and <code>FALSE</code> otherwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anchored(anchor = "A1", dim = c(1L, 1L), input = NULL, col_names = NULL,
  byrow = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anchored_+3A_anchor">anchor</code></td>
<td>
<p>character, specifying the upper left cell in &quot;A1&quot; or &quot;R1C1&quot;
notation</p>
</td></tr>
<tr><td><code id="anchored_+3A_dim">dim</code></td>
<td>
<p>integer vector, of length two, holding the number of rows and
columns of the targetted rectangle; ignored if <code>input</code> is provided</p>
</td></tr>
<tr><td><code id="anchored_+3A_input">input</code></td>
<td>
<p>a one- or two-dimensioanl input object, used to determine the
extent of the targetted rectangle</p>
</td></tr>
<tr><td><code id="anchored_+3A_col_names">col_names</code></td>
<td>
<p>logical, indicating whether a row should be reserved for the
column or variable names of a two-dimensional input; if omitted, will be
determined by checking whether <code>input</code> has column names</p>
</td></tr>
<tr><td><code id="anchored_+3A_byrow">byrow</code></td>
<td>
<p>logical, indicating whether a one-dimensional input should run
down or to the right</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="#topic+cell_limits">cell_limits</a></code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>anchored()
as.range(anchored())
dim(anchored())

anchored("Q24")
as.range(anchored("Q24"))
dim(anchored("Q24"))

anchored(anchor = "R4C2", dim = c(8, 2))
as.range(anchored(anchor = "R4C2", dim = c(8, 2)))
as.range(anchored(anchor = "R4C2", dim = c(8, 2)), fo = "A1")
dim(anchored(anchor = "R4C2", dim = c(8, 2)))

(input &lt;- head(iris))
anchored(input = input)
as.range(anchored(input = input))
dim(anchored(input = input))

anchored(input = input, col_names = FALSE)
as.range(anchored(input = input, col_names = FALSE))
dim(anchored(input = input, col_names = FALSE))

(input &lt;- LETTERS[1:8])
anchored(input = input)
as.range(anchored(input = input))
dim(anchored(input = input))

anchored(input = input, byrow = TRUE)
as.range(anchored(input = input, byrow = TRUE))
dim(anchored(input = input, byrow = TRUE))

</code></pre>

<hr>
<h2 id='as.cell_addr'>Convert to a cell_addr object</h2><span id='topic+as.cell_addr'></span><span id='topic+as.cell_addr.character'></span><span id='topic+as.cell_addr.ra_ref'></span><span id='topic+as.cell_addr_v'></span><span id='topic+as.cell_addr_v.character'></span><span id='topic+as.cell_addr_v.list'></span>

<h3>Description</h3>

<p>Convert various representations of a cell reference into an object of class
<code><a href="#topic+cell_addr">cell_addr</a></code>. Recall that <code><a href="#topic+cell_addr">cell_addr</a></code> objects hold
absolute row and column location, so <code><a href="#topic+ra_ref">ra_ref</a></code> objects or cell
reference strings with relative or mixed references will raise a warning and
generate <code>NA</code>s.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.cell_addr(x, ...)

as.cell_addr_v(x, ...)

## S3 method for class 'ra_ref'
as.cell_addr(x, ...)

## S3 method for class 'list'
as.cell_addr_v(x, ...)

## S3 method for class 'character'
as.cell_addr(x, fo = NULL, strict = TRUE, ...)

## S3 method for class 'character'
as.cell_addr_v(x, fo = NULL, strict = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.cell_addr_+3A_x">x</code></td>
<td>
<p>a cell reference</p>
</td></tr>
<tr><td><code id="as.cell_addr_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
<tr><td><code id="as.cell_addr_+3A_fo">fo</code></td>
<td>
<p>either <code>"R1C1"</code> (the default) or <code>"A1"</code> specifying the
cell reference format; in many contexts, it can be inferred and is optional</p>
</td></tr>
<tr><td><code id="as.cell_addr_+3A_strict">strict</code></td>
<td>
<p>logical, affects reading and writing of A1 formatted cell
references. When <code>strict = TRUE</code>, references must be declared absolute
through the use of dollar signs, e.g., <code>$A$1</code>,  for parsing. When
making a string, <code>strict = TRUE</code> requests dollar signs for absolute
reference. When <code>strict = FALSE</code>, pure relative reference strings will
be interpreted as absolute, i.e. <code>A1</code> and <code>$A$1</code> are treated the
same. When making a string, <code>strict = FALSE</code> will cause dollars signs
to be omitted in the reference string.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="#topic+cell_addr">cell_addr</a></code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>as.cell_addr(ra_ref())
rar &lt;- ra_ref(2, TRUE, 5, TRUE)
as.cell_addr(rar)
## mixed reference
rar &lt;- ra_ref(2, FALSE, 5, TRUE)
as.cell_addr(rar)
ra_ref_list &lt;-
  list(ra_ref(), ra_ref(2, TRUE, 5, TRUE), ra_ref(2, FALSE, 5, TRUE))
as.cell_addr_v(ra_ref_list)
as.cell_addr("$D$12")
as.cell_addr("R4C3")
as.cell_addr(c("$C$4", "$D$12"))
as.cell_addr("$F2")
as.cell_addr("R[-4]C3")
as.cell_addr("F2", strict = FALSE)
</code></pre>

<hr>
<h2 id='as.ra_ref'>Convert to a ra_ref object</h2><span id='topic+as.ra_ref'></span><span id='topic+as.ra_ref.cell_addr'></span><span id='topic+as.ra_ref.character'></span><span id='topic+as.ra_ref_v'></span><span id='topic+as.ra_ref_v.cell_addr'></span><span id='topic+as.ra_ref_v.character'></span>

<h3>Description</h3>

<p>Convert various representations of a cell reference into an object of class
<code><a href="#topic+ra_ref">ra_ref</a></code>.
</p>

<ul>
<li> <p><code>as.ra_ref</code> is NOT vectorized and therefore requires the input to
represent exactly one cell, i.e. be of length 1.
</p>
</li>
<li> <p><code>as.ra_ref_v</code> accepts input of length &gt;= 1 and returns a list of
<code><a href="#topic+ra_ref">ra_ref</a></code> objects.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>as.ra_ref(x, ...)

as.ra_ref_v(x, ...)

## S3 method for class 'character'
as.ra_ref(x, fo = NULL, strict = TRUE, ...)

## S3 method for class 'character'
as.ra_ref_v(x, fo = NULL, strict = TRUE, ...)

## S3 method for class 'cell_addr'
as.ra_ref(x, ...)

## S3 method for class 'cell_addr'
as.ra_ref_v(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.ra_ref_+3A_x">x</code></td>
<td>
<p>one or more cell references, as a character vector or
<code><a href="#topic+cell_addr">cell_addr</a></code> object</p>
</td></tr>
<tr><td><code id="as.ra_ref_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
<tr><td><code id="as.ra_ref_+3A_fo">fo</code></td>
<td>
<p>either <code>"R1C1"</code> (the default) or <code>"A1"</code> specifying the
cell reference format; in many contexts, it can be inferred and is optional</p>
</td></tr>
<tr><td><code id="as.ra_ref_+3A_strict">strict</code></td>
<td>
<p>logical, affects reading and writing of A1 formatted cell
references. When <code>strict = TRUE</code>, references must be declared absolute
through the use of dollar signs, e.g., <code>$A$1</code>,  for parsing. When
making a string, <code>strict = TRUE</code> requests dollar signs for absolute
reference. When <code>strict = FALSE</code>, pure relative reference strings will
be interpreted as absolute, i.e. <code>A1</code> and <code>$A$1</code> are treated the
same. When making a string, <code>strict = FALSE</code> will cause dollars signs
to be omitted in the reference string.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="#topic+ra_ref">ra_ref</a></code> object, in the case of <code>as.ra_ref</code>, or a
list of them, in the case of <code>as.ra_ref_v</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## as.ra_ref.character()
as.ra_ref("$F$2")
as.ra_ref("R[-4]C3")
as.ra_ref("B4")
as.ra_ref("B4", strict = FALSE)
as.ra_ref("B$4")

## this is actually ambiguous! is format A1 or R1C1 format?
as.ra_ref("RC2")
## format could be specified in this case
as.ra_ref("RC2", fo = "R1C1")
as.ra_ref("RC2", fo = "A1", strict = FALSE)

## as.ra_ref_v.character()
cs &lt;- c("$A$1", "Sheet1!$F$14", "Sheet2!B$4", "D9")
## Not run: 
## won't work because as.ra_ref requires length one input
as.ra_ref(cs)

## End(Not run)
## use as.ra_ref_v instead
as.ra_ref_v(cs, strict = FALSE)
## as.ra_ref.cell_addr
ca &lt;- cell_addr(2, 5)
as.ra_ref(ca)
## as.ra_ref_v.cell_addr()

ca &lt;- cell_addr(1:3, 1)
## Not run: 
## won't work because as.ra_ref methods not natively vectorized
as.ra_ref(ca)

## End(Not run)
## use as.ra_ref_v instead
as.ra_ref_v(ca)
</code></pre>

<hr>
<h2 id='as.range'>Convert a cell_limits object to a cell range</h2><span id='topic+as.range'></span>

<h3>Description</h3>

<p>Convert a cell_limits object to a cell range
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.range(x, fo = c("R1C1", "A1"), strict = FALSE, sheet = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.range_+3A_x">x</code></td>
<td>
<p>a cell_limits object</p>
</td></tr>
<tr><td><code id="as.range_+3A_fo">fo</code></td>
<td>
<p>either <code>"R1C1"</code> (the default) or <code>"A1"</code> specifying the
cell reference format; in many contexts, it can be inferred and is optional</p>
</td></tr>
<tr><td><code id="as.range_+3A_strict">strict</code></td>
<td>
<p>logical, affects reading and writing of A1 formatted cell
references. When <code>strict = TRUE</code>, references must be declared absolute
through the use of dollar signs, e.g., <code>$A$1</code>,  for parsing. When
making a string, <code>strict = TRUE</code> requests dollar signs for absolute
reference. When <code>strict = FALSE</code>, pure relative reference strings will
be interpreted as absolute, i.e. <code>A1</code> and <code>$A$1</code> are treated the
same. When making a string, <code>strict = FALSE</code> will cause dollars signs
to be omitted in the reference string.</p>
</td></tr>
<tr><td><code id="as.range_+3A_sheet">sheet</code></td>
<td>
<p>logical, indicating whether to include worksheet name; if
<code>NULL</code>, worksheet is included if worksheet name is not <code>NA</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>length one character vector holding a cell range
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rgCL &lt;- cell_limits(ul = c(1, 2), lr = c(7, 6))
as.range(rgCL)
as.range(rgCL, fo = "A1")

rgCL_ws &lt;- cell_limits(ul = c(1, 2), lr = c(7, 6), sheet = "A Sheet")
as.range(rgCL_ws)
as.range(rgCL_ws, fo = "A1")
</code></pre>

<hr>
<h2 id='cell_addr'>cell_addr class</h2><span id='topic+cell_addr'></span>

<h3>Description</h3>

<p>The <code>cell_addr</code> class is used to hold the absolute row and column
location for one or more cells. An object of class <code>cell_addr</code> is a list
with two components of equal length, named <code>row</code> and <code>col</code>,
consisting of integers greater than or equal to one or <code>NA</code>. This is in
contrast to the <code><a href="#topic+ra_ref">ra_ref</a></code> class, which holds a representation of a
single absolute, relative, or mixed cell reference from, e.g., a formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cell_addr(row, col)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cell_addr_+3A_row">row</code></td>
<td>
<p>integer. Must be the same length as <code>col</code> or of length one,
which will be recycled to the length of <code>col</code>.</p>
</td></tr>
<tr><td><code id="cell_addr_+3A_col">col</code></td>
<td>
<p>integer. Same deal as for <code>row</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>cell_addr</code> object
</p>


<h3>Reference</h3>

<p>Spreadsheet Implementation Technology: Basics and Extensions
Peter Sestoft
MIT Press 2014
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cell_addr(4, 3)
(ca &lt;- cell_addr(1:4, 3))
ca[2:3]
ca[[4]]
length(ca)
</code></pre>

<hr>
<h2 id='cell_cols'>Specify cell limits only for columns</h2><span id='topic+cell_cols'></span>

<h3>Description</h3>

<p>How does this differ from <code><a href="#topic+cell_limits">cell_limits</a></code>? Two ways. First, the
input can have length greater than 2, i.e. the columns can be specified as
<code>1:n</code>. If the length is greater than 2, both the min and max are taken
with <code>NA.rm = TRUE</code>. Note it is not possible to request non-contiguous
columns, i.e. columns 1, 2, and 5. In this case, the requested columns will
run from the minimum of 1 to the maximum of 5. Second, the input can be given
in the letter-based format spreadsheets use to label columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cell_cols(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cell_cols_+3A_x">x</code></td>
<td>
<p>vector of column limits; if character, converted to numeric; if
length greater than two, min and max will be taken with <code>NA.rm = TRUE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="#topic+cell_limits">cell_limits</a></code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cell_cols(c(NA, 3))
cell_cols(c(7, NA))
cell_cols(4:16)
cell_cols(c(3, NA, 10))

cell_cols("C:G")
cell_cols(c("B", NA))
cell_cols(LETTERS)

</code></pre>

<hr>
<h2 id='cell_limits'>Create a cell_limits object</h2><span id='topic+as.cell_limits'></span><span id='topic+as.cell_limits.NULL'></span><span id='topic+as.cell_limits.cell_limits'></span><span id='topic+as.cell_limits.character'></span><span id='topic+cell_limits'></span><span id='topic+dim.cell_limits'></span>

<h3>Description</h3>

<p>A <code>cell_limits</code> object is a list with three components:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cell_limits(ul = c(NA_integer_, NA_integer_), lr = c(NA_integer_,
  NA_integer_), sheet = NA_character_)

## S3 method for class 'cell_limits'
dim(x)

as.cell_limits(x, ...)

## S3 method for class 'cell_limits'
as.cell_limits(x, ...)

## S3 method for class 'NULL'
as.cell_limits(x, ...)

## S3 method for class 'character'
as.cell_limits(x, fo = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cell_limits_+3A_ul">ul</code></td>
<td>
<p>vector identifying upper left cell of target rectangle</p>
</td></tr>
<tr><td><code id="cell_limits_+3A_lr">lr</code></td>
<td>
<p>vector identifying lower right cell of target rectangle</p>
</td></tr>
<tr><td><code id="cell_limits_+3A_sheet">sheet</code></td>
<td>
<p>string containing worksheet name, optional</p>
</td></tr>
<tr><td><code id="cell_limits_+3A_x">x</code></td>
<td>
<p>input to convert into a <code>cell_limits</code> object</p>
</td></tr>
<tr><td><code id="cell_limits_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
<tr><td><code id="cell_limits_+3A_fo">fo</code></td>
<td>
<p>either <code>"R1C1"</code> (the default) or <code>"A1"</code> specifying the
cell reference format; in many contexts, it can be inferred and is optional</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><code>ul</code> vector specifying upper left cell of target rectangle, of
the form <code>c(ROW_MIN, COL_MIN)</code>
</p>
</li>
<li> <p><code>lr</code> vector specifying lower right cell of target rectangle, of
the form <code>c(ROW_MAX, COL_MAX)</code>
</p>
</li>
<li> <p><code>sheet</code> string specifying worksheet name, which may be
<code>NA</code>, meaning it's unspecified
</p>
</li></ul>

<p>A value of <code>NA</code> in <code>ul</code> or <code>lr</code> means the corresponding limit
is left unspecified. Therefore a verbose way to specify no limits at all
would be <code>cell_limits(c(NA, NA), c(NA, NA))</code>. If the maximum row or
column is specified but the associated minimum is not, then the minimum is
set to 1.
</p>
<p>When specified via character, cell references can be given in A1 or R1C1
notation and must be interpretable as absolute references. For A1, this means
either both row and column are annotated with a dollar sign <code>$</code> or
neither is. So, no mixed references, like <code>B$4</code>. For R1C1, this means no
square brackets, like <code>R[-3]C[3]</code>.
</p>


<h3>Value</h3>

<p>a <code>cell_limits</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cell_limits(c(1, 3), c(1, 5))
cell_limits(c(NA, 7), c(3, NA))
cell_limits(c(NA, 7))
cell_limits(lr = c(3, 7))

cell_limits(c(1, 3), c(1, 5), "Sheet1")
cell_limits(c(1, 3), c(1, 5), "Spaces are evil")

dim(as.cell_limits("A1:F10"))

as.cell_limits("A1")
as.cell_limits("$Q$24")
as.cell_limits("A1:D8")
as.cell_limits("R5C11")
as.cell_limits("R2C3:R6C9")
as.cell_limits("Sheet1!R2C3:R6C9")
as.cell_limits("'Spaces are evil'!R2C3:R6C9")

## Not run: 
## explicitly mixed A1 references won't work
as.cell_limits("A$2")
## mixed or relative R1C1 references won't work
as.cell_limits("RC[4]")

## End(Not run)
</code></pre>

<hr>
<h2 id='cell_rows'>Specify cell limits only for rows</h2><span id='topic+cell_rows'></span>

<h3>Description</h3>

<p>How does this differ from <code><a href="#topic+cell_limits">cell_limits</a></code>? Here the input can have
length greater than 2, i.e. the rows can be specified as <code>1:n</code>. If the
length is greater than 2, both the min and max are taken with <code>NA.rm =
TRUE</code>. Note it is not possible to request non-contiguous rows, i.e. rows 1,
2, and 5. In this case, the requested rows will run from the minimum of 1 to
the maximum of 5.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cell_rows(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cell_rows_+3A_x">x</code></td>
<td>
<p>numeric vector of row limits; if length greater than two, min and
max will be taken with <code>NA.rm = TRUE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="#topic+cell_limits">cell_limits</a></code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cell_rows(c(NA, 3))
cell_rows(c(7, NA))
cell_rows(4:16)
cell_rows(c(3, NA, 10))

dim(cell_rows(1:5))

</code></pre>

<hr>
<h2 id='guess_fo'>Guess cell reference string format</h2><span id='topic+guess_fo'></span>

<h3>Description</h3>

<p>Guess if cell references are in R1C1 or A1 format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>guess_fo(x, fo = c("R1C1", "A1"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="guess_fo_+3A_x">x</code></td>
<td>
<p>character vector of cell reference strings</p>
</td></tr>
<tr><td><code id="guess_fo_+3A_fo">fo</code></td>
<td>
<p>default to assume if format is ambiguous</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character vector consisting of <code>R1C1</code>, <code>A1</code>, or <code>NA</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A1 &lt;- c("A1", "$A1", "A$1", "$A$1", "a1")
guess_fo(A1)
R1C1 &lt;- c("R1C1", "R1C[-1]", "R[-1]C1", "R[-1]C[9]")
guess_fo(R1C1)

guess_fo("RC2")
guess_fo("12")
guess_fo(12)
</code></pre>

<hr>
<h2 id='is_A1'>Test cell reference strings</h2><span id='topic+is_A1'></span><span id='topic+is_R1C1'></span>

<h3>Description</h3>

<p>Test cell reference strings for a specific format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_A1(x)

is_R1C1(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_A1_+3A_x">x</code></td>
<td>
<p>character vector of cell reference strings</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a logical vector
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>is_A1</code>: A1 format, case insenstive; relative, absolute, or mixed
</p>
</li>
<li> <p><code>is_R1C1</code>: R1C1 format; relative, absolute, or mixed
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>is_A1("A1")
is_R1C1("A1")
is_R1C1("R4C12")

x &lt;- c("A1", "$A4", "$b$12", "RC1", "R[-4]C9", "R5C3")
data.frame(x, is_A1(x), is_R1C1(x))
</code></pre>

<hr>
<h2 id='letter-num-conversion'>Convert between letter and integer representations of column IDs</h2><span id='topic+letter-num-conversion'></span><span id='topic+letter_to_num'></span><span id='topic+num_to_letter'></span>

<h3>Description</h3>

<p>Convert &quot;A1&quot;-style column IDs from a letter representation to an integer,
e.g. column A becomes 1, column D becomes 4, etc. Or go the other way around.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>letter_to_num(x)

num_to_letter(y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="letter-num-conversion_+3A_x">x</code></td>
<td>
<p>a character vector of &quot;A1&quot; style column IDs (case insensitive)</p>
</td></tr>
<tr><td><code id="letter-num-conversion_+3A_y">y</code></td>
<td>
<p>a vector of integer column IDs</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Google Sheets have up to 300 columns (column KN).
</p>
</li>
<li><p> Excel 2010 spreadsheets have up to 16,384 columns (column XFD).
</p>
</li>
<li><p> ZZ is column 702.
</p>
</li>
<li><p> ZZZ is column 18,278 (no known spreadsheet actually goes that high).
</p>
</li></ul>



<h3>Value</h3>

<p>a vector of column IDs, either character or integer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>letter_to_num('Z')
letter_to_num(c('AA', 'ZZ', 'ABD', 'ZZZ'))
letter_to_num(c(NA, ''))
num_to_letter(28)
num_to_letter(900)
num_to_letter(18278)
num_to_letter(c(25, 52, 900, 18278))
num_to_letter(c(NA, 0, 4.8, -4))
</code></pre>

<hr>
<h2 id='print.ra_ref'>Print ra_ref object</h2><span id='topic+print.ra_ref'></span>

<h3>Description</h3>

<p>Print ra_ref object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ra_ref'
print(x, fo = c("R1C1", "A1"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.ra_ref_+3A_x">x</code></td>
<td>
<p>an object of class <code><a href="#topic+ra_ref">ra_ref</a></code></p>
</td></tr>
<tr><td><code id="print.ra_ref_+3A_fo">fo</code></td>
<td>
<p>either <code>"R1C1"</code> (the default) or <code>"A1"</code> specifying the
cell reference format; in many contexts, it can be inferred and is optional</p>
</td></tr>
<tr><td><code id="print.ra_ref_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>(rar &lt;- ra_ref(3, TRUE, 1, TRUE))
print(ra_ref(), fo = "A1")

</code></pre>

<hr>
<h2 id='R1C1_to_A1'>Convert R1C1 positioning notation to A1 notation</h2><span id='topic+R1C1_to_A1'></span>

<h3>Description</h3>

<p>Convert cell reference strings from R1C1 to A1 format. This only makes sense
for absolute references, such as <code>"R4C2"</code>. Why? Because otherwise, we'd
have to know the host cell of the reference. Relative and mixed references,
like (<code>"R[3]C[-1]"</code> and <code>"R[1]C5"</code>), will therefore return
<code>NA</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R1C1_to_A1(x, strict = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="R1C1_to_A1_+3A_x">x</code></td>
<td>
<p>vector of cell positions in R1C1 notation</p>
</td></tr>
<tr><td><code id="R1C1_to_A1_+3A_strict">strict</code></td>
<td>
<p>logical, affects reading and writing of A1 formatted cell
references. When <code>strict = TRUE</code>, references must be declared absolute
through the use of dollar signs, e.g., <code>$A$1</code>,  for parsing. When
making a string, <code>strict = TRUE</code> requests dollar signs for absolute
reference. When <code>strict = FALSE</code>, pure relative reference strings will
be interpreted as absolute, i.e. <code>A1</code> and <code>$A$1</code> are treated the
same. When making a string, <code>strict = FALSE</code> will cause dollars signs
to be omitted in the reference string.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character vector of absolute cell references in A1 notation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>R1C1_to_A1("R1C1")
R1C1_to_A1("R10C52", strict = FALSE)
R1C1_to_A1(c("R1C1", "R10C52", "RC4", "R[-3]C[9]"))
</code></pre>

<hr>
<h2 id='ra_ref'>ra_ref class</h2><span id='topic+ra_ref'></span>

<h3>Description</h3>

<p>The <code>ra_ref</code> class is used to represent a single relative, absolute, or
mixed cell reference, presumably found in a formula. When <code>row_abs</code> is
<code>TRUE</code>, it means that <code>row_ref</code> identifies a specific row in an
absolute sense. When <code>row_abs</code> is <code>FALSE</code>, it means that
<code>row_ref</code> holds a positive, zero, or negative offset relative to the
address of the cell containing the formula that contains the associated cell
reference. Ditto for <code>col_abs</code> and <code>col_ref</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ra_ref(row_ref = 1L, row_abs = TRUE, col_ref = 1L, col_abs = TRUE,
  sheet = NA_character_, file = NA_character_)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ra_ref_+3A_row_ref">row_ref</code></td>
<td>
<p>integer, row or row offset</p>
</td></tr>
<tr><td><code id="ra_ref_+3A_row_abs">row_abs</code></td>
<td>
<p>logical indicating whether <code>row_ref</code> is absolute or
relative</p>
</td></tr>
<tr><td><code id="ra_ref_+3A_col_ref">col_ref</code></td>
<td>
<p>integer, column or column offset</p>
</td></tr>
<tr><td><code id="ra_ref_+3A_col_abs">col_abs</code></td>
<td>
<p>logical indicating whether <code>col_ref</code> is absolute or
relative</p>
</td></tr>
<tr><td><code id="ra_ref_+3A_sheet">sheet</code></td>
<td>
<p>the name of a sheet (a.k.a. worksheet or tab)</p>
</td></tr>
<tr><td><code id="ra_ref_+3A_file">file</code></td>
<td>
<p>the name of a file (a.k.a. workbook)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A <code>ra_ref</code> object can also store the name of a sheet and a file, though
these will often be <code>NA</code>. A cell reference in a formula can potentially
be qualified like this: <code>[my_workbook.xlxs]Sheet1!R2C3</code>. In Testoft
(2014), he creates an entirely separate class for this, a <code>cell_ref</code>,
which consists of a sheet- and file-ignorant <code>ra_ref</code> object and a sheet
reference (he doesn't allow formulas to refer to other files). I hope I
don't regret choosing a different path.
</p>


<h3>Value</h3>

<p>a <code>ra_ref</code> object
</p>


<h3>Reference</h3>

<p>Spreadsheet Implementation Technology: Basics and Extensions
Peter Sestoft
MIT Press 2014
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ra_ref()
ra_ref(row_ref = 3, col_ref = 2)
ra_ref(row_ref = 10, row_abs = FALSE, col_ref = 3, col_abs = TRUE)
ra_ref(sheet = "a sheet")
</code></pre>

<hr>
<h2 id='to_string'>Get string representation of cell references</h2><span id='topic+to_string'></span><span id='topic+to_string.cell_addr'></span><span id='topic+to_string.ra_ref'></span><span id='topic+to_string_v'></span><span id='topic+to_string_v.cell_addr'></span><span id='topic+to_string_v.list'></span>

<h3>Description</h3>

<p>Convert various representations of a cell reference to character
</p>

<ul>
<li> <p><code>to_string</code> is not necessarily vectorized. For example, when the
the input is of class <code><a href="#topic+ra_ref">ra_ref</a></code>, it must of be of length one.
However, to be honest, this will actually work for <code><a href="#topic+cell_addr">cell_addr</a></code>,
even when length &gt; 1.
</p>
</li>
<li> <p><code>to_string_v</code> is guaranteed to be vectorized. In particular, input
can be a <code><a href="#topic+cell_addr">cell_addr</a></code> of length &gt;= 1 or a list of
<code><a href="#topic+ra_ref">ra_ref</a></code> objects.
</p>
</li></ul>

<p>If either the row or column reference is relative, note that, in general,
it's impossible to convert to an &quot;A1&quot; formatted string. We would have to know
&quot;relative to what?&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_string(x, fo = c("R1C1", "A1"), strict = TRUE, sheet = NULL, ...)

to_string_v(x, fo = c("R1C1", "A1"), strict = TRUE, sheet = NULL, ...)

## S3 method for class 'ra_ref'
to_string(x, fo = c("R1C1", "A1"), strict = TRUE,
  sheet = NULL, ...)

## S3 method for class 'list'
to_string_v(x, fo = c("R1C1", "A1"), strict = TRUE,
  sheet = NULL, ...)

## S3 method for class 'cell_addr'
to_string(x, fo = c("R1C1", "A1"), strict = TRUE,
  sheet = FALSE, ...)

## S3 method for class 'cell_addr'
to_string_v(x, fo = c("R1C1", "A1"), strict = TRUE,
  sheet = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="to_string_+3A_x">x</code></td>
<td>
<p>a suitable representation of a cell or cell area reference: a single
<code><a href="#topic+ra_ref">ra_ref</a></code> object or a list of them or a <code><a href="#topic+cell_addr">cell_addr</a></code>
object</p>
</td></tr>
<tr><td><code id="to_string_+3A_fo">fo</code></td>
<td>
<p>either <code>"R1C1"</code> (the default) or <code>"A1"</code> specifying the
cell reference format; in many contexts, it can be inferred and is optional</p>
</td></tr>
<tr><td><code id="to_string_+3A_strict">strict</code></td>
<td>
<p>logical, affects reading and writing of A1 formatted cell
references. When <code>strict = TRUE</code>, references must be declared absolute
through the use of dollar signs, e.g., <code>$A$1</code>,  for parsing. When
making a string, <code>strict = TRUE</code> requests dollar signs for absolute
reference. When <code>strict = FALSE</code>, pure relative reference strings will
be interpreted as absolute, i.e. <code>A1</code> and <code>$A$1</code> are treated the
same. When making a string, <code>strict = FALSE</code> will cause dollars signs
to be omitted in the reference string.</p>
</td></tr>
<tr><td><code id="to_string_+3A_sheet">sheet</code></td>
<td>
<p>logical, indicating whether to include worksheet name; if
<code>NULL</code>, worksheet is included if worksheet name is not <code>NA</code></p>
</td></tr>
<tr><td><code id="to_string_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## exactly one ra_ref --&gt; string
to_string(ra_ref())
to_string(ra_ref(), fo = "A1")
to_string(ra_ref(), fo = "A1", strict = FALSE)
to_string(ra_ref(row_ref = 3, col_ref = 2))
to_string(ra_ref(row_ref = 3, col_ref = 2, sheet = "helloooo"))
(mixed_ref &lt;- ra_ref(row_ref = 10, row_abs = FALSE, col_ref = 3))
to_string(mixed_ref)

## this will raise warning and generate NA, because row reference is
## relative and format is A1
to_string(mixed_ref, fo = "A1")

## a list of ra_ref's --&gt; character vector
ra_ref_list &lt;-
  list(ra_ref(), ra_ref(2, TRUE, 5, TRUE), ra_ref(2, FALSE, 5, TRUE))
to_string_v(ra_ref_list)

## cell_addr --&gt; string
(ca &lt;- cell_addr(3, 8))
to_string(ca)
to_string(ca, fo = "A1")

(ca &lt;- cell_addr(1:4, 3))
to_string(ca)
to_string(ca, fo = "A1")
## explicitly go from cell_addr, length &gt; 1 --&gt; character vector
(ca &lt;- cell_addr(1:4, 3))
to_string_v(ca)
to_string_v(ca, fo = "A1")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
