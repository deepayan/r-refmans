<!DOCTYPE html><html lang="en-US"><head><title>Help for package AquaBEHER</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AquaBEHER}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#AgroClimateData'><p>Daily Surface Meteorological Data (1982-2022) Extracted from AgERA5</p></a></li>
<li><a href='#calcEto'><p>Potential Evapotranspiration</p></a></li>
<li><a href='#calcSeasCal'><p>Wet Season Calendar</p></a></li>
<li><a href='#calcWatBal'><p>Daily Soil Water Balance Estimation</p></a></li>
<li><a href='#climateData'><p>Daily Weather Data (1996-2020) from Angochen Weather Observing</p>
Station, Mozambique</a></li>
<li><a href='#seasFcstQBR'><p>Seasonal Forecast of Wet Season Calendar (WSC) from Tercile Rainfall</p>
Probabilities using Quantile Bin Resampling (QBR)</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation and Prediction of Wet Season Calendar and Soil Water
Balance for Agriculture</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Robel Takele <a href="https://orcid.org/0000-0003-0151-2537"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Matteo Dell'Acqua <a href="https://orcid.org/0000-0001-5703-8382"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Robel Takele &lt;takelerobel@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes and integrates daily potential evapotranspiration (PET) 
    and a soil water balance model. It allows users to estimate and predict the
    wet season calendar, including onset, cessation, and duration, based
    on an agroclimatic approach for a specified period. This functionality
    helps in managing agricultural water resources more effectively. For
    detailed methodologies, users can refer to Allen et al. (1998,
    ISBN:92-5-104219-5); Allen (2005, ISBN:9780784408056); Doorenbos and
    Pruitt (1975, ISBN:9251002797); Guo et al. (2016)
    &lt;<a href="https://doi.org/10.1016%2Fj.envsoft.2015.12.019">doi:10.1016/j.envsoft.2015.12.019</a>&gt;; Hargreaves and Samani (1985)
    &lt;<a href="https://doi.org/10.13031%2F2013.26773">doi:10.13031/2013.26773</a>&gt;; Priestley and Taylor (1972)
    <a href="https://journals.ametsoc.org/view/journals/apme/18/7/1520-0450_1979_018_0898_tptema_2_0_co_2.xml">https://journals.ametsoc.org/view/journals/apme/18/7/1520-0450_1979_018_0898_tptema_2_0_co_2.xml</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/RobelTakele/AquaBEHER">https://github.com/RobelTakele/AquaBEHER</a>,
<a href="https://robeltakele.github.io/AquaBEHER/">https://robeltakele.github.io/AquaBEHER/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/RobelTakele/AquaBEHER/issues">https://github.com/RobelTakele/AquaBEHER/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, lubridate, magrittr, rlang, sp, terra, zoo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2, ggrepel, knitr, learnr, prettydoc, rmarkdown,
scales, stringr, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-24 16:55:30 UTC; robel</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-24 22:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='AgroClimateData'>Daily Surface Meteorological Data (1982-2022) Extracted from AgERA5</h2><span id='topic+AgroClimateData'></span>

<h3>Description</h3>

<p>The AgERA5 dataset provides daily surface meteorological data
for the period from 1979 to present as input for agriculture and
agro-ecological studies. This dataset is based on the hourly ECMWF ERA5 data
at surface level, with data from January 1, 1982, through December 31, 2022,
extracted for a grid located in Angochen, Nampula province of Mozambique.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(AgroClimateData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing daily observations of weather variables:
</p>

<ul>
<li> <p><strong>GridID</strong>: Grid ID of the location.
</p>
</li>
<li> <p><strong>Lat</strong>: Latitude of the grid in decimal degrees.
</p>
</li>
<li> <p><strong>Lon</strong>: Longitude of the grid in decimal degrees.
</p>
</li>
<li> <p><strong>Elev</strong>: Elevation above sea level in meters.
</p>
</li>
<li> <p><strong>WHC</strong>: Water holding capacity in millimeters (mm).
</p>
</li>
<li> <p><strong>Year</strong>: Year of record (&quot;YYYY&quot;).
</p>
</li>
<li> <p><strong>Month</strong>: Month of record (&quot;MM&quot;).
</p>
</li>
<li> <p><strong>Day</strong>: Day of record (&quot;DD&quot;).
</p>
</li>
<li> <p><strong>Rain</strong>: Daily precipitation in millimeters (mm/day).
</p>
</li>
<li> <p><strong>Tmax</strong>: Daily maximum temperature at 2 meters height in degrees Celsius
(°C).
</p>
</li>
<li> <p><strong>Tmin</strong>: Daily minimum temperature at 2 meters height in degrees Celsius
(°C).
</p>
</li>
<li> <p><strong>Rs</strong>: Total amount of energy provided by solar radiation at the surface
over the period 00-24h local time per unit area and time (MJ/m^2/day).
</p>
</li>
<li> <p><strong>Tdew</strong>: Mean dew point temperature at a height of 2 meters above the
surface over the period 00h-24h local time (°C).
</p>
</li>
<li> <p><strong>Uz</strong>: Mean wind speed at a height of 2 meters above the surface over the
period 00h-24h local time (m/s).
</p>
</li></ul>



<h3>Source</h3>

<p><a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/sis-agrometeorological-indicators?tab=overview">https://cds.climate.copernicus.eu/cdsapp#!/dataset/sis-agrometeorological-indicators?tab=overview</a>
</p>


<h3>References</h3>

<p>AgERA5, 2021, Copernicus Climate Change Service (C3S), Fifth
generation of ECMWF atmospheric reanalysis of the global climate for
agriculture and agro-ecological studies. Copernicus Climate Change Service
Climate Data Store (CDS), July 2021.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+climateData">climateData</a></code>, <code><a href="#topic+calcEto">calcEto</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load the agroclimate data
data(AgroClimateData)

## Get the structure of the data frame
str(AgroClimateData)

## Get the head of the data frame
head(AgroClimateData)

</code></pre>

<hr>
<h2 id='calcEto'>Potential Evapotranspiration</h2><span id='topic+calcEto'></span>

<h3>Description</h3>

<p>Calculates Penman-Monteith, Priestley Taylor and
Hargreaves-Samani Potential Evapotranspiration using the method described by
Allen et al, (1998)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcEto(data, method = "PM", crop = "short", Zh = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calcEto_+3A_data">data</code></td>
<td>
<p>A dataframe containing the required weather variables with
the following columns:
</p>

<ul>
<li> <p><code>Lat</code>: Latitude of the site in decimal degrees.
</p>
</li>
<li> <p><code>Lon</code>: Longitude of the site in decimal degrees.
</p>
</li>
<li> <p><code>Elev</code>: Elevation above sea level in meters.
</p>
</li>
<li> <p><code>Year</code>: Year of record &quot;YYYY&quot;.
</p>
</li>
<li> <p><code>Month</code>: Month of record &quot;MM&quot;.
</p>
</li>
<li> <p><code>Day</code>: Day of record &quot;DD&quot;.
</p>
</li>
<li> <p><code>Tmax</code>: Daily maximum temperature at 2-m height in °C.
</p>
</li>
<li> <p><code>Tmin</code>: Daily minimum temperature at 2-m height in °C.
</p>
</li>
<li> <p><code>Rs</code>: Daily surface incoming solar radiation in MJ/m^2/day.
</p>
</li>
<li> <p><code>RH or RHmax and RHmin</code>: Daily relative humidity at 2-m height.
</p>
</li>
<li> <p><code>Tdew</code>: Daily dew point temperature at 2-m height in °C.
</p>
</li>
<li> <p><code>U2 or Uz</code>: Daily wind speed at 2-m or custom height (m/s).
</p>
</li></ul>
</td></tr>
<tr><td><code id="calcEto_+3A_method">method</code></td>
<td>
<p>The formulation used to compute Eto; default is <code>"PM"</code>
for Penman-Monteith, <code>"PT"</code> for Priestley-Taylor, and <code>"HS"</code> for
Hargreaves-Samani.</p>
</td></tr>
<tr><td><code id="calcEto_+3A_crop">crop</code></td>
<td>
<p>Either <code>"short"</code> (default) for FAO-56 hypothetical short
grass or <code>"tall"</code> for ASCE-EWRI standard crop.</p>
</td></tr>
<tr><td><code id="calcEto_+3A_zh">Zh</code></td>
<td>
<p>Height of wind speed measurement in meters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Penman-Monteith:</strong> If all variables of Tmax, Tmin, Rs, either U2 or
Uz, and either RHmax and RHmin or RH or Tdew are available and crop surface
(short or tall) is specified, the Penman-Monteith FAO56 formulation is used
(Allen et al. 1998).
</p>
<p><strong>Priestley-Taylor:</strong> If all variables of Tmax, Tmin, Rs, and either
RHmax and RHmin or RH or Tdew are available, the Priestley-Taylor
formulation is used (Priestley and Taylor, 1972).
</p>
<p><strong>Hargreaves-Samani:</strong> If only Tmax and Tmin are available, the
Hargreaves-Samani formulation is used for estimating reference crop
evapotranspiration (Hargreaves and Samani, 1985).
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li> <p><code>ET.Daily</code>: Daily estimations of reference crop
evapotranspiration (mm/day).
</p>
</li>
<li> <p><code>Ra.Daily</code>: Daily estimations of extraterrestrial radiation
(MJ/m^2/day).
</p>
</li>
<li> <p><code>Slope.Daily</code>: Daily estimations of slope of vapor pressure
curve (kPa/°C).
</p>
</li>
<li> <p><code>ET.type</code>: Type of the estimation obtained.
</p>
</li></ul>



<h3>References</h3>

<p>Allen, R.G., L.S. Pereira, D. Raes, and M. Smith. 1998. Crop
evapotranspiration-Guidelines for Computing Crop Water requirements FAO
Irrigation and Drainage Paper 56. FAO, Rome 300: 6541.
</p>
<p>Allen, R. G. 2005. The ASCE standardized reference evapotranspiration
equation. Amer Society of Civil Engineers.
</p>
<p>Guo, D., Westra, S., &amp; Maier, H. (2016). An R package for modelling actual,
potential and reference evapotranspiration. Environmental
Modelling &amp; Software, 78, 216-224. doi:10.1016/j.envsoft.2015.12.019.
</p>
<p>Hargreaves, G.H., &amp; Samani, Z.A. (1985). Reference crop evapotranspiration
from ambient air temperature. American Society of Agricultural Engineers.
</p>
<p>Priestley, C., &amp; Taylor, R. (1972). On the assessment of surface heat flux
and evaporation using large-scale parameters. Monthly Weather Review,
100(2), 81-92.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+climateData">climateData</a></code>, <code><a href="#topic+calcWatBal">calcWatBal</a></code>,
<code><a href="#topic+calcSeasCal">calcSeasCal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load sample data:
data(climateData)
PET.HS &lt;- calcEto(climateData, method = "HS")

## Load sample data:
data(AgroClimateData)
PET.PM &lt;- calcEto(AgroClimateData, method = "PM", crop = "short")

</code></pre>

<hr>
<h2 id='calcSeasCal'>Wet Season Calendar</h2><span id='topic+calcSeasCal'></span>

<h3>Description</h3>

<p>Estimates the wet season calendar, including the onset date,
cessation date, and duration, based on an agroclimatic approach. The
function relies on daily soil water balance parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcSeasCal(data, onsetWind.start, onsetWind.end, cessaWind.end, soilWHC)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calcSeasCal_+3A_data">data</code></td>
<td>
<p>An R dataframe returned by <code><a href="#topic+calcWatBal">calcWatBal</a></code> or
a dataframe with similar parameters.</p>
</td></tr>
<tr><td><code id="calcSeasCal_+3A_onsetwind.start">onsetWind.start</code></td>
<td>
<p>The earliest possible start date for the onset window
in &quot;MM-DD&quot; format.</p>
</td></tr>
<tr><td><code id="calcSeasCal_+3A_onsetwind.end">onsetWind.end</code></td>
<td>
<p>The latest possible end date for the onset window
in &quot;MM-DD&quot; format.</p>
</td></tr>
<tr><td><code id="calcSeasCal_+3A_cessawind.end">cessaWind.end</code></td>
<td>
<p>The latest possible end date for the cessation window
in &quot;MM-DD&quot; format.</p>
</td></tr>
<tr><td><code id="calcSeasCal_+3A_soilwhc">soilWHC</code></td>
<td>
<p>The available soil water holding capacity at
root zone depth (in mm).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The agroclimatic approach defines the wet season based on the balance
between precipitation and potential evapotranspiration (PET). The wet season
begins when the moisture available to crops exceeds their
evapotranspiration demands, ensuring optimal growth conditions.
</p>
<p><strong>Onset:</strong>
The wet season onset is defined as the first day after <code>onsetWind.start</code>
when the ratio of actual evapotranspiration (AET) to potential
evapotranspiration (PET) exceeds 0.5 for at least 5 consecutive days, and the
soil moisture remains above 25% of the available soil water holding capacity
(<code>soilWHC</code>) for a minimum of 20 consecutive days, ensuring sufficient
moisture availability for plant growth.
</p>
<p><strong>Cessation:</strong>
The wet season ends on the first day after <code>onsetWind.end</code> when the
AET/PET ratio falls below 0.5 for at least 5 consecutive days, and the
soil moisture remains below 25% of the available soil water holding capacity
(<code>soilWHC</code>) for a minimum of 12 consecutive days.
</p>
<p><strong>Duration:</strong>
The total duration of the wet season is the number of days between
onset and cessation.
</p>


<h3>Value</h3>

<p>A dataframe containing the following columns:
</p>

<dl>
<dt>Year</dt><dd><p>The year of the season (YYYY).</p>
</dd>
<dt>OnsetDate</dt><dd><p>The onset date, formatted as &quot;YYYY-MM-DD&quot;.</p>
</dd>
<dt>OnsetDOY</dt><dd><p>The Julian day (DOY) of the onset.</p>
</dd>
<dt>OnsetValue</dt><dd><p>The number of days since <code>onsetWind.start</code>.</p>
</dd>
<dt>CessationDate</dt><dd><p>The cessation date, formatted as &quot;YYYY-MM-DD&quot;.</p>
</dd>
<dt>CessationDOY</dt><dd><p>The Julian day (DOY) of the cessation.</p>
</dd>
<dt>CessationValue</dt><dd><p>The number of days since <code>onsetWind.start</code>.</p>
</dd>
<dt>Duration</dt><dd><p>The duration of the wet season (in days).</p>
</dd>
</dl>



<h3>References</h3>

<p>FAO, 1977. Crop water requirements. FAO Irrigation and Drainage Paper No. 24,
by Doorenbos J. and W.O. Pruitt. FAO, Rome, Italy.
</p>
<p>FAO, 1978. Forestry for Local Community Development. FAO Forestry Paper
No. 7, FAO, Rome.
</p>
<p>FAO, 1986. Early Agrometeorological Crop Yield Forecasting. FAO Plant
Production and Protection Paper No. 73, by M. Frère and G.F.
Popov. FAO, Rome.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calcEto">calcEto</a>, <a href="#topic+calcWatBal">calcWatBal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Load example data:
data(AgroClimateData)

## Estimate daily PET:
PET &lt;- calcEto(AgroClimateData, method = "PM", Zh = 10)

## Add the estimated PET 'ET.Daily' to a new column in AgroClimateData:
AgroClimateData$Eto &lt;- PET$ET.Daily

## Estimate daily water balance for the soil having 100mm of WHC:
watBal.list &lt;- calcWatBal(data = AgroClimateData, soilWHC = 100)
watBal &lt;- watBal.list$data

## seasonal calendar is estimated for the onset window ranges from
## 01 September to 31 January having a soil with 100mm of WHC:

soilWHC &lt;- 100
onsetWind.start &lt;- "09-01"
onsetWind.end &lt;- "01-31"
cessaWind.end &lt;- "06-30"

seasCal.dF &lt;- calcSeasCal(
  data = watBal, onsetWind.start, onsetWind.end,
  cessaWind.end, soilWHC
)

str(seasCal.dF)

</code></pre>

<hr>
<h2 id='calcWatBal'>Daily Soil Water Balance Estimation</h2><span id='topic+calcWatBal'></span>

<h3>Description</h3>

<p>Estimates the daily soil water balance based on a
simple mass balance budget approach. It calculates the amount of water
available in the root zone  of a homogeneous grass canopy growing on a
well-drained, homogeneous soil.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcWatBal(data, soilWHC)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calcWatBal_+3A_data">data</code></td>
<td>
<p>A data frame containing the required input variables. The data
frame must include the following columns:
</p>

<ul>
<li> <p><strong>Lat</strong>: Latitude of the site (decimal degrees).
</p>
</li>
<li> <p><strong>Lon</strong>: Longitude of the site (decimal degrees).
</p>
</li>
<li> <p><strong>Elev</strong>: Elevation above sea level (meters).
</p>
</li>
<li> <p><strong>Year</strong>: Year of the record (&quot;YYYY&quot;).
</p>
</li>
<li> <p><strong>Month</strong>: Month of the record (&quot;MM&quot;).
</p>
</li>
<li> <p><strong>Day</strong>: Day of the record (&quot;DD&quot;).
</p>
</li>
<li> <p><strong>Rain</strong>: Daily rainfall (mm).
</p>
</li>
<li> <p><strong>Eto</strong>: Daily potential evapotranspiration (mm).
</p>
</li></ul>
</td></tr>
<tr><td><code id="calcWatBal_+3A_soilwhc">soilWHC</code></td>
<td>
<p>Numeric. Water holding capacity of the soil (mm).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<dl>
<dt><strong>data</strong></dt><dd><p>A data frame containing the results of the water
balance calculations, with the following columns:
</p>

<ul>
<li> <p><strong>DRAIN</strong>: Deep drainage (mm).
</p>
</li>
<li> <p><strong>TRAN</strong>: Water lost by transpiration (mm).
</p>
</li>
<li> <p><strong>RUNOFF</strong>: Surface runoff (mm).
</p>
</li>
<li> <p><strong>AVAIL</strong>: Available soil moisture storage (mm).
</p>
</li>
<li> <p><strong>R</strong>: Ratio of actual to potential evapotranspiration.
</p>
</li></ul>

</dd>
<dt><strong>warnings</strong></dt><dd><p>A list of warnings related to any unrealistic
or adjusted values in the input data or parameters used during the water
balance calculations.</p>
</dd>
</dl>



<h3>References</h3>

<p>Allen, R.G.; Pereira, L.S.; Raes, D.; Smith, M. (1998). <em>Crop
Evapotranspiration: Guidelines for Computing Crop Water Requirements.</em> FAO
Irrigation and Drainage Paper no. 56, FAO: Rome, Italy. ISBN 92-5-104219-5.
</p>
<p>Doorenbos, J., &amp; Pruitt, W.O. (1975). <em>Guidelines for Predicting Crop
Water Requirements.</em> Irrigation and Drainage Paper 24, Food and Agriculture
Organization of the United Nations, Rome, 179 p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calcEto">calcEto</a></code>, <code><a href="#topic+calcSeasCal">calcSeasCal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Load sample data
data(AgroClimateData)

# Estimate daily PET using the Penman-Monteith method
PET.PM &lt;- calcEto(AgroClimateData, method = "PM", Zh = 10)

# Add the estimated PET to the AgroClimateData frame
AgroClimateData$Eto &lt;- PET.PM$ET.Daily

# Estimate daily soil water balance for a soil with 100 mm WHC
watBal &lt;- calcWatBal(data = AgroClimateData, soilWHC = 100)


</code></pre>

<hr>
<h2 id='climateData'>Daily Weather Data (1996-2020) from Angochen Weather Observing
Station, Mozambique</h2><span id='topic+climateData'></span>

<h3>Description</h3>

<p>Contains daily weather data obtained from
Instituto Nacional de Meteorologia (INAM). The sample data includes daily raw
weather data from January 1, 1996, to December 31, 2020, from a weather
station located in Angochen, Nampula province of Mozambique.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(climateData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing daily values of weather variables:
</p>

<ul>
<li> <p><strong>Station_Name</strong>: Name of the weather station.
</p>
</li>
<li> <p><strong>Lat</strong>: Latitude of the site in decimal degrees.
</p>
</li>
<li> <p><strong>Lon</strong>: Longitude of the site in decimal degrees.
</p>
</li>
<li> <p><strong>Elev</strong>: Elevation above sea level in meters.
</p>
</li>
<li> <p><strong>Year</strong>: Year of the record (YYYY).
</p>
</li>
<li> <p><strong>Month</strong>: Month of the record (MM).
</p>
</li>
<li> <p><strong>Day</strong>: Day of the record (DD).
</p>
</li>
<li> <p><strong>Rain</strong>: Daily rainfall in millimeters (mm).
</p>
</li>
<li> <p><strong>Tmax</strong>: Daily maximum temperature at 2 meters height in degrees Celsius
(°C).
</p>
</li>
<li> <p><strong>Tmin</strong>: Daily minimum temperature at 2 meters height in degrees Celsius
(°C).
</p>
</li></ul>



<h3>Source</h3>

<p>INAM - Instituto Nacional de Meteorologia, Mozambique
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AgroClimateData">AgroClimateData</a></code>, <code><a href="#topic+calcEto">calcEto</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load the climate data
data(climateData)

## Get the structure of the data frame
str(climateData)

## Get the head of the data frame
head(climateData)

</code></pre>

<hr>
<h2 id='seasFcstQBR'>Seasonal Forecast of Wet Season Calendar (WSC) from Tercile Rainfall
Probabilities using Quantile Bin Resampling (QBR)</h2><span id='topic+seasFcstQBR'></span>

<h3>Description</h3>

<p>Generates seasonal forecasts for Wet Season Calendar (WSC)
variables (onset or cessation) using tercile seasonal rainfall probabilities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seasFcstQBR(
  hisYearStart,
  hisYearEnd,
  rainTerc,
  seasRain,
  hisWSCvar,
  fcstVarName,
  tercileMethod
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="seasFcstQBR_+3A_hisyearstart">hisYearStart</code></td>
<td>
<p>Starting year (YYYY) for historical resampling.</p>
</td></tr>
<tr><td><code id="seasFcstQBR_+3A_hisyearend">hisYearEnd</code></td>
<td>
<p>Ending year (YYYY) for historical resampling.</p>
</td></tr>
<tr><td><code id="seasFcstQBR_+3A_rainterc">rainTerc</code></td>
<td>
<p>A data frame with tercile probabilities for rainfall.
Columns should be named &quot;T1&quot; (below normal), &quot;T2&quot; (normal), and &quot;T3&quot;
(above normal).</p>
</td></tr>
<tr><td><code id="seasFcstQBR_+3A_seasrain">seasRain</code></td>
<td>
<p>A data frame containing seasonal rainfall data with columns</p>
</td></tr>
<tr><td><code id="seasFcstQBR_+3A_hiswscvar">hisWSCvar</code></td>
<td>
<p>A data frame containing historical WSC simulations. This can
be the output from the <code>calcSeasCal</code> function or a similar data frame with
required columns.</p>
</td></tr>
<tr><td><code id="seasFcstQBR_+3A_fcstvarname">fcstVarName</code></td>
<td>
<p>A character string indicating the WSC variable to forecast
(&quot;Onset&quot; or &quot;Cessation&quot;).</p>
</td></tr>
<tr><td><code id="seasFcstQBR_+3A_tercilemethod">tercileMethod</code></td>
<td>
<p>options are &quot;quantiles&quot; or &quot;fixedValues&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses QBR (Quantile Bin Resampling) to produce forecasts for
onset or cessation of the rainy season. It first categorizes historical WSC
simulations based on seasonal rainfall terciles and then resamples based on
given rainfall probabilities to generate ensemble forecasts.
</p>


<h3>Value</h3>

<p>A data frame containing the tercile probabilities for the WSC
variable (&quot;BelowNormal&quot;, &quot;Normal&quot;, and &quot;AboveNormal&quot;).
</p>


<h3>References</h3>


<ul>
<li><p> MacLeod D, Quichimbo EA, Michaelides K, Asfaw DT, Rosolem R, Cuthbert MO,
et al. (2023) Translating seasonal climate forecasts into water balance
forecasts for decision making. PLOS Clim 2(3): e0000138.
https://doi.org/10.1371/journal.pclm.0000138
</p>
</li>
<li><p> van den Dool HM. A New Look at Weather Forecasting through Analogues.
Monthly Weather Review. 1989; 117(10):2230–2247.
https://doi.org/10.1175/1520-0493(1989)117%3C2230:ANLAWF%3E2.0.CO;2
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+calcSeasCal">calcSeasCal</a>, <a href="#topic+calcWatBal">calcWatBal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

## Load example data:
data(AgroClimateData)

## Estimate daily PET:
PET &lt;- calcEto(AgroClimateData, method = "PM", Zh = 10)

## Add the estimated PET 'ET.Daily' to a new column in AgroClimateData:
AgroClimateData$Eto &lt;- PET$ET.Daily

## Estimate daily water balance for the soil having 100mm of WHC:
watBal.list &lt;- calcWatBal(data = AgroClimateData, soilWHC = 100)
watBal &lt;- watBal.list$data

## seasonal calendar is estimated for the onset window ranges from
## 01 September to 31 January having a soil with 100mm of WHC:

soilWHC &lt;- 100
onsetWind.start &lt;- "09-01"
onsetWind.end &lt;- "01-31"
cessaWind.end &lt;- "06-30"

seasCal.dF &lt;- calcSeasCal(
  data = watBal, onsetWind.start, onsetWind.end,
  cessaWind.end, soilWHC
)

## Tercile Rainfall Probabilities of seasonal Forecast for OND, 2023:
rainTerc &lt;- data.frame(T1 = 0.15, T2 = 0.10, T3 = 0.75)

## Summarize rainfall data for October to December:
seasRain &lt;- AgroClimateData %&gt;%
  filter(Month %in% c(10, 11, 12)) %&gt;%
  group_by(Year) %&gt;%
  summarize(sRain = sum(Rain))

## Start of the historical resampling year
hisYearStart &lt;- 1991

## End of the historical resampling year
hisYearEnd &lt;- 2022

## Historical WSC Simulations:
hisWSCvar &lt;- seasCal.dF

## WSC variable to forecast:
fcstVarName &lt;- "Onset"
tercileMethod &lt;- "quantiles"

SeasFcst.dF &lt;- seasFcstQBR(
  hisYearStart, hisYearEnd, rainTerc,
  seasRain, hisWSCvar, fcstVarName,
  tercileMethod
)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
