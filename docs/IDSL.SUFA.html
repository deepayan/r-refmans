<!DOCTYPE html><html><head><title>Help for package IDSL.SUFA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {IDSL.SUFA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#element_sorter'>
<p>Element Sorter</p></a></li>
<li><a href='#formula_adduct_calculator'>
<p>Formula Adduct Calculator</p></a></li>
<li><a href='#formula_vector_generator'>
<p>Molecular Formula Vector Generator</p></a></li>
<li><a href='#ionization_pathway_deconvoluter'>
<p>Ionization Pathway Deconvoluter</p></a></li>
<li><a href='#isotopic_profile_calculator'>
<p>Isotopic Profile Calculator</p></a></li>
<li><a href='#isotopic_profile_molecular_formula_feeder'>
<p>Isotopic Profile Molecular Formula Feeder</p></a></li>
<li><a href='#SUFA_hill_molecular_formula_printer'>
<p>Print Hill Molecular Formula</p></a></li>
<li><a href='#UFA_locate_regex'>
<p>UFA Locate regex</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simplified UFA</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Author:</td>
<td>Sadjad Fakouri-Baygi
    <a href="https://orcid.org/0000-0002-6864-6911"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Dinesh Barupal <a href="https://orcid.org/0000-0002-9954-8628"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dinesh Barupal &lt;dinesh.barupal@mssm.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A simplified version of the 'IDSL.UFA' package to calculate isotopic profiles and adduct formulas from molecular formulas with no dependency on other R packages for online tools and educational mass spectrometry courses. The 'IDSL.SUFA' package also provides an ancillary module to process user-defined adduct formulas.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/idslme/idsl.sufa">https://github.com/idslme/idsl.sufa</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/idslme/idsl.sufa/issues">https://github.com/idslme/idsl.sufa/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Archs:</td>
<td>i386, x64</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-23 16:38:52 UTC; sfbaygi</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-23 22:32:15 UTC</td>
</tr>
</table>
<hr>
<h2 id='element_sorter'>
Element Sorter
</h2><span id='topic+element_sorter'></span>

<h3>Description</h3>

<p>This module sorts 84 non-labeled and 14 labeled elements in the periodic table for molecular formula deconvolution and isotopic profile calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>element_sorter(ElementList = "all", alphabeticalOrder = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="element_sorter_+3A_elementlist">ElementList</code></td>
<td>

<p>A string vector of elements needed for isotopic profile calculation. The default value for this parameter is a vector string of entire elements.
</p>
</td></tr>
<tr><td><code id="element_sorter_+3A_alphabeticalorder">alphabeticalOrder</code></td>
<td>

<p>'TRUE' should be used to sort the elements for elemental deconvolution (default value), 'FALSE' should be used to keep the input order.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Elements</code></td>
<td>

<p>A string vector of elements (alphabetically sorted or unsorted)
</p>
</td></tr>
<tr><td><code>massAbundanceList</code></td>
<td>

<p>A list of isotopic mass and abundance of elements.
</p>
</td></tr>
<tr><td><code>Valence</code></td>
<td>

<p>A vector of electron valences.
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>EL_mass_abundance_val &lt;- element_sorter()
</code></pre>

<hr>
<h2 id='formula_adduct_calculator'>
Formula Adduct Calculator
</h2><span id='topic+formula_adduct_calculator'></span>

<h3>Description</h3>

<p>This function takes a formula and a vector of ionization pathways and returns the adduct formulas.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formula_adduct_calculator(molecular_formula, IonPathway)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formula_adduct_calculator_+3A_molecular_formula">molecular_formula</code></td>
<td>

<p>molecular formula
</p>
</td></tr>
<tr><td><code id="formula_adduct_calculator_+3A_ionpathway">IonPathway</code></td>
<td>

<p>An ionization pathway. Pathways should be like [Coeff*M+ADD1-DED1+...] where &quot;Coeff&quot; should be an integer between 1-9 and ADD1 and DED1 may be ionization pathways. ex: 'IonPathway &lt;- c(&quot;[M]+&quot;, &quot;[M+H]+&quot;, &quot;[2M-Cl]-&quot;, &quot;[3M+CO2-H2O+Na-KO2+HCl-NH4]-&quot;)'
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of adduct formulas
</p>


<h3>Examples</h3>

<pre><code class='language-R'>molecular_formula = "C15H10O7"
IonPathway = c("[M]+","[M+H]","[M+H2O+H]","[M+Na]")
Formula_adducts &lt;- formula_adduct_calculator(molecular_formula, IonPathway)
</code></pre>

<hr>
<h2 id='formula_vector_generator'>
Molecular Formula Vector Generator
</h2><span id='topic+formula_vector_generator'></span>

<h3>Description</h3>

<p>This function convert a molecular formulas into a numerical vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formula_vector_generator(molecular_formula, Elements, LElements = length(Elements),
allowedRedundantElements = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formula_vector_generator_+3A_molecular_formula">molecular_formula</code></td>
<td>

<p>molecular formula
</p>
</td></tr>
<tr><td><code id="formula_vector_generator_+3A_elements">Elements</code></td>
<td>

<p>a string vector of elements. This value must be driven from the 'element_sorter' function.
</p>
</td></tr>
<tr><td><code id="formula_vector_generator_+3A_lelements">LElements</code></td>
<td>

<p>number of elements. To speed up loop calculations, consider calculating the number of elements outside of the loop.
</p>
</td></tr>
<tr><td><code id="formula_vector_generator_+3A_allowedredundantelements">allowedRedundantElements</code></td>
<td>

<p>'TRUE' should be used to deconvolute molecular formulas with redundant elements (e.g. CO2CH3O), and 'FALSE' should be used to skip such complex molecular formulas.(default value)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numerical vector for the molecular formula. This function returns a vector of -Inf values when the molecular formula has elements not listed in the 'Elements' string vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>molecular_formula &lt;- "[13]C2C12H2Br5Cl3O"
Elements_molecular_formula &lt;- c("[13]C", "C", "H", "O", "Br", "Cl")
EL &lt;- element_sorter(ElementList = Elements_molecular_formula, alphabeticalOrder = TRUE)
Elements &lt;- EL[["Elements"]]
LElements &lt;- length(Elements)
##
mol_vec &lt;- formula_vector_generator(molecular_formula, Elements, LElements)
##
regenerated_molecular_formula &lt;- SUFA_hill_molecular_formula_printer(Elements, mol_vec)
</code></pre>

<hr>
<h2 id='ionization_pathway_deconvoluter'>
Ionization Pathway Deconvoluter
</h2><span id='topic+ionization_pathway_deconvoluter'></span>

<h3>Description</h3>

<p>This function deconvolutes ionization pathways into a coefficient and a numerical vector to simplify prediction ionization pathways.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ionization_pathway_deconvoluter(IonPathways, Elements)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ionization_pathway_deconvoluter_+3A_ionpathways">IonPathways</code></td>
<td>

<p>A vector of ionization pathways. Pathways should be like [Coeff*M+ADD1-DED1+...] where &quot;Coeff&quot; should be an integer between 1-9 and ADD1 and DED1 may be ionization pathways. ex: 'IonPathways &lt;- c(&quot;[M]+&quot;, &quot;[M+H]+&quot;, &quot;[2M-Cl]-&quot;, &quot;[3M+CO2-H2O+Na-KO2+HCl-NH4]-&quot;)'
</p>
</td></tr>
<tr><td><code id="ionization_pathway_deconvoluter_+3A_elements">Elements</code></td>
<td>

<p>A vector string of the used elements
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of adduct calculation values for each ionization pathway.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Elements &lt;- element_sorter()[["Elements"]]
IonPathways &lt;- c("[M]+", "[M+H]+", "[2M-Cl]-", "[3M+CO2-H2O+2Na-KO2+HCl-2NH4]-")
Ion_DC &lt;- ionization_pathway_deconvoluter(IonPathways, Elements)
</code></pre>

<hr>
<h2 id='isotopic_profile_calculator'>
Isotopic Profile Calculator
</h2><span id='topic+isotopic_profile_calculator'></span>

<h3>Description</h3>

<p>This function was designed to calculate isotopic profile distributions for small molecules with masses &lt;= 1200 Da. Nonetheless, this function may suit more complicated tasks with complex biological compounds. Details of the equations used in this function are available in the reference[1]. In this function, neighboring isotopologues are merged using the satellite clustering merging (SCM) method described in the reference[2].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isotopic_profile_calculator(MoleFormVec, massAbundanceList, peak_spacing,
intensity_cutoff, UFA_IP_memeory_variables = c(1e30, 1e-12, 100))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isotopic_profile_calculator_+3A_moleformvec">MoleFormVec</code></td>
<td>

<p>A numerical vector of the molecular formula
</p>
</td></tr>
<tr><td><code id="isotopic_profile_calculator_+3A_massabundancelist">massAbundanceList</code></td>
<td>

<p>A list of isotopic mass and abundance of elements obtained from the 'element_sorter' function
</p>
</td></tr>
<tr><td><code id="isotopic_profile_calculator_+3A_peak_spacing">peak_spacing</code></td>
<td>

<p>A maximum space between two isotopologues in Da
</p>
</td></tr>
<tr><td><code id="isotopic_profile_calculator_+3A_intensity_cutoff">intensity_cutoff</code></td>
<td>

<p>A minimum intensity threshold for isotopic profiles in percentage
</p>
</td></tr>
<tr><td><code id="isotopic_profile_calculator_+3A_ufa_ip_memeory_variables">UFA_IP_memeory_variables</code></td>
<td>

<p>A vector of three variables. Default values are c(1e30, 1e-12, 100) to manage memory usage. UFA_IP_memeory_variables[1] is used to control the overall size of isotopic combinations. UFA_IP_memeory_variables[2] indicates the minimum relative abundance (RA calculated by eq(1) in the reference [1]) of an isotopologue to include in the isotopic profile calculations. UFA_IP_memeory_variables[3] is the maximum elapsed time to calculate the isotopic profile on the 'setTimeLimit' function of base R.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of isotopic profile. The first and second column represents the mass and intensity profiles, respectively.
</p>


<h3>References</h3>

<p>[1] Fakouri Baygi, S., Crimmins, B.S., Hopke, P.K. Holsen, T.M. (2016). Comprehensive emerging chemical discovery: novel polyfluorinated compounds in Lake Michigan trout. <em>Environmental Science and Technology</em>, 50(17), 9460-9468, <a href="https://doi.org/10.1021/acs.est.6b01349">doi:10.1021/acs.est.6b01349</a>.
</p>
<p>[2] Fakouri Baygi, S., Fernando, S., Hopke, P.K., Holsen, T.M. and Crimmins, B.S. (2019). Automated Isotopic Profile Deconvolution for High Resolution Mass Spectrometric Data (APGC-QToF) from Biological Matrices. <em>Analytical chemistry</em>, 91(24), 15509-15517, <a href="https://doi.org/10.1021/acs.analchem.9b03335">doi:10.1021/acs.analchem.9b03335</a>.
</p>


<h3>See Also</h3>

<p><a href="https://ipc.idsl.me/">https://ipc.idsl.me/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>EL &lt;- element_sorter(alphabeticalOrder = TRUE)
Elements &lt;- EL[["Elements"]]
massAbundanceList &lt;- EL[["massAbundanceList"]]
peak_spacing &lt;- 0.005 # mDa
intensity_cutoff &lt;- 1 # (in percentage)
MoleFormVec &lt;- formula_vector_generator("C8H10N4O2", Elements)
IP &lt;- isotopic_profile_calculator(MoleFormVec, massAbundanceList, peak_spacing,
intensity_cutoff)
</code></pre>

<hr>
<h2 id='isotopic_profile_molecular_formula_feeder'>
Isotopic Profile Molecular Formula Feeder
</h2><span id='topic+isotopic_profile_molecular_formula_feeder'></span>

<h3>Description</h3>

<p>A function to calculate isotopic profiles from a molecular formulas
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isotopic_profile_molecular_formula_feeder(molecular_formula, peak_spacing = 0,
intensity_cutoff = 1, IonPathway = "[M]", UFA_IP_memeory_variables = c(1e30, 1e-12, 100),
plotProfile = TRUE, allowedVerbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isotopic_profile_molecular_formula_feeder_+3A_molecular_formula">molecular_formula</code></td>
<td>

<p>A molecular formulas
</p>
</td></tr>
<tr><td><code id="isotopic_profile_molecular_formula_feeder_+3A_peak_spacing">peak_spacing</code></td>
<td>

<p>A maximum space between isotopologues in Da to merge neighboring isotopologues.
</p>
</td></tr>
<tr><td><code id="isotopic_profile_molecular_formula_feeder_+3A_intensity_cutoff">intensity_cutoff</code></td>
<td>

<p>A minimum intensity threshold for isotopic profiles in percentage.
</p>
</td></tr>
<tr><td><code id="isotopic_profile_molecular_formula_feeder_+3A_ionpathway">IonPathway</code></td>
<td>

<p>An ionization pathway. Pathways should be like [Coeff*M+ADD1-DED1+...] where &quot;Coeff&quot; should be an integer between 1-9 and ADD1 and DED1 may be ionization pathways. ex: 'IonPathway &lt;- c(&quot;[M]+&quot;, &quot;[M+H]+&quot;, &quot;[2M-Cl]-&quot;, &quot;[3M+CO2-H2O+Na-KO2+HCl-NH4]-&quot;)'
</p>
</td></tr>
<tr><td><code id="isotopic_profile_molecular_formula_feeder_+3A_ufa_ip_memeory_variables">UFA_IP_memeory_variables</code></td>
<td>

<p>A vector of three variables. Default values are c(1e30, 1e-12, 100) to manage memory usage. UFA_IP_memeory_variables[1] is used to control the overall size of isotopic combinations. UFA_IP_memeory_variables[2] indicates the minimum relative abundance (RA calculated by eq(1) in the reference [1]) of an isotopologue to include in the isotopic profile calculations. UFA_IP_memeory_variables[3] is the maximum elapsed time to calculate the isotopic profile on the 'setTimeLimit' function of base R.
</p>
</td></tr>
<tr><td><code id="isotopic_profile_molecular_formula_feeder_+3A_plotprofile">plotProfile</code></td>
<td>

<p>c(TRUE, FALSE). A 'TRUE' plotProfile generates a spectra plot.
</p>
</td></tr>
<tr><td><code id="isotopic_profile_molecular_formula_feeder_+3A_allowedverbose">allowedVerbose</code></td>
<td>

<p>c(TRUE, FALSE). A 'TRUE' allowedVerbose provides messages about the flow of the function.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of isotopic profiles
</p>


<h3>References</h3>

<p>[1] Fakouri Baygi, S., Crimmins, B.S., Hopke, P.K. Holsen, T.M. (2016). Comprehensive emerging chemical discovery: novel polyfluorinated compounds in Lake Michigan trout. <em>Environmental Science and Technology</em>, 50(17), 9460-9468, <a href="https://doi.org/10.1021/acs.est.6b01349">doi:10.1021/acs.est.6b01349</a>.
</p>


<h3>See Also</h3>

<p><a href="https://ipc.idsl.me/">https://ipc.idsl.me/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
molecular_formula &lt;- "C12Cl10"
peak_spacing &lt;- 0.005 # in Da for QToF instruments
# Use this piece of code for intensity cutoff to preserve significant isotopologues
intensity_cutoff &lt;- 1
IonPathway &lt;- "[M+H]+"
isotopic_profile &lt;- isotopic_profile_molecular_formula_feeder(molecular_formula,
peak_spacing, intensity_cutoff, IonPathway)

</code></pre>

<hr>
<h2 id='SUFA_hill_molecular_formula_printer'>
Print Hill Molecular Formula
</h2><span id='topic+SUFA_hill_molecular_formula_printer'></span>

<h3>Description</h3>

<p>This function produces molecular formulas from a list numerical vectors in the Hill notation system
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SUFA_hill_molecular_formula_printer(Elements, MolVecMat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SUFA_hill_molecular_formula_printer_+3A_elements">Elements</code></td>
<td>

<p>A vector string of the used elements.
</p>
</td></tr>
<tr><td><code id="SUFA_hill_molecular_formula_printer_+3A_molvecmat">MolVecMat</code></td>
<td>

<p>A matrix of numerical vectors of molecular formulas in each row.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of molecular formulas
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Elements &lt;- c("C", "H", "O", "N", "Br", "Cl")
MoleFormVec1 &lt;- c(2, 6, 1, 0, 0, 0) # C2H6O
MoleFormVec2 &lt;- c(8, 10, 2, 4, 0 ,0) # C8H10N4O2
MoleFormVec3 &lt;- c(12, 2, 1, 0, 5, 3) # C12H2Br5Cl3O
MolVecMat &lt;- rbind(MoleFormVec1, MoleFormVec2, MoleFormVec3)
H_MolF &lt;- SUFA_hill_molecular_formula_printer(Elements, MolVecMat)
</code></pre>

<hr>
<h2 id='UFA_locate_regex'>
UFA Locate regex
</h2><span id='topic+UFA_locate_regex'></span>

<h3>Description</h3>

<p>Locate indices of the pattern in the string
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UFA_locate_regex(string, pattern, ignore.case = FALSE, perl = FALSE, fixed = FALSE,
useBytes = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UFA_locate_regex_+3A_string">string</code></td>
<td>

<p>a string as character
</p>
</td></tr>
<tr><td><code id="UFA_locate_regex_+3A_pattern">pattern</code></td>
<td>

<p>a pattern to screen
</p>
</td></tr>
<tr><td><code id="UFA_locate_regex_+3A_ignore.case">ignore.case</code></td>
<td>

<p>ignore.case
</p>
</td></tr>
<tr><td><code id="UFA_locate_regex_+3A_perl">perl</code></td>
<td>

<p>perl
</p>
</td></tr>
<tr><td><code id="UFA_locate_regex_+3A_fixed">fixed</code></td>
<td>

<p>fixed
</p>
</td></tr>
<tr><td><code id="UFA_locate_regex_+3A_usebytes">useBytes</code></td>
<td>

<p>useBytes
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns 'NULL' when no matches are detected for the pattern.
</p>


<h3>Value</h3>

<p>A 2-column matrix of location indices. The first and second columns represent start and end positions, respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pattern &lt;- "Cl"
string &lt;- "NaCl.5HCl"
Location_Cl &lt;- UFA_locate_regex(string, pattern)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
