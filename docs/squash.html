<!DOCTYPE html><html><head><title>Help for package squash</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {squash}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cimage'><p> Draw a matrix of colored rectangles</p></a></li>
<li><a href='#cmap'><p> Apply a color map to numeric data</p></a></li>
<li><a href='#colorgram'><p> Draw a colorgram (heatmap) of a matrix</p></a></li>
<li><a href='#ColorPalettes'><p> Bonus color palettes</p></a></li>
<li><a href='#corrogram'><p> Draw a color-coded triangular matrix of pairwise correlations</p></a></li>
<li><a href='#dendromat'><p> Plot a dendrogram with a colorgram underneath</p></a></li>
<li><a href='#diamond'><p> Draw diamonds</p></a></li>
<li><a href='#distogram'><p> Draw a color-coded triangular distance matrix</p></a></li>
<li><a href='#hist2'><p> Bivariate histogram</p></a></li>
<li><a href='#hkey'><p> Add a color key to a plot</p></a></li>
<li><a href='#makecmap'>
<p>Generate a color map from numeric values to colors</p></a></li>
<li><a href='#matapply'><p> Apply a function over z coordinates, binned by their x, y coordinates</p></a></li>
<li><a href='#prettyInt'><p> Pretty breakpoints</p></a></li>
<li><a href='#savemat'><p>Save a matrix as a raster image file</p></a></li>
<li><a href='#squashgram'><p> Visualize a function of z coordinates, binned by x, y coordinates</p></a></li>
<li><a href='#trianglegram'><p> Draw a color-coded triangular matrix</p></a></li>
<li><a href='#xyzmat.coords'><p>Extract (x, y, z) coordinates, where z is a matrix</p></a></li>
<li><a href='#xyzmat2xyz'><p>Convert (x, y, zmat) coordinates to (x, y, z) coordinates</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.9</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-02-19</td>
</tr>
<tr>
<td>Title:</td>
<td>Color-Based Plots for Multivariate Visualization</td>
</tr>
<tr>
<td>Author:</td>
<td>Aron C. Eklund</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aron C. Eklund &lt;aroneklund@gmail.com&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, methods, stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for color-based visualization of multivariate data, i.e. colorgrams or heatmaps.  Lower-level functions  map numeric values to colors, display a matrix as an array of colors, and draw color keys.  Higher-level plotting functions generate a bivariate histogram, a dendrogram aligned with a color-coded matrix, a triangular distance matrix, and more.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/Artistic-2.0">Artistic-2.0</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/aroneklund/squash">https://github.com/aroneklund/squash</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-02-19 21:11:20 UTC; acek</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-02-20 07:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='cimage'> Draw a matrix of colored rectangles  </h2><span id='topic+cimage'></span>

<h3>Description</h3>

<p>Draw a matrix of colored rectangles, possibly of varying sizes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cimage(x = NULL, y = NULL, zcol = NULL, zsize = 1, 
       xlab = NULL, ylab = NULL, xlabels = NULL, ylabels = NULL, 
       border = NA, add = FALSE, axes = TRUE, useRaster = FALSE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cimage_+3A_x">x</code></td>
<td>
<p> Vector of rectangle midpoints or breakpoints along X-axis (corresponding to the columns of zcol). </p>
</td></tr>
<tr><td><code id="cimage_+3A_y">y</code></td>
<td>
<p> Vector of rectangle midpoints or breakpoints along Y-axis (corresponding to the rows of zcol). </p>
</td></tr>
<tr><td><code id="cimage_+3A_zcol">zcol</code></td>
<td>
<p> Matrix of colors for each rectangle, e.g. RGB values or integer indices. </p>
</td></tr>
<tr><td><code id="cimage_+3A_zsize">zsize</code></td>
<td>
<p> Relative size for each rectangle, ranging from 0 to 1. Will be recycled if necessary.  </p>
</td></tr>
<tr><td><code id="cimage_+3A_xlab">xlab</code>, <code id="cimage_+3A_ylab">ylab</code></td>
<td>
<p> Labels for the axes. </p>
</td></tr>
<tr><td><code id="cimage_+3A_xlabels">xlabels</code>, <code id="cimage_+3A_ylabels">ylabels</code></td>
<td>
<p> Categorical labels for rows/columns. </p>
</td></tr>
<tr><td><code id="cimage_+3A_border">border</code></td>
<td>
<p> Color for rectangle borders. </p>
</td></tr>
<tr><td><code id="cimage_+3A_add">add</code></td>
<td>
<p> Add to the current plot instead of creating a new one? </p>
</td></tr>
<tr><td><code id="cimage_+3A_axes">axes</code></td>
<td>
<p> Draw axes on the plot? </p>
</td></tr>
<tr><td><code id="cimage_+3A_useraster">useRaster</code></td>
<td>
<p> TRUE = draw a true raster image (using <code><a href="graphics.html#topic+rasterImage">rasterImage</a></code>). FALSE = draw a series of individual rectangles. </p>
</td></tr>
<tr><td><code id="cimage_+3A_...">...</code></td>
<td>
<p> Further arguments passed to <code><a href="graphics.html#topic+plot">plot</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data (<code>x</code>, <code>y</code>, and <code>zcol</code>) can be passed to this function in any format recognized by <code><a href="#topic+xyzmat.coords">xyzmat.coords</a></code>. 
</p>
<p>This function is somewhat similar to the function <code><a href="graphics.html#topic+image">image</a></code>, except that the colors are specified explicitly, and the size of each rectangle can be adjusted.
</p>
<p>If <code>xlabels</code> is <code>NULL</code> (the default), standard numeric axes are drawn on the X-axis. If <code>xlabels</code> is <code>TRUE</code>, the rownames of <code>zcol</code> are placed below each column. Otherwise, <code>xlabels</code> is taken as a vector of labels to be placed below each column.  Likewise for <code>ylabels</code> and the Y-axis.
</p>
<p>Using <code>useRaster=TRUE</code> can reduce the file size for large matrices drawn to vector-based graphics output such as PDFs. However, the output may look strange with smaller matrices on graphics devices that do smoothing by default (such as PDF output viewed in Preview). 
</p>


<h3>Value</h3>

<p>None.
</p>


<h3>Note</h3>

<p>Currently, this function will may not behave as expected if the <code>x</code> and/or <code>y</code> values are specified as midpoints and are not evenly spaced.
</p>


<h3>See Also</h3>

  
<p><code><a href="graphics.html#topic+image">image</a></code> and <code><a href="graphics.html#topic+rasterImage">rasterImage</a></code> provide somewhat similar functionality.
</p>
<p>This function is called by <code><a href="#topic+colorgram">colorgram</a></code>, which accepts a numeric (rather than color) matrix as input.
</p>
<p>The package <span class="pkg">pixmap</span> may be more suitable for plotting images that are not data-driven (e.g. external files).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  ## Visualize nearly all built-in R colors
  color.mat &lt;- matrix(colors()[1:625], nrow = 25)
  cimage(zcol = color.mat)

  ## An example using "zsize"
  x &lt;- y &lt;- 1:10
  zcolor &lt;- matrix( rainbow(100)[outer(x, y)], nrow = 10 )
  zsize &lt;- matrix( runif(100), nrow = 10 )
  cimage(x, y, zcol = zcolor, zsize = zsize)

  ## Another simple example
  red &lt;- green &lt;- 0:255
  rg &lt;- outer(red, green, rgb, blue = 1, maxColorValue = 255)
  cimage(red, green, zcol = rg)
  
  ## The same, but using useRaster (resulting in faster image generation, 
  ## and smaller file size if saved as a PDF)
  cimage(red, green, zcol = rg, useRaster = TRUE)

  ## An example with categorical axes
  colormixer &lt;- function(x, y) {
      r &lt;- (col2rgb(x) + col2rgb(y)) / 2
      rgb(as.data.frame(t(r)), maxColorValue = 255)
  }
  set.seed(123)
  x &lt;- sample(colors(), 15)
  y &lt;- sample(colors(), 10)
  mix &lt;- outer(x, y, colormixer)
  op &lt;- par(mar = c(8, 8, 2, 2), las = 2)
  cimage(zcol = mix, xlabels = x, ylabels = y, xlab = NA, ylab = NA)
  par(op)
  
  ## An example with non-uniform midpoints and breakpoints
  rg2 &lt;- rg[seq(1, 255, by = 62), seq(1, 255, by = 62)]
  cimage(x = (1:5)^2, y = c(3, 5, 6, 9, 10, 11), zcol = rg2, 
         zsize = matrix(runif(25, min = 0.5), nrow = 5))
    
</code></pre>

<hr>
<h2 id='cmap'> Apply a color map to numeric data  </h2><span id='topic+cmap'></span>

<h3>Description</h3>

<p>Map numeric (scalars, vectors, matrices) into colors, (optionally) using a specified color map.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cmap(x, map, outlier = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cmap_+3A_x">x</code></td>
<td>
<p> Something numeric (vector, matrix). </p>
</td></tr>
<tr><td><code id="cmap_+3A_map">map</code></td>
<td>
<p> The color map to use (as created by <code><a href="#topic+makecmap">makecmap</a></code>).  If missing, a color map is created. </p>
</td></tr>
<tr><td><code id="cmap_+3A_outlier">outlier</code></td>
<td>
<p> Color for values outside the map domain, or NULL to generate an error in case of such values (see Details).</p>
</td></tr>
<tr><td><code id="cmap_+3A_...">...</code></td>
<td>
<p> Arguments passed to <code><a href="#topic+makecmap">makecmap</a></code>, if <code>map</code> is undefined. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Values in <code>x</code> outside the domain of <code>map</code> cause either an error (if <code>outlier=NULL</code>) or a warning (otherwise).
</p>


<h3>Value</h3>

<p>Something of the same size as <code>x</code>.  May be character (RGB) or integer
(palettes) depending on the color map used.  Dimensions and dimnames are preserved.  
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+makecmap">makecmap</a></code>.  Also, <code><a href="grDevices.html#topic+as.raster">as.raster</a></code> and <code><a href="lattice.html#topic+level.colors">level.colors</a></code> have similar functionality. </p>


<h3>Examples</h3>

<pre><code class='language-R'>  x &lt;- y &lt;- 1:50
  mat1 &lt;- outer(x, y)
  
  ## several ways of visualizing the matrix mat1:
  plot(col(mat1), row(mat1), col = cmap(mat1), pch = 16)
  
  cimage(x, y, zcol = cmap(mat1))

  colorgram(x = x, y = y, z = mat1)
  
  ## treatment of out-of-domain values
  map &lt;- makecmap(0:100, colFn = greyscale)
  x &lt;- y &lt;- -10:10
  mat2 &lt;- outer(x, y, "*")

  ## Not run: 
  ## Values outside the domain of "map" generate an error...
  plot(col(mat2), row(mat2), col = cmap(mat2, map), pch = 15, cex = 2)

  ## ... unless we specify "outlier", but this still generates a warning
  plot(col(mat2), row(mat2), col = cmap(mat2, map, outlier = 'red'), pch = 15, cex = 2)
  
## End(Not run)
  
</code></pre>

<hr>
<h2 id='colorgram'> Draw a colorgram (heatmap) of a matrix </h2><span id='topic+colorgram'></span>

<h3>Description</h3>

<p>Plot a visual representation of a numeric matrix using colors to indicate values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colorgram(x = NULL, y = NULL, z = NULL, zsize = 1, 
          map, nz = 10, breaks = pretty, symm = FALSE, base = NA, colFn = jet,
          key = hkey, key.args = list(), 
          xlab = NULL, ylab = NULL, zlab = NULL, 
          outlier = NULL, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="colorgram_+3A_x">x</code>, <code id="colorgram_+3A_y">y</code></td>
<td>
<p> Locations of grid lines at which the values in z are measured. 
These must be finite, non-missing and in (strictly) ascending order.  (see Details below)</p>
</td></tr>
<tr><td><code id="colorgram_+3A_z">z</code></td>
<td>
<p> A numeric matrix containing the values to be visualized as colors (NAs are allowed). Note that x can be used instead of z for convenience. </p>
</td></tr>
<tr><td><code id="colorgram_+3A_zsize">zsize</code></td>
<td>
<p> A numeric matrix specifying the relative size of each rectangle. </p>
</td></tr>
<tr><td><code id="colorgram_+3A_map">map</code></td>
<td>
<p> A list, as generated by <code><a href="#topic+makecmap">makecmap</a></code>.  If missing, a color map is generated automatically. </p>
</td></tr>
<tr><td><code id="colorgram_+3A_nz">nz</code>, <code id="colorgram_+3A_breaks">breaks</code>, <code id="colorgram_+3A_symm">symm</code>, <code id="colorgram_+3A_base">base</code>, <code id="colorgram_+3A_colfn">colFn</code></td>
<td>
<p> Arguments passed to <code><a href="#topic+makecmap">makecmap</a></code>, if <code>map</code> is missing. </p>
</td></tr>
<tr><td><code id="colorgram_+3A_key">key</code></td>
<td>
<p> A function to draw a color key, such as <code><a href="#topic+hkey">hkey</a></code> or <code><a href="#topic+vkey">vkey</a></code>. </p>
</td></tr>
<tr><td><code id="colorgram_+3A_key.args">key.args</code></td>
<td>
<p> Arguments passed to the function given by <code>key</code>.   </p>
</td></tr>
<tr><td><code id="colorgram_+3A_xlab">xlab</code>, <code id="colorgram_+3A_ylab">ylab</code></td>
<td>
<p> Labels for axes. </p>
</td></tr>
<tr><td><code id="colorgram_+3A_zlab">zlab</code></td>
<td>
<p> Label (title) for the color key. </p>
</td></tr>
<tr><td><code id="colorgram_+3A_outlier">outlier</code></td>
<td>
<p> Color for values outside the <code>map</code> domain.  
If NULL, values falling outside the map domain will generate an error. </p>
</td></tr>
<tr><td><code id="colorgram_+3A_...">...</code></td>
<td>
<p> Further arguments passed to <code><a href="#topic+cimage">cimage</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function assigns colors to the elements of a matrix and plots it using <code><a href="#topic+cimage">cimage</a></code>.  
</p>
<p>Data can be passed to this function in any format recognized by <code><a href="#topic+xyzmat.coords">xyzmat.coords</a></code>.
</p>
<p><code>colorgram</code> is somewhat similar to <code><a href="graphics.html#topic+image">image</a></code>.  However, <code>colorgram</code> adds the following functionality:  1. The value-to-color mapping can be specified (thus allowing unequal bin sizes).  2. A color key can be added, optionally.  3. A color can be specified for missing values.  4. The size of each grid rectangle can be adjusted to convey additional information.
</p>
<p>Two color key functions are provided in the squash package: 1) <code><a href="#topic+hkey">hkey</a></code> draws a horizontal key, in the lower-left corner by default. 2) <code><a href="#topic+vkey">vkey</a></code>) draws a vertical key, in the lower-right corner by default. The latter usually looks better if the right-hand margin is increased. These keys can be controlled somewhat using <code>key.args</code>.  However, that <code>title</code> and <code>map</code> cannot be specified in <code>key.args</code>; use the <code>zlab</code> and <code>map</code> arguments instead.
</p>


<h3>Value</h3>

<p>Invisibly, <code>map</code>.
</p>


<h3>See Also</h3>

  
<p>If this is not quite what you are looking for, consider <code><a href="graphics.html#topic+image">image</a></code>, <code><a href="graphics.html#topic+filled.contour">filled.contour</a></code>, or <code><a href="lattice.html#topic+levelplot">levelplot</a></code>.  Also <code>color2D.matplot</code> in the <span class="pkg">plotrix</span> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  ## median Petal.Length as function of Sepal.Length and Sepal.Width
  pl &lt;- matapply( iris[,1:3], FUN = median, nx = 20, ny = 15 )

  ## Draw a colorgram with the default horizontal color key  
  colorgram(pl, main = 'iris')

  ## ... or with the vertical color key  
  colorgram(pl, main = 'iris', key = vkey)

  ## ... add margin space to improve legibility 
  op &lt;- par(mar = c(5,4,4,4)+0.1)
  colorgram(pl, main = 'iris', key = vkey, 
    key.args = list(skip = 2), zlab = 'Petal\nlength')
  par(op)
  
  ##  Here is the example from the base function "persp"
  x &lt;- seq(-10, 10, length= 30)
  y &lt;- x
  f &lt;- function(x,y) { r &lt;- sqrt(x^2+y^2); 10 * sin(r)/(r) }
  z &lt;- outer(x, y, f)
  colorgram(x, y, z)

  ## ... and with a slight fix to the key:
  colorgram(x, y, z, key.args = list(wh = c(1, 4, 14)))

  ## We could also make more space for the key:
  op &lt;- par(mar = c(7,4,4,2)+0.1)
  colorgram(x, y, z, key.args = list(stretch = 3))
  par(op)
  
  ## Here are some alternatives to colorgram  
  persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue")
  image(x, y, z)  
  contour(x, y, z)

  ## Use 'xlabels' and 'ylabels' to create categorical axes
  colorgram(t(mtcars[,c(2,8:11)]), colFn = heat, 
    xlabels = TRUE, ylabels = TRUE, 
    xlab = NA, ylab = NA, zlab = 'Value', 
    main = 'Motor car specifications', las = 1)
  
</code></pre>

<hr>
<h2 id='ColorPalettes'> Bonus color palettes </h2><span id='topic+greyscale'></span><span id='topic+grayscale'></span><span id='topic+rainbow2'></span><span id='topic+blueorange'></span><span id='topic+bluered'></span><span id='topic+jet'></span><span id='topic+heat'></span><span id='topic+coolheat'></span><span id='topic+darkbluered'></span>

<h3>Description</h3>

<p>Generate a vector of contiguous colors of a specified length.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rainbow2(n)
jet(n)
heat(n)
coolheat(n)
blueorange(n)
bluered(n)
darkbluered(n)
greyscale(n, start = 0.9, end = 0)
grayscale(n, start = 0.9, end = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ColorPalettes_+3A_n">n</code></td>
<td>
<p> Number of colors to return. </p>
</td></tr>
<tr><td><code id="ColorPalettes_+3A_start">start</code>, <code id="ColorPalettes_+3A_end">end</code></td>
<td>
<p> Levels of gray (1 = white, 0 = black). </p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>rainbow2</code> is a variation of <code><a href="grDevices.html#topic+rainbow">rainbow</a></code>, in which the colors do not cycle completely around. Thus, <code>rainbow2</code> may be less ambiguous as a color scale.  
</p>
<p><code>jet</code> is similar to the Matlab color scheme of the same name and is taken from an example in <code><a href="grDevices.html#topic+colorRamp">colorRamp</a></code>.
</p>
<p><code>heat</code> is similar to <code><a href="grDevices.html#topic+heat.colors">heat.colors</a></code>, but starts at black rather than red.
</p>
<p><code>coolheat</code> is the diverging version of <code>heat</code>, running from cyan to black to yellow.
</p>
<p><code>blueorange</code> and <code>bluered</code> range from blue to grey to orange (or red), and are intended to be used as diverging color scales.  
</p>
<p><code>darkbluered</code> ranges from dark blue to grey to dark red, and is intended to be used as a diverging color scale that emphasizes the magnitude more than the sign.
</p>
<p><code>greyscale</code> or <code>grayscale</code> ranges from off-white to black.
</p>


<h3>Value</h3>

<p>A vector of RGB colors.
</p>


<h3>See Also</h3>

 
<p>Standard R palettes such as <code><a href="grDevices.html#topic+rainbow">rainbow</a></code>.
</p>
<p>Custom palettes can be generated with <code><a href="grDevices.html#topic+colorRamp">colorRamp</a></code>.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Present the squash palettes along with the built-in R palettes
squash.palettes &lt;- c('rainbow2', 'jet', 'grayscale', 'heat', 
                     'coolheat', 'blueorange', 'bluered', 'darkbluered')
R.palettes &lt;- c('rainbow', 'heat.colors', 'terrain.colors', 'topo.colors', 'cm.colors')

plot(0:8, type = 'n', ann = FALSE, axes = FALSE)
for (i in 1:5) {
  p &lt;- R.palettes[i]
  hkey(makecmap(c(0, 9), colFn = get(p)), 
    title = p, x = 2, y = i - 1)
}
for (i in 1:8) {
  p &lt;- squash.palettes[i]
  hkey(makecmap(c(0, 9), colFn = get(p)), 
    title = p, x = 6, y = i - 1)
}
text(3, 8, 'R palettes', font = 2)
text(7, 8, 'squash palettes', font = 2)

</code></pre>

<hr>
<h2 id='corrogram'> Draw a color-coded triangular matrix of pairwise correlations </h2><span id='topic+corrogram'></span>

<h3>Description</h3>

<p> This figure is a color-coded, rotated triangular matrix indicating the correlation between every pair of items. </p>


<h3>Usage</h3>

<pre><code class='language-R'>corrogram(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corrogram_+3A_...">...</code></td>
<td>
<p> Arguments passed to <code><a href="#topic+distogram">distogram</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>This is a simple wrapper around <code><a href="#topic+distogram">distogram</a></code>, with the color scale set by default to use <code><a href="#topic+blueorange">blueorange</a></code> with a range from -1 to +1. 
</p>


<h3>Value</h3>

 
<p>A color map (as generated by <code><a href="#topic+makecmap">makecmap</a></code>), invisibly. 
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+distogram">distogram</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'> 
  
  corrogram(cor(swiss), title = 'Pearson correlation')
</code></pre>

<hr>
<h2 id='dendromat'> Plot a dendrogram with a colorgram underneath </h2><span id='topic+dendromat'></span>

<h3>Description</h3>

 
<p>Plot a dendrogram with a colorgram underneath.  The colorgram typically indicates characteristics about each element in the dendrogram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dendromat(x, mat, 
         labRow = rownames(mat), labCol = colnames(mat),
         height = NA, gap = 0, matlabside = 2, border = NA, 
         cex.lab = par('cex.axis'), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dendromat_+3A_x">x</code></td>
<td>
<p> An object of type <code><a href="stats.html#topic+hclust">hclust</a></code> or <code><a href="stats.html#topic+dendrogram">dendrogram</a></code>. </p>
</td></tr>
<tr><td><code id="dendromat_+3A_mat">mat</code></td>
<td>
<p> A matrix or data frame of colors, with each row corresponding to an item in the dendrogram. </p>
</td></tr>
<tr><td><code id="dendromat_+3A_labrow">labRow</code></td>
<td>
<p> Labels of items, to be placed underneath the matrix. </p>
</td></tr>
<tr><td><code id="dendromat_+3A_labcol">labCol</code></td>
<td>
<p> Labels for characteristics, to be placed next to the matrix. </p>
</td></tr>
<tr><td><code id="dendromat_+3A_height">height</code></td>
<td>
<p> Fraction of the plot area to reserve for the color matrix.  If NA, the spacing is set automatically. </p>
</td></tr>
<tr><td><code id="dendromat_+3A_gap">gap</code></td>
<td>
<p> Extra space (in lines) to add between the dendrogram and the matrix. </p>
</td></tr>
<tr><td><code id="dendromat_+3A_matlabside">matlabside</code></td>
<td>
<p> Which side of the matrix to put <code>labCol</code> (2 or 4). </p>
</td></tr>
<tr><td><code id="dendromat_+3A_border">border</code></td>
<td>
<p> Border color for the color matrix. </p>
</td></tr>
<tr><td><code id="dendromat_+3A_cex.lab">cex.lab</code></td>
<td>
<p> Relative text size for the item labels. </p>
</td></tr>
<tr><td><code id="dendromat_+3A_...">...</code></td>
<td>
<p> Further arguments passed to <code><a href="stats.html#topic+plot.dendrogram">plot.dendrogram</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>The order of <code>labRow</code> and the rows of <code>mat</code> should correspond to the input to <code><a href="stats.html#topic+hclust">hclust</a></code> (or whatever function created <code>x</code>).  This function reorders <code>mat</code> and <code>labRow</code> to match the dendrogram, using <code><a href="stats.html#topic+order.dendrogram">order.dendrogram</a></code>.
</p>
<p>This function combines two plots using <code><a href="graphics.html#topic+layout">layout</a></code>; therefore it is incompatible with other multiple-plot schemes (e.g. <code>par(mfrow)</code>).  
</p>
<p>If <code>height == NA</code> (the default), the function tries to leave enough room for the item labels at the bottom, and enough room for the color matrix in the middle.  The leftover plotting area on the top is used for the dendrogram. The lower margin setting (see <code><a href="graphics.html#topic+par">par</a></code>) is ignored.
</p>
<p>If <code>labRow</code> is set to <code>NULL</code>, or is equal to <code>NULL</code> because <code>mat</code> lacks rownames, then the item labels are taken from <code>x</code> instead.
</p>


<h3>Value</h3>

<p> none. </p>


<h3>Note</h3>

 
<p>Currently, horizontal dendrograms are not supported.
</p>
<p>After <code>dendromat</code> is finished, the user coordinates are set to <code>c(0,1,0,1)</code>.
</p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+heatmap">heatmap</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'> 

## Motor Trend car road test data
mt.dend &lt;- hclust(dist(mtcars[,1:7]))
mt.mat &lt;- mtcars[,8:11]

## A minimal dendromat
dendromat(mt.dend, mt.mat)

## The same plot, but with a few enhancements
names(mt.mat) &lt;- c('Straight', 'Manual', '# gears', '# carbs')
dendromat(mt.dend, mt.mat, gap = 0.5, border = 'gray', las = 2, 
  ylab = 'Euclidean distance', 
  main = 'mtcars, clustered by performance')
legend('topright', legend = 0:8, fill = 0:8)

## US state data, with color keys
us.dend &lt;- hclust(dist(scale(state.x77)))

income &lt;- state.x77[, 'Income']
frost &lt;- state.x77[, 'Frost']
murder &lt;- state.x77[, 'Murder']

income.cmap &lt;- makecmap(income, n = 5, colFn = colorRampPalette(c('black', 'green')))
frost.cmap &lt;- makecmap(frost, n = 5, colFn = colorRampPalette(c('black', 'blue')))
murder.cmap &lt;- makecmap(murder, n = 5, colFn = colorRampPalette(c('black', 'red')))

us.mat &lt;- data.frame(Frost = cmap(frost, frost.cmap),
                     Murder = cmap(murder, murder.cmap),
                     Income = cmap(income, income.cmap))

par(mar = c(5,4,4,3)+0.1)
dendromat(us.dend, us.mat,
  ylab = 'Distance', main = 'US states')

vkey(frost.cmap, 'Frost')
vkey(murder.cmap, 'Murder', y = 0.3)
vkey(income.cmap, 'Income', y = 0.7)

</code></pre>

<hr>
<h2 id='diamond'> Draw diamonds </h2><span id='topic+diamond'></span>

<h3>Description</h3>

<p> Draw diamonds on the graphics device. </p>


<h3>Usage</h3>

<pre><code class='language-R'>diamond(x, y = NULL, radius, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diamond_+3A_x">x</code>, <code id="diamond_+3A_y">y</code></td>
<td>
<p> Position(s) of the centers of the diamonds. </p>
</td></tr>
<tr><td><code id="diamond_+3A_radius">radius</code></td>
<td>
<p> Distances from the center to the vertex. </p>
</td></tr>
<tr><td><code id="diamond_+3A_...">...</code></td>
<td>
<p> Further arguments passed to <code><a href="graphics.html#topic+polygon">polygon</a></code> (e.g. <code>col</code>, <code>border</code>). </p>
</td></tr>
</table>


<h3>Details</h3>

  
<p><code>x</code> and <code>y</code> can be passed to <code>diamond</code> in any form recognized by <code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code> (e.g. individual vectors, list, data frame, formula). 
</p>
<p>Only &ldquo;square&rdquo; (equilateral) diamonds are implemented here.  </p>


<h3>See Also</h3>

 <p><code><a href="graphics.html#topic+rect">rect</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'> 
  plot(1:10)
  diamond(1:10, rep(3, 10), radius = 0.4)
  diamond(3, 8, 1, border = 3)  
  diamond(1:10, rep(5, 10), radius = seq(0.1, 1, length = 10), col = 1:10)
</code></pre>

<hr>
<h2 id='distogram'> Draw a color-coded triangular distance matrix </h2><span id='topic+distogram'></span>

<h3>Description</h3>

<p> This function draws a color-coded, rotated triangular matrix indicating the &quot;distance&quot; between every pair of items. </p>


<h3>Usage</h3>

<pre><code class='language-R'>distogram(x, map, 
  n = 10, base = NA, colFn = heat, 
  key = TRUE,  title = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distogram_+3A_x">x</code></td>
<td>
<p> A <code><a href="stats.html#topic+dist">dist</a></code> object, or a square numeric matrix. </p>
</td></tr>
<tr><td><code id="distogram_+3A_map">map</code></td>
<td>
<p> A color map, as generated by <code><a href="#topic+makecmap">makecmap</a></code> (optional). </p>
</td></tr>
<tr><td><code id="distogram_+3A_n">n</code>, <code id="distogram_+3A_base">base</code>, <code id="distogram_+3A_colfn">colFn</code></td>
<td>
<p> Arguments passed to <code><a href="#topic+makecmap">makecmap</a></code>, if <code>map</code> is omitted. </p>
</td></tr>
<tr><td><code id="distogram_+3A_key">key</code></td>
<td>
<p> Add a color key? </p>
</td></tr>
<tr><td><code id="distogram_+3A_title">title</code></td>
<td>
<p> Title for the color key. </p>
</td></tr>
<tr><td><code id="distogram_+3A_...">...</code></td>
<td>
<p> Further arguments passed to <code><a href="#topic+trianglegram">trianglegram</a></code>, (e.g. <code>labels</code>). </p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>If the input <code>x</code> is a matrix, the lower triangle is extracted by default (but see the arguments for <code><a href="#topic+trianglegram">trianglegram</a></code>).
</p>


<h3>Value</h3>

<p> The color map, invisibly. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+corrogram">corrogram</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'> 
  ## Distances between European cities
  distogram(eurodist, title = 'Distance (km)')  

  ## Some variations
  map &lt;- distogram(eurodist, key = FALSE, colFn = jet, right = TRUE)  
  vkey(map, title = 'Distance (km)', x = -8)

</code></pre>

<hr>
<h2 id='hist2'> Bivariate histogram </h2><span id='topic+hist2'></span>

<h3>Description</h3>

<p>Calculate data for a bivariate histogram and (optionally) plot it as a colorgram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hist2(x, y = NULL, 
      nx = 50, ny = nx,  
      xlim = NULL, ylim = NULL, 
      xbreaks = NULL, ybreaks = NULL,
      plot = TRUE, 
      xlab = NULL, ylab = NULL, zlab = "Counts", 
      colFn = heat, breaks = prettyInt, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hist2_+3A_x">x</code>, <code id="hist2_+3A_y">y</code></td>
<td>
<p> Numeric vectors. </p>
</td></tr>
<tr><td><code id="hist2_+3A_nx">nx</code>, <code id="hist2_+3A_ny">ny</code></td>
<td>
<p> Approximate number of intervals along x and y axes. </p>
</td></tr>
<tr><td><code id="hist2_+3A_xlim">xlim</code>, <code id="hist2_+3A_ylim">ylim</code></td>
<td>
<p> Limit the range of data points considered. </p>
</td></tr>
<tr><td><code id="hist2_+3A_xbreaks">xbreaks</code>, <code id="hist2_+3A_ybreaks">ybreaks</code></td>
<td>
<p> Breakpoints between bins along x and y axes. </p>
</td></tr>
<tr><td><code id="hist2_+3A_plot">plot</code></td>
<td>
<p> Plot the histogram? </p>
</td></tr>
<tr><td><code id="hist2_+3A_xlab">xlab</code>, <code id="hist2_+3A_ylab">ylab</code></td>
<td>
<p> Axis labels. </p>
</td></tr>
<tr><td><code id="hist2_+3A_zlab">zlab</code></td>
<td>
<p> Label for the color key. </p>
</td></tr>
<tr><td><code id="hist2_+3A_colfn">colFn</code>, <code id="hist2_+3A_breaks">breaks</code></td>
<td>
<p> Color key parameters; see <code><a href="#topic+makecmap">makecmap</a></code>. </p>
</td></tr>
<tr><td><code id="hist2_+3A_...">...</code></td>
<td>
<p> Further arguments passed to <code><a href="#topic+colorgram">colorgram</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data can be passed to <code>hist2</code> in any form recognized by <code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code> (e.g. individual vectors, list, data frame, formula). 
</p>


<h3>Value</h3>

<p>Invisibly, a list with components:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>Vector of breakpoints along the x-axis.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Vector of breakpoints along the y-axis.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Matrix of counts.</p>
</td></tr>
<tr><td><code>xlab</code></td>
<td>
<p>A label for the x-axis.</p>
</td></tr>
<tr><td><code>ylab</code></td>
<td>
<p>A label for the y-axis.</p>
</td></tr>
<tr><td><code>zlab</code></td>
<td>
<p>A label for the color key.</p>
</td></tr>
</table>


<h3>See Also</h3>

 
<p><code><a href="graphics.html#topic+hist">hist</a></code>, for a standard (univariate) histogram.
</p>
<p><code>hist2d</code> in the <span class="pkg">gplots</span> package for another implementation. 
</p>
<p>The <span class="pkg">hexbin</span> package, for a hexagonal implementation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  set.seed(123)
  x &lt;- rnorm(10000)
  y &lt;- rnorm(10000) + x
  hist2(x, y)
  
  ## pseudo-log-scale color breaks:
  hist2(x, y, breaks = prettyLog, key.args = list(stretch = 4))

  ## log-scale color breaks; the old way using 'base'
  ## (notice box removal to make space for the vertical color key)
  hist2(x, y, base = 2, key = vkey, nz = 5, bty = 'l')

</code></pre>

<hr>
<h2 id='hkey'> Add a color key to a plot </h2><span id='topic+hkey'></span><span id='topic+vkey'></span>

<h3>Description</h3>

<p> Add a horizontal or vertical color key to a plot </p>


<h3>Usage</h3>

<pre><code class='language-R'>hkey(map, title = NA, side = 1, stretch = 1.4, x, y, skip, wh)
vkey(map, title = NA, side = 2, stretch = 1.4, x, y, skip, wh)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hkey_+3A_map">map</code></td>
<td>
<p> A list, as generated by <code><a href="#topic+makecmap">makecmap</a></code>. </p>
</td></tr>
<tr><td><code id="hkey_+3A_title">title</code></td>
<td>
<p> Title for the key. </p>
</td></tr>
<tr><td><code id="hkey_+3A_side">side</code></td>
<td>
<p> Where to place the labels. (1 or 3 for <code>hkey</code>, 2 or 4 for <code>vkey</code>)  </p>
</td></tr>
<tr><td><code id="hkey_+3A_stretch">stretch</code></td>
<td>
<p> Aspect ratio of the color rectangles. </p>
</td></tr>
<tr><td><code id="hkey_+3A_x">x</code>, <code id="hkey_+3A_y">y</code></td>
<td>
<p> Position of lower left corner of the color rectangles.  If missing, the key will be placed automatically in the lower-left (<code>hkey</code>) or lower-right (<code>vkey</code>) corner of the figure region.</p>
</td></tr>
<tr><td><code id="hkey_+3A_skip">skip</code></td>
<td>
<p> Omit every <code>skip</code> labels (optional). </p>
</td></tr>
<tr><td><code id="hkey_+3A_wh">wh</code></td>
<td>
<p> Integer indices indicating which labels to include (optional). </p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>This functions tries to label as many breakpoints as possible, but if the labels would overlap a subset of labels is chosen automatically. If this doesn't look right, the subset of labels can be specified with either <code>skip</code> or <code>wh</code>.
</p>
<p>Clipping is turned off, so the key can be placed
anywhere in the figure region, including the margins.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 

  attach(iris)
  map &lt;- makecmap(Petal.Length)
  pl.color &lt;- cmap(Petal.Length, map = map)

  plot(Sepal.Length, Sepal.Width, col = pl.color, pch = 16)
  hkey(map, title = 'Petal length (hkey default)')
  hkey(map, title = 'Another hkey', x = 3.8, y = 4.7, stretch = 3)

  ## looks bad with default margins
  vkey(map, title = 'vkey default')

  vkey(map, title = 'Small vkey', x = 7.8, y = 4, stretch = 0.3)

</code></pre>

<hr>
<h2 id='makecmap'> 
Generate a color map from numeric values to colors
</h2><span id='topic+makecmap'></span>

<h3>Description</h3>

<p>Generate a color map from numeric values to a contiguous set of colors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makecmap(x, n = 10, breaks = pretty, 
  symm = FALSE, base = NA, 
  colFn = jet, col.na = NA, 
  right = FALSE, include.lowest = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makecmap_+3A_x">x</code></td>
<td>
<p> A vector of numbers (only the finite range is used). </p>
</td></tr>
<tr><td><code id="makecmap_+3A_n">n</code></td>
<td>
<p> Approximate number of color levels desired. </p>
</td></tr>
<tr><td><code id="makecmap_+3A_breaks">breaks</code></td>
<td>
<p> A function to generate breakpoints, or the breakpoints themselves. </p>
</td></tr>
<tr><td><code id="makecmap_+3A_symm">symm</code></td>
<td>
<p> Extend the mapping domain to be symmetric around zero? </p>
</td></tr>
<tr><td><code id="makecmap_+3A_base">base</code></td>
<td>
<p> Base for log scale, or NA to use a linear scale. </p>
</td></tr>
<tr><td><code id="makecmap_+3A_colfn">colFn</code></td>
<td>
<p> A function that generates contiguous colors. </p>
</td></tr>
<tr><td><code id="makecmap_+3A_col.na">col.na</code></td>
<td>
<p> Color to use for missing values. </p>
</td></tr>
<tr><td><code id="makecmap_+3A_right">right</code></td>
<td>
<p> Logical; if TRUE, the intervals will be closed on the right (and open on the left). </p>
</td></tr>
<tr><td><code id="makecmap_+3A_include.lowest">include.lowest</code></td>
<td>
<p> Logical, indicating if an <code>x[i]</code> equal to the lowest (or highest, for right = FALSE) <code>breaks</code> value should be included. </p>
</td></tr>
<tr><td><code id="makecmap_+3A_...">...</code></td>
<td>
<p> Further arguments to <code>breaks</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The general point of this function is to automatically generate a mapping that can be used in combination with <code><a href="#topic+cmap">cmap</a></code> to represent numeric data with colors in a consistent way.
</p>
<p><code>colFn</code> should be a function that returns a vector of colors of specified length, such as <code><a href="grDevices.html#topic+rainbow">rainbow</a></code>, <code><a href="#topic+greyscale">greyscale</a></code>.  Custom functions of this type can be generated with <code><a href="grDevices.html#topic+colorRampPalette">colorRampPalette</a></code>.
</p>
<p>The breakpoints can be specified explicitly by setting <code>breaks</code> to a vector of numbers, in which case <code>x</code> is ignored. Otherwise, the breakpoints are chosen to be nice, relatively round values (using <code><a href="base.html#topic+pretty">pretty</a></code>, or another function passed to <code>breaks</code>) covering the finite range of <code>x</code>.  
</p>
<p>If <code>symm</code> is TRUE, the map domain is extended such that it is symmetric around zero. This can be useful when using divergent color palettes to ensure that the zero point is a neutral color.
</p>
<p>If <code>base</code> is specified, the breakpoints are generated using log-transformed data. However, setting <code>breaks = prettyLog</code> might be preferable.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>breaks</code></td>
<td>
<p> Breakpoints (numeric vector).</p>
</td></tr>
<tr><td><code>colors</code></td>
<td>
<p> Colors (character or numeric vector). </p>
</td></tr>
<tr><td><code>base</code></td>
<td>
<p> (as supplied in arguments) </p>
</td></tr>
<tr><td><code>col.na</code></td>
<td>
<p> (as supplied in arguments) </p>
</td></tr>
<tr><td><code>right</code></td>
<td>
<p> (as supplied in arguments) </p>
</td></tr>
<tr><td><code>include.lowest</code></td>
<td>
<p> (as supplied in arguments) </p>
</td></tr>
</table>


<h3>See Also</h3>

 
<p><code><a href="#topic+cmap">cmap</a></code> and <code><a href="#topic+colorgram">colorgram</a></code> use the mappings generated by this function. 
</p>
<p><code><a href="#topic+hkey">hkey</a></code> plots a color key.
</p>
<p>Consider setting <code>breaks = <a href="#topic+prettyInt">prettyInt</a></code> or <code>breaks = <a href="#topic+prettyLog">prettyLog</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  attach(iris)
  map1 &lt;- makecmap(Petal.Length)
  myColors &lt;- cmap(Petal.Length, map = map1)
  plot(Sepal.Length, Sepal.Width, col = myColors, pch = 16)
  hkey(map1, title = 'Petal.Length')

  ## Compare the 'breaks' element in the following:
  x &lt;- rnorm(100) * 1000
  str(makecmap(x))
  str(makecmap(x, breaks = c(-Inf, -1000, 0, 1000, Inf)))
  str(makecmap(x, breaks = prettyLog))


</code></pre>

<hr>
<h2 id='matapply'> Apply a function over z coordinates, binned by their x, y coordinates</h2><span id='topic+matapply'></span>

<h3>Description</h3>

<p>Divide the range of x and y into intervals, thus forming a matrix of bins, and apply an arbitrary function to the z values corresponding to each bin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matapply(x, y = NULL, z = NULL, FUN,  
         nx = 50, ny = nx, 
         xlim = NULL, ylim = NULL, 
         xbreaks = NULL, ybreaks = NULL, 
         right = FALSE, include.lowest = TRUE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matapply_+3A_x">x</code>, <code id="matapply_+3A_y">y</code>, <code id="matapply_+3A_z">z</code></td>
<td>
<p> Numeric vectors, or possibly a matrix. </p>
</td></tr>
<tr><td><code id="matapply_+3A_fun">FUN</code></td>
<td>
<p> Function to summarize z values. </p>
</td></tr>
<tr><td><code id="matapply_+3A_nx">nx</code>, <code id="matapply_+3A_ny">ny</code></td>
<td>
<p> Approximate number of bins along x and y axis. </p>
</td></tr>
<tr><td><code id="matapply_+3A_xlim">xlim</code>, <code id="matapply_+3A_ylim">ylim</code></td>
<td>
<p> Limit the range of data points considered.</p>
</td></tr>
<tr><td><code id="matapply_+3A_xbreaks">xbreaks</code>, <code id="matapply_+3A_ybreaks">ybreaks</code></td>
<td>
<p> Breakpoints between bins along x and y axes. </p>
</td></tr>
<tr><td><code id="matapply_+3A_right">right</code></td>
<td>
<p> Logical; if TRUE, the intervals will be closed on the right (and open on the left). </p>
</td></tr>
<tr><td><code id="matapply_+3A_include.lowest">include.lowest</code></td>
<td>
<p> Logical, indicating if an <code>x[i]</code> equal to the lowest (or highest, for right = FALSE) <code>breaks</code> value should be included. </p>
</td></tr> 
<tr><td><code id="matapply_+3A_...">...</code></td>
<td>
<p> Further arguments to <code>FUN</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>x</code>, <code>y</code> and <code>z</code> values can be passed to <code>squash</code> in any form recognized by <code><a href="grDevices.html#topic+xyz.coords">xyz.coords</a></code> (e.g. individual vectors, list, data frame, formula).
</p>
<p>Alternatively, data that is already in a matrix can be passed in any format recognized by <code><a href="#topic+xyzmat.coords">xyzmat.coords</a></code>.
</p>
<p><code>FUN</code> should accept a numeric vector and return a single numeric value (e.g. <code>mean</code>, <code>median</code>, <code>min</code>, <code>max</code>, <code>sd</code>).
</p>
<p>If <code>xbreaks</code> is not specified, approximately <code>nx</code> breakpoints will be generated automatically to span the data; likewise for <code>ybreaks</code> and <code>ny</code>.
</p>
<p>The output can be visualized with <code><a href="#topic+colorgram">colorgram</a></code>, <code><a href="graphics.html#topic+image">image</a></code>, etc.
</p>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>Vector of breakpoints along the x-axis.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Vector of breakpoints along the y-axis.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Matrix of values representing the summary for each bin.</p>
</td></tr>
<tr><td><code>xlab</code></td>
<td>
<p>A label for the x-axis.</p>
</td></tr>
<tr><td><code>ylab</code></td>
<td>
<p>A label for the y-axis.</p>
</td></tr>
<tr><td><code>zlab</code></td>
<td>
<p>A label for the z-axis.</p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>The defaults of <code>right</code> and <code>include.lowest</code> are opposite the defaults used in <code><a href="base.html#topic+cut">cut</a></code>.
</p>


<h3>See Also</h3>

  
<p>This function is essentially a souped-up version of <code><a href="base.html#topic+tapply">tapply</a></code>.
</p>
<p><code><a href="#topic+squashgram">squashgram</a></code> has similar functionality but with graphical output.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## earthquake depths as a function of longitude, latitude
  attach(quakes)
  quakedepth &lt;- matapply(depth ~ long + lat, FUN = mean)
  colorgram(quakedepth)

  ## iris petal length vs. sepal length and width
  ipl &lt;- matapply(iris[,1:3], FUN = median, nx = 20, ny = 15 )
  colorgram(ipl, main = 'iris')
    
  ## Example of matrix input; here used to downsample an image 
  colorgram(volcano, colFn = terrain.colors)
  volcano2 &lt;- matapply(volcano, FUN = mean, nx = 20)
  colorgram(volcano2, colFn = terrain.colors)
  
</code></pre>

<hr>
<h2 id='prettyInt'> Pretty breakpoints </h2><span id='topic+prettyInt'></span><span id='topic+prettyLog'></span>

<h3>Description</h3>

<p> Compute a sequence of around <code>n</code> values covering the range of <code>x</code>. 
These functions are variations of the standard R function <code><a href="base.html#topic+pretty">pretty</a></code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'>prettyInt(x, n = 5, ...)
prettyLog(x, n = 5, small = NA, logrange = c(-100, 100))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prettyInt_+3A_x">x</code></td>
<td>
<p> Numeric vector. </p>
</td></tr>
<tr><td><code id="prettyInt_+3A_n">n</code></td>
<td>
<p> Approximate number of values to return. </p>
</td></tr>
<tr><td><code id="prettyInt_+3A_small">small</code></td>
<td>
<p> Value below which distinction from zero is unimportant. </p>
</td></tr>
<tr><td><code id="prettyInt_+3A_logrange">logrange</code></td>
<td>
<p> Log (base 10) of the range of values to consider as possible breakpoints. </p>
</td></tr>
<tr><td><code id="prettyInt_+3A_...">...</code></td>
<td>
<p> Further arguments passed to <code><a href="base.html#topic+pretty">pretty</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

 
<p><code>prettyInt</code> returns integer values, even if this forces the number of values returned to be much lower than the requested number <code>n</code>. However, at least two values will be returned.
</p>
<p><code>prettyLog</code> returns values that are approximately evenly spaced on a log scale, such as (1, 3, 10, 30, ...) or (1, 2, 5, 10, 20, 50, ...) or (1, 10, 100, ...).  
Negative or zero values in <code>x</code> are accomodated by series such as (-100, -10, -1, 0, 1, 10, 100, ...). Setting the parameter <code>small</code> to a non-<code>NA</code> value will ignore <code>x</code> with absolute values below <code>small</code>. 
</p>


<h3>Value</h3>

<p> A numeric vector. </p>


<h3>See Also</h3>

 <p><code><a href="base.html#topic+pretty">pretty</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'> 
##
x1 &lt;- 1:3
pretty(x1)
prettyInt(x1)
prettyLog(x1)

## 
x2 &lt;- pi ^ (1:8)
range(x2)
pretty(x2)
prettyLog(x2)
prettyLog(x2, n = 10)

##
x3 &lt;- c(-x2, x2)
pretty(x3)
prettyLog(x3)
prettyLog(x3, small = 100)

</code></pre>

<hr>
<h2 id='savemat'>Save a matrix as a raster image file</h2><span id='topic+savemat'></span>

<h3>Description</h3>

<p>Save a matrix as a PNG, TIFF, BMP, JPEG, or PDF image file, such that each pixel corresponds to exactly one element
of the matrix.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>savemat(x, filename, map = NULL, outlier = NULL,
       dev = c('png', 'pdf', 'bmp', 'tiff', 'jpeg'), 
       do.dev.off = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="savemat_+3A_x">x</code></td>
<td>
<p> A matrix </p>
</td></tr>
<tr><td><code id="savemat_+3A_filename">filename</code></td>
<td>
<p> Filename </p>
</td></tr>
<tr><td><code id="savemat_+3A_map">map</code></td>
<td>
<p> (Optional) a list, as generated by <code><a href="#topic+makecmap">makecmap</a></code>. </p>
</td></tr>
<tr><td><code id="savemat_+3A_outlier">outlier</code></td>
<td>
<p> (Optional) A color for outliers, if <code>map</code> is specified. </p>
</td></tr>
<tr><td><code id="savemat_+3A_dev">dev</code></td>
<td>
<p> Which graphics device to use. </p>
</td></tr>
<tr><td><code id="savemat_+3A_...">...</code></td>
<td>
<p> Further arguments passed to the graphics device; see <code><a href="grDevices.html#topic+png">png</a></code> or <code><a href="grDevices.html#topic+pdf">pdf</a></code>. </p>
</td></tr>
<tr><td><code id="savemat_+3A_do.dev.off">do.dev.off</code></td>
<td>
<p> Close graphics device when finished? </p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>This function is a relatively simple wrapper around the usual graphics device with the same name as <code>dev</code>. The idea is to provide an easy way of creating an image file from a matrix, without axes, plotting frame, labels, etc.  
</p>
<p>For all choices of <code>dev</code> except <code>"pdf"</code>, the output image dimensions are set to match the matrix size, such that each pixel corresponds to an element of the matrix. 
</p>
<p>If <code>map</code> is <code>NULL</code> (the default), the matrix is interpreted as a matrix of colors.
</p>
<p>If <code>map</code> is specified, it is used to translate 
the numeric matrix <code>x</code> into a matrix of colors,
using <code><a href="#topic+cmap">cmap</a></code>.
</p>


<h3>Value</h3>

<p> None. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+cimage">cimage</a></code> for drawing a matrix on the screen. </p>


<h3>Examples</h3>

<pre><code class='language-R'>  
## Not run: 
  big.color.matrix &lt;- matrix(rep(colors()[1:625], 16), nrow = 100)
  
  ## save as a PNG
  savemat(big.color.matrix, file = 'test.png')


## End(Not run)
</code></pre>

<hr>
<h2 id='squashgram'> Visualize a function of z coordinates, binned by x, y coordinates</h2><span id='topic+squashgram'></span>

<h3>Description</h3>

<p>This is a convenience function combining <code>matapply</code> and <code>colorgram</code>. 3-dimensional data is summarized in 2-dimensional bins and represented as a color matrix. Optionally, the number of observations in each bin is indicated by relative size of the matrix elements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>squashgram(x, y = NULL, z = NULL, FUN, 
    nx = 50, ny = nx, xlim = NULL, ylim = NULL,
    xbreaks = NULL, ybreaks = NULL,
    xlab = NULL, ylab = NULL, zlab = NULL, 
    shrink = 0, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="squashgram_+3A_x">x</code>, <code id="squashgram_+3A_y">y</code>, <code id="squashgram_+3A_z">z</code></td>
<td>
<p> Numeric vectors; see Details. </p>
</td></tr>
<tr><td><code id="squashgram_+3A_fun">FUN</code></td>
<td>
<p> Function to summarize z values. </p>
</td></tr>
<tr><td><code id="squashgram_+3A_nx">nx</code>, <code id="squashgram_+3A_ny">ny</code></td>
<td>
<p> Approximate number of bins along x and y axis. </p>
</td></tr>
<tr><td><code id="squashgram_+3A_xlim">xlim</code>, <code id="squashgram_+3A_ylim">ylim</code></td>
<td>
<p> Limit the range of data points considered. </p>
</td></tr>
<tr><td><code id="squashgram_+3A_xbreaks">xbreaks</code>, <code id="squashgram_+3A_ybreaks">ybreaks</code></td>
<td>
<p> Breakpoints between bins along x and y axes. </p>
</td></tr>
<tr><td><code id="squashgram_+3A_xlab">xlab</code>, <code id="squashgram_+3A_ylab">ylab</code></td>
<td>
<p> Axis labels. </p>
</td></tr>
<tr><td><code id="squashgram_+3A_zlab">zlab</code></td>
<td>
<p> Label for color key. </p>
</td></tr>
<tr><td><code id="squashgram_+3A_shrink">shrink</code></td>
<td>
<p> Rectangle shrinkage cutoff. </p>
</td></tr>
<tr><td><code id="squashgram_+3A_...">...</code></td>
<td>
<p> Further arguments passed to <code><a href="#topic+colorgram">colorgram</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function may be useful for visualizing the dependence of a variable (<code>z</code>) on two other variables (<code>x</code> and <code>y</code>).
</p>
<p><code>x</code>, <code>y</code> and <code>z</code> values can be passed to <code>squash</code> in any form recognized by <code><a href="grDevices.html#topic+xyz.coords">xyz.coords</a></code> (e.g. individual vectors, list, data frame, formula).
</p>
<p>This function calls <code><a href="#topic+matapply">matapply</a></code> and plots the result along with a color key.
</p>
<p>If non-zero, the <code>shrink</code> parameter reduces the size of rectangles for 
the bins in which the number of samples is smaller than <code>shrink</code>. This may be useful to reduce the visual impact of less reliable observations.
</p>


<h3>Value</h3>

<p>None.
</p>


<h3>See Also</h3>

<p> The lower-level functions <code><a href="#topic+matapply">matapply</a></code> and <code><a href="#topic+colorgram">colorgram</a></code>. </p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## earthquake depths in Fiji
  attach(quakes)
  squashgram(depth ~ long + lat, FUN = mean)

  ## iris measurements 
  attach(iris)
  squashgram(Sepal.Length, Sepal.Width, Petal.Length, 
    FUN = median, nx = 20, ny = 15)

  ## Here indicate sample size by size of rectangles
  squashgram(iris[,1:3], FUN = median, 
    nx = 20, ny = 15, shrink = 5)

  ## What is the trend in my noisy 3-dimensional data?
  set.seed(123)
  x &lt;- rnorm(10000)
  y &lt;- rnorm(10000)
  z &lt;- rnorm(10000) + cos(x) + abs(y / 4)
  squashgram(x, y, z, median, colFn = bluered, shrink = 5)

</code></pre>

<hr>
<h2 id='trianglegram'> Draw a color-coded triangular matrix </h2><span id='topic+trianglegram'></span>

<h3>Description</h3>

<p> This function is called by <code><a href="#topic+distogram">distogram</a></code>, and probably isn't very useful by itself. </p>


<h3>Usage</h3>

<pre><code class='language-R'>trianglegram(x, labels = rownames(x), 
    lower = TRUE, diag = FALSE, right = FALSE, 
    add = FALSE, xpos = 0, ypos = 0, xlim, ylim, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trianglegram_+3A_x">x</code></td>
<td>
<p> A square matrix containing color values. </p>
</td></tr>
<tr><td><code id="trianglegram_+3A_labels">labels</code></td>
<td>
<p> Labels. </p>
</td></tr>
<tr><td><code id="trianglegram_+3A_lower">lower</code></td>
<td>
<p> If TRUE, use <code><a href="base.html#topic+lower.tri">lower.tri</a></code>, else use <code><a href="base.html#topic+upper.tri">upper.tri</a></code>. </p>
</td></tr>
<tr><td><code id="trianglegram_+3A_diag">diag</code></td>
<td>
<p> Include the diagonal elements of <code>x</code>? </p>
</td></tr>
<tr><td><code id="trianglegram_+3A_right">right</code></td>
<td>
<p> Should triangle point to the right or left? </p>
</td></tr>
<tr><td><code id="trianglegram_+3A_add">add</code></td>
<td>
<p> Add to an existing plot? </p>
</td></tr>
<tr><td><code id="trianglegram_+3A_xpos">xpos</code>, <code id="trianglegram_+3A_ypos">ypos</code></td>
<td>
<p> Location of bottom point of the triangle. </p>
</td></tr>
<tr><td><code id="trianglegram_+3A_xlim">xlim</code>, <code id="trianglegram_+3A_ylim">ylim</code></td>
<td>
<p> Plotting limits. </p>
</td></tr>
<tr><td><code id="trianglegram_+3A_...">...</code></td>
<td>
<p> Further arguments passed to <code><a href="graphics.html#topic+plot">plot</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>The input must be a (square) matrix; however, only part of the matrix (the upper or lower triangle) is displayed.
</p>


<h3>Value</h3>

<p> none. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+distogram">distogram</a></code>, <code><a href="#topic+corrogram">corrogram</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'> 
  m &lt;- matrix(jet(40), nrow = 20, ncol = 20)
  trianglegram(m)

  ## just for fun
  trianglegram(m, labels = NA, right = TRUE, add = TRUE, xpos = 1)
</code></pre>

<hr>
<h2 id='xyzmat.coords'>Extract (x, y, z) coordinates, where z is a matrix</h2><span id='topic+xyzmat.coords'></span>

<h3>Description</h3>

<p>Extract (x, y, z) plotting coordinates, where z is a matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xyzmat.coords(x = NULL, y = NULL, z = NULL, 
    xlab = NULL, ylab = NULL, zlab = NULL,
    xds = NULL, yds = NULL, zds = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xyzmat.coords_+3A_x">x</code>, <code id="xyzmat.coords_+3A_y">y</code></td>
<td>
<p> Numeric vectors. </p>
</td></tr>
<tr><td><code id="xyzmat.coords_+3A_z">z</code></td>
<td>
<p> A matrix </p>
</td></tr>
<tr><td><code id="xyzmat.coords_+3A_xlab">xlab</code>, <code id="xyzmat.coords_+3A_ylab">ylab</code>, <code id="xyzmat.coords_+3A_zlab">zlab</code></td>
<td>
<p> Labels </p>
</td></tr>
<tr><td><code id="xyzmat.coords_+3A_xds">xds</code>, <code id="xyzmat.coords_+3A_yds">yds</code>, <code id="xyzmat.coords_+3A_zds">zds</code></td>
<td>
<p> Results from <code>deparse(substitute(x))</code> (etc.); see below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is similar to <code><a href="grDevices.html#topic+xyz.coords">xyz.coords</a></code>, except that this function accepts a matrix for <code>z</code>.
</p>
<p>If <code>x</code> is the same length as <code>nrow(z)</code>, <code>x</code> will be taken as the points at which the <code>z</code> values were sampled.  If <code>x</code> is the length of <code>nrow(z) + 1</code>, <code>x</code> is taken as the breakpoints between bins. If <code>x</code> is missing, the matrix indices (<code>1:nrow(z)</code>) will be used.  Similarly for <code>y</code> and the columns of <code>z</code>.
</p>
<p>For convenience, the matrix can supplied as the <code>x</code> argument.  Or, <code>x</code> can be a list with elements including {x, y, z, xlab, ylab, zlab}.
</p>
<p>When this function is used inside a higher-level plotting function, the arguments <code>xds</code>, <code>yds</code>, and <code>zds</code> should be set to <code>deparse(substitute(x))</code> (etc.) so that the function can generate informative default axis labels.  For example, see the code for <code><a href="#topic+colorgram">colorgram</a></code>.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p> X coordinates </p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p> Y coordinates </p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p> Z matrix </p>
</td></tr>
<tr><td><code>xlab</code></td>
<td>
<p> Label for X axis </p>
</td></tr>
<tr><td><code>ylab</code></td>
<td>
<p> Label for Y axis </p>
</td></tr>
<tr><td><code>zlab</code></td>
<td>
<p> Label for Z axis </p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>  ## 
  str(volcano)
  volcano.xyzmat &lt;- xyzmat.coords(volcano)
  str(volcano.xyzmat)
</code></pre>

<hr>
<h2 id='xyzmat2xyz'>Convert (x, y, zmat) coordinates to (x, y, z) coordinates</h2><span id='topic+xyzmat2xyz'></span>

<h3>Description</h3>

<p>Convert a matrix of Z coordinates into (x, y, z) triples. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xyzmat2xyz(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xyzmat2xyz_+3A_...">...</code></td>
<td>
<p> Arguments passed to <code><a href="#topic+xyzmat.coords">xyzmat.coords</a></code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input is based on <code><a href="#topic+xyzmat.coords">xyzmat.coords</a></code>.
</p>
<p>The output is as returned by <code><a href="grDevices.html#topic+xyz.coords">xyz.coords</a></code>
</p>


<h3>Value</h3>

<p>A list; see <code><a href="grDevices.html#topic+xyz.coords">xyz.coords</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## 
  str(volcano)
  volcano.xyz &lt;- xyzmat2xyz(volcano)
  str(volcano.xyz)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
