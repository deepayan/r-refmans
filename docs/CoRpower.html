<!DOCTYPE html><html lang="en"><head><title>Help for package CoRpower</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CoRpower}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#computeN'><p>Estimation of Size and Numbers of Cases and Controls in the Target Population of Active Treatment Recipients At Risk at the Biomarker Sampling Timepoint</p></a></li>
<li><a href='#computePower'><p>Power Calculations for Assessing Intermediate Biomarkers as Correlates of Risk in the Active Treatment Group in Clinical Efficacy Trials, Accounting for Biomarker's Measurement Error and Treatment Efficacy</p></a></li>
<li><a href='#plotPowerCont'><p>Plotting of Power Curve versus Correlate of Risk Effect Size for Continuous Biomarkers</p></a></li>
<li><a href='#plotPowerTri'><p>Plotting of Power versus Correlate of Risk Effect Size for Dichotomous and Trichotomous Biomarkers</p></a></li>
<li><a href='#plotROCcurveTri'><p>Plotting of ROC Curves for Trichotomous Biomarkers</p></a></li>
<li><a href='#plotRRgradVE'><p>Plotting of the Ratio of Relative Risks for Higher/Lower Latent Subgroups against Correlate of Risk Effect Size for Trichotomous Biomarkers</p></a></li>
<li><a href='#plotVElatCont'><p>Plotting Treatment (Vaccine) Efficacy Curves for Different Correlate of Risk Relative Risks for Continuous Biomarkers</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Power Calculations for Assessing Correlates of Risk in Clinical
Efficacy Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mjuraska/CoRpower">https://github.com/mjuraska/CoRpower</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Calculates power for assessment of intermediate biomarker responses as correlates of risk in the active treatment group in clinical efficacy trials, as described in Gilbert, Janes, and Huang, Power/Sample Size Calculations for Assessing Correlates of Risk in Clinical Efficacy Trials (2016, Statistics in Medicine). The methods differ from past approaches by accounting for the level of clinical treatment efficacy overall and in biomarker response subgroups, which enables the correlates of risk results to be interpreted in terms of potential correlates of efficacy/protection. The methods also account for inter-individual variability of the observed biomarker response that is not biologically relevant (e.g., due to technical measurement error of the laboratory assay used to measure the biomarker response), which is important because power to detect a specified correlate of risk effect size is heavily affected by the biomarker's measurement error. The methods can be used for a general binary clinical endpoint model with a univariate dichotomous, trichotomous, or continuous biomarker response measured in active treatment recipients at a fixed timepoint after randomization, with either case-cohort Bernoulli sampling or case-control without-replacement sampling of the biomarker (a baseline biomarker is handled as a trivial special case). In a specified two-group trial design, the computeN() function can initially be used for calculating additional requisite design parameters pertaining to the target population of active treatment recipients observed to be at risk at the biomarker sampling timepoint. Subsequently, the power calculation employs an inverse probability weighted logistic regression model fitted by the tps() function in the 'osDesign' package. Power results as well as the relationship between the correlate of risk effect size and treatment efficacy can be visualized using various plotting functions. To link power calculations for detecting a correlate of risk and a correlate of treatment efficacy, a baseline immunogenicity predictor (BIP) can be simulated according to a specified classification rule (for dichotomous or trichotomous BIPs) or correlation with the biomarker response (for continuous BIPs), then outputted along with biomarker response data under assignment to treatment, and clinical endpoint data for both treatment and placebo groups.</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mjuraska/CoRpower/issues">https://github.com/mjuraska/CoRpower/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>survival, osDesign</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-11-17 01:24:39 UTC; mjuraska</td>
</tr>
<tr>
<td>Author:</td>
<td>Stephanie Wu [aut],
  Michal Juraska [aut, cre],
  Peter Gilbert [aut],
  Yunda Huang [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michal Juraska &lt;mjuraska@fredhutch.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-11-17 08:10:14 UTC</td>
</tr>
</table>
<hr>
<h2 id='computeN'>Estimation of Size and Numbers of Cases and Controls in the Target Population of Active Treatment Recipients At Risk at the Biomarker Sampling Timepoint</h2><span id='topic+computeN'></span>

<h3>Description</h3>

<p>If the power calculation is done at the study design stage, the function estimates the size and numbers of cases and controls in the target population of active treatment recipients observed to be
at risk at the biomarker sampling timepoint.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeN(
  Nrand,
  tau,
  taumax,
  VEtauToTaumax,
  VE0toTau,
  risk0,
  dropoutRisk,
  propCasesWithS
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeN_+3A_nrand">Nrand</code></td>
<td>
<p>the number of participants randomized to the active treatment group</p>
</td></tr>
<tr><td><code id="computeN_+3A_tau">tau</code></td>
<td>
<p>the biomarker sampling timepoint after randomization</p>
</td></tr>
<tr><td><code id="computeN_+3A_taumax">taumax</code></td>
<td>
<p>the time after randomization marking the end of the follow-up period for the clinical endpoint</p>
</td></tr>
<tr><td><code id="computeN_+3A_vetautotaumax">VEtauToTaumax</code></td>
<td>
<p>the treatment (vaccine) efficacy level between <code class="reqn">\tau</code> and <code class="reqn">\tau_{max}</code></p>
</td></tr>
<tr><td><code id="computeN_+3A_ve0totau">VE0toTau</code></td>
<td>
<p>the treatment (vaccine) efficacy between 0 and <code class="reqn">\tau</code></p>
</td></tr>
<tr><td><code id="computeN_+3A_risk0">risk0</code></td>
<td>
<p>the overall placebo-group endpoint risk between <code class="reqn">\tau</code> and <code class="reqn">\tau_{max}</code></p>
</td></tr>
<tr><td><code id="computeN_+3A_dropoutrisk">dropoutRisk</code></td>
<td>
<p>the risk of participant dropout between 0 and <code class="reqn">\tau_{max}</code></p>
</td></tr>
<tr><td><code id="computeN_+3A_propcaseswiths">propCasesWithS</code></td>
<td>
<p>the proportion of observed cases with a measured biomarker response</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function estimates design parameters that are required as input to <code><a href="#topic+computePower">computePower</a></code>. If the power calculation is done after the follow-up was completed, the estimates are replaced by the observed
counterparts for use as input parameters in <code><a href="#topic+computePower">computePower</a></code>.
</p>
<p>The calculations include options to account for participant dropout by specifying <code>dropoutRisk</code> as well as for incomplete sample storage by specifying <code>propCasesWithS</code>.
</p>
<p>The estimation procedure considers the standard survival analysis framework with failure and censoring times denoted by <code class="reqn">T</code> and <code class="reqn">C</code>, respectively, and makes the following assumptions:
</p>

<ol>
<li> <p><code class="reqn">T</code> and <code class="reqn">C</code> are independent.
</p>
</li>
<li> <p><code class="reqn">T|Z=0</code> follows an exponential distribution with rate <code class="reqn">\theta_t</code> and <code class="reqn">C|Z=0</code> follows an
exponential distribution with rate <code class="reqn">\theta_c</code>
</p>
</li>
<li> <p><code class="reqn">RR_{\tau-\tau_{max}} := P(T &lt;= \tau_{max}|T&gt; \tau, Z=1)/P(T &lt;= \tau_{max}|T&gt; \tau, Z=0)</code> is assumed to be equal to <code class="reqn"> P(T &lt;= t|T&gt; \tau, Z=1)/P(T &lt;= t|T&gt; \tau, Z=0)</code> for all <code class="reqn">t \in (\tau,\tau_{max}]</code>.
</p>
</li></ol>



<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li> <p><code>N</code>: the total estimated number of active treatment recipients observed to be at risk at <code class="reqn">\tau</code>
</p>
</li>
<li> <p><code>nCases</code>: the estimated number of clinical endpoint cases observed between <code class="reqn">\tau</code> and <code class="reqn">\tau_{max}</code> in the active treatment group
</p>
</li>
<li> <p><code>nControls</code>: the estimated number of controls observed to complete follow-up through <code class="reqn">\tau_{max}</code> endpoint-free in the active treatment group
</p>
</li>
<li> <p><code>nCasesWithS</code>: the estimated number of clinical endpoint cases observed between <code class="reqn">\tau</code> and <code class="reqn">\tau_{max}</code> in the active treatment group with an available biomarker response
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+computePower">computePower</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Nrand = 4100
tau = 3.5
taumax = 24
VEtauToTaumax = 0.75
VE0toTau = 0.75/2
risk0 = 0.034
dropoutRisk = 0.1
propCasesWithS = 1
computeN(Nrand, tau, taumax, VEtauToTaumax, VE0toTau, risk0, dropoutRisk, propCasesWithS)

</code></pre>

<hr>
<h2 id='computePower'>Power Calculations for Assessing Intermediate Biomarkers as Correlates of Risk in the Active Treatment Group in Clinical Efficacy Trials, Accounting for Biomarker's Measurement Error and Treatment Efficacy</h2><span id='topic+computePower'></span>

<h3>Description</h3>

<p>Performs a power calculation for assessing a univariate dichotomous, trichotomous, or continuous intermediate biomarker response as a correlate of risk
in the active treatment group in a clinical efficacy trial, accounting for the biomarker's measurement error and treatment efficacy. The statistical methods are described in [Gilbert, Janes, and Huang (2016).
&quot;Power/Sample Size Calculations for Assessing Correlates of Risk in Clinical Efficacy Trials.&quot;] Simulated data sets, extended to include placebo group and baseline immunogenicity predictor data, can be exported for
harmonized assessment of biomarker-specific treatment efficacy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computePower(
  nCasesTx,
  nControlsTx,
  nCasesTxWithS,
  controlCaseRatio = NULL,
  VEoverall,
  risk0,
  VElat0 = seq(0, VEoverall, len = 20),
  VElat1 = rep(VEoverall, 20),
  VElowest = NULL,
  Plat0 = NULL,
  Plat2 = NULL,
  P0 = Plat0,
  P2 = Plat2,
  PlatVElowest = NULL,
  sens = NULL,
  spec = NULL,
  FP0 = NULL,
  FN2 = NULL,
  M = 100,
  alpha = 0.05,
  sigma2obs = 1,
  rho = 1,
  biomType = c("continuous", "trichotomous", "dichotomous"),
  cohort = FALSE,
  p = NULL,
  tpsMethod = c("PL", "ML", "WL"),
  saveDir = NULL,
  saveFile = "CoRpower.RData",
  saveDataDir = NULL,
  saveDataFile = "fullData.RData",
  corr = NULL,
  nCasesPla = NULL,
  nControlsPla = NULL,
  sensBIP = NULL,
  specBIP = NULL,
  FP0BIP = NULL,
  FN2BIP = NULL,
  P0BIP = P0,
  P2BIP = P2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computePower_+3A_ncasestx">nCasesTx</code></td>
<td>
<p>an integer vector specifying the observed (for a finished trial) or expected (for a trial in design stage) number of clinical endpoint cases between <code class="reqn">\tau</code> and <code class="reqn">\tau_{max}</code> in the active treatment group. Each value represents a distinct scenario for power assessment.</p>
</td></tr>
<tr><td><code id="computePower_+3A_ncontrolstx">nControlsTx</code></td>
<td>
<p>an integer vector specifying the observed (for a finished trial) or expected (for a trial in design stage) number of controls with completed follow-up through <code class="reqn">\tau_{max}</code> and endpoint-free at <code class="reqn">\tau_{max}</code> in the active treatment group. Each value represents a distinct scenario for power assessment. The ordering in <code>nCasesTx</code> and <code>nControlsTx</code> must match.</p>
</td></tr>
<tr><td><code id="computePower_+3A_ncasestxwiths">nCasesTxWithS</code></td>
<td>
<p>an integer vector specifying the observed (for a finished trial) or expected (for a trial in design stage) number of clinical endpoint cases between <code class="reqn">\tau</code> and <code class="reqn">\tau_{max}</code> in the active treatment group with an available biomarker response. Each value represents a distinct scenario for power assessment. The ordering must match <code>nCasesTx</code> and <code>nControlsTx</code>.</p>
</td></tr>
<tr><td><code id="computePower_+3A_controlcaseratio">controlCaseRatio</code></td>
<td>
<p>an integer vector specifying the number of closeout controls sampled per case for biomarker measurement in the without replacement case-control sampling design (set to <code>NULL</code> by default). Each value represents a distinct scenario for power assessment.</p>
</td></tr>
<tr><td><code id="computePower_+3A_veoverall">VEoverall</code></td>
<td>
<p>a numeric value specifying the true overall treatment (vaccine) efficacy between <code class="reqn">\tau</code> and <code class="reqn">\tau_{max}</code></p>
</td></tr>
<tr><td><code id="computePower_+3A_risk0">risk0</code></td>
<td>
<p>a numeric value specifying the overall placebo-group endpoint risk between <code class="reqn">\tau</code> and <code class="reqn">\tau_{max}</code></p>
</td></tr>
<tr><td><code id="computePower_+3A_velat0">VElat0</code></td>
<td>
<p>a numeric vector specifying a grid of treatment (vaccine) efficacy levels in the latent lower protected subgroup for a dichotomous or trichotomous biomarker. Each value of <code>VElat0</code> corresponds to one unique effect size (<code class="reqn">RR_t</code>). Default ranges from <code>VEoverall</code> (<code class="reqn">H_0</code>) to 0 (maximal <code class="reqn">H_1</code> not allowing harm by treatment).</p>
</td></tr>
<tr><td><code id="computePower_+3A_velat1">VElat1</code></td>
<td>
<p>a numeric vector specifying a grid of treatment (vaccine) efficacy levels in the latent medium protected subgroup for a trichotomous biomarker. Each value corresponds to one unique effect size (<code class="reqn">RR_t</code>). The ordering must match <code>VElat0</code>. Set to <code>VEoverall</code> by default.</p>
</td></tr>
<tr><td><code id="computePower_+3A_velowest">VElowest</code></td>
<td>
<p>a numeric vector specifying a grid of treatment (vaccine) efficacy levels in the latent lowest-efficacy subgroup for a continuous biomarker. Default ranges from <code>VEoverall</code> (<code class="reqn">H_0</code>) to 0 (maximal <code class="reqn">H_1</code> not allowing harm by treatment).</p>
</td></tr>
<tr><td><code id="computePower_+3A_plat0">Plat0</code></td>
<td>
<p>a numeric vector specifying the prevalence of the latent lower protected subgroup for a dichotomous or trichotomous biomarker (set to <code>NULL</code> by default). Each value represents a distinct scenario for power assessment. The ordering in <code>Plat0</code>, <code>Plat2</code>, <code>P0</code>, and <code>P2</code> must match.</p>
</td></tr>
<tr><td><code id="computePower_+3A_plat2">Plat2</code></td>
<td>
<p>a numeric vector specifying the prevalence of the latent higher protected subgroup for a dichotomous or trichotomous biomarker (set to <code>NULL</code> by default). Each value represents a distinct scenario for power assessment. The ordering in <code>Plat0</code>, <code>Plat2</code>, <code>P0</code>, and <code>P2</code> must match.</p>
</td></tr>
<tr><td><code id="computePower_+3A_p0">P0</code></td>
<td>
<p>a numeric vector specifying the probability of low biomarker response for a dichotomous or trichotomous biomarker (set to <code>Plat0</code> by default). Each value represents a distinct scenario for power assessment. The ordering in <code>Plat0</code>, <code>Plat2</code>, <code>P0</code>, and <code>P2</code> must match.</p>
</td></tr>
<tr><td><code id="computePower_+3A_p2">P2</code></td>
<td>
<p>a numeric vector specifying the probability of high biomarker response for a dichotomous or trichotomous biomarker (set to <code>Plat2</code> by default). Each value represents a distinct scenario for power assessment. The ordering in <code>Plat0</code>, <code>Plat2</code>, <code>P0</code>, and <code>P2</code> must match.</p>
</td></tr>
<tr><td><code id="computePower_+3A_platvelowest">PlatVElowest</code></td>
<td>
<p>a numeric vector specifying the prevalence of the latent lowest-efficacy subgroup for a continuous biomarker (set to <code>NULL</code> by default). Each value represents a distinct scenario for power assessment.</p>
</td></tr>
<tr><td><code id="computePower_+3A_sens">sens</code></td>
<td>
<p>a numeric vector specifying the sensitivity, i.e., the probability of high biomarker response conditional on membership in the higher protected subgroup, for a dichotomous or trichotomous biomarker. Default is <code>NULL</code>, which indicates the use of 'approach 2'. Each value represents a distinct scenario for power assessment. The ordering in <code>sens</code>, <code>spec</code>, <code>FP0</code>, and <code>FN2</code> must match.</p>
</td></tr>
<tr><td><code id="computePower_+3A_spec">spec</code></td>
<td>
<p>a numeric vector specifying the specificity, i.e., the probability of low biomarker response conditional on membership in the lower protected subgroup, of a dichotomous or trichotomous biomarker. Default is <code>NULL</code>, which indicates the use of 'approach 2'. Each value represents a distinct scenario for power assessment. The ordering in <code>sens</code>, <code>spec</code>, <code>FP0</code>, and <code>FN2</code> must match.</p>
</td></tr>
<tr><td><code id="computePower_+3A_fp0">FP0</code></td>
<td>
<p>a numeric vector specifying the false positive rate, i.e., the probability of high biomarker response conditional on membership in the lower protected subgroup, for a dichotomous or trichotomous biomarker. Default is <code>NULL</code>, which indicates the use of 'approach 2'. Each value represents a distinct scenario for power assessment. The ordering in <code>sens</code>, <code>spec</code>, <code>FP0</code>, and <code>FN2</code> must match.</p>
</td></tr>
<tr><td><code id="computePower_+3A_fn2">FN2</code></td>
<td>
<p>a numeric vector specifying the false negative rate, i.e., the probability of low biomarker response conditional on membership in the higher protected subgroup, for a dichotomous or trichotomous biomarker. Default is <code>NULL</code>, which indicates the use of 'approach 2'. Each value represents a distinct scenario for power assessment. The ordering in <code>sens</code>, <code>spec</code>, <code>FP0</code>, and <code>FN2</code> must match.</p>
</td></tr>
<tr><td><code id="computePower_+3A_m">M</code></td>
<td>
<p>an integer value specifying the number of simulated clinical trials. Default is <code>100</code>.</p>
</td></tr>
<tr><td><code id="computePower_+3A_alpha">alpha</code></td>
<td>
<p>a numeric value specifying the two-sided Wald test type-I error rate. Default is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="computePower_+3A_sigma2obs">sigma2obs</code></td>
<td>
<p>a numeric value specifying the variance of the observed continuous biomarker or of the dichotomous or trichotomous biomarker simulated using 'approach 2' (set to <code>1</code> by default).</p>
</td></tr>
<tr><td><code id="computePower_+3A_rho">rho</code></td>
<td>
<p>a numeric vector specifying distinct protection-relevant fractions of <code>sigma2obs</code>. Each value represents a distinct scenario for power assessment.</p>
</td></tr>
<tr><td><code id="computePower_+3A_biomtype">biomType</code></td>
<td>
<p>a character string specifying the biomarker type. Default is <code>continuous</code>; other choices are <code>dichotomous</code> and <code>trichotomous</code>.</p>
</td></tr>
<tr><td><code id="computePower_+3A_cohort">cohort</code></td>
<td>
<p>a logical value for whether a case-cohort Bernoulli sampling design is to be used. If <code>FALSE</code> (default), the case-control without replacement sampling is used.</p>
</td></tr>
<tr><td><code id="computePower_+3A_p">p</code></td>
<td>
<p>a numeric vector specifying the probability of sampling into the subcohort in the case-cohort design (<code>NULL</code> by default). Each value represents a distinct scenario for power assessment.</p>
</td></tr>
<tr><td><code id="computePower_+3A_tpsmethod">tpsMethod</code></td>
<td>
<p>a character string specifying the estimation method in the inverse probability weighted logistic regression model fit by the <code>tps</code> function in the <code>osDesign</code> package. The options are <code>PL</code> for pseudo-likelihood (default), <code>ML</code> for maximum likelihood, and <code>WL</code> for weighted likelihood.</p>
</td></tr>
<tr><td><code id="computePower_+3A_savedir">saveDir</code></td>
<td>
<p>a character string specifying the path for a directory in which the output of the power calculation is to be saved. If <code>NULL</code> (default), the output is returned only.</p>
</td></tr>
<tr><td><code id="computePower_+3A_savefile">saveFile</code></td>
<td>
<p>a character vector specifying the name(s) of the <code>.RData</code> file(s) storing the output of the power calculation, used only if <code>saveDir</code> is not <code>NULL</code>. All file names must include &quot;.RData&quot; at the end. Default is <code>CoRpower.RData</code>.</p>
</td></tr>
<tr><td><code id="computePower_+3A_savedatadir">saveDataDir</code></td>
<td>
<p>a character string specifying the path for a directory in which the simulated data, including placebo group and baseline immunogenicity predictor (BIP) data, are to be saved. If <code>NULL</code> (default), the simulated data are not saved.</p>
</td></tr>
<tr><td><code id="computePower_+3A_savedatafile">saveDataFile</code></td>
<td>
<p>a character vector specifying the name(s) of the <code>.RData</code> file(s) in which the simulated data, including placebo group and BIP data, are to be saved; used only if <code>saveDataDir</code> is not <code>NULL</code>. All file names must include &quot;.RData&quot; at the end. Default is <code>fullData.RData</code>.</p>
</td></tr>
<tr><td><code id="computePower_+3A_corr">corr</code></td>
<td>
<p>a numeric vector in <code class="reqn">[-1,1]</code> specifying the correlation between a continuous baseline immunogenicity predictor (BIP) and the (underlying) continuous intermediate biomarker response (<code>NULL</code> by default). Each value represents a distinct scenario for power assessment. A useful BIP is highly correlated with the biomarker response at <code class="reqn">\tau</code>. It must be provided if <code>saveDataDir</code> is specified and a trichotomous biomarker under 'approach 2' or a continuous biomarker is considered.</p>
</td></tr>
<tr><td><code id="computePower_+3A_ncasespla">nCasesPla</code></td>
<td>
<p>an integer vector specifying the observed (for a finished trial) or expected (for a trial in design stage) number of clinical endpoint cases between <code class="reqn">\tau</code> and <code class="reqn">\tau_{max}</code> in the placebo group. Each value represents a distinct scenario matching <code>nCasesTx</code>. Default is <code>NULL</code>. It must be provided if <code>saveDataDir</code> is specified.</p>
</td></tr>
<tr><td><code id="computePower_+3A_ncontrolspla">nControlsPla</code></td>
<td>
<p>an integer vector specifying the observed (for a finished trial) or expected (for a trial in design stage) number of controls with completed follow-up through <code class="reqn">\tau_{max}</code> and endpoint-free at <code class="reqn">\tau_{max}</code> in the placebo group. Each value represents a distinct scenario matching <code>nControlsTx</code>. Default is <code>NULL</code>. It must be provided if <code>saveDataDir</code> is specified.</p>
</td></tr>
<tr><td><code id="computePower_+3A_sensbip">sensBIP</code></td>
<td>
<p>a numeric vector specifying &quot;the sensitivity&quot; of a dichotomous or trichotomous BIP, i.e., the probability of a high value of the BIP conditional on high biomarker response. Default is <code>NULL</code>, which indicates the use of 'approach 2'. It must be provided if <code>saveDataDir</code> is specified and 'approach 1' is to be used. Each value results in generating a separate BIP variable in the output data.</p>
</td></tr>
<tr><td><code id="computePower_+3A_specbip">specBIP</code></td>
<td>
<p>a numeric vector specifying &quot;the specificity&quot; of a dichotomous or trichotomous BIP, i.e., the probability of a low value of the BIP conditional on low biomarker response. Default is <code>NULL</code>, which indicates the use of 'approach 2'. It must be provided if <code>saveDataDir</code> is specified and 'approach 1' is to be used. Each value results in generating a separate BIP variable in the output data.</p>
</td></tr>
<tr><td><code id="computePower_+3A_fp0bip">FP0BIP</code></td>
<td>
<p>a numeric vector specifying &quot;the false positive rate&quot; of a dichotomous or trichotomous BIP, i.e., the probability of a high value of the BIP conditional on low biomarker response. Default is <code>NULL</code>, which indicates the use of 'approach 2'. It must be provided if <code>saveDataDir</code> is specified and 'approach 1' is to be used. Each value results in generating a separate BIP variable in the output data.</p>
</td></tr>
<tr><td><code id="computePower_+3A_fn2bip">FN2BIP</code></td>
<td>
<p>a numeric vector specifying &quot;the false negative rate&quot; of a dichotomous or trichotomous BIP, i.e., the probability of a low value of the BIP conditional on high biomarker response. Default is <code>NULL</code>, which indicates the use of 'approach 2'. It must be provided if <code>saveDataDir</code> is specified and 'approach 1' is to be used. Each value results in generating a separate BIP variable in the output data.</p>
</td></tr>
<tr><td><code id="computePower_+3A_p0bip">P0BIP</code></td>
<td>
<p>a numeric vector specifying the probability of a low value of a dichotomous or trichotomous BIP. If unspecified, it is set to <code>P0</code>. Each value results in generating a separate BIP variable in the output data.</p>
</td></tr>
<tr><td><code id="computePower_+3A_p2bip">P2BIP</code></td>
<td>
<p>a numeric vector specifying the probability of a high value of a dichotomous or trichotomous BIP. If unspecified, it is set to <code>P2</code>. Each value results in generating a separate BIP variable in the output data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A number of calling arguments can be specified as vectors with each component specifying a distinct scenario for power assessment (saved in a separate <code>.RData</code> file).
These are referred to as &quot;varying arguments.&quot;
Some varying arguments occur in a group, where the length and order of all specified vectors in the group must match; others are the only varying argument in their group.
Only arguments belonging to a single group may be varied at a time; if two or more groups contain vector inputs, the function will treat such inputs as an error.
The following are the groups of varying arguments that can be vectorized:
</p>

<ul>
<li> <p><code>nCasesTx</code>, <code>nControlsTx</code>, and <code>nCasesTxWithS</code> (together with <code>nCasesPla</code> and <code>nControlsPla</code> if simulated data sets are to be saved)
</p>
</li>
<li> <p><code>Plat0</code>, <code>Plat2</code>, <code>P0</code>, and <code>P2</code>
</p>
</li>
<li> <p><code>sens</code>, <code>spec</code>, <code>FP0</code>, and <code>FN2</code>
</p>
</li>
<li> <p><code>controlCaseRatio</code>
</p>
</li>
<li> <p><code>rho</code>
</p>
</li>
<li> <p><code>p</code>
</p>
</li></ul>

<p>Arguments independent of biomarker type and sampling design: <code>nCasesTx</code>, <code>nControlsTx</code>, <code>nCasesTxWithS</code>, <code>VEoverall</code>, <code>risk0</code>,
<code>M</code>, <code>alpha</code>, <code>tpsMethod</code>, <code>saveDir</code>, <code>saveFile</code>.
</p>
<p>Arguments specific to a trichotomous (or dichotomous) biomarker response: <code>VElat0</code>, <code>VElat1</code>, <code>Plat0</code>, <code>Plat2</code>, <code>P0</code>,
<code>P2</code>, <code>biomType = "trichotomous"</code> (or <code>"dichotomous"</code>)
</p>

<ul>
<li><p> Arguments for Approach 1: <code>sens</code>, <code>spec</code>, <code>FP0</code>, <code>FN2</code>
</p>
</li>
<li><p> Arguments for Approach 2: <code>sigma2obs</code>, <code>rho</code>
</p>
</li></ul>

<p>Arguments specific to a continuous biomarker response: <code>VElowest</code>, <code>PlatVElowest</code>, <code>sigma2obs</code>, <code>rho</code>, <code>biomType = "continuous"</code>
</p>
<p>Arguments for a case-control without replacement sampling design: <code>controlCaseRatio</code>
</p>
<p>Arguments for a case-cohort Bernoulli sampling design: <code>cohort = TRUE</code>, <code>p</code>
</p>
<p>To save output from the power calculations in an <code>.RData</code> file, <code>saveDir</code> must be specified. The default file name is <code>CoRpower.RData</code>;
a different file name may be specified by <code>saveFile</code> as a single character string, to which the value of the varying argument(s) will be appended for descriptive file naming purposes,
or, alternatively, a character vector may be specified with full file names (a single file will be produced for each value of the varying argument(s)).
</p>
<p>To link power calculations for detecting a correlate of risk and a correlate of treatment efficacy, simulated data sets used in the power calculations
can be exported with placebo-group data, with a possible extension including BIP data, for harmonized use by methods assessing biomarker-specific treatment efficacy.
The vignette &quot;Algorithms for Simulating Placebo Group and Baseline Immunogenicity Predictor Data&quot; provides more information on the algorithms and underlying assumptions for
simulating placebo-group and BIP data.
The exported data sets include treatment and placebo group data in the form of full rectangular data (i.e., disregarding biomarker sub-sampling), which enables the user to employ any preferred biomarker sub-sampling design.
To generate and export such data, <code>saveDataDir</code>, <code>nCasesPla</code>, and <code>nControlsPla</code> must be specified. <code>nCasesPla</code> and <code>nControlsPla</code> must have
the same length and order of components as <code>nCasesTx</code>, <code>nControlsTx</code>, and <code>nCasesTxWithS</code>.
</p>
<p>If a BIP is to be included in the simulated data export, additional arguments are necessary.
If the biomarker is trichotomous and Approach 1 is used, <code>sensBIP</code>, <code>specBIP</code>, <code>FP0BIP</code>, <code>FN2BIP</code>, <code>P0BIP</code>, and <code>P2BIP</code> must be specified;
if the biomarker is trichotomous and Approach 2 is used, <code>corr</code>, <code>P0BIP</code>, and <code>P2BIP</code> must be specified; if the biomarker is continuous, <code>corr</code> must be specified.
</p>
<p>Calling arguments pertaining to the simulation of the BIP in the exported data may also be specified as vectors, independently of the above varying arguments defining the power calculation scenarios
for the active treatment group. Each component of these vectors results in the generation of a separate BIP variable, in the same order, in the output data.
Some of these arguments occur in a group, where the length and order of all specified vectors in the group must match; others are the sole argument in their group.
Only arguments belonging to a single group may be varied at a time; if two or more groups contain vector inputs, the function will treat such inputs as an error.
The following are the groups of BIP arguments that can be vectorized:
</p>

<ul>
<li> <p><code>sensBIP</code>, <code>specBIP</code>, <code>FP0BIP</code>, <code>FN2BIP</code>
</p>
</li>
<li> <p><code>P0BIP</code>, <code>P2BIP</code>
</p>
</li>
<li> <p><code>corr</code>
</p>
</li></ul>

<p>The default file name for the outputted data sets is <code>fullData.RData</code>. A different file name may be specified by <code>saveDataFile</code>
as a single character string, to which the value of the &quot;varying argument&quot; for the power calculations will be appended for descriptive file naming purposes,
or, alternatively, a character vector may be specified with full file names (a single file will be produced for each value of the varying argument(s)).
Note: if the &quot;varying argument&quot; is <code>controlCaseRatio</code> or <code>p</code>, only one file will be generated because these arguments do not affect
the simulation of the full data; therefore, <code>saveDataFile</code> must be a character string in these cases.
</p>


<h3>Value</h3>

<p>If <code>saveDir</code> is specified, an output list (named <code>pwr</code>) for each power scenario is saved as an <code>.RData</code> file. Otherwise, the function returns a list of lists,
where the outer list ranges over specified values of the varying argument(s) whose components denote distinct scenarios, and the inner list is the output list for each power scenario.
For a dichotomous or trichotomous biomarker, each output list has the following components:
</p>

<ul>
<li> <p><code>power</code>: a numeric vector of fractions of simulated trials in which the null hypothesis <code class="reqn">H_0</code> is rejected. Each value of the vector corresponds to a value in the grid of treatment (vaccine) efficacies specified by <code>VElat0</code> and <code>VElat1</code>.
</p>
</li>
<li> <p><code>RRt</code>: a numeric vector of correlate-of-risk relative-risk effect sizes. Each value of the vector corresponds to a value in the grid of treatment (vaccine) efficacies specified by <code>VElat0</code> and <code>VElat1</code>.
</p>
</li>
<li> <p><code>risk1_2</code>: a numeric vector of conditional endpoint risks given a high biomarker response in the active treatment group. Each value of the vector corresponds to a value in the grid of treatment (vaccine) efficacies specified by <code>VElat0</code> and <code>VElat1</code>.
</p>
</li>
<li> <p><code>risk1_0</code>: a numeric vector of conditional endpoint risks given a low biomarker response in the active treatment group. Each value of the vector corresponds to a value in the grid of treatment (vaccine) efficacies specified by <code>VElat0</code> and <code>VElat1</code>.
</p>
</li>
<li> <p><code>VElat2</code>: a numeric vector specifying a grid of treatment (vaccine) efficacy levels in the latent higher protected subgroup for a dichotomous or trichotomous biomarker
</p>
</li>
<li> <p><code>VElat0</code>: a numeric vector specifying a grid of treatment (vaccine) efficacy levels in the latent lower protected subgroup for a dichotomous or trichotomous biomarker
</p>
</li>
<li> <p><code>Plat2</code>: a numeric value specifying the prevalence of the latent higher protected subgroup for a dichotomous or trichotomous biomarker
</p>
</li>
<li> <p><code>Plat0</code>: a numeric value specifying the prevalence of the latent lower protected subgroup for a dichotomous or trichotomous biomarker
</p>
</li>
<li> <p><code>P2</code>: a numeric value specifying the probability of high biomarker response for a dichotomous or trichotomous biomarker
</p>
</li>
<li> <p><code>P0</code>: a numeric value specifying the probability of low biomarker response for a dichotomous or trichotomous biomarker
</p>
</li>
<li> <p><code>alphaLat</code>: a numeric vector of the log odds of the clinical endpoint in the subgroup of active treatment recipients with the latent <code class="reqn">x^{\ast}=0</code> (this coefficient estimate applies to a continuous biomarker)
</p>
</li>
<li> <p><code>betaLat</code>: a numeric vector of the log odds ratio of the clinical endpoint comparing two subgroups of active treatment recipients differing in the latent <code class="reqn">x^{\ast}</code> by 1 (this coefficient estimate applies to a continuous biomarker)
</p>
</li>
<li> <p><code>sens</code>: a numeric vector of sensitivities (i.e., the probability of high biomarker response conditional on membership in the higher protected subgroup) of the observed dichotomous or trichotomous biomarker as a function of <code>rho</code>
</p>
</li>
<li> <p><code>spec</code>: a numeric vector of specificities (i.e., the probability of low biomarker response conditional on membership in the lower protected subgroup) of the observed dichotomous or trichotomous biomarker as a function of <code>rho</code>
</p>
</li>
<li> <p><code>FP0</code>: a numeric vector of false positive rates (i.e., the probability of high biomarker response conditional on membership in the lower protected subgroup) of the observed dichotomous or trichotomous biomarker as a function of <code>rho</code>
</p>
</li>
<li> <p><code>FN2</code>: a numeric vector of false negative rates (i.e., the probability of low biomarker response conditional on membership in the higher protected subgroup) of the observed dichotomous or trichotomous biomarker as a function of <code>rho</code>
</p>
</li>
<li> <p><code>NcompleteTx</code>: an integer value specifying <code>nCasesTx</code> + <code>nControlsTx</code>, i.e., the number, observed or projected, of active treatment recipients at risk at <code class="reqn">\tau</code> with an observed endpoint or a completed follow-up through <code class="reqn">\tau_{max}</code>
</p>
</li>
<li> <p><code>nCasesTx</code>: an integer value specifying the number of clinical endpoint cases observed (or projected) between <code class="reqn">\tau</code> and <code class="reqn">\tau_{max}</code> in the active treatment group
</p>
</li>
<li> <p><code>nCasesTxWithS</code>: an integer value specifying the number of clinical endpoint cases observed (or projected) between <code class="reqn">\tau</code> and <code class="reqn">\tau_{max}</code> in the active treatment group with an available biomarker response
</p>
</li>
<li> <p><code>controlCaseRatio</code>: an integer specifying the number of controls sampled per case for
biomarker measurement in the without replacement case-control sampling design
</p>
</li>
<li> <p><code>VEoverall</code>: a numeric value specifying the overall treatment (vaccine) efficacy between <code class="reqn">\tau</code> and <code class="reqn">\tau_{max}</code>
</p>
</li>
<li> <p><code>risk0</code>: a numeric value specifying the overall placebo-group endpoint risk between <code class="reqn">\tau</code> and <code class="reqn">\tau_{max}</code>
</p>
</li>
<li> <p><code>alpha</code>: a numeric value specifying the two-sided Wald test type-I error rate
</p>
</li>
<li> <p><code>rho</code>: a numeric vector specifying distinct protection-relevant fractions of the variance of the observed biomarker
</p>
</li>
<li> <p><code>approach</code>: a number denoting whether Approach 1 or Approach 2 was used (1 if sens, spec, FP0, FN2 were specified in the input; 2 if rho and sigma2obs were specified in the input)
</p>
</li>
<li> <p><code>varyingArg</code>: a character string containing the name(s) and value(s) of the varying argument
</p>
</li></ul>

<p>For a continuous biomarker, each output list has the following components:
</p>

<ul>
<li> <p><code>power</code>: a numeric vector of fractions of simulated trials in which the null hypothesis <code class="reqn">H_0</code> is rejected. Rows represent calculations for different values of <code>rho</code> or <code>nCasesTx</code>, depending on which is a vector. Columns represent calculations for the grid of treatment (vaccine) efficacy levels in the latent lowest-efficacy subgroup, specified by <code>VElowest</code>.
</p>
</li>
<li> <p><code>RRc</code>: a numeric vector of correlate-of-risk relative-risk effect sizes as a function of the grid of treatment (vaccine) efficacy levels in the latent lowest-efficacy subgroup, specified by <code>VElowest</code>
</p>
</li>
<li> <p><code>betaLat</code>: a numeric vector specifying the log odds ratio of the clinical endpoint comparing two subgroups of active treatment recipients differing in the latent <code class="reqn">x^{\ast}</code> by 1 (this coefficient estimate applies to a continuous biomarker)
</p>
</li>
<li> <p><code>alphaLat</code>: a numeric vector specifying the the log odds of the clinical endpoint in the subgroup of active treatment recipients with the latent <code class="reqn">x^{\ast}=0</code> (this coefficient estimate applies to a continuous biomarker)
</p>
</li>
<li> <p><code>PlatVElowest</code>: a numeric value specifying the prevalence of the latent lowest-efficacy subgroup for a continuous biomarker
</p>
</li>
<li> <p><code>VElowest</code>: a numeric vector specifying a grid of treatment (vaccine) efficacy levels in the latent lowest-efficacy subgroup for a continuous biomarker
</p>
</li>
<li> <p><code>sigma2obs</code>: a numeric value specifying the variance of the observed continuous biomarker or of the dichotomous or trichotomous biomarker simulated using 'approach 2'
</p>
</li>
<li> <p><code>NcompleteTx</code>: an integer value specifying <code>nCasesTx</code> + <code>nControlsTx</code>, i.e., the number, observed or projected, of active treatment recipients at risk at <code class="reqn">\tau</code> with an observed endpoint or a completed follow-up through <code class="reqn">\tau_{max}</code>
</p>
</li>
<li> <p><code>nCasesTx</code>: an integer value specifying the number of clinical endpoint cases observed (or projected) between <code class="reqn">\tau</code> and <code class="reqn">\tau_{max}</code> in the active treatment group
</p>
</li>
<li> <p><code>nCasesTxWithS</code>: an integer value specifying the number of clinical endpoint cases observed (or projected) between <code class="reqn">\tau</code> and <code class="reqn">\tau_{max}</code> in the active treatment group with an available biomarker response
</p>
</li>
<li> <p><code>controlCaseRatio</code>: an integer value specifying the number of controls sampled per case for biomarker measurement in the without replacement case-control sampling design
</p>
</li>
<li> <p><code>VEoverall</code>: a numeric value specifying the overall treatment (vaccine) efficacy between <code class="reqn">\tau</code> and <code class="reqn">\tau_{max}</code>
</p>
</li>
<li> <p><code>risk0</code>: a numeric value specifying the overall placebo-group endpoint risk between <code class="reqn">\tau</code> and <code class="reqn">\tau_{max}</code>
</p>
</li>
<li> <p><code>alpha</code>: a numeric value specifying the two-sided Wald test type-I error rate
</p>
</li>
<li> <p><code>rho</code>: a numeric vector specifying distinct protection-relevant fractions of the variance of the observed biomarker
</p>
</li>
<li> <p><code>varyingArg</code>: a character string containing the name(s) and value(s) of the varying argument
</p>
</li></ul>

<p>If <code>saveDataDir</code> is specified, the simulated data, including placebo group and BIP data, are saved in one or more <code>.RData</code> file(s)
containing a list of lists of data frames.
The components of the outer list consist each of one Monte-Carlo iteration of simulated data for all values of <code>VElat0</code> or <code>VElat1</code> if
the biomarker is trichotomous, or of <code>VElowest</code> if the biomarker is continuous. Each data frame corresponds to one simulated trial.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+computeN">computeN</a></code>, <code><a href="#topic+plotPowerTri">plotPowerTri</a></code>, <code><a href="#topic+plotPowerCont">plotPowerCont</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Trichotomous biomarker, Approach 1, varying sens and spec ##
## Specify sens, spec, FP0, FN2
nCasesTx &lt;- 32
nControlsTx &lt;- 1000
nCasesTxWithS &lt;- 32
controlCaseRatio &lt;- 5
VEoverall &lt;- 0.75
risk0 &lt;- 0.034
VElat0 &lt;- seq(0, VEoverall, len=20)  # 20 data points for the power curve
VElat1 &lt;- rep(VEoverall, 20)
Plat0 &lt;- 0.2
Plat2 &lt;- 0.6
P0 &lt;- Plat0  # different values of P0 can be set
P2 &lt;- Plat2  # different values of P2 can be set
sens &lt;- spec &lt;- c(1, 0.9, 0.8, 0.7)
FP0 &lt;- FN2 &lt;- rep(0, 4)
M &lt;- 5
alpha &lt;- 0.05
biomType &lt;- "trichotomous"
computePower(nCasesTx=nCasesTx, nControlsTx=nControlsTx, nCasesTxWithS=nCasesTxWithS,
             controlCaseRatio=controlCaseRatio, VEoverall=VEoverall,
             risk0=risk0, VElat0=VElat0, VElat1=VElat1, Plat0=Plat0,
             Plat2=Plat2, P0=P0, P2=P2, M=M, alpha=alpha, spec=spec,
             FP0=FP0, sens=sens, FN2=FN2, biomType=biomType)

## Not run: 
## Trichotomous biomarker, Approach 2, varying rho ##
## Saving simulated data (including placebo and BIP data)
## Specify rho, sigma2obs, saveDataDir, saveDataFile, corr

nCasesTx &lt;- 32
nControlsTx &lt;- 1000
nCasesTxWithS &lt;- 32
controlCaseRatio &lt;- 5
VEoverall &lt;- 0.75
risk0 &lt;- 0.034
VElat0 &lt;- seq(0, VEoverall, len=20)
VElat1 &lt;- rep(VEoverall, 20)
Plat0 &lt;- 0.2
Plat2 &lt;- 0.6
P0 &lt;- Plat0
P2 &lt;- Plat2
M &lt;- 5
alpha &lt;- 0.05
sigma2obs &lt;- 1
rho &lt;- c(1, 0.9, 0.7, 0.5)
biomType &lt;- "trichotomous"
saveDataDir &lt;- "~/myDir"
saveDataFile &lt;- "myDataFile.RData"
corr &lt;- 0.7
computePower(nCasesTx=nCasesTx, nControlsTx=nControlsTx, nCasesTxWithS=nCasesTxWithS,
             controlCaseRatio=controlCaseRatio, VEoverall=VEoverall, risk0=risk0,
             VElat0=VElat0, VElat1=VElat1, Plat0=Plat0, Plat2=Plat2, P0=P0, P2=P2,
             M=M, alpha=alpha, sigma2obs=sigma2obs, rho=rho, biomType=biomType,
             saveDataDir=saveDataDir, saveDataFile=saveDataFile, corr=corr)


## dichotomous biomarker, Approach 2, varying rho ##
## Plat0 + Plat2 = 1

nCasesTx &lt;- 32
nControlsTx &lt;- 1000
nCasesTxWithS &lt;- 32
controlCaseRatio &lt;- 5
VEoverall &lt;- 0.75
risk0 &lt;- 0.034
VElat0 &lt;- seq(0, VEoverall, len=20)  # 20 data points for the power curve
VElat1 &lt;- rep(0, 20)  # will not be used by function
Plat0 &lt;- 0.25
Plat2 &lt;- 1 - Plat0
P0 &lt;- Plat0
P2 &lt;- Plat2
M &lt;- 5
alpha &lt;- 0.05
sigma2obs &lt;- 1
rho &lt;- c(1, 0.9, 0.7, 0.5)
biomType &lt;- "dichotomous"
computePower(nCasesTx=nCasesTx, nControlsTx=nControlsTx, nCasesTxWithS=nCasesTxWithS,
             controlCaseRatio=controlCaseRatio, VEoverall=VEoverall, risk0=risk0,
             VElat0=VElat0, VElat1=VElat1, Plat0=Plat0, Plat2=Plat2, P0=P0, P2=P2,
             M=M, alpha=alpha, sigma2obs=sigma2obs, rho=rho, biomType=biomType)


## Continuous biomarker, varying rho ##

nCasesTx &lt;- 32
nControlsTx &lt;- 1000
nCasesTxWithS &lt;- 32
controlCaseRatio &lt;- 5
VEoverall &lt;- 0.75
risk0 &lt;- 0.034
PlatVElowest &lt;- 0.2
VElowest &lt;- seq(0, VEoverall, len=20)
M &lt;- 5
alpha &lt;- 0.05
sigma2obs &lt;- 1
rho &lt;- c(1, 0.9, 0.7, 0.5)
biomType &lt;- "continuous"
computePower(nCasesTx=nCasesTx, nControlsTx=nControlsTx, nCasesTxWithS=nCasesTxWithS,
             controlCaseRatio=controlCaseRatio, VEoverall=VEoverall, risk0=risk0,
             PlatVElowest=PlatVElowest, VElowest=VElowest, M=M, alpha=alpha,
             sigma2obs=sigma2obs, rho=rho, biomType=biomType)


## Continuous biomarker, case-cohort sampling design, varying p ##
nCasesTx &lt;- 32
nControlsTx &lt;- 1000
nCasesTxWithS &lt;- 32
VEoverall &lt;- 0.75
risk0 &lt;- 0.034
PlatVElowest &lt;- 0.2
VElowest &lt;- seq(0, VEoverall, len=20)
M &lt;- 5
alpha &lt;- 0.05
sigma2obs &lt;- 1
rho &lt;- 0.9
biomType &lt;- "continuous"
cohort &lt;- TRUE
p &lt;- c(0.01, 0.02, 0.03)
computePower(nCasesTx=nCasesTx, nControlsTx=nControlsTx, nCasesTxWithS=nCasesTxWithS,
             VEoverall=VEoverall, risk0=risk0, PlatVElowest=PlatVElowest,
             VElowest=VElowest, M=M, alpha=alpha, sigma2obs=sigma2obs,
             rho=rho, biomType=biomType, cohort=cohort, p=p)

## Continuous biomarker, saving output, varying sample sizes ##

nCasesTx &lt;- 32
nControlsTx &lt;- 1000
nCasesTxWithS &lt;- 32
controlCaseRatio &lt;- 5
VEoverall &lt;- 0.75
risk0 &lt;- 0.034
PlatVElowest &lt;- 0.2
VElowest &lt;- seq(0, VEoverall, len=20)
M &lt;- 5
alpha &lt;- 0.05
sigma2obs &lt;- 1
rho &lt;- c(1, 0.9, 0.7, 0.5)
biomType &lt;- "continuous"
saveDir &lt;- "~/myDir"
saveFile &lt;- "MyFile.RData"
computePower(nCasesTx=nCasesTx, nCasesTxWithS=nCasesTxWithS, nControlsTx=nControlsTx,
             controlCaseRatio=controlCaseRatio, VEoverall=VEoverall,
             risk0=risk0, PlatVElowest=PlatVElowest, VElowest=VElowest,
             M=M, alpha=alpha, sigma2obs=sigma2obs, rho=rho,
             biomType=biomType, saveDir=saveDir, saveFile=saveFile)

## End(Not run)

</code></pre>

<hr>
<h2 id='plotPowerCont'>Plotting of Power Curve versus Correlate of Risk Effect Size for Continuous Biomarkers</h2><span id='topic+plotPowerCont'></span>

<h3>Description</h3>

<p>Plots power (on the y-axis) to detect a correlate of risk effect size (on the x-axis) in the active treatment group for a continuous biomarker.
The correlate of risk effect size is quantified as the odds ratio of the clinical endpoint comparing subgroups of active treatment recipients with a 1 standard deviation difference in a
noise-free biomarker response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPowerCont(
  outComputePower,
  outDir = NULL,
  legendText,
  legendTitle = NULL,
  extendedLeg = TRUE,
  verboseLeg = TRUE,
  margin = c(11, 7, 3, 1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotPowerCont_+3A_outcomputepower">outComputePower</code></td>
<td>
<p>either a list of lists containing output from <code><a href="#topic+computePower">computePower</a></code> or a character vector specifying the <code>.RData</code> file(s) containing <code><a href="#topic+computePower">computePower</a></code> output</p>
</td></tr>
<tr><td><code id="plotPowerCont_+3A_outdir">outDir</code></td>
<td>
<p>a character vector specifying path(s) to output <code>.RData</code> file(s), necessary if <br />
<code>outComputePower</code> is a character vector. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plotPowerCont_+3A_legendtext">legendText</code></td>
<td>
<p>a character vector specifying the entirety of the legend text. The order of the elements (i.e., parameter values) must match that of the <code><a href="#topic+computePower">computePower</a></code> input parameters in order for legend labels to be accurate.</p>
</td></tr>
<tr><td><code id="plotPowerCont_+3A_legendtitle">legendTitle</code></td>
<td>
<p>a character vector specifying the legend title if applicable (<code>NULL</code> by default)</p>
</td></tr>
<tr><td><code id="plotPowerCont_+3A_extendedleg">extendedLeg</code></td>
<td>
<p>a logical value specifying if the extended footnote legend with additional information about the control-to-case ratio, overall vaccine efficacy, number of cases, etc., is to be included. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plotPowerCont_+3A_verboseleg">verboseLeg</code></td>
<td>
<p>a logical value specifying if the extended footnote legend shall use English words (<code>TRUE</code> by default) or mathematical notation used in Gilbert, Janes, and Huang (2016)</p>
</td></tr>
<tr><td><code id="plotPowerCont_+3A_margin">margin</code></td>
<td>
<p>a numeric vector of the form <code>c(bottom, left, top, right)</code>, which specifies the margins of the plot. Default is <code>c(11, 7, 3, 1)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If multiple levels are specified for the biomarker measurement error input argument <code>rho</code>, only the first level is used to determine
the <code class="reqn">RR_c</code> values shown as x-axis tickmark labels.
</p>
<p>The function's plot can be interpreted in conjunction with the output of <code><a href="#topic+plotVElatCont">plotVElatCont</a></code> by
matching the CoR relative risk in the two plots and examining power compared to treatment (vaccine) efficacy.
This sheds light on the importance of overall vaccine efficacy on power and allows correlates of risk results
to be interpreted in terms of potential correlates of efficacy/protection.
</p>


<h3>Value</h3>

<p>None. The function is called solely for plot generation.
</p>


<h3>References</h3>

<p>Gilbert P. B., Janes H., and Huang Y. (2016), Power/Sample Size Calculations for Assessing Correlates of Risk in Clinical Efficacy Trials. <em>Stat Med</em> 35(21):3745-59.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+computePower">computePower</a></code>, <code><a href="#topic+plotVElatCont">plotVElatCont</a></code>, <code><a href="#topic+plotPowerTri">plotPowerTri</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example scenario with continuous biomarker, where values of rho are varied

# Set input parameters for computePower function
nCasesTx &lt;- 10
nControlsTx &lt;- 300
nCasesTxWithS &lt;- 10
controlCaseRatio &lt;- 5
VEoverall &lt;- 0.75
risk0 &lt;- 0.034
PlatVElowest &lt;- 0.2
VElowest &lt;- seq(0, VEoverall, len=5)
Plat0 &lt;- P0 &lt;- 0.2
Plat2 &lt;- P2 &lt;- 0.6
M &lt;- 22
alpha &lt;- 0.05
sigma2obs &lt;- 1
rho &lt;- c(1, 0.7, 0.4)
biomType &lt;- "continuous"

# Output from computePower function is stored in an object as a list of lists
pwr &lt;- computePower(nCasesTx=nCasesTx, nCasesTxWithS=nCasesTxWithS, nControlsTx=nControlsTx,
                    controlCaseRatio=controlCaseRatio, risk0=risk0, VEoverall=VEoverall,
                    PlatVElowest=PlatVElowest, VElowest=VElowest,
                    Plat0=Plat0, Plat2=Plat2, P0=P0, P2=P2, M=M, alpha=alpha,
                    sigma2obs=sigma2obs, rho=rho, biomType=biomType)

# Set parameters for plotPowerCont function
# outComputePower is a list of lists containing output from the computePower function
outComputePower &lt;- pwr
legendText &lt;- paste0("rho = ", c(1, 0.7, 0.4))
plotPowerCont(outComputePower=outComputePower, legendText=legendText)

## Not run: 
# Output from computePower function is saved in RData files
computePower(..., saveDir = "myDir", saveFile = "myFile.RData")
# outComputePower is a character string specifying the file containing the
# computePower output
# outDir is a character string specifying the outComputePower file directory
outComputePower &lt;- paste0("myFile_rho_", c(1, 0.7, 0.4), ".RData")
outDir &lt;- "~/myDir"
legendText &lt;- paste0("rho = ", c(1, 0.7, 0.4))
plotPowerCont(outComputePower, outDir=outDir, legendText = legendText)

## End(Not run)

</code></pre>

<hr>
<h2 id='plotPowerTri'>Plotting of Power versus Correlate of Risk Effect Size for Dichotomous and Trichotomous Biomarkers</h2><span id='topic+plotPowerTri'></span>

<h3>Description</h3>

<p>Plots power (on the y-axis) to detect a correlate of risk effect size (on the x-axis) in the active treatment group for a dichotomous or trichotomous biomarker. The correlate of risk effect size is quantified as
the relative risk of the clinical endpoint comparing subgroups of active treatment recipients with high and low biomarker response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPowerTri(
  outComputePower,
  outDir = NULL,
  legendText,
  legendTitle = NULL,
  extendedLeg = TRUE,
  verboseLeg = TRUE,
  margin = c(11, 7, 3, 1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotPowerTri_+3A_outcomputepower">outComputePower</code></td>
<td>
<p>either a list of lists containing output from <code><a href="#topic+computePower">computePower</a></code> or a character vector specifying the <code>.RData</code> file(s) containing <code><a href="#topic+computePower">computePower</a></code> output</p>
</td></tr>
<tr><td><code id="plotPowerTri_+3A_outdir">outDir</code></td>
<td>
<p>a character vector specifying path(s) to output <code>.RData</code> file(s), necessary if <code>outComputePower</code> is a character vector. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plotPowerTri_+3A_legendtext">legendText</code></td>
<td>
<p>a character vector specifying the entirety of the legend text. The order of the elements (i.e., parameter values) must match that of the <code><a href="#topic+computePower">computePower</a></code> input parameters in order for legend labels to be accurate.</p>
</td></tr>
<tr><td><code id="plotPowerTri_+3A_legendtitle">legendTitle</code></td>
<td>
<p>a character vector specifying the legend title if applicable (<code>NULL</code> by default)</p>
</td></tr>
<tr><td><code id="plotPowerTri_+3A_extendedleg">extendedLeg</code></td>
<td>
<p>a logical value specifying if the extended footnote legend with additional information about the control-to-case ratio, overall vaccine efficacy, number of cases, etc., is to be included. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plotPowerTri_+3A_verboseleg">verboseLeg</code></td>
<td>
<p>a logical value specifying if the extended footnote legend shall use English words (<code>TRUE</code> by default) or mathematical notation used in Gilbert, Janes, and Huang (2016)</p>
</td></tr>
<tr><td><code id="plotPowerTri_+3A_margin">margin</code></td>
<td>
<p>a numeric vector of the form <code>c(bottom, left, top, right)</code>, which specifies the margins of the plot. Default is <code>c(11, 7, 3, 1)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If multiple levels are specified for the biomarker measurement error input parameters (i.e., for <code>sens</code>/<code>spec</code> or <code>rho</code>) in <code><a href="#topic+computePower">computePower</a></code>, only the first level is used to determine
the <code class="reqn">RR_t</code> values shown as x-axis tickmark labels.
</p>


<h3>Value</h3>

<p>None. The function is called solely for plot generation.
</p>


<h3>References</h3>

<p>Gilbert P. B., Janes H., and Huang Y. (2016), Power/Sample Size Calculations for Assessing Correlates of Risk in Clinical Efficacy Trials. <em>Stat Med</em> 35(21):3745-59.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+computePower">computePower</a></code>, <code><a href="#topic+plotPowerCont">plotPowerCont</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example scenario with trichotomous biomarker, where values of controlCaseRatio are varied

# Set input parameters for computePower function
nCasesTx &lt;- 10
nControlsTx &lt;- 300
nCasesTxWithS &lt;- 10
controlCaseRatio &lt;- c(5,3)
VEoverall &lt;- 0.75
risk0 &lt;- 0.034
VElat0 &lt;- seq(0, VEoverall, len=5)
VElat1 &lt;- rep(VEoverall, 5)
Plat0 &lt;- P0 &lt;- 0.2
Plat2 &lt;- P2 &lt;- 0.6
sens &lt;- spec &lt;- 0.8
FP0 &lt;- FN2 &lt;- 0
M &lt;- 50
alpha &lt;- 0.05
biomType &lt;- "trichotomous"

# Output from computePower function is stored in an object as a list of lists
pwr &lt;- computePower(nCasesTx=nCasesTx, nControlsTx=nControlsTx, nCasesTxWithS=nCasesTxWithS,
                     controlCaseRatio=controlCaseRatio, risk0=risk0,
                     VEoverall=VEoverall, Plat0=Plat0, Plat2=Plat2, P0=P0, P2=P2,
                     VElat0=VElat0, VElat1=VElat1, M=M, alpha=alpha, spec=spec,
                     FP0=FP0, sens=sens, FN2=FN2, biomType=biomType)

# Set parameters for plotPowerTri function
# outComputePower is a list of lists containing outputs from the computePower function
outComputePower &lt;- pwr
legendText &lt;- paste0("controls:cases = ", c("5:1","3:1"))
plotPowerTri(outComputePower=outComputePower, legendText=legendText)

## Not run: 
# outComputePower is a character vector specifying the files containing computePower output
# outDir is a character vector specifying the outComputePower file directories
outComputePower &lt;- paste0("myFile_controlCaseRatio_", c(5, 3), ".RData")
outDir &lt;- rep("~/myDir", 2)
legendText &lt;- paste0("controls:cases = ", c("5:1","3:1"))
plotPowerTri(outComputePower, outDir=outDir, legendText = legendText)

## End(Not run)

</code></pre>

<hr>
<h2 id='plotROCcurveTri'>Plotting of ROC Curves for Trichotomous Biomarkers</h2><span id='topic+plotROCcurveTri'></span>

<h3>Description</h3>

<p>Plots the receiver operating characteristic (ROC) curve displaying sensitivity and specificity for a range of <code>P2</code> and <code>P0</code> values,
four values of <code>rho</code>, and four values of <code>Plat2</code>. Illustrates how different levels of measurement error <code>rho</code> map to sensitivity
and specificity, depending on the value of <code>Plat2</code>. This funciton is used to create Figure 1 in the Supplementary Material of
[Gilbert, Janes, and Huang (2016). &quot;Power/Sample Size Calculations for Assessing Correlates of Risk in Clinical Efficacy Trials.&quot;]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotROCcurveTri(Plat0, Plat2, P0, P2, rho)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotROCcurveTri_+3A_plat0">Plat0</code></td>
<td>
<p>a numeric value specifying the prevalence of the latent lower protected subgroup for a dichotomous or trichotomous biomarker</p>
</td></tr>
<tr><td><code id="plotROCcurveTri_+3A_plat2">Plat2</code></td>
<td>
<p>a numeric vector of length four specifying the prevalences of the latent higher protected subgroup for a dichotomous or trichotomous biomarker</p>
</td></tr>
<tr><td><code id="plotROCcurveTri_+3A_p0">P0</code></td>
<td>
<p>a numeric vector specifying a grid of probabilities of low biomarker response for a dichotomous or trichotomous biomarker.</p>
</td></tr>
<tr><td><code id="plotROCcurveTri_+3A_p2">P2</code></td>
<td>
<p>a numeric vector specifying a grid of probabilities of high biomarker response for a dichotomous or trichotomous biomarker.</p>
</td></tr>
<tr><td><code id="plotROCcurveTri_+3A_rho">rho</code></td>
<td>
<p>a numeric vector of length four specifying distinct protection-relevant fractions of <code>sigma2obs</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. The function is called solely for plot generation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Plat0 &lt;- 0.2
Plat2 &lt;- c(0.2, 0.3, 0.4, 0.5)
P0 &lt;- seq(0.90, 0.10, len=10)
P2 &lt;- seq(0.10, 0.90, len=10)
rho &lt;- c(1, 0.9, 0.7, 0.5)
plotROCcurveTri(Plat0 = Plat0, Plat2 = Plat2, P0 = P0, P2 = P2, rho = rho)

</code></pre>

<hr>
<h2 id='plotRRgradVE'>Plotting of the Ratio of Relative Risks for Higher/Lower Latent Subgroups against Correlate of Risk Effect Size for Trichotomous Biomarkers</h2><span id='topic+plotRRgradVE'></span>

<h3>Description</h3>

<p>Plots the ratio of relative risks for the higher and lower latent subgroups (on the y-axis) versus the correlate of risk effect size (on the x-axis) in the active treatment group for a trichotomous biomarker.
The correlate of risk effect size is quantified as the relative risk ratio of the clinical endpoint comparing subgroups of active treatment recipients with high and low biomarker response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotRRgradVE(
  outComputePower,
  outDir = NULL,
  legendText,
  extendedLeg = TRUE,
  xLegPos = 0.5,
  yLegPos = 0.5,
  ySep = 0.07,
  margin = c(7, 4, 3, 1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotRRgradVE_+3A_outcomputepower">outComputePower</code></td>
<td>
<p>either a list of lists containing output from <code><a href="#topic+computePower">computePower</a></code> or a character vector specifying the <code>.RData</code> file(s) containing <code><a href="#topic+computePower">computePower</a></code> output</p>
</td></tr>
<tr><td><code id="plotRRgradVE_+3A_outdir">outDir</code></td>
<td>
<p>a character vector specifying path(s) to output <code>.RData</code> file(s), necessary if <br /><code>outComputePower</code> is a character vector. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plotRRgradVE_+3A_legendtext">legendText</code></td>
<td>
<p>a character vector specifying the entirety of the legend text. The order of the elements (i.e., parameter values) must match that of the <code><a href="#topic+computePower">computePower</a></code> input parameters in order for legend labels to be accurate.</p>
</td></tr>
<tr><td><code id="plotRRgradVE_+3A_extendedleg">extendedLeg</code></td>
<td>
<p>a logical value specifying if the extended legend with additional information about the control-to-case ratio, overall vaccine efficacy, number of cases, etc., is to be included. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plotRRgradVE_+3A_xlegpos">xLegPos</code></td>
<td>
<p>a number from <code>0</code> to <code>1</code> specifying the horizontal position of the extended legend, if applicable. A value of <code>0</code> produces text on the left side of the plot, <code>0.5</code> (default) produces text in the center, and <code>1</code> produces text on the right side.</p>
</td></tr>
<tr><td><code id="plotRRgradVE_+3A_ylegpos">yLegPos</code></td>
<td>
<p>a number from <code>0</code> to <code>1</code> specifying the vertical position of the extended legend, if applicable. A value of <code>0</code> produces text at the bottom of the plot, <code>0.5</code> (default) produces text in the center, and <code>1</code> produces text at the top.</p>
</td></tr>
<tr><td><code id="plotRRgradVE_+3A_ysep">ySep</code></td>
<td>
<p>a numeric value that specifies the spacing distance between lines in the extended legend, if applicable. Default is <code>0.7</code>.</p>
</td></tr>
<tr><td><code id="plotRRgradVE_+3A_margin">margin</code></td>
<td>
<p>a numeric vector of the form <code>c(bottom, left, top, right)</code>, which specifies the margins of the plot. Default is <code>c(7, 4, 3, 1)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>rho</code> is varied, this plot shows how the relationship between the correlate of risk effect size and the relative risks for the higher and lower latent subgroups
changes for different values of <code>rho</code>. The ratio of relative risks for the higher and lower latent subgroups is a relative vaccine efficacy parameter. When <code>rho=1</code>,
a correlate of risk in the vaccine group is equivalent to the relative vaccine efficacy parameter, whereas for imperfectly measured biomarkers with <code>rho&lt;1</code>,
the correlate of risk effect size is closer to the null than the relative vaccine efficacy parameter is.
</p>


<h3>Value</h3>

<p>None. The function is called solely for plot generation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+computePower">computePower</a></code>, <code><a href="#topic+plotPowerTri">plotPowerTri</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example scenario with trichotomous biomarker, where values of rho are varied

# Set input parameters for computePower function
nCasesTx &lt;- 10
nControlsTx &lt;- 300
nCasesTxWithS &lt;- 10
controlCaseRatio &lt;- 3
VEoverall &lt;- 0.75
risk0 &lt;- 0.034
VElat0 &lt;- seq(0, VEoverall, len=10)
VElat1 &lt;- rep(VEoverall, 10)
Plat0 &lt;- P0 &lt;- 0.2
Plat2 &lt;- P2 &lt;- 0.6
M &lt;- 20
alpha &lt;- 0.05
sigma2obs &lt;- 1
rho &lt;- c(1, 0.7, 0.4)
biomType &lt;- "trichotomous"

# Output from computePower function is stored in an object as a list
pwr &lt;- computePower(nCasesTx=nCasesTx, nControlsTx=nControlsTx, nCasesTxWithS=nCasesTxWithS,
                    controlCaseRatio=controlCaseRatio, risk0=risk0, VEoverall=VEoverall,
                    Plat0=Plat0, Plat2=Plat2, P0=P0, P2=P2, VElat0=VElat0,
                    VElat1=VElat1, M=M, alpha=alpha, sigma2obs=sigma2obs, rho=rho,
                    biomType=biomType)

# Set parameters for plotPowerCont function
# outComputePower is a list of lists containing output from the computePower function
outComputePower &lt;- pwr
legendText &lt;- paste0("rho = ", c(1, 0.7, 0.4))
plotRRgradVE(outComputePower=outComputePower, legendText=legendText)

## Not run: 
# Output from computePower function is saved in an RData file
computePower(..., saveDir = "myDir", saveFile = "myFile.RData")

# outComputePower is a character string specifying the file containing the computePower output
# outDir is a character string specifying the outComputePower file directory
outComputePower &lt;- paste0("myFile_rho_", c(1, 0.7, 0.4), ".RData")
outDir &lt;- "~/myDir"
legendText &lt;- paste0("rho = ", c(1, 0.7, 0.4))
plotRRgradVE(outComputePower, outDir=outDir, legendText = legendText)

## End(Not run)

</code></pre>

<hr>
<h2 id='plotVElatCont'>Plotting Treatment (Vaccine) Efficacy Curves for Different Correlate of Risk Relative Risks for Continuous Biomarkers</h2><span id='topic+plotVElatCont'></span>

<h3>Description</h3>

<p>Plots the treatment (vaccine) efficacy curve for the true latent biomarker for eight different values of the latent correlate of risk
relative risk and the lowest vaccine efficacy level for the true biomarker. All curves assume <code>rho=1</code>, and treatment (vaccine)
efficacy ranges from 0 to 1. The legend is completely determined by the function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotVElatCont(outComputePower, outDir = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotVElatCont_+3A_outcomputepower">outComputePower</code></td>
<td>
<p>a list of lists of length <code>1</code> containing output from <code><a href="#topic+computePower">computePower</a></code> or a character string specifying the <code>.RData</code> file containing <code><a href="#topic+computePower">computePower</a></code> output</p>
</td></tr>
<tr><td><code id="plotVElatCont_+3A_outdir">outDir</code></td>
<td>
<p>a character string specifying path to output <code>.RData</code> file, necessary if <br /><code>outComputePower</code> is a character string. Default is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+computePower">computePower</a></code> function input parameter <code>VElowest</code> must have length greater than or equal to eight
for all eight scenarios to have unique RRc and VElowest. Otherwise, only <code>length(VElowest)</code> unique
VE curves will be displayed.
</p>
<p>When interpreting the output of the function, the null hypothesis corresponds to a flat curve where vaccine efficacy for all values of the
true latent biomarker is equal to the overall vaccine efficacy. Increasing departures from the null hypothesis correspond
to increasingly variable and steep VE curves. The output assumes the overall placebo-group endpoint risk between <code class="reqn">\tau</code> and <code class="reqn">\tau_{max}</code>
is constant for all values of the latent and observed biomarker and that there is no measurement error (<code class="reqn">\rho=1</code>). When this is the case,
an association of the biomarker with infection risk in the vaccine group (a correlate of risk) is equivalent to an association of the biomarker
with treatment (vaccine) efficacy.
</p>
<p>The function's plot can also be interpreted in conjunction with the output of the <code><a href="#topic+plotPowerCont">plotPowerCont</a></code> function by
matching the CoR relative risk in the two plots and examining power compared to VE. This sheds light on the importance
of overall VE on power and further enables correlates of risk results to be interpreted in terms of
potential correlates of efficacy/protection.
</p>


<h3>Value</h3>

<p>None. The function is called solely for plot generation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+computePower">computePower</a></code>, <code><a href="#topic+plotPowerCont">plotPowerCont</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example scenario with continuous biomarker, where values of rho are varied

# Set input parameters for computePower function
nCasesTx &lt;- 10
nControlsTx &lt;- 300
nCasesTxWithS &lt;- 10
controlCaseRatio &lt;- 3
VEoverall &lt;- 0.75
risk0 &lt;- 0.034
PlatVElowest &lt;- 0.2
VElowest &lt;- seq(0, VEoverall, len=8)
Plat0 &lt;- P0 &lt;- 0.2
Plat2 &lt;- P2 &lt;- 0.6
M &lt;- 13
alpha &lt;- 0.05
sigma2obs &lt;- 1
rho &lt;- 1
biomType &lt;- "continuous"

# Output from computePower function is stored in an object as a list
pwr &lt;- computePower(nCasesTx=nCasesTx, nControlsTx=nControlsTx, nCasesTxWithS=nCasesTxWithS,
                    controlCaseRatio=controlCaseRatio, risk0=risk0, VEoverall=VEoverall,
                    PlatVElowest=PlatVElowest, VElowest=VElowest, Plat0=Plat0, Plat2=Plat2,
                    P0=P0, P2=P2, M=M, alpha=alpha, sigma2obs=sigma2obs, rho=rho, biomType=biomType)

# Set parameters for plotPowerCont function
# outComputePower is a list containing output from the computePower function
outComputePower &lt;- pwr
plotVElatCont(outComputePower=outComputePower)

## Not run: 
# Output from computePower function is saved in an RData file
computePower(..., saveDir = "myDir", saveFile = "myFile.RData")
# outComputePower is a character string specifying the file containing the computePower output
# outDir is a character string specifying the outComputePower file directory
outComputePower &lt;- "myFile.RData"
outDir &lt;- "~/myDir"
plotVElatCont(outComputePower, outDir=outDir)

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
