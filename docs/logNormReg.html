<!DOCTYPE html><html><head><title>Help for package logNormReg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {logNormReg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#confint.lognlm'>
<p>Confidence intervals for the parameters in log normal regression</p></a></li>
<li><a href='#logLik.lognlm'>
<p>Log Likelihood for log Normal linear regression</p></a></li>
<li><a href='#lognlm'>
<p>Multiple linear regression with log Normal errors</p></a></li>
<li><a href='#lognlm.fit'>
<p>The fitter function for log Normal Linear Models</p></a></li>
<li><a href='#logNormReg-package'>
<p>log Normal Linear Regression</p>
</a></li>
<li><a href='#palermo'>
<p>Air quality in Palermo (Italy), 1997-2001</p></a></li>
<li><a href='#paris'>
<p>PM2.5 and PM10 measurements in Paris in 2019</p></a></li>
<li><a href='#print.lognlm'>
<p>Print method for the lognlm class</p></a></li>
<li><a href='#summary.lognlm'>
<p>Summarizing  model fits for log Normal regression</p></a></li>
<li><a href='#vcov.lognlm'>
<p>Covariance matrix for lognlm fits</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>log Normal Linear Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-11-08</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Vito M. R. Muggeo &lt;vito.muggeo@unipa.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to fits simple linear regression models with log normal errors 
		and identity link, i.e. taking the responses on the original scale. See
		Muggeo (2018) &lt;<a href="https://doi.org/10.13140%2FRG.2.2.18118.16965">doi:10.13140/RG.2.2.18118.16965</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-11-08 16:48:20 UTC; vito</td>
</tr>
<tr>
<td>Author:</td>
<td>Vito M. R. Muggeo <a href="https://orcid.org/0000-0002-3386-4054"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-11-08 17:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='confint.lognlm'>
Confidence intervals for the parameters in log normal regression
</h2><span id='topic+confint.lognlm'></span>

<h3>Description</h3>

<p>Computes confidence intervals (based on the Gradient, Wald or Likelihood Ratio sattistic) for the linear parameters in a fitted &lsquo;lognreg&rsquo; model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lognlm'
confint(object, parm, level=0.95, type = c("wald", "gradient", "lrt"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.lognlm_+3A_object">object</code></td>
<td>

<p>a fitted <code>lognlm</code> object.
</p>
</td></tr>
<tr><td><code id="confint.lognlm_+3A_parm">parm</code></td>
<td>

<p>the parameter of interest. Numeric (covariate number) or character (covariate name). If missing <code>parm=2</code> is taken, i.e. the coefficient of the first covariate, provided the intercept is in the model.
</p>
</td></tr>
<tr><td><code id="confint.lognlm_+3A_level">level</code></td>
<td>

<p>the required confidence level (default to 0.95).
</p>
</td></tr>
<tr><td><code id="confint.lognlm_+3A_type">type</code></td>
<td>

<p>Which statistics should be used? Currently <code>"wald"</code>, <code>"gradient"</code>, or <code>"lrt"</code>. Names can be abbreviated. If <code>object</code> has been obtained with <code>lik=FALSE</code>, only <code>type="wald"</code> or <code>"gradient"</code> is permitted.
</p>
</td></tr>
<tr><td><code id="confint.lognlm_+3A_...">...</code></td>
<td>

<p>When <code>type</code> is not <code>"wald"</code>, other optional arguments to be passed on the internal functions: <br /> 
- <code>lim</code> to specify the range of the evaluation points (default to (-3,3) resulting in the interval <code class="reqn">\hat\beta \pm 3\times \mathrm{SE}(\hat\beta)</code>); <br />  
- <code>values</code> to set explicitly the evaluation point(s); <br /> 
- <code>return.val</code> to return (if <code>TRUE</code>) the evaluation points and the corresponding statistic values (useful to plot the profiled statistic). If the supplied <code>values</code> includes just one scalar, <code>return.val</code> is set to <code>TRUE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Confidence intervals are computed and returned. Currently the Wald, Gradient or Likelihood ratio statistic can be used. Based on some simulation experiments the simple Wald based CIs appears adeguate to guarantee the nominal coverage levels.  
</p>


<h3>Value</h3>

<p>The end-points of confidence intervals.
</p>


<h3>Author(s)</h3>

<p>Vito Muggeo
</p>


<h3>References</h3>

<p>For a gentle and general introduction about the likelihood-based statistics (including the gradient) see
</p>
<p>Muggeo V.M.R., Lovison G. (2014), The 'three plus one' likelihood-based test statistics: unified geometrical and graphical interpretations. <em>The American Statistician</em>, <b>68</b>, 302-306.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lognlm">lognlm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

n=50
s=.4
set.seed(1515)      #just to get reproducible results..

#covariates
x&lt;-seq(.1,10,l=n) 
z&lt;-rnorm(n)

#response
mu&lt;- 10+.5*x- z  #linear regression function
y&lt;-rlnorm(n, log(mu)-s^2/2, s) #data..

o&lt;- lognlm(y~x+z, lik=TRUE) #ML estimation

confint(o, "x", type="g")
confint(o, "z", type="w") #same than confint.default(o) 

</code></pre>

<hr>
<h2 id='logLik.lognlm'>
Log Likelihood for log Normal linear regression
</h2><span id='topic+logLik.lognlm'></span><span id='topic+extractAIC.lognlm'></span>

<h3>Description</h3>

<p>The function returns the log-likelihood value of the log Normal linear regression model evaluated at the estimated coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lognlm'
logLik(object, full=FALSE, ...)
## S3 method for class 'lognlm'
extractAIC(fit, scale=0, k=2, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.lognlm_+3A_object">object</code>, <code id="logLik.lognlm_+3A_fit">fit</code></td>
<td>

<p>A <code>lognlm</code> fit returned by <code>lognlm()</code>
</p>
</td></tr>
<tr><td><code id="logLik.lognlm_+3A_full">full</code></td>
<td>

<p>If <code>FALSE</code>, only the <em>kernel</em> of the log likelihood is returned, otherwise the complete log likelihood (including terms depending on data only)
</p>
</td></tr>
<tr><td><code id="logLik.lognlm_+3A_scale">scale</code></td>
<td>

<p>Optional numeric specifying the scale parameter of the model. Currenty not used.
</p>
</td></tr>
<tr><td><code id="logLik.lognlm_+3A_k">k</code></td>
<td>

<p>Optional numeric specifying the penalty of the edf in the AIC formula. If <code>k&lt;=0</code>, the BIC is returned.
</p>
</td></tr>
<tr><td><code id="logLik.lognlm_+3A_...">...</code></td>
<td>

<p>optional  arguments (nothing in this method).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>object</code> has been obtained via <code>lognlm(.., lik=TRUE)</code>, <code>logLik.lognlm</code> returns the log likelihood (kernel or complete, depending on argument <code>full</code>), otherwise the sum of log residuals, <code class="reqn">\sum(\log(y_i)-\log(\hat\mu_i))^2)</code>. The value returned by <code>AIC</code> is based on the <em>kernel</em> log likelihood or the the sum of log residuals, while <code>extractAIC</code> can return the AIC (or BIC) using the full log likelihood (via <code>extractAIC(.., full=TRUE)</code>)  
</p>


<h3>Value</h3>

<p>The log likelihood (or the sum of log residuals squared) of the model fit <code>object</code>
</p>


<h3>Author(s)</h3>

<p>Vito Muggeo
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lognlm">lognlm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   
# o is the fit object, see ?lognlm
n=50
s=.4

#covariates
x&lt;-seq(.1,10,l=n) 

#response
set.seed(1234)      #just to get reproducible results..
mu&lt;- 10+.5*x  #linear regression function
y&lt;-rlnorm(n, log(mu)-s^2/2, s) #data..

o&lt;- lognlm(y~x, lik=TRUE) #the model

logLik(o) #the kernel log likelihood value
logLik(o, full=TRUE)
   
</code></pre>

<hr>
<h2 id='lognlm'>
Multiple linear regression with log Normal errors
</h2><span id='topic+lognlm'></span>

<h3>Description</h3>

<p>The function fits simple multiple linear regression models with log Normals erros. Two objectives as well as two optimizing functions can be used. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lognlm(formula, data, subset, weights, na.action, y = TRUE, start, model = TRUE, 
     lik = FALSE, opt = c("nlminb", "optim"), contrasts=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lognlm_+3A_formula">formula</code></td>
<td>

<p>a standard R formula with response and explanatory variables (and possible offset) specifying the regression model being fitted.
</p>
</td></tr>
<tr><td><code id="lognlm_+3A_data">data</code></td>
<td>

<p>an optional data frame, list or environment containing some or all the variables in the model.
</p>
</td></tr>
<tr><td><code id="lognlm_+3A_subset">subset</code></td>
<td>

<p>an optional vector specifying a subset of observations to be used in the fitting process.
</p>
</td></tr>
<tr><td><code id="lognlm_+3A_weights">weights</code></td>
<td>

<p>an optional vector of (positive) weights to be used in the fitting process. Currently implemented only if <code>lik=FALSE</code>.
</p>
</td></tr>
<tr><td><code id="lognlm_+3A_na.action">na.action</code></td>
<td>

<p>a function  indicating what should happen when the data contain NAs. The default is set by the <code>na.action</code> setting of <code>options</code>.
</p>
</td></tr>
<tr><td><code id="lognlm_+3A_y">y</code></td>
<td>

<p>logical. If <code>TRUE</code> the response vector is returned as <code>y</code> in the fit object.
</p>
</td></tr>
<tr><td><code id="lognlm_+3A_start">start</code></td>
<td>

<p>(optional) starting values of the parameter to be estimated. If <code>start</code> is missing they are computed via ordinary least squares with the intercept <code class="reqn">\hat\beta_0</code> replaced by <code class="reqn">max(\hat\beta_0,median\{y_i\})</code>. <br /> 
If <code>lik=TRUE</code> (i.e. a log Normal model is fitted), <code>start</code> refers to the regression parameters <em>and</em> the error standard deviation; if <code>lik=FALSE</code>, <code>start</code> does <em>not</em> include the starting guess for the standard deviation.
</p>
</td></tr>
<tr><td><code id="lognlm_+3A_model">model</code></td>
<td>

<p>logical. If <code>TRUE</code> the model frame is returned as <code>model</code> in the fit object.
</p>
</td></tr>
<tr><td><code id="lognlm_+3A_lik">lik</code></td>
<td>

<p>If <code>TRUE</code> the log Normal log likelihood is optimized, otherwise the sum of squared residuals based on the logs (see Details).
</p>
</td></tr>
<tr><td><code id="lognlm_+3A_opt">opt</code></td>
<td>

<p>the optimization function to be used. <code>nlminb</code> appears to be more efficient, probably because it uses (unlike <code>optim</code>) also the hessian matrix (supplied in the code). However results are often indistinguishable.
</p>
</td></tr>
<tr><td><code id="lognlm_+3A_contrasts">contrasts</code></td>
<td>

<p>an optional list. See the contrasts.arg of model.matrix.default.
</p>
</td></tr>
<tr><td><code id="lognlm_+3A_...">...</code></td>
<td>

<p>optional arguments passed on to the optimizing functions (<code>nlminb</code> or <code>optim</code>), (and therefore should be <em>consistent</em> with that).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>lognlm</code> fits simple linear regression models with log Normal errors and identity link. Actually two objectives could be used.
</p>
<p>If <code>lik=TRUE</code> the usual log Normal likelihood is optimized, otherwise estimation is based on minimization of the following loss function
</p>
<p style="text-align: center;"><code class="reqn">\sum_i(\log y_i-\log \mu_i )^2</code>
</p>

<p>where <code class="reqn">\mu_i=x_i^T\beta</code> is the mean function equal to the linear predictor (as an identity link is exploited).
</p>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>the regression parameters estimate.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>The objective function value, namely the log Normal log likelihood or the sum of the squared &lsquo;log residuals&rsquo; (depending on <code>lik</code> option).</p>
</td></tr>
<tr><td><code>s2</code></td>
<td>
<p>the error variance estimate.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the fitted values.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the raw residuals on the original scale, i.e. 'observed - fitted'.</p>
</td></tr>
<tr><td><code>grad</code></td>
<td>
<p>the gradient at solution.</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>the hessian matrix at solution.</p>
</td></tr>
<tr><td><code>Ehessian</code></td>
<td>
<p>the expected hessian matrix at solution (only if <code>lik=FALSE</code>).</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>the convergence code coming from the fitter function. <code>0</code> means succefull convergence. </p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the response vector (provided that <code>y=TRUE</code> has been set).</p>
</td></tr>
<tr><td><code>opt</code></td>
<td>
<p>the employed optimizer.</p>
</td></tr>
<tr><td><code>lik</code></td>
<td>
<p>logical, indicating if the fit comes from a log Normal likelihood approach.</p>
</td></tr>
<tr><td><code>xlevels</code></td>
<td>
<p>(only where relevant) a record of the levels of the factors used in fitting.</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>the terms object used.</p>
</td></tr>
<tr><td><code>contrasts</code></td>
<td>
<p>(only where relevant) the contrasts used.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>if requested, i.e. <code>model=TRUE</code> has been set (the default), the model frame used.</p>
</td></tr>
<tr><td><code>offset</code></td>
<td>
<p>the (possible) offset used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Vito M.R. Muggeo
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+print.lognlm">print.lognlm</a></code> and <code><a href="#topic+summary.lognlm">summary.lognlm</a></code> to display results.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n=300
s=.4
set.seed(123)      #just to get reproducible results..

x&lt;-seq(.1,10,l=n) #covariate
mu&lt;- 10+2*x  #linear regression function
y&lt;-rlnorm(n, log(mu)-s^2/2, s) #data..

o0&lt;-lm(log(y)~x) #the usual but WRONG model
o&lt;- lognlm(y~x, lik=TRUE) #fit the 'right' model by ML

plot(x,y)
lines(x, mu, lwd=2)
points(x, exp(fitted(o0)), col=2, type="l", lwd=2)
points(x, fitted(o), col=3, type="l", lwd=2)
legend("topleft", legend=c("true", "lm(log(y)~x)", "lognlm(y~x)"), 
    col=c(1,2,3), lwd=2)

#Sometimes people would estimate parameters by minimizing a least square objective 
# (i.e. by setting 'lik=FALSE', see Details), wherein data would come from 
# Y = mu * exp(eps) where eps~N(0,s)..
y1&lt;-mu*exp(rnorm(n,0,1)) #data..
o1&lt;-lognlm(y1~x, lik=FALSE) #set 'lik=FALSE', see Details


</code></pre>

<hr>
<h2 id='lognlm.fit'>
The fitter function for log Normal Linear Models
</h2><span id='topic+lognlm.fit'></span>

<h3>Description</h3>

<p><code>lognlm.fit</code> is called by <code>lognlm</code> to fit log Normal linear regression models. Two optimizing functions can be used, <code>nlminb</code> and 
<code>optim</code>. This function is not meant to be called by the user directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lognlm.fit(X, y, par, lik = TRUE, opt = c("nlminb", "optim"), 
    offset=NULL, weights=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lognlm.fit_+3A_x">X</code></td>
<td>

<p>design matrix for standard linear terms.
</p>
</td></tr>
<tr><td><code id="lognlm.fit_+3A_y">y</code></td>
<td>

<p>vector of observations of length <code>n</code>.
</p>
</td></tr>
<tr><td><code id="lognlm.fit_+3A_par">par</code></td>
<td>

<p>starting values of parameters to be estimated.
</p>
</td></tr>
<tr><td><code id="lognlm.fit_+3A_lik">lik</code></td>
<td>

<p>logical. See <code>lik</code> in <code><a href="#topic+lognlm">lognlm</a></code>
</p>
</td></tr>
<tr><td><code id="lognlm.fit_+3A_opt">opt</code></td>
<td>

<p>the optimizing algorithm. Default to <code>nlminb</code>.
</p>
</td></tr>
<tr><td><code id="lognlm.fit_+3A_offset">offset</code></td>
<td>

<p>a possible offset term.
</p>
</td></tr>
<tr><td><code id="lognlm.fit_+3A_weights">weights</code></td>
<td>

<p>apossible weights to be used if <code>lik=FALSE</code>.
</p>
</td></tr>
<tr><td><code id="lognlm.fit_+3A_...">...</code></td>
<td>

<p>other arguments to be passed to the optimizer specified in <code>opt</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+lognlm">lognlm</a></code> for more details on the arguments and returned objects.
</p>


<h3>Value</h3>

<p>A list of fit information
</p>


<h3>Note</h3>

<p>This function should usually not be used directly by the user.
</p>


<h3>Author(s)</h3>

<p>Vito M.R. Muggeo
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+nlminb">nlminb</a></code>, <code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="#topic+lognlm">lognlm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See ?lognlm
</code></pre>

<hr>
<h2 id='logNormReg-package'>
log Normal Linear Regression 

</h2><span id='topic+logNormReg-package'></span><span id='topic+logNormReg'></span>

<h3>Description</h3>


<p>Functions to perform and to display results from simple multiple linear regression with log Normal errors and identity link. Standard errors of estimates are based on the sandwich formula.
</p>


<h3>Details</h3>






<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> logNormReg</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.5-0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-11-08</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Acknowledgement</h3>

<p>This package was inspired by a fruitful discussion with 
Andrew Beet (Marine Policy Center, Woods Hole Oceanographic Institution, U.S.).</p>


<h3>Author(s)</h3>

<p>Vito M.R. Muggeo &lt;vito.muggeo@unipa.it&gt;


</p>


<h3>References</h3>

<p>Gustavsson, S., Fagerberg, B., Sallsten, G.,  Andersson, E. M. (2014). Regression Models for Log-Normal Data: Comparing Different Methods for Quantifying the Association between Abdominal Adiposity and Biomarkers of Inflammation and Insulin Resistance . <em>International Journal of Environmental Research and Public Health</em>, <b>11</b>, 3521&ndash;3539. 
</p>
<p>Muggeo, V.M.R. (2018) A note on regression with log Normal errors: linear and piecewise linear modelling in R, doi: 10.13140/RG.2.2.18118.16965.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+lognlm">lognlm</a></code> for the main function with a toy example. <br />  
See also package <code>gamlss</code> for more general regression models including log Normal errors.
</p>

<hr>
<h2 id='palermo'>
Air quality in Palermo (Italy), 1997-2001
</h2><span id='topic+palermo'></span>

<h3>Description</h3>

<p>Daily time series of some pollutants and meteorological variables in Palermo, 1997-2001
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("palermo")</code></pre>


<h3>Format</h3>

<p>A data frame with 1826 observations on the following 8 variables.
</p>

<dl>
<dt><code>day</code></dt><dd><p>day of month</p>
</dd>
<dt><code>month</code></dt><dd><p>month of year</p>
</dd>
<dt><code>year</code></dt><dd><p>year</p>
</dd>
<dt><code>so2</code></dt><dd><p>Sulfur dioxide</p>
</dd>
<dt><code>no2</code></dt><dd><p>Nitrogen dioxide</p>
</dd>
<dt><code>pm10</code></dt><dd><p>particular matter</p>
</dd>
<dt><code>temp</code></dt><dd><p>tempearture (degrees Celsius)</p>
</dd>
<dt><code>hum</code></dt><dd><p>air humidity (%)</p>
</dd>
</dl>



<h3>Details</h3>

<p>Data refer to air pollution, temperature and humidity registered in Palermo, (Sicily, Italy) in 1997-2001. Data are averages from eight monitoring stations in the city.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(palermo)

o&lt;-lognlm(pm10 ~ temp + hum, data=palermo)



## End(Not run)
</code></pre>

<hr>
<h2 id='paris'>
PM2.5 and PM10 measurements in Paris in 2019
</h2><span id='topic+paris'></span>

<h3>Description</h3>

<p>Hourly time series of PM2.5 and PM10 measurements in Paris in 2019
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("paris")</code></pre>


<h3>Format</h3>

<p>A data frame with 647 observations on the following 4 variables.
</p>

<dl>
<dt><code>utc</code></dt><dd><p>date and time of measurements</p>
</dd>
<dt><code>pm25</code></dt><dd><p>The PM2.5 measurements</p>
</dd>
<dt><code>pm10</code></dt><dd><p>The PM10 measurements</p>
</dd>
<dt><code>hours</code></dt><dd><p>numeric, the measurement hours</p>
</dd>
</dl>



<h3>Details</h3>

<p>Ambient particulate matter measurements (PM 2.5 and PM 10) measured by reference-grade instruments for Paris - Centre, 
hourly measurements for July 2019. Non-physical measurements (zero values and outliers with PM2.5 greater than 2xPM10) were     removed, as mass of PM2.5 is a fraction of mass of PM10 by definition.
</p>


<h3>Source</h3>

<p>European Environmental Agency, through Open AQ <code>(https://openaq.org/#/location/4146)</code>. Thanks to Vito Ilacqua (EPA) for pointing out that.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(paris)
plot(pm10~pm25, data=paris)
o&lt;-lm(pm10~pm25, data=paris) #negative intercept! it's meaningless..
o1&lt;-lognlm(pm10 ~ pm25, data=paris, lik=TRUE)
abline(coef=coef(o),  col=2)
abline(coef=coef(o1), col=3)
</code></pre>

<hr>
<h2 id='print.lognlm'>
Print method for the lognlm class
</h2><span id='topic+print.lognlm'></span>

<h3>Description</h3>

<p>Printing the most important feautures of a <code>'lognlm'</code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lognlm'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.lognlm_+3A_x">x</code></td>
<td>
<p> object of class <code>segmented</code> </p>
</td></tr>
<tr><td><code id="print.lognlm_+3A_digits">digits</code></td>
<td>
<p> number of digits to be printed </p>
</td></tr>
<tr><td><code id="print.lognlm_+3A_...">...</code></td>
<td>
<p> arguments passed to other functions </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Vito M.R. Muggeo </p>


<h3>See Also</h3>

 <p><code><a href="#topic+summary.lognlm">summary.lognlm</a></code>, <code><a href="#topic+print.summary.lognlm">print.summary.lognlm</a></code> </p>

<hr>
<h2 id='summary.lognlm'>
Summarizing  model fits for log Normal regression
</h2><span id='topic+summary.lognlm'></span><span id='topic+print.summary.lognlm'></span>

<h3>Description</h3>

<p>summary method for class <code>lognlm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lognlm'
summary(object, ...)

## S3 method for class 'summary.lognlm'
print(x, digits = max(3L, getOption("digits") - 3L), 
       signif.stars = getOption("show.signif.stars"), ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.lognlm_+3A_object">object</code></td>
<td>
<p> object of class <code>"lognreg"</code>.</p>
</td></tr>
<tr><td><code id="summary.lognlm_+3A_x">x</code></td>
<td>
<p>a <code>summary.segmented</code> object produced by <code>summary.segmented()</code>.</p>
</td></tr>
<tr><td><code id="summary.lognlm_+3A_digits">digits</code></td>
<td>
<p>controls number of digits printed in output.</p>
</td></tr>
<tr><td><code id="summary.lognlm_+3A_signif.stars">signif.stars</code></td>
<td>
<p>logical, should stars be printed on summary tables of coefficients?</p>
</td></tr>
<tr><td><code id="summary.lognlm_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to <code>vcov</code>, for instance <code>sandw=TRUE</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions compute and print some useful information relevant to <code>"lognlm"</code> fits, including point estimates, 
standard errors and p-values.
</p>


<h3>Value</h3>

<p>A list (similar to one returned by <code>lognlm</code> with additional components, such as the estimate standard errors and corresponding p-values.
</p>


<h3>Author(s)</h3>

<p>Vito Muggeo
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+lognlm">lognlm</a></code> and <code><a href="#topic+vcov.lognlm">vcov.lognlm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
n=20
s=.2
set.seed(10)      #just to get reproducible results..

#covariates
x&lt;-seq(.1,10,l=n) 
z&lt;-rnorm(n)

#response
mu&lt;- 10+.5*x- z  #linear regression function
y&lt;-rlnorm(n, log(mu)-s^2/2, s) #data..

o&lt;- lognlm(y~x+z) #the model
summary(o, sandw=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='vcov.lognlm'>
Covariance matrix for lognlm fits
</h2><span id='topic+vcov.lognlm'></span>

<h3>Description</h3>

<p>Computes covariance matrix of parameter estimates from a <code>lognlm</code> fit via the sandwich formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lognlm'
vcov(object, emp = FALSE, exH = TRUE, se = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.lognlm_+3A_object">object</code></td>
<td>

<p>a fitted model object of class <code>"lognlm"</code> returned by <code>lognlm()</code>
</p>
</td></tr>
<tr><td><code id="vcov.lognlm_+3A_emp">emp</code></td>
<td>

<p>logical; if <code>TRUE</code>, the &lsquo;meat&rsquo; (i.e the information matrix) is computed empirically by the outer product of the individual score contributions. 
</p>
</td></tr>
<tr><td><code id="vcov.lognlm_+3A_exh">exH</code></td>
<td>
<p>logical; if <code>TRUE</code> the <em>expected</em> (rather than the observed) hessian is used in the sandwich formula.
</p>
</td></tr>
<tr><td><code id="vcov.lognlm_+3A_se">se</code></td>
<td>

<p>logical; if <code>TRUE</code> the square root of the elements of the main diagonal are returned (rather than the whole matrix).
</p>
</td></tr>
<tr><td><code id="vcov.lognlm_+3A_...">...</code></td>
<td>

<p>additional arguments.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>object</code> has been obtained via <code>lognlm(.., lik=TRUE)</code> the returned covariance matrix (or standard errors only) refers to regression coefficients <em>and</em> the log response standard deviation. Otherwise (if <code>lik=FALSE</code> has been set), it includes entries relevant to regression coefficients only. The var-covariance matrix comes from the sandwich formula using <em>expected</em> (if <code>exH=TRUE</code>) or the observed (if <code>exH=FALSE</code>) hessian at solution. Some simulations under correct model specification show that <code>emp=TRUE</code> and <code>exH=FALSE</code> lead to somewhat more unstable standard errors.
</p>


<h3>Value</h3>

<p>The variance-covariance matrix of the parameter estimates, if <code>se=FALSE</code>; otherwise the square root of the main diagonal entries.
</p>


<h3>Note</h3>

<p>Currently for likelihood-based fits, <code>exH=FALSE</code> and <code>emp=TRUE</code> are always set.
</p>


<h3>Author(s)</h3>

<p>Vito Muggeo
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lognlm">lognlm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n=50
s=.3

#covariates
x&lt;-seq(.1,10,l=n) 
z&lt;-rnorm(n)
#response
mu&lt;- 10+.5*x- z  #linear regression function
y&lt;-rlnorm(n, log(mu)-s^2/2, s) #data..

o&lt;- lognlm(y~x+z, lik=TRUE) #the model
vcov(o) #the full covariance matrix 
vcov(o, se=TRUE) #st.errs only 

 
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
