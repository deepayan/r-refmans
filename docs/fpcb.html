<!DOCTYPE html><html><head><title>Help for package fpcb</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fpcb}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#arh_rkhs'><p>Autoregressive Hilbertian Model using RKHS</p></a></li>
<li><a href='#fdata_rkhs'><p>functional data in rkhs</p></a></li>
<li><a href='#fpcb-package'><p>Predictive confindence bands for functional time series forecasting</p></a></li>
<li><a href='#predict_rkhs'><p>Predict functional time series using ARH RKHS.</p></a></li>
<li><a href='#rk'><p>kernel function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Predictive Confidence Bands for Functional Time Series
Forecasting</td>
</tr>
<tr>
<td>Author:</td>
<td>Nicolás Hernández [aut, cre],
  Jairo Cugliari [aut, cre],
  Julien Jacques [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nicolás Hernández &lt;nicolashernandezb@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to represent functional objects under a Reproducing Kernel Hilbert Space (RKHS) framework as described 
  in Muñoz &amp; González (2010). Autoregressive Hilbertian Model for functional time series using RKHS and predictive confidence bands construction 
  as proposed in Hernández et al (2021).</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>FNN</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-06-04 11:28:11 UTC; jairo</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/nicolashernandezb/fpcb/issues">https://github.com/nicolashernandezb/fpcb/issues</a></td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-06-07 06:50:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='arh_rkhs'>Autoregressive Hilbertian Model using RKHS</h2><span id='topic+arh_rkhs'></span>

<h3>Description</h3>

<p>Estimates an autoregresive Hilbertian model of order 1 for functional time
series. The temporal dependence is estimated in the Hilbert projection space
which has a reproducing kernel as proposed in Hernández et al (2021) &lt;arXiv:2105.13627&gt; and
Wang et al (2020) &lt;arXiv:2011.13993&gt;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arh_rkhs(fdata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="arh_rkhs_+3A_fdata">fdata</code></td>
<td>
<p>an fdata object containing the functional objects and the
lambda coefficients of the d dimensional RKHS representation.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fdata</code></td>
<td>
<p>smoothed curves.</p>
</td></tr> <tr><td><code>lambda_cent</code></td>
<td>
<p>centered
coefficients of the d dimensional RKHS representation.</p>
</td></tr>
<tr><td><code>lambda_ce</code></td>
<td>
<p>average coefficients of the d dimensional RKHS
representation.</p>
</td></tr> <tr><td><code>rho</code></td>
<td>
<p>autocorrelation operator computed as:
<code class="reqn">Gamma_0</code><code class="reqn">Psi</code> = <code class="reqn">Gamma_1</code>. <code class="reqn">Gamma_0</code> correspond to the
Covariance and <code class="reqn">Gamma_0</code> correspond to the Cross-Covariance (of lag 1)
operators, both estimated using the coefficients <code class="reqn">lambda</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>N. Hernández and J. Cugliari
</p>


<h3>References</h3>

<p>N. Hernández, J. Cugliari, J. Jacques. Simultaneous Predictive
Bands for Functional Time Series using Minimum Entropy Sets. arXiv:2105.13627 (2021).
D. Wang, Z. Zhao, R. Willett, C. Y. Yau, Functional
autoregressive processes in reproducing kernel hilbert spaces, arXiv
preprint arXiv:2011.13993 (2020).
</p>

<hr>
<h2 id='fdata_rkhs'>functional data in rkhs</h2><span id='topic+fdata_rkhs'></span>

<h3>Description</h3>

<p>Representing functinal data using Reproducing Kernel Hilbert Spaces.
Approximate each curve with a smooth function using a kernel function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fdata_rkhs(curves, rk, gamma = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fdata_rkhs_+3A_curves">curves</code></td>
<td>
<p>a data matrix with observations (curves) in rows and the
discretizations points in columns.</p>
</td></tr>
<tr><td><code id="fdata_rkhs_+3A_rk">rk</code></td>
<td>
<p>kernek function rk object.</p>
</td></tr>
<tr><td><code id="fdata_rkhs_+3A_gamma">gamma</code></td>
<td>
<p>regularization parameter. Defaoult value = 1e-5.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With this function each function can be represented with a vector in R^d.
</p>


<h3>Value</h3>

<table>
<tr><td><code>data</code></td>
<td>
<p>input curves.</p>
</td></tr> <tr><td><code>fdata</code></td>
<td>
<p>smoothed curves.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>coefficients of the (stable) and d dimensional RKHS
representation.</p>
</td></tr> <tr><td><code>alpha</code></td>
<td>
<p>coefficients of the RKHS expansion.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>regularization parameter.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>N. Hernández and J. Cugliari
</p>


<h3>References</h3>

<p>A. Muñoz, J. González, Representing functional data using
support vector machines, Pattern Recognition Letters 31 (2010) 511–516. &lt;doi:10.1016/j.patrec.2009.07.014&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
t = 1:50
curves = matrix(sin(t)+rnorm(length(t)),nrow=1)
f.data &lt;- fdata_rkhs(curves, rk = rk(t,sigma = 0.01))
plot(t,curves, xlab='time', ylab='PM10 dataset', col='gray', lty=1, type='b')
lines(t,f.data$fdata, col='blue', lty=1)

</code></pre>

<hr>
<h2 id='fpcb-package'>Predictive confindence bands for functional time series forecasting</h2><span id='topic+fpcb-package'></span><span id='topic+fpcb'></span>

<h3>Description</h3>

<p>Functions to represent functional objects under a Reproducing Kernel Hilbert
Space (RKHS) framework as described in Muñoz &amp; González (2010). &lt;doi:10.1016/j.patrec.2009.07.014&gt;.
Autoregressive Hilbertian Model for functional time series using RKHS and
predictive confidence bands construction as proposed in Hernández et al
(2021) &lt;arXiv:2105.13627&gt;.
</p>


<h3>Author(s)</h3>

<p>Nicolás Hernández [aut, cre], Jairo Cugliari [aut, cre]<br />
</p>
<p>Mantainer: Nicolás Hernández &lt;nicolas.hernandez@mrc-bsu.cam.ac.uk&gt;
</p>


<h3>References</h3>

 <ul>
<li><p> A. Muñoz, J. González, Representing functional
data using support vector machines, Pattern Recognition Letters 31 (2010)
511–516. &lt;doi:10.1016/j.patrec.2009.07.014&gt;.
</p>
</li>
<li><p> Martos, G. et al (2018): Entropy Measures for Stochastic
Processes with Applications in Functional Anomaly Detection. Entropy 20(1):
33 (2018). &lt;doi:10.3390/e20010033&gt;.  </p>
</li>
<li><p> D. Wang, Z. Zhao, R. Willett, C. Y. Yau, Functional
autoregressive processes in reproducing kernel hilbert spaces, arXiv
preprint arXiv:2011.13993 (2020).  </p>
</li>
<li><p> N. Hernández, J. Cugliari, J.
Jacques. Simultaneous Predictive Bands for Functional Time Series using
Minimum Entropy Sets. arXiv:2105.13627 (2021). </p>
</li></ul>


<hr>
<h2 id='predict_rkhs'>Predict functional time series using ARH RKHS.</h2><span id='topic+predict_rkhs'></span>

<h3>Description</h3>

<p>using an ARH of order 1 obtain 1 step ahead forecast and 1-<code class="reqn">alpha</code>
predictive confidence bands for the forecasted function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_rkhs(
  model,
  newdata,
  bands = FALSE,
  B = 100,
  level = 0.95,
  kvec = round(sqrt(2 * B))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_rkhs_+3A_model">model</code></td>
<td>
<p>a arh_rkhs object containing the functional objects and the
lambda coefficients of the d dimensional RKHS representation and the
autocorrelation operator.</p>
</td></tr>
<tr><td><code id="predict_rkhs_+3A_newdata">newdata</code></td>
<td>
<p>an optional data frame in which to look for variables with
which to predict. If missing, the fitted values are used.</p>
</td></tr>
<tr><td><code id="predict_rkhs_+3A_bands">bands</code></td>
<td>
<p>logical variable indicating if the predictive confidence band
is computed. Default = FALSE.</p>
</td></tr>
<tr><td><code id="predict_rkhs_+3A_b">B</code></td>
<td>
<p>number of bootstrap replicates for the band construction. Needed if
bands = TRUE. Default = 100.</p>
</td></tr>
<tr><td><code id="predict_rkhs_+3A_level">level</code></td>
<td>
<p>confidence level for the band construction. Needed if bands =
TRUE. Default = 0.95.</p>
</td></tr>
<tr><td><code id="predict_rkhs_+3A_kvec">kvec</code></td>
<td>
<p>number of neighbour points to consider in the computation of the
minimum entropy set.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>forecast</code></td>
<td>
<p>1 step ahead forecast.</p>
</td></tr> <tr><td><code>fitted</code></td>
<td>
<p>fitted
values.</p>
</td></tr> <tr><td><code>UB</code></td>
<td>
<p>upper bound of the 1-<code class="reqn">alpha</code> predictive confidence
band.</p>
</td></tr> <tr><td><code>LB</code></td>
<td>
<p>lower bound of the 1-<code class="reqn">alpha</code> predictive confidence
band.</p>
</td></tr> <tr><td><code>bootsrap.pred</code></td>
<td>
<p>bootstrap pseudo replicates.</p>
</td></tr>
<tr><td><code>bootsrap.pred.inband</code></td>
<td>
<p>bootstrap pseudo replicates included in the
1-<code class="reqn">alpha</code> predictive confidence band.</p>
</td></tr> <tr><td><code>res</code></td>
<td>
<p>estimation residuals.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>N. Hernández and J. Cugliari
</p>


<h3>References</h3>

<p>N. Hernández, J. Cugliari, J. Jacques. Simultaneous Predictive
Bands for Functional Time Series using Minimum Entropy Sets. arXiv:2105.13627 (2021).
</p>

<hr>
<h2 id='rk'>kernel function</h2><span id='topic+rk'></span>

<h3>Description</h3>

<p>Computes the Gram matrix of the gaussian kernel over a grid of values and
computes its singular value decomposition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rk(grid, sigma = 1, r, tol = 1e-08)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rk_+3A_grid">grid</code></td>
<td>
<p>grid of points where the kernel function is evaluated.</p>
</td></tr>
<tr><td><code id="rk_+3A_sigma">sigma</code></td>
<td>
<p>is the temperature of the kernel (standard deviation)</p>
</td></tr>
<tr><td><code id="rk_+3A_r">r</code></td>
<td>
<p>the dimension of the basis system of the Gran matrix (K). If
missing then r is the rank of K.</p>
</td></tr>
<tr><td><code id="rk_+3A_tol">tol</code></td>
<td>
<p>A tolerance to keep the first d eigenvalues of A. Default =
1e-08.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>grid</code></td>
<td>
<p>grid of points where the kernel function is evaluated.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Kernel Gram matrix</p>
</td></tr> <tr><td><code>U</code></td>
<td>
<p>first r eigenvectors of K using svd.</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>first r eigenvectors of K using svd.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J. Cugliari and N. Hernández
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
grid = seq(0,1,,100)
rk(grid, sigma = 1)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
