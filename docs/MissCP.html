<!DOCTYPE html><html lang="en"><head><title>Help for package MissCP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MissCP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BIC'><p>BIC</p></a></li>
<li><a href='#BIC_threshold'><p>BIC_threshold</p></a></li>
<li><a href='#BTIE'><p>BTIE</p></a></li>
<li><a href='#constant_generation'><p>constant_generation</p></a></li>
<li><a href='#data_generation'><p>data_generation</p></a></li>
<li><a href='#first.step'><p>first.step</p></a></li>
<li><a href='#Heter_missing'><p>Heter_missing</p></a></li>
<li><a href='#imputation'><p>imputation</p></a></li>
<li><a href='#imputation2'><p>imputation2</p></a></li>
<li><a href='#MCAR'><p>MCAR</p></a></li>
<li><a href='#pred'><p>pred</p></a></li>
<li><a href='#pred.block'><p>pred.block</p></a></li>
<li><a href='#second.step'><p>second.step</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Change Point Detection with Missing Values</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Yanxi Liu [aut, cre],
  Abolfazl Safikhani [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yanxi Liu &lt;liuyanxi@ufl.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A four step change point detection method that can detect break points with the presence of missing values proposed by Liu and Safikhani (2023) <a href="https://drive.google.com/file/d/1a8sV3RJ8VofLWikTDTQ7W4XJ76cEj4Fg/view?usp=drive_link">https://drive.google.com/file/d/1a8sV3RJ8VofLWikTDTQ7W4XJ76cEj4Fg/view?usp=drive_link</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, mvtnorm, factoextra, Rcpp, ggplot2, glmnet</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-17 11:48:51 UTC; yanxiliu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-17 12:30:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='BIC'>BIC</h2><span id='topic+BIC'></span>

<h3>Description</h3>

<p>BIC  and HBIC function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIC(residual, phi)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIC_+3A_residual">residual</code></td>
<td>
<p>residual matrix</p>
</td></tr>
<tr><td><code id="BIC_+3A_phi">phi</code></td>
<td>
<p>estimated coefficient matrix of the model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object, which contains the followings
</p>

<dl>
<dt>BIC</dt><dd><p>BIC value</p>
</dd>
<dt>HBIC</dt><dd><p>HBIC value</p>
</dd>
</dl>


<hr>
<h2 id='BIC_threshold'>BIC_threshold</h2><span id='topic+BIC_threshold'></span>

<h3>Description</h3>

<p>BIC threshold for final parameter estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIC_threshold(
  beta.final,
  k,
  m.hat,
  brk,
  data_y,
  data_x = NULL,
  b_n = 2,
  nlam = 20
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIC_threshold_+3A_beta.final">beta.final</code></td>
<td>
<p>estimated parameter coefficient matrices</p>
</td></tr>
<tr><td><code id="BIC_threshold_+3A_k">k</code></td>
<td>
<p>dimensions of parameter coefficient matrices</p>
</td></tr>
<tr><td><code id="BIC_threshold_+3A_m.hat">m.hat</code></td>
<td>
<p>number of estimated change points</p>
</td></tr>
<tr><td><code id="BIC_threshold_+3A_brk">brk</code></td>
<td>
<p>vector of estimated change points</p>
</td></tr>
<tr><td><code id="BIC_threshold_+3A_data_y">data_y</code></td>
<td>
<p>input data matrix (response), with each column representing the time series component</p>
</td></tr>
<tr><td><code id="BIC_threshold_+3A_data_x">data_x</code></td>
<td>
<p>input data matrix (predictor), with each column 1</p>
</td></tr>
<tr><td><code id="BIC_threshold_+3A_b_n">b_n</code></td>
<td>
<p>the block size</p>
</td></tr>
<tr><td><code id="BIC_threshold_+3A_nlam">nlam</code></td>
<td>
<p>number of hyperparameters for grid search</p>
</td></tr>
</table>


<h3>Value</h3>

<p>lambda.val.best, the tuning parameter lambda selected by BIC.
</p>

<hr>
<h2 id='BTIE'>BTIE</h2><span id='topic+BTIE'></span>

<h3>Description</h3>

<p>Perform the BTIE algorithm to detect the structural breaks
in large scale high-dimensional mean shift models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BTIE(
  data_y,
  lambda.1.cv = NULL,
  lambda.2.cv = NULL,
  max.iteration = 100,
  tol = 10^(-2),
  block.size = NULL,
  refit = FALSE,
  optimal.block = TRUE,
  optimal.gamma.val = 1.5,
  block.range = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BTIE_+3A_data_y">data_y</code></td>
<td>
<p>input data matrix (response), with each column representing the time series component</p>
</td></tr>
<tr><td><code id="BTIE_+3A_lambda.1.cv">lambda.1.cv</code></td>
<td>
<p>tuning parmaeter lambda_1 for fused lasso</p>
</td></tr>
<tr><td><code id="BTIE_+3A_lambda.2.cv">lambda.2.cv</code></td>
<td>
<p>tuning parmaeter lambda_2 for fused lasso</p>
</td></tr>
<tr><td><code id="BTIE_+3A_max.iteration">max.iteration</code></td>
<td>
<p>max number of iteration for the fused lasso</p>
</td></tr>
<tr><td><code id="BTIE_+3A_tol">tol</code></td>
<td>
<p>tolerance for the fused lasso</p>
</td></tr>
<tr><td><code id="BTIE_+3A_block.size">block.size</code></td>
<td>
<p>the block size</p>
</td></tr>
<tr><td><code id="BTIE_+3A_refit">refit</code></td>
<td>
<p>logical; if TRUE, refit the model, if FALSE, use BIC to find a thresholding value and then output the parameter estimates without refitting. Default is FALSE.</p>
</td></tr>
<tr><td><code id="BTIE_+3A_optimal.block">optimal.block</code></td>
<td>
<p>logical; if TRUE, grid search to find optimal block size, if FALSE, directly use the default block size. Default is TRUE.</p>
</td></tr>
<tr><td><code id="BTIE_+3A_optimal.gamma.val">optimal.gamma.val</code></td>
<td>
<p>hyperparameter for optimal block size, if optimal.blocks == TRUE. Default is 1.5.</p>
</td></tr>
<tr><td><code id="BTIE_+3A_block.range">block.range</code></td>
<td>
<p>the search domain for optimal block size.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object, which contains the followings
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
n &lt;- 1000;
p &lt;- 50;
brk &lt;-  c(333, 666, n+1)
m &lt;- length(brk)
d &lt;- 5
constant.full &lt;- constant_generation(n, p, d, 50, brk)
e.sigma &lt;- as.matrix(1*diag(p))
data_y &lt;- data_generation(n = n, mu = constant.full, sigma = e.sigma, brk = brk)
data_y &lt;- as.matrix(data_y, ncol = p.y)
data_y_miss &lt;- MCAR(data_y, 0.3)
temp &lt;- BTIE(data_y_miss, optimal.block = FALSE, block.size = 30)
temp$cp.final
</code></pre>

<hr>
<h2 id='constant_generation'>constant_generation</h2><span id='topic+constant_generation'></span>

<h3>Description</h3>

<p>function to generate constant given jump size and break points
</p>


<h3>Usage</h3>

<pre><code class='language-R'>constant_generation(n, p, d, vns, brk)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="constant_generation_+3A_n">n</code></td>
<td>
<p>the sample size</p>
</td></tr>
<tr><td><code id="constant_generation_+3A_p">p</code></td>
<td>
<p>the data dimension</p>
</td></tr>
<tr><td><code id="constant_generation_+3A_d">d</code></td>
<td>
<p>the number of nonzero coeddficients</p>
</td></tr>
<tr><td><code id="constant_generation_+3A_vns">vns</code></td>
<td>
<p>the jump size. It can be a vector or a single value. If single value, it is same for all break points</p>
</td></tr>
<tr><td><code id="constant_generation_+3A_brk">brk</code></td>
<td>
<p>the break points' locations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the parameter matrix used to generate data
</p>

<hr>
<h2 id='data_generation'>data_generation</h2><span id='topic+data_generation'></span>

<h3>Description</h3>

<p>The function to generate mean shift data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_generation(n, mu, sigma, brk = n + 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data_generation_+3A_n">n</code></td>
<td>
<p>the number of data points</p>
</td></tr>
<tr><td><code id="data_generation_+3A_mu">mu</code></td>
<td>
<p>the matrix of mean parameter</p>
</td></tr>
<tr><td><code id="data_generation_+3A_sigma">sigma</code></td>
<td>
<p>covariance matrix of the white noise</p>
</td></tr>
<tr><td><code id="data_generation_+3A_brk">brk</code></td>
<td>
<p>vector of change points</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data_y matrix of generated mean shift data
</p>

<hr>
<h2 id='first.step'>first.step</h2><span id='topic+first.step'></span>

<h3>Description</h3>

<p>Perform the block fused lasso with thresholding to detect candidate break points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>first.step(
  data_y,
  data_x,
  lambda1,
  lambda2,
  max.iteration = max.iteration,
  tol = tol,
  blocks,
  cv.index,
  fixed_index = NULL,
  nonfixed_index = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="first.step_+3A_data_y">data_y</code></td>
<td>
<p>input data matrix Y, with each column representing the time series component</p>
</td></tr>
<tr><td><code id="first.step_+3A_data_x">data_x</code></td>
<td>
<p>input data matrix X</p>
</td></tr>
<tr><td><code id="first.step_+3A_lambda1">lambda1</code></td>
<td>
<p>tuning parmaeter lambda_1 for fused lasso</p>
</td></tr>
<tr><td><code id="first.step_+3A_lambda2">lambda2</code></td>
<td>
<p>tuning parmaeter lambda_2 for fused lasso</p>
</td></tr>
<tr><td><code id="first.step_+3A_max.iteration">max.iteration</code></td>
<td>
<p>max number of iteration for the fused lasso</p>
</td></tr>
<tr><td><code id="first.step_+3A_tol">tol</code></td>
<td>
<p>tolerance for the fused lasso</p>
</td></tr>
<tr><td><code id="first.step_+3A_blocks">blocks</code></td>
<td>
<p>the blocks</p>
</td></tr>
<tr><td><code id="first.step_+3A_cv.index">cv.index</code></td>
<td>
<p>the index of time points for cross-validation</p>
</td></tr>
<tr><td><code id="first.step_+3A_fixed_index">fixed_index</code></td>
<td>
<p>index for linear regression model with only partial compoenents change.</p>
</td></tr>
<tr><td><code id="first.step_+3A_nonfixed_index">nonfixed_index</code></td>
<td>
<p>index for linear regression model with only partial compoenents change.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object, which contains the followings
</p>

<dl>
<dt>jump.l2</dt><dd><p>estimated jump size in L2 norm</p>
</dd>
<dt>jump.l1</dt><dd><p>estimated jump size in L1 norm</p>
</dd>
<dt>pts.list</dt><dd><p>estimated change points in the first step</p>
</dd>
<dt>beta.full</dt><dd><p>estimated parameters in the first step</p>
</dd>
</dl>


<hr>
<h2 id='Heter_missing'>Heter_missing</h2><span id='topic+Heter_missing'></span>

<h3>Description</h3>

<p>function to do the missing assuming the missing completely at random
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Heter_missing(data, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Heter_missing_+3A_data">data</code></td>
<td>
<p>data before the missing case</p>
</td></tr>
<tr><td><code id="Heter_missing_+3A_alpha">alpha</code></td>
<td>
<p>the list of percentage of missing compared to whole data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the data matrix with missing values
</p>

<hr>
<h2 id='imputation'>imputation</h2><span id='topic+imputation'></span>

<h3>Description</h3>

<p>function to do the imputation based on block size
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imputation(data, block.size)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="imputation_+3A_data">data</code></td>
<td>
<p>data before the imputation</p>
</td></tr>
<tr><td><code id="imputation_+3A_block.size">block.size</code></td>
<td>
<p>the block size that are used to impute the missing</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the data matrix without missing values after imputation
</p>

<hr>
<h2 id='imputation2'>imputation2</h2><span id='topic+imputation2'></span>

<h3>Description</h3>

<p>function to do the imputation based on change point candidate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imputation2(data, cp.candidate)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="imputation2_+3A_data">data</code></td>
<td>
<p>data before the imputation</p>
</td></tr>
<tr><td><code id="imputation2_+3A_cp.candidate">cp.candidate</code></td>
<td>
<p>the change point candidate that are used to impute the missing</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the data matrix without missing values after imputation
</p>

<hr>
<h2 id='MCAR'>MCAR</h2><span id='topic+MCAR'></span>

<h3>Description</h3>

<p>function to do the missing assuming the missing completely at random
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCAR(data, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MCAR_+3A_data">data</code></td>
<td>
<p>data before the missing case</p>
</td></tr>
<tr><td><code id="MCAR_+3A_alpha">alpha</code></td>
<td>
<p>the percentage of missing compared to whole data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the data matrix with missing values
</p>

<hr>
<h2 id='pred'>pred</h2><span id='topic+pred'></span>

<h3>Description</h3>

<p>function to do the prediction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred(X, phi, j, p.x, p.y, h = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pred_+3A_x">X</code></td>
<td>
<p>data for prediction</p>
</td></tr>
<tr><td><code id="pred_+3A_phi">phi</code></td>
<td>
<p>parameter matrix</p>
</td></tr>
<tr><td><code id="pred_+3A_j">j</code></td>
<td>
<p>the start time point for prediction</p>
</td></tr>
<tr><td><code id="pred_+3A_p.x">p.x</code></td>
<td>
<p>the dimension of data X</p>
</td></tr>
<tr><td><code id="pred_+3A_p.y">p.y</code></td>
<td>
<p>the dimension of data Y</p>
</td></tr>
<tr><td><code id="pred_+3A_h">h</code></td>
<td>
<p>the length of observation to predict</p>
</td></tr>
</table>


<h3>Value</h3>

<p>prediction matrix
</p>

<hr>
<h2 id='pred.block'>pred.block</h2><span id='topic+pred.block'></span>

<h3>Description</h3>

<p>Prediction function (block)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred.block(X, phi, j, p.x, p.y, h)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pred.block_+3A_x">X</code></td>
<td>
<p>data for prediction</p>
</td></tr>
<tr><td><code id="pred.block_+3A_phi">phi</code></td>
<td>
<p>parameter matrix</p>
</td></tr>
<tr><td><code id="pred.block_+3A_j">j</code></td>
<td>
<p>the start time point for prediction</p>
</td></tr>
<tr><td><code id="pred.block_+3A_p.x">p.x</code></td>
<td>
<p>the dimension of data X</p>
</td></tr>
<tr><td><code id="pred.block_+3A_p.y">p.y</code></td>
<td>
<p>the dimension of data Y</p>
</td></tr>
<tr><td><code id="pred.block_+3A_h">h</code></td>
<td>
<p>the length of observation to predict</p>
</td></tr>
</table>


<h3>Value</h3>

<p>prediction matrix
</p>

<hr>
<h2 id='second.step'>second.step</h2><span id='topic+second.step'></span>

<h3>Description</h3>

<p>Reimputate the missing values and perform the exhaustive search to &quot;thin out&quot; redundant break points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>second.step(
  data_y,
  data_x,
  max.iteration = max.iteration,
  tol = tol,
  cp.first,
  beta.est,
  blocks,
  data_y_miss
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="second.step_+3A_data_y">data_y</code></td>
<td>
<p>input data matrix, with each column representing the time series component</p>
</td></tr>
<tr><td><code id="second.step_+3A_data_x">data_x</code></td>
<td>
<p>input data matrix</p>
</td></tr>
<tr><td><code id="second.step_+3A_max.iteration">max.iteration</code></td>
<td>
<p>max number of iteration for the fused lasso</p>
</td></tr>
<tr><td><code id="second.step_+3A_tol">tol</code></td>
<td>
<p>tolerance for the fused lasso</p>
</td></tr>
<tr><td><code id="second.step_+3A_cp.first">cp.first</code></td>
<td>
<p>the selected break points after the first step</p>
</td></tr>
<tr><td><code id="second.step_+3A_beta.est">beta.est</code></td>
<td>
<p>the estiamted parameters by block fused lasso</p>
</td></tr>
<tr><td><code id="second.step_+3A_blocks">blocks</code></td>
<td>
<p>the blocks</p>
</td></tr>
<tr><td><code id="second.step_+3A_data_y_miss">data_y_miss</code></td>
<td>
<p>the data y matrix before the first imputation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object, which contains the followings
</p>

<dl>
<dt>cp.final</dt><dd><p>a set of selected break point after the exhaustive search step</p>
</dd>
<dt>beta.hat.list</dt><dd><p>the estimated coefficient matrix for each segmentation</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
