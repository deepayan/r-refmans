<!DOCTYPE html><html><head><title>Help for package qqconf</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {qqconf}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#between'><p>Shorthand for two numerical comparisons</p></a></li>
<li><a href='#check_bounds_one_sided'><p>Check Validity of One-Sided Bounds</p></a></li>
<li><a href='#check_bounds_two_sided'><p>Check Validity of Two-Sided Bounds</p></a></li>
<li><a href='#estimate_params_from_data'><p>Estimate Parameters from Data</p></a></li>
<li><a href='#get_asymptotic_approx_corrected_alpha'><p>Calculates Approximate Local Level</p></a></li>
<li><a href='#get_best_available_prob_pts_method'><p>Get Best Available Method for Probability Points</p></a></li>
<li><a href='#get_bounds_one_sided'><p>Calculates Rejection Region of One-Sided Equal Local Levels Test</p></a></li>
<li><a href='#get_bounds_two_sided'><p>Calculates Rejection Region of Two-Sided Equal Local Levels Test.</p></a></li>
<li><a href='#get_extended_quantile'><p>Get Quantile for First and Last Point of QQ or PP Plot</p></a></li>
<li><a href='#get_level_from_bounds_one_sided'><p>Calculates Global Significance Level From Simultaneous One-Sided Bounds for Rejection Region</p></a></li>
<li><a href='#get_level_from_bounds_two_sided'><p>Calculates Global Significance Level From Simultaneous Two-Sided Bounds for Rejection Region</p></a></li>
<li><a href='#get_mass_name_from_distr'><p>Convert R Distribution Function to MASS Distribution Name</p></a></li>
<li><a href='#get_qq_band'><p>Create QQ Plot Testing Band</p></a></li>
<li><a href='#get_qq_distribution_from_pp_distribution'><p>Get Quantile Distribution from Probability Distribution</p></a></li>
<li><a href='#monte_carlo_two_sided'><p>Monte Carlo Simulation for Two-Sided Test</p></a></li>
<li><a href='#pp_conf_plot'><p>PP Plot with Simultaneous and Pointwise Testing Bounds.</p></a></li>
<li><a href='#qq_conf_plot'><p>QQ Plot with Simultaneous and Pointwise Testing Bounds.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Creates Simultaneous Testing Bands for QQ-Plots</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functionality for creating Quantile-Quantile (QQ) and Probability-Probability (PP) plots with simultaneous 
    testing bands to asses significance of sample deviation from a reference distribution &lt;<a href="https://doi.org/10.18637%2Fjss.v106.i10">doi:10.18637/jss.v106.i10</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>fftw3 (&gt;= 3.1.2)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS (&ge; 7.3-50), robustbase (&ge; 0.93-4), Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, distr (&ge; 2.8.0)</td>
</tr>
<tr>
<td>Collate:</td>
<td>'one_sided.R' 'ppplot.R' 'qqconf-package.R' 'qqplot.R'
'RcppExports.R' 'two_sided.R' 'utils.R'</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/eweine/qqconf">https://github.com/eweine/qqconf</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/eweine/qqconf/issues">https://github.com/eweine/qqconf/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-14 19:38:46 UTC; ericweine</td>
</tr>
<tr>
<td>Author:</td>
<td>Eric Weine [aut, cre],
  Mary Sara McPeek [aut],
  Abney Mark [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Eric Weine &lt;ericweine15@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-14 23:00:21 UTC</td>
</tr>
</table>
<hr>
<h2 id='between'>Shorthand for two numerical comparisons</h2><span id='topic+between'></span>

<h3>Description</h3>

<p>Shorthand for two numerical comparisons
</p>


<h3>Usage</h3>

<pre><code class='language-R'>between(x, gte, lte)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="between_+3A_x">x</code></td>
<td>
<p>numeric value</p>
</td></tr>
<tr><td><code id="between_+3A_gte">gte</code></td>
<td>
<p>lower bound</p>
</td></tr>
<tr><td><code id="between_+3A_lte">lte</code></td>
<td>
<p>upper bound</p>
</td></tr>
</table>


<h3>Value</h3>

<p>boolean
</p>

<hr>
<h2 id='check_bounds_one_sided'>Check Validity of One-Sided Bounds</h2><span id='topic+check_bounds_one_sided'></span>

<h3>Description</h3>

<p>Given bounds for a one sided test, this checks that none of
the bounds fall outside of [0, 1].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_bounds_one_sided(upper_bounds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_bounds_one_sided_+3A_upper_bounds">upper_bounds</code></td>
<td>
<p>Numeric vector where the ith component is the upper bound
for the ith order statistic.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>

<hr>
<h2 id='check_bounds_two_sided'>Check Validity of Two-Sided Bounds</h2><span id='topic+check_bounds_two_sided'></span>

<h3>Description</h3>

<p>Given bounds for a two sided test, this checks that none of
the bounds fall outside of [0, 1] and that all upper bounds
are greater than the corresponding lower bounds.
This also ensures the the length of the bounds are the same.
This not meant to be called by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_bounds_two_sided(lower_bounds, upper_bounds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_bounds_two_sided_+3A_lower_bounds">lower_bounds</code></td>
<td>
<p>Numeric vector where the ith component is the lower bound
for the ith order statistic.</p>
</td></tr>
<tr><td><code id="check_bounds_two_sided_+3A_upper_bounds">upper_bounds</code></td>
<td>
<p>Numeric vector where the ith component is the lower bound
for the ith order statistic.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>

<hr>
<h2 id='estimate_params_from_data'>Estimate Parameters from Data</h2><span id='topic+estimate_params_from_data'></span>

<h3>Description</h3>

<p>For select distributions, parameters are estimated from data. Generally,
the MLEs are used. However, for the normal distribution we use robust
estimators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_params_from_data(distr_name, obs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_params_from_data_+3A_distr_name">distr_name</code></td>
<td>
<p><code>MASS</code> name of distribution</p>
</td></tr>
<tr><td><code id="estimate_params_from_data_+3A_obs">obs</code></td>
<td>
<p>observation vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of distribution parameters
</p>

<hr>
<h2 id='get_asymptotic_approx_corrected_alpha'>Calculates Approximate Local Level</h2><span id='topic+get_asymptotic_approx_corrected_alpha'></span>

<h3>Description</h3>

<p>This function uses the approximation from Gontscharuk &amp; Finner's Asymptotics of
goodness-of-fit tests based on minimum p-value statistics (2017) to approximate
local levels for finite sample size. We use these authors constants for <code class="reqn">\alpha</code> = .1, and .05,
and for <code class="reqn">\alpha</code> = .01 we use a slightly different approximation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_asymptotic_approx_corrected_alpha(n, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_asymptotic_approx_corrected_alpha_+3A_n">n</code></td>
<td>
<p>Number of tests to do</p>
</td></tr>
<tr><td><code id="get_asymptotic_approx_corrected_alpha_+3A_alpha">alpha</code></td>
<td>
<p>Global type I error rate <code class="reqn">\alpha</code> of the tests</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Approximate local level
</p>

<hr>
<h2 id='get_best_available_prob_pts_method'>Get Best Available Method for Probability Points</h2><span id='topic+get_best_available_prob_pts_method'></span>

<h3>Description</h3>

<p>Determines name of best method for obtaining expected points for a qq or pp
plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_best_available_prob_pts_method(dist_name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_best_available_prob_pts_method_+3A_dist_name">dist_name</code></td>
<td>
<p>character name of distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character name of best expected points method
</p>

<hr>
<h2 id='get_bounds_one_sided'>Calculates Rejection Region of One-Sided Equal Local Levels Test</h2><span id='topic+get_bounds_one_sided'></span>

<h3>Description</h3>

<p>The context is that n i.i.d. observations are assumed to be drawn
from some distribution on the unit interval with c.d.f. F(x), and it is
desired to test the null hypothesis that F(x) = x for all x in (0,1),
referred to as the &quot;global null hypothesis,&quot; against the alternative F(x) &gt; x for at least one x in (0, 1).
An &quot;equal local levels&quot; test is used, in which each of the n order statistics is
tested for significant deviation from its null distribution by a one-sided test
with significance level <code class="reqn">\eta</code>.  The global null hypothesis is rejected if at
least one of the order statistic tests is rejected at level eta, where eta is
chosen so that the significance level of the global test is alpha.
Given the size of the dataset n and the desired global significance level alpha,
this function calculates the local level eta and the acceptance/rejection regions for the test.
The result is a set of lower bounds, one for each order statistic.
If at least one order statistic falls below the corresponding bound,
the global test is rejected.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_bounds_one_sided(alpha, n, tol = 1e-08, max_it = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_bounds_one_sided_+3A_alpha">alpha</code></td>
<td>
<p>Desired global significance level of the test.</p>
</td></tr>
<tr><td><code id="get_bounds_one_sided_+3A_n">n</code></td>
<td>
<p>Size of the dataset.</p>
</td></tr>
<tr><td><code id="get_bounds_one_sided_+3A_tol">tol</code></td>
<td>
<p>(Optional) Relative tolerance of the <code>alpha</code> level of the
simultaneous test. Defaults to 1e-8.</p>
</td></tr>
<tr><td><code id="get_bounds_one_sided_+3A_max_it">max_it</code></td>
<td>
<p>(Optional) Maximum number of iterations of Binary Search Algorithm
used to find the bounds. Defaults to 100 which should be much larger than necessary
for a reasonable tolerance.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components
</p>

<ul>
<li><p> bound - Numeric vector of length <code>n</code> containing the lower bounds of the acceptance regions for the test of each order statistic.
</p>
</li>
<li><p> x - Numeric vector of length <code>n</code> containing the expectation of each order statistic. These are the x-coordinates for the bounds if used in a qq-plot.
The value is <code>c(1:n) / (n + 1)</code>.
</p>
</li>
<li><p> local_level - Significance level <code class="reqn">\eta</code> of the local test on each individual order statistic. It is equal for all order
statistics and will be less than <code>alpha</code> for all <code>n</code> &gt; 1.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>get_bounds_one_sided(alpha = .05, n = 10, max_it = 50)


</code></pre>

<hr>
<h2 id='get_bounds_two_sided'>Calculates Rejection Region of Two-Sided Equal Local Levels Test.</h2><span id='topic+get_bounds_two_sided'></span>

<h3>Description</h3>

<p>The context is that n i.i.d. observations are assumed to be drawn
from some distribution on the unit interval with c.d.f. F(x), and it is
desired to test the null hypothesis that F(x) = x for all x in (0,1),
referred to as the &quot;global null hypothesis,&quot; against a two-sided alternative.
An &quot;equal local levels&quot; test is used, in which each of the n order statistics is
tested for significant deviation from its null distribution by a 2-sided test
with significance level <code class="reqn">\eta</code>.  The global null hypothesis is rejected if at
least one of the order statistic tests is rejected at level <code class="reqn">\eta</code>, where <code class="reqn">\eta</code> is
chosen so that the significance level of the global test is alpha.
Given the size of the dataset n and the desired global significance level alpha,
this function calculates the local level <code class="reqn">\eta</code> and the acceptance/rejection regions for the test.
There are a set of n intervals, one for each order statistic.
If at least one order statistic falls outside the corresponding interval,
the global test is rejected.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_bounds_two_sided(
  alpha,
  n,
  tol = 1e-08,
  max_it = 100,
  method = c("best_available", "approximate", "search")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_bounds_two_sided_+3A_alpha">alpha</code></td>
<td>
<p>Desired global significance level of the test.</p>
</td></tr>
<tr><td><code id="get_bounds_two_sided_+3A_n">n</code></td>
<td>
<p>Size of the dataset.</p>
</td></tr>
<tr><td><code id="get_bounds_two_sided_+3A_tol">tol</code></td>
<td>
<p>(optional) Relative tolerance of the <code>alpha</code> level of the
simultaneous test. Defaults to 1e-8. Used only if <code>method</code> is set to
&quot;search&quot; or if method is set to &quot;best_available&quot; and the best available
method is a search.</p>
</td></tr>
<tr><td><code id="get_bounds_two_sided_+3A_max_it">max_it</code></td>
<td>
<p>(optional) Maximum number of iterations of Binary Search Algorithm
used to find the bounds. Defaults to 100 which should be much larger than necessary
for a reasonable tolerance. Used only if <code>method</code> is set to
&quot;search&quot; or if method is set to &quot;best_available&quot; and the best available
method is a search.</p>
</td></tr>
<tr><td><code id="get_bounds_two_sided_+3A_method">method</code></td>
<td>
<p>(optional) Argument indicating if the calculation should be done using a highly
accurate approximation, &quot;approximate&quot;, or if the calculations should be done using an exact
binary search calculation, &quot;search&quot;. The default is &quot;best_available&quot; (recommended), which uses the exact search
when either (i) the approximation isn't available or (ii) the approximation is available but isn't highly accurate and the search method
isn't prohibitively slow (occurs for small to moderate <code>n</code> with <code>alpha</code> = .1).
Of note, the approximate method is only available for alpha values of .1, .05, and .01. In the case of alpha = .05 or .01, the
approximation is highly accurate for all values of <code>n</code> up to at least <code>10^6</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components
</p>

<ul>
<li><p> lower_bound - Numeric vector of length <code>n</code> containing the lower bounds
for the acceptance regions of the test of each order statistic.
</p>
</li>
<li><p> upper_bound - Numeric vector of length <code>n</code> containing the upper bounds
for the acceptance regions of the test of each order statistic.
</p>
</li>
<li><p> x - Numeric vector of length <code>n</code> containing the expectation of each order statistic.
These are the x-coordinates for the bounds if used in a pp-plot.
The value is <code>c(1:n) / (n + 1)</code>.
</p>
</li>
<li><p> local_level - Significance level <code class="reqn">\eta</code> of the local test on each individual order statistic. It is equal for all order
statistics and will be less than <code>alpha</code> for all <code>n</code> &gt; 1.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>get_bounds_two_sided(alpha = .05, n = 100)

</code></pre>

<hr>
<h2 id='get_extended_quantile'>Get Quantile for First and Last Point of QQ or PP Plot</h2><span id='topic+get_extended_quantile'></span>

<h3>Description</h3>

<p>Get Quantile for First and Last Point of QQ or PP Plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_extended_quantile(exp_pts_method, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_extended_quantile_+3A_exp_pts_method">exp_pts_method</code></td>
<td>
<p>method used to derive expected points</p>
</td></tr>
<tr><td><code id="get_extended_quantile_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with low and high point
</p>

<hr>
<h2 id='get_level_from_bounds_one_sided'>Calculates Global Significance Level From Simultaneous One-Sided Bounds for Rejection Region</h2><span id='topic+get_level_from_bounds_one_sided'></span>

<h3>Description</h3>

<p>For a one-sided test of uniformity of i.i.d. observations on the unit interval,
this function will determine the significance level as a function of the rejection region.
Suppose <code class="reqn">n</code> observations are drawn i.i.d. from some CDF F(x) on the unit interval,
and it is desired to test the null hypothesis that F(x) = x for all x in (0, 1) against
the one-sided alternative F(x) &gt; x. Suppose the acceptance region for the test is
described by a set of lower bounds, one for each order statistic.
Given the lower bounds, this function calculates the significance level of the test where the
null hypothesis is rejected if at least one of the order statistics
falls below its corresponding lower bound.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_level_from_bounds_one_sided(bounds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_level_from_bounds_one_sided_+3A_bounds">bounds</code></td>
<td>
<p>Numeric vector where the ith component is the lower bound
for the ith order statistic. The components must lie in [0, 1], and each component must be
greater than or equal to the previous one.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses the method of Moscovich and Nadler (2016) as implemented in Crossprob (Moscovich 2020).
</p>


<h3>Value</h3>

<p>Global significance level
</p>


<h3>References</h3>


<ul>
<li><p><a href="https://www.sciencedirect.com/science/article/abs/pii/S0167715216302802">
Moscovich, Amit, and Boaz Nadler. &quot;Fast calculation of boundary crossing probabilities for Poisson processes.&quot;
Statistics &amp; Probability Letters 123 (2017): 177-182.</a>
</p>
</li>
<li><p><a href="https://github.com/mosco/crossing-probability">
Amit Moscovich (2020). Fast calculation of p-values for one-sided
Kolmogorov-Smirnov type statistics. arXiv:2009.04954</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># For X1, X2, X3 i.i.d. unif(0, 1),
# calculate 1 - P(X(1) &gt; .1 and X(2) &gt; .5 and X(3) &gt; .8),
# where X(1), X(2), and X(3) are the order statistics.
get_level_from_bounds_one_sided(bounds = c(.1, .5, .8))

</code></pre>

<hr>
<h2 id='get_level_from_bounds_two_sided'>Calculates Global Significance Level From Simultaneous Two-Sided Bounds for Rejection Region</h2><span id='topic+get_level_from_bounds_two_sided'></span>

<h3>Description</h3>

<p>For a test of uniformity of i.i.d. observations on the unit interval, this function will determine the significance
level as a function of the rejection region. Suppose <code class="reqn">n</code> observations are drawn i.i.d. from some CDF F(x) on the unit interval,
and it is desired to test the null hypothesis that F(x) = x for all x in (0, 1) against a two-sided alternative.
Suppose the acceptance region for the test is described by a set of intervals, one for each order statistic.
Given the bounds for these intervals, this function calculates the significance level of the test where the
null hypothesis is rejected if at least one of the order statistics is outside its corresponding interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_level_from_bounds_two_sided(lower_bounds, upper_bounds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_level_from_bounds_two_sided_+3A_lower_bounds">lower_bounds</code></td>
<td>
<p>Numeric vector where the ith component is the lower bound for the acceptance interval
for the ith order statistic. The components must lie in [0, 1], and each component must be greater than
or equal to the previous one.</p>
</td></tr>
<tr><td><code id="get_level_from_bounds_two_sided_+3A_upper_bounds">upper_bounds</code></td>
<td>
<p>Numeric vector of the same length as <code>lower_bounds</code> where the ith component is the upper bound
for the acceptance interval for the ith order statistic. The components must lie in [0, 1], and each component must be
greater than or equal to the previous one. In addition,
the ith component of <code>upper_bounds</code> must be greater than or equal to the ith component of <code>lower_bounds</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses the method of Moscovich and Nadler (2016) as implemented in Crossprob (Moscovich 2020).
</p>


<h3>Value</h3>

<p>Global Significance Level <code class="reqn">\alpha</code>
</p>


<h3>References</h3>


<ul>
<li><p><a href="https://www.sciencedirect.com/science/article/abs/pii/S0167715216302802">
Moscovich, Amit, and Boaz Nadler. &quot;Fast calculation of boundary crossing probabilities for Poisson processes.&quot;
Statistics &amp; Probability Letters 123 (2017): 177-182.</a>
</p>
</li>
<li><p><a href="https://github.com/mosco/crossing-probability">
Amit Moscovich (2020). Fast calculation of p-values for one-sided
Kolmogorov-Smirnov type statistics. arXiv:2009.04954</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># For X1, X2 iid unif(0,1), calculate 1 - P(.1 &lt; min(X1, X2) &lt; .6 and .5 &lt; max(X1, X2) &lt; .9)
get_level_from_bounds_two_sided(lower_bounds = c(.1, .5), upper_bounds = c(.6, .9))

# Finds the global significance level corresponding to the local level eta.
# Suppose we reject the null hypothesis that X1, ..., Xn are iid unif(0, 1) if and only if at least
# one of the order statistics X(i) is significantly different from
# its null distribution based on a level-eta
# two-sided test, i.e. we reject if and only if X(i) is outside the interval
# (qbeta(eta/2, i, n - i + 1), qbeta(1 - eta/2, i, n - i + 1)) for at least one i.
# The lines of code below calculate the global significance level of
# the test (which is necessarily larger than eta if n &gt; 1).
n &lt;- 100
eta &lt;- .05
lb &lt;- qbeta(eta / 2, c(1:n), c(n:1))
ub &lt;- qbeta(1 - eta / 2, c(1:n), c(n:1))
get_level_from_bounds_two_sided(lower_bounds = lb, upper_bounds = ub)

</code></pre>

<hr>
<h2 id='get_mass_name_from_distr'>Convert R Distribution Function to MASS Distribution Name</h2><span id='topic+get_mass_name_from_distr'></span>

<h3>Description</h3>

<p>Convert R Distribution Function to MASS Distribution Name
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_mass_name_from_distr(distr, band_type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_mass_name_from_distr_+3A_distr">distr</code></td>
<td>
<p>R distribution function (e.g. qnorm or pnorm)</p>
</td></tr>
<tr><td><code id="get_mass_name_from_distr_+3A_band_type">band_type</code></td>
<td>
<p>one of &quot;qq&quot; (for quantile functions) or &quot;pp&quot; (
for probability functions).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>string of MASS distribution name
</p>

<hr>
<h2 id='get_qq_band'>Create QQ Plot Testing Band</h2><span id='topic+get_qq_band'></span>

<h3>Description</h3>

<p>Flexible interface for creating a testing band for a Quantile-Quantile (QQ)
plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_qq_band(
  n,
  obs,
  alpha = 0.05,
  distribution = qnorm,
  dparams = list(),
  ell_params = list(),
  band_method = c("ell", "ks", "pointwise"),
  prob_pts_method = c("best_available", "normal", "uniform", "median")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_qq_band_+3A_n">n</code>, <code id="get_qq_band_+3A_obs">obs</code></td>
<td>
<p>either a number of observations (specified by setting <code>n</code>),
or a numeric vector of observations (specified by setting <code>obs</code>). One
argument must be specified. If all parameters of <code>distribution</code>
are known, then the testing band only depends on the number of observations <code>n</code>.
Thus, providing <code>n</code> is simpler when all parameters
of <code>distribution</code> are known and specified via <code>dparams</code>
(or when using all default parameter choices of <code>distribution</code> is desired).
If estimating parameters from the data is preferred, <code>obs</code> should be
specified and estimation will take place as described in the documentation for
argument <code>dparams</code>.</p>
</td></tr>
<tr><td><code id="get_qq_band_+3A_alpha">alpha</code></td>
<td>
<p>(optional) desired significance level of the testing band. If <code>method</code>
is set to <code>"ell"</code> or <code>"ks"</code>, then this is the global significance
level of the testing band. If <code>method</code> is set to <code>"pointwise"</code>, then
the band is equivalent to simply conducting a level <code>alpha</code> test on each
order statistic individually. Pointwise bands will generally have much
larger global Type I error than <code>alpha</code>. Defaults to <code>.05</code>.</p>
</td></tr>
<tr><td><code id="get_qq_band_+3A_distribution">distribution</code></td>
<td>
<p>The quantile function for the specified distribution.
Defaults to <code>qnorm</code>, which is appropriate for testing normality
of the observations in a QQ plot.</p>
</td></tr>
<tr><td><code id="get_qq_band_+3A_dparams">dparams</code></td>
<td>
<p>(optional)  List of additional arguments for the <code>distribution</code> function
(e.g. df=1). If <code>obs</code> is not specified and this argument is left blank,
the default arguments of <code>distribution</code> are used. If <code>obs</code> is specified and this argument is left blank,
parameters are estimated from the data (except if <code>distribution</code> is set to <code>qunif</code>,
in which case no estimation occurs and the default parameters are <code>max = 1</code> and <code>min = 0</code>).
For the normal distribution, we estimate the mean as the median and the standard deviation as <code class="reqn">Sn</code> from the paper by Rousseeuw and Croux 1993
&quot;Alternatives to the Median Absolute Deviation&quot;. For all other distributions besides uniform and normal,
the code uses MLE to estimate the parameters. Note that if any parameters of the distribution are specified
in <code>dparams</code>, parameter estimation will not be performed
on the unspecified parameters, and instead they will take on the default values
set by <code>distribution</code>.</p>
</td></tr>
<tr><td><code id="get_qq_band_+3A_ell_params">ell_params</code></td>
<td>
<p>(optional) list of optional arguments for <code>get_bounds_two_sided</code>
(i.e. <code>tol</code>, <code>max_it</code>, <code>method</code>). Only used if <code>method</code>
is set to <code>"ell"</code></p>
</td></tr>
<tr><td><code id="get_qq_band_+3A_band_method">band_method</code></td>
<td>
<p>(optional) method for creating the testing band. The default,
<code>"ell"</code> uses the equal local levels method
(see <code>get_bounds_two_sided</code> for more information). <code>"ks"</code> uses
the Kolmogorov-Smirnov test. <code>"pointwise"</code> uses a pointwise band (see
documentation for argument <code>alpha</code> for more information). <code>"ell"</code>
is recommended and is the default.</p>
</td></tr>
<tr><td><code id="get_qq_band_+3A_prob_pts_method">prob_pts_method</code></td>
<td>
<p>(optional) method used to get probability points for
use in a QQ plot. The quantile function will be applied to these points to
get the expected values.  When this argument is set to <code>"normal"</code>
(recommended for a normal QQ plot) <code>ppoints(n)</code> will be used,  which is what
most other plotting software uses. When this argument is set to <code>"uniform"</code>
(recommended for a uniform QQ plot) <code>ppoints(n, a=0)</code>, which are the expected
values of the order statistics of Uniform(0, 1), will be used.  Finally,
when this argument is set to <code>"median"</code> (recommended for all other
distributions) <code>qbeta(.5, c(1:n), c(n:1))</code> will be used. Under the default
setting, <code>"best_available"</code>, the probability points as recommended above will
be used. Note that <code>"median"</code> is suitable for all distributions and is
particularly recommended when alpha is large.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components
</p>

<ul>
<li><p> lower_bound - Numeric vector of length <code>n</code> containing the lower bounds
for the acceptance regions of the test corresponding to each order statistic.
These form the lower boundary of the testing band for the QQ-plot.
</p>
</li>
<li><p> upper_bound - Numeric vector of length <code>n</code> containing the upper bounds
for the acceptance regions of the test corresponding to each order statistic.
These form the upper boundary of the testing band for the QQ-plot.
</p>
</li>
<li><p> expected_value - Numeric vector of length <code>n</code> containing the
exact or approximate expectation (or median) of each order statistic, depending on how
<code>prob_pts_method</code> is set.
These are the x-coordinates for both the bounds and the data points
if used in a qq-plot. Note that
if adding a band to an already existing plot, it is essential that the same
x-coordinates be used for the bounds as were used to plot the data. Thus,
if some other x-coordinates have been used to plot the data those same
x-coordinates should always be used instead of this vector to plot the bounds.
</p>
</li>
<li><p> dparams - List of arguments used to apply <code>distribution</code> to
<code>obs</code> (if observations are provided). If the user provides parameters,
then these parameters will simply be returned. If parameters are estimated
from the data, then the estimated parameters will be returned.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
# Get ell level .05 QQ testing band for normal(0, 1) distribution with 100 observations
band &lt;- get_qq_band(n = 100)

# Get ell level .05 QQ testing band for normal distribution with unknown parameters
obs &lt;- rnorm(100)
band &lt;- get_qq_band(obs = obs)

# Get ell level .05 QQ testing band for t(2) distribution with 100 observations
band &lt;- get_qq_band(
  n = 100, distribution = qt, dparams = list(df = 2)
)

</code></pre>

<hr>
<h2 id='get_qq_distribution_from_pp_distribution'>Get Quantile Distribution from Probability Distribution</h2><span id='topic+get_qq_distribution_from_pp_distribution'></span>

<h3>Description</h3>

<p>Get Quantile Distribution from Probability Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_qq_distribution_from_pp_distribution(dname)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_qq_distribution_from_pp_distribution_+3A_dname">dname</code></td>
<td>
<p>probability distribution (e.g. <code>pnorm</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>quantile distribution (e.g. <code>qnorm</code>).
</p>

<hr>
<h2 id='monte_carlo_two_sided'>Monte Carlo Simulation for Two-Sided Test</h2><span id='topic+monte_carlo_two_sided'></span>

<h3>Description</h3>

<p>Given bounds for a two sided test on uniform order statistics, this computes
the Type I Error Rate <code class="reqn">\alpha</code> using simulations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monte_carlo_two_sided(lower_bounds, upper_bounds, num_sims = 1e+06)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monte_carlo_two_sided_+3A_lower_bounds">lower_bounds</code></td>
<td>
<p>Numeric vector where the ith component is the lower bound
for the ith order statistic. The components must be distinct values in (0, 1) that
are in ascending order.</p>
</td></tr>
<tr><td><code id="monte_carlo_two_sided_+3A_upper_bounds">upper_bounds</code></td>
<td>
<p>Numeric vector where the ith component is the lower bound
for the ith order statistic. The values must be in ascending order and
the ith component must be larger than the ith component of the lower bounds.</p>
</td></tr>
<tr><td><code id="monte_carlo_two_sided_+3A_num_sims">num_sims</code></td>
<td>
<p>(optional) Number of simulations to be run, 1 Million by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Type I Error Rate <code class="reqn">\alpha</code>
</p>

<hr>
<h2 id='pp_conf_plot'>PP Plot with Simultaneous and Pointwise Testing Bounds.</h2><span id='topic+pp_conf_plot'></span>

<h3>Description</h3>

<p>Create a pp-plot with with a shaded simultaneous acceptance region and,
optionally, lines for a point-wise region. The observed values are plotted
against their expected values had they come from the specified distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pp_conf_plot(
  obs,
  distribution = pnorm,
  method = c("ell", "ks"),
  alpha = 0.05,
  difference = FALSE,
  log10 = FALSE,
  right_tail = FALSE,
  add = FALSE,
  dparams = list(),
  bounds_params = list(),
  line_params = list(),
  plot_pointwise = FALSE,
  pointwise_lines_params = list(),
  points_params = list(),
  polygon_params = list(border = NA, col = "gray"),
  prob_pts_method = c("uniform", "median", "normal"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pp_conf_plot_+3A_obs">obs</code></td>
<td>
<p>The observed data.</p>
</td></tr>
<tr><td><code id="pp_conf_plot_+3A_distribution">distribution</code></td>
<td>
<p>The probability function for the specified distribution. Defaults to <code>pnorm</code>.
Custom distributions are allowed as long as all parameters are supplied in dparams.</p>
</td></tr>
<tr><td><code id="pp_conf_plot_+3A_method">method</code></td>
<td>
<p>Method for simultaneous testing bands. Must be either &quot;ell&quot; (equal local levels test), which applies a level <code class="reqn">\eta</code> pointwise
test to each order statistic such that the Type I error of the global test is <code>alpha</code>, or &quot;ks&quot; to apply a
Kolmogorov-Smirnov test. &quot;ell&quot; is recommended.</p>
</td></tr>
<tr><td><code id="pp_conf_plot_+3A_alpha">alpha</code></td>
<td>
<p>Type I error of global test of whether the data come from the reference distribution.</p>
</td></tr>
<tr><td><code id="pp_conf_plot_+3A_difference">difference</code></td>
<td>
<p>Whether to plot the difference between the observed and
expected values on the vertical axis.</p>
</td></tr>
<tr><td><code id="pp_conf_plot_+3A_log10">log10</code></td>
<td>
<p>Whether to plot axes on -log10 scale (e.g. to see small p-values).</p>
</td></tr>
<tr><td><code id="pp_conf_plot_+3A_right_tail">right_tail</code></td>
<td>
<p>This argument is only used if <code>log10</code> is <code>TRUE</code>. When <code>TRUE</code>,
the x-axis is -log10(1 - Expected Probability) and the y-axis is -log10(1 - Observed Probability).
When <code>FALSE</code> (default) the x-axis is -log10(Expected Probability) and the y-axis is
-log10(Observed Probability). The argument should be set to <code>TRUE</code> to make
observations in the right tail of the distribution easier to see, and set to false to make the
observations in the left tail of the distribution easier to see.</p>
</td></tr>
<tr><td><code id="pp_conf_plot_+3A_add">add</code></td>
<td>
<p>Whether to add points to an existing plot.</p>
</td></tr>
<tr><td><code id="pp_conf_plot_+3A_dparams">dparams</code></td>
<td>
<p>List of additional arguments for the probability function of the distribution
(e.g. df=1). Note that if any parameters of the distribution are specified, parameter estimation will not be performed
on the unspecified parameters, and instead they will take on the default values set by the distribution function.
For the uniform distribution, parameter estimation is not performed, and
the default parameters are max = 1 and min = 0.
For other distributions parameters will be estimated if not provided.
For the normal distribution, we estimate the mean as the median and the standard deviation as <code class="reqn">Sn</code> from the paper by Rousseeuw and Croux 1993
&quot;Alternatives to the Median Absolute Deviation&quot;. For all other distributions besides uniform and normal,
the code uses MLE to estimate the parameters. Note that estimation is not implemented for custom distributions, so all
parameters of the distribution must be provided by the user.</p>
</td></tr>
<tr><td><code id="pp_conf_plot_+3A_bounds_params">bounds_params</code></td>
<td>
<p>List of optional arguments for <code>get_bounds_two_sided</code>.
(i.e. <code>tol</code>, <code>max_it</code>, <code>method</code>).</p>
</td></tr>
<tr><td><code id="pp_conf_plot_+3A_line_params">line_params</code></td>
<td>
<p>arguments passed to the line function to modify the line that indicates a perfect fit of the
reference distribution.</p>
</td></tr>
<tr><td><code id="pp_conf_plot_+3A_plot_pointwise">plot_pointwise</code></td>
<td>
<p>Boolean indicating whether pointwise bounds should be added to the plot</p>
</td></tr>
<tr><td><code id="pp_conf_plot_+3A_pointwise_lines_params">pointwise_lines_params</code></td>
<td>
<p>arguments passed to the <code>lines</code> function that modifies pointwise bounds when plot_pointwise is
set to TRUE.</p>
</td></tr>
<tr><td><code id="pp_conf_plot_+3A_points_params">points_params</code></td>
<td>
<p>arguments to be passed to the <code>points</code> function to plot the data.</p>
</td></tr>
<tr><td><code id="pp_conf_plot_+3A_polygon_params">polygon_params</code></td>
<td>
<p>Arguments to be passed to the polygon function to construct simultaneous confidence region.
By default <code>border</code> is set to NA and <code>col</code> is set to grey.</p>
</td></tr>
<tr><td><code id="pp_conf_plot_+3A_prob_pts_method">prob_pts_method</code></td>
<td>
<p>(optional) method used to get probability points for
plotting. The default value, <code>"uniform"</code>, results in
<code>ppoints(n, a=0)</code>, which are the expected
values of the order statistics of Uniform(0, 1).  When
this argument is set to <code>"median"</code>, <code>qbeta(.5, c(1:n), c(n:1))</code>,
the medians of the order statistics of Uniform(0, 1) will be used. For a
PP plot, there is no particular theoretical justification for setting this
argument to <code>"normal"</code>, which results in <code>ppoints(n)</code>, but it is
an option because it is used in some
other packages. When <code>alpha</code> is large, <code>"median"</code> is recommended.</p>
</td></tr>
<tr><td><code id="pp_conf_plot_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the plot function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If any of the points of the pp-plot fall outside the simultaneous acceptance region for the selected
level alpha test, that means that we can reject the null hypothesis that the data are i.i.d. draws from the
specified distribution. If <code>difference</code> is set to TRUE, the vertical axis plots the
observed probability minus expected probability. If pointwise bounds are used, then on average, alpha * n of the points will fall outside
the bounds under the null hypothesis, so the chance that the pp-plot has any points falling outside of the pointwise bounds
is typically much higher than alpha under the null hypothesis. For this reason, a simultaneous region is preferred.
</p>


<h3>Value</h3>

<p>None, PP plot is produced.
</p>


<h3>References</h3>

<p>Weine, E., McPeek, MS., &amp; Abney, M. (2023).
Application of Equal Local Levels to Improve
Q-Q Plot Testing Bands with R Package qqconf
Journal of Statistical Software, 106(10).
https://doi:10.18637/jss.v106.i10
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
smp &lt;- rnorm(100)

# Plot PP plot against normal distribution with mean and variance estimated
pp_conf_plot(
  obs=smp
)

# Make same plot on -log10 scale to highlight the left tail,
# with radius of plot circles also reduced by .5
pp_conf_plot(
  obs=smp,
  log10 = TRUE,
  points_params = list(cex = .5)
)

# Make same plot with difference between observed and expected values on the y-axis
pp_conf_plot(
  obs=smp,
  difference = TRUE
)

# Make same plot with samples plotted as a blue line, expected value line plotted as a red line,
# and pointwise bounds plotted as black lines
pp_conf_plot(
  obs=smp,
  plot_pointwise = TRUE,
  points_params = list(col="blue", type="l"),
  line_params = list(col="red")
)

</code></pre>

<hr>
<h2 id='qq_conf_plot'>QQ Plot with Simultaneous and Pointwise Testing Bounds.</h2><span id='topic+qq_conf_plot'></span>

<h3>Description</h3>

<p>Create a qq-plot with with a shaded simultaneous acceptance region and,
optionally, lines for a point-wise region. The observed values are plotted
against their expected values had they come from the specified distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qq_conf_plot(
  obs,
  distribution = qnorm,
  method = c("ell", "ks"),
  alpha = 0.05,
  difference = FALSE,
  log10 = FALSE,
  right_tail = FALSE,
  add = FALSE,
  dparams = list(),
  bounds_params = list(),
  line_params = list(),
  plot_pointwise = FALSE,
  pointwise_lines_params = list(),
  points_params = list(),
  polygon_params = list(border = NA, col = "gray"),
  prob_pts_method = c("best_available", "normal", "uniform", "median"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qq_conf_plot_+3A_obs">obs</code></td>
<td>
<p>The observed data.</p>
</td></tr>
<tr><td><code id="qq_conf_plot_+3A_distribution">distribution</code></td>
<td>
<p>The quantile function for the specified distribution. Defaults to <code>qnorm</code>.
Custom distributions are allowed as long as all parameters are supplied in dparams.</p>
</td></tr>
<tr><td><code id="qq_conf_plot_+3A_method">method</code></td>
<td>
<p>Method for simultaneous testing bands. Must be either &quot;ell&quot; (equal local levels test), which applies a level <code class="reqn">\eta</code> pointwise
test to each order statistic such that the Type I error of the global test is <code>alpha</code>, or &quot;ks&quot; to apply a
Kolmogorov-Smirnov test. &quot;ell&quot; is recommended.</p>
</td></tr>
<tr><td><code id="qq_conf_plot_+3A_alpha">alpha</code></td>
<td>
<p>Type I error of global test of whether the data come from the reference distribution.</p>
</td></tr>
<tr><td><code id="qq_conf_plot_+3A_difference">difference</code></td>
<td>
<p>Whether to plot the difference between the observed and
expected values on the vertical axis.</p>
</td></tr>
<tr><td><code id="qq_conf_plot_+3A_log10">log10</code></td>
<td>
<p>Whether to plot axes on -log10 scale (e.g. to see small p-values). Can only be used for strictly
positive distributions.</p>
</td></tr>
<tr><td><code id="qq_conf_plot_+3A_right_tail">right_tail</code></td>
<td>
<p>This argument is only used if <code>log10</code> is <code>TRUE</code>. When <code>TRUE</code>,
the x-axis is -log10(1 - Expected Quantile) and the y-axis is -log10(1 - Observed Quantile).
When <code>FALSE</code> (default) the x-axis is -log10(Expected Quantile) and the y-axis is
-log10(Observed Quantile). The argument should be set to <code>TRUE</code> only when the support
of the distribution lies in (0, 1), and one wants to make
observations in the right tail of the distribution easier to see. The argument should be
set to <code>FALSE</code> when one wants to make
observations in the left tail of the distribution easier to see.</p>
</td></tr>
<tr><td><code id="qq_conf_plot_+3A_add">add</code></td>
<td>
<p>Whether to add points to an existing plot.</p>
</td></tr>
<tr><td><code id="qq_conf_plot_+3A_dparams">dparams</code></td>
<td>
<p>List of additional arguments for the quantile function of the distribution
(e.g. df=1). Note that if any parameters of the distribution are specified, parameter estimation will not be performed
on the unspecified parameters, and instead they will take on the default values set by the distribution function.
For the uniform distribution, parameter estimation is not performed, and
the default parameters are max = 1 and min = 0.
For other distributions parameters will be estimated if not provided.
For the normal distribution, we estimate the mean as the median and the standard deviation as <code class="reqn">Sn</code> from the paper by Rousseeuw and Croux 1993
&quot;Alternatives to the Median Absolute Deviation&quot;. For all other distributions besides uniform and normal,
the code uses MLE to estimate the parameters. Note that estimation is not implemented for custom distributions, so all
parameters of the distribution must be provided by the user.</p>
</td></tr>
<tr><td><code id="qq_conf_plot_+3A_bounds_params">bounds_params</code></td>
<td>
<p>List of optional arguments for <code>get_bounds_two_sided</code>
(i.e. <code>tol</code>, <code>max_it</code>, <code>method</code>).</p>
</td></tr>
<tr><td><code id="qq_conf_plot_+3A_line_params">line_params</code></td>
<td>
<p>Arguments passed to the <code>lines</code> function to modify the line that indicates a perfect fit of the
reference distribution.</p>
</td></tr>
<tr><td><code id="qq_conf_plot_+3A_plot_pointwise">plot_pointwise</code></td>
<td>
<p>Boolean indicating whether pointwise bounds should be added to the plot</p>
</td></tr>
<tr><td><code id="qq_conf_plot_+3A_pointwise_lines_params">pointwise_lines_params</code></td>
<td>
<p>Arguments passed to the <code>lines</code> function that modifies pointwise bounds when plot_pointwise is
set to TRUE.</p>
</td></tr>
<tr><td><code id="qq_conf_plot_+3A_points_params">points_params</code></td>
<td>
<p>Arguments to be passed to the <code>points</code> function to plot the data.</p>
</td></tr>
<tr><td><code id="qq_conf_plot_+3A_polygon_params">polygon_params</code></td>
<td>
<p>Arguments to be passed to the polygon function to construct simultaneous confidence region.
By default <code>border</code> is set to NA and <code>col</code> is set to grey.</p>
</td></tr>
<tr><td><code id="qq_conf_plot_+3A_prob_pts_method">prob_pts_method</code></td>
<td>
<p>(optional) method used to get probability points for plotting.
The quantile function will be applied to these points to
get the expected values.  When this argument is set to <code>"normal"</code>
(recommended for a normal QQ plot) <code>ppoints(n)</code> will be used,  which is what
most other plotting software uses. When this argument is set to <code>"uniform"</code>
(recommended for a uniform QQ plot) <code>ppoints(n, a=0)</code>, which are the expected
values of the order statistics of Uniform(0, 1), will be used.  Finally,
when this argument is set to <code>"median"</code> (recommended for all other
distributions) <code>qbeta(.5, c(1:n), c(n:1))</code> will be used. Under the default
setting, <code>"best_available"</code>, the probability points as recommended above will
be used. Note that <code>"median"</code> is suitable for all distributions and is
particularly recommended when alpha is large.</p>
</td></tr>
<tr><td><code id="qq_conf_plot_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the plot function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If any of the points of the qq-plot fall outside the simultaneous acceptance region for the selected
level alpha test, that means that we can reject the null hypothesis that the data are i.i.d. draws from the
specified distribution. If <code>difference</code> is set to TRUE, the vertical axis plots the
observed quantile minus expected quantile. If pointwise bounds are used, then on average, alpha * n of the points will fall outside
the bounds under the null hypothesis, so the chance that the qq-plot has any points falling outside of the pointwise bounds
is typically much higher than alpha under the null hypothesis. For this reason, a simultaneous region is preferred.
</p>


<h3>Value</h3>

<p>None, QQ plot is produced.
</p>


<h3>References</h3>

<p>Weine, E., McPeek, MS., &amp; Abney, M. (2023).
Application of Equal Local Levels to Improve
Q-Q Plot Testing Bands with R Package qqconf
Journal of Statistical Software, 106(10).
https://doi:10.18637/jss.v106.i10
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
smp &lt;- runif(100)

# Plot QQ plot against uniform(0, 1) distribution
qq_conf_plot(
  obs=smp,
  distribution = qunif
)

# Make same plot on -log10 scale to highlight small p-values,
# with radius of plot circles also reduced by .5
qq_conf_plot(
  obs=smp,
  distribution = qunif,
  points_params = list(cex = .5),
  log10 = TRUE
)

# Make same plot with difference between observed and expected values on the y-axis
qq_conf_plot(
  obs=smp,
  distribution = qunif,
  difference = TRUE
)

# Make same plot with sample plotted as a blue line, expected value line plotted as a red line,
# and with pointwise bounds plotted as black lines
qq_conf_plot(
  obs=smp,
  distribution = qunif,
  plot_pointwise = TRUE,
  points_params = list(col="blue", type="l"),
  line_params = list(col="red")
)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
