<!DOCTYPE html><html><head><title>Help for package BwQuant</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BwQuant}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bwCV'><p>Computing the cross-validation bandwidth proposed by Abberger (1998)</p></a></li>
<li><a href='#bwPI'><p>Computing the plug-in bandwidth proposed by Conde-Amboage and Sanchez-Sellero (2018)</p></a></li>
<li><a href='#BwQuant-package'><p>Bandwidth selectors for local linear quantile regression</p></a></li>
<li><a href='#bwRT'><p>Computing a bandwidth using a rule of thumb</p></a></li>
<li><a href='#bwYJ'><p>Computing the plug-in bandwidth proposed by Yu and Jones (1998)</p></a></li>
<li><a href='#llqr'><p>Fitting a local linear quantile regression model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bandwidth Selectors for Local Linear Quantile Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-01-31</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.6), quantreg, KernSmooth, nleqslv</td>
</tr>
<tr>
<td>Description:</td>
<td>Bandwidth selectors for local linear quantile regression, including cross-validation and plug-in methods. The local linear quantile regression estimate is also implemented.</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-02-07 16:24:41 UTC; mercedes</td>
</tr>
<tr>
<td>Author:</td>
<td>Mercedes Conde-Amboage
    <a href="https://orcid.org/0000-0003-0306-8142"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Cesar Sanchez-Sellero
    <a href="https://orcid.org/0000-0003-0046-0819"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mercedes Conde-Amboage &lt;mercedes.amboage@usc.es&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-02-08 16:00:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='bwCV'>Computing the cross-validation bandwidth proposed by Abberger (1998)</h2><span id='topic+bwCV'></span>

<h3>Description</h3>

<p>Function to compute a bandwidth for local linear quantile regression following the cross-validation criteria presented by Abberger (1998).</p>


<h3>Usage</h3>

<pre><code class='language-R'>bwCV(x, y, hseq, tau)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bwCV_+3A_x">x</code></td>
<td>
<p>numeric vector of <code>x</code> data.</p>
</td></tr>
<tr><td><code id="bwCV_+3A_y">y</code></td>
<td>
<p>numeric vector of <code>y</code> data. This must be the same length as <code>x</code>.</p>
</td></tr>
<tr><td><code id="bwCV_+3A_hseq">hseq</code></td>
<td>
<p>sequence of values where the cross-validation function will be evaluated.</p>
</td></tr>
<tr><td><code id="bwCV_+3A_tau">tau</code></td>
<td>
<p>the quantile order where the regression function is to be estimated. It must be a number strictly between 0 and 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The cross-validation function is evaluated at each element of <code>hseq</code>. Then, the cross-validation selector will be the element of <code>hseq</code> that minimizes the cross-validation function.</p>


<h3>Value</h3>

<p>Returns a number with the chosen bandwidth.</p>


<h3>Author(s)</h3>

<p>Mercedes Conde-Amboage and Cesar Sanchez-Sellero.</p>


<h3>References</h3>

<p>Abberger, K. (1998). Cross-validation in nonparametric quantile regression. Allgemeines Statistisches Archiv, 82, 149-161.
</p>
<p>Abberger, K. (2002). Variable data driven bandwidth choice in nonparametric quantile regression. Technical Report.</p>


<h3>See Also</h3>

<p>The obtained bandwidth can be used in the function <code><a href="#topic+llqr">llqr</a></code> to produce a local linear estimate of the <code>tau</code>-quantile regression function.</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
x=runif(100)
y=10*(x^4+x^2-x)+rexp(100)
hseq=seq(0.05,0.8,length=21)
tau=0.25
bwCV(x,y,hseq,tau)
</code></pre>

<hr>
<h2 id='bwPI'>Computing the plug-in bandwidth proposed by Conde-Amboage and Sanchez-Sellero (2018)</h2><span id='topic+bwPI'></span>

<h3>Description</h3>

<p>Function to compute a bandwidth selector for local linear quantile regression following the plug-in rule proposed in Section 2.2 of Conde-Amboage and Sanchez-Sellero (2018).</p>


<h3>Usage</h3>

<pre><code class='language-R'>bwPI(x, y, tau)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bwPI_+3A_x">x</code></td>
<td>
<p>numeric vector of <code>x</code> data.</p>
</td></tr>
<tr><td><code id="bwPI_+3A_y">y</code></td>
<td>
<p>numeric vector of <code>y</code> data. This must be the same length as <code>x</code>.</p>
</td></tr>
<tr><td><code id="bwPI_+3A_tau">tau</code></td>
<td>
<p>the quantile order where the regression function is to be estimated. It must be a number strictly between 0 and 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a bandwidth for a local linear estimate of the <code>tau</code>-quantile regression function.</p>


<h3>Author(s)</h3>

<p>Mercedes Conde-Amboage and Cesar Sanchez-Sellero.</p>


<h3>References</h3>

<p>Conde-Amboage, M. and Sanchez-Sellero, C. (2018). A plug-in bandwidth selector for nonparametric quantile regression. TEST, 28, 423-450. &lt;doi:10.1007/s11749-018-0582-6&gt;.</p>


<h3>See Also</h3>

<p>The obtained bandwidth can be used in the function <code><a href="#topic+llqr">llqr</a></code> to produce a local linear estimate of the <code>tau</code>-quantile regression function.</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
x=runif(100)
y=10*(x^4+x^2-x)+rexp(100)
tau=0.25
bwPI(x,y,tau)
</code></pre>

<hr>
<h2 id='BwQuant-package'>Bandwidth selectors for local linear quantile regression</h2><span id='topic+BwQuant-package'></span><span id='topic+BwQuant'></span>

<h3>Description</h3>

<p>The R package <code>BwQuant</code> implements different bandwidth selectors for local linear quantile regression, including selectors based on rule of thumb, plug-in and cross-validation tecniques.</p>


<h3>Author(s)</h3>

<p>Mercedes Conde-Amboage &lt;mercedes.amboage@usc.es&gt; and Cesar Sanchez-Sellero &lt;cesar.sanchez@usc.es&gt;
</p>
<p>Maintainer: Mercedes Conde-Amboage &lt;mercedes.amboage@usc.es&gt;
</p>

<hr>
<h2 id='bwRT'>Computing a bandwidth using a rule of thumb</h2><span id='topic+bwRT'></span>

<h3>Description</h3>

<p>Function to compute a bandwidth selector for local linear quantile regression following the rule of thumb presented in Section 2.1 of Conde-Amboage and Sanchez-Sellero (2018).</p>


<h3>Usage</h3>

<pre><code class='language-R'>bwRT(x, y, tau)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bwRT_+3A_x">x</code></td>
<td>
<p>numeric vector of <code>x</code> data.</p>
</td></tr>
<tr><td><code id="bwRT_+3A_y">y</code></td>
<td>
<p>numeric vector of <code>y</code> data. This must be the same length as <code>x</code>.</p>
</td></tr>
<tr><td><code id="bwRT_+3A_tau">tau</code></td>
<td>
<p>the quantile order where the regression function is to be estimated. It must be a number strictly between 0 and 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a bandwidth for a local linear estimate of the <code>tau</code>-quantile regression function.</p>


<h3>Author(s)</h3>

<p>Mercedes Conde-Amboage and Cesar Sanchez-Sellero.</p>


<h3>References</h3>

<p>Conde-Amboage, M. and Sanchez-Sellero, C. (2018). A plug-in bandwidth selector for nonparametric quantile regression. TEST, 28, 423-450. &lt;doi:10.1007/s11749-018-0582-6&gt;.</p>


<h3>See Also</h3>

<p>The obtained bandwidth can be used in the function <code><a href="#topic+llqr">llqr</a></code> to produce a local linear estimate of the <code>tau</code>-quantile regression function.</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
x=runif(100)
y=10*(x^4+x^2-x)+rexp(100)
tau=0.25
bwRT(x,y,tau)
</code></pre>

<hr>
<h2 id='bwYJ'>Computing the plug-in bandwidth proposed by Yu and Jones (1998)</h2><span id='topic+bwYJ'></span>

<h3>Description</h3>

<p>Function to compute a bandwidth selector for local linear quantile regression following the plug-in rule proposed by Yu and Jones (1998).</p>


<h3>Usage</h3>

<pre><code class='language-R'>bwYJ(x, y, tau)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bwYJ_+3A_x">x</code></td>
<td>
<p>numeric vector of <code>x</code> data.</p>
</td></tr>
<tr><td><code id="bwYJ_+3A_y">y</code></td>
<td>
<p>numeric vector of <code>y</code> data. This must be the same length as <code>x</code>.</p>
</td></tr>
<tr><td><code id="bwYJ_+3A_tau">tau</code></td>
<td>
<p>the quantile order where the regression function is to be estimated. It must be a number strictly between 0 and 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a bandwidth for a local linear estimate of the <code>tau</code>-quantile regression function.</p>


<h3>Author(s)</h3>

<p>Mercedes Conde-Amboage and Cesar Sanchez-Sellero.</p>


<h3>References</h3>

<p>Ruppert, D., Sheather, S. J. and Wand, M. P. (1995). An efective bandwidth selector for local least squares regression. Journal of the American Statistical Association. 90, 1257-1270.
</p>
<p>Yu, K. and Jones, M. C. (1998). Local linear quantile regression. Journal of the American Statistical Association, 93, 228-237.
</p>


<h3>See Also</h3>

<p>The obtained bandwidth can be used in the function <code><a href="#topic+llqr">llqr</a></code> to produce a local linear estimate of the <code>tau</code>-quantile regression function.</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
x=runif(100)
y=10*(x^4+x^2-x)+rexp(100)
tau=0.25
bwYJ(x,y,tau)
</code></pre>

<hr>
<h2 id='llqr'>Fitting a local linear quantile regression model</h2><span id='topic+llqr'></span>

<h3>Description</h3>

<p>Function that estimates the quantile regression function using a local linear kernel smoother.</p>


<h3>Usage</h3>

<pre><code class='language-R'>llqr(x, y, tau, t, h)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="llqr_+3A_x">x</code></td>
<td>
<p>numeric vector of <code>x</code> data.</p>
</td></tr>
<tr><td><code id="llqr_+3A_y">y</code></td>
<td>
<p>numeric vector of <code>y</code> data. This must be the same length as <code>x</code>.</p>
</td></tr>
<tr><td><code id="llqr_+3A_tau">tau</code></td>
<td>
<p>the quantile order where the regression function is to be estimated. It must be a number strictly between 0 and 1.</p>
</td></tr>
<tr><td><code id="llqr_+3A_t">t</code></td>
<td>
<p>the values of <code>x</code> at which the quantile regression model is to be estimated.</p>
</td></tr>
<tr><td><code id="llqr_+3A_h">h</code></td>
<td>
<p>the bandwidth parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>x.values</code></td>
<td>
<p>the given points at which the evaluation occurs.</p>
</td></tr>
<tr><td><code>y.values</code></td>
<td>
<p>the estimated values of the quantile regression function at the given <code>x.values</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mercedes Conde-Amboage and Cesar Sanchez-Sellero.</p>


<h3>References</h3>

<p>Fan, J., Hu, T. C. and Truong, Y. K. (1994). Robust nonparametric function estimation. Scandinavian Journal of Statistics, 21, 433-446.
</p>
<p>Yu, K. and Jones, M. C. (1998). Local linear quantile regression. Journal of the American Statistical Association, 93, 228-237.
</p>


<h3>See Also</h3>

<p>The argument <code>h</code> with the bandwidth parameter can be fixed to some arbitrary value or chosen by one of the procedures implemented in the functions <code><a href="#topic+bwCV">bwCV</a></code>, <code><a href="#topic+bwPI">bwPI</a></code>, <code><a href="#topic+bwRT">bwRT</a></code> or <code><a href="#topic+bwYJ">bwYJ</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
x=runif(100)
y=10*(x^4+x^2-x)+rexp(100)
tau=0.25
h=bwPI(x,y,tau)
t=seq(0,1,length=101)
m=llqr(x,y,tau,t,h)
plot(x,y)
lines(m$x.values,m$y.values)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
