<!DOCTYPE html><html><head><title>Help for package ghyp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ghyp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ghyp-package'>
<p>A package on the generalized hyperbolic distribution and its special cases</p></a></li>
<li><a href='#coef-method'><p>Extract parameters of generalized hyperbolic distribution objects</p></a></li>
<li><a href='#ESghyp.attribution'><p>Risk attribution.</p></a></li>
<li><a href='#fit.ghypmv'><p>Fitting generalized hyperbolic distributions to multivariate data</p></a></li>
<li><a href='#fit.ghypuv'><p>Fitting generalized hyperbolic distributions to univariate data</p></a></li>
<li><a href='#ghyp-constructors'><p>Create generalized hyperbolic distribution objects</p></a></li>
<li><a href='#ghyp-distribution'><p>The Generalized Hyperbolic Distribution</p></a></li>
<li><a href='#ghyp-get'><p>Get methods for objects inheriting from class ghyp</p></a></li>
<li><a href='#ghyp-internal'><p>Internal ghyp functions</p></a></li>
<li><a href='#ghyp-mle.ghyp-classes'><p>Classes ghyp and mle.ghyp</p></a></li>
<li><a href='#ghyp-risk-performance'><p>Risk and Performance Measures</p></a></li>
<li><a href='#ghyp.attribution-class'><p>Class ghyp.attribution</p></a></li>
<li><a href='#ghyp.moment'><p>Compute moments of generalized hyperbolic distributions</p></a></li>
<li><a href='#gig-distribution'><p>The Generalized Inverse Gaussian Distribution</p></a></li>
<li><a href='#hist-methods'><p>Histogram for univariate generalized hyperbolic distributions</p></a></li>
<li><a href='#indices'><p>Monthly returns of five indices</p></a></li>
<li><a href='#lik.ratio.test'><p>Likelihood-ratio test</p></a></li>
<li><a href='#logLik-AIC-methods'><p>Extract Log-Likelihood and Akaike's Information Criterion</p></a></li>
<li><a href='#mean-vcov-skew-kurt-methods'><p>Expected value, variance-covariance, skewness and kurtosis</p>
of generalized hyperbolic distributions</a></li>
<li><a href='#pairs-methods'><p>Pairs plot for multivariate generalized hyperbolic distributions</p></a></li>
<li><a href='#plot-lines-methods'><p>Plot univariate generalized hyperbolic densities</p></a></li>
<li><a href='#plot.ghyp.attrib'><p>Plot ES contribution</p></a></li>
<li><a href='#portfolio.optimize'><p>Portfolio optimization with respect to alternative risk measures</p></a></li>
<li><a href='#qq-ghyp'><p>Quantile-Quantile Plot</p></a></li>
<li><a href='#scale-methods'><p>Scaling and Centering of ghyp Objects</p></a></li>
<li><a href='#smi.stocks'><p>Daily returns of five swiss blue chips and the SMI</p></a></li>
<li><a href='#stepAIC.ghyp'><p>Perform a model selection based on the AIC</p></a></li>
<li><a href='#summary-method'><p>mle.ghyp summary</p></a></li>
<li><a href='#transform-extract-methods'><p>Linear transformation and extraction of generalized hyperbolic</p>
distributions</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-21</td>
</tr>
<tr>
<td>Title:</td>
<td>Generalized Hyperbolic Distribution and Its Special Cases</td>
</tr>
<tr>
<td>Author:</td>
<td>Marc Weibel, David Luethi, Wolfgang Breymann</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marc Weibel &lt;marc.weibel@quantsulting.ch&gt;</td>
</tr>
<tr>
<td>LazyData:</td>
<td>no</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 2.7), methods, numDeriv, graphics, stats, MASS</td>
</tr>
<tr>
<td>Description:</td>
<td>Detailed functionality for working
        with the univariate and multivariate Generalized Hyperbolic
        distribution and its special cases (Hyperbolic (hyp), Normal
        Inverse Gaussian (NIG), Variance Gamma (VG), skewed Student-t
        and Gaussian distribution). Especially, it contains fitting
        procedures, an AIC-based model selection routine, and functions
        for the computation of density, quantile, probability, random
        variates, expected shortfall and some portfolio optimization
        and plotting routines as well as the likelihood ratio test. In
        addition, it contains the Generalized Inverse Gaussian
        distribution. See Chapter 3 of A. J. McNeil, R. Frey, and P. Embrechts. 
        Quantitative risk management: Concepts, techniques and tools. 
        Princeton University Press, Princeton (2005).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-21 08:14:14 UTC; marc</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-21 09:12:37 UTC</td>
</tr>
</table>
<hr>
<h2 id='ghyp-package'>
A package on the generalized hyperbolic distribution and its special cases
</h2><span id='topic+ghyp-package'></span>

<h3>Description</h3>

<p>This package provides detailed functionality for working with the
univariate and multivariate Generalized Hyperbolic distribution and its
special cases (Hyperbolic (hyp), Normal Inverse Gaussian (NIG), Variance
Gamma (VG), skewed Student-t and Gaussian distribution). Especially, it
contains fitting procedures, an AIC-based model selection routine, and
functions for the computation of density, quantile, probability, random
variates, expected shortfall and some portfolio optimization and
plotting routines as well as the likelihood ratio test.  In addition, it
contains the Generalized Inverse Gaussian distribution.
</p>


<h3>Details</h3>

<p><strong>Initialize:</strong>
</p>

<table>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+ghyp">ghyp</a></code> </td><td style="text-align: left;">             Initialize a generalized hyperbolic distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+hyp">hyp</a></code> </td><td style="text-align: left;">              Initialize a hyperbolic distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+NIG">NIG</a></code> </td><td style="text-align: left;">              Initialize a normal inverse gaussian distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+VG">VG</a></code> </td><td style="text-align: left;">               Initialize a variance gamma distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+student.t">student.t</a></code> </td><td style="text-align: left;">        Initialize a Student-t distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+gauss">gauss</a></code> </td><td style="text-align: left;">            Initialize a Gaussian distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>Density, distribution function, quantile function and
random generation:</strong>
</p>

<table>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+dghyp">dghyp</a></code> </td><td style="text-align: left;">         Density of a generalized hyperbolic distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+pghyp">pghyp</a></code> </td><td style="text-align: left;">         Distribution function of a generalized hyperbolic distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+qghyp">qghyp</a></code> </td><td style="text-align: left;">         Quantile of a univariate generalized hyperbolic distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+rghyp">rghyp</a></code> </td><td style="text-align: left;">         Random generation of a generalized hyperbolic distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>Fit to data:</strong>
</p>

<table>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code> </td><td style="text-align: left;">     Fit a generalized hyperbolic distribution to univariate data.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+fit.hypuv">fit.hypuv</a></code> </td><td style="text-align: left;">      Fit a hyperbolic distribution to univariate data.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+fit.NIGuv">fit.NIGuv</a></code> </td><td style="text-align: left;">      Fit a normal inverse gaussian distribution to univariate data.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+fit.VGuv">fit.VGuv</a></code> </td><td style="text-align: left;">       Fit a variance gamma distribution to univariate data.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+fit.tuv">fit.tuv</a></code> </td><td style="text-align: left;">        Fit a skewed Student-t distribution to univariate data.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+fit.gaussuv">fit.gaussuv</a></code> </td><td style="text-align: left;">    Fit a Gaussian distribution to univariate data.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+fit.ghypmv">fit.ghypmv</a></code> </td><td style="text-align: left;">     Fit a generalized hyperbolic distribution to multivariate data.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+fit.hypmv">fit.hypmv</a></code> </td><td style="text-align: left;">      Fit a hyperbolic distribution to multivariate data.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+fit.NIGmv">fit.NIGmv</a></code> </td><td style="text-align: left;">      Fit a normal inverse gaussian distribution to multivariate data.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+fit.VGmv">fit.VGmv</a></code> </td><td style="text-align: left;">       Fit a variance gamma distribution to multivariate data.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+fit.tmv">fit.tmv</a></code> </td><td style="text-align: left;">        Fit a skewed Student-t distribution to multivariate data.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+fit.gaussmv">fit.gaussmv</a></code> </td><td style="text-align: left;">    Fit a Gaussian distribution to multivariate data.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+stepAIC.ghyp">stepAIC.ghyp</a></code> </td><td style="text-align: left;">   Perform a model selection based on the AIC.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>Risk, performance and portfolio optimization:</strong>
</p>

<table>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+ESghyp">ESghyp</a></code> </td><td style="text-align: left;">        Expected shortfall of a univariate generalized hyperbolic distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+ghyp.omega">ghyp.omega</a></code> </td><td style="text-align: left;">    Performance measure <em>Omega</em> based on a univariate <code>ghyp</code> distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+portfolio.optimize">portfolio.optimize</a></code> </td><td style="text-align: left;">     Calculate optimal portfolios with respect to alternative risk measures.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>Utilities:</strong>
</p>

<table>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+mean.ghyp">mean</a></code> </td><td style="text-align: left;">       Returns the expected value.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+vcov.ghyp">vcov</a></code> </td><td style="text-align: left;">       Returns the  variance(-covariance).</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+ghyp.skewness">ghyp.skewness</a></code> </td><td style="text-align: left;">          Skewness of a univariate <code>ghyp</code> distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+ghyp.kurtosis">ghyp.kurtosis</a></code> </td><td style="text-align: left;">          Kurtosis of a univariate <code>ghyp</code> distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+logLik.mle.ghyp">logLik</a></code> </td><td style="text-align: left;">   Returns Log-Likelihood of fitted ghyp objects.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+AIC.mle.ghyp">AIC</a></code> </td><td style="text-align: left;">     Returns the Akaike's Information Criterion  of fitted ghyp objects.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+lik.ratio.test">lik.ratio.test</a></code> </td><td style="text-align: left;">         Performs a likelihood-ratio test on fitted <code>ghyp</code> distributions.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic++5B.ghyp">[</a></code> </td><td style="text-align: left;">             Extract certain dimensions of a multivariate <code>ghyp</code> distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+scale.ghyp">scale</a></code> </td><td style="text-align: left;"> Scale <code>ghyp</code> distribution objects to zero expectation and/or unit variance.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+transform.ghyp">transform</a></code> </td><td style="text-align: left;"> Transform a multivariate generalized hyperbolic distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+ghyp.moment">ghyp.moment</a></code> </td><td style="text-align: left;">            Moments of the univariate <code>ghyp</code> distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+coef.ghyp">coef</a></code> </td><td style="text-align: left;">       Parameters of a generalized hyperbolic distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+ghyp.data">ghyp.data</a></code> </td><td style="text-align: left;">              Data of a (fitted) generalized hyperbolic distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+ghyp.fit.info">ghyp.fit.info</a></code> </td><td style="text-align: left;">          Information about the fitting procedure, log-likelihood and AIC value.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+ghyp.name">ghyp.name</a></code> </td><td style="text-align: left;">              Returns the name of the <code>ghyp</code> distribution or a subclass of it.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+ghyp.dim">ghyp.dim</a></code> </td><td style="text-align: left;">              Returns the dimension of a <code>ghyp</code> object.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+summary.mle.ghyp">summary</a></code> </td><td style="text-align: left;">       Summary of a fitted generalized hyperbolic distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>Plot functions:</strong>
</p>

<table>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+qqghyp">qqghyp</a></code> </td><td style="text-align: left;">                 Perform a quantile-quantile plot of a (fitted) univariate <code>ghyp</code> distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+hist.ghyp">hist</a></code> </td><td style="text-align: left;">       Plot a histogram of a (fitted) univariate generalized hyperbolic distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+pairs.ghyp">pairs</a></code> </td><td style="text-align: left;">     Produce a matrix of scatterplots with quantile-quantile plots on the diagonal.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+plot.ghyp">plot</a></code> </td><td style="text-align: left;">       Plot the density of a univariate <code>ghyp</code> distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+lines.ghyp">lines</a></code> </td><td style="text-align: left;">     Add the density of a univariate <code>ghyp</code> distribution to a graphics device.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>Generalized inverse gaussian distribution:</strong>
</p>

<table>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+dgig">dgig</a></code> </td><td style="text-align: left;">          Density of a generalized inverse gaussian distribution</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+pgig">pgig</a></code> </td><td style="text-align: left;">          Distribution function of a generalized inverse gaussian distribution</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+qgig">qgig</a></code> </td><td style="text-align: left;">          Quantile of a generalized inverse gaussian distribution</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+ESgig">ESgig</a></code> </td><td style="text-align: left;">         Expected shortfall of a generalized inverse gaussian distribution</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+rgig">rgig</a></code> </td><td style="text-align: left;">          Random generation of a generalized inverse gaussian distribution</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>Package vignette:</strong> <br />
A document about generalized hyperbolic distributions can be found in the
<code>doc</code> folder of this package or on <a href="https://cran.r-project.org/package=ghyp">https://cran.r-project.org/package=ghyp</a>.
</p>


<h3>Existing solutions</h3>

<p>There are packages like <code>GeneralizedHyperbolic</code>,
<code>HyperbolicDist</code>, <code>SkewHyperbolic</code>, <code>VarianceGamma</code> and <code>fBasics</code> which cover the
univariate generalized hyperbolic distribution and/or some of its special cases. However, the univariate case is contained
in this package as well because we aim to provide a uniform interface to deal with
generalized hyperbolic distribution. Recently an <span class="rlang"><b>R</b></span> port of the S-Plus library <code>QRMlib</code>
was released. The package <code>QRMlib</code> contains fitting procedures for the multivariate NIG, hyp and
skewed Student-t distribution but not for the generalized hyperbolic case.
The package <code>fMultivar</code> implements
a fitting routine for multivariate skewed Student-t distributions as well.
</p>


<h3>Object orientation</h3>

<p>We follow an object-oriented programming approach in this package and
introduce distribution objects. There are mainly four reasons for that:
</p>

<ul>
<li><p> Unlike most distributions the GH distribution has quite a few
parameters which have to fulfill some consistency
requirements. Consistency checks can be performed uniquely when
an object is initialized.
</p>
</li>
<li><p> Once initialized the common functions belonging to a
distribution can be called conveniently by passing the
distribution object. A repeated input of the parameters is
avoided.
</p>
</li>
<li><p> Distributions returned from fitting procedures can be directly
passed to, e.g., the density function since fitted distribution
objects add information to the distribution object and
consequently inherit from the class of the distribution object.
</p>
</li>
<li><p> Generic method dispatching can be used to provide a uniform
interface to, e.g., plot the probability density of a specific
distribution like <code>plot(distribution.object)</code>.
Additionally, one can take advantage of generic programming
since <span class="rlang"><b>R</b></span> provides virtual classes and some forms of
polymorphism.
</p>
</li></ul>



<h3>Acknowledgement</h3>

<p>This package has been partially developed in the framework of the
COST-P10 &ldquo;Physics of Risk&rdquo; project. Financial support by the
Swiss State Secretariat for Education and Research (SBF) is gratefully
acknowledged.
</p>


<h3>Author(s)</h3>

<p>David Luethi, Wolfgang Breymann <br />
</p>
<p>Institute of Data Analyses and Process Design
(<a href="https://www.zhaw.ch/en/engineering/institutes-centres/idp/groups/data-analysis-and-statistics/">https://www.zhaw.ch/en/engineering/institutes-centres/idp/groups/data-analysis-and-statistics/</a>) <br />
</p>
<p>Maintainer: Marc Weibel &lt;marc.weibel@quantsulting.ch&gt;
</p>


<h3>References</h3>

<p><em>Quantitative Risk Management: Concepts, Techniques and Tools</em> by
Alexander J. McNeil, Ruediger Frey and Paul Embrechts <br /> Princeton
Press, 2005 <br />
</p>
<p><em>Intermediate probability: A computational approach</em> by Marc
Paolella <br /> Wiley, 2007 <br />
</p>
<p><em>S-Plus and <span class="rlang"><b>R</b></span> Library for Quantitative Risk Management QRMlib</em> by
Alexander J. McNeil (2005) and Scott Ulman (<span class="rlang"><b>R</b></span>-port) (2007)<br />
</p>

<hr>
<h2 id='coef-method'>Extract parameters of generalized hyperbolic distribution objects</h2><span id='topic+coef.ghyp'></span><span id='topic+coef+2Cghyp-method'></span><span id='topic+coefficients+2Cghyp-method'></span>

<h3>Description</h3>

<p>The function <code>coef</code> returns the parameters of a generalized
hyperbolic distribution object as a list. The user can choose between
the &ldquo;chi/psi&rdquo;, the &ldquo;alpha.bar&rdquo; and the
&ldquo;alpha/delta&rdquo; parametrization. The function <code>coefficients</code>
is a synonym for <code>coef</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ghyp'
coef(object, type = c("chi.psi", "alpha.bar", "alpha.delta"))

## S4 method for signature 'ghyp'
coefficients(object, type = c("chi.psi", "alpha.bar", "alpha.delta"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef-method_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code><a href="#topic+ghyp-class">ghyp</a></code>.</p>
</td></tr>
<tr><td><code id="coef-method_+3A_type">type</code></td>
<td>
<p>According to <code>type</code> the parameters of either the
&ldquo;chi/psi&rdquo;, the &ldquo;alpha.bar&rdquo; or the
&ldquo;alpha/delta&rdquo; parametrization will be returned.  If
<code>type</code> is missing, the parameters belonging to the
parametrization of the construction are returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Internally, the &ldquo;chi/psi&rdquo; parametrization is used. However,
fitting is only possible in the &ldquo;alpha.bar&rdquo; parametrization as
it provides the most convenient parameter constraints.
</p>


<h3>Value</h3>

<p>If <code>type</code> is &ldquo;chi.psi&rdquo; a list with components:
</p>

<table>
<tr>
 <td style="text-align: right;">
  <code>lambda</code> </td><td style="text-align: left;"> Shape parameter. </td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>chi</code> </td><td style="text-align: left;"> Shape parameter. </td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>psi</code> </td><td style="text-align: left;"> Shape parameters. </td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>mu</code> </td><td style="text-align: left;"> Location parameter. </td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>sigma</code></td><td style="text-align: left;"> Dispersion parameter.</td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>gamma</code></td><td style="text-align: left;"> Skewness parameter.</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td>
</tr>

</table>

<p>If <code>type</code> is &ldquo;alpha.bar&rdquo; a list with components:
</p>

<table>
<tr>
 <td style="text-align: right;">
  <code>lambda</code> </td><td style="text-align: left;"> Shape parameter. </td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>alpha.bar</code> </td><td style="text-align: left;"> Shape parameter. </td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>mu</code> </td><td style="text-align: left;"> Location parameter. </td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>sigma</code></td><td style="text-align: left;"> Dispersion parameter.</td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>gamma</code></td><td style="text-align: left;"> Skewness parameter.</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td>
</tr>

</table>

<p>If <code>type</code> is &ldquo;alpha.delta&rdquo; a list with components:
</p>

<table>
<tr>
 <td style="text-align: right;">
  <code>lambda</code> </td><td style="text-align: left;"> Shape parameter. </td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>alpha</code> </td><td style="text-align: left;"> Shape parameter. </td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>delta</code></td><td style="text-align: left;"> Shape parameter.</td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>mu</code></td><td style="text-align: left;"> Location parameter.</td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>Delta</code></td><td style="text-align: left;"> Dispersion matrix with a determinant of 1 (only returned in the multivariate case).</td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>beta</code> </td><td style="text-align: left;"> Shape and skewness parameter. </td>
</tr>
<tr>
 <td style="text-align: right;">
  </td>
</tr>

</table>



<h3>Note</h3>

<p>A switch from either the &ldquo;chi/psi&rdquo; to the &ldquo;alpha.bar&rdquo; or
from the &ldquo;alpha/delta&rdquo; to the &ldquo;alpha.bar&rdquo;
parametrization is not yet possible.
</p>


<h3>Author(s)</h3>

<p>David Luethi</p>


<h3>See Also</h3>

<p><code><a href="#topic+ghyp">ghyp</a></code>, <code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code>,
<code><a href="#topic+fit.ghypmv">fit.ghypmv</a></code>, <code><a href="#topic+ghyp.fit.info">ghyp.fit.info</a></code>,
<code><a href="#topic+transform.ghyp">transform</a></code>, <code><a href="#topic++5B.ghyp">[.ghyp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ghyp.mv &lt;- ghyp(lambda = 1, alpha.bar = 0.1, mu = rep(0,2), sigma = diag(rep(1,2)),
                  gamma = rep(0,2), data = matrix(rt(1000, df = 4), ncol = 2))
  ## Get parameters
  coef(ghyp.mv, type = "alpha.bar")
  coefficients(ghyp.mv, type = "chi.psi")

  ## Simple modification (do not modify slots directly e.g. object@mu &lt;- 0:1)
  param &lt;- coef(ghyp.mv, type = "alpha.bar")
  param$mu &lt;- 0:1
  do.call("ghyp", param) # returns a new 'ghyp' object


</code></pre>

<hr>
<h2 id='ESghyp.attribution'>Risk attribution.</h2><span id='topic+ESghyp.attribution'></span>

<h3>Description</h3>

<p>Functions to get the <em>contribution</em> of each asset to the portfolio's 
<em>Expected Shortfall</em> based on multivariate generalized hyperbolic 
distributions as well as the expected shortfall <em>sensitivity</em> to marginal
changes in portfolio allocation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ESghyp.attribution(
  alpha,
  object = ghyp(),
  distr = c("return", "loss"),
  weights = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ESghyp.attribution_+3A_alpha">alpha</code></td>
<td>
<p>a vector of confidence levels for ES.</p>
</td></tr>
<tr><td><code id="ESghyp.attribution_+3A_object">object</code></td>
<td>
<p>a multivariate fitted ghyp object inheriting from class <code><a href="#topic+ghyp-class">ghyp</a></code>.</p>
</td></tr>
<tr><td><code id="ESghyp.attribution_+3A_distr">distr</code></td>
<td>
<p>whether the ghyp-object specifies a return or a loss-distribution (see <b>Details</b>).</p>
</td></tr>
<tr><td><code id="ESghyp.attribution_+3A_weights">weights</code></td>
<td>
<p>vector of portfolio weights. Default is an equally-weighted portfolio.</p>
</td></tr>
<tr><td><code id="ESghyp.attribution_+3A_...">...</code></td>
<td>
<p>optional arguments passed from <a href="#topic+ghyp.attribution-class">ghyp.attribution</a> to <code><a href="#topic+qghyp">qghyp</a></code> and <code><a href="stats.html#topic+integrate">integrate</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parameter <code>distr</code> specifies whether the ghyp-object 
describes a return or a loss-distribution.  In case of a return
distribution the expected-shortfall on a confidence level
<code class="reqn">\alpha</code> is defined as <code class="reqn">\hbox{ES}_\alpha := 
\hbox{E}(X| X \leq F^{-1}_X(\alpha))</code>
while in case of a loss distribution it is defined on a confidence
level <code class="reqn">\alpha</code> as <code class="reqn">\hbox{ES}_\alpha := \hbox{E}(X | X
&gt; F^{-1}_X(\alpha))</code>.<br />
</p>


<h3>Value</h3>

<p><code>ESghyp.attribution</code> is an object of class <a href="#topic+ghyp.attribution-class">ghyp.attribution</a>.
</p>


<h3>Author(s)</h3>

<p>Marc Weibel
</p>


<h3>See Also</h3>

<p><code><a href="#topic+contribution+2Cghyp.attribution-method">contribution,ghyp.attribution-method</a></code>, <code><a href="#topic+sensitivity+2Cghyp.attribution-method">sensitivity,ghyp.attribution-method</a></code> and <code><a href="stats.html#topic+weights">weights</a></code> for Expected Shortfall.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(smi.stocks)
## Fit a NIG model to Novartis, CS and Nestle log-returns
assets.fit &lt;- fit.NIGmv(smi.stocks[, c("Novartis", "CS", "Nestle")], silent = TRUE)
## Define Weights of the Portfolio
weights &lt;- c(0.2, 0.5, 0.3)
## Confidence level for Expected Shortfall
es.levels &lt;- c(0.01)

portfolio.attrib &lt;- ESghyp.attribution(alpha=es.levels, object=assets.fit, weights=weights)

## End(Not run)
</code></pre>

<hr>
<h2 id='fit.ghypmv'>Fitting generalized hyperbolic distributions to multivariate data</h2><span id='topic+fit.ghypmv'></span><span id='topic+fit.hypmv'></span><span id='topic+fit.NIGmv'></span><span id='topic+fit.VGmv'></span><span id='topic+fit.tmv'></span><span id='topic+fit.gaussmv'></span>

<h3>Description</h3>

<p>Perform a maximum likelihood estimation of the parameters of a
multivariate generalized hyperbolic distribution by using an
Expectation Maximization (EM) based algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.ghypmv(data, lambda = 1, alpha.bar = 1, mu = NULL, sigma = NULL,
           gamma = NULL, opt.pars = c(lambda = TRUE, alpha.bar = TRUE, mu = TRUE,
                                      sigma = TRUE, gamma = !symmetric),
           symmetric = FALSE, standardize = FALSE, nit = 2000, reltol = 1e-8,
           abstol = reltol * 10, na.rm = FALSE, silent = FALSE, save.data = TRUE,
           trace = TRUE, ...)

fit.hypmv(data,
          opt.pars = c(alpha.bar = TRUE, mu = TRUE, sigma = TRUE, gamma = !symmetric),
          symmetric = FALSE, ...)

fit.NIGmv(data,
          opt.pars = c(alpha.bar = TRUE, mu = TRUE, sigma = TRUE, gamma = !symmetric),
          symmetric = FALSE, ...)

fit.VGmv(data, lambda = 1,
         opt.pars = c(lambda = TRUE, mu = TRUE, sigma = TRUE, gamma = !symmetric),
         symmetric = FALSE, ...)

fit.tmv(data, nu = 3.5,
        opt.pars = c(lambda = TRUE, mu = TRUE, sigma = TRUE, gamma = !symmetric),
        symmetric = FALSE, ...)

fit.gaussmv(data, na.rm = TRUE, save.data = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.ghypmv_+3A_data">data</code></td>
<td>
<p>An object coercible to a <code>matrix</code>.</p>
</td></tr>
<tr><td><code id="fit.ghypmv_+3A_lambda">lambda</code></td>
<td>
<p>Starting value for the shape parameter <code>lambda</code>.</p>
</td></tr>
<tr><td><code id="fit.ghypmv_+3A_alpha.bar">alpha.bar</code></td>
<td>
<p>Starting value for the shape parameter <code>alpha.bar</code>.</p>
</td></tr>
<tr><td><code id="fit.ghypmv_+3A_nu">nu</code></td>
<td>
<p>Starting value for the shape parameter <code>nu</code> (only used
in case of a student-t distribution. It determines the
degree of freedom and is defined as <code>-2*lambda</code>.)</p>
</td></tr>
<tr><td><code id="fit.ghypmv_+3A_mu">mu</code></td>
<td>
<p>Starting value for the location parameter <code>mu</code>.</p>
</td></tr>
<tr><td><code id="fit.ghypmv_+3A_sigma">sigma</code></td>
<td>
<p>Starting value for the dispersion matrix <code>sigma</code>.</p>
</td></tr>
<tr><td><code id="fit.ghypmv_+3A_gamma">gamma</code></td>
<td>
<p>Starting value for the skewness vecotr <code>gamma</code>.</p>
</td></tr>
<tr><td><code id="fit.ghypmv_+3A_opt.pars">opt.pars</code></td>
<td>
<p>A named logical <code>vector</code> which states which parameters should be fitted.</p>
</td></tr>
<tr><td><code id="fit.ghypmv_+3A_symmetric">symmetric</code></td>
<td>
<p>If <code>TRUE</code> the skewness parameter <code>gamma</code> keeps zero.</p>
</td></tr>
<tr><td><code id="fit.ghypmv_+3A_standardize">standardize</code></td>
<td>
<p>If <code>TRUE</code> the sample will be standardized
before fitting.  Afterwards, the parameters and
log-likelihood et cetera will be back-transformed.</p>
</td></tr>
<tr><td><code id="fit.ghypmv_+3A_save.data">save.data</code></td>
<td>
<p>If <code>TRUE</code> <code>data</code> will be stored within the
<code><a href="#topic+mle.ghyp-class">mle.ghyp</a></code> object
(cf. <code><a href="#topic+ghyp.data">ghyp.data</a></code>).</p>
</td></tr>
<tr><td><code id="fit.ghypmv_+3A_trace">trace</code></td>
<td>
<p>If <code>TRUE</code> the evolution of the parameter values
during the fitting procedure will be traced and stored
(cf. <code><a href="#topic+ghyp.fit.info">ghyp.fit.info</a></code>).</p>
</td></tr>
<tr><td><code id="fit.ghypmv_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>TRUE</code> missing values will be removed from <code>data</code>.</p>
</td></tr>
<tr><td><code id="fit.ghypmv_+3A_silent">silent</code></td>
<td>
<p>If <code>TRUE</code> no prompts will appear in the console.</p>
</td></tr>
<tr><td><code id="fit.ghypmv_+3A_nit">nit</code></td>
<td>
<p>Maximal number of iterations of the expectation maximation algorithm.</p>
</td></tr>
<tr><td><code id="fit.ghypmv_+3A_reltol">reltol</code></td>
<td>
<p>Relative convergence tolerance.</p>
</td></tr>
<tr><td><code id="fit.ghypmv_+3A_abstol">abstol</code></td>
<td>
<p>Absolute convergence tolerance.</p>
</td></tr>
<tr><td><code id="fit.ghypmv_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="stats.html#topic+optim">optim</a></code> and to <code>fit.ghypmv</code> when
fitting special cases of the generalized hyperbolic distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses a modified EM algorithm which is called Multi-Cycle
Expectation Conditional Maximization (MCECM) algorithm. This algorithm
is sketched in the vignette of this package which can be found in the
<code>doc</code> folder. A more detailed description is provided by the book
<em>Quantitative Risk Management, Concepts, Techniques and Tools</em>
(see &ldquo;References&rdquo;). <br />
</p>
<p>The general-purpose optimization routine <code><a href="stats.html#topic+optim">optim</a></code> is used
to maximize the loglikelihood function of the univariate mixing
distribution.  The default method is that of Nelder and Mead which
uses only function values. Parameters of <code><a href="stats.html#topic+optim">optim</a></code> can be
passed via the ... argument of the fitting routines.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+mle.ghyp-class">mle.ghyp</a></code>.
</p>


<h3>Note</h3>

<p>The variance gamma distribution becomes singular when <code class="reqn">\mathbf{x}
  - \mathbf{\mu} = 0</code>. This singularity is catched and the
reduced density function is computed. Because the transition is not
smooth in the numerical implementation this can rarely result in
nonsensical fits.
</p>
<p>Providing both arguments, <code>opt.pars</code> and <code>symmetric</code> respectively,
can result in a conflict when <code>opt.pars['gamma']</code> and <code>symmetric</code>
are <code>TRUE</code>. In this case <code>symmetric</code> will dominate and
<code>opt.pars['gamma']</code> is set to <code>FALSE</code>.
</p>


<h3>Author(s)</h3>

<p>Wolfgang Breymann, David Luethi
</p>


<h3>References</h3>

<p>Alexander J. McNeil, Ruediger Frey, Paul Embrechts (2005)
<em>Quantitative Risk Management, Concepts, Techniques and Tools</em>
<br />
</p>
<p><code>ghyp</code>-package vignette in the <code>doc</code> folder or on
<a href="https://cran.r-project.org/package=ghyp">https://cran.r-project.org/package=ghyp</a>.<br />
</p>
<p>S-Plus and R library <em>QRMlib</em>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code>, <code><a href="#topic+fit.hypuv">fit.hypuv</a></code>,
<code><a href="#topic+fit.NIGuv">fit.NIGuv</a></code>, <code><a href="#topic+fit.VGuv">fit.VGuv</a></code>,
<code><a href="#topic+fit.tuv">fit.tuv</a></code> for univariate fitting routines.
<code><a href="#topic+ghyp.fit.info">ghyp.fit.info</a></code> for information regarding the
fitting procedure.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(smi.stocks)

  fit.ghypmv(data = smi.stocks, opt.pars = c(lambda = FALSE), lambda = 2,
             control = list(rel.tol = 1e-5, abs.tol = 1e-5), reltol = 0.01)
</code></pre>

<hr>
<h2 id='fit.ghypuv'>Fitting generalized hyperbolic distributions to univariate data</h2><span id='topic+fit.ghypuv'></span><span id='topic+fit.hypuv'></span><span id='topic+fit.NIGuv'></span><span id='topic+fit.VGuv'></span><span id='topic+fit.tuv'></span><span id='topic+fit.gaussuv'></span>

<h3>Description</h3>

<p>This function performs a maximum likelihood parameter estimation for
univariate generalized hyperbolic distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.ghypuv(data, lambda = 1, alpha.bar = 0.5, mu = median(data),
           sigma = mad(data), gamma = 0,
           opt.pars = c(lambda = TRUE, alpha.bar = TRUE, mu = TRUE,
                        sigma = TRUE, gamma = !symmetric),
           symmetric = FALSE, standardize = FALSE, save.data = TRUE,
           na.rm = TRUE, silent = FALSE, ...)

fit.hypuv(data,
          opt.pars = c(alpha.bar = TRUE, mu = TRUE, sigma = TRUE, gamma = !symmetric),
          symmetric = FALSE, ...)

fit.NIGuv(data,
          opt.pars = c(alpha.bar = TRUE, mu = TRUE, sigma = TRUE, gamma = !symmetric),
          symmetric = FALSE, ...)

fit.VGuv(data, lambda = 1,
         opt.pars = c(lambda = TRUE, mu = TRUE, sigma = TRUE, gamma = !symmetric),
         symmetric = FALSE, ...)

fit.tuv(data, nu = 3.5,
        opt.pars = c(nu = TRUE, mu = TRUE, sigma = TRUE, gamma = !symmetric),
        symmetric = FALSE, ...)

fit.gaussuv(data, na.rm = TRUE, save.data = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.ghypuv_+3A_data">data</code></td>
<td>
<p>An object coercible to a <code>vector</code>.</p>
</td></tr>
<tr><td><code id="fit.ghypuv_+3A_lambda">lambda</code></td>
<td>
<p>Starting value for the shape parameter <code>lambda</code>.</p>
</td></tr>
<tr><td><code id="fit.ghypuv_+3A_alpha.bar">alpha.bar</code></td>
<td>
<p>Starting value for the shape parameter <code>alpha.bar</code>.</p>
</td></tr>
<tr><td><code id="fit.ghypuv_+3A_nu">nu</code></td>
<td>
<p>Starting value for the shape parameter <code>nu</code> (only used in case of a student-t distribution. It determines
the degree of freedom and is defined as <code>-2*lambda</code>.)</p>
</td></tr>
<tr><td><code id="fit.ghypuv_+3A_mu">mu</code></td>
<td>
<p>Starting value for the location parameter <code>mu</code>.</p>
</td></tr>
<tr><td><code id="fit.ghypuv_+3A_sigma">sigma</code></td>
<td>
<p>Starting value for the dispersion parameter <code>sigma</code>.</p>
</td></tr>
<tr><td><code id="fit.ghypuv_+3A_gamma">gamma</code></td>
<td>
<p>Starting value for the skewness parameter <code>gamma</code>.</p>
</td></tr>
<tr><td><code id="fit.ghypuv_+3A_opt.pars">opt.pars</code></td>
<td>
<p>A named logical <code>vector</code> which states which parameters should be fitted.</p>
</td></tr>
<tr><td><code id="fit.ghypuv_+3A_symmetric">symmetric</code></td>
<td>
<p>If <code>TRUE</code> the skewness parameter <code>gamma</code> keeps zero.</p>
</td></tr>
<tr><td><code id="fit.ghypuv_+3A_standardize">standardize</code></td>
<td>
<p>If <code>TRUE</code> the sample will be standardized before fitting.
Afterwards, the parameters and log-likelihood et cetera will be back-transformed.</p>
</td></tr>
<tr><td><code id="fit.ghypuv_+3A_save.data">save.data</code></td>
<td>
<p>If <code>TRUE</code> <code>data</code> will be stored within the
<code><a href="#topic+mle.ghyp-class">mle.ghyp</a></code> object.</p>
</td></tr>
<tr><td><code id="fit.ghypuv_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>TRUE</code> missing values will be removed from <code>data</code>.</p>
</td></tr>
<tr><td><code id="fit.ghypuv_+3A_silent">silent</code></td>
<td>
<p>If <code>TRUE</code> no prompts will appear in the console.</p>
</td></tr>
<tr><td><code id="fit.ghypuv_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="stats.html#topic+optim">optim</a></code> and to <code>fit.ghypuv</code> when
fitting special cases of the generalized hyperbolic distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The general-purpose optimization routine <code><a href="stats.html#topic+optim">optim</a></code> is used to
maximize the loglikelihood function. The default method is that of
Nelder and Mead which uses only function values. Parameters of
<code><a href="stats.html#topic+optim">optim</a></code> can be passed via the ... argument of the fitting
routines.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+mle.ghyp-class">mle.ghyp</a></code>.
</p>


<h3>Note</h3>

<p>The variance gamma distribution becomes singular when <code class="reqn">x - \mu =
  0</code>. This singularity is catched and the reduced density
function is computed. Because the transition is not smooth in the
numerical implementation this can rarely result in nonsensical fits.
</p>
<p>Providing both arguments, <code>opt.pars</code> and <code>symmetric</code>
respectively, can result in a conflict when <code>opt.pars['gamma']</code>
and <code>symmetric</code> are <code>TRUE</code>. In this case <code>symmetric</code>
will dominate and <code>opt.pars['gamma']</code> is set to <code>FALSE</code>.
</p>


<h3>Author(s)</h3>

<p>Wolfgang Breymann, David Luethi
</p>


<h3>References</h3>

<p><code>ghyp</code>-package vignette in the <code>doc</code> folder or on <a href="https://cran.r-project.org/package=ghyp">https://cran.r-project.org/package=ghyp</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit.ghypmv">fit.ghypmv</a></code>, <code><a href="#topic+fit.hypmv">fit.hypmv</a></code>, <code><a href="#topic+fit.NIGmv">fit.NIGmv</a></code>,
<code><a href="#topic+fit.VGmv">fit.VGmv</a></code>, <code><a href="#topic+fit.tmv">fit.tmv</a></code> for multivariate fitting routines.
<code><a href="#topic+ghyp.fit.info">ghyp.fit.info</a></code> for information regarding the fitting procedure.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(smi.stocks)

  nig.fit &lt;- fit.NIGuv(smi.stocks[,"SMI"], opt.pars = c(alpha.bar = FALSE),
                       alpha.bar = 1, control = list(abstol = 1e-8))
  nig.fit

  summary(nig.fit)

  hist(nig.fit)
</code></pre>

<hr>
<h2 id='ghyp-constructors'>Create generalized hyperbolic distribution objects</h2><span id='topic+ghyp'></span><span id='topic+hyp'></span><span id='topic+NIG'></span><span id='topic+student.t'></span><span id='topic+VG'></span><span id='topic+gauss'></span><span id='topic+ghyp.ad'></span><span id='topic+hyp.ad'></span><span id='topic+NIG.ad'></span><span id='topic+student.t.ad'></span><span id='topic+VG.ad'></span>

<h3>Description</h3>

<p>Constructor functions for univariate and multivariate generalized
hyperbolic distribution objects and their special cases in one of the
parametrizations &ldquo;chi/psi&rdquo;, &ldquo;alpha.bar&rdquo; and
&ldquo;alpha/delta&rdquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ghyp(lambda = 0.5, chi = 0.5, psi = 2, mu = 0, sigma = diag(rep(1, length(mu))),
     gamma = rep(0, length(mu)), alpha.bar = NULL, data = NULL)

ghyp.ad(lambda = 0.5, alpha = 1.5, delta = 1, beta = rep(0, length(mu)),
        mu = 0, Delta = diag(rep(1, length(mu))), data = NULL)


hyp(chi = 0.5, psi = 2, mu = 0, sigma = diag(rep(1, length(mu))),
    gamma = rep(0, length(mu)), alpha.bar = NULL, data = NULL)

hyp.ad(alpha = 1.5, delta = 1, beta = rep(0, length(mu)), mu = 0,
       Delta = diag(rep(1, length(mu))), data = NULL)


NIG(chi = 2, psi = 2, mu = 0, sigma = diag(rep(1, length(mu))),
    gamma = rep(0, length(mu)), alpha.bar = NULL, data = NULL)

NIG.ad(alpha = 1.5, delta = 1, beta = rep(0, length(mu)), mu = 0,
       Delta = diag(rep(1, length(mu))), data = NULL)


student.t(nu = 3.5, chi = nu - 2, mu = 0, sigma = diag(rep(1, length(mu))),
          gamma = rep(0, length(mu)), data = NULL)

student.t.ad(lambda = -2, delta = 1, beta = rep(0, length(mu)), mu = 0,
             Delta = diag(rep(1, length(mu))), data = NULL)


VG(lambda = 1, psi = 2*lambda, mu = 0, sigma = diag(rep(1, length(mu))),
   gamma = rep(0, length(mu)), data = NULL)

VG.ad(lambda = 2, alpha = 1.5, beta = rep(0, length(mu)), mu = 0,
      Delta = diag(rep(1, length(mu))), data = NULL)

gauss(mu = 0, sigma = diag(rep(1, length(mu))), data = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ghyp-constructors_+3A_lambda">lambda</code></td>
<td>
<p>Shape parameter. Common for all parametrizations.</p>
</td></tr>
<tr><td><code id="ghyp-constructors_+3A_nu">nu</code></td>
<td>
<p>Shape parameter only used in case of a Student-t distribution in the &ldquo;chi/psi&rdquo; and &ldquo;alpha.bar&rdquo; parametrization . It determines
the degree of freedom.</p>
</td></tr>
<tr><td><code id="ghyp-constructors_+3A_chi">chi</code></td>
<td>
<p>Shape parameter of the &ldquo;chi/psi&rdquo; parametrization.</p>
</td></tr>
<tr><td><code id="ghyp-constructors_+3A_psi">psi</code></td>
<td>
<p>Shape parameter of the &ldquo;chi/psi&rdquo; parametrization.</p>
</td></tr>
<tr><td><code id="ghyp-constructors_+3A_alpha">alpha</code></td>
<td>
<p>Shape parameter of the &ldquo;alpha/delta&rdquo; parametrization.</p>
</td></tr>
<tr><td><code id="ghyp-constructors_+3A_delta">delta</code></td>
<td>
<p>Shape parameter of the &ldquo;alpha/delta&rdquo; parametrization.</p>
</td></tr>
<tr><td><code id="ghyp-constructors_+3A_alpha.bar">alpha.bar</code></td>
<td>
<p>Shape parameter of the &ldquo;alpha.bar&rdquo; parametrization.
Supplying &ldquo;alpha.bar&rdquo; makes the parameters &ldquo;chi&rdquo; and &ldquo;psi&rdquo;
redundant.</p>
</td></tr>
<tr><td><code id="ghyp-constructors_+3A_mu">mu</code></td>
<td>
<p>Location parameter. Either a scalar or a vector. Common for all parametrizations.</p>
</td></tr>
<tr><td><code id="ghyp-constructors_+3A_sigma">sigma</code></td>
<td>
<p>Dispersion parameter of the &ldquo;chi/psi&rdquo; parametrization. Either a scalar or a matrix.</p>
</td></tr>
<tr><td><code id="ghyp-constructors_+3A_delta">Delta</code></td>
<td>
<p>Dispersion parameter. Must be a matrix with a determinant of 1.
This parameter is only used in the multivariate case of the &ldquo;alpha.beta&rdquo; parametrization.</p>
</td></tr>
<tr><td><code id="ghyp-constructors_+3A_gamma">gamma</code></td>
<td>
<p>Skewness parameter of the &ldquo;chi/psi&rdquo; parametrization. Either a scalar or a vector.</p>
</td></tr>
<tr><td><code id="ghyp-constructors_+3A_beta">beta</code></td>
<td>
<p>Skewness parameter of the &ldquo;alpha/delta&rdquo; parametrization. Either a scalar or a vector.</p>
</td></tr>
<tr><td><code id="ghyp-constructors_+3A_data">data</code></td>
<td>
<p>An object coercible to a <code>vector</code> (univariate case)
or <code>matrix</code> (multivariate case).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions serve as constructors for univariate and multivariate
objects. <br />
</p>
<p><code>ghyp</code>, <code>hyp</code> and <code>NIG</code> are constructor functions
for both the &ldquo;chi/psi&rdquo; and the &ldquo;alpha.bar&rdquo;
parametrization.  Whenever <code>alpha.bar</code> is not <code>NULL</code> it is
assumed that the &ldquo;alpha.bar&rdquo; parametrization is used and the
parameters &ldquo;chi&rdquo; and &ldquo;psi&rdquo; become redundant. <br />
</p>
<p>Similarly, the variance gamma (VG) and the Student-t distribution
share the same constructor function for both the <code>chi/psi</code> and
<code>alpha.bar</code> parametrization. To initialize them in the
<code>alpha.bar</code> parametrization simply omit the argument <code>psi</code>
and <code>chi</code>, respectively. If <code>psi</code> or <code>chi</code> are
submitted, the &ldquo;chi/psi&rdquo; parametrization will be used.<br />
</p>
<p><code>ghyp.ad</code>, <code>hyp.ad</code>, <code>NIG.ad</code>, <code>student.t.ad</code> and
<code>VG.ad</code> use the &ldquo;alpha/delta&rdquo; parametrization.  <br />
</p>
<p>The following table gives the constructors for each combination of
distribution and parametrization.
</p>

<table>
<tr>
 <td style="text-align: center;">
      </td><td style="text-align: center;">   </td><td style="text-align: center;">  <b>Parametrization</b>  </td><td style="text-align: center;">  </td>
</tr>
<tr>
 <td style="text-align: center;">
      <b>Distribution</b>  </td><td style="text-align: center;"> &ldquo;chi/psi&rdquo; </td><td style="text-align: center;"> &ldquo;alpha.bar&rdquo; </td><td style="text-align: center;"> &ldquo;alpha/delta&rdquo; </td>
</tr>
<tr>
 <td style="text-align: center;">
    GH </td><td style="text-align: center;"> <code>ghyp(...)</code> </td><td style="text-align: center;"> <code>ghyp(..., alpha.bar=x)</code> </td><td style="text-align: center;"> <code>ghyp.ad(...)</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
    hyp </td><td style="text-align: center;"> <code>hyp(...)</code> </td><td style="text-align: center;"> <code>hyp(..., alpha.bar=x)</code> </td><td style="text-align: center;"> <code>hyp.ad(...)</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
    NIG </td><td style="text-align: center;"> <code>NIG(...)</code> </td><td style="text-align: center;"> <code>NIG(..., alpha.bar=x)</code> </td><td style="text-align: center;"> <code>NIG.ad(...)</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
    Student-t </td><td style="text-align: center;"> <code>student.t(..., chi=x)</code> </td><td style="text-align: center;"> <code>student.t(...)</code> </td><td style="text-align: center;"> <code>student.t.ad(...)</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
    VG </td><td style="text-align: center;"> <code>VG(..., psi=x)</code> </td><td style="text-align: center;"> <code>VG(...)</code> </td><td style="text-align: center;">   <code>VG.ad(...)</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
  </td>
</tr>

</table>

<p>Have a look on the vignette of this package in the <code>doc</code> folder
for further information regarding the parametrization and for the
domains of variation of the parameters.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+ghyp-class">ghyp</a></code>.
</p>


<h3>Note</h3>

<p>The Student-t parametrization obtained via the &ldquo;alpha.bar&rdquo;
parametrization slightly differs from the common Student-t
parametrization: The parameter <code>sigma</code> denotes the standard
deviation in the univariate case and the variance in the multivariate
case.  Thus, set <code class="reqn">\sigma = \sqrt{\nu /(\nu - 2)}</code> in the univariate case to get the same results as with the
standard <span class="rlang"><b>R</b></span> implementation of the Student-t distribution. <br />
</p>
<p>In case of non-finite variance, the &ldquo;alpha.bar&rdquo; parametrization
does not work because <code>sigma</code> is defined to be the standard
deviation. In this case the &ldquo;chi/psi&rdquo; parametrization can be
used by submitting the parameter <code>chi</code>. To obtain equal results
as the standard <span class="rlang"><b>R</b></span> implmentation use <code>student.t(nu = nu, chi =
  nu)</code> (see <b>Examples</b>).<br />
</p>
<p>Have a look on the vignette of this package in the
<code>doc</code> folder for further information. <br />
</p>
<p>Once an object of class <code><a href="#topic+ghyp-class">ghyp</a></code> is created the
methods <code>Xghyp</code> have to be used even when the distribution is a
special case of the GH distribution.  E.g. do not use <code>dVG</code>.  Use
<code><a href="#topic+dghyp">dghyp</a></code> and submit a variance gamma distribution created
with <code>VG()</code>.
</p>


<h3>Author(s)</h3>

<p> David Luethi </p>


<h3>References</h3>

<p><code>ghyp</code>-package vignette in the <code>doc</code> folder or on <a href="https://cran.r-project.org/package=ghyp">https://cran.r-project.org/package=ghyp</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ghyp-class">ghyp-class</a></code> for a summary of generic methods assigned to <code>ghyp</code> objects,
<code><a href="#topic+coef.ghyp">coef</a></code> for switching between different parametrizations,
<code><a href="#topic+dghyp">d/p/q/r/ES/gyhp</a></code> for density, distribution function et cetera,
<code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code> and <code><a href="#topic+fit.ghypmv">fit.ghypmv</a></code> for fitting routines.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## alpha.bar parametrization of a univariate GH distribution
  ghyp(lambda=2, alpha.bar=0.1, mu=0, sigma=1, gamma=0)
  ## lambda/chi parametrization of a univariate GH distribution
  ghyp(lambda=2, chi=1, psi=0.5, mu=0, sigma=1, gamma=0)
  ## alpha/delta parametrization of a univariate GH distribution
  ghyp.ad(lambda=2, alpha=0.5, delta=1, mu=0, beta=0)

  ## alpha.bar parametrization of a multivariate GH distribution
  ghyp(lambda=1, alpha.bar=0.1, mu=2:3, sigma=diag(1:2), gamma=0:1)
  ## lambda/chi parametrization of a multivariate GH distribution
  ghyp(lambda=1, chi=1, psi=0.5, mu=2:3, sigma=diag(1:2), gamma=0:1)
  ## alpha/delta parametrization of a multivariate GH distribution
  ghyp.ad(lambda=1, alpha=2.5, delta=1, mu=2:3, Delta=diag(c(1,1)), beta=0:1)

  ## alpha.bar parametrization of a univariate hyperbolic distribution
  hyp(alpha.bar=0.3, mu=1, sigma=0.1, gamma=0)
  ## lambda/chi parametrization of a univariate hyperbolic distribution
  hyp(chi=1, psi=2, mu=1, sigma=0.1, gamma=0)
  ## alpha/delta parametrization of a univariate hyperbolic distribution
  hyp.ad(alpha=0.5, delta=1, mu=0, beta=0)

  ## alpha.bar parametrization of a univariate NIG distribution
  NIG(alpha.bar=0.3, mu=1, sigma=0.1, gamma=0)
  ## lambda/chi parametrization of a univariate NIG distribution
  NIG(chi=1, psi=2, mu=1, sigma=0.1, gamma=0)
  ## alpha/delta parametrization of a univariate NIG distribution
  NIG.ad(alpha=0.5, delta=1, mu=0, beta=0)

  ## alpha.bar parametrization of a univariate VG distribution
  VG(lambda=2, mu=1, sigma=0.1, gamma=0)
  ## alpha/delta parametrization of a univariate VG distribution
  VG.ad(lambda=2, alpha=0.5, mu=0, beta=0)

  ## alpha.bar parametrization of a univariate t distribution
  student.t(nu = 3, mu=1, sigma=0.1, gamma=0)
  ## alpha/delta parametrization of a univariate t distribution
  student.t.ad(lambda=-2, delta=1, mu=0, beta=1)

  ## Obtain equal results as with the R-core parametrization
  ## of the t distribution:
  nu &lt;- 4
  standard.R.chi.psi &lt;- student.t(nu = nu, chi = nu)
  standard.R.alpha.bar &lt;- student.t(nu = nu, sigma = sqrt(nu  /(nu - 2)))

  random.sample &lt;- rnorm(3)
  dt(random.sample, nu)
  dghyp(random.sample, standard.R.chi.psi)   # all implementations yield...
  dghyp(random.sample, standard.R.alpha.bar) # ...the same values

  random.quantiles &lt;- runif(4)
  qt(random.quantiles, nu)
  qghyp(random.quantiles, standard.R.chi.psi)   # all implementations yield...
  qghyp(random.quantiles, standard.R.alpha.bar) # ...the same values

  ## If nu &lt;= 2 the "alpha.bar" parametrization does not exist, but the
  ## "chi/psi" parametrization. The case of a Cauchy distribution:
  nu &lt;- 1
  standard.R.chi.psi &lt;- student.t(nu = nu, chi = nu)

  dt(random.sample, nu)
  dghyp(random.sample, standard.R.chi.psi)   # both give the same result

  pt(random.sample, nu)
  pghyp(random.sample, standard.R.chi.psi) # both give the same result

</code></pre>

<hr>
<h2 id='ghyp-distribution'>The Generalized Hyperbolic Distribution</h2><span id='topic+dghyp'></span><span id='topic+pghyp'></span><span id='topic+rghyp'></span><span id='topic+qghyp'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function, expected-shortfall
and random generation for the univariate and multivariate generalized
hyperbolic distribution and its special cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dghyp(x, object = ghyp(), logvalue = FALSE)

pghyp(q, object = ghyp(), n.sim = 10000, subdivisions = 200,
      rel.tol = .Machine$double.eps^0.5, abs.tol = rel.tol,
      lower.tail = TRUE)

qghyp(p, object = ghyp(), method = c("integration", "splines"),
      spline.points = 200, subdivisions = 200,
      root.tol = .Machine$double.eps^0.5,
      rel.tol = root.tol^1.5, abs.tol = rel.tol)

rghyp(n, object = ghyp())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ghyp-distribution_+3A_p">p</code></td>
<td>
<p>A vector of probabilities.</p>
</td></tr>
<tr><td><code id="ghyp-distribution_+3A_x">x</code></td>
<td>
<p>A vector, matrix or data.frame of quantiles.</p>
</td></tr>
<tr><td><code id="ghyp-distribution_+3A_q">q</code></td>
<td>
<p>A vector, matrix or data.frame of quantiles.</p>
</td></tr>
<tr><td><code id="ghyp-distribution_+3A_n">n</code></td>
<td>
<p>Number of observations.</p>
</td></tr>
<tr><td><code id="ghyp-distribution_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code><a href="#topic+ghyp-class">ghyp</a></code>.</p>
</td></tr>
<tr><td><code id="ghyp-distribution_+3A_logvalue">logvalue</code></td>
<td>
<p>If <code>TRUE</code> the logarithm of the density will be returned.</p>
</td></tr>
<tr><td><code id="ghyp-distribution_+3A_n.sim">n.sim</code></td>
<td>
<p>The number of simulations when computing <code>pghyp</code> of a multivariate
generalized hyperbolic distribution.</p>
</td></tr>
<tr><td><code id="ghyp-distribution_+3A_subdivisions">subdivisions</code></td>
<td>
<p>The number of subdivisions passed to <code><a href="stats.html#topic+integrate">integrate</a></code> when
computing the distribution function <code>pghyp</code> of a
univariate generalized hyperbolic distribution.</p>
</td></tr>
<tr><td><code id="ghyp-distribution_+3A_rel.tol">rel.tol</code></td>
<td>
<p>The relative accuracy requested from  <code><a href="stats.html#topic+integrate">integrate</a></code>.</p>
</td></tr>
<tr><td><code id="ghyp-distribution_+3A_abs.tol">abs.tol</code></td>
<td>
<p>The absolute accuracy requested from  <code><a href="stats.html#topic+integrate">integrate</a></code>.</p>
</td></tr>
<tr><td><code id="ghyp-distribution_+3A_lower.tail">lower.tail</code></td>
<td>
<p>If TRUE (default), probabilities are
<code class="reqn">P[X \le x]</code>, otherwise, <code class="reqn">P[X &gt; x]</code>.</p>
</td></tr>
<tr><td><code id="ghyp-distribution_+3A_method">method</code></td>
<td>
<p>The method how quantiles are computed (see <b>Details</b>).</p>
</td></tr>
<tr><td><code id="ghyp-distribution_+3A_spline.points">spline.points</code></td>
<td>
<p>The number of support points when computing the quantiles with the method
&ldquo;splines&rdquo; instead of &ldquo;integration&rdquo;.</p>
</td></tr>
<tr><td><code id="ghyp-distribution_+3A_root.tol">root.tol</code></td>
<td>
<p>The tolerance of <code><a href="stats.html#topic+uniroot">uniroot</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>qghyp</code> only works for univariate generalized hyperbolic
distributions. <br />
</p>
<p><code>pghyp</code> performs a numeric integration of the density in the
univariate case. The multivariate cumulative distribution is computed
by means of monte carlo simulation. <br />
</p>
<p><code>qghyp</code> computes the quantiles either by using the
&ldquo;integration&rdquo; method where the root of the distribution
function is solved or via &ldquo;splines&rdquo; which interpolates the
distribution function and solves it with <code><a href="stats.html#topic+uniroot">uniroot</a></code>
afterwards. The &ldquo;integration&rdquo; method is recommended when only
few quantiles are required. If more than approximately 20 quantiles
are needed to be calculated the &ldquo;splines&rdquo; method becomes
faster.  The accuracy can be controlled with an adequate setting of
the parameters <code>rel.tol</code>, <code>abs.tol</code>, <code>root.tol</code> and
<code>spline.points</code>.<br />
</p>
<p><code>rghyp</code> uses the random generator for generalized inverse
Gaussian distributed random variates from the Rmetrics package
<em>fBasics</em> (cf. <code><a href="#topic+rgig">rgig</a></code>).
</p>


<h3>Value</h3>

<p><code>dghyp</code> gives the density, <br /> <code>pghyp</code> gives the distribution function, <br />
<code>qghyp</code> gives the quantile function, <br />
<code>rghyp</code> generates random deviates.
</p>


<h3>Note</h3>

<p>Objects generated with <code><a href="#topic+hyp">hyp</a></code>, <code><a href="#topic+NIG">NIG</a></code>,
<code><a href="#topic+VG">VG</a></code> and <code><a href="#topic+student.t">student.t</a></code> have to use <code>Xghyp</code>
as well. E.g. <code>dNIG(0, NIG())</code> does not work but <code>dghyp(0,
  NIG())</code>.<br />
</p>
<p>When the skewness becomes very large the functions using <code>qghyp</code>
may fail.  The functions <code><a href="#topic+qqghyp">qqghyp</a></code>,
<code><a href="#topic+pairs.ghyp">pairs</a></code> and <code><a href="#topic+portfolio.optimize">portfolio.optimize</a></code>
are based on <code>qghyp</code>.
</p>


<h3>Author(s)</h3>

<p>David Luethi</p>


<h3>References</h3>

<p><code>ghyp</code>-package vignette in the <code>doc</code> folder or on
<a href="https://cran.r-project.org/package=ghyp">https://cran.r-project.org/package=ghyp</a> and references
therein.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ghyp-class">ghyp-class</a></code> definition, <code><a href="#topic+ghyp">ghyp</a></code> constructors,
fitting routines <code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code> and <code><a href="#topic+fit.ghypmv">fit.ghypmv</a></code>,
risk and performance measurement <code><a href="#topic+ESghyp">ESghyp</a></code> and <code><a href="#topic+ghyp.omega">ghyp.omega</a></code>,
<code><a href="#topic+transform.ghyp">transformation</a></code> and <code><a href="#topic+transform.ghyp">subsettting</a></code> of <code>ghyp</code> objects,
<code><a href="stats.html#topic+integrate">integrate</a></code>, <code><a href="stats.html#topic+spline">spline</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Univariate generalized hyperbolic distribution
  univariate.ghyp &lt;- ghyp()

  par(mfrow=c(5, 1))

  quantiles &lt;- seq(-4, 4, length = 500)
  plot(quantiles, dghyp(quantiles, univariate.ghyp))
  plot(quantiles, pghyp(quantiles, univariate.ghyp))

  probabilities &lt;- seq(1e-4, 1-1e-4, length = 500)
  plot(probabilities, qghyp(probabilities, univariate.ghyp, method = "splines"))

  hist(rghyp(n=10000,univariate.ghyp),nclass=100)

  ## Mutivariate generalized hyperbolic distribution
  multivariate.ghyp &lt;- ghyp(sigma=var(matrix(rnorm(10),ncol=2)),mu=1:2,gamma=-(2:1))

  par(mfrow=c(2, 1))

  quantiles &lt;- outer(seq(-4, 4, length = 50), c(1, 1))
  plot(quantiles[, 1], dghyp(quantiles, multivariate.ghyp))
  plot(quantiles[, 1], pghyp(quantiles, multivariate.ghyp, n.sim = 1000))

  rghyp(n = 10, multivariate.ghyp)
</code></pre>

<hr>
<h2 id='ghyp-get'>Get methods for objects inheriting from class ghyp</h2><span id='topic+ghyp.data'></span><span id='topic+ghyp.name'></span><span id='topic+ghyp.fit.info'></span><span id='topic+ghyp.dim'></span>

<h3>Description</h3>

<p>These functions simply return data stored within generalized
hyperbolic distribution objects, i.e. slots of the classes <code>ghyp</code>
and <code>mle.ghyp</code>.  <code>ghyp.fit.info</code> extracts information about
the fitting procedure from objects of class
<code><a href="#topic+mle.ghyp-class">mle.ghyp</a></code>. <code>ghyp.data</code> returns the
data slot of a <code>gyhp</code> object. <code>ghyp.dim</code> returns the
dimension of a <code>gyhp</code> object. <code>ghyp.name</code> returns the
name of the distribution of a <code>gyhp</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ghyp.fit.info(object)

ghyp.data(object)

ghyp.name(object, abbr = FALSE, skew.attr = TRUE)

ghyp.dim(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ghyp-get_+3A_object">object</code></td>
<td>
<p>An object inheriting from class
<code><a href="#topic+ghyp-class">ghyp</a></code>.</p>
</td></tr>
<tr><td><code id="ghyp-get_+3A_abbr">abbr</code></td>
<td>
<p>If <code>TRUE</code> the abbreviation of the <code>ghyp</code> distribution will be returned.</p>
</td></tr>
<tr><td><code id="ghyp-get_+3A_skew.attr">skew.attr</code></td>
<td>
<p>If <code>TRUE</code> an attribute will be added to the name of the <code>ghyp</code> distribution stating whether the distribution is symmetric or not.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ghyp.fit.info</code> returns list with components:
</p>

<table>
<tr>
 <td style="text-align: right;">
  <code>logLikelihood</code> </td><td style="text-align: left;">  The maximized log-likelihood value.</td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>aic</code> </td><td style="text-align: left;">  The Akaike information criterion.</td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>fitted.params</code> </td><td style="text-align: left;">  A boolean vector stating which parameters were fitted.</td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>converged</code> </td><td style="text-align: left;">  A boolean whether <code><a href="stats.html#topic+optim">optim</a></code> converged or not.</td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>n.iter</code> </td><td style="text-align: left;"> The number of iterations. </td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>error.code</code> </td><td style="text-align: left;"> Error code from <code><a href="stats.html#topic+optim">optim</a></code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>error.message</code> </td><td style="text-align: left;"> Error message from <code><a href="stats.html#topic+optim">optim</a></code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>parameter.variance</code> </td><td style="text-align: left;"> Parameter variance (only for univariate fits).</td>
</tr>
<tr>
 <td style="text-align: right;">
  <code>trace.pars</code> </td><td style="text-align: left;"> Trace values of the parameters during the fitting procedure.</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td>
</tr>

</table>

<p><code>ghyp.data</code> returns <code>NULL</code> if no data is stored within the
object, a <code>vector</code> if it is an univariate generalized hyperbolic
distribution and <code>matrix</code> if it is an multivariate generalized
hyperbolic distribution.<br />
</p>
<p><code>ghyp.name</code> returns the name of the <code>ghyp</code> distribution which can be the name of a special case.
Depending on the arguments <code>abbr</code> and <code>skew.attr</code> one of the following is returned.
</p>

<table>
<tr>
 <td style="text-align: left;">
  <code>abbr == FALSE &amp; skew.attr == TRUE</code> </td><td style="text-align: left;">  <code>abbr == TRUE &amp; skew.attr == TRUE</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
  (A)symmetric Generalized Hyperbolic </td><td style="text-align: left;">   (A)symm ghyp </td>
</tr>
<tr>
 <td style="text-align: left;">
  (A)symmetric Hyperbolic </td><td style="text-align: left;">   (A)symm hyp </td>
</tr>
<tr>
 <td style="text-align: left;">
  (A)symmetric Normal Inverse Gaussian </td><td style="text-align: left;">   (A)symm NIG </td>
</tr>
<tr>
 <td style="text-align: left;">
  (A)symmetric Variance Gamma </td><td style="text-align: left;">   (A)symm VG </td>
</tr>
<tr>
 <td style="text-align: left;">
  (A)symmetric Student-t </td><td style="text-align: left;">   (A)symm t </td>
</tr>
<tr>
 <td style="text-align: left;">
  Gaussian </td><td style="text-align: left;">   Gauss </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>abbr == FALSE &amp; skew.attr == FALSE</code> </td><td style="text-align: left;">  <code>abbr == TRUE &amp; skew.attr == FALSE</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
  Generalized Hyperbolic </td><td style="text-align: left;"> ghyp  </td>
</tr>
<tr>
 <td style="text-align: left;">
  Hyperbolic </td><td style="text-align: left;">   hyp </td>
</tr>
<tr>
 <td style="text-align: left;">
  Normal Inverse Gaussian </td><td style="text-align: left;">   NIG </td>
</tr>
<tr>
 <td style="text-align: left;">
  Variance Gamma </td><td style="text-align: left;">   VG </td>
</tr>
<tr>
 <td style="text-align: left;">
  Student-t </td><td style="text-align: left;">   t </td>
</tr>
<tr>
 <td style="text-align: left;">
  Gaussian </td><td style="text-align: left;">   Gauss </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p><code>ghyp.dim</code> returns the dimension of a <code>ghyp</code> object.<br />
</p>


<h3>Note</h3>

<p><code>ghyp.fit.info</code> requires an object of class
<code><a href="#topic+mle.ghyp-class">mle.ghyp</a></code>. In the univariate case the
parameter variance is returned as well. The parameter variance is
defined as the inverse of the negative hesse-matrix computed by
<code><a href="stats.html#topic+optim">optim</a></code>. Note that this makes sense only in the case that
the estimates are asymptotically normal distributed. <br />
</p>
<p>The class <code><a href="#topic+ghyp-class">ghyp</a></code> contains a <code>data</code> slot.
Data can be stored either when an object is initialized or via the
fitting routines and the argument <code>save.data</code>.
</p>


<h3>Author(s)</h3>

<p>David Luethi</p>


<h3>See Also</h3>

<p><code><a href="#topic+coef.ghyp">coef</a></code>, <code><a href="#topic+mean.ghyp">mean</a></code>, <code><a href="#topic+vcov.ghyp">vcov</a></code>,
<code><a href="#topic+logLik.mle.ghyp">logLik</a></code>, <code><a href="#topic+AIC.mle.ghyp">AIC</a></code> for other accessor functions,
<code><a href="#topic+fit.ghypmv">fit.ghypmv</a></code>, <code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code>, <code><a href="#topic+ghyp">ghyp</a></code> for constructor functions,
<code><a href="stats.html#topic+optim">optim</a></code> for possible error messages.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## multivariate generalized hyperbolic distribution
  ghyp.mv &lt;- ghyp(lambda = 1, alpha.bar = 0.1, mu = rep(0, 2), sigma = diag(rep(1, 2)),
                  gamma = rep(0, 2), data = matrix(rt(1000, df = 4), ncol = 2))

  ## Get data
  ghyp.data(ghyp.mv)

  ## Get the dimension
  ghyp.dim(ghyp.mv)

  ## Get the name of the ghyp object
  ghyp.name(ghyp(alpha.bar = 0))
  ghyp.name(ghyp(alpha.bar = 0, lambda = -4), abbr = TRUE)

  ## 'ghyp.fit.info' does only work when the object is of class 'mle.ghyp',
  ## i.e. is created by 'fit.ghypuv' etc.
  mv.fit &lt;- fit.tmv(data = ghyp.data(ghyp.mv), control = list(abs.tol = 1e-3))
  ghyp.fit.info(mv.fit)
</code></pre>

<hr>
<h2 id='ghyp-internal'>Internal ghyp functions</h2><span id='topic+ghyp.internal'></span><span id='topic+.abar2chipsi'></span><span id='topic+.besselM3'></span><span id='topic+.check.data'></span><span id='topic+.check.gig.pars'></span><span id='topic+.check.norm.pars'></span><span id='topic+.check.opt.pars'></span><span id='topic+.fit.ghyp'></span><span id='topic+.ghyp.model'></span><span id='topic+.t.transform'></span><span id='topic+.inv.t.transform'></span><span id='topic+.integrate.moment.gig'></span><span id='topic+.integrate.moment.ghypuv'></span><span id='topic+.dghypuv'></span><span id='topic+.dghypmv'></span><span id='topic+.mle.default'></span><span id='topic+.p.default'></span><span id='topic+.q.default'></span><span id='topic+.test.ghyp'></span><span id='topic+.is.gaussian'></span><span id='topic+.is.univariate'></span><span id='topic+.is.symmetric'></span><span id='topic+.is.student.t'></span><span id='topic+.get.stepAIC.ghyp'></span>

<h3>Description</h3>

<p>Internal ghyp functions. These functions are not to be called by the
user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.abar2chipsi(alpha.bar, lambda, eps = .Machine$double.eps)

.besselM3(lambda = 9/2, x = 2, logvalue = FALSE)

.check.data(data, case = c("uv", "mv"), na.rm = TRUE,
            fit = TRUE, dim = NULL)

.check.gig.pars(lambda, chi, psi)

.check.norm.pars(mu, sigma, gamma, dimension)

.check.opt.pars(opt.pars, symmetric)

.fit.ghyp(object, llh = 0, n.iter = 0, converged = FALSE, error.code = 0,
          error.message = "", parameter.variance, fitted.params, aic,
          trace.pars = list())

.ghyp.model(lambda, chi, psi, gamma)

.t.transform(lambda)

.inv.t.transform(lambda.transf)

.integrate.moment.gig(x, moment = 1, ...)

.integrate.moment.ghypuv(x, moment = 1, ...)

.dghypuv(x, lambda = 1, chi = 1, psi = 1, alpha.bar = NULL,
         mu = 1, sigma = 1, gamma = 0, logvalue = FALSE)

.dghypmv(x, lambda, chi, psi, mu, sigma, gamma, logvalue = FALSE)

.mle.default(data, pdf, vars, opt.pars = rep(TRUE, length(vars)),
             transform = NULL, se = FALSE,
             na.rm = FALSE, silent = FALSE, ...)

.p.default(q, pdf, pdf.args, lower, upper, ...)

.q.default(p, pdf, pdf.args, interval, p.lower, ...)

.test.ghyp(object, case = c("ghyp", "univariate", "multivariate"))

.is.gaussian(object)

.is.univariate(object)

.is.symmetric(object)

.is.student.t(object, symmetric = NULL)

.get.stepAIC.ghyp(stepAIC.obj,
                  dist = c("ghyp", "hyp", "NIG", "VG", "t", "gauss"),
                  symmetric = FALSE)
</code></pre>


<h3>Details</h3>

<p><code>.abar2chipsi</code> <br />
Convert &ldquo;alpha.bar&rdquo; to &ldquo;chi&rdquo; and &ldquo;psi&rdquo; when using the
&ldquo;alpha.bar&rdquo; parametrization.
</p>
<p><code>.besselM3</code> <br />
Wrapper function for <code><a href="base.html#topic+besselK">besselK</a></code>.
</p>
<p><code>.check.data</code> <br />
This function checks <code>data</code> for consistency.
Only data objects of typ <code>data.frame</code>,
<code>matrix</code> or <code>numeric</code> are accepted.
</p>
<p><code>.check.gig.pars</code> <br />
Some combinations of the GIG parameters are not allowed. This
function checks whether this is the case or not.
</p>
<p><code>.check.norm.pars</code> <br />
This function simply checks if the dimensions match.
</p>
<p><code>.check.opt.pars</code> <br /> When calling the fitting routines
(<code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code> and <code><a href="#topic+fit.ghypmv">fit.ghypmv</a></code>) a named vector
containing the parameters which should not be fitted can be passed.
By default all parameters will be fitted.
</p>
<p><code>.fit.ghyp</code> <br />
This function is called by the functions
<code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code> and <code><a href="#topic+fit.ghypmv">fit.ghypmv</a></code> to create
objects of class <code><a href="#topic+mle.ghyp-class">mle.ghyp</a></code> and
<code><a href="#topic+mle.ghyp-class">mle.ghyp</a></code>.
</p>
<p><code>.ghyp.model</code> <br />
Check if the parameters denote a special case of the generalized hyperbolic
distribution.
</p>
<p><code>.t.transfrom</code> <br />
Transformation  function used in <code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code> for
parameter nu belonging to the Student-t distribution.
</p>
<p><code>.inv.t.transfrom</code> <br />
The inverse of <code>t.transfrom</code>.
</p>
<p><code>.integrate.moment.gig</code> <br />
This function is used when computing the conditional expectation
of a generalized inverse gaussian distribution.
</p>
<p><code>.integrate.moment.ghypuv</code> <br />
This function is used when computing the conditional expectation
of a univariate generalized hyperbolic distribution.
</p>
<p><code>.dghypuv</code> <br /> This function is used during the fitting
procedure. Use <code><a href="#topic+dghyp">dghyp</a></code> to compute the density of
generalized hyperbolic distribution objects.
</p>
<p><code>.dghypmv</code> <br /> This function is used during the fitting
procedure. Use <code><a href="#topic+dghyp">dghyp</a></code> to compute the density of
generalized hyperbolic distribution objects.
</p>
<p><code>.mle.default</code> <br /> This function serves as a generic function for
maximum likelihood estimation.  It is for internal use only. See
<code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code> which wraps this function.
</p>
<p><code>.p.default</code> <br />
A generic distribution function integrator given a density function.
See <code><a href="#topic+pghyp">pghyp</a></code> for a wrapper of this
function.
</p>
<p><code>.q.default</code> <br />
A generic quantile function calculator given a density function.
See <code><a href="#topic+qghyp">qghyp</a></code> for a wrapper of this   function.
</p>
<p><code>.test.ghyp</code> <br /> This function tests whether the object is of class
<code><a href="#topic+ghyp-class">ghyp</a></code> and sometimes whether it is univariate
or multivariate according to the argument <code>case</code> and states a
corresponding error if not.
</p>
<p><code>.is.gaussian</code> <br />
Tests whether the object is of a gaussian type.
</p>
<p><code>.is.symmetric</code> <br />
Tests whether the object is symmetric.
</p>
<p><code>.is.student.t</code> <br />
Tests whether the object describes a Student-t distribution.
</p>
<p><code>.is.univariate</code> <br />
Tests whether the object is a univariate ghyp-distribution.
</p>
<p><code>.get.stepAIC.ghyp</code> <br />
Returns a specific model from a list returned by <code>stepAIC.ghyp</code>
</p>


<h3>Author(s)</h3>

<p>Wolfgang Breymann, David Luethi</p>

<hr>
<h2 id='ghyp-mle.ghyp-classes'>Classes ghyp and mle.ghyp</h2><span id='topic+ghyp-class'></span><span id='topic+show.ghyp'></span><span id='topic+show+2Cghyp-method'></span><span id='topic+mle.ghyp-class'></span><span id='topic+show.mle.ghyp'></span><span id='topic+show+2Cmle.ghyp-method'></span>

<h3>Description</h3>

<p>The class &ldquo;ghyp&rdquo; basically contains the parameters of a
generalized hyperbolic distribution.  The class &ldquo;mle.ghyp&rdquo;
inherits from the class &ldquo;ghyp&rdquo;. The class &ldquo;mle.ghyp&rdquo;
adds some additional slots which contain information about the fitting
procedure. Namely, these are the number of iterations (<code>n.iter</code>),
the log likelihood value (<code>llh</code>), the Akaike Information
Criterion (<code>aic</code>), a boolean vector (<code>fitted.params</code>)
stating which parameters were fitted, a boolean <code>converged</code>
whether the fitting procedure converged or not, an <code>error.code</code>
which stores the status of a possible error and the corresponding
<code>error.message</code>. In the univariate case the parameter variance is
also stored in <code>parameter.variance</code>.
</p>


<h3>Objects from the Class</h3>

<p>Objects should only be created by calls to the constructors
<code><a href="#topic+ghyp">ghyp</a></code>, <code><a href="#topic+hyp">hyp</a></code>, <code><a href="#topic+NIG">NIG</a></code>,
<code><a href="#topic+VG">VG</a></code>, <code><a href="#topic+student.t">student.t</a></code> and <code><a href="#topic+gauss">gauss</a></code> or
by calls to the fitting routines like <code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code>,
<code><a href="#topic+fit.ghypmv">fit.ghypmv</a></code>, <code><a href="#topic+fit.hypuv">fit.hypuv</a></code>,
<code><a href="#topic+fit.hypmv">fit.hypmv</a></code> et cetera.
</p>


<h3>Slots</h3>

<p><strong>Slots of class ghyp:</strong>
</p>

<dl>
<dt><code>call</code>:</dt><dd><p>The function-call of class <code>call</code>.</p>
</dd>
<dt><code>lambda</code>:</dt><dd><p>Shape parameter of class <code>numeric</code>.</p>
</dd>
<dt><code>alpha.bar</code>:</dt><dd><p>Shape parameter of class <code>numeric</code>.</p>
</dd>
<dt><code>chi</code>:</dt><dd><p>Shape parameter of an alternative parametrization.
Object of class <code>numeric</code>.</p>
</dd>
<dt><code>psi</code>:</dt><dd><p>Shape parameter of an alternative parametrization.
Object of class <code>numeric</code>.</p>
</dd>
<dt><code>mu</code>:</dt><dd><p>Location parameter of lass <code>numeric</code>.</p>
</dd>
<dt><code>sigma</code>:</dt><dd><p>Dispersion parameter of class <code>matrix</code>.</p>
</dd>
<dt><code>gamma</code>:</dt><dd><p>Skewness parameter of class <code>numeric</code>.</p>
</dd>
<dt><code>model</code>:</dt><dd><p>Model, i.e., (a)symmetric generalized hyperbolic distribution or
(a)symmetric special case. Object of class <code>character</code>.</p>
</dd>
<dt><code>dimension</code>:</dt><dd><p>Dimension of the generalized hyperbolic distribution.
Object of class <code>numeric</code>.</p>
</dd>
<dt><code>expected.value</code>:</dt><dd><p>The expected value of a generalized
hyperbolic distribution.
Object of class <code>numeric</code>.</p>
</dd>
<dt><code>variance</code>:</dt><dd><p>The variance of a generalized
hyperbolic distribution of class <code>matrix</code>.</p>
</dd>
<dt><code>data</code>:</dt><dd><p>The data-slot is of class <code>matrix</code>. When an object of class
<code>ghypmv</code> is instantiated the user can decide whether
data should be stored within the object or not. This is the default and may be useful
when fitting eneralized hyperbolic distributions to data and
perform further analysis afterwards.</p>
</dd>
<dt><code>parametrization</code>:</dt><dd><p>Parametrization of the generalized
hyperbolic distribution of class <code>character</code>.
These are currently either &ldquo;chi.psi&rdquo;, &ldquo;alpha.bar&rdquo; or &ldquo;alpha.delta&rdquo;.</p>
</dd>
</dl>

<p><strong>Slots added by class mle.ghyp:</strong>
</p>

<dl>
<dt><code>n.iter</code>:</dt><dd><p>The number of iterations of class <code>numeric</code>.</p>
</dd>
<dt><code>llh</code>:</dt><dd><p>The log likelihood value of class <code>numeric</code>.</p>
</dd>
<dt><code>converged</code>:</dt><dd><p>A boolean whether converged or not.
Object of class <code>logical</code>.</p>
</dd>
<dt><code>error.code</code>:</dt><dd><p>An error code of class <code>numeric</code>.</p>
</dd>
<dt><code>error.message</code>:</dt><dd><p>An error message of class <code>character</code>.</p>
</dd>
<dt><code>fitted.params</code>:</dt><dd><p>A boolean vector stating which parameters were fitted of class <code>logical</code>.</p>
</dd>
<dt><code>aic</code>:</dt><dd><p>The value of the Akaike Information Criterion of class <code>numeric</code>.</p>
</dd>
<dt><code>parameter.variance</code>:</dt><dd><p>The parameter variance is the inverse
of the fisher information matrix. This slot is filled only in the case of
an univariate fit.
This slot is of class <code>matrix</code>.</p>
</dd>
<dt><code>trace.pars</code>:</dt><dd><p>Contains the parameter value evolution during the fitting procedure.
<code>trace.pars</code> of class <code>list</code>.</p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class &ldquo;mle.ghyp&rdquo; extends class <code>"<a href="#topic+ghyp-class">ghyp</a>"</code>, directly.
</p>


<h3>Methods</h3>

<p>A &ldquo;pairs&rdquo; method (see <code><a href="#topic+pairs.ghyp">pairs</a></code>).<br />
A &ldquo;hist&rdquo; method (see <code><a href="#topic+hist.ghyp">hist</a></code>).<br />
A &ldquo;plot&rdquo; method (see <code><a href="#topic+plot.ghyp">plot</a></code>).<br />
A &ldquo;lines&rdquo; method (see <code><a href="#topic+lines.ghyp">lines</a></code>).<br />
A &ldquo;coef&rdquo; method (see <code><a href="#topic+coef.ghyp">coef</a></code>).<br />
A &ldquo;mean&rdquo; method (see <code><a href="#topic+mean.ghyp">mean</a></code>). <br />
A &ldquo;vcov&rdquo; method (see <code><a href="#topic+vcov.ghyp">vcov</a></code>). <br />
A &ldquo;scale&rdquo; method (see <code><a href="#topic+scale.ghyp">scale</a></code>). <br />
A &ldquo;transform&rdquo; method (see <code><a href="#topic+transform.ghyp">transform</a></code>). <br />
A &ldquo;[.ghyp&rdquo; method (see <code><a href="#topic++5B.ghyp">[</a></code>). <br />
A &ldquo;logLik&rdquo; method for objects of class &ldquo;mle.ghyp&rdquo; (see <code><a href="#topic+logLik.mle.ghyp">logLik</a></code>). <br />
An &ldquo;AIC&rdquo; method for objects of class &ldquo;mle.ghyp&rdquo; (see <code><a href="#topic+AIC.mle.ghyp">AIC</a></code>). <br />
A &ldquo;summary&rdquo; method for objects of class &ldquo;mle.ghyp&rdquo; (see <code><a href="#topic+summary.mle.ghyp">summary</a></code>).
</p>


<h3>Note</h3>

<p>When showing special cases of the generalized hyperbolic distribution
the corresponding fixed parameters are not printed.
</p>


<h3>Author(s)</h3>

<p>David Luethi</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+optim">optim</a></code> for an interpretation of <code>error.code</code>, <code>error.message</code> and <code>parameter.variance</code>. <br />
<code><a href="#topic+ghyp">ghyp</a></code>, <code><a href="#topic+hyp">hyp</a></code>, <code><a href="#topic+NIG">NIG</a></code>, <code><a href="#topic+VG">VG</a></code>, <code><a href="#topic+student.t">student.t</a></code> and
<code><a href="#topic+gauss">gauss</a></code> for constructors of the class <code>ghyp</code> in the &ldquo;alpha.bar&rdquo; and &ldquo;chi/psi&rdquo; parametrization.
<code><a href="#topic+ghyp.ad">xxx.ad</a></code> for all the constructors in the &ldquo;alpha/delta&rdquo; parametrization.
<code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code>, <code><a href="#topic+fit.ghypmv">fit.ghypmv</a></code> et cetera for the fitting routies and constructors of the class
<code>mle.ghyp</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(smi.stocks)
  multivariate.fit &lt;- fit.ghypmv(data = smi.stocks,
                                 opt.pars = c(lambda = FALSE, alpha.bar = FALSE),
                                 lambda = 2)
  summary(multivariate.fit)

  vcov(multivariate.fit)
  mean(multivariate.fit)
  logLik(multivariate.fit)
  AIC(multivariate.fit)
  coef(multivariate.fit)

  univariate.fit &lt;- multivariate.fit[1]
  hist(univariate.fit)

  plot(univariate.fit)
  lines(multivariate.fit[2])
</code></pre>

<hr>
<h2 id='ghyp-risk-performance'>Risk and Performance Measures</h2><span id='topic+ESghyp'></span><span id='topic+ghyp.omega'></span>

<h3>Description</h3>

<p>Functions to compute the risk measure <em>Expected Shortfall</em> and
the performance measure <em>Omega</em> based on univariate generalized
hyperbolic distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ESghyp(alpha, object = ghyp(), distr = c("return", "loss"), ...)

ghyp.omega(L, object = ghyp(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ghyp-risk-performance_+3A_alpha">alpha</code></td>
<td>
<p>A vector of confidence levels.</p>
</td></tr>
<tr><td><code id="ghyp-risk-performance_+3A_l">L</code></td>
<td>
<p>A vector of threshold levels.</p>
</td></tr>
<tr><td><code id="ghyp-risk-performance_+3A_object">object</code></td>
<td>
<p>A univarite generalized hyperbolic distribution object inheriting from class <code><a href="#topic+ghyp-class">ghyp</a></code>.</p>
</td></tr>
<tr><td><code id="ghyp-risk-performance_+3A_distr">distr</code></td>
<td>
<p>Whether the ghyp-object specifies a return or a loss-distribution (see <b>Details</b>).</p>
</td></tr>
<tr><td><code id="ghyp-risk-performance_+3A_...">...</code></td>
<td>
<p>Arguments passed from <code>ESghyp</code> to <code><a href="#topic+qghyp">qghyp</a></code> and from <code>ghyp.omega</code> <code><a href="stats.html#topic+integrate">integrate</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parameter <code>distr</code> specifies whether the ghyp-object
describes a return or a loss-distribution.  In case of a return
distribution the expected-shortfall on a confidence level
<code class="reqn">\alpha</code> is defined as <code class="reqn">\hbox{ES}_\alpha := \hbox{E}(X
   | X \leq F^{-1}_X(\alpha))</code>
while in case of a loss distribution it is defined on a confidence
level <code class="reqn">\alpha</code> as <code class="reqn">\hbox{ES}_\alpha := \hbox{E}(X | X
   &gt; F^{-1}_X(\alpha))</code>.<br />
</p>
<p><em>Omega</em> is defined as the ratio of a European call-option price
divided by a put-option price with strike price L (see
<b>References</b>): <code class="reqn">\Omega(L) := \frac{C(L)}{P(L)}</code>.
</p>


<h3>Value</h3>

<p><code>ESghyp</code> gives the expected shortfall and  <br />
<code>ghyp.omega</code> gives the performance measure Omega.
</p>


<h3>Author(s)</h3>

<p>David Luethi</p>


<h3>References</h3>

<p><em>Omega as a Performance Measure</em> by Hossein Kazemi, Thomas
Schneeweis and Raj Gupta <br />
University of Massachusetts, 2003 <br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ghyp-class">ghyp-class</a></code> definition, <code><a href="#topic+ghyp">ghyp</a></code> constructors,
univariate fitting routines, <code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code>,
<code><a href="#topic+portfolio.optimize">portfolio.optimize</a></code> for portfolio optimization
with respect to alternative risk measures,
<code><a href="stats.html#topic+integrate">integrate</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(smi.stocks)

  ## Fit a NIG model to Credit Suisse and Swiss Re log-returns
  cs.fit &lt;- fit.NIGuv(smi.stocks[, "CS"], silent = TRUE)
  swiss.re.fit &lt;- fit.NIGuv(smi.stocks[, "Swiss.Re"], silent = TRUE)

  ## Confidence levels for expected shortfalls
  es.levels &lt;- c(0.001, 0.01, 0.05, 0.1)

  cs.es &lt;- ESghyp(es.levels, cs.fit)
  swiss.re.es &lt;- ESghyp(es.levels, swiss.re.fit)

  ## Threshold levels for Omega
  threshold.levels &lt;- c(0, 0.01, 0.02, 0.05)

  cs.omega &lt;- ghyp.omega(threshold.levels, cs.fit)
  swiss.re.omega &lt;- ghyp.omega(threshold.levels, swiss.re.fit)

  par(mfrow = c(2, 1))

  barplot(rbind(CS = cs.es, Swiss.Re = swiss.re.es), beside = TRUE,
          names.arg = paste(100 * es.levels, "percent"), col = c("gray40", "gray80"),
          ylab = "Expected Shortfalls (return distribution)", xlab = "Level")

  legend("bottomright", legend = c("CS", "Swiss.Re"), fill = c("gray40", "gray80"))

  barplot(rbind(CS = cs.omega, Swiss.Re = swiss.re.omega), beside = TRUE,
          names.arg = threshold.levels, col = c("gray40", "gray80"),
          ylab = "Omega", xlab = "Threshold level")
  legend("topright", legend = c("CS", "Swiss.Re"), fill = c("gray40", "gray80"))

  ## =&gt; the higher the performance, the higher the risk (as it should be)
</code></pre>

<hr>
<h2 id='ghyp.attribution-class'>Class ghyp.attribution</h2><span id='topic+ghyp.attribution-class'></span><span id='topic+contribution'></span><span id='topic+contribution+2Cghyp.attribution-method'></span><span id='topic+sensitivity'></span><span id='topic+sensitivity+2Cghyp.attribution-method'></span><span id='topic+weights+2Cghyp.attribution-method'></span>

<h3>Description</h3>

<p>The class &ldquo;ghyp.attribution&rdquo; contains the Expected Shortfall of 
the portfolio as well as the contribution of each asset to the total risk
and the sensitivity of each Asset. The sensitivity gives an information 
about the overall risk modification of the portfolio if the weight in a 
given asset is marginally increased or decreased (1 percent).
</p>
<p>The function <code>contribution</code> returns the contribution of the assets to the portfolio expected shortfall.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contribution(object, ...)

## S4 method for signature 'ghyp.attribution'
contribution(object, percentage = FALSE)

sensitivity(object)

## S4 method for signature 'ghyp.attribution'
sensitivity(object)

## S4 method for signature 'ghyp.attribution'
weights(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ghyp.attribution-class_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code><a href="#topic+ghyp.attribution-class">ghyp.attribution</a></code>.</p>
</td></tr>
<tr><td><code id="ghyp.attribution-class_+3A_...">...</code></td>
<td>
<p>additional parameters.</p>
</td></tr>
<tr><td><code id="ghyp.attribution-class_+3A_percentage">percentage</code></td>
<td>
<p>boolean. Display figures in percent. (Default=FALSE).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Expected shortfall enjoys homogeneity, sub-additivity, and co-monotonic additivity. Its associated function is continuously differentiable under
moderate assumptions on the joint distribution of the assets.
</p>


<h3>Value</h3>

<p>contribution of each asset to portfolio's overall expected shortfall.
</p>
<p>sensitivity of each asset to portfolio's overall expected shortfall.
</p>
<p>weights of each asset within portfolio.
</p>


<h3>Slots</h3>


<dl>
<dt><code>ES</code></dt><dd><p>Portfolio's expected shortfall (ES) for a given confidence level. Class <code>matrix</code>.</p>
</dd>
<dt><code>contribution</code></dt><dd><p>Contribution of each asset to the overall ES. Class <code>matrix</code>.</p>
</dd>
<dt><code>sensitivity</code></dt><dd><p>Sensitivity of each asset. Class <code>matrix</code>.</p>
</dd>
<dt><code>weights</code></dt><dd><p>Weight of each asset.</p>
</dd>
</dl>


<h3>Objects from the Class</h3>

<p>Objects should only be created by calls to the constructors <code><a href="#topic+ESghyp.attribution">ESghyp.attribution</a></code>.
</p>


<h3>Note</h3>

<p>When showing special cases of the generalized hyperbolic distribution
the corresponding fixed parameters are not printed.
</p>


<h3>Author(s)</h3>

<p>Marc Weibel
</p>
<p>Marc Weibel
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ESghyp.attribution">ESghyp.attribution</a></code>, <code><a href="#topic+ghyp.attribution-class">ghyp.attribution-class</a></code> to
compute the expected shortfall attribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(smi.stocks)
multivariate.fit &lt;- fit.ghypmv(data = smi.stocks,
opt.pars = c(lambda = FALSE, alpha.bar = FALSE),
lambda = 2)

portfolio &lt;- ESghyp.attribution(0.01, multivariate.fit)
summary(portfolio)

## End(Not run)
</code></pre>

<hr>
<h2 id='ghyp.moment'>Compute moments of generalized hyperbolic distributions</h2><span id='topic+ghyp.moment'></span>

<h3>Description</h3>

<p>This function computes moments of arbitrary orders of the univariate
generalized hyperbolic distribution. The expectation of <code class="reqn">f(X -
  c)^k</code> is calculated. <code class="reqn">f</code> can be either the absolute value or the
identity. <code class="reqn">c</code> can be either zero or <code class="reqn">E(X)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ghyp.moment(object, order = 3:4, absolute = FALSE, central = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ghyp.moment_+3A_object">object</code></td>
<td>
<p>A univarite generalized hyperbolic object inheriting from class
<code><a href="#topic+ghyp-class">ghyp</a></code>.</p>
</td></tr>
<tr><td><code id="ghyp.moment_+3A_order">order</code></td>
<td>
<p>A vector containing the order of the moments.</p>
</td></tr>
<tr><td><code id="ghyp.moment_+3A_absolute">absolute</code></td>
<td>
<p>Indicate whether the absolute value is taken or
not. If <code>absolute = TRUE</code> then <code class="reqn">E(|X - c|^k)</code> is
computed. Otherwise <code class="reqn">E((X - c)^k)</code>. <code class="reqn">c</code> depends on the
argument <code>central</code>. <code>absolute</code> must be <code>TRUE</code>
if <code>order</code> is not integer. </p>
</td></tr>
<tr><td><code id="ghyp.moment_+3A_central">central</code></td>
<td>
<p>If <code>TRUE</code> the moment around the expected value
<code class="reqn">E((X - E(X))^k)</code> is computed. Otherwise <code class="reqn">E(X^k)</code>.</p>
</td></tr>
<tr><td><code id="ghyp.moment_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="stats.html#topic+integrate">integrate</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In general <code>ghyp.moment</code> is based on numerical integration. For
the special cases of either a &ldquo;ghyp&rdquo;, &ldquo;hyp&rdquo; or
&ldquo;NIG&rdquo; distribution analytic expressions (see <b>References</b>)
will be taken if non-absolute and non-centered moments of integer
order are requested.
</p>


<h3>Value</h3>

<p>A vector containing the moments.
</p>


<h3>Author(s)</h3>

<p>David Luethi</p>


<h3>References</h3>

<p><em>Moments of the Generalized Hyperbolic Distribution</em> by
David J. Scott, Diethelm Wuertz and Thanh Tam Tran <br />
Working paper, 2008
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mean.ghyp">mean</a></code>, <code><a href="#topic+vcov.ghyp">vcov</a></code>,
<code><a href="#topic+Egig">Egig</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  nig.uv &lt;- NIG(alpha.bar = 0.1, mu = 1.1, sigma = 3, gamma = -2)

  # Moments of integer order
  ghyp.moment(nig.uv, order = 1:6)

  # Moments of fractional order
  ghyp.moment(nig.uv, order = 0.2 * 1:20, absolute = TRUE)
</code></pre>

<hr>
<h2 id='gig-distribution'>The Generalized Inverse Gaussian Distribution</h2><span id='topic+dgig'></span><span id='topic+pgig'></span><span id='topic+qgig'></span><span id='topic+ESgig'></span><span id='topic+rgig'></span><span id='topic+Egig'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function, random generation,
expected shortfall and expected value and variance for the generalized
inverse gaussian distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgig(x, lambda = 1, chi = 1, psi = 1, logvalue = FALSE)

pgig(q, lambda = 1, chi = 1, psi = 1, ...)

qgig(p, lambda = 1, chi = 1, psi = 1, method = c("integration", "splines"),
     spline.points = 200, subdivisions = 200,
     root.tol = .Machine$double.eps^0.5,
     rel.tol = root.tol^1.5, abs.tol = rel.tol, ...)

rgig(n = 10, lambda = 1, chi = 1, psi = 1)

ESgig(alpha, lambda = 1, chi = 1, psi = 1, distr = c("return", "loss"), ...)

Egig(lambda, chi, psi, func = c("x", "logx", "1/x", "var"), check.pars = TRUE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gig-distribution_+3A_x">x</code></td>
<td>
<p>A vector of quantiles.</p>
</td></tr>
<tr><td><code id="gig-distribution_+3A_q">q</code></td>
<td>
<p>A vector of quantiles.</p>
</td></tr>
<tr><td><code id="gig-distribution_+3A_p">p</code></td>
<td>
<p>A vector of probabilities.</p>
</td></tr>
<tr><td><code id="gig-distribution_+3A_alpha">alpha</code></td>
<td>
<p>A vector of confidence levels.</p>
</td></tr>
<tr><td><code id="gig-distribution_+3A_n">n</code></td>
<td>
<p>Number of observations.</p>
</td></tr>
<tr><td><code id="gig-distribution_+3A_lambda">lambda</code></td>
<td>
<p>A shape and scale and parameter.</p>
</td></tr>
<tr><td><code id="gig-distribution_+3A_chi">chi</code>, <code id="gig-distribution_+3A_psi">psi</code></td>
<td>
<p>Shape and scale parameters. Must be positive.</p>
</td></tr>
<tr><td><code id="gig-distribution_+3A_logvalue">logvalue</code></td>
<td>
<p>If <code>TRUE</code> the logarithm of the density will be returned.</p>
</td></tr>
<tr><td><code id="gig-distribution_+3A_distr">distr</code></td>
<td>
<p>Whether the ghyp-object specifies a return or a loss-distribution (see <b>Details</b>).</p>
</td></tr>
<tr><td><code id="gig-distribution_+3A_subdivisions">subdivisions</code></td>
<td>
<p>The number of subdivisions passed to <code><a href="stats.html#topic+integrate">integrate</a></code> when computing
the the distribution function <code>pgig</code>.</p>
</td></tr>
<tr><td><code id="gig-distribution_+3A_rel.tol">rel.tol</code></td>
<td>
<p>The relative accuracy requested from  <code><a href="stats.html#topic+integrate">integrate</a></code>.</p>
</td></tr>
<tr><td><code id="gig-distribution_+3A_abs.tol">abs.tol</code></td>
<td>
<p>The absolute accuracy requested from  <code><a href="stats.html#topic+integrate">integrate</a></code>.</p>
</td></tr>
<tr><td><code id="gig-distribution_+3A_method">method</code></td>
<td>
<p>Determines which method is used when calculating quantiles.</p>
</td></tr>
<tr><td><code id="gig-distribution_+3A_spline.points">spline.points</code></td>
<td>
<p>The number of support points when computing the quantiles with the method
&ldquo;splines&rdquo; instead of &ldquo;integration&rdquo;.</p>
</td></tr>
<tr><td><code id="gig-distribution_+3A_root.tol">root.tol</code></td>
<td>
<p>The tolerance of <code><a href="stats.html#topic+uniroot">uniroot</a></code>.</p>
</td></tr>
<tr><td><code id="gig-distribution_+3A_func">func</code></td>
<td>
<p>The transformation function when computing the expected value.
<code>x</code> is the expected value (default), <code>log x</code> returns the
expected value of the logarithm of <code>x</code>, <code>1/x</code> returns the
expected value of the inverse of <code>x</code> and <code>var</code> returns the
variance.</p>
</td></tr>
<tr><td><code id="gig-distribution_+3A_check.pars">check.pars</code></td>
<td>
<p>If <code>TRUE</code> the parameters are checked first.</p>
</td></tr>
<tr><td><code id="gig-distribution_+3A_...">...</code></td>
<td>
<p>Arguments passed form <code>ESgig</code> to <code>qgig</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>qgig</code> computes the quantiles either by using the
&ldquo;integration&rdquo; method where the root of the distribution
function is solved or via &ldquo;splines&rdquo; which interpolates the
distribution function and solves it with <code><a href="stats.html#topic+uniroot">uniroot</a></code>
afterwards. The &ldquo;integration&rdquo; method is recommended when few
quantiles are required. If more than approximately 20 quantiles are
needed to be calculated the &ldquo;splines&rdquo; method becomes faster.
The accuracy can be controlled with an adequate setting of the
parameters <code>rel.tol</code>, <code>abs.tol</code>, <code>root.tol</code> and
<code>spline.points</code>. <br />
</p>
<p><code>rgig</code> relies on the C function with the same name kindly
provided by Ester Pantaleo and Robert B. Gramacy. <br />
</p>
<p><code>Egig</code> with <code>func = "log x"</code> uses
<code><a href="numDeriv.html#topic+grad">grad</a></code> from the <span class="rlang"><b>R</b></span> package <em>numDeriv</em>. See
the package vignette for details regarding the expectation of GIG
random variables.
</p>


<h3>Value</h3>

<p><code>dgig</code> gives the density, <br />
<code>pgig</code> gives the distribution function, <br />
<code>qgig</code> gives the quantile function, <br />
<code>ESgig</code> gives the expected shortfall,  <br />
<code>rgig</code> generates random deviates and <br />
<code>Egig</code> gives the expected value
of either <code>x</code>, <code>1/x</code>, <code>log(x)</code> or the variance if <code>func</code> equals <code>var</code>.
</p>


<h3>Author(s)</h3>

<p>David Luethi and Ester Pantaleo</p>


<h3>References</h3>

<p>Dagpunar, J.S. (1989). <em>An easily implemented generalised inverse
Gaussian generator.</em> Commun. Statist. -Simula., <b>18</b>, 703&ndash;710.
</p>
<p>Michael, J. R, Schucany, W. R, Haas, R, W. (1976).  <em>Generating
random variates using transformations with multiple roots</em>, The
American Statistican, <b>30</b>, 88&ndash;90.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code>, <code><a href="#topic+fit.ghypmv">fit.ghypmv</a></code>, <code><a href="stats.html#topic+integrate">integrate</a></code>,
<code><a href="stats.html#topic+uniroot">uniroot</a></code>, <code><a href="stats.html#topic+spline">spline</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>dgig(1:40, lambda = 10, chi = 1, psi = 1)
qgig(1e-5, lambda = 10, chi = 1, psi = 1)

ESgig(c(0.19,0.3), lambda = 10, chi = 1, psi = 1, distr = "loss")
ESgig(alpha=c(0.19,0.3), lambda = 10, chi = 1, psi = 1, distr = "ret")

Egig(lambda = 10, chi = 1, psi = 1, func = "x")
Egig(lambda = 10, chi = 1, psi = 1, func = "var")
Egig(lambda = 10, chi = 1, psi = 1, func = "1/x")
</code></pre>

<hr>
<h2 id='hist-methods'>Histogram for univariate generalized hyperbolic distributions</h2><span id='topic+hist.ghyp'></span><span id='topic+hist-methods'></span><span id='topic+hist+2Cghyp-method'></span>

<h3>Description</h3>

<p>The function <code>hist</code> computes a histogram of the given data values
and the univariate generalized hyperbolic distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ghyp'
hist(x, data = ghyp.data(x), gaussian = TRUE,
     log.hist = F, ylim = NULL, ghyp.col = 1, ghyp.lwd = 1,
     ghyp.lty = "solid", col = 1, nclass = 30, plot.legend = TRUE,
     location = if (log.hist) "bottom" else "topright", legend.cex = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hist-methods_+3A_x">x</code></td>
<td>
<p>Usually a fitted univariate generalized hyperbolic distribution
of class <code><a href="#topic+mle.ghyp-class">mle.ghyp</a></code>. Alternatively
an object of class <code><a href="#topic+ghyp-class">ghyp</a></code> and a data vector.</p>
</td></tr>
<tr><td><code id="hist-methods_+3A_data">data</code></td>
<td>
<p>An object coercible to a <code>vector</code>.</p>
</td></tr>
<tr><td><code id="hist-methods_+3A_gaussian">gaussian</code></td>
<td>
<p>If <code>TRUE</code> the probability density of the normal distribution is plotted as a reference.</p>
</td></tr>
<tr><td><code id="hist-methods_+3A_log.hist">log.hist</code></td>
<td>
<p>If <code>TRUE</code> the logarithm of the histogramm is plotted.</p>
</td></tr>
<tr><td><code id="hist-methods_+3A_ylim">ylim</code></td>
<td>
<p>The &ldquo;y&rdquo; limits of the plot.</p>
</td></tr>
<tr><td><code id="hist-methods_+3A_ghyp.col">ghyp.col</code></td>
<td>
<p>The color of the density of the generalized
hyperbolic distribution.</p>
</td></tr>
<tr><td><code id="hist-methods_+3A_ghyp.lwd">ghyp.lwd</code></td>
<td>
<p>The line width of the density of the generalized
hyperbolic distribution.</p>
</td></tr>
<tr><td><code id="hist-methods_+3A_ghyp.lty">ghyp.lty</code></td>
<td>
<p>The line type of the density of the generalized
hyperbolic distribution.</p>
</td></tr>
<tr><td><code id="hist-methods_+3A_col">col</code></td>
<td>
<p>The color of the histogramm.</p>
</td></tr>
<tr><td><code id="hist-methods_+3A_nclass">nclass</code></td>
<td>
<p>A single number giving the number of cells for the histogramm.</p>
</td></tr>
<tr><td><code id="hist-methods_+3A_plot.legend">plot.legend</code></td>
<td>
<p>If <code>TRUE</code> a legend is drawn.</p>
</td></tr>
<tr><td><code id="hist-methods_+3A_location">location</code></td>
<td>
<p>The location of the legend. See <code><a href="graphics.html#topic+legend">legend</a></code> for possible values.</p>
</td></tr>
<tr><td><code id="hist-methods_+3A_legend.cex">legend.cex</code></td>
<td>
<p>The character expansion of the legend.</p>
</td></tr>
<tr><td><code id="hist-methods_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="graphics.html#topic+plot">plot</a></code> and  <code><a href="#topic+qqghyp">qqghyp</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned.
</p>


<h3>Author(s)</h3>

<p>David Luethi</p>


<h3>See Also</h3>

<p><code><a href="#topic+qqghyp">qqghyp</a></code>, <code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code>,
<code><a href="graphics.html#topic+hist">hist</a></code>, <code><a href="graphics.html#topic+legend">legend</a></code>, <code><a href="#topic+plot.ghyp">plot</a></code>,
<code><a href="#topic+lines.ghyp">lines</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(smi.stocks)
  univariate.fit &lt;- fit.ghypuv(data = smi.stocks[,"SMI"],
                               opt.pars = c(mu = FALSE, sigma = FALSE),
                               symmetric = TRUE)
  hist(univariate.fit)
</code></pre>

<hr>
<h2 id='indices'>Monthly returns of five indices</h2><span id='topic+indices'></span>

<h3>Description</h3>

<p>Monthly returns of indices representing five asset/investment classes
<em>Bonds</em>, <em>Stocks</em>, <em>Commodities</em>, <em>Emerging
Markets</em> and <em>High Yield Bonds</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(indices)</code></pre>


<h3>Format</h3>


<dl>
<dt><code>hy.bond</code></dt><dd><p>JPMorgan High Yield Bond A (Yahoo symbol &ldquo;OHYAX&rdquo;).</p>
</dd>
<dt><code>emerging.mkt</code></dt><dd><p>Morgan Stanley Emerging Markets Fund Inc. (Yahoo symbol &ldquo;MSF&rdquo;).</p>
</dd>
<dt><code>commodity</code></dt><dd><p>Dow Jones-AIG Commodity Index (Yahoo symbol &ldquo;DJI&rdquo;).</p>
</dd>
<dt><code>bond</code></dt><dd><p>Barclays Global Investors Bond Index (Yahoo symbol &ldquo;WFBIX&rdquo;).</p>
</dd>
<dt><code>stock</code></dt><dd><p>Vanguard Total Stock Mkt Idx (Yahoo symbol &ldquo;VTSMX&rdquo;).</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+smi.stocks">smi.stocks</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(indices)

  pairs(indices)
</code></pre>

<hr>
<h2 id='lik.ratio.test'>Likelihood-ratio test</h2><span id='topic+lik.ratio.test'></span>

<h3>Description</h3>

<p>This function performs a likelihood-ratio test on fitted generalized
hyperbolic distribution objects of class <code>mle.ghyp</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lik.ratio.test(x, x.subclass, conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lik.ratio.test_+3A_x">x</code></td>
<td>
<p>An object of class <code>mle.ghyp</code>.</p>
</td></tr>
<tr><td><code id="lik.ratio.test_+3A_x.subclass">x.subclass</code></td>
<td>
<p>An object of class <code>mle.ghyp</code> whose parameters form a subset
of those of <code>x</code>.</p>
</td></tr>
<tr><td><code id="lik.ratio.test_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level of the test.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The likelihood-ratio test can be used to check whether a special case
of the generalized hyperbolic distribution is the &ldquo;true&rdquo;
underlying distribution.
</p>
<p>The likelihood-ratio is defined as </p>
<p style="text-align: center;"><code class="reqn">\Lambda = \frac{sup\{L(\theta
  | \mathbf{X}) : \theta \in \Theta_0\}} { sup\{L(\theta | \mathbf{X}) :
  \theta \in \Theta\}}.</code>
</p>
<p>  Where <code class="reqn">L</code>
denotes the likelihood function with respect to the parameter
<code class="reqn">\theta</code> and data <code class="reqn">\mathbf{X}</code>, and <code class="reqn">\Theta_0</code> is a
subset of the parameter space <code class="reqn">\Theta</code>.  The null hypothesis
<code>H0</code> states that <code class="reqn">\theta \in \Theta_0</code>. Under the null
hypothesis and under certain regularity conditions it can be shown
that <code class="reqn">-2 \log(\Lambda)</code> is asymtotically chi-squared distributed
with <code class="reqn">\nu</code> degrees of freedom.  <code class="reqn">\nu</code> is the number of free
parameters specified by <code class="reqn">\Theta</code> minus the number of free
parameters specified by <code class="reqn">\Theta_0</code>.
</p>
<p>The null hypothesis is rejected if <code class="reqn">-2 \log(\Lambda)</code> exceeds the
<code>conf.level</code>-quantile of the chi-squared distribution with
<code class="reqn">\nu</code> degrees of freedom.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>The value of the L-statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The p-value for the test.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>The degrees of freedom for the L-statistic.</p>
</td></tr>
<tr><td><code>H0</code></td>
<td>
<p>A boolean stating whether the null hypothesis is <code>TRUE</code> or <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Luethi
</p>


<h3>References</h3>

<p><em>Linear Statistical Inference and Its Applications</em> by C. R. Rao<br />
Wiley, New York, 1973
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code>, <code><a href="#topic+logLik.mle.ghyp">logLik</a></code>, <code><a href="#topic+AIC.mle.ghyp">AIC</a></code> and
<code><a href="#topic+stepAIC.ghyp">stepAIC.ghyp</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(smi.stocks)

  sample &lt;- smi.stocks[, "SMI"]

  t.symmetric &lt;- fit.tuv(sample, silent = TRUE, symmetric = TRUE)
  t.asymmetric &lt;- fit.tuv(sample, silent = TRUE)

  # Test symmetric Student-t against asymmetric Student-t in case
  # of SMI log-returns
  lik.ratio.test(t.asymmetric, t.symmetric, conf.level = 0.95)
  # -&gt; keep the null hypothesis

  set.seed(1000)
  sample &lt;- rghyp(1000, student.t(gamma = 0.1))

  t.symmetric &lt;- fit.tuv(sample, silent = TRUE, symmetric = TRUE)
  t.asymmetric &lt;- fit.tuv(sample, silent = TRUE)

  # Test symmetric Student-t against asymmetric Student-t in case of
  # data simulated according to a slightly skewed Student-t distribution
  lik.ratio.test(t.asymmetric, t.symmetric, conf.level = 0.95)
  # -&gt; reject the null hypothesis

  t.symmetric &lt;- fit.tuv(sample, silent = TRUE, symmetric = TRUE)
  ghyp.asymmetric &lt;- fit.ghypuv(sample, silent = TRUE)

  # Test symmetric Student-t against asymmetric generalized
  # hyperbolic using the same data as in the example above
  lik.ratio.test(ghyp.asymmetric, t.symmetric, conf.level = 0.95)
  # -&gt; keep the null hypothesis
</code></pre>

<hr>
<h2 id='logLik-AIC-methods'>Extract Log-Likelihood and Akaike's Information Criterion</h2><span id='topic+logLik.mle.ghyp'></span><span id='topic+logLik+2Cmle.ghyp-method'></span><span id='topic+AIC.mle.ghyp'></span><span id='topic+AIC+2Cmle.ghyp-method'></span>

<h3>Description</h3>

<p>The functions <code>logLik</code> and <code>AIC</code> extract the Log-Likelihood
and the Akaike's Information Criterion from fitted generalized
hyperbolic distribution objects.  The Akaike information criterion is
calculated according to the formula <code class="reqn">-2 \cdot
  \mbox{log-likelihood} + k \cdot n_{par}</code>, where <code class="reqn">n_{par}</code> represents the number of parameters
in the fitted model, and <code class="reqn">k = 2</code> for the usual AIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mle.ghyp'
logLik(object, ...)

## S4 method for signature 'mle.ghyp'
AIC(object, ..., k = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik-AIC-methods_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+mle.ghyp-class">mle.ghyp</a></code>.</p>
</td></tr>
<tr><td><code id="logLik-AIC-methods_+3A_k">k</code></td>
<td>
<p>The &ldquo;penalty&rdquo; per parameter to be used; the default k = 2 is the classical AIC.</p>
</td></tr>
<tr><td><code id="logLik-AIC-methods_+3A_...">...</code></td>
<td>
<p>An arbitrary number of objects of class <code><a href="#topic+mle.ghyp-class">mle.ghyp</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Either the Log-Likelihood or the Akaike's Information Criterion.
</p>


<h3>Note</h3>

<p>The Log-Likelihood as well as the Akaike's Information Criterion can be obtained from
the function <code><a href="#topic+ghyp.fit.info">ghyp.fit.info</a></code>. However, the benefit of <code>logLik</code> and <code>AIC</code>
is that these functions allow a call with an arbitrary number of objects and are better known
because they are generic.
</p>


<h3>Author(s)</h3>

<p>David Luethi</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code>, <code><a href="#topic+fit.ghypmv">fit.ghypmv</a></code>, <code><a href="#topic+lik.ratio.test">lik.ratio.test</a></code>,
<code><a href="#topic+ghyp.fit.info">ghyp.fit.info</a></code>, <code><a href="#topic+mle.ghyp-class">mle.ghyp-class</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(smi.stocks)

  ## Multivariate fit
  fit.mv &lt;- fit.hypmv(smi.stocks, nit = 10)
  AIC(fit.mv)
  logLik(fit.mv)

  ## Univariate fit
  fit.uv &lt;- fit.tuv(smi.stocks[, "CS"], control = list(maxit = 10))
  AIC(fit.uv)
  logLik(fit.uv)

  # Both together
  AIC(fit.uv, fit.mv)
  logLik(fit.uv, fit.mv)
</code></pre>

<hr>
<h2 id='mean-vcov-skew-kurt-methods'>Expected value, variance-covariance, skewness and kurtosis
of generalized hyperbolic distributions</h2><span id='topic+mean.ghyp'></span><span id='topic+mean-methods'></span><span id='topic+mean+2Cghyp-method'></span><span id='topic+vcov.ghyp'></span><span id='topic+vcov-methods'></span><span id='topic+vcov+2Cghyp-method'></span><span id='topic+ghyp.skewness'></span><span id='topic+ghyp.kurtosis'></span>

<h3>Description</h3>

<p>The function <code>mean</code> returns the expected value. The function
<code>vcov</code> returns the variance in the univariate case and the
variance-covariance matrix in the multivariate case. The functions
<code>ghyp.skewness</code> and <code>ghyp.kurtosis</code> only work for univariate
generalized hyperbolic distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ghyp'
mean(x)

## S4 method for signature 'ghyp'
vcov(object)

ghyp.skewness(object)

ghyp.kurtosis(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mean-vcov-skew-kurt-methods_+3A_x">x</code>, <code id="mean-vcov-skew-kurt-methods_+3A_object">object</code></td>
<td>
<p>An object inheriting from class
<code><a href="#topic+ghyp-class">ghyp</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions <code>ghyp.skewness</code> and <code>ghyp.kurtosis</code> are based
on the function <code><a href="#topic+ghyp.moment">ghyp.moment</a></code>. Numerical integration will
be used in case a Student.t or variance gamma distribution is
submitted.
</p>


<h3>Value</h3>

<p>Either the expected value, variance, skewness or kurtosis.
</p>


<h3>Author(s)</h3>

<p>David Luethi</p>


<h3>See Also</h3>

<p><code><a href="#topic+ghyp">ghyp</a></code>, <code><a href="#topic+ghyp-class">ghyp-class</a></code>, <code><a href="#topic+Egig">Egig</a></code> to
compute the expected value and the variance of the generalized inverse gaussian
mixing distribution distributed and its special cases.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Univariate: Parametric
  vg.dist &lt;- VG(lambda = 1.1, mu = 10, sigma = 10, gamma = 2)
  mean(vg.dist)
  vcov(vg.dist)
  ghyp.skewness(vg.dist)
  ghyp.kurtosis(vg.dist)

  ## Univariate: Empirical
  vg.sim &lt;- rghyp(10000, vg.dist)
  mean(vg.sim)
  var(vg.sim)

  ## Multivariate: Parametric
  vg.dist &lt;- VG(lambda = 0.1, mu = c(55, 33), sigma = diag(c(22, 888)), gamma = 1:2)
  mean(vg.dist)
  vcov(vg.dist)

  ## Multivariate: Empirical
  vg.sim &lt;- rghyp(50000, vg.dist)
  colMeans(vg.sim)
  var(vg.sim)
</code></pre>

<hr>
<h2 id='pairs-methods'>Pairs plot for multivariate generalized hyperbolic distributions</h2><span id='topic+pairs.ghyp'></span><span id='topic+pairs-methods'></span><span id='topic+pairs+2Cghyp-method'></span>

<h3>Description</h3>

<p>This function is intended to be used as a graphical diagnostic tool
for fitted multivariate generalized hyperbolic distributions. An array
of graphics is created and qq-plots are drawn into the diagonal part
of the graphics array. The upper part of the graphics matrix shows
scatter plots whereas the lower part shows 2-dimensional histogramms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ghyp'
pairs(x, data = ghyp.data(x), main = "'ghyp' pairwise plot",
      nbins = 30, qq = TRUE, gaussian = TRUE,
      hist.col = c("white", topo.colors(100)),
      spline.points = 150, root.tol = .Machine$double.eps^0.5,
      rel.tol = root.tol, abs.tol = root.tol^1.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pairs-methods_+3A_x">x</code></td>
<td>
<p>Usually a fitted multivariate generalized hyperbolic distribution
of class <code><a href="#topic+mle.ghyp-class">mle.ghyp</a></code>. Alternatively
an object of class <code><a href="#topic+ghyp-class">ghyp</a></code> and a data matrix.</p>
</td></tr>
<tr><td><code id="pairs-methods_+3A_data">data</code></td>
<td>
<p>An object coercible to a <code>matrix</code>.</p>
</td></tr>
<tr><td><code id="pairs-methods_+3A_main">main</code></td>
<td>
<p>The title of the plot.</p>
</td></tr>
<tr><td><code id="pairs-methods_+3A_nbins">nbins</code></td>
<td>
<p>The number of bins of the 2-d histogram.</p>
</td></tr>
<tr><td><code id="pairs-methods_+3A_qq">qq</code></td>
<td>
<p>If <code>TRUE</code> qq-plots are drawn.</p>
</td></tr>
<tr><td><code id="pairs-methods_+3A_gaussian">gaussian</code></td>
<td>
<p>If <code>TRUE</code> qq-plots with the normal distribution are plotted.</p>
</td></tr>
<tr><td><code id="pairs-methods_+3A_hist.col">hist.col</code></td>
<td>
<p>A vector of colors of the 2-d histgram.</p>
</td></tr>
<tr><td><code id="pairs-methods_+3A_spline.points">spline.points</code></td>
<td>
<p>The number of support points when computing the quantiles used by the
qq-plot. Passed to <code><a href="#topic+qqghyp">qqghyp</a></code>.</p>
</td></tr>
<tr><td><code id="pairs-methods_+3A_root.tol">root.tol</code></td>
<td>
<p>The tolerance of the quantiles. Passed to <code><a href="stats.html#topic+uniroot">uniroot</a></code> via <code><a href="#topic+qqghyp">qqghyp</a></code>.</p>
</td></tr>
<tr><td><code id="pairs-methods_+3A_rel.tol">rel.tol</code></td>
<td>
<p>The tolerance of the quantiles. Passed to <code><a href="stats.html#topic+integrate">integrate</a></code> via <code><a href="#topic+qqghyp">qqghyp</a></code>.</p>
</td></tr>
<tr><td><code id="pairs-methods_+3A_abs.tol">abs.tol</code></td>
<td>
<p>The tolerance of the quantiles. Passed to <code><a href="stats.html#topic+integrate">integrate</a></code> via <code><a href="#topic+qqghyp">qqghyp</a></code>.</p>
</td></tr>
<tr><td><code id="pairs-methods_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="graphics.html#topic+plot">plot</a></code> and <code><a href="graphics.html#topic+axis">axis</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Luethi</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+pairs">pairs</a></code>, <code><a href="#topic+fit.ghypmv">fit.ghypmv</a></code>,
<code><a href="#topic+qqghyp">qqghyp</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(smi.stocks)
  fitted.smi.stocks &lt;- fit.NIGmv(data = smi.stocks[1:200, ])
  pairs(fitted.smi.stocks)
</code></pre>

<hr>
<h2 id='plot-lines-methods'>Plot univariate generalized hyperbolic densities</h2><span id='topic+plot.ghyp'></span><span id='topic+plot+2Cghyp+2Cmissing-method'></span><span id='topic+plot-methods'></span><span id='topic+lines.ghyp'></span><span id='topic+lines-methods'></span><span id='topic+lines+2Cghyp-method'></span>

<h3>Description</h3>

<p>These functions plot probability densities of generalized hyperbolic
distribution objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ghyp,missing'
plot(x, range = qghyp(c(0.001, 0.999), x), length = 1000, ...)
## S4 method for signature 'ghyp'
lines(x, range = qghyp(c(0.001, 0.999), x), length = 1000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot-lines-methods_+3A_x">x</code></td>
<td>
<p>An univariate <code><a href="#topic+ghyp-class">ghyp</a></code> object.</p>
</td></tr>
<tr><td><code id="plot-lines-methods_+3A_range">range</code></td>
<td>
<p>The range over which the density will be plotted. The default is the range from
the 0.1 % quantile to the 99.9 % quantile. When <code>range</code> has a length
greater than 2 it is assumed to be the vector of quantiles and the density
is computed on <code>range</code>.</p>
</td></tr>
<tr><td><code id="plot-lines-methods_+3A_length">length</code></td>
<td>
<p>The desired length of the density vector.</p>
</td></tr>
<tr><td><code id="plot-lines-methods_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="graphics.html#topic+plot">plot</a></code> and <code><a href="graphics.html#topic+lines">lines</a></code> respectively.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the density is very skewed, the computation of the quantile
may fail. See <code><a href="#topic+qghyp">qghyp</a></code> for details.
</p>


<h3>Author(s)</h3>

<p>David Luethi</p>


<h3>See Also</h3>

<p><code><a href="#topic+hist.ghyp">hist</a></code>, <code><a href="#topic+qqghyp">qqghyp</a></code>,
<code><a href="#topic+pairs.ghyp">pairs</a></code>, <code><a href="graphics.html#topic+plot">plot</a></code>,
<code><a href="graphics.html#topic+lines">lines</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(smi.stocks)

  smi.fit   &lt;-  fit.tuv(data = smi.stocks[,"SMI"], symmetric = TRUE)
  nestle.fit &lt;- fit.tuv(data = smi.stocks[,"Nestle"], symmetric = TRUE)

  ## Student-t distribution
  plot(smi.fit, type = "l", log = "y")
  lines(nestle.fit, col = "blue")

  ## Empirical
  lines(density(smi.stocks[,"SMI"]), lty = "dashed")
  lines(density(smi.stocks[,"Nestle"]), lty = "dashed", col = "blue")
</code></pre>

<hr>
<h2 id='plot.ghyp.attrib'>Plot ES contribution</h2><span id='topic+plot.ghyp.attrib'></span><span id='topic+plot+2Cghyp.attribution+2CANY-method'></span>

<h3>Description</h3>

<p>These functions plot the contribution of each asset to the overall portfolio expected shortfall.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ghyp.attrib'
plot(
  x,
  metrics = c("contribution", "sensitivity"),
  column.index = NULL,
  percentage = FALSE,
  colorset = NULL,
  horiz = FALSE,
  unstacked = TRUE,
  pie.chart = FALSE,
  sub = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ghyp.attrib_+3A_x">x</code></td>
<td>
<p>A <code>ghyp.attribution</code> object.</p>
</td></tr>
<tr><td><code id="plot.ghyp.attrib_+3A_metrics">metrics</code></td>
<td>
<p>either the <code>contribution</code> or <code>sensitivity</code> will be plotted.</p>
</td></tr>
<tr><td><code id="plot.ghyp.attrib_+3A_column.index">column.index</code></td>
<td>
<p>which column of the object.</p>
</td></tr>
<tr><td><code id="plot.ghyp.attrib_+3A_percentage">percentage</code></td>
<td>
<p>plot contribution or sensitivity in percent.</p>
</td></tr>
<tr><td><code id="plot.ghyp.attrib_+3A_colorset">colorset</code></td>
<td>
<p>vector of colors for the chart.</p>
</td></tr>
<tr><td><code id="plot.ghyp.attrib_+3A_horiz">horiz</code></td>
<td>
<p>plot horizontally.</p>
</td></tr>
<tr><td><code id="plot.ghyp.attrib_+3A_unstacked">unstacked</code></td>
<td>
<p>unstacked plot.</p>
</td></tr>
<tr><td><code id="plot.ghyp.attrib_+3A_pie.chart">pie.chart</code></td>
<td>
<p>should a pie chart be plotted.</p>
</td></tr>
<tr><td><code id="plot.ghyp.attrib_+3A_sub">sub</code></td>
<td>
<p>subtitle.</p>
</td></tr>
<tr><td><code id="plot.ghyp.attrib_+3A_...">...</code></td>
<td>
<p>arguments passed to <code>plot</code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Weibel
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ESghyp.attribution">ESghyp.attribution</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 data(smi.stocks)
 
 ## Fit a NIG model to Novartis, CS and Nestle log-returns
 assets.fit &lt;- fit.NIGmv(smi.stocks[, c("Novartis", "CS", "Nestle")], silent = TRUE)
 
 ## Define Weights of the Portfolio
 weights &lt;- c(0.2, 0.5, 0.3)
 
 ## Confidence level for Expected Shortfall
 es.levels &lt;- c(0.01)
 portfolio.attrib &lt;- ESghyp.attribution(alpha=es.levels, object=assets.fit, weights=weights)
 
 ## Plot Risk Contribution for each Asset
 plot(portfolio.attrib, metrics='contribution')  

## End(Not run)
</code></pre>

<hr>
<h2 id='portfolio.optimize'>Portfolio optimization with respect to alternative risk measures</h2><span id='topic+portfolio.optimize'></span>

<h3>Description</h3>

<p>This function performs a optimization of a portfolio with respect to
one of the risk measures &ldquo;sd&rdquo;, &ldquo;value.at.risk&rdquo; or
&ldquo;expected.shortfall&rdquo;. The optimization task is either to
find the <em>global minimum risk</em> portfolio, the <em>tangency</em>
portfolio or the <em>minimum risk</em> portfolio given a target-return.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>portfolio.optimize(object,
                   risk.measure = c("sd", "value.at.risk", "expected.shortfall"),
                   type = c("minimum.risk", "tangency", "target.return"),
                   level = 0.95, distr = c("loss", "return"),
                   target.return = NULL, risk.free = NULL,
                   silent = FALSE, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="portfolio.optimize_+3A_object">object</code></td>
<td>
<p>A multivariate <code><a href="#topic+ghyp-class">ghyp</a></code> object
representing the loss distribution. In case <code>object</code> gives the
return distribution set the argument <code>distr</code> to &ldquo;return&rdquo;.</p>
</td></tr>
<tr><td><code id="portfolio.optimize_+3A_risk.measure">risk.measure</code></td>
<td>
<p>How risk shall be measured.  Must be one of
&ldquo;sd&rdquo; (standard deviation),
&ldquo;value.at.risk&rdquo; or
&ldquo;expected.shortfall&rdquo;.</p>
</td></tr>
<tr><td><code id="portfolio.optimize_+3A_type">type</code></td>
<td>
<p>The tpye of the optimization problem. Must be one of
&ldquo;minimum.risk&rdquo;, &ldquo;tangency&rdquo; or &ldquo;target.return&rdquo;
(see <b>Details</b>).</p>
</td></tr>
<tr><td><code id="portfolio.optimize_+3A_level">level</code></td>
<td>
<p>The confidence level which shall be used if
<code>risk.measure</code> is either &ldquo;value.at.risk&rdquo; or
&ldquo;expected.shortfall&rdquo;.</p>
</td></tr>
<tr><td><code id="portfolio.optimize_+3A_distr">distr</code></td>
<td>
<p>The default distribution is &ldquo;loss&rdquo;. If <code>object</code>
gives the return distribution set <code>distr</code> to &ldquo;return&rdquo;.</p>
</td></tr>
<tr><td><code id="portfolio.optimize_+3A_target.return">target.return</code></td>
<td>
<p>A numeric scalar specifying the target return if
the optimization problem is of <code>type</code> &ldquo;target.return&rdquo;.</p>
</td></tr>
<tr><td><code id="portfolio.optimize_+3A_risk.free">risk.free</code></td>
<td>
<p>A numeric scalar giving the risk free rate in case the
optimization problem is of <code>type</code> &ldquo;tangency&rdquo;.</p>
</td></tr>
<tr><td><code id="portfolio.optimize_+3A_silent">silent</code></td>
<td>
<p>If <code>TRUE</code> no prompts will appear in the console.</p>
</td></tr>
<tr><td><code id="portfolio.optimize_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>type</code> is &ldquo;minimum.risk&rdquo; the global minimum risk
portfolio is returned. <br />
</p>
<p>If <code>type</code> is &ldquo;tangency&rdquo; the portfolio maximizing the slope
of &ldquo;(expected return - risk free rate) / risk&rdquo; will be
returned. <br />
</p>
<p>If <code>type</code> is &ldquo;target.return&rdquo; the portfolio with expected
return <code>target.return</code> which minimizes the risk will be
returned. <br />
</p>
<p>Note that in case of an elliptical distribution (symmetric generalized
hyperbolic distributions) it does not matter which risk measure is
used. That is, minimizing the standard deviation results in a
portfolio which also minimizes the value-at-risk et cetera. <br />
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>portfolio.dist</code></td>
<td>
<p>An univariate generalized hyperbolic object of class <code><a href="#topic+ghyp-class">ghyp</a></code> which
represents the distribution of the optimal portfolio.</p>
</td></tr>
<tr><td><code>risk.measure</code></td>
<td>
<p>The risk measure which was used.</p>
</td></tr>
<tr><td><code>risk</code></td>
<td>
<p>The risk.</p>
</td></tr>
<tr><td><code>opt.weights</code></td>
<td>
<p>The optimal weights.</p>
</td></tr>
<tr><td><code>converged</code></td>
<td>
<p>Convergence returned from <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p>A possible error message returned from <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code>n.iter</code></td>
<td>
<p>The number of iterations returned from <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>In case <code>object</code> denotes a non-elliptical distribution and the
risk measure is either &ldquo;value.at.risk&rdquo; or
&ldquo;expected.shortfall&rdquo;, then the type &ldquo;tangency&rdquo;
optimization problem is not supported. <br />
</p>
<p>Constraints like avoiding short-selling are not supported yet. <br />
</p>


<h3>Author(s)</h3>

<p>David Luethi</p>


<h3>See Also</h3>

<p><code><a href="#topic+transform.ghyp">transform</a></code>, <code><a href="#topic+fit.ghypmv">fit.ghypmv</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(indices)

t.object &lt;- fit.tmv(-indices, silent = TRUE)
gauss.object &lt;- fit.gaussmv(-indices)

t.ptf &lt;- portfolio.optimize(t.object,
                            risk.measure = "expected.shortfall",
                            type = "minimum.risk",
                            level = 0.99,
                            distr = "loss",
                            silent = TRUE)

gauss.ptf &lt;- portfolio.optimize(gauss.object,
                                risk.measure = "expected.shortfall",
                                type = "minimum.risk",
                                level = 0.99,
                                distr = "loss")

par(mfrow = c(1, 3))

plot(c(t.ptf$risk, gauss.ptf$risk),
     c(-mean(t.ptf$portfolio.dist), -mean(gauss.ptf$portfolio.dist)),
     xlim = c(0, 0.035), ylim = c(0, 0.004),
     col = c("black", "red"), lwd = 4,
     xlab = "99 percent expected shortfall",
     ylab = "Expected portfolio return",
     main = "Global minimum risk portfolios")

legend("bottomleft", legend = c("Asymmetric t", "Gaussian"),
       col = c("black", "red"), lty = 1)

plot(t.ptf$portfolio.dist, type = "l",
     xlab = "log-loss ((-1) * log-return)", ylab = "Density")
lines(gauss.ptf$portfolio.dist, col = "red")

weights &lt;- cbind(Asymmetric.t = t.ptf$opt.weights,
                 Gaussian = gauss.ptf$opt.weights)

barplot(weights, beside = TRUE, ylab = "Weights")

</code></pre>

<hr>
<h2 id='qq-ghyp'>Quantile-Quantile Plot</h2><span id='topic+qqghyp'></span>

<h3>Description</h3>

<p>This function is intended to be used as a graphical diagnostic tool
for fitted univariate generalized hyperbolic distributions. Optionally
a qq-plot of the normal distribution can be added.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qqghyp(object, data = ghyp.data(object), gaussian = TRUE, line = TRUE,
       main = "Generalized Hyperbolic Q-Q Plot",
       xlab = "Theoretical Quantiles", ylab = "Sample Quantiles",
       ghyp.pch = 1, gauss.pch = 6, ghyp.lty = "solid",
       gauss.lty = "dashed", ghyp.col = "black", gauss.col = "black",
       plot.legend = TRUE, location = "topleft", legend.cex = 0.8,
       spline.points = 150, root.tol = .Machine$double.eps^0.5,
       rel.tol = root.tol, abs.tol = root.tol^1.5, add = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qq-ghyp_+3A_object">object</code></td>
<td>
<p>Usually a fitted univariate generalized hyperbolic distribution
of class <code><a href="#topic+mle.ghyp-class">mle.ghyp</a></code>. Alternatively
an object of class <code><a href="#topic+ghyp-class">ghyp</a></code> and a data vector.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_data">data</code></td>
<td>
<p>An object coercible to a <code>vector</code>.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_gaussian">gaussian</code></td>
<td>
<p>If <code>TRUE</code> a qq-plot of the normal distribution is plotted as a reference.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_line">line</code></td>
<td>
<p>If <code>TRUE</code> a line is fitted and drawn.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_main">main</code></td>
<td>
<p>An overall title for the plot.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_xlab">xlab</code></td>
<td>
<p>A title for the x axis.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_ylab">ylab</code></td>
<td>
<p>A title for the y axis.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_ghyp.pch">ghyp.pch</code></td>
<td>
<p>A plotting character, i.e., symbol to use for quantiles of
the generalized hyperbolic distribution.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_gauss.pch">gauss.pch</code></td>
<td>
<p>A plotting character, i.e., symbol to use for quantiles of
the normal distribution.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_ghyp.lty">ghyp.lty</code></td>
<td>
<p>The line type of the fitted line to the quantiles of the generalized
hyperbolic distribution.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_gauss.lty">gauss.lty</code></td>
<td>
<p>The line type of the fitted line to the quantiles of the normal distribution.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_ghyp.col">ghyp.col</code></td>
<td>
<p>A color of the quantiles of the generalized
hyperbolic distribution.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_gauss.col">gauss.col</code></td>
<td>
<p>A color of the quantiles of the normal distribution.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_plot.legend">plot.legend</code></td>
<td>
<p>If <code>TRUE</code> a legend is drawn.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_location">location</code></td>
<td>
<p>The location of the legend. See <code><a href="graphics.html#topic+legend">legend</a></code> for possible values.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_legend.cex">legend.cex</code></td>
<td>
<p>The character expansion of the legend. </p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_spline.points">spline.points</code></td>
<td>
<p>The number of support points when computing the quantiles.
Passed to <code><a href="#topic+qghyp">qghyp</a></code>.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_root.tol">root.tol</code></td>
<td>
<p>The tolerance of the quantiles. Passed to <code><a href="stats.html#topic+uniroot">uniroot</a></code>.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_rel.tol">rel.tol</code></td>
<td>
<p>The tolerance of the quantiles. Passed to <code><a href="stats.html#topic+integrate">integrate</a></code>.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_abs.tol">abs.tol</code></td>
<td>
<p>The tolerance of the quantiles. Passed to <code><a href="stats.html#topic+integrate">integrate</a></code>.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_add">add</code></td>
<td>
<p>If <code>TRUE</code> the points are added to an existing plot window. The <code>legend</code> argument then becomes deactivated.</p>
</td></tr>
<tr><td><code id="qq-ghyp_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Luethi</p>


<h3>See Also</h3>

<p><code><a href="#topic+hist.ghyp">hist</a></code>, <code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code>, <code><a href="#topic+qghyp">qghyp</a></code>,
<code><a href="#topic+plot.ghyp">plot</a></code>,
<code><a href="#topic+lines.ghyp">lines</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(smi.stocks)

  smi &lt;- fit.ghypuv(data = smi.stocks[, "Swiss.Re"])

  qqghyp(smi, spline.points = 100)

  qqghyp(fit.tuv(smi.stocks[, "Swiss.Re"], symmetric = TRUE),
         add = TRUE, ghyp.col = "red", line = FALSE)
</code></pre>

<hr>
<h2 id='scale-methods'>Scaling and Centering of ghyp Objects</h2><span id='topic+scale.ghyp'></span><span id='topic+scale+2Cghyp-method'></span>

<h3>Description</h3>

<p><code>scale</code> centers and/or scales a generalized hyperbolic distribution
to zero expectation and/or unit variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ghyp'
scale(x, center = TRUE, scale = TRUE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale-methods_+3A_x">x</code></td>
<td>
<p>An object inheriting from class <code><a href="#topic+ghyp-class">ghyp</a></code>.</p>
</td></tr>
<tr><td><code id="scale-methods_+3A_center">center</code></td>
<td>
<p>A logical value stating whether the object shall be
centered to zero expectation.</p>
</td></tr>
<tr><td><code id="scale-methods_+3A_scale">scale</code></td>
<td>
<p>A logical value stating whether the object shall be
scaled to unit variance.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+ghyp-class">ghyp</a></code>.
</p>


<h3>Author(s)</h3>

<p>David Luethi</p>


<h3>See Also</h3>

<p><code><a href="#topic+transform.ghyp">transform</a></code>, <code><a href="base.html#topic+mean">mean</a></code>,
<code><a href="stats.html#topic+vcov">vcov</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(indices)

  t.fit &lt;- fit.tmv(indices)
  gauss.fit &lt;- fit.gaussmv(indices)

  ## Compare the fitted Student-t and Gaussian density.
  par(mfrow = c(1, 2))

  ## Once on the real scale...
  plot(t.fit[1], type = "l")
  lines(gauss.fit[1], col = "red")

  ## ...and once scaled to expectation = 0, variance = 1
  plot(scale(t.fit)[1], type = "l")
  lines(scale(gauss.fit)[1], col = "red")
</code></pre>

<hr>
<h2 id='smi.stocks'>Daily returns of five swiss blue chips and the SMI</h2><span id='topic+smi.stocks'></span>

<h3>Description</h3>

<p>Daily returns from January 2000 to January 2007 of five swiss blue
chips and the Swiss Market Index (SMI).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(smi.stocks)</code></pre>


<h3>Format</h3>


<dl>
<dt><code>SMI</code></dt><dd><p>Swiss Market Index.</p>
</dd>
<dt><code>Novartis</code></dt><dd><p>Novartis pharma.</p>
</dd>
<dt><code>CS</code></dt><dd><p>Credit Suisse.</p>
</dd>
<dt><code>Nestle</code></dt><dd><p>Nestle.</p>
</dd>
<dt><code>Swisscom</code></dt><dd><p>Swiss telecom company.</p>
</dd>
<dt><code>Swiss.Re</code></dt><dd><p>Swiss reinsurer.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+indices">indices</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(smi.stocks)

  pairs(smi.stocks)
</code></pre>

<hr>
<h2 id='stepAIC.ghyp'>Perform a model selection based on the AIC</h2><span id='topic+stepAIC.ghyp'></span>

<h3>Description</h3>

<p>This function performs a model selection in the scope of the
generalized hyperbolic distribution class based on the Akaike
information criterion. <code>stepAIC.ghyp</code> can be used for the
univariate as well as for the multivariate case.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stepAIC.ghyp(data, dist = c("ghyp", "hyp", "NIG", "VG", "t", "gauss"),
             symmetric = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepAIC.ghyp_+3A_data">data</code></td>
<td>
<p>A <code>vector</code>, <code>matrix</code> or <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="stepAIC.ghyp_+3A_dist">dist</code></td>
<td>
<p>A character vector of distributions from where the best fit will be identified.</p>
</td></tr>
<tr><td><code id="stepAIC.ghyp_+3A_symmetric">symmetric</code></td>
<td>
<p>Either <code>NULL</code>, <code>TRUE</code> or <code>FALSE</code>. <code>NULL</code> means that
both symmetric and asymmetric models will be fitted. For symmetric models
select <code>TRUE</code> and for asymmetric models select <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="stepAIC.ghyp_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code> or <code><a href="#topic+fit.ghypmv">fit.ghypmv</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>best.model</code></td>
<td>
<p>The model minimizing the AIC.</p>
</td></tr>
<tr><td><code>all.models</code></td>
<td>
<p>All fitted models.</p>
</td></tr>
<tr><td><code>fit.table</code></td>
<td>
<p>A <code>data.frame</code> with columns <code>model</code>, <code>symmetric</code>,
<code>lambda</code>, <code>alpha.bar</code>, <code>aic</code>, <code>llh</code> (log-Likelihood),
<code>converged</code>, <code>n.iter</code> (number of iterations) sorted according to the
aic. In the univariate case three additional columns containing
the parameters <code>mu</code>, <code>sigma</code> and <code>gamma</code> are added.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Luethi</p>


<h3>See Also</h3>

<p><code><a href="#topic+lik.ratio.test">lik.ratio.test</a></code>, <code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code> and <code><a href="#topic+fit.ghypmv">fit.ghypmv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(indices)

  # Multivariate case:
  aic.mv &lt;- stepAIC.ghyp(indices, dist = c("ghyp", "hyp", "t", "gauss"),
                         symmetric = NULL, control = list(maxit = 500),
                         silent = TRUE, nit = 500)

  summary(aic.mv$best.model)

  # Univariate case:
  aic.uv &lt;- stepAIC.ghyp(indices[, "stock"], dist = c("ghyp", "NIG", "VG", "gauss"),
                         symmetric = TRUE, control = list(maxit = 500), silent = TRUE)


  # Test whether the ghyp-model provides a significant improvement with
  # respect to the VG-model:
  lik.ratio.test(aic.uv$all.models[[1]], aic.uv$all.models[[3]])

</code></pre>

<hr>
<h2 id='summary-method'>mle.ghyp summary</h2><span id='topic+summary.mle.ghyp'></span><span id='topic+summary-methods'></span><span id='topic+summary+2Cmle.ghyp-method'></span>

<h3>Description</h3>

<p>Produces a formatted output of a fitted generalized hyperbolic
distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mle.ghyp'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary-method_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+mle.ghyp-class">mle.ghyp</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing is returned.
</p>


<h3>Author(s)</h3>

<p>David Luethi</p>


<h3>See Also</h3>

<p>Fitting functions <code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code> and <code><a href="#topic+fit.ghypmv">fit.ghypmv</a></code>,
<code><a href="#topic+coef.ghyp">coef</a></code>, <code><a href="#topic+mean.ghyp">mean</a></code>,
<code><a href="#topic+vcov.ghyp">vcov</a></code> and <code><a href="#topic+ghyp.fit.info">ghyp.fit.info</a></code>
for accessor functions for <code><a href="#topic+mle.ghyp-class">mle.ghyp</a></code> objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(smi.stocks)
  mle.ghyp.object &lt;- fit.NIGmv(smi.stocks[, c("Nestle", "Swiss.Re", "Novartis")])
  summary(mle.ghyp.object)
</code></pre>

<hr>
<h2 id='transform-extract-methods'>Linear transformation and extraction of generalized hyperbolic
distributions</h2><span id='topic+transform.ghyp'></span><span id='topic+transform+2Cghyp-method'></span><span id='topic++5B.ghyp'></span><span id='topic++5B+2Cghyp+2Cnumeric+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p>The <code>transform</code> function can be used to linearly transform
generalized hyperbolic distribution objects (see <b>Details</b>). The
extraction operator <code>[</code> extracts some margins of a multivariate
generalized hyperbolic distribution object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ghyp'
transform(`_data`, summand, multiplier)

## S3 method for class 'ghyp'
x[i = c(1, 2)]
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transform-extract-methods_+3A__data">_data</code></td>
<td>
<p>An object inheriting from class <code><a href="#topic+ghyp-class">ghyp</a></code>.</p>
</td></tr>
<tr><td><code id="transform-extract-methods_+3A_summand">summand</code></td>
<td>
<p>A <code>vector</code>.</p>
</td></tr>
<tr><td><code id="transform-extract-methods_+3A_multiplier">multiplier</code></td>
<td>
<p>A <code>vector</code> or a <code>matrix</code>.</p>
</td></tr>
<tr><td><code id="transform-extract-methods_+3A_x">x</code></td>
<td>
<p>A multivariate generalized hyperbolic distribution inheriting from class <code><a href="#topic+ghyp-class">ghyp</a></code>.</p>
</td></tr>
<tr><td><code id="transform-extract-methods_+3A_i">i</code></td>
<td>
<p>Index specifying which dimensions to extract.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code class="reqn">X \sim GH</code>, <code>transform</code> gives the
distribution object of &ldquo;multiplier * X + summand&rdquo;, where X is
the argument named <code>_data</code>. <br />
</p>
<p>If the object is of class <code><a href="#topic+mle.ghyp-class">mle.ghyp</a></code>,
iformation concerning the fitting procedure
(cf. <code><a href="#topic+ghyp.fit.info">ghyp.fit.info</a></code>) will be lost as the return value is an
object of class <code><a href="#topic+ghyp-class">ghyp</a></code>.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+ghyp-class">ghyp</a></code>.
</p>


<h3>Author(s)</h3>

<p>David Luethi</p>


<h3>See Also</h3>

<p><code><a href="#topic+scale.ghyp">scale</a></code>, <code><a href="#topic+ghyp">ghyp</a></code>,
<code><a href="#topic+fit.ghypuv">fit.ghypuv</a></code> and <code><a href="#topic+fit.ghypmv">fit.ghypmv</a></code> for constructors
of <code><a href="#topic+ghyp-class">ghyp</a></code> objects.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Mutivariate generalized hyperbolic distribution
  multivariate.ghyp &lt;- ghyp(sigma=var(matrix(rnorm(9),ncol=3)), mu=1:3, gamma=-2:0)

  ## Dimension reduces to 2
  transform(multivariate.ghyp, multiplier=matrix(1:6,nrow=2), summand=10:11)

  ## Dimension reduces to 1
  transform(multivariate.ghyp, multiplier=1:3)

  ## Simple transformation
  transform(multivariate.ghyp, summand=100:102)

  ## Extract some dimension
  multivariate.ghyp[1]
  multivariate.ghyp[c(1, 3)]
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
