<!DOCTYPE html><html lang="en"><head><title>Help for package spbabel</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spbabel}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#spbabel-package'><p>Convert between different types of spatial objects.</p></a></li>
<li><a href='#as_tibble.sfg'><p>Individual geometries as tibbles.</p></a></li>
<li><a href='#feature_table'><p>Normal form for sf</p></a></li>
<li><a href='#holey'><p>Multi-part, multi-holed, neighbouring, not completely topological polygons.</p></a></li>
<li><a href='#map_table'><p>A decomposition of 'vector' map data structures to tables.</p></a></li>
<li><a href='#mpoint1'><p>MultiPointsDataFrame data set</p></a></li>
<li><a href='#semap'><p>&quot;South-east&quot; map data.</p></a></li>
<li><a href='#sf'><p>TBD Convert from dplyr tbl form to simple features.</p></a></li>
<li><a href='#show+2CSpatialPolygonsDataFrame-method'><p>sp methods</p></a></li>
<li><a href='#sp'><p>Convert from dplyr tbl form to Spatial*DataFrame.</p></a></li>
<li><a href='#sptable.SpatialPolygons'><p>Convert from various forms to a table.</p></a></li>
<li><a href='#track'><p>Multi-object track with x, y, z, and time.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.0</td>
</tr>
<tr>
<td>Title:</td>
<td>Convert Spatial Data Using Tidy Tables</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools to convert from specific formats to more general forms of 
    spatial data. Using tables to store the actual entities present in spatial
    data provides flexibility, and the functions here deliberately 
    minimize the level of interpretation applied, leaving that for specific 
    applications. Includes support for simple features,  round-trip for 'Spatial' classes and long-form 
    tables, analogous to 'ggplot2::fortify'. There is also a more 'normal form' representation
    that decomposes simple features and their kin to tables of objects, parts, and unique coordinates. </td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://mdsumner.github.io/spbabel/">https://mdsumner.github.io/spbabel/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mdsumner/spbabel/issues">https://github.com/mdsumner/spbabel/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, methods, sp, tibble, rlang, pkgconfig</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, ggplot2, raster, sf, rmarkdown, covr, trip, viridis</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>TRUE</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-12 09:59:11 UTC; mdsumner</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael D. Sumner [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael D. Sumner &lt;mdsumner@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-12 10:20:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='spbabel-package'>Convert between different types of spatial objects.</h2><span id='topic+spbabel-package'></span>

<h3>Description</h3>

<p>Facilities for converting between different types of spatial objects, including an in-place method to modify the underlying geometry of 'Spatial' classes using data frame idioms.The spbabel package provides functions to round-trip a Spatial object to a single table and back.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+sptable+3C-">sptable&lt;-</a></code> </td><td style="text-align: left;"> modify a Spatial object in-place  </td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+sptable">sptable</a></code> </td><td style="text-align: left;"> create a <code><a href="tibble.html#topic+tibble">tibble</a></code> from Spatial DataFrame object  </td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+sp">sp</a></code> </td><td style="text-align: left;"> create Spatial DataFrame object from table </td>
</tr>
<tr>
 <td style="text-align: left;">
 </td>
</tr>

</table>


<hr>
<h2 id='as_tibble.sfg'>Individual geometries as tibbles.</h2><span id='topic+as_tibble.sfg'></span>

<h3>Description</h3>

<p>Individual geometries as tibbles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sfg'
as_tibble(
  x,
  ...,
  .rows = NULL,
  .name_repair = c("check_unique", "unique", "universal", "minimal"),
  rownames = pkgconfig::get_config("tibble::rownames", NULL)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_tibble.sfg_+3A_x">x</code></td>
<td>
<p>sf geometry of type sfg</p>
</td></tr>
<tr><td><code id="as_tibble.sfg_+3A_...">...</code></td>
<td>
<p>Unused, for extensibility.</p>
</td></tr>
<tr><td><code id="as_tibble.sfg_+3A_.rows">.rows</code></td>
<td>
<p>The number of rows, useful to create a 0-column tibble or
just as an additional check.</p>
</td></tr>
<tr><td><code id="as_tibble.sfg_+3A_.name_repair">.name_repair</code></td>
<td>
<p>Treatment of problematic column names:
</p>

<ul>
<li> <p><code>"minimal"</code>: No name repair or checks, beyond basic existence,
</p>
</li>
<li> <p><code>"unique"</code>: Make sure names are unique and not empty,
</p>
</li>
<li> <p><code>"check_unique"</code>: (default value), no name repair, but check they are
<code>unique</code>,
</p>
</li>
<li> <p><code>"universal"</code>: Make the names <code>unique</code> and syntactic
</p>
</li>
<li><p> a function: apply custom name repair (e.g., <code>.name_repair = make.names</code>
for names in the style of base R).
</p>
</li>
<li><p> A purrr-style anonymous function, see <code><a href="rlang.html#topic+as_function">rlang::as_function()</a></code>
</p>
</li></ul>

<p>This argument is passed on as <code>repair</code> to <code><a href="vctrs.html#topic+vec_as_names">vctrs::vec_as_names()</a></code>.
See there for more details on these terms and the strategies used
to enforce them.</p>
</td></tr>
<tr><td><code id="as_tibble.sfg_+3A_rownames">rownames</code></td>
<td>
<p>How to treat existing row names of a data frame or matrix:
</p>

<ul>
<li> <p><code>NULL</code>: remove row names. This is the default.
</p>
</li>
<li> <p><code>NA</code>: keep row names.
</p>
</li>
<li><p> A string: the name of a new column. Existing rownames are transferred
into this column and the <code>row.names</code> attribute is deleted.
No name repair is applied to the new column name, even if <code>x</code> already contains
a column of that name.
Use <code>as_tibble(rownames_to_column(...))</code> to safeguard against this case.
</p>
</li></ul>

<p>Read more in <a href="tibble.html#topic+rownames">rownames</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble
</p>

<hr>
<h2 id='feature_table'>Normal form for sf</h2><span id='topic+feature_table'></span>

<h3>Description</h3>

<p>A 'feature_table' is a normal form for simple features, where all branches are
recorded in one table with attributes object_, branch_, type_, parent_. All instances of parent_
are NA except for the holes in multipolygon.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>feature_table(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="feature_table_+3A_x">x</code></td>
<td>
<p>sf object</p>
</td></tr>
<tr><td><code id="feature_table_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There is wasted information stored this way, but that's because this is intended as a lowest common denominator format.
</p>
<p>There are three tables, objects (the feature attributes and ID), branches (the parts),
coordinates (the X, Y, Z, M values).
</p>

<hr>
<h2 id='holey'>Multi-part, multi-holed, neighbouring, not completely topological polygons.</h2><span id='topic+holey'></span>

<h3>Description</h3>

<p>Created in /data-raw/ from a manual drawing built in Manifold GIS.
</p>

<hr>
<h2 id='map_table'>A decomposition of 'vector' map data structures to tables.</h2><span id='topic+map_table'></span>

<h3>Description</h3>

<p>Creates a set of related tables to store the appropriate
entities in spatial map data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map_table(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="map_table_+3A_x">x</code></td>
<td>
<p>object to tidy</p>
</td></tr>
<tr><td><code id="map_table_+3A_...">...</code></td>
<td>
<p>arguments passed to methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The basic entities behind spatial data, and hence the &quot;map tables&quot; are:
</p>

<dl>
<dt>vertices</dt><dd><p>the positions in geometric space, e.g. x, y, z, time, long, lat, salinity etc.</p>
</dd>
<dt>branches</dt><dd><p>a single connected chain of vertices, or &quot;parts&quot;</p>
</dd>
<dt>objects</dt><dd><p>a collection of branches aligned to a row of metadata</p>
</dd>
</dl>

<p>This is the basic &quot;topology&quot; of traditional GIS vector data, for points,
lines, polygons and their multi-counterparts. By default map_tables will
produce these tables and also de-duplicated the input vertices, adding a
fourth table to link vertices to branches.
</p>
<p>Other topology types such as triangle or quad meshes can extend this
four-entity model, or exist without the branches at all. See &quot;mesh_table&quot; ??
</p>
<p>These are currently classed as object_table, branch_table, branch_link_vertex_table, and vertex_table. But there are no methods.
</p>


<h3>Value</h3>

<p>list of tibbles
</p>

<hr>
<h2 id='mpoint1'>MultiPointsDataFrame data set</h2><span id='topic+mpoint1'></span>

<h3>Description</h3>

<p>MultiPointsDataFrame data set
</p>

<hr>
<h2 id='semap'>&quot;South-east&quot; map data.</h2><span id='topic+semap'></span><span id='topic+seatt'></span>

<h3>Description</h3>

<p>Created in /data-raw/ <code>semap</code> is the <code>sptable</code> version of some of maptools 'wrld_simpl' and <code>seatt</code> is the matching attribute data, linked by 'object_'.
</p>
<p>Created in /data-raw/.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># recreate as sp object
mp &lt;- sp(semap, attr_tab = seatt, crs = "+proj=longlat +ellps=WGS84")

</code></pre>

<hr>
<h2 id='sf'>TBD Convert from dplyr tbl form to simple features.</h2><span id='topic+sf'></span><span id='topic+sf.data.frame'></span>

<h3>Description</h3>

<p>Not yet implemented.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sf(x, ...)

## S3 method for class 'data.frame'
sf(x, attr_tab = NULL, crs, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sf_+3A_x">x</code></td>
<td>
<p>tibble as created by <code><a href="#topic+sptable">sptable</a></code></p>
</td></tr>
<tr><td><code id="sf_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
<tr><td><code id="sf_+3A_attr_tab">attr_tab</code></td>
<td>
<p>remaining data from the attributes</p>
</td></tr>
<tr><td><code id="sf_+3A_crs">crs</code></td>
<td>
<p>projection, defaults to <code>NA_character_</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>sf
</p>

<hr>
<h2 id='show+2CSpatialPolygonsDataFrame-method'>sp methods</h2><span id='topic+show+2CSpatialPolygonsDataFrame-method'></span><span id='topic+show+2CSpatialLinesDataFrame-method'></span><span id='topic+show+2CSpatialPointsDataFrame-method'></span><span id='topic+print+2CSpatial-method'></span>

<h3>Description</h3>

<p>Sp methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'SpatialPolygonsDataFrame'
show(object)

## S4 method for signature 'SpatialLinesDataFrame'
show(object)

## S4 method for signature 'SpatialPointsDataFrame'
show(object)

## S4 method for signature 'Spatial'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show+2B2CSpatialPolygonsDataFrame-method_+3A_object">object</code></td>
<td>
<p>Spatial object</p>
</td></tr>
<tr><td><code id="show+2B2CSpatialPolygonsDataFrame-method_+3A_x">x</code></td>
<td>
<p>Spatial object</p>
</td></tr>
<tr><td><code id="show+2B2CSpatialPolygonsDataFrame-method_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>

<hr>
<h2 id='sp'>Convert from dplyr tbl form to Spatial*DataFrame.</h2><span id='topic+sp'></span><span id='topic+sp.data.frame'></span>

<h3>Description</h3>

<p>Convert from dplyr tbl form to Spatial*DataFrame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sp(x, ...)

## S3 method for class 'data.frame'
sp(x, attr_tab = NULL, crs, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sp_+3A_x">x</code></td>
<td>
<p>tibble as created by <code><a href="#topic+sptable">sptable</a></code></p>
</td></tr>
<tr><td><code id="sp_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
<tr><td><code id="sp_+3A_attr_tab">attr_tab</code></td>
<td>
<p>remaining data from the attributes</p>
</td></tr>
<tr><td><code id="sp_+3A_crs">crs</code></td>
<td>
<p>projection, defaults to <code>NA_character_</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Spatial*
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
semap1 &lt;- semap  %&gt;% dplyr::filter(y_ &gt; -89.9999)
sp_obj &lt;- sp(semap1, attr_tab = seatt, crs = "+proj=longlat +ellps=WGS84")
## look, seamless Antarctica!
## library(rgdal); plot(spTransform(sp_obj, "+proj=laea +lat_0=-70"))
</code></pre>

<hr>
<h2 id='sptable.SpatialPolygons'>Convert from various forms to a table.</h2><span id='topic+sptable.SpatialPolygons'></span><span id='topic+sptable.SpatialLines'></span><span id='topic+sptable.SpatialPointsDataFrame'></span><span id='topic+sptable.SpatialMultiPointsDataFrame'></span><span id='topic+sptable+3C-'></span><span id='topic+sptable'></span><span id='topic+map_table.trip'></span>

<h3>Description</h3>

<p>Decompose a <code><a href="sp.html#topic+Spatial">Spatial</a></code> or sf object to a single table structured as a row for every coordinate in all the sub-geometries, including duplicated coordinates that close polygonal rings, close lines and shared vertices between objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SpatialPolygons'
sptable(x, ...)

## S3 method for class 'SpatialLines'
sptable(x, ...)

## S3 method for class 'SpatialPointsDataFrame'
sptable(x, ...)

## S3 method for class 'SpatialMultiPointsDataFrame'
sptable(x, ...)

sptable(object) &lt;- value

sptable(x, ...)

## S3 method for class 'trip'
map_table(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sptable.SpatialPolygons_+3A_x">x</code></td>
<td>
<p><code><a href="sp.html#topic+Spatial">Spatial</a></code> object</p>
</td></tr>
<tr><td><code id="sptable.SpatialPolygons_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="sptable.SpatialPolygons_+3A_object">object</code></td>
<td>
<p>Spatial object</p>
</td></tr>
<tr><td><code id="sptable.SpatialPolygons_+3A_value">value</code></td>
<td>
<p>modified sptable version of object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input can be a of type sf or  <code><a href="sp.html#topic+SpatialPolygonsDataFrame">SpatialPolygonsDataFrame</a></code>, <code><a href="sp.html#topic+SpatialLinesDataFrame">SpatialLinesDataFrame</a></code>, <code><a href="sp.html#topic+SpatialMultiPointsDataFrame">SpatialMultiPointsDataFrame</a></code> or a <code><a href="sp.html#topic+SpatialPointsDataFrame">SpatialPointsDataFrame</a></code>.
For simplicity <code>sptable</code> and its inverses <code>sp</code> and <code>sf</code> assume that all geometry can be encoded with object, branch, island, order, x and y.
and that the type of topology is identified by which of these are present.
</p>
<p>For simple features objects with mixed types of topology the result is consistent, but probably not useful.
Columns that aren't present in one type will be present, padded with NA. (This is work in progress).
</p>


<h3>Value</h3>

<p>Spatial object
</p>
<p><code><a href="tibble.html#topic+tibble">tibble</a></code>  with columns
</p>

<ul>
<li><p> SpatialPolygonsDataFrame &quot;object_&quot;   &quot;branch_&quot;   &quot;island_&quot;   &quot;order_&quot; &quot;x&quot;    &quot;y_&quot;
</p>
</li>
<li><p> SpatialLinesDataFrame &quot;object_&quot;   &quot;branch_&quot; &quot;order_&quot;  &quot;x_&quot;      &quot;y_&quot;
</p>
</li>
<li><p> SpatialPointsDataFrame  &quot;object_&quot; x_&quot;      &quot;y_&quot;
</p>
</li>
<li><p> SpatialMultiPointsDataFrame &quot;object_&quot; &quot;branch_&quot; &quot;x_&quot; &quot;y_&quot;
</p>
</li>
<li><p> sf some combination of the above
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## holey is a decomposed SpatialPolygonsDataFrame
spdata &lt;- sp(holey)
library(sp)
plot(spdata, col = rainbow(nrow(spdata), alpha = 0.4))
points(holey$x_, holey$y_, cex = 4)
holes &lt;- subset(holey, !island_)
## add the points that only belong to holes
points(holes$x_, holes$y_, pch = "+", cex = 2)

## manipulate based on topology
## convert to not-holes
notahole &lt;- holes
notahole$island_ &lt;- TRUE
#also convert to singular objects - note that this now means we have an overlapping pair of polys
#because the door had a hole filled by another object
notahole$object_ &lt;- notahole$branch_
plot(sp(notahole), add = TRUE, col = "red")

</code></pre>

<hr>
<h2 id='track'>Multi-object track with x, y, z, and time.</h2><span id='topic+track'></span>

<h3>Description</h3>

<p>Created in /data-raw/track.r
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
