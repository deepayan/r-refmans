<!DOCTYPE html><html lang="en"><head><title>Help for package tmvtnsim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tmvtnsim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#tmvtnsim-package'><p>Truncated Multivariate Normal and t Distribution Simulation</p></a></li>
<li><a href='#rtmvnorm'><p>Random Generation for Truncated Multivariate Normal</p></a></li>
<li><a href='#rtmvt'><p>Random Generation for Truncated Multivariate t</p></a></li>
<li><a href='#rtnorm'><p>Random Generation for Truncated Univariate Normal</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Truncated Multivariate Normal and t Distribution Simulation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-10-09</td>
</tr>
<tr>
<td>Author:</td>
<td>Kaifeng Lu</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kaifeng Lu &lt;kaifenglu@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Simulation of random vectors from truncated multivariate normal 
  and t distributions based on the algorithms proposed by Yifang Li and Sujit K. Ghosh (2015) &lt;<a href="https://doi.org/10.1080%2F15598608.2014.996690">doi:10.1080/15598608.2014.996690</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.7)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), tmvmixnorm</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-09 21:25:56 UTC; kaifeng</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-09 21:50:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='tmvtnsim-package'>Truncated Multivariate Normal and t Distribution Simulation</h2><span id='topic+tmvtnsim-package'></span>

<h3>Description</h3>

<p>Simulation of random vectors from truncated multivariate 
normal and t distributions based on the algorithms proposed by 
Yifang Li and Sujit K. Ghosh (2015) &lt;doi:10.1080/15598608.2014.996690&gt;. 
We allow the mean, lower and upper bounds to differ across samples 
to accommodate regression problems. The algorithms are implemented 
in C++ and hence are highly efficient.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Yifang Li and Sujit K. Ghosh. Efficient Sampling Methods for Truncated
Multivariate Normal and Student-t Distributions Subject to Linear 
Inequality Constraints. Journal of Statistical Theory and Practice. 
2015;9:712-732. doi: <a href="https://doi.org/10.1080/15598608.2014.996690">10.1080/15598608.2014.996690</a>
</p>

<hr>
<h2 id='rtmvnorm'>Random Generation for Truncated Multivariate Normal</h2><span id='topic+rtmvnorm'></span>

<h3>Description</h3>

<p>Draws from truncated multivariate normal distribution subject to 
linear inequality constraints represented by a matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtmvnorm(
  mean,
  sigma,
  blc = NULL,
  lower,
  upper,
  init = NULL,
  burn = 10,
  n = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rtmvnorm_+3A_mean">mean</code></td>
<td>
<p><code>n x p</code> matrix of means. The number of rows is the number 
of observations. The number of columns is the dimension of the problem.</p>
</td></tr>
<tr><td><code id="rtmvnorm_+3A_sigma">sigma</code></td>
<td>
<p><code>p x p</code> covariance matrix.</p>
</td></tr>
<tr><td><code id="rtmvnorm_+3A_blc">blc</code></td>
<td>
<p><code>m x p</code> matrix of coefficients for linear inequality 
constraints. If <code>NULL</code>, the <code>p x p</code> identity matrix will be used.</p>
</td></tr>
<tr><td><code id="rtmvnorm_+3A_lower">lower</code></td>
<td>
<p><code>n x m</code> or <code>1 x m</code> matrix of lower bounds for 
truncation.</p>
</td></tr>
<tr><td><code id="rtmvnorm_+3A_upper">upper</code></td>
<td>
<p><code>n x m</code> or <code>1 x m</code> matrix of upper bounds for 
truncation.</p>
</td></tr>
<tr><td><code id="rtmvnorm_+3A_init">init</code></td>
<td>
<p><code>n x p</code> or <code>1 x p</code> matrix of initial values. 
If <code>NULL</code>, default initial values will be generated.</p>
</td></tr>
<tr><td><code id="rtmvnorm_+3A_burn">burn</code></td>
<td>
<p>number of burn-in iterations. Defaults to 10.</p>
</td></tr>
<tr><td><code id="rtmvnorm_+3A_n">n</code></td>
<td>
<p>number of random samples when <code>mean</code> is a vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an <code>n x p</code> matrix of random numbers following the 
specified truncated multivariate normal distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: full rank blc
d = 3;
rho = 0.9;
sigma = matrix(0, d, d);
sigma = rho^abs(row(sigma) - col(sigma));
blc = diag(1,d);
n = 1000;
mean = matrix(rep(1:d,n), nrow=n, ncol=d, byrow=TRUE);
set.seed(1203)
result = rtmvnorm(mean, sigma, blc, -1, 1, burn=50)
apply(result, 2, summary)

# Example 2: use the alternative form of input
set.seed(1203)
result = rtmvnorm(mean=1:d, sigma, blc, -1, 1, burn=50, n=1000)
apply(result, 2, summary)

# Example 3: non-full rank blc
d = 3;
rho = 0.5;
sigma = matrix(0, d, d);
sigma = rho^abs(row(sigma) - col(sigma));
blc = matrix(c(1,1,1,0,1,0,1,0,1), ncol=d);
n = 100;
mean = matrix(rep(1:d,n), nrow=n, ncol=d, byrow=TRUE);
set.seed(1228)
result = rtmvnorm(mean, sigma, blc, -1, 1, burn=10)
apply(result, 2, summary)

# Example 4: non-full rank blc, alternative form of input
set.seed(1228)
result = rtmvnorm(mean=1:d, sigma, blc, -1, 1, burn=10, n=100)
apply(result, 2, summary) 

# Example 5: means, lower, or upper bounds differ across samples
d = 3;
rho = 0.5;
sigma = matrix(0, d, d);
sigma = rho^abs(row(sigma) - col(sigma));
blc = matrix(c(1,0,1,1,1,0), ncol=d, byrow=TRUE)
n = 100;
set.seed(3084)
mean = matrix(runif(n*d), nrow=n, ncol=d);
result = rtmvnorm(mean, sigma, blc, -1, 1, burn=50)
apply(result, 2, summary)

</code></pre>

<hr>
<h2 id='rtmvt'>Random Generation for Truncated Multivariate t</h2><span id='topic+rtmvt'></span>

<h3>Description</h3>

<p>Draws from truncated multivariate t distribution subject to 
linear inequality constraints represented by a matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtmvt(
  mean,
  sigma,
  nu,
  blc = NULL,
  lower,
  upper,
  init = NULL,
  burn = 10,
  n = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rtmvt_+3A_mean">mean</code></td>
<td>
<p><code>n x p</code> matrix of means. The number of rows is the number 
of observations. The number of columns is the dimension of the problem.</p>
</td></tr>
<tr><td><code id="rtmvt_+3A_sigma">sigma</code></td>
<td>
<p><code>p x p</code> covariance matrix.</p>
</td></tr>
<tr><td><code id="rtmvt_+3A_nu">nu</code></td>
<td>
<p>degrees of freedom for Student-t distribution.</p>
</td></tr>
<tr><td><code id="rtmvt_+3A_blc">blc</code></td>
<td>
<p><code>m x p</code> matrix of coefficients for linear inequality 
constraints. If <code>NULL</code>, the <code>p x p</code> identity matrix will be used.</p>
</td></tr>
<tr><td><code id="rtmvt_+3A_lower">lower</code></td>
<td>
<p><code>n x m</code> or <code>1 x m</code> matrix of lower bounds for 
truncation.</p>
</td></tr>
<tr><td><code id="rtmvt_+3A_upper">upper</code></td>
<td>
<p><code>n x m</code> or <code>1 x m</code> matrix of upper bounds for 
truncation.</p>
</td></tr>
<tr><td><code id="rtmvt_+3A_init">init</code></td>
<td>
<p><code>n x p</code> or <code>1 x p</code> matrix of initial values. 
If <code>NULL</code>, default initial values will be generated.</p>
</td></tr>
<tr><td><code id="rtmvt_+3A_burn">burn</code></td>
<td>
<p>number of burn-in iterations. Defaults to 10.</p>
</td></tr>
<tr><td><code id="rtmvt_+3A_n">n</code></td>
<td>
<p>number of random samples when <code>mean</code> is a vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an <code>n x p</code> matrix of random numbers following the 
specified truncated multivariate t distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: full rank blc
d = 3;
rho = 0.5;
sigma = matrix(0, d, d);
sigma = rho^abs(row(sigma) - col(sigma));
nu = 10;
blc = diag(1,d);
n = 1000;
mean = matrix(rep(1:d,n), nrow=n, ncol=d, byrow=TRUE);
set.seed(1203)
result = rtmvt(mean, sigma, nu, blc, -1, 1, burn=50)
apply(result, 2, summary)

# Example 2: use the alternative form of input
set.seed(1203)
result = rtmvt(mean=1:d, sigma, nu, blc, -1, 1, burn=50, n)
apply(result, 2, summary)

# Example 3: non-full rank blc, different means
d = 3;
rho = 0.5;
sigma = matrix(0, d, d);
sigma = rho^abs(row(sigma) - col(sigma));
nu = 10;
blc = matrix(c(1,0,1,1,1,0), nrow=d-1, ncol=d, byrow=TRUE)
n = 100;
set.seed(3084)
mean = matrix(runif(n*d), nrow=n, ncol=d);
result = rtmvt(mean, sigma, nu, blc, -1, 1, burn=50)
apply(result, 2, summary)

</code></pre>

<hr>
<h2 id='rtnorm'>Random Generation for Truncated Univariate Normal</h2><span id='topic+rtnorm'></span>

<h3>Description</h3>

<p>Draws from truncated univariate normal distribution within an interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtnorm(mean, sd = 1, lower, upper, n = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rtnorm_+3A_mean">mean</code></td>
<td>
<p>vector of means. The length is the number of observations.</p>
</td></tr>
<tr><td><code id="rtnorm_+3A_sd">sd</code></td>
<td>
<p>standard deviation. Defaults to 1.</p>
</td></tr>
<tr><td><code id="rtnorm_+3A_lower">lower</code></td>
<td>
<p>a scalar of lower bound for truncation, or a vector of 
lower bounds with the same length as <code>mean</code>.</p>
</td></tr>
<tr><td><code id="rtnorm_+3A_upper">upper</code></td>
<td>
<p>a scalar of upper bound for truncation, or a vector of 
upper bounds with the same length as <code>mean</code>.</p>
</td></tr>
<tr><td><code id="rtnorm_+3A_n">n</code></td>
<td>
<p>number of random samples when <code>mean</code> is a scalar.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector of random numbers following the specified 
truncated univariate normal distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1203)
x = rtnorm(mean=rep(1,1000), sd=2, lower=-2, upper=3)
summary(x)

# use the alternative form of input
set.seed(1203)
x = rtnorm(mean=1, sd=2, lower=-2, upper=3, n=1000)
summary(x)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
