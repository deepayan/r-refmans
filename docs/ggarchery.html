<!DOCTYPE html><html lang="en"><head><title>Help for package ggarchery</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ggarchery}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#attract_by_distance'><p>Move points towards each other an absolute distance</p></a></li>
<li><a href='#attract_proportionally'><p>Move points towards each other a proportion of the distance between them</p></a></li>
<li><a href='#draw_key_arrowpath'><p>This function replaces <code>ggplot2::draw_key_path</code> and displays all the requested arrowheads.</p></a></li>
<li><a href='#geom_arrowsegment'><p>Line segments with flexible arrows</p></a></li>
<li><a href='#GeomArrowsegment'><p>Base ggproto classes for ggarchery</p></a></li>
<li><a href='#position_attractsegment'><p>Nudge points towards each other along a line</p></a></li>
<li><a href='#split_arrows'><p>Find where to place arrows</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, purrr, magrittr, tidyr, dplyr, glue, rlang, grid</td>
</tr>
<tr>
<td>Title:</td>
<td>Flexible Segment Geoms with Arrows for 'ggplot2'</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Geoms for placing arrowheads at multiple points along a segment, not just at the end; position function to shift starts and ends of arrows to avoid exactly intersecting points.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mdhall272/ggarchery">https://github.com/mdhall272/ggarchery</a></td>
</tr>
<tr>
<td>Collate:</td>
<td>'legend-draw-ggarchery.R' 'geom-arrowsegment.R' 'ggproto.R'
'position-attractsegment.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-27 16:25:27 UTC; mhall</td>
</tr>
<tr>
<td>Author:</td>
<td>Matthew Hall [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matthew Hall &lt;matthew.hall@bdi.ox.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-28 09:20:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='attract_by_distance'>Move points towards each other an absolute distance</h2><span id='topic+attract_by_distance'></span>

<h3>Description</h3>

<p>Move points towards each other an absolute distance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>attract_by_distance(x, xend, y, yend, length_start, length_end)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="attract_by_distance_+3A_x">x</code>, <code id="attract_by_distance_+3A_xend">xend</code>, <code id="attract_by_distance_+3A_y">y</code>, <code id="attract_by_distance_+3A_yend">yend</code></td>
<td>
<p>The coordinates of the start and end of the segment</p>
</td></tr>
<tr><td><code id="attract_by_distance_+3A_length_start">length_start</code>, <code id="attract_by_distance_+3A_length_end">length_end</code></td>
<td>
<p>How much to take off the start and end of the line (in the units of the data; beware this can make little sense unless both axes have the same units)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of new coordinates for the start and end of the line
</p>

<hr>
<h2 id='attract_proportionally'>Move points towards each other a proportion of the distance between them</h2><span id='topic+attract_proportionally'></span>

<h3>Description</h3>

<p>Move points towards each other a proportion of the distance between them
</p>


<h3>Usage</h3>

<pre><code class='language-R'>attract_proportionally(x, xend, y, yend, prop_start, prop_end)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="attract_proportionally_+3A_x">x</code>, <code id="attract_proportionally_+3A_xend">xend</code>, <code id="attract_proportionally_+3A_y">y</code>, <code id="attract_proportionally_+3A_yend">yend</code></td>
<td>
<p>The coordinates of the start and end of the segment</p>
</td></tr>
<tr><td><code id="attract_proportionally_+3A_prop_start">prop_start</code>, <code id="attract_proportionally_+3A_prop_end">prop_end</code></td>
<td>
<p>How much (proportionally) to take off the start and end of the line</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of new coordinates for the start and end of the line
</p>

<hr>
<h2 id='draw_key_arrowpath'>This function replaces <code><a href="ggplot2.html#topic+draw_key">ggplot2::draw_key_path</a></code> and displays all the requested arrowheads.</h2><span id='topic+draw_key_arrowpath'></span>

<h3>Description</h3>

<p>This function replaces <code><a href="ggplot2.html#topic+draw_key">ggplot2::draw_key_path</a></code> and displays all the requested arrowheads.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw_key_arrowpath(data, params, size)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw_key_arrowpath_+3A_data">data</code></td>
<td>
<p>A single row data frame containing the scaled aesthetics to
display in this key</p>
</td></tr>
<tr><td><code id="draw_key_arrowpath_+3A_params">params</code></td>
<td>
<p>A list of additional parameters supplied to the geom.</p>
</td></tr>
<tr><td><code id="draw_key_arrowpath_+3A_size">size</code></td>
<td>
<p>Width and height of key in mm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A grid grob.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 library(ggplot2)
 library(magrittr)
 library(tidyr)

 # Generate some dummy data

 ten.points &lt;- data.frame(line.no = rep(1:5, each = 2), x = runif(10), y = runif(10),
                          position = rep(c("start", "end"), 5))
 five.segments &lt;- ten.points %&gt;% pivot_wider(names_from = position, values_from = c(x,y))

 ggplot(five.segments) +
    geom_point(data = ten.points, aes(x = x, y = y)) +
    geom_segment(aes(x = x_start, xend = x_end, y = y_start, yend = y_end), arrow = arrow(),
                 key_glyph = draw_key_arrowpath)

</code></pre>

<hr>
<h2 id='geom_arrowsegment'>Line segments with flexible arrows</h2><span id='topic+geom_arrowsegment'></span>

<h3>Description</h3>

<p>The basic <code>geom_arrowsegment()</code> is equivalent to <code>geom_segment(arrow = arrow())</code>.
(It is assumed that the user wants some kind of arrow.) The extended functionality
is to allow free placement of the arrowhead anywhere along the segment, and also
multiple arrowheads, and to allow a fill aesthetic (which will only be visible for
closed arrowheads).
</p>
<p>The function works by dividing the line up into 1 or more segment grobs, each of
which is generated by <code><a href="grid.html#topic+arrow">grid::arrow()</a></code> except potentially the last (the one closest
to the point (<code>xend</code>, <code>yend</code>)). The vector <code>arrow_positions</code>, whose entries must
lie between 0 and 1, defines where each arrow segment ends, as a proportional
position along the line. If the last entry of <code>arrow_positions</code> is 1, then the last
grob has an arrow; otherwise it does not.
</p>
<p>The function is designed with the expectation that arrows point from (<code>x</code>, <code>y</code>) to
(<code>xend</code>, <code>yend</code>) but the <code>arrows</code> argument will happily accept <code>arrow(ends = "first")</code>
or <code>arrow(ends = "both")</code> if you prefer. Just remember that the final segment is
only an arrow at all if the last entry of <code>arrow_positions</code> is 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_arrowsegment(
  mapping = NULL,
  data = NULL,
  stat = "identity",
  position = "identity",
  ...,
  arrows = list(arrow()),
  arrow_fills = NULL,
  arrow_positions = 1,
  lineend = "butt",
  linejoin = "round",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geom_arrowsegment_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code><a href="ggplot2.html#topic+aes">aes()</a></code>. If specified and
<code>inherit.aes = TRUE</code> (the default), it is combined with the default mapping
at the top level of the plot. You must supply <code>mapping</code> if there is no plot
mapping.</p>
</td></tr>
<tr><td><code id="geom_arrowsegment_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three
options:
</p>
<p>If <code>NULL</code>, the default, the data is inherited from the plot
data as specified in the call to <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code>.
</p>
<p>A <code>data.frame</code>, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
<code><a href="ggplot2.html#topic+fortify">fortify()</a></code> for which variables will be created.
</p>
<p>A <code>function</code> will be called with a single argument,
the plot data. The return value must be a <code>data.frame</code>, and
will be used as the layer data. A <code>function</code> can be created
from a <code>formula</code> (e.g. <code>~ head(.x, 10)</code>).</p>
</td></tr>
<tr><td><code id="geom_arrowsegment_+3A_stat">stat</code></td>
<td>
<p>The statistical transformation to use on the data for this
layer, either as a <code>ggproto</code> <code>Geom</code> subclass or as a string naming the
stat stripped of the <code>stat_</code> prefix (e.g. <code>"count"</code> rather than
<code>"stat_count"</code>)</p>
</td></tr>
<tr><td><code id="geom_arrowsegment_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string naming the adjustment
(e.g. <code>"jitter"</code> to use <code>position_jitter</code>), or the result of a call to a
position adjustment function. Use the latter if you need to change the
settings of the adjustment.</p>
</td></tr>
<tr><td><code id="geom_arrowsegment_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer()</a></code>. These are
often aesthetics, used to set an aesthetic to a fixed value, like
<code>colour = "red"</code> or <code>size = 3</code>. They may also be parameters
to the paired geom/stat.</p>
</td></tr>
<tr><td><code id="geom_arrowsegment_+3A_arrows">arrows</code></td>
<td>
<p>Either an arrow generated by <code><a href="grid.html#topic+arrow">grid::arrow()</a></code> of a list of such arrows. In
the former case or if the list has length 1, the arrowhead so defined is used every
time; otherwise the list is expected to have the same length as
<code>arrow_positions</code> and each segment defined by that argument is ended by the respective
element of this one. The default is <code><a href="grid.html#topic+arrow">grid::arrow()</a></code> with default parameters.</p>
</td></tr>
<tr><td><code id="geom_arrowsegment_+3A_arrow_fills">arrow_fills</code></td>
<td>
<p>A vector of fill colours for the arrowheads, behaves as
the <code>arrow_fill</code> option in <code>geom_segment</code>. This will overrule a fill aesthetic in
the same way that specifying a single <code>fill</code> outside <code>aes</code> specification will.</p>
</td></tr>
<tr><td><code id="geom_arrowsegment_+3A_arrow_positions">arrow_positions</code></td>
<td>
<p>A vector of distinct points on the unit interval. 0 is not
permitted but arbitrarily small values are; 1 is permitted. The default behaviour is that
arrowheads will be placed proportionally along the line connecting (<code>x</code>, <code>y</code>)
to (<code>xend</code>,<code>yend</code>) at these points.
In more detail: The first arrow segment begins at (<code>x</code>, <code>y</code>) and ends a proportional
distance along the straight line joining (<code>x</code>, <code>y</code>) and (<code>xend</code>, <code>yend</code>) equal to the first
entry of this vector. The second bridges the first two entries, and so on. If the final
entry is 1 then the last segment is an arrow (and hence usually an arrowhead will be
placed at the end of the line). If it is not, then  the last segment is simply a line.
These will be sorted into order from 0 to 1 if they are not already.</p>
</td></tr>
<tr><td><code id="geom_arrowsegment_+3A_lineend">lineend</code></td>
<td>
<p>Line end style (round, butt, square).</p>
</td></tr>
<tr><td><code id="geom_arrowsegment_+3A_linejoin">linejoin</code></td>
<td>
<p>Line join style (round, mitre, bevel).</p>
</td></tr>
<tr><td><code id="geom_arrowsegment_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>FALSE</code>, the default, missing values are removed with
a warning. If <code>TRUE</code>, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="geom_arrowsegment_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p>
</td></tr>
<tr><td><code id="geom_arrowsegment_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggproto object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 library(ggplot2)
 library(magrittr)
 library(tidyr)

 # Generate some dummy data

 ten.points &lt;- data.frame(line.no = rep(1:5, each = 2), x = runif(10), y = runif(10),
                          position = rep(c("start", "end"), 5))
 five.segments &lt;- ten.points %&gt;% pivot_wider(names_from = position, values_from = c(x,y))

 # Default behaviour

 ggplot(five.segments) +
    geom_point(data = ten.points, aes(x = x, y = y)) +
    geom_arrowsegment(aes(x = x_start, xend = x_end, y = y_start, yend = y_end))

 # Midpoint arrowheads

 ggplot(five.segments) +
    geom_point(data = ten.points, aes(x = x, y = y)) +
    geom_arrowsegment(aes(x = x_start, xend = x_end, y = y_start, yend = y_end),
                      arrow_positions = 0.5)

 # Double arrows

 ggplot(five.segments) +
    geom_point(data = ten.points, aes(x = x, y = y)) +
    geom_arrowsegment(aes(x = x_start, xend = x_end, y = y_start, yend = y_end),
                      arrow_positions = c(0.25, 0.75))

 # Double arrows, last arrowhead at the end point

 ggplot(five.segments) +
    geom_point(data = ten.points, aes(x = x, y = y)) +
    geom_arrowsegment(aes(x = x_start, xend = x_end, y = y_start, yend = y_end),
                      arrow_positions = c(0.25, 1))

 # Double arrowheads of varying appearance and position

 ggplot(five.segments) +
     geom_point(data = ten.points, aes(x = x, y = y)) +
     geom_arrowsegment(aes(x = x_start, xend = x_end, y = y_start, yend = y_end),
                       arrow_positions = c(0.25, 0.75),
                       arrows = list(arrow(angle = 45, type = "closed"),
                                     arrow(angle = 25, ends = "both")),
                       arrow_fills = "indianred")

</code></pre>

<hr>
<h2 id='GeomArrowsegment'>Base ggproto classes for ggarchery</h2><span id='topic+GeomArrowsegment'></span><span id='topic+ggarchery-ggproto'></span><span id='topic+PositionAttractsegment'></span>

<h3>Description</h3>

<p>Base ggproto classes for ggarchery
</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+ggplot2-ggproto">ggplot2::ggplot2-ggproto</a></code>
</p>

<hr>
<h2 id='position_attractsegment'>Nudge points towards each other along a line</h2><span id='topic+position_attractsegment'></span>

<h3>Description</h3>

<p>This position function is primarily intended for use with <code><a href="ggplot2.html#topic+geom_segment">ggplot2::geom_segment()</a></code> or  <code><a href="#topic+geom_arrowsegment">geom_arrowsegment()</a></code>,
and solves the problem that the user may, for reasons of clarity or aesthetics, not want their arrows to actually
start or end at the position that they are &quot;pointing from&quot; or &quot;pointing to&quot;. It works by shifting the points towards
each other along the line joining them, by either a proportional amount or a fixed distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>position_attractsegment(
  start_shave = 0,
  end_shave = 0,
  type_shave = c("proportion", "distance")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="position_attractsegment_+3A_start_shave">start_shave</code>, <code id="position_attractsegment_+3A_end_shave">end_shave</code></td>
<td>
<p>The amount of distance to &quot;shave&quot; off the line between (<code>x</code>, <code>y</code>) and (<code>xend</code>, <code>yend</code>),
at, respectively, the start and the end. Can be zero; cannot be negative. Units are determined by <code>type_shave</code>.</p>
</td></tr>
<tr><td><code id="position_attractsegment_+3A_type_shave">type_shave</code></td>
<td>
<p>If <code>"proportion"</code> (the default) then this is a proportion of the total line length. If &quot;distance&quot;
then it is instead the raw distance along the line. The is only really recommended in combination with
<code><a href="ggplot2.html#topic+coord_fixed">ggplot2::coord_fixed()</a></code>; results can be quite odd otherwise.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggproto object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 library(ggplot2)
 library(magrittr)
 library(tidyr)

 # Generate some dummy data

 ten.points &lt;- data.frame(line.no = rep(1:5, each = 2), x = runif(10), y = runif(10),
                          position = rep(c("start", "end"), 5))
 five.segments &lt;- ten.points %&gt;% pivot_wider(names_from = position, values_from = c(x,y))

 # Ten percent off the start and end

 ggplot(five.segments) +
   geom_point(data = ten.points, aes(x = x, y = y)) +
   geom_arrowsegment(aes(x = x_start, xend = x_end, y = y_start, yend = y_end),
                     position = position_attractsegment(start_shave = 0.1, end_shave = 0.1))

 # Absolute distance of 0.02 at the end only

 ggplot(five.segments) +
   geom_point(data = ten.points, aes(x = x, y = y)) +
   geom_arrowsegment(aes(x = x_start, xend = x_end, y = y_start, yend = y_end),
                     position = position_attractsegment(end_shave = 0.02,
                                                        type_shave = "distance")) +
   coord_fixed()
</code></pre>

<hr>
<h2 id='split_arrows'>Find where to place arrows</h2><span id='topic+split_arrows'></span>

<h3>Description</h3>

<p>Find where to place arrows
</p>


<h3>Usage</h3>

<pre><code class='language-R'>split_arrows(x, xend, y, yend, splits)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="split_arrows_+3A_x">x</code>, <code id="split_arrows_+3A_xend">xend</code>, <code id="split_arrows_+3A_y">y</code>, <code id="split_arrows_+3A_yend">yend</code></td>
<td>
<p>The coordinates of the start and end of the segment</p>
</td></tr>
<tr><td><code id="split_arrows_+3A_splits">splits</code></td>
<td>
<p>A vector of points between 0 and 1 determining where on the line between start and end to split the
segment into sub-segments, which will each receive an arrowhead</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame describing the start and end coordinates of the sub-segments. The final segment, ending in 1, is not given (and not given an arrowhead) unless the final element of <code>splits</code> is 1.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
