<!DOCTYPE html><html><head><title>Help for package DNAmixturesLite</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DNAmixturesLite}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DNAmixturesLite-package'><p>Statistical Inference for Mixed Samples of DNA (Lite-Version)</p></a></li>
<li><a href='#boxplot.DNAmixture'><p>Plot simulated peak heights for multiple DNA mixtures.</p></a></li>
<li><a href='#buildMixtureDomains'><p>Create RHugin domains for computation.</p></a></li>
<li><a href='#DNAmixture'><p>Create a DNA mixture model</p></a></li>
<li><a href='#DNAmixtureData'><p>Create a data set for a DNA mixture model</p></a></li>
<li><a href='#dyes'><p>Dyes for a DNA mixture</p></a></li>
<li><a href='#getShapes'><p>Shape parameters for a mixture with known contributors only</p></a></li>
<li><a href='#logL'><p>Loglikelihood function for DNA mixture analysis.</p></a></li>
<li><a href='#map.genotypes'><p>Maximum posterior genotypes of unknown contributors</p></a></li>
<li><a href='#MC15'><p>The MC15 DNA mixture</p></a></li>
<li><a href='#MC18'><p>The MC18 DNA mixture</p></a></li>
<li><a href='#mixML'><p>Maximisation of the likelihood for one or more mixed traces of DNA</p></a></li>
<li><a href='#mixpar'><p>Parameters for DNA mixture models</p></a></li>
<li><a href='#NGM'><p>NGM allele frequencies</p></a></li>
<li><a href='#NGMDyes'><p>Dyes used for NGM</p></a></li>
<li><a href='#plot.DNAmixture'><p>Plot a DNA mixture model</p></a></li>
<li><a href='#predict.DNAmixture'><p>Various probabilities in a fitted DNA mixture model</p></a></li>
<li><a href='#prequential.score'><p>Calculate prequential scores</p></a></li>
<li><a href='#ProfilerDyes'><p>Dyes used for Profiler plus</p></a></li>
<li><a href='#qqpeak'><p>Quantile-Quantile plot for assessing the distribution of observed peak heights.</p></a></li>
<li><a href='#rPeakHeight'><p>Simulate peak heights from a DNA mixture model.</p></a></li>
<li><a href='#setCPT'><p>Set conditional probability tables for all auxiliary variables</p></a></li>
<li><a href='#setCPT.D'><p>Set tables for auxiliary variables <code>D</code></p></a></li>
<li><a href='#setCPT.O'><p>Set tables for auxiliary variables <code>O</code>.</p></a></li>
<li><a href='#setCPT.Q'><p>Set tables for auxiliary variables <code>Q</code></p></a></li>
<li><a href='#setPeakInfo'><p>Include or exclude peak information in the model</p></a></li>
<li><a href='#SGMplusDyes'><p>Dyes used for SGMplus</p></a></li>
<li><a href='#summary.map.genotypes'><p>Summary of best genotypes</p></a></li>
<li><a href='#UKCaucasian'><p>Allele frequencies for UK Caucasians</p></a></li>
<li><a href='#USCaucasian'><p>The data base of allele frequencies for 302 US Caucasian profiles.</p></a></li>
<li><a href='#varEst'><p>Estimated asymptotic variance matrix for MLE</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Inference for Mixed Traces of DNA (Lite-Version)</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-03-15</td>
</tr>
<tr>
<td>Description:</td>
<td>Statistical methods for DNA mixture analysis. This package is a lite-version of the 'DNAmixtures' package to allow users without a 'HUGIN' software license to experiment with the statistical methodology. While the lite-version aims to provide the full functionality it is noticeably less efficient than the original 'DNAmixtures' package. For details on implementation and methodology see <a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a>.</td>
</tr>
<tr>
<td>Depends:</td>
<td>gRaven</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, Rsolnp, numDeriv, Matrix, gRbase</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-15 18:49:55 UTC; theg</td>
</tr>
<tr>
<td>Author:</td>
<td>Therese Graversen [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Therese Graversen &lt;theg@itu.dk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-16 11:30:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='DNAmixturesLite-package'>Statistical Inference for Mixed Samples of DNA (Lite-Version)</h2><span id='topic+DNAmixturesLite-package'></span><span id='topic+DNAmixturesLite'></span><span id='topic+DNAmixtures'></span>

<h3>Description</h3>

<p>Tools for statistical inference for one or multiple DNA mixtures.
</p>
<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which is intended as a service to enable users to try <span class="pkg">DNAmixtures</span> without purchasing a commercial licence for Hugin. When at all possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span> rather than this lite-version. See <a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of <span class="pkg">DNAmixtures</span>, note that computations are much less efficient and that there are some differences in available functionality. Be aware that the present documentation is copied from <span class="pkg">DNAmixtures</span> and thus may not accurately describe the implementation of this lite-version.</em>
</p>


<h3>Details</h3>

<p>The package implements a statistical model for analysis
of one or more mixed samples of DNA in the possible presence of
dropout and stutter. Details of the model can be found in Cowell
et. al (2013), and details on the model checking tools and
Bayesian network structure can be found in Graversen and Lauritzen
(2014).
</p>
<p>Any hypothesis involving unknown contributors relies on
computations in a Bayesian network. For performing such
computations, <span class="pkg">DNAmixtures</span> package relies on Hugin
(<a href="https://www.hugin.com">https://www.hugin.com</a>) through the <span class="rlang"><b>R</b></span>-package <span class="pkg">RHugin</span>. For an
installation guide, see the package webpage
<a href="https://dnamixtures.r-forge.r-project.org">https://dnamixtures.r-forge.r-project.org</a>.
</p>
<p>Although <span class="pkg">DNAmixtures</span> can be installed with only the free
version of Hugin, the size of the networks will in practice
require the full licence. In theory, the implementation allows
analysis with an arbitrary number of unknown
contributors. However, in practice, depending on hardware and
time-constraints working with up to 5 or 6 unknown contributors
seems realistic.
</p>


<h3>Summary of the statistical model</h3>

<p>The statistical model jointly models the observed peak heights and
the set of contributors to the DNA sample(s). In the event of
analysing multiple DNA mixtures, the union of the contributors is
used as the contributor set for each mixture. By allowing a
contribution of zero, we cover the case of a contributor not
having contributed to a particular mixture.
</p>
<p>Genotypes for unknown contributors are modelled using
allele-frequencies from a database specified by the user. The
database is also used to define the range of alleles at each
marker. A genotype for an unknown contributor is represented by a
vector of allele counts <code class="reqn">n_{ia}</code>, counting for each allele
<code class="reqn">a</code> the number of alleles <code class="reqn">i</code> that a person possesses; in
the network for a marker, the allele count <code class="reqn">n_{ia}</code> is
represented by a variable <code>n_i_a</code>. The vector of allele
counts follows a multinomial distribution with <code class="reqn">\sum_i n_{ia}
= 2</code> and the specified allele frequencies. It is assumed that
genotypes are independent across markers and between
contributors. If desired, the database of allele frequencies may
be corrected for F_st or sampling adjustment before use.
</p>
<p>Peak heights are assumed mutually independent and their
distributions for a fixed set of DNA profiles are modelled using
gamma distributions.  The peak height for allele <code class="reqn">a</code> in EPG <code class="reqn">r</code>
is assumed to follow a gamma distribution with scale parameter
<code class="reqn">\eta_r</code> and shape parameter
</p>
<p style="text-align: center;"><code class="reqn">\rho_r \sum_a ((1-\xi_{ra})n_{ia} + \xi_{r,a+1} n_{i,a+1})\phi_{ri}.</code>
</p>

<p>Applying a detection threshold <code class="reqn">C_r\ge 0</code>, any peak height
falling below the threshold is considered to be 0.  The peak
heights are denoted by <code>height1, ..., heightR</code>.
</p>
<p>The model parameters are for each DNA mixture
</p>

<dl>
<dt><code class="reqn">\phi</code></dt><dd><p>The proportions of DNA from each contributor.</p>
</dd>
<dt><code class="reqn">\rho</code></dt><dd><p>Amplification parameter, which will be larger for larger amounts of DNA amplified.</p>
</dd>
<dt><code class="reqn">\eta</code></dt><dd><p>Scale parameter for the gamma distribution.</p>
</dd>
<dt><code class="reqn">\xi</code></dt><dd><p>Mean stutter percentage. Allele <code class="reqn">a</code> uses stutter parameter <code class="reqn">\xi_a = \xi</code> if the allele <code class="reqn">a-1</code> is included in the model, and <code class="reqn">\xi_a = 0</code> otherwise</p>
</dd>
</dl>

<p>An alternative parametrisation uses <code class="reqn">\mu = \rho \eta</code> and
<code class="reqn">\sigma = 1/\sqrt{\rho}</code>, which can be interpreted as the mean
peak height and the coefficient of variation respectively. Besides
being interpretable, an advantage of this reparametrisation is
that the parameters are fairly orthogonal.
</p>
<p>The model assumes the model parameters to be the same across
markers.  Relaxations of these assumptions are not implemented
here.
</p>


<h3>Computation by auxiliary variables</h3>

<p>The computational approach of the implementation of this package
is discussed in Graversen and Lauritzen (2014).
</p>
<p>The Bayesian networks include three types of auxiliary variables
<code>O</code>, <code>D</code>, and <code>Q</code>; these can be thought of as
representing the observed peak heights, the absence/presence of
peaks, and the peak height distribution function. Note that if
invalid tables are set &ndash; for instance if very extreme parameter
values are used, or if the vector of mixture proportions is
mis-labeled &ndash; then any subsequent propagation will fail. No
roll-back functionality has so far been implemented to fix this,
and the easiest solution is to re-fit the mixture model.
</p>
<p>The workhorses of this package are the functions
<code><a href="#topic+setCPT.O">setCPT.O</a></code>, <code><a href="#topic+setCPT.D">setCPT.D</a></code> and
<code><a href="#topic+setCPT.Q">setCPT.Q</a></code> for setting the conditional probability
tables for the three types of auxiliary variables according to
specified peak heights and model parameters.
</p>


<h3>Amelogenin</h3>

<p>As an experiment, it is possible to add the
marker Amelogenin, provided that the marker is named &quot;AMEL&quot; and
that the coding of alleles X and Y is of a particular form. One
example of a suitable form is the coding X = 0 and Y = 1. The
allele frequencies used should then also contain a marker &quot;AMEL&quot;,
and here frequencies have a slightly different interpretation than
for the rest of the markers; as all people possess one X, the
frequencies of X and Y denote the presence of an additional X or Y
respectively, and thus the frequencies correspond directly to the
proportions of the two genders.
</p>


<h3>Author(s)</h3>

<p>Therese Graversen <a href="mailto:theg@itu.dk">theg@itu.dk</a>
</p>


<h3>References</h3>

<p>Details on the implemented model may be found in
</p>
<p>Cowell, R. G., Graversen, T., Lauritzen, S., and Mortera, J. (2015).
<em>Analysis of Forensic DNA Mixtures with Artefacts</em>. With supplementary material documenting the analyses using <span class="pkg">DNAmixtures</span>.
Journal of the Royal Statistical Society: Series C (Applied Statistics).
Volume 64, Issue 1, pages 1-48.
</p>
<p>Graversen, T. (2014)
<em>Statistical and Computational Methodology for the Analysis of Forensic DNA Mixtures with Artefacts</em>.
DPhil. University of Oxford.
<a href="https://ora.ox.ac.uk/objects/uuid:4c3bfc88-25e7-4c5b-968f-10a35f5b82b0">https://ora.ox.ac.uk/objects/uuid:4c3bfc88-25e7-4c5b-968f-10a35f5b82b0</a>.
</p>
<p>Graversen, T. and Lauritzen, S. (2014).
<em>Computational aspects of DNA mixture analysis</em>.
Statistics and Computing, DOI: 10.1007/s11222-014-9451-7.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Analysing trace MC18, using USCaucasian allele-frequencies.
data(MC18, USCaucasian, SGMplusDyes)
## The prosecution hypothesis could be that K1, K2, and K3 have
## contributed to the trace. Setting detection threshold to 50rfu.
## For layout as an EPG we follow the layout of SGMplus.
mixHp &lt;- DNAmixture(list(MC18), k = 3, K = c("K1", "K2", "K3"), C = list(50),
                  database = USCaucasian, dyes = list(SGMplusDyes))
plot(mixHp, epg = TRUE)
## The yellow is a bit difficult to see; we can
## change the colors representing the dyes
plot(mixHp, epg = TRUE, dyecol = list(c("blue", "green", "black")))

## Fit by maximum likelihood using p as the initial value for optimisation
p &lt;- mixpar(rho = list(30), eta = list(34), xi = list(0.08),
            phi = list(c(K1 = 0.71, K3 = 0.1, K2 = 0.19)))
mlHp &lt;- mixML(mixHp, pars = p)
mlHp$mle

## Find the estimated covariance matrix of the MLE
V.Hp &lt;- varEst(mixHp, mlHp$mle, npars = list(rho=1,eta=1,xi=1,phi=1))
V.Hp$cov ## using (rho, eta)
## The summary is a table containing the MLE and their standard errors
summary(V.Hp)

## Assess the fit of the distribution of peak heights
qqpeak(mixHp, pars = mlHp$mle, dist = "conditional")

## Assess the prediction of allele presence
pr &lt;- prequential.score(mixHp, pars = mlHp$mle)
plot(pr)

## Compare observed peak heights to peak heights simulated under the model
sims &lt;- rPeakHeight(mixHp, mlHp$mle, nsim = 100, dist = "conditional")
oldpar &lt;- par(mfrow = c(2,5), mar = c(2,2,2,0))
boxplot(mixHp, sims)
par(oldpar)


data(MC18, USCaucasian, SGMplusDyes)

## A defence hypothesis could be that one unknown person has
## contributed along with K1 and K3.
mixHd &lt;- DNAmixture(list(MC18), k = 3, K = c("K1", "K3"), C = list(50),
                  database = USCaucasian, dyes = list(SGMplusDyes))

## Fit by ML
mlHd &lt;- mixML(mixHd, pars = mixpar(rho = list(30), eta = list(34), xi = list(0.08),
                       phi = list(c(K1 = 0.71, K3 = 0.1, U1 = 0.19))))
mlHd$mle

## Find the estimated covariance matrix of the MLE
V &lt;- varEst(mixHd, mlHd$mle, npars = list(rho=1,eta=1,xi=1,phi=1))
summary(V)

## Assess the peak height distribution
qq &lt;- qqpeak(mixHd, pars = mlHd$mle, dist = "conditional")

## Assess the prediction of allele presence
pr &lt;- prequential.score(mixHd, pars = mlHd$mle)
plot(pr, col = pr$trace)

## Compare observed peak heights to peak heights simulated under the model
sims &lt;- rPeakHeight(mixHd, mlHd$mle, nsim = 100, dist = "conditional")
par(mfrow = c(2,5), mar = c(2,2,2,0))
boxplot(mixHd, sims)


## The log10 of likelihood-ratio can be found as
(mlHp$lik - mlHd$lik)/log(10)


## We can find the most probable genotypes for U1 under the hypothesis
## Hd : K1, K2, and U1.

## Include the peak heights
setPeakInfo(mixHd, mlHd$mle)
## Jointly best for all unknown contributors
mp &lt;- map.genotypes(mixHd, pmin = 0.01, type = "seen")
## See the genotypes rather than allelecounts
print(summary(mp), marker = "D2S1338")

## Include only information on presence and absence of alleles
setPeakInfo(mixHd, mlHd$mle, presence.only = TRUE)
## Jointly best for all unknown contributors
mp2 &lt;- map.genotypes(mixHd, pmin = 0.01, type = "seen")
## See the genotypes rather than allelecounts
print(summary(mp2), marker = "D2S1338")

</code></pre>

<hr>
<h2 id='boxplot.DNAmixture'>Plot simulated peak heights for multiple DNA mixtures.</h2><span id='topic+boxplot.DNAmixture'></span>

<h3>Description</h3>

<p>A plot will be made for each combination of samples and markers
specified, and it is up to the user to specify a layout for the
plots (e.g. via calls to <code><a href="graphics.html#topic+par">par</a></code>)
</p>
<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which
is intended as a service to enable users to try <span class="pkg">DNAmixtures</span>
without purchasing a commercial licence for Hugin. When at all
possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span>
rather than this lite-version. See
<a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on
both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of
<span class="pkg">DNAmixtures</span>, note that computations are much less efficient
and that there are some differences in available functionality. Be
aware that the present documentation is copied from
<span class="pkg">DNAmixtures</span> and thus may not accurately describe the
implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'DNAmixture'
boxplot(
  x,
  sims,
  traces = 1:x$ntraces,
  markers = x$markers,
  pw = 0.4,
  ylim = NULL,
  border = "grey",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxplot.DNAmixture_+3A_x">x</code></td>
<td>
<p>A <code>DNAmixture</code>.</p>
</td></tr>
<tr><td><code id="boxplot.DNAmixture_+3A_sims">sims</code></td>
<td>
<p>A set of simulated peak heights. See also <code><a href="#topic+rPeakHeight">rPeakHeight</a></code>.</p>
</td></tr>
<tr><td><code id="boxplot.DNAmixture_+3A_traces">traces</code></td>
<td>
<p>Selected traces to plot.</p>
</td></tr>
<tr><td><code id="boxplot.DNAmixture_+3A_markers">markers</code></td>
<td>
<p>Selected markers to plot.</p>
</td></tr>
<tr><td><code id="boxplot.DNAmixture_+3A_pw">pw</code></td>
<td>
<p>Peaks are <code>2*pw</code> wide.</p>
</td></tr>
<tr><td><code id="boxplot.DNAmixture_+3A_ylim">ylim</code></td>
<td>
<p>Range of the y-axis.</p>
</td></tr>
<tr><td><code id="boxplot.DNAmixture_+3A_border">border</code></td>
<td>
<p>Color of the boxes.</p>
</td></tr>
<tr><td><code id="boxplot.DNAmixture_+3A_...">...</code></td>
<td>
<p>Arguments passed on to <code>plot.DNAmixture</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly the peak heights as used for the boxplots.
</p>


<h3>Author(s)</h3>

<p>Therese Graversen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(MC15, MC18, USCaucasian)
mix &lt;- DNAmixture(list(MC15, MC18), C = list(50, 38), k = 3, K = c("K1", "K3"),
                  database = USCaucasian)
p &lt;- mixpar(rho = list(30, 30), eta = list(30, 30), xi = c(0.08,0.08),
            phi = list(c(U1 = 0.1, K3 = 0.2, K1 = 0.7), c(K1 = 0.9, K3 = 0.05, U1 = 0.05)))
rpm &lt;- rPeakHeight(mix, p, nsim = 1000, dist = "joint")
oldpar &lt;- par("mfrow")
par(mfrow = c(1,2))
boxplot(mix, rpm, traces = 1:2, markers = "VWA")
par(mfrow = oldpar)


data(MC15, MC18, USCaucasian)
mix &lt;- DNAmixture(list(MC15, MC18), C = list(50, 38), k = 3, K = "K3", database = USCaucasian)
p &lt;- mixpar(rho = list(30, 30), eta = list(30, 30), xi = c(0.08,0.08),
            phi = list(c(U2 = 0.1, K3 = 0.2, U1 = 0.7), c(U1 = 0.9, K3 = 0.05, U2 = 0.05)))
rpm &lt;- rPeakHeight(mix, p, nsim = 50, dist = "joint")
rpc &lt;- rPeakHeight(mix, p, nsim = 50, dist = "conditional")
oldpar &lt;- par("mfrow")
par(mfrow = c(2,2))
boxplot(mix, rpm, traces = 1:2, markers = "VWA") ## First row of plots
boxplot(mix, rpc, traces = 1:2, markers = "VWA") ## Second row of plots
par(mfrow = oldpar)
mixK &lt;- DNAmixture(list(MC15, MC18), C = list(50, 38), k = 3, K = c("K1", "K2", "K3"),
                    database = USCaucasian)
pK &lt;- mixpar(rho = list(30, 30), eta = list(30, 30), xi = list(0.08,0.08),
             phi = list(c(K2 = 0.1, K3 = 0.2, K1 = 0.7), c(K2 = 0.1, K3 = 0.2, K1 = 0.7)))
rpmK &lt;- rPeakHeight(mixK, pK, nsim = 1000, markers = "D2S1338")
oldpar &lt;- par(mfrow = c(1,2))
boxplot(mixK, rpmK, markers = "D2S1338")
par(oldpar)

</code></pre>

<hr>
<h2 id='buildMixtureDomains'>Create RHugin domains for computation.</h2><span id='topic+buildMixtureDomains'></span>

<h3>Description</h3>

<p>The function is intended for internal use in
<code><a href="#topic+DNAmixture">DNAmixture</a></code>, and it creates one network per
marker.
</p>
<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which
is intended as a service to enable users to try <span class="pkg">DNAmixtures</span>
without purchasing a commercial licence for Hugin. When at all
possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span>
rather than this lite-version. See
<a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on
both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of
<span class="pkg">DNAmixtures</span>, note that computations are much less efficient
and that there are some differences in available functionality. Be
aware that the present documentation is copied from
<span class="pkg">DNAmixtures</span> and thus may not accurately describe the
implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>buildMixtureDomains(
  n.unknown,
  data,
  domainnamelist,
  write,
  dir = NULL,
  ntraces = 1,
  triangulate = TRUE,
  compile = TRUE,
  compress = TRUE,
  use.order = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="buildMixtureDomains_+3A_n.unknown">n.unknown</code></td>
<td>
<p>Number of unknown contributors</p>
</td></tr>
<tr><td><code id="buildMixtureDomains_+3A_data">data</code></td>
<td>
<p>A list of <code>data.frame</code>s on the form returned by
<code><a href="#topic+DNAmixtureData">DNAmixtureData</a></code>.</p>
</td></tr>
<tr><td><code id="buildMixtureDomains_+3A_domainnamelist">domainnamelist</code></td>
<td>
<p>List of names for networkfiles.</p>
</td></tr>
<tr><td><code id="buildMixtureDomains_+3A_write">write</code></td>
<td>
<p>[not available in lite-version] Save networkfiles? Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="buildMixtureDomains_+3A_dir">dir</code></td>
<td>
<p>Path to the networkfiles.</p>
</td></tr>
<tr><td><code id="buildMixtureDomains_+3A_ntraces">ntraces</code></td>
<td>
<p>Number of traces (EPG's)</p>
</td></tr>
<tr><td><code id="buildMixtureDomains_+3A_triangulate">triangulate</code></td>
<td>
<p>Triangulate the networks? Default is to
triangulate the network using a good elimination order.</p>
</td></tr>
<tr><td><code id="buildMixtureDomains_+3A_compile">compile</code></td>
<td>
<p>Compile the networks? Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="buildMixtureDomains_+3A_compress">compress</code></td>
<td>
<p>Compress the network? Defaults to <code>TRUE</code> and
is strongly recommended for models with a large number of
contributors.</p>
</td></tr>
<tr><td><code id="buildMixtureDomains_+3A_use.order">use.order</code></td>
<td>
<p>Should the default elimination order be used for
triangulation?  Otherwise the &quot;total.weight&quot; heuristic for
triangulation in HUGIN is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For one marker, the network contains variables
</p>

<dl>
<dt><code>n_i_a</code></dt><dd><p>The number of alleles <code class="reqn">a</code> that unknown contributor <code>Ui</code> possesses.</p>
</dd>
<dt><code>S_i_a</code></dt><dd><p>Cumulative allele counts, summarising how many alleles amongst types 1, ..., <code class="reqn">a</code> that contributor <code class="reqn">i</code> possesses.</p>
</dd>
<dt><code>O_r_a</code></dt><dd><p>Binary variable representing observed peak height for allele <code class="reqn">a</code> in EPG <code class="reqn">r</code>. See <code><a href="#topic+setCPT.O">setCPT.O</a></code> for details.</p>
</dd>
<dt><code>D_r_a</code></dt><dd><p>Binary variable representing the event of a peak for allele <code class="reqn">a</code> falling below threshold in EPG <code class="reqn">r</code>.</p>
</dd>
<dt><code>Q_r_a</code></dt><dd><p>Binary variable representing the event of a peak for allele <code class="reqn">a</code> being smaller than the peak observed in EPG <code class="reqn">r</code>.</p>
</dd>
</dl>

<p>The network is by default triangulated, compiled,
compressed, and, optionally, saved as a hkb-file. If the networks
are large &ndash; if there are many unknown contributors &ndash; it is worth
considering saving the networks rather than re-building them every time
<code>DNAmixture</code> is called.
</p>


<h3>Value</h3>

<p>A list containing a list of pointers for RHugin
domains. Additionally a list of the total size of the compressed
junction tree in percent of the uncompressed size.
</p>


<h3>Note</h3>

<p>If amelogenin is included as a marker, use
integer codes for the alleles with X preceding Y, e.g. X=0, Y=1.
</p>


<h3>Author(s)</h3>

<p>Therese Graversen
</p>

<hr>
<h2 id='DNAmixture'>Create a DNA mixture model</h2><span id='topic+DNAmixture'></span><span id='topic+print.DNAmixture'></span>

<h3>Description</h3>

<p>A model object for analysis of one or more DNA mixtures. For a
brief overview of the package functionality, see
in particular <code><a href="#topic+DNAmixtures">DNAmixtures</a></code>.
</p>
<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which
is intended as a service to enable users to try <span class="pkg">DNAmixtures</span>
without purchasing a commercial licence for Hugin. When at all
possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span>
rather than this lite-version. See
<a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on
both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of
<span class="pkg">DNAmixtures</span>, note that computations are much less efficient
and that there are some differences in available functionality. Be
aware that the present documentation is copied from
<span class="pkg">DNAmixtures</span> and thus may not accurately describe the
implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DNAmixture(
  data,
  k,
  C,
  database,
  K = character(0),
  reference.profiles = NULL,
  dir = character(0),
  domainnamelist = NULL,
  load = FALSE,
  write = FALSE,
  dyes = NULL,
  triangulate = TRUE,
  compile = TRUE,
  compress = TRUE,
  use.order = TRUE
)

## S3 method for class 'DNAmixture'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DNAmixture_+3A_data">data</code></td>
<td>
<p>A list containing one <code>data.frame</code> for each DNA
mixture. Note, that in the special case of analysing just one
mixture, this still has to be specified as list(data). Each
dataset should contain variables <code>marker</code>, <code>allele</code>, and
<code>frequency</code>. Optionally, also a column for each reference
profile specified in <code>K</code>.</p>
</td></tr>
<tr><td><code id="DNAmixture_+3A_k">k</code></td>
<td>
<p>Number of contributors.</p>
</td></tr>
<tr><td><code id="DNAmixture_+3A_c">C</code></td>
<td>
<p>A list of thresholds, one for each mixture.</p>
</td></tr>
<tr><td><code id="DNAmixture_+3A_database">database</code></td>
<td>
<p>A data.frame containing at least variables <code>marker</code>, <code>allele</code>, <code>frequency</code>.</p>
</td></tr>
<tr><td><code id="DNAmixture_+3A_k">K</code></td>
<td>
<p>Names of reference profiles; these can be chosen freely,
but should match (possibly only a subset of) the names specified
by the reference profiles.</p>
</td></tr>
<tr><td><code id="DNAmixture_+3A_reference.profiles">reference.profiles</code></td>
<td>
<p>A data.frame containing allele counts for each reference profile, if not specified in <code>data</code>.</p>
</td></tr>
<tr><td><code id="DNAmixture_+3A_dir">dir</code></td>
<td>
<p>Location of network files if loading or saving the networks.</p>
</td></tr>
<tr><td><code id="DNAmixture_+3A_domainnamelist">domainnamelist</code></td>
<td>
<p>Names of marker-wise network files (without hkb-extension). Default is the set of markers.</p>
</td></tr>
<tr><td><code id="DNAmixture_+3A_load">load</code></td>
<td>
<p>Read networks from disk?</p>
</td></tr>
<tr><td><code id="DNAmixture_+3A_write">write</code></td>
<td>
<p>Save networks as hkb files?</p>
</td></tr>
<tr><td><code id="DNAmixture_+3A_dyes">dyes</code></td>
<td>
<p>A list containing a list of dyes indexed by markers</p>
</td></tr>
<tr><td><code id="DNAmixture_+3A_triangulate">triangulate</code></td>
<td>
<p>Triangulate the networks? Default is to
triangulate the network using a good elimination order.</p>
</td></tr>
<tr><td><code id="DNAmixture_+3A_compile">compile</code></td>
<td>
<p>Compile the networks?</p>
</td></tr>
<tr><td><code id="DNAmixture_+3A_compress">compress</code></td>
<td>
<p>Compress the network? Defaults to <code>TRUE</code> and is
strongly recommended for models with a large number of
contributors.</p>
</td></tr>
<tr><td><code id="DNAmixture_+3A_use.order">use.order</code></td>
<td>
<p>Should the default elimination order be used for triangulation?
Otherwise the &quot;total.weight&quot; heuristic for triangulation in Hugin is used.</p>
</td></tr>
<tr><td><code id="DNAmixture_+3A_x">x</code></td>
<td>
<p>An object of class <code>DNAmixture</code>.</p>
</td></tr>
<tr><td><code id="DNAmixture_+3A_...">...</code></td>
<td>
<p>not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The names for known contributors can be chosen freely, whereas
unknown contributors are always termed <code>U1,U2, ...</code>.
</p>
<p>We allow for stutter to an allele one repeat number shorter. The
range of alleles at a marker is defined by the union of alleles
specified though the peak heights, the reference profiles, and the
allele frequencies. Any alleles that are included, but not found
in the database, will be assigned frequency <code>NA</code>, and it is then up
to the user to decide on further actions. If a particular mixture
has no observations at a marker, the heights are set to <code>NA</code>, but if
the mixture has some peaks at that marker, then missing heights
are all set to 0. Note that we hereby cover the possibility that
mixtures are analysed with different kits, and so are observed at
different markers. We do not (readily) allow kits to have
different ranges of possible alleles at one marker.
</p>
<p>If amelogenin is included in the analysis, the marker should be
named <code>"AMEL"</code> and an integer coding such as X=0, Y=1, where X is
assigned a lower number than Y, should be used. Note that in terms
of amelogenin, the allele frequencies have a slighly different
interpretation to that for other markers, in that they denote the
probability of having an <em>additional</em> X or Y to the X that
all people have. Thus, a natural choice will be <code class="reqn">p(X)=p(Y)=0.5</code>,
denoting equal probability of a male or female contributor.
</p>


<h3>Value</h3>

<p>An object of class <code>DNAmixture</code>. This contains amongst other things
</p>
<table>
<tr><td><code>markers</code></td>
<td>
<p>The joint set of markers used for the mixtures specified.</p>
</td></tr>
<tr><td><code>domains</code></td>
<td>
<p>For models involving unknown contributors,
a list containing one Bayesian network (<code>hugin.domain</code>) per marker;
see <code><a href="#topic+buildMixtureDomains">buildMixtureDomains</a></code> for details on the networks</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>A list containing for each marker the combined allele frequencies,
peak heights, and reference profiles as produced by <code><a href="#topic+DNAmixtureData">DNAmixtureData</a></code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(MC15, MC18, USCaucasian)
DNAmixture(list(MC15, MC18), C = list(50,50), k = 3, K = c("K1", "K2"),
           database = USCaucasian)
DNAmixture(list(MC15, MC18), C = list(50,50), k = 3, K = c("K3", "K1", "K2"),
           database = USCaucasian)
</code></pre>

<hr>
<h2 id='DNAmixtureData'>Create a data set for a DNA mixture model</h2><span id='topic+DNAmixtureData'></span>

<h3>Description</h3>

<p>The function is intended for internal use in
<code><a href="#topic+DNAmixture">DNAmixture</a></code> and its purpose is to combine peak height
data, any reference profiles, and allele frequencies.
</p>
<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which
is intended as a service to enable users to try <span class="pkg">DNAmixtures</span>
without purchasing a commercial licence for Hugin. When at all
possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span>
rather than this lite-version. See
<a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on
both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of
<span class="pkg">DNAmixtures</span>, note that computations are much less efficient
and that there are some differences in available functionality. Be
aware that the present documentation is copied from
<span class="pkg">DNAmixtures</span> and thus may not accurately describe the
implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DNAmixtureData(data, database, K = character(0), reference.profiles = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DNAmixtureData_+3A_data">data</code></td>
<td>
<p>Either one <code>data.frame</code> containing variables
<code>markers</code> and <code>allele</code>, <code>height</code>, or a list of one
or more of such <code>data.frame</code>s, corresponding to each EPG. If
a <code>data.frame</code> with reference profiles are not specified
separately, these should be found amongst the datasets.</p>
</td></tr>
<tr><td><code id="DNAmixtureData_+3A_database">database</code></td>
<td>
<p>A <code>data.frame</code> with variables <code>marker</code>,
<code>allele</code>, and allele <code>frequency</code>.</p>
</td></tr>
<tr><td><code id="DNAmixtureData_+3A_k">K</code></td>
<td>
<p>Names for reference profiles.</p>
</td></tr>
<tr><td><code id="DNAmixtureData_+3A_reference.profiles">reference.profiles</code></td>
<td>
<p>Optionally, a <code>data.frame</code> containing allele counts for
each reference profile specified in <code>K</code>. There should be one variable for each name
in <code>K</code> as well as variables <code>marker</code> and <code>allele</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of <code>data.frame</code>'s indexed by markers and
containing variables
</p>
<table>
<tr><td><code>marker</code></td>
<td>
<p>The STR marker</p>
</td></tr>
<tr><td><code>allele</code></td>
<td>
<p>Repeat number of the allele</p>
</td></tr>
<tr><td><code>frequency</code></td>
<td>
<p>Allele frequency</p>
</td></tr>
<tr><td><code>height1</code>, <code>...</code>, <code>heightN</code></td>
<td>
<p>Peak heights for each of the N mixtures analysed;
their order follows the order in which the mixtures are specified in <code>data</code>.</p>
</td></tr>
<tr><td><code>stutter.from</code></td>
<td>
<p>For internal use. Where do the alleles get stutter from?
A value of <code>-1</code> means that the allele cannot receive stutter, corresponding to <code>gets_stutter</code> being false.
<code>allele[i]</code> receives stutter from <code>allele[stutter.from[i]]</code></p>
</td></tr>
<tr><td><code>stutter.to</code></td>
<td>
<p>As above. <code>allele[i]</code> can stutter to <code>allele[stutter.to[i]]</code></p>
</td></tr>
</table>
<p>as well as known DNA profiles as labelled by <code>K</code>.
</p>


<h3>Author(s)</h3>

<p>Therese Graversen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a dataset for two markers with each 3 observed alleles
epgdf &lt;- data.frame(marker = rep(c("FGA", "TH01"), each = 3),
                    allele = c(18, 23, 27, 7, 8, 9.3), ## Observed alleles
                    height = c(100, 100, 200, 200, 100, 100), ## Peak heights
                    Anna = c(0,0,2,1,0,1),             ## Anna's profile
                    Peter = c(1,1,0,1,1,0))            ## Peter's profile

data(USCaucasian)
dat &lt;- DNAmixtureData(epgdf, K = c("Anna", "Peter"), database = USCaucasian)
</code></pre>

<hr>
<h2 id='dyes'>Dyes for a DNA mixture</h2><span id='topic+dyes'></span><span id='topic+dyes+3C-'></span>

<h3>Description</h3>

<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span>
package, which is intended as a service to enable users to try
<span class="pkg">DNAmixtures</span> without purchasing a commercial licence for
Hugin. When at all possible, we strongly recommend the use of
<span class="pkg">DNAmixtures</span> rather than this lite-version. See
<a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details
on both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of
<span class="pkg">DNAmixtures</span>, note that computations are much less efficient
and that there are some differences in available functionality. Be
aware that the present documentation is copied from
<span class="pkg">DNAmixtures</span> and thus may not accurately describe the
implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dyes(mixture)

dyes(mixture) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dyes_+3A_mixture">mixture</code></td>
<td>
<p>A DNA mixture</p>
</td></tr>
<tr><td><code id="dyes_+3A_value">value</code></td>
<td>
<p>A list with one item per dye, each containing a vector of marker names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The dyes used for the DNA mixture
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DNAmixture">DNAmixture</a></code>
</p>

<hr>
<h2 id='getShapes'>Shape parameters for a mixture with known contributors only</h2><span id='topic+getShapes'></span>

<h3>Description</h3>

<p>The function is mainly for internal use. It calculates the shape
parameters, or contribution to the shape parameter, that
correspond to the known contributors in the mixture.
</p>
<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which is intended as a service to enable users to try <span class="pkg">DNAmixtures</span> without purchasing a commercial licence for Hugin. When at all possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span> rather than this lite-version. See <a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of <span class="pkg">DNAmixtures</span>, note that computations are much less efficient and that there are some differences in available functionality. Be aware that the present documentation is copied from <span class="pkg">DNAmixtures</span> and thus may not accurately describe the implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getShapes(mixture, pars, allelecounts = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getShapes_+3A_mixture">mixture</code></td>
<td>
<p>A <code>DNAmixture</code>.</p>
</td></tr>
<tr><td><code id="getShapes_+3A_pars">pars</code></td>
<td>
<p>Model parameters.</p>
</td></tr>
<tr><td><code id="getShapes_+3A_allelecounts">allelecounts</code></td>
<td>
<p>This argument is possibly redundant.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For each marker a matrix of shape-parameters.
</p>


<h3>Author(s)</h3>

<p>Therese Graversen
</p>


<h3>See Also</h3>

<p>predict
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MC15, MC18, USCaucasian)
mix &lt;- DNAmixture(list(MC15, MC18), C = list(50,50), k = 3, K = c("K1", "K3", "K2"),
database = USCaucasian)
p &lt;- mixpar(rho = list(30, 30), eta = list(30, 30), xi = list(0.08,0.08),
            phi = list(c(K2 = 0.1, K3 = 0.2, K1 = 0.7), c(K2 = 0.1, K3 = 0.2, K1 = 0.7)))
sh &lt;- getShapes(mix, p)
sh$VWA
</code></pre>

<hr>
<h2 id='logL'>Loglikelihood function for DNA mixture analysis.</h2><span id='topic+logL'></span><span id='topic+logL.UK'></span><span id='topic+logL.K'></span><span id='topic+logLpres.UK'></span><span id='topic+logLpres.K'></span>

<h3>Description</h3>

<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which
is intended as a service to enable users to try <span class="pkg">DNAmixtures</span>
without purchasing a commercial licence for Hugin. When at all
possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span>
rather than this lite-version. See
<a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on
both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of
<span class="pkg">DNAmixtures</span>, note that computations are much less efficient
and that there are some differences in available functionality. Be
aware that the present documentation is copied from
<span class="pkg">DNAmixtures</span> and thus may not accurately describe the
implementation of this lite-version.</em>
</p>
<p>The function <code>logL</code> is used to produce a log likelihood
function for one or more traces of DNA. <code>logL</code> calls one of
four other likelihood functions according to whether peak heights
or only peak presence/absence is used as observations, and also
whether there are any unknown contributors in the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logL(mixture, presence.only = FALSE, initialize = TRUE)

logL.UK(mixture, initialize = TRUE)

logL.K(mixture)

logLpres.UK(mixture, initialize = TRUE)

logLpres.K(mixture)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logL_+3A_mixture">mixture</code></td>
<td>
<p>A <code><a href="#topic+DNAmixture">DNAmixture</a></code> model.</p>
</td></tr>
<tr><td><code id="logL_+3A_presence.only">presence.only</code></td>
<td>
<p>Set to TRUE to ignore peak heights and
evaluate the likelihood function considering peak presence and
absence (heights above and below threshold) only. Defaults to
FALSE.</p>
</td></tr>
<tr><td><code id="logL_+3A_initialize">initialize</code></td>
<td>
<p>By default all entered
evidence is removed from the networks in <code>object</code>. Setting
<code>initialize = FALSE</code> should be done with care, and it is up
to the user to ensure that the likelihood being computed is meaningful.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A function, which takes a <code><a href="#topic+mixpar">mixpar</a></code> model parameter as argument.
</p>


<h3>Note</h3>

<p>In the presence of unknown contributors, the returned
likelihood function relies on the Bayesian networks in the
<code>DNAmixture</code> object. If any evidence is entered or propagated
in these networks after creating the likelihood function, the
function will no longer compute the correct likelihood. In
particular, be ware of calling other functions in between calls to
the likelihood function, as they may change the state of the
networks.
</p>


<h3>Author(s)</h3>

<p>Therese Graversen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MC18, USCaucasian)
mixHp &lt;- DNAmixture(list(MC18), k = 3, K = c("K1", "K2", "K3"), C = list(50),
                    database = USCaucasian)
p &lt;- mixpar(rho = list(30), eta = list(34), xi = list(0.08),
            phi = list(c(K1 = 0.71, K3 = 0.1, K2 = 0.19)))
l &lt;- logL(mixHp)
l(p)
</code></pre>

<hr>
<h2 id='map.genotypes'>Maximum posterior genotypes of unknown contributors</h2><span id='topic+map.genotypes'></span>

<h3>Description</h3>

<p>For each marker, a ranked list of configurations of genotypes for some
or all unknown contributors is returned. The list contains all
configurations with posterior probability higher than some
specified <code>pmin</code>.
</p>
<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which
is intended as a service to enable users to try <span class="pkg">DNAmixtures</span>
without purchasing a commercial licence for Hugin. When at all
possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span>
rather than this lite-version. See
<a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on
both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of
<span class="pkg">DNAmixtures</span>, note that computations are much less efficient
and that there are some differences in available functionality. Be
aware that the present documentation is copied from
<span class="pkg">DNAmixtures</span> and thus may not accurately describe the
implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map.genotypes(
  mixture,
  pmin,
  U = seq_along(mixture$U),
  markers = mixture$markers,
  type = c("seen", "all", "unseen")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map.genotypes_+3A_mixture">mixture</code></td>
<td>
<p>a DNA mixture</p>
</td></tr>
<tr><td><code id="map.genotypes_+3A_pmin">pmin</code></td>
<td>
<p>A list of the minimum probability to consider for each marker.</p>
</td></tr>
<tr><td><code id="map.genotypes_+3A_u">U</code></td>
<td>
<p>Optionally the indices of the unknown contributors of interest, specified as an integer vector.</p>
</td></tr>
<tr><td><code id="map.genotypes_+3A_markers">markers</code></td>
<td>
<p>Optionally, a subset of markers.</p>
</td></tr>
<tr><td><code id="map.genotypes_+3A_type">type</code></td>
<td>
<p>It may be of interest to consider only the prediction of alleles in some subset of alleles. We allow
</p>

<dl>
<dt><code>"seen"</code></dt><dd><p>Consider only alleles that are seen in at least one EPG</p>
</dd>
<dt><code>"all"</code></dt><dd><p>Consider the entire allelic range</p>
</dd>
<dt><code>"unseen"</code></dt><dd><p>Consider only alleles that are not seen in any EPG (possibly redundant)</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that an error occurs if there are no configurations
with probability higher than <code>pmin</code>. In this case, try a
smaller <code>pmin</code>.
</p>
<p>The function makes use of
<code><a href="gRaven.html#topic+map.configurations">map.configurations</a></code>, which localises the
configurations of highest high posterior probability by simulating
from the Bayesian networks until enough (at least mass
1-<code>pmin</code>) of the state space has been explored &ndash; the
computation time is thus dependent on how flat the posterior is,
and how small <code>pmin</code> is. The simulation is used only to locate
the relevant configurations; the computed probabilities are exact.
</p>


<h3>Value</h3>

<p>A list, which for each marker contains the maximum
posterior configurations of allele counts (genotypes) above the specified probabilities <code>pmin</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.map.genotypes">summary.map.genotypes</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MC18, USCaucasian, SGMplusDyes)
mix &lt;- DNAmixture(list(MC18), k = 3, K = "K1", C = list(50), database = USCaucasian)
p &lt;- mixpar(rho = list(30), eta = list(30), xi = list(0.07),
            phi = list(c(K1 = 0.7, U1 =0.2, U2 = 0.1)))
## Inlude the peak height information
setPeakInfo(mix, p)
## Marginally best genotypes for contributor U1
mpU1 &lt;- map.genotypes(mix, pmin = 0.01, U = 1, type = "seen", markers = "D16S539")
summary(mpU1)

## Jointly best genotypes for all unknown contributors
mp &lt;- map.genotypes(mix, pmin = 0.01, type = "seen")
summary(mp) ## Profiles as genotypes rather than allelecounts

</code></pre>

<hr>
<h2 id='MC15'>The MC15 DNA mixture</h2><span id='topic+MC15'></span>

<h3>Description</h3>

<p>Peak heights from analysis of a bloodstain with DNA
from an unknown number of contributors. There are three reference
profiles <code>K1</code>, <code>K2</code>, and <code>K3</code> for individuals
related to the case.
</p>


<h3>Format</h3>

<p>A <code>data.frame</code>.
</p>


<h3>Source</h3>

<p>Peter Gill et. al. (2008)
<em>Interpretation of complex DNA profiles using empirical models and a method to measure their robustness</em>.
Forensic Science International: Genetics, 2(2):91&ndash;103.
</p>

<hr>
<h2 id='MC18'>The MC18 DNA mixture</h2><span id='topic+MC18'></span>

<h3>Description</h3>

<p>Peak heights from analysis of a bloodstain with DNA
from an unknown number of contributors. There are three reference
profiles <code>K1</code>, <code>K2</code>, and <code>K3</code> for individuals
related to the case.
</p>


<h3>Format</h3>

<p>A <code>data.frame</code>.
</p>


<h3>Source</h3>

<p>Peter Gill et. al. (2008)
<em>Interpretation of complex DNA profiles using empirical models and a method to measure their robustness</em>.
Forensic Science International: Genetics, 2(2):91&ndash;103.
</p>

<hr>
<h2 id='mixML'>Maximisation of the likelihood for one or more mixed traces of DNA</h2><span id='topic+mixML'></span>

<h3>Description</h3>

<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which
is intended as a service to enable users to try <span class="pkg">DNAmixtures</span>
without purchasing a commercial licence for Hugin. When at all
possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span>
rather than this lite-version. See
<a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on
both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of
<span class="pkg">DNAmixtures</span>, note that computations are much less efficient
and that there are some differences in available functionality. Be
aware that the present documentation is copied from
<span class="pkg">DNAmixtures</span> and thus may not accurately describe the
implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixML(
  mixture,
  pars,
  constraints = NULL,
  phi.eq = FALSE,
  val = NULL,
  trace = FALSE,
  order.unknowns = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mixML_+3A_mixture">mixture</code></td>
<td>
<p>A <code><a href="#topic+DNAmixture">DNAmixture</a></code> object.</p>
</td></tr>
<tr><td><code id="mixML_+3A_pars">pars</code></td>
<td>
<p>A <code><a href="#topic+mixpar">mixpar</a></code> parameter used as a starting value for the optimisation.</p>
</td></tr>
<tr><td><code id="mixML_+3A_constraints">constraints</code></td>
<td>
<p>Equality constraint function as function of an array of parameters.</p>
</td></tr>
<tr><td><code id="mixML_+3A_phi.eq">phi.eq</code></td>
<td>
<p>Should the mixture proportions be the same for all
traces? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="mixML_+3A_val">val</code></td>
<td>
<p>Vector of values to be satisfied for the equality constraints.</p>
</td></tr>
<tr><td><code id="mixML_+3A_trace">trace</code></td>
<td>
<p>Print the evaluations of the likelihood-function during optimisation?</p>
</td></tr>
<tr><td><code id="mixML_+3A_order.unknowns">order.unknowns</code></td>
<td>
<p>Should unknown contributors be ordered
according to decreasing contributions? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="mixML_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed on to <code><a href="Rsolnp.html#topic+solnp">solnp</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The pre-specified constraints for the model parameter <code>pars</code> are for each mixture <code>r</code>
</p>

<ul>
<li> <p><code>0 &lt;= pars[[r, "rho"]] &lt; Inf</code>
</p>
</li>
<li> <p><code>0 &lt;= pars[[r, "eta"]] &lt; Inf</code>
</p>
</li>
<li> <p><code>0 &lt;= pars[[r, "xi"]] &lt;= 1</code>
</p>
</li>
<li> <p><code>0 &lt;= pars[[r, "phi"]][i] &lt;= 1</code>
</p>
</li>
<li> <p><code>sum(pars[[r, "phi"]]) == 1</code>.
</p>
</li>
<li><p> If there are 2 or more unknown contributors, then the mixture
proportions for the unknown contributors are ordered decreasingly
with the first DNA mixture determining the order.
</p>
</li></ul>

<p>Further constraints can be specified by the user; for this see examples below.
</p>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr><td><code>mle</code></td>
<td>
<p>The (suggested) MLE.</p>
</td></tr>
<tr><td><code>lik</code></td>
<td>
<p>The log of the likelihood (log e).</p>
</td></tr>
</table>
<p>as well as the output from the optimisation.
</p>


<h3>Author(s)</h3>

<p>Therese Graversen
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DNAmixture">DNAmixture</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(MC15, USCaucasian)
mix &lt;- DNAmixture(list(MC15), C = list(50), k = 3, K = c("K1", "K2", "K3"), database = USCaucasian)
startpar &lt;- mixpar(rho = list(24), eta = list(37), xi = list(0.08),
                   phi = list(c(K3 = 0.15, K1 = 0.8, K2 = 0.05)))
ml &lt;- mixML(mix, startpar)
ml$mle


data(MC15, USCaucasian)
mix &lt;- DNAmixture(list(MC15), C = list(50), k = 3, K = "K1", database = USCaucasian)
startpar &lt;- mixpar(rho = list(24), eta = list(37), xi = list(0.08),
phi = list(c(U1 = 0.05, K1 = 0.8, U2 = 0.15)))
ml &lt;- mixML(mix, startpar)
ml$mle



## The following advanced example has a model with two DNA samples
## and various parameter restrictions.
## Be aware that the computation is rather demanding and takes
## a long time to run with this lite-version of DNAmixtures.
## With DNAmixtures (based on HUGIN), it takes only about one minute.
data(MC15, MC18, USCaucasian)
mix &lt;- DNAmixture(list(MC15, MC18), C = list(50, 38), k = 3, K = "K1", database = USCaucasian)
startpar &lt;- mixpar(rho = list(24, 25), eta = list(37, 40), xi = list(0.08, 0.1),
                   phi = list(c(U1 = 0.05, K1 = 0.7, U2 = 0.25),
                                c(K1 = 0.7, U2 = 0.1, U1 = 0.2)))
eqxis &lt;- function(x){ diff(unlist(x[,"xi"])) }
## Note that for these two traces, we do not expect phi to be equal.
## Here we set stutter equal for all traces
ml.diff &lt;- mixML(mix, startpar, eqxis, val = 0, phi.eq = FALSE)
## Equal mixture proportions across traces
ml.eqphi &lt;- mixML(mix, startpar, eqxis, val = 0, phi.eq = TRUE)
## Likelihood ratio test for equal mixture proportions
pchisq(-2*(ml.eqphi$lik - ml.diff$lik), df = 1, lower.tail = FALSE)

</code></pre>

<hr>
<h2 id='mixpar'>Parameters for DNA mixture models</h2><span id='topic+mixpar'></span><span id='topic+print.mixpar'></span>

<h3>Description</h3>

<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which
is intended as a service to enable users to try <span class="pkg">DNAmixtures</span>
without purchasing a commercial licence for Hugin. When at all
possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span>
rather than this lite-version. See
<a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on
both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of
<span class="pkg">DNAmixtures</span>, note that computations are much less efficient
and that there are some differences in available functionality. Be
aware that the present documentation is copied from
<span class="pkg">DNAmixtures</span> and thus may not accurately describe the
implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixpar(rho = NULL, eta = NULL, xi = NULL, phi = NULL, parlist = NULL)

## S3 method for class 'mixpar'
print(x, digits = max(3L, getOption("digits") - 3L), scientific = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mixpar_+3A_rho">rho</code></td>
<td>
<p>Amplification factor.</p>
</td></tr>
<tr><td><code id="mixpar_+3A_eta">eta</code></td>
<td>
<p>Scale parameter in the gamma distribution.</p>
</td></tr>
<tr><td><code id="mixpar_+3A_xi">xi</code></td>
<td>
<p>Stutter parameter.</p>
</td></tr>
<tr><td><code id="mixpar_+3A_phi">phi</code></td>
<td>
<p>Named vector of the fraction of DNA contributed by each contributor.</p>
</td></tr>
<tr><td><code id="mixpar_+3A_parlist">parlist</code></td>
<td>
<p>A list of parameters of class <code>mixpar</code></p>
</td></tr>
<tr><td><code id="mixpar_+3A_x">x</code></td>
<td>
<p>An object of class <code>mixpar</code>.</p>
</td></tr>
<tr><td><code id="mixpar_+3A_digits">digits</code></td>
<td>
<p>The number of digits to print</p>
</td></tr>
<tr><td><code id="mixpar_+3A_scientific">scientific</code></td>
<td>
<p>Should scientific notation be used?</p>
</td></tr>
<tr><td><code id="mixpar_+3A_...">...</code></td>
<td>
<p>arguments passed to print</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The mixture parameter is a two-way array of lists;
columns correspond to the four model parameters <code>rho</code>,
<code>eta</code>, <code>xi</code>, and <code>phi</code>, and rows correspond to the
mixtures included in the model.
</p>
<p>The print method is currently somewhat specialised, in that it
assumes that <code>rho</code>, <code>eta</code>, and <code>xi</code> are merely real
numbers. <code>phi</code> is assumed to consist of a named vector per
mixture; the names, or order of names, can differ between mixtures.
</p>


<h3>Value</h3>

<p>An object of class &quot;mixpar&quot;.
</p>


<h3>Author(s)</h3>

<p>Therese Graversen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## A parameter for two mixtures
q &lt;- mixpar(rho = list(30, 30), eta = list(30, 30), xi = list(0.08, 0.08),
            phi = list(c(Anna = 0.5, Peter = 0.2, U1 = 0.3),
                       c(U1 = 0.5, Anna = 0.2, Peter = 0.3)))
## Equivalent to specifying the parameter for each mixture and then combining.
p1 &lt;- mixpar(rho = list(30), eta = list(30), xi = list(0.08),
             phi = list(c(Anna = 0.5, Peter = 0.2, U1 = 0.3)))
p2 &lt;- mixpar(rho = list(30), eta = list(30), xi = list(0.08),
             phi = list(c(U1 = 0.5, Anna = 0.2, Peter = 0.3)))
p &lt;- mixpar(parlist = list(p1, p2))
</code></pre>

<hr>
<h2 id='NGM'>NGM allele frequencies</h2><span id='topic+NGM'></span>

<h3>Description</h3>

<p>NGM allele frequencies.
</p>


<h3>Format</h3>

<p>A list containing 
</p>

<dl>
<dt><code>USCaucasian</code></dt><dd><p>A <code>data.frame</code> with, for each marker,
the set of possible alleles as well as their corresponding frequency.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Budowle et. al (2011) <em>Population Genetic Analyses of the NGM STR loci</em>.
International Journal of Legal Medicine, 125(1):101-109.
</p>

<hr>
<h2 id='NGMDyes'>Dyes used for NGM</h2><span id='topic+NGMDyes'></span>

<h3>Description</h3>

<p>Dyes used for the AmpFlSTR NGM PCR Amplification Kit
</p>


<h3>Format</h3>

<p>A list with one item per dye, each containing a vector of
marker-names specifying the order in which they occur in an EPG.
</p>


<h3>Source</h3>

<p>Applied Biosystems
</p>

<hr>
<h2 id='plot.DNAmixture'>Plot a DNA mixture model</h2><span id='topic+plot.DNAmixture'></span>

<h3>Description</h3>

<p>Plot of peak heights against repeat numbers for each marker.
</p>
<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which
is intended as a service to enable users to try <span class="pkg">DNAmixtures</span>
without purchasing a commercial licence for Hugin. When at all
possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span>
rather than this lite-version. See
<a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on
both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of
<span class="pkg">DNAmixtures</span>, note that computations are much less efficient
and that there are some differences in available functionality. Be
aware that the present documentation is copied from
<span class="pkg">DNAmixtures</span> and thus may not accurately describe the
implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'DNAmixture'
plot(
  x,
  traces = seq_len(x$ntraces),
  markers = x$markers,
  epg = FALSE,
  dyecol = lapply(dyes(x), names),
  pw = 0.4,
  threshold = TRUE,
  panel = NULL,
  add = FALSE,
  ask = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.DNAmixture_+3A_x">x</code></td>
<td>
<p>A <code>DNAmixture</code>.</p>
</td></tr>
<tr><td><code id="plot.DNAmixture_+3A_traces">traces</code></td>
<td>
<p>Indices giving the mixtures, for which plots should be made.</p>
</td></tr>
<tr><td><code id="plot.DNAmixture_+3A_markers">markers</code></td>
<td>
<p>Vector of names giving the markers, for which plots should be made.</p>
</td></tr>
<tr><td><code id="plot.DNAmixture_+3A_epg">epg</code></td>
<td>
<p>Should a stylized EPG be produced? This requires a list
of dyes to be specified for the mixtures, possibly through
<code><a href="#topic+dyes">dyes</a></code>.</p>
</td></tr>
<tr><td><code id="plot.DNAmixture_+3A_dyecol">dyecol</code></td>
<td>
<p>List containing for each mixture a vector of dye
names. The default is to use the names in <code>dyes(x)</code>. Set to
<code>NULL</code> to ignore.</p>
</td></tr>
<tr><td><code id="plot.DNAmixture_+3A_pw">pw</code></td>
<td>
<p>Peaks are <code>2*pw</code> wide.</p>
</td></tr>
<tr><td><code id="plot.DNAmixture_+3A_threshold">threshold</code></td>
<td>
<p>Should the detection thresholds be indicated on the plot?</p>
</td></tr>
<tr><td><code id="plot.DNAmixture_+3A_panel">panel</code></td>
<td>
<p>Alternative function for drawing the peaks. For
instance <code>lines</code> can be used for making triangular peaks. This functionality will be removed.</p>
</td></tr>
<tr><td><code id="plot.DNAmixture_+3A_add">add</code></td>
<td>
<p>Add to existing plot? (not meaningful if <code>EPG = TRUE</code>.)</p>
</td></tr>
<tr><td><code id="plot.DNAmixture_+3A_ask">ask</code></td>
<td>
<p>Should the user be prompted for page changes? The
default is <code>TRUE</code>, when the device is
<code>dev.interactive()</code> and there is a need for multiple pages.</p>
</td></tr>
<tr><td><code id="plot.DNAmixture_+3A_...">...</code></td>
<td>
<p>Other parameters to be passed on to <code>plot</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the plotted data points.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MC15, MC18, USCaucasian, SGMplusDyes)
mix &lt;- DNAmixture(list(MC15, MC18), C = list(50,50), k = 3, K = c("K1", "K3"),
                  database = USCaucasian)
## Plot as a stylized EPG, using "orange" for the "yellow" dye
names(SGMplusDyes) &lt;- c("blue", "green", "orange")
dyes(mix) &lt;- list(SGMplusDyes, SGMplusDyes)
plot(mix, epg = TRUE)
## We can also supress the dye colors
plot(mix, traces = 1, epg = TRUE, dyecol = NULL)
## Create a user specified layout
op &lt;- par(mfrow = c(2,3))
plot(mix, markers = c("VWA", "D19S433", "TH01"), col = "red")
par(mfrow = op)
plot(mix, traces = 1, markers = "D19S433", col = "orange",
     main = "A single marker", cex.main = 2, ylim = c(0,200))
</code></pre>

<hr>
<h2 id='predict.DNAmixture'>Various probabilities in a fitted DNA mixture model</h2><span id='topic+predict.DNAmixture'></span>

<h3>Description</h3>

<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which is intended as a service to enable users to try <span class="pkg">DNAmixtures</span> without purchasing a commercial licence for Hugin. When at all possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span> rather than this lite-version. See <a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of <span class="pkg">DNAmixtures</span>, note that computations are much less efficient and that there are some differences in available functionality. Be aware that the present documentation is copied from <span class="pkg">DNAmixtures</span> and thus may not accurately describe the implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'DNAmixture'
predict(
  object,
  pars,
  dist = c("joint", "conditional", "prequential"),
  markers = object$markers,
  by.allele = TRUE,
  initialize = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.DNAmixture_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+DNAmixture">DNAmixture</a></code> object</p>
</td></tr>
<tr><td><code id="predict.DNAmixture_+3A_pars">pars</code></td>
<td>
<p>Array of model parameters</p>
</td></tr>
<tr><td><code id="predict.DNAmixture_+3A_dist">dist</code></td>
<td>
<p>One of &quot;joint&quot;, &quot;conditional&quot;, and &quot;prequential&quot;. If
there are only known contributors, these are all the same since, under the model, peak
heights are condtionally independent given profiles of the
contributors.</p>
</td></tr>
<tr><td><code id="predict.DNAmixture_+3A_markers">markers</code></td>
<td>
<p>The set of markers of interest</p>
</td></tr>
<tr><td><code id="predict.DNAmixture_+3A_by.allele">by.allele</code></td>
<td>
<p>If <code>dist = "prequential"</code> then the order in
which we condition on mixtures and alleles matters. <code>by.allele
= TRUE</code> will proceed through alleles in increasing repeat number,
and for each allele condition on one mixture at the time. If <code>FALSE</code>,
the conditioning is done by mixtures and then alleles within these.</p>
</td></tr>
<tr><td><code id="predict.DNAmixture_+3A_initialize">initialize</code></td>
<td>
<p>By default <code>predict</code> removes all entered
evidence from the networks in <code>object</code>. Setting
<code>initialize = FALSE</code> should be done with care, and it is up
to the user to ensure that the returned probabilities are meaningful.</p>
</td></tr>
<tr><td><code id="predict.DNAmixture_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a mixture with unknown contributors, the
probabilities are computed with respect to one of three
distributions. Let <code>height</code> be the matrix of peak heights
with columns <code>height1, ..., heightR</code>. For a peak at allele <code>a</code> in the mixture <code>r</code>, the three choices of distributions are
</p>

<dl>
<dt><code>"joint"</code></dt><dd><p>Default. No conditioning on observed peak heights.</p>
</dd>
<dt><code>"conditional"</code></dt><dd><p>Conditional on <code>height[-a, -r]</code>, i.e. on heights for all peaks, except the one under consideration.</p>
</dd>
<dt><code>"prequential"</code></dt><dd><p>Conditional on <code>height[1:(a-1), 1:(r-1)]</code>, i.e. on heights for all peaks &quot;before&quot; the peak under consideration (see argument <code>by.allele</code> for details).</p>
</dd>
</dl>

<p>If all contributors are known, the three distributions are the same
due to independence of the peak heights.
</p>


<h3>Value</h3>

<p>A list with one data.frame per marker containing various probabilities for
diagnostics
</p>
<table>
<tr><td><code>unseen</code></td>
<td>
<p>The probability of not seeing a peak, i.e. no peak or a peak falling below the threshold</p>
</td></tr>
<tr><td><code>seen</code></td>
<td>
<p>The probability of seeing the allele</p>
</td></tr>
<tr><td><code>smaller</code></td>
<td>
<p>The probability of seeing a smaller peak than the
one observed</p>
</td></tr>
<tr><td><code>larger</code></td>
<td>
<p>The probability of seeing a larger
peak than the one observed</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Therese Graversen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MC15, MC18, USCaucasian)
mix &lt;- DNAmixture(list(MC15, MC18), C = list(50,50), k = 3, K = c("K1", "K3", "K2"),
database = USCaucasian)
p &lt;- mixpar(rho = list(30, 30), eta = list(30, 30), xi = list(0.08,0.08),
            phi = list(c(K2 = 0.1, K3 = 0.2, K1 = 0.7), c(K2 = 0.1, K3 = 0.2, K1 = 0.7)))
pred &lt;- predict(mix, p)
pred$VWA
</code></pre>

<hr>
<h2 id='prequential.score'>Calculate prequential scores</h2><span id='topic+prequential.score'></span><span id='topic+plot.prequential.score'></span>

<h3>Description</h3>

<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which is intended as a service to enable users to try <span class="pkg">DNAmixtures</span> without purchasing a commercial licence for Hugin. When at all possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span> rather than this lite-version. See <a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of <span class="pkg">DNAmixtures</span>, note that computations are much less efficient and that there are some differences in available functionality. Be aware that the present documentation is copied from <span class="pkg">DNAmixtures</span> and thus may not accurately describe the implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prequential.score(mixture, pars, markers = mixture$markers, by.allele = TRUE)

## S3 method for class 'prequential.score'
plot(x, normalise = FALSE, ylab = NULL, ylim = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prequential.score_+3A_mixture">mixture</code></td>
<td>
<p>A <code>DNAmixture</code> model object.</p>
</td></tr>
<tr><td><code id="prequential.score_+3A_pars">pars</code></td>
<td>
<p>A <code>mixpar</code> model parameter.</p>
</td></tr>
<tr><td><code id="prequential.score_+3A_markers">markers</code></td>
<td>
<p>An ordering of the markers, possibly a subset of the markers only.</p>
</td></tr>
<tr><td><code id="prequential.score_+3A_by.allele">by.allele</code></td>
<td>
<p>Should conditioning be done allele-wise (<code>TRUE</code>) or EPG-wise (<code>FALSE</code>).
Defaults to <code>TRUE</code>. For details, see <code><a href="stats.html#topic+predict">predict</a></code>.</p>
</td></tr>
<tr><td><code id="prequential.score_+3A_x">x</code></td>
<td>
<p>A data.frame containing at least variables <code>marker</code> and <code>score</code>.</p>
</td></tr>
<tr><td><code id="prequential.score_+3A_normalise">normalise</code></td>
<td>
<p>Should the prequential score be normalised? Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="prequential.score_+3A_ylab">ylab</code></td>
<td>
<p>Label for the y-axis.</p>
</td></tr>
<tr><td><code id="prequential.score_+3A_ylim">ylim</code></td>
<td>
<p>Range for the y-axis.</p>
</td></tr>
<tr><td><code id="prequential.score_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed on to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame, which contains the output from
<code><a href="stats.html#topic+predict">predict</a></code> as well as columns <code>Y</code>, <code>EY</code>, <code>VY</code>, corresponding
to the log-score and its mean and variance. Finally the variable
<code>score</code> is added, which is the normalised cumulative log-score.
</p>


<h3>Author(s)</h3>

<p>Therese Graversen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MC15, MC18, USCaucasian)
mix &lt;- DNAmixture(list(MC15, MC18), C = list(50,50), k = 3, K = c("K1", "K3"),
                  database = USCaucasian)
p &lt;- mixpar(rho = list(30, 30), eta = list(30, 30), xi = list(0.08,0.08),
            phi = list(c(U1 = 0.1, K3 = 0.2, K1 = 0.7), c(U1 = 0.1, K3 = 0.2, K1 = 0.7)))
preq &lt;- prequential.score(mix, pars = p)
plot(preq, col = preq$trace)
## Annotate using repeat numbers
text(preq$score, labels = preq$allele, pos = c(1,3), col = preq$trace, cex = 0.6)
</code></pre>

<hr>
<h2 id='ProfilerDyes'>Dyes used for Profiler plus</h2><span id='topic+ProfilerDyes'></span>

<h3>Description</h3>

<p>Dyes used for the AmpFlSTR Profiler Plus PCR Amplification Kit
</p>


<h3>Format</h3>

<p>A list with one item per dye, each containing a vector of
marker-names specifying the order in which they occur in an EPG.
</p>


<h3>Source</h3>

<p>Applied Biosystems
</p>

<hr>
<h2 id='qqpeak'>Quantile-Quantile plot for assessing the distribution of observed peak heights.</h2><span id='topic+qqpeak'></span>

<h3>Description</h3>

<p>Given <code class="reqn">Z_a \ge C</code>, the peak height <code class="reqn">Z_a</code> follows a
continuous distribution. The probability transform <code class="reqn">P(Z_a \le z_a|
Z_a \ge C)</code> thus follows a uniform distribution. The function
<code>qqpeak</code> computes the quantiles of the probability transform
and produces a quantile-quantile plot. Information about the other
peak heights in the EPG may be taken into account in the
distribution of a peak.
</p>
<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which
is intended as a service to enable users to try <span class="pkg">DNAmixtures</span>
without purchasing a commercial licence for Hugin. When at all
possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span>
rather than this lite-version. See
<a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on
both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of
<span class="pkg">DNAmixtures</span>, note that computations are much less efficient
and that there are some differences in available functionality. Be
aware that the present documentation is copied from
<span class="pkg">DNAmixtures</span> and thus may not accurately describe the
implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qqpeak(
  x,
  pars,
  dist = c("joint", "conditional", "prequential"),
  by.allele = TRUE,
  plot = TRUE,
  xlab = "Uniform quantiles",
  ylab = NULL,
  xlim = NULL,
  ylim = xlim,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qqpeak_+3A_x">x</code></td>
<td>
<p>A <code>DNAmixture</code> model.</p>
</td></tr>
<tr><td><code id="qqpeak_+3A_pars">pars</code></td>
<td>
<p>A <code>mixpar</code> parameter.</p>
</td></tr>
<tr><td><code id="qqpeak_+3A_dist">dist</code></td>
<td>
<p><code>"joint"</code>, <code>"conditional"</code>, or <code>"prequential"</code>. See <code><a href="#topic+predict.DNAmixture">predict.DNAmixture</a></code> for details.</p>
</td></tr>
<tr><td><code id="qqpeak_+3A_by.allele">by.allele</code></td>
<td>
<p>Order of conditioning when <code>dist="prequential"</code>. See <code><a href="#topic+predict.DNAmixture">predict.DNAmixture</a></code></p>
</td></tr>
<tr><td><code id="qqpeak_+3A_plot">plot</code></td>
<td>
<p>Should a plot be produced? Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="qqpeak_+3A_xlab">xlab</code></td>
<td>
<p>Legend for the x-axis.</p>
</td></tr>
<tr><td><code id="qqpeak_+3A_ylab">ylab</code></td>
<td>
<p>Legend for y-axis.</p>
</td></tr>
<tr><td><code id="qqpeak_+3A_xlim">xlim</code></td>
<td>
<p>Range of x-axis. Default is a plot with equal ranges
on the x- and y-axis.</p>
</td></tr>
<tr><td><code id="qqpeak_+3A_ylim">ylim</code></td>
<td>
<p>Range of y-axis.</p>
</td></tr>
<tr><td><code id="qqpeak_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed on to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> containg quantiles <code>q</code>
corresponding to <code class="reqn">P(Z &lt; z_{obs} | Z &gt; 0)</code> in the specified
distribution, together with other quantities computed by
<code><a href="#topic+predict.DNAmixture">predict.DNAmixture</a></code>. The data are ordered according
to <code>q</code>.
</p>


<h3>Author(s)</h3>

<p>Therese Graversen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MC15, MC18, USCaucasian)
mix &lt;- DNAmixture(list(MC15, MC18), C = list(50, 38), k = 3, K = c("K1", "K3"),
                  database = USCaucasian)
p &lt;- mixpar(rho = list(30, 30), eta = list(30, 30), xi = list(0.08,0.08),
            phi = list(c(U1 = 0.1, K3 = 0.2, K1 = 0.7)))
qqpeak(mix, pars = p, dist = "conditional")

## If desired, we can make a customised plot -- here we color according to the two mixtures
qq &lt;- qqpeak(mix, pars = p, dist = "conditional", plot = FALSE)
plot(ppoints(qq$q), qq$q, xlab = "Uniform quantiles", ylab = "Probability transform",
     col = qq$trace, pch = qq$trace)

</code></pre>

<hr>
<h2 id='rPeakHeight'>Simulate peak heights from a DNA mixture model.</h2><span id='topic+rPeakHeight'></span>

<h3>Description</h3>

<p>A set of peak heights is sampled for each mixture in the
model. Note that if the mixtures cover different sets of markers,
so will the simulated peak heights. If there are unknown
contributors, their genotypes are sampled from the networks in
<code>mixture$domains</code>, but these genotypes are not stored.
</p>
<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which is intended as a service to enable users to try <span class="pkg">DNAmixtures</span> without purchasing a commercial licence for Hugin. When at all possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span> rather than this lite-version. See <a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of <span class="pkg">DNAmixtures</span>, note that computations are much less efficient and that there are some differences in available functionality. Be aware that the present documentation is copied from <span class="pkg">DNAmixtures</span> and thus may not accurately describe the implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rPeakHeight(
  mixture,
  pars,
  nsim = 1,
  markers = mixture$markers,
  dist = c("joint", "conditional"),
  use.threshold = TRUE,
  initialize = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rPeakHeight_+3A_mixture">mixture</code></td>
<td>
<p>A <code>DNAmixture</code>.</p>
</td></tr>
<tr><td><code id="rPeakHeight_+3A_pars">pars</code></td>
<td>
<p>A <code>mixpar</code> model parameter.</p>
</td></tr>
<tr><td><code id="rPeakHeight_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulations for each allele.</p>
</td></tr>
<tr><td><code id="rPeakHeight_+3A_markers">markers</code></td>
<td>
<p>Subset of markers to simulate</p>
</td></tr>
<tr><td><code id="rPeakHeight_+3A_dist">dist</code></td>
<td>
<p>How should observed peak heights be taken into account?
Possible choices are
</p>

<dl>
<dt><code>"joint"</code></dt><dd><p> which does not take peak heights into account.</p>
</dd>
<dt><code>"conditional"</code></dt><dd><p> which takes all peak heights into account, except that for the peak under consideration.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="rPeakHeight_+3A_use.threshold">use.threshold</code></td>
<td>
<p>Should peak heights under the detection
threshold C be set to 0? Defaults to <code>TRUE</code>, corresponding to simulating under the model fitted.</p>
</td></tr>
<tr><td><code id="rPeakHeight_+3A_initialize">initialize</code></td>
<td>
<p>Should all propagated evidence be removed from
the network? Defaults to <code>TRUE</code>. If set to <code>FALSE</code>, the user should
make sure to check whether the networks represent the distribution
of interest.</p>
</td></tr>
<tr><td><code id="rPeakHeight_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of one three-way array per marker; the three margins correspond to traces, alleles, and simulations.
</p>


<h3>Author(s)</h3>

<p>Therese Graversen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MC15, MC18, USCaucasian)

mixP &lt;- DNAmixture(list(MC15, MC18), C = list(50, 38), k = 3, K = c("K1", "K3", "K2"),
                   database = USCaucasian)
pP &lt;- mixpar(rho = list(30, 30), eta = list(30, 30), xi = list(0.08, 0.08),
             phi = list(c(K2 = 0.1, K3 = 0.2, K1 = 0.7), c(K2 = 0.1, K3 = 0.2, K1 = 0.7)))
rpk &lt;- rPeakHeight(mixP, pP, nsim = 5)


mixD &lt;- DNAmixture(list(MC15, MC18), C = list(50, 38), k = 3, K = c("K1", "K3"),
                   database = USCaucasian)
pD &lt;- mixpar(rho = list(30, 30), eta = list(30, 30), xi = list(0.08, 0.08),
             phi = list(c(U1 = 0.1, K3 = 0.2, K1 = 0.7), c(U1 = 0.1, K3 = 0.2, K1 = 0.7)))
rpj &lt;- rPeakHeight(mixD, pD, nsim = 5, dist = "joint")
rpc &lt;- rPeakHeight(mixD, pD, nsim = 5, dist = "conditional")

</code></pre>

<hr>
<h2 id='setCPT'>Set conditional probability tables for all auxiliary variables</h2><span id='topic+setCPT'></span>

<h3>Description</h3>

<p>A wrapper-function for the case where the conditional probability
tables are to be set in a DNA mixture model for all the auxiliary variables
(O, D and Q, at all markers and all alleles).
</p>
<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which is intended as a service to enable users to try <span class="pkg">DNAmixtures</span> without purchasing a commercial licence for Hugin. When at all possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span> rather than this lite-version. See <a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of <span class="pkg">DNAmixtures</span>, note that computations are much less efficient and that there are some differences in available functionality. Be aware that the present documentation is copied from <span class="pkg">DNAmixtures</span> and thus may not accurately describe the implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setCPT(mixture, pars, markers = mixture$markers)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setCPT_+3A_mixture">mixture</code></td>
<td>
<p>A DNA mixture</p>
</td></tr>
<tr><td><code id="setCPT_+3A_pars">pars</code></td>
<td>
<p>A list of parameters</p>
</td></tr>
<tr><td><code id="setCPT_+3A_markers">markers</code></td>
<td>
<p>Optionally, a list of markers for which to set the tables</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The conditional probability tables are set according to a list of
specified parameters and the observed peak heights. The function
returns evidence for future use on the nodes O.
</p>


<h3>Value</h3>

<p>List containing evidence for conditioning on peak heights.
</p>


<h3>See Also</h3>

<p>For further details, see in particular <code><a href="#topic+setCPT.O">setCPT.O</a></code>.
</p>

<hr>
<h2 id='setCPT.D'>Set tables for auxiliary variables <code>D</code></h2><span id='topic+setCPT.D'></span>

<h3>Description</h3>

<p>Function for setting the tables on all nodes <code>D_r_a</code> for
mixture <code>r</code> in the network corresponding to one marker, using
peak heights and a set of parameters.
</p>
<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which is intended as a service to enable users to try <span class="pkg">DNAmixtures</span> without purchasing a commercial licence for Hugin. When at all possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span> rather than this lite-version. See <a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of <span class="pkg">DNAmixtures</span>, note that computations are much less efficient and that there are some differences in available functionality. Be aware that the present documentation is copied from <span class="pkg">DNAmixtures</span> and thus may not accurately describe the implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setCPT.D(
  domain,
  rho,
  xi,
  eta,
  phi,
  C,
  n.unknown,
  n_K,
  D,
  gets_stutter,
  can_stutter,
  stutter.from
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setCPT.D_+3A_domain">domain</code></td>
<td>
<p>A <code>hugin.domain</code> modelling one marker</p>
</td></tr>
<tr><td><code id="setCPT.D_+3A_rho">rho</code></td>
<td>
<p>rho</p>
</td></tr>
<tr><td><code id="setCPT.D_+3A_xi">xi</code></td>
<td>
<p>xi</p>
</td></tr>
<tr><td><code id="setCPT.D_+3A_eta">eta</code></td>
<td>
<p>eta</p>
</td></tr>
<tr><td><code id="setCPT.D_+3A_phi">phi</code></td>
<td>
<p>phi</p>
</td></tr>
<tr><td><code id="setCPT.D_+3A_c">C</code></td>
<td>
<p>Detection threshold</p>
</td></tr>
<tr><td><code id="setCPT.D_+3A_n.unknown">n.unknown</code></td>
<td>
<p>Number of unknown contributors</p>
</td></tr>
<tr><td><code id="setCPT.D_+3A_n_k">n_K</code></td>
<td>
<p>Allelecounts for known contributors</p>
</td></tr>
<tr><td><code id="setCPT.D_+3A_d">D</code></td>
<td>
<p>Names for binary nodes</p>
</td></tr>
<tr><td><code id="setCPT.D_+3A_gets_stutter">gets_stutter</code></td>
<td>
<p>Does the allele receive stutter?</p>
</td></tr>
<tr><td><code id="setCPT.D_+3A_can_stutter">can_stutter</code></td>
<td>
<p>Can the allele stutter?</p>
</td></tr>
<tr><td><code id="setCPT.D_+3A_stutter.from">stutter.from</code></td>
<td>
<p>From which allele does the stutter come?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function sets conditional probabilities for auxiliary variables <code>D_r_a</code>,
which are used for obtaining probabilities of a peak
falling above resp. below the detection threshold under the current
model.
The conditional probability tables are defined using the gamma c.d.f. as
</p>
<p style="text-align: center;"><code class="reqn">P(\texttt{D[a]} = \texttt{TRUE} | n_{ia}, n_{i,a+1}, i = 1,\ldots, k) = G(\texttt{C}).
</code>
</p>



<h3>Value</h3>

<p>invisibly NULL
</p>


<h3>See Also</h3>

<p>For further details see <code><a href="#topic+setCPT.O">setCPT.O</a></code>.
</p>

<hr>
<h2 id='setCPT.O'>Set tables for auxiliary variables <code>O</code>.</h2><span id='topic+setCPT.O'></span>

<h3>Description</h3>

<p>Function for setting the tables on all nodes <code>O_r_a</code> for
mixture <code>r</code> in the network corresponding to one marker, using
peak heights and a set of parameters. The returned evidence can be
used for conditioning on observed peak heights.
</p>
<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which is intended as a service to enable users to try <span class="pkg">DNAmixtures</span> without purchasing a commercial licence for Hugin. When at all possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span> rather than this lite-version. See <a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of <span class="pkg">DNAmixtures</span>, note that computations are much less efficient and that there are some differences in available functionality. Be aware that the present documentation is copied from <span class="pkg">DNAmixtures</span> and thus may not accurately describe the implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setCPT.O(
  domain,
  rho,
  xi,
  eta,
  phi,
  heights,
  C,
  n.unknown,
  n_K,
  O,
  gets_stutter,
  can_stutter,
  stutter.from
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setCPT.O_+3A_domain">domain</code></td>
<td>
<p>A <code>hugin.domain</code> modelling one marker</p>
</td></tr>
<tr><td><code id="setCPT.O_+3A_rho">rho</code></td>
<td>
<p>rho</p>
</td></tr>
<tr><td><code id="setCPT.O_+3A_xi">xi</code></td>
<td>
<p>xi</p>
</td></tr>
<tr><td><code id="setCPT.O_+3A_eta">eta</code></td>
<td>
<p>eta</p>
</td></tr>
<tr><td><code id="setCPT.O_+3A_phi">phi</code></td>
<td>
<p>phi</p>
</td></tr>
<tr><td><code id="setCPT.O_+3A_heights">heights</code></td>
<td>
<p>Peak heights</p>
</td></tr>
<tr><td><code id="setCPT.O_+3A_c">C</code></td>
<td>
<p>Detection threshold</p>
</td></tr>
<tr><td><code id="setCPT.O_+3A_n.unknown">n.unknown</code></td>
<td>
<p>Number of unknown contributors</p>
</td></tr>
<tr><td><code id="setCPT.O_+3A_n_k">n_K</code></td>
<td>
<p>Allelecounts for known contributors</p>
</td></tr>
<tr><td><code id="setCPT.O_+3A_o">O</code></td>
<td>
<p>Vector of names for binary nodes</p>
</td></tr>
<tr><td><code id="setCPT.O_+3A_gets_stutter">gets_stutter</code></td>
<td>
<p>Does the allele receive stutter? A boolean vector.</p>
</td></tr>
<tr><td><code id="setCPT.O_+3A_can_stutter">can_stutter</code></td>
<td>
<p>Can the allele stutter?</p>
</td></tr>
<tr><td><code id="setCPT.O_+3A_stutter.from">stutter.from</code></td>
<td>
<p>From which allele does the stutter come?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function sets probabilities in CPT according to
whether a peak is observed or not. If a peak is seen at allele
<code class="reqn">a</code>, the conditional distribution is defined using the
p.d.f. <code class="reqn">g</code> for the gamma distribution presented in
<code><a href="#topic+DNAmixtures">DNAmixtures</a></code> as
</p>
<p style="text-align: center;"><code class="reqn">P(\texttt{O[a]} = \texttt{TRUE} | n_{ia}, n_{i,a+1}, i = 1,\ldots, k) = g(\texttt{heights[a]})/k_a
</code>
</p>

<p>and likelihood-evidence <code class="reqn">(0, k_a)</code> for the states (<code>FALSE</code>, <code>TRUE</code>) is returned.
If the allele is not seen, the CPT is set using the c.d.f. <code class="reqn">G</code> for the gamma distribution as
</p>
<p style="text-align: center;"><code class="reqn">P(\code{O[a]} = \code{FALSE} | n_{ia}, n_{i,a+1}, i = 1,\ldots, k) = G(\code{C}),
</code>
</p>

<p>in which case likelihood-evidence (1,0) is returned for this allele.
</p>


<h3>Value</h3>

<p>A matrix with each column containing the evidence to be set on <code>O[a]</code> when conditioning on the peak heights.
</p>


<h3>Technical comments</h3>

<p>For the sake of speed and saving
memory, only probabilities for the CPT of <code>O[a]</code> are
calculated, and not the entire table.  The parent nodes are
<code>n_i_a</code> and possibly <code>n_i_(a+1)</code> for all unknown
contributors i; the <code class="reqn">n_{ia}</code> for known contributors are
specified through the argument <code>n_K</code>.  The layout of the
table relies in particular on the fact that all nodes have a
statespace 0,1,2, which this is *not* checked anywhere. Thus, if
other types of allele-count-nodes <code>n_i_a</code> are introduced
(such as could be relevant for Amelogenin), the function should be
changed accordingly.
</p>
<p>If invalid tables are set then any subsequent propagation will
fail. No roll-back functionality has so far been implemented to
fix this, and the easiest solution is to re-fit the mixture model.
</p>
<p>Note that the detection threshold and model parameters can be
specified as vectors, and so it is in theory possible to use allele-specific
values, if desired. This also holds for the functions
<code><a href="#topic+setCPT.D">setCPT.D</a></code> and <code><a href="#topic+setCPT.Q">setCPT.Q</a></code>.
</p>

<hr>
<h2 id='setCPT.Q'>Set tables for auxiliary variables <code>Q</code></h2><span id='topic+setCPT.Q'></span>

<h3>Description</h3>

<p>Function for setting the tables on all nodes <code>Q_r_a</code> for
mixture <code>r</code> in the network corresponding to one marker, using
peak heights and a set of parameters.
</p>
<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which is intended as a service to enable users to try <span class="pkg">DNAmixtures</span> without purchasing a commercial licence for Hugin. When at all possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span> rather than this lite-version. See <a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of <span class="pkg">DNAmixtures</span>, note that computations are much less efficient and that there are some differences in available functionality. Be aware that the present documentation is copied from <span class="pkg">DNAmixtures</span> and thus may not accurately describe the implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setCPT.Q(
  domain,
  rho,
  xi,
  eta,
  phi,
  heights,
  n.unknown,
  n_K,
  Q,
  gets_stutter,
  can_stutter,
  stutter.from
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setCPT.Q_+3A_domain">domain</code></td>
<td>
<p>A <code>hugin.domain</code> modelling one marker</p>
</td></tr>
<tr><td><code id="setCPT.Q_+3A_rho">rho</code></td>
<td>
<p>rho</p>
</td></tr>
<tr><td><code id="setCPT.Q_+3A_xi">xi</code></td>
<td>
<p>xi</p>
</td></tr>
<tr><td><code id="setCPT.Q_+3A_eta">eta</code></td>
<td>
<p>eta</p>
</td></tr>
<tr><td><code id="setCPT.Q_+3A_phi">phi</code></td>
<td>
<p>phi ordered as <code>phi[c(U,K)]</code> where <code>U</code> and <code>K</code> are the names of unknown and known contributors.</p>
</td></tr>
<tr><td><code id="setCPT.Q_+3A_heights">heights</code></td>
<td>
<p>Observed peak heights</p>
</td></tr>
<tr><td><code id="setCPT.Q_+3A_n.unknown">n.unknown</code></td>
<td>
<p>Number of unknown contributors</p>
</td></tr>
<tr><td><code id="setCPT.Q_+3A_n_k">n_K</code></td>
<td>
<p>Allelecounts for known contributors</p>
</td></tr>
<tr><td><code id="setCPT.Q_+3A_q">Q</code></td>
<td>
<p>Names for binary nodes</p>
</td></tr>
<tr><td><code id="setCPT.Q_+3A_gets_stutter">gets_stutter</code></td>
<td>
<p>Does the allele receive stutter?</p>
</td></tr>
<tr><td><code id="setCPT.Q_+3A_can_stutter">can_stutter</code></td>
<td>
<p>Can the allele stutter?</p>
</td></tr>
<tr><td><code id="setCPT.Q_+3A_stutter.from">stutter.from</code></td>
<td>
<p>From which allele does the stutter come?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function sets conditional probabilities for auxiliary variables <code>Q_r_a</code>,
which are used for finding probabilities of observing a smaller or
larger peak than the one observed for the DNA mixture.
The conditional probability tables are defined using the gamma c.d.f. as
</p>
<p style="text-align: center;"><code class="reqn">P(\texttt{Q[a]} = \texttt{TRUE} | n_{ia}, n_{i,a+1}, i = 1,\ldots, k) = G(\texttt{heights[a]}).
</code>
</p>



<h3>Value</h3>

<p>Scaling factors to be set as evidence when conditioning on the peak heights
</p>


<h3>Author(s)</h3>

<p>Therese Graversen
</p>


<h3>See Also</h3>

<p>For further details see <code><a href="#topic+setCPT.O">setCPT.O</a></code>.
</p>

<hr>
<h2 id='setPeakInfo'>Include or exclude peak information in the model</h2><span id='topic+setPeakInfo'></span><span id='topic+removePeakInfo'></span>

<h3>Description</h3>

<p>The function <code>setPeakInfo</code> is used for including in the model
either the full peak height information or only information about
presence and absence of peaks. After a call to <code>setPeakInfo</code>,
the Bayesian networks in <code>mixture$domains</code> will represent
the conditional distribution given the specified peak
information. For the reverse functionality, i.e. exclusion of any
such peak information, use <code>removePeakInfo</code>.
</p>
<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which is intended as a service to enable users to try <span class="pkg">DNAmixtures</span> without purchasing a commercial licence for Hugin. When at all possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span> rather than this lite-version. See <a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of <span class="pkg">DNAmixtures</span>, note that computations are much less efficient and that there are some differences in available functionality. Be aware that the present documentation is copied from <span class="pkg">DNAmixtures</span> and thus may not accurately describe the implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setPeakInfo(mixture, pars, presence.only = FALSE)

removePeakInfo(mixture)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setPeakInfo_+3A_mixture">mixture</code></td>
<td>
<p>A <code><a href="#topic+DNAmixture">DNAmixture</a></code></p>
</td></tr>
<tr><td><code id="setPeakInfo_+3A_pars">pars</code></td>
<td>
<p>A <code><a href="#topic+mixpar">mixpar</a></code> model parameter</p>
</td></tr>
<tr><td><code id="setPeakInfo_+3A_presence.only">presence.only</code></td>
<td>
<p>Default is FALSE, which means that the full
peak height information is taken into consideration. Set to TRUE,
which will include only information on the presence and absence of peaks.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>setPeakInfo</code> sets conditional
probability tables using the specified model parameters, and
propagates suitable evidence using either observed peak heights or
the discrete presence/absence observations of peaks. Any
previously entered or propagated evidence on nodes <code>O</code> and
<code>D</code> will be retracted in this process.
</p>
<p>The function <code>removePeakInfo</code> retracts all evidence on nodes
<code>O</code> and <code>D</code>; the conditional probability tables are left
unchanged.
</p>


<h3>Value</h3>

<p>invisibly <code>NULL</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+setCPT">setCPT</a></code>. For use of the Bayesian networks, see <code><a href="#topic+map.genotypes">map.genotypes</a></code>.
</p>

<hr>
<h2 id='SGMplusDyes'>Dyes used for SGMplus</h2><span id='topic+SGMplusDyes'></span>

<h3>Description</h3>

<p>Dyes used for the AmpFlSTR SGM Plus PCR Amplification Kit
</p>


<h3>Format</h3>

<p>A list with one item per dye, each containing a vector of
marker-names specifying the order in which they occur in an EPG.
</p>


<h3>Source</h3>

<p>Applied Biosystems
</p>

<hr>
<h2 id='summary.map.genotypes'>Summary of best genotypes</h2><span id='topic+summary.map.genotypes'></span><span id='topic+print.summary.map.genotypes'></span>

<h3>Description</h3>

<p>The maximum posterior configurations of genotypes as returned by
<code><a href="#topic+map.genotypes">map.genotypes</a></code>, but in the format of pairs of alleles
rather than raw allelecounts. When a subset of alleles are
considered, then the value <code>NA</code> is used to denote an allele outside
this subset; in particular, if <code>type="seen"</code> is used in
<code><a href="#topic+map.genotypes">map.genotypes</a></code>, then <code>NA</code> corresponds to the
allele having dropped out in all of the mixtures included in the
model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'map.genotypes'
summary(object, ...)

## S3 method for class 'summary.map.genotypes'
print(x, markers = names(x), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.map.genotypes_+3A_object">object</code></td>
<td>
<p>An object returned by <code><a href="#topic+map.genotypes">map.genotypes</a></code>.</p>
</td></tr>
<tr><td><code id="summary.map.genotypes_+3A_...">...</code></td>
<td>
<p>arguments passed on to other methods.</p>
</td></tr>
<tr><td><code id="summary.map.genotypes_+3A_x">x</code></td>
<td>
<p>An object of class <code>"summary.map.genotypes"</code>, typically returned by <code>summary.map.genotypes</code>.</p>
</td></tr>
<tr><td><code id="summary.map.genotypes_+3A_markers">markers</code></td>
<td>
<p>Optionally, a subset of markers to print</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with two columns per unknown
contributor under consideration and a column <code>Prob</code>
containing the probability of the configuration.
</p>


<h3>Author(s)</h3>

<p>Therese Graversen
</p>


<h3>See Also</h3>

<p><code><a href="#topic+map.genotypes">map.genotypes</a></code>
</p>

<hr>
<h2 id='UKCaucasian'>Allele frequencies for UK Caucasians</h2><span id='topic+UKCaucasian'></span>

<h3>Description</h3>

<p>Database of allele frequencies for UK Caucasians.
</p>


<h3>Format</h3>

<p>A <code>data.frame</code>
</p>


<h3>Source</h3>

<p>The frequencies are produced from the allele counts for
one (the UK Caucasian) of three British sub-populations as found
on David Balding's homepage under his
<a href="https://sites.google.com/site/baldingstatisticalgenetics/software/likeltd-r-forensic-dna-r-code"><span class="pkg">likeLTD</span></a>
software for mixture analysis in <span class="rlang"><b>R</b></span>.
</p>


<h3>References</h3>

<p><a href="https://sites.google.com/site/baldingstatisticalgenetics/software/likeltd-r-forensic-dna-r-code">https://sites.google.com/site/baldingstatisticalgenetics/software/likeltd-r-forensic-dna-r-code</a>
</p>

<hr>
<h2 id='USCaucasian'>The data base of allele frequencies for 302 US Caucasian profiles.</h2><span id='topic+USCaucasian'></span>

<h3>Description</h3>

<p>Allele frequencies for US Caucasians.
</p>


<h3>Format</h3>

<p>A <code>data.frame</code>.
</p>


<h3>Note</h3>

<p>There are a few errata found after publication of the allele
frequencies, but we have not updated the allele frequencies
accordingly. The frequencies also did not add up to 1, and this is
simply corrected by normalising within each marker.
</p>


<h3>Source</h3>

<p><a href="http://www.cstl.nist.gov/strbase/NISTpop.htm">http://www.cstl.nist.gov/strbase/NISTpop.htm</a>
</p>

<hr>
<h2 id='varEst'>Estimated asymptotic variance matrix for MLE</h2><span id='topic+varEst'></span><span id='topic+summary.mixVarEst'></span><span id='topic+print.summary.mixVarEst'></span>

<h3>Description</h3>

<p>Provided that the user specifies the MLE as well as the
constraints used in the maximisation, this function computes an
estimate of the variance of the MLE based on the observed
information. The observed information is obtained by numerically
deriving the Hessian of the log-likelihood function.
</p>
<p><em>IMPORTANT: This is the <span class="pkg">DNAmixturesLite</span> package, which
is intended as a service to enable users to try <span class="pkg">DNAmixtures</span>
without purchasing a commercial licence for Hugin. When at all
possible, we strongly recommend the use of <span class="pkg">DNAmixtures</span>
rather than this lite-version. See
<a href="https://dnamixtures.r-forge.r-project.org/">https://dnamixtures.r-forge.r-project.org/</a> for details on
both packages.</em>
</p>
<p><em>While the lite-version seeks to provide the full functionality of
<span class="pkg">DNAmixtures</span>, note that computations are much less efficient
and that there are some differences in available functionality. Be
aware that the present documentation is copied from
<span class="pkg">DNAmixtures</span> and thus may not accurately describe the
implementation of this lite-version.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varEst(mixture, mle, npars, method = "Richardson", ...)

## S3 method for class 'mixVarEst'
summary(object, transform = FALSE, ...)

## S3 method for class 'summary.mixVarEst'
print(
  x,
  digits = max(3, getOption("digits") - 3),
  scientific = FALSE,
  print.gap = 3L,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varEst_+3A_mixture">mixture</code></td>
<td>
<p>A <code><a href="#topic+DNAmixture">DNAmixture</a></code>.</p>
</td></tr>
<tr><td><code id="varEst_+3A_mle">mle</code></td>
<td>
<p>A <code>mixpar</code>, typically obtained by <code>mixML</code>.</p>
</td></tr>
<tr><td><code id="varEst_+3A_npars">npars</code></td>
<td>
<p>A list of integers specifying the number of each of the four
parameters <code>rho</code>, <code>eta</code>, <code>xi</code> and <code>phi</code>. Allowed values are
</p>

<dl>
<dt><code>0</code></dt><dd><p>The parameter is fixed, but might differ across mixtures.</p>
</dd>
<dt><code>1</code></dt><dd><p>The parameter is equal across mixtures.</p>
</dd>
<dt><code>N</code></dt><dd><p>There is one parameter for each of the <code>N</code> mixtures in the model.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="varEst_+3A_method">method</code></td>
<td>
<p>Method for numeric differentiation used in <code><a href="numDeriv.html#topic+hessian">hessian</a></code></p>
</td></tr>
<tr><td><code id="varEst_+3A_...">...</code></td>
<td>
<p>Arguments to be passed on to other methods.</p>
</td></tr>
<tr><td><code id="varEst_+3A_object">object</code></td>
<td>
<p>An object of class <code>mixVarEst</code>, typically obtained by a call to <code><a href="#topic+varEst">varEst</a></code>.</p>
</td></tr>
<tr><td><code id="varEst_+3A_transform">transform</code></td>
<td>
<p>Should the parameterisation <code class="reqn">(\mu, \sigma)</code> be used? Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="varEst_+3A_x">x</code></td>
<td>
<p>An object of class <code>"summary.mixVarEst"</code>.</p>
</td></tr>
<tr><td><code id="varEst_+3A_digits">digits</code></td>
<td>
<p>Number of significant digits to print</p>
</td></tr>
<tr><td><code id="varEst_+3A_scientific">scientific</code></td>
<td>
<p>Should scientific notation be used?</p>
</td></tr>
<tr><td><code id="varEst_+3A_print.gap">print.gap</code></td>
<td>
<p>Distance between columns in the printing of the summary.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As the user can apply highly customized constraints to the model
parameters when maximising with <code><a href="#topic+mixML">mixML</a></code>, it is a
complicated matter to write a generic function for computing the
asymptotic variance matrix. We have thus restricted attention to
the case where each of the (multi-dimensional) parameters <code>rho</code>,
<code>eta</code>, <code>xi</code> and <code>phi</code> can be either
</p>

<ul>
<li><p> fixed at known values
</p>
</li>
<li><p> unknown, but common across traces
</p>
</li>
<li><p> unconstrained
</p>
</li></ul>



<h3>Value</h3>

<p>The mle and the estimated covariance matrix in different parametrisations
</p>
<table>
<tr><td><code>cov and mle</code></td>
<td>
<p><code class="reqn">\rho, \eta, \xi, \phi</code></p>
</td></tr>
<tr><td><code>cov.trans and mle.trans</code></td>
<td>
<p><code class="reqn">\mu, \sigma, \xi, \phi</code></p>
</td></tr>
<tr><td><code>cov.res</code></td>
<td>
<p>A non-singular covariance matrix for a
reparametrisation of <code class="reqn">\rho, \eta, \xi, \phi</code>, collapsing the
parameters according to the specified constrains and removing one
contributor from <code class="reqn">\phi</code>.</p>
</td></tr>
</table>
<p>An integer suffix is used to indicate which mixture the parameter
is associated with. In the restricted covariance matrix, all fixed
parameters are left out. If parameters are equal accross mixtures,
the suffix for this parameter will be <code>.1</code>. If parameters are
unconstrained and there are <code>N</code> mixtures in the model,
suffixes are <code>.1, ..., .N</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(MC18, USCaucasian)
mixHp &lt;- DNAmixture(list(MC18), k = 3, K = c("K1", "K2", "K3"), C = list(50),
                    database = USCaucasian)
p &lt;- mixpar(rho = list(30), eta = list(34), xi = list(0.08),
            phi = list(c(K1 = 0.71, K3 = 0.1, K2 = 0.19)))
mlHp &lt;- mixML(mixHp, pars = p)
## Find the estimated covariance matrix of the MLE
V.Hp &lt;- varEst(mixHp, mlHp$mle, npars = list(rho=1,eta=1,xi=1,phi=1))
V.Hp$cov ## using (rho, eta)
V.Hp$cov.trans ## using (mu, sigma)
## The summary is a table containing the MLE and their standard errors
summary(V.Hp)


data(MC18, USCaucasian)
mixmult &lt;- DNAmixture(list(MC18), C = list(50), k = 3, K = c("K1", "K2"), database = USCaucasian)
startpar &lt;- mixpar(rho = list(30), eta = list(28), xi = list(0.08),
                   phi = list(c(U1 = 0.2, K1 = 0.7, K2 = 0.1)))
ml.mult &lt;- mixML(mixmult, startpar)
Vmult &lt;- varEst(mixmult, ml.mult$mle, list(rho=1,eta=1,xi=1,phi=1))
summary(Vmult)



## Be aware that the following two advanced examples are computationally demanding and
## typically have a runtime of several minutes with the lite-version of DNAmixtures.

data(MC15, MC18, USCaucasian)
mix &lt;- DNAmixture(list(MC15, MC18), C = list(50, 38), k = 3, K = c("K1", "K2"),
database = USCaucasian)
startpar &lt;- mixpar(rho = list(30, 30), eta = list(28, 35), xi = list(0.08, 0.1),
                   phi = list(c(U1 = 0.05, K1 = 0.7, K2 = 0.25),
                                c(K1 = 0.7, K2 = 0.1, U1 = 0.2)))
eqxis &lt;- function(x){ diff(unlist(x[,"xi"])) }
## Here we set stutter equal for all traces
ml.diff &lt;- mixML(mix, startpar, eqxis, val = 0, phi.eq = FALSE)
V.diff &lt;- varEst(mix, ml.diff$mle, list(rho=2,eta=2,xi=1,phi=2))
summary(V.diff)

## Fixing stutter to 0.07
xival &lt;- function(x){unlist(x[,"xi"])}
ml.eq &lt;- mixML(mix, startpar, xival, val = c(0.07, 0.07), phi.eq = FALSE)
V.eq &lt;- varEst(mix, ml.eq$mle, list(rho=2,eta=2,xi=0,phi=2))
summary(V.eq)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
