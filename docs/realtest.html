<!DOCTYPE html><html><head><title>Help for package realtest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {realtest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#about_realtest'><p>Where Expectations Meet Reality: Realistic Unit Testing in R</p></a></li>
<li><a href='#E'><p>Test Which Expectations are Met</p></a></li>
<li><a href='#failstop'><p>Example Test Result Postprocessors</p></a></li>
<li><a href='#ignore_differences'><p>Example Object and Side Effect Comparers</p></a></li>
<li><a href='#P'><p>Manually Create a Test Descriptor Prototype</p></a></li>
<li><a href='#print.realtest_results_summary'><p>Summarise and Display Test Results</p></a></li>
<li><a href='#R'><p>Create a Result Descriptor by Recording Effects of an Expression Evaluation</p></a></li>
<li><a href='#source2'><p>Read and Evaluate Code from an R Script</p></a></li>
<li><a href='#test_dir'><p>Gather All Test Results From R Scripts</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-15</td>
</tr>
<tr>
<td>Title:</td>
<td>Where Expectations Meet Reality: Realistic Unit Testing</td>
</tr>
<tr>
<td>Description:</td>
<td>
    A framework for unit testing for realistic minimalists,
    where we distinguish between expected, acceptable, current, fallback,
    ideal, or regressive behaviour. It can also be used for monitoring
    third-party software projects for changes.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/gagolews/realtest/issues">https://github.com/gagolews/realtest/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://realtest.gagolewski.com">https://realtest.gagolewski.com</a>,
<a href="https://github.com/gagolews/realtest">https://github.com/gagolews/realtest</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-15 00:25:38 UTC; gagolews</td>
</tr>
<tr>
<td>Author:</td>
<td>Marek Gagolewski <a href="https://orcid.org/0000-0003-0637-6028"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marek Gagolewski &lt;marek@gagolewski.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-16 11:30:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='about_realtest'>Where Expectations Meet Reality: Realistic Unit Testing in R</h2><span id='topic+about_realtest'></span><span id='topic+realtest'></span><span id='topic+realtest-package'></span>

<h3>Description</h3>

<p><span class="pkg">realtest</span> is a framework for unit testing for
realistic minimalists, where we distinguish between
expected, acceptable, and undesirable behaviour.
</p>
<p><b>Keywords</b>: unit testing, software quality, expectation,
undesired behaviour, continuous integration.
</p>
<p><b>License</b>: GNU General Public License version 2 or later.
</p>


<h3>Author(s)</h3>

<p><a href="https://www.gagolewski.com/">Marek Gagolewski</a>
</p>


<h3>See Also</h3>

<p>The official online manual of <span class="pkg">realtest</span> at <a href="https://realtest.gagolewski.com/">https://realtest.gagolewski.com/</a>
</p>

<hr>
<h2 id='E'>Test Which Expectations are Met</h2><span id='topic+E'></span>

<h3>Description</h3>

<p>Performs a unit test and summarises the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>E(
  expr,
  ...,
  value_comparer = getOption("realtest_value_comparer", identical),
  sides_comparer = getOption("realtest_sides_comparer", sides_similar),
  postprocessor = getOption("realtest_postprocessor", failstop)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E_+3A_expr">expr</code></td>
<td>
<p>an expression to be recorded (via <code><a href="#topic+R">R</a></code>) and
and compared with the prototypes</p>
</td></tr>
<tr><td><code id="E_+3A_...">...</code></td>
<td>
<p>a sequence of 1 or more (possibly named) prototypes constructed
via <code><a href="#topic+R">R</a></code> or <code><a href="#topic+P">P</a></code> (objects which are not
of class <code>realtest_descriptor</code> will be passed to <code><a href="#topic+P">P</a></code>);
arguments whose names start with a dot (like <code>.label=value</code>)
can be used to introduce metadata (e.g., additional details
in natural language)</p>
</td></tr>
<tr><td><code id="E_+3A_value_comparer">value_comparer</code></td>
<td>
<p>a two-argument function used (unless overridden
by the prototype) to compare the values with each other,
e.g., <code><a href="base.html#topic+identical">identical</a></code>
or <code><a href="base.html#topic+all.equal">all.equal</a></code></p>
</td></tr>
<tr><td><code id="E_+3A_sides_comparer">sides_comparer</code></td>
<td>
<p>a two-argument function used (unless overridden
by the prototype) to compare the side effects (essentially: two lists)
with each other, e.g., <code><a href="#topic+sides_similar">sides_similar</a></code>
or <code><a href="#topic+ignore_differences">ignore_differences</a></code></p>
</td></tr>
<tr><td><code id="E_+3A_postprocessor">postprocessor</code></td>
<td>
<p>a function to call on the generated
<code>realtest_result</code>, e.g., <code><a href="#topic+failstop">failstop</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each expression in the R language has a range of possible effects.
The direct effect corresponds to the value generated by evaluating
the expression. Side effects may include errors, warnings, text printed
out on the console, etc., see <code><a href="#topic+P">P</a></code> and <code><a href="#topic+R">R</a></code>.
</p>
<p>Arguments passed via <code>...</code> whose names do not start with
a dot should be objects of class <code>realtest_descriptor</code>
(otherwise they are passed to <code><a href="#topic+P">P</a></code>). They define the
prototypes against which the object generated by <code>expr</code>
will be tested.
</p>
<p><code>value_comparer</code> and <code>sides_comparer</code> are 2-ary functions
that return <code>TRUE</code> if two objects/side effect lists are equivalent
and a character string summarising the differences (or any other kind
or object) otherwise.
</p>
<p>A test case is considered met, whenever
<code>value_comparer(prototype[["value"]], object[["value"]])</code> and
<code>sides_comparer(prototype[["sides"]], object[["sides"]])</code>
are both <code>TRUE</code> for some <code>prototype</code>.
The comparers may be overridden on a per-prototype basis, though.
If <code>prototype[["value_comparer"]]</code> or
<code>prototype[["sides_comparer"]]</code> are defined, these are used
instead.
</p>


<h3>Value</h3>

<p>The function creates an object of class <code>realtest_result</code>,
which is a named list with at least the following components:
</p>

<ul>
<li> <p><code>object</code> &ndash; an object of class <code>realtest_descriptor</code>,
ultimately <code><a href="#topic+R">R</a>(expr)</code>,
</p>
</li>
<li> <p><code>prototypes</code> &ndash; a (possibly named) list of objects of class
<code>realtest_descriptor</code> that were passed via <code>...</code>,
</p>
</li>
<li> <p><code>matches</code> &ndash; a (possibly empty) numeric vector of the indexes
of the prototypes matching the object (can be named),
</p>
</li>
<li> <p><code>.dotted.names</code> &ndash; copied as-is
from the arguments of the same name.
</p>
</li></ul>

<p>This object is then passed to the <code>postprocessor</code> which itself becomes
responsible for generating the output value to
be returned by the current function (and, e.g., throwing an error
if the test fails).
</p>


<h3>Author(s)</h3>

<p><a href="https://www.gagolewski.com/">Marek Gagolewski</a>
</p>


<h3>See Also</h3>

<p>The official online manual of <span class="pkg">realtest</span> at <a href="https://realtest.gagolewski.com/">https://realtest.gagolewski.com/</a>
</p>
<p>Related functions:
<code><a href="#topic+P">P</a></code>, <code><a href="#topic+R">R</a></code>, <code><a href="#topic+test_dir">test_dir</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># the default result postprocessor throws an error on a failed test:
E(E(sqrt(4), P(7)), P(error=TRUE, stdout=TRUE))
E(sqrt(4), 2.0)  # the same as E(sqrt(4), P(2.0))
E(sin(pi), 0.0, value_comparer=all.equal)  # almost-equal
E(
  sample(c("head", "tail"), 1),
  .description="this call has two possible outcomes",
  "head",  # first prototype
  "tail"   # second prototype
)
E(sqrt(-1), P(NaN, warning=TRUE))  # a warning is expected
E(sqrt(-1), NaN, sides_comparer=ignore_differences) # do not test side effects
E(sqrt(-1), P(NaN, warning=NA))  # ignore warnings
E(
  paste0(1:2, 1:3),                  # expression to test - concatenation
  .description="partial recycling",  # info - what behaviour are we testing?
  best=P(                            # what we yearn for (ideally)
    c("11", "22", "13"),
    warning=TRUE
  ),
  pass=c("11", "22", "13"),          # this is the behaviour we have now
  bad=P(error=TRUE)                  # avoid regression
)
e &lt;- E(sin(pi), best=0.0, pass=P(0.0, value_comparer=all.equal),
  .comment="well, this is not a symbolic language after all...")
print(e)

</code></pre>

<hr>
<h2 id='failstop'>Example Test Result Postprocessors</h2><span id='topic+failstop'></span>

<h3>Description</h3>

<p>Generally, test result postprocessors are used by the <code><a href="#topic+E">E</a></code>
function. <code>failstop</code> calls <code><a href="utils.html#topic+str">str</a>(r)</code>
and throws an error if an expectation is not met, i.e.,
when <code>r[["matches"]]</code> is of length 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>failstop(r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="failstop_+3A_r">r</code></td>
<td>
<p>object of class <code>realtest_result</code>, see <code><a href="#topic+E">E</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are example postprocessors. You are encouraged to write your
own ones that will suit your own needs. Explore their source code
for some inspirations. It's an open source (and free!) project after all.
</p>
<p>For <code>failstop</code>, you can always create a function
<code>str.realtest_result</code> implementing the pretty printing of an error
message.
</p>


<h3>Value</h3>

<p>Returns <code>r</code>, invisibly.
</p>


<h3>Author(s)</h3>

<p><a href="https://www.gagolewski.com/">Marek Gagolewski</a>
</p>


<h3>See Also</h3>

<p>The official online manual of <span class="pkg">realtest</span> at <a href="https://realtest.gagolewski.com/">https://realtest.gagolewski.com/</a>
</p>

<hr>
<h2 id='ignore_differences'>Example Object and Side Effect Comparers</h2><span id='topic+ignore_differences'></span><span id='topic+sides_similar'></span>

<h3>Description</h3>

<p>Example two-argument functions to compare direct or indirect effects
of two test descriptors (see <code><a href="#topic+P">P</a></code> and <code><a href="#topic+R">R</a></code>).
These can be passed as <code>value_comparer</code> and <code>sides_comparer</code>
to <code><a href="#topic+E">E</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ignore_differences(x, y)

sides_similar(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ignore_differences_+3A_x">x</code></td>
<td>
<p>prototype or part thereof</p>
</td></tr>
<tr><td><code id="ignore_differences_+3A_y">y</code></td>
<td>
<p>object under scrutiny or part thereof</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Notable built-in (base R) comparers include <code><a href="base.html#topic+identical">identical</a></code>
(the strictest possible)
and <code><a href="base.html#topic+all.equal">all.equal</a></code> (can ignore, amongst others,
round-off errors; note that it is an S3 generic).
</p>
<p><code>ignore_differences</code> is a dummy comparer that always returns
<code>TRUE</code>. Hence, it does not discriminate between anything.
</p>
<p><code>sides_similar</code> is useful when comparing side effect lists.
It defines the following semantics for the prototypical values:
</p>

<ul>
<li><p> non-existent, <code>NULL</code>, or <code>FALSE</code> &ndash; a side effect must
not occur,
</p>
</li>
<li> <p><code>NA</code> &ndash; ignore whatsoever,
</p>
</li>
<li> <p><code>TRUE</code> &ndash; a side effect occurs, but the details are irrelevant
(e.g., 'some warning' as opposed to <code>"NaNs produced"</code>)
</p>
</li>
<li><p> otherwise &ndash; a character vector with message(s) matched exactly.
</p>
</li></ul>

<p>You can define any comparers of your own liking:
the possibilities are endless. For example:
</p>

<ul>
<li><p> a comparer for side effects based on regular expressions
or wildcards (e.g., <code>".not converged.*"</code>),
</p>
</li>
<li><p> a comparer that tests whether all elements in a vector are
equal to <code>TRUE</code>,
</p>
</li>
<li><p> a comparer that verifies whether each element in a vector falls into
a specified interval,
</p>
</li>
<li><p> a comparer that ignores all the object attributes (possibly
in combination with other comparers),
</p>
</li></ul>

<p>and so forth.
</p>


<h3>Value</h3>

<p>Each comparer should yield <code>TRUE</code> if the test condition
is considered met or anything else otherwise.
However, it is highly recommended that in the latter case,
a single string with a short
summary of the differences be returned, as in <code><a href="base.html#topic+all.equal">all.equal</a></code>.
</p>


<h3>Author(s)</h3>

<p><a href="https://www.gagolewski.com/">Marek Gagolewski</a>
</p>


<h3>See Also</h3>

<p>The official online manual of <span class="pkg">realtest</span> at <a href="https://realtest.gagolewski.com/">https://realtest.gagolewski.com/</a>
</p>

<hr>
<h2 id='P'>Manually Create a Test Descriptor Prototype</h2><span id='topic+P'></span>

<h3>Description</h3>

<p>Allows for formulating expectations like 'the desired outcome is
<code>c(1, 2, 3)</code>, with a warning' or 'an error should occur'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>P(
  value = NULL,
  error = NULL,
  warning = NULL,
  message = NULL,
  stdout = NULL,
  stderr = NULL,
  value_comparer = NULL,
  sides_comparer = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="P_+3A_value">value</code></td>
<td>
<p>object (may of course be equipped with attributes)</p>
</td></tr>
<tr><td><code id="P_+3A_error">error</code>, <code id="P_+3A_warning">warning</code>, <code id="P_+3A_message">message</code></td>
<td>
<p><a href="base.html#topic+conditions">conditions</a> expected to occur,
see <code><a href="base.html#topic+stop">stop</a></code>, <code><a href="base.html#topic+warning">warning</a></code>, and
<code><a href="base.html#topic+message">message</a></code></p>
</td></tr>
<tr><td><code id="P_+3A_stdout">stdout</code>, <code id="P_+3A_stderr">stderr</code></td>
<td>
<p>character data expected on
<code><a href="base.html#topic+stdout">stdout</a></code>
and <code><a href="base.html#topic+stderr">stderr</a></code>, respectively</p>
</td></tr>
<tr><td><code id="P_+3A_value_comparer">value_comparer</code>, <code id="P_+3A_sides_comparer">sides_comparer</code></td>
<td>
<p>optional two-argument functions
which may be used to override the default comparers
used by <code><a href="#topic+E">E</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>error</code>, <code>warning</code>, <code>message</code>, <code>stdout</code>, or
<code>stderr</code> are <code>NULL</code>, then no side effects of particular
kinds are included in the output.
</p>
<p>The semantics is solely defined by the <code>sides_comparer</code>.
<code><a href="#topic+E">E</a></code> by default uses <code><a href="#topic+sides_similar">sides_similar</a></code>
(see its description therein), although you are free to override
it manually or via a global option.
</p>


<h3>Value</h3>

<p>A list of class <code>realtest_descriptor</code>
with named components:
</p>

<ul>
<li> <p><code>value</code>,
</p>
</li>
<li> <p><code>sides</code> (optional) &ndash; a list with named elements
<code>error</code>, <code>warnings</code>,
<code>messages</code>, <code>stdout</code>, and <code>stderr</code>;
those which are missing are assumed to be equal to <code>NULL</code>,
</p>
</li>
<li> <p><code>value_comparer</code> (optional) &ndash; a function object,
</p>
</li>
<li> <p><code>sides_comparer</code> (optional) &ndash; a function object.
</p>
</li></ul>

<p>Other functions are free to add more named components, and do with them
whatever they please.
</p>


<h3>Author(s)</h3>

<p><a href="https://www.gagolewski.com/">Marek Gagolewski</a>
</p>


<h3>See Also</h3>

<p>The official online manual of <span class="pkg">realtest</span> at <a href="https://realtest.gagolewski.com/">https://realtest.gagolewski.com/</a>
</p>
<p>Related functions:
<code><a href="#topic+E">E</a></code>, <code><a href="#topic+R">R</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># the desired outcome is c(1L, 2L, 3L):
P(1:3)
# expecting c(1L, 2L, 3L), with a warning:
P(1:3, warning=TRUE)
# note, however, that it is the sides_comparer that defines the semantics

</code></pre>

<hr>
<h2 id='print.realtest_results_summary'>Summarise and Display Test Results</h2><span id='topic+print.realtest_results_summary'></span><span id='topic+summary.realtest_results'></span>

<h3>Description</h3>

<p>An example (write your own which will better suit your needs)
way to summarise the results returned by <code>test_dir</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'realtest_results_summary'
print(x, label_fail = "fail", ...)

## S3 method for class 'realtest_results'
summary(object, label_pass = "pass", label_fail = "fail", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.realtest_results_summary_+3A_x">x</code></td>
<td>
<p>object returned by <code>summary.realtest_results</code></p>
</td></tr>
<tr><td><code id="print.realtest_results_summary_+3A_label_fail">label_fail</code></td>
<td>
<p>single string labelling failed test cases</p>
</td></tr>
<tr><td><code id="print.realtest_results_summary_+3A_...">...</code></td>
<td>
<p>currently ignored</p>
</td></tr>
<tr><td><code id="print.realtest_results_summary_+3A_object">object</code></td>
<td>
<p>list of objects of class <code>realtest_result</code>,
see <code><a href="#topic+E">E</a></code>.</p>
</td></tr>
<tr><td><code id="print.realtest_results_summary_+3A_label_pass">label_pass</code></td>
<td>
<p>single string denoting the default name for
unnamed prototypes</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>print.realtest_results_summary</code> returns <code>x</code>, invisibly.
</p>
<p><code>summary.realtest_results</code> returns an object of class
<code>realtest_results_summary</code> which is a data frame summarising
the test results, featuring the following columns:
</p>

<ul>
<li> <p><code>call</code> &ndash; the name of the function tested,
</p>
</li>
<li> <p><code>match</code> &ndash; the name of the first matching prototype,
<code>label_pass</code> if it is unnamed or <code>label_fail</code> if
there is no match,
</p>
</li>
<li> <p><code>.file</code> (optional) &ndash; the name of the source file which
defined the expectation,
</p>
</li>
<li> <p><code>.line</code> (optional) &ndash; line number,
</p>
</li>
<li> <p><code>.expr</code> (optional) &ndash; source code of the whole tested expression.
</p>
</li></ul>



<h3>Author(s)</h3>

<p><a href="https://www.gagolewski.com/">Marek Gagolewski</a>
</p>


<h3>See Also</h3>

<p>The official online manual of <span class="pkg">realtest</span> at <a href="https://realtest.gagolewski.com/">https://realtest.gagolewski.com/</a>
</p>
<p>Related functions:
<code><a href="#topic+test_dir">test_dir</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># r &lt;- test_dir("~/R/realtest/inst/realtest")  # some path
# s &lt;- summary(r)  # summary.realtest_results
# print(s)  # print.realtest_results_summary
# stopifnot(!any(s[["match"]]=="fail"))  # halt if there are failed tests

</code></pre>

<hr>
<h2 id='R'>Create a Result Descriptor by Recording Effects of an Expression Evaluation</h2><span id='topic+R'></span>

<h3>Description</h3>

<p>Evaluates an expression and records its direct and indirect effects:
the resulting value as well as the information whether any errors,
warnings, or messages are generated and if anything is printed on
<code><a href="base.html#topic+stdout">stdout</a></code> or <code><a href="base.html#topic+stderr">stderr</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R(expr, ..., envir = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="R_+3A_expr">expr</code></td>
<td>
<p>expression to be evaluated</p>
</td></tr>
<tr><td><code id="R_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code><a href="#topic+P">P</a></code></p>
</td></tr>
<tr><td><code id="R_+3A_envir">envir</code></td>
<td>
<p>environment where <code>expr</code> is to be evaluated</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that messages, warnings, and errors are typically written to
<code><a href="base.html#topic+stderr">stderr</a></code>, but these are considered separately here.
In other words, when testing expectations with <code><a href="#topic+E">E</a></code>,
e.g., the reference <code>stderr</code> should not include the anticipated
diagnostic messages.
</p>
<p>There may be other side effects, such as changing the state of
the random number generator, modifying options or environment variables,
modifying the calling or global environment (e.g., creating new global
variables), attaching objects onto the search part (e.g., loading
package namespaces), or plotting, but these will not be captured,
at least, not by the current version of the <span class="pkg">realtest</span> package.
</p>


<h3>Value</h3>

<p>A list of class <code>realtest_descriptor</code>,
see <code><a href="#topic+P">P</a></code>, which this function calls.
The additional named component <code>expr</code> gives the
expression that generated the <code>value</code>.
Moreover, <code>args</code> gives a named list of objects
that appeared in <code>expr</code> (not including functions called).
</p>
<p>If an effect of particular kind does not occur,
it is not included in the resulting list.
<code>stdout</code>, <code>stderr</code>, and <code>error</code> are at most single strings.
</p>
<p>When an error occurs, <code>value</code> is <code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p><a href="https://www.gagolewski.com/">Marek Gagolewski</a>
</p>


<h3>See Also</h3>

<p>The official online manual of <span class="pkg">realtest</span> at <a href="https://realtest.gagolewski.com/">https://realtest.gagolewski.com/</a>
</p>
<p>Related functions:
<code><a href="#topic+E">E</a></code>, <code><a href="#topic+P">P</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;- 1:10; R(sum(y^2))
R(cat("a bit talkative, innit?"))
R(sqrt(c(-1, 0, 1, 2, 4)))
R(log("aaaargh"))
R({
    cat("STDOUT"); cat("STDERR", file=stderr()); message("MESSAGE");
    warning("WARNING"); warning("WARNING AGAIN"); cat("MORE STDOUT");
    message("ANOTHER MESSAGE"); stop("ERROR"); y; "NO RETURN VALUE"
})

</code></pre>

<hr>
<h2 id='source2'>Read and Evaluate Code from an R Script</h2><span id='topic+source2'></span>

<h3>Description</h3>

<p>A simplified alternative to <code><a href="base.html#topic+source">source</a></code>,
which additionally sets some environment variables whilst
executing a series of expressions to ease debugging.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>source2(file, local = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="source2_+3A_file">file</code></td>
<td>
<p>usually a file name, see <code><a href="base.html#topic+parse">parse</a></code></p>
</td></tr>
<tr><td><code id="source2_+3A_local">local</code></td>
<td>
<p>specifies the environment where expressions
will be evaluated, see <code><a href="base.html#topic+source">source</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function sets/updates the following environment variables while
evaluating consecutive expressions:
</p>

<ul>
<li> <p><code>__FILE__</code> &ndash; path to the current file,
</p>
</li>
<li> <p><code>__LINE__</code> &ndash; line number where the currently executed
expression begins,
</p>
</li>
<li> <p><code>__EXPR__</code> &ndash; source code defining the expression.
</p>
</li></ul>



<h3>Value</h3>

<p>This function returns nothing.
</p>


<h3>Author(s)</h3>

<p><a href="https://www.gagolewski.com/">Marek Gagolewski</a>
</p>


<h3>See Also</h3>

<p>The official online manual of <span class="pkg">realtest</span> at <a href="https://realtest.gagolewski.com/">https://realtest.gagolewski.com/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# example error handler - report source file and line number
old_option_error &lt;- getOption("error")
options(error=function()
   cat(sprintf(
       "Error in %s:%s.\n", Sys.getenv("__FILE__"), Sys.getenv("__LINE__")
   ), file=stderr()))
# now call source2() to execute an R script that throws some errors...
options(error=old_option_error)  # cleanup


</code></pre>

<hr>
<h2 id='test_dir'>Gather All Test Results From R Scripts</h2><span id='topic+test_dir'></span>

<h3>Description</h3>

<p>Executes all R scripts in a given directory whose names match a given
pattern and gathers all test result in a single list,
which you can process however you desire.
</p>
<p>The function does not fail if some tests are not met &ndash; you need
to detect this yourself.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_dir(
  path = "tests",
  pattern = "^realtest-.*\\.R$",
  recursive = FALSE,
  ignore.case = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_dir_+3A_path">path</code></td>
<td>
<p>directory with scripts to execute</p>
</td></tr>
<tr><td><code id="test_dir_+3A_pattern">pattern</code></td>
<td>
<p>regular expression specifying the file names to execute</p>
</td></tr>
<tr><td><code id="test_dir_+3A_recursive">recursive</code></td>
<td>
<p>logical, see <code><a href="base.html#topic+list.files">list.files</a></code></p>
</td></tr>
<tr><td><code id="test_dir_+3A_ignore.case">ignore.case</code></td>
<td>
<p>logical, see <code><a href="base.html#topic+list.files">list.files</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of all test results
(of class <code>realtest_results</code>),
each being an object of class <code>realtest_result</code>, see <code><a href="#topic+E">E</a></code>,
with additional fields <code>.file</code>, <code>.line</code>, and <code>.expr</code>,
giving the location and the source code of the test instance.
</p>


<h3>Author(s)</h3>

<p><a href="https://www.gagolewski.com/">Marek Gagolewski</a>
</p>


<h3>See Also</h3>

<p>The official online manual of <span class="pkg">realtest</span> at <a href="https://realtest.gagolewski.com/">https://realtest.gagolewski.com/</a>
</p>
<p>Related functions:
<code><a href="#topic+source2">source2</a></code>, <code><a href="#topic+summary.realtest_results">summary.realtest_results</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># r &lt;- test_dir("~/R/realtest/inst/realtest")  # some path
# s &lt;- summary(r)  # summary.realtest_results
# print(s)  # print.realtest_results_summary
# stopifnot(!any(s[["match"]]=="fail"))  # halt if there are failed tests

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
