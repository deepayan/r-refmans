<!DOCTYPE html><html><head><title>Help for package vismeteor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {vismeteor}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#vismeteor-package'><p>vismeteor: Analysis of Visual Meteor Data</p></a></li>
<li><a href='#freq.quantile'><p>Quantiles with a minimum frequency</p></a></li>
<li><a href='#load_vmdb'><p>Loading visual meteor observations from the data base</p></a></li>
<li><a href='#mideal'><p>Ideal distributed meteor magnitudes</p></a></li>
<li><a href='#PER_2015_magn'><p>Visual magnitude observations of Perseids from 2015</p></a></li>
<li><a href='#PER_2015_rates'><p>Visual rate observations of Perseids from 2015</p></a></li>
<li><a href='#vmgeom'><p>Visual magnitude distribution of geometric distributed meteor magnitudes</p></a></li>
<li><a href='#vmideal'><p>Visual magnitude distribution of ideal distributed meteor magnitudes</p></a></li>
<li><a href='#vmperception'><p>Perception Probabilities of Visual Meteor Magnitudes</p></a></li>
<li><a href='#vmperception.l'><p>Laplace-Transformed Perception Probabilities of Visual Meteor Magnitudes</p></a></li>
<li><a href='#vmtable'><p>Rounds a contingency table of meteor magnitude frequencies</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Visual Meteor Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.8.5</td>
</tr>
<tr>
<td>Author:</td>
<td>Janko Richter [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Janko Richter &lt;janko@richtej.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a suite of analytical functionalities to process and analyze
    visual meteor observations from the Visual Meteor Database
    of the International Meteor Organization <a href="https://www.imo.net/">https://www.imo.net/</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jankorichter/vismeteor">https://github.com/jankorichter/vismeteor</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jankorichter/vismeteor/issues">https://github.com/jankorichter/vismeteor/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, stats, DBI</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.0</td>
</tr>
<tr>
<td>Suggests:</td>
<td>usethis (&ge; 2.1.1), testthat (&ge; 3.0.0), RSQLite (&ge; 2.2.1),
RPostgreSQL (&ge; 0.7), RMySQL (&ge; 0.10.1), knitr, rmarkdown</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-15 19:19:18 UTC; j.richter</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-16 14:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='vismeteor-package'>vismeteor: Analysis of Visual Meteor Data</h2><span id='topic+vismeteor'></span><span id='topic+vismeteor-package'></span>

<h3>Description</h3>

<p>Provides a suite of analytical functionalities to process and analyze visual meteor observations from the Visual Meteor Database of the International Meteor Organization <a href="https://www.imo.net/">https://www.imo.net/</a>.
</p>


<h3>Details</h3>

<p>The data used in this package can created and provided by
<a href="https://pypi.org/project/imo-vmdb/">imo-vmdb</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Janko Richter <a href="mailto:janko@richtej.de">janko@richtej.de</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/jankorichter/vismeteor">https://github.com/jankorichter/vismeteor</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/jankorichter/vismeteor/issues">https://github.com/jankorichter/vismeteor/issues</a>
</p>
</li></ul>


<hr>
<h2 id='freq.quantile'>Quantiles with a minimum frequency</h2><span id='topic+freq.quantile'></span>

<h3>Description</h3>

<p>This function generates quantiles with a minimum frequency.
These quantiles are formed from a vector <code>freq</code> of frequencies.
Each quantile then has the minimum total frequency <code>min</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>freq.quantile(freq, min)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="freq.quantile_+3A_freq">freq</code></td>
<td>
<p>integer; A vector of frequencies.</p>
</td></tr>
<tr><td><code id="freq.quantile_+3A_min">min</code></td>
<td>
<p>integer; Minimum total frequency per quantile.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The frequencies <code>freq</code> are grouped in the order in which they
are passed as a vector.
The minimum <code>min</code> must be greater than <code>0</code>.
</p>


<h3>Value</h3>

<p>A factor of indices is returned.
The index references the corresponding passed frequency <code>freq</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>freq &lt;- c(1,2,3,4,5,6,7,8,9)
cumsum(freq)
(f &lt;- freq.quantile(freq, 10))
tapply(freq, f, sum)
</code></pre>

<hr>
<h2 id='load_vmdb'>Loading visual meteor observations from the data base</h2><span id='topic+load_vmdb'></span><span id='topic+load_vmdb_rates'></span><span id='topic+load_vmdb_magnitudes'></span>

<h3>Description</h3>

<p>Loads the data of visual meteor observations from a data base created with
<a href="https://pypi.org/project/imo-vmdb/">imo-vmdb</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_vmdb_rates(
  dbcon,
  shower = NULL,
  period = NULL,
  sl = NULL,
  lim.magn = NULL,
  sun.alt.max = NULL,
  moon.alt.max = NULL,
  session.id = NULL,
  rate.id = NULL,
  withSessions = FALSE,
  withMagnitudes = FALSE
)

load_vmdb_magnitudes(
  dbcon,
  shower = NULL,
  period = NULL,
  sl = NULL,
  lim.magn = NULL,
  session.id = NULL,
  magn.id = NULL,
  withSessions = FALSE,
  withMagnitudes = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_vmdb_+3A_dbcon">dbcon</code></td>
<td>
<p>database connection.</p>
</td></tr>
<tr><td><code id="load_vmdb_+3A_shower">shower</code></td>
<td>
<p>character; selects by meteor shower codes.
<code>NA</code> loads sporadic meteors.</p>
</td></tr>
<tr><td><code id="load_vmdb_+3A_period">period</code></td>
<td>
<p>time; selects a time range by minimum/maximum.</p>
</td></tr>
<tr><td><code id="load_vmdb_+3A_sl">sl</code></td>
<td>
<p>numeric; selects a range of solar longitudes by minimum/maximum.</p>
</td></tr>
<tr><td><code id="load_vmdb_+3A_lim.magn">lim.magn</code></td>
<td>
<p>numeric; selects a range of limiting magnitudes by minimum/maximum.</p>
</td></tr>
<tr><td><code id="load_vmdb_+3A_sun.alt.max">sun.alt.max</code></td>
<td>
<p>numeric; selects the maximum altitude of the sun.</p>
</td></tr>
<tr><td><code id="load_vmdb_+3A_moon.alt.max">moon.alt.max</code></td>
<td>
<p>numeric; selects the maximum altitude of the moon.</p>
</td></tr>
<tr><td><code id="load_vmdb_+3A_session.id">session.id</code></td>
<td>
<p>integer; selects by session ids.</p>
</td></tr>
<tr><td><code id="load_vmdb_+3A_rate.id">rate.id</code></td>
<td>
<p>integer; selects rate observations by ids.</p>
</td></tr>
<tr><td><code id="load_vmdb_+3A_withsessions">withSessions</code></td>
<td>
<p>logical; if <code>TRUE</code>, also load the corresponding session data.</p>
</td></tr>
<tr><td><code id="load_vmdb_+3A_withmagnitudes">withMagnitudes</code></td>
<td>
<p>logical; if <code>TRUE</code>, also load the corresponding magnitude observations.</p>
</td></tr>
<tr><td><code id="load_vmdb_+3A_magn.id">magn.id</code></td>
<td>
<p>integer; selects magnitude observations by ids.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>sl</code>, <code>period</code> and <code>lim.magn</code> expect a vector with successive minimum and maximum values.
<code>sun.alt.max</code> and <code>moon.alt.max</code> are expected to be scalar values.
</p>


<h3>Value</h3>

<p>Both functions return a list, with
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>observations</code> </td><td style="text-align: left;"> data frame, rate or magnitude observations,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>sessions</code> </td><td style="text-align: left;"> data frame; session data of observations,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>magnitudes</code> </td><td style="text-align: left;"> table; contingency table of meteor magnitude frequencies.
</td>
</tr>

</table>

<p><code>observations</code> depends on the function call. <code>load_vmdb_rates</code> returns a data frame, with
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>rate.id</code> </td><td style="text-align: left;"> unique identifier of the rate observation,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>shower.code</code> </td><td style="text-align: left;"> IAU code of the shower. It is <code>NA</code> in case of sporadic meteors.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>period.start</code> </td><td style="text-align: left;"> start of observation,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>period.end</code> </td><td style="text-align: left;"> end of observation,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>sl.start</code> </td><td style="text-align: left;"> solarlong at start of observation,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>sl.end</code> </td><td style="text-align: left;"> solarlong at start of observation,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>session.id</code> </td><td style="text-align: left;"> reference to the session,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>freq</code> </td><td style="text-align: left;"> count of observed meteors,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>lim.magn</code> </td><td style="text-align: left;"> limiting magnitude,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>t.eff</code> </td><td style="text-align: left;"> net observed time in hours,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>f</code> </td><td style="text-align: left;"> correction factor of cloud cover,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>time.sidereal</code> </td><td style="text-align: left;"> sidereal time,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>sun.alt</code> </td><td style="text-align: left;"> altitude of the sun,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>sun.az</code> </td><td style="text-align: left;"> azimuth of the sun,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>moon.alt</code> </td><td style="text-align: left;"> altitude of the moon,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>moon.az</code> </td><td style="text-align: left;"> azimuth of the moon,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>moon.illum</code> </td><td style="text-align: left;"> illumination of the moon (<code style="white-space: pre;">&#8288;0.0 .. 1.0&#8288;</code>),</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>field.alt</code> </td><td style="text-align: left;"> altitude of the field of view (optional),</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>field.az</code> </td><td style="text-align: left;"> azimuth of the field of view (optional),</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>radiant.alt</code> </td><td style="text-align: left;"> altitude of the radiant (optional). The zenith attraction is already applied.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>radiant.az</code> </td><td style="text-align: left;"> azimuth of the radiant (optional),</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>magn.id</code> </td><td style="text-align: left;"> reference to the magnitude observations (optional).
</td>
</tr>

</table>

<p><code>load_vmdb_magnitudes</code> returns a <code>observations</code> data frame, with
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>magn.id</code> </td><td style="text-align: left;"> unique identifier of the magnitude observation,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>shower.code</code> </td><td style="text-align: left;"> IAU code of the shower. It is <code>NA</code> in case of sporadic meteors.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>period.start</code> </td><td style="text-align: left;"> start of observation,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>period.end</code> </td><td style="text-align: left;"> end of observation,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>sl.start</code> </td><td style="text-align: left;"> solarlong at start of observation,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>sl.end</code> </td><td style="text-align: left;"> solarlong at start of observation,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>session.id</code> </td><td style="text-align: left;"> reference to the session,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>freq</code> </td><td style="text-align: left;"> count of observed meteors,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>magn.mean</code> </td><td style="text-align: left;"> mean of magnitudes,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>lim.magn</code> </td><td style="text-align: left;"> limiting magnitude (optional).
</td>
</tr>

</table>

<p>The <code>sessions</code> data frame contains
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>session.id</code> </td><td style="text-align: left;"> unique identifier of the session,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>longitude</code> </td><td style="text-align: left;"> location’s longitude,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>latitude</code> </td><td style="text-align: left;"> location’s latitude,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>elevation</code> </td><td style="text-align: left;"> height above mean sea level in km,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>country</code> </td><td style="text-align: left;"> country name,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>location.name</code> </td><td style="text-align: left;"> location name,</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>observer.id</code> </td><td style="text-align: left;"> observer id (optional),</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>observer.name</code> </td><td style="text-align: left;"> observer name (optional).
</td>
</tr>

</table>

<p><code>magnitudes</code> is a contingency table of meteor magnitude frequencies.
The row names refer to the id of magnitude observations.
The column names refer to the magnitude.
</p>


<h3>Note</h3>

<p>Angle values are expected and returned in degrees.
</p>


<h3>References</h3>

<p><a href="https://pypi.org/project/imo-vmdb/">https://pypi.org/project/imo-vmdb/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# create a connection to the data base
con &lt;- dbConnect(
    PostgreSQL(),
    dbname = "vmdb",
    host = "localhost",
    user = "vmdb"
)

# load rate observations including
# session data and magnitude observations
data &lt;- load_vmdb_rates(
    con,
    shower = 'PER',
    sl = c(135.5, 145.5),
    period = c('2015-08-01', '2015-08-31'),
    lim.magn = c(5.3, 6.7),
    withMagnitudes = TRUE,
    withSessions = TRUE
)

# load magnitude observations including
# session data and magnitude observations
data &lt;- load_vmdb_magnitudes(
    con,
    shower = 'PER',
    sl = c(135.5, 145.5),
    period = c('2015-08-01', '2015-08-31'),
    lim.magn = c(5.3, 6.7),
    withMagnitudes = TRUE,
    withSessions = TRUE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='mideal'>Ideal distributed meteor magnitudes</h2><span id='topic+mideal'></span><span id='topic+dmideal'></span><span id='topic+pmideal'></span><span id='topic+qmideal'></span><span id='topic+rmideal'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation
of ideal distributed meteor magnitudes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmideal(m, psi = 0, log = FALSE)

pmideal(m, psi = 0, lower.tail = TRUE, log = FALSE)

qmideal(p, psi = 0, lower.tail = TRUE)

rmideal(n, psi = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mideal_+3A_m">m</code></td>
<td>
<p>numeric; meteor magnitude.</p>
</td></tr>
<tr><td><code id="mideal_+3A_psi">psi</code></td>
<td>
<p>numeric; the location parameter of a probability distribution.
It is the only parameter of the distribution.</p>
</td></tr>
<tr><td><code id="mideal_+3A_log">log</code></td>
<td>
<p>logical; if <code>TRUE</code>, probabilities p are given as <code>log(p)</code>.</p>
</td></tr>
<tr><td><code id="mideal_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if <code>TRUE</code> (default) probabilities are
<code class="reqn">P[M \le m]</code>, otherwise, <code class="reqn">P[M &gt; m]</code>.</p>
</td></tr>
<tr><td><code id="mideal_+3A_p">p</code></td>
<td>
<p>numeric; probability.</p>
</td></tr>
<tr><td><code id="mideal_+3A_n">n</code></td>
<td>
<p>numeric; count of meteor magnitudes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The density of an ideal magnitude distribution is
</p>
<p style="text-align: center;"><code class="reqn">
    {\displaystyle \frac{\mathrm{d}p}{\mathrm{d}m} = \frac{3}{2} \, \log(r) \sqrt{\frac{r^{3 \, \psi + 2 \, m}}{(r^\psi + r^m)^5}}}
</code>
</p>

<p>where <code class="reqn">m</code> is the meteor magnitude, <code class="reqn">r = 10^{0.4} \approx 2.51189 \dots</code> is a constant and
<code class="reqn">\psi</code> is the only parameter of this magnitude distribution.
</p>


<h3>Value</h3>

<p><code>dmideal</code> gives the density, <code>pmideal</code> gives the distribution function,
<code>qmideal</code> gives the quantile function and <code>rmideal</code> generates random deviates.
</p>
<p>The length of the result is determined by <code>n</code> for <code>rmideal</code>, and is the maximum
of the lengths of the numerical vector arguments for the other functions.
</p>
<p><code>qmideal</code> can return <code>NaN</code> value with a warning.
</p>


<h3>References</h3>

<p>Richter, J. (2018) <em>About the mass and magnitude distributions of meteor showers</em>.
WGN, Journal of the International Meteor Organization, vol. 46, no. 1, p. 34-38
</p>


<h3>Examples</h3>

<pre><code class='language-R'>old_par &lt;- par(mfrow = c(2,2))
psi &lt;- 5.0
plot(
    function(m) dmideal(m, psi, log = FALSE),
    -5, 10,
    main = paste0('density of ideal meteor magnitude\ndistribution (psi = ', psi, ')'),
    col = "blue",
    xlab = 'm',
    ylab = 'dp/dm'
)
abline(v=psi, col="red")

plot(
    function(m) dmideal(m, psi, log = TRUE),
    -5, 10,
    main = paste0('density of ideal meteor magnitude\ndistribution (psi = ', psi, ')'),
    col = "blue",
    xlab = 'm',
    ylab = 'log( dp/dm )'
)
abline(v=psi, col="red")

plot(
    function(m) pmideal(m, psi),
    -5, 10,
    main = paste0('probability of ideal meteor magnitude\ndistribution (psi = ', psi, ')'),
    col = "blue",
    xlab = 'm',
    ylab = 'p'
)
abline(v=psi, col="red")

plot(
    function(p) qmideal(p, psi),
    0.01, 0.99,
    main = paste('quantile of ideal meteor magnitude\n distribution (psi = ', psi, ')'),
    col = "blue",
    xlab = 'p',
    ylab = 'm'
)
abline(h=psi, col="red")

# generate random meteor magnitudes
m &lt;- rmideal(1000, psi)

# log likelihood function
llr &lt;- function(psi) {
    -sum(dmideal(m, psi, log=TRUE))
}

# maximum likelihood estimation (MLE) of psi
est &lt;- optim(2, llr, method='Brent', lower=0, upper=8, hessian=TRUE)

# estimations
est$par # mean of psi
sqrt(1/est$hessian[1][1]) # standard deviation of psi

par(old_par)
</code></pre>

<hr>
<h2 id='PER_2015_magn'>Visual magnitude observations of Perseids from 2015</h2><span id='topic+PER_2015_magn'></span>

<h3>Description</h3>

<p>Visual magnitude observations of the Perseid shower from 2015.
</p>


<h3>Details</h3>

<p><code>PER_2015_magn</code> are magnitude observations loaded with
<a href="#topic+load_vmdb_magnitudes">load_vmdb_magnitudes</a>.
</p>


<h3>See Also</h3>

<p><a href="#topic+load_vmdb">load_vmdb</a>
</p>

<hr>
<h2 id='PER_2015_rates'>Visual rate observations of Perseids from 2015</h2><span id='topic+PER_2015_rates'></span>

<h3>Description</h3>

<p>Visual rate and magnitude observations of the Perseid shower from 2015.
</p>


<h3>Details</h3>

<p><code>PER_2015_rates</code> are rate observations loaded with <a href="#topic+load_vmdb_rates">load_vmdb_rates</a>.
</p>


<h3>See Also</h3>

<p><a href="#topic+load_vmdb">load_vmdb</a>
</p>

<hr>
<h2 id='vmgeom'>Visual magnitude distribution of geometric distributed meteor magnitudes</h2><span id='topic+vmgeom'></span><span id='topic+dvmgeom'></span><span id='topic+pvmgeom'></span><span id='topic+qvmgeom'></span><span id='topic+rvmgeom'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the
visual magnitude distribution of geometric distributed meteor magnitudes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dvmgeom(m, lm, r, log = FALSE, perception.fun = NULL)

pvmgeom(m, lm, r, lower.tail = TRUE, log = FALSE, perception.fun = NULL)

qvmgeom(p, lm, r, lower.tail = TRUE, perception.fun = NULL)

rvmgeom(n, lm, r, perception.fun = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vmgeom_+3A_m">m</code></td>
<td>
<p>numeric; the meteor magnitude.</p>
</td></tr>
<tr><td><code id="vmgeom_+3A_lm">lm</code></td>
<td>
<p>numeric; limiting magnitude.</p>
</td></tr>
<tr><td><code id="vmgeom_+3A_r">r</code></td>
<td>
<p>numeric; the population index. It is the only parameter of the distribution.</p>
</td></tr>
<tr><td><code id="vmgeom_+3A_log">log</code></td>
<td>
<p>logical; if <code>TRUE</code>, probabilities p are given as <code>log(p)</code>.</p>
</td></tr>
<tr><td><code id="vmgeom_+3A_perception.fun">perception.fun</code></td>
<td>
<p>function; perception probability function (optional).
Default is <a href="#topic+vmperception">vmperception</a>.</p>
</td></tr>
<tr><td><code id="vmgeom_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if <code>TRUE</code> (default) probabilities are
<code class="reqn">P[M &lt; m]</code>, otherwise, <code class="reqn">P[M \ge m]</code>.</p>
</td></tr>
<tr><td><code id="vmgeom_+3A_p">p</code></td>
<td>
<p>numeric; probability.</p>
</td></tr>
<tr><td><code id="vmgeom_+3A_n">n</code></td>
<td>
<p>numeric; count of meteor magnitudes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In visual meteor observation, it is common to estimate meteor magnitudes in integer values.
Hence, this distribution is discrete and has the density
</p>
<p style="text-align: center;"><code class="reqn">
    {\displaystyle P[X = x] \sim f(x) \, \mathrm r^{-x}} \,\mathrm{,}
</code>
</p>

<p>where <code class="reqn">x \ge -0.5</code> is the difference between the limiting magnitude <code>lm</code>
and the meteor magnitude <code>m</code> and <code class="reqn">f(x)</code> is the perception probability function.
This distribution is thus a product of the
<a href="#topic+vmperception">perception probabilities</a> and the
actual <a href="stats.html#topic+Geometric">geometric distribution</a> of the meteor magnitudes.
Therefore, the parameter <code>p</code> of the geometric distribution is <code>p = 1 - 1/r</code>.
</p>
<p>The parameter <code>lm</code> indicate what the parameter <code>m</code> refers to.
<code>m</code> must be an integer meteor magnitude.
The length of the vector <code>lm</code> must then be equal to the length of the vector <code>m</code>
or <code>lm</code> is a scalar value.
In case of <code>rvmgeom</code>, the length of the vector <code>lm</code> must be <code>n</code> or <code>lm</code> is a scalar value.
</p>
<p>If the perception probabilities function <code>perception.fun</code> is given,
it must have the signature <code style="white-space: pre;">&#8288;function(x)&#8288;</code> and must return the perception probabilities of
the difference <code>x</code> between the limiting magnitude and the meteor magnitude.
If <code>x &gt;= 15.0</code>, the <code>perception.fun</code> function should return the perception probability of <code>1.0</code>.
If <code>log = TRUE</code> is given, the logarithm value of the perception probabilities
must be returned. <code>perception.fun</code> is resolved using <a href="base.html#topic+match.fun">match.fun</a>.
</p>


<h3>Value</h3>

<p><code>dvmgeom</code> gives the density, <code>pvmgeom</code> gives the distribution function,
<code>qvmgeom</code> gives the quantile function, and <code>rvmgeom</code> generates random deviates.
</p>
<p>The length of the result is determined by <code>n</code> for <code>rvmgeom</code>, and is the maximum
of the lengths of the numerical vector arguments for the other functions.
</p>
<p>Since the distribution is discrete, <code>qvmgeom</code> and <code>rvmgeom</code> always return integer values.
<code>qvmgeom</code> can return <code>NaN</code> value with a warning.
</p>


<h3>See Also</h3>

<p><a href="#topic+vmperception">vmperception</a>
<a href="stats.html#topic+Geometric">stats::Geometric</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N &lt;- 100
r &lt;- 2.0
limmag &lt;- 6.5
(m &lt;- seq(6, -7))

# discrete density of `N` meteor magnitudes
(freq &lt;- round(N * dvmgeom(m, limmag, r)))

# log likelihood function
lld &lt;- function(r) {
    -sum(freq * dvmgeom(m, limmag, r, log=TRUE))
}

# maximum likelihood estimation (MLE) of r
est &lt;- optim(2, lld, method='Brent', lower=1.1, upper=4)

# estimations
est$par # mean of r

# generate random meteor magnitudes
m &lt;- rvmgeom(N, r, lm=limmag)

# log likelihood function
llr &lt;- function(r) {
    -sum(dvmgeom(m, limmag, r, log=TRUE))
}

# maximum likelihood estimation (MLE) of r
est &lt;- optim(2, llr, method='Brent', lower=1.1, upper=4, hessian=TRUE)

# estimations
est$par # mean of r
sqrt(1/est$hessian[1][1]) # standard deviation of r

m &lt;- seq(6, -4, -1)
p &lt;- vismeteor::dvmgeom(m, limmag, r)
barplot(
    p,
    names.arg = m,
    main = paste0('Density (r = ', r, ', limmag = ', limmag, ')'),
    col = "blue",
    xlab = 'm',
    ylab = 'p',
    border = "blue",
    space = 0.5
)
axis(side = 2, at = pretty(p))
</code></pre>

<hr>
<h2 id='vmideal'>Visual magnitude distribution of ideal distributed meteor magnitudes</h2><span id='topic+vmideal'></span><span id='topic+dvmideal'></span><span id='topic+pvmideal'></span><span id='topic+qvmideal'></span><span id='topic+rvmideal'></span><span id='topic+cvmideal'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the
visual magnitude distribution of ideal distributed meteor magnitudes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dvmideal(m, lm, psi, log = FALSE, perception.fun = NULL)

pvmideal(m, lm, psi, lower.tail = TRUE, log = FALSE, perception.fun = NULL)

qvmideal(p, lm, psi, lower.tail = TRUE, perception.fun = NULL)

rvmideal(n, lm, psi, perception.fun = NULL)

cvmideal(lm, psi, log = FALSE, perception.fun = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vmideal_+3A_m">m</code></td>
<td>
<p>integer; visual meteor magnitude.</p>
</td></tr>
<tr><td><code id="vmideal_+3A_lm">lm</code></td>
<td>
<p>numeric; limiting magnitude.</p>
</td></tr>
<tr><td><code id="vmideal_+3A_psi">psi</code></td>
<td>
<p>numeric; the location parameter of a probability distribution.
It is the only parameter of the distribution.</p>
</td></tr>
<tr><td><code id="vmideal_+3A_log">log</code></td>
<td>
<p>logical; if <code>TRUE</code>, probabilities p are given as <code>log(p)</code>.</p>
</td></tr>
<tr><td><code id="vmideal_+3A_perception.fun">perception.fun</code></td>
<td>
<p>function; perception probability function (optional).
Default is <a href="#topic+vmperception">vmperception</a>.</p>
</td></tr>
<tr><td><code id="vmideal_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if <code>TRUE</code> (default) probabilities are
<code class="reqn">P[M &lt; m]</code>, otherwise, <code class="reqn">P[M \ge m]</code>.</p>
</td></tr>
<tr><td><code id="vmideal_+3A_p">p</code></td>
<td>
<p>numeric; probability.</p>
</td></tr>
<tr><td><code id="vmideal_+3A_n">n</code></td>
<td>
<p>numeric; count of meteor magnitudes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The density of an <a href="#topic+mideal">ideal magnitude distribution</a> is
</p>
<p style="text-align: center;"><code class="reqn">
    {\displaystyle f(m) = \frac{\mathrm{d}p}{\mathrm{d}m} = \frac{3}{2} \, \log(r) \sqrt{\frac{r^{3 \, \psi + 2 \, m}}{(r^\psi + r^m)^5}}}
</code>
</p>

<p>where <code class="reqn">m</code> is the meteor magnitude, <code class="reqn">r = 10^{0.4} \approx 2.51189 \dots</code> is a constant and
<code class="reqn">\psi</code> is the only parameter of this magnitude distribution.
</p>
<p>In visual meteor observation, it is common to estimate meteor magnitudes in integer values.
Hence, this distribution is discrete and has the density
</p>
<p style="text-align: center;"><code class="reqn">
   {\displaystyle P[M = m] \sim g(m) \, \int_{m-0.5}^{m+0.5} f(m) \, \, \mathrm{d}m} \, \mathrm{,}
</code>
</p>

<p>where <code class="reqn">g(m)</code> is the perception probability.
This distribution is thus a product of the
<a href="#topic+vmperception">perception probabilities</a> and the
actual <a href="#topic+mideal">ideal distribution</a> of the meteor magnitudes.
</p>
<p>If the perception probabilities function <code>perception.fun</code> is given,
it must have the signature <code style="white-space: pre;">&#8288;function(M)&#8288;</code> and must return the perception probabilities of
the difference <code>M</code> between the limiting magnitude and the meteor magnitude.
If <code>m &gt;= 15.0</code>, the <code>perception.fun</code> function should return the perception probability of <code>1.0</code>.
If <code>log = TRUE</code> is given, the logarithm value of the perception probabilities
must be returned. <code>perception.fun</code> is resolved using <a href="base.html#topic+match.fun">match.fun</a>.
</p>


<h3>Value</h3>

<p><code>dvmideal</code> gives the density, <code>pvmideal</code> gives the distribution function,
<code>qvmideal</code> gives the quantile function, and <code>rvmideal</code> generates random deviates.
<code>cvmideal</code> gives the partial convolution of the ideal meteor magnitude distribution
with the perception probabilities.
</p>
<p>The length of the result is determined by <code>n</code> for <code>rvmideal</code>, and is the maximum
of the lengths of the numerical vector arguments for the other functions.
</p>
<p>Since the distribution is discrete, <code>qvmideal</code> and <code>rvmideal</code> always return integer values.
<code>qvmideal</code> can return <code>NaN</code> value with a warning.
</p>


<h3>References</h3>

<p>Richter, J. (2018) <em>About the mass and magnitude distributions of meteor showers</em>.
WGN, Journal of the International Meteor Organization, vol. 46, no. 1, p. 34-38
</p>


<h3>See Also</h3>

<p><a href="#topic+mideal">mideal</a>
<a href="#topic+vmperception">vmperception</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N &lt;- 100
psi &lt;- 5.0
limmag &lt;- 6.5
(m &lt;- seq(6, -4))

# discrete density of `N` meteor magnitudes
(freq &lt;- round(N * dvmideal(m, limmag, psi)))

# log likelihood function
lld &lt;- function(psi) {
    -sum(freq * dvmideal(m, limmag, psi, log=TRUE))
}

# maximum likelihood estimation (MLE) of psi
est &lt;- optim(2, lld, method='Brent', lower=0, upper=8, hessian=TRUE)

# estimations
est$par # mean of psi

# generate random meteor magnitudes
m &lt;- rvmideal(N, limmag, psi)

# log likelihood function
llr &lt;- function(psi) {
    -sum(dvmideal(m, limmag, psi, log=TRUE))
}

# maximum likelihood estimation (MLE) of psi
est &lt;- optim(2, llr, method='Brent', lower=0, upper=8, hessian=TRUE)

# estimations
est$par # mean of psi
sqrt(1/est$hessian[1][1]) # standard deviation of psi

m &lt;- seq(6, -4, -1)
p &lt;- vismeteor::dvmideal(m, limmag, psi)
barplot(
    p,
    names.arg = m,
    main = paste0('Density (psi = ', psi, ', limmag = ', limmag, ')'),
    col = "blue",
    xlab = 'm',
    ylab = 'p',
    border = "blue",
    space = 0.5
)
axis(side = 2, at = pretty(p))

plot(
    function(lm) vismeteor::cvmideal(lm, psi, log = TRUE),
    -5, 10,
    main = paste0(
        'Partial convolution of the ideal meteor magnitude distribution\n',
        'with the perception probabilities (psi = ', psi, ')'
    ),
    col = "blue",
    xlab = 'lm',
    ylab = 'log(rate)'
)
</code></pre>

<hr>
<h2 id='vmperception'>Perception Probabilities of Visual Meteor Magnitudes</h2><span id='topic+vmperception'></span>

<h3>Description</h3>

<p>Provides the perception probability of visual meteor magnitudes and its first derivative.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vmperception(m, deriv.degree = 0L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vmperception_+3A_m">m</code></td>
<td>
<p>numerical; difference between the limiting magnitude and the meteor magnitude.</p>
</td></tr>
<tr><td><code id="vmperception_+3A_deriv.degree">deriv.degree</code></td>
<td>
<p>integer; degree of derivative of the perception probability.
Currently, valid values of <code>deriv.degree</code> are <code>0</code>, <code>1</code> and <code>2</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The perception probabilities of <em>Koschack R., Rendtel J., 1990b</em>
are estimated with the formula
</p>
<p style="text-align: center;"><code class="reqn">
    p(m) = \begin{cases}
        1.0 - \exp\left(-z(m + 0.5)\right)\  &amp; \text{ if } m &gt; -0.5,\\
        0.0 \  &amp; \text{ otherwise,}
    \end{cases}
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
z(x) = 0.003 \, x + 0.0056 \, x^2 + 0.0014 \, x^4
</code>
</p>

<p>and <code>m</code> is the difference between the limiting magnitude and the meteor magnitude.
</p>


<h3>Value</h3>

<p>This function returns the visual perception probabilities.
If <code>deriv.degree</code> is specified, it will return the <code>deriv.degree</code>-th order derivative
of the perception probability.
</p>


<h3>References</h3>

<p>Koschack R., Rendtel J., 1990b <em>Determination of spatial number density and mass index from visual meteor observations (II).</em> WGN 18, 119–140.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Perception probability of visually estimated meteor of magnitude 3.0
# with a limiting magnitude of 5.6.
vmperception(5.6 - 3.0)

# plot
old_par &lt;- par(mfrow = c(1,1))
plot(
    vmperception,
    -0.5, 8,
    main = paste(
        'perception probability of',
        'visual meteor magnitudes'
    ),
    col = "blue",
    xlab = 'm',
    ylab = 'p'
)
plot(
    function(m) {
        vmperception(m, deriv.degree=1L)/vmperception(m)
    },
    -0.3, 8,
    main = paste(
        'q-values of',
        'visual meteor magnitudes'
    ),
    col = "blue",
    log = 'y',
    xlab = 'm',
    ylab = 'q'
)

par(old_par)
</code></pre>

<hr>
<h2 id='vmperception.l'>Laplace-Transformed Perception Probabilities of Visual Meteor Magnitudes</h2><span id='topic+vmperception.l'></span>

<h3>Description</h3>

<p>Provides the Laplace-transformed perception probability of visual meteor magnitudes
and its first derivative.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vmperception.l(s, deriv.degree = 0L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vmperception.l_+3A_s">s</code></td>
<td>
<p>numerical; Real (non-complex) parameter for the Laplace transformation.</p>
</td></tr>
<tr><td><code id="vmperception.l_+3A_deriv.degree">deriv.degree</code></td>
<td>
<p>integer; degree of derivative of the transformation.
Currently, valid values of <code>deriv.degree</code> are <code>0</code>, <code>1</code> and <code>2</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Laplace-transformed <a href="#topic+vmperception">perception probabilities</a> <code>F(s)</code>, given as
</p>
<p style="text-align: center;"><code class="reqn">
F(s) = \mathcal{L} \left\{p\right\}(s)
= \int_{-0.5}^{\infty} \, f(m) \, \mathrm e^{-s \, m} \,\mathrm{d}m \,,
</code>
</p>

<p>are approximately
</p>
<p style="text-align: center;"><code class="reqn">
    P(s) = \begin{cases}
        s^{-1} \, \exp\left(-4.11 \, s + 1.32 \, s^2 - 0.15 \, s^3\right)\ &amp; \text{ if } s &gt;= 0.0,\\
        \text{undefined} \  &amp; \text{ otherwise.}
    \end{cases}
</code>
</p>

<p>Here, <code>m</code> is the difference between the limiting magnitude and the meteor magnitude,
and <code>f(m)</code> denotes the perception probabilities as a function of <code>m</code>.
The <code class="reqn">\mathcal{L}</code> recalls here the one-sided Laplace transform.
</p>
<p>The Laplace transform is notably effective for determining the mean and variance
of observed meteor magnitudes, which are measured relative to the limiting magnitude.
This is just one example of its application.
This approach is valid only when the actual magnitude distribution adheres
to <code class="reqn">p(m) \sim r^{-m}</code>, where <code class="reqn">s = \log(r)</code>.
In this scenario, the mean of the observable meteor magnitudes is given by
<code class="reqn">-\mathcal{L}'/\mathcal{L}</code>, and their variance is calculated as
<code class="reqn">\mathcal{L}''/\mathcal{L} - (\mathcal{L}'/\mathcal{L})^2</code>.
</p>


<h3>Value</h3>

<p>returns the Laplace-transformed perception probabilities.
If <code>deriv.degree</code> is specified, it will return the <code>deriv.degree</code>-th order derivative
of these Laplace-transformed values.
</p>


<h3>See Also</h3>

<p><a href="#topic+vmperception">vmperception</a>
<a href="#topic+vmgeom">vmgeom</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>r &lt;- 2.0
s &lt;- log(r)
F0 &lt;- vmperception.l(s)
F1 &lt;- vmperception.l(s, deriv.degree=1L)
# magnitude mean
-F1/F0
F2 &lt;- vmperception.l(s, deriv.degree=2L)
# magnitude variance
F2/F0 - (F1/F0)^2
# plot the Laplace-transformed perception probabilities
old_par &lt;- par(mfrow = c(1,1))
plot(
    vmperception.l,
    0.2, 1.1,
    main = paste(
        'Laplace-transformed perception',
        'probability of visual meteor magnitudes'
    ),
    col = "blue",
    log = 'y',
    xlab = 's',
    ylab = 'L'
)
par(old_par)
</code></pre>

<hr>
<h2 id='vmtable'>Rounds a contingency table of meteor magnitude frequencies</h2><span id='topic+vmtable'></span>

<h3>Description</h3>

<p>The meteor magnitude contingency table of VMDB contains half meteor counts (e.g. <code>3.5</code>).
This function converts these frequencies to integer values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vmtable(mt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vmtable_+3A_mt">mt</code></td>
<td>
<p>table; A two-dimensional contingency table of meteor magnitude frequencies.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The contingency table of meteor magnitudes <code>mt</code> must be two-dimensional.
The row names refer to the magnitude observations.
Column names must be integer meteor magnitude values.
Also, the columns must be sorted in ascending or descending order of meteor magnitude.
</p>
<p>A sum-preserving algorithm is used for rounding.
It ensures that the total frequency of meteors per observation is preserved.
The marginal frequencies of the magnitudes are also preserved with
the restriction that the deviation is at most <code class="reqn">\pm 0.5</code>.
If the total sum of a meteor magnitude is integer,
then the deviation is <code class="reqn">\pm 0</code>.
</p>
<p>The algorithm is asymptotic. This means that the more meteors the table contains,
the more unbiased is the result of the rounding.
</p>


<h3>Value</h3>

<p>A rounded contingency table of meteor magnitudes is returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For example, create a contingency table of meteor magnitudes
mt &lt;- as.table(matrix(
    c(
        0.0, 0.0, 2.5, 0.5, 0.0, 1.0,
        0.0, 1.5, 2.0, 0.5, 0.0, 0.0,
        1.0, 0.0, 0.0, 3.0, 2.5, 0.5
    ), nrow = 3, ncol = 6, byrow = TRUE
))
colnames(mt) &lt;- seq(6)
rownames(mt) &lt;- c('A', 'B', 'C')
mt
margin.table(mt, 1)
margin.table(mt, 2)

# contingency table with integer values
(mt.int &lt;- vmtable(mt))
margin.table(mt.int, 1)
margin.table(mt.int, 2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
