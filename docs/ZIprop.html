<!DOCTYPE html><html lang="en"><head><title>Help for package ZIprop</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ZIprop}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#delta'><p>The scalar delta</p></a></li>
<li><a href='#diffFactors'><p>diffFactors</p></a></li>
<li><a href='#equineDiffFactors'><p>equineDiffFactors</p></a></li>
<li><a href='#example_data'><p>Zero-inflated proportions dataset</p></a></li>
<li><a href='#fact2mat'><p>Turn factor into multiple column</p></a></li>
<li><a href='#indicator'><p>The performance indicator</p></a></li>
<li><a href='#indicator_max'><p>The max performance indicator</p></a></li>
<li><a href='#model_matrix'><p>Construct Design Matrix</p></a></li>
<li><a href='#permDT'><p>Permutations tests</p></a></li>
<li><a href='#scale_01'><p>Scale vector</p></a></li>
<li><a href='#T_stat_discr'><p>Statistic for non-numeric factor tests</p></a></li>
<li><a href='#T_stat_multi'><p>Statistic for non-numeric factor multiple tests</p></a></li>
<li><a href='#ZIprop'><p>ZIprop: A package for Zero-Inflated Proportions data (ZIprop)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Permutations Tests and Performance Indicator for Zero-Inflated
Proportions Response</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-06-07</td>
</tr>
<tr>
<td>Author:</td>
<td>Melina Ribaud</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Melina Ribaud &lt;melina.ribaud@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Permutations tests to identify factor correlated to zero-inflated proportions response. Provide a performance indicator based on Spearman correlation to quantify the part of correlation explained by the selected set of factors. See details for the method at the following preprint e.g.: <a href="https://hal.archives-ouvertes.fr/hal-02936779v3">https://hal.archives-ouvertes.fr/hal-02936779v3</a>. </td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gitlab.paca.inrae.fr/meribaud/ziprop">https://gitlab.paca.inrae.fr/meribaud/ziprop</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), rgenoud, purrr, data.table, parallel</td>
</tr>
<tr>
<td>Suggests:</td>
<td>markdown, knitr, ggplot2, ggrepel, ggthemes, kableExtra,
stringr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-06-09 12:50:02 UTC; melinaribaud</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-06-09 13:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='delta'>The scalar delta</h2><span id='topic+delta'></span>

<h3>Description</h3>

<p>Calculate the scalar delta.
This parameter comes from the optimal Spearmanâ€™s correlation
when the rank of two vectors <code>X</code> and <code>proba</code> are equal except on a given set of indices.
In our context, this set correspond to the zero-values of the vector <code>proba</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delta(X, proba)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="delta_+3A_x">X</code></td>
<td>
<p>a vector.</p>
</td></tr>
<tr><td><code id="delta_+3A_proba">proba</code></td>
<td>
<p>a zero-inflated proportions response.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>Delta</code> the scalar Delta calculated for the vector <code>x</code>
and the vector <code>proba</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X = rnorm(100)
proba = runif(100)
proba[sample(1:100,80)]=0
Delta = delta(X,proba)
print(Delta)
</code></pre>

<hr>
<h2 id='diffFactors'>diffFactors</h2><span id='topic+diffFactors'></span>

<h3>Description</h3>

<p>Data for the comparison of COVID-19 mortality in European and North American geographic entities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(diffFactors)
</code></pre>


<h3>Format</h3>

<p>A data frame with 483 rows and 32 variables
</p>


<h3>Details</h3>


<ul>
<li><p> geographic_entity_receptor are the entity receptor
</p>
</li>
<li><p> geographic_entity_source are the entity source
</p>
</li>
<li><p> proba is the probability that the receptor follows the mortality dynamics of the source
</p>
</li>
<li><p> other columns are the difference between factors
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Melina Ribaud, Davide Martinetti and Samuel Soubeyrand
</p>


<h3>References</h3>

<p>doi: <a href="https://doi.org/10.5281/zenodo.4769671">10.5281/zenodo.4769671</a>
</p>

<hr>
<h2 id='equineDiffFactors'>equineDiffFactors</h2><span id='topic+equineDiffFactors'></span>

<h3>Description</h3>

<p>Equine Influenza dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(equineDiffFactors)
</code></pre>


<h3>Format</h3>

<p>A data frame with 2256 rows and 8 variables
</p>


<h3>Details</h3>


<ul>
<li><p> ID.source are the ID of source hosts
</p>
</li>
<li><p> ID.recep are the ID of receiver hosts
</p>
</li>
<li><p> y are the vector of transmission probabilities source -&gt; receiver
</p>
</li>
<li><p> other columns are the factors
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Melina Ribaud and Joseph Hughes
</p>


<h3>References</h3>

<p>doi: <a href="https://doi.org//10.5281/zenodo.4837560">/10.5281/zenodo.4837560</a>
</p>

<hr>
<h2 id='example_data'>Zero-inflated proportions dataset</h2><span id='topic+example_data'></span>

<h3>Description</h3>

<p>A dataset example to test the package functions.
The factor X1 to X5 and F1 to F5 are correlated to the responses y.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(example_data)
</code></pre>


<h3>Format</h3>

<p>A data frame with 440 rows and 23 variables
</p>


<h3>Details</h3>


<ul>
<li><p> ID.source are the ID of source hosts
</p>
</li>
<li><p> ID.recep are the ID of receiver hosts
</p>
</li>
<li><p> y are the vector of transmission probabilities source -&gt; receiver
</p>
</li>
<li><p> X1 to X10 are continuous factor
</p>
</li>
<li><p> F1 to F10 are discrete factor
</p>
</li></ul>


<hr>
<h2 id='fact2mat'>Turn factor into multiple column</h2><span id='topic+fact2mat'></span>

<h3>Description</h3>

<p>Turns a factor with several levels into a matrix with several columns composed of zeros and ones.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fact2mat(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fact2mat_+3A_x">x</code></td>
<td>
<p>a vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Columns with zeros and ones.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = sample(1:3,100,replace = TRUE)
fact2mat(x)
</code></pre>

<hr>
<h2 id='indicator'>The performance indicator</h2><span id='topic+indicator'></span>

<h3>Description</h3>

<p>Calculate the indicator for a vector <code>X</code>
and a zero-inflated proportions response <code>proba</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indicator(X, proba)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="indicator_+3A_x">X</code></td>
<td>
<p>a vector.</p>
</td></tr>
<tr><td><code id="indicator_+3A_proba">proba</code></td>
<td>
<p>a zero-inflated proportions response.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a scalar represents the performance indicator
and the vector <code>proba</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X = rnorm(100)
proba = runif(100)
proba[sample(1:100,80)]=0
print(indicator(X,proba))
</code></pre>

<hr>
<h2 id='indicator_max'>The max performance indicator</h2><span id='topic+indicator_max'></span>

<h3>Description</h3>

<p>Search for the set of parameters that maximize the indicator (equivalent to Spearman correlation).
For a given set of factors scaled between 0 and 1 and a
zero-inflated proportions response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indicator_max(
  DT,
  ColNameFactor,
  ColNameWeight = "weight",
  bounds = c(-10, 10),
  max_generations = 200,
  hard_limit = TRUE,
  wait_generations = 50,
  other_class = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="indicator_max_+3A_dt">DT</code></td>
<td>
<p>a data table contains the factors and the response.</p>
</td></tr>
<tr><td><code id="indicator_max_+3A_colnamefactor">ColNameFactor</code></td>
<td>
<p>a char vector with the name of the selected factor.</p>
</td></tr>
<tr><td><code id="indicator_max_+3A_colnameweight">ColNameWeight</code></td>
<td>
<p>a char with the name of the ZI response.</p>
</td></tr>
<tr><td><code id="indicator_max_+3A_bounds">bounds</code></td>
<td>
<p>default is $[-10;10]$. Upper and Lower bounds.</p>
</td></tr>
<tr><td><code id="indicator_max_+3A_max_generations">max_generations</code></td>
<td>
<p>default is 200 see <a href="rgenoud.html#topic+genoud">genoud</a> for more information.</p>
</td></tr>
<tr><td><code id="indicator_max_+3A_hard_limit">hard_limit</code></td>
<td>
<p>default is TRUE see <a href="rgenoud.html#topic+genoud">genoud</a> for more information.</p>
</td></tr>
<tr><td><code id="indicator_max_+3A_wait_generations">wait_generations</code></td>
<td>
<p>default is 50 see <a href="rgenoud.html#topic+genoud">genoud</a> for more information.</p>
</td></tr>
<tr><td><code id="indicator_max_+3A_other_class">other_class</code></td>
<td>
<p>a char vector with the name of other classes than numeric (factor or char).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a list of two elements with the value of the indicator and the associate set of parameters (beta).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(data.table)
data(example_data)
# For real cases increase max_generations and wait_generations
I_max = indicator_max(example_data,
names(example_data)[c(4:8, 14:18)],
ColNameWeight = "proba",
max_generations = 20,
wait_generations = 5)
print(I_max)
</code></pre>

<hr>
<h2 id='model_matrix'>Construct Design Matrix</h2><span id='topic+model_matrix'></span>

<h3>Description</h3>

<p>Creates a design matrix
by expanding factors to a set of dummy variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_matrix(DT, ColNameFactor, other_class)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="model_matrix_+3A_dt">DT</code></td>
<td>
<p>a data table contains the factors and the response.</p>
</td></tr>
<tr><td><code id="model_matrix_+3A_colnamefactor">ColNameFactor</code></td>
<td>
<p>a char vector with the name of the selected factor.</p>
</td></tr>
<tr><td><code id="model_matrix_+3A_other_class">other_class</code></td>
<td>
<p>a char vector with the name of other classes than numeric (factor or char).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return the value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(data.table)
data(example_data)
m = model_matrix (example_data,
colnames(example_data)[-c(1:3)],
other_class = colnames(example_data)[14:23])
print(m)
</code></pre>

<hr>
<h2 id='permDT'>Permutations tests</h2><span id='topic+permDT'></span>

<h3>Description</h3>

<p>Permutations tests to identify factor correlated
to a zero-inflated proportions response. The statistic are the Spearman's
correlation for numeric factor and mean by level for other factor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permDT(
  DT,
  ColNameFactor,
  B = 1000,
  nclust = 1,
  ColNameWeight = "weight",
  ColNameRecep = "ID.recep",
  ColNameSource = "ID.source",
  seed = NULL,
  no_const = FALSE,
  num_class = ColNameFactor,
  other_class = NULL,
  multiple_test = FALSE,
  adjust_method = "none",
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="permDT_+3A_dt">DT</code></td>
<td>
<p>a data table contains the factors and the response.</p>
</td></tr>
<tr><td><code id="permDT_+3A_colnamefactor">ColNameFactor</code></td>
<td>
<p>a char vector with the name of the selected factor.</p>
</td></tr>
<tr><td><code id="permDT_+3A_b">B</code></td>
<td>
<p>number of permutations (use at least B=1000 permutations to get a correct accuracy of the p-value.)</p>
</td></tr>
<tr><td><code id="permDT_+3A_nclust">nclust</code></td>
<td>
<p>number of proc for parallel computation.</p>
</td></tr>
<tr><td><code id="permDT_+3A_colnameweight">ColNameWeight</code></td>
<td>
<p>a char with the name of the ZI response.</p>
</td></tr>
<tr><td><code id="permDT_+3A_colnamerecep">ColNameRecep</code></td>
<td>
<p>colname of the column with the target names</p>
</td></tr>
<tr><td><code id="permDT_+3A_colnamesource">ColNameSource</code></td>
<td>
<p>colname of the column with the contributor names</p>
</td></tr>
<tr><td><code id="permDT_+3A_seed">seed</code></td>
<td>
<p>vector with the seed for the permutations: size(<code>seed</code>)=<code>B</code></p>
</td></tr>
<tr><td><code id="permDT_+3A_no_const">no_const</code></td>
<td>
<p>FALSE for receiver block constraint for permutations: TRUE no constraint.</p>
</td></tr>
<tr><td><code id="permDT_+3A_num_class">num_class</code></td>
<td>
<p>a char vector with the name of numeric factor.</p>
</td></tr>
<tr><td><code id="permDT_+3A_other_class">other_class</code></td>
<td>
<p>a char vector with the name of other classes than numeric (factor or char).</p>
</td></tr>
<tr><td><code id="permDT_+3A_multiple_test">multiple_test</code></td>
<td>
<p>useful option only for discrete factors: Set TRUE to calculate multiple tests.</p>
</td></tr>
<tr><td><code id="permDT_+3A_adjust_method">adjust_method</code></td>
<td>
<p>p-values adjusted methods (default &quot;none&quot; ). c(&quot;holm&quot;, &quot;hochberg&quot;, &quot;hommel&quot;, &quot;bonferroni&quot;, &quot;BH&quot;, &quot;BY&quot;,&quot;fdr&quot;, &quot;none&quot;).</p>
</td></tr>
<tr><td><code id="permDT_+3A_alpha">alpha</code></td>
<td>
<p>significant level (default 0.05).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with two columns. One for the statistics and the other one for the p-value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(data.table)
data(example_data)
res = permDT (example_data,
colnames(example_data)[c(4,10,14,20)],
B = 10,
nclust = 1,
ColNameWeight = "y",
ColNameRecep = "ID.recep",
ColNameSource = "ID.source",
seed = NULL,
num_class = colnames(example_data)[c(4,10)],
other_class = colnames(example_data)[c(14,20)])
print(res)
</code></pre>

<hr>
<h2 id='scale_01'>Scale vector</h2><span id='topic+scale_01'></span>

<h3>Description</h3>

<p>Scale a vector between 0 and 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_01(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scale_01_+3A_x">x</code></td>
<td>
<p>a vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the scaled vector of <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = runif(100,-10,10)
x_scale = scale_01(x)
range(x_scale)
</code></pre>

<hr>
<h2 id='T_stat_discr'>Statistic for non-numeric factor tests</h2><span id='topic+T_stat_discr'></span>

<h3>Description</h3>

<p>Statistic for non-numeric factor tests (same statistic as H-test).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>T_stat_discr(permu, al)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="T_stat_discr_+3A_permu">permu</code></td>
<td>
<p>the response vector.</p>
</td></tr>
<tr><td><code id="T_stat_discr_+3A_al">al</code></td>
<td>
<p>the factor.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the statistic.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>permu = runif(100,-10,10)
al = as.factor(sample(1:3,100,replace=TRUE))
T_stat_discr(permu, al)
</code></pre>

<hr>
<h2 id='T_stat_multi'>Statistic for non-numeric factor multiple tests</h2><span id='topic+T_stat_multi'></span>

<h3>Description</h3>

<p>Statistic for non-numeric factor multiple tests (difference in mean ranks).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>T_stat_multi(permu, al)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="T_stat_multi_+3A_permu">permu</code></td>
<td>
<p>the response vector.</p>
</td></tr>
<tr><td><code id="T_stat_multi_+3A_al">al</code></td>
<td>
<p>the factor.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the means difference of two levels for a discrete factor.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>permu = runif(100,-10,10)
al = as.factor(sample(1:3,100,replace=TRUE))
T_stat_multi(permu, al)
</code></pre>

<hr>
<h2 id='ZIprop'>ZIprop: A package for Zero-Inflated Proportions data (ZIprop)</h2><span id='topic+ZIprop'></span>

<h3>Description</h3>

<p>We propose a by block-permutation-based methodology (i) to identify factors (discrete or continuous)
that are potentially significant, (ii) to define a performance indicator to quantify the percentage
of correlation explained by the significant factors subset for Zero-Inflated Proportions data (ZIprop).
</p>


<h3>References</h3>

<p>Melina Ribaud, Edith Gabriel, Joseph Hughes, Samuel Soubeyrand.
Identifying potential significant factors impacting zero-inflated proportions data.
2020. hal-02936779
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
