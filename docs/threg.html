<!DOCTYPE html><html><head><title>Help for package threg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {threg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bmt'><p>Bone Marrow Transplantation Data</p></a></li>
<li><a href='#hr'><p>Hazard ratio calculation for threshold regression model</p></a></li>
<li><a href='#lkr'><p>Leukemia Remission Data</p></a></li>
<li><a href='#plot.threg'><p>Plot curves of the estimated survival, hazard or density functions for threshold regression model</p></a></li>
<li><a href='#predict.threg'><p>predictions for threshold regression model</p></a></li>
<li><a href='#print.threg'><p>Print method for threg objects</p></a></li>
<li><a href='#threg'><p>fit a threshold regression model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Threshold Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-08-10</td>
</tr>
<tr>
<td>Author:</td>
<td>Tao Xiao</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tao Xiao &lt;taoxiao1@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), survival, Formula</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit a threshold regression model based on the first-hitting-time of a boundary by the sample path of a Wiener diffusion process. The threshold regression methodology is well suited to applications involving survival and time-to-event data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-08-10 14:49:14 UTC; Bati</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-08-10 18:31:56</td>
</tr>
</table>
<hr>
<h2 id='bmt'>Bone Marrow Transplantation Data</h2><span id='topic+bmt'></span>

<h3>Description</h3>

<p>Survival of 137 acute leukemia patients treated with bone marrow transplants which are a standard treatment for acute leukemia.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bmt
</code></pre>


<h3>Format</h3>


<table>
<tr>
 <td style="text-align: left;">
    time:</td><td style="text-align: left;"> time to relapse, death or end of study (in days)</td>
</tr>
<tr>
 <td style="text-align: left;">
    indicator:</td><td style="text-align: left;"> censoring indicator variable -  1 = dead or replapse, 0 = otherwise</td>
</tr>
<tr>
 <td style="text-align: left;">
    recipient_age:</td><td style="text-align: left;"> patient age</td>
</tr>
<tr>
 <td style="text-align: left;">
    group:</td><td style="text-align: left;">  risk categories based on their status at the time of transplantation</td>
</tr>
<tr>
 <td style="text-align: left;">
    fab:</td><td style="text-align: left;"> French-American-British (FAB) classification based on standard morphological criteria</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>References</h3>

<p>Klein JP, Moeschberger ML. 
Survival analysis: techniques for censored and truncated data. 2 edition, 2003 
Springer-Verlag New York, Inc.</p>

<hr>
<h2 id='hr'>Hazard ratio calculation for threshold regression model</h2><span id='topic+hr'></span><span id='topic+hr.threg'></span>

<h3>Description</h3>

<p>This function can be used to estimate hazard ratios at selected time
points for specified scenarios (based on given categories or value settings of covariates).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hr(object,var,timevalue,scenario) 
## S3 method for class 'threg'
hr(object,var,timevalue,scenario) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hr_+3A_object">object</code></td>
<td>
<p>a threg object.</p>
</td></tr>
<tr><td><code id="hr_+3A_var">var</code></td>
<td>
<p>specifies the categorical variable for the calculation of hazard ratios. Such categorical variable must be a factor variable that has been used in threg() that returns the threg object.</p>
</td></tr>
<tr><td><code id="hr_+3A_timevalue">timevalue</code></td>
<td>
<p>specifies a value of time at which the hazard ratios are calculated. A vector is allowed. </p>
</td></tr>
<tr><td><code id="hr_+3A_scenario">scenario</code></td>
<td>
<p>specifies a scenario where the hazard ratios are calculated.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#load the data "lkr"
data("lkr")

#Transform the "treatment2" variable into factor variable "f.treatment2" .
lkr$f.treatment2=factor(lkr$treatment2)

#fit the threshold regression model on the factor variable "f.treatment2", 
fit&lt;-threg(Surv(weeks, relapse)~ f.treatment2|f.treatment2,data = lkr)
fit

#calculate the hazard ratio of the drug B group v.s. the standard group at 
#week 5 (this hazard ratio is calculated as 2.08)
hr.threg(fit,var=f.treatment2,timevalue=5)

#calculate the hazard ratio of the drug B group v.s. the standard group at 
#week 20 (this hazard ratio is calculated as 0.12)
hr.threg(fit,var=f.treatment2,timevalue=20)

#As a comparison, fit the Cox proportion hazards model on "f.treatment2", 
#and the Cox model gives a constant hazard ratio, 0.73.
summary(coxph(Surv(weeks, relapse) ~ f.treatment2, data = lkr))



#load the data "bmt"
data("bmt")

#Transform the "group" and "fab" variables into factor variables 
#"f.group" and "f.fab".
bmt$f.group=factor(bmt$group)
bmt$f.fab=factor(bmt$fab)

#fit a threshold regression model on the "bmt" dataset, by using "recipient_age" and 
#"f.fab" as the predictors for ln(y0), and "f.group" and "f.fab" as predictors for mu.
fit&lt;-threg(Surv(time, indicator)~ recipient_age+f.fab|f.group+f.fab, data = bmt)
fit

#Calculate the hazard ratio for 
#"f.group" for the specified scenario that "the patient age is 18 years old and 
#the FAB classification is 0", at the time ``500 days''.
hr.threg(fit,var=f.group,timevalue=500,scenario=recipient_age(18)+f.fab1(0))


</code></pre>

<hr>
<h2 id='lkr'>Leukemia Remission Data</h2><span id='topic+lkr'></span>

<h3>Description</h3>

<p>Data of a leukemia remission study. There are 42 patients in the dataset, who were monitored for whether they relapsed and for how long (in weeks) they remained in remission.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lkr
</code></pre>


<h3>Format</h3>


<table>
<tr>
 <td style="text-align: left;">
    weeks:</td><td style="text-align: left;"> the time that a patient was remained in remission (in weeks)</td>
</tr>
<tr>
 <td style="text-align: left;">
    relapse:</td><td style="text-align: left;"> whether the patient was relapsed -  1 = yes, 0 = no</td>
</tr>
<tr>
 <td style="text-align: left;">
    treatment1:</td><td style="text-align: left;"> 1=drug A, 0 = standard drug for treatment1</td>
</tr>
<tr>
 <td style="text-align: left;">
    treatment2:</td><td style="text-align: left;"> 1=drug B, 0 = standard drug for treatment2</td>
</tr>
<tr>
 <td style="text-align: left;">
    wbc3cat:</td><td style="text-align: left;">  white blood cell count, recorded in three categories - 1 = normal, 2= moderate, 3 = high</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>References</h3>

<p>Garrett JM.
sbe14: Odds Ratios and Confidence Intervals for Logistic Regression
Models with Effect Modification. Stata Technical Bulletin, 36, 15-22. 
Reprinted in Stata Technical Bulletin Reprints, vol. 6, pp. 104-114, 1997
College Station, TX: Stata Press</p>

<hr>
<h2 id='plot.threg'>Plot curves of the estimated survival, hazard or density functions for threshold regression model</h2><span id='topic+plot.threg'></span>

<h3>Description</h3>

<p>This function can be used to display the graphs of the estimated survival, hazard or density functions at different levels of a factor predictor variable which has been included in the threshold regression by threg() function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'threg'
plot(x,var,scenario,graph,nolegend=0,nocolor=0,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.threg_+3A_x">x</code></td>
<td>
<p>a threg object.</p>
</td></tr>
<tr><td><code id="plot.threg_+3A_var">var</code></td>
<td>
<p>specifies the categorical variable for each level of which the curves are plotted. Such categorical variable must be a factor variable that has been used in threg() that returns the threg object.</p>
</td></tr>
<tr><td><code id="plot.threg_+3A_scenario">scenario</code></td>
<td>
<p>specifies a scenario where the predicted plots are based on.</p>
</td></tr>
<tr><td><code id="plot.threg_+3A_graph">graph</code></td>
<td>
<p>specifies the type of curves to be generated. The &ldquo;hz&rdquo; option is to plot hazard function curves, the &ldquo;sv&rdquo; option is to plot survival function curves, and the &ldquo;ds&rdquo; option is to plot density function curves.</p>
</td></tr>
<tr><td><code id="plot.threg_+3A_nolegend">nolegend</code></td>
<td>
<p>set the &ldquo;nolegend&rdquo; argument to 1 if users do not want the &ldquo;threg&rdquo; package to generate legends for the picture. Note that even if &ldquo;nolegend&rdquo; is set to 1, users can still generate legends by themselves after the picture is generated, by using the &ldquo;legend&rdquo; function in R.</p>
</td></tr>
<tr><td><code id="plot.threg_+3A_nocolor">nocolor</code></td>
<td>
<p>set the &ldquo;nocolor&rdquo; argument to 1 if users want to depict all curves in black.</p>
</td></tr>
<tr><td><code id="plot.threg_+3A_...">...</code></td>
<td>
<p>for future methods</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#load the data "lkr"
data("lkr")

#Transform the "treatment2" variable into factor variable "f.treatment2" .
lkr$f.treatment2=factor(lkr$treatment2)

#fit the threshold regression model on the factor variable "f.treatment2", 
fit&lt;-threg(Surv(weeks, relapse)~ f.treatment2|f.treatment2,data = lkr)
fit

#generate the predicted survival curves for the drug B group and 
#the standard group.
plot(fit,var=f.treatment2,graph=sv,nolegend=1,nocolor=1)
legend(20, 1, c("Standard","Drug B"), lty = 1:2) 



#load the data "bmt"
data("bmt")

#Transform the "group" and "fab" variables into factor variables 
#"f.group" and "f.fab".
bmt$f.group=factor(bmt$group)
bmt$f.fab=factor(bmt$fab)

#fit a threshold regression model on the "bmt" dataset, by using "recipient_age" and 
#"f.fab" as the predictors for ln(y0), and "f.group" and "f.fab" as predictors for mu.
fit&lt;-threg(Surv(time, indicator)~ recipient_age+f.fab|f.group+f.fab, data = bmt)
fit

#fit the same model as above, but additionally overlay curves of survival functions 
#corresponding to different levels of "f.group'.
plot.threg(fit,var=f.group,scenario=recipient_age(18)+f.fab1(0),graph=sv,nocolor=1)


#fit the same model as above, but additionally overlay curves of hazard functions 
#corresponding to different levels of "f.group'.
plot.threg(fit,var=f.group,scenario=recipient_age(18)+f.fab1(0),graph=hz,nocolor=1)

#fit the same model as above, but additionally overlay curves of probability density 
#functions corresponding to different levels of "f.group'.
plot.threg(fit,var=f.group,scenario=recipient_age(18)+f.fab1(0),graph=ds,nocolor=1)

</code></pre>

<hr>
<h2 id='predict.threg'>predictions for threshold regression model</h2><span id='topic+predict.threg'></span>

<h3>Description</h3>

<p>This function can be used to predict the initial health status value <code class="reqn">y_0</code>, the drift value of the health process <code class="reqn">\mu</code>, the probability density function of the survival time <code class="reqn">f(t\mid \mu,y_0)</code>, the survival function <code class="reqn">S(t\mid \mu, y_0)</code> and the hazard function <code class="reqn">h(t\mid \mu,y_0)</code> for a specified scenario and time value. The scenario specified here is similar to those in hr.threg and plot.threg functions. The only difference is that we need to provide the scenario values for all variables in the model, while for hr.threg and plot.threg functions we do not need to provide scenario values of the dummy variables expanded from the factor variable specified in the var argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'threg'
predict(object,timevalue,scenario,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.threg_+3A_object">object</code></td>
<td>
<p>a threg object.</p>
</td></tr>
<tr><td><code id="predict.threg_+3A_timevalue">timevalue</code></td>
<td>
<p>specifies the desired time value at which the predicted values are to be calculated. Vector is allowed for this argument. If this argument is omitted, then the predicted values for the study time of all subjects would be calculated.</p>
</td></tr>
<tr><td><code id="predict.threg_+3A_scenario">scenario</code></td>
<td>
<p>specifies the values of all predictors. If this argument is omitted, then the predicted values at a specified time value for all subjects would be calculated, and in this case the covariate values for each subject are used as their corresponding scenario values.</p>
</td></tr>
<tr><td><code id="predict.threg_+3A_...">...</code></td>
<td>
<p>for future methods</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
#load the data "bmt"
data("bmt")

#Transform the "group" and "fab" variables into factor variables 
#"f.group" and "f.fab".
bmt$f.group=factor(bmt$group)
bmt$f.fab=factor(bmt$fab)

#fit a threshold regression model on the "bmt" dataset, by using "recipient_age" and 
#"f.fab" as the predictors for ln(y0), and "f.group" and "f.fab" as predictors for mu.
fit&lt;-threg(Surv(time, indicator)~ recipient_age+f.fab|f.group+f.fab, data = bmt)

#predict lny0, y0, mu, f, S and h for the specified scenario that "the patient age is 
#18 years old, the FAB classification is 0 and the risk category is 3", at the 
#time ``2000 days''
predict.threg(fit,timevalue=2000,scenario=recipient_age(18)+f.fab1(0)+f.group2(0)+f.group3(1))

</code></pre>

<hr>
<h2 id='print.threg'>Print method for threg objects</h2><span id='topic+print.threg'></span>

<h3>Description</h3>

<p>Produces a printed summary of a fitted threg model 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'threg'
print(x, digits=max(options()$digits - 4, 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.threg_+3A_x">x</code></td>
<td>

<p>the result of a call to <code>threg</code> 
</p>
</td></tr>
<tr><td><code id="print.threg_+3A_digits">digits</code></td>
<td>
<p>significant digits to print</p>
</td></tr>
<tr><td><code id="print.threg_+3A_...">...</code></td>
<td>
<p>For future methods</p>
</td></tr>
</table>

<hr>
<h2 id='threg'>fit a threshold regression model</h2><span id='topic+threg'></span>

<h3>Description</h3>

<p>This function can be used to fit a threshold regressio model based on the first-hitting-time of a boundary by the sample path of a Wiener diffusion process. It uses maximum likelihood estimation method for calculating regression coefficient estimates, asymptotic standard errors and p-values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>threg(formula, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="threg_+3A_formula">formula</code></td>
<td>
<p>a formula object, with the response on the left of a ~ operator, and the independent variables on the right. The response must be a survival object as returned by the Surv function. On the right of the ~ operator, a | operator must be used: on the left of the | operator, users specify independent variables that will be used in the linear regression function for <code class="reqn">\ln{y_0}</code> in the threshold regression model; on the right of the | operator, users specify independent variables that will be used in the linear regression function for <code class="reqn">\mu</code> in the threshold regression model. If users just want to use a constant <code class="reqn">\ln{y_0}</code> or <code class="reqn">\mu</code>, he or she can put 0 or 1 as a placeholder on the left or right of the | operator, instead of listing the independent variables for <code class="reqn">\ln{y_0}</code> or <code class="reqn">\mu</code>.</p>
</td></tr>
<tr><td><code id="threg_+3A_data">data</code></td>
<td>
<p>input dataset. Such dataset must be a survival dataset including at least the survival time variable and censoring variable. For the censoring variable, 1 should be used to indicate the subjects with failure observed, and 0 should be used to indicate the subjects that are right censored. The dataset can also include other independent variables that will be used in the threshold regression model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Threshold regression is a recently developed regression methodology to analyze time to event data. For a review of this regression model, see Lee and Whitmore (2006, 2010). A unique feature of threshold regression is that the event time is considered as the time when an underlying stochastic process first hits a boundary threshold. In the context of survival data, for example, the event can be death. The death time of an individual is considered as the time when his/her latent health status  decreases to the zero boundary.
</p>
<p>In the <code>threg</code> package, a Wiener process <code class="reqn">Y(t)</code> is used to model the latent health status process. An event is observed when <code class="reqn">Y(t)</code> reaches <code class="reqn">0</code> for the first time. Three parameters of the Wiener process are involved: <code class="reqn">\mu</code>, <code class="reqn">y_0</code> and <code class="reqn">\sigma</code>. Parameter <code class="reqn">\mu</code>, called the drift of the Wiener process, is the rate per unit time at which the level of the sample path is changing. The sample path approaches the threshold if <code class="reqn">\mu &lt;0</code>. Parameter <code class="reqn">y_0</code> is the initial value of the process and is taken as positive. Parameter <code class="reqn">\sigma</code> represents the variability per unit time of the process (Lee and Whitmore 2006). The first hitting time (FHT) of a Wiener process with <code class="reqn">\mu</code>, <code class="reqn">y_0</code> and <code class="reqn">\sigma</code> is an inverse Gaussian distribution with probability density function (p.d.f):
</p>
<p style="text-align: center;"><code class="reqn">f(t|\mu,{\sigma}^2,y_0)=\frac{y_0}{\sqrt{2\pi{\sigma^2}t^3}}\exp\left[-\frac{(y_0+\mu t)^2}{2\sigma^2 t}\right],</code>
</p>

<p>where <code class="reqn">-\infty &lt;\mu &lt;\infty , \sigma^2 &gt;0, \mbox{ and } y_0&gt;0</code>. The p.d.f. is proper if <code class="reqn">\mu \leq 0</code>. The cumulative distribution function of the FHT is:
</p>
<p style="text-align: center;"><code class="reqn">F(t|\mu,{\sigma}^2,y_0)=\Phi\left[-\frac{(y_0+\mu t)^2}{\sqrt{\sigma^2 t}}\right]+\exp \left(-\frac{2y_0 \mu}{\sigma^2}\right)\Phi\left[\frac{\mu t - y_0}{\sqrt{\sigma^2 t}}\right],</code>
</p>

<p>where <code class="reqn">\Phi(\cdot)</code> is the cumulative distribution function of the standard normal distribution. Note that if <code class="reqn">\mu&gt;0</code>, the Wiener process may never hit the boundary at zero and hence there is a probability that the FHT is
<code class="reqn">\infty</code>, that is, <code class="reqn">P(FHT=\infty)=1-\exp(-2y_0\mu/\sigma^2)</code>.
</p>
<p>Since the health status process is usually latent (i.e., unobserved), an arbitrary unit can be used to measure such a process. Hence the variance parameter <code class="reqn">\sigma^2</code> of the process is set to 1 in the <code>threg</code> package to fix the measurement unit of the process. Then we can regress the other two process parameters, <code class="reqn">y_0</code> and <code class="reqn">\mu</code> on covariate data. We assume that <code class="reqn">\mu</code> and <code class="reqn">\ln(y_0)</code> are linear in regression coefficients.
</p>
<p>Suppose that the covariate vector is <code class="reqn">\bm{Z'}=(1, Z_1, \cdots, Z_k)</code>, where <code class="reqn">Z_1, \cdots, Z_k</code> are covariates and the leading 1 in <code class="reqn">\bm{Z'}</code> allows for a constant term in the regression relationship. Then <code class="reqn">\ln(y_0)</code> can be linked to the covariates with the following regression form:
</p>
<p style="text-align: center;"><code class="reqn">\ln(y_0)=\gamma_0+\gamma_1 Z_1+\cdots + \gamma_k Z_k=\bm{Z' \gamma}</code>
</p>
<p> and <code class="reqn">\mu</code> can be linked to the covariates with the following regression form:
</p>
<p style="text-align: center;"><code class="reqn">\mu=\beta_0+\beta_1 Z_1+\cdots + \beta_k Z_k=\bm{Z' \beta}</code>
</p>

<p>Vectors <code class="reqn">\gamma</code> and <code class="reqn">\beta</code> are regression coefficients for <code class="reqn">\ln(y_0)</code> and <code class="reqn">\mu</code>, respectively, with <code class="reqn">\gamma'=(\gamma_0,\cdots,\gamma_k)</code> and <code class="reqn">\beta'=(\beta_0,\cdots,\beta_k)</code>. Note that researchers can set some elements in <code class="reqn">\gamma</code> or <code class="reqn">\beta</code> to zero if they feel the corresponding covariates are not important in predicting <code class="reqn">\ln(y_0)</code> or <code class="reqn">\mu</code>. For example, if covariate <code class="reqn">Z_1</code> in the vector <code class="reqn">Z'</code> is considered not important to predict <code class="reqn">\ln(y_0)</code>, we can remove the <code class="reqn">Z_1</code> term by setting <code class="reqn">\gamma_1</code> to zero.
</p>


<h3>Author(s)</h3>

<p>Tao Xiao
</p>
<p>Maintainer: Tao Xiao &lt;taoxiao1@gmail.com&gt;
</p>


<h3>References</h3>

<p>Lee, M-L. T., Whitmore, G. A. (2010)
Proportional hazards and threshold regression: their theoretical and practical connections., <em>Lifetime Data Analysis
</em> 16, 2: 196-214.
</p>
<p>Lee, M-L. T., Whitmore, G. A. (2006)
Threshold regression for survival analysis: modeling event times by a stochastic process, <em>Statistical Science
</em> 21: 501-513.
</p>
<p>Klein, J. P., Moeschberger, M. L. (2003)
<em>Survival Analysis: Techniques for Censored and Truncated Data</em>. 2 edition. Springer-Verlag New York, Inc.
</p>
<p>Garrett, J. M. (1997)
Odds ratios and confidence intervals for logistic regression
models with effect modification. <em>Stata Technical Bulletin</em>, 36, 1522. Reprinted in <em>Stata
Technical Bulletin Reprints</em>, vol. 6, pp. 104-114. College Station, TX: Stata Press.
</p>
<p>Xiao, T., Whitmore, G. A., He, Xin, Lee, M-L. T. (2015)
The R Package threg to Implement Threshold Regression Models. <em>Journal of Statistical Software</em>, 66(8), 1-16. URL http://www.jstatsoft.org/v66/i08/.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#load the data "lkr"
data("lkr")

#Transform the "treatment2" variable into factor variable "f.treatment2" .
lkr$f.treatment2=factor(lkr$treatment2)

#fit the threshold regression model on the factor variable "f.treatment2", 
fit&lt;-threg(Surv(weeks, relapse)~ f.treatment2|f.treatment2,data = lkr)
fit

#load the data "bmt"
data("bmt")

#Transform the "group" and "fab" variables into factor variables 
#"f.group" and "f.fab".
bmt$f.group=factor(bmt$group)
bmt$f.fab=factor(bmt$fab)

#fit a threshold regression model on the "bmt" dataset, by using "recipient_age" and 
#"f.fab" as the predictors for ln(y0), and "f.group" and "f.fab" as predictors for mu.
fit&lt;-threg(Surv(time, indicator)~ recipient_age+f.fab|f.group+f.fab, data = bmt)
fit

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
