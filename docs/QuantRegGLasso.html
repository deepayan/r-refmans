<!DOCTYPE html><html><head><title>Help for package QuantRegGLasso</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {QuantRegGLasso}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#awgl'><p>Internal function: Quantile Regression with Adaptively Group Lasso without <code>Omega</code></p></a></li>
<li><a href='#awgl_omega'><p>Internal function: Quantile Regression with Adaptively Group Lasso with <code>Omega</code></p></a></li>
<li><a href='#check_predict_parameters'><p>Internal Function: Validate Parameters for Prediction with a <code>qrglasso</code> Object</p></a></li>
<li><a href='#orthogonize_bspline'><p>Orthogonalized B-splines</p></a></li>
<li><a href='#plot_bic_result'><p>Internal Function: Plot BIC Results w.r.t. lambda</p></a></li>
<li><a href='#plot_coefficient_function'><p>Internal Function: Plot Coefficient Function</p></a></li>
<li><a href='#plot_sequentially'><p>Internal Function: Plot Sequentially</p></a></li>
<li><a href='#plot.qrglasso'><p>Display BIC Results from <code>qrglasso</code></p></a></li>
<li><a href='#plot.qrglasso.predict'><p>Display Predicted Coefficient Functions from <code>qrglasso</code></p></a></li>
<li><a href='#predict'><p>Predict Top-k Coefficient Functions</p></a></li>
<li><a href='#qrglasso'><p>Adaptively Weighted Group Lasso</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Adaptively Weighted Group Lasso for Semiparametric Quantile
Regression Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements an adaptively weighted group Lasso procedure for simultaneous variable selection and structure identification in varying
  coefficient quantile regression models and additive quantile regression models with ultra-high dimensional covariates. The methodology, grounded
  in a strong sparsity condition, establishes selection consistency under certain weight conditions. To address the challenge of tuning parameter 
  selection in practice, a BIC-type criterion named high-dimensional information criterion (HDIC) is proposed. The Lasso procedure, guided by
  HDIC-determined tuning parameters, maintains selection consistency. Theoretical findings are strongly supported by simulation studies.
  (Toshio Honda, Ching-Kang Ing, Wei-Ying Wu, 2019, &lt;<a href="https://doi.org/10.3150%2F18-BEJ1091">doi:10.3150/18-BEJ1091</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/egpivo/QuantRegGLasso/issues">https://github.com/egpivo/QuantRegGLasso/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.12), ggplot2</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 2.1.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/egpivo/SpatPCA">https://github.com/egpivo/SpatPCA</a></td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-15 21:57:00 UTC; joseph</td>
</tr>
<tr>
<td>Author:</td>
<td>Wen-Ting Wang <a href="https://orcid.org/0000-0003-3051-7302"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Wei-Ying Wu [aut],
  Toshio Honda [aut],
  Ching-Kang Ing <a href="https://orcid.org/0000-0003-1362-8246"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wen-Ting Wang &lt;egpivo@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-16 17:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='awgl'>Internal function: Quantile Regression with Adaptively Group Lasso without <code>Omega</code></h2><span id='topic+awgl'></span>

<h3>Description</h3>

<p>Internal function: Quantile regression with adaptively group Lasso without <code>Omega</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>awgl(Y, W, lambda, tau, L, qn, zeta, zetaincre, maxit, tol)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="awgl_+3A_y">Y</code></td>
<td>
<p>Data matrix (<code class="reqn">n \times 1</code>).</p>
</td></tr>
<tr><td><code id="awgl_+3A_w">W</code></td>
<td>
<p>B-splines with covariates matrix with <code class="reqn">p \times L</code> columns and <code class="reqn">n</code> rows.</p>
</td></tr>
<tr><td><code id="awgl_+3A_lambda">lambda</code></td>
<td>
<p>A sequence of tuning parameters.</p>
</td></tr>
<tr><td><code id="awgl_+3A_tau">tau</code></td>
<td>
<p>A quantile of interest.</p>
</td></tr>
<tr><td><code id="awgl_+3A_l">L</code></td>
<td>
<p>The number of groups.</p>
</td></tr>
<tr><td><code id="awgl_+3A_qn">qn</code></td>
<td>
<p>A bound parameter for HDIC.</p>
</td></tr>
<tr><td><code id="awgl_+3A_zeta">zeta</code></td>
<td>
<p>A step parameter.</p>
</td></tr>
<tr><td><code id="awgl_+3A_zetaincre">zetaincre</code></td>
<td>
<p>An increment of each step.</p>
</td></tr>
<tr><td><code id="awgl_+3A_maxit">maxit</code></td>
<td>
<p>The maximum number of iterations.</p>
</td></tr>
<tr><td><code id="awgl_+3A_tol">tol</code></td>
<td>
<p>A tolerance rate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of selected parameters.
</p>

<hr>
<h2 id='awgl_omega'>Internal function: Quantile Regression with Adaptively Group Lasso with <code>Omega</code></h2><span id='topic+awgl_omega'></span>

<h3>Description</h3>

<p>Internal function: Quantile regression with adaptively group Lasso with <code>Omega</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>awgl_omega(Y, W, omega, lambda, tau, qn, zeta, zetaincre, maxit, tol)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="awgl_omega_+3A_y">Y</code></td>
<td>
<p>Data matrix (<code class="reqn">n \times 1</code>).</p>
</td></tr>
<tr><td><code id="awgl_omega_+3A_w">W</code></td>
<td>
<p>B-splines with covariates matrix with <code class="reqn">p \times L</code> columns and <code class="reqn">n</code> rows.</p>
</td></tr>
<tr><td><code id="awgl_omega_+3A_omega">omega</code></td>
<td>
<p>Weights for group lasso.</p>
</td></tr>
<tr><td><code id="awgl_omega_+3A_lambda">lambda</code></td>
<td>
<p>A sequence of tuning parameters.</p>
</td></tr>
<tr><td><code id="awgl_omega_+3A_tau">tau</code></td>
<td>
<p>A quantile of interest.</p>
</td></tr>
<tr><td><code id="awgl_omega_+3A_qn">qn</code></td>
<td>
<p>A bound parameter for HDIC.</p>
</td></tr>
<tr><td><code id="awgl_omega_+3A_zeta">zeta</code></td>
<td>
<p>A step parameter.</p>
</td></tr>
<tr><td><code id="awgl_omega_+3A_zetaincre">zetaincre</code></td>
<td>
<p>An increment of each step.</p>
</td></tr>
<tr><td><code id="awgl_omega_+3A_maxit">maxit</code></td>
<td>
<p>The maximum number of iterations.</p>
</td></tr>
<tr><td><code id="awgl_omega_+3A_tol">tol</code></td>
<td>
<p>A tolerance rate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of selected parameters.
</p>

<hr>
<h2 id='check_predict_parameters'>Internal Function: Validate Parameters for Prediction with a <code>qrglasso</code> Object</h2><span id='topic+check_predict_parameters'></span>

<h3>Description</h3>

<p>Internal function to validate parameters for predicting with a <code>qrglasso</code> class object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_predict_parameters(
  qrglasso_object,
  metric_type,
  top_k,
  degree,
  boundaries
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_predict_parameters_+3A_qrglasso_object">qrglasso_object</code></td>
<td>
<p>A <code>qrglasso</code> class object.</p>
</td></tr>
<tr><td><code id="check_predict_parameters_+3A_metric_type">metric_type</code></td>
<td>
<p>Character. Metric type for gamma selection, e.g., <code>BIC</code>, <code>BIC-log</code>. Default is <code>BIC</code>.</p>
</td></tr>
<tr><td><code id="check_predict_parameters_+3A_top_k">top_k</code></td>
<td>
<p>Integer. Top K estimated functions.</p>
</td></tr>
<tr><td><code id="check_predict_parameters_+3A_degree">degree</code></td>
<td>
<p>Integer. Degree of the piecewise polynomial.</p>
</td></tr>
<tr><td><code id="check_predict_parameters_+3A_boundaries">boundaries</code></td>
<td>
<p>Array. Two boundary points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>.
</p>

<hr>
<h2 id='orthogonize_bspline'>Orthogonalized B-splines</h2><span id='topic+orthogonize_bspline'></span>

<h3>Description</h3>

<p>Generate a set of orthogonalized B-splines using the Gram-Schmidt algorithm applied to the built-in function <code>splines::bs()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orthogonize_bspline(
  knots,
  boundary_knots,
  degree,
  predictors = NULL,
  is_approx = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="orthogonize_bspline_+3A_knots">knots</code></td>
<td>
<p>Array. The knots that define the spline.</p>
</td></tr>
<tr><td><code id="orthogonize_bspline_+3A_boundary_knots">boundary_knots</code></td>
<td>
<p>Array. The breakpoints that define the spline.</p>
</td></tr>
<tr><td><code id="orthogonize_bspline_+3A_degree">degree</code></td>
<td>
<p>Integer. The degree of the piecewise polynomial.</p>
</td></tr>
<tr><td><code id="orthogonize_bspline_+3A_predictors">predictors</code></td>
<td>
<p>Array. The predictor variables with size p.</p>
</td></tr>
<tr><td><code id="orthogonize_bspline_+3A_is_approx">is_approx</code></td>
<td>
<p>Boolean. The default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>bsplines</code></td>
<td>
<p>Matrix of orthogonalized B-splines with dimensions <code class="reqn">(p, \text{length}(knots) + \text{degree} + 1)</code></p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Predictors used in generation</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Example: Generate and plot the first 5 orthogonalized B-splines
p &lt;- 30
total_knots &lt;- 10
degree &lt;- 3
boundaries &lt;- c(0, 1)
x &lt;- seq(from = 0, to = 1, length.out = total_knots)
knots &lt;- x[2:(total_knots - 1)]
predictors &lt;- runif(p, min = 0, max = 1)
bsplines &lt;- orthogonize_bspline(knots, boundaries, degree, predictors)

# Plot the first 5 B-splines
index &lt;- order(bsplines$z)
original_par &lt;- par(no.readonly = TRUE)
par(mfrow = c(1, 5))
for (i in 1:5)
  plot(bsplines$z[index], bsplines$bsplines[index, i], main = i, type = "l")
par(original_par)
</code></pre>

<hr>
<h2 id='plot_bic_result'>Internal Function: Plot BIC Results w.r.t. lambda</h2><span id='topic+plot_bic_result'></span>

<h3>Description</h3>

<p>Internal function to plot BIC results with respect to lambda using ggplot2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_bic_result(data, variate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_bic_result_+3A_data">data</code></td>
<td>
<p>Dataframe. A dataframe containing columns <code>lambda</code>, <code>bic</code>.</p>
</td></tr>
<tr><td><code id="plot_bic_result_+3A_variate">variate</code></td>
<td>
<p>Character. A character representing the title.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object.
</p>

<hr>
<h2 id='plot_coefficient_function'>Internal Function: Plot Coefficient Function</h2><span id='topic+plot_coefficient_function'></span>

<h3>Description</h3>

<p>Internal function to plot coefficient functions using ggplot2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_coefficient_function(data, variate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_coefficient_function_+3A_data">data</code></td>
<td>
<p>Dataframe. A dataframe containing columns <code>z</code>, <code>coefficient</code>.</p>
</td></tr>
<tr><td><code id="plot_coefficient_function_+3A_variate">variate</code></td>
<td>
<p>Character. A character representing the title.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object.
</p>

<hr>
<h2 id='plot_sequentially'>Internal Function: Plot Sequentially</h2><span id='topic+plot_sequentially'></span>

<h3>Description</h3>

<p>Internal function to plot ggplot2 objects sequentially.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_sequentially(objs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_sequentially_+3A_objs">objs</code></td>
<td>
<p>List. Valid ggplot2 objects to be plotted sequentially.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>.
</p>

<hr>
<h2 id='plot.qrglasso'>Display BIC Results from <code>qrglasso</code></h2><span id='topic+plot.qrglasso'></span>

<h3>Description</h3>

<p>Visualize the HDIC BIC results corresponding to hyperparameters obtained from <code>qrglasso</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'qrglasso'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.qrglasso_+3A_x">x</code></td>
<td>
<p>An object of class <code>qrglasso</code> for the <code>plot</code> method.</p>
</td></tr>
<tr><td><code id="plot.qrglasso_+3A_...">...</code></td>
<td>
<p>Additional parameters not used directly.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qrglasso">qrglasso</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
n &lt;- 100
p &lt;- 5
L &lt;- 5
Y &lt;- matrix(rnorm(n), n, 1)
W &lt;- matrix(rnorm(n * p * (L - 1)), n, p * (L - 1))

# Call qrglasso with default parameters
result &lt;- qrglasso(Y = Y, W = W, p = p)

# Visualize the BIC results
plot(result)

</code></pre>

<hr>
<h2 id='plot.qrglasso.predict'>Display Predicted Coefficient Functions from <code>qrglasso</code></h2><span id='topic+plot.qrglasso.predict'></span>

<h3>Description</h3>

<p>Visualize the predicted coefficient functions selected by BIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'qrglasso.predict'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.qrglasso.predict_+3A_x">x</code></td>
<td>
<p>An object of class <code>qrglasso.predict</code> for the <code>plot</code> method.</p>
</td></tr>
<tr><td><code id="plot.qrglasso.predict_+3A_...">...</code></td>
<td>
<p>Additional parameters not used directly.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qrglasso">qrglasso</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
n &lt;- 100
p &lt;- 5
L &lt;- 5
Y &lt;- matrix(rnorm(n), n, 1)
W &lt;- matrix(rnorm(n * p * (L - 1)), n, p * (L - 1))

# Call qrglasso with default parameters
result &lt;- qrglasso(Y = Y, W = W, p = p)

# Predict the top-k coefficient functions
estimate &lt;- predict(result, top_k = 2)

# Display the predicted coefficient functions
plot(estimate)

</code></pre>

<hr>
<h2 id='predict'>Predict Top-k Coefficient Functions</h2><span id='topic+predict'></span>

<h3>Description</h3>

<p>Predict the top-k coefficient functions based on a <code>qrglasso</code> class object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict(
  qrglasso_object,
  metric_type = "BIC",
  top_k = 5,
  degree = 2,
  boundaries = c(0, 1),
  is_approx = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_+3A_qrglasso_object">qrglasso_object</code></td>
<td>
<p>A <code>qrglasso</code> class object.</p>
</td></tr>
<tr><td><code id="predict_+3A_metric_type">metric_type</code></td>
<td>
<p>Character. Metric type for gamma selection, e.g., <code>BIC</code>, <code>BIC-log</code>. Default is <code>BIC</code>.</p>
</td></tr>
<tr><td><code id="predict_+3A_top_k">top_k</code></td>
<td>
<p>Integer. The number of top estimated functions to predict. Default is 5.</p>
</td></tr>
<tr><td><code id="predict_+3A_degree">degree</code></td>
<td>
<p>Integer. Degree of the piecewise polynomial. Default is 2.</p>
</td></tr>
<tr><td><code id="predict_+3A_boundaries">boundaries</code></td>
<td>
<p>Array. Two boundary points for the piecewise polynomial. Default is c(0, 1).</p>
</td></tr>
<tr><td><code id="predict_+3A_is_approx">is_approx</code></td>
<td>
<p>Logical. If TRUE, the size of covariate indexes will be 1e6; otherwise, 1e4. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>coef_functions</code></td>
<td>
<p>Matrix. The estimated top-k coefficient functions with dimension (<code class="reqn">m \times k</code>), where <code class="reqn">m</code> is the size of <code>z</code>.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Array. Index predictors used in the generation.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+qrglasso">qrglasso</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
n &lt;- 100
p &lt;- 5
L &lt;- 5
Y &lt;- matrix(rnorm(n), n, 1)
W &lt;- matrix(rnorm(n * p * (L - 1)), n, p * (L - 1))

# Call qrglasso with default parameters
result &lt;- qrglasso(Y = Y, W = W, p = p)
estimate &lt;- predict(result) 
print(dim(estimate$coef_functions))

</code></pre>

<hr>
<h2 id='qrglasso'>Adaptively Weighted Group Lasso</h2><span id='topic+qrglasso'></span>

<h3>Description</h3>

<p>The function <code>qrglasso</code> performs Adaptively Weighted Group Lasso for semiparametric quantile regression models. It estimates the coefficients of a quantile regression model with adaptively weighted group lasso regularization. The algorithm supports the use of B-spline basis functions to model the relationship between covariates and the response variable. Regularization is applied across different groups of covariates, and an adaptive weighting scheme is employed to enhance variable selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qrglasso(
  Y,
  W,
  p,
  omega = NULL,
  tau = 0.5,
  qn = 1,
  lambda = NULL,
  maxit = 1000,
  thr = 1e-04
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qrglasso_+3A_y">Y</code></td>
<td>
<p>A <code class="reqn">n \times 1</code> data matrix where <code class="reqn">n</code> is the sample size.</p>
</td></tr>
<tr><td><code id="qrglasso_+3A_w">W</code></td>
<td>
<p>A <code class="reqn">n \times (p \times L)</code> B-spline matrix where <code class="reqn">L</code> is the number of groups and <code class="reqn">p</code> is the number of covariates.</p>
</td></tr>
<tr><td><code id="qrglasso_+3A_p">p</code></td>
<td>
<p>A numeric indicating the number of covariates.</p>
</td></tr>
<tr><td><code id="qrglasso_+3A_omega">omega</code></td>
<td>
<p>A <code class="reqn">p \times 1</code> weight matrix. Default value is NULL.</p>
</td></tr>
<tr><td><code id="qrglasso_+3A_tau">tau</code></td>
<td>
<p>A numeric quantile of interest. Default value is 0.5.</p>
</td></tr>
<tr><td><code id="qrglasso_+3A_qn">qn</code></td>
<td>
<p>A numeric bound parameter for HDIC. Default value is 1.</p>
</td></tr>
<tr><td><code id="qrglasso_+3A_lambda">lambda</code></td>
<td>
<p>A sequence of tuning parameters. Default value is NULL.</p>
</td></tr>
<tr><td><code id="qrglasso_+3A_maxit">maxit</code></td>
<td>
<p>The maximum number of iterations. Default value is 1000.</p>
</td></tr>
<tr><td><code id="qrglasso_+3A_thr">thr</code></td>
<td>
<p>Threshold for convergence. Default value is <code class="reqn">10^{-4}</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>gamma</code></td>
<td>
<p>A target estimate.</p>
</td></tr>
<tr><td><code>xi</code></td>
<td>
<p>An auxiliary estimate in the ADMM algorithm.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>An auxiliary estimate in the ADMM algorithm.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>A sequence of BIC values with respect to different lambdas.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>A sequence of tuning parameters used in the algorithm.</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>The number of groups.</p>
</td></tr>
<tr><td><code>omega</code></td>
<td>
<p>A <code class="reqn">p \times 1</code> weight matrix used in the algorithm.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wen-Ting Wang
</p>


<h3>References</h3>

<p>Toshio Honda, Ching-Kang Ing, Wei-Ying Wu (2019). Adaptively weighted group Lasso for semiparametric quantile regression models. <em>Bernoulli</em> <b>225</b> 4B.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example: One true non-linear covariate function
# Define the function g1
g1 &lt;- function(x) { 
  (3 * sin(2 * pi * x) / (2 - sin(2 * pi * x))) - 0.4641016 
}

# Set parameters
n &lt;- 100
p &lt;- 50
err_sd &lt;- 0.1 ** 2
tau &lt;- 0.7

# Generate synthetic data
set.seed(1234)
x &lt;- matrix(runif(n * p, min = 0, max = 1), n, p)
error_tau &lt;- rnorm(n, sd = err_sd) - qnorm(tau, sd = err_sd)
y &lt;- g1(x[, 1]) + error_tau
y &lt;- y - mean(y)

# B-spline parameters
total_knots &lt;- 5
degree &lt;- 2
boundaries &lt;- c(0, 1)
xx &lt;- seq(from = 0, to = 1, length.out = total_knots)
knots &lt;- xx[2:(total_knots - 1)]

# Create B-spline matrix W
L &lt;- total_knots + degree - 1
bspline_results &lt;- lapply(1:n, function(i) orthogonize_bspline(knots, boundaries, degree, x[i, ]))
W &lt;- matrix(
   t(sapply(bspline_results, function(result) sqrt(L) * result$bsplines[, -1])), 
   ncol = p * (L - 1),
   byrow = TRUE
)

# Perform quantile regression with group Lasso
n_lambda &lt;- 10
max_lambda &lt;- 10
lambda &lt;- c(0, exp(seq(log(max_lambda / 1e4), log(max_lambda), length = (n_lambda - 1))))
result &lt;- qrglasso(as.matrix(y), W, p)
# BIC Results
plot(result)
# Prediction
estimate = predict(result, top_k = 1)
plot(estimate)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
