<!DOCTYPE html><html><head><title>Help for package CFAcoop</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CFAcoop}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#analyze_survival'><p>analyze_survival</p></a></li>
<li><a href='#calculate_sf'><p>calculate_sf</p></a></li>
<li><a href='#CFAdata'><p>Colony Formation Assay data on cellular cooperation</p></a></li>
<li><a href='#export_sf'><p>export_sf</p></a></li>
<li><a href='#plot_sf'><p>plot_sf</p></a></li>
<li><a href='#pwr_reg'><p>pwr_reg</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Colony Formation Assay: Taking into Account Cellular Cooperation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Samaga &lt;daniel.samaga@helmholtz-muenchen.de&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ZytoHMGU/CFAcoop">https://github.com/ZytoHMGU/CFAcoop</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ZytoHMGU/CFAcoop/issues">https://github.com/ZytoHMGU/CFAcoop/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Cellular cooperation compromises the plating efficiency-based 
    analysis of clonogenic survival data. This tool provides functions that 
    enable a robust analysis of colony formation assay (CFA) data in presence 
    or absence of cellular cooperation. 
    The implemented method has been described 
    in Brix et al. (2020). (Brix, N., Samaga, D., Hennel, R. et al. 
    "The clonogenic assay: robustness of plating efficiency-based analysis is 
    strongly compromised by cellular cooperation." Radiat Oncol 15, 248 (2020).
    &lt;<a href="https://doi.org/10.1186%2Fs13014-020-01697-y">doi:10.1186/s13014-020-01697-y</a>&gt;)
        Power regression for parameter estimation, calculation of survival
    fractions, uncertainty analysis and plotting functions are provided.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>Hmisc</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-06-11 08:06:27 UTC; daniel.samaga</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel Samaga [cre, aut],
  Nikko Brix [aut],
  Kirsten Lauber [aut],
  Horst Zitzelsberger [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-06-11 09:10:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='analyze_survival'>analyze_survival</h2><span id='topic+analyze_survival'></span>

<h3>Description</h3>

<p>wrapper function for robust analysis of clonogenic survival data
from the colony formation assay according to Brix et al. (2020),
Radiation Oncology.
Mean values are calculated and used for power regression.
Resulting coefficients are used for
calculation of survival fractions and corresponding uncertainty analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>analyze_survival(RD, name = "no name", xtreat = NULL, C = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="analyze_survival_+3A_rd">RD</code></td>
<td>
<p>data.frame or matrix containing a table of experiment data</p>
</td></tr>
<tr><td><code id="analyze_survival_+3A_name">name</code></td>
<td>
<p>optional: experiment name (e.g. name of cell line)</p>
</td></tr>
<tr><td><code id="analyze_survival_+3A_xtreat">xtreat</code></td>
<td>
<p>optional: treatment dose of the colonies counted in the
corresponding columns of RD</p>
</td></tr>
<tr><td><code id="analyze_survival_+3A_c">C</code></td>
<td>
<p>number of colonies counted for which the survival fraction is to be
calculated (default = 20))</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list object containing several experiments and treatments organized
for convenient plotting with <code>plot_sf</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>seeded &lt;- rep(10^(seq(1,5,0.5)),each = 3)
df.1 &lt;- data.frame(
  "seeded" = seeded,
  "counted1" = 0.4 * seeded^1.1 * rnorm(n = length(seeded),1,0.05),
  "counted2" = 0.2 * seeded^1.125 * rnorm(n = length(seeded),1,0.05),
  "counted3" = 0.05 * seeded^1.25 * rnorm(n = length(seeded),1,0.05))
df.2 &lt;- data.frame("seeded" = seeded,
  "counted1" = 0.5 * seeded^1.01 * rnorm(n = length(seeded),1,0.05),
  "counted2" = 0.4 * seeded^1.0125 * rnorm(n = length(seeded),1,0.05),
  "counted3" = 0.2 * seeded^1.025 * rnorm(n = length(seeded),1,0.05))
SF &lt;- vector("list",2)
SF[[1]] &lt;- analyze_survival(RD = df.1,
                            name = "cell line a",
                            xtreat = c(0,1,4),
                            C = 20)
SF[[2]] &lt;- analyze_survival(RD = df.2,
                            name = "cell line b",
                            xtreat = c(0,1,4))
</code></pre>

<hr>
<h2 id='calculate_sf'>calculate_sf</h2><span id='topic+calculate_sf'></span>

<h3>Description</h3>

<p>calculates the survival fraction according
to the procedure presented in Brix et al. (2020), which is robust against
cellular cooperation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_sf(par_ref, par_treat, C = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_sf_+3A_par_ref">par_ref</code></td>
<td>
<p><code>summary.lm</code> object or 2-column matrix for the
treatment-free reference survival</p>
</td></tr>
<tr><td><code id="calculate_sf_+3A_par_treat">par_treat</code></td>
<td>
<p><code>summary.lm</code> object or 2-column matrix for the
clonogenic survival after treatment</p>
</td></tr>
<tr><td><code id="calculate_sf_+3A_c">C</code></td>
<td>
<p>colony number for which the survival fraction is calculated
(default = 20)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>survival fractions.
If par_ref and par_treat are <code>summary.lm</code> objects,
a scalar is returned.
If par_ref and par_treat are matrices,
a vector of the same length as nrow(par_treat) is returned
</p>


<h3>Examples</h3>

<pre><code class='language-R'>seeded &lt;- 10^(seq(1, 5, 0.5))
counted.ref &lt;- 0.4 * 10^(seq(1, 5, 0.5) + rnorm(n = 9, 0, 0.1))^1.1
counted.treat &lt;- 0.01 * 10^(seq(1, 5, 0.5) + rnorm(n = 9, 0, 0.1))^1.2
fit_ref &lt;- pwr_reg(seeded = seeded, counted = counted.ref)
fit_treat &lt;- pwr_reg(seeded = seeded, counted = counted.treat)
calculate_sf(par_ref = fit_ref, par_treat = fit_treat)
data("CFAdata")
D &lt;- subset.data.frame(
  x = CFAdata,
  subset = cell.line == levels(CFAdata$cell.line)[1]
)
fit_ref &lt;- pwr_reg(seeded = D$`Cells seeded`, counted = D$`0 Gy`)
fit_treat &lt;- pwr_reg(seeded = D$`Cells seeded`, counted = D$`4 Gy`)
calculate_sf(par_ref = fit_ref, par_treat = fit_treat)
</code></pre>

<hr>
<h2 id='CFAdata'>Colony Formation Assay data on cellular cooperation</h2><span id='topic+CFAdata'></span>

<h3>Description</h3>

<p>Clonogenic survival data from seven cell lines T47D, MDA-MB231, A549,
HCC1806, SKBR3, SKLU1 and BT20 as presented in
Figure 2 in Brix et al. (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(CFAdata)
</code></pre>


<h3>Format</h3>

<p><code>data.frame</code>
</p>


<h3>References</h3>

<p>Brix, N., Samaga, D., Hennel, R. et al.
&quot;The clonogenic assay: robustness of plating efficiency-based analysis is
strongly compromised by cellular cooperation.&quot; Radiat Oncol 15, 248 (2020).
&lt;doi:10.1186/s13014-020-01697-y&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CFAdata)
head(CFAdata)
cll &lt;- levels(CFAdata$cell.line)
</code></pre>

<hr>
<h2 id='export_sf'>export_sf</h2><span id='topic+export_sf'></span>

<h3>Description</h3>

<p>export table with results of clonogenic survival analysis
from the colony formation assay considering cellular cooperation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export_sf(SF)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export_sf_+3A_sf">SF</code></td>
<td>
<p>list build of objects returned by <code>analyze_survival</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame containing all estimated coefficients and effects from
all experiments contained in <code>SF</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>seeded &lt;- rep(10^(seq(1, 5, 0.5)), each = 3)
df.1 &lt;- data.frame(
  "seeded" = seeded,
  "counted1" = 0.4 * seeded^1.1 * rnorm(n = length(seeded), 1, 0.05),
  "counted2" = 0.2 * seeded^1.125 * rnorm(n = length(seeded), 1, 0.05),
  "counted3" = 0.05 * seeded^1.25 * rnorm(n = length(seeded), 1, 0.05)
)
df.2 &lt;- data.frame(
  "seeded" = seeded,
  "counted1" = 0.5 * seeded^1.01 * rnorm(n = length(seeded), 1, 0.05),
  "counted2" = 0.4 * seeded^1.0125 * rnorm(n = length(seeded), 1, 0.05),
  "counted3" = 0.2 * seeded^1.025 * rnorm(n = length(seeded), 1, 0.05)
)
SF &lt;- vector("list", 2)
SF[[1]] &lt;- analyze_survival(
  RD = df.1, name = "cell line a",
  xtreat = c(0, 1, 4)
)
SF[[2]] &lt;- analyze_survival(
  RD = df.2, name = "cell line b",
  xtreat = c(0, 1, 4)
)
export_sf(SF)

data("CFAdata")
SF &lt;- vector("list", 4)
ll &lt;- levels(CFAdata$cell.line)[c(1, 3, 5, 7)]
for (i in seq_along(ll)) {
  cdat &lt;- subset.data.frame(
    x = CFAdata,
    subset = CFAdata$cell.line == ll[i]
  )
  SF[[i]] &lt;- analyze_survival(
    RD = cdat[, -1],
    name = ll[i],
    xtreat = c(0, 1, 2, 4, 6, 8)
  )
}
export_sf(SF)
</code></pre>

<hr>
<h2 id='plot_sf'>plot_sf</h2><span id='topic+plot_sf'></span>

<h3>Description</h3>

<p>plot cellular cooperativity and clonogenic survival for
colony formation assay data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_sf(SF, showUncertainty = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_sf_+3A_sf">SF</code></td>
<td>
<p>list build of objects returned by <code>analyze_survival</code></p>
</td></tr>
<tr><td><code id="plot_sf_+3A_showuncertainty">showUncertainty</code></td>
<td>
<p>logical, switches on/off uncertainty bands for
sf-values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>none
</p>


<h3>Examples</h3>

<pre><code class='language-R'>seeded &lt;- rep(10^(seq(1, 5, 0.5)), each = 3)
df.1 &lt;- data.frame(
  "seeded" = seeded,
  "counted1" = 0.4 * seeded^1.1 * rnorm(n = length(seeded), 1, 0.05),
  "counted2" = 0.2 * seeded^1.125 * rnorm(n = length(seeded), 1, 0.05),
  "counted3" = 0.05 * seeded^1.25 * rnorm(n = length(seeded), 1, 0.05)
)
df.2 &lt;- data.frame(
  "seeded" = seeded,
  "counted1" = 0.5 * seeded^1.01 * rnorm(n = length(seeded), 1, 0.05),
  "counted2" = 0.4 * seeded^1.0125 * rnorm(n = length(seeded), 1, 0.05),
  "counted3" = 0.2 * seeded^1.025 * rnorm(n = length(seeded), 1, 0.05)
)
SF &lt;- vector("list", 2)
SF[[1]] &lt;- analyze_survival(
  RD = df.1, name = "cell line a",
  xtreat = c(0, 1, 4)
)
SF[[2]] &lt;- analyze_survival(
  RD = df.2, name = "cell line b",
  xtreat = c(0, 1, 4)
)
plot_sf(SF)

data("CFAdata")
SF &lt;- vector("list", 4)
ll &lt;- levels(CFAdata$cell.line)[c(1, 3, 5, 7)]
for (i in seq_along(ll)) {
  cdat &lt;- subset.data.frame(
    x = CFAdata,
    subset = CFAdata$cell.line == ll[i]
  )
  SF[[i]] &lt;- analyze_survival(
    RD = cdat[, -1],
    name = ll[i],
    xtreat = c(0, 1, 2, 4, 6, 8)
  )
}
plot_sf(SF)
</code></pre>

<hr>
<h2 id='pwr_reg'>pwr_reg</h2><span id='topic+pwr_reg'></span>

<h3>Description</h3>

<p><code>pwr_reg</code> performs a power regression
(log(C) = log(a) + b * log(S) + e)) for clonogenic assay data of
experiments examining the cellular cooperation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pwr_reg(seeded, counted)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pwr_reg_+3A_seeded">seeded</code></td>
<td>
<p>numeric vector with number of cells seeded (S)</p>
</td></tr>
<tr><td><code id="pwr_reg_+3A_counted">counted</code></td>
<td>
<p>numeric vector with number of colonies counted (C, same
length as <code>seeded</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.lm</code> object as returned by <code><a href="base.html#topic+summary">summary</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pwr_reg(
  seeded = 10^(seq(1, 5, 0.5)),
  counted = 0.4 * (10^seq(1, 5, 0.5))^1.25 * rnorm(n = 9, 1, 0.05)
)
data(CFAdata)
D &lt;- subset.data.frame(
  x = CFAdata,
  subset = cell.line == levels(CFAdata$cell.line)[1]
)
pwr_reg(seeded = D$`Cells seeded`, counted = D$`0 Gy`)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
