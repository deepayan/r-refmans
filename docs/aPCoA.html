<!DOCTYPE html><html><head><title>Help for package aPCoA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {aPCoA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aPCoA'>
<p>Covariate Adjusted PCoA Plot</p></a></li>
<li><a href='#Tasmania'>
<p>Tasmania Dataset</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Covariate Adjusted PCoA Plot</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-12-12</td>
</tr>
<tr>
<td>Author:</td>
<td>Yushu Shi</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yushu Shi &lt;shiyushu2006@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>In fields such as ecology, microbiology, and genomics, non-Euclidean distances are widely applied to describe pairwise dissimilarity between samples. Given these pairwise distances, principal coordinates analysis (PCoA) is commonly used to construct a visualization of the data. However, confounding covariates can make patterns related to the scientific question of interest difficult to observe. We provide 'aPCoA' as an easy-to-use tool to improve data visualization in this context, enabling enhanced presentation of the effects of interest. Details are described in Yushu Shi, Liangliang Zhang, Kim-Anh Do, Christine Peterson and Robert Jenq (2020) Bioinformatics, Volume 36, Issue 13, 4099-4101.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>vegan, randomcoloR, ape, car, cluster</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-12-12 20:47:35 UTC; ys8wp</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-12-13 08:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='aPCoA'>
Covariate Adjusted PCoA Plot
</h2><span id='topic+aPCoA'></span>

<h3>Description</h3>

<p>Adjusted confounding covariates to show the effect of the primary covariate in a PCoA plot. This method is designed for non-Euclidean distance. This function will plot the original PCoA plot along with the covariate adjusted PCoA plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aPCoA(formula,data,maincov,drawEllipse=TRUE,drawCenter=TRUE,
pch=19,cex=2,lwd=3,col=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aPCoA_+3A_formula">formula</code></td>
<td>
<p>A typical formula such as Y~ A, but here Y is a dissimilarity distance. The formula has the same requirements as in adonis function of the vegan package.</p>
</td></tr>
<tr><td><code id="aPCoA_+3A_data">data</code></td>
<td>
<p>A dataset with the rownames the same as the rownames in distance. This dataset should include both the confounding covariate and the primary covariate.</p>
</td></tr>
<tr><td><code id="aPCoA_+3A_maincov">maincov</code></td>
<td>
<p>the covariate of interest in the dataset, must be a factor</p>
</td></tr>
<tr><td><code id="aPCoA_+3A_drawellipse">drawEllipse</code></td>
<td>
<p>Do you want to draw the 95% confidence elipse for each cluster?</p>
</td></tr>
<tr><td><code id="aPCoA_+3A_drawcenter">drawCenter</code></td>
<td>
<p>Do you want to show the connection between cluster center (medoid) and cluster members?</p>
</td></tr>
<tr><td><code id="aPCoA_+3A_pch">pch</code></td>
<td>
<p>Point shapes</p>
</td></tr>
<tr><td><code id="aPCoA_+3A_cex">cex</code></td>
<td>
<p>Number indicating the amount by which plotting text and symbols should be scaled relative to the default.</p>
</td></tr>
<tr><td><code id="aPCoA_+3A_lwd">lwd</code></td>
<td>
<p>Line width of the ellipses</p>
</td></tr>
<tr><td><code id="aPCoA_+3A_col">col</code></td>
<td>
<p>Color for plot. If not provided by user, will use default distinct colors</p>
</td></tr>
<tr><td><code id="aPCoA_+3A_...">...</code></td>
<td>
<p>Arguments passed to 'dataEllipse'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Two PCoA plots. One is the original one, while the other is the PCoA plot after adjusting for the confounding covariate.
</p>
<table>
<tr><td><code>plotMatrix</code></td>
<td>
<p>The matrix for plotting the adjusted PCoA plot.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Yushu Shi, Liangliang Zhang, Kim-Anh Do, Christine Peterson and Robert Jenq. (2020) aPCoA: Covariate Adjusted Principal Coordinates Analysis &lt;arXiv:2003.09544&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(vegan)
library(aPCoA)
data("Tasmania")
data&lt;-data.frame(treatment=Tasmania$treatment,block=Tasmania$block)
bray&lt;-vegdist(Tasmania$abund, method="bray")
rownames(data)&lt;-rownames(as.matrix(bray))
opar&lt;-par(mfrow=c(1,2),
          mar=c(3.1, 3.1, 3.1, 5.1),
          mgp=c(2, 0.5, 0),
          oma=c(0, 0, 0, 4))
result&lt;-aPCoA(bray~block,data,treatment)
par(opar)
</code></pre>

<hr>
<h2 id='Tasmania'>
Tasmania Dataset
</h2><span id='topic+Tasmania'></span>

<h3>Description</h3>

<p>A classic dataset used in the R package mvabund. This is a study on the effects of disturbance from a soldier crab on 56 species of meiobenthos, which are small invertebrates. Eight of the sixteen observations in the data set correspond to crab disturbances. Besides the crab disturbance, there are also four different locations in the study design, where observations from each location are comprised of two disturbed and two undisturbed ones. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  data(Tasmania)
</code></pre>


<h3>Format</h3>


<dl>
<dt>abund</dt><dd><p>The counts of 56 Meibenthos species.</p>
</dd>
<dt>treatment</dt><dd><p>This observation has been disturbed by a crab or not.</p>
</dd>
<dt>block</dt><dd><p>The location indicator of the observation.</p>
</dd>
</dl>



<h3>References</h3>

<p>Wang, Y., Naumann, U., Wright, S.T. and Warton, D.I. (2012), mvabund - an R package for model-based analysis of multivariate abundance data. Methods in Ecology and Evolution, 3: 471-474. doi:10.1111/j.2041-210X.2012.00190.x
</p>
<p>Warwick, R. M., Clarke, K. R. and Gee, J. M. (1990). The effect of disturbance by soldier crabs Mictyris platycheles H. Milne Edwards on meiobenthic communiy structure. J. Exp. Mar. Biol. Ecol., 135, 19-33.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data("Tasmania")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
