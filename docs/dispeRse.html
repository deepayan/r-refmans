<!DOCTYPE html><html><head><title>Help for package dispeRse</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dispeRse}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.to_grid'><p>Convert from geographic coordinates in a given projection system to the</p>
relative position in rows and columns of a grid.</a></li>
<li><a href='#euro_dates'><p>Coordinates and earliest dates (med cal BP) for European Neolithic sites.</p>
Dataset adapted from the supplementary information in Pinhasi et al. 2005
(https://doi.org/10.1371/journal.pbio.0030410).</a></li>
<li><a href='#euro_npp'><p>Transformed Net Primary Production (NPP) from 11 ka to 4 ka at 1000 yr steps.</p>
Calculated with the Miami formula using paleoclimatic data from Beyer et al. 2020.
(https://doi.org/10.1038/s41597-020-0552-1). Clipped to max=1350, squared and
scaled to [0,1].</a></li>
<li><a href='#euro_terr'><p>Reclassified terrain layer with elevation &gt; 1750 m as barriers and rivers</p>
and coastline as corridors. Terrain reclassified from SRTM. Rivers rasterized
from GSHHG (https://www.soest.hawaii.edu/pwessel/gshhg/) and coastline
rasterized from rnaturalearth.</a></li>
<li><a href='#ppnb'><p>Coordinates and earliest dates (med cal BP) for Late Pre-Pottery Neolithic B</p>
sites in the Near East. Dataset adapted from the supplementary information
in Pinhasi et al. 2005 (https://doi.org/10.1371/journal.pbio.0030410).</a></li>
<li><a href='#simulate_dispersal'><p>Simulates first arrival times from one or more origins.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Simulation of Demic Diffusion with Environmental Constraints</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Simulates demic diffusion building on models previously developed
	for the expansion of Neolithic and other food-producing economies during
	the Holocene (Fort et al. (2012) &lt;<a href="https://doi.org/10.7183%2F0002-7316.77.2.203">doi:10.7183/0002-7316.77.2.203</a>&gt;, Souza et al.
	(2021) &lt;<a href="https://doi.org/10.1098%2Frsif.2021.0499">doi:10.1098/rsif.2021.0499</a>&gt;). Growth and emigration are modelled as
	density-dependent processes using logistic growth and an asymptotic threshold
	model. Environmental and terrain layers, which can change over time, affect
	carrying capacity, growth and mobility. Multiple centres of origin with
	their respective starting times can be specified.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>raster, sp, sf</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-03 15:34:20 UTC; jgregorio</td>
</tr>
<tr>
<td>Author:</td>
<td>Jonas Gregorio de Souza
    <a href="https://orcid.org/0000-0001-6032-4443"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jonas Gregorio de Souza &lt;jonas.gregorio@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-03 16:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='.to_grid'>Convert from geographic coordinates in a given projection system to the
relative position in rows and columns of a grid.</h2><span id='topic+.to_grid'></span>

<h3>Description</h3>

<p>Convert from geographic coordinates in a given projection system to the
relative position in rows and columns of a grid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.to_grid(coords, grid)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".to_grid_+3A_coords">coords</code></td>
<td>
<p>A SpatialPointsDataFrame. Must contain a column dates with the
start date of the dispersal from each point.</p>
</td></tr>
<tr><td><code id=".to_grid_+3A_grid">grid</code></td>
<td>
<p>A Raster*. The coordinates will be converted to this grid.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A DataFrame with the converted coordinates.
</p>

<hr>
<h2 id='euro_dates'>Coordinates and earliest dates (med cal BP) for European Neolithic sites.
Dataset adapted from the supplementary information in Pinhasi et al. 2005
(https://doi.org/10.1371/journal.pbio.0030410).</h2><span id='topic+euro_dates'></span>

<h3>Description</h3>

<p>Coordinates and earliest dates (med cal BP) for European Neolithic sites.
Dataset adapted from the supplementary information in Pinhasi et al. 2005
(https://doi.org/10.1371/journal.pbio.0030410).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>euro_dates
</code></pre>


<h3>Format</h3>

<p>A SpatialPointsDataFrame object.
</p>

<hr>
<h2 id='euro_npp'>Transformed Net Primary Production (NPP) from 11 ka to 4 ka at 1000 yr steps.
Calculated with the Miami formula using paleoclimatic data from Beyer et al. 2020.
(https://doi.org/10.1038/s41597-020-0552-1). Clipped to max=1350, squared and
scaled to [0,1].</h2><span id='topic+euro_npp'></span>

<h3>Description</h3>

<p>Transformed Net Primary Production (NPP) from 11 ka to 4 ka at 1000 yr steps.
Calculated with the Miami formula using paleoclimatic data from Beyer et al. 2020.
(https://doi.org/10.1038/s41597-020-0552-1). Clipped to max=1350, squared and
scaled to [0,1].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>euro_npp
</code></pre>


<h3>Format</h3>

<p>A RasterStack object.
</p>

<hr>
<h2 id='euro_terr'>Reclassified terrain layer with elevation &gt; 1750 m as barriers and rivers
and coastline as corridors. Terrain reclassified from SRTM. Rivers rasterized
from GSHHG (https://www.soest.hawaii.edu/pwessel/gshhg/) and coastline
rasterized from rnaturalearth.</h2><span id='topic+euro_terr'></span>

<h3>Description</h3>

<p>Reclassified terrain layer with elevation &gt; 1750 m as barriers and rivers
and coastline as corridors. Terrain reclassified from SRTM. Rivers rasterized
from GSHHG (https://www.soest.hawaii.edu/pwessel/gshhg/) and coastline
rasterized from rnaturalearth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>euro_terr
</code></pre>


<h3>Format</h3>

<p>A RasterLayer object.
</p>

<hr>
<h2 id='ppnb'>Coordinates and earliest dates (med cal BP) for Late Pre-Pottery Neolithic B
sites in the Near East. Dataset adapted from the supplementary information
in Pinhasi et al. 2005 (https://doi.org/10.1371/journal.pbio.0030410).</h2><span id='topic+ppnb'></span>

<h3>Description</h3>

<p>Coordinates and earliest dates (med cal BP) for Late Pre-Pottery Neolithic B
sites in the Near East. Dataset adapted from the supplementary information
in Pinhasi et al. 2005 (https://doi.org/10.1371/journal.pbio.0030410).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppnb
</code></pre>


<h3>Format</h3>

<p>A DataFrame object.
</p>

<hr>
<h2 id='simulate_dispersal'>Simulates first arrival times from one or more origins.</h2><span id='topic+simulate_dispersal'></span>

<h3>Description</h3>

<p>The model uses density-dependent growth and emigration. The carrying
capacity, growth rates and mobility are allowed to vary with the environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_dispersal(
  environment,
  terrain,
  coords,
  years,
  r = 0.025,
  phi = 0.5,
  t = 30,
  dist = 50,
  accel = 3,
  gamma = 1,
  updates = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_dispersal_+3A_environment">environment</code></td>
<td>
<p>A Raster*. Environmental values that affect carrying
capacity and growth rate. Typically given as a fraction (0-1) of the max K.
If the environment will be updated during the experiment, this parameter
must be a raster stack.</p>
</td></tr>
<tr><td><code id="simulate_dispersal_+3A_terrain">terrain</code></td>
<td>
<p>A Raster*. Cells with value 1 are barriers and cells with
value 2 are corridors. If the terrain will be updated during the experiment,
this parameter must be a raster stack.</p>
</td></tr>
<tr><td><code id="simulate_dispersal_+3A_coords">coords</code></td>
<td>
<p>A DataFrame. Must contain columns x, y, and date with the
coordinates and starting date (yr BP) of each origin. Coordinates must be in
the same system as the environment and terrain layers.</p>
</td></tr>
<tr><td><code id="simulate_dispersal_+3A_years">years</code></td>
<td>
<p>Numeric. Number of years to run the model for.</p>
</td></tr>
<tr><td><code id="simulate_dispersal_+3A_r">r</code></td>
<td>
<p>Numeric. The annual growth rate as a decimal.</p>
</td></tr>
<tr><td><code id="simulate_dispersal_+3A_phi">phi</code></td>
<td>
<p>Numeric. The emigration threshold as a fraction of carrying
capacity.</p>
</td></tr>
<tr><td><code id="simulate_dispersal_+3A_t">t</code></td>
<td>
<p>Numeric. The duration, in years, of a generation (model time step).</p>
</td></tr>
<tr><td><code id="simulate_dispersal_+3A_dist">dist</code></td>
<td>
<p>Numeric. The distance, in km, that migrants move over a
generation.</p>
</td></tr>
<tr><td><code id="simulate_dispersal_+3A_accel">accel</code></td>
<td>
<p>Numeric. The factor by which the usual distance is increased
along corridors. E.g. if dist = 50 km and accel = 3, migrants can move up to
150 km along a corridor. Must range from 2 to 4.</p>
</td></tr>
<tr><td><code id="simulate_dispersal_+3A_gamma">gamma</code></td>
<td>
<p>Numeric. A power that controls the shape of the dependency
between r and the environment.</p>
</td></tr>
<tr><td><code id="simulate_dispersal_+3A_updates">updates</code></td>
<td>
<p>Numeric. Optional vector with the years at which the
environment and terrain grids will be updated.</p>
</td></tr>
<tr><td><code id="simulate_dispersal_+3A_verbose">verbose</code></td>
<td>
<p>Boolean. If TRUE, write messages to the console.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The simulation starts with n populated cells at coordinates and start times
defined by the parameter coords and runs for a number of time. Each time step
corresponds to a generation (defined by parameter t). Growth is applied to
every populated cell using a logistic model and emigration to a neighboring
cell is calculated from an asymptotic threshold model.
</p>
<p>The carrying capacity (K) in the density-dependend growth and emigration
models is determined by an environment raster, which normally represents a
variable or combination of variables assumed to affect population density
(e.g. net primary production, elevation) scaled to 0-1 range.
</p>
<p>The dependence of the carrying capacity and growth rate on the environment
is allowed to be controlled by a power gamma. By default, the dependence is
linear (gamma = 1).
</p>
<p>For emigration, a threshold phi is considered, expressed as a fraction of
carrying capacity. Migrants are distributed among the available cells of the
Moore neighborhood proportionally to the inverse of the distance squared.
</p>
<p>Terrain can be represented by a raster specifying barriers (e.g. mountains),
which block movement, and corridors (e.g. rivers), which accelerate movement.
For the latter, an acceleration factor can be specified.
</p>


<h3>Value</h3>

<p>A RasterLayer with simulated arrival times.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>terr &lt;- raster::stack(replicate(8, euro_terr))
sim &lt;- simulate_dispersal(euro_npp, terr, ppnb, 5500, phi=0.33, updates=seq(10000,4000,-1000))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
