<!DOCTYPE html><html lang="en"><head><title>Help for package leafdown</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {leafdown}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#assert_join_map_levels_by'><p>Check whether the given join_map_levels_by is valid</p></a></li>
<li><a href='#assert_spdf_list'><p>Check whether the given spdf_list is a valid spdf_list and has all the required params.</p></a></li>
<li><a href='#check_draw_ellipsis'><p>Checks for undesired arguments in ellipsis in $draw_leafdown method</p></a></li>
<li><a href='#gdp_2014_admin_districts'><p>GPD for administrative districts of Germany for 2014.</p></a></li>
<li><a href='#gdp_2014_federal_states'><p>GPD for federal states of Germany for 2014.</p></a></li>
<li><a href='#Leafdown'><p>Leafdown R6 Class</p></a></li>
<li><a href='#us_election_counties'><p>Results of the 2016 US Presidential Election - County Level</p></a></li>
<li><a href='#us_election_states'><p>Results of the 2016 US Presidential Election - State Level</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Provides Drill Down Functionality for 'leaflet' Choropleths</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides drill down functionality for 'leaflet' choropleths in 'shiny' apps.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, testthat, knitr, rmarkdown, shinytest, dplyr,
htmltools, raster, rmapshaper, shinycssloaders</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>R6, leaflet, magrittr, checkmate, shiny, shinyjs</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, shinycssloaders</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-12 19:28:03 UTC; andre</td>
</tr>
<tr>
<td>Author:</td>
<td>Andreas Hofheinz [cre],
  Peter Gandenberger [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andreas Hofheinz &lt;andreas.hofheinz@outlook.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-19 06:06:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='assert_join_map_levels_by'>Check whether the given join_map_levels_by is valid</h2><span id='topic+assert_join_map_levels_by'></span>

<h3>Description</h3>

<p>The join_map_levels_by must be a named vector of at most one element.
The columns specified in the vector must be data slots of the spdfs in the spdfs_list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assert_join_map_levels_by(join_map_levels_by, spdfs_list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="assert_join_map_levels_by_+3A_join_map_levels_by">join_map_levels_by</code></td>
<td>
<p>A named vector with the columns to join the map levels by.</p>
</td></tr>
<tr><td><code id="assert_join_map_levels_by_+3A_spdfs_list">spdfs_list</code></td>
<td>
<p>A list with the spdfs of all map levels.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the join_map_levels_by in the right order
</p>

<hr>
<h2 id='assert_spdf_list'>Check whether the given spdf_list is a valid spdf_list and has all the required params.</h2><span id='topic+assert_spdf_list'></span>

<h3>Description</h3>

<p>The spdf_list must be a list of at most two elements.
All elements must be a s4 class of type SpatialPolygonsDataFrame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assert_spdf_list(spdfs_list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="assert_spdf_list_+3A_spdfs_list">spdfs_list</code></td>
<td>
<p>A list with the spdfs of all map levels</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if spdf_list is valid.
</p>

<hr>
<h2 id='check_draw_ellipsis'>Checks for undesired arguments in ellipsis in $draw_leafdown method</h2><span id='topic+check_draw_ellipsis'></span>

<h3>Description</h3>

<p>Checks arguments in ellipsis for undesired inputs such as 'layerId' which may
collide with internal structure of leafdown and returns a &quot;cleaned&quot; version of
the arguments by removing or redefining problematic inputs.
e.g. 'layerId' is removed from arg_list when set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_draw_ellipsis(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_draw_ellipsis_+3A_...">...</code></td>
<td>
<p>Additional arguments given to <code>leaflet::addPolygons</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing arguments in ... as elements
</p>

<hr>
<h2 id='gdp_2014_admin_districts'>GPD for administrative districts of Germany for 2014.</h2><span id='topic+gdp_2014_admin_districts'></span>

<h3>Description</h3>

<p>A dataset containing the GPD (gross domestic product) for 402 administrative districts
of Germany for the year 2014.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gdp_2014_admin_districts
</code></pre>


<h3>Format</h3>

<p>A data frame with 402 rows and 2 variables:
</p>

<dl>
<dt>Admin_District</dt><dd><p>Name of the administrative district</p>
</dd>
<dt>GDP_2014</dt><dd><p>GDP for the year 2014, in euro</p>
</dd>
</dl>



<h3>Source</h3>

<p>Landatlas (www.landatlas.de). Ausgabe 2018.
Hrsg.: Thuenen-Institut fuer Laendliche Raeume - Braunschweig 2018.
</p>
<p>Note that in this package we have slightly adapted some names of the
administrative districts for a better match.
</p>

<hr>
<h2 id='gdp_2014_federal_states'>GPD for federal states of Germany for 2014.</h2><span id='topic+gdp_2014_federal_states'></span>

<h3>Description</h3>

<p>A dataset containing the GPD (gross domestic product) for all 16 federal states
of Germany for the year 2014.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gdp_2014_federal_states
</code></pre>


<h3>Format</h3>

<p>A data frame with 16 rows and 2 variables:
</p>

<dl>
<dt>Federal_State</dt><dd><p>Name of the federal state</p>
</dd>
<dt>GDP_2014</dt><dd><p>GDP for the year 2014, in euro</p>
</dd>
</dl>



<h3>Source</h3>

<p>Arbeitskreis Volkswirtschaftliche Gesamtrechnungen der Laender:
<a href="https://www.deutschlandinzahlen.de">https://www.deutschlandinzahlen.de</a>
</p>

<hr>
<h2 id='Leafdown'>Leafdown R6 Class</h2><span id='topic+Leafdown'></span>

<h3>Description</h3>

<p>This class acts as a wrapper around a leafdown map.
</p>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>curr_sel_data</code></dt><dd><p>A <code>reactiveValue</code> containing a data.frame with
the metadata and (if available) the corresponding values of all currently selected shapes.</p>
</dd>
<dt><code>curr_data</code></dt><dd><p>The metadata and (if available) the corresponding values of all currently displayed shapes.</p>
</dd>
<dt><code>curr_map_level</code></dt><dd><p>Index of the current map level.
This corresponds to the position of the shapes in the <code>spdfs_list</code>.
(i.e The highest-level is 1, the next is 2 and so on...).</p>
</dd>
<dt><code>curr_poly_ids</code></dt><dd><p>The ids of all polygons of the current map level.</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-new"><code>Leafdown$new()</code></a>
</p>
</li>
<li> <p><a href="#method-draw_leafdown"><code>Leafdown$draw_leafdown()</code></a>
</p>
</li>
<li> <p><a href="#method-keep_zoom"><code>Leafdown$keep_zoom()</code></a>
</p>
</li>
<li> <p><a href="#method-add_data"><code>Leafdown$add_data()</code></a>
</p>
</li>
<li> <p><a href="#method-drill_down"><code>Leafdown$drill_down()</code></a>
</p>
</li>
<li> <p><a href="#method-drill_up"><code>Leafdown$drill_up()</code></a>
</p>
</li>
<li> <p><a href="#method-toggle_shape_select"><code>Leafdown$toggle_shape_select()</code></a>
</p>
</li>
<li> <p><a href="#method-clone"><code>Leafdown$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-new"></a>



<h4>Method <code>new()</code></h4>

<p>Initializes the leafdown object.
</p>


<h5>Usage</h5>

<div class="r"><pre>Leafdown$new(spdfs_list, map_output_id, input, join_map_levels_by = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>spdfs_list</code></dt><dd><p>A list with the spdfs of all map levels. This cannot be changed later.</p>
</dd>
<dt><code>map_output_id</code></dt><dd><p>The id from the shiny-ui used in the <code>leafletOutput("&lt;&lt;id&gt;&gt;")</code>.
Used to observe for _shape_click events.</p>
</dd>
<dt><code>input</code></dt><dd><p>The <code>input</code> from the shiny app.</p>
</dd>
<dt><code>join_map_levels_by</code></dt><dd><p>A named vector of length <code>length(spdfs_list) - 1</code> with the columns by which the map
levels should be joined. The first element defines how the first and second map levels should be joined, the second
element does the same for the second and third map levels and so on. The name of an element defines the name of
the join column in the upper map level and the actual element the join column of the lower map level.
By default this is set to c(&quot;GID_0&quot; = &quot;GID_0&quot;, &quot;GID_1&quot; = &quot;GID_1&quot;, ..., &quot;GID_n&quot; = &quot;GID_n&quot;),
where n is <code>length(spdfs_list) - 1</code>.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-draw_leafdown"></a>



<h4>Method <code>draw_leafdown()</code></h4>

<p>Draws the leaflet map on the current map level. All unselected parents will be drawn in gray.
</p>


<h5>Usage</h5>

<div class="r"><pre>Leafdown$draw_leafdown(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt><dd><p>Additional arguments given to <code>leaflet::addPolygons</code></p>
</dd>
</dl>

</div>


<hr>
<a id="method-keep_zoom"></a>



<h4>Method <code>keep_zoom()</code></h4>

<p>Keeps the zoom after <code>drill_down</code> and <code>drill_up</code> events.
</p>


<h5>Usage</h5>

<div class="r"><pre>Leafdown$keep_zoom(map, input)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>map</code></dt><dd><p>the map output from <code>draw_leafdown</code></p>
</dd>
<dt><code>input</code></dt><dd><p>the input object from the shiny app</p>
</dd>
</dl>

</div>


<hr>
<a id="method-add_data"></a>



<h4>Method <code>add_data()</code></h4>

<p>Adds the data to the currently displayed shapes.
This includes the meta-data AND the values to be visualized in the map.
</p>


<h5>Usage</h5>

<div class="r"><pre>Leafdown$add_data(data)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>data</code></dt><dd><p>The new data existing of the meta-data and the values to display in the map(color)</p>
</dd>
</dl>

</div>


<hr>
<a id="method-drill_down"></a>



<h4>Method <code>drill_down()</code></h4>

<p>Drills down to the lower level if:
</p>

<ul>
<li><p> there is a lower level (for now there are only two levels)
</p>
</li>
<li><p> at least one shape is selected to drill down on
</p>
</li></ul>

<p>This will not redraw the map. Also call <code>add_data</code> to add data for the new level and then
<code>draw_leafdown</code> to redraw the map on the new level.
</p>


<h5>Usage</h5>

<div class="r"><pre>Leafdown$drill_down()</pre></div>


<hr>
<a id="method-drill_up"></a>



<h4>Method <code>drill_up()</code></h4>

<p>Drills up to the higher level if:
</p>

<ul>
<li><p> there is a higher level (for now there are only two levels)
</p>
</li></ul>

<p>This will not redraw the map. Also call <code>add_data</code> to add data for the new level and then
<code>draw_leafdown</code> to redraw the map on the new level.
</p>


<h5>Usage</h5>

<div class="r"><pre>Leafdown$drill_up()</pre></div>


<hr>
<a id="method-toggle_shape_select"></a>



<h4>Method <code>toggle_shape_select()</code></h4>

<p>Selects the shape with the given shape id, or unselects it if it was already selected.
</p>


<h5>Usage</h5>

<div class="r"><pre>Leafdown$toggle_shape_select(shape_id)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>shape_id</code></dt><dd><p>the id of the shape to select, has to be a character and in the current map-level.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>Leafdown$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>




<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

library(leafdown)
library(leaflet)
library(shiny)
library(dplyr)
library(shinyjs)

ger1 &lt;- raster::getData(country = "Germany", level = 1)
ger2 &lt;- raster::getData(country = "Germany", level = 2)
spdfs_list &lt;- list(ger1, ger2)

ui &lt;- shiny::fluidPage(
  useShinyjs(),
  actionButton("drill_down", "Drill Down"),
  actionButton("drill_up", "Drill Up"),
  leafletOutput("leafdown")
)

server &lt;- function(input, output) {
  my_leafdown &lt;- Leafdown$new(spdfs_list, "leafdown", input)
  update_leafdown &lt;- reactiveVal(0)

  observeEvent(input$drill_down, {
    my_leafdown$drill_down()
    update_leafdown(update_leafdown() + 1)
  })

  observeEvent(input$drill_up, {
    my_leafdown$drill_up()
   update_leafdown(update_leafdown() + 1)
 })

  output$leafdown &lt;- renderLeaflet({
    update_leafdown()
    meta_data &lt;- my_leafdown$curr_data
    curr_map_level &lt;- my_leafdown$curr_map_level
    if (curr_map_level == 1) {
      data &lt;- meta_data %&gt;%
        left_join(gdp_2014_federal_states, by = c("NAME_1" = "Federal_State"))
    } else {
      data &lt;- meta_data %&gt;%
        left_join(gdp_2014_admin_districts, by = c("NAME_2" = "Admin_District"))
    }

    my_leafdown$add_data(data)
    my_leafdown$draw_leafdown(
      fillColor = ~ colorNumeric("Greens", GDP_2014)(GDP_2014), weight = 2, color = "grey"
    )
  })
}

shinyApp(ui, server)


## End(Not run)

</code></pre>

<hr>
<h2 id='us_election_counties'>Results of the 2016 US Presidential Election - County Level</h2><span id='topic+us_election_counties'></span>

<h3>Description</h3>

<p>A dataset containing the results of the presidential election and census data (e.g. racial makeup, unemployment)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>us_election_counties
</code></pre>


<h3>Format</h3>

<p>A data frame with 3,143 rows and 17 total columns
</p>

<dl>
<dt>State</dt><dd><p>Name of the State</p>
</dd>
<dt>ST</dt><dd><p>Abbreviation of the State name</p>
</dd>
<dt>County</dt><dd><p>Name of the County</p>
</dd>
<dt>Votes</dt><dd><p>Total number of votes cast</p>
</dd>
<dt>Republicans2016</dt><dd><p>Percent of votes for the Republican Party</p>
</dd>
<dt>Democrats2016</dt><dd><p>Percent of votes for the Democratic Party</p>
</dd>
<dt>Green2016</dt><dd><p>Percent of votes for the Green Party</p>
</dd>
<dt>Libertarians2016</dt><dd><p>Percent of votes for the Libertarian Party</p>
</dd>
<dt>TotalPopulation</dt><dd><p>Total Population of the county</p>
</dd>
<dt>Unemployment</dt><dd><p>Percent of unemployment</p>
</dd>
<dt>White</dt><dd><p>Percentage of Whites</p>
</dd>
<dt>Black</dt><dd><p>Percentage of Blacks</p>
</dd>
<dt>Hispanic</dt><dd><p>Percentage of Hispanics</p>
</dd>
<dt>Asian</dt><dd><p>Percentage of Asians</p>
</dd>
<dt>Amerindian</dt><dd><p>Percentage of Amerindians</p>
</dd>
<dt>Other</dt><dd><p>Percentage of Other Races</p>
</dd>
<dt>NAME_2</dt><dd><p>The short County name, used for matching with the map</p>
</dd>
</dl>



<h3>Source</h3>

<p>https://github.com/Deleetdk/USA.county.data
</p>

<hr>
<h2 id='us_election_states'>Results of the 2016 US Presidential Election - State Level</h2><span id='topic+us_election_states'></span>

<h3>Description</h3>

<p>A dataset containing the results of the presidential election and census data (e.g. racial makeup, unemployment)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>us_election_states
</code></pre>


<h3>Format</h3>

<p>A data frame with 51 rows and 15 total columns
</p>

<dl>
<dt>State</dt><dd><p>Name of the State</p>
</dd>
<dt>ST</dt><dd><p>Abbreviation of the State name</p>
</dd>
<dt>Votes</dt><dd><p>Total number of votes cast</p>
</dd>
<dt>Republicans2016</dt><dd><p>Percent of votes for the Republican Party</p>
</dd>
<dt>Democrats2016</dt><dd><p>Percent of votes for the Democratic Party</p>
</dd>
<dt>Green2016</dt><dd><p>Percent of votes for the Green Party</p>
</dd>
<dt>Libertarians2016</dt><dd><p>Percent of votes for the Libertarian Party</p>
</dd>
<dt>TotalPopulation</dt><dd><p>Total Population of the county</p>
</dd>
<dt>Unemployment</dt><dd><p>Percent of unemployment</p>
</dd>
<dt>White</dt><dd><p>Percentage of Whites</p>
</dd>
<dt>Black</dt><dd><p>Percentage of Blacks</p>
</dd>
<dt>Hispanic</dt><dd><p>Percentage of Hispanics</p>
</dd>
<dt>Asian</dt><dd><p>Percentage of Asians</p>
</dd>
<dt>Amerindian</dt><dd><p>Percentage of Amerindians</p>
</dd>
<dt>Other</dt><dd><p>Percentage of Other Races</p>
</dd>
</dl>



<h3>Source</h3>

<p>https://github.com/Deleetdk/USA.county.data
</p>
<p>Note: The data was aggregated from the county level
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
