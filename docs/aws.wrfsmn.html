<!DOCTYPE html><html lang="en"><head><title>Help for package aws.wrfsmn</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {aws.wrfsmn}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Daily data to monthly</p></a></li>
<li><a href='#daily.data.fields'><p>Daily data is obtained from hourly data</p></a></li>
<li><a href='#eva'><p>Evaporation data (observation and model)</p></a></li>
<li><a href='#find.nearest.point'><p>Temporal series of closest location</p></a></li>
<li><a href='#get.wrf.files'><p>List of available files for downloading</p></a></li>
<li><a href='#ith'><p>Calculation of ITH index</p></a></li>
<li><a href='#load.by.variable'><p>Load and projection of data</p></a></li>
<li><a href='#mg.evaluation'><p>Evaluation of regression</p></a></li>
<li><a href='#multiple.guidance'><p>Multiple lineal regression of data</p></a></li>
<li><a href='#ploting'><p>Plot of data</p></a></li>
<li><a href='#wrf.download'><p>Download of wrf files</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Data Processing of SMN Hi-Res Weather Forecast from 'AWS'</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.5</td>
</tr>
<tr>
<td>Description:</td>
<td>Exploration of Weather Research &amp; Forecasting ('WRF') Model data
    of Servicio Meteorologico Nacional (SMN) from Amazon Web Services
    (<a href="https://registry.opendata.aws/smn-ar-wrf-dataset/">https://registry.opendata.aws/smn-ar-wrf-dataset/</a>) cloud. The package
    provides the possibility of data downloading, processing and correction
    methods. It also has map management and series exploration of available
    meteorological variables of 'WRF' forecast.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>aws.s3 (&ge; 0.3.21), lubridate (&ge; 1.9.3), terra (&ge; 1.7-65),
dplyr (&ge; 1.1.4), ggplot2 (&ge; 3.4.4), hydroGOF (&ge; 0.5-4),
stats (&ge; 4.1.2), magrittr (&ge; 2.0.3)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-06 22:57:00 UTC; gonzalo</td>
</tr>
<tr>
<td>Author:</td>
<td>Gonzalo Diaz [cre, aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gonzalo Diaz &lt;gonzalomartindiaz22@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-06 23:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Daily data to monthly</h2><span id='topic++25+3E+25'></span><span id='topic+daily2monthly'></span>

<h3>Description</h3>

<p>Data transformation from daily to monthly scale
</p>


<h3>Usage</h3>

<pre><code class='language-R'>daily2monthly(data = data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_data">data</code></td>
<td>
<p>matrix with daily data from mg.evaluation output function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with monthly data
</p>

<hr>
<h2 id='daily.data.fields'>Daily data is obtained from hourly data</h2><span id='topic+daily.data.fields'></span>

<h3>Description</h3>

<p>....
</p>


<h3>Usage</h3>

<pre><code class='language-R'>daily.data.fields(raster.list, aggregate)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="daily.data.fields_+3A_raster.list">raster.list</code></td>
<td>
<p>Spat Raster variable with several times for a unique variable (T2 or HR2 or ...)</p>
</td></tr>
<tr><td><code id="daily.data.fields_+3A_aggregate">aggregate</code></td>
<td>
<p>Type of aggregation (sum, mean, min, max)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Spat Raster with daily information
</p>

<hr>
<h2 id='eva'>Evaporation data (observation and model)</h2><span id='topic+eva'></span>

<h3>Description</h3>

<p>Data of evaporation from in-situ observation and several soil model outputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(eva)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.frame"</code>.
</p>

<dl>
<dt>Dates</dt><dd><p>1st column with dates</p>
</dd>
<dt>evapo_obs</dt><dd><p>2nd column with evaporation observation</p>
</dd>
<dt>OUT_PREC</dt><dd><p>Precipitation</p>
</dd>
<dt>OUT_EVAP</dt><dd><p>Evaporation</p>
</dd>
<dt>OUT_RUNOFF</dt><dd><p>Runoff</p>
</dd>
<dt>OUT_BASEFLOW</dt><dd><p>Baseflow</p>
</dd>
<dt>OUT_SOIL_MOIST_lyr_1</dt><dd><p>Soil moisture from 1st layer</p>
</dd>
<dt>OUT_EVAP_CANOP</dt><dd><p>Evaporation from canopy</p>
</dd>
<dt>OUT_SURF_TEMP</dt><dd><p>Surface temperature</p>
</dd>
</dl>



<h3>References</h3>

<p>Diaz et al. (2024) AAGG 2024
Not yet published
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eva)
</code></pre>

<hr>
<h2 id='find.nearest.point'>Temporal series of closest location</h2><span id='topic+find.nearest.point'></span>

<h3>Description</h3>

<p>Location of nearest point to lon/lat and temporal serie of location
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find.nearest.point(data.spat.raster = data.spat.raster, lon = lon, lat = lat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find.nearest.point_+3A_data.spat.raster">data.spat.raster</code></td>
<td>
<p>Spat Raster of WRF SMN (only one or several)</p>
</td></tr>
<tr><td><code id="find.nearest.point_+3A_lon">lon</code></td>
<td>
<p>Longitude location of nearest point to find</p>
</td></tr>
<tr><td><code id="find.nearest.point_+3A_lat">lat</code></td>
<td>
<p>Latitude location of nearest point to find</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector with the nearest location (lon/lat) and time serie of that location
</p>

<hr>
<h2 id='get.wrf.files'>List of available files for downloading</h2><span id='topic+get.wrf.files'></span>

<h3>Description</h3>

<p>Character string with the filenames of WRF SMN located in AWS Bucket
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.wrf.files(year = year, month = month, day = day, cycle = cycle, time = time)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.wrf.files_+3A_year">year</code></td>
<td>
<p>character or numeric of year</p>
</td></tr>
<tr><td><code id="get.wrf.files_+3A_month">month</code></td>
<td>
<p>character or numeric of month</p>
</td></tr>
<tr><td><code id="get.wrf.files_+3A_day">day</code></td>
<td>
<p>character or numeric of day</p>
</td></tr>
<tr><td><code id="get.wrf.files_+3A_cycle">cycle</code></td>
<td>
<p>cycle of forecast, &quot;00&quot;, &quot;06&quot;, &quot;12&quot; or &quot;18&quot;</p>
</td></tr>
<tr><td><code id="get.wrf.files_+3A_time">time</code></td>
<td>
<p>selection of datasets, &quot;01H&quot;, &quot;24H&quot; or &quot;10M&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>string of the list of elements in the Bucket
</p>

<hr>
<h2 id='ith'>Calculation of ITH index</h2><span id='topic+ith'></span>

<h3>Description</h3>

<p>ITH index calculation is made from gridded observational or model data. If the data is needed in lat/lon projection is
better to use first the load.by.variable function to change projection
</p>
<p>The index is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">ITH = 1.8 * T(ºC) + 32 - (((0.55 - (0.55 * RelHum(\%))) / 100) * ((1.8 * T(ºC)) - 26))</code>
</p>

<p>where T(ªC) is the temperature in celsius degrees and RelHum(%) is the relative humidity in percentage
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ith(raster.list = raster.list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ith_+3A_raster.list">raster.list</code></td>
<td>
<p>Spat Raster variable with several variables and times or only one Spat Raster field</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Spat Raster with ITH calculation for each time
</p>

<hr>
<h2 id='load.by.variable'>Load and projection of data</h2><span id='topic+load.by.variable'></span>

<h3>Description</h3>

<p>Open of netcdf files of WRF SMN from AWS and optional projection
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load.by.variable(nc.filenames, variable, transform, method)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="load.by.variable_+3A_nc.filenames">nc.filenames</code></td>
<td>
<p>netcdf files</p>
</td></tr>
<tr><td><code id="load.by.variable_+3A_variable">variable</code></td>
<td>
<p>name of variable from https://odp-aws-smn.github.io/documentation_wrf_det/Formato_de_datos/ as character</p>
</td></tr>
<tr><td><code id="load.by.variable_+3A_transform">transform</code></td>
<td>
<p>TRUE to project data to longlat datum=WGS84</p>
</td></tr>
<tr><td><code id="load.by.variable_+3A_method">method</code></td>
<td>
<p>if transform is set TRUE define projection method taken from project function of terra package</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Spat Raster with the chosen variable (optional: with the projection changed)
</p>

<hr>
<h2 id='mg.evaluation'>Evaluation of regression</h2><span id='topic+mg.evaluation'></span>

<h3>Description</h3>

<p>Evaluation of the linear multiple regression obtained from the
multiple.guidance function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mg.evaluation(
  input.data = input.data,
  predictand = predictand,
  predictors = predictors,
  var.model = var.model,
  lmodel = lmodel
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mg.evaluation_+3A_input.data">input.data</code></td>
<td>
<p>Data frame with first column as a &quot;POSIXct&quot; class and one or
more columns with data values. The predictand and predictors variables should
be located in these columns</p>
</td></tr>
<tr><td><code id="mg.evaluation_+3A_predictand">predictand</code></td>
<td>
<p>Character with column name of the predictand variable</p>
</td></tr>
<tr><td><code id="mg.evaluation_+3A_predictors">predictors</code></td>
<td>
<p>Character array with one or more elements of the predictors
chosen by the user</p>
</td></tr>
<tr><td><code id="mg.evaluation_+3A_var.model">var.model</code></td>
<td>
<p>Character with column name of the modeled predicting variable</p>
</td></tr>
<tr><td><code id="mg.evaluation_+3A_lmodel">lmodel</code></td>
<td>
<p>Element of class lm obtained from multiple.guidance output
function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of two elements. First element is a matrix with the columns of
observed data, modeled data and corrected data. Second element is a data
frame of the statistical results of the modeled and corrected data versus
observed data
</p>

<hr>
<h2 id='multiple.guidance'>Multiple lineal regression of data</h2><span id='topic+multiple.guidance'></span>

<h3>Description</h3>

<p>Definition of linear multiple regression adjustment based on predictor
variables that fit a predicting variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiple.guidance(
  input.data = input.data,
  predictand = predictand,
  predictors = predictors
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiple.guidance_+3A_input.data">input.data</code></td>
<td>
<p>Data frame with first column as a &quot;POSIXct&quot; class and one or
more columns with data values. The predictand and predictors variables should
be located in these columns</p>
</td></tr>
<tr><td><code id="multiple.guidance_+3A_predictand">predictand</code></td>
<td>
<p>Character with column name of the predictand variable</p>
</td></tr>
<tr><td><code id="multiple.guidance_+3A_predictors">predictors</code></td>
<td>
<p>Character array with one or more elements of the predictors
chosen by the user</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an element of class lm
</p>

<hr>
<h2 id='ploting'>Plot of data</h2><span id='topic+ploting'></span>

<h3>Description</h3>

<p>Plot of observed, modeled and corrected guidance series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ploting(data = data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ploting_+3A_data">data</code></td>
<td>
<p>Data frame from daily2monthly output function or any other
temporal series</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot element
</p>

<hr>
<h2 id='wrf.download'>Download of wrf files</h2><span id='topic+wrf.download'></span>

<h3>Description</h3>

<p>Download of WRF SMN data from AWS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrf.download(wrf.name = wrf.name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wrf.download_+3A_wrf.name">wrf.name</code></td>
<td>
<p>list of names to download from get.wrf.files. e.g.: &quot;DATA/WRF/DET/2024/01/01/18/WRFDETAR_24H_20240101_18_000.nc&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>downloaded netcdf files
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
