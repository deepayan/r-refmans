<!DOCTYPE html><html lang="en"><head><title>Help for package difR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {difR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#difR-package'><p>Collection of methods to detect dichotomous differential item functioning (DIF) in psychometrics</p></a></li>
<li><a href='#breslowDay'><p>Breslow-Day DIF statistic</p></a></li>
<li><a href='#contrastMatrix'><p>Contrast matrix for computing generalized Lord's chi-squared DIF statistic</p></a></li>
<li><a href='#dichoDif'><p>Comparison of DIF detection methods</p></a></li>
<li><a href='#difBD'><p>Breslow-Day DIF method</p></a></li>
<li><a href='#difGenLogistic'><p>Generalized logistic regression DIF method</p></a></li>
<li><a href='#difGenLord'><p>Generalized Lord's chi-squared DIF method</p></a></li>
<li><a href='#difGMH'><p>Generalized Mantel-Haenszel DIF method</p></a></li>
<li><a href='#difLogistic'><p>Logistic regression DIF method</p></a></li>
<li><a href='#difLogReg'><p>General logistic regression DIF method</p></a></li>
<li><a href='#difLord'><p>Lord's chi-squared DIF method</p></a></li>
<li><a href='#difLRT'><p>Likelihood-Ratio Test DIF method</p></a></li>
<li><a href='#difMH'><p>Mantel-Haenszel DIF method</p></a></li>
<li><a href='#difRaju'><p>Raju's area DIF method</p></a></li>
<li><a href='#difSIBTEST'><p>SIBTEST and Crossing-SIBTEST DIF method</p></a></li>
<li><a href='#difStd'><p>Standardization DIF method</p></a></li>
<li><a href='#difTID'><p>Transformed Item Difficulties (TID) DIF method</p></a></li>
<li><a href='#genDichoDif'><p>Comparison of DIF detection methods among multiple groups</p></a></li>
<li><a href='#genLogistik'><p>Generalized logistic regression DIF statistic</p></a></li>
<li><a href='#genLordChi2'><p>Generalized Lord's chi-squared DIF statistic</p></a></li>
<li><a href='#genMantelHaenszel'><p>Generalized Mantel-Haenszel DIF statistic</p></a></li>
<li><a href='#itemPar1PL'><p>Item parameter estimation for DIF detection using Rasch (1PL) model</p></a></li>
<li><a href='#itemPar2PL'><p>Item parameter estimation for DIF detection using 2PL model</p></a></li>
<li><a href='#itemPar3PL'><p>Item parameter estimation for DIF detection using 3PL model</p></a></li>
<li><a href='#itemPar3PLconst'><p>Item parameter estimation for DIF detection using constrained 3PL model</p></a></li>
<li><a href='#itemParEst'><p>Item parameter estimation for DIF detection</p></a></li>
<li><a href='#itemRescale'><p>Rescaling item parameters by equal means anchoring</p></a></li>
<li><a href='#Logistik'><p>Logistic regression DIF statistic</p></a></li>
<li><a href='#LordChi2'><p>Lord's chi-square DIF statistic</p></a></li>
<li><a href='#LRT'><p>Likelihood-Ratio Test DIF statistic</p></a></li>
<li><a href='#mantelHaenszel'><p>Mantel-Haenszel DIF statistic</p></a></li>
<li><a href='#RajuZ'><p>Raju's area DIF statistic</p></a></li>
<li><a href='#selectDif'><p>Selection of one of the DIF detection methods</p></a></li>
<li><a href='#selectGenDif'><p>Selection of one of the DIF detection methods among multiple groups</p></a></li>
<li><a href='#sibTest'><p>SIBTEST DIF statistic</p></a></li>
<li><a href='#stdPDIF'><p>Standardization DIF statistic</p></a></li>
<li><a href='#subtestLogistic'><p>Testing for DIF among subgroups with generalized logistic regression</p></a></li>
<li><a href='#verbal'><p>Verbal Aggression Data Set</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Collection of Methods to Detect Dichotomous Differential Item
Functioning (DIF)</td>
</tr>
<tr>
<td>Version:</td>
<td>5.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-05-10</td>
</tr>
<tr>
<td>Author:</td>
<td>David Magis (U Liege), Sebastien Beland (U Montreal) and Gilles Raiche (UQAM)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Magis &lt;david.magis@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>mirt, ltm, lme4, deltaPlotR</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a collection of standard methods to detect differential item functioning among dichotomously scored items. Methods for uniform and non-uniform DIF, based on test-score or IRT methods, for comparing two or more than two groups of respondents, are available (Magis, Beland, Tuerlinckx and De Boeck,A General Framework and an R Package for the Detection of Dichotomous Differential Item Functioning, Behavior Research Methods, 42, 2010, 847-862 &lt;<a href="https://doi.org/10.3758%2FBRM.42.3.847">doi:10.3758/BRM.42.3.847</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-05-11 08:05:58 UTC; Martinkova</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-05-13 08:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='difR-package'>Collection of methods to detect dichotomous differential item functioning (DIF) in psychometrics</h2><span id='topic+difR-package'></span><span id='topic+difR'></span>

<h3>Description</h3>

<p>The difR package contains several traditional methods to detect DIF in dichotomously scored items. Both uniform and non-uniform DIF effects can be detected, with methods relying upon item response models or not. Some methods deal with more than one focal group.
</p>
<p>Methods currently available are:
</p>

<ol>
<li><p>Transformed Item Difficulties (TID) method (Angoff and Ford, 1973)
</p>
</li>
<li><p>Mantel-Haenszel (Holland and Thayer, 1988)
</p>
</li>
<li><p>Standardization (Dorans and Kullick, 1986)
</p>
</li>
<li><p>Breslow-Day (Aguerri et al., 2009; Penfield, 2003)
</p>
</li>
<li><p>Logistic regression (Swaminathan and Rogers, 1990)
</p>
</li>
<li><p>SIBTEST (Shealy and Stout) and Crossing-SIBTEST (Chalmers, 2018; Li and Stout, 1996)
</p>
</li>
<li><p>Lord's chi-square test (Lord, 1980)
</p>
</li>
<li><p>Raju's area (Raju, 1990)
</p>
</li>
<li><p>Likelihood-ratio test (Thissen, Steinberg and Wainer, 1988)
</p>
</li>
<li><p>Generalized Mantel-Haenszel (Penfield, 2001)
</p>
</li>
<li><p>Generalized logistic regression (Magis, Raiche, Beland and Gerard, 2011)
</p>
</li>
<li><p>Generalized Lord's chi-square test (Kim, Cohen and Park, 1995).
</p>
</li></ol>

<p>The difR package is further described in Magis, Beland, Tuerlinckx and De Boeck (2010).
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
  Package: </td><td style="text-align: left;"> difR </td>
</tr>
<tr>
 <td style="text-align: left;">
  Type:    </td><td style="text-align: left;"> Package </td>
</tr>
<tr>
 <td style="text-align: left;">
  Version: </td><td style="text-align: left;"> 5.1 </td>
</tr>
<tr>
 <td style="text-align: left;">
  Date:    </td><td style="text-align: left;"> 2020-05-10</td>
</tr>
<tr>
 <td style="text-align: left;">
  Depends: </td><td style="text-align: left;"> R (&gt;= 3.0.0) </td>
</tr>
<tr>
 <td style="text-align: left;">
  Imports: </td><td style="text-align: left;"> mirt, ltm, lme4, deltaPlotR </td>
</tr>
<tr>
 <td style="text-align: left;">
  License: </td><td style="text-align: left;"> GPL </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Aguerri, M.E., Galibert, M.S., Attorresi, H.F. and Maranon, P.P. (2009). Erroneous detection of nonuniform DIF using the Breslow-Day test in a short test. <em>Quality and Quantity, 43</em>, 35-44. doi: <a href="https://doi.org/10.1007/s11135-007-9130-2">10.1007/s11135-007-9130-2</a>
</p>
<p>Angoff, W. H., and Ford, S. F. (1973). Item-race interaction on a test of scholastic aptitude. <em>Journal of Educational Measurement, 2</em>, 95-106. doi: <a href="https://doi.org/10.1111/j.1745-3984.1973.tb00787.x">10.1111/j.1745-3984.1973.tb00787.x</a>
</p>
<p>Chalmers, R. P. (2018). Improving the Crossing-SIBTEST statistic for detecting non-uniform DIF. <em>Psychometrika, 83</em>(2), 376&ndash;386. doi: <a href="https://doi.org/10.1007/s11336-017-9583-8">10.1007/s11336-017-9583-8</a>
</p>
<p>Dorans, N. J. and Kulick, E. (1986). Demonstrating the utility of the standardization approach to assessing unexpected differential item performance on the 
Scholastic Aptitude Test. <em>Journal of Educational Measurement, 23</em>, 355-368. doi: <a href="https://doi.org/10.1111/j.1745-3984.1986.tb00255.x">10.1111/j.1745-3984.1986.tb00255.x</a>
</p>
<p>Holland, P. W. and Thayer, D. T. (1988). Differential item performance and the Mantel-Haenszel procedure. In H. Wainer and H. I. Braun (Dirs.), <em>Test validity</em>. Hillsdale, New Jersey: Lawrence Erlbaum Associates.
</p>
<p>Kim, S.-H., Cohen, A.S. and Park, T.-H. (1995). Detection of differential item functioning in multiple groups. <em>Journal of Educational Measurement, 32</em>, 261-276. doi: <a href="https://doi.org/10.1111/j.1745-3984.1995.tb00466.x">10.1111/j.1745-3984.1995.tb00466.x</a>
</p>
<p>Li, H.-H., and Stout, W. (1996). A new procedure for detection of crossing DIF. <em>Psychometrika, 61</em>, 647&ndash;677. doi: <a href="https://doi.org/10.1007/BF02294041">10.1007/BF02294041</a>
</p>
<p>Lord, F. (1980). <em>Applications of item response theory to practical testing problems</em>. Hillsdale, NJ: Lawrence Erlbaum Associates.
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Magis, D., Raiche, G., Beland, S. and Gerard, P. (2011). A logistic regression procedure to detect differential item functioning among multiple groups. <em>International Journal of Testing, 11</em>, 365&ndash;386. doi: <a href="https://doi.org/10.1080/15305058.2011.602810">10.1080/15305058.2011.602810</a>
</p>
<p>Penfield, R. D. (2001). Assessing differential item functioning among multiple groups: a comparison of three Mantel-Haenszel procedures. <em>Applied Measurement in Education, 14</em>, 235-259. doi: <a href="https://doi.org/10.1207/S15324818AME1403_3">10.1207/S15324818AME1403_3</a>
</p>
<p>Penfield, R.D. (2003). Application of the Breslow-Day test of trend in odds ratio heterogeneity to the detection of nonuniform DIF. <em>Alberta Journal of Educational Research, 49</em>, 231-243.
</p>
<p>Raju, N. S. (1990). Determining the significance of estimated signed and unsigned areas between two item response functions. <em>Applied Psychological Measurement, 14</em>, 197-207. doi: <a href="https://doi.org/10.1177/014662169001400208">10.1177/014662169001400208</a>
</p>
<p>Shealy, R. and Stout, W. (1993). A model-based standardization approach that separates true bias/DIF from group ability differences and detect test bias/DTF as well as item bias/DIF. <em>Psychometrika, 58</em>, 159-194. doi: <a href="https://doi.org/10.1007/BF02294572">10.1007/BF02294572</a>
</p>
<p>Swaminathan, H. and Rogers, H. J. (1990). Detecting differential item functioning using logistic regression procedures. <em>Journal of Educational 
Measurement, 27</em>, 361-370. doi: <a href="https://doi.org/10.1111/j.1745-3984.1990.tb00754.x">10.1111/j.1745-3984.1990.tb00754.x</a>
</p>
<p>Thissen, D., Steinberg, L. and Wainer, H. (1988). Use of item response theory in the study of group difference in trace lines. 
In H. Wainer and H. Braun (Eds.), <em>Test validity</em>. Hillsdale, NJ: Lawrence Erlbaum Associates.
</p>


<h3>See Also</h3>

<p>Other useful packages can be found in the <em>R</em> <em>Psychometric</em> task view.
</p>

<hr>
<h2 id='breslowDay'>Breslow-Day DIF statistic</h2><span id='topic+breslowDay'></span>

<h3>Description</h3>

<p>Computes Breslow-Day statistics for DIF detection. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>breslowDay(data, member, match = "score", anchor = 1:ncol(data), 
     BDstat = "BD")
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="breslowDay_+3A_data">data</code></td>
<td>
<p>numeric: the data matrix (one row per subject, one column per item).</p>
</td></tr>
<tr><td><code id="breslowDay_+3A_member">member</code></td>
<td>
<p>numeric: the vector of group membership with zero and one entries only. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="breslowDay_+3A_match">match</code></td>
<td>
<p>specifies the type of matching criterion. Can be either <code>"score"</code> (default) to compute the test score, or any continuous or discrete variable with the same length as the number of rows of <code>data</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="breslowDay_+3A_anchor">anchor</code></td>
<td>
<p>a vector of integer values specifying which items (all by default) are currently considered as anchor (DIF free) items. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="breslowDay_+3A_bdstat">BDstat</code></td>
<td>
<p>character specifying the DIF statistic to be used. Possible values are <code>"BD"</code> (default) and <code>"trend"</code>. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>breslowDay</code> computes one of the Breslow-Day statistics (1980) in the specific framework of differential item functioning. It forms the basic command 
of <code><a href="#topic+difBD">difBD</a></code> and is specifically designed for this call.
</p>
<p>The data are supplied by the <code>data</code> argument, with one row per subject and one column per item. Missing values are allowed but must be coded as <code>NA</code>
values. They are discarded from sum-score computation.
</p>
<p>The vector of group membership, specified by the <code>member</code> argument, must hold only zeros and ones, a value of zero corresponding to the
reference group and a value of one to the focal group.
</p>
<p>The matching criterion can be either the test score or any other continuous or discrete variable to be passed in the <code>breslowDay</code> function. This is specified by the <code>match</code> argument. By default, it takes the value <code>"score"</code> and the test score (i.e. raw score) is computed. The second option is to assign to <code>match</code> a vector of continuous or discrete numeric values, which acts as the matching criterion. Note that for consistency this vector should not belong to the <code>data</code> matrix.
</p>
<p>Option <code>anchor</code> sets the items which are considered as anchor items for computing Breslow-Day DIF statistics. Items other than the anchor items and
the tested item are discarded. <code>anchor</code> must hold integer values specifying the column numbers of the corresponding anchor items. It is 
primarily designed to perform item purification.
</p>
<p>Two test statistics are available: the usual Breslow-Day statistic for testing homogeneous association (Aguerri, Galibert, Attorresi and Maranon, 2009)
and the trend test statistic for assessing some monotonic trend in the odss ratios (Penfield, 2003). The DIF statistic is supplied by the <code>BDstat</code> argument, 
with values <code>"BD"</code> (default) for the usual statistic and <code>"trend"</code> for the trend test statistic.
</p>


<h3>Value</h3>

<p>A list with three arguments:
</p>
<table role = "presentation">
<tr><td><code>res</code></td>
<td>
<p>A matrix with one row per item and three columns: the first one contains the Breslow-Day statistic values, the second column indicates 
the degrees of freedom, and the last column displays the asymptotic <em>p</em>-values.</p>
</td></tr>
<tr><td><code>BDstat</code></td>
<td>
<p>the value of the <code>BDstat</code> argument.</p>
</td></tr>
<tr><td><code>match</code></td>
<td>
<p>a character string, either <code>"score"</code> or <code>"matching variable"</code> depending on the <code>match</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Aguerri, M.E., Galibert, M.S., Attorresi, H.F. and Maranon, P.P. (2009). Erroneous detection of nonuniform DIF using the Breslow-Day test in a short test. <em>Quality and Quantity, 43</em>, 35-44. doi: <a href="https://doi.org/10.1007/s11135-007-9130-2">10.1007/s11135-007-9130-2</a>
</p>
<p>Breslow, N.E. and Day, N.E. (1980). <em>Statistical methods in cancer research, vol. I: The analysis of case-control studies</em>. Scientific Publication No 32. International Agency for Research on Cancer, Lyon, France.
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Penfield, R.D. (2003). Application of the Breslow-Day test of trend in odds ratio heterogeneity to the detection of nonuniform DIF. <em>Alberta Journal of 
Educational Research, 49</em>, 231-243.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difBD">difBD</a></code>, <code><a href="#topic+dichoDif">dichoDif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)

 # With all items as anchor items
 breslowDay(verbal[,1:24], verbal[,26])

 # With all items as anchor items and trend
 # test statistic
 breslowDay(verbal[,1:24], verbal[,26], BDstat = "trend")

 # Removing item 3 from the set of anchor items
 breslowDay(verbal[,1:24], verbal[,26], anchor = c(1:5, 7:24))

## End(Not run)
</code></pre>

<hr>
<h2 id='contrastMatrix'>Contrast matrix for computing generalized Lord's chi-squared DIF statistic</h2><span id='topic+contrastMatrix'></span>

<h3>Description</h3>

<p>This command sets the appropriate contrast matrix C for computing the generalized Lord's chi-squared statistics in the framework of DIF detection among multiple groups. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'> contrastMatrix(nrFocal, model)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contrastMatrix_+3A_nrfocal">nrFocal</code></td>
<td>
<p>numeric: the number of focal groups.</p>
</td></tr>
<tr><td><code id="contrastMatrix_+3A_model">model</code></td>
<td>
<p>character: the logistic model to be fitted (either <code>"1PL"</code>, <code>"2PL"</code>, <code>"3PL"</code> or <code>"3PLc"</code>). See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The contrast matrix C is necessary to calculate the generalized Lord's chi-squared statistic. It is designed to perform accurate tests of equality of item parameters 
accross the groups of examinees (see Kim, Cohen and Park, 1995). This is a subroutine for the command <code><a href="#topic+genLordChi2">genLordChi2</a></code> which returns the DIF statistics. 
</p>
<p>The number of focal groups has to be specified by the argument <code>nrFocal</code>. Moreover, four logistic IRT models can be considered: the 1PL, 2PL and 3PL models 
can be set by using their acronyms (e.g. <code>"1PL"</code> for 1PL model, and so on). It is also possible to consider the constrained 3PL model, where all
pseudo-guessing values are equal across the groups of examinees and take some predefined values which do not need to be supplied here. This model is specified by 
the value <code>"3PLc"</code> for argument <code>model</code>.
</p>


<h3>Value</h3>

<p>A contrast matrix designed to test equality of item parameter estimates from the specified <code>model</code> and with <code>nrFocal</code> focal groups. The output matrix has 
a number of rows equal to <code>nrFocal</code> times the number of tested parameters (one for 1PL model, two for 2PL and constrained 3PL models, three for 3PL model). The 
number of columns is equal to (<code>nrFocal</code>+1) times the number of tested parameters. See Kim, Cohen and Park (1995) for further details.
</p>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Kim, S.-H., Cohen, A.S. and Park, T.-H. (1995). Detection of differential item functioning in multiple groups. <em>Journal of Educational Measurement, 32</em>, 261-276. doi: <a href="https://doi.org/10.1111/j.1745-3984.1995.tb00466.x">10.1111/j.1745-3984.1995.tb00466.x</a>
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+genLordChi2">genLordChi2</a></code>, <code><a href="#topic+difGenLord">difGenLord</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Contrast matrices with 1PL model and several focal groups
 contrastMatrix(2, "1PL")
 contrastMatrix(3, "1PL")
 contrastMatrix(4, "1PL")

 # Contrast matrices with 2PL, constrained and unconstrained 3PL models and three 
 # focal groups
 contrastMatrix(3, "2PL")
 contrastMatrix(3, "3PLc")
 contrastMatrix(3, "3PL")

## End(Not run)
</code></pre>

<hr>
<h2 id='dichoDif'>Comparison of DIF detection methods</h2><span id='topic+dichoDif'></span><span id='topic+print.dichoDif'></span>

<h3>Description</h3>

<p>This function compares the specified DIF detection methods with respect to the detected items. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dichoDif(Data, group, focal.name, method, anchor = NULL, props = NULL, 
 	thrTID = 1.5, alpha = 0.05, MHstat = "MHChisq", correct = TRUE, 
 	exact = FALSE, stdWeight = "focal", thrSTD = 0.1, BDstat = "BD", 
 	member.type = "group", match = "score", type = "both", criterion = "LRT", 
 	model = "2PL", c = NULL, engine = "ltm", discr = 1, irtParam = NULL, 
 	same.scale = TRUE, signed = FALSE, purify = FALSE, purType = "IPP1",
 	nrIter = 10, extreme = "constraint", const.range = c(0.001, 0.999), 
 	nrAdd = 1, p.adjust.method = NULL, save.output = FALSE,
 	output = c("out", "default")) 
## S3 method for class 'dichoDif'
print(x, ...)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dichoDif_+3A_data">Data</code></td>
<td>
<p>numeric: either the data matrix only, or the data matrix plus the vector of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_group">group</code></td>
<td>
<p>numeric or character: either the vector of group membership or the column indicator (within <code>Data</code>) of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_focal.name">focal.name</code></td>
<td>
<p>numeric or character indicating the level of <code>group</code> which corresponds to the focal group.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_method">method</code></td>
<td>
<p>character: the name of the selected method. Possible values are <code>"TID"</code>, <code>"MH"</code>, <code>"Std"</code>, <code>"Logistic"</code>, <code>"BD"</code>, <code>"SIBTEST"</code>, <code>"Lord"</code>, <code>"Raju"</code> and <code>"LRT"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_anchor">anchor</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of item names (or identifiers) to specify the anchor items. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_props">props</code></td>
<td>
<p>either <code>NULL</code> (default) or a two-column matrix with proportions of success in the reference group and the focal group. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_thrtid">thrTID</code></td>
<td>
<p>numeric: the threshold for detecting DIF items with TID method (default is 1.5).</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_mhstat">MHstat</code></td>
<td>
<p>character: specifies the DIF statistic to be used for DIF identification. Possible values are <code>"MHChisq"</code> (default) and <code>"logOR"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_correct">correct</code></td>
<td>
<p>logical: should the Mantel-Haenszel continuity correction be used? (default is TRUE).</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_exact">exact</code></td>
<td>
<p>logical: should an exact test be computed? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_stdweight">stdWeight</code></td>
<td>
<p>character: the type of weights used for the standardized P-DIF statistic. Possible values are <code>"focal"</code> (default), <code>"reference"</code> and <code>"total"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_thrstd">thrSTD</code></td>
<td>
<p>numeric: the threshold (cut-score) for standardized P-DIF statistic (default is 0.10).</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_bdstat">BDstat</code></td>
<td>
<p>character specifying the DIF statistic to be used. Possible values are <code>"BD"</code> (default) and <code>"trend"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_member.type">member.type</code></td>
<td>
<p>character: either <code>"group"</code> (default) to specify that group membership is made of two groups, or <code>"cont"</code> to indicate that group membership is based on a  continuous criterion. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_match">match</code></td>
<td>
<p>specifies the type of matching criterion. Can be either <code>"score"</code> (default) to compute the test score, or any continuous or discrete variable with the same length as the number of rows of <code>Data</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_type">type</code></td>
<td>
<p>a character string specifying which DIF effects must be tested. Possible values are <code>"both"</code> (default), <code>"udif"</code> and <code>"nudif"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_criterion">criterion</code></td>
<td>
<p>a character string specifying which DIF statistic is computed. Possible values are <code>"LRT"</code> (default) or <code>"Wald"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_model">model</code></td>
<td>
<p>character: the IRT model to be fitted (either <code>"1PL"</code>, <code>"2PL"</code> or <code>"3PL"</code>). Default is <code>"2PL"</code>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_c">c</code></td>
<td>
<p>optional numeric value or vector giving the values of the constrained pseudo-guessing parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_engine">engine</code></td>
<td>
<p>character: the engine for estimating the 1PL model, either <code>"ltm"</code> (default) or <code>"lme4"</code>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_discr">discr</code></td>
<td>
<p>either <code>NULL</code> or a real positive value for the common discrimination parameter (default is 1). Used onlky if <code>model</code> is <code>"1PL"</code> and <code>engine</code> is <code>"ltm"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_irtparam">irtParam</code></td>
<td>
<p>matrix with <em>2J</em> rows (where <em>J</em> is the number of items) and at most 9 columns containing item parameters estimates. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_same.scale">same.scale</code></td>
<td>
<p>logical: are the item parameters of the <code>irtParam</code> matrix on the same scale? (default is &quot;TRUE&quot;). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_signed">signed</code></td>
<td>
<p>logical: should the Raju's statistics be computed using the signed (<code>TRUE</code>) or unsigned (<code>FALSE</code>, default) area? See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_purify">purify</code></td>
<td>
<p>logical: should the method be used iteratively to purify the set of anchor items? (default is FALSE).</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_purtype">purType</code></td>
<td>
<p>character: the type of purification process to be run. Possible values are <code>"IPP1"</code> (default), <code>"IPP2"</code> and <code>"IPP3"</code>. Ignored if <code>purify</code> is <code>FALSE</code> or <code>method</code> does not supply the <code>"TID"</code> method.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item purification process (default is 10).</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_extreme">extreme</code></td>
<td>
<p>character: the method used to modify the extreme proportions. Possible values are <code>"constraint"</code> (default) or <code>"add"</code>. Ignored if <code>method</code> is not <code>"TID"</code>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_const.range">const.range</code></td>
<td>
<p>numeric: a vector of two constraining proportions. Default values are 0.001 and 0.999. Ignored if <code>method</code> is not <code>"TID"</code> or if <code>extreme</code> is <code>"add"</code>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_nradd">nrAdd</code></td>
<td>
<p>integer: the number of successes and the number of failures to add to the data in order to adjust the proportions. Default value is 1. Ignored if <code>method</code> is not <code>"TID"</code> or if <code>extreme</code> is <code>"constraint"</code>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>either <code>NULL</code> (default) or the acronym of the method for p-value adjustment for multiple comparisons. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved into a text file? (Default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_output">output</code></td>
<td>
<p>character: a vector of two components. The first component is the name of the output file, the second component is either the file path or <code>"default"</code> (default value). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_x">x</code></td>
<td>
<p>result from a <code>dichoDif</code> class object.</p>
</td></tr>
<tr><td><code id="dichoDif_+3A_...">...</code></td>
<td>
<p>other generic parameters for the <code>print</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>dichoDif</code> is a generic function which calls one or several DIF detection methods and summarize their output. The possible methods are: 
</p>

<ol>
<li><p><code>"TID"</code> for Transformed Item Difficulties (TID) method (Angoff and Ford, 1973),
</p>
</li>
<li><p><code>"MH"</code> for mantel-Haenszel (Holland and Thayer, 1988),
</p>
</li>
<li><p><code>"Std"</code> for standardization (Dorans and Kulick, 1986),
</p>
</li>
<li><p><code>"BD"</code> for Breslow-Day method (Penfield, 2003),
</p>
</li>
<li><p><code>"Logistic"</code> for logistic regression (Swaminathan and Rogers, 1990),
</p>
</li>
<li><p><code>"SIBTEST"</code> for SIBTEST (Shealy and Stout) and Crossing-SIBTEST (Chalmers, 2018; Li and Stout, 1996) methods,
</p>
</li>
<li><p><code>"Lord"</code> for Lord's chi-square test (Lord, 1980), 
</p>
</li>
<li><p><code>"Raju"</code> for Raju's area method (Raju, 1990), and
</p>
</li>
<li><p><code>"LRT"</code> for likelihood-ratio test method (Thissen, Steinberg and Wainer, 1988).
</p>
</li></ol>

<p>If <code>method</code> has a single component, the output of <code>dichoDif</code> is exactly the one provided by the method itself. Otherwise, the main  output is a matrix with one row per item and one column per method. For each specified method and related arguments, items detected as DIF and non-DIF are respectively encoded as <code>"DIF"</code> and <code>"NoDIF"</code>. When printing the output an additional column is added, counting the number of times each item was detected as functioning
differently (Note: this is just an informative summary, since the methods are obviously not independent for the detection of DIF items).
</p>
<p>The <code>Data</code> is a matrix whose rows correspond to the subjects and columns to the items. In addition, <code>Data</code> can hold the vector of group membership. If so, <code>group</code> indicates the column of <code>Data</code> which corresponds to the group membership, either by specifying its name or by giving the column number. Otherwise, <code>group</code> must be a vector of same length as <code>nrow(Data)</code>.
</p>
<p>Missing values are allowed for item responses (not for group membership) but must be coded as <code>NA</code> values. They are discarded from either the computation of the sum-scores, the fitting of the logistic models or the IRT models (according to the method).
</p>
<p>The vector of group membership must hold only two different values, either as numeric or character. The focal group is defined by the value of the argument <code>focal.name</code>. 
</p>
<p>For <code>"MH"</code>, <code>"Std"</code>, <code>"Logistic"</code> and <code>"BD"</code> methods, the matching criterion can be either the test score or any other continuous or discrete variable to be passed in the <code>Logistik</code> function. This is specified by the <code>match</code> argument. By default, it takes the value <code>"score"</code> and the test score (i.e. raw score) is computed. The second option is to assign to <code>match</code> a vector of continuous or discrete numeric values, which acts as the matching criterion. Note that for consistency this vector should not belong to the <code>Data</code> matrix. 
</p>
<p>For Lord and Raju methods, one can specify either the IRT model to be fitted (by means of <code>model</code>, <code>c</code>, <code>engine</code> and <code>discr</code> arguments), or the item parameter estimates with arguments <code>irtParam</code> and <code>same.scale</code>. See <code><a href="#topic+difLord">difLord</a></code> and <code><a href="#topic+difRaju">difRaju</a></code> for further details. 
</p>
<p>The threshold for detecting DIF items depends on the method. For standardization it has to be fully specified (with the <code>thr</code> argument), as well as for the TID method (through the <code>thrTID</code> argument). For the other methods it is depending on the significance level set by <code>alpha</code>.
</p>
<p>For Mantel-Haenszel method, the DIF statistic can be either the Mantel-Haenszel chi-square statistic or the log odds-ratio statistic. The method is specified by the argument <code>MHstat</code>, and the default value is <code>"MHChisq"</code> for the chi-square statistic. Moreover, the option <code>correct</code>
specifies whether the continuity correction has to be applied to Mantel-Haenszel statistic. See <code><a href="#topic+difMH">difMH</a></code> for further details.
</p>
<p>By default, the asymptotic Mantel-Haenszel statistic is computed. However, the exact statistics and related P-values can be obtained by specifying the logical argument <code>exact</code> to <code>TRUE</code>. See Agresti (1990, 1992) for further details about exact inference.
</p>
<p>The weights for computing the standardized P-DIF statistics are defined through the argument <code>stdWeight</code>, with possible values <code>"focal"</code> (default value), <code>"reference"</code> and <code>"total"</code>. See <code><a href="#topic+stdPDIF">stdPDIF</a></code> for further details. 
</p>
<p>For Breslow-Day method, two test statistics are available: the usual Breslow-Day statistic for testing homogeneous association (Aguerri, Galibert, Attorresi and Maranon, 2009) and the trend test statistic for assessing some monotonic trend in the odss ratios (Penfield, 2003). The DIF statistic is supplied by the <code>BDstat</code> argument, with values <code>"BD"</code> (default) for the usual statistic and <code>"trend"</code> for the trend test statistic.
</p>
<p>For logistic regression, the argument <code>type</code> permits to test either both uniform and nonuniform effects simultaneously (<code>type="both"</code>), only uniform DIF effect (<code>type="udif"</code>) or only nonuniform DIF effect (<code>type="nudif"</code>). The <code>criterion</code> argument specifies the DIF statistic to be computed, either the likelihood ratio test statistic (by setting <code>criterion="LRT"</code>) or the Wald test (by setting <code>criterion="Wald"</code>). Moreover, the group membership can be either a vector of two distinct values, one for the reference group and one for the focal group, or a continuous or discrete variable that acts as the &quot;group&quot; membership variable. In the former case, the <code>member.type</code> argument is set to <code>"group"</code> and the <code>focal.name</code> defines which value in the <code>group</code> variable stands for the focal group. In the latter case, <code>member.type</code> is set to <code>"cont"</code>, <code>focal.name</code> is ignored and each value of the <code>group</code> represents one &quot;group&quot; of data (that is, the DIF effects are investigated among participants relying on different values of some discrete or continuous trait). See <code><a href="#topic+Logistik">Logistik</a></code> for further details.
</p>
<p>The SIBTEST method (Shealy and Stout, 1993) and its modified version, the Crossing-SIBTEST (Chalmers, 2018; Li and Stout, 1996) are returned by the <code><a href="#topic+difSIBTEST">difSIBTEST</a></code> function. SIBTEST method is returned when <code>type</code> argument is set to <code>"udif"</code>, while Crossing-SIBTEST is set with <code>"nudif"</code> value for the <code>type</code> argument. Note that <code>type</code> takes the by-default value <code>"both"</code> which is not allowed within the <code><a href="#topic+difSIBTEST">difSIBTEST</a></code> function; however, within this fucntion, keeping the by-default value yields selection of Crossing-SIBTEST.
</p>
<p>The <code><a href="#topic+difSIBTEST">difSIBTEST</a></code> function is a wrapper to the <code><a href="mirt.html#topic+SIBTEST">SIBTEST</a></code> function from the <b>mirt</b> package (Chalmers, 2012) to fit within the <code>difR</code> framework (Magis et al., 2010). Therefore, if you are using this function for publication purposes please cite Chalmers (2018; 2012) and Magis et al. (2010).
</p>
<p>For Raju's method, the type of area (signed or unsigned) is fixed by the logical <code>signed</code> argument, with default value <code>FALSE</code> (i.e. unsigned areas). See <code><a href="#topic+RajuZ">RajuZ</a></code> for further details.
</p>
<p>Item purification can be requested by specifying <code>purify</code> option to <code>TRUE</code>. Recall that item purification process is slightly different for IRT and for non-IRT based methods. See the corresponding methods for further information.
</p>
<p>Adjustment for multiple comparisons is possible with the argument <code>p.adjust.method</code>. See the corresponding methods for further information.
</p>
<p>A pre-specified set of anchor items can be provided through the <code>anchor</code> argument. For non-IRT methods, anchor items are used to compute the test score (as matching criterion). For IRT methods, anchor items are used to rescale the item parameters on a common metric. See the corresponding methods for further information. Note that <code>anchor</code> argument is not working with <code>"LRT"</code> method.
</p>
<p>The output of the <code>dichoDif</code> function can be stored in a text file by fixing <code>save.output</code> and <code>output</code> appropriately. See the help file of <code><a href="#topic+selectDif">selectDif</a></code> function (or any other DIF method) for further information.
</p>


<h3>Value</h3>

<p>Either the output of one of the DIF detection methods, or a list of class &quot;dichoDif&quot; with the following arguments:
</p>
<table role = "presentation">
<tr><td><code>DIF</code></td>
<td>
<p>a character matrix with one row per item and whose columns refer to the different specified detection methods. See <b>Details</b>.</p>
</td></tr>
<tr><td><code>props</code></td>
<td>
<p>the value of the <code>props</code> argument.</p>
</td></tr>
<tr><td><code>thrTID</code></td>
<td>
<p>the value of the <code>thrTID</code> argument.</p>
</td></tr>
<tr><td><code>correct</code></td>
<td>
<p>the value of <code>correct</code> argument.</p>
</td></tr>
<tr><td><code>exact</code></td>
<td>
<p>the value of <code>exact</code> argument.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the significance level <code>alpha</code>.</p>
</td></tr>
<tr><td><code>MHstat</code></td>
<td>
<p>the value of the <code>MHstat</code> argument.</p>
</td></tr>
<tr><td><code>stdWeight</code></td>
<td>
<p>the value of the <code>stdWeight</code> argument.</p>
</td></tr>
<tr><td><code>thrSTD</code></td>
<td>
<p>the value of <code>thrSTD</code> argument.</p>
</td></tr>
<tr><td><code>BDstat</code></td>
<td>
<p>the value of the <code>BDstat</code> argument.</p>
</td></tr>
<tr><td><code>member.type</code></td>
<td>
<p>the value of the <code>member.type</code> argument.</p>
</td></tr>
<tr><td><code>match</code></td>
<td>
<p>the value of the <code>match</code> argument.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>the value of the <code>type</code> argument.</p>
</td></tr>
<tr><td><code>criterion</code></td>
<td>
<p>the value of the <code>criterion</code> argument.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the value of <code>model</code> argument.</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p>the value of <code>c</code> argument.</p>
</td></tr>
<tr><td><code>engine</code></td>
<td>
<p>The value of the <code>engine</code> argument.</p>
</td></tr>
<tr><td><code>discr</code></td>
<td>
<p>the value of the <code>discr</code> argument.</p>
</td></tr>
<tr><td><code>irtParam</code></td>
<td>
<p>the value of <code>irtParam</code> argument.</p>
</td></tr>
<tr><td><code>same.scale</code></td>
<td>
<p>the value of <code>same.scale</code> argument.</p>
</td></tr>
<tr><td><code>p.adjust.method</code></td>
<td>
<p>the value of the <code>p.adjust.method</code> argument.</p>
</td></tr>
<tr><td><code>purification</code></td>
<td>
<p>the value of <code>purify</code> argument.</p>
</td></tr> 
<tr><td><code>nrPur</code></td>
<td>
<p>an integer vector (of length equal to the number of methods) with the number of iterations in the purification process. 
Returned only if <code>purify</code> is TRUE.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>a logical vector (of length equal to the number of methods) indicating whether the iterative purification process converged. Returned only if <code>purify</code> is TRUE.</p>
</td></tr>
<tr><td><code>anchor.names</code></td>
<td>
<p>the value of the <code>anchor</code> argument.</p>
</td></tr>
<tr><td><code>save.output</code></td>
<td>
<p>the value of the <code>save.output</code> argument.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>the value of the <code>output</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Agresti, A. (1990). <em>Categorical data analysis</em>. New York: Wiley.
</p>
<p>Agresti, A. (1992). A survey of exact inference for contingency tables. <em>Statistical Science, 7</em>, 131-177. doi: <a href="https://doi.org/10.1214/ss/1177011454">10.1214/ss/1177011454</a>
</p>
<p>Aguerri, M.E., Galibert, M.S., Attorresi, H.F. and Maranon, P.P. (2009). Erroneous detection of nonuniform DIF using the Breslow-Day test in a short test. <em>Quality and Quantity, 43</em>, 35-44. doi: <a href="https://doi.org/10.1007/s11135-007-9130-2">10.1007/s11135-007-9130-2</a>
</p>
<p>Angoff, W. H., and Ford, S. F. (1973). Item-race interaction on a test of scholastic aptitude. <em>Journal of Educational Measurement, 2</em>, 95-106. doi: <a href="https://doi.org/10.1111/j.1745-3984.1973.tb00787.x">10.1111/j.1745-3984.1973.tb00787.x</a>
</p>
<p>Chalmers, R. P. (2012). mirt: A Multidimensional item response
theory package for the R environment. <em>Journal of Statistical Software, 48(6)</em>, 1-29. doi: <a href="https://doi.org/10.18637/jss.v048.i06">10.18637/jss.v048.i06</a>
</p>
<p>Chalmers, R. P. (2018). Improving the Crossing-SIBTEST statistic for detecting non-uniform DIF. <em>Psychometrika, 83</em>(2), 376&ndash;386. doi: <a href="https://doi.org/10.1007/s11336-017-9583-8">10.1007/s11336-017-9583-8</a>
</p>
<p>Dorans, N. J. and Kulick, E. (1986). Demonstrating the utility of the standardization approach to assessing unexpected differential item performance on the 
Scholastic Aptitude Test. <em>Journal of Educational Measurement, 23</em>, 355-368. doi: <a href="https://doi.org/10.1111/j.1745-3984.1986.tb00255.x">10.1111/j.1745-3984.1986.tb00255.x</a>
</p>
<p>Holland, P. W. and Thayer, D. T. (1988). Differential item performance and the Mantel-Haenszel procedure. In H. Wainer and H. I. Braun (Dirs.), <em>Test 
validity</em>. Hillsdale, NJ: Lawrence Erlbaum Associates.
</p>
<p>Li, H.-H., and Stout, W. (1996). A new procedure for detection of crossing DIF. <em>Psychometrika, 61</em>, 647&ndash;677. doi: <a href="https://doi.org/10.1007/BF02294041">10.1007/BF02294041</a>
</p>
<p>Lord, F. (1980). <em>Applications of item response theory to practical testing problems</em>. Hillsdale, NJ: Lawrence Erlbaum Associates.
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Penfield, R.D. (2003). Application of the Breslow-Day test of trend in odds ratio heterogeneity to the detection of nonuniform DIF. <em>Alberta Journal of 
Educational Research, 49</em>, 231-243.
</p>
<p>Raju, N. S. (1990). Determining the significance of estimated signed and unsigned areas between two item response functions. <em>Applied Psychological Measurement, 14</em>, 197-207. doi: <a href="https://doi.org/10.1177/014662169001400208">10.1177/014662169001400208</a>
</p>
<p>Shealy, R. and Stout, W. (1993). A model-based standardization approach that separates true bias/DIF from group ability differences and detect test bias/DTF as well as item bias/DIF. <em>Psychometrika, 58</em>, 159-194. doi: <a href="https://doi.org/10.1007/BF02294572">10.1007/BF02294572</a>
</p>
<p>Swaminathan, H. and Rogers, H. J. (1990). Detecting differential item functioning using logistic regression procedures. <em>Journal of Educational 
Measurement, 27</em>, 361-370. doi: <a href="https://doi.org/10.1111/j.1745-3984.1990.tb00754.x">10.1111/j.1745-3984.1990.tb00754.x</a>
</p>
<p>Thissen, D., Steinberg, L. and Wainer, H. (1988). Use of item response theory in the study of group difference in trace lines. In H. Wainer and H. Braun (Eds.), 
<em>Test validity</em>. Hillsdale, NJ: Lawrence Erlbaum Associates.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difTID">difTID</a></code>, <code><a href="#topic+difMH">difMH</a></code>, <code><a href="#topic+difStd">difStd</a></code>, <code><a href="#topic+difBD">difBD</a></code>, <code><a href="#topic+difLogistic">difLogistic</a></code>, <code><a href="#topic+difSIBTEST">difSIBTEST</a></code>, <code><a href="#topic+difLord">difLord</a></code>, <code><a href="#topic+difRaju">difRaju</a></code>,
<code><a href="#topic+difLRT">difLRT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Excluding the "Anger" variable
 verbal &lt;- verbal[colnames(verbal)!="Anger"]

 # Comparing TID, Mantel-Haenszel, standardization; logistic regression and SIBTEST
 # TID threshold 1.0
 # Standardization threshold 0.08
 # no continuity correction,
 # with item purification
 # both types of DIF effect for logistic regression
 # CSIBTEST method 
 dichoDif(verbal, group = 25, focal.name = 1, method = c("TID", "MH", "Std",
          "Logistic", "SIBTEST"), correct = FALSE, thrSTD = 0.08, thrTID = 1, purify = TRUE)

 # Same analysis, but using items 1 to 5 as anchor and saving the output into 
 # the 'dicho' file 
 dichoDif(verbal, group = 25, focal.name = 1, method = c("TID", "MH", "Std",
          "Logistic"), correct = FALSE, thrSTD = 0.08, thrTID = 1, purify = TRUE, 
          anchor = 1:5,save.output = TRUE, output = c("dicho", "default"))

 # Comparing Lord and Raju results with 2PL model and
 # with item purification 
 dichoDif(verbal, group = 25, focal.name = 1, method = c("Lord", "Raju"),
          model = "2PL", purify = TRUE)

## End(Not run)
 </code></pre>

<hr>
<h2 id='difBD'>Breslow-Day DIF method</h2><span id='topic+difBD'></span><span id='topic+print.BD'></span><span id='topic+plot.BD'></span>

<h3>Description</h3>

<p>Performs DIF detection using Breslow-Day method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>difBD(Data, group, focal.name, anchor = NULL, match = "score", BDstat = "BD", 
  	alpha = 0.05, purify = FALSE, nrIter = 10, p.adjust.method = NULL, 
  	save.output = FALSE, output = c("out", "default"))
## S3 method for class 'BD'
print(x, ...)
## S3 method for class 'BD'
plot(x, pch = 8, number = TRUE, col = "red", save.plot = FALSE, 
  	save.options = c("plot", "default", "pdf"), ...)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="difBD_+3A_data">Data</code></td>
<td>
<p>numeric: either the data matrix only, or the data matrix plus the vector of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difBD_+3A_group">group</code></td>
<td>
<p>numeric or character: either the vector of group membership or the column indicator (within <code>Data</code>) of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difBD_+3A_focal.name">focal.name</code></td>
<td>
<p>numeric or character indicating the level of <code>group</code> which corresponds to the focal group.</p>
</td></tr>
<tr><td><code id="difBD_+3A_anchor">anchor</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of item names (or identifiers) to specify the anchor items. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difBD_+3A_match">match</code></td>
<td>
<p>specifies the type of matching criterion. Can be either <code>"score"</code> (default) to compute the test score, or any continuous or discrete variable with the same length as the number of rows of <code>Data</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difBD_+3A_bdstat">BDstat</code></td>
<td>
<p>character specifying the DIF statistic to be used. Possible values are <code>"BD"</code> (default) and <code>"trend"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difBD_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="difBD_+3A_purify">purify</code></td>
<td>
<p>logical: should the method be used iteratively to purify the set of anchor items? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difBD_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item purification process (default is 10).</p>
</td></tr>
<tr><td><code id="difBD_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>either <code>NULL</code> (default) or the acronym of the method for p-value adjustment for multiple comparisons. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difBD_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved into a text file? (Default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difBD_+3A_output">output</code></td>
<td>
<p>character: a vector of two components. The first component is the name of the output file, the second component is either the file path or 
<code>"default"</code> (default value). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difBD_+3A_x">x</code></td>
<td>
<p>the result from a BD class object.</p>
</td></tr>
<tr><td><code id="difBD_+3A_pch">pch</code>, <code id="difBD_+3A_col">col</code></td>
<td>
<p>type of usual <code>pch</code> and <code>col</code> graphical options.</p>
</td></tr>
<tr><td><code id="difBD_+3A_number">number</code></td>
<td>
<p>logical: should the item number identification be printed (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="difBD_+3A_save.plot">save.plot</code></td>
<td>
<p>logical: should the plot be saved into a separate file? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difBD_+3A_save.options">save.options</code></td>
<td>
<p>character: a vector of three components. The first component is the name of the output file, the second component is either the file path or 
<code>"default"</code> (default value), and the third component is the file extension, either <code>"pdf"</code> (default) or <code>"jpeg"</code>.
See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difBD_+3A_...">...</code></td>
<td>
<p>other generic parameters for the <code>plot</code> or the <code>print</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method of Breslow-Day (1980) allows for detecting non-uniform differential item functioning without requiring an item response model approach.
</p>
<p>The <code>Data</code> is a matrix whose rows correspond to the subjects and columns to the items. In addition, <code>Data</code> can hold the vector of group membership. 
If so, <code>group</code> indicates the column of <code>Data</code> which corresponds to the group membership, either by specifying its name or by giving the column number.
Otherwise, <code>group</code> must be a vector of same length as <code>nrow(Data)</code>.
</p>
<p>Missing values are allowed for item responses (not for group membership) but must be coded as <code>NA</code> values. They are discarded from sum-score computation.
</p>
<p>The vector of group membership must hold only two different values, either as numeric or character. The focal group is defined by the value of the argument <code>focal.name</code>. 
</p>
<p>Two test statistics are available: the usual Breslow-Day statistic for testing homogeneous association (Aguerri, Galibert, Attorresi and Maranon, 2009)
and the trend test statistic for assessing some monotonic trend in the odds ratios (Penfield, 2003). The DIF statistic is supplied by the <code>BDstat</code> argument, with values <code>"BD"</code> (default) for the usual statistic and <code>"trend"</code> for the trend test statistic.
</p>
<p>The matching criterion can be either the test score or any other continuous or discrete variable to be passed in the <code><a href="#topic+breslowDay">breslowDay</a></code> function. This is specified by the <code>match</code> argument. By default, it takes the value <code>"score"</code> and the test score (i.e. raw score) is computed. The second option is to assign to <code>match</code> a vector of continuous or discrete numeric values, which acts as the matching criterion. Note that for consistency this vector should not belong to the <code>Data</code> matrix.
</p>
<p>The threshold (or cut-score) for classifying items as DIF is computed as the quantile of the chi-squared distribution with lower-tail probability of one minus <code>alpha</code>, and the degrees of freedom depend on the DIF statistic. With the usual Breslow-Day statistic (<code>BDstat=="BD"</code>), it is the number of partial tables taken into account (Aguerri <em>et al.</em>, 2009). With the trend test statistic, the degrees
of freedom are always equal to one (Penfield, 2003).
</p>
<p>Item purification can be performed by setting <code>purify</code> to <code>TRUE</code>. Purification works as follows: if at least one item was detected as functioning 
differently at the first step of the process, then the data set of the next step consists in all items that are currently anchor (DIF free) items, plus the 
tested item (if necessary). The process stops when either two successive applications of the method yield the same classifications of the items (Clauser and Mazor,
1998), or when <code>nrIter</code> iterations are run without obtaining two successive identical classifications. In the latter case a warning message is printed. 
</p>
<p>Adjustment for multiple comparisons is possible with the argument <code>p.adjust.method</code>. The latter must be an acronym of one of the available adjustment methods of the <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function. According to Kim and Oshima (2013), Holm and Benjamini-Hochberg adjustments (set respectively by <code>"Holm"</code> and <code>"BH"</code>) perform best for DIF purposes. See <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function for further details. Note that item purification is performed on original statistics and p-values; in case of adjustment for multiple comparisons this is performed <em>after</em> item purification.
</p>
<p>A pre-specified set of anchor items can be provided through the <code>anchor</code> argument. It must be a vector of either item names (which must match exactly the column names of <code>Data</code> argument) or integer values (specifying the column numbers for item identification). In case anchor items are provided, they are used to compute the test score (matching criterion), including also the tested item. None of the anchor items are tested for DIF: the output separates anchor items and tested items and DIF results are returned only for the latter. Note also that item purification is not activated when anchor items are provided (even if <code>purify</code> is set to <code>TRUE</code>). By default it is <code>NULL</code> so that no anchor item is specified.
</p>
<p>The output of the <code>difBD</code>, as displayed by the <code>print.BD</code> function, can be stored in a text file provided that <code>save.output</code> is set to <code>TRUE</code> 
(the default value <code>FALSE</code> does not execute the storage). In this case, the name of the text file must be given as a character string into the first component
of the <code>output</code> argument (default name is <code>"out"</code>), and the path for saving the text file can be given through the second component of <code>output</code>. The
default value is <code>"default"</code>, meaning that the file will be saved in the current working directory. Any other path can be specified as a character string: see
the <b>Examples</b> section for an illustration.
</p>
<p>The <code>plot.BD</code> function displays the DIF statistics in a plot, with each item on the X axis. The type of point and the colour are fixed by the usual <code>pch</code>
and <code>col</code> arguments. Option <code>number</code> permits to display the item numbers instead. Also, the plot can be stored in a figure file, either in PDF or JPEG
format. Fixing <code>save.plot</code> to <code>TRUE</code> allows this process. The figure is defined through the components of <code>save.options</code>. The first two components
perform similarly as those of the <code>output</code> argument. The third component is the figure format, with allowed values <code>"pdf"</code> (default) for PDF file and
<code>"jpeg"</code> for JPEG file.
</p>


<h3>Value</h3>

<p>A list of class &quot;BD&quot; with the following arguments:
</p>
<table role = "presentation">
<tr><td><code>BD</code></td>
<td>
<p>a matrix with one row per item and three columns: the first one contains the Breslow-Day statistic value, the second column indicates 
the degrees of freedom, and the last column displays the asymptotic <em>p</em>-values.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the vector of p-values for the BD statistics.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the significance level for DIF detection.</p>
</td></tr>
<tr><td><code>DIFitems</code></td>
<td>
<p>either the column indicators of the items which were detected as DIF items, or &quot;No DIF item detected&quot;.</p>
</td></tr>
<tr><td><code>BDstat</code></td>
<td>
<p>the value of the <code>BDstat</code> argument.</p>
</td></tr>
<tr><td><code>match</code></td>
<td>
<p>a character string, either <code>"score"</code> or <code>"matching variable"</code> depending on the <code>match</code> argument.</p>
</td></tr>
<tr><td><code>p.adjust.method</code></td>
<td>
<p>the value of the <code>p.adjust.method</code> argument.</p>
</td></tr>
<tr><td><code>adjusted.p</code></td>
<td>
<p>either <code>NULL</code> or the vector of adjusted p-values for multiple comparisons.</p>
</td></tr>
<tr><td><code>purification</code></td>
<td>
<p>the value of <code>purify</code> option.</p>
</td></tr> 
<tr><td><code>nrPur</code></td>
<td>
<p>the number of iterations in the item purification process. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>difPur</code></td>
<td>
<p>a binary matrix with one row per iteration in the item purification process and one column per item. Zeros and ones in the <em>i</em>-th 
row refer to items which were classified respectively as non-DIF and DIF items at the (<em>i</em>-1)-th step. The first row corresponds to the initial
classification of the items. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>logical indicating whether the iterative item purification process stopped before the maximal number <code>nrIter</code> of allowed iterations. 
Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>the names of the items.</p>
</td></tr>
<tr><td><code>anchor.names</code></td>
<td>
<p>the value of the <code>anchor</code> argument.</p>
</td></tr>
<tr><td><code>save.output</code></td>
<td>
<p>the value of the <code>save.output</code> argument.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>the value of the <code>output</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Aguerri, M.E., Galibert, M.S., Attorresi, H.F. and Maranon, P.P. (2009). Erroneous detection of nonuniform DIF using the Breslow-Day test in a short test. <em>Quality and Quantity, 43</em>, 35-44. doi: <a href="https://doi.org/10.1007/s11135-007-9130-2">10.1007/s11135-007-9130-2</a>
</p>
<p>Breslow, N.E. and Day, N.E. (1980). <em>Statistical methods in cancer research, vol. I: The analysis of case-control studies</em>. Scientific Publication No 32.
International Agency for Research on Cancer, Lyon.
</p>
<p>Clauser, B.E. and Mazor, K.M. (1998). Using statistical procedures to identify differential item functioning test items. <em>Educational Measurement: Issues
and Practice, 17</em>, 31-44. 
</p>
<p>Kim, J., and Oshima, T. C. (2013). Effect of multiple testing adjustment in differential item functioning detection. <em>Educational and Psychological Measurement, 73</em>, 458&ndash;470. doi: <a href="https://doi.org/10.1177/0013164412467033">10.1177/0013164412467033</a>
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Penfield, R.D. (2003). Application of the Breslow-Day test of trend in odds ratio heterogeneity to the detection of nonuniform DIF. <em>Alberta Journal of 
Educational Research, 49</em>, 231-243.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+breslowDay">breslowDay</a></code>, <code><a href="#topic+dichoDif">dichoDif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)

 # Excluding the "Anger" variable
 verbal&lt;-verbal[colnames(verbal) != "Anger"]

 # Three equivalent settings of the data matrix and the group membership
 difBD(verbal, group = 25, focal.name = 1)
 difBD(verbal, group = "Gender", focal.name = 1)
 difBD(verbal[,1:24], group = verbal[,25], focal.name = 1)

 # With the BD trend test statistic
 difBD(verbal, group = 25, focal.name = 1, BDstat = "trend")

 # Multiple comparisons adjustment using Benjamini-Hochberg method
 difBD(verbal, group = 25, focal.name = 1, p.adjust.method = "BH")

 # With item purification  
 difBD(verbal, group = "Gender", focal.name = 1, purify = TRUE)
 difBD(verbal, group = "Gender", focal.name = 1, purify = TRUE, nrIter = 5)

 # With items 1 to 5 set as anchor items
 difBD(verbal, group = "Gender", focal.name = 1, anchor = 1:5)
 difBD(verbal, group = "Gender", focal.name = 1, anchor = 1:5, purify = TRUE)

 # Saving the output into the "BDresults.txt" file (and default path)
 r &lt;- difBD(verbal, group = 25, focal.name = 1, save.output = TRUE, 
            output = c("BDresults","default"))

 # Graphical devices
 plot(r)

 # Plotting results and saving it in a PDF figure
 plot(r, save.plot = TRUE, save.options = c("plot", "default", "pdf"))

 # Changing the path, JPEG figure
 path &lt;- "c:/Program Files/"
 plot(r, save.plot = TRUE, save.options = c("plot", path, "jpeg"))

## End(Not run)
 </code></pre>

<hr>
<h2 id='difGenLogistic'>Generalized logistic regression DIF method</h2><span id='topic+difGenLogistic'></span><span id='topic+print.genLogistic'></span><span id='topic+plot.genLogistic'></span>

<h3>Description</h3>

<p>Performs DIF detection among multiple groups using generalized 
logistic regression method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>difGenLogistic(Data, group, focal.names, anchor = NULL, match = "score", 
 	type = "both", criterion = "LRT", alpha = 0.05, purify = FALSE, nrIter = 10,
 	p.adjust.method = NULL, save.output = FALSE, output = c("out", "default"))
## S3 method for class 'genLogistic'
print(x, ...)
## S3 method for class 'genLogistic'
plot(x, plot = "lrStat", item = 1, itemFit = "best",pch = 8, number = TRUE,
  	col = "red", colIC = rep("black", length(x$focal.names)+1),
  	ltyIC = 1:(length(x$focal.names)+1), title = NULL, save.plot = FALSE, 
  	save.options = c("plot", "default", "pdf"), ref.name = NULL, ...)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="difGenLogistic_+3A_data">Data</code></td>
<td>
<p>numeric: either the data matrix only, or the data matrix plus the vector of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_group">group</code></td>
<td>
<p>numeric or character: either the vector of group membership or the column indicator (within <code>data</code>) of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_focal.names">focal.names</code></td>
<td>
<p>numeric or character vector indicating the levels of <code>group</code> which correspond to the focal groups.</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_anchor">anchor</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of item names (or identifiers) to specify the anchor items. Ignored if <code>match</code> is not <code>"score"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_match">match</code></td>
<td>
<p>specifies the type of matching criterion. Can be either <code>"score"</code> (default) to compute the test score, or any continuous or discrete variable with the same length as the number of rows of <code>Data</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_type">type</code></td>
<td>
<p>a character string specifying which DIF effects must be tested. Possible values are <code>"both"</code> (default), <code>"udif"</code> and <code>"nudif"</code>.
See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_criterion">criterion</code></td>
<td>
<p>character: the type of test statistic used to detect DIF items. Possible values are <code>"LRT"</code> (default) and <code>"Wald"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_purify">purify</code></td>
<td>
<p>logical: should the method be used iteratively to purify the set of anchor items? (default is FALSE).</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item purification process (default is 10).</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>either <code>NULL</code> (default) or the acronym of the method for p-value adjustment for multiple comparisons. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved into a text file? (Default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_output">output</code></td>
<td>
<p>character: a vector of two components. The first component is the name of the output file, the second component is either the file path or
<code>"default"</code> (default value). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_x">x</code></td>
<td>
<p>the result from a <code>Logistik</code> class object.</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_plot">plot</code></td>
<td>
<p>character: the type of plot, either <code>"lrStat"</code> or <code>"itemCurve"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_item">item</code></td>
<td>
<p>numeric or character: either the number or the name of the item for which logistic curves are plotted. Use only when <code>plot="itemCurve"</code>.</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_itemfit">itemFit</code></td>
<td>
<p>character: the model to be selected for drawing the item curves. Possible values are <code>"best"</code> (default) for drawing from the best of the two
models, and <code>"null"</code> for using fitted parameters of the null model <code class="reqn">M_0</code>. Not used if <code>"plot"</code> is <code>"lrStat"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_pch">pch</code>, <code id="difGenLogistic_+3A_col">col</code></td>
<td>
<p>type of usual <code>pch</code> and <code>col</code> graphical options.</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_number">number</code></td>
<td>
<p>logical: should the item number identification be printed (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_colic">colIC</code>, <code id="difGenLogistic_+3A_ltyic">ltyIC</code></td>
<td>
<p>vectors of elements of the usual <code>col</code> and <code>lty</code> arguments for logistic curves. Used only when <code>plot="itemCurve"</code>.</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_title">title</code></td>
<td>
<p>either a character string with the title of the plot, or <code>NULL</code> (default), for which a specific title is automatically displayed.</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_save.plot">save.plot</code></td>
<td>
<p>logical: should the plot be saved into a separate file? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_save.options">save.options</code></td>
<td>
<p>character: a vector of three components. The first component is the name of the output file, the second component is either the file path or
<code>"default"</code> (default value), and the third component is the file extension, either <code>"pdf"</code> (default) or <code>"jpeg"</code>. See
<b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_ref.name">ref.name</code></td>
<td>
<p>either <code>NULL</code>(default) or a character string for the name of the reference group (to be used instead of &quot;Reference&quot; in the legend). Ignored 
if <code>plot</code> is <code>"lrStat"</code>.</p>
</td></tr>
<tr><td><code id="difGenLogistic_+3A_...">...</code></td>
<td>
<p>other generic parameters for the <code>plot</code> or the <code>print</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generalized logistic regression method (Magis, Raiche, Beland and Gerard, 2011) allows for detecting both uniform and non-uniform differential item
functioning among multiple groups without requiring an item response model approach. It consists in fitting a logistic model with the matching criterion,
the group membership and an interaction between both as covariates. The statistical significance of the parameters
related to group membership and the group-score interaction is then evaluated by means of the usual likelihood-ratio
test. The argument <code>type</code> permits to test either both uniform and nonuniform effects simultaneously (<code>type="both"</code>), only uniform
DIF effect (<code>type="udif"</code>) or only nonuniform DIF effect (<code>type="nudif"</code>). The identification of DIF items can be performed with
either the Wald test or the likelihood  ratio test, by setting the <code>criterion</code> argument to <code>"Wald"</code> or <code>"LRT"</code> respectively.
See <code><a href="#topic+genLogistik">genLogistik</a></code> for further details.
</p>
<p>The matching criterion can be either the test score or any other continuous or discrete variable to be passed in the <code><a href="#topic+genLogistik">genLogistik</a></code> function. This is specified by the <code>match</code> argument. By default, it takes the value <code>"score"</code> and the test score (i.e. raw score) is computed. The second option is to assign to <code>match</code> a vector of continuous or discrete numeric values, which acts as the matching criterion. Note that for consistency this vector should not belong to the <code>Data</code> matrix.
</p>
<p>The <code>Data</code> is a matrix whose rows correspond to the subjects and columns to the items. In addition, <code>Data</code> can hold the vector of group membership.
If so, <code>group</code> indicates the column of <code>Data</code> which corresponds to the group membership, either by specifying its name or by giving the column number.
Otherwise, <code>group</code> must be a vector of same length as <code>nrow(Data)</code>.
</p>
<p>Missing values are allowed for item responses (not for group membership) but must be coded as <code>NA</code> values. They are discarded from the fitting of the
logistic models (see <code><a href="stats.html#topic+glm">glm</a></code> for further details).
</p>
<p>The vector of group membership must hold at least three values, either as numeric or character. The focal groups are defined by the values of the 
argument <code>focal.names</code>. If there is a unique focal group, then <code>difGenLogistic</code> returns the output of <code><a href="#topic+difLogistic">difLogistic</a></code>.
</p>
<p>The threshold (or cut-score) for classifying items as DIF is computed as the quantile of the chi-squared distribution with lower-tail
probability of one minus <code>alpha</code> and with <em>J</em> (if <code>type="udif"</code> or <code>type="nudif"</code>) or <em>2J</em> (if <code>type="both"</code>) degrees of
freedom (<em>J</em> is the number of focal groups).
</p>
<p>Item purification can be performed by setting <code>purify</code> to <code>TRUE</code>. Purification works as follows: if at least one item is detected as functioning 
differently at the first step of the process, then the data set of the next step consists in all items that are currently anchor (DIF free) items, plus the 
tested item (if necessary). The process stops when either two successive applications of the method yield the same classifications of the items
(Clauser and Mazor, 1998), or when <code>nrIter</code> iterations are run without obtaining two successive identical classifications. In the latter case a warning message is printed. 
</p>
<p>Adjustment for multiple comparisons is possible with the argument <code>p.adjust.method</code>. The latter must be an acronym of one of the available adjustment methods of the <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function. According to Kim and Oshima (2013), Holm and Benjamini-Hochberg adjustments (set respectively by <code>"Holm"</code> and <code>"BH"</code>) perform best for DIF purposes. See <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function for further details. Note that item purification is performed on original statistics and p-values; in case of adjustment for multiple comparisons this is performed <em>after</em> item purification.
</p>
<p>A pre-specified set of anchor items can be provided through the <code>anchor</code> argument. It must be a vector of either item names (which must match exactly the column names of <code>Data</code> argument) or integer values (specifying the column numbers for item identification). In case anchor items are provided, they are used to compute the test score (matching criterion), including also the tested item. None of the anchor items are tested for DIF: the output separates anchor items and tested items and DIF results are returned only for the latter. By default it is <code>NULL</code> so that no anchor item is specified. Note also that item purification is not activated when anchor items are provided (even if <code>purify</code> is set to <code>TRUE</code>). Moreover, if the <code>match</code> argument is not set to <code>"score"</code>, anchor items will not be taken into account even if <code>anchor</code> is not <code>NULL</code>. 
</p>
<p>The measures of effect size are provided by the difference <code class="reqn">\Delta R^2</code> between the <code class="reqn">R^2</code> coefficients of the two nested models (Nagelkerke, 1991; Gomez-Benito, Dolores Hidalgo and Padilla, 2009). The effect sizes are classified as &quot;negligible&quot;, &quot;moderate&quot; or &quot;large&quot;. Two scales are available, one from Zumbo and Thomas (1997) and one from Jodoin and Gierl (2001). The output displays the <code class="reqn">\Delta R^2</code> measures, together with the two classifications.
</p>
<p>The output of the <code>difGenLogistic</code>, as displayed by the <code>print.genLogistic</code> function, can be stored in a text file provided that <code>save.output</code> is set
to <code>TRUE</code> (the default value <code>FALSE</code> does not execute the storage). In this case, the name of the text file must be given as a character string into the
first component of the <code>output</code> argument (default name is <code>"out"</code>), and the path for saving the text file can be given through the second component of
<code>output</code>. The default value is <code>"default"</code>, meaning that the file will be saved in the current working directory. Any other path can be specified as a
character string: see the <b>Examples</b> section for an illustration.
</p>
<p>Two types of plots are available. The first one is obtained by setting <code>plot="lrStat"</code> and it is the default option. The likelihood ratio statistics are
displayed on the Y axis, for each item. The detection threshold is displayed by a horizontal line, and items flagged as DIF are printed with the color defined by
argument <code>col</code>. By default, items are spotted with their number identification (<code>number=TRUE</code>); otherwise they are simply drawn as dots whose form is
given by the option <code>pch</code>.
</p>
<p>The other type of plot is obtained by setting <code>plot="itemCurve"</code>. In this case, the fitted logistic curves are displayed for one specific item set by the
argument <code>item</code>. The latter argument can hold either the name of the item or its number identification. If the argument <code>itemFit</code> takes the value
<code>"best"</code>, the curves are drawn according to the output of the best model among <code class="reqn">M_0</code> and <code class="reqn">M_1</code>. That is, two curves are drawn if the item is flagged
as DIF, and only one if the item is flagged as non-DIF. If <code>itemFit</code> takes the value <code>"null"</code>, then the two curves are drawn from the fitted parameters
of the null model <code class="reqn">M_0</code>. See <code><a href="#topic+genLogistik">genLogistik</a></code> for further details on the models. The colors and types of traits for these curves are defined by means
of the arguments <code>colIC</code> and <code>ltyIC</code> respectively. These are set as vectors of length <code class="reqn">J+1</code>, the first element for the reference group and the others
for the focal groups. Finally, the <code>ref.name</code> argument permits to display the name if the reference group (instead of &quot;Reference&quot;) in the legend.
</p>
<p>Both types of plots can be stored in a figure file, either in PDF or JPEG format. Fixing <code>save.plot</code> to <code>TRUE</code> allows this process. The figure is defined
through the components of <code>save.options</code>. The first two components perform similarly as those of the <code>output</code> argument. The third component is the figure
format, with allowed values <code>"pdf"</code> (default) for PDF file and <code>"jpeg"</code> for JPEG file.
</p>


<h3>Value</h3>

<p>A list of class &quot;genLogistic&quot; with the following arguments:
</p>
<table role = "presentation">
<tr><td><code>genLogistik</code></td>
<td>
<p>the values of the generalized logistic regression statistics.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the vector of p-values for the generalized logistic regression statistics.</p>
</td></tr>
<tr><td><code>logitPar</code></td>
<td>
<p>a matrix with one row per item and <code class="reqn">2+J*2</code> columns, holding the fitted parameters of the best model (among the two tested models) for each
item.</p>
</td></tr>
<tr><td><code>parM0</code></td>
<td>
<p>the matrix of fitted parameters of the null model <code class="reqn">M_0</code>, as returned by the <code><a href="#topic+Logistik">Logistik</a></code> command.</p>
</td></tr>
<tr><td><code>covMat</code></td>
<td>
<p>a 3-dimensional matrix of size <em>p</em> x <em>p</em> x <em>K</em>, where <em>p</em> is the number of estimated parameters and <em>K</em> is the number of
items, holding the <em>p</em> x <em>p</em> covariance matrices of the estimated parameters (one matrix for each tested item).</p>
</td></tr>
<tr><td><code>deltaR2</code></td>
<td>
<p>the differences in Nagelkerke's <code class="reqn">R^2</code> coefficients. See <b>Details</b>.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the value of <code>alpha</code> argument.</p>
</td></tr>
<tr><td><code>thr</code></td>
<td>
<p>the threshold (cut-score) for DIF detection.</p>
</td></tr>
<tr><td><code>DIFitems</code></td>
<td>
<p>either the column indicators for the items which were detected as DIF items, or &quot;No DIF item detected&quot;.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>the value of <code>type</code> argument.</p>
</td></tr>
<tr><td><code>p.adjust.method</code></td>
<td>
<p>the value of the <code>p.adjust.method</code> argument.</p>
</td></tr>
<tr><td><code>adjusted.p</code></td>
<td>
<p>either <code>NULL</code> or the vector of adjusted p-values for multiple comparisons.</p>
</td></tr>
<tr><td><code>purification</code></td>
<td>
<p>the value of <code>purify</code> option.</p>
</td></tr> 
<tr><td><code>nrPur</code></td>
<td>
<p>the number of iterations in the item purification process. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>difPur</code></td>
<td>
<p>a binary matrix with one row per iteration in the item purification process and one column per item. Zeros and ones in the <em>i</em>-th 
row refer to items which were classified respectively as non-DIF and DIF items at the (<em>i</em>-1)-th step. The first row corresponds to the initial
classification of the items. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>logical indicating whether the iterative item purification process stopped before the maximal number of <code>nrItem</code> allowed iterations. 
Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>the names of the items.</p>
</td></tr>
<tr><td><code>anchor.names</code></td>
<td>
<p>the value of the <code>anchor</code> argument.</p>
</td></tr>
<tr><td><code>focal.names</code></td>
<td>
<p>the value of <code>focal.names</code> argument.</p>
</td></tr>
<tr><td><code>criterion</code></td>
<td>
<p>the value of the <code>criterion</code> argument.</p>
</td></tr>
<tr><td><code>save.output</code></td>
<td>
<p>the value of the <code>save.output</code> argument.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>the value of the <code>output</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Clauser, B.E. and Mazor, K.M. (1998). Using statistical procedures to identify differential item functioning test items. <em>Educational Measurement: Issues
and Practice, 17</em>, 31-44. 
</p>
<p>Gomez-Benito, J., Dolores Hidalgo, M. and Padilla, J.-L. (2009). Efficacy of effect size measures in logistic regression: an application for detecting DIF. 
<em>Methodology, 5</em>, 18-25. doi: <a href="https://doi.org/10.1027/1614-2241.5.1.18">10.1027/1614-2241.5.1.18</a>
</p>
<p>Hidalgo, M. D. and Lopez-Pina, J.A. (2004). Differential item functioning detection and effect size: a comparison between logistic regression and Mantel-Haenszel
procedures. <em>Educational and Psychological Measurement, 64</em>, 903-915.  doi: <a href="https://doi.org/10.1177/0013164403261769">10.1177/0013164403261769</a>
</p>
<p>Jodoin, M. G. and Gierl, M. J. (2001). Evaluating Type I error and power rates using an effect size measure with logistic regression procedure for DIF detection. <em>Applied Measurement in Education, 14</em>, 329-349. doi: <a href="https://doi.org/10.1207/S15324818AME1404_2">10.1207/S15324818AME1404_2</a>
</p>
<p>Kim, J., and Oshima, T. C. (2013). Effect of multiple testing adjustment in differential item functioning detection. <em>Educational and Psychological Measurement, 73</em>, 458&ndash;470. doi: <a href="https://doi.org/10.1177/0013164412467033">10.1177/0013164412467033</a>
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Magis, D., Raiche, G., Beland, S. and Gerard, P. (2011). A logistic regression procedure to detect differential item functioning among multiple groups. <em>International Journal of Testing, 11</em>, 365&ndash;386. doi: <a href="https://doi.org/10.1080/15305058.2011.602810">10.1080/15305058.2011.602810</a>
</p>
<p>Nagelkerke, N. J. D. (1991). A note on a general definition of the coefficient of determination. <em>Biometrika, 78</em>, 691-692. doi: <a href="https://doi.org/10.1093/biomet/78.3.691">10.1093/biomet/78.3.691</a>
</p>
<p>Zumbo, B. D. and Thomas, D. R. (1997). <em>A measure of effect size for a model-based approach for studying DIF</em>. Prince George, Canada: University of Northern British
Columbia, Edgeworth Laboratory for Quantitative Behavioral Science.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+genLogistik">genLogistik</a></code>, <code><a href="#topic+genDichoDif">genDichoDif</a></code>, <code><a href="#topic+subtestLogistic">subtestLogistic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Creating four groups according to gender ("Man" or "Woman") and
 # trait anger score ("Low" or "High")
 group &lt;- rep("WomanLow", nrow(verbal))
 group[Anger&gt;20 &amp; Gender==0] &lt;- "WomanHigh"
 group[Anger&lt;=20 &amp; Gender==1] &lt;- "ManLow"
 group[Anger&gt;20 &amp; Gender==1] &lt;- "ManHigh"

 # New data set
 Verbal &lt;- cbind(verbal[,1:24], group)

 # Reference group: "WomanLow"
 names &lt;- c("WomanHigh", "ManLow", "ManHigh")

 # Testing both types of DIF effects
 # Three equivalent settings of the data matrix and the group membership
 r &lt;- difGenLogistic(Verbal, group = 25, focal.names = names)
 difGenLogistic(Verbal, group = "group", focal.name = names)
 difGenLogistic(Verbal[,1:24], group = Verbal[,25], focal.names = names)

 # Using the Wald test
 difGenLogistic(Verbal, group = 25, focal.names = names, criterion = "Wald")

 # Multiple comparisons adjustment using Benjamini-Hochberg method
difGenLogistic(Verbal, group = 25, focal.names = names, p.adjust.method = "BH")

 # With item purification
 difGenLogistic(Verbal, group = 25, focal.names = names, purify = TRUE)
 difGenLogistic(Verbal, group = 25, focal.names = names, purify = TRUE,
   nrIter = 5)

 # With items 1 to 5 set as anchor items
 difGenLogistic(Verbal, group = 25, focal.name = names, anchor = 1:5)

 # Testing for nonuniform DIF effect
 difGenLogistic(Verbal, group = 25, focal.names = names, type = "nudif")

 # Testing for uniform DIF effect
 difGenLogistic(Verbal, group = 25, focal.names = names, type = "udif")

 # User anger trait score as matching criterion
 anger &lt;- verbal[,25]
 difGenLogistic(Verbal, group = 25, focal.names = names, match = anger)

 # Saving the output into the "GLresults.txt" file (and default path)
 r &lt;- difGenLogistic(Verbal, group = 25, focal.name = names, 
                save.output = TRUE, output = c("GLresults","default"))

 # Graphical devices
 plot(r)
 plot(r, plot = "itemCurve", item = 1)
 plot(r, plot = "itemCurve", item = 1, itemFit = "best")
 plot(r, plot = "itemCurve", item = 6)
 plot(r, plot = "itemCurve", item = 6, itemFit = "best")

 # Plotting results and saving it in a PDF figure
 plot(r, save.plot = TRUE, save.options = c("plot", "default", "pdf"))

 # Changing the path, JPEG figure
 path &lt;- "c:/Program Files/"
 plot(r, save.plot = TRUE, save.options = c("plot", path, "jpeg"))

## End(Not run)
 </code></pre>

<hr>
<h2 id='difGenLord'>Generalized Lord's chi-squared DIF method</h2><span id='topic+difGenLord'></span><span id='topic+plot.GenLord'></span><span id='topic+print.GenLord'></span>

<h3>Description</h3>

<p>Performs DIF detection among multiple groups using generalized Lord's chi-squared method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>difGenLord(Data, group, focal.names, model, c = NULL, engine = "ltm", 
 	discr = 1, irtParam = NULL, nrFocal = 2, same.scale = TRUE, anchor = NULL,
 	alpha = 0.05, purify = FALSE, nrIter = 10, p.adjust.method = NULL, 
 	save.output = FALSE, 	output = c("out", "default")) 
## S3 method for class 'GenLord'
print(x, ...)
## S3 method for class 'GenLord'
plot(x, plot = "lordStat", item = 1, pch = 8,
  	number = TRUE, col = "red", colIC = rep("black",
  	length(x$focal.names)+1), ltyIC = 1:(length(x$focal.names)
  	+ 1), save.plot = FALSE, save.options = c("plot", "default", "pdf"),
      ref.name = NULL, ...)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="difGenLord_+3A_data">Data</code></td>
<td>
<p>numeric: either the data matrix only, or the data matrix plus the vector of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_group">group</code></td>
<td>
<p>numeric or character: either the vector of group membership or the column indicator (within <code>Data</code>) of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_focal.names">focal.names</code></td>
<td>
<p>numeric or character vector indicating the levels of <code>group</code> which correspond to the focal groups.</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_model">model</code></td>
<td>
<p>character: the IRT model to be fitted (either <code>"1PL"</code>, <code>"2PL"</code> or <code>"3PL"</code>).</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_c">c</code></td>
<td>
<p>optional numeric value or vector giving the values of the constrained pseudo-guessing parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_engine">engine</code></td>
<td>
<p>character: the engine for estimating the 1PL model, either <code>"ltm"</code> (default) or <code>"lme4"</code>.</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_discr">discr</code></td>
<td>
<p>either <code>NULL</code> or a real positive value for the common discrimination parameter (default is 1). Used onlky if <code>model</code> is <code>"1PL"</code> and
<code>engine</code> is <code>"ltm"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_irtparam">irtParam</code></td>
<td>
<p>matrix with <em>2J</em> rows (where <em>J</em> is the number of items) and at most 9 columns containing item parameters estimates. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_nrfocal">nrFocal</code></td>
<td>
<p>numeric: the number of focal groups (default is 2).</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_same.scale">same.scale</code></td>
<td>
<p>logical: are the item parameters of the <code>irtParam</code> matrix on the same scale? (default is <code>TRUE</code>). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_anchor">anchor</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of item names (or identifiers) to specify the anchor items. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_purify">purify</code></td>
<td>
<p>logical: should the method be used iteratively to purify the set of anchor items? (default is FALSE).</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item purification process (default is 10).</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>either <code>NULL</code> (default) or the acronym of the method for p-value adjustment for multiple comparisons. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved into a text file? (Default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_output">output</code></td>
<td>
<p>character: a vector of two components. The first component is the name of the output file, the second component is either the file path or <code>"default"</code> (default value). See <b>Details</b>.</p>
</td></tr> 
<tr><td><code id="difGenLord_+3A_x">x</code></td>
<td>
<p>the result from a <code>GenLord</code> class object.</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_plot">plot</code></td>
<td>
<p>character: the type of plot, either <code>"lordStat"</code> or <code>"itemCurve"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_item">item</code></td>
<td>
<p>numeric or character: either the number or the name of the item for which ICC curves are plotted. Used only when <code>plot="itemCurve"</code>.</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_pch">pch</code>, <code id="difGenLord_+3A_col">col</code></td>
<td>
<p>type of usual <code>pch</code> and <code>col</code> graphical options.</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_number">number</code></td>
<td>
<p>logical: should the item number identification be printed (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_colic">colIC</code>, <code id="difGenLord_+3A_ltyic">ltyIC</code></td>
<td>
<p>vectors of elements of the usual <code>col</code> and <code>lty</code> arguments for ICC curves. Used only when <code>plot="itemCurve"</code>.</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_save.plot">save.plot</code></td>
<td>
<p>logical: should the plot be saved into a separate file? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_save.options">save.options</code></td>
<td>
<p>character: a vector of three components. The first component is the name of the output file, the second component is either the file path or <code>"default"</code> (default value), and the third component is the file extension, either <code>"pdf"</code> (default) or <code>"jpeg"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_ref.name">ref.name</code></td>
<td>
<p>either <code>NULL</code>(default) or a character string for the name of the reference group (to be used instead of &quot;Reference&quot; in the legend). Ignored if <code>plot</code> is <code>"lordStat"</code>.</p>
</td></tr>
<tr><td><code id="difGenLord_+3A_...">...</code></td>
<td>
<p>other generic parameters for the <code>plot</code> or the <code>print</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generalized Lord's chi-squared method (Kim, Cohen and Park, 1995), also referred to as <em>Qj</em> statistic, allows for detecting uniform or non-uniform
differential item functioning among multiple groups by setting an appropriate item response model. The input can be of two kinds: either by displaying 
the full data, the group membership, the focal groups and the model, or by giving the item parameter estimates (with the option <code>irtParam</code>).
Both can be supplied, but in this case only the parameters in <code>irtParam</code> are used for computing generalized Lord's chi-squared statistic.
</p>
<p>The <code>Data</code> is a matrix whose rows correspond to the subjects and columns to the items.
In addition, <code>Data</code> can hold the vector of group membership. If so, <code>group</code> indicates the column of <code>Data</code> which corresponds to the group membership, either by specifying its name or by giving the column number. Otherwise, <code>group</code> must be a vector of same length as <code>nrow(Data)</code>.
</p>
<p>Missing values are allowed for item responses (not for group membership) but must be coded as <code>NA</code> values. They are discarded for item parameter estimation.
</p>
<p>The vector of group membership must hold at least three different values, either as numeric or character. The focal groups are defined by the values of the argument <code>focal.names</code>. 
</p>
<p>If the model is not the 1PL model, or if <code>engine</code> is equal to <code>"ltm"</code>, the selected IRT model is fitted using marginal maximum likelihood by means of the functions from the <code>ltm</code> package (Rizopoulos, 2006). Otherwise, the 1PL model is fitted as a generalized linear mixed model, by means of the <code>glmer</code> function of the <code>lme4</code> package (Bates and Maechler, 2009).
</p>
<p>With the <code>"1PL"</code> model and the <code>"ltm"</code> engine, the common discrimination parameter is set equal to 1 by default. It is possible to fix another value through the argument<code>discr</code>. Alternatively, this common discrimination parameter can be estimated (though not returned) by fixing <code>discr</code> to 
<code>NULL</code>.
</p>
<p>The 3PL model can be fitted either unconstrained (by setting <code>c</code> to <code>NULL</code>) or by fixing the pseudo-guessing values. In the latter case, the argument <code>c</code> is either a numeric vector of same length of the number of items, with one value per item pseudo-guessing parameter, or a single value which is duplicated for all the items. If <code>c</code> is different from <code>NULL</code> then the 3PL model is always fitted (whatever the value of <code>model</code>).
</p>
<p>The <code>irtParam</code> matrix has a number of rows equal to the number of groups (reference and focal ones) times the number of items <em>J</em>. The first <em>J</em> rows refer to the item parameter estimates in the reference group, while the next sets of <em>J</em> rows correspond to the same items in each of 
the focal groups. The number of columns depends on the selected IRT model: 2 for the 1PL model, 5 for the 2PL model, 6 for the constrained 3PL model and 9 for the unconstrained 3PL model. The columns of <code>irtParam</code> have to follow the same structure as the output of <code>itemParEst</code> command (the latter can actually be used to create the <code>irtParam</code> matrix). The number of focal groups has to be specified with argument <code>nrFocal</code> (default value is 2).
</p>
<p>In addition to the matrix of parameter estimates, one has to specify whether items in the focal groups were rescaled to those of the reference group. If not, rescaling is performed by equal means anchoring (Cook and Eignor, 1991). Argument <code>same.scale</code> is used for this choice (default option is <code>TRUE</code> and assumes therefore that the parameters are already placed on a same scale). 
</p>
<p>The threshold (or cut-score) for classifying items as DIF is computed as the quantile of the chi-squared distribution with lower-tail probability of one minus <code>alpha</code> and <em>p</em> degrees of freedom. The value of <em>p</em> is the product of the number of focal groups by the number of item parameters to be tested (1 for the 1PL model, 2 for the 2PL model or the constrained 3PL model, and 3 for the unconstrained 3PL model).
</p>
<p>Item purification can be performed by setting <code>purify</code> to <code>TRUE</code>. In this case, the purification occurs in the equal means anchoring process: items detected as DIF are iteratively removed from the set of items used for equal means anchoring, and the procedure is repeated until either the same items
are identified twice as functioning differently, or when <code>nrIter</code> iterations have been performed. In the latter case a warning message is printed. See Candell and Drasgow (1988) for further details.
</p>
<p>Adjustment for multiple comparisons is possible with the argument <code>p.adjust.method</code>. The latter must be an acronym of one of the available adjustment methods of the <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function. According to Kim and Oshima (2013), Holm and Benjamini-Hochberg adjustments (set respectively by <code>"Holm"</code> and <code>"BH"</code>) perform best for DIF purposes. See <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function for further details. Note that item purification is performed on original statistics and p-values; in case of adjustment for multiple comparisons this is performed <em>after</em> item purification.
</p>
<p>A pre-specified set of anchor items can be provided through the <code>anchor</code> argument. It must be a vector of either item names (which must match exactly the column names of <code>Data</code> argument) or integer values (specifying the column numbers for item identification). In case anchor items are provided, they are used to rescale the item parameters on a common metric. None of the anchor items are tested for DIF: the output separates anchor items and tested items and DIF results are returned only for the latter. Note also that item purification is not activated when anchor items are provided (even if <code>purify</code> is set to <code>TRUE</code>). By default it is <code>NULL</code> so that no anchor item is specified. If item parameters are provided thorugh the <code>irtParam</code> argument and if they are on the same scale (i.e. if <code>same.scale</code> is <code>TRUE</code>), then anchor items are not used (even if they are specified).
</p>
<p>The output of the <code>difGenLord</code>, as displayed by the <code>print.GenLord</code> function, can be stored in a text file provided that <code>save.output</code> is set to <code>TRUE</code> 
(the default value <code>FALSE</code> does not execute the storage). In this case, the name of the text file must be given as a character string into the first component
of the <code>output</code> argument (default name is <code>"out"</code>), and the path for saving the text file can be given through the second component of <code>output</code>. The
default value is <code>"default"</code>, meaning that the file will be saved in the current working directory. Any other path can be specified as a character string: see the 
<b>Examples</b> section for an illustration.
</p>
<p>Two types of plots are available. The first one is obtained by setting <code>plot="lordStat"</code> and it is the default option. The chi-squared statistics are displayed 
on the Y axis, for each item. The detection threshold is displayed by a horizontal line, and items flagged as DIF are printed with the color defined by argument <code>col</code>.
By default, items are spotted with their number identification (<code>number=TRUE</code>); otherwise they are simply drawn as dots whose form is given by the option <code>pch</code>.
</p>
<p>The other type of plot is obtained by setting <code>plot="itemCurve"</code>. In this case, the fitted ICC curves are displayed for one specific item set by the argument 
<code>item</code>. The latter argument can hold either the name of the item or its number identification. The item parameters are extracted from the <code>itemParFinal</code> matrix
if the output argument <code>purification</code> is <code>TRUE</code>, otherwise from the <code>itemParInit</code> matrix and after a rescaling of the item parameters using the 
<code><a href="#topic+itemRescale">itemRescale</a></code> command. A legend is displayed in the upper left corner of the plot. The colors and types of traits for these curves are defined by means of 
the arguments <code>colIC</code> and <code>ltyIC</code> respectively. These are set as vectors of length 2, the first element for the reference group and the second for the focal group.
Finally, the <code>ref.name</code> argument permits to display the name if the reference group (instead of &quot;Reference&quot;) in the legend.
</p>
<p>Both types of plots can be stored in a figure file, either in PDF or JPEG format. Fixing <code>save.plot</code> to <code>TRUE</code> allows this process. The figure is defined through
the components of <code>save.options</code>. The first two components perform similarly as those of the <code>output</code> argument. The third component is the figure format, with 
allowed values <code>"pdf"</code> (default) for PDF file and <code>"jpeg"</code> for JPEG file.
</p>


<h3>Value</h3>

<p>A list of class &quot;GenLord&quot; with the following arguments:
</p>
<table role = "presentation">
<tr><td><code>genLordChi</code></td>
<td>
<p>the values of the generalized Lord's chi-squared statistics.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the vector of p-values for the generalized Lord's chi-square statistics.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the value of <code>alpha</code> argument.</p>
</td></tr>
<tr><td><code>thr</code></td>
<td>
<p>the threshold (cut-score) for DIF detection.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the degrees of freedom of the asymptotic null distribution of the statistics.</p>
</td></tr>
<tr><td><code>DIFitems</code></td>
<td>
<p>either the column indicators of the items which were detected as DIF items, or &quot;No DIF item detected&quot;.</p>
</td></tr>
<tr><td><code>p.adjust.method</code></td>
<td>
<p>the value of the <code>p.adjust.method</code> argument.</p>
</td></tr>
<tr><td><code>adjusted.p</code></td>
<td>
<p>either <code>NULL</code> or the vector of adjusted p-values for multiple comparisons.</p>
</td></tr>
<tr><td><code>purification</code></td>
<td>
<p>the value of <code>purify</code> option.</p>
</td></tr> 
<tr><td><code>nrPur</code></td>
<td>
<p>the number of iterations in the item purification process. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>difPur</code></td>
<td>
<p>a binary matrix with one row per iteration in the item purification process and one column per item. Zeros and ones in the <em>i</em>-th 
row refer to items which were classified respectively as non-DIF and DIF items at the (<em>i</em>-1)-th step. The first row corresponds to the initial
classification of the items. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>logical indicating whether the iterative item purification process stopped before the maximal number <code>nrIter</code>of allowed iterations. 
Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the value of <code>model</code> argument.</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p>The value of the <code>c</code> argument.</p>
</td></tr>
<tr><td><code>engine</code></td>
<td>
<p>The value of the <code>engine</code> argument.</p>
</td></tr>
<tr><td><code>discr</code></td>
<td>
<p>the value of the <code>discr</code> argument.</p>
</td></tr>
<tr><td><code>itemParInit</code></td>
<td>
<p>the matrix of initial parameter estimates, with the same format as <code>irtParam</code> either provided by the user (through <code>irtParam</code>) or estimated from the data (and displayed after rescaling).</p>
</td></tr>
<tr><td><code>itemParFinal</code></td>
<td>
<p>the matrix of final parameter estimates, with the same format as <code>irtParam</code>, obtained after item purification. Returned 
only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>estPar</code></td>
<td>
<p>a logical value indicating whether the item parameters were estimated (<code>TRUE</code>) or provided by the user (<code>FALSE</code>).</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>the names of the items.</p>
</td></tr>
<tr><td><code>anchor.names</code></td>
<td>
<p>the value of the <code>anchor</code> argument.</p>
</td></tr>
<tr><td><code>focal.names</code></td>
<td>
<p>the value of the <code>focal.names</code> argument.</p>
</td></tr>
<tr><td><code>save.output</code></td>
<td>
<p>the value of the <code>save.output</code> argument.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>the value of the <code>output</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Bates, D. and Maechler, M. (2009). lme4: Linear mixed-effects models using S4 classes. R package version 0.999375-31. http://CRAN.R-project.org/package=lme4
</p>
<p>Candell, G.L. and Drasgow, F. (1988). An iterative procedure for linking metrics and assessing item bias in item response theory. <em>Applied Psychological Measurement, 12</em>, 253-260. 
</p>
<p>Cook, L. L. and Eignor, D. R. (1991). An NCME instructional module on IRT equating methods. <em>Educational Measurement: Issues and Practice, 10</em>, 37-45.
</p>
<p>Kim, S.-H., Cohen, A.S. and Park, T.-H. (1995). Detection of differential item functioning in multiple groups. <em>Journal of Educational Measurement, 32</em>, 261-276. doi: <a href="https://doi.org/10.1111/j.1745-3984.1995.tb00466.x">10.1111/j.1745-3984.1995.tb00466.x</a>
</p>
<p>Kim, J., and Oshima, T. C. (2013). Effect of multiple testing adjustment in differential item functioning detection. <em>Educational and Psychological Measurement, 73</em>, 458&ndash;470. doi: <a href="https://doi.org/10.1177/0013164412467033">10.1177/0013164412467033</a>
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Rizopoulos, D. (2006). ltm: An R package for latent variable modelling and item response theory analyses. <em>Journal of Statistical Software, 17</em>, 1&ndash;25. doi: <a href="https://doi.org/10.18637/jss.v017.i05">10.18637/jss.v017.i05</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+itemParEst">itemParEst</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Creating four groups according to gender ("Man" or "Woman") and trait
 # anger score ("Low" or "High")
 group &lt;- rep("WomanLow",nrow(verbal))
 group[Anger&gt;20 &amp; Gender==0] &lt;- "WomanHigh"
 group[Anger&lt;=20 &amp; Gender==1] &lt;- "ManLow"
 group[Anger&gt;20 &amp; Gender==1] &lt;- "ManHigh"

 # New data set
 Verbal &lt;- cbind(verbal[,1:24], group)

 # Reference group: "WomanLow"
 names &lt;- c("WomanHigh", "ManLow", "ManHigh")

 # Three equivalent settings of the data matrix and the group membership
 # 1PL model, "ltm" engine 
 r &lt;- difGenLord(Verbal, group = 25, focal.names = names, model = "1PL")
 difGenLord(Verbal, group = "group", focal.name = names, model = "1PL")
 difGenLord(Verbal[,1:24], group = Verbal[,25], focal.names = names, model = "1PL")

 # 1PL model, "ltm" engine, estimated common discrimination 
 r &lt;- difGenLord(Verbal, group = 25, focal.names = names, model = "1PL", discr = NULL)

 # 1PL model, "lme4" engine 
 difGenLord(Verbal, group = "group", focal.name = names, model = "1PL", engine = "lme4")

 # With items 1 to 5 set as anchor items
 difGenLord(Verbal, group = 25, focal.names = names, model = "1PL", anchor = 1:5)

 # Multiple comparisons adjustment using Benjamini-Hochberg method
 difGenLord(Verbal, group = 25, focal.names = names, model = "1PL", p.adjust.method = "BH")

 # With item purification
 difGenLord(Verbal, group = 25, focal.names = names, model = "1PL", purify = TRUE)

 # Saving the output into the "GLresults.txt" file (and default path)
 r &lt;- difGenLord(Verbal, group = 25, focal.names = names, model = "1PL", 
         save.output = TRUE, output = c("GLresults", "default"))

 # Splitting the data into the four subsets according to "group"
 data0&lt;-data1&lt;-data2&lt;-data3&lt;-NULL
 for (i in 1:nrow(verbal)){
  if (group[i]=="WomanLow") data0&lt;-rbind(data0,as.numeric(verbal[i,1:24]))
  if (group[i]=="WomanHigh") data1&lt;-rbind(data1,as.numeric(verbal[i,1:24]))
  if (group[i]=="ManLow") data2&lt;-rbind(data2,as.numeric(verbal[i,1:24]))
  if (group[i]=="ManHigh") data3&lt;-rbind(data3,as.numeric(verbal[i,1:24]))
  }

 # Estimation of the item parameters (1PL model)
 m0.1PL&lt;-itemParEst(data0, model = "1PL")
 m1.1PL&lt;-itemParEst(data1, model = "1PL")
 m2.1PL&lt;-itemParEst(data2, model = "1PL")
 m3.1PL&lt;-itemParEst(data3, model = "1PL")

 # Merging the item parameters WITHOUT rescaling
 irt.noscale&lt;-rbind(m0.1PL,m1.1PL,m2.1PL,m3.1PL)
 rownames(irt.noscale)&lt;-rep(colnames(verbal[,1:24]),4)

 # Merging the item parameters WITH rescaling
 irt.scale&lt;-rbind(m0.1PL, itemRescale(m0.1PL,m1.1PL),
 itemRescale(m0.1PL,m2.1PL) ,itemRescale(m0.1PL,m3.1PL))
 rownames(irt.scale)&lt;-rep(colnames(verbal[,1:24]),4)

 # Equivalent calculations
 difGenLord(irtParam = irt.noscale, nrFocal = 3, same.scale = FALSE)
 difGenLord(irtParam = irt.scale, nrFocal = 3, same.scale = TRUE)

 # With item purification
 difGenLord(irtParam = irt.noscale, nrFocal = 3, same.scale = FALSE, purify = TRUE)

 # Graphical devices
 plot(r)
 plot(r, plot = "itemCurve", item = 1)
 plot(r, plot = "itemCurve", item = 6)
 plot(r, plot = "itemCurve", item = 6, ref.name = "WomanHigh")

 # Plotting results and saving it in a PDF figure
 plot(r, save.plot = TRUE, save.options = c("plot", "default", "pdf"))

 # Changing the path, JPEG figure
 path &lt;- "c:/Program Files/"
 plot(r, save.plot = TRUE, save.options = c("plot", path, "jpeg"))

## End(Not run)
 </code></pre>

<hr>
<h2 id='difGMH'>Generalized Mantel-Haenszel DIF method</h2><span id='topic+difGMH'></span><span id='topic+print.GMH'></span><span id='topic+plot.GMH'></span>

<h3>Description</h3>

<p>Performs DIF detection among multiple groups using the generalized Mantel-Haenszel method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>difGMH(Data, group, focal.names, anchor = NULL, match = "score", alpha = 0.05, 
  	purify = FALSE, nrIter = 10, p.adjust.method = NULL, save.output = FALSE, 
  	output = c("out", "default"))
## S3 method for class 'GMH'
print(x, ...)
## S3 method for class 'GMH'
plot(x, pch = 8, number = TRUE, col = "red", save.plot = FALSE, 
  	save.options = c("plot", "default", "pdf"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="difGMH_+3A_data">Data</code></td>
<td>
<p>numeric: either the data matrix only, or the data matrix plus the vector of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGMH_+3A_group">group</code></td>
<td>
<p>numeric or character: either the vector of group membership or the column indicator (within <code>Data</code>) of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGMH_+3A_focal.names">focal.names</code></td>
<td>
<p>numeric or character vector indicating the levels of <code>group</code> which correspond to the focal groups.</p>
</td></tr>
<tr><td><code id="difGMH_+3A_anchor">anchor</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of item names (or identifiers) to specify the anchor items. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGMH_+3A_match">match</code></td>
<td>
<p>specifies the type of matching criterion. Can be either <code>"score"</code> (default) to compute the test score, or any continuous or discrete variable with the same length as the number of rows of <code>Data</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGMH_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="difGMH_+3A_purify">purify</code></td>
<td>
<p>logical: should the method be used iteratively to purify the set of anchor items? (default is FALSE).</p>
</td></tr>
<tr><td><code id="difGMH_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item purification process (default is 10).</p>
</td></tr>
<tr><td><code id="difGMH_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>either <code>NULL</code> (default) or the acronym of the method for p-value adjustment for multiple comparisons. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGMH_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved into a text file? (Default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difGMH_+3A_output">output</code></td>
<td>
<p>character: a vector of two components. The first component is the name of the output file, the second component is either the file path or 
<code>"default"</code> (default value). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGMH_+3A_x">x</code></td>
<td>
<p>the result from a <code>GMH</code> class object.</p>
</td></tr>
<tr><td><code id="difGMH_+3A_pch">pch</code>, <code id="difGMH_+3A_col">col</code></td>
<td>
<p>type of usual <code>pch</code> and <code>col</code> graphical options.</p>
</td></tr>
<tr><td><code id="difGMH_+3A_number">number</code></td>
<td>
<p>logical: should the item number identification be printed (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="difGMH_+3A_save.plot">save.plot</code></td>
<td>
<p>logical: should the plot be saved into a separate file? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difGMH_+3A_save.options">save.options</code></td>
<td>
<p>character: a vector of three components. The first component is the name of the output file, the second component is either the file path or
<code>"default"</code> (default value), and the third component is the file extension, either <code>"pdf"</code> (default) or <code>"jpeg"</code>. See
<b>Details</b>.</p>
</td></tr>
<tr><td><code id="difGMH_+3A_...">...</code></td>
<td>
<p>other generic parameters for the <code>plot</code> or the <code>print</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generalized Mantel-Haenszel statistic (Somes, 1986) can be used to detect uniform differential item functioning among multiple groups,
without requiring an item response model approach (Penfield, 2001).
</p>
<p>The <code>Data</code> is a matrix whose rows correspond to the subjects and columns to the items. In addition, <code>Data</code> can hold the vector of group membership.
If so, <code>group</code> indicates the column of <code>Data</code> which corresponds to the group membership, either by specifying its name or by giving the column number.
Otherwise, <code>group</code> must be a vector of same length as <code>nrow(Data)</code>.
</p>
<p>Missing values are allowed for item responses (not for group membership) but must be coded as <code>NA</code> values. They are discarded from sum-score computation.
</p>
<p>The vector of group membership must hold at least three value, either as numeric or character. The focal groups are defined by the values of the argument
<code>focal.names</code>. If there is a unique focal group, then <code>difGMH</code> returns the output of <code><a href="#topic+difMH">difMH</a></code> (<b>without</b> continuity correction).
</p>
<p>The threshold (or cut-score) for classifying items as DIF is computed as the quantile of the chi-squared distribution with lower-tail
probability of one minus <code>alpha</code> and with as many degrees of freedom as the number of focal groups.
</p>
<p>The matching criterion can be either the test score or any other continuous or discrete variable to be passed in the <code><a href="#topic+genMantelHaenszel">genMantelHaenszel</a></code> function. This is specified by the <code>match</code> argument. By default, it takes the value <code>"score"</code> and the test score (i.e. raw score) is computed. The second option is to assign to <code>match</code> a vector of continuous or discrete numeric values, which acts as the matching criterion. Note that for consistency this vector should not belong to the <code>Data</code> matrix.
</p>
<p>Item purification can be performed by setting <code>purify</code> to <code>TRUE</code>. Purification works as follows: if at least one item detected as functioning 
differently at the first step of the process, then the data set of the next step consists in all items that are currently anchor (DIF free) items, plus the 
tested item (if necessary). The process stops when either two successive applications of the method yield the same classifications of the items (Clauser and Mazor,
1998), or when <code>nrIter</code> iterations are run without obtaining two successive identical classifications. In the latter case a warning message is printed. 
</p>
<p>Adjustment for multiple comparisons is possible with the argument <code>p.adjust.method</code>. The latter must be an acronym of one of the available adjustment methods of the <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function. According to Kim and Oshima (2013), Holm and Benjamini-Hochberg adjustments (set respectively by <code>"Holm"</code> and <code>"BH"</code>) perform best for DIF purposes. See <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function for further details. Note that item purification is performed on original statistics and p-values; in case of adjustment for multiple comparisons this is performed <em>after</em> item purification.
</p>
<p>A pre-specified set of anchor items can be provided through the <code>anchor</code> argument. It must be a vector of either item names (which must match exactly the column names of <code>Data</code> argument) or integer values (specifying the column numbers for item identification). In case anchor items are provided, they are used to compute the test score (matching criterion), including also the tested item. None of the anchor items are tested for DIF: the output separates anchor items and tested items and DIF results are returned only for the latter. Note also that item purification is not activated when anchor items are provided (even if <code>purify</code> is set to <code>TRUE</code>). By default it is <code>NULL</code> so that no anchor item is specified.
</p>
<p>The output of the <code>difGMH</code>, as displayed by the <code>print.GMH</code> function, can be stored in a text file provided that <code>save.output</code> is set to <code>TRUE</code> 
(the default value <code>FALSE</code> does not execute the storage). In this case, the name of the text file must be given as a character string into the first component
of the <code>output</code> argument (default name is <code>"out"</code>), and the path for saving the text file can be given through the second component of <code>output</code>. The
default value is <code>"default"</code>, meaning that the file will be saved in the current working directory. Any other path can be specified as a character string: see
the <b>Examples</b> section for an illustration.
</p>
<p>The <code>plot.GMH</code> function displays the DIF statistics in a plot, with each item on the X axis. The type of point and the colour are fixed by the usual <code>pch</code>
and <code>col</code> arguments. Option <code>number</code> permits to display the item numbers instead. Also, the plot can be stored in a figure file, either in PDF or JPEG
format. Fixing <code>save.plot</code> to <code>TRUE</code> allows this process. The figure is defined through the components of <code>save.options</code>. The first two components
perform similarly as those of the <code>output</code> argument. The third component is the figure format, with allowed values <code>"pdf"</code> (default) for PDF file and
<code>"jpeg"</code> for JPEG file.
</p>


<h3>Value</h3>

<p>A list of class &quot;GMH&quot; with the following arguments:
</p>
<table role = "presentation">
<tr><td><code>GMH</code></td>
<td>
<p>the values of the generalized Mantel-Haenszel statistics.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the vector of p-values for the generalized Mantel-Haenszel statistics.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the value of <code>alpha</code> argument.</p>
</td></tr>
<tr><td><code>thr</code></td>
<td>
<p>the threshold (cut-score) for DIF detection.</p>
</td></tr>
<tr><td><code>DIFitems</code></td>
<td>
<p>either the items which were detected as DIF items, or &quot;No DIF item detected&quot;.</p>
</td></tr>
<tr><td><code>match</code></td>
<td>
<p>a character string, either <code>"score"</code> or <code>"matching variable"</code> depending on the <code>match</code> argument.</p>
</td></tr>
<tr><td><code>p.adjust.method</code></td>
<td>
<p>the value of the <code>p.adjust.method</code> argument.</p>
</td></tr>
<tr><td><code>adjusted.p</code></td>
<td>
<p>either <code>NULL</code> or the vector of adjusted p-values for multiple comparisons.</p>
</td></tr>
<tr><td><code>purification</code></td>
<td>
<p>the value of <code>purify</code> option.</p>
</td></tr> 
<tr><td><code>nrPur</code></td>
<td>
<p>the number of iterations in the item purification process. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>difPur</code></td>
<td>
<p>a binary matrix with one row per iteration in the item purification process and one column per item. Zeros and ones in the <em>i</em>-th 
row refer to items which were classified respectively as non-DIF and DIF items at the (<em>i</em>-1)-th step. The first row corresponds to the initial
classification of the items. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>logical indicating whether the iterative item purification process stopped before the maximal number <code>nrIter</code> of allowed iterations. 
Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>the names of the items.</p>
</td></tr>
<tr><td><code>anchor.names</code></td>
<td>
<p>the value of the <code>anchor</code> argument.</p>
</td></tr>
<tr><td><code>focal.names</code></td>
<td>
<p>the value of <code>focal.names</code> argument.</p>
</td></tr>
<tr><td><code>save.output</code></td>
<td>
<p>the value of the <code>save.output</code> argument.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>the value of the <code>output</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Clauser, B. E. and Mazor, K. M. (1998). Using statistical procedures to identify differential item functioning test items. <em>Educational Measurement: Issues and Practice, 17</em>, 31-44.
</p>
<p>Kim, J., and Oshima, T. C. (2013). Effect of multiple testing adjustment in differential item functioning detection. <em>Educational and Psychological Measurement, 73</em>, 458&ndash;470. doi: <a href="https://doi.org/10.1177/0013164412467033">10.1177/0013164412467033</a>
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Penfield, R. D. (2001). Assessing differential item functioning among multiple groups: a comparison of three Mantel-Haenszel procedures. <em>Applied Measurement in Education, 14</em>, 235-259. doi: <a href="https://doi.org/10.1207/S15324818AME1403_3">10.1207/S15324818AME1403_3</a>
</p>
<p>Somes, G. W. (1986). The generalized Mantel-Haenszel statistic. <em>The American Statistician, 40</em>, 106-108. doi: <a href="https://doi.org/10.2307/2684866">10.2307/2684866</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difGMH">difGMH</a></code>, <code><a href="#topic+difMH">difMH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Creating four groups according to gender ("Man" or "Woman") and
 # trait anger score ("Low" or "High")
 group &lt;- rep("WomanLow",nrow(verbal))
 group[Anger&gt;20 &amp; Gender==0] &lt;- "WomanHigh"
 group[Anger&lt;=20 &amp; Gender==1] &lt;- "ManLow"
 group[Anger&gt;20 &amp; Gender==1] &lt;- "ManHigh"

 # New data set
 Verbal &lt;- cbind(verbal[,1:24], group)

 # Reference group: "WomanLow"
 names &lt;- c("WomanHigh", "ManLow", "ManHigh")

 # Three equivalent settings of the data matrix and the group membership
 difGMH(Verbal, group = 25, focal.names = names)
 difGMH(Verbal, group = "group", focal.name = names)
 difGMH(Verbal[,1:24], group = Verbal[,25], focal.names = names)

 # Multiple comparisons adjustment using Benjamini-Hochberg method
 difGMH(Verbal, group = 25, focal.names = names, p.adjust.method = "BH")

 # With item purification 
 difGMH(Verbal, group = 25, focal.names = names, purify = TRUE)
 difGMH(Verbal, group = 25, focal.names = names, purify = TRUE, nrIter = 5)

 # With items 1 to 5 set as anchor items
 difMH(Verbal, group = 25, focal.name = names, anchor = 1:5)
 difMH(Verbal, group = 25, focal.name = names, anchor = 1:5, purify = TRUE)


 # Saving the output into the "GMHresults.txt" file (and default path)
 r &lt;- difGMH(Verbal, group = 25, focal.name = names, save.output = TRUE, 
            output = c("GMHresults","default"))

 # Graphical devices
 plot(r)

 # Plotting results and saving it in a PDF figure
 plot(r, save.plot = TRUE, save.options = c("plot", "default", "pdf"))

 # Changing the path, JPEG figure
 path &lt;- "c:/Program Files/"
 plot(r, save.plot = TRUE, save.options = c("plot", path, "jpeg"))

## End(Not run)
</code></pre>

<hr>
<h2 id='difLogistic'>Logistic regression DIF method</h2><span id='topic+difLogistic'></span><span id='topic+print.Logistic'></span><span id='topic+plot.Logistic'></span>

<h3>Description</h3>

<p>Performs DIF detection using logistic regression method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>difLogistic(Data, group, focal.name, anchor = NULL, member.type = "group", 
 	match = "score", type = "both", criterion = "LRT", alpha = 0.05, 
 	all.cov = FALSE, purify = FALSE, nrIter = 10, p.adjust.method = NULL, 
 	save.output = FALSE, output = c("out", "default"))
## S3 method for class 'Logistic'
print(x, ...)
## S3 method for class 'Logistic'
plot(x, plot="lrStat", item = 1, itemFit = "best", pch = 8, number = TRUE,
 	col = "red", colIC = rep("black", 2), ltyIC = c(1, 2), save.plot = FALSE,
 	save.options = c("plot", "default", "pdf"), group.names = NULL, ...)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="difLogistic_+3A_data">Data</code></td>
<td>
<p>numeric: either the data matrix only, or the data matrix plus the vector of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_group">group</code></td>
<td>
<p>numeric or character: either the vector of group membership or the column indicator (within <code>data</code>) of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_focal.name">focal.name</code></td>
<td>
<p>numeric or character indicating the level of <code>group</code> which corresponds to the focal group. Ignored if <code>member.type</code> is not <code>"group"</code>.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_anchor">anchor</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of item names (or identifiers) to specify the anchor items. Ignored if <code>match</code> is not <code>"score"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_member.type">member.type</code></td>
<td>
<p>character: either <code>"group"</code> (default) to specify that group membership is made of two groups, or <code>"cont"</code> to indicate that group membership is based on a  continuous criterion. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_match">match</code></td>
<td>
<p>specifies the type of matching criterion. Can be either <code>"score"</code> (default) to compute the test score, or any continuous or discrete variable with the same length as the number of rows of <code>Data</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_type">type</code></td>
<td>
<p>a character string specifying which DIF effects must be tested. Possible values are <code>"both"</code> (default), <code>"udif"</code> and <code>"nudif"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_criterion">criterion</code></td>
<td>
<p>a character string specifying which DIF statistic is computed. Possible values are <code>"LRT"</code> (default) or <code>"Wald"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_all.cov">all.cov</code></td>
<td>
<p>logical: should <em>all</em> covariance matrices of model parameter estimates be returned (as lists) for both nested models and all items? (default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_purify">purify</code></td>
<td>
<p>logical: should the method be used iteratively to purify the set of anchor items? (default is FALSE). Ignored if <code>match</code> is not <code>"score"</code>.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item purification process. (default is 10).</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>either <code>NULL</code> (default) or the acronym of the method for p-value adjustment for multiple comparisons. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved into a text file? (Default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_output">output</code></td>
<td>
<p>character: a vector of two components. The first component is the name of the output file, the second component is either the file path or 
<code>"default"</code> (default value). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_x">x</code></td>
<td>
<p>the result from a <code>Logistik</code> class object.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_plot">plot</code></td>
<td>
<p>character: the type of plot, either <code>"lrStat"</code> (default) or <code>"itemCurve"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_item">item</code></td>
<td>
<p>numeric or character: either the number or the name of the item for which logistic curves are plotted. Used only when <code>plot="itemCurve"</code>.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_itemfit">itemFit</code></td>
<td>
<p>character: the model to be selected for drawing the item curves. Possible values are <code>"best"</code> (default) for drawing from the best of the two
models, and <code>"null"</code> for using fitted parameters of the null model <code class="reqn">M_0</code>. Not used if <code>"plot"</code> is <code>"lrStat"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_pch">pch</code>, <code id="difLogistic_+3A_col">col</code></td>
<td>
<p>type of usual <code>pch</code> and <code>col</code> graphical options.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_number">number</code></td>
<td>
<p>logical: should the item number identification be printed (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_colic">colIC</code>, <code id="difLogistic_+3A_ltyic">ltyIC</code></td>
<td>
<p>vectors of two elements of the usual <code>col</code> and <code>lty</code> arguments for logistic curves. Used only when <code>plot="itemCurve"</code>.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_save.plot">save.plot</code></td>
<td>
<p>logical: should the plot be saved into a separate file? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_save.options">save.options</code></td>
<td>
<p>character: a vector of three components. The first component is the name of the output file, the second component is either the file path or 
<code>"default"</code> (default value), and the third component is the file extension, either <code>"pdf"</code> (default) or <code>"jpeg"</code>. See 
<b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_group.names">group.names</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of two character strings giving the names of the reference group and the focal group (in this order)
for display in the legend. Ignored if <code>plot</code> is <code>"lrStat"</code>.</p>
</td></tr>
<tr><td><code id="difLogistic_+3A_...">...</code></td>
<td>
<p>other generic parameters for the <code>plot</code> or the <code>print</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The logistic regression method (Swaminathan and Rogers, 1990) allows for detecting both uniform and non-uniform differential item functioning 
without requiring an item response model approach. It consists in fitting a logistic model with the matching criterion,
the group membership and an interaction between both as covariates. The statistical significance of the parameters
related to group membership and the group-score interaction is then evaluated by means of either the likelihood-ratio
test or the Wald test. The argument <code>type</code> permits to test either both uniform and nonuniform effects simultaneously (<code>type="both"</code>), only uniform
DIF effect (<code>type="udif"</code>) or only nonuniform DIF effect (<code>type="nudif"</code>). The argument <code>criterion</code> permits to select either
the likelihood ratio test (<code>criterion=="LRT"</code>) or the Wald test (<code>criterion=="Wald"</code>). See <code><a href="#topic+Logistik">Logistik</a></code> for further details.
</p>
<p>The group membership can be either a vector of two distinct values, one for the reference group and one for the focal group, or a continuous or discrete variable that acts as the &quot;group&quot; membership variable. In the former case, the <code>member.type</code> argument is set to <code>"group"</code> and the <code>focal.name</code> defines which value in the <code>group</code> variable stands for the focal group. In the latter case, <code>member.type</code> is set to <code>"cont"</code>, <code>focal.name</code> is ignored and each value of the <code>group</code> represents one &quot;group&quot; of data (that is, the DIF effects are investigated among participants relying on different values of some discrete or continuous trait). See <code><a href="#topic+Logistik">Logistik</a></code> for further details.
</p>
<p>The matching criterion can be either the test score or any other continuous or discrete variable to be passed in the <code><a href="#topic+Logistik">Logistik</a></code> function. This is specified by the <code>match</code> argument. By default, it takes the value <code>"score"</code> and the test score (i.e. raw score) is computed. The second option is to assign to <code>match</code> a vector of continuous or discrete numeric values, which acts as the matching criterion. Note that for consistency this vector should not belong to the <code>Data</code> matrix.
</p>
<p>The <code>Data</code> is a matrix whose rows correspond to the subjects and columns to the items. In addition, <code>Data</code> can hold the vector of group membership.
If so, <code>group</code> indicates the column of <code>Data</code> which corresponds to the group membership, either by specifying its name or by giving the column number.
Otherwise, <code>group</code> must be a vector of same length as <code>nrow(Data)</code>.
</p>
<p>Missing values are allowed for item responses (not for group membership) but must be coded as <code>NA</code> values. They are discarded from the fitting of the
logistic models (see <code><a href="stats.html#topic+glm">glm</a></code> for further details).
</p>
<p>The threshold (or cut-score) for classifying items as DIF is computed as the quantile of the chi-squared distribution with lower-tail
probability of one minus <code>alpha</code> and with one (if <code>type="udif"</code> or <code>type="nudif"</code>) or two (if <code>type="both"</code>) degrees of freedom.
</p>
<p>Item purification can be performed by setting <code>purify</code> to <code>TRUE</code>. Purification works as follows: if at least one item is detected as functioning 
differently at the first step of the process, then the data set of the next step consists in all items that are currently anchor (DIF free) items, plus the 
tested item (if necessary). The process stops when either two successive applications of the method yield the same classifications of the items
(Clauser and Mazor, 1998), or when <code>nrIter</code> iterations are run without obtaining two successive identical classifications. In the latter case
a warning message is printed. Note that purification is possible only if the test score is considered as the matching criterion. Thus, <code>purify</code> is ignored when <code>match</code> is not <code>"score"</code>.
</p>
<p>Adjustment for multiple comparisons is possible with the argument <code>p.adjust.method</code>. The latter must be an acronym of one of the available adjustment methods of the <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function. According to Kim and Oshima (2013), Holm and Benjamini-Hochberg adjustments (set respectively by <code>"Holm"</code> and <code>"BH"</code>) perform best for DIF purposes. See <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function for further details. Note that item purification is performed on original statistics and p-values; in case of adjustment for multiple comparisons this is performed <em>after</em> item purification.
</p>
<p>A pre-specified set of anchor items can be provided through the <code>anchor</code> argument. It must be a vector of either item names (which must match exactly the column names of <code>Data</code> argument) or integer values (specifying the column numbers for item identification). In case anchor items are provided, they are used to compute the test score (matching criterion), including also the tested item. None of the anchor items are tested for DIF: the output separates anchor items and tested items and DIF results are returned only for the latter. By default it is <code>NULL</code> so that no anchor item is specified. Note also that item purification is not activated when anchor items are provided (even if <code>purify</code> is set to <code>TRUE</code>). Moreover, if the <code>match</code> argument is not set to <code>"score"</code>, anchor items will not be taken into account even if <code>anchor</code> is not <code>NULL</code>. 
</p>
<p>The measures of effect size are provided by the difference <code class="reqn">\Delta R^2</code> between the <code class="reqn">R^2</code> coefficients of the two nested models (Nagelkerke, 1991; 
Gomez-Benito, Dolores Hidalgo and Padilla, 2009). The effect sizes are classified as &quot;negligible&quot;, &quot;moderate&quot; or &quot;large&quot;. Two scales are available, one from
Zumbo and Thomas (1997) and one from Jodoin and Gierl (2001). The output displays the <code class="reqn">\Delta R^2</code> measures, together with the two classifications.
</p>
<p>The output of the <code>difLogistic</code>, as displayed by the <code>print.Logistic</code> function, can be stored in a text file provided that <code>save.output</code> is set to
<code>TRUE</code> (the default value <code>FALSE</code> does not execute the storage). In this case, the name of the text file must be given as a character string into the
first component of the <code>output</code> argument (default name is <code>"out"</code>), and the path for saving the text file can be given through the second component of
<code>output</code>. The default value is <code>"default"</code>, meaning that the file will be saved in the current working directory. Any other path can be specified as a
character string: see the <b>Examples</b> section for an illustration.
</p>
<p>Two types of plots are available. The first one is obtained by setting <code>plot="lrStat"</code> and it is the default option. The likelihood ratio statistics are
displayed on the Y axis, for each item. The detection threshold is displayed by a horizontal line, and items flagged as DIF are printed with the color defined by
argument <code>col</code>. By default, items are spotted with their number identification (<code>number=TRUE</code>); otherwise they are simply drawn as dots whose form is
given by the option <code>pch</code>.
</p>
<p>The other type of plot is obtained by setting <code>plot="itemCurve"</code>. In this case, the fitted logistic curves are displayed for one specific item set by the
argument <code>item</code>. The latter argument can hold either the name of the item or its number identification. If the argument <code>itemFit</code> takes the value
<code>"best"</code>, the curves are drawn according to the output of the best model among <code class="reqn">M_0</code> and <code class="reqn">M_1</code>. That is, two curves are drawn if the item is flagged
as DIF, and only one if the item is flagged as non-DIF. If <code>itemFit</code> takes the value <code>"null"</code>, then the two curves are drawn from the fitted parameters
of the null model <code class="reqn">M_0</code>. See <code><a href="#topic+Logistik">Logistik</a></code> for further details on the models. The colors and types of traits for these curves are defined by means of
the arguments <code>colIC</code> and <code>ltyIC</code> respectively. These are set as vectors of length 2, the first element for the reference group and the second for the
focal group. Finally, the argument <code>group.names</code> permits to display the names of the reference and focal groups (instead of &quot;Reference&quot; and &quot;Focal&quot;) in the
legend.
</p>
<p>Both types of plots can be stored in a figure file, either in PDF or JPEG format. Fixing <code>save.plot</code> to <code>TRUE</code> allows this process. The figure is defined
through the components of <code>save.options</code>. The first two components perform similarly as those of the <code>output</code> argument. The third component is the figure
format, with allowed values <code>"pdf"</code> (default) for PDF file and <code>"jpeg"</code> for JPEG file.
</p>


<h3>Value</h3>

<p>A list of class &quot;Logistic&quot; with the following arguments:
</p>
<table role = "presentation">
<tr><td><code>Logistik</code></td>
<td>
<p>the values of the logistic regression statistics.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the vector of p-values for the logistic regression statistics.</p>
</td></tr>
<tr><td><code>logitPar</code></td>
<td>
<p>a matrix with one row per item and four columns, holding the fitted parameters of the best model (among the two tested models) for each item.</p>
</td></tr>
<tr><td><code>logitSe</code></td>
<td>
<p>a matrix with one row per item and four columns, holding the standard errors of the fitted parameters of the best model (among the two tested models) for each item.</p>
</td></tr>
<tr><td><code>parM0</code></td>
<td>
<p>the matrix of fitted parameters of the null model <code class="reqn">M_0</code>, as returned by the <code><a href="#topic+Logistik">Logistik</a></code> command.</p>
</td></tr>
<tr><td><code>seM0</code></td>
<td>
<p>the matrix of standard error of fitted parameters of the null model <code class="reqn">M_0</code>, as returned by the <code><a href="#topic+Logistik">Logistik</a></code> command.</p>
</td></tr>
<tr><td><code>cov.M0</code></td>
<td>
<p>either <code>NULL</code> (if <code>all.cov</code> argument is <code>FALSE</code>) or a list of covariance matrices of parameter estimates of the &quot;full&quot; model (<code class="reqn">M_0</code>) for each item (if <code>all.cov</code> argument is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code>cov.M1</code></td>
<td>
<p>either <code>NULL</code> (if <code>all.cov</code> argument is <code>FALSE</code>) or a list of covariance matrices of parameter estimates of the &quot;reduced&quot; model (<code class="reqn">M_1</code>) for each item (if <code>all.cov</code> argument is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code>deltaR2</code></td>
<td>
<p>the differences in Nagelkerke's <code class="reqn">R^2</code> coefficients. See <b>Details</b>.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the value of <code>alpha</code> argument.</p>
</td></tr>
<tr><td><code>thr</code></td>
<td>
<p>the threshold (cut-score) for DIF detection.</p>
</td></tr>
<tr><td><code>DIFitems</code></td>
<td>
<p>either the column indicators for the items which were detected as DIF items, or &quot;No DIF item detected&quot;.</p>
</td></tr>
<tr><td><code>member.type</code></td>
<td>
<p>the value of the <code>member.type</code> argument.</p>
</td></tr>
<tr><td><code>match</code></td>
<td>
<p>a character string, either <code>"score"</code> or <code>"matching variable"</code> depending on the <code>match</code> argument.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>the value of <code>type</code> argument.</p>
</td></tr>
<tr><td><code>p.adjust.method</code></td>
<td>
<p>the value of the <code>p.adjust.method</code> argument.</p>
</td></tr>
<tr><td><code>adjusted.p</code></td>
<td>
<p>either <code>NULL</code> or the vector of adjusted p-values for multiple comparisons.</p>
</td></tr>
<tr><td><code>purification</code></td>
<td>
<p>the value of <code>purify</code> option.</p>
</td></tr> 
<tr><td><code>nrPur</code></td>
<td>
<p>the number of iterations in the item purification process. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>difPur</code></td>
<td>
<p>a binary matrix with one row per iteration in the item purification process and one column per item. Zeros and ones in the <em>i</em>-th 
row refer to items which were classified respectively as non-DIF and DIF items at the (<em>i</em>-1)-th step. The first row corresponds to the initial
classification of the items. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>logical indicating whether the iterative item purification process stopped before the maximal number of <code>nrItem</code> allowed iterations. 
Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>the names of the items.</p>
</td></tr>
<tr><td><code>anchor.names</code></td>
<td>
<p>the value of the <code>anchor</code> argument.</p>
</td></tr>
<tr><td><code>criterion</code></td>
<td>
<p>the value of the <code>criterion</code> argument.</p>
</td></tr>
<tr><td><code>save.output</code></td>
<td>
<p>the value of the <code>save.output</code> argument.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>the value of the <code>output</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Clauser, B.E. and Mazor, K.M. (1998). Using statistical procedures to identify differential item functioning test items. <em>Educational Measurement: Issues 
and Practice, 17</em>, 31-44. 
</p>
<p>Finch, W.H. and French, B. (2007). Detection of crossing differential item functioning: a comparison of four methods. <em>Educational and Psychological
Measurement, 67</em>, 565-582. doi: <a href="https://doi.org/10.1177/0013164406296975">10.1177/0013164406296975</a>
</p>
<p>Gomez-Benito, J., Dolores Hidalgo, M. and Padilla, J.-L. (2009). Efficacy of effect size measures in logistic regression: an application for detecting DIF. 
<em>Methodology, 5</em>, 18-25. doi: <a href="https://doi.org/10.1027/1614-2241.5.1.18">10.1027/1614-2241.5.1.18</a>
</p>
<p>Hidalgo, M. D. and Lopez-Pina, J.A. (2004). Differential item functioning detection and effect size: a comparison between logistic regression and Mantel-Haenszel
procedures. <em>Educational and Psychological Measurement, 64</em>, 903-915.  doi: <a href="https://doi.org/10.1177/0013164403261769">10.1177/0013164403261769</a>
</p>
<p>Jodoin, M. G. and Gierl, M. J. (2001). Evaluating Type I error and power rates using an effect size measure with logistic regression procedure for DIF detection. <em>Applied Measurement in Education, 14</em>, 329-349. doi: <a href="https://doi.org/10.1207/S15324818AME1404_2">10.1207/S15324818AME1404_2</a>
</p>
<p>Kim, J., and Oshima, T. C. (2013). Effect of multiple testing adjustment in differential item functioning detection. <em>Educational and Psychological Measurement, 73</em>, 458&ndash;470. doi: <a href="https://doi.org/10.1177/0013164412467033">10.1177/0013164412467033</a>
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Nagelkerke, N. J. D. (1991). A note on a general definition of the coefficient of determination. <em>Biometrika, 78</em>, 691-692. doi: <a href="https://doi.org/10.1093/biomet/78.3.691">10.1093/biomet/78.3.691</a>
</p>
<p>Swaminathan, H. and Rogers, H. J. (1990). Detecting differential item functioning using logistic regression procedures. <em>Journal of Educational 
Measurement, 27</em>, 361-370. doi: <a href="https://doi.org/10.1111/j.1745-3984.1990.tb00754.x">10.1111/j.1745-3984.1990.tb00754.x</a>
</p>
<p>Zumbo, B.D. (1999). <em>A handbook on the theory and methods of differential item functioning (DIF): logistic regression modelling as a unitary framework for binary and Likert-type (ordinal) item scores</em>. Ottawa, ON: Directorate of Human Resources Research and Evaluation, Department of National Defense. 
</p>
<p>Zumbo, B. D. and Thomas, D. R. (1997). <em>A measure of effect size for a model-based approach for studying DIF</em>. Prince George, Canada: University of Northern British
Columbia, Edgeworth Laboratory for Quantitative Behavioral Science.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Logistik">Logistik</a></code>, <code><a href="#topic+dichoDif">dichoDif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)

 # Excluding the "Anger" variable
 anger &lt;- verbal[,colnames(verbal)=="Anger"]
 verbal &lt;- verbal[,colnames(verbal)!="Anger"]

 # Testing both DIF effects simultaneously
 # Three equivalent settings of the data matrix and the group membership
 r &lt;- difLogistic(verbal, group=25, focal.name = 1)
 difLogistic(verbal, group = "Gender", focal.name = 1)
 difLogistic(verbal[,1:24], group = verbal[,25], focal.name = 1)

 # Returning all covariance matrices of model parameters
 difLogistic(verbal, group=25, focal.name = 1, all.cov = TRUE)

 # Testing both DIF effects with the Wald test
 r2 &lt;- difLogistic(verbal, group = 25, focal.name = 1, criterion = "Wald")

 # Testing nonuniform DIF effect
 difLogistic(verbal, group = 25, focal.name = 1, type = "nudif")

 # Testing uniform DIF effect
 difLogistic(verbal, group = 25, focal.name = 1, type = "udif")

 # Multiple comparisons adjustment using Benjamini-Hochberg method
 difLogistic(verbal, group=25, focal.name = 1, p.adjust.method = "BH")

 # With item purification
 difLogistic(verbal, group = "Gender", focal.name = 1, purify = TRUE)
 difLogistic(verbal, group = "Gender", focal.name = 1, purify = TRUE, nrIter = 5)

 # With items 1 to 5 set as anchor items
 difLogistic(verbal, group = 25, focal.name = 1, anchor = 1:5)

 # Using anger trait score as the matching criterion
 difLogistic(verbal,group = 25, focal.name = 1,match = anger)

 # Using trait anger score as the group variable (i.e. testing
 # for DIF with respect to trait anger score)
 difLogistic(verbal[,1:24],group = anger,member.type = "cont")

 # Saving the output into the "Lresults.txt" file (and default path)
 r &lt;- difLogistic(verbal, group = 25, focal.name = 1, save.output = TRUE, 
           output = c("Lresults", "default"))

 # Graphical devices
 plot(r)
 plot(r2)
 plot(r, plot = "itemCurve", item = 1)
 plot(r, plot = "itemCurve", item = 1, itemFit = "null")
 plot(r, plot = "itemCurve", item = 6)
 plot(r, plot = "itemCurve", item = 6, itemFit = "null")

 # Plotting results and saving it in a PDF figure
 plot(r, save.plot = TRUE, save.options = c("plot", "default", "pdf"))

 # Changing the path, JPEG figure
 path &lt;- "c:/Program Files/"
 plot(r, save.plot = TRUE, save.options = c("plot", path, "jpeg"))

## End(Not run)
 </code></pre>

<hr>
<h2 id='difLogReg'>General logistic regression DIF method</h2><span id='topic+difLogReg'></span>

<h3>Description</h3>

<p>Performs DIF detection using logistic regression method with either two groups, more than two groups, or a continuous group variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>difLogReg(Data, group, focal.name, anchor = NULL, group.type = "group", 
 	match = "score", type = "both", criterion = "LRT", alpha = 0.05, 
 	purify = FALSE, nrIter = 10, p.adjust.method = NULL, save.output = FALSE, 
 	output = c("out", "default"))
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="difLogReg_+3A_data">Data</code></td>
<td>
<p>numeric: either the data matrix only, or the data matrix plus the vector of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogReg_+3A_group">group</code></td>
<td>
<p>numeric or character: either the vector of group membership or the column indicator (within <code>data</code>) of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogReg_+3A_focal.name">focal.name</code></td>
<td>
<p>numeric or character indicating the level(s) of <code>group</code> which corresponds to the focal group(s). Ignored if <code>group.type</code> is not <code>"group"</code>.</p>
</td></tr>
<tr><td><code id="difLogReg_+3A_anchor">anchor</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of item names (or identifiers) to specify the anchor items. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogReg_+3A_group.type">group.type</code></td>
<td>
<p>character: either <code>"group"</code> (default) to specify that group membership is made of two (or more than two) groups, or <code>"cont"</code> to indicate that group membership is based on a  continuous criterion. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogReg_+3A_match">match</code></td>
<td>
<p>specifies the type of matching criterion. Can be either <code>"score"</code> (default) to compute the test score, or any continuous or discrete variable with the same length as the number of rows of <code>Data</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogReg_+3A_type">type</code></td>
<td>
<p>a character string specifying which DIF effects must be tested. Possible values are <code>"both"</code> (default), <code>"udif"</code> and <code>"nudif"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogReg_+3A_criterion">criterion</code></td>
<td>
<p>a character string specifying which DIF statistic is computed. Possible values are <code>"LRT"</code> (default) or <code>"Wald"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogReg_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="difLogReg_+3A_purify">purify</code></td>
<td>
<p>logical: should the method be used iteratively to purify the set of anchor items? (default is FALSE). Ignored if <code>match</code> is not <code>"score"</code>.</p>
</td></tr>
<tr><td><code id="difLogReg_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item purification process. (default is 10).</p>
</td></tr>
<tr><td><code id="difLogReg_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>either <code>NULL</code> (default) or the acronym of the method for p-value adjustment for multiple comparisons. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLogReg_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved into a text file? (Default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difLogReg_+3A_output">output</code></td>
<td>
<p>character: a vector of two components. The first component is the name of the output file, the second component is either the file path or 
<code>"default"</code> (default value). See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>difLogReg</code> function is a meta-function for logistic regression DIF analysis. It encompasses all possible cases that are currently implemented in difR and makes appropriate calls to the function <code><a href="#topic+difLogistic">difLogistic</a></code> or <code><a href="#topic+difGenLogistic">difGenLogistic</a></code>. 
</p>
<p>Three situations are embedded in this function.
</p>

<ol>
<li><p> The group membership is defined by two distinct groups. In this case, <code>group.type</code> must be <code>"group"</code> and <code>focal.name</code> must be a single value, referring to the name or label of the focal group.
</p>
</li>
<li><p> The group membership is defined by a finite, yet larger than two, number of groups.  In this case, <code>group.type</code> must be <code>"group"</code> and <code>focal.name</code> must be a vector with the names or labels of all focal groups.
</p>
</li>
<li><p> The group membership is a continuous or discrete (but treated as continuous) variable. In this case, DIF is tested with respect to this &quot;membership&quot; variable. Furthermore, <code>group.type</code> must be <code>"cont"</code> and <code>focal.name</code> is ignored (though some value must be specified, for instance <code>NULL</code>). 
</p>
</li></ol>

<p>The specification of the data, the options for item purification, DIF statistic selection, and output saving, are identical to the options arising from the <code><a href="#topic+difLogistic">difLogistic</a></code> and <code><a href="#topic+difGenLogistic">difGenLogistic</a></code> functions. 
</p>


<h3>Value</h3>

<p>A list of class &quot;Logistic&quot; (if <code>group.type</code> is <code>"cont"</code> or with the length of <code>focal.name</code> is one) or &quot;genLogistic&quot;, with related arguments (see <code><a href="#topic+difLogistic">difLogistic</a></code> and <code><a href="#topic+difGenLogistic">difGenLogistic</a></code>). 
</p>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Swaminathan, H. and Rogers, H. J. (1990). Detecting differential item functioning using logistic regression procedures. <em>Journal of Educational 
Measurement, 27</em>, 361-370. doi: <a href="https://doi.org/10.1111/j.1745-3984.1990.tb00754.x">10.1111/j.1745-3984.1990.tb00754.x</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difLogistic">difLogistic</a></code>, <code><a href="#topic+difGenLogistic">difGenLogistic</a></code>, <code><a href="#topic+dichoDif">dichoDif</a></code>,  <code><a href="#topic+genDichoDif">genDichoDif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Few examples
 difLogReg(Data=verbal[,1:24], group=verbal[,26], focal.name=1)
 difLogReg(Data = verbal[,1:24], group = verbal[,26], focal.name = 1, match = verbal[,25])
 difLogReg(Data = verbal[,1:24], group = verbal[,25], focal.name = 1, group.type = "cont")

 group&lt;-rep("WomanLow",nrow(verbal))
 group[Anger&gt;20 &amp; Gender==0] &lt;- "WomanHigh"
 group[Anger&lt;=20 &amp; Gender==1] &lt;- "ManLow"
 group[Anger&gt;20 &amp; Gender==1] &lt;- "ManHigh"
 names &lt;- c("WomanHigh", "ManLow", "ManHigh")

 difLogReg(Data = verbal[,1:24], group = group, focal.name = names)
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='difLord'>Lord's chi-squared DIF method</h2><span id='topic+difLord'></span><span id='topic+plot.Lord'></span><span id='topic+print.Lord'></span>

<h3>Description</h3>

<p>Performs DIF detection using Lord's chi-squared method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>difLord(Data, group, focal.name, model, c = NULL, engine = "ltm", discr = 1,
 	irtParam = NULL, same.scale = TRUE, anchor = NULL, alpha = 0.05,
 	purify = FALSE, nrIter = 10, p.adjust.method = NULL, save.output = FALSE, 
 	output = c("out", "default"))  	
## S3 method for class 'Lord'
print(x, ...)
## S3 method for class 'Lord'
plot(x, plot = "lordStat", item = 1, pch = 8, number = TRUE, col = "red", 
  	colIC = rep("black", 2), ltyIC = c(1, 2), save.plot = FALSE, 
  	save.options = c("plot", "default", "pdf"), group.names = NULL, ...)  	
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="difLord_+3A_data">Data</code></td>
<td>
<p>numeric: either the data matrix only, or the data matrix plus the vector of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLord_+3A_group">group</code></td>
<td>
<p>numeric or character: either the vector of group membership or the column indicator (within <code>data</code>) of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLord_+3A_focal.name">focal.name</code></td>
<td>
<p>numeric or character indicating the level of <code>group</code> which corresponds to the focal group.</p>
</td></tr>
<tr><td><code id="difLord_+3A_model">model</code></td>
<td>
<p>character: the IRT model to be fitted (either <code>"1PL"</code>, <code>"2PL"</code> or <code>"3PL"</code>).</p>
</td></tr>
<tr><td><code id="difLord_+3A_c">c</code></td>
<td>
<p>optional numeric value or vector giving the values of the constrained pseudo-guessing parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLord_+3A_engine">engine</code></td>
<td>
<p>character: the engine for estimating the 1PL model, either <code>"ltm"</code> (default) or <code>"lme4"</code>.</p>
</td></tr>
<tr><td><code id="difLord_+3A_discr">discr</code></td>
<td>
<p>either <code>NULL</code> or a real positive value for the common discrimination parameter (default is 1). Used onlky if <code>model</code> is <code>"1PL"</code> and
<code>engine</code> is <code>"ltm"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLord_+3A_irtparam">irtParam</code></td>
<td>
<p>matrix with <em>2J</em> rows (where <em>J</em> is the number of items) and at most 9 columns containing item parameters estimates. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLord_+3A_same.scale">same.scale</code></td>
<td>
<p>logical: are the item parameters of the <code>irtParam</code> matrix on the same scale? (default is &quot;TRUE&quot;). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLord_+3A_anchor">anchor</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of item names (or identifiers) to specify the anchor items. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLord_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="difLord_+3A_purify">purify</code></td>
<td>
<p>logical: should the method be used iteratively to purify the set of anchor items? (default is FALSE).</p>
</td></tr>
<tr><td><code id="difLord_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item purification process (default is 10).</p>
</td></tr> 
<tr><td><code id="difLord_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>either <code>NULL</code> (default) or the acronym of the method for p-value adjustment for multiple comparisons. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLord_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved into a text file? (Default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difLord_+3A_output">output</code></td>
<td>
<p>character: a vector of two components. The first component is the name of the output file, the second component is either the file path or <code>"default"</code>
(default value). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLord_+3A_x">x</code></td>
<td>
<p>the result from a <code>Lord</code> class object.</p>
</td></tr>
<tr><td><code id="difLord_+3A_plot">plot</code></td>
<td>
<p>character: the type of plot, either <code>"lordStat"</code> or <code>"itemCurve"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLord_+3A_item">item</code></td>
<td>
<p>numeric or character: either the number or the name of the item for which ICC curves are plotted. Used only when <code>plot="itemCurve"</code>.</p>
</td></tr>
<tr><td><code id="difLord_+3A_pch">pch</code>, <code id="difLord_+3A_col">col</code></td>
<td>
<p>type of usual <code>pch</code> and <code>col</code> graphical options.</p>
</td></tr>
<tr><td><code id="difLord_+3A_number">number</code></td>
<td>
<p>logical: should the item number identification be printed (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="difLord_+3A_colic">colIC</code>, <code id="difLord_+3A_ltyic">ltyIC</code></td>
<td>
<p>vectors of two elements of the usual <code>col</code> and <code>lty</code> arguments for ICC curves. Used only when <code>plot="itemCurve"</code>.</p>
</td></tr>
<tr><td><code id="difLord_+3A_save.plot">save.plot</code></td>
<td>
<p>logical: should the plot be saved into a separate file? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difLord_+3A_save.options">save.options</code></td>
<td>
<p>character: a vector of three components. The first component is the name of the output file, the second component is either the file path or <code>"default"</code> (default value),
and the third component is the file extension, either <code>"pdf"</code> (default) or <code>"jpeg"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLord_+3A_group.names">group.names</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of two character strings giving the names of the reference group and the focal group (in this order)
for display in the legend. Ignored if <code>plot</code> is <code>"lordStat"</code>.</p>
</td></tr>
<tr><td><code id="difLord_+3A_...">...</code></td>
<td>
<p>other generic parameters for the <code>plot</code> or the <code>print</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Lord's chi-squared method (Lord, 1980) allows for detecting uniform or non-uniform differential item functioning 
by setting an appropriate item response model. The input can be of two kinds: either by displaying the full data,
the group membership and the model, or by giving the item parameter estimates (through the option <code>irtParam</code>).
Both can be supplied, but in this case only the parameters in <code>irtParam</code> are used for computing Lord's 
chi-squared statistic.
</p>
<p>The <code>Data</code> is a matrix whose rows correspond to the subjects and columns to the items. 
In addition, <code>Data</code> can hold the vector of group membership. If so, <code>group</code> indicates the column of <code>Data</code> which 
corresponds to the group membership, either by specifying its name or by giving the column number. Otherwise, <code>group</code> must 
be a vector of same length as <code>nrow(Data)</code>.
</p>
<p>Missing values are allowed for item responses (not for group membership) but must be coded as <code>NA</code> values. They are discarded for item parameter estimation.
</p>
<p>The vector of group membership must hold only two different values, either as numeric or character. The focal group is defined by
the value of the argument <code>focal.name</code>. 
</p>
<p>If the model is not the 1PL model, or if <code>engine</code> is equal to <code>"ltm"</code>, the selected IRT model is fitted using marginal maximum likelihood
by means of the functions from the <code>ltm</code> package (Rizopoulos, 2006). Otherwise, the 1PL model is fitted as a generalized 
linear mixed model, by means of the <code>glmer</code> function of the <code>lme4</code> package (Bates and Maechler, 2009).
</p>
<p>With the <code>"1PL"</code> model and the <code>"ltm"</code> engine, the common discrimination parameter is set equal to 1 by default. It is possible to fix another value
through the argument<code>discr</code>. Alternatively, this common discrimination parameter can be estimated (though not returned) by fixing <code>discr</code> to 
<code>NULL</code>.
</p>
<p>The 3PL model can be fitted either unconstrained (by setting <code>c</code> to <code>NULL</code>) or by fixing the pseudo-guessing values. In the latter 
case, the argument <code>c</code> holds either a numeric vector of same length of the number of items, with one value per item pseudo-guessing parameter, 
or a single value which is duplicated for all the items. If <code>c</code> is different from <code>NULL</code> then the 3PL model is always fitted (whatever the value of <code>model</code>).
</p>
<p>The <code>irtParam</code> matrix has a number of rows equal to twice the number of items in the data set. The first <em>J</em> rows refer to 
the item parameter estimates in the reference group, while the last <em>J</em> ones correspond to the same items in the focal group. 
The number of columns depends on the selected IRT model: 2 for the 1PL model, 5 for the 2PL model, 6 for the constrained 3PL model
and 9 for the unconstrained 3PL model. The columns of <code>irtParam</code> have to follow the same structure as the output of
<code>itemParEst</code> command (the latter can actually be used to create the <code>irtParam</code> matrix).
</p>
<p>In addition to the matrix of parameter estimates, one has to specify whether items in the focal group were rescaled to those of the 
reference group. If not, rescaling is performed by equal means anchoring (Cook and Eignor, 1991). Argument <code>same.scale</code> is used for 
this choice (default option is <code>TRUE</code> and assumes therefore that the parameters are already placed on the same scale). 
</p>
<p>The threshold (or cut-score) for classifying items as DIF is computed as the quantile of the chi-squared distribution with lower-tail
probability of one minus <code>alpha</code> and <em>p</em> degrees of freedom (<em>p=1</em> for the 1PL model, <em>p=2</em> for the 2PL model or the 3PL model
with constrained pseudo-guessing parameters, and <em>p=3</em> for the unconstrained 3PL model).
</p>
<p>Item purification can be performed by setting <code>purify</code> to <code>TRUE</code>. In this case, the purification occurs in the equal means anchoring process. Items 
detected as DIF are iteratively removed from the set of items used for equal means anchoring, and the procedure is repeated until either the same items
are identified twice as functioning differently, or when <code>nrIter</code> iterations have been performed. In the latter case a warning message is printed.
See Candell and Drasgow (1988) for further details. Note that item purification is performed on original statistics and p-values; in case of adjustment for multiple comparisons this is performed <em>after</em> item purification.
</p>
<p>Adjustment for multiple comparisons is possible with the argument <code>p.adjust.method</code>. The latter must be an acronym of one of the available adjustment methods of the <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function. According to Kim and Oshima (2013), Holm and Benjamini-Hochberg adjustments (set respectively by <code>"Holm"</code> and <code>"BH"</code>) perform best for DIF purposes. See <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function for further details. Note that item purification is performed on original statistics and p-values; in case of adjustment for multiple comparisons this is performed <em>after</em> item purification.
</p>
<p>A pre-specified set of anchor items can be provided through the <code>anchor</code> argument. It must be a vector of either item names (which must match exactly the column names of <code>Data</code> argument) or integer values (specifying the column numbers for item identification). In case anchor items are provided, they are used to rescale the item parameters on a common metric. None of the anchor items are tested for DIF: the output separates anchor items and tested items and DIF results are returned only for the latter. Note also that item purification is not activated when anchor items are provided (even if <code>purify</code> is set to <code>TRUE</code>). By default it is <code>NULL</code> so that no anchor item is specified. If item parameters are provided thorugh the <code>irtParam</code> argument and if they are on the same scale (i.e. if <code>same.scale</code> is <code>TRUE</code>), then anchor items are not used (even if they are specified).
</p>
<p>Under the 1PL model, the displayed output also proposes an effect size measure, which is -2.35 times the difference between item difficulties of the reference group
and the focal group (Penfield and Camilli, 2007, p. 138). This effect size is similar Mantel-Haenszel's <code class="reqn">\Delta_{MH}</code> effect size, and the ETS delta scale is used 
to classify the effect sizes (Holland and Thayer, 1985).
</p>
<p>The output of the <code>difLord</code>, as displayed by the <code>print.Lord</code> function, can be stored in a text file provided that <code>save.output</code> is set to <code>TRUE</code> 
(the default value <code>FALSE</code> does not execute the storage). In this case, the name of the text file must be given as a character string into the first component
of the <code>output</code> argument (default name is <code>"out"</code>), and the path for saving the text file can be given through the second component of <code>output</code>. The
default value is <code>"default"</code>, meaning that the file will be saved in the current working directory. Any other path can be specified as a character string: see the 
<b>Examples</b> section for an illustration.
</p>
<p>Two types of plots are available. The first one is obtained by setting <code>plot="lordStat"</code> and it is the default option. The chi-squared statistics are displayed 
on the Y axis, for each item. The detection threshold is displayed by a horizontal line, and items flagged as DIF are printed with the color defined by argument <code>col</code>.
By default, items are spotted with their number identification (<code>number=TRUE</code>); otherwise they are simply drawn as dots whose form is given by the option <code>pch</code>.
</p>
<p>The other type of plot is obtained by setting <code>plot="itemCurve"</code>. In this case, the fitted ICC curves are displayed for one specific item set by the argument 
<code>item</code>. The latter argument can hold either the name of the item or its number identification. The item parameters are extracted from the <code>itemParFinal</code> matrix
if the output argument <code>purification</code> is <code>TRUE</code>, otherwise from the <code>itemParInit</code> matrix and after a rescaling of the item parameters using the 
<code><a href="#topic+itemRescale">itemRescale</a></code> command. A legend is displayed in the upper left corner of the plot. The colors and types of traits for these curves are defined by means of 
the arguments <code>colIC</code> and <code>ltyIC</code> respectively. These are set as vectors of length 2, the first element for the reference group and the second for the focal group.
Finally, the argument <code>group.names</code> permits to display the names of the reference and focal groups (instead of &quot;Reference&quot; and &quot;Focal&quot;) in the legend.
</p>
<p>Both types of plots can be stored in a figure file, either in PDF or JPEG format. Fixing <code>save.plot</code> to <code>TRUE</code> allows this process. The figure is defined through 
the components of <code>save.options</code>. The first two components perform similarly as those of the <code>output</code> argument. The third component is the figure format, with allowed
values <code>"pdf"</code> (default) for PDF file and <code>"jpeg"</code> for JPEG file.
</p>


<h3>Value</h3>

<p>A list of class &quot;Lord&quot; with the following arguments:
</p>
<table role = "presentation">
<tr><td><code>LordChi</code></td>
<td>
<p>the values of the Lord's chi-square statistics.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the vector of p-values for the Lord's chi-square statistics.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the value of <code>alpha</code> argument.</p>
</td></tr>
<tr><td><code>thr</code></td>
<td>
<p>the threshold (cut-score) for DIF detection.</p>
</td></tr>
<tr><td><code>DIFitems</code></td>
<td>
<p>either the column indicators of the items which were detected as DIF items, or &quot;No DIF item detected&quot;.</p>
</td></tr>
<tr><td><code>purification</code></td>
<td>
<p>the value of <code>purify</code> option.</p>
</td></tr> 
<tr><td><code>nrPur</code></td>
<td>
<p>the number of iterations in the item purification process. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>difPur</code></td>
<td>
<p>a binary matrix with one row per iteration in the item purification process and one column per item. Zeros and ones in the <em>i</em>-th 
row refer to items which were classified respectively as non-DIF and DIF items at the (<em>i</em>-1)-th step. The first row corresponds to the initial
classification of the items. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>logical indicating whether the iterative item purification process stopped before the maximal number <code>nrIter</code>of allowed iterations. 
Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the value of <code>model</code> argument.</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p>The value of the <code>c</code> argument.</p>
</td></tr>
<tr><td><code>engine</code></td>
<td>
<p>The value of the <code>engine</code> argument.</p>
</td></tr>
<tr><td><code>discr</code></td>
<td>
<p>the value of the <code>discr</code> argument.</p>
</td></tr>
<tr><td><code>p.adjust.method</code></td>
<td>
<p>the value of the <code>p.adjust.method</code> argument.</p>
</td></tr>
<tr><td><code>adjusted.p</code></td>
<td>
<p>either <code>NULL</code> or the vector of adjusted p-values for multiple comparisons.</p>
</td></tr>
<tr><td><code>itemParInit</code></td>
<td>
<p>the matrix of initial parameter estimates,with the same format as <code>irtParam</code> either provided by the user (through <code>irtParam</code>) or estimated from the data
(and displayed without rescaling).</p>
</td></tr>
<tr><td><code>itemParFinal</code></td>
<td>
<p>the matrix of final parameter estimates, with the same format as <code>irtParam</code>, obtained after item purification. Returned 
only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>estPar</code></td>
<td>
<p>a logical value indicating whether the item parameters were estimated (<code>TRUE</code>) or provided by the user (<code>FALSE</code>).</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>the names of the items.</p>
</td></tr>
<tr><td><code>anchor.names</code></td>
<td>
<p>the value of the <code>anchor</code> argument.</p>
</td></tr>
<tr><td><code>save.output</code></td>
<td>
<p>the value of the <code>save.output</code> argument.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>the value of the <code>output</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Bates, D. and Maechler, M. (2009). lme4: Linear mixed-effects models using S4 classes. R package version 0.999375-31. http://CRAN.R-project.org/package=lme4
</p>
<p>Candell, G.L. and Drasgow, F. (1988). An iterative procedure for linking metrics and assessing item bias in item response theory. <em>Applied Psychological Measurement, 12</em>, 253&ndash;260. doi: <a href="https://doi.org/10.1177/014662168801200304">10.1177/014662168801200304</a> 
</p>
<p>Cook, L. L. and Eignor, D. R. (1991). An NCME instructional module on IRT equating methods. <em>Educational Measurement: Issues and Practice, 10</em>, 37&ndash;45.
</p>
<p>Holland, P. W. and Thayer, D. T. (1985). An alternative definition of the ETS delta scale of item difficulty. <em>Research Report RR-85-43</em>. Princeton, New-Jersey:
Educational Testing Service.
</p>
<p>Kim, J., and Oshima, T. C. (2013). Effect of multiple testing adjustment in differential item functioning detection. <em>Educational and Psychological Measurement, 73</em>, 458&ndash;470. doi: <a href="https://doi.org/10.1177/0013164412467033">10.1177/0013164412467033</a>
</p>
<p>Lord, F. (1980). <em>Applications of item response theory to practical testing problems</em>. Hillsdale, NJ: Lawrence Erlbaum Associates. 
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847&ndash;862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Penfield, R. D., and Camilli, G. (2007). Differential item functioning and item bias. In C. R. Rao and S. Sinharray (Eds.), <em>Handbook of Statistics 26: Psychometrics</em>
(pp. 125-167). Amsterdam, The Netherlands: Elsevier.
</p>
<p>Rizopoulos, D. (2006). ltm: An R package for latent variable modelling and item response theory analyses. <em>Journal of Statistical Software, 17</em>, 1-25. doi: <a href="https://doi.org/10.18637/jss.v017.i05">10.18637/jss.v017.i05</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+itemParEst">itemParEst</a></code>,  <code><a href="#topic+dichoDif">dichoDif</a></code>, <code><a href="stats.html#topic+p.adjust">p.adjust</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Excluding the "Anger" variable
 verbal &lt;- verbal[colnames(verbal)!="Anger"]

 # Three equivalent settings of the data matrix and the group membership
 # (1PL model, "ltm" engine) 
 r &lt;- difLord(verbal, group = 25, focal.name = 1, model = "1PL")
 difLord(verbal, group = "Gender", focal.name = 1, model = "1PL")
 difLord(verbal[,1:24], group = verbal[,25], focal.name = 1, model = "1PL")

 # With items 1 to 5 set as anchor items
 difLord(verbal, group = 25, focal.name = 1, model = "1PL", anchor = 1:5)

 # Multiple comparisons adjustment of p-values with Benjamini-Hochberg method
 difLord(verbal, group = 25, focal.name = 1, model = "1PL", anchor = 1:5, p.adjust.method = "BH")


 # 1PL model, "lme4" engine 
 difLord(verbal, group = 25, focal.name = 1, model = "1PL", engine = "lme4")

 # 2PL model   
 difLord(verbal, group = "Gender", focal.name = 1, model = "2PL")

 # 3PL model with all pseudo-guessing parameters constrained to 0.05
 difLord(verbal, group = "Gender", focal.name = 1, model = "3PL", c = 0.05)

 # Same models, with item purification 
 difLord(verbal, group = 25, focal.name = 1, model = "1PL", purify = TRUE)
 difLord(verbal, group = "Gender", focal.name = 1, model = "2PL", purify = TRUE)
 difLord(verbal, group = "Gender", focal.name = 1, model = "3PL", c = 0.05,
 purify = TRUE)

 # Saving the output into the "LordResults.txt" file (and default path)
 r &lt;- difLord(verbal, group = 25, focal.name = 1, model = "1PL",
 	    save.output = TRUE, output = c("LordResults","default"))

 # Splitting the data into reference and focal groups
 nF&lt;-sum(Gender)
 nR&lt;-nrow(verbal)-nF
 data.ref&lt;-verbal[,1:24][order(Gender),][1:nR,]
 data.focal&lt;-verbal[,1:24][order(Gender),][(nR+1):(nR+nF),]

 ## Pre-estimation of the item parameters (1PL model, "ltm" engine)
 item.1PL&lt;-rbind(itemParEst(data.ref, model = "1PL"),
 itemParEst(data.focal, model = "1PL"))
 difLord(irtParam = item.1PL, same.scale = FALSE)

 ## Pre-estimation of the item parameters (1PL model, "lme4" engine)
 item.1PL&lt;-rbind(itemParEst(data.ref, model = "1PL", engine = "lme4"),
 itemParEst(data.focal, model = "1PL", engine = "lme4"))
 difLord(irtParam = item.1PL, same.scale = FALSE)

 ## Pre-estimation of the item parameters (2PL model) 
 item.2PL&lt;-rbind(itemParEst(data.ref, model = "2PL"),
 itemParEst(data.focal, model = "2PL"))
 difLord(irtParam = item.2PL, same.scale = FALSE)

 ## Pre-estimation of the item parameters (constrained 3PL model)
 item.3PL&lt;-rbind(itemParEst(data.ref, model = "3PL", c = 0.05),
 itemParEst(data.focal, model = "3PL", c = 0.05))
 difLord(irtParam = item.3PL, same.scale = FALSE)

 # Graphical devices
 plot(r)
 plot(r, plot = "itemCurve", item = 1)
 plot(r, plot = "itemCurve", item = 6)

 # Plotting results and saving it in a PDF figure
 plot(r, save.plot = TRUE, save.options = c("plot", "default", "pdf"))

 # Changing the path, JPEG figure
 path &lt;- "c:/Program Files/"
 plot(r, save.plot = TRUE, save.options = c("plot", path, "jpeg"))

## End(Not run)
 </code></pre>

<hr>
<h2 id='difLRT'>Likelihood-Ratio Test DIF method</h2><span id='topic+difLRT'></span><span id='topic+print.LRT'></span><span id='topic+plot.LRT'></span>

<h3>Description</h3>

<p>Performs DIF detection using Likelihood Ratio Test (LRT) method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>difLRT(Data, group, focal.name, alpha = 0.05, purify = FALSE, nrIter = 10, 
 	p.adjust.method = NULL, save.output = FALSE, output = c("out", "default")) 
## S3 method for class 'LRT'
print(x, ...)
## S3 method for class 'LRT'
plot(x, pch = 8, number = TRUE, col = "red", save.plot = FALSE, 
 	save.options = c("plot", "default", "pdf"), ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="difLRT_+3A_data">Data</code></td>
<td>
<p>numeric: either the data matrix only, or the data matrix plus the vector of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLRT_+3A_group">group</code></td>
<td>
<p>numeric or character: either the vector of group membership or the column indicator (within <code>data</code>) of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLRT_+3A_focal.name">focal.name</code></td>
<td>
<p>numeric or character indicating the level of <code>group</code> which corresponds to the focal group.</p>
</td></tr>
<tr><td><code id="difLRT_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="difLRT_+3A_purify">purify</code></td>
<td>
<p>logical: should the method be used iteratively to purify the set of anchor items? (default is FALSE).</p>
</td></tr>
<tr><td><code id="difLRT_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item purification process (default is 10).</p>
</td></tr>
<tr><td><code id="difLRT_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>either <code>NULL</code> (default) or the acronym of the method for p-value adjustment for multiple comparisons. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLRT_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved into a text file? (Default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difLRT_+3A_output">output</code></td>
<td>
<p>character: a vector of two components. The first component is the name of the output file, the second component is either the file path or <code>"default"</code> (default value). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLRT_+3A_x">x</code></td>
<td>
<p>the result from a <code>LRT</code> class object.</p>
</td></tr>
<tr><td><code id="difLRT_+3A_pch">pch</code>, <code id="difLRT_+3A_col">col</code></td>
<td>
<p>type of usual <code>pch</code> and <code>col</code> graphical options.</p>
</td></tr>
<tr><td><code id="difLRT_+3A_number">number</code></td>
<td>
<p>logical: should the item number identification be printed (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="difLRT_+3A_save.plot">save.plot</code></td>
<td>
<p>logical: should the plot be saved into a separate file? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difLRT_+3A_save.options">save.options</code></td>
<td>
<p>character: a vector of three components. The first component is the name of the output file, the second component is either the file path or <code>"default"</code> (default value),
and the third component is the file extension, either <code>"pdf"</code> (default) or <code>"jpeg"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difLRT_+3A_...">...</code></td>
<td>
<p>other generic parameters for the <code>plot</code> or the <code>print</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The likelihood-ratio test method (Thissen, Steinberg and Wainer, 1988) allows for detecting uniform differential item functioning 
by fitting a closed-form Rasch model and by testing for extra interactions between group membership and item response. Currently only 
the Rasch model can be used, so only uniform DIF can be detected. Moreover, items are tested one by one and the other items act as
anchor items.
</p>
<p>The <code>Data</code> is a matrix whose rows correspond to the subjects and columns to the items. Missing values are allowed but must be coded as <code>NA</code> values.
In addition, <code>Data</code> can hold the vector of group membership. If so, <code>group</code> indicates the column of <code>Data</code> which 
corresponds to the group membership, either by specifying its name or by giving the column number. Otherwise, <code>group</code> must 
be a vector of same length as <code>nrow(Data)</code>.
</p>
<p>The vector of group membership must hold only two different values, either as numeric or character. The focal group is defined by
the value of the argument <code>focal.name</code>. 
</p>
<p>The function <code>glmer</code> from package <code>lme4</code> (Bates and Maechler, 2009) is used to fit the closed-form Rasch model. More precisely, the probability that 
response <code class="reqn">Y_{ijg}</code> of subject <em>i</em> from group <em>g</em> (focal or reference) to item <em>j</em> is modeled as
</p>
<p style="text-align: center;"><code class="reqn">logit (Pr(Y_{ijg}=1) = \theta_{ig} + \gamma_g - \beta_j</code>
</p>

<p>where <code class="reqn">\theta_i</code> is subject's ability, <code class="reqn">\beta_j</code> is the item difficulty and <code class="reqn">\gamma_g</code> is the difference mean ability level between
the focal and the reference groups. Subject abilities are treated as random effects, while item difficulties and <code class="reqn">\gamma_g</code> are treated as fixed effects.
Each item is tested by incorporating an interaction term, <code class="reqn">\delta_{gj}</code>, and by testing its statistical significance using the traditional
likelihood-ratio test.
</p>
<p>The threshold (or cut-score) for classifying items as DIF is computed as the quantile of the chi-squared distribution with lower-tail
probability of one minus <code>alpha</code> and one degree of freedom.
</p>
<p>Item purification can be performed by setting <code>purify</code> to <code>TRUE</code>. In this case, items detected as DIF are iteratively
removed from the set of tested items, and the procedure is repeated (using the remaining items) until no additional item is
identified as functioning differently. The process stops when either there is no new item detected as DIF, or when <code>nrIter</code> iterations 
are run and new DIF items are nevertheless detected. In the latter case a warning message is printed. 
</p>
<p>Adjustment for multiple comparisons is possible with the argument <code>p.adjust.method</code>. The latter must be an acronym of one of the available adjustment methods of the <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function. According to Kim and Oshima (2013), Holm and Benjamini-Hochberg adjustments (set respectively by <code>"Holm"</code> and <code>"BH"</code>) perform best for DIF purposes. See <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function for further details. Note that item purification is performed on original statistics and p-values; in case of adjustment for multiple comparisons this is performed <em>after</em> item purification.
</p>
<p>The output of the <code>difLRT</code>, as displayed by the <code>print.LRT</code> function, can be stored in a text file provided that <code>save.output</code> is set to <code>TRUE</code> 
(the default value <code>FALSE</code> does not execute the storage). In this case, the name of the text file must be given as a character string into the first component
of the <code>output</code> argument (default name is <code>"out"</code>), and the path for saving the text file can be given through the second component of <code>output</code>. The
default value is <code>"default"</code>, meaning that the file will be saved in the current working directory. Any other path can be specified as a character string: see the 
<b>Examples</b> section for an illustration.
</p>
<p>The <code>plot.LRT</code> function displays the DIF statistics in a plot, with each item on the X axis. The type of point and the color are fixed by the usual <code>pch</code> and 
<code>col</code> arguments. Option <code>number</code> permits to display the item numbers instead. Also, the plot can be stored in a figure file, either in PDF or JPEG format.
Fixing <code>save.plot</code> to <code>TRUE</code> allows this process. The figure is defined through the components of <code>save.options</code>. The first two components perform similarly 
as those of the <code>output</code> argument. The third component is the figure format, with allowed values <code>"pdf"</code> (default) for PDF file and <code>"jpeg"</code> for JPEG file.
</p>


<h3>Value</h3>

<p>A list of class &quot;LRT&quot; with the following arguments:
</p>
<table role = "presentation">
<tr><td><code>LRT</code></td>
<td>
<p>the values of the likelihood-ratio statistics.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the vector of p-values for the likelihood-ratio statistics.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the value of <code>alpha</code> argument.</p>
</td></tr>
<tr><td><code>thr</code></td>
<td>
<p>the threshold (cut-score) for DIF detection.</p>
</td></tr>
<tr><td><code>DIFitems</code></td>
<td>
<p>either the items which were detected as DIF items, or &quot;No DIF item detected&quot;.</p>
</td></tr>
<tr><td><code>p.adjust.method</code></td>
<td>
<p>the value of the <code>p.adjust.method</code> argument.</p>
</td></tr>
<tr><td><code>adjusted.p</code></td>
<td>
<p>either <code>NULL</code> or the vector of adjusted p-values for multiple comparisons.</p>
</td></tr>
<tr><td><code>purification</code></td>
<td>
<p>the value of <code>purify</code> option.</p>
</td></tr> 
<tr><td><code>nrPur</code></td>
<td>
<p>the number of iterations in the item purification process. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>logical indicating whether the iterative item purification process stopped before the maximal number of allowed iterations
(10 by default). Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>the names of the items.</p>
</td></tr>
<tr><td><code>save.output</code></td>
<td>
<p>the value of the <code>save.output</code> argument.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>the value of the <code>output</code> argument.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Because of the fitting of the modified Rasch model with <code>glmer</code>, the process can be very time consuming. 
</p>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Bates, D. and Maechler, M. (2009). lme4: Linear mixed-effects models using S4 classes. R package version 0.999375-31. http://CRAN.R-project.org/package=lme4
</p>
<p>Kim, J., and Oshima, T. C. (2013). Effect of multiple testing adjustment in differential item functioning detection. <em>Educational and Psychological Measurement, 73</em>, 458&ndash;470. doi: <a href="https://doi.org/10.1177/0013164412467033">10.1177/0013164412467033</a>
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Thissen, D., Steinberg, L. and Wainer, H. (1988). Use of item response theory in the study of group difference in trace lines. 
In H. Wainer and H. Braun (Eds.), <em>Test validity</em>. Hillsdale, NJ: Lawrence Erlbaum Associates.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LRT">LRT</a></code>, <code><a href="#topic+dichoDif">dichoDif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Excluding the "Anger" variable
 verbal &lt;- verbal[colnames(verbal)!="Anger"]

 # Keeping the first 5 items and the first 50 subjects
 # (this is an artificial simplification to reduce the computational time)
 verbal &lt;- verbal[1:50, c(1:5, 25)]

 # Three equivalent settings of the data matrix and the group membership
 r &lt;- difLRT(verbal, group = 6, focal.name = 1)
 difLRT(verbal, group = "Gender", focal.name = 1)
 difLRT(verbal[,1:5], group = verbal[,6], focal.name = 1)

 # Multiple comparisons adjustment using Benjamini-Hochberg method
 difLRT(verbal, group = 6, focal.name = 1, p.adjust.method = "BH")

 # With item purification
 difLRT(verbal, group = 6, focal.name = 1, purify = TRUE)

 # Saving the output into the "LRTresults.txt" file (and default path)
 r &lt;- difLRT(verbal, group = 6, focal.name = 1, save.output = TRUE, 
            output = c("LRTresults", "default"))

 # Graphical devices
 plot(r)

 # Plotting results and saving it in a PDF figure
 plot(r, save.plot = TRUE, save.options = c("plot", "default", "pdf"))

 # Changing the path, JPEG figure
 path &lt;- "c:/Program Files/"
 plot(r, save.plot = TRUE, save.options = c("plot", path, "jpeg"))

 # WARNING: do not trust the results above since they are based on a selected 
 # subset of the verbal data set!
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='difMH'>Mantel-Haenszel DIF method</h2><span id='topic+difMH'></span><span id='topic+print.MH'></span><span id='topic+plot.MH'></span>

<h3>Description</h3>

<p>Performs DIF detection using Mantel-Haenszel method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>difMH(Data, group, focal.name , anchor = NULL, match = "score", MHstat = "MHChisq", 
  	correct = TRUE, exact = FALSE, alpha = 0.05, purify = FALSE, nrIter = 10, 
  	p.adjust.method = NULL, save.output = FALSE, output = c("out", "default")) 
## S3 method for class 'MH'
print(x, ...)
## S3 method for class 'MH'
plot(x, pch = 8, number = TRUE, col = "red", save.plot = FALSE, 
  	save.options = c("plot", "default", "pdf"), ...)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="difMH_+3A_data">Data</code></td>
<td>
<p>numeric: either the data matrix only, or the data matrix plus the vector of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difMH_+3A_group">group</code></td>
<td>
<p>numeric or character: either the vector of group membership or the column indicator (within <code>data</code>) of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difMH_+3A_focal.name">focal.name</code></td>
<td>
<p>numeric or character indicating the level of <code>group</code> which corresponds to the focal group.</p>
</td></tr>
<tr><td><code id="difMH_+3A_anchor">anchor</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of item names (or identifiers) to specify the anchor items. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difMH_+3A_match">match</code></td>
<td>
<p>specifies the type of matching criterion. Can be either <code>"score"</code> (default) to compute the test score, or any continuous or discrete variable with the same length as the number of rows of <code>Data</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difMH_+3A_mhstat">MHstat</code></td>
<td>
<p>character: specifies the DIF statistic to be used for DIF identification. Possible values are <code>"MHChisq"</code> (default) and <code>"logOR"</code>. 
See <b>Details </b>.</p>
</td></tr>
<tr><td><code id="difMH_+3A_correct">correct</code></td>
<td>
<p>logical: should the continuity correction be used? (default is <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="difMH_+3A_exact">exact</code></td>
<td>
<p>logical: should an exact test be computed? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difMH_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="difMH_+3A_purify">purify</code></td>
<td>
<p>logical: should the method be used iteratively to purify the set of anchor items? (default is FALSE).</p>
</td></tr>
<tr><td><code id="difMH_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item purification process (default is 10).</p>
</td></tr>
<tr><td><code id="difMH_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>either <code>NULL</code> (default) or the acronym of the method for p-value adjustment for multiple comparisons. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difMH_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved into a text file? (Default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difMH_+3A_output">output</code></td>
<td>
<p>character: a vector of two components. The first component is the name of the output file, the second component is either the file path or 
<code>"default"</code> (default value). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difMH_+3A_x">x</code></td>
<td>
<p>the result from a <code>MH</code> class object.</p>
</td></tr>
<tr><td><code id="difMH_+3A_pch">pch</code>, <code id="difMH_+3A_col">col</code></td>
<td>
<p>type of usual <code>pch</code> and <code>col</code> graphical options.</p>
</td></tr>
<tr><td><code id="difMH_+3A_number">number</code></td>
<td>
<p>logical: should the item number identification be printed (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="difMH_+3A_save.plot">save.plot</code></td>
<td>
<p>logical: should the plot be saved into a separate file? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difMH_+3A_save.options">save.options</code></td>
<td>
<p>character: a vector of three components. The first component is the name of the output file, the second component is either the file path or
<code>"default"</code> (default value), and the third component is the file extension, either <code>"pdf"</code> (default) or <code>"jpeg"</code>. 
See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difMH_+3A_...">...</code></td>
<td>
<p>other generic parameters for the <code>plot</code> or the <code>print</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method of Mantel-Haenszel (1959) allows for detecting uniform differential item functioning without requiring an item response model approach. 
</p>
<p>The <code>Data</code> is a matrix whose rows correspond to the subjects and columns to the items. In addition, <code>Data</code> can hold the vector of group membership. 
If so, <code>group</code> indicates the column of <code>Data</code> which corresponds to the group membership, either by specifying its name or by giving the column number.
Otherwise, <code>group</code> must be a vector of same length as <code>nrow(Data)</code>.
</p>
<p>Missing values are allowed for item responses (not for group membership) but must be coded as <code>NA</code> values. They are discarded from sum-score computation.
</p>
<p>The vector of group membership must hold only two different values, either as numeric or character. The focal group is defined by the value of the argument 
<code>focal.name</code>. 
</p>
<p>The matching criterion can be either the test score or any other continuous or discrete variable to be passed in the <code><a href="#topic+mantelHaenszel">mantelHaenszel</a></code> function. This is specified by the <code>match</code> argument. By default, it takes the value <code>"score"</code> and the test score (i.e. raw score) is computed. The second option is to assign to <code>match</code> a vector of continuous or discrete numeric values, which acts as the matching criterion. Note that for consistency this vector should not belong to the <code>Data</code> matrix.
</p>
<p>The DIF statistic is specified by the <code>MHstat</code> argument. By default, <code>MHstat</code> takes the value <code>"MHChisq"</code> and the Mantel-Haenszel chi-square
statistic is used. The other optional value is <code>"logOR"</code>, and the log odds-ratio statistic (that is, the log of <code>alphaMH</code> divided by the square root
of <code>varLambda</code>) is used. See Penfield and Camilli (2007), Philips and Holland (1987) and <code><a href="#topic+mantelHaenszel">mantelHaenszel</a></code> help file.
</p>
<p>By default, the asymptotic Mantel-Haenszel statistic is computed. However, the exact statistics and related P-values can
be obtained by specifying the logical argument <code>exact</code> to <code>TRUE</code>. See Agresti (1990, 1992) for further 
details about exact inference.
</p>
<p>The threshold (or cut-score) for classifying items as DIF depends on the DIF statistic. With the Mantel-Haenszel chi-squared statistic (<code>MHstat=="MHChisq"</code>),
it is computed as the quantile of the chi-square distribution with lower-tail probability of one minus <code>alpha</code> and with one degree of freedom. With 
the log odds-ratio statistic (<code>MHstat=="logOR"</code>), it is computed as the quantile of the standard normal distribution with lower-tail probability of
1-<code>alpha</code>/2. With exact inference, it is simply the <code>alpha</code> level since exact P-values are returned.
</p>
<p>By default, the continuity correction factor -0.5 is used (Holland and Thayer, 1988). One can nevertheless remove it by specifying <code>correct=FALSE</code>.
</p>
<p>In addition, the Mantel-Haenszel estimates of the common odds ratios <code class="reqn">\alpha_{MH}</code> are used to measure the effect sizes of the items. These are obtained by
<code class="reqn">\Delta_{MH} = -2.35 \log \alpha_{MH}</code> (Holland and Thayer, 1985). According to the ETS delta scale, the effect size of an item is classified as negligible
if <code class="reqn">|\Delta_{MH}| \leq 1</code>, moderate  if <code class="reqn">1 \leq |\Delta_{MH}| \leq 1.5</code>, and large if <code class="reqn">|\Delta_{MH}| \geq 1.5</code>. The values of the effect sizes, 
together with the ETS classification, are printed with the output. Note that this is returned only for asymptotic tests, i.e. when <code>exact</code> is <code>FALSE</code>.
</p>
<p>Item purification can be performed by setting <code>purify</code> to <code>TRUE</code>. Purification works as follows: if at least one item was detected as functioning 
differently at some step of the process, then the data set of the next step consists in all items that are currently anchor (DIF free) items, plus the 
tested item (if necessary). The process stops when either two successive applications of the method yield the same classifications of the items (Clauser and 
Mazor, 1998), or when <code>nrIter</code> iterations are run without obtaining two successive identical classifications. In the latter case a warning message is printed. 
</p>
<p>Adjustment for multiple comparisons is possible with the argument <code>p.adjust.method</code>. The latter must be an acronym of one of the available adjustment methods of the <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function. According to Kim and Oshima (2013), Holm and Benjamini-Hochberg adjustments (set respectively by <code>"Holm"</code> and <code>"BH"</code>) perform best for DIF purposes. See <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function for further details. Note that item purification is performed on original statistics and p-values; in case of adjustment for multiple comparisons this is performed <em>after</em> item purification.
</p>
<p>A pre-specified set of anchor items can be provided through the <code>anchor</code> argument. It must be a vector of either item names (which must match exactly the column names of <code>Data</code> argument) or integer values (specifying the column numbers for item identification). In case anchor items are provided, they are used to compute the test score (matching criterion), including also the tested item. None of the anchor items are tested for DIF: the output separates anchor items and tested items and DIF results are returned only for the latter. Note also that item purification is not activated when anchor items are provided (even if <code>purify</code> is set to <code>TRUE</code>). By default it is <code>NULL</code> so that no anchor item is specified.
</p>
<p>The output of the <code>difMH</code>, as displayed by the <code>print.MH</code> function, can be stored in a text file provided that <code>save.output</code> is set to <code>TRUE</code> 
(the default value <code>FALSE</code> does not execute the storage). In this case, the name of the text file must be given as a character string into the first component
of the <code>output</code> argument (default name is <code>"out"</code>), and the path for saving the text file can be given through the second component of <code>output</code>. The
default value is <code>"default"</code>, meaning that the file will be saved in the current working directory. Any other path can be specified as a character string: 
see the <b>Examples</b> section for an illustration.
</p>
<p>The <code>plot.MH</code> function displays the DIF statistics in a plot, with each item on the X axis. The type of point and the color are fixed by the usual <code>pch</code>
and <code>col</code> arguments. Option <code>number</code> permits to display the item numbers instead. Also, the plot can be stored in a figure file, either in PDF or JPEG
format. Fixing <code>save.plot</code> to <code>TRUE</code> allows this process. The figure is defined through the components of <code>save.options</code>. The first two components
perform similarly as those of the <code>output</code> argument. The third component is the figure format, with allowed values <code>"pdf"</code> (default) for PDF file and
<code>"jpeg"</code> for JPEG file. Note that no plot is returned for exact inference.
</p>


<h3>Value</h3>

<p>A list of class &quot;MH&quot; with the following arguments:
</p>
<table role = "presentation">
<tr><td><code>MH</code></td>
<td>
<p>the values of the Mantel-Haenszel DIF statistics (either exact or asymptotic).</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-values for the Mantel-Haenszel statistics (either exact or asymptotic).</p>
</td></tr>
<tr><td><code>alphaMH</code></td>
<td>
<p>the values of the mantel-Haenszel estimates of common odds ratios. Returned only if <code>exact</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code>varLambda</code></td>
<td>
<p>the values of the variances of the log odds-ratio statistics. Returned only if <code>exact</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code>MHstat</code></td>
<td>
<p>the value of the <code>MHstat</code> argument. Returned only if <code>exact</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the value of <code>alpha</code> argument.</p>
</td></tr>
<tr><td><code>thr</code></td>
<td>
<p>the threshold (cut-score) for DIF detection. Returned only if <code>exact</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code>DIFitems</code></td>
<td>
<p>either the column indicators of the items which were detected as DIF items, or &quot;No DIF item detected&quot;.</p>
</td></tr>
<tr><td><code>correct</code></td>
<td>
<p>the value of <code>correct</code> option.</p>
</td></tr>
<tr><td><code>exact</code></td>
<td>
<p>the value of <code>exact</code> option.</p>
</td></tr>
<tr><td><code>match</code></td>
<td>
<p>a character string, either <code>"score"</code> or <code>"matching variable"</code> depending on the <code>match</code> argument.</p>
</td></tr>
<tr><td><code>p.adjust.method</code></td>
<td>
<p>the value of the <code>p.adjust.method</code> argument.</p>
</td></tr>
<tr><td><code>adjusted.p</code></td>
<td>
<p>either <code>NULL</code> or the vector of adjusted p-values for multiple comparisons.</p>
</td></tr>
<tr><td><code>purification</code></td>
<td>
<p>the value of <code>purify</code> option.</p>
</td></tr> 
<tr><td><code>nrPur</code></td>
<td>
<p>the number of iterations in the item purification process. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>difPur</code></td>
<td>
<p>a binary matrix with one row per iteration in the item purification process and one column per item. Zeros and ones in the <em>i</em>-th 
row refer to items which were classified respectively as non-DIF and DIF items at the (<em>i</em>-1)-th step. The first row corresponds to the initial
classification of the items. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>logical indicating whether the iterative item purification process stopped before the maximal number <code>nrIter</code> of allowed iterations. 
Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>the names of the items.</p>
</td></tr>
<tr><td><code>anchor.names</code></td>
<td>
<p>the value of the <code>anchor</code> argument.</p>
</td></tr>
<tr><td><code>save.output</code></td>
<td>
<p>the value of the <code>save.output</code> argument.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>the value of the <code>output</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Agresti, A. (1990). <em>Categorical data analysis</em>. New York: Wiley.
</p>
<p>Agresti, A. (1992). A survey of exact inference for contingency tables. <em>Statistical Science, 7</em>, 131-177. doi: <a href="https://doi.org/10.1214/ss/1177011454">10.1214/ss/1177011454</a>
</p>
<p>Holland, P. W. and Thayer, D. T. (1985). An alternative definition of the ETS delta scale of item difficulty. <em>Research Report RR-85-43</em>. Princeton, NJ: 
Educational Testing Service.
</p>
<p>Holland, P. W. and Thayer, D. T. (1988). Differential item performance and the Mantel-Haenszel procedure. In H. Wainer and H. I. Braun (Ed.), <em>Test validity</em>. Hillsdale, NJ: Lawrence Erlbaum Associates.
</p>
<p>Kim, J., and Oshima, T. C. (2013). Effect of multiple testing adjustment in differential item functioning detection. <em>Educational and Psychological Measurement, 73</em>, 458&ndash;470. doi: <a href="https://doi.org/10.1177/0013164412467033">10.1177/0013164412467033</a>
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Mantel, N. and Haenszel, W. (1959). Statistical aspects of the analysis of data from retrospective studies of disease. <em>Journal of the National Cancer Institute, 22</em>, 719-748.
</p>
<p>Penfield, R. D., and Camilli, G. (2007). Differential item functioning and item bias. In C. R. Rao and S. Sinharray (Eds.), <em>Handbook of Statistics 26: Psychometrics</em> (pp. 125-167). Amsterdam, The Netherlands: Elsevier.
</p>
<p>Philips, A., and Holland, P. W. (1987). Estimators of the Mantel-Haenszel log odds-ratio estimate. <em>Biometrics, 43</em>, 425-431. doi: <a href="https://doi.org/10.2307/2531824">10.2307/2531824</a>
</p>
<p>Raju, N. S., Bode, R. K. and Larsen, V. S. (1989). An empirical assessment of the Mantel-Haenszel statistic to detect differential item functioning. <em>Applied Measurement in Education, 2</em>, 1-13. doi: <a href="https://doi.org/10.1207/s15324818ame0201_1">10.1207/s15324818ame0201_1</a>
</p>
<p>Uttaro, T. and Millsap, R. E. (1994). Factors influencing the Mantel-Haenszel procedure in the detection of differential item functioning. <em>Applied Psychological Measurement, 18</em>, 15-25. doi: <a href="https://doi.org/10.1177/014662169401800102">10.1177/014662169401800102</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mantelHaenszel">mantelHaenszel</a></code>, <code><a href="#topic+dichoDif">dichoDif</a></code>, <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)

 # Excluding the "Anger" variable
 verbal &lt;- verbal[colnames(verbal) != "Anger"]

 # Three equivalent settings of the data matrix and the group membership
 r &lt;- difMH(verbal, group = 25, focal.name = 1)
 difMH(verbal, group = "Gender", focal.name = 1)
 difMH(verbal[,1:24], group = verbal[,25], focal.name = 1)

 # With log odds-ratio statistic
 r2 &lt;- difMH(verbal, group = 25, focal.name = 1, MHstat = "logOR")

 # With exact inference
 difMH(verbal, group = 25, focal.name = 1, exact = TRUE)

# Multiple comparisons adjustment using Benjamini-Hochberg method
 difMH(verbal, group = 25, focal.name = 1, p.adjust.method = "BH")

 # With item purification
 difMH(verbal, group = "Gender", focal.name = 1, purify = TRUE)
 difMH(verbal, group = "Gender", focal.name = 1, purify = TRUE, nrIter = 5)

 # Without continuity correction and with 0.01 significance level
 difMH(verbal, group = "Gender", focal.name = 1, alpha = 0.01, correct = FALSE)

 # With items 1 to 5 set as anchor items
 difMH(verbal, group = "Gender", focal.name = 1, anchor = 1:5)
 difMH(verbal, group = "Gender", focal.name = 1, anchor = 1:5, purify = TRUE)

 # Saving the output into the "MHresults.txt" file (and default path)
 r &lt;- difMH(verbal, group = 25, focal.name = 1, save.output = TRUE, 
            output = c("MHresults","default"))

 # Graphical devices
 plot(r)
 plot(r2)

 # Plotting results and saving it in a PDF figure
 plot(r, save.plot = TRUE, save.options = c("plot", "default", "pdf"))

 # Changing the path, JPEG figure
 path &lt;- "c:/Program Files/"
 plot(r, save.plot = TRUE, save.options = c("plot", path, "jpeg"))

## End(Not run)
 </code></pre>

<hr>
<h2 id='difRaju'>Raju's area DIF method</h2><span id='topic+difRaju'></span><span id='topic+plot.Raj'></span><span id='topic+print.Raj'></span>

<h3>Description</h3>

<p>Performs DIF detection using Raju's area method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>difRaju(Data, group, focal.name, model, c = NULL, engine = "ltm", discr = 1, 
 	irtParam = NULL,  same.scale = TRUE, anchor = NULL, alpha = 0.05, 
 	signed = FALSE, purify = FALSE, nrIter = 10, p.adjust.method = NULL, 
 	save.output = FALSE, output = c("out","default"))   	
## S3 method for class 'Raj'
print(x, ...)
## S3 method for class 'Raj'
plot(x, pch = 8, number = TRUE, col = "red", save.plot = FALSE, 
 	save.options = c("plot","default","pdf"), ...)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="difRaju_+3A_data">Data</code></td>
<td>
<p>numeric: either the data matrix only, or the data matrix plus the vector of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difRaju_+3A_group">group</code></td>
<td>
<p>numeric or character: either the vector of group membership or the column indicator (within <code>data</code>) of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difRaju_+3A_focal.name">focal.name</code></td>
<td>
<p>numeric or character indicating the level of <code>group</code> which corresponds to the focal group.</p>
</td></tr>
<tr><td><code id="difRaju_+3A_model">model</code></td>
<td>
<p>character: the IRT model to be fitted (either <code>"1PL"</code>, <code>"2PL"</code> or <code>"3PL"</code>).</p>
</td></tr>
<tr><td><code id="difRaju_+3A_c">c</code></td>
<td>
<p>optional numeric value or vector giving the values of the constrained pseudo-guessing parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difRaju_+3A_engine">engine</code></td>
<td>
<p>character: the engine for estimating the 1PL model, either <code>"ltm"</code> (default) or <code>"lme4"</code>.</p>
</td></tr>
<tr><td><code id="difRaju_+3A_discr">discr</code></td>
<td>
<p>either <code>NULL</code> or a real positive value for the common discrimination parameter (default is 1). Used only if <code>model</code> is <code>"1PL"</code> and
<code>engine</code> is <code>"ltm"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difRaju_+3A_irtparam">irtParam</code></td>
<td>
<p>matrix with <em>2J</em> rows (where <em>J</em> is the number of items) and at most 9 columns containing item parameters estimates. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difRaju_+3A_same.scale">same.scale</code></td>
<td>
<p>logical: are the item parameters of the <code>irtParam</code> matrix on the same scale? (default is &quot;TRUE&quot;). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difRaju_+3A_anchor">anchor</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of item names (or identifiers) to specify the anchor items. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difRaju_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="difRaju_+3A_signed">signed</code></td>
<td>
<p>logical: should the Raju's statistics be computed using the signed (<code>TRUE</code>) or unsigned (<code>FALSE</code>, default)
area? See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difRaju_+3A_purify">purify</code></td>
<td>
<p>logical: should the method be used iteratively to purify the set of anchor items? (default is FALSE).</p>
</td></tr>
<tr><td><code id="difRaju_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item purification process (default is 10).</p>
</td></tr> 
<tr><td><code id="difRaju_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>either <code>NULL</code> (default) or the acronym of the method for p-value adjustment for multiple comparisons. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difRaju_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved into a text file? (Default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difRaju_+3A_output">output</code></td>
<td>
<p>character: a vector of two components. The first component is the name of the output file, the second component is either the file path or <code>"default"</code> (default value). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difRaju_+3A_x">x</code></td>
<td>
<p>the result from a <code>Raj</code> class object.</p>
</td></tr>
<tr><td><code id="difRaju_+3A_pch">pch</code>, <code id="difRaju_+3A_col">col</code></td>
<td>
<p>type of usual <code>pch</code> and <code>col</code> graphical options.</p>
</td></tr>
<tr><td><code id="difRaju_+3A_number">number</code></td>
<td>
<p>logical: should the item number identification be printed (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="difRaju_+3A_save.plot">save.plot</code></td>
<td>
<p>logical: should the plot be saved into a separate file? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difRaju_+3A_save.options">save.options</code></td>
<td>
<p>character: a vector of three components. The first component is the name of the output file, the second component is either the file path or <code>"default"</code> (default value),
and the third component is the file extension, either <code>"pdf"</code> (default) or <code>"jpeg"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difRaju_+3A_...">...</code></td>
<td>
<p>other generic parameters for the <code>plot</code> or the <code>print</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Raju's area method (Raju, 1988, 1990) allows for detecting uniform or non-uniform differential item functioning 
by setting an appropriate item response model. The input can be of two kinds: either by displaying the full data,
the group membership and the model, or by giving the item parameter estimates (with the option <code>irtParam</code>).
Both can be supplied, but in this case only the parameters in <code>irtParam</code> are used for computing Raju's statistic.
</p>
<p>By default, the Raju's <em>Z</em> statistics are obtained by using the <em>unsigned</em> areas between the ICCs. However, these
statistics can also be computed using the <em>signed</em> areas, by setting the argument <code>signed</code> to <code>TRUE</code> (default
value is <code>FALSE</code>). See <code><a href="#topic+RajuZ">RajuZ</a></code> for further details.
</p>
<p>The <code>Data</code> is a matrix whose rows correspond to the subjects and columns to the items. In addition, <code>Data</code> can hold the vector of group membership. 
If so, <code>group</code> indicates the column of <code>Data</code> which corresponds to the group membership, either by specifying its name or by giving the column number.
Otherwise, <code>group</code> must be a vector of same length as <code>nrow(Data)</code>.
</p>
<p>Missing values are allowed for item responses (not for group membership) but must be coded as <code>NA</code> values. They are discarded for item parameter estimation.
</p>
<p>The vector of group membership must hold only two different values, either as numeric or character. The focal group is defined by
the value of the argument <code>focal.name</code>. 
</p>
<p>If the model is not the 1PL model, or if <code>engine</code> is equal to <code>"ltm"</code>, the selected IRT model is fitted using marginal maximum likelihood
by means of the functions from the <code>ltm</code> package (Rizopoulos, 2006). Otherwise, the 1PL model is fitted as a generalized 
linear mixed model, by means of the <code>glmer</code> function of the <code>lme4</code> package (Bates and Maechler, 2009).
</p>
<p>With the <code>"1PL"</code> model and the <code>"ltm"</code> engine, the common discrimination parameter is set equal to 1 by default. It is possible to fix another value
through the argument<code>discr</code>. Alternatively, this common discrimination parameter can be estimated (though not returned) by fixing <code>discr</code> to 
<code>NULL</code>.
</p>
<p>The 3PL model can be fitted either unconstrained (by setting <code>c</code> to <code>NULL</code>) or by fixing the pseudo-guessing values. In the latter 
case, the argument <code>c</code> holds either a numeric vector of same length of the number of items, with one value per item pseudo-guessing parameter, 
or a single value which is duplicated for all the items. If <code>c</code> is different from <code>NULL</code> then the 3PL model is always fitted (whatever the value of <code>model</code>).
</p>
<p>The <code>irtParam</code> matrix has a number of rows equal to twice the number of items in the data set. The first <em>J</em> rows refer to 
the item parameter estimates in the reference group, while the last <em>J</em> ones correspond to the same items in the focal group. 
The number of columns depends on the selected IRT model: 2 for the 1PL model, 5 for the 2PL model, 6 for the constrained 3PL model
and 9 for the unconstrained 3PL model. The columns of <code>irtParam</code> have to follow the same structure as the output of
<code>itemParEst</code> command (the latter can actually be used to create the <code>irtParam</code> matrix).
</p>
<p>In addition to the matrix of parameter estimates, one has to specify whether items in the focal group were rescaled to those of the 
reference group. If not, rescaling is performed by equal means anchoring (Cook and Eignor, 1991). Argument <code>same.scale</code> is used for 
this choice (default option is <code>TRUE</code> and assumes therefore that the parameters are already placed on the same scale).  
</p>
<p>The threshold (or cut-score) for classifying items as DIF is computed as the quantile of the standard normal distribution with lower-tail
probability of 1-<code>alpha</code>/2.
</p>
<p>Item purification can be performed by setting <code>purify</code> to <code>TRUE</code>. In this case, the purification occurs in the equal means anchoring process. Items 
detected as DIF are iteratively removed from the set of items used for equal means anchoring, and the procedure is repeated until either the same items
are identified twice as functioning differently, or when <code>nrIter</code> iterations have been performed. In the latter case a warning message is printed.
See Candell and Drasgow (1988) for further details.
</p>
<p>Adjustment for multiple comparisons is possible with the argument <code>p.adjust.method</code>. The latter must be an acronym of one of the available adjustment methods of the <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function. According to Kim and Oshima (2013), Holm and Benjamini-Hochberg adjustments (set respectively by <code>"Holm"</code> and <code>"BH"</code>) perform best for DIF purposes. See <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function for further details. Note that item purification is performed on original statistics and p-values; in case of adjustment for multiple comparisons this is performed <em>after</em> item purification.
</p>
<p>A pre-specified set of anchor items can be provided through the <code>anchor</code> argument. It must be a vector of either item names (which must match exactly the column names of <code>Data</code> argument) or integer values (specifying the column numbers for item identification). In case anchor items are provided, they are used to rescale the item parameters on a common metric. None of the anchor items are tested for DIF: the output separates anchor items and tested items and DIF results are returned only for the latter. Note also that item purification is not activated when anchor items are provided (even if <code>purify</code> is set to <code>TRUE</code>). By default it is <code>NULL</code> so that no anchor item is specified. If item parameters are provided thorugh the <code>irtParam</code> argument and if they are on the same scale (i.e. if <code>same.scale</code> is <code>TRUE</code>), then anchor items are not used (even if they are specified).
</p>
<p>Under the 1PL model, the displayed output also proposes an effect size measure, which is -2.35 times the difference between item difficulties of the reference group
and the focal group (Penfield and Camilli, 2007, p. 138). This effect size is similar Mantel-Haenszel's <code class="reqn">\Delta_{MH}</code> effect size, and the ETS delta scale is used 
to classify the effect sizes (Holland and Thayer, 1985).
</p>
<p>The output of the <code>difRaju</code>, as displayed by the <code>print.Raj</code> function, can be stored in a text file provided that <code>save.output</code> is set to <code>TRUE</code> 
(the default value <code>FALSE</code> does not execute the storage). In this case, the name of the text file must be given as a character string into the first component
of the <code>output</code> argument (default name is <code>"out"</code>), and the path for saving the text file can be given through the second component of <code>output</code>. The
default value is <code>"default"</code>, meaning that the file will be saved in the current working directory. Any other path can be specified as a character string: see the 
<b>Examples</b> section for an illustration.
</p>
<p>The <code>plot.Raj</code> function displays the DIF statistics in a plot, with each item on the X axis. The type of point and the color are fixed by the usual <code>pch</code> and 
<code>col</code> arguments. Option <code>number</code> permits to display the item numbers instead. Also, the plot can be stored in a figure file, either in PDF or JPEG format.
Fixing <code>save.plot</code> to <code>TRUE</code> allows this process. The figure is defined through the components of <code>save.options</code>. The first two components perform similarly 
as those of the <code>output</code> argument. The third component is the figure format, with allowed values <code>"pdf"</code> (default) for PDF file and <code>"jpeg"</code> for JPEG file.
</p>


<h3>Value</h3>

<p>A list of class &quot;Raj&quot; with the following arguments:
</p>
<table role = "presentation">
<tr><td><code>RajuZ</code></td>
<td>
<p>the values of the Raju's statistics.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-values for the Raju's statistics.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the value of <code>alpha</code> argument.</p>
</td></tr>
<tr><td><code>thr</code></td>
<td>
<p>the threshold (cut-score) for DIF detection.</p>
</td></tr>
<tr><td><code>DIFitems</code></td>
<td>
<p>either the column indicators of the items which were detected as DIF items, or &quot;No DIF item detected&quot;.</p>
</td></tr>
<tr><td><code>signed</code></td>
<td>
<p>the value of the <code>signed</code> argument.</p>
</td></tr>
<tr><td><code>p.adjust.method</code></td>
<td>
<p>the value of the <code>p.adjust.method</code> argument.</p>
</td></tr>
<tr><td><code>adjusted.p</code></td>
<td>
<p>either <code>NULL</code> or the vector of adjusted p-values for multiple comparisons.</p>
</td></tr>
<tr><td><code>purification</code></td>
<td>
<p>the value of <code>purify</code> option.</p>
</td></tr> 
<tr><td><code>nrPur</code></td>
<td>
<p>the number of iterations in the item purification process. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>difPur</code></td>
<td>
<p>a binary matrix with one row per iteration in the item purification process and one column per item. Zeros and ones in the <em>i</em>-th 
row refer to items which were classified respectively as non-DIF and DIF items at the (<em>i</em>-1)-th step. The first row corresponds to the initial
classification of the items. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>logical indicating whether the iterative item purification process stopped before the maximal number <code>nrIter</code>of allowed iterations. 
Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the value of <code>model</code> argument.</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p>The value of the <code>c</code> argument.</p>
</td></tr>
<tr><td><code>engine</code></td>
<td>
<p>The value of the <code>engine</code> argument.</p>
</td></tr>
<tr><td><code>discr</code></td>
<td>
<p>the value of the <code>discr</code> argument.</p>
</td></tr>
<tr><td><code>itemParInit</code></td>
<td>
<p>the matrix of initial parameter estimates,with the same format as <code>irtParam</code> either provided by the user (through <code>irtParam</code>) or estimated from the data
(and displayed without rescaling).</p>
</td></tr>
<tr><td><code>itemParFinal</code></td>
<td>
<p>the matrix of final parameter estimates, with the same format as <code>irtParam</code>, obtained after item purification. Returned 
only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>estPar</code></td>
<td>
<p>a logical value indicating whether the item parameters were estimated (<code>TRUE</code>) or provided by the user (<code>FALSE</code>).</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>the names of the items.</p>
</td></tr>
<tr><td><code>anchor.names</code></td>
<td>
<p>the value of the <code>anchor</code> argument.</p>
</td></tr>
<tr><td><code>save.output</code></td>
<td>
<p>the value of the <code>save.output</code> argument.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>the value of the <code>output</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Bates, D. and Maechler, M. (2009). lme4: Linear mixed-effects models using S4 classes. R package version 0.999375-31. http://CRAN.R-project.org/package=lme4
</p>
<p>Candell, G.L. and Drasgow, F. (1988). An iterative procedure for linking metrics and assessing item bias in item response theory. <em>Applied Psychological Measurement, 12</em>, 253&ndash;260. doi: <a href="https://doi.org/10.1177/014662168801200304">10.1177/014662168801200304</a> 
</p>
<p>Cook, L. L. and Eignor, D. R. (1991). An NCME instructional module on IRT equating methods. <em>Educational Measurement: Issues and Practice, 10</em>, 37-45.
</p>
<p>Holland, P. W. and Thayer, D. T. (1985). An alternative definition of the ETS delta scale of item difficulty. <em>Research Report RR-85-43</em>. Princeton, NJ:
Educational Testing Service.
</p>
<p>Kim, J., and Oshima, T. C. (2013). Effect of multiple testing adjustment in differential item functioning detection. <em>Educational and Psychological Measurement, 73</em>, 458&ndash;470. doi: <a href="https://doi.org/10.1177/0013164412467033">10.1177/0013164412467033</a>
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Penfield, R. D., and Camilli, G. (2007). Differential item functioning and item bias. In C. R. Rao and S. Sinharray (Eds.), <em>Handbook of Statistics 26: Psychometrics</em>
(pp. 125-167). Amsterdam, The Netherlands: Elsevier.
</p>
<p>Raju, N.S. (1988). The area between two item characteristic curves. <em>Psychometrika, 53</em>, 495-502. doi: <a href="https://doi.org/10.1007/BF02294403">10.1007/BF02294403</a>
</p>
<p>Raju, N. S. (1990). Determining the significance of estimated signed and unsigned areas between two item response functions. <em>Applied Psychological Measurement, 14</em>, 197-207. doi: <a href="https://doi.org/10.1177/014662169001400208">10.1177/014662169001400208</a>
</p>
<p>Rizopoulos, D. (2006). ltm: An R package for latent variable modelling and item response theory analyses. <em>Journal of Statistical Software, 17</em>, 1-25. doi: <a href="https://doi.org/10.18637/jss.v017.i05">10.18637/jss.v017.i05</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+RajuZ">RajuZ</a></code>, <code><a href="#topic+itemParEst">itemParEst</a></code>, <code><a href="#topic+dichoDif">dichoDif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Excluding the "Anger" variable
 verbal&lt;-verbal[colnames(verbal)!="Anger"]

 # Three equivalent settings of the data matrix and the group membership
 # (1PL model, "ltm" engine) 
 difRaju(verbal, group = 25, focal.name = 1, model = "1PL")
 difRaju(verbal, group = "Gender", focal.name = 1, model = "1PL")
 difRaju(verbal[,1:24], group = verbal[,25], focal.name = 1, model = "1PL")

 # Multiple comparisons adjustment using Benjamini-Hochberg method
 difRaju(verbal, group = 25, focal.name = 1, model = "1PL", p.adjust.method = "BH")

 # With signed areas
 difRaju(verbal, group = 25, focal.name = 1, model = "1PL", signed = TRUE)

 # With items 1 to 5 set as anchor items
 difRaju(verbal, group = 25, focal.name = 1, model = "1PL", anchor = 1:5)

 # (1PL model, "lme4" engine) 
 difRaju(verbal, group = "Gender", focal.name = 1, model = "1PL",
 engine = "lme4")

 # 2PL model, signed and unsigned areas
 difRaju(verbal, group = "Gender", focal.name = 1, model = "2PL")
 difRaju(verbal, group = "Gender", focal.name = 1, model = "2PL", signed = TRUE)

 # 3PL model with all pseudo-guessing parameters constrained to 0.05
 # Signed and unsigned areas
 difRaju(verbal, group = "Gender", focal.name = 1, model = "3PL", c = 0.05)
 difRaju(verbal, group = "Gender", focal.name = 1, model = "3PL", c = 0.05,
   signed = TRUE)
 
 # Same models, with item purification
 difRaju(verbal, group = "Gender", focal.name = 1, model = "1PL", purify = TRUE)
 difRaju(verbal, group = "Gender", focal.name = 1, model = "2PL", purify = TRUE)
 difRaju(verbal, group = "Gender", focal.name = 1, model = "3PL", c = 0.05,
 purify = TRUE)

 # With signed areas
 difRaju(verbal, group = "Gender", focal.name = 1, model = "1PL", purify = TRUE,
   signed = TRUE)
 difRaju(verbal, group = "Gender", focal.name = 1, model = "2PL", purify = TRUE,
   signed = TRUE)
 difRaju(verbal, group = "Gender", focal.name = 1, model = "3PL", c = 0.05,
 purify = TRUE, signed = TRUE)

 ## Splitting the data into reference and focal groups
 nF&lt;-sum(Gender)
 nR&lt;-nrow(verbal)-nF
 data.ref&lt;-verbal[,1:24][order(Gender),][1:nR,]
 data.focal&lt;-verbal[,1:24][order(Gender),][(nR+1):(nR+nF),]

 ## Pre-estimation of the item parameters (1PL model, "ltm" engine)
 item.1PL&lt;-rbind(itemParEst(data.ref,model = "1PL"),
 itemParEst(data.focal,model = "1PL"))
 difRaju(irtParam = item.1PL,same.scale = FALSE)

 ## Pre-estimation of the item parameters (1PL model, "lme4" engine)
 item.1PL&lt;-rbind(itemParEst(data.ref, model = "1PL", engine = "lme4"),
 itemParEst(data.focal, model = "1PL", engine = "lme4"))
 difRaju(irtParam = item.1PL, same.scale = FALSE)

 ## Pre-estimation of the item parameters (2PL model)
 item.2PL&lt;-rbind(itemParEst(data.ref, model = "2PL"),
 itemParEst(data.focal, model = "2PL"))
 difRaju(irtParam = item.2PL, same.scale = FALSE)

 ## Pre-estimation of the item parameters (constrained 3PL model)
 item.3PL&lt;-rbind(itemParEst(data.ref, model = "3PL", c = 0.05),
 itemParEst(data.focal, model = "3PL", c = 0.05))
 difRaju(irtParam = item.3PL, same.scale = FALSE)

 # Saving the output into the "RAJUresults.txt" file (and default path)
 r &lt;- difRaju(verbal, group = 25, focal.name = 1, model = "1PL",
          save.output = TRUE, output = c("RAJUresults","default"))

 # Graphical devices
 plot(r)

 # Plotting results and saving it in a PDF figure
 plot(r, save.plot = TRUE, save.options = c("plot", "default", "pdf"))

 # Changing the path, JPEG figure
 path &lt;- "c:/Program Files/"
 plot(r, save.plot = TRUE, save.options = c("plot", path, "jpeg"))

## End(Not run)
 </code></pre>

<hr>
<h2 id='difSIBTEST'>SIBTEST and Crossing-SIBTEST DIF method</h2><span id='topic+difSIBTEST'></span><span id='topic+print.SIBTEST'></span><span id='topic+plot.SIBTEST'></span>

<h3>Description</h3>

<p>Performs DIF detection using SIBTEST (Shealy and Stout, 1993) or the modified Crossing-SIBTEST method (Chalmers, 2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>difSIBTEST(Data, group, focal.name, type = "udif", anchor = NULL, alpha = 0.05,
  	purify = FALSE, nrIter = 10, p.adjust.method = NULL,
  	save.output = FALSE, output = c("out", "default"))
## S3 method for class 'SIBTEST'
print(x, ...)
## S3 method for class 'SIBTEST'
plot(x, pch = 8, number = TRUE, col = "red", save.plot = FALSE,
  	save.options = c("plot", "default", "pdf"), ...)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="difSIBTEST_+3A_data">Data</code></td>
<td>
<p>numeric: either the data matrix only, or the data matrix plus the vector of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difSIBTEST_+3A_group">group</code></td>
<td>
<p>numeric or character: either the vector of group membership or the column indicator (within <code>data</code>) of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difSIBTEST_+3A_focal.name">focal.name</code></td>
<td>
<p>numeric or character indicating the level of <code>group</code> which corresponds to the focal group.</p>
</td></tr>
<tr><td><code id="difSIBTEST_+3A_type">type</code></td>
<td>
<p>character: the type of DIF effect to test. Possible values are <code>"udif"</code> (default) for uniform DIF using SIBTEST, or <code>"nudif"</code> for nonuniform DIF using Crossing-SIBTEST (CSIBTEST).</p>
</td></tr>
<tr><td><code id="difSIBTEST_+3A_anchor">anchor</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of item names (or identifiers) to specify the anchor items. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difSIBTEST_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="difSIBTEST_+3A_purify">purify</code></td>
<td>
<p>logical: should the method be used iteratively to purify the set of anchor items? (default is FALSE).</p>
</td></tr>
<tr><td><code id="difSIBTEST_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item purification process (default is 10).</p>
</td></tr>
<tr><td><code id="difSIBTEST_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>either <code>NULL</code> (default) or the acronym of the method for p-value adjustment for multiple comparisons. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difSIBTEST_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved into a text file? (Default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difSIBTEST_+3A_output">output</code></td>
<td>
<p>character: a vector of two components. The first component is the name of the output file, the second component is either the file path or <code>"default"</code> (default value). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difSIBTEST_+3A_x">x</code></td>
<td>
<p>the result from a <code>SIBTEST</code> class object.</p>
</td></tr>
<tr><td><code id="difSIBTEST_+3A_pch">pch</code>, <code id="difSIBTEST_+3A_col">col</code></td>
<td>
<p>type of usual <code>pch</code> and <code>col</code> graphical options.</p>
</td></tr>
<tr><td><code id="difSIBTEST_+3A_number">number</code></td>
<td>
<p>logical: should the item number identification be printed (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="difSIBTEST_+3A_save.plot">save.plot</code></td>
<td>
<p>logical: should the plot be saved into a separate file? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difSIBTEST_+3A_save.options">save.options</code></td>
<td>
<p>character: a vector of three components. The first component is the name of the output file, the second component is either the file path or <code>"default"</code> (default value), and the third component is the file extension, either <code>"pdf"</code> (default) or <code>"jpeg"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difSIBTEST_+3A_...">...</code></td>
<td>
<p>other generic parameters for the <code>plot</code> or the <code>print</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The SIBTEST method (Shealy and Stout, 1993) allows for detecting uniform differential item functioning without requiring an item response model approach. Its modified version, the Crossing-SIBTEST (Chalmers, 2018; Li and Stout, 1996), focuses on nonuniform DIF instead. This function provides a wrapper to the <code><a href="mirt.html#topic+SIBTEST">SIBTEST</a></code> function from the <b>mirt</b> package (Chalmers, 2012) to fit within the <code>difR</code> framework (Magis et al., 2010). Therefore, if you are using this function for publication purposes please cite Chalmers (2018; 2012) and Magis et al. (2010).
</p>
<p>The <code>Data</code> is a matrix whose rows correspond to the subjects and columns to the items. In addition, <code>Data</code> can hold the vector of group membership. If so, <code>group</code> indicates the column of <code>Data</code> which corresponds to the group membership, either by specifying its name or by giving the column number. Otherwise, <code>group</code> must be a vector of same length as <code>nrow(Data)</code>.
</p>
<p>The vector of group membership must hold only two different values, either as numeric or character. The focal group is defined by the value of the argument <code>focal.name</code>.
</p>
<p>The type of DIF effect, uniform through SIBTEST or nonuniform through Crossing-SIBTEST, is determined by the <code>type</code> argument. By default it is <code>"udif"</code> for uniform DIF, and may take the value <code>"nudif"</code> for nonuniform DIF.
</p>
<p>The threshold (or cut-score) for classifying items as DIF is computed as the quantile of the chi-square distribution with lower-tail probability of one minus <code>alpha</code> and with one degree of freedom. Note that the degrees of freedom are also returned by the <code>df</code> argument.
</p>
<p>Item purification can be performed by setting <code>purify</code> to <code>TRUE</code>. Purification works as follows: if at least one item was detected as functioning differently at some step of the process, then the data set of the next step consists in all items that are currently anchor (DIF free) items, plus the
tested item (if necessary). The process stops when either two successive applications of the method yield the same classifications of the items (Clauser and Mazor, 1998), or when <code>nrIter</code> iterations are run without obtaining two successive identical classifications. In the latter case a warning message is printed.
</p>
<p>Adjustment for multiple comparisons is possible with the argument <code>p.adjust.method</code>. The latter must be an acronym of one of the available adjustment methods of the <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function. According to Kim and Oshima (2013), Holm and Benjamini-Hochberg adjustments (set respectively by <code>"Holm"</code> and <code>"BH"</code>) perform best for DIF purposes. See <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function for further details. Note that item purification is performed on original statistics and p-values; in case of adjustment for multiple comparisons this is performed <em>after</em> item purification.
</p>
<p>A pre-specified set of anchor items can be provided through the <code>anchor</code> argument. It must be a vector of either item names (which must match exactly the column names of <code>Data</code> argument) or integer values (specifying the column numbers for item identification). In case anchor items are provided, they are used to compute the test score (matching criterion), including also the tested item. None of the anchor items are tested for DIF: the output separates anchor items and tested items and DIF results are returned only for the latter. Note also that item purification is not activated when anchor items are provided (even if <code>purify</code> is set to <code>TRUE</code>). By default it is <code>NULL</code> so that no anchor item is specified.
</p>
<p>The output of the <code>difSIBTEST</code>, as displayed by the <code>print.SIBTEST</code> function, can be stored in a text file provided that <code>save.output</code> is set to <code>TRUE</code>
(the default value <code>FALSE</code> does not execute the storage). In this case, the name of the text file must be given as a character string into the first component
of the <code>output</code> argument (default name is <code>"out"</code>), and the path for saving the text file can be given through the second component of <code>output</code>. The default value is <code>"default"</code>, meaning that the file will be saved in the current working directory. Any other path can be specified as a character string: see the <b>Examples</b> section for an illustration.
</p>
<p>The <code>plot.SIBTEST</code> function displays the DIF statistics in a plot, with each item on the X axis. The type of point and the color are fixed by the usual <code>pch</code> and <code>col</code> arguments. Option <code>number</code> permits to display the item numbers instead. Also, the plot can be stored in a figure file, either in PDF or JPEG format. Fixing <code>save.plot</code> to <code>TRUE</code> allows this process. The figure is defined through the components of <code>save.options</code>. The first two components perform similarly as those of the <code>output</code> argument. The third component is the figure format, with allowed values <code>"pdf"</code> (default) for PDF file and
<code>"jpeg"</code> for JPEG file. Note that no plot is returned for exact inference.
</p>


<h3>Value</h3>

<p>A list of class &quot;SIBTEST&quot; with the following arguments:
</p>
<table role = "presentation">
<tr><td><code>Beta</code></td>
<td>
<p>the values of the SIBTEST Beta values.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>the standard errors of the Beta values.</p>
</td></tr>
<tr><td><code>X2</code></td>
<td>
<p>the values of the SIBTEST or Crossing-SITBTEST chi-square statistics.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the degrees of freedom for <code>X2</code> statistics.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-values for the SIBTEST or Crossing-SIBTEST statistics.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>the value of the <code>type</code> argument.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the value of <code>alpha</code> argument.</p>
</td></tr>
<tr><td><code>DIFitems</code></td>
<td>
<p>either the column indicators of the items which were detected as DIF items, or &quot;No DIF item detected&quot;.</p>
</td></tr>
<tr><td><code>p.adjust.method</code></td>
<td>
<p>the value of the <code>p.adjust.method</code> argument.</p>
</td></tr>
<tr><td><code>adjusted.p</code></td>
<td>
<p>either <code>NULL</code> or the vector of adjusted p-values for multiple comparisons.</p>
</td></tr>
<tr><td><code>purification</code></td>
<td>
<p>the value of <code>purify</code> option.</p>
</td></tr>
<tr><td><code>nrPur</code></td>
<td>
<p>the number of iterations in the item purification process. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>difPur</code></td>
<td>
<p>a binary matrix with one row per iteration in the item purification process and one column per item. Zeros and ones in the <em>i</em>-th row refer to items which were classified respectively as non-DIF and DIF items at the (<em>i</em>-1)-th step. The first row corresponds to the initial classification of the items. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>logical indicating whether the iterative item purification process stopped before the maximal number <code>nrIter</code> of allowed iterations. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>the names of the items or <code>NULL</code> if the items have no name.</p>
</td></tr>
<tr><td><code>anchor.names</code></td>
<td>
<p>the value of the <code>anchor</code> argument.</p>
</td></tr>
<tr><td><code>save.output</code></td>
<td>
<p>the value of the <code>save.output</code> argument.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>the value of the <code>output</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
</p>


<h3>References</h3>

<p>Chalmers, R. P. (2012). mirt: A Multidimensional item response
theory package for the R environment. <em>Journal of Statistical Software, 48(6)</em>, 1-29. doi: <a href="https://doi.org/10.18637/jss.v048.i06">10.18637/jss.v048.i06</a>
</p>
<p>Chalmers, R. P. (2018). Improving the Crossing-SIBTEST statistic for detecting non-uniform DIF. <em>Psychometrika, 83</em>(2), 376&ndash;386. doi: <a href="https://doi.org/10.1007/s11336-017-9583-8">10.1007/s11336-017-9583-8</a>
</p>
<p>Kim, J., and Oshima, T. C. (2013). Effect of multiple testing adjustment in differential item functioning detection. <em>Educational and Psychological Measurement, 73</em>, 458&ndash;470. doi: <a href="https://doi.org/10.1177/0013164412467033">10.1177/0013164412467033</a>
</p>
<p>Li, H.-H., and Stout, W. (1996). A new procedure for detection of crossing DIF. <em>Psychometrika, 61</em>, 647&ndash;677. doi: <a href="https://doi.org/10.1007/BF02294041">10.1007/BF02294041</a>
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Shealy, R. and Stout, W. (1993). A model-based standardization approach that separates true bias/DIF from group ability differences and detect test bias/DTF as well as item bias/DIF. <em>Psychometrika, 58</em>, 159-194. doi: <a href="https://doi.org/10.1007/BF02294572">10.1007/BF02294572</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sibTest">sibTest</a></code>, <code><a href="#topic+dichoDif">dichoDif</a></code>, <code><a href="stats.html#topic+p.adjust">p.adjust</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)

 # Excluding the "Anger" variable
 verbal &lt;- verbal[colnames(verbal) != "Anger"]

 # Three equivalent settings of the data matrix and the group membership
 r &lt;- difSIBTEST(verbal, group = 25, focal.name = 1)
 difSIBTEST(verbal, group = "Gender", focal.name = 1)
 difSIBTEST(verbal[,1:24], group = verbal[,25], focal.name = 1)

 # Test for nonuniform DIF
 difSIBTEST(verbal, group = 25, focal.name = 1, type = "nudif")

 # Multiple comparisons adjustment using Benjamini-Hochberg method
 difSIBTEST(verbal, group = 25, focal.name = 1, p.adjust.method = "BH")

 # With item purification
 difSIBTEST(verbal, group = 25, focal.name = 1, purify = TRUE)
 r2 &lt;- difSIBTEST(verbal, group = 25, focal.name = 1, purify = TRUE, nrIter = 5)

 # With items 1 to 5 set as anchor items
 difSIBTEST(verbal, group = "Gender", focal.name = 1, anchor = 1:5)
 difSIBTEST(verbal, group = "Gender", focal.name = 1, anchor = 1:5, purify = TRUE)

 # Saving the output into the "SIBresults.txt" file (and default path)
 r &lt;- difSIBTEST(verbal, group = 25, focal.name = 1, save.output = TRUE,
            output = c("SIBresults","default"))

 # Graphical devices
 plot(r)
 plot(r2)

 # Plotting results and saving it in a PDF figure
 plot(r, save.plot = TRUE, save.options = c("plot", "default", "pdf"))

 # Changing the path, JPEG figure
 path &lt;- "c:/Program Files/"
 plot(r, save.plot = TRUE, save.options = c("plot", path, "jpeg"))

## End(Not run)
 </code></pre>

<hr>
<h2 id='difStd'>Standardization DIF method</h2><span id='topic+difStd'></span><span id='topic+plot.PDIF'></span><span id='topic+print.PDIF'></span>

<h3>Description</h3>

<p>Performs DIF detection using standardization method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>difStd(Data, group, focal.name, anchor = NULL, match = "score", 
  	stdWeight = "focal", thrSTD = 0.1, purify = FALSE, nrIter = 10, 
  	save.output = FALSE, output = c("out", "default"))
## S3 method for class 'PDIF'
print(x, ...)
## S3 method for class 'PDIF'
plot(x, pch = 8, number = TRUE, col = "red", save.plot = FALSE, 
  	save.options = c("plot", "default", "pdf"), ...)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="difStd_+3A_data">Data</code></td>
<td>
<p>numeric: either the data matrix only, or the data matrix plus the vector of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difStd_+3A_group">group</code></td>
<td>
<p>numeric or character: either the vector of group membership or the column indicator (within <code>data</code>) of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difStd_+3A_focal.name">focal.name</code></td>
<td>
<p>numeric or character indicating the level of <code>group</code> which corresponds to the focal group.</p>
</td></tr>
<tr><td><code id="difStd_+3A_anchor">anchor</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of item names (or identifiers) to specify the anchor items. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difStd_+3A_match">match</code></td>
<td>
<p>specifies the type of matching criterion. Can be either <code>"score"</code> (default) to compute the test score, or any continuous or discrete variable with the same length as the number of rows of <code>Data</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difStd_+3A_stdweight">stdWeight</code></td>
<td>
<p>character: the type of weights used for the standardized P-DIF statistic. Possible values are <code>"focal"</code> (default),
<code>"reference"</code> and <code>"total"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difStd_+3A_thrstd">thrSTD</code></td>
<td>
<p>numeric: the threshold (cut-score) for standardized P-DIF statistic (default is 0.10).</p>
</td></tr>
<tr><td><code id="difStd_+3A_purify">purify</code></td>
<td>
<p>logical: should the method be used iteratively to purify the set of anchor items? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difStd_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item purification process (default is 10).</p>
</td></tr>
<tr><td><code id="difStd_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved into a text file? (Default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difStd_+3A_output">output</code></td>
<td>
<p>character: a vector of two components. The first component is the name of the output file, the second component is either the file path or
<code>"default"</code> (default value). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difStd_+3A_x">x</code></td>
<td>
<p>the result from a <code>PDIF</code> class object.</p>
</td></tr>
<tr><td><code id="difStd_+3A_pch">pch</code>, <code id="difStd_+3A_col">col</code></td>
<td>
<p>type of usual <code>pch</code> and <code>col</code> graphical options.</p>
</td></tr>
<tr><td><code id="difStd_+3A_number">number</code></td>
<td>
<p>logical: should the item number identification be printed (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="difStd_+3A_save.plot">save.plot</code></td>
<td>
<p>logical: should the plot be saved into a separate file? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difStd_+3A_save.options">save.options</code></td>
<td>
<p>character: a vector of three components. The first component is the name of the output file, the second component is either the file path
or <code>"default"</code> (default value), and the third component is the file extension, either <code>"pdf"</code> (default) or <code>"jpeg"</code>.
See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difStd_+3A_...">...</code></td>
<td>
<p>other generic parameters for the <code>plot</code> or the <code>print</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method of standardization (Dorans and Kulick, 1986) allows for detecting uniform differential item functioning 
without requiring an item response model approach.
</p>
<p>The <code>Data</code> is a matrix whose rows correspond to the subjects and columns to the items. In addition, <code>Data</code> can hold the vector of group membership. 
If so, <code>group</code> indicates the column of <code>Data</code> which corresponds to the group membership, either by specifying its name or by giving the column number.
Otherwise, <code>group</code> must be a vector of same length as <code>nrow(Data)</code>.
</p>
<p>Missing values are allowed for item responses (not for group membership) but must be coded as <code>NA</code> values. They are discarded from sum-score computation.
</p>
<p>The vector of group membership must hold only two different values, either as numeric or character. The focal group is defined by
the value of the argument <code>focal.name</code>. 
</p>
<p>The matching criterion can be either the test score or any other continuous or discrete variable to be passed in the <code><a href="#topic+stdPDIF">stdPDIF</a></code> function. This is specified by the <code>match</code> argument. By default, it takes the value <code>"score"</code> and the test score (i.e. raw score) is computed. The second option is to assign to <code>match</code> a vector of continuous or discrete numeric values, which acts as the matching criterion. Note that for consistency this vector should not belong to the <code>Data</code> matrix.
</p>
<p>The threshold (or cut-score) for classifying items as DIF has to be set by the user by the argument <code>thrSTD</code>. Default value is 0.10 
but Dorans (1989) also recommends value 0.05. For this reason it is not possible to provide asymptotic <em>p</em>-values.
</p>
<p>The weights for computing the standardized P-DIF statistics are defined through the argument <code>stdWeight</code>, with possible values
<code>"focal"</code> (default value), <code>"reference"</code> and <code>"total"</code>. See <code><a href="#topic+stdPDIF">stdPDIF</a></code> for further details.
</p>
<p>In addition, two types of effect sizes are displayed. The first one is obtained from the standardized P-DIF statistic itself.
According to Dorans, Schmitt and Bleistein (1992), the effect size of an item is classified as negligible if <code class="reqn">|St-P-DIF| \leq 0.05</code>,
moderate if <code class="reqn">0.05 \leq |St-P-DIF| \leq 0.10</code>, and large if if <code class="reqn">|St-P-DIF| \geq 0.10</code>. The second one is based on the transformation
to the ETS Delta Scale (Holland and Thayer, 1985) of the standardized 'alpha' values (Dorans, 1989; Holland, 1985). The values of the 
effect sizes, together with the Dorans, Schmitt and Bleistein (DSB) and the ETS Delta scale (ETS) classification, are printed with the output.
</p>
<p>Item purification can be performed by setting <code>purify</code> to <code>TRUE</code>. Purification works as follows: if at least one item was detected as functioning 
differently at some step of the process, then the data set of the next step consists in all items that are currently anchor (DIF free) items, plus the 
tested item (if necessary). The process stops when either two successive applications of the method yield the same classifications of the items (Clauser and Mazor,
1998), or when <code>nrIter</code> iterations are run without obtaining two successive identical classifications. In the latter case a warning message is printed. 
</p>
<p>A pre-specified set of anchor items can be provided through the <code>anchor</code> argument. It must be a vector of either item names (which must match exactly the column names of <code>Data</code> argument) or integer values (specifying the column numbers for item identification). In case anchor items are provided, they are used to compute the test score (matching criterion), including also the tested item. None of the anchor items are tested for DIF: the output separates anchor items and tested items and DIF results are returned only for the latter. Note also that item purification is not activated when anchor items are provided (even if <code>purify</code> is set to <code>TRUE</code>). By default it is <code>NULL</code> so that no anchor item is specified.
</p>
<p>The output of the <code>difStd</code>, as displayed by the <code>print.PDIF</code> function, can be stored in a text file provided that <code>save.output</code> is set to <code>TRUE</code> 
(the default value <code>FALSE</code> does not execute the storage). In this case, the name of the text file must be given as a character string into the first component
of the <code>output</code> argument (default name is <code>"out"</code>), and the path for saving the text file can be given through the second component of <code>output</code>. The
default value is <code>"default"</code>, meaning that the file will be saved in the current working directory. Any other path can be specified as a character string: see
the <b>Examples</b> section for an illustration.
</p>
<p>The <code>plot.PDIF</code> function displays the DIF statistics in a plot, with each item on the X axis. The type of point and the color are fixed by the usual <code>pch</code>
and <code>col</code> arguments. Option <code>number</code> permits to display the item numbers instead. Also, the plot can be stored in a figure file, either in PDF or JPEG
format. Fixing <code>save.plot</code> to <code>TRUE</code> allows this process. The figure is defined through the components of <code>save.options</code>. The first two components
perform similarly as those of the <code>output</code> argument. The third component is the figure format, with allowed values <code>"pdf"</code> (default) for PDF file and
<code>"jpeg"</code> for JPEG file.
</p>


<h3>Value</h3>

<p>A list of class &quot;PDIF&quot; with the following arguments:
</p>
<table role = "presentation">
<tr><td><code>PDIF</code></td>
<td>
<p>the values of the standardized P-DIF statistics.</p>
</td></tr>
<tr><td><code>stdAlpha</code></td>
<td>
<p>the values of the standardized alpha values (for effect sizes computation).</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the value of <code>alpha</code> argument.</p>
</td></tr>
<tr><td><code>thr</code></td>
<td>
<p>the value of the <code>thrSTD</code> argument.</p>
</td></tr>
<tr><td><code>DIFitems</code></td>
<td>
<p>either the column indicators of the items which were detected as DIF items, or &quot;No DIF item detected&quot;.</p>
</td></tr>
<tr><td><code>match</code></td>
<td>
<p>a character string, either <code>"score"</code> or <code>"matching variable"</code> depending on the <code>match</code> argument.</p>
</td></tr>
<tr><td><code>purification</code></td>
<td>
<p>the value of <code>purify</code> option.</p>
</td></tr> 
<tr><td><code>nrPur</code></td>
<td>
<p>the number of iterations in the item purification process. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>difPur</code></td>
<td>
<p>a binary matrix with one row per iteration in the item purification process and one column per item. Zeros and ones in the <em>i</em>-th 
row refer to items which were classified respectively as non-DIF and DIF items at the (<em>i</em>-1)-th step. The first row corresponds to the initial
classification of the items. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>logical indicating whether the iterative item purification process stopped before the maximal number <code>nrIter</code> of allowed iterations. 
Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>the names of the items.</p>
</td></tr>
<tr><td><code>anchor.names</code></td>
<td>
<p>the value of the <code>anchor</code> argument.</p>
</td></tr>
<tr><td><code>stdWeight</code></td>
<td>
<p>the value of the <code>stdWeight</code> argument.</p>
</td></tr>
<tr><td><code>save.output</code></td>
<td>
<p>the value of the <code>save.output</code> argument.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>the value of the <code>output</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Clauser, B.E. and Mazor, K.M. (1998). Using statistical procedures to identify differential item functioning test items. <em>Educational Measurement: Issues and
Practice, 17</em>, 31-44. 
</p>
<p>Dorans, N. J. (1989). Two new approaches to assessing differential item functioning. Standardization and the Mantel-Haenszel method. <em>Applied Measurement in
Education, 2</em>, 217-233. doi: <a href="https://doi.org/10.1207/s15324818ame0203_3">10.1207/s15324818ame0203_3</a>
</p>
<p>Dorans, N. J. and Kulick, E. (1986). Demonstrating the utility of the standardization approach to assessing unexpected differential item performance on the Scholastic Aptitude Test. <em>Journal of Educational Measurement, 23</em>, 355-368. doi: <a href="https://doi.org/10.1111/j.1745-3984.1986.tb00255.x">10.1111/j.1745-3984.1986.tb00255.x</a>
</p>
<p>Dorans, N. J., Schmitt, A. P. and Bleistein, C. A. (1992). The standardization approach to assessing comprehensive differential item functioning. <em>Journal of Educational Measurement, 29</em>,
309-319. doi: <a href="https://doi.org/10.1111/j.1745-3984.1992.tb00379.x">10.1111/j.1745-3984.1992.tb00379.x</a>
</p>
<p>Holland, P. W. (1985, October). <em>On the study of differential item performance without IRT</em>. Paper presented at the meeting of Military Testing Association, San Diego (CA). 
</p>
<p>Holland, P. W. and Thayer, D. T. (1985). An alternative definition of the ETS delta scale of item difficulty. <em>Research Report RR-85-43</em>. Princeton,
NJ: Educational Testing Service.
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stdPDIF">stdPDIF</a></code>, <code><a href="#topic+dichoDif">dichoDif</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)

 # Excluding the "Anger" variable
 verbal&lt;-verbal[colnames(verbal) != "Anger"]

 # Three equivalent settings of the data matrix and the group membership
 difStd(verbal, group = 25, focal.name = 1)
 difStd(verbal, group = "Gender", focal.name = 1)
 difStd(verbal[,1:24], group = verbal[,25], focal.name = 1)

 # With other weights
 difStd(verbal, group = "Gender", focal.name = 1, stdWeight = "reference")
 difStd(verbal, group = "Gender", focal.name = 1, stdWeight = "total")
 
 # With item purification
 difStd(verbal, group = "Gender", focal.name = 1, purify = TRUE)
 difStd(verbal, group = "Gender", focal.name = 1, purify = TRUE, nrIter = 5)

 # With items 1 to 5 set as anchor items
 difStd(verbal, group = "Gender", focal.name = 1, anchor = 1:5)
 difStd(verbal, group = "Gender", focal.name = 1, anchor = 1:5, purify = TRUE)


 # With detection threshold of 0.05
 difStd(verbal, group = "Gender", focal.name = 1, thrSTD = 0.05)

 # Saving the output into the "STDresults.txt" file (and default path)
 r &lt;- difStd(verbal, group = 25, focal.name = 1, save.output  =  TRUE, 
            output = c("STDresults","default"))

 # Graphical devices
 plot(r)

 # Plotting results and saving it in a PDF figure
 plot(r, save.plot = TRUE, save.options = c("plot", "default", "pdf"))

 # Changing the path, JPEG figure
 path &lt;- "c:/Program Files/"
 plot(r, save.plot = TRUE, save.options = c("plot", path, "jpeg"))

## End(Not run)
 </code></pre>

<hr>
<h2 id='difTID'>Transformed Item Difficulties (TID) DIF method</h2><span id='topic+difTID'></span><span id='topic+print.TID'></span><span id='topic+plot.TID'></span>

<h3>Description</h3>

<p>Performs DIF detection using Transformed Item Difficulties (TID) method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>difTID(Data, group, focal.name, thrTID = 1.5, purify = FALSE, purType = "IPP1", 
  	nrIter = 10, alpha = 0.05, extreme = "constraint", 
  	const.range = c(0.001, 0.999), nrAdd = 1, save.output = FALSE, 
  	output = c("out", "default"))  
## S3 method for class 'TID'
print(x, only.final = TRUE, ...)
## S3 method for class 'TID'
plot(x, plot = "dist",pch = 2, pch.mult = 17, axis.draw = TRUE, 
  	thr.draw = FALSE, dif.draw = c(1, 3), print.corr = FALSE, xlim = NULL, 
  	ylim = NULL, xlab = NULL, ylab = NULL, main = NULL, col = "red", 
  	number = TRUE, save.plot = FALSE, save.options = c("plot", 
  	"default", "pdf"), ...)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="difTID_+3A_data">Data</code></td>
<td>
<p>numeric: either the data matrix only, or the data matrix plus the vector of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difTID_+3A_group">group</code></td>
<td>
<p>numeric or character: either the vector of group membership or the column indicator (within <code>Data</code>) of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difTID_+3A_focal.name">focal.name</code></td>
<td>
<p>numeric or character indicating the level of <code>group</code> which corresponds to the focal group.</p>
</td></tr>
<tr><td><code id="difTID_+3A_thrtid">thrTID</code></td>
<td>
<p>either the threshold for detecting DIF items (default is 1.5) or <code>"norm"</code>.</p>
</td></tr>
<tr><td><code id="difTID_+3A_purify">purify</code></td>
<td>
<p>logical: should the method be used iteratively to purify the set of anchor items? (default is FALSE).</p>
</td></tr>
<tr><td><code id="difTID_+3A_purtype">purType</code></td>
<td>
<p>character: the type of purification process to be run. Possible values are <code>"IPP1"</code> (default), <code>"IPP2"</code> and <code>"IPP3"</code>. Ignored if <code>purify</code> is <code>FALSE</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difTID_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item purification process (default is 10).</p>
</td></tr>
<tr><td><code id="difTID_+3A_alpha">alpha</code></td>
<td>
<p>numeric: the significance level for calculating the detection threshold (default is 0.05). Ignored if <code>thrTID</code> is numeric.</p>
</td></tr>
<tr><td><code id="difTID_+3A_extreme">extreme</code></td>
<td>
<p>character: the method used to modify the extreme proportions. Possible values are <code>"constraint"</code> (default) or <code>"add"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difTID_+3A_const.range">const.range</code></td>
<td>
<p>numeric: a vector of two constraining proportions. Default values are 0.001 and 0.999. Ignored if <code>extreme</code> is <code>"add"</code>.</p>
</td></tr>
<tr><td><code id="difTID_+3A_nradd">nrAdd</code></td>
<td>
<p>integer: the number of successes and the number of failures to add to the data in order to adjust the proportions. Default value is 1. Ignored if <code>extreme</code> is <code>"constraint"</code>.</p>
</td></tr>
<tr><td><code id="difTID_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved into a text file? (Default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difTID_+3A_output">output</code></td>
<td>
<p>character: a vector of two components. The first component is the name of the output file, the second component is either the file path or <code>"default"</code> (default value). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difTID_+3A_x">x</code></td>
<td>
<p>the result from a <code>TID</code> class object.</p>
</td></tr>
<tr><td><code id="difTID_+3A_only.final">only.final</code></td>
<td>
<p>logical: should only the first and last steps of the purification process be printed? (default is <code>TRUE</code>. If <code>FALSE</code> all perpendicular distances, parameters of the major axis, and detection thresholds are printed additionally. Ignored if <code>purify</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="difTID_+3A_plot">plot</code></td>
<td>
<p>character: either <code>"dist"</code> (default) to display the perpendicular distances, or <code>"delta"</code> for the Delta plot. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difTID_+3A_pch">pch</code></td>
<td>
<p>integer: the usual point character type for point display. Default value is 2, that is, Delta points are
drawn as empty triangles.</p>
</td></tr>
<tr><td><code id="difTID_+3A_pch.mult">pch.mult</code></td>
<td>
<p>integer: the type of point to be used for superposing onto Delta points that correspond to several items. Default value is 17, that is, full black traingles are drawn onto existing Delta plots wherein multiple items are located.</p>
</td></tr>
<tr><td><code id="difTID_+3A_axis.draw">axis.draw</code></td>
<td>
<p>logical: should the major axis be drawn? (default is <code>TRUE</code>). If so, it will be drawn as a solid
line.</p>
</td></tr>
<tr><td><code id="difTID_+3A_thr.draw">thr.draw</code></td>
<td>
<p>logical: should the upper and lower bounds for DIF detection be drawn? (default is <code>FALSE</code>). If
<code>TRUE</code>, they will be drawn as dashed lines.</p>
</td></tr>
<tr><td><code id="difTID_+3A_dif.draw">dif.draw</code></td>
<td>
<p>numeric: a vector of two integer values to specify how the DIF items should be displayed. The first component of <code>dif.draw</code> is the type of point (i.e. the usual <code>pch</code> argument) and the second component determines the point size (i.e. the usual <code>cex</code> argument). Default values are 1 and 3, meaning that empty circles of three times the usual size are drawn around the Delta points of items
flagged as DIF.</p>
</td></tr>
<tr><td><code id="difTID_+3A_print.corr">print.corr</code></td>
<td>
<p>logical: should the sample correlation of Delta scores be printed? (default is <code>FALSE</code>). If
<code>TRUE</code>, it is printed in upper-left corner of the plot.</p>
</td></tr>
<tr><td><code id="difTID_+3A_xlim">xlim</code>, <code id="difTID_+3A_ylim">ylim</code>, <code id="difTID_+3A_xlab">xlab</code>, <code id="difTID_+3A_ylab">ylab</code>, <code id="difTID_+3A_main">main</code></td>
<td>
<p>either the usual plot arguments <code>xlim</code>, <code>ylim</code>, <code>xlab</code>, <code>ylab</code> and <code>main</code>, or <code>NULL</code> (default value for all arguments). If <code>NULL</code>, the X and Y axis limits are computed from the range of Delta scores, the X and Y axis labels are <code>"Reference group"</code> and <code>"Focal group"</code> respectively, and no main title is produced.</p>
</td></tr>
<tr><td><code id="difTID_+3A_col">col</code></td>
<td>
<p>character: the color type for the items. Used only when <code>plot</code> is <code>"dist"</code>.</p>
</td></tr>
<tr><td><code id="difTID_+3A_number">number</code></td>
<td>
<p>logical: should the item number identification be printed (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="difTID_+3A_save.plot">save.plot</code></td>
<td>
<p>logical: should the plot be saved into a separate file? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difTID_+3A_save.options">save.options</code></td>
<td>
<p>character: a vector of three components. The first component is the name of the output file, the second component is either the file path or <code>"default"</code> (default value), and the third component is the file extension, either <code>"pdf"</code> (default) or <code>"jpeg"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="difTID_+3A_...">...</code></td>
<td>
<p>other generic parameters for the <code>plot</code> or the <code>print</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Transformed Item Difficulties (TID) method, also known as Angoff's Delta method (Angoff, 1982; Angoff and Ford, 1973) allows for detecting uniform differential item functioning without requiring an item response model approach. The presnt implementation relies on the <code><a href="deltaPlotR.html#topic+deltaPlot">deltaPlot</a></code> and <code><a href="deltaPlotR.html#topic+diagPlot">diagPlot</a></code> functions from package<b>deltaPlotR</b> (Magis and Facon, 2014).
</p>
<p>The <code>Data</code> is a matrix whose rows correspond to the subjects and columns to the items. In addition, <code>Data</code> can hold the vector of group membership. If so, <code>group</code> indicates the column of <code>Data</code> which corresponds to the group membership, either by specifying its name or by giving the column number. Otherwise, <code>group</code> must be a vector of same length as <code>nrow(Data)</code>.
</p>
<p>Missing values are allowed for item responses (not for group membership) but must be coded as <code>NA</code> values. They are discarded from the computation of
proportions of success.
</p>
<p>The vector of group membership must hold only two different values, either as numeric or character. The focal group is defined by the value of the argument <code>focal.name</code>. 
</p>
<p>The threshold for flaging items as DIF can be of two types and is specified by the <code>thr</code> argument.
</p>

<ol>
<li><p> It can be fixed to some arbitrary positive value by the user, for instance 1.5 (Angoff and Ford, 1973). In this 
case, <code>thr</code> takes the required numeric threshold value.
</p>
</li>
<li><p> Alternatively, it can be derived from the bivariate normal approximation of the Delta points (Magis and Facon, 2012). In this case, <code>thr</code> must be given the character value <code>"norm"</code> (which is the default value).
This threshold equals
</p>
<p style="text-align: center;"><code class="reqn">\Phi^{-1}(1-\alpha/2) \; \sqrt{\frac{b^2\,{s_0}^2-2\,b\,s_{01}+{s_1}^2}{b^2+1}}</code>
</p>

<p>where <code class="reqn">\Phi</code> is the density of the standard normal distribution, <code class="reqn">\alpha</code> is the significance level (set by the argument <code>alpha</code> with default value 0.05), <code class="reqn">b</code> is the slope parameter of the major axis, <code class="reqn">s_0</code> and <code class="reqn">s_1</code>
are the sample standard deviations of the Delta scores in the reference group and the focal group, respecively, and
<code class="reqn">s_{01}</code> is the sample covariance of the Delta scores (see Magis and Facon, 2012, for further details).
</p>
</li></ol>

<p>Item purification can be performed by setting the argument <code>purify</code> to <code>TRUE</code> (by default it is <code>FALSE</code> so 
no purification is performed). The item purification process (IPP) starts when at least one item was flagged as DIF after
the first run of the Delta plot, and proceeds as follows.
</p>

<ol>
<li><p> The intercept and slope parameters of the major axis are re-calculated by removing all DIF that are currently 
flagged as DIF. This yields updated values <code class="reqn">a^*</code>, <code class="reqn">b^*</code>, <code class="reqn">s_0^*</code>, <code class="reqn">s_1^*</code> and <code class="reqn">s_{01}^*</code> of the 
intercept and slope parameters, sample stanbdard deviations and sample covariance of the Delta scores.
</p>
</li>
<li><p> Perpendicular distances (for all items) are updated with respect to the updated major axis.
</p>
</li>
<li><p> Detection threshold is also updated. Three possible updates are possible: see below.
</p>
</li>
<li><p> All items are now tested for the presence of DIF, given the updated perpendicular distances and major axis.
</p>
</li>
<li><p> If the set of items flagged as DIF is the same as the one from the previous loop, stop the process. Otherwise go
back to step 1.
</p>
</li></ol>

<p>Unlike traditional DIF methods, the detection threshold may also be updated since it depends on the sample estimates (when 
the normal approximation is considered). Three approaches are currently implemented and are specified by the <code>purType</code> argument.
</p>

<ol>
<li><p> Method 1 (<code>purType=="IPP1"</code>): the same threshold is used throughout the purification process, it is not
iteratively updated. The threshold is the one obtained after the first run of the Delta plot.
</p>
</li>
<li><p> Method 2 (<code>purType=="IPP2"</code>): only the slope parameter is updated in the threshold formula. By this way, one keeps the full data structure (i.e. neither the sample variances nor the sample covariance of the Delta scores are 
modified) but only the slope parameter is adjusted to lessen the impact of DIF items.
</p>
</li>
<li><p> Method 3 (<code>purType=="IPP3"</code>): all adjusted parameters are plugged in the threshold formula. This approach
completely discards the effect of items flagged as DIF from the computation of the threshold.
</p>
</li></ol>

<p>See Magis and Facon (2013) for further details. Note that purification can also be performed with fixed threshold (i.e.
specified by the user), but then only IPP1 process is performed.
</p>
<p>In order to avoid possible infinite loops in the purification process, a maximal number of iterations must be specified
through the argument <code>maxIter</code>. The default maximal number of iterations is 10. 
</p>
<p>The output contains all input information, the Delta scores and perpendicular distances, the parameter of the major axis
and the items flagged as DIF (if none, a character sentence is returned). In addition, the detection threshold and the
type of threshold (fixed or normal approximation) is provided. 
</p>
<p>If item purification was run, several additional elements are returned: the number of iterations, a logical indicator
whether the convergence was reached (or not, meaning that the process stopped because of reaching the maximal number of 
allowed iterations), a matrix with indicators of which items were flagged as DIF at each iteration, and the type of item
purification process. Moreover, perpendicular distances are returned in a matrix format (one column per iteration), as
well as successive major axis parameters (one row per iteration) and successive thresholds (as a vector).
</p>
<p>The output is managed and printed in a more user-friendly way. When item purification is performed, only the first and
last steps are displayed. Specifying the argument <code>only.final</code> to <code>FALSE</code> prints in addition all intermediate steps of the process (successive perpendicular distances, parameters of the major axis, and detection thresholds).
</p>
<p>The output of the <code>difTID</code>, as displayed by the <code>print.TID</code> function, can be stored in a text file provided that <code>save.output</code> is set to <code>TRUE</code> 
(the default value <code>FALSE</code> does not execute the storage). In this case, the name of the text file must be given as a character string into the first component
of the <code>output</code> argument (default name is <code>"out"</code>), and the path for saving the text file can be given through the second component of <code>output</code>. The default value is <code>"default"</code>, meaning that the file will be saved in the current working directory. Any other path can be specified as a character string: see the <b>Examples</b> section for an illustration.
</p>
<p>Two types of plots are available through the <code>plot.TID</code> function. If the argument <code>plot</code> is set to <code>"dist"</code> (the default value), then the perpendicular distances are represented on the Y axis of a scatter plot, with each item on the X axis. If <code>plot</code> is set to <code>"delta"</code>, the Delta plot is returned. In the latter, all particular options can be found from the <code><a href="deltaPlotR.html#topic+diagPlot">diagPlot</a></code> function.
Also, the plot can be stored in a figure file, either in PDF or JPEG format. Fixing <code>save.plot</code> to <code>TRUE</code> allows this process. The figure is defined through the components of <code>save.options</code>. The first two components perform similarly as those of the <code>output</code> argument.
The third component is the figure format, with allowed values <code>"pdf"</code> (default) for PDF file and <code>"jpeg"</code> for JPEG file.
</p>


<h3>Value</h3>

<p>A list of class &quot;TID&quot; with the following arguments:
</p>
<table role = "presentation">
<tr><td><code>Props</code></td>
<td>
<p>the matrix of proportions of correct responses, or <code>NA</code> if <code>type</code> is <code>"delta"</code>.</p>
</td></tr>
<tr><td><code>adjProps</code></td>
<td>
<p>the restricted proportions, in the same format as the output <code>Props</code> matrix, or <code>NA</code> if <code>type</code> is <code>"delta"</code>.</p>
</td></tr>
<tr><td><code>Deltas</code></td>
<td>
<p>the matrix of Delta scores.</p>
</td></tr>
<tr><td><code>Dist</code></td>
<td>
<p>a matrix with perpendicular distances, one row per item and one column per run of the Delta plot. If <code>purify</code> is <code>FALSE</code>, only a single column is returned.</p>
</td></tr>
<tr><td><code>axis.par</code></td>
<td>
<p>a matrix with two columns, holding respectively the intercepts and the slope parameters of the major axis. Each row refers to one step of the purification process. If <code>purify</code> is <code>FALSE</code>, only a single row is returned.</p>
</td></tr>
<tr><td><code>nrIter</code></td>
<td>
<p>the number of iterations invloved in the purification process. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>maxIter</code></td>
<td>
<p>the value of the <code>maxIter</code> argument. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>a logical value indicating whether convergence was reached in the purification process. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>difPur</code></td>
<td>
<p>a matrix with one column per item and one row per iteration in the purification process, holding zeros and ones to indicate which items were flagged as DIF or not at each step of the process. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>thr</code></td>
<td>
<p>a vector of successive threshold values used during the purification process. If <code>purify</code> is <code>FALSE</code>, a single value is returned.</p>
</td></tr>
<tr><td><code>rule</code></td>
<td>
<p>a character value indicating whether the threshold was <code>"fixed"</code> by the user (i.e. by setting <code>thr</code> to a numeric value) or whether it was computed by normal approximation (i.e. by setting <code>thr</code> to <code>"norm"</code>).</p>
</td></tr>
<tr><td><code>purType</code></td>
<td>
<p>the value of the <code>purType</code> argument. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>DIFitems</code></td>
<td>
<p>either <code>"No DIF item detected"</code> or an integer vector with the items that were flagged as DIF.</p>
</td></tr>
<tr><td><code>adjust.extreme</code></td>
<td>
<p>the value of the <code>extreme</code> argument.</p>
</td></tr>
<tr><td><code>const.range</code></td>
<td>
<p>the value of the <code>const.range</code> argument.</p>
</td></tr>
<tr><td><code>nrAdd</code></td>
<td>
<p>the value of the <code>nrAdd</code> argument.</p>
</td></tr>
<tr><td><code>purify</code></td>
<td>
<p>the value of the <code>purify</code> argument.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the value of the <code>alpha</code> argument.</p>
</td></tr>
<tr><td><code>save.output</code></td>
<td>
<p>the value of the <code>save.output</code> argument.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>the value of the <code>output</code> argument.</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>either the names of the items (defined by the column names of the <code>Data</code> matrix) or the series of integers from one to the number of items.</p>
</td></tr>
<tr><td><code>number</code></td>
<td>
<p>a boolean value, being <code>TRUE</code> if the item names are simply their number in the <code>Data</code> matrix, or <code>FALSE</code> if real item names are available in the <code>names</code> element.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
</p>


<h3>References</h3>

<p>Angoff, W. H. (1982). Use of difficulty and discrimination indices for detecting item bias. In R. A. Berck (Ed.), <em>Handbook of methods for detecting item bias</em> (pp. 96-116). Baltimore, MD: Johns Hopkins University Press.
</p>
<p>Angoff, W. H., and Ford, S. F. (1973). Item-race interaction on a test of scholastic aptitude. <em>Journal of Educational Measurement, 2</em>, 95-106. doi: <a href="https://doi.org/10.1111/j.1745-3984.1973.tb00787.x">10.1111/j.1745-3984.1973.tb00787.x</a>
</p>
<p>Magis, D., and Facon, B. (2012). Angoff's Delta method revisited: improving the DIF detection under small samples.
<em>British Journal of Mathematical and Statistical Psychology, 65</em>, 302-321. doi: <a href="https://doi.org/10.1111/j.2044-8317.2011.02025.x">10.1111/j.2044-8317.2011.02025.x</a>
</p>
<p>Magis, D., and Facon, B. (2013). Item purification does not always improve DIF detection: a counter-example with Angoff's Delta plot. <em>Educational and Psychological Measurement, 73</em>, 293-311. doi: <a href="https://doi.org/10.1177/0013164412451903">10.1177/0013164412451903</a>
</p>
<p>Magis, D. and Facon, B. (2014). <em>deltaPlotR</em>: An R Package for Differential Item Functioning Analysis with Angoff's Delta Plot. <em>Journal of Statistical Software, Code Snippets, 59(1)</em>, 1-19. doi: <a href="https://doi.org/10.18637/jss.v059.c01">10.18637/jss.v059.c01</a>
</p>


<h3>See Also</h3>

<p><code><a href="deltaPlotR.html#topic+deltaPlot">deltaPlot</a></code>, code<a href="deltaPlotR.html#topic+diagPlot">diagPlot</a>, <code><a href="#topic+dichoDif">dichoDif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)

 # Excluding the "Anger" variable
 verbal &lt;- verbal[colnames(verbal) != "Anger"]

 # Three equivalent settings of the data matrix and the group membership
 r &lt;- difTID(verbal, group = 25, focal.name = 1)
 difTID(verbal, group = "Gender", focal.name = 1)
 difTID(verbal[,1:24], group = verbal[,25], focal.name = 1)

 # With item purification and threshold 1
 r2 &lt;- difTID(verbal, group = "Gender", focal.name = 1, purify = TRUE, thrTID = 1)

 # Saving the output into the "TIDresults.txt" file (and default path)
 difTID(verbal, group = 25, focal.name = 1, save.output = TRUE, 
   output = c("TIDresults", "default"))

 # Graphical devices
 plot(r2)
 plot(r2, plot = "delta")

 # Plotting results and saving it in a PDF figure
 plot(r2, save.plot = TRUE, save.options = c("plot", "default", "pdf"))

 # Changing the path, JPEG figure
 path &lt;- "c:/Program Files/"
 plot(r2, save.plot = TRUE, save.options = c("plot", path, "jpeg"))

## End(Not run)
 </code></pre>

<hr>
<h2 id='genDichoDif'>Comparison of DIF detection methods among multiple groups</h2><span id='topic+genDichoDif'></span><span id='topic+print.genDichoDif'></span>

<h3>Description</h3>

<p>This function compares the specified DIF detection methods among multiple 
groups, with respect to the detected items. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genDichoDif(Data, group, focal.names, method, anchor = NULL, match = "score", 
 	type = "both", criterion = "LRT", alpha = 0.05, model = "2PL", c = NULL, 
 	engine = "ltm", discr = 1, irtParam = NULL, nrFocal = 2, same.scale = TRUE, 
 	purify = FALSE, nrIter = 10, p.adjust.method = NULL, save.output = FALSE, 
 	output = c("out", "default")) 
## S3 method for class 'genDichoDif'
print(x, ...)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genDichoDif_+3A_data">Data</code></td>
<td>
<p>numeric: either the data matrix only, or the data matrix plus the vector of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_group">group</code></td>
<td>
<p>numeric or character: either the vector of group membership or the column indicator (within data) of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_focal.names">focal.names</code></td>
<td>
<p>numeric or character vector indicating the levels of <code>group</code> which correspond to the focal groups.</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_method">method</code></td>
<td>
<p>character: the name of the selected methods. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_anchor">anchor</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of item names (or identifiers) to specify the anchor items. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_match">match</code></td>
<td>
<p>specifies the type of matching criterion. Can be either <code>"score"</code> (default) to compute the test score, or any continuous or discrete variable with the same length as the number of rows of <code>Data</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_type">type</code></td>
<td>
<p>a character string specifying which DIF effects must be tested (default is <code>"both"</code>). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_criterion">criterion</code></td>
<td>
<p>character: the type of test statistic used to detect DIF items with generalized logistic regression. Possible values are <code>"LRT"</code> (default) and <code>"Wald"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_model">model</code></td>
<td>
<p>character: the IRT model to be fitted (either <code>"1PL"</code>, <code>"2PL"</code> or <code>"3PL"</code>). Default is <code>"2PL"</code>.</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_c">c</code></td>
<td>
<p>optional numeric value or vector giving the values of the constrained pseudo-guessing parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_engine">engine</code></td>
<td>
<p>character: the engine for estimating the 1PL model, either <code>"ltm"</code> (default) or <code>"lme4"</code>.</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_discr">discr</code></td>
<td>
<p>either <code>NULL</code> or a real positive value for the common discrimination parameter (default is 1). Used onlky if <code>model</code> is <code>"1PL"</code> and <code>engine</code> is <code>"ltm"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_irtparam">irtParam</code></td>
<td>
<p>matrix with <em>2J</em> rows (where <em>J</em> is the number of items) and at most 9 columns containing item parameters estimates. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_nrfocal">nrFocal</code></td>
<td>
<p>numeric: the number of focal groups (default is 2).</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_same.scale">same.scale</code></td>
<td>
<p>logical: are the item parameters of the <code>irtParam</code> matrix on the same scale? (default is &quot;TRUE&quot;). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_purify">purify</code></td>
<td>
<p>logical: should the method be used iteratively to purify the set of anchor items? (default is FALSE).</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item purification process (default is 10).</p>
</td></tr> 
<tr><td><code id="genDichoDif_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>either <code>NULL</code> (default) or the acronym of the method for p-value adjustment for multiple comparisons. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved into a text file? (Default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_output">output</code></td>
<td>
<p>character: a vector of two components. The first component is the name of the output file, the second component is either the file path or <code>"default"</code> (default value). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_x">x</code></td>
<td>
<p>result from a <code>genDichoDif</code> class object.</p>
</td></tr>
<tr><td><code id="genDichoDif_+3A_...">...</code></td>
<td>
<p>other generic parameters for the <code>print</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>genDichoDif</code> is a generic function which calls one or several DIF detection methods among multiple groups, and summarize their output. The possible methods are: <code>"GMH"</code> for Generalized Mantel-Haenszel (Penfield, 2001), <code>"genLogistic"</code> for generalized logistic regression (Magis, Raiche Beland and Gerard, 2011) and <code>"genLord"</code> for generalized Lord's chi-square test (Kim, Cohen and Park, 1995).
</p>
<p>If <code>method</code> has a single component, the output of <code>genDichoDif</code> is exactly the one provided by the method itself. Otherwise, the main  output is a matrix with one row per item and one column per method. For each specified method and related arguments, items detected as DIF and non-DIF are respectively encoded as <code>"DIF"</code> and <code>"NoDIF"</code>. When printing the output an additional column is added, counting the number of times each item was detected as functioning differently (Note: this is just an informative summary, since the methods are obviously not independent for the detection of DIF items).
</p>
<p>The <code>Data</code> is a matrix whose rows correspond to the subjects and columns to the items. In addition, <code>Data</code> can hold the vector of group membership. If so, <code>group</code> indicates the column of <code>Data</code> which corresponds to the group membership, either by specifying its name or by giving the column number. Otherwise, <code>group</code> must be a vector of same length as <code>nrow(Data)</code>.
</p>
<p>Missing values are allowed for item responses (not for group membership) but must be coded as <code>NA</code> values. They are discarded from either the computation of the sum-scores, the fitting of the logistic models or the IRT models (according to the method).
</p>
<p>The vector of group membership must hold at least three different values, either as numeric or character. The focal groups are defined by the values of the argument <code>focal.names</code>. 
</p>
<p>For generalized Mantel-Haenszel and generalized logistic methods, the matching criterion can be either the test score or any other continuous or discrete variable to be passed in the DIF function. This is specified by the <code>match</code> argument. By default, it takes the value <code>"score"</code> and the test score (i.e. raw score) is computed. The second option is to assign to <code>match</code> a vector of continuous or discrete numeric values, which acts as the matching criterion. Note that for consistency this vector should not belong to the <code>Data</code> matrix. 
</p>
<p>For the generalized logistic regression method, the argument <code>type</code> permits to test either both uniform and nonuniform effects simultaneously (with <code>type="both"</code>), only uniform DIF effect (with <code>type="udif"</code>) or only nonuniform DIF effect (with <code>type="nudif"</code>). Furthermore, the argument <code>criterion</code> defines which test must be used, either the Wald test (<code>"Wald"</code>) or the likelihood ratio test (<code>"LRT"</code>). See <code><a href="#topic+difGenLord">difGenLord</a></code> for further details. 
</p>
<p>For generalized Lord method, one can specify either the IRT model to be fitted (by means of <code>model</code>, <code>c</code>, <code>engine</code> and <code>discr</code> arguments), or the item parameter estimates with arguments <code>irtParam</code> and <code>same.scale</code>. See <code><a href="#topic+difGenLord">difGenLord</a></code> for further details. 
</p>
<p>The threshold for detecting DIF items depends on the method and is depending on the significance level set by <code>alpha</code>.
</p>
<p>Item purification can be requested by specifying <code>purify</code> option to <code>TRUE</code>. Recall that item purification process is slightly different for IRT and for non-IRT based methods. See the corresponding methods for further information.
</p>
<p>Adjustment for multiple comparisons is possible with the argument <code>p.adjust.method</code>. See the corresponding methods for further information.
</p>
<p>A pre-specified set of anchor items can be provided through the <code>anchor</code> argument. For non-IRT methods, anchor items are used to compute the test score (as matching criterion). For IRT methods, anchor items are used to rescale the item parameters on a common metric. See the corresponding methods for further information. 
</p>
<p>The output of the <code>genDichoDif</code> function can be stored in a text file by fixing <code>save.output</code> and <code>output</code> appropriately. See the help file of <code><a href="#topic+selectGenDif">selectGenDif</a></code> function (or any other DIF method) for further information.
</p>


<h3>Value</h3>

<p>Either the output of one of the DIF detection methods, or a list of class &quot;genDichoDif&quot; with the following arguments:
</p>
<table role = "presentation">
<tr><td><code>DIF</code></td>
<td>
<p>a character matrix with one row per item and whose columns refer to the different specified detection methods. See <b>Details</b>.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the significance level <code>alpha</code>.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the value of <code>method</code>argument.</p>
</td></tr>
<tr><td><code>match</code></td>
<td>
<p>the value of <code>match</code> argument.</p>
</td></tr> 
<tr><td><code>type</code></td>
<td>
<p>the value of <code>type</code> argument.</p>
</td></tr>  
<tr><td><code>criterion</code></td>
<td>
<p>the value of the <code>criterion</code> argument.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the value of <code>model</code> option.</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p>the value of <code>c</code> option.</p>
</td></tr>
<tr><td><code>engine</code></td>
<td>
<p>The value of the <code>engine</code> argument.</p>
</td></tr>
<tr><td><code>discr</code></td>
<td>
<p>the value of the <code>discr</code> argument.</p>
</td></tr>
<tr><td><code>irtParam</code></td>
<td>
<p>the value of <code>irtParam</code> option.</p>
</td></tr>
<tr><td><code>same.scale</code></td>
<td>
<p>the value of <code>same.scale</code> option.</p>
</td></tr>
<tr><td><code>p.adjust.method</code></td>
<td>
<p>the value of the <code>p.adjust.method</code> argument.</p>
</td></tr>
<tr><td><code>purification</code></td>
<td>
<p>the value of <code>purify</code> option.</p>
</td></tr> 
<tr><td><code>nrPur</code></td>
<td>
<p>an integer vector (of length equal to the number of methods) with the number of iterations in the purification process. Returned only if <code>purify</code> is TRUE.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>a logical vector (of length equal to the number of methods) indicating whether the iterative purification process converged. Returned only if <code>purify</code> is TRUE.</p>
</td></tr>
<tr><td><code>anchor.names</code></td>
<td>
<p>the value of the <code>anchor</code> argument.</p>
</td></tr>
<tr><td><code>save.output</code></td>
<td>
<p>the value of the <code>save.output</code> argument.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>the value of the <code>output</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Kim, S.-H., Cohen, A.S. and Park, T.-H. (1995). Detection of differential item functioning in multiple groups. <em>Journal of Educational Measurement, 32</em>, 261-276. doi: <a href="https://doi.org/10.1111/j.1745-3984.1995.tb00466.x">10.1111/j.1745-3984.1995.tb00466.x</a>
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Magis, D., Raiche, G., Beland, S. and Gerard, P. (2011). A logistic regression procedure to detect differential item functioning among multiple groups. <em>International Journal of Testing, 11</em>, 365&ndash;386. doi: <a href="https://doi.org/10.1080/15305058.2011.602810">10.1080/15305058.2011.602810</a>
</p>
<p>Penfield, R. D. (2001). Assessing differential item functioning among multiple groups: a comparison of three Mantel-Haenszel procedures. <em>Applied Measurement in Education, 14</em>, 235-259. doi: <a href="https://doi.org/10.1207/S15324818AME1403_3">10.1207/S15324818AME1403_3</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difGMH">difGMH</a></code>, <code><a href="#topic+difGenLogistic">difGenLogistic</a></code>, <code><a href="#topic+difGenLord">difGenLord</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Creating four groups according to gender ("Man" or "Woman") and trait 
 # anger score ("Low" or "High")
 group &lt;- rep("WomanLow", nrow(verbal))
 group[Anger&gt;20 &amp; Gender==0] &lt;- "WomanHigh"
 group[Anger&lt;=20 &amp; Gender==1] &lt;- "ManLow"
 group[Anger&gt;20 &amp; Gender==1] &lt;- "ManHigh"

 # New data set
 Verbal &lt;- cbind(verbal[,1:24], group)

 # Reference group: "WomanLow"
 names &lt;- c("WomanHigh", "ManLow", "ManHigh")

 # Comparing the three available methods
 # with item purification 
 genDichoDif(Verbal, group = 25, focal.names = names, method = c("GMH", "genLogistic",
             "genLord"), purify = TRUE)
   
 # Same analysis, but saving the output into the 'genDicho' file
 genDichoDif(Verbal, group = 25, focal.names = names, method = c("GMH", "genLogistic", 
             "genLord"), purify = TRUE, save.output = TRUE, 
             output = c("genDicho", "default"))

## End(Not run)
</code></pre>

<hr>
<h2 id='genLogistik'>Generalized logistic regression DIF statistic</h2><span id='topic+genLogistik'></span>

<h3>Description</h3>

<p>Calculates the &quot;generalized logistic regression&quot; likelihood-ratio or Wald statistics for DIF detection among 
multiple groups. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genLogistik(data, member, match = "score", anchor = 1:ncol(data), 
 	type = "both", criterion = "LRT") 
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genLogistik_+3A_data">data</code></td>
<td>
<p>numeric: the data matrix (one row per subject, one column per item).</p>
</td></tr>
<tr><td><code id="genLogistik_+3A_member">member</code></td>
<td>
<p>numeric: the vector of group membership with zero and positive integer entries only. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genLogistik_+3A_match">match</code></td>
<td>
<p>specifies the type of matching criterion. Can be either <code>"score"</code> (default) to compute the test score, or any continuous or discrete variable with the same length as the number of rows of <code>data</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genLogistik_+3A_anchor">anchor</code></td>
<td>
<p>a vector of integer values specifying which items (all by default) are currently considered as anchor (DIF free) items. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genLogistik_+3A_type">type</code></td>
<td>
<p>a character string specifying which DIF effects must be tested. Possible values are <code>"both"</code> (default), <code>"udif"</code> and <code>"nudif"</code>. 
See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genLogistik_+3A_criterion">criterion</code></td>
<td>
<p>character: the type of test statistic used to detect DIF items. Possible values are <code>"LRT"</code> (default) and <code>"Wald"</code>. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This command computes the generalized logistic regression statistic (Magis, Raiche, Beland and Gerard, 2011) in the specific framework of differential item
functioning among  <code class="reqn">(J+1)</code> groups and <em>J</em> is the number of focal groups. It forms the basic command of <code><a href="#topic+difGenLogistic">difGenLogistic</a></code> and is specifically 
designed for this call.
</p>
<p>The three possible models to be fitted are:
</p>
<p style="text-align: center;"><code class="reqn">M_0: logit (\pi_i) = \alpha + \beta X + \gamma_i + \delta_i X</code>
</p>

<p style="text-align: center;"><code class="reqn">M_1: logit (\pi_i) = \alpha + \beta X + \gamma_i</code>
</p>

<p style="text-align: center;"><code class="reqn">M_2: logit (\pi_i) = \alpha + \beta X</code>
</p>

<p>where <code class="reqn">\pi_i</code> is the probability of answering correctly the item in group <em>i</em> (<code class="reqn">i = 0, ..., J</code>) and <code class="reqn">X</code> is the matching criterion. Parameters
<code class="reqn">\alpha</code> and <code class="reqn">\beta</code> are the common intercept and the slope of the logistic curves, while <code class="reqn">\gamma_i</code> and <code class="reqn">\delta_i</code> are group-specific
parameters. For identification reasons the parameters <code class="reqn">\gamma_0</code> and <code class="reqn">\delta_0</code> of the reference group are set to zero. The set of parameters
<code class="reqn">\{\gamma_i: i = 1, ..., J\}</code> of the focal groups (<code class="reqn">g=i</code>) represents the uniform DIF effect across all groups, and the set of parameters 
<code class="reqn">\{\delta_i: i = 1, ..., n\}</code> is used to model nonuniform DIF effect across all groups.
The models are fitted with the <code><a href="stats.html#topic+glm">glm</a></code> function.
</p>
<p>The matching criterion can be either the test score or any other continuous or discrete variable to be passed in the <code>Logistik</code> function. This is specified by the <code>match</code> argument. By default, it takes the value <code>"score"</code> and the test score (i.e. raw score) is computed. The second option is to assign to <code>match</code> a vector of continuous or discrete numeric values, which acts as the matching criterion. Note that for consistency this vector should not belong to the <code>data</code> matrix.
</p>
<p>Two tests are available: the Wald test and the likelihood ratio test. With the likelihood ratio test, two nested models are fitted and compared by means
of Wilks' Lambda (or likelihood ratio) statistic (Wilks, 1938). With the Wald test, the model parameters are statistically tested using an appropriate 
contrast matrix. Each test is set with the <code>criterion</code> argument, with the values <code>"LRT"</code> and <code>"Wald"</code> respectively. 
</p>
<p>The argument <code>type</code> determines the type of DIF effect to be tested. The three possible values of <code>type</code> are: <code>type="both"</code> which tests
the hypothesis <code class="reqn">H_0: \gamma_i = \delta_i=0</code> for all <em>i</em>; <code>type="nudif"</code> which tests the hypothesis <code class="reqn">H_0: \delta_i = 0</code> for all <em>i</em>;
and <code>type="udif"</code> which tests the hypothesis <code class="reqn">H_0: \gamma_i = 0 | \delta_i = 0</code> for all <em>i</em>. In other words, <code>type="both"</code> tests
for DIF (without distinction between uniform and nonuniform effects), while <code>type="udif"</code> and <code>type="nudif"</code> test for uniform and nonuniform DIF,
respectively. Whatever the tested DIF effects, this is a simultaneous test of the equality of focal group parameters to zero.
</p>
<p>The data are passed through the <code>data</code> argument, with one row per subject and one column per item.  Missing values are allowed but must be coded as 
<code>NA</code> values. They are discarded from the fitting of the logistic models (see <code><a href="stats.html#topic+glm">glm</a></code> for further details).
</p>
<p>The vector of group membership, specified with <code>member</code> argument, must hold only zeros and positive integers. The value zero corresponds to the
reference group, and each positive integer value corresponds to one focal group. At least two different positive integers must be supplied.
</p>
<p>Option <code>anchor</code> sets the items which are considered as anchor items for computing the  logistic regression DIF statistics. Items other than the anchor 
items and the tested item are discarded. <code>anchor</code> must hold integer values specifying the column numbers of the corresponding anchor items. It is 
mainly designed to perform item purification.
</p>
<p>In addition to the results of the fitted models (model parameters, covariance matrices, test statistics), Nagelkerke's <code class="reqn">R^2</code> coefficients (Nagelkerke, 1991)
are computed for each model and the output returns the differences in these coefficients. Such differences are used as measures of effect size by the
<code><a href="#topic+difGenLogistic">difGenLogistic</a></code> command; see Gomez-Benito, Dolores Hidalgo and Padilla (2009), Jodoin and Gierl (2001) and Zumbo and Thomas (1997).
</p>


<h3>Value</h3>

 
<p>A list with nine components:
</p>
<table role = "presentation">
<tr><td><code>stat</code></td>
<td>
<p>the values of the generalized logistic regression DIF statistics (that is, the likelihood ratio test statistics).</p>
</td></tr>
<tr><td><code>R2M0</code></td>
<td>
<p>the values of Nagelkerke's R^2 coefficients for the &quot;full&quot; model.</p>
</td></tr>
<tr><td><code>R2M1</code></td>
<td>
<p>the values of Nagelkerke's R^2 coefficients for the &quot;simpler&quot; model.</p>
</td></tr>
<tr><td><code>deltaR2</code></td>
<td>
<p>the differences between Nagelkerke's <code class="reqn">R^2</code> coefficients of the tested models. See <b>Details</b>.</p>
</td></tr>
<tr><td><code>parM0</code></td>
<td>
<p>a matrix with one row per item and <code class="reqn">2+J*2</code> columns (where <em>J</em> is the number of focal groups), holding successively the fitted 
parameters <code class="reqn">\hat{\alpha}</code>, <code class="reqn">\hat{\beta}</code>, <code class="reqn">\hat{\gamma}_i</code> and <code class="reqn">\hat{\delta}_i</code> (<code class="reqn">i = 1, ..., J</code>) of the &quot;full&quot; 
model (<code class="reqn">M_0</code> if <code>type="both"</code> or <code>type="nudif"</code>, <code class="reqn">M_1</code> if <code>type="udif"</code>).</p>
</td></tr>
<tr><td><code>parM1</code></td>
<td>
<p>the same matrix as <code>parM0</code> but with fitted parameters for the &quot;simpler&quot; model (<code class="reqn">M_1</code> if <code>type="nudif"</code>, <code class="reqn">M_2</code> if <code>type="both"</code>
or <code>type="udif"</code>).</p>
</td></tr>
<tr><td><code>covMat</code></td>
<td>
<p>a 3-dimensional matrix of size <em>p</em> x <em>p</em> x <em>K</em>, where <em>p</em> is the number of estimated parameters and <em>K</em> is the number of
items, holding the <em>p</em> x <em>p</em> covariance matrices of the estimated parameters (one matrix for each tested item).</p>
</td></tr>
<tr><td><code>criterion</code></td>
<td>
<p>the value of the <code>criterion</code> argument.</p>
</td></tr>
<tr><td><code>match</code></td>
<td>
<p>a character string, either <code>"score"</code> or <code>"matching variable"</code> depending on the <code>match</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Gomez-Benito, J., Dolores Hidalgo, M. and Padilla, J.-L. (2009). Efficacy of effect size measures in logistic regression: an application for detecting DIF. 
<em>Methodology, 5</em>, 18-25. doi: <a href="https://doi.org/10.1027/1614-2241.5.1.18">10.1027/1614-2241.5.1.18</a>
</p>
<p>Jodoin, M. G. and Gierl, M. J. (2001). Evaluating Type I error and power rates using an effect size measure with logistic regression procedure for DIF detection. <em>Applied Measurement in Education, 14</em>, 329-349. doi: <a href="https://doi.org/10.1207/S15324818AME1404_2">10.1207/S15324818AME1404_2</a>
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Magis, D., Raiche, G., Beland, S. and Gerard, P. (2011). A logistic regression procedure to detect differential item functioning among multiple groups. <em>International Journal of Testing, 11</em>, 365&ndash;386. doi: <a href="https://doi.org/10.1080/15305058.2011.602810">10.1080/15305058.2011.602810</a>
</p>
<p>Nagelkerke, N. J. D. (1991). A note on a general definition of the coefficient of determination. <em>Biometrika, 78</em>, 691-692. doi: <a href="https://doi.org/10.1093/biomet/78.3.691">10.1093/biomet/78.3.691</a>
</p>
<p>Wilks, S. S. (1938). The large-sample distribution of the likelihood ratio for testing composite hypotheses. <em>Annals of Mathematical Statistics, 9</em>, 60-62. doi: <a href="https://doi.org/10.1214/aoms/1177732360">10.1214/aoms/1177732360</a>
</p>
<p>Zumbo, B. D. and Thomas, D. R. (1997). A measure of effect size for a model-based approach for studying DIF. Prince George, Canada: University of Northern British
Columbia, Edgeworth Laboratory for Quantitative Behavioral Science.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difGenLogistic">difGenLogistic</a></code>, <code><a href="#topic+genDichoDif">genDichoDif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Creating four groups according to gender (0 or 1) and trait anger score
 # ("Low" or "High")
 # Reference group: women with low trait anger score (&lt;=20)
 group &lt;- rep(0,nrow(verbal))
 group[Anger&gt;20 &amp; Gender==0] &lt;- 1
 group[Anger&lt;=20 &amp; Gender==1] &lt;- 2
 group[Anger&gt;20 &amp; Gender==1] &lt;- 3

 # Testing both types of DIF simultaneously
 # With all items
 genLogistik(verbal[,1:24], group)
 genLogistik(verbal[,1:24], group, criterion = "Wald")

 # Removing item 6 from the set of anchor items
 genLogistik(verbal[,1:24], group, anchor = c(1:5, 7:24))
 genLogistik(verbal[,1:24], group, anchor = c(1:5, 7:24), criterion = "Wald")

 # Testing nonuniform DIF effect
 genLogistik(verbal[,1:24], group, type = "nudif")
 genLogistik(verbal[,1:24], group, type = "nudif", criterion="Wald")

 # Testing uniform DIF effect
 genLogistik(verbal[,1:24], group, type = "udif")
 genLogistik(verbal[,1:24], group, type = "udif", criterion="Wald")

 # Using trait anger score as matching criterion
 genLogistik(verbal[,1:24], group, match = verbal[,25])
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='genLordChi2'>Generalized Lord's chi-squared DIF statistic</h2><span id='topic+genLordChi2'></span>

<h3>Description</h3>

<p>Calculates the generalized Lord's chi-squared statistics for DIF detection among multiple groups. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genLordChi2(irtParam, nrFocal)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genLordChi2_+3A_irtparam">irtParam</code></td>
<td>
<p>numeric: the matrix of item parameter estimates. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genLordChi2_+3A_nrfocal">nrFocal</code></td>
<td>
<p>numeric: the number of focal groups.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This command computes the generalized Lord's chi-squared statistic (Kim, Cohen and Park, 1995), also called the <em>Qj</em> 
statistics, in the specific framework of differential item functioning with multiple groups. It forms the basic command 
of <code><a href="#topic+difGenLord">difGenLord</a></code> and is specifically designed for this call.
</p>
<p>The <code>irtParam</code> matrix has a number of rows equal to the number of groups (reference and focal ones) times the number of items <em>J</em>. The first <em>J</em> 
rows refer to the item parameter estimates in the reference group, while the next sets of <em>J</em> rows correspond to the same items in each of 
the focal groups. The number of columns depends on the selected IRT model: 2 for the 1PL model, 5 for the 2PL model, 6 for the constrained 3PL model
and 9 for the unconstrained 3PL model. The columns of <code>irtParam</code> have to follow the same structure as the output of
<code>itemParEst</code> command (the latter can actually be used to create the <code>irtParam</code> matrix). 
</p>
<p>In addition, the item parameters of the reference group and the focal groups must be placed on the same scale. This can be done by using <code><a href="#topic+itemRescale">itemRescale</a></code>
command, which performs equal means anchoring between two groups of item estimates (Cook and Eignor, 1991).
</p>
<p>The number of focal groups has to be specified with argument <code>nrFocal</code>.
</p>


<h3>Value</h3>

<p>A vector with the values of the generalized Lord's chi-squared DIF statistics.
</p>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Cook, L. L. and Eignor, D. R. (1991). An NCME instructional module on IRT equating methods. <em>Educational Measurement: Issues and Practice, 10</em>, 37-45.
</p>
<p>Kim, S.-H., Cohen, A.S. and Park, T.-H. (1995). Detection of differential item functioning in multiple groups. <em>Journal of Educational Measurement, 32</em>, 261-276. doi: <a href="https://doi.org/10.1111/j.1745-3984.1995.tb00466.x">10.1111/j.1745-3984.1995.tb00466.x</a>
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+itemParEst">itemParEst</a></code>, <code><a href="#topic+itemRescale">itemRescale</a></code>, <code><a href="#topic+difGenLord">difGenLord</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Creating four groups according to gender ("Man" or "Woman") and
 # trait anger score ("Low" or "High")
 group &lt;- rep("WomanLow",nrow(verbal))
 group[Anger&gt;20 &amp; Gender==0] &lt;- "WomanHigh"
 group[Anger&lt;=20 &amp; Gender==1] &lt;- "ManLow"
 group[Anger&gt;20 &amp; Gender==1] &lt;- "ManHigh"

 # Splitting the data into the four subsets according to "group"
 data0 &lt;- data1 &lt;- data2 &lt;- data3 &lt;- NULL
 for (i in 1:nrow(verbal)){
 if (group[i]=="WomanLow") data0 &lt;- rbind(data0, as.numeric(verbal[i,1:24]))
 if (group[i]=="WomanHigh") data1 &lt;- rbind(data1, as.numeric(verbal[i,1:24]))
 if (group[i]=="ManLow") data2 &lt;- rbind(data2, as.numeric(verbal[i,1:24]))
 if (group[i]=="ManHigh") data3 &lt;- rbind(data3, as.numeric(verbal[i,1:24]))
 }

 # Estimation of the item parameters (1PL model)
 m0.1PL &lt;- itemParEst(data0, model = "1PL")
 m1.1PL &lt;- itemParEst(data1, model = "1PL")
 m2.1PL &lt;- itemParEst(data2, model = "1PL")
 m3.1PL &lt;- itemParEst(data3, model = "1PL")

 # merging the item parameters with rescaling
 irt.scale &lt;- rbind(m0.1PL, itemRescale(m0.1PL, m1.1PL), itemRescale(m0.1PL, m2.1PL), 
                    itemRescale(m0.1PL, m3.1PL))

 # Generalized Lord's chi-squared statistics
 genLordChi2(irt.scale, nrFocal = 3)
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='genMantelHaenszel'>Generalized Mantel-Haenszel DIF statistic</h2><span id='topic+genMantelHaenszel'></span>

<h3>Description</h3>

<p>Calculates the generalized Mantel-Haenszel statistics for DIF detection among multiple groups. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genMantelHaenszel(data, member, match = "score", anchor = 1:ncol(data))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genMantelHaenszel_+3A_data">data</code></td>
<td>
<p>numeric: the data matrix (one row per subject, one column per item).</p>
</td></tr>
<tr><td><code id="genMantelHaenszel_+3A_member">member</code></td>
<td>
<p>numeric: the vector of group membership with zero and positive integer entries only. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genMantelHaenszel_+3A_match">match</code></td>
<td>
<p>specifies the type of matching criterion. Can be either <code>"score"</code> (default) to compute the test score, or any continuous or discrete variable with the same length as the number of rows of <code>data</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genMantelHaenszel_+3A_anchor">anchor</code></td>
<td>
<p>a vector of integer values specifying which items (all by default) are currently considered as anchor (DIF free) items. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This command computes the generalized Mantel-Haenszel statistic (Somes, 1986) in the specific framework of differential item functioning. It forms the basic command
of <code><a href="#topic+difGMH">difGMH</a></code> and is specifically designed for this call.
</p>
<p>The data are passed through the <code>data</code> argument, with one row per subject and one column per item. Missing values are allowed but must be coded as <code>NA</code>
values. They are discarded from sum-score computation.
</p>
<p>The vector of group membership, specified with <code>member</code> argument, must hold only zeros and positive integers. The value zero corresponds to the reference group,
and each positive integer value corresponds to one focal group. At least two different positive integers must be supplied.
</p>
<p>The matching criterion can be either the test score or any other continuous or discrete variable to be passed in the <code>genMantelHaenszel</code> function. This is specified by the <code>match</code> argument. By default, it takes the value <code>"score"</code> and the test score (i.e. raw score) is computed. The second option is to assign to <code>match</code> a vector of continuous or discrete numeric values, which acts as the matching criterion. Note that for consistency this vector should not belong to the <code>data</code> matrix.
</p>
<p>Option <code>anchor</code> sets the items which are considered as anchor items for computing generalized Mantel-Haenszel statistics. Items other than the anchor items and
the tested item are discarded. <code>anchor</code> must hold integer values specifying the column numbers of the corresponding anchor items. It is primarily designed to
perform item purification.
</p>


<h3>Value</h3>

<p>A vector with the values of the generalized Mantel-Haenszel DIF statistics.
</p>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Penfield, R. D. (2001). Assessing differential item functioning among multiple groups: a comparison of three Mantel-Haenszel procedures. <em>Applied Measurement in Education, 14</em>, 235-259. doi: <a href="https://doi.org/10.1207/S15324818AME1403_3">10.1207/S15324818AME1403_3</a>
</p>
<p>Somes, G. W. (1986). The generalized Mantel-Haenszel statistic. <em>The American Statistician, 40</em>, 106-108. doi: <a href="https://doi.org/10.2307/2684866">10.2307/2684866</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difGMH">difGMH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Creating four groups according to gender (0 or 1) and trait anger
 # score ("Low" or "High")
 # Reference group: women with low trait anger score (&lt;=20)
 group &lt;- rep(0, nrow(verbal))
 group[Anger&gt;20 &amp; Gender==0] &lt;- 1
 group[Anger&lt;=20 &amp; Gender==1] &lt;- 2
 group[Anger&gt;20 &amp; Gender==1] &lt;- 3

 # Without continuity correction
 genMantelHaenszel(verbal[,1:24], group)

 # Removing item 6 from the set of anchor items
 genMantelHaenszel(verbal[,1:24], group, anchor = c(1:5, 7:24))
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='itemPar1PL'>Item parameter estimation for DIF detection using Rasch (1PL) model</h2><span id='topic+itemPar1PL'></span>

<h3>Description</h3>

<p>Fits the Rasch (1PL) model and returns related item parameter estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>itemPar1PL(data, engine = "ltm", discr = 1)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="itemPar1PL_+3A_data">data</code></td>
<td>
<p>numeric: the data matrix.</p>
</td></tr>
<tr><td><code id="itemPar1PL_+3A_engine">engine</code></td>
<td>
<p>character: the engine for estimating the 1PL model, either <code>"ltm"</code> (default) or <code>"lme4"</code>.</p>
</td></tr>
<tr><td><code id="itemPar1PL_+3A_discr">discr</code></td>
<td>
<p>either <code>NULL</code> or a real positive value for the common discrimination parameter (default is 1). Not used if <code>engine</code> is <code>"lme4"</code>.
See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>itemPar1PL</code> permits to get item parameter estimates from the Rasch or 1PL model. The output is ordered such that it can be directly used
with the general <code><a href="#topic+itemParEst">itemParEst</a></code> command, as well as the methods of Lord (<code><a href="#topic+difLord">difLord</a></code>) and Raju (<code><a href="#topic+difRaju">difRaju</a></code>) and
Generalized Lord's (<code><a href="#topic+difGenLord">difGenLord</a></code>) to detect differential item functioning.
</p>
<p>The <code>data</code> is a matrix whose rows correspond to the subjects and columns to the items. 
</p>
<p>Missing values are allowed but must be coded as <code>NA</code> values. They are discarded for item parameter estimation.
</p>
<p>The estimation engine is set by the <code>engine</code> argument. By default (<code>engine="ltm"</code>), the Rasch model is fitted using marginal maximum likelihood, by means of 
the function <code>rasch</code> from the <code>ltm</code> package (Rizopoulos, 2006). The other option, <code>engine="lme4"</code>, permits to fit the Rasch model as a generalized 
linear mixed model, by means of the <code>glmer</code> function of the <code>lme4</code> package (Bates and Maechler, 2009).
</p>
<p>With the <code>"ltm"</code> engine, the common discrimination parameter is set equal to 1 by default. It is possible to fix another value through the argument<code>discr</code>.
Alternatively, this common discrimination parameter can be estimated (though not returned) by fixing <code>discr</code> to <code>NULL</code>. See the functionalities of 
<code>rasch</code> command for further details.
</p>


<h3>Value</h3>

<p>A matrix with one row per item and two columns, the first one with item parameter estimates and the second one with the related standard errors.
</p>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

 
<p>Bates, D. and Maechler, M. (2009). lme4: Linear mixed-effects models using S4 classes. R package version 0.999375-31. http://CRAN.R-project.org/package=lme4
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Rizopoulos, D. (2006). ltm: An R package for latent variable modelling and item response theory analyses. <em>Journal of Statistical Software, 17</em>, 1&ndash;25. doi: <a href="https://doi.org/10.18637/jss.v017.i05">10.18637/jss.v017.i05</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+itemPar2PL">itemPar2PL</a></code>, <code><a href="#topic+itemPar3PL">itemPar3PL</a></code>, <code><a href="#topic+itemPar3PLconst">itemPar3PLconst</a></code>, <code><a href="#topic+itemParEst">itemParEst</a></code>, <code><a href="#topic+difLord">difLord</a></code>, <code><a href="#topic+difRaju">difRaju</a></code>, 
</p>
<p><code><a href="#topic+difGenLord">difGenLord</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 
 # Getting item parameter estimates ('ltm' engine)
 itemPar1PL(verbal[, 1:24])

 # Estimating the common discrimination parameter instead
 itemPar1PL(verbal[, 1:24], discr = NULL)

 # Getting item parameter estimates ('lme4' engine) 
 itemPar1PL(verbal[, 1:24], engine = "lme4")
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='itemPar2PL'>Item parameter estimation for DIF detection using 2PL model</h2><span id='topic+itemPar2PL'></span>

<h3>Description</h3>

<p>Fits the 2PL model and returns related item parameter estimates, standard errors and covariances between item parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>itemPar2PL(data)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="itemPar2PL_+3A_data">data</code></td>
<td>
<p>numeric: the data matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>itemPar2PL</code> permits to get item parameter estimates from the 2PL model. The output is ordered such that it can be directly used
with the general <code><a href="#topic+itemParEst">itemParEst</a></code> command, as well as the methods of Lord (<code><a href="#topic+difLord">difLord</a></code>) and Raju (<code><a href="#topic+difRaju">difRaju</a></code>) 
and Generalized Lord's (<code><a href="#topic+difGenLord">difGenLord</a></code>) to detect differential item functioning.
</p>
<p>The <code>data</code> is a matrix whose rows correspond to the subjects and columns to the items.
</p>
<p>Missing values are allowed but must be coded as <code>NA</code> values. They are discarded for item parameter estimation.
</p>
<p>The 2PL model is fitted using marginal maximum likelihood by means of the functions from the <code>ltm</code> package (Rizopoulos, 2006). 
</p>


<h3>Value</h3>

<p>A matrix with one row per item and five columns: the estimates of item discrimination <em>a</em> and difficulty <em>b</em> parameters, the 
related standard errors <em>se(a)</em> and <em>se(b)</em>, and the covariances <em>cov(a,b)</em>, in this order.
</p>


<h3>Note</h3>

<p>The 2PL model is fitted under the linear parametrization in <code>ltm</code>, the covariance matrix is extracted with the <code>vcov()</code> function, and final standard errors and covariances are derived by the Delta method. See Rizopoulos (2006) for further details, and the <code>Note.pdf</code> document in the <code>difR</code> package for mathematical details.
</p>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

 
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Rizopoulos, D. (2006). ltm: An R package for latent variable modelling and item response theory analyses. <em>Journal of Statistical Software, 17</em>, 1&ndash;25. doi: <a href="https://doi.org/10.18637/jss.v017.i05">10.18637/jss.v017.i05</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+itemPar1PL">itemPar1PL</a></code>, <code><a href="#topic+itemPar3PL">itemPar3PL</a></code>, <code><a href="#topic+itemPar3PLconst">itemPar3PLconst</a></code>, <code><a href="#topic+itemParEst">itemParEst</a></code>, <code><a href="#topic+difLord">difLord</a></code>, <code><a href="#topic+difRaju">difRaju</a></code>, 
</p>
<p><code><a href="#topic+difGenLord">difGenLord</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)

 # Getting item parameter estimates
 itemPar2PL(verbal[,1:24])
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='itemPar3PL'>Item parameter estimation for DIF detection using 3PL model</h2><span id='topic+itemPar3PL'></span>

<h3>Description</h3>

<p>Fits the 3PL model and returns related item parameter estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>itemPar3PL(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="itemPar3PL_+3A_data">data</code></td>
<td>
<p>numeric: the data matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>itemPar3PL</code> permits to get item parameter estimates from the 3PL model. The output is ordered such that it can be directly used
with the general <code><a href="#topic+itemParEst">itemParEst</a></code> command, as well as the methods of Lord (<code><a href="#topic+difLord">difLord</a></code>) and Raju (<code><a href="#topic+difRaju">difRaju</a></code>) 
and Generalized Lord's (<code><a href="#topic+difGenLord">difGenLord</a></code>) to detect differential item functioning. 
</p>
<p>The output consists of nine columns which are displayed in the following order. The first three columns hold the estimates of item discrimination <em>a</em>,
difficulty <em>b</em> and pseudo-guessing <em>c</em> parameters. In the next three columns one can find the related standard errors <em>se(a)</em>, <em>se(b)</em> 
and <em>se(c)</em>. Eventually, the last three columns contain the covariances between item parameters, respectively <em>cov(a,b)</em>, <em>cov(a,c)</em> and 
<em>cov(b,c)</em>.
</p>
<p>The <code>data</code> is a matrix whose rows correspond to the subjects and columns to the items. 
</p>
<p>Missing values are allowed but must be coded as <code>NA</code> values. They are discarded for item parameter estimation.
</p>
<p>The 3PL model is fitted using marginal maximum likelihood by means of the functions from the <code>ltm</code> package (Rizopoulos, 2006).
</p>


<h3>Value</h3>

<p>A matrix with one row per item and nine columns. See <b>Details</b>.</p>


<h3>Note</h3>

<p>The 3PL model is fitted under the linear parametrization in <code>tpm</code>, the covariance matrix is extracted with the <code>vcov()</code> function, and final standard errors and covariances are derived by the Delta method. See Rizopoulos (2006) for further details, and the <code>Note.pdf</code> document in the <code>difR</code> package for mathematical details.
</p>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

 
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Rizopoulos, D. (2006). ltm: An R package for latent variable modelling and item response theory analyses. <em>Journal of Statistical Software, 17</em>, 1&ndash;25. doi: <a href="https://doi.org/10.18637/jss.v017.i05">10.18637/jss.v017.i05</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+itemPar1PL">itemPar1PL</a></code>, <code><a href="#topic+itemPar2PL">itemPar2PL</a></code>, <code><a href="#topic+itemPar3PLconst">itemPar3PLconst</a></code>, <code><a href="#topic+itemParEst">itemParEst</a></code>, <code><a href="#topic+difLord">difLord</a></code>, <code><a href="#topic+difRaju">difRaju</a></code>, 
</p>
<p><code><a href="#topic+difGenLord">difGenLord</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)

 # Getting item parameter estimates
 itemPar3PL(verbal[,1:24])
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='itemPar3PLconst'>Item parameter estimation for DIF detection using constrained 3PL model</h2><span id='topic+itemPar3PLconst'></span>

<h3>Description</h3>

<p>Fits the 3PL model with constrained pseudo-guessing values and returns related item parameter estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>itemPar3PLconst(data, c=rep(0,ncol(data)))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="itemPar3PLconst_+3A_data">data</code></td>
<td>
<p>numeric: the data matrix.</p>
</td></tr>
<tr><td><code id="itemPar3PLconst_+3A_c">c</code></td>
<td>
<p>numeric value or vector of constrained pseudo-guessing parameters. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>itemPar3PLconst</code> permits to get item parameter estimates from the 3PL model for which the pseudo-guessing parameters are constrained to some fixed values. 
The output is ordered such that it can be directly used with the general <code><a href="#topic+itemParEst">itemParEst</a></code> command, as well as the methods of Lord (<code><a href="#topic+difLord">difLord</a></code>) 
and Raju (<code><a href="#topic+difRaju">difRaju</a></code>) and Generalized Lord's (<code><a href="#topic+difGenLord">difGenLord</a></code>) to detect differential item functioning. 
</p>
<p>The output is similar to that of <code><a href="#topic+itemPar2PL">itemPar2PL</a></code> method to fit the 2PL model; an additional column is included and holds the fixed pseudo-guessing 
parameter values.
</p>
<p>The <code>data</code> is a matrix whose rows correspond to the subjects and columns to the items. 
</p>
<p>Missing values are allowed but must be coded as <code>NA</code> values. They are discarded for item parameter estimation.
</p>
<p>The argument <code>c</code> can be either a single numeric value or a numeric vector of the same length of the number of items. In the former case, the pseudo-guessing
parameters are considered to be all identical to the given <code>c</code> value; otherwise <code>c</code> is directly used to constraint these parameters.
</p>
<p>The constrained 3PL model is fitted using marginal maximum likelihood by means of the functions from the <code>ltm</code> package (Rizopoulos, 2006).
</p>


<h3>Value</h3>

<p>A matrix with one row per item and six columns: the item discrimination <em>a</em> and difficulty estimates <em>b</em>, the corresponding standard errors <em>se(a)</em> and <em>se(b)</em>, 
the covariances <em>cov(a,b)</em> and the constrained pseudo-guessing values <em>c</em>.
</p>


<h3>Note</h3>

<p>The constrained 3PL model is fitted under the linear parametrization in <code>tpm</code>, the covariance matrix is extracted with the <code>vcov()</code> function, and final standard errors and covariances are derived by the Delta method. See Rizopoulos (2006) for further details, and the <code>Note.pdf</code> document in the <code>difR</code> package for mathematical details.
</p>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

 
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Rizopoulos, D. (2006). ltm: An R package for latent variable modelling and item response theory analyses. <em>Journal of Statistical Software, 17</em>, 1&ndash;25. doi: <a href="https://doi.org/10.18637/jss.v017.i05">10.18637/jss.v017.i05</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+itemPar1PL">itemPar1PL</a></code>, <code><a href="#topic+itemPar2PL">itemPar2PL</a></code>, <code><a href="#topic+itemPar3PL">itemPar3PL</a></code>, <code><a href="#topic+itemParEst">itemParEst</a></code>, <code><a href="#topic+difLord">difLord</a></code>, <code><a href="#topic+difRaju">difRaju</a></code>, 
</p>
<p><code><a href="#topic+difGenLord">difGenLord</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)

 # Constraining all pseudo-guessing parameters to be equal to 0.05
 itemPar3PLconst(verbal[,1:24], c = 0.05)

 # Constraining pseudo-guessing values to  0.1 for the first 10 items,
 # and to 0.05 for the remaining ones
 itemPar3PLconst(verbal[,1:24], c = c(rep(0.1, 10), rep(0.05, 14)))
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='itemParEst'>Item parameter estimation for DIF detection</h2><span id='topic+itemParEst'></span>

<h3>Description</h3>

<p>Fits a specified logistic IRT model and returns related item parameter estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>itemParEst(data, model, c = NULL, engine = "ltm", discr = 1)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="itemParEst_+3A_data">data</code></td>
<td>
<p>numeric: the data matrix.</p>
</td></tr>
<tr><td><code id="itemParEst_+3A_model">model</code></td>
<td>
<p>character: the IRT model to be fitted (either <code>"1PL"</code>, <code>"2PL"</code> or <code>"3PL"</code>).</p>
</td></tr>
<tr><td><code id="itemParEst_+3A_c">c</code></td>
<td>
<p>optional numeric value or vector giving the values of the constrained pseudo-guessing parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="itemParEst_+3A_engine">engine</code></td>
<td>
<p>character: the engine for estimating the 1PL model, either <code>"ltm"</code> (default) or <code>"lme4"</code>.</p>
</td></tr>
<tr><td><code id="itemParEst_+3A_discr">discr</code></td>
<td>
<p>either <code>NULL</code> or a real positive value for the common discrimination parameter (default is 1). Used only if <code>model</code> is <code>"1PL"</code>
and <code>engine</code> is <code>"ltm"</code>. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>itemParEst</code> permits to get item parameter estimates of some pre-specified logistic IRT model, together with estimates of 
the standard errors and the covariances between item parameters, if any. The output is ordered such that it can be directly used
with the methods of Lord (<code><a href="#topic+difLord">difLord</a></code>) and Raju (<code><a href="#topic+difRaju">difRaju</a></code>) and Generalized Lord's (<code><a href="#topic+difGenLord">difGenLord</a></code>) 
to detect differential item functioning.
</p>
<p>The <code>data</code> is a matrix whose rows correspond to the subjects and columns to the items. 
</p>
<p>Missing values are allowed but must be coded as <code>NA</code> values. They are discarded for item parameter estimation.
</p>
<p>If the model is not the 1PL model, or if <code>engine</code> is equal to <code>"ltm"</code>, the selected IRT model is fitted using marginal maximum likelihood
by means of the functions from the <code>ltm</code> package (Rizopoulos, 2006). Otherwise, the 1PL model is fitted as a generalized 
linear mixed model, by means of the <code>glmer</code> function of the <code>lme4</code> package (Bates and Maechler, 2009). With the <code>"ltm"</code> engine, the 
common discrimination parameter can be either fixed to a constant value using the <code>discr</code> argument, or it can be estimated (though not returned) 
by specifying <code>discr</code> to <code>NULL</code>. The default value of the common discrimination is 1.
</p>
<p>The 3PL model can be fitted either unconstrained or by fixing the pseudo-guessing values. In the latter case the argument <code>c</code> 
holds either a numeric vector of same length of the number of items, with one value per item pseudo-guessing parameter, or a single value which
is duplicated for all the items. If <code>c</code> is different from <code>NULL</code> then the 3PL model is always fitted (whatever the value of <code>model</code>).
</p>
<p>Each row of the output matrix corresponds to one item of the <code>data</code> set; the number of columns depends on the fitted model. At most,
nine columns are produced, with the unconstrained 3PL model. The order of the columns is the following: first, the estimates of item discrimination 
<em>a</em>, difficulty <em>b</em> and pseudo-guessing <em>c</em>; second,  the corresponding standard errors <em>se(a)</em>, <em>se(b)</em> and <em>se(c)</em>; 
finally, the covariances between the item parameters, <em>cov(a,b)</em>, <em>cov(a,c)</em> and <em>cov(b,c)</em>. 
</p>
<p>If the 2PL model is fitted, only five columns are displayed: <em>a</em>, <em>b</em>, <em>se(a)</em>, <em>se(b)</em> and <em>cov(a,b)</em>. 
In case of the 1PL model, only <em>b</em> and <em>se(b)</em> are returned. If the constrained 3PL is considered, the output matrix holds six columns, 
the first five being identical to those from the 2PL model, and the last one holds the fixed pseudo-guessing parameters.
</p>


<h3>Value</h3>

<p>A matrix with one row per item and at most nine columns, with item parameter estimates, standard errors and covariances, if any. See <b>Details</b>.
</p>


<h3>Note</h3>

<p>Whenever making use of the <code>ltm</code> package to fit the IRT models, the linear parametrization is used, the covariance matrix is extracted with the <code>vcov()</code> function, and final standard errors and covariances are derived by the Delta method. See Rizopoulos (2006) for further details, and the <code>Note.pdf</code> document in the <code>difR</code> package for mathematical details.
</p>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

 
<p>Bates, D. and Maechler, M. (2009). lme4: Linear mixed-effects models using S4 classes. R package version 0.999375-31. http://CRAN.R-project.org/package=lme4
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Rizopoulos, D. (2006). ltm: An R package for latent variable modelling and item response theory analyses. <em>Journal of Statistical Software, 17</em>, 1&ndash;25. doi: <a href="https://doi.org/10.18637/jss.v017.i05">10.18637/jss.v017.i05</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+itemPar1PL">itemPar1PL</a></code>, <code><a href="#topic+itemPar2PL">itemPar2PL</a></code>, <code><a href="#topic+itemPar3PL">itemPar3PL</a></code>, <code><a href="#topic+itemPar3PLconst">itemPar3PLconst</a></code>, <code><a href="#topic+difLord">difLord</a></code>, <code><a href="#topic+difRaju">difRaju</a></code>, 
</p>
<p><code><a href="#topic+difGenLord">difGenLord</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)

 # Estimation of the item parameters (1PL model, "ltm" engine)
 items.1PL &lt;- itemParEst(verbal[,1:24], model = "1PL")

 # Estimation of the item parameters (1PL model, "ltm" engine,
 # estimated common discrimination parameter)
 items.1PL &lt;- itemParEst(verbal[,1:24], model = "1PL", discr = NULL)

 # Estimation of the item parameters (1PL model, "lme4" engine)
 items.1PL &lt;- itemParEst(verbal[,1:24], model = "1PL", engine = "lme4")

 # Estimation of the item parameters (2PL model)
 items.2PL &lt;- itemParEst(verbal[,1:24], model = "2PL")

 # Estimation of the item parameters (3PL model)
 # items.3PL &lt;- itemParEst(verbal[,1:24], model = "3PL")

 # Constraining all pseudo-guessing values to be equal to 0.05
 items.3PLc &lt;- itemParEst(verbal[,1:24], model = "3PL", c = 0.05)

## End(Not run)
</code></pre>

<hr>
<h2 id='itemRescale'>Rescaling item parameters by equal means anchoring</h2><span id='topic+itemRescale'></span>

<h3>Description</h3>

<p>Rescale the item parameters from one data set to the scale of the parameters from another data set, using equal means anchoring.</p>


<h3>Usage</h3>

<pre><code class='language-R'>itemRescale(mR, mF, items = 1:nrow(mR))
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="itemRescale_+3A_mr">mR</code></td>
<td>
<p>numeric: a matrix of item parameter estimates (one row per item) which constitutes the reference scale. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="itemRescale_+3A_mf">mF</code></td>
<td>
<p>numeric: a matrix of item parameter estimates (one row per item) which have to be rescaled. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="itemRescale_+3A_items">items</code></td>
<td>
<p>a numeric vector of integer values specifying which items are used for equal means anchoring. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The matrices <code>mR</code> and <code>mF</code> must have the same format as the output of the command <code><a href="#topic+itemParEst">itemParEst</a></code> and one the possible models (1PL, 2PL,
3PL or constrained 3PL). The number of columns therefore equals two, five, nine or six, respectively.
</p>
<p>Rescaling is performed by equal means anchoring (Cook and Eignor, 1991). The items involved in the anchoring process are specified by means of their row
number in either <code>mR</code> or <code>mF</code>, and are passed through the <code>items</code> argument.
</p>
<p><code>itemRescale</code> primarily serves as a routine for item purification in Lord (<code><a href="#topic+difLord">difLord</a></code>) and Raju (<code><a href="#topic+difRaju">difRaju</a></code>) 
Generalized Lord's (<code><a href="#topic+difGenLord">difGenLord</a></code>) methods of DIF identification (Candell and Drasgow, 1988).
</p>


<h3>Value</h3>

<p>A matrix of the same format as <code>mF</code> with the rescaled item parameters.
</p>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Candell, G.L. and Drasgow, F. (1988). An iterative procedure for linking metrics and assessing item bias in item response theory. <em>Applied Psychological Measurement, 12</em>, 253&ndash;260. doi: <a href="https://doi.org/10.1177/014662168801200304">10.1177/014662168801200304</a> 
</p>
<p>Cook, L. L. and Eignor, D. R. (1991). An NCME instructional module on IRT equating methods. <em>Educational Measurement: Issues and Practice, 10</em>, 37-45.
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+itemPar1PL">itemPar1PL</a></code>, <code><a href="#topic+itemPar2PL">itemPar2PL</a></code>,  <code><a href="#topic+itemPar3PL">itemPar3PL</a></code>, <code><a href="#topic+itemPar3PLconst">itemPar3PLconst</a></code>, <code><a href="#topic+difLord">difLord</a></code>, <code><a href="#topic+difRaju">difRaju</a></code>, 
</p>
<p><code><a href="#topic+difGenLord">difGenLord</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Splitting the data set into reference and focal groups
 nF &lt;- sum(Gender)
 nR &lt;- nrow(verbal)-nF
 data.ref &lt;- verbal[,1:24][order(Gender),][1:nR,]
 data.focal &lt;- verbal[,1:24][order(Gender),][(nR+1):(nR+nF),]

 # Estimating item parameters in each data set with 1PL model
 mR &lt;- itemPar1PL(data.ref)
 mF &lt;- itemPar1PL(data.focal)

 # Rescaling focal group item parameters, using all items for anchoring
 itemRescale(mR, mF)

 # Rescaling focal group item parameters, using the first 10 items for anchoring
 itemRescale(mR, mF, items = 1:10)

 # Estimating item parameters in each data set with 2PL model
 mR &lt;- itemPar2PL(data.ref)
 mF &lt;- itemPar2PL(data.focal)

 # Rescaling focal group item parameters, using all items for anchoring
 itemRescale(mR, mF)
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='Logistik'>Logistic regression DIF statistic</h2><span id='topic+Logistik'></span>

<h3>Description</h3>

<p>Calculates the &quot;logistic regression&quot; likelihood-ratio statistics and effect sizes
for DIF detection. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Logistik(data, member, member.type = "group", match = "score",
	 anchor = 1:ncol(data), type = "both", criterion = "LRT", all.cov = FALSE)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Logistik_+3A_data">data</code></td>
<td>
<p>numeric: the data matrix (one row per subject, one column per item).</p>
</td></tr>
<tr><td><code id="Logistik_+3A_member">member</code></td>
<td>
<p>numeric or factor: the vector of group membership. Can either take two distinct values (zero for the reference group and one for the focal group) or be a continuous vector. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Logistik_+3A_member.type">member.type</code></td>
<td>
<p>character: either <code>"group"</code> (default) to specify that group membership is made of two groups, or <code>"cont"</code> to indicate that group membership is based on a  continuous criterion. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Logistik_+3A_match">match</code></td>
<td>
<p>specifies the type of matching criterion. Can be either <code>"score"</code> (default) to compute the test score, or any continuous or discrete variable with the same length as the number of rows of <code>data</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Logistik_+3A_anchor">anchor</code></td>
<td>
<p>a vector of integer values specifying which items (all by default) are currently considered as anchor (DIF free) items. Ignored if <code>match</code> is not <code>"score"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Logistik_+3A_type">type</code></td>
<td>
<p>a character string specifying which DIF effects must be tested. Possible values are <code>"both"</code> (default), <code>"udif"</code> and <code>"nudif"</code>. 
See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Logistik_+3A_criterion">criterion</code></td>
<td>
<p>a character string specifying which DIF statistic is computed. Possible values are <code>"LRT"</code> (default) or <code>"Wald"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Logistik_+3A_all.cov">all.cov</code></td>
<td>
<p>logical: should <em>all</em> covariance matrices of model parameter estimates be returned (as lists) for both nested models and all items? (default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This command computes the logistic regression statistic (Swaminathan and Rogers, 1990) in the specific framework of differential item functioning. 
It forms the basic command of <code><a href="#topic+difLogistic">difLogistic</a></code> and is specifically designed for this call.
</p>
<p>If the <code>member.type</code> argument is set to <code>"group"</code>, the <code>member</code> argument must be a vector with two distinct (numeric or factor) values, say 0 and 1 (for the reference and focal groups respectively). Those values are internally transformed onto factors to denote group membership. The three possible models to be fitted are then:
</p>
<p style="text-align: center;"><code class="reqn">M_0: logit (\pi_g) = \alpha + \beta X + \gamma_g + \delta_g X</code>
</p>

<p style="text-align: center;"><code class="reqn">M_1: logit (\pi_g) = \alpha + \beta X + \gamma_g</code>
</p>

<p style="text-align: center;"><code class="reqn">M_2: logit (\pi_g) = \alpha + \beta X</code>
</p>

<p>where <code class="reqn">\pi_g</code> is the probability of answering correctly the item in group <em>g</em> and <code class="reqn">X</code> is the matching variable. Parameters <code class="reqn">\alpha</code> and 
<code class="reqn">\beta</code> are the intercept and the slope of the logistic curves (common to all groups), while <code class="reqn">\gamma_g</code> and <code class="reqn">\delta_g</code> are group-specific
parameters. For identification reasons the parameters <code class="reqn">\gamma_0</code> and <code class="reqn">\delta_0</code> for reference group (<code class="reqn">g=0</code>) are set to zero. The parameter
<code class="reqn">\gamma_1</code> of the focal group (<code class="reqn">g=1</code>) represents the uniform DIF effect, and the parameter <code class="reqn">\delta_1</code> is used to model nonuniform DIF 
effect. The models are fitted with the <code><a href="stats.html#topic+glm">glm</a></code> function.
</p>
<p>If <code>member.type</code> is set to <code>"cont"</code>, then &quot;group membership&quot; is replaced by a continuous or discrete variable, given by the <code>member</code> argument, and the models above are written as
</p>
<p style="text-align: center;"><code class="reqn">M_0: logit (\pi_g) = \alpha + \beta X + \gamma Y+ \delta X Y</code>
</p>

<p style="text-align: center;"><code class="reqn">M_1: logit (\pi_g) = \alpha + \beta X + \gamma Y</code>
</p>

<p style="text-align: center;"><code class="reqn">M_2: logit (\pi_g) = \alpha + \beta X</code>
</p>

<p>where <code>Y</code> is the group variable. Parameters <code class="reqn">\gamma</code> and <code class="reqn">\delta</code> act now as the <code class="reqn">\gamma_1</code> and <code class="reqn">\delta_1</code> DIF parameters.
</p>
<p>The matching criterion can be either the test score or any other continuous or discrete variable to be passed in the <code>Logistik</code> function. This is specified by the <code>match</code> argument. By default, it takes the value <code>"score"</code> and the test score (i.e. raw score) is computed. The second option is to assign to <code>match</code> a vector of continuous or discrete numeric values, which acts as the matching criterion. Note that for consistency this vector should not belong to the <code>data</code> matrix.
</p>
<p>Two types of DIF statistics can be computed: the likelihood ratio test statistics, obtained by comparing the fit of two nested models,
and the Wald statistics, obtained with an appropriate contrast matrix for testing the model parameters (Johnson and Wichern, 1998).
These are specified by the argument <code>criterion</code>, with respective values <code>"LRT"</code> and <code>"Wald"</code>. By default, the LRT
statistics are computed.
</p>
<p>If <code>criterion</code> is <code>"LRT"</code>, the argument <code>type</code> determines the models to be compared by means of the LRT statistics.
The three possible values of <code>type</code> are: <code>type="both"</code> (default) which tests the hypothesis <code class="reqn">H_0: \gamma_1 = \delta_1=0</code> (or <code class="reqn">H_0: \gamma = \delta=0</code>) by comparing models <code class="reqn">M_0</code> and <code class="reqn">M_2</code>; <code>type="nudif"</code> which tests the hypothesis <code class="reqn">H_0: \delta_1 = 0</code> (or <code class="reqn">H_0: \delta = 0</code>) by comparing models <code class="reqn">M_0</code> and <code class="reqn">M_1</code>; and <code>type="udif"</code>
which tests the hypothesis <code class="reqn">H_0: \gamma_1 = 0</code> (or <code class="reqn">H_0: \gamma = 0</code>) by comparing models <code class="reqn">M_1</code> and <code class="reqn">M_2</code> (assuming that <code class="reqn">\delta_1 = 0</code> or <code class="reqn">\delta = 0</code>). In other words, <code>type="both"</code>
tests for DIF (without distinction between uniform and nonuniform effects), while <code>type="udif"</code> and <code>type="nudif"</code> test for uniform and nonuniform DIF,
respectively. 
</p>
<p>If <code>criterion</code> is <code>"Wald"</code>, the argument <code>type</code> determines the logistic model to be considered and the appropriate contrast matrix. 
If <code>type=="both"</code>, the considered model is model <code class="reqn">M_0</code> and the contrast matrix has two rows, (0,0,1,0) and (0,0,0,1). If <code>type=="nudif"</code>, 
the considered model is also model <code class="reqn">M_0</code> but the contrast matrix has only one row, (0,0,0,1). Eventually, if <code>type=="udif"</code>, the considered model
is model <code class="reqn">M_1</code> and the contrast matrix has one row, (0,0,1). 
</p>
<p>The data are passed through the <code>data</code> argument, with one row per subject and one column per item. Missing values are allowed but must be coded as <code>NA</code>
values. They are discarded from the fitting of the logistic models (see <code><a href="stats.html#topic+glm">glm</a></code> for further details).
</p>
<p>The vector of group membership, specified with <code>member</code> argument, must hold only zeros and ones, a value of zero corresponding to the
reference group and a value of one to the focal group.
</p>
<p>Option <code>anchor</code> sets the items which are considered as anchor items for computing the test scores and related logistic regression DIF statistics. Items other than the anchor items and the tested item are discarded. <code>anchor</code> must hold integer values specifying the column numbers of the corresponding anchor items. It is mainly designed to perform item purification. Note that this option is discarded when <code>match</code> is not <code>"score"</code>.
</p>
<p>The output contains: the selected DIF statistics (either the LRT or the Wald statistic) computed for each item, two matrices with the parameter estimates of
both models (for each item) and two matrices of related standard error values. In addition, Nagelkerke's <code class="reqn">R^2</code> coefficients (Nagelkerke, 1991) are computed for each model and the output returns both, the vectors of <code class="reqn">R^2</code> coefficients for each model and the differences in these coefficients. Such differences are used as measures of effect size by the <code><a href="#topic+difLogistic">difLogistic</a></code> command; see Gomez-Benito, Dolores Hidalgo and Padilla
(2009), Jodoin and Gierl (2001) and Zumbo and Thomas (1997). The <code>criterion</code> and <code>member.type</code> arguments are also returned, as well as a character argument named <code>match</code> that specifies the type of matching criterion that was used.
</p>


<h3>Value</h3>

 
<p>A list with nine components:
</p>
<table role = "presentation">
<tr><td><code>stat</code></td>
<td>
<p>the values of the logistic regression DIF statistics.</p>
</td></tr>
<tr><td><code>R2M0</code></td>
<td>
<p>the values of Nagelkerke's R^2 coefficients for the &quot;full&quot; model.</p>
</td></tr>
<tr><td><code>R2M1</code></td>
<td>
<p>the values of Nagelkerke's R^2 coefficients for the &quot;simpler&quot; model.</p>
</td></tr>
<tr><td><code>deltaR2</code></td>
<td>
<p>the differences between Nagelkerke's <code class="reqn">R^2</code> coefficients of the tested models. See <b>Details</b>.</p>
</td></tr>
<tr><td><code>parM0</code></td>
<td>
<p>a matrix with one row per item and four columns, holding successively the fitted parameters <code class="reqn">\hat{\alpha}</code>, <code class="reqn">\hat{\beta}</code>, <code class="reqn">\hat{\gamma}_1</code>
and <code class="reqn">\hat{\delta}_1</code> of the &quot;full&quot; model (<code class="reqn">M_0</code> if <code>type="both"</code> or <code>type="nudif"</code>, <code class="reqn">M_1</code> if <code>type="udif"</code>).</p>
</td></tr>
<tr><td><code>parM1</code></td>
<td>
<p>the same matrix as <code>parM0</code> but with fitted parameters for the &quot;simpler&quot; model (<code class="reqn">M_1</code> if <code>type="nudif"</code>, <code class="reqn">M_2</code> if <code>type="both"</code>
or <code>type="udif"</code>).</p>
</td></tr>
<tr><td><code>seM0</code></td>
<td>
<p>a matrix with the standard error values of the parameter estimates in matrix <code>parM0</code>.</p>
</td></tr>
<tr><td><code>seM1</code></td>
<td>
<p>a matrix with the standard error values of the parameter estimates in matrix <code>parM1</code>.</p>
</td></tr> 
<tr><td><code>cov.M0</code></td>
<td>
<p>either <code>NULL</code> (if <code>all.cov</code> argument is <code>FALSE</code>) or a list of covariance matrices of parameter estimates of the &quot;full&quot; model (<code class="reqn">M_0</code>) for each item (if <code>all.cov</code> argument is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code>cov.M1</code></td>
<td>
<p>either <code>NULL</code> (if <code>all.cov</code> argument is <code>FALSE</code>) or a list of covariance matrices of parameter estimates of the &quot;reduced&quot; model (<code class="reqn">M_1</code>) for each item (if <code>all.cov</code> argument is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code>criterion</code></td>
<td>
<p>the value of the <code>criterion</code> argument.</p>
</td></tr>
<tr><td><code>member.type</code></td>
<td>
<p>the value of the <code>member.type</code> argument.</p>
</td></tr>
<tr><td><code>match</code></td>
<td>
<p>a character string, either <code>"score"</code> or <code>"matching variable"</code> depending on the <code>match</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Gomez-Benito, J., Dolores Hidalgo, M. and Padilla, J.-L. (2009). Efficacy of effect size measures in logistic regression: an application for detecting DIF. 
<em>Methodology, 5</em>, 18-25. doi: <a href="https://doi.org/10.1027/1614-2241.5.1.18">10.1027/1614-2241.5.1.18</a>
</p>
<p>Jodoin, M. G. and Gierl, M. J. (2001). Evaluating Type I error and power rates using an effect size measure with logistic regression procedure for DIF detection. <em>Applied Measurement in Education, 14</em>, 329-349. doi: <a href="https://doi.org/10.1207/S15324818AME1404_2">10.1207/S15324818AME1404_2</a>
</p>
<p>Johnson, R. A. and Wichern, D. W. (1998). <em>Applied multivariate statistical analysis (fourth edition)</em>. Upper Saddle River, NJ: Prentice-Hall.
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Nagelkerke, N. J. D. (1991). A note on a general definition of the coefficient of determination. <em>Biometrika, 78</em>, 691-692. doi: <a href="https://doi.org/10.1093/biomet/78.3.691">10.1093/biomet/78.3.691</a>
</p>
<p>Swaminathan, H. and Rogers, H. J. (1990). Detecting differential item functioning using logistic regression procedures. <em>Journal of Educational 
Measurement, 27</em>, 361-370. doi: <a href="https://doi.org/10.1111/j.1745-3984.1990.tb00754.x">10.1111/j.1745-3984.1990.tb00754.x</a>
</p>
<p>Zumbo, B. D. and Thomas, D. R. (1997). A measure of effect size for a model-based approach for studying DIF. Prince George, Canada: University of Northern British
Columbia, Edgeworth Laboratory for Quantitative Behavioral Science.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difLogistic">difLogistic</a></code>, <code><a href="#topic+dichoDif">dichoDif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)

 # Testing both types of DIF simultaneously
 # With all items, test score as matching criterion
 Logistik(verbal[,1:24], verbal[,26])

 # Returning all covariance matrices of model parameters
 Logistik(verbal[,1:24], verbal[,26], all.cov = TRUE)

 # Testing both types of DIF simultaneously
 # With all items and Wald test
 Logistik(verbal[,1:24], verbal[,26], criterion = "Wald")

 # Removing item 6 from the set of anchor items
 Logistik(verbal[,1:24], verbal[,26], anchor = c(1:5, 7:24))

 # Testing for nonuniform DIF
 Logistik(verbal[,1:24], verbal[,26], type = "nudif")

 # Testing for uniform DIF
 Logistik(verbal[,1:24], verbal[,26], type = "udif")

 # Using the "anger" trait variable as matching criterion
 Logistik(verbal[,1:24],verbal[,26], match = verbal[,25])

 # Using the "anger" trait variable as group membership
 Logistik(verbal[,1:24],verbal[,25], member.type = "cont")
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='LordChi2'>Lord's chi-square DIF statistic</h2><span id='topic+LordChi2'></span>

<h3>Description</h3>

<p>Calculates the Lord's chi-square statistics for DIF detection. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LordChi2(mR, mF)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LordChi2_+3A_mr">mR</code></td>
<td>
<p>numeric: the matrix of item parameter estimates (one row per item) for the reference group. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="LordChi2_+3A_mf">mF</code></td>
<td>
<p>numeric: the matrix of item parameter estimates (one row per item) for the focal group. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This command computes the Lord's chi-square statistic (Lord, 1980) in the specific framework of differential item functioning. It forms the basic command 
of <code><a href="#topic+difLord">difLord</a></code> and is specifically designed for this call.
</p>
<p>The matrices <code>mR</code> and <code>mF</code> must have the same format as the output of the command <code><a href="#topic+itemParEst">itemParEst</a></code> with one the possible models (1PL, 2PL,
3PL or constrained 3PL). The number of columns therefore equals two, five, nine or six, respectively. Moreover, item parameters of the focal must be on the
same scale of that of the reference group. If not, make use of e.g. equal means anchoring (Cook and Eignor, 1991) and <code><a href="#topic+itemRescale">itemRescale</a></code> to transform 
them adequately. 
</p>


<h3>Value</h3>

<p>A vector with the values of the Lord's chi-square DIF statistics.
</p>


<h3>Note</h3>

<p>WARNING: the previous versions of <code>LordChi2</code> were holding an error: under the 3PL model, the covariance matrices <code class="reqn">Sig_1</code> and <code class="reqn">Sig_2</code> were wrongly 
computed as the variance of the pseudo-guessing parameters were replaced by the parameter estimates. This has been fixed from version 4.0 of <code>difR</code>.
Many thanks to J. Patrick Meyer (Curry School of Education, University of Virginia) for having discovered this mistake.
</p>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Cook, L. L. and Eignor, D. R. (1991). An NCME instructional module on IRT equating methods. <em>Educational Measurement: Issues and Practice, 10</em>, 37-45.
</p>
<p>Lord, F. (1980). <em>Applications of item response theory to practical testing problems</em>. Hillsdale, NJ: Lawrence Erlbaum Associates. 
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+itemParEst">itemParEst</a></code>, <code><a href="#topic+itemRescale">itemRescale</a></code>, <code><a href="#topic+difLord">difLord</a></code>, <code><a href="#topic+dichoDif">dichoDif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Splitting the data into reference and focal groups
 nF &lt;- sum(Gender)
 nR &lt;- nrow(verbal)-nF
 data.ref &lt;- verbal[, 1:24][order(Gender),][1:nR,]
 data.focal &lt;- verbal[, 1:24][order(Gender),][(nR+1):(nR+nF),]

 # Pre-estimation of the item parameters (1PL model)
 mR &lt;- itemParEst(data.ref, model = "1PL")
 mF &lt;- itemParEst(data.focal, model = "1PL")
 mF &lt;- itemRescale(mR, mF)
 LordChi2(mR, mF)

 # Pre-estimation of the item parameters (2PL model)
 mR &lt;- itemParEst(data.ref, model = "2PL")
 mF &lt;- itemParEst(data.focal, model = "2PL")
 mF &lt;- itemRescale(mR, mF)
 LordChi2(mR, mF)

 # Pre-estimation of the item parameters (constrained 3PL model)
 mR &lt;- itemParEst(data.ref, model = "3PL", c = 0.05)
 mF &lt;- itemParEst(data.focal, model = "3PL", c = 0.05)
 mF &lt;- itemRescale(mR, mF)
 LordChi2(mR, mF)
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='LRT'>Likelihood-Ratio Test DIF statistic</h2><span id='topic+LRT'></span>

<h3>Description</h3>

<p>Calulates Likelihoo-Ratio Test (LRT) statistics for DIF detection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LRT(data, member)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LRT_+3A_data">data</code></td>
<td>
<p>numeric: the data matrix (one row per subject, one column per item).</p>
</td></tr>
<tr><td><code id="LRT_+3A_member">member</code></td>
<td>
<p>numeric: the vector of group membership with zero and one entries only. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This command computes the likelihood-ratio test statistic (Thissen, Steinberg and Wainer, 1988) in the specific framework of differential item functioning. 
It forms the basic command of <code><a href="#topic+difLRT">difLRT</a></code> and is specifically designed for this call.
</p>
<p>The data are passed through the <code>data</code> argument, with one row per subject and one column per item. Missing values are allowed but must be coded as <code>NA</code> values.
</p>
<p>The vector of group membership, specified with <code>member</code> argument, must hold only zeros and ones, a value of zero corresponding to the
reference group and a value of one to the focal group.
</p>
<p>The LRT DIF statistic is computed for each item separately, using all other items as anchor items.
</p>


<h3>Value</h3>

<p>A vector with the values of the LRT DIF statistics. 
</p>


<h3>Note</h3>

<p>Because of the fitting of the modified Rasch model with <code>glmer</code> the process can be very time consuming (see the <b>Details</b> section of <code><a href="#topic+difLRT">difLRT</a></code>). 
</p>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Bates, D. and Maechler, M. (2009). lme4: Linear mixed-effects models using S4 classes. R package version 0.999375-31. http://CRAN.R-project.org/package=lme4
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Thissen, D., Steinberg, L. and Wainer, H. (1988). Use of item response theory in the study of group difference in trace lines. 
In H. Wainer and H. Braun (Eds.), <em>Test validity</em>. Hillsdale, NJ: Lawrence Erlbaum Associates.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difLRT">difLRT</a></code>, <code><a href="#topic+dichoDif">dichoDif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Excluding the "Anger" variable
 verbal &lt;- verbal[colnames(verbal)!="Anger"]

 # Keeping the first 5 items and the first 50 subjects
 # (this is an artificial simplification to reduce the computational time)
 # Sixth column holds the group membership
 verbal &lt;- verbal[1:50, c(1:5, 25)]

 # Likelihood-ratio statistics
 LRT(verbal[,1:5], verbal[,6])
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='mantelHaenszel'>Mantel-Haenszel DIF statistic</h2><span id='topic+mantelHaenszel'></span>

<h3>Description</h3>

<p>Calculates Mantel-Haenszel statistics for DIF detection. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mantelHaenszel(data, member, match = "score", correct = TRUE, exact = FALSE,
  anchor = 1:ncol(data))
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mantelHaenszel_+3A_data">data</code></td>
<td>
<p>numeric: the data matrix (one row per subject, one column per item).</p>
</td></tr>
<tr><td><code id="mantelHaenszel_+3A_member">member</code></td>
<td>
<p>numeric: the vector of group membership with zero and one entries only. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="mantelHaenszel_+3A_match">match</code></td>
<td>
<p>specifies the type of matching criterion. Can be either <code>"score"</code> (default) to compute the test score, or any continuous or discrete variable with the same length as the number of rows of <code>data</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="mantelHaenszel_+3A_correct">correct</code></td>
<td>
<p>logical: should the continuity correction be used? (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="mantelHaenszel_+3A_exact">exact</code></td>
<td>
<p>logical: should an exact test be computed? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="mantelHaenszel_+3A_anchor">anchor</code></td>
<td>
<p>a vector of integer values specifying which items (all by default) are currently considered as anchor
(DIF free) items. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This command basically computes the Mantel-Haenszel (1959) statistic in the specific framework of differential item 
functioning. It forms the basic command of <code><a href="#topic+difMH">difMH</a></code> and is specifically designed for this call.
</p>
<p>The data are passed through the <code>data</code> argument, with one row per subject and one column per item. 
</p>
<p>Missing values are allowed for item responses (not for group membership) but must be coded as <code>NA</code> values. They 
are discarded from sum-score computation.
</p>
<p>The vector of group membership, specified with <code>member</code> argument, must hold only zeros and ones, a value of zero 
corresponding to the reference group and a value of one to the focal group.
</p>
<p>The matching criterion can be either the test score or any other continuous or discrete variable to be passed in the <code>mantelHaenszel</code> function. This is specified by the <code>match</code> argument. By default, it takes the value <code>"score"</code> and the test score (i.e. raw score) is computed. The second option is to assign to <code>match</code> a vector of continuous or discrete numeric values, which acts as the matching criterion. Note that for consistency this vector should not belong to the <code>data</code> matrix.
</p>
<p>By default, the continuity correction factor -0.5 is used (Holland and Thayer, 1988). One can nevertheless remove it by 
specifying <code>correct=FALSE</code>.
</p>
<p>By default, the asymptotic Mantel-Haenszel statistic is computed. However, the exact statistics and related P-values can be obtained by specifying the logical argument <code>exact</code> to <code>TRUE</code>. See Agresti (1990, 1992) for further details about exact inference.
</p>
<p>Option <code>anchor</code> sets the items which are considered as anchor items for computing Mantel-Haenszel statistics. Items
other than the anchor items and the tested item are discarded. <code>anchor</code> must hold integer values specifying the column numbers of the corresponding anchor items. It is primarily designed to perform item purification.
</p>
<p>In addition to the Mantel-Haenszel statistics to identify DIF items, <code>mantelHaenszel</code> computes the estimates of the
common odds ratio <code class="reqn">\alpha_{MH}</code> which are used for measuring the effect size of the items (Holland and Thayer, 1985, 1988). They are returned in the <code>resAlpha</code> argument of the output list. Moreover, the logarithm of 
<code class="reqn">\alpha_{MH}</code>, say <code class="reqn">\lambda_{MH}</code>, is asymptotically distributed and its variance is computed and returned into
the <code>varLambda</code> argument. Note that this variance is the one proposed by Philips and Holland (1987), since it seems
the most accurate expression for the variance of <code class="reqn">\lambda_{MH}</code> (Penfield and Camilli, 2007).
</p>


<h3>Value</h3>

<p>A list with several arguments:
</p>
<table role = "presentation">
<tr><td><code>resMH</code></td>
<td>
<p>the vector of the Mantel-Haenszel DIF statistics (either asymptotic or exact).</p>
</td></tr>
<tr><td><code>resAlpha</code></td>
<td>
<p>the vector of the (asymptotic) Mantel-Haenszel estimates of the common odds ratios. Returned only if
<code>exact</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code>varLambda</code></td>
<td>
<p>the (asymptotic) variance of the <code class="reqn">\lambda_{MH}</code> statistic. Returned only if <code>exact</code> is 
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code>Pval</code></td>
<td>
<p>the exact P-values of the MH test. Returned only if <code>exact</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>match</code></td>
<td>
<p>a character string, either <code>"score"</code> or <code>"matching variable"</code> depending on the <code>match</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Agresti, A. (1990). <em>Categorical data analysis</em>. New York: Wiley.
</p>
<p>Agresti, A. (1992). A survey of exact inference for contingency tables. <em>Statistical Science, 7</em>, 131-177. doi: <a href="https://doi.org/10.1214/ss/1177011454">10.1214/ss/1177011454</a>
</p>
<p>Holland, P. W. and Thayer, D. T. (1985). An alternative definition of the ETS delta scale of item difficulty. 
<em>Research Report RR-85-43</em>. Princeton, NJ: Educational Testing Service.
</p>
<p>Holland, P. W. and Thayer, D. T. (1988). Differential item performance and the Mantel-Haenszel procedure. In H. Wainer
and H. I. Braun (Ed.), <em>Test validity</em>. Hillsdale, NJ: Lawrence Erlbaum Associates.
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Mantel, N. and Haenszel, W. (1959). Statistical aspects of the analysis of data from retrospective studies of disease. 
<em>Journal of the National Cancer Institute, 22</em>, 719-748.
</p>
<p>Penfield, R. D., and Camilli, G. (2007). Differential item functioning and item bias. In C. R. Rao and S. Sinharray 
(Eds.), <em>Handbook of Statistics 26: Psychometrics</em> (pp. 125-167). Amsterdam, The Netherlands: Elsevier.
</p>
<p>Philips, A., and Holland, P. W. (1987). Estimators of the Mantel-Haenszel log odds-ratio estimate. <em>Biometrics, 43</em>, 425-431. doi: <a href="https://doi.org/10.2307/2531824">10.2307/2531824</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difMH">difMH</a></code>, <code><a href="#topic+dichoDif">dichoDif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)

 # With and without continuity correction
 mantelHaenszel(verbal[,1:24], verbal[,26])
 mantelHaenszel(verbal[,1:24], verbal[,26], correct = FALSE)
 
 # Exact test
 mantelHaenszel(verbal[,1:24], verbal[,26], exact = TRUE)

 # Removing item 6 from the set of anchor items
 mantelHaenszel(verbal[,1:24], verbal[,26], anchor = c(1:5,7:24))
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='RajuZ'>Raju's area DIF statistic</h2><span id='topic+RajuZ'></span>

<h3>Description</h3>

<p>Calculates the Raju's statistics for DIF detection. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RajuZ(mR, mF, signed = FALSE)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RajuZ_+3A_mr">mR</code></td>
<td>
<p>numeric: the matrix of item parameter estimates (one row per item) for the reference group. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="RajuZ_+3A_mf">mF</code></td>
<td>
<p>numeric: the matrix of item parameter estimates (one row per item) for the focal group. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="RajuZ_+3A_signed">signed</code></td>
<td>
<p>logical: should the <em>signed</em> area be computed, or the <em>unsigned</em> (i.e. in absolute value) ara?
Default is <code>FALSE</code>, i.e. the unsigned area. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This command computes the Raju's area statistic (Raju, 1988, 1990) in the specific framework of differential item functioning. It forms the basic command 
of <code><a href="#topic+difRaju">difRaju</a></code> and is specifically designed for this call.
</p>
<p>The matrices <code>mR</code> and <code>mF</code> must have the same format as the output of the command <code><a href="#topic+itemParEst">itemParEst</a></code> and one the possible models (1PL, 2PL
or constrained 3PL). The number of columns therefore equals two, five or six, respectively. Note that the unconstrained 3PL model cannot be used in this 
method: all pseudo-guessing parameters must be equal in both groups of subjects. Moreover, item parameters of the focal must be on the  same scale of that 
of the reference group. If not, make use of e.g. equal means anchoring (Cook and Eignor, 1991) and <code><a href="#topic+itemRescale">itemRescale</a></code> to transform them adequately. 
</p>
<p>By default, the <em>unsigned</em> area, given by Equation (57) in Raju (1990), is computed. It makes use of Equations (14), (15), (23) and
(46) for the numerator, and Equations (17), (33) to (39), and (52) for the denominator of the <em>Z</em> statistic. However, the
<em>signed</em> area, given by Equation (56) in Raju (1990), can be used instead. In this case, Equations (14), (21) and (44) are used
for the numerator, and Equations (17), (25) and (48) for the denominator. The choice of the type of area is fixed by the logical
<em>signed</em> argument, with default value <code>FALSE</code>. 
</p>


<h3>Value</h3>

<p>A list with two components:
</p>
<table role = "presentation">
<tr><td><code>res</code></td>
<td>
<p>a matrix with one row per item and three columns, holding respectively Raju's area between the two item characteristic curves, its 
standard error and the Raju DIF statistic (the latter being the ratio of the first two columns).</p>
</td></tr>
<tr><td><code>signed</code></td>
<td>
<p>the value of the <code>signed</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Cook, L. L. and Eignor, D. R. (1991). An NCME instructional module on IRT equating methods. <em>Educational Measurement: Issues and Practice, 10</em>, 37-45.
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Raju, N.S. (1988). The area between two item characteristic curves. <em>Psychometrika, 53</em>, 495-502. doi: <a href="https://doi.org/10.1007/BF02294403">10.1007/BF02294403</a>
</p>
<p>Raju, N. S. (1990). Determining the significance of estimated signed and unsigned areas between two item response functions. <em>Applied Psychological Measurement, 14</em>, 197-207. doi: <a href="https://doi.org/10.1177/014662169001400208">10.1177/014662169001400208</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+itemParEst">itemParEst</a></code>, <code><a href="#topic+itemRescale">itemRescale</a></code>, <code><a href="#topic+difRaju">difRaju</a></code>, <code><a href="#topic+dichoDif">dichoDif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Splitting the data into reference and focal groups
 nF &lt;- sum(Gender)
 nR &lt;- nrow(verbal)-nF
 data.ref &lt;- verbal[,1:24][order(Gender),][1:nR,]
 data.focal &lt;- verbal[,1:24][order(Gender),][(nR+1):(nR+nF),]

 # Pre-estimation of the item parameters (1PL model)
 mR &lt;- itemParEst(data.ref,model = "1PL")
 mF &lt;- itemParEst(data.focal,model = "1PL")
 mF &lt;- itemRescale(mR, mF)

 # Signed and unsigned Raju statistics
 RajuZ(mR, mF)
 RajuZ(mR, mF, signed = TRUE)

 # Pre-estimation of the item parameters (2PL model)
 mR &lt;- itemParEst(data.ref, model = "2PL")
 mF &lt;- itemParEst(data.focal, model = "2PL")
 mF &lt;- itemRescale(mR, mF)

 # Signed and unsigned Raju statistics
 RajuZ(mR, mF)
 RajuZ(mR, mF, signed = TRUE)
 
 # Pre-estimation of the item parameters (constrained 3PL model)
 mR &lt;- itemParEst(data.ref, model = "3PL", c = 0.05)
 mF &lt;- itemParEst(data.focal, model = "3PL", c =0 .05)
 mF &lt;- itemRescale(mR, mF)
 
 # Signed and unsigned Raju statistics
 RajuZ(mR, mF)
 RajuZ(mR, mF, signed = TRUE)
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='selectDif'>Selection of one of the DIF detection methods</h2><span id='topic+selectDif'></span>

<h3>Description</h3>

<p>This function performs DIF detection for one pre-specified method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selectDif(Data, group, focal.name, method, anchor = NULL, props = NULL, 
 	thrTID = 1.5, alpha = 0.05, MHstat = "MHChisq", correct = TRUE, 
 	exact = FALSE, stdWeight = "focal", thrSTD = 0.1, BDstat = "BD", 
 	member.type = "group", match = "score", type = "both", criterion = "LRT", 
 	model = "2PL", c = NULL, engine = "ltm", discr = 1, irtParam = NULL, 
 	same.scale = TRUE, signed = FALSE, purify = FALSE, purType = "IPP1", 
 	nrIter = 10, extreme = "constraint", const.range = c(0.001, 0.999), 
 	nrAdd = 1, p.adjust.method = NULL, save.output = FALSE, 
 	output = c("out", "default"))
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="selectDif_+3A_data">Data</code></td>
<td>
<p>numeric: either the data matrix only, or the data matrix plus the vector of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_group">group</code></td>
<td>
<p>numeric or character: either the vector of group membership or the column indicator (within data) of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_focal.name">focal.name</code></td>
<td>
<p>numeric or character indicating the level of <code>group</code> which corresponds to the focal group.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_method">method</code></td>
<td>
<p>character: the name of the selected method. Possible values are <code>"TID"</code>, <code>"MH"</code>, <code>"Std"</code>, <code>"Logistic"</code>, <code>"BD"</code>, <code>"SIBTEST"</code>, <code>"Lord"</code>, <code>"Raju"</code> and <code>"LRT"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_anchor">anchor</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of item names (or identifiers) to specify the anchor items. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_props">props</code></td>
<td>
<p>either <code>NULL</code> (default) or a two-column matrix with proportions of success in the reference group and the focal group. See <b>Details </b>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_thrtid">thrTID</code></td>
<td>
<p>numeric: the threshold for detecting DIF items with TID method (default is 1.5).</p>
</td></tr>
<tr><td><code id="selectDif_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="selectDif_+3A_mhstat">MHstat</code></td>
<td>
<p>character: specifies the DIF statistic to be used for DIF identification. Possible values are <code>"MHChisq"</code> (default) and <code>"logOR"</code>. See <b>Details </b>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_correct">correct</code></td>
<td>
<p>logical: should the continuity correction be used? (default is TRUE).</p>
</td></tr>
<tr><td><code id="selectDif_+3A_exact">exact</code></td>
<td>
<p>logical: should an exact test be computed? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="selectDif_+3A_stdweight">stdWeight</code></td>
<td>
<p>character: the type of weights used for the standardized P-DIF statistic. Possible values are <code>"focal"</code> (default), <code>"reference"</code> and <code>"total"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_thrstd">thrSTD</code></td>
<td>
<p>numeric: the threshold (cut-score) for standardized P-DIF statistic (default is 0.10).</p>
</td></tr>
<tr><td><code id="selectDif_+3A_bdstat">BDstat</code></td>
<td>
<p>character specifying the DIF statistic to be used. Possible values are <code>"BD"</code> (default) and <code>"trend"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_member.type">member.type</code></td>
<td>
<p>character: either <code>"group"</code> (default) to specify that group membership is made of two groups, or <code>"cont"</code> to indicate that group membership is based on a  continuous criterion. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_match">match</code></td>
<td>
<p>specifies the type of matching criterion. Can be either <code>"score"</code> (default) to compute the test score, or any continuous or discrete variable with the same length as the number of rows of <code>Data</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_type">type</code></td>
<td>
<p>a character string specifying which DIF effects must be tested. Possible values are <code>"both"</code> (default), <code>"udif"</code> and <code>"nudif"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_criterion">criterion</code></td>
<td>
<p>a character string specifying which DIF statistic is computed. Possible values are <code>"LRT"</code> (default) or <code>"Wald"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_model">model</code></td>
<td>
<p>character: the IRT model to be fitted (either <code>"1PL"</code>, <code>"2PL"</code> or <code>"3PL"</code>). Default is <code>"2PL"</code>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_c">c</code></td>
<td>
<p>optional numeric value or vector giving the values of the constrained pseudo-guessing parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_engine">engine</code></td>
<td>
<p>character: the engine for estimating the 1PL model, either <code>"ltm"</code> (default) or <code>"lme4"</code>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_discr">discr</code></td>
<td>
<p>either <code>NULL</code> or a real positive value for the common discrimination parameter (default is 1). Used onlky if <code>model</code> is <code>"1PL"</code> and <code>engine</code> is <code>"ltm"</code>. See <b>Details</b>.</p>
</td></tr> 
<tr><td><code id="selectDif_+3A_irtparam">irtParam</code></td>
<td>
<p>matrix with <em>2J</em> rows (where <em>J</em> is the number of items) and at most 9 columns containing item parameters estimates. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_same.scale">same.scale</code></td>
<td>
<p>logical: are the item parameters of the <code>irtParam</code> matrix on the same scale? (default is &quot;TRUE&quot;). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_signed">signed</code></td>
<td>
<p>logical: should the Raju's statistics be computed using the signed (<code>TRUE</code>) or unsigned (<code>FALSE</code>, default) area? See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_purify">purify</code></td>
<td>
<p>logical: should the method be used iteratively to purify the set of anchor items? (default is FALSE).</p>
</td></tr>
<tr><td><code id="selectDif_+3A_purtype">purType</code></td>
<td>
<p>character: the type of purification process to be run. Possible values are <code>"IPP1"</code> (default), <code>"IPP2"</code> and <code>"IPP3"</code>. Ignored if <code>purify</code> is <code>FALSE</code> or if <code>method</code> is not <code>"TID"</code>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item purification process (default is 10).</p>
</td></tr>
<tr><td><code id="selectDif_+3A_extreme">extreme</code></td>
<td>
<p>character: the method used to modify the extreme proportions. Possible values are <code>"constraint"</code> (default) or <code>"add"</code>. Ignored if <code>method</code> is not <code>"TID"</code>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_const.range">const.range</code></td>
<td>
<p>numeric: a vector of two constraining proportions. Default values are 0.001 and 0.999. Ignored if <code>method</code> is not <code>"TID"</code> or if <code>extreme</code> is <code>"add"</code>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_nradd">nrAdd</code></td>
<td>
<p>integer: the number of successes and the number of failures to add to the data in order to adjust the proportions. Default value is 1. Ignored if <code>method</code> is not <code>"TID"</code> or if <code>extreme</code> is <code>"constraint"</code>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>either <code>NULL</code> (default) or the acronym of the method for p-value adjustment for multiple comparisons. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectDif_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved into a text file? (Default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="selectDif_+3A_output">output</code></td>
<td>
<p>character: a vector of two components. The first component is the name of the output file, the second component is either the file path or 
<code>"default"</code> (default value). See <b>Details</b>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This is a generic function which calls one of the DIF detection methods and displays its output. It is mainly used as a routine for <code><a href="#topic+dichoDif">dichoDif</a></code> command.
</p>
<p>The possible methods are: 
</p>

<ol>
<li><p><code>"TID"</code> for Transformed Item Difficulties (TID) method (Angoff and Ford, 1973),
</p>
</li>
<li><p><code>"MH"</code> for mantel-Haenszel (Holland and Thayer, 1988),
</p>
</li>
<li><p><code>"Std"</code> for standardization (Dorans and Kulick, 1986),
</p>
</li>
<li><p><code>"BD"</code> for Breslow-Day method (Penfield, 2003),
</p>
</li>
<li><p><code>"Logistic"</code> for logistic regression (Swaminathan and Rogers, 1990),
</p>
</li>
<li><p><code>"SIBTEST"</code> for SIBTEST (Shealy and Stout) and Crossing-SIBTEST (Chalmers, 2018; Li and Stout, 1996) methods,
</p>
</li>
<li><p><code>"Lord"</code> for Lord's chi-square test (Lord, 1980), 
</p>
</li>
<li><p><code>"Raju"</code> for Raju's area method (Raju, 1990), and
</p>
</li>
<li><p><code>"LRT"</code> for likelihood-ratio test method (Thissen, Steinberg and Wainer, 1988).
</p>
</li></ol>

<p>The <code>Data</code> is a matrix whose rows correspond to the subjects and columns to the items. In addition, <code>Data</code> can hold the vector of group membership. If so, <code>group</code> indicates the column of <code>Data</code> which corresponds to the group membership, either by specifying its name or by giving the column number. Otherwise, <code>group</code> must be a vector of same length as <code>nrow(Data)</code>.
</p>
<p>Missing values are allowed for item responses (not for group membership) but must be coded as <code>NA</code> values. They are discarded from either the computation of the sum-scores, the fitting of the logistic models or the IRT models (according to the method).
</p>
<p>The vector of group membership must hold only two different values, either as numeric or character. The focal group is defined by the argument <code>focal.name</code>. 
</p>
<p>For <code>"MH"</code>, <code>"Std"</code>, <code>"Logistic"</code> and <code>"BD"</code> methods, the matching criterion can be either the test score or any other continuous or discrete variable to be passed in the selected DIF function. This is specified by the <code>match</code> argument. By default, it takes the value <code>"score"</code> and the test score (i.e. raw score) is computed. The second option is to assign to <code>match</code> a vector of continuous or discrete numeric values, which acts as the matching criterion. Note that for consistency this vector should not belong to the <code>Data</code> matrix.
</p>
<p>For Lord and Raju methods, one can specify either the IRT model to be fitted (by means of <code>model</code>, <code>c</code>, <code>engine</code> and <code>discr</code> arguments), or the item parameter estimates with arguments <code>irtParam</code> and <code>same.scale</code>. See <code><a href="#topic+difLord">difLord</a></code> and <code><a href="#topic+difRaju">difRaju</a></code> for further details. 
</p>
<p>The threshold for detecting DIF items depends on the method. For standardization it has to be fully specified (with the <code>thr</code> argument), as well as for the TID method (through the <code>thrTID</code> argument). For the other methods it is depending on the significance level set by <code>alpha</code>.
</p>
<p>For Mantel-Haenszel method, the DIF statistic can be either the Mantel-Haenszel chi-square statistic or the log odds-ratio statistic. The method is specified by the argument <code>MHstat</code>, and the default value is <code>"MHChisq"</code> for the chi-square statistic. Moreover, the option <code>correct</code> specifies whether the continuity correction has to be applied to Mantel-Haenszel statistic. See <code><a href="#topic+difMH">difMH</a></code> for further details.
</p>
<p>By default, the asymptotic Mantel-Haenszel statistic is computed. However, the exact statistics and related P-values can be obtained by specifying the logical argument <code>exact</code> to <code>TRUE</code>. See Agresti (1990, 1992) for further details about exact inference.
</p>
<p>The weights for computing the standardized P-DIF statistics are defined through the argument <code>stdWeight</code>, with possible values <code>"focal"</code> (default value), <code>"reference"</code> and <code>"total"</code>. See <code><a href="#topic+stdPDIF">stdPDIF</a></code> for further details. 
</p>
<p>For Breslow-Day method, two test statistics are available: the usual Breslow-Day statistic for testing homogeneous association (Aguerri, Galibert, Attorresi and Maranon, 2009) and the trend test statistic for assessing some monotonic trend in the odds ratios (Penfield, 2003). The DIF statistic is supplied by the <code>BDstat</code> argument, with values <code>"BD"</code> (default) for the usual statistic and <code>"trend"</code> for the trend test statistic.
</p>
<p>The SIBTEST method (Shealy and Stout, 1993) and its modified version, the Crossing-SIBTEST (Chalmers, 2018; Li and Stout, 1996) are returned by the <code><a href="#topic+difSIBTEST">difSIBTEST</a></code> function. SIBTEST method is returned when <code>type</code> argument is set to <code>"udif"</code>, while Crossing-SIBTEST is set with <code>"nudif"</code> value for the <code>type</code> argument. Note that <code>type</code> takes the by-default value <code>"both"</code> which is not allowed within the <code><a href="#topic+difSIBTEST">difSIBTEST</a></code> function; however, within this fucntion, keeping the by-default value yields selection of Crossing-SIBTEST.
</p>
<p>The <code><a href="#topic+difSIBTEST">difSIBTEST</a></code> function is a wrapper to the <code><a href="mirt.html#topic+SIBTEST">SIBTEST</a></code> function from the <b>mirt</b> package (Chalmers, 2012) to fit within the <code>difR</code> framework (Magis et al., 2010). Therefore, if you are using this function for publication purposes please cite Chalmers (2018; 2012) and Magis et al. (2010).
</p>
<p>For logistic regression, the argument <code>type</code> permits to test either both uniform and nonuniform effects simultaneously (<code>type="both"</code>), only uniform DIF effect (<code>type="udif"</code>) or only nonuniform DIF effect (<code>type="nudif"</code>). The <code>criterion</code> argument specifies the DIF statistic to be computed, either the likelihood ratio test statistic (with <code>criterion="LRT"</code>) or the Wald test (with <code>criterion="Wald"</code>). Moreover, the group membership can be either a vector of two distinct values, one for the reference group and one for the focal group, or a continuous or discrete variable that acts as the &quot;group&quot; membership variable. In the former case, the <code>member.type</code> argument is set to <code>"group"</code> and the <code>focal.name</code> defines which value in the <code>group</code> variable stands for the focal group. In the latter case, <code>member.type</code> is set to <code>"cont"</code>, <code>focal.name</code> is ignored and each value of the <code>group</code> represents one &quot;group&quot; of data (that is, the DIF effects are investigated among participants relying on different values of some discrete or continuous trait). See <code><a href="#topic+Logistik">Logistik</a></code> for further details.
</p>
<p>For Raju's method, the type of area (signed or unsigned) is fixed by the logical <code>signed</code> argument, with default value <code>FALSE</code> (i.e. unsigned areas). See <code><a href="#topic+RajuZ">RajuZ</a></code> for further details.
</p>
<p>Item purification can be requested by specifying <code>purify</code> option to <code>TRUE</code>. Recall that item purification is slightly different for IRT and for non-IRT based methods. See the corresponding methods for further information.
</p>
<p>Adjustment for multiple comparisons is possible with the argument <code>p.adjust.method</code>. See the corresponding methods for further information.
</p>
<p>A pre-specified set of anchor items can be provided through the <code>anchor</code> argument. For non-IRT methods, anchor items are used to compute the test score (as matching criterion). For IRT methods, anchor items are used to rescale the item parameters on a common metric. See the corresponding methods for further information. Note that <code>anchor</code> argument is not working with <code>"LRT"</code> method.
</p>
<p>The output of the selected method can be stored in a text file by fixing <code>save.output</code> and <code>output</code> appropriately. See the help file of the corresponding method for further information.
</p>


<h3>Value</h3>

<p>The output of the selected DIF detection method.
</p>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Agresti, A. (1990). <em>Categorical data analysis</em>. New York: Wiley.
</p>
<p>Agresti, A. (1992). A survey of exact inference for contingency tables. <em>Statistical Science, 7</em>, 131-177. doi: <a href="https://doi.org/10.1214/ss/1177011454">10.1214/ss/1177011454</a>
</p>
<p>Aguerri, M.E., Galibert, M.S., Attorresi, H.F. and Maranon, P.P. (2009). Erroneous detection of nonuniform DIF using the Breslow-Day test in a short test. <em>Quality and Quantity, 43</em>, 35-44. doi: <a href="https://doi.org/10.1007/s11135-007-9130-2">10.1007/s11135-007-9130-2</a>
</p>
<p>Angoff, W. H., and Ford, S. F. (1973). Item-race interaction on a test of scholastic aptitude. <em>Journal of Educational Measurement, 2</em>, 95-106. doi: <a href="https://doi.org/10.1111/j.1745-3984.1973.tb00787.x">10.1111/j.1745-3984.1973.tb00787.x</a>
</p>
<p>Chalmers, R. P. (2012). mirt: A Multidimensional item response
theory package for the R environment. <em>Journal of Statistical Software, 48(6)</em>, 1-29. doi: <a href="https://doi.org/10.18637/jss.v048.i06">10.18637/jss.v048.i06</a>
</p>
<p>Chalmers, R. P. (2018). Improving the Crossing-SIBTEST statistic for detecting non-uniform DIF. <em>Psychometrika, 83</em>(2), 376&ndash;386. doi: <a href="https://doi.org/10.1007/s11336-017-9583-8">10.1007/s11336-017-9583-8</a>
</p>
<p>Dorans, N. J. and Kulick, E. (1986). Demonstrating the utility of the standardization approach to assessing unexpected differential item performance on the 
Scholastic Aptitude Test. <em>Journal of Educational Measurement, 23</em>, 355-368. doi: <a href="https://doi.org/10.1111/j.1745-3984.1986.tb00255.x">10.1111/j.1745-3984.1986.tb00255.x</a>
</p>
<p>Holland, P. W. and Thayer, D. T. (1988). Differential item performance and the Mantel-Haenszel procedure. In H. Wainer and H. I. Braun (Dirs.), 
<em>Test validity</em>. Hillsdale, NJ: Lawrence Erlbaum Associates.
</p>
<p>Li, H.-H., and Stout, W. (1996). A new procedure for detection of crossing DIF. <em>Psychometrika, 61</em>, 647&ndash;677. doi: <a href="https://doi.org/10.1007/BF02294041">10.1007/BF02294041</a>
</p>
<p>Lord, F. (1980). <em>Applications of item response theory to practical testing problems</em>. Hillsdale, NJ: Lawrence Erlbaum Associates.
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Penfield, R.D. (2003). Application of the Breslow-Day test of trend in odds ratio heterogeneity to the detection of nonuniform DIF. <em>Alberta Journal of 
Educational Research, 49</em>, 231-243.
</p>
<p>Raju, N. S. (1990). Determining the significance of estimated signed and unsigned areas between two item response functions. <em>Applied Psychological Measurement, 14</em>, 197-207. doi: <a href="https://doi.org/10.1177/014662169001400208">10.1177/014662169001400208</a>
</p>
<p>Shealy, R. and Stout, W. (1993). A model-based standardization approach that separates true bias/DIF from group ability differences and detect test bias/DTF as well as item bias/DIF. <em>Psychometrika, 58</em>, 159-194. doi: <a href="https://doi.org/10.1007/BF02294572">10.1007/BF02294572</a>
</p>
<p>Swaminathan, H. and Rogers, H. J. (1990). Detecting differential item functioning using logistic regression procedures. <em>Journal of Educational 
Measurement, 27</em>, 361-370. doi: <a href="https://doi.org/10.1111/j.1745-3984.1990.tb00754.x">10.1111/j.1745-3984.1990.tb00754.x</a>
</p>
<p>Thissen, D., Steinberg, L. and Wainer, H. (1988). Use of item response theory in the study of group difference in trace lines. In H. Wainer and H. Braun (Eds.), <em>Test validity</em>. Hillsdale, NJ: Lawrence Erlbaum Associates.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difTID">difTID</a></code>, <code><a href="#topic+difMH">difMH</a></code>, <code><a href="#topic+difStd">difStd</a></code>, <code><a href="#topic+difBD">difBD</a></code>, <code><a href="#topic+difLogistic">difLogistic</a></code>, <code><a href="#topic+difSIBTEST">difSIBTEST</a></code>, <code><a href="#topic+difLord">difLord</a></code>, 
<code><a href="#topic+difRaju">difRaju</a></code>, <code><a href="#topic+difLRT">difLRT</a></code>, <code><a href="#topic+dichoDif">dichoDif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Excluding the "Anger" variable
 verbal &lt;- verbal[colnames(verbal)!="Anger"]

 # Calling Mantel-Haenszel 
 selectDif(verbal, group = 25, focal.name = 1, method = "MH")

 # Calling Mantel-Haenszel and saving output in 'MH.txt' file
 selectDif(verbal, group = 25, focal.name = 1, method = "MH", 
    save.output = TRUE, output = c("MH", "default"))

 # Calling Lord method
 # 2PL model, with item purification
 selectDif(verbal, group = 25, focal.name = 1, method = "Lord", model = "2PL", 
           purify = TRUE)
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='selectGenDif'>Selection of one of the DIF detection methods among multiple groups</h2><span id='topic+selectGenDif'></span>

<h3>Description</h3>

<p>This function performs DIF detection among multiple groups for one pre-specified method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selectGenDif(Data, group, focal.names, method, anchor = NULL, match = "score", 
 	type = "both", criterion = "LRT", alpha = 0.05, model = "2PL", c = NULL, 
 	engine = "ltm", discr = 1, irtParam = NULL, nrFocal = 2, same.scale = TRUE, 
 	purify = FALSE, nrIter = 10, p.adjust.method = NULL, save.output = FALSE, 
 	output = c("out", "default"))	
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="selectGenDif_+3A_data">Data</code></td>
<td>
<p>numeric: either the data matrix only, or the data matrix plus the vector of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_group">group</code></td>
<td>
<p>numeric or character: either the vector of group membership or the column indicator (within data) of group membership. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_focal.names">focal.names</code></td>
<td>
<p>numeric or character vector indicating the levels of <code>group</code> which correspond to the focal groups.</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_method">method</code></td>
<td>
<p>character: the name of the selected method. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_anchor">anchor</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of item names (or identifiers) to specify the anchor items. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_match">match</code></td>
<td>
<p>specifies the type of matching criterion. Can be either <code>"score"</code> (default) to compute the test score, or any continuous or discrete variable with the same length as the number of rows of <code>Data</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_type">type</code></td>
<td>
<p>a character string specifying which DIF effects must be tested. Possible values are <code>"both"</code> (default), <code>"udif"</code> and <code>"nudif"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_criterion">criterion</code></td>
<td>
<p>character: the type of test statistic used to detect DIF items with generalized logistic regression. Possible values are <code>"LRT"</code> (default) and <code>"Wald"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_model">model</code></td>
<td>
<p>character: the IRT model to be fitted (either <code>"1PL"</code>, <code>"2PL"</code> or <code>"3PL"</code>). Default is <code>"2PL"</code>.</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_c">c</code></td>
<td>
<p>optional numeric value or vector giving the values of the constrained pseudo-guessing parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_engine">engine</code></td>
<td>
<p>character: the engine for estimating the 1PL model, either <code>"ltm"</code> (default) or <code>"lme4"</code>.</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_discr">discr</code></td>
<td>
<p>either <code>NULL</code> or a real positive value for the common discrimination parameter (default is 1). Used onlky if <code>model</code> is <code>"1PL"</code> and <code>engine</code> is <code>"ltm"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_irtparam">irtParam</code></td>
<td>
<p>matrix with <em>2J</em> rows (where <em>J</em> is the number of items) and at most 9 columns containing item parameters estimates. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_nrfocal">nrFocal</code></td>
<td>
<p>numeric: the number of focal groups (default is 2).</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_same.scale">same.scale</code></td>
<td>
<p>logical: are the item parameters of the <code>irtParam</code> matrix on the same scale? (default is &quot;TRUE&quot;). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_purify">purify</code></td>
<td>
<p>logical: should the method be used iteratively to purify the set of anchor items? (default is FALSE).</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item purification process (default is 10).</p>
</td></tr> 
<tr><td><code id="selectGenDif_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>either <code>NULL</code> (default) or the acronym of the method for p-value adjustment for multiple comparisons. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved into a text file? (Default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="selectGenDif_+3A_output">output</code></td>
<td>
<p>character: a vector of two components. The first component is the name of the output file, the second component is either the file path or <code>"default"</code> (default value). See <b>Details</b>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This is a generic function which calls one of the DIF detection methods for multiple groups, and displays its output. It is mainly used as a routine for <code><a href="#topic+genDichoDif">genDichoDif</a></code> command.
</p>
<p>There are three possible methods currently implemented: <code>"GMH"</code> for Generalized Mantel-Haenszel (Penfield, 2001), <code>"genLogistic"</code> for generalized logistic regression (Magis, Raiche, Beland and Gerard, 2010) and <code>"genLord"</code> for generalized Lord's chi-square test (Kim, Cohen and Park, 1995).
</p>
<p>The <code>Data</code> is a matrix whose rows correspond to the subjects and columns to the items. In addition, <code>Data</code> can hold the vector of group membership. If so, <code>group</code> indicates the column of <code>Data</code> which corresponds to the group membership, either by specifying its name or by giving the column number. Otherwise, <code>group</code> must be a vector of same length as <code>nrow(Data)</code>.
</p>
<p>Missing values are allowed for item responses (not for group membership) but must be coded as <code>NA</code> values. They are discarded from either the computation of the sum-scores, the fitting of the logistic models or the IRT models (according to the method).
</p>
<p>The vector of group membership must hold at least three different values, either as numeric or character. The focal groups are defined by the values of the argument <code>focal.names</code>. 
</p>
<p>For <code>"GMH"</code> and <code>"genLogistic"</code> methods, the matching criterion can be either the test score or any other continuous or discrete variable to be passed in the selected DIF function. This is specified by the <code>match</code> argument. By default, it takes the value <code>"score"</code> and the test score (i.e. raw score) is computed. The second option is to assign to <code>match</code> a vector of continuous or discrete numeric values, which acts as the matching criterion. Note that for consistency this vector should not belong to the <code>Data</code> matrix.
</p>
<p>For the generalized logistic regression method, the argument <code>type</code> permits to test either both uniform and nonuniform effects simultaneously (with <code>type="both"</code>), only uniform DIF effect (with <code>type="udif"</code>) or only nonuniform DIF effect (with <code>type="nudif"</code>). Furthermore, the argument <code>criterion</code> defines which test must be used, either the Wald test (<code>"Wald"</code>) or the likelihood ratio test
(<code>"LRT"</code>).
</p>
<p>For generalized Lord method, one can specify either the IRT model to be fitted (by means of <code>model</code>, <code>c</code>, <code>engine</code> and <code>discr</code> arguments), or the item parameter estimates with arguments <code>irtParam</code>, <code>nrFocal</code> and <code>same.scale</code>. Moreover, the matching criterion can be either the test score or any other continuous or discrete variable to be passed in the <code>Logistik</code> function. This is specified by the <code>match</code> argument. By default, it takes the value <code>"score"</code> and the test score (i.e. raw score) is computed. The second option is to assign to <code>match</code> a vector of continuous or discrete numeric values, which acts as the matching criterion. Note that for consistency this vector should not belong to the <code>Data</code> matrix. See <code><a href="#topic+difGenLord">difGenLord</a></code> for further details. 
</p>
<p>The threshold for detecting DIF items depends on the method and is depending on the significance level set by <code>alpha</code>.
</p>
<p>Item purification can be requested by specifying <code>purify</code> option to <code>TRUE</code>. Recall that item purification is slightly different for IRT and for non-IRT based methods. See the corresponding methods for further information.
</p>
<p>Adjustment for multiple comparisons is possible with the argument <code>p.adjust.method</code>. See the corresponding methods for further information.
</p>
<p>A pre-specified set of anchor items can be provided through the <code>anchor</code> argument. For non-IRT methods, anchor items are used to compute the test score (as matching criterion). For IRT methods, anchor items are used to rescale the item parameters on a common metric. See the corresponding methods for further information. 
</p>
<p>The output of the selected method can be stored in a text file by fixing <code>save.output</code> and <code>output</code> appropriately. See the help file of the corresponding method for further information.
</p>


<h3>Value</h3>

<p>The output of the selected DIF detection method.
</p>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Kim, S.-H., Cohen, A.S. and Park, T.-H. (1995). Detection of differential item functioning in multiple groups. <em>Journal of Educational Measurement, 32</em>, 261-276. doi: <a href="https://doi.org/10.1111/j.1745-3984.1995.tb00466.x">10.1111/j.1745-3984.1995.tb00466.x</a>
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Magis, D., Raiche, G., Beland, S. and Gerard, P. (2011). A logistic regression procedure to detect differential item functioning among multiple groups. <em>International Journal of Testing, 11</em>, 365&ndash;386. doi: <a href="https://doi.org/10.1080/15305058.2011.602810">10.1080/15305058.2011.602810</a>
</p>
<p>Penfield, R. D. (2001). Assessing differential item functioning among multiple groups: a comparison of three Mantel-Haenszel procedures. <em>Applied Measurement in Education, 14</em>, 235-259. doi: <a href="https://doi.org/10.1207/S15324818AME1403_3">10.1207/S15324818AME1403_3</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difGMH">difGMH</a></code>, <code><a href="#topic+difGenLogistic">difGenLogistic</a></code>, <code><a href="#topic+difGenLord">difGenLord</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Creating four groups according to gender ("Man" or "Woman") and trait
 # anger score ("Low" or "High")
 group &lt;- rep("WomanLow", nrow(verbal))
 group[Anger&gt;20 &amp; Gender==0] &lt;- "WomanHigh"
 group[Anger&lt;=20 &amp; Gender==1] &lt;- "ManLow"
 group[Anger&gt;20 &amp; Gender==1] &lt;- "ManHigh"

 # New data set
 Verbal &lt;- cbind(verbal[,1:24], group)

 # Reference group: "WomanLow"
 names &lt;- c("WomanHigh", "ManLow", "ManHigh")

 # Calling generalized Mantel-Haenszel
 selectGenDif(Verbal, group = 25, focal.names = names, method = "GMH")

 # Calling generalized Mantel-Haenszel and saving output in 'GMH.txt' file
 selectGenDif(Verbal, group = 25, focal.name = names, method = "GMH", 
              save.output = TRUE, output = c("GMH", "default"))

 # Calling generalized logistic regression
 selectGenDif(Verbal, group = 25, focal.names = names, method = "genLogistic")

 # Calling generalized Lord method (2PL model)
 selectGenDif(Verbal, group = 25, focal.names = names, method = "genLord", 
              model = "2PL")
  
## End(Not run)
</code></pre>

<hr>
<h2 id='sibTest'>SIBTEST DIF statistic</h2><span id='topic+sibTest'></span>

<h3>Description</h3>

<p>Calculates the SIBTEST statistics for DIF detection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sibTest(data, member, anchor = 1:ncol(data), type = "udif")
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sibTest_+3A_data">data</code></td>
<td>
<p>numeric: the data matrix (one row per subject, one column per item).</p>
</td></tr>
<tr><td><code id="sibTest_+3A_member">member</code></td>
<td>
<p>numeric or factor: the vector of group membership. Can either take two distinct values (zero for the reference group and one for the focal group) or be a continuous vector. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="sibTest_+3A_anchor">anchor</code></td>
<td>
<p>a vector of integer values specifying which items (all by default) are currently considered as anchor (DIF free) items. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="sibTest_+3A_type">type</code></td>
<td>
<p>a character string specifying which DIF effects must be tested. Possible values are <code>"udif"</code> (default) and <code>"nudif"</code>. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This command computes the SIBTEST Beta coefficients and relatif DIF statistics, both for uniform (Shealy and Stout, 1993) and nonuniform (or crossing-SIBTEST; Chalmers, 2018) DIF effects. It forms the basic command of <code>difSIBTEST</code> function and is specifically designed for this call. This function provides a wrapper to the <code><a href="mirt.html#topic+SIBTEST">SIBTEST</a></code> function from the <b>mirt</b> package (Chalmers, 2012) to fit within the <code>difR</code> framework (Magis et al., 2010). Therefore, if you are using this function for publication purposes please cite Chalmers (2018; 2012).
</p>
<p>The data are passed through the <code>data</code> argument, with one row per subject and one column per item.
</p>
<p>The vector of group membership, specified with <code>member</code> argument, must hold only zeros and ones, a value of zero corresponding to the reference group and a value of one to the focal group.
</p>
<p>Option <code>anchor</code> sets the items which are considered as anchor items for computing the test scores and related SIBTEST DIF statistics. <code>anchor</code> must hold integer values specifying the column numbers of the corresponding anchor items.
If all columns of <code>data</code> are specified as anchor items, then all items are tested for DIF with the all-other-items-as-anchor strategy. If a smaller set of items is defined as the anchor set, then only items outside the <code>anchor</code> set will be tested for DIF; items belonging to this anchor set are not tested and corresponding <code>NA</code> values are returned instead.
It is mainly designed to perform item purification.
</p>
<p>The output contains: the SIBTEST Beta statistics and related standard errors; the <code>X2</code> statistics that follow an asymptotic chi-square distribution; the degrees of freedom and the corresponding p-values. The default <code>type</code> value is also returned.</p>


<h3>Value</h3>

<p>A list with six components:
</p>
<table role = "presentation">
<tr><td><code>Beta</code></td>
<td>
<p>the values of the Beta SIBTEST statistics.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>the standard errors of <code>Beta</code> values.</p>
</td></tr>
<tr><td><code>X2</code></td>
<td>
<p>the values of X^2 statistics for SIBTEST method.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the degrees of freedom for each <code>X2</code> statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-values of the SIBTEST statistics.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>the value of the <code>type</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
</p>


<h3>References</h3>

<p>Chalmers, R. P. (2012). mirt: A Multidimensional item response
theory package for the R environment. <em>Journal of Statistical Software, 48(6)</em>, 1-29. doi: <a href="https://doi.org/10.18637/jss.v048.i06">10.18637/jss.v048.i06</a>
</p>
<p>Chalmers, R. P. (2018). Improving the Crossing-SIBTEST statistic for detecting non-uniform DIF. <em>Psychometrika, 83</em>(2), 376&ndash;386. doi: <a href="https://doi.org/10.1007/s11336-017-9583-8">10.1007/s11336-017-9583-8</a>
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Shealy, R. and Stout, W. (1993). A model-based standardization approach that separates true bias/DIF from group ability differences and detect test bias/DTF as well as item bias/DIF. <em>Psychometrika, 58</em>, 159-194. doi: <a href="https://doi.org/10.1007/BF02294572">10.1007/BF02294572</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difSIBTEST">difSIBTEST</a></code>, <code><a href="#topic+dichoDif">dichoDif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)

 # Testing uniform DIF with all items
 sibTest(verbal[,1:24], verbal[,26])

 # Testing nonuniform DIF with all items
 sibTest(verbal[,1:24], verbal[,26], type = "nudif")

 # Removing item 6 from the set of anchor items
 sibTest(verbal[,1:24], verbal[,26], anchor = c(1:5, 7:24))

 # Considering items 3 to 9 as the set of anchor items
 sibTest(verbal[,1:24], verbal[,26], anchor = 3:9)

 
## End(Not run)
 </code></pre>

<hr>
<h2 id='stdPDIF'>Standardization DIF statistic</h2><span id='topic+stdPDIF'></span>

<h3>Description</h3>

<p>Calculates standardized P-difference statistics for DIF detection. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stdPDIF(data, member, match = "score", anchor = 1:ncol(data), stdWeight = "focal")
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stdPDIF_+3A_data">data</code></td>
<td>
<p>numeric: the data matrix (one row per subject, one column per item).</p>
</td></tr>
<tr><td><code id="stdPDIF_+3A_member">member</code></td>
<td>
<p>numeric: the vector of group membership with zero and one entries only. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="stdPDIF_+3A_match">match</code></td>
<td>
<p>specifies the type of matching criterion. Can be either <code>"score"</code> (default) to compute the test score, or any continuous or discrete variable with the same length as the number of rows of <code>data</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="stdPDIF_+3A_anchor">anchor</code></td>
<td>
<p>a vector of integer values specifying which items (all by default) are currently considered as anchor (DIF free) items. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="stdPDIF_+3A_stdweight">stdWeight</code></td>
<td>
<p>character: the type of weights used for the standardized P-DIF statistic. Possible values are <code>"focal"</code> (default),
<code>"reference"</code> and <code>"total"</code>. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This command computes the standardized P-DIF statistic in the specific framework of differential item functioning (Dorans and Kulick, 1986). It forms the basic
command of <code><a href="#topic+difStd">difStd</a></code> and is specifically designed for this call. In addition, the standardized alpha values (Dorans, 1989) are also computed as a basis
for effect size calculation.
</p>
<p>The standardized P-DIF statistic is a weighted average of the difference in proportions of successes in the reference group and in the focal group. The average is
computed across the test score strata. The weights can be of three kinds (Dorans, 1989; Dorans and Kulick, 1986) and are specified through the <code>stdWeight</code> 
argument: the proportion of focal groups examinees within each stratum (<code>stdWeight="focal"</code>), the proportion of reference group examinees within each stratum
(<code>stdWeight="reference"</code>), and the proportion of examinees (from both groups) within each stratum (<code>stdWeight="total"</code>). By default, the weights are
built from the focal group. 
</p>
<p>Similarly to the 'alpha' estimates of the common odds ratio for the Mantel-Haenszel method (see <code><a href="#topic+mantelHaenszel">mantelHaenszel</a></code>), the <em>standardized alpha values</em>
can be computed as rough measures of effect sizes, after a transformation to the Delta Scale (Holland, 1985). See Dorans (1989, p.228, Eqn.15) for further details. 
</p>
<p>The data are passed through the <code>data</code> argument, with one row per subject and one column per item. Missing values are allowed but must be coded as <code>NA</code>
values. They are discarded from sum-score computation.
</p>
<p>The vector of group membership, specified with <code>member</code> argument, must hold only zeros and ones, a value of zero corresponding to the reference group and a
value of one to the focal group.
</p>
<p>The matching criterion can be either the test score or any other continuous or discrete variable to be passed in the <code>stdPDIF</code> function. This is specified by the <code>match</code> argument. By default, it takes the value <code>"score"</code> and the test score (i.e. raw score) is computed. The second option is to assign to <code>match</code> a vector of continuous or discrete numeric values, which acts as the matching criterion. Note that for consistency this vector should not belong to the <code>data</code> matrix.
</p>
<p>Option <code>anchor</code> sets the items which are considered as anchor items for computing standardized P-DIF statistics. Items other than the anchor items and the
tested item are discarded. <code>anchor</code> must hold integer values specifying the column numbers of the corresponding anchor items. It is mainly designed to
perform item purification.
</p>


<h3>Value</h3>

<p>A list with three arguments:
</p>
<table role = "presentation">
<tr><td><code>resStd</code></td>
<td>
<p>the vector of the standardized P-DIF statistics.</p>
</td></tr>
<tr><td><code>resAlpha</code></td>
<td>
<p>the vector of standardized alpha values.</p>
</td></tr>
<tr><td><code>match</code></td>
<td>
<p>a character string, either <code>"score"</code> or <code>"matching variable"</code> depending on the <code>match</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Dorans, N. J. (1989). Two new approaches to assessing differential item functioning. Standardization and the Mantel-Haenszel method. <em>Applied Measurement in
Education, 2</em>, 217-233. doi: <a href="https://doi.org/10.1207/s15324818ame0203_3">10.1207/s15324818ame0203_3</a>
</p>
<p>Dorans, N. J. and Kulick, E. (1986). Demonstrating the utility of the standardization approach to assessing unexpected differential item performance on the Scholastic Aptitude Test. <em>Journal of Educational Measurement, 23</em>, 355-368. doi: <a href="https://doi.org/10.1111/j.1745-3984.1986.tb00255.x">10.1111/j.1745-3984.1986.tb00255.x</a>
</p>
<p>Holland, P. W. (1985, October). <em>On the study of differential item performance without IRT</em>. Paper presented at the meeting of 
Military Testing Association, San Diego (CA).  
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difStd">difStd</a></code>, <code><a href="#topic+dichoDif">dichoDif</a></code>, <code><a href="#topic+mantelHaenszel">mantelHaenszel</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ## Not run: 
 # Loading of the verbal data
 data(verbal)

 # All items as anchor items
 stdPDIF(verbal[,1:24], verbal[,26])

 # All items as anchor items, reference group weights
 stdPDIF(verbal[,1:24], verbal[,26], stdWeight = "reference")

 # All items as anchor items, both groups' weights
 stdPDIF(verbal[,1:24], verbal[,26], stdWeight = "total")

 # Removing item 6 from the set of anchor items
 stdPDIF(verbal[,1:24], verbal[,26], anchor = c(1:5,7:24))
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='subtestLogistic'>Testing for DIF among subgroups with generalized logistic regression</h2><span id='topic+subtestLogistic'></span><span id='topic+print.subLogistic'></span>

<h3>Description</h3>

<p>Performs the Wald test to identify DIF items among a subset of groups of examinees, using the results of generalized logistic regression for all groups. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subtestLogistic(x, items, groups, alpha = 0.05)
## S3 method for class 'subLogistic'
print(x, ...)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="subtestLogistic_+3A_x">x</code></td>
<td>
<p>an object of class &quot;genLogistic&quot;, typically the output of the <code>difGenLogistic</code> command.</p>
</td></tr>
<tr><td><code id="subtestLogistic_+3A_items">items</code></td>
<td>
<p>numeric or character: a vector of items to be tested. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="subtestLogistic_+3A_groups">groups</code></td>
<td>
<p>numeric or character: a vector of groups of examinees to be compared. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="subtestLogistic_+3A_alpha">alpha</code></td>
<td>
<p>numeric: the significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="subtestLogistic_+3A_...">...</code></td>
<td>
<p>other generic parameters for the <code>print</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This command makes use of the results from the generalized logistic regression to perform subtests between two or more groups of examinees
(Magis, Raiche, Beland and Gerard, 2010). The Wald test is used with an appropriate contrast matrix.
</p>
<p>The <code>subtestLogistic</code> command requires a preliminary output of the generalized logistic regression with all groups of examinees, preferable with the 
<code><a href="#topic+difGenLogistic">difGenLogistic</a></code> command. The object <code>x</code> is an object of class &quot;genLogistic&quot; from which subtests can be performed. The same DIF effect
(either uniform, nonuniform, or both types) is tested among the subset of groups of examinees as the one tested with all groups. It is provided b y the 
argument <code>type</code> argument of <code>x</code>. 
</p>
<p>The argument <code>items</code> is a vector of the names of the items to be tested, or their number in the data set. A single item can be specified.
</p>
<p>The argument <code>groups</code> specifies which groups of examinees are considered in this subtest routine. It is a vector of either group names or integer values.
In the latter case, the reference group is specified with the 0 (zero) value, while the focal groups are set up by their rank in the <code>x$focal.names</code> argument.
At least two groups must be specified, and all groups can be included (which leads back to the generalized logistic regression with the Wald test).
</p>
<p>The output provides, among others, the Wald statistics, the degrees of freedom and related asymptotic <em>p</em>-values for each tested item, as well as the
contrast matrix. 
</p>


<h3>Value</h3>

 
<p>A list of class &quot;subLogistic&quot; with the following components:
</p>
<table role = "presentation">
<tr><td><code>stats</code></td>
<td>
<p>a table with as many rows as tested items, and four columns: the item number, the Wald statistic, the degrees of freedom and the asymptotic 
<em>p</em>-value.</p>
</td></tr>
<tr><td><code>contrastMatrix</code></td>
<td>
<p>the contrast matrix used for testing DIF among the groups set up  by <code>groups</code>.</p>
</td></tr>
<tr><td><code>items</code></td>
<td>
<p>the value of the <code>items</code> argument.</p>
</td></tr>
<tr><td><code>groups</code></td>
<td>
<p>the value of the <code>groups</code> argument.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>the value of the <code>x$type</code> argument.</p>
</td></tr>
<tr><td><code>purification</code></td>
<td>
<p>the value of the <code>x$purification</code> argument.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the value of the <code>alpha</code> argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Beland <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:sebastien.beland.1@hotmail.com">sebastien.beland.1@hotmail.com</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br />
David Magis <br />
Department of Psychology, University of Liege <br />
Research Group of Quantitative Psychology and Individual Differences, KU Leuven <br />
<a href="mailto:David.Magis@uliege.be">David.Magis@uliege.be</a>, <a href="http://ppw.kuleuven.be/okp/home/">http://ppw.kuleuven.be/okp/home/</a> <br />
Gilles Raiche <br />
Collectif pour le Developpement et les Applications en Mesure et Evaluation (Cdame) <br />
Universite du Quebec a Montreal <br />
<a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>, <a href="http://www.cdame.uqam.ca/">http://www.cdame.uqam.ca/</a> <br /> 
</p>


<h3>References</h3>

<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Magis, D., Raiche, G., Beland, S. and Gerard, P. (2011). A logistic regression procedure to detect differential item functioning among multiple groups. <em>International Journal of Testing, 11</em>, 365&ndash;386. doi: <a href="https://doi.org/10.1080/15305058.2011.602810">10.1080/15305058.2011.602810</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difGenLogistic">difGenLogistic</a></code>, <code><a href="#topic+genDichoDif">genDichoDif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 # Loading of the verbal data
 data(verbal)
 attach(verbal)

 # Creating four groups according to gender (0 or 1) and trait anger score
 # ("Low" or "High")
 # Reference group: women with low trait anger score (&lt;=20)
 group &lt;- rep("WomanLow",nrow(verbal))
 group[Anger&gt;20 &amp; Gender==0] &lt;- "WomanHigh"
 group[Anger&lt;=20 &amp; Gender==1] &lt;- "ManLow"
 group[Anger&gt;20 &amp; Gender==1] &lt;- "ManHigh"

 # New data set
 Verbal &lt;- cbind(verbal[,1:24], group)

 # Reference group: "WomanLow"
 names &lt;- c("WomanHigh", "ManLow", "ManHigh")

 # Testing all types of DIF with all items
 rDIF &lt;- difGenLogistic(Verbal, group = 25, focal.names = names)
 rUDIF &lt;- difGenLogistic(Verbal, group = 25, focal.names = names, type = "udif")
 rNUDIF &lt;- difGenLogistic(Verbal, group = 25, focal.names = names, type = "nudif")

 # Subtests between the reference group and the first two focal groups
 # for item "S2WantShout" (item 6) and the three types of DIF
 subGroups &lt;- c("WomanLow", "WomanHigh", "ManLow")
 subtestLogistic(rDIF, items = 6, groups = subGroups)
 subtestLogistic(rUDIF, items = 6, groups = subGroups)
 subtestLogistic(rNUDIF, items = 6, groups = subGroups) 

 # Subtests between the reference group and the first focal group
 # for items "S2WantShout" (item 6) and "S3WantCurse" (item 7)
 # (only both DIF effects)
 subGroups &lt;- c("WomanLow", "WomanHigh")
 items1 &lt;- c("S2WantShout", "S3WantCurse")
 items2 &lt;- 6:7
 subtestLogistic(rDIF, items = items1, groups = subGroups)
 subtestLogistic(rDIF, items = items2, groups = subGroups)
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='verbal'>Verbal Aggression Data Set</h2><span id='topic+verbal'></span>

<h3>Description</h3>

<p>The Verbal Aggression data set comes from Vansteelandt (2000) and is made of the responses of 316 subjects (243 women 
and 73 men) to a questionnaire of 24 items, about verbal aggression. All items describe a frustrating situation together 
with a verbal aggression response. A correct answer responses is coded as 0 and 1, a value of one meaning that the subject 
would (want to) respond to the frustrating situation in an aggressive way. In addition, the <em>Trait Anger</em> score (Spielberger, 1988) 
was computed for each subject.
</p>


<h3>Format</h3>

<p>The <code>verbal</code> matrix consists of 316 rows (one per subject) and 26 columns. 
</p>
<p>The first 24 columns hold the responses to the dichotomously scored items. The 25th column holds the trait anger score for each subject. 
The 26th column is vector of the group membership; values 0 and 1 refer to women and men, respectively.
</p>
<p>Each item name starts with <code>S</code> followed by a value between 1 and 4, referring to one of the situations below:
</p>
<p><em>S1</em>: A bus fails to stop for me.
</p>
<p><em>S2</em>: I miss a train because a clerk gave me faulty information.
</p>
<p><em>S3</em>: The grocery store closes just as I am about to enter.
</p>
<p><em>S4</em>: The operator disconnects me when I had used up my last 10 cents for a call.
</p>
<p>The second part of the name is either <em>Want</em> or <em>Do</em>, and indicates whether the subject wanted to respond to the situation or actually did respond. 
</p>
<p>The third part of the name is one of the possible aggressive responses, either <em>Curse</em>, <em>Scold</em> or <em>Shout</em>.
</p>
<p>For example, item <code>S1WantShout</code> refers to the sentence: &quot;a bus fails to stop for me. I want to shout&quot;. The corresponding
item response is 1 if the subject agrees with that sentence, and 0 if not.
</p>


<h3>Source</h3>

<p>The Verbal aggression data set is taken originally from Vansteelandt (2000) and has been used as an illustrative example in De Boeck (2008), De Boeck and Wilson (2004) 
and Smits, De Boeck and Vansteelandt (2004), among others. The following URL <em>http://bear.soe.berkely.edu/EIRM/</em> permits to get access to the full data set.
</p>


<h3>References</h3>

<p>De Boeck, P. (2008). Random item IRT models. <em>Psychometrika, 73</em>, 533-559. doi: <a href="https://doi.org/10.1007/s11336-008-9092-x">10.1007/s11336-008-9092-x</a>
</p>
<p>De Boeck, P. and Wilson, M. (2004). <em>Explanatory item response models: a generalized linear and nonlinear approach</em>. New York: Springer. doi: <a href="https://doi.org/10.1007/978-1-4757-3990-9">10.1007/978-1-4757-3990-9</a>
</p>
<p>Magis, D., Beland, S., Tuerlinckx, F. and De Boeck, P. (2010). A general framework and an R package for the detection
of dichotomous differential item functioning. <em>Behavior Research Methods, 42</em>, 847-862. doi: <a href="https://doi.org/10.3758/BRM.42.3.847">10.3758/BRM.42.3.847</a>
</p>
<p>Smits, D., De Boeck, P. and Vansteelandt, K. (2004). The inhibition of verbal aggressive behavior. <em>European Journal of Personality, 18</em>, 537-555. doi: <a href="https://doi.org/10.1002/per.529">10.1002/per.529</a>
</p>
<p>Spielberger, C.D. (1988). <em>State-trait anger expression inventory research edition. Professional manual</em>. Odessa, FL: Psychological Assessment Resources.
</p>
<p>Vansteelandt, K. (2000). <em>Formal models for contextualized personality psychology</em>. Unpublished doctoral dissertation, K.U. Leuven, Belgium.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
