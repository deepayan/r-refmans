<!DOCTYPE html><html><head><title>Help for package mas</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mas}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mas-package'><p>Marker Association Studies</p></a></li>
<li><a href='#gwas'>
<p>Genome-Wide Association Studies</p></a></li>
<li><a href='#soy'><p> Soybean dataset</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Marker Association Studies</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-04-08</td>
</tr>
<tr>
<td>Author:</td>
<td>Alencar Xavier [aut, cre],
  Shizhong Xu [aut, ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alencar Xavier &lt;alenxav@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Genome-wide association analysis that accommodate membership information, variance adjustment, and correlated responses.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, truncdist</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0), methods (&ge; 3.2.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-08 16:08:18 UTC; rd7564</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-08 16:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mas-package'>Marker Association Studies</h2><span id='topic+mas-package'></span><span id='topic+mas'></span>

<h3>Description</h3>

<p>Genome-wide association analysis that accommodate membership information, variance adjustment, and correlated responses.</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> mas</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Marker Association Studies</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-04-08</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> c(person("Alencar", "Xavier", role=c("aut", "cre"), email = "alenxav@gmail.com"),person("Shizhong", "Xu", role=c("aut", "ctb")))</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Alencar Xavier [aut, cre], Shizhong Xu [aut, ctb]</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Alencar Xavier &lt;alenxav@gmail.com&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Genome-wide association analysis that accommodate membership information, variance adjustment, and correlated responses.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> Rcpp, truncdist</td>
</tr>
<tr>
 <td style="text-align: left;">
LinkingTo: </td><td style="text-align: left;"> Rcpp, RcppEigen</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 3.2.0), methods (&gt;= 3.2.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
Archs: </td><td style="text-align: left;"> x64</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
gwas                    Genome-Wide Association Studies
mas-package             Marker Association Studies
y                       Soybean dataset
</pre>


<h3>Author(s)</h3>

<p>Alencar Xavier [aut, cre], Shizhong Xu [aut, ctb]
Maintainer: Alencar Xavier &lt;alenxav@gmail.com&gt;
</p>


<h3>References</h3>

<p>Wei, J. and Xu, S., 2016. A random-model approach to QTL mapping in multiparent advanced generation intercross (MAGIC) populations. Genetics, 202(2), pp.471-486.
</p>
<p>Xavier, A. and Habier, D., 2022. A new approach fits multivariate genomic prediction models efficiently. Genetics Selection Evolution, 54(1), pp.1-15.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# load the toy dataset
data( soy ) 

# run gwas
fit1 = gwas(y[w], Z[w,], pop[w]) 
# adjust variances
fit2 = CorrectBeavis( fit1 ) 

# Compare before and after correction
plot( fit1, h2=TRUE, col=8, pch=20) # display QTL h2
plot( fit2, h2=TRUE, add=TRUE, pch=20, type='o') # adjusted QTL h2
legend('topleft',pch=16,col=c(8,1),c('Before correction','After Beavis correction'))

## End(Not run)

</code></pre>

<hr>
<h2 id='gwas'>
Genome-Wide Association Studies
</h2><span id='topic+GWAS'></span><span id='topic+gwas'></span><span id='topic+MLM'></span><span id='topic+CorrectBeavis'></span><span id='topic+print.GenModel'></span><span id='topic+plot.GenModel'></span>

<h3>Description</h3>

<p>Genome-wide association analysis that allows for integrating population membership into the analysis and information from correlated traits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GWAS(Y,GEN,M,NumPCs=3,maxit=500,logtol=-8,cores=1,verb=TRUE)
CorrectBeavis(fit,verb=TRUE)
gwas(y,GEN,m,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gwas_+3A_y">Y</code></td>
<td>
<p>Numeric matrix with phenotypic information. Columns are traits, rows are individuals. NA are allowed.</p>
</td></tr>
<tr><td><code id="gwas_+3A_gen">GEN</code></td>
<td>
<p>Numeric matrix of genotypic information. Columns are markers, rows are individuals. NA are not allowed.</p>
</td></tr>
<tr><td><code id="gwas_+3A_m">M</code></td>
<td>
<p>Numeric matrix with membership information. Columns are population classes, rows are individuals. NA are not allowed.</p>
</td></tr>
<tr><td><code id="gwas_+3A_numpcs">NumPCs</code></td>
<td>
<p>Integer indicating the number of principal components to fit the polygenic model. If set to zero, all PCs are utilized (i.e., full GBLUP model).</p>
</td></tr>
<tr><td><code id="gwas_+3A_maxit">maxit</code></td>
<td>
<p>Integer. Maximum number of iterations.</p>
</td></tr>
<tr><td><code id="gwas_+3A_logtol">logtol</code></td>
<td>
<p>Scalar. Convergerce parameter of null-model in log scale.</p>
</td></tr>
<tr><td><code id="gwas_+3A_cores">cores</code></td>
<td>
<p>Integer. Number of CPUs to use OpenMP.</p>
</td></tr>
<tr><td><code id="gwas_+3A_verb">verb</code></td>
<td>
<p>Logical. Print process status? (verbose) </p>
</td></tr>
<tr><td><code id="gwas_+3A_fit">fit</code></td>
<td>
<p>Object of class GenModel, output of the GWAS function.</p>
</td></tr>
<tr><td><code id="gwas_+3A_y">y</code></td>
<td>
<p>Numeric vector or matrix with phenotypic information.</p>
</td></tr>
<tr><td><code id="gwas_+3A_m">m</code></td>
<td>
<p>Factor, vector, or numeric matrix with membership information.</p>
</td></tr>
<tr><td><code id="gwas_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to GWAS.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>gwas</code> is a wrapper for <code>GWAS</code> that accepts vectors as inputs, suitable for single-trait analysis and discrete membership, such as family, ethnicity or population.
</p>
<p>The linear model for the genome-wide association is set as follows:
</p>
<p style="text-align: center;"><code class="reqn"> y = Xb + Zu + g + e </code>
</p>

<p>where <code class="reqn">y</code> is the response variable, <code class="reqn">Xb</code> corresponds to the fixed effect term set as the membership matrix, <code class="reqn">Zu</code> corresponds to the marker-membership interaction term, <code class="reqn">g</code> is the polygenic term defines by <code class="reqn">g=Ma</code>, where <code class="reqn">M</code> is the genotypic matrix and <code class="reqn">g</code> are marker effects, and <code class="reqn">e</code> is the residual term. The null-hypothesis term cosists of a similar model, but without <code class="reqn">Zu</code>. The significance threshold is based on the Bonferroni correction.
</p>
<p>Theorical description of the model is provided by Wei and Xu (2016). Variance components are REML estimates under the univariate case. In the multivariate case, variance and covariance components are obtained through a general-purpose REML approximation (Van Raden and Jung 1987), which yields the exact same solution as REML when all traits are observed in all individuals. The multivariate generalization is described by Xavier and Habier (2022).
</p>
<p>The package provides the function <code>MLM(Y,X,Z)</code> for users only interested in solving multivariate mixed models, which takes as input the phenotypic matrix (<code>Y</code>), design matrices of fixed effects (<code>X</code>) and random effect (<code>Z</code>), and the same controls (<code>logtol,cores</code>) as the function <code>GWAS</code>. This function uses an efficient solver without single-value decomposition, as described by Xavier and Habier (2022). 
</p>
<p>In the <code>GWAS</code> function, set <code>M=matrix(rep(1,nrow(Y)))</code> when membership is not knwon.
</p>
<p>The output of functions <code>gwas/GWAS</code> is of class &quot;GenModel&quot;, which has two custom functions: <code>plot</code> and <code>print</code>. The function <code>plot.GenModel</code> has a few arguments that allow users to choose the trait (<code>trait=1</code>), to overlay plots (<code>add=FALSE</code>), and to plot the QTL heritability instead of the association statistic (<code>h2=FALSE</code>).
</p>


<h3>Value</h3>

<p>Returns a list of class &quot;GenModel&quot; with two sublists: POLY and GWAS. The POLY list contains fixed and random effect coefficients, variance components, genetic correlations, heritability. The GWAS list provides the Wald statistics and QTL variances for each marker-trait combination, as well as the regression coefficients for each marker-population combination for the last trait.
</p>


<h3>References</h3>

<p>Van Raden, P.M. and Jung, Y.C., 1988. A general purpose approximation to restricted maximum likelihood: the tilde-hat approach. Journal of Dairy Science, 71(1), pp.187-194.
</p>
<p>Wei, J. and Xu, S., 2016. A random-model approach to QTL mapping in multiparent advanced generation intercross (MAGIC) populations. Genetics, 202(2), pp.471-486.
</p>
<p>Xavier, A. and Habier, D., 2022. A new approach fits multivariate genomic prediction models efficiently. Genetics Selection Evolution, 54(1), pp.1-15.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# load the toy dataset
data( soy ) 

# run gwas
fit1 = gwas(y, Z, pop) 
# adjust variances
fit2 = CorrectBeavis( fit1 ) 

# Compare before and after correction
plot( fit1, h2=TRUE, col=8, pch=20) # display QTL h2
plot( fit2, h2=TRUE, add=TRUE, pch=20, type='o') # adjusted QTL h2
legend('topleft',pch=16,col=c(8,1),c('Before correction','After Beavis correction'))

## End(Not run)

</code></pre>

<hr>
<h2 id='soy'> Soybean dataset </h2><span id='topic+y'></span><span id='topic+Y'></span><span id='topic+Z'></span><span id='topic+pop'></span><span id='topic+map'></span>

<h3>Description</h3>

<p>Toy dataset part of the SoyNAM. Plant height observed in a few soybean families in multiple environements.
</p>


<h3>Details</h3>

<p>Subset of the data presented in Xavier et al. (2017). The whole dataset is available in the R package NAM, through <code>data(met)</code>. Details of the soybean nested association mappging (SoyNAM) population are provided by Song et al. (2017), Xavier et al. (2018) and Diers et al. (2018).
</p>


<h3>References</h3>

<p>Xavier, A., Hall, B., Hearst, A.A., Cherkauer, K.A. and Rainey, K.M., 2017. Genetic architecture of phenomic-enabled canopy coverage in Glycine max. Genetics, 206(2), pp.1081-1089.
</p>
<p>Xavier, A., Xu, S., Muir, W.M. and Rainey, K.M., 2015. NAM: association studies in multiple populations. Bioinformatics, 31(23), pp.3862-3864.
</p>
<p>Song, Q., Yan, L., Quigley, C., Jordan, B.D., Fickus, E., Schroeder, S., Song, B.H., Charles An, Y.Q., Hyten, D., Nelson, R. and Rainey, K., 2017. Genetic characterization of the soybean nested association mapping population. The Plant Genome, 10(2), pp.plantgenome2016-10.
</p>
<p>Xavier, A., Jarquin, D., Howard, R., Ramasubramanian, V., Specht, J.E., Graef, G.L., Beavis, W.D., Diers, B.W., Song, Q., Cregan, P.B. and Nelson, R., 2018. Genome-wide analysis of grain yield stability and environmental interactions in a multiparental soybean population. G3: Genes, Genomes, Genetics, 8(2), pp.519-529.
</p>
<p>Diers, B.W., Specht, J., Rainey, K.M., Cregan, P., Song, Q., Ramasubramanian, V., Graef, G., Nelson, R., Schapaugh, W., Wang, D. and Shannon, G., 2018. Genetic architecture of soybean yield and agronomic traits. G3: Genes, Genomes, Genetics, 8(10), pp.3367-3375.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soy)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
