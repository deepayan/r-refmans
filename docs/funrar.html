<!DOCTYPE html><html><head><title>Help for package funrar</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {funrar}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#combination_trait_dist'><p>Compute Multiple distance matrices from a single trait table</p></a></li>
<li><a href='#compute_dist_matrix'><p>Compute a Functional Dissimilarity Matrix</p></a></li>
<li><a href='#distinctiveness'><p>Functional Distinctiveness on site-species matrix</p></a></li>
<li><a href='#distinctiveness_alt'><p>Truncated Functional Distinctiveness</p></a></li>
<li><a href='#distinctiveness_com'><p>Functional Distinctiveness for a single community</p></a></li>
<li><a href='#distinctiveness_dimensions'><p>Distinctiveness across combinations of traits</p></a></li>
<li><a href='#distinctiveness_global'><p>Global/Regional Functional Distinctiveness from dissimilarity matrix</p></a></li>
<li><a href='#distinctiveness_range'><p>Alternative Truncated Functional Distinctiveness</p></a></li>
<li><a href='#distinctiveness_stack'><p>Functional Distinctiveness on a stacked data.frame</p></a></li>
<li><a href='#funrar'><p>Compute all Functional Rarity Indices from Matrices</p></a></li>
<li><a href='#funrar_stack'><p>Compute all Functional Rarity Indices from stacked data.frames</p></a></li>
<li><a href='#is_relative'><p>Tell if matrix or data.frame has relative abundances</p></a></li>
<li><a href='#make_relative'><p>Relative abundance matrix from absolute abundance matrix</p></a></li>
<li><a href='#matrix_to_stack'><p>Matrix to stacked (= tidy) data.frame</p></a></li>
<li><a href='#restrictedness'><p>Geographical Restrictedness on site-species matrix</p></a></li>
<li><a href='#restrictedness_stack'><p>Geographical Restrictedness for stacked data.frame</p></a></li>
<li><a href='#scarcity'><p>Scarcity on site-species matrix</p></a></li>
<li><a href='#scarcity_com'><p>Scarcity for a single community</p></a></li>
<li><a href='#scarcity_stack'><p>Scarcity on a stacked data.frame</p></a></li>
<li><a href='#stack_to_matrix'><p>Stacked (= tidy) data.frame to matrix</p></a></li>
<li><a href='#uniqueness'><p>Functional Uniqueness for site-species matrix matrix</p></a></li>
<li><a href='#uniqueness_dimensions'><p>Uniqueness across combinations of traits</p></a></li>
<li><a href='#uniqueness_stack'><p>Functional Uniqueness on stacked data.frame</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Functional Rarity Indices Computation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes functional rarity indices as proposed by Violle et al.
    (2017) &lt;<a href="https://doi.org/10.1016%2Fj.tree.2017.02.002">doi:10.1016/j.tree.2017.02.002</a>&gt;. Various indices can be computed
    using both regional and local information. Functional Rarity combines both
    the functional aspect of rarity as well as the extent aspect of rarity.
    'funrar' is presented in Grenié et al. (2017) &lt;<a href="https://doi.org/10.1111%2Fddi.12629">doi:10.1111/ddi.12629</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.2)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>cluster, Matrix, methods, stats</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://rekyt.github.io/funrar/">https://rekyt.github.io/funrar/</a>, <a href="https://github.com/Rekyt/funrar">https://github.com/Rekyt/funrar</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Rekyt/funrar/issues">https://github.com/Rekyt/funrar/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ade4, ggplot2, knitr, rmarkdown, testthat (&ge; 2.99.0),
tidytext</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-23 14:58:15 UTC; ke76dimu</td>
</tr>
<tr>
<td>Author:</td>
<td>Matthias Grenié <a href="https://orcid.org/0000-0002-4659-7522"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Pierre Denelle <a href="https://orcid.org/0000-0001-5037-2281"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Caroline Tucker <a href="https://orcid.org/0000-0002-4871-2010"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  François Munoz <a href="https://orcid.org/0000-0001-8776-4705"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ths],
  Cyrille Violle <a href="https://orcid.org/0000-0002-2471-9226"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matthias Grenié &lt;matthias.grenie@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-23 15:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='combination_trait_dist'>Compute Multiple distance matrices from a single trait table</h2><span id='topic+combination_trait_dist'></span>

<h3>Description</h3>

<p>Internal function to compute combinations of distance matrices from a
data.frame of traits, using <code><a href="#topic+compute_dist_matrix">compute_dist_matrix()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combination_trait_dist(traits_table, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combination_trait_dist_+3A_traits_table">traits_table</code></td>
<td>
<p>a data.frame of traits with species in row and traits in
columns, <strong>row names</strong> should be <strong>species names</strong>,</p>
</td></tr>
<tr><td><code id="combination_trait_dist_+3A_...">...</code></td>
<td>
<p>additional arguments supplied to <code><a href="#topic+compute_dist_matrix">compute_dist_matrix()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of functional distance matrices, one for each provided trait
plus an additional matrix for all traits taken altogether
</p>

<hr>
<h2 id='compute_dist_matrix'>Compute a Functional Dissimilarity Matrix</h2><span id='topic+compute_dist_matrix'></span><span id='topic+distance_matrix'></span>

<h3>Description</h3>

<p>Wrapper for <code><a href="cluster.html#topic+daisy">cluster::daisy()</a></code> function in <code>cluster</code> package,
to compute distance matrix of trait between each pair of species present in
given <code>traits_table</code>, each row represents a species and each column
a trait. To be able to compute other metrics <code>traits_table</code> must have
species name as row names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_dist_matrix(
  traits_table,
  metric = "gower",
  center = FALSE,
  scale = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_dist_matrix_+3A_traits_table">traits_table</code></td>
<td>
<p>a data.frame of traits with species in row and traits in
columns, <strong>row names</strong> should be <strong>species names</strong>,</p>
</td></tr>
<tr><td><code id="compute_dist_matrix_+3A_metric">metric</code></td>
<td>
<p>character vector in list <code>'gower'</code>, <code>'manhattan'</code>,
<code>'euclidean'</code> defining the type of distance to use (see <code><a href="cluster.html#topic+daisy">cluster::daisy()</a></code>),
see Details section,</p>
</td></tr>
<tr><td><code id="compute_dist_matrix_+3A_center">center</code></td>
<td>
<p>logical that defines if traits should be centered (only in the
case of <code>'euclidean'</code> distance)</p>
</td></tr>
<tr><td><code id="compute_dist_matrix_+3A_scale">scale</code></td>
<td>
<p>logical that defines if traits should be scaled (only in the
case of <code>'euclidean'</code> distance)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functional distance matrix can be computed using any type of
distance metric. When traits are both quantitative and qualitative Gower's
(Gower, 1971; Podani, 1999) distance can be used. Otherwise, any other
distance metric (Euclidean, Manhattan, Minkowski) can be used - as long
as the rows and the columns are named following the species. When using
mixed data consider also Gower's distance extension by Pavoine et al.
(2009). <strong>IMPORTANT NOTE</strong>: in order to get functional rarity indices
between 0 and 1, the distance metric has to be scaled between 0 and 1.
</p>


<h3>Value</h3>

<p>A functional distance matrix, <strong>column</strong> and <strong>row</strong> names follow
<strong>species name</strong> from <code>traits_table</code> row names.
</p>


<h3>References</h3>

<div class="sourceCode"><pre>Gower, J.C. (1971) A general coefficient of similarity and some of its
properties. Biometrics, 857–871.

Podani, J. (1999) Extending Gower’s general coefficient of similarity
to ordinal characters. Taxon, 331–340.

Pavoine, S., Vallet, J., Dufour, A.-B., Gachet, S., &amp; Daniel, H. (2009)
On the challenge of treating various types of variables: application for
improving the measurement of functional diversity. Oikos, 118, 391–402.
</pre></div>


<h3>See Also</h3>

<p><code><a href="cluster.html#topic+daisy">cluster::daisy()</a></code> which this function wraps, base <code><a href="stats.html#topic+dist">stats::dist()</a></code>
or <code><a href="ade4.html#topic+dist.ktab">ade4::dist.ktab()</a></code> for Pavoine et al. (2009) extension of Gower's
distance.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)  # For reproducibility
trait = data.frame(
   sp = paste("sp", 1:5),
   trait_1 = runif(5),
   trait_2 = as.factor(c("A", "A", "A", "B", "B")))

rownames(trait) = trait$sp

dist_mat = compute_dist_matrix(trait[, -1])

</code></pre>

<hr>
<h2 id='distinctiveness'>Functional Distinctiveness on site-species matrix</h2><span id='topic+distinctiveness'></span>

<h3>Description</h3>

<p>Computes functional distinctiveness from a site-species matrix (containing
presence-absence or relative abundances) of species with provided functional
distance matrix. The sites-species matrix should have <strong>sites</strong> in
<strong>rows</strong> and <strong>species</strong> in <strong>columns</strong>, similar to
<span class="pkg">vegan</span> package defaults.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distinctiveness(pres_matrix, dist_matrix, relative = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distinctiveness_+3A_pres_matrix">pres_matrix</code></td>
<td>
<p>a site-species matrix (presence-absence or relative
abundances), with sites in rows and species in columns</p>
</td></tr>
<tr><td><code id="distinctiveness_+3A_dist_matrix">dist_matrix</code></td>
<td>
<p>a species functional distance matrix</p>
</td></tr>
<tr><td><code id="distinctiveness_+3A_relative">relative</code></td>
<td>
<p>a logical indicating if distinctiveness should be scaled
relatively to the community (scaled by max functional
distance among the species of the targeted community)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Functional Distinctiveness of a species is the average functional
distance from a species to all the other in the given community. It is
computed as such:
</p>
<p style="text-align: center;"><code class="reqn">
   D_i = \frac{\sum_{j = 0, i \neq j}^N d_{ij}}{N-1},
   </code>
</p>

<p>with <code class="reqn">D_i</code> the functional distinctiveness of species <code class="reqn">i</code>, <code class="reqn">N</code>
the total number of species in the community and <code class="reqn">d_{ij}</code> the
functional distance between species <code class="reqn">i</code> and species <code class="reqn">j</code>.
<strong>IMPORTANT NOTE</strong>: in order to get functional rarity indices between 0
and 1, the distance metric has to be scaled between 0 and 1.
</p>


<h3>Value</h3>

<p>a similar matrix from provided <code>pres_matrix</code> with Distinctiveness
values in lieu of presences or relative abundances, species absent from
communities will have an <code>NA</code> value (see <code>Note</code> section)
</p>


<h3>Note</h3>

<p>Absent species should be coded by <code>0</code> or <code>NA</code> in input matrices.
</p>
<p>When a species is alone in its community the functional distinctiveness
cannot be computed (denominator = 0 in formula), and its value is assigned
as <code>NaN</code>.
</p>
<p>For speed and memory efficiency sparse matrices can be used as input of
the function using <code>as(pres_matrix, "dgCMatrix")</code> from the
<code>Matrix</code> package.
(see <code>vignette("sparse_matrices", package = "funrar")</code>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("aravo", package = "ade4")
# Site-species matrix
mat = as.matrix(aravo$spe)

# Compute relative abundances
mat = make_relative(mat)

# Example of trait table
tra = aravo$traits[, c("Height", "SLA", "N_mass")]
# Distance matrix
dist_mat = compute_dist_matrix(tra)

di = distinctiveness(pres_matrix = mat, dist_matrix = dist_mat)
di[1:5, 1:5]

# Compute distinctiveness for all species in the regional pool
# i.e., with all the species in all the communities
# Here considering each species present evenly in the regional pool
reg_pool = matrix(1, ncol = ncol(mat))
colnames(reg_pool) = colnames(mat)
row.names(reg_pool) = c("Regional_pool")

reg_di = distinctiveness(reg_pool, dist_mat)

</code></pre>

<hr>
<h2 id='distinctiveness_alt'>Truncated Functional Distinctiveness</h2><span id='topic+distinctiveness_alt'></span>

<h3>Description</h3>

<p>Computes functional distinctiveness from a site-species matrix (containing
presence-absence or relative abundances) of species with provided functional
distance matrix considering only species <strong>within a given range</strong> in the
functional space. Basically species are cutoff when their dissimilarity is
above the input threshold. The sites-species matrix should have <strong>sites</strong> in
<strong>rows</strong> and <strong>species</strong> in <strong>columns</strong>, similar to
<span class="pkg">vegan</span> package defaults.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distinctiveness_alt(pres_matrix, dist_matrix, given_range)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distinctiveness_alt_+3A_pres_matrix">pres_matrix</code></td>
<td>
<p>a site-species matrix (presence-absence or relative
abundances), with sites in rows and species in columns</p>
</td></tr>
<tr><td><code id="distinctiveness_alt_+3A_dist_matrix">dist_matrix</code></td>
<td>
<p>a species functional distance matrix</p>
</td></tr>
<tr><td><code id="distinctiveness_alt_+3A_given_range">given_range</code></td>
<td>
<p>a numeric indicating the dissimilarity range at which the
the other species are considered maximally dissimilar</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Functional Distinctiveness of a species is the average functional
distance from a species to all the other in the given community. It is
computed as such:
</p>
<p style="text-align: center;"><code class="reqn">
   D_i(T) = \frac{
                \sum\limits_{j = 1 ~,j \neq i ~}^S
                \left[ \frac{d_{ij}}{T} + \theta(d_{ij} - T)
                  \left(1 - \frac{d_{ij}}{T} \right) \right]
              }{
                S - 1
              }
   </code>
</p>

<p>with <code class="reqn">D_i</code> the functional distinctiveness of species <code class="reqn">i</code>, <code class="reqn">N</code>
the total number of species in the community and <code class="reqn">d_{ij}</code> the
functional distance between species <code class="reqn">i</code> and species <code class="reqn">j</code>. <code class="reqn">T</code>
is the chosen maximal range considered. The function
<code class="reqn">\theta(d_ij - T)</code> is an indicator function that returns 1 when
<code class="reqn">d_{ij} \geq T</code> and 0 when <code class="reqn">d_{ij} &lt; T</code>.
<strong>IMPORTANT NOTE</strong>: in order to get functional rarity indices between 0
and 1, the distance metric has to be scaled between 0 and 1.
</p>


<h3>Value</h3>

<p>a similar matrix from provided <code>pres_matrix</code> with Distinctiveness
values in lieu of presences or relative abundances, species absent from
communities will have an <code>NA</code> value (see <code>Note</code> section)
</p>


<h3>Note</h3>

<p>Absent species should be coded by <code>0</code> or <code>NA</code> in input matrices.
</p>
<p>When a species is alone in its community the functional distinctiveness
cannot be computed (denominator = 0 in formula), and its value is assigned
as <code>NaN</code>.
</p>
<p>For speed and memory efficiency sparse matrices can be used as input of
the function using <code>as(pres_matrix, "dgCMatrix")</code> from the
<code>Matrix</code> package.
(see <code>vignette("sparse_matrices", package = "funrar")</code>)
</p>

<hr>
<h2 id='distinctiveness_com'>Functional Distinctiveness for a single community</h2><span id='topic+distinctiveness_com'></span>

<h3>Description</h3>

<p>Given a stacked data.frame and a distance matrix compute the functional
distinctiveness for a single community. Functional distinctiveness relates to
the functional &quot;originality&quot; of a species in a community. The closer to 1 the
more the species is functionally distinct from the rest of the community. See
<code><a href="#topic+distinctiveness">distinctiveness()</a></code> function or the functional rarity
indices vignette included in the package
(type <code>vignette("rarity_indices", package = "funrar")</code>), for more details
on the metric. <strong>IMPORTANT NOTE</strong>: in order to get functional rarity indices
between 0 and 1, the distance metric has to be scaled between 0 and 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distinctiveness_com(
  com_df,
  sp_col,
  abund = NULL,
  dist_matrix,
  relative = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distinctiveness_com_+3A_com_df">com_df</code></td>
<td>
<p>a stacked (= tidy) data.frame from a single community with each
row representing a species in a community</p>
</td></tr>
<tr><td><code id="distinctiveness_com_+3A_sp_col">sp_col</code></td>
<td>
<p>a character vector, the name of the species column in <code>com_df</code></p>
</td></tr>
<tr><td><code id="distinctiveness_com_+3A_abund">abund</code></td>
<td>
<p>a character vector, the name of the column containing relative
abundances values</p>
</td></tr>
<tr><td><code id="distinctiveness_com_+3A_dist_matrix">dist_matrix</code></td>
<td>
<p>a functional distance matrix as given by
<code>compute_dist_matrix()</code>, with species name as row and column names</p>
</td></tr>
<tr><td><code id="distinctiveness_com_+3A_relative">relative</code></td>
<td>
<p>a logical indicating if distinctiveness should be scaled
relatively to the community (scaled by max functional
distance among the species of the targeted community)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the same data.frame with the additional <strong>Di</strong> column giving
functional distinctiveness values for each species
</p>


<h3>Caution</h3>

<p>This function is meant for internal uses mostly, thus it does not include any
tests on inputs and may fail unexpectedly. Please use
<code><a href="#topic+distinctiveness_stack">distinctiveness_stack()</a></code> to avoid input errors.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scarcity_com">scarcity_com()</a></code>,
<code>vignette("rarity_indices", package = "funrar")</code> and
<code><a href="#topic+distinctiveness">distinctiveness()</a></code> Details section for detail on the index
</p>

<hr>
<h2 id='distinctiveness_dimensions'>Distinctiveness across combinations of traits</h2><span id='topic+distinctiveness_dimensions'></span>

<h3>Description</h3>

<p>From a trait data.frame and a site-species matrix compute Distinctiveness
(average pairwise functional distance) for each species in each community
on each provided trait and on all traits taken altogether.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distinctiveness_dimensions(pres_matrix, traits_table, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distinctiveness_dimensions_+3A_pres_matrix">pres_matrix</code></td>
<td>
<p>a site-species matrix, with species in rows and sites
in columns, containing presence-absence, relative abundances or
abundances values</p>
</td></tr>
<tr><td><code id="distinctiveness_dimensions_+3A_traits_table">traits_table</code></td>
<td>
<p>a data.frame of traits with species in row and traits in
columns, <strong>row names</strong> should be <strong>species names</strong>,</p>
</td></tr>
<tr><td><code id="distinctiveness_dimensions_+3A_...">...</code></td>
<td>
<p>additional arguments supplied to <code><a href="#topic+compute_dist_matrix">compute_dist_matrix()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of site-species matrix with functional distinctiveness values
per species per site, with elements <strong>Di_X</strong> for distinctiveness
computed on trait <strong>X</strong> and <strong>Di_all</strong> for distinctiveness computed
on all traits.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+uniqueness_dimensions">uniqueness_dimensions()</a></code>, <code><a href="#topic+distinctiveness">distinctiveness()</a></code>,
<code><a href="#topic+distinctiveness_stack">distinctiveness_stack()</a></code> and <code><a href="#topic+compute_dist_matrix">compute_dist_matrix()</a></code> for additional
arguments
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("aravo", package = "ade4")

# Site-species matrix
mat = as.matrix(aravo$spe)
rel_mat = make_relative(mat)

# Example of trait table
tra = aravo$traits[, c("Height", "SLA", "N_mass")]

di_dim = distinctiveness_dimensions(rel_mat, tra)

</code></pre>

<hr>
<h2 id='distinctiveness_global'>Global/Regional Functional Distinctiveness from dissimilarity matrix</h2><span id='topic+distinctiveness_global'></span>

<h3>Description</h3>

<p>Given a distance (or dissimilarity) matrix or <code>dist()</code> objects compute
regional/global level distinctiveness as if all species were present in the
same community.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distinctiveness_global(dist_obj, di_name = "global_di")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distinctiveness_global_+3A_dist_obj">dist_obj</code></td>
<td>
<p>a functional distance matrix as given by
<code>compute_dist_matrix()</code>, with species name as row and column names <strong>or</strong>
a <code>dist()</code> object with species names as <code>labels()</code></p>
</td></tr>
<tr><td><code id="distinctiveness_global_+3A_di_name">di_name</code></td>
<td>
<p>a character vector giving the name of the distinctiveness
column in the final data.frame (<strong>default</strong>: <code>global_di</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with two columns: by default <code>species</code> that contains the
species names and <code>global_di</code> that contains the distinctiveness values.
The first column that contains species names can renamed based on <code>dist_obj</code>
<code>dimnames</code>, while the second column is renamed through the <code>di_name</code>
argument.'
</p>


<h3>See Also</h3>

<p><code>vignette("rarity_indices", package = "funrar")</code> and
<code><a href="#topic+distinctiveness">distinctiveness()</a></code> Details section for detail on the index
</p>

<hr>
<h2 id='distinctiveness_range'>Alternative Truncated Functional Distinctiveness</h2><span id='topic+distinctiveness_range'></span>

<h3>Description</h3>

<p>Computes functional distinctiveness from a site-species matrix (containing
presence-absence or relative abundances) of species with provided functional
distance matrix considering only species <strong>within a given range</strong> in the
functional space. The sites-species matrix should have <strong>sites</strong> in <strong>rows</strong>
and <strong>species</strong> in <strong>columns</strong>, similar to <span class="pkg">vegan</span> package defaults.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distinctiveness_range(pres_matrix, dist_matrix, given_range, relative = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distinctiveness_range_+3A_pres_matrix">pres_matrix</code></td>
<td>
<p>a site-species matrix (presence-absence or relative
abundances), with sites in rows and species in columns</p>
</td></tr>
<tr><td><code id="distinctiveness_range_+3A_dist_matrix">dist_matrix</code></td>
<td>
<p>a species functional distance matrix</p>
</td></tr>
<tr><td><code id="distinctiveness_range_+3A_given_range">given_range</code></td>
<td>
<p>a numeric indicating the dissimilarity range at which the
the influence of other species is not considered anymore</p>
</td></tr>
<tr><td><code id="distinctiveness_range_+3A_relative">relative</code></td>
<td>
<p>a logical indicating if distinctiveness should be scaled
relatively to the community (scaled by max functional
distance among the species of the targeted community)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Functional Distinctiveness of a species is the average functional
distance from a species to all the other in the given community. It is
computed as such:
</p>
<p style="text-align: center;"><code class="reqn">
   D_i(T) = 1 ~~ if ~~ T &lt; min(d_{ij}), \\
   D_i(T) =
              \left( \frac{
                \sum\limits_{j = 1 ~,
                  j \neq i ~,
                  d_{ij} \leq T}^S d_{ij} \times Ab_j
              }{
                \sum\limits_{
                  j = 1 ~,
                  j \neq i ~,
                  d_{ij} \leq T}^S Ab_j
              } \right) \times \left(1 - \frac{
                \sum\limits_{
                  j = 1 ~,
                  j \neq i ~,
                  d_{ij} \leq T}^S Ab_j
              }{
                N
              } \right) ~~ if ~~ T \geq min(d_{ij}),
   </code>
</p>

<p>with <code class="reqn">D_i</code> the functional distinctiveness of species <code class="reqn">i</code>, <code class="reqn">N</code>
the total number of species in the community and <code class="reqn">d_{ij}</code> the
functional distance between species <code class="reqn">i</code> and species <code class="reqn">j</code>. <code class="reqn">T</code>
is the chosen maximal range considered. When presence-absence are used
<code class="reqn">Ab_j = 1/N</code> and the term <code class="reqn"> \left(1 - \frac{
                \sum\limits_{
                  j = 1 ~,
                  j \neq i ~,
                  d_{ij} \leq T}^S Ab_j
              }{
                N
              } \right)</code> is replaced by 1.
<strong>IMPORTANT NOTE</strong>: in order to get functional rarity indices between 0
and 1, the distance metric has to be scaled between 0 and 1.
</p>


<h3>Value</h3>

<p>a similar matrix from provided <code>pres_matrix</code> with Distinctiveness
values in lieu of presences or relative abundances, species absent from
communities will have an <code>NA</code> value (see <code>Note</code> section)
</p>


<h3>Note</h3>

<p>Absent species should be coded by <code>0</code> or <code>NA</code> in input matrices.
</p>
<p>When a species is alone in its community the functional distinctiveness
cannot be computed (denominator = 0 in formula), and its value is assigned
as <code>NaN</code>.
</p>
<p>For speed and memory efficiency sparse matrices can be used as input of
the function using <code>as(pres_matrix, "dgCMatrix")</code> from the
<code>Matrix</code> package.
(see <code>vignette("sparse_matrices", package = "funrar")</code>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("aravo", package = "ade4")
# Site-species matrix
mat = as.matrix(aravo$spe)

# Compute relative abundances
mat = make_relative(mat)

# Example of trait table
tra = aravo$traits[, c("Height", "SLA", "N_mass")]
# Distance matrix
dist_mat = compute_dist_matrix(tra)

di = distinctiveness_range(pres_matrix = mat, dist_matrix = dist_mat, 0.2)
di[1:5, 1:5]

</code></pre>

<hr>
<h2 id='distinctiveness_stack'>Functional Distinctiveness on a stacked data.frame</h2><span id='topic+distinctiveness_stack'></span><span id='topic+distinctiveness_tidy'></span>

<h3>Description</h3>

<p>Compute Functional Distinctiveness for several communities, from a stacked
(or tidy) data.frame of communities, with one column for species identity,
one for community identity and an optional one for relative abundances. Also
needs a species functional distances matrix. Functional distinctiveness
relates to the functional &quot;originality&quot; of a species in a community. The
closer to 1 the more the species is functionally distinct from the rest of
the community. See <code><a href="#topic+distinctiveness">distinctiveness()</a></code> function or the
functional rarity indices vignette included in the package
(type <code>vignette("rarity_indices", package = "funrar")</code>), for more details
on the metric. <strong>IMPORTANT NOTE</strong>: in order to get functional rarity indices
between 0 and 1, the distance metric has to be scaled between 0 and 1.
You can either use <code style="white-space: pre;">&#8288;_stack()&#8288;</code> or <code style="white-space: pre;">&#8288;_tidy()&#8288;</code> functions as they are aliases of
one another.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distinctiveness_stack(
  com_df,
  sp_col,
  com,
  abund = NULL,
  dist_matrix,
  relative = FALSE
)

distinctiveness_tidy(
  com_df,
  sp_col,
  com,
  abund = NULL,
  dist_matrix,
  relative = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distinctiveness_stack_+3A_com_df">com_df</code></td>
<td>
<p>a stacked (= tidy) data.frame from a single community with each
row representing a species in a community</p>
</td></tr>
<tr><td><code id="distinctiveness_stack_+3A_sp_col">sp_col</code></td>
<td>
<p>a character vector, the name of the species column in <code>com_df</code></p>
</td></tr>
<tr><td><code id="distinctiveness_stack_+3A_com">com</code></td>
<td>
<p>a character vector, the column name for communities names</p>
</td></tr>
<tr><td><code id="distinctiveness_stack_+3A_abund">abund</code></td>
<td>
<p>a character vector, the name of the column containing relative
abundances values</p>
</td></tr>
<tr><td><code id="distinctiveness_stack_+3A_dist_matrix">dist_matrix</code></td>
<td>
<p>a functional distance matrix as given by
<code>compute_dist_matrix()</code>, with species name as row and column names</p>
</td></tr>
<tr><td><code id="distinctiveness_stack_+3A_relative">relative</code></td>
<td>
<p>a logical indicating if distinctiveness should be scaled
relatively to the community (scaled by max functional
distance among the species of the targeted community)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the same data.frame with the additional <strong>Di</strong> column giving
functional distinctiveness values for each species
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scarcity_stack">scarcity_stack()</a></code>,
<code><a href="#topic+uniqueness_stack">uniqueness_stack()</a></code>,
<code><a href="#topic+restrictedness_stack">restrictedness_stack()</a></code>;
<code><a href="#topic+distinctiveness">distinctiveness()</a></code> Details section for detail on the index
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("aravo", package = "ade4")

# Example of trait table
tra = aravo$traits[, c("Height", "SLA", "N_mass")]
# Distance matrix
dist_mat = compute_dist_matrix(tra)

# Site-species matrix converted into data.frame
mat = as.matrix(aravo$spe)
mat = make_relative(mat)
dat = matrix_to_stack(mat, "value", "site", "species")
dat$site = as.character(dat$site)
dat$species = as.character(dat$species)

di_df = distinctiveness_stack(dat, "species", "site", "value", dist_mat)
head(di_df)

</code></pre>

<hr>
<h2 id='funrar'>Compute all Functional Rarity Indices from Matrices</h2><span id='topic+funrar'></span>

<h3>Description</h3>

<p>From a site-species matrix and functional distance matrix compute all indices
included in the package: functional uniqueness (regional, functional),
functional distinctiveness (local, functional), geographical restrictedness
(regional, extent), scarcity (local, abundance). <strong>Note</strong>: scarcity can
only be computed if relative abundances are provided in the site-species
matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>funrar(pres_matrix, dist_matrix, rel_abund = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="funrar_+3A_pres_matrix">pres_matrix</code></td>
<td>
<p>a site-species matrix (presence-absence or relative
abundances), with sites in rows and species in columns</p>
</td></tr>
<tr><td><code id="funrar_+3A_dist_matrix">dist_matrix</code></td>
<td>
<p>a species functional distance matrix</p>
</td></tr>
<tr><td><code id="funrar_+3A_rel_abund">rel_abund</code></td>
<td>
<p>logical (<code>TRUE</code> or <code>FALSE</code>) indicating if
site-species matrix contain relative abundances values or only
presence-absence data (default = <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of 3 objects (or 4 if <code>rel_abund = TRUE</code>):
</p>

<dl>
<dt><strong>Ui</strong></dt><dd><p>a vector containing uniqueness values per species,</p>
</dd>
<dt><strong>Di</strong></dt><dd><p>a site-species matrix with functional distinctiveness
values per species per site,</p>
</dd>
<dt><strong>Ri</strong></dt><dd><p>a vector containing geographical restrictedness values
per species,</p>
</dd>
</dl>

<p>and if <code>rel_abund = TRUE</code>,
</p>

<dl>
<dt><strong>Si</strong></dt><dd><p>a site-species matrix with scarcity values per species
per site.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+uniqueness">uniqueness()</a></code>, <code><a href="#topic+distinctiveness">distinctiveness()</a></code>, <code><a href="#topic+restrictedness">restrictedness()</a></code>,
<code><a href="#topic+scarcity">scarcity()</a></code>
</p>

<hr>
<h2 id='funrar_stack'>Compute all Functional Rarity Indices from stacked data.frames</h2><span id='topic+funrar_stack'></span>

<h3>Description</h3>

<p>From a stacked (= tidy) data.frame and functional distance matrix compute
all indices included in the package: functional uniqueness (regional,
functional), functional distinctiveness (local, functional), geographical
restrictedness (regional, extent), scarcity (local, abundance).
<strong>Note</strong>: scarcity can only be computed if relative abundances are
provided in the data.frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>funrar_stack(com_df, sp_col, com, abund = NULL, dist_matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="funrar_stack_+3A_com_df">com_df</code></td>
<td>
<p>a stacked (= tidy) data.frame from a single community with each
row representing a species in a community</p>
</td></tr>
<tr><td><code id="funrar_stack_+3A_sp_col">sp_col</code></td>
<td>
<p>a character vector, the name of the species column in <code>com_df</code></p>
</td></tr>
<tr><td><code id="funrar_stack_+3A_com">com</code></td>
<td>
<p>a character vector, the column name for communities names</p>
</td></tr>
<tr><td><code id="funrar_stack_+3A_abund">abund</code></td>
<td>
<p>a character vector, the name of the column containing relative
abundances values</p>
</td></tr>
<tr><td><code id="funrar_stack_+3A_dist_matrix">dist_matrix</code></td>
<td>
<p>a functional distance matrix as given by
<code>compute_dist_matrix()</code>, with species name as row and column names</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of 3 objects (or 4 if <code>abund</code> is not <code>NULL</code>):
</p>

<dl>
<dt><strong>Ui</strong></dt><dd><p>a vector containing uniqueness values per species,</p>
</dd>
<dt><strong>Di</strong></dt><dd><p>a site-species matrix with functional distinctiveness
values per species per site,</p>
</dd>
<dt><strong>Ri</strong></dt><dd><p>a vector containing geographical restrictedness values
per species,</p>
</dd>
</dl>

<p>and if <code>abund</code> is not <code>NULL</code>,
</p>

<dl>
<dt><strong>Si</strong></dt><dd><p>a site-species matrix with scarcity values per
species per site.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+uniqueness_stack">uniqueness_stack()</a></code>, <code><a href="#topic+distinctiveness_stack">distinctiveness_stack()</a></code>,
<code><a href="#topic+restrictedness_stack">restrictedness_stack()</a></code>, <code><a href="#topic+scarcity_stack">scarcity_stack()</a></code>
</p>

<hr>
<h2 id='is_relative'>Tell if matrix or data.frame has relative abundances</h2><span id='topic+is_relative'></span>

<h3>Description</h3>

<p>From an abundance/presence-absence matrix or data.frame tells if it contains
relative abundances or absolute abundances. Checks if all abundances are
between 1 and 0 but <strong>never checks sum of abundances per community</strong>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_relative(given_obj, abund = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_relative_+3A_given_obj">given_obj</code></td>
<td>
<p>abundance or presence-absence matrix, with sites in rows and
species in columns, or tidy community data frame</p>
</td></tr>
<tr><td><code id="is_relative_+3A_abund">abund</code></td>
<td>
<p>name of the column of the provided object that contains the
abundances</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> if the input has relative abundances <code>FALSE</code> otherwise
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make_relative">make_relative()</a></code> to transform matrix into a relative abundance
matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("aravo", package = "ade4")

# Site-species matrix
mat = as.matrix(aravo$spe)
head(mat)[, 1:5]  # Has absolute abundances
rel_mat = make_relative(mat)
head(rel_mat)  # Relative abundances

# Forced to use ':::' becasue function is not exported
funrar:::is_relative(mat)      # FALSE
funrar:::is_relative(rel_mat)  # TRUE

</code></pre>

<hr>
<h2 id='make_relative'>Relative abundance matrix from absolute abundance matrix</h2><span id='topic+make_relative'></span>

<h3>Description</h3>

<p>From an abundance matrix (numbers of individuals of a given species at a
site) returns a relative abundance matrix (proportion of individuals of a
given species at a given site). This function works also
with sparse matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_relative(abund_matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_relative_+3A_abund_matrix">abund_matrix</code></td>
<td>
<p>abundance matrix, with sites in rows and species in
columns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Similar shaped matrix as the input but with relative abundances
instead
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("aravo", package = "ade4")

# Site-species matrix
mat = as.matrix(aravo$spe)
head(mat)[, 1:5]  # Has absolute abundances
rel_mat = make_relative(mat)
head(rel_mat)  # Relative abundances

</code></pre>

<hr>
<h2 id='matrix_to_stack'>Matrix to stacked (= tidy) data.frame</h2><span id='topic+matrix_to_stack'></span><span id='topic+matrix_to_tidy'></span>

<h3>Description</h3>

<p>From a matrix with values to a stacked (= tidy) data.frame, exclude NA from
given data.frame. If supplied object is not a matrix, try to coerce object
to matrix first. <code>matrix_to_tidy()</code> is an alias of this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrix_to_stack(
  my_mat,
  value_col = "value",
  row_to_col = names(dimnames(my_mat))[1],
  col_to_col = names(dimnames(my_mat))[2]
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matrix_to_stack_+3A_my_mat">my_mat</code></td>
<td>
<p>matrix you want to transform in stacked (= tidy) data.frame</p>
</td></tr>
<tr><td><code id="matrix_to_stack_+3A_value_col">value_col</code></td>
<td>
<p>(optional) character vector to use for value column
(default: 'value')</p>
</td></tr>
<tr><td><code id="matrix_to_stack_+3A_row_to_col">row_to_col</code></td>
<td>
<p>(optional) character vector used for name of column in
data.frame corresponding to rows in matrix (default:
corresponding dimension name)</p>
</td></tr>
<tr><td><code id="matrix_to_stack_+3A_col_to_col">col_to_col</code></td>
<td>
<p>(optional) character vector used for name of column in
data.frame corresponding to columns in matrix (default:
corresponding dimension name)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a stacked (= tidy) data.frame with, a column for row names, one for
column names and a third one for the values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stack_to_matrix">stack_to_matrix()</a></code> for the reverse operation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("aravo", package = "ade4")

# Site-species matrix converted into data.frame
mat = as.matrix(aravo$spe)
dat = matrix_to_stack(mat, "value", "site", "species")
str(dat)

</code></pre>

<hr>
<h2 id='restrictedness'>Geographical Restrictedness on site-species matrix</h2><span id='topic+restrictedness'></span>

<h3>Description</h3>

<p>Computes geographical restrictedness from a site-species matrix.
Geographical restrictedness is an index related to the extent of a species
in a given dataset, it is close to 1 when the species is present in only a
single site of the dataset (restricted) and close to 0 when the species is
present at all sites. It estimates the geographical extent of a species in a
dataset. See <code>Details</code> section to have details on the formula used for
the computation. The sites-species matrix should have <strong>sites</strong>
in <strong>rows</strong> and <strong>species</strong> in <strong>columns</strong>, similar to <span class="pkg">vegan</span> package
defaults.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>restrictedness(pres_matrix, relative = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="restrictedness_+3A_pres_matrix">pres_matrix</code></td>
<td>
<p>a site-species matrix, with species in rows and sites
in columns, containing presence-absence, relative abundances or
abundances values</p>
</td></tr>
<tr><td><code id="restrictedness_+3A_relative">relative</code></td>
<td>
<p>a logical (default = FALSE), indicating if restrictedness
should be computed relative to restrictedness from a species occupying a
single site</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Geographical Restrictedness aims to measure the regional extent of a species
in <span class="pkg">funrar</span> it is computed the simplest way possible: a ratio of the
number of sites where a species is present over the total number of sites in
the dataset. We take this ratio off 1 to have a index between 0 and 1 that
represents how restricted a species is:
</p>
<p style="text-align: center;"><code class="reqn">
 R_i = 1 - \frac{N_i}{N_tot},
</code>
</p>

<p>where <code class="reqn">R_i</code> is the geographical restrictedness value, <code class="reqn">N_i</code> the total
number of sites where species <code class="reqn">i</code> occur and <code class="reqn">N_tot</code> the total number
of sites in the dataset.
When <code>relative = TRUE</code>, restrictedness is computed relatively to the
restrictedness of a species present in a single site:
</p>
<p style="text-align: center;"><code class="reqn">
 R_i = \frac{R_i}{R_one}
</code>
</p>

<p style="text-align: center;"><code class="reqn">
 R_i = \frac{1 - \frac{K_i}{K_tot}}{1 - \frac{1}{K_tot}}
</code>
</p>

<p style="text-align: center;"><code class="reqn">
 R_i = \frac{K_tot - K_i}{K_tot - 1}
</code>
</p>

<p>Other approaches can be used to measure the geographical extent
(convex hulls, occupancy models, etc.) but for the sake of simplicity only
the counting method is implemented in <span class="pkg">funrar</span>.
</p>


<h3>Value</h3>

<p>A stacked data.frame containing species' names and their
restrictedness value in the <strong>Ri</strong> column, similar to what
<code><a href="#topic+uniqueness">uniqueness()</a></code> returns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("aravo", package = "ade4")
# Site-species matrix
mat = as.matrix(aravo$spe)
ri = restrictedness(mat)
head(ri)

</code></pre>

<hr>
<h2 id='restrictedness_stack'>Geographical Restrictedness for stacked data.frame</h2><span id='topic+restrictedness_stack'></span><span id='topic+restrictedness_tidy'></span>

<h3>Description</h3>

<p>Compute the geographical restrictedness for each species present in the
stacked data.frame. Geographical restrictedness is an index related to the
extent of a species in a given dataset, it is close to 1 when the species is
present in only a single site of the dataset (restricted) and close to 0 when
the species is present at all sites. It estimates the geographical extent of
a species in a dataset. See <code><a href="#topic+restrictedness">restrictedness()</a></code> for details
on restrictedness computation. You can either use <code style="white-space: pre;">&#8288;_stack()&#8288;</code> or <code style="white-space: pre;">&#8288;_tidy()&#8288;</code>
functions as they are aliases of one another.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>restrictedness_stack(com_df, sp_col, com, relative = FALSE)

restrictedness_tidy(com_df, sp_col, com, relative = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="restrictedness_stack_+3A_com_df">com_df</code></td>
<td>
<p>a stacked (= tidy) data.frame of communities</p>
</td></tr>
<tr><td><code id="restrictedness_stack_+3A_sp_col">sp_col</code></td>
<td>
<p>a character vector indicating the name of the species column</p>
</td></tr>
<tr><td><code id="restrictedness_stack_+3A_com">com</code></td>
<td>
<p>a character vector indicating the name of the community column</p>
</td></tr>
<tr><td><code id="restrictedness_stack_+3A_relative">relative</code></td>
<td>
<p>a logical (default = FALSE), indicating if restrictedness
should be computed relative to restrictedness from a species occupying a
single site</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A stacked data.frame containing species' names and their
restrictedness value in the <strong>Ri</strong> column, similar to what
<code><a href="#topic+uniqueness_stack">uniqueness_stack()</a></code> returns.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+restrictedness">restrictedness()</a></code>, <code><a href="#topic+uniqueness_stack">uniqueness_stack()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("aravo", package = "ade4")

# Site-species matrix converted into data.frame
mat = as.matrix(aravo$spe)
dat = matrix_to_stack(mat, "value", "site", "species")
dat$site = as.character(dat$site)
dat$species = as.character(dat$species)
ri_df = restrictedness_stack(dat, "species", "site")
head(ri_df)

</code></pre>

<hr>
<h2 id='scarcity'>Scarcity on site-species matrix</h2><span id='topic+scarcity'></span>

<h3>Description</h3>

<p>Computes scarcity from a relative abundance matrix of species. Scarcity is
close to 1 when a species is rare in a community and close to 0 when it is
abundant. It requires a site-species matrix with relative abundances. See
<code>Details</code> section for the formula. The sites-species matrix should have
<strong>sites</strong> in <strong>rows</strong> and <strong>species</strong> in <strong>columns</strong>, similar to <span class="pkg">vegan</span>
package defaults.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scarcity(pres_matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scarcity_+3A_pres_matrix">pres_matrix</code></td>
<td>
<p>a site-species matrix, with species in rows and sites
in columns, containing <strong>relative abundances</strong> values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The scarcity of species is computed as follow:
</p>
<p style="text-align: center;"><code class="reqn">
     S_i = \exp{-N \log{2} A_i},
    </code>
</p>
<p> with <code class="reqn">S_i</code> the scarcity of species <code class="reqn">i</code>, <code class="reqn">N</code> the total
number of species in the community and <code class="reqn">A_i</code> the relative abundance
of species <code class="reqn">i</code> in the community. Scarcity is thus a measure of the
<strong>local</strong> rarity in terms of abundances. If <code class="reqn">S_i</code> is close to 1
the species has a very low abundances while if it's close to 0, it is
quite abundant in the community.
</p>


<h3>Value</h3>

<p>a similar matrix to <code>pres_matrix</code> with scarcity values in <em>lieu</em>
of relative abundances.
</p>


<h3>See Also</h3>

<p><code>vignette("rarity_indices", package = "funrar")</code> for details on the
scarcity metric; <code><a href="#topic+distinctiveness">distinctiveness()</a></code>, <code><a href="#topic+restrictedness">restrictedness()</a></code>, <code><a href="#topic+uniqueness">uniqueness()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("aravo", package = "ade4")
# Site-species matrix
mat = as.matrix(aravo$spe)
mat = make_relative(mat)

si = scarcity(pres_matrix = mat)
si[1:5, 1:5]

</code></pre>

<hr>
<h2 id='scarcity_com'>Scarcity for a single community</h2><span id='topic+scarcity_com'></span>

<h3>Description</h3>

<p>Given a stacked data.frame compute species scarcity. Scarcity measures how
abundant is a species locally. Scarcity is close to 1 when a species is rare
in a community and close to 0 when it is abundant. See <code><a href="#topic+scarcity">scarcity()</a></code> function
or the functional rarity indices vignette included in the package (type
<code>vignette("rarity_indices", package = "funrar")</code>) for details about the
index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scarcity_com(com_df, sp_col, abund)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scarcity_com_+3A_com_df">com_df</code></td>
<td>
<p>a stacked (= tidy) data.frame from a single community with each
row representing a species in a community</p>
</td></tr>
<tr><td><code id="scarcity_com_+3A_sp_col">sp_col</code></td>
<td>
<p>a character vector, the name of the species column in <code>com_df</code></p>
</td></tr>
<tr><td><code id="scarcity_com_+3A_abund">abund</code></td>
<td>
<p>a character vector, the name of the column containing relative
abundances values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the same data.frame with the additional <strong>Si</strong> column giving scarcity
values for each species
</p>


<h3>Caution</h3>

<p>This function is meant for internal uses mostly, thus it does not include any
tests on inputs and may fail unexpectedly. Please use <code><a href="#topic+scarcity_stack">scarcity_stack()</a></code> to
avoid input errors.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scarcity">scarcity()</a></code> and <code>vignette("rarity_indices", package = "funrar")</code>
for details on the scarcity metric; <code><a href="#topic+distinctiveness_com">distinctiveness_com()</a></code> to compute
distinctiveness on a single community
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("aravo", package = "ade4")

# Site-species matrix converted into data.frame
mat = as.matrix(aravo$spe)
mat = make_relative(mat)
dat = matrix_to_stack(mat, "value", "site", "species")
dat$site = as.character(dat$site)
dat$species = as.character(dat$species)

si_df = scarcity_com(subset(dat, site == "AR07"), "species", "value")
head(si_df)

</code></pre>

<hr>
<h2 id='scarcity_stack'>Scarcity on a stacked data.frame</h2><span id='topic+scarcity_stack'></span><span id='topic+scarcity_tidy'></span>

<h3>Description</h3>

<p>Compute scarcity values for several communities. Scarcity computation
requires relative abundances. Scarcity is close to 1 when a species is rare
in a community and close to 0 when it is abundant. See <code><a href="#topic+scarcity">scarcity()</a></code> function
or the functional rarity indices vignette included in the package (type
<code>vignette("rarity_indices", package = "funrar")</code>) for details about the
index. You can either use <code style="white-space: pre;">&#8288;_stack()&#8288;</code> or <code style="white-space: pre;">&#8288;_tidy()&#8288;</code> functions as they are
aliases of one another.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scarcity_stack(com_df, sp_col, com, abund)

scarcity_tidy(com_df, sp_col, com, abund)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scarcity_stack_+3A_com_df">com_df</code></td>
<td>
<p>a stacked (= tidy) data.frame from a single community with each
row representing a species in a community</p>
</td></tr>
<tr><td><code id="scarcity_stack_+3A_sp_col">sp_col</code></td>
<td>
<p>a character vector, the name of the species column in <code>com_df</code></p>
</td></tr>
<tr><td><code id="scarcity_stack_+3A_com">com</code></td>
<td>
<p>a character vector indicating the column name of communities ID in
<code>com_df</code></p>
</td></tr>
<tr><td><code id="scarcity_stack_+3A_abund">abund</code></td>
<td>
<p>a character vector, the name of the column containing relative
abundances values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The same table as <code>com_df</code> with an added <code class="reqn">S_i</code> column
for Scarcity values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scarcity">scarcity()</a></code> and <code>vignette("rarity_indices", package = "funrar")</code>
for details on the scarcity metric; <code><a href="#topic+distinctiveness_stack">distinctiveness_stack()</a></code>,
<code><a href="#topic+restrictedness_stack">restrictedness_stack()</a></code>, <code><a href="#topic+uniqueness_stack">uniqueness_stack()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("aravo", package = "ade4")

# Site-species matrix converted into data.frame
mat = as.matrix(aravo$spe)
mat = make_relative(mat)
dat = matrix_to_stack(mat, "value", "site", "species")
dat$site = as.character(dat$site)
dat$species = as.character(dat$species)

si_df = scarcity_stack(dat, "species", "site", "value")
head(si_df)

</code></pre>

<hr>
<h2 id='stack_to_matrix'>Stacked (= tidy) data.frame to matrix</h2><span id='topic+stack_to_matrix'></span><span id='topic+tidy_to_matrix'></span>

<h3>Description</h3>

<p>Passes from a stacked (= tidy) data.frame to a matrix. <code>tidy_to_matrix()</code> is
an alias of this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stack_to_matrix(
  my_df,
  col_to_row,
  col_to_col,
  col_value = NULL,
  sparse = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stack_to_matrix_+3A_my_df">my_df</code></td>
<td>
<p>data.frame you want to transform in matrix</p>
</td></tr>
<tr><td><code id="stack_to_matrix_+3A_col_to_row">col_to_row</code></td>
<td>
<p>character vector of the name of the data.frame column you
want to put into matrix rows</p>
</td></tr>
<tr><td><code id="stack_to_matrix_+3A_col_to_col">col_to_col</code></td>
<td>
<p>character vector of the name of the data.frame column you
want to be as columns in matrix</p>
</td></tr>
<tr><td><code id="stack_to_matrix_+3A_col_value">col_value</code></td>
<td>
<p>(optional, default = <code>NULL</code>) character vector indicating
the name of a column coding the values that will be put in
the matrix</p>
</td></tr>
<tr><td><code id="stack_to_matrix_+3A_sparse">sparse</code></td>
<td>
<p>(optional, default = <code>FALSE</code>) logical indicating whether to
return a sparse matrix (if <code>TRUE</code> requires
<a href="https://cran.r-project.org/package=tidytext"><code>tidytext</code></a>
package)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with given <code>col_to_row</code> column in rows and <code>col_to_col</code>
column in columns. If some cells are not present in the data.frame (e.g. some
species not present at some sites), the matrix will have a <code>NA</code> value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+matrix_to_stack">matrix_to_stack()</a></code> for the reverse operation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>example = data.frame("sites" = c(rep("1", 3), rep("2", 2)),
 "species" = c("A", "B", "C", "B", "D"),
  "abundance" = c(0.33, 0.33, 0.33, 0.4, 0.6))

mat = stack_to_matrix(example, "sites", "species", "abundance")
mat

</code></pre>

<hr>
<h2 id='uniqueness'>Functional Uniqueness for site-species matrix matrix</h2><span id='topic+uniqueness'></span>

<h3>Description</h3>

<p>Computes the functional uniqueness from a site-species matrix with the
provided functional distance matrix. Functional Uniqueness represents how
&quot;isolated&quot; is a species in the global species pool, it is the functional
distance to the nearest neighbor of the species of interest (see <code>Details</code>
section for the formula). The sites-species matrix should have <strong>sites</strong>
in <strong>rows</strong> and <strong>species</strong> in <strong>columns</strong>, similar to <span class="pkg">vegan</span> package
defaults.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uniqueness(pres_matrix, dist_matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="uniqueness_+3A_pres_matrix">pres_matrix</code></td>
<td>
<p>a site-species matrix (presence-absence or relative
abundances), with sites in rows and species in columns</p>
</td></tr>
<tr><td><code id="uniqueness_+3A_dist_matrix">dist_matrix</code></td>
<td>
<p>a species functional distance matrix</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Functional Uniqueness <code class="reqn">U_i</code> is computed as follow:
</p>
<p style="text-align: center;"><code class="reqn">
 U_i = \min(d_{ij}) \forall j, j \neq i,
</code>
</p>

<p>with <code class="reqn">U_i</code> the functional uniqueness of species <code class="reqn">i</code>, and <code class="reqn">d_ij</code>
the functional distance between species <code class="reqn">i</code> and species <code class="reqn">j</code>
</p>


<h3>Value</h3>

<p>A data.frame with functional uniqueness values per species, with one
column with provided species column name and the <strong>Ui</strong> column with
functional uniqueness values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distinctiveness">distinctiveness()</a></code>, <code><a href="#topic+restrictedness">restrictedness()</a></code>, <code><a href="#topic+scarcity">scarcity()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("aravo", package = "ade4")

# Site-species matrix
mat = as.matrix(aravo$spe)
colnames(mat) = as.character(colnames(mat))

# Example of trait table
tra = aravo$traits[, c("Height", "SLA", "N_mass")]
# Distance matrix
dist_mat = compute_dist_matrix(tra)

ui = uniqueness(mat, dist_mat)
head(ui)

# Computing uniqueness for each community
com_ui = apply(mat, 1,
                function(x, dist_m) {
                    smaller_com = x[x &gt; 0 &amp; !is.na(x)]
                    uniqueness(t(as.matrix(smaller_com)), dist_m)
                }, dist_m = dist_mat)

</code></pre>

<hr>
<h2 id='uniqueness_dimensions'>Uniqueness across combinations of traits</h2><span id='topic+uniqueness_dimensions'></span>

<h3>Description</h3>

<p>From a trait table and a site-species matrix compute Uniqueness
(nearest functional distance) for each species and each trait, plus computes
it for all the traits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uniqueness_dimensions(pres_matrix, traits_table, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="uniqueness_dimensions_+3A_pres_matrix">pres_matrix</code></td>
<td>
<p>a site-species matrix, with species in rows and sites
in columns, containing presence-absence, relative abundances or
abundances values</p>
</td></tr>
<tr><td><code id="uniqueness_dimensions_+3A_traits_table">traits_table</code></td>
<td>
<p>a data.frame of traits with species in row and traits in
columns, <strong>row names</strong> should be <strong>species names</strong>,</p>
</td></tr>
<tr><td><code id="uniqueness_dimensions_+3A_...">...</code></td>
<td>
<p>additional arguments supplied to <code><a href="#topic+compute_dist_matrix">compute_dist_matrix()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame containing species' names and their uniqueness values
for each traits (<strong>Ui_X</strong> column for trait <strong>X</strong>), as well as a
column for the uniqueness value for all traits (<strong>Ui_all</strong> column)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distinctiveness_dimensions">distinctiveness_dimensions()</a></code>, <code><a href="#topic+uniqueness">uniqueness()</a></code>, <code><a href="#topic+uniqueness_stack">uniqueness_stack()</a></code>
and <code><a href="#topic+compute_dist_matrix">compute_dist_matrix()</a></code> for additional arguments
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("aravo", package = "ade4")

# Site-species matrix
mat = as.matrix(aravo$spe)
rel_mat = make_relative(mat)

# Example of trait table
tra = aravo$traits[, c("Height", "SLA", "N_mass")]

ui_dim = uniqueness_dimensions(rel_mat, tra)

</code></pre>

<hr>
<h2 id='uniqueness_stack'>Functional Uniqueness on stacked data.frame</h2><span id='topic+uniqueness_stack'></span><span id='topic+uniqueness_tidy'></span>

<h3>Description</h3>

<p>Computes functional uniqueness values over a given regional pool. Functional
uniqueness gives the functional distance to the nearest-neighbor of a given
species in the provided distance matrix. See <code><a href="#topic+uniqueness">uniqueness()</a></code> function for
details on computation. You can either use <code style="white-space: pre;">&#8288;_stack()&#8288;</code> or <code style="white-space: pre;">&#8288;_tidy()&#8288;</code> functions
as they are aliases of one another.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uniqueness_stack(com_df, sp_col, dist_matrix)

uniqueness_tidy(com_df, sp_col, dist_matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="uniqueness_stack_+3A_com_df">com_df</code></td>
<td>
<p>a data frame of the species in the regional pool.</p>
</td></tr>
<tr><td><code id="uniqueness_stack_+3A_sp_col">sp_col</code></td>
<td>
<p>a character vector indicating the name of the species column
in the <code>com_df</code> data frame</p>
</td></tr>
<tr><td><code id="uniqueness_stack_+3A_dist_matrix">dist_matrix</code></td>
<td>
<p>a functional distance matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with uniqueness value per species, with one column with
provided species column name and the <strong>Ui</strong> column with the uniqueness
values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+uniqueness">uniqueness()</a></code> and <code>vignette("rarity_indices", package = "funrar")</code> for
details on the uniqueness metric; <code><a href="#topic+distinctiveness_stack">distinctiveness_stack()</a></code>,
<code><a href="#topic+restrictedness_stack">restrictedness_stack()</a></code>, <code><a href="#topic+scarcity_stack">scarcity_stack()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("aravo", package = "ade4")

# Site-species matrix converted into data.frame
mat = as.matrix(aravo$spe)
dat = matrix_to_stack(mat, "value", "site", "species")
dat$site = as.character(dat$site)
dat$species = as.character(dat$species)

# Example of trait table
tra = aravo$traits[, c("Height", "SLA", "N_mass")]
# Distance matrix
dist_mat = compute_dist_matrix(tra)

ui_df = uniqueness_stack(dat, "species", dist_mat)
head(ui_df)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
