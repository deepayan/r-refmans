<!DOCTYPE html><html><head><title>Help for package dataresqc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dataresqc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Bern'><p>Sub-daily meteorological observations for Bern</p></a></li>
<li><a href='#check_sef'><p>Check compliance with SEF guidelines</p></a></li>
<li><a href='#climatic_outliers'><p>Climatic outliers test</p></a></li>
<li><a href='#climexp_to_sef'><p>Download a GHCN-Daily data file from the Climate Explorer and convert it</p>
into the Station Exchange Format</a></li>
<li><a href='#convert_pressure'><p>Convert pressure data to hPa</p></a></li>
<li><a href='#daily_out_of_range'><p>Daily big errors test</p></a></li>
<li><a href='#daily_repetition'><p>Daily repetition test</p></a></li>
<li><a href='#duplicate_columns'><p>Duplicate columns test</p></a></li>
<li><a href='#duplicate_dates'><p>Duplicate dates test</p></a></li>
<li><a href='#duplicate_times'><p>Duplicate times test</p></a></li>
<li><a href='#impossible_values'><p>Gross Errors Test for Cloud Cover and Relative Humidity.</p></a></li>
<li><a href='#internal_consistency'><p>Daily internal consistency test</p></a></li>
<li><a href='#Meta'><p>Metadata for the stations of Bern and Rosario de Santa Fe</p></a></li>
<li><a href='#plot_daily'><p>Plot daily data points</p></a></li>
<li><a href='#plot_decimals'><p>Plot decimals</p></a></li>
<li><a href='#plot_subdaily'><p>Plot sub-daily data points</p></a></li>
<li><a href='#plot_weekly_cycle'><p>Plot weekly cycle</p></a></li>
<li><a href='#qc'><p>Apply all tests</p></a></li>
<li><a href='#read_meta'><p>Read metadata from the Station Exchange Format version 1.0.0</p></a></li>
<li><a href='#read_sef'><p>Read data files in Station Exchange Format version 1.0.0</p></a></li>
<li><a href='#Rosario'><p>Daily and sub-daily meteorological observations for Rosario de Santa Fe (Argentina)</p></a></li>
<li><a href='#subdaily_out_of_range'><p>Sub-daily big errors test</p></a></li>
<li><a href='#subdaily_repetition'><p>Sub-daily repetition test</p></a></li>
<li><a href='#temporal_coherence'><p>Daily temporal coherence test</p></a></li>
<li><a href='#Tests'><p>Table of available qc tests</p></a></li>
<li><a href='#Variables'><p>Table of supported variable codes</p></a></li>
<li><a href='#wmo_gross_errors'><p>WMO Gross Errors Tests for Pressure, Temperature, Dew Point, and Wind Speed.</p></a></li>
<li><a href='#wmo_time_consistency'><p>WMO Time Consistency Test for Pressure, Temperature and Dew Point.</p></a></li>
<li><a href='#write_flags'><p>Add quality flags to a data file in Station Exchange Format version 1.0.0</p></a></li>
<li><a href='#write_sef'><p>Write data in Station Exchange Format version 1.0.0</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>C3S Quality Control Tools for Historical Climate Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-04-02</td>
</tr>
<tr>
<td>Description:</td>
<td>Quality control and formatting tools developed for the Copernicus Data Rescue Service. The package includes functions to handle the Station Exchange Format (SEF), various statistical tests for climate data at daily and sub-daily resolution, as well as functions to plot the data. For more information and documentation see <a href="https://datarescue.climate.copernicus.eu/st_data-quality-control">https://datarescue.climate.copernicus.eu/st_data-quality-control</a>.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2, grid, knitr, rmarkdown</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-02 16:30:02 UTC; Yuri</td>
</tr>
<tr>
<td>Author:</td>
<td>Yuri Brugnara <a href="https://orcid.org/0000-0001-8427-0064"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Alba Gilabert [aut],
  Clara Ventura [aut],
  Stefan Hunziker [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yuri Brugnara &lt;yuri.brugnara@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-02 22:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Bern'>Sub-daily meteorological observations for Bern</h2><span id='topic+Bern'></span>

<h3>Description</h3>

<p>Observations of pressure and temperature for the city of Bern (Switzerland)
for the period 1800-1827.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bern
</code></pre>


<h3>Format</h3>

<p>A list of data frames (one data frame per variable).
The format of the data frames is that required by the QC functions.
</p>


<h3>Source</h3>

<p>Institute of Geography - University of Bern
</p>

<hr>
<h2 id='check_sef'>Check compliance with SEF guidelines</h2><span id='topic+check_sef'></span>

<h3>Description</h3>

<p>Check compliance with SEF guidelines
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_sef(file = file.choose())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_sef_+3A_file">file</code></td>
<td>
<p>Character string giving the path of the SEF file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if no errors are found, FALSE otherwise.
</p>


<h3>Note</h3>

<p>For more information on error/warning messages produced by this
function see the SEF documentation.
</p>


<h3>Author(s)</h3>

<p>Yuri Brugnara
</p>

<hr>
<h2 id='climatic_outliers'>Climatic outliers test</h2><span id='topic+climatic_outliers'></span>

<h3>Description</h3>

<p>Considers as outliers all values falling outside a range between,
for example, p25 - 3 interquartile ranges and p75 + 3 interquartile 
The number of interquantile ranges can be modified through the parameter
<code>IQR</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>climatic_outliers(
  Data,
  meta = NULL,
  outpath,
  IQR = NA,
  bplot = FALSE,
  outfile = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="climatic_outliers_+3A_data">Data</code></td>
<td>
<p>A character string giving the path of the input file,
or a matrix with 5 (7) columns for daily (sub-daily) data: variable code, year, 
month, day, (hour), (minute), value.</p>
</td></tr>
<tr><td><code id="climatic_outliers_+3A_meta">meta</code></td>
<td>
<p>A character vector with 6 elements: station ID, latitude, longitude,
altitude, variable code, units. If <code>Data</code> is a path, <code>meta</code> is
ignored.</p>
</td></tr>
<tr><td><code id="climatic_outliers_+3A_outpath">outpath</code></td>
<td>
<p>Character string giving the path for the QC results.</p>
</td></tr>
<tr><td><code id="climatic_outliers_+3A_iqr">IQR</code></td>
<td>
<p>Interquantile range used to define outliers. By default it is 5 for
precipitation, 3 for air temperature, and 4 for any other variable.</p>
</td></tr>
<tr><td><code id="climatic_outliers_+3A_bplot">bplot</code></td>
<td>
<p>If TRUE, create a boxplot and print it into a PDF.</p>
</td></tr>
<tr><td><code id="climatic_outliers_+3A_outfile">outfile</code></td>
<td>
<p>Filename for the plot. Ignored if <code>bplot</code> is FALSE.</p>
</td></tr>
<tr><td><code id="climatic_outliers_+3A_...">...</code></td>
<td>
<p>Graphical parameters passed to the function <code><a href="graphics.html#topic+boxplot">boxplot</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input file must follow the Copernicus Station Exchange 
Format (SEF). This function works with any numerical variable.
</p>
<p>Zeroes are automatically excluded in bounded variables such as precipitation.
</p>


<h3>Author(s)</h3>

<p>Alba Gilabert, Yuri Brugnara
</p>


<h3>Examples</h3>

<pre><code class='language-R'>climatic_outliers(Rosario$Tn, Meta$Tn, outpath = tempdir(), IQR = 4)

</code></pre>

<hr>
<h2 id='climexp_to_sef'>Download a GHCN-Daily data file from the Climate Explorer and convert it
into the Station Exchange Format</h2><span id='topic+climexp_to_sef'></span>

<h3>Description</h3>

<p>Download a GHCN-Daily data file from the Climate Explorer and convert it
into the Station Exchange Format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>climexp_to_sef(url, outpath)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="climexp_to_sef_+3A_url">url</code></td>
<td>
<p>Character string giving the url of the data file.</p>
</td></tr>
<tr><td><code id="climexp_to_sef_+3A_outpath">outpath</code></td>
<td>
<p>Character string giving the path where to save the file.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yuri Brugnara
</p>

<hr>
<h2 id='convert_pressure'>Convert pressure data to hPa</h2><span id='topic+convert_pressure'></span>

<h3>Description</h3>

<p>Converts pressure observations made with a mercury barometer to SI units.
If geographical coordinates are given, a gravity correction is applied.
If attached temperature is given, a temperature correction is applied.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_pressure(p, f = 1, lat = NA, alt = NA, atb = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_pressure_+3A_p">p</code></td>
<td>
<p>A numerical vector of barometer observations in any unit of length.</p>
</td></tr>
<tr><td><code id="convert_pressure_+3A_f">f</code></td>
<td>
<p>Conversion factor to mm (e.g., 25.4 for English inches).</p>
</td></tr>
<tr><td><code id="convert_pressure_+3A_lat">lat</code></td>
<td>
<p>Station latitude (degrees North in decimal).</p>
</td></tr>
<tr><td><code id="convert_pressure_+3A_alt">alt</code></td>
<td>
<p>Station altitude (metres). Assumed zero if not given. Ignored if
<code>lat</code> is NA.</p>
</td></tr>
<tr><td><code id="convert_pressure_+3A_atb">atb</code></td>
<td>
<p>A vector of the attached temperature observations in Celsius.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numerical vector of pressure values in hPa.
</p>


<h3>Author(s)</h3>

<p>Yuri Brugnara
</p>


<h3>References</h3>

<p>WMO, 2008: Guide to meteorological instruments and methods of observation,
WMO-No. 8, World Meteorological Organization, Geneva.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>convert_pressure(760) # Gives a standard pressure of 1013.25 hPa

convert_pressure(760, lat=70, alt=100) # Gives a higher pressure because of higher g

convert_pressure(760, lat=70, alt=100, atb=20) # Gives a lower pressure because the
                                               # temperature correction is larger than 
                                               # the gravity correction.

</code></pre>

<hr>
<h2 id='daily_out_of_range'>Daily big errors test</h2><span id='topic+daily_out_of_range'></span>

<h3>Description</h3>

<p>Find the daily maximum, minimum, precipitation, mean wind direction,
mean wind speed, snow cover and snow depth that exceed thresholds selected by the
user. The output is a list with the days in which Tx, Tn, rr, dd, w, sc, sd
or fs exceeds some threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>daily_out_of_range(
  dailydata,
  meta = NULL,
  outpath,
  tmax_upper = 45,
  tmax_lower = -30,
  tmin_upper = 30,
  tmin_lower = -40,
  rr_upper = 200,
  rr_lower = 0,
  w_upper = 30,
  w_lower = 0,
  dd_upper = 360,
  dd_lower = 0,
  sc_upper = 100,
  sc_lower = 0,
  sd_upper = 200,
  sd_lower = 0,
  fs_upper = 100,
  fs_lower = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="daily_out_of_range_+3A_dailydata">dailydata</code></td>
<td>
<p>A character string giving the path of the input file,
or a 5-column matrix with following columns: variable code, year, month,
day, and the daily value.</p>
</td></tr>
<tr><td><code id="daily_out_of_range_+3A_meta">meta</code></td>
<td>
<p>A character vector with 6 elements: station ID, latitude, longitude,
altitude, variable code, units. If <code>dailydata</code> is a path, <code>meta</code> is
ignored.</p>
</td></tr>
<tr><td><code id="daily_out_of_range_+3A_outpath">outpath</code></td>
<td>
<p>Character string giving the path for the QC results.</p>
</td></tr>
<tr><td><code id="daily_out_of_range_+3A_tmax_upper">tmax_upper</code></td>
<td>
<p>is the tx maximum threshold in degrees Celsius.
By default, tmax_upper = 45 C.</p>
</td></tr>
<tr><td><code id="daily_out_of_range_+3A_tmax_lower">tmax_lower</code></td>
<td>
<p>is the tx minimum threshold in degrees Celsius.
By default, tmax_lower = -30 C.</p>
</td></tr>
<tr><td><code id="daily_out_of_range_+3A_tmin_upper">tmin_upper</code></td>
<td>
<p>is the tn maximum threshold in degrees Celsius.
By default, tmin_upper = 30 C.</p>
</td></tr>
<tr><td><code id="daily_out_of_range_+3A_tmin_lower">tmin_lower</code></td>
<td>
<p>is the tn minimum threshold in degrees Celsius.
By default, tmin_lower = -40 C.</p>
</td></tr>
<tr><td><code id="daily_out_of_range_+3A_rr_upper">rr_upper</code></td>
<td>
<p>is the rr maximum threshold in millimetres.
By default, rr_upper = 200 mm.</p>
</td></tr>
<tr><td><code id="daily_out_of_range_+3A_rr_lower">rr_lower</code></td>
<td>
<p>is the rr minimum threshold in millimetres.
By default, rr_lower = 0 mm.</p>
</td></tr>
<tr><td><code id="daily_out_of_range_+3A_w_upper">w_upper</code></td>
<td>
<p>is the w maximum threshold in metres per second.
By default, w_upper = 30 m/s.</p>
</td></tr>
<tr><td><code id="daily_out_of_range_+3A_w_lower">w_lower</code></td>
<td>
<p>is the w mimumum threshold in metres per second.
By default, w_lower = 0 m/s.</p>
</td></tr>
<tr><td><code id="daily_out_of_range_+3A_dd_upper">dd_upper</code></td>
<td>
<p>is the dd maximum threshold in degrees North.
By default, dd_upper = 360.</p>
</td></tr>
<tr><td><code id="daily_out_of_range_+3A_dd_lower">dd_lower</code></td>
<td>
<p>is the dd minimum threshold in degrees North.
By default, dd_lower = 0.</p>
</td></tr>
<tr><td><code id="daily_out_of_range_+3A_sc_upper">sc_upper</code></td>
<td>
<p>is the sc maximum threshold in percent.
By default, sc_upper = 100%.</p>
</td></tr>
<tr><td><code id="daily_out_of_range_+3A_sc_lower">sc_lower</code></td>
<td>
<p>is the sc minimum threshold in percent.
By default, sc_lower = 0%.</p>
</td></tr>
<tr><td><code id="daily_out_of_range_+3A_sd_upper">sd_upper</code></td>
<td>
<p>is the sd maximum threshold in centimetres.
By default, sd_upper = 200 cm.</p>
</td></tr>
<tr><td><code id="daily_out_of_range_+3A_sd_lower">sd_lower</code></td>
<td>
<p>is the sd minimum threshold in centimetres.
By default, sd_lower = 0 cm.</p>
</td></tr>
<tr><td><code id="daily_out_of_range_+3A_fs_upper">fs_upper</code></td>
<td>
<p>is the fs maximum threshold in centimetres.
By default, fs_upper = 100 cm.</p>
</td></tr>
<tr><td><code id="daily_out_of_range_+3A_fs_lower">fs_lower</code></td>
<td>
<p>is the fs minimum threshold in centimetres.
By default, fs_lower = 0 cm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input file must follow the Copernicus Station Exchange Format (SEF).
</p>


<h3>Author(s)</h3>

<p>Alba Gilabert, Yuri Brugnara
</p>


<h3>Examples</h3>

<pre><code class='language-R'>daily_out_of_range(Rosario$Tn, Meta$Tn, outpath = tempdir(), tmin_upper = 25)

</code></pre>

<hr>
<h2 id='daily_repetition'>Daily repetition test</h2><span id='topic+daily_repetition'></span>

<h3>Description</h3>

<p>Report occurrences of equal consecutive values in daily data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>daily_repetition(dailydata, meta = NULL, outpath, n = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="daily_repetition_+3A_dailydata">dailydata</code></td>
<td>
<p>A character string giving the path of the input file,
or a 5-column matrix with following columns: variable code, year, month,
day, and the daily value.</p>
</td></tr>
<tr><td><code id="daily_repetition_+3A_meta">meta</code></td>
<td>
<p>A character vector with 6 elements: station ID, latitude, longitude,
altitude, variable code, units. If <code>dailydata</code> is a path, <code>meta</code> is
ignored.</p>
</td></tr>
<tr><td><code id="daily_repetition_+3A_outpath">outpath</code></td>
<td>
<p>Character string giving the path for the QC results.</p>
</td></tr>
<tr><td><code id="daily_repetition_+3A_n">n</code></td>
<td>
<p>Number of minimum equal consecutive values required for a flag. The
default is 4.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input file must follow the Copernicus Station Exchange Format (SEF).
</p>
<p>Zeroes are automatically excluded in bounded variables such as precipitation.
</p>


<h3>Author(s)</h3>

<p>Alba Gilabert, Yuri Brugnara
</p>


<h3>Examples</h3>

<pre><code class='language-R'>daily_repetition(Rosario$Tx, Meta$Tx, outpath = tempdir(), n = 3)

</code></pre>

<hr>
<h2 id='duplicate_columns'>Duplicate columns test</h2><span id='topic+duplicate_columns'></span>

<h3>Description</h3>

<p>Looks for data that have been digitized twice by mistake. For sud-daily data,
this is done by looking for series of zero differences between adjacent
observation times. For daily data, by looking for series of zero differences 
between the same days of adjacent months.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>duplicate_columns(Data, meta = NULL, outpath, ndays = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="duplicate_columns_+3A_data">Data</code></td>
<td>
<p>A character string giving the path of the input file,
or a matrix with 5 (7) columns for daily (sub-daily) data: variable code, year, 
month, day, (hour), (minute), value.</p>
</td></tr>
<tr><td><code id="duplicate_columns_+3A_meta">meta</code></td>
<td>
<p>A character vector with 6 elements: station ID, latitude, longitude,
altitude, variable code, units. If <code>Data</code> is a path, <code>meta</code> is
ignored.</p>
</td></tr>
<tr><td><code id="duplicate_columns_+3A_outpath">outpath</code></td>
<td>
<p>Character string giving the path for the QC results.</p>
</td></tr>
<tr><td><code id="duplicate_columns_+3A_ndays">ndays</code></td>
<td>
<p>Number of consecutive days with zero difference required to
flag the data. The default is 5.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input file must follow the Copernicus Station Exchange 
Format (SEF). This function works with any numerical variable.
</p>
<p>Zeroes are automatically excluded in bounded variables such as precipitation.
</p>


<h3>Author(s)</h3>

<p>Yuri Brugnara
</p>


<h3>Examples</h3>

<pre><code class='language-R'>climatic_outliers(Rosario$Tn, Meta$Tn, outpath = tempdir(), ndays = 3) 

</code></pre>

<hr>
<h2 id='duplicate_dates'>Duplicate dates test</h2><span id='topic+duplicate_dates'></span>

<h3>Description</h3>

<p>Flag dates that appear more than once in daily data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>duplicate_dates(dailydata, meta = NULL, outpath)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="duplicate_dates_+3A_dailydata">dailydata</code></td>
<td>
<p>A character string giving the path of the input file,
or a 5-column matrix with following columns: variable code, year, month,
day, and the daily value.</p>
</td></tr>
<tr><td><code id="duplicate_dates_+3A_meta">meta</code></td>
<td>
<p>A character vector with 6 elements: station ID, latitude, longitude,
altitude, variable code, units. If <code>dailydata</code> is a path, <code>meta</code> is
ignored.</p>
</td></tr>
<tr><td><code id="duplicate_dates_+3A_outpath">outpath</code></td>
<td>
<p>Character string giving the path for the QC results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input file must follow the Copernicus Station Exchange Format (SEF).
</p>


<h3>Author(s)</h3>

<p>Alba Gilabert, Yuri Brugnara
</p>


<h3>Examples</h3>

<pre><code class='language-R'>duplicate_dates(Rosario$Tx, Meta$Tx, outpath = tempdir())

</code></pre>

<hr>
<h2 id='duplicate_times'>Duplicate times test</h2><span id='topic+duplicate_times'></span>

<h3>Description</h3>

<p>Flag times that appear more than once.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>duplicate_times(subdailydata, meta = NULL, outpath)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="duplicate_times_+3A_subdailydata">subdailydata</code></td>
<td>
<p>A character string giving the path of the input file,
or a 7-column matrix with following columns: variable code, year, month,
day, hour, minute, value.</p>
</td></tr>
<tr><td><code id="duplicate_times_+3A_meta">meta</code></td>
<td>
<p>A character vector with 6 elements: station ID, latitude, longitude,
altitude, variable code, units. If <code>subdailydata</code> is a path, <code>meta</code> is
ignored.</p>
</td></tr>
<tr><td><code id="duplicate_times_+3A_outpath">outpath</code></td>
<td>
<p>Character string giving the path for the QC results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input file must follow the Copernicus Station Exchange Format (SEF).
</p>


<h3>Author(s)</h3>

<p>Alba Gilabert, Yuri Brugnara
</p>


<h3>Examples</h3>

<pre><code class='language-R'>duplicate_times(Bern$p, Meta$p[which(Meta$p$id=="Bern"),], outpath = tempdir())

</code></pre>

<hr>
<h2 id='impossible_values'>Gross Errors Test for Cloud Cover and Relative Humidity.</h2><span id='topic+impossible_values'></span>

<h3>Description</h3>

<p>Applicable to a series (daily or sub-daily) of relative humidity (rh) in percent
or to a series of cloud cover (n) in percent or oktas.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>impossible_values(series, meta = NULL, outpath)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="impossible_values_+3A_series">series</code></td>
<td>
<p>A character string giving the path of the SEF file, or a
five or seven-column (daily or subdaily) data frame with the series.</p>
</td></tr>
<tr><td><code id="impossible_values_+3A_meta">meta</code></td>
<td>
<p>A character vector with 6 elements: station ID, latitude, longitude,
altitude, variable code, units. If <code>series</code> is a path, <code>meta</code> is
ignored.</p>
</td></tr>
<tr><td><code id="impossible_values_+3A_outpath">outpath</code></td>
<td>
<p>Character string giving the path for the QC results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Input:</strong>
</p>

<ul>
<li><p> A SEF file or a data frame and metadata. The observations data frame
must have five or seven columns: variable code, year (YYYY), month (MM), day
(DD), (hour (HH), minute (MM)), observation.
</p>
</li></ul>

<p><strong>Output:</strong>
</p>

<ul>
<li><p> A text file of flagged observations with six or eight columns: variable
code, year (YYYY), month (MM), day (DD), (hour (HH), minute (MM)),
observation, test. The test column has the description &quot;gross_errors&quot;.
</p>
</li>
<li><p> The flagged observations correspond to values that don't belong to the
integer interval (0, 100) if the unit is percent or that don't belong to the
integer interval (0, 9) if the unit is oktas.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Clara Ventura, Yuri Brugnara
</p>


<h3>Examples</h3>

<pre><code class='language-R'>impossible_values(series = Rosario$n, meta = Meta$n, outpath = tempdir())
impossible_values(series = Rosario$rh, meta = Meta$rh, outpath = tempdir())

</code></pre>

<hr>
<h2 id='internal_consistency'>Daily internal consistency test</h2><span id='topic+internal_consistency'></span>

<h3>Description</h3>

<p>Determines the coherence between daily maximum temperature (Tx) values and
daily minimum temperature (Tn) values; daily wind speed (w) and wind
direction (dd); daily snow cover (sc) and snow depth (sd); daily fresh snow 
(fs) and snow depth (sd); daily fresh snow (fs) and minimum temperature (Tn);
daily snow depth (sd) and minimum temperature (Tn).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>internal_consistency(dailydata, meta = NULL, outpath)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="internal_consistency_+3A_dailydata">dailydata</code></td>
<td>
<p>A character vector giving the paths of two input files,
or a 5-column matrix with following columns: variable code, year, month,
day, and the daily value.</p>
</td></tr>
<tr><td><code id="internal_consistency_+3A_meta">meta</code></td>
<td>
<p>A data frame with 2 rows and 6 columns: station ID, latitude, 
longitude, altitude, variable code, units. If <code>dailydata</code> is a vector, 
<code>meta</code> is ignored.</p>
</td></tr>
<tr><td><code id="internal_consistency_+3A_outpath">outpath</code></td>
<td>
<p>Character string giving the path for the QC results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input file must follow the Copernicus Station Exchange 
Format (SEF).
</p>
<p>The daily minimum temperature is assumed to be observed at the same time of 
the snow depth / fresh snow, and to refer to the same 24-hour period. Snow 
accumulation is flagged if the minimum temperature is
higher than 3 degrees Celsius.
</p>


<h3>Author(s)</h3>

<p>Alba Gilabert, Yuri Brugnara
</p>


<h3>Examples</h3>

<pre><code class='language-R'>internal_consistency(rbind(Rosario$Tx, Rosario$Tn), 
                     rbind(Meta$Tx, Meta$Tn),
                     outpath = tempdir())

</code></pre>

<hr>
<h2 id='Meta'>Metadata for the stations of Bern and Rosario de Santa Fe</h2><span id='topic+Meta'></span>

<h3>Description</h3>

<p>Metadata for the stations of Bern and Rosario de Santa Fe
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Meta
</code></pre>


<h3>Format</h3>

<p>A list of data frames (one data frame per variable)
</p>


<h3>Source</h3>

<p>Institute of Geography - University of Bern
</p>

<hr>
<h2 id='plot_daily'>Plot daily data points</h2><span id='topic+plot_daily'></span>

<h3>Description</h3>

<p>Plot daily data points for custom intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_daily(
  dailydata,
  len = 1,
  outfile,
  startyear = NA,
  endyear = NA,
  miss = TRUE,
  units = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_daily_+3A_dailydata">dailydata</code></td>
<td>
<p>A character string giving the path of the input file, or
a 5-column matrix with following columns: variable code, year, month, day,  
and the daily value.</p>
</td></tr>
<tr><td><code id="plot_daily_+3A_len">len</code></td>
<td>
<p>Integer indicating the number of years shown in 
each panel.</p>
</td></tr>
<tr><td><code id="plot_daily_+3A_outfile">outfile</code></td>
<td>
<p>Character string giving the path of the output pdf file.</p>
</td></tr>
<tr><td><code id="plot_daily_+3A_startyear">startyear</code></td>
<td>
<p>First year to plot. If not indicated, all available years
until <code>endyear</code> will be plotted.</p>
</td></tr>
<tr><td><code id="plot_daily_+3A_endyear">endyear</code></td>
<td>
<p>Last year to plot. If not indicated, all available years
since <code>startyear</code> will be plotted.</p>
</td></tr>
<tr><td><code id="plot_daily_+3A_miss">miss</code></td>
<td>
<p>If TRUE (the default), missing data are plotted as red crosses at the bottom 
of the plot.</p>
</td></tr>
<tr><td><code id="plot_daily_+3A_units">units</code></td>
<td>
<p>Character string giving the units (will be printed in the y-axis). If
<code>dailydata</code> is a path to a file, then the units are read from the SEF header.</p>
</td></tr>
<tr><td><code id="plot_daily_+3A_...">...</code></td>
<td>
<p>Graphical parameters passed to the function <code><a href="graphics.html#topic+plot">plot</a></code>,
such as <code>cex</code>, <code>lwd</code>, <code>pch</code>, <code>col</code>, etc.
(see <code><a href="graphics.html#topic+par">par</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input file must follow the C3S Station Exchange Format (SEF).
</p>
<p>Missing data are shown as red dots at the bottom of the plot.
</p>


<h3>Author(s)</h3>

<p>Stefan Hunziker, Yuri Brugnara
</p>


<h3>References</h3>

<p>Hunziker et al., 2017: Identifying, attributing, and overcoming common data quality 
issues of manned station observations. Int. J. Climatol, 37: 4131-4145.
</p>
<p>Hunziker et al., 2018: Effects of undetected data quality issues on climatological
analyses. Clim. Past, 14: 1-20.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot_daily(Rosario$Tx, len = 2, outfile = paste0(tempdir(),"/test.pdf"))

</code></pre>

<hr>
<h2 id='plot_decimals'>Plot decimals</h2><span id='topic+plot_decimals'></span>

<h3>Description</h3>

<p>Plot year-by-year distribution of the decimals
in order to investigate the actual reporting resolution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_decimals(Data, outfile, startyear = NA, endyear = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_decimals_+3A_data">Data</code></td>
<td>
<p>A character string giving the path of the input file, or
a 5 or 7-column matrix (depending on data type) with following columns: 
variable code, year, month, day, (hour), (minute), value.</p>
</td></tr>
<tr><td><code id="plot_decimals_+3A_outfile">outfile</code></td>
<td>
<p>Character string giving the path of the output pdf file.</p>
</td></tr>
<tr><td><code id="plot_decimals_+3A_startyear">startyear</code></td>
<td>
<p>First year to plot. If not indicated, all available years
until <code>endyear</code> will be plotted.</p>
</td></tr>
<tr><td><code id="plot_decimals_+3A_endyear">endyear</code></td>
<td>
<p>Last year to plot. If not indicated, all available years
since <code>startyear</code> will be plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input file must follow the C3S Station Exchange Format (SEF).
</p>
<p>Only the first digit after the decimal point is analysed. If there is more
than one digit, the data will be rounded to the first decimal place.
</p>


<h3>Note</h3>

<p>For precipitation and other bounded variables one needs to remove the values
at the boundaries from the input data (e.g., zeros for precipitation).
</p>


<h3>Author(s)</h3>

<p>Stefan Hunziker, Yuri Brugnara
</p>


<h3>References</h3>

<p>Hunziker et al., 2017: Identifying, attributing, and overcoming common data quality 
issues of manned station observations. Int. J. Climatol, 37: 4131-4145.
</p>
<p>Hunziker et al., 2018: Effects of undetected data quality issues on climatological
analyses. Clim. Past, 14: 1-20.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot_decimals(Rosario$Tx, outfile = paste0(tempdir(),"/test.pdf"))

</code></pre>

<hr>
<h2 id='plot_subdaily'>Plot sub-daily data points</h2><span id='topic+plot_subdaily'></span>

<h3>Description</h3>

<p>Plot sub-daily data points divided by month.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_subdaily(
  subdailydata,
  year = NA,
  outfile,
  fixed = TRUE,
  units = NA,
  time_offset = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_subdaily_+3A_subdailydata">subdailydata</code></td>
<td>
<p>A character string giving the path of the input file, or
a 7-column matrix with following columns: variable code, year, month, day,  
hour, minute, value.</p>
</td></tr>
<tr><td><code id="plot_subdaily_+3A_year">year</code></td>
<td>
<p>Integer vector giving the year(s) to plot. If not specified (NA), 
all available years will be plotted. One pdf per year will be created.</p>
</td></tr>
<tr><td><code id="plot_subdaily_+3A_outfile">outfile</code></td>
<td>
<p>Character string giving the path of the output pdf file. If
<code>year</code> has more than one element or is NA, then this is a root to the 
filenames to which the year will be added ('root.year.pdf').</p>
</td></tr>
<tr><td><code id="plot_subdaily_+3A_fixed">fixed</code></td>
<td>
<p>If TRUE (default), use the same y axis for all months. If FALSE,
the axis limits are set based on the data range of each month.</p>
</td></tr>
<tr><td><code id="plot_subdaily_+3A_units">units</code></td>
<td>
<p>Character string giving the units (will be printed in the y-axis). 
If <code>subdailydata</code> is a path to a file, then the units are read from the 
SEF header.</p>
</td></tr>
<tr><td><code id="plot_subdaily_+3A_time_offset">time_offset</code></td>
<td>
<p>Numeric vector of offsets in hours to be applied to the observation
times. Recycled if only one value is given. The default is no offset, 
i.e. UTC times for SEF input.</p>
</td></tr>
<tr><td><code id="plot_subdaily_+3A_...">...</code></td>
<td>
<p>Graphical parameters passed to the function <code><a href="graphics.html#topic+plot">plot</a></code>,
such as <code>cex</code>, <code>lwd</code>, <code>pch</code>, <code>col</code>, etc.
(see <code><a href="graphics.html#topic+par">par</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates one pdf for each year plotted.
</p>
<p>The input file must follow the C3S Station Exchange Format (SEF).
</p>
<p>The parameter <code>time_offset</code> can be used to plot observations in local time
when reading the data in SEF.
</p>


<h3>Author(s)</h3>

<p>Stefan Hunziker, Yuri Brugnara
</p>


<h3>References</h3>

<p>Hunziker et al., 2017: Identifying, attributing, and overcoming common data quality 
issues of manned station observations. Int. J. Climatol, 37: 4131-4145.
</p>
<p>Hunziker et al., 2018: Effects of undetected data quality issues on climatological
analyses. Clim. Past, 14: 1-20.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot_subdaily(Bern$p, year = 1803:1804, outfile = paste0(tempdir(),"/test"))

</code></pre>

<hr>
<h2 id='plot_weekly_cycle'>Plot weekly cycle</h2><span id='topic+plot_weekly_cycle'></span>

<h3>Description</h3>

<p>Check if there is a significant weekly cycle in daily precipitation data by
means of a binomial test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_weekly_cycle(dailypcp, outpath, p = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_weekly_cycle_+3A_dailypcp">dailypcp</code></td>
<td>
<p>A character vector giving the paths of the input files, or
a list of 5-column matrices with following columns: variable code (must be 'rr'),   
year, month, day, value. The names of the list elements are assumed to be
the station IDs.</p>
</td></tr>
<tr><td><code id="plot_weekly_cycle_+3A_outpath">outpath</code></td>
<td>
<p>Character string giving the path for the output files.</p>
</td></tr>
<tr><td><code id="plot_weekly_cycle_+3A_p">p</code></td>
<td>
<p>Probability threshold for the binomial test (default is 0.95).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input files must follow the C3S Station Exchange Format (SEF).
</p>
<p>Creates one pdf for each station ('weekly.ID.pdf') plus one pdf with an overview 
of the entire dataset ('weekly.pdf').
</p>


<h3>Author(s)</h3>

<p>Stefan Hunziker, Yuri Brugnara
</p>


<h3>References</h3>

<p>Hunziker et al., 2017: Identifying, attributing, and overcoming common data quality 
issues of manned station observations. Int. J. Climatol, 37: 4131-4145.
</p>
<p>Hunziker et al., 2018: Effects of undetected data quality issues on climatological
analyses. Clim. Past, 14: 1-20.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot_weekly_cycle(list(Rosario = Rosario$rr), outpath = tempdir())

</code></pre>

<hr>
<h2 id='qc'>Apply all tests</h2><span id='topic+qc'></span>

<h3>Description</h3>

<p>Perform all quality tests at once on multiple stations and multiple
variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qc(Data, Metadata = NULL, outpath, time_offset = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qc_+3A_data">Data</code></td>
<td>
<p>Either a character vector of paths to SEF files, a data frame
or a list of data frames with 7 columns (one data frame for each station):
variable code, year, month, day, hour, minute, value.
Each data frame can contain more than one variable code.</p>
</td></tr>
<tr><td><code id="qc_+3A_metadata">Metadata</code></td>
<td>
<p>A data frame with 7 columns: station ID, latitude, longitude,
altitude, variable code, units, resolution. If <code>Data</code> is a list, the station 
IDs must appear in the same order of the respective elements in the list.
'resolution' can be either 'daily' (or 'd') or 'subdaily' (or 's').
If <code>Data</code> is a vector, <code>Metadata</code> is ignored and all the
required information is read from the SEF files.</p>
</td></tr>
<tr><td><code id="qc_+3A_outpath">outpath</code></td>
<td>
<p>Character string giving the path where the output is saved.</p>
</td></tr>
<tr><td><code id="qc_+3A_time_offset">time_offset</code></td>
<td>
<p>Numerical vector (of length 1 or equal to the number of 
analysed stations) of the number of hours to add to the time 
to obtain local time. This is used for tests on day and night temperature.
Recycled for all stations if only one value is given. Data not stored
in SEF files (i.e., not in UTC) are typically already expressed in local time:
in this case the offset is zero (the default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a wrapper of all functions that can be applied to the variables given
in <code>Data</code> (except the plotting functions).
</p>
<p><code>Data</code> can include any supported variable (see <a href="#topic+Variables">Variables</a>) from 
different stations. The algorithm
will select the tests that can be applied to each variable. Note that some
tests require more than one variable from the same station.
</p>
<p>This function produces flag files (one for each variable at each
station). The filenames follow the standard 
'qc_&lt;stationID&gt;_&lt;varcode&gt;_&lt;resolution&gt;.txt'.
Each files contains a table of flagged values, with the last column
indicating the tests failed by each flagged observation.
</p>
<p>The flag files can be edited by hand to remove or add flags. The flags can 
then be added to the 'Meta' column of SEF files by using the function 
<a href="#topic+write_flags">write_flags</a>.
</p>


<h3>Note</h3>

<p>The tests will use their default parameters (e.g. thresholds). To use
custum parameters run the tests one by one.
</p>


<h3>Author(s)</h3>

<p>Yuri Brugnara
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Testing all variables for Rosario de Santa Fe

# Create a data frame with all data from list Rosario
# For daily data we need to add the hour and minute columns (NAs)
Ros &lt;- Rosario
Ros$Tx[,c("Hour","Minute")] &lt;- NA
Ros$Tn[,c("Hour","Minute")] &lt;- NA
Ros$rr[,c("Hour","Minute")] &lt;- NA
Ros &lt;- do.call("rbind", Ros)
Ros &lt;- Ros[, c("Var","Year","Month","Day","Hour","Minute","Value")]

# Create a data frame with metadata including data resolution
df_meta &lt;- do.call("rbind", Meta)
df_meta &lt;- df_meta[which(df_meta$id=="Rosario"), ]
df_meta$res &lt;- c("s", "s", "d", "d", "s", "s", "d", rep("s",4))

# Run all qc tests at once
# Time for Rosario is in UTC, therefore an offset is needed to get local time 
qc(Ros, df_meta, outpath = tempdir(), time_offset=-4.28)


# Testing one variable at one station
qc(Bern$ta, cbind(Meta$ta[which(Meta$ta$id=="Bern"),],"s"), 
   outpath = tempdir(), time_offset=0)
   
</code></pre>

<hr>
<h2 id='read_meta'>Read metadata from the Station Exchange Format version 1.0.0</h2><span id='topic+read_meta'></span>

<h3>Description</h3>

<p>Read metadata from the Station Exchange Format version 1.0.0
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_meta(file = file.choose(), parameter = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_meta_+3A_file">file</code></td>
<td>
<p>Character string giving the path of the data file.</p>
</td></tr>
<tr><td><code id="read_meta_+3A_parameter">parameter</code></td>
<td>
<p>Character vector of required parameters. Accepted
values are <code>"version"</code>, <code>"id"</code>, <code>"name"</code>, <code>"lat"</code>,
<code>"lon"</code>, <code>"alt"</code>, <code>"source"</code>, <code>"link"</code>,
<code>"var"</code>, <code>"stat"</code>, <code>"units"</code>, <code>"meta"</code>.
By default all parameters are read at once.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector with the required parameters.
</p>


<h3>Author(s)</h3>

<p>Yuri Brugnara
</p>

<hr>
<h2 id='read_sef'>Read data files in Station Exchange Format version 1.0.0</h2><span id='topic+read_sef'></span>

<h3>Description</h3>

<p>Read data files in Station Exchange Format version 1.0.0
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_sef(file = file.choose(), all = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_sef_+3A_file">file</code></td>
<td>
<p>Character string giving the path of the SEF file.</p>
</td></tr>
<tr><td><code id="read_sef_+3A_all">all</code></td>
<td>
<p>If FALSE (the default), omit the columns 'Period' and 'Meta'
(also 'Hour' and 'Minute' for non-instantaneous data)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with up to 9 variables, depending on whether
<code>all</code> is set to TRUE.
The variables are: variable code, year, month, day, hour, minute,
value, period, metadata.
</p>


<h3>Author(s)</h3>

<p>Yuri Brugnara
</p>

<hr>
<h2 id='Rosario'>Daily and sub-daily meteorological observations for Rosario de Santa Fe (Argentina)</h2><span id='topic+Rosario'></span>

<h3>Description</h3>

<p>Observations of minimum and maximum temperature, wind direction, cloud cover,
pressure, precipitation, air temperature, wet bulb temperature, relative humidity,
dew point, and wind speed for the city of Rosario de Santa Fe (Argentina) for the 
period 1886-1900.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rosario
</code></pre>


<h3>Format</h3>

<p>A list of data frames (one data frame per variable).
The format of the data frames is that required by the QC functions.
</p>


<h3>Source</h3>

<p>ACRE
</p>

<hr>
<h2 id='subdaily_out_of_range'>Sub-daily big errors test</h2><span id='topic+subdaily_out_of_range'></span>

<h3>Description</h3>

<p>Find the subdaily temperature (ta), wind speed (w), 
wind direction (dd), snow cover (sc), snow depth (sd)
and fresh snow (fs) values that exceed thresholds selected by the
user. The output is a list with the days in which ta, rr, dd, w, sc, sd
or fs exceeds some threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subdaily_out_of_range(
  subdailydata,
  meta = NULL,
  outpath,
  time_offset = 0,
  ta_day_upper = 45,
  ta_day_lower = -35,
  ta_night_upper = 40,
  ta_night_lower = -40,
  rr_upper = 100,
  rr_lower = 0,
  w_upper = 50,
  w_lower = 0,
  dd_upper = 360,
  dd_lower = 0,
  sc_upper = 100,
  sc_lower = 0,
  sd_upper = 200,
  sd_lower = 0,
  fs_upper = 100,
  fs_lower = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subdaily_out_of_range_+3A_subdailydata">subdailydata</code></td>
<td>
<p>A character string giving the path of the input file,
or a 7-column matrix with following columns: variable code, year, month,
day, hour, minute, value.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_meta">meta</code></td>
<td>
<p>A character vector with 6 elements: station ID, latitude, longitude,
altitude, variable code, units. If <code>subdailydata</code> is a path, <code>meta</code> is
ignored.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_outpath">outpath</code></td>
<td>
<p>Character string giving the path for the QC results.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_time_offset">time_offset</code></td>
<td>
<p>Offset in hours to add to the time to obtain local time.
By default, time_offset = 0.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_ta_day_upper">ta_day_upper</code></td>
<td>
<p>is the ta maximum day threshold in degrees Celsius.
By default, ta_day_upper = 45 C.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_ta_day_lower">ta_day_lower</code></td>
<td>
<p>is the ta minimum day threshold in degrees Celsius.
By default, ta_day_lower = -35 C.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_ta_night_upper">ta_night_upper</code></td>
<td>
<p>is the ta maximum night threshold in degrees Celsius.
By default, ta_night_upper = 40 C.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_ta_night_lower">ta_night_lower</code></td>
<td>
<p>is the ta minimum night threshold in degrees Celsius.
By default, ta_night_lower = -40 C.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_rr_upper">rr_upper</code></td>
<td>
<p>is the rr maximum threshold in millimetres.
By default, rr_upper = 100 mm.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_rr_lower">rr_lower</code></td>
<td>
<p>is the rr minimum threshold in millimetres.
By default, rr_lower = 0 mm.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_w_upper">w_upper</code></td>
<td>
<p>is the w maximum threshold in metres per second.
By default, w_upper = 50 m/s.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_w_lower">w_lower</code></td>
<td>
<p>is the w mimumum threshold in metres per second.
By default, w_lower = 0 m/s.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_dd_upper">dd_upper</code></td>
<td>
<p>is the dd maximum threshold in degrees North.
By default, dd_upper = 360.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_dd_lower">dd_lower</code></td>
<td>
<p>is the dd minimum threshold in degrees North.
By default, dd_lower = 0.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_sc_upper">sc_upper</code></td>
<td>
<p>is the sc maximum threshold in percent.
By default, sc_upper = 100%.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_sc_lower">sc_lower</code></td>
<td>
<p>is the sc minimum threshold in percent.
By default, sc_lower = 0%.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_sd_upper">sd_upper</code></td>
<td>
<p>is the sd maximum threshold in centimetres.
By default, sd_upper = 200 cm.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_sd_lower">sd_lower</code></td>
<td>
<p>is the sd minimum threshold in centimetres.
By default, sd_lower = 0 cm.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_fs_upper">fs_upper</code></td>
<td>
<p>is the fs maximum threshold in centimetres.
By default, fs_upper = 100 cm.</p>
</td></tr>
<tr><td><code id="subdaily_out_of_range_+3A_fs_lower">fs_lower</code></td>
<td>
<p>is the fs minimum threshold in centimetres.
By default, fs_lower = 0 cm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input file must follow the Copernicus Station Exchange Format (SEF).
</p>


<h3>Author(s)</h3>

<p>Alba Gilabert, Yuri Brugnara
</p>


<h3>Examples</h3>

<pre><code class='language-R'>subdaily_out_of_range(Rosario$ta, Meta$ta[which(Meta$ta$id=="Rosario"),], 
                      outpath = tempdir(), time_offset = -4.28, 
                      ta_day_upper = 35)

</code></pre>

<hr>
<h2 id='subdaily_repetition'>Sub-daily repetition test</h2><span id='topic+subdaily_repetition'></span>

<h3>Description</h3>

<p>Report occurrences of equal consecutive values in subdaily data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subdaily_repetition(subdailydata = file.choose(), meta = NULL, outpath, n = 6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subdaily_repetition_+3A_subdailydata">subdailydata</code></td>
<td>
<p>A character string giving the path of the input file,
or a 7-column matrix with following columns: variable code, year, month,
day, hour, minute, value.</p>
</td></tr>
<tr><td><code id="subdaily_repetition_+3A_meta">meta</code></td>
<td>
<p>A character vector with 6 elements: station ID, latitude, longitude,
altitude, variable code, units. If <code>subdailydata</code> is a path, <code>meta</code> is
ignored.</p>
</td></tr>
<tr><td><code id="subdaily_repetition_+3A_outpath">outpath</code></td>
<td>
<p>Character string giving the path for the QC results.</p>
</td></tr>
<tr><td><code id="subdaily_repetition_+3A_n">n</code></td>
<td>
<p>Number of minimum equal consecutive values required for a flag. The
default is 6.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input file must follow the Copernicus Station Exchange Format (SEF).
</p>
<p>Zeroes are automatically excluded in bounded variables such as precipitation.
</p>


<h3>Author(s)</h3>

<p>Alba Gilabert, Yuri Brugnara
</p>


<h3>Examples</h3>

<pre><code class='language-R'>subdaily_repetition(Rosario$ta, Meta$ta[which(Meta$ta$id=="Rosario"),], 
                    outpath = tempdir(), n = 3)

</code></pre>

<hr>
<h2 id='temporal_coherence'>Daily temporal coherence test</h2><span id='topic+temporal_coherence'></span>

<h3>Description</h3>

<p>Find those records where daily maximum or minimum temperature, 
mean wind speed, 
snow depth, snow cover, or fresh snow differences with previous day are too
large.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>temporal_coherence(
  dailydata,
  meta = NULL,
  outpath,
  temp_jumps = 20,
  windspeed_jumps = 15,
  snowdepth_jumps = 50
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="temporal_coherence_+3A_dailydata">dailydata</code></td>
<td>
<p>A character string giving the path of the input file,
or a 5-column matrix with following columns: variable code, year, month,
day, and the daily value.</p>
</td></tr>
<tr><td><code id="temporal_coherence_+3A_meta">meta</code></td>
<td>
<p>A character vector with 6 elements: station ID, latitude, longitude,
altitude, variable code, units. If <code>dailydata</code> is a path, <code>meta</code> is
ignored.</p>
</td></tr>
<tr><td><code id="temporal_coherence_+3A_outpath">outpath</code></td>
<td>
<p>Character string giving the path for the QC results.</p>
</td></tr>
<tr><td><code id="temporal_coherence_+3A_temp_jumps">temp_jumps</code></td>
<td>
<p>given a daily maximum or minimum temperature values of two
consecutive days, maximum difference in degrees Celsius. By default, 
temp_jumps = 20 C.</p>
</td></tr>
<tr><td><code id="temporal_coherence_+3A_windspeed_jumps">windspeed_jumps</code></td>
<td>
<p>given a daily mean wind speed value of two consecutive days,
maximum difference in metres per second. By default, wind_jumps = 15 m/s.</p>
</td></tr>
<tr><td><code id="temporal_coherence_+3A_snowdepth_jumps">snowdepth_jumps</code></td>
<td>
<p>given a daily snow depth of two consecutive days, 
maximum difference in centimetres. By default, snowdepth_jumps = 50 cm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input file must follow the Copernicus Station Exchange 
Format (SEF).
</p>


<h3>Author(s)</h3>

<p>Alba Gilabert, Yuri Brugnara
</p>


<h3>Examples</h3>

<pre><code class='language-R'>temporal_coherence(Rosario$Tx, Meta$Tx, outpath = tempdir(), temp_jumps = 10)

</code></pre>

<hr>
<h2 id='Tests'>Table of available qc tests</h2><span id='topic+Tests'></span>

<h3>Description</h3>

<p>Table of available qc tests
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Tests
</code></pre>


<h3>Format</h3>

<p>Data frame
</p>

<hr>
<h2 id='Variables'>Table of supported variable codes</h2><span id='topic+Variables'></span>

<h3>Description</h3>

<p>Table of supported variable codes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Variables
</code></pre>


<h3>Format</h3>

<p>Data frame
</p>

<hr>
<h2 id='wmo_gross_errors'>WMO Gross Errors Tests for Pressure, Temperature, Dew Point, and Wind Speed.</h2><span id='topic+wmo_gross_errors'></span>

<h3>Description</h3>

<p>Applicable to a series (daily or sub-daily) of air pressure, air temperature (ta),
dew point temperature (td), wind speed (w).
The pressure series can be at mean sea level (mslp) or at station level (p). 
Flags the records where the observations values exceed the limit values given 
by WMO (1993).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wmo_gross_errors(series, meta = NULL, outpath)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wmo_gross_errors_+3A_series">series</code></td>
<td>
<p>A character string giving the path of the SEF file, or a
five or seven-column (daily or subdaily) data frame with the series.</p>
</td></tr>
<tr><td><code id="wmo_gross_errors_+3A_meta">meta</code></td>
<td>
<p>A character vector with 6 elements: station ID, latitude, longitude,
altitude, variable code, units. If <code>series</code> is a path, <code>meta</code> is
ignored.</p>
</td></tr>
<tr><td><code id="wmo_gross_errors_+3A_outpath">outpath</code></td>
<td>
<p>Character string giving the path for the QC results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Input:</strong>
</p>

<ul>
<li><p> A SEF file or a data frame and metadata. The observations data frame
must have five or seven columns: variable code, year (YYYY), month (MM), day
(DD), (hour (HH), minute (MM)), observation. The required metadata are the
station identifier, the station latitude and variable units.
</p>
</li></ul>

<p><strong>The WMO gross error limits for air pressure, air temperature, dew
point temperature, and wind speed:</strong>
</p>

<ul>
<li><p> For station level pressure the gross error limits are latitude and
meteorological season independent (WMO, 1993: VI.7). According to the same
reference, for mean sea level pressure, temperature, dew point, and wind speed,
the WMO establishes the gross error limits as
function of the station latitude and the meteorological season in which the
observations were collected.
</p>
</li>
<li><p> The tests divide the meteorological seasons in Winter and Summer. So,
based on the meteorological calendar for the Northern Hemisphere, which
defines seasons as Spring (March, April, May), Summer (June, July, August),
Autumn (September, October, November) and Winter (December, January,
February), it was here considered:
</p>

<ul>
<li><p> Northern Hemisphere Winter / Southern Hemisphere Summer - January,
February, March, October, November, December;
</p>
</li>
<li><p> Northern Hemisphere Summer / Southern Hemisphere Winter  - April, May,
June, July, August, September.
</p>
</li></ul>

</li>
<li><p> The gross error limits for each variable divide the flagged values in
suspect and erroneous (WMO, 1993: VI.6 - VI.8).
</p>
</li>
<li> <p><strong>Latitude independent</strong>
</p>

<ul>
<li> <p><strong>Meteorological season independent</strong>
</p>

<ul>
<li> <p><strong>Station Level Pressure (p):</strong> 
</p>

<ul>
<li><p> Suspect: <em>300 &lt;= p &lt; 400 hPa or 1080 &lt; p &lt;= 1100 hPa</em>
</p>
</li>
<li><p> Erroneous: <em>p &lt; 300 or p &gt; 1100 hPa</em>
</p>
</li></ul>

</li></ul>

</li></ul>

</li>
<li> <p><strong>Latitudes belonging to the interval [-45, +45]</strong>
</p>

<ul>
<li> <p><strong>Winter</strong>
</p>

<ul>
<li> <p><strong>Mean Sea Level Pressure (mslp)</strong>
</p>

<ul>
<li><p> Suspect: <em>870 &lt;= mslp &lt; 910 hPa or 1080 &lt; mslp &lt;= 1100 hPa</em>
</p>
</li>
<li><p> Erroneous: <em>mslp &lt; 870 hPa or mslp &gt; 1100 hPa</em>
</p>
</li></ul>

</li>
<li> <p><strong>Air Temperature (ta)</strong>
</p>

<ul>
<li><p> Suspect: <em>-40 &lt;= ta &lt; -30 C or 50 &lt; ta &lt;= 55 C</em>
</p>
</li>
<li><p> Erroneous: <em>ta &lt; -40 C or ta &gt; 55 C</em>
</p>
</li></ul>

</li>
<li> <p><strong>Dew Point Temperature (td)</strong>
</p>

<ul>
<li><p> Suspect: <em>-45 &lt;= td &lt; -35 C or 35 &lt; td &lt;= 40 C</em>
</p>
</li>
<li><p> Erroneous: <em>td &lt; -45 C or td &gt; 40 C</em>
</p>
</li></ul>

</li>
<li> <p><strong>Wind Speed (w)</strong>
</p>

<ul>
<li><p> Suspect: <em>w &gt; 60 m/s and w &lt;= 125 m/s</em>
</p>
</li>
<li><p> Erroneous: <em>w &gt; 125 m/s</em>
</p>
</li></ul>

</li></ul>

</li>
<li> <p><strong>Summer</strong>
</p>

<ul>
<li> <p><strong>Mean Sea Level Pressure (mslp)</strong>
</p>

<ul>
<li><p> Suspect: <em>850 &lt;= mslp &lt; 900 hPa or 1080 &lt; mslp &lt;= 1100 hPa</em>
</p>
</li>
<li><p> Erroneous: <em>mslp &lt; 850 hPa or mslp &gt; 1100 hPa</em>
</p>
</li></ul>

</li>
<li> <p><strong>Air Temperature (ta)</strong>
</p>

<ul>
<li><p> Suspect: <em>-30 &lt;= ta &lt; -20 C or 50 &lt; ta &lt;= 60 C</em>
</p>
</li>
<li><p> Erroneous: <em>ta &lt; -30 C or ta &gt; 60 C</em>
</p>
</li></ul>

</li>
<li> <p><strong>Dew Point Temperature (td)</strong>
</p>

<ul>
<li><p> Suspect: <em>-35 &lt;= td &lt; -25 C or 35 &lt; td &lt;= 40 C</em>
</p>
</li>
<li><p> Erroneous: <em>td &lt; -35 C or td &gt; 40 C</em>
</p>
</li></ul>

</li>
<li> <p><strong>Wind Speed (w)</strong>
</p>

<ul>
<li><p> Suspect: <em>w &gt; 90 m/s and w &lt;= 150 m/s</em>
</p>
</li>
<li><p> Erroneous: <em>w &gt; 150 m/s</em>
</p>
</li></ul>

</li></ul>

</li></ul>

</li>
<li> <p><strong>Latitudes belonging to the interval [-90, -45[ U ]+45, +90]</strong>
</p>

<ul>
<li> <p><strong>Winter</strong>
</p>

<ul>
<li> <p><strong>Mean Sea Level Pressure (mslp)</strong>
</p>

<ul>
<li><p> Suspect: <em>910 &lt;= mslp &lt; 940 hPa or 1080 &lt; mslp &lt;= 1100 hPa</em>
</p>
</li>
<li><p> Erroneous: <em>mslp &lt; 910 hPa or mslp &gt; 1100 hPa</em>
</p>
</li></ul>

</li>
<li> <p><strong>Air Temperature (ta)</strong>
</p>

<ul>
<li><p> Suspect: <em>-90 &lt;= ta &lt; -80 C or 35 &lt; ta &lt;= 40 C</em>
</p>
</li>
<li><p> Erroneous: <em>ta &lt; -90 C or ta &gt; 40 C</em>
</p>
</li></ul>

</li>
<li> <p><strong>Dew Point Temperature (td)</strong>
</p>

<ul>
<li><p> Suspect: <em>-99 &lt;= td &lt; -85 C or 30 &lt; td &lt;= 35 C</em>
</p>
</li>
<li><p> Erroneous: <em>td &lt; -99 C or td &gt; 35 C</em>
</p>
</li></ul>

</li>
<li> <p><strong>Wind Speed (w)</strong>
</p>

<ul>
<li><p> Suspect: <em>w &gt; 50 m/s and w &lt;= 100 m/s</em>
</p>
</li>
<li><p> Erroneous: <em>w &gt; 100 m/s</em>
</p>
</li></ul>

</li></ul>

</li>
<li> <p><strong>Summer</strong>
</p>

<ul>
<li> <p><strong>Mean Sea Level Pressure (mslp)</strong>
</p>

<ul>
<li><p> Suspect: <em>920 &lt;= mslp &lt; 950 hPa or 1080 &lt; mslp &lt;= 1100 hPa</em>
</p>
</li>
<li><p> Erroneous: <em>mslp &lt; 920 hPa or mslp &gt; 1100 hPa</em>
</p>
</li></ul>

</li>
<li> <p><strong>Air Temperature (ta)</strong>
</p>

<ul>
<li><p> Suspect: <em>-40 &lt;= ta &lt; -30 C or 40 &lt; ta &lt;= 50 C</em>
</p>
</li>
<li><p> Erroneous: <em>ta &lt; -40 C or ta &gt; 50 C</em>
</p>
</li></ul>

</li>
<li> <p><strong>Dew Point Temperature (td)</strong>
</p>

<ul>
<li><p> Suspect: <em>-45 &lt;= td &lt; -35 C or 35 &lt; td &lt;= 40 C</em>
</p>
</li>
<li><p> Erroneous: <em>td &lt; -45 C or td &gt; 40 C</em>
</p>
</li></ul>

</li>
<li> <p><strong>Wind Speed (w)</strong>
</p>

<ul>
<li><p> Suspect values: <em>w &gt; 40 m/s and w &lt;= 75 m/s</em>
</p>
</li>
<li><p> Erroneous values: <em>w &gt; 75 m/s</em>
</p>
</li></ul>

</li></ul>

</li></ul>

</li></ul>

<p><strong>Output:</strong>
</p>

<ul>
<li><p> A text file of flagged observations with six or eight columns: variable
code, year (YYYY), month (MM), day (DD), (hour (HH), minute (MM)),
observation, test. The test column has the description &quot;gross_errors&quot;.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Clara Ventura, Yuri Brugnara
</p>


<h3>References</h3>

<p>WMO, 1993: Chapter 6 - Quality Control Procedures. Guide on the Global
Data-processing System, World Meteorological Organization, Geneva, No. 305,
VI.1-VI.27, ISBN 92-63-13305-0.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wmo_gross_errors(series = Rosario$p, meta = Meta$p[which(Meta$p$id=="Rosario"),],
                 outpath = tempdir())
wmo_gross_errors(series = Rosario$ta, meta = Meta$ta[which(Meta$p$id=="Rosario"),],
                 outpath = tempdir())
wmo_gross_errors(series = Rosario$td, meta = Meta$td, outpath = tempdir())

</code></pre>

<hr>
<h2 id='wmo_time_consistency'>WMO Time Consistency Test for Pressure, Temperature and Dew Point.</h2><span id='topic+wmo_time_consistency'></span>

<h3>Description</h3>

<p>Applicable to a series of sub-daily air pressure (p, mslp),  
air temperature (ta) or dew point temperature (td) observations with at least
some time intervals between observations less or equal to twelve hours. 
Flags the records where
the observations exceed the WMO suggested tolerances for the temperatures and
pressure tendency as function of time period between consecutive reports.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wmo_time_consistency(series, meta = NULL, outpath)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wmo_time_consistency_+3A_series">series</code></td>
<td>
<p>A character string giving the path of the input file,
or a 7-column matrix with following columns: variable code, year, month,
day, hour, minute, value.</p>
</td></tr>
<tr><td><code id="wmo_time_consistency_+3A_meta">meta</code></td>
<td>
<p>A character vector with 6 elements: station ID, latitude, longitude,
altitude, variable code, units. If <code>series</code> is a path, <code>meta</code> is
ignored.</p>
</td></tr>
<tr><td><code id="wmo_time_consistency_+3A_outpath">outpath</code></td>
<td>
<p>Character string giving the path for the QC results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Input:</strong>
</p>

<ul>
<li><p> A SEF file or a data frame and metadata. The observations data frame
must have seven columns: variable code, year (YYYY), month (MM), day
(DD), hour (HH), minute (MM), observation.
</p>
</li></ul>

<p><strong>The WMO time consistency test:</strong>
</p>

<ul>
<li><p> WMO suggested tolerances for the temperatures and pressure tendency as
function of time period between consecutive reports (WMO, 1993: VI.21):
</p>

<table>
<tr>
 <td style="text-align: left;">Parameter | </td><td style="text-align: left;"> dt = 1 hour | </td><td style="text-align: left;"> dt = 2 hours | </td><td style="text-align: left;"> dt
= 3 hours | </td><td style="text-align: left;"> dt = 6 hours | </td><td style="text-align: left;"> dt = 12 hours </td>
</tr>
<tr>
 <td style="text-align: left;"> ta_tol </td><td style="text-align: left;"> 4 C </td><td style="text-align: left;">
7 C  </td><td style="text-align: left;"> 9 C </td><td style="text-align: left;"> 15 C  </td><td style="text-align: left;"> 25 C </td>
</tr>
<tr>
 <td style="text-align: left;"> td_tol </td><td style="text-align: left;"> 4 C </td><td style="text-align: left;"> 6 C </td><td style="text-align: left;"> 8
C </td><td style="text-align: left;"> 12 C  </td><td style="text-align: left;"> 20 C </td>
</tr>
<tr>
 <td style="text-align: left;"> pp_tol </td><td style="text-align: left;"> 3 hPa </td><td style="text-align: left;"> 6 hPa  </td><td style="text-align: left;"> 9 hPa </td><td style="text-align: left;"> 18
hPa </td><td style="text-align: left;"> 36 hPa </td>
</tr>

</table>

</li>
<li><p> The temperatures tolerance - <em>ta_tol</em> and <em>td_tol</em> -
considered for 1, 2, 3, 6 and 12 hours is given by the table above.
</p>
</li>
<li><p> The pressure tolerance <em>p_tol</em> is determined for time intervals
belonging to [1, 12] hours, assuming that there is a linear variation of 3
hPa per hour, based in the table above.
</p>
</li>
<li><p> Time consistency test (WMO, 1993: VI.21):
</p>
<p><code class="reqn">| obs(t) - obs(t - dt) | &gt; tol =&gt; flag_obs(t) = suspect and
flag_obs(t-dt) = suspect</code>
</p>
<p><code class="reqn">obs - observation (ta, td or p), t - hour in decimal, dt - hour
difference in decimal, tol - tolerance</code>
</p>
</li>
<li><p> The flag, correspondent to suspect values, is always associated with
two consecutive observations within twelve hours.
</p>
</li></ul>

<p><strong>Output:</strong>
</p>

<ul>
<li><p> A text file of flagged observations with eight columns: variable code,
year, month, day, hour, minute, value, test.
The test column has the description &quot;wmo_time_consistency&quot;.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Clara Ventura, Yuri Brugnara
</p>


<h3>References</h3>

<p>WMO, 1993: Chapter 6 - Quality Control Procedures. Guide on the Global
Data-processing System, World Meteorological Organization, Geneva, No. 305,
VI.1-VI.27, ISBN 92-63-13305-0.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wmo_time_consistency(series = Bern$p, meta = Meta$p[which(Meta$p$id=="Bern"),],
                     outpath = tempdir())

</code></pre>

<hr>
<h2 id='write_flags'>Add quality flags to a data file in Station Exchange Format version 1.0.0</h2><span id='topic+write_flags'></span>

<h3>Description</h3>

<p>Add quality flags to a data file in Station Exchange Format version 1.0.0
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_flags(infile, qcfile, outpath, note = "", match = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_flags_+3A_infile">infile</code></td>
<td>
<p>Character string giving the path of the SEF file.</p>
</td></tr>
<tr><td><code id="write_flags_+3A_qcfile">qcfile</code></td>
<td>
<p>Character string giving the path of the file with
the quality flags as produced with the QC tests. 
This file must have 6 (8) tab-separated columns
for daily (sub-daily) data: variable code, year, month, day, (hour),
(minute), value, semicolon(';')-separated failed tests.</p>
</td></tr>
<tr><td><code id="write_flags_+3A_outpath">outpath</code></td>
<td>
<p>Character string giving the output path.</p>
</td></tr>
<tr><td><code id="write_flags_+3A_note">note</code></td>
<td>
<p>Character string to be added to the end of the name of the
input file to form the output filename. 
It will be separated from the rest of the name by an underscore.
Blanks will be also replaced by underscores.
If not specified, input and output filenames will be identical.</p>
</td></tr>
<tr><td><code id="write_flags_+3A_match">match</code></td>
<td>
<p>Write the flags only if the values in the qc file are identical to
those in the SEF file (default to TRUE).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The data will be converted to the standard units adopted by the qc.
An exception is made for cloud cover (oktas will not be converted).
</p>
<p>If <code>match</code> is set to FALSE, the flags will be added to the dates given
in the qc files without checking that the entries in the Value column correspond. 
This can be useful when there have been minor changes to the SEF file 
(for instance, a different rounding) after the quality control was applied, 
but can lead to overflagging when hour and minute values are missing.
</p>


<h3>Author(s)</h3>

<p>Yuri Brugnara
</p>

<hr>
<h2 id='write_sef'>Write data in Station Exchange Format version 1.0.0</h2><span id='topic+write_sef'></span>

<h3>Description</h3>

<p>Write data in Station Exchange Format version 1.0.0
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_sef(
  Data,
  outpath,
  variable,
  cod,
  nam = "",
  lat = "",
  lon = "",
  alt = "",
  sou = "",
  link = "",
  units,
  stat,
  metaHead = "",
  meta = "",
  period = "",
  time_offset = 0,
  note = "",
  keep_na = FALSE,
  outfile = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_sef_+3A_data">Data</code></td>
<td>
<p>A data frame with 6 variables in this order:
year, month, day, hour, minute, value.</p>
</td></tr>
<tr><td><code id="write_sef_+3A_outpath">outpath</code></td>
<td>
<p>Character string giving the output path (note that the
filename is generated from the source identifier, station code, start
and end dates, and variable code).</p>
</td></tr>
<tr><td><code id="write_sef_+3A_variable">variable</code></td>
<td>
<p>Variable code. This is a required field.</p>
</td></tr>
<tr><td><code id="write_sef_+3A_cod">cod</code></td>
<td>
<p>Station code. This is a required field.</p>
</td></tr>
<tr><td><code id="write_sef_+3A_nam">nam</code></td>
<td>
<p>Station name.</p>
</td></tr>
<tr><td><code id="write_sef_+3A_lat">lat</code></td>
<td>
<p>Station latitude (degrees North in decimal).</p>
</td></tr>
<tr><td><code id="write_sef_+3A_lon">lon</code></td>
<td>
<p>Station longitude (degreees East in decimal).</p>
</td></tr>
<tr><td><code id="write_sef_+3A_alt">alt</code></td>
<td>
<p>Station altitude (metres).</p>
</td></tr>
<tr><td><code id="write_sef_+3A_sou">sou</code></td>
<td>
<p>Character string giving the source identifier.</p>
</td></tr>
<tr><td><code id="write_sef_+3A_link">link</code></td>
<td>
<p>Character string giving an url for metadata (e.g., link to the
C3S Data Rescue registry).</p>
</td></tr>
<tr><td><code id="write_sef_+3A_units">units</code></td>
<td>
<p>Character string giving the units. This is a required field.</p>
</td></tr>
<tr><td><code id="write_sef_+3A_stat">stat</code></td>
<td>
<p>Character string giving the statistic code. This is a required
field.</p>
</td></tr>
<tr><td><code id="write_sef_+3A_metahead">metaHead</code></td>
<td>
<p>Character string giving metadata entries for the header
(pipe separated).</p>
</td></tr>
<tr><td><code id="write_sef_+3A_meta">meta</code></td>
<td>
<p>Character vector with length equal to the number of rows
of <code>Data</code>, giving metadata entries for the single observations (pipe
separated).</p>
</td></tr>
<tr><td><code id="write_sef_+3A_period">period</code></td>
<td>
<p>Observation time period code. Must be a character vector with
length equal to the number of rows of <code>Data</code> unless all observations
have the same period code.</p>
</td></tr>
<tr><td><code id="write_sef_+3A_time_offset">time_offset</code></td>
<td>
<p>Numerical vector of offsets from UTC in hours.
This value will be subtracted from the observation times to obtain UTC times,
so for instance the offset of Central European Time is +1 hour.
Recycled for all observations if only one value is given.</p>
</td></tr>
<tr><td><code id="write_sef_+3A_note">note</code></td>
<td>
<p>Character string to be added to the end of the standard output
filename. It will be separated from the rest of the name by an underscore.
Blanks will be also replaced by underscores.</p>
</td></tr>
<tr><td><code id="write_sef_+3A_keep_na">keep_na</code></td>
<td>
<p>If FALSE (the default), lines where observations are NA are
removed.</p>
</td></tr>
<tr><td><code id="write_sef_+3A_outfile">outfile</code></td>
<td>
<p>Output filename. If specified, ignores <code>note</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Times in SEF files must be expressed in UTC.
</p>
<p>If <code>outfile</code> is not specified, the output filename is generated
automatically as <code>sou</code>_<code>cod</code>_startdate_enddate_<code>variable</code>.tsv
</p>


<h3>Author(s)</h3>

<p>Yuri Brugnara
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a basic SEF file for air temperature in Bern
# (assuming the observation times are in mean local solar time)
meta_bern &lt;- Meta$ta[which(Meta$ta$id == "Bern"), ]
write_sef(Bern$ta[, 2:7], outpath = tempdir(), variable = "ta", 
          cod = meta_bern$id, nam = "Bern", lat = meta_bern$lat, 
          lon = meta_bern$lon, alt = meta_bern$alt, 
          units = meta_bern$units, stat = "point", period = "0", 
          time_offset = meta_bern$lon * 24 / 360)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
