<!DOCTYPE html><html lang="en"><head><title>Help for package nonsmooth</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nonsmooth}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#nonsmooth'><p>Nonparametric methods for smoothing nonsmooth data</p></a></li>
<li><a href='#alc'><p>Iterative anisotropic local constant smoothing</p></a></li>
<li><a href='#changepoint.sim1D'>
<p>Simulated change-point data for one-dimension</p></a></li>
<li><a href='#changepoint.sim2D'>
<p>Simulated change-point data for two-dimensions</p></a></li>
<li><a href='#fireData'><p>Wax paper fire smouldering experiment conducted in a fume hood</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Nonparametric Methods for Smoothing Nonsmooth Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, np, graphics, reshape2</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>John R.J. Thompson &lt;john.thompson@ubc.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Nonparametric methods for smoothing regression function data with change-points, utilizing range kernels for iterative and anisotropic smoothing methods. For further details, see the paper by John R.J. Thompson (2024) &lt;<a href="https://doi.org/10.1080%2F02664763.2024.2352759">doi:10.1080/02664763.2024.2352759</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jrjthompson/R-package-nonsmooth/">https://github.com/jrjthompson/R-package-nonsmooth/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jrjthompson/R-package-nonsmooth/issues">https://github.com/jrjthompson/R-package-nonsmooth/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-02 22:10:34 UTC; jthomp14</td>
</tr>
<tr>
<td>Author:</td>
<td>John R.J. Thompson
    <a href="https://orcid.org/0000-0002-6303-449X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-03 16:00:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='nonsmooth'>Nonparametric methods for smoothing nonsmooth data</h2><span id='topic+nonsmooth'></span><span id='topic+nonsmooth-package'></span>

<h3>Description</h3>

<p>This package provides nonparametric methods for smoothing nonsmooth data.
Change-point data is the intended application, with a focus on those with
jumps in the regression function. Descriptions of the implementation of these
methods can be found in Thompson, J.R.J. (2024).
</p>


<h3>Details</h3>

<p>This package contains two additional functions for simulated one-D and two-D
change-point data. This package also contains a real fire spread dataset from
a micro-fire experiment. This data can be viewed as time dependent
two-dimensional change-point data. The boundaries between fuel, burning and
burn-out regions are seperated by two change-point curves. More information
on experimentation and data can befound in Thompson, Wang, and Braun (2020)
and Wang, Thompson, and Braun (2019).
</p>


<h3>Author(s)</h3>

<p>John R.J. Thompson &lt;john.thompson@ubc.ca&gt;
</p>
<p>Maintainer: John R.J. Thompson &lt;john.thompson@ubc.ca&gt;
</p>
<p>I would like to acknowledge funding support from the University of British
Columbia Aspire Fund (UBC:www.ok.ubc.ca/).
</p>


<h3>References</h3>

<p>Thompson, J.R.J. (2024) &ldquo;Iterative Smoothing for Change-point Regression Function Estimation&rdquo;, <em>Journal of Applied Statistics</em>, 1-25. &lt;doi:10.1080/02664763.2024.2352759&gt;
</p>
<p>Thompson, J.R.J., Wang, X.J., &amp; Braun, W.J. (2020) &ldquo;A mouse model for studying fire spread rates using experimental micro-fires&rdquo;, <em>Journal of Environmental Statistics</em>, 9(1), 1-19. &lt;[https://www.jenvstat.org/v09/i06]https://www.jenvstat.org/v09/i06&gt;
</p>
<p>Wang, X.J., Thompson, J.R.J., Braun, W.J., &amp; Woolford, D.G. (2019) &ldquo;Fitting a stochastic fire spread model to data.&rdquo; <em>Advances in Statistical Climatology, Meteorology and Oceanography</em>, 5(1), 57-66. &lt;[https://ascmo.copernicus.org/articles/5/57/2019/]https://ascmo.copernicus.org/articles/5/57/2019/&gt;
</p>

<hr>
<h2 id='alc'>Iterative anisotropic local constant smoothing
</h2><span id='topic+alc'></span>

<h3>Description</h3>

<p>This function implements the method in Thompson, J.R.J. (2024) for iterative smoothing
of change-point data that utilizes oversmoothed estimates of the underlying data
generating process to inform re-smoothing. The function calculates a local constant
estimator <code class="reqn">\tilde{g}(X)</code> of <code class="reqn">Y=g(X)+\epsilon</code>, and then utilizes <code class="reqn">\tilde{g}(x)</code>
in the range kernel of another local constant estimator. This process is iterated
for a specified number of resmooth iterations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alc(X,Y,bw.fixed.value=NULL,resmooths=1,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="alc_+3A_x">X</code></td>
<td>

<p>numeric matrix of <code class="reqn">p</code> columns of the observations for continuous explanatory variables.
</p>
</td></tr>
<tr><td><code id="alc_+3A_y">Y</code></td>
<td>

<p>numeric vector of the continuous response variable.
</p>
</td></tr>
<tr><td><code id="alc_+3A_bw.fixed.value">bw.fixed.value</code></td>
<td>

<p>numeric value for the bandwidth of the range kernel. Setting this value sets the
iterative smoothing bandwidths to be the local constant estimator bandwidths for
domain kernels and the set value for the range kernel. Default is <code>NULL</code>, which
isan optimal bandwidth selection procedure during each re-smooth through the
<code>npreg</code> function.
</p>
</td></tr>
<tr><td><code id="alc_+3A_resmooths">resmooths</code></td>
<td>

<p>integer number of resmooth iterations. Default is 1 resmooth, which is a suggested starting point
for iterative smoothing.
</p>
</td></tr>
<tr><td><code id="alc_+3A_...">...</code></td>
<td>

<p>additional specifications for <code>np</code> smoothing, such as optimal bandwidth selection
procedure, kernel type,  regression estimator, and so on. See <code>npreg</code> function for
more details and defaults.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The code here returns a <code>npregression</code> object of the iteratively smoothed estimator.
For more details, see the <code>npreg</code> function in the <code>np</code> package.
</p>


<h3>References</h3>

<p>Thompson, J.R.J. (2024) &ldquo;Iterative Smoothing for Change-point Regression Function Estimation&rdquo;, <em>Journal of Applied Statistics</em>, 1-25. &lt;doi:10.1080/02664763.2024.2352759&gt;
</p>


<h3>See Also</h3>

<p><code><a href="np.html#topic+npreg">npreg</a></code>, <code><a href="np.html#topic+npregbw">npregbw</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(np)
options(np.messages=FALSE)

## 1D Simulated change-point data
changepoint.data &lt;- changepoint.sim1D(500)

## Isotropic local constant model
bw.lc &lt;- npregbw(Y~X,data=changepoint.data)
model.lc &lt;- npreg(bw.lc)

## Anisotropic local constant model with one resmooth iteration
model.alc &lt;- alc(changepoint.data$X,changepoint.data$Y)

## Plot isotropic and anistropic smoothers
plot(changepoint.data$X,changepoint.data$Y,xlab = "X",ylab = "Y",
     pch=1,col="grey",las=1)
lines(changepoint.data$X,model.lc$mean,col="blue",lty=1)
lines(changepoint.data$X,model.alc$mean,col="red",lty=1)

## 2D Simulated image change-point data
## This simulation and estimation can take up to 5 minutes
library(reshape2)
changepoint.data &lt;- changepoint.sim2D(data.dim=c(50,50))
image(changepoint.data)

## Melt the 2D image data for model estimation
changepoint.data.melt &lt;- melt(id.var=1:nrow(changepoint.data), changepoint.data)

## Isotropic local constant model
bw.lc &lt;- npregbw(xdat=changepoint.data.melt[,1:2],ydat=changepoint.data.melt[,3])
model.lc &lt;- npreg(bw.lc)

image(1:dim(changepoint.data)[1], 1:dim(changepoint.data)[2],
      matrix(model.lc$mean, nrow=dim(changepoint.data)[1], byrow=FALSE))

## Anisotropic local constant model with one resmooth iteration and
## and fixed range kernel bandwidth
model.alc &lt;- alc(changepoint.data.melt[,1:2],changepoint.data.melt[,3],bw.fixed.value=10)

image(1:dim(changepoint.data)[1], 1:dim(changepoint.data)[2],
      matrix(model.alc$mean, nrow=dim(changepoint.data)[1], byrow=FALSE))

## 2D real fire spread change-point data
  data("fireData")
  changepoint.data &lt;- fireData[,,1,20]

  ## Plot with pixel locations
  image(1:dim(changepoint.data)[1], 1:dim(changepoint.data)[2],
      matrix(changepoint.data, nrow=dim(changepoint.data)[1], byrow=FALSE))

  ## Melt the 2D image data for model estimation
  changepoint.data.melt &lt;- melt(id.var=1:nrow(changepoint.data), changepoint.data)

  ## Isotropic local constant model
  bw.lc &lt;- npregbw(xdat=changepoint.data.melt[,1:2],ydat=changepoint.data.melt[,3])
  model.lc &lt;- npreg(bw.lc)

  image(1:dim(changepoint.data)[1], 1:dim(changepoint.data)[2],
      matrix(model.lc$mean, nrow=dim(changepoint.data)[1], byrow=FALSE))

  ## Anisotropic local constant model with one resmooth iteration and
  ## and fixed range kernel bandwidth
  model.alc &lt;- alc(changepoint.data.melt[,1:2],changepoint.data.melt[,3],bw.fixed.value=10)

  image(1:dim(changepoint.data)[1], 1:dim(changepoint.data)[2],
      matrix(model.alc$mean, nrow=dim(changepoint.data)[1], byrow=FALSE))
  
options(np.messages=TRUE)
</code></pre>

<hr>
<h2 id='changepoint.sim1D'>
Simulated change-point data for one-dimension
</h2><span id='topic+changepoint.sim1D'></span>

<h3>Description</h3>

<p>This function simulates one-dimension change-point data for three data types,
and one smooth data type for testing change-point regression estimators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>changepoint.sim1D(n,sigma=1,data.type = "continuousWithJump")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="changepoint.sim1D_+3A_n">n</code></td>
<td>
<p>Integer value for sample size.</p>
</td></tr>
<tr><td><code id="changepoint.sim1D_+3A_sigma">sigma</code></td>
<td>
<p>Numeric value of standard deviation.</p>
</td></tr>
<tr><td><code id="changepoint.sim1D_+3A_data.type">data.type</code></td>
<td>
<p>Character value for different data types. The options for
change-point data are: constant functions seperated by two jumps
(<code>"uniformJump"</code>), linear functions seperated by two change-points in
the first derivative (<code>"gradualJump"</code>), and nonlinear data with a jump
(<code>"continuousWithJump"</code>). A smooth continuous function with no
change-points (<code>"continuous"</code>) is the same functions as
<code>"continuousWithJump"</code> but without the change-point. See Thompson,
J.R.J. (2024) for more details on these data types.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function produces a data.frame, consisting of the simulated data
and the data generating process.
</p>
<table role = "presentation">
<tr><td><code>X</code></td>
<td>
<p>Numeric vector of explanatory data</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>Numeric vector of response data</p>
</td></tr>
<tr><td><code>oracle</code></td>
<td>
<p>Numeric vector of the data generating process for <code>Y</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Thompson, J.R.J. (2024) &ldquo;Iterative Smoothing for Change-point Regression Function Estimation&rdquo;, <em>Journal of Applied Statistics</em>, 1-25. &lt;doi:10.1080/02664763.2024.2352759&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## 1D continuous data of nonlinear functions with a jump change-point
changepoint.data &lt;- changepoint.sim1D(100)
plot(changepoint.data$X,changepoint.data$Y,xlab = "X",ylab = "Y",pch=1,col="grey",las=1)
lines(changepoint.data$X,changepoint.data$oracle,col="red",lty=1)

## 1D continuous data of constant functions with two jump change-points
changepoint.data &lt;- changepoint.sim1D(100,data.type="uniformJump")
plot(changepoint.data$X,changepoint.data$Y,xlab = "X",ylab = "Y",pch=1,col="grey",las=1)
lines(changepoint.data$X,changepoint.data$oracle,col="red",lty=1)

## 1D continuous data of linear functions with two derivative change-points
changepoint.data &lt;- changepoint.sim1D(100,data.type="gradualJump")
plot(changepoint.data$X,changepoint.data$Y,xlab = "X",ylab = "Y",pch=1,col="grey",las=1)
lines(changepoint.data$X,changepoint.data$oracle,col="red",lty=1)

## 1D continuous data of a nonlinear continuous function
changepoint.data &lt;- changepoint.sim1D(100,data.type="continuous")
plot(changepoint.data$X,changepoint.data$Y,xlab = "X",ylab = "Y",pch=1,col="grey",las=1)
lines(changepoint.data$X,changepoint.data$oracle,col="red",lty=1)
</code></pre>

<hr>
<h2 id='changepoint.sim2D'>
Simulated change-point data for two-dimensions
</h2><span id='topic+changepoint.sim2D'></span>

<h3>Description</h3>

<p>This function simulates circular change-point data with Gaussian noise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>changepoint.sim2D(data.dim = c(100,100),sigma = 20,radius=NULL,cbase=80,ctop=130)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="changepoint.sim2D_+3A_data.dim">data.dim</code></td>
<td>

<p>Vector of two integers for the size of the two-dimensional dataset. The dimensions
are suggested to be the same. However, for uneven dimensions, the first value must
be larger. The default is an image of 100 by 100 pixels.</p>
</td></tr>
<tr><td><code id="changepoint.sim2D_+3A_sigma">sigma</code></td>
<td>

<p>Numeric value of standard deviation.
</p>
</td></tr>
<tr><td><code id="changepoint.sim2D_+3A_radius">radius</code></td>
<td>

<p>Numeric value of the radius of the inner disk before the change-point. The radius cannot be larger than one-half of either dimension in <code>data.dim</code>. Defaults to one-quarter of the first dimension of <code>data.dim</code>.
</p>
</td></tr>
<tr><td><code id="changepoint.sim2D_+3A_cbase">cbase</code></td>
<td>

<p>Numeric value for the disk that radiates out from the approximate center of the dataset.
</p>
</td></tr>
<tr><td><code id="changepoint.sim2D_+3A_ctop">ctop</code></td>
<td>

<p>Numeric value after the circular change-point, seperating the disk and the outer region.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function produces a matrix of integer values of the same dimensions as <code>data.dim</code>.
</p>


<h3>References</h3>

<p>Thompson, J.R.J. (2024) &ldquo;Iterative Smoothing for Change-point Regression Function Estimation&rdquo;, <em>Journal of Applied Statistics</em>, 1-25. &lt;doi:10.1080/02664763.2024.2352759&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simulate 2D data and plot it
library(reshape2)
changepoint.data &lt;- changepoint.sim2D()
image(1:nrow(changepoint.data), 1:ncol(changepoint.data),
      matrix(changepoint.data, nrow=nrow(changepoint.data), byrow=FALSE))
</code></pre>

<hr>
<h2 id='fireData'>Wax paper fire smouldering experiment conducted in a fume hood</h2><span id='topic+fireData'></span>

<h3>Description</h3>

<p>The fire spread data consists of 45 segmented RGB images from a fire
smouldering experiment of wax paper. The data were measured using
a digital camera at a birds-eye view above the experiment. The data
is segmented 1 frame per second.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("fireData")</code></pre>


<h3>Format</h3>

<p>The movie of the fire spread is a data frame with four dimensions. The
first and second dimensions of the data frame are the pixel coordinates
of one image. The third dimension is the RGB channel, with the red channel
(1), blue channel (2), and green channel (3). The fourth dimension is time,
starting at ignition (time point 1), and then each RGB image is separated by
one second for a total of 45 seconds.
</p>


<h3>Source</h3>

<p>John R.J. Thompson</p>


<h3>References</h3>

<p>Thompson, J.R.J., Wang, X.J., &amp; Braun, W.J. (2020) &ldquo;A mouse
model for studying fire spread rates using experimental micro-fires&rdquo;,
<em>Journal of Environmental Statistics</em>, 9(1), 1-19.
&lt;[https://www.jenvstat.org/v09/i06]https://www.jenvstat.org/v09/i06&gt;
</p>
<p>Wang, X.J., Thompson, J.R.J., Braun, W.J., &amp; Woolford, D.G. (2019)
&ldquo;Fitting a stochastic fire spread model to data.&rdquo;
<em>Advances in Statistical Climatology, Meteorology and
Oceanography</em>, 5(1), 57-66.
&lt;[https://ascmo.copernicus.org/articles/5/57/2019/]https://ascmo.copernicus.org/articles/5/57/2019/&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example - viewing a fire spread experiment that contains change-points

data("fireData")

## Plot the red channel at 10 seconds as a 2d image

image(1:dim(fireData)[1], 1:dim(fireData)[2],
      matrix(fireData[,,1,10], nrow=dim(fireData)[1], byrow=FALSE))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
