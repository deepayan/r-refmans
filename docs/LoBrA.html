<!DOCTYPE html><html lang="en"><head><title>Help for package LoBrA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LoBrA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as.LOBdataset'><p>Transformation of a single longitudinal data matrix into 'LoBrA' Data Object.</p></a></li>
<li><a href='#components'><p>'LoBrA'  Data Object (LDO) for Example data set</p></a></li>
<li><a href='#createBGComponents'><p>Simulate background noise peaks</p></a></li>
<li><a href='#createBGData'><p>Simulate background measurements</p></a></li>
<li><a href='#createExampleData'><p>Create example data set for 'LoBrA'</p></a></li>
<li><a href='#createGoudermanData'><p>Create the Gouderman Data Arrangement.</p></a></li>
<li><a href='#createInformativeComponents'><p>Simulate informative peaks</p></a></li>
<li><a href='#GaudermanLDO-class'><p>An S4 class to represent a 'Gouderman' LDO object, that was generated by the generalized gauderman algorithm.</p></a></li>
<li><a href='#GaudermanModelEvaluation-class'><p>An S4 class to represent the result of the linear mixed effect modeling on a gauderman LDO.</p></a></li>
<li><a href='#getColor'><p>Get colors for the plotting function.</p></a></li>
<li><a href='#getGeneralizedGaudermanDataFrame'><p>Create Peak Matrices for Generalized 'Gauderman' linear mixed effect regression (LMER) Model with parameterized Times</p></a></li>
<li><a href='#getOptimalSpline'><p>Extract the optimal spline model parameters from the ModelSelection Object.</p></a></li>
<li><a href='#getPvalue'><p>Testing differences of groups with respect to a specific value and test.</p></a></li>
<li><a href='#ldo'><p>'LoBrA'  Data Object (LDO) for Example data set</p></a></li>
<li><a href='#LDO-class'><p>An S4 class to represent a 'LoBrA' Data Object (LDO). It stores multiple time series data for muliple experiements and multiple Components. It allows repeated measurements of a component, irregular sampling, and unequal temporal spacing of the time points.</p></a></li>
<li><a href='#LDOmodelselection-class'><p>An S4 class to represent a model selection result based on an 'LDO'.</p></a></li>
<li><a href='#LDOscreening-class'><p>An S4 class to represent the screening of metabolites in an 'LDO'.</p></a></li>
<li><a href='#LoBrA'><p>LoBrA: A package for modeling longitudinal breath data</p></a></li>
<li><a href='#lobraModelSelection'><p>Evaluation of different spline variants.</p></a></li>
<li><a href='#longDataExample'><p>'LoBrA'  Example Data Set</p></a></li>
<li><a href='#modelGoudermanLongitudinal'><p>Fitting the Gouderman LME Model with using Gouderman-Data Arrangement.</p></a></li>
<li><a href='#plotGaudermanModel'><p>Plotting helper function to plot a single generalized gouderman Model</p></a></li>
<li><a href='#plotGoudermanLongitudinalResults'><p>Plotting the 'Gouderman' LME Model and Results.</p></a></li>
<li><a href='#plotLDOScreening'><p>Plotting the screening results.</p></a></li>
<li><a href='#plotmodelSelectionEvaluation'><p>Plotting results of Model Evaluation and Selection.</p></a></li>
<li><a href='#plotTimeSeries'><p>Plotting function for a longitudinal data matrix (Internal Function)</p></a></li>
<li><a href='#powerSet'><p>Creating the power set of a set.</p></a></li>
<li><a href='#screening'><p>Screening of background or confounding components</p></a></li>
<li><a href='#selectComponents'><p>Create a new 'LDO' Object that only contains the selected components.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generalized Spline Mixed Effect Models for Longitudinal Breath
Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-03-07</td>
</tr>
<tr>
<td>Description:</td>
<td>Automated analysis and modeling of longitudinal 'omics' data (e.g. breath 'metabolomics') using generalized spline mixed effect models. Including automated filtering of noise parameters and determination of breakpoints.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, lawstat, nlme, graphics, RColorBrewer, stats, base,
grDevices, qpdf</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-15 21:43:06 UTC; gittakirana</td>
</tr>
<tr>
<td>Author:</td>
<td>Anne-Christin Hauschild
    <a href="https://orcid.org/0000-0002-7499-4373"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Sandy P. Eckel [ths, com],
  Jan Baumbach [ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Anne-Christin Hauschild &lt;achauschild@googlemail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-21 18:40:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='as.LOBdataset'>Transformation of a single longitudinal data matrix into 'LoBrA' Data Object.</h2><span id='topic+as.LOBdataset'></span>

<h3>Description</h3>

<p>Real signals and background noise originating from experimental settings or random events
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.LOBdataset(
  longData,
  name = "",
  id = "id",
  time = "time",
  type = "type",
  class = "class",
  bg = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.LOBdataset_+3A_longdata">longData</code></td>
<td>
<p>Matrix of longitudinal data containing all components</p>
</td></tr>
<tr><td><code id="as.LOBdataset_+3A_name">name</code></td>
<td>
<p>name of the dataset</p>
</td></tr>
<tr><td><code id="as.LOBdataset_+3A_id">id</code></td>
<td>
<p>name to identify the experiment id column</p>
</td></tr>
<tr><td><code id="as.LOBdataset_+3A_time">time</code></td>
<td>
<p>name to identify the time column</p>
</td></tr>
<tr><td><code id="as.LOBdataset_+3A_type">type</code></td>
<td>
<p>name to identify the type column</p>
</td></tr>
<tr><td><code id="as.LOBdataset_+3A_class">class</code></td>
<td>
<p>name to identify the class column</p>
</td></tr>
<tr><td><code id="as.LOBdataset_+3A_bg">bg</code></td>
<td>
<p>indicates whether the data table contains background data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>'LoBrA' data object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 
  data(LoBraExample)
  name="Longitudinal Test Dataset"
  ldo&lt;-as.LOBdataset(longDataExample, name, bg=TRUE)
  
</code></pre>

<hr>
<h2 id='components'>'LoBrA'  Data Object (LDO) for Example data set</h2><span id='topic+components'></span>

<h3>Description</h3>

<p>'LoBrA'  example LDO created by the function 'createExampleData' and converted to an LDO by 'as.LOBdataset' function.
It consist of a single matrix for all experiments, time points, types (background, experiment), class and the intensity values of all components created.
The artificial data consist of 20 experiments and 100 components with 18 measurements (3 background, 15 sample). The 10 experiments are each associated to on of 2 groups (ONE and TWO). The components comprise 70 noise components and 30 components that randomly vary in their trajectories in one of three segments. Random noise is added to all intercepts, propagated and added to each time point for all samples and components separately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>components
</code></pre>


<h3>Format</h3>

<p>A vector of selected components from the longitudinal example data set.
</p>


<h3>Author(s)</h3>

<p>Anne-Christin Hauschild <a href="mailto:hauschild@uni-marburg.de">hauschild@uni-marburg.de</a>
</p>

<hr>
<h2 id='createBGComponents'>Simulate background noise peaks</h2><span id='topic+createBGComponents'></span>

<h3>Description</h3>

<p>Simulating background noise signals originating from experimental settings or random events
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createBGComponents(
  components,
  samples,
  labels,
  timepoints = 15,
  bg = 3,
  mean = 5,
  sd = 3,
  experimentSD = 2,
  randomnoise = 0.1,
  plotting = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createBGComponents_+3A_components">components</code></td>
<td>
<p>number of background components to be created</p>
</td></tr>
<tr><td><code id="createBGComponents_+3A_samples">samples</code></td>
<td>
<p>number of experiments</p>
</td></tr>
<tr><td><code id="createBGComponents_+3A_labels">labels</code></td>
<td>
<p>name of each experiment</p>
</td></tr>
<tr><td><code id="createBGComponents_+3A_timepoints">timepoints</code></td>
<td>
<p>number of sample measurements</p>
</td></tr>
<tr><td><code id="createBGComponents_+3A_bg">bg</code></td>
<td>
<p>number of background measurements</p>
</td></tr>
<tr><td><code id="createBGComponents_+3A_mean">mean</code></td>
<td>
<p>mean value of noise components</p>
</td></tr>
<tr><td><code id="createBGComponents_+3A_sd">sd</code></td>
<td>
<p>standard deviation value of noise for this component</p>
</td></tr>
<tr><td><code id="createBGComponents_+3A_experimentsd">experimentSD</code></td>
<td>
<p>standard deviation value of each experiment for this component</p>
</td></tr>
<tr><td><code id="createBGComponents_+3A_randomnoise">randomnoise</code></td>
<td>
<p>random variation changing at each time point</p>
</td></tr>
<tr><td><code id="createBGComponents_+3A_plotting">plotting</code></td>
<td>
<p>Indicator whether the component will be plotted (TRUE) or not (FALSE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of background components
</p>

<hr>
<h2 id='createBGData'>Simulate background measurements</h2><span id='topic+createBGData'></span>

<h3>Description</h3>

<p>Simulating background noise signals originating from experimental settings or random events
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createBGData(samples = 10, bg = 3, mean = 0, sd = 1, randomnoise = 0.1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createBGData_+3A_samples">samples</code></td>
<td>
<p>number of experiments</p>
</td></tr>
<tr><td><code id="createBGData_+3A_bg">bg</code></td>
<td>
<p>number of background measurements</p>
</td></tr>
<tr><td><code id="createBGData_+3A_mean">mean</code></td>
<td>
<p>mean value of noise for this component</p>
</td></tr>
<tr><td><code id="createBGData_+3A_sd">sd</code></td>
<td>
<p>standard deviation value of noise for this component</p>
</td></tr>
<tr><td><code id="createBGData_+3A_randomnoise">randomnoise</code></td>
<td>
<p>random variation changing at each time point</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of background measurements
</p>

<hr>
<h2 id='createExampleData'>Create example data set for 'LoBrA'</h2><span id='topic+createExampleData'></span>

<h3>Description</h3>

<p>Real signals and background noise originating from experimental settings or random events
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createExampleData(
  components = c(70, 10, 10, 10),
  samples = 10,
  classes = 2,
  bg = 3,
  timepoints = rep(5, 3),
  myfile = NA
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createExampleData_+3A_components">components</code></td>
<td>
<p>vector numbers of background and informative components to be created.</p>
</td></tr>
<tr><td><code id="createExampleData_+3A_samples">samples</code></td>
<td>
<p>number of experiments per class</p>
</td></tr>
<tr><td><code id="createExampleData_+3A_classes">classes</code></td>
<td>
<p>number of classes</p>
</td></tr>
<tr><td><code id="createExampleData_+3A_bg">bg</code></td>
<td>
<p>number of background measurements</p>
</td></tr>
<tr><td><code id="createExampleData_+3A_timepoints">timepoints</code></td>
<td>
<p>number of sample measurements for each spline</p>
</td></tr>
<tr><td><code id="createExampleData_+3A_myfile">myfile</code></td>
<td>
<p>filename of the pdf file created. Note: '.pdf' is added automatically.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>final matrix of example data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 
  components = c(21,3,3,3)
  samples = 10
  classes = 2;
  bg = 3; 
  timepoints = rep(5,3)
  p=TRUE;
  longDataExample &lt;- createExampleData(components, samples, classes, bg, 
                                       timepoints)
  dim(longDataExample)
  

</code></pre>

<hr>
<h2 id='createGoudermanData'>Create the Gouderman Data Arrangement.</h2><span id='topic+createGoudermanData'></span>

<h3>Description</h3>

<p>Using the Gouderman methodology to create the Gouderman-Data Arrangement.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createGoudermanData(selectedLDO, breaks, center, timeperiod = NA, range = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createGoudermanData_+3A_selectedldo">selectedLDO</code></td>
<td>
<p>Longitudinal Data Object, containing all selected metabolites to be used for the final Gouderman model.</p>
</td></tr>
<tr><td><code id="createGoudermanData_+3A_breaks">breaks</code></td>
<td>
<p>break points for the spline model</p>
</td></tr>
<tr><td><code id="createGoudermanData_+3A_center">center</code></td>
<td>
<p>Time point that corresponds to the center time t0. The algorithm will test whether there is a significant difference between the groups at this point.</p>
</td></tr>
<tr><td><code id="createGoudermanData_+3A_timeperiod">timeperiod</code></td>
<td>
<p>If the user defines the time period or segment, in the spline to be tested. Note, a 3 break point spline has 4 segments.</p>
</td></tr>
<tr><td><code id="createGoudermanData_+3A_range">range</code></td>
<td>
<p>If the user defines a range, the algorithm will test whether there is a significant difference between the groups in this range.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a 'GaudermanLDO' object. For more information @seealso 'GaudermanLDO' .
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 
  data(LoBraExample)
  selectedLDO &lt;- selectComponents(ldo, components)
  breaks&lt;- c(8, 12)
  center&lt;- 12
  timeperiod &lt;- 2;
  gaudermanLDOexample &lt;- createGoudermanData(selectedLDO, breaks, center, timeperiod)
  
</code></pre>

<hr>
<h2 id='createInformativeComponents'>Simulate informative peaks</h2><span id='topic+createInformativeComponents'></span>

<h3>Description</h3>

<p>This function simulates signals correlated to different informative events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createInformativeComponents(
  components,
  samples,
  labels,
  timepoints = c(5, 5, 5),
  bg = 3,
  mean = 5,
  sd = 3,
  segment = 1,
  slopeSD = 2,
  randomnoise = 0.5,
  plotting = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createInformativeComponents_+3A_components">components</code></td>
<td>
<p>number of background components to be created</p>
</td></tr>
<tr><td><code id="createInformativeComponents_+3A_samples">samples</code></td>
<td>
<p>number of experiments</p>
</td></tr>
<tr><td><code id="createInformativeComponents_+3A_labels">labels</code></td>
<td>
<p>label of each experiment</p>
</td></tr>
<tr><td><code id="createInformativeComponents_+3A_timepoints">timepoints</code></td>
<td>
<p>number of sample measurements</p>
</td></tr>
<tr><td><code id="createInformativeComponents_+3A_bg">bg</code></td>
<td>
<p>number of background measurements</p>
</td></tr>
<tr><td><code id="createInformativeComponents_+3A_mean">mean</code></td>
<td>
<p>mean value of noise for the intercept of this components</p>
</td></tr>
<tr><td><code id="createInformativeComponents_+3A_sd">sd</code></td>
<td>
<p>standard deviation value of noise for the intercept of this component</p>
</td></tr>
<tr><td><code id="createInformativeComponents_+3A_segment">segment</code></td>
<td>
<p>indicating the segment, that will have an informative event (changing slope for one class)</p>
</td></tr>
<tr><td><code id="createInformativeComponents_+3A_slopesd">slopeSD</code></td>
<td>
<p>standard deviation value for the generated slope of for this component (mean is zero, therefore, the slope can be either negative or positive)</p>
</td></tr>
<tr><td><code id="createInformativeComponents_+3A_randomnoise">randomnoise</code></td>
<td>
<p>random variation changing at each time point</p>
</td></tr>
<tr><td><code id="createInformativeComponents_+3A_plotting">plotting</code></td>
<td>
<p>logical value, (default is FALSE), if TRUE the function will plot the created time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of informative components
</p>

<hr>
<h2 id='GaudermanLDO-class'>An S4 class to represent a 'Gouderman' LDO object, that was generated by the generalized gauderman algorithm.</h2><span id='topic+GaudermanLDO-class'></span><span id='topic+GaudermanLDO'></span>

<h3>Description</h3>

<p>An S4 class to represent a 'Gouderman' LDO object, that was generated by the generalized gauderman algorithm.
</p>


<h3>Slots</h3>


<dl>
<dt><code>name</code></dt><dd><p>character Name of the new 'generalized-Gauderman' adjusted longitudinal data</p>
</dd>
<dt><code>dataFrames</code></dt><dd><p>list List of 'generalized-Gauderman' modified data. One <code>data.frame</code> for each component.</p>
</dd>
<dt><code>peaknames</code></dt><dd><p>character Vector of component names contained in this object.</p>
</dd>
<dt><code>k</code></dt><dd><p>numeric Updated times for the breaks of the spline model.</p>
</dd>
<dt><code>times</code></dt><dd><p>matrix Vector of updated time values.</p>
</dd>
<dt><code>newTimeVars</code></dt><dd><p>character The names of the newly defined time variables of the generalized 'Gauderman' model.</p>
</dd>
<dt><code>ids</code></dt><dd><p>character Vector of identifiers for the experiments</p>
</dd>
<dt><code>labels</code></dt><dd><p>factor Vector of class labels for each experiment</p>
</dd>
</dl>

<hr>
<h2 id='GaudermanModelEvaluation-class'>An S4 class to represent the result of the linear mixed effect modeling on a gauderman LDO.</h2><span id='topic+GaudermanModelEvaluation-class'></span><span id='topic+GaudermanModelEvaluation'></span>

<h3>Description</h3>

<p>An S4 class to represent the result of the linear mixed effect modeling on a gauderman LDO.
</p>


<h3>Slots</h3>


<dl>
<dt><code>name</code></dt><dd><p>character Name of the new 'generalized-Gauderman' adjusted longitudinal model.</p>
</dd>
<dt><code>gaudermanLDO</code></dt><dd><p>GaudermanLDO 'Generalized-Gauderman' adjusted longitudinal data object.</p>
</dd>
<dt><code>models</code></dt><dd><p>list List of models generated for each component.</p>
</dd>
<dt><code>labels</code></dt><dd><p>factor Vector of class labels for each experiment</p>
</dd>
<dt><code>pvalues</code></dt><dd><p>matrix Matrix of p-values for the intercept as well as all slops of the spline model for each component.</p>
</dd>
<dt><code>correctedpvalues</code></dt><dd><p>matrix Matrix of corrected p-values for the intercept as well as all slops of the spline model for each component.</p>
</dd>
<dt><code>modelparameter</code></dt><dd><p>matrix Model parameter for each component.</p>
</dd>
</dl>

<hr>
<h2 id='getColor'>Get colors for the plotting function.</h2><span id='topic+getColor'></span>

<h3>Description</h3>

<p>Get colors for the plotting function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getColor(label, size)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getColor_+3A_label">label</code></td>
<td>
<p>class labels of the samples</p>
</td></tr>
<tr><td><code id="getColor_+3A_size">size</code></td>
<td>
<p>size of the color vector to be created</p>
</td></tr>
</table>


<h3>Value</h3>

<p>col vector of colors created
</p>

<hr>
<h2 id='getGeneralizedGaudermanDataFrame'>Create Peak Matrices for Generalized 'Gauderman' linear mixed effect regression (LMER) Model with parameterized Times</h2><span id='topic+getGeneralizedGaudermanDataFrame'></span>

<h3>Description</h3>

<p>Create Peak Matrices for Generalized 'Gauderman' linear mixed effect regression (LMER) Model with parameterized Times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getGeneralizedGaudermanDataFrame(
  peakmatrix,
  sampleIds,
  classes,
  center,
  timeperiod,
  gaudermanRange,
  k
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getGeneralizedGaudermanDataFrame_+3A_peakmatrix">peakmatrix</code></td>
<td>
<p>Peak matrix to be converted.</p>
</td></tr>
<tr><td><code id="getGeneralizedGaudermanDataFrame_+3A_sampleids">sampleIds</code></td>
<td>
<p>Ids of samples in the matrix</p>
</td></tr>
<tr><td><code id="getGeneralizedGaudermanDataFrame_+3A_classes">classes</code></td>
<td>
<p>Classes of samples</p>
</td></tr>
<tr><td><code id="getGeneralizedGaudermanDataFrame_+3A_center">center</code></td>
<td>
<p>Time point that corresponds to the center time t0. The algorithm will test whether there is a significant difference between the groups at this point.</p>
</td></tr>
<tr><td><code id="getGeneralizedGaudermanDataFrame_+3A_timeperiod">timeperiod</code></td>
<td>
<p>defines the time period or segment, in the spline to be tested. Note, a 3 break point spline has 4 segments.</p>
</td></tr>
<tr><td><code id="getGeneralizedGaudermanDataFrame_+3A_gaudermanrange">gaudermanRange</code></td>
<td>
<p>range to be tested for a significant difference between the groups.</p>
</td></tr>
<tr><td><code id="getGeneralizedGaudermanDataFrame_+3A_k">k</code></td>
<td>
<p>break points for the generalized 'Gauderman' spline model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return the new peak matrix data frame for this peak.
</p>

<hr>
<h2 id='getOptimalSpline'>Extract the optimal spline model parameters from the ModelSelection Object.</h2><span id='topic+getOptimalSpline'></span>

<h3>Description</h3>

<p>The method calculates which spline model and parameters worked best with respect to the median of the specified quality measure. The median is calculated among all component models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getOptimalSpline(
  lobraModelSelectionObject,
  qualityMeasure = "AIC",
  summeryfun = stats::median
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getOptimalSpline_+3A_lobramodelselectionobject">lobraModelSelectionObject</code></td>
<td>
<p>LDOmodelselection created by the 'lobraModelSelection' function. It stores all evaluated Spline models to chose from.</p>
</td></tr>
<tr><td><code id="getOptimalSpline_+3A_qualitymeasure">qualityMeasure</code></td>
<td>
<p>Quality measure to be used to select the optimal spline.</p>
</td></tr>
<tr><td><code id="getOptimalSpline_+3A_summeryfun">summeryfun</code></td>
<td>
<p>Define the Summery function to be used. Default value is set to stats::median. Other possible functions would be mean, for instance.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a 'lobraModelSelectionObject' that contains the optimal model according to the specified quality measure. @seealso plot.modelSelectionEvaluation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 
  data(LoBraExample)
  selectedLDO &lt;- selectComponents(ldo, components)
  potentialBreaks=c(8, 12)
  nknots=c(1, 2)
  qualityMeasure=c("AIC", "BIC")
  ldoSelect&lt;- lobraModelSelection(selectedLDO, potentialBreaks, nknots, qualityMeasure)
  
  optimalAIC&lt;-getOptimalSpline(ldoSelect, qualityMeasure="AIC", summeryfun=stats::median)
  message(optimalAIC@breaks);
  
  optimalBIC&lt;-getOptimalSpline(ldoSelect, qualityMeasure="BIC", summeryfun=base::mean)
  hist(unlist(optimalBIC@quality));

</code></pre>

<hr>
<h2 id='getPvalue'>Testing differences of groups with respect to a specific value and test.</h2><span id='topic+getPvalue'></span>

<h3>Description</h3>

<p>Testing differences of groups with respect to a specific value and test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPvalue(y, group, test)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getPvalue_+3A_y">y</code></td>
<td>
<p>Values to be tested</p>
</td></tr>
<tr><td><code id="getPvalue_+3A_group">group</code></td>
<td>
<p>corresponding groups whose difference we want to test</p>
</td></tr>
<tr><td><code id="getPvalue_+3A_test">test</code></td>
<td>
<p>specific test to be used. Can be each of the following 'bf', 'levene' or 'bartlett'.</p>
</td></tr>
</table>

<hr>
<h2 id='ldo'>'LoBrA'  Data Object (LDO) for Example data set</h2><span id='topic+ldo'></span>

<h3>Description</h3>

<p>'LoBrA'  example LDO created by the function 'createExampleData' and converted to an LDO by 'as.LOBdataset' function.
It consist of a single matrix for all experiments, time points, types (background, experiment), class and the intensity values of all components created.
The artificial data consist of 20 experiments and 100 components with 18 measurements (3 background, 15 sample). The 10 experiments are each associated to on of 2 groups (ONE and TWO). The components comprise 70 noise components and 30 components that randomly vary in their trajectories in one of three segments. Random noise is added to all intercepts, propagated and added to each time point for all samples and components separately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ldo
</code></pre>


<h3>Format</h3>

<p>A matrix representing 20 experiments. It contains values for 100 variables at 18 time points for each experiment.
Object of class <code>LDO</code>.
</p>


<h3>Author(s)</h3>

<p>Anne-Christin Hauschild <a href="mailto:hauschild@uni-marburg.de">hauschild@uni-marburg.de</a>
</p>

<hr>
<h2 id='LDO-class'>An S4 class to represent a 'LoBrA' Data Object (LDO). It stores multiple time series data for muliple experiements and multiple Components. It allows repeated measurements of a component, irregular sampling, and unequal temporal spacing of the time points.</h2><span id='topic+LDO-class'></span><span id='topic+LDO'></span>

<h3>Description</h3>

<p>An S4 class to represent a 'LoBrA' Data Object (LDO). It stores multiple time series data for muliple experiements and multiple Components. It allows repeated measurements of a component, irregular sampling, and unequal temporal spacing of the time points.
</p>


<h3>Slots</h3>


<dl>
<dt><code>name</code></dt><dd><p>character Name of the 'LDO' object</p>
</dd>
<dt><code>dataMatrices</code></dt><dd><p>list List of matrices of component measurement. It contains a measurement for each time point and each experiment.</p>
</dd>
<dt><code>backgroundMatrices</code></dt><dd><p>list List of matrices of background measurements. It contains a measurement for each time point and each experiment.</p>
</dd>
<dt><code>peaknames</code></dt><dd><p>character Character vector of Component names</p>
</dd>
<dt><code>times</code></dt><dd><p>numeric Vector of times for each time point in the data</p>
</dd>
<dt><code>ids</code></dt><dd><p>character Vector of identifiers for the experiments</p>
</dd>
<dt><code>labels</code></dt><dd><p>factor Vector of class labels for each experiment</p>
</dd>
</dl>

<hr>
<h2 id='LDOmodelselection-class'>An S4 class to represent a model selection result based on an 'LDO'.</h2><span id='topic+LDOmodelselection-class'></span><span id='topic+LDOmodelselection'></span>

<h3>Description</h3>

<p>An S4 class to represent a model selection result based on an 'LDO'.
</p>


<h3>Slots</h3>


<dl>
<dt><code>ldo</code></dt><dd><p>LDO 'LDO' object the model selection is based on.</p>
</dd>
<dt><code>potentialBreaks</code></dt><dd><p>numeric Vector of numeric values that were considered as potential break points in the model selection.</p>
</dd>
<dt><code>splinetype</code></dt><dd><p>character Type of spline used.</p>
</dd>
<dt><code>qualityMeasure</code></dt><dd><p>character Quality measures used during the model selection ('AIC', 'BIC' or 'LogLik')</p>
</dd>
<dt><code>modelList</code></dt><dd><p>list List of all models tested.</p>
</dd>
<dt><code>quality</code></dt><dd><p>list List of quality matrices, one matrix for each quality measure used. Each matrix contains the quality for each spline tested for each component.</p>
</dd>
<dt><code>breaks</code></dt><dd><p>list For each tested spline, this list contains a vector of breaks.</p>
</dd>
</dl>

<hr>
<h2 id='LDOscreening-class'>An S4 class to represent the screening of metabolites in an 'LDO'.</h2><span id='topic+LDOscreening-class'></span><span id='topic+LDOscreening'></span>

<h3>Description</h3>

<p>An S4 class to represent the screening of metabolites in an 'LDO'.
</p>


<h3>Slots</h3>


<dl>
<dt><code>ldo</code></dt><dd><p>LDO LDO object the screening is based on.</p>
</dd>
<dt><code>experimentIntercept</code></dt><dd><p>list List of experiment intercepts.</p>
</dd>
<dt><code>experimentResiduals</code></dt><dd><p>list List of experiment Residuals.</p>
</dd>
<dt><code>interceptPvalues</code></dt><dd><p>matrix Matrix of experiment intercept p-values.</p>
</dd>
<dt><code>residualPvalues</code></dt><dd><p>matrix Matrix of experiment Residual p-values.</p>
</dd>
<dt><code>selectedPeaks</code></dt><dd><p>matrix Matrix of logical values. Each entry indicates whether a specific component is significant according to a specific test.</p>
</dd>
</dl>

<hr>
<h2 id='LoBrA'>LoBrA: A package for modeling longitudinal breath data</h2><span id='topic+LoBrA'></span>

<h3>Description</h3>

<p>The <code>LoBrA</code> package provides important data objects and functions to analyze longitudinal metabolomic (breath) data.
</p>


<h3>Introduction</h3>

<p>Novel metabolomic technologies paved the way for longitudinal analysis of exhaled air 
and online monitoring of fast progressing diseases. 
This package implements an automated analysis approach of longitudinal data from 
different omics technologies, such as ion mobility spectrometry of human exhaled air 
and demonstrates how including temporal signals increases the statistical power in 
biomarker identification. 
It can handel multiple irregular 4D time series data. More precisely, it can simultaniously 
handel the data of multiple experiements each observing multiple components. 
Therefore, it allows repeated measurements of a component, irregular sampling, and unequal 
temporal spacing of the time points.
</p>


<h3>LoBrA Analysis</h3>

<p>A typical LoBrA analysis is will comprise the following steps
</p>
<p>1. Background Screening: Using the function <code><a href="#topic+screening">screening</a></code> and <code><a href="#topic+selectComponents">selectComponents</a></code> to select the Components that most likely do not originate from background noise.
</p>
<p>2. Model Selection: First, a set of spline models based on different number of splits and split positions are generated by the function <code><a href="#topic+lobraModelSelection">lobraModelSelection</a></code>. Subsequently, these models are evaluated using different quality criteria, i.e. 'AIC', 'BIC' and 'LogLik'. Finally, the most appropriate model is selected.
</p>
<p>3. Evaluation of the non-background components on the selected model, using the longitudinal 'Gouderman' linear mixed effect model in function <code><a href="#topic+modelGoudermanLongitudinal">modelGoudermanLongitudinal</a></code>.
</p>


<h3>Author(s)</h3>

<p>Maintainer:
Anne-Christin Hauschild [Copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p>Sandrah P. Eckel
</p>
</li>
<li><p>Jan Baumbach
</p>
</li></ul>


<hr>
<h2 id='lobraModelSelection'>Evaluation of different spline variants.</h2><span id='topic+lobraModelSelection'></span>

<h3>Description</h3>

<p>The model selection method evaluates which spline models achieve the best quality among all tested metabolites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lobraModelSelection(
  selectedLDO,
  potentialBreaks = c(),
  nknots = c(0, 1, 2),
  splinetype = "linear",
  qualityMeasure = c("AIC", "BIC", "logLik")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lobraModelSelection_+3A_selectedldo">selectedLDO</code></td>
<td>
<p><code><a href="#topic+LDO">LDO</a></code> containing all selected metabolites to be used for the model selection.</p>
</td></tr>
<tr><td><code id="lobraModelSelection_+3A_potentialbreaks">potentialBreaks</code></td>
<td>
<p>Vector of all possible knots to be used for the spline modeling.</p>
</td></tr>
<tr><td><code id="lobraModelSelection_+3A_nknots">nknots</code></td>
<td>
<p>Vector of number of spline knots to be used.  Therefore, 0 ~ no spline, 1 ~ spline with one knot, 2 ~ spline with two knots, etc.</p>
</td></tr>
<tr><td><code id="lobraModelSelection_+3A_splinetype">splinetype</code></td>
<td>
<p>spline type default is 'linear'. (Currently only linear is supported.)</p>
</td></tr>
<tr><td><code id="lobraModelSelection_+3A_qualitymeasure">qualityMeasure</code></td>
<td>
<p>Vector of quality measures to be used. Possible options are 'AIC', 'BIC', and 'logLik'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+LDOmodelselection">LDOmodelselection</a></code> Object.
For each quality measure the model list contains a list of models for each spline tested. Additionally, the output contains a matrix of qualities for each Spline Component pair. And finally there is a list of breaks for each spline tested.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 
  data(LoBraExample)
  potentialBreaks &lt;- c(8,12)
  selectedLDO &lt;- selectComponents(ldo, components)
  ldoSelect&lt;- lobraModelSelection(selectedLDO, potentialBreaks, nknots=c( 1, 2))
  length(ldoSelect@ldo@peaknames)
  
  
</code></pre>

<hr>
<h2 id='longDataExample'>'LoBrA'  Example Data Set</h2><span id='topic+longDataExample'></span>

<h3>Description</h3>

<p>'LoBrA'  example data set created by the function 'createExampleData'. #' It consist of a single matrix for all experiments, time points, types (background, experiment), class and the intensity values of all components created.
The artificial data consist of 20 experiments and 100 components with 18 measurements (3 background, 15 sample). The 10 experiments are each associated to on of 2 groups (ONE and TWO). The components comprise 70 noise components and 30 components that randomly vary in their trajectories in one of three segments. Random noise is added to all intercepts, propagated and added to each time point for all samples and components separately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>longDataExample
</code></pre>


<h3>Format</h3>

<p>A matrix representing 20 experiments. It contains values for 100 variables at 18 time points for each experiment.
</p>

<dl>
<dt>id</dt><dd><p>Experiment identifier</p>
</dd>
<dt>time</dt><dd><p>Time Point of Measurement</p>
</dd>
<dt>type</dt><dd><p>Type of Measurement (e.g. Background, or Sample measurement for each experiment)</p>
</dd>
<dt>class</dt><dd><p>Class or Group id of the sample/ experiment</p>
</dd>
<dt>bgcomponent-x</dt><dd><p>70 random variables that represent the background noise of the experiments</p>
</dd>
<dt>components-x-x</dt><dd><p>30 components that randomly vary in their trajectories in one of three time periods, (1:4-8, 2:9-13, 3:14-18). </p>
</dd> 
</dl>
<p>...

</p>


<h3>Author(s)</h3>

<p>Anne-Christin Hauschild <a href="mailto:hauschild@uni-marburg.de">hauschild@uni-marburg.de</a>
</p>

<hr>
<h2 id='modelGoudermanLongitudinal'>Fitting the Gouderman LME Model with using Gouderman-Data Arrangement.</h2><span id='topic+modelGoudermanLongitudinal'></span>

<h3>Description</h3>

<p>Uses the linear mixed effects modeling to build the final 'Gauderman' model. The 'Gauderman' modification enables the exact calculation of the significance of a specified section of the spline model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelGoudermanLongitudinal(mygaudermanLDO, correctionMethod = "bonferroni")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="modelGoudermanLongitudinal_+3A_mygaudermanldo">mygaudermanLDO</code></td>
<td>
<p>GaudermanLDO data object, created by the generalized 'Gauderman' algorithm (GGA).</p>
</td></tr>
<tr><td><code id="modelGoudermanLongitudinal_+3A_correctionmethod">correctionMethod</code></td>
<td>
<p>correction for p-values. Possible methods: 'holm', 'hochberg', 'hommel', 'bonferroni', 'BH', 'BY', 'fdr', 'none'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>'GaudermanModelEvaluation' Results of the evaluation of the Fitted linear mixed effect models for the defined time periods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
  data(LoBraExample)
  selectedLDO &lt;- selectComponents(ldo, components)
  gaudermanLDOexample &lt;- createGoudermanData(selectedLDO, breaks=c(8, 12), center=12, timeperiod=2)
  evalResult&lt;- modelGoudermanLongitudinal(gaudermanLDOexample)
  message(evalResult@correctedpvalues&lt;0.005)
  
</code></pre>

<hr>
<h2 id='plotGaudermanModel'>Plotting helper function to plot a single generalized gouderman Model</h2><span id='topic+plotGaudermanModel'></span>

<h3>Description</h3>

<p>Plotting helper function to plot a single generalized gouderman Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotGaudermanModel(
  data,
  labels,
  ul,
  tempmodel,
  colores,
  maincol,
  breaks,
  main,
  ylab,
  xlab
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotGaudermanModel_+3A_data">data</code></td>
<td>
<p>data matrix used to fit the model</p>
</td></tr>
<tr><td><code id="plotGaudermanModel_+3A_labels">labels</code></td>
<td>
<p>class labels for all samples</p>
</td></tr>
<tr><td><code id="plotGaudermanModel_+3A_ul">ul</code></td>
<td>
<p>unique class labels</p>
</td></tr>
<tr><td><code id="plotGaudermanModel_+3A_tempmodel">tempmodel</code></td>
<td>
<p>model to be plotted</p>
</td></tr>
<tr><td><code id="plotGaudermanModel_+3A_colores">colores</code></td>
<td>
<p>predefined colors for the single samples</p>
</td></tr>
<tr><td><code id="plotGaudermanModel_+3A_maincol">maincol</code></td>
<td>
<p>predefined colors for the fitted spline</p>
</td></tr>
<tr><td><code id="plotGaudermanModel_+3A_breaks">breaks</code></td>
<td>
<p>break points of the spline to be plotted</p>
</td></tr>
<tr><td><code id="plotGaudermanModel_+3A_main">main</code></td>
<td>
<p>main title of the plot</p>
</td></tr>
<tr><td><code id="plotGaudermanModel_+3A_ylab">ylab</code></td>
<td>
<p>y label of the plot</p>
</td></tr>
<tr><td><code id="plotGaudermanModel_+3A_xlab">xlab</code></td>
<td>
<p>x label of the plot</p>
</td></tr>
</table>

<hr>
<h2 id='plotGoudermanLongitudinalResults'>Plotting the 'Gouderman' LME Model and Results.</h2><span id='topic+plotGoudermanLongitudinalResults'></span>

<h3>Description</h3>

<p>Plotting the 'Gouderman' LME Model and Results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotGoudermanLongitudinalResults(
  evaluationresult,
  main = "Mixed Effect Spline Model Evaluation",
  ylab = "Value",
  xlab = "Time",
  peaknames = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotGoudermanLongitudinalResults_+3A_evaluationresult">evaluationresult</code></td>
<td>
<p>'GaudermanModelEvaluation' data object, created by the modelGoudermanLongitudinal function.</p>
</td></tr>
<tr><td><code id="plotGoudermanLongitudinalResults_+3A_main">main</code></td>
<td>
<p>title of the plot</p>
</td></tr>
<tr><td><code id="plotGoudermanLongitudinalResults_+3A_ylab">ylab</code></td>
<td>
<p>y axis label</p>
</td></tr>
<tr><td><code id="plotGoudermanLongitudinalResults_+3A_xlab">xlab</code></td>
<td>
<p>x axis label</p>
</td></tr>
<tr><td><code id="plotGoudermanLongitudinalResults_+3A_peaknames">peaknames</code></td>
<td>
<p>selection of peaks to be plotted</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
  wd &lt;- tempdir()
  data(LoBraExample)
  selectedLDO &lt;- selectComponents(ldo, components)
  gaudermanLDOexample &lt;- createGoudermanData(selectedLDO, breaks=c(8, 12), center=12, timeperiod=2)
  evalResult&lt;- modelGoudermanLongitudinal(gaudermanLDOexample)
  # Plot all peaks
  filename&lt;- file.path(wd, "finalModelEvaluation.pdf") ;
  oldpar &lt;- par("mfrow")
  grDevices::pdf(filename, width=16, height=8);
    graphics::par(mfrow=c(1,1));
    plotGoudermanLongitudinalResults(evalResult);
  par(mfrow = oldpar)
  grDevices::dev.off();
  
  #Plot a selection of Peaks
  peaknames&lt;- evalResult@gaudermanLDO@peaknames;
  filename&lt;- file.path(wd, "finalModelEvaluation-components.pdf") ;
  oldpar &lt;- par("mfrow")
  grDevices::pdf(filename, width=20, height=8);
    graphics::par(mfrow=c(2,5));
    plotGoudermanLongitudinalResults(evalResult, main="", peaknames=peaknames);
  par(mfrow = oldpar)
  grDevices::dev.off();
 
</code></pre>

<hr>
<h2 id='plotLDOScreening'>Plotting the screening results.</h2><span id='topic+plotLDOScreening'></span>

<h3>Description</h3>

<p>For each peak two box plots are created. The first plot shows a boxplot of the Sample Intercept Comparison of the sample and the background, and the corresponding p-values. The second plot shows a boxplot of the Residual Comparison of the sample and the background, and the corresponding p-values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotLDOScreening(
  ldoscreen,
  plotAll = FALSE,
  correctionmethod = "levene",
  decs = 3,
  ask = FALSE,
  peaknames = rownames(ldoscreen@selectedPeaks)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotLDOScreening_+3A_ldoscreen">ldoscreen</code></td>
<td>
<p>LDO screening result</p>
</td></tr>
<tr><td><code id="plotLDOScreening_+3A_plotall">plotAll</code></td>
<td>
<p>Select all components to be plotted. Default plots only the selected peaks using the correction method.</p>
</td></tr>
<tr><td><code id="plotLDOScreening_+3A_correctionmethod">correctionmethod</code></td>
<td>
<p>Version of correction method to be used to select the peaks. Valid values are 'bf', 'levene', and 'bartlett'.</p>
</td></tr>
<tr><td><code id="plotLDOScreening_+3A_decs">decs</code></td>
<td>
<p>decimal numbers of p-values to be plotted.</p>
</td></tr>
<tr><td><code id="plotLDOScreening_+3A_ask">ask</code></td>
<td>
<p>logical. Modifies the graphical parameter <code>ask</code> in <code>par</code> (If TRUE (and the R session is interactive) the user is asked for input, before a new figure is drawn. As this applies to the device, it also affects output by packages grid and lattice. It can be set even on non-screen devices but may have no effect there.)</p>
</td></tr>
<tr><td><code id="plotLDOScreening_+3A_peaknames">peaknames</code></td>
<td>
<p>Defining a list of peaks to be plotted. By default all peaks will be plotted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 

  wd &lt;- tempdir()
  data(LoBraExample)
  ldos&lt;-screening(ldo, method= c('levene'), alpha =0.05, criteria=c(1,1))
  filename&lt;- file.path(wd, "screeningresults.pdf") 
  grDevices::pdf(filename, width=16, height=8)
  plotLDOScreening(ldos)
  grDevices::dev.off();

</code></pre>

<hr>
<h2 id='plotmodelSelectionEvaluation'>Plotting results of Model Evaluation and Selection.</h2><span id='topic+plotmodelSelectionEvaluation'></span>

<h3>Description</h3>

<p>Plotting the results of Model Evaluation and Selection. The plot shows a vertical boxplot for each spline tested starting with the best average fit according to the selected quality measure. The label of each spline can be found on the left, the median quality measure on the right. The x-axis denotes the selected quality measure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotmodelSelectionEvaluation(
  lobraModelSelectionObject,
  qualityMeasure,
  title = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotmodelSelectionEvaluation_+3A_lobramodelselectionobject">lobraModelSelectionObject</code></td>
<td>
<p>Object of type LDOmodelselection that was created during the model evaluation. @seealso 'lobraModelSelection'</p>
</td></tr>
<tr><td><code id="plotmodelSelectionEvaluation_+3A_qualitymeasure">qualityMeasure</code></td>
<td>
<p>List of quality measures to be visualized.</p>
</td></tr>
<tr><td><code id="plotmodelSelectionEvaluation_+3A_title">title</code></td>
<td>
<p>Title of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 

wd &lt;- tempdir()
data(LoBraExample)
selectedLDO &lt;- selectComponents(ldo, components)
ldoSelect&lt;- lobraModelSelection(selectedLDO, potentialBreaks=c(8, 12), nknots=c(1, 2))

filename&lt;- file.path(wd, "evaluateBestSplineAIC.pdf") ;
grDevices::pdf(filename, width=16, height=8);
  plotmodelSelectionEvaluation(ldoSelect, "AIC", "Best Spline Models");
grDevices::dev.off();
  
qualityMeasure=c("AIC", "BIC", "logLik")
filename&lt;- file.path(wd, "evaluateBestSplineAllMeasures.pdf") ;
grDevices::pdf(filename, width=16, height=8);
oldpar &lt;- par("mfrow")
par(mfrow=c(3,1))
  plotmodelSelectionEvaluation(ldoSelect, qualityMeasure);
par(mfrow = oldpar)
grDevices::dev.off();

</code></pre>

<hr>
<h2 id='plotTimeSeries'>Plotting function for a longitudinal data matrix (Internal Function)</h2><span id='topic+plotTimeSeries'></span>

<h3>Description</h3>

<p>Plotting function for a longitudinal data matrix (Internal Function)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotTimeSeries(
  myMatrix,
  main = "",
  labels = NA,
  ylab = "Expression",
  xlab = "Time Point",
  legend = "",
  col = 1:dim(myMatrix)[1]
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotTimeSeries_+3A_mymatrix">myMatrix</code></td>
<td>
<p>longitudinal data matrix to be plotted</p>
</td></tr>
<tr><td><code id="plotTimeSeries_+3A_main">main</code></td>
<td>
<p>Title of the plot</p>
</td></tr>
<tr><td><code id="plotTimeSeries_+3A_labels">labels</code></td>
<td>
<p>class labels of samples</p>
</td></tr>
<tr><td><code id="plotTimeSeries_+3A_ylab">ylab</code></td>
<td>
<p>Label of y axis</p>
</td></tr>
<tr><td><code id="plotTimeSeries_+3A_xlab">xlab</code></td>
<td>
<p>Label of x axis</p>
</td></tr>
<tr><td><code id="plotTimeSeries_+3A_legend">legend</code></td>
<td>
<p>of plot</p>
</td></tr>
<tr><td><code id="plotTimeSeries_+3A_col">col</code></td>
<td>
<p>vector of colors for plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>

<hr>
<h2 id='powerSet'>Creating the power set of a set.</h2><span id='topic+powerSet'></span>

<h3>Description</h3>

<p>Creating the power set of a set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerSet(set)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="powerSet_+3A_set">set</code></td>
<td>
<p>Set of numbers of potential spline break points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns power set of the given set.
</p>

<hr>
<h2 id='screening'>Screening of background or confounding components</h2><span id='topic+screening'></span>

<h3>Description</h3>

<p>Background noise signals originating from experimental settings or random events can hugely influence the signal pattern of the breath. Background data enables the detailed evaluation and differentiation of the compounds originating primarily from the background or confounding factors as compared to those from the sample itself. The method assumes that all compounds of interest show a larger variation in the sample as compared to the background noise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>screening(
  ldo,
  method = c("bf", "levene", "bartlett"),
  alpha = 0.05,
  criteria = c(1, 1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="screening_+3A_ldo">ldo</code></td>
<td>
<p>Longitudinal Data Object</p>
</td></tr>
<tr><td><code id="screening_+3A_method">method</code></td>
<td>
<p>list of tests to perform, standard values: 'bf', 'levene' or 'bartlett'). 'bf' relates to &quot;Brown-Forsythe&quot; Levene-type procedure, 'levene' uses classical &quot;Levene's&quot; procedure and 'bartlett' applies Bartlett's test.</p>
</td></tr>
<tr><td><code id="screening_+3A_alpha">alpha</code></td>
<td>
<p>A numeric value to defining the cutoff to select peaks.</p>
</td></tr>
<tr><td><code id="screening_+3A_criteria">criteria</code></td>
<td>
<p>indicators which criteria to use for screening decision.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of type 'LDOscreening' containing the original 'ldo' object and the results of the screening. The variable 'selectedPeaks' contains a matrix including the results (TRUE = Significant, FALSE = not Significant) of the specified tests ('bf', 'levene', 'bartlett').
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 

  data(LoBraExample)
  method= c('bf', 'levene', 'bartlett')
  alpha =0.05
  criteria=c(1,1)
  ldos&lt;-screening(ldo, method, alpha, criteria)
  components &lt;- ldos@selectedPeaks[,"levene"]
  components &lt;- names(components)[components]
  selectedLDO &lt;- selectComponents(ldo, components)


</code></pre>

<hr>
<h2 id='selectComponents'>Create a new 'LDO' Object that only contains the selected components.</h2><span id='topic+selectComponents'></span>

<h3>Description</h3>

<p>Create a new 'LDO' Object that only contains the selected components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selectComponents(ldo, components, name = paste(ldo@name, " selected"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="selectComponents_+3A_ldo">ldo</code></td>
<td>
<p>Longitudinal Data Object</p>
</td></tr>
<tr><td><code id="selectComponents_+3A_components">components</code></td>
<td>
<p>Component names to select for the new ldo object. Only elements from this list that overlap with the peak names in the given ldo, are utilized.</p>
</td></tr>
<tr><td><code id="selectComponents_+3A_name">name</code></td>
<td>
<p>Name of newly created 'LDO' object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>new ldo object only containing the selected components.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
