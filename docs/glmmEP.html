<!DOCTYPE html><html lang="en"><head><title>Help for package glmmEP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {glmmEP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#glmmEP'><p>Approximate frequentist inference for generalized linear mixed models via expectation propagation.</p></a></li>
<li><a href='#glmmEP.control'><p>Controlling generalized linear mixed model fitting via expectation propagation</p></a></li>
<li><a href='#glmmEPvignette'><p>Display the package's vignette.</p></a></li>
<li><a href='#glmmSimData'><p>Simulation of data from a generalized linear mixed model.</p></a></li>
<li><a href='#summary.glmmEP'><p>Inferential summary for a generalized linear mixed model with expectation propagation fitting.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.0-3.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-10-08</td>
</tr>
<tr>
<td>Title:</td>
<td>Generalized Linear Mixed Model Analysis via Expectation
Propagation</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matt P. Wand &lt;matt.wand@uts.edu.au&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>stats</td>
</tr>
<tr>
<td>Imports:</td>
<td>lme4, matrixcalc</td>
</tr>
<tr>
<td>Suggests:</td>
<td>mlmRev</td>
</tr>
<tr>
<td>Description:</td>
<td>Approximate frequentist inference for generalized linear mixed model analysis with expectation propagation used to circumvent the need for multivariate integration. In this version, the random effects can be any reasonable dimension. However, only probit mixed models with one level of nesting are supported. The methodology is described in Hall, Johnstone, Ormerod, Wand and Yu (2018) &lt;<a href="https://doi.org/10.48550/arXiv.1805.08423">doi:10.48550/arXiv.1805.08423</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-10-15 08:10:05 UTC; ripley</td>
</tr>
<tr>
<td>Author:</td>
<td>Matt P. Wand [aut, cre],
  James C.F. Yu [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-10-15 08:19:35 UTC</td>
</tr>
</table>
<hr>
<h2 id='glmmEP'>Approximate frequentist inference for generalized linear mixed models via expectation propagation.</h2><span id='topic+glmmEP'></span>

<h3>Description</h3>

<p>The machine learning paradigm known as expectation propagation, typically used for approximation inference in Bayesian graphical models contexts, is adapted to the problem of frequentist inference in generalized linear mixed model analysis. The essence is rapid approximation evaluation of the log-likelihood surface by using expectation propagation projections onto the Multivariate Normal family that circumvent the need for numerical integration. The approach applies to any reasonable dimension of the random effects vector, but currently is limited to probit mixed models with one level of nesting. The reference below provides full details.</p>


<h3>Usage</h3>

<pre><code class='language-R'>glmmEP(y,Xfixed=NULL,Xrandom,idNum,control)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glmmEP_+3A_y">y</code></td>
<td>
<p>Vector containing the (0/1) response data.</p>
</td></tr>
<tr><td><code id="glmmEP_+3A_xfixed">Xfixed</code></td>
<td>
<p>Matrix with columns consisting of predictors that enter the model as fixed effects. Each entry of the first column equal the number 1 corresponding to the fixed effects intercept.</p>
</td></tr>
<tr><td><code id="glmmEP_+3A_xrandom">Xrandom</code></td>
<td>
<p>Matrix with columns consisting of predictors that enter the model as random effects. Each entry of the  first column must equal the number 1 corresponding to the random effects intercept.</p>
</td></tr>
<tr><td><code id="glmmEP_+3A_idnum">idNum</code></td>
<td>
<p>Vector containing group membership identification numbers.</p>
</td></tr>
<tr><td><code id="glmmEP_+3A_control">control</code></td>
<td>
<p>Function for controlling convergence and other specifications.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matt Wand<a href="mailto:matt.wand@uts.edu.au">matt.wand@uts.edu.au</a> and James Yu<a href="mailto:james.yu@student.uts.edu.au">james.yu@student.uts.edu.au</a></p>


<h3>References</h3>

<p>Hall, P., Johnstone, I.M., Ormerod, J.T., Wand, M.P. and Yu, J. (2018). 
Fast and accurate binary response mixed model analysis via expectation propagation. 
&lt;arXiv:1805.08423v1&gt;.</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(glmmEP)

# Simulate data corresponding to a
# a simple random intercept model:

set.seed(1)  ; m &lt;- 100 ; n &lt;- 10
beta0True &lt;- 0.37 ; beta1True &lt;- 0.93 ; sigmaTrue &lt;- 0.73
uTrue &lt;- rnorm(m)*sigmaTrue
x &lt;- runif(m*n)
y &lt;- rbinom(m*n,1,pnorm(beta0True + beta1True*x 
            + crossprod(t(kronecker(diag(m),rep(1,n))),uTrue)))
idNum &lt;- rep(1:m,each=n)
Xfixed &lt;- cbind(1,x)
Xrandom &lt;- matrix(1,length(y),1)
colnames(Xfixed) &lt;- c("intercept","x")

# Obtain and summarise glmmEP() fit:

fit &lt;- glmmEP(y,Xfixed,Xrandom,idNum)
summary(fit)

# Obtain simulated data corresponding to the
# simulation study in Section 4.1.2. of 
# Hall et al. (2018):

dataObj &lt;- glmmSimData(seed=54321)
y &lt;- dataObj$y  
Xfixed &lt;- dataObj$Xfixed
Xrandom &lt;- dataObj$Xrandom  
idNum &lt;- dataObj$idNum

# Obtain the probit mixed model fit and summaries:


fitSimData &lt;- glmmEP(y,Xfixed,Xrandom,idNum)
summary(fitSimData)
plot(fitSimData$randomEffects) ; abline(h=0) ; abline(v=0)


if (require("mlmRev"))
{
   # Example involving the data frame `Contraception'
   # in the package `mlmRev', starting with
   # setting up the input vectors and matrices
   # for a random intercepts model:

   data(Contraception)
   y &lt;- as.numeric(as.character(Contraception$use)=="Y")
   Xfixed &lt;- cbind(1,as.numeric(as.character(Contraception$urban)=="Y"),
                   Contraception$age,
                   as.numeric(as.character(Contraception$livch)=="1"),
                   as.numeric(as.character(Contraception$livch)=="2"),
                   as.numeric(as.character(Contraception$livch)=="3+"))
   colnames(Xfixed) &lt;- c("intercept","isUrban","age","livChEq1",
                         "livChEq2","livChGe3")
   Xrandom &lt;- as.matrix(rep(1,length(y)))
   colnames(Xrandom) &lt;- "intercept"
   idNum &lt;- as.numeric(as.character(Contraception$district))

   # Obtain random intercepts probit mixed model fit and summaries:

   
   fitContracRanInt &lt;- glmmEP(y,Xfixed,Xrandom,idNum)
   summary(fitContracRanInt)
   hist(as.numeric(fitContracRanInt$randomEffects),
        xlab="random intercepts predicted values",probability=TRUE,
        col="dodgerblue",breaks=15,main="")
   abline(v=0,col="slateblue",lwd=2)
   

   # Change `Xrandom' to correspond to a random intercepts and 
   # slopes model:

   Xrandom &lt;- cbind(1,as.numeric(as.character(Contraception$urban)=="Y"))
   colnames(Xrandom) &lt;- c("intercept","isUrban")

   # Obtain random intercepts and slopes probit mixed model fit and summaries:

   
   fitContracRanIntAndSlp &lt;- glmmEP(y,Xfixed,Xrandom,idNum)
   summary(fitContracRanIntAndSlp)
   plot(fitContracRanIntAndSlp$randomEffects,
        col="dodgerblue",xlab="random intercepts predicted values",
        ylab="random slopes predicted values",bty="l")
   abline(v=0,col="slateblue",lwd=2); abline(h=0,col="slateblue",lwd=2)
   
}
</code></pre>

<hr>
<h2 id='glmmEP.control'>Controlling generalized linear mixed model fitting via expectation propagation</h2><span id='topic+glmmEP.control'></span>

<h3>Description</h3>

<p>Function for optional use in calls to <code>glmmEP()</code> to control convergence values and other specifications for expectation propagation-based fitting of generalized linear mixed models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>glmmEP.control(confLev=0.95,BFGSmaxit=500,BFGSreltol=1e-10,
               EPmaxit=100,EPreltol=1e-5,NMmaxit=100,NMreltol=1e-10,
               quiet=FALSE,preTransfData=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glmmEP.control_+3A_conflev">confLev</code></td>
<td>
<p>Confidence level of confidence intervals expressed as a proportion (i.e. a number between 0 and 1). The default is 0.95 corresponding to 95% confidence intervals.</p>
</td></tr>
<tr><td><code id="glmmEP.control_+3A_bfgsmaxit">BFGSmaxit</code></td>
<td>
<p>Positive integer specifying the maximum number of iterations in the Broyden-Fletcher-Goldfarb-Shanno optimization phase. The default is 500.</p>
</td></tr>
<tr><td><code id="glmmEP.control_+3A_bfgsreltol">BFGSreltol</code></td>
<td>
<p>Positive number specifying the relative tolerance value as defined in the R function optim() in the Broyden-Fletcher-Goldfarb-Shanno optimization phase. The default is 1e-10.</p>
</td></tr>
<tr><td><code id="glmmEP.control_+3A_epmaxit">EPmaxit</code></td>
<td>
<p>Positive integer specifying the maximum number of iterations in the expectation propagation message passing iterations. The default is 100.</p>
</td></tr>
<tr><td><code id="glmmEP.control_+3A_epreltol">EPreltol</code></td>
<td>
<p>Positive number specifying the relative tolerance value for the expectation propagation message passing iterations. The default is 1e-5.</p>
</td></tr>
<tr><td><code id="glmmEP.control_+3A_nmmaxit">NMmaxit</code></td>
<td>
<p>Positive integer specifying the maximum number of iterations in the Nelder-Mead optimization phase. The default is 100.</p>
</td></tr>
<tr><td><code id="glmmEP.control_+3A_nmreltol">NMreltol</code></td>
<td>
<p>Positive number specifying the relative tolerance value as defined in the R function optim() in the Nelder-Mead optimization phase. The default is 1e-10.</p>
</td></tr>
<tr><td><code id="glmmEP.control_+3A_quiet">quiet</code></td>
<td>
<p>Flag for specifying whether or not glmmEP() runs &lsquo;quietly&rsquo; or with progress reports printed to the screen. The default is FALSE.</p>
</td></tr>
<tr><td><code id="glmmEP.control_+3A_pretransfdata">preTransfData</code></td>
<td>
<p>Flag for specifying whether or not the predictor data are pre-transformed to the unit interval for fitting, with estimates, predictions and confidence intervals transformed to match the units of the original data before. The default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing values of each of the fifteen control parameters, packaged to supply the <code>control</code> argument to <code>glmmEP</code>. The values for <code>glmmEP.control</code> can be specified in the call to <code>glmmEP</code>.
</p>


<h3>Author(s)</h3>

<p>Matt Wand<a href="mailto:matt.wand@uts.edu.au">matt.wand@uts.edu.au</a> and James Yu<a href="mailto:jamescfyu@gmail.com">jamescfyu@gmail.com</a></p>


<h3>References</h3>

<p>Hall, P., Johnstone, I.M., Ormerod, J.T., Wand, M.P. and Yu, J.C.F. (2018). 
Fast and accurate binary response mixed model analysis via expectation propagation. Submitted.</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(glmmEP)

# Obtain simulated data corresponding to the simulation study in Section 4.1.2. of 
# Hall et al. (2018):

dataObj &lt;- glmmSimData(seed=54321)
y &lt;- dataObj$y  
Xfixed &lt;- dataObj$Xfixed
Xrandom &lt;- dataObj$Xrandom  
idNum &lt;- dataObj$idNum

# Obtain and summarise probit mixed model fit with user control
# of some of the parameters in glmmEP.control():

myNMmaxit &lt;- 500 ; myBFGSreltol &lt;- 0.001

fitSimData &lt;- glmmEP(y,Xfixed,Xrandom,idNum,
              control=glmmEP.control(NMmaxit=myNMmaxit,BFGSreltol=myBFGSreltol,quiet=TRUE))
summary(fitSimData)
</code></pre>

<hr>
<h2 id='glmmEPvignette'>Display the package's vignette.</h2><span id='topic+glmmEPvignette'></span>

<h3>Description</h3>

<p>The vignette of the glmmEP package is displayed using the default PDF file browser. It provides a detailed detailed description of use of the package for binary mixed model analysis.</p>


<h3>Usage</h3>

<pre><code class='language-R'>glmmEPvignette()
</code></pre>


<h3>Author(s)</h3>

<p>Matt Wand<a href="mailto:matt.wand@uts.edu.au">matt.wand@uts.edu.au</a> and James Yu<a href="mailto:james.yu@student.uts.edu.au">james.yu@student.uts.edu.au</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>glmmEPvignette()
</code></pre>

<hr>
<h2 id='glmmSimData'>Simulation of data from a generalized linear mixed model.</h2><span id='topic+glmmSimData'></span>

<h3>Description</h3>

<p>Section 4.1.2 of the refence below descries a simulation study with data generated from a probit mixed model with six fixed effects parameters and a bivariate random effects vector having a 2 by 2 symmetric positive definite covariance matrix. The function simulates a data set from this model with 2500 groups and the number of observation in each group being a random draw from 20,21,...,30.</p>


<h3>Usage</h3>

<pre><code class='language-R'>glmmSimData(seed=12345)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glmmSimData_+3A_seed">seed</code></td>
<td>
<p>A positive integer which acts the seed for random data generation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matt Wand<a href="mailto:matt.wand@uts.edu.au">matt.wand@uts.edu.au</a> and James Yu<a href="mailto:james.yu@student.uts.edu.au">james.yu@student.uts.edu.au</a></p>


<h3>References</h3>

<p>Hall, P.,Johnstone, I.M., Ormerod, J.T., Wand, M.P. and Yu, J. (2018). 
Fast and accurate binary response mixed model analysis via expectation propagation. &lt;arXiv:1805.08423v1&gt;.</p>


<h3>Examples</h3>

<pre><code class='language-R'># Obtain simulated data corresponding to the simulation study in Section 4.1.2. of 
# Hall et al. (2018):

library(glmmEP)
dataObj &lt;- glmmSimData(seed=54321)
print(names(dataObj))
</code></pre>

<hr>
<h2 id='summary.glmmEP'>Inferential summary for a generalized linear mixed model with expectation propagation fitting.</h2><span id='topic+summary.glmmEP'></span>

<h3>Description</h3>

<p>Produces a table containing approximated maximum likelihood estimates and corresponding confidence interval limits for the fixed effect parameters and random effects standard deviation and correlation parameters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmmEP'
summary(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.glmmEP_+3A_object">object</code></td>
<td>
<p>A <code>glmmEP()</code> fit object.</p>
</td></tr>
<tr><td><code id="summary.glmmEP_+3A_...">...</code></td>
<td>
<p>Place-holder for additional arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matt Wand<a href="mailto:matt.wand@uts.edu.au">matt.wand@uts.edu.au</a> and James Yu<a href="mailto:jamescfyu@gmail.com">jamescfyu@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>dataObj &lt;- glmmSimData(seed=54321)
y &lt;- dataObj$y  
Xfixed &lt;- dataObj$Xfixed
Xrandom &lt;- dataObj$Xrandom  
idNum &lt;- dataObj$idNum

fitSimData &lt;- glmmEP(y,Xfixed,Xrandom,idNum)
summary(fitSimData)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
