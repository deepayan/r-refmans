<!DOCTYPE html><html><head><title>Help for package rtry</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rtry}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#data_coordinates'><p>Sample coordinates data</p></a></li>
<li><a href='#data_locations'><p>Sample locations data</p></a></li>
<li><a href='#data_TRY_15160'><p>Sample TRY data (Request 15160)</p></a></li>
<li><a href='#data_TRY_15161'><p>Sample TRY data (Request 15161)</p></a></li>
<li><a href='#rtry_bind_col'><p>Bind data by columns</p></a></li>
<li><a href='#rtry_bind_row'><p>Bind data by rows</p></a></li>
<li><a href='#rtry_exclude'><p>Exclude (remove) data</p></a></li>
<li><a href='#rtry_explore'><p>Explore data</p></a></li>
<li><a href='#rtry_export'><p>Export preprocessed data</p></a></li>
<li><a href='#rtry_geocoding'><p>Perform geocoding</p></a></li>
<li><a href='#rtry_import'><p>Import data</p></a></li>
<li><a href='#rtry_join_left'><p>Left join for two data frames</p></a></li>
<li><a href='#rtry_join_outer'><p>Outer join for two data frames</p></a></li>
<li><a href='#rtry_remove_col'><p>Remove columns</p></a></li>
<li><a href='#rtry_remove_dup'><p>Remove duplicates in data</p></a></li>
<li><a href='#rtry_revgeocoding'><p>Perform reverse geocoding</p></a></li>
<li><a href='#rtry_select_anc'><p>Select ancillary data in wide table format</p></a></li>
<li><a href='#rtry_select_col'><p>Select columns</p></a></li>
<li><a href='#rtry_select_row'><p>Select rows</p></a></li>
<li><a href='#rtry_trans_wider'><p>Transform data from long to wide table</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Preprocessing Plant Trait Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Designed to support the application of plant trait data providing easy applicable functions
    for the basic steps of data preprocessing, e.g. data import, data exploration, selection of columns
    and rows, excluding trait data according to different attributes, geocoding, long- to wide-table
    transformation, and data export. 'rtry' was initially developed as part of the TRY R project to
    preprocess trait data received via the TRY database.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, data.table, dplyr, tidyr, jsonlite, curl, magrittr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/MPI-BGC-Functional-Biogeography/rtry">https://github.com/MPI-BGC-Functional-Biogeography/rtry</a>,
<a href="https://www.try-db.org/TryWeb/Home.php">https://www.try-db.org/TryWeb/Home.php</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/MPI-BGC-Functional-Biogeography/rtry/issues">https://github.com/MPI-BGC-Functional-Biogeography/rtry/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Olee Hoi Ying Lam &lt;hlam9@wisc.edu&gt;</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-09 20:01:58 UTC; hlam9</td>
</tr>
<tr>
<td>Author:</td>
<td>Olee Hoi Ying Lam <a href="https://orcid.org/0000-0002-7731-3246"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Susanne Tautenhahn
    <a href="https://orcid.org/0000-0002-2753-3443"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Gabriel Walther <a href="https://orcid.org/0000-0003-3550-9045"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Gerhard Boenisch [aut],
  Pramod Baddam <a href="https://orcid.org/0000-0002-7858-9295"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Jens Kattge <a href="https://orcid.org/0000-0002-1022-8469"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Fellowship Group Functional Biogeography at MPI-BGC, Jena, Germany
    [cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-09 20:40:21 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='data_coordinates'>Sample coordinates data</h2><span id='topic+data_coordinates'></span>

<h3>Description</h3>

<p>A dataset containing 20 sets of latitudes and longitudes in WGS84 projection.
The raw dataset (<code>data_coordinates.csv</code>) is also provided in the directory <code>testdata</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_coordinates
</code></pre>


<h3>Format</h3>

<p>A data frame with 20 rows and 2 variables:
</p>

<dl>
<dt>Latitude</dt><dd><p>Latitude, in WGS84 projection.</p>
</dd>
<dt>Longitude</dt><dd><p>Longitude, in WGS84 projection.</p>
</dd>
</dl>



<h3>Value</h3>

<p>A data frame with 20 rows and 2 variables of sample coordinates data.
</p>

<hr>
<h2 id='data_locations'>Sample locations data</h2><span id='topic+data_locations'></span>

<h3>Description</h3>

<p>A dataset containing 20 location information.
The raw dataset (<code>data_locations.csv</code>) is also provided in the directory <code>testdata</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_locations
</code></pre>


<h3>Format</h3>

<p>A data frame with 20 rows and 3 variables:
</p>

<dl>
<dt>Country code</dt><dd><p>Country code.</p>
</dd>
<dt>Country</dt><dd><p>Full name of a country.</p>
</dd>
<dt>Location</dt><dd><p>Specific location, e.g. town or city name.</p>
</dd>
</dl>



<h3>Value</h3>

<p>A data frame with 20 rows and 3 variables of sample locations data.
</p>

<hr>
<h2 id='data_TRY_15160'>Sample TRY data (Request 15160)</h2><span id='topic+data_TRY_15160'></span>

<h3>Description</h3>

<p>A dataset requested from the <a href="https://www.try-db.org/TryWeb/Prop0.php">TRY Database</a>.
The request ID of this dataset is 15160, which contains <code>TraitID</code>: 3115, 3116
and <code>AccSpeciesID</code>: 10773, 35846, 45737.
The raw dataset (<code>data_TRY_15160.txt</code>) is also provided in the directory <code>testdata</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_TRY_15160
</code></pre>


<h3>Format</h3>

<p>A data frame with 1782 rows and 28 variables:
</p>

<dl>
<dt>LastName</dt><dd><p>Surname of data contributor.</p>
</dd>
<dt>FirstName</dt><dd><p>First name of data contributor.</p>
</dd>
<dt>DatasetID</dt><dd><p>Unique identifier of contributed dataset.</p>
</dd>
<dt>Dataset</dt><dd><p>Name of contributed dataset</p>
</dd>
<dt>SpeciesName</dt><dd><p>Original name of species.</p>
</dd>
<dt>AccSpeciesID</dt><dd><p>Unique identifier of consolidated species name.</p>
</dd>
<dt>AccSpeciesName</dt><dd><p>Consolidated species name.</p>
</dd>
<dt>ObservationID</dt><dd><p>Unique identifier for each observation in TRY.</p>
</dd>
<dt>ObsDataID</dt><dd><p>Unique identifier for each row in the TRY data table, either trait record or ancillary data.</p>
</dd>
<dt>TraitID</dt><dd><p>Unique identifier for traits (only if the record is a trait).</p>
</dd>
<dt>TraitName</dt><dd><p>Name of trait (only if the record is a trait).</p>
</dd>
<dt>DataID</dt><dd><p>Unique identifier for each <code>DataName</code> (either sub-trait or ancillary data).</p>
</dd>
<dt>DataName</dt><dd><p>Name of sub-trait or ancillary data.</p>
</dd>
<dt>OriglName</dt><dd><p>Original name of sub-trait or ancillary data.</p>
</dd>
<dt>OrigValueStr</dt><dd><p>Original value of trait or ancillary data.</p>
</dd>
<dt>OrigUnitStr</dt><dd><p>Original unit of trait or ancillary data.</p>
</dd>
<dt>ValueKindName</dt><dd><p>Value kind (single measurement, mean, median, etc.).</p>
</dd>
<dt>OrigUncertaintyStr</dt><dd><p>Original uncertainty.</p>
</dd>
<dt>UncertaintyName</dt><dd><p>Kind of uncertainty (standard deviation, standard error, etc.).</p>
</dd>
<dt>Replicates</dt><dd><p>Number of replicates.</p>
</dd>
<dt>StdValue</dt><dd><p>Standardized trait value: available for frequent continuous traits.</p>
</dd>
<dt>UnitName</dt><dd><p>Standard unit: available for frequent continuous traits.</p>
</dd>
<dt>RelUncertaintyPercent</dt><dd><p>Relative uncertainty in %.</p>
</dd>
<dt>OrigObsDataID</dt><dd><p>Unique identifier for duplicate trait records.</p>
</dd>
<dt>ErrorRisk</dt><dd><p>Indication for outlier trait values: distance to mean in standard deviations.</p>
</dd>
<dt>Reference</dt><dd><p>Reference to be cited if trait record is used in analysis.</p>
</dd>
<dt>Comment</dt><dd><p>Explanation for the <code>OriglName</code> in the contributed dataset.</p>
</dd>
<dt>V28</dt><dd><p>Empty, an artifact due to different interpretation of column separator by MySQL and R.</p>
</dd>
</dl>



<h3>Value</h3>

<p>A data frame with 1782 rows and 28 variables of sample TRY data (Request 15160).
</p>

<hr>
<h2 id='data_TRY_15161'>Sample TRY data (Request 15161)</h2><span id='topic+data_TRY_15161'></span>

<h3>Description</h3>

<p>A dataset requested from the <a href="https://www.try-db.org/TryWeb/Prop0.php">TRY Database</a>.
The request ID of this dataset is 15161, which contains <code>TraitID</code>: 3117
and <code>AccSpeciesID</code>: 10773, 35846, 45737.
The raw dataset (<code>data_TRY_15161.txt</code>) is also provided in the directory <code>testdata</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_TRY_15161
</code></pre>


<h3>Format</h3>

<p>A data frame with 4627 rows and 28 variables:
</p>

<dl>
<dt>LastName</dt><dd><p>Surname of data contributor.</p>
</dd>
<dt>FirstName</dt><dd><p>First name of data contributor.</p>
</dd>
<dt>DatasetID</dt><dd><p>Unique identifier of contributed dataset.</p>
</dd>
<dt>Dataset</dt><dd><p>Name of contributed dataset</p>
</dd>
<dt>SpeciesName</dt><dd><p>Original name of species.</p>
</dd>
<dt>AccSpeciesID</dt><dd><p>Unique identifier of consolidated species name.</p>
</dd>
<dt>AccSpeciesName</dt><dd><p>Consolidated species name.</p>
</dd>
<dt>ObservationID</dt><dd><p>Unique identifier for each observation in TRY.</p>
</dd>
<dt>ObsDataID</dt><dd><p>Unique identifier for each row in the TRY data table, either trait record or ancillary data.</p>
</dd>
<dt>TraitID</dt><dd><p>Unique identifier for traits (only if the record is a trait).</p>
</dd>
<dt>TraitName</dt><dd><p>Name of trait (only if the record is a trait).</p>
</dd>
<dt>DataID</dt><dd><p>Unique identifier for each <code>DataName</code> (either sub-trait or ancillary data).</p>
</dd>
<dt>DataName</dt><dd><p>Name of sub-trait or ancillary data.</p>
</dd>
<dt>OriglName</dt><dd><p>Original name of sub-trait or ancillary data.</p>
</dd>
<dt>OrigValueStr</dt><dd><p>Original value of trait or ancillary data.</p>
</dd>
<dt>OrigUnitStr</dt><dd><p>Original unit of trait or ancillary data.</p>
</dd>
<dt>ValueKindName</dt><dd><p>Value kind (single measurement, mean, median, etc.).</p>
</dd>
<dt>OrigUncertaintyStr</dt><dd><p>Original uncertainty.</p>
</dd>
<dt>UncertaintyName</dt><dd><p>Kind of uncertainty (standard deviation, standard error, etc.).</p>
</dd>
<dt>Replicates</dt><dd><p>Number of replicates.</p>
</dd>
<dt>StdValue</dt><dd><p>Standardized trait value: available for frequent continuous traits.</p>
</dd>
<dt>UnitName</dt><dd><p>Standard unit: available for frequent continuous traits.</p>
</dd>
<dt>RelUncertaintyPercent</dt><dd><p>Relative uncertainty in %.</p>
</dd>
<dt>OrigObsDataID</dt><dd><p>Unique identifier for duplicate trait records.</p>
</dd>
<dt>ErrorRisk</dt><dd><p>Indication for outlier trait values: distance to mean in standard deviations.</p>
</dd>
<dt>Reference</dt><dd><p>Reference to be cited if trait record is used in analysis.</p>
</dd>
<dt>Comment</dt><dd><p>Explanation for the <code>OriglName</code> in the contributed dataset.</p>
</dd>
<dt>V28</dt><dd><p>Empty, an artifact due to different interpretation of column separator by MySQL and R.</p>
</dd>
</dl>



<h3>Value</h3>

<p>A data frame with 4627 rows and 28 variables of sample TRY data (Request 15161).
</p>

<hr>
<h2 id='rtry_bind_col'>Bind data by columns</h2><span id='topic+rtry_bind_col'></span>

<h3>Description</h3>

<p>This function takes a list of data frames or data tables and combines them by columns.
The data have to have the same number and sequence of rows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtry_bind_col(..., showOverview = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtry_bind_col_+3A_...">...</code></td>
<td>
<p>A list of data frames or data tables to be combined by columns.</p>
</td></tr>
<tr><td><code id="rtry_bind_col_+3A_showoverview">showOverview</code></td>
<td>
<p>Default <code>TRUE</code> displays the dimension and column names of the combined data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the same type as the first input.
</p>


<h3>Note</h3>

<p>A common attribute is not necessary (difference to the function <code><a href="#topic+rtry_join_left">rtry_join_left</a></code> and <code><a href="#topic+rtry_join_outer">rtry_join_outer</a></code>):
the binding process simply puts the data side-by-side.
</p>


<h3>References</h3>

<p>This function makes use of the <code><a href="dplyr.html#topic+bind_cols">bind_cols</a></code> function within the <code>dplyr</code> package.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rtry_bind_row">rtry_bind_row</a></code>, <code><a href="#topic+rtry_join_left">rtry_join_left</a></code>, <code><a href="#topic+rtry_join_outer">rtry_join_outer</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Assuming a user has selected different columns as separated data tables
# and later on would like to combine them as one for further processing.
data1 &lt;- rtry_select_col(data_TRY_15160,
           ObsDataID, ObservationID, AccSpeciesID, AccSpeciesName, ValueKindName,
           TraitID, TraitName, DataID, DataName, OrigObsDataID, ErrorRisk, Comment)

data2 &lt;- rtry_select_col(data_TRY_15160,
           OriglName, OrigValueStr, OrigUnitStr, StdValue, UnitName)

data &lt;- rtry_bind_col(data1, data2)

# Expected messages:
# dim:   1782 12
# col:   ObsDataID ObservationID AccSpeciesID AccSpeciesName ValueKindName TraitID
#        TraitName DataID DataName OrigObsDataID ErrorRisk Comment
#
# dim:   1782 5
# col:   OriglName OrigValueStr OrigUnitStr StdValue UnitName
#
# dim:   1782 17
# col:   ObsDataID ObservationID AccSpeciesID AccSpeciesName ValueKindName TraitID
#        TraitName DataID DataName OrigObsDataID ErrorRisk Comment OriglName
#        OrigValueStr OrigUnitStr StdValue UnitName
</code></pre>

<hr>
<h2 id='rtry_bind_row'>Bind data by rows</h2><span id='topic+rtry_bind_row'></span>

<h3>Description</h3>

<p>This function takes a list of data frames or data tables and combines them by rows,
it adds the rows of the second data below the rows of the first one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtry_bind_row(..., showOverview = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtry_bind_row_+3A_...">...</code></td>
<td>
<p>A list of data frames or data tables to be combined by rows.</p>
</td></tr>
<tr><td><code id="rtry_bind_row_+3A_showoverview">showOverview</code></td>
<td>
<p>Default <code>TRUE</code> displays the dimension and column names of the combined data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the same type as the first input. The object will contain a column if that column
appears in any of the inputs.
</p>


<h3>Note</h3>

<p>A common attribute is not necessary (difference to the function <code><a href="#topic+rtry_join_left">rtry_join_left</a></code> and <code><a href="#topic+rtry_join_outer">rtry_join_outer</a></code>):
the binding process simply puts the data one after another while matching the column names, and any missing columns will be
filled with <code>NA</code>.
</p>


<h3>References</h3>

<p>This function makes use of the <code><a href="dplyr.html#topic+bind_rows">bind_rows</a></code> function within the <code>dplyr</code> package.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rtry_bind_col">rtry_bind_col</a></code>, <code><a href="#topic+rtry_join_left">rtry_join_left</a></code>, <code><a href="#topic+rtry_join_outer">rtry_join_outer</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Combine the two provided sample data (data_TRY_15160 and data_TRY_15161)
data &lt;- rtry_bind_row(data_TRY_15160, data_TRY_15161)

# Expected message:
# dim:   6409 28
# col:   LastName FirstName DatasetID Dataset SpeciesName AccSpeciesID AccSpeciesName
#        ObservationID ObsDataID TraitID TraitName DataID DataName OriglName
#        OrigValueStr OrigUnitStr ValueKindName OrigUncertaintyStr UncertaintyName
#        Replicates StdValue UnitName RelUncertaintyPercent OrigObsDataID ErrorRisk
#        Reference Comment V28
</code></pre>

<hr>
<h2 id='rtry_exclude'>Exclude (remove) data</h2><span id='topic+rtry_exclude'></span>

<h3>Description</h3>

<p>This function takes the input data frame or data table and excludes all records (rows)
with the same value in the attribute specified in the argument <code>baseOn</code> if the criteria
specified in the arguments for excluding (<code>...</code>) are fulfilled for one of those records.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtry_exclude(input, ..., baseOn, showOverview = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtry_exclude_+3A_input">input</code></td>
<td>
<p>Input data frame or data table.</p>
</td></tr>
<tr><td><code id="rtry_exclude_+3A_...">...</code></td>
<td>
<p>Criteria for excluding.</p>
</td></tr>
<tr><td><code id="rtry_exclude_+3A_baseon">baseOn</code></td>
<td>
<p>The attribute on which excluding is based on. If it is set to <code>ObservationID</code>,
the function excludes all records with the respective <code>ObservationID</code> if the
specified criteria for excluding is fulfilled for one record. Alternatively, use
<code>ObsDataID</code> to exclude only the record (row) for which the specified criterion
is fulfilled. Other reasonable parameter values are <code>TraitID</code>, <code>DataID</code>
or <code>AccSpeciesID</code>.</p>
</td></tr>
<tr><td><code id="rtry_exclude_+3A_showoverview">showOverview</code></td>
<td>
<p>Default <code>TRUE</code> displays the dimension of the data after excluding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the same type as the input data after excluding.
</p>


<h3>References</h3>

<p>This function makes use of the <code><a href="base.html#topic+subset">subset</a></code> function
within the <code>base</code> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Exclude observations on juvenile plants or unknown state:
# Identify observations where the plant developmental status (DataID 413) is either
# "juvenile" or "unknown", and exclude the whole observation
data_filtered &lt;- rtry_exclude(data_TRY_15160,
                   (DataID %in% 413) &amp; (OrigValueStr %in% c("juvenile", "unknown")),
                   baseOn = ObservationID)

# Expected message:
# dim:   1618 28

# Example 2: Exclude outliers:
# Identify the outliers, i.e. trait records where the ErrorRisk is larger than 4
# and exclude these records (not the whole observation)
data_filtered &lt;- rtry_exclude(data_TRY_15160,
                   ErrorRisk &gt; 4,
                   baseOn = ObsDataID)

# Expected message:
# dim:   1778 28

# Learn more applications of the excluding function via the vignette (Workflow for
# general data preprocessing using rtry): vignette("rtry-workflow-general").
</code></pre>

<hr>
<h2 id='rtry_explore'>Explore data</h2><span id='topic+rtry_explore'></span>

<h3>Description</h3>

<p>This function takes a data frame or data table and converts it into a grouped data frame of unique values
based on the specified column names. A column (<code>Count</code>) is added, which shows the number of records
within each group. The data are grouped by the first attribute if not specified with the argument <code>sortBy</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtry_explore(input, ..., sortBy = "", showOverview = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtry_explore_+3A_input">input</code></td>
<td>
<p>Data frame or data table, e.g. from <code>rtry_import()</code>.</p>
</td></tr>
<tr><td><code id="rtry_explore_+3A_...">...</code></td>
<td>
<p>Attribute names to group together.</p>
</td></tr>
<tr><td><code id="rtry_explore_+3A_sortby">sortBy</code></td>
<td>
<p>(Optional) Default <code>""</code> indicates no sorting is applied to the grouped data.
Specify the attribute name used to re-order the rows in ascending order.</p>
</td></tr>
<tr><td><code id="rtry_explore_+3A_showoverview">showOverview</code></td>
<td>
<p>Default <code>TRUE</code> displays the dimension of the result data table.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of unique values grouped and sorted by the specified attribute(s).
</p>


<h3>References</h3>

<p>This function makes use of the <code><a href="dplyr.html#topic+group_by">group_by</a></code>, <code><a href="dplyr.html#topic+summarise">summarise</a></code>
and <code><a href="dplyr.html#topic+arrange">arrange</a></code> functions within the <code>dplyr</code> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Explore the unique values in the provided sample data (data_TRY_15160)
# based on the attributes AccSpeciesID, AccSpeciesName, TraitID, TraitName, DataID
# and DataName, sorted by TraitID
data_explore &lt;- rtry_explore(data_TRY_15160,
                  AccSpeciesID, AccSpeciesName, TraitID, TraitName, DataID, DataName,
                  sortBy = TraitID)

# Expected message:
# dim:   235 7

# Learn more applications of the explore function via the vignette (Workflow for
# general data preprocessing using rtry): vignette("rtry-workflow-general").
</code></pre>

<hr>
<h2 id='rtry_export'>Export preprocessed data</h2><span id='topic+rtry_export'></span>

<h3>Description</h3>

<p>This function exports the preprocessed data as comma separated values to a <code>.csv</code> file.
If the specified output directory does not exist, it will be created.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtry_export(data, output, quote = TRUE, encoding = "UTF-8")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtry_export_+3A_data">data</code></td>
<td>
<p>The data to be saved.</p>
</td></tr>
<tr><td><code id="rtry_export_+3A_output">output</code></td>
<td>
<p>Output path.</p>
</td></tr>
<tr><td><code id="rtry_export_+3A_quote">quote</code></td>
<td>
<p>Default <code>TRUE</code> inserts double quotes around any character or factor columns.</p>
</td></tr>
<tr><td><code id="rtry_export_+3A_encoding">encoding</code></td>
<td>
<p>Default <code>"UTF-8"</code>. File encoding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for exporting a <code>.csv</code> file.
</p>


<h3>References</h3>

<p>This function makes use of the <code><a href="utils.html#topic+write.csv">write.csv</a></code> function
within the <code>utils</code> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Export the preprocessed data to a specific location
rtry_export(data_TRY_15160, file.path(tempdir(), "TRYdata_unprocessed.csv"))

# Expected message:
# File saved at: C:\Users\user\AppData\Local\Temp\Rtmp4wJAvQ/TRYdata_unprocessed.csv
</code></pre>

<hr>
<h2 id='rtry_geocoding'>Perform geocoding</h2><span id='topic+rtry_geocoding'></span>

<h3>Description</h3>

<p>This function uses <a href="https://wiki.openstreetmap.org/wiki/Nominatim">Nominatim</a>,
a search engine for OpenStreetMap (OSM) data, to perform geocoding,
i.e. converting an address into coordinates (latitudes, longitudes).
The data provided by OSM is free to use for any purpose, including commercial use,
and is governed by the distribution license <a href="https://wiki.osmfoundation.org/wiki/Licence">ODbL</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtry_geocoding(address, email)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtry_geocoding_+3A_address">address</code></td>
<td>
<p>String of an address.</p>
</td></tr>
<tr><td><code id="rtry_geocoding_+3A_email">email</code></td>
<td>
<p>String of an email address.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame that contains latitudes (lat) and longitudes (lon) in WGS84 projection.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rtry_revgeocoding">rtry_revgeocoding</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Convert the address of MPI-BGC ("Hans-Knoell-Strasse 10, 07745 Jena, Germany")
# into coordinates in latitudes and longitudes
# Note: Please change to your own email address when executing this function
rtry_geocoding("Hans-Knoell-Strasse 10, 07745 Jena, Germany",
   email = "john.doe@example.com")

# Expected message:
#        lat      lon
# 1 50.9101 11.56674

## End(Not run)

# Learn to perform geocoding to a list of locations via the vignette (Workflow for
# geocoding using rtry): vignette("rtry-workflow-geocoding").
</code></pre>

<hr>
<h2 id='rtry_import'>Import data</h2><span id='topic+rtry_import'></span>

<h3>Description</h3>

<p>This function imports a data file as a <code>data.table</code> for further processing.
The default arguments are set to import tabulartor delimited data files in text
format (<code>.txt</code>) exported from the TRY database. It can also be used to
import other file formats, such as <code>.csv</code> files with comma separated values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtry_import(
  input,
  separator = "\t",
  encoding = "Latin-1",
  quote = "",
  showOverview = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtry_import_+3A_input">input</code></td>
<td>
<p>Path to the data file.</p>
</td></tr>
<tr><td><code id="rtry_import_+3A_separator">separator</code></td>
<td>
<p>Default <code>"\t"</code> for the TRY data output. Data separator.</p>
</td></tr>
<tr><td><code id="rtry_import_+3A_encoding">encoding</code></td>
<td>
<p>Default <code>"Latin-1"</code>. File encoding.</p>
</td></tr>
<tr><td><code id="rtry_import_+3A_quote">quote</code></td>
<td>
<p>Default <code>""</code> reads the fields as is.
If the fields in the data file are by a double quote, use <code>"\""</code> instead.</p>
</td></tr>
<tr><td><code id="rtry_import_+3A_showoverview">showOverview</code></td>
<td>
<p>Default <code>TRUE</code> displays the input path, the dimension and
the column names of the imported data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.table</code>.
</p>


<h3>References</h3>

<p>This function makes use of the <code><a href="data.table.html#topic+fread">fread</a></code> function
within the <code>data.table</code> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Import data exported from the TRY database
# Specify file path to the raw data provided within the rtry package
input_path &lt;- system.file("testdata", "data_TRY_15160.txt", package = "rtry")

# For own data and Windows users the path might rather look similar to this:
# input_path &lt;- "C:/Users/User/Desktop/data_TRY_15160.txt"

# Import data file using rtry_import
input &lt;- rtry_import(input_path)

# Explicit notation:
# input &lt;- rtry_import(input_path, separator = "\t", encoding = "Latin-1",
#            quote = "", showOverview = TRUE)

# Expected message:
# input: ~/R/R-4.0.5/library/rtry/testdata/data_TRY_15160.txt
# dim:   1782 28
# col:   LastName FirstName DatasetID Dataset SpeciesName AccSpeciesID AccSpeciesName
#        ObservationID ObsDataID TraitID TraitName DataID DataName OriglName
#        OrigValueStr OrigUnitStr ValueKindName OrigUncertaintyStr UncertaintyName
#        Replicates StdValue UnitName RelUncertaintyPercent OrigObsDataID ErrorRisk
#        Reference Comment V28

# Example 2: Import CSV file
# Specify file path to the raw data provided within the rtry package
input_path &lt;- system.file("testdata", "data_locations.csv", package = "rtry")

# Import data file using rtry_import
input &lt;- rtry_import(input_path, separator = ",", encoding = "UTF-8",
           quote = "\"", showOverview = TRUE)

# Expected message:
# input: ~/R/R-4.0.5/library/rtry/testdata/data_locations.csv
# dim:   20 3
# col:   Country code Country Location
</code></pre>

<hr>
<h2 id='rtry_join_left'>Left join for two data frames</h2><span id='topic+rtry_join_left'></span>

<h3>Description</h3>

<p>This function merges two data frames or data tables based on a specified common column and
returns all records from the left data frame (<code>x</code>) together with the matched records
from the right data frame (<code>y</code>), while discards all the records in the right data frame
that does not exist in the left data frame. In other words, this function performs a left join
on the two provided data frames or data tables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtry_join_left(x, y, baseOn, showOverview = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtry_join_left_+3A_x">x</code></td>
<td>
<p>A data frame or data table to be coerced and will be considered as the data on the left.</p>
</td></tr>
<tr><td><code id="rtry_join_left_+3A_y">y</code></td>
<td>
<p>A data frame or data table to be coerced and will be considered as the data on the right.</p>
</td></tr>
<tr><td><code id="rtry_join_left_+3A_baseon">baseOn</code></td>
<td>
<p>The common column used for merging.</p>
</td></tr>
<tr><td><code id="rtry_join_left_+3A_showoverview">showOverview</code></td>
<td>
<p>Default <code>TRUE</code> displays the dimension and column names of the merged data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the same type of the input data. The merged data is by default lexicographically sorted
on the common column. The columns are the common column followed by the remaining columns in
<code>x</code> and then those in <code>y</code>.
</p>


<h3>References</h3>

<p>This function makes use of the <code><a href="base.html#topic+merge">merge</a></code> function
within the <code>base</code> package.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rtry_join_outer">rtry_join_outer</a></code>, <code><a href="#topic+rtry_bind_col">rtry_bind_col</a></code>, <code><a href="#topic+rtry_bind_row">rtry_bind_row</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Assume a user has obtained two unique data tables, one with the ancillary data
# Longitude and one with Latitude (e.g. using rtry_select_anc()), and would like to
# add a column Latitude to the data table with Longitude based on the common
# identifier ObservationID
lon &lt;- rtry_select_anc(data_TRY_15160, 60)
lat &lt;- rtry_select_anc(data_TRY_15160, 59)

georef &lt;- rtry_join_left(lon, lat, baseOn = ObservationID)

# Expected messages:
# dim:   97 2
# col:   ObservationID Longitude
#
# dim:   98 2
# col:   ObservationID Latitude
#
# dim:   97 3
# col:   ObservationID Longitude Latitude
</code></pre>

<hr>
<h2 id='rtry_join_outer'>Outer join for two data frames</h2><span id='topic+rtry_join_outer'></span>

<h3>Description</h3>

<p>This function merges two data frames or data tables based on a specified common column and
returns all rows from both data, join records from the left (<code>x</code>) which have matching
keys in the right data frame (<code>y</code>). In order words, this functions performs an outer
join on the two provided data frames, i.e. the join table will contain all records from
both data frames or data tables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtry_join_outer(x, y, baseOn, showOverview = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtry_join_outer_+3A_x">x</code></td>
<td>
<p>A data frame or data table to be coerced and will be considered as the data on the left.</p>
</td></tr>
<tr><td><code id="rtry_join_outer_+3A_y">y</code></td>
<td>
<p>A data frame or data table to be coerced and will be considered as the data on the right.</p>
</td></tr>
<tr><td><code id="rtry_join_outer_+3A_baseon">baseOn</code></td>
<td>
<p>The common column used for merging.</p>
</td></tr>
<tr><td><code id="rtry_join_outer_+3A_showoverview">showOverview</code></td>
<td>
<p>Default <code>TRUE</code> displays the dimension and column names of the merged data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the same type of the input data. The merged data is by default lexicographically sorted
on the common column. The columns are the common column followed by the remaining columns in
<code>x</code> and then those in <code>y</code>.
</p>


<h3>References</h3>

<p>This function makes use of the <code><a href="base.html#topic+merge">merge</a></code> function
within the <code>base</code> package.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rtry_join_left">rtry_join_left</a></code>, <code><a href="#topic+rtry_bind_col">rtry_bind_col</a></code>, <code><a href="#topic+rtry_bind_row">rtry_bind_row</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Assume a user has obtained two unique data tables, one with the ancillary data
# Longitude and one with Latitude (e.g. using rtry_select_anc()), and would like to
# merge two data tables into one according to the common identifier ObservationID.
# It does not matter if either Longitude or Latitude data has no record
lon &lt;- rtry_select_anc(data_TRY_15160, 60)
lat &lt;- rtry_select_anc(data_TRY_15160, 59)

georef &lt;- rtry_join_outer(lon, lat, baseOn = ObservationID)

# Expected messages:
# dim:   97 2
# col:   ObservationID Longitude
#
# dim:   98 2
# col:   ObservationID Latitude
#
# dim:   98 3
# col:   ObservationID Longitude Latitude
</code></pre>

<hr>
<h2 id='rtry_remove_col'>Remove columns</h2><span id='topic+rtry_remove_col'></span>

<h3>Description</h3>

<p>This function removes specified columns from the imported data for further processing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtry_remove_col(input, ..., showOverview = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtry_remove_col_+3A_input">input</code></td>
<td>
<p>Input data frame or data table.</p>
</td></tr>
<tr><td><code id="rtry_remove_col_+3A_...">...</code></td>
<td>
<p>Names of columns to be removed separated by commas. The operator <code>:</code>
can be used for selecting a range of consecutive variables.</p>
</td></tr>
<tr><td><code id="rtry_remove_col_+3A_showoverview">showOverview</code></td>
<td>
<p>Default <code>TRUE</code> displays the dimension of the remaining data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the same type as the input data.
</p>


<h3>References</h3>

<p>This function makes use of the <code><a href="dplyr.html#topic+select">select</a></code> function
within the <code>dplyr</code> package.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rtry_select_col">rtry_select_col</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Remove certain columns from the provided sample data (data_TRY_15160)
data_rm_col &lt;- rtry_remove_col(data_TRY_15160,
                 LastName, FirstName, DatasetID, Dataset, SpeciesName,
                 OrigUncertaintyStr, UncertaintyName, Replicates,
                 RelUncertaintyPercent, Reference, V28)

# Expected message:
# dim:   1782 17
# col:   AccSpeciesID AccSpeciesName ObservationID ObsDataID TraitID TraitName
#        DataID DataName OriglName OrigValueStr OrigUnitStr ValueKindName
#        StdValue UnitName OrigObsDataID ErrorRisk Comment
</code></pre>

<hr>
<h2 id='rtry_remove_dup'>Remove duplicates in data</h2><span id='topic+rtry_remove_dup'></span>

<h3>Description</h3>

<p>This function removes the duplicates from the input data using the duplicate identifier
<code>OrigObsDataID</code> provided within the TRY data. Once the function is called and executed,
the number of duplicates removed will be displayed on the console as reference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtry_remove_dup(input, showOverview = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtry_remove_dup_+3A_input">input</code></td>
<td>
<p>Input data frame or data table.</p>
</td></tr>
<tr><td><code id="rtry_remove_dup_+3A_showoverview">showOverview</code></td>
<td>
<p>Default <code>TRUE</code> displays the the dimension of the data after removing the duplicates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the same type as the input data after removing the duplicates.
</p>


<h3>Note</h3>

<p>This function depends on the duplicate identifier <code>OrigObsDataID</code> listed
in the data exported from the TRY database, therefore, if the column <code>OrigObsDataID</code>
has been removed, this function will not work. Also, if the original value of an
indicated duplicate is a restricted value, which has not been requested from
the TRY database (if only public data were requested), the duplicate will be
removed and this may result in data loss.
</p>


<h3>References</h3>

<p>This function makes use of the <code><a href="base.html#topic+subset">subset</a></code> function
within the <code>base</code> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Remove the duplicates within the provided sample data (data_TRY_15160)
data_rm_dup &lt;- rtry_remove_dup(data_TRY_15160)

# Expected message:
# 45 duplicates removed.
# dim:   1737 28
</code></pre>

<hr>
<h2 id='rtry_revgeocoding'>Perform reverse geocoding</h2><span id='topic+rtry_revgeocoding'></span>

<h3>Description</h3>

<p>This function uses <a href="https://wiki.openstreetmap.org/wiki/Nominatim">Nominatim</a>,
a search engine for OpenStreetMap data, to perform reverse geocoding,
i.e. converting coordinates (latitudes, longitudes) into an address.
The data provided by OSM is free to use for any purpose, including commercial use,
and is governed by the distribution license <a href="https://wiki.osmfoundation.org/wiki/Licence">ODbL</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtry_revgeocoding(lat_lon, email)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtry_revgeocoding_+3A_lat_lon">lat_lon</code></td>
<td>
<p>A data frame containing latitude and longitude in WGS84 projection.</p>
</td></tr>
<tr><td><code id="rtry_revgeocoding_+3A_email">email</code></td>
<td>
<p>String of an email address.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame that contains address.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rtry_geocoding">rtry_geocoding</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Convert the coordinates of MPI-BGC (50.9101, 11.56674) into an address
# Note: Please change to your own email address when executing this function
rtry_revgeocoding(data.frame(50.9101, 11.56674),
  email = "john.doe@example.com")

# Expected message:
#               full_address town city country country_code
# 1 Jena, Thuringia, Germany   NA Jena Germany           de

## End(Not run)

# Learn to perform reverse geocoding to a list of coordinates via the vignette
# (Workflow for geocoding using rtry): vignette("rtry-workflow-geocoding").
</code></pre>

<hr>
<h2 id='rtry_select_anc'>Select ancillary data in wide table format</h2><span id='topic+rtry_select_anc'></span>

<h3>Description</h3>

<p>This function selects one specified ancillary data together with the <code>ObservationID</code>
from the imported data and transforms it into a wide table format for further processing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtry_select_anc(input, ..., showOverview = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtry_select_anc_+3A_input">input</code></td>
<td>
<p>Input data frame or data table.</p>
</td></tr>
<tr><td><code id="rtry_select_anc_+3A_...">...</code></td>
<td>
<p>The IDs of the ancillary data (<code>DataID</code> in the TRY data) to be selected.</p>
</td></tr>
<tr><td><code id="rtry_select_anc_+3A_showoverview">showOverview</code></td>
<td>
<p>Default <code>TRUE</code> displays the dimension and column names of the selected data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the same type as the input data.
</p>


<h3>References</h3>

<p>This function makes use of the <code><a href="base.html#topic+subset">subset</a></code> and <code><a href="dplyr.html#topic+distinct">distinct</a></code> functions
within the <code>base</code> and <code>dplyr</code> packages respectively. It also uses the functions
<code><a href="#topic+rtry_select_col">rtry_select_col</a></code> and <code><a href="#topic+rtry_remove_col">rtry_remove_col</a></code>, as well as the function
<code><a href="#topic+rtry_join_outer">rtry_join_outer</a></code> to select and combine the extracted ancillary data with the <code>ObservationID</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Obtain a list of ObservationID and the corresponding ancillary data of interest
# using the specified DataID (e.g. DataID 60 for longitude and 59 for latitude) from
# the provided sample data (e.g. data_TRY_15160)
georef &lt;- rtry_select_anc(data_TRY_15160, 60, 59)

# Expected message:
# dim:   98 3
# col:   ObservationID Longitude Latitude


# Obtain a list of ObservationID and one corresponding ancillary data of interest
# using the specified DataID (e.g. DataID 61 for altitude) from the provided sample
# data (e.g. data_TRY_15160)
alt &lt;- rtry_select_anc(data_TRY_15160, 61)

# Expected message:
# dim:   23 2
# col:   ObservationID Altitude
</code></pre>

<hr>
<h2 id='rtry_select_col'>Select columns</h2><span id='topic+rtry_select_col'></span>

<h3>Description</h3>

<p>This function selects the specified columns from the input data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtry_select_col(input, ..., showOverview = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtry_select_col_+3A_input">input</code></td>
<td>
<p>Input data frame or data table.</p>
</td></tr>
<tr><td><code id="rtry_select_col_+3A_...">...</code></td>
<td>
<p>Column names to be selected.</p>
</td></tr>
<tr><td><code id="rtry_select_col_+3A_showoverview">showOverview</code></td>
<td>
<p>Default <code>TRUE</code> displays the dimension and column names of the selected columns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the same type as the input data.
</p>


<h3>References</h3>

<p>This function makes use of the <code><a href="dplyr.html#topic+select">select</a></code> function
within the <code>dplyr</code> package.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rtry_remove_col">rtry_remove_col</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Select certain columns from the provided sample data (data_TRY_15160)
data_selected &lt;- rtry_select_col(data_TRY_15160,
                   ObsDataID, ObservationID, AccSpeciesID, AccSpeciesName,
                   ValueKindName, TraitID, TraitName, DataID, DataName, OriglName,
                   OrigValueStr, OrigUnitStr, StdValue, UnitName, OrigObsDataID,
                   ErrorRisk, Comment)

# Expected message:
# dim:   1782 17
# col:   ObsDataID ObservationID AccSpeciesID AccSpeciesName ValueKindName TraitID
#        TraitName DataID DataName OriglName OrigValueStr OrigUnitStr StdValue
#        UnitName OrigObsDataID ErrorRisk Comment
</code></pre>

<hr>
<h2 id='rtry_select_row'>Select rows</h2><span id='topic+rtry_select_row'></span>

<h3>Description</h3>

<p>This function selects rows based on specified criteria
and the corresponding <code>ObservationID</code> from the imported data for further processing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtry_select_row(
  input,
  ...,
  getAncillary = FALSE,
  rmDuplicates = FALSE,
  showOverview = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtry_select_row_+3A_input">input</code></td>
<td>
<p>Input data frame or data table.</p>
</td></tr>
<tr><td><code id="rtry_select_row_+3A_...">...</code></td>
<td>
<p>Criteria for row selection.</p>
</td></tr>
<tr><td><code id="rtry_select_row_+3A_getancillary">getAncillary</code></td>
<td>
<p>Default <code>FALSE</code>, set to <code>TRUE</code> selects all ancillary data based on the row selection criteria.</p>
</td></tr>
<tr><td><code id="rtry_select_row_+3A_rmduplicates">rmDuplicates</code></td>
<td>
<p>Default <code>FALSE</code>, set to <code>TRUE</code> calls the function <code><a href="#topic+rtry_remove_dup">rtry_remove_dup</a></code>.</p>
</td></tr>
<tr><td><code id="rtry_select_row_+3A_showoverview">showOverview</code></td>
<td>
<p>Default <code>TRUE</code> displays the dimension of the data after row selection.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the same type as the input data.
</p>


<h3>Note</h3>

<p>This function by default filters data based on the unique identifier <code>ObservationID</code>
listed in the TRY data, therefore, if the column <code>ObservationID</code> has been removed,
this function will not work.
</p>


<h3>References</h3>

<p>This function makes use of the <code><a href="base.html#topic+unique">unique</a></code> and <code><a href="base.html#topic+subset">subset</a></code> functions
within the <code>base</code> package. It also uses the function <code><a href="#topic+rtry_remove_dup">rtry_remove_dup</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Within the provided sample data (data_TRY_15160) select the georeferenced traits
# records together with records for Latitude and Longitude (DataID 59 and 60) and
# exclude duplicate trait records
data_selected &lt;- rtry_select_row(data_TRY_15160,
                   (TraitID &gt; 0) | (DataID %in% c(59, 60)),
                   getAncillary = TRUE,
                   rmDuplicates = TRUE)

# Expected message:
# 45 duplicates removed.
# dim:   1737 28
</code></pre>

<hr>
<h2 id='rtry_trans_wider'>Transform data from long to wide table</h2><span id='topic+rtry_trans_wider'></span>

<h3>Description</h3>

<p>This function transforms the original long table format of the data into a wide table format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtry_trans_wider(
  input,
  names_from = NULL,
  values_from = NULL,
  values_fn = NULL,
  showOverview = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtry_trans_wider_+3A_input">input</code></td>
<td>
<p>Input data frame or data table.</p>
</td></tr>
<tr><td><code id="rtry_trans_wider_+3A_names_from">names_from</code></td>
<td>
<p>The column(s) from which the output column names to be obtained.</p>
</td></tr>
<tr><td><code id="rtry_trans_wider_+3A_values_from">values_from</code></td>
<td>
<p>The column(s) from which the output values to be obtained.</p>
</td></tr>
<tr><td><code id="rtry_trans_wider_+3A_values_fn">values_fn</code></td>
<td>
<p>(Optional) Function to be applied to the output values.</p>
</td></tr>
<tr><td><code id="rtry_trans_wider_+3A_showoverview">showOverview</code></td>
<td>
<p>Default <code>TRUE</code> displays the dimension of the wide table.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of the transformed wide table.
</p>


<h3>References</h3>

<p>This function makes use of the <code><a href="tidyr.html#topic+pivot_wider">pivot_wider</a></code> function
within the <code>tidyr</code> package.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rtry_select_row">rtry_select_row</a></code>, <code><a href="#topic+rtry_select_col">rtry_select_col</a></code>, <code><a href="#topic+rtry_select_anc">rtry_select_anc</a></code>,
<code><a href="#topic+rtry_join_left">rtry_join_left</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Provide the standardized trait values per observation, together with species names
# and the georeferences of the sampling site (Latitude and Longtude), if availalbe,
# in a wide table format. Several steps are necessary:

# 1. Select only the trait records that have standardized numeric values.
#    The complete.cases() is used to ensure the cases are complete, i.e. have no
#    missing values.
num_traits &lt;- rtry_select_row(data_TRY_15160,
                complete.cases(TraitID) &amp; complete.cases(StdValue))

# 2. Select the relevant columns for transformation.
num_traits &lt;- rtry_select_col(num_traits,
                ObservationID, AccSpeciesID, AccSpeciesName, TraitID, TraitName,
                StdValue, UnitName)

# 3. Extract the values of georeferences and the corresponding ObservationID.
lat &lt;- rtry_select_anc(data_TRY_15160, 59)
lon &lt;- rtry_select_anc(data_TRY_15160, 60)

# 4. Merge the relevant data frames based on the ObservationID using rtry_join_left().
num_traits_georef &lt;- rtry_join_left(num_traits, lat, baseOn = ObservationID)
num_traits_georef &lt;- rtry_join_left(num_traits_georef, lon, baseOn = ObservationID)

# 5. Perform wide table transformation of TraitID, TraitName and UnitName based on
#    ObservationID, AccSpeciesID and AccSpeciesName with cell values from StdValue.
#    If several records with StdValue were provided for one trait with the same
#    ObservationID, AccSpeciesID and AccSpeciesName, calculate their mean.
num_traits_georef_wider &lt;- rtry_trans_wider(num_traits_georef,
                             names_from = c(TraitID, TraitName, UnitName),
                             values_from = c(StdValue),
                             values_fn = list(StdValue = mean))

# Expected messages:
# dim:   150 28
# dim:   150 7
# col:   ObservationID AccSpeciesID AccSpeciesName TraitID TraitName
#        StdValue UnitName
#
# dim:   98 2
# col:   ObservationID Latitude
#
# dim:   97 2
# col:   ObservationID Longitude
#
# dim:   150 8
# col:   ObservationID AccSpeciesID AccSpeciesName TraitID TraitName
#        StdValue UnitName Latitude
#
# dim:   150 9
# col:   ObservationID AccSpeciesID AccSpeciesName TraitID TraitName
#        StdValue UnitName Latitude Longitude
#
# dim:   146 7

# Learn more via the vignette (Workflow for general data preprocessing using rtry):
# vignette("rtry-workflow-general")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
