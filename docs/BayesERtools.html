<!DOCTYPE html><html lang="en"><head><title>Help for package BayesERtools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BayesERtools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BayesERtools-package'><p>BayesERtools: Bayesian Exposure-Response Analysis Tools</p></a></li>
<li><a href='#as_draws'><p>Transform to <code>draws</code> objects</p></a></li>
<li><a href='#build_spec_coveff'><p>Build specifications for covariate effect simulation/visualization</p></a></li>
<li><a href='#calc_ersim_med_qi'><p>Calculate median and quantile intervals from ersim object</p></a></li>
<li><a href='#d_sim_binom_cov'><p>Sample simulated data for exposure-response with binary endpoint.</p></a></li>
<li><a href='#d_sim_lin'><p>Sample simulated data for exposure-response with continuous endpoint</p>
using linear model.</a></li>
<li><a href='#dev_ermod_bin'><p>Develop linear ER model for binary or continuous endpoint</p></a></li>
<li><a href='#dev_ermod_bin_cov_functions'><p>Internal functions for developing an ER model with covariates</p>
for binary endpoint</a></li>
<li><a href='#dev_ermod_bin_cov_sel'><p>Perform covariate selection for linear ER model</p></a></li>
<li><a href='#dev_ermod_bin_exp_sel'><p>Exposure metrics selection for linear ER models</p></a></li>
<li><a href='#dev_ermod_emax'><p>Develop Emax model for continuous and binary endpoint</p></a></li>
<li><a href='#dev_ermod_emax_exp_sel'><p>Exposure metrics selection for Emax models</p></a></li>
<li><a href='#edit_spec_coveff'><p>Customize specifications for covariate effect simulations/visualizations</p></a></li>
<li><a href='#ermod_cov_sel_method'><p>S3 methods for the classes <code>ermod_bin_cov_sel</code></p></a></li>
<li><a href='#ermod_exp_sel_method'><p>S3 methods for the classes <code>ermod_exp_sel</code></p></a></li>
<li><a href='#ermod_method'><p>S3 methods for the classes <code>ermod_*</code></p></a></li>
<li><a href='#ersim_method'><p>S3 methods for the classes <code style="white-space: pre;">&#8288;ersim_*&#8288;</code> and <code style="white-space: pre;">&#8288;ersim_med_qi_*&#8288;</code></p></a></li>
<li><a href='#eval_ermod'><p>Evaluate exposure-response model prediction performance</p></a></li>
<li><a href='#extract_coef_exp_ci'><p>Extract credible interval of the exposure coefficient</p></a></li>
<li><a href='#extract_ermod'><p>Extract elements from an object of class <code>ermod_*</code></p></a></li>
<li><a href='#extract_ersim'><p>Extract elements from objects of the classes <code style="white-space: pre;">&#8288;ersim_*&#8288;</code> and 'ersim_med_qi_*&ldquo;</p></a></li>
<li><a href='#extract_method'><p>Extract elements from S3 objects</p></a></li>
<li><a href='#loo'><p>Efficient approximate leave-one-out cross-validation (LOO)</p></a></li>
<li><a href='#p_direction'><p>Probability of Direction (pd)</p></a></li>
<li><a href='#plot_cov_sel'><p>Plot variable selection performance</p></a></li>
<li><a href='#plot_coveff'><p>Visualize the covariate effects for ER model</p></a></li>
<li><a href='#plot_er'><p>Plot ER model simulations</p></a></li>
<li><a href='#plot_er_exp_sel'><p>Plot exposure metric selection comparison</p></a></li>
<li><a href='#plot_er_gof'><p>Default GOF plot for ER model</p></a></li>
<li><a href='#print_coveff'><p>Format the covariate effect simulation results for printing</p></a></li>
<li><a href='#run_kfold_cv'><p>Run k-fold cross-validation</p></a></li>
<li><a href='#sim_coveff'><p>Perform simulation of covariate effects for ER model</p></a></li>
<li><a href='#sim_er'><p>Simulate from ER model</p></a></li>
<li><a href='#sim_er_new_exp'><p>Simulate from ER model at specified exposure values</p></a></li>
<li><a href='#sim_er_new_exp_marg'><p>Calculate marginal expected response for specified exposure values</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Exposure-Response Analysis Tools</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kenta Yoshida &lt;yoshida.kenta.6@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Suite of tools that facilitate
    exposure-response analysis using Bayesian methods. The package
    provides a streamlined workflow for fitting types of models that are
    commonly used in exposure-response analysis - linear and Emax for continuous
    endpoints, logistic linear and logistic Emax for binary endpoints, as well
    as performing simulation and visualization. Learn more about the workflow
    at <a href="https://genentech.github.io/BayesERbook/">https://genentech.github.io/BayesERbook/</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://genentech.github.io/BayesERtools/">https://genentech.github.io/BayesERtools/</a>,
<a href="https://genentech.github.io/BayesERbook/">https://genentech.github.io/BayesERbook/</a></td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, tidyr, purrr, ggplot2, gt, cli, rlang, rstanarm,
rstanemax (&ge; 0.1.8), loo, tidybayes, bayestestR, posterior</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), covr, knitr, rmarkdown, rstan,
htmltools, digest, ggforce, xgxr, scales, readr, patchwork,
projpred, rsample, yardstick</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-12 07:36:30 UTC; yoshidk6</td>
</tr>
<tr>
<td>Author:</td>
<td>Kenta Yoshida <a href="https://orcid.org/0000-0003-4967-3831"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  François Mercier <a href="https://orcid.org/0000-0002-5685-1408"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Genentech, Inc. [cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-12 11:40:22 UTC</td>
</tr>
</table>
<hr>
<h2 id='BayesERtools-package'>BayesERtools: Bayesian Exposure-Response Analysis Tools</h2><span id='topic+BayesERtools'></span><span id='topic+BayesERtools-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Suite of tools that facilitate exposure-response analysis using Bayesian methods. The package provides a streamlined workflow for fitting types of models that are commonly used in exposure-response analysis - linear and Emax for continuous endpoints, logistic linear and logistic Emax for binary endpoints, as well as performing simulation and visualization. Learn more about the workflow at <a href="https://genentech.github.io/BayesERbook/">https://genentech.github.io/BayesERbook/</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Kenta Yoshida <a href="mailto:yoshida.kenta.6@gmail.com">yoshida.kenta.6@gmail.com</a> (<a href="https://orcid.org/0000-0003-4967-3831">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> François Mercier <a href="mailto:francois.mercier@roche.com">francois.mercier@roche.com</a> (<a href="https://orcid.org/0000-0002-5685-1408">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Genentech, Inc. [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://genentech.github.io/BayesERtools/">https://genentech.github.io/BayesERtools/</a>
</p>
</li>
<li> <p><a href="https://genentech.github.io/BayesERbook/">https://genentech.github.io/BayesERbook/</a>
</p>
</li></ul>


<hr>
<h2 id='as_draws'>Transform to <code>draws</code> objects</h2><span id='topic+as_draws'></span><span id='topic+as_draws_list'></span><span id='topic+as_draws_array'></span><span id='topic+as_draws_df'></span><span id='topic+as_draws_matrix'></span><span id='topic+as_draws_rvars'></span><span id='topic+as_draws.ermod'></span><span id='topic+as_draws_list.ermod'></span><span id='topic+as_draws_array.ermod'></span><span id='topic+as_draws_df.ermod'></span><span id='topic+as_draws_matrix.ermod'></span><span id='topic+as_draws_rvars.ermod'></span>

<h3>Description</h3>

<p>See <code><a href="posterior.html#topic+draws">posterior::as_draws()</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_draws(x, ...)

as_draws_list(x, ...)

as_draws_array(x, ...)

as_draws_df(x, ...)

as_draws_matrix(x, ...)

as_draws_rvars(x, ...)

## S3 method for class 'ermod'
as_draws(x, ...)

## S3 method for class 'ermod'
as_draws_list(x, ...)

## S3 method for class 'ermod'
as_draws_array(x, ...)

## S3 method for class 'ermod'
as_draws_df(x, ...)

## S3 method for class 'ermod'
as_draws_matrix(x, ...)

## S3 method for class 'ermod'
as_draws_rvars(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_draws_+3A_x">x</code></td>
<td>
<p>An object of class <code>ermod</code></p>
</td></tr>
<tr><td><code id="as_draws_+3A_...">...</code></td>
<td>
<p>Arguments passed to individual methods (if applicable).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A draws object from the <code>posterior</code> package.
</p>

<hr>
<h2 id='build_spec_coveff'>Build specifications for covariate effect simulation/visualization</h2><span id='topic+build_spec_coveff'></span>

<h3>Description</h3>

<p>Build specifications for covariate effect simulation/visualization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_spec_coveff(
  ermod,
  data = NULL,
  qi_width_cov = 0.9,
  n_sigfig = 3,
  use_seps = TRUE,
  drop_trailing_dec_mark = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="build_spec_coveff_+3A_ermod">ermod</code></td>
<td>
<p>an object of class <code>ermod</code></p>
</td></tr>
<tr><td><code id="build_spec_coveff_+3A_data">data</code></td>
<td>
<p>an optional data frame to derive the covariate values for
forest plots. If NULL (default), the data used to fit the model is used.</p>
</td></tr>
<tr><td><code id="build_spec_coveff_+3A_qi_width_cov">qi_width_cov</code></td>
<td>
<p>the width of the quantile interval for continuous
covariates in the forest plot. Default is 0.9 (i.e. visualize effect of
covariate effect at their 5th and 95th percentile values).</p>
</td></tr>
<tr><td><code id="build_spec_coveff_+3A_n_sigfig">n_sigfig</code></td>
<td>
<p>Number of significant figures to form value_label of
continuous variables. See <code><a href="gt.html#topic+vec_fmt_number">gt::vec_fmt_number()</a></code> for details.</p>
</td></tr>
<tr><td><code id="build_spec_coveff_+3A_use_seps">use_seps</code></td>
<td>
<p>Whether to use separators for thousands in printing numbers.
See <code><a href="gt.html#topic+vec_fmt_number">gt::vec_fmt_number()</a></code> for details.</p>
</td></tr>
<tr><td><code id="build_spec_coveff_+3A_drop_trailing_dec_mark">drop_trailing_dec_mark</code></td>
<td>
<p>Whether to drop the trailing decimal mark
(&quot;.&quot;) in value_label of continuous variables. See <code><a href="gt.html#topic+vec_fmt_number">gt::vec_fmt_number()</a></code>
for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>spec_coveff</code> (return object) is a data frame for the specification
of the covariate effects to be visualized. This is internally generated by
<code><a href="#topic+build_spec_coveff">build_spec_coveff()</a></code> if you run <code><a href="#topic+sim_coveff">sim_coveff()</a></code> or <code><a href="#topic+plot_coveff">plot_coveff()</a></code>
directly. Alternatively, you can develop your own or modify the one
generated by <code><a href="#topic+build_spec_coveff">build_spec_coveff()</a></code> and supply it to <code><a href="#topic+sim_coveff">sim_coveff()</a></code> or
<code><a href="#topic+plot_coveff">plot_coveff()</a></code>. The data frame should have the following columns (but
it's probably easier to try <code><a href="#topic+build_spec_coveff">build_spec_coveff()</a></code> and see the structure):
</p>

<ul>
<li> <p><code>var_order</code>: The order of the covariate in the forest plot. The exposure
variable is always the first one and the covariates are ordered by the
order they are supplied in the <code>var_cov</code> argument of the <code style="white-space: pre;">&#8288;dev_ermod_*&#8288;</code>
function. If you used a model from <code><a href="#topic+dev_ermod_bin_cov_sel">dev_ermod_bin_cov_sel()</a></code>, then the
order is determined by the variable selection process.
</p>
</li>
<li> <p><code>var_name</code>: The name of the variable.
</p>
</li>
<li> <p><code>var_label</code>: The label of the variable to be used for plot.
This is the same as <code>var_name</code> by default.
</p>
</li>
<li> <p><code>value_order</code>: The order of the value of the variable to be evaluated.
</p>
</li>
<li> <p><code>value_annot</code>: The annotation of the value of the variable to be
evaluated. This appears on the right hand side of the forest plot.
</p>
</li>
<li> <p><code>value_label</code>: The label of the value of the variable to be evaluated.
</p>
</li>
<li> <p><code>value_cont</code>: The value for continuous variables.
</p>
</li>
<li> <p><code>value_cat</code>: The value for categorical variables.
</p>
</li>
<li> <p><code>is_ref_value</code>: Whether the value is the reference value.
</p>
</li>
<li> <p><code>show_ref_value</code>: Whether to show the reference value in the plot and
table. This is TRUE by default for is_ref_value == TRUE, otherwise NA
(and ignored).
</p>
</li>
<li> <p><code>is_covariate</code>: Whether the variable is a covariate (TRUE) or exposure
variable (FALSE).
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>

data(d_sim_binom_cov_hgly2)

ermod_bin &lt;- dev_ermod_bin(
  data = d_sim_binom_cov_hgly2,
  var_resp = "AEFLAG",
  var_exposure = "AUCss_1000",
  var_cov = c("BHBA1C_5", "RACE"),
)

spec_coveff &lt;- build_spec_coveff(ermod_bin)
plot_coveff(ermod_bin, spec_coveff = spec_coveff)


</code></pre>

<hr>
<h2 id='calc_ersim_med_qi'>Calculate median and quantile intervals from ersim object</h2><span id='topic+calc_ersim_med_qi'></span>

<h3>Description</h3>

<p>This is useful when you performed simulation with output_type = &quot;draws&quot; and
want to calculate median and quantile intervals without re-simulating.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_ersim_med_qi(x, qi_width = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_ersim_med_qi_+3A_x">x</code></td>
<td>
<p>An object of class <code>ersim</code> or <code>ersim_marg</code></p>
</td></tr>
<tr><td><code id="calc_ersim_med_qi_+3A_qi_width">qi_width</code></td>
<td>
<p>Width of the quantile interval</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>ersim_med_qi</code> or <code>ersim_marg_med_qi</code>
</p>

<hr>
<h2 id='d_sim_binom_cov'>Sample simulated data for exposure-response with binary endpoint.</h2><span id='topic+d_sim_binom_cov'></span><span id='topic+d_sim_binom_cov_hgly2'></span>

<h3>Description</h3>

<p>Sample simulated data for exposure-response with binary endpoint.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_sim_binom_cov

d_sim_binom_cov_hgly2
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt>ID</dt><dd><p>Subject ID</p>
</dd>
<dt>AETYPE</dt><dd><p>Adverse event type: hgly2 (Gr2+ hyperglycemia),
dr2 (Gr2+ Diarrhea), ae_covsel_test (hypothetical AE for covariate
selection function test)</p>
</dd>
<dt>AEFLAG</dt><dd><p>Adverse event flag: 0 - no event, 1 - event</p>
</dd>
<dt>Dose_mg</dt><dd><p>Dose in mg: 200, 400</p>
</dd>
<dt>AUCss</dt><dd><p>Steady-state area under the curve</p>
</dd>
<dt>Cmaxss</dt><dd><p>Steady-state maximum (peak) concentration</p>
</dd>
<dt>Cminss</dt><dd><p>Steady-state minimum (trough) concentration</p>
</dd>
<dt>BAGE</dt><dd><p>Baseline age in years</p>
</dd>
<dt>BWT</dt><dd><p>Baseline weight in kg</p>
</dd>
<dt>BGLUC</dt><dd><p>Baseline glucose in mmol/L</p>
</dd>
<dt>BHBA1C</dt><dd><p>Baseline HbA1c in percentage</p>
</dd>
<dt>RACE</dt><dd><p>Race: White, Black, Asian</p>
</dd>
<dt>VISC</dt><dd><p>Visceral disease: No, Yes</p>
</dd>
<dt>AUCss_1000</dt><dd><p>AUCss/1000</p>
</dd>
<dt>BAGE_10</dt><dd><p>BAGE/10</p>
</dd>
<dt>BWT_10</dt><dd><p>BWT/10</p>
</dd>
<dt>BHBA1C_5</dt><dd><p>BHBA1C/5</p>
</dd>
</dl>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 500 rows and 17 columns.
</p>


<h3>Details</h3>

<p>This simulated dataset is very loosely inspired by ER analysis of
ipatasertib by Kotani (2022) at:
</p>
<p>https://doi.org/10.1007/s00280-022-04488-2
</p>
<p>You can find the data generating code in the package source code,
under <code>data-raw/d_sim_binom_cov.R</code>.
</p>
<p>d_sim_binom_cov_hgly2 is a subset of this dataset with only hgly2 AE type
and some columns added for testing.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d_sim_binom_cov
d_sim_binom_cov_hgly2
</code></pre>

<hr>
<h2 id='d_sim_lin'>Sample simulated data for exposure-response with continuous endpoint
using linear model.</h2><span id='topic+d_sim_lin'></span>

<h3>Description</h3>

<p>Sample simulated data for exposure-response with continuous endpoint
using linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_sim_lin
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt>ID</dt><dd><p>Subject ID</p>
</dd>
<dt>AUCss</dt><dd><p>Steady-state area under the curve</p>
</dd>
<dt>Cmaxss</dt><dd><p>Steady-state maximum (peak) concentration</p>
</dd>
<dt>BAGE</dt><dd><p>Baseline age in years</p>
</dd>
<dt>SEX</dt><dd><p>M or F</p>
</dd>
<dt>response</dt><dd><p>Response</p>
</dd>
</dl>



<h3>Details</h3>

<p>True model is defined as <code>0.5 * AUCss + 0.5 * BAGE + 5 * SEX</code>, with
variability added with standard deviation of 10.
You can find the data generating code in the package source code,
under <code>data-raw/d_sim_lin.R</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d_sim_lin
</code></pre>

<hr>
<h2 id='dev_ermod_bin'>Develop linear ER model for binary or continuous endpoint</h2><span id='topic+dev_ermod_bin'></span><span id='topic+dev_ermod_lin'></span>

<h3>Description</h3>

<p>These functions are used to develop an linear ER model with binary
(<code><a href="#topic+dev_ermod_bin">dev_ermod_bin()</a></code>) or continuous (<code><a href="#topic+dev_ermod_lin">dev_ermod_lin()</a></code>) endpoint.
You can also specify covariates to be included in the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dev_ermod_bin(
  data,
  var_resp,
  var_exposure,
  var_cov = NULL,
  verbosity_level = 1,
  chains = 4,
  iter = 2000
)

dev_ermod_lin(
  data,
  var_resp,
  var_exposure,
  var_cov = NULL,
  verbosity_level = 1,
  chains = 4,
  iter = 2000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dev_ermod_bin_+3A_data">data</code></td>
<td>
<p>Input data for E-R analysis</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_+3A_var_resp">var_resp</code></td>
<td>
<p>Response variable name in character</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_+3A_var_exposure">var_exposure</code></td>
<td>
<p>Exposure variable names in character</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_+3A_var_cov">var_cov</code></td>
<td>
<p>Covariate variable names in character vector</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_+3A_verbosity_level">verbosity_level</code></td>
<td>
<p>Verbosity level. 0: No output, 1: Display steps,
2: Display progress in each step, 3: Display MCMC sampling.</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_+3A_chains">chains</code></td>
<td>
<p>Number of chains for Stan.</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_+3A_iter">iter</code></td>
<td>
<p>Number of iterations for Stan.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>ermod_bin</code> or <code>ermod_lin</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_sim_binom_cov_hgly2)

ermod_bin &lt;- dev_ermod_bin(
  data = d_sim_binom_cov_hgly2,
  var_resp = "AEFLAG",
  var_exposure = "AUCss_1000",
  var_cov = "BHBA1C_5",
)

ermod_bin



data(d_sim_lin)

ermod_lin &lt;- dev_ermod_lin(
  data = d_sim_lin,
  var_resp = "response",
  var_exposure = "AUCss",
  var_cov = c("SEX", "BAGE")
)

ermod_lin


</code></pre>

<hr>
<h2 id='dev_ermod_bin_cov_functions'>Internal functions for developing an ER model with covariates
for binary endpoint</h2><span id='topic+dev_ermod_bin_cov_functions'></span><span id='topic+.dev_ermod_refmodel'></span><span id='topic+.select_cov_projpred'></span>

<h3>Description</h3>

<p>These functions are not intended to be used directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.dev_ermod_refmodel(
  data,
  var_resp,
  var_exposure,
  var_cov_candidates,
  verbosity_level = 1,
  chains = 4,
  iter = 2000,
  fun_family = quote(stats::binomial())
)

.select_cov_projpred(
  refm_obj,
  var_exposure,
  var_cov_candidates,
  nterms_max = NULL,
  cv_method = c("LOO", "kfold"),
  k = 5,
  .reduce_obj_size = TRUE,
  validate_search = FALSE,
  verbosity_level = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dev_ermod_bin_cov_functions_+3A_data">data</code></td>
<td>
<p>Input data for E-R analysis</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_functions_+3A_var_resp">var_resp</code></td>
<td>
<p>Response variable name in character</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_functions_+3A_var_exposure">var_exposure</code></td>
<td>
<p>Exposure variable names in character</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_functions_+3A_var_cov_candidates">var_cov_candidates</code></td>
<td>
<p>Candidate covariate names in character vector</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_functions_+3A_verbosity_level">verbosity_level</code></td>
<td>
<p>Verbosity level. 0: No output, 1: Display steps,
2: Display progress in each step, 3: Display MCMC sampling.</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_functions_+3A_chains">chains</code></td>
<td>
<p>Number of chains for Stan.</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_functions_+3A_iter">iter</code></td>
<td>
<p>Number of iterations for Stan.</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_functions_+3A_fun_family">fun_family</code></td>
<td>
<p>Family function for the model. Default is binomial.</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_functions_+3A_refm_obj">refm_obj</code></td>
<td>
<p>Reference model object used for variable selection</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_functions_+3A_nterms_max">nterms_max</code></td>
<td>
<p>Maximum number of terms to consider in the model.
Default is NULL (all terms are considered).</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_functions_+3A_cv_method">cv_method</code></td>
<td>
<p>Cross-validation method. Default is &quot;LOO&quot; (recommended).
Use &quot;kfold&quot; if you see warnings on Pareto k estimates.</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_functions_+3A_k">k</code></td>
<td>
<p>Number of folds for kfold CV.
Only used if cv_method is &quot;kfold&quot;.</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_functions_+3A_.reduce_obj_size">.reduce_obj_size</code></td>
<td>
<p>Whether to reduce object size by removing some
elements from projpred outputs that are not necessary for the functionality
of this package.</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_functions_+3A_validate_search">validate_search</code></td>
<td>
<p>Whether to validate the search. Default is FALSE.
Recommend to set to TRUE for kfold CV. Do not use for LOO (run time would
become too long).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+.dev_ermod_refmodel">.dev_ermod_refmodel()</a></code> is used to fit the refmodel (full reference
model) necessary for projpred
</p>
<p><code><a href="#topic+.select_cov_projpred">.select_cov_projpred()</a></code> is used to select variables with <code>projpred</code> package
</p>


<h3>Value</h3>

<p><code><a href="#topic+.dev_ermod_refmodel">.dev_ermod_refmodel()</a></code>: The reference model object that can be used
for variable selection.
</p>
<p><code><a href="#topic+.select_cov_projpred">.select_cov_projpred()</a></code>: The selected variables
</p>

<hr>
<h2 id='dev_ermod_bin_cov_sel'>Perform covariate selection for linear ER model</h2><span id='topic+dev_ermod_bin_cov_sel'></span><span id='topic+dev_ermod_lin_cov_sel'></span>

<h3>Description</h3>

<p>This functions is used to develop an ER model with covariates for binary
and continuous endpoints.
<code>projpred</code> package is used for variable selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dev_ermod_bin_cov_sel(
  data,
  var_resp,
  var_exposure,
  var_cov_candidates,
  cv_method = c("LOO", "kfold"),
  k = 5,
  validate_search = FALSE,
  nterms_max = NULL,
  .reduce_obj_size = TRUE,
  verbosity_level = 1,
  chains = 4,
  iter = 2000
)

dev_ermod_lin_cov_sel(
  data,
  var_resp,
  var_exposure,
  var_cov_candidates,
  cv_method = c("LOO", "kfold"),
  k = 5,
  validate_search = FALSE,
  nterms_max = NULL,
  .reduce_obj_size = TRUE,
  verbosity_level = 1,
  chains = 4,
  iter = 2000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dev_ermod_bin_cov_sel_+3A_data">data</code></td>
<td>
<p>Input data for E-R analysis</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_sel_+3A_var_resp">var_resp</code></td>
<td>
<p>Response variable name in character</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_sel_+3A_var_exposure">var_exposure</code></td>
<td>
<p>Exposure variable names in character</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_sel_+3A_var_cov_candidates">var_cov_candidates</code></td>
<td>
<p>Candidate covariate names in character vector</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_sel_+3A_cv_method">cv_method</code></td>
<td>
<p>Cross-validation method. Default is &quot;LOO&quot; (recommended).
Use &quot;kfold&quot; if you see warnings on Pareto k estimates.</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_sel_+3A_k">k</code></td>
<td>
<p>Number of folds for kfold CV.
Only used if cv_method is &quot;kfold&quot;.</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_sel_+3A_validate_search">validate_search</code></td>
<td>
<p>Whether to validate the search. Default is FALSE.
Recommend to set to TRUE for kfold CV. Do not use for LOO (run time would
become too long).</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_sel_+3A_nterms_max">nterms_max</code></td>
<td>
<p>Maximum number of terms to consider in the model.
Default is NULL (all terms are considered).</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_sel_+3A_.reduce_obj_size">.reduce_obj_size</code></td>
<td>
<p>Whether to reduce object size by removing some
elements from projpred outputs that are not necessary for the functionality
of this package.</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_sel_+3A_verbosity_level">verbosity_level</code></td>
<td>
<p>Verbosity level. 0: No output, 1: Display steps,
2: Display progress in each step, 3: Display MCMC sampling.</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_sel_+3A_chains">chains</code></td>
<td>
<p>Number of chains for Stan.</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_cov_sel_+3A_iter">iter</code></td>
<td>
<p>Number of iterations for Stan.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>ermod_bin_cov_sel</code> or <code>ermod_lin_cov_sel</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(d_sim_binom_cov_hgly2)

er_binary_cov_model &lt;- dev_ermod_bin_cov_sel(
  data = d_sim_binom_cov_hgly2,
  var_resp = "AEFLAG",
  var_exposure = "AUCss_1000",
  var_cov_candidates = c(
    "BAGE_10", "BWT_10", "BGLUC",
    "BHBA1C_5", "RACE", "VISC"
  )
)

er_binary_cov_model




data(d_sim_lin)

ermod_lin_cov_sel &lt;- dev_ermod_lin_cov_sel(
  data = d_sim_lin,
  var_resp = "response",
  var_exposure = "AUCss",
  var_cov_candidates = c("BAGE", "SEX")
)

ermod_lin_cov_sel


</code></pre>

<hr>
<h2 id='dev_ermod_bin_exp_sel'>Exposure metrics selection for linear ER models</h2><span id='topic+dev_ermod_bin_exp_sel'></span><span id='topic+dev_ermod_lin_exp_sel'></span>

<h3>Description</h3>

<p>This functions is used to develop an linear ER model with binary
and continuous endpoint, using various exposure metrics and
selecting the best one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dev_ermod_bin_exp_sel(
  data,
  var_resp,
  var_exp_candidates,
  verbosity_level = 1,
  chains = 4,
  iter = 2000
)

dev_ermod_lin_exp_sel(
  data,
  var_resp,
  var_exp_candidates,
  verbosity_level = 1,
  chains = 4,
  iter = 2000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dev_ermod_bin_exp_sel_+3A_data">data</code></td>
<td>
<p>Input data for E-R analysis</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_exp_sel_+3A_var_resp">var_resp</code></td>
<td>
<p>Response variable name in character</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_exp_sel_+3A_var_exp_candidates">var_exp_candidates</code></td>
<td>
<p>Candidate exposure variable names
in character vector</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_exp_sel_+3A_verbosity_level">verbosity_level</code></td>
<td>
<p>Verbosity level. 0: No output, 1: Display steps,
2: Display progress in each step, 3: Display MCMC sampling.</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_exp_sel_+3A_chains">chains</code></td>
<td>
<p>Number of chains for Stan.</p>
</td></tr>
<tr><td><code id="dev_ermod_bin_exp_sel_+3A_iter">iter</code></td>
<td>
<p>Number of iterations for Stan.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>ermod_bin_exp_sel</code>.or <code>ermod_lin_exp_sel</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_sim_binom_cov_hgly2)

ermod_bin_exp_sel &lt;-
  dev_ermod_bin_exp_sel(
    data = d_sim_binom_cov_hgly2,
    var_resp = "AEFLAG",
    var_exp_candidates = c("AUCss_1000", "Cmaxss", "Cminss")
  )

ermod_bin_exp_sel



data(d_sim_lin)

ermod_lin_exp_sel &lt;- dev_ermod_lin_exp_sel(
  data = d_sim_lin,
  var_resp = "response",
  var_exp_candidates = c("AUCss", "Cmaxss")
)

ermod_lin_exp_sel


</code></pre>

<hr>
<h2 id='dev_ermod_emax'>Develop Emax model for continuous and binary endpoint</h2><span id='topic+dev_ermod_emax'></span><span id='topic+dev_ermod_bin_emax'></span>

<h3>Description</h3>

<p>These functions are used to develop an Emax model with continuous or binary
endpoint.
You can also specify covariates to be included in the model; note that only
categorical covariates are allowed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dev_ermod_emax(
  data,
  var_resp,
  var_exposure,
  l_var_cov = NULL,
  gamma_fix = 1,
  e0_fix = NULL,
  emax_fix = NULL,
  priors = NULL,
  verbosity_level = 1,
  chains = 4,
  iter = 2000,
  seed = sample.int(.Machine$integer.max, 1)
)

dev_ermod_bin_emax(
  data,
  var_resp,
  var_exposure,
  l_var_cov = NULL,
  gamma_fix = 1,
  e0_fix = NULL,
  emax_fix = NULL,
  priors = NULL,
  verbosity_level = 1,
  chains = 4,
  iter = 2000,
  seed = sample.int(.Machine$integer.max, 1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dev_ermod_emax_+3A_data">data</code></td>
<td>
<p>Input data for E-R analysis</p>
</td></tr>
<tr><td><code id="dev_ermod_emax_+3A_var_resp">var_resp</code></td>
<td>
<p>Response variable name in character</p>
</td></tr>
<tr><td><code id="dev_ermod_emax_+3A_var_exposure">var_exposure</code></td>
<td>
<p>Exposure variable names in character</p>
</td></tr>
<tr><td><code id="dev_ermod_emax_+3A_l_var_cov">l_var_cov</code></td>
<td>
<p>a names list of categorical covariate variables in
character vector. See details in the <code>param.cov</code> argument of
<code><a href="rstanemax.html#topic+stan_emax">rstanemax::stan_emax()</a></code> or <code><a href="rstanemax.html#topic+stan_emax_binary">rstanemax::stan_emax_binary()</a></code></p>
</td></tr>
<tr><td><code id="dev_ermod_emax_+3A_gamma_fix">gamma_fix</code></td>
<td>
<p>Hill coefficient, default fixed to 1.
See details in <code><a href="rstanemax.html#topic+stan_emax">rstanemax::stan_emax()</a></code> or <code><a href="rstanemax.html#topic+stan_emax_binary">rstanemax::stan_emax_binary()</a></code></p>
</td></tr>
<tr><td><code id="dev_ermod_emax_+3A_e0_fix">e0_fix</code></td>
<td>
<p>See details in <code><a href="rstanemax.html#topic+stan_emax">rstanemax::stan_emax()</a></code> or
<code><a href="rstanemax.html#topic+stan_emax_binary">rstanemax::stan_emax_binary()</a></code></p>
</td></tr>
<tr><td><code id="dev_ermod_emax_+3A_emax_fix">emax_fix</code></td>
<td>
<p>See details in <code><a href="rstanemax.html#topic+stan_emax">rstanemax::stan_emax()</a></code> or
<code><a href="rstanemax.html#topic+stan_emax_binary">rstanemax::stan_emax_binary()</a></code></p>
</td></tr>
<tr><td><code id="dev_ermod_emax_+3A_priors">priors</code></td>
<td>
<p>See details in <code><a href="rstanemax.html#topic+stan_emax">rstanemax::stan_emax()</a></code> or
<code><a href="rstanemax.html#topic+stan_emax_binary">rstanemax::stan_emax_binary()</a></code></p>
</td></tr>
<tr><td><code id="dev_ermod_emax_+3A_verbosity_level">verbosity_level</code></td>
<td>
<p>Verbosity level. 0: No output, 1: Display steps,
2: Display progress in each step, 3: Display MCMC sampling.</p>
</td></tr>
<tr><td><code id="dev_ermod_emax_+3A_chains">chains</code></td>
<td>
<p>Number of chains for Stan.</p>
</td></tr>
<tr><td><code id="dev_ermod_emax_+3A_iter">iter</code></td>
<td>
<p>Number of iterations for Stan.</p>
</td></tr>
<tr><td><code id="dev_ermod_emax_+3A_seed">seed</code></td>
<td>
<p>Random seed for Stan model execution, see details in
<code><a href="rstan.html#topic+stanmodel-method-sampling">rstan::sampling()</a></code> which is used in <code><a href="rstanemax.html#topic+stan_emax">rstanemax::stan_emax()</a></code> or
<code><a href="rstanemax.html#topic+stan_emax_binary">rstanemax::stan_emax_binary()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>ermod_emax</code>.or <code>ermod_bin_emax</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data_er_cont &lt;- rstanemax::exposure.response.sample

ermod_emax &lt;-
  dev_ermod_emax(
    data = data_er_cont,
    var_exposure = "exposure",
    var_resp = "response"
  )

plot_er(ermod_emax, show_orig_data = TRUE)

data_er_cont_cov &lt;- rstanemax::exposure.response.sample.with.cov

ermod_emax_w_cov &lt;-
  dev_ermod_emax(
    data = data_er_cont_cov,
    var_exposure = "conc",
    var_resp = "resp",
    l_var_cov = list(emax = "cov2", ec50 = "cov3", e0 = "cov1")
  )




data_er_bin &lt;- rstanemax::exposure.response.sample.binary

ermod_bin_emax &lt;-
  dev_ermod_bin_emax(
    data = data_er_bin,
    var_exposure = "conc",
    var_resp = "y"
  )

plot_er(ermod_bin_emax, show_orig_data = TRUE)

ermod_bin_emax_w_cov &lt;-
  dev_ermod_bin_emax(
    data = data_er_bin,
    var_exposure = "conc",
    var_resp = "y_cov",
    l_var_cov = list(emax = "sex")
  )


</code></pre>

<hr>
<h2 id='dev_ermod_emax_exp_sel'>Exposure metrics selection for Emax models</h2><span id='topic+dev_ermod_emax_exp_sel'></span><span id='topic+dev_ermod_bin_emax_exp_sel'></span>

<h3>Description</h3>

<p>This functions is used to develop an Emax model with binary and continuous
endpoint, using various exposure metrics and selecting the best one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dev_ermod_emax_exp_sel(
  data,
  var_resp,
  var_exp_candidates,
  verbosity_level = 1,
  chains = 4,
  iter = 2000,
  gamma_fix = 1,
  e0_fix = NULL,
  emax_fix = NULL,
  priors = NULL,
  seed = sample.int(.Machine$integer.max, 1)
)

dev_ermod_bin_emax_exp_sel(
  data,
  var_resp,
  var_exp_candidates,
  verbosity_level = 1,
  chains = 4,
  iter = 2000,
  gamma_fix = 1,
  e0_fix = NULL,
  emax_fix = NULL,
  priors = NULL,
  seed = sample.int(.Machine$integer.max, 1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dev_ermod_emax_exp_sel_+3A_data">data</code></td>
<td>
<p>Input data for E-R analysis</p>
</td></tr>
<tr><td><code id="dev_ermod_emax_exp_sel_+3A_var_resp">var_resp</code></td>
<td>
<p>Response variable name in character</p>
</td></tr>
<tr><td><code id="dev_ermod_emax_exp_sel_+3A_var_exp_candidates">var_exp_candidates</code></td>
<td>
<p>Candidate exposure variable names
in character vector</p>
</td></tr>
<tr><td><code id="dev_ermod_emax_exp_sel_+3A_verbosity_level">verbosity_level</code></td>
<td>
<p>Verbosity level. 0: No output, 1: Display steps,
2: Display progress in each step, 3: Display MCMC sampling.</p>
</td></tr>
<tr><td><code id="dev_ermod_emax_exp_sel_+3A_chains">chains</code></td>
<td>
<p>Number of chains for Stan.</p>
</td></tr>
<tr><td><code id="dev_ermod_emax_exp_sel_+3A_iter">iter</code></td>
<td>
<p>Number of iterations for Stan.</p>
</td></tr>
<tr><td><code id="dev_ermod_emax_exp_sel_+3A_gamma_fix">gamma_fix</code></td>
<td>
<p>Hill coefficient, default fixed to 1.
See details in <code><a href="rstanemax.html#topic+stan_emax">rstanemax::stan_emax()</a></code> or <code><a href="rstanemax.html#topic+stan_emax_binary">rstanemax::stan_emax_binary()</a></code></p>
</td></tr>
<tr><td><code id="dev_ermod_emax_exp_sel_+3A_e0_fix">e0_fix</code></td>
<td>
<p>See details in <code><a href="rstanemax.html#topic+stan_emax">rstanemax::stan_emax()</a></code> or
<code><a href="rstanemax.html#topic+stan_emax_binary">rstanemax::stan_emax_binary()</a></code></p>
</td></tr>
<tr><td><code id="dev_ermod_emax_exp_sel_+3A_emax_fix">emax_fix</code></td>
<td>
<p>See details in <code><a href="rstanemax.html#topic+stan_emax">rstanemax::stan_emax()</a></code> or
<code><a href="rstanemax.html#topic+stan_emax_binary">rstanemax::stan_emax_binary()</a></code></p>
</td></tr>
<tr><td><code id="dev_ermod_emax_exp_sel_+3A_priors">priors</code></td>
<td>
<p>See details in <code><a href="rstanemax.html#topic+stan_emax">rstanemax::stan_emax()</a></code> or
<code><a href="rstanemax.html#topic+stan_emax_binary">rstanemax::stan_emax_binary()</a></code></p>
</td></tr>
<tr><td><code id="dev_ermod_emax_exp_sel_+3A_seed">seed</code></td>
<td>
<p>Random seed for Stan model execution, see details in
<code><a href="rstan.html#topic+stanmodel-method-sampling">rstan::sampling()</a></code> which is used in <code><a href="rstanemax.html#topic+stan_emax">rstanemax::stan_emax()</a></code> or
<code><a href="rstanemax.html#topic+stan_emax_binary">rstanemax::stan_emax_binary()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>ermod_emax_exp_sel</code> or <code>ermod_bin_emax_exp_sel</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data_er_cont &lt;- rstanemax::exposure.response.sample
noise &lt;- 1 + 0.5 * stats::rnorm(length(data_er_cont$exposure))
data_er_cont$exposure2 &lt;- data_er_cont$exposure * noise
# Replace exposure &lt; 0 with 0
data_er_cont$exposure2[data_er_cont$exposure2 &lt; 0] &lt;- 0

ermod_emax_exp_sel &lt;-
  dev_ermod_emax_exp_sel(
    data = data_er_cont,
    var_resp = "response",
    var_exp_candidates = c("exposure", "exposure2")
  )

ermod_emax_exp_sel



data_er_bin &lt;- rstanemax::exposure.response.sample.binary

noise &lt;- 1 + 0.5 * stats::rnorm(length(data_er_bin$conc))
data_er_bin$conc2 &lt;- data_er_bin$conc * noise
data_er_bin$conc2[data_er_bin$conc2 &lt; 0] &lt;- 0

ermod_bin_emax_exp_sel &lt;-
  dev_ermod_bin_emax_exp_sel(
    data = data_er_bin,
    var_resp = "y",
    var_exp_candidates = c("conc", "conc2")
  )


</code></pre>

<hr>
<h2 id='edit_spec_coveff'>Customize specifications for covariate effect simulations/visualizations</h2><span id='topic+edit_spec_coveff'></span><span id='topic+build_spec_coveff_one_variable'></span><span id='topic+replace_spec_coveff'></span>

<h3>Description</h3>


<ul>
<li> <p><code><a href="#topic+build_spec_coveff_one_variable">build_spec_coveff_one_variable()</a></code> is a helper function to create a new
specification for a single variable. This is useful when you want to
customize the specification for a single variable.
</p>
</li>
<li> <p><code><a href="#topic+replace_spec_coveff">replace_spec_coveff()</a></code> is used to replace the specification for some (or
all) variables in the original specification data frame. If you want to
replace multiple variables, you can just stack the specifications
together.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>build_spec_coveff_one_variable(
  var_name,
  values_vec,
  qi_width_cov = 0.9,
  n_sigfig = 3,
  use_seps = TRUE,
  drop_trailing_dec_mark = TRUE,
  show_ref_value = TRUE
)

replace_spec_coveff(spec_orig, spec_new, replace_ref_value = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="edit_spec_coveff_+3A_var_name">var_name</code></td>
<td>
<p>The name of the variable for which a new spec is to be
created.</p>
</td></tr>
<tr><td><code id="edit_spec_coveff_+3A_values_vec">values_vec</code></td>
<td>
<p>The vector of the values for creating a new spec.</p>
</td></tr>
<tr><td><code id="edit_spec_coveff_+3A_qi_width_cov">qi_width_cov</code></td>
<td>
<p>the width of the quantile interval for continuous
covariates in the forest plot. Default is 0.9 (i.e. visualize effect of
covariate effect at their 5th and 95th percentile values).</p>
</td></tr>
<tr><td><code id="edit_spec_coveff_+3A_n_sigfig">n_sigfig</code></td>
<td>
<p>Number of significant figures to form value_label of
continuous variables. See <code><a href="gt.html#topic+vec_fmt_number">gt::vec_fmt_number()</a></code> for details.</p>
</td></tr>
<tr><td><code id="edit_spec_coveff_+3A_use_seps">use_seps</code></td>
<td>
<p>Whether to use separators for thousands in printing numbers.
See <code><a href="gt.html#topic+vec_fmt_number">gt::vec_fmt_number()</a></code> for details.</p>
</td></tr>
<tr><td><code id="edit_spec_coveff_+3A_drop_trailing_dec_mark">drop_trailing_dec_mark</code></td>
<td>
<p>Whether to drop the trailing decimal mark
(&quot;.&quot;) in value_label of continuous variables. See <code><a href="gt.html#topic+vec_fmt_number">gt::vec_fmt_number()</a></code>
for details.</p>
</td></tr>
<tr><td><code id="edit_spec_coveff_+3A_show_ref_value">show_ref_value</code></td>
<td>
<p>Whether to show the reference value in the plot and
table. Setting this results in the <code>show_ref_value</code> column in the
specification data frame.</p>
</td></tr>
<tr><td><code id="edit_spec_coveff_+3A_spec_orig">spec_orig</code></td>
<td>
<p>Original specification data frame.</p>
</td></tr>
<tr><td><code id="edit_spec_coveff_+3A_spec_new">spec_new</code></td>
<td>
<p>New specification data frame. It can be generated by
<code><a href="#topic+build_spec_coveff_one_variable">build_spec_coveff_one_variable()</a></code> or manually crafting with the
following variables: <code>var_name</code>, <code>var_label</code>, <code>value_order</code>, <code>value_annot</code>,
<code>value_label</code>, <code>value_cont</code> or <code>value_cat</code>, <code>is_ref_value</code>,
<code>show_ref_value</code>. You can have multiple variables stacked together.</p>
</td></tr>
<tr><td><code id="edit_spec_coveff_+3A_replace_ref_value">replace_ref_value</code></td>
<td>
<p>Whether to replace the reference values from the
original specification data frame. Default is FALSE; in this case,
show_ref_value is set to FALSE as it can be confusing.
If you set replace_ref_value to TRUE,
the reference calculation for the forest plot is also done with the one
in spec_new.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>See <code><a href="#topic+build_spec_coveff">build_spec_coveff()</a></code> for the structure of the return object.
<code><a href="#topic+build_spec_coveff_one_variable">build_spec_coveff_one_variable()</a></code> returns a data frame corresponding to
the specification for a single variable, which can be used as an input to
<code><a href="#topic+replace_spec_coveff">replace_spec_coveff()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

set.seed(1234)
data(d_sim_binom_cov_hgly2)

ermod_bin &lt;- suppressWarnings(dev_ermod_bin(
  data = d_sim_binom_cov_hgly2, var_resp = "AEFLAG",
  var_exposure = "AUCss_1000", var_cov = c("BGLUC", "RACE"),
  verbosity_level = 0,
  # Below option to make the example run fast
  chains = 2, iter = 1000
))

spec_coveff &lt;- build_spec_coveff(ermod_bin)
spec_new_bgluc &lt;- build_spec_coveff_one_variable(
  "BGLUC", seq(4, 8, by = 0.1),
  qi_width_cov = 0.8, show_ref_value = FALSE
)
spec_coveff_new &lt;- replace_spec_coveff(spec_coveff, spec_new_bgluc)
plot_coveff(ermod_bin, spec_coveff = spec_coveff_new)


</code></pre>

<hr>
<h2 id='ermod_cov_sel_method'>S3 methods for the classes <code>ermod_bin_cov_sel</code></h2><span id='topic+ermod_cov_sel_method'></span><span id='topic+print.ermod_cov_sel'></span><span id='topic+plot.ermod_cov_sel'></span>

<h3>Description</h3>

<p>S3 methods for the classes <code>ermod_bin_cov_sel</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ermod_cov_sel'
print(x, digits = 2, ...)

## S3 method for class 'ermod_cov_sel'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ermod_cov_sel_method_+3A_x">x</code></td>
<td>
<p>An object of class <code>ermod_bin_cov_sel</code></p>
</td></tr>
<tr><td><code id="ermod_cov_sel_method_+3A_digits">digits</code></td>
<td>
<p>Number of digits to print</p>
</td></tr>
<tr><td><code id="ermod_cov_sel_method_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to functions</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for print or plot side effects
</p>

<hr>
<h2 id='ermod_exp_sel_method'>S3 methods for the classes <code>ermod_exp_sel</code></h2><span id='topic+ermod_exp_sel_method'></span><span id='topic+print.ermod_exp_sel'></span><span id='topic+plot.ermod_exp_sel'></span>

<h3>Description</h3>

<p>S3 methods for the classes <code>ermod_exp_sel</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ermod_exp_sel'
print(x, digits = 2, ...)

## S3 method for class 'ermod_exp_sel'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ermod_exp_sel_method_+3A_x">x</code></td>
<td>
<p>An object of class <code>ermod_bin_exp_sel</code></p>
</td></tr>
<tr><td><code id="ermod_exp_sel_method_+3A_digits">digits</code></td>
<td>
<p>Number of digits to print</p>
</td></tr>
<tr><td><code id="ermod_exp_sel_method_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to functions</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for print or plot side effects
</p>

<hr>
<h2 id='ermod_method'>S3 methods for the classes <code>ermod_*</code></h2><span id='topic+ermod_method'></span><span id='topic+print.ermod'></span><span id='topic+plot.ermod_bin'></span><span id='topic+coef.ermod'></span><span id='topic+summary.ermod'></span>

<h3>Description</h3>

<p>S3 methods for the classes <code>ermod_*</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ermod'
print(x, digits = 2, ...)

## S3 method for class 'ermod_bin'
plot(x, show_orig_data = FALSE, ...)

## S3 method for class 'ermod'
coef(object, ...)

## S3 method for class 'ermod'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ermod_method_+3A_x">x</code></td>
<td>
<p>An object of class <code>ermod_*</code></p>
</td></tr>
<tr><td><code id="ermod_method_+3A_digits">digits</code></td>
<td>
<p>Number of digits to print</p>
</td></tr>
<tr><td><code id="ermod_method_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to functions</p>
</td></tr>
<tr><td><code id="ermod_method_+3A_show_orig_data">show_orig_data</code></td>
<td>
<p>logical, whether to show the data points in the
model development dataset. Default is <code>FALSE</code>. Only support plotting
with data that was used in the model development. If you want to use
other data, consider adding geom_point() to the plot manually.</p>
</td></tr>
<tr><td><code id="ermod_method_+3A_object">object</code></td>
<td>
<p>An object of class <code>ermod_*</code></p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code>print()</code> and <code>plot()</code>: No return value, called for side effects
</p>
</li>
<li> <p><code>coef()</code>: Coefficients of the model
</p>
</li>
<li> <p><code>summary()</code>: Summary of the model
</p>
</li></ul>


<hr>
<h2 id='ersim_method'>S3 methods for the classes <code style="white-space: pre;">&#8288;ersim_*&#8288;</code> and <code style="white-space: pre;">&#8288;ersim_med_qi_*&#8288;</code></h2><span id='topic+ersim_method'></span><span id='topic+plot.ersim'></span><span id='topic+plot.ersim_med_qi'></span>

<h3>Description</h3>

<p>S3 methods for the classes <code style="white-space: pre;">&#8288;ersim_*&#8288;</code> and <code style="white-space: pre;">&#8288;ersim_med_qi_*&#8288;</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ersim'
plot(x, show_orig_data = FALSE, ...)

## S3 method for class 'ersim_med_qi'
plot(x, show_orig_data = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ersim_method_+3A_x">x</code></td>
<td>
<p>An object of the classes <code style="white-space: pre;">&#8288;ersim_*&#8288;</code> or <code style="white-space: pre;">&#8288;ersim_med_qi_*&#8288;</code></p>
</td></tr>
<tr><td><code id="ersim_method_+3A_show_orig_data">show_orig_data</code></td>
<td>
<p>logical, whether to show the data points in the
model development dataset. Default is <code>FALSE</code>. Only support plotting
with data that was used in the model development. If you want to use
other data, consider adding geom_point() to the plot manually.</p>
</td></tr>
<tr><td><code id="ersim_method_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to functions</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for print or plot side effects
</p>

<hr>
<h2 id='eval_ermod'>Evaluate exposure-response model prediction performance</h2><span id='topic+eval_ermod'></span>

<h3>Description</h3>

<p>This function evaluates the performance of an exposure-response model
using various metrics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eval_ermod(
  ermod,
  eval_type = c("training", "kfold", "test"),
  newdata = NULL,
  summary_method = c("median", "mean"),
  k = 5,
  seed_kfold = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eval_ermod_+3A_ermod">ermod</code></td>
<td>
<p>An object of class <code>ermod</code>.</p>
</td></tr>
<tr><td><code id="eval_ermod_+3A_eval_type">eval_type</code></td>
<td>
<p>A character string specifying the evaluation dataset.
Options are:
</p>

<ul>
<li> <p><code>training</code>: Use the training dataset.
</p>
</li>
<li> <p><code>test</code>: Use a new dataset for evaluation.
</p>
</li>
<li> <p><code>kfold</code>: Perform k-fold cross-validation (uses <code>newdata</code> if provided,
otherwise uses the training dataset).
</p>
</li></ul>
</td></tr>
<tr><td><code id="eval_ermod_+3A_newdata">newdata</code></td>
<td>
<p>A data frame containing new data for evaluation when
<code>eval_type</code> is set to <code>test</code> or <code>kfold</code>.</p>
</td></tr>
<tr><td><code id="eval_ermod_+3A_summary_method">summary_method</code></td>
<td>
<p>A character string specifying how to summarize the
simulation draws. Default is <code>median</code>.</p>
</td></tr>
<tr><td><code id="eval_ermod_+3A_k">k</code></td>
<td>
<p>The number of folds for cross-validation. Default is 5.</p>
</td></tr>
<tr><td><code id="eval_ermod_+3A_seed_kfold">seed_kfold</code></td>
<td>
<p>Random seed for k-fold cross-validation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with calculated performance metrics, such as AUROC or
RMSE, depending on the model type.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(d_sim_binom_cov_hgly2)
d_split &lt;- rsample::initial_split(d_sim_binom_cov_hgly2)
d_train &lt;- rsample::training(d_split)
d_test &lt;- rsample::testing(d_split)

ermod_bin &lt;- dev_ermod_bin(
  data = d_train,
  var_resp = "AEFLAG",
  var_exposure = "AUCss_1000",
  var_cov = "BHBA1C_5",
  # Settings to make the example run faster
  chains = 2,
  iter = 1000
)

metrics_training &lt;- eval_ermod(ermod_bin, eval_type = "training")
metrics_test &lt;- eval_ermod(ermod_bin, eval_type = "test", newdata = d_test)
metrics_kfold &lt;- eval_ermod(ermod_bin, eval_type = "kfold", k = 3)

print(metrics_training)
print(metrics_test)
print(metrics_kfold)


</code></pre>

<hr>
<h2 id='extract_coef_exp_ci'>Extract credible interval of the exposure coefficient</h2><span id='topic+extract_coef_exp_ci'></span>

<h3>Description</h3>

<p>Extract credible interval of the exposure coefficient
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_coef_exp_ci(x, ci_width = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_coef_exp_ci_+3A_x">x</code></td>
<td>
<p>An object of class <code>ermod_bin</code> or <code>ermod_lin</code></p>
</td></tr>
<tr><td><code id="extract_coef_exp_ci_+3A_ci_width">ci_width</code></td>
<td>
<p>Width of the credible interval</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named vector of length 2 with the lower and upper bounds of the
credible interval (.lower, .upper)
</p>

<hr>
<h2 id='extract_ermod'>Extract elements from an object of class <code>ermod_*</code></h2><span id='topic+extract_ermod'></span><span id='topic+extract_data.ermod'></span><span id='topic+extract_mod.ermod'></span><span id='topic+extract_var_resp.ermod'></span><span id='topic+extract_var_exposure.ermod'></span><span id='topic+extract_var_cov.ermod'></span><span id='topic+extract_exp_sel_list_model.ermod_exp_sel'></span><span id='topic+extract_exp_sel_comp.ermod_exp_sel'></span><span id='topic+extract_var_selected.ermod_cov_sel'></span>

<h3>Description</h3>

<p>Extract elements from an object of class <code>ermod_*</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ermod'
extract_data(x)

## S3 method for class 'ermod'
extract_mod(x)

## S3 method for class 'ermod'
extract_var_resp(x)

## S3 method for class 'ermod'
extract_var_exposure(x)

## S3 method for class 'ermod'
extract_var_cov(x)

## S3 method for class 'ermod_exp_sel'
extract_exp_sel_list_model(x)

## S3 method for class 'ermod_exp_sel'
extract_exp_sel_comp(x)

## S3 method for class 'ermod_cov_sel'
extract_var_selected(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_ermod_+3A_x">x</code></td>
<td>
<p>An object of class <code>ermod_*</code></p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code><a href="#topic+extract_data">extract_data()</a></code> extracts data used for the model fit.
</p>
</li>
<li> <p><code><a href="#topic+extract_mod">extract_mod()</a></code> extracts the model fit object.
</p>
</li>
<li> <p><code><a href="#topic+extract_var_resp">extract_var_resp()</a></code> extracts the response variable name
</p>
</li>
<li> <p><code><a href="#topic+extract_var_exposure">extract_var_exposure()</a></code> extracts the exposure metric name
</p>
</li>
<li> <p><code><a href="#topic+extract_var_cov">extract_var_cov()</a></code> extracts the covariates name
</p>
</li>
<li> <p><code><a href="#topic+extract_exp_sel_list_model">extract_exp_sel_list_model()</a></code> extracts the list of fitted models for
each exposure metrics.
</p>
</li>
<li> <p><code><a href="#topic+extract_exp_sel_comp">extract_exp_sel_comp()</a></code> extracts the comparison results of the exposure
metrics.
</p>
</li>
<li> <p><code><a href="#topic+extract_var_selected">extract_var_selected()</a></code> extracts the selected variables (both exposure
and covariates)in the final model after covariate selection.
</p>
</li></ul>


<hr>
<h2 id='extract_ersim'>Extract elements from objects of the classes <code style="white-space: pre;">&#8288;ersim_*&#8288;</code> and 'ersim_med_qi_*&ldquo;</h2><span id='topic+extract_ersim'></span><span id='topic+extract_data.ersim'></span><span id='topic+extract_data.ersim_med_qi'></span><span id='topic+extract_var_resp.ersim'></span><span id='topic+extract_var_resp.ersim_med_qi'></span><span id='topic+extract_var_exposure.ersim'></span><span id='topic+extract_var_exposure.ersim_med_qi'></span><span id='topic+extract_var_cov.ersim'></span><span id='topic+extract_var_cov.ersim_med_qi'></span>

<h3>Description</h3>

<p>Extract elements from objects of the classes <code style="white-space: pre;">&#8288;ersim_*&#8288;</code> and 'ersim_med_qi_*&ldquo;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ersim'
extract_data(x)

## S3 method for class 'ersim_med_qi'
extract_data(x)

## S3 method for class 'ersim'
extract_var_resp(x)

## S3 method for class 'ersim_med_qi'
extract_var_resp(x)

## S3 method for class 'ersim'
extract_var_exposure(x)

## S3 method for class 'ersim_med_qi'
extract_var_exposure(x)

## S3 method for class 'ersim'
extract_var_cov(x)

## S3 method for class 'ersim_med_qi'
extract_var_cov(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_ersim_+3A_x">x</code></td>
<td>
<p>An object of class <code>ersim_*</code></p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code><a href="#topic+extract_data">extract_data()</a></code> extracts data used for the model fit.
</p>
</li>
<li> <p><code><a href="#topic+extract_mod">extract_mod()</a></code> extracts the model fit object.
</p>
</li>
<li> <p><code><a href="#topic+extract_var_resp">extract_var_resp()</a></code> extracts the response variable name
</p>
</li>
<li> <p><code><a href="#topic+extract_var_exposure">extract_var_exposure()</a></code> extracts the exposure metric name
</p>
</li>
<li> <p><code><a href="#topic+extract_var_cov">extract_var_cov()</a></code> extracts the covariates name
</p>
</li>
<li> <p><code><a href="#topic+extract_exp_sel_list_model">extract_exp_sel_list_model()</a></code> extracts the list of fitted models for
each exposure metrics.
</p>
</li>
<li> <p><code><a href="#topic+extract_exp_sel_comp">extract_exp_sel_comp()</a></code> extracts the comparison results of the exposure
metrics.
</p>
</li>
<li> <p><code><a href="#topic+extract_var_selected">extract_var_selected()</a></code> extracts the selected variables (both exposure
and covariates)in the final model after covariate selection.
</p>
</li></ul>


<hr>
<h2 id='extract_method'>Extract elements from S3 objects</h2><span id='topic+extract_method'></span><span id='topic+extract_data'></span><span id='topic+extract_mod'></span><span id='topic+extract_var_resp'></span><span id='topic+extract_var_exposure'></span><span id='topic+extract_var_cov'></span><span id='topic+extract_exp_sel_list_model'></span><span id='topic+extract_exp_sel_comp'></span><span id='topic+extract_var_selected'></span>

<h3>Description</h3>

<p>S3 methods are defined for <code style="white-space: pre;">&#8288;ermod_*&#8288;</code> (see <a href="#topic+extract_ermod">extract_ermod</a>) and
<code style="white-space: pre;">&#8288;ersim_*&#8288;</code> (see <a href="#topic+extract_ersim">extract_ersim</a>) classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_data(x)

extract_mod(x)

extract_var_resp(x)

extract_var_exposure(x)

extract_var_cov(x)

extract_exp_sel_list_model(x)

extract_exp_sel_comp(x)

extract_var_selected(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_method_+3A_x">x</code></td>
<td>
<p>An object to extract elements from</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code><a href="#topic+extract_data">extract_data()</a></code> extracts data used for the model fit.
</p>
</li>
<li> <p><code><a href="#topic+extract_mod">extract_mod()</a></code> extracts the model fit object.
</p>
</li>
<li> <p><code><a href="#topic+extract_var_resp">extract_var_resp()</a></code> extracts the response variable name
</p>
</li>
<li> <p><code><a href="#topic+extract_var_exposure">extract_var_exposure()</a></code> extracts the exposure metric name
</p>
</li>
<li> <p><code><a href="#topic+extract_var_cov">extract_var_cov()</a></code> extracts the covariates name
</p>
</li>
<li> <p><code><a href="#topic+extract_exp_sel_list_model">extract_exp_sel_list_model()</a></code> extracts the list of fitted models for
each exposure metrics.
</p>
</li>
<li> <p><code><a href="#topic+extract_exp_sel_comp">extract_exp_sel_comp()</a></code> extracts the comparison results of the exposure
metrics.
</p>
</li>
<li> <p><code><a href="#topic+extract_var_selected">extract_var_selected()</a></code> extracts the selected variables (both exposure
and covariates)in the final model after covariate selection.
</p>
</li></ul>


<hr>
<h2 id='loo'>Efficient approximate leave-one-out cross-validation (LOO)</h2><span id='topic+loo'></span><span id='topic+loo.ermod'></span><span id='topic+loo.ermod_emax'></span><span id='topic+loo.ermod_bin_emax'></span>

<h3>Description</h3>

<p>See <code><a href="loo.html#topic+loo">loo::loo()</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loo(x, ...)

## S3 method for class 'ermod'
loo(x, ...)

## S3 method for class 'ermod_emax'
loo(x, ...)

## S3 method for class 'ermod_bin_emax'
loo(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loo_+3A_x">x</code></td>
<td>
<p>An object of class <code>ermod</code></p>
</td></tr>
<tr><td><code id="loo_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>loo::loo()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>loo</code>
</p>

<hr>
<h2 id='p_direction'>Probability of Direction (pd)</h2><span id='topic+p_direction'></span><span id='topic+p_direction.ermod_bin'></span>

<h3>Description</h3>

<p>Compute the <strong>Probability of Direction</strong> (<em><strong>pd</strong></em>). Although differently
expressed, this index is fairly similar (<em>i.e.</em>, is strongly correlated) to
the frequentist <strong>p-value</strong>. See <code><a href="bayestestR.html#topic+p_direction">bayestestR::p_direction()</a></code> and
<code>vignette("overview_of_vignettes", package = "bayestestR")</code> &gt;
&quot;Probability of Direction (pd)&quot; page for details.
For converting <strong>pd</strong> to a frequentist <strong>p-value</strong>,
see <code><a href="bayestestR.html#topic+pd_to_p">bayestestR::pd_to_p()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p_direction(x, ...)

## S3 method for class 'ermod_bin'
p_direction(
  x,
  null = 0,
  as_p = FALSE,
  as_num = FALSE,
  direction = "two-sided",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p_direction_+3A_x">x</code></td>
<td>
<p>An object of class <code>ermod_bin_*</code></p>
</td></tr>
<tr><td><code id="p_direction_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="bayestestR.html#topic+p_direction">bayestestR::p_direction()</a></code>.</p>
</td></tr>
<tr><td><code id="p_direction_+3A_null">null</code></td>
<td>
<p>The null hypothesis value. Default is 0.</p>
</td></tr>
<tr><td><code id="p_direction_+3A_as_p">as_p</code></td>
<td>
<p>If <code>TRUE</code>, the p-direction (pd) values are converted to a
frequentist p-value using <code><a href="bayestestR.html#topic+pd_to_p">bayestestR::pd_to_p()</a></code>. Only works when
<code>as_num = TRUE</code>.</p>
</td></tr>
<tr><td><code id="p_direction_+3A_as_num">as_num</code></td>
<td>
<p>If <code>TRUE</code>, the output is converted to a numeric value.</p>
</td></tr>
<tr><td><code id="p_direction_+3A_direction">direction</code></td>
<td>
<p>What type of p-value is requested or provided with
as_p = TRUE. Can be <code>"two-sided"</code> (default, two tailed) or <code>"one-sided"</code>
(one tailed).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the class <code style="white-space: pre;">&#8288;ermod_bin_*&#8288;</code>, it only calculates the <strong>pd</strong> for
the exposure variable.
</p>


<h3>Value</h3>

<p>See <code><a href="bayestestR.html#topic+p_direction">bayestestR::p_direction()</a></code> for details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
df_er_dr2 &lt;-
  d_sim_binom_cov |&gt;
  dplyr::filter(
    AETYPE == "dr2",
    ID %in% seq(1, 500, by = 5)
  ) |&gt;
  dplyr::mutate(AUCss_1000 = AUCss / 1000, BHBA1C_5 = BHBA1C / 5)

ermod_bin &lt;- dev_ermod_bin(
  data = df_er_dr2,
  var_resp = "AEFLAG",
  var_exposure = "AUCss_1000",
  var_cov = "BHBA1C_5"
)

p_direction(ermod_bin, as_num = TRUE, as_p = TRUE)


</code></pre>

<hr>
<h2 id='plot_cov_sel'>Plot variable selection performance</h2><span id='topic+plot_cov_sel'></span><span id='topic+plot_submod_performance'></span><span id='topic+plot_var_ranking'></span>

<h3>Description</h3>

<p>Plot variable selection performance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_submod_performance(x)

plot_var_ranking(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_cov_sel_+3A_x">x</code></td>
<td>
<p>An object of class <code>ermod_bin_cov_sel</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+plot_submod_performance">plot_submod_performance()</a></code> plots the performance of submodels
evaluated during variable selection.
</p>
<p><code><a href="#topic+plot_var_ranking">plot_var_ranking()</a></code> plots the variable ranking
evaluated during variable selection.
</p>


<h3>Value</h3>

<p>No return value, called for plotting side effect.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(d_sim_binom_cov_hgly2)

er_binary_cov_model_kfold &lt;- dev_ermod_bin_cov_sel(
  data = d_sim_binom_cov_hgly2,
  var_resp = "AEFLAG",
  var_exposure = "AUCss_1000",
  var_cov_candidate = c(
    "BAGE_10", "BWT_10", "BGLUC",
    "BHBA1C_5", "RACE", "VISC"
  ),
  cv_method = "kfold",
  k = 3, # Choose 3 to make the example go fast
  validate_search = TRUE,
)

plot_submod_performance(er_binary_cov_model_kfold)
plot_var_ranking(er_binary_cov_model_kfold)


</code></pre>

<hr>
<h2 id='plot_coveff'>Visualize the covariate effects for ER model</h2><span id='topic+plot_coveff'></span><span id='topic+plot_coveff.ermod'></span><span id='topic+plot_coveff.coveffsim'></span>

<h3>Description</h3>

<p>Visualize the covariate effects for ER model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_coveff(x, ...)

## S3 method for class 'ermod'
plot_coveff(
  x,
  data = NULL,
  spec_coveff = NULL,
  qi_width = 0.9,
  qi_width_cov = 0.9,
  ...
)

## S3 method for class 'coveffsim'
plot_coveff(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_coveff_+3A_x">x</code></td>
<td>
<p>an object of class <code>ermod</code>, <code>coveffsim</code>,
or their subclasses</p>
</td></tr>
<tr><td><code id="plot_coveff_+3A_...">...</code></td>
<td>
<p>currently not used</p>
</td></tr>
<tr><td><code id="plot_coveff_+3A_data">data</code></td>
<td>
<p>an optional data frame to derive the covariate values for
forest plots. If NULL (default), the data used to fit the model is used.</p>
</td></tr>
<tr><td><code id="plot_coveff_+3A_spec_coveff">spec_coveff</code></td>
<td>
<p>you can supply spec_coveff to <code><a href="#topic+sim_coveff">sim_coveff()</a></code> or
<code><a href="#topic+plot_coveff">plot_coveff()</a></code>, if you have already built it manually or with
<code><a href="#topic+build_spec_coveff">build_spec_coveff()</a></code>. See <code><a href="#topic+build_spec_coveff">build_spec_coveff()</a></code> for detail.</p>
</td></tr>
<tr><td><code id="plot_coveff_+3A_qi_width">qi_width</code></td>
<td>
<p>the width of the credible interval on the covariate effect.
This translate to the width of the error bars in the forest plot.</p>
</td></tr>
<tr><td><code id="plot_coveff_+3A_qi_width_cov">qi_width_cov</code></td>
<td>
<p>the width of the quantile interval for continuous
covariates in the forest plot. Default is 0.9 (i.e. visualize effect of
covariate effect at their 5th and 95th percentile values).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(d_sim_binom_cov_hgly2)

ermod_bin &lt;- dev_ermod_bin(
  data = d_sim_binom_cov_hgly2,
  var_resp = "AEFLAG",
  var_exposure = "AUCss_1000",
  var_cov = "BHBA1C_5",
)

plot_coveff(ermod_bin)


</code></pre>

<hr>
<h2 id='plot_er'>Plot ER model simulations</h2><span id='topic+plot_er'></span><span id='topic+plot_er.ersim_med_qi'></span><span id='topic+plot_er.ersim'></span><span id='topic+plot_er.ermod'></span>

<h3>Description</h3>

<p>Plot ER model simulations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_er(x, ...)

## S3 method for class 'ersim_med_qi'
plot_er(
  x,
  show_orig_data = FALSE,
  show_coef_exp = FALSE,
  show_caption = FALSE,
  options_orig_data = list(),
  options_coef_exp = list(),
  options_caption = list(),
  ...
)

## S3 method for class 'ersim'
plot_er(
  x,
  show_orig_data = FALSE,
  show_coef_exp = FALSE,
  show_caption = FALSE,
  options_orig_data = list(),
  options_coef_exp = list(),
  options_caption = list(),
  qi_width_sim = 0.95,
  ...
)

## S3 method for class 'ermod'
plot_er(
  x,
  show_orig_data = FALSE,
  show_coef_exp = FALSE,
  show_caption = FALSE,
  options_orig_data = list(),
  options_coef_exp = list(),
  options_caption = list(),
  n_draws_sim = if (marginal) 200 else NULL,
  seed_sample_draws = NULL,
  marginal = FALSE,
  exposure_range = NULL,
  num_exposures = 51,
  qi_width_sim = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_er_+3A_x">x</code></td>
<td>
<p>an object of class <code>ermod</code>, <code>ersim</code>,<code>ersim_med_qi</code>,
or their subclasses</p>
</td></tr>
<tr><td><code id="plot_er_+3A_...">...</code></td>
<td>
<p>currently not used</p>
</td></tr>
<tr><td><code id="plot_er_+3A_show_orig_data">show_orig_data</code></td>
<td>
<p>logical, whether to show the data points in the
model development dataset. Default is <code>FALSE</code>. Only support plotting
with data that was used in the model development. If you want to use
other data, consider adding geom_point() to the plot manually.</p>
</td></tr>
<tr><td><code id="plot_er_+3A_show_coef_exp">show_coef_exp</code></td>
<td>
<p>logical, whether to show the credible interval
of the exposure coefficient. Default is <code>FALSE</code>. This is only available
for linear and linear logistic regression models.</p>
</td></tr>
<tr><td><code id="plot_er_+3A_show_caption">show_caption</code></td>
<td>
<p>logical, whether to show the caption note for the plot.
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_er_+3A_options_orig_data">options_orig_data</code></td>
<td>
<p>List of options for configuring how original data
is displayed. Possible options include:
</p>

<ul>
<li> <p><code>add_boxplot</code>: Logical, whether to add a boxplot of exposure values.
Default is <code>FALSE</code>.
</p>
</li>
<li> <p><code>boxplot_height</code>: Height of the boxplot relative to the main plot.
Default is <code>0.15</code>.
</p>
</li>
<li> <p><code>show_boxplot_y_title</code>: Logical, whether to show the y-axis title
for the boxplot. Default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>var_group</code>: The column to use for grouping data for plotting.
If specified, observed data points and boxplot will be grouped
and colored by this column. Default is <code>NULL</code>.
</p>
</li>
<li> <p><code>n_bins</code>: Number of bins to use for observed probability
summary. Only relevant for binary models. Default is <code>4</code>.
</p>
</li>
<li> <p><code>qi_width</code>: Width of the quantile interval (confidence interval) for
the observed probability summary. Only relevant for binary models.
Default is <code>0.95</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot_er_+3A_options_coef_exp">options_coef_exp</code></td>
<td>
<p>List of options for configuring how the exposure
coefficient credible interval is displayed. Possible options include:
</p>

<ul>
<li> <p><code>qi_width</code>: Width of the quantile interval (credible interval) for
the exposure coefficient. Default is <code>0.95</code>.
</p>
</li>
<li> <p><code>n_sigfig</code>: Number of significant figures to display. Default is <code>3</code>.
</p>
</li>
<li> <p><code>pos_x</code>: x-coordinate of the text label. If <code>NULL</code> (default), it is
set to the minimum value for the exposure variable.
</p>
</li>
<li> <p><code>pos_y</code>: y-coordinate of the text label. If <code>NULL</code> (default), it is
set to 0.9 for logistic regression models and the maximum value of the
response variable in the original data for linear regression models.
</p>
</li>
<li> <p><code>size</code>: Size of the text label. Default is <code>4</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot_er_+3A_options_caption">options_caption</code></td>
<td>
<p>List of options for configuring the caption note.
Possible options include:
</p>

<ul>
<li> <p><code>orig_data</code>: Logical, whether to show the caption note for the
observed data. Default is <code>FALSE</code>.
</p>
</li>
<li> <p><code>orig_data_summary</code>: Logical, whether to show the caption note for the
observed data summary. Default is <code>FALSE</code>.
Only relevant for binary models.
</p>
</li>
<li> <p><code>coef_exp</code>: Logical, whether to show the caption note for the
exposure coefficient credible interval. Default is <code>FALSE</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot_er_+3A_qi_width_sim">qi_width_sim</code></td>
<td>
<p>Width of the quantile interval to summarize simulated
draws.</p>
</td></tr>
<tr><td><code id="plot_er_+3A_n_draws_sim">n_draws_sim</code></td>
<td>
<p>Number of draws to simulate response for each exposure
value. Set to NULL to use all draws in the model object. Default is NULL
unless marginal is set to TRUE (in that case 200 by default to reduce
computation time).</p>
</td></tr>
<tr><td><code id="plot_er_+3A_seed_sample_draws">seed_sample_draws</code></td>
<td>
<p>Seed for sampling draws. Default is NULL.</p>
</td></tr>
<tr><td><code id="plot_er_+3A_marginal">marginal</code></td>
<td>
<p>logical, whether to use marginal ER simulation. Default
to <code>FALSE</code>. Need to set to <code>TRUE</code> if the model has covariates for the
plot to work.</p>
</td></tr>
<tr><td><code id="plot_er_+3A_exposure_range">exposure_range</code></td>
<td>
<p>Only relevant when the input x is an <code>ermod</code> object.
Range of exposure values to simulate. If NULL
(default), it is set to the range of the exposure variable in the original
data for model development.</p>
</td></tr>
<tr><td><code id="plot_er_+3A_num_exposures">num_exposures</code></td>
<td>
<p>Only relevant as with <code>exposure_range</code>.
Number of exposure values to simulate.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plotting with <code>ermod</code> is done with some default values. If they are not
suitable, you can always perform the simulation manually and use
<code>plot_er()</code> on the simulated data.
</p>


<h3>Value</h3>

<p>A ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(d_sim_binom_cov_hgly2)

ermod_bin &lt;- dev_ermod_bin(
  data = d_sim_binom_cov_hgly2,
  var_resp = "AEFLAG",
  var_exposure = "AUCss_1000"
)

ersim_med_qi &lt;- sim_er_curve(
  ermod_bin,
  output_type = "median_qi"
)

plot_er(ersim_med_qi, show_orig_data = TRUE) +
  xgxr::xgx_scale_x_log10()


</code></pre>

<hr>
<h2 id='plot_er_exp_sel'>Plot exposure metric selection comparison</h2><span id='topic+plot_er_exp_sel'></span>

<h3>Description</h3>

<p>Plot ER curve for each exposure metric and compare them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_er_exp_sel(x, n_draws_sim = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_er_exp_sel_+3A_x">x</code></td>
<td>
<p>An object of class <code>ermod_bin_exp_sel</code></p>
</td></tr>
<tr><td><code id="plot_er_exp_sel_+3A_n_draws_sim">n_draws_sim</code></td>
<td>
<p>Number of draws to simulate response for each exposure
value. Default is NULL (use all draws in the model object)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for plotting side effect.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(d_sim_binom_cov_hgly2)

ermod_bin_exp_sel &lt;-
  dev_ermod_bin_exp_sel(
    data = d_sim_binom_cov_hgly2,
    var_resp = "AEFLAG",
    var_exp_candidates = c("AUCss_1000", "Cmaxss", "Cminss")
  )

plot_er_exp_sel(ermod_bin_exp_sel) + xgxr::xgx_scale_x_log10()


</code></pre>

<hr>
<h2 id='plot_er_gof'>Default GOF plot for ER model</h2><span id='topic+plot_er_gof'></span>

<h3>Description</h3>

<p>This is a wrapper function for <code><a href="#topic+plot_er">plot_er()</a></code> with default options for
goodness-of-fit (GOF) plots for ER models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_er_gof(
  x,
  add_boxplot = !is.null(var_group),
  boxplot_height = 0.15,
  show_boxplot_y_title = FALSE,
  var_group = NULL,
  n_bins = 4,
  qi_width_obs = 0.95,
  show_coef_exp = FALSE,
  coef_pos_x = NULL,
  coef_pos_y = NULL,
  coef_size = 4,
  qi_width_coef = 0.95,
  qi_width_sim = 0.95,
  show_caption = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_er_gof_+3A_x">x</code></td>
<td>
<p>an object of class <code>ermod</code>, <code>ersim</code>,<code>ersim_med_qi</code>,
or their subclasses</p>
</td></tr>
<tr><td><code id="plot_er_gof_+3A_add_boxplot">add_boxplot</code></td>
<td>
<p>Logical, whether to add a boxplot of exposure values.
Default is <code>TRUE</code> if <code>var_group</code> is specified, otherwise <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_er_gof_+3A_boxplot_height">boxplot_height</code></td>
<td>
<p>Height of the boxplot relative to the main plot.
Default is <code>0.15</code>.</p>
</td></tr>
<tr><td><code id="plot_er_gof_+3A_show_boxplot_y_title">show_boxplot_y_title</code></td>
<td>
<p>Logical, whether to show the y-axis title
for the boxplot. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_er_gof_+3A_var_group">var_group</code></td>
<td>
<p>The column to use for grouping data for plotting.
If specified, observed data points and boxplot will be grouped
and colored by this column. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot_er_gof_+3A_n_bins">n_bins</code></td>
<td>
<p>Number of bins to use for observed probability
summary. Only relevant for binary models. Default is <code>4</code>.</p>
</td></tr>
<tr><td><code id="plot_er_gof_+3A_qi_width_obs">qi_width_obs</code></td>
<td>
<p>Confidence level for the observed probability
summary. Default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="plot_er_gof_+3A_show_coef_exp">show_coef_exp</code></td>
<td>
<p>Logical, whether to show the credible interval
of the exposure coefficient. Default is <code>FALSE</code>. This is only available
for linear and linear logistic regression models.</p>
</td></tr>
<tr><td><code id="plot_er_gof_+3A_coef_pos_x">coef_pos_x</code></td>
<td>
<p>x-coordinate of the text label. If <code>NULL</code> (default), it is
set to the minimum value for the exposure variable.</p>
</td></tr>
<tr><td><code id="plot_er_gof_+3A_coef_pos_y">coef_pos_y</code></td>
<td>
<p>y-coordinate of the text label. If <code>NULL</code> (default), it is
set to 0.9 for logistic regression models and the maximum value of the
response variable in the original data for linear regression models.</p>
</td></tr>
<tr><td><code id="plot_er_gof_+3A_coef_size">coef_size</code></td>
<td>
<p>Size of the text label. Default is <code>4</code>.</p>
</td></tr>
<tr><td><code id="plot_er_gof_+3A_qi_width_coef">qi_width_coef</code></td>
<td>
<p>Width of the credible interval for the exposure
coefficient. Default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="plot_er_gof_+3A_qi_width_sim">qi_width_sim</code></td>
<td>
<p>Width of the quantile interval to summarize simulated
draws. Default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="plot_er_gof_+3A_show_caption">show_caption</code></td>
<td>
<p>Logical, whether to show the caption note for the
plot. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following code will generate the same plot:
</p>
<pre>
plot_er(
  x,
  show_orig_data = TRUE,
  show_coef_exp = show_coef_exp,
  show_caption = show_caption,
  options_orig_data = list(
    add_boxplot = add_boxplot, boxplot_height = boxplot_height,
    show_boxplot_y_title = show_boxplot_y_title,
    var_group = var_group,
    n_bins = n_bins, qi_width = qi_width_obs
  ),
  options_coef_exp = list(
    qi_width = qi_width_coef, pos_x = coef_pos_x, pos_y = coef_pos_y,
    size = coef_size
  ),
  options_caption = list(
    orig_data_summary = TRUE, coef_exp = show_coef_exp
  ),
  qi_width_sim = qi_width_sim
)
</pre>


<h3>Value</h3>

<p>A ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(d_sim_binom_cov_hgly2)

ermod_bin &lt;- dev_ermod_bin(
  data = d_sim_binom_cov_hgly2,
  var_resp = "AEFLAG",
  var_exposure = "AUCss_1000"
)

plot_er_gof(ermod_bin, var_group = "Dose_mg", show_coef_exp = TRUE)


</code></pre>

<hr>
<h2 id='print_coveff'>Format the covariate effect simulation results for printing</h2><span id='topic+print_coveff'></span>

<h3>Description</h3>

<p>Format the covariate effect simulation results for printing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>print_coveff(
  coveffsim,
  n_sigfig = 3,
  use_seps = TRUE,
  drop_trailing_dec_mark = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print_coveff_+3A_coveffsim">coveffsim</code></td>
<td>
<p>an object of class <code>coveffsim</code></p>
</td></tr>
<tr><td><code id="print_coveff_+3A_n_sigfig">n_sigfig</code></td>
<td>
<p>Number of significant figures to form value_label of
continuous variables. See <code><a href="gt.html#topic+vec_fmt_number">gt::vec_fmt_number()</a></code> for details.</p>
</td></tr>
<tr><td><code id="print_coveff_+3A_use_seps">use_seps</code></td>
<td>
<p>Whether to use separators for thousands in printing numbers.
See <code><a href="gt.html#topic+vec_fmt_number">gt::vec_fmt_number()</a></code> for details.</p>
</td></tr>
<tr><td><code id="print_coveff_+3A_drop_trailing_dec_mark">drop_trailing_dec_mark</code></td>
<td>
<p>Whether to drop the trailing decimal mark
(&quot;.&quot;) in value_label of continuous variables. See <code><a href="gt.html#topic+vec_fmt_number">gt::vec_fmt_number()</a></code>
for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that <code>n_sigfig</code>, <code>use_seps</code>, and <code>drop_trailing_dec_mark</code> are only
applied to the odds ratio and 95% CI columns; value_label column was
already generated in an earlier step in <code><a href="#topic+build_spec_coveff">build_spec_coveff()</a></code> or
<code><a href="#topic+sim_coveff">sim_coveff()</a></code>.
</p>


<h3>Value</h3>

<p>A data frame with the formatted covariate effect simulation results
with the following columns:
</p>

<ul>
<li> <p><code>var_label</code>: the label of the covariate
</p>
</li>
<li> <p><code>value_label</code>: the label of the covariate value
</p>
</li>
<li> <p><code>value_annot</code>: the annotation of the covariate value
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;Odds ratio&#8288;</code>: the odds ratio of the covariate effect
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;95% CI&#8288;</code>: the 95% credible interval of the covariate effect
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>

data(d_sim_binom_cov_hgly2)

ermod_bin &lt;- dev_ermod_bin(
  data = d_sim_binom_cov_hgly2,
  var_resp = "AEFLAG",
  var_exposure = "AUCss_1000",
  var_cov = "BHBA1C_5",
)

print_coveff(sim_coveff(ermod_bin))


</code></pre>

<hr>
<h2 id='run_kfold_cv'>Run k-fold cross-validation</h2><span id='topic+run_kfold_cv'></span>

<h3>Description</h3>

<p>This function performs k-fold cross-validation using the appropriate model
development function based on the class of the <code>ermod</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_kfold_cv(ermod, newdata = NULL, k = 5, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_kfold_cv_+3A_ermod">ermod</code></td>
<td>
<p>An <code>ermod</code> object containing the model and data.</p>
</td></tr>
<tr><td><code id="run_kfold_cv_+3A_newdata">newdata</code></td>
<td>
<p>Optional new dataset to use instead of the original data.
Default is NULL.</p>
</td></tr>
<tr><td><code id="run_kfold_cv_+3A_k">k</code></td>
<td>
<p>The number of folds for cross-validation. Default is 5.</p>
</td></tr>
<tr><td><code id="run_kfold_cv_+3A_seed">seed</code></td>
<td>
<p>Random seed for reproducibility. Default is NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>kfold_cv_ermod</code> class object containing the fitted models and
holdout predictions for each fold.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(d_sim_binom_cov_hgly2)

ermod_bin &lt;- dev_ermod_bin(
  data = d_sim_binom_cov_hgly2,
  var_resp = "AEFLAG",
  var_exposure = "AUCss_1000",
  var_cov = "BHBA1C_5",
  # Settings to make the example run faster
  chains = 2,
  iter = 1000
)

cv_results &lt;- run_kfold_cv(ermod_bin, k = 3, seed = 123)

print(cv_results)


</code></pre>

<hr>
<h2 id='sim_coveff'>Perform simulation of covariate effects for ER model</h2><span id='topic+sim_coveff'></span>

<h3>Description</h3>

<p>Perform simulation of covariate effects for ER model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_coveff(
  ermod,
  data = NULL,
  spec_coveff = NULL,
  output_type = "median_qi",
  qi_width = 0.9,
  qi_width_cov = 0.9
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim_coveff_+3A_ermod">ermod</code></td>
<td>
<p>an object of class <code>ermod</code></p>
</td></tr>
<tr><td><code id="sim_coveff_+3A_data">data</code></td>
<td>
<p>an optional data frame to derive the covariate values for
forest plots. If NULL (default), the data used to fit the model is used.</p>
</td></tr>
<tr><td><code id="sim_coveff_+3A_spec_coveff">spec_coveff</code></td>
<td>
<p>you can supply spec_coveff to <code><a href="#topic+sim_coveff">sim_coveff()</a></code> or
<code><a href="#topic+plot_coveff">plot_coveff()</a></code>, if you have already built it manually or with
<code><a href="#topic+build_spec_coveff">build_spec_coveff()</a></code>. See <code><a href="#topic+build_spec_coveff">build_spec_coveff()</a></code> for detail.</p>
</td></tr>
<tr><td><code id="sim_coveff_+3A_output_type">output_type</code></td>
<td>
<p>Type of output. Currently only supports &quot;median_qi&quot;
which returns the median and quantile interval.</p>
</td></tr>
<tr><td><code id="sim_coveff_+3A_qi_width">qi_width</code></td>
<td>
<p>the width of the credible interval on the covariate effect.
This translate to the width of the error bars in the forest plot.</p>
</td></tr>
<tr><td><code id="sim_coveff_+3A_qi_width_cov">qi_width_cov</code></td>
<td>
<p>the width of the quantile interval for continuous
covariates in the forest plot. Default is 0.9 (i.e. visualize effect of
covariate effect at their 5th and 95th percentile values).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with class <code>coveffsim</code> containing the median and
quantile interval of the covariate effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(d_sim_binom_cov_hgly2)

ermod_bin &lt;- dev_ermod_bin(
  data = d_sim_binom_cov_hgly2,
  var_resp = "AEFLAG",
  var_exposure = "AUCss_1000",
  var_cov = "BHBA1C_5",
)

sim_coveff(ermod_bin)


</code></pre>

<hr>
<h2 id='sim_er'>Simulate from ER model</h2><span id='topic+sim_er'></span>

<h3>Description</h3>

<p>Simulate from ER model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_er(
  ermod,
  newdata = NULL,
  n_draws_sim = NULL,
  seed_sample_draws = NULL,
  output_type = c("draws", "median_qi"),
  qi_width = 0.95,
  .nrow_cov_data = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim_er_+3A_ermod">ermod</code></td>
<td>
<p>An object of class <code>ermod</code></p>
</td></tr>
<tr><td><code id="sim_er_+3A_newdata">newdata</code></td>
<td>
<p>New data to use for simulation.
Default is NULL (use the data in the model object).</p>
</td></tr>
<tr><td><code id="sim_er_+3A_n_draws_sim">n_draws_sim</code></td>
<td>
<p>Number of draws for simulation. If NULL (default),
all draws in the model object are used.</p>
</td></tr>
<tr><td><code id="sim_er_+3A_seed_sample_draws">seed_sample_draws</code></td>
<td>
<p>Seed for sampling draws. Default is NULL.</p>
</td></tr>
<tr><td><code id="sim_er_+3A_output_type">output_type</code></td>
<td>
<p>Type of output. &quot;draws&quot; returns the raw draws from the
simulation, and &quot;median_qi&quot; returns the median and quantile interval.</p>
</td></tr>
<tr><td><code id="sim_er_+3A_qi_width">qi_width</code></td>
<td>
<p>Width of the quantile interval. Default is 0.95. Only
used when <code>output_type = "median_qi"</code>.</p>
</td></tr>
<tr><td><code id="sim_er_+3A_.nrow_cov_data">.nrow_cov_data</code></td>
<td>
<p>Number of rows in the covariate data,
used for internal purposes. Users should not set this argument.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ersim</code> object, which is a tibble with the simulated responses
with some additional information in object attributes.
It has three types of predictions - <code>.linpred</code>, <code>.epred</code>, <code>.prediction</code>.
<code>.linpred</code> and <code>.epred</code> are similar in a way that they both represent
&quot;expected response&quot;, i.e. without residual variability. They are the same
for models with continuous endpoits (Emax model). For models with binary
endpoints, <code>.linpred</code> is the linear predictor (i.e. on the logit scale) and
<code>.epred</code> is on the probability scale. <code>.prediction</code> is the predicted
response with residual variability (or in case of binary endpoint,
the predicted yes (1) or no (0) for event occurrence).
See <code><a href="tidybayes.html#topic+add_predicted_draws">tidybayes::add_epred_draws()</a></code> for more details.
</p>
<p>In case of <code>output_type = "median_qi"</code>, it returns <code>ersim_med_qi</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_ersim_med_qi">calc_ersim_med_qi()</a></code> for calculating median and quantile interval
from <code>ersim</code> object (generated with <code>output_type = "draws"</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_sim_binom_cov_hgly2)

ermod_bin &lt;- dev_ermod_bin(
  data = d_sim_binom_cov_hgly2,
  var_resp = "AEFLAG",
  var_exposure = "AUCss_1000",
  var_cov = "BHBA1C_5",
)

ersim &lt;- sim_er(
  ermod_bin,
  n_draws_sim = 500, # This is set to make the example run faster
  output_type = "draws"
)

ersim_med_qi &lt;- sim_er(
  ermod_bin,
  n_draws_sim = 500, # This is set to make the example run faster
  output_type = "median_qi"
)

ersim
ersim_med_qi


</code></pre>

<hr>
<h2 id='sim_er_new_exp'>Simulate from ER model at specified exposure values</h2><span id='topic+sim_er_new_exp'></span><span id='topic+sim_er_curve'></span>

<h3>Description</h3>

<p>Simulate from ER model at specified exposure values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_er_new_exp(
  ermod,
  exposure_to_sim_vec = NULL,
  data_cov = NULL,
  n_draws_sim = NULL,
  seed_sample_draws = NULL,
  output_type = c("draws", "median_qi"),
  qi_width = 0.95
)

sim_er_curve(
  ermod,
  exposure_range = NULL,
  num_exposures = 51,
  data_cov = NULL,
  n_draws_sim = NULL,
  seed_sample_draws = NULL,
  output_type = c("draws", "median_qi"),
  qi_width = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim_er_new_exp_+3A_ermod">ermod</code></td>
<td>
<p>An object of class <code>ermod</code></p>
</td></tr>
<tr><td><code id="sim_er_new_exp_+3A_exposure_to_sim_vec">exposure_to_sim_vec</code></td>
<td>
<p>Vector of exposure values to simulate.</p>
</td></tr>
<tr><td><code id="sim_er_new_exp_+3A_data_cov">data_cov</code></td>
<td>
<p>Data frame containing covariates to use for simulation,
see details below.</p>
</td></tr>
<tr><td><code id="sim_er_new_exp_+3A_n_draws_sim">n_draws_sim</code></td>
<td>
<p>Number of draws for simulation. If NULL (default),
all draws in the model object are used.</p>
</td></tr>
<tr><td><code id="sim_er_new_exp_+3A_seed_sample_draws">seed_sample_draws</code></td>
<td>
<p>Seed for sampling draws. Default is NULL.</p>
</td></tr>
<tr><td><code id="sim_er_new_exp_+3A_output_type">output_type</code></td>
<td>
<p>Type of output. &quot;draws&quot; returns the raw draws from the
simulation, and &quot;median_qi&quot; returns the median and quantile interval.</p>
</td></tr>
<tr><td><code id="sim_er_new_exp_+3A_qi_width">qi_width</code></td>
<td>
<p>Width of the quantile interval. Default is 0.95. Only
used when <code>output_type = "median_qi"</code>.</p>
</td></tr>
<tr><td><code id="sim_er_new_exp_+3A_exposure_range">exposure_range</code></td>
<td>
<p>Range of exposure values to simulate. If NULL
(default), it is set to the range of the exposure variable in the original
data for model development.</p>
</td></tr>
<tr><td><code id="sim_er_new_exp_+3A_num_exposures">num_exposures</code></td>
<td>
<p>Number of exposure values to simulate.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simulation dataset will be all combinations of covariates in <code>data_cov</code>
and exposure values in <code>exposure_to_sim_vec</code>,
so the run time can become very long if <code>data_cov</code> has many rows.
</p>
<p><code>data_cov</code> has to be supplied if <code>ermod</code> is a model with covariates.
It is recommended that <code>data_cov</code> contains subject identifiers such as
<code>ID</code> for post-processing.
</p>
<p>Exposure values in <code>data_cov</code> will be ignored.
</p>
<p><code><a href="#topic+sim_er_curve">sim_er_curve()</a></code> is a wrapper function for <code><a href="#topic+sim_er_new_exp">sim_er_new_exp()</a></code>
that use a range of exposure values to simulate the expected responses.
Particularly useful for plotting the exposure-response curve.
</p>


<h3>Value</h3>

<p><code>ersim</code> object, which is a tibble with the simulated responses
with some additional information in object attributes.
It has three types of predictions - <code>.linpred</code>, <code>.epred</code>, <code>.prediction</code>.
<code>.linpred</code> and <code>.epred</code> are similar in a way that they both represent
&quot;expected response&quot;, i.e. without residual variability. They are the same
for models with continuous endpoits (Emax model). For models with binary
endpoints, <code>.linpred</code> is the linear predictor (i.e. on the logit scale) and
<code>.epred</code> is on the probability scale. <code>.prediction</code> is the predicted
response with residual variability (or in case of binary endpoint,
the predicted yes (1) or no (0) for event occurrence).
See <code><a href="tidybayes.html#topic+add_predicted_draws">tidybayes::add_epred_draws()</a></code> for more details.
</p>
<p>In case of <code>output_type = "median_qi"</code>, it returns <code>ersim_med_qi</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_ersim_med_qi">calc_ersim_med_qi()</a></code> for calculating median and quantile interval
from <code>ersim</code> object (generated with <code>output_type = "draws"</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_sim_binom_cov_hgly2)

ermod_bin &lt;- dev_ermod_bin(
  data = d_sim_binom_cov_hgly2,
  var_resp = "AEFLAG",
  var_exposure = "AUCss_1000",
  var_cov = "BHBA1C_5",
)

ersim_new_exp_med_qi &lt;- sim_er_new_exp(
  ermod_bin,
  exposure_to_sim_vec = seq(2, 6, by = 0.2),
  data_cov = dplyr::tibble(BHBA1C_5 = 4:10),
  n_draws_sim = 500, # This is set to make the example run faster
  output_type = "median_qi"
)

ersim_new_exp_med_qi


</code></pre>

<hr>
<h2 id='sim_er_new_exp_marg'>Calculate marginal expected response for specified exposure values</h2><span id='topic+sim_er_new_exp_marg'></span><span id='topic+sim_er_curve_marg'></span>

<h3>Description</h3>

<p>Responses at specified exposure values are calculated for <code>n_subj_sim</code>
subjects with different covariates (sampled from <code>newdata</code>),
and the predicted responses are &quot;marginalized&quot; (averaged),
resulting in marginal expected response on the
population of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_er_new_exp_marg(
  ermod,
  exposure_to_sim_vec = NULL,
  data_cov = extract_data(ermod),
  n_subj_sim = 100,
  n_draws_sim = 500,
  seed_sample_draws = NULL,
  output_type = c("draws", "median_qi"),
  qi_width = 0.95
)

sim_er_curve_marg(
  ermod,
  exposure_range = NULL,
  num_exposures = 51,
  data_cov = extract_data(ermod),
  n_subj_sim = 100,
  n_draws_sim = 500,
  seed_sample_draws = NULL,
  output_type = c("draws", "median_qi"),
  qi_width = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim_er_new_exp_marg_+3A_ermod">ermod</code></td>
<td>
<p>An object of class <code>ermod</code></p>
</td></tr>
<tr><td><code id="sim_er_new_exp_marg_+3A_exposure_to_sim_vec">exposure_to_sim_vec</code></td>
<td>
<p>Vector of exposure values to simulate.</p>
</td></tr>
<tr><td><code id="sim_er_new_exp_marg_+3A_data_cov">data_cov</code></td>
<td>
<p>Data frame containing covariates to use for simulation.
Different from <code><a href="#topic+sim_er_new_exp">sim_er_new_exp()</a></code>, <code>data_cov</code> can be large as long as
<code>n_subj_sim</code> is set to a reasonable number. Default is set to
<code>extract_data(ermod)</code> which is the full data used to fit the model.</p>
</td></tr>
<tr><td><code id="sim_er_new_exp_marg_+3A_n_subj_sim">n_subj_sim</code></td>
<td>
<p>Maximum number of subjects to simulate. Default of 100
should be sufficient in many cases, as it's only used for marginal
response calculation.
Set to NULL to use all subjects in <code>data_cov</code> without resampling;
in this case, be mindful of the computation time.</p>
</td></tr>
<tr><td><code id="sim_er_new_exp_marg_+3A_n_draws_sim">n_draws_sim</code></td>
<td>
<p>Number of draws for simulation. Default is set to 500
to reduce computation time for marginal response calculation.</p>
</td></tr>
<tr><td><code id="sim_er_new_exp_marg_+3A_seed_sample_draws">seed_sample_draws</code></td>
<td>
<p>Seed for sampling draws. Default is NULL.</p>
</td></tr>
<tr><td><code id="sim_er_new_exp_marg_+3A_output_type">output_type</code></td>
<td>
<p>Type of output. &quot;draws&quot; returns the raw draws from the
simulation, and &quot;median_qi&quot; returns the median and quantile interval.</p>
</td></tr>
<tr><td><code id="sim_er_new_exp_marg_+3A_qi_width">qi_width</code></td>
<td>
<p>Width of the quantile interval. Default is 0.95. Only
used when <code>output_type = "median_qi"</code>.</p>
</td></tr>
<tr><td><code id="sim_er_new_exp_marg_+3A_exposure_range">exposure_range</code></td>
<td>
<p>Range of exposure values to simulate. If NULL
(default), it is set to the range of the exposure variable in the original
data for model development.</p>
</td></tr>
<tr><td><code id="sim_er_new_exp_marg_+3A_num_exposures">num_exposures</code></td>
<td>
<p>Number of exposure values to simulate.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+sim_er_new_exp_marg">sim_er_new_exp_marg()</a></code> returns a tibble with the marginal expected
response for each exposure value in <code>exposure_to_sim_vec</code>.
</p>
<p><code><a href="#topic+sim_er_curve_marg">sim_er_curve_marg()</a></code> is a wrapper function for <code><a href="#topic+sim_er_new_exp_marg">sim_er_new_exp_marg()</a></code>
that use a range of exposure values to simulate the marginal expected
responses. Particularly useful for plotting the exposure-response curve.
</p>


<h3>Value</h3>

<p><code>ersim_marg</code> object, which is a tibble with the simulated marginal
expected response with some additional information in object attributes.
In case of <code>output_type = "median_qi"</code>, it returns <code>ersim_marg_med_qi</code>
object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_ersim_med_qi">calc_ersim_med_qi()</a></code> for calculating median and quantile interval
from <code>ersim_marg</code> object (generated with <code>output_type = "draws"</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_sim_binom_cov_hgly2)

ermod_bin &lt;- dev_ermod_bin(
  data = d_sim_binom_cov_hgly2,
  var_resp = "AEFLAG",
  var_exposure = "AUCss_1000",
  var_cov = "BHBA1C_5",
)

ersim_new_exp_marg_med_qi &lt;- sim_er_new_exp_marg(
  ermod_bin,
  exposure_to_sim_vec = seq(2, 6, by = 0.2),
  data_cov = dplyr::tibble(BHBA1C_5 = 4:10),
  n_subj_sim = NULL,
  n_draws_sim = 500, # This is set to make the example run faster
  output_type = "median_qi"
)

ersim_new_exp_marg_med_qi


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
