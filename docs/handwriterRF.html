<!DOCTYPE html><html lang="en"><head><title>Help for package handwriterRF</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {handwriterRF}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#handwriterRF-package'><p>handwriterRF: Handwriting Analysis with Random Forests</p></a></li>
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#calculate_slr'><p>Calculate a Score-Based Likelihood Ratio</p></a></li>
<li><a href='#cfc'><p>A Dataframe of Cluster Fill Counts</p></a></li>
<li><a href='#compare_documents'><p>Compare Documents</p></a></li>
<li><a href='#compare_writer_profiles'><p>Compare Writer Profiles</p></a></li>
<li><a href='#get_cluster_fill_rates'><p>Get Cluster Fill Rates</p></a></li>
<li><a href='#get_distances'><p>Get Distances</p></a></li>
<li><a href='#get_rates_of_misleading_slrs'><p>Get Rates of Misleading Evidence for SLRs</p></a></li>
<li><a href='#get_ref_scores'><p>Get Reference Scores</p></a></li>
<li><a href='#interpret_slr'><p>Interpret an SLR Value</p></a></li>
<li><a href='#plot_scores'><p>Plot Scores</p></a></li>
<li><a href='#random_forest'><p>A <span class="pkg">ranger</span> Random Forest and Data Frame of Distances</p></a></li>
<li><a href='#ref_scores'><p>Reference Similarity Scores</p></a></li>
<li><a href='#templateK40'><p>Cluster Template with 40 Clusters</p></a></li>
<li><a href='#test'><p>A Test Set of Cluster Fill Rates</p></a></li>
<li><a href='#train'><p>A Training Set of Cluster Fill Rates</p></a></li>
<li><a href='#train_rf'><p>Train a Random Forest</p></a></li>
<li><a href='#validation'><p>A Validation Set of Cluster Fill Rates</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Handwriting Analysis with Random Forests</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stephanie Reinders &lt;reinders.stephanie@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Perform forensic handwriting analysis of two scanned handwritten documents. This package implements the statistical method described by Madeline Johnson and Danica Ommen (2021) &lt;<a href="https://doi.org/10.1002%2Fsam.11566">doi:10.1002/sam.11566</a>&gt;. Similarity measures and a random forest produce a score-based likelihood ratio that quantifies the strength of the evidence in favor of the documents being written by the same writer or different writers.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2, knitr, rmarkdown, testthat (&ge; 3.0.0), tibble</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, handwriter (&ge; 3.2.4), lifecycle, magrittr, purrr,
ranger, reshape2, stringr, tidyr, tidyselect</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/CSAFE-ISU/handwriterRF">https://github.com/CSAFE-ISU/handwriterRF</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/CSAFE-ISU/handwriterRF/issues">https://github.com/CSAFE-ISU/handwriterRF/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-28 21:29:07 UTC; stephanie</td>
</tr>
<tr>
<td>Author:</td>
<td>Iowa State University of Science and Technology on behalf of its Center
    for Statistics and Applications in Forensic Evidence [aut, cph,
    fnd],
  Stephanie Reinders [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-29 00:20:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='handwriterRF-package'>handwriterRF: Handwriting Analysis with Random Forests</h2><span id='topic+handwriterRF'></span><span id='topic+handwriterRF-package'></span>

<h3>Description</h3>

<p>Perform forensic handwriting analysis of two scanned handwritten documents. This package implements the statistical method described by Madeline Johnson and Danica Ommen (2021) <a href="https://doi.org/10.1002/sam.11566">doi:10.1002/sam.11566</a>. Similarity measures and a random forest produce a score-based likelihood ratio that quantifies the strength of the evidence in favor of the documents being written by the same writer or different writers.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Stephanie Reinders <a href="mailto:reinders.stephanie@gmail.com">reinders.stephanie@gmail.com</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Iowa State University of Science and Technology on behalf of its Center for Statistics and Applications in Forensic Evidence [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/CSAFE-ISU/handwriterRF">https://github.com/CSAFE-ISU/handwriterRF</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/CSAFE-ISU/handwriterRF/issues">https://github.com/CSAFE-ISU/handwriterRF/issues</a>
</p>
</li></ul>


<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='calculate_slr'>Calculate a Score-Based Likelihood Ratio</h2><span id='topic+calculate_slr'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a> <code>calculate_slr</code> has been superseded in
favor of <code>compare_documents()</code> which offers more functionality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_slr(
  sample1_path,
  sample2_path,
  rforest = NULL,
  reference_scores = NULL,
  project_dir = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_slr_+3A_sample1_path">sample1_path</code></td>
<td>
<p>A file path to a handwriting sample saved in PNG file
format.</p>
</td></tr>
<tr><td><code id="calculate_slr_+3A_sample2_path">sample2_path</code></td>
<td>
<p>A file path to a second handwriting sample saved in PNG
file format.</p>
</td></tr>
<tr><td><code id="calculate_slr_+3A_rforest">rforest</code></td>
<td>
<p>Optional. A random forest trained with <span class="pkg">ranger</span>. If no
random forest is specified, <code>random_forest</code> will be used.</p>
</td></tr>
<tr><td><code id="calculate_slr_+3A_reference_scores">reference_scores</code></td>
<td>
<p>Optional. A dataframe of reference similarity
scores. If reference scores is not specified, <code>ref_scores</code> will be used.</p>
</td></tr>
<tr><td><code id="calculate_slr_+3A_project_dir">project_dir</code></td>
<td>
<p>A path to a directory where helper files will be saved. If
no project directory is specified, the helper files will be saved to
tempdir() and deleted before the function terminates.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compares two handwriting
samples scanned and saved a PNG images with the following steps:
</p>

<ol>
<li> <p><code><a href="handwriter.html#topic+processDocument">processDocument</a></code> splits the writing in both samples into component shapes, or graphs.
</p>
</li>
<li> <p><code><a href="handwriter.html#topic+get_clusters_batch">get_clusters_batch</a></code> groups the graphs into clusters of similar shapes.
</p>
</li>
<li> <p><code><a href="handwriter.html#topic+get_cluster_fill_counts">get_cluster_fill_counts</a></code> counts the number of graphs assigned to each cluster.
</p>
</li>
<li> <p><code><a href="#topic+get_cluster_fill_rates">get_cluster_fill_rates</a></code> calculates the proportion of graphs assigned to each cluster. The cluster fill rates serve as a writer profile.
</p>
</li>
<li><p> A similarity score is calculated between the cluster fill rates of the two documents using a random forest trained with <span class="pkg">ranger</span>.
</p>
</li>
<li><p> The similarity score is compared to reference distributions of same writer and different
writer similarity scores. The result is a score-based likelihood ratio that conveys the strength
of the evidence in favor of same writer or different writer. For more details, see Madeline
Johnson and Danica Ommen (2021) <a href="doi:10.1002/sam.11566">doi:10.1002/sam.11566</a>.
</p>
</li></ol>



<h3>Value</h3>

<p>A dataframe
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Compare two samples from the same writer
s1 &lt;- system.file(file.path("extdata", "docs", "w0005_s01_pLND_r03.png"),
  package = "handwriterRF"
)
s2 &lt;- system.file(file.path("extdata", "docs", "w0005_s02_pWOZ_r02.png"),
  package = "handwriterRF"
)
calculate_slr(s1, s2)

# Compare samples from two writers
s1 &lt;- system.file(file.path("extdata", "docs", "w0005_s02_pWOZ_r02.png"),
  package = "handwriterRF"
)
s2 &lt;- system.file(file.path("extdata", "docs", "w0238_s01_pWOZ_r02.png"),
  package = "handwriterRF"
)
calculate_slr(s1, s2)


</code></pre>

<hr>
<h2 id='cfc'>A Dataframe of Cluster Fill Counts</h2><span id='topic+cfc'></span>

<h3>Description</h3>

<p>The cfc dataframe contains cluster fill counts for two documents from the
CSAFE Handwriting Database: w0238_s01_pWOZ_r02.rds and
w0238_s01_pWOZ_r03.rds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cfc
</code></pre>


<h3>Format</h3>

<p>A dataframe with 2 rows and 15 variables:
</p>

<dl>
<dt>docname</dt><dd><p>The file name of the handwriting sample.</p>
</dd>
<dt>writer</dt><dd><p>Writer ID.</p>
</dd>
<dt>doc</dt><dd><p>The name of the handwriting prompt.</p>
</dd>
<dt>3</dt><dd><p>The number of graphs in cluster 3.</p>
</dd>
<dt>10</dt><dd><p>The number of graphs in cluster 10.</p>
</dd>
<dt>12</dt><dd><p>The number of graphs in cluster 12.</p>
</dd>
<dt>15</dt><dd><p>The number of graphs in cluster 15.</p>
</dd>
<dt>16</dt><dd><p>The number of graphs in cluster 16.</p>
</dd>
<dt>17</dt><dd><p>The number of graphs in cluster 17.</p>
</dd>
<dt>19</dt><dd><p>The number of graphs in cluster 19.</p>
</dd>
<dt>20</dt><dd><p>The number of graphs in cluster 20.</p>
</dd>
<dt>23</dt><dd><p>The number of graphs in cluster 23.</p>
</dd>
<dt>25</dt><dd><p>The number of graphs in cluster 25.</p>
</dd>
<dt>27</dt><dd><p>The number of graphs in cluster 27.</p>
</dd>
<dt>29</dt><dd><p>The number of graphs in cluster 29.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The documents were split into graphs with
<code><a href="handwriter.html#topic+process_batch_dir">process_batch_dir</a></code>. The graphs were grouped into
clusters with <code><a href="handwriter.html#topic+get_clusters_batch">get_clusters_batch</a></code> and the cluster
template <code><a href="handwriter.html#topic+templateK40">templateK40</a></code>. The number of graphs in each
cluster, the cluster fill counts, were counted with
<code><a href="handwriter.html#topic+get_cluster_fill_counts">get_cluster_fill_counts</a></code>. The dataframe cfc has a
column for each cluster in <code><a href="handwriter.html#topic+templateK40">templateK40</a></code> that has at
least one graph from w0238_s01_pWOZ_r02.rds or w0238_s01_pWOZ_r03.rds
assigned to it. Empty clusters do not have columns in cfc, so cfc only has 12
cluster columns instead of 40.
</p>


<h3>Source</h3>

<p><a href="https://forensicstats.org/handwritingdatabase/">https://forensicstats.org/handwritingdatabase/</a>
</p>

<hr>
<h2 id='compare_documents'>Compare Documents</h2><span id='topic+compare_documents'></span>

<h3>Description</h3>

<p>Compare two handwritten documents to predict whether they were written by the
same person. Use either a similarity score or a score-based likelihood ratio
as a comparison method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_documents(
  sample1,
  sample2,
  score_only = TRUE,
  rforest = NULL,
  project_dir = NULL,
  reference_scores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_documents_+3A_sample1">sample1</code></td>
<td>
<p>A filepath to a handwritten document scanned and saved as a
PNG file.</p>
</td></tr>
<tr><td><code id="compare_documents_+3A_sample2">sample2</code></td>
<td>
<p>A filepath to a handwritten document scanned and saved as a
PNG file.</p>
</td></tr>
<tr><td><code id="compare_documents_+3A_score_only">score_only</code></td>
<td>
<p>TRUE returns only the similarity score. FALSE returns the
similarity score and a score-based likelihood ratio for that score,
calculated using <code>reference_scores</code>.</p>
</td></tr>
<tr><td><code id="compare_documents_+3A_rforest">rforest</code></td>
<td>
<p>Optional. A random forest created with <code><a href="ranger.html#topic+ranger">ranger::ranger()</a></code>.
If a random forest is not supplied, <code>random_forest</code> will be used.</p>
</td></tr>
<tr><td><code id="compare_documents_+3A_project_dir">project_dir</code></td>
<td>
<p>Optional. A folder in which to save helper files and a CSV
file with the results. If no project directory is supplied. Helper files
will be saved to tempdir() &gt; comparison but deleted before the function
terminates. A CSV file with the results will not be saved, but a dataframe
of the results will be returned.</p>
</td></tr>
<tr><td><code id="compare_documents_+3A_reference_scores">reference_scores</code></td>
<td>
<p>Optional. A list of same writer and different writer
similarity scores used for reference to calculate a score-based likelihood
ratio. If reference scores are not supplied, <code>ref_scores</code> will be used only
if <code>score_only</code> is FALSE. If score only is true, reference scores are
unnecessary because a score-based likelihood ratio will not be calculated.
If reference scores are supplied, <code>score_only</code> will automatically be set to
FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Compare two documents from the same writer with a similarity score
s1 &lt;- system.file(file.path("extdata", "docs", "w0005_s01_pLND_r03.png"),
  package = "handwriterRF"
)
s2 &lt;- system.file(file.path("extdata", "docs", "w0005_s02_pWOZ_r02.png"),
  package = "handwriterRF"
)
compare_documents(s1, s2, score_only = TRUE)

# Compare two documents from the same writer with a score-based
# likelihood ratio
s1 &lt;- system.file(file.path("extdata", "docs", "w0005_s01_pLND_r03.png"),
  package = "handwriterRF"
)
s2 &lt;- system.file(file.path("extdata", "docs", "w0005_s02_pWOZ_r02.png"),
  package = "handwriterRF"
)
compare_documents(s1, s2, score_only = FALSE)


</code></pre>

<hr>
<h2 id='compare_writer_profiles'>Compare Writer Profiles</h2><span id='topic+compare_writer_profiles'></span>

<h3>Description</h3>

<p>Compare the writer profiles from two handwritten documents to predict whether
they were written by the same person. Use either a similarity score or a
score-based likelihood ratio as a comparison method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_writer_profiles(
  writer_profiles,
  score_only = TRUE,
  rforest = NULL,
  reference_scores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_writer_profiles_+3A_writer_profiles">writer_profiles</code></td>
<td>
<p>A dataframe of writer profiles or cluster fill rates
calculated with <a href="#topic+get_cluster_fill_rates">get_cluster_fill_rates</a></p>
</td></tr>
<tr><td><code id="compare_writer_profiles_+3A_score_only">score_only</code></td>
<td>
<p>TRUE returns only the similarity score. FALSE returns the
similarity score and a score-based likelihood ratio for that score,
calculated using <code>reference_scores</code>.</p>
</td></tr>
<tr><td><code id="compare_writer_profiles_+3A_rforest">rforest</code></td>
<td>
<p>Optional. A random forest created with <code><a href="ranger.html#topic+ranger">ranger::ranger()</a></code>.
If a random forest is not supplied, <code>random_forest</code> will be used.</p>
</td></tr>
<tr><td><code id="compare_writer_profiles_+3A_reference_scores">reference_scores</code></td>
<td>
<p>Optional. A list of same writer and different writer
similarity scores used for reference to calculate a score-based likelihood
ratio. If reference scores are not supplied, <code>ref_scores</code> will be used only
if <code>score_only</code> is FALSE. If score only is true, reference scores are
unnecessary because a score-based likelihood ratio will not be calculated.
If reference scores are supplied, <code>score_only</code> will automatically be set to
FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe
</p>


<h3>Examples</h3>

<pre><code class='language-R'>compare_writer_profiles(test[1:2, ], score_only = TRUE)

compare_writer_profiles(test[1:2, ], score_only = FALSE)

</code></pre>

<hr>
<h2 id='get_cluster_fill_rates'>Get Cluster Fill Rates</h2><span id='topic+get_cluster_fill_rates'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> <code>get_cluster_fill_rates</code> is deprecated.
Use <code><a href="handwriter.html#topic+get_cluster_fill_rates">get_cluster_fill_rates</a></code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_cluster_fill_rates(df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_cluster_fill_rates_+3A_df">df</code></td>
<td>
<p>A dataframe of cluster fill rates created with
<code><a href="handwriter.html#topic+get_cluster_fill_counts">get_cluster_fill_counts</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe of cluster fill rates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
rates &lt;- get_cluster_fill_rates(df = cfc)

## End(Not run)

</code></pre>

<hr>
<h2 id='get_distances'>Get Distances</h2><span id='topic+get_distances'></span>

<h3>Description</h3>

<p>Calculate distances using between all pairs of cluster fill rates in a data
frame using one or more distance measures. The available distance measures
absolute distance, Manhattan distance, Euclidean distance, maximum distance,
and cosine distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_distances(df, distance_measures)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_distances_+3A_df">df</code></td>
<td>
<p>A dataframe of cluster fill rates created with
<code><a href="#topic+get_cluster_fill_rates">get_cluster_fill_rates</a></code> and an added column that contains a writer ID.</p>
</td></tr>
<tr><td><code id="get_distances_+3A_distance_measures">distance_measures</code></td>
<td>
<p>A vector of distance measures. Use 'abs' to
calculate the absolute difference, 'man' for the Manhattan distance, 'euc'
for the Euclidean distance, 'max' for the maximum absolute distance, and
'cos' for the cosine distance. The vector can be a single distance, or any
combination of these five distance measures.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The absolute distance between two n-length vectors of cluster fill rates, a
and b, is a vector of the same length as a and b. It can be calculated as
abs(a-b) where subtraction is performed element-wise, then the absolute
value of each element is returned. More specifically, element i of the vector is <code class="reqn">|a_i
- b_i|</code> for <code class="reqn">i=1,2,...,n</code>.
</p>
<p>The Manhattan distance between two  n-length vectors of cluster fill rates, a and b, is
<code class="reqn">\sum_{i=1}^n |a_i - b_i|</code>. In other words, it is the sum of the absolute
distance vector.
</p>
<p>The Euclidean distance between two  n-length vectors of cluster fill rates, a and b, is
<code class="reqn">\sqrt{\sum_{i=1}^n (a_i - b_i)^2}</code>. In other words, it is the sum of the elements of the
absolute distance vector.
</p>
<p>The maximum distance between two n-length vectors of cluster fill rates, a and b, is
<code class="reqn">\max_{1 \leq i \leq n}{\{|a_i - b_i|\}}</code>. In other words, it is the sum of the elements of the
absolute distance vector.
</p>
<p>The cosine distance between two n-length vectors of cluster fill rates, a and b, is
<code class="reqn">\sum_{i=1}^n (a_i - b_i)^2 / (\sqrt{\sum_{i=1}^n a_i^2}\sqrt{\sum_{i=1}^n b_i^2})</code>.
</p>


<h3>Value</h3>

<p>A dataframe of distances
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rates &lt;- test[1:3, ]
# calculate maximum and Euclidean distances between the first 3 documents in test.
distances &lt;- get_distances(df = rates, distance_measures = c("max", "euc"))

# calculate maximum and distances between all documents in test.
distances &lt;- get_distances(df = test, distance_measures = c("man"))

</code></pre>

<hr>
<h2 id='get_rates_of_misleading_slrs'>Get Rates of Misleading Evidence for SLRs</h2><span id='topic+get_rates_of_misleading_slrs'></span>

<h3>Description</h3>

<p>Calculate the rates of misleading evidence for score-based likelihood ratios
(SLRs) when the ground truth is known.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rates_of_misleading_slrs(df, threshold = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_rates_of_misleading_slrs_+3A_df">df</code></td>
<td>
<p>A dataframe of SLRs from <code><a href="#topic+compare_writer_profiles">compare_writer_profiles</a></code> with
<code>score_only = FALSE</code>.</p>
</td></tr>
<tr><td><code id="get_rates_of_misleading_slrs_+3A_threshold">threshold</code></td>
<td>
<p>A number greater than zero that serves as a decision
threshold. If the ground truth for two documents is that they came from the
same writer and the SLR is less than the decision threshold, this is
misleading evidence that incorrectly supports the defense (false negative).
If the ground truth for two documents is that they came from different
writers and the SLR is greater than the decision threshold, this is
misleading evidence that incorrectly supports the prosecution (false
positive).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
comparisons &lt;- compare_writer_profiles(test, score_only = FALSE)
get_rates_of_misleading_slrs(comparisons)


</code></pre>

<hr>
<h2 id='get_ref_scores'>Get Reference Scores</h2><span id='topic+get_ref_scores'></span>

<h3>Description</h3>

<p>Create reference scores of same writer and different writer scores from a
dataframe of cluster fill rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ref_scores(rforest, df, seed = NULL, downsample_diff_pairs = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_ref_scores_+3A_rforest">rforest</code></td>
<td>
<p>A <span class="pkg">ranger</span> random forest created with
<code><a href="#topic+train_rf">train_rf</a></code>.</p>
</td></tr>
<tr><td><code id="get_ref_scores_+3A_df">df</code></td>
<td>
<p>A dataframe of cluster fill rates created with
<code><a href="#topic+get_cluster_fill_rates">get_cluster_fill_rates</a></code> with an added writer ID column.</p>
</td></tr>
<tr><td><code id="get_ref_scores_+3A_seed">seed</code></td>
<td>
<p>Optional. An integer to set the seed for the random number
generator to make the results reproducible.</p>
</td></tr>
<tr><td><code id="get_ref_scores_+3A_downsample_diff_pairs">downsample_diff_pairs</code></td>
<td>
<p>If TRUE, the different writer pairs are
down-sampled to equal the number of same writer pairs. If FALSE, all
different writer pairs are used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of scores
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_ref_scores(rforest = random_forest, df = validation)


</code></pre>

<hr>
<h2 id='interpret_slr'>Interpret an SLR Value</h2><span id='topic+interpret_slr'></span>

<h3>Description</h3>

<p>Verbally interprent an SLR value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interpret_slr(df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="interpret_slr_+3A_df">df</code></td>
<td>
<p>A dataframe created by <code><a href="#topic+calculate_slr">calculate_slr</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame("score" = 5, "slr" = 20)
interpret_slr(df)

df &lt;- data.frame("score" = 0.12, "slr" = 0.5)
interpret_slr(df)

df &lt;- data.frame("score" = 1, "slr" = 1)
interpret_slr(df)

df &lt;- data.frame("score" = 0, "slr" = 0)
interpret_slr(df)

</code></pre>

<hr>
<h2 id='plot_scores'>Plot Scores</h2><span id='topic+plot_scores'></span>

<h3>Description</h3>

<p>Plot same writer and different writers reference similarity scores from a
validation set. The similarity scores are greater than or equal to zero and
less than or equal to one. The interval from 0 to 1 is split into <code>n_bins</code>.
The proportion of scores in each bin is calculated and plotted. Optionally, a
vertical dotted line may be plotted at an observed similarity score.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_scores(scores, obs_score = NULL, n_bins = 50)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_scores_+3A_scores">scores</code></td>
<td>
<p>A dataframe of scores calculated with
<code><a href="#topic+get_ref_scores">get_ref_scores()</a></code></p>
</td></tr>
<tr><td><code id="plot_scores_+3A_obs_score">obs_score</code></td>
<td>
<p>Optional. A similarity score calculated with
<code><a href="#topic+calculate_slr">calculate_slr()</a></code></p>
</td></tr>
<tr><td><code id="plot_scores_+3A_n_bins">n_bins</code></td>
<td>
<p>The number of bins</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The methods used in this package typically produce many times more different
writer scores than same writer scores. For example, <code>ref_scores</code> contains
79,600 different writer scores but only 200 same writer scores. Histograms,
which show the frequency of scores, don't handle this class imbalance well.
Instead, the rate of scores is plotted.
</p>


<h3>Value</h3>

<p>A ggplot2 plot of histograms
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot_scores(scores = ref_scores)

plot_scores(scores = ref_scores, n_bins = 70)

# Add a vertical line 0.1 on the horizontal axis.
plot_scores(scores = ref_scores, obs_score = 0.1)

</code></pre>

<hr>
<h2 id='random_forest'>A <span class="pkg">ranger</span> Random Forest and Data Frame of Distances</h2><span id='topic+random_forest'></span>

<h3>Description</h3>

<p>A list that contains a trained random forest created with <span class="pkg">ranger</span> and
the dataframe of distances used to train the random forest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>random_forest
</code></pre>


<h3>Format</h3>

<p>A list with the following components:
</p>

<dl>
<dt>rf</dt><dd><p>A random forest created with <span class="pkg">ranger</span> with settings:
importance = 'permutation', scale.permutation.importance = TRUE, and num.trees = 200.</p>
</dd>
<dt>distance_measures</dt><dd><p>A vector of the distance measures used to train the random forest: c('abs', 'euc')</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'># view the random forest
random_forest$rf

# view the distance measures used to train the random forest
random_forest$distance_measures

</code></pre>

<hr>
<h2 id='ref_scores'>Reference Similarity Scores</h2><span id='topic+ref_scores'></span>

<h3>Description</h3>

<p>A list containing two dataframes. The same_writer dataframe contains
similarity scores from same writer pairs. The diff_writer dataframe contains
similarity scores from different writer pairs. The similarity scores are
calculated from the validation dataframe with the following steps:
</p>

<ol>
<li><p> The absolute and Euclidean distances are calculated between pairs of writer profiles.
</p>
</li>
<li> <p><code>random_forest</code> uses the distances between the pair to predict the class of the pair
as same writer or different writer.
</p>
</li>
<li><p> The proportion of decision trees that predict same writer is used as the similarity
score.
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>ref_scores
</code></pre>


<h3>Format</h3>

<p>A list with the following components:
</p>

<dl>
<dt>same_writer</dt><dd><p>A dataframe of 1,800 same writer similarity scores. The columns docname1
and writer1 record the file name and the writer ID of the first handwriting sample. The columns
docname2 and writer2 record the file name and writer ID of the second handwriting sample. The match
column records the class, which is same, of the pairs of handwriting samples. The similarity scores
between the pairs of handwriting samples are in the score column.</p>
</dd>
<dt>diff_writer</dt><dd><p>A dataframe of 717,600 different writer similarity scores. The columns docname1
and writer1 record the file name and the writer ID of the first handwriting sample. The columns
docname2 and writer2 record the file name and writer ID of the second handwriting sample. The match
column records the class, which is different, of the pairs of handwriting samples. The similarity scores
between the pairs of handwriting samples are in the score column.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>summary(ref_scores$same_writer)

summary(ref_scores$diff_writer)

plot_scores(ref_scores)

</code></pre>

<hr>
<h2 id='templateK40'>Cluster Template with 40 Clusters</h2><span id='topic+templateK40'></span>

<h3>Description</h3>

<p>A cluster template created by <span class="pkg">handwriter</span> with 40 clusters. This
template was created from 100 handwriting samples from the CSAFE Handwriting
Database, the CVL Handwriting Database, and the IAM Handwriting Database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>templateK40
</code></pre>


<h3>Format</h3>

<p>A list containing the contents of the cluster template.
</p>

<dl>
<dt>cluster</dt><dd><p>A vector of cluster assignments
for each graph used to create the cluster template. The clusters are numbered sequentially 1, 2,...,40.</p>
</dd>
<dt>centers</dt><dd><p>The final cluster centers produced by the K-Means algorithm.</p>
</dd>
<dt>K</dt><dd><p>The number of clusters in the template (40).</p>
</dd>
<dt>n</dt><dd><p>The number of training graphs to used to create the template (32,708).</p>
</dd>
<dt>wcd</dt><dd><p>The within cluster
distances, the distance between each graph and the nearest cluster center, on the final iteration of the K-means algorithm.</p>
</dd>
</dl>



<h3>Details</h3>

<p><span class="pkg">handwriter</span> splits handwriting samples into component shapes called
graphs. The graphs are sorted into 40 clusters with a K-Means algorithm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>handwriter::plot_cluster_centers(templateK40)

</code></pre>

<hr>
<h2 id='test'>A Test Set of Cluster Fill Rates</h2><span id='topic+test'></span>

<h3>Description</h3>

<p>Writers from the CSAFE Handwriting Database and the CVL Handwriting Database
were randomly assigned to train, validation, and test sets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test
</code></pre>


<h3>Format</h3>

<p>A dataframe with 332 rows and 43 variables:
</p>

<dl>
<dt>docname</dt><dd><p>The file name of the handwriting sample.</p>
</dd>
<dt>writer</dt><dd><p>Writer ID. There are 83 distinct writer ID's. Each
writer has four documents in the dataframe.</p>
</dd>
<dt>doc</dt><dd><p>The name of the handwriting prompt.</p>
</dd>
<dt>total_graphs</dt><dd><p>The total number of graphs in the document.</p>
</dd>
<dt>cluster1</dt><dd><p>The proportion of graphs in cluster 1</p>
</dd>
<dt>cluster2</dt><dd><p>The proportion of graphs in cluster 2</p>
</dd>
<dt>cluster3</dt><dd><p>The proportion of graphs in cluster 3</p>
</dd>
<dt>cluster4</dt><dd><p>The proportion of graphs in cluster 4</p>
</dd>
<dt>cluster5</dt><dd><p>The proportion of graphs in cluster 5</p>
</dd>
<dt>cluster6</dt><dd><p>The proportion of graphs in cluster 6</p>
</dd>
<dt>cluster7</dt><dd><p>The proportion of graphs in cluster 7</p>
</dd>
<dt>cluster8</dt><dd><p>The proportion of graphs in cluster 8</p>
</dd>
<dt>cluster9</dt><dd><p>The proportion of graphs in cluster 9</p>
</dd>
<dt>cluster10</dt><dd><p>The proportion of graphs in cluster 10</p>
</dd>
<dt>cluster11</dt><dd><p>The proportion of graphs in cluster 11</p>
</dd>
<dt>cluster12</dt><dd><p>The proportion of graphs in cluster 12</p>
</dd>
<dt>cluster13</dt><dd><p>The proportion of graphs in cluster 13</p>
</dd>
<dt>cluster14</dt><dd><p>The proportion of graphs in cluster 14</p>
</dd>
<dt>cluster15</dt><dd><p>The proportion of graphs in cluster 15</p>
</dd>
<dt>cluster16</dt><dd><p>The proportion of graphs in cluster 16</p>
</dd>
<dt>cluster17</dt><dd><p>The proportion of graphs in cluster 17</p>
</dd>
<dt>cluster18</dt><dd><p>The proportion of graphs in cluster 18</p>
</dd>
<dt>cluster19</dt><dd><p>The proportion of graphs in cluster 19</p>
</dd>
<dt>cluster20</dt><dd><p>The proportion of graphs in cluster 20</p>
</dd>
<dt>cluster21</dt><dd><p>The proportion of graphs in cluster 21</p>
</dd>
<dt>cluster22</dt><dd><p>The proportion of graphs in cluster 22</p>
</dd>
<dt>cluster23</dt><dd><p>The proportion of graphs in cluster 23</p>
</dd>
<dt>cluster24</dt><dd><p>The proportion of graphs in cluster 24</p>
</dd>
<dt>cluster25</dt><dd><p>The proportion of graphs in cluster 25</p>
</dd>
<dt>cluster26</dt><dd><p>The proportion of graphs in cluster 26</p>
</dd>
<dt>cluster27</dt><dd><p>The proportion of graphs in cluster 27</p>
</dd>
<dt>cluster28</dt><dd><p>The proportion of graphs in cluster 28</p>
</dd>
<dt>cluster29</dt><dd><p>The proportion of graphs in cluster 29</p>
</dd>
<dt>cluster30</dt><dd><p>The proportion of graphs in cluster 30</p>
</dd>
<dt>cluster31</dt><dd><p>The proportion of graphs in cluster 31</p>
</dd>
<dt>cluster32</dt><dd><p>The proportion of graphs in cluster 32</p>
</dd>
<dt>cluster33</dt><dd><p>The proportion of graphs in cluster 33</p>
</dd>
<dt>cluster34</dt><dd><p>The proportion of graphs in cluster 34</p>
</dd>
<dt>cluster35</dt><dd><p>The proportion of graphs in cluster 35</p>
</dd>
<dt>cluster36</dt><dd><p>The proportion of graphs in cluster 36</p>
</dd>
<dt>cluster37</dt><dd><p>The proportion of graphs in cluster 37</p>
</dd>
<dt>cluster38</dt><dd><p>The proportion of graphs in cluster 38</p>
</dd>
<dt>cluster39</dt><dd><p>The proportion of graphs in cluster 39</p>
</dd>
<dt>cluster40</dt><dd><p>The proportion of graphs in cluster 40</p>
</dd>
</dl>



<h3>Details</h3>

<p>The test dataframe contains cluster fill rates for 332 handwritten documents
from the CSAFE Handwriting Database and the CVL Handwriting Database. The
documents are from 83 writers. The CSAFE Handwriting Database has nine
repetitions of each prompt. Two London Letter prompts and two Wizard of Oz
prompts were randomly selected from each writer. The CVL Handwriting Database
does not contain multiple repetitions of prompts and four Engligh language
prompts were randomly selected from each writer.
</p>
<p>The documents were split into graphs with
<code><a href="handwriter.html#topic+process_batch_dir">process_batch_dir</a></code>. The graphs were grouped into
clusters with <code><a href="handwriter.html#topic+get_clusters_batch">get_clusters_batch</a></code>. The cluster fill
counts were calculated with
<code><a href="handwriter.html#topic+get_cluster_fill_counts">get_cluster_fill_counts</a></code>. Finally,
<code><a href="#topic+get_cluster_fill_rates">get_cluster_fill_rates</a></code> calculated the cluster fill rates.
</p>


<h3>Source</h3>

<p><a href="https://forensicstats.org/handwritingdatabase/">https://forensicstats.org/handwritingdatabase/</a>,
<a href="https://cvl.tuwien.ac.at/research/cvl-databases/an-off-line-database-for-writer-retrieval-writer-identification-and-word-spotting/">https://cvl.tuwien.ac.at/research/cvl-databases/an-off-line-database-for-writer-retrieval-writer-identification-and-word-spotting/</a>
</p>

<hr>
<h2 id='train'>A Training Set of Cluster Fill Rates</h2><span id='topic+train'></span>

<h3>Description</h3>

<p>Writers from the CSAFE Handwriting Database and the CVL Handwriting Database
were randomly assigned to train, validation, and test sets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>train
</code></pre>


<h3>Format</h3>

<p>A dataframe with 800 rows and 43 variables:
</p>

<dl>
<dt>docname</dt><dd><p>The file name of the handwriting sample.</p>
</dd>
<dt>writer</dt><dd><p>Writer ID. There are 200 distinct writer ID's. Each
writer has 4 documents in the dataframe.</p>
</dd>
<dt>doc</dt><dd><p>The name of the handwriting prompt.</p>
</dd>
<dt>total_graphs</dt><dd><p>The total number of graphs in the document.</p>
</dd>
<dt>cluster1</dt><dd><p>The proportion of graphs in cluster 1</p>
</dd>
<dt>cluster2</dt><dd><p>The proportion of graphs in cluster 2</p>
</dd>
<dt>cluster3</dt><dd><p>The proportion of graphs in cluster 3</p>
</dd>
<dt>cluster4</dt><dd><p>The proportion of graphs in cluster 4</p>
</dd>
<dt>cluster5</dt><dd><p>The proportion of graphs in cluster 5</p>
</dd>
<dt>cluster6</dt><dd><p>The proportion of graphs in cluster 6</p>
</dd>
<dt>cluster7</dt><dd><p>The proportion of graphs in cluster 7</p>
</dd>
<dt>cluster8</dt><dd><p>The proportion of graphs in cluster 8</p>
</dd>
<dt>cluster9</dt><dd><p>The proportion of graphs in cluster 9</p>
</dd>
<dt>cluster10</dt><dd><p>The proportion of graphs in cluster 10</p>
</dd>
<dt>cluster11</dt><dd><p>The proportion of graphs in cluster 11</p>
</dd>
<dt>cluster12</dt><dd><p>The proportion of graphs in cluster 12</p>
</dd>
<dt>cluster13</dt><dd><p>The proportion of graphs in cluster 13</p>
</dd>
<dt>cluster14</dt><dd><p>The proportion of graphs in cluster 14</p>
</dd>
<dt>cluster15</dt><dd><p>The proportion of graphs in cluster 15</p>
</dd>
<dt>cluster16</dt><dd><p>The proportion of graphs in cluster 16</p>
</dd>
<dt>cluster17</dt><dd><p>The proportion of graphs in cluster 17</p>
</dd>
<dt>cluster18</dt><dd><p>The proportion of graphs in cluster 18</p>
</dd>
<dt>cluster19</dt><dd><p>The proportion of graphs in cluster 19</p>
</dd>
<dt>cluster20</dt><dd><p>The proportion of graphs in cluster 20</p>
</dd>
<dt>cluster21</dt><dd><p>The proportion of graphs in cluster 21</p>
</dd>
<dt>cluster22</dt><dd><p>The proportion of graphs in cluster 22</p>
</dd>
<dt>cluster23</dt><dd><p>The proportion of graphs in cluster 23</p>
</dd>
<dt>cluster24</dt><dd><p>The proportion of graphs in cluster 24</p>
</dd>
<dt>cluster25</dt><dd><p>The proportion of graphs in cluster 25</p>
</dd>
<dt>cluster26</dt><dd><p>The proportion of graphs in cluster 26</p>
</dd>
<dt>cluster27</dt><dd><p>The proportion of graphs in cluster 27</p>
</dd>
<dt>cluster28</dt><dd><p>The proportion of graphs in cluster 28</p>
</dd>
<dt>cluster29</dt><dd><p>The proportion of graphs in cluster 29</p>
</dd>
<dt>cluster30</dt><dd><p>The proportion of graphs in cluster 30</p>
</dd>
<dt>cluster31</dt><dd><p>The proportion of graphs in cluster 31</p>
</dd>
<dt>cluster32</dt><dd><p>The proportion of graphs in cluster 32</p>
</dd>
<dt>cluster33</dt><dd><p>The proportion of graphs in cluster 33</p>
</dd>
<dt>cluster34</dt><dd><p>The proportion of graphs in cluster 34</p>
</dd>
<dt>cluster35</dt><dd><p>The proportion of graphs in cluster 35</p>
</dd>
<dt>cluster36</dt><dd><p>The proportion of graphs in cluster 36</p>
</dd>
<dt>cluster37</dt><dd><p>The proportion of graphs in cluster 37</p>
</dd>
<dt>cluster38</dt><dd><p>The proportion of graphs in cluster 38</p>
</dd>
<dt>cluster39</dt><dd><p>The proportion of graphs in cluster 39</p>
</dd>
<dt>cluster40</dt><dd><p>The proportion of graphs in cluster 40</p>
</dd>
</dl>



<h3>Details</h3>

<p>The train dataframe contains cluster fill rates for 800 handwritten
documents from the CSAFE Handwriting Database and the CVL Handwriting
Database. The documents are from 200 writers. The CSAFE Handwriting Database
has nine repetitions of each prompt. Two London Letter prompts and two Wizard
of Oz prompts were randomly selected from each writer. The CVL Handwriting
Database does not contain multiple repetitions of prompts and four English
language prompts were randomly selected from each writer.
</p>
<p>The documents were split into graphs with
<code><a href="handwriter.html#topic+process_batch_dir">process_batch_dir</a></code>. The graphs were grouped into
clusters with <code><a href="handwriter.html#topic+get_clusters_batch">get_clusters_batch</a></code>. The cluster fill
counts were calculated with
<code><a href="handwriter.html#topic+get_cluster_fill_counts">get_cluster_fill_counts</a></code>. Finally,
<code><a href="#topic+get_cluster_fill_rates">get_cluster_fill_rates</a></code> calculated the cluster fill rates.
</p>


<h3>Source</h3>

<p><a href="https://forensicstats.org/handwritingdatabase/">https://forensicstats.org/handwritingdatabase/</a>,
<a href="https://cvl.tuwien.ac.at/research/cvl-databases/an-off-line-database-for-writer-retrieval-writer-identification-and-word-spotting/">https://cvl.tuwien.ac.at/research/cvl-databases/an-off-line-database-for-writer-retrieval-writer-identification-and-word-spotting/</a>
</p>

<hr>
<h2 id='train_rf'>Train a Random Forest</h2><span id='topic+train_rf'></span>

<h3>Description</h3>

<p>Train a random forest with <span class="pkg">ranger</span> from a dataframe of writer profiles
estimated with <code><a href="#topic+get_cluster_fill_rates">get_cluster_fill_rates</a></code>. <code>train_rf</code> calculates
the distance between all pairs of writer profiles using one or more distance
measures. Currently, the available distance measures are absolute, Manhattan,
Euclidean, maximum, and cosine.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>train_rf(
  df,
  ntrees,
  distance_measures,
  output_dir = NULL,
  run_number = 1,
  downsample_diff_pairs = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="train_rf_+3A_df">df</code></td>
<td>
<p>A dataframe of writer profiles created with
<code><a href="#topic+get_cluster_fill_rates">get_cluster_fill_rates</a></code></p>
</td></tr>
<tr><td><code id="train_rf_+3A_ntrees">ntrees</code></td>
<td>
<p>An integer number of decision trees to use</p>
</td></tr>
<tr><td><code id="train_rf_+3A_distance_measures">distance_measures</code></td>
<td>
<p>A vector of distance measures. Any combination of
'abs', 'euc', 'man', 'max', and 'cos' may be used.</p>
</td></tr>
<tr><td><code id="train_rf_+3A_output_dir">output_dir</code></td>
<td>
<p>A path to a directory where the random forest will be
saved.</p>
</td></tr>
<tr><td><code id="train_rf_+3A_run_number">run_number</code></td>
<td>
<p>An integer used for both the set.seed function and to
distinguish between different runs on the same input dataframe.</p>
</td></tr>
<tr><td><code id="train_rf_+3A_downsample_diff_pairs">downsample_diff_pairs</code></td>
<td>
<p>Whether to downsample the number of different writer
distances before training the random forest. If TRUE, the different writer
distances will be randomly sampled, resulting in the same number of
different writer and same writer pairs.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The absolute distance between two n-length vectors of cluster fill rates, a
and b, is a vector of the same length as a and b. It can be calculated as
abs(a-b) where subtraction is performed element-wise, then the absolute
value of each element is returned. More specifically, element i of the vector is <code class="reqn">|a_i
- b_i|</code> for <code class="reqn">i=1,2,...,n</code>.
</p>
<p>The Manhattan distance between two  n-length vectors of cluster fill rates, a and b, is
<code class="reqn">\sum_{i=1}^n |a_i - b_i|</code>. In other words, it is the sum of the absolute
distance vector.
</p>
<p>The Euclidean distance between two  n-length vectors of cluster fill rates, a and b, is
<code class="reqn">\sqrt{\sum_{i=1}^n (a_i - b_i)^2}</code>. In other words, it is the sum of the elements of the
absolute distance vector.
</p>
<p>The maximum distance between two n-length vectors of cluster fill rates, a and b, is
<code class="reqn">\max_{1 \leq i \leq n}{\{|a_i - b_i|\}}</code>. In other words, it is the sum of the elements of the
absolute distance vector.
</p>
<p>The cosine distance between two n-length vectors of cluster fill rates, a and b, is
<code class="reqn">\sum_{i=1}^n (a_i - b_i)^2 / (\sqrt{\sum_{i=1}^n a_i^2}\sqrt{\sum_{i=1}^n b_i^2})</code>.
</p>


<h3>Value</h3>

<p>A random forest
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rforest &lt;- train_rf(
  df = train,
  ntrees = 200,
  distance_measures = c("euc"),
  run_number = 1,
  downsample = TRUE
)
</code></pre>

<hr>
<h2 id='validation'>A Validation Set of Cluster Fill Rates</h2><span id='topic+validation'></span>

<h3>Description</h3>

<p>Writers from the CSAFE Handwriting Database and the CVL Handwriting Database
were randomly assigned to train, validation, and test sets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validation
</code></pre>


<h3>Format</h3>

<p>A dataframe with 1,200 rows and 43 variables:
</p>

<dl>
<dt>docname</dt><dd><p>The file name of the handwriting sample.</p>
</dd>
<dt>writer</dt><dd><p>Writer ID. There are 300 distinct writer ID's. Each
writer has 4 documents in the dataframe.</p>
</dd>
<dt>doc</dt><dd><p>The name of the handwriting prompt.</p>
</dd>
<dt>total_graphs</dt><dd><p>The total number of graphs in the document.</p>
</dd>
<dt>cluster1</dt><dd><p>The proportion of graphs in cluster 1</p>
</dd>
<dt>cluster2</dt><dd><p>The proportion of graphs in cluster 2</p>
</dd>
<dt>cluster3</dt><dd><p>The proportion of graphs in cluster 3</p>
</dd>
<dt>cluster4</dt><dd><p>The proportion of graphs in cluster 4</p>
</dd>
<dt>cluster5</dt><dd><p>The proportion of graphs in cluster 5</p>
</dd>
<dt>cluster6</dt><dd><p>The proportion of graphs in cluster 6</p>
</dd>
<dt>cluster7</dt><dd><p>The proportion of graphs in cluster 7</p>
</dd>
<dt>cluster8</dt><dd><p>The proportion of graphs in cluster 8</p>
</dd>
<dt>cluster9</dt><dd><p>The proportion of graphs in cluster 9</p>
</dd>
<dt>cluster10</dt><dd><p>The proportion of graphs in cluster 10</p>
</dd>
<dt>cluster11</dt><dd><p>The proportion of graphs in cluster 11</p>
</dd>
<dt>cluster12</dt><dd><p>The proportion of graphs in cluster 12</p>
</dd>
<dt>cluster13</dt><dd><p>The proportion of graphs in cluster 13</p>
</dd>
<dt>cluster14</dt><dd><p>The proportion of graphs in cluster 14</p>
</dd>
<dt>cluster15</dt><dd><p>The proportion of graphs in cluster 15</p>
</dd>
<dt>cluster16</dt><dd><p>The proportion of graphs in cluster 16</p>
</dd>
<dt>cluster17</dt><dd><p>The proportion of graphs in cluster 17</p>
</dd>
<dt>cluster18</dt><dd><p>The proportion of graphs in cluster 18</p>
</dd>
<dt>cluster19</dt><dd><p>The proportion of graphs in cluster 19</p>
</dd>
<dt>cluster20</dt><dd><p>The proportion of graphs in cluster 20</p>
</dd>
<dt>cluster21</dt><dd><p>The proportion of graphs in cluster 21</p>
</dd>
<dt>cluster22</dt><dd><p>The proportion of graphs in cluster 22</p>
</dd>
<dt>cluster23</dt><dd><p>The proportion of graphs in cluster 23</p>
</dd>
<dt>cluster24</dt><dd><p>The proportion of graphs in cluster 24</p>
</dd>
<dt>cluster25</dt><dd><p>The proportion of graphs in cluster 25</p>
</dd>
<dt>cluster26</dt><dd><p>The proportion of graphs in cluster 26</p>
</dd>
<dt>cluster27</dt><dd><p>The proportion of graphs in cluster 27</p>
</dd>
<dt>cluster28</dt><dd><p>The proportion of graphs in cluster 28</p>
</dd>
<dt>cluster29</dt><dd><p>The proportion of graphs in cluster 29</p>
</dd>
<dt>cluster30</dt><dd><p>The proportion of graphs in cluster 30</p>
</dd>
<dt>cluster31</dt><dd><p>The proportion of graphs in cluster 31</p>
</dd>
<dt>cluster32</dt><dd><p>The proportion of graphs in cluster 32</p>
</dd>
<dt>cluster33</dt><dd><p>The proportion of graphs in cluster 33</p>
</dd>
<dt>cluster34</dt><dd><p>The proportion of graphs in cluster 34</p>
</dd>
<dt>cluster35</dt><dd><p>The proportion of graphs in cluster 35</p>
</dd>
<dt>cluster36</dt><dd><p>The proportion of graphs in cluster 36</p>
</dd>
<dt>cluster37</dt><dd><p>The proportion of graphs in cluster 37</p>
</dd>
<dt>cluster38</dt><dd><p>The proportion of graphs in cluster 38</p>
</dd>
<dt>cluster39</dt><dd><p>The proportion of graphs in cluster 39</p>
</dd>
<dt>cluster40</dt><dd><p>The proportion of graphs in cluster 40</p>
</dd>
</dl>



<h3>Details</h3>

<p>The validation dataframe contains cluster fill rates for 1,200 handwritten
documents from the CSAFE Handwriting Database and the CVL Handwriting
Database. The documents are from 300 writers. The CSAFE Handwriting Database
has nine repetitions of each prompt. Two London Letter prompts and two Wizard
of Oz prompts were randomly selected from each writer. The CVL Handwriting
Database does not contain multiple repetitions of prompts and four English
language prompts were randomly selected from each writer.
</p>
<p>The documents were split into graphs with
<code><a href="handwriter.html#topic+process_batch_dir">process_batch_dir</a></code>. The graphs were grouped into
clusters with <code><a href="handwriter.html#topic+get_clusters_batch">get_clusters_batch</a></code>. The cluster fill
counts were calculated with
<code><a href="handwriter.html#topic+get_cluster_fill_counts">get_cluster_fill_counts</a></code>. Finally,
<code><a href="#topic+get_cluster_fill_rates">get_cluster_fill_rates</a></code> calculated the cluster fill rates.
</p>


<h3>Source</h3>

<p><a href="https://forensicstats.org/handwritingdatabase/">https://forensicstats.org/handwritingdatabase/</a>,
<a href="https://cvl.tuwien.ac.at/research/cvl-databases/an-off-line-database-for-writer-retrieval-writer-identification-and-word-spotting/">https://cvl.tuwien.ac.at/research/cvl-databases/an-off-line-database-for-writer-retrieval-writer-identification-and-word-spotting/</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
