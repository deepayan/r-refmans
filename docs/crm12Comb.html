<!DOCTYPE html><html lang="en"><head><title>Help for package crm12Comb</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {crm12Comb}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#doseComb_to_mat'><p>Title: Get 6 complete orderings for toxicity and efficacy for drug combinations</p></a></li>
<li><a href='#efficacy_est'>
<p>Efficacy estimation</p></a></li>
<li><a href='#empiric_GammaPriorLikelihood'><p>empiric model with gamma prior</p></a></li>
<li><a href='#empiric_NormalPriorLikelihood'><p>empiric model with normal prior</p></a></li>
<li><a href='#enroll_patient_plot'>
<p>Plot patient enrollment for single trial</p></a></li>
<li><a href='#examples_results'><p>Output dataset for examples given list of inputs</p></a></li>
<li><a href='#get_ordering'>
<p>Complete orderings for combinations of two drugs</p></a></li>
<li><a href='#logisticOnePara_GammaPriorLikelihood'><p>one-parameter logistic model with gamma prior</p></a></li>
<li><a href='#logisticOnePara_NormalPriorLikelihood'><p>one-parameter logistic model with normal prior</p></a></li>
<li><a href='#logisticTwoPara_GammaPriorLikelihood'><p>two-parameter logistic model with gamma prior</p></a></li>
<li><a href='#logisticTwoPara_NormalPriorLikelihood'><p>two-parameter logistic model with normal prior</p></a></li>
<li><a href='#maximization_phase'>
<p>Maximization phase</p></a></li>
<li><a href='#ODC_plot'>
<p>Plot optimal combination dose selections</p></a></li>
<li><a href='#patient_allocation_plot'>
<p>Plot patient allocation for a single trial</p></a></li>
<li><a href='#priorSkeletons'>
<p>Generate the skeletons of toxicity and efficacy</p></a></li>
<li><a href='#randomization_phase'>
<p>Adaptive randomization</p></a></li>
<li><a href='#rBin2Corr'><p>Generate correlated binary variables</p></a></li>
<li><a href='#sample_plot'>
<p>Sample plot for a given output results</p></a></li>
<li><a href='#SIM_phase_I_II'>
<p>Single simulation of phase I/II adaptive design for drug combinations based on CRM design</p></a></li>
<li><a href='#tanh_ExpPriorLikelihood'><p>Title: Bayesian likelihood inference</p></a></li>
<li><a href='#toxicity_est'>
<p>Toxicity estimation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Phase I/II CRM Based Drug Combination Design</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.10</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Junying Wang &lt;junying.wang@stonybrook.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the adaptive designs for integrated phase I/II trials of drug combinations via continual reassessment method (CRM) to evaluate toxicity and efficacy simultaneously for each enrolled patient cohort based on Bayesian inference. It supports patients assignment guidance in a single trial using current enrolled data, as well as conducting extensive simulation studies to evaluate operating characteristics before the trial starts. It includes various link functions such as empiric, one-parameter logistic, two-parameter logistic, and hyperbolic tangent, as well as considering multiple prior distributions of the parameters like normal distribution, gamma distribution and exponential distribution to accommodate diverse clinical scenarios. Method using Bayesian framework with empiric link function is described in: Wages and Conaway (2014) &lt;<a href="https://doi.org/10.1002%2Fsim.6097">doi:10.1002/sim.6097</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, ggforce</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-18 01:15:58 UTC; junyingwang</td>
</tr>
<tr>
<td>Author:</td>
<td>Junying Wang [cre, aut],
  Song Wu [aut],
  Jie Yang [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-18 10:50:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='doseComb_to_mat'>Title: Get 6 complete orderings for toxicity and efficacy for drug combinations</h2><span id='topic+doseComb_to_mat'></span>

<h3>Description</h3>

<p>Step 1: convert dose combinations into matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>doseComb_to_mat(doseComb, type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="doseComb_to_mat_+3A_dosecomb">doseComb</code></td>
<td>
<p>Either a numeric matrix or a numeric vector or a numeric list.</p>
</td></tr>
<tr><td><code id="doseComb_to_mat_+3A_type">type</code></td>
<td>
<p>A string.
condition 1: detailed dose combinations are directly given in matrix -&gt; type = &quot;comb&quot;
dose combinations
dose A
dose B
condition 2: directly given the number of levels for the two doses in vector -&gt; type = &quot;matrix&quot;
</p>
<p>Step 2: get the 6 orderings</p>
</td></tr>
</table>


<h3>Value</h3>

<p>outMat -&gt; Either a list or a matrix.
Note: each array refers to the index of drug combinations orderings)
</p>


<h3>References</h3>

<p>Wages NA, Conaway MR. Specifications of a continual reassessment method design for phase I trials of combined drugs. Pharmaceutical statistics. 2013 Jul;12(4):217-24.
<a href="https://doi.org/10.1002/pst.1575">doi:10.1002/pst.1575</a>
</p>

<hr>
<h2 id='efficacy_est'>
Efficacy estimation
</h2><span id='topic+efficacy_est'></span>

<h3>Description</h3>

<p>Estimate efficacy using Bayesian inference for each enrolled patient or cohort of patients given the current accumulated data and toxicity estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>efficacy_est(Dat, AR, I, K, K_prob, efficacy_skeleton, Nphase,
             model, para_prior,
             theta_mean, theta_sd, theta_intcpt_lgst1, theta_shape, theta_inverse_scale,
             alphaT_mean, alphaT_sd, alphaT_shape, alphaT_inverse_scale,
             seed=NULL, seed_rand=NULL, seed_max=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="efficacy_est_+3A_dat">Dat</code></td>
<td>
<p>A data frame for current data with three columns (DoseLevel, DLT and ORR).</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_ar">AR</code></td>
<td>
<p>A vector for acceptable set.</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_i">I</code></td>
<td>
<p>Number of dose combinations.</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_k">K</code></td>
<td>
<p>Number of efficacy orderings.</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_k_prob">K_prob</code></td>
<td>
<p>A vector of length <code class="reqn">K</code> denoting prior probabilities of efficacy orderings (sum is 1).</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_efficacy_skeleton">efficacy_skeleton</code></td>
<td>
<p>A list of vector with length <code class="reqn">K</code> containing efficacy orderings.</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_nphase">Nphase</code></td>
<td>
<p>Number of patients for determination of randomization phase (current number of patients less than Nphase) or maximization phase (current number of patients larger than or equal to Nphase).</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_model">model</code></td>
<td>
<p>A character string to specify the model used, must be one of &quot;empiric&quot;, &quot;tanh&quot;, &quot;logistic&quot; or &quot;logistic2&quot;.</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_para_prior">para_prior</code></td>
<td>
<p>A character string to specify the prior distribution used for parameters, must be one of &quot;normal&quot; or &quot;gamma&quot; (when model is either &quot;empiric&quot; or &quot;logistic&quot; or &quot;logistic2&quot;) or &quot;exponential&quot; (when model is &quot;tanh&quot;).</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_theta_mean">theta_mean</code></td>
<td>
<p>The mean of parameter used when prior=&quot;exponential&quot; or &quot;normal&quot;, otherwise need to specify NULL.</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_theta_sd">theta_sd</code></td>
<td>
<p>The standard deviation of parameter used when prior=&quot;normal&quot;, otherwise need to specify NULL.</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_theta_intcpt_lgst1">theta_intcpt_lgst1</code></td>
<td>
<p>A constant value of intercept from a one-parameter logistic model only used when model=&quot;logistic&quot; (suggested value is 3), otherwise need to specify NULL.</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_theta_shape">theta_shape</code></td>
<td>
<p>The shape parameter used when prior=&quot;gamma&quot;, otherwise need to specify NULL.</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_theta_inverse_scale">theta_inverse_scale</code></td>
<td>
<p>The scale parameter used when prior=&quot;gamma&quot;, otherwise need to specify NULL.</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_alphat_mean">alphaT_mean</code></td>
<td>
<p>The mean of intercept parameter of two-parameter logistic model only used when model=&quot;logistic2&quot; and prior=&quot;normal&quot;, otherwise need to specify NULL.</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_alphat_sd">alphaT_sd</code></td>
<td>
<p>The standard deviation of intercept parameter of two-parameter logistic model only used when model=&quot;logistic2&quot; and prior=&quot;normal&quot;, otherwise need to specify NULL.</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_alphat_shape">alphaT_shape</code></td>
<td>
<p>The shape parameter of intercept parameter from a two-parameter logistic model only used when model=&quot;logistic2&quot; and prior=&quot;gamma&quot;, otherwise need to specify NULL.</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_alphat_inverse_scale">alphaT_inverse_scale</code></td>
<td>
<p>The scale parameter of intercept parameter from a two-parameter logistic model only used when model=&quot;logistic2&quot; and prior=&quot;gamma&quot;, otherwise need to specify NULL.</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_seed">seed</code></td>
<td>
<p>An integer for the seed to generate random numbers used for equal ordering prior probabilities, default is NULL.</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_seed_rand">seed_rand</code></td>
<td>
<p>An integer for the seed to generate random numbers used in randomization phase, default is NULL.</p>
</td></tr>
<tr><td><code id="efficacy_est_+3A_seed_max">seed_max</code></td>
<td>
<p>An integer for the seed to generate random numbers used in maximization phase, default is NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The efficacy estimation is based on Bayesian framework by calculating the likelihood function under each orderings, and select the ordering with maximum posterior probability. Then, estimated parameters can be obtained, which will be used for efficacy estimation based on the corresponding link function (specified in <code class="reqn">model</code> statement).
</p>


<h3>Value</h3>

<p>A list is returned containing the following components:
</p>
<table role = "presentation">
<tr><td><code>kStar</code></td>
<td>
<p>An integer for efficacy ordering with maximum posterior density given the current accumulated data.</p>
</td></tr>
<tr><td><code>piE_hat</code></td>
<td>
<p>A vector for estimated efficacy probabilities from acceptable set given the current accumulated data.</p>
</td></tr>
<tr><td><code>di</code></td>
<td>
<p>Number of dose level for next enrolled patient or cohort of patients</p>
</td></tr>
<tr><td><code>K_prob</code></td>
<td>
<p>A vector for posterier density of efficacy orderings and will be used as prior information for next enrolled patient or cohort of patients.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wages, N. A., &amp; Conaway, M. R. (2014). Phase I/II adaptive design for drug combination oncology trials. Statistics in medicine, 33(12), 1990-2003. <a href="https://doi.org/10.1002/sim.6097">doi:10.1002/sim.6097</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+priorSkeletons">priorSkeletons</a></code>, <code><a href="#topic+get_ordering">get_ordering</a></code>, <code><a href="#topic+toxicity_est">toxicity_est</a></code>, <code><a href="#topic+randomization_phase">randomization_phase</a></code>, <code><a href="#topic+maximization_phase">maximization_phase</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### follow same steps as the example in function toxicity_est()
# Generate a data including 3 columns: DoseLevel, DLT, ORR (DLT and ORR are binary outcomes)
currDat &lt;- data.frame(sample(1:9, 6, replace=TRUE), rbinom(6, 1, 0.2), rbinom(6, 1, 0.5))
names(currDat) &lt;- c("DoseLevel", "DLT", "ORR")

# Generate toxicity and efficacy skeleton
DLT_skeleton_p &lt;- priorSkeletons(updelta = 0.045, target = 0.3, npos= 5, ndose = 9,
                                 model = "logistic", prior = "normal", beta_mean = 0, a0 = 3)
eff_skeleton_p &lt;- priorSkeletons(updelta = 0.045, target = 0.5, npos= 5, ndose = 9,
                                 model = "logistic", prior = "normal", beta_mean = 0, a0 = 3)

# Obtain 6 complete orderings for toxicity skeleton and efficacy skeleton
orderings &lt;- get_ordering(doseComb_forMat=c(3,3), type_forMat="matrix")
DLT_skeleton_l &lt;- lapply(orderings, function(or){DLT_skeleton_p[or]})
eff_skeleton_l &lt;- lapply(orderings, function(or){eff_skeleton_p[or]})

# estimate toxicity
tox &lt;- toxicity_est(Dat=currDat, I=9, M=6, M_prob=rep(1/6, 6),
                    DLT_skeleton=DLT_skeleton_l, DLT_thresh=0.33,
                    model="logistic", para_prior="normal",
                    beta_mean=0, beta_sd=1, intcpt_lgst1=3,
                    beta_shape=NULL, beta_inverse_scale=NULL,
                    alpha_mean=NULL, alpha_sd=NULL,
                    alpha_shape=NULL, alpha_inverse_scale=NULL,
                    seed=42)

### efficacy estimation
eff &lt;- efficacy_est(Dat=currDat, AR=tox$AR, I=9, K=6, K_prob=rep(1/6, 6),
                    efficacy_skeleton=eff_skeleton_l, Nphas=20,
                    model="logistic", para_prior="normal",
                    theta_mean=0, theta_sd=1, theta_intcpt_lgst1=3,
                    theta_shape=NULL, theta_inverse_scale=NULL,
                    alphaT_mean=NULL, alphaT_sd=NULL,
                    alphaT_shape=NULL, alphaT_inverse_scale=NULL,
                    seed=1, seed_rand=2, seed_max=3)
</code></pre>

<hr>
<h2 id='empiric_GammaPriorLikelihood'>empiric model with gamma prior</h2><span id='topic+empiric_GammaPriorLikelihood'></span>

<h3>Description</h3>

<p>empiric model with gamma prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>empiric_GammaPriorLikelihood(beta, beta_shape, beta_inverse_scale, x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="empiric_GammaPriorLikelihood_+3A_beta">beta</code></td>
<td>
<p>parameter.</p>
</td></tr>
<tr><td><code id="empiric_GammaPriorLikelihood_+3A_beta_shape">beta_shape</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="empiric_GammaPriorLikelihood_+3A_beta_inverse_scale">beta_inverse_scale</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="empiric_GammaPriorLikelihood_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="empiric_GammaPriorLikelihood_+3A_y">y</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>l -&gt; likelihood function
</p>

<hr>
<h2 id='empiric_NormalPriorLikelihood'>empiric model with normal prior</h2><span id='topic+empiric_NormalPriorLikelihood'></span>

<h3>Description</h3>

<p>empiric model with normal prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>empiric_NormalPriorLikelihood(beta, beta_mean, beta_sd, x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="empiric_NormalPriorLikelihood_+3A_beta">beta</code></td>
<td>
<p>parameter.</p>
</td></tr>
<tr><td><code id="empiric_NormalPriorLikelihood_+3A_beta_mean">beta_mean</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="empiric_NormalPriorLikelihood_+3A_beta_sd">beta_sd</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="empiric_NormalPriorLikelihood_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="empiric_NormalPriorLikelihood_+3A_y">y</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>l -&gt; likelihood function
</p>

<hr>
<h2 id='enroll_patient_plot'>
Plot patient enrollment for single trial
</h2><span id='topic+enroll_patient_plot'></span>

<h3>Description</h3>

<p>This function is used to generate the plot of patient enrollment with toxicity (red) and efficacy (green) outcomes of a single trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>enroll_patient_plot(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="enroll_patient_plot_+3A_data">data</code></td>
<td>
<p>A data frame with 3 columns DoseLevel, DLT for toxicity outcome, and ORR for efficacy outcome.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a ggplot object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># input the scenario with pre-defined true toxicity and efficacy probabilities
scenario &lt;- matrix(c(0.02, 0.05,
                     0.04, 0.10,
                     0.08, 0.15,
                     0.12, 0.32,
                     0.06, 0.10,
                     0.10, 0.15,
                     0.14, 0.25,
                     0.20, 0.35,
                     0.12, 0.18,
                     0.16, 0.22,
                     0.22, 0.35,
                     0.25, 0.40,
                     0.20, 0.24,
                     0.24, 0.35,
                     0.35, 0.45,
                     0.40, 0.50), ncol=2, byrow = TRUE)

# generate skeletons
DLT_skeleton &lt;- priorSkeletons(updelta=0.025, target=0.3, npos=10, ndose=16, 
                               model = "empiric", prior = "normal", beta_mean=0)
Efficacy_skeleton &lt;- priorSkeletons(updelta=0.025, target=0.5, npos=10, ndose=16, 
                                    model = "empiric", prior = "normal", beta_mean=0)

# simulate 1 trial under the same model and prior distribution
simRes &lt;- SIM_phase_I_II(nsim=1, Nmax=40, DoseComb=scenario, input_doseComb_forMat=c(4,4), 
                         input_type_forMat="matrix", input_Nphase=20,
                         input_DLT_skeleton=DLT_skeleton, 
                         input_efficacy_skeleton=Efficacy_skeleton,
                         input_DLT_thresh=0.3, input_efficacy_thresh=0.3,
                         input_cohortsize=1, input_corr=0,
                         input_early_stopping_safety_thresh=0.33,
                         input_early_stopping_futility_thresh=0.2,
                         input_model="empiric", input_para_prior="normal",
                         input_beta_mean=0, input_beta_sd=1,
                         input_theta_mean=0, input_theta_sd=1)

enroll_patient_plot(simRes$datALL[[1]])

</code></pre>

<hr>
<h2 id='examples_results'>Output dataset for examples given list of inputs</h2><span id='topic+examples_results'></span>

<h3>Description</h3>

<p>The dataset contains 1296 rows (6 scenarios, 4 different combinations of link functions and prior distributions, 
2 sets of skeletons, 3 maximum number of patients, 3 toxicity and efficacy correlations, and 3 subset number 
of patients) that represent each condition by 1000 simulations, along with 15 columns that contain 9 operating 
characteristics, other 6 columns including Scenario, Model for link function and prior distribution, N for 
maximum number of patients, Skeleton, Nphase for subset number of patients, and corr for toxicity and efficacy 
correlation to separate each condition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>examples_results
</code></pre>

<hr>
<h2 id='get_ordering'>
Complete orderings for combinations of two drugs
</h2><span id='topic+get_ordering'></span>

<h3>Description</h3>

<p>This function is to obtain complete orderings of both toxicity and efficacy for all drug combinations when considering the partial ordering issue for two combined drugs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ordering(doseComb_forMat, type_forMat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_ordering_+3A_dosecomb_format">doseComb_forMat</code></td>
<td>
<p>For 2 drugs, either a matrix with columns for all combinations and rows for two drugs when type_forMat is &quot;comb&quot;, or a vector of length 2 indicating the number of levels of each drug when type_forMat is &quot;matrix&quot; should be input. For more than 2 drugs, a list of all possible orderings should be input when type_forMat is &quot;self&quot;.</p>
</td></tr>
<tr><td><code id="get_ordering_+3A_type_format">type_forMat</code></td>
<td>
<p>A character string to indicate the input type of dose combinations. The type_forMat is either &quot;comb&quot; for inputting all tested dose combinations for 2 drugs, &quot;matrix&quot; for entering number of levels of two drugs so that a matrix of combinations can be constructed, or &quot;self&quot; for more than 3 drugs with directly input of all possible orderings.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Dose-toxicity and dose-efficacy curves for single drug are assumed as monotonically increasing as drug increases. After combined two drugs and traversing all combinations, the number of possible orderings exponentially expands when increasing dose levels for single drug or the dimensions of drug combinations, which will mask the information provided from orderings. Here, 6 typical complete orderings are utilized from practical design.
</p>
<p>Take the <code class="reqn">3 \times 3</code> matrix as an example so that there are total of <code class="reqn">9</code> does combination.
</p>
<p style="text-align: center;"><code class="reqn">B</code>
</p>

<p style="text-align: center;"><code class="reqn">\quad \quad 1\quad    2\quad    3</code>
</p>

<p style="text-align: center;"><code class="reqn">\quad 1\quad  d_1\quad  d_2\quad  d_3</code>
</p>

<p style="text-align: center;"><code class="reqn">A\; 2\quad  d_4\quad  d_5\quad  d_6</code>
</p>

<p style="text-align: center;"><code class="reqn">\quad 3\quad  d_7\quad  d_8\quad  d_9</code>
</p>

<p>Across rows: </p>
<p style="text-align: center;"><code class="reqn">\pi_T(d_1)\le \pi_T(d_2)\le \pi_T(d_3)\le \pi_T(d_4)\le \pi_T(d_5)\le \pi_T(d_6) \le \pi_T(d_7)\le \pi_T(d_8) \le \pi_T(d_9)</code>
</p>

<p>Up columns: </p>
<p style="text-align: center;"><code class="reqn">\pi_T(d_1)\le \pi_T(d_4)\le \pi_T(d_7)\le \pi_T(d_2)\le \pi_T(d_5)\le \pi_T(d_8) \le \pi_T(d_3)\le \pi_T(d_6) \le \pi_T(d_9)</code>
</p>

<p>Up diagonals: </p>
<p style="text-align: center;"><code class="reqn">\pi_T(d_1)\le \pi_T(d_2)\le \pi_T(d_4)\le \pi_T(d_3)\le \pi_T(d_5)\le \pi_T(d_7) \le \pi_T(d_6)\le \pi_T(d_8) \le \pi_T(d_9)</code>
</p>

<p>Down diagonals: </p>
<p style="text-align: center;"><code class="reqn">\pi_T(d_1)\le \pi_T(d_4)\le \pi_T(d_2)\le \pi_T(d_7)\le \pi_T(d_5)\le \pi_T(d_3) \le \pi_T(d_8)\le \pi_T(d_6) \le \pi_T(d_9)</code>
</p>

<p>Alternating down-up diagonals: </p>
<p style="text-align: center;"><code class="reqn">\pi_T(d_1)\le \pi_T(d_2)\le \pi_T(d_4)\le \pi_T(d_7)\le \pi_T(d_5)\le \pi_T(d_3) \le \pi_T(d_6)\le \pi_T(d_8) \le \pi_T(d_9)</code>
</p>

<p>Alternating up-down diagonals: </p>
<p style="text-align: center;"><code class="reqn">\pi_T(d_1)\le \pi_T(d_4)\le \pi_T(d_2)\le \pi_T(d_3)\le \pi_T(d_5)\le \pi_T(d_7) \le \pi_T(d_8)\le \pi_T(d_6) \le \pi_T(d_9)</code>
</p>

<p>Finally, obtain the unique orderings if there are any duplicates.
</p>


<h3>Value</h3>

<p>A list of vectors are returned, with each vector representing a specific order of dose combinations in ascending order (dose combinations are denoted by natrual numbers).
</p>


<h3>References</h3>

<p>Wages, N. A., &amp; Conaway, M. R. (2013). Specifications of a continual reassessment method design for phase I trials of combined drugs. Pharmaceutical statistics, 12(4), 217-224. <a href="https://doi.org/10.1002/pst.1575">doi:10.1002/pst.1575</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Input all dose combinations
doseComb &lt;- matrix(c(10, 3, 20, 3, 30, 3, 40, 3, 20, 5, 20, 7), byrow=FALSE, nrow=2)
orderings &lt;- get_ordering(doseComb_forMat = doseComb, type_forMat = "comb")

# Input number of dose levels
doseLevels &lt;- c(2,3)
orderings &lt;- get_ordering(doseComb_forMat = doseLevels, type_forMat = "matrix")

# Input customized orderings
orders &lt;- list(c(1,2,3,4,5), c(2,1,4,3,5), c(1,2,4,3,5), c(2,1,3,4,5))
orderings &lt;- get_ordering(doseComb_forMat = orders, type_forMat = "self")

# Extreme case: only one ordering will be input
orders &lt;- list(c(1,2,3,4,5,6,7))
orderings &lt;- get_ordering(doseComb_forMat = orders, type_forMat = "self")
</code></pre>

<hr>
<h2 id='logisticOnePara_GammaPriorLikelihood'>one-parameter logistic model with gamma prior</h2><span id='topic+logisticOnePara_GammaPriorLikelihood'></span>

<h3>Description</h3>

<p>one-parameter logistic model with gamma prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logisticOnePara_GammaPriorLikelihood(
  alpha1,
  alpha1_shape,
  alpha1_inverse_scale,
  intcpt,
  x,
  y
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logisticOnePara_GammaPriorLikelihood_+3A_alpha1">alpha1</code></td>
<td>
<p>parameter.</p>
</td></tr>
<tr><td><code id="logisticOnePara_GammaPriorLikelihood_+3A_alpha1_shape">alpha1_shape</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="logisticOnePara_GammaPriorLikelihood_+3A_alpha1_inverse_scale">alpha1_inverse_scale</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="logisticOnePara_GammaPriorLikelihood_+3A_intcpt">intcpt</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="logisticOnePara_GammaPriorLikelihood_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="logisticOnePara_GammaPriorLikelihood_+3A_y">y</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>l -&gt; likelihood function
</p>

<hr>
<h2 id='logisticOnePara_NormalPriorLikelihood'>one-parameter logistic model with normal prior</h2><span id='topic+logisticOnePara_NormalPriorLikelihood'></span>

<h3>Description</h3>

<p>one-parameter logistic model with normal prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logisticOnePara_NormalPriorLikelihood(
  alpha1,
  alpha1_mean,
  alpha1_sd,
  intcpt,
  x,
  y
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logisticOnePara_NormalPriorLikelihood_+3A_alpha1">alpha1</code></td>
<td>
<p>parameter.</p>
</td></tr>
<tr><td><code id="logisticOnePara_NormalPriorLikelihood_+3A_alpha1_mean">alpha1_mean</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="logisticOnePara_NormalPriorLikelihood_+3A_alpha1_sd">alpha1_sd</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="logisticOnePara_NormalPriorLikelihood_+3A_intcpt">intcpt</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="logisticOnePara_NormalPriorLikelihood_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="logisticOnePara_NormalPriorLikelihood_+3A_y">y</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>l -&gt; likelihood function
</p>

<hr>
<h2 id='logisticTwoPara_GammaPriorLikelihood'>two-parameter logistic model with gamma prior</h2><span id='topic+logisticTwoPara_GammaPriorLikelihood'></span>

<h3>Description</h3>

<p>two-parameter logistic model with gamma prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logisticTwoPara_GammaPriorLikelihood(
  alpha0,
  alpha1,
  alpha0_shape,
  alpha0_inverse_scale,
  alpha1_shape,
  alpha1_inverse_scale,
  x,
  y
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logisticTwoPara_GammaPriorLikelihood_+3A_alpha0">alpha0</code></td>
<td>
<p>parameter.</p>
</td></tr>
<tr><td><code id="logisticTwoPara_GammaPriorLikelihood_+3A_alpha1">alpha1</code></td>
<td>
<p>parameter.</p>
</td></tr>
<tr><td><code id="logisticTwoPara_GammaPriorLikelihood_+3A_alpha0_shape">alpha0_shape</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="logisticTwoPara_GammaPriorLikelihood_+3A_alpha0_inverse_scale">alpha0_inverse_scale</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="logisticTwoPara_GammaPriorLikelihood_+3A_alpha1_shape">alpha1_shape</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="logisticTwoPara_GammaPriorLikelihood_+3A_alpha1_inverse_scale">alpha1_inverse_scale</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="logisticTwoPara_GammaPriorLikelihood_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="logisticTwoPara_GammaPriorLikelihood_+3A_y">y</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>l -&gt; likelihood function
</p>

<hr>
<h2 id='logisticTwoPara_NormalPriorLikelihood'>two-parameter logistic model with normal prior</h2><span id='topic+logisticTwoPara_NormalPriorLikelihood'></span>

<h3>Description</h3>

<p>two-parameter logistic model with normal prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logisticTwoPara_NormalPriorLikelihood(
  alpha0,
  alpha1,
  alpha0_mean,
  alpha0_sd,
  alpha1_mean,
  alpha1_sd,
  x,
  y
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logisticTwoPara_NormalPriorLikelihood_+3A_alpha0">alpha0</code></td>
<td>
<p>parameter.</p>
</td></tr>
<tr><td><code id="logisticTwoPara_NormalPriorLikelihood_+3A_alpha1">alpha1</code></td>
<td>
<p>parameter.</p>
</td></tr>
<tr><td><code id="logisticTwoPara_NormalPriorLikelihood_+3A_alpha0_mean">alpha0_mean</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="logisticTwoPara_NormalPriorLikelihood_+3A_alpha0_sd">alpha0_sd</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="logisticTwoPara_NormalPriorLikelihood_+3A_alpha1_mean">alpha1_mean</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="logisticTwoPara_NormalPriorLikelihood_+3A_alpha1_sd">alpha1_sd</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="logisticTwoPara_NormalPriorLikelihood_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="logisticTwoPara_NormalPriorLikelihood_+3A_y">y</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>l -&gt; likelihood function
</p>

<hr>
<h2 id='maximization_phase'>
Maximization phase
</h2><span id='topic+maximization_phase'></span>

<h3>Description</h3>

<p>This function is used to perform maximization to select the dose level with maximum efficacy probability for next patient or cohort of patients allocation when the current sample size is greater than or equal to a pre-specified number.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maximization_phase(pE_est, seed_m=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="maximization_phase_+3A_pe_est">pE_est</code></td>
<td>
<p>A vector of estimated efficacy probability in the acceptable set.</p>
</td></tr>
<tr><td><code id="maximization_phase_+3A_seed_m">seed_m</code></td>
<td>
<p>An integer for the seed to generate random numbers used in maximization phase, default is NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If several dose combinations have the same maximum estimated efficacy probability, then randomly select one dose level for next enrolled patient or cohort of patients.
</p>


<h3>Value</h3>

<p>A number is returned indicating the dose level for next patient or cohort of patients allocation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Assume the estimated prbabilities for each dose combination in the acceptable set as:
p_est &lt;- c(0.1, 0.2, 0.3, 0.4)
# Dose level for next enrolled patient or cohort of patients is:
d &lt;- maximization_phase(p_est)
</code></pre>

<hr>
<h2 id='ODC_plot'>
Plot optimal combination dose selections
</h2><span id='topic+ODC_plot'></span>

<h3>Description</h3>

<p>This function is used to generate the plot of optimal combination dose (ODC) selections among a number simulation trials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ODC_plot(SimsRes)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ODC_plot_+3A_simsres">SimsRes</code></td>
<td>
<p>A S4 class stores simulation results obtained from function <code><a href="#topic+SIM_phase_I_II">SIM_phase_I_II</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a ggplot object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># input the scenario with pre-defined true toxicity and efficacy probabilities
scenario &lt;- matrix(c(0.02, 0.05,
                     0.04, 0.10,
                     0.08, 0.15,
                     0.12, 0.32,
                     0.06, 0.10,
                     0.10, 0.15,
                     0.14, 0.25,
                     0.20, 0.35,
                     0.12, 0.18,
                     0.16, 0.22,
                     0.22, 0.35,
                     0.25, 0.40,
                     0.20, 0.24,
                     0.24, 0.35,
                     0.35, 0.45,
                     0.40, 0.50), ncol=2, byrow = TRUE)

# generate skeletons
DLT_skeleton &lt;- priorSkeletons(updelta=0.025, target=0.3, npos=10, ndose=16, 
                               model = "empiric", prior = "normal", beta_mean=0)
Efficacy_skeleton &lt;- priorSkeletons(updelta=0.025, target=0.5, npos=10, ndose=16, 
                                    model = "empiric", prior = "normal", beta_mean=0)

# simulate 1 trial under the same model and prior distribution
simRes &lt;- SIM_phase_I_II(nsim=1, Nmax=40, DoseComb=scenario, input_doseComb_forMat=c(4,4), 
                         input_type_forMat="matrix", input_Nphase=20,
                         input_DLT_skeleton=DLT_skeleton, 
                         input_efficacy_skeleton=Efficacy_skeleton,
                         input_DLT_thresh=0.3, input_efficacy_thresh=0.3,
                         input_cohortsize=1, input_corr=0,
                         input_early_stopping_safety_thresh=0.33,
                         input_early_stopping_futility_thresh=0.2,
                         input_model="empiric", input_para_prior="normal",
                         input_beta_mean=0, input_beta_sd=1,
                         input_theta_mean=0, input_theta_sd=1)

ODC_plot(simRes)

</code></pre>

<hr>
<h2 id='patient_allocation_plot'>
Plot patient allocation for a single trial
</h2><span id='topic+patient_allocation_plot'></span>

<h3>Description</h3>

<p>This function is used to generate the plot of patient allocation by dose combinations of a single trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patient_allocation_plot(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="patient_allocation_plot_+3A_data">data</code></td>
<td>
<p>A data frame with 3 columns DoseLevel, DLT for toxicity outcome, and ORR for efficacy outcome.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a ggplot object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># input the scenario with pre-defined true toxicity and efficacy probabilities
scenario &lt;- matrix(c(0.02, 0.05,
                     0.04, 0.10,
                     0.08, 0.15,
                     0.12, 0.32,
                     0.06, 0.10,
                     0.10, 0.15,
                     0.14, 0.25,
                     0.20, 0.35,
                     0.12, 0.18,
                     0.16, 0.22,
                     0.22, 0.35,
                     0.25, 0.40,
                     0.20, 0.24,
                     0.24, 0.35,
                     0.35, 0.45,
                     0.40, 0.50), ncol=2, byrow = TRUE)

# generate skeletons
DLT_skeleton &lt;- priorSkeletons(updelta=0.025, target=0.3, npos=10, ndose=16, 
                               model = "empiric", prior = "normal", beta_mean=0)
Efficacy_skeleton &lt;- priorSkeletons(updelta=0.025, target=0.5, npos=10, ndose=16, 
                                    model = "empiric", prior = "normal", beta_mean=0)

# simulate 1 trial under the same model and prior distribution
simRes &lt;- SIM_phase_I_II(nsim=1, Nmax=40, DoseComb=scenario, input_doseComb_forMat=c(4,4), 
                         input_type_forMat="matrix", input_Nphase=20,
                         input_DLT_skeleton=DLT_skeleton, 
                         input_efficacy_skeleton=Efficacy_skeleton,
                         input_DLT_thresh=0.3, input_efficacy_thresh=0.3,
                         input_cohortsize=1, input_corr=0,
                         input_early_stopping_safety_thresh=0.33,
                         input_early_stopping_futility_thresh=0.2,
                         input_model="empiric", input_para_prior="normal",
                         input_beta_mean=0, input_beta_sd=1,
                         input_theta_mean=0, input_theta_sd=1)

patient_allocation_plot(simRes$datALL[[1]])

</code></pre>

<hr>
<h2 id='priorSkeletons'>
Generate the skeletons of toxicity and efficacy
</h2><span id='topic+priorSkeletons'></span>

<h3>Description</h3>

<p>This function is used to generate skeletons of toxicity and efficacy. This is a modifed version based on <code><a href="dfcrm.html#topic+getprior">getprior</a></code>, which keep the same procedure using empiric and one-parameter logistic models assumed normal priors with <code class="reqn">mean=0</code> and further add multiple models with various prior distributions including hyperbolic tangent model with exponential prior, empiric/one-parameter logistic models with normal prior and self-input mean values as well as with gamma prior, and two-parameter logistic model with normal/gamma priors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>priorSkeletons(updelta, target, npos, ndose,
               model = "empiric", prior = "normal",
               alpha_mean=NULL, beta_mean=0, a0 = 3,
               alpha_shape=NULL, alpha_inverse_scale=NULL,
               beta_shape=NULL, beta_inverse_scale=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="priorSkeletons_+3A_updelta">updelta</code></td>
<td>
<p>The half-width of the indifference intervals.</p>
</td></tr>
<tr><td><code id="priorSkeletons_+3A_target">target</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code id="priorSkeletons_+3A_npos">npos</code></td>
<td>
<p>The prior guess of the position of MTD.</p>
</td></tr>
<tr><td><code id="priorSkeletons_+3A_ndose">ndose</code></td>
<td>
<p>The number of testing doses.</p>
</td></tr>
<tr><td><code id="priorSkeletons_+3A_model">model</code></td>
<td>
<p>A character string to specify the model used. The default model is &quot;empiric&quot;. Other models include hyperbolic tangent model specified by &quot;tanh&quot;, one-parameter logistic model specified by &quot;logistic&quot;, and two-parameter logistic model specified by &quot;logistic2&quot;.</p>
</td></tr>
<tr><td><code id="priorSkeletons_+3A_prior">prior</code></td>
<td>
<p>A character sting to specify the prior distribution of parameter. The default prior is &quot;normal&quot; used together with the model=&quot;empiric&quot;. Other prior distributions include &quot;exponential&quot; when model=&quot;tanh&quot;, &quot;gamma&quot; when model=&quot;empiric&quot;, &quot;normal&quot; and &quot;gamma&quot; when model=&quot;logistic&quot; and &quot;logistic2&quot;.</p>
</td></tr>
<tr><td><code id="priorSkeletons_+3A_alpha_mean">alpha_mean</code></td>
<td>
<p>The mean of intercept parameter of two-parameter logistic model only used when model=&quot;logistic2&quot; and prior=&quot;normal&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="priorSkeletons_+3A_beta_mean">beta_mean</code></td>
<td>
<p>The mean of parameter used when prior=&quot;exponential&quot; or &quot;normal&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="priorSkeletons_+3A_a0">a0</code></td>
<td>
<p>A constant value of intercept from a one-parameter logistic model only used when model=&quot;logistic&quot; with default value 3, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="priorSkeletons_+3A_alpha_shape">alpha_shape</code></td>
<td>
<p>The shape parameter of intercept parameter only used when model=&quot;logistic2&quot; and prior=&quot;gamma&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="priorSkeletons_+3A_alpha_inverse_scale">alpha_inverse_scale</code></td>
<td>
<p>The scale parameter of intercept parameter only used when model=&quot;logistic2&quot; and prior=&quot;gamma&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="priorSkeletons_+3A_beta_shape">beta_shape</code></td>
<td>
<p>The shape parameter used when prior=&quot;gamma&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="priorSkeletons_+3A_beta_inverse_scale">beta_inverse_scale</code></td>
<td>
<p>The scale parameter used when prior=&quot;gamma&quot;, otherwise will be ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length <code class="reqn">ndose</code> is returned.
</p>


<h3>Note</h3>

<p>The skeletons can be either specified by clinical researchers based on history information or directly generated based on this function given specific model and prior distribution.
</p>


<h3>References</h3>

<p>Lee, S. M., &amp; Cheung, Y. K. (2009). Model calibration in the continual reassessment method. Clinical Trials, 6(3), 227-238. <a href="https://doi.org/10.1177/1740774509105076">doi:10.1177/1740774509105076</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate skeleton based on empiric model with normal prior
prior &lt;- priorSkeletons(updelta = 0.01, target = 0.25, npos= 5, ndose = 9, beta_mean = 0)

# generate skeleton based on one-parameter logistic model with normal prior
prior &lt;- priorSkeletons(updelta = 0.01, target = 0.25, npos= 5, ndose = 9,
                        model = "logistic", prior = "normal", beta_mean = 0, a0 = 3)
</code></pre>

<hr>
<h2 id='randomization_phase'>
Adaptive randomization
</h2><span id='topic+randomization_phase'></span>

<h3>Description</h3>

<p>This function is used to perform adaptive randomization for next patient or cohort of patients allocation when the current sample size is less than a pre-specified number.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randomization_phase(pE_est, seed_r=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="randomization_phase_+3A_pe_est">pE_est</code></td>
<td>
<p>A vector of estimated efficacy probability in the acceptable set.</p>
</td></tr>
<tr><td><code id="randomization_phase_+3A_seed_r">seed_r</code></td>
<td>
<p>An integer for the seed to generate random numbers used in randomization phase, default is NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The dose combination for next patient or cohort of patients allocation is <code class="reqn">d_i</code> with probability
</p>
<p style="text-align: center;"><code class="reqn">R_i = \frac{\hat{\pi}_E(d_i)}{\sum_i\hat{\pi}_E(d_i)}.</code>
</p>



<h3>Value</h3>

<p>A number is returned indicating the dose level for next patient or cohort of patients allocation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Assume the estimated prbabilities for each dose combination in the acceptable set as:
p_est &lt;- c(0.1, 0.2, 0.3, 0.4)
# Dose level for next enrolled patient or cohort of patients is:
d &lt;- randomization_phase(p_est)
</code></pre>

<hr>
<h2 id='rBin2Corr'>Generate correlated binary variables</h2><span id='topic+rBin2Corr'></span>

<h3>Description</h3>

<p>Generate correlated bivariate binary outcomes of toxicity and efficacy for a cohort number of patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rBin2Corr(cohortsize, pT, pE, psi, seed=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rBin2Corr_+3A_cohortsize">cohortsize</code></td>
<td>
<p>Number of patients in each cohort.</p>
</td></tr>
<tr><td><code id="rBin2Corr_+3A_pt">pT</code></td>
<td>
<p>Toxicity probability.</p>
</td></tr>
<tr><td><code id="rBin2Corr_+3A_pe">pE</code></td>
<td>
<p>Efficacy probability.</p>
</td></tr>
<tr><td><code id="rBin2Corr_+3A_psi">psi</code></td>
<td>
<p>Association parameter for efficacy and toxicity, where psi=0 means toxicity and efficacy is independent.</p>
</td></tr>
<tr><td><code id="rBin2Corr_+3A_seed">seed</code></td>
<td>
<p>An integer for the seed to generate random numbers, default is NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formula for generating correlated binary variables is
</p>
<p style="text-align: center;"><code class="reqn">\pi_{i,j} = (\pi_E)^i(1-\pi_E)^{1-i}(\pi_T)^j(1-\pi_T)^{1-j} + (-1)^{i+j}\pi_E(1-\pi_E)\pi_T(1-\pi_T)\left(\frac{e^{\psi}-1}{e^{\psi}+1}\right),</code>
</p>

<p>where <code class="reqn">i, j = 0, 1</code>, so that four probabilities can be calculated for the possible combinations of (toxicity, efficacy) including <code class="reqn">(1,1), (0,0), (0,1), (1,0)</code> given <code class="reqn">\pi_T</code> and <code class="reqn">\pi_E</code>. Multinomial distribution <code><a href="stats.html#topic+rmultinom">rmultinom</a></code> is further used to generate bivariate binary outcomes (number equals to cohortsize) based on the four calculated probabilities.
</p>


<h3>Value</h3>

<p>Return a <code class="reqn">cohortsize \times 2</code> matrix with columns corresponding to toxicity and efficacy, and rows for each observations of binary outcome with 0 for no toxicity (no efficacy) and 1 for toxicity (efficacy) at the first (second) column.
</p>


<h3>References</h3>

<p>Murtaugh, P. A., &amp; Fisher, L. D. (1990). Bivariate binary models of efficacy and toxicity in dose-ranging trials. Communications in Statistics-Theory and Methods, 19(6), 2003-2020. <a href="https://doi.org/10.1080/03610929008830305">doi:10.1080/03610929008830305</a>
</p>
<p>Thall, P. F., &amp; Cook, J. D. (2004). Dose‐finding based on efficacy–toxicity trade‐offs. Biometrics, 60(3), 684-693. <a href="https://doi.org/10.1111/j.0006-341X.2004.00218.x">doi:10.1111/j.0006-341X.2004.00218.x</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rBin2Corr(cohortsize = 1, pT = 0.2, pE = 0.4, psi = 0, seed=12)
</code></pre>

<hr>
<h2 id='sample_plot'>
Sample plot for a given output results
</h2><span id='topic+sample_plot'></span>

<h3>Description</h3>

<p>This function is used to generate the plot of relationships between outcomes and total average sample size, number of patients for determination of randomization phase, skeleton, and Association parameter for efficacy and toxicity binary outcome by different scenarios and link functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_plot(dat, outcome, outname, N = NULL, nR = NULL, Skeleton = NULL, corr = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sample_plot_+3A_dat">dat</code></td>
<td>
<p>Input data used for plot.</p>
</td></tr>
<tr><td><code id="sample_plot_+3A_outcome">outcome</code></td>
<td>
<p>Column name for the outcome used in the plot.</p>
</td></tr>
<tr><td><code id="sample_plot_+3A_outname">outname</code></td>
<td>
<p>A string for the name of outcome.</p>
</td></tr>
<tr><td><code id="sample_plot_+3A_n">N</code></td>
<td>
<p>Maximum sample size, if not fixed, use the default value NULL.</p>
</td></tr>
<tr><td><code id="sample_plot_+3A_nr">nR</code></td>
<td>
<p>Number of patients for determination of randomization phase, if not fixed, use the default value NULL.</p>
</td></tr>
<tr><td><code id="sample_plot_+3A_skeleton">Skeleton</code></td>
<td>
<p>Two skeletons with number 1 and 2, if not fixed, use the default value NULL.</p>
</td></tr>
<tr><td><code id="sample_plot_+3A_corr">corr</code></td>
<td>
<p>Association parameter for efficacy and toxicity, if not fixed, use the default value NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>4 settings with multiple inputs: need to fix three and plot each outcome vs. the remaining one by 6 scenarios:
</p>
<p>1. N: maximum sample size -&gt; 40, 50, 60 <br />
2. nR: subset sample size -&gt; 10, 20, 30 <br />
3. Skeleton: two sets of skeletons for toxicity and efficacy <br />
4. corr: correlation between toxicity and efficacy binary outcomes -&gt; 0, -2.049, 0.814
</p>


<h3>Value</h3>

<p>Returns a ggplot object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load the data stored in the crm12Comb package
data(examples_results, package = "crm12Comb")

# fix the number of patients for determination of randomization phase, skeleton, 
# and Association parameter for efficacy and toxicity binary outcome
# plot the relationship between 
# "Probability of ODC as target combinations" vs. total average sample size
sample_plot(examples_results, outcome = "prob_target", 
  outname = "Probability of ODC as target combinations", 
  N = NULL, nR = 20, Skeleton = 1, corr = 0)

</code></pre>

<hr>
<h2 id='SIM_phase_I_II'>
Single simulation of phase I/II adaptive design for drug combinations based on CRM design
</h2><span id='topic+SIM_phase_I_II'></span>

<h3>Description</h3>

<p>This function is to realize the simulations of whole process of combined phase I and phase II design for drug combinations with early stopping rules and flexible user-defined model or prior distribution, returning operating characters for performace evaluations and comparisons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SIM_phase_I_II(nsim, Nmax, DoseComb, input_doseComb_forMat, 
               input_type_forMat, input_Nphase,
               input_DLT_skeleton, input_efficacy_skeleton,
               input_DLT_thresh=0.3, input_efficacy_thresh=0.3,
               input_M_prob=NULL, input_K_prob=NULL,
               input_cohortsize=1, input_corr=0,
               input_early_stopping_safety_thresh=0.33,
               input_early_stopping_futility_thresh=0.2,
               input_model="empiric", input_para_prior="normal",
               input_beta_mean=0, input_beta_sd=1,
               input_intcpt_lgst1=3,
               input_beta_shape=1, input_beta_inverse_scale=1,
               input_theta_mean=0, input_theta_sd=1,
               input_theta_intcpt_lgst1=3,
               input_theta_shape=1, input_theta_inverse_scale=1,
               input_alpha_mean=3, input_alpha_sd=1,
               input_alpha_shape=1, input_alpha_inverse_scale=1,
               input_alphaT_mean=3, input_alphaT_sd=1,
               input_alphaT_shape=1, input_alphaT_inverse_scale=1,
               random_seed=42)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SIM_phase_I_II_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulation trials.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_nmax">Nmax</code></td>
<td>
<p>Number of maximum enrolled patients for each trial.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_dosecomb">DoseComb</code></td>
<td>
<p>A matrix with rows of length equaling number of dose combinations and columns of length equaling number of drugs for pre-defined true toxicity and true efficacy probabilities corresponding to each dose combinations.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_dosecomb_format">input_doseComb_forMat</code></td>
<td>
<p>For 2 drugs, either a matrix with columns for all combinations and rows for two drugs when input_type_forMat is &quot;comb&quot;, or a vector of length 2 indicating the number of levels of each drug when input_type_forMat is &quot;matrix&quot; should be input. For more than 2 drugs, a list of all possible orderings should be input when input_type_forMat is &quot;self&quot;.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_type_format">input_type_forMat</code></td>
<td>
<p>A character string to indicate the input type of dose combinations. The type_forMat is either &quot;comb&quot; for inputting all tested dose combinations for 2 drugs, &quot;matrix&quot; for entering number of levels of two drugs so that a matrix of combinations can be constructed, or &quot;self&quot; for more than 3 drugs with directly input of all possible orderings.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_nphase">input_Nphase</code></td>
<td>
<p>Number of patients for determination of randomization phase (current number of patients less than Nphase) or maximization phase (current number of patients larger than or equal to Nphase).</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_dlt_skeleton">input_DLT_skeleton</code></td>
<td>
<p>A vector with same length of dose combinations for toxicity skeleton for each dose combination.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_efficacy_skeleton">input_efficacy_skeleton</code></td>
<td>
<p>A vector with same length of dose combinations for efficacy skeleton for each dose combination.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_dlt_thresh">input_DLT_thresh</code></td>
<td>
<p>DLT threshold to define acceptable set.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_efficacy_thresh">input_efficacy_thresh</code></td>
<td>
<p>Efficacy threshold to define target combinations.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_m_prob">input_M_prob</code></td>
<td>
<p>A vector with same length of possible toxicity orderings denoting prior probabilities of toxicity orderings (sum is 1).</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_k_prob">input_K_prob</code></td>
<td>
<p>A vector with same length of possible efficacy orderings denoting prior probabilities of efficacy orderings (sum is 1).</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_cohortsize">input_cohortsize</code></td>
<td>
<p>Number of patients in each cohort.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_corr">input_corr</code></td>
<td>
<p>Association parameter for efficacy and toxicity, where 0 means toxicity and efficacy is independent.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_early_stopping_safety_thresh">input_early_stopping_safety_thresh</code></td>
<td>
<p>Safety threshold for early stopping condition.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_early_stopping_futility_thresh">input_early_stopping_futility_thresh</code></td>
<td>
<p>Futility threshold for early stopping condition.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_model">input_model</code></td>
<td>
<p>A character string to specify the model used, must be one of &quot;empiric&quot;, &quot;tanh&quot;, &quot;logistic&quot; or &quot;logistic2&quot;.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_para_prior">input_para_prior</code></td>
<td>
<p>A character string to specify the prior distribution used for parameters, must be one of &quot;normal&quot; or &quot;gamma&quot; (when input_model is either &quot;empiric&quot; or &quot;logistic&quot; or &quot;logistic2&quot;) or &quot;exponential&quot; (when input_model is &quot;tanh&quot;).</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_beta_mean">input_beta_mean</code></td>
<td>
<p>The mean of parameter used when input_para_prior=&quot;exponential&quot; or &quot;normal&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_beta_sd">input_beta_sd</code></td>
<td>
<p>The standard deviation of parameter used when input_para_prior=&quot;normal&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_intcpt_lgst1">input_intcpt_lgst1</code></td>
<td>
<p>A constant value of intercept from a one-parameter logistic model only used when input_model=&quot;logistic&quot; (suggested value is 3), otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_beta_shape">input_beta_shape</code></td>
<td>
<p>The shape parameter used when input_para_prior=&quot;gamma&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_beta_inverse_scale">input_beta_inverse_scale</code></td>
<td>
<p>The scale parameter used when input_para_prior=&quot;gamma&quot;, otherwise will be ignoredL.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_theta_mean">input_theta_mean</code></td>
<td>
<p>The mean of parameter used when input_para_prior=&quot;exponential&quot; or &quot;normal&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_theta_sd">input_theta_sd</code></td>
<td>
<p>The standard deviation of parameter used when input_para_prior=&quot;normal&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_theta_intcpt_lgst1">input_theta_intcpt_lgst1</code></td>
<td>
<p>A constant value of intercept from a one-parameter logistic model only used when input_model=&quot;logistic&quot; (default value is 3), otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_theta_shape">input_theta_shape</code></td>
<td>
<p>The shape parameter used when input_para_prior=&quot;gamma&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_theta_inverse_scale">input_theta_inverse_scale</code></td>
<td>
<p>The scale parameter used when input_para_prior=&quot;gamma&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_alpha_mean">input_alpha_mean</code></td>
<td>
<p>The mean of intercept parameter of two-parameter logistic model only used when model=&quot;logistic2&quot; and input_para_prior=&quot;normal&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_alpha_sd">input_alpha_sd</code></td>
<td>
<p>The standard deviation of intercept parameter of two-parameter logistic model only used when input_model=&quot;logistic2&quot; and input_para_prior=&quot;normal&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_alpha_shape">input_alpha_shape</code></td>
<td>
<p>The shape parameter of intercept parameter from a two-parameter logistic model only used when input_model=&quot;logistic2&quot; and input_para_prior=&quot;gamma&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_alpha_inverse_scale">input_alpha_inverse_scale</code></td>
<td>
<p>The scale parameter of intercept parameter from a two-parameter logistic model only used when input_model=&quot;logistic2&quot; and input_para_prior=&quot;gamma&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_alphat_mean">input_alphaT_mean</code></td>
<td>
<p>The mean of intercept parameter of two-parameter logistic model only used when model=&quot;logistic2&quot; and input_para_prior=&quot;normal&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_alphat_sd">input_alphaT_sd</code></td>
<td>
<p>The standard deviation of intercept parameter of two-parameter logistic model only used when input_model=&quot;logistic2&quot; and input_para_prior=&quot;normal&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_alphat_shape">input_alphaT_shape</code></td>
<td>
<p>The shape parameter of intercept parameter from a two-parameter logistic model only used when input_model=&quot;logistic2&quot; and input_para_prior=&quot;gamma&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_input_alphat_inverse_scale">input_alphaT_inverse_scale</code></td>
<td>
<p>The scale parameter of intercept parameter from a two-parameter logistic model only used when input_model=&quot;logistic2&quot; and input_para_prior=&quot;gamma&quot;, otherwise will be ignored.</p>
</td></tr>
<tr><td><code id="SIM_phase_I_II_+3A_random_seed">random_seed</code></td>
<td>
<p>An integer for the start seed to generate random numbers, default is 42.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is to realize the whole process of combined phase I and phase II adaptive design for drug combinations based on CRM amonng number of simulation trials. For each trial, basic steps include starting the trial for first patient or cohor of patients allocation, toxicity and efficacy estimations by current data, adaptive randomization or maximization phase for next patient or cohort of patients allocation, updating current data of patients enrollment, determining early stoppings for safety or fuility, and selecting optimal dose combination (ODC) after reaching maximum sample size or stopping early.
</p>


<h3>Value</h3>

<p>A list of operating characteristics is returned containing the following components:
</p>
<table role = "presentation">
<tr><td><code>prob_safe</code></td>
<td>
<p>Probability of simulation trials with ODC identified as safe/ineffective combinations.</p>
</td></tr>
<tr><td><code>prob_target</code></td>
<td>
<p>Probability of simulation trials with ODC identified as target combinations.</p>
</td></tr>
<tr><td><code>prob_toxic</code></td>
<td>
<p>Probability of simulation trials with ODC identified as toxic combinations.</p>
</td></tr>
<tr><td><code>mean_SS</code></td>
<td>
<p>Average number of patients enrolled.</p>
</td></tr>
<tr><td><code>mean_ODC</code></td>
<td>
<p>Average proportion of patients allocated to target ODS(s).</p>
</td></tr>
<tr><td><code>prob_stop_safety</code></td>
<td>
<p>Probability of simulation trials stopping early for safety.</p>
</td></tr>
<tr><td><code>prob_stop_futility</code></td>
<td>
<p>Probability of simulation trials stopping early for futility.</p>
</td></tr>
<tr><td><code>mean_DLT</code></td>
<td>
<p>Average observed DLT rate.</p>
</td></tr>
<tr><td><code>mean_ORR</code></td>
<td>
<p>Average observed response rate.</p>
</td></tr>
<tr><td><code>Npatient</code></td>
<td>
<p>A vector of number of patients enrolled for all simulation trials.</p>
</td></tr>
<tr><td><code>ODC</code></td>
<td>
<p>A vector of ODC for all simulation trials.</p>
</td></tr>
<tr><td><code>prop_ODC</code></td>
<td>
<p>A list of vectors storing dose levels for each patients allocation.</p>
</td></tr>
<tr><td><code>datALL</code></td>
<td>
<p>A list of data frames storing data of (doselevel, toxicity, efficacy) for each patient.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wages, N. A., &amp; Conaway, M. R. (2014). Phase I/II adaptive design for drug combination oncology trials. Statistics in medicine, 33(12), 1990-2003. <a href="https://doi.org/10.1002/sim.6097">doi:10.1002/sim.6097</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+priorSkeletons">priorSkeletons</a></code>, <code><a href="#topic+get_ordering">get_ordering</a></code>, <code><a href="#topic+toxicity_est">toxicity_est</a></code>, <code><a href="#topic+efficacy_est">efficacy_est</a></code>, <code><a href="#topic+rBin2Corr">rBin2Corr</a></code>, <code><a href="stats.html#topic+binom.test">binom.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># input the scenario with pre-defined true toxicity and efficacy probabilities
scenario &lt;- matrix(c(0.02, 0.05,
                     0.04, 0.10,
                     0.08, 0.15,
                     0.12, 0.32,
                     0.06, 0.10,
                     0.10, 0.15,
                     0.14, 0.25,
                     0.20, 0.35,
                     0.12, 0.18,
                     0.16, 0.22,
                     0.22, 0.35,
                     0.25, 0.40,
                     0.20, 0.24,
                     0.24, 0.35,
                     0.35, 0.45,
                     0.40, 0.50), ncol=2, byrow = TRUE)

# generate skeletons
DLT_skeleton &lt;- priorSkeletons(updelta=0.025, target=0.3, npos=10, ndose=16, 
                               model = "empiric", prior = "normal", beta_mean=0)
Efficacy_skeleton &lt;- priorSkeletons(updelta=0.025, target=0.5, npos=10, ndose=16, 
                                    model = "empiric", prior = "normal", beta_mean=0)

# simulate 1 trial under the same model and prior distribution
simRes &lt;- SIM_phase_I_II(nsim=1, Nmax=40, DoseComb=scenario, input_doseComb_forMat=c(4,4), 
                         input_type_forMat="matrix", input_Nphase=20,
                         input_DLT_skeleton=DLT_skeleton, 
                         input_efficacy_skeleton=Efficacy_skeleton,
                         input_DLT_thresh=0.3, input_efficacy_thresh=0.3,
                         input_cohortsize=1, input_corr=0,
                         input_early_stopping_safety_thresh=0.33,
                         input_early_stopping_futility_thresh=0.2,
                         input_model="empiric", input_para_prior="normal",
                         input_beta_mean=0, input_beta_sd=1,
                         input_theta_mean=0, input_theta_sd=1)
</code></pre>

<hr>
<h2 id='tanh_ExpPriorLikelihood'>Title: Bayesian likelihood inference</h2><span id='topic+tanh_ExpPriorLikelihood'></span>

<h3>Description</h3>

<p>Title: Bayesian likelihood inference
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tanh_ExpPriorLikelihood(beta, beta_mean, x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tanh_ExpPriorLikelihood_+3A_beta">beta</code></td>
<td>
<p>parameter.</p>
</td></tr>
<tr><td><code id="tanh_ExpPriorLikelihood_+3A_beta_mean">beta_mean</code></td>
<td>
<p>A number.</p>
</td></tr>
<tr><td><code id="tanh_ExpPriorLikelihood_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="tanh_ExpPriorLikelihood_+3A_y">y</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>l -&gt; likelihood function
</p>


<h3>References</h3>

<p>: R package dfcrm
Hyperbolic tangent model with exponential prior
</p>

<hr>
<h2 id='toxicity_est'>
Toxicity estimation
</h2><span id='topic+toxicity_est'></span>

<h3>Description</h3>

<p>Estimate toxicity using Bayesian inference for each enrolled patient or cohort of patients given the current accumulated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toxicity_est(Dat, I, M, M_prob, DLT_skeleton, DLT_thresh,
             model, para_prior,
             beta_mean, beta_sd, intcpt_lgst1, beta_shape, beta_inverse_scale,
             alpha_mean, alpha_sd, alpha_shape, alpha_inverse_scale, seed=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="toxicity_est_+3A_dat">Dat</code></td>
<td>
<p>A data frame for current data with three columns (DoseLevel, DLT and ORR).</p>
</td></tr>
<tr><td><code id="toxicity_est_+3A_i">I</code></td>
<td>
<p>Number of dose combinations.</p>
</td></tr>
<tr><td><code id="toxicity_est_+3A_m">M</code></td>
<td>
<p>Number of toxicity orderings.</p>
</td></tr>
<tr><td><code id="toxicity_est_+3A_m_prob">M_prob</code></td>
<td>
<p>A vector of length <code class="reqn">M</code> denoting prior probabilities of toxicity orderings (sum is 1).</p>
</td></tr>
<tr><td><code id="toxicity_est_+3A_dlt_skeleton">DLT_skeleton</code></td>
<td>
<p>A list of vector with length <code class="reqn">M</code> containing toxicity orderings.</p>
</td></tr>
<tr><td><code id="toxicity_est_+3A_dlt_thresh">DLT_thresh</code></td>
<td>
<p>DLT threshold to define acceptable set.</p>
</td></tr>
<tr><td><code id="toxicity_est_+3A_model">model</code></td>
<td>
<p>A character string to specify the model used, must be one of &quot;empiric&quot;, &quot;tanh&quot;, &quot;logistic&quot; or &quot;logistic2&quot;.</p>
</td></tr>
<tr><td><code id="toxicity_est_+3A_para_prior">para_prior</code></td>
<td>
<p>A character string to specify the prior distribution used for parameters, must be one of &quot;normal&quot; or &quot;gamma&quot; (when model is either &quot;empiric&quot; or &quot;logistic&quot; or &quot;logistic2&quot;) or &quot;exponential&quot; (when model is &quot;tanh&quot;).</p>
</td></tr>
<tr><td><code id="toxicity_est_+3A_beta_mean">beta_mean</code></td>
<td>
<p>The mean of parameter used when prior=&quot;exponential&quot; or &quot;normal&quot;, otherwise need to specify NULL.</p>
</td></tr>
<tr><td><code id="toxicity_est_+3A_beta_sd">beta_sd</code></td>
<td>
<p>The standard deviation of parameter used when prior=&quot;normal&quot;, otherwise need to specify NULL.</p>
</td></tr>
<tr><td><code id="toxicity_est_+3A_intcpt_lgst1">intcpt_lgst1</code></td>
<td>
<p>A constant value of intercept from a one-parameter logistic model only used when model=&quot;logistic&quot; (suggested value is 3), otherwise need to specify NULL.</p>
</td></tr>
<tr><td><code id="toxicity_est_+3A_beta_shape">beta_shape</code></td>
<td>
<p>The shape parameter used when prior=&quot;gamma&quot;, otherwise need to specify NULL.</p>
</td></tr>
<tr><td><code id="toxicity_est_+3A_beta_inverse_scale">beta_inverse_scale</code></td>
<td>
<p>The scale parameter used when prior=&quot;gamma&quot;, otherwise need to specify NULL.</p>
</td></tr>
<tr><td><code id="toxicity_est_+3A_alpha_mean">alpha_mean</code></td>
<td>
<p>The mean of intercept parameter of two-parameter logistic model only used when model=&quot;logistic2&quot; and prior=&quot;normal&quot;, otherwise need to specify NULL.</p>
</td></tr>
<tr><td><code id="toxicity_est_+3A_alpha_sd">alpha_sd</code></td>
<td>
<p>The standard deviation of intercept parameter of two-parameter logistic model only used when model=&quot;logistic2&quot; and prior=&quot;normal&quot;, otherwise need to specify NULL.</p>
</td></tr>
<tr><td><code id="toxicity_est_+3A_alpha_shape">alpha_shape</code></td>
<td>
<p>The shape parameter of intercept parameter from a two-parameter logistic model only used when model=&quot;logistic2&quot; and prior=&quot;gamma&quot;, otherwise need to specify NULL.</p>
</td></tr>
<tr><td><code id="toxicity_est_+3A_alpha_inverse_scale">alpha_inverse_scale</code></td>
<td>
<p>The scale parameter of intercept parameter from a two-parameter logistic model only used when model=&quot;logistic2&quot; and prior=&quot;gamma&quot;, otherwise need to specify NULL.</p>
</td></tr>
<tr><td><code id="toxicity_est_+3A_seed">seed</code></td>
<td>
<p>An integer for the seed to generate random numbers used for equal ordering prior probabilities, default is NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The toxicity estimation is based on Bayesian framework by calculating the likelihood function under each orderings, and select the ordering with maximum posterior probability. Then, estimated parameters can be obtained, which will be used for toxicity estimation based on the corresponding link function (specified in <code class="reqn">model</code> statement).
</p>


<h3>Value</h3>

<p>A list is returned containing the following components:
</p>
<table role = "presentation">
<tr><td><code>mStar</code></td>
<td>
<p>An integer for toxicity ordering with maximum posterior density given the current accumulated data.</p>
</td></tr>
<tr><td><code>piT_hat</code></td>
<td>
<p>A vector for estimated toxicity probabilities given the current accumulated data.</p>
</td></tr>
<tr><td><code>AR</code></td>
<td>
<p>A vector for dose levels belonging to acceptable set (estimated DLT rate less than pre-specified DLT threshold).</p>
</td></tr>
<tr><td><code>M_prob</code></td>
<td>
<p>A vector for posterier density of toxicity orderings and will be used as prior information for next enrolled patient or cohort of patients.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wages, N. A., &amp; Conaway, M. R. (2014). Phase I/II adaptive design for drug combination oncology trials. Statistics in medicine, 33(12), 1990-2003. <a href="https://doi.org/10.1002/sim.6097">doi:10.1002/sim.6097</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+priorSkeletons">priorSkeletons</a></code>, <code><a href="#topic+get_ordering">get_ordering</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a data including 3 columns: DoseLevel, DLT, ORR (DLT and ORR are binary outcomes)
currDat &lt;- data.frame(sample(1:9, 6, replace=TRUE), rbinom(6, 1, 0.2), rbinom(6, 1, 0.5))
names(currDat) &lt;- c("DoseLevel", "DLT", "ORR")

# Generate toxicity skeleton
DLT_skeleton_p &lt;- priorSkeletons(updelta = 0.045, target = 0.3, npos= 5, ndose = 9,
                                 model = "logistic", prior = "normal", beta_mean = 0, a0 = 3)

# Obtain 6 complete orderings for toxicity skeleton
orderings &lt;- get_ordering(doseComb_forMat=c(3,3), type_forMat="matrix")
DLT_skeleton_l &lt;- lapply(orderings, function(or){DLT_skeleton_p[or]})

# estimate toxicity
tox &lt;- toxicity_est(Dat=currDat, I=9, M=6, M_prob=rep(1/6, 6),
                    DLT_skeleton=DLT_skeleton_l, DLT_thresh=0.3,
                    model="logistic", para_prior="normal",
                    beta_mean=0, beta_sd=1, intcpt_lgst1=3,
                    beta_shape=NULL, beta_inverse_scale=NULL,
                    alpha_mean=NULL, alpha_sd=NULL,
                    alpha_shape=NULL, alpha_inverse_scale=NULL,
                    seed=42)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
