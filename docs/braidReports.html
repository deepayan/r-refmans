<!DOCTYPE html><html><head><title>Help for package braidReports</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {braidReports}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#braidReports-package'>
<p>Visualize Combined Action Response Surfaces and Report BRAID Analyses</p></a></li>
<li><a href='#calculateIAE'>
<p>Calculate the Index of Achievable Efficacy</p></a></li>
<li><a href='#es8analysis'><p>Analysis of a Ewings-Sarcoma Experiment</p></a></li>
<li><a href='#formatResponseMap'>
<p>Format Response and Error Maps</p></a></li>
<li><a href='#makeBRAIDreport'>
<p>Make a BRAID Report Page</p></a></li>
<li><a href='#potentiationPlot'>
<p>Plot Potentiation in a BRAID Fitted Combination</p></a></li>
<li><a href='#responseMap'>
<p>Visualizing Combination Response Maps</p></a></li>
<li><a href='#voronoi'>
<p>Voronoi segmentation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Visualize Combined Action Response Surfaces and Report BRAID
Analyses</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-01-04</td>
</tr>
<tr>
<td>Author:</td>
<td>Nathaniel R. Twarog</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nathaniel R. Twarog &lt;nathaniel.twarog@stjude.org&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>ggplot2, braidrm, stats</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, grid</td>
</tr>
<tr>
<td>Suggests:</td>
<td>gtable, gridExtra (&ge; 2.0.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to generate, format, and style surface plots for visualizing combined action data.  Also provides functions for reporting on a BRAID analysis, including plotting curve-shifts, calculating IAE values, and producing full BRAID analysis reports.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-01-04 16:53:41 UTC; ntwarog</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-01-05 18:20:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='braidReports-package'>
Visualize Combined Action Response Surfaces and Report BRAID Analyses
</h2><span id='topic+braidReports-package'></span><span id='topic+braidReports'></span>

<h3>Description</h3>

<p>Building on the <code>ggplot2</code> plotting package, this package provides functions to generate,
format, and style surface plots for visualizing combined action data without resorting to
three-dimensional surface plots, which can be difficult to interpret.  The package also provides
functions for reporting on a BRAID analysis, including plotting curve-shifts, calculating IAE
values, and producing full BRAID analysis reports.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> braidReports</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.5.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-04-05</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=3)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The heart of the package is the function <code><a href="#topic+responseMap">responseMap</a></code>, which produces a <code>ggplot2</code>
tile or surface plot from combined action data, consolidating many of the minutiae of plotting such
surfaces into a single, easily used function.  The functions <code><a href="#topic+formatResponseMap">formatResponseMap</a></code> and
<code><a href="#topic+formatDifferenceMap">formatDifferenceMap</a></code> provide pre-built formatting and themes for quickly generating
publishable or shareable activity plots and error plots.  In addition, several functions provide
additional analytical and reporting options for BRAID analyses (from the package <code>braidrm</code>).
The function <code><a href="#topic+calculateIAE">calculateIAE</a></code> estimates the combined therapeutic window for a pair of
active compounds; the function <code><a href="#topic+potentiationPlot">potentiationPlot</a></code> produces fast and easy curve-shift
plots to visualize the potentiation of one compound by the presence of another; and
<code><a href="#topic+makeBRAIDreport">makeBRAIDreport</a></code> serves as a (nearly) fully-functional apparatus for translating
a BRAID analysis into a one-page comprehensive report.
</p>


<h3>Author(s)</h3>

<p>Nathaniel R. Twarog &lt;nathaniel.twarog@stjude.org&gt;
</p>


<h3>References</h3>

<p>Twarog, N.R., Stewart, E., Vowell Hamill, C., and Shelat, A.  BRAID: A Unifying Paradigm for the 
Analysis of Combined Drug Action. <em>Scientific Reports</em> <strong>In Press</strong> (2016).
</p>


<h3>See Also</h3>

<p><code>braidrm-package</code>
</p>

<hr>
<h2 id='calculateIAE'>
Calculate the Index of Achievable Efficacy
</h2><span id='topic+calculateIAE'></span>

<h3>Description</h3>

<p>Calculates the index of achievable efficacy, or IAE, (a measure of a drug combination's efficacy
relative to toxicological and pharmacological constraints) based on a response surface
representation of a combination in the form of a full BRAID surface parameter vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateIAE(parv, lev, macs, same = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculateIAE_+3A_parv">parv</code></td>
<td>
<p> a full 10-element BRAID surface parameter vector </p>
</td></tr>
<tr><td><code id="calculateIAE_+3A_lev">lev</code></td>
<td>
<p> a single value or vector representing the effect level or levels at which the IAE
should be calculated </p>
</td></tr>
<tr><td><code id="calculateIAE_+3A_macs">macs</code></td>
<td>
<p> the maximum achievable concentrations of the two drugs whose effects are represented
by the response surface. A single value may be given, which will be used for both drugs </p>
</td></tr>
<tr><td><code id="calculateIAE_+3A_same">same</code></td>
<td>
<p> a boolean variable representing whether the two drugs in the combination are
believed to be the same drug (their dose-response parameters need not be identical).  If
<code>TRUE</code>, the values in <code>macs</code> must be identical </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The IAE is a measure of the aggregate ratio of achievable dose-pairs for a given combination and
the minimum dose pairs required to achieve a given effect.  Formally, it is defined as
</p>
<p style="text-align: center;"><code class="reqn">IAE=\left(\frac{\int_{AC}{dD_A dD_B}}{\int_{AC}{\left(1-H\left(\frac{E_{AB}(D_A,D_B)-E}{E_f-E}\right)\right)dD_A dD_B}}\right)^{1/2}</code>
</p>

<p>where <code class="reqn">AC</code> is the space of all achievable dose pairs as determined by pharmacological or
toxicological constraints.  In this function, this space is represented either as a rectangular
region in dose-pair-space bounded by the two values in the parameter <code>macs</code> (when <code>same</code>
is <code>FALSE</code>) or the lower triangular region of dose-pair-space in which the sum of the two
doses is less than the single value in <code>macs</code> (when <code>same</code> is <code>TRUE</code>).
</p>


<h3>Value</h3>

<p>A single value or vector of values containing the estimated IAE for the response surface at the
effect level or levels specified in <code>lev</code>.
</p>


<h3>Author(s)</h3>

<p>Nathaniel R. Twarog
</p>


<h3>References</h3>

<p>Twarog, N.R., Stewart, E., Vowell Hamill, C., and Shelat, A.  BRAID: A Unifying Paradigm for the 
Analysis of Combined Drug Action. <em>Scientific Reports</em> <strong>In Press</strong> (2016).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+makeBRAIDreport">makeBRAIDreport</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(es8analysis)
bfit &lt;- es8analysis$braidFit
# Modelled effect is base-10 logarithm of cell survival relative to negative controls,
# so a level of -2 reflects 99% cell killing
calculateIAE(bfit$fullpar,c(-1,-2),c(1.015*10^-6,5*10^-5))
</code></pre>

<hr>
<h2 id='es8analysis'>Analysis of a Ewings-Sarcoma Experiment</h2><span id='topic+es8analysis'></span>

<h3>Description</h3>

<p>This list is the results of full BRAID analysis run on the <code>es8olatmz</code> dataset
from the <code>braidrm</code> package.  The list was output by the function
<code>runBRAIDanalysis</code>, and follows the format described therein.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(es8analysis)</code></pre>


<h3>Format</h3>

<p> A list of objects produced by the function <code>runBRAIDanalysis</code> </p>

<hr>
<h2 id='formatResponseMap'>
Format Response and Error Maps
</h2><span id='topic+formatResponseMap'></span><span id='topic+formatDifferenceMap'></span>

<h3>Description</h3>

<p>Format response maps as activity maps using a multicolor gradient or error maps using a bidirectional gradient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formatResponseMap(rmap, palette = NULL, cscale = NULL, xl = expression(Conc[A]),
					yl = expression(Conc[B]), zl = "Activity")
formatDifferenceMap(rmap, zcenter = NULL, xl = expression(Conc[A]),
					yl = expression(Conc[B]), zl = "Diff")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formatResponseMap_+3A_rmap">rmap</code></td>
<td>
<p> a <code>ggplot2</code> plot object depicting a response map, produced by the function
<code>responseMap</code> </p>
</td></tr>
<tr><td><code id="formatResponseMap_+3A_palette">palette</code></td>
<td>
<p> a character vector or two or more colors defining the colorscale to be applied to the fill
variable in the plot. </p>
</td></tr>
<tr><td><code id="formatResponseMap_+3A_cscale">cscale</code></td>
<td>
<p> a value around which the colorscale applied to the fill variable will be centered. If
<code>NULL</code> (the default), the colorscale will range from the minimum fill variable to the maximum.  </p>
</td></tr>
<tr><td><code id="formatResponseMap_+3A_xl">xl</code></td>
<td>
<p> The character string or expression used to label the x-axis</p>
</td></tr>
<tr><td><code id="formatResponseMap_+3A_yl">yl</code></td>
<td>
<p> The character string or expression used to label the y-axis </p>
</td></tr>
<tr><td><code id="formatResponseMap_+3A_zl">zl</code></td>
<td>
<p> The character string or expression used to label the colorscale representing the response variable </p>
</td></tr>
<tr><td><code id="formatResponseMap_+3A_zcenter">zcenter</code></td>
<td>
<p> the value that forms the centerpoint (white) in the bidirectional color scale.  If <code>NULL</code>
(the default), the default setting for <code>scale_fill_gradient2</code> is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are largely convenience functions, taking a response map produced by <code><a href="#topic+responseMap">responseMap</a></code>
and formatting it with colorscales and axis labels.  <code>formatResponseMap</code> with a multicolor gradient; by
default it uses a modified 'jet' colormap, ranging from dark red to dark green, rather than the traditional
dark blue.  We find this function useful for visualizing response surfaces representing variables such as
cytotoxicity, cell viability, enzyme activity, etc.  The other formats the response map with a bidirectional
color gradient (using the <code>ggplot2</code> function <code>scale_fill_gradient2</code>; we find this format ideal for
visualizing error maps.
</p>


<h3>Value</h3>

<p> A <code>ggplot2</code> plot object, with the appropriate scales and labels added. </p>


<h3>Author(s)</h3>

<p>Nathaniel R. Twarog
</p>


<h3>References</h3>

<p>Twarog, N.R., Stewart, E., Vowell Hamill, C., and Shelat, A.  BRAID: A Unifying Paradigm for the 
Analysis of Combined Drug Action. <em>Scientific Reports</em> <strong>In Press</strong> (2016).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+responseMap">responseMap</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(es8olatmz,package="braidrm")
rmap &lt;- responseMap(act~conc1+conc2,es8olatmz)
formatResponseMap(rmap,xl="Olaparib",yl="TMZ",zl="Survival")
formatDifferenceMap(rmap,zcenter=-1)
</code></pre>

<hr>
<h2 id='makeBRAIDreport'>
Make a BRAID Report Page
</h2><span id='topic+makeBRAIDreport'></span>

<h3>Description</h3>

<p>Produces a one page report depicting the results of a full BRAID analysis for a single
combination.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeBRAIDreport(brdAnalysis, compounds, iaelevs, macs, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makeBRAIDreport_+3A_brdanalysis">brdAnalysis</code></td>
<td>
<p> a list representing the results of a full BRAID analysis, produced by the
<code>braidrm</code> function <code>runBRAIDanalysis</code> </p>
</td></tr>
<tr><td><code id="makeBRAIDreport_+3A_compounds">compounds</code></td>
<td>
<p> A two element character vector containing the names of the two compounds
tested. Should be the same string repeated if combinaion is self-vs.-self </p>
</td></tr>
<tr><td><code id="makeBRAIDreport_+3A_iaelevs">iaelevs</code></td>
<td>
<p> one or two effect levels at which the IAE and potentiation will be estimated </p>
</td></tr>
<tr><td><code id="makeBRAIDreport_+3A_macs">macs</code></td>
<td>
<p> the maximum achievable concentrations for the two compounds tested for the
calculation of the IAE.  If one concentration is provided, it will be used for both compounds.
If combination is self-vs.-self the two concentrations must be equal. </p>
</td></tr>
<tr><td><code id="makeBRAIDreport_+3A_control">control</code></td>
<td>
<p> A list of optional control parameters adjusting the appearance of the report
see Details for a full description </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is, by design, a rather massive function that attempts, however foolhardily, to consolidate
all the pieces necessary to produce a comprehensive visualization and report on the results of a
BRAID analysis.  By default, it produces a one page report containing four rows of three panels.
The first row contains a plot of the measured data passed to the BRAID fit, plotted without
interpolation; a table of the best fit BRAID parameters, with confidence intervals; and tables of
one or more IAE values (with confidence intervals), as determined by the given maximum achievable
concentrations and either a purely additive surface or the best fit BRAID surface.  The second row
contains the measured data plotted with interpolation to convey the shape of the measured response
surface; a plot of the predicted response surface assuming the measured dose-response behavior and
BRAID additivity; and a plot of the best fit BRAID response surface.  The third row contains a
uninterpolated plot of the error resulting from simple smoothing (to provide a reasonable upper
bound on quality of fit); a plot of the error resulting from a predicted additive surface (with
R-squared value); and a plot of the error resulting from the best fit BRAID surface (with R-squared
value).  The fourth and final row shows potentiation in the best fit surface, containing tables of
EC values for a specified threshold for each drug in the presence of various levels of the other;
a potentiation plot of the first drug potentiated by the second; and the corresponding plot with
the two drugs reversed.  The theme settings and sizes are intended for use on a portrait-oriented
8.5 by 11 inch page.
</p>
<p>Many details of the plots and report are adjusted by the <code>control</code> parameter, which may
contain any or all of the following elements:
</p>

<dl>
<dt>plot</dt><dd><p> a boolean determining whether the function arranges the constructed plots and tables
and prints them to the existing graphics device.  Doing so requires the package <code>gridExtra</code>
(version 2.0.0 or greater); if this package is not included, a warning will be printed and this
parameter will be reset to <code>FALSE</code>.  Default value is <code>TRUE</code> </p>
</dd>
<dt>return</dt><dd><p> a boolean determining whether the pieces generated for the report are returned as
a result of the function. This option can be used if the user wishes to arrange the plot him or
herself, rather than using the default layout approach.  If <code>TRUE</code>, the function returns a
list of fourteen objects; the nine <code>ggplot</code> plots described above, followed by the five tables
assembled for the report.  Note that the tables are returned as standard R arrays, not grid or
graphics objects. Using this option with <code>plot</code> set to <code>FALSE</code> does not require the
presence of <code>gridExtra</code>. Default value is <code>FALSE</code> </p>
</dd>
<dt>actlabel</dt><dd><p> a string or R expression to be used as the label of the modeled effect in all
plots. Default value is <code>"Effect"</code> </p>
</dd>
<dt>abbs</dt><dd><p> in axis labels and tables, the two drugs being combined are represented by
abbreviations.  By default these abbreviations consist of the first three characters of each
compound name, with non alphanumeric characters removed.  However, the user may wish to use custom
abbreviations (e.g. &quot;TMZ&quot; for &quot;temozolomide&quot;); they may do so by specifying two abbreviations as
two strings in this optional parameter. </p>
</dd>
<dt>levtext</dt><dd><p> an optional character vector the same length as <code>iaelevs</code>, determining how
the corresponding levels will be displayed in tables.  For example, if the modelled effect were
proportional cell survival, the user might want to specify a label of &quot;90&quot; for a modelled effect
of 0.1. </p>
</dd>
<dt>irreg</dt><dd><p> a boolean variable, passed to <code><a href="#topic+responseMap">responseMap</a></code>, reflecting whether the
dose pairs being plotted lie on a regularly spaced grid.  Default value is <code>FALSE</code> </p>
</dd>
<dt>clog</dt><dd><p> a boolean variable, reflecting whether the concentration variables are plotted on a
logarithmic scale.  This affects both the x- and y-axes in the seven surface plots, and the x-axis
in the TWO potentiation plots. Default value is <code>TRUE</code> </p>
</dd>
<dt>zlog</dt><dd><p> a boolean variable, reflecting whether the modeled effect is plotted on a
logarithmic scale.  This affects only the y-axis in the two potentiaton plots.  Default value is
<code>FALSE</code> </p>
</dd>
<dt>xtrans</dt><dd><p> an optional function mapping the concentration of the first drug to the
transformed value that the user wishes to plot.  A simple example would be one in which the fit was
performed on concentrations expressed in molar, but the user wishes to plot the concentrations in
micromolar, in which case the value of 'xtrans' might be <code>function(x) x*10^6</code>. </p>
</dd>
<dt>ytrans</dt><dd><p> an optional function mapping the concentration of the second drug to the
transformed value that the user wishes to plot </p>
</dd>
<dt>xunit</dt><dd><p> a string or R expression (e.g. <code>expression(mu*M)</code>) specifying how the units of
the first drug should be displayed in axis labels and tables.  If not specified, units will be
omitted. </p>
</dd>
<dt>yunit</dt><dd><p> a string or R expression (e.g. <code>expression(mu*M)</code>) specifying how the units of
the second drug should be displayed in axis labels and tables.  If not specified, units will be
omitted. </p>
</dd>
<dt>ztrans</dt><dd><p> an optional function mapping the modelled effect to the transformed value that the
user wishes to plot.  An example might be a case in which the modelled effect variable is a
logarithmic transform of a real-world measurement, and the user wishes to plot the measured value,
in which case the value of 'ztrans' might be <code>function(z) 10^z</code>. </p>
</dd>
<dt>palette</dt><dd><p> a vector of two or more strings representing R colors, which will be passed to the
<code>ggplot2</code> function <code><a href="ggplot2.html#topic+scale_fill_gradientn">scale_fill_gradientn</a></code> to specify the colormap for the plotted
response surfaces.  If left unspecified, a modified version of the classic &quot;jet&quot; colorscale (with
dark green substituted for dark blue) will be used.  Alternatively, if the user sets this parameter
to the string <code>"gjet"</code> or <code>"revgjet"</code>, the plots will use the modified &quot;jet&quot; colormap or
its reverse. </p>
</dd>
<dt>ptsize</dt><dd><p> an optional size parameter passed to <code><a href="ggplot2.html#topic+geom_point">geom_point</a></code> to control the size
of plotted points </p>
</dd>
<dt>lnsize</dt><dd><p> an optional size parameter passed to <code><a href="ggplot2.html#topic+geom_line">geom_line</a></code> to control the size
of plotted lines. </p>
</dd>
</dl>



<h3>Value</h3>

<p>If the <code>control</code> parameter <code>return</code> is set <code>TRUE</code>, a list of <code>ggplot2</code> plots
and tables as described in the Description section above.  If <code>return</code> is set to <code>FALSE</code>
or omitted, the function returns <code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p>Nathaniel R. Twarog
</p>


<h3>References</h3>

<p>Twarog, N.R., Stewart, E., Vowell Hamill, C., and Shelat, A.  BRAID: A Unifying Paradigm for the 
Analysis of Combined Drug Action. <em>Scientific Reports</em> <strong>In Press</strong> (2016).
</p>


<h3>See Also</h3>

<p><code>runBRAIDanalysis</code>, <code><a href="#topic+responseMap">responseMap</a></code>, <code><a href="#topic+potentiationPlot">potentiationPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(es8analysis)
pcont&lt;-list(xtrans=function(x) x*10^6,ytrans=function(y) y*10^6,ztrans=function(z) 10^z,
			xunit=expression(mu*M),yunit=expression(mu*M),zlog=TRUE,abbs=c("Ola","TMZ"),
			levtext=c("90","99"),palette="revgjet",plot=FALSE,return=TRUE)
brep &lt;- makeBRAIDreport(es8analysis,c("Olaparib","Temozolomide"),
			c(-1,-2),c(10^-6,5*10^-5),pcont)
brep[[1]]
brep[[10]]
</code></pre>

<hr>
<h2 id='potentiationPlot'>
Plot Potentiation in a BRAID Fitted Combination
</h2><span id='topic+potentiationPlot'></span>

<h3>Description</h3>

<p>Generates a <code>ggplot2</code> plot object depicting the potentiaton or curve-shift of one compound
by the presence of another, based on BRAID surface fit generated by the 'braidrm' package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>potentiationPlot(bfit, levs, dnum = 1, concs = NULL, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="potentiationPlot_+3A_bfit">bfit</code></td>
<td>
<p> an object of class 'braidrm' representing a BRAID surface fit </p>
</td></tr>
<tr><td><code id="potentiationPlot_+3A_levs">levs</code></td>
<td>
<p> a vector of levels of the &quot;potentiating&quot; drug to be plotted </p>
</td></tr>
<tr><td><code id="potentiationPlot_+3A_dnum">dnum</code></td>
<td>
<p> index of the drug to be plotted on the x-axis (the &quot;potentiated&quot; drug). Default
value 1 </p>
</td></tr>
<tr><td><code id="potentiationPlot_+3A_concs">concs</code></td>
<td>
<p> an optional parameter specifying the concentrations of the &quot;potentiated&quot; drug to be
plotted. If <code>NULL</code> (the default), a length-100 vector of evenly spaced concentrations will be
plotted covering the range of concentrations in all combinations in which both drugs are non-zero. </p>
</td></tr>
<tr><td><code id="potentiationPlot_+3A_control">control</code></td>
<td>
<p> A list of optional control parameters adjusting the appearance of the plot. See
Details for a full description </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is less basic than the response mapping function <code><a href="#topic+responseMap">responseMap</a></code>, and is
intended as a convenience for those who wish to visualize potentiation in a BRAID-fit surface. Many
details of the plot are adjusted by the <code>control</code> parameter, which may contain any or all of
the following elements:
</p>

<dl>
<dt>xlog</dt><dd><p> a boolean variable reflecting whether the concentration plotted on the x-axis (the
&quot;potentiated&quot; drug) should be plotted on a logarithmic scale. Default value is <code>TRUE</code> </p>
</dd>
<dt>ylog</dt><dd><p> a boolean variable reflecting whether the concentration plotted on the x-axis (the
modelled effect) should be plotted on a logarithmic scale. Default value is <code>FALSE</code> </p>
</dd>
<dt>addscales</dt><dd><p> a boolean that controls whether logarithmic scales will be explicitly added to
the resulting plot.  <code>ggplot2</code> prefers that only one scale be added to a given aesthetic, and
throws a warning otherwise, so those who wish to plot the x- or y-variables logarithmically, but
wish to add their own <code>ggplot2</code> scales (to control axis limits, labels, etc.) should set this
parameter to <code>FALSE</code>. Default value is <code>TRUE</code> </p>
</dd>
<dt>xtrans</dt><dd><p> an optional function mapping the concentration of the potentiated drug to the
transformed value that the user wishes to plot.  A simple example would be one in which the fit was
performed on concentrations expressed in molar, but the user wishes to plot the concentrations in
micromolar, in which case the value of 'xtrans' might be <code>function(x) x*10^6</code>. </p>
</dd>
<dt>ytrans</dt><dd><p> an optional function mapping the modelled effect to the transformed value that the
user wishes to plot.  An example might be a case in which the modelled effect variable is a
logarithmic transform of a real-world measurement, and the user wishes to plot the measured value,
in which case the value of 'ytrans' might be <code>function(y) 10^y</code>. </p>
</dd>
<dt>thresh</dt><dd><p> an optional value (or vector of values) of the modeled effect that will be plotted
as a dotted horizontal line. Used to visualize where the shifted dose-response curves cross a
desired threshold or thresholds.  Note that if <code>ytrans</code> is specified, the values in
<code>thresh</code> should be desired thresholds <em>prior</em> to transformation. </p>
</dd>
<dt>ciplot</dt><dd><p> a boolean variable reflecting whether 95% confidence intervals will be plotted
around the potentiated DR curves.  If the 'braidrm' object <code>bfit</code> does not possess valid
confidence intervals, then this parameter automatically is set to <code>FALSE</code>; if it has been
explicitly set to <code>TRUE</code>, a warning will be printed indicating that confidence intervals
cannot be plotted.  Default value is <code>TRUE</code> </p>
</dd>
<dt>cialpha</dt><dd><p> a boolean variable controlling how the confidence intervals are plotted. By
default, confidence intervals are plotted as filled ribbons (using <code><a href="ggplot2.html#topic+geom_ribbon">geom_ribbon</a></code>) with
an alpha (opacity) value of 0.3.  This allows the confidence ranges to overlap, and use the same
color scale as the plotted curves while remaining visually distinguishable.  Unfortunately, some
graphics outputs (including EPS) do not support transparency.  Setting this parameter to FALSE will
plot the confidence intervals with full opacity; the user may distinguish them from the DR curves
by using a different color scale for the 'colour' and 'fill' aesthetics.  Default value is
<code>TRUE</code> </p>
</dd>
<dt>pts</dt><dd><p> a boolean variable determining whether points are plotted along the potentiated DR
curves.  If true, each DR curve will have points plotted at all unique concentrations of the
potentiated drug (in the plotted range) which appeared in any combination in the fitted data in
which both drugs had non-zero concentrations.  Note, however, that this does not plot actual
measured effect, as there no guarantee that the levels of the potentating drug which are plotted
were tested in the original experiment.  Plotting these points simply offers a way to visualize
which concentrations of the potentiated drug were actually measured experimentally.  Default value
is <code>FALSE</code> </p>
</dd>
<dt>ptsize</dt><dd><p> an optional size parameter passed to <code><a href="ggplot2.html#topic+geom_point">geom_point</a></code> to control the size
of plotted points.  If <code>pts</code> is omitted or set to <code>FALSE</code> this parameter is ignored. </p>
</dd>
<dt>pconcs</dt><dd><p> if desired, the user may set this control parameter to explicitly determine which
concentrations of the potentiated drug will be plotted as points.  This is used in
<code><a href="#topic+makeBRAIDreport">makeBRAIDreport</a></code> when concentration corrections have altered the concentrations fed
into the BRAID fitting model. </p>
</dd>
<dt>lnsize</dt><dd><p> an optional size parameter passed to <code><a href="ggplot2.html#topic+geom_line">geom_line</a></code> and, if <code>thresh</code>
is included, <code><a href="ggplot2.html#topic+geom_hline">geom_hline</a></code> to control the size of plotted lines. </p>
</dd>
</dl>

<p>Though this function is intended to much of the heavy lifting in plotting potentiation (especially
as applied to confidence intervals), many choices are left to the user.  Axis labels are not
applied, and scales are not applied to the 'colour' or 'fill' aesthetics.  Users may also, of
use any <code>ggplot2</code> theme functions to further adjust the appearance of the plot.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> plot object, depicting the dose-response curves of the potentiated drug in the
presence of various levels of the potentiating drug.
</p>


<h3>Author(s)</h3>

<p>Nathaniel R. Twarog
</p>


<h3>References</h3>

<p>Twarog, N.R., Stewart, E., Vowell Hamill, C., and Shelat, A.  BRAID: A Unifying Paradigm for the 
Analysis of Combined Drug Action. <em>Scientific Reports</em> <strong>In Press</strong> (2016).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+makeBRAIDreport">makeBRAIDreport</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(es8analysis)
bfit &lt;- es8analysis$braidFit
pcont &lt;- list(xtrans=function(x) x*10^6,ytrans=function(y) 10^y,ylog=TRUE,thresh=-1)
potentiationPlot(bfit,c(0,10^-6,10^-5,10^-4),control=pcont)
</code></pre>

<hr>
<h2 id='responseMap'>
Visualizing Combination Response Maps
</h2><span id='topic+responseMap'></span><span id='topic+responseMap.default'></span><span id='topic+responseMap.formula'></span>

<h3>Description</h3>

<p>Produces a <code>ggplot2</code> plot depicting some response variable as a function of
two input variables; generally this will be some biological effect as a function
of two compound concentrations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
responseMap(model,data,irreg=FALSE,interpolate=TRUE,margins=TRUE,
			logscale=TRUE,zlims=NULL,raster=TRUE)
## S3 method for class 'formula'
responseMap(model,data,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="responseMap_+3A_model">model</code></td>
<td>
<p> a two-column array containing the values of input 1 and input 2 in each data point, or a symbolic formula
(e.g. <code>act ~ conc1+conc2</code>) specifying which variables are to be visualized </p>
</td></tr>
<tr><td><code id="responseMap_+3A_data">data</code></td>
<td>
<p> if <code>model</code> is an array, a vector of values in response to inputs 1 and 2; if <code>model</code> is a formula,
a data frame containing the columns specified in <code>formula</code> </p>
</td></tr>
<tr><td><code id="responseMap_+3A_irreg">irreg</code></td>
<td>
<p> reflects whether or not data points lie in a regularly-spaced grid in the space of data points to be plotted </p>
</td></tr>
<tr><td><code id="responseMap_+3A_interpolate">interpolate</code></td>
<td>
<p> determines whether the plot will produce a smoothed response surface using Gaussian interpolation, or
if the space will be visualized as a set of discrete measurements using nearest neighbor segmentation </p>
</td></tr>
<tr><td><code id="responseMap_+3A_margins">margins</code></td>
<td>
<p> determines whether input pairs in which one of the two inputs is zero will be plotted; applies only
to logarithmically scaled plots </p>
</td></tr>
<tr><td><code id="responseMap_+3A_logscale">logscale</code></td>
<td>
<p> determines whether the input variables will be plotted on a logarithmic scale, or a standard linear scale.
Because this function is intended primarily for visualizing combined action dose-response, a logarithmic dose-pair space is
the default. </p>
</td></tr>
<tr><td><code id="responseMap_+3A_zlims">zlims</code></td>
<td>
<p> an optional parameter specifying lower and upper bounds on the response variable.  If present, all effect
values outside the given range will be clipped to the minimum and maximum values </p>
</td></tr>
<tr><td><code id="responseMap_+3A_raster">raster</code></td>
<td>
<p> by default, interpolated response surfaces will be rendered using the <code>ggplot2</code> function
<code>geom_raster</code>, a faster and optimized raster image version of <code>geom_tile</code>.  In certain settings, however,
<code>geom_raster</code> can produce unusual appearance.  Setting this parameter to FALSE will force the plot to be rendered
using <code>geom_tile</code> </p>
</td></tr>
<tr><td><code id="responseMap_+3A_...">...</code></td>
<td>
<p> not used </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces and returns a <code>ggplot2</code> plot, but does not draw it to a graphics device.  As the strength of
<code>ggplot2</code> is in the ability to annotate, build on, and style plots using additional layers and themes, this function
adds no theme information, and very little scale information.  To produce a more aesthetic plot, it is recommended that
plot be given a custom color scale, axis labels, and theme by using the appropriate <code>ggplot2</code> functions.  For convenience,
the functions <code><a href="#topic+formatResponseMap">formatResponseMap</a></code> and <code><a href="#topic+formatDifferenceMap">formatDifferenceMap</a></code> format and add labels to plots produced
by <code>responseMap</code>, but any <code>ggplot2</code> changes that are desired can be made. If you wish to add additional layers 
(such as contour curves), the data variables available for mapping aesthetics are <code>x</code>, <code>y</code>, and <code>z</code>.
</p>


<h3>Value</h3>

<p> A <code>ggplot2</code> plot object, depicting the response variable (represented by the plot\'s \'fill\' variable) as a function of
two inputs (the x- and y-dimensions). </p>


<h3>Author(s)</h3>

<p>Nathaniel R. Twarog
</p>


<h3>References</h3>

<p>Twarog, N.R., Stewart, E., Vowell Hamill, C., and Shelat, A.  BRAID: A Unifying Paradigm for the 
Analysis of Combined Drug Action. <em>Scientific Reports</em> <strong>In Press</strong> (2016).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+formatResponseMap">formatResponseMap</a></code>, <code><a href="#topic+formatDifferenceMap">formatDifferenceMap</a></code>, <code><a href="#topic+voronoi">voronoi</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(es8olatmz,package="braidrm")
rmap &lt;- responseMap(act~conc1+conc2,es8olatmz)
formatResponseMap(rmap,xl="Olaparib",yl="TMZ",zl="Survival")
rmap &lt;- responseMap(act~conc1+conc2,es8olatmz,interpolate=FALSE,margins=FALSE)
formatDifferenceMap(rmap,zcenter=-1,xl="Olaparib",yl="TMZ",zl="Survival")
</code></pre>

<hr>
<h2 id='voronoi'>
Voronoi segmentation
</h2><span id='topic+voronoi'></span>

<h3>Description</h3>

<p>Calculates the Voronoi (nearest-neighbor) segmentation of a two-dimensional rectangular region
based on a set of points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>voronoi(pts, bbox = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="voronoi_+3A_pts">pts</code></td>
<td>
<p> a two column array of points around which to calculate Voronoi cells </p>
</td></tr>
<tr><td><code id="voronoi_+3A_bbox">bbox</code></td>
<td>
<p> the rectangular bounding box the Voronoi cells must fill, represented by a length
4 vector of the form <code>c(xmin,xmax,ymin,ymax)</code>.  If <code>NULL</code>, a  bounding box will be
constructed containing all points with padding on each side </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Though this function is not strictly necessary to the use of other functions in this package, we
found the construction of a Voronoi segmentation to be a rather tedious task, and felt that making
the function available to those who want a simple segmentation function was a reasonable choice.
</p>


<h3>Value</h3>

<p>A data frame intended for use in the <code>ggplot2</code> function <code><a href="ggplot2.html#topic+geom_polygon">geom_polygon</a></code>.  The data
frame describes one polygon for each given input point, with the 'x' and 'y' columns specifying the
x- and y-coordinates of the vertices of the polygon, and the column 'poly' specifying the index of
the point (in the input array <code>pts</code>) around which the polygon sits.
</p>


<h3>Author(s)</h3>

<p>Nathaniel R. Twarog
</p>


<h3>See Also</h3>

<p><code><a href="#topic+responseMap">responseMap</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
