<!DOCTYPE html><html><head><title>Help for package robmixglm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {robmixglm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AIC'><p>AIC for robmixglm object</p></a></li>
<li><a href='#BIC'><p>BIC for robmixglm object</p></a></li>
<li><a href='#coef'><p>Coefficients for a robmixglm object</p></a></li>
<li><a href='#diabdata'><p>Diabetes data</p></a></li>
<li><a href='#extractAIC'><p>Extract AIC from a Fitted Model</p></a></li>
<li><a href='#fitted.robmixglm'>
<p>Fitted values.</p></a></li>
<li><a href='#hospcosts'><p>Hospital Costs data</p></a></li>
<li><a href='#logLik'><p>log Likelikelihood for robmixglm object</p></a></li>
<li><a href='#outlierProbs'>
<p>Calculate outlier probabilities for each observation.</p></a></li>
<li><a href='#outlierTest'>
<p>Test for the presence of outliers.</p></a></li>
<li><a href='#plot.outlierProbs'>
<p>Plot outlier probabilities.</p></a></li>
<li><a href='#predict.robmixglm'><p>Predict Method for robmixglm</p></a></li>
<li><a href='#print.outlierTest'><p>Print an outlierTest object</p></a></li>
<li><a href='#residuals.robmixglm'><p>Extract Model Residuals</p></a></li>
<li><a href='#robmixglm'><p>Fits a Robust Generalized Linear Model and Variants</p></a></li>
<li><a href='#robmixglm-package'>
<p>Fits random effects meta-analysis models including robust models</p></a></li>
<li><a href='#summary.robmixglm'><p>summaryficients for robmixglm object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Generalized Linear Models (GLM) using Mixtures</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2-3</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-08</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ken Beath &lt;ken@kjbeath.com.au&gt;</td>
</tr>
<tr>
<td>Contact:</td>
<td>Ken Beath &lt;ken@kjbeath.com.au&gt;</td>
</tr>
<tr>
<td>Author:</td>
<td>Ken Beath [aut, cre]</td>
</tr>
<tr>
<td>Description:</td>
<td>Robust generalized linear models (GLM) using a mixture method, as described in Beath (2018) &lt;<a href="https://doi.org/10.1080%2F02664763.2017.1414164">doi:10.1080/02664763.2017.1414164</a>&gt;. This assumes that the data are a mixture of standard observations, being a generalised linear model, and outlier observations from an overdispersed generalized linear model. The overdispersed linear model is obtained by including a normally distributed random effect in the linear predictor of the generalized linear model.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.2.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>R.rsp, robustbase, lattice, forward</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>Imports:</td>
<td>fastGHQuad, stats, bbmle, VGAM, actuar, Rcpp (&ge; 0.12.15),
methods, boot, numDeriv, parallel, doParallel, foreach, doRNG,
MASS</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-09 05:49:03 UTC; kjbeath1</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-09 09:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AIC'>AIC for robmixglm object</h2><span id='topic+AIC.robmixglm'></span>

<h3>Description</h3>

<p>Returns AIC for a robmixglm object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'robmixglm'
AIC(object,  ...,  k  =  2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AIC_+3A_object">object</code></td>
<td>
<p>robmixglm object</p>
</td></tr>
<tr><td><code id="AIC_+3A_...">...</code></td>
<td>
<p> additional argument; currently none is used. </p>
</td></tr>
<tr><td><code id="AIC_+3A_k">k</code></td>
<td>
<p>penalty per parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>AIC
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(MASS)
data(forbes)
forbes.robustmix &lt;- robmixglm(bp~pres, data = forbes, cores = 1)
AIC(forbes.robustmix)

</code></pre>

<hr>
<h2 id='BIC'>BIC for robmixglm object</h2><span id='topic+BIC.robmixglm'></span>

<h3>Description</h3>

<p>Returns BIC for a robmixglm object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'robmixglm'
BIC(object,  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BIC_+3A_object">object</code></td>
<td>
<p>robmixglm object</p>
</td></tr>
<tr><td><code id="BIC_+3A_...">...</code></td>
<td>
<p> additional argument; currently none is used. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>BIC
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(MASS)
data(forbes)
forbes.robustmix &lt;- robmixglm(bp~pres, data = forbes, cores = 1)
BIC(forbes.robustmix)
</code></pre>

<hr>
<h2 id='coef'>Coefficients for a robmixglm object</h2><span id='topic+coef'></span><span id='topic+coef.robmixglm'></span>

<h3>Description</h3>

<p>Returns coefficients for a robmixglm object. Only the coefficients for the linear part of the model are returned. Additional coefficients may be obtained using summary().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'robmixglm'
coef(object,  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef_+3A_object">object</code></td>
<td>
<p>robmixglm object</p>
</td></tr>
<tr><td><code id="coef_+3A_...">...</code></td>
<td>
<p>additional argument; currently none is used. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>coef
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(MASS)
data(forbes)
forbes.robustmix &lt;- robmixglm(bp~pres, data = forbes, cores = 1)
coef(forbes.robustmix)
</code></pre>

<hr>
<h2 id='diabdata'>Diabetes data</h2><span id='topic+diabdata'></span>

<h3>Description</h3>

<p>Data from Heritier et al (2009),  originally from Harrell (2001, p379). This data was from a study of the prevalence of cardiovascular risk factors such as obesity and diabetes for African Americans. (Willems et al,  19997) Data was available for 403 subjects screened for diabetes,  reduced to 372 after removal of cases with missing data.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diabdata</code></pre>


<h3>Format</h3>

<p>A data frame with 372 observations on the following 8 variables.
</p>

<dl>
<dt><code>glyhb</code></dt><dd><p>Glycosated haemoglobin (values above 7.0 are usually taken as a positive diagnosis of diabetes)</p>
</dd>
<dt><code>age</code></dt><dd><p>age in years</p>
</dd>
<dt><code>gender</code></dt><dd><p>male or female</p>
</dd>
<dt><code>bmi</code></dt><dd><p>body mass index in kg/m^2</p>
</dd>
<dt><code>waisthip</code></dt><dd><p>ratio of waist to hip measurement</p>
</dd>
<dt><code>frame</code></dt><dd><p>body frame,  small,  medium or large</p>
</dd>
<dt><code>stab.glu</code></dt><dd><p>glucose</p>
</dd>
<dt><code>location</code></dt><dd><p>location,  Buckingham or Louisa</p>
</dd>
</dl>



<h3>Source</h3>

<p>Heritier et al (2009)
</p>


<h3>References</h3>

<p>Harrell,  F.E. (2001). Regression Modeling Strategies: With Applications to Linear Models,  Logistic Regression and Survival Analysis. Springer.
</p>
<p>Heritier,  S.,  Cantoni,  E.,  Copt,  S. and Victoria-Feser,  M-P (2009). Robust Methods in Biostatistics. Wiley.
</p>
<p>Willems,  J.P.,  Saunders,  J.T.,  Hunt,  D.E. and Schorling,  J.B. (1997) Prevalence of coronary heart disease risk factors among rural blacks: A community-based study. Southern Medical Journal,  90:814-820.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
diabdata.robustmix &lt;- robmixglm(glyhb~age+gender+bmi+waisthip+frame+location, 
         data = diabdata, cores = 1)
summary(diabdata.robustmix)

diabdata.step &lt;- step(diabdata.robustmix, glyhb~age+gender+bmi+waisthip+frame+location, cores = 1)
summary(diabdata.step)
</code></pre>

<hr>
<h2 id='extractAIC'>Extract AIC from a Fitted Model</h2><span id='topic+extractAIC.robmixglm'></span>

<h3>Description</h3>

<p>Computes the (generalized) AIC for a fitted <code>robmixglm</code> model. Used in <code>step</code>,  otherwise use <code>AIC</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'robmixglm'
extractAIC(fit,  scale,  k  =  2,  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractAIC_+3A_fit">fit</code></td>
<td>
<p>fitted <code>robmixglm</code> model.</p>
</td></tr>
<tr><td><code id="extractAIC_+3A_scale">scale</code></td>
<td>
<p>ignored.</p>
</td></tr>
<tr><td><code id="extractAIC_+3A_k">k</code></td>
<td>
<p>numeric specifying the &lsquo;weight&rsquo; of the
<em>equivalent degrees of freedom</em> (<code class="reqn">\equiv</code> <code>edf</code>)
part in the AIC formula.</p>
</td></tr>
<tr><td><code id="extractAIC_+3A_...">...</code></td>
<td>
<p>further arguments (currently unused).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+extractAIC">extractAIC</a></code>, <code><a href="stats.html#topic+step">step</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(MASS)
data(forbes)
forbes.robustmix &lt;- robmixglm(bp~pres, data = MASS::forbes, cores = 1)
extractAIC(forbes.robustmix)
</code></pre>

<hr>
<h2 id='fitted.robmixglm'>
Fitted values.</h2><span id='topic+fitted.robmixglm'></span>

<h3>Description</h3>

<p>Calculates the fitted values.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'robmixglm'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.robmixglm_+3A_object">object</code></td>
<td>

<p>A robmixglm object with a mixture (robust) random effects distribution.</p>
</td></tr>
<tr><td><code id="fitted.robmixglm_+3A_...">...</code></td>
<td>
<p>Other parameters. (not used)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the fitted values.
</p>


<h3>Author(s)</h3>

<p>Ken Beath &lt;ken.beath@mq.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(MASS)
data(forbes)
forbes.robustmix &lt;- robmixglm(bp~pres, data = forbes, cores = 1)
BIC(forbes.robustmix)
plot(fitted(forbes.robustmix), residuals(forbes.robustmix))
</code></pre>

<hr>
<h2 id='hospcosts'>Hospital Costs data</h2><span id='topic+hospcosts'></span>

<h3>Description</h3>

<p>Data for the analysis in Beath (2018),  previously analysed in Marazzi and Yohai (2004),  Cantoni and Ronchetti (2006) and Heritier et al (2009). The data is for 100 patients hospitalised at the Centre Hospitalier Universitaire Vaudois in Lausanne,  Switzerland for &quot;medical back problems&quot; (APDRG 243).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hospcosts</code></pre>


<h3>Format</h3>

<p>A data frame with 100 observations on the following 9 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>patient id</p>
</dd>
<dt><code>costs</code></dt><dd><p>cost of stay in Swiss francs</p>
</dd>
<dt><code>los</code></dt><dd><p>length of stay in days</p>
</dd>
<dt><code>adm</code></dt><dd><p>admission type,  0 = planned,  1 = emergency</p>
</dd>
<dt><code>ins</code></dt><dd><p>insurance type,  0 = regular,  1 = private</p>
</dd>
<dt><code>age</code></dt><dd><p>age in years</p>
</dd>
<dt><code>sex</code></dt><dd><p>sex,  0 = female,  1 = male</p>
</dd>
<dt><code>dest</code></dt><dd><p>discharge destination,  0 = another health institution,  1 = home</p>
</dd>
<dt><code>loglos</code></dt><dd><p>log of length of stay</p>
</dd>
</dl>



<h3>Source</h3>

<p>Heritier et al (2009)
</p>


<h3>References</h3>

<p>Cantoni,  E.,  &amp; Ronchetti,  E. (2006). A robust approach for skewed and heavy-tailed outcomes in the analysis of health care expenditures. Journal of Health Economics,  25(2),  198213. http://doi.org/10.1016/j.jhealeco.2005.04.010
</p>
<p>Heritier,  S.,  Cantoni,  E.,  Copt,  S. and Victoria-Feser,  M-P (2009). Robust Methods in Biostatistics. Wiley.
</p>
<p>Marazzi,  A.,  &amp; Yohai,  V. J. (2004). Adaptively truncated maximum likelihood regression with asymmetric errors. Journal of Statistical Planning and Inference,  122(12),  271291. http://doi.org/10.1016/j.jspi.2003.06.011
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
hospcosts.robustmix &lt;- robmixglm(costs~adm+age+dest+ins+loglos+sex, family = "gamma", 
    data = hospcosts, cores = 1)
summary(hospcosts.robustmix)
</code></pre>

<hr>
<h2 id='logLik'>log Likelikelihood for robmixglm object</h2><span id='topic+logLik.robmixglm'></span>

<h3>Description</h3>

<p>Returns log Likelihood for a robmixglm object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'robmixglm'
logLik(object,  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik_+3A_object">object</code></td>
<td>
<p>robmixglm object</p>
</td></tr>
<tr><td><code id="logLik_+3A_...">...</code></td>
<td>
<p> additional argument; currently none is used. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>The loglikelihood.
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(MASS)
data(forbes)
forbes.robustmix &lt;- robmixglm(bp~pres, data = forbes, cores = 1)
logLik(forbes.robustmix)
</code></pre>

<hr>
<h2 id='outlierProbs'>
Calculate outlier probabilities for each observation.</h2><span id='topic+outlierProbs'></span><span id='topic+outlierProbs.robmixglm'></span>

<h3>Description</h3>

<p>For the normal mixture random effect calculates the probability that each observation is an outlier based on the posterior probability of it being an outlier.</p>


<h3>Usage</h3>

<pre><code class='language-R'>outlierProbs(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outlierProbs_+3A_object">object</code></td>
<td>

<p>A metaplus object with a mixture (robust) random effects distribution.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outlier probabilities are obtained as the posterior probabilities of each observation being an outlier based on the fitted mixture model.
</p>


<h3>Value</h3>

<table>
<tr><td><code>outlier.prob</code></td>
<td>
<p>Posterior probability that each observation is an outlier</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ken Beath &lt;ken.beath@mq.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(MASS)
data(forbes)
forbes.robustmix &lt;- robmixglm(bp~pres, data = forbes, cores = 1)
outlierProbs(forbes.robustmix)
</code></pre>

<hr>
<h2 id='outlierTest'>
Test for the presence of outliers.</h2><span id='topic+outlierTest'></span><span id='topic+outlierTest.robmixglm'></span>

<h3>Description</h3>

<p>Uses the parametric bootstrap to test for the presence of outliers.</p>


<h3>Usage</h3>

<pre><code class='language-R'>outlierTest(object,  R = 999,  cores  =  max(detectCores() %/% 2,  1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outlierTest_+3A_object">object</code></td>
<td>

<p>A robmixglm object with a mixture (robust) random effects distribution.
</p>
</td></tr>
<tr><td><code id="outlierTest_+3A_r">R</code></td>
<td>
<p>number of bootstrap replications</p>
</td></tr>
<tr><td><code id="outlierTest_+3A_cores">cores</code></td>
<td>
<p>Number of cores to be used in parallel. Default is one less than available.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Performs a parametric bootstrap to compare models with and without outliers.
</p>


<h3>Value</h3>

<p>An outlierTest object which is the object of class &ldquo;boot&rdquo; returned by the call to <code>boot</code>.
</p>


<h3>Author(s)</h3>

<p>Ken Beath &lt;ken.beath@mq.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
hospcosts.robustmix &lt;- robmixglm(costs~adm+age+dest+ins+loglos+sex, family = "gamma", 
    data = hospcosts, cores = 1)
summary(hospcosts.robustmix)
summary(outlierTest(hospcosts.robustmix,  cores  =  1))
</code></pre>

<hr>
<h2 id='plot.outlierProbs'>
Plot outlier probabilities.
</h2><span id='topic+plot.outlierProbs'></span>

<h3>Description</h3>

<p>Plots the outlier probability for each observation,  from an outlierProbs object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'outlierProbs'
plot(x,  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.outlierProbs_+3A_x">x</code></td>
<td>

<p>outlierProbs object to be plotted
</p>
</td></tr>
<tr><td><code id="plot.outlierProbs_+3A_...">...</code></td>
<td>

<p>additional parameters to plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot
</p>


<h3>Author(s)</h3>

<p>Ken Beath &lt;ken.beath@mq.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(MASS)
data(forbes)
forbes.robustmix &lt;- robmixglm(bp~pres, data = forbes, cores = 1)
plot(outlierProbs(forbes.robustmix))
</code></pre>

<hr>
<h2 id='predict.robmixglm'>Predict Method for robmixglm</h2><span id='topic+predict.robmixglm'></span>

<h3>Description</h3>

<p>Obtains predictions from a fitted robust mixture generalized linear model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'robmixglm'
predict(object,  newdata  =  NULL, 
            type  =  c("link",  "response"),  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.robmixglm_+3A_object">object</code></td>
<td>
<p>a fitted object of class inheriting from <code>robmixglm</code>.</p>
</td></tr>
<tr><td><code id="predict.robmixglm_+3A_newdata">newdata</code></td>
<td>
<p>optionally,  a data frame in which to look for variables with
which to predict.  If omitted,  the fitted linear predictors are used.</p>
</td></tr>
<tr><td><code id="predict.robmixglm_+3A_type">type</code></td>
<td>
<p>the type of prediction required.  The default <code>link</code> is on the
scale of the linear predictors,  while the alternative <code>response</code>
is on the scale of the response variable.</p>
</td></tr>  
<tr><td><code id="predict.robmixglm_+3A_...">...</code></td>
<td>
<p>Other parameters. (not used)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>newdata</code> is omitted the predictions are based on the data
used for the fit.  In that case how cases with missing values in the
original fit is determined by the <code>na.action</code> argument of that
fit.  If <code>na.action  =  na.omit</code> omitted cases will not appear in
the residuals,  whereas if <code>na.action  =  na.exclude</code> they will
appear (in predictions and standard errors),  with residual value
<code>NA</code>.  See also <code><a href="stats.html#topic+napredict">napredict</a></code>.
</p>


<h3>Value</h3>

<p>A vector predicted linear predictors or response. For <code>binomial</code> the
resonse is the predicted proportion.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(MASS)
data(forbes)
forbes.robustmix &lt;- robmixglm(100*log10(pres)~bp, data = forbes, cores = 1)
plot(forbes$bp, forbes$pres)
preddata &lt;- data.frame(bp = seq(from  =  min(forbes$bp), to  =  max(forbes$bp),  by  =  0.01))
# convert to original scale
preddata$predpres &lt;-10^(predict(forbes.robustmix, newdata = preddata)/100)
lines(preddata$bp, preddata$predpres, col = "red")
</code></pre>

<hr>
<h2 id='print.outlierTest'>Print an outlierTest object</h2><span id='topic+print.outlierTest'></span><span id='topic+summary.outlierTest'></span><span id='topic+print.summary.outlierTest'></span>

<h3>Description</h3>

<p>Print an outlierTest object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'outlierTest'
print(x,  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.outlierTest_+3A_x">x</code></td>
<td>
<p>outlierTest object</p>
</td></tr>
<tr><td><code id="print.outlierTest_+3A_...">...</code></td>
<td>
<p>further arguments (not currently used)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(MASS)
data(forbes)
forbes.robustmix &lt;- robmixglm(bp~pres, data = forbes, cores = 1)
summary(forbes.robustmix)
print(outlierTest(forbes.robustmix,  cores  =  1))

</code></pre>

<hr>
<h2 id='residuals.robmixglm'>Extract Model Residuals</h2><span id='topic+residuals.robmixglm'></span>

<h3>Description</h3>

<p>Extracts model residuals from objects returned by modeling functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'robmixglm'
residuals(object,  type  =  c("deviance",  "pearson"),  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.robmixglm_+3A_object">object</code></td>
<td>
<p>an object for which the extraction of model residuals is
meaningful.</p>
</td></tr>
<tr><td><code id="residuals.robmixglm_+3A_type">type</code></td>
<td>
<p>Type of residual where valid types are deviance and pearson.</p>
</td></tr>
<tr><td><code id="residuals.robmixglm_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Residuals extracted from the object <code>object</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(MASS)
data(forbes)
forbes.robustmix &lt;- robmixglm(bp~pres, data = forbes, cores = 1)
BIC(forbes.robustmix)
plot(fitted(forbes.robustmix), residuals(forbes.robustmix))
</code></pre>

<hr>
<h2 id='robmixglm'>Fits a Robust Generalized Linear Model and Variants</h2><span id='topic+robmixglm'></span>

<h3>Description</h3>

<p>Fits robust generalized linear models and variants described in Beath (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>robmixglm(formula, family = c("gaussian", "binomial", "poisson", 
"gamma", "truncpoisson", "nbinom"), data, offset = NULL, 
quadpoints = 21, notrials = 50, EMTol = 1.0e-4, cores  =  max(detectCores() %/% 2,  1), 
verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="robmixglm_+3A_formula">formula</code></td>
<td>
<p>Model formula</p>
</td></tr>
<tr><td><code id="robmixglm_+3A_family">family</code></td>
<td>
<p>Distribution of response</p>
</td></tr>
<tr><td><code id="robmixglm_+3A_data">data</code></td>
<td>
<p>Data frame from which variables are obtained</p>
</td></tr>
<tr><td><code id="robmixglm_+3A_offset">offset</code></td>
<td>
<p>Offset to be incorporated in the linear predictor.</p>
</td></tr>
<tr><td><code id="robmixglm_+3A_quadpoints">quadpoints</code></td>
<td>
<p>Number of quadrature points used in the Gauss-Hermite integration.</p>
</td></tr>
<tr><td><code id="robmixglm_+3A_notrials">notrials</code></td>
<td>
<p>Number of random starting values to be used for EM</p>
</td></tr>
<tr><td><code id="robmixglm_+3A_emtol">EMTol</code></td>
<td>
<p>Relative change in likelihood for completion of EM algorithm before switching to quasi-Newton</p>
</td></tr>
<tr><td><code id="robmixglm_+3A_cores">cores</code></td>
<td>
<p>Number of cores to be used for parallel evaluation of starting values</p>
</td></tr>
<tr><td><code id="robmixglm_+3A_verbose">verbose</code></td>
<td>
<p>Print out diagnostic information? This includes the likelihood and parameter estimates for each EM run.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fits robust generalized models assuming that data is a mixture of standard observations and outlier abservations, which belong to an overdispersed model (Beath, 2018). For binomial, Poisson, truncated Poisson and gamma, the overdispersed component achieved through including a random effect as part of the linear predictor, as described by Aitkin (1996).  For gaussian and negative binomial data the outlier component is also a gaussian and negative binomial model, respectively but with a higher dispersion. For gaussian this corresponds to a higher value of <code class="reqn">\sigma^2</code> but for negative binomial this is a lower value of <code class="reqn">\theta</code>.
</p>
<p>The method used is a generalised EM. Random starting values are determined by randomly allocating observations to either the standard or outlier class for the first iteration of the EM. The EM is then run to completion for all sets of starting values. The best set of starting values is then used to obtain the final results using a quasi-Newton method. Where the overdispersed data is obtained using a random effect, the likelihood is obtained by integrating out the random effect using Gauss-Hermite quadrature.
</p>


<h3>Value</h3>

<p>robmixglm object. This contains
</p>
<table>
<tr><td><code>fit</code></td>
<td>
<p>Final model fit from quasi-Newton</p>
</td></tr>
<tr><td><code>prop</code></td>
<td>
<p>Posterior probability of observation in each class</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p>final log likelihood</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>Number of parameters</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>Number of observations</p>
</td></tr>
<tr><td><code>coef.names</code></td>
<td>
<p>Coefficient names</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>Call to function</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>Family of model to be fitted</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>model</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>terms</p>
</td></tr>
<tr><td><code>xlevels</code></td>
<td>
<p>Levels for factors.</p>
</td></tr>
<tr><td><code>quadpoints</code></td>
<td>
<p>Number of quadrature points used in the Gauss-Hermite integration.</p>
</td></tr>
<tr><td><code>notrials</code></td>
<td>
<p>Number of random starting values to be used for EM</p>
</td></tr>
<tr><td><code>EMTol</code></td>
<td>
<p>Relative change in likelihood for completion of EM algorithm before switching to quasi-Newton</p>
</td></tr>
<tr><td><code>verbose</code></td>
<td>
<p>Was verbose output requested?</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>References</h3>

<p>Beath, K. J. A mixture-based approach to robust analysis of generalised linear models,  Journal of Applied Statistics, 45(12), 2256-2268 (2018) DOI: 10.1080/02664763.2017.1414164
</p>
<p>Aitkin, M. (1996). A general maximum likelihood analysis of overdispersion in generalized linear models. Statistics and Computing, 6, 251262. DOI: 10.1007/BF00140869</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (requireNamespace("MASS", quietly = TRUE)) {
library(MASS)
data(forbes)
forbes.robustmix &lt;- robmixglm(100*log10(pres)~bp, data = forbes, cores = 1)
}
</code></pre>

<hr>
<h2 id='robmixglm-package'>
Fits random effects meta-analysis models including robust models
</h2><span id='topic+robmixglm-package'></span>

<h3>Description</h3>

<p>Robust generalized linear models (GLM) using a mixture method,  as described in Beath (2018) &lt;doi:10.1080/02664763.2017.1414164&gt;.
</p>


<h3>The robmixglm function</h3>

<p>This is the main function that allows fitting the models. The robmixglm objects may be tested for outliers using outlierTest. The results of test.outliers may also be plotted.
</p>


<h3>Author(s)</h3>

<p>Ken Beath &lt;ken.beath@mq.edu.au&gt;
</p>


<h3>References</h3>

<p>Beath,  K. J. A mixture-based approach to robust analysis of generalised linear models,  Journal of Applied Statistics,  45(12),  2256-2268 (2018) DOI: 10.1080/02664763.2017.1414164</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# for the following cores is set to 1 to satisfy the CRAN testing requirements
# removing will reduce the time taken depending on number of cores available
# animal brain vs body weight
library(MASS)
data(Animals)
Animals$logbrain &lt;- log(Animals$brain)
Animals$logbody &lt;- log(Animals$body)
lm1 &lt;- lm(logbrain~logbody, data = Animals)
lm2 &lt;- robmixglm(logbrain~logbody, data = Animals, cores = 1)
plot(Animals$logbody, Animals$logbrain)
abline(lm1, col = "red")
abline(lm2, col = "green")
plot(outlierProbs(lm2))
outlierTest(lm2, cores  =  1)

# Forbes data on relationship between atmospheric pressure and boiling point of water
library(MASS)
data(forbes)
forbes.robustmix &lt;- robmixglm(100*log10(pres)~bp, data = MASS::forbes, cores = 1)
summary(forbes.robustmix)
plot(outlierProbs(forbes.robustmix))
outlierTest(forbes.robustmix, cores  =  1)

# diabetes
diabdata.robustmix &lt;- robmixglm(glyhb~age+gender+bmi+waisthip+frame, 
    data = diabdata, cores = 1)
summary(diabdata.robustmix)
# this will take about 5-10 minutes
diabdata.step &lt;- step(diabdata.robustmix, glyhb~age+gender+bmi+waisthip+frame)
summary(diabdata.step)
plot(outlierProbs(diabdata.step))
outlierTest(diabdata.step, cores  =  1)

# Hawkins' data
library(forward)
data(hawkins)
hawkins.robustmix &lt;- robmixglm(y~x1+x2+x3+x4+x5+x6+x7+x8,
    cores = 1, data=hawkins)
summary(hawkins.robustmix)
plot(outlierProbs(hawkins.robustmix))
outlierTest(hawkins.robustmix, cores = 1)

# carrot damage
library(robustbase)
data(carrots)
carrots.robustmix &lt;- robmixglm(cbind(success, total-success)~logdose+factor(block), 
     family = "binomial", data = carrots, cores = 1)
summary(carrots.robustmix)
plot(outlierProbs(carrots.robustmix))
outlierTest(carrots.robustmix, cores  =  1)

# train derailment
library(forward)
data(derailme)
derailme$cYear &lt;- derailme$Year-mean(derailme$Year)
derailme$TrainKm100 &lt;- derailme$TrainKm*100.0
derailme.robustmix &lt;- robmixglm(y~cYear+factor(Type), offset = log(TrainKm100),
    family = "truncpoisson", quadpoints = 51,  data = derailme, cores = 1)
summary(derailme.robustmix)
plot(outlierProbs(derailme.robustmix))
outlierTest(derailme.robustmix, cores  =  1)
       
# hospital costs
hospcosts.robustmix &lt;- robmixglm(costs~adm+age+dest+ins+loglos+sex, family = "gamma", 
    data = hospcosts, cores = 1)
summary(hospcosts.robustmix)
plot(outlierProbs(hospcosts.robustmix))
outlierTest(hospcosts.robustmix, cores  =  1)

</code></pre>

<hr>
<h2 id='summary.robmixglm'>summaryficients for robmixglm object</h2><span id='topic+summary.robmixglm'></span>

<h3>Description</h3>

<p>Returns summary for a robmixglm object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'robmixglm'
summary(object,  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.robmixglm_+3A_object">object</code></td>
<td>
<p>robmixglm object</p>
</td></tr>
<tr><td><code id="summary.robmixglm_+3A_...">...</code></td>
<td>
<p> additional argument; currently none is used. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>summary
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(MASS)
data(forbes)
forbes.robustmix &lt;- robmixglm(bp~pres, data = forbes, cores = 1)
summary(forbes.robustmix)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
