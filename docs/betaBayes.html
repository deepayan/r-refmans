<!DOCTYPE html><html lang="en"><head><title>Help for package betaBayes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {betaBayes}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#beta4reg'><p>Bayesian Beta Regression Models</p></a></li>
<li><a href='#covid'><p>COVID-19 County Level Data</p></a></li>
<li><a href='#cox.snell.beta4reg'><p>Cox-Snell Diagnostic Plot</p></a></li>
<li><a href='#predict.beta4reg'><p>Predict method for beta4 model fits</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Beta Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-08</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a class of Bayesian beta regression models for the analysis of continuous data with support restricted to an unknown finite support. The response variable is modeled using a four-parameter beta distribution with the mean or mode parameter depending linearly on covariates through a link function. When the response support is known to be (0,1), the above class of models reduce to traditional (0,1) supported beta regression models. Model choice is carried out via the logarithm of the pseudo marginal likelihood (LPML), the deviance information criterion (DIC), and the Watanabe-Akaike information criterion (WAIC). See Zhou and Huang (2022) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2021.107345">doi:10.1016/j.csda.2021.107345</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.1), methods, betareg</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo (&ge; 0.4.300.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-08 23:39:00 UTC; Haiming</td>
</tr>
<tr>
<td>Author:</td>
<td>Haiming Zhou [aut, cre, cph],
  Xianzheng Huang [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Haiming Zhou &lt;haiming2019@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-09 12:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='beta4reg'>Bayesian Beta Regression Models</h2><span id='topic+beta4reg'></span><span id='topic+print.beta4reg'></span><span id='topic+summary.beta4reg'></span><span id='topic+print.summary.beta4reg'></span>

<h3>Description</h3>

<p>This function fits Bayesian beta regression models. The response distribution can be either the beta with the support on (0,1)  or the four-parameter beta with an unknown final support. The logarithm of the pseudo marginal likelihood (LPML), the deviance information criterion (DIC), and the Watanabe-Akaike information criterion (WAIC) are provided for model comparison.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beta4reg(formula, data, na.action, link="logit", model = "mode",
         mcmc=list(nburn=3000, nsave=2000, nskip=0, ndisplay=500),
         prior=NULL, start=NULL, Xpred=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="beta4reg_+3A_formula">formula</code></td>
<td>
<p>a formula expression of the form <code>y ~ x</code>.</p>
</td></tr>
<tr><td><code id="beta4reg_+3A_data">data</code></td>
<td>
<p>a data frame in which to interpret the variables named in the <code>formula</code> argument.</p>
</td></tr>
<tr><td><code id="beta4reg_+3A_na.action">na.action</code></td>
<td>
<p>a missing-data filter function, applied to the <code>model.frame</code>.</p>
</td></tr>
<tr><td><code id="beta4reg_+3A_link">link</code></td>
<td>
<p>a character string for the link function. Choices include <code>"logit"</code>, <code>"probit"</code>, <code>"loglog"</code> and <code>"cloglog"</code>.</p>
</td></tr>
<tr><td><code id="beta4reg_+3A_model">model</code></td>
<td>
<p>a character string for the regression type. The options include <code>"mean"</code> for a mean regression, <code>"mode"</code> for a mode regression.</p>
</td></tr>
<tr><td><code id="beta4reg_+3A_mcmc">mcmc</code></td>
<td>
<p>a list giving the MCMC parameters. The list must include the following elements: <code>nburn</code> an integer giving the number of burn-in scans, <code>nskip</code> an integer giving the thinning interval, <code>nsave</code> an integer giving the total number of scans to be saved, <code>ndisplay</code> an integer giving the number of saved scans to be displayed on screen (the function reports on the screen when every <code>ndisplay</code> iterations have been carried out).</p>
</td></tr>
<tr><td><code id="beta4reg_+3A_prior">prior</code></td>
<td>
<p>a list giving the prior information. The function itself provides all default priors. The following components can be specified here: <code>ma0</code> and <code>mb0</code> for the prior of marginal population mode or mean, <code>phia0</code> and <code>phib0</code> for the precision parameter, <code>beta0</code> and <code>S0</code> for the coefficients beta, <code>th1a0</code> and <code>th1b0</code> for the lower bound of the support, <code>th2a0</code> and <code>th2b0</code> for the upper bound of the support.</p>
</td></tr>
<tr><td><code id="beta4reg_+3A_start">start</code></td>
<td>
<p>a list giving the starting values of the parameters. The function itself provides all default choices. The following components can be specified here: <code>beta</code>, <code>theta</code>, <code>phi</code>. </p>
</td></tr> 
<tr><td><code id="beta4reg_+3A_xpred">Xpred</code></td>
<td>
<p>A new design matrix at which estimates of the response model or mean are required. The default is the design matrix returned by the argument <code>formula</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This class of objects is returned by the <code>beta4reg</code> function to represent a fitted Bayesian beta regression model. Objects of this class have methods for the functions <code>print</code> and <code>summary</code>.
</p>
<p>The <code>beta4reg</code> object is a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>modelname</code></td>
<td>

<p>the name of the fitted model
</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>

<p>the <code><a href="stats.html#topic+terms">terms</a></code> object used
</p>
</td></tr>
<tr><td><code>link</code></td>
<td>

<p>the link function used 
</p>
</td></tr>
<tr><td><code>model</code></td>
<td>

<p>the model fitted: mean or mode
</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>

<p>a named vector of coefficients. The last two elements are the estimates of theta1 and theta2 involved in the support of the four-parameter beta distribution. 
</p>
</td></tr>
<tr><td><code>call</code></td>
<td>

<p>the matched call
</p>
</td></tr>
<tr><td><code>prior</code></td>
<td>

<p>the list of hyperparameters used in all priors. 
</p>
</td></tr>
<tr><td><code>start</code></td>
<td>

<p>the list of starting values used for all parameters. 
</p>
</td></tr>
<tr><td><code>mcmc</code></td>
<td>

<p>the list of MCMC parameters used 
</p>
</td></tr>
<tr><td><code>n</code></td>
<td>

<p>the number of row observations used in fitting the model
</p>
</td></tr>
<tr><td><code>p</code></td>
<td>

<p>the number of columns in the model matrix
</p>
</td></tr>
<tr><td><code>y</code></td>
<td>

<p>the response observations
</p>
</td></tr>
<tr><td><code>X</code></td>
<td>

<p>the n by (p+1) orginal design matrix
</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>

<p>the (p+1) by nsave matrix of posterior samples for the coefficients in the <code>linear.predictors</code>
</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>

<p>the 2 by nsave matrix of posterior samples for theta1 and theta2 involved in the support.
</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>

<p>the vector of posterior samples for the precision parameter. 
</p>
</td></tr>
<tr><td><code>cpo</code></td>
<td>

<p>the length n vector of the stabilized estiamte of CPO; used for calculating LPML
</p>
</td></tr>
<tr><td><code>pD</code></td>
<td>

<p>the effective number of parameters involved in DIC
</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>

<p>the deviance information criterion (DIC)
</p>
</td></tr>
<tr><td><code>pW</code></td>
<td>

<p>the effective number of parameters involved in WAIC
</p>
</td></tr>
<tr><td><code>WAIC</code></td>
<td>

<p>the Watanabe-Akaike information criterion (WAIC)
</p>
</td></tr>
<tr><td><code>ratetheta</code></td>
<td>

<p>the acceptance rate in the posterior sampling of theta vector involved in the support
</p>
</td></tr>
<tr><td><code>ratebeta</code></td>
<td>

<p>the acceptance rate in the posterior sampling of beta coefficient vector
</p>
</td></tr>
<tr><td><code>ratephi</code></td>
<td>

<p>the acceptance rate in the posterior sampling of precision parameter
</p>
</td></tr>
</table>
<p>The use of the <code>summary</code> function to the object will return new object with the following additional components:
</p>
<table role = "presentation">
<tr><td><code>coeff</code></td>
<td>

<p>A table that presents the posterior summaries for the regression coefficients
</p>
</td></tr>
<tr><td><code>bounds</code></td>
<td>

<p>A table that presents the posterior summaries for the support boundaries theta1 and theta2
</p>
</td></tr>
<tr><td><code>phivar</code></td>
<td>

<p>A table that presents the posterior summaries for the precision phi.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Haiming Zhou and Xianzheng Huang
</p>


<h3>References</h3>

<p>Zhou, H. and Huang, X. (2022). Bayesian beta regression for bounded responses with unknown supports. <em>Computational Statistics &amp; Data Analysis</em>, 167, 107345.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cox.snell.beta4reg">cox.snell.beta4reg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(betaBayes)
library(betareg)

## Data from Ferrari and Cribari-Neto (2004)
data("GasolineYield", package = "betareg")
data("FoodExpenditure", package = "betareg")

## four-parameter beta mean regression
mcmc=list(nburn=2000, nsave=1000, nskip=4, ndisplay=1000);
# Note larger nburn, nsave and nskip should be used in practice.
prior = list(th1a0 = 0, th2b0 = 1) 
# here the natural bound (0,1) is used to specify the prior
# GasolineYield
set.seed(100)
gy_res1 &lt;- beta4reg(yield ~ batch + temp, data = GasolineYield, 
                link = "logit", model = "mean",
                mcmc = mcmc, prior = prior)
(gy_sfit1 &lt;- summary(gy_res1))
cox.snell.beta4reg(gy_res1) # Cox-Snell plot
# FoodExpenditure
set.seed(100)
fe_res1 &lt;- beta4reg(I(food/income) ~ income + persons, data = FoodExpenditure, 
                link = "logit", model = "mean",
                mcmc = mcmc, prior = prior)
(fe_sfit1 &lt;- summary(fe_res1))
cox.snell.beta4reg(fe_res1) # Cox-Snell plot

## two-parameter beta mean regression with support (0,1)
mcmc=list(nburn=2000, nsave=1000, nskip=4, ndisplay=1000);
# Note larger nburn, nsave and nskip should be used in practice.
prior = list(th1a0 = 0, th1b0 = 0, th2a0 = 1, th2b0 = 1)
# this setting forces the support to be (0,1)
# GasolineYield
set.seed(100)
gy_res2 &lt;- beta4reg(yield ~ batch + temp, data = GasolineYield, 
                link = "logit", model = "mean",
                mcmc = mcmc, prior = prior)
(gy_sfit2 &lt;- summary(gy_res2))
cox.snell.beta4reg(gy_res2) # Cox-Snell plot
# FoodExpenditure
set.seed(100)
fe_res2 &lt;- beta4reg(I(food/income) ~ income + persons, data = FoodExpenditure, 
                link = "logit", model = "mean",
                mcmc = mcmc, prior = prior)
(fe_sfit2 &lt;- summary(fe_res2))
cox.snell.beta4reg(fe_res2) # Cox-Snell plot

</code></pre>

<hr>
<h2 id='covid'>COVID-19 County Level Data</h2><span id='topic+covid'></span>

<h3>Description</h3>

<p>A county level COVID-19 dataset in US. It is of interest to examine the association between several county-level characteristics and the cumulative numbers of confirmed cases and deaths. County-level characteristics are based on the 2018 ACS 5-year estimates. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(covid)</code></pre>


<h3>Format</h3>


<table>
<tr>
 <td style="text-align: left;">
    FIPS:</td><td style="text-align: left;"> FIPS county code</td>
</tr>
<tr>
 <td style="text-align: left;">
    PopE:</td><td style="text-align: left;"> total population </td>
</tr>
<tr>
 <td style="text-align: left;">
    MaleP: </td><td style="text-align: left;"> percentage of people who are male </td>
</tr>
<tr>
 <td style="text-align: left;">
    WhiteP: </td><td style="text-align: left;"> percentage of people who are white </td>
</tr>
<tr>
 <td style="text-align: left;">
    BlackP:</td><td style="text-align: left;"> percentage of people who are black or African American</td>
</tr>
<tr>
 <td style="text-align: left;">
    Age65plusP:</td><td style="text-align: left;">  percentage of people who are 65 years and over</td>
</tr>
<tr>
 <td style="text-align: left;">
    PovertyP:</td><td style="text-align: left;"> percentage of people whose income in the past 12 months is below poverty </td>
</tr>
<tr>
 <td style="text-align: left;">
    RUCC_2013:</td><td style="text-align: left;"> 2013 Rural Urban Continuum Code, with a higher value indicating a more rural county</td>
</tr>
<tr>
 <td style="text-align: left;">
    State:</td><td style="text-align: left;"> two-letter state abbreviation code </td>
</tr>
<tr>
 <td style="text-align: left;">
    deaths: </td><td style="text-align: left;"> cumulative number of deaths as of October 13, 2020 </td>
</tr>
<tr>
 <td style="text-align: left;">
    cases: </td><td style="text-align: left;"> cumulative number of confirmed cases as of October 13, 2020 </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>data(covid)
head(covid)
</code></pre>

<hr>
<h2 id='cox.snell.beta4reg'>Cox-Snell Diagnostic Plot</h2><span id='topic+cox.snell.beta4reg'></span>

<h3>Description</h3>

<p>This function provides the Cox-Snell diagnostic plot for fitting  for Bayesian beta regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cox.snell.beta4reg(x, ncurves = 10, CI = 0.95, PLOT = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cox.snell.beta4reg_+3A_x">x</code></td>
<td>
<p>an object obtained from the function <code><a href="#topic+beta4reg">beta4reg</a></code>.</p>
</td></tr>
<tr><td><code id="cox.snell.beta4reg_+3A_ncurves">ncurves</code></td>
<td>
<p>the number of posterior draws.</p>
</td></tr>
<tr><td><code id="cox.snell.beta4reg_+3A_ci">CI</code></td>
<td>
<p>the level of confidence for point-wise credible intervals.</p>
</td></tr>
<tr><td><code id="cox.snell.beta4reg_+3A_plot">PLOT</code></td>
<td>
<p>a logical value indicating whether the Cox-Snell residuals will be plotted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns the plot (if <code>PLOT = TRUE</code>) and a list with the following components:
</p>
<table role = "presentation">
<tr><td><code>tgrid</code></td>
<td>

<p>the x-axis values with length, say <code>ngrid</code>
</p>
</td></tr>
<tr><td><code>Hhat</code></td>
<td>

<p>the <code>ngrid</code> by 1 averaged cumulative hazard values across the <code>nsave</code> posterior samples
</p>
</td></tr>
<tr><td><code>Hhatlow</code></td>
<td>

<p>the <code>ngrid</code> by 1 lower bound cumulative hazard values 
</p>
</td></tr>
<tr><td><code>Hhatup</code></td>
<td>

<p>the <code>ngrid</code> by 1 upper bound cumulative hazard values 
</p>
</td></tr>
<tr><td><code>H</code></td>
<td>

<p>the <code>ngrid</code> by <code>nsave</code> cumulative hazard values 
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Haiming Zhou and Xianzheng Huang
</p>


<h3>See Also</h3>

<p><code><a href="#topic+beta4reg">beta4reg</a></code> 
</p>

<hr>
<h2 id='predict.beta4reg'>Predict method for beta4 model fits</h2><span id='topic+predict.beta4reg'></span>

<h3>Description</h3>

<p>Posterior predicted response values based on beta4 model object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'beta4reg'
predict(object, newx, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.beta4reg_+3A_object">object</code></td>
<td>
<p>an object obtained from the function <code><a href="#topic+beta4reg">beta4reg</a></code>.</p>
</td></tr>
<tr><td><code id="predict.beta4reg_+3A_newx">newx</code></td>
<td>
<p>an m by p matrix at which predictions are required. If not specified, the original design matrix will be used.</p>
</td></tr>
<tr><td><code id="predict.beta4reg_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns an m by nsave matrix of posterior samples for response predictions at newx. 
</p>


<h3>Author(s)</h3>

<p>Haiming Zhou and Xianzheng Huang
</p>


<h3>See Also</h3>

<p><code><a href="#topic+beta4reg">beta4reg</a></code> 
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
