<!DOCTYPE html><html><head><title>Help for package incR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {incR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#incR'><p>incR: Analysis of animal incubation</p></a></li>
<li><a href='#incR_envdata'><p>An example data set of environmental temperatures to test</p>
the use of <code>link{incRenv}</code>.</a></li>
<li><a href='#incR_procdata'><p>An example of incubation temperature time-series after</p>
the use of <code>incRprep</code> and <code>incRenv</code>.</a></li>
<li><a href='#incR_rawdata'><p>An example of incubation temperature time-series</p></a></li>
<li><a href='#incRact'><p>Calculation of daily first incubation off-bout and last incubation on-bout</p></a></li>
<li><a href='#incRatt'><p>Calculation of the percentage of daily time spent in nest</p></a></li>
<li><a href='#incRbouts'><p>Calculation of the number of daily on- and off-bouts</p></a></li>
<li><a href='#incRenv'><p>Matching environmental and nest temperatures</p></a></li>
<li><a href='#incRenv_old'><p>Matching environmental and nest temperatures - Old version</p></a></li>
<li><a href='#incRplot'><p>Quick visualisation of incubation temperatures, on-bouts and off-bouts</p></a></li>
<li><a href='#incRprep'><p>Data preparation for incubation analysis in incR</p></a></li>
<li><a href='#incRscan'><p>Automated scoring of incubation</p></a></li>
<li><a href='#incRscan_v2'><p>Scoring of incubation based on a fixed temperature threshold</p></a></li>
<li><a href='#incRt'><p>Calculation of temperature average and variance for customised</p>
time windows</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Incubation Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-04-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Pablo Capilla-Lasheras [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pablo Capilla-Lasheras &lt;pacapilla@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Suite of functions to study animal incubation.
    At the core of incR 
    lies an algorithm that allows for the scoring of 
    incubation behaviour. Additionally, several functions 
    extract biologically relevant metrics of incubation such as off-bout number 
    and off-bout duration - for a review of avian incubation studies, 
    see Nests, Eggs, and Incubation: New ideas about avian reproduction (2015) 
    edited by D. Charles Deeming and S. James Reynolds &lt;<a href="https://doi.org/10.1093%2Facprof%3Aoso%2F9780198718666.001.0001">doi:10.1093/acprof:oso/9780198718666.001.0001</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0), base, stats</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, suncalc, lubridate, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>codetools, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-18 17:10:44 UTC; pc395</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-18 19:20:16 UTC</td>
</tr>
</table>
<hr>
<h2 id='incR'>incR: Analysis of animal incubation</h2><span id='topic+incR'></span>

<h3>Description</h3>

<p>This packages is formed by a suite of R functions that help the user to get
useful biological information from raw time-series data of 
incubation temperatures. It is thought to be of interest for
the study of uni-parental or intermittent incubating species.
</p>


<h3>Suggested workflow</h3>

<p>Check the package vignettes to find a suggested workflow
and calibrate the main function in <code>incR</code>.
</p>


<h3>incR functions</h3>

<p>The current version of incR contains the following functions and three example data sets:
<code><a href="#topic+incRprep">incRprep</a></code>, <code><a href="#topic+incRenv">incRenv</a></code>,
<code><a href="#topic+incRscan">incRscan</a></code>,
<code><a href="#topic+incRact">incRact</a></code>, 
<code><a href="#topic+incRatt">incRatt</a></code>
<code><a href="#topic+incRbouts">incRbouts</a></code> and 
<code><a href="#topic+incRt">incRt</a></code>, along with three example data sets.
</p>

<hr>
<h2 id='incR_envdata'>An example data set of environmental temperatures to test
the use of <code>link{incRenv}</code>.</h2><span id='topic+incR_envdata'></span>

<h3>Description</h3>

<p>A dataset containing environmental temperatures for the study area
where the data in <code><a href="#topic+incR_rawdata">incR_rawdata</a></code> were collected. 
This raw data set 
was produced by an iButton device (Maxim Integrated).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incR_envdata
</code></pre>


<h3>Format</h3>

<p>A data frame with 1570 rows and two variables, representing two days of 
environmental temperature recordings at two different locations in one study site.
</p>

<dl>
<dt>DATE</dt><dd><p>a date-time column. Both elements, date and time, are concatenated in one column.</p>
</dd>
<dt>env_temperature</dt><dd><p>environmental temperature recordings.</p>
</dd>
</dl>



<h3>Details</h3>

<p>use this data set to try out <code>link{incRenv}</code> after the very first
application of <code><a href="#topic+incRprep">incRprep</a></code> using <code><a href="#topic+incR_rawdata">incR_rawdata</a></code>.
</p>

<hr>
<h2 id='incR_procdata'>An example of incubation temperature time-series after 
the use of <code><a href="#topic+incRprep">incRprep</a></code> and <code><a href="#topic+incRenv">incRenv</a></code>.</h2><span id='topic+incR_procdata'></span>

<h3>Description</h3>

<p>A dataset containing temperatures, time and date for a blue tit nest. 
It also includes variables added by <code><a href="#topic+incRprep">incRprep</a></code> 
and <code><a href="#topic+incRenv">incRenv</a></code>.
The raw data set <code><a href="#topic+incR_rawdata">incR_rawdata</a></code>
was produced by an iButton device (Maxim) and represents raw data to start the analysis
of incubation behaviour
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incR_procdata
</code></pre>


<h3>Format</h3>

<p>A data frame with 954 rows and 11 variables, representing two days of nest
temperatures.
</p>

<dl>
<dt>DATE</dt><dd><p>a date-time column. Both elements, date and time, are concatenated in one column.</p>
</dd>
<dt>temperature</dt><dd><p>nest temperature recordings.</p>
</dd>
<dt>index</dt><dd><p>running number from first to last observation.</p>
</dd>
<dt>time</dt><dd></dd>
<dt>hour</dt><dd></dd>
<dt>minute</dt><dd></dd>
<dt>second</dt><dd></dd>
<dt>date</dt><dd></dd>
<dt>dec_time</dt><dd><p>time in decimal hours.</p>
</dd>
<dt>temp1</dt><dd><p>difference between the <em>ith</em> and the <em>ith-1</em> 
nest temperature recording.</p>
</dd>
<dt>env_temp</dt><dd><p>environmental temperature, calculated per as hour average using
<code><a href="#topic+incRenv">incRenv</a></code>.</p>
</dd>
<dt>incR_score</dt><dd><p>Incubation scores (0/1) as calculated by <code><a href="#topic+incRscan">incRscan</a></code> </p>
</dd>
</dl>



<h3>Details</h3>

<p>see <code><a href="#topic+incRprep">incRprep</a></code> and <code><a href="#topic+incRenv">incRenv</a></code>for more details on the variables of this data set
and how it was produced.
</p>

<hr>
<h2 id='incR_rawdata'>An example of incubation temperature time-series</h2><span id='topic+incR_rawdata'></span>

<h3>Description</h3>

<p>A dataset containing date, time and temperatures for a blue tit nest. This data set
was produced by an iButton device (Maxim Integrated) and 
represents raw data to start the analysis
of incubation behaviour.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incR_rawdata
</code></pre>


<h3>Format</h3>

<p>A data frame with 954 rows and 2 variables, representing three days of nest
temperatures.
</p>

<dl>
<dt>DATE</dt><dd><p>a date-time column. Both elements, date and time, are concatenated in one column</p>
</dd>
<dt>temperature</dt><dd><p>temperature recordings in Celsius</p>
</dd>
</dl>


<hr>
<h2 id='incRact'>Calculation of daily first incubation off-bout and last incubation on-bout</h2><span id='topic+incRact'></span>

<h3>Description</h3>

<p>Using a vector of incubation scores, 
<em>incRact</em>
calculates onset of activity (first off-bout in the morning),
and end of daily activity (last on-bout in the evening) per day. A column for dates, named &quot;date&quot;
is needed in the data argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incRact(data, time_column, vector.incubation)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="incRact_+3A_data">data</code></td>
<td>
<p>data frame containing a numeric vector of 1's and 0's (incubation scores), where &quot;1&quot;
means &quot;incubating individual inside nest&quot; and &quot;0&quot; means &quot;incubating individual 
outside the nests&quot;. This vector, 
under the name of <code>incR_score</code> is provided by <code><a href="#topic+incRscan">incRscan</a></code> in the 
first object (<em>incRscan_data</em>) of the returned list. A column named &quot;date&quot; is needed to refer to daily
calculations.</p>
</td></tr>
<tr><td><code id="incRact_+3A_time_column">time_column</code></td>
<td>
<p>(character class) name of the column containing times.</p>
</td></tr>
<tr><td><code id="incRact_+3A_vector.incubation">vector.incubation</code></td>
<td>
<p>(character class) name of the vector containing 
incubation scores. <code><a href="#topic+incRscan">incRscan</a></code> produces
this vector named &quot;incR_score&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame containing fist off-bout and last on-bout per day in <em>data</em>.
</p>


<h3>Author(s)</h3>

<p>Pablo Capilla-Lasheras
</p>


<h3>See Also</h3>

<p><code><a href="#topic+incRprep">incRprep</a></code> <code><a href="#topic+incRscan">incRscan</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#' # loading example data
data(incR_procdata)
incRact (data=incR_procdata, 
              time_column="time",
              vector.incubation="incR_score")
</code></pre>

<hr>
<h2 id='incRatt'>Calculation of the percentage of daily time spent in nest</h2><span id='topic+incRatt'></span>

<h3>Description</h3>

<p>This function calculates percentage of day time spent inside nest
based on the &quot;inc.vector&quot; variable produced by <code><a href="#topic+incRscan">incRscan</a></code> (or any other method).
Current version do not discriminate day and night times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incRatt(data, vector.incubation)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="incRatt_+3A_data">data</code></td>
<td>
<p>data frame containing a time-series vector of 1's and 0's, where &quot;1&quot;
means &quot;incubating individual inside nest&quot; and &quot;0&quot; means &quot;incubating individual
outside nest&quot;. This vector, 
under the name of &quot;inc.vector&quot; is provided by <code><a href="#topic+incRscan">incRscan</a></code> in the 
first object of the returned list. A column named &quot;date&quot; is needed to refer to daily
calculations.</p>
</td></tr>
<tr><td><code id="incRatt_+3A_vector.incubation">vector.incubation</code></td>
<td>
<p>name of the column (vector class) storing the
information about the presence/absence of the incubating individual in the nest.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 'date' column must have a 'year-month-day' format for this function to run correctly.
</p>


<h3>Value</h3>

<p>Daily percentage of time in nest, returned in a 
data frame with one day per raw.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+incRprep">incRprep</a></code> <code><a href="#topic+incRscan">incRscan</a></code> <code><a href="#topic+incRact">incRact</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#' # loading example data
data(incR_procdata)
incRatt (data=incR_procdata, 
               vector.incubation="incR_score")
</code></pre>

<hr>
<h2 id='incRbouts'>Calculation of the number of daily on- and off-bouts</h2><span id='topic+incRbouts'></span>

<h3>Description</h3>

<p>Calculation of number and duration of incubation
on- and off-bouts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incRbouts(data, vector.incubation, dec_time, temp, sampling.rate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="incRbouts_+3A_data">data</code></td>
<td>
<p>data frame containing a time-series vector of 1's and 0's, where &quot;1&quot;
means &quot;incubating individual inside nest&quot; and &quot;0&quot; means &quot;incubating individual
outside nest&quot;. This vector, 
under the name of &quot;inc.vector&quot;, is provided by <code><a href="#topic+incRscan">incRscan</a></code> in the 
first object of the returned list. A column named &quot;date&quot; is needed to refer to daily
calculations.</p>
</td></tr>
<tr><td><code id="incRbouts_+3A_vector.incubation">vector.incubation</code></td>
<td>
<p>name of the column (vector class) storing the
information about the presence/absence of the incubating individual in the nest.</p>
</td></tr>
<tr><td><code id="incRbouts_+3A_dec_time">dec_time</code></td>
<td>
<p>(character class) name of the column with decimal time.</p>
</td></tr>
<tr><td><code id="incRbouts_+3A_temp">temp</code></td>
<td>
<p>(character class) name of the column with incubation temperatures.</p>
</td></tr>
<tr><td><code id="incRbouts_+3A_sampling.rate">sampling.rate</code></td>
<td>
<p>time difference between two consecutive recording points.
Effectively, the rate at which data points were recorded 
(e.g. 1 data point per 50sec).
The time units of the returned object will depend on the units of this argument.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a list with two objects. The first object, named <code>total_bouts</code>, is a list of 
individual on- and off-bouts, giving information about their start time, duration, start nest temperature and 
final nest temperature. The second object, <code>day_bouts</code>, provides a summary of on- 
and off-bouts per day of observation. This second table shows number and mean duration of on- and off-bout
per day. Mean times are shown in those time units you specify the argument <em>sampling.rate</em>.
</p>


<h3>Author(s)</h3>

<p>Pablo Capilla-Lasheras
</p>


<h3>See Also</h3>

<p><code><a href="#topic+incRprep">incRprep</a></code> <code><a href="#topic+incRscan">incRscan</a></code> <code><a href="#topic+incRact">incRact</a></code>
<code><a href="#topic+incRatt">incRatt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#' # loading example data
data(incR_procdata)
incRbouts (data=incR_procdata, 
           vector.incubation="incR_score", 
           dec_time="dec_time",
           temp="temperature",
           sampling.rate=240) # sampling rate in seconds.
</code></pre>

<hr>
<h2 id='incRenv'>Matching environmental and nest temperatures</h2><span id='topic+incRenv'></span>

<h3>Description</h3>

<p>This function takes a data frame with recordings of environmental temperature and another
with nest temperatures and merges both by time. The user can do this work manually, however, 
<code><a href="#topic+incRenv">incRenv</a></code> is thought to
automate data preparation (in combination with <code><a href="#topic+incRprep">incRprep</a></code>) to use 
<code><a href="#topic+incRscan">incRscan</a></code> after. Code to update and improve this function provided by Natalie van Dis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incRenv(
  data.nest,
  data.env,
  env.temperature.name,
  env.date.name,
  env.date.format,
  env.timezone
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="incRenv_+3A_data.nest">data.nest</code></td>
<td>
<p>data frame containing nest temperature recordings. It must have two compulsory
columns 'date' and 'hour' displaying dates and the hour of each observation. These two columns
are provided if the user uses <code><a href="#topic+incRprep">incRprep</a></code> before.</p>
</td></tr>
<tr><td><code id="incRenv_+3A_data.env">data.env</code></td>
<td>
<p>data frame containing environmental temperatures to be merged with nest temperature
records. Please, provide date and time of each observation in one unique column as requested 
for <code><a href="#topic+incRprep">incRprep</a></code>.</p>
</td></tr>
<tr><td><code id="incRenv_+3A_env.temperature.name">env.temperature.name</code></td>
<td>
<p>name of the column containing temperature recordings in the 
<em>data.env</em> data frame.</p>
</td></tr>
<tr><td><code id="incRenv_+3A_env.date.name">env.date.name</code></td>
<td>
<p>name of the column containing date and time in the 
<em>data.env</em> data frame.</p>
</td></tr>
<tr><td><code id="incRenv_+3A_env.date.format">env.date.format</code></td>
<td>
<p>format of <em>env.date.name</em>. Similar to <code><a href="#topic+incRprep">incRprep</a></code>.</p>
</td></tr>
<tr><td><code id="incRenv_+3A_env.timezone">env.timezone</code></td>
<td>
<p>time zone of the environmental recordings. Similar to <code><a href="#topic+incRprep">incRprep</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is thought to be used after <code><a href="#topic+incRprep">incRprep</a></code> as it uses some of the
additional variables created by <code><a href="#topic+incRprep">incRprep</a></code>.
</p>


<h3>Value</h3>

<p>The original <em>data.nest</em> with an additional column for hour-averaged environmental
temperature. This new variable is thought to serve as <em>env_temp</em> in
<code><a href="#topic+incRscan">incRscan</a></code>.
</p>


<h3>Author(s)</h3>

<p>Pablo Capilla-Lasheras
</p>


<h3>See Also</h3>

<p><code><a href="#topic+incRprep">incRprep</a></code> <code><a href="#topic+incRscan">incRscan</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(incR_envdata)  # environmental data
head (incR_envdata)

data(incR_rawdata)  # loading nest data
head (incR_rawdata)

# the first step in to format the raw data using incRprep
new.data &lt;- incRprep (data=incR_rawdata,
                      date.name= "DATE",
                      date.format= "%d/%m/%Y %H:%M",
                      timezone="GMT",
                      temperature.name="temperature")
                      
# then use incRenv to merge environmental data
new.data2 &lt;- incRenv (data.nest = new.data,
                      data.env = incR_envdata, 
                      env.temperature.name = "env_temperature", 
                      env.date.name = "DATE", 
                      env.date.format = "%d/%m/%Y %H:%M", 
                      env.timezone = "GMT")
                     
head (new.data2, 3)
</code></pre>

<hr>
<h2 id='incRenv_old'>Matching environmental and nest temperatures - Old version</h2><span id='topic+incRenv_old'></span>

<h3>Description</h3>

<p>This function takes a data frame with recordings of environmental temperature and another
with nest temperatures and merges both per unit of time. The user can do this work manually, however, 
<code><a href="#topic+incRenv">incRenv</a></code> is thought to
automate data preparation (in combination with <code><a href="#topic+incRprep">incRprep</a></code>) to use 
<code><a href="#topic+incRscan">incRscan</a></code> after.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incRenv_old(
  data.nest,
  data.env,
  env.temperature.name,
  env.date.name,
  env.date.format,
  env.timezone
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="incRenv_old_+3A_data.nest">data.nest</code></td>
<td>
<p>data frame containing nest temperature recordings. It must have two compulsory
columns 'date' and 'hour' displaying dates and the hour of each observation. These two columns
are provided if the user uses <code><a href="#topic+incRprep">incRprep</a></code> before.</p>
</td></tr>
<tr><td><code id="incRenv_old_+3A_data.env">data.env</code></td>
<td>
<p>data frame containing environmental temperatures to be merged with nest temperature
records. Please, provide date and time of each observation in one unique column as requested 
for <code><a href="#topic+incRprep">incRprep</a></code>.</p>
</td></tr>
<tr><td><code id="incRenv_old_+3A_env.temperature.name">env.temperature.name</code></td>
<td>
<p>name of the column containing temperature recordings in the 
<em>data.env</em> data frame.</p>
</td></tr>
<tr><td><code id="incRenv_old_+3A_env.date.name">env.date.name</code></td>
<td>
<p>name of the column containing date and time in the 
<em>data.env</em> data frame.</p>
</td></tr>
<tr><td><code id="incRenv_old_+3A_env.date.format">env.date.format</code></td>
<td>
<p>format of <em>env.date.name</em>. Similar to <code><a href="#topic+incRprep">incRprep</a></code>.</p>
</td></tr>
<tr><td><code id="incRenv_old_+3A_env.timezone">env.timezone</code></td>
<td>
<p>time zone of the environmental recordings. Similar to <code><a href="#topic+incRprep">incRprep</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is thought to be used after <code><a href="#topic+incRprep">incRprep</a></code> as it uses some of the
additional variables created by <code><a href="#topic+incRprep">incRprep</a></code>.
</p>


<h3>Value</h3>

<p>The original <em>data.nest</em> with an additional column for hour-averaged environmental
temperature. This new variable is thought to serve as <em>env_temp</em> in
<code><a href="#topic+incRscan">incRscan</a></code>.
</p>


<h3>Author(s)</h3>

<p>Pablo Capilla-Lasheras
</p>


<h3>See Also</h3>

<p><code><a href="#topic+incRprep">incRprep</a></code> <code><a href="#topic+incRscan">incRscan</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(incR_envdata)  # environmental data
head (incR_envdata)

data(incR_rawdata)  # loading nest data
head (incR_rawdata)

# the first step in to format the raw data using incRprep
new.data &lt;- incRprep (data=incR_rawdata,
                      date.name= "DATE",
                      date.format= "%d/%m/%Y %H:%M",
                      timezone="GMT",
                      temperature.name="temperature")
                      
# then use incRenv to merge environmental data
new.data2 &lt;- incRenv_old (data.nest = new.data,
                      data.env = incR_envdata, 
                      env.temperature.name = "env_temperature", 
                      env.date.name = "DATE", 
                      env.date.format = "%d/%m/%Y %H:%M", 
                      env.timezone = "GMT")
                     
head (new.data2, 3)
</code></pre>

<hr>
<h2 id='incRplot'>Quick visualisation of incubation temperatures, on-bouts and off-bouts</h2><span id='topic+incRplot'></span>

<h3>Description</h3>

<p>After <code><a href="#topic+incRscan">incRscan</a></code> has been used, <code><a href="#topic+incRplot">incRplot</a></code>
provides a quick visualisation of the incubation temperature trace with coloured
on- and off-bouts. Environmental temperatures can also be added to the plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incRplot(
  data,
  time.var,
  day.var,
  inc.temperature.var,
  env.temperature.var = NULL,
  vector.incubation
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="incRplot_+3A_data">data</code></td>
<td>
<p>data table with incubation temperature data</p>
</td></tr>
<tr><td><code id="incRplot_+3A_time.var">time.var</code></td>
<td>
<p>Character string. Name of the variable with time of the day for
temperature data. Please, have time in 
decimal hours. If <code><a href="#topic+incRprep">incRprep</a></code> has been previously used, &quot;dec_time&quot; can
be used.</p>
</td></tr>
<tr><td><code id="incRplot_+3A_day.var">day.var</code></td>
<td>
<p>Character string. Name of the variable with date for
temperature observation. No specific format is needed. 
If <code><a href="#topic+incRprep">incRprep</a></code> has been previously used, &quot;date&quot; can
be used.</p>
</td></tr>
<tr><td><code id="incRplot_+3A_inc.temperature.var">inc.temperature.var</code></td>
<td>
<p>Character string. Name of the variable with incubation 
temperatures.</p>
</td></tr>
<tr><td><code id="incRplot_+3A_env.temperature.var">env.temperature.var</code></td>
<td>
<p>Character string. Name of the variable with environmental
temperatures. If no value is provided, a plot with no environmental temperatures
is produced.</p>
</td></tr>
<tr><td><code id="incRplot_+3A_vector.incubation">vector.incubation</code></td>
<td>
<p>name of the binary variable storing
information about the presence/absence of the incubating individual in the nest.
If <code><a href="#topic+incRscan">incRscan</a></code> has been used, &quot;incR_score&quot; can be used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of incubation temperature, on-bouts and off-bouts with (optional) 
environmental temperatures. The plot is generated using <code><a href="ggplot2.html#topic+ggplot2">ggplot2</a></code>.The
user can customised the appearance of the plot using tools 
within <code><a href="ggplot2.html#topic+ggplot2">ggplot2</a></code>(see example)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+incRscan">incRscan</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># loading example data
data(incR_procdata)
my_plot &lt;- incRplot(data = incR_procdata[complete.cases(incR_procdata$temperature),], 
                    time.var = "dec_time", 
                    day.var = "date", 
                    inc.temperature.var = "temperature", 
                    env.temperature.var = "env_temp",
                    vector.incubation = "incR_score")
                    
# see your plot
my_plot

# add new labels (ggplot2 required)
my_plot + ggplot2::labs(x = "New X label", y = "New Y label")
</code></pre>

<hr>
<h2 id='incRprep'>Data preparation for incubation analysis in incR</h2><span id='topic+incRprep'></span>

<h3>Description</h3>

<p>Preparing incubation time series for further analysis.
This function takes a data file containing a temporal series of temperature recordings
and adds some the extra variables needed to use
further functions embedded in the incR package. 
It simply accommodates a raw data frame, reformatting date and time columns
automatically.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incRprep(data, date.name, date.format, timezone, temperature.name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="incRprep_+3A_data">data</code></td>
<td>
<p>raw data from incubation time series. It must contain a column 
with date and time information for each observation (e.g. &quot;2017-05-01 21:01&quot;). 
The function is written to
handle date and time concatenated in one unique column (see example below).</p>
</td></tr>
<tr><td><code id="incRprep_+3A_date.name">date.name</code></td>
<td>
<p>name of the date and time column</p>
</td></tr>
<tr><td><code id="incRprep_+3A_date.format">date.format</code></td>
<td>
<p>format for date and time column. 
It must be a character object as specified in the function <code><a href="base.html#topic+strptime">strptime</a></code>.   
<code><a href="#topic+incRprep">incRprep</a></code> assumes that the date and time column contains date and time, 
If date and time are in different columns, please, concatenate them in one
column before running the function.</p>
</td></tr>
<tr><td><code id="incRprep_+3A_timezone">timezone</code></td>
<td>
<p>time zone for time calculations. See <code><a href="base.html#topic+strptime">strptime</a></code>.
documentation for more details.</p>
</td></tr>
<tr><td><code id="incRprep_+3A_temperature.name">temperature.name</code></td>
<td>
<p>name of the column storing temperature information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The original data frame with additional columns for:
</p>

<ol>
<li><p> index: a running number identifying every row in the data set.
</p>
</li>
<li><p> time: in  '
</p>
</li>
<li><p> hour: in 'H' format.
</p>
</li>
<li><p> minute: in 'M' format.
</p>
</li>
<li><p> second: in 'S' format. 
</p>
</li>
<li><p> date: in  'Y-m-d' format.
</p>
</li>
<li><p> dec_time: time in decimal hours (e.g. &quot;22:30&quot; becomes 22.5). 
</p>
</li>
<li><p> temp1: difference between the <em>i</em>th temperature value and the <em>i-1</em> one.
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Pablo Capilla-Lasheras
</p>


<h3>Examples</h3>

<pre><code class='language-R'># loading example data
data(incR_rawdata)
new.data &lt;- incRprep (data=incR_rawdata,
                       date.name= "DATE",
                       date.format= "%d/%m/%Y %H:%M",
                       timezone="GMT",
                       temperature.name="temperature")
head (new.data, 3)
</code></pre>

<hr>
<h2 id='incRscan'>Automated scoring of incubation</h2><span id='topic+incRscan'></span>

<h3>Description</h3>

<p>This is the core algorithm of <code>incR</code> and classifies time points as 1's or 0's depending on
whether or not the incubating individual is considered to be on the eggs. 
The algorithm
uses night variation to daily calibrate itself to temperature variation when the incubating
individual is assumed to be on the eggs. 
A major assumption of this algorithm is that
there is a period of time in which temperature can be assumed to be constant or
representative of time windows of constant incubation. This time window is defined by
two arguments: <code>lower.time</code> and <code>upper.time</code>. The function is optimised to work using
a data frame produced by <code><a href="#topic+incRprep">incRprep</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incRscan(
  data,
  temp.name,
  lower.time,
  upper.time,
  sensitivity,
  temp.diff,
  temp.diff.threshold,
  maxNightVariation,
  env.temp
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="incRscan_+3A_data">data</code></td>
<td>
<p>data frame for analysis. It must contained four columns named as follow:
<code>date</code>, <code>temp1</code>, <code>dec_time</code> and <code>index</code>, where <code>temp1</code> is the difference between
the <em>ith</em> and  <em>i-1th</em> temperature recordings; <code>dec_time</code> is time in
decimal hours; and <code>index</code> is a running number from 1 to <em>N</em>, <em>N</em> being the 
total number of observations. <code><a href="#topic+incRprep">incRprep</a></code> returns a data frame with
these variables and the correct names, ready to be passed through <code>incRscan</code>.</p>
</td></tr>
<tr><td><code id="incRscan_+3A_temp.name">temp.name</code></td>
<td>
<p>(character object) name of the column containing temperature data 
in <code>data</code>.</p>
</td></tr>
<tr><td><code id="incRscan_+3A_lower.time">lower.time</code></td>
<td>
<p>lower limit of time window for calibration (numeric).</p>
</td></tr>
<tr><td><code id="incRscan_+3A_upper.time">upper.time</code></td>
<td>
<p>upper limit of time window for calibration (numeric).</p>
</td></tr>
<tr><td><code id="incRscan_+3A_sensitivity">sensitivity</code></td>
<td>
<p>ratio of reduction in temperature threshold. When nest temperature
does not drop close to environmental temperatures, this value can be kept to 1. If 
nest temperature follows environmental temperature at any point, 
then adjustment of this value may
be required to detect short on/off-bouts at lower nest temperatures (see details).</p>
</td></tr>
<tr><td><code id="incRscan_+3A_temp.diff">temp.diff</code></td>
<td>
<p>deprecated. Use temp.diff.threshold.</p>
</td></tr>
<tr><td><code id="incRscan_+3A_temp.diff.threshold">temp.diff.threshold</code></td>
<td>
<p>threshold for temperature difference between <code>env.temp</code> and an observation which
triggers the sensitivity parameter.</p>
</td></tr>
<tr><td><code id="incRscan_+3A_maxnightvariation">maxNightVariation</code></td>
<td>
<p>maximum temperature variation between two consecutive points
within the calibrating window that is considered normal of this period. 
If this variation value is surpassed, the
calibrating window is discarded and a previous night is used for calibration.</p>
</td></tr>
<tr><td><code id="incRscan_+3A_env.temp">env.temp</code></td>
<td>
<p>name of a column containing environmental temperatures.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with two objects. The first object, named <code>incRscan_data</code>, is the original
data frame with an extra column named 'incR_score'. This variable is formed by 1's and 0's,
representing whether the incubating individual is inside (1) or outside the nest (0).
</p>
<p>The second object, named <code>incRscan_threshold</code>, is a data frame with one day per row. Four columns tell the user
the thresholds employed to calculate the 'incR_score' column. A fifth column accounts
for the ratio between temperature variation in the calibrating window and the variation in temperature 
between 11am and 3pm for each day morning. The lower this value the more clear the pattern between night 
and day variation and, therefore, stronger the signal in the data. 
This value may serve the user as an indication of the signal / noise ratio in the analysed
data set.
</p>


<h3>Details</h3>

<p>For further details about the calculation performed by <code><a href="#topic+incRscan">incRscan</a></code>, consult the package vignettes and
the associated publications.
</p>


<h3>Author(s)</h3>

<p>Pablo Capilla-Lasheras
</p>


<h3>See Also</h3>

<p><code><a href="#topic+incRprep">incRprep</a></code> <code><a href="#topic+incRenv">incRenv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># incR_procdata is a dataframe processed by incRprep and incRenv.
# it contains suitable information to run incRscan
data(incR_procdata)

incubation.analysis &lt;- incRscan (data=incR_procdata, 
                                  temp.name="temperature",
                                  lower.time=22,
                                  upper.time=3,
                                  sensitivity=0.15,
                                  temp.diff.threshold=5,
                                  maxNightVariation=2,
                                  env.temp="env_temp")
inc.data &lt;- incubation.analysis[[1]]
inc.thresholds &lt;- incubation.analysis[[2]]
</code></pre>

<hr>
<h2 id='incRscan_v2'>Scoring of incubation based on a fixed temperature threshold</h2><span id='topic+incRscan_v2'></span>

<h3>Description</h3>

<p>Modified version of <code>incRscan</code>. Data points are assigned to incubation on/off-bout based on
a fixed temperature threshold for the difference in nest temperature expected when an off-bout starts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incRscan_v2(
  data,
  temp.name,
  sensitivity,
  temperature_threshold,
  temp.diff.threshold,
  env.temp
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="incRscan_v2_+3A_data">data</code></td>
<td>
<p>data frame for analysis. It must contained four columns named as follow:
<code>date</code>, <code>temp1</code>, <code>dec_time</code> and <code>index</code>, where <code>temp1</code> is the difference between
the <em>ith</em> and  <em>i-1th</em> temperature recordings; <code>dec_time</code> is time in
decimal hours; and <code>index</code> is a running number from 1 to <em>N</em>, <em>N</em> being the 
total number of observations. <code><a href="#topic+incRprep">incRprep</a></code> returns a data frame with
these variables and the correct names, ready to be passed through <code>incRscan</code>.</p>
</td></tr>
<tr><td><code id="incRscan_v2_+3A_temp.name">temp.name</code></td>
<td>
<p>(character object) name of the column containing temperature data 
in <code>data</code>.</p>
</td></tr>
<tr><td><code id="incRscan_v2_+3A_sensitivity">sensitivity</code></td>
<td>
<p>percentage of reduction in temperature threshold. When nest temperature
does not drop close to environmental temperature, this value can be kept to 1. If 
nest temperature follows environmental temperature at any point, 
then, adjustment of this value may
be required to detect short on/off-bouts at lower nest temperatures (see details).</p>
</td></tr>
<tr><td><code id="incRscan_v2_+3A_temperature_threshold">temperature_threshold</code></td>
<td>
<p>Maximum temperature difference between two consecutive nest temperature recordings 
allowed for an on-bout. When the difference in nest temperature between two consecutive recordings is higher than
this value, an off-bout is detected.</p>
</td></tr>
<tr><td><code id="incRscan_v2_+3A_temp.diff.threshold">temp.diff.threshold</code></td>
<td>
<p>threshold for temperature difference between <code>env.temp</code> and an observation which
triggers application of the sensitivity parameter.</p>
</td></tr>
<tr><td><code id="incRscan_v2_+3A_env.temp">env.temp</code></td>
<td>
<p>name of a column containing environmental temperatures.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns the original data frame with a new column named 'incR_score'. 
This new variable is formed by 1's and 0's,
representing whether the incubating individual is inside (&quot;1&quot;) or outside the nest (&quot;0&quot;).
#' @section Details:
See <code><a href="#topic+incRenv">incRenv</a></code> for more details
</p>


<h3>Author(s)</h3>

<p>Pablo Capilla-Lasheras
</p>


<h3>See Also</h3>

<p><code><a href="#topic+incRprep">incRprep</a></code> <code><a href="#topic+incRenv">incRenv</a></code> <code><a href="#topic+incRscan">incRscan</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># incR_procdata is a data frame processed by incRprep and incRenv.
# It contains suitable information to run incRscan
data(incR_procdata)

incubation.analysis &lt;- incRscan_v2 (data=incR_procdata, 
                                  temp.name="temperature",
                                  temperature_threshold = 0.75,
                                  sensitivity=0.15,
                                  temp.diff.threshold=5,
                                  env.temp="env_temp")
</code></pre>

<hr>
<h2 id='incRt'>Calculation of temperature average and variance for customised
time windows</h2><span id='topic+incRt'></span>

<h3>Description</h3>

<p>Calculation of temperature average and variation between two customised
time periods per day. Time windows can be defined by the user using the <code>limits</code> argument,
defined by bird activity time (using the <code>activity.times</code> parameter) or set according to
twilight times if coordinates are provided (<code>coor</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incRt(
  data,
  temp.name,
  limits = NULL,
  coor = NULL,
  activity.times = FALSE,
  civil.twilight = FALSE,
  time.zone = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="incRt_+3A_data">data</code></td>
<td>
<p>data frame containing a time-series vector of 1's and 0's (incubation scores), 
where &quot;1&quot;
means &quot;incubating individual inside nest&quot; and &quot;0&quot; means &quot;incubating individual 
outside the nests&quot;. This vector, 
under the name of <code>incR_score</code>, is provided by <code><a href="#topic+incRscan">incRscan</a></code> in the 
first object of the returned list. A column named &quot;date&quot; is needed to refer to daily
calculations.</p>
</td></tr>
<tr><td><code id="incRt_+3A_temp.name">temp.name</code></td>
<td>
<p>(character object) name of the column containing temperature data 
in data.</p>
</td></tr>
<tr><td><code id="incRt_+3A_limits">limits</code></td>
<td>
<p>vector of length 2 giving the time limits for calculations. For example,
'c(6,20)' would calculate temperature averages and variances for two time periods, from 6 to 20
and from 20 to 6 of the next day. 'civil.twilight' and 'activity.times' must be
FALSE to allow the use of 'limits'.</p>
</td></tr>
<tr><td><code id="incRt_+3A_coor">coor</code></td>
<td>
<p>coordinates for the location where temperature was recorded,
formatted as decimal degrees N/S, decimal degrees E/W.
When 'civil.twilight' is TRUE, 'coor' allows the user to define sunrise and sunset times
based on the <code><a href="suncalc.html#topic+getSunlightTimes">getSunlightTimes</a></code> function (in <code>suncalc</code> package).</p>
</td></tr>
<tr><td><code id="incRt_+3A_activity.times">activity.times</code></td>
<td>
<p>TRUE or FALSE. Set as TRUE when time periods for calculation
are defined by <code><a href="#topic+incRact">incRact</a></code>. Data must contain a column named 
'incR_score' for the use of <code><a href="#topic+incRact">incRact</a></code>.</p>
</td></tr>
<tr><td><code id="incRt_+3A_civil.twilight">civil.twilight</code></td>
<td>
<p>TRUE or FALSE. Set as TRUE when time periods for calculation
are to be defined by civil twilight times - calculated using <code><a href="suncalc.html#topic+getSunlightTimes">getSunlightTimes</a></code>. 
If 'civil.twilight = TRUE', 'coor' and 'time.zone' need to be specified.</p>
</td></tr>
<tr><td><code id="incRt_+3A_time.zone">time.zone</code></td>
<td>
<p>time zone for <code><a href="suncalc.html#topic+getSunlightTimes">getSunlightTimes</a></code> dawn and dusk calculations.</p>
</td></tr>
<tr><td><code id="incRt_+3A_...">...</code></td>
<td>
<p>use parameters in <code><a href="#topic+incRact">incRact</a></code> if <em>activity.times</em> = TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame containing temperature means and variance for the defined time 
window.
</p>


<h3>Author(s)</h3>

<p>Pablo Capilla-Lasheras
</p>


<h3>See Also</h3>

<p><code><a href="#topic+incRprep">incRprep</a></code> <code><a href="#topic+incRscan">incRscan</a></code> <code><a href="#topic+incRact">incRact</a></code>
<code><a href="suncalc.html#topic+getSunlightTimes">getSunlightTimes</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># loading example data
data(incR_procdata)

# calculation based on chosen times from 6am to 7pm and 7pm to 6am
incRt (data=incR_procdata, 
        temp.name="temperature",
        limits=c(6,19), 
        coor=NULL, 
        civil.twilight=FALSE, 
        activity.times=FALSE,
        time.zone=NULL)
        
# calculation based on activity times
incRt (data=incR_procdata, 
        temp.name="temperature", 
        limits=NULL, 
        coor=NULL, 
        civil.twilight=FALSE, 
        activity.times=TRUE,
        time.zone=NULL,
        time_column="time",             # extra argument needed for incRact
        vector.incubation="incR_score") # extra argument needed for incRact
        
# calculation based on civil twilight
incRt (data=incR_procdata, 
        temp.name="temperature",
        limits=NULL, 
        coor=c(42,0.89), 
        civil.twilight=TRUE, 
        activity.times=FALSE,
        time.zone="GMT")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
