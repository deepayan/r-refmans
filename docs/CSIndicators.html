<!DOCTYPE html><html><head><title>Help for package CSIndicators</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CSIndicators}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AbsToProbs'><p>Transform ensemble forecast into probabilities</p></a></li>
<li><a href='#AccumulationExceedingThreshold'><p>Accumulation of a variable when Exceeding (not exceeding) a Threshold</p></a></li>
<li><a href='#CST_AbsToProbs'><p>Transform ensemble forecast into probabilities</p></a></li>
<li><a href='#CST_AccumulationExceedingThreshold'><p>Accumulation of a variable when Exceeding (not exceeding) a Threshold</p></a></li>
<li><a href='#CST_MergeRefToExp'><p>Merge a Reference To Experiments</p></a></li>
<li><a href='#CST_PeriodAccumulation'><p>Period Accumulation on 's2dv_cube' objects</p></a></li>
<li><a href='#CST_PeriodMax'><p>Period Max on 's2dv_cube' objects</p></a></li>
<li><a href='#CST_PeriodMean'><p>Period Mean on 's2dv_cube' objects</p></a></li>
<li><a href='#CST_PeriodMin'><p>Period Min on 's2dv_cube' objects</p></a></li>
<li><a href='#CST_PeriodPET'><p>Compute the Potential Evapotranspiration</p></a></li>
<li><a href='#CST_PeriodStandardization'><p>Compute the Standardization of Precipitation-Evapotranspiration Index</p></a></li>
<li><a href='#CST_PeriodVariance'><p>Period Variance on 's2dv_cube' objects</p></a></li>
<li><a href='#CST_QThreshold'><p>Transform an absolute threshold into probabilities</p></a></li>
<li><a href='#CST_SelectPeriodOnData'><p>Select a period on Data on 's2dv_cube' objects</p></a></li>
<li><a href='#CST_Threshold'><p>Absolute value of a relative threshold (percentile)</p></a></li>
<li><a href='#CST_TotalSpellTimeExceedingThreshold'><p>Total Spell Time Exceeding Threshold</p></a></li>
<li><a href='#CST_TotalTimeExceedingThreshold'><p>Total Time of a variable Exceeding (not exceeding) a Threshold</p></a></li>
<li><a href='#CST_WindCapacityFactor'><p>Wind capacity factor on s2dv_cube objects</p></a></li>
<li><a href='#CST_WindPowerDensity'><p>Wind power density on s2dv_cube objects</p></a></li>
<li><a href='#MergeRefToExp'><p>Merge a Reference To Experiments</p></a></li>
<li><a href='#PeriodAccumulation'><p>Period Accumulation on multidimensional array objects</p></a></li>
<li><a href='#PeriodMax'><p>Period max on multidimensional array objects</p></a></li>
<li><a href='#PeriodMean'><p>Period Mean on multidimensional array objects</p></a></li>
<li><a href='#PeriodMin'><p>Period Min on multidimensional array objects</p></a></li>
<li><a href='#PeriodPET'><p>Compute the Potential Evapotranspiration</p></a></li>
<li><a href='#PeriodStandardization'><p>Compute the Standardization of Precipitation-Evapotranspiration Index</p></a></li>
<li><a href='#PeriodVariance'><p>Period Variance on multidimensional array objects</p></a></li>
<li><a href='#QThreshold'><p>Transform an absolute threshold into probabilities</p></a></li>
<li><a href='#SelectPeriodOnData'><p>Select a period on Data on multidimensional array objects</p></a></li>
<li><a href='#SelectPeriodOnDates'><p>Select a period on Dates</p></a></li>
<li><a href='#Threshold'><p>Absolute value of a relative threshold (percentile)</p></a></li>
<li><a href='#TotalSpellTimeExceedingThreshold'><p>Total Spell Time Exceeding Threshold</p></a></li>
<li><a href='#TotalTimeExceedingThreshold'><p>Total Time of a variable Exceeding (not exceeding) a Threshold</p></a></li>
<li><a href='#WindCapacityFactor'><p>Wind capacity factor</p></a></li>
<li><a href='#WindPowerDensity'><p>Wind power density on multidimensional array objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Climate Services' Indicators Based on Sub-Seasonal to Decadal
Predictions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Set of generalised tools for the flexible computation of climate 
  related indicators defined by the user. Each method represents a specific 
  mathematical approach which is combined with the possibility to select an 
  arbitrary time period to define the indicator. This enables a wide range of 
  possibilities to tailor the most suitable indicator for each particular climate 
  service application (agriculture, food security, energy, water management, ...). 
  This package is intended for sub-seasonal, seasonal and decadal climate 
  predictions, but its methods are also applicable to other time-scales, 
  provided the dimensional structure of the input is maintained. Additionally, 
  the outputs of the functions in this package are compatible with 'CSTools'. 
  This package is described in 'Pérez-Zanón et al. (2023) 
  &lt;<a href="https://doi.org/10.1016%2Fj.cliser.2023.100393">doi:10.1016/j.cliser.2023.100393</a>&gt;' and it was developed in the context of 
  'H2020 MED-GOLD' (776467) and 'S2S4E' (776787) projects. See 'Lledó et al. (2019) 
  &lt;<a href="https://doi.org/10.1016%2Fj.renene.2019.04.135">doi:10.1016/j.renene.2019.04.135</a>&gt;' and 'Chou et al., 2023 
  &lt;<a href="https://doi.org/10.1016%2Fj.cliser.2023.100345">doi:10.1016/j.cliser.2023.100345</a>&gt;' for details.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>multiApply (&ge; 2.1.1), stats, ClimProjDiags, CSTools, SPEI,
lmom, lmomco, zoo, s2dv</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, markdown, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://earth.bsc.es/gitlab/es/csindicators/">https://earth.bsc.es/gitlab/es/csindicators/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://earth.bsc.es/gitlab/es/csindicators/-/issues">https://earth.bsc.es/gitlab/es/csindicators/-/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-24 10:15:59 UTC; erifarov</td>
</tr>
<tr>
<td>Author:</td>
<td>Victòria Agudetse [cre],
  Eva Rifà [ctb],
  Nuria Perez-Zanon <a href="https://orcid.org/0000-0001-8568-3071"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Chou Chihchung [aut],
  Llorenç Lledó [aut],
  González-Reviriego Nube [ctb],
  Marcos Raül [ctb],
  Palma Lluis [ctb],
  An-Chi Ho [ctb],
  BSC-CNS [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Victòria Agudetse &lt;victoria.agudetse@bsc.es&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-24 14:43:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='AbsToProbs'>Transform ensemble forecast into probabilities</h2><span id='topic+AbsToProbs'></span>

<h3>Description</h3>

<p>The Cumulative Distribution Function of a forecast is used to obtain the 
probabilities of each value in the ensemble. If multiple initializations 
(start dates) are provided, the function will create the Cumulative 
Distribution Function excluding the corresponding initialization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AbsToProbs(
  data,
  dates = NULL,
  start = NULL,
  end = NULL,
  time_dim = "time",
  memb_dim = "member",
  sdate_dim = "sdate",
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AbsToProbs_+3A_data">data</code></td>
<td>
<p>A multidimensional array with named dimensions.</p>
</td></tr>
<tr><td><code id="AbsToProbs_+3A_dates">dates</code></td>
<td>
<p>An optional parameter containing a vector of dates or a 
multidimensional array of dates with named dimensions matching the
dimensions on parameter 'data'. By default it is NULL, to select a period 
this parameter must be provided. All common dimensions with 'data' need to 
have the same length.</p>
</td></tr>
<tr><td><code id="AbsToProbs_+3A_start">start</code></td>
<td>
<p>An optional parameter to define the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="AbsToProbs_+3A_end">end</code></td>
<td>
<p>An optional parameter to define the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="AbsToProbs_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension. By default, it is set to 'time'. More than one dimension name 
matching the dimensions provided in the object <code>data$data</code> can be 
specified. This dimension is required to subset the data in a requested 
period.</p>
</td></tr>
<tr><td><code id="AbsToProbs_+3A_memb_dim">memb_dim</code></td>
<td>
<p>A character string indicating the name of the dimension in 
which the ensemble members are stored.</p>
</td></tr>
<tr><td><code id="AbsToProbs_+3A_sdate_dim">sdate_dim</code></td>
<td>
<p>A character string indicating the name of the dimension in 
which the initialization dates are stored.</p>
</td></tr>
<tr><td><code id="AbsToProbs_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A multidimensional array with named dimensions containing the 
probabilites in the element <code>data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exp &lt;- array(rnorm(216), dim = c(dataset = 1, member = 2, sdate = 3, 
                                time = 9, lat = 2, lon = 2))
exp_probs &lt;- AbsToProbs(exp)
data &lt;- array(rnorm(5 * 3 * 61 * 1),
             c(member = 5, sdate = 3, time = 61, lon = 1)) 
Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
              as.Date("30-06-2000", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
              as.Date("30-06-2001", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
              as.Date("30-06-2002", format = "%d-%m-%Y"), by = 'day'))
dim(Dates) &lt;- c(time = 61, sdate = 3)
exp_probs &lt;- AbsToProbs(data, dates = Dates, start = list(21, 4), 
                       end = list(21, 6))

</code></pre>

<hr>
<h2 id='AccumulationExceedingThreshold'>Accumulation of a variable when Exceeding (not exceeding) a Threshold</h2><span id='topic+AccumulationExceedingThreshold'></span>

<h3>Description</h3>

<p>The accumulation (sum) of a variable in the days (or time steps) that the 
variable is exceeding (or not exceeding) a threshold during a period. The 
threshold provided must be in the same units than the variable units, i.e. to 
use a percentile as a scalar, the function <code>Threshold</code> or 
<code>QThreshold</code> may be needed. Providing mean daily temperature data, the 
following agriculture indices for heat stress can be obtained by using this 
function:
</p>

<ul>
<li><p>'GDD', Summation of daily differences between daily average 
temperatures and 10°C between April 1st and October 31st.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>AccumulationExceedingThreshold(
  data,
  threshold,
  op = "&gt;",
  diff = FALSE,
  dates = NULL,
  start = NULL,
  end = NULL,
  time_dim = "time",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AccumulationExceedingThreshold_+3A_data">data</code></td>
<td>
<p>A multidimensional array with named dimensions.</p>
</td></tr>
<tr><td><code id="AccumulationExceedingThreshold_+3A_threshold">threshold</code></td>
<td>
<p>If only one threshold is used: it can be a multidimensional 
array with named dimensions. It must be in the same units and with the 
common dimensions of the same length as parameter 'data'. It can also be a
vector with the same length of 'time_dim' from 'data' or a scalar. If we 
want to use two thresholds: it can be a vector of two scalars, a list of 
two vectors with the same length of 'time_dim' from 'data' or a list of 
two multidimensional arrays with the common dimensions of the same length 
as parameter 'data'. If two thresholds are used, parameter 'op' must be 
also a vector of two elements.</p>
</td></tr>
<tr><td><code id="AccumulationExceedingThreshold_+3A_op">op</code></td>
<td>
<p>An operator '&gt;' (by default), '&lt;', '&gt;=' or '&lt;='. If  two thresholds
are used it has to be a vector of a pair of two logical operators: 
c('&lt;', '&gt;'), c('&lt;', '&gt;='), c('&lt;=', '&gt;'), c('&lt;=', '&gt;='), c('&gt;', '&lt;'), 
c('&gt;', '&lt;='), c('&gt;=', '&lt;'),c('&gt;=', '&lt;=')).</p>
</td></tr>
<tr><td><code id="AccumulationExceedingThreshold_+3A_diff">diff</code></td>
<td>
<p>A logical value indicating whether to accumulate the difference 
between data and threshold (TRUE) or not (FALSE by default). It can only be
TRUE if a unique threshold is used.</p>
</td></tr>
<tr><td><code id="AccumulationExceedingThreshold_+3A_dates">dates</code></td>
<td>
<p>A multidimensional array of dates with named dimensions matching 
the temporal dimensions on parameter 'data'. By default it is NULL, to  
select aperiod this parameter must be provided.</p>
</td></tr>
<tr><td><code id="AccumulationExceedingThreshold_+3A_start">start</code></td>
<td>
<p>An optional parameter to define the initial date of the period
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is 
set to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="AccumulationExceedingThreshold_+3A_end">end</code></td>
<td>
<p>An optional parameter to define the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="AccumulationExceedingThreshold_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute the indicator. By default, it is set to 'time'. It can only
indicate one time dimension.</p>
</td></tr>
<tr><td><code id="AccumulationExceedingThreshold_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether to ignore NA values (TRUE) 
or not (FALSE).</p>
</td></tr>
<tr><td><code id="AccumulationExceedingThreshold_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A multidimensional array with named dimensions containing the 
aggregated values with dimensions of the input parameter 'data' except the 
dimension where the indicator has been computed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Assuming data is already (tasmax + tasmin)/2 - 10
data &lt;- array(rnorm(5 * 3 * 214 * 2, mean = 25, sd = 3),
                   c(memb = 5, sdate = 3, time = 214, lon = 2)) 
GDD &lt;- AccumulationExceedingThreshold(data, threshold = 0, start = list(1, 4),
                                     end = list(31, 10))
</code></pre>

<hr>
<h2 id='CST_AbsToProbs'>Transform ensemble forecast into probabilities</h2><span id='topic+CST_AbsToProbs'></span>

<h3>Description</h3>

<p>The Cumulative Distribution Function of a forecast is used to obtain the 
probabilities of each value in the ensemble. If multiple initializations 
(start dates) are provided, the function will create the Cumulative 
Distribution Function excluding the corresponding initialization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CST_AbsToProbs(
  data,
  start = NULL,
  end = NULL,
  time_dim = "time",
  memb_dim = "member",
  sdate_dim = "sdate",
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CST_AbsToProbs_+3A_data">data</code></td>
<td>
<p>An 's2dv_cube' object as provided function <code>CST_Start</code> or 
<code>CST_Load</code> in package CSTools.</p>
</td></tr>
<tr><td><code id="CST_AbsToProbs_+3A_start">start</code></td>
<td>
<p>An optional parameter to define the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_AbsToProbs_+3A_end">end</code></td>
<td>
<p>An optional parameter to define the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_AbsToProbs_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension. By default, it is set to 'time'. More than one dimension name 
matching the dimensions provided in the object <code>data$data</code> can be 
specified. This dimension is required to subset the data in a requested 
period.</p>
</td></tr>
<tr><td><code id="CST_AbsToProbs_+3A_memb_dim">memb_dim</code></td>
<td>
<p>A character string indicating the name of the dimension in 
which the ensemble members are stored.</p>
</td></tr>
<tr><td><code id="CST_AbsToProbs_+3A_sdate_dim">sdate_dim</code></td>
<td>
<p>A character string indicating the name of the dimension in 
which the initialization dates are stored.</p>
</td></tr>
<tr><td><code id="CST_AbsToProbs_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An 's2dv_cube' object containing the probabilites in the element <code>data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exp &lt;- NULL
exp$data &lt;- array(rnorm(216), dim = c(dataset = 1, member = 2, sdate = 3, 
                 time = 9, lat = 2, lon = 2))
class(exp) &lt;- 's2dv_cube'
exp_probs &lt;- CST_AbsToProbs(exp)
exp$data &lt;- array(rnorm(5 * 3 * 214 * 2),
                 c(member = 5, sdate = 3, time = 214, lon = 2)) 
exp$attrs$Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
                        as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
                    seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
                        as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
                    seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
                        as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(exp$attrs$Dates) &lt;- c(time = 214, sdate = 3)
exp_probs &lt;- CST_AbsToProbs(data = exp, start = list(21, 4), end = list(21, 6))
</code></pre>

<hr>
<h2 id='CST_AccumulationExceedingThreshold'>Accumulation of a variable when Exceeding (not exceeding) a Threshold</h2><span id='topic+CST_AccumulationExceedingThreshold'></span>

<h3>Description</h3>

<p>The accumulation (sum) of a variable in the days (or time steps) that the 
variable is exceeding (or not exceeding) a threshold during a period. The 
threshold provided must be in the same units than the variable units, i.e. to 
use a percentile as a scalar, the function <code>Threshold</code> or 
<code>QThreshold</code> may be needed. Providing mean daily temperature data, the 
following agriculture indices for heat stress can be obtained by using this 
function:
</p>

<ul>
<li><p>'GDD', Summation of daily differences between daily average 
temperatures and 10°C between April 1st and October 31st.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>CST_AccumulationExceedingThreshold(
  data,
  threshold,
  op = "&gt;",
  diff = FALSE,
  start = NULL,
  end = NULL,
  time_dim = "time",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CST_AccumulationExceedingThreshold_+3A_data">data</code></td>
<td>
<p>An 's2dv_cube' object as provided function <code>CST_Start</code> or 
<code>CST_Load</code> in package CSTools.</p>
</td></tr>
<tr><td><code id="CST_AccumulationExceedingThreshold_+3A_threshold">threshold</code></td>
<td>
<p>If only one threshold is used, it can be an 's2dv_cube' 
object or a multidimensional array with named dimensions. It must be in the 
same units and with the common dimensions of the same length as parameter 
'data'. It can also be a vector with the same length of 'time_dim' from 
'data' or a scalar. If we want to use two thresholds: it can be a vector 
of two scalars, a list of two vectors with the same length of 
'time_dim' from 'data' or a list of two multidimensional arrays with the 
common dimensions of the same length as parameter 'data'. If two thresholds
are used, parameter 'op' must be also a vector of two elements.</p>
</td></tr>
<tr><td><code id="CST_AccumulationExceedingThreshold_+3A_op">op</code></td>
<td>
<p>An operator '&gt;' (by default), '&lt;', '&gt;=' or '&lt;='. If  two thresholds
are used it has to be a vector of a pair of two logical operators: 
c('&lt;', '&gt;'), c('&lt;', '&gt;='), c('&lt;=', '&gt;'), c('&lt;=', '&gt;='), c('&gt;', '&lt;'), 
c('&gt;', '&lt;='), c('&gt;=', '&lt;'),c('&gt;=', '&lt;=')).</p>
</td></tr>
<tr><td><code id="CST_AccumulationExceedingThreshold_+3A_diff">diff</code></td>
<td>
<p>A logical value indicating whether to accumulate the difference 
between data and threshold (TRUE) or not (FALSE by default). It can only be
TRUE if a unique threshold is used.</p>
</td></tr>
<tr><td><code id="CST_AccumulationExceedingThreshold_+3A_start">start</code></td>
<td>
<p>An optional parameter to define the initial date of the period
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is 
set to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_AccumulationExceedingThreshold_+3A_end">end</code></td>
<td>
<p>An optional parameter to define the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_AccumulationExceedingThreshold_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute the indicator. By default, it is set to 'time'. It can only
indicate one time dimension.</p>
</td></tr>
<tr><td><code id="CST_AccumulationExceedingThreshold_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether to ignore NA values (TRUE) 
or not (FALSE).</p>
</td></tr>
<tr><td><code id="CST_AccumulationExceedingThreshold_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An 's2dv_cube' object containing the aggregated values in the element
<code>data</code> with dimensions of the input parameter 'data' except the dimension
where the indicator has been computed. The 'Dates' array is updated to 
the dates corresponding to the beginning of the aggregated time period. A new 
element called 'time_bounds' will be added into the 'attrs' element in the 
's2dv_cube' object. It consists of a list containing two elements, the start 
and end dates of the aggregated period with the same dimensions of 'Dates' 
element.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exp &lt;- NULL
exp$data &lt;- array(abs(rnorm(5 * 3 * 214 * 2)*100), 
                 c(memb = 5, sdate = 3, time = 214, lon = 2)) 
class(exp) &lt;- 's2dv_cube'
Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
              as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
              as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
              as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(Dates) &lt;- c(sdate = 3, time = 214)
exp$attrs$Dates &lt;- Dates
AT &lt;- CST_AccumulationExceedingThreshold(data = exp, threshold = 100,
                                        start = list(21, 4), 
                                        end = list(21, 6))

</code></pre>

<hr>
<h2 id='CST_MergeRefToExp'>Merge a Reference To Experiments</h2><span id='topic+CST_MergeRefToExp'></span>

<h3>Description</h3>

<p>Some indicators are defined for specific temporal periods (e.g.: summer from 
June 21st to September 21st). If the initialization forecast date is later 
than the one required for the indicator (e.g.: July 1st), the user may want to 
merge past observations, or other references, to the forecast (or hindcast) to 
compute the indicator. If the forecast simulation doesn't cover the required
period because it is initialized too early (e.g.: Initialization on November
1st the forecast covers until the beginning of June next year), a climatology
(or other references) could be added at the end of the forecast lead time to 
cover the desired period (e.g.: until the end of summer).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CST_MergeRefToExp(
  data1,
  data2,
  start1 = NULL,
  end1 = NULL,
  start2 = NULL,
  end2 = NULL,
  time_dim = "time",
  memb_dim = "member",
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CST_MergeRefToExp_+3A_data1">data1</code></td>
<td>
<p>An 's2dv_cube' object with the element 'data' being a
multidimensional array with named dimensions. All dimensions must be 
equal to 'data2' dimensions except for the ones specified with 'memb_dim' 
and 'time_dim'. If 'start1' and 'end1' are used to subset a period, the
Dates must be stored in element '$attrs$Dates' of the object. Dates must 
have same time dimensions as element 'data'.</p>
</td></tr>
<tr><td><code id="CST_MergeRefToExp_+3A_data2">data2</code></td>
<td>
<p>An 's2dv_cube' object with the element 'data' being a 
multidimensional array of named dimensions matching the dimensions of 
parameter 'data1'. All dimensions must be equal to 'data1' except for the 
ones specified with 'memb_dim' and 'time_dim'. If 'start2' and 'end2' are 
used to subset a period, the Dates must be stored in element '$attrs$Dates' 
of the object. Dates must have same time dimensions as element 'data'.</p>
</td></tr>
<tr><td><code id="CST_MergeRefToExp_+3A_start1">start1</code></td>
<td>
<p>A list to define the initial date of the period to select from 
'data1' by providing a list of two elements: the initial date of the period 
and the initial month of the period.</p>
</td></tr>
<tr><td><code id="CST_MergeRefToExp_+3A_end1">end1</code></td>
<td>
<p>A list to define the final date of the period to select from 
'data1' by providing a list of two elements: the final day of the period and 
the final month of the period.</p>
</td></tr>
<tr><td><code id="CST_MergeRefToExp_+3A_start2">start2</code></td>
<td>
<p>A list to define the initial date of the period to select from 
'data2' by providing a list of two elements: the initial date of the period 
and the initial month of the period.</p>
</td></tr>
<tr><td><code id="CST_MergeRefToExp_+3A_end2">end2</code></td>
<td>
<p>A list to define the final date of the period to select from 
'data2' by providing a list of two elements: the final day of the period and 
the final month of the period.</p>
</td></tr>
<tr><td><code id="CST_MergeRefToExp_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension that will be used to combine the two arrays. By default, it is set 
to 'time'. Also, it will be used to subset the data in a requested 
period.</p>
</td></tr>
<tr><td><code id="CST_MergeRefToExp_+3A_memb_dim">memb_dim</code></td>
<td>
<p>A character string indicating the name of the member 
dimension. If the data are not ensemble ones, set as NULL. The default 
value is 'member'.</p>
</td></tr>
<tr><td><code id="CST_MergeRefToExp_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is created to merge observations and forecasts, known as the 
‘blending’ strategy (see references). The basis for this strategy is that the 
predictions are progressively replaced with observational data as soon as they 
become available (i.e., when entering the indicator definition period). This 
key strategy aims to increase users’ confidence in the reformed predictions.
</p>


<h3>Value</h3>

<p>An 's2dv_cube' object containing the indicator in the element 
<code>data</code>. The element <code>data</code> will be a multidimensional array created 
from the combination of 'data1' and 'data2'. The resulting array will contain 
the following dimensions: the original dimensions of the input data, which are 
common to both arrays and for the 'time_dim' dimension, the sum of the 
corresponding dimension of 'data1' and 'data2'. If 'memb_dim' is not null, 
regarding member dimension, two different situations can occur: (1) in the 
case that one of the arrays does not have member dimension or is equal to 1 
and the other array has multiple member dimension, the result will contain the 
repeated values of the array one up to the lenght of member dimension of array 
two; (2) in the case that both arrays have member dimension and is greater 
than 1, all combinations of member dimension will be returned. The other 
elements of the 's2dv_cube' will be updated with the combined information of 
both datasets.
</p>


<h3>References</h3>

<p>Chou, C., R. Marcos-Matamoros, L. Palma Garcia, N. Pérez-Zanón, 
M. Teixeira, S. Silva, N. Fontes, A. Graça, A. Dell'Aquila, S. Calmanti and 
N. González-Reviriego (2023). Advanced seasonal predictions for vine 
management based on bioclimatic indicators tailored to the wine sector. 
Climate Services, 30, 100343, doi: <a href="https://doi.org/10.1016/j.cliser.2023.100343">10.1016/j.cliser.2023.100343</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_dates &lt;- c(seq(as.Date("01-07-1993", "%d-%m-%Y", tz = 'UTC'),
                   as.Date("01-12-1993","%d-%m-%Y", tz = 'UTC'), "day"),
               seq(as.Date("01-07-1994", "%d-%m-%Y", tz = 'UTC'),
                   as.Date("01-12-1994","%d-%m-%Y", tz = 'UTC'), "day"))
dim(data_dates) &lt;- c(time = 154, sdate = 2)
data &lt;- NULL
data$data &lt;- array(1:(2*154*2), c(time = 154, sdate = 2, member = 2))
data$attrs$Dates&lt;- data_dates
class(data) &lt;- 's2dv_cube'
ref_dates &lt;- seq(as.Date("01-01-1993", "%d-%m-%Y", tz = 'UTC'),
                as.Date("01-12-1994","%d-%m-%Y", tz = 'UTC'), "day")
dim(ref_dates) &lt;- c(time = 350, sdate = 2)
ref &lt;- NULL
ref$data &lt;- array(1001:1700, c(time = 350, sdate = 2))
ref$attrs$Dates &lt;- ref_dates
class(ref) &lt;- 's2dv_cube'
new_data &lt;- CST_MergeRefToExp(data1 = ref, data2 = data, 
                             start1 = list(21, 6), end1 = list(30, 6),
                             start2 = list(1, 7), end2 = list(21, 9))

</code></pre>

<hr>
<h2 id='CST_PeriodAccumulation'>Period Accumulation on 's2dv_cube' objects</h2><span id='topic+CST_PeriodAccumulation'></span>

<h3>Description</h3>

<p>Period Accumulation computes the sum (accumulation) of a given variable in a 
period. Providing precipitation data, two agriculture indices can be obtained 
by using this function:
</p>

<ul>
<li><p>'SprR', Spring Total Precipitation: The total precipitation from 
April 21th to June 21st.
</p>
</li>
<li><p>'HarR', Harvest Total Precipitation: The total precipitation from 
August 21st to October 21st.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>CST_PeriodAccumulation(
  data,
  start = NULL,
  end = NULL,
  time_dim = "time",
  rollwidth = NULL,
  sdate_dim = "sdate",
  frequency = "monthly",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CST_PeriodAccumulation_+3A_data">data</code></td>
<td>
<p>An 's2dv_cube' object as provided function <code>CST_Start</code> or 
<code>CST_Load</code> in package CSTools.</p>
</td></tr>
<tr><td><code id="CST_PeriodAccumulation_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial m   onth of the period. By default it is 
set to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_PeriodAccumulation_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_PeriodAccumulation_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute the indicator. By default, it is set to 'time'. More than one 
dimension name matching the dimensions provided in the object 
<code>data$data</code> can be specified.</p>
</td></tr>
<tr><td><code id="CST_PeriodAccumulation_+3A_rollwidth">rollwidth</code></td>
<td>
<p>An optional parameter to indicate the number of time 
steps the rolling sum is applied to. If it is positive, the rolling sum is 
applied backwards 'time_dim', if it is negative, it will be forward it. When 
this parameter is NULL, the sum is applied over all 'time_dim', in a 
specified period. It is NULL by default.</p>
</td></tr>
<tr><td><code id="CST_PeriodAccumulation_+3A_sdate_dim">sdate_dim</code></td>
<td>
<p>(Only needed when rollwidth is used). A character string 
indicating the name of the start date dimension to compute the rolling 
accumulation. By default, it is set to 'sdate'.</p>
</td></tr>
<tr><td><code id="CST_PeriodAccumulation_+3A_frequency">frequency</code></td>
<td>
<p>(Only needed when rollwidth is used). A character string 
indicating the time frequency of the data to apply the rolling accumulation.  
It can be 'daily' or 'monthly'. If it is set to 'monthly', values from
continuous months will be accumulated; if it is 'daliy', values from 
continuous days will be accumulated. It is set to 'monthly' by default.</p>
</td></tr>
<tr><td><code id="CST_PeriodAccumulation_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether to ignore NA values (TRUE) or 
not (FALSE).</p>
</td></tr>
<tr><td><code id="CST_PeriodAccumulation_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two possible ways of performing the accumulation. The default one 
is by accumulating a variable over a dimension specified with 'time_dim'. To 
chose a specific time period, 'start' and 'end' must be used. The other method 
is by using 'rollwidth' parameter. When this parameter is a positive integer, 
the cumulative backward sum is applied to the time dimension. If it is 
negative, the rolling sum is applied backwards. This function is build to  
be compatible with other tools in that work with 's2dv_cube' object class. The 
input data must be this object class. If you don't work with 's2dv_cube', see 
PeriodAccumulation.
</p>


<h3>Value</h3>

<p>An 's2dv_cube' object containing the accumulated data in the element
<code>data</code>. If parameter 'rollwidth' is not used, it will have the dimensions
of the input parameter 'data' except the dimension where the accumulation has
been computed (specified with 'time_dim'). If 'rollwidth' is used, it will be 
of same dimensions as input data. The 'Dates' array is updated to the 
dates corresponding to the beginning of the aggregated time period. A new 
element called 'time_bounds' will be added into the 'attrs' element in the 
's2dv_cube' object. It consists of a list containing two elements, the start 
and end dates of the aggregated period with the same dimensions of 'Dates' 
element. If 'rollwidth' is used, it will contain the same dimensions of 
parameter 'data' and the other elements of the 's2dv_cube' will not be 
modified.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exp &lt;- NULL
exp$data &lt;- array(rnorm(216)*200, dim = c(dataset = 1, member = 2, sdate = 3, 
                 ftime = 9, lat = 2, lon = 2))
class(exp) &lt;- 's2dv_cube'
TP &lt;- CST_PeriodAccumulation(exp, time_dim = 'ftime')
exp$data &lt;- array(rnorm(5 * 3 * 214 * 2), 
                 c(memb = 5, sdate = 3, ftime = 214, lon = 2)) 
Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
              as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
              as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
              as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(Dates) &lt;- c(sdate = 3, ftime = 214)
exp$attrs$Dates &lt;- Dates
SprR &lt;- CST_PeriodAccumulation(exp, start = list(21, 4), end = list(21, 6),
                              time_dim = 'ftime')
dim(SprR$data)
head(SprR$attrs$Dates)
HarR &lt;- CST_PeriodAccumulation(exp, start = list(21, 8), end = list(21, 10),
                              time_dim = 'ftime')
dim(HarR$data)
head(HarR$attrs$Dates)

</code></pre>

<hr>
<h2 id='CST_PeriodMax'>Period Max on 's2dv_cube' objects</h2><span id='topic+CST_PeriodMax'></span>

<h3>Description</h3>

<p>Period Max computes the maximum (max) of a given variable in a period.
Two bioclimatic indicators can be obtained by using this function:
</p>

<ul>
<li><p>'BIO5', (Providing temperature data) Max Temperature of Warmest 
Month. The maximum monthly temperature occurrence over a 
given year (time-series) or averaged span of years (normal).
</p>
</li>
<li><p>'BIO13', (Providing precipitation data) Precipitation of Wettest 
Month. This index identifies the total precipitation 
that prevails during the wettest month.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>CST_PeriodMax(
  data,
  start = NULL,
  end = NULL,
  time_dim = "time",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CST_PeriodMax_+3A_data">data</code></td>
<td>
<p>An 's2dv_cube' object as provided function <code>CST_Start</code> or 
<code>CST_Load</code> in package CSTools.</p>
</td></tr>
<tr><td><code id="CST_PeriodMax_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_PeriodMax_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_PeriodMax_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute the indicator. By default, it is set to 'time'. More than one 
dimension name matching the dimensions provided in the object 
<code>data$data</code> can be specified.</p>
</td></tr>
<tr><td><code id="CST_PeriodMax_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether to ignore NA values (TRUE) or 
not (FALSE).</p>
</td></tr>
<tr><td><code id="CST_PeriodMax_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An 's2dv_cube' object containing the indicator in the element 
<code>data</code> with dimensions of the input parameter 'data' except the 
dimension where the max has been computed (specified with 'time_dim'). A new 
element called 'time_bounds' will be added into the 'attrs' element in the 
's2dv_cube' object. It consists of a list containing two elements, the start 
and end dates of the aggregated period with the same dimensions of 'Dates' 
element.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exp &lt;- NULL
exp$data &lt;- array(rnorm(45), dim = c(member = 7, sdate = 4, time = 3))
Dates &lt;- c(seq(as.Date("2000-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2001-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2001-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2002-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2002-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2003-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2003-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2004-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"))
dim(Dates) &lt;- c(sdate = 4, time = 3)
exp$attrs$Dates &lt;- Dates
class(exp) &lt;- 's2dv_cube'

res &lt;- CST_PeriodMax(exp, start = list(01, 12), end = list(01, 01))

</code></pre>

<hr>
<h2 id='CST_PeriodMean'>Period Mean on 's2dv_cube' objects</h2><span id='topic+CST_PeriodMean'></span>

<h3>Description</h3>

<p>Period Mean computes the average (mean) of a given variable in a period.
Providing temperature data, two agriculture indices can be obtained by using 
this function:
</p>

<ul>
<li><p>'GST', Growing Season average Temperature: The average temperature 
from April 1st to Octobe 31st.
</p>
</li>
<li><p>'SprTX', Spring Average Maximum Temperature: The average daily 
maximum temperature from April 1st to May 31st.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>CST_PeriodMean(
  data,
  start = NULL,
  end = NULL,
  time_dim = "time",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CST_PeriodMean_+3A_data">data</code></td>
<td>
<p>An 's2dv_cube' object as provided function <code>CST_Start</code> or 
<code>CST_Load</code> in package CSTools.</p>
</td></tr>
<tr><td><code id="CST_PeriodMean_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_PeriodMean_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_PeriodMean_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute the indicator. By default, it is set to 'time'. More than one 
dimension name matching the dimensions provided in the object 
<code>data$data</code> can be specified.</p>
</td></tr>
<tr><td><code id="CST_PeriodMean_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether to ignore NA values (TRUE) or 
not (FALSE).</p>
</td></tr>
<tr><td><code id="CST_PeriodMean_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An 's2dv_cube' object containing the indicator in the element 
<code>data</code> with dimensions of the input parameter 'data' except the 
dimension where the mean has been computed (specified with 'time_dim'). The 
'Dates' array is updated to the dates corresponding to the beginning of the 
aggregated time period. A new element called 'time_bounds' will be added into 
the 'attrs' element in the 's2dv_cube' object. It consists of a list 
containing two elements, the start and end dates of the aggregated period with 
the same dimensions of 'Dates' element.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exp &lt;- NULL
exp$data &lt;- array(rnorm(45), dim = c(member = 7, sdate = 4, time = 3))
Dates &lt;- c(seq(as.Date("2000-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2001-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2001-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2002-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2002-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2003-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2003-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2004-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"))
dim(Dates) &lt;- c(sdate = 4, time = 3)
exp$attrs$Dates &lt;- Dates
class(exp) &lt;- 's2dv_cube'

SA &lt;- CST_PeriodMean(exp, start = list(01, 12), end = list(01, 01))

</code></pre>

<hr>
<h2 id='CST_PeriodMin'>Period Min on 's2dv_cube' objects</h2><span id='topic+CST_PeriodMin'></span>

<h3>Description</h3>

<p>Period Min computes the average (min) of a given variable in a period.
Two bioclimatic indicators can be obtained by using this function:
</p>

<ul>
<li><p>'BIO6', (Providing temperature data) Min Temperature of Coldest  
Month. The minimum monthly temperature occurrence over a 
given year (time-series) or averaged span of years (normal).
</p>
</li>
<li><p>'BIO14', (Providing precipitation data) Precipitation of Driest  
Month. This index identifies the total precipitation 
that prevails during the driest month.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>CST_PeriodMin(
  data,
  start = NULL,
  end = NULL,
  time_dim = "time",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CST_PeriodMin_+3A_data">data</code></td>
<td>
<p>An 's2dv_cube' object as provided function <code>CST_Start</code> or 
<code>CST_Load</code> in package CSTools.</p>
</td></tr>
<tr><td><code id="CST_PeriodMin_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_PeriodMin_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_PeriodMin_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute the indicator. By default, it is set to 'time'. More than one 
dimension name matching the dimensions provided in the object 
<code>data$data</code> can be specified.</p>
</td></tr>
<tr><td><code id="CST_PeriodMin_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether to ignore NA values (TRUE) or 
not (FALSE).</p>
</td></tr>
<tr><td><code id="CST_PeriodMin_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An 's2dv_cube' object containing the indicator in the element 
<code>data</code> with dimensions of the input parameter 'data' except the 
dimension where the min has been computed (specified with 'time_dim'). A new 
element called 'time_bounds' will be added into the 'attrs' element in the 
's2dv_cube' object. It consists of a list containing two elements, the start 
and end dates of the aggregated period with the same dimensions of 'Dates' 
element.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exp &lt;- NULL
exp$data &lt;- array(rnorm(45), dim = c(member = 7, sdate = 4, time = 3))
Dates &lt;- c(seq(as.Date("2000-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2001-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2001-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2002-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2002-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2003-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2003-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2004-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"))
dim(Dates) &lt;- c(sdate = 4, time = 3)
exp$attrs$Dates &lt;- Dates
class(exp) &lt;- 's2dv_cube'

res &lt;- CST_PeriodMin(exp, start = list(01, 12), end = list(01, 01))

</code></pre>

<hr>
<h2 id='CST_PeriodPET'>Compute the Potential Evapotranspiration</h2><span id='topic+CST_PeriodPET'></span>

<h3>Description</h3>

<p>Compute the Potential evapotranspiration (PET) that is the amount of 
evaporation and transpiration that would occur if a sufficient water source 
were available. This function calculate PET according to the Thornthwaite, 
Hargreaves or Hargreaves-modified equations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CST_PeriodPET(
  data,
  pet_method = "hargreaves",
  time_dim = "syear",
  leadtime_dim = "time",
  lat_dim = "latitude",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CST_PeriodPET_+3A_data">data</code></td>
<td>
<p>A named list with the needed <code>s2dv_cube</code> objects containing 
the seasonal forecast experiment in the 'data' element for each variable. 
Specific variables are needed for each method used in computing the 
Potential Evapotranspiration (see parameter 'pet_method'). The accepted 
variable names are fixed in order to be recognized by the function. 
The accepted name corresponding to the Minimum Temperature is 'tmin', 
for Maximum Temperature is 'tmax', for Mean Temperature is 'tmean' and 
for Precipitation is 'pr'. The accepted variable names for each method are: 
For 'hargreaves': 'tmin' and 'tmax'; for 'hargreaves_modified' are 'tmin', 
'tmax' and 'pr'; for method 'thornthwaite' 'tmean' is required. The units 
for temperature variables ('tmin', 'tmax' and 'tmean') need to be in Celcius 
degrees; the units for precipitation ('pr') need to be in mm/month. 
Currently the function works only with monthly data from different years.</p>
</td></tr>
<tr><td><code id="CST_PeriodPET_+3A_pet_method">pet_method</code></td>
<td>
<p>A character string indicating the method used to compute 
the potential evapotranspiration. The accepted methods are:
'hargreaves' and 'hargreaves_modified', that require the data to have 
variables tmin and tmax; and 'thornthwaite', that requires variable 
'tmean'.</p>
</td></tr>
<tr><td><code id="CST_PeriodPET_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension. By default, it is set to 'syear'.</p>
</td></tr>
<tr><td><code id="CST_PeriodPET_+3A_leadtime_dim">leadtime_dim</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension. By default, it is set to 'time'.</p>
</td></tr>
<tr><td><code id="CST_PeriodPET_+3A_lat_dim">lat_dim</code></td>
<td>
<p>A character string indicating the name of the latitudinal 
dimension. By default it is set by 'latitude'.</p>
</td></tr>
<tr><td><code id="CST_PeriodPET_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether NA values should be removed 
from data. It is FALSE by default.</p>
</td></tr>
<tr><td><code id="CST_PeriodPET_+3A_ncores">ncores</code></td>
<td>
<p>An integer value indicating the number of cores to use in 
parallel computation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is build to be compatible with other tools in 
that work with 's2dv_cube' object class. The input data must be this object 
class. If you don't work with 's2dv_cube', see PeriodPET. For more information 
on the SPEI calculation, see functions CST_PeriodStandardization and 
CST_PeriodAccumulation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dims &lt;- c(time = 3, syear = 3, ensemble = 1, latitude = 1)
exp_tasmax &lt;- array(rnorm(360, 27.73, 5.26), dim = dims)
exp_tasmin &lt;- array(rnorm(360, 14.83, 3.86), dim = dims)
exp_prlr &lt;- array(rnorm(360, 21.19, 25.64), dim = dims)
end_year &lt;- 2012
dates_exp &lt;- as.POSIXct(c(paste0(2010:end_year, "-08-16"), 
                         paste0(2010:end_year, "-09-15"), 
                         paste0(2010:end_year, "-10-16")), "UTC")
dim(dates_exp) &lt;- c(syear = 3, time = 3)
lat &lt;- c(40)
exp1 &lt;- list('tmax' = exp_tasmax, 'tmin' = exp_tasmin, 'pr' = exp_prlr)
res &lt;- PeriodPET(data = exp1, lat = lat, dates = dates_exp)

</code></pre>

<hr>
<h2 id='CST_PeriodStandardization'>Compute the Standardization of Precipitation-Evapotranspiration Index</h2><span id='topic+CST_PeriodStandardization'></span>

<h3>Description</h3>

<p>The Standardization of the data is the last step of computing the SPEI 
(Standarized Precipitation-Evapotranspiration Index). With this function the 
data is fit to a probability distribution to transform the original values to 
standardized units that are comparable in space and time and at different SPEI 
time scales.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CST_PeriodStandardization(
  data,
  data_cor = NULL,
  time_dim = "syear",
  leadtime_dim = "time",
  memb_dim = "ensemble",
  ref_period = NULL,
  handle_infinity = FALSE,
  method = "parametric",
  distribution = "log-Logistic",
  params = NULL,
  return_params = FALSE,
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CST_PeriodStandardization_+3A_data">data</code></td>
<td>
<p>An 's2dv_cube' that element 'data' stores a multidimensional 
array containing the data to be standardized.</p>
</td></tr>
<tr><td><code id="CST_PeriodStandardization_+3A_data_cor">data_cor</code></td>
<td>
<p>An 's2dv_cube' that element 'data' stores a multidimensional 
array containing the data in which the standardization should be applied 
using the fitting parameters from 'data'.</p>
</td></tr>
<tr><td><code id="CST_PeriodStandardization_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension. By default, it is set to 'syear'.</p>
</td></tr>
<tr><td><code id="CST_PeriodStandardization_+3A_leadtime_dim">leadtime_dim</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension. By default, it is set to 'time'.</p>
</td></tr>
<tr><td><code id="CST_PeriodStandardization_+3A_memb_dim">memb_dim</code></td>
<td>
<p>A character string indicating the name of the dimension in 
which the ensemble members are stored. When set it to NULL, threshold is 
computed for individual members.</p>
</td></tr>
<tr><td><code id="CST_PeriodStandardization_+3A_ref_period">ref_period</code></td>
<td>
<p>A list with two numeric values with the starting and end 
points of the reference period used for computing the index. The default 
value is NULL indicating that the first and end values in data will be 
used as starting and end points.</p>
</td></tr>
<tr><td><code id="CST_PeriodStandardization_+3A_handle_infinity">handle_infinity</code></td>
<td>
<p>A logical value wether to return infinite values (TRUE)
or not (FALSE). When it is TRUE, the positive infinite values (negative 
infinite) are substituted by the maximum (minimum) values of each 
computation step, a subset of the array of dimensions time_dim, leadtime_dim 
and memb_dim.</p>
</td></tr>
<tr><td><code id="CST_PeriodStandardization_+3A_method">method</code></td>
<td>
<p>A character string indicating the standardization method used. 
If can be: 'parametric' or 'non-parametric'. It is set to 'parametric' by 
default.</p>
</td></tr>
<tr><td><code id="CST_PeriodStandardization_+3A_distribution">distribution</code></td>
<td>
<p>A character string indicating the name of the distribution 
function to be used for computing the SPEI. The accepted names are: 
'log-Logistic' and 'Gamma'. It is set to 'log-Logistic' by default. The 
'Gamma' method only works when only precipitation is provided and other 
variables are 0 because it is positive defined (SPI indicator).</p>
</td></tr>
<tr><td><code id="CST_PeriodStandardization_+3A_params">params</code></td>
<td>
<p>An optional parameter that needs to be a multidimensional array 
with named dimensions. This option overrides computation of fitting 
parameters. It needs to be of same time dimensions (specified in 'time_dim' 
and 'leadtime_dim') of 'data' and a dimension named 'coef' with the length 
of the coefficients needed for the used distribution (for 'Gamma' coef 
dimension is of lenght 2, for 'log-Logistic' is of length 3). It also needs 
to have a leadtime dimension (specified in 'leadtime_dim') of length 1. It 
will only be used if 'data_cor' is not provided.</p>
</td></tr>
<tr><td><code id="CST_PeriodStandardization_+3A_return_params">return_params</code></td>
<td>
<p>A logical value indicating wether to return parameters 
array (TRUE) or not (FALSE). It is FALSE by default.</p>
</td></tr>
<tr><td><code id="CST_PeriodStandardization_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether NA values should be removed 
from data. It is FALSE by default. If it is FALSE and there are NA values, 
standardization cannot be carried out for those coordinates and therefore, 
the result will be filled with NA for the specific coordinates. If it is 
TRUE, if the data from other dimensions except time_dim and leadtime_dim is 
not reaching 4 values, it is not enough values to estimate the parameters 
and the result will include NA.</p>
</td></tr>
<tr><td><code id="CST_PeriodStandardization_+3A_ncores">ncores</code></td>
<td>
<p>An integer value indicating the number of cores to use in 
parallel computation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Next, some specifications for the calculation of the standardization will be 
discussed. If there are NAs in the data and they are not removed with the 
parameter 'na.rm', the standardization cannot be carried out for those 
coordinates and therefore, the result will be filled with NA for the 
specific coordinates. When NAs are not removed, if the length of the data for 
a computational step is smaller than 4, there will not be enough data for 
standarize and the result will be also filled with NAs for that coordinates. 
About the distribution used to fit the data, there are only two possibilities: 
'log-logistic' and 'Gamma'. The 'Gamma' method only works when only 
precipitation is provided and other variables are 0 because it is positive 
defined (SPI indicator). When only 'data' is provided ('data_cor' is NULL) the 
standardization is computed with cross validation. This function is build to 
be compatible with other tools in that work with 's2dv_cube' object 
class. The input data must be this object class. If you don't work with 
's2dv_cube', see PeriodStandardization. For more information on the SPEI 
indicator calculation, see CST_PeriodPET and CST_PeriodAccumulation.
</p>


<h3>Value</h3>

<p>An object of class <code>s2dv_cube</code> containing the standardized data. 
If 'data_cor' is provided the array stored in element data will be of the same 
dimensions as 'data_cor'. If 'data_cor' is not provided, the array stored in 
element data will be of the same dimensions as 'data'. The parameters of the 
standardization will only be returned if 'return_params' is TRUE, in this 
case, the output will be a list of two objects one for the standardized data 
and one for the parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dims &lt;-  c(syear = 6, time = 3, latitude = 2, ensemble = 25)
data &lt;- NULL
data$data &lt;- array(rnorm(600, -204.1, 78.1), dim = dims)
class(data) &lt;- 's2dv_cube'
SPEI &lt;- CST_PeriodStandardization(data = data)
</code></pre>

<hr>
<h2 id='CST_PeriodVariance'>Period Variance on 's2dv_cube' objects</h2><span id='topic+CST_PeriodVariance'></span>

<h3>Description</h3>

<p>Period Variance computes the average (var) of a given variable in a period.
Two bioclimatic indicators can be obtained by using this function:
</p>

<ul>
<li><p>'BIO4', (Providing temperature data) Temperature Seasonality 
(Standard Deviation). The amount of temperature variation  
over a given year (or averaged years) based on the standard 
deviation (variation) of monthly temperature averages.
</p>
</li>
<li><p>'BIO15', (Providing precipitation data) Precipitation Seasonality 
(CV). This is a measure of the variation in monthly precipitation 
totals over the course of the year. This index is the ratio of the 
standard deviation of the monthly total precipitation to the mean 
monthly total precipitation (also known as the coefficient of 
variation) and is expressed as a percentage.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>CST_PeriodVariance(
  data,
  start = NULL,
  end = NULL,
  time_dim = "time",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CST_PeriodVariance_+3A_data">data</code></td>
<td>
<p>An 's2dv_cube' object as provided function <code>CST_Start</code> or 
<code>CST_Load</code> in package CSTools.</p>
</td></tr>
<tr><td><code id="CST_PeriodVariance_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_PeriodVariance_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_PeriodVariance_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute the indicator. By default, it is set to 'time'. More than one 
dimension name matching the dimensions provided in the object 
<code>data$data</code> can be specified.</p>
</td></tr>
<tr><td><code id="CST_PeriodVariance_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether to ignore NA values (TRUE) or 
not (FALSE).</p>
</td></tr>
<tr><td><code id="CST_PeriodVariance_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An 's2dv_cube' object containing the indicator in the element 
<code>data</code> with dimensions of the input parameter 'data' except the 
dimension where the var has been computed (specified with 'time_dim'). A new 
element called 'time_bounds' will be added into the 'attrs' element in the 
's2dv_cube' object. It consists of a list containing two elements, the start 
and end dates of the aggregated period with the same dimensions of 'Dates' 
element.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exp &lt;- NULL
exp$data &lt;- array(rnorm(45), dim = c(member = 7, sdate = 4, time = 3))
Dates &lt;- c(seq(as.Date("2000-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2001-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2001-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2002-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2002-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2003-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2003-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2004-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"))
dim(Dates) &lt;- c(sdate = 4, time = 3)
exp$attrs$Dates &lt;- Dates
class(exp) &lt;- 's2dv_cube'

res &lt;- CST_PeriodVariance(exp, start = list(01, 12), end = list(01, 01))

</code></pre>

<hr>
<h2 id='CST_QThreshold'>Transform an absolute threshold into probabilities</h2><span id='topic+CST_QThreshold'></span>

<h3>Description</h3>

<p>From the user's perspective, an absolute threshold can be very useful for a 
specific needs (e.g.: grape variety). However, this absolute threshold could 
be transformed to a relative threshold in order to get its frequency in a given 
dataset. Therefore, the function <code>QThreshold</code> returns the probability of 
an absolute threshold. This is done by computing the Cumulative Distribution 
Function of a sample and leaving one out. The sample used will depend on the 
dimensions of the data provided and the dimension names provided in sdate_dim 
and memb_dim parameters:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CST_QThreshold(
  data,
  threshold,
  start = NULL,
  end = NULL,
  time_dim = "time",
  memb_dim = "member",
  sdate_dim = "sdate",
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CST_QThreshold_+3A_data">data</code></td>
<td>
<p>An 's2dv_cube' object as provided function <code>CST_Start</code> or 
<code>CST_Load</code> in package CSTools.</p>
</td></tr>
<tr><td><code id="CST_QThreshold_+3A_threshold">threshold</code></td>
<td>
<p>An 's2dv_cube' object as output of a 'CST_' function in the 
same units as parameter 'data' and with the common dimensions of the element
'data' of the same length. A single scalar is also possible.</p>
</td></tr>
<tr><td><code id="CST_QThreshold_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_QThreshold_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_QThreshold_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension. By default, it is set to 'time'. More than one dimension name 
matching the dimensions provided in the object <code>data$data</code> can be 
specified. This dimension is required to subset the data in a requested 
period.</p>
</td></tr>
<tr><td><code id="CST_QThreshold_+3A_memb_dim">memb_dim</code></td>
<td>
<p>A character string indicating the name of the dimension in 
which the ensemble members are stored.</p>
</td></tr>
<tr><td><code id="CST_QThreshold_+3A_sdate_dim">sdate_dim</code></td>
<td>
<p>A character string indicating the name of the dimension in 
which the initialization dates are stored.</p>
</td></tr>
<tr><td><code id="CST_QThreshold_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p>If a forecast (hindcast) has dimensions member and start date, and
both must be used in the sample, their names should be passed in 
sdate_dim and memb_dim.
</p>
</li>
<li><p>If a forecast (hindcast) has dimensions member and start date, and
only start date must be used in the sample (the calculation is done in
each separate member), memb_dim can be set to NULL.
</p>
</li>
<li><p>If a reference (observations) has start date dimension, the sample
used is the start date dimension.
</p>
</li>
<li><p>If a reference (observations) doesn't have start date dimension, 
the sample used must be especified in sdate_dim parameter.
</p>
</li></ul>



<h3>Value</h3>

<p>An 's2dv_cube' object containing the probability of an absolute 
threshold in the element <code>data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>threshold &lt;- 26
exp &lt;- NULL
exp$data &lt;- array(abs(rnorm(112)*26), dim = c(member = 7, sdate = 8, time = 2))
class(exp) &lt;- 's2dv_cube'
exp_probs &lt;- CST_QThreshold(exp, threshold)

exp$data &lt;- array(abs(rnorm(5 * 3 * 214 * 2)*50),
                 c(member = 5, sdate = 3, time = 214, lon = 2)) 
exp$attrs$Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
                        as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
                    seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
                        as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
                    seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
                        as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(exp$attrs$Dates) &lt;- c(sdate = 3, time = 214)
class(exp) &lt;- 's2dv_cube'
exp_probs &lt;- CST_QThreshold(exp, threshold, start = list(21, 4), 
                           end = list(21, 6))

</code></pre>

<hr>
<h2 id='CST_SelectPeriodOnData'>Select a period on Data on 's2dv_cube' objects</h2><span id='topic+CST_SelectPeriodOnData'></span>

<h3>Description</h3>

<p>Auxiliary function to subset data for a specific period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CST_SelectPeriodOnData(data, start, end, time_dim = "time", ncores = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CST_SelectPeriodOnData_+3A_data">data</code></td>
<td>
<p>An 's2dv_cube' object as provided function <code>CST_Start</code> or 
<code>CST_Load</code> in package CSTools.</p>
</td></tr>
<tr><td><code id="CST_SelectPeriodOnData_+3A_start">start</code></td>
<td>
<p>A parameter to defined the initial date of the period to select 
from the data by providing a list of two elements: the initial date of the 
period and the initial month of the period.</p>
</td></tr>
<tr><td><code id="CST_SelectPeriodOnData_+3A_end">end</code></td>
<td>
<p>A parameter to defined the final date of the period to select from 
the data by providing a list of two elements: the final day of the period 
and the final month of the period.</p>
</td></tr>
<tr><td><code id="CST_SelectPeriodOnData_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute select the dates. By default, it is set to 'time'. More than one 
dimension name matching the dimensions provided in the object 
<code>data$data</code> can be specified.</p>
</td></tr>
<tr><td><code id="CST_SelectPeriodOnData_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 's2dv_cube' object containing the subset of the object 
<code>data$data</code> during the period requested from <code>start</code> to <code>end</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exp &lt;- NULL
exp$data &lt;- array(rnorm(5 * 3 * 214 * 2),
                 c(memb = 5, sdate = 3, time = 214, lon = 2)) 
exp$attrs$Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
                        as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
                    seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
                        as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
                    seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
                        as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(exp$attrs$Dates) &lt;- c(time = 214, sdate = 3)
class(exp) &lt;- 's2dv_cube'
Period &lt;- CST_SelectPeriodOnData(exp, start = list(21, 6), end = list(21, 9))
</code></pre>

<hr>
<h2 id='CST_Threshold'>Absolute value of a relative threshold (percentile)</h2><span id='topic+CST_Threshold'></span>

<h3>Description</h3>

<p>Frequently, thresholds are defined by a percentile that may correspond to a 
different absolute value depending on the variable, gridpoint and also julian 
day (time). This function calculates the corresponding value of a percentile 
given a dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CST_Threshold(
  data,
  threshold,
  start = NULL,
  end = NULL,
  time_dim = "time",
  memb_dim = "member",
  sdate_dim = "sdate",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CST_Threshold_+3A_data">data</code></td>
<td>
<p>An 's2dv_cube' object as provided function <code>CST_Start</code> or 
<code>CST_Load</code> in package CSTools.</p>
</td></tr>
<tr><td><code id="CST_Threshold_+3A_threshold">threshold</code></td>
<td>
<p>A single scalar or vector indicating the relative 
threshold(s). It must contain values between 0 and 1.</p>
</td></tr>
<tr><td><code id="CST_Threshold_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period 
to selectfrom the data by providing a list of two elements: the initial date
of the period and the initial month of the period. By default it is set to 
NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_Threshold_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_Threshold_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension. By default, it is set to 'time'. More than one dimension name 
matching the dimensions provided in the object <code>data$data</code> can be 
specified. This dimension is required to subset the data in a requested 
period.</p>
</td></tr>
<tr><td><code id="CST_Threshold_+3A_memb_dim">memb_dim</code></td>
<td>
<p>A character string indicating the name of the dimension in 
which the ensemble members are stored. When set it to NULL, threshold is 
computed for individual members.</p>
</td></tr>
<tr><td><code id="CST_Threshold_+3A_sdate_dim">sdate_dim</code></td>
<td>
<p>A character string indicating the name of the dimension in 
which the initialization dates are stored.</p>
</td></tr>
<tr><td><code id="CST_Threshold_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether to ignore NA values (TRUE) or 
not (FALSE).</p>
</td></tr>
<tr><td><code id="CST_Threshold_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An ’s2dv_cube’ object containing the corresponding values of a
percentile in the element <code>data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>threshold &lt;- 0.9
exp &lt;- NULL
exp$data &lt;- array(rnorm(5 * 3 * 214 * 2),
                 c(member = 5, sdate = 3, time = 214, lon = 2)) 
exp$attrs$Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
                        as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
                    seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
                        as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
                    seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
                        as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(exp$attrs$Dates) &lt;- c(sdate = 3, time = 214)
class(exp) &lt;- 's2dv_cube'
exp_probs &lt;- CST_Threshold(exp, threshold, start = list(21, 4), end = list(21, 6))

</code></pre>

<hr>
<h2 id='CST_TotalSpellTimeExceedingThreshold'>Total Spell Time Exceeding Threshold</h2><span id='topic+CST_TotalSpellTimeExceedingThreshold'></span>

<h3>Description</h3>

<p>The number of days (when daily data is provided) that are part of a spell 
(defined by its minimum length e.g. 6 consecutive days) that exceed (or not 
exceed) a threshold are calculated with <code>TotalSpellTimeExceedingThreshold</code>.
This function allows to compute indicators widely used in Climate Services, 
such as:
</p>

<ul>
<li><p>'WSDI', Warm Spell Duration Index that count the total number of days 
with at least 6 consecutive days when the daily temperature 
maximum exceeds its 90th percentile.
</p>
</li></ul>

<p>This function requires the data and the threshold to be in the same units. The 
90th percentile can be translate into absolute values given a reference dataset 
using function <code>Threshold</code> or the data can be transform into probabilites 
by using function <code>AbsToProbs</code>. See section @examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CST_TotalSpellTimeExceedingThreshold(
  data,
  threshold,
  spell,
  op = "&gt;",
  start = NULL,
  end = NULL,
  time_dim = "time",
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CST_TotalSpellTimeExceedingThreshold_+3A_data">data</code></td>
<td>
<p>An 's2dv_cube' object as provided function <code>CST_Start</code> or 
<code>CST_Load</code> in package CSTools.</p>
</td></tr>
<tr><td><code id="CST_TotalSpellTimeExceedingThreshold_+3A_threshold">threshold</code></td>
<td>
<p>If only one threshold is used, it can be an 's2dv_cube' 
object or a multidimensional array with named dimensions. It must be in the 
same units and with the common dimensions of the same length as parameter 
'data'. It can also be a vector with the same length of 'time_dim' from 
'data' or a scalar. If we want to use two thresholds: it can be a vector 
of two scalars, a list of two vectors with the same length of 
'time_dim' from 'data' or a list of two multidimensional arrays with the 
common dimensions of the same length as parameter 'data'. If two thresholds
are used, parameter 'op' must be also a vector of two elements.</p>
</td></tr>
<tr><td><code id="CST_TotalSpellTimeExceedingThreshold_+3A_spell">spell</code></td>
<td>
<p>A scalar indicating the minimum length of the spell.</p>
</td></tr>
<tr><td><code id="CST_TotalSpellTimeExceedingThreshold_+3A_op">op</code></td>
<td>
<p>An operator '&gt;' (by default), '&lt;', '&gt;=' or '&lt;='. If  two thresholds
are used it has to be a vector of a pair of two logical operators: 
c('&lt;', '&gt;'), c('&lt;', '&gt;='), c('&lt;=', '&gt;'), c('&lt;=', '&gt;='), c('&gt;', '&lt;'), 
c('&gt;', '&lt;='), c('&gt;=', '&lt;'),c('&gt;=', '&lt;=')).</p>
</td></tr>
<tr><td><code id="CST_TotalSpellTimeExceedingThreshold_+3A_start">start</code></td>
<td>
<p>An optional parameter to define the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_TotalSpellTimeExceedingThreshold_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_TotalSpellTimeExceedingThreshold_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute the indicator. By default, it is set to 'time'. It can only
indicate one time dimension.</p>
</td></tr>
<tr><td><code id="CST_TotalSpellTimeExceedingThreshold_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An 's2dv_cube' object containing the number of days that are part of a
spell within a threshold in element <code>data</code> with dimensions of the input 
parameter 'data' except the dimension where the indicator has been computed.
The 'Dates' array is updated to the dates corresponding to the beginning of 
the aggregated time period. A new element called 'time_bounds' will be added  
into the 'attrs' element in the 's2dv_cube' object. It consists of a list 
containing two elements, the start and end dates of the aggregated period with 
the same dimensions of 'Dates' element.
</p>


<h3>See Also</h3>

<p>[Threshold()] and [AbsToProbs()].
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exp &lt;- NULL
exp$data &lt;- array(rnorm(5 * 3 * 214 * 2)*23,
                 c(member = 5, sdate = 3, time = 214, lon = 2)) 
exp$attrs$Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
                        as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
                    seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
                        as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
                    seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
                        as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(exp$attrs$Dates) &lt;- c(sdate = 3, time = 214)
class(exp) &lt;- 's2dv_cube'
TTSET &lt;- CST_TotalSpellTimeExceedingThreshold(exp, threshold = 23, spell = 3,
                                             start = list(21, 4), 
                                             end = list(21, 6))

</code></pre>

<hr>
<h2 id='CST_TotalTimeExceedingThreshold'>Total Time of a variable Exceeding (not exceeding) a Threshold</h2><span id='topic+CST_TotalTimeExceedingThreshold'></span>

<h3>Description</h3>

<p>The Total Time of a variable exceeding (or not) a Threshold. It returns the  
total number of days (if the data provided is daily, or the corresponding  
units of the data frequency) that a variable is exceeding a threshold 
during a period. The threshold provided must be in the same units as the 
variable units, i.e. to use a percentile as a scalar, the function 
<code>AbsToProbs</code> or <code>QThreshold</code>  may be needed (see examples). 
Providing maximum temperature daily data, the following agriculture 
indices for heat stress can be obtained by using this function:
</p>

<ul>
<li><p>'SU35', Total count of days when daily maximum temperatures exceed 
35°C in the seven months from the start month given (e.g. from April 
to October for start month of April).
</p>
</li>
<li><p>'SU36', Total count of days when daily maximum temperatures exceed 
36 between June 21st and September 21st.
</p>
</li>
<li><p>'SU40', Total count of days when daily maximum temperatures exceed 
40 between June 21st and September 21st.
</p>
</li>
<li><p>'Spr32', Total count of days when daily maximum temperatures exceed
32 between April 21st and June 21st.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>CST_TotalTimeExceedingThreshold(
  data,
  threshold,
  op = "&gt;",
  start = NULL,
  end = NULL,
  time_dim = "time",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CST_TotalTimeExceedingThreshold_+3A_data">data</code></td>
<td>
<p>An 's2dv_cube' object as provided function <code>CST_Start</code> or 
<code>CST_Load</code> in package CSTools.</p>
</td></tr>
<tr><td><code id="CST_TotalTimeExceedingThreshold_+3A_threshold">threshold</code></td>
<td>
<p>If only one threshold is used, it can be an 's2dv_cube' 
object or a multidimensional array with named dimensions. It must be in the 
same units and with the common dimensions of the same length as parameter 
'data'. It can also be a vector with the same length of 'time_dim' from 
'data' or a scalar. If we want to use two thresholds: it can be a vector 
of two scalars, a list of two vectors with the same length of 
'time_dim' from 'data' or a list of two multidimensional arrays with the 
common dimensions of the same length as parameter 'data'. If two thresholds
are used, parameter 'op' must be also a vector of two elements.</p>
</td></tr>
<tr><td><code id="CST_TotalTimeExceedingThreshold_+3A_op">op</code></td>
<td>
<p>An operator '&gt;' (by default), '&lt;', '&gt;=' or '&lt;='. If  two thresholds
are used it has to be a vector of a pair of two logical operators: 
c('&lt;', '&gt;'), c('&lt;', '&gt;='), c('&lt;=', '&gt;'), c('&lt;=', '&gt;='), c('&gt;', '&lt;'), 
c('&gt;', '&lt;='), c('&gt;=', '&lt;'),c('&gt;=', '&lt;=')).</p>
</td></tr>
<tr><td><code id="CST_TotalTimeExceedingThreshold_+3A_start">start</code></td>
<td>
<p>An optional parameter to define the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_TotalTimeExceedingThreshold_+3A_end">end</code></td>
<td>
<p>An optional parameter to define the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_TotalTimeExceedingThreshold_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute the indicator. By default, it is set to 'time'. It can only
indicate one time dimension.</p>
</td></tr>
<tr><td><code id="CST_TotalTimeExceedingThreshold_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether to ignore NA values (TRUE) or 
not (FALSE).</p>
</td></tr>
<tr><td><code id="CST_TotalTimeExceedingThreshold_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An 's2dv_cube' object containing in element <code>data</code> the total 
number of the corresponding units of the data frequency that a variable is 
exceeding a threshold during a period with dimensions of the input parameter 
'data' except the dimension where the indicator has been computed. The 
'Dates' array is updated to the dates corresponding to the beginning of the 
aggregated time period. A new element called 'time_bounds' will be added into 
the 'attrs' element in the 's2dv_cube' object. It consists of a list 
containing two elements, the start and end dates of the aggregated period with 
the same dimensions of 'Dates' element.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exp &lt;- NULL
exp$data &lt;- array(rnorm(5 * 3 * 214 * 2)*23,
                 c(member = 5, sdate = 3, time = 214, lon = 2)) 
exp$attrs$Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
                        as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
                    seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
                        as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
                    seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
                        as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(exp$attrs$Dates) &lt;- c(sdate = 3, time = 214)
class(exp) &lt;- 's2dv_cube'
DOT &lt;- CST_TotalTimeExceedingThreshold(exp, threshold = 23, start = list(21, 4), 
                                      end = list(21, 6))

</code></pre>

<hr>
<h2 id='CST_WindCapacityFactor'>Wind capacity factor on s2dv_cube objects</h2><span id='topic+CST_WindCapacityFactor'></span>

<h3>Description</h3>

<p>Wind capacity factor computes the wind power generated by a 
specific wind turbine model under specific wind speed conditions, and 
expresses it as a fraction of the rated capacity (i.e. maximum power) of the 
turbine.
</p>
<p>It is computed by means of a tabular power curve that relates 
wind speed to power output. The tabular values are interpolated with a linear 
piecewise approximating function to obtain a smooth power curve. Five 
different power curves that span different IEC classes can be selected (see 
below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CST_WindCapacityFactor(
  wind,
  IEC_class = c("I", "I/II", "II", "II/III", "III"),
  start = NULL,
  end = NULL,
  time_dim = "time",
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CST_WindCapacityFactor_+3A_wind">wind</code></td>
<td>
<p>An s2dv_cube object with instantaneous wind speeds expressed in m/s.</p>
</td></tr>
<tr><td><code id="CST_WindCapacityFactor_+3A_iec_class">IEC_class</code></td>
<td>
<p>A string indicating the IEC wind class (see IEC 61400-1) of 
the turbine to be selected. Classes <code>'I'</code>, <code>'II'</code> and <code>'III'</code>
are suitable for sites with an annual mean wind speed of 10, 8.5 and 7.5 m/s 
respectively. Classes <code>'I/II'</code> and <code>'II/III'</code> indicate 
intermediate turbines that fit both classes. More details of the five 
turbines and a plot of its power curves can be found in Lledó et al. (2019).</p>
</td></tr>
<tr><td><code id="CST_WindCapacityFactor_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_WindCapacityFactor_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to
select from the data by providing a list of two elements: the final day of
the period and the final month of the period. By default it is set to NULL
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_WindCapacityFactor_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to
compute the indicator. By default, it is set to 'time'. More than one
dimension name matching the dimensions provided in the object
<code>data$data</code> can be specified.</p>
</td></tr>
<tr><td><code id="CST_WindCapacityFactor_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel
computation for temporal subsetting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An s2dv_cube object containing the Wind Capacity Factor (unitless).
</p>


<h3>Author(s)</h3>

<p>Llorenç Lledó, <a href="mailto:llledo@bsc.es">llledo@bsc.es</a>
</p>


<h3>References</h3>

<p>Lledó, Ll., Torralba, V., Soret, A., Ramon, J., &amp; Doblas-Reyes, 
F. J. (2019). Seasonal forecasts of wind power generation. 
Renewable Energy, 143, 91–100. https://doi.org/10.1016/j.renene.2019.04.135
</p>
<p>International Standard IEC 61400-1 (third ed.) (2005)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wind &lt;- NULL
wind$data &lt;- array(rweibull(n = 100, shape = 2, scale = 6), 
                  c(member = 5, sdate = 3, time = 214, lon = 2, lat = 5))
wind$coords &lt;- list(lat =  c(40, 41), lon = 1:5)
variable &lt;- list(varName = 'sfcWind', 
                metadata = list(sfcWind = list(level = 'Surface')))
wind$attrs &lt;- list(Variable = variable, Datasets = 'synthetic', 
                  when = Sys.time(), Dates = '1990-01-01 00:00:00')
Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
                        as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
                    seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
                        as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
                    seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
                        as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(Dates) &lt;- c(sdate = 3, time = 214)
wind$attrs$Dates &lt;- Dates
class(wind) &lt;- 's2dv_cube'
WCF &lt;- CST_WindCapacityFactor(wind, IEC_class = "III", 
                             start = list(21, 4), end = list(21, 6))

</code></pre>

<hr>
<h2 id='CST_WindPowerDensity'>Wind power density on s2dv_cube objects</h2><span id='topic+CST_WindPowerDensity'></span>

<h3>Description</h3>

<p>Wind Power Density computes the wind power that is available for 
extraction per square meter of swept area.
</p>
<p>It is computed as 0.5*ro*wspd^3. As this function is non-linear, 
it will give inaccurate results if used with period means.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CST_WindPowerDensity(
  wind,
  ro = 1.225,
  start = NULL,
  end = NULL,
  time_dim = "time",
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CST_WindPowerDensity_+3A_wind">wind</code></td>
<td>
<p>An 's2dv_cube' object with instantaneous wind speeds expressed in 
m/s obtained from CST_Start or s2dv_cube functions from CSTools pacakge.</p>
</td></tr>
<tr><td><code id="CST_WindPowerDensity_+3A_ro">ro</code></td>
<td>
<p>A scalar, or alternatively a multidimensional array with the same
dimensions as wind, with the air density expressed in kg/m^3. By default it
takes the value 1.225, the standard density of air at 15ºC and 1013.25 hPa.</p>
</td></tr>
<tr><td><code id="CST_WindPowerDensity_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period
to select from the data by providing a list of two elements: the initial
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in
<code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_WindPowerDensity_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to
select from the data by providing a list of two elements: the final day of
the period and the final month of the period. By default it is set to NULL
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="CST_WindPowerDensity_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to
compute the indicator. By default, it is set to 'time'. More than one
dimension name matching the dimensions provided in the object
<code>data$data</code> can be specified.</p>
</td></tr>
<tr><td><code id="CST_WindPowerDensity_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel
computation for temporal subsetting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An s2dv_cube object containing Wind Power Density expressed in W/m^2.
</p>


<h3>Author(s)</h3>

<p>Llorenç Lledó, <a href="mailto:llledo@bsc.es">llledo@bsc.es</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wind &lt;- NULL
wind$data &lt;- array(rweibull(n = 100, shape = 2, scale = 6), 
                  c(member = 5, sdate = 3, time = 214, lon = 2, lat = 5))
wind$coords &lt;- list(lat =  c(40, 41), lon = 1:5)
variable &lt;- list(varName = 'sfcWind', 
                metadata = list(sfcWind = list(level = 'Surface')))
wind$attrs &lt;- list(Variable = variable, Datasets = 'synthetic', 
                  when = Sys.time(), Dates = '1990-01-01 00:00:00')
Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
                        as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
                    seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
                        as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
                    seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
                        as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(Dates) &lt;- c(sdate = 3, time = 214)
wind$attrs$Dates &lt;- Dates
class(wind) &lt;- 's2dv_cube'
WPD &lt;- CST_WindPowerDensity(wind, start = list(21, 4), 
                           end = list(21, 6))

</code></pre>

<hr>
<h2 id='MergeRefToExp'>Merge a Reference To Experiments</h2><span id='topic+MergeRefToExp'></span>

<h3>Description</h3>

<p>Some indicators are defined for specific temporal periods (e.g.: summer from 
June 21st to September 21st). If the initialization forecast date is later 
than the one required for the indicator (e.g.: July 1st), the user may want to 
merge past observations, or other references, to the forecast (or hindcast) to 
compute the indicator. If the forecast simulation doesn't cover the required 
period because it is initialized too early (e.g.: Initialization on November 
1st the forecast covers until the beginning of June next year), a climatology 
(or other references) could be added at the end of the forecast lead time to 
cover the desired period (e.g.: until the end of summer).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MergeRefToExp(
  data1,
  data2,
  dates1 = NULL,
  dates2 = NULL,
  start1 = NULL,
  end1 = NULL,
  start2 = NULL,
  end2 = NULL,
  time_dim = "time",
  memb_dim = "member",
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MergeRefToExp_+3A_data1">data1</code></td>
<td>
<p>A multidimensional array with named dimensions. All dimensions 
must be equal to 'data2' dimensions except for the ones specified with 
'memb_dim' and 'time_dim'.</p>
</td></tr>
<tr><td><code id="MergeRefToExp_+3A_data2">data2</code></td>
<td>
<p>A multidimensional array of named dimensions matching the 
dimensions of parameter 'data1'. All dimensions must be equal to 'data1' 
except for the ones specified with 'memb_dim' and 'time_dim'.</p>
</td></tr>
<tr><td><code id="MergeRefToExp_+3A_dates1">dates1</code></td>
<td>
<p>A multidimensional array of dates with named dimensions matching 
the temporal dimensions of parameter 'data1'. The common dimensions must be 
equal to 'data1' dimensions.</p>
</td></tr>
<tr><td><code id="MergeRefToExp_+3A_dates2">dates2</code></td>
<td>
<p>A multidimensional array of dates with named dimensions matching 
the temporal dimensions on parameter 'data2'. The common dimensions must be 
equal to 'data2' dimensions.</p>
</td></tr>
<tr><td><code id="MergeRefToExp_+3A_start1">start1</code></td>
<td>
<p>A list to define the initial date of the period to select from 
'data1' by providing a list of two elements: the initial date of the period 
and the initial month of the period. The initial date of the period must be 
included in the 'dates1' array.</p>
</td></tr>
<tr><td><code id="MergeRefToExp_+3A_end1">end1</code></td>
<td>
<p>A list to define the final date of the period to select from 
'data1' by providing a list of two elements: the final day of the period and 
the final month of the period. The final date of the period must be 
included in the 'dates1' array.</p>
</td></tr>
<tr><td><code id="MergeRefToExp_+3A_start2">start2</code></td>
<td>
<p>A list to define the initial date of the period to select from 
'data2' by providing a list of two elements: the initial date of the period 
and the initial month of the period. The initial date of the period must be 
included in the 'dates2' array.</p>
</td></tr>
<tr><td><code id="MergeRefToExp_+3A_end2">end2</code></td>
<td>
<p>A list to define the final date of the period to select from 
'data2' by providing a list of two elements: the final day of the period and 
the final month of the period. The final date of the period must be 
included in the 'dates2' array.</p>
</td></tr>
<tr><td><code id="MergeRefToExp_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension that will be used to combine the two arrays. By default, it is set 
to 'time'. Also, it will be used to subset the data in a requested 
period.</p>
</td></tr>
<tr><td><code id="MergeRefToExp_+3A_memb_dim">memb_dim</code></td>
<td>
<p>A character string indicating the name of the member 
dimension. If the 'data1' and 'data2' have no member dimension, set it as 
NULL. It is set as 'member' by default.</p>
</td></tr>
<tr><td><code id="MergeRefToExp_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is created to merge observations and forecasts, known as the 
‘blending’ strategy (see references). The basis for this strategy is that the 
predictions are progressively replaced with observational data as soon as they 
become available (i.e., when entering the indicator definition period). This 
key strategy aims to increase users’ confidence in the reformed predictions.
</p>


<h3>Value</h3>

<p>A multidimensional array created from the combination of 'data1' and 
'data2'. The resulting array will contain the following dimensions: the 
original dimensions of the input data, which are common to both arrays and for 
the 'time_dim' dimension, the sum of the corresponding dimension of 'data1' 
and 'data2'. If 'memb_dim' is not null, regarding member dimension, two 
different situations can occur: (1) in the case that one of the arrays does 
not have member dimension or is equal to 1 and the other array has multiple 
member dimension, the result will contain the repeated values of the array one 
up to the lenght of member dimension of array two; (2) in the case that both 
arrays have member dimension and is greater than 1, all combinations of member 
dimension will be returned.
</p>


<h3>References</h3>

<p>Chou, C., R. Marcos-Matamoros, L. Palma Garcia, N. Pérez-Zanón, 
M. Teixeira, S. Silva, N. Fontes, A. Graça, A. Dell'Aquila, S. Calmanti and 
N. González-Reviriego (2023). Advanced seasonal predictions for vine 
management based on bioclimatic indicators tailored to the wine sector. 
Climate Services, 30, 100343, doi: <a href="https://doi.org/10.1016/j.cliser.2023.100343">10.1016/j.cliser.2023.100343</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_dates &lt;- c(seq(as.Date("01-07-1993", "%d-%m-%Y", tz = 'UTC'),
                   as.Date("01-12-1993","%d-%m-%Y", tz = 'UTC'), "day"),
               seq(as.Date("01-07-1994", "%d-%m-%Y", tz = 'UTC'),
                   as.Date("01-12-1994","%d-%m-%Y", tz = 'UTC'), "day"))
dim(data_dates) &lt;- c(time = 154, sdate = 2)
ref_dates &lt;- seq(as.Date("01-01-1993", "%d-%m-%Y", tz = 'UTC'),
                as.Date("01-12-1994","%d-%m-%Y", tz = 'UTC'), "day")
dim(ref_dates) &lt;- c(time = 350, sdate = 2)
ref &lt;- array(1001:1700, c(time = 350, sdate = 2))
data &lt;- array(1:(2*154*2), c(time = 154, sdate = 2, member = 2))
new_data &lt;- MergeRefToExp(data1 = ref, dates1 = ref_dates, start1 = list(21, 6),
                         end1 = list(30, 6), data2 = data, dates2 = data_dates,
                         start2 = list(1, 7), end = list(21, 9), 
                         time_dim = 'time')

</code></pre>

<hr>
<h2 id='PeriodAccumulation'>Period Accumulation on multidimensional array objects</h2><span id='topic+PeriodAccumulation'></span>

<h3>Description</h3>

<p>Period Accumulation computes the sum (accumulation) of a given variable in a 
period. Providing precipitation data, two agriculture indices can be obtained 
by using this function:
</p>

<ul>
<li><p>'SprR', Spring Total Precipitation: The total precipitation from 
April 21th to June 21st.
</p>
</li>
<li><p>'HarR', Harvest Total Precipitation: The total precipitation from 
August 21st to October 21st.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>PeriodAccumulation(
  data,
  dates = NULL,
  start = NULL,
  end = NULL,
  time_dim = "time",
  rollwidth = NULL,
  sdate_dim = "sdate",
  frequency = "monthly",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PeriodAccumulation_+3A_data">data</code></td>
<td>
<p>A multidimensional array with named dimensions.</p>
</td></tr>
<tr><td><code id="PeriodAccumulation_+3A_dates">dates</code></td>
<td>
<p>A multidimensional array of dates with named dimensions matching 
the temporal dimensions on parameter 'data'. By default it is NULL, to  
select aperiod this parameter must be provided.</p>
</td></tr>
<tr><td><code id="PeriodAccumulation_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="PeriodAccumulation_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="PeriodAccumulation_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute the indicator. By default, it is set to 'time'.</p>
</td></tr>
<tr><td><code id="PeriodAccumulation_+3A_rollwidth">rollwidth</code></td>
<td>
<p>An optional parameter to indicate the number of time 
steps the rolling sum is applied to. If it is positive, the rolling sum is 
applied backwards 'time_dim', if it is negative, it will be forward it. When 
this parameter is NULL, the sum is applied over all 'time_dim', in a 
specified period. It is NULL by default.</p>
</td></tr>
<tr><td><code id="PeriodAccumulation_+3A_sdate_dim">sdate_dim</code></td>
<td>
<p>(Only needed when rollwidth is used). A character string 
indicating the name of the start date dimension to compute the rolling 
accumulation. By default, it is set to 'sdate'.</p>
</td></tr>
<tr><td><code id="PeriodAccumulation_+3A_frequency">frequency</code></td>
<td>
<p>(Only needed when rollwidth is used). A character string 
indicating the time frequency of the data to apply the rolling accumulation.  
It can be 'daily' or 'monthly'. If it is set to 'monthly', values from
continuous months will be accumulated; if it is 'daliy', values from 
continuous days will be accumulated. It is set to 'monthly' by default.</p>
</td></tr>
<tr><td><code id="PeriodAccumulation_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether to ignore NA values (TRUE) or 
not (FALSE).</p>
</td></tr>
<tr><td><code id="PeriodAccumulation_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two possible ways of performing the accumulation. The default one 
is by accumulating a variable over a dimension specified with 'time_dim'. To 
chose a specific time period, 'start' and 'end' must be used. The other method 
is by using 'rollwidth' parameter. When this parameter is a positive integer, 
the cumulative backward sum is applied to the time dimension. If it is 
negative, the rolling sum is applied backwards.
</p>


<h3>Value</h3>

<p>A multidimensional array with named dimensions containing the 
accumulated data in the element <code>data</code>. If parameter 'rollwidth' is 
not used, it will have the dimensions of the input 'data' except the dimension 
where the accumulation has been computed (specified with 'time_dim'). If 
'rollwidth' is used, it will be of same dimensions as input data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exp &lt;- array(rnorm(216)*200, dim = c(dataset = 1, member = 2, sdate = 3, 
            ftime = 9, lat = 2, lon = 2))
TP &lt;- PeriodAccumulation(exp, time_dim = 'ftime')
data &lt;- array(rnorm(5 * 3 * 214 * 2),
             c(memb = 5, sdate = 3, ftime = 214, lon = 2)) 
Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
              as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
              as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
              as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(Dates) &lt;- c(sdate = 3, ftime = 214)
SprR &lt;- PeriodAccumulation(data, dates = Dates, start = list(21, 4), 
                          end = list(21, 6), time_dim = 'ftime')
HarR &lt;- PeriodAccumulation(data, dates = Dates, start = list(21, 8), 
                          end = list(21, 10), time_dim = 'ftime')

</code></pre>

<hr>
<h2 id='PeriodMax'>Period max on multidimensional array objects</h2><span id='topic+PeriodMax'></span>

<h3>Description</h3>

<p>Period max computes the average (max) of a given variable in a period.
Two bioclimatic indicators can be obtained by using this function:
</p>

<ul>
<li><p>'BIO5', (Providing temperature data) Max Temperature of Warmest 
Month. The maximum monthly temperature occurrence over a 
given year (time-series) or averaged span of years (normal).
</p>
</li>
<li><p>'BIO13', (Providing precipitation data) Precipitation of Wettest 
Month. This index identifies the total precipitation 
that prevails during the wettest month.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>PeriodMax(
  data,
  dates = NULL,
  start = NULL,
  end = NULL,
  time_dim = "time",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PeriodMax_+3A_data">data</code></td>
<td>
<p>A multidimensional array with named dimensions.</p>
</td></tr>
<tr><td><code id="PeriodMax_+3A_dates">dates</code></td>
<td>
<p>A multidimensional array of dates with named dimensions matching 
the temporal dimensions on parameter 'data'. By default it is NULL, to  
select aperiod this parameter must be provided.</p>
</td></tr>
<tr><td><code id="PeriodMax_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="PeriodMax_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="PeriodMax_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute the indicator. By default, it is set to 'time'. More than one 
dimension name matching the dimensions provided in the object 
<code>data$data</code> can be specified.</p>
</td></tr>
<tr><td><code id="PeriodMax_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether to ignore NA values (TRUE) or 
not (FALSE).</p>
</td></tr>
<tr><td><code id="PeriodMax_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A multidimensional array with named dimensions containing the 
indicator in the element <code>data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- array(rnorm(45), dim = c(member = 7, sdate = 4, time = 3))
Dates &lt;- c(seq(as.Date("2000-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2001-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2001-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2002-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2002-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2003-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2003-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2004-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"))
dim(Dates) &lt;- c(sdate = 4, time = 3)
res &lt;- PeriodMax(data, dates = Dates, start = list(01, 12), end = list(01, 01))

</code></pre>

<hr>
<h2 id='PeriodMean'>Period Mean on multidimensional array objects</h2><span id='topic+PeriodMean'></span>

<h3>Description</h3>

<p>Period Mean computes the average (mean) of a given variable in a period.
Providing temperature data, two agriculture indices can be obtained by using 
this function:
</p>

<ul>
<li><p>'GST', Growing Season average Temperature: The average temperature 
from April 1st to Octobe 31st.
</p>
</li>
<li><p>'SprTX', Spring Average Maximum Temperature: The average daily 
maximum temperature from April 1st to May 31st.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>PeriodMean(
  data,
  dates = NULL,
  start = NULL,
  end = NULL,
  time_dim = "time",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PeriodMean_+3A_data">data</code></td>
<td>
<p>A multidimensional array with named dimensions.</p>
</td></tr>
<tr><td><code id="PeriodMean_+3A_dates">dates</code></td>
<td>
<p>A multidimensional array of dates with named dimensions matching 
the temporal dimensions on parameter 'data'. By default it is NULL, to  
select aperiod this parameter must be provided.</p>
</td></tr>
<tr><td><code id="PeriodMean_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="PeriodMean_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="PeriodMean_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute the indicator. By default, it is set to 'time'. More than one 
dimension name matching the dimensions provided in the object 
<code>data$data</code> can be specified.</p>
</td></tr>
<tr><td><code id="PeriodMean_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether to ignore NA values (TRUE) or 
not (FALSE).</p>
</td></tr>
<tr><td><code id="PeriodMean_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A multidimensional array with named dimensions containing the 
indicator in the element <code>data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- array(rnorm(45), dim = c(member = 7, sdate = 4, time = 3))
Dates &lt;- c(seq(as.Date("2000-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2001-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2001-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2002-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2002-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2003-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2003-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2004-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"))
dim(Dates) &lt;- c(sdate = 4, time = 3)
SA &lt;- PeriodMean(data, dates = Dates, start = list(01, 12), end = list(01, 01))

</code></pre>

<hr>
<h2 id='PeriodMin'>Period Min on multidimensional array objects</h2><span id='topic+PeriodMin'></span>

<h3>Description</h3>

<p>Period Min computes the average (min) of a given variable in a period.
Two bioclimatic indicators can be obtained by using this function:
</p>

<ul>
<li><p>'BIO6', (Providing temperature data) Min Temperature of Coldest  
Month. The minimum monthly temperature occurrence over a 
given year (time-series) or averaged span of years (normal).
</p>
</li>
<li><p>'BIO14', (Providing precipitation data) Precipitation of Driest  
Month. This index identifies the total precipitation 
that prevails during the driest month.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>PeriodMin(
  data,
  dates = NULL,
  start = NULL,
  end = NULL,
  time_dim = "time",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PeriodMin_+3A_data">data</code></td>
<td>
<p>A multidimensional array with named dimensions.</p>
</td></tr>
<tr><td><code id="PeriodMin_+3A_dates">dates</code></td>
<td>
<p>A multidimensional array of dates with named dimensions matching 
the temporal dimensions on parameter 'data'. By default it is NULL, to  
select aperiod this parameter must be provided.</p>
</td></tr>
<tr><td><code id="PeriodMin_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="PeriodMin_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="PeriodMin_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute the indicator. By default, it is set to 'time'. More than one 
dimension name matching the dimensions provided in the object 
<code>data$data</code> can be specified.</p>
</td></tr>
<tr><td><code id="PeriodMin_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether to ignore NA values (TRUE) or 
not (FALSE).</p>
</td></tr>
<tr><td><code id="PeriodMin_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A multidimensional array with named dimensions containing the 
indicator in the element <code>data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- array(rnorm(45), dim = c(member = 7, sdate = 4, time = 3))
Dates &lt;- c(seq(as.Date("2000-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2001-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2001-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2002-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2002-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2003-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2003-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2004-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"))
dim(Dates) &lt;- c(sdate = 4, time = 3)
res &lt;- PeriodMin(data, dates = Dates, start = list(01, 12), end = list(01, 01))

</code></pre>

<hr>
<h2 id='PeriodPET'>Compute the Potential Evapotranspiration</h2><span id='topic+PeriodPET'></span>

<h3>Description</h3>

<p>Compute the Potential Evapotranspiration (PET) that is the amount of 
evaporation and transpiration that would occur if a sufficient water source 
were available. This function calculate PET according to the Thornthwaite, 
Hargreaves or Hargreaves-modified equations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PeriodPET(
  data,
  dates,
  lat,
  pet_method = "hargreaves",
  time_dim = "syear",
  leadtime_dim = "time",
  lat_dim = "latitude",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PeriodPET_+3A_data">data</code></td>
<td>
<p>A named list of multidimensional arrays containing
the seasonal forecast experiment data for each variable. 
Specific variables are needed for each method used in computing the 
Potential Evapotranspiration (see parameter 'pet_method'). The accepted 
variable names are fixed in order to be recognized by the function. 
The accepted name corresponding to the Minimum Temperature is 'tmin', 
for Maximum Temperature is 'tmax', for Mean Temperature is 'tmean' and 
for Precipitation is 'pr'. The accepted variable names for each method are: 
For 'hargreaves': 'tmin' and 'tmax'; for 'hargreaves_modified' are 'tmin', 
'tmax' and 'pr'; for method 'thornthwaite' 'tmean' is required. The units 
for temperature variables ('tmin', 'tmax' and 'tmean') need to be in Celcius 
degrees; the units for precipitation ('pr') need to be in mm/month. 
Currently the function works only with monthly data from different years.</p>
</td></tr>
<tr><td><code id="PeriodPET_+3A_dates">dates</code></td>
<td>
<p>An array of temporal dimensions containing the Dates of 
'data'. It must be of class 'Date' or 'POSIXct'.</p>
</td></tr>
<tr><td><code id="PeriodPET_+3A_lat">lat</code></td>
<td>
<p>A numeric vector containing the latitude values of 'data'.</p>
</td></tr>
<tr><td><code id="PeriodPET_+3A_pet_method">pet_method</code></td>
<td>
<p>A character string indicating the method used to compute 
the potential evapotranspiration. The accepted methods are:
'hargreaves' and 'hargreaves_modified', that require the data to have 
variables tmin and tmax; and 'thornthwaite', that requires variable 
'tmean'.</p>
</td></tr>
<tr><td><code id="PeriodPET_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension. By default, it is set to 'syear'.</p>
</td></tr>
<tr><td><code id="PeriodPET_+3A_leadtime_dim">leadtime_dim</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension. By default, it is set to 'time'.</p>
</td></tr>
<tr><td><code id="PeriodPET_+3A_lat_dim">lat_dim</code></td>
<td>
<p>A character string indicating the name of the latitudinal 
dimension. By default it is set by 'latitude'.</p>
</td></tr>
<tr><td><code id="PeriodPET_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether NA values should be removed 
from data. It is FALSE by default.</p>
</td></tr>
<tr><td><code id="PeriodPET_+3A_ncores">ncores</code></td>
<td>
<p>An integer value indicating the number of cores to use in 
parallel computation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more information on the SPEI calculation, see functions 
PeriodStandardization and PeriodAccumulation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dims &lt;- c(time = 3, syear = 3, ensemble = 1, latitude = 1)
exp_tasmax &lt;- array(rnorm(360, 27.73, 5.26), dim = dims)
exp_tasmin &lt;- array(rnorm(360, 14.83, 3.86), dim = dims)
exp_prlr &lt;- array(rnorm(360, 21.19, 25.64), dim = dims)
end_year &lt;- 2012
dates_exp &lt;- as.POSIXct(c(paste0(2010:end_year, "-08-16"), 
                         paste0(2010:end_year, "-09-15"), 
                         paste0(2010:end_year, "-10-16")), "UTC")
dim(dates_exp) &lt;- c(syear = 3, time = 3)
lat &lt;- c(40)
exp1 &lt;- list('tmax' = exp_tasmax, 'tmin' = exp_tasmin, 'pr' = exp_prlr)
res &lt;- PeriodPET(data = exp1, lat = lat, dates = dates_exp)

</code></pre>

<hr>
<h2 id='PeriodStandardization'>Compute the Standardization of Precipitation-Evapotranspiration Index</h2><span id='topic+PeriodStandardization'></span>

<h3>Description</h3>

<p>The Standardization of the data is the last step of computing the SPEI 
indicator. With this function the data is fit to a probability distribution to 
transform the original values to standardized units that are comparable in 
space and time and at different SPEI time scales.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PeriodStandardization(
  data,
  data_cor = NULL,
  dates = NULL,
  time_dim = "syear",
  leadtime_dim = "time",
  memb_dim = "ensemble",
  ref_period = NULL,
  handle_infinity = FALSE,
  method = "parametric",
  distribution = "log-Logistic",
  params = NULL,
  return_params = FALSE,
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PeriodStandardization_+3A_data">data</code></td>
<td>
<p>A multidimensional array containing the data to be standardized.</p>
</td></tr>
<tr><td><code id="PeriodStandardization_+3A_data_cor">data_cor</code></td>
<td>
<p>A multidimensional array containing the data in which the 
standardization should be applied using the fitting parameters from 'data'.</p>
</td></tr>
<tr><td><code id="PeriodStandardization_+3A_dates">dates</code></td>
<td>
<p>An array containing the dates of the data with the same time 
dimensions as the data. It is optional and only necessary for using the 
parameter 'ref_period' to select a reference period directly from dates.</p>
</td></tr>
<tr><td><code id="PeriodStandardization_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension. By default, it is set to 'syear'.</p>
</td></tr>
<tr><td><code id="PeriodStandardization_+3A_leadtime_dim">leadtime_dim</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension. By default, it is set to 'time'.</p>
</td></tr>
<tr><td><code id="PeriodStandardization_+3A_memb_dim">memb_dim</code></td>
<td>
<p>A character string indicating the name of the dimension in 
which the ensemble members are stored. When set it to NULL, threshold is 
computed for individual members.</p>
</td></tr>
<tr><td><code id="PeriodStandardization_+3A_ref_period">ref_period</code></td>
<td>
<p>A list with two numeric values with the starting and end 
points of the reference period used for computing the index. The default 
value is NULL indicating that the first and end values in data will be 
used as starting and end points.</p>
</td></tr>
<tr><td><code id="PeriodStandardization_+3A_handle_infinity">handle_infinity</code></td>
<td>
<p>A logical value wether to return infinite values (TRUE)
or not (FALSE). When it is TRUE, the positive infinite values (negative 
infinite) are substituted by the maximum (minimum) values of each 
computation step, a subset of the array of dimensions time_dim, leadtime_dim 
and memb_dim.</p>
</td></tr>
<tr><td><code id="PeriodStandardization_+3A_method">method</code></td>
<td>
<p>A character string indicating the standardization method used. 
If can be: 'parametric' or 'non-parametric'. It is set to 'parametric' by 
default.</p>
</td></tr>
<tr><td><code id="PeriodStandardization_+3A_distribution">distribution</code></td>
<td>
<p>A character string indicating the name of the distribution 
function to be used for computing the SPEI. The accepted names are: 
'log-Logistic' and 'Gamma'. It is set to 'log-Logistic' by default. The 
'Gamma' method only works when only precipitation is provided and other 
variables are 0 because it is positive defined (SPI indicator).</p>
</td></tr>
<tr><td><code id="PeriodStandardization_+3A_params">params</code></td>
<td>
<p>An optional parameter that needs to be a multidimensional array 
with named dimensions. This option overrides computation of fitting 
parameters. It needs to be of same time dimensions (specified in 'time_dim' 
and 'leadtime_dim') of 'data' and a dimension named 'coef' with the length 
of the coefficients needed for the used distribution (for 'Gamma' coef 
dimension is of lenght 2, for 'log-Logistic' is of length 3). It also needs 
to have a leadtime dimension (specified in 'leadtime_dim') of length 1. It 
will only be used if 'data_cor' is not provided.</p>
</td></tr>
<tr><td><code id="PeriodStandardization_+3A_return_params">return_params</code></td>
<td>
<p>A logical value indicating wether to return parameters 
array (TRUE) or not (FALSE). It is FALSE by default.</p>
</td></tr>
<tr><td><code id="PeriodStandardization_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether NA values should be removed 
from data. It is FALSE by default. If it is FALSE and there are NA values, 
standardization cannot be carried out for those coordinates and therefore, 
the result will be filled with NA for the specific coordinates. If it is 
TRUE, if the data from other dimensions except time_dim and leadtime_dim is 
not reaching 4 values, it is not enough values to estimate the parameters 
and the result will include NA.</p>
</td></tr>
<tr><td><code id="PeriodStandardization_+3A_ncores">ncores</code></td>
<td>
<p>An integer value indicating the number of cores to use in 
parallel computation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Next, some specifications for the calculation of the standardization will be 
discussed. If there are NAs in the data and they are not removed with the 
parameter 'na.rm', the standardization cannot be carried out for those 
coordinates and therefore, the result will be filled with NA for the 
specific coordinates. When NAs are not removed, if the length of the data for 
a computational step is smaller than 4, there will not be enough data for 
standarize and the result will be also filled with NAs for that coordinates. 
About the distribution used to fit the data, there are only two possibilities: 
'log-logistic' and 'Gamma'. The 'Gamma' method only works when only 
precipitation is provided and other variables are 0 because it is positive 
defined (SPI indicator). When only 'data' is provided ('data_cor' is NULL) the 
standardization is computed with cross validation. For more information about 
SPEI, see functions PeriodPET and PeriodAccumulation.
</p>


<h3>Value</h3>

<p>A multidimensional array containing the standardized data. 
If 'data_cor' is provided the array will be of the same dimensions as 
'data_cor'. If 'data_cor' is not provided, the array will be of the same 
dimensions as 'data'. The parameters of the standardization will only be 
returned if 'return_params' is TRUE, in this case, the output will be a list 
of two objects one for the standardized data and one for the parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dims &lt;-  c(syear = 6, time = 2, latitude = 2, ensemble = 25)
dimscor &lt;-  c(syear = 1, time = 2, latitude = 2, ensemble = 25)
data &lt;- array(rnorm(600, -194.5, 64.8), dim = dims)
datacor &lt;- array(rnorm(100, -217.8, 68.29), dim = dimscor)

SPEI &lt;- PeriodStandardization(data = data)
SPEIcor &lt;- PeriodStandardization(data = data, data_cor = datacor)
</code></pre>

<hr>
<h2 id='PeriodVariance'>Period Variance on multidimensional array objects</h2><span id='topic+PeriodVariance'></span>

<h3>Description</h3>

<p>Period Variance computes the average (var) of a given variable in a period.
Two bioclimatic indicators can be obtained by using this function:
</p>

<ul>
<li><p>'BIO4', (Providing temperature data) Temperature Seasonality 
(Standard Deviation). The amount of temperature variation  
over a given year (or averaged years) based on the standard 
deviation (variation) of monthly temperature averages.
</p>
</li>
<li><p>'BIO15', (Providing precipitation data) Precipitation Seasonality 
(CV). This is a measure of the variation in monthly precipitation 
totals over the course of the year. This index is the ratio of the 
standard deviation of the monthly total precipitation to the mean 
monthly total precipitation (also known as the coefficient of 
variation) and is expressed as a percentage.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>PeriodVariance(
  data,
  dates = NULL,
  start = NULL,
  end = NULL,
  time_dim = "time",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PeriodVariance_+3A_data">data</code></td>
<td>
<p>A multidimensional array with named dimensions.</p>
</td></tr>
<tr><td><code id="PeriodVariance_+3A_dates">dates</code></td>
<td>
<p>A multidimensional array of dates with named dimensions matching 
the temporal dimensions on parameter 'data'. By default it is NULL, to  
select aperiod this parameter must be provided.</p>
</td></tr>
<tr><td><code id="PeriodVariance_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="PeriodVariance_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="PeriodVariance_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute the indicator. By default, it is set to 'time'. More than one 
dimension name matching the dimensions provided in the object 
<code>data$data</code> can be specified.</p>
</td></tr>
<tr><td><code id="PeriodVariance_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether to ignore NA values (TRUE) or 
not (FALSE).</p>
</td></tr>
<tr><td><code id="PeriodVariance_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A multidimensional array with named dimensions containing the 
indicator in the element <code>data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- array(rnorm(45), dim = c(member = 7, sdate = 4, time = 3))
Dates &lt;- c(seq(as.Date("2000-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2001-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2001-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2002-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2002-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2003-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"),
          seq(as.Date("2003-11-01", "%Y-%m-%d", tz = "UTC"), 
              as.Date("2004-01-01", "%Y-%m-%d", tz = "UTC"), by = "month"))
dim(Dates) &lt;- c(sdate = 4, time = 3)
res &lt;- PeriodVariance(data, dates = Dates, start = list(01, 12), end = list(01, 01))

</code></pre>

<hr>
<h2 id='QThreshold'>Transform an absolute threshold into probabilities</h2><span id='topic+QThreshold'></span>

<h3>Description</h3>

<p>From the user's perspective, an absolute threshold can be very useful for a 
specific needs (e.g.: grape variety). However, this absolute threshold could 
be transformed to a relative threshold in order to get its frequency in a given 
dataset. Therefore, the function <code>QThreshold</code> returns the probability of 
an absolute threshold. This is done by computing the Cumulative Distribution 
Function of a sample and leaving-one-ot. The sample used will depend on the 
dimensions of the data provided and the dimension names provided in sdate_dim 
and memb_dim parameters:
</p>

<ul>
<li><p>If a forecast (hindcast) has dimensions member and start date, and
both must be used in the sample, their names should be passed in 
sdate_dim and memb_dim.
</p>
</li>
<li><p>If a forecast (hindcast) has dimensions member and start date, and
only start date must be used in the sample (the calculation is done in
each separate member), memb_dim can be set to NULL.
</p>
</li>
<li><p>If a reference (observations) has start date dimension, the sample
used is the start date dimension.
</p>
</li>
<li><p>If a reference (observations) doesn't have start date dimension, 
the sample used must be especified in sdate_dim parameter.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>QThreshold(
  data,
  threshold,
  dates = NULL,
  start = NULL,
  end = NULL,
  time_dim = "time",
  memb_dim = "member",
  sdate_dim = "sdate",
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QThreshold_+3A_data">data</code></td>
<td>
<p>A multidimensional array with named dimensions.</p>
</td></tr>
<tr><td><code id="QThreshold_+3A_threshold">threshold</code></td>
<td>
<p>A multidimensional array with named dimensions in the same 
units as parameter 'data' and with the common dimensions of the element 
'data' of the same length.</p>
</td></tr>
<tr><td><code id="QThreshold_+3A_dates">dates</code></td>
<td>
<p>A multidimensional array of dates with named dimensions matching 
the temporal dimensions on parameter 'data'. By default it is NULL, to  
select aperiod this parameter must be provided.</p>
</td></tr>
<tr><td><code id="QThreshold_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="QThreshold_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="QThreshold_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension. By default, it is set to 'time'. More than one dimension name 
matching the dimensions provided in the object <code>data$data</code> can be 
specified. This dimension is required to subset the data in a requested 
period.</p>
</td></tr>
<tr><td><code id="QThreshold_+3A_memb_dim">memb_dim</code></td>
<td>
<p>A character string indicating the name of the dimension in 
which the ensemble members are stored.</p>
</td></tr>
<tr><td><code id="QThreshold_+3A_sdate_dim">sdate_dim</code></td>
<td>
<p>A character string indicating the name of the dimension in 
which the initialization dates are stored.</p>
</td></tr>
<tr><td><code id="QThreshold_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A multidimensional array with named dimensions containing the 
probability of an absolute threshold in the element <code>data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>threshold = 25
data &lt;- array(rnorm(5 * 3 * 20 * 2, mean = 26), 
             c(member = 5, sdate = 3, time = 214, lon = 2)) 

Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
              as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
              as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
              as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(Dates) &lt;- c(sdate = 3, time = 214)

thres_q &lt;- QThreshold(data, threshold, dates = Dates, time_dim = 'time',
                     start = list(21, 4), end = list(21, 6))

</code></pre>

<hr>
<h2 id='SelectPeriodOnData'>Select a period on Data on multidimensional array objects</h2><span id='topic+SelectPeriodOnData'></span>

<h3>Description</h3>

<p>Auxiliary function to subset data for a specific period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SelectPeriodOnData(data, dates, start, end, time_dim = "time", ncores = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SelectPeriodOnData_+3A_data">data</code></td>
<td>
<p>A multidimensional array with named dimensions with at least the
time dimension specified in parameter 'time_dim'. All common dimensions
with 'dates' parameter need to have the same length.</p>
</td></tr>
<tr><td><code id="SelectPeriodOnData_+3A_dates">dates</code></td>
<td>
<p>An array of dates with named dimensions with at least the time 
dimension specified in parameter 'time_dim'. All common dimensions with
'data' parameter need to have the same length.</p>
</td></tr>
<tr><td><code id="SelectPeriodOnData_+3A_start">start</code></td>
<td>
<p>A list with two elements to define the initial date of the period 
to select from the data. The first element is the initial day of the period 
and the second element is the initial month of the period.</p>
</td></tr>
<tr><td><code id="SelectPeriodOnData_+3A_end">end</code></td>
<td>
<p>A list with two elements to define the final date of the period 
to select from the data. The first element is the final day of the period 
and the second element is the final month of the period.</p>
</td></tr>
<tr><td><code id="SelectPeriodOnData_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute select the dates. By default, it is set to 'time'. Parameters 
'data' and 'dates'</p>
</td></tr>
<tr><td><code id="SelectPeriodOnData_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A multidimensional array with named dimensions containing the subset 
of the object <code>data</code> during the period requested from <code>start</code> to 
<code>end</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- array(rnorm(5 * 3 * 214 * 2),
             c(memb = 5, sdate = 3, time = 214, lon = 2)) 
Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
              as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
              as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
              as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(Dates) &lt;- c(time = 214, sdate = 3)
Period &lt;- SelectPeriodOnData(data, Dates, start = list(21, 6), end = list(21, 9))
</code></pre>

<hr>
<h2 id='SelectPeriodOnDates'>Select a period on Dates</h2><span id='topic+SelectPeriodOnDates'></span>

<h3>Description</h3>

<p>Auxiliary function to subset dates for a specific period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SelectPeriodOnDates(dates, start, end, time_dim = "time", ncores = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SelectPeriodOnDates_+3A_dates">dates</code></td>
<td>
<p>An array of dates with named dimensions.</p>
</td></tr>
<tr><td><code id="SelectPeriodOnDates_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period.</p>
</td></tr>
<tr><td><code id="SelectPeriodOnDates_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period.</p>
</td></tr>
<tr><td><code id="SelectPeriodOnDates_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute select the dates. By default, it is set to 'time'. More than one 
dimension name matching the dimensions provided in the object 
<code>data$data</code> can be specified.</p>
</td></tr>
<tr><td><code id="SelectPeriodOnDates_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A multidimensional array with named dimensions containing the subset of 
the vector dates during the period requested from <code>start</code> to <code>end</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
              as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
              as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
              as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(Dates) &lt;- c(time = 214, sdate = 3)
Period &lt;- SelectPeriodOnDates(Dates, start = list(21, 6), end = list(21, 9))
</code></pre>

<hr>
<h2 id='Threshold'>Absolute value of a relative threshold (percentile)</h2><span id='topic+Threshold'></span>

<h3>Description</h3>

<p>Frequently, thresholds are defined by a percentile that may correspond to a 
different absolute value depending on the variable, gridpoint and also julian 
day (time). This function calculates the corresponding value of a percentile 
given a dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Threshold(
  data,
  threshold,
  dates = NULL,
  start = NULL,
  end = NULL,
  time_dim = "time",
  memb_dim = "member",
  sdate_dim = "sdate",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Threshold_+3A_data">data</code></td>
<td>
<p>A multidimensional array with named dimensions.</p>
</td></tr>
<tr><td><code id="Threshold_+3A_threshold">threshold</code></td>
<td>
<p>A single scalar or vector indicating the relative 
threshold(s). It must contain values between 0 and 1.</p>
</td></tr>
<tr><td><code id="Threshold_+3A_dates">dates</code></td>
<td>
<p>A multidimensional array of dates with named dimensions matching 
the temporal dimensions on parameter 'data'. By default it is NULL, to  
select aperiod this parameter must be provided.</p>
</td></tr>
<tr><td><code id="Threshold_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="Threshold_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="Threshold_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension. By default, it is set to 'time'. More than one dimension name 
matching the dimensions provided in the object <code>data$data</code> can be 
specified. This dimension is required to subset the data in a requested 
period.</p>
</td></tr>
<tr><td><code id="Threshold_+3A_memb_dim">memb_dim</code></td>
<td>
<p>A character string indicating the name of the dimension in 
which the ensemble members are stored. When set it to NULL, threshold is 
computed for individual members.</p>
</td></tr>
<tr><td><code id="Threshold_+3A_sdate_dim">sdate_dim</code></td>
<td>
<p>A character string indicating the name of the dimension in 
which the initialization dates are stored.</p>
</td></tr>
<tr><td><code id="Threshold_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether to ignore NA values (TRUE) or 
not (FALSE).</p>
</td></tr>
<tr><td><code id="Threshold_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A multidimensional array with named dimensions containing the
corresponding values of a percentile in the element <code>data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>threshold &lt;- 0.9
data &lt;- array(rnorm(25 * 3 * 214 * 2, mean = 26), 
             c(member = 25, sdate = 3, time = 214, lon = 2)) 
thres_q &lt;- Threshold(data, threshold)
data &lt;- array(rnorm(1 * 3 * 214 * 2), c(member = 1, sdate = 3, time = 214, lon = 2))
res &lt;- Threshold(data, threshold)

</code></pre>

<hr>
<h2 id='TotalSpellTimeExceedingThreshold'>Total Spell Time Exceeding Threshold</h2><span id='topic+TotalSpellTimeExceedingThreshold'></span>

<h3>Description</h3>

<p>The number of days (when daily data is provided) that are part of a spell 
(defined by its minimum length e.g. 6 consecutive days) that exceed (or not 
exceed) a threshold are calculated with <code>TotalSpellTimeExceedingThreshold</code>.
This function allows to compute indicators widely used in Climate Services, 
such as:
</p>

<ul>
<li><p>'WSDI', Warm Spell Duration Index that count the total number of days 
with at least 6 consecutive days when the daily temperature 
maximum exceeds its 90th percentile.
</p>
</li></ul>

<p>This function requires the data and the threshold to be in the same units. The 
90th percentile can be translate into absolute values given a reference 
dataset using function <code>Threshold</code> or the data can be transform into 
probabilites by using function <code>AbsToProbs</code>. See section @examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TotalSpellTimeExceedingThreshold(
  data,
  threshold,
  spell,
  op = "&gt;",
  dates = NULL,
  start = NULL,
  end = NULL,
  time_dim = "time",
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TotalSpellTimeExceedingThreshold_+3A_data">data</code></td>
<td>
<p>A multidimensional array with named dimensions.</p>
</td></tr>
<tr><td><code id="TotalSpellTimeExceedingThreshold_+3A_threshold">threshold</code></td>
<td>
<p>If only one threshold is used: it can be a multidimensional 
array with named dimensions. It must be in the same units and with the 
common dimensions of the same length as parameter 'data'. It can also be a
vector with the same length of 'time_dim' from 'data' or a scalar. If we 
want to use two thresholds: it can be a vector of two scalars, a list of 
two vectors with the same length of 'time_dim' from 'data' or a list of 
two multidimensional arrays with the common dimensions of the same length 
as parameter 'data'. If two thresholds are used, parameter 'op' must be 
also a vector of two elements.</p>
</td></tr>
<tr><td><code id="TotalSpellTimeExceedingThreshold_+3A_spell">spell</code></td>
<td>
<p>A scalar indicating the minimum length of the spell.</p>
</td></tr>
<tr><td><code id="TotalSpellTimeExceedingThreshold_+3A_op">op</code></td>
<td>
<p>An operator '&gt;' (by default), '&lt;', '&gt;=' or '&lt;='. If  two thresholds
are used it has to be a vector of a pair of two logical operators: 
c('&lt;', '&gt;'), c('&lt;', '&gt;='), c('&lt;=', '&gt;'), c('&lt;=', '&gt;='), c('&gt;', '&lt;'), 
c('&gt;', '&lt;='), c('&gt;=', '&lt;'),c('&gt;=', '&lt;=')).</p>
</td></tr>
<tr><td><code id="TotalSpellTimeExceedingThreshold_+3A_dates">dates</code></td>
<td>
<p>A multidimensional array of dates with named dimensions matching 
the temporal dimensions on parameter 'data'. By default it is NULL, to  
select aperiod this parameter must be provided.</p>
</td></tr>
<tr><td><code id="TotalSpellTimeExceedingThreshold_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="TotalSpellTimeExceedingThreshold_+3A_end">end</code></td>
<td>
<p>An optional parameter to define the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="TotalSpellTimeExceedingThreshold_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute the indicator. By default, it is set to 'time'. It can only
indicate one time dimension.</p>
</td></tr>
<tr><td><code id="TotalSpellTimeExceedingThreshold_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function considers NA values as the end of the spell. For a 
different behaviour consider to modify the 'data' input by substituting NA 
values by values exceeding the threshold.
</p>


<h3>Value</h3>

<p>A multidimensional array with named dimensions containing the number 
of days that are part of a spell within a threshold with dimensions of the 
input parameter 'data' except the dimension where the indicator has been 
computed.
</p>


<h3>See Also</h3>

<p>[Threshold()] and [AbsToProbs()].
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- array(1:100, c(member = 5, sdate = 3, time = 214, lon = 2))
Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
              as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
              as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
              as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(Dates) &lt;- c(sdate = 3, time = 214)

threshold &lt;- array(1:4, c(lat = 4))
total &lt;- TotalSpellTimeExceedingThreshold(data, threshold, dates = Dates, 
                                         spell = 6, start = list(21, 4), 
                                         end = list(21, 6))

</code></pre>

<hr>
<h2 id='TotalTimeExceedingThreshold'>Total Time of a variable Exceeding (not exceeding) a Threshold</h2><span id='topic+TotalTimeExceedingThreshold'></span>

<h3>Description</h3>

<p>The Total Time of a variable exceeding (or not) a Threshold. It returns the  
total number of days (if the data provided is daily, or the corresponding  
units of the data frequency) that a variable is exceeding a threshold 
during a period. The threshold provided must be in the same units as the 
variable units, i.e. to use a percentile as a scalar, the function 
<code>AbsToProbs</code> or <code>QThreshold</code>  may be needed (see examples). 
Providing maximum temperature daily data, the following agriculture 
indices for heat stress can be obtained by using this function:
</p>

<ul>
<li><p>'SU35', Total count of days when daily maximum temperatures exceed 
35°C in the seven months from the start month given (e.g. from April 
to October for start month of April).
</p>
</li>
<li><p>'SU36', Total count of days when daily maximum temperatures exceed 
36 between June 21st and September 21st.
</p>
</li>
<li><p>'SU40', Total count of days when daily maximum temperatures exceed 
40 between June 21st and September 21st.
</p>
</li>
<li><p>'Spr32', Total count of days when daily maximum temperatures exceed
32 between April 21st and June 21st.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>TotalTimeExceedingThreshold(
  data,
  threshold,
  op = "&gt;",
  dates = NULL,
  start = NULL,
  end = NULL,
  time_dim = "time",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TotalTimeExceedingThreshold_+3A_data">data</code></td>
<td>
<p>A multidimensional array with named dimensions.</p>
</td></tr>
<tr><td><code id="TotalTimeExceedingThreshold_+3A_threshold">threshold</code></td>
<td>
<p>If only one threshold is used: it can be a multidimensional 
array with named dimensions. It must be in the same units and with the 
common dimensions of the same length as parameter 'data'. It can also be a
vector with the same length of 'time_dim' from 'data' or a scalar. If we 
want to use two thresholds: it can be a vector of two scalars, a list of 
two vectors with the same length of 'time_dim' from 'data' or a list of 
two multidimensional arrays with the common dimensions of the same length 
as parameter 'data'. If two thresholds are used, parameter 'op' must be 
also a vector of two elements.</p>
</td></tr>
<tr><td><code id="TotalTimeExceedingThreshold_+3A_op">op</code></td>
<td>
<p>An operator '&gt;' (by default), '&lt;', '&gt;=' or '&lt;='. If  two thresholds
are used it has to be a vector of a pair of two logical operators: 
c('&lt;', '&gt;'), c('&lt;', '&gt;='), c('&lt;=', '&gt;'), c('&lt;=', '&gt;='), c('&gt;', '&lt;'), 
c('&gt;', '&lt;='), c('&gt;=', '&lt;'),c('&gt;=', '&lt;=')).</p>
</td></tr>
<tr><td><code id="TotalTimeExceedingThreshold_+3A_dates">dates</code></td>
<td>
<p>A multidimensional array of dates with named dimensions matching 
the temporal dimensions on parameter 'data'. By default it is NULL, to  
select aperiod this parameter must be provided.</p>
</td></tr>
<tr><td><code id="TotalTimeExceedingThreshold_+3A_start">start</code></td>
<td>
<p>An optional parameter to define the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="TotalTimeExceedingThreshold_+3A_end">end</code></td>
<td>
<p>An optional parameter to define the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="TotalTimeExceedingThreshold_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute the indicator. By default, it is set to 'time'. It can only
indicate one time dimension.</p>
</td></tr>
<tr><td><code id="TotalTimeExceedingThreshold_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether to ignore NA values (TRUE) or 
not (FALSE).</p>
</td></tr>
<tr><td><code id="TotalTimeExceedingThreshold_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A multidimensional array with named dimensions containing the total 
number of the corresponding units of the data frequency that a variable is 
exceeding a threshold during a period with dimensions of the input parameter 
'data' except the dimension where the indicator has been computed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- array(rnorm(5 * 3 * 214 * 2)*23,
             c(member = 5, sdate = 3, time = 214, lon = 2)) 
Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
              as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
              as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
              as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(Dates) &lt;- c(sdate = 3, time = 214)
DOT &lt;- TotalTimeExceedingThreshold(data, threshold = 23, dates = Dates,
                                  start = list(21, 4), end = list(21, 6))

</code></pre>

<hr>
<h2 id='WindCapacityFactor'>Wind capacity factor</h2><span id='topic+WindCapacityFactor'></span>

<h3>Description</h3>

<p>Wind capacity factor computes the wind power generated by a 
specific wind turbine model under specific wind speed conditions, and 
expresses it as a fraction of the rated capacity (i.e. maximum power) of the 
turbine.
</p>
<p>It is computed by means of a tabular power curve that relates 
wind speed to power output. The tabular values are interpolated with a linear 
piecewise approximating function to obtain a smooth power curve. Five 
different power curves that span different IEC classes can be selected (see 
below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WindCapacityFactor(
  wind,
  IEC_class = c("I", "I/II", "II", "II/III", "III"),
  dates = NULL,
  start = NULL,
  end = NULL,
  time_dim = "time",
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WindCapacityFactor_+3A_wind">wind</code></td>
<td>
<p>A multidimensional array, vector or scalar with instantaneous wind
speeds expressed in m/s.</p>
</td></tr>
<tr><td><code id="WindCapacityFactor_+3A_iec_class">IEC_class</code></td>
<td>
<p>A string indicating the IEC wind class (see IEC 61400-1) of 
the turbine to be selected. Classes <code>'I'</code>, <code>'II'</code> and <code>'III'</code>
are suitable for sites with an annual mean wind speed of 10, 8.5 and 7.5 m/s
respectively. Classes <code>'I/II'</code> and <code>'II/III'</code> indicate
intermediate turbines that fit both classes. More details of the five
turbines and a plot of its power curves can be found in Lledó et al. (2019).</p>
</td></tr>
<tr><td><code id="WindCapacityFactor_+3A_dates">dates</code></td>
<td>
<p>A multidimensional array of dates with named dimensions matching 
the temporal dimensions on parameter 'data'. By default it is NULL, to  
select aperiod this parameter must be provided.</p>
</td></tr>
<tr><td><code id="WindCapacityFactor_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period
to select from the data by providing a list of two elements: the initial
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in
<code>data</code>.</p>
</td></tr>
<tr><td><code id="WindCapacityFactor_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to
select from the data by providing a list of two elements: the final day of
the period and the final month of the period. By default it is set to NULL
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="WindCapacityFactor_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to
compute the indicator. By default, it is set to 'time'. More than one
dimension name matching the dimensions provided in the object
<code>data$data</code> can be specified.</p>
</td></tr>
<tr><td><code id="WindCapacityFactor_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel
computation for temporal subsetting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An array with the same dimensions as wind, containing the Wind
Capacity Factor (unitless).
</p>


<h3>Author(s)</h3>

<p>Llorenç Lledó, <a href="mailto:llledo@bsc.es">llledo@bsc.es</a>
</p>


<h3>References</h3>

<p>Lledó, Ll., Torralba, V., Soret, A., Ramon, J., &amp; Doblas-Reyes, 
F. J. (2019). Seasonal forecasts of wind power generation. 
Renewable Energy, 143, 91–100. https://doi.org/10.1016/j.renene.2019.04.135
</p>
<p>International Standard IEC 61400-1 (third ed.) (2005)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wind &lt;- array(rweibull(n = 32100, shape = 2, scale = 6), 
             c(member = 5, sdate = 3, time = 214, lon = 2, lat = 5))

Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
              as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
              as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
              as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(Dates) &lt;- c(sdate = 3, time = 214)

WCF &lt;- WindCapacityFactor(wind, IEC_class = "III", dates = Dates, 
                         start = list(21, 4), end = list(21, 6))

</code></pre>

<hr>
<h2 id='WindPowerDensity'>Wind power density on multidimensional array objects</h2><span id='topic+WindPowerDensity'></span>

<h3>Description</h3>

<p>Wind Power Density computes the wind power that is available for 
extraction per square meter of swept area.
</p>
<p>It is computed as 0.5*ro*wspd^3. As this function is non-linear, 
it will give inaccurate results if used with period means.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WindPowerDensity(
  wind,
  ro = 1.225,
  dates = NULL,
  start = NULL,
  end = NULL,
  time_dim = "time",
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WindPowerDensity_+3A_wind">wind</code></td>
<td>
<p>A multidimensional array, vector or scalar with instantaneous wind
speeds expressed in m/s.</p>
</td></tr>
<tr><td><code id="WindPowerDensity_+3A_ro">ro</code></td>
<td>
<p>A scalar, or alternatively a multidimensional array with the same
dimensions as wind, with the air density expressed in kg/m^3. By default it
takes the value 1.225, the standard density of air at 15ºC and 1013.25 hPa.</p>
</td></tr>
<tr><td><code id="WindPowerDensity_+3A_dates">dates</code></td>
<td>
<p>A multidimensional array of dates with named dimensions matching 
the temporal dimensions on parameter 'data'. By default it is NULL, to  
select aperiod this parameter must be provided.</p>
</td></tr>
<tr><td><code id="WindPowerDensity_+3A_start">start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period
to select from the data by providing a list of two elements: the initial
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in
<code>data</code>.</p>
</td></tr>
<tr><td><code id="WindPowerDensity_+3A_end">end</code></td>
<td>
<p>An optional parameter to defined the final date of the period to
select from the data by providing a list of two elements: the final day of
the period and the final month of the period. By default it is set to NULL
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="WindPowerDensity_+3A_time_dim">time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to
compute the indicator. By default, it is set to 'time'. More than one
dimension name matching the dimensions provided in the object
<code>data$data</code> can be specified.</p>
</td></tr>
<tr><td><code id="WindPowerDensity_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel
computation for temporal subsetting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An array with the same dimensions as wind, containing Wind Power 
Density expressed in W/m^2.
</p>


<h3>Author(s)</h3>

<p>Llorenç Lledó, <a href="mailto:llledo@bsc.es">llledo@bsc.es</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wind &lt;- array(rweibull(n = 32100, shape = 2, scale = 6), 
             c(member = 5, sdate = 3, time = 214, lon = 2, lat = 5))
Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
              as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
              as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
              as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(Dates) &lt;- c(sdate = 3, time = 214)
WPD &lt;- WindPowerDensity(wind, dates = Dates, start = list(21, 4), 
                       end = list(21, 6))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
