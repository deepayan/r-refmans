<!DOCTYPE html><html><head><title>Help for package mbreaks</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mbreaks}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#compile_model'><p>Format output of n break model</p></a></li>
<li><a href='#compile_sbtests'><p>Compile the output of Sup Wald test</p></a></li>
<li><a href='#compile_seqtests'><p>Compile the output of sequential Sup Wald test</p></a></li>
<li><a href='#correct'><p>Heteroskedasticy and autocorrelation consistency correction for residuals</p></a></li>
<li><a href='#dating'><p>Computation of global minimizer for pure structural change model</p></a></li>
<li><a href='#diag_par'><p>Diagonal partition given break dates</p></a></li>
<li><a href='#dofix'><p>Estimate a model with pre-specified number of breaks</p></a></li>
<li><a href='#doglob'><p>Global SSR minimizer for structural change model</p></a></li>
<li><a href='#doorder'><p>Estimating number of breaks via information criterion</p></a></li>
<li><a href='#dorepart'><p>Estimating number of breaks using repartition procedure</p></a></li>
<li><a href='#doseqtests'><p>Sequential Sup F tests</p></a></li>
<li><a href='#dosequa'><p>Estimating number of breaks using sequential tests</p></a></li>
<li><a href='#dotest'><p>SupF, UDMax &amp; WDMax testing procedure</p></a></li>
<li><a href='#estim'><p>Structural change model estimation</p></a></li>
<li><a href='#interval'><p>Estimatd break confidence interval</p></a></li>
<li><a href='#mdl'><p>Comprehensive structural change estimation and testing</p></a></li>
<li><a href='#nkpc'><p>New Keynesian Phillips curve data</p></a></li>
<li><a href='#nldat'><p>Computation of global minimizer for partial structural change model</p></a></li>
<li><a href='#pftest'><p>SupF test for 0 vs i breaks</p></a></li>
<li><a href='#plambda'><p>Construct diagonal matrix according to break date</p></a></li>
<li><a href='#plot_model'><p>Plot structural change model</p></a></li>
<li><a href='#print.mdl'><p>Print information of <code>mbreaks</code> comprehensive procedure</p></a></li>
<li><a href='#print.model'><p>Summary output of a structural breaks <code>model</code></p></a></li>
<li><a href='#print.sbtests'><p>Print Sup F and UDMax tests</p></a></li>
<li><a href='#print.seqtests'><p>Print sequential SupF tests</p></a></li>
<li><a href='#psigmq'><p>Construct diagonal matrix of estimated variance</p></a></li>
<li><a href='#real'><p>World Health Organization TB data</p></a></li>
<li><a href='#spflp1'><p>SupF(l+1|l) test</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation and Inference for Structural Breaks in Linear
Regression Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions provide comprehensive treatments for estimating, inferring, testing and model selecting in linear regression models with structural breaks. The tests, estimation methods, inference and information criteria implemented are discussed in Bai and Perron (1998) "Estimating and Testing Linear Models with Multiple Structural Changes" &lt;<a href="https://doi.org/10.2307%2F2998540">doi:10.2307/2998540</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/RoDivinity/mbreaks">https://github.com/RoDivinity/mbreaks</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/RoDivinity/mbreaks/issues">https://github.com/RoDivinity/mbreaks/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, graphics, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-20 18:38:09 UTC; linhnguyen</td>
</tr>
<tr>
<td>Author:</td>
<td>Linh Nguyen [aut, cre],
  Yohei Yamamoto [aut],
  Pierre Perron [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Linh Nguyen &lt;nguye535@purdue.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-23 09:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='compile_model'>Format output of n break model</h2><span id='topic+compile_model'></span>

<h3>Description</h3>

<p><code>compile_model()</code> compiles the information of <code>model</code> class object <code>x</code> into 3
main tables:
</p>

<ul>
<li> <p><code>date_tab</code> Table for estimated break date in the model
with 90% and 95% confidence intervals based on <code>robust</code>,<code>hetomega</code>, <code>hetq</code> options
for errors
and <code>prewhit</code> option
</p>
</li>
<li> <p><code>RS_tab</code> Table for estimated coefficients for <code>z</code> regressors
with corrected standard errors based on <code>robust</code>,<code>hetdat</code>,<code>hetvar</code>
options for errors and <code>prewhit</code> option
</p>
</li>
<li> <p><code>FS_tab</code> Table for estimated coefficients for <code>x</code> regressors
with corrected standard errors based on <code>robust</code>,<code>hetdat</code>,<code>hetvar</code> options for errors and <code>prewhit</code> option
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>compile_model(x, digits = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compile_model_+3A_x">x</code></td>
<td>
<p>the <code>model</code> class to format</p>
</td></tr>
<tr><td><code id="compile_model_+3A_digits">digits</code></td>
<td>
<p>number of digits displayed in console. Default value is 3</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>x</code> The input list of <code>model</code> class contains the following tables:
</p>

<ul>
<li><p><code>date_tab</code> A data frame storing the break date estimated by the model,
and their corresponding confidence intervals
</p>
</li>
<li><p><code>RS_tab</code> A data frame storing the estimated coefficients which allowed to
change across regimes with corrected standard errors
</p>
</li>
<li><p><code>FS_tab</code> A data frame storing the estimated coefficients which is constant
across regimes with corrected standard errors</p>
</li></ul>



<h3>Note</h3>


<ul>
<li><p>If <code>x</code> returns 0 number of estimated break,
the function will return <code>NULL</code> value instead of the list in <code>Value</code>.
</p>
</li>
<li><p>If <code>x</code> is a pure structural break, the <code>FS_tab</code> will return <code>NULL</code> in
<code>Value</code>
</p>
</li></ul>


<hr>
<h2 id='compile_sbtests'>Compile the output of Sup Wald test</h2><span id='topic+compile_sbtests'></span>

<h3>Description</h3>

<p><code>compile_sbtests</code> formats the output of the <code>sbtests</code> into 2 tables
</p>

<ul>
<li><p> supF1 table containing Sup F tests of <code>0</code> versus <code>1</code> to <code>m</code> breaks
with critical values of the corresponding tests
</p>
</li>
<li></li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>compile_sbtests(x, digits = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compile_sbtests_+3A_x">x</code></td>
<td>
<p><code>sbtests</code> class object</p>
</td></tr>
<tr><td><code id="compile_sbtests_+3A_digits">digits</code></td>
<td>
<p>number of decimal places displayed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>class <code>sbtests</code> x with appended 2 data frames:
</p>

<ul>
<li><p>supF1 A data frame contains SupF tests statistics of <code>0</code> versus <code>m</code> breaks, where
<code>m</code> is maximum number of breaks considered in <code>x</code> with critical values at
<code style="white-space: pre;">&#8288;{10%,5%,2.5%,1%}&#8288;</code> level
</p>
</li>
<li><p>UDMax A data frame contains Double Max test statistics with with critical values at
<code style="white-space: pre;">&#8288;{10%,5%,2.5%,1%}&#8288;</code> level
</p>
</li></ul>


<hr>
<h2 id='compile_seqtests'>Compile the output of sequential Sup Wald test</h2><span id='topic+compile_seqtests'></span>

<h3>Description</h3>

<p><code>compile_seqtests</code> formats the output of the <code>seqtests</code> class object to 1 table
</p>

<ul>
<li><p> sfl table containing sequential sup F tests statistics
of <code>l</code> versus <code>l+1</code> for l in <code>1</code> to <code>m</code> breaks
with critical values of the corresponding tests at
<code style="white-space: pre;">&#8288;{1%, 2.5%, 5%, 10%}&#8288;</code> significance levels
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>compile_seqtests(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compile_seqtests_+3A_x">x</code></td>
<td>
<p><code>seqtests</code> class object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>class <code>seqtests</code> list <code>x</code> with appended data frame <code>sfl</code> containing the
sequential SupF test statistics with critical values at
<code style="white-space: pre;">&#8288;{10%,5%,2.5%,1%}&#8288;</code> level
</p>

<hr>
<h2 id='correct'>Heteroskedasticy and autocorrelation consistency correction for residuals</h2><span id='topic+correct'></span>

<h3>Description</h3>

<p><code>hac()</code> corrects the estimated errors based on options of prewhitening
using a AR(1) process estimation of error terms to obtain
heteroskedasticy and autocorrelation consistency (HAC) errors with automatic
bandwith and kernel similar to Andrews, 1994
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correct(reg, res, prewhit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="correct_+3A_reg">reg</code></td>
<td>
<p>matrix of regressors</p>
</td></tr>
<tr><td><code id="correct_+3A_res">res</code></td>
<td>
<p>matrix of estimated residuals</p>
</td></tr>
<tr><td><code id="correct_+3A_prewhit">prewhit</code></td>
<td>
<p>Option of using prewhitening process. If <code>1</code>, an AR(1)
process will be used to filter. If <code>0</code>, skipped the filtering process</p>
</td></tr>
</table>


<h3>Value</h3>

<p>hac Heteroskedasticy and autocorrelation consistent errors
</p>

<hr>
<h2 id='dating'>Computation of global minimizer for pure structural change model</h2><span id='topic+dating'></span>

<h3>Description</h3>

<p><code>dating()</code> computes break points that globally minimizes SSR via dynamic programming approach.
To avoid recursion depth increases as number of breaks in the model increases, a temporary
array is used to store optimal partition with corresponding SSR for all permissible
subsamples for all 1:m-1 breaks. For the m-th break, the problem becomes finding where to insert
the last feasible m+1-th segment into the sample partitioned by m-1 breaks
to obtain minimum SSR over the sample
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dating(y, z, h, m, q, bigT)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dating_+3A_y">y</code></td>
<td>
<p>matrix of dependent variable</p>
</td></tr>
<tr><td><code id="dating_+3A_z">z</code></td>
<td>
<p>matrix of regressors with coefficients
allowed to change across regimes</p>
</td></tr>
<tr><td><code id="dating_+3A_h">h</code></td>
<td>
<p>minimum length of segment</p>
</td></tr>
<tr><td><code id="dating_+3A_m">m</code></td>
<td>
<p>maximum number of breaks</p>
</td></tr>
<tr><td><code id="dating_+3A_q">q</code></td>
<td>
<p>number of <code>z</code> regressors</p>
</td></tr>
<tr><td><code id="dating_+3A_bigt">bigT</code></td>
<td>
<p>sample period T</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>glb</code></td>
<td>
<p>minimum global SSR</p>
</td></tr>
<tr><td><code>datevec</code></td>
<td>
<p>Vector of dates (optimal minimizers)</p>
</td></tr>
<tr><td><code>bigvec</code></td>
<td>
<p>Associated SSRs</p>
</td></tr>
</table>

<hr>
<h2 id='diag_par'>Diagonal partition given break dates</h2><span id='topic+diag_par'></span>

<h3>Description</h3>

<p><code>diag_par()</code> partition the matrix of <code>z</code> regressors which coefficients are changed
based on the provided break dates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diag_par(input, m, date)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diag_par_+3A_input">input</code></td>
<td>
<p>matrix of independent variables z with coefficients allowed to
change overtime</p>
</td></tr>
<tr><td><code id="diag_par_+3A_m">m</code></td>
<td>
<p>number of breaks in the series</p>
</td></tr>
<tr><td><code id="diag_par_+3A_date">date</code></td>
<td>
<p>vector of break dates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>output: matrix of partitioned variables corresponds to break dates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>z = matrix(c(1:100),50,2)
m = 2  #2 breaks
date = matrix(c(15,30),2,1) #first break at t = 15; second break at t = 30
diag_par(z,m,date)

</code></pre>

<hr>
<h2 id='dofix'>Estimate a model with pre-specified number of breaks</h2><span id='topic+dofix'></span>

<h3>Description</h3>

<p><code>dofix()</code> compute a structural change model with pre-specified number
of breaks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dofix(
  y_name,
  z_name = NULL,
  x_name = NULL,
  data,
  fixn = 5,
  eps = 1e-05,
  eps1 = 0.15,
  maxi = 10,
  fixb = 0,
  betaini = 0,
  printd = 0,
  prewhit = 1,
  robust = 1,
  hetdat = 1,
  hetvar = 1,
  hetq = 1,
  hetomega = 1,
  const = 1,
  h = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dofix_+3A_y_name">y_name</code></td>
<td>
<p>name of dependent variable in the data set</p>
</td></tr>
<tr><td><code id="dofix_+3A_z_name">z_name</code></td>
<td>
<p>name of independent variables in the data set which coefficients are allowed to change
across regimes. <code>default</code> is vector of 1 (Mean-shift model)</p>
</td></tr>
<tr><td><code id="dofix_+3A_x_name">x_name</code></td>
<td>
<p>name of independent variables in the data set which coefficients are constant across
regimes. <code>default</code> is <code>NULL</code></p>
</td></tr>
<tr><td><code id="dofix_+3A_data">data</code></td>
<td>
<p>name of data set used</p>
</td></tr>
<tr><td><code id="dofix_+3A_fixn">fixn</code></td>
<td>
<p>number of breaks specified</p>
</td></tr>
<tr><td><code id="dofix_+3A_eps">eps</code></td>
<td>
<p>convergence criterion for iterative recursive computation</p>
</td></tr>
<tr><td><code id="dofix_+3A_eps1">eps1</code></td>
<td>
<p>value of trimming (in percentage) for the construction
and critical values. Minimal segment length <code>h</code> will be set
at <code>default</code> = int(<code>eps1</code>*T) (T is total sample size).
</p>

<ul>
<li><p><code>eps1=0.05</code> Maximal value of <code>m</code> = 10
</p>
</li>
<li><p><code>eps1=0.10</code> Maximal value of <code>m</code> = 8
</p>
</li>
<li><p><code>eps1=.15</code> Maximal value of <code>m</code> = 5
</p>
</li>
<li><p><code>eps1=.20</code> Maximal value of <code>m</code> = 3
</p>
</li>
<li><p><code>eps1=.25</code> Maximal value of <code>m</code> = 2
</p>
</li>
<li><p><code>eps1=0</code> This option allows users to explicitly specify
minimum segment length <code>h</code> parameters</p>
</li></ul>
</td></tr>
<tr><td><code id="dofix_+3A_maxi">maxi</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
<tr><td><code id="dofix_+3A_fixb">fixb</code></td>
<td>
<p>option to use fixed initial input <code class="reqn">\beta</code>. If <code>1</code>,
the model will use values given in <code>betaini</code>. If <code>0</code>, betaini is skipped</p>
</td></tr>
<tr><td><code id="dofix_+3A_betaini">betaini</code></td>
<td>
<p>Initial <code class="reqn">beta_0</code> to use in estimation</p>
</td></tr>
<tr><td><code id="dofix_+3A_printd">printd</code></td>
<td>
<p>Print option for model estimation. <code>default</code> = 0, to
suppress intermediate outputs printing to console</p>
</td></tr>
<tr><td><code id="dofix_+3A_prewhit">prewhit</code></td>
<td>
<p>set to <code>1</code> to apply AR(1) prewhitening prior to estimating
the long run covariance matrix.</p>
</td></tr>
<tr><td><code id="dofix_+3A_robust">robust</code></td>
<td>
<p>set to <code>1</code> to allow for heterogeneity
and autocorrelation in the residuals, <code>0</code> otherwise.
The method used is <em>Andrews(1991)</em> automatic bandwidth with AR(1) approximation with quadratic
kernel. Note: Do not set to <code>1</code> if lagged dependent variables are
included as regressors.</p>
</td></tr>
<tr><td><code id="dofix_+3A_hetdat">hetdat</code></td>
<td>
<p>option for the construction of the F tests. Set to 1 if want to
allow different moment matrices of the regressors across segments.
If <code>hetdat</code> = <code>0</code>, the same moment matrices are assumed for each segment
and estimated from the ful sample. It is recommended to set
<code>hetdat</code>=<code>1</code> if number of regressors <code>x</code> &gt; <code>0</code>.</p>
</td></tr>
<tr><td><code id="dofix_+3A_hetvar">hetvar</code></td>
<td>
<p>option for the construction of the F tests.Set to <code>1</code>
if users want to allow for the variance of the residuals to be different across segments.
If <code>hetvar</code>=<code>0</code>, the variance of the residuals is assumed constant
across segments and constructed from the full sample. <code>hetvar</code>=<code>1</code> when <code>robust</code> =<code>1</code>)</p>
</td></tr>
<tr><td><code id="dofix_+3A_hetq">hetq</code></td>
<td>
<p>used in the construction of the confidence intervals for the break
dates. If <code>hetq</code>=<code>0</code>, the moment matrix of the data is assumed identical
across segments</p>
</td></tr>
<tr><td><code id="dofix_+3A_hetomega">hetomega</code></td>
<td>
<p>used in the construction of the confidence intervals for the break
dates. If <code>hetomega</code>=<code>0</code>, the long run covariance matrix of zu is
assumed identical across segments
(the variance of the errors u if <code>robust</code>=0)</p>
</td></tr>
<tr><td><code id="dofix_+3A_const">const</code></td>
<td>
<p>indicates whether the regression model include an
intercept changing across regimes. Default value is 1</p>
</td></tr>
<tr><td><code id="dofix_+3A_h">h</code></td>
<td>
<p>Minimum segment length of regime considered in estimation. If users want to specify a particular value, please set <code>eps1=0</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>out A list of class <code>model</code> contains all information about the
estimated structural change model with <code>fixn</code> breaks
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dofix('rate',data=real,fixn=3)

</code></pre>

<hr>
<h2 id='doglob'>Global SSR minimizer for structural change model</h2><span id='topic+doglob'></span>

<h3>Description</h3>

<p><code>doglob()</code> identify if the structural change model is i) pure or ii)
partial change model. The procedure then calls appropriate functions <code><a href="#topic+dating">dating</a></code> to estimate
the pure change model and <code><a href="#topic+nldat">nldat</a></code> to estimate the partial change model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>doglob(y, z, x, m, eps, h, maxi, fixb, betaini, printd, eps1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="doglob_+3A_y">y</code></td>
<td>
<p>matrix of dependent variable</p>
</td></tr>
<tr><td><code id="doglob_+3A_z">z</code></td>
<td>
<p>matrix of independent variables with coefficients allowed to change across
regimes</p>
</td></tr>
<tr><td><code id="doglob_+3A_x">x</code></td>
<td>
<p>matrix of independent variables with coefficients constant across regimes</p>
</td></tr>
<tr><td><code id="doglob_+3A_m">m</code></td>
<td>
<p>number of breaks in the structural change model</p>
</td></tr>
<tr><td><code id="doglob_+3A_eps">eps</code></td>
<td>
<p>convergence criterion for iterative recursive computation. (For partial change model ONLY)</p>
</td></tr>
<tr><td><code id="doglob_+3A_h">h</code></td>
<td>
<p>Minimum segment length of regime considered in estimation. If users want to specify a particular value, please set <code>eps1=0</code></p>
</td></tr>
<tr><td><code id="doglob_+3A_maxi">maxi</code></td>
<td>
<p>maximum number of iterations. (For partial change model ONLY)</p>
</td></tr>
<tr><td><code id="doglob_+3A_fixb">fixb</code></td>
<td>
<p>option to use fixed initial input <code class="reqn">\beta</code>. If <code>1</code>,
the model will use values given in <code>betaini</code>. If <code>0</code>, betaini is skipped</p>
</td></tr>
<tr><td><code id="doglob_+3A_betaini">betaini</code></td>
<td>
<p>Initial <code class="reqn">beta_0</code> to use in estimation (Must be a <code style="white-space: pre;">&#8288;p x 1&#8288;</code> matrix, where p is number of x variables)</p>
</td></tr>
<tr><td><code id="doglob_+3A_printd">printd</code></td>
<td>
<p>Print option for model estimation. <code>default</code> = 0, to
suppress intermediate outputs printing to console</p>
</td></tr>
<tr><td><code id="doglob_+3A_eps1">eps1</code></td>
<td>
<p>trimming level</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>

<ul>
<li><p>glb Minimum global SSR
</p>
</li>
<li><p>datevec Vector of dates (optimal minimizers)
</p>
</li>
<li><p>bigvec Associated SSRs with possible break dates combination</p>
</li></ul>


<hr>
<h2 id='doorder'>Estimating number of breaks via information criterion</h2><span id='topic+doorder'></span>

<h3>Description</h3>

<p><code>doorder()</code> estimates the number of breaks
using one of the following information criteria:
</p>
<ul>
<li><p> modified Bayesian information criterion by Kurozumi and Tuvaandorj, 2011,
</p>
</li>
<li><p> modified Schwarz information criterion by Liu, Wu and Zidek, 1997,
</p>
</li>
<li><p> Bayesian information criterion by Yao, 1988 </p>
</li></ul>
<p> and the structural break model
corresponding to estimated number of breaks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>doorder(
  y_name,
  z_name = NULL,
  x_name = NULL,
  data,
  m = 5,
  eps = 1e-05,
  eps1 = 0.15,
  maxi = 10,
  fixb = 0,
  betaini = 0,
  printd = 0,
  ic = "KT",
  const = 1,
  h = NULL,
  prewhit = 1,
  hetdat = 1,
  hetq = 1,
  hetomega = 1,
  hetvar = 1,
  robust = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="doorder_+3A_y_name">y_name</code></td>
<td>
<p>name of dependent variable in the data set</p>
</td></tr>
<tr><td><code id="doorder_+3A_z_name">z_name</code></td>
<td>
<p>name of independent variables in the data set which coefficients are allowed to change
across regimes. <code>default</code> is vector of 1 (Mean-shift model)</p>
</td></tr>
<tr><td><code id="doorder_+3A_x_name">x_name</code></td>
<td>
<p>name of independent variables in the data set which coefficients are constant across
regimes. <code>default</code> is <code>NULL</code></p>
</td></tr>
<tr><td><code id="doorder_+3A_data">data</code></td>
<td>
<p>name of data set used</p>
</td></tr>
<tr><td><code id="doorder_+3A_m">m</code></td>
<td>
<p>maximum number of breaks</p>
</td></tr>
<tr><td><code id="doorder_+3A_eps">eps</code></td>
<td>
<p>convergence criterion for iterative recursive computation</p>
</td></tr>
<tr><td><code id="doorder_+3A_eps1">eps1</code></td>
<td>
<p>value of trimming (in percentage) for the construction
and critical values. Minimal segment length <code>h</code> will be set
at <code>default</code> = int(<code>eps1</code>*T) (T is total sample size).
</p>

<ul>
<li><p><code>eps1=0.05</code> Maximal value of <code>m</code> = 10
</p>
</li>
<li><p><code>eps1=0.10</code> Maximal value of <code>m</code> = 8
</p>
</li>
<li><p><code>eps1=.15</code> Maximal value of <code>m</code> = 5
</p>
</li>
<li><p><code>eps1=.20</code> Maximal value of <code>m</code> = 3
</p>
</li>
<li><p><code>eps1=.25</code> Maximal value of <code>m</code> = 2
</p>
</li>
<li><p><code>eps1=0</code> This option allows users to explicitly specify
minimum segment length <code>h</code> parameters</p>
</li></ul>
</td></tr>
<tr><td><code id="doorder_+3A_maxi">maxi</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
<tr><td><code id="doorder_+3A_fixb">fixb</code></td>
<td>
<p>option to use fixed initial input <code class="reqn">\beta</code>. If <code>1</code>,
the model will use values given in <code>betaini</code>. If <code>0</code>, betaini is skipped</p>
</td></tr>
<tr><td><code id="doorder_+3A_betaini">betaini</code></td>
<td>
<p>Initial <code class="reqn">beta_0</code> to use in estimation</p>
</td></tr>
<tr><td><code id="doorder_+3A_printd">printd</code></td>
<td>
<p>Print option for model estimation. <code>default</code> = 0, to
suppress intermediate outputs printing to console</p>
</td></tr>
<tr><td><code id="doorder_+3A_ic">ic</code></td>
<td>
<p>indicator which information criterion is used in selecting number of breaks:
<code style="white-space: pre;">&#8288;{'KT','BIC','LWZ'}&#8288;</code>. The default value is <code>'KT'</code></p>
</td></tr>
<tr><td><code id="doorder_+3A_const">const</code></td>
<td>
<p>indicates whether the regression model include an
intercept changing across regimes. Default value is 1</p>
</td></tr>
<tr><td><code id="doorder_+3A_h">h</code></td>
<td>
<p>Minimum segment length of regime considered in estimation. If users want to specify a particular value, please set <code>eps1=0</code></p>
</td></tr>
<tr><td><code id="doorder_+3A_prewhit">prewhit</code></td>
<td>
<p>set to <code>1</code> to apply AR(1) prewhitening prior to estimating
the long run covariance matrix.</p>
</td></tr>
<tr><td><code id="doorder_+3A_hetdat">hetdat</code></td>
<td>
<p>option for the construction of the F tests. Set to 1 if want to
allow different moment matrices of the regressors across segments.
If <code>hetdat</code> = <code>0</code>, the same moment matrices are assumed for each segment
and estimated from the ful sample. It is recommended to set
<code>hetdat</code>=<code>1</code> if number of regressors <code>x</code> &gt; <code>0</code>.</p>
</td></tr>
<tr><td><code id="doorder_+3A_hetq">hetq</code></td>
<td>
<p>used in the construction of the confidence intervals for the break
dates. If <code>hetq</code>=<code>0</code>, the moment matrix of the data is assumed identical
across segments</p>
</td></tr>
<tr><td><code id="doorder_+3A_hetomega">hetomega</code></td>
<td>
<p>used in the construction of the confidence intervals for the break
dates. If <code>hetomega</code>=<code>0</code>, the long run covariance matrix of zu is
assumed identical across segments
(the variance of the errors u if <code>robust</code>=0)</p>
</td></tr>
<tr><td><code id="doorder_+3A_hetvar">hetvar</code></td>
<td>
<p>option for the construction of the F tests.Set to <code>1</code>
if users want to allow for the variance of the residuals to be different across segments.
If <code>hetvar</code>=<code>0</code>, the variance of the residuals is assumed constant
across segments and constructed from the full sample. <code>hetvar</code>=<code>1</code> when <code>robust</code> =<code>1</code>)</p>
</td></tr>
<tr><td><code id="doorder_+3A_robust">robust</code></td>
<td>
<p>set to <code>1</code> to allow for heterogeneity
and autocorrelation in the residuals, <code>0</code> otherwise.
The method used is <em>Andrews(1991)</em> automatic bandwidth with AR(1) approximation with quadratic
kernel. Note: Do not set to <code>1</code> if lagged dependent variables are
included as regressors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>model</code> that contains one of the following:
</p>
<table>
<tr><td><code>mBIC</code></td>
<td>
<p>change model with number of breaks selected by BIC</p>
</td></tr>
<tr><td><code>mLWZ</code></td>
<td>
<p>change model with number of breaks selected by LWZ</p>
</td></tr>
<tr><td><code>mKT</code></td>
<td>
<p>change model with number of breaks selected by KT</p>
</td></tr>
</table>


<h3>References</h3>

<p>Liu J, Wu S, Zidek JV (1997). <em>&quot;On Segmented Multivariate Regressions&quot;</em>,
Statistica Sinica, 7, 497-525.
Yao YC (1988). <em>&quot;Estimating the Number of Change-points via Schwartz Criterion&quot;</em>,
Statistics and Probability Letters, 6, 181-189.
Kurozumi E, Tuvaandorj P (2011). <em>&quot;Model Selection Criteria in Multivariate Models with
Multiple Structural Changes&quot;</em>, Journal of Econometrics 164, 218-238.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>doorder('rate',data=real,ic=c('BIC'))

</code></pre>

<hr>
<h2 id='dorepart'>Estimating number of breaks using repartition procedure</h2><span id='topic+dorepart'></span>

<h3>Description</h3>

<p><code>dorepart()</code> computes the repartition estimates of the breaks obtained
by the sequential method by Bai, 1995.. It alows estimates that have the same asymptotic
distribution as those obtained by global minimization. Otherwise, the
output from the procedure &quot;estim&quot; below do not deliver asymptotically
correct confidence intervals for the break dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dorepart(
  y_name,
  z_name = NULL,
  x_name = NULL,
  data,
  m = 5,
  eps = 1e-05,
  eps1 = 0.15,
  maxi = 10,
  fixb = 0,
  betaini = 0,
  printd = 0,
  prewhit = 1,
  robust = 1,
  hetdat = 1,
  hetvar = 1,
  const = 1,
  signif = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dorepart_+3A_y_name">y_name</code></td>
<td>
<p>name of dependent variable in the data set</p>
</td></tr>
<tr><td><code id="dorepart_+3A_z_name">z_name</code></td>
<td>
<p>name of independent variables in the data set which coefficients are allowed to change
across regimes. <code>default</code> is vector of 1 (Mean-shift model)</p>
</td></tr>
<tr><td><code id="dorepart_+3A_x_name">x_name</code></td>
<td>
<p>name of independent variables in the data set which coefficients are constant across
regimes. <code>default</code> is <code>NULL</code></p>
</td></tr>
<tr><td><code id="dorepart_+3A_data">data</code></td>
<td>
<p>name of data set used</p>
</td></tr>
<tr><td><code id="dorepart_+3A_m">m</code></td>
<td>
<p>Maximum number of structural changes allowed. If not specify,
m will be set to <code>default</code> value matching <code>eps1</code> input</p>
</td></tr>
<tr><td><code id="dorepart_+3A_eps">eps</code></td>
<td>
<p>convergence criterion for iterative recursive computation</p>
</td></tr>
<tr><td><code id="dorepart_+3A_eps1">eps1</code></td>
<td>
<p>value of trimming (in percentage) for the construction
and critical values. Minimal segment length <code>h</code> will be set
at <code>default</code> = int(<code>eps1</code>*T) (T is total sample size).
</p>

<ul>
<li>
</li>
<li><p><code>eps1=0.05</code> Maximal value of <code>m</code> = 10
</p>
</li>
<li><p><code>eps1=0.10</code> Maximal value of <code>m</code> = 8
</p>
</li>
<li><p><code>eps1=.15</code> Maximal value of <code>m</code> = 5
</p>
</li>
<li><p><code>eps1=.20</code> Maximal value of <code>m</code> = 3
</p>
</li>
<li><p><code>eps1=.25</code> Maximal value of <code>m</code> = 2
</p>
</li>
<li><p><code>eps1=0</code> This option is not allowed</p>
</li></ul>
</td></tr>
<tr><td><code id="dorepart_+3A_maxi">maxi</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
<tr><td><code id="dorepart_+3A_fixb">fixb</code></td>
<td>
<p>option to use fixed initial input <code class="reqn">\beta</code>. If <code>1</code>,
the model will use values given in <code>betaini</code>. If <code>0</code>, betaini is skipped</p>
</td></tr>
<tr><td><code id="dorepart_+3A_betaini">betaini</code></td>
<td>
<p>Initial <code class="reqn">beta_0</code> to use in estimation</p>
</td></tr>
<tr><td><code id="dorepart_+3A_printd">printd</code></td>
<td>
<p>Print option for model estimation. <code>default</code> = 0, to
suppress intermediate outputs printing to console</p>
</td></tr>
<tr><td><code id="dorepart_+3A_prewhit">prewhit</code></td>
<td>
<p>set to <code>1</code> to apply AR(1) prewhitening prior to estimating
the long run covariance matrix.</p>
</td></tr>
<tr><td><code id="dorepart_+3A_robust">robust</code></td>
<td>
<p>set to <code>1</code> to allow for heterogeneity
and autocorrelation in the residuals, <code>0</code> otherwise.
The method used is <em>Andrews(1991)</em> automatic bandwidth with AR(1) approximation with quadratic
kernel. Note: Do not set to <code>1</code> if lagged dependent variables are
included as regressors.</p>
</td></tr>
<tr><td><code id="dorepart_+3A_hetdat">hetdat</code></td>
<td>
<p>option for the construction of the F tests. Set to 1 if want to
allow different moment matrices of the regressors across segments.
If <code>hetdat</code> = <code>0</code>, the same moment matrices are assumed for each segment
and estimated from the ful sample. It is recommended to set
<code>hetdat</code>=<code>1</code> if number of regressors <code>x</code> &gt; <code>0</code>.</p>
</td></tr>
<tr><td><code id="dorepart_+3A_hetvar">hetvar</code></td>
<td>
<p>option for the construction of the F tests.Set to <code>1</code>
if users want to allow for the variance of the residuals to be different across segments.
If <code>hetvar</code>=<code>0</code>, the variance of the residuals is assumed constant
across segments and constructed from the full sample. <code>hetvar</code>=<code>1</code> when <code>robust</code> =<code>1</code>)</p>
</td></tr>
<tr><td><code id="dorepart_+3A_const">const</code></td>
<td>
<p>indicates whether the regression model include an
intercept changing across regimes. Default value is 1</p>
</td></tr>
<tr><td><code id="dorepart_+3A_signif">signif</code></td>
<td>
<p>significance level used to sequential test to select number of breaks.
</p>

<ul>
<li><p> 4: 1% level
</p>
</li>
<li><p> 3: 2.5% level
</p>
</li>
<li><p> 2: 5% level
</p>
</li>
<li><p> 1: 10% level
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>out A list of <code>model</code> class for structural break model estimating by
repartition procedure
</p>


<h3>References</h3>

<p>Bai, J. 1995, <em>&quot;Estimating Breaks one at a time&quot;</em>, Econometric Theory, 13,
315-352
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dorepart('inf','inflag','inffut',data=nkpc)
</code></pre>

<hr>
<h2 id='doseqtests'>Sequential Sup F tests</h2><span id='topic+doseqtests'></span>

<h3>Description</h3>

<p><code>doseqtests()</code> computes the sequential sup F tests of l versus l+1 for l from
1 to m with each corresponding null hypothesis of maximum number of break is l
and alternative hypothesis is l+1. The l breaks under the null hypothesis
are taken from the global minimization estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>doseqtests(
  y_name,
  z_name = NULL,
  x_name = NULL,
  data,
  m = 5,
  eps = 1e-05,
  eps1 = 0.15,
  maxi = 10,
  fixb = 0,
  betaini = 0,
  printd = 0,
  prewhit = 1,
  robust = 1,
  hetdat = 1,
  hetvar = 1,
  hetq = 1,
  hetomega = 1,
  const = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="doseqtests_+3A_y_name">y_name</code></td>
<td>
<p>name of dependent variable in the data set</p>
</td></tr>
<tr><td><code id="doseqtests_+3A_z_name">z_name</code></td>
<td>
<p>name of independent variables in the data set which coefficients are allowed to change
across regimes. <code>default</code> is vector of 1 (Mean-shift model)</p>
</td></tr>
<tr><td><code id="doseqtests_+3A_x_name">x_name</code></td>
<td>
<p>name of independent variables in the data set which coefficients are constant across
regimes. <code>default</code> is <code>NULL</code></p>
</td></tr>
<tr><td><code id="doseqtests_+3A_data">data</code></td>
<td>
<p>name of data set used</p>
</td></tr>
<tr><td><code id="doseqtests_+3A_m">m</code></td>
<td>
<p>maximum number of breaks</p>
</td></tr>
<tr><td><code id="doseqtests_+3A_eps">eps</code></td>
<td>
<p>convergence criterion for recursive calculations (For partial change model ONLY)</p>
</td></tr>
<tr><td><code id="doseqtests_+3A_eps1">eps1</code></td>
<td>
<p>value of trimming (in percentage) for the construction
and critical values. Minimal segment length <code>h</code> will be set
at <code>default</code> = int(<code>eps1</code>*T) (T is total sample size).
There are five options:
</p>

<ul>
<li><p><code>eps1=0.05</code> Maximal value of <code>m</code> = 10
</p>
</li>
<li><p><code>eps1=0.10</code> Maximal value of <code>m</code> = 8
</p>
</li>
<li><p><code>eps1=.15</code> Maximal value of <code>m</code> = 5
</p>
</li>
<li><p><code>eps1=.20</code> Maximal value of <code>m</code> = 3
</p>
</li>
<li><p><code>eps1=.25</code> Maximal value of <code>m</code> = 2
</p>
</li>
<li><p><code>eps1=0</code> is not allowed. The test is undefined for no trimming level
</p>
</li></ul>
</td></tr>
<tr><td><code id="doseqtests_+3A_maxi">maxi</code></td>
<td>
<p>number of maximum iterations for recursive calculations of finding
global minimizers.<code>default</code> = 10 (For partial change model ONLY)</p>
</td></tr>
<tr><td><code id="doseqtests_+3A_fixb">fixb</code></td>
<td>
<p>option to use fixed initial input <code class="reqn">\beta</code>. If <code>1</code>,
the model will use values given in <code>betaini</code>. If <code>0</code>, betaini is skipped</p>
</td></tr>
<tr><td><code id="doseqtests_+3A_betaini">betaini</code></td>
<td>
<p>Initial <code class="reqn">beta_0</code> to use in estimation (Must be a <code style="white-space: pre;">&#8288;p x 1&#8288;</code> matrix, where p is number of x variables)</p>
</td></tr>
<tr><td><code id="doseqtests_+3A_printd">printd</code></td>
<td>
<p>Print option for model estimation. <code>default</code> = 0, to
suppress intermediate outputs printing to console</p>
</td></tr>
<tr><td><code id="doseqtests_+3A_prewhit">prewhit</code></td>
<td>
<p>set to <code>1</code> to apply AR(1) prewhitening prior to estimating
the long run covariance matrix.</p>
</td></tr>
<tr><td><code id="doseqtests_+3A_robust">robust</code></td>
<td>
<p>set to <code>1</code> to allow for heterogeneity
and autocorrelation in the residuals, <code>0</code> otherwise.
The method used is <em>Andrews(1991)</em> automatic bandwidth with AR(1) approximation with quadratic
kernel. Note: Do not set to <code>1</code> if lagged dependent variables are
included as regressors.</p>
</td></tr>
<tr><td><code id="doseqtests_+3A_hetdat">hetdat</code></td>
<td>
<p>option for the construction of the F tests. Set to 1 if want to
allow different moment matrices of the regressors across segments.
If <code>hetdat</code> = <code>0</code>, the same moment matrices are assumed for each segment
and estimated from the ful sample. It is recommended to set
<code>hetdat</code>=<code>1</code> if number of regressors <code>x</code> &gt; <code>0</code>.</p>
</td></tr>
<tr><td><code id="doseqtests_+3A_hetvar">hetvar</code></td>
<td>
<p>option for the construction of the F tests.Set to <code>1</code>
if users want to allow for the variance of the residuals to be different across segments.
If <code>hetvar</code>=<code>0</code>, the variance of the residuals is assumed constant
across segments and constructed from the full sample. <code>hetvar</code>=<code>1</code> when <code>robust</code> =<code>1</code>)</p>
</td></tr>
<tr><td><code id="doseqtests_+3A_hetq">hetq</code></td>
<td>
<p>used in the construction of the confidence intervals for the break
dates. If <code>hetq</code>=<code>0</code>, the moment matrix of the data is assumed identical
across segments</p>
</td></tr>
<tr><td><code id="doseqtests_+3A_hetomega">hetomega</code></td>
<td>
<p>used in the construction of the confidence intervals for the break
dates. If <code>hetomega</code>=<code>0</code>, the long run covariance matrix of zu is
assumed identical across segments
(the variance of the errors u if <code>robust</code>=0)</p>
</td></tr>
<tr><td><code id="doseqtests_+3A_const">const</code></td>
<td>
<p>indicates whether the regression model include an
intercept changing across regimes. Default value is 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list that contains following:
</p>

<ul>
<li><p>supfl: SupF(l+1|l) test statistics
</p>
</li>
<li><p>cv: Critical values for SupF(l+1|l) test</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>doseqtests('inf',c('inflag','lbs','inffut'),data=nkpc,prewhit=0)

</code></pre>

<hr>
<h2 id='dosequa'>Estimating number of breaks using sequential tests</h2><span id='topic+dosequa'></span>

<h3>Description</h3>

<p><code>dosequa()</code> sequentially increases the number of breaks from <code>1</code> to <code>m</code>
until the sequential tests reject and estimate the structural change model
with corresponding estimated breaks. The procedure is proposed by
Bai and Perron, 1998
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dosequa(
  y_name,
  z_name = NULL,
  x_name = NULL,
  data,
  m = 5,
  eps = 1e-05,
  eps1 = 0.15,
  maxi = 10,
  fixb = 0,
  betaini = 0,
  printd = 0,
  prewhit = 1,
  robust = 1,
  hetdat = 1,
  hetvar = 1,
  hetq = 1,
  hetomega = 1,
  const = 1,
  signif = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dosequa_+3A_y_name">y_name</code></td>
<td>
<p>name of dependent variable in the data set</p>
</td></tr>
<tr><td><code id="dosequa_+3A_z_name">z_name</code></td>
<td>
<p>name of independent variables in the data set which coefficients are allowed to change
across regimes. <code>default</code> is vector of 1 (Mean-shift model)</p>
</td></tr>
<tr><td><code id="dosequa_+3A_x_name">x_name</code></td>
<td>
<p>name of independent variables in the data set which coefficients are constant across
regimes. <code>default</code> is <code>NULL</code></p>
</td></tr>
<tr><td><code id="dosequa_+3A_data">data</code></td>
<td>
<p>name of data set used</p>
</td></tr>
<tr><td><code id="dosequa_+3A_m">m</code></td>
<td>
<p>Maximum number of structural changes allowed. If not specify,
m will be set to <code>default</code> value matching <code>eps1</code> input</p>
</td></tr>
<tr><td><code id="dosequa_+3A_eps">eps</code></td>
<td>
<p>convergence criterion for iterative recursive computation</p>
</td></tr>
<tr><td><code id="dosequa_+3A_eps1">eps1</code></td>
<td>
<p>value of trimming (in percentage) for the construction
and critical values. Minimal segment length <code>h</code> will be set
at <code>default</code> = int(<code>eps1</code>*T) (T is total sample size).
</p>

<ul>
<li>
</li>
<li><p><code>eps1=0.05</code> Maximal value of <code>m</code> = 10
</p>
</li>
<li><p><code>eps1=0.10</code> Maximal value of <code>m</code> = 8
</p>
</li>
<li><p><code>eps1=.15</code> Maximal value of <code>m</code> = 5
</p>
</li>
<li><p><code>eps1=.20</code> Maximal value of <code>m</code> = 3
</p>
</li>
<li><p><code>eps1=.25</code> Maximal value of <code>m</code> = 2
</p>
</li>
<li><p><code>eps1=0</code> This option is not allowed</p>
</li></ul>
</td></tr>
<tr><td><code id="dosequa_+3A_maxi">maxi</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
<tr><td><code id="dosequa_+3A_fixb">fixb</code></td>
<td>
<p>option to use fixed initial input <code class="reqn">\beta</code>. If <code>1</code>,
the model will use values given in <code>betaini</code>. If <code>0</code>, betaini is skipped</p>
</td></tr>
<tr><td><code id="dosequa_+3A_betaini">betaini</code></td>
<td>
<p>Initial <code class="reqn">beta_0</code> to use in estimation</p>
</td></tr>
<tr><td><code id="dosequa_+3A_printd">printd</code></td>
<td>
<p>Print option for model estimation. <code>default</code> = 0, to
suppress intermediate outputs printing to console</p>
</td></tr>
<tr><td><code id="dosequa_+3A_prewhit">prewhit</code></td>
<td>
<p>set to <code>1</code> to apply AR(1) prewhitening prior to estimating
the long run covariance matrix.</p>
</td></tr>
<tr><td><code id="dosequa_+3A_robust">robust</code></td>
<td>
<p>set to <code>1</code> to allow for heterogeneity
and autocorrelation in the residuals, <code>0</code> otherwise.
The method used is <em>Andrews(1991)</em> automatic bandwidth with AR(1) approximation with quadratic
kernel. Note: Do not set to <code>1</code> if lagged dependent variables are
included as regressors.</p>
</td></tr>
<tr><td><code id="dosequa_+3A_hetdat">hetdat</code></td>
<td>
<p>option for the construction of the F tests. Set to 1 if want to
allow different moment matrices of the regressors across segments.
If <code>hetdat</code> = <code>0</code>, the same moment matrices are assumed for each segment
and estimated from the ful sample. It is recommended to set
<code>hetdat</code>=<code>1</code> if number of regressors <code>x</code> &gt; <code>0</code>.</p>
</td></tr>
<tr><td><code id="dosequa_+3A_hetvar">hetvar</code></td>
<td>
<p>option for the construction of the F tests.Set to <code>1</code>
if users want to allow for the variance of the residuals to be different across segments.
If <code>hetvar</code>=<code>0</code>, the variance of the residuals is assumed constant
across segments and constructed from the full sample. <code>hetvar</code>=<code>1</code> when <code>robust</code> =<code>1</code>)</p>
</td></tr>
<tr><td><code id="dosequa_+3A_hetq">hetq</code></td>
<td>
<p>used in the construction of the confidence intervals for the break
dates. If <code>hetq</code>=<code>0</code>, the moment matrix of the data is assumed identical
across segments</p>
</td></tr>
<tr><td><code id="dosequa_+3A_hetomega">hetomega</code></td>
<td>
<p>used in the construction of the confidence intervals for the break
dates. If <code>hetomega</code>=<code>0</code>, the long run covariance matrix of zu is
assumed identical across segments
(the variance of the errors u if <code>robust</code>=0)</p>
</td></tr>
<tr><td><code id="dosequa_+3A_const">const</code></td>
<td>
<p>indicates whether the regression model include an
intercept changing across regimes. Default value is 1</p>
</td></tr>
<tr><td><code id="dosequa_+3A_signif">signif</code></td>
<td>
<p>significance level used to sequential test to select number of breaks.
</p>

<ul>
<li><p> 4: 1% level
</p>
</li>
<li><p> 3: 2.5% level
</p>
</li>
<li><p> 2: 5% level
</p>
</li>
<li><p> 1: 10% level
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>out A list of <code>model</code> class with number of breaks selected by sequential tests
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dosequa('rate',data=real,signif=1)
</code></pre>

<hr>
<h2 id='dotest'>SupF, UDMax &amp; WDMax testing procedure</h2><span id='topic+dotest'></span>

<h3>Description</h3>

<p><code>dotest()</code> compute the test statistics and report the critical values of
the 2 main supF tests below:
</p>

<ul>
<li><p>SupF test of 0 vs m breaks
</p>
</li>
<li><p>Double Max test proposed by Perron and Bai, 1998
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>dotest(
  y_name,
  z_name = NULL,
  x_name = NULL,
  data,
  m = 5,
  eps = 1e-05,
  eps1 = 0.15,
  maxi = 10,
  fixb = 0,
  betaini = 0,
  printd = 0,
  prewhit = 1,
  robust = 1,
  hetdat = 1,
  hetvar = 1,
  hetq = 1,
  hetomega = 1,
  const = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dotest_+3A_y_name">y_name</code></td>
<td>
<p>matrix of dependent variable</p>
</td></tr>
<tr><td><code id="dotest_+3A_z_name">z_name</code></td>
<td>
<p>matrix of regressors which coefficients are allowed to change
across regimes.</p>
</td></tr>
<tr><td><code id="dotest_+3A_x_name">x_name</code></td>
<td>
<p>matrix of regressors which coefficients are constant across
regimes.</p>
</td></tr>
<tr><td><code id="dotest_+3A_data">data</code></td>
<td>
<p>the data set for estimation</p>
</td></tr>
<tr><td><code id="dotest_+3A_m">m</code></td>
<td>
<p>maximum number of breaks</p>
</td></tr>
<tr><td><code id="dotest_+3A_eps">eps</code></td>
<td>
<p>convergence criterion for iterative recursive computation</p>
</td></tr>
<tr><td><code id="dotest_+3A_eps1">eps1</code></td>
<td>
<p>trimming level</p>
</td></tr>
<tr><td><code id="dotest_+3A_maxi">maxi</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
<tr><td><code id="dotest_+3A_fixb">fixb</code></td>
<td>
<p>option to use fixed initial input <code class="reqn">\beta</code>. If <code>1</code>,
the model will use values given in <code>betaini</code>. If <code>0</code>, betaini is skipped</p>
</td></tr>
<tr><td><code id="dotest_+3A_betaini">betaini</code></td>
<td>
<p>Initial <code class="reqn">beta_0</code> to use in estimation (Must be a <code style="white-space: pre;">&#8288;p x 1&#8288;</code> matrix, where p is number of x variables)</p>
</td></tr>
<tr><td><code id="dotest_+3A_printd">printd</code></td>
<td>
<p>Print option for model estimation. <code>default</code> = 0, to
suppress intermediate outputs printing to console</p>
</td></tr>
<tr><td><code id="dotest_+3A_prewhit">prewhit</code></td>
<td>
<p>option to use AR(1) for prewhitening</p>
</td></tr>
<tr><td><code id="dotest_+3A_robust">robust</code></td>
<td>
<p>set to <code>1</code> to allow for heterogeneity
and autocorrelation in the residuals, <code>0</code> otherwise.
The method used is <em>Andrews(1991)</em> automatic bandwidth with AR(1) approximation with quadratic
kernel. Note: Do not set to <code>1</code> if lagged dependent variables are
included as regressors.</p>
</td></tr>
<tr><td><code id="dotest_+3A_hetdat">hetdat</code></td>
<td>
<p>option for the construction of the F tests. Set to 1 if want to
allow different moment matrices of the regressors across segments.
If <code>hetdat</code> = <code>0</code>, the same moment matrices are assumed for each segment
and estimated from the ful sample. It is recommended to set
<code>hetdat</code>=<code>1</code> if number of regressors <code>x</code> &gt; <code>0</code>.</p>
</td></tr>
<tr><td><code id="dotest_+3A_hetvar">hetvar</code></td>
<td>
<p>option for the construction of the F tests.Set to <code>1</code>
if users want to allow for the variance of the residuals to be different across segments.
If <code>hetvar</code>=<code>0</code>, the variance of the residuals is assumed constant
across segments and constructed from the full sample. <code>hetvar</code>=<code>1</code> when <code>robust</code> =<code>1</code>)</p>
</td></tr>
<tr><td><code id="dotest_+3A_hetq">hetq</code></td>
<td>
<p>used in the construction of the confidence intervals for the break
dates. If <code>hetq</code>=<code>0</code>, the moment matrix of the data is assumed identical
across segments</p>
</td></tr>
<tr><td><code id="dotest_+3A_hetomega">hetomega</code></td>
<td>
<p>used in the construction of the confidence intervals for the break
dates. If <code>hetomega</code>=<code>0</code>, the long run covariance matrix of zu is
assumed identical across segments
(the variance of the errors u if <code>robust</code>=0)</p>
</td></tr>
<tr><td><code id="dotest_+3A_const">const</code></td>
<td>
<p>indicates whether the regression model include an
intercept changing across regimes. Default value is 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list that contains following:
</p>

<ul>
<li><p>ftest: SupF test of 0 vs m (1 to maximum) breaks statistics
</p>
</li>
<li><p>cv_supF: Critical values for Sup F test 
</p>
</li>
<li><p>cv_Dmax: Critical values for Double Max test
</p>
</li>
<li><p>supF1: table summarizing the SupF test (for viewing purposes)
</p>
</li>
<li><p>UDMax: table summarizing the Double Max test (including UDMax statistics and CVs)
</p>
</li></ul>


<hr>
<h2 id='estim'>Structural change model estimation</h2><span id='topic+estim'></span>

<h3>Description</h3>

<p><code>estim()</code> estimates the structural change model by OLS given specified vector of break dates
It also computes and reports confidence intervals for the
break dates based on asymptotic distributions of break date  and
corrected standard errors of coefficients estimates given the structure of covariance matrix
for model errors by specifying error options <code>robust</code>, <code>hetomega</code>, <code>hetq</code>, <code>hetdat</code> and <code>hetvar</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estim(m, q, z, y, b, robust, prewhit, hetomega, hetq, x, p, hetdat, hetvar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estim_+3A_m">m</code></td>
<td>
<p>number of breaks</p>
</td></tr>
<tr><td><code id="estim_+3A_q">q</code></td>
<td>
<p>number of <code>z</code> regressors z</p>
</td></tr>
<tr><td><code id="estim_+3A_z">z</code></td>
<td>
<p>matrix of regressors with coefficients are allowed to change across
regimes</p>
</td></tr>
<tr><td><code id="estim_+3A_y">y</code></td>
<td>
<p>matrix of dependent variable</p>
</td></tr>
<tr><td><code id="estim_+3A_b">b</code></td>
<td>
<p>vector of break dates</p>
</td></tr>
<tr><td><code id="estim_+3A_robust">robust</code>, <code id="estim_+3A_hetomega">hetomega</code>, <code id="estim_+3A_hetq">hetq</code>, <code id="estim_+3A_hetdat">hetdat</code>, <code id="estim_+3A_hetvar">hetvar</code></td>
<td>
<p>options for assumptions on the error terms.
For more details, please refer to <code><a href="#topic+mdl">mdl()</a></code>.</p>
</td></tr>
<tr><td><code id="estim_+3A_prewhit">prewhit</code></td>
<td>
<p>option to use prewhitening process based on AR(1) approximation</p>
</td></tr>
<tr><td><code id="estim_+3A_x">x</code></td>
<td>
<p>matrix of regressors with coefficients are constant across regimes</p>
</td></tr>
<tr><td><code id="estim_+3A_p">p</code></td>
<td>
<p>number of regressors x</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>

<ul>
<li><p>date List of estimated breaks
</p>
</li>
<li><p>CI List of Confidence Intervals for each corresponding break
</p>
</li>
<li><p>beta Estimated coefficients of the regression. The first
(<code>m</code>+1)*<code>q</code> are coefficients of <code>q</code> variables <code>z</code> that change across regimes.
The last <code>p</code> are coefficients of <code>p</code> variables <code>x</code>
that are constant across regimes
</p>
</li>
<li><p>SE Corrected standard errors for the coefficients' estimates</p>
</li></ul>


<hr>
<h2 id='interval'>Estimatd break confidence interval</h2><span id='topic+interval'></span>

<h3>Description</h3>

<p><code>interval()</code> computes confidence intervals for the break dates based on
approximating the limiting distribution of the break date following
the &quot;shrinking shifts&quot; asymptotic framework
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interval(y, z, zbar, b, q, m, robust, prewhit, hetomega, hetq, x, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interval_+3A_y">y</code></td>
<td>
<p>matrix of dependent variable</p>
</td></tr>
<tr><td><code id="interval_+3A_z">z</code></td>
<td>
<p>matrix of independent variables with coefficients allowed to change
across regimes</p>
</td></tr>
<tr><td><code id="interval_+3A_zbar">zbar</code></td>
<td>
<p>partitioned matrix of independent variables with coefficients allowed
to change across regimes according to break date vector <code>b</code></p>
</td></tr>
<tr><td><code id="interval_+3A_b">b</code></td>
<td>
<p>vector of break breaks</p>
</td></tr>
<tr><td><code id="interval_+3A_q">q</code></td>
<td>
<p>number of <code>z</code> regressors</p>
</td></tr>
<tr><td><code id="interval_+3A_m">m</code></td>
<td>
<p>maximum number of breaks</p>
</td></tr>
<tr><td><code id="interval_+3A_robust">robust</code></td>
<td>
<p>set to <code>1</code> to allow for heterogeneity
and autocorrelation in the residuals, <code>0</code> otherwise.
The method used is Andrews(1991) automatic bandwidth with AR(1) approximation with quadratic
kernel. Note: Do not set to <code>1</code> if lagged dependent variables are
included as regressors.</p>
</td></tr>
<tr><td><code id="interval_+3A_prewhit">prewhit</code></td>
<td>
<p>Option of using prewhitening process. If <code>1</code>, an AR(1)
process will be used to filter. If <code>0</code>, skipped the filtering process</p>
</td></tr>
<tr><td><code id="interval_+3A_hetomega">hetomega</code>, <code id="interval_+3A_hetq">hetq</code></td>
<td>
<p>options for assumptions of error terms
structure. For more details, refers to <code><a href="#topic+mdl">mdl()</a></code></p>
</td></tr>
<tr><td><code id="interval_+3A_x">x</code></td>
<td>
<p>matrix of independent variables with coefficients constant
across regimes</p>
</td></tr>
<tr><td><code id="interval_+3A_p">p</code></td>
<td>
<p>number of <code>x</code> regressors</p>
</td></tr>
</table>


<h3>Value</h3>

<p>bound Confidence intervals of break date in <code>90%</code> and <code>95%</code>
significant level
</p>

<hr>
<h2 id='mdl'>Comprehensive structural change estimation and testing</h2><span id='topic+mdl'></span>

<h3>Description</h3>

<p><code>mdl()</code> calls main functions of the <code>mbreaks</code> package to execute the following
estimation procedures:
</p>

<ul>
<li><p><code>dotest()</code> conducts Sup F tests of <code>0</code> versus <code>m</code> breaks and Double Max tests
</p>
</li>
<li><p><code>doseqtests()</code> conducts the sequential Sup F tests of l versus l+1 breaks
</p>
</li>
<li><p><code>doorder()</code> conducts the number of breaks selection from <code>1</code> to <code>m</code>
breaks using information critera: <code style="white-space: pre;">&#8288;{'KT','BIC','LWZ'}&#8288;</code>
</p>
</li>
<li><p><code>dosequa()</code> conducts the number of breaks selection by sequential tests
from <code>1</code> to <code>m</code> breaks using sequential Sup F tests
</p>
</li>
<li><p><code>dofix()</code> conducts structural break model estimation with <code>fixn</code> breaks
</p>
</li></ul>

<p>All the procedures automatically identify if the <code>model</code> is either i) pure structural
breaks model or ii) partial structural breaks model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdl(
  y_name,
  z_name = NULL,
  x_name = NULL,
  data,
  eps1 = 0.15,
  m = 5,
  prewhit = 1,
  robust = 1,
  hetdat = 1,
  hetvar = 1,
  hetomega = 1,
  hetq = 1,
  maxi = 10,
  eps = 1e-05,
  fixn = -1,
  fixb = 0,
  betaini = 0,
  printd = 0,
  const = 1,
  signif = 2,
  h = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdl_+3A_y_name">y_name</code></td>
<td>
<p>name of dependent variable in the data set</p>
</td></tr>
<tr><td><code id="mdl_+3A_z_name">z_name</code></td>
<td>
<p>name of independent variables in the data set which coefficients are allowed to change
across regimes. <code>default</code> is vector of 1 (Mean-shift model)</p>
</td></tr>
<tr><td><code id="mdl_+3A_x_name">x_name</code></td>
<td>
<p>name of independent variables in the data set which coefficients are constant across
regimes. <code>default</code> is <code>NULL</code></p>
</td></tr>
<tr><td><code id="mdl_+3A_data">data</code></td>
<td>
<p>the data set for estimation</p>
</td></tr>
<tr><td><code id="mdl_+3A_eps1">eps1</code></td>
<td>
<p>value of trimming (in percentage) for the construction
and critical values. Minimal segment length <code>h</code> will be set
at <code>default</code> = int(<code>eps1</code>*T) (T is total sample size).
</p>

<ul>
<li><p><code>eps1=0.05</code> Maximal value of <code>m</code> = 10
</p>
</li>
<li><p><code>eps1=0.10</code> Maximal value of <code>m</code> = 8
</p>
</li>
<li><p><code>eps1=.15</code> Maximal value of <code>m</code> = 5
</p>
</li>
<li><p><code>eps1=.20</code> Maximal value of <code>m</code> = 3
</p>
</li>
<li><p><code>eps1=.25</code> Maximal value of <code>m</code> = 2
</p>
</li>
<li><p><code>eps1=0</code> This option allows users to explicitly specify
minimum segment length <code>h</code> parameters. However, this option will not
be allowed for testing and testing related functions</p>
</li></ul>
<p> The <code>default</code> value is set at 0.15</p>
</td></tr>
<tr><td><code id="mdl_+3A_m">m</code></td>
<td>
<p>Maximum number of structural changes allowed. If not specify,
m will be set to <code>default</code> value matching <code>eps1</code> input</p>
</td></tr>
<tr><td><code id="mdl_+3A_prewhit">prewhit</code></td>
<td>
<p>set to <code>1</code> to apply AR(1) prewhitening prior to estimating
the long run covariance matrix.</p>
</td></tr>
<tr><td><code id="mdl_+3A_robust">robust</code></td>
<td>
<p>set to <code>1</code> to allow for heterogeneity
and autocorrelation in the residuals, <code>0</code> otherwise.
The method used is Andrews(1991) automatic bandwidth with AR(1) approximation with quadratic
kernel. Note: Do not set to <code>1</code> if lagged dependent variables are
included as regressors.</p>
</td></tr>
<tr><td><code id="mdl_+3A_hetdat">hetdat</code></td>
<td>
<p>option for the construction of the F tests. Set to 1 if want to
allow different moment matrices of the regressors across segments.
If <code>hetdat</code> = <code>0</code>, the same moment matrices are assumed for each segment
and estimated from the ful sample. It is recommended to set
<code>hetdat</code>=<code>1</code> if number of regressors <code>x</code> &gt; <code>0</code>.</p>
</td></tr>
<tr><td><code id="mdl_+3A_hetvar">hetvar</code></td>
<td>
<p>option for the construction of the F tests.Set to <code>1</code>
if users want to allow for the variance of the residuals to be different across segments.
If <code>hetvar</code>=<code>0</code>, the variance of the residuals is assumed constant
across segments and constructed from the full sample. <code>hetvar</code>=<code>1</code> when <code>robust</code> =<code>1</code>)</p>
</td></tr>
<tr><td><code id="mdl_+3A_hetomega">hetomega</code></td>
<td>
<p>used in the construction of the confidence intervals for the break
dates. If <code>hetomega</code>=<code>0</code>, the long run covariance matrix of zu is
assumed identical across segments (the variance of the errors u if <code>robust</code>=0)</p>
</td></tr>
<tr><td><code id="mdl_+3A_hetq">hetq</code></td>
<td>
<p>used in the construction of the confidence intervals for the break
dates. If <code>hetq</code>=<code>0</code>, the moment matrix of the data is assumed identical
across segments</p>
</td></tr>
<tr><td><code id="mdl_+3A_maxi">maxi</code></td>
<td>
<p>number of maximum iterations for recursive calculations of finding
global minimizers.<code>default</code> = 10 (For partial change model ONLY)</p>
</td></tr>
<tr><td><code id="mdl_+3A_eps">eps</code></td>
<td>
<p>convergence criterion for recursive calculations (For partial change model ONLY)</p>
</td></tr>
<tr><td><code id="mdl_+3A_fixn">fixn</code></td>
<td>
<p>number of pre-specified breaks. <code>default</code> = -1. It will be replaced
automatically to 2 if no specification is given (For partial change model ONLY)</p>
</td></tr>
<tr><td><code id="mdl_+3A_fixb">fixb</code></td>
<td>
<p>option to use fixed initial input <code class="reqn">\beta</code>. If <code>1</code>,
the model will use values given in <code>betaini</code>. If <code>0</code>, betaini is skipped</p>
</td></tr>
<tr><td><code id="mdl_+3A_betaini">betaini</code></td>
<td>
<p>Initial <code class="reqn">beta_0</code> to use in estimation (Must be a <code style="white-space: pre;">&#8288;p x 1&#8288;</code> matrix, where p is number of x variables)</p>
</td></tr>
<tr><td><code id="mdl_+3A_printd">printd</code></td>
<td>
<p>Print option for model estimation. <code>default</code> = 0, to
suppress intermediate outputs printing to console</p>
</td></tr>
<tr><td><code id="mdl_+3A_const">const</code></td>
<td>
<p>indicates whether the regression model include an
intercept changing across regimes. Default value is 1</p>
</td></tr>
<tr><td><code id="mdl_+3A_signif">signif</code></td>
<td>
<p>significance level used to sequential test to select number of breaks.
</p>

<ul>
<li><p> 4: 1% level
</p>
</li>
<li><p> 3: 2.5% level
</p>
</li>
<li><p> 2: 5% level
</p>
</li>
<li><p> 1: 10% level
</p>
</li></ul>
</td></tr>
<tr><td><code id="mdl_+3A_h">h</code></td>
<td>
<p>Minimum segment length of regime considered in estimation. If users want to specify a particular value, please set <code>eps1=0</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list that contains the following:
</p>

<ul>
<li><p>sbtests: class <code>sbtests</code> of Sup F tests of 0 versus m breaks and Double Max tests
</p>
</li>
<li><p>seqtests: class <code>seqtests</code> of sequential Sup F test of l versus l+1 breaks 
</p>
</li>
<li><p>BIC: class <code>model</code> of structural break model with estimated number of breaks by BIC criterion
</p>
</li>
<li><p>LWZ: class <code>model</code> of structural break model with estimated number of breaks by LWZ criterion
</p>
</li>
<li><p>KT: class <code>model</code> of structural break model with estimated number of breaks by KT criterion
</p>
</li>
<li><p>sequa: class <code>model</code> of structural break model with estimated number of breaks by sequential tests
</p>
</li>
<li><p>fix:  class <code>model</code> of structural break model with pre-specified <code>fixn</code> number of breaks
</p>
</li></ul>

<p>Note: All <code>default</code> values of error assumptions (<code>robust</code>,
<code>hetdat</code>, <code>hetvar</code>, <code>hetq</code>) are set to 1. The implications on
the structure of model's errors related to individual settings are explained within
the arguments section for each option.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dotest">dotest()</a></code>, <code><a href="#topic+doseqtests">doseqtests()</a></code>, <code><a href="#topic+doorder">doorder()</a></code>, <code><a href="#topic+dosequa">dosequa()</a></code>, and <code><a href="#topic+dofix">dofix()</a></code>
which are functions called by <code>mdl()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> US_rate = mdl('rate',data=real)
 nkpc_lbs = mdl('inf',c('inflag','lbs','inffut'),data=nkpc,prewhit = 0)

</code></pre>

<hr>
<h2 id='nkpc'>New Keynesian Phillips curve data</h2><span id='topic+nkpc'></span>

<h3>Description</h3>

<p>Data set from inflation and other macroeconomic variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nkpc
</code></pre>


<h3>Format</h3>



<h4><code>nkpc</code></h4>

<p>A data frame with 151 rows and 12 columns:
</p>

<dl>
<dt>year</dt><dd><p>Current period year</p>
</dd>
<dt>quarter</dt><dd><p>Quarter in current period year</p>
</dd>
<dt>inf</dt><dd><p>Inflation rate</p>
</dd>
<dt>inflag</dt><dd><p>Inflation rate in previous period</p>
</dd>
<dt>inffut</dt><dd><p>Expected inflation rate, taken as value of inflation rate of next period</p>
</dd>
<dt>ygap</dt><dd><p>Productivity output gap</p>
</dd>
<dt>lbs</dt><dd></dd>
<dt>lbslag</dt><dd></dd>
<dt>spreadlag</dt><dd></dd>
<dt>dwlag</dt><dd></dd>
<dt>dcplag</dt><dd></dd>
</dl>




<h3>Source</h3>

<p>Perron, P. and Yamamoto, Y., 2015. &quot;Using ols to estimate and test for structural changes in models with endogenous regressors.&quot; Journal of Applied Econometrics 30, 119–144.
</p>

<hr>
<h2 id='nldat'>Computation of global minimizer for partial structural change model</h2><span id='topic+nldat'></span>

<h3>Description</h3>

<p><code>nldat()</code> computes the break dates of a partial structural change model
for a pre-specified number of breaks <code>m</code>. The procedure iterates between
estimating the invariant and changing coefficients of <code>x</code> and <code>z</code> regressors
until convergence, by noting that the residuals from linear regression model between
<code>y</code> and <code>x</code> regressors is a pure structural change model,
while the residuals from pure structural change model between <code>y</code> and <code>z</code> regressors
is a linear regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nldat(y, z, x, h, m, p, q, bigT, fixb, eps, maxi, betaini, printd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nldat_+3A_y">y</code></td>
<td>
<p>dependent variable in matrix form</p>
</td></tr>
<tr><td><code id="nldat_+3A_z">z</code></td>
<td>
<p>matrix of regressors which coefficients are allowed to change across regimes</p>
</td></tr>
<tr><td><code id="nldat_+3A_x">x</code></td>
<td>
<p>matrix of regressors which coefficients are constant across regime</p>
</td></tr>
<tr><td><code id="nldat_+3A_h">h</code></td>
<td>
<p>minimum segment length</p>
</td></tr>
<tr><td><code id="nldat_+3A_m">m</code></td>
<td>
<p>number of breaks</p>
</td></tr>
<tr><td><code id="nldat_+3A_p">p</code></td>
<td>
<p>number of <code>z</code> regressors</p>
</td></tr>
<tr><td><code id="nldat_+3A_q">q</code></td>
<td>
<p>number of <code>x</code> regressors</p>
</td></tr>
<tr><td><code id="nldat_+3A_bigt">bigT</code></td>
<td>
<p>the sample size T</p>
</td></tr>
<tr><td><code id="nldat_+3A_fixb">fixb</code></td>
<td>
<p>option to use initial <code class="reqn">\beta</code> If <code>1</code>, procedure requires <code>betaini</code>.
If <code>0</code>, procedure will not use initial beta values</p>
</td></tr>
<tr><td><code id="nldat_+3A_eps">eps</code></td>
<td>
<p>Convergence criterion (For partial change model ONLY)</p>
</td></tr>
<tr><td><code id="nldat_+3A_maxi">maxi</code></td>
<td>
<p>Maximum number of iterations (For partial change model ONLY)</p>
</td></tr>
<tr><td><code id="nldat_+3A_betaini">betaini</code></td>
<td>
<p>initial beta values. Required when use with option <code>fixb</code></p>
</td></tr>
<tr><td><code id="nldat_+3A_printd">printd</code></td>
<td>
<p>option to print output from iterated estimations. If <code>1</code>, the results
for each iteration will be printed in console log. If <code>0</code>, no output will be printed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>glb</code></td>
<td>
<p>minimum global SSR</p>
</td></tr>
<tr><td><code>datevec</code></td>
<td>
<p>Vector of dates (optimal minimizers)</p>
</td></tr>
<tr><td><code>bigvec</code></td>
<td>
<p>Associated SSRs</p>
</td></tr>
</table>


<h3>References</h3>

<p>Bai J, Perron P (1998). <em>&quot;Estimating and Testing Linear Models with Multiple Structural
Changes&quot;</em> Econometrica, 66, 47-78.
Bai J, Perron P (2003). <em>&quot;Computation and Analysis of Multiple Structural Change Models&quot;</em>
Journal of Applied Econometrics 18, 1-22
</p>

<hr>
<h2 id='pftest'>SupF test for 0 vs i breaks</h2><span id='topic+pftest'></span>

<h3>Description</h3>

<p>Function compute the supF test statistics of testing procedure with
null hypothesis: no break versus alternative hypothesis: <code>i</code> breaks.
</p>
<p>Function compute the supF test statistics of testing procedure with
null hypothesis: no break versus alternative hypothesis: <code>i</code> breaks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pftest(y, z, i, q, bigT, datevec, prewhit, robust, x, p, hetdat, hetvar)

pftest(y, z, i, q, bigT, datevec, prewhit, robust, x, p, hetdat, hetvar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pftest_+3A_y">y</code></td>
<td>
<p>dependent variables</p>
</td></tr>
<tr><td><code id="pftest_+3A_z">z</code></td>
<td>
<p>independent variables with coefficients are allowed to change across
regimes</p>
</td></tr>
<tr><td><code id="pftest_+3A_i">i</code></td>
<td>
<p>number of breaks in the model</p>
</td></tr>
<tr><td><code id="pftest_+3A_q">q</code></td>
<td>
<p>number of <code>z</code> regressors</p>
</td></tr>
<tr><td><code id="pftest_+3A_bigt">bigT</code></td>
<td>
<p>sample period T</p>
</td></tr>
<tr><td><code id="pftest_+3A_datevec">datevec</code></td>
<td>
<p><code>i</code> estimated dates from the model</p>
</td></tr>
<tr><td><code id="pftest_+3A_prewhit">prewhit</code></td>
<td>
<p>Options for prewhitening process</p>
</td></tr>
<tr><td><code id="pftest_+3A_robust">robust</code>, <code id="pftest_+3A_hetdat">hetdat</code>, <code id="pftest_+3A_hetvar">hetvar</code></td>
<td>
<p>options for assumptions on error terms</p>
</td></tr>
<tr><td><code id="pftest_+3A_x">x</code></td>
<td>
<p>independent variables with constant coefficients across regimes</p>
</td></tr>
<tr><td><code id="pftest_+3A_p">p</code></td>
<td>
<p>number of <code>x</code> regressors</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ftest SupF test results
</p>
<p>ftest SupF test results
</p>

<hr>
<h2 id='plambda'>Construct diagonal matrix according to break date</h2><span id='topic+plambda'></span>

<h3>Description</h3>

<p>Function constructs a diagonal matrix of dimension (m+1) by (m+1) matrix
with i-th entry <code class="reqn">\frac{T_{i} - T_{i-1}}{ T}</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plambda(b, m, bigT)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plambda_+3A_b">b</code></td>
<td>
<p>Estimated date of changes</p>
</td></tr>
<tr><td><code id="plambda_+3A_m">m</code></td>
<td>
<p>Number of breaks</p>
</td></tr>
<tr><td><code id="plambda_+3A_bigt">bigT</code></td>
<td>
<p>The sample size T</p>
</td></tr>
</table>


<h3>Value</h3>

<p>lambda (m+1) by (m+1) diagonal matrix
with i-th entry <code class="reqn">\frac{T_{i} - T_{i-1}}{ T}</code>
</p>

<hr>
<h2 id='plot_model'>Plot structural change model</h2><span id='topic+plot_model'></span>

<h3>Description</h3>

<p><code>plot_model()</code> visualizes any object of class <code>model</code> with comparison between real,
fitted values between  model of <code>m</code> breaks and null model of <code>0</code> breaks with options
for confidence interval of break date.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_model(model, CI = 0.95, title = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_model_+3A_model">model</code></td>
<td>
<p>object of class <code>model</code> in <code>mbreaks</code> package</p>
</td></tr>
<tr><td><code id="plot_model_+3A_ci">CI</code></td>
<td>
<p>confidence intervals for break date and coefficient estimates visualize in terms of
fitted values</p>
</td></tr>
<tr><td><code id="plot_model_+3A_title">title</code></td>
<td>
<p>title of the graph</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for plotting class <code>model</code> object. For more details
on <code>model</code> class, see <a href="#topic+compile_model">compile_model</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rate = dofix('rate',data=real,fixn=2)
plot_model(rate,title='Ex-post US exchange rate')

</code></pre>

<hr>
<h2 id='print.mdl'>Print information of <code>mbreaks</code> comprehensive procedure</h2><span id='topic+print.mdl'></span>

<h3>Description</h3>

<p><code>print</code> prints the class <code>mdl</code> object with default showing only
certain procedures called
by <code>mdl()</code> function including: <code>seqtests</code> class object, <code>sbtests</code> class
object, and <code>model</code> class object using KT information criterion
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mdl'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mdl_+3A_x">x</code></td>
<td>
<p>class <code>mdl</code> object</p>
</td></tr>
<tr><td><code id="print.mdl_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, only for printing <code>model</code>, <code>sbtests</code> and <code>seqtests</code> class objects
invoked during <code>mdl()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rate = mdl('rate',data=real)
print(rate)
</code></pre>

<hr>
<h2 id='print.model'>Summary output of a structural breaks <code>model</code></h2><span id='topic+print.model'></span>

<h3>Description</h3>

<p><code>print</code> the output of the S3 class <code>model</code> with all relevant information:
</p>

<ul>
<li><p> name of procedure used to obtain number of breaks in the model
</p>
</li>
<li><p> print a table summarizing the break date estimation
(including confidence interval for the estimated date)
</p>
</li>
<li><p> print a table summarizing the estimated coefficients for <code>z</code> regressors
</p>
</li>
<li><p> print a table summarizing the estimated coefficients for <code>x</code> regressors (if any)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'model'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.model_+3A_x">x</code></td>
<td>
<p>object of S3 class <code>model</code></p>
</td></tr>
<tr><td><code id="print.model_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for printing to console the following information in <code>x</code>:
</p>

<ul>
<li><p>Basic details of the model: name of prodecures invoked,
number of estimated breaks, pure/partial structural change model,global min SSR
</p>
</li>
<li><p><code>date_tab</code> summarizes estimated break dates, see <code><a href="#topic+compile_model">compile_model</a></code>
</p>
</li>
<li><p><code>RS_tab</code> summarizes estimated coefficients allowed to change
across regimes, see <code><a href="#topic+compile_model">compile_model</a></code>
</p>
</li>
<li><p><code>FS_tab</code> summarizes estimated coefficients constant across regimes,
see <code><a href="#topic+compile_model">compile_model</a></code>
</p>
</li></ul>


<hr>
<h2 id='print.sbtests'>Print Sup F and UDMax tests</h2><span id='topic+print.sbtests'></span>

<h3>Description</h3>

<p><code>print</code> prints the following information from a <code>sbtests</code> class object:
</p>

<ul>
<li><p> table <code>supF1</code> reporting sup F tests of 0 versus <code>1</code> upto <code>m</code> breaks with critical values for
<code style="white-space: pre;">&#8288;{1%, 2.5%, 5%, 10%}&#8288;</code> significance levels
</p>
</li>
<li><p> table <code>UDmax</code> reporting Double Max tests with critical values for
<code style="white-space: pre;">&#8288;{1%, 2.5%, 5%, 10%}&#8288;</code> significance levels.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sbtests'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.sbtests_+3A_x">x</code></td>
<td>
<p>class <code>sbtests</code> object</p>
</td></tr>
<tr><td><code id="print.sbtests_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, only for printing formatted <code>sbtests</code> class object to console
</p>


<h3>Examples</h3>

<pre><code class='language-R'>supF = dotest('inf','inflag',data=nkpc)
print(supF)

</code></pre>

<hr>
<h2 id='print.seqtests'>Print sequential SupF tests</h2><span id='topic+print.seqtests'></span>

<h3>Description</h3>

<p><code>print</code> prints the object of class <code>seqtests</code> with the following information
</p>

<ul>
<li><p> Maximum number of breaks <code>m</code> in the tests
</p>
</li>
<li> <p><code>sfl</code> table with sequential sup F tests statistics of l versus
l+1 breaks up to <code>m</code> breaks</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'seqtests'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.seqtests_+3A_x">x</code></td>
<td>
<p><code>seqtests</code> class object.</p>
</td></tr>
<tr><td><code id="print.seqtests_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, only for printing formatted <code>seqtests</code> class object to console
</p>


<h3>Examples</h3>

<pre><code class='language-R'>seq_supF = doseqtests('inf','inflag',data=nkpc)
print(seq_supF)
</code></pre>

<hr>
<h2 id='psigmq'>Construct diagonal matrix of estimated variance</h2><span id='topic+psigmq'></span>

<h3>Description</h3>

<p>Function computes a diagonal matrix of dimension m+1 by m+1
with i-th entry is the estimated variance of residuals of segment i
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psigmq(res, b, q, m, nt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psigmq_+3A_res">res</code></td>
<td>
<p>big residual vector of the model</p>
</td></tr>
<tr><td><code id="psigmq_+3A_b">b</code></td>
<td>
<p>Estimated date of changes</p>
</td></tr>
<tr><td><code id="psigmq_+3A_q">q</code></td>
<td>
<p>Number of <code>z</code> regressors</p>
</td></tr>
<tr><td><code id="psigmq_+3A_m">m</code></td>
<td>
<p>Number of breaks</p>
</td></tr>
<tr><td><code id="psigmq_+3A_nt">nt</code></td>
<td>
<p>The size of <code>z</code> regressors</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sigmat (<code>m</code>+1)x(<code>m</code>+1) diagonal matrix with i-th entry
equal to estimated variance of regime i
</p>

<hr>
<h2 id='real'>World Health Organization TB data</h2><span id='topic+real'></span>

<h3>Description</h3>

<p>Data set from the Garcia and Perron study's of ex-post exchange rate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>real
</code></pre>


<h3>Format</h3>



<h4><code>real</code></h4>

<p>A data frame with 103 rows and 1 column:
</p>

<dl>
<dt>rate</dt><dd><p>Real exchange rate</p>
</dd>
</dl>




<h3>Source</h3>

<p>Garcia, R. and Perron, P., 1996. &quot;An analysis of the real interest rate under regime shifts.&quot; Review of Economics and Statistics 111–125.
</p>

<hr>
<h2 id='spflp1'>SupF(l+1|l) test</h2><span id='topic+spflp1'></span>

<h3>Description</h3>

<p>Function computes the test statistics of supF(l+1|l) test with null hypothesis
is l=<code>nseg</code>-1 and alternative hypothesis is l+1.
The l breaks under the null hypothesis are taken from the global minimization.
</p>
<p><code>spflp1</code> computes the test statistics of supF(l+1|l) test with null hypothesis
is l=<code>nseg-1</code> and alternative hypothesis is l+1.
The l breaks under the null hypothesis are taken from the global minimization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spflp1(bigvec, dt, nseg, y, z, h, q, prewhit, robust, x, p, hetdat, hetvar)

spflp1(bigvec, dt, nseg, y, z, h, q, prewhit, robust, x, p, hetdat, hetvar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spflp1_+3A_bigvec">bigvec</code></td>
<td>
<p>associated SSR of estimated break date under H0</p>
</td></tr>
<tr><td><code id="spflp1_+3A_dt">dt</code></td>
<td>
<p>vector of estimated date under H0</p>
</td></tr>
<tr><td><code id="spflp1_+3A_nseg">nseg</code></td>
<td>
<p>number of segment under H1</p>
</td></tr>
<tr><td><code id="spflp1_+3A_y">y</code></td>
<td>
<p>matrix of dependent variable</p>
</td></tr>
<tr><td><code id="spflp1_+3A_z">z</code></td>
<td>
<p>matrix of variables with coefficients are allowed to change across
regimes</p>
</td></tr>
<tr><td><code id="spflp1_+3A_h">h</code></td>
<td>
<p>minimum segment length</p>
</td></tr>
<tr><td><code id="spflp1_+3A_q">q</code></td>
<td>
<p>number of <code>z</code> regressors</p>
</td></tr>
<tr><td><code id="spflp1_+3A_prewhit">prewhit</code>, <code id="spflp1_+3A_robust">robust</code>, <code id="spflp1_+3A_hetdat">hetdat</code>, <code id="spflp1_+3A_hetvar">hetvar</code></td>
<td>
<p>options on residuals/errors. For more details,
please refer to <code><a href="#topic+mdl">mdl()</a></code></p>
</td></tr>
<tr><td><code id="spflp1_+3A_x">x</code></td>
<td>
<p>matrix of variables with constant coefficients across regimes</p>
</td></tr>
<tr><td><code id="spflp1_+3A_p">p</code></td>
<td>
<p>number of <code>x</code> regressors</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list that contains the following:
</p>

<ul>
<li> <p>maxfMaximum value of test
</p>
</li>
<li><p>newdAdditional date in alternative hypothesis 
</p>
</li></ul>

<p>A list that contains the following:
</p>

<ul>
<li> <p>maxfMaximum value of test
</p>
</li>
<li><p>newdAdditional date in alternative hypothesis 
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
