<!DOCTYPE html><html lang="en"><head><title>Help for package proteus</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {proteus}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#amzn_aapl_fb'><p>amzn_aapl_fb data set</p></a></li>
<li><a href='#proteus'><p>proteus</p></a></li>
<li><a href='#proteus_random_search'><p>proteus_random_search</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multiform Seq2Seq Model for Time-Feature Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.4</td>
</tr>
<tr>
<td>Author:</td>
<td>Giancarlo Vercellino</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Giancarlo Vercellino &lt;giancarlo.vercellino@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Seq2seq time-feature analysis based on variational model, with a wide range of distributions available for the latent variable.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>Imports:</td>
<td>purrr (&ge; 0.3.4), abind (&ge; 1.4-5), ggplot2 (&ge; 3.3.3),
ggthemes (&ge; 4.2.4), readr (&ge; 1.4.0), stringr (&ge; 1.4.0),
lubridate (&ge; 1.7.9.2), narray (&ge; 0.4.1), fANCOVA (&ge; 0.6-1),
imputeTS (&ge; 3.1), modeest (&ge; 2.4.0), scales (&ge; 1.1.1),
tictoc (&ge; 1.0.1), torch (&ge; 0.3.0), actuar (&ge; 3.1-1), VGAM
(&ge; 1.1-5), moments (&ge; 0.14), dplyr (&ge; 1.0.2), greybox (&ge;
1.0.7), furrr (&ge; 0.3.1), future (&ge; 1.33.0), sn (&ge; 2.1.1)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://rpubs.com/giancarlo_vercellino/proteus">https://rpubs.com/giancarlo_vercellino/proteus</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-21 17:22:57 UTC; gianc</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-21 17:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='amzn_aapl_fb'>amzn_aapl_fb data set</h2><span id='topic+amzn_aapl_fb'></span>

<h3>Description</h3>

<p>A data frame with the close prices for Amazon, Google and Facebook.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>amzn_aapl_fb
</code></pre>


<h3>Format</h3>

<p>A data frame with 4 columns and 1798 rows.
</p>


<h3>Source</h3>

<p>Yahoo Finance
</p>

<hr>
<h2 id='proteus'>proteus</h2><span id='topic+proteus'></span>

<h3>Description</h3>

<p>Proteus is a Sequence-to-Sequence Variational Model designed for time-feature analysis, leveraging a wide range of distributions for improved accuracy. Unlike traditional methods that rely solely on the normal distribution, Proteus uses various latent models to better capture and predict complex processes. To achieve this, Proteus employs a neural network architecture that estimates the shape, location, and scale parameters of the chosen distribution. This approach transforms past sequence data into future sequence parameters, improving the model's prediction capabilities. Proteus also assesses the accuracy of its predictions by estimating the error of measurement and calculating the confidence interval. By utilizing a range of distributions and advanced modeling techniques, Proteus provides a more accurate and comprehensive approach to time-feature analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>proteus(
  data,
  target,
  future,
  past,
  ci = 0.8,
  smoother = FALSE,
  t_embed = 30,
  activ = "linear",
  nodes = 32,
  distr = "normal",
  optim = "adam",
  loss_metric = "crps",
  epochs = 30,
  lr = 0.01,
  patience = 10,
  latent_sample = 100,
  verbose = TRUE,
  stride = 1,
  dates = NULL,
  rolling_blocks = FALSE,
  n_blocks = 4,
  block_minset = 30,
  error_scale = "naive",
  error_benchmark = "naive",
  batch_size = 30,
  omit = FALSE,
  min_default = 1,
  future_plan = "future::multisession",
  seed = 42
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="proteus_+3A_data">data</code></td>
<td>
<p>A data frame with time features on columns and possibly a date column (not mandatory)</p>
</td></tr>
<tr><td><code id="proteus_+3A_target">target</code></td>
<td>
<p>Vector of strings. Names of the time features to be jointly analyzed</p>
</td></tr>
<tr><td><code id="proteus_+3A_future">future</code></td>
<td>
<p>Positive integer. The future dimension with number of time-steps to be predicted</p>
</td></tr>
<tr><td><code id="proteus_+3A_past">past</code></td>
<td>
<p>Positive integer. Length of past sequences</p>
</td></tr>
<tr><td><code id="proteus_+3A_ci">ci</code></td>
<td>
<p>Positive numeric. Confidence interval. Default: 0.8</p>
</td></tr>
<tr><td><code id="proteus_+3A_smoother">smoother</code></td>
<td>
<p>Logical. Perform optimal smoothing using standard loess for each time feature. Default: FALSE</p>
</td></tr>
<tr><td><code id="proteus_+3A_t_embed">t_embed</code></td>
<td>
<p>Positive integer. Number of embedding for the temporal dimension. Minimum value is equal to 2. Default: 30.</p>
</td></tr>
<tr><td><code id="proteus_+3A_activ">activ</code></td>
<td>
<p>String. Activation function to be used by the forward network. Implemented functions are: &quot;linear&quot;, &quot;mish&quot;, &quot;swish&quot;, &quot;leaky_relu&quot;, &quot;celu&quot;, &quot;elu&quot;, &quot;gelu&quot;, &quot;selu&quot;, &quot;bent&quot;, &quot;softmax&quot;, &quot;softmin&quot;, &quot;softsign&quot;, &quot;softplus&quot;, &quot;sigmoid&quot;, &quot;tanh&quot;. Default: &quot;linear&quot;.</p>
</td></tr>
<tr><td><code id="proteus_+3A_nodes">nodes</code></td>
<td>
<p>Positive integer. Nodes for the forward neural net. Default: 32.</p>
</td></tr>
<tr><td><code id="proteus_+3A_distr">distr</code></td>
<td>
<p>String. Distribution to be used by variational model. Implemented distributions are: &quot;normal&quot;, &quot;genbeta&quot;, &quot;gev&quot;, &quot;gpd&quot;, &quot;genray&quot;, &quot;cauchy&quot;, &quot;exp&quot;, &quot;logis&quot;, &quot;chisq&quot;, &quot;gumbel&quot;, &quot;laplace&quot;, &quot;lognorm&quot;, &quot;skewed&quot;. Default: &quot;normal&quot;.</p>
</td></tr>
<tr><td><code id="proteus_+3A_optim">optim</code></td>
<td>
<p>String. Optimization method. Implemented methods are: &quot;adadelta&quot;, &quot;adagrad&quot;, &quot;rmsprop&quot;, &quot;rprop&quot;, &quot;sgd&quot;, &quot;asgd&quot;, &quot;adam&quot;.</p>
</td></tr>
<tr><td><code id="proteus_+3A_loss_metric">loss_metric</code></td>
<td>
<p>String. Loss function for the variational model. Three options: &quot;elbo&quot;, &quot;crps&quot;, &quot;score&quot;. Default: &quot;crps&quot;.</p>
</td></tr>
<tr><td><code id="proteus_+3A_epochs">epochs</code></td>
<td>
<p>Positive integer. Default: 30.</p>
</td></tr>
<tr><td><code id="proteus_+3A_lr">lr</code></td>
<td>
<p>Positive numeric. Learning rate. Default: 0.01.</p>
</td></tr>
<tr><td><code id="proteus_+3A_patience">patience</code></td>
<td>
<p>Positive integer. Waiting time (in epochs) before evaluating the overfit performance. Default: epochs.</p>
</td></tr>
<tr><td><code id="proteus_+3A_latent_sample">latent_sample</code></td>
<td>
<p>Positive integer. Number of samples to draw from the latent variables. Default: 100.</p>
</td></tr>
<tr><td><code id="proteus_+3A_verbose">verbose</code></td>
<td>
<p>Logical. Default: TRUE</p>
</td></tr>
<tr><td><code id="proteus_+3A_stride">stride</code></td>
<td>
<p>Positive integer. Number of shifting positions for sequence generation. Default: 1.</p>
</td></tr>
<tr><td><code id="proteus_+3A_dates">dates</code></td>
<td>
<p>String. Label of feature where dates are located. Default: NULL (progressive numbering).</p>
</td></tr>
<tr><td><code id="proteus_+3A_rolling_blocks">rolling_blocks</code></td>
<td>
<p>Logical. Option for incremental or rolling window. Default: FALSE.</p>
</td></tr>
<tr><td><code id="proteus_+3A_n_blocks">n_blocks</code></td>
<td>
<p>Positive integer. Number of distinct blocks for back-testing. Default: 4.</p>
</td></tr>
<tr><td><code id="proteus_+3A_block_minset">block_minset</code></td>
<td>
<p>Positive integer. Minimum number of sequence to create a block. Default: 3.</p>
</td></tr>
<tr><td><code id="proteus_+3A_error_scale">error_scale</code></td>
<td>
<p>String. Scale for the scaled error metrics. Two options: &quot;naive&quot; (average of naive one-step absolute error for the historical series) or &quot;deviation&quot; (standard error of the historical series). Default: &quot;naive&quot;.</p>
</td></tr>
<tr><td><code id="proteus_+3A_error_benchmark">error_benchmark</code></td>
<td>
<p>String. Benchmark for the relative error metrics. Two options: &quot;naive&quot; (sequential extension of last value) or &quot;average&quot; (mean value of true sequence). Default: &quot;naive&quot;.</p>
</td></tr>
<tr><td><code id="proteus_+3A_batch_size">batch_size</code></td>
<td>
<p>Positive integer. Default: 30.</p>
</td></tr>
<tr><td><code id="proteus_+3A_omit">omit</code></td>
<td>
<p>Logical. Flag to TRUE to remove missing values, otherwise all gaps, both in dates and values, will be filled with kalman filter. Default: FALSE.</p>
</td></tr>
<tr><td><code id="proteus_+3A_min_default">min_default</code></td>
<td>
<p>Positive numeric. Minimum differentiation iteration. Default: 1.</p>
</td></tr>
<tr><td><code id="proteus_+3A_future_plan">future_plan</code></td>
<td>
<p>how to resolve the future parallelization. Options are: &quot;future::sequential&quot;, &quot;future::multisession&quot;, &quot;future::multicore&quot;. For more information, take a look at future specific documentation. Default: &quot;future::multisession&quot;.</p>
</td></tr>
<tr><td><code id="proteus_+3A_seed">seed</code></td>
<td>
<p>Random seed. Default: 42.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a list including:
</p>

<ul>
<li><p> model_descr: brief model description (number of tensors and parameters)
</p>
</li>
<li><p> prediction: a table with quantile predictions, mean, std, mode, skewness and kurtosis for each time feature (and other metrics, such as iqr_to_range, above_to_below_range, upside_prob, divergence).
</p>
</li>
<li><p> pred_sampler: empirical function for sampling each prediction point for each time feature
</p>
</li>
<li><p> plot: graph with history and prediction for each time feature
</p>
</li>
<li><p> feature_errors: train and test error for each time feature (me, mae, mse, rmsse, mpe, mape, rmae, rrmse, rame, mase, smse, sce)
</p>
</li>
<li><p> history: average cross-validation loss across blocks
</p>
</li>
<li><p> time_log: computation time.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Giancarlo Vercellino <a href="mailto:giancarlo.vercellino@gmail.com">giancarlo.vercellino@gmail.com</a>
</p>


<h3>References</h3>

<p>https://rpubs.com/giancarlo_vercellino/proteus
</p>

<hr>
<h2 id='proteus_random_search'>proteus_random_search</h2><span id='topic+proteus_random_search'></span>

<h3>Description</h3>

<p>proteus_random_search is a function for fine-tuning using random search on the hyper-parameter space of proteus (predefined or custom).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>proteus_random_search(
  n_samp,
  data,
  target,
  future,
  past = NULL,
  ci = 0.8,
  smoother = FALSE,
  t_embed = NULL,
  activ = NULL,
  nodes = NULL,
  distr = NULL,
  optim = NULL,
  loss_metric = "crps",
  epochs = 30,
  lr = NULL,
  patience = 10,
  latent_sample = 100,
  verbose = TRUE,
  stride = NULL,
  dates = NULL,
  rolling_blocks = FALSE,
  n_blocks = 4,
  block_minset = 10,
  error_scale = "naive",
  error_benchmark = "naive",
  batch_size = 30,
  min_default = 1,
  seed = 42,
  future_plan = "future::multisession",
  omit = FALSE,
  keep = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="proteus_random_search_+3A_n_samp">n_samp</code></td>
<td>
<p>Positive integer. Number of models to be randomly generated sampling the hyper-parameter space.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_data">data</code></td>
<td>
<p>A data frame with time features on columns and possibly a date column (not mandatory).</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_target">target</code></td>
<td>
<p>Vector of strings. Names of the time features to be jointly analyzed.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_future">future</code></td>
<td>
<p>Positive integer. The future dimension with number of time-steps to be predicted.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_past">past</code></td>
<td>
<p>Positive integer. Length of past sequences. Default: NULL (search range future:2*future).</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_ci">ci</code></td>
<td>
<p>Positive numeric. Confidence interval. Default: 0.8.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_smoother">smoother</code></td>
<td>
<p>Logical. Perform optimal smoothing using standard loess for each time feature. Default: FALSE.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_t_embed">t_embed</code></td>
<td>
<p>Positive integer. Number of embedding for the temporal dimension. Minimum value is equal to 2. Default: NULL (search range 2:30).</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_activ">activ</code></td>
<td>
<p>String. Activation function to be used by the forward network. Implemented functions are: &quot;linear&quot;, &quot;mish&quot;, &quot;swish&quot;, &quot;leaky_relu&quot;, &quot;celu&quot;, &quot;elu&quot;, &quot;gelu&quot;, &quot;selu&quot;, &quot;bent&quot;, &quot;softmax&quot;, &quot;softmin&quot;, &quot;softsign&quot;, &quot;softplus&quot;, &quot;sigmoid&quot;, &quot;tanh&quot;. Default: NULL (full-option search).</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_nodes">nodes</code></td>
<td>
<p>Positive integer. Nodes for the forward neural net. Default: NULL (search range 2:1024).</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_distr">distr</code></td>
<td>
<p>String. Distribution to be used by variational model. Implemented distributions are: &quot;normal&quot;, &quot;genbeta&quot;, &quot;gev&quot;, &quot;gpd&quot;, &quot;genray&quot;, &quot;cauchy&quot;, &quot;exp&quot;, &quot;logis&quot;, &quot;chisq&quot;, &quot;gumbel&quot;, &quot;laplace&quot;, &quot;lognorm&quot;, &quot;skewed&quot;. Default: NULL (full-option search).</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_optim">optim</code></td>
<td>
<p>String. Optimization method. Implemented methods are: &quot;adadelta&quot;, &quot;adagrad&quot;, &quot;rmsprop&quot;, &quot;rprop&quot;, &quot;sgd&quot;, &quot;asgd&quot;, &quot;adam&quot;. Default: NULL (full-option search).</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_loss_metric">loss_metric</code></td>
<td>
<p>String. Loss function for the variational model. Three options: &quot;elbo&quot;, &quot;crps&quot;, &quot;score&quot;. Default: &quot;crps&quot;.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_epochs">epochs</code></td>
<td>
<p>Positive integer. Default: 30.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_lr">lr</code></td>
<td>
<p>Positive numeric. Learning rate. Default: NULL (search range 0.001:0.1).</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_patience">patience</code></td>
<td>
<p>Positive integer. Waiting time (in epochs) before evaluating the overfit performance. Default: epochs.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_latent_sample">latent_sample</code></td>
<td>
<p>Positive integer. Number of samples to draw from the latent variables. Default: 100.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_verbose">verbose</code></td>
<td>
<p>Logical. Default: TRUE</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_stride">stride</code></td>
<td>
<p>Positive integer. Number of shifting positions for sequence generation. Default: NULL (search range 1:3).</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_dates">dates</code></td>
<td>
<p>String. Label of feature where dates are located. Default: NULL (progressive numbering).</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_rolling_blocks">rolling_blocks</code></td>
<td>
<p>Logical. Option for incremental or rolling window. Default: FALSE.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_n_blocks">n_blocks</code></td>
<td>
<p>Positive integer. Number of distinct blocks for back-testing. Default: 4.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_block_minset">block_minset</code></td>
<td>
<p>Positive integer. Minimum number of sequence to create a block. Default: 3.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_error_scale">error_scale</code></td>
<td>
<p>String. Scale for the scaled error metrics (for continuous variables). Two options: &quot;naive&quot; (average of naive one-step absolute error for the historical series) or &quot;deviation&quot; (standard error of the historical series). Default: &quot;naive&quot;.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_error_benchmark">error_benchmark</code></td>
<td>
<p>String. Benchmark for the relative error metrics (for continuous variables). Two options: &quot;naive&quot; (sequential extension of last value) or &quot;average&quot; (mean value of true sequence). Default: &quot;naive&quot;.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_batch_size">batch_size</code></td>
<td>
<p>Positive integer. Default: 30.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_min_default">min_default</code></td>
<td>
<p>Positive numeric. Minimum differentiation iteration. Default: 1.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_seed">seed</code></td>
<td>
<p>Random seed. Default: 42.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_future_plan">future_plan</code></td>
<td>
<p>how to resolve the future parallelization. Options are: &quot;future::sequential&quot;, &quot;future::multisession&quot;, &quot;future::multicore&quot;. For more information, take a look at future specific documentation. Default: &quot;future::multisession&quot;.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_omit">omit</code></td>
<td>
<p>Logical. Flag to TRUE to remove missing values, otherwise all gaps, both in dates and values, will be filled with kalman filter. Default: FALSE.</p>
</td></tr>
<tr><td><code id="proteus_random_search_+3A_keep">keep</code></td>
<td>
<p>Logical. Flag to TRUE to keep all the explored models. Default: FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a list including:
</p>

<ul>
<li><p> random_search: summary of the sampled hyper-parameters and average error metrics.
</p>
</li>
<li><p> best: best model according to overall ranking on all average error metrics (for negative metrics, absolute value is considered).
</p>
</li>
<li><p> all_models: list with all generated models (if keep flagged to TRUE).
</p>
</li>
<li><p> time_log: computation time.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Giancarlo Vercellino <a href="mailto:giancarlo.vercellino@gmail.com">giancarlo.vercellino@gmail.com</a>
</p>


<h3>References</h3>

<p>https://rpubs.com/giancarlo_vercellino/proteus
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
