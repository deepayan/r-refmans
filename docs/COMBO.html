<!DOCTYPE html><html><head><title>Help for package COMBO</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {COMBO}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#check_and_fix_chains'><p>Check Assumption and Fix Label Switching if Assumption is Broken for a List of MCMC Samples</p></a></li>
<li><a href='#check_and_fix_chains_2stage'><p>Check Assumption and Fix Label Switching if Assumption is Broken for a List of MCMC Samples</p></a></li>
<li><a href='#COMBO_data'><p>Generate Data to use in COMBO Functions</p></a></li>
<li><a href='#COMBO_data_2stage'><p>Generate data to use in two-stage COMBO Functions</p></a></li>
<li><a href='#COMBO_EM'><p>EM-Algorithm Estimation of the Binary Outcome Misclassification Model</p></a></li>
<li><a href='#COMBO_EM_2stage'><p>EM-Algorithm Estimation of the Two-Stage Binary Outcome Misclassification Model</p></a></li>
<li><a href='#COMBO_EM_data'><p>Test data for the COMBO_EM function</p></a></li>
<li><a href='#COMBO_MCMC'><p>MCMC Estimation of the Binary Outcome Misclassification Model</p></a></li>
<li><a href='#COMBO_MCMC_2stage'><p>MCMC Estimation of the Two-Stage Binary Outcome Misclassification Model</p></a></li>
<li><a href='#em_function'><p>EM-Algorithm Function for Estimation of the Misclassification Model</p></a></li>
<li><a href='#em_function_2stage'><p>EM-Algorithm Function for Estimation of the Two-Stage Misclassification Model</p></a></li>
<li><a href='#expit'><p>Expit function</p></a></li>
<li><a href='#jags_picker'><p>Set up a Binary Outcome Misclassification <code>jags.model</code> Object for a Given Prior</p></a></li>
<li><a href='#jags_picker_2stage'><p>Set up a Two-Stage Binary Outcome Misclassification <code>jags.model</code> Object for a Given Prior</p></a></li>
<li><a href='#label_switch'><p>Fix Label Switching in MCMC Results from a Binary Outcome Misclassification Model</p></a></li>
<li><a href='#label_switch_2stage'><p>Fix Label Switching in MCMC Results from a Binary Outcome Misclassification Model</p></a></li>
<li><a href='#loglik'><p>Expected Complete Data Log-Likelihood Function for Estimation of the Misclassification Model</p></a></li>
<li><a href='#loglik_2stage'><p>Expected Complete Data Log-Likelihood Function for Estimation of the Two-Stage Misclassification Model</p></a></li>
<li><a href='#LSAC_data'><p>Example data from The Law School Admissions Council's (LSAC) National Bar Passage Study (Linda Wightman, 1998)</p></a></li>
<li><a href='#mean_pistarjj_compute'><p>Compute the Mean Conditional Probability of Correct Classification, by True Outcome Across all Subjects</p></a></li>
<li><a href='#misclassification_prob'><p>Compute Conditional Probability of Each Observed Outcome Given Each True Outcome, for Every Subject</p></a></li>
<li><a href='#misclassification_prob2'><p>Compute Conditional Probability of Each Second-Stage Observed Outcome Given Each True Outcome and First-Stage Observed Outcome, for Every Subject</p></a></li>
<li><a href='#model_picker'><p>Select a Binary Outcome Misclassification Model for a Given Prior</p></a></li>
<li><a href='#model_picker_2stage'><p>Select a Two-Stage Binary Outcome Misclassification Model for a Given Prior</p></a></li>
<li><a href='#naive_jags_picker'><p>Set up a Naive Logistic Regression <code>jags.model</code> Object for a Given Prior</p></a></li>
<li><a href='#naive_jags_picker_2stage'><p>Set up a Naive Two-Stage Regression <code>jags.model</code> Object for a Given Prior</p></a></li>
<li><a href='#naive_loglik_2stage'><p>Observed Data Log-Likelihood Function for Estimation of the Naive Two-Stage Misclassification Model</p></a></li>
<li><a href='#naive_model_picker'><p>Select a Logisitic Regression Model for a Given Prior</p></a></li>
<li><a href='#naive_model_picker_2stage'><p>Select a Naive Two-Stage Regression Model for a Given Prior</p></a></li>
<li><a href='#perfect_sensitivity_EM'><p>EM-Algorithm Estimation of the Binary Outcome Misclassification Model while Assuming Perfect Sensitivity</p></a></li>
<li><a href='#pi_compute'><p>Compute Probability of Each True Outcome, for Every Subject</p></a></li>
<li><a href='#pistar_by_chain'><p>Compute the Mean Conditional Probability of Correct Classification, by True Outcome Across all Subjects for each MCMC Chain</p></a></li>
<li><a href='#pistar_by_chain_2stage'><p>Compute the Mean Conditional Probability of Correct Classification, by True Outcome Across all Subjects for each MCMC Chain for a 2-stage model</p></a></li>
<li><a href='#pistar_compute'><p>Compute Conditional Probability of Each Observed Outcome Given Each True Outcome, for Every Subject</p></a></li>
<li><a href='#pistar_compute_for_chains'><p>Compute Conditional Probability of Each Observed Outcome Given Each True Outcome for a given MCMC Chain, for Every Subject</p></a></li>
<li><a href='#pistar_compute_for_chains_2stage'><p>Compute Conditional Probability of Each Observed Outcome Given Each True Outcome for a given MCMC Chain, for Every Subject for 2-stage models</p></a></li>
<li><a href='#pitilde_by_chain'><p>Compute the Mean Conditional Probability of Second-Stage Correct Classification, by First-Stage and True Outcome Across all Subjects for each MCMC Chain</p></a></li>
<li><a href='#pitilde_compute'><p>Compute Conditional Probability of Each Second-Stage Observed Outcome Given Each True Outcome and First-Stage Observed Outcome, for Every Subject</p></a></li>
<li><a href='#pitilde_compute_for_chains'><p>Compute Conditional Probability of Each Observed Outcome Given Each True Outcome for a given MCMC Chain, for Every Subject</p></a></li>
<li><a href='#q_beta_f'><p>M-Step Expected Log-Likelihood with respect to Beta</p></a></li>
<li><a href='#q_delta_f'><p>M-Step Expected Log-Likelihood with respect to Delta</p></a></li>
<li><a href='#q_gamma_f'><p>M-Step Expected Log-Likelihood with respect to Gamma</p></a></li>
<li><a href='#sum_every_n'><p>Sum Every &quot;n&quot;th Element</p></a></li>
<li><a href='#sum_every_n1'><p>Sum Every &quot;n&quot;th Element, then add 1</p></a></li>
<li><a href='#true_classification_prob'><p>Compute Probability of Each True Outcome, for Every Subject</p></a></li>
<li><a href='#w_j'><p>Compute E-step for Binary Outcome Misclassification Model Estimated With the EM-Algorithm</p></a></li>
<li><a href='#w_j_2stage'><p>Compute E-step for Two-Stage Binary Outcome Misclassification Model Estimated With the EM-Algorithm</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Correcting Misclassified Binary Outcomes in Association Studies</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Kimberly Hochstedler Webb [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kimberly Hochstedler Webb &lt;kah343@cornell.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Use frequentist and Bayesian methods to estimate parameters from a
  binary outcome misclassification model. These methods correct for the problem
  of "label switching" by assuming that the sum of outcome sensitivity and 
  specificity is at least 1. A description of the analysis methods is
  available in Hochstedler and Wells (2023) &lt;<a href="https://doi.org/10.48550%2FarXiv.2303.10215">doi:10.48550/arXiv.2303.10215</a>&gt;. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr (&ge; 1.0.10), tidyr (&ge; 1.2.1), Matrix (&gt; 1.4-1), rjags
(&ge; 4-13), turboEM (&ge; 2021.1), SAMBA (&ge; 0.9.0), utils (&ge;
4.2.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr (&ge; 1.40), testthat (&ge; 3.0.0), devtools (&ge; 2.4.5),
xtable (&ge; 1.8.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>JAGS (http://mcmc-jags.sourceforge.net)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Collate:</td>
<td>'sum_every_n1.R' 'sum_every_n.R' 'pistar_compute.R'
'pi_compute.R' 'COMBO_data.R' 'expit.R'
'perfect_sensitivity_EM.R' 'w_j.R' 'q_gamma_f.R' 'q_beta_f.R'
'em_function.R' 'loglik.R' 'COMBO_EM.R' 'pitilde_compute.R'
'COMBO_data_2stage.R' 'w_j_2stage.R' 'q_delta_f.R'
'em_function_2stage.R' 'loglik_2stage.R' 'COMBO_EM_2stage.R'
'COMBO_EM_data.R' 'label_switch.R' 'check_and_fix_chains.R'
'mean_pistarjj_compute.R' 'pistar_compute_for_chains.R'
'pistar_by_chain.R' 'naive_jags_picker.R'
'naive_model_picker.R' 'jags_picker.R' 'model_picker.R'
'COMBO_MCMC.R' 'model_picker_2stage.R' 'COMBO_MCMC_2stage.R'
'LSAC_data.R' 'check_and_fix_chains_2stage.R'
'jags_picker_2stage.R' 'label_switch_2stage.R'
'misclassification_prob.R' 'misclassification_prob2.R'
'naive_jags_picker_2stage.R' 'naive_loglik_2stage.R'
'naive_model_picker_2stage.R' 'pistar_by_chain_2stage.R'
'pistar_compute_for_chains_2stage.R' 'pitilde_by_chain.R'
'pitilde_compute_for_chains.R' 'true_classification_prob.R'</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-06 19:28:11 UTC; kimho</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-06 22:22:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='check_and_fix_chains'>Check Assumption and Fix Label Switching if Assumption is Broken for a List of MCMC Samples</h2><span id='topic+check_and_fix_chains'></span>

<h3>Description</h3>

<p>Check Assumption and Fix Label Switching if Assumption is Broken for a List of MCMC Samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_and_fix_chains(
  n_chains,
  chains_list,
  pistarjj_matrix,
  dim_x,
  dim_z,
  n_cat
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_and_fix_chains_+3A_n_chains">n_chains</code></td>
<td>
<p>An integer specifying the number of MCMC chains to compute over.</p>
</td></tr>
<tr><td><code id="check_and_fix_chains_+3A_chains_list">chains_list</code></td>
<td>
<p>A numeric list containing the samples from <code>n_chains</code>
MCMC chains.</p>
</td></tr>
<tr><td><code id="check_and_fix_chains_+3A_pistarjj_matrix">pistarjj_matrix</code></td>
<td>
<p>A numeric matrix of the average
conditional probability <code class="reqn">P(Y^* = j | Y = j, Z)</code> across all subjects for
each MCMC chain, obtained from the <code>pistar_by_chain</code> function.</p>
</td></tr>
<tr><td><code id="check_and_fix_chains_+3A_dim_x">dim_x</code></td>
<td>
<p>The number of columns of the design matrix of the true outcome mechanism, <code>X</code>.</p>
</td></tr>
<tr><td><code id="check_and_fix_chains_+3A_dim_z">dim_z</code></td>
<td>
<p>The number of columns of the design matrix of the observation mechanism, <code>Z</code>.</p>
</td></tr>
<tr><td><code id="check_and_fix_chains_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcome, <code>Y*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>check_and_fix_chains</code> returns a numeric list of the samples from
<code>n_chains</code> MCMC chains which have been corrected for label switching if
the following assumption is not met: <code class="reqn">P(Y^* = j | Y = j, Z) &gt; 0.50 \forall j</code>.
</p>

<hr>
<h2 id='check_and_fix_chains_2stage'>Check Assumption and Fix Label Switching if Assumption is Broken for a List of MCMC Samples</h2><span id='topic+check_and_fix_chains_2stage'></span>

<h3>Description</h3>

<p>Check Assumption and Fix Label Switching if Assumption is Broken for a List of MCMC Samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_and_fix_chains_2stage(
  n_chains,
  chains_list,
  pistarjj_matrix,
  pitildejjj_matrix,
  dim_x,
  dim_z,
  dim_v,
  n_cat
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_and_fix_chains_2stage_+3A_n_chains">n_chains</code></td>
<td>
<p>An integer specifying the number of MCMC chains to compute over.</p>
</td></tr>
<tr><td><code id="check_and_fix_chains_2stage_+3A_chains_list">chains_list</code></td>
<td>
<p>A numeric list containing the samples from <code>n_chains</code>
MCMC chains.</p>
</td></tr>
<tr><td><code id="check_and_fix_chains_2stage_+3A_pistarjj_matrix">pistarjj_matrix</code></td>
<td>
<p>A numeric matrix of the average
conditional probability <code class="reqn">P(Y^* = j | Y = j, Z)</code> across all subjects for
each MCMC chain, obtained from the <code>pistar_by_chain</code> function.</p>
</td></tr>
<tr><td><code id="check_and_fix_chains_2stage_+3A_pitildejjj_matrix">pitildejjj_matrix</code></td>
<td>
<p>A numeric matrix of the average conditional probability
<code class="reqn">P( \tilde{Y} = j | Y^* = j, Y = j, V)</code> across all subjects for
each MCMC chain. Rows of the matrix correspond to MCMC chains, up to <code>n_chains</code>.
Obtained from the <code>pitilde_by_chain</code> function.</p>
</td></tr>
<tr><td><code id="check_and_fix_chains_2stage_+3A_dim_x">dim_x</code></td>
<td>
<p>The number of columns of the design matrix of the true outcome mechanism, <code>X</code>.</p>
</td></tr>
<tr><td><code id="check_and_fix_chains_2stage_+3A_dim_z">dim_z</code></td>
<td>
<p>The number of columns of the design matrix of the first-stage observation mechanism, <code>Z</code>.</p>
</td></tr>
<tr><td><code id="check_and_fix_chains_2stage_+3A_dim_v">dim_v</code></td>
<td>
<p>The number of columns of the design matrix of the second-stage observation mechanism, <code>V</code>.</p>
</td></tr>
<tr><td><code id="check_and_fix_chains_2stage_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcome, <code>Y*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>check_and_fix_chains</code> returns a numeric list of the samples from
<code>n_chains</code> MCMC chains which have been corrected for label switching if
the following assumption is not met: <code class="reqn">P(Y^* = j | Y = j, Z) &gt; 0.50 \forall j</code>.
</p>

<hr>
<h2 id='COMBO_data'>Generate Data to use in COMBO Functions</h2><span id='topic+COMBO_data'></span>

<h3>Description</h3>

<p>Generate Data to use in COMBO Functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMBO_data(sample_size, x_mu, x_sigma, z_shape, beta, gamma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="COMBO_data_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer specifying the sample size of the generated data set.</p>
</td></tr>
<tr><td><code id="COMBO_data_+3A_x_mu">x_mu</code></td>
<td>
<p>A numeric value specifying the mean of <code>x</code> predictors
generated from a Normal distribution.</p>
</td></tr>
<tr><td><code id="COMBO_data_+3A_x_sigma">x_sigma</code></td>
<td>
<p>A positive numeric value specifying the standard deviation of
<code>x</code> predictors generated from a Normal distribution.</p>
</td></tr>
<tr><td><code id="COMBO_data_+3A_z_shape">z_shape</code></td>
<td>
<p>A positive numeric value specifying the shape parameter of
<code>z</code> predictors generated from a Gamma distribution.</p>
</td></tr>
<tr><td><code id="COMBO_data_+3A_beta">beta</code></td>
<td>
<p>A column matrix of <code class="reqn">\beta</code> parameter values (intercept, slope)
to generate data under in the true outcome mechanism.</p>
</td></tr>
<tr><td><code id="COMBO_data_+3A_gamma">gamma</code></td>
<td>
<p>A numeric matrix of <code class="reqn">\gamma</code> parameters
to generate data under in the observation mechanism.
In matrix form, the <code>gamma</code> matrix rows correspond to intercept (row 1)
and slope (row 2) terms. The gamma parameter matrix columns correspond to the true outcome categories
<code class="reqn">Y \in \{1, 2\}</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>COMBO_data</code> returns a list of generated data elements:
</p>
<table>
<tr><td><code>obs_Y</code></td>
<td>
<p>A vector of observed outcomes.</p>
</td></tr>
<tr><td><code>true_Y</code></td>
<td>
<p>A vector of true outcomes.</p>
</td></tr>
<tr><td><code>obs_Y_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the observed
outcome <code>Y*</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row contains
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>A vector of generated predictor values in the true outcome
mechanism, from the Normal distribution.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>A vector of generated predictor values in the observation
mechanism from the Gamma distribution.</p>
</td></tr>
<tr><td><code>x_design_matrix</code></td>
<td>
<p>The design matrix for the <code>x</code> predictor.</p>
</td></tr>
<tr><td><code>z_design_matrix</code></td>
<td>
<p>The design matrix for the <code>z</code> predictor.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
n &lt;- 500
x_mu &lt;- 0
x_sigma &lt;- 1
z_shape &lt;- 1

true_beta &lt;- matrix(c(1, -2), ncol = 1)
true_gamma &lt;- matrix(c(.5, 1, -.5, -1), nrow = 2, byrow = FALSE)

my_data &lt;- COMBO_data(sample_size = n,
                      x_mu = x_mu, x_sigma = x_sigma,
                      z_shape = z_shape,
                      beta = true_beta, gamma = true_gamma)
table(my_data[["obs_Y"]], my_data[["true_Y"]])
</code></pre>

<hr>
<h2 id='COMBO_data_2stage'>Generate data to use in two-stage COMBO Functions</h2><span id='topic+COMBO_data_2stage'></span>

<h3>Description</h3>

<p>Generate data to use in two-stage COMBO Functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMBO_data_2stage(
  sample_size,
  x_mu,
  x_sigma,
  z1_shape,
  z2_shape,
  beta,
  gamma1,
  gamma2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="COMBO_data_2stage_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer specifying the sample size of the generated data set.</p>
</td></tr>
<tr><td><code id="COMBO_data_2stage_+3A_x_mu">x_mu</code></td>
<td>
<p>A numeric value specifying the mean of <code>x</code> predictors
generated from a Normal distribution.</p>
</td></tr>
<tr><td><code id="COMBO_data_2stage_+3A_x_sigma">x_sigma</code></td>
<td>
<p>A positive numeric value specifying the standard deviation of
<code>x</code> predictors generated from a Normal distribution.</p>
</td></tr>
<tr><td><code id="COMBO_data_2stage_+3A_z1_shape">z1_shape</code></td>
<td>
<p>A positive numeric value specifying the shape parameter of
<code>z1</code> predictors generated from a Gamma distribution.</p>
</td></tr>
<tr><td><code id="COMBO_data_2stage_+3A_z2_shape">z2_shape</code></td>
<td>
<p>A positive numeric value specifying the shape parameter of
<code>z2</code> predictors generated from a Gamma distribution.</p>
</td></tr>
<tr><td><code id="COMBO_data_2stage_+3A_beta">beta</code></td>
<td>
<p>A column matrix of <code class="reqn">\beta</code> parameter values (intercept, slope)
to generate data under in the true outcome mechanism.</p>
</td></tr>
<tr><td><code id="COMBO_data_2stage_+3A_gamma1">gamma1</code></td>
<td>
<p>A numeric matrix of <code class="reqn">\gamma^{(1)}</code> parameters
to generate data under in the first-stage observation mechanism.
In matrix form, the <code>gamma1</code> matrix rows correspond to intercept (row 1)
and slope (row 2) terms. The <code>gamma1</code> parameter matrix columns correspond to the true outcome categories
<code class="reqn">Y \in \{1, 2\}</code>.</p>
</td></tr>
<tr><td><code id="COMBO_data_2stage_+3A_gamma2">gamma2</code></td>
<td>
<p>A numeric array of <code class="reqn">\gamma^{(2)}</code> parameters to generate data under
the second-stage observation mechanism. In array form, the <code>gamma2</code> matrix rows
correspond to intercept (row 1) and slope (row 2) terms. The matrix columns correspond
to first-stage observed outcome categories. The third dimension of the <code>gamma2</code>
array is indexed by the true outcome categories.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>COMBO_data_2stage</code> returns a list of generated data elements:
</p>
<table>
<tr><td><code>obs_Ystar1</code></td>
<td>
<p>A vector of first-stage observed outcomes.</p>
</td></tr>
<tr><td><code>obs_Ystar2</code></td>
<td>
<p>A vector of second-stage observed outcomes.</p>
</td></tr>
<tr><td><code>true_Y</code></td>
<td>
<p>A vector of true outcomes.</p>
</td></tr>
<tr><td><code>obs_Ystar1_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the first-stage observed
outcome <code class="reqn">Y^{*(1)}</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row contains
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code>obs_Ystar2_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the second-stage observed
outcome <code class="reqn">Y^{*(2)}</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row contains
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>A vector of generated predictor values in the true outcome
mechanism, from the Normal distribution.</p>
</td></tr>
<tr><td><code>z1</code></td>
<td>
<p>A vector of generated predictor values in the first-stage observation
mechanism from the Gamma distribution.</p>
</td></tr>
<tr><td><code>z2</code></td>
<td>
<p>A vector of generated predictor values in the second-stage observation
mechanism from the Gamma distribution.</p>
</td></tr>
<tr><td><code>x_design_matrix</code></td>
<td>
<p>The design matrix for the <code>x</code> predictor.</p>
</td></tr>
<tr><td><code>z1_design_matrix</code></td>
<td>
<p>The design matrix for the <code>z1</code> predictor.</p>
</td></tr>
<tr><td><code>z2_design_matrix</code></td>
<td>
<p>The design matrix for the <code>z2</code> predictor.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
n &lt;- 1000
x_mu &lt;- 0
x_sigma &lt;- 1
z1_shape &lt;- 1
z2_shape &lt;- 1

true_beta &lt;- matrix(c(1, -2), ncol = 1)
true_gamma1 &lt;- matrix(c(.5, 1, -.5, -1), nrow = 2, byrow = FALSE)
true_gamma2 &lt;- array(c(1.5, 1, .5, .5, -.5, 0, -1, -1), dim = c(2, 2, 2))

my_data &lt;- COMBO_data_2stage(sample_size = n,
                             x_mu = x_mu, x_sigma = x_sigma,
                             z1_shape = z1_shape, z2_shape = z2_shape,
                             beta = true_beta, gamma1 = true_gamma1, gamma2 = true_gamma2)
table(my_data[["obs_Ystar2"]], my_data[["obs_Ystar1"]], my_data[["true_Y"]])
</code></pre>

<hr>
<h2 id='COMBO_EM'>EM-Algorithm Estimation of the Binary Outcome Misclassification Model</h2><span id='topic+COMBO_EM'></span>

<h3>Description</h3>

<p>Jointly estimate <code class="reqn">\beta</code> and <code class="reqn">\gamma</code> parameters from the true outcome
and observation mechanisms, respectively, in a binary outcome misclassification
model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMBO_EM(
  Ystar,
  x_matrix,
  z_matrix,
  beta_start,
  gamma_start,
  tolerance = 1e-07,
  max_em_iterations = 1500,
  em_method = "squarem"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="COMBO_EM_+3A_ystar">Ystar</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the observed
outcome <code>Y*</code>. There should be no <code>NA</code> terms. The reference category is 2.</p>
</td></tr>
<tr><td><code id="COMBO_EM_+3A_x_matrix">x_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true outcome mechanism.
<code>x_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_+3A_z_matrix">z_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the observation mechanism.
<code>z_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_+3A_beta_start">beta_start</code></td>
<td>
<p>A numeric vector or column matrix of starting values for the <code class="reqn">\beta</code>
parameters in the true outcome mechanism. The number of elements in <code>beta_start</code>
should be equal to the number of columns of <code>x_matrix</code> plus 1.</p>
</td></tr>
<tr><td><code id="COMBO_EM_+3A_gamma_start">gamma_start</code></td>
<td>
<p>A numeric vector or matrix of starting values for the <code class="reqn">\gamma</code>
parameters in the observation mechanism. In matrix form, the <code>gamma_start</code> matrix rows
correspond to parameters for the <code>Y* = 1</code>
observed outcome, with the dimensions of <code>z_matrix</code> plus 1, and the
gamma parameter matrix columns correspond to the true outcome categories
<code class="reqn">Y \in \{1, 2\}</code>. A numeric vector for <code>gamma_start</code> is
obtained by concatenating the gamma matrix, i.e. <code>gamma_start &lt;- c(gamma_matrix)</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_+3A_tolerance">tolerance</code></td>
<td>
<p>A numeric value specifying when to stop estimation, based on
the difference of subsequent log-likelihood estimates. The default is <code>1e-7</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_+3A_max_em_iterations">max_em_iterations</code></td>
<td>
<p>An integer specifying the maximum number of
iterations of the EM algorithm. The default is <code>1500</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_+3A_em_method">em_method</code></td>
<td>
<p>A character string specifying which EM algorithm will be applied.
Options are <code>"em"</code>, <code>"squarem"</code>, or <code>"pem"</code>. The default and
recommended option is <code>"squarem"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>COMBO_EM</code> returns a data frame containing four columns. The first
column, <code>Parameter</code>, represents a unique parameter value for each row.
The next column contains the parameter <code>Estimates</code>, followed by the standard
error estimates, <code>SE</code>. The final column, <code>Convergence</code>, reports
whether or not the algorithm converged for a given parameter estimate.
</p>
<p>Estimates are provided for the binary misclassification model, as well as two
additional cases. The &quot;SAMBA&quot; parameter estimates are from the R Package,
SAMBA, which uses the EM algorithm to estimate a binary outcome misclassification
model that assumes there is perfect specificity. The &quot;PSens&quot; parameter estimates
are estimated using the EM algorithm for the binary outcome misclassification
model that assumes there is perfect sensitivitiy. The &quot;Naive&quot; parameter
estimates are from a simple logistic regression <code>Y* ~ X</code>.
</p>


<h3>References</h3>

<p>Beesley, L. and Mukherjee, B. (2020).
Statistical inference for association studies using electronic health records:
Handling both selection bias and outcome misclassification.
Biometrics, 78, 214-226.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
n &lt;- 1000
x_mu &lt;- 0
x_sigma &lt;- 1
z_shape &lt;- 1

true_beta &lt;- matrix(c(1, -2), ncol = 1)
true_gamma &lt;- matrix(c(.5, 1, -.5, -1), nrow = 2, byrow = FALSE)

x_matrix = matrix(rnorm(n, x_mu, x_sigma), ncol = 1)
X = matrix(c(rep(1, n), x_matrix[,1]), ncol = 2, byrow = FALSE)
z_matrix = matrix(rgamma(n, z_shape), ncol = 1)
Z = matrix(c(rep(1, n), z_matrix[,1]), ncol = 2, byrow = FALSE)

exp_xb = exp(X %*% true_beta)
pi_result = exp_xb[,1] / (exp_xb[,1] + 1)
pi_matrix = matrix(c(pi_result, 1 - pi_result), ncol = 2, byrow = FALSE)

true_Y &lt;- rep(NA, n)
for(i in 1:n){
    true_Y[i] = which(stats::rmultinom(1, 1, pi_matrix[i,]) == 1)
}

exp_zg = exp(Z %*% true_gamma)
pistar_denominator = matrix(c(1 + exp_zg[,1], 1 + exp_zg[,2]), ncol = 2, byrow = FALSE)
pistar_result = exp_zg / pistar_denominator

pistar_matrix = matrix(c(pistar_result[,1], 1 - pistar_result[,1],
                         pistar_result[,2], 1 - pistar_result[,2]),
                       ncol = 2, byrow = FALSE)

obs_Y &lt;- rep(NA, n)
for(i in 1:n){
    true_j = true_Y[i]
    obs_Y[i] = which(rmultinom(1, 1,
                     pistar_matrix[c(i, n + i),
                                     true_j]) == 1)
 }

Ystar &lt;- obs_Y

starting_values &lt;- rep(1,6)
beta_start &lt;- matrix(starting_values[1:2], ncol = 1)
gamma_start &lt;- matrix(starting_values[3:6], ncol = 2, nrow = 2, byrow = FALSE)

EM_results &lt;- COMBO_EM(Ystar, x_matrix = x_matrix, z_matrix = z_matrix,
                       beta_start = beta_start, gamma_start = gamma_start)

EM_results
</code></pre>

<hr>
<h2 id='COMBO_EM_2stage'>EM-Algorithm Estimation of the Two-Stage Binary Outcome Misclassification Model</h2><span id='topic+COMBO_EM_2stage'></span>

<h3>Description</h3>

<p>Jointly estimate <code class="reqn">\beta</code>, <code class="reqn">\gamma^{(1)}</code>, <code class="reqn">\gamma^{(2)}</code> parameters from the true outcome,
first-stage observation, and second-stage observation mechanisms, respectively,
in a two-stage binary outcome misclassification model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMBO_EM_2stage(
  Ystar1,
  Ystar2,
  x_matrix,
  z1_matrix,
  z2_matrix,
  beta_start,
  gamma1_start,
  gamma2_start,
  tolerance = 1e-07,
  max_em_iterations = 1500,
  em_method = "squarem"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="COMBO_EM_2stage_+3A_ystar1">Ystar1</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the first-stage observed
outcome <code class="reqn">Y^{*(1)}</code>. There should be no <code>NA</code> terms. The reference category is 2.</p>
</td></tr>
<tr><td><code id="COMBO_EM_2stage_+3A_ystar2">Ystar2</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the second-stage
observed outcome <code class="reqn">Y^{*(2)}</code>. There should be no <code>NA</code> terms. The
reference category is 2.</p>
</td></tr>
<tr><td><code id="COMBO_EM_2stage_+3A_x_matrix">x_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true outcome mechanism.
<code>x_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_2stage_+3A_z1_matrix">z1_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the first-stage observation mechanism.
<code>z1_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_2stage_+3A_z2_matrix">z2_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the second-stage observation mechanism.
<code>z2_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_2stage_+3A_beta_start">beta_start</code></td>
<td>
<p>A numeric vector or column matrix of starting values for the <code class="reqn">\beta</code>
parameters in the true outcome mechanism. The number of elements in <code>beta_start</code>
should be equal to the number of columns of <code>x_matrix</code> plus 1.</p>
</td></tr>
<tr><td><code id="COMBO_EM_2stage_+3A_gamma1_start">gamma1_start</code></td>
<td>
<p>A numeric vector or matrix of starting values for the <code class="reqn">\gamma^{(1)}</code>
parameters in the first-stage observation mechanism. In matrix form, the <code>gamma1_start</code> matrix rows
correspond to parameters for the <code class="reqn">Y^{*(1)} = 1</code>
first-stage observed outcome, with the dimensions of <code>z1_matrix</code> plus 1, and the
parameter matrix columns correspond to the true outcome categories
<code class="reqn">Y \in \{1, 2\}</code>. A numeric vector for <code>gamma1_start</code> is
obtained by concatenating the matrix, i.e. <code>gamma1_start &lt;- c(gamma1_matrix)</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_2stage_+3A_gamma2_start">gamma2_start</code></td>
<td>
<p>A numeric array of starting values for the <code class="reqn">\gamma^{(2)}</code> parameters
in the second-stage observation mechanism. The first dimension (matrix rows)
of <code>gamma2_start</code> correspond to parameters for the <code class="reqn">Y^{*(2)} = 1</code>
second-stage observed outcome, with the dimensions of the <code>z2_matrix</code>
plus 1. The second dimension (matrix columns) correspond to the first-stage
observed outcome categories <code class="reqn">Y^{*(1)} \in \{1, 2\}</code>. The third dimension of
<code>gamma2_start</code> corresponds to to the true outcome categories
<code class="reqn">Y \in \{1, 2\}</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_2stage_+3A_tolerance">tolerance</code></td>
<td>
<p>A numeric value specifying when to stop estimation, based on
the difference of subsequent log-likelihood estimates. The default is <code>1e-7</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_2stage_+3A_max_em_iterations">max_em_iterations</code></td>
<td>
<p>An integer specifying the maximum number of
iterations of the EM algorithm. The default is <code>1500</code>.</p>
</td></tr>
<tr><td><code id="COMBO_EM_2stage_+3A_em_method">em_method</code></td>
<td>
<p>A character string specifying which EM algorithm will be applied.
Options are <code>"em"</code>, <code>"squarem"</code>, or <code>"pem"</code>. The default and
recommended option is <code>"squarem"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>COMBO_EM_2stage</code> returns a data frame containing four columns. The first
column, <code>Parameter</code>, represents a unique parameter value for each row.
The next column contains the parameter <code>Estimates</code>, followed by the standard
error estimates, <code>SE</code>. The final column, <code>Convergence</code>, reports
whether or not the algorithm converged for a given parameter estimate.
</p>
<p>Estimates are provided for the two-stage binary misclassification model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
n &lt;- 1000
x_mu &lt;- 0
x_sigma &lt;- 1
z1_shape &lt;- 1
z2_shape &lt;- 1

true_beta &lt;- matrix(c(1, -2), ncol = 1)
true_gamma1 &lt;- matrix(c(.5, 1, -.5, -1), nrow = 2, byrow = FALSE)
true_gamma2 &lt;- array(c(1.5, 1, .5, .5, -.5, 0, -1, -1), dim = c(2, 2, 2))

my_data &lt;- COMBO_data_2stage(sample_size = n,
                             x_mu = x_mu, x_sigma = x_sigma,
                             z1_shape = z1_shape, z2_shape = z2_shape,
                             beta = true_beta, gamma1 = true_gamma1, gamma2 = true_gamma2)
table(my_data[["obs_Ystar2"]], my_data[["obs_Ystar1"]], my_data[["true_Y"]])

beta_start &lt;- rnorm(length(c(true_beta)))
gamma1_start &lt;- rnorm(length(c(true_gamma1)))
gamma2_start &lt;- rnorm(length(c(true_gamma2)))

EM_results &lt;- COMBO_EM_2stage(Ystar1 = my_data[["obs_Ystar1"]],
                              Ystar2 = my_data[["obs_Ystar2"]],
                              x_matrix = my_data[["x"]],
                              z1_matrix = my_data[["z1"]],
                              z2_matrix = my_data[["z2"]],
                              beta_start = beta_start,
                              gamma1_start = gamma1_start,
                              gamma2_start = gamma2_start)

EM_results
</code></pre>

<hr>
<h2 id='COMBO_EM_data'>Test data for the COMBO_EM function</h2><span id='topic+COMBO_EM_data'></span>

<h3>Description</h3>

<p>A dataset for testing the <code>COMBO_EM</code> function, generated from the
<code>COMBO_data</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMBO_EM_data
</code></pre>


<h3>Format</h3>

<p>A list containing 6 variables for 1000 observations:
</p>

<dl>
<dt>Y</dt><dd><p>The true outcome variable</p>
</dd>
<dt>Ystar</dt><dd><p>The observed outcome variable</p>
</dd>
<dt>x_matrix</dt><dd><p>A matrix of predictor values in the true outcome mechanism</p>
</dd>
<dt>z_matrix</dt><dd><p>A matrix of predictor values in the observed outcome mechanism</p>
</dd>
<dt>true_beta</dt><dd><p>Beta parameter values used for data generation in the true outcome mechanism</p>
</dd>
<dt>true_gamma</dt><dd><p>Gamma parameter values used for data generation in the observed outcome mechanism</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("COMBO_EM_data")
head(COMBO_EM_data)

## End(Not run)

</code></pre>

<hr>
<h2 id='COMBO_MCMC'>MCMC Estimation of the Binary Outcome Misclassification Model</h2><span id='topic+COMBO_MCMC'></span>

<h3>Description</h3>

<p>Jointly estimate <code class="reqn">\beta</code> and <code class="reqn">\gamma</code> parameters from the true outcome
and observation mechanisms, respectively, in a binary outcome misclassification
model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMBO_MCMC(
  Ystar,
  x_matrix,
  z_matrix,
  prior,
  beta_prior_parameters,
  gamma_prior_parameters,
  number_MCMC_chains = 4,
  MCMC_sample = 2000,
  burn_in = 1000,
  display_progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="COMBO_MCMC_+3A_ystar">Ystar</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the observed
outcome <code>Y*</code>. The reference category is 2.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_+3A_x_matrix">x_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true outcome mechanism.
<code>x_matrix</code> should not contain an intercept.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_+3A_z_matrix">z_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the observation mechanism.
<code>z_matrix</code> should not contain an intercept.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_+3A_prior">prior</code></td>
<td>
<p>A character string specifying the prior distribution for the
<code class="reqn">\beta</code> and <code class="reqn">\gamma</code> parameters. Options are <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code> (double Exponential, or Weibull).</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_+3A_beta_prior_parameters">beta_prior_parameters</code></td>
<td>
<p>A numeric list of prior distribution parameters
for the <code class="reqn">\beta</code> terms. For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the first element of the
list should contain a matrix of location, lower bound, mean, or shape parameters,
respectively, for <code class="reqn">\beta</code> terms.
For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the second element of the
list should contain a matrix of shape, upper bound, standard deviation, or scale parameters,
respectively, for <code class="reqn">\beta</code> terms.
For prior distribution <code>"t"</code>, the third element of the list should contain
a matrix of the degrees of freedom for <code class="reqn">\beta</code> terms.
The third list element should be empty for all other prior distributions.
All matrices in the list should have dimensions <code>n_cat</code> X <code>dim_x</code>, and all
elements in the <code>n_cat</code> row should be set to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_+3A_gamma_prior_parameters">gamma_prior_parameters</code></td>
<td>
<p>A numeric list of prior distribution parameters
for the <code class="reqn">\gamma</code> terms. For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the first element of the
list should contain an array of location, lower bound, mean, or shape parameters,
respectively, for <code class="reqn">\gamma</code> terms.
For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the second element of the
list should contain an array of shape, upper bound, standard deviation, or scale parameters,
respectively, for <code class="reqn">\gamma</code> terms.
For prior distribution <code>"t"</code>, the third element of the list should contain
an array of the degrees of freedom for <code class="reqn">\gamma</code> terms.
The third list element should be empty for all other prior distributions.
All arrays in the list should have dimensions <code>n_cat</code> X <code>n_cat</code> X <code>dim_z</code>,
and all elements in the <code>n_cat</code> row should be set to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_+3A_number_mcmc_chains">number_MCMC_chains</code></td>
<td>
<p>An integer specifying the number of MCMC chains to compute.
The default is <code>4</code>.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_+3A_mcmc_sample">MCMC_sample</code></td>
<td>
<p>An integer specifying the number of MCMC samples to draw.
The default is <code>2000</code>.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_+3A_burn_in">burn_in</code></td>
<td>
<p>An integer specifying the number of MCMC samples to discard
for the burn-in period. The default is <code>1000</code>.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_+3A_display_progress">display_progress</code></td>
<td>
<p>A logical value specifying whether messages should be
displayed during model compilation. The default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>COMBO_MCMC</code> returns a list of the posterior samples and posterior
means for both the binary outcome misclassification model and a naive logistic
regression of the observed outcome, <code>Y*</code>, predicted by the matrix <code>x</code>.
The list contains the following components:
</p>
<table>
<tr><td><code>posterior_sample_df</code></td>
<td>
<p>A data frame containing three columns. The first
column indicates the chain from which a sample is taken, from 1 to <code>number_MCMC_chains</code>.
The second column specifies the parameter associated with a given row. <code class="reqn">\beta</code>
terms have dimensions <code>dim_x</code> X <code>n_cat</code>. The <code class="reqn">\gamma</code> terms
have dimensions <code>n_cat</code> X <code>n_cat</code> X <code>dim_z</code>, where the first
index specifies the observed outcome category and the second index specifies
the true outcome category. The final column provides the MCMC sample.</p>
</td></tr>
<tr><td><code>posterior_means_df</code></td>
<td>
<p>A data frame containing three columns. The first
column specifies the parameter associated with a given row. Parameters are
indexed as in the <code>posterior_sample_df</code>. The second column provides
the posterior mean computed across all chains and all samples. The final column
provides the posterior median computed across all chains and all samples.</p>
</td></tr>
<tr><td><code>naive_posterior_sample_df</code></td>
<td>
<p>A data frame containing three columns.
The first column indicates the chain from which a sample is taken, from
1 to <code>number_MCMC_chains</code>. The second column specifies the parameter
associated with a given row. Naive <code class="reqn">\beta</code> terms have dimensions
<code>dim_x</code> X <code>n_cat</code>. The final column provides the MCMC sample.</p>
</td></tr>
<tr><td><code>naive_posterior_means_df</code></td>
<td>
<p>A data frame containing three columns. The first
column specifies the naive parameter associated with a given row. Parameters are
indexed as in the <code>naive_posterior_sample_df</code>. The second column provides
the posterior mean computed across all chains and all samples. The final column
provides the posterior median computed across all chains and all samples.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
n &lt;- 1000
x_mu &lt;- 0
x_sigma &lt;- 1
z_shape &lt;- 1

true_beta &lt;- matrix(c(1, -2), ncol = 1)
true_gamma &lt;- matrix(c(.5, 1, -.5, -1), nrow = 2, byrow = FALSE)

x_matrix = matrix(rnorm(n, x_mu, x_sigma), ncol = 1)
X = matrix(c(rep(1, n), x_matrix[,1]), ncol = 2, byrow = FALSE)
z_matrix = matrix(rgamma(n, z_shape), ncol = 1)
Z = matrix(c(rep(1, n), z_matrix[,1]), ncol = 2, byrow = FALSE)

exp_xb = exp(X %*% true_beta)
pi_result = exp_xb[,1] / (exp_xb[,1] + 1)
pi_matrix = matrix(c(pi_result, 1 - pi_result), ncol = 2, byrow = FALSE)

true_Y &lt;- rep(NA, n)
for(i in 1:n){
    true_Y[i] = which(stats::rmultinom(1, 1, pi_matrix[i,]) == 1)
}

exp_zg = exp(Z %*% true_gamma)
pistar_denominator = matrix(c(1 + exp_zg[,1], 1 + exp_zg[,2]), ncol = 2, byrow = FALSE)
pistar_result = exp_zg / pistar_denominator

pistar_matrix = matrix(c(pistar_result[,1], 1 - pistar_result[,1],
                         pistar_result[,2], 1 - pistar_result[,2]),
                       ncol = 2, byrow = FALSE)

obs_Y &lt;- rep(NA, n)
for(i in 1:n){
    true_j = true_Y[i]
    obs_Y[i] = which(rmultinom(1, 1,
                     pistar_matrix[c(i, n + i),
                                     true_j]) == 1)
 }

Ystar &lt;- obs_Y

unif_lower_beta &lt;- matrix(c(-5, -5, NA, NA), nrow = 2, byrow = TRUE)
unif_upper_beta &lt;- matrix(c(5, 5, NA, NA), nrow = 2, byrow = TRUE)

unif_lower_gamma &lt;- array(data = c(-5, NA, -5, NA, -5, NA, -5, NA),
                          dim = c(2,2,2))
unif_upper_gamma &lt;- array(data = c(5, NA, 5, NA, 5, NA, 5, NA),
                          dim = c(2,2,2))

beta_prior_parameters &lt;- list(lower = unif_lower_beta, upper = unif_upper_beta)
gamma_prior_parameters &lt;- list(lower = unif_lower_gamma, upper = unif_upper_gamma)

MCMC_results &lt;- COMBO_MCMC(Ystar, x = x_matrix, z = z_matrix,
                           prior = "uniform",
                           beta_prior_parameters = beta_prior_parameters,
                           gamma_prior_parameters = gamma_prior_parameters,
                           number_MCMC_chains = 2,
                           MCMC_sample = 200, burn_in = 100)
MCMC_results$posterior_means_df
</code></pre>

<hr>
<h2 id='COMBO_MCMC_2stage'>MCMC Estimation of the Two-Stage Binary Outcome Misclassification Model</h2><span id='topic+COMBO_MCMC_2stage'></span>

<h3>Description</h3>

<p>Jointly estimate <code class="reqn">\beta</code>, <code class="reqn">\gamma^{(1)}</code>, and <code class="reqn">\gamma^{(2)}</code> parameters from the true outcome
first-stage observation, and second-stage observation mechanisms, respectively,
in a two-stage binary outcome misclassification model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMBO_MCMC_2stage(
  Ystar1,
  Ystar2,
  x_matrix,
  z1_matrix,
  z2_matrix,
  prior,
  beta_prior_parameters,
  gamma1_prior_parameters,
  gamma2_prior_parameters,
  naive_gamma2_prior_parameters,
  number_MCMC_chains = 4,
  MCMC_sample = 2000,
  burn_in = 1000,
  display_progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="COMBO_MCMC_2stage_+3A_ystar1">Ystar1</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the observed
outcome <code class="reqn">Y^{*(1)}</code>. The reference category is 2.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_2stage_+3A_ystar2">Ystar2</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the second-stage
observed outcome <code class="reqn">Y^{*(2)}</code>. There should be no <code>NA</code> terms. The
reference category is 2.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_2stage_+3A_x_matrix">x_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true outcome mechanism.
<code>x_matrix</code> should not contain an intercept.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_2stage_+3A_z1_matrix">z1_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the observation mechanism.
<code>z1_matrix</code> should not contain an intercept.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_2stage_+3A_z2_matrix">z2_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the second-stage observation mechanism.
<code>z2_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_2stage_+3A_prior">prior</code></td>
<td>
<p>A character string specifying the prior distribution for the
<code class="reqn">\beta</code>, <code class="reqn">\gamma^{(1)}</code>, and <code class="reqn">\gamma^{(2)}</code> parameters. Options are <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code> (double Exponential, or Weibull).</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_2stage_+3A_beta_prior_parameters">beta_prior_parameters</code></td>
<td>
<p>A numeric list of prior distribution parameters
for the <code class="reqn">\beta</code> terms. For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the first element of the
list should contain a matrix of location, lower bound, mean, or shape parameters,
respectively, for <code class="reqn">\beta</code> terms.
For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the second element of the
list should contain a matrix of shape, upper bound, standard deviation, or scale parameters,
respectively, for <code class="reqn">\beta</code> terms.
For prior distribution <code>"t"</code>, the third element of the list should contain
a matrix of the degrees of freedom for <code class="reqn">\beta</code> terms.
The third list element should be empty for all other prior distributions.
All matrices in the list should have dimensions <code>n_cat</code> X <code>dim_x</code>, and all
elements in the <code>n_cat</code> row should be set to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_2stage_+3A_gamma1_prior_parameters">gamma1_prior_parameters</code></td>
<td>
<p>A numeric list of prior distribution parameters
for the <code class="reqn">\gamma^{(1)}</code> terms. For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the first element of the
list should contain an array of location, lower bound, mean, or shape parameters,
respectively, for <code class="reqn">\gamma^{(1)}</code> terms.
For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the second element of the
list should contain an array of shape, upper bound, standard deviation, or scale parameters,
respectively, for <code class="reqn">\gamma^{(1)}</code> terms.
For prior distribution <code>"t"</code>, the third element of the list should contain
an array of the degrees of freedom for <code class="reqn">\gamma^{(1)}</code> terms.
The third list element should be empty for all other prior distributions.
All arrays in the list should have dimensions <code>n_cat</code> X <code>n_cat</code> X <code>dim_z1</code>,
and all elements in the <code>n_cat</code> row should be set to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_2stage_+3A_gamma2_prior_parameters">gamma2_prior_parameters</code></td>
<td>
<p>A numeric list of prior distribution parameters
for the <code class="reqn">\gamma^{(2)}</code> terms. For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the first element of the
list should contain an array of location, lower bound, mean, or shape parameters,
respectively, for <code class="reqn">\gamma^{(2)}</code> terms.
For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the second element of the
list should contain an array of shape, upper bound, standard deviation, or scale parameters,
respectively, for <code class="reqn">\gamma^{(2)}</code> terms.
For prior distribution <code>"t"</code>, the third element of the list should contain
an array of the degrees of freedom for <code class="reqn">\gamma^{(2)}</code> terms.
The third list element should be empty for all other prior distributions.
All arrays in the list should have dimensions <code>n_cat</code> X
<code>n_cat</code> X <code>n_cat</code> X <code>dim_z2</code>,
and all elements in the <code>n_cat</code> row should be set to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_2stage_+3A_naive_gamma2_prior_parameters">naive_gamma2_prior_parameters</code></td>
<td>
<p>A numeric list of prior distribution parameters
for the naive model <code class="reqn">\gamma^{(2)}</code> terms. For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the first element of the
list should contain an array of location, lower bound, mean, or shape parameters,
respectively, for naive <code class="reqn">\gamma^{(2)}</code> terms.
For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the second element of the
list should contain an array of shape, upper bound, standard deviation, or scale parameters,
respectively, for naive <code class="reqn">\gamma^{(2)}</code> terms.
For prior distribution <code>"t"</code>, the third element of the list should contain
an array of the degrees of freedom for naive <code class="reqn">\gamma^{(2)}</code> terms.
The third list element should be empty for all other prior distributions.
All arrays in the list should have dimensions <code>n_cat</code> X <code>n_cat</code> X <code>dim_z2</code>,
and all elements in the <code>n_cat</code> row should be set to <code>NA</code>.
Note that prior distributions for the naive <code class="reqn">\beta</code> terms are inherted
from the <code>beta_prior_parameters</code> argument.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_2stage_+3A_number_mcmc_chains">number_MCMC_chains</code></td>
<td>
<p>An integer specifying the number of MCMC chains to compute.
The default is <code>4</code>.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_2stage_+3A_mcmc_sample">MCMC_sample</code></td>
<td>
<p>An integer specifying the number of MCMC samples to draw.
The default is <code>2000</code>.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_2stage_+3A_burn_in">burn_in</code></td>
<td>
<p>An integer specifying the number of MCMC samples to discard
for the burn-in period. The default is <code>1000</code>.</p>
</td></tr>
<tr><td><code id="COMBO_MCMC_2stage_+3A_display_progress">display_progress</code></td>
<td>
<p>A logical value specifying whether messages should be
displayed during model compilation. The default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>COMBO_MCMC_2stage</code> returns a list of the posterior samples and posterior
means for both the binary outcome misclassification model and a naive logistic
regression of the observed outcome, <code>Y*</code>, predicted by the matrix <code>x</code>.
The list contains the following components:
</p>
<table>
<tr><td><code>posterior_sample_df</code></td>
<td>
<p>A data frame containing three columns. The first
column indicates the chain from which a sample is taken, from 1 to <code>number_MCMC_chains</code>.
The second column specifies the parameter associated with a given row. <code class="reqn">\beta</code>
terms have dimensions <code>dim_x</code> X <code>n_cat</code>. The <code class="reqn">\gamma^{(1)}</code> terms
have dimensions <code>n_cat</code> X <code>n_cat</code> X <code>dim_z1</code>, where the first
index specifies the first-stage observed outcome category and the second index specifies
the true outcome category. The <code class="reqn">\gamma^{(2)}</code> terms
have dimensions <code>n_cat</code> X <code>n_cat</code> X <code>n_cat</code> X <code>dim_z2</code>, where the first
index specifies the second-stage observed outcome category, the second index specifies
the first-stage observed outcome category, and the third index specifies the true outcome category.
The final column provides the MCMC sample.</p>
</td></tr>
<tr><td><code>posterior_means_df</code></td>
<td>
<p>A data frame containing three columns. The first
column specifies the parameter associated with a given row. Parameters are
indexed as in the <code>posterior_sample_df</code>. The second column provides
the posterior mean computed across all chains and all samples. The final column
provides the posterior median computed across all chains and all samples.</p>
</td></tr>
<tr><td><code>naive_posterior_sample_df</code></td>
<td>
<p>A data frame containing three columns.
The first column indicates the chain from which a sample is taken, from
1 to <code>number_MCMC_chains</code>. The second column specifies the parameter
associated with a given row. Naive <code class="reqn">\beta</code> terms have dimensions
<code>dim_x</code> X <code>n_cat</code>. The final column provides the MCMC sample.</p>
</td></tr>
<tr><td><code>naive_posterior_means_df</code></td>
<td>
<p>A data frame containing three columns. The first
column specifies the naive parameter associated with a given row. Parameters are
indexed as in the <code>naive_posterior_sample_df</code>. The second column provides
the posterior mean computed across all chains and all samples. The final column
provides the posterior median computed across all chains and all samples.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>

# Helper functions
sum_every_n &lt;- function(x, n){
vector_groups = split(x,
                      ceiling(seq_along(x) / n))
sum_x = Reduce(`+`, vector_groups)

return(sum_x)
}

sum_every_n1 &lt;- function(x, n){
vector_groups = split(x,
                      ceiling(seq_along(x) / n))
sum_x = Reduce(`+`, vector_groups) + 1

return(sum_x)
}

# Example

set.seed(123)
n &lt;- 1000
x_mu &lt;- 0
x_sigma &lt;- 1
z1_shape &lt;- 1
z2_shape &lt;- 1

true_beta &lt;- matrix(c(1, -2), ncol = 1)
true_gamma1 &lt;- matrix(c(.5, 1, -.5, -1), nrow = 2, byrow = FALSE)
true_gamma2 &lt;- array(c(1.5, 1, .5, .5, -.5, 0, -1, -1), dim = c(2, 2, 2))

x_matrix = matrix(rnorm(n, x_mu, x_sigma), ncol = 1)
X = matrix(c(rep(1, n), x_matrix[,1]), ncol = 2, byrow = FALSE)
z1_matrix = matrix(rgamma(n, z1_shape), ncol = 1)
Z1 = matrix(c(rep(1, n), z1_matrix[,1]), ncol = 2, byrow = FALSE)
z2_matrix = matrix(rgamma(n, z2_shape), ncol = 1)
Z2 = matrix(c(rep(1, n), z2_matrix[,1]), ncol = 2, byrow = FALSE)

exp_xb = exp(X %*% true_beta)
pi_result = exp_xb[,1] / (exp_xb[,1] + 1)
pi_matrix = matrix(c(pi_result, 1 - pi_result), ncol = 2, byrow = FALSE)

true_Y &lt;- rep(NA, n)
for(i in 1:n){
    true_Y[i] = which(stats::rmultinom(1, 1, pi_matrix[i,]) == 1)
}

exp_z1g1 = exp(Z1 %*% true_gamma1)
pistar1_denominator = matrix(c(1 + exp_z1g1[,1], 1 + exp_z1g1[,2]),
                             ncol = 2, byrow = FALSE)
pistar1_result = exp_z1g1 / pistar1_denominator

pistar1_matrix = matrix(c(pistar1_result[,1], 1 - pistar1_result[,1],
                          pistar1_result[,2], 1 - pistar1_result[,2]),
                        ncol = 2, byrow = FALSE)


obs_Y1 &lt;- rep(NA, n)
for(i in 1:n){
    true_j = true_Y[i]
    obs_Y1[i] = which(rmultinom(1, 1,
                      pistar1_matrix[c(i, n + i),
                                     true_j]) == 1)
 }

Ystar1 &lt;- obs_Y1

exp_z2g2_1 = exp(Z2 %*% true_gamma2[,,1])
exp_z2g2_2 = exp(Z2 %*% true_gamma2[,,2])

pi_denominator1 = apply(exp_z2g2_1, FUN = sum_every_n1, n, MARGIN = 2)
pi_result1 = exp_z2g2_1 / rbind(pi_denominator1)

pi_denominator2 = apply(exp_z2g2_2, FUN = sum_every_n1, n, MARGIN = 2)
pi_result2 = exp_z2g2_2 / rbind(pi_denominator2)

pistar2_matrix1 = rbind(pi_result1,
                        1 - apply(pi_result1,
                                  FUN = sum_every_n, n = n,
                                  MARGIN = 2))

pistar2_matrix2 = rbind(pi_result2,
                        1 - apply(pi_result2,
                                  FUN = sum_every_n, n = n,
                                  MARGIN = 2))

pistar2_array = array(c(pistar2_matrix1, pistar2_matrix2),
                   dim = c(dim(pistar2_matrix1), 2))

obs_Y2 &lt;- rep(NA, n)
for(i in 1:n){
    true_j = true_Y[i]
    obs_k = Ystar1[i]
    obs_Y2[i] = which(rmultinom(1, 1,
                                  pistar2_array[c(i,n+ i),
                                                obs_k, true_j]) == 1)
}

Ystar2 &lt;- obs_Y2

unif_lower_beta &lt;- matrix(c(-5, -5, NA, NA), nrow = 2, byrow = TRUE)
unif_upper_beta &lt;- matrix(c(5, 5, NA, NA), nrow = 2, byrow = TRUE)

unif_lower_gamma1 &lt;- array(data = c(-5, NA, -5, NA, -5, NA, -5, NA),
                          dim = c(2,2,2))
unif_upper_gamma1 &lt;- array(data = c(5, NA, 5, NA, 5, NA, 5, NA),
                          dim = c(2,2,2))

unif_upper_gamma2 &lt;- array(rep(c(5, NA), 8), dim = c(2,2,2,2))
unif_lower_gamma2 &lt;- array(rep(c(-5, NA), 8), dim = c(2,2,2,2))

unif_lower_naive_gamma2 &lt;- array(data = c(-5, NA, -5, NA, -5, NA, -5, NA),
                                dim = c(2,2,2))
unif_upper_naive_gamma2 &lt;- array(data = c(5, NA, 5, NA, 5, NA, 5, NA),
                                dim = c(2,2,2))

beta_prior_parameters &lt;- list(lower = unif_lower_beta, upper = unif_upper_beta)
gamma1_prior_parameters &lt;- list(lower = unif_lower_gamma1, upper = unif_upper_gamma1)
gamma2_prior_parameters &lt;- list(lower = unif_lower_gamma2, upper = unif_upper_gamma2)
naive_gamma2_prior_parameters &lt;- list(lower = unif_lower_naive_gamma2,
                                      upper = unif_upper_naive_gamma2)

MCMC_results &lt;- COMBO_MCMC_2stage(Ystar1, Ystar2,
                                  x_matrix = x_matrix, z1_matrix = z1_matrix,
                                  z2_matrix = z2_matrix,
                                  prior = "uniform",
                                  beta_prior_parameters = beta_prior_parameters,
                                  gamma1_prior_parameters = gamma1_prior_parameters,
                                  gamma2_prior_parameters = gamma2_prior_parameters,
                                  naive_gamma2_prior_parameters = naive_gamma2_prior_parameters,
                                  number_MCMC_chains = 2,
                                  MCMC_sample = 200, burn_in = 100)
MCMC_results$posterior_means_df
</code></pre>

<hr>
<h2 id='em_function'>EM-Algorithm Function for Estimation of the Misclassification Model</h2><span id='topic+em_function'></span>

<h3>Description</h3>

<p>EM-Algorithm Function for Estimation of the Misclassification Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>em_function(param_current, obs_Y_matrix, X, Z, sample_size, n_cat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="em_function_+3A_param_current">param_current</code></td>
<td>
<p>A numeric vector of regression parameters, in the order
<code class="reqn">\beta, \gamma</code>. The <code class="reqn">\gamma</code> vector is obtained from the matrix form.
In matrix form, the gamma parameter matrix rows
correspond to parameters for the <code>Y* = 1</code>
observed outcome, with the dimensions of <code>Z</code>.
In matrix form, the gamma parameter matrix columns correspond to the true outcome categories
<code class="reqn">j = 1, \dots,</code> <code>n_cat</code>. The numeric vector <code>gamma_v</code> is
obtained by concatenating the gamma matrix, i.e. <code>gamma_v &lt;- c(gamma_matrix)</code>.</p>
</td></tr>
<tr><td><code id="em_function_+3A_obs_y_matrix">obs_Y_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the observed
outcome <code>Y*</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="em_function_+3A_x">X</code></td>
<td>
<p>A numeric design matrix for the true outcome mechanism.</p>
</td></tr>
<tr><td><code id="em_function_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix for the observation mechanism.</p>
</td></tr>
<tr><td><code id="em_function_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>X</code> or <code>Z</code>.</p>
</td></tr>
<tr><td><code id="em_function_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcome, <code>Y*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>em_function</code> returns a numeric vector of updated parameter
estimates from one iteration of the EM-algorithm.
</p>

<hr>
<h2 id='em_function_2stage'>EM-Algorithm Function for Estimation of the Two-Stage Misclassification Model</h2><span id='topic+em_function_2stage'></span>

<h3>Description</h3>

<p>EM-Algorithm Function for Estimation of the Two-Stage Misclassification Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>em_function_2stage(
  param_current,
  obs_Ystar_matrix,
  obs_Ytilde_matrix,
  X,
  Z,
  V,
  sample_size,
  n_cat
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="em_function_2stage_+3A_param_current">param_current</code></td>
<td>
<p>A numeric vector of regression parameters, in the order
<code class="reqn">\beta, \gamma, \delta</code>. The <code class="reqn">\gamma</code> vector is obtained from the matrix form.
In matrix form, the gamma parameter matrix rows
correspond to parameters for the <code>Y* = 1</code>
observed outcome, with the dimensions of <code>Z</code>.
In matrix form, the gamma parameter matrix columns correspond to the true outcome categories
<code class="reqn">j = 1, \dots,</code> <code>n_cat</code>. The numeric vector <code class="reqn">\gamma</code> is
obtained by concatenating the gamma matrix, i.e. <code>gamma_v &lt;- c(gamma_matrix)</code>.
The <code class="reqn">\delta</code> vector is obtained from the array form. In array form,
the first dimension (matrix rows) of <code>delta</code>
corresponds to parameters for the <code class="reqn">\tilde{Y} = 1</code>
second-stage observed outcome, with the dimensions of the <code>V</code>
The second dimension (matrix columns) correspond to the first-stage
observed outcome categories <code class="reqn">Y^* \in \{1, 2\}</code>. The third dimension of
<code>delta_start</code> corresponds to to the true outcome categories
<code class="reqn">Y \in \{1, 2\}</code>. The numeric vector <code class="reqn">\delta</code> is obtained by
concatenating the delta array, i.e. <code>delta_vector &lt;- c(delta_array)</code>.</p>
</td></tr>
<tr><td><code id="em_function_2stage_+3A_obs_ystar_matrix">obs_Ystar_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the first-stage observed
outcome <code>Y*</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="em_function_2stage_+3A_obs_ytilde_matrix">obs_Ytilde_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the second-stage observed
outcome <code class="reqn">\tilde{Y}</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="em_function_2stage_+3A_x">X</code></td>
<td>
<p>A numeric design matrix for the true outcome mechanism.</p>
</td></tr>
<tr><td><code id="em_function_2stage_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix for the first-stage observation mechanism.</p>
</td></tr>
<tr><td><code id="em_function_2stage_+3A_v">V</code></td>
<td>
<p>A numeric design matrix for the second-stage observation mechanism.</p>
</td></tr>
<tr><td><code id="em_function_2stage_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrices, <code>X</code>, <code>Z</code>, and <code>V</code>.</p>
</td></tr>
<tr><td><code id="em_function_2stage_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcomes, <code>Y*</code> and <code class="reqn">\tilde{Y}</code>, can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>em_function_2stage</code> returns a numeric vector of updated parameter
estimates from one iteration of the EM-algorithm.
</p>

<hr>
<h2 id='expit'>Expit function</h2><span id='topic+expit'></span>

<h3>Description</h3>

<p><code class="reqn">\frac{\exp\{x\}}{1 + \exp\{x\}}</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expit(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expit_+3A_x">x</code></td>
<td>
<p>A numeric value or vector to compute the expit function on.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>expit</code> returns the result of the function
<code class="reqn">f(x) = \frac{\exp\{x\}}{1 + \exp\{x\}}</code> for a given <code>x</code>.
</p>

<hr>
<h2 id='jags_picker'>Set up a Binary Outcome Misclassification <code>jags.model</code> Object for a Given Prior</h2><span id='topic+jags_picker'></span>

<h3>Description</h3>

<p>Set up a Binary Outcome Misclassification <code>jags.model</code> Object for a Given Prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jags_picker(
  prior,
  sample_size,
  dim_x,
  dim_z,
  n_cat,
  Ystar,
  X,
  Z,
  beta_prior_parameters,
  gamma_prior_parameters,
  number_MCMC_chains,
  model_file,
  display_progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jags_picker_+3A_prior">prior</code></td>
<td>
<p>A character string specifying the prior distribution for the
<code class="reqn">\beta</code> and <code class="reqn">\gamma</code> parameters. Options are <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code> (double Exponential, or Weibull).</p>
</td></tr>
<tr><td><code id="jags_picker_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.</p>
</td></tr>
<tr><td><code id="jags_picker_+3A_dim_x">dim_x</code></td>
<td>
<p>An integer specifying the number of columns of the design matrix of the true outcome mechanism, <code>X</code>.</p>
</td></tr>
<tr><td><code id="jags_picker_+3A_dim_z">dim_z</code></td>
<td>
<p>An integer specifying the number of columns of the design matrix of the observation mechanism, <code>Z</code>.</p>
</td></tr>
<tr><td><code id="jags_picker_+3A_n_cat">n_cat</code></td>
<td>
<p>An integer specifying the number of categorical values that the true outcome, <code>Y</code>,
and the observed outcome, <code>Y*</code> can take.</p>
</td></tr>
<tr><td><code id="jags_picker_+3A_ystar">Ystar</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the observed
outcome <code>Y*</code>. The reference category is 2.</p>
</td></tr>
<tr><td><code id="jags_picker_+3A_x">X</code></td>
<td>
<p>A numeric design matrix for the true outcome mechanism.</p>
</td></tr>
<tr><td><code id="jags_picker_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix for the observation mechanism.</p>
</td></tr>
<tr><td><code id="jags_picker_+3A_beta_prior_parameters">beta_prior_parameters</code></td>
<td>
<p>A numeric list of prior distribution parameters
for the <code class="reqn">\beta</code> terms. For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the first element of the
list should contain a matrix of location, lower bound, mean, or shape parameters,
respectively, for <code class="reqn">\beta</code> terms.
For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the second element of the
list should contain a matrix of shape, upper bound, standard deviation, or scale parameters,
respectively, for <code class="reqn">\beta</code> terms.
For prior distribution <code>"t"</code>, the third element of the list should contain
a matrix of the degrees of freedom for <code class="reqn">\beta</code> terms.
The third list element should be empty for all other prior distributions.
All matrices in the list should have dimensions <code>dim_x</code> X <code>n_cat</code>, and all
elements in the <code>n_cat</code> column should be set to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="jags_picker_+3A_gamma_prior_parameters">gamma_prior_parameters</code></td>
<td>
<p>A numeric list of prior distribution parameters
for the <code class="reqn">\gamma</code> terms. For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the first element of the
list should contain an array of location, lower bound, mean, or shape parameters,
respectively, for <code class="reqn">\gamma</code> terms.
For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the second element of the
list should contain an array of shape, upper bound, standard deviation, or scale parameters,
respectively, for <code class="reqn">\gamma</code> terms.
For prior distribution <code>"t"</code>, the third element of the list should contain
an array of the degrees of freedom for <code class="reqn">\gamma</code> terms.
The third list element should be empty for all other prior distributions.
All arrays in the list should have dimensions <code>n_cat</code> X <code>n_cat</code> X <code>dim_z</code>,
and all elements in the <code>n_cat</code> row should be set to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="jags_picker_+3A_number_mcmc_chains">number_MCMC_chains</code></td>
<td>
<p>An integer specifying the number of MCMC chains to compute.</p>
</td></tr>
<tr><td><code id="jags_picker_+3A_model_file">model_file</code></td>
<td>
<p>A .BUG file and used
for MCMC estimation with <code>rjags</code>.</p>
</td></tr>
<tr><td><code id="jags_picker_+3A_display_progress">display_progress</code></td>
<td>
<p>A logical value specifying whether messages should be
displayed during model compilation. The default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>jags_picker</code> returns a <code>jags.model</code> object for a binary
outcome misclassification model. The object includes the specified
prior distribution, model, number of chains, and data.
</p>

<hr>
<h2 id='jags_picker_2stage'>Set up a Two-Stage Binary Outcome Misclassification <code>jags.model</code> Object for a Given Prior</h2><span id='topic+jags_picker_2stage'></span>

<h3>Description</h3>

<p>Set up a Two-Stage Binary Outcome Misclassification <code>jags.model</code> Object for a Given Prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jags_picker_2stage(
  prior,
  sample_size,
  dim_x,
  dim_z,
  dim_v,
  n_cat,
  Ystar,
  Ytilde,
  X,
  Z,
  V,
  beta_prior_parameters,
  gamma_prior_parameters,
  delta_prior_parameters,
  number_MCMC_chains,
  model_file,
  display_progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jags_picker_2stage_+3A_prior">prior</code></td>
<td>
<p>A character string specifying the prior distribution for the
<code class="reqn">\beta</code>, <code class="reqn">\gamma</code>, and <code class="reqn">\delta</code> parameters. Options are <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code> (double Exponential, or Weibull).</p>
</td></tr>
<tr><td><code id="jags_picker_2stage_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.</p>
</td></tr>
<tr><td><code id="jags_picker_2stage_+3A_dim_x">dim_x</code></td>
<td>
<p>An integer specifying the number of columns of the design matrix of the true outcome mechanism, <code>X</code>.</p>
</td></tr>
<tr><td><code id="jags_picker_2stage_+3A_dim_z">dim_z</code></td>
<td>
<p>An integer specifying the number of columns of the design matrix of the first-stage observation mechanism, <code>Z</code>.</p>
</td></tr>
<tr><td><code id="jags_picker_2stage_+3A_dim_v">dim_v</code></td>
<td>
<p>An integer specifying the number of columns of the design matrix of the second-stage observation mechanism, <code>V</code>.</p>
</td></tr>
<tr><td><code id="jags_picker_2stage_+3A_n_cat">n_cat</code></td>
<td>
<p>An integer specifying the number of categorical values that the true outcome, <code>Y</code>,
and the observed outcomes, <code class="reqn">Y^*</code> and <code class="reqn">\tilde{Y}</code>, can take.</p>
</td></tr>
<tr><td><code id="jags_picker_2stage_+3A_ystar">Ystar</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the first-stage observed
outcome <code>Y*</code>. The reference category is 2.</p>
</td></tr>
<tr><td><code id="jags_picker_2stage_+3A_ytilde">Ytilde</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the second-stage observed
outcome <code class="reqn">\tilde{Y}</code>. The reference category is 2.</p>
</td></tr>
<tr><td><code id="jags_picker_2stage_+3A_x">X</code></td>
<td>
<p>A numeric design matrix for the true outcome mechanism.</p>
</td></tr>
<tr><td><code id="jags_picker_2stage_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix for the first-stage observation mechanism.</p>
</td></tr>
<tr><td><code id="jags_picker_2stage_+3A_v">V</code></td>
<td>
<p>A numeric design matrix for the second-stage observation mechanism.</p>
</td></tr>
<tr><td><code id="jags_picker_2stage_+3A_beta_prior_parameters">beta_prior_parameters</code></td>
<td>
<p>A numeric list of prior distribution parameters
for the <code class="reqn">\beta</code> terms. For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the first element of the
list should contain a matrix of location, lower bound, mean, or shape parameters,
respectively, for <code class="reqn">\beta</code> terms.
For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the second element of the
list should contain a matrix of shape, upper bound, standard deviation, or scale parameters,
respectively, for <code class="reqn">\beta</code> terms.
For prior distribution <code>"t"</code>, the third element of the list should contain
a matrix of the degrees of freedom for <code class="reqn">\beta</code> terms.
The third list element should be empty for all other prior distributions.
All matrices in the list should have dimensions <code>dim_x</code> X <code>n_cat</code>, and all
elements in the <code>n_cat</code> column should be set to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="jags_picker_2stage_+3A_gamma_prior_parameters">gamma_prior_parameters</code></td>
<td>
<p>A numeric list of prior distribution parameters
for the <code class="reqn">\gamma</code> terms. For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the first element of the
list should contain an array of location, lower bound, mean, or shape parameters,
respectively, for <code class="reqn">\gamma</code> terms.
For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the second element of the
list should contain an array of shape, upper bound, standard deviation, or scale parameters,
respectively, for <code class="reqn">\gamma</code> terms.
For prior distribution <code>"t"</code>, the third element of the list should contain
an array of the degrees of freedom for <code class="reqn">\gamma</code> terms.
The third list element should be empty for all other prior distributions.
All arrays in the list should have dimensions <code>n_cat</code> X <code>n_cat</code> X <code>dim_z</code>,
and all elements in the <code>n_cat</code> row should be set to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="jags_picker_2stage_+3A_delta_prior_parameters">delta_prior_parameters</code></td>
<td>
<p>A numeric list of prior distribution parameters
for the <code class="reqn">\delta</code> terms. For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the first element of the
list should contain an array of location, lower bound, mean, or shape parameters,
respectively, for <code class="reqn">\delta</code> terms.
For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the second element of the
list should contain an array of shape, upper bound, standard deviation, or scale parameters,
respectively, for <code class="reqn">\delta</code> terms.
For prior distribution <code>"t"</code>, the third element of the list should contain
an array of the degrees of freedom for <code class="reqn">\delta</code> terms.
The third list element should be empty for all other prior distributions.
All arrays in the list should have dimensions <code>n_cat</code> X <code>n_cat</code> X <code>n_cat</code> X <code>dim_v</code>,
and all elements in the <code>n_cat</code> row should be set to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="jags_picker_2stage_+3A_number_mcmc_chains">number_MCMC_chains</code></td>
<td>
<p>An integer specifying the number of MCMC chains to compute.</p>
</td></tr>
<tr><td><code id="jags_picker_2stage_+3A_model_file">model_file</code></td>
<td>
<p>A .BUG file and used
for MCMC estimation with <code>rjags</code>.</p>
</td></tr>
<tr><td><code id="jags_picker_2stage_+3A_display_progress">display_progress</code></td>
<td>
<p>A logical value specifying whether messages should be
displayed during model compilation. The default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>jags_picker</code> returns a <code>jags.model</code> object for a two-stage binary
outcome misclassification model. The object includes the specified
prior distribution, model, number of chains, and data.
</p>

<hr>
<h2 id='label_switch'>Fix Label Switching in MCMC Results from a Binary Outcome Misclassification Model</h2><span id='topic+label_switch'></span>

<h3>Description</h3>

<p>Fix Label Switching in MCMC Results from a Binary Outcome Misclassification Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>label_switch(chain_matrix, dim_x, dim_z, n_cat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="label_switch_+3A_chain_matrix">chain_matrix</code></td>
<td>
<p>A numeric matrix containing the posterior samples for all
parameters in a given MCMC chain. <code>chain_matrix</code> must be a named
object (i.e. each parameter must be named as <code>beta[j, p]</code> or <code>gamma[k,j,p]</code>).</p>
</td></tr>
<tr><td><code id="label_switch_+3A_dim_x">dim_x</code></td>
<td>
<p>An integer specifying the number of columns of the design matrix of the true outcome mechanism, <code>X</code>.</p>
</td></tr>
<tr><td><code id="label_switch_+3A_dim_z">dim_z</code></td>
<td>
<p>An integer specifying the number of columns of the design matrix of the observation mechanism, <code>Z</code>.</p>
</td></tr>
<tr><td><code id="label_switch_+3A_n_cat">n_cat</code></td>
<td>
<p>An integer specifying the number of categorical values that the true outcome, <code>Y</code>,
and the observed outcome, <code>Y*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>label_switch</code> returns a named matrix of MCMC posterior samples for
all parameters after performing label switching according the following pattern:
all <code class="reqn">\beta</code> terms are multiplied by -1, all <code class="reqn">\gamma</code> terms are &quot;swapped&quot;
with the opposite <code>j</code> index.
</p>

<hr>
<h2 id='label_switch_2stage'>Fix Label Switching in MCMC Results from a Binary Outcome Misclassification Model</h2><span id='topic+label_switch_2stage'></span>

<h3>Description</h3>

<p>Fix Label Switching in MCMC Results from a Binary Outcome Misclassification Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>label_switch_2stage(chain_matrix, dim_x, dim_z, dim_v, n_cat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="label_switch_2stage_+3A_chain_matrix">chain_matrix</code></td>
<td>
<p>A numeric matrix containing the posterior samples for all
parameters in a given MCMC chain. <code>chain_matrix</code> must be a named
object (i.e. each parameter must be named as <code>beta[j, p]</code>, <code>gamma[k,j,p]</code>,
or <code>delta[l,k,j,p]</code>).</p>
</td></tr>
<tr><td><code id="label_switch_2stage_+3A_dim_x">dim_x</code></td>
<td>
<p>An integer specifying the number of columns of the design matrix of the true outcome mechanism, <code>X</code>.</p>
</td></tr>
<tr><td><code id="label_switch_2stage_+3A_dim_z">dim_z</code></td>
<td>
<p>An integer specifying the number of columns of the design matrix of the first-stage observation mechanism, <code>Z</code>.</p>
</td></tr>
<tr><td><code id="label_switch_2stage_+3A_dim_v">dim_v</code></td>
<td>
<p>An integer specifying the number of columns of the design matrix of the second-stage observation mechanism, <code>V</code>.</p>
</td></tr>
<tr><td><code id="label_switch_2stage_+3A_n_cat">n_cat</code></td>
<td>
<p>An integer specifying the number of categorical values that the true outcome, <code class="reqn">Y</code>,
the first-stage observed outcome, <code class="reqn">Y^*</code>, and the second-stage observed
outcome <code class="reqn">\tilde{Y}</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>label_switch_2stage</code> returns a named matrix of MCMC posterior samples for
all parameters after performing label switching according the following pattern:
all <code class="reqn">\beta</code> terms are multiplied by -1, all <code class="reqn">\gamma</code> and <code class="reqn">\delta</code> terms are &quot;swapped&quot;
with the opposite <code>j</code> index.
</p>

<hr>
<h2 id='loglik'>Expected Complete Data Log-Likelihood Function for Estimation of the Misclassification Model</h2><span id='topic+loglik'></span>

<h3>Description</h3>

<p>Expected Complete Data Log-Likelihood Function for Estimation of the Misclassification Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik(param_current, obs_Y_matrix, X, Z, sample_size, n_cat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglik_+3A_param_current">param_current</code></td>
<td>
<p>A numeric vector of regression parameters, in the order
<code class="reqn">\beta, \gamma</code>. The <code class="reqn">\gamma</code> vector is obtained from the matrix form.
In matrix form, the gamma parameter matrix rows
correspond to parameters for the <code>Y* = 1</code>
observed outcome, with the dimensions of <code>Z</code>.
In matrix form, the gamma parameter matrix columns correspond to the true outcome categories
<code class="reqn">j = 1, \dots,</code> <code>n_cat</code>. The numeric vector <code>gamma_v</code> is
obtained by concatenating the gamma matrix, i.e. <code>gamma_v &lt;- c(gamma_matrix)</code>.</p>
</td></tr>
<tr><td><code id="loglik_+3A_obs_y_matrix">obs_Y_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the observed
outcome <code>Y*</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="loglik_+3A_x">X</code></td>
<td>
<p>A numeric design matrix for the true outcome mechanism.</p>
</td></tr>
<tr><td><code id="loglik_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix for the observation mechanism.</p>
</td></tr>
<tr><td><code id="loglik_+3A_sample_size">sample_size</code></td>
<td>
<p>Integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>X</code> or <code>Z</code>.</p>
</td></tr>
<tr><td><code id="loglik_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcome, <code>Y*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>loglik</code> returns the negative value of the expected log-likelihood function,
<code class="reqn"> Q = \sum_{i = 1}^N \Bigl[ \sum_{j = 1}^2 w_{ij} \text{log} \{ \pi_{ij} \} + \sum_{j = 1}^2 \sum_{k = 1}^2 w_{ij} y^*_{ik} \text{log} \{ \pi^*_{ikj} \}\Bigr]</code>,
at the provided inputs.
</p>

<hr>
<h2 id='loglik_2stage'>Expected Complete Data Log-Likelihood Function for Estimation of the Two-Stage Misclassification Model</h2><span id='topic+loglik_2stage'></span>

<h3>Description</h3>

<p>Expected Complete Data Log-Likelihood Function for Estimation of the Two-Stage Misclassification Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik_2stage(
  param_current,
  obs_Ystar_matrix,
  obs_Ytilde_matrix,
  X,
  Z,
  V,
  sample_size,
  n_cat
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglik_2stage_+3A_param_current">param_current</code></td>
<td>
<p>A numeric vector of regression parameters, in the order
<code class="reqn">\beta, \gamma, \delta</code>. The <code class="reqn">\gamma</code> vector is obtained from the matrix form.
In matrix form, the gamma parameter matrix rows
correspond to parameters for the <code>Y* = 1</code>
observed outcome, with the dimensions of <code>Z</code>.
In matrix form, the gamma parameter matrix columns correspond to the true outcome categories
<code class="reqn">j = 1, \dots,</code> <code>n_cat</code>. The numeric vector <code class="reqn">\gamma</code> is
obtained by concatenating the gamma matrix, i.e. <code>gamma_v &lt;- c(gamma_matrix)</code>.
The <code class="reqn">\delta</code> vector is obtained from the array form. In array form,
the first dimension (matrix rows) of <code>delta</code>
corresponds to parameters for the <code class="reqn">\tilde{Y} = 1</code>
second-stage observed outcome, with the dimensions of the <code>V</code>
The second dimension (matrix columns) correspond to the first-stage
observed outcome categories <code class="reqn">Y^* \in \{1, 2\}</code>. The third dimension of
<code>delta_start</code> corresponds to to the true outcome categories
<code class="reqn">Y \in \{1, 2\}</code>. The numeric vector <code class="reqn">\delta</code> is obtained by
concatenating the delta array, i.e. <code>delta_vector &lt;- c(delta_array)</code>.</p>
</td></tr>
<tr><td><code id="loglik_2stage_+3A_obs_ystar_matrix">obs_Ystar_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the first-stage observed
outcome <code>Y*</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="loglik_2stage_+3A_obs_ytilde_matrix">obs_Ytilde_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the second-stage observed
outcome <code class="reqn">\tilde{Y}</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="loglik_2stage_+3A_x">X</code></td>
<td>
<p>A numeric design matrix for the true outcome mechanism.</p>
</td></tr>
<tr><td><code id="loglik_2stage_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix for the first-stage observation mechanism.</p>
</td></tr>
<tr><td><code id="loglik_2stage_+3A_v">V</code></td>
<td>
<p>A numeric design matrix for the second-stage observation mechanism.</p>
</td></tr>
<tr><td><code id="loglik_2stage_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrices, <code>X</code>, <code>Z</code>, and <code>V</code>.</p>
</td></tr>
<tr><td><code id="loglik_2stage_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcomes, <code>Y*</code> and <code class="reqn">\tilde{Y}</code>, can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>loglik_2stage</code> returns the negative value of the expected log-likelihood function,
<code class="reqn"> Q = \sum_{i = 1}^N \Bigl[ \sum_{j = 1}^2 w_{ij} \text{log} \{ \pi_{ij} \} + \sum_{j = 1}^2 \sum_{k = 1}^2 w_{ij} y^*_{ik} \text{log} \{ \pi^*_{ikj} \} +
  \sum_{j = 1}^2 \sum_{k = 1}^2 \sum_{\ell = 1}^2 w_{ij} y^*_{ik} \tilde{y}_{i \ell} \text{log} \{ \tilde{\pi}_{i \ell kj} \}\Bigr]</code>,
at the provided inputs.
</p>

<hr>
<h2 id='LSAC_data'>Example data from The Law School Admissions Council's (LSAC) National Bar Passage Study (Linda Wightman, 1998)</h2><span id='topic+LSAC_data'></span>

<h3>Description</h3>

<p>Example data from The Law School Admissions Council's (LSAC) National Bar Passage Study (Linda Wightman, 1998)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LSAC_data
</code></pre>


<h3>Format</h3>

<p>A dataframe 39 columns, including background and demographic information, as well
as if the candidates passed the bar exam to become lawyers in the USA.
</p>


<h3>Source</h3>

<p><a href="https://www.kaggle.com/datasets/danofer/law-school-admissions-bar-passage/data?select=bar_pass_prediction.csv">https://www.kaggle.com/datasets/danofer/law-school-admissions-bar-passage/data?select=bar_pass_prediction.csv</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("LSAC_data")
head(LSAC_data)

## End(Not run)
</code></pre>

<hr>
<h2 id='mean_pistarjj_compute'>Compute the Mean Conditional Probability of Correct Classification, by True Outcome Across all Subjects</h2><span id='topic+mean_pistarjj_compute'></span>

<h3>Description</h3>

<p>Compute the Mean Conditional Probability of Correct Classification, by True Outcome Across all Subjects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mean_pistarjj_compute(pistar_matrix, j, sample_size)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mean_pistarjj_compute_+3A_pistar_matrix">pistar_matrix</code></td>
<td>
<p>A numeric matrix of conditional probabilities obtained from
the internal function <code>pistar_compute_for_chains</code>. Rows of the matrix correspond to
each subject and to each observed outcome category. Columns of the matrix
correspond to each true, latent outcome category.</p>
</td></tr>
<tr><td><code id="mean_pistarjj_compute_+3A_j">j</code></td>
<td>
<p>An integer value representing the true outcome category to compute
the average conditional probability of correct classification for.
<code>j</code> can take on values <code>1</code> and <code>2</code>.</p>
</td></tr>
<tr><td><code id="mean_pistarjj_compute_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mean_pistarjj_compute</code> returns a numeric value equal to the average
conditional probability <code class="reqn">P(Y^* = j | Y = j, Z)</code> across all subjects.
</p>

<hr>
<h2 id='misclassification_prob'>Compute Conditional Probability of Each Observed Outcome Given Each True Outcome, for Every Subject</h2><span id='topic+misclassification_prob'></span>

<h3>Description</h3>

<p>Compute the conditional probability of observing outcome <code class="reqn">Y^* \in \{1, 2 \}</code> given
the latent true outcome <code class="reqn">Y \in \{1, 2 \}</code> as
<code class="reqn">\frac{\text{exp}\{\gamma_{kj0} + \gamma_{kjZ} Z_i\}}{1 + \text{exp}\{\gamma_{kj0} + \gamma_{kjZ} Z_i\}}</code>
for each of the <code class="reqn">i = 1, \dots,</code> <code>n</code> subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>misclassification_prob(gamma_matrix, z_matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="misclassification_prob_+3A_gamma_matrix">gamma_matrix</code></td>
<td>
<p>A numeric matrix of estimated regression parameters for the
observation mechanism, <code>Y* | Y</code> (observed outcome, given the true outcome)
~ <code>Z</code> (misclassification predictor matrix). Rows of the matrix
correspond to parameters for the <code>Y* = 1</code> observed outcome, with the
dimensions of <code>z_matrix</code>. Columns of the matrix correspond to the true
outcome categories <code class="reqn">j = 1, \dots,</code> <code>n_cat</code>. The matrix should be
obtained by <code>COMBO_EM</code> or <code>COMBO_MCMC</code>.</p>
</td></tr>
<tr><td><code id="misclassification_prob_+3A_z_matrix">z_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the observation mechanism.
<code>z_matrix</code> should not contain an intercept.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>misclassification_prob</code> returns a dataframe containing four columns.
The first column, <code>Subject</code>, represents the subject ID, from <code class="reqn">1</code> to <code>n</code>,
where <code>n</code> is the sample size, or equivalently, the number of rows in <code>z_matrix</code>.
The second column, <code>Y</code>, represents a true, latent outcome category <code class="reqn">Y \in \{1, 2 \}</code>.
The third column, <code>Ystar</code>, represents an observed outcome category <code class="reqn">Y^* \in \{1, 2 \}</code>.
The last column, <code>Probability</code>, is the value of the equation
<code class="reqn">\frac{\text{exp}\{\gamma_{kj0} + \gamma_{kjZ} Z_i\}}{1 + \text{exp}\{\gamma_{kj0} + \gamma_{kjZ} Z_i\}}</code>
computed for each subject, observed outcome category, and true, latent outcome category.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
sample_size &lt;- 1000
cov1 &lt;- rnorm(sample_size)
cov2 &lt;- rnorm(sample_size, 1, 2)
z_matrix &lt;- matrix(c(cov1, cov2), nrow = sample_size, byrow = FALSE)
estimated_gammas &lt;- matrix(c(1, -1, .5, .2, -.6, 1.5), ncol = 2)
P_Ystar_Y &lt;- misclassification_prob(estimated_gammas, z_matrix)
head(P_Ystar_Y)
</code></pre>

<hr>
<h2 id='misclassification_prob2'>Compute Conditional Probability of Each Second-Stage Observed Outcome Given Each True Outcome and First-Stage Observed Outcome, for Every Subject</h2><span id='topic+misclassification_prob2'></span>

<h3>Description</h3>

<p>Compute the conditional probability of observing second-stage outcome <code class="reqn">Y^{*(2)} \in \{1, 2 \}</code> given
the latent true outcome <code class="reqn">Y \in \{1, 2 \}</code> and the first-stage outcome <code class="reqn">Y^{*(1)} \in \{1, 2\}</code> as
<code class="reqn">\frac{\text{exp}\{\gamma^{(2)}_{\ell kj0} + \gamma^{(2)}_{\ell kjZ^{(2)}} Z^{(2)}\}}{1 + \text{exp}\{\gamma^{(2)}_{\ell kj0} + \gamma^{(2)}_{\ell kjZ^{(2)}} Z^{(2)}_i\}}</code>
for each of the <code class="reqn">i = 1, \dots,</code> <code class="reqn">n</code> subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>misclassification_prob2(gamma2_array, z2_matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="misclassification_prob2_+3A_gamma2_array">gamma2_array</code></td>
<td>
<p>A numeric array of estimated regression parameters for the
observation mechanism, <code class="reqn">Y^{*(2)}| Y^{*(1)}, Y</code> (second-stage observed outcome,
given the first-stage observed outcome and the true outcome)
~ <code class="reqn">Z^{(2)}</code> (second-stage misclassification predictor matrix). Rows of the array
correspond to parameters for the <code class="reqn">Y^{*(2)} = 1</code> observed outcome, with the
dimensions of <code>z2_matrix</code>. Columns of the array correspond to the first-stage
outcome categories <code class="reqn">k = 1, \dots,</code> <code>n_cat</code>. The third stage of the array
corresponds to the true outcome categories <code class="reqn">j = 1, \dots,</code> <code>n_cat</code>.
The array should be obtained by <code>COMBO_EM</code> or <code>COMBO_MCMC</code>.</p>
</td></tr>
<tr><td><code id="misclassification_prob2_+3A_z2_matrix">z2_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the second-stage observation mechanism.
<code>z2_matrix</code> should not contain an intercept.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>misclassification_prob2</code> returns a dataframe containing five columns.
The first column, <code>Subject</code>, represents the subject ID, from <code class="reqn">1</code> to <code>n</code>,
where <code>n</code> is the sample size, or equivalently, the number of rows in <code>z2_matrix</code>.
The second column, <code>Y</code>, represents a true, latent outcome category <code class="reqn">Y \in \{1, 2 \}</code>.
The third column, <code>Ystar1</code>, represents a first-stage observed outcome category <code class="reqn">Y^{*(1)} \in \{1, 2 \}</code>.
The fourth column, <code>Ystar2</code>, represents a second-stage observed outcome category <code class="reqn">Y^{*(2)}  \in \{1, 2 \}</code>.
The last column, <code>Probability</code>, is the value of the equation
<code class="reqn">\frac{\text{exp}\{\gamma^{(2)}_{\ell kj0} + \gamma^{(2)}_{\ell kjZ^{(2)}} Z^{(2)}\}}{1 + \text{exp}\{\gamma^{(2)}_{\ell kj0} + \gamma^{(2)}_{\ell kjZ^{(2)}} Z^{(2)}_i\}}</code>
computed for each subject, first-stage observed outcome category, second-stage
observed outcome category, and true, latent outcome category.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
sample_size &lt;- 1000
cov1 &lt;- rnorm(sample_size)
cov2 &lt;- rnorm(sample_size, 1, 2)
z2_matrix &lt;- matrix(c(cov1, cov2), nrow = sample_size, byrow = FALSE)
estimated_gamma2 &lt;- array(c(1, -1, .5, .2, -.6, 1.5,
                            -1, .5, -1, -.5, -1, -.5), dim = c(3,2,2))
P_Ystar2_Ystar1_Y &lt;- misclassification_prob2(estimated_gamma2, z2_matrix)
head(P_Ystar2_Ystar1_Y)
</code></pre>

<hr>
<h2 id='model_picker'>Select a Binary Outcome Misclassification Model for a Given Prior</h2><span id='topic+model_picker'></span>

<h3>Description</h3>

<p>Select a Binary Outcome Misclassification Model for a Given Prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_picker(prior)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_picker_+3A_prior">prior</code></td>
<td>
<p>A character string specifying the prior distribution for the
<code class="reqn">\beta</code> and <code class="reqn">\gamma</code> parameters. Options are <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code> (double Exponential, or Weibull).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>model_picker</code> returns a character string specifying the binary
outcome misclassification model to be turned into a .BUG file and used
for MCMC estimation with <code>rjags</code>.
</p>

<hr>
<h2 id='model_picker_2stage'>Select a Two-Stage Binary Outcome Misclassification Model for a Given Prior</h2><span id='topic+model_picker_2stage'></span>

<h3>Description</h3>

<p>Select a Two-Stage Binary Outcome Misclassification Model for a Given Prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_picker_2stage(prior)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_picker_2stage_+3A_prior">prior</code></td>
<td>
<p>A character string specifying the prior distribution for the
<code class="reqn">\beta</code>, <code class="reqn">\gamma</code>, and <code class="reqn">\delta</code> parameters. Options are <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code> (double Exponential, or Weibull).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>model_picker</code> returns a character string specifying the two-stage binary
outcome misclassification model to be turned into a .BUG file and used
for MCMC estimation with <code>rjags</code>.
</p>

<hr>
<h2 id='naive_jags_picker'>Set up a Naive Logistic Regression <code>jags.model</code> Object for a Given Prior</h2><span id='topic+naive_jags_picker'></span>

<h3>Description</h3>

<p>Set up a Naive Logistic Regression <code>jags.model</code> Object for a Given Prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>naive_jags_picker(
  prior,
  sample_size,
  dim_x,
  n_cat,
  Ystar,
  X,
  beta_prior_parameters,
  number_MCMC_chains,
  naive_model_file,
  display_progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="naive_jags_picker_+3A_prior">prior</code></td>
<td>
<p>character string specifying the prior distribution for the naive
<code class="reqn">\beta</code> parameters. Options are <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code> (double Exponential, or Weibull).</p>
</td></tr>
<tr><td><code id="naive_jags_picker_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_+3A_dim_x">dim_x</code></td>
<td>
<p>An integer specifying the number of columns of the design matrix of the true outcome mechanism, <code>X</code>.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_+3A_n_cat">n_cat</code></td>
<td>
<p>An integer specifying the number of categorical values that the true outcome, <code>Y</code>,
and the observed outcome, <code>Y*</code> can take.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_+3A_ystar">Ystar</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the observed
outcome <code>Y*</code>. The reference category is 2.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_+3A_x">X</code></td>
<td>
<p>A numeric design matrix for the true outcome mechanism.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_+3A_beta_prior_parameters">beta_prior_parameters</code></td>
<td>
<p>A numeric list of prior distribution parameters
for the <code class="reqn">\beta</code> terms. For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the first element of the
list should contain a matrix of location, lower bound, mean, or shape parameters,
respectively, for <code class="reqn">\beta</code> terms.
For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the second element of the
list should contain a matrix of shape, upper bound, standard deviation, or scale parameters,
respectively, for <code class="reqn">\beta</code> terms.
For prior distribution <code>"t"</code>, the third element of the list should contain
a matrix of the degrees of freedom for <code class="reqn">\beta</code> terms.
The third list element should be empty for all other prior distributions.
All matrices in the list should have dimensions <code>dim_x</code> X <code>n_cat</code>, and all
elements in the <code>n_cat</code> column should be set to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_+3A_number_mcmc_chains">number_MCMC_chains</code></td>
<td>
<p>An integer specifying the number of MCMC chains to compute.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_+3A_naive_model_file">naive_model_file</code></td>
<td>
<p>A .BUG file and used
for MCMC estimation with <code>rjags</code>.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_+3A_display_progress">display_progress</code></td>
<td>
<p>A logical value specifying whether messages should be
displayed during model compilation. The default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>naive_jags_picker</code> returns a <code>jags.model</code> object for a naive
logistic regression model predicting the potentially misclassified <code>Y*</code>
from the predictor matrix <code>x</code>. The object includes the specified
prior distribution, model, number of chains, and data.
</p>

<hr>
<h2 id='naive_jags_picker_2stage'>Set up a Naive Two-Stage Regression <code>jags.model</code> Object for a Given Prior</h2><span id='topic+naive_jags_picker_2stage'></span>

<h3>Description</h3>

<p>Set up a Naive Two-Stage Regression <code>jags.model</code> Object for a Given Prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>naive_jags_picker_2stage(
  prior,
  sample_size,
  dim_x,
  dim_v,
  n_cat,
  Ystar,
  Ytilde,
  X,
  V,
  beta_prior_parameters,
  delta_prior_parameters,
  number_MCMC_chains,
  naive_model_file,
  display_progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="naive_jags_picker_2stage_+3A_prior">prior</code></td>
<td>
<p>character string specifying the prior distribution for the naive
<code class="reqn">\beta</code> parameters. Options are <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code> (double Exponential, or Weibull).</p>
</td></tr>
<tr><td><code id="naive_jags_picker_2stage_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_2stage_+3A_dim_x">dim_x</code></td>
<td>
<p>An integer specifying the number of columns of the design matrix of the first-stage outcome mechanism, <code>X</code>.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_2stage_+3A_dim_v">dim_v</code></td>
<td>
<p>An integer specifying the number of columns of the design matrix of the second-stage outcome mechanism, <code>V</code>.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_2stage_+3A_n_cat">n_cat</code></td>
<td>
<p>An integer specifying the number of categorical values that
the observed outcomes can take.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_2stage_+3A_ystar">Ystar</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the first-stage observed
outcome <code>Y*</code>. The reference category is 2.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_2stage_+3A_ytilde">Ytilde</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the second-stage observed
outcome <code class="reqn">\tilde{Y}</code>. The reference category is 2.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_2stage_+3A_x">X</code></td>
<td>
<p>A numeric design matrix for the true outcome mechanism.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_2stage_+3A_v">V</code></td>
<td>
<p>A numeric design matrix for the second-stage outcome mechanism.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_2stage_+3A_beta_prior_parameters">beta_prior_parameters</code></td>
<td>
<p>A numeric list of prior distribution parameters
for the <code class="reqn">\beta</code> terms. For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the first element of the
list should contain a matrix of location, lower bound, mean, or shape parameters,
respectively, for <code class="reqn">\beta</code> terms.
For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the second element of the
list should contain a matrix of shape, upper bound, standard deviation, or scale parameters,
respectively, for <code class="reqn">\beta</code> terms.
For prior distribution <code>"t"</code>, the third element of the list should contain
a matrix of the degrees of freedom for <code class="reqn">\beta</code> terms.
The third list element should be empty for all other prior distributions.
All matrices in the list should have dimensions <code>dim_x</code> X <code>n_cat</code>, and all
elements in the <code>n_cat</code> column should be set to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_2stage_+3A_delta_prior_parameters">delta_prior_parameters</code></td>
<td>
<p>A numeric list of prior distribution parameters
for the naive <code class="reqn">\delta</code> terms. For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the first element of the
list should contain an array of location, lower bound, mean, or shape parameters,
respectively, for <code class="reqn">\delta</code> terms.
For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the second element of the
list should contain an array of shape, upper bound, standard deviation, or scale parameters,
respectively, for <code class="reqn">\delta</code> terms.
For prior distribution <code>"t"</code>, the third element of the list should contain
an array of the degrees of freedom for <code class="reqn">\delta</code> terms.
The third list element should be empty for all other prior distributions.
All arrays in the list should have dimensions <code>n_cat</code> X <code>n_cat</code> X <code>dim_v</code>,
and all elements in the <code>n_cat</code> row should be set to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_2stage_+3A_number_mcmc_chains">number_MCMC_chains</code></td>
<td>
<p>An integer specifying the number of MCMC chains to compute.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_2stage_+3A_naive_model_file">naive_model_file</code></td>
<td>
<p>A .BUG file and used
for MCMC estimation with <code>rjags</code>.</p>
</td></tr>
<tr><td><code id="naive_jags_picker_2stage_+3A_display_progress">display_progress</code></td>
<td>
<p>A logical value specifying whether messages should be
displayed during model compilation. The default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>naive_jags_picker_2stage</code> returns a <code>jags.model</code> object for a naive
two-stage regression model predicting the potentially misclassified <code>Y*</code>
from the predictor matrix <code>x</code> and the potentially misclassified <code class="reqn">\tilde{Y} | Y^*</code>
from the predictor matrix <code>v</code>. The object includes the specified
prior distribution, model, number of chains, and data.
</p>

<hr>
<h2 id='naive_loglik_2stage'>Observed Data Log-Likelihood Function for Estimation of the Naive Two-Stage Misclassification Model</h2><span id='topic+naive_loglik_2stage'></span>

<h3>Description</h3>

<p>Observed Data Log-Likelihood Function for Estimation of the Naive Two-Stage Misclassification Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>naive_loglik_2stage(
  param_current,
  X,
  V,
  obs_Ystar_matrix,
  obs_Ytilde_matrix,
  sample_size,
  n_cat
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="naive_loglik_2stage_+3A_param_current">param_current</code></td>
<td>
<p>A numeric vector of regression parameters, in the order
<code class="reqn">\beta, \delta</code>. The <code class="reqn">\delta</code> vector is obtained from the matrix form.
In matrix form, the gamma parameter matrix rows
correspond to parameters for the <code class="reqn">\tilde{Y} = 1</code>
observed outcome, with the dimensions of <code>V</code>.
In matrix form, the gamma parameter matrix columns correspond to the true outcome categories
<code class="reqn">j = 1, \dots,</code> <code>n_cat</code>. The numeric vector <code>delta_v</code> is
obtained by concatenating the delta matrix, i.e. <code>delta_v &lt;- c(delta_matrix)</code>.</p>
</td></tr>
<tr><td><code id="naive_loglik_2stage_+3A_x">X</code></td>
<td>
<p>A numeric design matrix for the first-stage observed mechanism.</p>
</td></tr>
<tr><td><code id="naive_loglik_2stage_+3A_v">V</code></td>
<td>
<p>A numeric design matrix for the second-stage observed mechanism.</p>
</td></tr>
<tr><td><code id="naive_loglik_2stage_+3A_obs_ystar_matrix">obs_Ystar_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the first-stage observed
outcome <code>Y*</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="naive_loglik_2stage_+3A_obs_ytilde_matrix">obs_Ytilde_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the second-stage observed
outcome <code class="reqn">\tilde{Y}</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="naive_loglik_2stage_+3A_sample_size">sample_size</code></td>
<td>
<p>Integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>X</code> or <code>V</code>.</p>
</td></tr>
<tr><td><code id="naive_loglik_2stage_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the first- and second-stage outcomes,
<code class="reqn">Y^*</code> and <code class="reqn">\tilde{Y}</code>, can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>naive_loglik_2stage</code> returns the negative value of the observed data log-likelihood function,
<code class="reqn"> \sum_{i = 1}^N \Bigl[ \sum_{k = 1}^2 \sum_{k = 1}^2 \sum_{\ell = 1}^2 y^*_{ik} \tilde{y_i} \text{log} \{ P(\tilde{Y}_{i} = \ell, Y^*_i = k | x_i, v_i) \}\Bigr]</code>,
at the provided inputs.
</p>

<hr>
<h2 id='naive_model_picker'>Select a Logisitic Regression Model for a Given Prior</h2><span id='topic+naive_model_picker'></span>

<h3>Description</h3>

<p>Select a Logisitic Regression Model for a Given Prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>naive_model_picker(prior)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="naive_model_picker_+3A_prior">prior</code></td>
<td>
<p>A character string specifying the prior distribution for the naive
<code class="reqn">\beta</code> parameters. Options are <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code> (double Exponential, or Weibull).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>naive_model_picker</code> returns a character string specifying the
logistic regression model to be turned into a .BUG file and used
for MCMC estimation with <code>rjags</code>.
</p>

<hr>
<h2 id='naive_model_picker_2stage'>Select a Naive Two-Stage Regression Model for a Given Prior</h2><span id='topic+naive_model_picker_2stage'></span>

<h3>Description</h3>

<p>Select a Naive Two-Stage Regression Model for a Given Prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>naive_model_picker_2stage(prior)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="naive_model_picker_2stage_+3A_prior">prior</code></td>
<td>
<p>A character string specifying the prior distribution for the naive
<code class="reqn">\beta</code> parameters. Options are <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code> (double Exponential, or Weibull).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>naive_model_picker_2stage</code> returns a character string specifying the
logistic regression model to be turned into a .BUG file and used
for MCMC estimation with <code>rjags</code>.
</p>

<hr>
<h2 id='perfect_sensitivity_EM'>EM-Algorithm Estimation of the Binary Outcome Misclassification Model while Assuming Perfect Sensitivity</h2><span id='topic+perfect_sensitivity_EM'></span>

<h3>Description</h3>

<p>Code is adapted by the SAMBA R package from Lauren Beesley and Bhramar Mukherjee.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perfect_sensitivity_EM(
  Ystar,
  Z,
  X,
  start,
  beta0_fixed = NULL,
  weights = NULL,
  expected = TRUE,
  tolerance = 1e-07,
  max_em_iterations = 1500
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perfect_sensitivity_EM_+3A_ystar">Ystar</code></td>
<td>
<p>A numeric vector of indicator variables (1, 0) for the observed
outcome <code>Y*</code>. The reference category is 0.</p>
</td></tr>
<tr><td><code id="perfect_sensitivity_EM_+3A_z">Z</code></td>
<td>
<p>A numeric matrix of covariates in the true outcome mechanism.
<code>Z</code> should not contain an intercept.</p>
</td></tr>
<tr><td><code id="perfect_sensitivity_EM_+3A_x">X</code></td>
<td>
<p>A numeric matrix of covariates in the observation mechanism.
<code>X</code> should not contain an intercept.</p>
</td></tr>
<tr><td><code id="perfect_sensitivity_EM_+3A_start">start</code></td>
<td>
<p>Numeric vector of starting values for parameters in the true
outcome mechanism (<code class="reqn">\theta</code>) and the observation mechanism (<code class="reqn">\beta</code>), respectively.</p>
</td></tr>
<tr><td><code id="perfect_sensitivity_EM_+3A_beta0_fixed">beta0_fixed</code></td>
<td>
<p>Optional numeric vector of values of the observation mechanism
intercept to profile over. If a single value is entered, this corresponds to
fixing the intercept at the specified value. The default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="perfect_sensitivity_EM_+3A_weights">weights</code></td>
<td>
<p>Optional vector of row-specific weights used for selection bias
adjustment. The default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="perfect_sensitivity_EM_+3A_expected">expected</code></td>
<td>
<p>A logical value indicating whether or not to calculate the
covariance matrix via the expected Fisher information matrix. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="perfect_sensitivity_EM_+3A_tolerance">tolerance</code></td>
<td>
<p>A numeric value specifying when to stop estimation, based on
the difference of subsequent log-likelihood estimates. The default is <code>1e-7</code>.</p>
</td></tr>
<tr><td><code id="perfect_sensitivity_EM_+3A_max_em_iterations">max_em_iterations</code></td>
<td>
<p>An integer specifying the maximum number of
iterations of the EM algorithm. The default is <code>1500</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>perfect_sensitivity_EM</code> returns a list containing nine elements.
The elements are detailed in <code>?SAMBA::obsloglikEM</code> documentation. Code
is adapted from the <code>SAMBA::obsloglikEM</code> function.
</p>


<h3>References</h3>

<p>Beesley, L. and Mukherjee, B. (2020).
Statistical inference for association studies using electronic health records:
Handling both selection bias and outcome misclassification.
Biometrics, 78, 214-226.
</p>

<hr>
<h2 id='pi_compute'>Compute Probability of Each True Outcome, for Every Subject</h2><span id='topic+pi_compute'></span>

<h3>Description</h3>

<p>Compute Probability of Each True Outcome, for Every Subject
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pi_compute(beta, X, n, n_cat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pi_compute_+3A_beta">beta</code></td>
<td>
<p>A numeric column matrix of regression parameters for the
<code>Y</code> (true outcome) ~ <code>X</code> (predictor matrix of interest).</p>
</td></tr>
<tr><td><code id="pi_compute_+3A_x">X</code></td>
<td>
<p>A numeric design matrix.</p>
</td></tr>
<tr><td><code id="pi_compute_+3A_n">n</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>X</code>.</p>
</td></tr>
<tr><td><code id="pi_compute_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>pi_compute</code> returns a matrix of probabilities,
<code class="reqn">P(Y_i = j | X_i) = \frac{\exp(X_i \beta)}{1 + \exp(X_i \beta)}</code>
for each of the <code class="reqn">i = 1, \dots,</code> <code>n</code> subjects. Rows of the matrix
correspond to each subject. Columns of the matrix correspond to the true outcome
categories <code class="reqn">j = 1, \dots,</code> <code>n_cat</code>.
</p>

<hr>
<h2 id='pistar_by_chain'>Compute the Mean Conditional Probability of Correct Classification, by True Outcome Across all Subjects for each MCMC Chain</h2><span id='topic+pistar_by_chain'></span>

<h3>Description</h3>

<p>Compute the Mean Conditional Probability of Correct Classification, by True Outcome Across all Subjects for each MCMC Chain
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pistar_by_chain(n_chains, chains_list, Z, n, n_cat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pistar_by_chain_+3A_n_chains">n_chains</code></td>
<td>
<p>An integer specifying the number of MCMC chains to compute over.</p>
</td></tr>
<tr><td><code id="pistar_by_chain_+3A_chains_list">chains_list</code></td>
<td>
<p>A numeric list containing the samples from <code>n_chains</code>
MCMC chains.</p>
</td></tr>
<tr><td><code id="pistar_by_chain_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix.</p>
</td></tr>
<tr><td><code id="pistar_by_chain_+3A_n">n</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>Z</code>.</p>
</td></tr>
<tr><td><code id="pistar_by_chain_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcome, <code>Y*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>pistar_by_chain</code> returns a numeric matrix of the average
conditional probability <code class="reqn">P(Y^* = j | Y = j, Z)</code> across all subjects for
each MCMC chain. Rows of the matrix correspond to MCMC chains, up to <code>n_chains</code>.
The first column contains the conditional probability <code class="reqn">P(Y^* = 1 | Y = 1, Z)</code>.
The second column contains the conditional probability <code class="reqn">P(Y^* = 2 | Y = 2, Z)</code>.
</p>

<hr>
<h2 id='pistar_by_chain_2stage'>Compute the Mean Conditional Probability of Correct Classification, by True Outcome Across all Subjects for each MCMC Chain for a 2-stage model</h2><span id='topic+pistar_by_chain_2stage'></span>

<h3>Description</h3>

<p>Compute the Mean Conditional Probability of Correct Classification, by True Outcome Across all Subjects for each MCMC Chain for a 2-stage model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pistar_by_chain_2stage(n_chains, chains_list, Z, n, n_cat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pistar_by_chain_2stage_+3A_n_chains">n_chains</code></td>
<td>
<p>An integer specifying the number of MCMC chains to compute over.</p>
</td></tr>
<tr><td><code id="pistar_by_chain_2stage_+3A_chains_list">chains_list</code></td>
<td>
<p>A numeric list containing the samples from <code>n_chains</code>
MCMC chains.</p>
</td></tr>
<tr><td><code id="pistar_by_chain_2stage_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix.</p>
</td></tr>
<tr><td><code id="pistar_by_chain_2stage_+3A_n">n</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>Z</code>.</p>
</td></tr>
<tr><td><code id="pistar_by_chain_2stage_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcome, <code>Y*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>pistar_by_chain</code> returns a numeric matrix of the average
conditional probability <code class="reqn">P(Y^* = j | Y = j, Z)</code> across all subjects for
each MCMC chain. Rows of the matrix correspond to MCMC chains, up to <code>n_chains</code>.
The first column contains the conditional probability <code class="reqn">P(Y^* = 1 | Y = 1, Z)</code>.
The second column contains the conditional probability <code class="reqn">P(Y^* = 2 | Y = 2, Z)</code>.
</p>

<hr>
<h2 id='pistar_compute'>Compute Conditional Probability of Each Observed Outcome Given Each True Outcome, for Every Subject</h2><span id='topic+pistar_compute'></span>

<h3>Description</h3>

<p>Compute Conditional Probability of Each Observed Outcome Given Each True Outcome, for Every Subject
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pistar_compute(gamma, Z, n, n_cat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pistar_compute_+3A_gamma">gamma</code></td>
<td>
<p>A numeric matrix of regression parameters for the observed
outcome mechanism, <code>Y* | Y</code>
(observed outcome, given the true outcome) ~ <code>Z</code> (misclassification
predictor matrix). Rows of the matrix correspond to parameters for the <code>Y* = 1</code>
observed outcome, with the dimensions of <code>Z</code>.
Columns of the matrix correspond to the true outcome categories
<code class="reqn">j = 1, \dots,</code> <code>n_cat</code>.</p>
</td></tr>
<tr><td><code id="pistar_compute_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix.</p>
</td></tr>
<tr><td><code id="pistar_compute_+3A_n">n</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>Z</code>.</p>
</td></tr>
<tr><td><code id="pistar_compute_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcome, <code>Y*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>pistar_compute</code> returns a matrix of conditional probabilities,
<code class="reqn">P(Y_i^* = k | Y_i = j, Z_i) = \frac{\text{exp}\{\gamma_{kj0} + \gamma_{kjZ} Z_i\}}{1 + \text{exp}\{\gamma_{kj0} + \gamma_{kjZ} Z_i\}}</code>
for each of the <code class="reqn">i = 1, \dots,</code> <code>n</code> subjects. Rows of the matrix
correspond to each subject and observed outcome. Specifically, the probability
for subject <code class="reqn">i</code> and observed category $1$ occurs at row <code class="reqn">i</code>. The probability
for subject <code class="reqn">i</code> and observed category $2$ occurs at row <code class="reqn">i +</code> <code>n</code>.
Columns of the matrix correspond to the true outcome categories <code class="reqn">j = 1, \dots,</code> <code>n_cat</code>.
</p>

<hr>
<h2 id='pistar_compute_for_chains'>Compute Conditional Probability of Each Observed Outcome Given Each True Outcome for a given MCMC Chain, for Every Subject</h2><span id='topic+pistar_compute_for_chains'></span>

<h3>Description</h3>

<p>Compute Conditional Probability of Each Observed Outcome Given Each True Outcome for a given MCMC Chain, for Every Subject
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pistar_compute_for_chains(chain_colMeans, Z, n, n_cat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pistar_compute_for_chains_+3A_chain_colmeans">chain_colMeans</code></td>
<td>
<p>A numeric vector containing the posterior means for all
sampled parameters in a given MCMC chain. <code>chain_colMeans</code> must be a named
object (i.e. each parameter must be named as <code>gamma[k,j,p]</code>).</p>
</td></tr>
<tr><td><code id="pistar_compute_for_chains_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix.</p>
</td></tr>
<tr><td><code id="pistar_compute_for_chains_+3A_n">n</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>Z</code>.</p>
</td></tr>
<tr><td><code id="pistar_compute_for_chains_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcome, <code>Y*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>pistar_compute_for_chains</code> returns a matrix of conditional probabilities,
<code class="reqn">P(Y_i^* = k | Y_i = j, Z_i) = \frac{\text{exp}\{\gamma_{kj0} + \gamma_{kjZ} Z_i\}}{1 + \text{exp}\{\gamma_{kj0} + \gamma_{kjZ} Z_i\}}</code>
for each of the <code class="reqn">i = 1, \dots,</code> <code>n</code> subjects. Rows of the matrix
correspond to each subject and observed outcome. Specifically, the probability
for subject <code class="reqn">i</code> and observed category $0$ occurs at row <code class="reqn">i</code>. The probability
for subject <code class="reqn">i</code> and observed category $1$ occurs at row <code class="reqn">i +</code> <code>n</code>.
Columns of the matrix correspond to the true outcome categories <code class="reqn">j = 1, \dots,</code> <code>n_cat</code>.
</p>

<hr>
<h2 id='pistar_compute_for_chains_2stage'>Compute Conditional Probability of Each Observed Outcome Given Each True Outcome for a given MCMC Chain, for Every Subject for 2-stage models</h2><span id='topic+pistar_compute_for_chains_2stage'></span>

<h3>Description</h3>

<p>Compute Conditional Probability of Each Observed Outcome Given Each True Outcome for a given MCMC Chain, for Every Subject for 2-stage models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pistar_compute_for_chains_2stage(chain_colMeans, Z, n, n_cat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pistar_compute_for_chains_2stage_+3A_chain_colmeans">chain_colMeans</code></td>
<td>
<p>A numeric vector containing the posterior means for all
sampled parameters in a given MCMC chain. <code>chain_colMeans</code> must be a named
object (i.e. each parameter must be named as <code>gamma[k,j,p]</code>).</p>
</td></tr>
<tr><td><code id="pistar_compute_for_chains_2stage_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix.</p>
</td></tr>
<tr><td><code id="pistar_compute_for_chains_2stage_+3A_n">n</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>Z</code>.</p>
</td></tr>
<tr><td><code id="pistar_compute_for_chains_2stage_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcome, <code>Y*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>pistar_compute_for_chains</code> returns a matrix of conditional probabilities,
<code class="reqn">P(Y_i^* = k | Y_i = j, Z_i) = \frac{\text{exp}\{\gamma_{kj0} + \gamma_{kjZ} Z_i\}}{1 + \text{exp}\{\gamma_{kj0} + \gamma_{kjZ} Z_i\}}</code>
for each of the <code class="reqn">i = 1, \dots,</code> <code>n</code> subjects. Rows of the matrix
correspond to each subject and observed outcome. Specifically, the probability
for subject <code class="reqn">i</code> and observed category $0$ occurs at row <code class="reqn">i</code>. The probability
for subject <code class="reqn">i</code> and observed category $1$ occurs at row <code class="reqn">i +</code> <code>n</code>.
Columns of the matrix correspond to the true outcome categories <code class="reqn">j = 1, \dots,</code> <code>n_cat</code>.
</p>

<hr>
<h2 id='pitilde_by_chain'>Compute the Mean Conditional Probability of Second-Stage Correct Classification, by First-Stage and True Outcome Across all Subjects for each MCMC Chain</h2><span id='topic+pitilde_by_chain'></span>

<h3>Description</h3>

<p>Compute the Mean Conditional Probability of Second-Stage Correct Classification, by First-Stage and True Outcome Across all Subjects for each MCMC Chain
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pitilde_by_chain(n_chains, chains_list, V, n, n_cat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pitilde_by_chain_+3A_n_chains">n_chains</code></td>
<td>
<p>An integer specifying the number of MCMC chains to compute over.</p>
</td></tr>
<tr><td><code id="pitilde_by_chain_+3A_chains_list">chains_list</code></td>
<td>
<p>A numeric list containing the samples from <code>n_chains</code>
MCMC chains.</p>
</td></tr>
<tr><td><code id="pitilde_by_chain_+3A_v">V</code></td>
<td>
<p>A numeric design matrix.</p>
</td></tr>
<tr><td><code id="pitilde_by_chain_+3A_n">n</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>V</code>.</p>
</td></tr>
<tr><td><code id="pitilde_by_chain_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code class="reqn">Y</code>,
the first-stage observed outcome, <code class="reqn">Y*</code>, and the second-stage
observed outcome, <code class="reqn">\tilde{Y}</code>, can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>pitilde_by_chain</code> returns a numeric matrix of the average
conditional probability <code class="reqn">P( \tilde{Y} = j | Y^* = j, Y = j, V)</code> across all subjects for
each MCMC chain. Rows of the matrix correspond to MCMC chains, up to <code>n_chains</code>.
The first column contains the conditional probability <code class="reqn">P( \tilde{Y} = 1 | Y^* = 1, Y = 1, V)</code>.
The second column contains the conditional probability <code class="reqn">P( \tilde{Y} = 2 | Y^* = 2, Y = 2, V)</code>.
</p>

<hr>
<h2 id='pitilde_compute'>Compute Conditional Probability of Each Second-Stage Observed Outcome Given Each True Outcome and First-Stage Observed Outcome, for Every Subject</h2><span id='topic+pitilde_compute'></span>

<h3>Description</h3>

<p>Compute Conditional Probability of Each Second-Stage Observed Outcome Given Each True Outcome and First-Stage Observed Outcome, for Every Subject
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pitilde_compute(delta, V, n, n_cat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pitilde_compute_+3A_delta">delta</code></td>
<td>
<p>A numeric array of regression parameters for the second-stage observed
outcome mechanism, <code class="reqn">\tilde{Y} | Y^*, Y</code>
(second-stage observed outcome, given the first-stage observed outcome and the true outcome) ~ <code>V</code> (misclassification
predictor matrix). Rows of the matrix correspond to parameters for the <code class="reqn">\tilde{Y} = 1</code>
observed outcome, with the dimensions of <code>V</code>.
Columns of the matrix correspond to the first-stage observed outcome categories
<code class="reqn">k = 1, \dots,</code> <code>n_cat</code>. The third dimension of the array
corresponds to the true outcome categories <code class="reqn">j = 1, \dots,</code> <code>n_cat</code></p>
</td></tr>
<tr><td><code id="pitilde_compute_+3A_v">V</code></td>
<td>
<p>A numeric design matrix.</p>
</td></tr>
<tr><td><code id="pitilde_compute_+3A_n">n</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>V</code>.</p>
</td></tr>
<tr><td><code id="pitilde_compute_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcomes can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>pitilde_compute</code> returns an array of conditional probabilities,
<code class="reqn">P(\tilde{Y}_i = \ell | Y^*_i = k, Y_i = j, V_i) = \frac{\text{exp}\{\delta_{\ell kj0} + \delta_{\ell kjV} V_i\}}{1 + \text{exp}\{\delta_{\ell kj0} + \delta_{\ell kjV} V_i\}}</code>
for each of the <code class="reqn">i = 1, \dots,</code> <code>n</code> subjects. Rows of the matrix
correspond to each subject and second-stage observed outcome. Specifically, the probability
for subject <code class="reqn">i</code> and observed category $1$ occurs at row <code class="reqn">i</code>. The probability
for subject <code class="reqn">i</code> and observed category $2$ occurs at row <code class="reqn">i +</code> <code>n</code>.
Columns of the matrix correspond to the first-stage outcome categories, <code class="reqn">k = 1, \dots,</code> <code>n_cat</code>.
The third dimension of the array corresponds to the true outcome categories,
<code class="reqn">j = 1, \dots,</code> <code>n_cat</code>.
</p>

<hr>
<h2 id='pitilde_compute_for_chains'>Compute Conditional Probability of Each Observed Outcome Given Each True Outcome for a given MCMC Chain, for Every Subject</h2><span id='topic+pitilde_compute_for_chains'></span>

<h3>Description</h3>

<p>Compute Conditional Probability of Each Observed Outcome Given Each True Outcome for a given MCMC Chain, for Every Subject
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pitilde_compute_for_chains(chain_colMeans, V, n, n_cat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pitilde_compute_for_chains_+3A_chain_colmeans">chain_colMeans</code></td>
<td>
<p>A numeric vector containing the posterior means for all
sampled parameters in a given MCMC chain. <code>chain_colMeans</code> must be a named
object (i.e. each parameter must be named as <code>delta[l,k,j,p]</code>).</p>
</td></tr>
<tr><td><code id="pitilde_compute_for_chains_+3A_v">V</code></td>
<td>
<p>A numeric design matrix.</p>
</td></tr>
<tr><td><code id="pitilde_compute_for_chains_+3A_n">n</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>V</code>.</p>
</td></tr>
<tr><td><code id="pitilde_compute_for_chains_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code class="reqn">Y</code>,
the first-stage observed outcome, <code class="reqn">Y^*</code>, and the second-stage
observed outcome, <code class="reqn">\tilde{Y}</code>,\ can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>pitilde_compute_for_chains</code> returns a matrix of conditional probabilities,
<code class="reqn">P(\tilde{Y}_i = \ell | Y^*_i = k, Y_i = j, V_i) = \frac{\text{exp}\{\delta_{\ell kj0} + \delta_{\ell kjV} V_i\}}{1 + \text{exp}\{\delta_{\ell kj0} + \delta_{\ell kjV} V_i\}}</code>
corresponding to each subject and observed outcome. Specifically, the probability
for subject <code class="reqn">i</code> and second-stage observed category $1$ occurs at row <code class="reqn">i</code>. The probability
for subject <code class="reqn">i</code> and second-stage observed category $2$ occurs at row <code class="reqn">i +</code> <code>n</code>.
Columns of the matrix correspond to the first-stage outcome categories <code class="reqn">j = 1, \dots,</code> <code>n_cat</code>.
The third dimension of the array corresponds to the true outcome categories,
<code class="reqn">j = 1, \dots,</code> <code>n_cat</code>.
</p>

<hr>
<h2 id='q_beta_f'>M-Step Expected Log-Likelihood with respect to Beta</h2><span id='topic+q_beta_f'></span>

<h3>Description</h3>

<p>Objective function of the form:
<code class="reqn"> Q_\beta = \sum_{i = 1}^N \Bigl[ \sum_{j = 0}^1 w_{ij} \text{log} \{ \pi_{ij} \}\Bigr]</code>.
Used to obtain estimates of <code class="reqn">\beta</code> parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>q_beta_f(beta, X, w_mat, sample_size, n_cat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="q_beta_f_+3A_beta">beta</code></td>
<td>
<p>A numeric vector of regression parameters for the
<code>Y</code> (true outcome) ~ <code>X</code> (predictor matrix of interest).</p>
</td></tr>
<tr><td><code id="q_beta_f_+3A_x">X</code></td>
<td>
<p>A numeric design matrix.</p>
</td></tr>
<tr><td><code id="q_beta_f_+3A_w_mat">w_mat</code></td>
<td>
<p>Matrix of E-step weights obtained from <code>w_j</code>.</p>
</td></tr>
<tr><td><code id="q_beta_f_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>X</code>.</p>
</td></tr>
<tr><td><code id="q_beta_f_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>q_beta_f</code> returns the negative value of the expected log-likelihood function,
<code class="reqn"> Q_\beta = \sum_{i = 1}^N \Bigl[ \sum_{j = 1}^2 w_{ij} \text{log} \{ \pi_{ij} \}\Bigr]</code>,
at the provided inputs.
</p>

<hr>
<h2 id='q_delta_f'>M-Step Expected Log-Likelihood with respect to Delta</h2><span id='topic+q_delta_f'></span>

<h3>Description</h3>

<p>Objective function of the form:
<code class="reqn">Q_{\delta} = \sum_{i = 1}^N \Bigl[\sum_{j = 1}^2 \sum_{k = 1}^2 \sum_{\ell = 1}^2 w_{ij} y^*_{ik} \tilde{y}_{i \ell} \text{log} \{ \tilde{\pi}_{i \ell kj} \}\Bigr]</code>.
Used to obtain estimates of <code class="reqn">\delta</code> parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>q_delta_f(
  delta_v,
  V,
  obs_Ystar_matrix,
  obs_Ytilde_matrix,
  w_mat,
  sample_size,
  n_cat
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="q_delta_f_+3A_delta_v">delta_v</code></td>
<td>
<p>A numeric array of regression parameters for the second-stage observed
outcome mechanism, <code class="reqn">\tilde{Y} | Y^*, Y</code>
(second-stage observed outcome, given the first-stage observed outcome and the true outcome) ~ <code>V</code> (misclassification
predictor matrix). The <code class="reqn">\delta</code> vector is obtained from the array form. In array form,
the first dimension (matrix rows) of <code>delta</code>
corresponds to parameters for the <code class="reqn">\tilde{Y} = 1</code>
second-stage observed outcome, with the dimensions of the <code>V</code>
The second dimension (matrix columns) correspond to the first-stage
observed outcome categories <code class="reqn">Y^* \in \{1, 2\}</code>. The third dimension of
<code>delta_start</code> corresponds to to the true outcome categories
<code class="reqn">Y \in \{1, 2\}</code>. The numeric vector <code class="reqn">\delta</code> is obtained by
concatenating the delta array, i.e. <code>delta_v &lt;- c(delta_array)</code>.</p>
</td></tr>
<tr><td><code id="q_delta_f_+3A_v">V</code></td>
<td>
<p>A numeric design matrix.</p>
</td></tr>
<tr><td><code id="q_delta_f_+3A_obs_ystar_matrix">obs_Ystar_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the observed
outcome <code>Y*</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="q_delta_f_+3A_obs_ytilde_matrix">obs_Ytilde_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the observed
outcome <code class="reqn">\tilde{Y}</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="q_delta_f_+3A_w_mat">w_mat</code></td>
<td>
<p>Matrix of E-step weights obtained from <code>w_j_2stage</code>.</p>
</td></tr>
<tr><td><code id="q_delta_f_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>V</code>.</p>
</td></tr>
<tr><td><code id="q_delta_f_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcomes can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>q_beta_f</code> returns the negative value of the expected log-likelihood function,
<code class="reqn">Q_{\delta} = \sum_{i = 1}^N \Bigl[\sum_{j = 1}^2 \sum_{k = 1}^2 \sum_{\ell = 1}^2 w_{ij} y^*_{ik} \tilde{y}_{i \ell} \text{log} \{ \tilde{\pi}_{i \ell kj} \}\Bigr]</code>,
at the provided inputs.
</p>

<hr>
<h2 id='q_gamma_f'>M-Step Expected Log-Likelihood with respect to Gamma</h2><span id='topic+q_gamma_f'></span>

<h3>Description</h3>

<p>Objective function of the form:
<code class="reqn">Q_{\gamma} = \sum_{i = 1}^N \Bigl[\sum_{j = 1}^2 \sum_{k = 1}^2 w_{ij} y^*_{ik} \text{log} \{ \pi^*_{ikj} \}\Bigr]</code>.
Used to obtain estimates of <code class="reqn">\gamma</code> parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>q_gamma_f(gamma_v, Z, obs_Y_matrix, w_mat, sample_size, n_cat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="q_gamma_f_+3A_gamma_v">gamma_v</code></td>
<td>
<p>A numeric vector of regression parameters for the observed
outcome mechanism, <code>Y* | Y</code>
(observed outcome, given the true outcome) ~ <code>Z</code> (misclassification
predictor matrix). In matrix form, the gamma parameter matrix rows
correspond to parameters for the <code>Y* = 0</code>
observed outcome, with the dimensions of <code>Z</code>.
In matrix form, the gamma parameter matrix columns correspond to the true outcome categories
<code class="reqn">j = 1, \dots,</code> <code>n_cat</code>. The numeric vector <code>gamma_v</code> is
obtained by concatenating the gamma matrix, i.e. <code>gamma_v &lt;- c(gamma_matrix)</code>.</p>
</td></tr>
<tr><td><code id="q_gamma_f_+3A_z">Z</code></td>
<td>
<p>A numeric design matrix.</p>
</td></tr>
<tr><td><code id="q_gamma_f_+3A_obs_y_matrix">obs_Y_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the observed
outcome <code>Y*</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="q_gamma_f_+3A_w_mat">w_mat</code></td>
<td>
<p>Matrix of E-step weights obtained from <code>w_j</code>.</p>
</td></tr>
<tr><td><code id="q_gamma_f_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in the sample.
This value should be equal to the number of rows of the design matrix, <code>Z</code>.</p>
</td></tr>
<tr><td><code id="q_gamma_f_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcome, <code>Y*</code> can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>q_beta_f</code> returns the negative value of the expected log-likelihood function,
<code class="reqn">Q_{\gamma} = \sum_{i = 1}^N \Bigl[\sum_{j = 1}^2 \sum_{k = 1}^2 w_{ij} y^*_{ik} \text{log} \{ \pi^*_{ikj} \}\Bigr]</code>,
at the provided inputs.
</p>

<hr>
<h2 id='sum_every_n'>Sum Every &quot;n&quot;th Element</h2><span id='topic+sum_every_n'></span>

<h3>Description</h3>

<p>Sum Every &quot;n&quot;th Element
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sum_every_n(x, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sum_every_n_+3A_x">x</code></td>
<td>
<p>A numeric vector to sum over</p>
</td></tr>
<tr><td><code id="sum_every_n_+3A_n">n</code></td>
<td>
<p>A numeric value specifying the distance between the reference index and the next index to be summed</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>sum_every_n</code> returns a vector of sums of every <code>n</code>th element of the vector <code>x</code>.
</p>

<hr>
<h2 id='sum_every_n1'>Sum Every &quot;n&quot;th Element, then add 1</h2><span id='topic+sum_every_n1'></span>

<h3>Description</h3>

<p>Sum Every &quot;n&quot;th Element, then add 1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sum_every_n1(x, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sum_every_n1_+3A_x">x</code></td>
<td>
<p>A numeric vector to sum over</p>
</td></tr>
<tr><td><code id="sum_every_n1_+3A_n">n</code></td>
<td>
<p>A numeric value specifying the distance between the reference index and the next index to be summed</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>sum_every_n1</code> returns a vector of sums of every <code>n</code>th element of the vector <code>x</code>, plus 1.
</p>

<hr>
<h2 id='true_classification_prob'>Compute Probability of Each True Outcome, for Every Subject</h2><span id='topic+true_classification_prob'></span>

<h3>Description</h3>

<p>Compute the probability of the latent true outcome <code class="reqn">Y \in \{1, 2 \}</code> as
<code class="reqn">P(Y_i = j | X_i) = \frac{\exp(X_i \beta)}{1 + \exp(X_i \beta)}</code>
for each of the <code class="reqn">i = 1, \dots,</code> <code>n</code> subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>true_classification_prob(beta_matrix, x_matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="true_classification_prob_+3A_beta_matrix">beta_matrix</code></td>
<td>
<p>A numeric column matrix of estimated regression parameters for the
true outcome mechanism, <code>Y</code> (true outcome) ~ <code>X</code> (predictor matrix of interest),
obtained from <code>COMBO_EM</code> or <code>COMBO_MCMC</code>.</p>
</td></tr>
<tr><td><code id="true_classification_prob_+3A_x_matrix">x_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true outcome mechanism.
<code>x_matrix</code> should not contain an intercept.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>true_classification_prob</code> returns a dataframe containing three columns.
The first column, <code>Subject</code>, represents the subject ID, from <code class="reqn">1</code> to <code>n</code>,
where <code>n</code> is the sample size, or equivalently, the number of rows in <code>x_matrix</code>.
The second column, <code>Y</code>, represents a true, latent outcome category <code class="reqn">Y \in \{1, 2 \}</code>.
The last column, <code>Probability</code>, is the value of the equation
<code class="reqn">P(Y_i = j | X_i) = \frac{\exp(X_i \beta)}{1 + \exp(X_i \beta)}</code> computed
for each subject and true, latent outcome category.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
sample_size &lt;- 1000
cov1 &lt;- rnorm(sample_size)
cov2 &lt;- rnorm(sample_size, 1, 2)
x_matrix &lt;- matrix(c(cov1, cov2), nrow = sample_size, byrow = FALSE)
estimated_betas &lt;- matrix(c(1, -1, .5), ncol = 1)
P_Y &lt;- true_classification_prob(estimated_betas, x_matrix)
head(P_Y)
</code></pre>

<hr>
<h2 id='w_j'>Compute E-step for Binary Outcome Misclassification Model Estimated With the EM-Algorithm</h2><span id='topic+w_j'></span>

<h3>Description</h3>

<p>Compute E-step for Binary Outcome Misclassification Model Estimated With the EM-Algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>w_j(ystar_matrix, pistar_matrix, pi_matrix, sample_size, n_cat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="w_j_+3A_ystar_matrix">ystar_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the observed
outcome <code>Y*</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="w_j_+3A_pistar_matrix">pistar_matrix</code></td>
<td>
<p>A numeric matrix of conditional probabilities obtained from
the internal function <code>pistar_compute</code>. Rows of the matrix correspond to
each subject and to each observed outcome category. Columns of the matrix
correspond to each true, latent outcome category.</p>
</td></tr>
<tr><td><code id="w_j_+3A_pi_matrix">pi_matrix</code></td>
<td>
<p>A numeric matrix of probabilities obtained from the internal
function <code>pi_compute</code>. Rows of the matrix correspond to each subject.
Columns of the matrix correspond to each true, latent outcome category.</p>
</td></tr>
<tr><td><code id="w_j_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in
the sample. This value should be equal to the number of rows of the observed
outcome matrix, <code>ystar_matrix</code>.</p>
</td></tr>
<tr><td><code id="w_j_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcome, <code>Y*</code>, can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>w_j</code> returns a matrix of E-step weights for the EM-algorithm,
computed as follows:
<code class="reqn">\sum_{k = 1}^2 \frac{y^*_{ik} \pi^*_{ikj} \pi_{ij}}{\sum_{\ell = 1}^2 \pi^*_{i k \ell} \pi_{i \ell}}</code>.
Rows of the matrix correspond to each subject. Columns of the matrix correspond
to the true outcome categories <code class="reqn">j = 1, \dots,</code> <code>n_cat</code>.
</p>

<hr>
<h2 id='w_j_2stage'>Compute E-step for Two-Stage Binary Outcome Misclassification Model Estimated With the EM-Algorithm</h2><span id='topic+w_j_2stage'></span>

<h3>Description</h3>

<p>Compute E-step for Two-Stage Binary Outcome Misclassification Model Estimated With the EM-Algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>w_j_2stage(
  ystar_matrix,
  ytilde_matrix,
  pitilde_array,
  pistar_matrix,
  pi_matrix,
  sample_size,
  n_cat
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="w_j_2stage_+3A_ystar_matrix">ystar_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the observed
outcome <code>Y*</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="w_j_2stage_+3A_ytilde_matrix">ytilde_matrix</code></td>
<td>
<p>A numeric matrix of indicator variables (0, 1) for the observed
outcome <code class="reqn">\tilde{Y}</code>. Rows of the matrix correspond to each subject. Columns of
the matrix correspond to each observed outcome category. Each row should contain
exactly one 0 entry and exactly one 1 entry.</p>
</td></tr>
<tr><td><code id="w_j_2stage_+3A_pitilde_array">pitilde_array</code></td>
<td>
<p>A numeric array of conditional probabilities obtained from
the internal function <code>pitilde_compute</code>. Rows of the matrices correspond
to each subject and to each second-stage observed outcome category. Columns of the matrix correspond
to each first-stage observed outcome category. The third dimension of the array
corresponds to each true, latent outcome category.</p>
</td></tr>
<tr><td><code id="w_j_2stage_+3A_pistar_matrix">pistar_matrix</code></td>
<td>
<p>A numeric matrix of conditional probabilities obtained from
the internal function <code>pistar_compute</code>. Rows of the matrix correspond to
each subject and to each first-stage observed outcome category. Columns of the matrix
correspond to each true, latent outcome category.</p>
</td></tr>
<tr><td><code id="w_j_2stage_+3A_pi_matrix">pi_matrix</code></td>
<td>
<p>A numeric matrix of probabilities obtained from the internal
function <code>pi_compute</code>. Rows of the matrix correspond to each subject.
Columns of the matrix correspond to each true, latent outcome category.</p>
</td></tr>
<tr><td><code id="w_j_2stage_+3A_sample_size">sample_size</code></td>
<td>
<p>An integer value specifying the number of observations in
the sample. This value should be equal to the number of rows of the observed
outcome matrices, <code>ystar_matrix</code> and <code>ytilde_matrix</code>.</p>
</td></tr>
<tr><td><code id="w_j_2stage_+3A_n_cat">n_cat</code></td>
<td>
<p>The number of categorical values that the true outcome, <code>Y</code>,
and the observed outcomes can take.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>w_j</code> returns a matrix of E-step weights for the EM-algorithm,
computed as follows:
<code class="reqn">\sum_{k = 1}^2 \sum_{\ell = 1}^2 \frac{y^*_{ik} \tilde{y}_{i \ell} \tilde{\pi}_{i \ell kj} \pi^*_{ikj} \pi_{ij}}{\sum_{h = 1}^2 \tilde{\pi}_{i \ell kh} \pi^*_{ikh} \pi_{ih}}</code>.
Rows of the matrix correspond to each subject. Columns of the matrix correspond
to the true outcome categories <code class="reqn">j = 1, \dots,</code> <code>n_cat</code>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
