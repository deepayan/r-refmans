<!DOCTYPE html><html lang="en"><head><title>Help for package aisoph</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {aisoph}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aisoph-package'><p>Additive Isotonic Proportional Hazards Model</p></a></li>
<li><a href='#aisoph'><p>Fit Additive Isotonic Proportional Hazards Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Additive Isotonic Proportional Hazards Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-03-03</td>
</tr>
<tr>
<td>Description:</td>
<td>Nonparametric estimation of additive isotonic covariate effects for proportional hazards model.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0), Iso, survival</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-04 03:39:57 UTC; roy</td>
</tr>
<tr>
<td>Author:</td>
<td>Yunro Chung <a href="https://orcid.org/0000-0001-9125-9277"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yunro Chung &lt;yunro.chung@asu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-04 07:20:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='aisoph-package'>Additive Isotonic Proportional Hazards Model</h2><span id='topic+aisoph-package'></span>

<h3>Description</h3>

<p>Nonparametric estimation of additive isotonic covariate effects for proportional hazards model.</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> aisoph</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.4</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-03-03</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Yunro Chung [aut, cre]
Maintainer: Yunro Chung &lt;yunro.chung@asu.edu&gt;
</p>


<h3>References</h3>

<p>Yunro Chung, Anastasia Ivanova, Jason P. Fine, Additive isotonic proportional hazards models (working in progress).</p>

<hr>
<h2 id='aisoph'>Fit Additive Isotonic Proportional Hazards Model</h2><span id='topic+aisoph'></span>

<h3>Description</h3>

<p>Nonparametric estimation of additive isotonic covariate effects for proportional hazards model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  aisoph(time, status, z1, z2, x, shape1, shape2, K1, K2, maxiter, eps)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aisoph_+3A_time">time</code></td>
<td>
<p>survival time. It must be greater than 0.</p>
</td></tr>
<tr><td><code id="aisoph_+3A_status">status</code></td>
<td>
<p>censoring indication. It must be 0 or 1.</p>
</td></tr>
<tr><td><code id="aisoph_+3A_z1">z1</code></td>
<td>
<p>First covariate under order-restriction.</p>
</td></tr>
<tr><td><code id="aisoph_+3A_z2">z2</code></td>
<td>
<p>Second covariate under-order restriction.</p>
</td></tr>
<tr><td><code id="aisoph_+3A_x">x</code></td>
<td>
<p>Additional covariates (vector or data.frame). This argument is optional</p>
</td></tr>
<tr><td><code id="aisoph_+3A_shape1">shape1</code></td>
<td>
<p>Shape-restriction for <code class="reqn"> z1 </code>, &quot;increasing&quot; or &quot;decreasing&quot;.</p>
</td></tr>
<tr><td><code id="aisoph_+3A_shape2">shape2</code></td>
<td>
<p>Shape-restriction for <code class="reqn"> z2 </code>, &quot;increasing&quot; or &quot;decreasing&quot;.</p>
</td></tr>
<tr><td><code id="aisoph_+3A_k1">K1</code></td>
<td>
<p>anchor constraint for <code class="reqn"> z1 </code>.</p>
</td></tr>
<tr><td><code id="aisoph_+3A_k2">K2</code></td>
<td>
<p>anchor constraint for <code class="reqn"> z2 </code>.</p>
</td></tr>
<tr><td><code id="aisoph_+3A_maxiter">maxiter</code></td>
<td>
<p>maximum number of iteration (default is 10^5).</p>
</td></tr>
<tr><td><code id="aisoph_+3A_eps">eps</code></td>
<td>
<p>stopping convergence criteria (default is 10^-3).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The aisoph function allows to analyze additive isotonic proportional hazards model, which is defined as
</p>
<p style="text-align: center;"><code class="reqn"> \lambda(t|z1, z2, x)=\lambda0(t)exp(\psi1(z1)+\psi2(z2)+\beta x), </code>
</p>

<p>where <code class="reqn"> \lambda0 </code> is an unspecified baseline hazard function, <code class="reqn"> \psi1 </code> and <code class="reqn"> \psi2 </code> are monotone increasing (or decreasing) functions in <code class="reqn">z1</code> and <code class="reqn">z2</code>, respectively, <code class="reqn">x</code> is a covariate, and <code class="reqn"> \beta </code> is a regression paramter. If <code class="reqn"> x </code> is omitted in the formulation above, <code class="reqn"> \psi1 </code> and <code class="reqn"> \psi2 </code> are only estimated.
</p>
<p>The model is not identifiable without the anchor constraint, <code class="reqn">\psi1(K1)=0</code> and <code class="reqn">\psi2(K2)=0</code>. By default, <code class="reqn">K1</code> and <code class="reqn">K2</code> are set to medians of <code class="reqn">z1</code> and <code class="reqn">z2</code> values, respectively. The choice of the anchor points is less important in the sense that hazard ratios do not depend on the anchors.</p>


<h3>Value</h3>

<p>A list of class isoph:
</p>
<table role = "presentation">
<tr><td><code>iso1</code></td>
<td>
<p>data.frame estimated <code class="reqn">\psi1</code>, estimated <code class="reqn">\exp(\psi1)</code>, and cens at <code class="reqn">z1</code>, where <code class="reqn">\exp(\psi1)</code> is a hazard ratio between <code class="reqn">z1</code> and <code class="reqn">K1</code>, and cens=&quot;no&quot; if (at least one) subject is not censored at <code class="reqn">z1</code> or cens=&quot;yes&quot; otherwise.</p>
</td></tr>
<tr><td><code>iso2</code></td>
<td>
<p>data.frame estimated <code class="reqn">\psi2</code>, estimated <code class="reqn">\exp(\psi2)</code>, and cens at <code class="reqn">z2</code>, where <code class="reqn">\exp(\psi2)</code> is a hazard ratio between <code class="reqn">z2</code> and <code class="reqn">K2</code>, and cens=&quot;no&quot; if (at least one) subject is not censored at <code class="reqn">z2</code> or cens=&quot;yes&quot; otherwise.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>data.frame with estimated <code class="reqn">\beta</code>, and <code class="reqn">\exp(\beta)</code>.</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p>status of algorithm convergence.</p>
</td></tr>
<tr><td><code>shape1</code></td>
<td>
<p>shape-constrain for <code class="reqn">\psi1</code>.</p>
</td></tr>
<tr><td><code>shape2</code></td>
<td>
<p>shape-constrain for <code class="reqn">\psi2</code>.</p>
</td></tr>
<tr><td><code>K1</code></td>
<td>
<p>anchor point for K1.</p>
</td></tr>
<tr><td><code>K2</code></td>
<td>
<p>anchor point for K2.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yunro Chung [aut, cre]</p>


<h3>References</h3>

<p>Yunro Chung, Anastasia Ivanova, Jason P. Fine, Additive isotonic proportional hazards models (working in progress).</p>


<h3>Examples</h3>

<pre><code class='language-R'>#require(survival)
#require(Iso)

###
# 1. time-independent covariate with monotone increasing effect
###
# 1.1. create a test data set 1
time=  c(1, 6, 3, 6, 7, 8, 1, 4, 0, 2, 1, 5, 8, 7, 4)
status=c(1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
z1=     c(3, 1, 2, 4, 8, 3, 3, 4, 1, 9, 4, 2, 2, 8, 5)
z2=     c(1, 3, 5, 6, 1, 7, 6, 8, 3, 4, 8, 8, 5, 2, 3)

# 1.2. Fit isotonic proportional hazards model
res1 = aisoph(time=time, status=status, z1=z1, z2=z2, 
              shape1="increasing", shape2="increasing")

# 1.3. print result
res1

#1.4. plot
plot(res1)

###
# 2. time-independent covariate with monotone increasing effect
###
# 2.1. create a test data set 1
time=  c(0,4,8,9,5,6,9,8,2,7,4,2,6,2,5,9,4,3,8,2)
status=c(0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1)
z1=    c(3,2,1,1,3,1,8,4,3,6,2,9,9,0,7,7,2,3,4,6)
z2=    c(3,6,9,9,4,3,9,8,4,7,2,3,1,3,7,0,1,6,4,1)
trt=   c(0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1)

# 2.2. Fit isotonic proportional hazards model
res2 = aisoph(time=time, status=status, z1=z1, z2=z2, x=trt,
              shape1="increasing", shape2="increasing")

# 2.3. print result
res2

#2.4. plot
plot(res2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
