<!DOCTYPE html><html lang="en-GB"><head><title>Help for package rplum</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rplum}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rplum'><p>rplum</p></a></li>
<li><a href='#Plum'><p>Main 210Pb age-depth modelling function</p></a></li>
<li><a href='#Plum_runs'><p>List the folders present in the current core directory.</p></a></li>
<li><a href='#Plum.cleanup'><p>Remove files made to produce the current core's age-depth model.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Age-Depth Modelling of Cores Dated by Pb-210</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Maarten Blaauw <a href="https://orcid.org/0000-0002-5680-1515"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  J. Andres Christen
    <a href="https://orcid.org/0000-0002-5795-4345"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, ctb,
    cph],
  Marco A. Aquino Lopez
    <a href="https://orcid.org/0000-0002-5076-7205"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Judith Esquivel Vazquez [ctb],
  Oscar M. Gonzalez V. [ctb],
  Ted Belding [cph],
  James Theiler [cph],
  Brian Gough [cph],
  Charles Karney [cph]</td>
</tr>
<tr>
<td>Description:</td>
<td>An approach to age-depth modelling that uses Bayesian statistics to reconstruct accumulation histories for 210Pb-dated deposits using prior information. It can combine 210Pb, radiocarbon, and other dates in the chronologies. See Aquino et al. (2018) &lt;<a href="https://doi.org/10.1007%2Fs13253-018-0328-7">doi:10.1007/s13253-018-0328-7</a>&gt;. Note that parts of the code underlying 'rplum' are derived from the 'rbacon' package by the same authors, and there remains a degree of overlap between the two packages.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices, graphics, stats, utils, rintcal</td>
</tr>
<tr>
<td>Depends:</td>
<td>rbacon (&ge; 3.3.1)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, utf8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maarten Blaauw &lt;maarten.blaauw@qub.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-29 15:33:52 UTC; maarten</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-29 15:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='rplum'>rplum</h2><span id='topic+rplum-package'></span><span id='topic+rplum'></span>

<h3>Description</h3>

<p>Plum is an approach to age-depth modelling that uses Bayesian statistics to reconstruct
accumulation histories for 210Pb-dated deposits using prior information, and can combine
210Pb, radiocarbon, and other dates in the chronologies.
See Aquino et al. (2018) &lt;doi:10.1007/s13253-018-0328-7&gt;.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw &lt;maarten.blaauw@qub.ac.uk&gt; J. Andres Christen &lt;jac@cimat.mx&gt; Marco Aquino-Lopez &lt;aquino@cimat.mx&gt;
</p>

<hr>
<h2 id='Plum'>Main 210Pb age-depth modelling function</h2><span id='topic+Plum'></span>

<h3>Description</h3>

<p>This is the main age-depth modelling function of the rplum package for 210Pb age-modelling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Plum(
  core = "HP1C",
  thick = 1,
  otherdates = NA,
  coredir = "",
  phi.shape = 2,
  phi.mean = 50,
  s.shape = 5,
  s.mean = 10,
  Al = 0.1,
  date.sample = c(),
  n.supp = c(),
  remove.tail = TRUE,
  ra.case = c(),
  Bqkg = TRUE,
  seed = NA,
  prob = 0.95,
  d.min = 0,
  d.max = NA,
  d.by = 1,
  depths.file = FALSE,
  depths = c(),
  depth.unit = "cm",
  age.unit = "yr",
  unit = depth.unit,
  acc.shape = 1.5,
  acc.mean = 10,
  mem.strength = 10,
  mem.mean = 0.5,
  boundary = NA,
  hiatus.depths = NA,
  hiatus.max = 10000,
  add = c(),
  after = 1e-04/thick,
  cc = 1,
  cc1 = "IntCal20",
  cc2 = "Marine20",
  cc3 = "SHCal20",
  cc4 = "ConstCal",
  cc.dir = "",
  postbomb = 0,
  delta.R = 0,
  delta.STD = 0,
  t.a = 3,
  t.b = 4,
  normal = FALSE,
  suggest = TRUE,
  reswarn = c(10, 200),
  remember = TRUE,
  ask = TRUE,
  run = TRUE,
  defaults = "defaultPlum_settings.txt",
  sep = ",",
  dec = ".",
  runname = "",
  slump = c(),
  BCAD = FALSE,
  ssize = 4000,
  th0 = c(),
  burnin = min(500, ssize),
  MinAge = c(),
  youngest.age = c(),
  MaxAge = c(),
  oldest.age = c(),
  cutoff = 0.001,
  rounded = 1,
  plot.pdf = TRUE,
  dark = 1,
  date.res = 100,
  age.res = 200,
  close.connections = TRUE,
  save.info = TRUE,
  older.than = c(),
  younger.than = c(),
  save.elbowages = FALSE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Plum_+3A_core">core</code></td>
<td>
<p>Name of the core, given using quotes. Defaults to one of the cores provided with rplum, <code>core="HP1C"</code> also reported by Aquino-Lopez et al. (2018). Also available is LL14, a core kindly provided by Dr Lysanna Anderson (USGS). LL14 has ra-226 data (so can be run with <code>ra.case=1</code> or <code>ra.case=2</code>, see below), and also has additional C-14 and cal BP data (these can be added using <code>otherdates="LL14_14C.csv"</code>). The original LL14 core has more 14C data than provided here (for reasons of brevity).
To run your own core, produce a .csv file with the dates as outlined in the manual, add a folder with the core's name to the default directory for cores (see <code>coredir</code>), and save the .csv file there. For example, the file's location and name could be <code>Plum_runs/MyCore/MyCore.csv</code>. Then run Plum as follows: <code>Plum("MyCore")</code>.
Note that for Pb-210 data, the depth in the .csv should be the bottom of the slice, not the mid-point. (For any non-Pb data, depths are the midpoints of their slices). Also make sure that the thickness and density are given correctly for each Pb-210 data point.</p>
</td></tr>
<tr><td><code id="Plum_+3A_thick">thick</code></td>
<td>
<p>Plum will divide the core into sections of equal thickness specified by thick (default <code>thick=1</code>).</p>
</td></tr>
<tr><td><code id="Plum_+3A_otherdates">otherdates</code></td>
<td>
<p>Name of (optional) file with radiocarbon dates. This file should have the same format as the one used for rbacon. For example, <code>Bacon("LL14", otherdates="LL14_14C.csv")</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_coredir">coredir</code></td>
<td>
<p>Folder where the core's files <code>core</code> are and/or will be located. This will be a folder with the core's name, within either the folder <code>coredir='Plum_runs/'</code>, or the folder Cores/ if it already exists within R's working directory, or a custom-built folder. For example, use <code>coredir="."</code> to place the core's folder within the current working directory, or <code>coredir="F:"</code> if you want to put the core's folder and files on a USB drive loaded under F:.
Thinner (and thus more) sections will result in smoother age-models, but too many sections can cause &lsquo;run-away&rsquo; models.</p>
</td></tr>
<tr><td><code id="Plum_+3A_phi.shape">phi.shape</code></td>
<td>
<p>Shape parameter of the prior gamma distribution used for the influx of Pb-210 to the sediment, default <code>phi.shape=2</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_phi.mean">phi.mean</code></td>
<td>
<p>Mean parameter of the prior gamma distribution used for the influx of Pb-210 to the sediment, default <code>phi.mean=50</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_s.shape">s.shape</code></td>
<td>
<p>Shape parameter of the prior gamma distribution used for the supported Pb-210 to the sediment, default <code>s.shape=5</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_s.mean">s.mean</code></td>
<td>
<p>Mean parameter of the prior gamma distribution used for the supported Pb-210 to the sediment, default <code>s.mean=10</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_al">Al</code></td>
<td>
<p>Parameter used to limit the chronologies described in Aquino-Lopez et al. (2018) for the minimum distinguishable unsupported activity; default <code>Al=0.1</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_date.sample">date.sample</code></td>
<td>
<p>Date (in calendar years, e.g., AD 2023) at which the core was measured for Pb-120. This date will be used as a surface date and is assumed to have no uncertainty. If the date is not provided (in the .csv file or as <code>date.sample</code>), Plum will ask for it.</p>
</td></tr>
<tr><td><code id="Plum_+3A_n.supp">n.supp</code></td>
<td>
<p>This value will delete n.supp data points from the deepest part of the core, and these points will then be used exclusively to estimate the supported activity. If this option is used, a constant supported Pb-210 will be assumed, <code>n.supp=-1</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_remove.tail">remove.tail</code></td>
<td>
<p>Whether or not to remove the tail measurements when plotting. Sometimes automated removal might go wrong, or additional dates exist further down, so then this option can be used to avoid removing the tail 210Pb measurements. Is set to FALSE if there are non-210Pb data further down the core.</p>
</td></tr>
<tr><td><code id="Plum_+3A_ra.case">ra.case</code></td>
<td>
<p>How to use radium-226 measurements if they are provided in the core's .csv file. 1 = assume constant radium, 2 = assume varying radium and use the radium measurements as individual estimates of supported Pb-210. If no radium measurements are present, use <code>ra.case=0</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_bqkg">Bqkg</code></td>
<td>
<p>This variable indicates whether total Pb-210 is expressed in Bq/kg (default; <code>Bqkg=TRUE</code>) or dpm/g if set to FALSE.</p>
</td></tr>
<tr><td><code id="Plum_+3A_seed">seed</code></td>
<td>
<p>Seed used for C++ executions; if it is not assigned then the seed is set by system. Default <code>seed=NA</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_prob">prob</code></td>
<td>
<p>Confidence interval to report. This should lie between 0 and 1, default <code>prob=0.95</code> (95 %).</p>
</td></tr>
<tr><td><code id="Plum_+3A_d.min">d.min</code></td>
<td>
<p>Minimum depth of age-depth model (use this to extrapolate to depths higher than the top dated depth).</p>
</td></tr>
<tr><td><code id="Plum_+3A_d.max">d.max</code></td>
<td>
<p>Maximum depth of age-depth model (use this to extrapolate to depths below the bottom dated depth).</p>
</td></tr>
<tr><td><code id="Plum_+3A_d.by">d.by</code></td>
<td>
<p>Depth intervals at which ages are calculated. Defaults to <code>d.by=1</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_depths.file">depths.file</code></td>
<td>
<p>By default, Plum will calculate the ages for the depths <code>d.min</code> to <code>d.max</code> in steps of <code>d.by</code>.
If <code>depths.file=TRUE</code>, Plum will read a file containing the depths for which you require ages.
This file, containing the depths in a single column without a header, should be stored within <code>coredir</code>,
and its name should start with the core's name and end with &lsquo;_depths.txt&rsquo;. Then specify <code>depths.file=TRUE</code> (default <code>FALSE</code>). See also <code>depths</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_depths">depths</code></td>
<td>
<p>By default, Plum will calculate the ages for the depths <code>d.min</code> to <code>d.max</code> in steps of <code>d.by</code>.
Alternative depths can be provided as, e.g., <code>depths=seq(0, 100, length=500)</code> or as a file, e.g., <code>depths=read.table("CoreDepths.txt"</code>. See also <code>depths.file</code></p>
</td></tr>
<tr><td><code id="Plum_+3A_depth.unit">depth.unit</code></td>
<td>
<p>Units of the depths. Defaults to <code>depth.unit="cm"</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_age.unit">age.unit</code></td>
<td>
<p>Units of the ages. Defaults to <code>age.unit="yr"</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_unit">unit</code></td>
<td>
<p>Deprecated and replaced by <code>depth.unit</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_acc.shape">acc.shape</code></td>
<td>
<p>The prior for the accumulation rate consists of a gamma distribution with two parameters.
Its shape is set by acc.shape (default <code>acc.shape=1.5</code>; higher values result in more peaked shapes).</p>
</td></tr>
<tr><td><code id="Plum_+3A_acc.mean">acc.mean</code></td>
<td>
<p>The accumulation rate prior consists of a gamma distribution with two parameters. Its mean is set by acc.mean (default <code>acc.mean=10</code> yr/cm (or whatever age or depth units are chosen),
which can be changed to, e.g., 5, 10 or 50 for different kinds of deposits). Multiple values can be given in case of hiatuses or boundaries, e.g., Plum(hiatus.depths=23, acc.mean=c(5,20))</p>
</td></tr>
<tr><td><code id="Plum_+3A_mem.strength">mem.strength</code></td>
<td>
<p>The prior for the memory (dependence of accumulation rate between neighbouring depths) is a beta distribution, which looks much like the gamma distribution.
but its values are always between 0 (no assumed memory) and 1 (100% memory). Its default settings of <code>mem.strength=10</code>
(higher values result in more peaked shapes) allow for a large range of posterior memory values.</p>
</td></tr>
<tr><td><code id="Plum_+3A_mem.mean">mem.mean</code></td>
<td>
<p>The prior for the memory is a beta distribution, which looks much like the gamma distribution but
its values are always between 0 (no assumed memory) and 1 (100% memory). Its default settings of <code>mem.mean=0.5</code>
allow for a large range of posterior memory values.</p>
</td></tr>
<tr><td><code id="Plum_+3A_boundary">boundary</code></td>
<td>
<p>The assumed depths of any boundary, which divides sections of different accumulation rate regimes (e.g., as indicated by major change in the stratigraphy). No hiatus is assumed between these sections, and memory is reset crossing the boundary. Different accumulation priors can be set for the sections above and below the boundary, e.g., <code>acc.mean=c(5, 20)</code>. See also <code>hiatus.depths</code>, <code>mem.mean</code>, <code>acc.mean</code> and <code>acc.shape</code>. Setting many boundaries might not work, and having more than one boundary per model section (see <code>'thick'</code>) might not work either.</p>
</td></tr>
<tr><td><code id="Plum_+3A_hiatus.depths">hiatus.depths</code></td>
<td>
<p>The assumed depths for any hiatus should be provided as, e.g.,
<code>hiatus.depths=20</code> for one at 20cm depth, and <code>hiatus.depths=c(20,40)</code> for two hiatuses at 20 and 40 cm depth.</p>
</td></tr>
<tr><td><code id="Plum_+3A_hiatus.max">hiatus.max</code></td>
<td>
<p>The prior for the maximum length of the hiatus. Hiatus length is a uniform distribution, with equal probabilities between 0 and <code>hiatus.max</code> yr (or whatever other <code>age.unit</code> is chosen).</p>
</td></tr>
<tr><td><code id="Plum_+3A_add">add</code></td>
<td>
<p>Add a value to the maximum hiatus length if a boundary is chosen. Defaults to 100 yr (or whatever other age unit is chosen). Can be adapted if Plum complains that the parameters are out of support.</p>
</td></tr>
<tr><td><code id="Plum_+3A_after">after</code></td>
<td>
<p>Sets a short section above and below hiatus.depths within which to calculate ages. For internal calculations - do not change.</p>
</td></tr>
<tr><td><code id="Plum_+3A_cc">cc</code></td>
<td>
<p>Calibration curve for C-14 dates: <code>cc=1</code> for IntCal20 (northern hemisphere terrestrial), <code>cc=2</code> for Marine20 (marine),
<code>cc=3</code> for SHCal20 (southern hemisphere terrestrial). For dates that are already on the cal BP scale use <code>cc=0</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_cc1">cc1</code></td>
<td>
<p>For northern hemisphere terrestrial 14C dates (IntCal20).</p>
</td></tr>
<tr><td><code id="Plum_+3A_cc2">cc2</code></td>
<td>
<p>For marine 14C dates (Marine20).</p>
</td></tr>
<tr><td><code id="Plum_+3A_cc3">cc3</code></td>
<td>
<p>For southern hemisphere 14C dates (SHCal20).</p>
</td></tr>
<tr><td><code id="Plum_+3A_cc4">cc4</code></td>
<td>
<p>Use an alternative curve (3 columns: cal BP, 14C age, error, separated by white spaces and saved as a plain-text file). See <code>cc.dir</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory where the calibration curves for C14 dates <code>cc</code> are located. By default <code>cc.dir=""</code> since they are loaded into R's memory.
For example, use <code>cc.dir="."</code> to choose current working directory, or <code>cc.dir="Curves/"</code> to choose sub-folder <code>Curves/</code>. Note that all calibration curves should reside in the same directory. If you want to add a custom-built curve, put it in the directory where the default calibration curves are (probably <code>list.files(paste0(.libPaths(), "/IntCal/extdata/"))</code>).
Alternatively produce a new folder, and add your curve as well as the default calibration curves there (cc1, cc2 and cc3; e.g., <code>write.table(copyCalibrationCurve(1), "./3Col_intcal20.14C", sep="\t")</code>.)</p>
</td></tr>
<tr><td><code id="Plum_+3A_postbomb">postbomb</code></td>
<td>
<p>Use a postbomb curve for negative (i.e. postbomb) 14C ages. <code>0 = none, 1 = NH1, 2 = NH2, 3 = NH3, 4 = SH1-2, 5 = SH3</code></p>
</td></tr>
<tr><td><code id="Plum_+3A_delta.r">delta.R</code></td>
<td>
<p>Mean of core-wide age offsets (e.g., regional marine offsets).</p>
</td></tr>
<tr><td><code id="Plum_+3A_delta.std">delta.STD</code></td>
<td>
<p>Error of core-wide age offsets (e.g., regional marine offsets).</p>
</td></tr>
<tr><td><code id="Plum_+3A_t.a">t.a</code></td>
<td>
<p>The dates are treated using the t distribution by default (<code>normal=FALSE</code>).
The t-distribution has two parameters, t.a and t.b, set at 3 and 4 by default (see Christen and Perez, 2009).
If you want to assign narrower error distributions (more closely resembling the normal distribution), set t.a and t.b at for example 33 and 34 respectively (e.g., for specific dates in your .csv file).
For symmetry reasons, t.a must always be equal to t.b-1.</p>
</td></tr>
<tr><td><code id="Plum_+3A_t.b">t.b</code></td>
<td>
<p>The dates are treated using the t distribution by default (<code>normal=FALSE</code>).
The t-distribution has two parameters, t.a and t.b, set at 3 and 4 by default (see Christen and Perez, 2010).
If you want to assign narrower error distributions (more closely resembling the normal distribution), set t.a and t.b at for example 33 and 34 respectively (e.g., for specific dates in your .csv file).
For symmetry reasons, t.a must always be equal to t.b-1.</p>
</td></tr>
<tr><td><code id="Plum_+3A_normal">normal</code></td>
<td>
<p>By default, Plum uses the t-distribution to treat the dates. Use <code>normal=TRUE</code> to use the normal/Gaussian distribution. This will generally give higher weight to the dates.</p>
</td></tr>
<tr><td><code id="Plum_+3A_suggest">suggest</code></td>
<td>
<p>If initial analysis of the data indicates abnormally slow or fast accumulation rates, Plum will suggest to change the prior.
Also, if the length of the core would cause too few or too many sections with the default settings, Plum will suggest an alternative section thickness <code>thick</code>, and it will suggest approaches to estimating supported Pb-120. 
Accept these suggested alternative settings by typing &quot;y&quot; (or &quot;yes please&quot; if you prefer to be polite), or leave as is by typing &quot;n&quot; (or anything else, really). To get rid of these suggestions, use <code>suggest=FALSE</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_reswarn">reswarn</code></td>
<td>
<p>Plum will warn you if the number of sections lies outside the safe range (default between 10 and 200 sections;
<code>reswarn=c(10,200)</code>). Too few sections could lead to an &lsquo;elbowy&rsquo; model while with too many sections the modelling process can get lost,
resulting in age-models far away from the dated depths.</p>
</td></tr>
<tr><td><code id="Plum_+3A_remember">remember</code></td>
<td>
<p>Plum will try to remember which settings you have applied to your cores (default <code>remember=TRUE</code>). If you run into inconsistencies or other problems,
try running your core again with <code>remember=FALSE</code>, or, start cleanly by typing <code>Plum.cleanup()</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_ask">ask</code></td>
<td>
<p>By default Plum will ask you to confirm that you want to run the core with the provided settings. Disable this using <code>ask=FALSE</code> (e.g., for batch runs).</p>
</td></tr>
<tr><td><code id="Plum_+3A_run">run</code></td>
<td>
<p>In order to load an existing Plum run instead of producing a new one, you can use <code>run=FALSE</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_defaults">defaults</code></td>
<td>
<p>Name of the file containing settings for the core. For internal use only - do not change.</p>
</td></tr>
<tr><td><code id="Plum_+3A_sep">sep</code></td>
<td>
<p>Separator between the fields of the plain text file containing the dating information. Default <code>sep=","</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_dec">dec</code></td>
<td>
<p>Character for decimal points. Default to <code>dec="."</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_runname">runname</code></td>
<td>
<p>Text to add to the corename for specific runs, e.g., <code>runname="MyCore_Test1"</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_slump">slump</code></td>
<td>
<p>Upper and lower depths of any sections of assumed abrupt accumulation, that require excising before age-modelling (and adding after age-modelling). Requires pairs of depths, e.g., <code>slump=c(10,15,60,67)</code> for slumps at 67-60 and 15-10 cm core depth.</p>
</td></tr>
<tr><td><code id="Plum_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in cal BP (calendar or calibrated years before the present, where the present is AD 1950) by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_ssize">ssize</code></td>
<td>
<p>The approximate amount of iterations to store at the end of the MCMC run. Default 2000; decrease for faster (but less reliable) runs or increase for cores where the MCMC mixing (panel at upper-left corner of age-model graph) appears problematic.</p>
</td></tr>
<tr><td><code id="Plum_+3A_th0">th0</code></td>
<td>
<p>Starting years for the MCMC iterations.</p>
</td></tr>
<tr><td><code id="Plum_+3A_burnin">burnin</code></td>
<td>
<p>Amount of initial, likely sub-optimal MCMC iterations that will be removed.</p>
</td></tr>
<tr><td><code id="Plum_+3A_minage">MinAge</code></td>
<td>
<p>Deprecated - use youngest.age instead.</p>
</td></tr>
<tr><td><code id="Plum_+3A_youngest.age">youngest.age</code></td>
<td>
<p>Minimum age limit for Bacon runs, default at current year in cal BP. To set plot limits, use <code>age.min</code> instead.</p>
</td></tr>
<tr><td><code id="Plum_+3A_maxage">MaxAge</code></td>
<td>
<p>Deprecated - use oldest.age instead.</p>
</td></tr>
<tr><td><code id="Plum_+3A_oldest.age">oldest.age</code></td>
<td>
<p>Maximum age limit for Bacon runs, default at 1,000,000 cal BP. To set plot limits, use <code>age.max</code> instead.</p>
</td></tr>
<tr><td><code id="Plum_+3A_cutoff">cutoff</code></td>
<td>
<p>Avoid plotting very low probabilities of date distributions (default <code>cutoff=0.001</code>).</p>
</td></tr>
<tr><td><code id="Plum_+3A_rounded">rounded</code></td>
<td>
<p>Rounding of calendar years. Defaults to 1 decimal.</p>
</td></tr>
<tr><td><code id="Plum_+3A_plot.pdf">plot.pdf</code></td>
<td>
<p>Produce a pdf file of the age-depth plot. Defaults to <code>plot.pdf=TRUE</code> after a Plum run.</p>
</td></tr>
<tr><td><code id="Plum_+3A_dark">dark</code></td>
<td>
<p>Darkness of the greyscale age-depth model. The darkest grey value is <code>dark=1</code> by default.
Lower values will result in lighter grey but values &gt;1 are not allowed.</p>
</td></tr>
<tr><td><code id="Plum_+3A_date.res">date.res</code></td>
<td>
<p>Date distributions are plotted using <code>date.res=100</code> segments by default.</p>
</td></tr>
<tr><td><code id="Plum_+3A_age.res">age.res</code></td>
<td>
<p>Resolution or amount of greyscale pixels to cover the age scale of the age-model plot. Default <code>yr.res=200</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_close.connections">close.connections</code></td>
<td>
<p>Internal option to close connections after a run. Default <code>close.connections=TRUE</code>.</p>
</td></tr>
<tr><td><code id="Plum_+3A_save.info">save.info</code></td>
<td>
<p>By default, a variable called &lsquo;info&rsquo; with relevant information about the run (e.g., core name, priors, settings, ages, output) is saved into the working directory. Note that this will overwrite any existing variable with the same name - as an alternative, one could run, e.g., <code>myvar &lt;- Bacon()</code>, followed by supplying the variable <code>myvar</code> in any subsequent commands.</p>
</td></tr>
<tr><td><code id="Plum_+3A_older.than">older.than</code></td>
<td>
<p>an option to enable dates at the limit of C-14 dating. If there are older.than dates (works only for non-210Pb data), they tell us that the core should be older than a certain age at that depth. For example, if the 7th and 8th dates in the core's 'otherdates' .csv file are older-than dates, use as <code>older.than=c(7,8)</code>. The MCMC run could be problematic if the older-than ages do not fit with the other information.</p>
</td></tr>
<tr><td><code id="Plum_+3A_younger.than">younger.than</code></td>
<td>
<p>an option to provide younger-than ages, for example a historical pollen marker. If there are younger-than dates (works only for non-210Pb data), they tell us that the core should be younger than a certain age at that depth. For example, if the 7th and 8th dates in the core's 'otherdates' .csv file are younger.than dates, use as <code>younger.than=c(7,8)</code>. The MCMC run could be problematic if the younger.than ages do not fit with the other information.</p>
</td></tr>
<tr><td><code id="Plum_+3A_save.elbowages">save.elbowages</code></td>
<td>
<p>If you want to have a file with the MCMC-derived ages for all the age-depth model's elbows, set <code>save.elbowages=TRUE</code> and a file with the ages will be saved in the core's folder, ending in &quot;_elbowages.txt&quot;.</p>
</td></tr>
<tr><td><code id="Plum_+3A_verbose">verbose</code></td>
<td>
<p>Provide feedback on what is happening (default <code>verbose=TRUE</code>).</p>
</td></tr>
<tr><td><code id="Plum_+3A_...">...</code></td>
<td>
<p>options for the age-depth graph. See the agedepth and calib.plot functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plum is an approach to age-depth modelling that uses Bayesian statistics in order to reconstruct
accumulation histories for 210Pb-dated deposits by taking into account prior information, and can combine 210Pb, radiocarbon and other dates (Aquino et al. 2018).
</p>
<p>Plum handles 210Pb and other dated depths within in a core, by dividing a core into many thin vertical sections (by default of <code>thick=1</code> cm thickness),
and through millions of Markov Chain Monte Carlo (MCMC) iterations estimates the flux of 210Pb and supported 210Pb, as well as 
the accumulation rate (in years/cm; so more correctly, sedimentation times) for each of these sections.
Combined with an estimated starting date for the first section, these accumulation rates and values for 210Pb then form the age-depth and 210Pb model.
The accumulation rates are constrained by prior information on the accumulation rate (<code>acc.mean, acc.shape)</code> and its
variability between neighbouring depths, or &quot;memory&quot; (<code>mem.mean, mem.strength</code>). Hiatuses can be introduced as well,
also constrained by prior information (<code>hiatus.max</code>). The 210Pb flux (phi) and supported 210Pb (s) are constrained by priors <code>phi.mean, phi.shape, s.mean and s.shape</code>.  
</p>
<p>Although Plum was developed for 210Pb dates, it can also include absolute dates (e.g., 14C, OSL, tephra or other dates on a calendar scale).
Radiocarbon dates should be calibrated using either IntCal20
(for terrestrial northern hemisphere material; Reimer et al., 2020), Marine20 (for marine dates; Hughen et al., 2020),
SHCal20 (for southern hemisphere dates; Hogg et al., 2020) or any other calibration curve (see below), while modern 14C
dates are calibrated using one of the post-bomb calibration curves (NH1, NH2 or NH3 for the northern hemisphere,
SH1-2 or SH3 for the southern hemisphere; Hua et al., 2022). See <a href="http://calib.org/CALIBomb/">http://calib.org/CALIBomb/</a> if you are unsure which
postbomb curve you need. If Plum finds postbomb dates (negative 14C ages) and you haven't specified a postbomb curve,
you will be prompted. Provide postbomb curves as, e.g., <code>postbomb=1</code> for the NH1 postbomb curve (2 for NH2, 3 for NH3,
4 for SH1-2, 5 for SH3).
</p>
<p>For calendar dates, i.e. dates that are already on the calendar scale and thus should not be calibrated, set<code>cc=0</code>. 
Plum also needs the date of sampling, in AD (<code>date.sample</code>). 
</p>
<p>rplum works by calling the rbacon package. Since version 3.1.0, Bacon can also handle younger-than and older-than ages, with the model aiming to either go 'above'
or 'below' such dates as requested. If the resulting combination of parameters becomes problematic (e.g., no initial
combination of parameters can be found that obeys the priors or is in chronological order), then the output will often be wrong.
If so, using the function set.initvals could help.
</p>
<p>By default, the initial MCMC values of the Bacon age-depth model (upper ages and accumulation rate for each model section)
are estimated randomly. Since version 3.1.0, these starting values can also be provided in a file with extension _bacon.init,
placed within the core's folder. This file will need to have two rows, each for one of the two initial sets of parameters required
(the t-walk requires two starting estimates for all MCMC parameters).
If such a file is found (and correctly formatted), Bacon will use the values within this file
as starting points for the MCMC run. See function set.initvals for more information.
</p>


<h3>Value</h3>

<p>An age-depth model graph, its age estimates, a summary, and the info variable which contains all relevant information.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen, Marco A. Aquino L.
</p>


<h3>References</h3>

<p>Aquino-Lopez, M.A., Blaauw, M., Christen, J.A., Sanderson, N., 2018. Bayesian analysis of 210Pb dating. Journal of Agricultural, Biological, and Environmental Statistics 23, 317-333.
</p>
<p>Blaauw, M. and Christen, J.A., 2011. Flexible paleoclimate age-depth models using an autoregressive gamma process. Bayesian Analysis 6, 457-474.
</p>
<p>Christen, J.A., Perez E.S., 2010. A new robust statistical model for radiocarbon data. Radiocarbon 51, 1047-1059.
</p>
<p>Hogg et al., 2020. SHCal20 Southern Hemisphere calibration, 0-55,000 years cal BP. Radiocarbon 62, 759-778.
</p>
<p>Hua et al., 2022. Atmospheric radiocarbon for the period 1950-2019. Radiocarbon 64(4), 723-745, <a href="https://doi.org/10.1017/RDC.2021.95">doi:10.1017/RDC.2021.95</a>
</p>
<p>Hughen et al., 2020. Marine20-the marine radiocarbon age calibration curve (0-55,000 cal BP). Radiocarbon 62, 779-820.
</p>
<p>Jones, V.J., Stevenson, A.C., Battarbee, R.W., 1989. Acidification of lakes in Galloway, south west Scotland - a diatom and pollen study of the post-glacial history of the Round Loch of Glenhead.
Journal of Ecology 77, 1-23.
</p>
<p>Reimer et al., 2020. The IntCal20 Northern Hemisphere radiocarbon age calibration curve (0–55 cal kBP). Radiocarbon 62, 725-757.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  Plum(ask=FALSE, ssize=1000, coredir=tempfile(), date.sample=2018.5, ra.case=0, n.supp=3)

</code></pre>

<hr>
<h2 id='Plum_runs'>List the folders present in the current core directory.</h2><span id='topic+Plum_runs'></span>

<h3>Description</h3>

<p>Lists all folders located within the core's directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Plum_runs(coredir = get("info")$coredir)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Plum_runs_+3A_coredir">coredir</code></td>
<td>
<p>The directory where the Bacon runs reside. Defaults to <code>coredir="Plum_runs"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The directory is either &quot;Plum_runs&quot;, &quot;Cores&quot; or a custom-named one.
</p>


<h3>Value</h3>

<p>A list of folders
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>

<hr>
<h2 id='Plum.cleanup'>Remove files made to produce the current core's age-depth model.</h2><span id='topic+Plum.cleanup'></span>

<h3>Description</h3>

<p>Remove files .bacon, .out, .pdf, _ages.txt, and _settings.txt of current core.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Plum.cleanup(set = get("info"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Plum.cleanup_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If cores behave badly, you can try cleaning up previous runs and settings, by
removing files .bacon, .out, .pdf, _ages.txt, and _settings.txt of current core.
</p>


<h3>Value</h3>

<p>A message stating that the files and settings of this run have been deleted.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
