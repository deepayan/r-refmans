<!DOCTYPE html><html lang="en"><head><title>Help for package workloopR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {workloopR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#workloopR-package'><p>workloopR: Analysis of Work Loops and Other Data from Muscle Physiology Experiments</p></a></li>
<li><a href='#analyze_workloop'><p>Analyze work loop object to compute work and power output</p></a></li>
<li><a href='#as_muscle_stim'><p>Create your own muscle_stim object</p></a></li>
<li><a href='#fix_GR'><p>Adjust for the gear ratio of a motor arm</p></a></li>
<li><a href='#get_wl_metadata'><p>Get file info for a sequence of experiment files</p></a></li>
<li><a href='#invert_position'><p>Invert the position data</p></a></li>
<li><a href='#isometric_timing'><p>Compute timing and magnitude of force in isometric trials</p></a></li>
<li><a href='#read_analyze_wl'><p>All-in-one import function for work loop files</p></a></li>
<li><a href='#read_analyze_wl_dir'><p>Read and analyze work loop files from a directory</p></a></li>
<li><a href='#read_ddf'><p>Import work loop or isometric data from .ddf files</p></a></li>
<li><a href='#read_ddf_dir'><p>Import a batch of work loop or isometric data files from a directory</p></a></li>
<li><a href='#select_cycles'><p>Select cycles from a work loop object</p></a></li>
<li><a href='#summarize_wl_trials'><p>Summarize work loop files</p></a></li>
<li><a href='#time_correct'><p>Time correction for work loop experiments</p></a></li>
<li><a href='#trapezoidal_integration'><p>Approximate the definite integral via the trapezoidal rule</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Work Loops and Other Data from Muscle Physiology
Experiments</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for the import, transformation, and analysis of data 
    from muscle physiology experiments. The work loop technique is used to 
    evaluate the mechanical work and power output of muscle. Josephson (1985) 
    &lt;<a href="https://doi.org/10.1242%2Fjeb.114.1.493">doi:10.1242/jeb.114.1.493</a>&gt; modernized the technique for
    application in comparative biomechanics. Although our initial motivation 
    was to provide functions to analyze work loop experiment data, as we 
    developed the package we incorporated the ability to analyze data from 
    experiments that are often complementary to work loops. There are currently 
    three supported experiment types: work loops, simple twitches, and tetanus 
    trials. Data can be imported directly from .ddf files or via an object 
    constructor function. Through either method, data can then be cleaned or 
    transformed via methods typically used in studies of muscle physiology. 
    Data can then be analyzed to determine the timing and magnitude of force 
    development and relaxation (for isometric trials) or the magnitude of work, 
    net power, and instantaneous power among other things (for work loops). 
    Although we do not provide plotting functions, all resultant objects are 
    designed to be friendly to visualization via either base-R plotting or 
    'tidyverse' functions.
 This package has been peer-reviewed by rOpenSci (v. 1.1.0).</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://docs.ropensci.org/workloopR/">https://docs.ropensci.org/workloopR/</a>,
<a href="https://github.com/ropensci/workloopR/">https://github.com/ropensci/workloopR/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ropensci/workloopR/issues/">https://github.com/ropensci/workloopR/issues/</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>pracma (&ge; 2.0.7), signal (&ge; 0.7-6)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 2.1.1), knitr, rmarkdown, dplyr, ggplot2,
magrittr, purrr, tidyr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1.9000</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-05-05 01:12:54 UTC; vbali</td>
</tr>
<tr>
<td>Author:</td>
<td>Vikram B. Baliga <a href="https://orcid.org/0000-0002-9367-8974"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Shreeram Senthivasan
    <a href="https://orcid.org/0000-0002-7118-9547"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Julia Romanowska [rev] (Julia reviewed the package for rOpenSci , see
    &lt;https://github.com/ropensci/software-review/issues/326/&gt;),
  Eric Brown [rev] (Eric reviewed the package for rOpenSci , see
    &lt;https://github.com/ropensci/software-review/issues/326/&gt;)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Vikram B. Baliga &lt;vbaliga87@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-05-06 08:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='workloopR-package'>workloopR: Analysis of Work Loops and Other Data from Muscle Physiology Experiments</h2><span id='topic+workloopR'></span><span id='topic+workloopR-package'></span>

<h3>Description</h3>

<p>Functions for the import, transformation, and analysis of data 
from muscle physiology experiments. The work loop technique is used to 
evaluate the mechanical work and power output of muscle. Josephson (1985) 
&lt;doi:10.1242/jeb.114.1.493&gt; modernized the technique for
application in comparative biomechanics. Although our initial motivation 
was to provide functions to analyze work loop experiment data, as we 
developed the package we incorporated the ability to analyze data from 
experiments that are often complementary to work loops. There are currently 
three supported experiment types: work loops, simple twitches, and tetanus 
trials. Data can be imported directly from .ddf files or via an object 
constructor function. Through either method, data can then be cleaned or 
transformed via methods typically used in studies of muscle physiology. 
Data can then be analyzed to determine the timing and magnitude of force 
development and relaxation (for isometric trials) or the magnitude of work, 
net power, and instantaneous power among other things (for work loops). 
Although we do not provide plotting functions, all resultant objects are 
designed to be friendly to visualization via either base-R plotting or 
'tidyverse' functions.
This package has been peer-reviewed by rOpenSci (v. 1.1.0).
</p>


<h3>Details</h3>

<p>Functions for the import, transformation, and analysis of muscle physiology
experiments. Currently supported experiment types: work loop, simple twitch,
and tetanus.
</p>
<p>Data that are stored in .ddf format (e.g. generated by Aurora Scientific's
Dynamic Muscle Control and Analysis Software) are easily imported via
<code>read_ddf()</code>, <code>read_analyze_wl()</code>, or <code>read_analyze_wl_dir()</code>.
Doing so generates objects of class <code>muscle_stim</code>, which are formatted
to work nicely with workloopR's core functions. Data that are read from other
file formats can be constructed into <code>muscle_stim</code> objects via
<code>as_muscle_stim()</code>.
</p>
<p>Prior to analyses, data can be transformed or corrected. Transformational
functions include gear ratio correction (<code>fix_GR()</code>), position inversion
(<code>invert_position()</code>), and subsetting of particular cycles within a work
loop experiment (<code>select_cycles()</code>).
</p>
<p>Core data analytical functions include <code>analyze_workloop()</code> for work
loop files and <code>isometric_timing()</code> for twitches.
<code>analyze_workloop()</code> computes instantaneous velocity, net work,
instantaneous power, and net power for work loop experiments on a per-cycle
basis. <code>isometric_timing()</code> provides summarization of twitch kinetics.
</p>
<p>Some functions are readily available for batch processing of files. The
<code>read_analyze_wl_dir()</code> function allows for the batch import, cycle
selection, gear ratio correction, and ultimately work &amp; power computation for
all work loop experiment files within a specified directory. The
<code>get_wl_metadata()</code> and <code>summarize_wl_trials()</code> functions organize
scanned files by recency (according to their time of last modification:
'mtime') and then report work and power output in the order that trials were
run. This ultimately allows for the <code>time_correct()</code> function to correct
for degradation of the muscle (according to power &amp; work) over time,
assuming that the first and final trials are identical in experimental
parameters.
</p>
<p>Please feel free to contact either Vikram or Shree with suggestions or code
development requests (see contact info below). We are especially interested
in expanding our data import functions to accommodate file types other than
.ddf in future versions of workloopR.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Vikram B. Baliga <a href="mailto:vbaliga87@gmail.com">vbaliga87@gmail.com</a> (<a href="https://orcid.org/0000-0002-9367-8974">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Shreeram Senthivasan <a href="mailto:shreeramsenthi@gmail.com">shreeramsenthi@gmail.com</a> (<a href="https://orcid.org/0000-0002-7118-9547">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Julia Romanowska <a href="mailto:Julia.Romanowska@uib.no">Julia.Romanowska@uib.no</a> (Julia reviewed the package for rOpenSci
, see &lt;https://github.com/ropensci/software-review/issues/326/&gt;) [reviewer]
</p>
</li>
<li><p> Eric Brown <a href="mailto:eb@ericebrown.com">eb@ericebrown.com</a> (Eric reviewed the package for rOpenSci
, see &lt;https://github.com/ropensci/software-review/issues/326/&gt;) [reviewer]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://docs.ropensci.org/workloopR/">https://docs.ropensci.org/workloopR/</a>
</p>
</li>
<li> <p><a href="https://github.com/ropensci/workloopR/">https://github.com/ropensci/workloopR/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ropensci/workloopR/issues/">https://github.com/ropensci/workloopR/issues/</a>
</p>
</li></ul>


<hr>
<h2 id='analyze_workloop'>Analyze work loop object to compute work and power output</h2><span id='topic+analyze_workloop'></span>

<h3>Description</h3>

<p>Compute work and power output from a work loop experiment on a per-cycle
basis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>analyze_workloop(x, simplify = FALSE, GR = 1, M = -1, vel_bf = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="analyze_workloop_+3A_x">x</code></td>
<td>
<p>A <code>workloop</code> object of class <code>muscle_stim</code> that has been
passed through
<code>select_cycles</code>. See Details.</p>
</td></tr>
<tr><td><code id="analyze_workloop_+3A_simplify">simplify</code></td>
<td>
<p>Logical. If <code>FALSE</code>, the full analyzed workloop
object is returned. If <code>TRUE</code> a simpler table of net work and power
(by cycle) is returned.</p>
</td></tr>
<tr><td><code id="analyze_workloop_+3A_gr">GR</code></td>
<td>
<p>Gear ratio, set to 1 by default</p>
</td></tr>
<tr><td><code id="analyze_workloop_+3A_m">M</code></td>
<td>
<p>Velocity multiplier, set adjust the sign of velocity. This parameter
should generally be either -1 (the default) or 1.</p>
</td></tr>
<tr><td><code id="analyze_workloop_+3A_vel_bf">vel_bf</code></td>
<td>
<p>Critical frequency (scalar) for low-pass filtering of velocity
via <code>signal::butter()</code></p>
</td></tr>
<tr><td><code id="analyze_workloop_+3A_...">...</code></td>
<td>
<p>Additional arguments potentially passed down from
<code>read_analyze_wl()</code> or <code>read_analyze_wl_dir()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please note that <code>select_cycles()</code> must be run on data prior to
using this function. This function relies on the input <code>muscle_stim</code>
object being organized by cycle number.
</p>
<p>The <code>muscle_stim</code> object (<code>x</code>) must be a <code>workloop</code>,
preferably read in by one of our data import functions. Please see
documentation for <code>as_muscle_stim()</code> if you need to manually construct
a <code>muscle_stim</code> object from a non .ddf source.
</p>
<p>The gear ratio (GR) and velocity multiplier (M) parameters can help correct
for issues related to the magnitude and sign of data collection. By default,
they are set to apply no gear ratio adjustment and to positivize velocity.
Instantaneous velocity is often noisy and the <code>vel_bf</code> parameter allows
for low-pass filtering of velocity data. See <code>signal::butter()</code> and
<code>signal::filtfilt()</code> for details of how filtering is achieved.
</p>
<p>Please also be careful with units! Se Warning section below.
</p>


<h3>Value</h3>

<p>The function returns a <code>list</code> of class <code>analyzed_workloop</code>
that provides instantaneous velocity, a smoothed velocity, and computes work,
instantaneous power, and net power from a work loop experiment. All data are
organized by the cycle number and important metadata are stored as
Attributes.
</p>
<p>Within the <code>list</code>, each entry is labeled by cycle and includes:
</p>
<table role = "presentation">
<tr><td><code>Time</code></td>
<td>
<p>Time, in sec</p>
</td></tr>
<tr><td><code>Position</code></td>
<td>
<p>Length change of the muscle, corrected for gear ratio, in mm</p>
</td></tr>
<tr><td><code>Force</code></td>
<td>
<p>Force, corrected for gear ratio, in mN</p>
</td></tr>
<tr><td><code>Stim</code></td>
<td>
<p>When stimulation occurs, on a binary scale</p>
</td></tr>
<tr><td><code>Cycle</code></td>
<td>
<p>Cycle ID, as a letter</p>
</td></tr>
<tr><td><code>Inst_velocity</code></td>
<td>
<p>Instantaneous velocity, computed from <code>Position</code>
change, reported in meters/sec</p>
</td></tr>
<tr><td><code>Filt_velocity</code></td>
<td>
<p>Instantaneous velocity, after low-pass filtering, again
in meter/sec</p>
</td></tr>
<tr><td><code>Inst_Power</code></td>
<td>
<p>Instantaneous power, a product of <code>Force</code> and
<code>Filt_velocity</code>, reported in J</p>
</td></tr>
<tr><td><code>Percent_of_Cycle</code></td>
<td>
<p>The percent of that particular cycle which has
elapsed</p>
</td></tr>
</table>
<p>In addition, the following information is stored in the
<code>analyzed_workloop</code> object's attributes:
</p>
<table role = "presentation">
<tr><td><code>stimulus_frequency</code></td>
<td>
<p>Frequency at which stimulus pulses occurred</p>
</td></tr>
<tr><td><code>cycle_frequency</code></td>
<td>
<p>Frequency of oscillations (assuming sine wave
trajectory)</p>
</td></tr>
<tr><td><code>total_cycles</code></td>
<td>
<p>Total number of oscillatory cycles (assuming sine wave
trajectory) that the muscle experienced.</p>
</td></tr>
<tr><td><code>cycle_def</code></td>
<td>
<p>Specifies what part of the cycle is understood as the
beginning and end. There are currently three options:
'lo' for L0-to-L0;
'p2p' for peak-to-peak; and
't2t' for trough-to-trough</p>
</td></tr>
<tr><td><code>amplitude</code></td>
<td>
<p>Amplitude of length change (assuming sine wave
trajectory)</p>
</td></tr>
<tr><td><code>phase</code></td>
<td>
<p>Phase of the oscillatory cycle (in percent) at which stimulation
occurred. Somewhat experimental, please use with caution</p>
</td></tr>
<tr><td><code>position_inverted</code></td>
<td>
<p>Logical; whether position inversion has been
applied)</p>
</td></tr>
<tr><td><code>units</code></td>
<td>
<p>The units of measurement for each column in the object after
running this function. See Warning</p>
</td></tr>
<tr><td><code>sample_frequency</code></td>
<td>
<p>Frequency at which samples were collected</p>
</td></tr>
<tr><td><code>header</code></td>
<td>
<p>Additional information from the header</p>
</td></tr>
<tr><td><code>units_table</code></td>
<td>
<p>Units from each Channel of the original ddf file</p>
</td></tr>
<tr><td><code>protocol_table</code></td>
<td>
<p>Protocol in tabular format; taken from the original
ddf file</p>
</td></tr>
<tr><td><code>stim_table</code></td>
<td>
<p>Specific info on stimulus protocol; taken from the original
ddf file</p>
</td></tr>
<tr><td><code>stimulus_pulses</code></td>
<td>
<p>Number of sequential pulses within a stimulation
train</p>
</td></tr>
<tr><td><code>stimulus_offset</code></td>
<td>
<p>Timing offset at which stimulus began</p>
</td></tr>
<tr><td><code>gear_ratio</code></td>
<td>
<p>Gear ratio applied by this function</p>
</td></tr>
<tr><td><code>file_id</code></td>
<td>
<p>File name</p>
</td></tr>
<tr><td><code>mtime</code></td>
<td>
<p>Time at which file was last modified</p>
</td></tr>
<tr><td><code>retained_cycles</code></td>
<td>
<p>Which cycles were retained, as numerics</p>
</td></tr>
<tr><td><code>summary</code></td>
<td>
<p>Simple table showing work (in J) and net power (in W) for each
cycle</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>Most systems we have encountered record Position data in millimeters
and Force in millinewtons, and therefore this function assumes data are
recorded in those units. Through a series of internal conversions, this
function computes velocity in meters/sec, work in Joules, and power in
Watts. If your raw data do not originate in millimeters and millinewtons,
please transform your data accordingly and ignore what you see in the
attribute <code>units</code>.
</p>


<h3>Author(s)</h3>

<p>Vikram B. Baliga and Shreeram Senthivasan
</p>


<h3>References</h3>

<p>Josephson RK. 1985. Mechanical Power output from Striated Muscle
during Cyclic Contraction. Journal of Experimental Biology 114: 493-512.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read_ddf">read_ddf</a></code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a></code>,
<code><a href="#topic+select_cycles">select_cycles</a></code>
</p>
<p>Other data analyses: 
<code><a href="#topic+isometric_timing">isometric_timing</a>()</code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a>()</code>
</p>
<p>Other workloop functions: 
<code><a href="#topic+fix_GR">fix_GR</a>()</code>,
<code><a href="#topic+get_wl_metadata">get_wl_metadata</a>()</code>,
<code><a href="#topic+invert_position">invert_position</a>()</code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a>()</code>,
<code><a href="#topic+select_cycles">select_cycles</a>()</code>,
<code><a href="#topic+summarize_wl_trials">summarize_wl_trials</a>()</code>,
<code><a href="#topic+time_correct">time_correct</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workloopR)

# import the workloop.ddf file included in workloopR
wl_dat &lt;-read_ddf(system.file("extdata", "workloop.ddf",
                              package = 'workloopR'),
                  phase_from_peak = TRUE)

# select cycles 3 through 5 via the peak-to-peak definition
wl_selected &lt;- select_cycles(wl_dat, cycle_def = "p2p", keep_cycles = 3:5)

# run the analysis function and get the full object
wl_analyzed &lt;- analyze_workloop(wl_selected, GR = 2)

# print methods give a short summary
print(wl_analyzed)

# summary provides a bit more detail
summary(wl_analyzed)

# run the analysis but get the simplified version
wl_analyzed_simple &lt;- analyze_workloop(wl_selected, simplify = TRUE, GR = 2)

</code></pre>

<hr>
<h2 id='as_muscle_stim'>Create your own muscle_stim object</h2><span id='topic+as_muscle_stim'></span>

<h3>Description</h3>

<p>For use when data are not stored in .ddf format and you would like
to create a <code>muscle_stim</code> object that can be used by other workloopR
functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_muscle_stim(x, type, sample_frequency, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_muscle_stim_+3A_x">x</code></td>
<td>
<p>A <code>data.frame</code>. See Details for how it should be organized.</p>
</td></tr>
<tr><td><code id="as_muscle_stim_+3A_type">type</code></td>
<td>
<p>Experiment type; must be one of: &quot;workloop&quot;, &quot;tetanus&quot;, or
&quot;twitch.&quot;</p>
</td></tr>
<tr><td><code id="as_muscle_stim_+3A_sample_frequency">sample_frequency</code></td>
<td>
<p>Numeric value of the frequency at which samples were
recorded; must be in Hz. Please format as numeric, e.g. <code>10000</code> works
but <code>10000 Hz</code> does not</p>
</td></tr>
<tr><td><code id="as_muscle_stim_+3A_...">...</code></td>
<td>
<p>Additional arguments that can be passed in as attributes. See
Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>muscle_stim</code> objects, which are required by (nearly) all
workloopR functions, are automatically created via <code>read_ddf()</code>. Should
you have data that are stored in a format other than .ddf, use this function
to create your own object of class <code>muscle_stim</code>.
</p>
<p>The input <code>x</code> must be a <code>data.frame</code> that contains time series
of numeric data collected from an experiment. Each row must correspond to a
sample, and these columns (exact title matches) must be included: <br />
&quot;Time&quot; - time, recorded in seconds <br />
&quot;Position&quot; - instantaneous position of the muscle,
preferably in millimeters <br />
&quot;Force&quot; - force, preferably in millinewtons <br />
&quot;Stim&quot; - whether stimulation has occurred. All entries must be either 0 (no
stimulus) or 1 (stimulus occurrence).
</p>
<p>Additional arguments can be provided via <code>...</code>. For all experiment
types, the following attributes are appropriate: <br />
&quot;units&quot;,&quot;header&quot;, &quot;units_table&quot;,
&quot;protocol_table&quot;, &quot;stim_table&quot;,
&quot;stimulus_pulses&quot;, &quot;stimulus_offset&quot;,
&quot;stimulus_width&quot;, &quot;gear_ratio&quot;,
&quot;file_id&quot;, or &quot;mtime&quot;.
</p>
<p>Please ensure that further attributes are appropriate to your experiment
type.
</p>
<p>For workloops, these include:
&quot;stimulus_frequency&quot;, &quot;cycle_frequency&quot;,
&quot;total_cycles&quot;, &quot;cycle_def&quot;,
&quot;amplitude&quot;, &quot;phase&quot;,
and &quot;position_inverted&quot;
</p>
<p>For twitches or tetanic trials:
&quot;stimulus_frequency&quot;, and &quot;stimulus_length&quot;
</p>


<h3>Value</h3>

<p>An object of class <code>workloop</code>, <code>twitch</code>, or <code>tetanus</code>,
all of which inherit class <code>muscle_stim</code>. These objects behave like
<code>data.frames</code> in most situations but also store metadata from the ddf
as attributes.
</p>
<p>The <code>muscle_stim</code> object's columns contain:
</p>
<table role = "presentation">
<tr><td><code>Time</code></td>
<td>
<p>Time</p>
</td></tr>
<tr><td><code>Position</code></td>
<td>
<p>Length change of the muscle, uncorrected for gear ratio</p>
</td></tr>
<tr><td><code>Force</code></td>
<td>
<p>Force, uncorrected for gear ratio</p>
</td></tr>
<tr><td><code>Stim</code></td>
<td>
<p>When stimulation occurs, on a binary scale</p>
</td></tr>
</table>
<p>In addition, the following information is stored in the <code>data.frame</code>'s
attributes:
</p>
<table role = "presentation">
<tr><td><code>sample_frequency</code></td>
<td>
<p>Frequency at which samples were collected</p>
</td></tr>
<tr><td><code>pulses</code></td>
<td>
<p>Number of sequential pulses within a stimulation train</p>
</td></tr>
<tr><td><code>total_cycles_lo</code></td>
<td>
<p>Total number of oscillatory cycles (assuming sine
wave trajectory) that the muscle experienced. Cycles are defined with respect
to initial muscle length (L0-to-L0 as opposed to peak-to-peak).</p>
</td></tr>
<tr><td><code>amplitude</code></td>
<td>
<p>amplitude of length change (again, assuming sine wave
trajectory)</p>
</td></tr>
<tr><td><code>cycle_frequency</code></td>
<td>
<p>Frequency of oscillations (again, assuming sine wave
trajectory)</p>
</td></tr>
<tr><td><code>units</code></td>
<td>
<p>The units of measurement for each column in the
<code>data.frame</code>. This might be the most important attribute so please check
that it makes sense!</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Shreeram Senthivasan
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read_ddf">read_ddf</a></code>
</p>
<p>Other data import functions: 
<code><a href="#topic+get_wl_metadata">get_wl_metadata</a>()</code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a>()</code>,
<code><a href="#topic+read_ddf_dir">read_ddf_dir</a>()</code>,
<code><a href="#topic+read_ddf">read_ddf</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workloopR)

# import the workloop.ddf file included in workloopR
wl_dat &lt;-read_ddf(system.file("extdata", "workloop.ddf",
                              package = 'workloopR'))


</code></pre>

<hr>
<h2 id='fix_GR'>Adjust for the gear ratio of a motor arm</h2><span id='topic+fix_GR'></span>

<h3>Description</h3>

<p>Fix a discrepancy between the gear ratio of the motor arm used and the gear
ratio recorded by software.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fix_GR(x, GR = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fix_GR_+3A_x">x</code></td>
<td>
<p>A <code>muscle_stim</code> object</p>
</td></tr>
<tr><td><code id="fix_GR_+3A_gr">GR</code></td>
<td>
<p>Gear ratio, set to 1 by default</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>muscle_stim</code> object can be of any type, including
<code>workloop</code>, <code>twitch</code>, or <code>tetanus</code>.
</p>
<p>If you have manually constructed the object via <code>as_muscle_stim()</code>,
the <code>muscle_stim</code> object should have columns as follows: <br />
<code>Position</code>: length change of the muscle; <br />
<code>Force</code>: force <br />
</p>


<h3>Value</h3>

<p>An object of the same class(es) as the input (<code>x</code>). The function
will multiply <code>Position</code> by (1/GR) and multiply <code>Force</code> by GR,
returning an object with new values in <code>$Position</code> and <code>$Force</code>.
Other columns and attributes are welcome and will simply be passed on
unchanged into the resulting object.
</p>


<h3>Author(s)</h3>

<p>Vikram B. Baliga
</p>


<h3>See Also</h3>

<p><code><a href="#topic+analyze_workloop">analyze_workloop</a></code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a></code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a></code>
</p>
<p>Other data transformations: 
<code><a href="#topic+invert_position">invert_position</a>()</code>,
<code><a href="#topic+select_cycles">select_cycles</a>()</code>
</p>
<p>Other workloop functions: 
<code><a href="#topic+analyze_workloop">analyze_workloop</a>()</code>,
<code><a href="#topic+get_wl_metadata">get_wl_metadata</a>()</code>,
<code><a href="#topic+invert_position">invert_position</a>()</code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a>()</code>,
<code><a href="#topic+select_cycles">select_cycles</a>()</code>,
<code><a href="#topic+summarize_wl_trials">summarize_wl_trials</a>()</code>,
<code><a href="#topic+time_correct">time_correct</a>()</code>
</p>
<p>Other twitch functions: 
<code><a href="#topic+invert_position">invert_position</a>()</code>,
<code><a href="#topic+isometric_timing">isometric_timing</a>()</code>
</p>
<p>Other tetanus functions: 
<code><a href="#topic+invert_position">invert_position</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workloopR)

# import the workloop.ddf file included in workloopR
wl_dat &lt;-read_ddf(system.file("extdata", "workloop.ddf",
                              package = 'workloopR'),
                  phase_from_peak = TRUE)

# apply a gear ratio correction of 2
# this will multiply Force by 2 and divide Position by 2
wl_fixed &lt;- fix_GR(wl_dat, GR = 2)

# quick check:
max(wl_fixed$Force) / max(wl_dat$Force) # 5592.578 / 2796.289 = 2
max(wl_fixed$Position) / max(wl_dat$Position) # 1.832262 / 3.664524 = 0.5

</code></pre>

<hr>
<h2 id='get_wl_metadata'>Get file info for a sequence of experiment files</h2><span id='topic+get_wl_metadata'></span>

<h3>Description</h3>

<p>Grab metadata from files stored in the same folder (e.g. a sequence of trials
in an experiment).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_wl_metadata(file_path, pattern = "*.ddf")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_wl_metadata_+3A_file_path">file_path</code></td>
<td>
<p>Path where files are stored. Should be in the same folder.</p>
</td></tr>
<tr><td><code id="get_wl_metadata_+3A_pattern">pattern</code></td>
<td>
<p>Regex pattern for identifying relevant files in the file_path.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If several files (e.g. successive trials from one experiment) are
stored in one folder, use this function to obtain metadata in a list
format. Runs <code>file.info()</code> from base R to extract info from files.
</p>
<p>This function is not truly considered to be part of the batch analysis
pipeline;
see <code>read_analyze_wl_dir()</code> for a similar function that not
only grabs metadata but also imports &amp; analyzes files. Instead,
<code>get_wl_metadata()</code> is meant to be a handy function to investigate
metadata issues that arise if running <code>read_analyze_wl_dir()</code> goes awry.
</p>
<p>Unlike <code>read_analyze_wl_dir()</code>, this function does not necessarily need
files to all be work loops. Any file type is welcome (as long as the Regex
<code>pattern</code> argument makes sense).
</p>


<h3>Value</h3>

<p>Either a <code>data.frame</code> (if a single file is supplied) or a
<code>list</code> of <code>data.frame</code>s (if a list of files is supplied), with
information as supplied from <code>file.info()</code>.
</p>


<h3>Author(s)</h3>

<p>Vikram B. Baliga
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summarize_wl_trials">summarize_wl_trials</a></code>
</p>
<p>Other data import functions: 
<code><a href="#topic+as_muscle_stim">as_muscle_stim</a>()</code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a>()</code>,
<code><a href="#topic+read_ddf_dir">read_ddf_dir</a>()</code>,
<code><a href="#topic+read_ddf">read_ddf</a>()</code>
</p>
<p>Other workloop functions: 
<code><a href="#topic+analyze_workloop">analyze_workloop</a>()</code>,
<code><a href="#topic+fix_GR">fix_GR</a>()</code>,
<code><a href="#topic+invert_position">invert_position</a>()</code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a>()</code>,
<code><a href="#topic+select_cycles">select_cycles</a>()</code>,
<code><a href="#topic+summarize_wl_trials">summarize_wl_trials</a>()</code>,
<code><a href="#topic+time_correct">time_correct</a>()</code>
</p>
<p>Other batch analyses: 
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>,
<code><a href="#topic+summarize_wl_trials">summarize_wl_trials</a>()</code>,
<code><a href="#topic+time_correct">time_correct</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workloopR)

# get file info for files included with workloopR
wl_meta &lt;- get_wl_metadata(system.file("extdata/wl_duration_trials",
                                       package = 'workloopR'))

</code></pre>

<hr>
<h2 id='invert_position'>Invert the position data</h2><span id='topic+invert_position'></span>

<h3>Description</h3>

<p>Multiply instantaneous position by -1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>invert_position(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="invert_position_+3A_x">x</code></td>
<td>
<p>A <code>muscle_stim</code> object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>muscle_stim</code> object can be of any type, including
<code>workloop</code>, <code>twitch</code>, or <code>tetanus</code>.
</p>
<p>If you have manually constructed the object via <code>as_muscle_stim()</code>,
the <code>muscle_stim</code> object should have a column entitled <code>Position</code>.
Other columns and attributes are welcome and will be passed along unchanged.
</p>


<h3>Value</h3>

<p>A <code>workloop</code> object with inverted position. The
<code>position_inverted</code> attribute is set to <code>TRUE</code> and all others are
retained.
</p>


<h3>Author(s)</h3>

<p>Vikram B. Baliga
</p>


<h3>See Also</h3>

<p>Other data transformations: 
<code><a href="#topic+fix_GR">fix_GR</a>()</code>,
<code><a href="#topic+select_cycles">select_cycles</a>()</code>
</p>
<p>Other workloop functions: 
<code><a href="#topic+analyze_workloop">analyze_workloop</a>()</code>,
<code><a href="#topic+fix_GR">fix_GR</a>()</code>,
<code><a href="#topic+get_wl_metadata">get_wl_metadata</a>()</code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a>()</code>,
<code><a href="#topic+select_cycles">select_cycles</a>()</code>,
<code><a href="#topic+summarize_wl_trials">summarize_wl_trials</a>()</code>,
<code><a href="#topic+time_correct">time_correct</a>()</code>
</p>
<p>Other twitch functions: 
<code><a href="#topic+fix_GR">fix_GR</a>()</code>,
<code><a href="#topic+isometric_timing">isometric_timing</a>()</code>
</p>
<p>Other tetanus functions: 
<code><a href="#topic+fix_GR">fix_GR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workloopR)

# import the workloop.ddf file included in workloopR
wl_dat &lt;-read_ddf(system.file("extdata", "workloop.ddf",
                              package = 'workloopR'),
                  phase_from_peak = TRUE)

# invert the sign of Position
wl_fixed &lt;- invert_position(wl_dat)

# quick check:
max(wl_fixed$Position) / min(wl_dat$Position) # -1

</code></pre>

<hr>
<h2 id='isometric_timing'>Compute timing and magnitude of force in isometric trials</h2><span id='topic+isometric_timing'></span>

<h3>Description</h3>

<p>Calculate timing and magnitude of force at stimulation, peak force, and
various parts of the rising (force development) and relaxation (falling)
phases of the twitch.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isometric_timing(x, rising = c(10, 90), relaxing = c(90, 50))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isometric_timing_+3A_x">x</code></td>
<td>
<p>A <code>muscle_stim</code> object that contains data from an isometric
twitch trial, ideally created via <code>read_ddf</code>.</p>
</td></tr>
<tr><td><code id="isometric_timing_+3A_rising">rising</code></td>
<td>
<p>Set points of the rising phase to be described.
By default: 10% and 90%.</p>
</td></tr>
<tr><td><code id="isometric_timing_+3A_relaxing">relaxing</code></td>
<td>
<p>Set points of the relaxation phase to be described.
By default: 90% and 50%.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>data.frame</code> (x) must have time series data organized in
columns. Generally, it is preferred that you use a <code>muscle_stim</code> object
imported by <code>read_ddf()</code>.
</p>
<p>The <code>rising</code> and <code>relaxing</code> arguments allow for the user to supply
numeric vectors of any length. By default, these arguments are
<code>rising = c(10, 90)</code> and <code>relaxing  = c(90, 50)</code>. Numbers in each
of these correspond to percent values and capture time and force at that
percent of the corresponding curve. These values can be replaced by those
that the user specifies and do not necessarily need to have length = 2. But
please note that 0 and 100 should not be used, e.g.
<code>rising = seq(10, 90, 5)</code> works, but <code>rising = seq(0, 100, 5)</code>
does not.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with the following metrics as columns:
</p>
<table role = "presentation">
<tr><td><code>file_ID</code></td>
<td>
<p>File ID</p>
</td></tr>
<tr><td><code>time_stim</code></td>
<td>
<p>Time between beginning of data collection and when
stimulation occurs</p>
</td></tr>
<tr><td><code>force_stim</code></td>
<td>
<p>Magnitude of force at the onset of stimulation</p>
</td></tr>
<tr><td><code>time_peak</code></td>
<td>
<p>Absolute time of peak force, i.e. time between beginning of
data collection and when peak force occurs</p>
</td></tr>
<tr><td><code>force_peak</code></td>
<td>
<p>Magnitude of peak force</p>
</td></tr>
<tr><td><code>time_rising_X</code></td>
<td>
<p>Time between beginning of data collection and X% of
force development</p>
</td></tr>
<tr><td><code>force_rising_X</code></td>
<td>
<p>Magnitude of force at X% of force development</p>
</td></tr>
<tr><td><code>time_relaxing_X</code></td>
<td>
<p>Time between beginning of data collection and X% of
force relaxation</p>
</td></tr>
<tr><td><code>force_relaxing_X</code></td>
<td>
<p>Magnitude of force at X% of relaxation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Vikram B. Baliga
</p>


<h3>References</h3>

<p>Ahn AN, and Full RJ. 2002. A motor and a brake: two leg extensor
muscles acting at the same joint manage energy differently in a running
insect. Journal of Experimental Biology 205, 379-389.
</p>


<h3>See Also</h3>

<p>Other data analyses: 
<code><a href="#topic+analyze_workloop">analyze_workloop</a>()</code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a>()</code>
</p>
<p>Other twitch functions: 
<code><a href="#topic+fix_GR">fix_GR</a>()</code>,
<code><a href="#topic+invert_position">invert_position</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workloopR)

# import the twitch.ddf file included in workloopR
twitch_dat &lt;-read_ddf(system.file("extdata", "twitch.ddf",
                                  package = 'workloopR'))

# run isometric_timing() to get info on twitch kinetics
# we'll use different set points than the defaults
analyze_twitch &lt;- isometric_timing(twitch_dat,
  rising = c(25, 50, 75),
  relaxing = c(75, 50, 25)
)

# see the results
analyze_twitch

</code></pre>

<hr>
<h2 id='read_analyze_wl'>All-in-one import function for work loop files</h2><span id='topic+read_analyze_wl'></span>

<h3>Description</h3>

<p><code>read_analyze_wl()</code> is an all-in-one function to read in a work loop
file, select cycles, and compute work and power output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_analyze_wl(file_name, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_analyze_wl_+3A_file_name">file_name</code></td>
<td>
<p>A .ddf file that contains data from a
single workloop experiment</p>
</td></tr>
<tr><td><code id="read_analyze_wl_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>read_ddf()</code>,
<code>select_cycles()</code>,
or <code>analyze_workloop()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please be careful with units! See Warnings below. This function
combines <code>read_ddf()</code> with <code>select_cycles()</code> and then ultimately
<code>analyze_workloop()</code> into one handy function.
</p>
<p>As detailed in these three functions, possible arguments include: <br />
<code>cycle_def</code> - used to specify which part of the cycle is understood as
the beginning and end. There are currently three options: 'lo' for L0-to-L0;
'p2p' for peak-to-peak; and 't2t' for trough-to-trough <br />
<code>bworth_order</code> - Filter order for low-pass filtering of <code>Position</code>
via <code>signal::butter</code> prior to finding peak lengths. Default: 2. <br />
<code>bworth_freq</code> - Critical frequency (scalar) for low-pass filtering of
<code>Position</code> via <code>signal::butter</code> prior to finding peak lengths.
Default: 0.05. <br />
<code>keep_cycles</code> - Which cycles should be retained. Default: 4:6. <br />
<code>GR</code> - Gear ratio. Default: 1. <br />
<code>M</code> - Velocity multiplier used to positivize velocity; should be either
-1 or 1. Default: -1. <br />
<code>vel_bf</code> - Critical frequency (scalar) for low-pass filtering of
velocity via <code>signal::butter</code>. Default: 0.05. <br />
</p>
<p>The gear ratio (GR) and velocity multiplier (M) parameters can help correct
for issues related to the magnitude and sign of data collection. By
default, they are set to apply no gear ratio adjustment and to positivize
velocity. Instantaneous velocity is often noisy and the <code>vel_bf</code>
parameter allows for low-pass filtering of velocity data. See
<code>signal::butter()</code> and <code>signal::filtfilt()</code> for details of how
filtering is achieved.
</p>


<h3>Value</h3>

<p>The function returns a <code>list</code> of class <code>analyzed_workloop</code>
that provides instantaneous velocity, a smoothed velocity, and computes work,
instantaneous power, and net power from a work loop experiment. All data are
organized by the cycle number and important metadata are stored as
Attributes.
</p>
<p>Within the <code>list</code>, each entry is labeled by cycle and includes:
</p>
<table role = "presentation">
<tr><td><code>Time</code></td>
<td>
<p>Time, in sec</p>
</td></tr>
<tr><td><code>Position</code></td>
<td>
<p>Length change of the muscle, corrected for gear ratio, in mm</p>
</td></tr>
<tr><td><code>Force</code></td>
<td>
<p>Force, corrected for gear ratio, in mN</p>
</td></tr>
<tr><td><code>Stim</code></td>
<td>
<p>When stimulation occurs, on a binary scale</p>
</td></tr>
<tr><td><code>Cycle</code></td>
<td>
<p>Cycle ID, as a letter</p>
</td></tr>
<tr><td><code>Inst_velocity</code></td>
<td>
<p>Instantaneous velocity, computed from <code>Position</code>
change, reported in meters/sec</p>
</td></tr>
<tr><td><code>Filt_velocity</code></td>
<td>
<p>Instantaneous velocity, after low-pass filtering, again
in meter/sec</p>
</td></tr>
<tr><td><code>Inst_Power</code></td>
<td>
<p>Instantaneous power, a product of <code>Force</code> and
<code>Filt_velocity</code>, reported in J</p>
</td></tr>
<tr><td><code>Percent_of_Cycle</code></td>
<td>
<p>The percent of that particular cycle which has
elapsed</p>
</td></tr>
</table>
<p>In addition, the following information is stored in the
<code>analyzed_workloop</code> object's attributes:
</p>
<table role = "presentation">
<tr><td><code>stimulus_frequency</code></td>
<td>
<p>Frequency at which stimulus pulses occurred</p>
</td></tr>
<tr><td><code>cycle_frequency</code></td>
<td>
<p>Frequency of oscillations (assuming sine wave
trajectory)</p>
</td></tr>
<tr><td><code>total_cycles</code></td>
<td>
<p>Total number of oscillatory cycles (assuming sine wave
trajectory) that the muscle experienced.</p>
</td></tr>
<tr><td><code>cycle_def</code></td>
<td>
<p>Specifies what part of the cycle is understood as the
beginning and end. There are currently three options:
'lo' for L0-to-L0;
'p2p' for peak-to-peak; and
't2t' for trough-to-trough</p>
</td></tr>
<tr><td><code>amplitude</code></td>
<td>
<p>Amplitude of length change (assuming sine wave
trajectory)</p>
</td></tr>
<tr><td><code>phase</code></td>
<td>
<p>Phase of the oscillatory cycle (in percent) at which stimulation
occurred. Somewhat experimental, please use with caution</p>
</td></tr>
<tr><td><code>position_inverted</code></td>
<td>
<p>Logical; whether position inversion has been
applied)</p>
</td></tr>
<tr><td><code>units</code></td>
<td>
<p>The units of measurement for each column in the object after
running this function. See Warning</p>
</td></tr>
<tr><td><code>sample_frequency</code></td>
<td>
<p>Frequency at which samples were collected</p>
</td></tr>
<tr><td><code>header</code></td>
<td>
<p>Additional information from the header</p>
</td></tr>
<tr><td><code>units_table</code></td>
<td>
<p>Units from each Channel of the original ddf file</p>
</td></tr>
<tr><td><code>protocol_table</code></td>
<td>
<p>Protocol in tabular format; taken from the original
ddf file</p>
</td></tr>
<tr><td><code>stim_table</code></td>
<td>
<p>Specific info on stimulus protocol; taken from the original
ddf file</p>
</td></tr>
<tr><td><code>stimulus_pulses</code></td>
<td>
<p>Number of sequential pulses within a stimulation
train</p>
</td></tr>
<tr><td><code>stimulus_offset</code></td>
<td>
<p>Timing offset at which stimulus began</p>
</td></tr>
<tr><td><code>gear_ratio</code></td>
<td>
<p>Gear ratio applied by this function</p>
</td></tr>
<tr><td><code>file_id</code></td>
<td>
<p>File name</p>
</td></tr>
<tr><td><code>mtime</code></td>
<td>
<p>Time at which file was last modified</p>
</td></tr>
<tr><td><code>retained_cycles</code></td>
<td>
<p>Which cycles were retained, as numerics</p>
</td></tr>
<tr><td><code>summary</code></td>
<td>
<p>Simple table showing work (in J) and net power (in W) for each
cycle</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>Most systems we have encountered record Position data in millimeters
and Force in millinewtons, and therefore this function assumes data are
recorded in those units. Through a series of internal conversions, this
function computes velocity in meters/sec, work in Joules, and power in
Watts. If your raw data do not originate in millimeters and millinewtons,
please transform your data accordingly and ignore what you see in the
attribute <code>units</code>.
</p>


<h3>Author(s)</h3>

<p>Vikram B. Baliga
</p>


<h3>References</h3>

<p>Josephson RK. 1985. Mechanical Power output from Striated Muscle
during Cyclic Contraction. Journal of Experimental Biology 114: 493-512.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read_ddf">read_ddf</a></code>,
<code><a href="#topic+select_cycles">select_cycles</a></code>
<code><a href="#topic+analyze_workloop">analyze_workloop</a></code>
</p>
<p>Other data analyses: 
<code><a href="#topic+analyze_workloop">analyze_workloop</a>()</code>,
<code><a href="#topic+isometric_timing">isometric_timing</a>()</code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>
</p>
<p>Other data import functions: 
<code><a href="#topic+as_muscle_stim">as_muscle_stim</a>()</code>,
<code><a href="#topic+get_wl_metadata">get_wl_metadata</a>()</code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>,
<code><a href="#topic+read_ddf_dir">read_ddf_dir</a>()</code>,
<code><a href="#topic+read_ddf">read_ddf</a>()</code>
</p>
<p>Other workloop functions: 
<code><a href="#topic+analyze_workloop">analyze_workloop</a>()</code>,
<code><a href="#topic+fix_GR">fix_GR</a>()</code>,
<code><a href="#topic+get_wl_metadata">get_wl_metadata</a>()</code>,
<code><a href="#topic+invert_position">invert_position</a>()</code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>,
<code><a href="#topic+select_cycles">select_cycles</a>()</code>,
<code><a href="#topic+summarize_wl_trials">summarize_wl_trials</a>()</code>,
<code><a href="#topic+time_correct">time_correct</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workloopR)

# import the workloop.ddf file included in workloopR and analyze with
# a gear ratio correction of 2 and cycle definition of peak-to-peak
wl_dat &lt;- read_analyze_wl(system.file("extdata", "workloop.ddf",
                                      package = 'workloopR'),
                          phase_from_peak = TRUE,
                          GR = 2, cycle_def = "p2p")


</code></pre>

<hr>
<h2 id='read_analyze_wl_dir'>Read and analyze work loop files from a directory</h2><span id='topic+read_analyze_wl_dir'></span>

<h3>Description</h3>

<p>All-in-one function to import multiple workloop .ddf files from a directory,
sort them by mtime, analyze them, and store the resulting objects in an
ordered list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_analyze_wl_dir(file_path, pattern = "*.ddf", sort_by = "mtime", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_analyze_wl_dir_+3A_file_path">file_path</code></td>
<td>
<p>Directory in which files are located</p>
</td></tr>
<tr><td><code id="read_analyze_wl_dir_+3A_pattern">pattern</code></td>
<td>
<p>Regular expression used to specify files of interest. Defaults
to all .ddf files within file_path</p>
</td></tr>
<tr><td><code id="read_analyze_wl_dir_+3A_sort_by">sort_by</code></td>
<td>
<p>Metadata by which files should be sorted to be in the correct
run order. Defaults to <code>mtime</code>, which is time of last modification of
files.</p>
</td></tr>
<tr><td><code id="read_analyze_wl_dir_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>read_analyze_wl()</code>,
<code>analyze_workloop()</code>, <code>select_cycles()</code>, or <code>read_ddf()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Work loop data files will be imported and then arranged in the order
in which they were run (assuming run order is reflected in <code>mtime</code>).
Chiefly used in conjunction with <code>summarize_wl_trials()</code> and
<code>time_correct()</code> if time correction is desired.
</p>


<h3>Value</h3>

<p>A list containing <code>analyzed_workloop</code> objects, one for each file that is
imported and subsequently analyzed. The list is sorted according to the
<code>sort_by</code> parameter, which by default uses the time of last modification
of each file's contents (mtime).
</p>


<h3>Warning</h3>

<p>Most systems we have encountered record Position data in millimeters
and Force in millinewtons, and therefore this function assumes data are
recorded in those units. Through a series of internal conversions, this
function computes velocity in meters/sec, work in Joules, and power in
Watts. If your raw data do not originate in millimeters and millinewtons,
please transform your data accordingly and ignore what you see in the
attribute <code>units</code>.
</p>


<h3>Author(s)</h3>

<p>Shreeram Senthivasan
</p>


<h3>References</h3>

<p>Josephson RK. 1985. Mechanical Power output from Striated Muscle
during Cyclic Contraction. Journal of Experimental Biology 114: 493-512.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read_analyze_wl">read_analyze_wl</a></code>,
<code><a href="#topic+get_wl_metadata">get_wl_metadata</a></code>,
<code><a href="#topic+summarize_wl_trials">summarize_wl_trials</a></code>,
<code><a href="#topic+time_correct">time_correct</a></code>
</p>
<p>Other data analyses: 
<code><a href="#topic+analyze_workloop">analyze_workloop</a>()</code>,
<code><a href="#topic+isometric_timing">isometric_timing</a>()</code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a>()</code>
</p>
<p>Other data import functions: 
<code><a href="#topic+as_muscle_stim">as_muscle_stim</a>()</code>,
<code><a href="#topic+get_wl_metadata">get_wl_metadata</a>()</code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a>()</code>,
<code><a href="#topic+read_ddf_dir">read_ddf_dir</a>()</code>,
<code><a href="#topic+read_ddf">read_ddf</a>()</code>
</p>
<p>Other workloop functions: 
<code><a href="#topic+analyze_workloop">analyze_workloop</a>()</code>,
<code><a href="#topic+fix_GR">fix_GR</a>()</code>,
<code><a href="#topic+get_wl_metadata">get_wl_metadata</a>()</code>,
<code><a href="#topic+invert_position">invert_position</a>()</code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a>()</code>,
<code><a href="#topic+select_cycles">select_cycles</a>()</code>,
<code><a href="#topic+summarize_wl_trials">summarize_wl_trials</a>()</code>,
<code><a href="#topic+time_correct">time_correct</a>()</code>
</p>
<p>Other batch analyses: 
<code><a href="#topic+get_wl_metadata">get_wl_metadata</a>()</code>,
<code><a href="#topic+summarize_wl_trials">summarize_wl_trials</a>()</code>,
<code><a href="#topic+time_correct">time_correct</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workloopR)

# batch read and analyze files included with workloopR
analyzed_wls &lt;- read_analyze_wl_dir(system.file("extdata/wl_duration_trials",
                                                package = 'workloopR'),
                                    phase_from_peak = TRUE,
                                    cycle_def = "p2p", keep_cycles = 2:4)

</code></pre>

<hr>
<h2 id='read_ddf'>Import work loop or isometric data from .ddf files</h2><span id='topic+read_ddf'></span>

<h3>Description</h3>

<p><code>read_ddf</code> reads in workloop, twitch, or tetanus experiment data from
.ddf files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_ddf(
  file_name,
  file_id = NA,
  rename_cols = list(c(2, 3), c("Position", "Force")),
  skip_cols = 4:11,
  phase_from_peak = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_ddf_+3A_file_name">file_name</code></td>
<td>
<p>A .ddf file that contains data from a single workloop,
twitch, or tetanus experiment</p>
</td></tr>
<tr><td><code id="read_ddf_+3A_file_id">file_id</code></td>
<td>
<p>A string identifying the experiment. The file name is used by
default.</p>
</td></tr>
<tr><td><code id="read_ddf_+3A_rename_cols">rename_cols</code></td>
<td>
<p>List consisting of a vector of indices of columns to
rename and a vector of new column names. See Details.</p>
</td></tr>
<tr><td><code id="read_ddf_+3A_skip_cols">skip_cols</code></td>
<td>
<p>Numeric vector of column indices to skip. See Details.</p>
</td></tr>
<tr><td><code id="read_ddf_+3A_phase_from_peak">phase_from_peak</code></td>
<td>
<p>Logical, indicating whether percent phase of
stimulation should be recorded relative to peak length or relative to L0
(default)</p>
</td></tr>
<tr><td><code id="read_ddf_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to/from other functions that work
with <code>read_ddf()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Read in a .ddf file that contains data from an experiment. If
position and force do not correspond to columns 2 and 3 (respectively),
replace &quot;2&quot; and &quot;3&quot; within <code>rename_cols</code> accordingly. Similarly,
<code>skip_cols = 4:11</code> should be adjusted if more than 11 columns are
present and/or columns 4:11 contain important data.
</p>
<p>Please note that there is no correction for gear ratio or further
manipulation of data. See <code>fix_GR</code> to adjust gear ratio. Gear ratio can
also be adjusted prior to analyses within the <code>analyze_workloop()</code>
function, the data import all-in-one function <code>read_analyze_wl()</code>, or
the batch analysis all-in-one <code>read_analyze_wl_dir()</code>.
</p>
<p>Please also note that organization of data within the .ddf file is assumed to
conform to that used by Aurora Scientific's Dynamic Muscle Control and
Analysis Software. YMMV if using a .ddf file from another source. The
<code>as_muscle_stim()</code> function can be used to generate <code>muscle_stim</code>
objects if data are imported via another function. Please feel free to
contact us with any issues or requests.
</p>


<h3>Value</h3>

<p>An object of class <code>workloop</code>, <code>twitch</code>, or <code>tetanus</code>,
all of which inherit class <code>muscle_stim</code>. These objects behave like
<code>data.frames</code> in most situations but also store metadata from the ddf
as attributes.
</p>
<p>The <code>muscle_stim</code> object's columns contain:
</p>
<table role = "presentation">
<tr><td><code>Time</code></td>
<td>
<p>Time</p>
</td></tr>
<tr><td><code>Position</code></td>
<td>
<p>Length change of the muscle, uncorrected for gear ratio</p>
</td></tr>
<tr><td><code>Force</code></td>
<td>
<p>Force, uncorrected for gear ratio</p>
</td></tr>
<tr><td><code>Stim</code></td>
<td>
<p>When stimulation occurs, on a binary scale</p>
</td></tr>
</table>
<p>In addition, the following information is stored in the <code>data.frame</code>'s
attributes:
</p>
<table role = "presentation">
<tr><td><code>sample_frequency</code></td>
<td>
<p>Frequency at which samples were collected</p>
</td></tr>
<tr><td><code>pulses</code></td>
<td>
<p>Number of sequential pulses within a stimulation train</p>
</td></tr>
<tr><td><code>total_cycles_lo</code></td>
<td>
<p>Total number of oscillatory cycles (assuming sine
wave trajectory) that the muscle experienced. Cycles are defined with respect
to initial muscle length (L0-to-L0 as opposed to peak-to-peak).</p>
</td></tr>
<tr><td><code>amplitude</code></td>
<td>
<p>amplitude of length change (again, assuming sine wave
trajectory)</p>
</td></tr>
<tr><td><code>cycle_frequency</code></td>
<td>
<p>Frequency of oscillations (again, assuming sine wave
trajectory)</p>
</td></tr>
<tr><td><code>units</code></td>
<td>
<p>The units of measurement for each column in the
<code>data.frame</code>. This might be the most important attribute so please check
that it makes sense!</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Vikram B. Baliga and Shreeram Senthivasan
</p>


<h3>See Also</h3>

<p>Other data import functions: 
<code><a href="#topic+as_muscle_stim">as_muscle_stim</a>()</code>,
<code><a href="#topic+get_wl_metadata">get_wl_metadata</a>()</code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a>()</code>,
<code><a href="#topic+read_ddf_dir">read_ddf_dir</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workloopR)

# import the workloop.ddf file included in workloopR
wl_dat &lt;-read_ddf(system.file("extdata", "workloop.ddf",
                              package = 'workloopR'),
                  phase_from_peak = TRUE)


</code></pre>

<hr>
<h2 id='read_ddf_dir'>Import a batch of work loop or isometric data files from a directory</h2><span id='topic+read_ddf_dir'></span>

<h3>Description</h3>

<p>Uses <code>read_ddf()</code> to read in workloop, twitch, or tetanus experiment
data from multiple .ddf files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_ddf_dir(file_path, pattern = "*.ddf", sort_by = "mtime", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_ddf_dir_+3A_file_path">file_path</code></td>
<td>
<p>Path where files are stored. Should be in the same folder.</p>
</td></tr>
<tr><td><code id="read_ddf_dir_+3A_pattern">pattern</code></td>
<td>
<p>Regex pattern for identifying relevant files in the file_path.</p>
</td></tr>
<tr><td><code id="read_ddf_dir_+3A_sort_by">sort_by</code></td>
<td>
<p>Metadata by which files should be sorted to be in the correct
run order. Defaults to <code>mtime</code>, which is time of last modification of
files.</p>
</td></tr>
<tr><td><code id="read_ddf_dir_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>read_ddf()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Read in a .ddf file that contains data from an experiment. If
position and force do not correspond to columns 2 and 3 (respectively),
replace &quot;2&quot; and &quot;3&quot; within <code>rename_cols</code> accordingly. Similarly,
<code>skip_cols = 4:11</code> should be adjusted if more than 11 columns are
present and/or columns 4:11 contain important data.
</p>
<p>Please note that there is no correction for gear ratio or further
manipulation of data. See <code>fix_GR</code> to adjust gear ratio. Gear ratio can
also be adjusted prior to analyses within the <code>analyze_workloop()</code>
function, the data import all-in-one function <code>read_analyze_wl()</code>, or
the batch analysis all-in-one <code>read_analyze_wl_dir()</code>.
</p>
<p>Please also note that organization of data within the .ddf file is assumed to
conform to that used by Aurora Scientific's Dynamic Muscle Control and
Analysis Software. YMMV if using a .ddf file from another source. The
<code>as_muscle_stim()</code> function can be used to generate <code>muscle_stim</code>
objects if data are imported via another function. Please feel free to
contact us with any issues or requests.
</p>


<h3>Value</h3>

<p>A list of objects of class <code>workloop</code>, <code>twitch</code>, or
<code>tetanus</code>, all of which inherit class <code>muscle_stim</code>. These objects
behave like <code>data.frames</code> in most situations but also store metadata
from the ddf as attributes.
</p>
<p>Each <code>muscle_stim</code> object's columns contain:
</p>
<table role = "presentation">
<tr><td><code>Time</code></td>
<td>
<p>Time</p>
</td></tr>
<tr><td><code>Position</code></td>
<td>
<p>Length change of the muscle, uncorrected for gear ratio</p>
</td></tr>
<tr><td><code>Force</code></td>
<td>
<p>Force, uncorrected for gear ratio</p>
</td></tr>
<tr><td><code>Stim</code></td>
<td>
<p>When stimulation occurs, on a binary scale</p>
</td></tr>
</table>
<p>In addition, the following information is stored in each <code>data.frame</code>'s
attributes:
</p>
<table role = "presentation">
<tr><td><code>sample_frequency</code></td>
<td>
<p>Frequency at which samples were collected</p>
</td></tr>
<tr><td><code>pulses</code></td>
<td>
<p>Number of sequential pulses within a stimulation train</p>
</td></tr>
<tr><td><code>total_cycles_lo</code></td>
<td>
<p>Total number of oscillatory cycles (assuming sine
wave trajectory) that the muscle experienced. Cycles are defined with respect
to initial muscle length (L0-to-L0 as opposed to peak-to-peak).</p>
</td></tr>
<tr><td><code>amplitude</code></td>
<td>
<p>amplitude of length change (again, assuming sine wave
trajectory)</p>
</td></tr>
<tr><td><code>cycle_frequency</code></td>
<td>
<p>Frequency of oscillations (again, assuming sine wave
trajectory)</p>
</td></tr>
<tr><td><code>units</code></td>
<td>
<p>The units of measurement for each column in the
<code>data.frame</code>. This might be the most important attribute so please check
that it makes sense!</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Vikram B. Baliga and Shreeram Senthivasan
</p>


<h3>See Also</h3>

<p>Other data import functions: 
<code><a href="#topic+as_muscle_stim">as_muscle_stim</a>()</code>,
<code><a href="#topic+get_wl_metadata">get_wl_metadata</a>()</code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a>()</code>,
<code><a href="#topic+read_ddf">read_ddf</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workloopR)

# import a set of twitch .ddf files included in workloopR
workloop_dat &lt;-read_ddf_dir(system.file("extdata/wl_duration_trials",
                 package = 'workloopR'))

</code></pre>

<hr>
<h2 id='select_cycles'>Select cycles from a work loop object</h2><span id='topic+select_cycles'></span>

<h3>Description</h3>

<p>Retain data from a work loop experiment based on position cycle
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_cycles(
  x,
  cycle_def,
  keep_cycles = 4:6,
  bworth_order = 2,
  bworth_freq = 0.05,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="select_cycles_+3A_x">x</code></td>
<td>
<p>A <code>workloop</code> object (see Details for how it should be
organized)</p>
</td></tr>
<tr><td><code id="select_cycles_+3A_cycle_def">cycle_def</code></td>
<td>
<p>A string specifying how cycles should be defined; one of:
&quot;lo&quot;, &quot;p2p&quot;, or &quot;t2t&quot;. See Details more info</p>
</td></tr>
<tr><td><code id="select_cycles_+3A_keep_cycles">keep_cycles</code></td>
<td>
<p>The indices of the cycles to keep. Include 0 to keep data
identified as being outside complete cycles</p>
</td></tr>
<tr><td><code id="select_cycles_+3A_bworth_order">bworth_order</code></td>
<td>
<p>Filter order for low-pass filtering of <code>Position</code>
via <code>signal::butter()</code> prior to finding L0</p>
</td></tr>
<tr><td><code id="select_cycles_+3A_bworth_freq">bworth_freq</code></td>
<td>
<p>Critical frequency (scalar) for low-pass filtering of
<code>Position</code> via <code>signal::butter()</code> prior to finding L0</p>
</td></tr>
<tr><td><code id="select_cycles_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to/from other functions that make use
of <code>select_cycles()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>select_cycles()</code> subsets data from a workloop trial by
position cycle. The <code>cycle_def</code> argument is used to specify which part
of the cycle is understood as the beginning and end. There are currently
three options: <br />
'lo' for L0-to-L0; <br />
'p2p' for peak-to-peak; and <br />
't2t' for trough-to-trough <br />
</p>
<p>Peaks are identified using <code>pracma::findpeaks()</code>. L0 points on the
rising edge are found by finding the midpoints between troughs and the
following peak. However the first and last extrema and L0 points may be
misidentified by this method. Please plot your <code>Position</code> cycles to
ensure the edge cases are identified correctly.
</p>
<p>The <code>keep_cycles</code> argument is used to determine which cycles (as
defined by <code>cycle_def</code> should be retained in the final dataset. Zero
is the index assigned to all data points that are determined to be outside
a complete cycle.
</p>
<p>The <code>muscle_stim</code> object (<code>x</code>) must be a <code>workloop</code>,
preferably read in by one of our data import functions. Please see
documentation for <code>as_muscle_stim()</code> if you need to manually construct
a <code>muscle_stim</code> object from another source.
</p>


<h3>Value</h3>

<p>A <code>workloop</code> object with rows subsetted by the chosen position
cycles. A <code>Cycle</code> column is appended to denote which cycle each time
point is associated with. Finally, all attributes from the input
<code>workloop</code> object are retained and one new attribute is added to
record which cycles from the original data were retained.
</p>


<h3>Author(s)</h3>

<p>Vikram B. Baliga and Shreeram Senthivasan
</p>


<h3>See Also</h3>

<p><code><a href="#topic+analyze_workloop">analyze_workloop</a></code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a></code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a></code>
</p>
<p>Other data transformations: 
<code><a href="#topic+fix_GR">fix_GR</a>()</code>,
<code><a href="#topic+invert_position">invert_position</a>()</code>
</p>
<p>Other workloop functions: 
<code><a href="#topic+analyze_workloop">analyze_workloop</a>()</code>,
<code><a href="#topic+fix_GR">fix_GR</a>()</code>,
<code><a href="#topic+get_wl_metadata">get_wl_metadata</a>()</code>,
<code><a href="#topic+invert_position">invert_position</a>()</code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a>()</code>,
<code><a href="#topic+summarize_wl_trials">summarize_wl_trials</a>()</code>,
<code><a href="#topic+time_correct">time_correct</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workloopR)

# import the workloop.ddf file included in workloopR
wl_dat &lt;-read_ddf(system.file("extdata", "workloop.ddf",
                              package = 'workloopR'),
                  phase_from_peak = TRUE)

# select cycles 3 through 5 via the peak-to-peak definition
wl_selected &lt;- select_cycles(wl_dat, cycle_def = "p2p", keep_cycles = 3:5)


# are the cycles of (approximately) the same length?
summary(as.factor(wl_selected$Cycle))

</code></pre>

<hr>
<h2 id='summarize_wl_trials'>Summarize work loop files</h2><span id='topic+summarize_wl_trials'></span>

<h3>Description</h3>

<p>Summarize important info from work loop files stored in the same folder
(e.g. a sequence of trials in an experiment) including experimental
parameters, run order, and <code>mtime</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarize_wl_trials(wl_list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summarize_wl_trials_+3A_wl_list">wl_list</code></td>
<td>
<p>List of <code>analyzed_workloop</code> objects, preferably one
created by <code>read_analyze_wl_dir()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If several files (e.g. successive trials from one experiment) are
stored in one folder, use this function to obtain summary stats and
metadata and other parameters. This function requires a list of
<code>analyze_workloop</code> objects, which can be readily obtained by first
running <code>read_analyze_wl_dir()</code> on a specified directory.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> of information about the collection of workloop files.
Columns include:
</p>
<table role = "presentation">
<tr><td><code>File_ID</code></td>
<td>
<p>Name of the file</p>
</td></tr>
<tr><td><code>Cycle_Frequency</code></td>
<td>
<p>Frequency of Position change</p>
</td></tr>
<tr><td><code>Amplitude</code></td>
<td>
<p>amplitude of Position change</p>
</td></tr>
<tr><td><code>Phase</code></td>
<td>
<p>Phase of the oscillatory cycle (in percent) at which
stimulation occurred. Somewhat experimental, please use with caution</p>
</td></tr>
<tr><td><code>Stimulus_Pulses</code></td>
<td>
<p>Number of stimulation pulses</p>
</td></tr>
<tr><td><code>mtime</code></td>
<td>
<p>Time at which file's contents were last changed (<code>mtime</code>)</p>
</td></tr>
<tr><td><code>Mean_Work</code></td>
<td>
<p>Mean work output from the selected cycles</p>
</td></tr>
<tr><td><code>Mean_Power</code></td>
<td>
<p>Net power output from the selected cycles</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Vikram B. Baliga and Shreeram Senthivasan
</p>


<h3>References</h3>

<p>Josephson RK. 1985. Mechanical Power output from Striated Muscle
during Cyclic Contraction. Journal of Experimental Biology 114: 493-512.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a></code>,
<code><a href="#topic+get_wl_metadata">get_wl_metadata</a></code>,
<code><a href="#topic+time_correct">time_correct</a></code>
</p>
<p>Other workloop functions: 
<code><a href="#topic+analyze_workloop">analyze_workloop</a>()</code>,
<code><a href="#topic+fix_GR">fix_GR</a>()</code>,
<code><a href="#topic+get_wl_metadata">get_wl_metadata</a>()</code>,
<code><a href="#topic+invert_position">invert_position</a>()</code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a>()</code>,
<code><a href="#topic+select_cycles">select_cycles</a>()</code>,
<code><a href="#topic+time_correct">time_correct</a>()</code>
</p>
<p>Other batch analyses: 
<code><a href="#topic+get_wl_metadata">get_wl_metadata</a>()</code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>,
<code><a href="#topic+time_correct">time_correct</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workloopR)

# batch read and analyze files included with workloopR
analyzed_wls &lt;- read_analyze_wl_dir(system.file("extdata/wl_duration_trials",
                                               package = 'workloopR'),
                                    phase_from_peak = TRUE,
                                    cycle_def = "p2p",
                                    keep_cycles = 2:4
                                    )

# now summarize
summarized_wls &lt;- summarize_wl_trials(analyzed_wls)

</code></pre>

<hr>
<h2 id='time_correct'>Time correction for work loop experiments</h2><span id='topic+time_correct'></span>

<h3>Description</h3>

<p>Correct for potential degradation of muscle over time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time_correct(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="time_correct_+3A_x">x</code></td>
<td>
<p>A <code>data.frame</code> with summary data, e.g. an object created by
<code>summarize_wl_trials()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function assumes that across a batch of successive trials, the
stimulation parameters for the first and final trials are identical. If not,
DO NOT USE. Decline in power output is therefore assumed to be a linear
function of time. Accordingly, the difference between the final and first
trial's (absolute) power output is used to 'correct' trials that occur in
between, with explicit consideration of run order and time elapsed (via
mtime). A similar correction procedure is applied to work.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> that additionally contains:
</p>
<table role = "presentation">
<tr><td><code>Time_Corrected_Work</code></td>
<td>
<p>Time corrected work output, transformed from
<code>$Mean_Work</code></p>
</td></tr>
<tr><td><code>Time_Corrected_Power</code></td>
<td>
<p>Time corrected net power output, transformed
from <code>$Mean_Power</code></p>
</td></tr>
</table>
<p>And new attributes:
</p>
<table role = "presentation">
<tr><td><code>power_difference</code></td>
<td>
<p>Difference in mass-specific net power output
between the final and first trials.</p>
</td></tr>
<tr><td><code>time_difference</code></td>
<td>
<p>Difference in mtime between the final and first
trials.</p>
</td></tr>
<tr><td><code>time_correction_rate</code></td>
<td>
<p>Overall rate; <code>power_difference</code> divided
by <code>time_difference</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Vikram B. Baliga and Shreeram Senthivasan
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summarize_wl_trials">summarize_wl_trials</a></code>
</p>
<p>Other workloop functions: 
<code><a href="#topic+analyze_workloop">analyze_workloop</a>()</code>,
<code><a href="#topic+fix_GR">fix_GR</a>()</code>,
<code><a href="#topic+get_wl_metadata">get_wl_metadata</a>()</code>,
<code><a href="#topic+invert_position">invert_position</a>()</code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a>()</code>,
<code><a href="#topic+select_cycles">select_cycles</a>()</code>,
<code><a href="#topic+summarize_wl_trials">summarize_wl_trials</a>()</code>
</p>
<p>Other batch analyses: 
<code><a href="#topic+get_wl_metadata">get_wl_metadata</a>()</code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a>()</code>,
<code><a href="#topic+summarize_wl_trials">summarize_wl_trials</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workloopR)

# batch read and analyze files included with workloopR
analyzed_wls &lt;- read_analyze_wl_dir(system.file("extdata/wl_duration_trials",
                                                package = 'workloopR'),
                                    phase_from_peak = TRUE,
                                    cycle_def = "p2p", keep_cycles = 2:4)

# now summarize
summarized_wls &lt;- summarize_wl_trials(analyzed_wls)


# mtimes within the package are not accurate, so we'll supply
# our own vector of mtimes
summarized_wls$mtime &lt;- read.csv(
                          system.file(
                            "extdata/wl_duration_trials/ddfmtimes.csv",
                            package="workloopR"))$mtime

# now time correct
timecor_wls &lt;- time_correct(summarized_wls)
timecor_wls


</code></pre>

<hr>
<h2 id='trapezoidal_integration'>Approximate the definite integral via the trapezoidal rule</h2><span id='topic+trapezoidal_integration'></span>

<h3>Description</h3>

<p>Mostly meant for internal use in our analysis functions, but made available
for other use cases. Accordingly, it does not strictly rely on objects of
class <code>muscle_stim</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trapezoidal_integration(x, f)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trapezoidal_integration_+3A_x">x</code></td>
<td>
<p>a variable, e.g. vector of positions</p>
</td></tr>
<tr><td><code id="trapezoidal_integration_+3A_f">f</code></td>
<td>
<p>integrand, e.g. vector of forces</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the functions <code>analyze_workloop()</code>, <code>read_analyze_wl()</code>
, and <code>read_analyze_wl_dir()</code>, work is calculated as the difference
between the integral of the upper curve and the integral of the lower curve
of a work loop.
</p>


<h3>Value</h3>

<p>A numerical value indicating the value of the integral.
</p>


<h3>Author(s)</h3>

<p>Vikram B. Baliga
</p>


<h3>References</h3>

<p>Atkinson, Kendall E. (1989), An Introduction to Numerical
Analysis (2nd ed.), New York: John Wiley &amp; Sons
</p>


<h3>See Also</h3>

<p><code><a href="#topic+analyze_workloop">analyze_workloop</a></code>,
<code><a href="#topic+read_analyze_wl">read_analyze_wl</a></code>,
<code><a href="#topic+read_analyze_wl_dir">read_analyze_wl_dir</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# create a circle centered at (x = 10, y = 20) with radius 2
t &lt;- seq(0, 2 * pi, length = 1000)
coords &lt;- t(rbind(10 + sin(t) * 2, 20 + cos(t) * 2))


# use the function to get the area
trapezoidal_integration(coords[, 1], coords[, 2])

# does it match (pi * r^2)?
3.14159265358 * (2^2) # very close

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
