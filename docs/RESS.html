<!DOCTYPE html><html><head><title>Help for package RESS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RESS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#capture.essentia'><p>capture.essentia</p>
</a></li>
<li><a href='#essQuery'><p>essQuery</p></a></li>
<li><a href='#read.essentia'><p>read.essentia</p></a></li>
<li><a href='#RESS-package'>
<p>Integrates R and Essentia.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Integrates R and Essentia</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-10-26</td>
</tr>
<tr>
<td>Author:</td>
<td>Ben Waxer</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ben Waxer &lt;bwaxer@auriq.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains three functions that query AuriQ Systems' Essentia Database and return the results in R. 'essQuery' takes a single Essentia command and captures the output in R, where you can save the output to a dataframe or stream it directly into additional analysis. 'read.essentia' takes an Essentia script and captures the output csv data into R, where you can save the output to a dataframe or stream it directly into additional analysis. 'capture.essentia' takes a file containing any number of Essentia commands and captures the output of the specified statements into R dataframes. Essentia can be downloaded for free at http://www.auriq.com/documentation/source/install/index.html.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-10-28 00:13:56 UTC; essentia</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-10-28 08:44:54</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils</td>
</tr>
</table>
<hr>
<h2 id='capture.essentia'>capture.essentia

</h2><span id='topic+capture.essentia'></span>

<h3>Description</h3>

<p>Read the essentia commands in the stated file, query the Essentia
database, and save the results into R as dataframes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>capture.essentia(scriptcall = "", linenumber = "all", separator = " ")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="capture.essentia_+3A_scriptcall">scriptcall</code></td>
<td>

<p>The file containing the essentia commands you want to run and any 
arguments you want to pass into the bash script. 
</p>
<p>'ess stream' and 'ess query' statements will have their output ignored
by R unless there is a '#Rinclude' flag somehwere in the
statement line. 'ess exec' statements will have their
output included unless there is a '#Rignore' flag somewhere
in the statement line.
</p>
<p>The file should contain primarily the query commands but can
contain the entire essentia script including loading the Essentia
database if desired. Any command that you want to capture the
output from must have its output in csv format.
</p>
</td></tr>
<tr><td><code id="capture.essentia_+3A_linenumber">linenumber</code></td>
<td>

<p>This is set to default to all line numbers so that every
command in the file is executed. You can specify the line
number of the command you wish to run if you dont want to run
the entire set of commands in the file. If your statement spans
multiple lines, you can specify each line using the syntax
c(first_line_number, second_line_number, ....).
</p>
</td></tr>
<tr><td><code id="capture.essentia_+3A_separator">separator</code></td>
<td>

<p>The character that should be used to split the script name and 
arguments you are passing into that script. The default is set
to a space in the style of the linux command line; however, you
can set it to whatever you want. This can be useful if one or 
more of the arguments you are trying to pass into your script 
contains an unquoted space.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>capture.essentia reads all of the statements in a file (unless linenumber
is specified, see above) and captures the output of the specified
commands into R dataframes. By default only the output of 'ess
exec' statements is captured and it's stored in R dataframes
command1 to commandN, where N is the number of captured
statements.
</p>
<p>You can include 'ess stream' or 'ess query' statements by adding a
'#Rinclude' flag. This method can be used to stream multiple files
into R for data exploration or analysis.  If you plan to run
multiple statements that may be somewhat related to each other,
it is recommended that you use capture.essentia.
</p>


<h3>Value</h3>

<p>If there is only one statement that is having its output captured
and this statement does not contain a <code>#R#name#R#</code> flag,
capture.essentia will simply return the data in R so you can save it
however you want or stream it directly into additional analysis.
</p>
<p>If there is more than one statement that is having its output 
captured, there is no value returned. This command creates a
set of R dataframes containing the output from the specified essentia
commands in the file specified in scriptcall.
</p>


<h3>Note</h3>

<p>The flags added to the essentia commands in file can include:
</p>
<p><code>#Rignore</code> : Ignore an 'ess exec' statement. Do not
capture the output of the statement into R.
</p>
<p><code>#Rinclude</code> : Include an 'ess stream' or 'ess query' statement. Capture
the output of the statement into R.
</p>
<p><code>#-notitle</code> : Tell R not to use the first line of the output
as the header.
</p>
<p><code>#Rseparate</code> : Can be used when saving multiple files into an
R dataframe using an 'ess stream' command. Saves each
file into a different R dataframe.
</p>
<p><code>#filelist</code> : Causes an extra dataframe to be stored in R that saves
the list of files streamed into R when streaming multiple files.
</p>
<p><code>#R#name#R#</code> : Allows any automatically saved dataframe to be
renamed to whatever is entered in place of 'name'. When used with 
#Rseparate, saves the files as name1 to nameN, where N is the number of files. 
Since this still counts as a statement, the next default dataframe saved will 
be stored as command followed by the number of previous statements run plus one. 
</p>


<h3>Author(s)</h3>

<p>Ben Waxer, Data Scientist with Auriq Systems.
</p>


<h3>References</h3>

<p>See our website at www.auriq.com or our documentation at
www.auriq.com/documentation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
--------------------------------------------------------------------------------------------------

These examples require Essentia to be installed:

queryfile &lt;- file("examplequery.sh","w")
cat("ess exec \"echo -e '11,12,13\n4,5,6\n7,8,9'\" #-notitle \n",file=queryfile)
cat("ess exec \"echo -e '11,12,13\n4,5,6\n7,8,9'\" \n", file=queryfile)
cat("ess exec \"echo -e '11,12,13\n4,5,6\n7,8,9'\" #Rignore \n", file=queryfile)
capture.essentia("examplequery.sh")
print(command1)
print(command2)
print("The last statement is ignored by R and just executed on the command line.")

--------------------------------------------------------------------------------------------------

This example requires Essentia to have selected a datastore containing purchase log data:

Store these lines as querypurchase.sh:

ess query "select count(refID) from purchase:2014-09-01:2014-09-15 \
where articleID&gt;=46 group by price" #Rinclude
ess query "select count(distinct userID) from purchase:2014-09-01:2014-09-15 \
where articleID&gt;=46" #Rinclude
ess query "select count(refID) from purchase:2014-09-01:2014-09-15 \
where articleID&gt;=46 group by userID" #Rinclude
ess query "select * from purchase:*:* where articleID &lt;= 20" #Rinclude #R#querystream#R# #-notitle

-----------------------------------------------

Then run these commands in R:

library(RESS)
capture.essentia("querypurchase.sh")
print(command1)
print(command2)
print(command3)
print(querystream)

--------------------------------------------------------------------------------------------------

The following example requires Essentia to be installed with apache log data stored in it.

Store the following lines as queryapache.sh:

# Query the Essentia database logsapache3 and save the contents of vector3 in R as command1.
ess exec "aq_udb -exp logsapache3:vector3" --debug

# Query the Essentia database logsapache1 and save the sorted contents of vector1 in R as command2.
ess exec "aq_udb -exp logsapache1:vector1 -sort pagecount -dec" --debug

# Stream the last five lines of the file in category 125accesslogs between dates 2014-12-07 and
# 2014-12-07, convert them to csv, return them to R, and store them into an R dataframe singlefile.
ess stream 125accesslogs '2014-12-07' '2014-12-07' "tail -5 \
| logcnv -f,eok - -d ip:ip sep:' ' s:rlog sep:' ' s:rusr sep:' [' i,tim:time sep:'] \"' \
s,clf:req_line1 sep:' ' s,clf:req_line2 sep:' ' s,clf:req_line3 sep:'\" ' i:res_status sep:' ' \
i:res_size sep:' \"' s,clf:referrer sep:'\" \"' \
s,clf:user_agent sep:'\"' X | cat -" #Rinclude #R#singlefile#R#

# Stream the last five lines of the files in category 125accesslogs between dates 2014-11-30 and
# 2014-12-07, convert them to csv, and save them into R dataframes apachefiles1 and apachefiles2.
ess stream 125accesslogs '2014-11-30' '2014-12-07' "tail -5 \
| logcnv -f,eok - -d ip:ip sep:' ' s:rlog sep:' ' s:rusr sep:' [' i,tim:time sep:'] \"' \
s,clf:req_line1 sep:' ' s,clf:req_line2 sep:' ' s,clf:req_line3 sep:'\" ' i:res_status sep:' ' \
i:res_size sep:' \"' s,clf:referrer sep:'\" \"' s,clf:user_agent sep:'\"' X -notitle | cat -" \
#Rinclude #R#apachefiles#R# #Rseparate

-----------------------------------------------

Then run these commands in R:

library(RESS)
capture.essentia("queryapache.sh")

print(command1)
print(command2)
print(singlefile)
print(apachefiles1)
print(apachefiles2)

The references contain more extensive examples that
fully walkthrough how to load and query the Essentia Database.


## End(Not run)
</code></pre>

<hr>
<h2 id='essQuery'>essQuery
</h2><span id='topic+essQuery'></span>

<h3>Description</h3>

<p>Query the Essentia database and return the results to R.</p>


<h3>Usage</h3>

<pre><code class='language-R'>essQuery(essentia, aq="", flags="")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="essQuery_+3A_essentia">essentia</code></td>
<td>

<p>The essentia command to run. The options are &quot;ess stream
category startdate enddate&quot;, &quot;ess exec&quot;, and &quot;ess query&quot;.
</p>
<p>Each stream or query command can be used to stream any number of files
directly into your R analysis. Alternatively, each stream command
can save multiple files into separate R dataframes, one file per dataframe.
</p>
<p>The default value for the essentia argument is &quot;ess
exec&quot;.
</p>
</td></tr>
<tr><td><code id="essQuery_+3A_aq">aq</code></td>
<td>

<p>This can be any combination of the aq_tools and standard UNIX
commands for &quot;ess stream&quot; and &quot;ess exec&quot; statements or an sql-like statement 
for &quot;ess query&quot; statements. However, the output MUST be in a 
csv format if you want R to capture the output. If you only want to 
run the command without R capturing the output, add &quot;#Rignore&quot; to the
flags argument.
</p>
</td></tr>
<tr><td><code id="essQuery_+3A_flags">flags</code></td>
<td>

<p>Any of the essentia flags can be used here in addition to any
of these RESS-specific flags:
</p>
<p><code>#Rignore</code> : Ignore an 'ess exec' statement. Do not
capture the output of the statement into R.
</p>
<p><code>#Rinclude</code> : Include an 'ess stream' or 'ess query' statement. 
Capture the output of the statement into R.
</p>
<p><code>#-notitle</code> : Tell R not to use the first line of the output
as the header.
</p>
<p><code>#Rseparate</code> : Can be used when saving multiple files into an
R dataframe using an 'ess stream' command. Saves each
file into a different R dataframe, entitled command1 to
commandN, where N is the number of files.
</p>
<p><code>#filelist</code> : Causes an extra dataframe to be stored in R that saves 
the list of files streamed into R when streaming multiple files.
</p>
<p><code>#R#name#R#</code> : Allows any automatically saved dataframe to be
renamed to whatever is entered in place of 'name'. This only
applies in essQuery when streaming multiple files with <code>#Rseparate</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>essQuery is used to directly query the database using a single
statement. You can call essQuery multiple times to run different
statements.
</p>
<p>However, you can also use capture.essentia to read all of the statements
in a file instead.  Thus if you plan to run multiple statements
that may be somewhat related to each other, it is recommended that
you use capture.essentia.
</p>


<h3>Value</h3>

<p>The value returned is the output from querying the database. This
can be saved into an R dataframe or directly analyzed in R.
</p>
<p>If you use essQuery to save multiple files into separate R dataframes
using a single stream command, the files are stored automatically
in R dataframes called command1 to commandN (where N is the number of files) 
and no value is returned. To change the name of the stored dataframes, use 
the #R#any_name#R# flag. The dataframes will then be stored as any_name1 to any_nameN.
</p>
<p>With #filelist, the extra dataframe is saved as commandN+1 by default, or 
any_nameN+1 if #R#any_name#R# is also used.
</p>


<h3>Author(s)</h3>

<p>Ben Waxer, Data Scientist with Auriq Systems.
</p>


<h3>References</h3>

<p>See our website at www.auriq.com or our documentation at
www.auriq.com/documentation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
--------------------------------------------------------------------------------------------------

These examples require Essentia to be installed:

fullexec &lt;- essQuery("ess exec", "echo -e '11,12,13\n4,5,6\n7,8,9' ","#-notitle")
print(fullexec)
defaultexec &lt;- essQuery("echo -e '11,12,13\n4,5,6\n7,8,9' ","#-notitle")
print(defaultexec)
essQuery("echo -e '11,12,13\n4,5,6\n7,8,9' ","#Rignore")
print("This last statement is ignored by R and just executed on the command line.")

--------------------------------------------------------------------------------------------------

This example requires Essentia to have selected a datastore containing purchase log data:

command1 &lt;- essQuery("ess query","select count(refID) from purchase:2014-09-01:2014-09-15 \
where articleID&gt;=46 group by price","#Rinclude")
command2 &lt;- essQuery("ess query", "select count(distinct userID) from \
purchase:2014-09-01:2014-09-15 where articleID&gt;=46", "#Rinclude")
command3 &lt;- essQuery("ess query", "select count(refID) from \
purchase:2014-09-01:2014-09-15 where articleID&gt;=46 group by userID", "#Rinclude")
querystream &lt;- essQuery("ess query", "select * from purchase:*:* where articleID &lt;= 20", "\
#Rinclude #-notitle")

Then run these commands to view the saved dataframes:

print(command1)
print(command2)
print(command3)
print(querystream)

--------------------------------------------------------------------------------------------------

The following example requires Essentia to be installed with apache log data stored in it:

# Query the Essentia database logsapache3 and return the contents of vector3 into R.
command1 &lt;- essQuery("aq_udb -exp logsapache3:vector3", "--debug")

# Query the Essentia database logsapache1 and return the sorted contents of vector1 into R.
command2 &lt;- essQuery("ess exec", "aq_udb -exp logsapache1:vector1 -sort pagecount -dec", "\
--debug")

# Stream the last five lines of the file in category 125accesslogs between dates 2014-12-07 and
# 2014-12-07, convert them to csv, return them to R, and store them into an R dataframe singlefile.
singlefile &lt;- essQuery("ess stream 125accesslogs '2014-12-07' '2014-12-07'","tail -5 \
| logcnv -f,eok - -d ip:ip sep:' ' s:rlog sep:' ' s:rusr sep:' [' i,tim:time sep:'] \\"' \
s,clf:req_line1 sep:' ' s,clf:req_line2 sep:' ' s,clf:req_line3 sep:'\\" ' i:res_status sep:' ' \
i:res_size sep:' \\"' s,clf:referrer sep:'\\" \\"' \
s,clf:user_agent sep:'\\"' X | cat -","#Rinclude")

# Stream the last five lines of the files in category 125accesslogs between dates 2014-11-30 and 
# 2014-12-07, convert them to csv, and save them into R dataframes apachefiles1 and apachefiles2.
essQuery("ess stream 125accesslogs '2014-11-30' '2014-12-07'","tail -5 \
| logcnv -f,eok - -d ip:ip sep:' ' s:rlog sep:' ' s:rusr sep:' [' i,tim:time sep:'] \\"' \
s,clf:req_line1 sep:' ' s,clf:req_line2 sep:' ' s,clf:req_line3 sep:'\\" ' i:res_status sep:' ' \
i:res_size sep:' \\"' s,clf:referrer sep:'\\" \\"' \
s,clf:user_agent sep:'\\"' X -notitle | cat -","\
#Rinclude #R#apachefiles#R# #Rseparate")

print(command1)
print(command2)
print(singlefile)
print(apachefiles1)
print(apachefiles2)

The references contain more extensive examples that 
fully walkthrough how to load and query the Essentia Database.

## End(Not run)
</code></pre>

<hr>
<h2 id='read.essentia'>read.essentia
</h2><span id='topic+read.essentia'></span>

<h3>Description</h3>

<p>Read the essentia commands in the stated file, and save the csv output into R. 
This command is primarily intended to capture the output of a query to the Essentia database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.essentia(file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.essentia_+3A_file">file</code></td>
<td>

<p>The essentia script to run and any arguments you want to pass into the bash script. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>read.essentia is used to directly query the database using a script with a single
csv formatted output. You can call read.essentia multiple times to run statements 
that produce different outputs and capture their respective output into R.
</p>
<p>However, you can also use capture.essentia to read all of the statements
in a file instead and capture the output of any or all of the statements.  
Thus if you plan to run multiple statements that may be somewhat related
to each other, you may want to use capture.essentia.
</p>


<h3>Value</h3>

<p>The value returned is the output from querying the database. This
can be saved into an R dataframe or directly analyzed in R.
</p>


<h3>Note</h3>

<p>The argument, file, can also include the following flag:
</p>
<p><code>#-notitle</code> : Tell R not to use the first line of the output
as the header.
</p>


<h3>Author(s)</h3>

<p>Ben Waxer, Data Scientist with Auriq Systems.
</p>


<h3>References</h3>

<p>See our website at www.auriq.com or our documentation at
www.auriq.com/documentation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
--------------------------------------------------------------------------------------------------

These examples require Essentia to be installed:

queryfile &lt;- file("examplequery.sh","w")
cat("ess exec \"echo -e '11,12,13\n4,5,6\n7,8,9'\" \n", file=queryfile)
simpleecho &lt;- read.essentia("examplequery.sh")
print(simpleecho)

--------------------------------------------------------------------------------------------------

This example requires Essentia to have selected a datastore containing purchase log data:

Store these lines as querypurchase.sh:

ess query "select count(refID) from purchase:2014-09-01:2014-09-15 \
where articleID&gt;=46 group by userID"

-----------------------------------------------

Then run these commands in R:

library(RESS)
print(read.essentia("querypurchase.sh"))


--------------------------------------------------------------------------------------------------

The following example requires Essentia to be installed with apache log data stored in it.

Store the following lines as queryapache.sh:

# Query the Essentia database logsapache1 and save the sorted contents of vector1 in R as command2.
ess exec "aq_udb -exp logsapache1:vector1 -sort pagecount -dec"


-----------------------------------------------

Then run these commands in R:

library(RESS)
mydata &lt;- read.essentia("queryapache.sh")

print(mydata)


The references contain more extensive examples that
fully walkthrough how to load and query the Essentia Database.


## End(Not run)
</code></pre>

<hr>
<h2 id='RESS-package'>
Integrates R and Essentia.
</h2><span id='topic+RESS-package'></span><span id='topic+RESS'></span>

<h3>Description</h3>

<p>Contains three functions that query AuriQ Systems' Essentia Database and return the results in R. 
</p>
<p>'essQuery' takes a single Essentia command and captures the output
in R, where you can save the output to a dataframe or stream it 
directly into additional analysis. 
</p>
<p>'read.essentia' takes an Essentia script and captures the output 
csv data into R, where you can save the output to a dataframe or 
stream it directly into additional analysis. 
</p>
<p>'capture.essentia' takes a file containing any number of Essentia
commands and captures the output of the specified statements into
R dataframes. 
</p>
<p>Essentia can be downloaded for free at http://www.auriq.com/documentation/source/install/index.html.
</p>




<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> RESS</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-10-26</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> LGPL-3 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Ben Waxer, Data Scientist with Auriq Systems.
</p>
<p>Maintainer: Ben Waxer &lt;bwaxer@auriq.com&gt;
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
