<!DOCTYPE html><html lang="en"><head><title>Help for package dcortools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dcortools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dcmatrix'><p>Calculates distance covariance and distance correlation matrices</p></a></li>
<li><a href='#dcorgaussianbiv'><p>Calculates distance correlation from Pearson correlation under assumption of a bivariate normal distribution</p></a></li>
<li><a href='#dcsis'><p>Performs distance correlation sure independence screening (Li et al. 2012) with some additional options (such as calculating corresponding tests).</p></a></li>
<li><a href='#distcor'><p>Calculates the distance correlation (Szekely et al. 2007; Szekely and Rizzo 2009).</p></a></li>
<li><a href='#distcov'><p>Calculates the distance covariance (Szekely et al. 2007; Szekely and Rizzo 2009).</p></a></li>
<li><a href='#distcov.test'><p>Performs a distance covariance test.</p></a></li>
<li><a href='#distsd'><p>Calculates the distance standard deviation (Edelmann et al. 2020).</p></a></li>
<li><a href='#extract_np'><p>Extract the dimensions of X.</p></a></li>
<li><a href='#hsplot'><p>Plots Pearson/Spearman/Kendall correlation against distance correlation (often resembling a horseshoe(hs)).</p></a></li>
<li><a href='#ipcw.dcor'><p>Calculates an inverse-probability-of-censoring weighted (IPCW) distance correlation based on IPCW U-statistics (Datta et al. 2010).</p></a></li>
<li><a href='#ipcw.dcov'><p>Calculates an inverse-probability-of-censoring weighted (IPCW) distance covariance based on IPCW U-statistics (Datta et al. 2010).</p></a></li>
<li><a href='#ipcw.dcov.test'><p>Performs a permutation test based on the IPCW distance covariance.</p></a></li>
<li><a href='#plot.dcmatrix'><p>Plots a heatmap from a dcmatrix object using the function &quot;pheatmap&quot; from the package &quot;pheatmap&quot;.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Providing Fast and Flexible Functions for Distance Correlation
Analysis</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides methods for distance covariance and distance correlation (Szekely, et al. (2007) &lt;<a href="https://doi.org/10.1214%2F009053607000000505">doi:10.1214/009053607000000505</a>&gt;), generalized version thereof (Sejdinovic, et al. (2013) &lt;<a href="https://doi.org/10.1214%2F13-AOS1140">doi:10.1214/13-AOS1140</a>&gt;) and corresponding tests (Berschneider, Bottcher (2018) &lt;<a href="https://doi.org/10.48550/arXiv.1808.07280">doi:10.48550/arXiv.1808.07280</a>&gt;. Distance standard deviation methods (Edelmann, et al. (2020) &lt;<a href="https://doi.org/10.1214%2F19-AOS1935">doi:10.1214/19-AOS1935</a>&gt;) and distance correlation methods for survival endpoints (Edelmann, et al. (2021) &lt;<a href="https://doi.org/10.1111%2Fbiom.13470">doi:10.1111/biom.13470</a>&gt;) are also included.</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.6</td>
</tr>
<tr>
<td>Depends:</td>
<td>Rdpack, R (&ge; 3.3.3), Rcpp (&ge; 0.11.0), Rfast</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, pheatmap, Hmisc, stats</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>RcppArmadillo, Rcpp, RcppEigen</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-12-09 15:15:30 UTC; edelmand</td>
</tr>
<tr>
<td>Author:</td>
<td>Dominic Edelmann [aut, cre],
  Jochen Fiedler [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dominic Edelmann &lt;dominic.edelmann@dkfz-heidelberg.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-12-09 23:50:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='dcmatrix'>Calculates distance covariance and distance correlation matrices</h2><span id='topic+dcmatrix'></span>

<h3>Description</h3>

<p>Calculates distance covariance and distance correlation matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dcmatrix(
  X,
  Y = NULL,
  calc.dcov = TRUE,
  calc.dcor = TRUE,
  calc.cor = "none",
  calc.pvalue.cor = FALSE,
  return.data = TRUE,
  test = "none",
  adjustp = "none",
  b = 499,
  affine = FALSE,
  standardize = FALSE,
  bias.corr = FALSE,
  group.X = NULL,
  group.Y = NULL,
  metr.X = "euclidean",
  metr.Y = "euclidean",
  use = "all",
  algorithm = "auto",
  fc.discrete = FALSE,
  calc.dcor.pw = FALSE,
  calc.dcov.pw = FALSE,
  test.pw = "none",
  metr.pw.X = "euclidean",
  metr.pw.Y = "euclidean"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dcmatrix_+3A_x">X</code></td>
<td>
<p>A data.frame or matrix.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_y">Y</code></td>
<td>
<p>Either NULL or a data.frame or a matrix with the same number of rows as X. If only X is provided, distance covariances/correlations are calculated between all groups in X. If X and Y are provided, distance covariances/correlations are calculated between all groups in X and all groups of Y.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_calc.dcov">calc.dcov</code></td>
<td>
<p>logical; specifies if the distance covariance matrix is calculated.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_calc.dcor">calc.dcor</code></td>
<td>
<p>logical; specifies if the distance correlation matrix is calculated.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_calc.cor">calc.cor</code></td>
<td>
<p>If set as &quot;pearson&quot;, &quot;spearman&quot; or &quot;kendall&quot;, a corresponding correlation matrix is additionally calculated.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_calc.pvalue.cor">calc.pvalue.cor</code></td>
<td>
<p>logical; IF TRUE, a p-value based on the Pearson or Spearman correlation matrix is calculated (not implemented for calc.cor =&quot;kendall&quot;) using Hmisc::rcorr.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_return.data">return.data</code></td>
<td>
<p>logical; specifies if the dcmatrix object should contain the original data.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_test">test</code></td>
<td>
<p>specifies the type of test that is performed, &quot;permutation&quot; performs a Monte Carlo Permutation test. &quot;gamma&quot; performs a test based on a gamma approximation of the test statistic under the null. &quot;conservative&quot; performs a conservative two-moment approximation. &quot;bb3&quot; performs a quite precise three-moment approximation and is recommended when computation time is not an issue.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_adjustp">adjustp</code></td>
<td>
<p>If setting this parameter to &quot;holm&quot;, &quot;hochberg&quot;, &quot;hommel&quot;, &quot;bonferroni&quot;, &quot;BH&quot;, &quot;BY&quot; or &quot;fdr&quot;, corresponding adjusted p-values are additionally returned for the distance covariance test.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_b">b</code></td>
<td>
<p>specifies the number of random permutations used for the permutation test. Ignored for all other tests.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_affine">affine</code></td>
<td>
<p>logical; indicates if the affinely transformed distance covariance should be calculated or not.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_standardize">standardize</code></td>
<td>
<p>specifies if data should be standardized dividing each component by its standard deviations. No effect when affine = TRUE.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_bias.corr">bias.corr</code></td>
<td>
<p>logical; specifies if the bias corrected version of the sample distance covariance (Huo and Szekely 2016) should be calculated.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_group.x">group.X</code></td>
<td>
<p>A vector, each entry specifying the group membership of the respective column in X. Each group is handled as one sample for calculating the distance covariance/correlation matrices. If NULL, every sample is handled as an individual group.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_group.y">group.Y</code></td>
<td>
<p>A vector, each entry specifying the group membership of the respective column in Y. Each group is handled as one sample for calculating the distance covariance/correlation matrices. If NULL, every sample is handled as an individual group.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_metr.x">metr.X</code></td>
<td>
<p>Either a single metric or a list providing a metric for each group in X (see examples).</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_metr.y">metr.Y</code></td>
<td>
<p>see metr.X.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_use">use</code></td>
<td>
<p>&quot;all&quot; uses all observations, &quot;complete.obs&quot; excludes NAs, &quot;pairwise.complete.obs&quot; uses pairwise complete observations for each comparison.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_algorithm">algorithm</code></td>
<td>
<p>specifies the algorithm used for calculating the distance covariance. 
</p>
<p>&quot;fast&quot; uses an O(n log n) algorithm if the observations are one-dimensional and metr.X and metr.Y are either &quot;euclidean&quot; or &quot;discrete&quot;, see also Huo and Szekely (2016). 
</p>
<p>&quot;memsave&quot; uses a memory saving version of the standard algorithm with computational complexity O(n^2) but requiring only O(n) memory. 
</p>
<p>&quot;standard&quot; uses the classical algorithm. User-specified metrics always use the classical algorithm.
</p>
<p>&quot;auto&quot; chooses the best algorithm for the specific setting using a rule of thumb.
</p>
<p>&quot;memsave&quot; is typically very inefficient for dcmatrix and should only be applied in exceptional cases.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_fc.discrete">fc.discrete</code></td>
<td>
<p>logical; If TRUE, &quot;discrete&quot; metric is applied automatically on samples of type &quot;factor&quot; or &quot;character&quot;.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_calc.dcor.pw">calc.dcor.pw</code></td>
<td>
<p>logical; If TRUE, a distance correlation matrix between the univariate observations/columns is additionally calculated. Not meaningful if group.X and group.Y are not specified.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_calc.dcov.pw">calc.dcov.pw</code></td>
<td>
<p>logical; If TRUE, a distance covariance matrix between the univariate observations/columns is additionally calculated. Not meaningful if group.X and group.Y are not specified.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_test.pw">test.pw</code></td>
<td>
<p>specifies a test (see argument &quot;test&quot;) that is performed between all single observations.</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_metr.pw.x">metr.pw.X</code></td>
<td>
<p>Either a single metric or a list providing a metric for each single observation/column in X (see metr.X).</p>
</td></tr>
<tr><td><code id="dcmatrix_+3A_metr.pw.y">metr.pw.Y</code></td>
<td>
<p>See metr.pw.Y.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>S3 object of class &quot;dcmatrix&quot; with the following components
</p>
<table role = "presentation">
<tr><td><code>name X</code>, <code>Y</code></td>
<td>
<p>description original data (if return.data = TRUE).</p>
</td></tr> 
<tr><td><code>name dcov</code>, <code>dcor</code></td>
<td>
<p>distance covariance/correlation matrices between the groups specified in group.X/group.Y (if calc.dcov/calc.dcor = TRUE).</p>
</td></tr> 
<tr><td><code>name corr</code></td>
<td>
<p>correlation matrix between the univariate observations/columns (if cal.cor is &quot;pearson&quot;, &quot;spearman&quot; or &quot;kendall&quot;).</p>
</td></tr>
<tr><td><code>name pvalue</code></td>
<td>
<p>matrix of p-values based on a corresponding distance covariance test based on the entries in dcov (if argument test is not &quot;none&quot;).</p>
</td></tr> 
<tr><td><code>name pvalue.adj</code></td>
<td>
<p>matrix of p-values adjusted for multiple comparisons using the method specified in argument adjustp.</p>
</td></tr> 
<tr><td><code>name pvalue.cor</code></td>
<td>
<p>matrix of pvalues based on &quot;pearson&quot;/&quot;spearman&quot; correlation (if calc.cor is &quot;pearson&quot; or &quot;spearman&quot; and calc.pvalue.cor = TRUE).</p>
</td></tr>
<tr><td><code>name dcov.pw</code>, <code>dcor.pw</code></td>
<td>
<p>distance covariance/correlation matrices between the univariate observations (if calc.dcov.pw/calc.dcor.pw = TRUE.)</p>
</td></tr> 
<tr><td><code>name pvalue.pw</code></td>
<td>
<p>matrix of p-values based on a corresponding distance covariance test based on the entries in dcov.pw (if argument test is not &quot;none&quot;).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Berschneider G, Bottcher B (2018).
&ldquo;On complex Gaussian random fields, Gaussian quadratic forms and sample distance multivariance.&rdquo;
<em>arXiv preprint arXiv:1808.07280</em>.
</p>
<p>Bottcher B, Keller-Ressel M, Schilling RL (2018).
&ldquo;Detecting independence of random vectors: generalized distance covariance and Gaussian covariance.&rdquo;
<em>Modern Stochastics: Theory and Applications</em>, <b>3</b>, 353&ndash;383.
</p>
<p>Dueck J, Edelmann D, Gneiting T, Richards D (2014).
&ldquo;The affinely invariant distance correlation.&rdquo;
<em>Bernoulli</em>, <b>20</b>, 2305&ndash;2330.
</p>
<p>Huang C, Huo X (2017).
&ldquo;A statistically and numerically efficient independence test based on random projections and distance covariance.&rdquo;
<em>arXiv preprint arXiv:1701.06054</em>.
</p>
<p>Huo X, Szekely GJ (2016).
&ldquo;Fast computing for distance covariance.&rdquo;
<em>Technometrics</em>, <b>58</b>(4), 435&ndash;447.
</p>
<p>Lyons R (2013).
&ldquo;Distance covariance in metric spaces.&rdquo;
<em>The Annals of Probability</em>, <b>41</b>, 3284&ndash;3305.
</p>
<p>Sejdinovic D, Sriperumbudur B, Gretton A, Fukumizu K (2013).
&ldquo;Equivalence of distance-based and RKHS-based statistics in hypothesis testing.&rdquo;
<em>The Annals of Statistics</em>, <b>41</b>, 2263&ndash;2291.
</p>
<p>Szekely GJ, Rizzo ML, Bakirov NK (2007).
&ldquo;Measuring and testing dependence by correlation of distances.&rdquo;
<em>The Annals of Statistics</em>, <b>35</b>, 2769&ndash;2794.
</p>
<p>Szekely GJ, Rizzo ML (2009).
&ldquo;Brownian distance covariance.&rdquo;
<em>The Annals of Applied Statistics</em>, <b>3</b>, 1236&ndash;1265.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(rnorm(1000), ncol = 10)

dcm &lt;- dcmatrix(X, test="bb3",calc.cor = "pearson",
 calc.pvalue.cor = TRUE, adjustp = "BH") 
 
dcm &lt;- dcmatrix(X, test="bb3",calc.cor = "pearson", 
 calc.pvalue.cor = TRUE, adjustp = "BH", 
 group.X = c(rep(1, 5), rep(2, 5)), 
 calc.dcor.pw = TRUE, test.pw = "bb3")


Y &lt;- matrix(rnorm(600), ncol = 6)

Y[,6] &lt;- rbinom(100, 4, 0.3)

dcm &lt;- dcmatrix(X, Y, test="bb3",calc.cor = "pearson",
 calc.pvalue.cor = TRUE, adjustp = "BH")
  
dcm &lt;- dcmatrix(X, Y, test="bb3",calc.cor = "pearson",
 calc.pvalue.cor = TRUE, adjustp = "BH",
 group.X = c(rep("group1", 5), rep("group2", 5)),
 group.Y = c(rep("group1", 5), "group2"), 
 metr.X = "gaussauto",
 metr.Y = list("group1" = "gaussauto", "group2" = "discrete"))
</code></pre>

<hr>
<h2 id='dcorgaussianbiv'>Calculates distance correlation from Pearson correlation under assumption of a bivariate normal distribution</h2><span id='topic+dcorgaussianbiv'></span>

<h3>Description</h3>

<p>Calculates distance correlation from Pearson correlation under assumption of a bivariate normal distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dcorgaussianbiv(rho)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dcorgaussianbiv_+3A_rho">rho</code></td>
<td>
<p>Pearson correlation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Distance correlation assuming a bivariate normal distribution
</p>

<hr>
<h2 id='dcsis'>Performs distance correlation sure independence screening (Li et al. 2012) with some additional options (such as calculating corresponding tests).</h2><span id='topic+dcsis'></span>

<h3>Description</h3>

<p>Performs distance correlation sure independence screening (Li et al. 2012) with some additional options (such as calculating corresponding tests).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dcsis(
  X,
  Y,
  k = floor(nrow(X)/log(nrow(X))),
  threshold = NULL,
  calc.cor = "spearman",
  calc.pvalue.cor = FALSE,
  return.data = FALSE,
  test = "none",
  adjustp = "none",
  b = 499,
  bias.corr = FALSE,
  use = "all",
  algorithm = "auto"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dcsis_+3A_x">X</code></td>
<td>
<p>A dataframe or matrix.</p>
</td></tr>
<tr><td><code id="dcsis_+3A_y">Y</code></td>
<td>
<p>A vector-valued response having the same length as the number of rows of X.</p>
</td></tr>
<tr><td><code id="dcsis_+3A_k">k</code></td>
<td>
<p>Number of variables that are selected (only used when threshold is not provided).</p>
</td></tr>
<tr><td><code id="dcsis_+3A_threshold">threshold</code></td>
<td>
<p>If provided, variables with a distance correlation larger than threshold are selected.</p>
</td></tr>
<tr><td><code id="dcsis_+3A_calc.cor">calc.cor</code></td>
<td>
<p>If set as &quot;pearson&quot;, &quot;spearman&quot; or &quot;kendall&quot;, a corresponding correlation matrix is additionally calculated.</p>
</td></tr>
<tr><td><code id="dcsis_+3A_calc.pvalue.cor">calc.pvalue.cor</code></td>
<td>
<p>logical; IF TRUE, a p-value based on the Pearson or Spearman correlation matrix is calculated (not implemented for calc.cor = &quot;kendall&quot;) using Hmisc::rcorr.</p>
</td></tr>
<tr><td><code id="dcsis_+3A_return.data">return.data</code></td>
<td>
<p>logical; specifies if the dcmatrix object should contain the original data.</p>
</td></tr>
<tr><td><code id="dcsis_+3A_test">test</code></td>
<td>
<p>Allows for additionally calculating a test based on distance Covariance. Specifies the type of test that is performed, &quot;permutation&quot; performs a Monte Carlo Permutation test. &quot;gamma&quot; performs a test based on a gamma approximation of the test statistic under the null. &quot;conservative&quot; performs a conservative two-moment approximation. &quot;bb3&quot; performs a quite precise three-moment approximation and is recommended when computation time is not an issue.</p>
</td></tr>
<tr><td><code id="dcsis_+3A_adjustp">adjustp</code></td>
<td>
<p>If setting this parameter to &quot;holm&quot;, &quot;hochberg&quot;, &quot;hommel&quot;, &quot;bonferroni&quot;, &quot;BH&quot;, &quot;BY&quot; or &quot;fdr&quot;, corresponding adjusted p-values are additionally returned for the distance covariance test.</p>
</td></tr>
<tr><td><code id="dcsis_+3A_b">b</code></td>
<td>
<p>specifies the number of random permutations used for the permutation test. Ignored for all other tests.</p>
</td></tr>
<tr><td><code id="dcsis_+3A_bias.corr">bias.corr</code></td>
<td>
<p>logical; specifies if the bias corrected version of the sample distance covariance (Huo and Szekely 2016) should be calculated.</p>
</td></tr>
<tr><td><code id="dcsis_+3A_use">use</code></td>
<td>
<p>&quot;all&quot; uses all observations, &quot;complete.obs&quot; excludes NAs, &quot;pairwise.complete.obs&quot; uses pairwise complete observations for each comparison.</p>
</td></tr>
<tr><td><code id="dcsis_+3A_algorithm">algorithm</code></td>
<td>
<p>specifies the algorithm used for calculating the distance covariance. 
</p>
<p>&quot;fast&quot; uses an O(n log n) algorithm if the observations are one-dimensional and metr.X and metr.Y are either &quot;euclidean&quot; or &quot;discrete&quot;, see also Huo and Szekely (2016). 
</p>
<p>&quot;memsave&quot; uses a memory saving version of the standard algorithm with computational complexity O(n^2) but requiring only O(n) memory. 
</p>
<p>&quot;standard&quot; uses the classical algorithm. User-specified metrics always use the classical algorithm.
</p>
<p>&quot;auto&quot; chooses the best algorithm for the specific setting using a rule of thumb.
</p>
<p>&quot;memsave&quot; is typically very inefficient for dcsis and should only be applied in exceptional cases.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dcmatrix object with the following two additional slots:
</p>
<table role = "presentation">
<tr><td><code>name selected</code></td>
<td>
<p>description indices of selected variables.</p>
</td></tr> 
<tr><td><code>name dcor.selected</code></td>
<td>
<p>distance correlation of the selected variables and the response Y.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Berschneider G, Bottcher B (2018).
&ldquo;On complex Gaussian random fields, Gaussian quadratic forms and sample distance multivariance.&rdquo;
<em>arXiv preprint arXiv:1808.07280</em>.
Dueck J, Edelmann D, Gneiting T, Richards D (2014).
&ldquo;The affinely invariant distance correlation.&rdquo;
<em>Bernoulli</em>, <b>20</b>, 2305&ndash;2330.
</p>
<p>Huang C, Huo X (2017).
&ldquo;A statistically and numerically efficient independence test based on random projections and distance covariance.&rdquo;
<em>arXiv preprint arXiv:1701.06054</em>.
</p>
<p>Huo X, Szekely GJ (2016).
&ldquo;Fast computing for distance covariance.&rdquo;
<em>Technometrics</em>, <b>58</b>(4), 435&ndash;447.
</p>
<p>Li R, Zhong W, Zhu L (2012).
&ldquo;Feature screening via distance correlation learning.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>107</b>(499), 1129&ndash;1139.
</p>
<p>Szekely GJ, Rizzo ML, Bakirov NK (2007).
&ldquo;Measuring and testing dependence by correlation of distances.&rdquo;
<em>The Annals of Statistics</em>, <b>35</b>, 2769&ndash;2794.
</p>
<p>Szekely GJ, Rizzo ML (2009).
&ldquo;Brownian distance covariance.&rdquo;
<em>The Annals of Applied Statistics</em>, <b>3</b>, 1236&ndash;1265.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(rnorm(1e5), ncol = 1000)
Y &lt;- sapply(1:100, function(u) sum(X[u, 1:50])) + rnorm(100)
a &lt;- dcsis(X, Y)
</code></pre>

<hr>
<h2 id='distcor'>Calculates the distance correlation (Szekely et al. 2007; Szekely and Rizzo 2009).</h2><span id='topic+distcor'></span>

<h3>Description</h3>

<p>Calculates the distance correlation (Szekely et al. 2007; Szekely and Rizzo 2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distcor(
  X,
  Y,
  affine = FALSE,
  standardize = FALSE,
  bias.corr = FALSE,
  type.X = "sample",
  type.Y = "sample",
  metr.X = "euclidean",
  metr.Y = "euclidean",
  use = "all",
  algorithm = "auto"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distcor_+3A_x">X</code></td>
<td>
<p>contains either the first  sample or its corresponding distance matrix.
</p>
<p>In the first case, X can be provided either as a vector (if one-dimensional), a matrix or a data.frame (if two-dimensional or higher). 
</p>
<p>In the second case, the input must be a distance matrix corresponding to the sample of interest.
</p>
<p>If X is a sample, type.X must be specified as &quot;sample&quot;. If X is a distance matrix, type.X must be specified as &quot;distance&quot;.</p>
</td></tr>
<tr><td><code id="distcor_+3A_y">Y</code></td>
<td>
<p>see X.</p>
</td></tr>
<tr><td><code id="distcor_+3A_affine">affine</code></td>
<td>
<p>logical; specifies if the affinely invariant distance correlation (Dueck et al. 2014) should be calculated or not.</p>
</td></tr>
<tr><td><code id="distcor_+3A_standardize">standardize</code></td>
<td>
<p>logical; specifies if X and Y should be standardized dividing each component by its standard deviations. No effect when affine = TRUE.</p>
</td></tr>
<tr><td><code id="distcor_+3A_bias.corr">bias.corr</code></td>
<td>
<p>logical; specifies if the bias corrected version of the sample distance correlation (Huo and Szekely 2016) should be calculated.</p>
</td></tr>
<tr><td><code id="distcor_+3A_type.x">type.X</code></td>
<td>
<p>For &quot;distance&quot;, X is interpreted as a distance matrix. For &quot;sample&quot;, X is interpreted as a sample.</p>
</td></tr>
<tr><td><code id="distcor_+3A_type.y">type.Y</code></td>
<td>
<p>see type.X.</p>
</td></tr>
<tr><td><code id="distcor_+3A_metr.x">metr.X</code></td>
<td>
<p>specifies the metric which should be used to compute the distance matrix for X (ignored when type.X = &quot;distance&quot;).
</p>
<p>Options are &quot;euclidean&quot;, &quot;discrete&quot;, &quot;alpha&quot;, &quot;minkowski&quot;, &quot;gaussian&quot;, &quot;gaussauto&quot;, &quot;boundsq&quot; or user-specified metrics (see examples).
</p>
<p>For &quot;alpha&quot;, &quot;minkowski&quot;, &quot;gaussian&quot;, &quot;gaussauto&quot; and &quot;boundsq&quot;, the corresponding parameters are specified via &quot;c(metric, parameter)&quot;, e.g. c(&quot;gaussian&quot;, 3) for a Gaussian metric with bandwidth parameter 3; the default parameter is 2 for &quot;minkowski&quot; and &quot;1&quot; for all other metrics.
</p>
<p>See Lyons (2013); Sejdinovic et al. (2013); Bottcher et al. (2018) for details.</p>
</td></tr>
<tr><td><code id="distcor_+3A_metr.y">metr.Y</code></td>
<td>
<p>see metr.X.</p>
</td></tr>
<tr><td><code id="distcor_+3A_use">use</code></td>
<td>
<p>specifies how to treat missing values. &quot;complete.obs&quot; excludes observations containing NAs, &quot;all&quot; uses all observations.</p>
</td></tr>
<tr><td><code id="distcor_+3A_algorithm">algorithm</code></td>
<td>
<p>specifies the algorithm used for calculating the distance correlation. 
</p>
<p>&quot;fast&quot; uses an O(n log n) algorithm if the observations are one-dimensional and metr.X and metr.Y are either &quot;euclidean&quot; or &quot;discrete&quot;, see also Huo and Szekely (2016). 
</p>
<p>&quot;memsave&quot; uses a memory saving version of the standard algorithm with computational complexity O(n^2) but requiring only O(n) memory. 
</p>
<p>&quot;standard&quot; uses the classical algorithm. User-specified metrics always use the classical algorithm.
</p>
<p>&quot;auto&quot; chooses the best algorithm for the specific setting using a rule of thumb.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric; the distance correlation between samples X and Y.
</p>


<h3>References</h3>

<p>Bottcher B, Keller-Ressel M, Schilling RL (2018).
&ldquo;Detecting independence of random vectors: generalized distance covariance and Gaussian covariance.&rdquo;
<em>Modern Stochastics: Theory and Applications</em>, <b>3</b>, 353&ndash;383.
</p>
<p>Dueck J, Edelmann D, Gneiting T, Richards D (2014).
&ldquo;The affinely invariant distance correlation.&rdquo;
<em>Bernoulli</em>, <b>20</b>, 2305&ndash;2330.
</p>
<p>Huo X, Szekely GJ (2016).
&ldquo;Fast computing for distance covariance.&rdquo;
<em>Technometrics</em>, <b>58</b>(4), 435&ndash;447.
</p>
<p>Lyons R (2013).
&ldquo;Distance covariance in metric spaces.&rdquo;
<em>The Annals of Probability</em>, <b>41</b>, 3284&ndash;3305.
</p>
<p>Sejdinovic D, Sriperumbudur B, Gretton A, Fukumizu K (2013).
&ldquo;Equivalence of distance-based and RKHS-based statistics in hypothesis testing.&rdquo;
<em>The Annals of Statistics</em>, <b>41</b>, 2263&ndash;2291.
</p>
<p>Szekely GJ, Rizzo ML, Bakirov NK (2007).
&ldquo;Measuring and testing dependence by correlation of distances.&rdquo;
<em>The Annals of Statistics</em>, <b>35</b>, 2769&ndash;2794.
</p>
<p>Szekely GJ, Rizzo ML (2009).
&ldquo;Brownian distance covariance.&rdquo;
<em>The Annals of Applied Statistics</em>, <b>3</b>, 1236&ndash;1265.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- rnorm(200)
Y &lt;- rnorm(200)
Z &lt;- X + rnorm(200)
dim(X) &lt;- dim(Y) &lt;- dim(Z) &lt;- c(20, 10)

#Demonstration that biased-corrected distance correlation is
#often more meaningful than without using bias-correction

distcor(X, Y) 
distcor(X, Z) 
distcor(X, Y, bias.corr = TRUE)
distcor(X, Z, bias.corr = TRUE)

#For more examples of the different options,
#see the documentation of distcov.
</code></pre>

<hr>
<h2 id='distcov'>Calculates the distance covariance (Szekely et al. 2007; Szekely and Rizzo 2009).</h2><span id='topic+distcov'></span>

<h3>Description</h3>

<p>Calculates the distance covariance (Szekely et al. 2007; Szekely and Rizzo 2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distcov(
  X,
  Y,
  affine = FALSE,
  standardize = FALSE,
  bias.corr = FALSE,
  type.X = "sample",
  type.Y = "sample",
  metr.X = "euclidean",
  metr.Y = "euclidean",
  use = "all",
  algorithm = "auto"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distcov_+3A_x">X</code></td>
<td>
<p>contains either the first  sample or its corresponding distance matrix.
</p>
<p>In the first case, X can be provided either as a vector (if one-dimensional), a matrix or a data.frame (if two-dimensional or higher). 
</p>
<p>In the second case, the input must be a distance matrix corresponding to the sample of interest.
</p>
<p>If X is a sample, type.X must be specified as &quot;sample&quot;. If X is a distance matrix, type.X must be specified as &quot;distance&quot;.</p>
</td></tr>
<tr><td><code id="distcov_+3A_y">Y</code></td>
<td>
<p>see X.</p>
</td></tr>
<tr><td><code id="distcov_+3A_affine">affine</code></td>
<td>
<p>logical; specifies if the affinely invariant distance covariance (Dueck et al. 2014) should be calculated or not.</p>
</td></tr>
<tr><td><code id="distcov_+3A_standardize">standardize</code></td>
<td>
<p>logical; specifies if X and Y should be standardized dividing each component by its standard deviations. No effect when affine = TRUE.</p>
</td></tr>
<tr><td><code id="distcov_+3A_bias.corr">bias.corr</code></td>
<td>
<p>logical; specifies if the bias corrected version of the sample distance covariance (Huo and Szekely 2016) should be calculated.</p>
</td></tr>
<tr><td><code id="distcov_+3A_type.x">type.X</code></td>
<td>
<p>For &quot;distance&quot;, X is interpreted as a distance matrix. For &quot;sample&quot;, X is interpreted as a sample.</p>
</td></tr>
<tr><td><code id="distcov_+3A_type.y">type.Y</code></td>
<td>
<p>see type.X.</p>
</td></tr>
<tr><td><code id="distcov_+3A_metr.x">metr.X</code></td>
<td>
<p>specifies the metric which should be used to compute the distance matrix for X (ignored when type.X = &quot;distance&quot;).
</p>
<p>Options are &quot;euclidean&quot;, &quot;discrete&quot;, &quot;alpha&quot;, &quot;minkowski&quot;, &quot;gaussian&quot;, &quot;gaussauto&quot;, &quot;boundsq&quot; or user-specified metrics (see examples).
</p>
<p>For &quot;alpha&quot;, &quot;minkowski&quot;, &quot;gaussian&quot;, &quot;gaussauto&quot; and &quot;boundsq&quot;, the corresponding parameters are specified via &quot;c(metric, parameter)&quot;, e.g. c(&quot;gaussian&quot;, 3) for a Gaussian metric with bandwidth parameter 3; the default parameter is 2 for &quot;minkowski&quot; and &quot;1&quot; for all other metrics.
</p>
<p>See Lyons (2013); Sejdinovic et al. (2013); Bottcher et al. (2018) for details.</p>
</td></tr>
<tr><td><code id="distcov_+3A_metr.y">metr.Y</code></td>
<td>
<p>see metr.X.</p>
</td></tr>
<tr><td><code id="distcov_+3A_use">use</code></td>
<td>
<p>specifies how to treat missing values. &quot;complete.obs&quot; excludes observations containing NAs, &quot;all&quot; uses all observations.</p>
</td></tr>
<tr><td><code id="distcov_+3A_algorithm">algorithm</code></td>
<td>
<p>specifies the algorithm used for calculating the distance covariance. 
</p>
<p>&quot;fast&quot; uses an O(n log n) algorithm if the observations are one-dimensional and metr.X and metr.Y are either &quot;euclidean&quot; or &quot;discrete&quot;, see also Huo and Szekely (2016). 
</p>
<p>&quot;memsave&quot; uses a memory saving version of the standard algorithm with computational complexity O(n^2) but requiring only O(n) memory. 
</p>
<p>&quot;standard&quot; uses the classical algorithm. User-specified metrics always use the classical algorithm.
</p>
<p>&quot;auto&quot; chooses the best algorithm for the specific setting using a rule of thumb.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric; the distance covariance between samples X and Y.
</p>


<h3>References</h3>

<p>Bottcher B, Keller-Ressel M, Schilling RL (2018).
&ldquo;Detecting independence of random vectors: generalized distance covariance and Gaussian covariance.&rdquo;
<em>Modern Stochastics: Theory and Applications</em>, <b>3</b>, 353&ndash;383.
</p>
<p>Dueck J, Edelmann D, Gneiting T, Richards D (2014).
&ldquo;The affinely invariant distance correlation.&rdquo;
<em>Bernoulli</em>, <b>20</b>, 2305&ndash;2330.
</p>
<p>Huo X, Szekely GJ (2016).
&ldquo;Fast computing for distance covariance.&rdquo;
<em>Technometrics</em>, <b>58</b>(4), 435&ndash;447.
</p>
<p>Lyons R (2013).
&ldquo;Distance covariance in metric spaces.&rdquo;
<em>The Annals of Probability</em>, <b>41</b>, 3284&ndash;3305.
</p>
<p>Sejdinovic D, Sriperumbudur B, Gretton A, Fukumizu K (2013).
&ldquo;Equivalence of distance-based and RKHS-based statistics in hypothesis testing.&rdquo;
<em>The Annals of Statistics</em>, <b>41</b>, 2263&ndash;2291.
</p>
<p>Szekely GJ, Rizzo ML, Bakirov NK (2007).
&ldquo;Measuring and testing dependence by correlation of distances.&rdquo;
<em>The Annals of Statistics</em>, <b>35</b>, 2769&ndash;2794.
</p>
<p>Szekely GJ, Rizzo ML (2009).
&ldquo;Brownian distance covariance.&rdquo;
<em>The Annals of Applied Statistics</em>, <b>3</b>, 1236&ndash;1265.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- rnorm(100)
Y &lt;- X + 3 * rnorm(100)
distcov(X, Y) # standard distance covariance

distcov(X, Y, metr.X = "gaussauto", metr.Y = "gaussauto") 
# Gaussian distance with bandwidth choice based on median heuristic

distcov(X, Y, metr.X = c("alpha", 0.5), metr.Y = c("alpha", 0.5)) 
# alpha distance covariance with alpha = 0.5.


#Define a user-specified (slow) version of the alpha metric

alpha_user &lt;- function(X, prm = 1, kernel = FALSE) {
    as.matrix(dist(X)) ^ prm
}

distcov(X, Y, metr.X = c("alpha", 0.5), metr.Y = c("alpha", 0.5)) 
# Gives the same result as before.
   

#User-specified Gaussian kernel function  
     
gauss_kernel &lt;- function(X, prm = 1, kernel = TRUE)  {
    exp(as.matrix(dist(X)) ^ 2 / 2 / prm ^ 2)
}  

distcov(X, Y, metr.X = c("gauss_kernel", 2), metr.Y = c("gauss_kernel", 2)) 
# calculates the distance covariance using the corresponding kernel-induced metric

distcov(X, Y, metr.X = c("gaussian", 2), metr.Y = c("gaussian", 2)) 
# same result

Y &lt;- matrix(nrow = 100, ncol = 2)
X &lt;- rnorm(300)
dim(X) &lt;- c(100, 3)
Z &lt;- rnorm(100)
Y &lt;- matrix(nrow = 100, ncol = 2)
Y[, 1] &lt;- X[, 1] + Z
Y[, 2] &lt;- 3 * Z

distcov(X, Y) 

distcov(X, Y, affine = TRUE) 
# affinely invariant distance covariance

distcov(X, Y, standardize = TRUE) 
## distance covariance standardizing the components of X and Y

</code></pre>

<hr>
<h2 id='distcov.test'>Performs a distance covariance test.</h2><span id='topic+distcov.test'></span>

<h3>Description</h3>

<p>Performs a distance covariance test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distcov.test(
  X,
  Y,
  method = "permutation",
  b = 499L,
  ln = 20,
  affine = FALSE,
  standardize = FALSE,
  bias.corr = FALSE,
  type.X = "sample",
  type.Y = "sample",
  metr.X = "euclidean",
  metr.Y = "euclidean",
  use = "all",
  return.data = FALSE,
  algorithm = "auto"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distcov.test_+3A_x">X</code></td>
<td>
<p>contains either the first sample or its corresponding distance matrix.
</p>
<p>In the first case, X can be provided either as a vector (if one-dimensional), a matrix or a data.frame (if two-dimensional or higher). 
</p>
<p>In the second case, the input must be a distance matrix corresponding to the sample of interest.
</p>
<p>If X is a sample, type.X must be specified as &quot;sample&quot;. If X is a distance matrix, type.X must be specified as &quot;distance&quot;.</p>
</td></tr>
<tr><td><code id="distcov.test_+3A_y">Y</code></td>
<td>
<p>see X.</p>
</td></tr>
<tr><td><code id="distcov.test_+3A_method">method</code></td>
<td>
<p>specifies the type of test that is performed.
</p>
<p>&quot;permutation&quot; performs a Monte Carlo Permutation test. 
</p>
<p>&quot;gamma&quot; performs a test based on a gamma approximation of the test statistic under the null (Huang and Huo 2017). This test tends to be anti-conservative, if the &ldquo;real&rdquo; p-value is small
</p>
<p>&quot;conservative&quot; performs a conservative two-moment approximation (Berschneider and Bottcher 2018).
</p>
<p>&quot;bb3&quot; performs a  three-moment approximation  (Berschneider and Bottcher 2018). This is the most precise parametric option, but only available with the standard algorithm.
</p>
<p>&quot;wildbs1&quot; and &quot;wilbs2&quot; perform wild bootstrap tests (Chwialkowski et al. 2014); experimental at the moment.</p>
</td></tr>
<tr><td><code id="distcov.test_+3A_b">b</code></td>
<td>
<p>integer; specifies the number of random permutations/bootstrap samples used for the permutation or wild bootstraps tests. Ignored for other tests.</p>
</td></tr>
<tr><td><code id="distcov.test_+3A_ln">ln</code></td>
<td>
<p>numeric; block size parameter for wild bootstrap tests. Ignored for other tests.</p>
</td></tr>
<tr><td><code id="distcov.test_+3A_affine">affine</code></td>
<td>
<p>logical; specifies if the affinely invariant distance covariance (Dueck et al. 2014) should be calculated or not.</p>
</td></tr>
<tr><td><code id="distcov.test_+3A_standardize">standardize</code></td>
<td>
<p>logical; specifies if X and Y should be standardized dividing each component by its standard deviations. No effect when affine = TRUE.</p>
</td></tr>
<tr><td><code id="distcov.test_+3A_bias.corr">bias.corr</code></td>
<td>
<p>logical; specifies if the bias corrected version of the sample distance covariance (Huo and Szekely 2016) should be calculated.</p>
</td></tr>
<tr><td><code id="distcov.test_+3A_type.x">type.X</code></td>
<td>
<p>For &quot;distance&quot;, X is interpreted as a distance matrix. For &quot;sample&quot;, X is interpreted as a sample.</p>
</td></tr>
<tr><td><code id="distcov.test_+3A_type.y">type.Y</code></td>
<td>
<p>see type.X.</p>
</td></tr>
<tr><td><code id="distcov.test_+3A_metr.x">metr.X</code></td>
<td>
<p>specifies the metric which should be used to compute the distance matrix for X (ignored when type.X = &quot;distance&quot;).
</p>
<p>Options are &quot;euclidean&quot;, &quot;discrete&quot;, &quot;alpha&quot;, &quot;minkowski&quot;, &quot;gaussian&quot;, &quot;gaussauto&quot;, &quot;boundsq&quot; or user-specified metrics (see examples).
</p>
<p>For &quot;alpha&quot;, &quot;minkowski&quot;, &quot;gauss&quot;, &quot;gaussauto&quot; and &quot;boundsq&quot;, the corresponding parameters are specified via &quot;c(metric, parameter)&quot;, c(&quot;gaussian&quot;, 3) for example uses a Gaussian metric with bandwidth parameter 3; the default parameter is 2 for &quot;minkowski&quot; and &quot;1&quot; for all other metrics.
</p>
<p>See Lyons (2013); Sejdinovic et al. (2013); Bottcher et al. (2018) for details.</p>
</td></tr>
<tr><td><code id="distcov.test_+3A_metr.y">metr.Y</code></td>
<td>
<p>see metr.X.</p>
</td></tr>
<tr><td><code id="distcov.test_+3A_use">use</code></td>
<td>
<p>specifies how to treat missing values. &quot;complete.obs&quot; excludes NAs, &quot;all&quot; uses all observations.</p>
</td></tr>
<tr><td><code id="distcov.test_+3A_return.data">return.data</code></td>
<td>
<p>logical; specifies if the test object should contain the original data.</p>
</td></tr>
<tr><td><code id="distcov.test_+3A_algorithm">algorithm</code></td>
<td>
<p>specifies the algorithm used for calculating the distance covariance. 
</p>
<p>&quot;fast&quot; uses an O(n log n) algorithm if the observations are one-dimensional and metr.X and metr.Y are either &quot;euclidean&quot; or &quot;discrete&quot;, see also Huo and Szekely (2016). 
</p>
<p>&quot;memsave&quot; uses a memory saving version of the standard algorithm with computational complexity O(n^2) but requiring only O(n) memory. 
</p>
<p>&quot;standard&quot; uses the classical algorithm. User-specified metrics always use the classical algorithm.
</p>
<p>&quot;auto&quot; chooses the best algorithm for the specific setting using a rule of thumb.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>distcov.test object
</p>


<h3>References</h3>

<p>Berschneider G, Bottcher B (2018).
&ldquo;On complex Gaussian random fields, Gaussian quadratic forms and sample distance multivariance.&rdquo;
<em>arXiv preprint arXiv:1808.07280</em>.
</p>
<p>Bottcher B, Keller-Ressel M, Schilling RL (2018).
&ldquo;Detecting independence of random vectors: generalized distance covariance and Gaussian covariance.&rdquo;
<em>Modern Stochastics: Theory and Applications</em>, <b>3</b>, 353&ndash;383.
</p>
<p>Chwialkowski KP, Sejdinovic D, Gretton A (2014).
&ldquo;A wild bootstrap for degenerate kernel tests.&rdquo;
In <em>Advances in neural information processing systems</em>, 3608&ndash;3616.
</p>
<p>Dueck J, Edelmann D, Gneiting T, Richards D (2014).
&ldquo;The affinely invariant distance correlation.&rdquo;
<em>Bernoulli</em>, <b>20</b>, 2305&ndash;2330.
</p>
<p>Huang C, Huo X (2017).
&ldquo;A statistically and numerically efficient independence test based on random projections and distance covariance.&rdquo;
<em>arXiv preprint arXiv:1701.06054</em>.
</p>
<p>Huo X, Szekely GJ (2016).
&ldquo;Fast computing for distance covariance.&rdquo;
<em>Technometrics</em>, <b>58</b>(4), 435&ndash;447.
</p>
<p>Lyons R (2013).
&ldquo;Distance covariance in metric spaces.&rdquo;
<em>The Annals of Probability</em>, <b>41</b>, 3284&ndash;3305.
</p>
<p>Sejdinovic D, Sriperumbudur B, Gretton A, Fukumizu K (2013).
&ldquo;Equivalence of distance-based and RKHS-based statistics in hypothesis testing.&rdquo;
<em>The Annals of Statistics</em>, <b>41</b>, 2263&ndash;2291.
</p>
<p>Szekely GJ, Rizzo ML, Bakirov NK (2007).
&ldquo;Measuring and testing dependence by correlation of distances.&rdquo;
<em>The Annals of Statistics</em>, <b>35</b>, 2769&ndash;2794.
</p>
<p>Szekely GJ, Rizzo ML (2009).
&ldquo;Brownian distance covariance.&rdquo;
<em>The Annals of Applied Statistics</em>, <b>3</b>, 1236&ndash;1265.
</p>

<hr>
<h2 id='distsd'>Calculates the distance standard deviation (Edelmann et al. 2020).</h2><span id='topic+distsd'></span>

<h3>Description</h3>

<p>Calculates the distance standard deviation (Edelmann et al. 2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distsd(
  X,
  affine = FALSE,
  standardize = FALSE,
  bias.corr = FALSE,
  type.X = "sample",
  metr.X = "euclidean",
  use = "all",
  algorithm = "auto"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distsd_+3A_x">X</code></td>
<td>
<p>contains either the sample or its corresponding distance matrix.
</p>
<p>In the first case, X can be provided either as a vector (if one-dimensional), a matrix or a data.frame (if two-dimensional or higher). 
</p>
<p>In the second case, the input must be a distance matrix corresponding to the sample of interest.
</p>
<p>If X is a sample, type.X must be specified as &quot;sample&quot;. If X is a distance matrix, type.X must be specified as &quot;distance&quot;.</p>
</td></tr>
<tr><td><code id="distsd_+3A_affine">affine</code></td>
<td>
<p>logical; specifies if the affinely invariant distance standard deviation (Dueck et al. 2014) should be calculated or not.</p>
</td></tr>
<tr><td><code id="distsd_+3A_standardize">standardize</code></td>
<td>
<p>logical; specifies if X and Y should be standardized dividing each component by its standard deviations. No effect when affine = TRUE.</p>
</td></tr>
<tr><td><code id="distsd_+3A_bias.corr">bias.corr</code></td>
<td>
<p>logical; specifies if the bias corrected version of the sample distance standard deviation (Huo and Szekely 2016) should be calculated.</p>
</td></tr>
<tr><td><code id="distsd_+3A_type.x">type.X</code></td>
<td>
<p>For &quot;distance&quot;, X is interpreted as a distance matrix. For &quot;sample&quot;, X is interpreted as a sample.</p>
</td></tr>
<tr><td><code id="distsd_+3A_metr.x">metr.X</code></td>
<td>
<p>specifies the metric which should be used to compute the distance matrix for X (ignored when type.X = &quot;distance&quot;).
</p>
<p>Options are &quot;euclidean&quot;, &quot;discrete&quot;, &quot;alpha&quot;, &quot;minkowski&quot;, &quot;gaussian&quot;, &quot;gaussauto&quot;, &quot;boundsq&quot; or user-specified metrics (see examples).
</p>
<p>For &quot;alpha&quot;, &quot;minkowski&quot;, &quot;gaussian&quot;, &quot;gaussauto&quot; and &quot;boundsq&quot;, the corresponding parameters are specified via &quot;c(metric, parameter)&quot;, e.g. c(&quot;gaussian&quot;, 3) for a Gaussian metric with bandwidth parameter 3; the default parameter is 2 for &quot;minkowski&quot; and &quot;1&quot; for all other metrics.
</p>
<p>See Lyons (2013); Sejdinovic et al. (2013); Bottcher et al. (2018) for details.</p>
</td></tr>
<tr><td><code id="distsd_+3A_use">use</code></td>
<td>
<p>specifies how to treat missing values. &quot;complete.obs&quot; excludes observations containing NAs, &quot;all&quot; uses all observations.</p>
</td></tr>
<tr><td><code id="distsd_+3A_algorithm">algorithm</code></td>
<td>
<p>specifies the algorithm used for calculating the distance standard deviation. 
</p>
<p>&quot;fast&quot; uses an O(n log n) algorithm if the observations are one-dimensional and metr.X and metr.Y are either &quot;euclidean&quot; or &quot;discrete&quot;, see also Huo and Szekely (2016). 
</p>
<p>&quot;memsave&quot; uses a memory saving version of the standard algorithm with computational complexity O(n^2) but requiring only O(n) memory. 
</p>
<p>&quot;standard&quot; uses the classical algorithm. User-specified metrics always use the classical algorithm.
</p>
<p>&quot;auto&quot; chooses the best algorithm for the specific setting using a rule of thumb.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric; the distance standard deviation of X.
</p>


<h3>References</h3>

<p>Bottcher B, Keller-Ressel M, Schilling RL (2018).
&ldquo;Detecting independence of random vectors: generalized distance covariance and Gaussian covariance.&rdquo;
<em>Modern Stochastics: Theory and Applications</em>, <b>3</b>, 353&ndash;383.
</p>
<p>Dueck J, Edelmann D, Gneiting T, Richards D (2014).
&ldquo;The affinely invariant distance correlation.&rdquo;
<em>Bernoulli</em>, <b>20</b>, 2305&ndash;2330.
</p>
<p>Edelmann D, Richards D, Vogel D (2020).
&ldquo;The Distance Standard Deviation.&rdquo;
<em>The Annals of Statistics.</em>.
Accepted for publication.
</p>
<p>Huo X, Szekely GJ (2016).
&ldquo;Fast computing for distance covariance.&rdquo;
<em>Technometrics</em>, <b>58</b>(4), 435&ndash;447.
</p>
<p>Lyons R (2013).
&ldquo;Distance covariance in metric spaces.&rdquo;
<em>The Annals of Probability</em>, <b>41</b>, 3284&ndash;3305.
</p>
<p>Sejdinovic D, Sriperumbudur B, Gretton A, Fukumizu K (2013).
&ldquo;Equivalence of distance-based and RKHS-based statistics in hypothesis testing.&rdquo;
<em>The Annals of Statistics</em>, <b>41</b>, 2263&ndash;2291.
</p>
<p>Szekely GJ, Rizzo ML, Bakirov NK (2007).
&ldquo;Measuring and testing dependence by correlation of distances.&rdquo;
<em>The Annals of Statistics</em>, <b>35</b>, 2769&ndash;2794.
</p>
<p>Szekely GJ, Rizzo ML (2009).
&ldquo;Brownian distance covariance.&rdquo;
<em>The Annals of Applied Statistics</em>, <b>3</b>, 1236&ndash;1265.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- rnorm(100)
distsd(X) # for more examples on the options see the documentation of distcov.
</code></pre>

<hr>
<h2 id='extract_np'>Extract the dimensions of X.</h2><span id='topic+extract_np'></span>

<h3>Description</h3>

<p>Extract the dimensions of X.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_np(X, type.X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_np_+3A_x">X</code></td>
<td>
<p>a numeric vector or a numeric matrix.</p>
</td></tr>
<tr><td><code id="extract_np_+3A_type.x">type.X</code></td>
<td>
<p>either &quot;sample&quot; or &quot;distance&quot;. If type.X = &quot;sample&quot;, X must be
a numeric vector or numeric matrix with the corresponding observations. If metr.X = &quot;distance&quot;,
X must be a distance matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The centralized distance matrix corresponding to X.
</p>

<hr>
<h2 id='hsplot'>Plots Pearson/Spearman/Kendall correlation against distance correlation (often resembling a horseshoe(hs)).</h2><span id='topic+hsplot'></span>

<h3>Description</h3>

<p>Plots Pearson/Spearman/Kendall correlation against distance correlation (often resembling a horseshoe(hs)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hsplot(dcmat, maxcomp = 1e+05, col = "blue", alpha = 1, cortrafo = "none")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hsplot_+3A_dcmat">dcmat</code></td>
<td>
<p>A dcmatrix object.</p>
</td></tr>
<tr><td><code id="hsplot_+3A_maxcomp">maxcomp</code></td>
<td>
<p>Maximum number of associations, for which distance correlation is plotted against correlation. If the number of associations in the dcmat object is larger, only the maxcomp associations with the largest difference between distance correlation and absolute (Pearson/Spearman/Kendall) correlation are plotted.</p>
</td></tr>
<tr><td><code id="hsplot_+3A_col">col</code></td>
<td>
<p>color of the plot.</p>
</td></tr>
<tr><td><code id="hsplot_+3A_alpha">alpha</code></td>
<td>
<p>alpha parameter of the plot.</p>
</td></tr>
<tr><td><code id="hsplot_+3A_cortrafo">cortrafo</code></td>
<td>
<p>Either &quot;none&quot; or &quot;gaussiandcor&quot;. If &quot;gaussiandcor&quot;, the distance correlation under assumption of normality is calculated and plotted against the actual distance correlation. 
</p>
<p>Note that this is only sensible for Pearson correlation!</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of (possibly transformed) Pearson/Spearman/Kendall correlation against distance correlation.
</p>

<hr>
<h2 id='ipcw.dcor'>Calculates an inverse-probability-of-censoring weighted (IPCW) distance correlation based on IPCW U-statistics (Datta et al. 2010).</h2><span id='topic+ipcw.dcor'></span>

<h3>Description</h3>

<p>Calculates an inverse-probability-of-censoring weighted (IPCW) distance correlation based on IPCW U-statistics (Datta et al. 2010).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipcw.dcor(
  Y,
  X,
  affine = FALSE,
  standardize = FALSE,
  timetrafo = "none",
  type.X = "sample",
  metr.X = "euclidean",
  use = "all",
  cutoff = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ipcw.dcor_+3A_y">Y</code></td>
<td>
<p>A matrix with two columns, where the first column contains the survival times and the second column the status indicators (a survival object will work).</p>
</td></tr>
<tr><td><code id="ipcw.dcor_+3A_x">X</code></td>
<td>
<p>A vector or matrix containing the covariate information.</p>
</td></tr>
<tr><td><code id="ipcw.dcor_+3A_affine">affine</code></td>
<td>
<p>logical; specifies if X should be transformed such that the result is invariant under affine transformations of X</p>
</td></tr>
<tr><td><code id="ipcw.dcor_+3A_standardize">standardize</code></td>
<td>
<p>logical; should X be standardized using the standard deviations of single observations?. No effect when affine = TRUE.</p>
</td></tr>
<tr><td><code id="ipcw.dcor_+3A_timetrafo">timetrafo</code></td>
<td>
<p>specifies a transformation applied on the follow-up times. Can be &quot;none&quot;, &quot;log&quot; or a user-specified function.</p>
</td></tr>
<tr><td><code id="ipcw.dcor_+3A_type.x">type.X</code></td>
<td>
<p>For &quot;distance&quot;, X is interpreted as a distance matrix. For &quot;sample&quot;, X is interpreted as a sample.</p>
</td></tr>
<tr><td><code id="ipcw.dcor_+3A_metr.x">metr.X</code></td>
<td>
<p>specifies the metric which should be used to compute the distance matrix for X (ignored when type.X = &quot;distance&quot;).
</p>
<p>Options are &quot;euclidean&quot;, &quot;discrete&quot;, &quot;alpha&quot;, &quot;minkowski&quot;, &quot;gaussian&quot;, &quot;gaussauto&quot;, &quot;boundsq&quot; or user-specified metrics (see examples).
</p>
<p>For &quot;alpha&quot;, &quot;minkowski&quot;, &quot;gaussian&quot;, &quot;gaussauto&quot; and &quot;boundsq&quot;, the corresponding parameters are specified via &quot;c(metric,parameter)&quot;, c(&quot;gaussian&quot;,3) for example uses a Gaussian metric with bandwidth parameter 3; the default parameter is 2 for &quot;minkowski&quot; and &quot;1&quot; for all other metrics.</p>
</td></tr>
<tr><td><code id="ipcw.dcor_+3A_use">use</code></td>
<td>
<p>specifies how to treat missing values. &quot;complete.obs&quot; excludes observations containing NAs, &quot;all&quot; uses all observations.</p>
</td></tr>
<tr><td><code id="ipcw.dcor_+3A_cutoff">cutoff</code></td>
<td>
<p>If provided, all survival times larger than cutoff are set to the cutoff and all corresponding status indicators are set to one. Under most circumstances, choosing a cutoff is highly recommended.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An inverse-probability of censoring weighted estimate for the distance correlation between X and the survival times.
</p>


<h3>References</h3>

<p>Bottcher B, Keller-Ressel M, Schilling RL (2018).
&ldquo;Detecting independence of random vectors: generalized distance covariance and Gaussian covariance.&rdquo;
<em>Modern Stochastics: Theory and Applications</em>, <b>3</b>, 353&ndash;383.
</p>
<p>Datta S, Bandyopadhyay D, Satten GA (2010).
&ldquo;Inverse Probability of Censoring Weighted U-statistics for Right-Censored Data with an Application to Testing Hypotheses.&rdquo;
<em>Scandinavian Journal of Statistics</em>, <b>37</b>(4), 680&ndash;700.
</p>
<p>Dueck J, Edelmann D, Gneiting T, Richards D (2014).
&ldquo;The affinely invariant distance correlation.&rdquo;
<em>Bernoulli</em>, <b>20</b>, 2305&ndash;2330.
</p>
<p>Huo X, Szekely GJ (2016).
&ldquo;Fast computing for distance covariance.&rdquo;
<em>Technometrics</em>, <b>58</b>(4), 435&ndash;447.
</p>
<p>Lyons R (2013).
&ldquo;Distance covariance in metric spaces.&rdquo;
<em>The Annals of Probability</em>, <b>41</b>, 3284&ndash;3305.
</p>
<p>Sejdinovic D, Sriperumbudur B, Gretton A, Fukumizu K (2013).
&ldquo;Equivalence of distance-based and RKHS-based statistics in hypothesis testing.&rdquo;
<em>The Annals of Statistics</em>, <b>41</b>, 2263&ndash;2291.
</p>
<p>Szekely GJ, Rizzo ML, Bakirov NK (2007).
&ldquo;Measuring and testing dependence by correlation of distances.&rdquo;
<em>The Annals of Statistics</em>, <b>35</b>, 2769&ndash;2794.
</p>
<p>Szekely GJ, Rizzo ML (2009).
&ldquo;Brownian distance covariance.&rdquo;
<em>The Annals of Applied Statistics</em>, <b>3</b>, 1236&ndash;1265.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- rnorm(100)
survtime &lt;- rgamma(100, abs(X))
cens &lt;- rexp(100)
status &lt;- as.numeric(survtime &lt; cens)
time &lt;- sapply(1:100, function(u) min(survtime[u], cens[u]))
surv &lt;- cbind(time, status)
ipcw.dcor(surv, X)
</code></pre>

<hr>
<h2 id='ipcw.dcov'>Calculates an inverse-probability-of-censoring weighted (IPCW) distance covariance based on IPCW U-statistics (Datta et al. 2010).</h2><span id='topic+ipcw.dcov'></span>

<h3>Description</h3>

<p>Calculates an inverse-probability-of-censoring weighted (IPCW) distance covariance based on IPCW U-statistics (Datta et al. 2010).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipcw.dcov(
  Y,
  X,
  affine = FALSE,
  standardize = FALSE,
  timetrafo = "none",
  type.X = "sample",
  metr.X = "euclidean",
  use = "all",
  cutoff = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ipcw.dcov_+3A_y">Y</code></td>
<td>
<p>A column with two rows, where the first row contains the survival times and the second row the status indicators (a survival object will work).</p>
</td></tr>
<tr><td><code id="ipcw.dcov_+3A_x">X</code></td>
<td>
<p>A vector or matrix containing the covariate information.</p>
</td></tr>
<tr><td><code id="ipcw.dcov_+3A_affine">affine</code></td>
<td>
<p>logical; indicates if X should be transformed such that the result is invariant under affine transformations of X</p>
</td></tr>
<tr><td><code id="ipcw.dcov_+3A_standardize">standardize</code></td>
<td>
<p>logical; should X be standardized using the standard deviations of single observations?. No effect when affine = TRUE.</p>
</td></tr>
<tr><td><code id="ipcw.dcov_+3A_timetrafo">timetrafo</code></td>
<td>
<p>specifies a transformation applied on the follow-up times. Can be &quot;none&quot;, &quot;log&quot; or a user-specified function.</p>
</td></tr>
<tr><td><code id="ipcw.dcov_+3A_type.x">type.X</code></td>
<td>
<p>For &quot;distance&quot;, X is interpreted as a distance matrix. For &quot;sample&quot; (or any other value), X is interpreted as a sample</p>
</td></tr>
<tr><td><code id="ipcw.dcov_+3A_metr.x">metr.X</code></td>
<td>
<p>metr.X specifies the metric which should be used for X to analyze the distance covariance. Options are &quot;euclidean&quot;, &quot;discrete&quot;, &quot;alpha&quot;, &quot;minkowski&quot;, &quot;gaussian&quot;, &quot;gaussauto&quot; and &quot;boundsq&quot;. For &quot;alpha&quot;, &quot;minkowski&quot;, &quot;gauss&quot;, &quot;gaussauto&quot; and &quot;boundsq&quot;, the corresponding parameters are specified via &quot;c(metric,parameter)&quot; (see examples); the standard parameter is 2 for &quot;minkowski&quot; and &quot;1&quot; for all other metrics.</p>
</td></tr>
<tr><td><code id="ipcw.dcov_+3A_use">use</code></td>
<td>
<p>specifies how to treat missing values. &quot;complete.obs&quot; excludes observations containing NAs, &quot;all&quot; uses all observations.</p>
</td></tr>
<tr><td><code id="ipcw.dcov_+3A_cutoff">cutoff</code></td>
<td>
<p>If provided, all survival times larger than cutoff are set to the cutoff and all corresponding status indicators are set to one. Under most circumstances, choosing a cutoff is highly recommended.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An inverse-probability of censoring weighted estimate for the distance covariance between X and the survival times.
</p>


<h3>References</h3>

<p>Bottcher B, Keller-Ressel M, Schilling RL (2018).
&ldquo;Detecting independence of random vectors: generalized distance covariance and Gaussian covariance.&rdquo;
<em>Modern Stochastics: Theory and Applications</em>, <b>3</b>, 353&ndash;383.
</p>
<p>Datta S, Bandyopadhyay D, Satten GA (2010).
&ldquo;Inverse Probability of Censoring Weighted U-statistics for Right-Censored Data with an Application to Testing Hypotheses.&rdquo;
<em>Scandinavian Journal of Statistics</em>, <b>37</b>(4), 680&ndash;700.
</p>
<p>Dueck J, Edelmann D, Gneiting T, Richards D (2014).
&ldquo;The affinely invariant distance correlation.&rdquo;
<em>Bernoulli</em>, <b>20</b>, 2305&ndash;2330.
</p>
<p>Huo X, Szekely GJ (2016).
&ldquo;Fast computing for distance covariance.&rdquo;
<em>Technometrics</em>, <b>58</b>(4), 435&ndash;447.
</p>
<p>Lyons R (2013).
&ldquo;Distance covariance in metric spaces.&rdquo;
<em>The Annals of Probability</em>, <b>41</b>, 3284&ndash;3305.
</p>
<p>Sejdinovic D, Sriperumbudur B, Gretton A, Fukumizu K (2013).
&ldquo;Equivalence of distance-based and RKHS-based statistics in hypothesis testing.&rdquo;
<em>The Annals of Statistics</em>, <b>41</b>, 2263&ndash;2291.
</p>
<p>Szekely GJ, Rizzo ML, Bakirov NK (2007).
&ldquo;Measuring and testing dependence by correlation of distances.&rdquo;
<em>The Annals of Statistics</em>, <b>35</b>, 2769&ndash;2794.
</p>
<p>Szekely GJ, Rizzo ML (2009).
&ldquo;Brownian distance covariance.&rdquo;
<em>The Annals of Applied Statistics</em>, <b>3</b>, 1236&ndash;1265.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- rnorm(100)
survtime &lt;- rgamma(100, abs(X))
cens &lt;- rexp(100)
status &lt;- as.numeric(survtime &lt; cens)
time &lt;- sapply(1:100, function(u) min(survtime[u], cens[u]))
surv &lt;- cbind(time, status)
ipcw.dcov(surv, X)
</code></pre>

<hr>
<h2 id='ipcw.dcov.test'>Performs a permutation test based on the IPCW distance covariance.</h2><span id='topic+ipcw.dcov.test'></span>

<h3>Description</h3>

<p>Performs a permutation test based on the IPCW distance covariance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipcw.dcov.test(
  Y,
  X,
  affine = FALSE,
  standardize = FALSE,
  timetrafo = "none",
  type.X = "sample",
  metr.X = "euclidean",
  use = "all",
  cutoff = NULL,
  B = 499
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ipcw.dcov.test_+3A_y">Y</code></td>
<td>
<p>A column with two rows, where the first row contains the survival times and the second row the status indicators (a survival object will work).</p>
</td></tr>
<tr><td><code id="ipcw.dcov.test_+3A_x">X</code></td>
<td>
<p>A vector or matrix containing the covariate information.</p>
</td></tr>
<tr><td><code id="ipcw.dcov.test_+3A_affine">affine</code></td>
<td>
<p>logical; indicates if X should be transformed such that the result is invariant under affine transformations of X.</p>
</td></tr>
<tr><td><code id="ipcw.dcov.test_+3A_standardize">standardize</code></td>
<td>
<p>logical; should X be standardized using the standard deviations of single observations. No effect when affine = TRUE.</p>
</td></tr>
<tr><td><code id="ipcw.dcov.test_+3A_timetrafo">timetrafo</code></td>
<td>
<p>specifies a transformation applied on the follow-up times. Can be &quot;none&quot;, &quot;log&quot; or a user-specified function.</p>
</td></tr>
<tr><td><code id="ipcw.dcov.test_+3A_type.x">type.X</code></td>
<td>
<p>For &quot;distance&quot;, X is interpreted as a distance matrix. For &quot;sample&quot; (or any other value), X is interpreted as a sample.</p>
</td></tr>
<tr><td><code id="ipcw.dcov.test_+3A_metr.x">metr.X</code></td>
<td>
<p>metr.X specifies the metric which should be used for X to analyze the distance covariance. Options are &quot;euclidean&quot;, &quot;discrete&quot;, &quot;alpha&quot;, &quot;minkowski&quot;, &quot;gaussian&quot;, &quot;gaussauto&quot; and &quot;boundsq&quot;. For &quot;alpha&quot;, &quot;minkowski&quot;, &quot;gauss&quot;, &quot;gaussauto&quot; and &quot;boundsq&quot;, the corresponding parameters are specified via &quot;c(metric,parameter)&quot; (see examples); the standard parameter is 2 for &quot;minkowski&quot; and &quot;1&quot; for all other metrics.</p>
</td></tr>
<tr><td><code id="ipcw.dcov.test_+3A_use">use</code></td>
<td>
<p>specifies how to treat missing values. &quot;complete.obs&quot; excludes observations containing NAs, &quot;all&quot; uses all observations.</p>
</td></tr>
<tr><td><code id="ipcw.dcov.test_+3A_cutoff">cutoff</code></td>
<td>
<p>If provided, all survival times larger than cutoff are set to the cutoff and all corresponding status indicators are set to one. Under most circumstances, choosing a cutoff is highly recommended.</p>
</td></tr>
<tr><td><code id="ipcw.dcov.test_+3A_b">B</code></td>
<td>
<p>The number of permutations used for the permutation test</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An list with two arguments, $dcov contains the IPCW distance covariance, $pvalue the corresponding p-value
</p>


<h3>References</h3>

<p>Bottcher B, Keller-Ressel M, Schilling RL (2018).
&ldquo;Detecting independence of random vectors: generalized distance covariance and Gaussian covariance.&rdquo;
<em>Modern Stochastics: Theory and Applications</em>, <b>3</b>, 353&ndash;383.
</p>
<p>Datta S, Bandyopadhyay D, Satten GA (2010).
&ldquo;Inverse Probability of Censoring Weighted U-statistics for Right-Censored Data with an Application to Testing Hypotheses.&rdquo;
<em>Scandinavian Journal of Statistics</em>, <b>37</b>(4), 680&ndash;700.
</p>
<p>Dueck J, Edelmann D, Gneiting T, Richards D (2014).
&ldquo;The affinely invariant distance correlation.&rdquo;
<em>Bernoulli</em>, <b>20</b>, 2305&ndash;2330.
</p>
<p>Huo X, Szekely GJ (2016).
&ldquo;Fast computing for distance covariance.&rdquo;
<em>Technometrics</em>, <b>58</b>(4), 435&ndash;447.
</p>
<p>Lyons R (2013).
&ldquo;Distance covariance in metric spaces.&rdquo;
<em>The Annals of Probability</em>, <b>41</b>, 3284&ndash;3305.
</p>
<p>Sejdinovic D, Sriperumbudur B, Gretton A, Fukumizu K (2013).
&ldquo;Equivalence of distance-based and RKHS-based statistics in hypothesis testing.&rdquo;
<em>The Annals of Statistics</em>, <b>41</b>, 2263&ndash;2291.
</p>
<p>Szekely GJ, Rizzo ML, Bakirov NK (2007).
&ldquo;Measuring and testing dependence by correlation of distances.&rdquo;
<em>The Annals of Statistics</em>, <b>35</b>, 2769&ndash;2794.
</p>
<p>Szekely GJ, Rizzo ML (2009).
&ldquo;Brownian distance covariance.&rdquo;
<em>The Annals of Applied Statistics</em>, <b>3</b>, 1236&ndash;1265.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- rnorm(100)
survtime &lt;- rgamma(100, abs(X))
cens &lt;- rexp(100)
status &lt;- as.numeric(survtime &lt; cens)
time &lt;- sapply(1:100, function(u) min(survtime[u], cens[u]))
surv &lt;- cbind(time, status)
ipcw.dcov.test(surv, X)
ipcw.dcov.test(surv, X, cutoff = quantile(time, 0.8)) 
# often better performance when using a cutoff time

</code></pre>

<hr>
<h2 id='plot.dcmatrix'>Plots a heatmap from a dcmatrix object using the function &quot;pheatmap&quot; from the package &quot;pheatmap&quot;.</h2><span id='topic+plot.dcmatrix'></span>

<h3>Description</h3>

<p>Plots a heatmap from a dcmatrix object using the function &quot;pheatmap&quot; from the package &quot;pheatmap&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dcmatrix'
plot(
  x,
  type = "dcor",
  trunc.up = NULL,
  trunc.low = NULL,
  cluster_rows = FALSE,
  cluster_cols = FALSE,
  display_numbers = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.dcmatrix_+3A_x">x</code></td>
<td>
<p>a dcmatrix object.</p>
</td></tr>
<tr><td><code id="plot.dcmatrix_+3A_type">type</code></td>
<td>
<p>specifies what should be displayed in the heatmap. One of &quot;dcor&quot;, &quot;dcov&quot;, &quot;logp&quot; (-log10 of corresponding p-values), &quot;cor&quot;, &quot;abscor&quot; (absolute correlation), &quot;logp.cor&quot;, &quot;dcor.pw&quot;, &quot;dcov.pw&quot; or &quot;logp.pw&quot;.</p>
</td></tr>
<tr><td><code id="plot.dcmatrix_+3A_trunc.up">trunc.up</code></td>
<td>
<p>truncates the values to be plotted; if set to numeric, all values larger than trunc.up are set to trunc.up.</p>
</td></tr>
<tr><td><code id="plot.dcmatrix_+3A_trunc.low">trunc.low</code></td>
<td>
<p>truncates the values to be plotted; if set to numeric, all values smaller than trunc.low are set to trunc.low.</p>
</td></tr>
<tr><td><code id="plot.dcmatrix_+3A_cluster_rows">cluster_rows</code>, <code id="plot.dcmatrix_+3A_cluster_cols">cluster_cols</code>, <code id="plot.dcmatrix_+3A_display_numbers">display_numbers</code></td>
<td>
<p>passed to pheatmap().</p>
</td></tr>
<tr><td><code id="plot.dcmatrix_+3A_...">...</code></td>
<td>
<p>passed to pheatmap().</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a heatmap plotting the entries of the slot specified in type of the object specified in dcmat.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
