<!DOCTYPE html><html lang="en"><head><title>Help for package SMNlmec</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SMNlmec}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SMNlmec.est'><p>Bayesian Censored Mixed-Effects Models with Damped Exponential Correlation Structures for Scale Mixture of Normal distributions error</p></a></li>
<li><a href='#SMNlmec.sim'><p>Generating Censored UNC, DEC, CAR errors with Mixed Effects, for normal, student's-t and slash distribution.</p></a></li>
<li><a href='#SMNlmec.summary'><p>SMNlmecfit Summary</p></a></li>
<li><a href='#SMNlmecfit-class'><p>SMNlmecfit Class</p></a></li>
<li><a href='#SMNlmecfit.creator'><p>Create SMNlmecfit Objects</p></a></li>
<li><a href='#UTIdata'><p>Data set for Unstructured Treatment Interruption Study</p></a></li>
<li><a href='#UTIdata_sub'><p>Sub data set for Unstructured Treatment Interruption Study</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Scale Mixture of Normal Distribution in Linear Mixed-Effects
Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kelin Zhong &lt;kelin.zhong@uconn.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Bayesian analysis of censored linear mixed-effects models that replace Gaussian assumptions with a flexible class of distributions, such as the scale mixture of normal family distributions, considering a damped exponential correlation structure which was employed to account for within-subject autocorrelation among irregularly observed measures. For more details, see Kelin Zhong, Fernanda L. Schumacher, Luis M. Castro, Victor H. Lachos (2025) &lt;<a href="https://doi.org/10.1002%2Fsim.10295">doi:10.1002/sim.10295</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>rstan (&ge; 2.26.23), StanHeaders (&ge; 2.26.28), MASS (&ge;
7.3-60), tmvtnorm (&ge; 1.5), mvtnorm (&ge; 1.2-3), mnormt (&ge;
2.1.1), methods, stats, LaplacesDemon (&ge; 16.1.6),
TruncatedNormal (&ge; 2.2.2), numDeriv (&ge; 2016.8-1.1)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/KelinZhong/SMNlmec">https://github.com/KelinZhong/SMNlmec</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/KelinZhong/SMNlmec/issues">https://github.com/KelinZhong/SMNlmec/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-30 00:21:04 UTC; Colin</td>
</tr>
<tr>
<td>Author:</td>
<td>Kelin Zhong [aut, cre],
  Fernanda L. Schumacher [aut],
  Luis M. Castro [aut],
  Victor H. Lachos [aut],
  Jalmar M.F. Carrasco [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-30 08:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='SMNlmec.est'>Bayesian Censored Mixed-Effects Models with Damped Exponential Correlation Structures for Scale Mixture of Normal distributions error</h2><span id='topic+SMNlmec.est'></span>

<h3>Description</h3>

<p>This function fits left, right censored mixed-effects linear model, with scale mixture of normal distribution errors, using the Stan. It returns estimates, standard errors and LPML, AIC, BIC and DIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SMNlmec.est(
  ID,
  x_set,
  z_set,
  tt,
  y_complete,
  censor_vector,
  dist = "Normal",
  struc = "UNC",
  direction = "left",
  thin_num = 1,
  chains_num = 1,
  iter_num = 3000,
  burn_percen = 0.1,
  seed_set = NULL,
  adapt_delta_set = 0.8
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SMNlmec.est_+3A_id">ID</code></td>
<td>
<p>Vector <code>N x 1</code> of the ID of the data set, specifying the ID for each measurement.</p>
</td></tr>
<tr><td><code id="SMNlmec.est_+3A_x_set">x_set</code></td>
<td>
<p>Design matrix of the fixed effects of order <code>N x p</code>.</p>
</td></tr>
<tr><td><code id="SMNlmec.est_+3A_z_set">z_set</code></td>
<td>
<p>Design matrix of the random effects of order <code>N x d</code>.</p>
</td></tr>
<tr><td><code id="SMNlmec.est_+3A_tt">tt</code></td>
<td>
<p>Vector <code>N x 1</code> with the time the measurements were made, where <code>N</code> is the total number of measurements for all individuals. Default it's considered regular times.</p>
</td></tr>
<tr><td><code id="SMNlmec.est_+3A_y_complete">y_complete</code></td>
<td>
<p>Vector <code>N x 1</code> of the complete responses.</p>
</td></tr>
<tr><td><code id="SMNlmec.est_+3A_censor_vector">censor_vector</code></td>
<td>
<p>Vector <code>N x 1</code> of the indicator vector of censored responses.</p>
</td></tr>
<tr><td><code id="SMNlmec.est_+3A_dist">dist</code></td>
<td>
<p>Distribution of the random effects and random error. Available options are <code>Normal</code>, <code>Student</code> and <code>Slash</code>.</p>
</td></tr>
<tr><td><code id="SMNlmec.est_+3A_struc">struc</code></td>
<td>
<p>Structure of the correlation structure. Available options are <code>UNC</code>, <code>DEC</code>, <code>CAR</code>.</p>
</td></tr>
<tr><td><code id="SMNlmec.est_+3A_direction">direction</code></td>
<td>
<p>Direction of censoring type. Available options are <code>left</code> and <code>right</code>.</p>
</td></tr>
<tr><td><code id="SMNlmec.est_+3A_thin_num">thin_num</code></td>
<td>
<p>A positive integer specifying the period for saving samples. The default is 5. See more details in rstan::stan().</p>
</td></tr>
<tr><td><code id="SMNlmec.est_+3A_chains_num">chains_num</code></td>
<td>
<p>A positive integer specifying the number of chains generating by rstan::stan(). The default is 3.</p>
</td></tr>
<tr><td><code id="SMNlmec.est_+3A_iter_num">iter_num</code></td>
<td>
<p>A positive integer specifying the number of iterations for each chain (including warmup). The default is 5000.</p>
</td></tr>
<tr><td><code id="SMNlmec.est_+3A_burn_percen">burn_percen</code></td>
<td>
<p>A percentage of the warm-up iterations in each chain the Stan. The default is 0.1.</p>
</td></tr>
<tr><td><code id="SMNlmec.est_+3A_seed_set">seed_set</code></td>
<td>
<p>A random seed. The default is NULL.</p>
</td></tr>
<tr><td><code id="SMNlmec.est_+3A_adapt_delta_set">adapt_delta_set</code></td>
<td>
<p>A parameter to control the sampler's behavior. The default is 0.8. See rstan::stan() for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a S4 class SMNlmecfit object. Using function <code>SMNlmec.summary()</code> to obtain the estimation of parameters and model selection criteria. The SMNlmecfit include:
</p>
<table role = "presentation">
<tr><td><code>stan_object</code></td>
<td>
<p>A stanfit object from rstan::stan().</p>
</td></tr>
<tr><td><code>model_criteria</code></td>
<td>
<p>A list includes LPML, DIC, EAIC, EBIC, K-L divergence.</p>
</td></tr>
<tr><td><code>dist_set</code></td>
<td>
<p>The setting of distribution of the stan model.</p>
</td></tr>
<tr><td><code>struc_set</code></td>
<td>
<p>The setting of correlation structure of the stan model.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kelin Zhong, Fernanda L. Schumacher, Luis M. Castro and Victor H. Lachos. Bayesian analysis of censored linear mixed-effects models for heavy-tailed  irregularly observed repeated measures. Statistics in Medicine, 2025. doi:10.1002/sim.10295
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(rstan)
require(StanHeaders)
require(MASS)
require(tmvtnorm)
require(mvtnorm)
require(mnormt)

data("UTIdata_sub")
data1 &lt;- UTIdata_sub
y1 &lt;- c(log10(data1$RNA))
cc &lt;- (data1$RNAcens==1)+0
y_com&lt;-as.numeric(y1)
rho_com&lt;-as.numeric(cc)
x &lt;- cbind(
 (data1$Fup==0)+0,
 (data1$Fup==1)+0,
 (data1$Fup==3)+0,
 (data1$Fup==6)+0,
 (data1$Fup==9)+0,
 (data1$Fup==12)+0,
 (data1$Fup==18)+0,
 (data1$Fup==24)+0
 )
z &lt;- matrix(rep(1, length(y1)), ncol=1)

UTI_T_DEC &lt;- SMNlmec.est(ID = data1$Patid, x_set = x, z_set = z,
                         tt = data1$Fup, y_complete = y_com,
                         censor_vector = rho_com, dist = "Student",
                         struc = "DEC", direction = "left",
                         thin_num = 1, chains_num = 1, iter_num = 3000,
                         burn_percen = 0.1, seed_set = 9955,
                         adapt_delta_set = 0.8)

SMNlmec.summary(UTI_T_DEC)


</code></pre>

<hr>
<h2 id='SMNlmec.sim'>Generating Censored UNC, DEC, CAR errors with Mixed Effects, for normal, student's-t and slash distribution.</h2><span id='topic+SMNlmec.sim'></span>

<h3>Description</h3>

<p>Generating Censored UNC, DEC, CAR errors with Mixed Effects, for normal, student's-t and slash distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SMNlmec.sim(
  m,
  x,
  z,
  tt,
  nj,
  beta,
  sigma2,
  D,
  phi,
  struc = "UNC",
  typeModel = "Normal",
  p.cens = 0.1,
  n.cens = NULL,
  cens_type = "right",
  nu_set = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SMNlmec.sim_+3A_m">m</code></td>
<td>
<p>Number of individuals.</p>
</td></tr>
<tr><td><code id="SMNlmec.sim_+3A_x">x</code></td>
<td>
<p>Design matrix of the fixed effects of order <code>N x p</code>, corresponding to vector of fixed effects.</p>
</td></tr>
<tr><td><code id="SMNlmec.sim_+3A_z">z</code></td>
<td>
<p>Design matrix of the random effects of order<code>N x d</code>, corresponding to vector of random effects.</p>
</td></tr>
<tr><td><code id="SMNlmec.sim_+3A_tt">tt</code></td>
<td>
<p>Vector <code>N x 1</code> with the time the measurements were made, where <code>N</code> is the total number of measurements for all individuals.</p>
</td></tr>
<tr><td><code id="SMNlmec.sim_+3A_nj">nj</code></td>
<td>
<p>Vector <code>m x 1</code> with the number of measurements of each individual, where <code>m</code> is the total number of individuals.</p>
</td></tr>
<tr><td><code id="SMNlmec.sim_+3A_beta">beta</code></td>
<td>
<p>Vector of values fixed effects.</p>
</td></tr>
<tr><td><code id="SMNlmec.sim_+3A_sigma2">sigma2</code></td>
<td>
<p>Values of the scalar of the variance matrix.</p>
</td></tr>
<tr><td><code id="SMNlmec.sim_+3A_d">D</code></td>
<td>
<p>Variance matrix of the random effects of order <code>d x d</code>.</p>
</td></tr>
<tr><td><code id="SMNlmec.sim_+3A_phi">phi</code></td>
<td>
<p>Vector of parameter in the <code>DEC</code> and <code>CAR</code> structure. NULL for <code>UNC</code>, c(phi_1,phi_2) for <code>DEC</code> and c(phi_1,1) for <code>CAR</code>.</p>
</td></tr>
<tr><td><code id="SMNlmec.sim_+3A_struc">struc</code></td>
<td>
<p>Structure for the simulated data. Available options are <code>UNC</code>, <code>DEC</code> and <code>CAR</code>.</p>
</td></tr>
<tr><td><code id="SMNlmec.sim_+3A_typemodel">typeModel</code></td>
<td>
<p>Distribution of the simulated data. Available options are <code>Normal</code>, <code>Student</code> and <code>Slash</code>.</p>
</td></tr>
<tr><td><code id="SMNlmec.sim_+3A_p.cens">p.cens</code></td>
<td>
<p>Percentage of censored measurements in the responses. The default value is 0.1.</p>
</td></tr>
<tr><td><code id="SMNlmec.sim_+3A_n.cens">n.cens</code></td>
<td>
<p>Number of censored measurements in the responses. The default value is NULL.</p>
</td></tr>
<tr><td><code id="SMNlmec.sim_+3A_cens_type">cens_type</code></td>
<td>
<p>The direction of cesoring. Available options are <code>left</code> and <code>right</code>.</p>
</td></tr>
<tr><td><code id="SMNlmec.sim_+3A_nu_set">nu_set</code></td>
<td>
<p>degrees of freedom for student's-t or slash simulated data. The default value is NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return list:
</p>
<table role = "presentation">
<tr><td><code>cc</code></td>
<td>
<p>Vector of censoring indicators.</p>
</td></tr>
<tr><td><code>y_cc</code></td>
<td>
<p>Vector of responses censoring.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>p.cens &lt;- 0.1
m &lt;- 50
D &lt;- matrix(c(0.049,0.001,0.001,0.002),2,2)
sigma2_set &lt;- 0.15
beta &lt;- c(-2.83,-0.18)
nu &lt;- 2
phi &lt;- c(0.6,2)
nj &lt;- rep(6,m)
tt &lt;- rep(1:6,length(nj))
X1 &lt;- rep(1,sum(nj))
X2 &lt;- tt
x &lt;- as.matrix(cbind(X1,X2))
Z1 &lt;- rep(1,sum(nj))
Z2 &lt;- tt
z &lt;- as.matrix(cbind(Z1,Z2))

ID_sim &lt;- rep(0,length(tt))
ID_log &lt;- 0
for(i in 1:m) {
  for(j in 1:nj[i]) {
    ID_sim[ID_log + j] &lt;- i
  }
  ID_log &lt;- ID_log + nj[i]
}

Slash_DEC_sim &lt;- SMNlmec.sim(m = m,x = x,z = z,tt = tt,nj = nj,beta = beta,
                      sigma2 = sigma2_set,D = D,phi= phi,struc ="DEC",
                      typeModel="Slash",p.cens = p.cens,n.cens = NULL,
                      cens_type="right",nu_set=nu)

head(Slash_DEC_sim$cc)
sum(Slash_DEC_sim$cc)/length(Slash_DEC_sim$cc)

head(Slash_DEC_sim$y_cc)


y_com &lt;- as.numeric(Slash_DEC_sim$y_cc)
rho_com &lt;- as.numeric(Slash_DEC_sim$cc)
tem &lt;- tt

Slash_DEC_est &lt;- SMNlmec.est(ID = ID_sim, x_set = x, z_set = z,
                         tt = tem, y_complete = y_com,
                         censor_vector = rho_com, dist = "Slash",
                         struc = "DEC", direction = "right",
                         thin_num = 1, chains_num = 1, iter_num = 3000,
                         burn_percen = 0.1, seed_set = 9955,
                         adapt_delta_set = 0.8)

SMNlmec.summary(Slash_DEC_est)


</code></pre>

<hr>
<h2 id='SMNlmec.summary'>SMNlmecfit Summary</h2><span id='topic+SMNlmec.summary'></span><span id='topic+SMNlmec.summary+2CSMNlmecfit-method'></span>

<h3>Description</h3>

<p>A generic function to provide a summary for objects of class <code>SMNlmecfit</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SMNlmec.summary(object)

## S4 method for signature 'SMNlmecfit'
SMNlmec.summary(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SMNlmec.summary_+3A_object">object</code></td>
<td>
<p>An object of class <code>SMNlmecfit</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A summary of model estimations, R-hats, standard errors, and criteria.
</p>
<p>A printed summary of the SMNlmecfit object.
</p>

<hr>
<h2 id='SMNlmecfit-class'>SMNlmecfit Class</h2><span id='topic+SMNlmecfit-class'></span>

<h3>Description</h3>

<p>SMNlmecfit Class
</p>


<h3>Slots</h3>


<dl>
<dt><code>stan_object</code></dt><dd><p>stanfit object from rstan.</p>
</dd>
<dt><code>model_criteria</code></dt><dd><p>list, model selection criteria.</p>
</dd>
<dt><code>dist_set</code></dt><dd><p>character, the name of distribution.</p>
</dd>
<dt><code>struc_set</code></dt><dd><p>character, the name of correlation structure.</p>
</dd>
</dl>

<hr>
<h2 id='SMNlmecfit.creator'>Create SMNlmecfit Objects</h2><span id='topic+SMNlmecfit.creator'></span>

<h3>Description</h3>

<p>A function to create objects of class <code>SMNlmecfit</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SMNlmecfit.creator(stan_object, model_criteria, dist_set, struc_set)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SMNlmecfit.creator_+3A_stan_object">stan_object</code></td>
<td>
<p>stanfit object from rstan.</p>
</td></tr>
<tr><td><code id="SMNlmecfit.creator_+3A_model_criteria">model_criteria</code></td>
<td>
<p>list, model selection criteria.</p>
</td></tr>
<tr><td><code id="SMNlmecfit.creator_+3A_dist_set">dist_set</code></td>
<td>
<p>character, the name of distribution.</p>
</td></tr>
<tr><td><code id="SMNlmecfit.creator_+3A_struc_set">struc_set</code></td>
<td>
<p>character, the name of correlation structure.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A SMNlmecfit object containing:
</p>
<table role = "presentation">
<tr><td><code>stan_object</code></td>
<td>
<p>A stanfit object from rstan::stan().</p>
</td></tr>
<tr><td><code>model_criteria</code></td>
<td>
<p>A list includes LPML, DIC, EAIC, EBIC, K-L divergence.</p>
</td></tr>
<tr><td><code>dist_set</code></td>
<td>
<p>The setting of distribution of the stan model.</p>
</td></tr>
<tr><td><code>struc_set</code></td>
<td>
<p>The setting of correlation structure of the stan model.</p>
</td></tr>
</table>

<hr>
<h2 id='UTIdata'>Data set for Unstructured Treatment Interruption Study</h2><span id='topic+UTIdata'></span>

<h3>Description</h3>

<p>Data set from a study of Unstructured Treatment Interruption in HIV-infected adolescents in four institutions in the US. The main outcome is the HIV-1 RNA viral load, which is subject to censoring below the lower limit of detection of the assay (50 copies/mL). The censored observations are indicated by the variable RNAcens.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(UTIdata)
</code></pre>


<h3>Format</h3>


<p>A data frame with 373 observations on the following 5 variables.
</p>
<dl>
<dt>Patid</dt><dd><p>patient ID</p>
</dd>
<dt>Days.after.TI</dt><dd><p>days after treatment interruption.</p>
</dd>
<dt>Fup</dt><dd><p>follow-up months</p>
</dd>
<dt>RNA</dt><dd><p>viral load RNA</p>
</dd>
<dt>RNAcens</dt><dd><p>censoring indicator for viral load</p>
</dd>
</dl>



<h3>References</h3>

<p>Saitoh, A., Foca, M, et al. (2008), Clinical outcome in perinatally acquired HIV-infected children and adolescents after unstructured treatment interruption, Pediatrics,121, e513-e521.
</p>

<hr>
<h2 id='UTIdata_sub'>Sub data set for Unstructured Treatment Interruption Study</h2><span id='topic+UTIdata_sub'></span>

<h3>Description</h3>

<p>Data set from a study of Unstructured Treatment Interruption in HIV-infected adolescents in four institutions in the US. The main outcome is the HIV-1 RNA viral load, which is subject to censoring below the lower limit of detection of the assay (50 copies/mL). The censored observations are indicated by the variable RNAcens. Excluding subjects whose observations are less than 2 and with missing RNA (excluding subject ID C6 T16).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(UTIdata_sub)
</code></pre>


<h3>Format</h3>


<p>A data frame with 360 observations on the following 5 variables.
</p>
<dl>
<dt>Patid</dt><dd><p>patient ID</p>
</dd>
<dt>Days.after.TI</dt><dd><p>days after treatment interruption.</p>
</dd>
<dt>Fup</dt><dd><p>follow-up months</p>
</dd>
<dt>RNA</dt><dd><p>viral load RNA</p>
</dd>
<dt>RNAcens</dt><dd><p>censoring indicator for viral load</p>
</dd>
</dl>



<h3>References</h3>

<p>Saitoh, A., Foca, M, et al. (2008), Clinical outcome in perinatally acquired HIV-infected children and adolescents after unstructured treatment interruption, Pediatrics,121, e513-e521.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
